(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/*
 Highcharts JS v4.2.4 (2016-04-14)

 (c) 2009-2016 Torstein Honsi

 License: www.highcharts.com/license
*/
(function(m){typeof module==="object"&&module.exports?module.exports=m:m(Highcharts)})(function(m){function L(a,b,c){this.init(a,b,c)}var Q=m.arrayMin,R=m.arrayMax,t=m.each,H=m.extend,u=m.merge,S=m.map,o=m.pick,B=m.pInt,G=m.correctFloat,p=m.getOptions().plotOptions,i=m.seriesTypes,v=m.extendClass,M=m.splat,w=m.wrap,N=m.Axis,z=m.Tick,I=m.Point,T=m.Pointer,U=m.CenteredSeriesMixin,C=m.TrackerMixin,x=m.Series,y=Math,F=y.round,D=y.floor,O=y.max,V=m.Color,r=function(){};H(L.prototype,{init:function(a,b,
c){var d=this,g=d.defaultOptions;d.chart=b;d.options=a=u(g,b.angular?{background:{}}:void 0,a);(a=a.background)&&t([].concat(M(a)).reverse(),function(a){var b=a.backgroundColor,g=c.userOptions,a=u(d.defaultBackgroundOptions,a);if(b)a.backgroundColor=b;a.color=a.backgroundColor;c.options.plotBands.unshift(a);g.plotBands=g.plotBands||[];g.plotBands!==c.options.plotBands&&g.plotBands.unshift(a)})},defaultOptions:{center:["50%","50%"],size:"85%",startAngle:0},defaultBackgroundOptions:{shape:"circle",
borderWidth:1,borderColor:"silver",backgroundColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,"#FFF"],[1,"#DDD"]]},from:-Number.MAX_VALUE,innerRadius:0,to:Number.MAX_VALUE,outerRadius:"105%"}});var A=N.prototype,z=z.prototype,W={getOffset:r,redraw:function(){this.isDirty=!1},render:function(){this.isDirty=!1},setScale:r,setCategories:r,setTitle:r},P={isRadial:!0,defaultRadialGaugeOptions:{labels:{align:"center",x:0,y:null},minorGridLineWidth:0,minorTickInterval:"auto",minorTickLength:10,minorTickPosition:"inside",
minorTickWidth:1,tickLength:10,tickPosition:"inside",tickWidth:2,title:{rotation:0},zIndex:2},defaultRadialXOptions:{gridLineWidth:1,labels:{align:null,distance:15,x:0,y:null},maxPadding:0,minPadding:0,showLastLabel:!1,tickLength:0},defaultRadialYOptions:{gridLineInterpolation:"circle",labels:{align:"right",x:-3,y:-2},showLastLabel:!1,title:{x:4,text:null,rotation:90}},setOptions:function(a){a=this.options=u(this.defaultOptions,this.defaultRadialOptions,a);if(!a.plotBands)a.plotBands=[]},getOffset:function(){A.getOffset.call(this);
this.chart.axisOffset[this.side]=0;this.center=this.pane.center=U.getCenter.call(this.pane)},getLinePath:function(a,b){var c=this.center,b=o(b,c[2]/2-this.offset);return this.chart.renderer.symbols.arc(this.left+c[0],this.top+c[1],b,b,{start:this.startAngleRad,end:this.endAngleRad,open:!0,innerR:0})},setAxisTranslation:function(){A.setAxisTranslation.call(this);if(this.center)this.transA=this.isCircular?(this.endAngleRad-this.startAngleRad)/(this.max-this.min||1):this.center[2]/2/(this.max-this.min||
1),this.minPixelPadding=this.isXAxis?this.transA*this.minPointOffset:0},beforeSetTickPositions:function(){this.autoConnect&&(this.max+=this.categories&&1||this.pointRange||this.closestPointRange||0)},setAxisSize:function(){A.setAxisSize.call(this);if(this.isRadial){this.center=this.pane.center=m.CenteredSeriesMixin.getCenter.call(this.pane);if(this.isCircular)this.sector=this.endAngleRad-this.startAngleRad;this.len=this.width=this.height=this.center[2]*o(this.sector,1)/2}},getPosition:function(a,
b){return this.postTranslate(this.isCircular?this.translate(a):0,o(this.isCircular?b:this.translate(a),this.center[2]/2)-this.offset)},postTranslate:function(a,b){var c=this.chart,d=this.center,a=this.startAngleRad+a;return{x:c.plotLeft+d[0]+Math.cos(a)*b,y:c.plotTop+d[1]+Math.sin(a)*b}},getPlotBandPath:function(a,b,c){var d=this.center,g=this.startAngleRad,e=d[2]/2,j=[o(c.outerRadius,"100%"),c.innerRadius,o(c.thickness,10)],l=/%$/,h,f=this.isCircular;this.options.gridLineInterpolation==="polygon"?
d=this.getPlotLinePath(a).concat(this.getPlotLinePath(b,!0)):(a=Math.max(a,this.min),b=Math.min(b,this.max),f||(j[0]=this.translate(a),j[1]=this.translate(b)),j=S(j,function(a){l.test(a)&&(a=B(a,10)*e/100);return a}),c.shape==="circle"||!f?(a=-Math.PI/2,b=Math.PI*1.5,h=!0):(a=g+this.translate(a),b=g+this.translate(b)),d=this.chart.renderer.symbols.arc(this.left+d[0],this.top+d[1],j[0],j[0],{start:Math.min(a,b),end:Math.max(a,b),innerR:o(j[1],j[0]-j[2]),open:h}));return d},getPlotLinePath:function(a,
b){var c=this,d=c.center,g=c.chart,e=c.getPosition(a),j,l,h;c.isCircular?h=["M",d[0]+g.plotLeft,d[1]+g.plotTop,"L",e.x,e.y]:c.options.gridLineInterpolation==="circle"?(a=c.translate(a))&&(h=c.getLinePath(0,a)):(t(g.xAxis,function(a){a.pane===c.pane&&(j=a)}),h=[],a=c.translate(a),d=j.tickPositions,j.autoConnect&&(d=d.concat([d[0]])),b&&(d=[].concat(d).reverse()),t(d,function(e,b){l=j.getPosition(e,a);h.push(b?"L":"M",l.x,l.y)}));return h},getTitlePosition:function(){var a=this.center,b=this.chart,
c=this.options.title;return{x:b.plotLeft+a[0]+(c.x||0),y:b.plotTop+a[1]-{high:0.5,middle:0.25,low:0}[c.align]*a[2]+(c.y||0)}}};w(A,"init",function(a,b,c){var k;var d=b.angular,g=b.polar,e=c.isX,j=d&&e,l,h;h=b.options;var f=c.pane||0;if(d){if(H(this,j?W:P),l=!e)this.defaultRadialOptions=this.defaultRadialGaugeOptions}else if(g)H(this,P),this.defaultRadialOptions=(l=e)?this.defaultRadialXOptions:u(this.defaultYAxisOptions,this.defaultRadialYOptions);a.call(this,b,c);if(!j&&(d||g)){a=this.options;if(!b.panes)b.panes=
[];this.pane=(k=b.panes[f]=b.panes[f]||new L(M(h.pane)[f],b,this),f=k);f=f.options;b.inverted=!1;h.chart.zoomType=null;this.startAngleRad=b=(f.startAngle-90)*Math.PI/180;this.endAngleRad=h=(o(f.endAngle,f.startAngle+360)-90)*Math.PI/180;this.offset=a.offset||0;if((this.isCircular=l)&&c.max===void 0&&h-b===2*Math.PI)this.autoConnect=!0}});w(A,"autoLabelAlign",function(a){if(!this.isRadial)return a.apply(this,[].slice.call(arguments,1))});w(z,"getPosition",function(a,b,c,d,g){var e=this.axis;return e.getPosition?
e.getPosition(c):a.call(this,b,c,d,g)});w(z,"getLabelPosition",function(a,b,c,d,g,e,j,l,h){var f=this.axis,k=e.y,n=20,s=e.align,i=(f.translate(this.pos)+f.startAngleRad+Math.PI/2)/Math.PI*180%360;f.isRadial?(a=f.getPosition(this.pos,f.center[2]/2+o(e.distance,-25)),e.rotation==="auto"?d.attr({rotation:i}):k===null&&(k=f.chart.renderer.fontMetrics(d.styles.fontSize).b-d.getBBox().height/2),s===null&&(f.isCircular?(this.label.getBBox().width>f.len*f.tickInterval/(f.max-f.min)&&(n=0),s=i>n&&i<180-n?
"left":i>180+n&&i<360-n?"right":"center"):s="center",d.attr({align:s})),a.x+=e.x,a.y+=k):a=a.call(this,b,c,d,g,e,j,l,h);return a});w(z,"getMarkPath",function(a,b,c,d,g,e,j){var l=this.axis;l.isRadial?(a=l.getPosition(this.pos,l.center[2]/2+d),b=["M",b,c,"L",a.x,a.y]):b=a.call(this,b,c,d,g,e,j);return b});p.arearange=u(p.area,{lineWidth:1,marker:null,threshold:null,tooltip:{pointFormat:'<span style="color:{series.color}">\u25cf</span> {series.name}: <b>{point.low}</b> - <b>{point.high}</b><br/>'},
trackByArea:!0,dataLabels:{align:null,verticalAlign:null,xLow:0,xHigh:0,yLow:0,yHigh:0},states:{hover:{halo:!1}}});i.arearange=v(i.area,{type:"arearange",pointArrayMap:["low","high"],dataLabelCollections:["dataLabel","dataLabelUpper"],toYData:function(a){return[a.low,a.high]},pointValKey:"low",deferTranslatePolar:!0,highToXY:function(a){var b=this.chart,c=this.xAxis.postTranslate(a.rectPlotX,this.yAxis.len-a.plotHigh);a.plotHighX=c.x-b.plotLeft;a.plotHigh=c.y-b.plotTop},translate:function(){var a=
this,b=a.yAxis;i.area.prototype.translate.apply(a);t(a.points,function(a){var d=a.low,g=a.high,e=a.plotY;g===null||d===null?a.isNull=!0:(a.plotLow=e,a.plotHigh=b.translate(g,0,1,0,1))});this.chart.polar&&t(this.points,function(b){a.highToXY(b)})},getGraphPath:function(){var a=this.points,b=[],c=[],d=a.length,g=x.prototype.getGraphPath,e,j,l;l=this.options;for(var h=l.step,d=a.length;d--;)e=a[d],!e.isNull&&(!a[d+1]||a[d+1].isNull)&&c.push({plotX:e.plotX,plotY:e.plotLow}),j={plotX:e.plotX,plotY:e.plotHigh,
isNull:e.isNull},c.push(j),b.push(j),!e.isNull&&(!a[d-1]||a[d-1].isNull)&&c.push({plotX:e.plotX,plotY:e.plotLow});a=g.call(this,a);if(h)h===!0&&(h="left"),l.step={left:"right",center:"center",right:"left"}[h];b=g.call(this,b);c=g.call(this,c);l.step=h;l=[].concat(a,b);!this.chart.polar&&c[0]==="M"&&(c[0]="L");this.areaPath=this.areaPath.concat(a,c);return l},drawDataLabels:function(){var a=this.data,b=a.length,c,d=[],g=x.prototype,e=this.options.dataLabels,j=e.align,l=e.verticalAlign,h=e.inside,f,
k,n=this.chart.inverted;if(e.enabled||this._hasPointLabels){for(c=b;c--;)if(f=a[c]){k=h?f.plotHigh<f.plotLow:f.plotHigh>f.plotLow;f.y=f.high;f._plotY=f.plotY;f.plotY=f.plotHigh;d[c]=f.dataLabel;f.dataLabel=f.dataLabelUpper;f.below=k;if(n){if(!j)e.align=k?"right":"left"}else if(!l)e.verticalAlign=k?"top":"bottom";e.x=e.xHigh;e.y=e.yHigh}g.drawDataLabels&&g.drawDataLabels.apply(this,arguments);for(c=b;c--;)if(f=a[c]){k=h?f.plotHigh<f.plotLow:f.plotHigh>f.plotLow;f.dataLabelUpper=f.dataLabel;f.dataLabel=
d[c];f.y=f.low;f.plotY=f._plotY;f.below=!k;if(n){if(!j)e.align=k?"left":"right"}else if(!l)e.verticalAlign=k?"bottom":"top";e.x=e.xLow;e.y=e.yLow}g.drawDataLabels&&g.drawDataLabels.apply(this,arguments)}e.align=j;e.verticalAlign=l},alignDataLabel:function(){i.column.prototype.alignDataLabel.apply(this,arguments)},setStackedPoints:r,getSymbol:r,drawPoints:r});p.areasplinerange=u(p.arearange);i.areasplinerange=v(i.arearange,{type:"areasplinerange",getPointSpline:i.spline.prototype.getPointSpline});
(function(){var a=i.column.prototype;p.columnrange=u(p.column,p.arearange,{lineWidth:1,pointRange:null});i.columnrange=v(i.arearange,{type:"columnrange",translate:function(){var b=this,c=b.yAxis,d=b.xAxis,g=d.startAngleRad,e,j=b.chart,l=b.xAxis.isRadial,h;a.translate.apply(b);t(b.points,function(a){var k=a.shapeArgs,n=b.options.minPointLength,s,i;a.plotHigh=h=c.translate(a.high,0,1,0,1);a.plotLow=a.plotY;i=h;s=o(a.rectPlotY,a.plotY)-h;Math.abs(s)<n?(n-=s,s+=n,i-=n/2):s<0&&(s*=-1,i-=s);l?(e=a.barX+
g,a.shapeType="path",a.shapeArgs={d:b.polarArc(i+s,i,e,e+a.pointWidth)}):(k.height=s,k.y=i,a.tooltipPos=j.inverted?[c.len+c.pos-j.plotLeft-i-s/2,d.len+d.pos-j.plotTop-k.x-k.width/2,s]:[d.left-j.plotLeft+k.x+k.width/2,c.pos-j.plotTop+i+s/2,s])})},directTouch:!0,trackerGroups:["group","dataLabelsGroup"],drawGraph:r,crispCol:a.crispCol,pointAttrToOptions:a.pointAttrToOptions,drawPoints:a.drawPoints,drawTracker:a.drawTracker,getColumnMetrics:a.getColumnMetrics,animate:function(){return a.animate.apply(this,
arguments)},polarArc:function(){return a.polarArc.apply(this,arguments)}})})();p.gauge=u(p.line,{dataLabels:{enabled:!0,defer:!1,y:15,borderWidth:1,borderColor:"silver",borderRadius:3,crop:!1,verticalAlign:"top",zIndex:2},dial:{},pivot:{},tooltip:{headerFormat:""},showInLegend:!1});C={type:"gauge",pointClass:v(I,{setState:function(a){this.state=a}}),angular:!0,directTouch:!0,drawGraph:r,fixedBox:!0,forceDL:!0,trackerGroups:["group","dataLabelsGroup"],translate:function(){var a=this.yAxis,b=this.options,
c=a.center;this.generatePoints();t(this.points,function(d){var g=u(b.dial,d.dial),e=B(o(g.radius,80))*c[2]/200,j=B(o(g.baseLength,70))*e/100,l=B(o(g.rearLength,10))*e/100,h=g.baseWidth||3,f=g.topWidth||1,k=b.overshoot,n=a.startAngleRad+a.translate(d.y,null,null,null,!0);k&&typeof k==="number"?(k=k/180*Math.PI,n=Math.max(a.startAngleRad-k,Math.min(a.endAngleRad+k,n))):b.wrap===!1&&(n=Math.max(a.startAngleRad,Math.min(a.endAngleRad,n)));n=n*180/Math.PI;d.shapeType="path";d.shapeArgs={d:g.path||["M",
-l,-h/2,"L",j,-h/2,e,-f/2,e,f/2,j,h/2,-l,h/2,"z"],translateX:c[0],translateY:c[1],rotation:n};d.plotX=c[0];d.plotY=c[1]})},drawPoints:function(){var a=this,b=a.yAxis.center,c=a.pivot,d=a.options,g=d.pivot,e=a.chart.renderer;t(a.points,function(b){var g=b.graphic,c=b.shapeArgs,f=c.d,k=u(d.dial,b.dial);g?(g.animate(c),c.d=f):b.graphic=e[b.shapeType](c).attr({stroke:k.borderColor||"none","stroke-width":k.borderWidth||0,fill:k.backgroundColor||"black",rotation:c.rotation,zIndex:1}).add(a.group)});c?c.animate({translateX:b[0],
translateY:b[1]}):a.pivot=e.circle(0,0,o(g.radius,5)).attr({"stroke-width":g.borderWidth||0,stroke:g.borderColor||"silver",fill:g.backgroundColor||"black",zIndex:2}).translate(b[0],b[1]).add(a.group)},animate:function(a){var b=this;if(!a)t(b.points,function(a){var d=a.graphic;d&&(d.attr({rotation:b.yAxis.startAngleRad*180/Math.PI}),d.animate({rotation:a.shapeArgs.rotation},b.options.animation))}),b.animate=null},render:function(){this.group=this.plotGroup("group","series",this.visible?"visible":"hidden",
this.options.zIndex,this.chart.seriesGroup);x.prototype.render.call(this);this.group.clip(this.chart.clipRect)},setData:function(a,b){x.prototype.setData.call(this,a,!1);this.processData();this.generatePoints();o(b,!0)&&this.chart.redraw()},drawTracker:C&&C.drawTrackerPoint};i.gauge=v(i.line,C);p.boxplot=u(p.column,{fillColor:"#FFFFFF",lineWidth:1,medianWidth:2,states:{hover:{brightness:-0.3}},threshold:null,tooltip:{pointFormat:'<span style="color:{point.color}">\u25cf</span> <b> {series.name}</b><br/>Maximum: {point.high}<br/>Upper quartile: {point.q3}<br/>Median: {point.median}<br/>Lower quartile: {point.q1}<br/>Minimum: {point.low}<br/>'},
whiskerLength:"50%",whiskerWidth:2});i.boxplot=v(i.column,{type:"boxplot",pointArrayMap:["low","q1","median","q3","high"],toYData:function(a){return[a.low,a.q1,a.median,a.q3,a.high]},pointValKey:"high",pointAttrToOptions:{fill:"fillColor",stroke:"color","stroke-width":"lineWidth"},drawDataLabels:r,translate:function(){var a=this.yAxis,b=this.pointArrayMap;i.column.prototype.translate.apply(this);t(this.points,function(c){t(b,function(b){c[b]!==null&&(c[b+"Plot"]=a.translate(c[b],0,1,0,1))})})},drawPoints:function(){var a=
this,b=a.options,c=a.chart.renderer,d,g,e,j,l,h,f,k,n,i,m,J,K,p,u,r,w,v,x,y,C,B,z=a.doQuartiles!==!1,A,E=a.options.whiskerLength;t(a.points,function(q){n=q.graphic;C=q.shapeArgs;m={};p={};r={};B=q.color||a.color;if(q.plotY!==void 0)if(d=q.pointAttr[q.selected?"selected":""],w=C.width,v=D(C.x),x=v+w,y=F(w/2),g=D(z?q.q1Plot:q.lowPlot),e=D(z?q.q3Plot:q.lowPlot),j=D(q.highPlot),l=D(q.lowPlot),m.stroke=q.stemColor||b.stemColor||B,m["stroke-width"]=o(q.stemWidth,b.stemWidth,b.lineWidth),m.dashstyle=q.stemDashStyle||
b.stemDashStyle,p.stroke=q.whiskerColor||b.whiskerColor||B,p["stroke-width"]=o(q.whiskerWidth,b.whiskerWidth,b.lineWidth),r.stroke=q.medianColor||b.medianColor||B,r["stroke-width"]=o(q.medianWidth,b.medianWidth,b.lineWidth),f=m["stroke-width"]%2/2,k=v+y+f,i=["M",k,e,"L",k,j,"M",k,g,"L",k,l],z&&(f=d["stroke-width"]%2/2,k=D(k)+f,g=D(g)+f,e=D(e)+f,v+=f,x+=f,J=["M",v,e,"L",v,g,"L",x,g,"L",x,e,"L",v,e,"z"]),E&&(f=p["stroke-width"]%2/2,j+=f,l+=f,A=/%$/.test(E)?y*parseFloat(E)/100:E/2,K=["M",k-A,j,"L",k+
A,j,"M",k-A,l,"L",k+A,l]),f=r["stroke-width"]%2/2,h=F(q.medianPlot)+f,u=["M",v,h,"L",x,h],n)q.stem.animate({d:i}),E&&q.whiskers.animate({d:K}),z&&q.box.animate({d:J}),q.medianShape.animate({d:u});else{q.graphic=n=c.g().add(a.group);q.stem=c.path(i).attr(m).add(n);if(E)q.whiskers=c.path(K).attr(p).add(n);if(z)q.box=c.path(J).attr(d).add(n);q.medianShape=c.path(u).attr(r).add(n)}})},setStackedPoints:r});p.errorbar=u(p.boxplot,{color:"#000000",grouping:!1,linkedTo:":previous",tooltip:{pointFormat:'<span style="color:{point.color}">\u25cf</span> {series.name}: <b>{point.low}</b> - <b>{point.high}</b><br/>'},
whiskerWidth:null});i.errorbar=v(i.boxplot,{type:"errorbar",pointArrayMap:["low","high"],toYData:function(a){return[a.low,a.high]},pointValKey:"high",doQuartiles:!1,drawDataLabels:i.arearange?i.arearange.prototype.drawDataLabels:r,getColumnMetrics:function(){return this.linkedParent&&this.linkedParent.columnMetrics||i.column.prototype.getColumnMetrics.call(this)}});p.waterfall=u(p.column,{lineWidth:1,lineColor:"#333",dashStyle:"dot",borderColor:"#333",dataLabels:{inside:!0},states:{hover:{lineWidthPlus:0}}});
i.waterfall=v(i.column,{type:"waterfall",upColorProp:"fill",pointValKey:"y",translate:function(){var a=this.options,b=this.yAxis,c,d,g,e,j,l,h,f,k,n=o(a.minPointLength,5),s=a.threshold,m=a.stacking;i.column.prototype.translate.apply(this);this.minPointLengthOffset=0;h=f=s;d=this.points;for(c=0,a=d.length;c<a;c++){g=d[c];l=this.processedYData[c];e=g.shapeArgs;k=(j=m&&b.stacks[(this.negStacks&&l<s?"-":"")+this.stackKey])?j[g.x].points[this.index+","+c]:[0,l];if(g.isSum)g.y=G(l);else if(g.isIntermediateSum)g.y=
G(l-f);j=O(h,h+g.y)+k[0];e.y=b.translate(j,0,1);if(g.isSum)e.y=b.translate(k[1],0,1),e.height=Math.min(b.translate(k[0],0,1),b.len)-e.y+this.minPointLengthOffset;else if(g.isIntermediateSum)e.y=b.translate(k[1],0,1),e.height=Math.min(b.translate(f,0,1),b.len)-e.y+this.minPointLengthOffset,f=k[1];else{if(h!==0)e.height=l>0?b.translate(h,0,1)-e.y:b.translate(h,0,1)-b.translate(h-l,0,1);h+=l}e.height<0&&(e.y+=e.height,e.height*=-1);g.plotY=e.y=F(e.y)-this.borderWidth%2/2;e.height=O(F(e.height),0.001);
g.yBottom=e.y+e.height;if(e.height<=n)e.height=n,this.minPointLengthOffset+=n;e.y-=this.minPointLengthOffset;e=g.plotY+(g.negative?e.height:0)-this.minPointLengthOffset;this.chart.inverted?g.tooltipPos[0]=b.len-e:g.tooltipPos[1]=e}},processData:function(a){var b=this.yData,c=this.options.data,d,g=b.length,e,j,l,h,f,k;j=e=l=h=this.options.threshold||0;for(k=0;k<g;k++)f=b[k],d=c&&c[k]?c[k]:{},f==="sum"||d.isSum?b[k]=G(j):f==="intermediateSum"||d.isIntermediateSum?b[k]=G(e):(j+=f,e+=f),l=Math.min(j,
l),h=Math.max(j,h);x.prototype.processData.call(this,a);this.dataMin=l;this.dataMax=h},toYData:function(a){return a.isSum?a.x===0?null:"sum":a.isIntermediateSum?a.x===0?null:"intermediateSum":a.y},getAttribs:function(){i.column.prototype.getAttribs.apply(this,arguments);var a=this,b=a.options,c=b.states,d=b.upColor||a.color,b=m.Color(d).brighten(0.1).get(),g=u(a.pointAttr),e=a.upColorProp;g[""][e]=d;g.hover[e]=c.hover.upColor||b;g.select[e]=c.select.upColor||d;t(a.points,function(e){if(!e.options.color)e.y>
0?(e.pointAttr=g,e.color=d):e.pointAttr=a.pointAttr})},getGraphPath:function(){var a=this.data,b=a.length,c=F(this.options.lineWidth+this.borderWidth)%2/2,d=[],g,e,j;for(j=1;j<b;j++)e=a[j].shapeArgs,g=a[j-1].shapeArgs,e=["M",g.x+g.width,g.y+c,"L",e.x,g.y+c],a[j-1].y<0&&(e[2]+=g.height,e[5]+=g.height),d=d.concat(e);return d},getExtremes:r,drawGraph:x.prototype.drawGraph});p.polygon=u(p.scatter,{marker:{enabled:!1}});i.polygon=v(i.scatter,{type:"polygon",fillGraph:!0,getSegmentPath:function(a){return x.prototype.getSegmentPath.call(this,
a).concat("z")},drawGraph:x.prototype.drawGraph,drawLegendSymbol:m.LegendSymbolMixin.drawRectangle});p.bubble=u(p.scatter,{dataLabels:{formatter:function(){return this.point.z},inside:!0,verticalAlign:"middle"},marker:{lineColor:null,lineWidth:1},minSize:8,maxSize:"20%",softThreshold:!1,states:{hover:{halo:{size:5}}},tooltip:{pointFormat:"({point.x}, {point.y}), Size: {point.z}"},turboThreshold:0,zThreshold:0,zoneAxis:"z"});C=v(I,{haloPath:function(){return I.prototype.haloPath.call(this,this.shapeArgs.r+
this.series.options.states.hover.halo.size)},ttBelow:!1});i.bubble=v(i.scatter,{type:"bubble",pointClass:C,pointArrayMap:["y","z"],parallelArrays:["x","y","z"],trackerGroups:["group","dataLabelsGroup"],bubblePadding:!0,zoneAxis:"z",pointAttrToOptions:{stroke:"lineColor","stroke-width":"lineWidth",fill:"fillColor"},applyOpacity:function(a){var b=this.options.marker,c=o(b.fillOpacity,0.5),a=a||b.fillColor||this.color;c!==1&&(a=V(a).setOpacity(c).get("rgba"));return a},convertAttribs:function(){var a=
x.prototype.convertAttribs.apply(this,arguments);a.fill=this.applyOpacity(a.fill);return a},getRadii:function(a,b,c,d){var g,e,j,l=this.zData,h=[],f=this.options,k=f.sizeBy!=="width",n=f.zThreshold,i=b-a;for(e=0,g=l.length;e<g;e++)j=l[e],f.sizeByAbsoluteValue&&j!==null&&(j=Math.abs(j-n),b=Math.max(b-n,Math.abs(a-n)),a=0),j===null?j=null:j<a?j=c/2-1:(j=i>0?(j-a)/i:0.5,k&&j>=0&&(j=Math.sqrt(j)),j=y.ceil(c+j*(d-c))/2),h.push(j);this.radii=h},animate:function(a){var b=this.options.animation;if(!a)t(this.points,
function(a){var d=a.graphic,a=a.shapeArgs;d&&a&&(d.attr("r",1),d.animate({r:a.r},b))}),this.animate=null},translate:function(){var a,b=this.data,c,d,g=this.radii;i.scatter.prototype.translate.call(this);for(a=b.length;a--;)c=b[a],d=g?g[a]:0,typeof d==="number"&&d>=this.minPxSize/2?(c.shapeType="circle",c.shapeArgs={x:c.plotX,y:c.plotY,r:d},c.dlBox={x:c.plotX-d,y:c.plotY-d,width:2*d,height:2*d}):c.shapeArgs=c.plotY=c.dlBox=void 0},drawLegendSymbol:function(a,b){var c=this.chart.renderer,d=c.fontMetrics(a.itemStyle.fontSize).f/
2;b.legendSymbol=c.circle(d,a.baseline-d,d).attr({zIndex:3}).add(b.legendGroup);b.legendSymbol.isMarker=!0},drawPoints:i.column.prototype.drawPoints,alignDataLabel:i.column.prototype.alignDataLabel,buildKDTree:r,applyZones:r});N.prototype.beforePadding=function(){var a=this,b=this.len,c=this.chart,d=0,g=b,e=this.isXAxis,j=e?"xData":"yData",l=this.min,h={},f=y.min(c.plotWidth,c.plotHeight),k=Number.MAX_VALUE,n=-Number.MAX_VALUE,i=this.max-l,m=b/i,p=[];t(this.series,function(b){var g=b.options;if(b.bubblePadding&&
(b.visible||!c.options.chart.ignoreHiddenSeries))if(a.allowZoomOutside=!0,p.push(b),e)t(["minSize","maxSize"],function(a){var b=g[a],e=/%$/.test(b),b=B(b);h[a]=e?f*b/100:b}),b.minPxSize=h.minSize,b.maxPxSize=h.maxSize,b=b.zData,b.length&&(k=o(g.zMin,y.min(k,y.max(Q(b),g.displayNegative===!1?g.zThreshold:-Number.MAX_VALUE))),n=o(g.zMax,y.max(n,R(b))))});t(p,function(b){var c=b[j],f=c.length,h;e&&b.getRadii(k,n,b.minPxSize,b.maxPxSize);if(i>0)for(;f--;)typeof c[f]==="number"&&a.dataMin<=c[f]&&c[f]<=
a.dataMax&&(h=b.radii[f],d=Math.min((c[f]-l)*m-h,d),g=Math.max((c[f]-l)*m+h,g))});p.length&&i>0&&!this.isLog&&(g-=b,m*=(b+d-g)/b,t([["min","userMin",d],["max","userMax",g]],function(b){o(a.options[b[0]],a[b[1]])===void 0&&(a[b[0]]+=b[2]/m)}))};(function(){function a(a,b){var c=this.chart,d=this.options.animation,h=this.group,f=this.markerGroup,k=this.xAxis.center,i=c.plotLeft,m=c.plotTop;if(c.polar){if(c.renderer.isSVG)d===!0&&(d={}),b?(c={translateX:k[0]+i,translateY:k[1]+m,scaleX:0.001,scaleY:0.001},
h.attr(c),f&&f.attr(c)):(c={translateX:i,translateY:m,scaleX:1,scaleY:1},h.animate(c,d),f&&f.animate(c,d),this.animate=null)}else a.call(this,b)}var b=x.prototype,c=T.prototype,d;b.searchPointByAngle=function(a){var b=this.chart,c=this.xAxis.pane.center;return this.searchKDTree({clientX:180+Math.atan2(a.chartX-c[0]-b.plotLeft,a.chartY-c[1]-b.plotTop)*(-180/Math.PI)})};w(b,"buildKDTree",function(a){if(this.chart.polar)this.kdByAngle?this.searchPoint=this.searchPointByAngle:this.kdDimensions=2;a.apply(this)});
b.toXY=function(a){var b,c=this.chart,d=a.plotX;b=a.plotY;a.rectPlotX=d;a.rectPlotY=b;b=this.xAxis.postTranslate(a.plotX,this.yAxis.len-b);a.plotX=a.polarPlotX=b.x-c.plotLeft;a.plotY=a.polarPlotY=b.y-c.plotTop;this.kdByAngle?(c=(d/Math.PI*180+this.xAxis.pane.options.startAngle)%360,c<0&&(c+=360),a.clientX=c):a.clientX=a.plotX};i.spline&&w(i.spline.prototype,"getPointSpline",function(a,b,c,d){var h,f,k,i,m,p,o;if(this.chart.polar){h=c.plotX;f=c.plotY;a=b[d-1];k=b[d+1];this.connectEnds&&(a||(a=b[b.length-
2]),k||(k=b[1]));if(a&&k)i=a.plotX,m=a.plotY,b=k.plotX,p=k.plotY,i=(1.5*h+i)/2.5,m=(1.5*f+m)/2.5,k=(1.5*h+b)/2.5,o=(1.5*f+p)/2.5,b=Math.sqrt(Math.pow(i-h,2)+Math.pow(m-f,2)),p=Math.sqrt(Math.pow(k-h,2)+Math.pow(o-f,2)),i=Math.atan2(m-f,i-h),m=Math.atan2(o-f,k-h),o=Math.PI/2+(i+m)/2,Math.abs(i-o)>Math.PI/2&&(o-=Math.PI),i=h+Math.cos(o)*b,m=f+Math.sin(o)*b,k=h+Math.cos(Math.PI+o)*p,o=f+Math.sin(Math.PI+o)*p,c.rightContX=k,c.rightContY=o;d?(c=["C",a.rightContX||a.plotX,a.rightContY||a.plotY,i||h,m||
f,h,f],a.rightContX=a.rightContY=null):c=["M",h,f]}else c=a.call(this,b,c,d);return c});w(b,"translate",function(a){var b=this.chart;a.call(this);if(b.polar&&(this.kdByAngle=b.tooltip&&b.tooltip.shared,!this.preventPostTranslate)){a=this.points;for(b=a.length;b--;)this.toXY(a[b])}});w(b,"getGraphPath",function(a,b){var c=this;if(this.chart.polar){b=b||this.points;if(this.options.connectEnds!==!1&&b[0].y!==null)this.connectEnds=!0,b.splice(b.length,0,b[0]);t(b,function(a){a.polarPlotY===void 0&&c.toXY(a)})}return a.apply(this,
[].slice.call(arguments,1))});w(b,"animate",a);if(i.column)d=i.column.prototype,d.polarArc=function(a,b,c,d){var h=this.xAxis.center,f=this.yAxis.len;return this.chart.renderer.symbols.arc(h[0],h[1],f-b,null,{start:c,end:d,innerR:f-o(a,f)})},w(d,"animate",a),w(d,"translate",function(a){var b=this.xAxis,c=b.startAngleRad,d,h,f;this.preventPostTranslate=!0;a.call(this);if(b.isRadial){d=this.points;for(f=d.length;f--;)h=d[f],a=h.barX+c,h.shapeType="path",h.shapeArgs=this.polarArc(h.yBottom,h.plotY,a,
a+h.pointWidth),this.toXY(h),h.tooltipPos=[h.plotX,h.plotY],h.ttBelow=h.plotY>b.center[1]}}),w(d,"alignDataLabel",function(a,c,d,i,h,f){if(this.chart.polar){a=c.rectPlotX/Math.PI*180;if(i.align===null)i.align=a>20&&a<160?"left":a>200&&a<340?"right":"center";if(i.verticalAlign===null)i.verticalAlign=a<45||a>315?"bottom":a>135&&a<225?"top":"middle";b.alignDataLabel.call(this,c,d,i,h,f)}else a.call(this,c,d,i,h,f)});w(c,"getCoordinates",function(a,b){var c=this.chart,d={xAxis:[],yAxis:[]};c.polar?t(c.axes,
function(a){var f=a.isXAxis,g=a.center,i=b.chartX-g[0]-c.plotLeft,g=b.chartY-g[1]-c.plotTop;d[f?"xAxis":"yAxis"].push({axis:a,value:a.translate(f?Math.PI-Math.atan2(i,g):Math.sqrt(Math.pow(i,2)+Math.pow(g,2)),!0)})}):d=a.call(this,b);return d})})()});

},{}],2:[function(require,module,exports){
/*
 Highstock JS v4.2.4 (2016-04-14)

 (c) 2009-2016 Torstein Honsi

 License: www.highcharts.com/license
*/
(function(J,ga){typeof module==="object"&&module.exports?module.exports=J.document?ga(J):ga:J.Highcharts=ga(J)})(typeof window!=="undefined"?window:this,function(J){function ga(a,b){var c="Highcharts error #"+a+": www.highcharts.com/errors/"+a;if(b)throw Error(c);J.console&&console.log(c)}function yb(a,b,c){this.options=b;this.elem=a;this.prop=c}function C(){var a,b=arguments,c,d={},e=function(a,b){var c,d;typeof a!=="object"&&(a={});for(d in b)b.hasOwnProperty(d)&&(c=b[d],a[d]=c&&typeof c==="object"&&
Object.prototype.toString.call(c)!=="[object Array]"&&d!=="renderTo"&&typeof c.nodeType!=="number"?e(a[d]||{},c):b[d]);return a};b[0]===!0&&(d=b[1],b=Array.prototype.slice.call(b,2));c=b.length;for(a=0;a<c;a++)d=e(d,b[a]);return d}function G(a,b){return parseInt(a,b||10)}function Da(a){return typeof a==="string"}function da(a){return a&&typeof a==="object"}function Ja(a){return Object.prototype.toString.call(a)==="[object Array]"}function ua(a){return typeof a==="number"}function Aa(a,b){for(var c=
a.length;c--;)if(a[c]===b){a.splice(c,1);break}}function s(a){return a!==t&&a!==null}function X(a,b,c){var d,e;if(Da(b))s(c)?a.setAttribute(b,c):a&&a.getAttribute&&(e=a.getAttribute(b));else if(s(b)&&da(b))for(d in b)a.setAttribute(d,b[d]);return e}function va(a){return Ja(a)?a:[a]}function $a(a,b,c){if(b)return setTimeout(a,b,c);a.call(0,c)}function F(a,b){if(Ka&&!ja&&b&&b.opacity!==t)b.filter="alpha(opacity="+b.opacity*100+")";x(a.style,b)}function ea(a,b,c,d,e){a=B.createElement(a);b&&x(a,b);e&&
F(a,{padding:0,border:"none",margin:0});c&&F(a,c);d&&d.appendChild(a);return a}function la(a,b){var c=function(){};c.prototype=new a;x(c.prototype,b);return c}function Na(a,b,c){return Array((b||2)+1-String(a).length).join(c||0)+a}function fb(a){return(gb&&gb(a)||zb||0)*6E4}function La(a,b){for(var c="{",d=!1,e,f,g,h,i,j=[];(c=a.indexOf(c))!==-1;){e=a.slice(0,c);if(d){f=e.split(":");g=f.shift().split(".");i=g.length;e=b;for(h=0;h<i;h++)e=e[g[h]];if(f.length)f=f.join(":"),g=/\.([0-9])/,h=N.lang,i=
void 0,/f$/.test(f)?(i=(i=f.match(g))?i[1]:-1,e!==null&&(e=z.numberFormat(e,i,h.decimalPoint,f.indexOf(",")>-1?h.thousandsSep:""))):e=ma(f,e)}j.push(e);a=a.slice(c+1);c=(d=!d)?"}":"{"}j.push(a);return j.join("")}function Ab(a){return Y.pow(10,V(Y.log(a)/Y.LN10))}function Bb(a,b,c,d,e){var f,g=a,c=q(c,1);f=a/c;b||(b=[1,2,2.5,5,10],d===!1&&(c===1?b=[1,2,5,10]:c<=0.1&&(b=[1/c])));for(d=0;d<b.length;d++)if(g=b[d],e&&g*c>=a||!e&&f<=(b[d]+(b[d+1]||b[d]))/2)break;g*=c;return g}function ob(a,b){var c=a.length,
d,e;for(e=0;e<c;e++)a[e].safeI=e;a.sort(function(a,c){d=b(a,c);return d===0?a.safeI-c.safeI:d});for(e=0;e<c;e++)delete a[e].safeI}function Oa(a){for(var b=a.length,c=a[0];b--;)a[b]<c&&(c=a[b]);return c}function Ea(a){for(var b=a.length,c=a[0];b--;)a[b]>c&&(c=a[b]);return c}function Pa(a,b){for(var c in a)a[c]&&a[c]!==b&&a[c].destroy&&a[c].destroy(),delete a[c]}function Va(a){pb||(pb=ea(Wa));a&&pb.appendChild(a);pb.innerHTML=""}function na(a,b){return parseFloat(a.toPrecision(b||14))}function ab(a,
b){b.renderer.globalAnimation=q(a,b.animation)}function hb(a){return da(a)?C(a):{duration:a?500:0}}function Ob(){var a=N.global,b=a.useUTC,c=b?"getUTC":"get",d=b?"setUTC":"set";fa=a.Date||J.Date;zb=b&&a.timezoneOffset;gb=b&&a.getTimezoneOffset;qb=function(a,c,d,h,i,j){var k;b?(k=fa.UTC.apply(0,arguments),k+=fb(k)):k=(new fa(a,c,q(d,1),q(h,0),q(i,0),q(j,0))).getTime();return k};Cb=c+"Minutes";Db=c+"Hours";Eb=c+"Day";bb=c+"Date";ib=c+"Month";jb=c+"FullYear";Pb=d+"Milliseconds";Qb=d+"Seconds";Rb=d+"Minutes";
Sb=d+"Hours";rb=d+"Date";Fb=d+"Month";Gb=d+"FullYear"}function wa(a){if(!(this instanceof wa))return new wa(a);this.init(a)}function Z(){}function cb(a,b,c,d){this.axis=a;this.pos=b;this.type=c||"";this.isNew=!0;!c&&!d&&this.addLabel()}function Tb(a,b,c,d,e){var f=a.chart.inverted;this.axis=a;this.isNegative=c;this.options=b;this.x=d;this.total=null;this.points={};this.stack=e;this.rightCliff=this.leftCliff=0;this.alignOptions={align:b.align||(f?c?"left":"right":"center"),verticalAlign:b.verticalAlign||
(f?"middle":c?"bottom":"top"),y:q(b.y,f?4:c?14:-6),x:q(b.x,f?c?-6:6:0)};this.textAlign=b.textAlign||(f?c?"right":"left":"center")}function Hb(a){var b=a.options,c=b.navigator,d=c.enabled,b=b.scrollbar,e=b.enabled,f=d?c.height:0,g=e?b.height:0;this.handles=[];this.scrollbarButtons=[];this.elementsToDestroy=[];this.chart=a;this.setBaseSeries();this.height=f;this.scrollbarHeight=g;this.scrollbarEnabled=e;this.navigatorEnabled=d;this.navigatorOptions=c;this.scrollbarOptions=b;this.outlineHeight=f+g;this.init()}
function Ib(a){this.init(a)}var t,B=J.document,Y=Math,y=Y.round,V=Y.floor,Fa=Y.ceil,v=Y.max,E=Y.min,S=Y.abs,ba=Y.cos,ka=Y.sin,Ba=Y.PI,pa=Ba*2/360,Ma=J.navigator&&J.navigator.userAgent||"",Ub=J.opera,Ka=/(msie|trident|edge)/i.test(Ma)&&!Ub,sb=B&&B.documentMode===8,tb=!Ka&&/AppleWebKit/.test(Ma),Xa=/Firefox/.test(Ma),kb=/(Mobile|Android|Windows Phone)/.test(Ma),Qa="http://www.w3.org/2000/svg",ja=B&&B.createElementNS&&!!B.createElementNS(Qa,"svg").createSVGRect,Zb=Xa&&parseInt(Ma.split("Firefox/")[1],
10)<4,qa=B&&!ja&&!Ka&&!!B.createElement("canvas").getContext,Ya,db,Vb={},Jb=0,pb,N,ma,H,ra=function(){},$=[],lb=0,Wa="div",$b=/^[0-9]+$/,ub=["plotTop","marginRight","marginBottom","plotLeft"],fa,qb,zb,gb,Cb,Db,Eb,bb,ib,jb,Pb,Qb,Rb,Sb,rb,Fb,Gb,K={},z;z=J.Highcharts?ga(16,!0):{win:J};z.seriesTypes=K;var Ra=[],xa,sa,n,Sa,Kb,ta,D,T,M,eb,Ta;yb.prototype={dSetter:function(){var a=this.paths[0],b=this.paths[1],c=[],d=this.now,e=a.length,f;if(d===1)c=this.toD;else if(e===b.length&&d<1)for(;e--;)f=parseFloat(a[e]),
c[e]=isNaN(f)?a[e]:d*parseFloat(b[e]-f)+f;else c=b;this.elem.attr("d",c)},update:function(){var a=this.elem,b=this.prop,c=this.now,d=this.options.step;if(this[b+"Setter"])this[b+"Setter"]();else a.attr?a.element&&a.attr(b,c):a.style[b]=c+this.unit;d&&d.call(a,c,this)},run:function(a,b,c){var d=this,e=function(a){return e.stopped?!1:d.step(a)},f;this.startTime=+new fa;this.start=a;this.end=b;this.unit=c;this.now=this.start;this.pos=0;e.elem=this.elem;if(e()&&Ra.push(e)===1)e.timerId=setInterval(function(){for(f=
0;f<Ra.length;f++)Ra[f]()||Ra.splice(f--,1);Ra.length||clearInterval(e.timerId)},13)},step:function(a){var b=+new fa,c,d=this.options;c=this.elem;var e=d.complete,f=d.duration,g=d.curAnim,h;if(c.attr&&!c.element)c=!1;else if(a||b>=f+this.startTime){this.now=this.end;this.pos=1;this.update();a=g[this.prop]=!0;for(h in g)g[h]!==!0&&(a=!1);a&&e&&e.call(c);c=!1}else this.pos=d.easing((b-this.startTime)/f),this.now=this.start+(this.end-this.start)*this.pos,this.update(),c=!0;return c},initPath:function(a,
b,c){var b=b||"",d=a.shift,e=b.indexOf("C")>-1,f=e?7:3,g,b=b.split(" "),c=[].concat(c),h=a.isArea,i=h?2:1,j=function(a){for(g=a.length;g--;)(a[g]==="M"||a[g]==="L")&&a.splice(g+1,0,a[g+1],a[g+2],a[g+1],a[g+2])};e&&(j(b),j(c));if(d<=c.length/f&&b.length===c.length)for(;d--;)c=c.slice(0,f).concat(c),h&&(c=c.concat(c.slice(c.length-f)));a.shift=0;if(b.length)for(a=c.length;b.length<a;)d=b.slice().splice(b.length/i-f,f*i),e&&(d[f-6]=d[f-2],d[f-5]=d[f-1]),[].splice.apply(b,[b.length/i,0].concat(d));return[b,
c]}};var x=z.extend=function(a,b){var c;a||(a={});for(c in b)a[c]=b[c];return a},q=z.pick=function(){var a=arguments,b,c,d=a.length;for(b=0;b<d;b++)if(c=a[b],c!==t&&c!==null)return c},U=z.wrap=function(a,b,c){var d=a[b];a[b]=function(){var a=Array.prototype.slice.call(arguments);a.unshift(d);return c.apply(this,a)}};ma=function(a,b,c){if(!s(b)||isNaN(b))return N.lang.invalidDate||"";var a=q(a,"%Y-%m-%d %H:%M:%S"),d=new fa(b-fb(b)),e,f=d[Db](),g=d[Eb](),h=d[bb](),i=d[ib](),j=d[jb](),k=N.lang,l=k.weekdays,
m=k.shortWeekdays,d=x({a:m?m[g]:l[g].substr(0,3),A:l[g],d:Na(h),e:Na(h,2," "),w:g,b:k.shortMonths[i],B:k.months[i],m:Na(i+1),y:j.toString().substr(2,2),Y:j,H:Na(f),k:f,I:Na(f%12||12),l:f%12||12,M:Na(d[Cb]()),p:f<12?"AM":"PM",P:f<12?"am":"pm",S:Na(d.getSeconds()),L:Na(y(b%1E3),3)},z.dateFormats);for(e in d)for(;a.indexOf("%"+e)!==-1;)a=a.replace("%"+e,typeof d[e]==="function"?d[e](b):d[e]);return c?a.substr(0,1).toUpperCase()+a.substr(1):a};H={millisecond:1,second:1E3,minute:6E4,hour:36E5,day:864E5,
week:6048E5,month:24192E5,year:314496E5};z.numberFormat=function(a,b,c,d){var a=+a||0,e=N.lang,f=(a.toString().split(".")[1]||"").length,g,h,i=Math.abs(a);b===-1?b=Math.min(f,20):isNaN(b)&&(b=2);g=String(G(i.toFixed(b)));h=g.length>3?g.length%3:0;c=q(c,e.decimalPoint);d=q(d,e.thousandsSep);a=a<0?"-":"";a+=h?g.substr(0,h)+d:"";a+=g.substr(h).replace(/(\d{3})(?=\d)/g,"$1"+d);+b&&(d=Math.abs(i-g+Math.pow(10,-Math.max(b,f)-1)),a+=c+d.toFixed(b).slice(2));return a};Math.easeInOutSine=function(a){return-0.5*
(Math.cos(Math.PI*a)-1)};xa=function(a,b){var c;if(b==="width")return Math.min(a.offsetWidth,a.scrollWidth)-xa(a,"padding-left")-xa(a,"padding-right");else if(b==="height")return Math.min(a.offsetHeight,a.scrollHeight)-xa(a,"padding-top")-xa(a,"padding-bottom");return(c=J.getComputedStyle(a,void 0))&&G(c.getPropertyValue(b))};sa=function(a,b){return b.indexOf?b.indexOf(a):[].indexOf.call(b,a)};Sa=function(a,b){return[].filter.call(a,b)};ta=function(a,b){for(var c=[],d=0,e=a.length;d<e;d++)c[d]=b.call(a[d],
a[d],d,a);return c};Kb=function(a){var b=B.documentElement,a=a.getBoundingClientRect();return{top:a.top+(J.pageYOffset||b.scrollTop)-(b.clientTop||0),left:a.left+(J.pageXOffset||b.scrollLeft)-(b.clientLeft||0)}};Ta=function(a){for(var b=Ra.length;b--;)if(Ra[b].elem===a)Ra[b].stopped=!0};n=function(a,b){return Array.prototype.forEach.call(a,b)};D=function(a,b,c){function d(b){b.target=b.srcElement||J;c.call(a,b)}var e=a.hcEvents=a.hcEvents||{};if(a.addEventListener)a.addEventListener(b,c,!1);else if(a.attachEvent){if(!a.hcEventsIE)a.hcEventsIE=
{};a.hcEventsIE[c.toString()]=d;a.attachEvent("on"+b,d)}e[b]||(e[b]=[]);e[b].push(c)};T=function(a,b,c){function d(b,c){a.removeEventListener?a.removeEventListener(b,c,!1):a.attachEvent&&(c=a.hcEventsIE[c.toString()],a.detachEvent("on"+b,c))}function e(){var c,e,f;if(a.nodeName)for(f in b?(c={},c[b]=!0):c=g,c)if(g[f])for(e=g[f].length;e--;)d(f,g[f][e])}var f,g=a.hcEvents,h;if(g)b?(f=g[b]||[],c?(h=sa(c,f),h>-1&&(f.splice(h,1),g[b]=f),d(b,c)):(e(),g[b]=[])):(e(),a.hcEvents={})};M=function(a,b,c,d){var e;
e=a.hcEvents;var f,g,c=c||{};if(B.createEvent&&(a.dispatchEvent||a.fireEvent))e=B.createEvent("Events"),e.initEvent(b,!0,!0),e.target=a,x(e,c),a.dispatchEvent?a.dispatchEvent(e):a.fireEvent(b,e);else if(e){e=e[b]||[];f=e.length;if(!c.preventDefault)c.preventDefault=function(){c.defaultPrevented=!0};c.target=a;if(!c.type)c.type=b;for(b=0;b<f;b++)g=e[b],g.call(a,c)===!1&&c.preventDefault()}d&&!c.defaultPrevented&&d(c)};eb=function(a,b,c){var d,e="",f,g,h;da(c)||(d=arguments,c={duration:d[2],easing:d[3],
complete:d[4]});if(!ua(c.duration))c.duration=400;c.easing=typeof c.easing==="function"?c.easing:Math[c.easing]||Math.easeInOutSine;c.curAnim=C(b);for(h in b)g=new yb(a,c,h),f=null,h==="d"?(g.paths=g.initPath(a,a.d,b.d),g.toD=b.d,d=0,f=1):a.attr?d=a.attr(h):(d=parseFloat(xa(a,h))||0,h!=="opacity"&&(e="px")),f||(f=b[h]),f.match&&f.match("px")&&(f=f.replace(/px/g,"")),g.run(d,f,e)};if(J.jQuery)J.jQuery.fn.highcharts=function(){var a=[].slice.call(arguments);if(this[0])return a[0]?(new (z[Da(a[0])?a.shift():
"Chart"])(this[0],a[0],a[1]),this):$[X(this[0],"data-highcharts-chart")]};B&&!B.defaultView&&(xa=function(a,b){var c;c={width:"clientWidth",height:"clientHeight"}[b];if(a.style[b])return G(a.style[b]);b==="opacity"&&(b="filter");if(c)return a.style.zoom=1,Math.max(a[c]-2*xa(a,"padding"),0);c=a.currentStyle[b.replace(/\-(\w)/g,function(a,b){return b.toUpperCase()})];b==="filter"&&(c=c.replace(/alpha\(opacity=([0-9]+)\)/,function(a,b){return b/100}));return c===""?1:G(c)});Array.prototype.forEach||
(n=function(a,b){for(var c=0,d=a.length;c<d;c++)if(b.call(a[c],a[c],c,a)===!1)return c});Array.prototype.indexOf||(sa=function(a,b){var c,d=0;if(b)for(c=b.length;d<c;d++)if(b[d]===a)return d;return-1});Array.prototype.filter||(Sa=function(a,b){for(var c=[],d=0,e=a.length;d<e;d++)b(a[d],d)&&c.push(a[d]);return c});z.Fx=yb;z.inArray=sa;z.each=n;z.grep=Sa;z.offset=Kb;z.map=ta;z.addEvent=D;z.removeEvent=T;z.fireEvent=M;z.animate=eb;z.animObject=hb;z.stop=Ta;N={colors:"#7cb5ec,#434348,#90ed7d,#f7a35c,#8085e9,#f15c80,#e4d354,#2b908f,#f45b5b,#91e8e1".split(","),
symbols:["circle","diamond","square","triangle","triangle-down"],lang:{loading:"Loading...",months:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),shortMonths:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),weekdays:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),decimalPoint:".",numericSymbols:"k,M,G,T,P,E".split(","),resetZoom:"Reset zoom",resetZoomTitle:"Reset zoom level 1:1",thousandsSep:" "},global:{useUTC:!0,
canvasToolsURL:"http://code.highcharts.com/modules/canvas-tools.js",VMLRadialGradientURL:"http://code.highcharts.com/stock/4.2.4/gfx/vml-radial-gradient.png"},chart:{borderColor:"#4572A7",borderRadius:0,defaultSeriesType:"line",ignoreHiddenSeries:!0,spacing:[10,10,15,10],backgroundColor:"#FFFFFF",plotBorderColor:"#C0C0C0",resetZoomButton:{theme:{zIndex:20},position:{align:"right",x:-10,y:10}}},title:{text:"Chart title",align:"center",margin:15,style:{color:"#333333",fontSize:"18px"}},subtitle:{text:"",
align:"center",style:{color:"#555555"}},plotOptions:{line:{allowPointSelect:!1,showCheckbox:!1,animation:{duration:1E3},events:{},lineWidth:2,marker:{lineWidth:0,radius:4,lineColor:"#FFFFFF",states:{hover:{enabled:!0,lineWidthPlus:1,radiusPlus:2},select:{fillColor:"#FFFFFF",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:{align:"center",formatter:function(){return this.y===null?"":z.numberFormat(this.y,-1)},style:{color:"contrast",fontSize:"11px",fontWeight:"bold",textShadow:"0 0 6px contrast, 0 0 3px contrast"},
verticalAlign:"bottom",x:0,y:0,padding:5},cropThreshold:300,pointRange:0,softThreshold:!0,states:{hover:{lineWidthPlus:1,marker:{},halo:{size:10,opacity:0.25}},select:{marker:{}}},stickyTracking:!0,turboThreshold:1E3}},labels:{style:{position:"absolute",color:"#3E576F"}},legend:{enabled:!0,align:"center",layout:"horizontal",labelFormatter:function(){return this.name},borderColor:"#909090",borderRadius:0,navigation:{activeColor:"#274b6d",inactiveColor:"#CCC"},shadow:!1,itemStyle:{color:"#333333",fontSize:"12px",
fontWeight:"bold"},itemHoverStyle:{color:"#000"},itemHiddenStyle:{color:"#CCC"},itemCheckboxStyle:{position:"absolute",width:"13px",height:"13px"},symbolPadding:5,verticalAlign:"bottom",x:0,y:0,title:{style:{fontWeight:"bold"}}},loading:{labelStyle:{fontWeight:"bold",position:"relative",top:"45%"},style:{position:"absolute",backgroundColor:"white",opacity:0.5,textAlign:"center"}},tooltip:{enabled:!0,animation:ja,backgroundColor:"rgba(249, 249, 249, .85)",borderWidth:1,borderRadius:3,dateTimeLabelFormats:{millisecond:"%A, %b %e, %H:%M:%S.%L",
second:"%A, %b %e, %H:%M:%S",minute:"%A, %b %e, %H:%M",hour:"%A, %b %e, %H:%M",day:"%A, %b %e, %Y",week:"Week from %A, %b %e, %Y",month:"%B %Y",year:"%Y"},footerFormat:"",headerFormat:'<span style="font-size: 10px">{point.key}</span><br/>',pointFormat:'<span style="color:{point.color}">\u25cf</span> {series.name}: <b>{point.y}</b><br/>',shadow:!0,snap:kb?25:10,style:{color:"#333333",cursor:"default",fontSize:"12px",padding:"8px",pointerEvents:"none",whiteSpace:"nowrap"}},credits:{enabled:!0,text:"Highcharts.com",
href:"http://www.highcharts.com",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#909090",fontSize:"9px"}}};var W=N.plotOptions,ca=W.line;Ob();wa.prototype={parsers:[{regex:/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]?(?:\.[0-9]+)?)\s*\)/,parse:function(a){return[G(a[1]),G(a[2]),G(a[3]),parseFloat(a[4],10)]}},{regex:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,parse:function(a){return[G(a[1],16),G(a[2],16),G(a[3],16),1]}},
{regex:/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/,parse:function(a){return[G(a[1]),G(a[2]),G(a[3]),1]}}],init:function(a){var b,c,d,e;if((this.input=a)&&a.stops)this.stops=ta(a.stops,function(a){return new wa(a[1])});else for(d=this.parsers.length;d--&&!c;)e=this.parsers[d],(b=e.regex.exec(a))&&(c=e.parse(b));this.rgba=c||[]},get:function(a){var b=this.input,c=this.rgba,d;this.stops?(d=C(b),d.stops=[].concat(d.stops),n(this.stops,function(b,c){d.stops[c]=[d.stops[c][0],b.get(a)]})):
d=c&&!isNaN(c[0])?a==="rgb"||!a&&c[3]===1?"rgb("+c[0]+","+c[1]+","+c[2]+")":a==="a"?c[3]:"rgba("+c.join(",")+")":b;return d},brighten:function(a){var b,c=this.rgba;if(this.stops)n(this.stops,function(b){b.brighten(a)});else if(ua(a)&&a!==0)for(b=0;b<3;b++)c[b]+=G(a*255),c[b]<0&&(c[b]=0),c[b]>255&&(c[b]=255);return this},setOpacity:function(a){this.rgba[3]=a;return this}};Z.prototype={opacity:1,textProps:"direction,fontSize,fontWeight,fontFamily,fontStyle,color,lineHeight,width,textDecoration,textOverflow,textShadow".split(","),
init:function(a,b){this.element=b==="span"?ea(b):B.createElementNS(Qa,b);this.renderer=a},animate:function(a,b,c){b=q(b,this.renderer.globalAnimation,!0);Ta(this);if(b){if(c)b.complete=c;eb(this,a,b)}else this.attr(a,null,c);return this},colorGradient:function(a,b,c){var d=this.renderer,e,f,g,h,i,j,k,l,m,o,p,r=[],A;a.linearGradient?f="linearGradient":a.radialGradient&&(f="radialGradient");if(f){g=a[f];i=d.gradients;k=a.stops;o=c.radialReference;Ja(g)&&(a[f]=g={x1:g[0],y1:g[1],x2:g[2],y2:g[3],gradientUnits:"userSpaceOnUse"});
f==="radialGradient"&&o&&!s(g.gradientUnits)&&(h=g,g=C(g,d.getRadialAttr(o,h),{gradientUnits:"userSpaceOnUse"}));for(p in g)p!=="id"&&r.push(p,g[p]);for(p in k)r.push(k[p]);r=r.join(",");i[r]?o=i[r].attr("id"):(g.id=o="highcharts-"+Jb++,i[r]=j=d.createElement(f).attr(g).add(d.defs),j.radAttr=h,j.stops=[],n(k,function(a){a[1].indexOf("rgba")===0?(e=wa(a[1]),l=e.get("rgb"),m=e.get("a")):(l=a[1],m=1);a=d.createElement("stop").attr({offset:a[0],"stop-color":l,"stop-opacity":m}).add(j);j.stops.push(a)}));
A="url("+d.url+"#"+o+")";c.setAttribute(b,A);c.gradient=r;a.toString=function(){return A}}},applyTextShadow:function(a){var b=this.element,c,d=a.indexOf("contrast")!==-1,e={},f=this.renderer.forExport,g=f||b.style.textShadow!==t&&!Ka;if(d)e.textShadow=a=a.replace(/contrast/g,this.renderer.getContrast(b.style.fill));if(tb||f)e.textRendering="geometricPrecision";g?this.css(e):(this.fakeTS=!0,this.ySetter=this.xSetter,c=[].slice.call(b.getElementsByTagName("tspan")),n(a.split(/\s?,\s?/g),function(a){var d=
b.firstChild,e,f,a=a.split(" ");e=a[a.length-1];(f=a[a.length-2])&&n(c,function(a,c){var g;c===0&&(a.setAttribute("x",b.getAttribute("x")),c=b.getAttribute("y"),a.setAttribute("y",c||0),c===null&&b.setAttribute("y",0));g=a.cloneNode(1);X(g,{"class":"highcharts-text-shadow",fill:e,stroke:e,"stroke-opacity":1/v(G(f),3),"stroke-width":f,"stroke-linejoin":"round"});b.insertBefore(g,d)})}))},attr:function(a,b,c){var d,e=this.element,f,g=this,h;typeof a==="string"&&b!==t&&(d=a,a={},a[d]=b);if(typeof a===
"string")g=(this[a+"Getter"]||this._defaultGetter).call(this,a,e);else{for(d in a){b=a[d];h=!1;this.symbolName&&/^(x|y|width|height|r|start|end|innerR|anchorX|anchorY)/.test(d)&&(f||(this.symbolAttr(a),f=!0),h=!0);if(this.rotation&&(d==="x"||d==="y"))this.doTransform=!0;h||(h=this[d+"Setter"]||this._defaultSetter,h.call(this,b,d,e),this.shadows&&/^(width|height|visibility|x|y|d|transform|cx|cy|r)$/.test(d)&&this.updateShadows(d,b,h))}if(this.doTransform)this.updateTransform(),this.doTransform=!1}c&&
c();return g},updateShadows:function(a,b,c){for(var d=this.shadows,e=d.length;e--;)c.call(d[e],a==="height"?Math.max(b-(d[e].cutHeight||0),0):a==="d"?this.d:b,a,d[e])},addClass:function(a){var b=this.element,c=X(b,"class")||"";c.indexOf(a)===-1&&X(b,"class",c+" "+a);return this},symbolAttr:function(a){var b=this;n("x,y,r,start,end,width,height,innerR,anchorX,anchorY".split(","),function(c){b[c]=q(a[c],b[c])});b.attr({d:b.renderer.symbols[b.symbolName](b.x,b.y,b.width,b.height,b)})},clip:function(a){return this.attr("clip-path",
a?"url("+this.renderer.url+"#"+a.id+")":"none")},crisp:function(a){var b,c={},d,e=this.strokeWidth||0;d=y(e)%2/2;a.x=V(a.x||this.x||0)+d;a.y=V(a.y||this.y||0)+d;a.width=V((a.width||this.width||0)-2*d);a.height=V((a.height||this.height||0)-2*d);a.strokeWidth=e;for(b in a)this[b]!==a[b]&&(this[b]=c[b]=a[b]);return c},css:function(a){var b=this.styles,c={},d=this.element,e,f,g="";e=!b;if(a&&a.color)a.fill=a.color;if(b)for(f in a)a[f]!==b[f]&&(c[f]=a[f],e=!0);if(e){e=this.textWidth=a&&a.width&&d.nodeName.toLowerCase()===
"text"&&G(a.width)||this.textWidth;b&&(a=x(b,c));this.styles=a;e&&(qa||!ja&&this.renderer.forExport)&&delete a.width;if(Ka&&!ja)F(this.element,a);else{b=function(a,b){return"-"+b.toLowerCase()};for(f in a)g+=f.replace(/([A-Z])/g,b)+":"+a[f]+";";X(d,"style",g)}e&&this.added&&this.renderer.buildText(this)}return this},on:function(a,b){var c=this,d=c.element;db&&a==="click"?(d.ontouchstart=function(a){c.touchEventFired=fa.now();a.preventDefault();b.call(d,a)},d.onclick=function(a){(Ma.indexOf("Android")===
-1||fa.now()-(c.touchEventFired||0)>1100)&&b.call(d,a)}):d["on"+a]=b;return this},setRadialReference:function(a){var b=this.renderer.gradients[this.element.gradient];this.element.radialReference=a;b&&b.radAttr&&b.animate(this.renderer.getRadialAttr(a,b.radAttr));return this},translate:function(a,b){return this.attr({translateX:a,translateY:b})},invert:function(){this.inverted=!0;this.updateTransform();return this},updateTransform:function(){var a=this.translateX||0,b=this.translateY||0,c=this.scaleX,
d=this.scaleY,e=this.inverted,f=this.rotation,g=this.element;e&&(a+=this.attr("width"),b+=this.attr("height"));a=["translate("+a+","+b+")"];e?a.push("rotate(90) scale(-1,1)"):f&&a.push("rotate("+f+" "+(g.getAttribute("x")||0)+" "+(g.getAttribute("y")||0)+")");(s(c)||s(d))&&a.push("scale("+q(c,1)+" "+q(d,1)+")");a.length&&g.setAttribute("transform",a.join(" "))},toFront:function(){var a=this.element;a.parentNode.appendChild(a);return this},align:function(a,b,c){var d,e,f,g,h={};e=this.renderer;f=e.alignedObjects;
if(a){if(this.alignOptions=a,this.alignByTranslate=b,!c||Da(c))this.alignTo=d=c||"renderer",Aa(f,this),f.push(this),c=null}else a=this.alignOptions,b=this.alignByTranslate,d=this.alignTo;c=q(c,e[d],e);d=a.align;e=a.verticalAlign;f=(c.x||0)+(a.x||0);g=(c.y||0)+(a.y||0);if(d==="right"||d==="center")f+=(c.width-(a.width||0))/{right:1,center:2}[d];h[b?"translateX":"x"]=y(f);if(e==="bottom"||e==="middle")g+=(c.height-(a.height||0))/({bottom:1,middle:2}[e]||1);h[b?"translateY":"y"]=y(g);this[this.placed?
"animate":"attr"](h);this.placed=!0;this.alignAttr=h;return this},getBBox:function(a,b){var c,d=this.renderer,e,f,g,h=this.element,i=this.styles;e=this.textStr;var j,k=h.style,l,m=d.cache,o=d.cacheKeys,p;f=q(b,this.rotation);g=f*pa;e!==t&&(p=["",f||0,i&&i.fontSize,h.style.width].join(","),p=e===""||$b.test(e)?"num:"+e.toString().length+p:e+p);p&&!a&&(c=m[p]);if(!c){if(h.namespaceURI===Qa||d.forExport){try{l=this.fakeTS&&function(a){n(h.querySelectorAll(".highcharts-text-shadow"),function(b){b.style.display=
a})},Xa&&k.textShadow?(j=k.textShadow,k.textShadow=""):l&&l("none"),c=h.getBBox?x({},h.getBBox()):{width:h.offsetWidth,height:h.offsetHeight},j?k.textShadow=j:l&&l("")}catch(r){}if(!c||c.width<0)c={width:0,height:0}}else c=this.htmlGetBBox();if(d.isSVG){d=c.width;e=c.height;if(Ka&&i&&i.fontSize==="11px"&&e.toPrecision(3)==="16.9")c.height=e=14;if(f)c.width=S(e*ka(g))+S(d*ba(g)),c.height=S(e*ba(g))+S(d*ka(g))}if(p){for(;o.length>250;)delete m[o.shift()];m[p]||o.push(p);m[p]=c}}return c},show:function(a){return this.attr({visibility:a?
"inherit":"visible"})},hide:function(){return this.attr({visibility:"hidden"})},fadeOut:function(a){var b=this;b.animate({opacity:0},{duration:a||150,complete:function(){b.attr({y:-9999})}})},add:function(a){var b=this.renderer,c=this.element,d;if(a)this.parentGroup=a;this.parentInverted=a&&a.inverted;this.textStr!==void 0&&b.buildText(this);this.added=!0;if(!a||a.handleZ||this.zIndex)d=this.zIndexSetter();d||(a?a.element:b.box).appendChild(c);if(this.onAdd)this.onAdd();return this},safeRemoveChild:function(a){var b=
a.parentNode;b&&b.removeChild(a)},destroy:function(){var a=this,b=a.element||{},c=a.shadows,d=a.renderer.isSVG&&b.nodeName==="SPAN"&&a.parentGroup,e,f;b.onclick=b.onmouseout=b.onmouseover=b.onmousemove=b.point=null;Ta(a);if(a.clipPath)a.clipPath=a.clipPath.destroy();if(a.stops){for(f=0;f<a.stops.length;f++)a.stops[f]=a.stops[f].destroy();a.stops=null}a.safeRemoveChild(b);for(c&&n(c,function(b){a.safeRemoveChild(b)});d&&d.div&&d.div.childNodes.length===0;)b=d.parentGroup,a.safeRemoveChild(d.div),delete d.div,
d=b;a.alignTo&&Aa(a.renderer.alignedObjects,a);for(e in a)delete a[e];return null},shadow:function(a,b,c){var d=[],e,f,g=this.element,h,i,j,k;if(a){i=q(a.width,3);j=(a.opacity||0.15)/i;k=this.parentInverted?"(-1,-1)":"("+q(a.offsetX,1)+", "+q(a.offsetY,1)+")";for(e=1;e<=i;e++){f=g.cloneNode(0);h=i*2+1-2*e;X(f,{isShadow:"true",stroke:a.color||"black","stroke-opacity":j*e,"stroke-width":h,transform:"translate"+k,fill:"none"});if(c)X(f,"height",v(X(f,"height")-h,0)),f.cutHeight=h;b?b.element.appendChild(f):
g.parentNode.insertBefore(f,g);d.push(f)}this.shadows=d}return this},xGetter:function(a){this.element.nodeName==="circle"&&(a={x:"cx",y:"cy"}[a]||a);return this._defaultGetter(a)},_defaultGetter:function(a){a=q(this[a],this.element?this.element.getAttribute(a):null,0);/^[\-0-9\.]+$/.test(a)&&(a=parseFloat(a));return a},dSetter:function(a,b,c){a&&a.join&&(a=a.join(" "));/(NaN| {2}|^$)/.test(a)&&(a="M 0 0");c.setAttribute(b,a);this[b]=a},dashstyleSetter:function(a){var b,c=this["stroke-width"];c===
"inherit"&&(c=1);if(a=a&&a.toLowerCase()){a=a.replace("shortdashdotdot","3,1,1,1,1,1,").replace("shortdashdot","3,1,1,1").replace("shortdot","1,1,").replace("shortdash","3,1,").replace("longdash","8,3,").replace(/dot/g,"1,3,").replace("dash","4,3,").replace(/,$/,"").split(",");for(b=a.length;b--;)a[b]=G(a[b])*c;a=a.join(",").replace(/NaN/g,"none");this.element.setAttribute("stroke-dasharray",a)}},alignSetter:function(a){this.element.setAttribute("text-anchor",{left:"start",center:"middle",right:"end"}[a])},
opacitySetter:function(a,b,c){this[b]=a;c.setAttribute(b,a)},titleSetter:function(a){var b=this.element.getElementsByTagName("title")[0];b||(b=B.createElementNS(Qa,"title"),this.element.appendChild(b));b.appendChild(B.createTextNode(String(q(a),"").replace(/<[^>]*>/g,"")))},textSetter:function(a){if(a!==this.textStr)delete this.bBox,this.textStr=a,this.added&&this.renderer.buildText(this)},fillSetter:function(a,b,c){typeof a==="string"?c.setAttribute(b,a):a&&this.colorGradient(a,b,c)},visibilitySetter:function(a,
b,c){a==="inherit"?c.removeAttribute(b):c.setAttribute(b,a)},zIndexSetter:function(a,b){var c=this.renderer,d=this.parentGroup,c=(d||c).element||c.box,e,f,g=this.element,h;e=this.added;var i;if(s(a))g.zIndex=a,a=+a,this[b]===a&&(e=!1),this[b]=a;if(e){if((a=this.zIndex)&&d)d.handleZ=!0;d=c.childNodes;for(i=0;i<d.length&&!h;i++)if(e=d[i],f=e.zIndex,e!==g&&(G(f)>a||!s(a)&&s(f)))c.insertBefore(g,e),h=!0;h||c.appendChild(g)}return h},_defaultSetter:function(a,b,c){c.setAttribute(b,a)}};Z.prototype.yGetter=
Z.prototype.xGetter;Z.prototype.translateXSetter=Z.prototype.translateYSetter=Z.prototype.rotationSetter=Z.prototype.verticalAlignSetter=Z.prototype.scaleXSetter=Z.prototype.scaleYSetter=function(a,b){this[b]=a;this.doTransform=!0};Z.prototype["stroke-widthSetter"]=Z.prototype.strokeSetter=function(a,b,c){this[b]=a;if(this.stroke&&this["stroke-width"])this.strokeWidth=this["stroke-width"],Z.prototype.fillSetter.call(this,this.stroke,"stroke",c),c.setAttribute("stroke-width",this["stroke-width"]),
this.hasStroke=!0;else if(b==="stroke-width"&&a===0&&this.hasStroke)c.removeAttribute("stroke"),this.hasStroke=!1};var ya=function(){this.init.apply(this,arguments)};ya.prototype={Element:Z,init:function(a,b,c,d,e,f){var g,d=this.createElement("svg").attr({version:"1.1"}).css(this.getStyle(d));g=d.element;a.appendChild(g);a.innerHTML.indexOf("xmlns")===-1&&X(g,"xmlns",Qa);this.isSVG=!0;this.box=g;this.boxWrapper=d;this.alignedObjects=[];this.url=(Xa||tb)&&B.getElementsByTagName("base").length?J.location.href.replace(/#.*?$/,
"").replace(/([\('\)])/g,"\\$1").replace(/ /g,"%20"):"";this.createElement("desc").add().element.appendChild(B.createTextNode("Created with Highstock 4.2.4"));this.defs=this.createElement("defs").add();this.allowHTML=f;this.forExport=e;this.gradients={};this.cache={};this.cacheKeys=[];this.imgCount=0;this.setSize(b,c,!1);var h;if(Xa&&a.getBoundingClientRect)this.subPixelFix=b=function(){F(a,{left:0,top:0});h=a.getBoundingClientRect();F(a,{left:Fa(h.left)-h.left+"px",top:Fa(h.top)-h.top+"px"})},b(),
D(J,"resize",b)},getStyle:function(a){return this.style=x({fontFamily:'"Lucida Grande", "Lucida Sans Unicode", Arial, Helvetica, sans-serif',fontSize:"12px"},a)},isHidden:function(){return!this.boxWrapper.getBBox().width},destroy:function(){var a=this.defs;this.box=null;this.boxWrapper=this.boxWrapper.destroy();Pa(this.gradients||{});this.gradients=null;if(a)this.defs=a.destroy();this.subPixelFix&&T(J,"resize",this.subPixelFix);return this.alignedObjects=null},createElement:function(a){var b=new this.Element;
b.init(this,a);return b},draw:function(){},getRadialAttr:function(a,b){return{cx:a[0]-a[2]/2+b.cx*a[2],cy:a[1]-a[2]/2+b.cy*a[2],r:b.r*a[2]}},buildText:function(a){for(var b=a.element,c=this,d=c.forExport,e=q(a.textStr,"").toString(),f=e.indexOf("<")!==-1,g=b.childNodes,h,i,j=X(b,"x"),k=a.styles,l=a.textWidth,m=k&&k.lineHeight,o=k&&k.textShadow,p=k&&k.textOverflow==="ellipsis",r=g.length,A=l&&!a.added&&this.box,P=function(a){return m?G(m):c.fontMetrics(/(px|em)$/.test(a&&a.style.fontSize)?a.style.fontSize:
k&&k.fontSize||c.style.fontSize||12,a).h},u=function(a){return a.replace(/&lt;/g,"<").replace(/&gt;/g,">")};r--;)b.removeChild(g[r]);!f&&!o&&!p&&e.indexOf(" ")===-1?b.appendChild(B.createTextNode(u(e))):(h=/<.*style="([^"]+)".*>/,i=/<.*href="(http[^"]+)".*>/,A&&A.appendChild(b),e=f?e.replace(/<(b|strong)>/g,'<span style="font-weight:bold">').replace(/<(i|em)>/g,'<span style="font-style:italic">').replace(/<a/g,"<span").replace(/<\/(b|strong|i|em|a)>/g,"</span>").split(/<br.*?>/g):[e],e[e.length-1]===
""&&e.pop(),n(e,function(e,f){var g,m=0,e=e.replace(/<span/g,"|||<span").replace(/<\/span>/g,"</span>|||");g=e.split("|||");n(g,function(e){if(e!==""||g.length===1){var o={},r=B.createElementNS(Qa,"tspan"),A;h.test(e)&&(A=e.match(h)[1].replace(/(;| |^)color([ :])/,"$1fill$2"),X(r,"style",A));i.test(e)&&!d&&(X(r,"onclick",'location.href="'+e.match(i)[1]+'"'),F(r,{cursor:"pointer"}));e=u(e.replace(/<(.|\n)*?>/g,"")||" ");if(e!==" "){r.appendChild(B.createTextNode(e));if(m)o.dx=0;else if(f&&j!==null)o.x=
j;X(r,o);b.appendChild(r);!m&&f&&(!ja&&d&&F(r,{display:"block"}),X(r,"dy",P(r)));if(l){for(var o=e.replace(/([^\^])-/g,"$1- ").split(" "),q=g.length>1||f||o.length>1&&k.whiteSpace!=="nowrap",w,n,s,t=[],v=P(r),y=1,x=a.rotation,C=e,z=C.length;(q||p)&&(o.length||t.length);)a.rotation=0,w=a.getBBox(!0),s=w.width,!ja&&c.forExport&&(s=c.measureSpanWidth(r.firstChild.data,a.styles)),w=s>l,n===void 0&&(n=w),p&&n?(z/=2,C===""||!w&&z<0.5?o=[]:(w&&(n=!0),C=e.substring(0,C.length+(w?-1:1)*Fa(z)),o=[C+(l>3?"\u2026":
"")],r.removeChild(r.firstChild))):!w||o.length===1?(o=t,t=[],o.length&&(y++,r=B.createElementNS(Qa,"tspan"),X(r,{dy:v,x:j}),A&&X(r,"style",A),b.appendChild(r)),s>l&&(l=s)):(r.removeChild(r.firstChild),t.unshift(o.pop())),o.length&&r.appendChild(B.createTextNode(o.join(" ").replace(/- /g,"-")));n&&a.attr("title",a.textStr);a.rotation=x}m++}}})}),A&&A.removeChild(b),o&&a.applyTextShadow&&a.applyTextShadow(o))},getContrast:function(a){a=wa(a).rgba;return a[0]+a[1]+a[2]>384?"#000000":"#FFFFFF"},button:function(a,
b,c,d,e,f,g,h,i){var j=this.label(a,b,c,i,null,null,null,null,"button"),k=0,l,m,o,p,r,A,a={x1:0,y1:0,x2:0,y2:1},e=C({"stroke-width":1,stroke:"#CCCCCC",fill:{linearGradient:a,stops:[[0,"#FEFEFE"],[1,"#F6F6F6"]]},r:2,padding:5,style:{color:"black"}},e);o=e.style;delete e.style;f=C(e,{stroke:"#68A",fill:{linearGradient:a,stops:[[0,"#FFF"],[1,"#ACF"]]}},f);p=f.style;delete f.style;g=C(e,{stroke:"#68A",fill:{linearGradient:a,stops:[[0,"#9BD"],[1,"#CDF"]]}},g);r=g.style;delete g.style;h=C(e,{style:{color:"#CCC"}},
h);A=h.style;delete h.style;D(j.element,Ka?"mouseover":"mouseenter",function(){k!==3&&j.attr(f).css(p)});D(j.element,Ka?"mouseout":"mouseleave",function(){k!==3&&(l=[e,f,g][k],m=[o,p,r][k],j.attr(l).css(m))});j.setState=function(a){(j.state=k=a)?a===2?j.attr(g).css(r):a===3&&j.attr(h).css(A):j.attr(e).css(o)};return j.on("click",function(a){k!==3&&d.call(j,a)}).attr(e).css(x({cursor:"default"},o))},crispLine:function(a,b){a[1]===a[4]&&(a[1]=a[4]=y(a[1])-b%2/2);a[2]===a[5]&&(a[2]=a[5]=y(a[2])+b%2/
2);return a},path:function(a){var b={fill:"none"};Ja(a)?b.d=a:da(a)&&x(b,a);return this.createElement("path").attr(b)},circle:function(a,b,c){a=da(a)?a:{x:a,y:b,r:c};b=this.createElement("circle");b.xSetter=b.ySetter=function(a,b,c){c.setAttribute("c"+b,a)};return b.attr(a)},arc:function(a,b,c,d,e,f){if(da(a))b=a.y,c=a.r,d=a.innerR,e=a.start,f=a.end,a=a.x;a=this.symbol("arc",a||0,b||0,c||0,c||0,{innerR:d||0,start:e||0,end:f||0});a.r=c;return a},rect:function(a,b,c,d,e,f){var e=da(a)?a.r:e,g=this.createElement("rect"),
a=da(a)?a:a===t?{}:{x:a,y:b,width:v(c,0),height:v(d,0)};if(f!==t)g.strokeWidth=f,a=g.crisp(a);if(e)a.r=e;g.rSetter=function(a,b,c){X(c,{rx:a,ry:a})};return g.attr(a)},setSize:function(a,b,c){var d=this.alignedObjects,e=d.length;this.width=a;this.height=b;for(this.boxWrapper[q(c,!0)?"animate":"attr"]({width:a,height:b});e--;)d[e].align()},g:function(a){var b=this.createElement("g");return s(a)?b.attr({"class":"highcharts-"+a}):b},image:function(a,b,c,d,e){var f={preserveAspectRatio:"none"};arguments.length>
1&&x(f,{x:b,y:c,width:d,height:e});f=this.createElement("image").attr(f);f.element.setAttributeNS?f.element.setAttributeNS("http://www.w3.org/1999/xlink","href",a):f.element.setAttribute("hc-svg-href",a);return f},symbol:function(a,b,c,d,e,f){var g=this,h,i=this.symbols[a],i=i&&i(y(b),y(c),d,e,f),j=/^url\((.*?)\)$/,k,l;if(i)h=this.path(i),x(h,{symbolName:a,x:b,y:c,width:d,height:e}),f&&x(h,f);else if(j.test(a))l=function(a,b){a.element&&(a.attr({width:b[0],height:b[1]}),a.alignByTranslate||a.translate(y((d-
b[0])/2),y((e-b[1])/2)))},k=a.match(j)[1],a=Vb[k]||f&&f.width&&f.height&&[f.width,f.height],h=this.image(k).attr({x:b,y:c}),h.isImg=!0,a?l(h,a):(h.attr({width:0,height:0}),ea("img",{onload:function(){this.width===0&&(F(this,{position:"absolute",top:"-999em"}),B.body.appendChild(this));l(h,Vb[k]=[this.width,this.height]);this.parentNode&&this.parentNode.removeChild(this);g.imgCount--;if(!g.imgCount&&$[g.chartIndex].onload)$[g.chartIndex].onload()},src:k}),this.imgCount++);return h},symbols:{circle:function(a,
b,c,d){var e=0.166*c;return["M",a+c/2,b,"C",a+c+e,b,a+c+e,b+d,a+c/2,b+d,"C",a-e,b+d,a-e,b,a+c/2,b,"Z"]},square:function(a,b,c,d){return["M",a,b,"L",a+c,b,a+c,b+d,a,b+d,"Z"]},triangle:function(a,b,c,d){return["M",a+c/2,b,"L",a+c,b+d,a,b+d,"Z"]},"triangle-down":function(a,b,c,d){return["M",a,b,"L",a+c,b,a+c/2,b+d,"Z"]},diamond:function(a,b,c,d){return["M",a+c/2,b,"L",a+c,b+d/2,a+c/2,b+d,a,b+d/2,"Z"]},arc:function(a,b,c,d,e){var f=e.start,c=e.r||c||d,g=e.end-0.001,d=e.innerR,h=e.open,i=ba(f),j=ka(f),
k=ba(g),g=ka(g),e=e.end-f<Ba?0:1;return["M",a+c*i,b+c*j,"A",c,c,0,e,1,a+c*k,b+c*g,h?"M":"L",a+d*k,b+d*g,"A",d,d,0,e,0,a+d*i,b+d*j,h?"":"Z"]},callout:function(a,b,c,d,e){var f=E(e&&e.r||0,c,d),g=f+6,h=e&&e.anchorX,e=e&&e.anchorY,i;i=["M",a+f,b,"L",a+c-f,b,"C",a+c,b,a+c,b,a+c,b+f,"L",a+c,b+d-f,"C",a+c,b+d,a+c,b+d,a+c-f,b+d,"L",a+f,b+d,"C",a,b+d,a,b+d,a,b+d-f,"L",a,b+f,"C",a,b,a,b,a+f,b];h&&h>c&&e>b+g&&e<b+d-g?i.splice(13,3,"L",a+c,e-6,a+c+6,e,a+c,e+6,a+c,b+d-f):h&&h<0&&e>b+g&&e<b+d-g?i.splice(33,3,
"L",a,e+6,a-6,e,a,e-6,a,b+f):e&&e>d&&h>a+g&&h<a+c-g?i.splice(23,3,"L",h+6,b+d,h,b+d+6,h-6,b+d,a+f,b+d):e&&e<0&&h>a+g&&h<a+c-g&&i.splice(3,3,"L",h-6,b,h,b-6,h+6,b,c-f,b);return i}},clipRect:function(a,b,c,d){var e="highcharts-"+Jb++,f=this.createElement("clipPath").attr({id:e}).add(this.defs),a=this.rect(a,b,c,d,0).add(f);a.id=e;a.clipPath=f;a.count=0;return a},text:function(a,b,c,d){var e=qa||!ja&&this.forExport,f={};if(d&&(this.allowHTML||!this.forExport))return this.html(a,b,c);f.x=Math.round(b||
0);if(c)f.y=Math.round(c);if(a||a===0)f.text=a;a=this.createElement("text").attr(f);e&&a.css({position:"absolute"});if(!d)a.xSetter=function(a,b,c){var d=c.getElementsByTagName("tspan"),e,f=c.getAttribute(b),m;for(m=0;m<d.length;m++)e=d[m],e.getAttribute(b)===f&&e.setAttribute(b,a);c.setAttribute(b,a)};return a},fontMetrics:function(a,b){var c,d,a=a||this.style.fontSize;!a&&b&&J.getComputedStyle&&(b=b.element||b,a=(c=J.getComputedStyle(b,""))&&c.fontSize);a=/px/.test(a)?G(a):/em/.test(a)?parseFloat(a)*
12:12;c=a<24?a+3:y(a*1.2);d=y(c*0.8);return{h:c,b:d,f:a}},rotCorr:function(a,b,c){var d=a;b&&c&&(d=v(d*ba(b*pa),4));return{x:-a/3*ka(b*pa),y:d}},label:function(a,b,c,d,e,f,g,h,i){var j=this,k=j.g(i),l=j.text("",0,0,g).attr({zIndex:1}),m,o,p=0,r=3,A=0,q,u,w,O,R=0,ha={},v,z,L,E,B;L=function(){var a,b;a=l.element.style;o=(q===void 0||u===void 0||k.styles.textAlign)&&s(l.textStr)&&l.getBBox();k.width=(q||o.width||0)+2*r+A;k.height=(u||o.height||0)+2*r;v=r+j.fontMetrics(a&&a.fontSize,l).b;if(z){if(!m)a=
R,b=(h?-v:0)+R,k.box=m=d?j.symbol(d,a,b,k.width,k.height,ha):j.rect(a,b,k.width,k.height,0,ha["stroke-width"]),m.isImg||m.attr("fill","none"),m.add(k);m.isImg||m.attr(x({width:y(k.width),height:y(k.height)},ha));ha=null}};E=function(){var a=k.styles,a=a&&a.textAlign,b=A+r,c;c=h?0:v;if(s(q)&&o&&(a==="center"||a==="right"))b+={center:0.5,right:1}[a]*(q-o.width);if(b!==l.x||c!==l.y)l.attr("x",b),c!==t&&l.attr("y",c);l.x=b;l.y=c};B=function(a,b){m?m.attr(a,b):ha[a]=b};k.onAdd=function(){l.add(k);k.attr({text:a||
a===0?a:"",x:b,y:c});m&&s(e)&&k.attr({anchorX:e,anchorY:f})};k.widthSetter=function(a){q=a};k.heightSetter=function(a){u=a};k.paddingSetter=function(a){if(s(a)&&a!==r)r=k.padding=a,E()};k.paddingLeftSetter=function(a){s(a)&&a!==A&&(A=a,E())};k.alignSetter=function(a){a={left:0,center:0.5,right:1}[a];a!==p&&(p=a,o&&k.attr({x:w}))};k.textSetter=function(a){a!==t&&l.textSetter(a);L();E()};k["stroke-widthSetter"]=function(a,b){a&&(z=!0);R=a%2/2;B(b,a)};k.strokeSetter=k.fillSetter=k.rSetter=function(a,
b){b==="fill"&&a&&(z=!0);B(b,a)};k.anchorXSetter=function(a,b){e=a;B(b,y(a)-R-w)};k.anchorYSetter=function(a,b){f=a;B(b,a-O)};k.xSetter=function(a){k.x=a;p&&(a-=p*((q||o.width)+2*r));w=y(a);k.attr("translateX",w)};k.ySetter=function(a){O=k.y=y(a);k.attr("translateY",O)};var D=k.css;return x(k,{css:function(a){if(a){var b={},a=C(a);n(k.textProps,function(c){a[c]!==t&&(b[c]=a[c],delete a[c])});l.css(b)}return D.call(k,a)},getBBox:function(){return{width:o.width+2*r,height:o.height+2*r,x:o.x-r,y:o.y-
r}},shadow:function(a){m&&m.shadow(a);return k},destroy:function(){T(k.element,"mouseenter");T(k.element,"mouseleave");l&&(l=l.destroy());m&&(m=m.destroy());Z.prototype.destroy.call(k);k=j=L=E=B=null}})}};Ya=ya;x(Z.prototype,{htmlCss:function(a){var b=this.element;if(b=a&&b.tagName==="SPAN"&&a.width)delete a.width,this.textWidth=b,this.updateTransform();if(a&&a.textOverflow==="ellipsis")a.whiteSpace="nowrap",a.overflow="hidden";this.styles=x(this.styles,a);F(this.element,a);return this},htmlGetBBox:function(){var a=
this.element;if(a.nodeName==="text")a.style.position="absolute";return{x:a.offsetLeft,y:a.offsetTop,width:a.offsetWidth,height:a.offsetHeight}},htmlUpdateTransform:function(){if(this.added){var a=this.renderer,b=this.element,c=this.translateX||0,d=this.translateY||0,e=this.x||0,f=this.y||0,g=this.textAlign||"left",h={left:0,center:0.5,right:1}[g],i=this.shadows,j=this.styles;F(b,{marginLeft:c,marginTop:d});i&&n(i,function(a){F(a,{marginLeft:c+1,marginTop:d+1})});this.inverted&&n(b.childNodes,function(c){a.invertChild(c,
b)});if(b.tagName==="SPAN"){var i=this.rotation,k=G(this.textWidth),l=j&&j.whiteSpace,m=[i,g,b.innerHTML,this.textWidth,this.textAlign].join(",");if(m!==this.cTT){j=a.fontMetrics(b.style.fontSize).b;s(i)&&this.setSpanRotation(i,h,j);if(b.offsetWidth>k&&/[ \-]/.test(b.textContent||b.innerText))F(b,{width:k+"px",display:"block",whiteSpace:l||"normal"}),this.hasTextWidth=!0;else if(this.hasTextWidth)F(b,{width:"",display:"",whiteSpace:l||"nowrap"}),this.hasTextWidth=!1;this.getSpanCorrection(this.hasTextWidth?
k:b.offsetWidth,j,h,i,g)}F(b,{left:e+(this.xCorr||0)+"px",top:f+(this.yCorr||0)+"px"});if(tb)j=b.offsetHeight;this.cTT=m}}else this.alignOnAdd=!0},setSpanRotation:function(a,b,c){var d={},e=Ka?"-ms-transform":tb?"-webkit-transform":Xa?"MozTransform":Ub?"-o-transform":"";d[e]=d.transform="rotate("+a+"deg)";d[e+(Xa?"Origin":"-origin")]=d.transformOrigin=b*100+"% "+c+"px";F(this.element,d)},getSpanCorrection:function(a,b,c){this.xCorr=-a*c;this.yCorr=-b}});x(ya.prototype,{html:function(a,b,c){var d=
this.createElement("span"),e=d.element,f=d.renderer,g=f.isSVG,h=function(a,b){n(["opacity","visibility"],function(c){U(a,c+"Setter",function(a,c,d,e){a.call(this,c,d,e);b[d]=c})})};d.textSetter=function(a){a!==e.innerHTML&&delete this.bBox;e.innerHTML=this.textStr=a;d.htmlUpdateTransform()};g&&h(d,d.element.style);d.xSetter=d.ySetter=d.alignSetter=d.rotationSetter=function(a,b){b==="align"&&(b="textAlign");d[b]=a;d.htmlUpdateTransform()};d.attr({text:a,x:y(b),y:y(c)}).css({position:"absolute",fontFamily:this.style.fontFamily,
fontSize:this.style.fontSize});e.style.whiteSpace="nowrap";d.css=d.htmlCss;if(g)d.add=function(a){var b,c=f.box.parentNode,g=[];if(this.parentGroup=a){if(b=a.div,!b){for(;a;)g.push(a),a=a.parentGroup;n(g.reverse(),function(a){var d,e=X(a.element,"class");e&&(e={className:e});b=a.div=a.div||ea(Wa,e,{position:"absolute",left:(a.translateX||0)+"px",top:(a.translateY||0)+"px",opacity:a.opacity},b||c);d=b.style;x(a,{translateXSetter:function(b,c){d.left=b+"px";a[c]=b;a.doTransform=!0},translateYSetter:function(b,
c){d.top=b+"px";a[c]=b;a.doTransform=!0}});h(a,d)})}}else b=c;b.appendChild(e);d.added=!0;d.alignOnAdd&&d.htmlUpdateTransform();return d};return d}});var mb,aa;if(!ja&&!qa)aa={init:function(a,b){var c=["<",b,' filled="f" stroked="f"'],d=["position: ","absolute",";"],e=b===Wa;(b==="shape"||e)&&d.push("left:0;top:0;width:1px;height:1px;");d.push("visibility: ",e?"hidden":"visible");c.push(' style="',d.join(""),'"/>');if(b)c=e||b==="span"||b==="img"?c.join(""):a.prepVML(c),this.element=ea(c);this.renderer=
a},add:function(a){var b=this.renderer,c=this.element,d=b.box,e=a&&a.inverted,d=a?a.element||a:d;if(a)this.parentGroup=a;e&&b.invertChild(c,d);d.appendChild(c);this.added=!0;this.alignOnAdd&&!this.deferUpdateTransform&&this.updateTransform();if(this.onAdd)this.onAdd();return this},updateTransform:Z.prototype.htmlUpdateTransform,setSpanRotation:function(){var a=this.rotation,b=ba(a*pa),c=ka(a*pa);F(this.element,{filter:a?["progid:DXImageTransform.Microsoft.Matrix(M11=",b,", M12=",-c,", M21=",c,", M22=",
b,", sizingMethod='auto expand')"].join(""):"none"})},getSpanCorrection:function(a,b,c,d,e){var f=d?ba(d*pa):1,g=d?ka(d*pa):0,h=q(this.elemHeight,this.element.offsetHeight),i;this.xCorr=f<0&&-a;this.yCorr=g<0&&-h;i=f*g<0;this.xCorr+=g*b*(i?1-c:c);this.yCorr-=f*b*(d?i?c:1-c:1);e&&e!=="left"&&(this.xCorr-=a*c*(f<0?-1:1),d&&(this.yCorr-=h*c*(g<0?-1:1)),F(this.element,{textAlign:e}))},pathToVML:function(a){for(var b=a.length,c=[];b--;)if(ua(a[b]))c[b]=y(a[b]*10)-5;else if(a[b]==="Z")c[b]="x";else if(c[b]=
a[b],a.isArc&&(a[b]==="wa"||a[b]==="at"))c[b+5]===c[b+7]&&(c[b+7]+=a[b+7]>a[b+5]?1:-1),c[b+6]===c[b+8]&&(c[b+8]+=a[b+8]>a[b+6]?1:-1);return c.join(" ")||"x"},clip:function(a){var b=this,c;a?(c=a.members,Aa(c,b),c.push(b),b.destroyClip=function(){Aa(c,b)},a=a.getCSS(b)):(b.destroyClip&&b.destroyClip(),a={clip:sb?"inherit":"rect(auto)"});return b.css(a)},css:Z.prototype.htmlCss,safeRemoveChild:function(a){a.parentNode&&Va(a)},destroy:function(){this.destroyClip&&this.destroyClip();return Z.prototype.destroy.apply(this)},
on:function(a,b){this.element["on"+a]=function(){var a=J.event;a.target=a.srcElement;b(a)};return this},cutOffPath:function(a,b){var c,a=a.split(/[ ,]/);c=a.length;if(c===9||c===11)a[c-4]=a[c-2]=G(a[c-2])-10*b;return a.join(" ")},shadow:function(a,b,c){var d=[],e,f=this.element,g=this.renderer,h,i=f.style,j,k=f.path,l,m,o,p;k&&typeof k.value!=="string"&&(k="x");m=k;if(a){o=q(a.width,3);p=(a.opacity||0.15)/o;for(e=1;e<=3;e++){l=o*2+1-2*e;c&&(m=this.cutOffPath(k.value,l+0.5));j=['<shape isShadow="true" strokeweight="',
l,'" filled="false" path="',m,'" coordsize="10 10" style="',f.style.cssText,'" />'];h=ea(g.prepVML(j),null,{left:G(i.left)+q(a.offsetX,1),top:G(i.top)+q(a.offsetY,1)});if(c)h.cutOff=l+1;j=['<stroke color="',a.color||"black",'" opacity="',p*e,'"/>'];ea(g.prepVML(j),null,null,h);b?b.element.appendChild(h):f.parentNode.insertBefore(h,f);d.push(h)}this.shadows=d}return this},updateShadows:ra,setAttr:function(a,b){sb?this.element[a]=b:this.element.setAttribute(a,b)},classSetter:function(a){this.element.className=
a},dashstyleSetter:function(a,b,c){(c.getElementsByTagName("stroke")[0]||ea(this.renderer.prepVML(["<stroke/>"]),null,null,c))[b]=a||"solid";this[b]=a},dSetter:function(a,b,c){var d=this.shadows,a=a||[];this.d=a.join&&a.join(" ");c.path=a=this.pathToVML(a);if(d)for(c=d.length;c--;)d[c].path=d[c].cutOff?this.cutOffPath(a,d[c].cutOff):a;this.setAttr(b,a)},fillSetter:function(a,b,c){var d=c.nodeName;if(d==="SPAN")c.style.color=a;else if(d!=="IMG")c.filled=a!=="none",this.setAttr("fillcolor",this.renderer.color(a,
c,b,this))},"fill-opacitySetter":function(a,b,c){ea(this.renderer.prepVML(["<",b.split("-")[0],' opacity="',a,'"/>']),null,null,c)},opacitySetter:ra,rotationSetter:function(a,b,c){c=c.style;this[b]=c[b]=a;c.left=-y(ka(a*pa)+1)+"px";c.top=y(ba(a*pa))+"px"},strokeSetter:function(a,b,c){this.setAttr("strokecolor",this.renderer.color(a,c,b,this))},"stroke-widthSetter":function(a,b,c){c.stroked=!!a;this[b]=a;ua(a)&&(a+="px");this.setAttr("strokeweight",a)},titleSetter:function(a,b){this.setAttr(b,a)},
visibilitySetter:function(a,b,c){a==="inherit"&&(a="visible");this.shadows&&n(this.shadows,function(c){c.style[b]=a});c.nodeName==="DIV"&&(a=a==="hidden"?"-999em":0,sb||(c.style[b]=a?"visible":"hidden"),b="top");c.style[b]=a},xSetter:function(a,b,c){this[b]=a;b==="x"?b="left":b==="y"&&(b="top");this.updateClipping?(this[b]=a,this.updateClipping()):c.style[b]=a},zIndexSetter:function(a,b,c){c.style[b]=a}},aa["stroke-opacitySetter"]=aa["fill-opacitySetter"],z.VMLElement=aa=la(Z,aa),aa.prototype.ySetter=
aa.prototype.widthSetter=aa.prototype.heightSetter=aa.prototype.xSetter,aa={Element:aa,isIE8:Ma.indexOf("MSIE 8.0")>-1,init:function(a,b,c,d){var e;this.alignedObjects=[];d=this.createElement(Wa).css(x(this.getStyle(d),{position:"relative"}));e=d.element;a.appendChild(d.element);this.isVML=!0;this.box=e;this.boxWrapper=d;this.gradients={};this.cache={};this.cacheKeys=[];this.imgCount=0;this.setSize(b,c,!1);if(!B.namespaces.hcv){B.namespaces.add("hcv","urn:schemas-microsoft-com:vml");try{B.createStyleSheet().cssText=
"hcv\\:fill, hcv\\:path, hcv\\:shape, hcv\\:stroke{ behavior:url(#default#VML); display: inline-block; } "}catch(f){B.styleSheets[0].cssText+="hcv\\:fill, hcv\\:path, hcv\\:shape, hcv\\:stroke{ behavior:url(#default#VML); display: inline-block; } "}}},isHidden:function(){return!this.box.offsetWidth},clipRect:function(a,b,c,d){var e=this.createElement(),f=da(a);return x(e,{members:[],count:0,left:(f?a.x:a)+1,top:(f?a.y:b)+1,width:(f?a.width:c)-1,height:(f?a.height:d)-1,getCSS:function(a){var b=a.element,
c=b.nodeName,a=a.inverted,d=this.top-(c==="shape"?b.offsetTop:0),e=this.left,b=e+this.width,f=d+this.height,d={clip:"rect("+y(a?e:d)+"px,"+y(a?f:b)+"px,"+y(a?b:f)+"px,"+y(a?d:e)+"px)"};!a&&sb&&c==="DIV"&&x(d,{width:b+"px",height:f+"px"});return d},updateClipping:function(){n(e.members,function(a){a.element&&a.css(e.getCSS(a))})}})},color:function(a,b,c,d){var e=this,f,g=/^rgba/,h,i,j="none";a&&a.linearGradient?i="gradient":a&&a.radialGradient&&(i="pattern");if(i){var k,l,m=a.linearGradient||a.radialGradient,
o,p,r,A,q,u="",a=a.stops,w,O=[],R=function(){h=['<fill colors="'+O.join(",")+'" opacity="',r,'" o:opacity2="',p,'" type="',i,'" ',u,'focus="100%" method="any" />'];ea(e.prepVML(h),null,null,b)};o=a[0];w=a[a.length-1];o[0]>0&&a.unshift([0,o[1]]);w[0]<1&&a.push([1,w[1]]);n(a,function(a,b){g.test(a[1])?(f=wa(a[1]),k=f.get("rgb"),l=f.get("a")):(k=a[1],l=1);O.push(a[0]*100+"% "+k);b?(r=l,A=k):(p=l,q=k)});if(c==="fill")if(i==="gradient")c=m.x1||m[0]||0,a=m.y1||m[1]||0,o=m.x2||m[2]||0,m=m.y2||m[3]||0,u=
'angle="'+(90-Y.atan((m-a)/(o-c))*180/Ba)+'"',R();else{var j=m.r,ha=j*2,s=j*2,v=m.cx,t=m.cy,y=b.radialReference,x,j=function(){y&&(x=d.getBBox(),v+=(y[0]-x.x)/x.width-0.5,t+=(y[1]-x.y)/x.height-0.5,ha*=y[2]/x.width,s*=y[2]/x.height);u='src="'+N.global.VMLRadialGradientURL+'" size="'+ha+","+s+'" origin="0.5,0.5" position="'+v+","+t+'" color2="'+q+'" ';R()};d.added?j():d.onAdd=j;j=A}else j=k}else if(g.test(a)&&b.tagName!=="IMG")f=wa(a),d[c+"-opacitySetter"](f.get("a"),c,b),j=f.get("rgb");else{j=b.getElementsByTagName(c);
if(j.length)j[0].opacity=1,j[0].type="solid";j=a}return j},prepVML:function(a){var b=this.isIE8,a=a.join("");b?(a=a.replace("/>",' xmlns="urn:schemas-microsoft-com:vml" />'),a=a.indexOf('style="')===-1?a.replace("/>",' style="display:inline-block;behavior:url(#default#VML);" />'):a.replace('style="','style="display:inline-block;behavior:url(#default#VML);')):a=a.replace("<","<hcv:");return a},text:ya.prototype.html,path:function(a){var b={coordsize:"10 10"};Ja(a)?b.d=a:da(a)&&x(b,a);return this.createElement("shape").attr(b)},
circle:function(a,b,c){var d=this.symbol("circle");if(da(a))c=a.r,b=a.y,a=a.x;d.isCircle=!0;d.r=c;return d.attr({x:a,y:b})},g:function(a){var b;a&&(b={className:"highcharts-"+a,"class":"highcharts-"+a});return this.createElement(Wa).attr(b)},image:function(a,b,c,d,e){var f=this.createElement("img").attr({src:a});arguments.length>1&&f.attr({x:b,y:c,width:d,height:e});return f},createElement:function(a){return a==="rect"?this.symbol(a):ya.prototype.createElement.call(this,a)},invertChild:function(a,
b){var c=this,d=b.style,e=a.tagName==="IMG"&&a.style;F(a,{flip:"x",left:G(d.width)-(e?G(e.top):1),top:G(d.height)-(e?G(e.left):1),rotation:-90});n(a.childNodes,function(b){c.invertChild(b,a)})},symbols:{arc:function(a,b,c,d,e){var f=e.start,g=e.end,h=e.r||c||d,c=e.innerR,d=ba(f),i=ka(f),j=ba(g),k=ka(g);if(g-f===0)return["x"];f=["wa",a-h,b-h,a+h,b+h,a+h*d,b+h*i,a+h*j,b+h*k];e.open&&!c&&f.push("e","M",a,b);f.push("at",a-c,b-c,a+c,b+c,a+c*j,b+c*k,a+c*d,b+c*i,"x","e");f.isArc=!0;return f},circle:function(a,
b,c,d,e){e&&(c=d=2*e.r);e&&e.isCircle&&(a-=c/2,b-=d/2);return["wa",a,b,a+c,b+d,a+c,b+d/2,a+c,b+d/2,"e"]},rect:function(a,b,c,d,e){return ya.prototype.symbols[!s(e)||!e.r?"square":"callout"].call(0,a,b,c,d,e)}}},z.VMLRenderer=mb=function(){this.init.apply(this,arguments)},mb.prototype=C(ya.prototype,aa),Ya=mb;ya.prototype.measureSpanWidth=function(a,b){var c=B.createElement("span"),d;d=B.createTextNode(a);c.appendChild(d);F(c,b);this.box.appendChild(c);d=c.offsetWidth;Va(c);return d};var Wb;if(qa)z.CanVGRenderer=
aa=function(){Qa="http://www.w3.org/1999/xhtml"},aa.prototype.symbols={},Wb=function(){function a(){var a=b.length,d;for(d=0;d<a;d++)b[d]();b=[]}var b=[];return{push:function(c,d){if(b.length===0){var e=B.getElementsByTagName("head")[0],f=B.createElement("script");f.type="text/javascript";f.src=d;f.onload=a;e.appendChild(f)}b.push(c)}}}(),Ya=aa;cb.prototype={addLabel:function(){var a=this.axis,b=a.options,c=a.chart,d=a.categories,e=a.names,f=this.pos,g=b.labels,h=a.tickPositions,i=f===h[0],j=f===
h[h.length-1],e=d?q(d[f],e[f],f):f,d=this.label,h=h.info,k;a.isDatetimeAxis&&h&&(k=b.dateTimeLabelFormats[h.higherRanks[f]||h.unitName]);this.isFirst=i;this.isLast=j;b=a.labelFormatter.call({axis:a,chart:c,isFirst:i,isLast:j,dateTimeLabelFormat:k,value:a.isLog?na(a.lin2log(e)):e});s(d)?d&&d.attr({text:b}):(this.labelLength=(this.label=d=s(b)&&g.enabled?c.renderer.text(b,0,0,g.useHTML).css(C(g.style)).add(a.labelGroup):null)&&d.getBBox().width,this.rotation=0)},getLabelSize:function(){return this.label?
this.label.getBBox()[this.axis.horiz?"height":"width"]:0},handleOverflow:function(a){var b=this.axis,c=a.x,d=b.chart.chartWidth,e=b.chart.spacing,f=q(b.labelLeft,E(b.pos,e[3])),e=q(b.labelRight,v(b.pos+b.len,d-e[1])),g=this.label,h=this.rotation,i={left:0,center:0.5,right:1}[b.labelAlign],j=g.getBBox().width,k=b.getSlotWidth(),l=k,m=1,o,p={};if(h)h<0&&c-i*j<f?o=y(c/ba(h*pa)-f):h>0&&c+i*j>e&&(o=y((d-c)/ba(h*pa)));else if(d=c+(1-i)*j,c-i*j<f?l=a.x+l*(1-i)-f:d>e&&(l=e-a.x+l*i,m=-1),l=E(k,l),l<k&&b.labelAlign===
"center"&&(a.x+=m*(k-l-i*(k-E(j,l)))),j>l||b.autoRotation&&g.styles.width)o=l;if(o){p.width=o;if(!b.options.labels.style.textOverflow)p.textOverflow="ellipsis";g.css(p)}},getPosition:function(a,b,c,d){var e=this.axis,f=e.chart,g=d&&f.oldChartHeight||f.chartHeight;return{x:a?e.translate(b+c,null,null,d)+e.transB:e.left+e.offset+(e.opposite?(d&&f.oldChartWidth||f.chartWidth)-e.right-e.left:0),y:a?g-e.bottom+e.offset-(e.opposite?e.height:0):g-e.translate(b+c,null,null,d)-e.transB}},getLabelPosition:function(a,
b,c,d,e,f,g,h){var i=this.axis,j=i.transA,k=i.reversed,l=i.staggerLines,m=i.tickRotCorr||{x:0,y:0},o=e.y;s(o)||(o=i.side===0?c.rotation?-8:-c.getBBox().height:i.side===2?m.y+8:ba(c.rotation*pa)*(m.y-c.getBBox(!1,0).height/2));a=a+e.x+m.x-(f&&d?f*j*(k?-1:1):0);b=b+o-(f&&!d?f*j*(k?1:-1):0);l&&(c=g/(h||1)%l,i.opposite&&(c=l-c-1),b+=c*(i.labelOffset/l));return{x:a,y:y(b)}},getMarkPath:function(a,b,c,d,e,f){return f.crispLine(["M",a,b,"L",a+(e?0:-c),b+(e?c:0)],d)},render:function(a,b,c){var d=this.axis,
e=d.options,f=d.chart.renderer,g=d.horiz,h=this.type,i=this.label,j=this.pos,k=e.labels,l=this.gridLine,m=h?h+"Grid":"grid",o=h?h+"Tick":"tick",p=e[m+"LineWidth"],r=e[m+"LineColor"],A=e[m+"LineDashStyle"],m=d.tickSize(o),o=e[o+"Color"],P=this.mark,u=k.step,w=!0,n=d.tickmarkOffset,R=this.getPosition(g,j,n,b),ha=R.x,R=R.y,s=g&&ha===d.pos+d.len||!g&&R===d.pos?-1:1,c=q(c,1);this.isActive=!0;if(p){j=d.getPlotLinePath(j+n,p*s,b,!0);if(l===t){l={stroke:r,"stroke-width":p};if(A)l.dashstyle=A;if(!h)l.zIndex=
1;if(b)l.opacity=0;this.gridLine=l=p?f.path(j).attr(l).add(d.gridGroup):null}if(!b&&l&&j)l[this.isNew?"attr":"animate"]({d:j,opacity:c})}if(m)d.opposite&&(m[0]=-m[0]),h=this.getMarkPath(ha,R,m[0],m[1]*s,g,f),P?P.animate({d:h,opacity:c}):this.mark=f.path(h).attr({stroke:o,"stroke-width":m[1],opacity:c}).add(d.axisGroup);if(i&&!isNaN(ha))i.xy=R=this.getLabelPosition(ha,R,i,g,k,n,a,u),this.isFirst&&!this.isLast&&!q(e.showFirstLabel,1)||this.isLast&&!this.isFirst&&!q(e.showLastLabel,1)?w=!1:g&&!d.isRadial&&
!k.step&&!k.rotation&&!b&&c!==0&&this.handleOverflow(R),u&&a%u&&(w=!1),w&&!isNaN(R.y)?(R.opacity=c,i[this.isNew?"attr":"animate"](R),this.isNew=!1):i.attr("y",-9999)},destroy:function(){Pa(this,this.axis)}};z.PlotLineOrBand=function(a,b){this.axis=a;if(b)this.options=b,this.id=b.id};z.PlotLineOrBand.prototype={render:function(){var a=this,b=a.axis,c=b.horiz,d=a.options,e=d.label,f=a.label,g=d.width,h=d.to,i=d.from,j=s(i)&&s(h),k=d.value,l=d.dashStyle,m=a.svgElem,o=[],p,r=d.color,A=q(d.zIndex,0),n=
d.events,u={},w=b.chart.renderer,o=b.log2lin;b.isLog&&(i=o(i),h=o(h),k=o(k));if(g){if(o=b.getPlotLinePath(k,g),u={stroke:r,"stroke-width":g},l)u.dashstyle=l}else if(j){o=b.getPlotBandPath(i,h,d);if(r)u.fill=r;if(d.borderWidth)u.stroke=d.borderColor,u["stroke-width"]=d.borderWidth}else return;u.zIndex=A;if(m)if(o)m.show(),m.animate({d:o});else{if(m.hide(),f)a.label=f=f.destroy()}else if(o&&o.length&&(a.svgElem=m=w.path(o).attr(u).add(),n))for(p in d=function(b){m.on(b,function(c){n[b].apply(a,[c])})},
n)d(p);e&&s(e.text)&&o&&o.length&&b.width>0&&b.height>0&&!o.flat?(e=C({align:c&&j&&"center",x:c?!j&&4:10,verticalAlign:!c&&j&&"middle",y:c?j?16:10:j?6:-4,rotation:c&&!j&&90},e),this.renderLabel(e,o,j,A)):f&&f.hide();return a},renderLabel:function(a,b,c,d){var e=this.label,f=this.axis.chart.renderer;if(!e)e={align:a.textAlign||a.align,rotation:a.rotation},e.zIndex=d,this.label=e=f.text(a.text,0,0,a.useHTML).attr(e).css(a.style).add();d=[b[1],b[4],c?b[6]:b[1]];b=[b[2],b[5],c?b[7]:b[2]];c=Oa(d);f=Oa(b);
e.align(a,!1,{x:c,y:f,width:Ea(d)-c,height:Ea(b)-f});e.show()},destroy:function(){Aa(this.axis.plotLinesAndBands,this);delete this.axis;Pa(this)}};var I=z.Axis=function(){this.init.apply(this,arguments)};I.prototype={defaultOptions:{dateTimeLabelFormats:{millisecond:"%H:%M:%S.%L",second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%e. %b",week:"%e. %b",month:"%b '%y",year:"%Y"},endOnTick:!1,gridLineColor:"#D8D8D8",labels:{enabled:!0,style:{color:"#606060",cursor:"default",fontSize:"11px"},x:0},lineColor:"#C0D0E0",
lineWidth:1,minPadding:0.01,maxPadding:0.01,minorGridLineColor:"#E0E0E0",minorGridLineWidth:1,minorTickColor:"#A0A0A0",minorTickLength:2,minorTickPosition:"outside",startOfWeek:1,startOnTick:!1,tickColor:"#C0D0E0",tickLength:10,tickmarkPlacement:"between",tickPixelInterval:100,tickPosition:"outside",title:{align:"middle",style:{color:"#707070"}},type:"linear"},defaultYAxisOptions:{endOnTick:!0,gridLineWidth:1,tickPixelInterval:72,showLastLabel:!0,labels:{x:-8},lineWidth:0,maxPadding:0.05,minPadding:0.05,
startOnTick:!0,title:{rotation:270,text:"Values"},stackLabels:{enabled:!1,formatter:function(){return z.numberFormat(this.total,-1)},style:C(W.line.dataLabels.style,{color:"#000000"})}},defaultLeftAxisOptions:{labels:{x:-15},title:{rotation:270}},defaultRightAxisOptions:{labels:{x:15},title:{rotation:90}},defaultBottomAxisOptions:{labels:{autoRotation:[-45],x:0},title:{rotation:0}},defaultTopAxisOptions:{labels:{autoRotation:[-45],x:0},title:{rotation:0}},init:function(a,b){var c=b.isX;this.chart=
a;this.horiz=a.inverted?!c:c;this.coll=(this.isXAxis=c)?"xAxis":"yAxis";this.opposite=b.opposite;this.side=b.side||(this.horiz?this.opposite?0:2:this.opposite?1:3);this.setOptions(b);var d=this.options,e=d.type;this.labelFormatter=d.labels.formatter||this.defaultLabelFormatter;this.userOptions=b;this.minPixelPadding=0;this.reversed=d.reversed;this.visible=d.visible!==!1;this.zoomEnabled=d.zoomEnabled!==!1;this.categories=d.categories||e==="category";this.names=this.names||[];this.isLog=e==="logarithmic";
this.isDatetimeAxis=e==="datetime";this.isLinked=s(d.linkedTo);this.ticks={};this.labelEdge=[];this.minorTicks={};this.plotLinesAndBands=[];this.alternateBands={};this.len=0;this.minRange=this.userMinRange=d.minRange||d.maxZoom;this.range=d.range;this.offset=d.offset||0;this.stacks={};this.oldStacks={};this.stacksTouched=0;this.min=this.max=null;this.crosshair=q(d.crosshair,va(a.options.tooltip.crosshairs)[c?0:1],!1);var f,d=this.options.events;sa(this,a.axes)===-1&&(c&&!this.isColorAxis?a.axes.splice(a.xAxis.length,
0,this):a.axes.push(this),a[this.coll].push(this));this.series=this.series||[];if(a.inverted&&c&&this.reversed===t)this.reversed=!0;this.removePlotLine=this.removePlotBand=this.removePlotBandOrLine;for(f in d)D(this,f,d[f]);if(this.isLog)this.val2lin=this.log2lin,this.lin2val=this.lin2log},setOptions:function(a){this.options=C(this.defaultOptions,this.isXAxis?{}:this.defaultYAxisOptions,[this.defaultTopAxisOptions,this.defaultRightAxisOptions,this.defaultBottomAxisOptions,this.defaultLeftAxisOptions][this.side],
C(N[this.coll],a))},defaultLabelFormatter:function(){var a=this.axis,b=this.value,c=a.categories,d=this.dateTimeLabelFormat,e=N.lang.numericSymbols,f=e&&e.length,g,h=a.options.labels.format,a=a.isLog?b:a.tickInterval;if(h)g=La(h,this);else if(c)g=b;else if(d)g=ma(d,b);else if(f&&a>=1E3)for(;f--&&g===t;)c=Math.pow(1E3,f+1),a>=c&&b*10%c===0&&e[f]!==null&&(g=z.numberFormat(b/c,-1)+e[f]);g===t&&(g=S(b)>=1E4?z.numberFormat(b,-1):z.numberFormat(b,-1,t,""));return g},getSeriesExtremes:function(){var a=this,
b=a.chart;a.hasVisibleSeries=!1;a.dataMin=a.dataMax=a.threshold=null;a.softThreshold=!a.isXAxis;a.buildStacks&&a.buildStacks();n(a.series,function(c){if(c.visible||!b.options.chart.ignoreHiddenSeries){var d=c.options,e=d.threshold,f;a.hasVisibleSeries=!0;a.isLog&&e<=0&&(e=null);if(a.isXAxis){if(d=c.xData,d.length)a.dataMin=E(q(a.dataMin,d[0]),Oa(d)),a.dataMax=v(q(a.dataMax,d[0]),Ea(d))}else{c.getExtremes();f=c.dataMax;c=c.dataMin;if(s(c)&&s(f))a.dataMin=E(q(a.dataMin,c),c),a.dataMax=v(q(a.dataMax,
f),f);if(s(e))a.threshold=e;if(!d.softThreshold||a.isLog)a.softThreshold=!1}}})},translate:function(a,b,c,d,e,f){var g=this.linkedParent||this,h=1,i=0,j=d?g.oldTransA:g.transA,d=d?g.oldMin:g.min,k=g.minPixelPadding,e=(g.isOrdinal||g.isBroken||g.isLog&&e)&&g.lin2val;if(!j)j=g.transA;if(c)h*=-1,i=g.len;g.reversed&&(h*=-1,i-=h*(g.sector||g.len));b?(a=a*h+i,a-=k,a=a/j+d,e&&(a=g.lin2val(a))):(e&&(a=g.val2lin(a)),f==="between"&&(f=0.5),a=h*(a-d)*j+i+h*k+(ua(f)?j*f*g.pointRange:0));return a},toPixels:function(a,
b){return this.translate(a,!1,!this.horiz,null,!0)+(b?0:this.pos)},toValue:function(a,b){return this.translate(a-(b?0:this.pos),!0,!this.horiz,null,!0)},getPlotLinePath:function(a,b,c,d,e){var f=this.chart,g=this.left,h=this.top,i,j,k=c&&f.oldChartHeight||f.chartHeight,l=c&&f.oldChartWidth||f.chartWidth,m;i=this.transB;var o=function(a,b,c){if(a<b||a>c)d?a=E(v(b,a),c):m=!0;return a},e=q(e,this.translate(a,null,null,c)),a=c=y(e+i);i=j=y(k-e-i);isNaN(e)?m=!0:this.horiz?(i=h,j=k-this.bottom,a=c=o(a,
g,g+this.width)):(a=g,c=l-this.right,i=j=o(i,h,h+this.height));return m&&!d?null:f.renderer.crispLine(["M",a,i,"L",c,j],b||1)},getLinearTickPositions:function(a,b,c){var d,e=na(V(b/a)*a),f=na(Fa(c/a)*a),g=[];if(b===c&&ua(b))return[b];for(b=e;b<=f;){g.push(b);b=na(b+a);if(b===d)break;d=b}return g},getMinorTickPositions:function(){var a=this.options,b=this.tickPositions,c=this.minorTickInterval,d=[],e,f=this.pointRangePadding||0;e=this.min-f;var f=this.max+f,g=f-e;if(g&&g/c<this.len/3)if(this.isLog){f=
b.length;for(e=1;e<f;e++)d=d.concat(this.getLogTickPositions(c,b[e-1],b[e],!0))}else if(this.isDatetimeAxis&&a.minorTickInterval==="auto")d=d.concat(this.getTimeTicks(this.normalizeTimeTickInterval(c),e,f,a.startOfWeek));else for(b=e+(b[0]-e)%c;b<=f;b+=c)d.push(b);d.length!==0&&this.trimTicks(d,a.startOnTick,a.endOnTick);return d},adjustForMinRange:function(){var a=this.options,b=this.min,c=this.max,d,e=this.dataMax-this.dataMin>=this.minRange,f,g,h,i,j,k;if(this.isXAxis&&this.minRange===t&&!this.isLog)s(a.min)||
s(a.max)?this.minRange=null:(n(this.series,function(a){i=a.xData;for(g=j=a.xIncrement?1:i.length-1;g>0;g--)if(h=i[g]-i[g-1],f===t||h<f)f=h}),this.minRange=E(f*5,this.dataMax-this.dataMin));if(c-b<this.minRange){k=this.minRange;d=(k-c+b)/2;d=[b-d,q(a.min,b-d)];if(e)d[2]=this.dataMin;b=Ea(d);c=[b+k,q(a.max,b+k)];if(e)c[2]=this.dataMax;c=Oa(c);c-b<k&&(d[0]=c-k,d[1]=q(a.min,c-k),b=Ea(d))}this.min=b;this.max=c},getClosest:function(){var a;n(this.series,function(b){var c=b.closestPointRange;!b.noSharedTooltip&&
s(c)&&(a=s(a)?E(a,c):c)});return a},setAxisTranslation:function(a){var b=this,c=b.max-b.min,d=b.axisPointRange||0,e,f=0,g=0,h=b.linkedParent,i=!!b.categories,j=b.transA,k=b.isXAxis;if(k||i||d)if(h?(f=h.minPointOffset,g=h.pointRangePadding):(e=b.getClosest(),n(b.series,function(a){var c=i?1:k?q(a.options.pointRange,e,0):b.axisPointRange||0,a=a.options.pointPlacement;d=v(d,c);b.single||(f=v(f,Da(a)?0:c/2),g=v(g,a==="on"?0:c))})),h=b.ordinalSlope&&e?b.ordinalSlope/e:1,b.minPointOffset=f*=h,b.pointRangePadding=
g*=h,b.pointRange=E(d,c),k)b.closestPointRange=e;if(a)b.oldTransA=j;b.translationSlope=b.transA=j=b.len/(c+g||1);b.transB=b.horiz?b.left:b.bottom;b.minPixelPadding=j*f},minFromRange:function(){return this.max-this.range},setTickInterval:function(a){var b=this,c=b.chart,d=b.options,e=b.isLog,f=b.log2lin,g=b.isDatetimeAxis,h=b.isXAxis,i=b.isLinked,j=d.maxPadding,k=d.minPadding,l=d.tickInterval,m=d.tickPixelInterval,o=b.categories,p=b.threshold,r=b.softThreshold,A,P,u,w;!g&&!o&&!i&&this.getTickAmount();
u=q(b.userMin,d.min);w=q(b.userMax,d.max);i?(b.linkedParent=c[b.coll][d.linkedTo],c=b.linkedParent.getExtremes(),b.min=q(c.min,c.dataMin),b.max=q(c.max,c.dataMax),d.type!==b.linkedParent.options.type&&ga(11,1)):(!r&&s(p)&&(b.dataMin>=p?(A=p,k=0):b.dataMax<=p&&(P=p,j=0)),b.min=q(u,A,b.dataMin),b.max=q(w,P,b.dataMax));if(e)!a&&E(b.min,q(b.dataMin,b.min))<=0&&ga(10,1),b.min=na(f(b.min),15),b.max=na(f(b.max),15);if(b.range&&s(b.max))b.userMin=b.min=u=v(b.min,b.minFromRange()),b.userMax=w=b.max,b.range=
null;b.beforePadding&&b.beforePadding();b.adjustForMinRange();if(!o&&!b.axisPointRange&&!b.usePercentage&&!i&&s(b.min)&&s(b.max)&&(f=b.max-b.min))!s(u)&&k&&(b.min-=f*k),!s(w)&&j&&(b.max+=f*j);if(ua(d.floor))b.min=v(b.min,d.floor);if(ua(d.ceiling))b.max=E(b.max,d.ceiling);if(r&&s(b.dataMin))if(p=p||0,!s(u)&&b.min<p&&b.dataMin>=p)b.min=p;else if(!s(w)&&b.max>p&&b.dataMax<=p)b.max=p;b.tickInterval=b.min===b.max||b.min===void 0||b.max===void 0?1:i&&!l&&m===b.linkedParent.options.tickPixelInterval?l=b.linkedParent.tickInterval:
q(l,this.tickAmount?(b.max-b.min)/v(this.tickAmount-1,1):void 0,o?1:(b.max-b.min)*m/v(b.len,m));h&&!a&&n(b.series,function(a){a.processData(b.min!==b.oldMin||b.max!==b.oldMax)});b.setAxisTranslation(!0);b.beforeSetTickPositions&&b.beforeSetTickPositions();if(b.postProcessTickInterval)b.tickInterval=b.postProcessTickInterval(b.tickInterval);if(b.pointRange&&!l)b.tickInterval=v(b.pointRange,b.tickInterval);a=q(d.minTickInterval,b.isDatetimeAxis&&b.closestPointRange);if(!l&&b.tickInterval<a)b.tickInterval=
a;if(!g&&!e&&!l)b.tickInterval=Bb(b.tickInterval,null,Ab(b.tickInterval),q(d.allowDecimals,!(b.tickInterval>0.5&&b.tickInterval<5&&b.max>1E3&&b.max<9999)),!!this.tickAmount);if(!this.tickAmount&&this.len)b.tickInterval=b.unsquish();this.setTickPositions()},setTickPositions:function(){var a=this.options,b,c=a.tickPositions,d=a.tickPositioner,e=a.startOnTick,f=a.endOnTick,g;this.tickmarkOffset=this.categories&&a.tickmarkPlacement==="between"&&this.tickInterval===1?0.5:0;this.minorTickInterval=a.minorTickInterval===
"auto"&&this.tickInterval?this.tickInterval/5:a.minorTickInterval;this.tickPositions=b=c&&c.slice();if(!b&&(b=this.isDatetimeAxis?this.getTimeTicks(this.normalizeTimeTickInterval(this.tickInterval,a.units),this.min,this.max,a.startOfWeek,this.ordinalPositions,this.closestPointRange,!0):this.isLog?this.getLogTickPositions(this.tickInterval,this.min,this.max):this.getLinearTickPositions(this.tickInterval,this.min,this.max),b.length>this.len&&(b=[b[0],b.pop()]),this.tickPositions=b,d&&(d=d.apply(this,
[this.min,this.max]))))this.tickPositions=b=d;if(!this.isLinked)this.trimTicks(b,e,f),this.min===this.max&&s(this.min)&&!this.tickAmount&&(g=!0,this.min-=0.5,this.max+=0.5),this.single=g,!c&&!d&&this.adjustTickAmount()},trimTicks:function(a,b,c){var d=a[0],e=a[a.length-1],f=this.minPointOffset||0;if(b)this.min=d;else for(;this.min-f>a[0];)a.shift();if(c)this.max=e;else for(;this.max+f<a[a.length-1];)a.pop();a.length===0&&s(d)&&a.push((e+d)/2)},alignToOthers:function(){var a={},b,c=this.options;this.chart.options.chart.alignTicks!==
!1&&c.alignTicks!==!1&&n(this.chart[this.coll],function(c){var e=c.options,e=[c.horiz?e.left:e.top,e.width,e.height,e.pane].join(",");c.series.length&&(a[e]?b=!0:a[e]=1)});return b},getTickAmount:function(){var a=this.options,b=a.tickAmount,c=a.tickPixelInterval;!s(a.tickInterval)&&this.len<c&&!this.isRadial&&!this.isLog&&a.startOnTick&&a.endOnTick&&(b=2);!b&&this.alignToOthers()&&(b=Fa(this.len/c)+1);if(b<4)this.finalTickAmt=b,b=5;this.tickAmount=b},adjustTickAmount:function(){var a=this.tickInterval,
b=this.tickPositions,c=this.tickAmount,d=this.finalTickAmt,e=b&&b.length;if(e<c){for(;b.length<c;)b.push(na(b[b.length-1]+a));this.transA*=(e-1)/(c-1);this.max=b[b.length-1]}else e>c&&(this.tickInterval*=2,this.setTickPositions());if(s(d)){for(a=c=b.length;a--;)(d===3&&a%2===1||d<=2&&a>0&&a<c-1)&&b.splice(a,1);this.finalTickAmt=t}},setScale:function(){var a,b;this.oldMin=this.min;this.oldMax=this.max;this.oldAxisLength=this.len;this.setAxisSize();b=this.len!==this.oldAxisLength;n(this.series,function(b){if(b.isDirtyData||
b.isDirty||b.xAxis.isDirty)a=!0});if(b||a||this.isLinked||this.forceRedraw||this.userMin!==this.oldUserMin||this.userMax!==this.oldUserMax||this.alignToOthers()){if(this.resetStacks&&this.resetStacks(),this.forceRedraw=!1,this.getSeriesExtremes(),this.setTickInterval(),this.oldUserMin=this.userMin,this.oldUserMax=this.userMax,!this.isDirty)this.isDirty=b||this.min!==this.oldMin||this.max!==this.oldMax}else this.cleanStacks&&this.cleanStacks()},setExtremes:function(a,b,c,d,e){var f=this,g=f.chart,
c=q(c,!0);n(f.series,function(a){delete a.kdTree});e=x(e,{min:a,max:b});M(f,"setExtremes",e,function(){f.userMin=a;f.userMax=b;f.eventArgs=e;c&&g.redraw(d)})},zoom:function(a,b){var c=this.dataMin,d=this.dataMax,e=this.options,f=E(c,q(e.min,c)),e=v(d,q(e.max,d));this.allowZoomOutside||(s(c)&&a<=f&&(a=f),s(d)&&b>=e&&(b=e));this.displayBtn=a!==t||b!==t;this.setExtremes(a,b,!1,t,{trigger:"zoom"});return!0},setAxisSize:function(){var a=this.chart,b=this.options,c=b.offsetLeft||0,d=this.horiz,e=q(b.width,
a.plotWidth-c+(b.offsetRight||0)),f=q(b.height,a.plotHeight),g=q(b.top,a.plotTop),b=q(b.left,a.plotLeft+c),c=/%$/;c.test(f)&&(f=Math.round(parseFloat(f)/100*a.plotHeight));c.test(g)&&(g=Math.round(parseFloat(g)/100*a.plotHeight+a.plotTop));this.left=b;this.top=g;this.width=e;this.height=f;this.bottom=a.chartHeight-f-g;this.right=a.chartWidth-e-b;this.len=v(d?e:f,0);this.pos=d?b:g},getExtremes:function(){var a=this.isLog,b=this.lin2log;return{min:a?na(b(this.min)):this.min,max:a?na(b(this.max)):this.max,
dataMin:this.dataMin,dataMax:this.dataMax,userMin:this.userMin,userMax:this.userMax}},getThreshold:function(a){var b=this.isLog,c=this.lin2log,d=b?c(this.min):this.min,b=b?c(this.max):this.max;a===null?a=b<0?b:d:d>a?a=d:b<a&&(a=b);return this.translate(a,0,1,0,1)},autoLabelAlign:function(a){a=(q(a,0)-this.side*90+720)%360;return a>15&&a<165?"right":a>195&&a<345?"left":"center"},tickSize:function(a){var b=this.options,c=b[a+"Length"],d=q(b[a+"Width"],a==="tick"&&this.isXAxis?1:0);if(d&&c)return b[a+
"Position"]==="inside"&&(c=-c),[c,d]},labelMetrics:function(){return this.chart.renderer.fontMetrics(this.options.labels.style.fontSize,this.ticks[0]&&this.ticks[0].label)},unsquish:function(){var a=this.options.labels,b=this.horiz,c=this.tickInterval,d=c,e=this.len/(((this.categories?1:0)+this.max-this.min)/c),f,g=a.rotation,h=this.labelMetrics(),i,j=Number.MAX_VALUE,k,l=function(a){a/=e||1;a=a>1?Fa(a):1;return a*c};b?(k=!a.staggerLines&&!a.step&&(s(g)?[g]:e<q(a.autoRotationLimit,80)&&a.autoRotation))&&
n(k,function(a){var b;if(a===g||a&&a>=-90&&a<=90)i=l(S(h.h/ka(pa*a))),b=i+S(a/360),b<j&&(j=b,f=a,d=i)}):a.step||(d=l(h.h));this.autoRotation=k;this.labelRotation=q(f,g);return d},getSlotWidth:function(){var a=this.chart,b=this.horiz,c=this.options.labels,d=Math.max(this.tickPositions.length-(this.categories?0:1),1),e=a.margin[3];return b&&(c.step||0)<2&&!c.rotation&&(this.staggerLines||1)*a.plotWidth/d||!b&&(e&&e-a.spacing[3]||a.chartWidth*0.33)},renderUnsquish:function(){var a=this.chart,b=a.renderer,
c=this.tickPositions,d=this.ticks,e=this.options.labels,f=this.horiz,g=this.getSlotWidth(),h=v(1,y(g-2*(e.padding||5))),i={},j=this.labelMetrics(),k=e.style.textOverflow,l,m=0,o,p;if(!Da(e.rotation))i.rotation=e.rotation||0;if(this.autoRotation)n(c,function(a){if((a=d[a])&&a.labelLength>m)m=a.labelLength}),m>h&&m>j.h?i.rotation=this.labelRotation:this.labelRotation=0;else if(g&&(l={width:h+"px"},!k)){l.textOverflow="clip";for(o=c.length;!f&&o--;)if(p=c[o],h=d[p].label)if(h.styles.textOverflow==="ellipsis"?
h.css({textOverflow:"clip"}):d[p].labelLength>g&&h.css({width:g+"px"}),h.getBBox().height>this.len/c.length-(j.h-j.f))h.specCss={textOverflow:"ellipsis"}}if(i.rotation&&(l={width:(m>a.chartHeight*0.5?a.chartHeight*0.33:a.chartHeight)+"px"},!k))l.textOverflow="ellipsis";if(this.labelAlign=e.align||this.autoLabelAlign(this.labelRotation))i.align=this.labelAlign;n(c,function(a){var b=(a=d[a])&&a.label;if(b)b.attr(i),l&&b.css(C(l,b.specCss)),delete b.specCss,a.rotation=i.rotation});this.tickRotCorr=b.rotCorr(j.b,
this.labelRotation||0,this.side!==0)},hasData:function(){return this.hasVisibleSeries||s(this.min)&&s(this.max)&&!!this.tickPositions},getOffset:function(){var a=this,b=a.chart,c=b.renderer,d=a.options,e=a.tickPositions,f=a.ticks,g=a.horiz,h=a.side,i=b.inverted?[1,0,3,2][h]:h,j,k,l=0,m,o=0,p=d.title,r=d.labels,A=0,P=a.opposite,u=b.axisOffset,b=b.clipOffset,w=[-1,1,1,-1][h],O,R=a.axisParent,ha=this.tickSize("tick");j=a.hasData();a.showAxis=k=j||q(d.showEmpty,!0);a.staggerLines=a.horiz&&r.staggerLines;
if(!a.axisGroup)a.gridGroup=c.g("grid").attr({zIndex:d.gridZIndex||1}).add(R),a.axisGroup=c.g("axis").attr({zIndex:d.zIndex||2}).add(R),a.labelGroup=c.g("axis-labels").attr({zIndex:r.zIndex||7}).addClass("highcharts-"+a.coll.toLowerCase()+"-labels").add(R);if(j||a.isLinked){if(n(e,function(b){f[b]?f[b].addLabel():f[b]=new cb(a,b)}),a.renderUnsquish(),r.reserveSpace!==!1&&(h===0||h===2||{1:"left",3:"right"}[h]===a.labelAlign||a.labelAlign==="center")&&n(e,function(a){A=v(f[a].getLabelSize(),A)}),a.staggerLines)A*=
a.staggerLines,a.labelOffset=A*(a.opposite?-1:1)}else for(O in f)f[O].destroy(),delete f[O];if(p&&p.text&&p.enabled!==!1){if(!a.axisTitle)a.axisTitle=c.text(p.text,0,0,p.useHTML).attr({zIndex:7,rotation:p.rotation||0,align:p.textAlign||{low:P?"right":"left",middle:"center",high:P?"left":"right"}[p.align]}).addClass("highcharts-"+this.coll.toLowerCase()+"-title").css(p.style).add(a.axisGroup),a.axisTitle.isNew=!0;if(k)l=a.axisTitle.getBBox()[g?"height":"width"],m=p.offset,o=s(m)?0:q(p.margin,g?5:10);
a.axisTitle[k?"show":"hide"](!0)}a.offset=w*q(d.offset,u[h]);a.tickRotCorr=a.tickRotCorr||{x:0,y:0};c=h===0?-a.labelMetrics().h:h===2?a.tickRotCorr.y:0;o=Math.abs(A)+o;A&&(o-=c,o+=w*(g?q(r.y,a.tickRotCorr.y+w*8):r.x));a.axisTitleMargin=q(m,o);u[h]=v(u[h],a.axisTitleMargin+l+w*a.offset,o,j&&e.length&&ha?ha[0]:0);d=d.offset?0:V(d.lineWidth/2)*2;b[i]=v(b[i],d)},getLinePath:function(a){var b=this.chart,c=this.opposite,d=this.offset,e=this.horiz,f=this.left+(c?this.width:0)+d,d=b.chartHeight-this.bottom-
(c?this.height:0)+d;c&&(a*=-1);return b.renderer.crispLine(["M",e?this.left:f,e?d:this.top,"L",e?b.chartWidth-this.right:f,e?d:b.chartHeight-this.bottom],a)},getTitlePosition:function(){var a=this.horiz,b=this.left,c=this.top,d=this.len,e=this.options.title,f=a?b:c,g=this.opposite,h=this.offset,i=e.x||0,j=e.y||0,k=G(e.style.fontSize||12),d={low:f+(a?0:d),middle:f+d/2,high:f+(a?d:0)}[e.align],b=(a?c+this.height:b)+(a?1:-1)*(g?-1:1)*this.axisTitleMargin+(this.side===2?k:0);return{x:a?d+i:b+(g?this.width:
0)+h+i,y:a?b+j-(g?this.height:0)+h:d+j}},render:function(){var a=this,b=a.chart,c=b.renderer,d=a.options,e=a.isLog,f=a.lin2log,g=a.isLinked,h=a.tickPositions,i=a.axisTitle,j=a.ticks,k=a.minorTicks,l=a.alternateBands,m=d.stackLabels,o=d.alternateGridColor,p=a.tickmarkOffset,r=d.lineWidth,A,q=b.hasRendered&&s(a.oldMin)&&!isNaN(a.oldMin),u=a.showAxis,w=hb(c.globalAnimation),O,R;a.labelEdge.length=0;a.overlap=!1;n([j,k,l],function(a){for(var b in a)a[b].isActive=!1});if(a.hasData()||g){a.minorTickInterval&&
!a.categories&&n(a.getMinorTickPositions(),function(b){k[b]||(k[b]=new cb(a,b,"minor"));q&&k[b].isNew&&k[b].render(null,!0);k[b].render(null,!1,1)});if(h.length&&(n(h,function(b,c){if(!g||b>=a.min&&b<=a.max)j[b]||(j[b]=new cb(a,b)),q&&j[b].isNew&&j[b].render(c,!0,0.1),j[b].render(c)}),p&&(a.min===0||a.single)))j[-1]||(j[-1]=new cb(a,-1,null,!0)),j[-1].render(-1);o&&n(h,function(c,d){R=h[d+1]!==t?h[d+1]+p:a.max-p;if(d%2===0&&c<a.max&&R<=a.max+(b.polar?-p:p))l[c]||(l[c]=new z.PlotLineOrBand(a)),O=c+
p,l[c].options={from:e?f(O):O,to:e?f(R):R,color:o},l[c].render(),l[c].isActive=!0});if(!a._addedPlotLB)n((d.plotLines||[]).concat(d.plotBands||[]),function(b){a.addPlotBandOrLine(b)}),a._addedPlotLB=!0}n([j,k,l],function(a){var c,d,e=[],f=w.duration;for(c in a)if(!a[c].isActive)a[c].render(c,!1,0),a[c].isActive=!1,e.push(c);$a(function(){for(d=e.length;d--;)a[e[d]]&&!a[e[d]].isActive&&(a[e[d]].destroy(),delete a[e[d]])},a===l||!b.hasRendered||!f?0:f)});if(r)A=a.getLinePath(r),a.axisLine?a.axisLine.animate({d:A}):
a.axisLine=c.path(A).attr({stroke:d.lineColor,"stroke-width":r,zIndex:7}).add(a.axisGroup),a.axisLine[u?"show":"hide"](!0);if(i&&u)i[i.isNew?"attr":"animate"](a.getTitlePosition()),i.isNew=!1;m&&m.enabled&&a.renderStackTotals();a.isDirty=!1},redraw:function(){this.visible&&(this.render(),n(this.plotLinesAndBands,function(a){a.render()}));n(this.series,function(a){a.isDirty=!0})},destroy:function(a){var b=this,c=b.stacks,d,e=b.plotLinesAndBands;a||T(b);for(d in c)Pa(c[d]),c[d]=null;n([b.ticks,b.minorTicks,
b.alternateBands],function(a){Pa(a)});for(a=e.length;a--;)e[a].destroy();n("stackTotalGroup,axisLine,axisTitle,axisGroup,cross,gridGroup,labelGroup".split(","),function(a){b[a]&&(b[a]=b[a].destroy())});this.cross&&this.cross.destroy()},drawCrosshair:function(a,b){var c,d=this.crosshair,e,f;if(!this.crosshair||(s(b)||!q(d.snap,!0))===!1)this.hideCrosshair();else if(q(d.snap,!0)?s(b)&&(c=this.isXAxis?b.plotX:this.len-b.plotY):c=this.horiz?a.chartX-this.pos:this.len-a.chartY+this.pos,c=this.isRadial?
this.getPlotLinePath(this.isXAxis?b.x:q(b.stackY,b.y))||null:this.getPlotLinePath(null,null,null,null,c)||null,c===null)this.hideCrosshair();else if(e=this.categories&&!this.isRadial,f=q(d.width,e?this.transA:1),this.cross)this.cross.attr({d:c,visibility:"visible","stroke-width":f});else{e={"stroke-width":f,stroke:d.color||(e?"rgba(155,200,255,0.2)":"#C0C0C0"),zIndex:q(d.zIndex,2)};if(d.dashStyle)e.dashstyle=d.dashStyle;this.cross=this.chart.renderer.path(c).attr(e).add()}},hideCrosshair:function(){this.cross&&
this.cross.hide()}};x(I.prototype,{getPlotBandPath:function(a,b){var c=this.getPlotLinePath(b,null,null,!0),d=this.getPlotLinePath(a,null,null,!0);d&&c?(d.flat=d.toString()===c.toString(),d.push(c[4],c[5],c[1],c[2])):d=null;return d},addPlotBand:function(a){return this.addPlotBandOrLine(a,"plotBands")},addPlotLine:function(a){return this.addPlotBandOrLine(a,"plotLines")},addPlotBandOrLine:function(a,b){var c=(new z.PlotLineOrBand(this,a)).render(),d=this.userOptions;c&&(b&&(d[b]=d[b]||[],d[b].push(a)),
this.plotLinesAndBands.push(c));return c},removePlotBandOrLine:function(a){for(var b=this.plotLinesAndBands,c=this.options,d=this.userOptions,e=b.length;e--;)b[e].id===a&&b[e].destroy();n([c.plotLines||[],d.plotLines||[],c.plotBands||[],d.plotBands||[]],function(b){for(e=b.length;e--;)b[e].id===a&&Aa(b,b[e])})}});I.prototype.getTimeTicks=function(a,b,c,d){var e=[],f={},g=N.global.useUTC,h,i=new fa(b-fb(b)),j=a.unitRange,k=a.count;if(s(b)){i[Pb](j>=H.second?0:k*V(i.getMilliseconds()/k));if(j>=H.second)i[Qb](j>=
H.minute?0:k*V(i.getSeconds()/k));if(j>=H.minute)i[Rb](j>=H.hour?0:k*V(i[Cb]()/k));if(j>=H.hour)i[Sb](j>=H.day?0:k*V(i[Db]()/k));if(j>=H.day)i[rb](j>=H.month?1:k*V(i[bb]()/k));j>=H.month&&(i[Fb](j>=H.year?0:k*V(i[ib]()/k)),h=i[jb]());j>=H.year&&(h-=h%k,i[Gb](h));if(j===H.week)i[rb](i[bb]()-i[Eb]()+q(d,1));b=1;if(zb||gb)i=i.getTime(),i=new fa(i+fb(i));h=i[jb]();for(var d=i.getTime(),l=i[ib](),m=i[bb](),o=!g||!!gb,p=(H.day+(g?fb(i):i.getTimezoneOffset()*6E4))%H.day;d<c;)e.push(d),j===H.year?d=qb(h+
b*k,0):j===H.month?d=qb(h,l+b*k):o&&(j===H.day||j===H.week)?d=qb(h,l,m+b*k*(j===H.day?1:7)):d+=j*k,b++;e.push(d);n(Sa(e,function(a){return j<=H.hour&&a%H.day===p}),function(a){f[a]="day"})}e.info=x(a,{higherRanks:f,totalRange:j*k});return e};I.prototype.normalizeTimeTickInterval=function(a,b){var c=b||[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1,2]],["week",[1,2]],["month",[1,2,3,4,6]],["year",null]],d=
c[c.length-1],e=H[d[0]],f=d[1],g;for(g=0;g<c.length;g++)if(d=c[g],e=H[d[0]],f=d[1],c[g+1]&&a<=(e*f[f.length-1]+H[c[g+1][0]])/2)break;e===H.year&&a<5*e&&(f=[1,2,5]);c=Bb(a/e,f,d[0]==="year"?v(Ab(a/e),1):1);return{unitRange:e,count:c,unitName:d[0]}};I.prototype.getLogTickPositions=function(a,b,c,d){var e=this.options,f=this.len,g=this.lin2log,h=this.log2lin,i=[];if(!d)this._minorAutoInterval=null;if(a>=0.5)a=y(a),i=this.getLinearTickPositions(a,b,c);else if(a>=0.08)for(var f=V(b),j,k,l,m,o,e=a>0.3?
[1,2,4]:a>0.15?[1,2,4,6,8]:[1,2,3,4,5,6,7,8,9];f<c+1&&!o;f++){k=e.length;for(j=0;j<k&&!o;j++)l=h(g(f)*e[j]),l>b&&(!d||m<=c)&&m!==t&&i.push(m),m>c&&(o=!0),m=l}else if(b=g(b),c=g(c),a=e[d?"minorTickInterval":"tickInterval"],a=q(a==="auto"?null:a,this._minorAutoInterval,(c-b)*(e.tickPixelInterval/(d?5:1))/((d?f/this.tickPositions.length:f)||1)),a=Bb(a,null,Ab(a)),i=ta(this.getLinearTickPositions(a,b,c),h),!d)this._minorAutoInterval=a/5;if(!d)this.tickInterval=a;return i};I.prototype.log2lin=function(a){return Y.log(a)/
Y.LN10};I.prototype.lin2log=function(a){return Y.pow(10,a)};var Lb=z.Tooltip=function(){this.init.apply(this,arguments)};Lb.prototype={init:function(a,b){var c=b.borderWidth,d=b.style,e=G(d.padding);this.chart=a;this.options=b;this.crosshairs=[];this.now={x:0,y:0};this.isHidden=!0;this.label=a.renderer.label("",0,0,b.shape||"callout",null,null,b.useHTML,null,"tooltip").attr({padding:e,fill:b.backgroundColor,"stroke-width":c,r:b.borderRadius,zIndex:8}).css(d).css({padding:0}).add().attr({y:-9999});
qa||this.label.shadow(b.shadow);this.shared=b.shared},destroy:function(){if(this.label)this.label=this.label.destroy();clearTimeout(this.hideTimer);clearTimeout(this.tooltipTimeout)},move:function(a,b,c,d){var e=this,f=e.now,g=e.options.animation!==!1&&!e.isHidden&&(S(a-f.x)>1||S(b-f.y)>1),h=e.followPointer||e.len>1;x(f,{x:g?(2*f.x+a)/3:a,y:g?(f.y+b)/2:b,anchorX:h?t:g?(2*f.anchorX+c)/3:c,anchorY:h?t:g?(f.anchorY+d)/2:d});e.label.attr(f);if(g)clearTimeout(this.tooltipTimeout),this.tooltipTimeout=setTimeout(function(){e&&
e.move(a,b,c,d)},32)},hide:function(a){var b=this;clearTimeout(this.hideTimer);a=q(a,this.options.hideDelay,500);if(!this.isHidden)this.hideTimer=$a(function(){b.label[a?"fadeOut":"hide"]();b.isHidden=!0},a)},getAnchor:function(a,b){var c,d=this.chart,e=d.inverted,f=d.plotTop,g=d.plotLeft,h=0,i=0,j,k,a=va(a);c=a[0].tooltipPos;this.followPointer&&b&&(b.chartX===t&&(b=d.pointer.normalize(b)),c=[b.chartX-d.plotLeft,b.chartY-f]);c||(n(a,function(a){j=a.series.yAxis;k=a.series.xAxis;h+=a.plotX+(!e&&k?
k.left-g:0);i+=(a.plotLow?(a.plotLow+a.plotHigh)/2:a.plotY)+(!e&&j?j.top-f:0)}),h/=a.length,i/=a.length,c=[e?d.plotWidth-i:h,this.shared&&!e&&a.length>1&&b?b.chartY-f:e?d.plotHeight-h:i]);return ta(c,y)},getPosition:function(a,b,c){var d=this.chart,e=this.distance,f={},g=c.h||0,h,i=["y",d.chartHeight,b,c.plotY+d.plotTop,d.plotTop,d.plotTop+d.plotHeight],j=["x",d.chartWidth,a,c.plotX+d.plotLeft,d.plotLeft,d.plotLeft+d.plotWidth],k=!this.followPointer&&q(c.ttBelow,!d.inverted===!!c.negative),l=function(a,
b,c,d,h,i){var j=c<d-e,m=d+e+c<b,l=d-e-c;d+=e;if(k&&m)f[a]=d;else if(!k&&j)f[a]=l;else if(j)f[a]=E(i-c,l-g<0?l:l-g);else if(m)f[a]=v(h,d+g+c>b?d:d+g);else return!1},m=function(a,b,c,d){var g;d<e||d>b-e?g=!1:f[a]=d<c/2?1:d>b-c/2?b-c-2:d-c/2;return g},o=function(a){var b=i;i=j;j=b;h=a},p=function(){l.apply(0,i)!==!1?m.apply(0,j)===!1&&!h&&(o(!0),p()):h?f.x=f.y=0:(o(!0),p())};(d.inverted||this.len>1)&&o();p();return f},defaultFormatter:function(a){var b=this.points||va(this),c;c=[a.tooltipFooterHeaderFormatter(b[0])];
c=c.concat(a.bodyFormatter(b));c.push(a.tooltipFooterHeaderFormatter(b[0],!0));return c.join("")},refresh:function(a,b){var c=this.chart,d=this.label,e=this.options,f,g,h,i={},j,k=[];j=e.formatter||this.defaultFormatter;var i=c.hoverPoints,l,m=this.shared;clearTimeout(this.hideTimer);this.followPointer=va(a)[0].series.tooltipOptions.followPointer;h=this.getAnchor(a,b);f=h[0];g=h[1];m&&(!a.series||!a.series.noSharedTooltip)?(c.hoverPoints=a,i&&n(i,function(a){a.setState()}),n(a,function(a){a.setState("hover");
k.push(a.getLabelConfig())}),i={x:a[0].category,y:a[0].y},i.points=k,this.len=k.length,a=a[0]):i=a.getLabelConfig();j=j.call(i,this);i=a.series;this.distance=q(i.tooltipOptions.distance,16);j===!1?this.hide():(this.isHidden&&(Ta(d),d.attr("opacity",1).show()),d.attr({text:j}),l=e.borderColor||a.color||i.color||"#606060",d.attr({stroke:l}),this.updatePosition({plotX:f,plotY:g,negative:a.negative,ttBelow:a.ttBelow,h:h[2]||0}),this.isHidden=!1);M(c,"tooltipRefresh",{text:j,x:f+c.plotLeft,y:g+c.plotTop,
borderColor:l})},updatePosition:function(a){var b=this.chart,c=this.label,c=(this.options.positioner||this.getPosition).call(this,c.width,c.height,a);this.move(y(c.x),y(c.y||0),a.plotX+b.plotLeft,a.plotY+b.plotTop)},getXDateFormat:function(a,b,c){var d,b=b.dateTimeLabelFormats,e=c&&c.closestPointRange,f,g={millisecond:15,second:12,minute:9,hour:6,day:3},h,i="millisecond";if(e){h=ma("%m-%d %H:%M:%S.%L",a.x);for(f in H){if(e===H.week&&+ma("%w",a.x)===c.options.startOfWeek&&h.substr(6)==="00:00:00.000"){f=
"week";break}if(H[f]>e){f=i;break}if(g[f]&&h.substr(g[f])!=="01-01 00:00:00.000".substr(g[f]))break;f!=="week"&&(i=f)}f&&(d=b[f])}else d=b.day;return d||b.year},tooltipFooterHeaderFormatter:function(a,b){var c=b?"footer":"header",d=a.series,e=d.tooltipOptions,f=e.xDateFormat,g=d.xAxis,h=g&&g.options.type==="datetime"&&ua(a.key),c=e[c+"Format"];h&&!f&&(f=this.getXDateFormat(a,e,g));h&&f&&(c=c.replace("{point.key}","{point.key:"+f+"}"));return La(c,{point:a,series:d})},bodyFormatter:function(a){return ta(a,
function(a){var c=a.series.tooltipOptions;return(c.pointFormatter||a.point.tooltipFormatter).call(a.point,c.pointFormat)})}};var oa;db=B&&B.documentElement.ontouchstart!==t;var Za=z.Pointer=function(a,b){this.init(a,b)};Za.prototype={init:function(a,b){var c=b.chart,d=c.events,e=qa?"":c.zoomType,c=a.inverted,f;this.options=b;this.chart=a;this.zoomX=f=/x/.test(e);this.zoomY=e=/y/.test(e);this.zoomHor=f&&!c||e&&c;this.zoomVert=e&&!c||f&&c;this.hasZoom=f||e;this.runChartClick=d&&!!d.click;this.pinchDown=
[];this.lastValidTouch={};if(z.Tooltip&&b.tooltip.enabled)a.tooltip=new Lb(a,b.tooltip),this.followTouchMove=q(b.tooltip.followTouchMove,!0);this.setDOMEvents()},normalize:function(a,b){var c,d,a=a||J.event;if(!a.target)a.target=a.srcElement;d=a.touches?a.touches.length?a.touches.item(0):a.changedTouches[0]:a;if(!b)this.chartPosition=b=Kb(this.chart.container);d.pageX===t?(c=v(a.x,a.clientX-b.left),d=a.y):(c=d.pageX-b.left,d=d.pageY-b.top);return x(a,{chartX:y(c),chartY:y(d)})},getCoordinates:function(a){var b=
{xAxis:[],yAxis:[]};n(this.chart.axes,function(c){b[c.isXAxis?"xAxis":"yAxis"].push({axis:c,value:c.toValue(a[c.horiz?"chartX":"chartY"])})});return b},runPointActions:function(a){var b=this.chart,c=b.series,d=b.tooltip,e=d?d.shared:!1,f=b.hoverPoint,g=b.hoverSeries,h,i=[Number.MAX_VALUE,Number.MAX_VALUE],j,k,l=[],m=[],o;if(!e&&!g)for(h=0;h<c.length;h++)if(c[h].directTouch||!c[h].options.stickyTracking)c=[];g&&(e?g.noSharedTooltip:g.directTouch)&&f?m=[f]:(n(c,function(b){j=b.noSharedTooltip&&e;k=
!e&&b.directTouch;b.visible&&!j&&!k&&q(b.options.enableMouseTracking,!0)&&(o=b.searchPoint(a,!j&&b.kdDimensions===1))&&l.push(o)}),n(l,function(a){a&&n(["dist","distX"],function(b,c){if(typeof a[b]==="number"){var d=a[b]===i[c]&&a.series.group.zIndex>=m[c].series.group.zIndex;if(a[b]<i[c]||d)i[c]=a[b],m[c]=a}})}));if(e)for(h=l.length;h--;)(l[h].clientX!==m[1].clientX||l[h].series.noSharedTooltip)&&l.splice(h,1);if(m[0]&&(m[0]!==this.prevKDPoint||d&&d.isHidden))if(e&&!m[0].series.noSharedTooltip)l.length&&
d&&d.refresh(l,a),n(l,function(b){b.onMouseOver(a,b!==(g&&g.directTouch&&f||m[0]))}),this.prevKDPoint=m[1];else{d&&d.refresh(m[0],a);if(!g||!g.directTouch)m[0].onMouseOver(a);this.prevKDPoint=m[0]}else c=g&&g.tooltipOptions.followPointer,d&&c&&!d.isHidden&&(c=d.getAnchor([{}],a),d.updatePosition({plotX:c[0],plotY:c[1]}));if(!this._onDocumentMouseMove)this._onDocumentMouseMove=function(a){if($[oa])$[oa].pointer.onDocumentMouseMove(a)},D(B,"mousemove",this._onDocumentMouseMove);n(e?l:[q(m[1],f)],function(c){n(b.axes,
function(b){(!c||c.series[b.coll]===b)&&b.drawCrosshair(a,c)})})},reset:function(a,b){var c=this.chart,d=c.hoverSeries,e=c.hoverPoint,f=c.hoverPoints,g=c.tooltip,h=g&&g.shared?f:e;a&&h&&n(va(h),function(b){b.series.isCartesian&&b.plotX===void 0&&(a=!1)});if(a)g&&h&&(g.refresh(h),e&&(e.setState(e.state,!0),n(c.axes,function(a){q(a.crosshair&&a.crosshair.snap,!0)?a.drawCrosshair(null,e):a.hideCrosshair()})));else{if(e)e.onMouseOut();f&&n(f,function(a){a.setState()});if(d)d.onMouseOut();g&&g.hide(b);
if(this._onDocumentMouseMove)T(B,"mousemove",this._onDocumentMouseMove),this._onDocumentMouseMove=null;n(c.axes,function(a){a.hideCrosshair()});this.hoverX=c.hoverPoints=c.hoverPoint=null}},scaleGroups:function(a,b){var c=this.chart,d;n(c.series,function(e){d=a||e.getPlotBox();e.xAxis&&e.xAxis.zoomEnabled&&(e.group.attr(d),e.markerGroup&&(e.markerGroup.attr(d),e.markerGroup.clip(b?c.clipRect:null)),e.dataLabelsGroup&&e.dataLabelsGroup.attr(d))});c.clipRect.attr(b||c.clipBox)},dragStart:function(a){var b=
this.chart;b.mouseIsDown=a.type;b.cancelClick=!1;b.mouseDownX=this.mouseDownX=a.chartX;b.mouseDownY=this.mouseDownY=a.chartY},drag:function(a){var b=this.chart,c=b.options.chart,d=a.chartX,e=a.chartY,f=this.zoomHor,g=this.zoomVert,h=b.plotLeft,i=b.plotTop,j=b.plotWidth,k=b.plotHeight,l,m=this.selectionMarker,o=this.mouseDownX,p=this.mouseDownY,r=c.panKey&&a[c.panKey+"Key"];if(!m||!m.touch)if(d<h?d=h:d>h+j&&(d=h+j),e<i?e=i:e>i+k&&(e=i+k),this.hasDragged=Math.sqrt(Math.pow(o-d,2)+Math.pow(p-e,2)),this.hasDragged>
10){l=b.isInsidePlot(o-h,p-i);if(b.hasCartesianSeries&&(this.zoomX||this.zoomY)&&l&&!r&&!m)this.selectionMarker=m=b.renderer.rect(h,i,f?1:j,g?1:k,0).attr({fill:c.selectionMarkerFill||"rgba(69,114,167,0.25)",zIndex:7}).add();m&&f&&(d-=o,m.attr({width:S(d),x:(d>0?0:d)+o}));m&&g&&(d=e-p,m.attr({height:S(d),y:(d>0?0:d)+p}));l&&!m&&c.panning&&b.pan(a,c.panning)}},drop:function(a){var b=this,c=this.chart,d=this.hasPinched;if(this.selectionMarker){var e={originalEvent:a,xAxis:[],yAxis:[]},f=this.selectionMarker,
g=f.attr?f.attr("x"):f.x,h=f.attr?f.attr("y"):f.y,i=f.attr?f.attr("width"):f.width,j=f.attr?f.attr("height"):f.height,k;if(this.hasDragged||d)n(c.axes,function(c){if(c.zoomEnabled&&s(c.min)&&(d||b[{xAxis:"zoomX",yAxis:"zoomY"}[c.coll]])){var f=c.horiz,o=a.type==="touchend"?c.minPixelPadding:0,p=c.toValue((f?g:h)+o),f=c.toValue((f?g+i:h+j)-o);e[c.coll].push({axis:c,min:E(p,f),max:v(p,f)});k=!0}}),k&&M(c,"selection",e,function(a){c.zoom(x(a,d?{animation:!1}:null))});this.selectionMarker=this.selectionMarker.destroy();
d&&this.scaleGroups()}if(c)F(c.container,{cursor:c._cursor}),c.cancelClick=this.hasDragged>10,c.mouseIsDown=this.hasDragged=this.hasPinched=!1,this.pinchDown=[]},onContainerMouseDown:function(a){a=this.normalize(a);a.preventDefault&&a.preventDefault();this.dragStart(a)},onDocumentMouseUp:function(a){$[oa]&&$[oa].pointer.drop(a)},onDocumentMouseMove:function(a){var b=this.chart,c=this.chartPosition,a=this.normalize(a,c);c&&!this.inClass(a.target,"highcharts-tracker")&&!b.isInsidePlot(a.chartX-b.plotLeft,
a.chartY-b.plotTop)&&this.reset()},onContainerMouseLeave:function(a){var b=$[oa];if(b&&(a.relatedTarget||a.toElement))b.pointer.reset(),b.pointer.chartPosition=null},onContainerMouseMove:function(a){var b=this.chart;if(!s(oa)||!$[oa]||!$[oa].mouseIsDown)oa=b.index;a=this.normalize(a);a.returnValue=!1;b.mouseIsDown==="mousedown"&&this.drag(a);(this.inClass(a.target,"highcharts-tracker")||b.isInsidePlot(a.chartX-b.plotLeft,a.chartY-b.plotTop))&&!b.openMenu&&this.runPointActions(a)},inClass:function(a,
b){for(var c;a;){if(c=X(a,"class")){if(c.indexOf(b)!==-1)return!0;if(c.indexOf("highcharts-container")!==-1)return!1}a=a.parentNode}},onTrackerMouseOut:function(a){var b=this.chart.hoverSeries,a=a.relatedTarget||a.toElement;if(b&&a&&!b.options.stickyTracking&&!this.inClass(a,"highcharts-tooltip")&&!this.inClass(a,"highcharts-series-"+b.index))b.onMouseOut()},onContainerClick:function(a){var b=this.chart,c=b.hoverPoint,d=b.plotLeft,e=b.plotTop,a=this.normalize(a);b.cancelClick||(c&&this.inClass(a.target,
"highcharts-tracker")?(M(c.series,"click",x(a,{point:c})),b.hoverPoint&&c.firePointEvent("click",a)):(x(a,this.getCoordinates(a)),b.isInsidePlot(a.chartX-d,a.chartY-e)&&M(b,"click",a)))},setDOMEvents:function(){var a=this,b=a.chart.container;b.onmousedown=function(b){a.onContainerMouseDown(b)};b.onmousemove=function(b){a.onContainerMouseMove(b)};b.onclick=function(b){a.onContainerClick(b)};D(b,"mouseleave",a.onContainerMouseLeave);lb===1&&D(B,"mouseup",a.onDocumentMouseUp);if(db)b.ontouchstart=function(b){a.onContainerTouchStart(b)},
b.ontouchmove=function(b){a.onContainerTouchMove(b)},lb===1&&D(B,"touchend",a.onDocumentTouchEnd)},destroy:function(){var a;T(this.chart.container,"mouseleave",this.onContainerMouseLeave);lb||(T(B,"mouseup",this.onDocumentMouseUp),T(B,"touchend",this.onDocumentTouchEnd));clearInterval(this.tooltipTimeout);for(a in this)this[a]=null}};x(z.Pointer.prototype,{pinchTranslate:function(a,b,c,d,e,f){(this.zoomHor||this.pinchHor)&&this.pinchTranslateDirection(!0,a,b,c,d,e,f);(this.zoomVert||this.pinchVert)&&
this.pinchTranslateDirection(!1,a,b,c,d,e,f)},pinchTranslateDirection:function(a,b,c,d,e,f,g,h){var i=this.chart,j=a?"x":"y",k=a?"X":"Y",l="chart"+k,m=a?"width":"height",o=i["plot"+(a?"Left":"Top")],p,r,A=h||1,q=i.inverted,n=i.bounds[a?"h":"v"],w=b.length===1,O=b[0][l],s=c[0][l],v=!w&&b[1][l],t=!w&&c[1][l],y,c=function(){!w&&S(O-v)>20&&(A=h||S(s-t)/S(O-v));r=(o-s)/A+O;p=i["plot"+(a?"Width":"Height")]/A};c();b=r;b<n.min?(b=n.min,y=!0):b+p>n.max&&(b=n.max-p,y=!0);y?(s-=0.8*(s-g[j][0]),w||(t-=0.8*(t-
g[j][1])),c()):g[j]=[s,t];q||(f[j]=r-o,f[m]=p);f=q?1/A:A;e[m]=p;e[j]=b;d[q?a?"scaleY":"scaleX":"scale"+k]=A;d["translate"+k]=f*o+(s-f*O)},pinch:function(a){var b=this,c=b.chart,d=b.pinchDown,e=a.touches,f=e.length,g=b.lastValidTouch,h=b.hasZoom,i=b.selectionMarker,j={},k=f===1&&(b.inClass(a.target,"highcharts-tracker")&&c.runTrackerClick||b.runChartClick),l={};if(f>1)b.initiated=!0;h&&b.initiated&&!k&&a.preventDefault();ta(e,function(a){return b.normalize(a)});if(a.type==="touchstart")n(e,function(a,
b){d[b]={chartX:a.chartX,chartY:a.chartY}}),g.x=[d[0].chartX,d[1]&&d[1].chartX],g.y=[d[0].chartY,d[1]&&d[1].chartY],n(c.axes,function(a){if(a.zoomEnabled){var b=c.bounds[a.horiz?"h":"v"],d=a.minPixelPadding,e=a.toPixels(q(a.options.min,a.dataMin)),f=a.toPixels(q(a.options.max,a.dataMax)),g=E(e,f),e=v(e,f);b.min=E(a.pos,g-d);b.max=v(a.pos+a.len,e+d)}}),b.res=!0;else if(d.length){if(!i)b.selectionMarker=i=x({destroy:ra,touch:!0},c.plotBox);b.pinchTranslate(d,e,j,i,l,g);b.hasPinched=h;b.scaleGroups(j,
l);if(!h&&b.followTouchMove&&f===1)this.runPointActions(b.normalize(a));else if(b.res)b.res=!1,this.reset(!1,0)}},touch:function(a,b){var c=this.chart,d;oa=c.index;if(a.touches.length===1)if(a=this.normalize(a),c.isInsidePlot(a.chartX-c.plotLeft,a.chartY-c.plotTop)&&!c.openMenu){b&&this.runPointActions(a);if(a.type==="touchmove")c=this.pinchDown,d=Math.sqrt(Math.pow(c[0].chartX-a.chartX,2)+Math.pow(c[0].chartY-a.chartY,2))>=4;q(d,!0)&&this.pinch(a)}else b&&this.reset();else a.touches.length===2&&
this.pinch(a)},onContainerTouchStart:function(a){this.touch(a,!0)},onContainerTouchMove:function(a){this.touch(a)},onDocumentTouchEnd:function(a){$[oa]&&$[oa].pointer.drop(a)}});if(J.PointerEvent||J.MSPointerEvent){var Ga={},Mb=!!J.PointerEvent,ac=function(){var a,b=[];b.item=function(a){return this[a]};for(a in Ga)Ga.hasOwnProperty(a)&&b.push({pageX:Ga[a].pageX,pageY:Ga[a].pageY,target:Ga[a].target});return b},Nb=function(a,b,c,d){if((a.pointerType==="touch"||a.pointerType===a.MSPOINTER_TYPE_TOUCH)&&
$[oa])d(a),d=$[oa].pointer,d[b]({type:c,target:a.currentTarget,preventDefault:ra,touches:ac()})};x(Za.prototype,{onContainerPointerDown:function(a){Nb(a,"onContainerTouchStart","touchstart",function(a){Ga[a.pointerId]={pageX:a.pageX,pageY:a.pageY,target:a.currentTarget}})},onContainerPointerMove:function(a){Nb(a,"onContainerTouchMove","touchmove",function(a){Ga[a.pointerId]={pageX:a.pageX,pageY:a.pageY};if(!Ga[a.pointerId].target)Ga[a.pointerId].target=a.currentTarget})},onDocumentPointerUp:function(a){Nb(a,
"onDocumentTouchEnd","touchend",function(a){delete Ga[a.pointerId]})},batchMSEvents:function(a){a(this.chart.container,Mb?"pointerdown":"MSPointerDown",this.onContainerPointerDown);a(this.chart.container,Mb?"pointermove":"MSPointerMove",this.onContainerPointerMove);a(B,Mb?"pointerup":"MSPointerUp",this.onDocumentPointerUp)}});U(Za.prototype,"init",function(a,b,c){a.call(this,b,c);this.hasZoom&&F(b.container,{"-ms-touch-action":"none","touch-action":"none"})});U(Za.prototype,"setDOMEvents",function(a){a.apply(this);
(this.hasZoom||this.followTouchMove)&&this.batchMSEvents(D)});U(Za.prototype,"destroy",function(a){this.batchMSEvents(T);a.call(this)})}var vb=z.Legend=function(a,b){this.init(a,b)};vb.prototype={init:function(a,b){var c=this,d=b.itemStyle,e=b.itemMarginTop||0;this.options=b;if(b.enabled)c.itemStyle=d,c.itemHiddenStyle=C(d,b.itemHiddenStyle),c.itemMarginTop=e,c.padding=d=q(b.padding,8),c.initialItemX=d,c.initialItemY=d-5,c.maxItemWidth=0,c.chart=a,c.itemHeight=0,c.symbolWidth=q(b.symbolWidth,16),
c.pages=[],c.render(),D(c.chart,"endResize",function(){c.positionCheckboxes()})},colorizeItem:function(a,b){var c=this.options,d=a.legendItem,e=a.legendLine,f=a.legendSymbol,g=this.itemHiddenStyle.color,c=b?c.itemStyle.color:g,h=b?a.legendColor||a.color||"#CCC":g,g=a.options&&a.options.marker,i={fill:h},j;d&&d.css({fill:c,color:c});e&&e.attr({stroke:h});if(f){if(g&&f.isMarker)for(j in i.stroke=h,g=a.convertAttribs(g),g)d=g[j],d!==t&&(i[j]=d);f.attr(i)}},positionItem:function(a){var b=this.options,
c=b.symbolPadding,b=!b.rtl,d=a._legendItemPos,e=d[0],d=d[1],f=a.checkbox;(a=a.legendGroup)&&a.element&&a.translate(b?e:this.legendWidth-e-2*c-4,d);if(f)f.x=e,f.y=d},destroyItem:function(a){var b=a.checkbox;n(["legendItem","legendLine","legendSymbol","legendGroup"],function(b){a[b]&&(a[b]=a[b].destroy())});b&&Va(a.checkbox)},destroy:function(){var a=this.group,b=this.box;if(b)this.box=b.destroy();if(a)this.group=a.destroy()},positionCheckboxes:function(a){var b=this.group.alignAttr,c,d=this.clipHeight||
this.legendHeight,e=this.titleHeight;if(b)c=b.translateY,n(this.allItems,function(f){var g=f.checkbox,h;g&&(h=c+e+g.y+(a||0)+3,F(g,{left:b.translateX+f.checkboxOffset+g.x-20+"px",top:h+"px",display:h>c-6&&h<c+d-6?"":"none"}))})},renderTitle:function(){var a=this.padding,b=this.options.title,c=0;if(b.text){if(!this.title)this.title=this.chart.renderer.label(b.text,a-3,a-4,null,null,null,null,null,"legend-title").attr({zIndex:1}).css(b.style).add(this.group);a=this.title.getBBox();c=a.height;this.offsetWidth=
a.width;this.contentGroup.attr({translateY:c})}this.titleHeight=c},setText:function(a){var b=this.options;a.legendItem.attr({text:b.labelFormat?La(b.labelFormat,a):b.labelFormatter.call(a)})},renderItem:function(a){var b=this.chart,c=b.renderer,d=this.options,e=d.layout==="horizontal",f=this.symbolWidth,g=d.symbolPadding,h=this.itemStyle,i=this.itemHiddenStyle,j=this.padding,k=e?q(d.itemDistance,20):0,l=!d.rtl,m=d.width,o=d.itemMarginBottom||0,p=this.itemMarginTop,r=this.initialItemX,A=a.legendItem,
n=a.series&&a.series.drawLegendSymbol?a.series:a,u=n.options,u=this.createCheckboxForItem&&u&&u.showCheckbox,w=d.useHTML;if(!A){a.legendGroup=c.g("legend-item").attr({zIndex:1}).add(this.scrollGroup);a.legendItem=A=c.text("",l?f+g:-g,this.baseline||0,w).css(C(a.visible?h:i)).attr({align:l?"left":"right",zIndex:2}).add(a.legendGroup);if(!this.baseline)this.fontMetrics=c.fontMetrics(h.fontSize,A),this.baseline=this.fontMetrics.f+3+p,A.attr("y",this.baseline);n.drawLegendSymbol(this,a);this.setItemEvents&&
this.setItemEvents(a,A,w,h,i);u&&this.createCheckboxForItem(a)}this.colorizeItem(a,a.visible);this.setText(a);c=A.getBBox();f=a.checkboxOffset=d.itemWidth||a.legendItemWidth||f+g+c.width+k+(u?20:0);this.itemHeight=g=y(a.legendItemHeight||c.height);if(e&&this.itemX-r+f>(m||b.chartWidth-2*j-r-d.x))this.itemX=r,this.itemY+=p+this.lastLineHeight+o,this.lastLineHeight=0;this.maxItemWidth=v(this.maxItemWidth,f);this.lastItemY=p+this.itemY+o;this.lastLineHeight=v(g,this.lastLineHeight);a._legendItemPos=
[this.itemX,this.itemY];e?this.itemX+=f:(this.itemY+=p+g+o,this.lastLineHeight=g);this.offsetWidth=m||v((e?this.itemX-r-k:f)+j,this.offsetWidth)},getAllItems:function(){var a=[];n(this.chart.series,function(b){var c=b.options;if(q(c.showInLegend,!s(c.linkedTo)?t:!1,!0))a=a.concat(b.legendItems||(c.legendType==="point"?b.data:b))});return a},adjustMargins:function(a,b){var c=this.chart,d=this.options,e=d.align.charAt(0)+d.verticalAlign.charAt(0)+d.layout.charAt(0);this.display&&!d.floating&&n([/(lth|ct|rth)/,
/(rtv|rm|rbv)/,/(rbh|cb|lbh)/,/(lbv|lm|ltv)/],function(f,g){f.test(e)&&!s(a[g])&&(c[ub[g]]=v(c[ub[g]],c.legend[(g+1)%2?"legendHeight":"legendWidth"]+[1,-1,-1,1][g]*d[g%2?"x":"y"]+q(d.margin,12)+b[g]))})},render:function(){var a=this,b=a.chart,c=b.renderer,d=a.group,e,f,g,h,i=a.box,j=a.options,k=a.padding,l=j.borderWidth,m=j.backgroundColor;a.itemX=a.initialItemX;a.itemY=a.initialItemY;a.offsetWidth=0;a.lastItemY=0;if(!d)a.group=d=c.g("legend").attr({zIndex:7}).add(),a.contentGroup=c.g().attr({zIndex:1}).add(d),
a.scrollGroup=c.g().add(a.contentGroup);a.renderTitle();e=a.getAllItems();ob(e,function(a,b){return(a.options&&a.options.legendIndex||0)-(b.options&&b.options.legendIndex||0)});j.reversed&&e.reverse();a.allItems=e;a.display=f=!!e.length;a.lastLineHeight=0;n(e,function(b){a.renderItem(b)});g=(j.width||a.offsetWidth)+k;h=a.lastItemY+a.lastLineHeight+a.titleHeight;h=a.handleOverflow(h);h+=k;if(l||m){if(i){if(g>0&&h>0)i[i.isNew?"attr":"animate"](i.crisp({width:g,height:h})),i.isNew=!1}else a.box=i=c.rect(0,
0,g,h,j.borderRadius,l||0).attr({stroke:j.borderColor,"stroke-width":l||0,fill:m||"none"}).add(d).shadow(j.shadow),i.isNew=!0;i[f?"show":"hide"]()}a.legendWidth=g;a.legendHeight=h;n(e,function(b){a.positionItem(b)});f&&d.align(x({width:g,height:h},j),!0,"spacingBox");b.isResizing||this.positionCheckboxes()},handleOverflow:function(a){var b=this,c=this.chart,d=c.renderer,e=this.options,f=e.y,f=c.spacingBox.height+(e.verticalAlign==="top"?-f:f)-this.padding,g=e.maxHeight,h,i=this.clipRect,j=e.navigation,
k=q(j.animation,!0),l=j.arrowSize||12,m=this.nav,o=this.pages,p=this.padding,r,A=this.allItems,P=function(a){i.attr({height:a});if(b.contentGroup.div)b.contentGroup.div.style.clip="rect("+p+"px,9999px,"+(p+a)+"px,0)"};e.layout==="horizontal"&&(f/=2);g&&(f=E(f,g));o.length=0;if(a>f&&j.enabled!==!1){this.clipHeight=h=v(f-20-this.titleHeight-p,0);this.currentPage=q(this.currentPage,1);this.fullHeight=a;n(A,function(a,b){var c=a._legendItemPos[1],d=y(a.legendItem.getBBox().height),e=o.length;if(!e||c-
o[e-1]>h&&(r||c)!==o[e-1])o.push(r||c),e++;b===A.length-1&&c+d-o[e-1]>h&&o.push(c);c!==r&&(r=c)});if(!i)i=b.clipRect=d.clipRect(0,p,9999,0),b.contentGroup.clip(i);P(h);if(!m)this.nav=m=d.g().attr({zIndex:1}).add(this.group),this.up=d.symbol("triangle",0,0,l,l).on("click",function(){b.scroll(-1,k)}).add(m),this.pager=d.text("",15,10).css(j.style).add(m),this.down=d.symbol("triangle-down",0,0,l,l).on("click",function(){b.scroll(1,k)}).add(m);b.scroll(0);a=f}else if(m)P(c.chartHeight),m.hide(),this.scrollGroup.attr({translateY:1}),
this.clipHeight=0;return a},scroll:function(a,b){var c=this.pages,d=c.length,e=this.currentPage+a,f=this.clipHeight,g=this.options.navigation,h=g.activeColor,g=g.inactiveColor,i=this.pager,j=this.padding;e>d&&(e=d);if(e>0)b!==t&&ab(b,this.chart),this.nav.attr({translateX:j,translateY:f+this.padding+7+this.titleHeight,visibility:"visible"}),this.up.attr({fill:e===1?g:h}).css({cursor:e===1?"default":"pointer"}),i.attr({text:e+"/"+d}),this.down.attr({x:18+this.pager.getBBox().width,fill:e===d?g:h}).css({cursor:e===
d?"default":"pointer"}),c=-c[e-1]+this.initialItemY,this.scrollGroup.animate({translateY:c}),this.currentPage=e,this.positionCheckboxes(c)}};aa=z.LegendSymbolMixin={drawRectangle:function(a,b){var c=a.options.symbolHeight||a.fontMetrics.f;b.legendSymbol=this.chart.renderer.rect(0,a.baseline-c+1,a.symbolWidth,c,a.options.symbolRadius||0).attr({zIndex:3}).add(b.legendGroup)},drawLineMarker:function(a){var b=this.options,c=b.marker,d=a.symbolWidth,e=this.chart.renderer,f=this.legendGroup,a=a.baseline-
y(a.fontMetrics.b*0.3),g;if(b.lineWidth){g={"stroke-width":b.lineWidth};if(b.dashStyle)g.dashstyle=b.dashStyle;this.legendLine=e.path(["M",0,a,"L",d,a]).attr(g).add(f)}if(c&&c.enabled!==!1)b=c.radius,this.legendSymbol=c=e.symbol(this.symbol,d/2-b,a-b,2*b,2*b,c).add(f),c.isMarker=!0}};(/Trident\/7\.0/.test(Ma)||Xa)&&U(vb.prototype,"positionItem",function(a,b){var c=this,d=function(){b._legendItemPos&&a.call(c,b)};d();setTimeout(d)});var Ca=z.Chart=function(){this.getArgs.apply(this,arguments)};z.chart=
function(a,b,c){return new Ca(a,b,c)};Ca.prototype={callbacks:[],getArgs:function(){var a=[].slice.call(arguments);if(Da(a[0])||a[0].nodeName)this.renderTo=a.shift();this.init(a[0],a[1])},init:function(a,b){var c,d=a.series;a.series=null;c=C(N,a);c.series=a.series=d;this.userOptions=a;d=c.chart;this.margin=this.splashArray("margin",d);this.spacing=this.splashArray("spacing",d);var e=d.events;this.bounds={h:{},v:{}};this.callback=b;this.isResizing=0;this.options=c;this.axes=[];this.series=[];this.hasCartesianSeries=
d.showAxes;var f=this,g;f.index=$.length;$.push(f);lb++;d.reflow!==!1&&D(f,"load",function(){f.initReflow()});if(e)for(g in e)D(f,g,e[g]);f.xAxis=[];f.yAxis=[];f.animation=qa?!1:q(d.animation,!0);f.pointCount=f.colorCounter=f.symbolCounter=0;f.firstRender()},initSeries:function(a){var b=this.options.chart;(b=K[a.type||b.type||b.defaultSeriesType])||ga(17,!0);b=new b;b.init(this,a);return b},isInsidePlot:function(a,b,c){var d=c?b:a,a=c?a:b;return d>=0&&d<=this.plotWidth&&a>=0&&a<=this.plotHeight},
redraw:function(a){var b=this.axes,c=this.series,d=this.pointer,e=this.legend,f=this.isDirtyLegend,g,h,i=this.hasCartesianSeries,j=this.isDirtyBox,k=c.length,l=k,m=this.renderer,o=m.isHidden(),p=[];ab(a,this);o&&this.cloneRenderTo();for(this.layOutTitles();l--;)if(a=c[l],a.options.stacking&&(g=!0,a.isDirty)){h=!0;break}if(h)for(l=k;l--;)if(a=c[l],a.options.stacking)a.isDirty=!0;n(c,function(a){a.isDirty&&a.options.legendType==="point"&&(a.updateTotals&&a.updateTotals(),f=!0)});if(f&&e.options.enabled)e.render(),
this.isDirtyLegend=!1;g&&this.getStacks();if(i&&!this.isResizing)this.maxTicks=null,n(b,function(a){a.setScale()});this.getMargins();i&&(n(b,function(a){a.isDirty&&(j=!0)}),n(b,function(a){var b=a.min+","+a.max;if(a.extKey!==b)a.extKey=b,p.push(function(){M(a,"afterSetExtremes",x(a.eventArgs,a.getExtremes()));delete a.eventArgs});(j||g)&&a.redraw()}));j&&this.drawChartBox();n(c,function(a){a.isDirty&&a.visible&&(!a.isCartesian||a.xAxis)&&a.redraw()});d&&d.reset(!0);m.draw();M(this,"redraw");o&&this.cloneRenderTo(!0);
n(p,function(a){a.call()})},get:function(a){var b=this.axes,c=this.series,d,e;for(d=0;d<b.length;d++)if(b[d].options.id===a)return b[d];for(d=0;d<c.length;d++)if(c[d].options.id===a)return c[d];for(d=0;d<c.length;d++){e=c[d].points||[];for(b=0;b<e.length;b++)if(e[b].id===a)return e[b]}return null},getAxes:function(){var a=this,b=this.options,c=b.xAxis=va(b.xAxis||{}),b=b.yAxis=va(b.yAxis||{});n(c,function(a,b){a.index=b;a.isX=!0});n(b,function(a,b){a.index=b});c=c.concat(b);n(c,function(b){new I(a,
b)})},getSelectedPoints:function(){var a=[];n(this.series,function(b){a=a.concat(Sa(b.points||[],function(a){return a.selected}))});return a},getSelectedSeries:function(){return Sa(this.series,function(a){return a.selected})},setTitle:function(a,b,c){var g;var d=this,e=d.options,f;f=e.title=C(e.title,a);g=e.subtitle=C(e.subtitle,b),e=g;n([["title",a,f],["subtitle",b,e]],function(a){var b=a[0],c=d[b],e=a[1],a=a[2];c&&e&&(d[b]=c=c.destroy());a&&a.text&&!c&&(d[b]=d.renderer.text(a.text,0,0,a.useHTML).attr({align:a.align,
"class":"highcharts-"+b,zIndex:a.zIndex||4}).css(a.style).add())});d.layOutTitles(c)},layOutTitles:function(a){var b=0,c=this.title,d=this.subtitle,e=this.options,f=e.title,e=e.subtitle,g=this.renderer,h=this.spacingBox.width-44;if(c&&(c.css({width:(f.width||h)+"px"}).align(x({y:g.fontMetrics(f.style.fontSize,c).b-3},f),!1,"spacingBox"),!f.floating&&!f.verticalAlign))b=c.getBBox().height;d&&(d.css({width:(e.width||h)+"px"}).align(x({y:b+(f.margin-13)+g.fontMetrics(e.style.fontSize,c).b},e),!1,"spacingBox"),
!e.floating&&!e.verticalAlign&&(b=Fa(b+d.getBBox().height)));c=this.titleOffset!==b;this.titleOffset=b;if(!this.isDirtyBox&&c)this.isDirtyBox=c,this.hasRendered&&q(a,!0)&&this.isDirtyBox&&this.redraw()},getChartSize:function(){var a=this.options.chart,b=a.width,a=a.height,c=this.renderToClone||this.renderTo;if(!s(b))this.containerWidth=xa(c,"width");if(!s(a))this.containerHeight=xa(c,"height");this.chartWidth=v(0,b||this.containerWidth||600);this.chartHeight=v(0,q(a,this.containerHeight>19?this.containerHeight:
400))},cloneRenderTo:function(a){var b=this.renderToClone,c=this.container;a?b&&(this.renderTo.appendChild(c),Va(b),delete this.renderToClone):(c&&c.parentNode===this.renderTo&&this.renderTo.removeChild(c),this.renderToClone=b=this.renderTo.cloneNode(0),F(b,{position:"absolute",top:"-9999px",display:"block"}),b.style.setProperty&&b.style.setProperty("display","block","important"),B.body.appendChild(b),c&&b.appendChild(c))},getContainer:function(){var a,b=this.options,c=b.chart,d,e;a=this.renderTo;
var f="highcharts-"+Jb++;if(!a)this.renderTo=a=c.renderTo;if(Da(a))this.renderTo=a=B.getElementById(a);a||ga(13,!0);d=G(X(a,"data-highcharts-chart"));!isNaN(d)&&$[d]&&$[d].hasRendered&&$[d].destroy();X(a,"data-highcharts-chart",this.index);a.innerHTML="";!c.skipClone&&!a.offsetWidth&&this.cloneRenderTo();this.getChartSize();d=this.chartWidth;e=this.chartHeight;this.container=a=ea(Wa,{className:"highcharts-container"+(c.className?" "+c.className:""),id:f},x({position:"relative",overflow:"hidden",width:d+
"px",height:e+"px",textAlign:"left",lineHeight:"normal",zIndex:0,"-webkit-tap-highlight-color":"rgba(0,0,0,0)"},c.style),this.renderToClone||a);this._cursor=a.style.cursor;this.renderer=new (z[c.renderer]||Ya)(a,d,e,c.style,c.forExport,b.exporting&&b.exporting.allowHTML);qa&&this.renderer.create(this,a,d,e);this.renderer.chartIndex=this.index},getMargins:function(a){var b=this.spacing,c=this.margin,d=this.titleOffset;this.resetMargins();if(d&&!s(c[0]))this.plotTop=v(this.plotTop,d+this.options.title.margin+
b[0]);this.legend.adjustMargins(c,b);this.extraBottomMargin&&(this.marginBottom+=this.extraBottomMargin);this.extraTopMargin&&(this.plotTop+=this.extraTopMargin);a||this.getAxisMargins()},getAxisMargins:function(){var a=this,b=a.axisOffset=[0,0,0,0],c=a.margin;a.hasCartesianSeries&&n(a.axes,function(a){a.visible&&a.getOffset()});n(ub,function(d,e){s(c[e])||(a[d]+=b[e])});a.setChartSize()},reflow:function(a){var b=this,c=b.options.chart,d=b.renderTo,e=c.width||xa(d,"width"),f=c.height||xa(d,"height"),
c=a?a.target:J;if(!b.hasUserSize&&!b.isPrinting&&e&&f&&(c===J||c===B)){if(e!==b.containerWidth||f!==b.containerHeight)clearTimeout(b.reflowTimeout),b.reflowTimeout=$a(function(){if(b.container)b.setSize(e,f,!1),b.hasUserSize=null},a?100:0);b.containerWidth=e;b.containerHeight=f}},initReflow:function(){var a=this,b=function(b){a.reflow(b)};D(J,"resize",b);D(a,"destroy",function(){T(J,"resize",b)})},setSize:function(a,b,c){var d=this,e,f,g=d.renderer;d.isResizing+=1;ab(c,d);d.oldChartHeight=d.chartHeight;
d.oldChartWidth=d.chartWidth;if(s(a))d.chartWidth=e=v(0,y(a)),d.hasUserSize=!!e;if(s(b))d.chartHeight=f=v(0,y(b));a=g.globalAnimation;(a?eb:F)(d.container,{width:e+"px",height:f+"px"},a);d.setChartSize(!0);g.setSize(e,f,c);d.maxTicks=null;n(d.axes,function(a){a.isDirty=!0;a.setScale()});n(d.series,function(a){a.isDirty=!0});d.isDirtyLegend=!0;d.isDirtyBox=!0;d.layOutTitles();d.getMargins();d.redraw(c);d.oldChartHeight=null;M(d,"resize");$a(function(){d&&M(d,"endResize",null,function(){d.isResizing-=
1})},hb(a).duration)},setChartSize:function(a){var b=this.inverted,c=this.renderer,d=this.chartWidth,e=this.chartHeight,f=this.options.chart,g=this.spacing,h=this.clipOffset,i,j,k,l;this.plotLeft=i=y(this.plotLeft);this.plotTop=j=y(this.plotTop);this.plotWidth=k=v(0,y(d-i-this.marginRight));this.plotHeight=l=v(0,y(e-j-this.marginBottom));this.plotSizeX=b?l:k;this.plotSizeY=b?k:l;this.plotBorderWidth=f.plotBorderWidth||0;this.spacingBox=c.spacingBox={x:g[3],y:g[0],width:d-g[3]-g[1],height:e-g[0]-g[2]};
this.plotBox=c.plotBox={x:i,y:j,width:k,height:l};d=2*V(this.plotBorderWidth/2);b=Fa(v(d,h[3])/2);c=Fa(v(d,h[0])/2);this.clipBox={x:b,y:c,width:V(this.plotSizeX-v(d,h[1])/2-b),height:v(0,V(this.plotSizeY-v(d,h[2])/2-c))};a||n(this.axes,function(a){a.setAxisSize();a.setAxisTranslation()})},resetMargins:function(){var a=this;n(ub,function(b,c){a[b]=q(a.margin[c],a.spacing[c])});a.axisOffset=[0,0,0,0];a.clipOffset=[0,0,0,0]},drawChartBox:function(){var a=this.options.chart,b=this.renderer,c=this.chartWidth,
d=this.chartHeight,e=this.chartBackground,f=this.plotBackground,g=this.plotBorder,h=this.plotBGImage,i=a.borderWidth||0,j=a.backgroundColor,k=a.plotBackgroundColor,l=a.plotBackgroundImage,m=a.plotBorderWidth||0,o,p=this.plotLeft,r=this.plotTop,A=this.plotWidth,q=this.plotHeight,n=this.plotBox,w=this.clipRect,O=this.clipBox;o=i+(a.shadow?8:0);if(i||j)if(e)e.animate(e.crisp({width:c-o,height:d-o}));else{e={fill:j||"none"};if(i)e.stroke=a.borderColor,e["stroke-width"]=i;this.chartBackground=b.rect(o/
2,o/2,c-o,d-o,a.borderRadius,i).attr(e).addClass("highcharts-background").add().shadow(a.shadow)}if(k)f?f.animate(n):this.plotBackground=b.rect(p,r,A,q,0).attr({fill:k}).add().shadow(a.plotShadow);if(l)h?h.animate(n):this.plotBGImage=b.image(l,p,r,A,q).add();w?w.animate({width:O.width,height:O.height}):this.clipRect=b.clipRect(O);if(m)g?(g.strokeWidth=-m,g.animate(g.crisp({x:p,y:r,width:A,height:q}))):this.plotBorder=b.rect(p,r,A,q,0,-m).attr({stroke:a.plotBorderColor,"stroke-width":m,fill:"none",
zIndex:1}).add();this.isDirtyBox=!1},propFromSeries:function(){var a=this,b=a.options.chart,c,d=a.options.series,e,f;n(["inverted","angular","polar"],function(g){c=K[b.type||b.defaultSeriesType];f=a[g]||b[g]||c&&c.prototype[g];for(e=d&&d.length;!f&&e--;)(c=K[d[e].type])&&c.prototype[g]&&(f=!0);a[g]=f})},linkSeries:function(){var a=this,b=a.series;n(b,function(a){a.linkedSeries.length=0});n(b,function(b){var d=b.options.linkedTo;if(Da(d)&&(d=d===":previous"?a.series[b.index-1]:a.get(d)))d.linkedSeries.push(b),
b.linkedParent=d,b.visible=q(b.options.visible,d.options.visible,b.visible)})},renderSeries:function(){n(this.series,function(a){a.translate();a.render()})},renderLabels:function(){var a=this,b=a.options.labels;b.items&&n(b.items,function(c){var d=x(b.style,c.style),e=G(d.left)+a.plotLeft,f=G(d.top)+a.plotTop+12;delete d.left;delete d.top;a.renderer.text(c.html,e,f).attr({zIndex:2}).css(d).add()})},render:function(){var a=this.axes,b=this.renderer,c=this.options,d,e,f,g;this.setTitle();this.legend=
new vb(this,c.legend);this.getStacks&&this.getStacks();this.getMargins(!0);this.setChartSize();d=this.plotWidth;e=this.plotHeight-=21;n(a,function(a){a.setScale()});this.getAxisMargins();f=d/this.plotWidth>1.1;g=e/this.plotHeight>1.05;if(f||g)this.maxTicks=null,n(a,function(a){(a.horiz&&f||!a.horiz&&g)&&a.setTickInterval(!0)}),this.getMargins();this.drawChartBox();this.hasCartesianSeries&&n(a,function(a){a.visible&&a.render()});if(!this.seriesGroup)this.seriesGroup=b.g("series-group").attr({zIndex:3}).add();
this.renderSeries();this.renderLabels();this.showCredits(c.credits);this.hasRendered=!0},showCredits:function(a){if(a.enabled&&!this.credits)this.credits=this.renderer.text(a.text,0,0).on("click",function(){if(a.href)J.location.href=a.href}).attr({align:a.position.align,zIndex:8}).css(a.style).add().align(a.position)},destroy:function(){var a=this,b=a.axes,c=a.series,d=a.container,e,f=d&&d.parentNode;M(a,"destroy");$[a.index]=t;lb--;a.renderTo.removeAttribute("data-highcharts-chart");T(a);for(e=b.length;e--;)b[e]=
b[e].destroy();for(e=c.length;e--;)c[e]=c[e].destroy();n("title,subtitle,chartBackground,plotBackground,plotBGImage,plotBorder,seriesGroup,clipRect,credits,pointer,scroller,rangeSelector,legend,resetZoomButton,tooltip,renderer".split(","),function(b){var c=a[b];c&&c.destroy&&(a[b]=c.destroy())});if(d)d.innerHTML="",T(d),f&&Va(d);for(e in a)delete a[e]},isReadyToRender:function(){var a=this;return!ja&&J==J.top&&B.readyState!=="complete"||qa&&!J.canvg?(qa?Wb.push(function(){a.firstRender()},a.options.global.canvasToolsURL):
B.attachEvent("onreadystatechange",function(){B.detachEvent("onreadystatechange",a.firstRender);B.readyState==="complete"&&a.firstRender()}),!1):!0},firstRender:function(){var a=this,b=a.options;if(a.isReadyToRender()){a.getContainer();M(a,"init");a.resetMargins();a.setChartSize();a.propFromSeries();a.getAxes();n(b.series||[],function(b){a.initSeries(b)});a.linkSeries();M(a,"beforeRender");if(z.Pointer)a.pointer=new Za(a,b);a.render();a.renderer.draw();if(!a.renderer.imgCount&&a.onload)a.onload();
a.cloneRenderTo(!0)}},onload:function(){var a=this;n([this.callback].concat(this.callbacks),function(b){b&&a.index!==void 0&&b.apply(a,[a])});M(a,"load");this.onload=null},splashArray:function(a,b){var c=b[a],c=da(c)?c:[c,c,c,c];return[q(b[a+"Top"],c[0]),q(b[a+"Right"],c[1]),q(b[a+"Bottom"],c[2]),q(b[a+"Left"],c[3])]}};var bc=z.CenteredSeriesMixin={getCenter:function(){var a=this.options,b=this.chart,c=2*(a.slicedOffset||0),d=b.plotWidth-2*c,b=b.plotHeight-2*c,e=a.center,e=[q(e[0],"50%"),q(e[1],"50%"),
a.size||"100%",a.innerSize||0],f=E(d,b),g,h;for(g=0;g<4;++g)h=e[g],a=g<2||g===2&&/%$/.test(h),e[g]=(/%$/.test(h)?[d,b,f,e[2]][g]*parseFloat(h)/100:parseFloat(h))+(a?c:0);e[3]>e[2]&&(e[3]=e[2]);return e}},Ha=function(){};Ha.prototype={init:function(a,b,c){this.series=a;this.color=a.color;this.applyOptions(b,c);this.pointAttr={};if(a.options.colorByPoint&&(b=a.options.colors||a.chart.options.colors,this.color=this.color||b[a.colorCounter++],a.colorCounter===b.length))a.colorCounter=0;a.chart.pointCount++;
return this},applyOptions:function(a,b){var c=this.series,d=c.options.pointValKey||c.pointValKey,a=Ha.prototype.optionsToObject.call(this,a);x(this,a);this.options=this.options?x(this.options,a):a;if(d)this.y=this[d];this.isNull=this.y===null;if(this.x===void 0&&c)this.x=b===void 0?c.autoIncrement():b;return this},optionsToObject:function(a){var b={},c=this.series,d=c.options.keys,e=d||c.pointArrayMap||["y"],f=e.length,g=0,h=0;if(typeof a==="number"||a===null)b[e[0]]=a;else if(Ja(a)){if(!d&&a.length>
f){c=typeof a[0];if(c==="string")b.name=a[0];else if(c==="number")b.x=a[0];g++}for(;h<f;){if(!d||a[g]!==void 0)b[e[h]]=a[g];g++;h++}}else if(typeof a==="object"){b=a;if(a.dataLabels)c._hasPointLabels=!0;if(a.marker)c._hasPointMarkers=!0}return b},destroy:function(){var a=this.series.chart,b=a.hoverPoints,c;a.pointCount--;if(b&&(this.setState(),Aa(b,this),!b.length))a.hoverPoints=null;if(this===a.hoverPoint)this.onMouseOut();if(this.graphic||this.dataLabel)T(this),this.destroyElements();this.legendItem&&
a.legend.destroyItem(this);for(c in this)this[c]=null},destroyElements:function(){for(var a=["graphic","dataLabel","dataLabelUpper","connector","shadowGroup"],b,c=6;c--;)b=a[c],this[b]&&(this[b]=this[b].destroy())},getLabelConfig:function(){return{x:this.category,y:this.y,color:this.color,key:this.name||this.category,series:this.series,point:this,percentage:this.percentage,total:this.total||this.stackTotal}},tooltipFormatter:function(a){var b=this.series,c=b.tooltipOptions,d=q(c.valueDecimals,""),
e=c.valuePrefix||"",f=c.valueSuffix||"";n(b.pointArrayMap||["y"],function(b){b="{point."+b;if(e||f)a=a.replace(b+"}",e+b+"}"+f);a=a.replace(b+"}",b+":,."+d+"f}")});return La(a,{point:this,series:this.series})},firePointEvent:function(a,b,c){var d=this,e=this.series.options;(e.point.events[a]||d.options&&d.options.events&&d.options.events[a])&&this.importEvents();a==="click"&&e.allowPointSelect&&(c=function(a){d.select&&d.select(null,a.ctrlKey||a.metaKey||a.shiftKey)});M(this,a,b,c)},visible:!0};var Q=
z.Series=function(){};Q.prototype={isCartesian:!0,type:"line",pointClass:Ha,sorted:!0,requireSorting:!0,pointAttrToOptions:{stroke:"lineColor","stroke-width":"lineWidth",fill:"fillColor",r:"radius"},directTouch:!1,axisTypes:["xAxis","yAxis"],colorCounter:0,parallelArrays:["x","y"],init:function(a,b){var c=this,d,e,f=a.series,g=function(a,b){return q(a.options.index,a._i)-q(b.options.index,b._i)};c.chart=a;c.options=b=c.setOptions(b);c.linkedSeries=[];c.bindAxes();x(c,{name:b.name,state:"",pointAttr:{},
visible:b.visible!==!1,selected:b.selected===!0});if(qa)b.animation=!1;e=b.events;for(d in e)D(c,d,e[d]);if(e&&e.click||b.point&&b.point.events&&b.point.events.click||b.allowPointSelect)a.runTrackerClick=!0;c.getColor();c.getSymbol();n(c.parallelArrays,function(a){c[a+"Data"]=[]});c.setData(b.data,!1);if(c.isCartesian)a.hasCartesianSeries=!0;f.push(c);c._i=f.length-1;ob(f,g);this.yAxis&&ob(this.yAxis.series,g);n(f,function(a,b){a.index=b;a.name=a.name||"Series "+(b+1)})},bindAxes:function(){var a=
this,b=a.options,c=a.chart,d;n(a.axisTypes||[],function(e){n(c[e],function(c){d=c.options;if(b[e]===d.index||b[e]!==t&&b[e]===d.id||b[e]===t&&d.index===0)c.series.push(a),a[e]=c,c.isDirty=!0});!a[e]&&a.optionalAxis!==e&&ga(18,!0)})},updateParallelArrays:function(a,b){var c=a.series,d=arguments;n(c.parallelArrays,typeof b==="number"?function(d){var f=d==="y"&&c.toYData?c.toYData(a):a[d];c[d+"Data"][b]=f}:function(a){Array.prototype[b].apply(c[a+"Data"],Array.prototype.slice.call(d,2))})},autoIncrement:function(){var a=
this.options,b=this.xIncrement,c,d=a.pointIntervalUnit,b=q(b,a.pointStart,0);this.pointInterval=c=q(this.pointInterval,a.pointInterval,1);d&&(a=new fa(b),d==="day"?a=+a[rb](a[bb]()+c):d==="month"?a=+a[Fb](a[ib]()+c):d==="year"&&(a=+a[Gb](a[jb]()+c)),c=a-b);this.xIncrement=b+c;return b},setOptions:function(a){var b=this.chart,c=b.options.plotOptions,b=b.userOptions||{},d=b.plotOptions||{},e=c[this.type];this.userOptions=a;c=C(e,c.series,a);this.tooltipOptions=C(N.tooltip,N.plotOptions[this.type].tooltip,
b.tooltip,d.series&&d.series.tooltip,d[this.type]&&d[this.type].tooltip,a.tooltip);e.marker===null&&delete c.marker;this.zoneAxis=c.zoneAxis;a=this.zones=(c.zones||[]).slice();if((c.negativeColor||c.negativeFillColor)&&!c.zones)a.push({value:c[this.zoneAxis+"Threshold"]||c.threshold||0,color:c.negativeColor,fillColor:c.negativeFillColor});a.length&&s(a[a.length-1].value)&&a.push({color:this.color,fillColor:this.fillColor});return c},getCyclic:function(a,b,c){var d=this.userOptions,e="_"+a+"Index",
f=a+"Counter";b||(s(d[e])?b=d[e]:(d[e]=b=this.chart[f]%c.length,this.chart[f]+=1),b=c[b]);this[a]=b},getColor:function(){this.options.colorByPoint?this.options.color=null:this.getCyclic("color",this.options.color||W[this.type].color,this.chart.options.colors)},getSymbol:function(){var a=this.options.marker;this.getCyclic("symbol",a.symbol,this.chart.options.symbols);if(/^url/.test(this.symbol))a.radius=0},drawLegendSymbol:aa.drawLineMarker,setData:function(a,b,c,d){var e=this,f=e.points,g=f&&f.length||
0,h,i=e.options,j=e.chart,k=null,l=e.xAxis,m=l&&!!l.categories,o=i.turboThreshold,p=this.xData,r=this.yData,A=(h=e.pointArrayMap)&&h.length,a=a||[];h=a.length;b=q(b,!0);if(d!==!1&&h&&g===h&&!e.cropped&&!e.hasGroupedData&&e.visible)n(a,function(a,b){f[b].update&&a!==i.data[b]&&f[b].update(a,!1,null,!1)});else{e.xIncrement=null;e.colorCounter=0;n(this.parallelArrays,function(a){e[a+"Data"].length=0});if(o&&h>o){for(c=0;k===null&&c<h;)k=a[c],c++;if(ua(k)){m=q(i.pointStart,0);k=q(i.pointInterval,1);for(c=
0;c<h;c++)p[c]=m,r[c]=a[c],m+=k;e.xIncrement=m}else if(Ja(k))if(A)for(c=0;c<h;c++)k=a[c],p[c]=k[0],r[c]=k.slice(1,A+1);else for(c=0;c<h;c++)k=a[c],p[c]=k[0],r[c]=k[1];else ga(12)}else for(c=0;c<h;c++)if(a[c]!==t&&(k={series:e},e.pointClass.prototype.applyOptions.apply(k,[a[c]]),e.updateParallelArrays(k,c),m&&s(k.name)))l.names[k.x]=k.name;Da(r[0])&&ga(14,!0);e.data=[];e.options.data=e.userOptions.data=a;for(c=g;c--;)f[c]&&f[c].destroy&&f[c].destroy();if(l)l.minRange=l.userMinRange;e.isDirty=e.isDirtyData=
j.isDirtyBox=!0;c=!1}i.legendType==="point"&&(this.processData(),this.generatePoints());b&&j.redraw(c)},processData:function(a){var b=this.xData,c=this.yData,d=b.length,e;e=0;var f,g,h=this.xAxis,i,j=this.options;i=j.cropThreshold;var k=this.getExtremesFromAll||j.getExtremesFromAll,l=this.isCartesian,j=h&&h.val2lin,m=h&&h.isLog,o,p;if(l&&!this.isDirty&&!h.isDirty&&!this.yAxis.isDirty&&!a)return!1;if(h)a=h.getExtremes(),o=a.min,p=a.max;if(l&&this.sorted&&!k&&(!i||d>i||this.forceCrop))if(b[d-1]<o||
b[0]>p)b=[],c=[];else if(b[0]<o||b[d-1]>p)e=this.cropData(this.xData,this.yData,o,p),b=e.xData,c=e.yData,e=e.start,f=!0;for(i=b.length||1;--i;)d=m?j(b[i])-j(b[i-1]):b[i]-b[i-1],d>0&&(g===t||d<g)?g=d:d<0&&this.requireSorting&&ga(15);this.cropped=f;this.cropStart=e;this.processedXData=b;this.processedYData=c;this.closestPointRange=g},cropData:function(a,b,c,d){var e=a.length,f=0,g=e,h=q(this.cropShoulder,1),i;for(i=0;i<e;i++)if(a[i]>=c){f=v(0,i-h);break}for(c=i;c<e;c++)if(a[c]>d){g=c+h;break}return{xData:a.slice(f,
g),yData:b.slice(f,g),start:f,end:g}},generatePoints:function(){var a=this.options.data,b=this.data,c,d=this.processedXData,e=this.processedYData,f=this.pointClass,g=d.length,h=this.cropStart||0,i,j=this.hasGroupedData,k,l=[],m;if(!b&&!j)b=[],b.length=a.length,b=this.data=b;for(m=0;m<g;m++)i=h+m,j?(l[m]=(new f).init(this,[d[m]].concat(va(e[m]))),l[m].dataGroup=this.groupMap[m]):(b[i]?k=b[i]:a[i]!==t&&(b[i]=k=(new f).init(this,a[i],d[m])),l[m]=k),l[m].index=i;if(b&&(g!==(c=b.length)||j))for(m=0;m<
c;m++)if(m===h&&!j&&(m+=g),b[m])b[m].destroyElements(),b[m].plotX=t;this.data=b;this.points=l},getExtremes:function(a){var b=this.yAxis,c=this.processedXData,d,e=[],f=0;d=this.xAxis.getExtremes();var g=d.min,h=d.max,i,j,k,l,a=a||this.stackedYData||this.processedYData;d=a.length;for(l=0;l<d;l++)if(j=c[l],k=a[l],i=k!==null&&k!==t&&(!b.isLog||k.length||k>0),j=this.getExtremesFromAll||this.options.getExtremesFromAll||this.cropped||(c[l+1]||j)>=g&&(c[l-1]||j)<=h,i&&j)if(i=k.length)for(;i--;)k[i]!==null&&
(e[f++]=k[i]);else e[f++]=k;this.dataMin=Oa(e);this.dataMax=Ea(e)},translate:function(){this.processedXData||this.processData();this.generatePoints();for(var a=this.options,b=a.stacking,c=this.xAxis,d=c.categories,e=this.yAxis,f=this.points,g=f.length,h=!!this.modifyValue,i=a.pointPlacement,j=i==="between"||ua(i),k=a.threshold,l=a.startFromThreshold?k:0,m,o,p,r,A=Number.MAX_VALUE,a=0;a<g;a++){var n=f[a],u=n.x,w=n.y;o=n.low;var O=b&&e.stacks[(this.negStacks&&w<(l?0:k)?"-":"")+this.stackKey];if(e.isLog&&
w!==null&&w<=0)n.y=w=null,ga(10);n.plotX=m=E(v(-1E5,c.translate(u,0,0,0,1,i,this.type==="flags")),1E5);if(b&&this.visible&&!n.isNull&&O&&O[u])r=this.getStackIndicator(r,u,this.index),O=O[u],w=O.points[r.key],o=w[0],w=w[1],o===l&&(o=q(k,e.min)),e.isLog&&o<=0&&(o=null),n.total=n.stackTotal=O.total,n.percentage=O.total&&n.y/O.total*100,n.stackY=w,O.setOffset(this.pointXOffset||0,this.barW||0);n.yBottom=s(o)?e.translate(o,0,1,0,1):null;h&&(w=this.modifyValue(w,n));n.plotY=o=typeof w==="number"&&w!==Infinity?
E(v(-1E5,e.translate(w,0,1,0,1)),1E5):t;n.isInside=o!==t&&o>=0&&o<=e.len&&m>=0&&m<=c.len;n.clientX=j?c.translate(u,0,0,0,1):m;n.negative=n.y<(k||0);n.category=d&&d[n.x]!==t?d[n.x]:n.x;n.isNull||(p!==void 0&&(A=E(A,S(m-p))),p=m)}this.closestPointRangePx=A},getValidPoints:function(a,b){var c=this.chart;return Sa(a||this.points||[],function(a){return b&&!c.isInsidePlot(a.plotX,a.plotY,c.inverted)?!1:!a.isNull})},setClip:function(a){var b=this.chart,c=this.options,d=b.renderer,e=b.inverted,f=this.clipBox,
g=f||b.clipBox,h=this.sharedClipKey||["_sharedClip",a&&a.duration,a&&a.easing,g.height,c.xAxis,c.yAxis].join(","),i=b[h],j=b[h+"m"];if(!i){if(a)g.width=0,b[h+"m"]=j=d.clipRect(-99,e?-b.plotLeft:-b.plotTop,99,e?b.chartWidth:b.chartHeight);b[h]=i=d.clipRect(g)}a&&(i.count+=1);if(c.clip!==!1)this.group.clip(a||f?i:b.clipRect),this.markerGroup.clip(j),this.sharedClipKey=h;a||(i.count-=1,i.count<=0&&h&&b[h]&&(f||(b[h]=b[h].destroy()),b[h+"m"]&&(b[h+"m"]=b[h+"m"].destroy())))},animate:function(a){var b=
this.chart,c=this.options.animation,d;if(c&&!da(c))c=W[this.type].animation;a?this.setClip(c):(d=this.sharedClipKey,(a=b[d])&&a.animate({width:b.plotSizeX},c),b[d+"m"]&&b[d+"m"].animate({width:b.plotSizeX+99},c),this.animate=null)},afterAnimate:function(){this.setClip();M(this,"afterAnimate")},drawPoints:function(){var a,b=this.points,c=this.chart,d,e,f,g,h,i,j,k,l=this.options.marker,m=this.pointAttr[""],o,p,r,A=this.markerGroup,n=q(l.enabled,this.xAxis.isRadial,this.closestPointRangePx>2*l.radius);
if(l.enabled!==!1||this._hasPointMarkers)for(f=b.length;f--;)if(g=b[f],d=V(g.plotX),e=g.plotY,k=g.graphic,o=g.marker||{},p=!!g.marker,a=n&&o.enabled===t||o.enabled,r=g.isInside,a&&e!==t&&!isNaN(e)&&g.y!==null)if(a=g.pointAttr[g.selected?"select":""]||m,h=a.r,i=q(o.symbol,this.symbol),j=i.indexOf("url")===0,k)k[r?"show":"hide"](!0).attr(a).animate(x({x:d-h,y:e-h},k.symbolName?{width:2*h,height:2*h}:{}));else{if(r&&(h>0||j))g.graphic=c.renderer.symbol(i,d-h,e-h,2*h,2*h,p?o:l).attr(a).add(A)}else if(k)g.graphic=
k.destroy()},convertAttribs:function(a,b,c,d){var e=this.pointAttrToOptions,f,g,h={},a=a||{},b=b||{},c=c||{},d=d||{};for(f in e)g=e[f],h[f]=q(a[g],b[f],c[f],d[f]);return h},getAttribs:function(){var a=this,b=a.options,c=W[a.type].marker?b.marker:b,d=c.states,e=d.hover,f,g=a.color,h=a.options.negativeColor;f={stroke:g,fill:g};var i=a.points||[],j,k,l=[],m=a.pointAttrToOptions;j=a.hasPointSpecificOptions;var o=c.lineColor,p=c.fillColor;k=b.turboThreshold;var r=a.zones,A=a.zoneAxis||"y",P;b.marker?(e.radius=
e.radius||c.radius+e.radiusPlus,e.lineWidth=e.lineWidth||c.lineWidth+e.lineWidthPlus):(e.color=e.color||wa(e.color||g).brighten(e.brightness).get(),e.negativeColor=e.negativeColor||wa(e.negativeColor||h).brighten(e.brightness).get());l[""]=a.convertAttribs(c,f);n(["hover","select"],function(b){l[b]=a.convertAttribs(d[b],l[""])});a.pointAttr=l;g=i.length;if(!k||g<k||j)for(;g--;){k=i[g];if((c=k.options&&k.options.marker||k.options)&&c.enabled===!1)c.radius=0;if(r.length){j=0;for(f=r[j];k[A]>=f.value;)f=
r[++j];k.color=k.fillColor=q(f.color,a.color)}j=b.colorByPoint||k.color;if(k.options)for(P in m)s(c[m[P]])&&(j=!0);if(j){c=c||{};j=[];d=c.states||{};f=d.hover=d.hover||{};if(!b.marker||k.negative&&!f.fillColor&&!e.fillColor)f[a.pointAttrToOptions.fill]=f.color||!k.options.color&&e[k.negative&&h?"negativeColor":"color"]||wa(k.color).brighten(f.brightness||e.brightness).get();f={color:k.color};if(!p)f.fillColor=k.color;if(!o)f.lineColor=k.color;c.hasOwnProperty("color")&&!c.color&&delete c.color;j[""]=
a.convertAttribs(x(f,c),l[""]);j.hover=a.convertAttribs(d.hover,l.hover,j[""]);j.select=a.convertAttribs(d.select,l.select,j[""])}else j=l;k.pointAttr=j}},destroy:function(){var a=this,b=a.chart,c=/AppleWebKit\/533/.test(Ma),d,e=a.data||[],f,g,h;M(a,"destroy");T(a);n(a.axisTypes||[],function(b){if(h=a[b])Aa(h.series,a),h.isDirty=h.forceRedraw=!0});a.legendItem&&a.chart.legend.destroyItem(a);for(d=e.length;d--;)(f=e[d])&&f.destroy&&f.destroy();a.points=null;clearTimeout(a.animationTimeout);for(g in a)a[g]instanceof
Z&&!a[g].survive&&(d=c&&g==="group"?"hide":"destroy",a[g][d]());if(b.hoverSeries===a)b.hoverSeries=null;Aa(b.series,a);for(g in a)delete a[g]},getGraphPath:function(a,b,c){var d=this,e=d.options,f=e.step,g,h=[],i,a=a||d.points;(g=a.reversed)&&a.reverse();(f={right:1,center:2}[f]||f&&3)&&g&&(f=4-f);e.connectNulls&&!b&&!c&&(a=this.getValidPoints(a));n(a,function(g,k){var l=g.plotX,m=g.plotY,o=a[k-1];if((g.leftCliff||o&&o.rightCliff)&&!c)i=!0;g.isNull&&!s(b)&&k>0?i=!e.connectNulls:g.isNull&&!b?i=!0:
(k===0||i?o=["M",g.plotX,g.plotY]:d.getPointSpline?o=d.getPointSpline(a,g,k):f?(o=f===1?["L",o.plotX,m]:f===2?["L",(o.plotX+l)/2,o.plotY,"L",(o.plotX+l)/2,m]:["L",l,o.plotY],o.push("L",l,m)):o=["L",l,m],h.push.apply(h,o),i=!1)});return d.graphPath=h},drawGraph:function(){var a=this,b=this.options,c=[["graph",b.lineColor||this.color,b.dashStyle]],d=b.lineWidth,e=b.linecap!=="square",f=(this.gappedPath||this.getGraphPath).call(this),g=this.fillGraph&&this.color||"none";n(this.zones,function(d,e){c.push(["zoneGraph"+
e,d.color||a.color,d.dashStyle||b.dashStyle])});n(c,function(c,i){var j=c[0],k=a[j];if(k)k.animate({d:f});else if((d||g)&&f.length)k={stroke:c[1],"stroke-width":d,fill:g,zIndex:1},c[2]?k.dashstyle=c[2]:e&&(k["stroke-linecap"]=k["stroke-linejoin"]="round"),a[j]=a.chart.renderer.path(f).attr(k).add(a.group).shadow(i<2&&b.shadow)})},applyZones:function(){var a=this,b=this.chart,c=b.renderer,d=this.zones,e,f,g=this.clips||[],h,i=this.graph,j=this.area,k=v(b.chartWidth,b.chartHeight),l=this[(this.zoneAxis||
"y")+"Axis"],m,o=l.reversed,p=b.inverted,r=l.horiz,A,P,u,w=!1;if(d.length&&(i||j)&&l.min!==t)i&&i.hide(),j&&j.hide(),m=l.getExtremes(),n(d,function(d,n){e=o?r?b.plotWidth:0:r?0:l.toPixels(m.min);e=E(v(q(f,e),0),k);f=E(v(y(l.toPixels(q(d.value,m.max),!0)),0),k);w&&(e=f=l.toPixels(m.max));A=Math.abs(e-f);P=E(e,f);u=v(e,f);if(l.isXAxis){if(h={x:p?u:P,y:0,width:A,height:k},!r)h.x=b.plotHeight-h.x}else if(h={x:0,y:p?u:P,width:k,height:A},r)h.y=b.plotWidth-h.y;b.inverted&&c.isVML&&(h=l.isXAxis?{x:0,y:o?
P:u,height:h.width,width:b.chartWidth}:{x:h.y-b.plotLeft-b.spacingBox.x,y:0,width:h.height,height:b.chartHeight});g[n]?g[n].animate(h):(g[n]=c.clipRect(h),i&&a["zoneGraph"+n].clip(g[n]),j&&a["zoneArea"+n].clip(g[n]));w=d.value>m.max}),this.clips=g},invertGroups:function(){function a(){var a={width:b.yAxis.len,height:b.xAxis.len};n(["group","markerGroup"],function(c){b[c]&&b[c].attr(a).invert()})}var b=this,c=b.chart;if(b.xAxis)D(c,"resize",a),D(b,"destroy",function(){T(c,"resize",a)}),a(),b.invertGroups=
a},plotGroup:function(a,b,c,d,e){var f=this[a],g=!f;g&&(this[a]=f=this.chart.renderer.g(b).attr({zIndex:d||0.1}).add(e),f.addClass("highcharts-series-"+this.index));f.attr({visibility:c})[g?"attr":"animate"](this.getPlotBox());return f},getPlotBox:function(){var a=this.chart,b=this.xAxis,c=this.yAxis;if(a.inverted)b=c,c=this.xAxis;return{translateX:b?b.left:a.plotLeft,translateY:c?c.top:a.plotTop,scaleX:1,scaleY:1}},render:function(){var a=this,b=a.chart,c,d=a.options,e=!!a.animate&&b.renderer.isSVG&&
hb(d.animation).duration,f=a.visible?"inherit":"hidden",g=d.zIndex,h=a.hasRendered,i=b.seriesGroup;c=a.plotGroup("group","series",f,g,i);a.markerGroup=a.plotGroup("markerGroup","markers",f,g,i);e&&a.animate(!0);a.getAttribs();c.inverted=a.isCartesian?b.inverted:!1;a.drawGraph&&(a.drawGraph(),a.applyZones());n(a.points,function(a){a.redraw&&a.redraw()});a.drawDataLabels&&a.drawDataLabels();a.visible&&a.drawPoints();a.drawTracker&&a.options.enableMouseTracking!==!1&&a.drawTracker();b.inverted&&a.invertGroups();
d.clip!==!1&&!a.sharedClipKey&&!h&&c.clip(b.clipRect);e&&a.animate();if(!h)a.animationTimeout=$a(function(){a.afterAnimate()},e);a.isDirty=a.isDirtyData=!1;a.hasRendered=!0},redraw:function(){var a=this.chart,b=this.isDirtyData,c=this.isDirty,d=this.group,e=this.xAxis,f=this.yAxis;d&&(a.inverted&&d.attr({width:a.plotWidth,height:a.plotHeight}),d.animate({translateX:q(e&&e.left,a.plotLeft),translateY:q(f&&f.top,a.plotTop)}));this.translate();this.render();b&&M(this,"updatedData");(c||b)&&delete this.kdTree},
kdDimensions:1,kdAxisArray:["clientX","plotY"],searchPoint:function(a,b){var c=this.xAxis,d=this.yAxis,e=this.chart.inverted;return this.searchKDTree({clientX:e?c.len-a.chartY+c.pos:a.chartX-c.pos,plotY:e?d.len-a.chartX+d.pos:a.chartY-d.pos},b)},buildKDTree:function(){function a(c,e,f){var g,h;if(h=c&&c.length)return g=b.kdAxisArray[e%f],c.sort(function(a,b){return a[g]-b[g]}),h=Math.floor(h/2),{point:c[h],left:a(c.slice(0,h),e+1,f),right:a(c.slice(h+1),e+1,f)}}var b=this,c=b.kdDimensions;delete b.kdTree;
$a(function(){b.kdTree=a(b.getValidPoints(null,!b.directTouch),c,c)},b.options.kdNow?0:1)},searchKDTree:function(a,b){function c(a,b,j,k){var l=b.point,m=d.kdAxisArray[j%k],o,p,r=l;p=s(a[e])&&s(l[e])?Math.pow(a[e]-l[e],2):null;o=s(a[f])&&s(l[f])?Math.pow(a[f]-l[f],2):null;o=(p||0)+(o||0);l.dist=s(o)?Math.sqrt(o):Number.MAX_VALUE;l.distX=s(p)?Math.sqrt(p):Number.MAX_VALUE;m=a[m]-l[m];o=m<0?"left":"right";p=m<0?"right":"left";b[o]&&(o=c(a,b[o],j+1,k),r=o[g]<r[g]?o:l);b[p]&&Math.sqrt(m*m)<r[g]&&(a=c(a,
b[p],j+1,k),r=a[g]<r[g]?a:r);return r}var d=this,e=this.kdAxisArray[0],f=this.kdAxisArray[1],g=b?"distX":"dist";this.kdTree||this.buildKDTree();if(this.kdTree)return c(a,this.kdTree,this.kdDimensions,this.kdDimensions)}};Tb.prototype={destroy:function(){Pa(this,this.axis)},render:function(a){var b=this.options,c=b.format,c=c?La(c,this):b.formatter.call(this);this.label?this.label.attr({text:c,visibility:"hidden"}):this.label=this.axis.chart.renderer.text(c,null,null,b.useHTML).css(b.style).attr({align:this.textAlign,
rotation:b.rotation,visibility:"hidden"}).add(a)},setOffset:function(a,b){var c=this.axis,d=c.chart,e=d.inverted,f=c.reversed,f=this.isNegative&&!f||!this.isNegative&&f,g=c.translate(c.usePercentage?100:this.total,0,0,0,1),c=c.translate(0),c=S(g-c),h=d.xAxis[0].translate(this.x)+a,i=d.plotHeight,f={x:e?f?g:g-c:h,y:e?i-h-b:f?i-g-c:i-g,width:e?c:b,height:e?b:c};if(e=this.label)e.align(this.alignOptions,null,f),f=e.alignAttr,e[this.options.crop===!1||d.isInsidePlot(f.x,f.y)?"show":"hide"](!0)}};Ca.prototype.getStacks=
function(){var a=this;n(a.yAxis,function(a){if(a.stacks&&a.hasVisibleSeries)a.oldStacks=a.stacks});n(a.series,function(b){if(b.options.stacking&&(b.visible===!0||a.options.chart.ignoreHiddenSeries===!1))b.stackKey=b.type+q(b.options.stack,"")})};I.prototype.buildStacks=function(){var a=this.series,b,c=q(this.options.reversedStacks,!0),d=a.length,e;if(!this.isXAxis){this.usePercentage=!1;for(e=d;e--;)a[c?e:d-e-1].setStackedPoints();for(e=d;e--;)b=a[c?e:d-e-1],b.setStackCliffs&&b.setStackCliffs();if(this.usePercentage)for(e=
0;e<d;e++)a[e].setPercentStacks()}};I.prototype.renderStackTotals=function(){var a=this.chart,b=a.renderer,c=this.stacks,d,e,f=this.stackTotalGroup;if(!f)this.stackTotalGroup=f=b.g("stack-labels").attr({visibility:"visible",zIndex:6}).add();f.translate(a.plotLeft,a.plotTop);for(d in c)for(e in a=c[d],a)a[e].render(f)};I.prototype.resetStacks=function(){var a=this.stacks,b,c;if(!this.isXAxis)for(b in a)for(c in a[b])a[b][c].touched<this.stacksTouched?(a[b][c].destroy(),delete a[b][c]):(a[b][c].total=
null,a[b][c].cum=0)};I.prototype.cleanStacks=function(){var a,b,c;if(!this.isXAxis){if(this.oldStacks)a=this.stacks=this.oldStacks;for(b in a)for(c in a[b])a[b][c].cum=a[b][c].total}};Q.prototype.setStackedPoints=function(){if(this.options.stacking&&!(this.visible!==!0&&this.chart.options.chart.ignoreHiddenSeries!==!1)){var a=this.processedXData,b=this.processedYData,c=[],d=b.length,e=this.options,f=e.threshold,g=e.startFromThreshold?f:0,h=e.stack,e=e.stacking,i=this.stackKey,j="-"+i,k=this.negStacks,
l=this.yAxis,m=l.stacks,o=l.oldStacks,p,r,n,P,u,w,s;l.stacksTouched+=1;for(u=0;u<d;u++){w=a[u];s=b[u];p=this.getStackIndicator(p,w,this.index);P=p.key;n=(r=k&&s<(g?0:f))?j:i;m[n]||(m[n]={});if(!m[n][w])o[n]&&o[n][w]?(m[n][w]=o[n][w],m[n][w].total=null):m[n][w]=new Tb(l,l.options.stackLabels,r,w,h);n=m[n][w];if(s!==null)n.points[P]=n.points[this.index]=[q(n.cum,g)],n.touched=l.stacksTouched,p.index>0&&this.singleStacks===!1&&(n.points[P][0]=n.points[this.index+","+w+",0"][0]);e==="percent"?(r=r?i:
j,k&&m[r]&&m[r][w]?(r=m[r][w],n.total=r.total=v(r.total,n.total)+S(s)||0):n.total=na(n.total+(S(s)||0))):n.total=na(n.total+(s||0));n.cum=q(n.cum,g)+(s||0);if(s!==null)n.points[P].push(n.cum),c[u]=n.cum}if(e==="percent")l.usePercentage=!0;this.stackedYData=c;l.oldStacks={}}};Q.prototype.setPercentStacks=function(){var a=this,b=a.stackKey,c=a.yAxis.stacks,d=a.processedXData,e;n([b,"-"+b],function(b){var f;for(var g=d.length,h,i;g--;)if(h=d[g],e=a.getStackIndicator(e,h,a.index),f=(i=c[b]&&c[b][h])&&
i.points[e.key],h=f)i=i.total?100/i.total:0,h[0]=na(h[0]*i),h[1]=na(h[1]*i),a.stackedYData[g]=h[1]})};Q.prototype.getStackIndicator=function(a,b,c){!s(a)||a.x!==b?a={x:b,index:0}:a.index++;a.key=[c,b,a.index].join(",");return a};x(Ca.prototype,{addSeries:function(a,b,c){var d,e=this;a&&(b=q(b,!0),M(e,"addSeries",{options:a},function(){d=e.initSeries(a);e.isDirtyLegend=!0;e.linkSeries();b&&e.redraw(c)}));return d},addAxis:function(a,b,c,d){var e=b?"xAxis":"yAxis",f=this.options,a=C(a,{index:this[e].length,
isX:b});new I(this,a);f[e]=va(f[e]||{});f[e].push(a);q(c,!0)&&this.redraw(d)},showLoading:function(a){var b=this,c=b.options,d=b.loadingDiv,e=c.loading,f=function(){d&&F(d,{left:b.plotLeft+"px",top:b.plotTop+"px",width:b.plotWidth+"px",height:b.plotHeight+"px"})};if(!d)b.loadingDiv=d=ea(Wa,{className:"highcharts-loading"},x(e.style,{zIndex:10,display:"none"}),b.container),b.loadingSpan=ea("span",null,e.labelStyle,d),D(b,"redraw",f);b.loadingSpan.innerHTML=a||c.lang.loading;if(!b.loadingShown)F(d,
{opacity:0,display:""}),eb(d,{opacity:e.style.opacity},{duration:e.showDuration||0}),b.loadingShown=!0;f()},hideLoading:function(){var a=this.options,b=this.loadingDiv;b&&eb(b,{opacity:0},{duration:a.loading.hideDuration||100,complete:function(){F(b,{display:"none"})}});this.loadingShown=!1}});x(Ha.prototype,{update:function(a,b,c,d){function e(){f.applyOptions(a);if(f.y===null&&h)f.graphic=h.destroy();if(da(a)&&!Ja(a))f.redraw=function(){if(h&&h.element&&a&&a.marker&&a.marker.symbol)f.graphic=h.destroy();
if(a&&a.dataLabels&&f.dataLabel)f.dataLabel=f.dataLabel.destroy();f.redraw=null};i=f.index;g.updateParallelArrays(f,i);if(l&&f.name)l[f.x]=f.name;k.data[i]=da(k.data[i])&&!Ja(k.data[i])?f.options:a;g.isDirty=g.isDirtyData=!0;if(!g.fixedBox&&g.hasCartesianSeries)j.isDirtyBox=!0;if(k.legendType==="point")j.isDirtyLegend=!0;b&&j.redraw(c)}var f=this,g=f.series,h=f.graphic,i,j=g.chart,k=g.options,l=g.xAxis&&g.xAxis.names,b=q(b,!0);d===!1?e():f.firePointEvent("update",{options:a},e)},remove:function(a,
b){this.series.removePoint(sa(this,this.series.data),a,b)}});x(Q.prototype,{addPoint:function(a,b,c,d){var e=this,f=e.options,g=e.data,h=e.graph,i=e.area,j=e.chart,k=e.xAxis&&e.xAxis.names,l=h&&h.shift||0,m=["graph","area"],h=f.data,o,p=e.xData;ab(d,j);if(c){for(d=e.zones.length;d--;)m.push("zoneGraph"+d,"zoneArea"+d);n(m,function(a){if(e[a])e[a].shift=l+(f.step?2:1)})}if(i)i.isArea=!0;b=q(b,!0);i={series:e};e.pointClass.prototype.applyOptions.apply(i,[a]);m=i.x;d=p.length;if(e.requireSorting&&m<
p[d-1])for(o=!0;d&&p[d-1]>m;)d--;e.updateParallelArrays(i,"splice",d,0,0);e.updateParallelArrays(i,d);if(k&&i.name)k[m]=i.name;h.splice(d,0,a);o&&(e.data.splice(d,0,null),e.processData());f.legendType==="point"&&e.generatePoints();c&&(g[0]&&g[0].remove?g[0].remove(!1):(g.shift(),e.updateParallelArrays(i,"shift"),h.shift()));e.isDirty=!0;e.isDirtyData=!0;b&&(e.getAttribs(),j.redraw())},removePoint:function(a,b,c){var d=this,e=d.data,f=e[a],g=d.points,h=d.chart,i=function(){g&&g.length===e.length&&
g.splice(a,1);e.splice(a,1);d.options.data.splice(a,1);d.updateParallelArrays(f||{series:d},"splice",a,1);f&&f.destroy();d.isDirty=!0;d.isDirtyData=!0;b&&h.redraw()};ab(c,h);b=q(b,!0);f?f.firePointEvent("remove",null,i):i()},remove:function(a,b){var c=this,d=c.chart;M(c,"remove",null,function(){c.destroy();d.isDirtyLegend=d.isDirtyBox=!0;d.linkSeries();q(a,!0)&&d.redraw(b)})},update:function(a,b){var c=this,d=this.chart,e=this.userOptions,f=this.type,g=K[f].prototype,h=["group","markerGroup","dataLabelsGroup"],
i;if(a.type&&a.type!==f||a.zIndex!==void 0)h.length=0;n(h,function(a){h[a]=c[a];delete c[a]});a=C(e,{animation:!1,index:this.index,pointStart:this.xData[0]},{data:this.options.data},a);this.remove(!1);for(i in g)this[i]=t;x(this,K[a.type||f].prototype);n(h,function(a){c[a]=h[a]});this.init(d,a);d.linkSeries();q(b,!0)&&d.redraw(!1)}});x(I.prototype,{update:function(a,b){var c=this.chart,a=c.options[this.coll][this.options.index]=C(this.userOptions,a);this.destroy(!0);this._addedPlotLB=this.chart._labelPanes=
t;this.init(c,x(a,{events:t}));c.isDirtyBox=!0;q(b,!0)&&c.redraw()},remove:function(a){for(var b=this.chart,c=this.coll,d=this.series,e=d.length;e--;)d[e]&&d[e].remove(!1);Aa(b.axes,this);Aa(b[c],this);b.options[c].splice(this.options.index,1);n(b[c],function(a,b){a.options.index=b});this.destroy();b.isDirtyBox=!0;q(a,!0)&&b.redraw()},setTitle:function(a,b){this.update({title:a},b)},setCategories:function(a,b){this.update({categories:a},b)}});var Ia=la(Q);K.line=Ia;W.area=C(ca,{softThreshold:!1,threshold:0});
var za=la(Q,{type:"area",singleStacks:!1,getStackPoints:function(){var a=[],b=[],c=this.xAxis,d=this.yAxis,e=d.stacks[this.stackKey],f={},g=this.points,h=this.index,i=d.series,j=i.length,k,l=q(d.options.reversedStacks,!0)?1:-1,m,o;if(this.options.stacking){for(m=0;m<g.length;m++)f[g[m].x]=g[m];for(o in e)e[o].total!==null&&b.push(o);b.sort(function(a,b){return a-b});k=ta(i,function(){return this.visible});n(b,function(g,i){var o=0,q,u;if(f[g]&&!f[g].isNull)a.push(f[g]),n([-1,1],function(a){var c=
a===1?"rightNull":"leftNull",d=0,o=e[b[i+a]];if(o)for(m=h;m>=0&&m<j;)q=o.points[m],q||(m===h?f[g][c]=!0:k[m]&&(u=e[g].points[m])&&(d-=u[1]-u[0])),m+=l;f[g][a===1?"rightCliff":"leftCliff"]=d});else{for(m=h;m>=0&&m<j;){if(q=e[g].points[m]){o=q[1];break}m+=l}o=d.toPixels(o,!0);a.push({isNull:!0,plotX:c.toPixels(g,!0),plotY:o,yBottom:o})}})}return a},getGraphPath:function(a){var b=Q.prototype.getGraphPath,c=this.options,d=c.stacking,e=this.yAxis,f,g,h=[],i=[],j=this.index,k,l=e.stacks[this.stackKey],
m=c.threshold,o=e.getThreshold(c.threshold),p,c=c.connectNulls||d==="percent",r=function(b,c,f){var g=a[b],b=d&&l[g.x].points[j],p=g[f+"Null"]||0,f=g[f+"Cliff"]||0,r,n,g=!0;f||p?(r=(p?b[0]:b[1])+f,n=b[0]+f,g=!!p):!d&&a[c]&&a[c].isNull&&(r=n=m);r!==void 0&&(i.push({plotX:k,plotY:r===null?o:e.getThreshold(r),isNull:g}),h.push({plotX:k,plotY:n===null?o:e.getThreshold(n)}))},a=a||this.points;d&&(a=this.getStackPoints());for(f=0;f<a.length;f++)if(g=a[f].isNull,k=q(a[f].rectPlotX,a[f].plotX),p=q(a[f].yBottom,
o),!g||c){c||r(f,f-1,"left");if(!g||d||!c)i.push(a[f]),h.push({x:f,plotX:k,plotY:p});c||r(f,f+1,"right")}f=b.call(this,i,!0,!0);h.reversed=!0;g=b.call(this,h,!0,!0);g.length&&(g[0]="L");f=f.concat(g);b=b.call(this,i,!1,c);this.areaPath=f;return b},drawGraph:function(){this.areaPath=[];Q.prototype.drawGraph.apply(this);var a=this,b=this.areaPath,c=this.options,d=[["area",this.color,c.fillColor]];n(this.zones,function(b,f){d.push(["zoneArea"+f,b.color||a.color,b.fillColor||c.fillColor])});n(d,function(d){var f=
d[0],g=a[f];g?g.animate({d:b}):(g={fill:d[2]||d[1],zIndex:0},d[2]||(g["fill-opacity"]=q(c.fillOpacity,0.75)),a[f]=a.chart.renderer.path(b).attr(g).add(a.group))})},drawLegendSymbol:aa.drawRectangle});K.area=za;W.spline=C(ca);Ia=la(Q,{type:"spline",getPointSpline:function(a,b,c){var d=b.plotX,e=b.plotY,f=a[c-1],c=a[c+1],g,h,i,j;if(f&&!f.isNull&&c&&!c.isNull){a=f.plotY;i=c.plotX;var c=c.plotY,k=0;g=(1.5*d+f.plotX)/2.5;h=(1.5*e+a)/2.5;i=(1.5*d+i)/2.5;j=(1.5*e+c)/2.5;i!==g&&(k=(j-h)*(i-d)/(i-g)+e-j);
h+=k;j+=k;h>a&&h>e?(h=v(a,e),j=2*e-h):h<a&&h<e&&(h=E(a,e),j=2*e-h);j>c&&j>e?(j=v(c,e),h=2*e-j):j<c&&j<e&&(j=E(c,e),h=2*e-j);b.rightContX=i;b.rightContY=j}b=["C",q(f.rightContX,f.plotX),q(f.rightContY,f.plotY),q(g,d),q(h,e),d,e];f.rightContX=f.rightContY=null;return b}});K.spline=Ia;W.areaspline=C(W.area);za=za.prototype;Ia=la(Ia,{type:"areaspline",getStackPoints:za.getStackPoints,getGraphPath:za.getGraphPath,setStackCliffs:za.setStackCliffs,drawGraph:za.drawGraph,drawLegendSymbol:aa.drawRectangle});
K.areaspline=Ia;W.column=C(ca,{borderColor:"#FFFFFF",borderRadius:0,groupPadding:0.2,marker:null,pointPadding:0.1,minPointLength:0,cropThreshold:50,pointRange:null,states:{hover:{brightness:0.1,shadow:!1,halo:!1},select:{color:"#C0C0C0",borderColor:"#000000",shadow:!1}},dataLabels:{align:null,verticalAlign:null,y:null},softThreshold:!1,startFromThreshold:!0,stickyTracking:!1,tooltip:{distance:6},threshold:0});Ia=la(Q,{type:"column",pointAttrToOptions:{stroke:"borderColor",fill:"color",r:"borderRadius"},
cropShoulder:0,directTouch:!0,trackerGroups:["group","dataLabelsGroup"],negStacks:!0,init:function(){Q.prototype.init.apply(this,arguments);var a=this,b=a.chart;b.hasRendered&&n(b.series,function(b){if(b.type===a.type)b.isDirty=!0})},getColumnMetrics:function(){var a=this,b=a.options,c=a.xAxis,d=a.yAxis,e=c.reversed,f,g={},h=0;b.grouping===!1?h=1:n(a.chart.series,function(b){var c=b.options,e=b.yAxis,i;if(b.type===a.type&&b.visible&&d.len===e.len&&d.pos===e.pos)c.stacking?(f=b.stackKey,g[f]===t&&
(g[f]=h++),i=g[f]):c.grouping!==!1&&(i=h++),b.columnIndex=i});var i=E(S(c.transA)*(c.ordinalSlope||b.pointRange||c.closestPointRange||c.tickInterval||1),c.len),j=i*b.groupPadding,k=(i-2*j)/h,b=E(b.maxPointWidth||c.len,q(b.pointWidth,k*(1-2*b.pointPadding)));a.columnMetrics={width:b,offset:(k-b)/2+(j+((a.columnIndex||0)+(e?1:0))*k-i/2)*(e?-1:1)};return a.columnMetrics},crispCol:function(a,b,c,d){var e=this.chart,f=this.borderWidth,g=-(f%2?0.5:0),f=f%2?0.5:1;e.inverted&&e.renderer.isVML&&(f+=1);c=Math.round(a+
c)+g;a=Math.round(a)+g;c-=a;d=Math.round(b+d)+f;g=S(b)<=0.5&&d>0.5;b=Math.round(b)+f;d-=b;g&&d&&(b-=1,d+=1);return{x:a,y:b,width:c,height:d}},translate:function(){var a=this,b=a.chart,c=a.options,d=a.borderWidth=q(c.borderWidth,a.closestPointRange*a.xAxis.transA<2?0:1),e=a.yAxis,f=a.translatedThreshold=e.getThreshold(c.threshold),g=q(c.minPointLength,5),h=a.getColumnMetrics(),i=h.width,j=a.barW=v(i,1+2*d),k=a.pointXOffset=h.offset;b.inverted&&(f-=0.5);c.pointPadding&&(j=Fa(j));Q.prototype.translate.apply(a);
n(a.points,function(c){var d=E(q(c.yBottom,f),9E4),h=999+S(d),h=E(v(-h,c.plotY),e.len+h),p=c.plotX+k,r=j,n=E(h,d),s,u=v(h,d)-n;S(u)<g&&g&&(u=g,s=!e.reversed&&!c.negative||e.reversed&&c.negative,n=S(n-f)>g?d-g:f-(s?g:0));c.barX=p;c.pointWidth=i;c.tooltipPos=b.inverted?[e.len+e.pos-b.plotLeft-h,a.xAxis.len-p-r/2,u]:[p+r/2,h+e.pos-b.plotTop,u];c.shapeType="rect";c.shapeArgs=a.crispCol(p,n,r,u)})},getSymbol:ra,drawLegendSymbol:aa.drawRectangle,drawGraph:ra,drawPoints:function(){var a=this,b=this.chart,
c=a.options,d=b.renderer,e=c.animationLimit||250,f,g;n(a.points,function(h){var i=h.plotY,j=h.graphic;if(i!==t&&!isNaN(i)&&h.y!==null)f=h.shapeArgs,i=s(a.borderWidth)?{"stroke-width":a.borderWidth}:{},g=h.pointAttr[h.selected?"select":""]||a.pointAttr[""],j?(Ta(j),j.attr(i).attr(g)[b.pointCount<e?"animate":"attr"](C(f))):h.graphic=d[h.shapeType](f).attr(i).attr(g).add(h.group||a.group).shadow(c.shadow,null,c.stacking&&!c.borderRadius);else if(j)h.graphic=j.destroy()})},animate:function(a){var b=this,
c=this.yAxis,d=b.options,e=this.chart.inverted,f={};if(ja)a?(f.scaleY=0.001,a=E(c.pos+c.len,v(c.pos,c.toPixels(d.threshold))),e?f.translateX=a-c.len:f.translateY=a,b.group.attr(f)):(f[e?"translateX":"translateY"]=c.pos,b.group.animate(f,x(hb(b.options.animation),{step:function(a,c){b.group.attr({scaleY:c.pos})}})),b.animate=null)},remove:function(){var a=this,b=a.chart;b.hasRendered&&n(b.series,function(b){if(b.type===a.type)b.isDirty=!0});Q.prototype.remove.apply(a,arguments)}});K.column=Ia;W.bar=
C(W.column);za=la(Ia,{type:"bar",inverted:!0});K.bar=za;W.scatter=C(ca,{lineWidth:0,marker:{enabled:!0},tooltip:{headerFormat:'<span style="color:{point.color}">\u25cf</span> <span style="font-size: 10px;"> {series.name}</span><br/>',pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>"}});za=la(Q,{type:"scatter",sorted:!1,requireSorting:!1,noSharedTooltip:!0,trackerGroups:["group","markerGroup","dataLabelsGroup"],takeOrdinalPosition:!1,kdDimensions:2,drawGraph:function(){this.options.lineWidth&&
Q.prototype.drawGraph.call(this)}});K.scatter=za;W.pie=C(ca,{borderColor:"#FFFFFF",borderWidth:1,center:[null,null],clip:!1,colorByPoint:!0,dataLabels:{distance:30,enabled:!0,formatter:function(){return this.y===null?void 0:this.point.name},x:0},ignoreHiddenPoint:!0,legendType:"point",marker:null,size:null,showInLegend:!1,slicedOffset:10,states:{hover:{brightness:0.1,shadow:!1}},stickyTracking:!1,tooltip:{followPointer:!0}});ca={type:"pie",isCartesian:!1,pointClass:la(Ha,{init:function(){Ha.prototype.init.apply(this,
arguments);var a=this,b;a.name=q(a.name,"Slice");b=function(b){a.slice(b.type==="select")};D(a,"select",b);D(a,"unselect",b);return a},setVisible:function(a,b){var c=this,d=c.series,e=d.chart,f=d.options.ignoreHiddenPoint,b=q(b,f);if(a!==c.visible){c.visible=c.options.visible=a=a===t?!c.visible:a;d.options.data[sa(c,d.data)]=c.options;n(["graphic","dataLabel","connector","shadowGroup"],function(b){if(c[b])c[b][a?"show":"hide"](!0)});c.legendItem&&e.legend.colorizeItem(c,a);!a&&c.state==="hover"&&
c.setState("");if(f)d.isDirty=!0;b&&e.redraw()}},slice:function(a,b,c){var d=this.series;ab(c,d.chart);q(b,!0);this.sliced=this.options.sliced=a=s(a)?a:!this.sliced;d.options.data[sa(this,d.data)]=this.options;a=a?this.slicedTranslation:{translateX:0,translateY:0};this.graphic.animate(a);this.shadowGroup&&this.shadowGroup.animate(a)},haloPath:function(a){var b=this.shapeArgs,c=this.series.chart;return this.sliced||!this.visible?[]:this.series.chart.renderer.symbols.arc(c.plotLeft+b.x,c.plotTop+b.y,
b.r+a,b.r+a,{innerR:this.shapeArgs.r,start:b.start,end:b.end})}}),requireSorting:!1,directTouch:!0,noSharedTooltip:!0,trackerGroups:["group","dataLabelsGroup"],axisTypes:[],pointAttrToOptions:{stroke:"borderColor","stroke-width":"borderWidth",fill:"color"},animate:function(a){var b=this,c=b.points,d=b.startAngleRad;if(!a)n(c,function(a){var c=a.graphic,g=a.shapeArgs;c&&(c.attr({r:a.startR||b.center[3]/2,start:d,end:d}),c.animate({r:g.r,start:g.start,end:g.end},b.options.animation))}),b.animate=null},
updateTotals:function(){var a,b=0,c=this.points,d=c.length,e,f=this.options.ignoreHiddenPoint;for(a=0;a<d;a++)e=c[a],b+=f&&!e.visible?0:e.y;this.total=b;for(a=0;a<d;a++)e=c[a],e.percentage=b>0&&(e.visible||!f)?e.y/b*100:0,e.total=b},generatePoints:function(){Q.prototype.generatePoints.call(this);this.updateTotals()},translate:function(a){this.generatePoints();var b=0,c=this.options,d=c.slicedOffset,e=d+c.borderWidth,f,g,h,i=c.startAngle||0,j=this.startAngleRad=Ba/180*(i-90),i=(this.endAngleRad=Ba/
180*(q(c.endAngle,i+360)-90))-j,k=this.points,l=c.dataLabels.distance,c=c.ignoreHiddenPoint,m,o=k.length,p;if(!a)this.center=a=this.getCenter();this.getX=function(b,c){h=Y.asin(E((b-a[1])/(a[2]/2+l),1));return a[0]+(c?-1:1)*ba(h)*(a[2]/2+l)};for(m=0;m<o;m++){p=k[m];f=j+b*i;if(!c||p.visible)b+=p.percentage/100;g=j+b*i;p.shapeType="arc";p.shapeArgs={x:a[0],y:a[1],r:a[2]/2,innerR:a[3]/2,start:y(f*1E3)/1E3,end:y(g*1E3)/1E3};h=(g+f)/2;h>1.5*Ba?h-=2*Ba:h<-Ba/2&&(h+=2*Ba);p.slicedTranslation={translateX:y(ba(h)*
d),translateY:y(ka(h)*d)};f=ba(h)*a[2]/2;g=ka(h)*a[2]/2;p.tooltipPos=[a[0]+f*0.7,a[1]+g*0.7];p.half=h<-Ba/2||h>Ba/2?1:0;p.angle=h;e=E(e,l/2);p.labelPos=[a[0]+f+ba(h)*l,a[1]+g+ka(h)*l,a[0]+f+ba(h)*e,a[1]+g+ka(h)*e,a[0]+f,a[1]+g,l<0?"center":p.half?"right":"left",h]}},drawGraph:null,drawPoints:function(){var a=this,b=a.chart.renderer,c,d,e=a.options.shadow,f,g,h,i;if(e&&!a.shadowGroup)a.shadowGroup=b.g("shadow").add(a.group);n(a.points,function(j){if(j.y!==null){d=j.graphic;h=j.shapeArgs;f=j.shadowGroup;
g=j.pointAttr[j.selected?"select":""];if(!g.stroke)g.stroke=g.fill;if(e&&!f)f=j.shadowGroup=b.g("shadow").add(a.shadowGroup);c=j.sliced?j.slicedTranslation:{translateX:0,translateY:0};f&&f.attr(c);if(d)d.setRadialReference(a.center).attr(g).animate(x(h,c));else{i={"stroke-linejoin":"round"};if(!j.visible)i.visibility="hidden";j.graphic=d=b[j.shapeType](h).setRadialReference(a.center).attr(g).attr(i).attr(c).add(a.group).shadow(e,f)}}})},searchPoint:ra,sortByAngle:function(a,b){a.sort(function(a,d){return a.angle!==
void 0&&(d.angle-a.angle)*b})},drawLegendSymbol:aa.drawRectangle,getCenter:bc.getCenter,getSymbol:ra};ca=la(Q,ca);K.pie=ca;Q.prototype.drawDataLabels=function(){var a=this,b=a.options,c=b.cursor,d=b.dataLabels,e=a.points,f,g,h=a.hasRendered||0,i,j,k=q(d.defer,!0),l=a.chart.renderer;if(d.enabled||a._hasPointLabels)a.dlProcessOptions&&a.dlProcessOptions(d),j=a.plotGroup("dataLabelsGroup","data-labels",k&&!h?"hidden":"visible",d.zIndex||6),k&&(j.attr({opacity:+h}),h||D(a,"afterAnimate",function(){a.visible&&
j.show();j[b.animation?"animate":"attr"]({opacity:1},{duration:200})})),g=d,n(e,function(e){var h,k=e.dataLabel,r,n,P=e.connector,u=!0,w,v={};f=e.dlOptions||e.options&&e.options.dataLabels;h=q(f&&f.enabled,g.enabled)&&e.y!==null;if(k&&!h)e.dataLabel=k.destroy();else if(h){d=C(g,f);w=d.style;h=d.rotation;r=e.getLabelConfig();i=d.format?La(d.format,r):d.formatter.call(r,d);w.color=q(d.color,w.color,a.color,"black");if(k)if(s(i))k.attr({text:i}),u=!1;else{if(e.dataLabel=k=k.destroy(),P)e.connector=P.destroy()}else if(s(i)){k=
{fill:d.backgroundColor,stroke:d.borderColor,"stroke-width":d.borderWidth,r:d.borderRadius||0,rotation:h,padding:d.padding,zIndex:1};if(w.color==="contrast")v.color=d.inside||d.distance<0||b.stacking?l.getContrast(e.color||a.color):"#000000";if(c)v.cursor=c;for(n in k)k[n]===t&&delete k[n];k=e.dataLabel=l[h?"text":"label"](i,0,-9999,d.shape,null,null,d.useHTML).attr(k).css(x(w,v)).add(j).shadow(d.shadow)}k&&a.alignDataLabel(e,k,d,null,u)}})};Q.prototype.alignDataLabel=function(a,b,c,d,e){var f=this.chart,
g=f.inverted,h=q(a.plotX,-9999),i=q(a.plotY,-9999),j=b.getBBox(),k=f.renderer.fontMetrics(c.style.fontSize).b,l=c.rotation,m=c.align,o=this.visible&&(a.series.forceDL||f.isInsidePlot(h,y(i),g)||d&&f.isInsidePlot(h,g?d.x+1:d.y+d.height-1,g)),p=q(c.overflow,"justify")==="justify";if(o)d=x({x:g?f.plotWidth-i:h,y:y(g?f.plotHeight-h:i),width:0,height:0},d),x(c,{width:j.width,height:j.height}),l?(p=!1,g=f.renderer.rotCorr(k,l),g={x:d.x+c.x+d.width/2+g.x,y:d.y+c.y+d.height/2},b[e?"attr":"animate"](g).attr({align:c.align}),
h=(l+720)%360,h=h>180&&h<360,m==="left"?g.y-=h?j.height:0:m==="center"?(g.x-=j.width/2,g.y-=j.height/2):m==="right"&&(g.x-=j.width,g.y-=h?0:j.height)):(b.align(c,null,d),g=b.alignAttr),p?this.justifyDataLabel(b,c,g,j,d,e):q(c.crop,!0)&&(o=f.isInsidePlot(g.x,g.y)&&f.isInsidePlot(g.x+j.width,g.y+j.height)),c.shape&&!l&&b.attr({anchorX:a.plotX,anchorY:a.plotY});if(!o)Ta(b),b.attr({y:-9999}),b.placed=!1};Q.prototype.justifyDataLabel=function(a,b,c,d,e,f){var g=this.chart,h=b.align,i=b.verticalAlign,j,
k,l=a.box?0:a.padding||0;j=c.x+l;if(j<0)h==="right"?b.align="left":b.x=-j,k=!0;j=c.x+d.width-l;if(j>g.plotWidth)h==="left"?b.align="right":b.x=g.plotWidth-j,k=!0;j=c.y+l;if(j<0)i==="bottom"?b.verticalAlign="top":b.y=-j,k=!0;j=c.y+d.height-l;if(j>g.plotHeight)i==="top"?b.verticalAlign="bottom":b.y=g.plotHeight-j,k=!0;if(k)a.placed=!f,a.align(b,null,e)};if(K.pie)K.pie.prototype.drawDataLabels=function(){var a=this,b=a.data,c,d=a.chart,e=a.options.dataLabels,f=q(e.connectorPadding,10),g=q(e.connectorWidth,
1),h=d.plotWidth,i=d.plotHeight,j,k,l=q(e.softConnector,!0),m=e.distance,o=a.center,p=o[2]/2,r=o[1],A=m>0,s,u,w,t=[[],[]],x,z,C,B,L,D=[0,0,0,0],J=function(a,b){return b.y-a.y};if(a.visible&&(e.enabled||a._hasPointLabels)){Q.prototype.drawDataLabels.apply(a);n(b,function(a){if(a.dataLabel&&a.visible)t[a.half].push(a),a.dataLabel._pos=null});for(B=2;B--;){var G=[],K=[],I=t[B],F=I.length,H;if(F){a.sortByAngle(I,B-0.5);for(L=b=0;!b&&I[L];)b=I[L]&&I[L].dataLabel&&(I[L].dataLabel.getBBox().height||21),
L++;if(m>0){u=E(r+p+m,d.plotHeight);for(L=v(0,r-p-m);L<=u;L+=b)G.push(L);u=G.length;if(F>u){c=[].concat(I);c.sort(J);for(L=F;L--;)c[L].rank=L;for(L=F;L--;)I[L].rank>=u&&I.splice(L,1);F=I.length}for(L=0;L<F;L++){c=I[L];w=c.labelPos;c=9999;var M,N;for(N=0;N<u;N++)M=S(G[N]-w[1]),M<c&&(c=M,H=N);if(H<L&&G[L]!==null)H=L;else for(u<F-L+H&&G[L]!==null&&(H=u-F+L);G[H]===null;)H++;K.push({i:H,y:G[H]});G[H]=null}K.sort(J)}for(L=0;L<F;L++){c=I[L];w=c.labelPos;s=c.dataLabel;C=c.visible===!1?"hidden":"inherit";
c=w[1];if(m>0){if(u=K.pop(),H=u.i,z=u.y,c>z&&G[H+1]!==null||c<z&&G[H-1]!==null)z=E(v(0,c),d.plotHeight)}else z=c;x=e.justify?o[0]+(B?-1:1)*(p+m):a.getX(z===r-p-m||z===r+p+m?c:z,B);s._attr={visibility:C,align:w[6]};s._pos={x:x+e.x+({left:f,right:-f}[w[6]]||0),y:z+e.y-10};s.connX=x;s.connY=z;if(this.options.size===null)u=s.width,x-u<f?D[3]=v(y(u-x+f),D[3]):x+u>h-f&&(D[1]=v(y(x+u-h+f),D[1])),z-b/2<0?D[0]=v(y(-z+b/2),D[0]):z+b/2>i&&(D[2]=v(y(z+b/2-i),D[2]))}}}if(Ea(D)===0||this.verifyDataLabelOverflow(D))this.placeDataLabels(),
A&&g&&n(this.points,function(b){j=b.connector;w=b.labelPos;if((s=b.dataLabel)&&s._pos&&b.visible)C=s._attr.visibility,x=s.connX,z=s.connY,k=l?["M",x+(w[6]==="left"?5:-5),z,"C",x,z,2*w[2]-w[4],2*w[3]-w[5],w[2],w[3],"L",w[4],w[5]]:["M",x+(w[6]==="left"?5:-5),z,"L",w[2],w[3],"L",w[4],w[5]],j?(j.animate({d:k}),j.attr("visibility",C)):b.connector=j=a.chart.renderer.path(k).attr({"stroke-width":g,stroke:e.connectorColor||b.color||"#606060",visibility:C}).add(a.dataLabelsGroup);else if(j)b.connector=j.destroy()})}},
K.pie.prototype.placeDataLabels=function(){n(this.points,function(a){var b=a.dataLabel;if(b&&a.visible)(a=b._pos)?(b.attr(b._attr),b[b.moved?"animate":"attr"](a),b.moved=!0):b&&b.attr({y:-9999})})},K.pie.prototype.alignDataLabel=ra,K.pie.prototype.verifyDataLabelOverflow=function(a){var b=this.center,c=this.options,d=c.center,e=c.minSize||80,f=e,g;d[0]!==null?f=v(b[2]-v(a[1],a[3]),e):(f=v(b[2]-a[1]-a[3],e),b[0]+=(a[3]-a[1])/2);d[1]!==null?f=v(E(f,b[2]-v(a[0],a[2])),e):(f=v(E(f,b[2]-a[0]-a[2]),e),
b[1]+=(a[0]-a[2])/2);f<b[2]?(b[2]=f,b[3]=Math.min(/%$/.test(c.innerSize||0)?f*parseFloat(c.innerSize||0)/100:parseFloat(c.innerSize||0),f),this.translate(b),this.drawDataLabels&&this.drawDataLabels()):g=!0;return g};if(K.column)K.column.prototype.alignDataLabel=function(a,b,c,d,e){var f=this.chart.inverted,g=a.series,h=a.dlBox||a.shapeArgs,i=q(a.below,a.plotY>q(this.translatedThreshold,g.yAxis.len)),j=q(c.inside,!!this.options.stacking);if(h){d=C(h);if(d.y<0)d.height+=d.y,d.y=0;h=d.y+d.height-g.yAxis.len;
h>0&&(d.height-=h);f&&(d={x:g.yAxis.len-d.y-d.height,y:g.xAxis.len-d.x-d.width,width:d.height,height:d.width});if(!j)f?(d.x+=i?0:d.width,d.width=0):(d.y+=i?d.height:0,d.height=0)}c.align=q(c.align,!f||j?"center":i?"right":"left");c.verticalAlign=q(c.verticalAlign,f||j?"middle":i?"top":"bottom");Q.prototype.alignDataLabel.call(this,a,b,c,d,e)};(function(a){var b=a.Chart,c=a.each,d=a.pick,e=a.addEvent;b.prototype.callbacks.push(function(a){function b(){var e=[];c(a.series,function(a){var b=a.options.dataLabels,
f=a.dataLabelCollections||["dataLabel"];(b.enabled||a._hasPointLabels)&&!b.allowOverlap&&a.visible&&c(f,function(b){c(a.points,function(a){if(a[b])a[b].labelrank=d(a.labelrank,a.shapeArgs&&a.shapeArgs.height),e.push(a[b])})})});a.hideOverlappingLabels(e)}b();e(a,"redraw",b)});b.prototype.hideOverlappingLabels=function(a){var b=a.length,d,e,j,k,l,m,o,p,n;for(e=0;e<b;e++)if(d=a[e])d.oldOpacity=d.opacity,d.newOpacity=1;a.sort(function(a,b){return(b.labelrank||0)-(a.labelrank||0)});for(e=0;e<b;e++){j=
a[e];for(d=e+1;d<b;++d)if(k=a[d],j&&k&&j.placed&&k.placed&&j.newOpacity!==0&&k.newOpacity!==0&&(l=j.alignAttr,m=k.alignAttr,o=j.parentGroup,p=k.parentGroup,n=2*(j.box?0:j.padding),l=!(m.x+p.translateX>l.x+o.translateX+(j.width-n)||m.x+p.translateX+(k.width-n)<l.x+o.translateX||m.y+p.translateY>l.y+o.translateY+(j.height-n)||m.y+p.translateY+(k.height-n)<l.y+o.translateY)))(j.labelrank<k.labelrank?j:k).newOpacity=0}c(a,function(a){var b,c;if(a){c=a.newOpacity;if(a.oldOpacity!==c&&a.placed)c?a.show(!0):
b=function(){a.hide()},a.alignAttr.opacity=c,a[a.isOld?"animate":"attr"](a.alignAttr,null,b);a.isOld=!0}})}})(z);var nb=z.TrackerMixin={drawTrackerPoint:function(){var a=this,b=a.chart,c=b.pointer,d=a.options.cursor,e=d&&{cursor:d},f=function(a){for(var c=a.target,d;c&&!d;)d=c.point,c=c.parentNode;if(d!==t&&d!==b.hoverPoint)d.onMouseOver(a)};n(a.points,function(a){if(a.graphic)a.graphic.element.point=a;if(a.dataLabel)a.dataLabel.element.point=a});if(!a._hasTracking)n(a.trackerGroups,function(b){if(a[b]&&
(a[b].addClass("highcharts-tracker").on("mouseover",f).on("mouseout",function(a){c.onTrackerMouseOut(a)}).css(e),db))a[b].on("touchstart",f)}),a._hasTracking=!0},drawTrackerGraph:function(){var a=this,b=a.options,c=b.trackByArea,d=[].concat(c?a.areaPath:a.graphPath),e=d.length,f=a.chart,g=f.pointer,h=f.renderer,i=f.options.tooltip.snap,j=a.tracker,k=b.cursor,l=k&&{cursor:k},m=function(){if(f.hoverSeries!==a)a.onMouseOver()},o="rgba(192,192,192,"+(ja?1.0E-4:0.002)+")";if(e&&!c)for(k=e+1;k--;)d[k]===
"M"&&d.splice(k+1,0,d[k+1]-i,d[k+2],"L"),(k&&d[k]==="M"||k===e)&&d.splice(k,0,"L",d[k-2]+i,d[k-1]);j?j.attr({d:d}):(a.tracker=h.path(d).attr({"stroke-linejoin":"round",visibility:a.visible?"visible":"hidden",stroke:o,fill:c?o:"none","stroke-width":b.lineWidth+(c?0:2*i),zIndex:2}).add(a.group),n([a.tracker,a.markerGroup],function(a){a.addClass("highcharts-tracker").on("mouseover",m).on("mouseout",function(a){g.onTrackerMouseOut(a)}).css(l);if(db)a.on("touchstart",m)}))}};if(K.column)Ia.prototype.drawTracker=
nb.drawTrackerPoint;if(K.pie)K.pie.prototype.drawTracker=nb.drawTrackerPoint;if(K.scatter)za.prototype.drawTracker=nb.drawTrackerPoint;x(vb.prototype,{setItemEvents:function(a,b,c,d,e){var f=this;(c?b:a.legendGroup).on("mouseover",function(){a.setState("hover");b.css(f.options.itemHoverStyle)}).on("mouseout",function(){b.css(a.visible?d:e);a.setState()}).on("click",function(b){var c=function(){a.setVisible&&a.setVisible()},b={browserEvent:b};a.firePointEvent?a.firePointEvent("legendItemClick",b,c):
M(a,"legendItemClick",b,c)})},createCheckboxForItem:function(a){a.checkbox=ea("input",{type:"checkbox",checked:a.selected,defaultChecked:a.selected},this.options.itemCheckboxStyle,this.chart.container);D(a.checkbox,"click",function(b){M(a.series||a,"checkboxClick",{checked:b.target.checked,item:a},function(){a.select()})})}});N.legend.itemStyle.cursor="pointer";x(Ca.prototype,{showResetZoom:function(){var a=this,b=N.lang,c=a.options.chart.resetZoomButton,d=c.theme,e=d.states,f=c.relativeTo==="chart"?
null:"plotBox";this.resetZoomButton=a.renderer.button(b.resetZoom,null,null,function(){a.zoomOut()},d,e&&e.hover).attr({align:c.position.align,title:b.resetZoomTitle}).add().align(c.position,!1,f)},zoomOut:function(){var a=this;M(a,"selection",{resetSelection:!0},function(){a.zoom()})},zoom:function(a){var b,c=this.pointer,d=!1,e;!a||a.resetSelection?n(this.axes,function(a){b=a.zoom()}):n(a.xAxis.concat(a.yAxis),function(a){var e=a.axis,h=e.isXAxis;if(c[h?"zoomX":"zoomY"]||c[h?"pinchX":"pinchY"])b=
e.zoom(a.min,a.max),e.displayBtn&&(d=!0)});e=this.resetZoomButton;if(d&&!e)this.showResetZoom();else if(!d&&da(e))this.resetZoomButton=e.destroy();b&&this.redraw(q(this.options.chart.animation,a&&a.animation,this.pointCount<100))},pan:function(a,b){var c=this,d=c.hoverPoints,e;d&&n(d,function(a){a.setState()});n(b==="xy"?[1,0]:[1],function(b){var b=c[b?"xAxis":"yAxis"][0],d=b.horiz,h=a[d?"chartX":"chartY"],d=d?"mouseDownX":"mouseDownY",i=c[d],j=(b.pointRange||0)/2,k=b.getExtremes(),l=b.toValue(i-
h,!0)+j,j=b.toValue(i+b.len-h,!0)-j,i=i>h;if(b.series.length&&(i||l>E(k.dataMin,k.min))&&(!i||j<v(k.dataMax,k.max)))b.setExtremes(l,j,!1,!1,{trigger:"pan"}),e=!0;c[d]=h});e&&c.redraw(!1);F(c.container,{cursor:"move"})}});x(Ha.prototype,{select:function(a,b){var c=this,d=c.series,e=d.chart,a=q(a,!c.selected);c.firePointEvent(a?"select":"unselect",{accumulate:b},function(){c.selected=c.options.selected=a;d.options.data[sa(c,d.data)]=c.options;c.setState(a&&"select");b||n(e.getSelectedPoints(),function(a){if(a.selected&&
a!==c)a.selected=a.options.selected=!1,d.options.data[sa(a,d.data)]=a.options,a.setState(""),a.firePointEvent("unselect")})})},onMouseOver:function(a,b){var c=this.series,d=c.chart,e=d.tooltip,f=d.hoverPoint;if(d.hoverSeries!==c)c.onMouseOver();if(f&&f!==this)f.onMouseOut();if(this.series&&(this.firePointEvent("mouseOver"),e&&(!e.shared||c.noSharedTooltip)&&e.refresh(this,a),this.setState("hover"),!b))d.hoverPoint=this},onMouseOut:function(){var a=this.series.chart,b=a.hoverPoints;this.firePointEvent("mouseOut");
if(!b||sa(this,b)===-1)this.setState(),a.hoverPoint=null},importEvents:function(){if(!this.hasImportedEvents){var a=C(this.series.options.point,this.options).events,b;this.events=a;for(b in a)D(this,b,a[b]);this.hasImportedEvents=!0}},setState:function(a,b){var c=V(this.plotX),d=this.plotY,e=this.series,f=e.options.states,g=W[e.type].marker&&e.options.marker,h=g&&!g.enabled,i=g&&g.states[a],j=i&&i.enabled===!1,k=e.stateMarkerGraphic,l=this.marker||{},m=e.chart,o=e.halo,p,a=a||"";p=this.pointAttr[a]||
e.pointAttr[a];if(!(a===this.state&&!b||this.selected&&a!=="select"||f[a]&&f[a].enabled===!1||a&&(j||h&&i.enabled===!1)||a&&l.states&&l.states[a]&&l.states[a].enabled===!1)){if(this.graphic)g=g&&this.graphic.symbolName&&p.r,this.graphic.attr(C(p,g?{x:c-g,y:d-g,width:2*g,height:2*g}:{})),k&&k.hide();else{if(a&&i)if(g=i.radius,l=l.symbol||e.symbol,k&&k.currentSymbol!==l&&(k=k.destroy()),k)k[b?"animate":"attr"]({x:c-g,y:d-g});else if(l)e.stateMarkerGraphic=k=m.renderer.symbol(l,c-g,d-g,2*g,2*g).attr(p).add(e.markerGroup),
k.currentSymbol=l;if(k)k[a&&m.isInsidePlot(c,d,m.inverted)?"show":"hide"](),k.element.point=this}if((c=f[a]&&f[a].halo)&&c.size){if(!o)e.halo=o=m.renderer.path().add(m.seriesGroup);o.attr(x({fill:this.color||e.color,"fill-opacity":c.opacity,zIndex:-1},c.attributes))[b?"animate":"attr"]({d:this.haloPath(c.size)})}else o&&o.attr({d:[]});this.state=a}},haloPath:function(a){var b=this.series,c=b.chart,d=b.getPlotBox(),e=c.inverted,f=Math.floor(this.plotX);return c.renderer.symbols.circle(d.translateX+
(e?b.yAxis.len-this.plotY:f)-a,d.translateY+(e?b.xAxis.len-f:this.plotY)-a,a*2,a*2)}});x(Q.prototype,{onMouseOver:function(){var a=this.chart,b=a.hoverSeries;if(b&&b!==this)b.onMouseOut();this.options.events.mouseOver&&M(this,"mouseOver");this.setState("hover");a.hoverSeries=this},onMouseOut:function(){var a=this.options,b=this.chart,c=b.tooltip,d=b.hoverPoint;b.hoverSeries=null;if(d)d.onMouseOut();this&&a.events.mouseOut&&M(this,"mouseOut");c&&!a.stickyTracking&&(!c.shared||this.noSharedTooltip)&&
c.hide();this.setState()},setState:function(a){var b=this.options,c=this.graph,d=b.states,e=b.lineWidth,b=0,a=a||"";if(this.state!==a&&(this.state=a,!(d[a]&&d[a].enabled===!1)&&(a&&(e=d[a].lineWidth||e+(d[a].lineWidthPlus||0)),c&&!c.dashstyle))){a={"stroke-width":e};for(c.attr(a);this["zoneGraph"+b];)this["zoneGraph"+b].attr(a),b+=1}},setVisible:function(a,b){var c=this,d=c.chart,e=c.legendItem,f,g=d.options.chart.ignoreHiddenSeries,h=c.visible;f=(c.visible=a=c.userOptions.visible=a===t?!h:a)?"show":
"hide";n(["group","dataLabelsGroup","markerGroup","tracker"],function(a){if(c[a])c[a][f]()});if(d.hoverSeries===c||(d.hoverPoint&&d.hoverPoint.series)===c)c.onMouseOut();e&&d.legend.colorizeItem(c,a);c.isDirty=!0;c.options.stacking&&n(d.series,function(a){if(a.options.stacking&&a.visible)a.isDirty=!0});n(c.linkedSeries,function(b){b.setVisible(a,!1)});if(g)d.isDirtyBox=!0;b!==!1&&d.redraw();M(c,f)},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)},select:function(a){this.selected=
a=a===t?!this.selected:a;if(this.checkbox)this.checkbox.checked=a;M(this,a?"select":"unselect")},drawTracker:nb.drawTrackerGraph});U(Q.prototype,"init",function(a){var b;a.apply(this,Array.prototype.slice.call(arguments,1));(b=this.xAxis)&&b.options.ordinal&&D(this,"updatedData",function(){delete b.ordinalIndex})});U(I.prototype,"getTimeTicks",function(a,b,c,d,e,f,g,h){var i=0,j,k,l={},m,o,p,n=[],q=-Number.MAX_VALUE,v=this.options.tickPixelInterval;if(!this.options.ordinal&&!this.options.breaks||
!f||f.length<3||c===t)return a.call(this,b,c,d,e);o=f.length;for(j=0;j<o;j++){p=j&&f[j-1]>d;f[j]<c&&(i=j);if(j===o-1||f[j+1]-f[j]>g*5||p){if(f[j]>q){for(k=a.call(this,b,f[i],f[j],e);k.length&&k[0]<=q;)k.shift();k.length&&(q=k[k.length-1]);n=n.concat(k)}i=j+1}if(p)break}a=k.info;if(h&&a.unitRange<=H.hour){j=n.length-1;for(i=1;i<j;i++)ma("%d",n[i])!==ma("%d",n[i-1])&&(l[n[i]]="day",m=!0);m&&(l[n[0]]="day");a.higherRanks=l}n.info=a;if(h&&s(v)){h=a=n.length;j=[];var u;for(m=[];h--;)i=this.translate(n[h]),
u&&(m[h]=u-i),j[h]=u=i;m.sort();m=m[V(m.length/2)];m<v*0.6&&(m=null);h=n[a-1]>d?a-1:a;for(u=void 0;h--;)i=j[h],d=u-i,u&&d<v*0.8&&(m===null||d<m*0.8)?(l[n[h]]&&!l[n[h+1]]?(d=h+1,u=i):d=h,n.splice(d,1)):u=i}return n});x(I.prototype,{beforeSetTickPositions:function(){var a,b=[],c=!1,d,e=this.getExtremes(),f=e.min,g=e.max,h,i=this.isXAxis&&!!this.options.breaks;if((e=this.options.ordinal)||i){n(this.series,function(c,d){if(c.visible!==!1&&(c.takeOrdinalPosition!==!1||i))if(b=b.concat(c.processedXData),
a=b.length,b.sort(function(a,b){return a-b}),a)for(d=a-1;d--;)b[d]===b[d+1]&&b.splice(d,1)});a=b.length;if(a>2){d=b[1]-b[0];for(h=a-1;h--&&!c;)b[h+1]-b[h]!==d&&(c=!0);if(!this.options.keepOrdinalPadding&&(b[0]-f>d||g-b[b.length-1]>d))c=!0}c?(this.ordinalPositions=b,d=this.val2lin(v(f,b[0]),!0),h=v(this.val2lin(E(g,b[b.length-1]),!0),1),this.ordinalSlope=g=(g-f)/(h-d),this.ordinalOffset=f-d*g):this.ordinalPositions=this.ordinalSlope=this.ordinalOffset=t}this.isOrdinal=e&&c;this.groupIntervalFactor=
null},val2lin:function(a,b){var c=this.ordinalPositions,d;if(c){var e=c.length,f;for(d=e;d--;)if(c[d]===a){f=d;break}for(d=e-1;d--;)if(a>c[d]||d===0){c=(a-c[d])/(c[d+1]-c[d]);f=d+c;break}d=b?f:this.ordinalSlope*(f||0)+this.ordinalOffset}else d=a;return d},lin2val:function(a,b){var c=this.ordinalPositions;if(c){var d=this.ordinalSlope,e=this.ordinalOffset,f=c.length-1,g,h;if(b)a<0?a=c[0]:a>f?a=c[f]:(f=V(a),h=a-f);else for(;f--;)if(g=d*f+e,a>=g){d=d*(f+1)+e;h=(a-g)/(d-g);break}c=h!==t&&c[f]!==t?c[f]+
(h?h*(c[f+1]-c[f]):0):a}else c=a;return c},getExtendedPositions:function(){var a=this.chart,b=this.series[0].currentDataGrouping,c=this.ordinalIndex,d=b?b.count+b.unitName:"raw",e=this.getExtremes(),f,g;if(!c)c=this.ordinalIndex={};if(!c[d])f={series:[],getExtremes:function(){return{min:e.dataMin,max:e.dataMax}},options:{ordinal:!0},val2lin:I.prototype.val2lin},n(this.series,function(c){g={xAxis:f,xData:c.xData,chart:a,destroyGroupedData:ra};g.options={dataGrouping:b?{enabled:!0,forced:!0,approximation:"open",
units:[[b.unitName,[b.count]]]}:{enabled:!1}};c.processData.apply(g);f.series.push(g)}),this.beforeSetTickPositions.apply(f),c[d]=f.ordinalPositions;return c[d]},getGroupIntervalFactor:function(a,b,c){var d,c=c.processedXData,e=c.length,f=[];d=this.groupIntervalFactor;if(!d){for(d=0;d<e-1;d++)f[d]=c[d+1]-c[d];f.sort(function(a,b){return a-b});f=f[V(e/2)];a=v(a,c[0]);b=E(b,c[e-1]);this.groupIntervalFactor=d=e*f/(b-a)}return d},postProcessTickInterval:function(a){var b=this.ordinalSlope;return b?this.options.breaks?
this.closestPointRange:a/(b/this.closestPointRange):a}});U(Ca.prototype,"pan",function(a,b){var c=this.xAxis[0],d=b.chartX,e=!1;if(c.options.ordinal&&c.series.length){var f=this.mouseDownX,g=c.getExtremes(),h=g.dataMax,i=g.min,j=g.max,k=this.hoverPoints,l=c.closestPointRange,f=(f-d)/(c.translationSlope*(c.ordinalSlope||l)),m={ordinalPositions:c.getExtendedPositions()},l=c.lin2val,o=c.val2lin,p;if(m.ordinalPositions){if(S(f)>1)k&&n(k,function(a){a.setState()}),f<0?(k=m,p=c.ordinalPositions?c:m):(k=
c.ordinalPositions?c:m,p=m),m=p.ordinalPositions,h>m[m.length-1]&&m.push(h),this.fixedRange=j-i,f=c.toFixedRange(null,null,l.apply(k,[o.apply(k,[i,!0])+f,!0]),l.apply(p,[o.apply(p,[j,!0])+f,!0])),f.min>=E(g.dataMin,i)&&f.max<=v(h,j)&&c.setExtremes(f.min,f.max,!0,!1,{trigger:"pan"}),this.mouseDownX=d,F(this.container,{cursor:"move"})}else e=!0}else e=!0;e&&a.apply(this,Array.prototype.slice.call(arguments,1))});Q.prototype.gappedPath=function(){var a=this.options.gapSize,b=this.points.slice(),c=b.length-
1;if(a&&c>0)for(;c--;)b[c+1].x-b[c].x>this.closestPointRange*a&&b.splice(c+1,0,{isNull:!0});return this.getGraphPath(b)};(function(a){a(z)})(function(a){function b(){return Array.prototype.slice.call(arguments,1)}function c(a){a.apply(this);this.drawBreaks(this.xAxis,["x"]);this.drawBreaks(this.yAxis,d(this.pointArrayMap,["y"]))}var d=a.pick,e=a.wrap,f=a.each,g=a.extend,h=a.fireEvent,i=a.Axis,j=a.Series;g(i.prototype,{isInBreak:function(a,b){var c=a.repeat||Infinity,d=a.from,e=a.to-a.from,c=b>=d?
(b-d)%c:c-(d-b)%c;return a.inclusive?c<=e:c<e&&c!==0},isInAnyBreak:function(a,b){var c=this.options.breaks,e=c&&c.length,f,g,h;if(e){for(;e--;)this.isInBreak(c[e],a)&&(f=!0,g||(g=d(c[e].showPoints,this.isXAxis?!1:!0)));h=f&&b?f&&!g:f}return h}});e(i.prototype,"setTickPositions",function(a){a.apply(this,Array.prototype.slice.call(arguments,1));if(this.options.breaks){var b=this.tickPositions,c=this.tickPositions.info,d=[],e;for(e=0;e<b.length;e++)this.isInAnyBreak(b[e])||d.push(b[e]);this.tickPositions=
d;this.tickPositions.info=c}});e(i.prototype,"init",function(a,b,c){if(c.breaks&&c.breaks.length)c.ordinal=!1;a.call(this,b,c);if(this.options.breaks){var d=this;d.isBroken=!0;this.val2lin=function(a){var b=a,c,e;for(e=0;e<d.breakArray.length;e++)if(c=d.breakArray[e],c.to<=a)b-=c.len;else if(c.from>=a)break;else if(d.isInBreak(c,a)){b-=a-c.from;break}return b};this.lin2val=function(a){var b,c;for(c=0;c<d.breakArray.length;c++)if(b=d.breakArray[c],b.from>=a)break;else b.to<a?a+=b.len:d.isInBreak(b,
a)&&(a+=b.len);return a};this.setExtremes=function(a,b,c,d,e){for(;this.isInAnyBreak(a);)a-=this.closestPointRange;for(;this.isInAnyBreak(b);)b-=this.closestPointRange;i.prototype.setExtremes.call(this,a,b,c,d,e)};this.setAxisTranslation=function(a){i.prototype.setAxisTranslation.call(this,a);var b=d.options.breaks,a=[],c=[],e=0,f,g,k=d.userMin||d.min,j=d.userMax||d.max,l,m;for(m in b)g=b[m],f=g.repeat||Infinity,d.isInBreak(g,k)&&(k+=g.to%f-k%f),d.isInBreak(g,j)&&(j-=j%f-g.from%f);for(m in b){g=b[m];
l=g.from;for(f=g.repeat||Infinity;l-f>k;)l-=f;for(;l<k;)l+=f;for(;l<j;l+=f)a.push({value:l,move:"in"}),a.push({value:l+(g.to-g.from),move:"out",size:g.breakSize})}a.sort(function(a,b){return a.value===b.value?(a.move==="in"?0:1)-(b.move==="in"?0:1):a.value-b.value});b=0;l=k;for(m in a){g=a[m];b+=g.move==="in"?1:-1;if(b===1&&g.move==="in")l=g.value;b===0&&(c.push({from:l,to:g.value,len:g.value-l-(g.size||0)}),e+=g.value-l-(g.size||0))}d.breakArray=c;h(d,"afterBreaks");d.transA*=(j-d.min)/(j-k-e);d.min=
k;d.max=j}}});e(j.prototype,"generatePoints",function(a){a.apply(this,b(arguments));var c=this.xAxis,d=this.yAxis,e=this.points,f,g=e.length,h=this.options.connectNulls,i;if(c&&d&&(c.options.breaks||d.options.breaks))for(;g--;)if(f=e[g],i=f.y===null&&h===!1,!i&&(c.isInAnyBreak(f.x,!0)||d.isInAnyBreak(f.y,!0)))e.splice(g,1),this.data[g]&&this.data[g].destroyElements()});a.Series.prototype.drawBreaks=function(a,b){var c=this,e=c.points,g,i,j,n;f(b,function(b){g=a.breakArray||[];i=a.isXAxis?a.min:d(c.options.threshold,
a.min);f(e,function(c){n=d(c["stack"+b.toUpperCase()],c[b]);f(g,function(b){j=!1;if(i<b.from&&n>b.to||i>b.from&&n<b.from)j="pointBreak";else if(i<b.from&&n>b.from&&n<b.to||i>b.from&&n>b.to&&n<b.from)j="pointInBreak";j&&h(a,j,{point:c,brk:b})})})})};e(a.seriesTypes.column.prototype,"drawPoints",c);e(a.Series.prototype,"drawPoints",c)});var ia=Q.prototype,cc=ia.processData,dc=ia.generatePoints,ec=ia.destroy,fc={approximation:"average",groupPixelWidth:2,dateTimeLabelFormats:{millisecond:["%A, %b %e, %H:%M:%S.%L",
"%A, %b %e, %H:%M:%S.%L","-%H:%M:%S.%L"],second:["%A, %b %e, %H:%M:%S","%A, %b %e, %H:%M:%S","-%H:%M:%S"],minute:["%A, %b %e, %H:%M","%A, %b %e, %H:%M","-%H:%M"],hour:["%A, %b %e, %H:%M","%A, %b %e, %H:%M","-%H:%M"],day:["%A, %b %e, %Y","%A, %b %e","-%A, %b %e, %Y"],week:["Week from %A, %b %e, %Y","%A, %b %e","-%A, %b %e, %Y"],month:["%B %Y","%B","-%B %Y"],year:["%Y","%Y","-%Y"]}},Xb={line:{},spline:{},area:{},areaspline:{},column:{approximation:"sum",groupPixelWidth:10},arearange:{approximation:"range"},
areasplinerange:{approximation:"range"},columnrange:{approximation:"range",groupPixelWidth:10},candlestick:{approximation:"ohlc",groupPixelWidth:10},ohlc:{approximation:"ohlc",groupPixelWidth:5}},Yb=[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1]],["week",[1]],["month",[1,3,6]],["year",null]],Ua={sum:function(a){var b=a.length,c;if(!b&&a.hasNulls)c=null;else if(b)for(c=0;b--;)c+=a[b];return c},average:function(a){var b=
a.length,a=Ua.sum(a);typeof a==="number"&&b&&(a/=b);return a},open:function(a){return a.length?a[0]:a.hasNulls?null:t},high:function(a){return a.length?Ea(a):a.hasNulls?null:t},low:function(a){return a.length?Oa(a):a.hasNulls?null:t},close:function(a){return a.length?a[a.length-1]:a.hasNulls?null:t},ohlc:function(a,b,c,d){a=Ua.open(a);b=Ua.high(b);c=Ua.low(c);d=Ua.close(d);if(typeof a==="number"||typeof b==="number"||typeof c==="number"||typeof d==="number")return[a,b,c,d]},range:function(a,b){a=
Ua.low(a);b=Ua.high(b);if(typeof a==="number"||typeof b==="number")return[a,b]}};ia.groupData=function(a,b,c,d){var e=this.data,f=this.options.data,g=[],h=[],i=[],j=a.length,k,l,m=!!b,o=[[],[],[],[]],d=typeof d==="function"?d:Ua[d],p=this.pointArrayMap,n=p&&p.length,q,s=0;for(q=0;q<=j;q++)if(a[q]>=c[0])break;for(;q<=j;q++){for(;c[1]!==t&&a[q]>=c[1]||q===j;)if(k=c.shift(),l=d.apply(0,o),l!==t&&(g.push(k),h.push(l),i.push({start:s,length:o[0].length})),s=q,o[0]=[],o[1]=[],o[2]=[],o[3]=[],q===j)break;
if(q===j)break;if(p){k=this.cropStart+q;k=e&&e[k]||this.pointClass.prototype.applyOptions.apply({series:this},[f[k]]);var u;for(l=0;l<n;l++)if(u=k[p[l]],typeof u==="number")o[l].push(u);else if(u===null)o[l].hasNulls=!0}else if(k=m?b[q]:null,typeof k==="number")o[0].push(k);else if(k===null)o[0].hasNulls=!0}return[g,h,i]};ia.processData=function(){var a=this.chart,b=this.options.dataGrouping,c=this.allowDG!==!1&&b&&q(b.enabled,a.options._stock),d;this.forceCrop=c;this.groupPixelWidth=null;this.hasProcessed=
!0;if(cc.apply(this,arguments)!==!1&&c){this.destroyGroupedData();var e=this.processedXData,f=this.processedYData,g=a.plotSizeX,a=this.xAxis,h=a.options.ordinal,i=this.groupPixelWidth=a.getGroupPixelWidth&&a.getGroupPixelWidth();if(i){d=!0;this.points=null;var j=a.getExtremes(),c=j.min,j=j.max,h=h&&a.getGroupIntervalFactor(c,j,this)||1,g=i*(j-c)/g*h,i=a.getTimeTicks(a.normalizeTimeTickInterval(g,b.units||Yb),Math.min(c,e[0]),Math.max(j,e[e.length-1]),a.options.startOfWeek,e,this.closestPointRange),
e=ia.groupData.apply(this,[e,f,i,b.approximation]),f=e[0],h=e[1];if(b.smoothed){b=f.length-1;for(f[b]=Math.min(f[b],j);b--&&b>0;)f[b]+=g/2;f[0]=Math.max(f[0],c)}this.currentDataGrouping=i.info;this.closestPointRange=i.info.totalRange;this.groupMap=e[2];if(s(f[0])&&f[0]<a.dataMin){if(a.min===a.dataMin)a.min=f[0];a.dataMin=f[0]}this.processedXData=f;this.processedYData=h}else this.currentDataGrouping=this.groupMap=null;this.hasGroupedData=d}};ia.destroyGroupedData=function(){var a=this.groupedData;
n(a||[],function(b,c){b&&(a[c]=b.destroy?b.destroy():null)});this.groupedData=null};ia.generatePoints=function(){dc.apply(this);this.destroyGroupedData();this.groupedData=this.hasGroupedData?this.points:null};U(Lb.prototype,"tooltipFooterHeaderFormatter",function(a,b,c){var d=b.series,e=d.tooltipOptions,f=d.options.dataGrouping,g=e.xDateFormat,h,i=d.xAxis;return i&&i.options.type==="datetime"&&f&&ua(b.key)?(a=d.currentDataGrouping,f=f.dateTimeLabelFormats,a?(i=f[a.unitName],a.count===1?g=i[0]:(g=
i[1],h=i[2])):!g&&f&&(g=this.getXDateFormat(b,e,i)),g=ma(g,b.key),h&&(g+=ma(h,b.key+a.totalRange-1)),La(e[(c?"footer":"header")+"Format"],{point:x(b,{key:g}),series:d})):a.call(this,b,c)});ia.destroy=function(){for(var a=this.groupedData||[],b=a.length;b--;)a[b]&&a[b].destroy();ec.apply(this)};U(ia,"setOptions",function(a,b){var c=a.call(this,b),d=this.type,e=this.chart.options.plotOptions,f=W[d].dataGrouping;if(Xb[d])f||(f=C(fc,Xb[d])),c.dataGrouping=C(f,e.series&&e.series.dataGrouping,e[d].dataGrouping,
b.dataGrouping);if(this.chart.options._stock)this.requireSorting=!0;return c});U(I.prototype,"setScale",function(a){a.call(this);n(this.series,function(a){a.hasProcessed=!1})});I.prototype.getGroupPixelWidth=function(){var a=this.series,b=a.length,c,d=0,e=!1,f;for(c=b;c--;)(f=a[c].options.dataGrouping)&&(d=v(d,f.groupPixelWidth));for(c=b;c--;)if((f=a[c].options.dataGrouping)&&a[c].hasProcessed)if(b=(a[c].processedXData||a[c].data).length,a[c].groupPixelWidth||b>this.chart.plotSizeX/d||b&&f.forced)e=
!0;return e?d:0};I.prototype.setDataGrouping=function(a,b){var c,b=q(b,!0);a||(a={forced:!1,units:null});if(this instanceof I)for(c=this.series.length;c--;)this.series[c].update({dataGrouping:a},!1);else n(this.chart.options.series,function(b){b.dataGrouping=a},!1);b&&this.chart.redraw()};W.ohlc=C(W.column,{lineWidth:1,tooltip:{pointFormat:'<span style="color:{point.color}">\u25cf</span> <b> {series.name}</b><br/>Open: {point.open}<br/>High: {point.high}<br/>Low: {point.low}<br/>Close: {point.close}<br/>'},
states:{hover:{lineWidth:3}},threshold:null});ca=la(K.column,{type:"ohlc",pointArrayMap:["open","high","low","close"],toYData:function(a){return[a.open,a.high,a.low,a.close]},pointValKey:"high",pointAttrToOptions:{stroke:"color","stroke-width":"lineWidth"},upColorProp:"stroke",getAttribs:function(){K.column.prototype.getAttribs.apply(this,arguments);var a=this.options,b=a.states,a=a.upColor||this.color,c=C(this.pointAttr),d=this.upColorProp;c[""][d]=a;c.hover[d]=b.hover.upColor||a;c.select[d]=b.select.upColor||
a;n(this.points,function(a){if(a.open<a.close&&!a.options.color)a.pointAttr=c})},translate:function(){var a=this.yAxis;K.column.prototype.translate.apply(this);n(this.points,function(b){if(b.open!==null)b.plotOpen=a.translate(b.open,0,1,0,1);if(b.close!==null)b.plotClose=a.translate(b.close,0,1,0,1)})},drawPoints:function(){var a=this,b=a.chart,c,d,e,f,g,h,i,j;n(a.points,function(k){if(k.plotY!==t)i=k.graphic,c=k.pointAttr[k.selected?"selected":""]||a.pointAttr[""],f=c["stroke-width"]%2/2,j=y(k.plotX)-
f,g=y(k.shapeArgs.width/2),h=["M",j,y(k.yBottom),"L",j,y(k.plotY)],k.open!==null&&(d=y(k.plotOpen)+f,h.push("M",j,d,"L",j-g,d)),k.close!==null&&(e=y(k.plotClose)+f,h.push("M",j,e,"L",j+g,e)),i?i.attr(c).animate({d:h}):k.graphic=b.renderer.path(h).attr(c).add(a.group)})},animate:null});K.ohlc=ca;W.candlestick=C(W.column,{lineColor:"black",lineWidth:1,states:{hover:{lineWidth:2}},tooltip:W.ohlc.tooltip,threshold:null,upColor:"white"});ca=la(ca,{type:"candlestick",pointAttrToOptions:{fill:"color",stroke:"lineColor",
"stroke-width":"lineWidth"},upColorProp:"fill",getAttribs:function(){K.ohlc.prototype.getAttribs.apply(this,arguments);var a=this.options,b=a.states,c=a.upLineColor||a.lineColor,d=b.hover.upLineColor||c,e=b.select.upLineColor||c;n(this.points,function(a){if(a.open<a.close){if(a.lineColor)a.pointAttr=C(a.pointAttr),c=a.lineColor;a.pointAttr[""].stroke=c;a.pointAttr.hover.stroke=d;a.pointAttr.select.stroke=e}})},drawPoints:function(){var a=this,b=a.chart,c,d=a.pointAttr[""],e,f,g,h,i,j,k,l,m,o,p;n(a.points,
function(n){m=n.graphic;if(n.plotY!==t)c=n.pointAttr[n.selected?"selected":""]||d,k=c["stroke-width"]%2/2,l=y(n.plotX)-k,e=n.plotOpen,f=n.plotClose,g=Y.min(e,f),h=Y.max(e,f),p=y(n.shapeArgs.width/2),i=y(g)!==y(n.plotY),j=h!==n.yBottom,g=y(g)+k,h=y(h)+k,o=["M",l-p,h,"L",l-p,g,"L",l+p,g,"L",l+p,h,"Z","M",l,g,"L",l,i?y(n.plotY):g,"M",l,h,"L",l,j?y(n.yBottom):h],m?m.attr(c).animate({d:o}):n.graphic=b.renderer.path(o).attr(c).add(a.group).shadow(a.options.shadow)})}});K.candlestick=ca;var wb=ya.prototype.symbols;
W.flags=C(W.column,{fillColor:"white",lineWidth:1,pointRange:0,shape:"flag",stackDistance:12,states:{hover:{lineColor:"black",fillColor:"#FCFFC5"}},style:{fontSize:"11px",fontWeight:"bold",textAlign:"center"},tooltip:{pointFormat:"{point.text}<br/>"},threshold:null,y:-30});K.flags=la(K.column,{type:"flags",sorted:!1,noSharedTooltip:!0,allowDG:!1,takeOrdinalPosition:!1,trackerGroups:["markerGroup"],forceCrop:!0,init:Q.prototype.init,pointAttrToOptions:{fill:"fillColor",stroke:"color","stroke-width":"lineWidth",
r:"radius"},translate:function(){K.column.prototype.translate.apply(this);var a=this.options,b=this.chart,c=this.points,d=c.length-1,e,f,g=a.onSeries;e=g&&b.get(g);var a=a.onKey||"y",g=e&&e.options.step,h=e&&e.points,i=h&&h.length,j=this.xAxis,k=j.getExtremes(),l,m,o;if(e&&e.visible&&i){e=e.currentDataGrouping;m=h[i-1].x+(e?e.totalRange:0);c.sort(function(a,b){return a.x-b.x});for(a="plot"+a[0].toUpperCase()+a.substr(1);i--&&c[d];)if(e=c[d],l=h[i],l.x<=e.x&&l[a]!==void 0){if(e.x<=m)e.plotY=l[a],l.x<
e.x&&!g&&(o=h[i+1])&&o[a]!==t&&(e.plotY+=(e.x-l.x)/(o.x-l.x)*(o[a]-l[a]));d--;i++;if(d<0)break}}n(c,function(a,d){var e;if(a.plotY===t)a.x>=k.min&&a.x<=k.max?a.plotY=b.chartHeight-j.bottom-(j.opposite?j.height:0)+j.offset-b.plotTop:a.shapeArgs={};if((f=c[d-1])&&f.plotX===a.plotX){if(f.stackIndex===t)f.stackIndex=0;e=f.stackIndex+1}a.stackIndex=e})},drawPoints:function(){var a,b=this.pointAttr[""],c=this.points,d=this.chart,e=d.renderer,f,g,h=this.options,i=h.y,j,k,l,m,o,n,r=this.yAxis;for(k=c.length;k--;)if(l=
c[k],a=l.plotX>this.xAxis.len,f=l.plotX,f>0&&(f-=q(l.lineWidth,h.lineWidth)%2),m=l.stackIndex,j=l.options.shape||h.shape,g=l.plotY,g!==t&&(g=l.plotY+i-(m!==t&&m*h.stackDistance)),o=m?t:l.plotX,n=m?t:l.plotY,m=l.graphic,g!==t&&f>=0&&!a)a=l.pointAttr[l.selected?"select":""]||b,m?m.attr({x:f,y:g,r:a.r,anchorX:o,anchorY:n}):l.graphic=e.label(l.options.title||h.title||"A",f,g,j,o,n,h.useHTML).css(C(h.style,l.style)).attr(a).attr({align:j==="flag"?"left":"center",width:h.width,height:h.height}).add(this.markerGroup).shadow(h.shadow),
l.tooltipPos=d.inverted?[r.len+r.pos-d.plotLeft-g,this.xAxis.len-f]:[f,g];else if(m)l.graphic=m.destroy()},drawTracker:function(){var a=this.points;nb.drawTrackerPoint.apply(this);n(a,function(b){var c=b.graphic;c&&D(c.element,"mouseover",function(){if(b.stackIndex>0&&!b.raised)b._y=c.y,c.attr({y:b._y-8}),b.raised=!0;n(a,function(a){if(a!==b&&a.raised&&a.graphic)a.graphic.attr({y:a._y}),a.raised=!1})})})},animate:ra,buildKDTree:ra,setClip:ra});wb.flag=function(a,b,c,d,e){return["M",e&&e.anchorX||
a,e&&e.anchorY||b,"L",a,b+d,a,b,a+c,b,a+c,b+d,a,b+d,"Z"]};n(["circle","square"],function(a){wb[a+"pin"]=function(b,c,d,e,f){var g=f&&f.anchorX,f=f&&f.anchorY;a==="circle"&&e>d&&(b-=y((e-d)/2),d=e);b=wb[a](b,c,d,e);g&&f&&b.push("M",g,c>f?c:c+e,"L",g,f);return b}});Ya===z.VMLRenderer&&n(["flag","circlepin","squarepin"],function(a){mb.prototype.symbols[a]=wb[a]});var ca=[].concat(Yb),xb=function(a){var b=Sa(arguments,function(a){return typeof a==="number"});if(b.length)return Math[a].apply(0,b)};ca[4]=
["day",[1,2,3,4]];ca[5]=["week",[1,2,3]];x(N,{navigator:{handles:{backgroundColor:"#ebe7e8",borderColor:"#b2b1b6"},height:40,margin:25,maskFill:"rgba(128,179,236,0.3)",maskInside:!0,outlineColor:"#b2b1b6",outlineWidth:1,series:{type:K.areaspline===t?"line":"areaspline",color:"#4572A7",compare:null,fillOpacity:0.05,dataGrouping:{approximation:"average",enabled:!0,groupPixelWidth:2,smoothed:!0,units:ca},dataLabels:{enabled:!1,zIndex:2},id:"highcharts-navigator-series",lineColor:null,lineWidth:1,marker:{enabled:!1},
pointRange:0,shadow:!1,threshold:null},xAxis:{tickWidth:0,lineWidth:0,gridLineColor:"#EEE",gridLineWidth:1,tickPixelInterval:200,labels:{align:"left",style:{color:"#888"},x:3,y:-4},crosshair:!1},yAxis:{gridLineWidth:0,startOnTick:!1,endOnTick:!1,minPadding:0.1,maxPadding:0.1,labels:{enabled:!1},crosshair:!1,title:{text:null},tickWidth:0}},scrollbar:{height:kb?20:14,barBackgroundColor:"#bfc8d1",barBorderRadius:0,barBorderWidth:1,barBorderColor:"#bfc8d1",buttonArrowColor:"#666",buttonBackgroundColor:"#ebe7e8",
buttonBorderColor:"#bbb",buttonBorderRadius:0,buttonBorderWidth:1,minWidth:6,rifleColor:"#666",trackBackgroundColor:"#eeeeee",trackBorderColor:"#eeeeee",trackBorderWidth:1,liveRedraw:ja&&!kb}});Hb.prototype={drawHandle:function(a,b){var c=this.chart,d=c.renderer,e=this.elementsToDestroy,f=this.handles,g=this.navigatorOptions.handles,g={fill:g.backgroundColor,stroke:g.borderColor,"stroke-width":1},h;this.rendered||(f[b]=d.g("navigator-handle-"+["left","right"][b]).css({cursor:"ew-resize"}).attr({zIndex:10-
b}).add(),h=d.rect(-4.5,0,9,16,0,1).attr(g).add(f[b]),e.push(h),h=d.path(["M",-1.5,4,"L",-1.5,12,"M",0.5,4,"L",0.5,12]).attr(g).add(f[b]),e.push(h));f[b][c.isResizing?"animate":"attr"]({translateX:this.scrollerLeft+this.scrollbarHeight+parseInt(a,10),translateY:this.top+this.height/2-8})},drawScrollbarButton:function(a){var b=this.chart.renderer,c=this.elementsToDestroy,d=this.scrollbarButtons,e=this.scrollbarHeight,f=this.scrollbarOptions,g;this.rendered||(d[a]=b.g().add(this.scrollbarGroup),g=b.rect(-0.5,
-0.5,e+1,e+1,f.buttonBorderRadius,f.buttonBorderWidth).attr({stroke:f.buttonBorderColor,"stroke-width":f.buttonBorderWidth,fill:f.buttonBackgroundColor}).add(d[a]),c.push(g),g=b.path(["M",e/2+(a?-1:1),e/2-3,"L",e/2+(a?-1:1),e/2+3,e/2+(a?2:-2),e/2]).attr({fill:f.buttonArrowColor}).add(d[a]),c.push(g));a&&d[a].attr({translateX:this.scrollerWidth-e})},render:function(a,b,c,d){var e=this.chart,f=e.renderer,g,h,i,j,k=this.scrollbarGroup,l=this.navigatorGroup,m=this.scrollbar,l=this.xAxis,o=this.scrollbarTrack,
n=this.scrollbarHeight,r=this.scrollbarEnabled,A=this.navigatorOptions,t=this.scrollbarOptions,u=t.minWidth,w=this.height,x=this.top,z=this.navigatorEnabled,C=A.outlineWidth,B=C/2,D=0,G=this.outlineHeight,I=t.barBorderRadius,H=t.barBorderWidth,F=x+B,J;if(s(a)&&!isNaN(a)&&s(b)&&!(isNaN(b)||this.hasDragged&&!s(c))){this.navigatorLeft=g=q(l.left,e.plotLeft+n);this.navigatorWidth=h=q(l.len,e.plotWidth-2*n);this.scrollerLeft=i=g-n;this.scrollerWidth=j=j=h+2*n;l.getExtremes&&(J=this.getUnionExtremes(!0))&&
(J.dataMin!==l.min||J.dataMax!==l.max)&&l.setExtremes(J.dataMin,J.dataMax,!0,!1);c=q(c,l.translate(a));d=q(d,l.translate(b));if(isNaN(c)||S(c)===Infinity)c=0,d=j;if(!(l.translate(d,!0)-l.translate(c,!0)<e.xAxis[0].minRange)){this.zoomedMax=E(v(c,d,0),h);this.zoomedMin=E(v(this.fixedWidth?this.zoomedMax-this.fixedWidth:E(c,d),0),h);this.range=this.zoomedMax-this.zoomedMin;c=y(this.zoomedMax);b=y(this.zoomedMin);a=c-b;if(!this.rendered){if(z)this.navigatorGroup=l=f.g("navigator").attr({zIndex:3}).add(),
this.leftShade=f.rect().attr({fill:A.maskFill}).add(l),A.maskInside?this.leftShade.css({cursor:"ew-resize"}):this.rightShade=f.rect().attr({fill:A.maskFill}).add(l),this.outline=f.path().attr({"stroke-width":C,stroke:A.outlineColor}).add(l);if(r)this.scrollbarGroup=k=f.g("scrollbar").add(),m=t.trackBorderWidth,this.scrollbarTrack=o=f.rect().attr({x:0,y:-m%2/2,fill:t.trackBackgroundColor,stroke:t.trackBorderColor,"stroke-width":m,r:t.trackBorderRadius||0,height:n}).add(k),this.scrollbar=m=f.rect().attr({y:-H%
2/2,height:n,fill:t.barBackgroundColor,stroke:t.barBorderColor,"stroke-width":H,r:I}).add(k),this.scrollbarRifles=f.path().attr({stroke:t.rifleColor,"stroke-width":1}).add(k)}e=e.isResizing?"animate":"attr";if(z){this.leftShade[e](A.maskInside?{x:g+b,y:x,width:c-b,height:w}:{x:g,y:x,width:b,height:w});if(this.rightShade)this.rightShade[e]({x:g+c,y:x,width:h-c,height:w});this.outline[e]({d:["M",i,F,"L",g+b-B,F,g+b-B,F+G,"L",g+c-B,F+G,"L",g+c-B,F,i+j,F].concat(A.maskInside?["M",g+b+B,F,"L",g+c-B,F]:
[])});this.drawHandle(b+B,0);this.drawHandle(c+B,1)}if(r&&k)this.drawScrollbarButton(0),this.drawScrollbarButton(1),k[e]({translateX:i,translateY:y(F+w)}),o[e]({width:j}),g=n+b,h=a-H,h<u&&(D=(u-h)/2,h=u,g-=D),this.scrollbarPad=D,m[e]({x:V(g)+H%2/2,width:h}),u=n+b+a/2-0.5,this.scrollbarRifles.attr({visibility:a>12?"visible":"hidden"})[e]({d:["M",u-3,n/4,"L",u-3,2*n/3,"M",u,n/4,"L",u,2*n/3,"M",u+3,n/4,"L",u+3,2*n/3]});this.scrollbarPad=D;this.rendered=!0}}},addEvents:function(){var a=this.chart.container,
b=this.mouseDownHandler,c=this.mouseMoveHandler,d=this.mouseUpHandler,e;e=[[a,"mousedown",b],[a,"mousemove",c],[B,"mouseup",d]];db&&e.push([a,"touchstart",b],[a,"touchmove",c],[B,"touchend",d]);n(e,function(a){D.apply(null,a)});this._events=e},removeEvents:function(){n(this._events,function(a){T.apply(null,a)});this._events=t;this.navigatorEnabled&&this.baseSeries&&T(this.baseSeries,"updatedData",this.updatedDataHandler)},init:function(){var a=this,b=a.chart,c,d,e=a.scrollbarHeight,f=a.navigatorOptions,
g=a.height,h=a.top,i,j=a.baseSeries;a.mouseDownHandler=function(d){var d=b.pointer.normalize(d),e=a.zoomedMin,f=a.zoomedMax,h=a.top,j=a.scrollbarHeight,k=a.scrollerLeft,l=a.scrollerWidth,n=a.navigatorLeft,q=a.navigatorWidth,s=a.scrollbarPad,t=a.range,v=d.chartX,x=d.chartY,d=b.xAxis[0],y,z=kb?10:7;if(x>h&&x<h+g+j)if((h=!a.scrollbarEnabled||x<h+g)&&Y.abs(v-e-n)<z)a.grabbedLeft=!0,a.otherHandlePos=f,a.fixedExtreme=d.max,b.fixedRange=null;else if(h&&Y.abs(v-f-n)<z)a.grabbedRight=!0,a.otherHandlePos=e,
a.fixedExtreme=d.min,b.fixedRange=null;else if(v>n+e-s&&v<n+f+s)a.grabbedCenter=v,a.fixedWidth=t,i=v-e;else if(v>k&&v<k+l){f=h?v-n-t/2:v<n?e-t*0.2:v>k+l-j?e+t*0.2:v<n+e?e-t:f;if(f<0)f=0;else if(f+t>=q)f=q-t,y=a.getUnionExtremes().dataMax;if(f!==e)a.fixedWidth=t,e=c.toFixedRange(f,f+t,null,y),d.setExtremes(e.min,e.max,!0,!1,{trigger:"navigator"})}};a.mouseMoveHandler=function(c){var d=a.scrollbarHeight,e=a.navigatorLeft,f=a.navigatorWidth,g=a.scrollerLeft,h=a.scrollerWidth,j=a.range,k,l;if(!c.touches||
c.touches[0].pageX!==0)c=b.pointer.normalize(c),k=c.chartX,k<e?k=e:k>g+h-d&&(k=g+h-d),a.grabbedLeft?(l=!0,a.render(0,0,k-e,a.otherHandlePos)):a.grabbedRight?(l=!0,a.render(0,0,a.otherHandlePos,k-e)):a.grabbedCenter&&(l=!0,k<i?k=i:k>f+i-j&&(k=f+i-j),a.render(0,0,k-i,k-i+j)),l&&a.scrollbarOptions.liveRedraw&&setTimeout(function(){a.mouseUpHandler(c)},0),a.hasDragged=l};a.mouseUpHandler=function(d){var e,f;if(a.hasDragged){if(a.zoomedMin===a.otherHandlePos)e=a.fixedExtreme;else if(a.zoomedMax===a.otherHandlePos)f=
a.fixedExtreme;if(a.zoomedMax===a.navigatorWidth)f=a.getUnionExtremes().dataMax;e=c.toFixedRange(a.zoomedMin,a.zoomedMax,e,f);s(e.min)&&b.xAxis[0].setExtremes(e.min,e.max,!0,!1,{trigger:"navigator",triggerOp:"navigator-drag",DOMEvent:d})}if(d.type!=="mousemove")a.grabbedLeft=a.grabbedRight=a.grabbedCenter=a.fixedWidth=a.fixedExtreme=a.otherHandlePos=a.hasDragged=i=null};var k=b.xAxis.length,l=b.yAxis.length;b.extraBottomMargin=a.outlineHeight+f.margin;a.navigatorEnabled?(a.xAxis=c=new I(b,C({breaks:j&&
j.xAxis.options.breaks,ordinal:j&&j.xAxis.options.ordinal},f.xAxis,{id:"navigator-x-axis",isX:!0,type:"datetime",index:k,height:g,offset:0,offsetLeft:e,offsetRight:-e,keepOrdinalPadding:!0,startOnTick:!1,endOnTick:!1,minPadding:0,maxPadding:0,zoomEnabled:!1})),a.yAxis=d=new I(b,C(f.yAxis,{id:"navigator-y-axis",alignTicks:!1,height:g,offset:0,index:l,zoomEnabled:!1})),j||f.series.data?a.addBaseSeries():b.series.length===0&&U(b,"redraw",function(c,d){if(b.series.length>0&&!a.series)a.setBaseSeries(),
b.redraw=c;c.call(b,d)})):a.xAxis=c={translate:function(a,c){var d=b.xAxis[0],f=d.getExtremes(),g=b.plotWidth-2*e,h=xb("min",d.options.min,f.dataMin),d=xb("max",d.options.max,f.dataMax)-h;return c?a*d/g+h:g*(a-h)/d},toFixedRange:I.prototype.toFixedRange};U(b,"getMargins",function(b){var e=this.legend,f=e.options;b.apply(this,[].slice.call(arguments,1));a.top=h=a.navigatorOptions.top||this.chartHeight-a.height-a.scrollbarHeight-this.spacing[2]-(f.verticalAlign==="bottom"&&f.enabled&&!f.floating?e.legendHeight+
q(f.margin,10):0);if(c&&d)c.options.top=d.options.top=h,c.setAxisSize(),d.setAxisSize()});a.addEvents()},getUnionExtremes:function(a){var b=this.chart.xAxis[0],c=this.xAxis,d=c.options,e=b.options,f;if(!a||b.dataMin!==null)f={dataMin:q(d&&d.min,xb("min",e.min,b.dataMin,c.dataMin)),dataMax:q(d&&d.max,xb("max",e.max,b.dataMax,c.dataMax))};return f},setBaseSeries:function(a){var b=this.chart,a=a||b.options.navigator.baseSeries;this.series&&this.series.remove();this.baseSeries=b.series[a]||typeof a===
"string"&&b.get(a)||b.series[0];this.xAxis&&this.addBaseSeries()},addBaseSeries:function(){var a=this.baseSeries,b=a?a.options:{},c=b.data,d=this.navigatorOptions.series,e;e=d.data;this.hasNavigatorData=!!e;b=C(b,d,{enableMouseTracking:!1,group:"nav",padXAxis:!1,xAxis:"navigator-x-axis",yAxis:"navigator-y-axis",name:"Navigator",showInLegend:!1,stacking:!1,isInternal:!0,visible:!0});b.data=e||c.slice(0);this.series=this.chart.initSeries(b);if(a&&this.navigatorOptions.adaptToUpdatedData!==!1)D(a,"updatedData",
this.updatedDataHandler),a.userOptions.events=x(a.userOptions.event,{updatedData:this.updatedDataHandler})},updatedDataHandler:function(){var a=this.chart.scroller,b=a.baseSeries,c=b.xAxis,d=c.getExtremes(),e=d.min,f=d.max,g=d.dataMin,d=d.dataMax,h=f-e,i,j,k,l,m,o=a.series;i=o.xData;var n=!!c.setExtremes;j=f>=i[i.length-1]-(this.closestPointRange||0);i=e<=g;if(!a.hasNavigatorData)o.options.pointStart=b.xData[0],o.setData(b.options.data,!1),m=!0;i&&(l=g,k=l+h);j&&(k=d,i||(l=v(k-h,o.xData[0])));n&&
(i||j)?isNaN(l)||c.setExtremes(l,k,!0,!1,{trigger:"updatedData"}):(m&&this.chart.redraw(!1),a.render(v(e,g),E(f,d)))},destroy:function(){this.removeEvents();n([this.xAxis,this.yAxis,this.leftShade,this.rightShade,this.outline,this.scrollbarTrack,this.scrollbarRifles,this.scrollbarGroup,this.scrollbar],function(a){a&&a.destroy&&a.destroy()});this.xAxis=this.yAxis=this.leftShade=this.rightShade=this.outline=this.scrollbarTrack=this.scrollbarRifles=this.scrollbarGroup=this.scrollbar=null;n([this.scrollbarButtons,
this.handles,this.elementsToDestroy],function(a){Pa(a)})}};z.Scroller=Hb;U(I.prototype,"zoom",function(a,b,c){var d=this.chart,e=d.options,f=e.chart.zoomType,g=e.navigator,e=e.rangeSelector,h;if(this.isXAxis&&(g&&g.enabled||e&&e.enabled))if(f==="x")d.resetZoomButton="blocked";else if(f==="y")h=!1;else if(f==="xy")d=this.previousZoom,s(b)?this.previousZoom=[this.min,this.max]:d&&(b=d[0],c=d[1],delete this.previousZoom);return h!==t?h:a.call(this,b,c)});U(Ca.prototype,"init",function(a,b,c){D(this,
"beforeRender",function(){var a=this.options;if(a.navigator.enabled||a.scrollbar.enabled)this.scroller=new Hb(this)});a.call(this,b,c)});U(Q.prototype,"addPoint",function(a,b,c,d,e){var f=this.options.turboThreshold;f&&this.xData.length>f&&da(b)&&!Ja(b)&&this.chart.scroller&&ga(20,!0);a.call(this,b,c,d,e)});x(N,{rangeSelector:{buttonTheme:{width:28,height:18,fill:"#f7f7f7",padding:2,r:0,"stroke-width":0,style:{color:"#444",cursor:"pointer",fontWeight:"normal"},zIndex:7,states:{hover:{fill:"#e7e7e7"},
select:{fill:"#e7f0f9",style:{color:"black",fontWeight:"bold"}}}},height:35,inputPosition:{align:"right"},labelStyle:{color:"#666"}}});N.lang=C(N.lang,{rangeSelectorZoom:"Zoom",rangeSelectorFrom:"From",rangeSelectorTo:"To"});Ib.prototype={clickButton:function(a,b){var c=this,d=c.selected,e=c.chart,f=c.buttons,g=c.buttonOptions[a],h=e.xAxis[0],i=e.scroller&&e.scroller.getUnionExtremes()||h||{},j=i.dataMin,k=i.dataMax,l,m=h&&y(E(h.max,q(k,h.max))),o=g.type,p,i=g._range,r,s,x,u=g.dataGrouping;if(!(j===
null||k===null||a===c.selected)){e.fixedRange=i;if(u)this.forcedDataGrouping=!0,I.prototype.setDataGrouping.call(h||{chart:this.chart},u,!1);if(o==="month"||o==="year")if(h){if(o={range:g,max:m,dataMin:j,dataMax:k},l=h.minFromRange.call(o),typeof o.newMax==="number")m=o.newMax}else i=g;else if(i)l=v(m-i,j),m=E(l+i,k);else if(o==="ytd")if(h){if(k===t)j=Number.MAX_VALUE,k=Number.MIN_VALUE,n(e.series,function(a){a=a.xData;j=E(a[0],j);k=v(a[a.length-1],k)}),b=!1;m=new fa(k);l=m.getFullYear();l=r=v(j||
0,fa.UTC(l,0,1));m=m.getTime();m=E(k||m,m)}else{D(e,"beforeRender",function(){c.clickButton(a)});return}else o==="all"&&h&&(l=j,m=k);f[d]&&f[d].setState(0);if(f[a])f[a].setState(2),c.lastSelected=a;h?(h.setExtremes(l,m,q(b,1),0,{trigger:"rangeSelectorButton",rangeSelectorButton:g}),c.setSelected(a)):(p=e.options.xAxis[0],x=p.range,p.range=i,s=p.min,p.min=r,c.setSelected(a),D(e,"load",function(){p.range=x;p.min=s}))}},setSelected:function(a){this.selected=this.options.selected=a},defaultButtons:[{type:"month",
count:1,text:"1m"},{type:"month",count:3,text:"3m"},{type:"month",count:6,text:"6m"},{type:"ytd",text:"YTD"},{type:"year",count:1,text:"1y"},{type:"all",text:"All"}],init:function(a){var b=this,c=a.options.rangeSelector,d=c.buttons||[].concat(b.defaultButtons),e=c.selected,f=b.blurInputs=function(){var a=b.minInput,c=b.maxInput;a&&a.blur&&M(a,"blur");c&&c.blur&&M(c,"blur")};b.chart=a;b.options=c;b.buttons=[];a.extraTopMargin=c.height;b.buttonOptions=d;D(a.container,"mousedown",f);D(a,"resize",f);
n(d,b.computeButtonRange);e!==t&&d[e]&&this.clickButton(e,!1);D(a,"load",function(){D(a.xAxis[0],"setExtremes",function(c){this.max-this.min!==a.fixedRange&&c.trigger!=="rangeSelectorButton"&&c.trigger!=="updatedData"&&b.forcedDataGrouping&&this.setDataGrouping(!1,!1)});D(a.xAxis[0],"afterSetExtremes",function(){b.updateButtonStates(!0)})})},updateButtonStates:function(a){var b=this,c=this.chart,d=c.xAxis[0],e=c.scroller&&c.scroller.getUnionExtremes()||d,f=e.dataMin,g=e.dataMax,h=b.selected,i=b.options.allButtonsEnabled,
j=b.buttons;a&&c.fixedRange!==y(d.max-d.min)&&(j[h]&&j[h].setState(0),b.setSelected(null));n(b.buttonOptions,function(a,e){var m=y(d.max-d.min),o=a._range,n=a.type,q=a.count||1,s=o>g-f,t=o<d.minRange,u=a.type==="all"&&d.max-d.min>=g-f&&j[e].state!==2,w=a.type==="ytd"&&ma("%Y",f)===ma("%Y",g),v=c.renderer.forExport&&e===h,o=o===m,x=!d.hasVisibleSeries;if((n==="month"||n==="year")&&m>={month:28,year:365}[n]*864E5*q&&m<={month:31,year:366}[n]*864E5*q)o=!0;v||o&&e!==h&&e===b.lastSelected?(b.setSelected(e),
j[e].setState(2)):!i&&(s||t||u||w||x)?j[e].setState(3):j[e].state===3&&j[e].setState(0)})},computeButtonRange:function(a){var b=a.type,c=a.count||1,d={millisecond:1,second:1E3,minute:6E4,hour:36E5,day:864E5,week:6048E5};if(d[b])a._range=d[b]*c;else if(b==="month"||b==="year")a._range={month:30,year:365}[b]*864E5*c},setInputValue:function(a,b){var c=this.chart.options.rangeSelector;if(s(b))this[a+"Input"].HCTime=b;this[a+"Input"].value=ma(c.inputEditDateFormat||"%Y-%m-%d",this[a+"Input"].HCTime);this[a+
"DateBox"].attr({text:ma(c.inputDateFormat||"%b %e, %Y",this[a+"Input"].HCTime)})},showInput:function(a){var b=this.inputGroup,c=this[a+"DateBox"];F(this[a+"Input"],{left:b.translateX+c.x+"px",top:b.translateY+"px",width:c.width-2+"px",height:c.height-2+"px",border:"2px solid silver"})},hideInput:function(a){F(this[a+"Input"],{border:0,width:"1px",height:"1px"});this.setInputValue(a)},drawInput:function(a){function b(){var a=j.value,b=(g.inputDateParser||fa.parse)(a),e=d.xAxis[0],f=e.dataMin,h=e.dataMax;
if(b!==j.previousValue)j.previousValue=b,isNaN(b)&&(b=a.split("-"),b=fa.UTC(G(b[0]),G(b[1])-1,G(b[2]))),isNaN(b)||(N.global.useUTC||(b+=(new fa).getTimezoneOffset()*6E4),i?b>c.maxInput.HCTime?b=t:b<f&&(b=f):b<c.minInput.HCTime?b=t:b>h&&(b=h),b!==t&&d.xAxis[0].setExtremes(i?b:e.min,i?e.max:b,t,t,{trigger:"rangeSelectorInput"}))}var c=this,d=c.chart,e=d.renderer.style,f=d.renderer,g=d.options.rangeSelector,h=c.div,i=a==="min",j,k,l=this.inputGroup;this[a+"Label"]=k=f.label(N.lang[i?"rangeSelectorFrom":
"rangeSelectorTo"],this.inputGroup.offset).attr({padding:2}).css(C(e,g.labelStyle)).add(l);l.offset+=k.width+5;this[a+"DateBox"]=f=f.label("",l.offset).attr({padding:2,width:g.inputBoxWidth||90,height:g.inputBoxHeight||17,stroke:g.inputBoxBorderColor||"silver","stroke-width":1}).css(C({textAlign:"center",color:"#444"},e,g.inputStyle)).on("click",function(){c.showInput(a);c[a+"Input"].focus()}).add(l);l.offset+=f.width+(i?10:0);this[a+"Input"]=j=ea("input",{name:a,className:"highcharts-range-selector",
type:"text"},x({position:"absolute",border:0,width:"1px",height:"1px",padding:0,textAlign:"center",fontSize:e.fontSize,fontFamily:e.fontFamily,left:"-9em",top:d.plotTop+"px"},g.inputStyle),h);j.onfocus=function(){c.showInput(a)};j.onblur=function(){c.hideInput(a)};j.onchange=b;j.onkeypress=function(a){a.keyCode===13&&b()}},getPosition:function(){var a=this.chart,b=a.options.rangeSelector,a=q((b.buttonPosition||{}).y,a.plotTop-a.axisOffset[0]-b.height);return{buttonTop:a,inputTop:a-10}},render:function(a,
b){var c=this,d=c.chart,e=d.renderer,f=d.container,g=d.options,h=g.exporting&&g.exporting.enabled!==!1&&g.navigation&&g.navigation.buttonOptions,i=g.rangeSelector,j=c.buttons,g=N.lang,k=c.div,k=c.inputGroup,l=i.buttonTheme,m=i.buttonPosition||{},o=i.inputEnabled,p=l&&l.states,r=d.plotLeft,t,v=this.getPosition(),u=c.group,w=c.rendered;if(!w&&(c.group=u=e.g("range-selector-buttons").add(),c.zoomText=e.text(g.rangeSelectorZoom,q(m.x,r),15).css(i.labelStyle).add(u),t=q(m.x,r)+c.zoomText.getBBox().width+
5,n(c.buttonOptions,function(a,b){j[b]=e.button(a.text,t,0,function(){c.clickButton(b);c.isActive=!0},l,p&&p.hover,p&&p.select,p&&p.disabled).css({textAlign:"center"}).add(u);t+=j[b].width+q(i.buttonSpacing,5);c.selected===b&&j[b].setState(2)}),c.updateButtonStates(),o!==!1))c.div=k=ea("div",null,{position:"relative",height:0,zIndex:1}),f.parentNode.insertBefore(k,f),c.inputGroup=k=e.g("input-group").add(),k.offset=0,c.drawInput("min"),c.drawInput("max");u[w?"animate":"attr"]({translateY:v.buttonTop});
o!==!1&&(k.align(x({y:v.inputTop,width:k.offset,x:h&&v.inputTop<(h.y||0)+h.height-d.spacing[0]?-40:0},i.inputPosition),!0,d.spacingBox),s(o)||(d=u.getBBox(),k[k.translateX<d.x+d.width+10?"hide":"show"]()),c.setInputValue("min",a),c.setInputValue("max",b));c.rendered=!0},destroy:function(){var a=this.minInput,b=this.maxInput,c=this.chart,d=this.blurInputs,e;T(c.container,"mousedown",d);T(c,"resize",d);Pa(this.buttons);if(a)a.onfocus=a.onblur=a.onchange=null;if(b)b.onfocus=b.onblur=b.onchange=null;
for(e in this)this[e]&&e!=="chart"&&(this[e].destroy?this[e].destroy():this[e].nodeType&&Va(this[e])),this[e]=null}};I.prototype.toFixedRange=function(a,b,c,d){var e=this.chart&&this.chart.fixedRange,a=q(c,this.translate(a,!0)),b=q(d,this.translate(b,!0)),c=e&&(b-a)/e;c>0.7&&c<1.3&&(d?a=b-e:b=a+e);isNaN(a)&&(a=b=void 0);return{min:a,max:b}};I.prototype.minFromRange=function(){var a=this.range,b={month:"Month",year:"FullYear"}[a.type],c,d=this.max,e,f,g=function(a,c){var d=new fa(a);d["set"+b](d["get"+
b]()+c);return d.getTime()-a};typeof a==="number"?(c=this.max-a,f=a):c=d+g(d,-a.count);e=q(this.dataMin,Number.MIN_VALUE);isNaN(c)&&(c=e);if(c<=e)c=e,f===void 0&&(f=g(c,a.count)),this.newMax=E(c+f,this.dataMax);isNaN(d)&&(c=void 0);return c};U(Ca.prototype,"init",function(a,b,c){D(this,"init",function(){if(this.options.rangeSelector.enabled)this.rangeSelector=new Ib(this)});a.call(this,b,c)});z.RangeSelector=Ib;Ca.prototype.callbacks.push(function(a){function b(){f=a.xAxis[0].getExtremes();g.render(f.min,
f.max)}function c(){f=a.xAxis[0].getExtremes();isNaN(f.min)||h.render(f.min,f.max)}function d(a){a.triggerOp!=="navigator-drag"&&g.render(a.min,a.max)}function e(a){h.render(a.min,a.max)}var f,g=a.scroller,h=a.rangeSelector;g&&(D(a.xAxis[0],"afterSetExtremes",d),U(a,"drawChartBox",function(a){var c=this.isDirtyBox;a.call(this);c&&b()}),b());h&&(D(a.xAxis[0],"afterSetExtremes",e),D(a,"resize",c),c());D(a,"destroy",function(){g&&T(a.xAxis[0],"afterSetExtremes",d);h&&(T(a,"resize",c),T(a.xAxis[0],"afterSetExtremes",
e))})});z.StockChart=z.stockChart=function(a,b,c){var d=Da(a)||a.nodeName,e=arguments[d?1:0],f=e.series,g,h=q(e.navigator&&e.navigator.enabled,!0)?{startOnTick:!1,endOnTick:!1}:null,i={marker:{enabled:!1,radius:2}},j={shadow:!1,borderWidth:0};e.xAxis=ta(va(e.xAxis||{}),function(a){return C({minPadding:0,maxPadding:0,ordinal:!0,title:{text:null},labels:{overflow:"justify"},showLastLabel:!0},a,{type:"datetime",categories:null},h)});e.yAxis=ta(va(e.yAxis||{}),function(a){g=q(a.opposite,!0);return C({labels:{y:-2},
opposite:g,showLastLabel:!1,title:{text:null}},a)});e.series=null;e=C({chart:{panning:!0,pinchType:"x"},navigator:{enabled:!0},scrollbar:{enabled:!0},rangeSelector:{enabled:!0},title:{text:null,style:{fontSize:"16px"}},tooltip:{shared:!0,crosshairs:!0},legend:{enabled:!1},plotOptions:{line:i,spline:i,area:i,areaspline:i,arearange:i,areasplinerange:i,column:j,columnrange:j,candlestick:j,ohlc:j}},e,{_stock:!0,chart:{inverted:!1}});e.series=f;return d?new Ca(a,e,c):new Ca(e,b)};U(Za.prototype,"init",
function(a,b,c){var d=c.chart.pinchType||"";a.call(this,b,c);this.pinchX=this.pinchHor=d.indexOf("x")!==-1;this.pinchY=this.pinchVert=d.indexOf("y")!==-1;this.hasZoom=this.hasZoom||this.pinchHor||this.pinchVert});U(I.prototype,"autoLabelAlign",function(a){var b=this.chart,c=this.options,b=b._labelPanes=b._labelPanes||{},d=this.options.labels;if(this.chart.options._stock&&this.coll==="yAxis"&&(c=c.top+","+c.height,!b[c]&&d.enabled)){if(d.x===15)d.x=0;if(d.align===void 0)d.align="right";b[c]=1;return"right"}return a.call(this,
[].slice.call(arguments,1))});U(I.prototype,"getPlotLinePath",function(a,b,c,d,e,f){var g=this,h=this.isLinked&&!this.series?this.linkedParent.series:this.series,i=g.chart,j=i.renderer,k=g.left,l=g.top,m,o,p,r,t=[],x=[],u,w;if(g.coll==="colorAxis")return a.apply(this,[].slice.call(arguments,1));x=g.isXAxis?s(g.options.yAxis)?[i.yAxis[g.options.yAxis]]:ta(h,function(a){return a.yAxis}):s(g.options.xAxis)?[i.xAxis[g.options.xAxis]]:ta(h,function(a){return a.xAxis});n(g.isXAxis?i.yAxis:i.xAxis,function(a){if(s(a.options.id)?
a.options.id.indexOf("navigator")===-1:1){var b=a.isXAxis?"yAxis":"xAxis",b=s(a.options[b])?i[b][a.options[b]]:i[b][0];g===b&&x.push(a)}});u=x.length?[]:[g.isXAxis?i.yAxis[0]:i.xAxis[0]];n(x,function(a){sa(a,u)===-1&&u.push(a)});w=q(f,g.translate(b,null,null,d));isNaN(w)||(g.horiz?n(u,function(a){var b;o=a.pos;r=o+a.len;m=p=y(w+g.transB);if(m<k||m>k+g.width)e?m=p=E(v(k,m),k+g.width):b=!0;b||t.push("M",m,o,"L",p,r)}):n(u,function(a){var b;m=a.pos;p=m+a.len;o=r=y(l+g.height-w);if(o<l||o>l+g.height)e?
o=r=E(v(l,o),g.top+g.height):b=!0;b||t.push("M",m,o,"L",p,r)}));return t.length>0?j.crispPolyLine(t,c||1):null});I.prototype.getPlotBandPath=function(a,b){var c=this.getPlotLinePath(b,null,null,!0),d=this.getPlotLinePath(a,null,null,!0),e=[],f;if(d&&c&&d.toString()!==c.toString())for(f=0;f<d.length;f+=6)e.push("M",d[f+1],d[f+2],"L",d[f+4],d[f+5],c[f+4],c[f+5],c[f+1],c[f+2]);else e=null;return e};ya.prototype.crispPolyLine=function(a,b){var c;for(c=0;c<a.length;c+=6)a[c+1]===a[c+4]&&(a[c+1]=a[c+4]=
y(a[c+1])-b%2/2),a[c+2]===a[c+5]&&(a[c+2]=a[c+5]=y(a[c+2])+b%2/2);return a};if(Ya===z.VMLRenderer)mb.prototype.crispPolyLine=ya.prototype.crispPolyLine;U(I.prototype,"hideCrosshair",function(a,b){a.call(this,b);if(this.crossLabel)this.crossLabel=this.crossLabel.hide()});U(I.prototype,"drawCrosshair",function(a,b,c){var d,e;a.call(this,b,c);if(s(this.crosshair.label)&&this.crosshair.label.enabled){var a=this.chart,f=this.options.crosshair.label,g=this.horiz,h=this.opposite,i=this.left,j=this.top,k=
this.crossLabel,l,m=f.format,n="",p=this.options.tickPosition==="inside",r=this.crosshair.snap!==!1;l=g?"center":h?this.labelAlign==="right"?"right":"left":this.labelAlign==="left"?"left":"center";if(!k)k=this.crossLabel=a.renderer.label(null,null,null,f.shape||"callout").attr({align:f.align||l,zIndex:12,fill:f.backgroundColor||this.series[0]&&this.series[0].color||"gray",padding:q(f.padding,8),stroke:f.borderColor||"","stroke-width":f.borderWidth||0,r:q(f.borderRadius,3)}).css(x({color:"white",fontWeight:"normal",
fontSize:"11px",textAlign:"center"},f.style)).add();g?(l=r?c.plotX+i:b.chartX,j+=h?0:this.height):(l=h?this.width+i:0,j=r?c.plotY+j:b.chartY);!m&&!f.formatter&&(this.isDatetimeAxis&&(n="%b %d, %Y"),m="{value"+(n?":"+n:"")+"}");b=r?c[this.isXAxis?"x":"y"]:this.toValue(g?b.chartX:b.chartY);k.attr({text:m?La(m,{value:b}):f.formatter.call(this,b),anchorX:g?l:this.opposite?0:a.chartWidth,anchorY:g?this.opposite?a.chartHeight:0:j,x:l,y:j,visibility:"visible"});b=k.getBBox();if(g){if(p&&!h||!p&&h)j=k.y-
b.height}else j=k.y-b.height/2;g?(d=i-b.x,e=i+this.width-b.x):(d=this.labelAlign==="left"?i:0,e=this.labelAlign==="right"?i+this.width:a.chartWidth);k.translateX<d&&(l+=d-k.translateX);k.translateX+b.width>=e&&(l-=k.translateX+b.width-e);k.attr({x:l,y:j,visibility:"visible"})}});var gc=ia.init,hc=ia.processData,ic=Ha.prototype.tooltipFormatter;ia.init=function(){gc.apply(this,arguments);this.setCompare(this.options.compare)};ia.setCompare=function(a){this.modifyValue=a==="value"||a==="percent"?function(b,
c){var d=this.compareValue;if(b!==t&&(b=a==="value"?b-d:b=100*(b/d)-100,c))c.change=b;return b}:null;if(this.chart.hasRendered)this.isDirty=!0};ia.processData=function(){var a,b=-1,c,d,e,f;hc.apply(this,arguments);if(this.xAxis&&this.processedYData){c=this.processedXData;d=this.processedYData;e=d.length;this.pointArrayMap&&(b=sa(this.pointValKey||"y",this.pointArrayMap));for(a=0;a<e;a++)if(f=b>-1?d[a][b]:d[a],typeof f==="number"&&c[a]>=this.xAxis.min&&f!==0){this.compareValue=f;break}}};U(ia,"getExtremes",
function(a){var b;a.apply(this,[].slice.call(arguments,1));if(this.modifyValue)b=[this.modifyValue(this.dataMin),this.modifyValue(this.dataMax)],this.dataMin=Oa(b),this.dataMax=Ea(b)});I.prototype.setCompare=function(a,b){this.isXAxis||(n(this.series,function(b){b.setCompare(a)}),q(b,!0)&&this.chart.redraw())};Ha.prototype.tooltipFormatter=function(a){a=a.replace("{point.change}",(this.change>0?"+":"")+z.numberFormat(this.change,q(this.series.tooltipOptions.changeDecimals,2)));return ic.apply(this,
[a])};U(Q.prototype,"render",function(a){if(this.chart.options._stock&&this.xAxis)!this.clipBox&&this.animate?(this.clipBox=C(this.chart.clipBox),this.clipBox.width=this.xAxis.len,this.clipBox.height=this.yAxis.len):this.chart[this.sharedClipKey]&&(Ta(this.chart[this.sharedClipKey]),this.chart[this.sharedClipKey].attr({width:this.xAxis.len,height:this.yAxis.len}));a.call(this)});x(z,{Color:wa,Point:Ha,Tick:cb,Renderer:Ya,SVGElement:Z,SVGRenderer:ya,arrayMin:Oa,arrayMax:Ea,charts:$,correctFloat:na,
dateFormat:ma,error:ga,format:La,pathAnim:void 0,getOptions:function(){return N},hasBidiBug:Zb,isTouchDevice:kb,setOptions:function(a){N=C(!0,N,a);Ob();return N},addEvent:D,removeEvent:T,createElement:ea,discardElement:Va,css:F,each:n,map:ta,merge:C,splat:va,stableSort:ob,extendClass:la,pInt:G,svg:ja,canvas:qa,vml:!ja&&!qa,product:"Highstock",version:"4.2.4"});return z});

},{}],3:[function(require,module,exports){
/**
*
* jquery.sparkline.js
*
* v2.3.2
* (c) Splunk, Inc
* Contact: Gareth Watts (gareth@splunk.com)
* http://omnipotent.net/jquery.sparkline/
*
* Generates inline sparkline charts from data supplied either to the method
* or inline in HTML
*
* Compatible with Internet Explorer 6.0+ and modern browsers equipped with the canvas tag
* (Firefox 2.0+, Safari, Opera, etc)
*
* License: New BSD License
*
* Copyright (c) 2012, Splunk Inc.
* All rights reserved.
*
* Redistribution and use in source and binary forms, with or without modification,
* are permitted provided that the following conditions are met:
*
*     * Redistributions of source code must retain the above copyright notice,
*       this list of conditions and the following disclaimer.
*     * Redistributions in binary form must reproduce the above copyright notice,
*       this list of conditions and the following disclaimer in the documentation
*       and/or other materials provided with the distribution.
*     * Neither the name of Splunk Inc nor the names of its contributors may
*       be used to endorse or promote products derived from this software without
*       specific prior written permission.
*
* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY
* EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
* OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT
* SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
* SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT
* OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
* HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
* OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
* SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*
*
* Usage:
*  $(selector).sparkline(values, options)
*
* If values is undefined or set to 'html' then the data values are read from the specified tag:
*   <p>Sparkline: <span class="sparkline">1,4,6,6,8,5,3,5</span></p>
*   $('.sparkline').sparkline();
* There must be no spaces in the enclosed data set
*
* Otherwise values must be an array of numbers or null values
*    <p>Sparkline: <span id="sparkline1">This text replaced if the browser is compatible</span></p>
*    $('#sparkline1').sparkline([1,4,6,6,8,5,3,5])
*    $('#sparkline2').sparkline([1,4,6,null,null,5,3,5])
*
* Values can also be specified in an HTML comment, or as a values attribute:
*    <p>Sparkline: <span class="sparkline"><!--1,4,6,6,8,5,3,5 --></span></p>
*    <p>Sparkline: <span class="sparkline" values="1,4,6,6,8,5,3,5"></span></p>
*    $('.sparkline').sparkline();
*
* For line charts, x values can also be specified:
*   <p>Sparkline: <span class="sparkline">1:1,2.7:4,3.4:6,5:6,6:8,8.7:5,9:3,10:5</span></p>
*    $('#sparkline1').sparkline([ [1,1], [2.7,4], [3.4,6], [5,6], [6,8], [8.7,5], [9,3], [10,5] ])
*
* By default, options should be passed in as the second argument to the sparkline function:
*   $('.sparkline').sparkline([1,2,3,4], {type: 'bar'})
*
* Options can also be set by passing them on the tag itself.  This feature is disabled by default though
* as there's a slight performance overhead:
*   $('.sparkline').sparkline([1,2,3,4], {enableTagOptions: true})
*   <p>Sparkline: <span class="sparkline" sparkType="bar" sparkBarColor="red">loading</span></p>
* Prefix all options supplied as tag attribute with "spark" (configurable by setting tagOptionsPrefix)
*
* Supported options:
*   lineColor - Color of the line used for the chart
*   fillColor - Color used to fill in the chart - Set to '' or false for a transparent chart
*   width - Width of the chart - Defaults to 3 times the number of values in pixels
*   height - Height of the chart - Defaults to the height of the containing element
*   chartRangeMin - Specify the minimum value to use for the Y range of the chart - Defaults to the minimum value supplied
*   chartRangeMax - Specify the maximum value to use for the Y range of the chart - Defaults to the maximum value supplied
*   chartRangeClip - Clip out of range values to the max/min specified by chartRangeMin and chartRangeMax
*   chartRangeMinX - Specify the minimum value to use for the X range of the chart - Defaults to the minimum value supplied
*   chartRangeMaxX - Specify the maximum value to use for the X range of the chart - Defaults to the maximum value supplied
*   composite - If true then don't erase any existing chart attached to the tag, but draw
*           another chart over the top - Note that width and height are ignored if an
*           existing chart is detected.
*   tagValuesAttribute - Name of tag attribute to check for data values - Defaults to 'values'
*   enableTagOptions - Whether to check tags for sparkline options
*   tagOptionsPrefix - Prefix used for options supplied as tag attributes - Defaults to 'spark'
*   disableHiddenCheck - If set to true, then the plugin will assume that charts will never be drawn into a
*           hidden dom element, avoding a browser reflow
*   disableInteraction - If set to true then all mouseover/click interaction behaviour will be disabled,
*       making the plugin perform much like it did in 1.x
*   disableTooltips - If set to true then tooltips will be disabled - Defaults to false (tooltips enabled)
*   disableHighlight - If set to true then highlighting of selected chart elements on mouseover will be disabled
*       defaults to false (highlights enabled)
*   highlightLighten - Factor to lighten/darken highlighted chart values by - Defaults to 1.4 for a 40% increase
*   tooltipContainer - Specify which DOM element the tooltip should be rendered into - defaults to document.body
*   tooltipClassname - Optional CSS classname to apply to tooltips - If not specified then a default style will be applied
*   tooltipOffsetX - How many pixels away from the mouse pointer to render the tooltip on the X axis
*   tooltipOffsetY - How many pixels away from the mouse pointer to render the tooltip on the r axis
*   tooltipFormatter  - Optional callback that allows you to override the HTML displayed in the tooltip
*       callback is given arguments of (sparkline, options, fields)
*   tooltipChartTitle - If specified then the tooltip uses the string specified by this setting as a title
*   tooltipFormat - A format string or SPFormat object  (or an array thereof for multiple entries)
*       to control the format of the tooltip
*   tooltipPrefix - A string to prepend to each field displayed in a tooltip
*   tooltipSuffix - A string to append to each field displayed in a tooltip
*   tooltipSkipNull - If true then null values will not have a tooltip displayed (defaults to true)
*   tooltipValueLookups - An object or range map to map field values to tooltip strings
*       (eg. to map -1 to "Lost", 0 to "Draw", and 1 to "Win")
*   numberFormatter - Optional callback for formatting numbers in tooltips
*   numberDigitGroupSep - Character to use for group separator in numbers "1,234" - Defaults to ","
*   numberDecimalMark - Character to use for the decimal point when formatting numbers - Defaults to "."
*   numberDigitGroupCount - Number of digits between group separator - Defaults to 3
*
* There are 7 types of sparkline, selected by supplying a "type" option of 'line' (default),
* 'bar', 'tristate', 'bullet', 'discrete', 'pie' or 'box'
*    line - Line chart.  Options:
*       spotColor - Set to '' to not end each line in a circular spot
*       minSpotColor - If set, color of spot at minimum value
*       maxSpotColor - If set, color of spot at maximum value
*       spotRadius - Radius in pixels
*       lineWidth - Width of line in pixels
*       normalRangeMin
*       normalRangeMax - If set draws a filled horizontal bar between these two values marking the "normal"
*                      or expected range of values
*       normalRangeColor - Color to use for the above bar
*       drawNormalOnTop - Draw the normal range above the chart fill color if true
*       defaultPixelsPerValue - Defaults to 3 pixels of width for each value in the chart
*       highlightSpotColor - The color to use for drawing a highlight spot on mouseover - Set to null to disable
*       highlightLineColor - The color to use for drawing a highlight line on mouseover - Set to null to disable
*       valueSpots - Specify which points to draw spots on, and in which color.  Accepts a range map
*
*   bar - Bar chart.  Options:
*       barColor - Color of bars for postive values
*       negBarColor - Color of bars for negative values
*       zeroColor - Color of bars with zero values
*       nullColor - Color of bars with null values - Defaults to omitting the bar entirely
*       barWidth - Width of bars in pixels
*       colorMap - Optional mappnig of values to colors to override the *BarColor values above
*                  can be an Array of values to control the color of individual bars or a range map
*                  to specify colors for individual ranges of values
*       barSpacing - Gap between bars in pixels
*       zeroAxis - Centers the y-axis around zero if true
*
*   tristate - Charts values of win (>0), lose (<0) or draw (=0)
*       posBarColor - Color of win values
*       negBarColor - Color of lose values
*       zeroBarColor - Color of draw values
*       barWidth - Width of bars in pixels
*       barSpacing - Gap between bars in pixels
*       colorMap - Optional mappnig of values to colors to override the *BarColor values above
*                  can be an Array of values to control the color of individual bars or a range map
*                  to specify colors for individual ranges of values
*
*   discrete - Options:
*       lineHeight - Height of each line in pixels - Defaults to 30% of the graph height
*       thesholdValue - Values less than this value will be drawn using thresholdColor instead of lineColor
*       thresholdColor
*
*   bullet - Values for bullet graphs msut be in the order: target, performance, range1, range2, range3, ...
*       options:
*       targetColor - The color of the vertical target marker
*       targetWidth - The width of the target marker in pixels
*       performanceColor - The color of the performance measure horizontal bar
*       rangeColors - Colors to use for each qualitative range background color
*
*   pie - Pie chart. Options:
*       sliceColors - An array of colors to use for pie slices
*       offset - Angle in degrees to offset the first slice - Try -90 or +90
*       borderWidth - Width of border to draw around the pie chart, in pixels - Defaults to 0 (no border)
*       borderColor - Color to use for the pie chart border - Defaults to #000
*
*   box - Box plot. Options:
*       raw - Set to true to supply pre-computed plot points as values
*             values should be: low_outlier, low_whisker, q1, median, q3, high_whisker, high_outlier
*             When set to false you can supply any number of values and the box plot will
*             be computed for you.  Default is false.
*       showOutliers - Set to true (default) to display outliers as circles
*       outlierIQR - Interquartile range used to determine outliers.  Default 1.5
*       boxLineColor - Outline color of the box
*       boxFillColor - Fill color for the box
*       whiskerColor - Line color used for whiskers
*       outlierLineColor - Outline color of outlier circles
*       outlierFillColor - Fill color of the outlier circles
*       spotRadius - Radius of outlier circles
*       medianColor - Line color of the median line
*       target - Draw a target cross hair at the supplied value (default undefined)
*
*
*
*   Examples:
*   $('#sparkline1').sparkline(myvalues, { lineColor: '#f00', fillColor: false });
*   $('.barsparks').sparkline('html', { type:'bar', height:'40px', barWidth:5 });
*   $('#tristate').sparkline([1,1,-1,1,0,0,-1], { type:'tristate' }):
*   $('#discrete').sparkline([1,3,4,5,5,3,4,5], { type:'discrete' });
*   $('#bullet').sparkline([10,12,12,9,7], { type:'bullet' });
*   $('#pie').sparkline([1,1,2], { type:'pie' });
*/

/*jslint regexp: true, browser: true, jquery: true, white: true, nomen: false, plusplus: false, maxerr: 500, indent: 4 */

(function(document, Math, undefined) { // performance/minified-size optimization
(function(factory) {
    if(typeof define === 'function' && define.amd) {
        define(['jquery'], factory);
    } else if (jQuery && !jQuery.fn.sparkline) {
        factory(jQuery);
    }
}
(function($) {
    'use strict';

    var UNSET_OPTION = {},
        getDefaults, createClass, SPFormat, clipval, quartile, normalizeValue, normalizeValues,
        remove, isNumber, all, sum, addCSS, ensureArray, formatNumber, RangeMap,
        MouseHandler, Tooltip, barHighlightMixin,
        line, bar, tristate, discrete, bullet, pie, box, defaultStyles, initStyles,
        VShape, VCanvas_base, VCanvas_canvas, VCanvas_vml, pending, shapeCount = 0;

    /**
     * Default configuration settings
     */
    getDefaults = function () {
        return {
            // Settings common to most/all chart types
            common: {
                type: 'line',
                lineColor: '#00f',
                fillColor: '#cdf',
                defaultPixelsPerValue: 3,
                width: 'auto',
                height: 'auto',
                composite: false,
                tagValuesAttribute: 'values',
                tagOptionsPrefix: 'spark',
                enableTagOptions: false,
                enableHighlight: true,
                highlightLighten: 1.4,
                tooltipSkipNull: true,
                tooltipPrefix: '',
                tooltipSuffix: '',
                disableHiddenCheck: false,
                numberFormatter: false,
                numberDigitGroupCount: 3,
                numberDigitGroupSep: ',',
                numberDecimalMark: '.',
                disableTooltips: false,
                disableInteraction: false
            },
            // Defaults for line charts
            line: {
                spotColor: '#f80',
                highlightSpotColor: '#5f5',
                highlightLineColor: '#f22',
                spotRadius: 1.5,
                minSpotColor: '#f80',
                maxSpotColor: '#f80',
                lineWidth: 1,
                normalRangeMin: undefined,
                normalRangeMax: undefined,
                normalRangeColor: '#ccc',
                drawNormalOnTop: false,
                chartRangeMin: undefined,
                chartRangeMax: undefined,
                chartRangeMinX: undefined,
                chartRangeMaxX: undefined,
                tooltipFormat: new SPFormat('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{y}}{{suffix}}')
            },
            // Defaults for bar charts
            bar: {
                barColor: '#3366cc',
                negBarColor: '#f44',
                stackedBarColor: ['#3366cc', '#dc3912', '#ff9900', '#109618', '#66aa00',
                    '#dd4477', '#0099c6', '#990099'],
                zeroColor: undefined,
                nullColor: undefined,
                zeroAxis: true,
                barWidth: 4,
                barSpacing: 1,
                chartRangeMax: undefined,
                chartRangeMin: undefined,
                chartRangeClip: false,
                colorMap: undefined,
                tooltipFormat: new SPFormat('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{value}}{{suffix}}')
            },
            // Defaults for tristate charts
            tristate: {
                barWidth: 4,
                barSpacing: 1,
                posBarColor: '#6f6',
                negBarColor: '#f44',
                zeroBarColor: '#999',
                colorMap: {},
                tooltipFormat: new SPFormat('<span style="color: {{color}}">&#9679;</span> {{value:map}}'),
                tooltipValueLookups: { map: { '-1': 'Loss', '0': 'Draw', '1': 'Win' } }
            },
            // Defaults for discrete charts
            discrete: {
                lineHeight: 'auto',
                thresholdColor: undefined,
                thresholdValue: 0,
                chartRangeMax: undefined,
                chartRangeMin: undefined,
                chartRangeClip: false,
                tooltipFormat: new SPFormat('{{prefix}}{{value}}{{suffix}}')
            },
            // Defaults for bullet charts
            bullet: {
                targetColor: '#f33',
                targetWidth: 3, // width of the target bar in pixels
                performanceColor: '#33f',
                rangeColors: ['#d3dafe', '#a8b6ff', '#7f94ff'],
                base: undefined, // set this to a number to change the base start number
                tooltipFormat: new SPFormat('{{fieldkey:fields}} - {{value}}'),
                tooltipValueLookups: { fields: {r: 'Range', p: 'Performance', t: 'Target'} }
            },
            // Defaults for pie charts
            pie: {
                offset: 0,
                sliceColors: ['#3366cc', '#dc3912', '#ff9900', '#109618', '#66aa00',
                    '#dd4477', '#0099c6', '#990099'],
                borderWidth: 0,
                borderColor: '#000',
                tooltipFormat: new SPFormat('<span style="color: {{color}}">&#9679;</span> {{value}} ({{percent.1}}%)')
            },
            // Defaults for box plots
            box: {
                raw: false,
                boxLineColor: '#000',
                boxFillColor: '#cdf',
                whiskerColor: '#000',
                outlierLineColor: '#333',
                outlierFillColor: '#fff',
                medianColor: '#f00',
                showOutliers: true,
                outlierIQR: 1.5,
                spotRadius: 1.5,
                target: undefined,
                targetColor: '#4a2',
                chartRangeMax: undefined,
                chartRangeMin: undefined,
                tooltipFormat: new SPFormat('{{field:fields}}: {{value}}'),
                tooltipFormatFieldlistKey: 'field',
                tooltipValueLookups: { fields: { lq: 'Lower Quartile', med: 'Median',
                    uq: 'Upper Quartile', lo: 'Left Outlier', ro: 'Right Outlier',
                    lw: 'Left Whisker', rw: 'Right Whisker'} }
            }
        };
    };

    // You can have tooltips use a css class other than jqstooltip by specifying tooltipClassname
    defaultStyles = '.jqstooltip { ' +
            'position: absolute;' +
            'left: 0px;' +
            'top: 0px;' +
            'visibility: hidden;' +
            'background: rgb(0, 0, 0) transparent;' +
            'background-color: rgba(0,0,0,0.6);' +
            'filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000);' +
            '-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000)";' +
            'color: white;' +
            'font: 10px arial, san serif;' +
            'text-align: left;' +
            'white-space: nowrap;' +
            'padding: 5px;' +
            'border: 1px solid white;' +
            'box-sizing: content-box;' +
            'z-index: 10000;' +
            '}' +
            '.jqsfield { ' +
            'color: white;' +
            'font: 10px arial, san serif;' +
            'text-align: left;' +
            '}';

    /**
     * Utilities
     */

    createClass = function (/* [baseclass, [mixin, ...]], definition */) {
        var Class, args;
        Class = function () {
            this.init.apply(this, arguments);
        };
        if (arguments.length > 1) {
            if (arguments[0]) {
                Class.prototype = $.extend(new arguments[0](), arguments[arguments.length - 1]);
                Class._super = arguments[0].prototype;
            } else {
                Class.prototype = arguments[arguments.length - 1];
            }
            if (arguments.length > 2) {
                args = Array.prototype.slice.call(arguments, 1, -1);
                args.unshift(Class.prototype);
                $.extend.apply($, args);
            }
        } else {
            Class.prototype = arguments[0];
        }
        Class.prototype.cls = Class;
        return Class;
    };

    /**
     * Wraps a format string for tooltips
     * {{x}}
     * {{x.2}
     * {{x:months}}
     */
    $.SPFormatClass = SPFormat = createClass({
        fre: /\{\{([\w.]+?)(:(.+?))?\}\}/g,
        precre: /(\w+)\.(\d+)/,

        init: function (format, fclass) {
            this.format = format;
            this.fclass = fclass;
        },

        render: function (fieldset, lookups, options) {
            var self = this,
                fields = fieldset,
                match, token, lookupkey, fieldvalue, prec;
            return this.format.replace(this.fre, function () {
                var lookup;
                token = arguments[1];
                lookupkey = arguments[3];
                match = self.precre.exec(token);
                if (match) {
                    prec = match[2];
                    token = match[1];
                } else {
                    prec = false;
                }
                fieldvalue = fields[token];
                if (fieldvalue === undefined) {
                    return '';
                }
                if (lookupkey && lookups && lookups[lookupkey]) {
                    lookup = lookups[lookupkey];
                    if (lookup.get) { // RangeMap
                        return lookups[lookupkey].get(fieldvalue) || fieldvalue;
                    } else {
                        return lookups[lookupkey][fieldvalue] || fieldvalue;
                    }
                }
                if (isNumber(fieldvalue)) {
                    if (options.get('numberFormatter')) {
                        fieldvalue = options.get('numberFormatter')(fieldvalue);
                    } else {
                        fieldvalue = formatNumber(fieldvalue, prec,
                            options.get('numberDigitGroupCount'),
                            options.get('numberDigitGroupSep'),
                            options.get('numberDecimalMark'));
                    }
                }
                return fieldvalue;
            });
        }
    });

    // convience method to avoid needing the new operator
    $.spformat = function(format, fclass) {
        return new SPFormat(format, fclass);
    };

    clipval = function (val, min, max) {
        if (val < min) {
            return min;
        }
        if (val > max) {
            return max;
        }
        return val;
    };

    quartile = function (values, q) {
        var vl;
        if (q === 2) {
            vl = Math.floor(values.length / 2);
            return values.length % 2 ? values[vl] : (values[vl-1] + values[vl]) / 2;
        } else {
            if (values.length % 2 ) { // odd
                vl = (values.length * q + q) / 4;
                return vl % 1 ? (values[Math.floor(vl)] + values[Math.floor(vl) - 1]) / 2 : values[vl-1];
            } else { //even
                vl = (values.length * q + 2) / 4;
                return vl % 1 ? (values[Math.floor(vl)] + values[Math.floor(vl) - 1]) / 2 :  values[vl-1];

            }
        }
    };

    normalizeValue = function (val) {
        var nf;
        switch (val) {
            case 'undefined':
                val = undefined;
                break;
            case 'null':
                val = null;
                break;
            case 'true':
                val = true;
                break;
            case 'false':
                val = false;
                break;
            default:
                nf = parseFloat(val);
                if (val == nf) {
                    val = nf;
                }
        }
        return val;
    };

    normalizeValues = function (vals) {
        var i, result = [];
        for (i = vals.length; i--;) {
            result[i] = normalizeValue(vals[i]);
        }
        return result;
    };

    remove = function (vals, filter) {
        var i, vl, result = [];
        for (i = 0, vl = vals.length; i < vl; i++) {
            if (vals[i] !== filter) {
                result.push(vals[i]);
            }
        }
        return result;
    };

    isNumber = function (num) {
        return !isNaN(parseFloat(num)) && isFinite(num);
    };

    formatNumber = function (num, prec, groupsize, groupsep, decsep) {
        var p, i;
        num = (prec === false ? parseFloat(num).toString() : num.toFixed(prec)).split('');
        p = (p = $.inArray('.', num)) < 0 ? num.length : p;
        if (p < num.length) {
            num[p] = decsep;
        }
        for (i = p - groupsize; i > 0; i -= groupsize) {
            num.splice(i, 0, groupsep);
        }
        return num.join('');
    };

    // determine if all values of an array match a value
    // returns true if the array is empty
    all = function (val, arr, ignoreNull) {
        var i;
        for (i = arr.length; i--; ) {
            if (ignoreNull && arr[i] === null) continue;
            if (arr[i] !== val) {
                return false;
            }
        }
        return true;
    };

    // sums the numeric values in an array, ignoring other values
    sum = function (vals) {
        var total = 0, i;
        for (i = vals.length; i--;) {
            total += typeof vals[i] === 'number' ? vals[i] : 0;
        }
        return total;
    };

    ensureArray = function (val) {
        return $.isArray(val) ? val : [val];
    };

    // http://paulirish.com/2008/bookmarklet-inject-new-css-rules/
    addCSS = function(css) {
        var tag, iefail;
        if (document.createStyleSheet) {
            try {
                document.createStyleSheet().cssText = css;
                return;
            } catch (e) {
                // IE <= 9 maxes out at 31 stylesheets; inject into page instead.
                iefail = true;
            }
        }
        tag = document.createElement('style');
        tag.type = 'text/css';
        document.getElementsByTagName('head')[0].appendChild(tag);
        if (iefail) {
            document.styleSheets[document.styleSheets.length - 1].cssText = css;
        } else {
            tag[(typeof document.body.style.WebkitAppearance == 'string') /* webkit only */ ? 'innerText' : 'innerHTML'] = css;
        }
    };

    // Provide a cross-browser interface to a few simple drawing primitives
    $.fn.simpledraw = function (width, height, useExisting, interact) {
        var target, mhandler;
        if (useExisting && (target = this.data('_jqs_vcanvas'))) {
            return target;
        }

        if ($.fn.sparkline.canvas === false) {
            // We've already determined that neither Canvas nor VML are available
            return false;

        } else if ($.fn.sparkline.canvas === undefined) {
            // No function defined yet -- need to see if we support Canvas or VML
            var el = document.createElement('canvas');
            if (!!(el.getContext && el.getContext('2d'))) {
                // Canvas is available
                $.fn.sparkline.canvas = function(width, height, target, interact) {
                    return new VCanvas_canvas(width, height, target, interact);
                };
            } else if (document.namespaces && !document.namespaces.v) {
                // VML is available
                document.namespaces.add('v', 'urn:schemas-microsoft-com:vml', '#default#VML');
                $.fn.sparkline.canvas = function(width, height, target, interact) {
                    return new VCanvas_vml(width, height, target);
                };
            } else {
                // Neither Canvas nor VML are available
                $.fn.sparkline.canvas = false;
                return false;
            }
        }

        if (width === undefined) {
            width = $(this).innerWidth();
        }
        if (height === undefined) {
            height = $(this).innerHeight();
        }

        target = $.fn.sparkline.canvas(width, height, this, interact);

        mhandler = $(this).data('_jqs_mhandler');
        if (mhandler) {
            mhandler.registerCanvas(target);
        }
        return target;
    };

    $.fn.cleardraw = function () {
        var target = this.data('_jqs_vcanvas');
        if (target) {
            target.reset();
        }
    };

    $.RangeMapClass = RangeMap = createClass({
        init: function (map) {
            var key, range, rangelist = [];
            for (key in map) {
                if (map.hasOwnProperty(key) && typeof key === 'string' && key.indexOf(':') > -1) {
                    range = key.split(':');
                    range[0] = range[0].length === 0 ? -Infinity : parseFloat(range[0]);
                    range[1] = range[1].length === 0 ? Infinity : parseFloat(range[1]);
                    range[2] = map[key];
                    rangelist.push(range);
                }
            }
            this.map = map;
            this.rangelist = rangelist || false;
        },

        get: function (value) {
            var rangelist = this.rangelist,
                i, range, result;
            if ((result = this.map[value]) !== undefined) {
                return result;
            }
            if (rangelist) {
                for (i = rangelist.length; i--;) {
                    range = rangelist[i];
                    if (range[0] <= value && range[1] >= value) {
                        return range[2];
                    }
                }
            }
            return undefined;
        }
    });

    // Convenience function
    $.range_map = function(map) {
        return new RangeMap(map);
    };

    MouseHandler = createClass({
        init: function (el, options) {
            var $el = $(el);
            this.$el = $el;
            this.options = options;
            this.currentPageX = 0;
            this.currentPageY = 0;
            this.el = el;
            this.splist = [];
            this.tooltip = null;
            this.over = false;
            this.displayTooltips = !options.get('disableTooltips');
            this.highlightEnabled = !options.get('disableHighlight');
        },

        registerSparkline: function (sp) {
            this.splist.push(sp);
            if (this.over) {
                this.updateDisplay();
            }
        },

        registerCanvas: function (canvas) {
            var $canvas = $(canvas.canvas);
            this.canvas = canvas;
            this.$canvas = $canvas;
            $canvas.mouseenter($.proxy(this.mouseenter, this));
            $canvas.mouseleave($.proxy(this.mouseleave, this));
            $canvas.click($.proxy(this.mouseclick, this));
        },

        reset: function (removeTooltip) {
            this.splist = [];
            if (this.tooltip && removeTooltip) {
                this.tooltip.remove();
                this.tooltip = undefined;
            }
        },

        mouseclick: function (e) {
            var clickEvent = $.Event('sparklineClick');
            clickEvent.originalEvent = e;
            clickEvent.sparklines = this.splist;
            this.$el.trigger(clickEvent);
        },

        mouseenter: function (e) {
            $(document.body).unbind('mousemove.jqs');
            $(document.body).bind('mousemove.jqs', $.proxy(this.mousemove, this));
            this.over = true;
            this.currentPageX = e.pageX;
            this.currentPageY = e.pageY;
            this.currentEl = e.target;
            if (!this.tooltip && this.displayTooltips) {
                this.tooltip = new Tooltip(this.options);
                this.tooltip.updatePosition(e.pageX, e.pageY);
            }
            this.updateDisplay();
        },

        mouseleave: function () {
            $(document.body).unbind('mousemove.jqs');
            var splist = this.splist,
                 spcount = splist.length,
                 needsRefresh = false,
                 sp, i;
            this.over = false;
            this.currentEl = null;

            if (this.tooltip) {
                this.tooltip.remove();
                this.tooltip = null;
            }

            for (i = 0; i < spcount; i++) {
                sp = splist[i];
                if (sp.clearRegionHighlight()) {
                    needsRefresh = true;
                }
            }

            if (needsRefresh) {
                this.canvas.render();
            }
        },

        mousemove: function (e) {
            this.currentPageX = e.pageX;
            this.currentPageY = e.pageY;
            this.currentEl = e.target;
            if (this.tooltip) {
                this.tooltip.updatePosition(e.pageX, e.pageY);
            }
            this.updateDisplay();
        },

        updateDisplay: function () {
            var splist = this.splist,
                 spcount = splist.length,
                 needsRefresh = false,
                 offset = this.$canvas.offset(),
                 localX = this.currentPageX - offset.left,
                 localY = this.currentPageY - offset.top,
                 tooltiphtml, sp, i, result, changeEvent;
            if (!this.over) {
                return;
            }
            for (i = 0; i < spcount; i++) {
                sp = splist[i];
                result = sp.setRegionHighlight(this.currentEl, localX, localY);
                if (result) {
                    needsRefresh = true;
                }
            }
            if (needsRefresh) {
                changeEvent = $.Event('sparklineRegionChange');
                changeEvent.sparklines = this.splist;
                this.$el.trigger(changeEvent);
                if (this.tooltip) {
                    tooltiphtml = '';
                    for (i = 0; i < spcount; i++) {
                        sp = splist[i];
                        tooltiphtml += sp.getCurrentRegionTooltip();
                    }
                    this.tooltip.setContent(tooltiphtml);
                }
                if (!this.disableHighlight) {
                    this.canvas.render();
                }
            }
            if (result === null) {
                this.mouseleave();
            }
        }
    });


    Tooltip = createClass({
        sizeStyle: 'position: static !important;' +
            'display: block !important;' +
            'visibility: hidden !important;' +
            'float: left !important;',

        init: function (options) {
            var tooltipClassname = options.get('tooltipClassname', 'jqstooltip'),
                sizetipStyle = this.sizeStyle,
                offset;
            this.container = options.get('tooltipContainer') || document.body;
            this.tooltipOffsetX = options.get('tooltipOffsetX', 10);
            this.tooltipOffsetY = options.get('tooltipOffsetY', 12);
            // remove any previous lingering tooltip
            $('#jqssizetip').remove();
            $('#jqstooltip').remove();
            this.sizetip = $('<div/>', {
                id: 'jqssizetip',
                style: sizetipStyle,
                'class': tooltipClassname
            });
            this.tooltip = $('<div/>', {
                id: 'jqstooltip',
                'class': tooltipClassname
            }).appendTo(this.container);
            // account for the container's location
            offset = this.tooltip.offset();
            this.offsetLeft = offset.left;
            this.offsetTop = offset.top;
            this.hidden = true;
            $(window).unbind('resize.jqs scroll.jqs');
            $(window).bind('resize.jqs scroll.jqs', $.proxy(this.updateWindowDims, this));
            this.updateWindowDims();
        },

        updateWindowDims: function () {
            this.scrollTop = $(window).scrollTop();
            this.scrollLeft = $(window).scrollLeft();
            this.scrollRight = this.scrollLeft + $(window).width();
            this.updatePosition();
        },

        getSize: function (content) {
            this.sizetip.html(content).appendTo(this.container);
            this.width = this.sizetip.width() + 1;
            this.height = this.sizetip.height();
            this.sizetip.remove();
        },

        setContent: function (content) {
            if (!content) {
                this.tooltip.css('visibility', 'hidden');
                this.hidden = true;
                return;
            }
            this.getSize(content);
            this.tooltip.html(content)
                .css({
                    'width': this.width,
                    'height': this.height,
                    'visibility': 'visible'
                });
            if (this.hidden) {
                this.hidden = false;
                this.updatePosition();
            }
        },

        updatePosition: function (x, y) {
            if (x === undefined) {
                if (this.mousex === undefined) {
                    return;
                }
                x = this.mousex - this.offsetLeft;
                y = this.mousey - this.offsetTop;

            } else {
                this.mousex = x = x - this.offsetLeft;
                this.mousey = y = y - this.offsetTop;
            }
            if (!this.height || !this.width || this.hidden) {
                return;
            }

            y -= this.height + this.tooltipOffsetY;
            x += this.tooltipOffsetX;

            if (y < this.scrollTop) {
                y = this.scrollTop;
            }
            if (x < this.scrollLeft) {
                x = this.scrollLeft;
            } else if (x + this.width > this.scrollRight) {
                x = this.scrollRight - this.width;
            }

            this.tooltip.css({
                'left': x,
                'top': y
            });
        },

        remove: function () {
            this.tooltip.remove();
            this.sizetip.remove();
            this.sizetip = this.tooltip = undefined;
            $(window).unbind('resize.jqs scroll.jqs');
        }
    });

    initStyles = function() {
        addCSS(defaultStyles);
    };

    $(initStyles);

    pending = [];
    $.fn.sparkline = function (userValues, userOptions) {
        return this.each(function () {
            var options = new $.fn.sparkline.options(this, userOptions),
                 $this = $(this),
                 render, i;
            render = function () {
                var values, width, height, tmp, mhandler, sp, vals;
                if (userValues === 'html' || userValues === undefined) {
                    vals = this.getAttribute(options.get('tagValuesAttribute'));
                    if (vals === undefined || vals === null) {
                        vals = $this.html();
                    }
                    values = vals.replace(/(^\s*<!--)|(-->\s*$)|\s+/g, '').split(',');
                } else {
                    values = userValues;
                }

                width = options.get('width') === 'auto' ? values.length * options.get('defaultPixelsPerValue') : options.get('width');
                if (options.get('height') === 'auto') {
                    if (!options.get('composite') || !$.data(this, '_jqs_vcanvas')) {
                        // must be a better way to get the line height
                        tmp = document.createElement('span');
                        tmp.innerHTML = 'a';
                        $this.html(tmp);
                        height = $(tmp).innerHeight() || $(tmp).height();
                        $(tmp).remove();
                        tmp = null;
                    }
                } else {
                    height = options.get('height');
                }

                if (!options.get('disableInteraction')) {
                    mhandler = $.data(this, '_jqs_mhandler');
                    if (!mhandler) {
                        mhandler = new MouseHandler(this, options);
                        $.data(this, '_jqs_mhandler', mhandler);
                    } else if (!options.get('composite')) {
                        mhandler.reset();
                    }
                } else {
                    mhandler = false;
                }

                if (options.get('composite') && !$.data(this, '_jqs_vcanvas')) {
                    if (!$.data(this, '_jqs_errnotify')) {
                        alert('Attempted to attach a composite sparkline to an element with no existing sparkline');
                        $.data(this, '_jqs_errnotify', true);
                    }
                    return;
                }

                sp = new $.fn.sparkline[options.get('type')](this, values, options, width, height);

                sp.render();

                if (mhandler) {
                    mhandler.registerSparkline(sp);
                }
            };
            if (($(this).html() && !options.get('disableHiddenCheck') && $(this).is(':hidden')) || !$(this).parents('body').length) {
                if (!options.get('composite') && $.data(this, '_jqs_pending')) {
                    // remove any existing references to the element
                    for (i = pending.length; i; i--) {
                        if (pending[i - 1][0] == this) {
                            pending.splice(i - 1, 1);
                        }
                    }
                }
                pending.push([this, render]);
                $.data(this, '_jqs_pending', true);
            } else {
                render.call(this);
            }
        });
    };

    $.fn.sparkline.defaults = getDefaults();


    $.sparkline_display_visible = function () {
        var el, i, pl;
        var done = [];
        for (i = 0, pl = pending.length; i < pl; i++) {
            el = pending[i][0];
            if ($(el).is(':visible') && !$(el).parents().is(':hidden')) {
                pending[i][1].call(el);
                $.data(pending[i][0], '_jqs_pending', false);
                done.push(i);
            } else if (!$(el).closest('html').length && !$.data(el, '_jqs_pending')) {
                // element has been inserted and removed from the DOM
                // If it was not yet inserted into the dom then the .data request
                // will return true.
                // removing from the dom causes the data to be removed.
                $.data(pending[i][0], '_jqs_pending', false);
                done.push(i);
            }
        }
        for (i = done.length; i; i--) {
            pending.splice(done[i - 1], 1);
        }
    };


    /**
     * User option handler
     */
    $.fn.sparkline.options = createClass({
        init: function (tag, userOptions) {
            var extendedOptions, defaults, base, tagOptionType;
            this.userOptions = userOptions = userOptions || {};
            this.tag = tag;
            this.tagValCache = {};
            defaults = $.fn.sparkline.defaults;
            base = defaults.common;
            this.tagOptionsPrefix = userOptions.enableTagOptions && (userOptions.tagOptionsPrefix || base.tagOptionsPrefix);

            tagOptionType = this.getTagSetting('type');
            if (tagOptionType === UNSET_OPTION) {
                extendedOptions = defaults[userOptions.type || base.type];
            } else {
                extendedOptions = defaults[tagOptionType];
            }
            this.mergedOptions = $.extend({}, base, extendedOptions, userOptions);
        },


        getTagSetting: function (key) {
            var prefix = this.tagOptionsPrefix,
                val, i, pairs, keyval;
            if (prefix === false || prefix === undefined) {
                return UNSET_OPTION;
            }
            if (this.tagValCache.hasOwnProperty(key)) {
                val = this.tagValCache.key;
            } else {
                val = this.tag.getAttribute(prefix + key);
                if (val === undefined || val === null) {
                    val = UNSET_OPTION;
                } else if (val.substr(0, 1) === '[') {
                    val = val.substr(1, val.length - 2).split(',');
                    for (i = val.length; i--;) {
                        val[i] = normalizeValue(val[i].replace(/(^\s*)|(\s*$)/g, ''));
                    }
                } else if (val.substr(0, 1) === '{') {
                    pairs = val.substr(1, val.length - 2).split(',');
                    val = {};
                    for (i = pairs.length; i--;) {
                        keyval = pairs[i].split(':', 2);
                        val[keyval[0].replace(/(^\s*)|(\s*$)/g, '')] = normalizeValue(keyval[1].replace(/(^\s*)|(\s*$)/g, ''));
                    }
                } else {
                    val = normalizeValue(val);
                }
                this.tagValCache.key = val;
            }
            return val;
        },

        get: function (key, defaultval) {
            var tagOption = this.getTagSetting(key),
                result;
            if (tagOption !== UNSET_OPTION) {
                return tagOption;
            }
            return (result = this.mergedOptions[key]) === undefined ? defaultval : result;
        }
    });


    $.fn.sparkline._base = createClass({
        disabled: false,

        init: function (el, values, options, width, height) {
            this.el = el;
            this.$el = $(el);
            this.values = values;
            this.options = options;
            this.width = width;
            this.height = height;
            this.currentRegion = undefined;
        },

        /**
         * Setup the canvas
         */
        initTarget: function () {
            var interactive = !this.options.get('disableInteraction');
            if (!(this.target = this.$el.simpledraw(this.width, this.height, this.options.get('composite'), interactive))) {
                this.disabled = true;
            } else {
                this.canvasWidth = this.target.pixelWidth;
                this.canvasHeight = this.target.pixelHeight;
            }
        },

        /**
         * Actually render the chart to the canvas
         */
        render: function () {
            if (this.disabled) {
                this.el.innerHTML = '';
                return false;
            }
            return true;
        },

        /**
         * Return a region id for a given x/y co-ordinate
         */
        getRegion: function (x, y) {
        },

        /**
         * Highlight an item based on the moused-over x,y co-ordinate
         */
        setRegionHighlight: function (el, x, y) {
            var currentRegion = this.currentRegion,
                highlightEnabled = !this.options.get('disableHighlight'),
                newRegion;
            if (x > this.canvasWidth || y > this.canvasHeight || x < 0 || y < 0) {
                return null;
            }
            newRegion = this.getRegion(el, x, y);
            if (currentRegion !== newRegion) {
                if (currentRegion !== undefined && highlightEnabled) {
                    this.removeHighlight();
                }
                this.currentRegion = newRegion;
                if (newRegion !== undefined && highlightEnabled) {
                    this.renderHighlight();
                }
                return true;
            }
            return false;
        },

        /**
         * Reset any currently highlighted item
         */
        clearRegionHighlight: function () {
            if (this.currentRegion !== undefined) {
                this.removeHighlight();
                this.currentRegion = undefined;
                return true;
            }
            return false;
        },

        renderHighlight: function () {
            this.changeHighlight(true);
        },

        removeHighlight: function () {
            this.changeHighlight(false);
        },

        changeHighlight: function (highlight)  {},

        /**
         * Fetch the HTML to display as a tooltip
         */
        getCurrentRegionTooltip: function () {
            var options = this.options,
                header = '',
                entries = [],
                fields, formats, formatlen, fclass, text, i,
                showFields, showFieldsKey, newFields, fv,
                formatter, format, fieldlen, j;
            if (this.currentRegion === undefined) {
                return '';
            }
            fields = this.getCurrentRegionFields();
            formatter = options.get('tooltipFormatter');
            if (formatter) {
                return formatter(this, options, fields);
            }
            if (options.get('tooltipChartTitle')) {
                header += '<div class="jqs jqstitle">' + options.get('tooltipChartTitle') + '</div>\n';
            }
            formats = this.options.get('tooltipFormat');
            if (!formats) {
                return '';
            }
            if (!$.isArray(formats)) {
                formats = [formats];
            }
            if (!$.isArray(fields)) {
                fields = [fields];
            }
            showFields = this.options.get('tooltipFormatFieldlist');
            showFieldsKey = this.options.get('tooltipFormatFieldlistKey');
            if (showFields && showFieldsKey) {
                // user-selected ordering of fields
                newFields = [];
                for (i = fields.length; i--;) {
                    fv = fields[i][showFieldsKey];
                    if ((j = $.inArray(fv, showFields)) != -1) {
                        newFields[j] = fields[i];
                    }
                }
                fields = newFields;
            }
            formatlen = formats.length;
            fieldlen = fields.length;
            for (i = 0; i < formatlen; i++) {
                format = formats[i];
                if (typeof format === 'string') {
                    format = new SPFormat(format);
                }
                fclass = format.fclass || 'jqsfield';
                for (j = 0; j < fieldlen; j++) {
                    if (!fields[j].isNull || !options.get('tooltipSkipNull')) {
                        $.extend(fields[j], {
                            prefix: options.get('tooltipPrefix'),
                            suffix: options.get('tooltipSuffix')
                        });
                        text = format.render(fields[j], options.get('tooltipValueLookups'), options);
                        entries.push('<div class="' + fclass + '">' + text + '</div>');
                    }
                }
            }
            if (entries.length) {
                return header + entries.join('\n');
            }
            return '';
        },

        getCurrentRegionFields: function () {},

        calcHighlightColor: function (color, options) {
            var highlightColor = options.get('highlightColor'),
                lighten = options.get('highlightLighten'),
                parse, mult, rgbnew, i;
            if (highlightColor) {
                return highlightColor;
            }
            if (lighten) {
                // extract RGB values
                parse = /^#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(color) || /^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(color);
                if (parse) {
                    rgbnew = [];
                    mult = color.length === 4 ? 16 : 1;
                    for (i = 0; i < 3; i++) {
                        rgbnew[i] = clipval(Math.round(parseInt(parse[i + 1], 16) * mult * lighten), 0, 255);
                    }
                    return 'rgb(' + rgbnew.join(',') + ')';
                }

            }
            return color;
        }

    });

    barHighlightMixin = {
        changeHighlight: function (highlight) {
            var currentRegion = this.currentRegion,
                target = this.target,
                shapeids = this.regionShapes[currentRegion],
                newShapes;
            // will be null if the region value was null
            if (shapeids) {
                newShapes = this.renderRegion(currentRegion, highlight);
                if ($.isArray(newShapes) || $.isArray(shapeids)) {
                    target.replaceWithShapes(shapeids, newShapes);
                    this.regionShapes[currentRegion] = $.map(newShapes, function (newShape) {
                        return newShape.id;
                    });
                } else {
                    target.replaceWithShape(shapeids, newShapes);
                    this.regionShapes[currentRegion] = newShapes.id;
                }
            }
        },

        render: function () {
            var values = this.values,
                target = this.target,
                regionShapes = this.regionShapes,
                shapes, ids, i, j;

            if (!this.cls._super.render.call(this)) {
                return;
            }
            for (i = values.length; i--;) {
                shapes = this.renderRegion(i);
                if (shapes) {
                    if ($.isArray(shapes)) {
                        ids = [];
                        for (j = shapes.length; j--;) {
                            shapes[j].append();
                            ids.push(shapes[j].id);
                        }
                        regionShapes[i] = ids;
                    } else {
                        shapes.append();
                        regionShapes[i] = shapes.id; // store just the shapeid
                    }
                } else {
                    // null value
                    regionShapes[i] = null;
                }
            }
            target.render();
        }
    };

    /**
     * Line charts
     */
    $.fn.sparkline.line = line = createClass($.fn.sparkline._base, {
        type: 'line',

        init: function (el, values, options, width, height) {
            line._super.init.call(this, el, values, options, width, height);
            this.vertices = [];
            this.regionMap = [];
            this.xvalues = [];
            this.yvalues = [];
            this.yminmax = [];
            this.hightlightSpotId = null;
            this.lastShapeId = null;
            this.initTarget();
        },

        getRegion: function (el, x, y) {
            var i,
                regionMap = this.regionMap; // maps regions to value positions
            for (i = regionMap.length; i--;) {
                if (regionMap[i] !== null && x >= regionMap[i][0] && x <= regionMap[i][1]) {
                    return regionMap[i][2];
                }
            }
            return undefined;
        },

        getCurrentRegionFields: function () {
            var currentRegion = this.currentRegion;
            return {
                isNull: this.yvalues[currentRegion] === null,
                x: this.xvalues[currentRegion],
                y: this.yvalues[currentRegion],
                color: this.options.get('lineColor'),
                fillColor: this.options.get('fillColor'),
                offset: currentRegion
            };
        },

        renderHighlight: function () {
            var currentRegion = this.currentRegion,
                target = this.target,
                vertex = this.vertices[currentRegion],
                options = this.options,
                spotRadius = options.get('spotRadius'),
                highlightSpotColor = options.get('highlightSpotColor'),
                highlightLineColor = options.get('highlightLineColor'),
                highlightSpot, highlightLine;

            if (!vertex) {
                return;
            }
            if (spotRadius && highlightSpotColor) {
                highlightSpot = target.drawCircle(vertex[0], vertex[1],
                    spotRadius, undefined, highlightSpotColor);
                this.highlightSpotId = highlightSpot.id;
                target.insertAfterShape(this.lastShapeId, highlightSpot);
            }
            if (highlightLineColor) {
                highlightLine = target.drawLine(vertex[0], this.canvasTop, vertex[0],
                    this.canvasTop + this.canvasHeight, highlightLineColor);
                this.highlightLineId = highlightLine.id;
                target.insertAfterShape(this.lastShapeId, highlightLine);
            }
        },

        removeHighlight: function () {
            var target = this.target;
            if (this.highlightSpotId) {
                target.removeShapeId(this.highlightSpotId);
                this.highlightSpotId = null;
            }
            if (this.highlightLineId) {
                target.removeShapeId(this.highlightLineId);
                this.highlightLineId = null;
            }
        },

        scanValues: function () {
            var values = this.values,
                valcount = values.length,
                xvalues = this.xvalues,
                yvalues = this.yvalues,
                yminmax = this.yminmax,
                i, val, isStr, isArray, sp;
            for (i = 0; i < valcount; i++) {
                val = values[i];
                isStr = typeof(values[i]) === 'string';
                isArray = typeof(values[i]) === 'object' && values[i] instanceof Array;
                sp = isStr && values[i].split(':');
                if (isStr && sp.length === 2) { // x:y
                    xvalues.push(Number(sp[0]));
                    yvalues.push(Number(sp[1]));
                    yminmax.push(Number(sp[1]));
                } else if (isArray) {
                    xvalues.push(val[0]);
                    yvalues.push(val[1]);
                    yminmax.push(val[1]);
                } else {
                    xvalues.push(i);
                    if (values[i] === null || values[i] === 'null') {
                        yvalues.push(null);
                    } else {
                        yvalues.push(Number(val));
                        yminmax.push(Number(val));
                    }
                }
            }
            if (this.options.get('xvalues')) {
                xvalues = this.options.get('xvalues');
            }

            this.maxy = this.maxyorg = Math.max.apply(Math, yminmax);
            this.miny = this.minyorg = Math.min.apply(Math, yminmax);

            this.maxx = Math.max.apply(Math, xvalues);
            this.minx = Math.min.apply(Math, xvalues);

            this.xvalues = xvalues;
            this.yvalues = yvalues;
            this.yminmax = yminmax;

        },

        processRangeOptions: function () {
            var options = this.options,
                normalRangeMin = options.get('normalRangeMin'),
                normalRangeMax = options.get('normalRangeMax');

            if (normalRangeMin !== undefined) {
                if (normalRangeMin < this.miny) {
                    this.miny = normalRangeMin;
                }
                if (normalRangeMax > this.maxy) {
                    this.maxy = normalRangeMax;
                }
            }
            if (options.get('chartRangeMin') !== undefined && (options.get('chartRangeClip') || options.get('chartRangeMin') < this.miny)) {
                this.miny = options.get('chartRangeMin');
            }
            if (options.get('chartRangeMax') !== undefined && (options.get('chartRangeClip') || options.get('chartRangeMax') > this.maxy)) {
                this.maxy = options.get('chartRangeMax');
            }
            if (options.get('chartRangeMinX') !== undefined && (options.get('chartRangeClipX') || options.get('chartRangeMinX') < this.minx)) {
                this.minx = options.get('chartRangeMinX');
            }
            if (options.get('chartRangeMaxX') !== undefined && (options.get('chartRangeClipX') || options.get('chartRangeMaxX') > this.maxx)) {
                this.maxx = options.get('chartRangeMaxX');
            }

        },

        drawNormalRange: function (canvasLeft, canvasTop, canvasHeight, canvasWidth, rangey) {
            var normalRangeMin = this.options.get('normalRangeMin'),
                normalRangeMax = this.options.get('normalRangeMax'),
                ytop = canvasTop + Math.round(canvasHeight - (canvasHeight * ((normalRangeMax - this.miny) / rangey))),
                height = Math.round((canvasHeight * (normalRangeMax - normalRangeMin)) / rangey);
            this.target.drawRect(canvasLeft, ytop, canvasWidth, height, undefined, this.options.get('normalRangeColor')).append();
        },

        render: function () {
            var options = this.options,
                target = this.target,
                canvasWidth = this.canvasWidth,
                canvasHeight = this.canvasHeight,
                vertices = this.vertices,
                spotRadius = options.get('spotRadius'),
                regionMap = this.regionMap,
                rangex, rangey, yvallast,
                canvasTop, canvasLeft,
                vertex, path, paths, x, y, xnext, xpos, xposnext,
                last, next, yvalcount, lineShapes, fillShapes, plen,
                valueSpots, hlSpotsEnabled, color, xvalues, yvalues, i;

            if (!line._super.render.call(this)) {
                return;
            }

            this.scanValues();
            this.processRangeOptions();

            xvalues = this.xvalues;
            yvalues = this.yvalues;

            if (!this.yminmax.length || this.yvalues.length < 2) {
                // empty or all null valuess
                return;
            }

            canvasTop = canvasLeft = 0;

            rangex = this.maxx - this.minx === 0 ? 1 : this.maxx - this.minx;
            rangey = this.maxy - this.miny === 0 ? 1 : this.maxy - this.miny;
            yvallast = this.yvalues.length - 1;

            if (spotRadius && (canvasWidth < (spotRadius * 4) || canvasHeight < (spotRadius * 4))) {
                spotRadius = 0;
            }
            if (spotRadius) {
                // adjust the canvas size as required so that spots will fit
                hlSpotsEnabled = options.get('highlightSpotColor') &&  !options.get('disableInteraction');
                if (hlSpotsEnabled || options.get('minSpotColor') || (options.get('spotColor') && yvalues[yvallast] === this.miny)) {
                    canvasHeight -= Math.ceil(spotRadius);
                }
                if (hlSpotsEnabled || options.get('maxSpotColor') || (options.get('spotColor') && yvalues[yvallast] === this.maxy)) {
                    canvasHeight -= Math.ceil(spotRadius);
                    canvasTop += Math.ceil(spotRadius);
                }
                if (hlSpotsEnabled ||
                     ((options.get('minSpotColor') || options.get('maxSpotColor')) && (yvalues[0] === this.miny || yvalues[0] === this.maxy))) {
                    canvasLeft += Math.ceil(spotRadius);
                    canvasWidth -= Math.ceil(spotRadius);
                }
                if (hlSpotsEnabled || options.get('spotColor') ||
                    (options.get('minSpotColor') || options.get('maxSpotColor') &&
                        (yvalues[yvallast] === this.miny || yvalues[yvallast] === this.maxy))) {
                    canvasWidth -= Math.ceil(spotRadius);
                }
            }


            canvasHeight--;

            if (options.get('normalRangeMin') !== undefined && !options.get('drawNormalOnTop')) {
                this.drawNormalRange(canvasLeft, canvasTop, canvasHeight, canvasWidth, rangey);
            }

            path = [];
            paths = [path];
            last = next = null;
            yvalcount = yvalues.length;
            for (i = 0; i < yvalcount; i++) {
                x = xvalues[i];
                xnext = xvalues[i + 1];
                y = yvalues[i];
                xpos = canvasLeft + Math.round((x - this.minx) * (canvasWidth / rangex));
                xposnext = i < yvalcount - 1 ? canvasLeft + Math.round((xnext - this.minx) * (canvasWidth / rangex)) : canvasWidth;
                next = xpos + ((xposnext - xpos) / 2);
                regionMap[i] = [last || 0, next, i];
                last = next;
                if (y === null) {
                    if (i) {
                        if (yvalues[i - 1] !== null) {
                            path = [];
                            paths.push(path);
                        }
                        vertices.push(null);
                    }
                } else {
                    if (y < this.miny) {
                        y = this.miny;
                    }
                    if (y > this.maxy) {
                        y = this.maxy;
                    }
                    if (!path.length) {
                        // previous value was null
                        path.push([xpos, canvasTop + canvasHeight]);
                    }
                    vertex = [xpos, canvasTop + Math.round(canvasHeight - (canvasHeight * ((y - this.miny) / rangey)))];
                    path.push(vertex);
                    vertices.push(vertex);
                }
            }

            lineShapes = [];
            fillShapes = [];
            plen = paths.length;
            for (i = 0; i < plen; i++) {
                path = paths[i];
                if (path.length) {
                    if (options.get('fillColor')) {
                        path.push([path[path.length - 1][0], (canvasTop + canvasHeight)]);
                        fillShapes.push(path.slice(0));
                        path.pop();
                    }
                    // if there's only a single point in this path, then we want to display it
                    // as a vertical line which means we keep path[0]  as is
                    if (path.length > 2) {
                        // else we want the first value
                        path[0] = [path[0][0], path[1][1]];
                    }
                    lineShapes.push(path);
                }
            }

            // draw the fill first, then optionally the normal range, then the line on top of that
            plen = fillShapes.length;
            for (i = 0; i < plen; i++) {
                target.drawShape(fillShapes[i],
                    options.get('fillColor'), options.get('fillColor')).append();
            }

            if (options.get('normalRangeMin') !== undefined && options.get('drawNormalOnTop')) {
                this.drawNormalRange(canvasLeft, canvasTop, canvasHeight, canvasWidth, rangey);
            }

            plen = lineShapes.length;
            for (i = 0; i < plen; i++) {
                target.drawShape(lineShapes[i], options.get('lineColor'), undefined,
                    options.get('lineWidth')).append();
            }

            if (spotRadius && options.get('valueSpots')) {
                valueSpots = options.get('valueSpots');
                if (valueSpots.get === undefined) {
                    valueSpots = new RangeMap(valueSpots);
                }
                for (i = 0; i < yvalcount; i++) {
                    color = valueSpots.get(yvalues[i]);
                    if (color) {
                        target.drawCircle(canvasLeft + Math.round((xvalues[i] - this.minx) * (canvasWidth / rangex)),
                            canvasTop + Math.round(canvasHeight - (canvasHeight * ((yvalues[i] - this.miny) / rangey))),
                            spotRadius, undefined,
                            color).append();
                    }
                }

            }
            if (spotRadius && options.get('spotColor') && yvalues[yvallast] !== null) {
                target.drawCircle(canvasLeft + Math.round((xvalues[xvalues.length - 1] - this.minx) * (canvasWidth / rangex)),
                    canvasTop + Math.round(canvasHeight - (canvasHeight * ((yvalues[yvallast] - this.miny) / rangey))),
                    spotRadius, undefined,
                    options.get('spotColor')).append();
            }
            if (this.maxy !== this.minyorg) {
                if (spotRadius && options.get('minSpotColor')) {
                    x = xvalues[$.inArray(this.minyorg, yvalues)];
                    target.drawCircle(canvasLeft + Math.round((x - this.minx) * (canvasWidth / rangex)),
                        canvasTop + Math.round(canvasHeight - (canvasHeight * ((this.minyorg - this.miny) / rangey))),
                        spotRadius, undefined,
                        options.get('minSpotColor')).append();
                }
                if (spotRadius && options.get('maxSpotColor')) {
                    x = xvalues[$.inArray(this.maxyorg, yvalues)];
                    target.drawCircle(canvasLeft + Math.round((x - this.minx) * (canvasWidth / rangex)),
                        canvasTop + Math.round(canvasHeight - (canvasHeight * ((this.maxyorg - this.miny) / rangey))),
                        spotRadius, undefined,
                        options.get('maxSpotColor')).append();
                }
            }

            this.lastShapeId = target.getLastShapeId();
            this.canvasTop = canvasTop;
            target.render();
        }
    });

    /**
     * Bar charts
     */
    $.fn.sparkline.bar = bar = createClass($.fn.sparkline._base, barHighlightMixin, {
        type: 'bar',

        init: function (el, values, options, width, height) {
            var barWidth = parseInt(options.get('barWidth'), 10),
                barSpacing = parseInt(options.get('barSpacing'), 10),
                chartRangeMin = options.get('chartRangeMin'),
                chartRangeMax = options.get('chartRangeMax'),
                chartRangeClip = options.get('chartRangeClip'),
                stackMin = Infinity,
                stackMax = -Infinity,
                isStackString, groupMin, groupMax, stackRanges,
                numValues, i, vlen, range, zeroAxis, xaxisOffset, min, max, clipMin, clipMax,
                stacked, vlist, j, slen, svals, val, yoffset, yMaxCalc, canvasHeightEf;
            bar._super.init.call(this, el, values, options, width, height);

            // scan values to determine whether to stack bars
            for (i = 0, vlen = values.length; i < vlen; i++) {
                val = values[i];
                isStackString = typeof(val) === 'string' && val.indexOf(':') > -1;
                if (isStackString || $.isArray(val)) {
                    stacked = true;
                    if (isStackString) {
                        val = values[i] = normalizeValues(val.split(':'));
                    }
                    val = remove(val, null); // min/max will treat null as zero
                    groupMin = Math.min.apply(Math, val);
                    groupMax = Math.max.apply(Math, val);
                    if (groupMin < stackMin) {
                        stackMin = groupMin;
                    }
                    if (groupMax > stackMax) {
                        stackMax = groupMax;
                    }
                }
            }

            this.stacked = stacked;
            this.regionShapes = {};
            this.barWidth = barWidth;
            this.barSpacing = barSpacing;
            this.totalBarWidth = barWidth + barSpacing;
            this.width = width = (values.length * barWidth) + ((values.length - 1) * barSpacing);

            this.initTarget();

            if (chartRangeClip) {
                clipMin = chartRangeMin === undefined ? -Infinity : chartRangeMin;
                clipMax = chartRangeMax === undefined ? Infinity : chartRangeMax;
            }

            numValues = [];
            stackRanges = stacked ? [] : numValues;
            var stackTotals = [];
            var stackRangesNeg = [];
            for (i = 0, vlen = values.length; i < vlen; i++) {
                if (stacked) {
                    vlist = values[i];
                    values[i] = svals = [];
                    stackTotals[i] = 0;
                    stackRanges[i] = stackRangesNeg[i] = 0;
                    for (j = 0, slen = vlist.length; j < slen; j++) {
                        val = svals[j] = chartRangeClip ? clipval(vlist[j], clipMin, clipMax) : vlist[j];
                        if (val !== null) {
                            if (val > 0) {
                                stackTotals[i] += val;
                            }
                            if (stackMin < 0 && stackMax > 0) {
                                if (val < 0) {
                                    stackRangesNeg[i] += Math.abs(val);
                                } else {
                                    stackRanges[i] += val;
                                }
                            } else {
                                stackRanges[i] += Math.abs(val - (val < 0 ? stackMax : stackMin));
                            }
                            numValues.push(val);
                        }
                    }
                } else {
                    val = chartRangeClip ? clipval(values[i], clipMin, clipMax) : values[i];
                    val = values[i] = normalizeValue(val);
                    if (val !== null) {
                        numValues.push(val);
                    }
                }
            }
            this.max = max = Math.max.apply(Math, numValues);
            this.min = min = Math.min.apply(Math, numValues);
            this.stackMax = stackMax = stacked ? Math.max.apply(Math, stackTotals) : max;
            this.stackMin = stackMin = stacked ? Math.min.apply(Math, numValues) : min;

            if (options.get('chartRangeMin') !== undefined && (options.get('chartRangeClip') || options.get('chartRangeMin') < min)) {
                min = options.get('chartRangeMin');
            }
            if (options.get('chartRangeMax') !== undefined && (options.get('chartRangeClip') || options.get('chartRangeMax') > max)) {
                max = options.get('chartRangeMax');
            }

            this.zeroAxis = zeroAxis = options.get('zeroAxis', true);
            if (min <= 0 && max >= 0 && zeroAxis) {
                xaxisOffset = 0;
            } else if (zeroAxis == false) {
                xaxisOffset = min;
            } else if (min > 0) {
                xaxisOffset = min;
            } else {
                xaxisOffset = max;
            }
            this.xaxisOffset = xaxisOffset;

            range = stacked ? (Math.max.apply(Math, stackRanges) + Math.max.apply(Math, stackRangesNeg)) : max - min;

            // as we plot zero/min values a single pixel line, we add a pixel to all other
            // values - Reduce the effective canvas size to suit
            this.canvasHeightEf = (zeroAxis && min < 0) ? this.canvasHeight - 2 : this.canvasHeight - 1;

            if (min < xaxisOffset) {
                yMaxCalc = (stacked && max >= 0) ? stackMax : max;
                yoffset = (yMaxCalc - xaxisOffset) / range * this.canvasHeight;
                if (yoffset !== Math.ceil(yoffset)) {
                    this.canvasHeightEf -= 2;
                    yoffset = Math.ceil(yoffset);
                }
            } else {
                yoffset = this.canvasHeight;
            }
            this.yoffset = yoffset;

            if ($.isArray(options.get('colorMap'))) {
                this.colorMapByIndex = options.get('colorMap');
                this.colorMapByValue = null;
            } else {
                this.colorMapByIndex = null;
                this.colorMapByValue = options.get('colorMap');
                if (this.colorMapByValue && this.colorMapByValue.get === undefined) {
                    this.colorMapByValue = new RangeMap(this.colorMapByValue);
                }
            }

            this.range = range;
        },

        getRegion: function (el, x, y) {
            var result = Math.floor(x / this.totalBarWidth);
            return (result < 0 || result >= this.values.length) ? undefined : result;
        },

        getCurrentRegionFields: function () {
            var currentRegion = this.currentRegion,
                values = ensureArray(this.values[currentRegion]),
                result = [],
                value, i;
            for (i = values.length; i--;) {
                value = values[i];
                result.push({
                    isNull: value === null,
                    value: value,
                    color: this.calcColor(i, value, currentRegion),
                    offset: currentRegion
                });
            }
            return result;
        },

        calcColor: function (stacknum, value, valuenum) {
            var colorMapByIndex = this.colorMapByIndex,
                colorMapByValue = this.colorMapByValue,
                options = this.options,
                color, newColor;
            if (this.stacked) {
                color = options.get('stackedBarColor');
            } else {
                color = (value < 0) ? options.get('negBarColor') : options.get('barColor');
            }
            if (value === 0 && options.get('zeroColor') !== undefined) {
                color = options.get('zeroColor');
            }
            if (colorMapByValue && (newColor = colorMapByValue.get(value))) {
                color = newColor;
            } else if (colorMapByIndex && colorMapByIndex.length > valuenum) {
                color = colorMapByIndex[valuenum];
            }
            return $.isArray(color) ? color[stacknum % color.length] : color;
        },

        /**
         * Render bar(s) for a region
         */
        renderRegion: function (valuenum, highlight) {
            var vals = this.values[valuenum],
                options = this.options,
                xaxisOffset = this.xaxisOffset,
                result = [],
                range = this.range,
                stacked = this.stacked,
                target = this.target,
                x = valuenum * this.totalBarWidth,
                canvasHeightEf = this.canvasHeightEf,
                yoffset = this.yoffset,
                y, height, color, isNull, yoffsetNeg, i, valcount, val, minPlotted, allMin;

            vals = $.isArray(vals) ? vals : [vals];
            valcount = vals.length;
            val = vals[0];
            isNull = all(null, vals);
            allMin = all(xaxisOffset, vals, true);

            if (isNull) {
                if (options.get('nullColor')) {
                    color = highlight ? options.get('nullColor') : this.calcHighlightColor(options.get('nullColor'), options);
                    y = (yoffset > 0) ? yoffset - 1 : yoffset;
                    return target.drawRect(x, y, this.barWidth - 1, 0, color, color);
                } else {
                    return undefined;
                }
            }
            yoffsetNeg = yoffset;
            for (i = 0; i < valcount; i++) {
                val = vals[i];

                if (stacked && val === xaxisOffset) {
                    if (!allMin || minPlotted) {
                        continue;
                    }
                    minPlotted = true;
                }

                if (range > 0) {
                    height = Math.floor(canvasHeightEf * ((Math.abs(val - xaxisOffset) / range))) + 1;
                } else {
                    height = 1;
                }
                if (val < xaxisOffset || (val === xaxisOffset && yoffset === 0)) {
                    y = yoffsetNeg;
                    yoffsetNeg += height;
                } else {
                    y = yoffset - height;
                    yoffset -= height;
                }
                color = this.calcColor(i, val, valuenum);
                if (highlight) {
                    color = this.calcHighlightColor(color, options);
                }
                result.push(target.drawRect(x, y, this.barWidth - 1, height - 1, color, color));
            }
            if (result.length === 1) {
                return result[0];
            }
            return result;
        }
    });

    /**
     * Tristate charts
     */
    $.fn.sparkline.tristate = tristate = createClass($.fn.sparkline._base, barHighlightMixin, {
        type: 'tristate',

        init: function (el, values, options, width, height) {
            var barWidth = parseInt(options.get('barWidth'), 10),
                barSpacing = parseInt(options.get('barSpacing'), 10);
            tristate._super.init.call(this, el, values, options, width, height);

            this.regionShapes = {};
            this.barWidth = barWidth;
            this.barSpacing = barSpacing;
            this.totalBarWidth = barWidth + barSpacing;
            this.values = $.map(values, Number);
            this.width = width = (values.length * barWidth) + ((values.length - 1) * barSpacing);

            if ($.isArray(options.get('colorMap'))) {
                this.colorMapByIndex = options.get('colorMap');
                this.colorMapByValue = null;
            } else {
                this.colorMapByIndex = null;
                this.colorMapByValue = options.get('colorMap');
                if (this.colorMapByValue && this.colorMapByValue.get === undefined) {
                    this.colorMapByValue = new RangeMap(this.colorMapByValue);
                }
            }
            this.initTarget();
        },

        getRegion: function (el, x, y) {
            return Math.floor(x / this.totalBarWidth);
        },

        getCurrentRegionFields: function () {
            var currentRegion = this.currentRegion;
            return {
                isNull: this.values[currentRegion] === undefined,
                value: this.values[currentRegion],
                color: this.calcColor(this.values[currentRegion], currentRegion),
                offset: currentRegion
            };
        },

        calcColor: function (value, valuenum) {
            var values = this.values,
                options = this.options,
                colorMapByIndex = this.colorMapByIndex,
                colorMapByValue = this.colorMapByValue,
                color, newColor;

            if (colorMapByValue && (newColor = colorMapByValue.get(value))) {
                color = newColor;
            } else if (colorMapByIndex && colorMapByIndex.length > valuenum) {
                color = colorMapByIndex[valuenum];
            } else if (values[valuenum] < 0) {
                color = options.get('negBarColor');
            } else if (values[valuenum] > 0) {
                color = options.get('posBarColor');
            } else {
                color = options.get('zeroBarColor');
            }
            return color;
        },

        renderRegion: function (valuenum, highlight) {
            var values = this.values,
                options = this.options,
                target = this.target,
                canvasHeight, height, halfHeight,
                x, y, color;

            canvasHeight = target.pixelHeight;
            halfHeight = Math.round(canvasHeight / 2);

            x = valuenum * this.totalBarWidth;
            if (values[valuenum] < 0) {
                y = halfHeight;
                height = halfHeight - 1;
            } else if (values[valuenum] > 0) {
                y = 0;
                height = halfHeight - 1;
            } else {
                y = halfHeight - 1;
                height = 2;
            }
            color = this.calcColor(values[valuenum], valuenum);
            if (color === null) {
                return;
            }
            if (highlight) {
                color = this.calcHighlightColor(color, options);
            }
            return target.drawRect(x, y, this.barWidth - 1, height - 1, color, color);
        }
    });

    /**
     * Discrete charts
     */
    $.fn.sparkline.discrete = discrete = createClass($.fn.sparkline._base, barHighlightMixin, {
        type: 'discrete',

        init: function (el, values, options, width, height) {
            discrete._super.init.call(this, el, values, options, width, height);

            this.regionShapes = {};
            this.values = values = $.map(values, Number);
            this.min = Math.min.apply(Math, values);
            this.max = Math.max.apply(Math, values);
            this.range = this.max - this.min;
            this.width = width = options.get('width') === 'auto' ? values.length * 2 : this.width;
            this.interval = Math.floor(width / values.length);
            this.itemWidth = width / values.length;
            if (options.get('chartRangeMin') !== undefined && (options.get('chartRangeClip') || options.get('chartRangeMin') < this.min)) {
                this.min = options.get('chartRangeMin');
            }
            if (options.get('chartRangeMax') !== undefined && (options.get('chartRangeClip') || options.get('chartRangeMax') > this.max)) {
                this.max = options.get('chartRangeMax');
            }
            this.initTarget();
            if (this.target) {
                this.lineHeight = options.get('lineHeight') === 'auto' ? Math.round(this.canvasHeight * 0.3) : options.get('lineHeight');
            }
        },

        getRegion: function (el, x, y) {
            return Math.floor(x / this.itemWidth);
        },

        getCurrentRegionFields: function () {
            var currentRegion = this.currentRegion;
            return {
                isNull: this.values[currentRegion] === undefined,
                value: this.values[currentRegion],
                offset: currentRegion
            };
        },

        renderRegion: function (valuenum, highlight) {
            var values = this.values,
                options = this.options,
                min = this.min,
                max = this.max,
                range = this.range,
                interval = this.interval,
                target = this.target,
                canvasHeight = this.canvasHeight,
                lineHeight = this.lineHeight,
                pheight = canvasHeight - lineHeight,
                ytop, val, color, x;

            val = clipval(values[valuenum], min, max);
            x = valuenum * interval;
            ytop = Math.round(pheight - pheight * ((val - min) / range));
            color = (options.get('thresholdColor') && val < options.get('thresholdValue')) ? options.get('thresholdColor') : options.get('lineColor');
            if (highlight) {
                color = this.calcHighlightColor(color, options);
            }
            return target.drawLine(x, ytop, x, ytop + lineHeight, color);
        }
    });

    /**
     * Bullet charts
     */
    $.fn.sparkline.bullet = bullet = createClass($.fn.sparkline._base, {
        type: 'bullet',

        init: function (el, values, options, width, height) {
            var min, max, vals;
            bullet._super.init.call(this, el, values, options, width, height);

            // values: target, performance, range1, range2, range3
            this.values = values = normalizeValues(values);
            // target or performance could be null
            vals = values.slice();
            vals[0] = vals[0] === null ? vals[2] : vals[0];
            vals[1] = values[1] === null ? vals[2] : vals[1];
            min = Math.min.apply(Math, values);
            max = Math.max.apply(Math, values);
            if (options.get('base') === undefined) {
                min = min < 0 ? min : 0;
            } else {
                min = options.get('base');
            }
            this.min = min;
            this.max = max;
            this.range = max - min;
            this.shapes = {};
            this.valueShapes = {};
            this.regiondata = {};
            this.width = width = options.get('width') === 'auto' ? '4.0em' : width;
            this.target = this.$el.simpledraw(width, height, options.get('composite'));
            if (!values.length) {
                this.disabled = true;
            }
            this.initTarget();
        },

        getRegion: function (el, x, y) {
            var shapeid = this.target.getShapeAt(el, x, y);
            return (shapeid !== undefined && this.shapes[shapeid] !== undefined) ? this.shapes[shapeid] : undefined;
        },

        getCurrentRegionFields: function () {
            var currentRegion = this.currentRegion;
            return {
                fieldkey: currentRegion.substr(0, 1),
                value: this.values[currentRegion.substr(1)],
                region: currentRegion
            };
        },

        changeHighlight: function (highlight) {
            var currentRegion = this.currentRegion,
                shapeid = this.valueShapes[currentRegion],
                shape;
            delete this.shapes[shapeid];
            switch (currentRegion.substr(0, 1)) {
                case 'r':
                    shape = this.renderRange(currentRegion.substr(1), highlight);
                    break;
                case 'p':
                    shape = this.renderPerformance(highlight);
                    break;
                case 't':
                    shape = this.renderTarget(highlight);
                    break;
            }
            this.valueShapes[currentRegion] = shape.id;
            this.shapes[shape.id] = currentRegion;
            this.target.replaceWithShape(shapeid, shape);
        },

        renderRange: function (rn, highlight) {
            var rangeval = this.values[rn],
                rangewidth = Math.round(this.canvasWidth * ((rangeval - this.min) / this.range)),
                color = this.options.get('rangeColors')[rn - 2];
            if (highlight) {
                color = this.calcHighlightColor(color, this.options);
            }
            return this.target.drawRect(0, 0, rangewidth - 1, this.canvasHeight - 1, color, color);
        },

        renderPerformance: function (highlight) {
            var perfval = this.values[1],
                perfwidth = Math.round(this.canvasWidth * ((perfval - this.min) / this.range)),
                color = this.options.get('performanceColor');
            if (highlight) {
                color = this.calcHighlightColor(color, this.options);
            }
            return this.target.drawRect(0, Math.round(this.canvasHeight * 0.3), perfwidth - 1,
                Math.round(this.canvasHeight * 0.4) - 1, color, color);
        },

        renderTarget: function (highlight) {
            var targetval = this.values[0],
                x = Math.round(this.canvasWidth * ((targetval - this.min) / this.range) - (this.options.get('targetWidth') / 2)),
                targettop = Math.round(this.canvasHeight * 0.10),
                targetheight = this.canvasHeight - (targettop * 2),
                color = this.options.get('targetColor');
            if (highlight) {
                color = this.calcHighlightColor(color, this.options);
            }
            return this.target.drawRect(x, targettop, this.options.get('targetWidth') - 1, targetheight - 1, color, color);
        },

        render: function () {
            var vlen = this.values.length,
                target = this.target,
                i, shape;
            if (!bullet._super.render.call(this)) {
                return;
            }
            for (i = 2; i < vlen; i++) {
                shape = this.renderRange(i).append();
                this.shapes[shape.id] = 'r' + i;
                this.valueShapes['r' + i] = shape.id;
            }
            if (this.values[1] !== null) {
                shape = this.renderPerformance().append();
                this.shapes[shape.id] = 'p1';
                this.valueShapes.p1 = shape.id;
            }
            if (this.values[0] !== null) {
                shape = this.renderTarget().append();
                this.shapes[shape.id] = 't0';
                this.valueShapes.t0 = shape.id;
            }
            target.render();
        }
    });

    /**
     * Pie charts
     */
    $.fn.sparkline.pie = pie = createClass($.fn.sparkline._base, {
        type: 'pie',

        init: function (el, values, options, width, height) {
            var total = 0, i;

            pie._super.init.call(this, el, values, options, width, height);

            this.shapes = {}; // map shape ids to value offsets
            this.valueShapes = {}; // maps value offsets to shape ids
            this.values = values = $.map(values, Number);

            if (options.get('width') === 'auto') {
                this.width = this.height;
            }

            if (values.length > 0) {
                for (i = values.length; i--;) {
                    total += values[i];
                }
            }
            this.total = total;
            this.initTarget();
            this.radius = Math.floor(Math.min(this.canvasWidth, this.canvasHeight) / 2);
        },

        getRegion: function (el, x, y) {
            var shapeid = this.target.getShapeAt(el, x, y);
            return (shapeid !== undefined && this.shapes[shapeid] !== undefined) ? this.shapes[shapeid] : undefined;
        },

        getCurrentRegionFields: function () {
            var currentRegion = this.currentRegion;
            return {
                isNull: this.values[currentRegion] === undefined,
                value: this.values[currentRegion],
                percent: this.values[currentRegion] / this.total * 100,
                color: this.options.get('sliceColors')[currentRegion % this.options.get('sliceColors').length],
                offset: currentRegion
            };
        },

        changeHighlight: function (highlight) {
            var currentRegion = this.currentRegion,
                 newslice = this.renderSlice(currentRegion, highlight),
                 shapeid = this.valueShapes[currentRegion];
            delete this.shapes[shapeid];
            this.target.replaceWithShape(shapeid, newslice);
            this.valueShapes[currentRegion] = newslice.id;
            this.shapes[newslice.id] = currentRegion;
        },

        renderSlice: function (valuenum, highlight) {
            var target = this.target,
                options = this.options,
                radius = this.radius,
                borderWidth = options.get('borderWidth'),
                offset = options.get('offset'),
                circle = 2 * Math.PI,
                values = this.values,
                total = this.total,
                next = offset ? (2*Math.PI)*(offset/360) : 0,
                start, end, i, vlen, color;

            vlen = values.length;
            for (i = 0; i < vlen; i++) {
                start = next;
                end = next;
                if (total > 0) {  // avoid divide by zero
                    end = next + (circle * (values[i] / total));
                }
                if (valuenum === i) {
                    color = options.get('sliceColors')[i % options.get('sliceColors').length];
                    if (highlight) {
                        color = this.calcHighlightColor(color, options);
                    }

                    return target.drawPieSlice(radius, radius, radius - borderWidth, start, end, undefined, color);
                }
                next = end;
            }
        },

        render: function () {
            var target = this.target,
                values = this.values,
                options = this.options,
                radius = this.radius,
                borderWidth = options.get('borderWidth'),
                shape, i;

            if (!pie._super.render.call(this)) {
                return;
            }
            if (borderWidth) {
                target.drawCircle(radius, radius, Math.floor(radius - (borderWidth / 2)),
                    options.get('borderColor'), undefined, borderWidth).append();
            }
            for (i = values.length; i--;) {
                if (values[i]) { // don't render zero values
                    shape = this.renderSlice(i).append();
                    this.valueShapes[i] = shape.id; // store just the shapeid
                    this.shapes[shape.id] = i;
                }
            }
            target.render();
        }
    });

    /**
     * Box plots
     */
    $.fn.sparkline.box = box = createClass($.fn.sparkline._base, {
        type: 'box',

        init: function (el, values, options, width, height) {
            box._super.init.call(this, el, values, options, width, height);
            this.values = $.map(values, Number);
            this.width = options.get('width') === 'auto' ? '4.0em' : width;
            this.initTarget();
            if (!this.values.length) {
                this.disabled = 1;
            }
        },

        /**
         * Simulate a single region
         */
        getRegion: function () {
            return 1;
        },

        getCurrentRegionFields: function () {
            var result = [
                { field: 'lq', value: this.quartiles[0] },
                { field: 'med', value: this.quartiles[1] },
                { field: 'uq', value: this.quartiles[2] }
            ];
            if (this.loutlier !== undefined) {
                result.push({ field: 'lo', value: this.loutlier});
            }
            if (this.routlier !== undefined) {
                result.push({ field: 'ro', value: this.routlier});
            }
            if (this.lwhisker !== undefined) {
                result.push({ field: 'lw', value: this.lwhisker});
            }
            if (this.rwhisker !== undefined) {
                result.push({ field: 'rw', value: this.rwhisker});
            }
            return result;
        },

        render: function () {
            var target = this.target,
                values = this.values,
                vlen = values.length,
                options = this.options,
                canvasWidth = this.canvasWidth,
                canvasHeight = this.canvasHeight,
                minValue = options.get('chartRangeMin') === undefined ? Math.min.apply(Math, values) : options.get('chartRangeMin'),
                maxValue = options.get('chartRangeMax') === undefined ? Math.max.apply(Math, values) : options.get('chartRangeMax'),
                canvasLeft = 0,
                lwhisker, loutlier, iqr, q1, q2, q3, rwhisker, routlier, i,
                size, unitSize;

            if (!box._super.render.call(this)) {
                return;
            }

            if (options.get('raw')) {
                if (options.get('showOutliers') && values.length > 5) {
                    loutlier = values[0];
                    lwhisker = values[1];
                    q1 = values[2];
                    q2 = values[3];
                    q3 = values[4];
                    rwhisker = values[5];
                    routlier = values[6];
                } else {
                    lwhisker = values[0];
                    q1 = values[1];
                    q2 = values[2];
                    q3 = values[3];
                    rwhisker = values[4];
                }
            } else {
                values.sort(function (a, b) { return a - b; });
                q1 = quartile(values, 1);
                q2 = quartile(values, 2);
                q3 = quartile(values, 3);
                iqr = q3 - q1;
                if (options.get('showOutliers')) {
                    lwhisker = rwhisker = undefined;
                    for (i = 0; i < vlen; i++) {
                        if (lwhisker === undefined && values[i] > q1 - (iqr * options.get('outlierIQR'))) {
                            lwhisker = values[i];
                        }
                        if (values[i] < q3 + (iqr * options.get('outlierIQR'))) {
                            rwhisker = values[i];
                        }
                    }
                    loutlier = values[0];
                    routlier = values[vlen - 1];
                } else {
                    lwhisker = values[0];
                    rwhisker = values[vlen - 1];
                }
            }
            this.quartiles = [q1, q2, q3];
            this.lwhisker = lwhisker;
            this.rwhisker = rwhisker;
            this.loutlier = loutlier;
            this.routlier = routlier;

            unitSize = canvasWidth / (maxValue - minValue + 1);
            if (options.get('showOutliers')) {
                canvasLeft = Math.ceil(options.get('spotRadius'));
                canvasWidth -= 2 * Math.ceil(options.get('spotRadius'));
                unitSize = canvasWidth / (maxValue - minValue + 1);
                if (loutlier < lwhisker) {
                    target.drawCircle((loutlier - minValue) * unitSize + canvasLeft,
                        canvasHeight / 2,
                        options.get('spotRadius'),
                        options.get('outlierLineColor'),
                        options.get('outlierFillColor')).append();
                }
                if (routlier > rwhisker) {
                    target.drawCircle((routlier - minValue) * unitSize + canvasLeft,
                        canvasHeight / 2,
                        options.get('spotRadius'),
                        options.get('outlierLineColor'),
                        options.get('outlierFillColor')).append();
                }
            }

            // box
            target.drawRect(
                Math.round((q1 - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight * 0.1),
                Math.round((q3 - q1) * unitSize),
                Math.round(canvasHeight * 0.8),
                options.get('boxLineColor'),
                options.get('boxFillColor')).append();
            // left whisker
            target.drawLine(
                Math.round((lwhisker - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight / 2),
                Math.round((q1 - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight / 2),
                options.get('lineColor')).append();
            target.drawLine(
                Math.round((lwhisker - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight / 4),
                Math.round((lwhisker - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight - canvasHeight / 4),
                options.get('whiskerColor')).append();
            // right whisker
            target.drawLine(Math.round((rwhisker - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight / 2),
                Math.round((q3 - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight / 2),
                options.get('lineColor')).append();
            target.drawLine(
                Math.round((rwhisker - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight / 4),
                Math.round((rwhisker - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight - canvasHeight / 4),
                options.get('whiskerColor')).append();
            // median line
            target.drawLine(
                Math.round((q2 - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight * 0.1),
                Math.round((q2 - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight * 0.9),
                options.get('medianColor')).append();
            if (options.get('target')) {
                size = Math.ceil(options.get('spotRadius'));
                target.drawLine(
                    Math.round((options.get('target') - minValue) * unitSize + canvasLeft),
                    Math.round((canvasHeight / 2) - size),
                    Math.round((options.get('target') - minValue) * unitSize + canvasLeft),
                    Math.round((canvasHeight / 2) + size),
                    options.get('targetColor')).append();
                target.drawLine(
                    Math.round((options.get('target') - minValue) * unitSize + canvasLeft - size),
                    Math.round(canvasHeight / 2),
                    Math.round((options.get('target') - minValue) * unitSize + canvasLeft + size),
                    Math.round(canvasHeight / 2),
                    options.get('targetColor')).append();
            }
            target.render();
        }
    });

    // Setup a very simple "virtual canvas" to make drawing the few shapes we need easier
    // This is accessible as $(foo).simpledraw()

    VShape = createClass({
        init: function (target, id, type, args) {
            this.target = target;
            this.id = id;
            this.type = type;
            this.args = args;
        },
        append: function () {
            this.target.appendShape(this);
            return this;
        }
    });

    VCanvas_base = createClass({
        _pxregex: /(\d+)(px)?\s*$/i,

        init: function (width, height, target) {
            if (!width) {
                return;
            }
            this.width = width;
            this.height = height;
            this.target = target;
            this.lastShapeId = null;
            if (target[0]) {
                target = target[0];
            }
            $.data(target, '_jqs_vcanvas', this);
        },

        drawLine: function (x1, y1, x2, y2, lineColor, lineWidth) {
            return this.drawShape([[x1, y1], [x2, y2]], lineColor, lineWidth);
        },

        drawShape: function (path, lineColor, fillColor, lineWidth) {
            return this._genShape('Shape', [path, lineColor, fillColor, lineWidth]);
        },

        drawCircle: function (x, y, radius, lineColor, fillColor, lineWidth) {
            return this._genShape('Circle', [x, y, radius, lineColor, fillColor, lineWidth]);
        },

        drawPieSlice: function (x, y, radius, startAngle, endAngle, lineColor, fillColor) {
            return this._genShape('PieSlice', [x, y, radius, startAngle, endAngle, lineColor, fillColor]);
        },

        drawRect: function (x, y, width, height, lineColor, fillColor) {
            return this._genShape('Rect', [x, y, width, height, lineColor, fillColor]);
        },

        getElement: function () {
            return this.canvas;
        },

        /**
         * Return the most recently inserted shape id
         */
        getLastShapeId: function () {
            return this.lastShapeId;
        },

        /**
         * Clear and reset the canvas
         */
        reset: function () {
            alert('reset not implemented');
        },

        _insert: function (el, target) {
            $(target).html(el);
        },

        /**
         * Calculate the pixel dimensions of the canvas
         */
        _calculatePixelDims: function (width, height, canvas) {
            // XXX This should probably be a configurable option
            var match;
            match = this._pxregex.exec(height);
            if (match) {
                this.pixelHeight = match[1];
            } else {
                this.pixelHeight = $(canvas).height();
            }
            match = this._pxregex.exec(width);
            if (match) {
                this.pixelWidth = match[1];
            } else {
                this.pixelWidth = $(canvas).width();
            }
        },

        /**
         * Generate a shape object and id for later rendering
         */
        _genShape: function (shapetype, shapeargs) {
            var id = shapeCount++;
            shapeargs.unshift(id);
            return new VShape(this, id, shapetype, shapeargs);
        },

        /**
         * Add a shape to the end of the render queue
         */
        appendShape: function (shape) {
            alert('appendShape not implemented');
        },

        /**
         * Replace one shape with another
         */
        replaceWithShape: function (shapeid, shape) {
            alert('replaceWithShape not implemented');
        },

        /**
         * Insert one shape after another in the render queue
         */
        insertAfterShape: function (shapeid, shape) {
            alert('insertAfterShape not implemented');
        },

        /**
         * Remove a shape from the queue
         */
        removeShapeId: function (shapeid) {
            alert('removeShapeId not implemented');
        },

        /**
         * Find a shape at the specified x/y co-ordinates
         */
        getShapeAt: function (el, x, y) {
            alert('getShapeAt not implemented');
        },

        /**
         * Render all queued shapes onto the canvas
         */
        render: function () {
            alert('render not implemented');
        }
    });

    VCanvas_canvas = createClass(VCanvas_base, {
        init: function (width, height, target, interact) {
            VCanvas_canvas._super.init.call(this, width, height, target);
            this.canvas = document.createElement('canvas');
            if (target[0]) {
                target = target[0];
            }
            $.data(target, '_jqs_vcanvas', this);
            $(this.canvas).css({ display: 'inline-block', width: width, height: height, verticalAlign: 'top' });
            this._insert(this.canvas, target);
            this._calculatePixelDims(width, height, this.canvas);
            this.canvas.width = this.pixelWidth;
            this.canvas.height = this.pixelHeight;
            this.interact = interact;
            this.shapes = {};
            this.shapeseq = [];
            this.currentTargetShapeId = undefined;
            $(this.canvas).css({width: this.pixelWidth, height: this.pixelHeight});
        },

        _getContext: function (lineColor, fillColor, lineWidth) {
            var context = this.canvas.getContext('2d');
            if (lineColor !== undefined) {
                context.strokeStyle = lineColor;
            }
            context.lineWidth = lineWidth === undefined ? 1 : lineWidth;
            if (fillColor !== undefined) {
                context.fillStyle = fillColor;
            }
            return context;
        },

        reset: function () {
            var context = this._getContext();
            context.clearRect(0, 0, this.pixelWidth, this.pixelHeight);
            this.shapes = {};
            this.shapeseq = [];
            this.currentTargetShapeId = undefined;
        },

        _drawShape: function (shapeid, path, lineColor, fillColor, lineWidth) {
            var context = this._getContext(lineColor, fillColor, lineWidth),
                i, plen;
            context.beginPath();
            context.moveTo(path[0][0] + 0.5, path[0][1] + 0.5);
            for (i = 1, plen = path.length; i < plen; i++) {
                context.lineTo(path[i][0] + 0.5, path[i][1] + 0.5); // the 0.5 offset gives us crisp pixel-width lines
            }
            if (lineColor !== undefined) {
                context.stroke();
            }
            if (fillColor !== undefined) {
                context.fill();
            }
            if (this.targetX !== undefined && this.targetY !== undefined &&
                context.isPointInPath(this.targetX, this.targetY)) {
                this.currentTargetShapeId = shapeid;
            }
        },

        _drawCircle: function (shapeid, x, y, radius, lineColor, fillColor, lineWidth) {
            var context = this._getContext(lineColor, fillColor, lineWidth);
            context.beginPath();
            context.arc(x, y, radius, 0, 2 * Math.PI, false);
            if (this.targetX !== undefined && this.targetY !== undefined &&
                context.isPointInPath(this.targetX, this.targetY)) {
                this.currentTargetShapeId = shapeid;
            }
            if (lineColor !== undefined) {
                context.stroke();
            }
            if (fillColor !== undefined) {
                context.fill();
            }
        },

        _drawPieSlice: function (shapeid, x, y, radius, startAngle, endAngle, lineColor, fillColor) {
            var context = this._getContext(lineColor, fillColor);
            context.beginPath();
            context.moveTo(x, y);
            context.arc(x, y, radius, startAngle, endAngle, false);
            context.lineTo(x, y);
            context.closePath();
            if (lineColor !== undefined) {
                context.stroke();
            }
            if (fillColor) {
                context.fill();
            }
            if (this.targetX !== undefined && this.targetY !== undefined &&
                context.isPointInPath(this.targetX, this.targetY)) {
                this.currentTargetShapeId = shapeid;
            }
        },

        _drawRect: function (shapeid, x, y, width, height, lineColor, fillColor) {
            return this._drawShape(shapeid, [[x, y], [x + width, y], [x + width, y + height], [x, y + height], [x, y]], lineColor, fillColor);
        },

        appendShape: function (shape) {
            this.shapes[shape.id] = shape;
            this.shapeseq.push(shape.id);
            this.lastShapeId = shape.id;
            return shape.id;
        },

        replaceWithShape: function (shapeid, shape) {
            var shapeseq = this.shapeseq,
                i;
            this.shapes[shape.id] = shape;
            for (i = shapeseq.length; i--;) {
                if (shapeseq[i] == shapeid) {
                    shapeseq[i] = shape.id;
                }
            }
            delete this.shapes[shapeid];
        },

        replaceWithShapes: function (shapeids, shapes) {
            var shapeseq = this.shapeseq,
                shapemap = {},
                sid, i, first;

            for (i = shapeids.length; i--;) {
                shapemap[shapeids[i]] = true;
            }
            for (i = shapeseq.length; i--;) {
                sid = shapeseq[i];
                if (shapemap[sid]) {
                    shapeseq.splice(i, 1);
                    delete this.shapes[sid];
                    first = i;
                }
            }
            for (i = shapes.length; i--;) {
                shapeseq.splice(first, 0, shapes[i].id);
                this.shapes[shapes[i].id] = shapes[i];
            }

        },

        insertAfterShape: function (shapeid, shape) {
            var shapeseq = this.shapeseq,
                i;
            for (i = shapeseq.length; i--;) {
                if (shapeseq[i] === shapeid) {
                    shapeseq.splice(i + 1, 0, shape.id);
                    this.shapes[shape.id] = shape;
                    return;
                }
            }
        },

        removeShapeId: function (shapeid) {
            var shapeseq = this.shapeseq,
                i;
            for (i = shapeseq.length; i--;) {
                if (shapeseq[i] === shapeid) {
                    shapeseq.splice(i, 1);
                    break;
                }
            }
            delete this.shapes[shapeid];
        },

        getShapeAt: function (el, x, y) {
            this.targetX = x;
            this.targetY = y;
            this.render();
            return this.currentTargetShapeId;
        },

        render: function () {
            var shapeseq = this.shapeseq,
                shapes = this.shapes,
                shapeCount = shapeseq.length,
                context = this._getContext(),
                shapeid, shape, i;
            context.clearRect(0, 0, this.pixelWidth, this.pixelHeight);
            for (i = 0; i < shapeCount; i++) {
                shapeid = shapeseq[i];
                shape = shapes[shapeid];
                this['_draw' + shape.type].apply(this, shape.args);
            }
            if (!this.interact) {
                // not interactive so no need to keep the shapes array
                this.shapes = {};
                this.shapeseq = [];
            }
        }

    });

    VCanvas_vml = createClass(VCanvas_base, {
        init: function (width, height, target) {
            var groupel;
            VCanvas_vml._super.init.call(this, width, height, target);
            if (target[0]) {
                target = target[0];
            }
            $.data(target, '_jqs_vcanvas', this);
            this.canvas = document.createElement('span');
            $(this.canvas).css({ display: 'inline-block', position: 'relative', overflow: 'hidden', width: width, height: height, margin: '0px', padding: '0px', verticalAlign: 'top'});
            this._insert(this.canvas, target);
            this._calculatePixelDims(width, height, this.canvas);
            this.canvas.width = this.pixelWidth;
            this.canvas.height = this.pixelHeight;
            groupel = '<v:group coordorigin="0 0" coordsize="' + this.pixelWidth + ' ' + this.pixelHeight + '"' +
                    ' style="position:absolute;top:0;left:0;width:' + this.pixelWidth + 'px;height=' + this.pixelHeight + 'px;"></v:group>';
            this.canvas.insertAdjacentHTML('beforeEnd', groupel);
            this.group = $(this.canvas).children()[0];
            this.rendered = false;
            this.prerender = '';
        },

        _drawShape: function (shapeid, path, lineColor, fillColor, lineWidth) {
            var vpath = [],
                initial, stroke, fill, closed, vel, plen, i;
            for (i = 0, plen = path.length; i < plen; i++) {
                vpath[i] = '' + (path[i][0]) + ',' + (path[i][1]);
            }
            initial = vpath.splice(0, 1);
            lineWidth = lineWidth === undefined ? 1 : lineWidth;
            stroke = lineColor === undefined ? ' stroked="false" ' : ' strokeWeight="' + lineWidth + 'px" strokeColor="' + lineColor + '" ';
            fill = fillColor === undefined ? ' filled="false"' : ' fillColor="' + fillColor + '" filled="true" ';
            closed = vpath[0] === vpath[vpath.length - 1] ? 'x ' : '';
            vel = '<v:shape coordorigin="0 0" coordsize="' + this.pixelWidth + ' ' + this.pixelHeight + '" ' +
                 ' id="jqsshape' + shapeid + '" ' +
                 stroke +
                 fill +
                ' style="position:absolute;left:0px;top:0px;height:' + this.pixelHeight + 'px;width:' + this.pixelWidth + 'px;padding:0px;margin:0px;" ' +
                ' path="m ' + initial + ' l ' + vpath.join(', ') + ' ' + closed + 'e">' +
                ' </v:shape>';
            return vel;
        },

        _drawCircle: function (shapeid, x, y, radius, lineColor, fillColor, lineWidth) {
            var stroke, fill, vel;
            x -= radius;
            y -= radius;
            stroke = lineColor === undefined ? ' stroked="false" ' : ' strokeWeight="' + lineWidth + 'px" strokeColor="' + lineColor + '" ';
            fill = fillColor === undefined ? ' filled="false"' : ' fillColor="' + fillColor + '" filled="true" ';
            vel = '<v:oval ' +
                 ' id="jqsshape' + shapeid + '" ' +
                stroke +
                fill +
                ' style="position:absolute;top:' + y + 'px; left:' + x + 'px; width:' + (radius * 2) + 'px; height:' + (radius * 2) + 'px"></v:oval>';
            return vel;

        },

        _drawPieSlice: function (shapeid, x, y, radius, startAngle, endAngle, lineColor, fillColor) {
            var vpath, startx, starty, endx, endy, stroke, fill, vel;
            if (startAngle === endAngle) {
                return '';  // VML seems to have problem when start angle equals end angle.
            }
            if ((endAngle - startAngle) === (2 * Math.PI)) {
                startAngle = 0.0;  // VML seems to have a problem when drawing a full circle that doesn't start 0
                endAngle = (2 * Math.PI);
            }

            startx = x + Math.round(Math.cos(startAngle) * radius);
            starty = y + Math.round(Math.sin(startAngle) * radius);
            endx = x + Math.round(Math.cos(endAngle) * radius);
            endy = y + Math.round(Math.sin(endAngle) * radius);

            if (startx === endx && starty === endy) {
                if ((endAngle - startAngle) < Math.PI) {
                    // Prevent very small slices from being mistaken as a whole pie
                    return '';
                }
                // essentially going to be the entire circle, so ignore startAngle
                startx = endx = x + radius;
                starty = endy = y;
            }

            if (startx === endx && starty === endy && (endAngle - startAngle) < Math.PI) {
                return '';
            }

            vpath = [x - radius, y - radius, x + radius, y + radius, startx, starty, endx, endy];
            stroke = lineColor === undefined ? ' stroked="false" ' : ' strokeWeight="1px" strokeColor="' + lineColor + '" ';
            fill = fillColor === undefined ? ' filled="false"' : ' fillColor="' + fillColor + '" filled="true" ';
            vel = '<v:shape coordorigin="0 0" coordsize="' + this.pixelWidth + ' ' + this.pixelHeight + '" ' +
                 ' id="jqsshape' + shapeid + '" ' +
                 stroke +
                 fill +
                ' style="position:absolute;left:0px;top:0px;height:' + this.pixelHeight + 'px;width:' + this.pixelWidth + 'px;padding:0px;margin:0px;" ' +
                ' path="m ' + x + ',' + y + ' wa ' + vpath.join(', ') + ' x e">' +
                ' </v:shape>';
            return vel;
        },

        _drawRect: function (shapeid, x, y, width, height, lineColor, fillColor) {
            return this._drawShape(shapeid, [[x, y], [x, y + height], [x + width, y + height], [x + width, y], [x, y]], lineColor, fillColor);
        },

        reset: function () {
            this.group.innerHTML = '';
        },

        appendShape: function (shape) {
            var vel = this['_draw' + shape.type].apply(this, shape.args);
            if (this.rendered) {
                this.group.insertAdjacentHTML('beforeEnd', vel);
            } else {
                this.prerender += vel;
            }
            this.lastShapeId = shape.id;
            return shape.id;
        },

        replaceWithShape: function (shapeid, shape) {
            var existing = $('#jqsshape' + shapeid),
                vel = this['_draw' + shape.type].apply(this, shape.args);
            existing[0].outerHTML = vel;
        },

        replaceWithShapes: function (shapeids, shapes) {
            // replace the first shapeid with all the new shapes then toast the remaining old shapes
            var existing = $('#jqsshape' + shapeids[0]),
                replace = '',
                slen = shapes.length,
                i;
            for (i = 0; i < slen; i++) {
                replace += this['_draw' + shapes[i].type].apply(this, shapes[i].args);
            }
            existing[0].outerHTML = replace;
            for (i = 1; i < shapeids.length; i++) {
                $('#jqsshape' + shapeids[i]).remove();
            }
        },

        insertAfterShape: function (shapeid, shape) {
            var existing = $('#jqsshape' + shapeid),
                 vel = this['_draw' + shape.type].apply(this, shape.args);
            existing[0].insertAdjacentHTML('afterEnd', vel);
        },

        removeShapeId: function (shapeid) {
            var existing = $('#jqsshape' + shapeid);
            this.group.removeChild(existing[0]);
        },

        getShapeAt: function (el, x, y) {
            var shapeid = el.id.substr(8);
            return shapeid;
        },

        render: function () {
            if (!this.rendered) {
                // batch the intial render into a single repaint
                this.group.innerHTML = this.prerender;
                this.rendered = true;
            }
        }
    });

}))}(document, Math));

},{}],4:[function(require,module,exports){
/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */

/*global define: false Mustache: true*/

(function defineMustache (global, factory) {
  if (typeof exports === 'object' && exports && typeof exports.nodeName !== 'string') {
    factory(exports); // CommonJS
  } else if (typeof define === 'function' && define.amd) {
    define(['exports'], factory); // AMD
  } else {
    global.Mustache = {};
    factory(global.Mustache); // script, wsh, asp
  }
}(this, function mustacheFactory (mustache) {

  var objectToString = Object.prototype.toString;
  var isArray = Array.isArray || function isArrayPolyfill (object) {
    return objectToString.call(object) === '[object Array]';
  };

  function isFunction (object) {
    return typeof object === 'function';
  }

  /**
   * More correct typeof string handling array
   * which normally returns typeof 'object'
   */
  function typeStr (obj) {
    return isArray(obj) ? 'array' : typeof obj;
  }

  function escapeRegExp (string) {
    return string.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g, '\\$&');
  }

  /**
   * Null safe way of checking whether or not an object,
   * including its prototype, has a given property
   */
  function hasProperty (obj, propName) {
    return obj != null && typeof obj === 'object' && (propName in obj);
  }

  // Workaround for https://issues.apache.org/jira/browse/COUCHDB-577
  // See https://github.com/janl/mustache.js/issues/189
  var regExpTest = RegExp.prototype.test;
  function testRegExp (re, string) {
    return regExpTest.call(re, string);
  }

  var nonSpaceRe = /\S/;
  function isWhitespace (string) {
    return !testRegExp(nonSpaceRe, string);
  }

  var entityMap = {
    '&': '&amp;',
    '<': '&lt;',
    '>': '&gt;',
    '"': '&quot;',
    "'": '&#39;',
    '/': '&#x2F;',
    '`': '&#x60;',
    '=': '&#x3D;'
  };

  function escapeHtml (string) {
    return String(string).replace(/[&<>"'`=\/]/g, function fromEntityMap (s) {
      return entityMap[s];
    });
  }

  var whiteRe = /\s*/;
  var spaceRe = /\s+/;
  var equalsRe = /\s*=/;
  var curlyRe = /\s*\}/;
  var tagRe = /#|\^|\/|>|\{|&|=|!/;

  /**
   * Breaks up the given `template` string into a tree of tokens. If the `tags`
   * argument is given here it must be an array with two string values: the
   * opening and closing tags used in the template (e.g. [ "<%", "%>" ]). Of
   * course, the default is to use mustaches (i.e. mustache.tags).
   *
   * A token is an array with at least 4 elements. The first element is the
   * mustache symbol that was used inside the tag, e.g. "#" or "&". If the tag
   * did not contain a symbol (i.e. {{myValue}}) this element is "name". For
   * all text that appears outside a symbol this element is "text".
   *
   * The second element of a token is its "value". For mustache tags this is
   * whatever else was inside the tag besides the opening symbol. For text tokens
   * this is the text itself.
   *
   * The third and fourth elements of the token are the start and end indices,
   * respectively, of the token in the original template.
   *
   * Tokens that are the root node of a subtree contain two more elements: 1) an
   * array of tokens in the subtree and 2) the index in the original template at
   * which the closing tag for that section begins.
   */
  function parseTemplate (template, tags) {
    if (!template)
      return [];

    var sections = [];     // Stack to hold section tokens
    var tokens = [];       // Buffer to hold the tokens
    var spaces = [];       // Indices of whitespace tokens on the current line
    var hasTag = false;    // Is there a {{tag}} on the current line?
    var nonSpace = false;  // Is there a non-space char on the current line?

    // Strips all whitespace tokens array for the current line
    // if there was a {{#tag}} on it and otherwise only space.
    function stripSpace () {
      if (hasTag && !nonSpace) {
        while (spaces.length)
          delete tokens[spaces.pop()];
      } else {
        spaces = [];
      }

      hasTag = false;
      nonSpace = false;
    }

    var openingTagRe, closingTagRe, closingCurlyRe;
    function compileTags (tagsToCompile) {
      if (typeof tagsToCompile === 'string')
        tagsToCompile = tagsToCompile.split(spaceRe, 2);

      if (!isArray(tagsToCompile) || tagsToCompile.length !== 2)
        throw new Error('Invalid tags: ' + tagsToCompile);

      openingTagRe = new RegExp(escapeRegExp(tagsToCompile[0]) + '\\s*');
      closingTagRe = new RegExp('\\s*' + escapeRegExp(tagsToCompile[1]));
      closingCurlyRe = new RegExp('\\s*' + escapeRegExp('}' + tagsToCompile[1]));
    }

    compileTags(tags || mustache.tags);

    var scanner = new Scanner(template);

    var start, type, value, chr, token, openSection;
    while (!scanner.eos()) {
      start = scanner.pos;

      // Match any text between tags.
      value = scanner.scanUntil(openingTagRe);

      if (value) {
        for (var i = 0, valueLength = value.length; i < valueLength; ++i) {
          chr = value.charAt(i);

          if (isWhitespace(chr)) {
            spaces.push(tokens.length);
          } else {
            nonSpace = true;
          }

          tokens.push([ 'text', chr, start, start + 1 ]);
          start += 1;

          // Check for whitespace on the current line.
          if (chr === '\n')
            stripSpace();
        }
      }

      // Match the opening tag.
      if (!scanner.scan(openingTagRe))
        break;

      hasTag = true;

      // Get the tag type.
      type = scanner.scan(tagRe) || 'name';
      scanner.scan(whiteRe);

      // Get the tag value.
      if (type === '=') {
        value = scanner.scanUntil(equalsRe);
        scanner.scan(equalsRe);
        scanner.scanUntil(closingTagRe);
      } else if (type === '{') {
        value = scanner.scanUntil(closingCurlyRe);
        scanner.scan(curlyRe);
        scanner.scanUntil(closingTagRe);
        type = '&';
      } else {
        value = scanner.scanUntil(closingTagRe);
      }

      // Match the closing tag.
      if (!scanner.scan(closingTagRe))
        throw new Error('Unclosed tag at ' + scanner.pos);

      token = [ type, value, start, scanner.pos ];
      tokens.push(token);

      if (type === '#' || type === '^') {
        sections.push(token);
      } else if (type === '/') {
        // Check section nesting.
        openSection = sections.pop();

        if (!openSection)
          throw new Error('Unopened section "' + value + '" at ' + start);

        if (openSection[1] !== value)
          throw new Error('Unclosed section "' + openSection[1] + '" at ' + start);
      } else if (type === 'name' || type === '{' || type === '&') {
        nonSpace = true;
      } else if (type === '=') {
        // Set the tags for the next time around.
        compileTags(value);
      }
    }

    // Make sure there are no open sections when we're done.
    openSection = sections.pop();

    if (openSection)
      throw new Error('Unclosed section "' + openSection[1] + '" at ' + scanner.pos);

    return nestTokens(squashTokens(tokens));
  }

  /**
   * Combines the values of consecutive text tokens in the given `tokens` array
   * to a single token.
   */
  function squashTokens (tokens) {
    var squashedTokens = [];

    var token, lastToken;
    for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {
      token = tokens[i];

      if (token) {
        if (token[0] === 'text' && lastToken && lastToken[0] === 'text') {
          lastToken[1] += token[1];
          lastToken[3] = token[3];
        } else {
          squashedTokens.push(token);
          lastToken = token;
        }
      }
    }

    return squashedTokens;
  }

  /**
   * Forms the given array of `tokens` into a nested tree structure where
   * tokens that represent a section have two additional items: 1) an array of
   * all tokens that appear in that section and 2) the index in the original
   * template that represents the end of that section.
   */
  function nestTokens (tokens) {
    var nestedTokens = [];
    var collector = nestedTokens;
    var sections = [];

    var token, section;
    for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {
      token = tokens[i];

      switch (token[0]) {
        case '#':
        case '^':
          collector.push(token);
          sections.push(token);
          collector = token[4] = [];
          break;
        case '/':
          section = sections.pop();
          section[5] = token[2];
          collector = sections.length > 0 ? sections[sections.length - 1][4] : nestedTokens;
          break;
        default:
          collector.push(token);
      }
    }

    return nestedTokens;
  }

  /**
   * A simple string scanner that is used by the template parser to find
   * tokens in template strings.
   */
  function Scanner (string) {
    this.string = string;
    this.tail = string;
    this.pos = 0;
  }

  /**
   * Returns `true` if the tail is empty (end of string).
   */
  Scanner.prototype.eos = function eos () {
    return this.tail === '';
  };

  /**
   * Tries to match the given regular expression at the current position.
   * Returns the matched text if it can match, the empty string otherwise.
   */
  Scanner.prototype.scan = function scan (re) {
    var match = this.tail.match(re);

    if (!match || match.index !== 0)
      return '';

    var string = match[0];

    this.tail = this.tail.substring(string.length);
    this.pos += string.length;

    return string;
  };

  /**
   * Skips all text until the given regular expression can be matched. Returns
   * the skipped string, which is the entire tail if no match can be made.
   */
  Scanner.prototype.scanUntil = function scanUntil (re) {
    var index = this.tail.search(re), match;

    switch (index) {
      case -1:
        match = this.tail;
        this.tail = '';
        break;
      case 0:
        match = '';
        break;
      default:
        match = this.tail.substring(0, index);
        this.tail = this.tail.substring(index);
    }

    this.pos += match.length;

    return match;
  };

  /**
   * Represents a rendering context by wrapping a view object and
   * maintaining a reference to the parent context.
   */
  function Context (view, parentContext) {
    this.view = view;
    this.cache = { '.': this.view };
    this.parent = parentContext;
  }

  /**
   * Creates a new context using the given view with this context
   * as the parent.
   */
  Context.prototype.push = function push (view) {
    return new Context(view, this);
  };

  /**
   * Returns the value of the given name in this context, traversing
   * up the context hierarchy if the value is absent in this context's view.
   */
  Context.prototype.lookup = function lookup (name) {
    var cache = this.cache;

    var value;
    if (cache.hasOwnProperty(name)) {
      value = cache[name];
    } else {
      var context = this, names, index, lookupHit = false;

      while (context) {
        if (name.indexOf('.') > 0) {
          value = context.view;
          names = name.split('.');
          index = 0;

          /**
           * Using the dot notion path in `name`, we descend through the
           * nested objects.
           *
           * To be certain that the lookup has been successful, we have to
           * check if the last object in the path actually has the property
           * we are looking for. We store the result in `lookupHit`.
           *
           * This is specially necessary for when the value has been set to
           * `undefined` and we want to avoid looking up parent contexts.
           **/
          while (value != null && index < names.length) {
            if (index === names.length - 1)
              lookupHit = hasProperty(value, names[index]);

            value = value[names[index++]];
          }
        } else {
          value = context.view[name];
          lookupHit = hasProperty(context.view, name);
        }

        if (lookupHit)
          break;

        context = context.parent;
      }

      cache[name] = value;
    }

    if (isFunction(value))
      value = value.call(this.view);

    return value;
  };

  /**
   * A Writer knows how to take a stream of tokens and render them to a
   * string, given a context. It also maintains a cache of templates to
   * avoid the need to parse the same template twice.
   */
  function Writer () {
    this.cache = {};
  }

  /**
   * Clears all cached templates in this writer.
   */
  Writer.prototype.clearCache = function clearCache () {
    this.cache = {};
  };

  /**
   * Parses and caches the given `template` and returns the array of tokens
   * that is generated from the parse.
   */
  Writer.prototype.parse = function parse (template, tags) {
    var cache = this.cache;
    var tokens = cache[template];

    if (tokens == null)
      tokens = cache[template] = parseTemplate(template, tags);

    return tokens;
  };

  /**
   * High-level method that is used to render the given `template` with
   * the given `view`.
   *
   * The optional `partials` argument may be an object that contains the
   * names and templates of partials that are used in the template. It may
   * also be a function that is used to load partial templates on the fly
   * that takes a single argument: the name of the partial.
   */
  Writer.prototype.render = function render (template, view, partials) {
    var tokens = this.parse(template);
    var context = (view instanceof Context) ? view : new Context(view);
    return this.renderTokens(tokens, context, partials, template);
  };

  /**
   * Low-level method that renders the given array of `tokens` using
   * the given `context` and `partials`.
   *
   * Note: The `originalTemplate` is only ever used to extract the portion
   * of the original template that was contained in a higher-order section.
   * If the template doesn't use higher-order sections, this argument may
   * be omitted.
   */
  Writer.prototype.renderTokens = function renderTokens (tokens, context, partials, originalTemplate) {
    var buffer = '';

    var token, symbol, value;
    for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {
      value = undefined;
      token = tokens[i];
      symbol = token[0];

      if (symbol === '#') value = this.renderSection(token, context, partials, originalTemplate);
      else if (symbol === '^') value = this.renderInverted(token, context, partials, originalTemplate);
      else if (symbol === '>') value = this.renderPartial(token, context, partials, originalTemplate);
      else if (symbol === '&') value = this.unescapedValue(token, context);
      else if (symbol === 'name') value = this.escapedValue(token, context);
      else if (symbol === 'text') value = this.rawValue(token);

      if (value !== undefined)
        buffer += value;
    }

    return buffer;
  };

  Writer.prototype.renderSection = function renderSection (token, context, partials, originalTemplate) {
    var self = this;
    var buffer = '';
    var value = context.lookup(token[1]);

    // This function is used to render an arbitrary template
    // in the current context by higher-order sections.
    function subRender (template) {
      return self.render(template, context, partials);
    }

    if (!value) return;

    if (isArray(value)) {
      for (var j = 0, valueLength = value.length; j < valueLength; ++j) {
        buffer += this.renderTokens(token[4], context.push(value[j]), partials, originalTemplate);
      }
    } else if (typeof value === 'object' || typeof value === 'string' || typeof value === 'number') {
      buffer += this.renderTokens(token[4], context.push(value), partials, originalTemplate);
    } else if (isFunction(value)) {
      if (typeof originalTemplate !== 'string')
        throw new Error('Cannot use higher-order sections without the original template');

      // Extract the portion of the original template that the section contains.
      value = value.call(context.view, originalTemplate.slice(token[3], token[5]), subRender);

      if (value != null)
        buffer += value;
    } else {
      buffer += this.renderTokens(token[4], context, partials, originalTemplate);
    }
    return buffer;
  };

  Writer.prototype.renderInverted = function renderInverted (token, context, partials, originalTemplate) {
    var value = context.lookup(token[1]);

    // Use JavaScript's definition of falsy. Include empty arrays.
    // See https://github.com/janl/mustache.js/issues/186
    if (!value || (isArray(value) && value.length === 0))
      return this.renderTokens(token[4], context, partials, originalTemplate);
  };

  Writer.prototype.renderPartial = function renderPartial (token, context, partials) {
    if (!partials) return;

    var value = isFunction(partials) ? partials(token[1]) : partials[token[1]];
    if (value != null)
      return this.renderTokens(this.parse(value), context, partials, value);
  };

  Writer.prototype.unescapedValue = function unescapedValue (token, context) {
    var value = context.lookup(token[1]);
    if (value != null)
      return value;
  };

  Writer.prototype.escapedValue = function escapedValue (token, context) {
    var value = context.lookup(token[1]);
    if (value != null)
      return mustache.escape(value);
  };

  Writer.prototype.rawValue = function rawValue (token) {
    return token[1];
  };

  mustache.name = 'mustache.js';
  mustache.version = '2.2.1';
  mustache.tags = [ '{{', '}}' ];

  // All high-level mustache.* functions use this writer.
  var defaultWriter = new Writer();

  /**
   * Clears all cached templates in the default writer.
   */
  mustache.clearCache = function clearCache () {
    return defaultWriter.clearCache();
  };

  /**
   * Parses and caches the given template in the default writer and returns the
   * array of tokens it contains. Doing this ahead of time avoids the need to
   * parse templates on the fly as they are rendered.
   */
  mustache.parse = function parse (template, tags) {
    return defaultWriter.parse(template, tags);
  };

  /**
   * Renders the `template` with the given `view` and `partials` using the
   * default writer.
   */
  mustache.render = function render (template, view, partials) {
    if (typeof template !== 'string') {
      throw new TypeError('Invalid template! Template should be a "string" ' +
                          'but "' + typeStr(template) + '" was given as the first ' +
                          'argument for mustache#render(template, view, partials)');
    }

    return defaultWriter.render(template, view, partials);
  };

  // This is here for backwards compatibility with 0.4.x.,
  /*eslint-disable */ // eslint wants camel cased function name
  mustache.to_html = function to_html (template, view, partials, send) {
    /*eslint-enable*/

    var result = mustache.render(template, view, partials);

    if (isFunction(send)) {
      send(result);
    } else {
      return result;
    }
  };

  // Export the escaping function so that the user may override it.
  // See https://github.com/janl/mustache.js/issues/244
  mustache.escape = escapeHtml;

  // Export these mainly for testing, but also for advanced usage.
  mustache.Scanner = Scanner;
  mustache.Context = Context;
  mustache.Writer = Writer;

}));

},{}],5:[function(require,module,exports){
/*!
 * ZeroClipboard
 * The ZeroClipboard library provides an easy way to copy text to the clipboard using an invisible Adobe Flash movie and a JavaScript interface.
 * Copyright (c) 2009-2014 Jon Rohan, James M. Greene
 * Licensed MIT
 * http://zeroclipboard.org/
 * v2.2.0
 */
(function(window, undefined) {
  "use strict";
  /**
 * Store references to critically important global functions that may be
 * overridden on certain web pages.
 */
  var _window = window, _document = _window.document, _navigator = _window.navigator, _setTimeout = _window.setTimeout, _clearTimeout = _window.clearTimeout, _setInterval = _window.setInterval, _clearInterval = _window.clearInterval, _getComputedStyle = _window.getComputedStyle, _encodeURIComponent = _window.encodeURIComponent, _ActiveXObject = _window.ActiveXObject, _Error = _window.Error, _parseInt = _window.Number.parseInt || _window.parseInt, _parseFloat = _window.Number.parseFloat || _window.parseFloat, _isNaN = _window.Number.isNaN || _window.isNaN, _now = _window.Date.now, _keys = _window.Object.keys, _defineProperty = _window.Object.defineProperty, _hasOwn = _window.Object.prototype.hasOwnProperty, _slice = _window.Array.prototype.slice, _unwrap = function() {
    var unwrapper = function(el) {
      return el;
    };
    if (typeof _window.wrap === "function" && typeof _window.unwrap === "function") {
      try {
        var div = _document.createElement("div");
        var unwrappedDiv = _window.unwrap(div);
        if (div.nodeType === 1 && unwrappedDiv && unwrappedDiv.nodeType === 1) {
          unwrapper = _window.unwrap;
        }
      } catch (e) {}
    }
    return unwrapper;
  }();
  /**
 * Convert an `arguments` object into an Array.
 *
 * @returns The arguments as an Array
 * @private
 */
  var _args = function(argumentsObj) {
    return _slice.call(argumentsObj, 0);
  };
  /**
 * Shallow-copy the owned, enumerable properties of one object over to another, similar to jQuery's `$.extend`.
 *
 * @returns The target object, augmented
 * @private
 */
  var _extend = function() {
    var i, len, arg, prop, src, copy, args = _args(arguments), target = args[0] || {};
    for (i = 1, len = args.length; i < len; i++) {
      if ((arg = args[i]) != null) {
        for (prop in arg) {
          if (_hasOwn.call(arg, prop)) {
            src = target[prop];
            copy = arg[prop];
            if (target !== copy && copy !== undefined) {
              target[prop] = copy;
            }
          }
        }
      }
    }
    return target;
  };
  /**
 * Return a deep copy of the source object or array.
 *
 * @returns Object or Array
 * @private
 */
  var _deepCopy = function(source) {
    var copy, i, len, prop;
    if (typeof source !== "object" || source == null || typeof source.nodeType === "number") {
      copy = source;
    } else if (typeof source.length === "number") {
      copy = [];
      for (i = 0, len = source.length; i < len; i++) {
        if (_hasOwn.call(source, i)) {
          copy[i] = _deepCopy(source[i]);
        }
      }
    } else {
      copy = {};
      for (prop in source) {
        if (_hasOwn.call(source, prop)) {
          copy[prop] = _deepCopy(source[prop]);
        }
      }
    }
    return copy;
  };
  /**
 * Makes a shallow copy of `obj` (like `_extend`) but filters its properties based on a list of `keys` to keep.
 * The inverse of `_omit`, mostly. The big difference is that these properties do NOT need to be enumerable to
 * be kept.
 *
 * @returns A new filtered object.
 * @private
 */
  var _pick = function(obj, keys) {
    var newObj = {};
    for (var i = 0, len = keys.length; i < len; i++) {
      if (keys[i] in obj) {
        newObj[keys[i]] = obj[keys[i]];
      }
    }
    return newObj;
  };
  /**
 * Makes a shallow copy of `obj` (like `_extend`) but filters its properties based on a list of `keys` to omit.
 * The inverse of `_pick`.
 *
 * @returns A new filtered object.
 * @private
 */
  var _omit = function(obj, keys) {
    var newObj = {};
    for (var prop in obj) {
      if (keys.indexOf(prop) === -1) {
        newObj[prop] = obj[prop];
      }
    }
    return newObj;
  };
  /**
 * Remove all owned, enumerable properties from an object.
 *
 * @returns The original object without its owned, enumerable properties.
 * @private
 */
  var _deleteOwnProperties = function(obj) {
    if (obj) {
      for (var prop in obj) {
        if (_hasOwn.call(obj, prop)) {
          delete obj[prop];
        }
      }
    }
    return obj;
  };
  /**
 * Determine if an element is contained within another element.
 *
 * @returns Boolean
 * @private
 */
  var _containedBy = function(el, ancestorEl) {
    if (el && el.nodeType === 1 && el.ownerDocument && ancestorEl && (ancestorEl.nodeType === 1 && ancestorEl.ownerDocument && ancestorEl.ownerDocument === el.ownerDocument || ancestorEl.nodeType === 9 && !ancestorEl.ownerDocument && ancestorEl === el.ownerDocument)) {
      do {
        if (el === ancestorEl) {
          return true;
        }
        el = el.parentNode;
      } while (el);
    }
    return false;
  };
  /**
 * Get the URL path's parent directory.
 *
 * @returns String or `undefined`
 * @private
 */
  var _getDirPathOfUrl = function(url) {
    var dir;
    if (typeof url === "string" && url) {
      dir = url.split("#")[0].split("?")[0];
      dir = url.slice(0, url.lastIndexOf("/") + 1);
    }
    return dir;
  };
  /**
 * Get the current script's URL by throwing an `Error` and analyzing it.
 *
 * @returns String or `undefined`
 * @private
 */
  var _getCurrentScriptUrlFromErrorStack = function(stack) {
    var url, matches;
    if (typeof stack === "string" && stack) {
      matches = stack.match(/^(?:|[^:@]*@|.+\)@(?=http[s]?|file)|.+?\s+(?: at |@)(?:[^:\(]+ )*[\(]?)((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/);
      if (matches && matches[1]) {
        url = matches[1];
      } else {
        matches = stack.match(/\)@((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/);
        if (matches && matches[1]) {
          url = matches[1];
        }
      }
    }
    return url;
  };
  /**
 * Get the current script's URL by throwing an `Error` and analyzing it.
 *
 * @returns String or `undefined`
 * @private
 */
  var _getCurrentScriptUrlFromError = function() {
    var url, err;
    try {
      throw new _Error();
    } catch (e) {
      err = e;
    }
    if (err) {
      url = err.sourceURL || err.fileName || _getCurrentScriptUrlFromErrorStack(err.stack);
    }
    return url;
  };
  /**
 * Get the current script's URL.
 *
 * @returns String or `undefined`
 * @private
 */
  var _getCurrentScriptUrl = function() {
    var jsPath, scripts, i;
    if (_document.currentScript && (jsPath = _document.currentScript.src)) {
      return jsPath;
    }
    scripts = _document.getElementsByTagName("script");
    if (scripts.length === 1) {
      return scripts[0].src || undefined;
    }
    if ("readyState" in scripts[0]) {
      for (i = scripts.length; i--; ) {
        if (scripts[i].readyState === "interactive" && (jsPath = scripts[i].src)) {
          return jsPath;
        }
      }
    }
    if (_document.readyState === "loading" && (jsPath = scripts[scripts.length - 1].src)) {
      return jsPath;
    }
    if (jsPath = _getCurrentScriptUrlFromError()) {
      return jsPath;
    }
    return undefined;
  };
  /**
 * Get the unanimous parent directory of ALL script tags.
 * If any script tags are either (a) inline or (b) from differing parent
 * directories, this method must return `undefined`.
 *
 * @returns String or `undefined`
 * @private
 */
  var _getUnanimousScriptParentDir = function() {
    var i, jsDir, jsPath, scripts = _document.getElementsByTagName("script");
    for (i = scripts.length; i--; ) {
      if (!(jsPath = scripts[i].src)) {
        jsDir = null;
        break;
      }
      jsPath = _getDirPathOfUrl(jsPath);
      if (jsDir == null) {
        jsDir = jsPath;
      } else if (jsDir !== jsPath) {
        jsDir = null;
        break;
      }
    }
    return jsDir || undefined;
  };
  /**
 * Get the presumed location of the "ZeroClipboard.swf" file, based on the location
 * of the executing JavaScript file (e.g. "ZeroClipboard.js", etc.).
 *
 * @returns String
 * @private
 */
  var _getDefaultSwfPath = function() {
    var jsDir = _getDirPathOfUrl(_getCurrentScriptUrl()) || _getUnanimousScriptParentDir() || "";
    return jsDir + "ZeroClipboard.swf";
  };
  /**
 * Keep track of if the page is framed (in an `iframe`). This can never change.
 * @private
 */
  var _pageIsFramed = function() {
    return window.opener == null && (!!window.top && window != window.top || !!window.parent && window != window.parent);
  }();
  /**
 * Keep track of the state of the Flash object.
 * @private
 */
  var _flashState = {
    bridge: null,
    version: "0.0.0",
    pluginType: "unknown",
    disabled: null,
    outdated: null,
    sandboxed: null,
    unavailable: null,
    degraded: null,
    deactivated: null,
    overdue: null,
    ready: null
  };
  /**
 * The minimum Flash Player version required to use ZeroClipboard completely.
 * @readonly
 * @private
 */
  var _minimumFlashVersion = "11.0.0";
  /**
 * The ZeroClipboard library version number, as reported by Flash, at the time the SWF was compiled.
 */
  var _zcSwfVersion;
  /**
 * Keep track of all event listener registrations.
 * @private
 */
  var _handlers = {};
  /**
 * Keep track of the currently activated element.
 * @private
 */
  var _currentElement;
  /**
 * Keep track of the element that was activated when a `copy` process started.
 * @private
 */
  var _copyTarget;
  /**
 * Keep track of data for the pending clipboard transaction.
 * @private
 */
  var _clipData = {};
  /**
 * Keep track of data formats for the pending clipboard transaction.
 * @private
 */
  var _clipDataFormatMap = null;
  /**
 * Keep track of the Flash availability check timeout.
 * @private
 */
  var _flashCheckTimeout = 0;
  /**
 * Keep track of SWF network errors interval polling.
 * @private
 */
  var _swfFallbackCheckInterval = 0;
  /**
 * The `message` store for events
 * @private
 */
  var _eventMessages = {
    ready: "Flash communication is established",
    error: {
      "flash-disabled": "Flash is disabled or not installed. May also be attempting to run Flash in a sandboxed iframe, which is impossible.",
      "flash-outdated": "Flash is too outdated to support ZeroClipboard",
      "flash-sandboxed": "Attempting to run Flash in a sandboxed iframe, which is impossible",
      "flash-unavailable": "Flash is unable to communicate bidirectionally with JavaScript",
      "flash-degraded": "Flash is unable to preserve data fidelity when communicating with JavaScript",
      "flash-deactivated": "Flash is too outdated for your browser and/or is configured as click-to-activate.\nThis may also mean that the ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity.\nMay also be attempting to run Flash in a sandboxed iframe, which is impossible.",
      "flash-overdue": "Flash communication was established but NOT within the acceptable time limit",
      "version-mismatch": "ZeroClipboard JS version number does not match ZeroClipboard SWF version number",
      "clipboard-error": "At least one error was thrown while ZeroClipboard was attempting to inject your data into the clipboard",
      "config-mismatch": "ZeroClipboard configuration does not match Flash's reality",
      "swf-not-found": "The ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity"
    }
  };
  /**
 * The `name`s of `error` events that can only occur is Flash has at least
 * been able to load the SWF successfully.
 * @private
 */
  var _errorsThatOnlyOccurAfterFlashLoads = [ "flash-unavailable", "flash-degraded", "flash-overdue", "version-mismatch", "config-mismatch", "clipboard-error" ];
  /**
 * The `name`s of `error` events that should likely result in the `_flashState`
 * variable's property values being updated.
 * @private
 */
  var _flashStateErrorNames = [ "flash-disabled", "flash-outdated", "flash-sandboxed", "flash-unavailable", "flash-degraded", "flash-deactivated", "flash-overdue" ];
  /**
 * A RegExp to match the `name` property of `error` events related to Flash.
 * @private
 */
  var _flashStateErrorNameMatchingRegex = new RegExp("^flash-(" + _flashStateErrorNames.map(function(errorName) {
    return errorName.replace(/^flash-/, "");
  }).join("|") + ")$");
  /**
 * A RegExp to match the `name` property of `error` events related to Flash,
 * which is enabled.
 * @private
 */
  var _flashStateEnabledErrorNameMatchingRegex = new RegExp("^flash-(" + _flashStateErrorNames.slice(1).map(function(errorName) {
    return errorName.replace(/^flash-/, "");
  }).join("|") + ")$");
  /**
 * ZeroClipboard configuration defaults for the Core module.
 * @private
 */
  var _globalConfig = {
    swfPath: _getDefaultSwfPath(),
    trustedDomains: window.location.host ? [ window.location.host ] : [],
    cacheBust: true,
    forceEnhancedClipboard: false,
    flashLoadTimeout: 3e4,
    autoActivate: true,
    bubbleEvents: true,
    containerId: "global-zeroclipboard-html-bridge",
    containerClass: "global-zeroclipboard-container",
    swfObjectId: "global-zeroclipboard-flash-bridge",
    hoverClass: "zeroclipboard-is-hover",
    activeClass: "zeroclipboard-is-active",
    forceHandCursor: false,
    title: null,
    zIndex: 999999999
  };
  /**
 * The underlying implementation of `ZeroClipboard.config`.
 * @private
 */
  var _config = function(options) {
    if (typeof options === "object" && options !== null) {
      for (var prop in options) {
        if (_hasOwn.call(options, prop)) {
          if (/^(?:forceHandCursor|title|zIndex|bubbleEvents)$/.test(prop)) {
            _globalConfig[prop] = options[prop];
          } else if (_flashState.bridge == null) {
            if (prop === "containerId" || prop === "swfObjectId") {
              if (_isValidHtml4Id(options[prop])) {
                _globalConfig[prop] = options[prop];
              } else {
                throw new Error("The specified `" + prop + "` value is not valid as an HTML4 Element ID");
              }
            } else {
              _globalConfig[prop] = options[prop];
            }
          }
        }
      }
    }
    if (typeof options === "string" && options) {
      if (_hasOwn.call(_globalConfig, options)) {
        return _globalConfig[options];
      }
      return;
    }
    return _deepCopy(_globalConfig);
  };
  /**
 * The underlying implementation of `ZeroClipboard.state`.
 * @private
 */
  var _state = function() {
    _detectSandbox();
    return {
      browser: _pick(_navigator, [ "userAgent", "platform", "appName" ]),
      flash: _omit(_flashState, [ "bridge" ]),
      zeroclipboard: {
        version: ZeroClipboard.version,
        config: ZeroClipboard.config()
      }
    };
  };
  /**
 * The underlying implementation of `ZeroClipboard.isFlashUnusable`.
 * @private
 */
  var _isFlashUnusable = function() {
    return !!(_flashState.disabled || _flashState.outdated || _flashState.sandboxed || _flashState.unavailable || _flashState.degraded || _flashState.deactivated);
  };
  /**
 * The underlying implementation of `ZeroClipboard.on`.
 * @private
 */
  var _on = function(eventType, listener) {
    var i, len, events, added = {};
    if (typeof eventType === "string" && eventType) {
      events = eventType.toLowerCase().split(/\s+/);
    } else if (typeof eventType === "object" && eventType && typeof listener === "undefined") {
      for (i in eventType) {
        if (_hasOwn.call(eventType, i) && typeof i === "string" && i && typeof eventType[i] === "function") {
          ZeroClipboard.on(i, eventType[i]);
        }
      }
    }
    if (events && events.length) {
      for (i = 0, len = events.length; i < len; i++) {
        eventType = events[i].replace(/^on/, "");
        added[eventType] = true;
        if (!_handlers[eventType]) {
          _handlers[eventType] = [];
        }
        _handlers[eventType].push(listener);
      }
      if (added.ready && _flashState.ready) {
        ZeroClipboard.emit({
          type: "ready"
        });
      }
      if (added.error) {
        for (i = 0, len = _flashStateErrorNames.length; i < len; i++) {
          if (_flashState[_flashStateErrorNames[i].replace(/^flash-/, "")] === true) {
            ZeroClipboard.emit({
              type: "error",
              name: _flashStateErrorNames[i]
            });
            break;
          }
        }
        if (_zcSwfVersion !== undefined && ZeroClipboard.version !== _zcSwfVersion) {
          ZeroClipboard.emit({
            type: "error",
            name: "version-mismatch",
            jsVersion: ZeroClipboard.version,
            swfVersion: _zcSwfVersion
          });
        }
      }
    }
    return ZeroClipboard;
  };
  /**
 * The underlying implementation of `ZeroClipboard.off`.
 * @private
 */
  var _off = function(eventType, listener) {
    var i, len, foundIndex, events, perEventHandlers;
    if (arguments.length === 0) {
      events = _keys(_handlers);
    } else if (typeof eventType === "string" && eventType) {
      events = eventType.split(/\s+/);
    } else if (typeof eventType === "object" && eventType && typeof listener === "undefined") {
      for (i in eventType) {
        if (_hasOwn.call(eventType, i) && typeof i === "string" && i && typeof eventType[i] === "function") {
          ZeroClipboard.off(i, eventType[i]);
        }
      }
    }
    if (events && events.length) {
      for (i = 0, len = events.length; i < len; i++) {
        eventType = events[i].toLowerCase().replace(/^on/, "");
        perEventHandlers = _handlers[eventType];
        if (perEventHandlers && perEventHandlers.length) {
          if (listener) {
            foundIndex = perEventHandlers.indexOf(listener);
            while (foundIndex !== -1) {
              perEventHandlers.splice(foundIndex, 1);
              foundIndex = perEventHandlers.indexOf(listener, foundIndex);
            }
          } else {
            perEventHandlers.length = 0;
          }
        }
      }
    }
    return ZeroClipboard;
  };
  /**
 * The underlying implementation of `ZeroClipboard.handlers`.
 * @private
 */
  var _listeners = function(eventType) {
    var copy;
    if (typeof eventType === "string" && eventType) {
      copy = _deepCopy(_handlers[eventType]) || null;
    } else {
      copy = _deepCopy(_handlers);
    }
    return copy;
  };
  /**
 * The underlying implementation of `ZeroClipboard.emit`.
 * @private
 */
  var _emit = function(event) {
    var eventCopy, returnVal, tmp;
    event = _createEvent(event);
    if (!event) {
      return;
    }
    if (_preprocessEvent(event)) {
      return;
    }
    if (event.type === "ready" && _flashState.overdue === true) {
      return ZeroClipboard.emit({
        type: "error",
        name: "flash-overdue"
      });
    }
    eventCopy = _extend({}, event);
    _dispatchCallbacks.call(this, eventCopy);
    if (event.type === "copy") {
      tmp = _mapClipDataToFlash(_clipData);
      returnVal = tmp.data;
      _clipDataFormatMap = tmp.formatMap;
    }
    return returnVal;
  };
  /**
 * The underlying implementation of `ZeroClipboard.create`.
 * @private
 */
  var _create = function() {
    var previousState = _flashState.sandboxed;
    _detectSandbox();
    if (typeof _flashState.ready !== "boolean") {
      _flashState.ready = false;
    }
    if (_flashState.sandboxed !== previousState && _flashState.sandboxed === true) {
      _flashState.ready = false;
      ZeroClipboard.emit({
        type: "error",
        name: "flash-sandboxed"
      });
    } else if (!ZeroClipboard.isFlashUnusable() && _flashState.bridge === null) {
      var maxWait = _globalConfig.flashLoadTimeout;
      if (typeof maxWait === "number" && maxWait >= 0) {
        _flashCheckTimeout = _setTimeout(function() {
          if (typeof _flashState.deactivated !== "boolean") {
            _flashState.deactivated = true;
          }
          if (_flashState.deactivated === true) {
            ZeroClipboard.emit({
              type: "error",
              name: "flash-deactivated"
            });
          }
        }, maxWait);
      }
      _flashState.overdue = false;
      _embedSwf();
    }
  };
  /**
 * The underlying implementation of `ZeroClipboard.destroy`.
 * @private
 */
  var _destroy = function() {
    ZeroClipboard.clearData();
    ZeroClipboard.blur();
    ZeroClipboard.emit("destroy");
    _unembedSwf();
    ZeroClipboard.off();
  };
  /**
 * The underlying implementation of `ZeroClipboard.setData`.
 * @private
 */
  var _setData = function(format, data) {
    var dataObj;
    if (typeof format === "object" && format && typeof data === "undefined") {
      dataObj = format;
      ZeroClipboard.clearData();
    } else if (typeof format === "string" && format) {
      dataObj = {};
      dataObj[format] = data;
    } else {
      return;
    }
    for (var dataFormat in dataObj) {
      if (typeof dataFormat === "string" && dataFormat && _hasOwn.call(dataObj, dataFormat) && typeof dataObj[dataFormat] === "string" && dataObj[dataFormat]) {
        _clipData[dataFormat] = dataObj[dataFormat];
      }
    }
  };
  /**
 * The underlying implementation of `ZeroClipboard.clearData`.
 * @private
 */
  var _clearData = function(format) {
    if (typeof format === "undefined") {
      _deleteOwnProperties(_clipData);
      _clipDataFormatMap = null;
    } else if (typeof format === "string" && _hasOwn.call(_clipData, format)) {
      delete _clipData[format];
    }
  };
  /**
 * The underlying implementation of `ZeroClipboard.getData`.
 * @private
 */
  var _getData = function(format) {
    if (typeof format === "undefined") {
      return _deepCopy(_clipData);
    } else if (typeof format === "string" && _hasOwn.call(_clipData, format)) {
      return _clipData[format];
    }
  };
  /**
 * The underlying implementation of `ZeroClipboard.focus`/`ZeroClipboard.activate`.
 * @private
 */
  var _focus = function(element) {
    if (!(element && element.nodeType === 1)) {
      return;
    }
    if (_currentElement) {
      _removeClass(_currentElement, _globalConfig.activeClass);
      if (_currentElement !== element) {
        _removeClass(_currentElement, _globalConfig.hoverClass);
      }
    }
    _currentElement = element;
    _addClass(element, _globalConfig.hoverClass);
    var newTitle = element.getAttribute("title") || _globalConfig.title;
    if (typeof newTitle === "string" && newTitle) {
      var htmlBridge = _getHtmlBridge(_flashState.bridge);
      if (htmlBridge) {
        htmlBridge.setAttribute("title", newTitle);
      }
    }
    var useHandCursor = _globalConfig.forceHandCursor === true || _getStyle(element, "cursor") === "pointer";
    _setHandCursor(useHandCursor);
    _reposition();
  };
  /**
 * The underlying implementation of `ZeroClipboard.blur`/`ZeroClipboard.deactivate`.
 * @private
 */
  var _blur = function() {
    var htmlBridge = _getHtmlBridge(_flashState.bridge);
    if (htmlBridge) {
      htmlBridge.removeAttribute("title");
      htmlBridge.style.left = "0px";
      htmlBridge.style.top = "-9999px";
      htmlBridge.style.width = "1px";
      htmlBridge.style.height = "1px";
    }
    if (_currentElement) {
      _removeClass(_currentElement, _globalConfig.hoverClass);
      _removeClass(_currentElement, _globalConfig.activeClass);
      _currentElement = null;
    }
  };
  /**
 * The underlying implementation of `ZeroClipboard.activeElement`.
 * @private
 */
  var _activeElement = function() {
    return _currentElement || null;
  };
  /**
 * Check if a value is a valid HTML4 `ID` or `Name` token.
 * @private
 */
  var _isValidHtml4Id = function(id) {
    return typeof id === "string" && id && /^[A-Za-z][A-Za-z0-9_:\-\.]*$/.test(id);
  };
  /**
 * Create or update an `event` object, based on the `eventType`.
 * @private
 */
  var _createEvent = function(event) {
    var eventType;
    if (typeof event === "string" && event) {
      eventType = event;
      event = {};
    } else if (typeof event === "object" && event && typeof event.type === "string" && event.type) {
      eventType = event.type;
    }
    if (!eventType) {
      return;
    }
    eventType = eventType.toLowerCase();
    if (!event.target && (/^(copy|aftercopy|_click)$/.test(eventType) || eventType === "error" && event.name === "clipboard-error")) {
      event.target = _copyTarget;
    }
    _extend(event, {
      type: eventType,
      target: event.target || _currentElement || null,
      relatedTarget: event.relatedTarget || null,
      currentTarget: _flashState && _flashState.bridge || null,
      timeStamp: event.timeStamp || _now() || null
    });
    var msg = _eventMessages[event.type];
    if (event.type === "error" && event.name && msg) {
      msg = msg[event.name];
    }
    if (msg) {
      event.message = msg;
    }
    if (event.type === "ready") {
      _extend(event, {
        target: null,
        version: _flashState.version
      });
    }
    if (event.type === "error") {
      if (_flashStateErrorNameMatchingRegex.test(event.name)) {
        _extend(event, {
          target: null,
          minimumVersion: _minimumFlashVersion
        });
      }
      if (_flashStateEnabledErrorNameMatchingRegex.test(event.name)) {
        _extend(event, {
          version: _flashState.version
        });
      }
    }
    if (event.type === "copy") {
      event.clipboardData = {
        setData: ZeroClipboard.setData,
        clearData: ZeroClipboard.clearData
      };
    }
    if (event.type === "aftercopy") {
      event = _mapClipResultsFromFlash(event, _clipDataFormatMap);
    }
    if (event.target && !event.relatedTarget) {
      event.relatedTarget = _getRelatedTarget(event.target);
    }
    return _addMouseData(event);
  };
  /**
 * Get a relatedTarget from the target's `data-clipboard-target` attribute
 * @private
 */
  var _getRelatedTarget = function(targetEl) {
    var relatedTargetId = targetEl && targetEl.getAttribute && targetEl.getAttribute("data-clipboard-target");
    return relatedTargetId ? _document.getElementById(relatedTargetId) : null;
  };
  /**
 * Add element and position data to `MouseEvent` instances
 * @private
 */
  var _addMouseData = function(event) {
    if (event && /^_(?:click|mouse(?:over|out|down|up|move))$/.test(event.type)) {
      var srcElement = event.target;
      var fromElement = event.type === "_mouseover" && event.relatedTarget ? event.relatedTarget : undefined;
      var toElement = event.type === "_mouseout" && event.relatedTarget ? event.relatedTarget : undefined;
      var pos = _getElementPosition(srcElement);
      var screenLeft = _window.screenLeft || _window.screenX || 0;
      var screenTop = _window.screenTop || _window.screenY || 0;
      var scrollLeft = _document.body.scrollLeft + _document.documentElement.scrollLeft;
      var scrollTop = _document.body.scrollTop + _document.documentElement.scrollTop;
      var pageX = pos.left + (typeof event._stageX === "number" ? event._stageX : 0);
      var pageY = pos.top + (typeof event._stageY === "number" ? event._stageY : 0);
      var clientX = pageX - scrollLeft;
      var clientY = pageY - scrollTop;
      var screenX = screenLeft + clientX;
      var screenY = screenTop + clientY;
      var moveX = typeof event.movementX === "number" ? event.movementX : 0;
      var moveY = typeof event.movementY === "number" ? event.movementY : 0;
      delete event._stageX;
      delete event._stageY;
      _extend(event, {
        srcElement: srcElement,
        fromElement: fromElement,
        toElement: toElement,
        screenX: screenX,
        screenY: screenY,
        pageX: pageX,
        pageY: pageY,
        clientX: clientX,
        clientY: clientY,
        x: clientX,
        y: clientY,
        movementX: moveX,
        movementY: moveY,
        offsetX: 0,
        offsetY: 0,
        layerX: 0,
        layerY: 0
      });
    }
    return event;
  };
  /**
 * Determine if an event's registered handlers should be execute synchronously or asynchronously.
 *
 * @returns {boolean}
 * @private
 */
  var _shouldPerformAsync = function(event) {
    var eventType = event && typeof event.type === "string" && event.type || "";
    return !/^(?:(?:before)?copy|destroy)$/.test(eventType);
  };
  /**
 * Control if a callback should be executed asynchronously or not.
 *
 * @returns `undefined`
 * @private
 */
  var _dispatchCallback = function(func, context, args, async) {
    if (async) {
      _setTimeout(function() {
        func.apply(context, args);
      }, 0);
    } else {
      func.apply(context, args);
    }
  };
  /**
 * Handle the actual dispatching of events to client instances.
 *
 * @returns `undefined`
 * @private
 */
  var _dispatchCallbacks = function(event) {
    if (!(typeof event === "object" && event && event.type)) {
      return;
    }
    var async = _shouldPerformAsync(event);
    var wildcardTypeHandlers = _handlers["*"] || [];
    var specificTypeHandlers = _handlers[event.type] || [];
    var handlers = wildcardTypeHandlers.concat(specificTypeHandlers);
    if (handlers && handlers.length) {
      var i, len, func, context, eventCopy, originalContext = this;
      for (i = 0, len = handlers.length; i < len; i++) {
        func = handlers[i];
        context = originalContext;
        if (typeof func === "string" && typeof _window[func] === "function") {
          func = _window[func];
        }
        if (typeof func === "object" && func && typeof func.handleEvent === "function") {
          context = func;
          func = func.handleEvent;
        }
        if (typeof func === "function") {
          eventCopy = _extend({}, event);
          _dispatchCallback(func, context, [ eventCopy ], async);
        }
      }
    }
    return this;
  };
  /**
 * Check an `error` event's `name` property to see if Flash has
 * already loaded, which rules out possible `iframe` sandboxing.
 * @private
 */
  var _getSandboxStatusFromErrorEvent = function(event) {
    var isSandboxed = null;
    if (_pageIsFramed === false || event && event.type === "error" && event.name && _errorsThatOnlyOccurAfterFlashLoads.indexOf(event.name) !== -1) {
      isSandboxed = false;
    }
    return isSandboxed;
  };
  /**
 * Preprocess any special behaviors, reactions, or state changes after receiving this event.
 * Executes only once per event emitted, NOT once per client.
 * @private
 */
  var _preprocessEvent = function(event) {
    var element = event.target || _currentElement || null;
    var sourceIsSwf = event._source === "swf";
    delete event._source;
    switch (event.type) {
     case "error":
      var isSandboxed = event.name === "flash-sandboxed" || _getSandboxStatusFromErrorEvent(event);
      if (typeof isSandboxed === "boolean") {
        _flashState.sandboxed = isSandboxed;
      }
      if (_flashStateErrorNames.indexOf(event.name) !== -1) {
        _extend(_flashState, {
          disabled: event.name === "flash-disabled",
          outdated: event.name === "flash-outdated",
          unavailable: event.name === "flash-unavailable",
          degraded: event.name === "flash-degraded",
          deactivated: event.name === "flash-deactivated",
          overdue: event.name === "flash-overdue",
          ready: false
        });
      } else if (event.name === "version-mismatch") {
        _zcSwfVersion = event.swfVersion;
        _extend(_flashState, {
          disabled: false,
          outdated: false,
          unavailable: false,
          degraded: false,
          deactivated: false,
          overdue: false,
          ready: false
        });
      }
      _clearTimeoutsAndPolling();
      break;

     case "ready":
      _zcSwfVersion = event.swfVersion;
      var wasDeactivated = _flashState.deactivated === true;
      _extend(_flashState, {
        disabled: false,
        outdated: false,
        sandboxed: false,
        unavailable: false,
        degraded: false,
        deactivated: false,
        overdue: wasDeactivated,
        ready: !wasDeactivated
      });
      _clearTimeoutsAndPolling();
      break;

     case "beforecopy":
      _copyTarget = element;
      break;

     case "copy":
      var textContent, htmlContent, targetEl = event.relatedTarget;
      if (!(_clipData["text/html"] || _clipData["text/plain"]) && targetEl && (htmlContent = targetEl.value || targetEl.outerHTML || targetEl.innerHTML) && (textContent = targetEl.value || targetEl.textContent || targetEl.innerText)) {
        event.clipboardData.clearData();
        event.clipboardData.setData("text/plain", textContent);
        if (htmlContent !== textContent) {
          event.clipboardData.setData("text/html", htmlContent);
        }
      } else if (!_clipData["text/plain"] && event.target && (textContent = event.target.getAttribute("data-clipboard-text"))) {
        event.clipboardData.clearData();
        event.clipboardData.setData("text/plain", textContent);
      }
      break;

     case "aftercopy":
      _queueEmitClipboardErrors(event);
      ZeroClipboard.clearData();
      if (element && element !== _safeActiveElement() && element.focus) {
        element.focus();
      }
      break;

     case "_mouseover":
      ZeroClipboard.focus(element);
      if (_globalConfig.bubbleEvents === true && sourceIsSwf) {
        if (element && element !== event.relatedTarget && !_containedBy(event.relatedTarget, element)) {
          _fireMouseEvent(_extend({}, event, {
            type: "mouseenter",
            bubbles: false,
            cancelable: false
          }));
        }
        _fireMouseEvent(_extend({}, event, {
          type: "mouseover"
        }));
      }
      break;

     case "_mouseout":
      ZeroClipboard.blur();
      if (_globalConfig.bubbleEvents === true && sourceIsSwf) {
        if (element && element !== event.relatedTarget && !_containedBy(event.relatedTarget, element)) {
          _fireMouseEvent(_extend({}, event, {
            type: "mouseleave",
            bubbles: false,
            cancelable: false
          }));
        }
        _fireMouseEvent(_extend({}, event, {
          type: "mouseout"
        }));
      }
      break;

     case "_mousedown":
      _addClass(element, _globalConfig.activeClass);
      if (_globalConfig.bubbleEvents === true && sourceIsSwf) {
        _fireMouseEvent(_extend({}, event, {
          type: event.type.slice(1)
        }));
      }
      break;

     case "_mouseup":
      _removeClass(element, _globalConfig.activeClass);
      if (_globalConfig.bubbleEvents === true && sourceIsSwf) {
        _fireMouseEvent(_extend({}, event, {
          type: event.type.slice(1)
        }));
      }
      break;

     case "_click":
      _copyTarget = null;
      if (_globalConfig.bubbleEvents === true && sourceIsSwf) {
        _fireMouseEvent(_extend({}, event, {
          type: event.type.slice(1)
        }));
      }
      break;

     case "_mousemove":
      if (_globalConfig.bubbleEvents === true && sourceIsSwf) {
        _fireMouseEvent(_extend({}, event, {
          type: event.type.slice(1)
        }));
      }
      break;
    }
    if (/^_(?:click|mouse(?:over|out|down|up|move))$/.test(event.type)) {
      return true;
    }
  };
  /**
 * Check an "aftercopy" event for clipboard errors and emit a corresponding "error" event.
 * @private
 */
  var _queueEmitClipboardErrors = function(aftercopyEvent) {
    if (aftercopyEvent.errors && aftercopyEvent.errors.length > 0) {
      var errorEvent = _deepCopy(aftercopyEvent);
      _extend(errorEvent, {
        type: "error",
        name: "clipboard-error"
      });
      delete errorEvent.success;
      _setTimeout(function() {
        ZeroClipboard.emit(errorEvent);
      }, 0);
    }
  };
  /**
 * Dispatch a synthetic MouseEvent.
 *
 * @returns `undefined`
 * @private
 */
  var _fireMouseEvent = function(event) {
    if (!(event && typeof event.type === "string" && event)) {
      return;
    }
    var e, target = event.target || null, doc = target && target.ownerDocument || _document, defaults = {
      view: doc.defaultView || _window,
      canBubble: true,
      cancelable: true,
      detail: event.type === "click" ? 1 : 0,
      button: typeof event.which === "number" ? event.which - 1 : typeof event.button === "number" ? event.button : doc.createEvent ? 0 : 1
    }, args = _extend(defaults, event);
    if (!target) {
      return;
    }
    if (doc.createEvent && target.dispatchEvent) {
      args = [ args.type, args.canBubble, args.cancelable, args.view, args.detail, args.screenX, args.screenY, args.clientX, args.clientY, args.ctrlKey, args.altKey, args.shiftKey, args.metaKey, args.button, args.relatedTarget ];
      e = doc.createEvent("MouseEvents");
      if (e.initMouseEvent) {
        e.initMouseEvent.apply(e, args);
        e._source = "js";
        target.dispatchEvent(e);
      }
    }
  };
  /**
 * Continuously poll the DOM until either:
 *  (a) the fallback content becomes visible, or
 *  (b) we receive an event from SWF (handled elsewhere)
 *
 * IMPORTANT:
 * This is NOT a necessary check but it can result in significantly faster
 * detection of bad `swfPath` configuration and/or network/server issues [in
 * supported browsers] than waiting for the entire `flashLoadTimeout` duration
 * to elapse before detecting that the SWF cannot be loaded. The detection
 * duration can be anywhere from 10-30 times faster [in supported browsers] by
 * using this approach.
 *
 * @returns `undefined`
 * @private
 */
  var _watchForSwfFallbackContent = function() {
    var maxWait = _globalConfig.flashLoadTimeout;
    if (typeof maxWait === "number" && maxWait >= 0) {
      var pollWait = Math.min(1e3, maxWait / 10);
      var fallbackContentId = _globalConfig.swfObjectId + "_fallbackContent";
      _swfFallbackCheckInterval = _setInterval(function() {
        var el = _document.getElementById(fallbackContentId);
        if (_isElementVisible(el)) {
          _clearTimeoutsAndPolling();
          _flashState.deactivated = null;
          ZeroClipboard.emit({
            type: "error",
            name: "swf-not-found"
          });
        }
      }, pollWait);
    }
  };
  /**
 * Create the HTML bridge element to embed the Flash object into.
 * @private
 */
  var _createHtmlBridge = function() {
    var container = _document.createElement("div");
    container.id = _globalConfig.containerId;
    container.className = _globalConfig.containerClass;
    container.style.position = "absolute";
    container.style.left = "0px";
    container.style.top = "-9999px";
    container.style.width = "1px";
    container.style.height = "1px";
    container.style.zIndex = "" + _getSafeZIndex(_globalConfig.zIndex);
    return container;
  };
  /**
 * Get the HTML element container that wraps the Flash bridge object/element.
 * @private
 */
  var _getHtmlBridge = function(flashBridge) {
    var htmlBridge = flashBridge && flashBridge.parentNode;
    while (htmlBridge && htmlBridge.nodeName === "OBJECT" && htmlBridge.parentNode) {
      htmlBridge = htmlBridge.parentNode;
    }
    return htmlBridge || null;
  };
  /**
 * Create the SWF object.
 *
 * @returns The SWF object reference.
 * @private
 */
  var _embedSwf = function() {
    var len, flashBridge = _flashState.bridge, container = _getHtmlBridge(flashBridge);
    if (!flashBridge) {
      var allowScriptAccess = _determineScriptAccess(_window.location.host, _globalConfig);
      var allowNetworking = allowScriptAccess === "never" ? "none" : "all";
      var flashvars = _vars(_extend({
        jsVersion: ZeroClipboard.version
      }, _globalConfig));
      var swfUrl = _globalConfig.swfPath + _cacheBust(_globalConfig.swfPath, _globalConfig);
      container = _createHtmlBridge();
      var divToBeReplaced = _document.createElement("div");
      container.appendChild(divToBeReplaced);
      _document.body.appendChild(container);
      var tmpDiv = _document.createElement("div");
      var usingActiveX = _flashState.pluginType === "activex";
      tmpDiv.innerHTML = '<object id="' + _globalConfig.swfObjectId + '" name="' + _globalConfig.swfObjectId + '" ' + 'width="100%" height="100%" ' + (usingActiveX ? 'classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"' : 'type="application/x-shockwave-flash" data="' + swfUrl + '"') + ">" + (usingActiveX ? '<param name="movie" value="' + swfUrl + '"/>' : "") + '<param name="allowScriptAccess" value="' + allowScriptAccess + '"/>' + '<param name="allowNetworking" value="' + allowNetworking + '"/>' + '<param name="menu" value="false"/>' + '<param name="wmode" value="transparent"/>' + '<param name="flashvars" value="' + flashvars + '"/>' + '<div id="' + _globalConfig.swfObjectId + '_fallbackContent">&nbsp;</div>' + "</object>";
      flashBridge = tmpDiv.firstChild;
      tmpDiv = null;
      _unwrap(flashBridge).ZeroClipboard = ZeroClipboard;
      container.replaceChild(flashBridge, divToBeReplaced);
      _watchForSwfFallbackContent();
    }
    if (!flashBridge) {
      flashBridge = _document[_globalConfig.swfObjectId];
      if (flashBridge && (len = flashBridge.length)) {
        flashBridge = flashBridge[len - 1];
      }
      if (!flashBridge && container) {
        flashBridge = container.firstChild;
      }
    }
    _flashState.bridge = flashBridge || null;
    return flashBridge;
  };
  /**
 * Destroy the SWF object.
 * @private
 */
  var _unembedSwf = function() {
    var flashBridge = _flashState.bridge;
    if (flashBridge) {
      var htmlBridge = _getHtmlBridge(flashBridge);
      if (htmlBridge) {
        if (_flashState.pluginType === "activex" && "readyState" in flashBridge) {
          flashBridge.style.display = "none";
          (function removeSwfFromIE() {
            if (flashBridge.readyState === 4) {
              for (var prop in flashBridge) {
                if (typeof flashBridge[prop] === "function") {
                  flashBridge[prop] = null;
                }
              }
              if (flashBridge.parentNode) {
                flashBridge.parentNode.removeChild(flashBridge);
              }
              if (htmlBridge.parentNode) {
                htmlBridge.parentNode.removeChild(htmlBridge);
              }
            } else {
              _setTimeout(removeSwfFromIE, 10);
            }
          })();
        } else {
          if (flashBridge.parentNode) {
            flashBridge.parentNode.removeChild(flashBridge);
          }
          if (htmlBridge.parentNode) {
            htmlBridge.parentNode.removeChild(htmlBridge);
          }
        }
      }
      _clearTimeoutsAndPolling();
      _flashState.ready = null;
      _flashState.bridge = null;
      _flashState.deactivated = null;
      _zcSwfVersion = undefined;
    }
  };
  /**
 * Map the data format names of the "clipData" to Flash-friendly names.
 *
 * @returns A new transformed object.
 * @private
 */
  var _mapClipDataToFlash = function(clipData) {
    var newClipData = {}, formatMap = {};
    if (!(typeof clipData === "object" && clipData)) {
      return;
    }
    for (var dataFormat in clipData) {
      if (dataFormat && _hasOwn.call(clipData, dataFormat) && typeof clipData[dataFormat] === "string" && clipData[dataFormat]) {
        switch (dataFormat.toLowerCase()) {
         case "text/plain":
         case "text":
         case "air:text":
         case "flash:text":
          newClipData.text = clipData[dataFormat];
          formatMap.text = dataFormat;
          break;

         case "text/html":
         case "html":
         case "air:html":
         case "flash:html":
          newClipData.html = clipData[dataFormat];
          formatMap.html = dataFormat;
          break;

         case "application/rtf":
         case "text/rtf":
         case "rtf":
         case "richtext":
         case "air:rtf":
         case "flash:rtf":
          newClipData.rtf = clipData[dataFormat];
          formatMap.rtf = dataFormat;
          break;

         default:
          break;
        }
      }
    }
    return {
      data: newClipData,
      formatMap: formatMap
    };
  };
  /**
 * Map the data format names from Flash-friendly names back to their original "clipData" names (via a format mapping).
 *
 * @returns A new transformed object.
 * @private
 */
  var _mapClipResultsFromFlash = function(clipResults, formatMap) {
    if (!(typeof clipResults === "object" && clipResults && typeof formatMap === "object" && formatMap)) {
      return clipResults;
    }
    var newResults = {};
    for (var prop in clipResults) {
      if (_hasOwn.call(clipResults, prop)) {
        if (prop === "errors") {
          newResults[prop] = clipResults[prop] ? clipResults[prop].slice() : [];
          for (var i = 0, len = newResults[prop].length; i < len; i++) {
            newResults[prop][i].format = formatMap[newResults[prop][i].format];
          }
        } else if (prop !== "success" && prop !== "data") {
          newResults[prop] = clipResults[prop];
        } else {
          newResults[prop] = {};
          var tmpHash = clipResults[prop];
          for (var dataFormat in tmpHash) {
            if (dataFormat && _hasOwn.call(tmpHash, dataFormat) && _hasOwn.call(formatMap, dataFormat)) {
              newResults[prop][formatMap[dataFormat]] = tmpHash[dataFormat];
            }
          }
        }
      }
    }
    return newResults;
  };
  /**
 * Will look at a path, and will create a "?noCache={time}" or "&noCache={time}"
 * query param string to return. Does NOT append that string to the original path.
 * This is useful because ExternalInterface often breaks when a Flash SWF is cached.
 *
 * @returns The `noCache` query param with necessary "?"/"&" prefix.
 * @private
 */
  var _cacheBust = function(path, options) {
    var cacheBust = options == null || options && options.cacheBust === true;
    if (cacheBust) {
      return (path.indexOf("?") === -1 ? "?" : "&") + "noCache=" + _now();
    } else {
      return "";
    }
  };
  /**
 * Creates a query string for the FlashVars param.
 * Does NOT include the cache-busting query param.
 *
 * @returns FlashVars query string
 * @private
 */
  var _vars = function(options) {
    var i, len, domain, domains, str = "", trustedOriginsExpanded = [];
    if (options.trustedDomains) {
      if (typeof options.trustedDomains === "string") {
        domains = [ options.trustedDomains ];
      } else if (typeof options.trustedDomains === "object" && "length" in options.trustedDomains) {
        domains = options.trustedDomains;
      }
    }
    if (domains && domains.length) {
      for (i = 0, len = domains.length; i < len; i++) {
        if (_hasOwn.call(domains, i) && domains[i] && typeof domains[i] === "string") {
          domain = _extractDomain(domains[i]);
          if (!domain) {
            continue;
          }
          if (domain === "*") {
            trustedOriginsExpanded.length = 0;
            trustedOriginsExpanded.push(domain);
            break;
          }
          trustedOriginsExpanded.push.apply(trustedOriginsExpanded, [ domain, "//" + domain, _window.location.protocol + "//" + domain ]);
        }
      }
    }
    if (trustedOriginsExpanded.length) {
      str += "trustedOrigins=" + _encodeURIComponent(trustedOriginsExpanded.join(","));
    }
    if (options.forceEnhancedClipboard === true) {
      str += (str ? "&" : "") + "forceEnhancedClipboard=true";
    }
    if (typeof options.swfObjectId === "string" && options.swfObjectId) {
      str += (str ? "&" : "") + "swfObjectId=" + _encodeURIComponent(options.swfObjectId);
    }
    if (typeof options.jsVersion === "string" && options.jsVersion) {
      str += (str ? "&" : "") + "jsVersion=" + _encodeURIComponent(options.jsVersion);
    }
    return str;
  };
  /**
 * Extract the domain (e.g. "github.com") from an origin (e.g. "https://github.com") or
 * URL (e.g. "https://github.com/zeroclipboard/zeroclipboard/").
 *
 * @returns the domain
 * @private
 */
  var _extractDomain = function(originOrUrl) {
    if (originOrUrl == null || originOrUrl === "") {
      return null;
    }
    originOrUrl = originOrUrl.replace(/^\s+|\s+$/g, "");
    if (originOrUrl === "") {
      return null;
    }
    var protocolIndex = originOrUrl.indexOf("//");
    originOrUrl = protocolIndex === -1 ? originOrUrl : originOrUrl.slice(protocolIndex + 2);
    var pathIndex = originOrUrl.indexOf("/");
    originOrUrl = pathIndex === -1 ? originOrUrl : protocolIndex === -1 || pathIndex === 0 ? null : originOrUrl.slice(0, pathIndex);
    if (originOrUrl && originOrUrl.slice(-4).toLowerCase() === ".swf") {
      return null;
    }
    return originOrUrl || null;
  };
  /**
 * Set `allowScriptAccess` based on `trustedDomains` and `window.location.host` vs. `swfPath`.
 *
 * @returns The appropriate script access level.
 * @private
 */
  var _determineScriptAccess = function() {
    var _extractAllDomains = function(origins) {
      var i, len, tmp, resultsArray = [];
      if (typeof origins === "string") {
        origins = [ origins ];
      }
      if (!(typeof origins === "object" && origins && typeof origins.length === "number")) {
        return resultsArray;
      }
      for (i = 0, len = origins.length; i < len; i++) {
        if (_hasOwn.call(origins, i) && (tmp = _extractDomain(origins[i]))) {
          if (tmp === "*") {
            resultsArray.length = 0;
            resultsArray.push("*");
            break;
          }
          if (resultsArray.indexOf(tmp) === -1) {
            resultsArray.push(tmp);
          }
        }
      }
      return resultsArray;
    };
    return function(currentDomain, configOptions) {
      var swfDomain = _extractDomain(configOptions.swfPath);
      if (swfDomain === null) {
        swfDomain = currentDomain;
      }
      var trustedDomains = _extractAllDomains(configOptions.trustedDomains);
      var len = trustedDomains.length;
      if (len > 0) {
        if (len === 1 && trustedDomains[0] === "*") {
          return "always";
        }
        if (trustedDomains.indexOf(currentDomain) !== -1) {
          if (len === 1 && currentDomain === swfDomain) {
            return "sameDomain";
          }
          return "always";
        }
      }
      return "never";
    };
  }();
  /**
 * Get the currently active/focused DOM element.
 *
 * @returns the currently active/focused element, or `null`
 * @private
 */
  var _safeActiveElement = function() {
    try {
      return _document.activeElement;
    } catch (err) {
      return null;
    }
  };
  /**
 * Add a class to an element, if it doesn't already have it.
 *
 * @returns The element, with its new class added.
 * @private
 */
  var _addClass = function(element, value) {
    var c, cl, className, classNames = [];
    if (typeof value === "string" && value) {
      classNames = value.split(/\s+/);
    }
    if (element && element.nodeType === 1 && classNames.length > 0) {
      if (element.classList) {
        for (c = 0, cl = classNames.length; c < cl; c++) {
          element.classList.add(classNames[c]);
        }
      } else if (element.hasOwnProperty("className")) {
        className = " " + element.className + " ";
        for (c = 0, cl = classNames.length; c < cl; c++) {
          if (className.indexOf(" " + classNames[c] + " ") === -1) {
            className += classNames[c] + " ";
          }
        }
        element.className = className.replace(/^\s+|\s+$/g, "");
      }
    }
    return element;
  };
  /**
 * Remove a class from an element, if it has it.
 *
 * @returns The element, with its class removed.
 * @private
 */
  var _removeClass = function(element, value) {
    var c, cl, className, classNames = [];
    if (typeof value === "string" && value) {
      classNames = value.split(/\s+/);
    }
    if (element && element.nodeType === 1 && classNames.length > 0) {
      if (element.classList && element.classList.length > 0) {
        for (c = 0, cl = classNames.length; c < cl; c++) {
          element.classList.remove(classNames[c]);
        }
      } else if (element.className) {
        className = (" " + element.className + " ").replace(/[\r\n\t]/g, " ");
        for (c = 0, cl = classNames.length; c < cl; c++) {
          className = className.replace(" " + classNames[c] + " ", " ");
        }
        element.className = className.replace(/^\s+|\s+$/g, "");
      }
    }
    return element;
  };
  /**
 * Attempt to interpret the element's CSS styling. If `prop` is `"cursor"`,
 * then we assume that it should be a hand ("pointer") cursor if the element
 * is an anchor element ("a" tag).
 *
 * @returns The computed style property.
 * @private
 */
  var _getStyle = function(el, prop) {
    var value = _getComputedStyle(el, null).getPropertyValue(prop);
    if (prop === "cursor") {
      if (!value || value === "auto") {
        if (el.nodeName === "A") {
          return "pointer";
        }
      }
    }
    return value;
  };
  /**
 * Get the absolutely positioned coordinates of a DOM element.
 *
 * @returns Object containing the element's position, width, and height.
 * @private
 */
  var _getElementPosition = function(el) {
    var pos = {
      left: 0,
      top: 0,
      width: 0,
      height: 0
    };
    if (el.getBoundingClientRect) {
      var elRect = el.getBoundingClientRect();
      var pageXOffset = _window.pageXOffset;
      var pageYOffset = _window.pageYOffset;
      var leftBorderWidth = _document.documentElement.clientLeft || 0;
      var topBorderWidth = _document.documentElement.clientTop || 0;
      var leftBodyOffset = 0;
      var topBodyOffset = 0;
      if (_getStyle(_document.body, "position") === "relative") {
        var bodyRect = _document.body.getBoundingClientRect();
        var htmlRect = _document.documentElement.getBoundingClientRect();
        leftBodyOffset = bodyRect.left - htmlRect.left || 0;
        topBodyOffset = bodyRect.top - htmlRect.top || 0;
      }
      pos.left = elRect.left + pageXOffset - leftBorderWidth - leftBodyOffset;
      pos.top = elRect.top + pageYOffset - topBorderWidth - topBodyOffset;
      pos.width = "width" in elRect ? elRect.width : elRect.right - elRect.left;
      pos.height = "height" in elRect ? elRect.height : elRect.bottom - elRect.top;
    }
    return pos;
  };
  /**
 * Determine is an element is visible somewhere within the document (page).
 *
 * @returns Boolean
 * @private
 */
  var _isElementVisible = function(el) {
    if (!el) {
      return false;
    }
    var styles = _getComputedStyle(el, null);
    var hasCssHeight = _parseFloat(styles.height) > 0;
    var hasCssWidth = _parseFloat(styles.width) > 0;
    var hasCssTop = _parseFloat(styles.top) >= 0;
    var hasCssLeft = _parseFloat(styles.left) >= 0;
    var cssKnows = hasCssHeight && hasCssWidth && hasCssTop && hasCssLeft;
    var rect = cssKnows ? null : _getElementPosition(el);
    var isVisible = styles.display !== "none" && styles.visibility !== "collapse" && (cssKnows || !!rect && (hasCssHeight || rect.height > 0) && (hasCssWidth || rect.width > 0) && (hasCssTop || rect.top >= 0) && (hasCssLeft || rect.left >= 0));
    return isVisible;
  };
  /**
 * Clear all existing timeouts and interval polling delegates.
 *
 * @returns `undefined`
 * @private
 */
  var _clearTimeoutsAndPolling = function() {
    _clearTimeout(_flashCheckTimeout);
    _flashCheckTimeout = 0;
    _clearInterval(_swfFallbackCheckInterval);
    _swfFallbackCheckInterval = 0;
  };
  /**
 * Reposition the Flash object to cover the currently activated element.
 *
 * @returns `undefined`
 * @private
 */
  var _reposition = function() {
    var htmlBridge;
    if (_currentElement && (htmlBridge = _getHtmlBridge(_flashState.bridge))) {
      var pos = _getElementPosition(_currentElement);
      _extend(htmlBridge.style, {
        width: pos.width + "px",
        height: pos.height + "px",
        top: pos.top + "px",
        left: pos.left + "px",
        zIndex: "" + _getSafeZIndex(_globalConfig.zIndex)
      });
    }
  };
  /**
 * Sends a signal to the Flash object to display the hand cursor if `true`.
 *
 * @returns `undefined`
 * @private
 */
  var _setHandCursor = function(enabled) {
    if (_flashState.ready === true) {
      if (_flashState.bridge && typeof _flashState.bridge.setHandCursor === "function") {
        _flashState.bridge.setHandCursor(enabled);
      } else {
        _flashState.ready = false;
      }
    }
  };
  /**
 * Get a safe value for `zIndex`
 *
 * @returns an integer, or "auto"
 * @private
 */
  var _getSafeZIndex = function(val) {
    if (/^(?:auto|inherit)$/.test(val)) {
      return val;
    }
    var zIndex;
    if (typeof val === "number" && !_isNaN(val)) {
      zIndex = val;
    } else if (typeof val === "string") {
      zIndex = _getSafeZIndex(_parseInt(val, 10));
    }
    return typeof zIndex === "number" ? zIndex : "auto";
  };
  /**
 * Attempt to detect if ZeroClipboard is executing inside of a sandboxed iframe.
 * If it is, Flash Player cannot be used, so ZeroClipboard is dead in the water.
 *
 * @see {@link http://lists.w3.org/Archives/Public/public-whatwg-archive/2014Dec/0002.html}
 * @see {@link https://github.com/zeroclipboard/zeroclipboard/issues/511}
 * @see {@link http://zeroclipboard.org/test-iframes.html}
 *
 * @returns `true` (is sandboxed), `false` (is not sandboxed), or `null` (uncertain) 
 * @private
 */
  var _detectSandbox = function(doNotReassessFlashSupport) {
    var effectiveScriptOrigin, frame, frameError, previousState = _flashState.sandboxed, isSandboxed = null;
    doNotReassessFlashSupport = doNotReassessFlashSupport === true;
    if (_pageIsFramed === false) {
      isSandboxed = false;
    } else {
      try {
        frame = window.frameElement || null;
      } catch (e) {
        frameError = {
          name: e.name,
          message: e.message
        };
      }
      if (frame && frame.nodeType === 1 && frame.nodeName === "IFRAME") {
        try {
          isSandboxed = frame.hasAttribute("sandbox");
        } catch (e) {
          isSandboxed = null;
        }
      } else {
        try {
          effectiveScriptOrigin = document.domain || null;
        } catch (e) {
          effectiveScriptOrigin = null;
        }
        if (effectiveScriptOrigin === null || frameError && frameError.name === "SecurityError" && /(^|[\s\(\[@])sandbox(es|ed|ing|[\s\.,!\)\]@]|$)/.test(frameError.message.toLowerCase())) {
          isSandboxed = true;
        }
      }
    }
    _flashState.sandboxed = isSandboxed;
    if (previousState !== isSandboxed && !doNotReassessFlashSupport) {
      _detectFlashSupport(_ActiveXObject);
    }
    return isSandboxed;
  };
  /**
 * Detect the Flash Player status, version, and plugin type.
 *
 * @see {@link https://code.google.com/p/doctype-mirror/wiki/ArticleDetectFlash#The_code}
 * @see {@link http://stackoverflow.com/questions/12866060/detecting-pepper-ppapi-flash-with-javascript}
 *
 * @returns `undefined`
 * @private
 */
  var _detectFlashSupport = function(ActiveXObject) {
    var plugin, ax, mimeType, hasFlash = false, isActiveX = false, isPPAPI = false, flashVersion = "";
    /**
   * Derived from Apple's suggested sniffer.
   * @param {String} desc e.g. "Shockwave Flash 7.0 r61"
   * @returns {String} "7.0.61"
   * @private
   */
    function parseFlashVersion(desc) {
      var matches = desc.match(/[\d]+/g);
      matches.length = 3;
      return matches.join(".");
    }
    function isPepperFlash(flashPlayerFileName) {
      return !!flashPlayerFileName && (flashPlayerFileName = flashPlayerFileName.toLowerCase()) && (/^(pepflashplayer\.dll|libpepflashplayer\.so|pepperflashplayer\.plugin)$/.test(flashPlayerFileName) || flashPlayerFileName.slice(-13) === "chrome.plugin");
    }
    function inspectPlugin(plugin) {
      if (plugin) {
        hasFlash = true;
        if (plugin.version) {
          flashVersion = parseFlashVersion(plugin.version);
        }
        if (!flashVersion && plugin.description) {
          flashVersion = parseFlashVersion(plugin.description);
        }
        if (plugin.filename) {
          isPPAPI = isPepperFlash(plugin.filename);
        }
      }
    }
    if (_navigator.plugins && _navigator.plugins.length) {
      plugin = _navigator.plugins["Shockwave Flash"];
      inspectPlugin(plugin);
      if (_navigator.plugins["Shockwave Flash 2.0"]) {
        hasFlash = true;
        flashVersion = "2.0.0.11";
      }
    } else if (_navigator.mimeTypes && _navigator.mimeTypes.length) {
      mimeType = _navigator.mimeTypes["application/x-shockwave-flash"];
      plugin = mimeType && mimeType.enabledPlugin;
      inspectPlugin(plugin);
    } else if (typeof ActiveXObject !== "undefined") {
      isActiveX = true;
      try {
        ax = new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");
        hasFlash = true;
        flashVersion = parseFlashVersion(ax.GetVariable("$version"));
      } catch (e1) {
        try {
          ax = new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");
          hasFlash = true;
          flashVersion = "6.0.21";
        } catch (e2) {
          try {
            ax = new ActiveXObject("ShockwaveFlash.ShockwaveFlash");
            hasFlash = true;
            flashVersion = parseFlashVersion(ax.GetVariable("$version"));
          } catch (e3) {
            isActiveX = false;
          }
        }
      }
    }
    _flashState.disabled = hasFlash !== true;
    _flashState.outdated = flashVersion && _parseFloat(flashVersion) < _parseFloat(_minimumFlashVersion);
    _flashState.version = flashVersion || "0.0.0";
    _flashState.pluginType = isPPAPI ? "pepper" : isActiveX ? "activex" : hasFlash ? "netscape" : "unknown";
  };
  /**
 * Invoke the Flash detection algorithms immediately upon inclusion so we're not waiting later.
 */
  _detectFlashSupport(_ActiveXObject);
  /**
 * Always assess the `sandboxed` state of the page at important Flash-related moments.
 */
  _detectSandbox(true);
  /**
 * A shell constructor for `ZeroClipboard` client instances.
 *
 * @constructor
 */
  var ZeroClipboard = function() {
    if (!(this instanceof ZeroClipboard)) {
      return new ZeroClipboard();
    }
    if (typeof ZeroClipboard._createClient === "function") {
      ZeroClipboard._createClient.apply(this, _args(arguments));
    }
  };
  /**
 * The ZeroClipboard library's version number.
 *
 * @static
 * @readonly
 * @property {string}
 */
  _defineProperty(ZeroClipboard, "version", {
    value: "2.2.0",
    writable: false,
    configurable: true,
    enumerable: true
  });
  /**
 * Update or get a copy of the ZeroClipboard global configuration.
 * Returns a copy of the current/updated configuration.
 *
 * @returns Object
 * @static
 */
  ZeroClipboard.config = function() {
    return _config.apply(this, _args(arguments));
  };
  /**
 * Diagnostic method that describes the state of the browser, Flash Player, and ZeroClipboard.
 *
 * @returns Object
 * @static
 */
  ZeroClipboard.state = function() {
    return _state.apply(this, _args(arguments));
  };
  /**
 * Check if Flash is unusable for any reason: disabled, outdated, deactivated, etc.
 *
 * @returns Boolean
 * @static
 */
  ZeroClipboard.isFlashUnusable = function() {
    return _isFlashUnusable.apply(this, _args(arguments));
  };
  /**
 * Register an event listener.
 *
 * @returns `ZeroClipboard`
 * @static
 */
  ZeroClipboard.on = function() {
    return _on.apply(this, _args(arguments));
  };
  /**
 * Unregister an event listener.
 * If no `listener` function/object is provided, it will unregister all listeners for the provided `eventType`.
 * If no `eventType` is provided, it will unregister all listeners for every event type.
 *
 * @returns `ZeroClipboard`
 * @static
 */
  ZeroClipboard.off = function() {
    return _off.apply(this, _args(arguments));
  };
  /**
 * Retrieve event listeners for an `eventType`.
 * If no `eventType` is provided, it will retrieve all listeners for every event type.
 *
 * @returns array of listeners for the `eventType`; if no `eventType`, then a map/hash object of listeners for all event types; or `null`
 */
  ZeroClipboard.handlers = function() {
    return _listeners.apply(this, _args(arguments));
  };
  /**
 * Event emission receiver from the Flash object, forwarding to any registered JavaScript event listeners.
 *
 * @returns For the "copy" event, returns the Flash-friendly "clipData" object; otherwise `undefined`.
 * @static
 */
  ZeroClipboard.emit = function() {
    return _emit.apply(this, _args(arguments));
  };
  /**
 * Create and embed the Flash object.
 *
 * @returns The Flash object
 * @static
 */
  ZeroClipboard.create = function() {
    return _create.apply(this, _args(arguments));
  };
  /**
 * Self-destruct and clean up everything, including the embedded Flash object.
 *
 * @returns `undefined`
 * @static
 */
  ZeroClipboard.destroy = function() {
    return _destroy.apply(this, _args(arguments));
  };
  /**
 * Set the pending data for clipboard injection.
 *
 * @returns `undefined`
 * @static
 */
  ZeroClipboard.setData = function() {
    return _setData.apply(this, _args(arguments));
  };
  /**
 * Clear the pending data for clipboard injection.
 * If no `format` is provided, all pending data formats will be cleared.
 *
 * @returns `undefined`
 * @static
 */
  ZeroClipboard.clearData = function() {
    return _clearData.apply(this, _args(arguments));
  };
  /**
 * Get a copy of the pending data for clipboard injection.
 * If no `format` is provided, a copy of ALL pending data formats will be returned.
 *
 * @returns `String` or `Object`
 * @static
 */
  ZeroClipboard.getData = function() {
    return _getData.apply(this, _args(arguments));
  };
  /**
 * Sets the current HTML object that the Flash object should overlay. This will put the global
 * Flash object on top of the current element; depending on the setup, this may also set the
 * pending clipboard text data as well as the Flash object's wrapping element's title attribute
 * based on the underlying HTML element and ZeroClipboard configuration.
 *
 * @returns `undefined`
 * @static
 */
  ZeroClipboard.focus = ZeroClipboard.activate = function() {
    return _focus.apply(this, _args(arguments));
  };
  /**
 * Un-overlays the Flash object. This will put the global Flash object off-screen; depending on
 * the setup, this may also unset the Flash object's wrapping element's title attribute based on
 * the underlying HTML element and ZeroClipboard configuration.
 *
 * @returns `undefined`
 * @static
 */
  ZeroClipboard.blur = ZeroClipboard.deactivate = function() {
    return _blur.apply(this, _args(arguments));
  };
  /**
 * Returns the currently focused/"activated" HTML element that the Flash object is wrapping.
 *
 * @returns `HTMLElement` or `null`
 * @static
 */
  ZeroClipboard.activeElement = function() {
    return _activeElement.apply(this, _args(arguments));
  };
  /**
 * Keep track of the ZeroClipboard client instance counter.
 */
  var _clientIdCounter = 0;
  /**
 * Keep track of the state of the client instances.
 *
 * Entry structure:
 *   _clientMeta[client.id] = {
 *     instance: client,
 *     elements: [],
 *     handlers: {}
 *   };
 */
  var _clientMeta = {};
  /**
 * Keep track of the ZeroClipboard clipped elements counter.
 */
  var _elementIdCounter = 0;
  /**
 * Keep track of the state of the clipped element relationships to clients.
 *
 * Entry structure:
 *   _elementMeta[element.zcClippingId] = [client1.id, client2.id];
 */
  var _elementMeta = {};
  /**
 * Keep track of the state of the mouse event handlers for clipped elements.
 *
 * Entry structure:
 *   _mouseHandlers[element.zcClippingId] = {
 *     mouseover:  function(event) {},
 *     mouseout:   function(event) {},
 *     mouseenter: function(event) {},
 *     mouseleave: function(event) {},
 *     mousemove:  function(event) {}
 *   };
 */
  var _mouseHandlers = {};
  /**
 * Extending the ZeroClipboard configuration defaults for the Client module.
 */
  _extend(_globalConfig, {
    autoActivate: true
  });
  /**
 * The real constructor for `ZeroClipboard` client instances.
 * @private
 */
  var _clientConstructor = function(elements) {
    var client = this;
    client.id = "" + _clientIdCounter++;
    _clientMeta[client.id] = {
      instance: client,
      elements: [],
      handlers: {}
    };
    if (elements) {
      client.clip(elements);
    }
    ZeroClipboard.on("*", function(event) {
      return client.emit(event);
    });
    ZeroClipboard.on("destroy", function() {
      client.destroy();
    });
    ZeroClipboard.create();
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.on`.
 * @private
 */
  var _clientOn = function(eventType, listener) {
    var i, len, events, added = {}, meta = _clientMeta[this.id], handlers = meta && meta.handlers;
    if (!meta) {
      throw new Error("Attempted to add new listener(s) to a destroyed ZeroClipboard client instance");
    }
    if (typeof eventType === "string" && eventType) {
      events = eventType.toLowerCase().split(/\s+/);
    } else if (typeof eventType === "object" && eventType && typeof listener === "undefined") {
      for (i in eventType) {
        if (_hasOwn.call(eventType, i) && typeof i === "string" && i && typeof eventType[i] === "function") {
          this.on(i, eventType[i]);
        }
      }
    }
    if (events && events.length) {
      for (i = 0, len = events.length; i < len; i++) {
        eventType = events[i].replace(/^on/, "");
        added[eventType] = true;
        if (!handlers[eventType]) {
          handlers[eventType] = [];
        }
        handlers[eventType].push(listener);
      }
      if (added.ready && _flashState.ready) {
        this.emit({
          type: "ready",
          client: this
        });
      }
      if (added.error) {
        for (i = 0, len = _flashStateErrorNames.length; i < len; i++) {
          if (_flashState[_flashStateErrorNames[i].replace(/^flash-/, "")]) {
            this.emit({
              type: "error",
              name: _flashStateErrorNames[i],
              client: this
            });
            break;
          }
        }
        if (_zcSwfVersion !== undefined && ZeroClipboard.version !== _zcSwfVersion) {
          this.emit({
            type: "error",
            name: "version-mismatch",
            jsVersion: ZeroClipboard.version,
            swfVersion: _zcSwfVersion
          });
        }
      }
    }
    return this;
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.off`.
 * @private
 */
  var _clientOff = function(eventType, listener) {
    var i, len, foundIndex, events, perEventHandlers, meta = _clientMeta[this.id], handlers = meta && meta.handlers;
    if (!handlers) {
      return this;
    }
    if (arguments.length === 0) {
      events = _keys(handlers);
    } else if (typeof eventType === "string" && eventType) {
      events = eventType.split(/\s+/);
    } else if (typeof eventType === "object" && eventType && typeof listener === "undefined") {
      for (i in eventType) {
        if (_hasOwn.call(eventType, i) && typeof i === "string" && i && typeof eventType[i] === "function") {
          this.off(i, eventType[i]);
        }
      }
    }
    if (events && events.length) {
      for (i = 0, len = events.length; i < len; i++) {
        eventType = events[i].toLowerCase().replace(/^on/, "");
        perEventHandlers = handlers[eventType];
        if (perEventHandlers && perEventHandlers.length) {
          if (listener) {
            foundIndex = perEventHandlers.indexOf(listener);
            while (foundIndex !== -1) {
              perEventHandlers.splice(foundIndex, 1);
              foundIndex = perEventHandlers.indexOf(listener, foundIndex);
            }
          } else {
            perEventHandlers.length = 0;
          }
        }
      }
    }
    return this;
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.handlers`.
 * @private
 */
  var _clientListeners = function(eventType) {
    var copy = null, handlers = _clientMeta[this.id] && _clientMeta[this.id].handlers;
    if (handlers) {
      if (typeof eventType === "string" && eventType) {
        copy = handlers[eventType] ? handlers[eventType].slice(0) : [];
      } else {
        copy = _deepCopy(handlers);
      }
    }
    return copy;
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.emit`.
 * @private
 */
  var _clientEmit = function(event) {
    if (_clientShouldEmit.call(this, event)) {
      if (typeof event === "object" && event && typeof event.type === "string" && event.type) {
        event = _extend({}, event);
      }
      var eventCopy = _extend({}, _createEvent(event), {
        client: this
      });
      _clientDispatchCallbacks.call(this, eventCopy);
    }
    return this;
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.clip`.
 * @private
 */
  var _clientClip = function(elements) {
    if (!_clientMeta[this.id]) {
      throw new Error("Attempted to clip element(s) to a destroyed ZeroClipboard client instance");
    }
    elements = _prepClip(elements);
    for (var i = 0; i < elements.length; i++) {
      if (_hasOwn.call(elements, i) && elements[i] && elements[i].nodeType === 1) {
        if (!elements[i].zcClippingId) {
          elements[i].zcClippingId = "zcClippingId_" + _elementIdCounter++;
          _elementMeta[elements[i].zcClippingId] = [ this.id ];
          if (_globalConfig.autoActivate === true) {
            _addMouseHandlers(elements[i]);
          }
        } else if (_elementMeta[elements[i].zcClippingId].indexOf(this.id) === -1) {
          _elementMeta[elements[i].zcClippingId].push(this.id);
        }
        var clippedElements = _clientMeta[this.id] && _clientMeta[this.id].elements;
        if (clippedElements.indexOf(elements[i]) === -1) {
          clippedElements.push(elements[i]);
        }
      }
    }
    return this;
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.unclip`.
 * @private
 */
  var _clientUnclip = function(elements) {
    var meta = _clientMeta[this.id];
    if (!meta) {
      return this;
    }
    var clippedElements = meta.elements;
    var arrayIndex;
    if (typeof elements === "undefined") {
      elements = clippedElements.slice(0);
    } else {
      elements = _prepClip(elements);
    }
    for (var i = elements.length; i--; ) {
      if (_hasOwn.call(elements, i) && elements[i] && elements[i].nodeType === 1) {
        arrayIndex = 0;
        while ((arrayIndex = clippedElements.indexOf(elements[i], arrayIndex)) !== -1) {
          clippedElements.splice(arrayIndex, 1);
        }
        var clientIds = _elementMeta[elements[i].zcClippingId];
        if (clientIds) {
          arrayIndex = 0;
          while ((arrayIndex = clientIds.indexOf(this.id, arrayIndex)) !== -1) {
            clientIds.splice(arrayIndex, 1);
          }
          if (clientIds.length === 0) {
            if (_globalConfig.autoActivate === true) {
              _removeMouseHandlers(elements[i]);
            }
            delete elements[i].zcClippingId;
          }
        }
      }
    }
    return this;
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.elements`.
 * @private
 */
  var _clientElements = function() {
    var meta = _clientMeta[this.id];
    return meta && meta.elements ? meta.elements.slice(0) : [];
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.destroy`.
 * @private
 */
  var _clientDestroy = function() {
    if (!_clientMeta[this.id]) {
      return;
    }
    this.unclip();
    this.off();
    delete _clientMeta[this.id];
  };
  /**
 * Inspect an Event to see if the Client (`this`) should honor it for emission.
 * @private
 */
  var _clientShouldEmit = function(event) {
    if (!(event && event.type)) {
      return false;
    }
    if (event.client && event.client !== this) {
      return false;
    }
    var meta = _clientMeta[this.id];
    var clippedEls = meta && meta.elements;
    var hasClippedEls = !!clippedEls && clippedEls.length > 0;
    var goodTarget = !event.target || hasClippedEls && clippedEls.indexOf(event.target) !== -1;
    var goodRelTarget = event.relatedTarget && hasClippedEls && clippedEls.indexOf(event.relatedTarget) !== -1;
    var goodClient = event.client && event.client === this;
    if (!meta || !(goodTarget || goodRelTarget || goodClient)) {
      return false;
    }
    return true;
  };
  /**
 * Handle the actual dispatching of events to a client instance.
 *
 * @returns `undefined`
 * @private
 */
  var _clientDispatchCallbacks = function(event) {
    var meta = _clientMeta[this.id];
    if (!(typeof event === "object" && event && event.type && meta)) {
      return;
    }
    var async = _shouldPerformAsync(event);
    var wildcardTypeHandlers = meta && meta.handlers["*"] || [];
    var specificTypeHandlers = meta && meta.handlers[event.type] || [];
    var handlers = wildcardTypeHandlers.concat(specificTypeHandlers);
    if (handlers && handlers.length) {
      var i, len, func, context, eventCopy, originalContext = this;
      for (i = 0, len = handlers.length; i < len; i++) {
        func = handlers[i];
        context = originalContext;
        if (typeof func === "string" && typeof _window[func] === "function") {
          func = _window[func];
        }
        if (typeof func === "object" && func && typeof func.handleEvent === "function") {
          context = func;
          func = func.handleEvent;
        }
        if (typeof func === "function") {
          eventCopy = _extend({}, event);
          _dispatchCallback(func, context, [ eventCopy ], async);
        }
      }
    }
  };
  /**
 * Prepares the elements for clipping/unclipping.
 *
 * @returns An Array of elements.
 * @private
 */
  var _prepClip = function(elements) {
    if (typeof elements === "string") {
      elements = [];
    }
    return typeof elements.length !== "number" ? [ elements ] : elements;
  };
  /**
 * Add a `mouseover` handler function for a clipped element.
 *
 * @returns `undefined`
 * @private
 */
  var _addMouseHandlers = function(element) {
    if (!(element && element.nodeType === 1)) {
      return;
    }
    var _suppressMouseEvents = function(event) {
      if (!(event || (event = _window.event))) {
        return;
      }
      if (event._source !== "js") {
        event.stopImmediatePropagation();
        event.preventDefault();
      }
      delete event._source;
    };
    var _elementMouseOver = function(event) {
      if (!(event || (event = _window.event))) {
        return;
      }
      _suppressMouseEvents(event);
      ZeroClipboard.focus(element);
    };
    element.addEventListener("mouseover", _elementMouseOver, false);
    element.addEventListener("mouseout", _suppressMouseEvents, false);
    element.addEventListener("mouseenter", _suppressMouseEvents, false);
    element.addEventListener("mouseleave", _suppressMouseEvents, false);
    element.addEventListener("mousemove", _suppressMouseEvents, false);
    _mouseHandlers[element.zcClippingId] = {
      mouseover: _elementMouseOver,
      mouseout: _suppressMouseEvents,
      mouseenter: _suppressMouseEvents,
      mouseleave: _suppressMouseEvents,
      mousemove: _suppressMouseEvents
    };
  };
  /**
 * Remove a `mouseover` handler function for a clipped element.
 *
 * @returns `undefined`
 * @private
 */
  var _removeMouseHandlers = function(element) {
    if (!(element && element.nodeType === 1)) {
      return;
    }
    var mouseHandlers = _mouseHandlers[element.zcClippingId];
    if (!(typeof mouseHandlers === "object" && mouseHandlers)) {
      return;
    }
    var key, val, mouseEvents = [ "move", "leave", "enter", "out", "over" ];
    for (var i = 0, len = mouseEvents.length; i < len; i++) {
      key = "mouse" + mouseEvents[i];
      val = mouseHandlers[key];
      if (typeof val === "function") {
        element.removeEventListener(key, val, false);
      }
    }
    delete _mouseHandlers[element.zcClippingId];
  };
  /**
 * Creates a new ZeroClipboard client instance.
 * Optionally, auto-`clip` an element or collection of elements.
 *
 * @constructor
 */
  ZeroClipboard._createClient = function() {
    _clientConstructor.apply(this, _args(arguments));
  };
  /**
 * Register an event listener to the client.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.on = function() {
    return _clientOn.apply(this, _args(arguments));
  };
  /**
 * Unregister an event handler from the client.
 * If no `listener` function/object is provided, it will unregister all handlers for the provided `eventType`.
 * If no `eventType` is provided, it will unregister all handlers for every event type.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.off = function() {
    return _clientOff.apply(this, _args(arguments));
  };
  /**
 * Retrieve event listeners for an `eventType` from the client.
 * If no `eventType` is provided, it will retrieve all listeners for every event type.
 *
 * @returns array of listeners for the `eventType`; if no `eventType`, then a map/hash object of listeners for all event types; or `null`
 */
  ZeroClipboard.prototype.handlers = function() {
    return _clientListeners.apply(this, _args(arguments));
  };
  /**
 * Event emission receiver from the Flash object for this client's registered JavaScript event listeners.
 *
 * @returns For the "copy" event, returns the Flash-friendly "clipData" object; otherwise `undefined`.
 */
  ZeroClipboard.prototype.emit = function() {
    return _clientEmit.apply(this, _args(arguments));
  };
  /**
 * Register clipboard actions for new element(s) to the client.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.clip = function() {
    return _clientClip.apply(this, _args(arguments));
  };
  /**
 * Unregister the clipboard actions of previously registered element(s) on the page.
 * If no elements are provided, ALL registered elements will be unregistered.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.unclip = function() {
    return _clientUnclip.apply(this, _args(arguments));
  };
  /**
 * Get all of the elements to which this client is clipped.
 *
 * @returns array of clipped elements
 */
  ZeroClipboard.prototype.elements = function() {
    return _clientElements.apply(this, _args(arguments));
  };
  /**
 * Self-destruct and clean up everything for a single client.
 * This will NOT destroy the embedded Flash object.
 *
 * @returns `undefined`
 */
  ZeroClipboard.prototype.destroy = function() {
    return _clientDestroy.apply(this, _args(arguments));
  };
  /**
 * Stores the pending plain text to inject into the clipboard.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.setText = function(text) {
    if (!_clientMeta[this.id]) {
      throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");
    }
    ZeroClipboard.setData("text/plain", text);
    return this;
  };
  /**
 * Stores the pending HTML text to inject into the clipboard.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.setHtml = function(html) {
    if (!_clientMeta[this.id]) {
      throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");
    }
    ZeroClipboard.setData("text/html", html);
    return this;
  };
  /**
 * Stores the pending rich text (RTF) to inject into the clipboard.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.setRichText = function(richText) {
    if (!_clientMeta[this.id]) {
      throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");
    }
    ZeroClipboard.setData("application/rtf", richText);
    return this;
  };
  /**
 * Stores the pending data to inject into the clipboard.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.setData = function() {
    if (!_clientMeta[this.id]) {
      throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");
    }
    ZeroClipboard.setData.apply(this, _args(arguments));
    return this;
  };
  /**
 * Clears the pending data to inject into the clipboard.
 * If no `format` is provided, all pending data formats will be cleared.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.clearData = function() {
    if (!_clientMeta[this.id]) {
      throw new Error("Attempted to clear pending clipboard data from a destroyed ZeroClipboard client instance");
    }
    ZeroClipboard.clearData.apply(this, _args(arguments));
    return this;
  };
  /**
 * Gets a copy of the pending data to inject into the clipboard.
 * If no `format` is provided, a copy of ALL pending data formats will be returned.
 *
 * @returns `String` or `Object`
 */
  ZeroClipboard.prototype.getData = function() {
    if (!_clientMeta[this.id]) {
      throw new Error("Attempted to get pending clipboard data from a destroyed ZeroClipboard client instance");
    }
    return ZeroClipboard.getData.apply(this, _args(arguments));
  };
  if (typeof define === "function" && define.amd) {
    define(function() {
      return ZeroClipboard;
    });
  } else if (typeof module === "object" && module && typeof module.exports === "object" && module.exports) {
    module.exports = ZeroClipboard;
  } else {
    window.ZeroClipboard = ZeroClipboard;
  }
})(function() {
  return this || window;
}());
},{}],6:[function(require,module,exports){
/*jslint browser: true*/
/*jshint -W055 */
/*global console, alert*/

/*
 * For each disease area there will be 4 stages: Diagnosis, Monitoring, Treatment and Exclusions.
 * Each stage gets a single panel on the front screen.
 * Clicking on a panel takes you to a screen specific to that stage, but similar in layout and content
 *  to all the others.
 */

var template = require('./src/template.js'),
  main = require('./src/main.js');

//TODO not sure why i did this - was in local variable
//maybe a separate module
//window.location = window.history.location || window.location;
/********************************************************
 *** Shows the pre-load image and slowly fades it out. ***
 ********************************************************/
$(window).load(function() {
  $('.loading-container').fadeOut(1000, function() {
    //$(this).remove();
  });
});

/******************************************
 *** This happens when the page is ready ***
 ******************************************/
$(document).on('ready', function() {
  //Grab the hash if exists - IE seems to forget it
  main.hash = location.hash;
  //Load the data then wire up the events on the page
  main.init();

  //Sorts out the data held locally in the user's browser
  if (!localStorage.bb) localStorage.bb = JSON.stringify({});
  var obj = JSON.parse(localStorage.bb);
  if (!obj.version || obj.version !== main.version) {
    localStorage.bb = JSON.stringify({
      "version": main.version
    });
  }

  $('[data-toggle="tooltip"]').tooltip({
    container: 'body',
    delay: {
      "show": 500,
      "hide": 100
    },
    html: true
  });
  $('[data-toggle="lone-tooltip"]').tooltip({
    container: 'body',
    delay: {
      "show": 300,
      "hide": 100
    }
  });
  $('[data-toggle="lone-tooltip"]').on('shown.bs.tooltip', function(e) {
    $('[data-toggle="tooltip"]').not(this).tooltip('hide');
  });

  //ensure on first load the login screen is cached to the history
  history.pushState(null, null, '');
});

},{"./src/main.js":13,"./src/template.js":33}],7:[function(require,module,exports){
var data = require('./data.js'),
  lookup = require('./lookup.js'),
  chart = require('./chart.js'),
  log = require('./log.js'),
  Mustache = require('mustache'),
  ZeroClipboard = require('zeroclipboard');

var base = {

  //object for keeping track what is in each panel to prevent unnecessary redraws
  panels: {},

  selectTab: function(id) {
    var href = $('#mainTab li.active a').data("href");
    $('#mainTab li.active').removeClass('active').find('a').attr("href", href);
    $('#mainTab li[data-id="' + id + '"]').addClass('active').find('a').removeAttr("href");
  },

  createPanel: function(templateSelector, data, templates) {
    var tempMust = templateSelector.html();
    Mustache.parse(tempMust); // optional, speeds up future uses
    if (templates) {
      for (var o in templates) {
        if (templates.hasOwnProperty(o)) {
          Mustache.parse(templates[o]);
        }
      }
    }
    var rendered = Mustache.render(tempMust, data, templates);
    return rendered;
  },

  createPanelShow: function(templateSelector, panelSelector, data, templates) {
    var rendered = base.createPanel(templateSelector, data, templates);
    panelSelector.html(rendered).show();
  },

  showPathwayStageOverviewPanel: function(location, enableHover, pathwayId, pathwayStage) {
    var standards = [];
    for (var standard in data[pathwayId][pathwayStage].standards) {
      var denom = data.getDenominatorForStandard(pathwayId, pathwayStage);
      var num = denom - data.getNumeratorForStandard(pathwayId, pathwayStage, standard);
      standards.push({
        "standard": data[pathwayId][pathwayStage].standards[standard].tab.title,
        "standardKey": standard,
        "tooltip": data[pathwayId][pathwayStage].standards[standard]["standard-met-tooltip"],
        "numerator": num,
        "denominator": denom,
        "percentage": (num * 100 / denom).toFixed(0)
      });
    }

    base.createPanelShow($('#pathway-stage-overview-panel'), location, {
      pathway: data.pathwayNames[pathwayId],
      pathwayStage: pathwayStage,
      pathwayStageName: lookup.categories[pathwayStage].display,
      pathwayNameShort: pathwayId,
      title: data[pathwayId][pathwayStage].text.panel.text,
      standards: standards
    }, {
      "row": $('#overview-panel-table-row').html()
    });

    $('#' + pathwayStage + '-trend-toggle').on('click', function(e) {
      if ($(this).text() === "Trend") {
        $(this).text("Table");
        $('#' + pathwayStage + '-chart-table').hide();
        $('#' + pathwayStage + '-chart-wrapper').show();
      } else {
        $(this).text("Trend");
        $('#' + pathwayStage + '-chart-table').show();
        $('#' + pathwayStage + '-chart-wrapper').hide();
      }
      e.stopPropagation();
    });

    chart.drawOverviewChart(pathwayId, pathwayStage, enableHover);

  },

  hideFooter: function() {
    $('footer').hide();
  },

  showFooter: function() {
    $('footer').show();
  },

  hideTooltips: function() {
    $('[data-toggle="tooltip"]').tooltip('hide');
  },

  wireUpTooltips: function() {
    $('[data-toggle="tooltip"]').tooltip('hide');
    $('.tooltip').remove();

    $('[data-toggle="tooltip"]').tooltip({
      container: 'body',
      delay: {
        "show": 500,
        "hide": 100
      },
      html: true
    });
    $('[data-toggle="lone-tooltip"]').tooltip({
      container: 'body',
      delay: {
        "show": 300,
        "hide": 100
      }
    });
    $('[data-toggle="lone-tooltip"]').on('shown.bs.tooltip', function(e) {
      $('[data-toggle="tooltip"]').not(this).tooltip('hide');
    });
    $('.patient-row-tooltip').on('show.bs.tooltip', function(e) {
      if ($(this).hasClass('highlighted')) {
        e.stopPropagation();
        e.preventDefault();
      }
    });
  },

  setupClipboard: function(selector, destroy) {
    if (destroy) ZeroClipboard.destroy(); //tidy up

    var client = new ZeroClipboard(selector);

    client.on('ready', function() {
      client.on('aftercopy', function(event) {
        console.log('Copied text to clipboard: ' + event.data['text/plain']);
        $(event.target).tooltip('hide');
        $(event.target).popover({
          trigger: 'manual',
          template: '<div class="popover" role="tooltip"><div class="arrow"></div><div class="popover-content"></div></div>',
          delay: {
            show: 500,
            hide: 500
          }
        });
        clearTimeout(lookup.tmp);
        $(event.target).popover('show');
        lookup.tmp = setTimeout(function() {
          $(event.target).popover('hide');
        }, 600);
      });
    });
  },

  clearBox: function() {
    //Clear the patient search box
    $('.typeahead').typeahead('val', '');
  },

  /********************************
   * Modals
   ********************************/

  launchModal: function(data, label, value, reasonText, callbackOnSave, callbackOnCancel, callbackOnUndo) {
    var template = $('#modal-why').html();
    Mustache.parse(template); // optional, speeds up future uses

    var reasonTemplate = $('#modal-why-item').html();
    Mustache.parse(reasonTemplate);

    if (data.reasons && data.reasons.length > 0) data.hasReasons = true;

    var rendered = Mustache.render(template, data, {
      "item": reasonTemplate
    });
    $('#modal').html(rendered);

    if (reasonText) {
      $('#modal textarea').val(reasonText);
    }
    lookup.modalSaved = false;
    lookup.modalUndo = false;

    $('#modal .modal').off('click', '.undo-plan').on('click', '.undo-plan', function(e) {
      lookup.modalUndo = true;
    }).off('submit', 'form').on('submit', 'form', {
      "label": label
    }, function(e) {
      if (!e.data.label) e.data.label = "team";
      var reason = $('input:radio[name=reason]:checked').val();
      var reasonText = $('#modal textarea').val();

      log.recordFeedback(data.pathwayId, e.data.label, value, reason, reasonText);

      lookup.modalSaved = true;

      e.preventDefault();
      $('#modal .modal').modal('hide');
    }).modal();

    $('#modal').off('hidden.bs.modal').on('hidden.bs.modal', {
      "label": label
    }, function(e) {
      if (lookup.modalSaved) {
        lookup.modalSaved = false;
        if (callbackOnSave) callbackOnSave();
      } else if (lookup.modalUndo) {
        lookup.modalUndo = false;
        if (callbackOnUndo) callbackOnUndo();
      } else {
        //uncheck as cancelled. - but not if value is empty as this unchecks everything - or if already checked
        if (callbackOnCancel) callbackOnCancel();
      }
    });
  },

  sortSuggestions: function(suggestions) {
    suggestions.sort(function(a, b) {
      if (a.agree && !a.done) {
        if (b.agree && !b.done) return 0;
        return -1;
      } else if (!a.agree && !a.disagree) {
        if (!b.agree && !b.disagree) return 0;
        if (b.agree && !b.done) return 1;
        return -1;
      } else if (a.agree && a.done) {
        if (b.agree && b.done) return 0;
        if (b.disagree) return -1;
        return 1;
      } else {
        if (b.disagree) return 0;
        return 1;
      }
    });

    return suggestions;
  },

  addDisagreePersonalTeam: function(plans) {
    for (var i = 0; i < plans.length; i++) {
      if (plans[i].agree) {
        plans[i].disagree = false;
      } else if (plans[i].agree === false) {
        plans[i].disagree = true;
      }
    }
    return plans;
  },

  suggestionList: function(ids) {
    return ids.map(function(val) {
      return {
        "id": val.id || val,
        "text": log.text[val.id || val].text,
        "subsection": val.subsection
      };
    }).filter(function(v, i) { //RW to always limit to 3
      return i < 3;
    });
  },

  mergeIndividualStuff: function(suggestions, patientId) {
    var localActions = log.listActions();
    if (!localActions[patientId]) return suggestions;

    for (var i = 0; i < suggestions.length; i++) {
      if (localActions[patientId][suggestions[i].id]) {
        if (localActions[patientId][suggestions[i].id].agree) {
          suggestions[i].agree = true;
        } else if (localActions[patientId][suggestions[i].id].agree === false) {
          suggestions[i].disagree = true;
        }
        if (localActions[patientId][suggestions[i].id].done) suggestions[i].done = localActions[patientId][suggestions[i].id].done;
      }
    }
    return suggestions;
  },

  switchTo110Layout: function() {
    if (base.layout === "110") return;
    base.layout = "110";
    farLeftPanel.removeClass('col-lg-3 col-lg-8').addClass('col-lg-6').show();
    topPanel.hide();
    topLeftPanel.hide();
    bottomLeftPanel.hide();
    topRightPanel.hide();
    bottomRightPanel.hide();
    midPanel.hide();
    farRightPanel.removeClass('col-xl-4').addClass('col-xl-8').show();
  },

  switchTo101Layout: function() {
    if (base.layout === "101") return;
    base.layout = "101";
    farLeftPanel.removeClass('col-lg-3 col-lg-6 col-xl-4').addClass('col-lg-8').show();
    topPanel.hide();
    topLeftPanel.hide();
    bottomLeftPanel.hide();
    topRightPanel.hide();
    bottomRightPanel.hide();
    midPanel.hide();
    farRightPanel.removeClass('col-xl-8').addClass('col-xl-4').show();
  },



  switchTo221Layout: function() {
    if (base.layout === "221") return;
    base.layout = "221";
    farLeftPanel.hide();
    topPanel.hide();
    topLeftPanel.addClass('col-xl-6').show();
    bottomLeftPanel.addClass('col-xl-6').show();
    topRightPanel.removeClass('col-xl-12').addClass('col-xl-6').show();
    bottomRightPanel.removeClass('col-xl-12').addClass('col-xl-6').show();
    midPanel.removeClass('col-xl-4').addClass('col-xl-8').show();
    farRightPanel.removeClass('col-xl-8').addClass('col-xl-4').show();
  },

  switchTo21Layout: function() {
    if (base.layout === "21") return;
    base.layout = "21";
    farLeftPanel.hide();
    topPanel.hide();
    topLeftPanel.hide();
    bottomLeftPanel.hide();
    topRightPanel.removeClass('col-xl-6').addClass('col-xl-12').show();
    bottomRightPanel.removeClass('col-xl-6').addClass('col-xl-12').show();
    midPanel.removeClass('col-xl-4').addClass('col-xl-8').show();
    farRightPanel.removeClass('col-xl-8').addClass('col-xl-4').show();
  },

  wireUpStandardDropDown: function(pathwayId, pathwayStage, standard, callback) {
    var breaches = data.options.filter(function(val) {
      return val.pathwayId === pathwayId && val.pathwayStage === pathwayStage && val.standard === standard;
    });

    if (breaches.length > 0) $('select').val(breaches[0].value);

    $('select').select2({
      templateResult: base.formatStandard,
      minimumResultsForSearch: Infinity
    });
    $('span.select2-selection__rendered').attr("title", "");
    $('select').on('change', function() {
      var localData = $(this).find(':selected').data();
      callback(localData.pathwayId, localData.pathwayStage, localData.standard, data.patientId);
    }).on("select2:open", function(e) {
      base.wireUpTooltips();
    });
  },

  formatStandard: function(standard) {
    if (!standard.id) {
      return standard.text;
    }
    var localData = $(standard.element).data();
    // Not relevant
    var standardHtml = '';
    //if diagnosis opportunity then not relevant for other stages
    //if no mention anywhere then not relevant for that disease
    switch (data.getPatientStatus(data.patientId, localData.pathwayId, localData.pathwayStage, localData.standard)) {
      case "ok":
        standardHtml = '<span class="standard-achieved" data-toggle="tooltip" data-placement="left" title="' + data[localData.pathwayId][localData.pathwayStage].standards[localData.standard]["dropdown-tooltip"] + ' - QUALITY INDICATOR ACHIEVED">' + standard.text + ' <i class="fa fa-smile-o" style="color:green"></i></span>';
        break;
      case "missed":
        standardHtml = '<span class="standard-missed" data-toggle="tooltip" data-placement="left" title="' + data[localData.pathwayId][localData.pathwayStage].standards[localData.standard]["dropdown-tooltip"] + ' - IMPROVEMENT OPPORTUNITY EXISTS FOR THIS PATIENT">' + standard.text + ' <i class="fa fa-flag" style="color:red"></i></span>';
        break;
      case "not":
        standardHtml = '<span class="standard-not-relevant" data-toggle="tooltip" data-placement="left" title="' + data[localData.pathwayId][localData.pathwayStage].standards[localData.standard]["dropdown-tooltip"] + ' - STANDARD NOT RELEVANT TO THIS PATIENT">' + standard.text + ' <i class="fa fa-meh-o" style="color:gray"></i></span>';
        break;
    }
    var $standard = $(standardHtml);
    return $standard;
  },

  updateTitle: function(title, tooltip) {
    var titles = title;
    if (typeof title === "string") {
      titles = [{
        title: title,
        tooltip: tooltip
      }];
    }
    var content = titles.map(function(t, idx) {
      return idx === titles.length - 1 ? '<span title="' + t.tooltip + '">' + t.title + '</span>' : '<a href="' + t.url + '" title="' + t.tooltip + '">' + t.title + '</a>';
    }).join(" > ");

    $('.pagetitle').html(content);
  },

  hideAllPanels: function() {
    topLeftPanel.hide();
    bottomLeftPanel.hide();
    topRightPanel.hide();
    bottomRightPanel.hide();
    farLeftPanel.hide();
    farRightPanel.hide();
    topPanel.hide();
  },

  hidePanels: function(panel) {
    panel.children().hide();
  },

  updateTab: function(tab, value, url) {
    var tabElement = $('#mainTab a[data-href="#' + tab + '"]');
    tabElement.html(tabElement.text().split(":")[0] + ":<br><span><strong>" + value + "</strong></span>");
    tabElement.data("href", "#" + tab + "/" + url);
  },

  addFullPage: function(panel) {
    panel.fullpage({ verticalCentered: true, paddingBottom: '80px', scrollBar: true });

    $('.fp-down').off('click').on('click', function() {
      $.fn.fullpage.moveSectionDown();
    });

    $('.fp-up').off('click').on('click', function() {
      $.fn.fullpage.moveSectionUp();
    });
  },

  removeFullPage: function(panel) {
    if (panel.children('.section').length === 0) return;
    if ($.fn.fullpage && $.fn.fullpage.destroy) $.fn.fullpage.destroy('all'); //tidy up before doing it again
  }

};

module.exports = base;

},{"./chart.js":8,"./data.js":9,"./log.js":11,"./lookup.js":12,"mustache":4,"zeroclipboard":5}],8:[function(require,module,exports){
var Highcharts = require('highcharts/highstock'),
  data = require('./data.js'),
  lookup = require('./lookup.js'),
  log = require('./log.js'),
  Mustache = require('mustache');

console.log("chart.js: data.lastloader= " + data.lastloader);
data.lastloader = "chart.js";

var cht = {

  destroyCharts: function(charts) {
    for (var i = 0; i < charts.length; i++) {
      if (lookup.charts[charts[i]]) {
        lookup.charts[charts[i]].destroy();
        delete lookup.charts[charts[i]];
      }
    }
  },

  drawTrendChart: function(patientId, pathwayId, pathwayStage, standard) {
    var i, j;
    cht.destroyCharts(['chart-demo-trend']);
    if (!data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[0]]) {
      $('#chart-demo-trend').html('No data for this patients');
      $('#chart-demo-trend').parent().find('.table-chart-toggle').hide();
      return;
    }

    var chartData = data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[0]];
    var tableData = [];
    for (i = 1; i < data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[0]][0].length; i++) {
      tableData.push({
        "item": data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[0]][1][0],
        "value": data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[0]][1][i],
        "date": data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[0]][0][i]
      });
    }
    for (i = 1; i < data[pathwayId][pathwayStage].standards[standard].chart.length; i++) {
      chartData.push(data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[i]][1]); //RW TODO assumption here that all dates are the same
      for (j = 1; j < data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[0]][0].length; j++) {
        tableData.push({
          "item": data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[i]][1][0],
          "value": data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[i]][1][j],
          "date": data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[0]][0][j]
        });
      }
    }
    var chartOptions = {
      bindto: '#chart-demo-trend',
      data: {
        xs: {},
        classes: {},
        columns: chartData.slice()
      },
      zoom: {
        enabled: true
      },
      line: {
        connectNull: false
      },
      axis: {
        x: {
          type: 'timeseries',
          tick: {
            fit: false,
            format: '%d-%m-%Y',
            count: 5
          },
          max: new Date()
        },
        y: {
          label: {
            text: data[pathwayId][pathwayStage].standards[standard].chartUnits,
            position: 'outer-middle'
          }
        }
      }
    };

    var maxValue = 0;
    var standardItems = [];

    for (i = 1; i < chartOptions.data.columns.length; i++) {
      chartOptions.data.xs[chartOptions.data.columns[i][0]] = "x";
      standardItems.push(chartOptions.data.columns[i][0]);

      for (j = 1; j < chartOptions.data.columns[i].length; j++) {
        if (parseFloat(chartOptions.data.columns[i][j]) > maxValue) maxValue = parseFloat(chartOptions.data.columns[i][j]);
      }
    }

    chartOptions.tooltip = {
      format: {
        value: function(value, ratio, id) {
          var text = standardItems.indexOf(id) > -1 ? value : "";
          return text;
        }
      }
    };

    var lines = null;
    var axisnum = 1;
    if (data.patients[patientId].contacts) {
      for (i = 0; i < data.patients[patientId].contacts.length; i++) {
        chartOptions.data.classes[data.patients[patientId].contacts[i].text] = 'larger';
        if (!chartOptions.data.xs[data.patients[patientId].contacts[i].text]) {
          chartOptions.data.xs[data.patients[patientId].contacts[i].text] = "x" + axisnum;
          chartOptions.data.columns.push(["x" + axisnum, data.patients[patientId].contacts[i].value]);
          chartOptions.data.columns.push([data.patients[patientId].contacts[i].text, (maxValue * 1.1).toString()]);
          axisnum++;
        } else {
          var axis = chartOptions.data.xs[data.patients[patientId].contacts[i].text];
          for (j = 1; j < chartOptions.data.columns.length; j++) {
            if (chartOptions.data.columns[j][0] === axis) {
              chartOptions.data.columns[j].push(data.patients[patientId].contacts[i].value);
            } else if (chartOptions.data.columns[j][0] === data.patients[patientId].contacts[i].text) {
              chartOptions.data.columns[j].push((maxValue * 1.1).toString());
            }
          }
        }
        tableData.push({
          "item": "Event",
          "value": data.patients[patientId].contacts[i].text,
          "date": data.patients[patientId].contacts[i].value
        });
      }
    }

    var patientEvents = log.getEvents().filter(function(val) {
      return val.id === patientId;
    });
    if (patientEvents.length > 0) {

      for (i = 0; i < patientEvents.length; i++) {
        chartOptions.data.classes[patientEvents[i].name] = 'larger';
        if (!chartOptions.data.xs[patientEvents[i].name]) {
          chartOptions.data.xs[patientEvents[i].name] = "x" + axisnum;
          chartOptions.data.columns.push(["x" + axisnum, patientEvents[i].date.substr(0, 10)]);
          chartOptions.data.columns.push([patientEvents[i].name, (maxValue * 1.1).toString()]);
          axisnum++;
        } else {
          var axis2 = chartOptions.data.xs[patientEvents[i].name];
          for (j = 1; j < chartOptions.data.columns.length; j++) {
            if (chartOptions.data.columns[j][0] === axis2) {
              chartOptions.data.columns[j].push(patientEvents[i].date.substr(0, 10));
            } else if (chartOptions.data.columns[j][0] === patientEvents[i].name) {
              chartOptions.data.columns[j].push((maxValue * 1.1).toString());
            }
          }
        }
        tableData.push({
          "item": "Event",
          "value": patientEvents[i].name,
          "date": patientEvents[i].date.substr(0, 10)
        });
      }
    }

    tableData.sort(function(a, b) {
      if (a.date === b.date) return 0;
      else return a.date < b.date ? 1 : -1;
    });
    //draw Table
    $('#table-demo-trend').html(Mustache.render($('#value-trend-panel-table').html(), {
      "items": tableData
    }, {
      "item-row": $('#value-trend-panel-table-row').html()
    }));

    //draw charts in separate thread and with delay to stop sluggish appearance
    setTimeout(function() {
      lookup.charts['chart-demo-trend'] = c3.generate(chartOptions);
    }, 1);
  },

  selectPieSlice: function(chart, d) {
    lookup.chartClicked = true;
    $('#' + chart + ' path.c3-bar').attr('class', function(index, classNames) {
      return classNames + ' _unselected_';
    });
    lookup.charts[chart].select([d.id], [d.index], true);

    farRightPanel.fadeOut(200, function() {
      var template = $('#patient-panel-placeholder').html();
      farRightPanel.html(Mustache.render(template)).show();
    });
  },

  drawOverviewChart: function(pathwayId, pathwayStage, enableHover) {
    cht.destroyCharts([pathwayStage + '-chart']);
    setTimeout(function() {
      lookup.charts[pathwayStage + '-chart'] = c3.generate({
        bindto: '#' + pathwayStage + '-chart',
        data: {
          x: 'x',
          columns: data[pathwayId][pathwayStage].trend
        },
        zoom: {
          enabled: true
        },
        tooltip: {
          format: {
            title: function(x) {
              return x.toDateString() + (enableHover ? '<br>Click for more detail' : '');
            },
            value: function(value) {
              return enableHover ? value + '%' : undefined;
            }
          }
        },
        axis: {
          x: {
            type: 'timeseries',
            tick: {
              format: '%d-%m-%Y',
              count: 7,
              culling: {
                max: 4
              }
            },
            label: {
              text: 'Date',
              position: 'outer-center'
            }
          },
          y: {
            min: 0,
            label: {
              text: 'Proportion (%)',
              position: 'outer-middle'
            }
          }
        },
        point: {
          show: false
        },
        size: {
          height: null
        }
      });
    }, 1);
  },

  drawBenchmarkChart: function(element, data) {
    cht.destroyCharts([element + '-chart']);
    setTimeout(function() {
      lookup.charts[element + '-chart'] = c3.generate({
        bindto: '#' + element,
        size: {
          height: 200
        },
        data: data,
        axis: {
          x: {
            type: 'category',
            tick: {
              rotate: 60,
              multiline: false
            }
          },
          y: {
            label: {
              text: '% of patients meeting the target',
              position: 'outer-middle'
            }
          }
        },
        grid: {
          y: {
            show: true
          }
        }
      });
    }, 1);
  },

  drawPerformanceTrendChart: function(element, data) {
    cht.destroyCharts([element + '-chart']);
    setTimeout(function() {
      lookup.charts[element + '-chart'] = c3.generate({
        bindto: '#' + element,
        size: {
          height: 200
        },
        data: data,
        axis: {
          x: {
            type: 'timeseries',
            tick: {
              format: '%Y-%m-%d',
              rotate: 60,
              multiline: false
            },
            height: 60
          },
          y: {
            label: {
              text: "Performance",
              position: 'outer-middle'
            }
          }
        },
        grid: {
          x: {
            show: true
          },
          y: {
            show: true
          }
        }
      });
    }, 1);
  },

  drawBenchmarkChartHC: function(element, data) {

    data = [
      { x: 49.9, p: 'P1', local: true },
      { x: 71.5, p: 'P2', local: true },
      { x: 16.4, p: 'P3', local: true },
      { x: 29.2, p: 'P4', local: true },
      { x: 44.0, p: 'P5', local: true },
      { x: 76.0, p: 'P6', local: true },
      { x: 35.6, p: 'YOU', local: true },
      { x: 48.5, p: 'P7', local: true },
      { x: 26.4, p: 'P8', local: true },
      { x: 94.1, p: 'P9', local: true },
      { x: 95.6, p: 'P10' },
      { x: 54.0, p: 'P11' },
      { x: 39.9, p: 'P12' },
      { x: 61.5, p: 'P13' },
      { x: 6.4, p: 'P14' },
      { x: 19.2, p: 'P15' },
      { x: 34.0, p: 'P16' },
      { x: 66.0, p: 'P17' },
      { x: 25.6, p: 'P18' },
      { x: 38.5, p: 'P19' },
      { x: 36.4, p: 'P20' },
      { x: 84.1, p: 'P21' },
      { x: 85.6, p: 'P22' },
      { x: 64.0, p: 'P23' }
    ];
    data.sort(function(a, b) {
      return a.x - b.x;
    });

    var local = true;
    var bChart = $('#' + element).highcharts({
      chart: {
        type: 'column',
        events: {
          load: function() {
            var thisChart = this;
            thisChart.renderer.button('Toggle neighbourhood / CCG', thisChart.plotWidth - 100, 0, function() {
              local = !local;
              thisChart.xAxis[0].categories = data.filter(function(v) {
                if (local) return v.local;
                else return true;
              }).map(function(v) {
                return v.p;
              });
              thisChart.series[0].setData(data.filter(function(v) {
                if (local) return v.local;
                else return true;
              }).map(function(v) {
                if (v.p === "YOU") return { y: v.x, color: "red" };
                else return v.x;
              }));
            }).add();
          }
        }
      },
      title: { text: 'Benchmark' },
      xAxis: {
        categories: data.filter(function(v) {
          return v.local === local;
        }).map(function(v) {
          return v.p;
        }),
        crosshair: true
      },
      yAxis: {
        min: 0,
        max: 100,
        title: { text: '% patients meeting target' }
      },
      tooltip: {
        headerFormat: '<span style="font-size:10px">Practice: <b>{point.key}</b></span><table>',
        pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
          '<td style="padding:0"><b>{point.y:.1f}%</b></td></tr>',
        footerFormat: '</table>',
        shared: true,
        useHTML: true
      },
      plotOptions: {
        column: {
          pointPadding: 0.2,
          borderWidth: 0
        }
      },
      legend: {
        enabled: false
      },
      series: [{
        name: 'Performance',
        data: data.filter(function(v) {
          return v.local === local;
        }).map(function(v) {
          if (v.p === "YOU") return { y: v.x, color: "red" };
          else return v.x;
        })
      }]
    });
  },

  drawPerformanceTrendChartHC: function(element, data) {

    /// data is
    // {
    //  "values":
    //    ["x", "2015-08-24", "2015-08-23",...
    //    ["numerator", 35, 37, 33, 32, 31,...
    //    ["denominator", 135, 133, 133, 13,...
    //    ["target", 0.3, 0.3, 0...
    // }

    var target = 0.75,
      maxValue = target,
      maxXvalue = 0;

    var series = [
      { type: 'line', name: 'Trend', data: [] },
      { type: 'line', name: 'Prediction', data: [], dashStyle: 'dot' }
    ];

    var today = new Date();
    var lastApril = new Date();
    var aprilBeforeThat = new Date();
    var nextApril = new Date();
    if (today.getMonth() < 3) {
      //after april
      lastApril.setYear(today.getFullYear() - 1);
      aprilBeforeThat.setYear(today.getFullYear() - 1);
    } else {
      nextApril.setYear(today.getFullYear() + 1);
    }
    aprilBeforeThat.setYear(aprilBeforeThat.getFullYear() - 1);
    lastApril.setMonth(3);
    aprilBeforeThat.setMonth(3);
    nextApril.setMonth(3);
    lastApril.setDate(1);
    aprilBeforeThat.setDate(1);
    nextApril.setDate(1);

    var n = 0,
      sumX = 0,
      sumY = 0,
      sumXY = 0,
      sumXX = 0,
      sumYY = 0,
      intercept, gradient, compDate;

    if (data.values[0].filter(function(v) {
        return new Date(v).getTime() > lastApril.getTime();
      }).length > 2) compDate = new Date(lastApril.getTime());
    else compDate = new Date(aprilBeforeThat.getTime());

    data.values[0].forEach(function(v, i) {
      if (i === 0) return;
      var time = new Date(v).getTime();
      var y = +data.values[1][i] / +data.values[2][i];
      if (time >= compDate.getTime()) {
        n++;
        sumX += time;
        sumY += y;
        sumXY += time * y;
        sumXX += time * time;
        sumYY += y * y;
      }
      series[0].data.push([time, y]);
      maxValue = Math.max(maxValue, y);
      maxXvalue = Math.max(maxXvalue, time);
    });

    intercept = (sumY * sumXX - sumX * sumXY) / (n * sumXX - sumX * sumX);
    gradient = (n * sumXY - sumX * sumY) / (n * sumXX - sumX * sumX);

    series[1].data.push([maxXvalue, maxXvalue * gradient + intercept]);
    for (var i = 0; i < 13; i++) {
      var x = compDate.getTime();
      if(x<maxXvalue) {
        compDate.setMonth(compDate.getMonth() + 1);
        continue;
      }
      series[1].data.push([x, x * gradient + intercept]);
      var m = compDate.getMonth();
      compDate.setMonth(compDate.getMonth() + 1);
    }

    //Add line of best fit for latest data since april to next april


    //Default to last april - april


    var c = $('#' + element).highcharts({
      title: { text: '' },
      xAxis: {
        max: nextApril.getTime(),
        type: 'datetime'
      },
      yAxis: {
        title: { text: 'Quality standard performance' },
        max: maxValue+0.05,
        min: 0,
        plotLines: [{
          value: target,
          color: 'green',
          dashStyle: 'shortdash',
          width: 2,
          label: {
            text: 'Target - ' + (target*100) + '%'
          },
        }]
      },
      legend: { enabled: true },

      navigator: {
        enabled: true
      },

      series: series
    });

    c.highcharts().axes[0].setExtremes(aprilBeforeThat.getTime(), lastApril.getTime(), undefined, false);

  },

  drawAnalytics: function(element, data, selectSeriesFn) {

    cht.cloneToolTip = null;
    cht.cloneToolTip2 = null;

    $('#' + element).highcharts({
      chart: {
        type: "column",
        height: 200,
        events: {
          click: function(event) {
            selectSeriesFn();

            if (cht.cloneToolTip) {
              this.container.firstChild.removeChild(cht.cloneToolTip);
              cht.cloneToolTip = null;
            }
            if (cht.cloneToolTip2) {
              cht.cloneToolTip2.remove();
              cht.cloneToolTip2 = null;
            }

            return false;
          }
        }
      },
      title: {
        text: ''
      },
      subtitle: {
        text: document.ontouchstart === undefined ?
          'Click a column to filter the patient list' : 'Tap a column to filter the patient list'
      },
      xAxis: {
        categories: data.slice(1).map(function(v, i) {
          return v[0];
        })
      },
      yAxis: {
        title: {
          text: 'Quality standard performance'
        }
      },
      legend: {
        enabled: false
      },

      plotOptions: {
        series: {
          cursor: 'pointer',
          point: {
            events: {
              click: function(event) {
                var numPoints = this.series.points.length;

                selectSeriesFn(this.category);

                if (cht.cloneToolTip) {
                  this.series.chart.container.firstChild.removeChild(cht.cloneToolTip);
                }
                if (cht.cloneToolTip2) {
                  cht.cloneToolTip2.remove();
                }
                cht.cloneToolTip = this.series.chart.tooltip.label.element.cloneNode(true);
                this.series.chart.container.firstChild.appendChild(cht.cloneToolTip);

                cht.cloneToolTip2 = $('.highcharts-tooltip').clone();
                $(this.series.chart.container).append(cht.cloneToolTip2);

                return false;
              }
            }
          }
        }
      },

      series: [{
        data: data.slice(1).map(function(v, i) {
          return {
            y: v[v.length - 1],
            color: Highcharts.getOptions().colors[i]
          };
        })
      }]
    });
  }

};

module.exports = cht;

},{"./data.js":9,"./log.js":11,"./lookup.js":12,"highcharts/highstock":2,"mustache":4}],9:[function(require,module,exports){
var log = require('./log.js'),
  lookup = require('./lookup.js');

var _getAllIndicatorData = function(callback) {
  var r = Math.random();
  $.getJSON("data/indicators.json?v=" + r, function(file) {
    dt.indicators = file;

    dt.indicators.forEach(function(indicator) {
      var percentage = Math.round(100 * indicator.values[1][1] * 100 / indicator.values[2][1]) / 100;
      indicator.performance = indicator.values[1][1] + " / " + indicator.values[2][1] + " (" + percentage + "%)";
      indicator.target = indicator.values[3][1] * 100 + "%";
      indicator.up = percentage > Math.round(100 * indicator.values[1][2] * 100 / indicator.values[2][2]) / 100;
      var trend = indicator.values[1].map(function(val, idx) {
        return Math.round(100 * val * 100 / indicator.values[2][idx]) / 100;
      }).slice(1, 10);
      trend.reverse();
      indicator.trend = trend.join(",");
      var dates = indicator.values[0].slice(1, 10);
      dates.reverse();
      indicator.dates = dates;
    });


    callback(dt.indicators);
  });
};

var _getAllIndicatorDataSync = function(callback) {
  var r = Math.random();
  $.ajax({
    url: "data/indicators.json?v=" + r,
    async: false,
    success: function(file) {
      dt.indicators = file;

      dt.indicators.forEach(function(indicator) {
        var percentage = Math.round(100 * indicator.values[1][1] * 100 / indicator.values[2][1]) / 100;
        indicator.performance = indicator.values[1][1] + " / " + indicator.values[2][1] + " (" + percentage + "%)";
        indicator.target = indicator.values[3][1] * 100 + "%";
        indicator.up = percentage > Math.round(100 * indicator.values[1][2] * 100 / indicator.values[2][2]) / 100;
        var trend = indicator.values[1].map(function(val, idx) {
          return Math.round(100 * val * 100 / indicator.values[2][idx]) / 100;
        }).slice(1, 10);
        trend.reverse();
        indicator.trend = trend.join(",");
        var dates = indicator.values[0].slice(1, 10);
        dates.reverse();
        indicator.dates = dates;
      });

    }
  });

  return dt.indicators;
};

var _getIndicatorData = function(indicator, callback) {
  var r = Math.random();
  $.getJSON("data/idata." + indicator + ".json?v=" + r, function(file) {
    dt.indicators[indicator] = file;

    //apply which categories people belong to
    Object.keys(dt.indicators[indicator].patients).forEach(function(patient) {
      dt.indicators[indicator].patients[patient].opportunities = [];
      dt.indicators[indicator].opportunities.forEach(function(opp, idx) {
        if (opp.patients.indexOf(+patient) > -1) {
          dt.indicators[indicator].patients[patient].opportunities.push(idx);
        }
      });
    });

    callback(dt.indicators[indicator]);
  });
};

var _getIndicatorDataSync = function(indicator) {
  var r = Math.random();
  $.ajax({
    url: "data/idata." + indicator + ".json?v=" + r,
    async: false,
    success: function(file) {
      dt.indicators[indicator] = file;

      //apply which categories people belong to
      Object.keys(dt.indicators[indicator].patients).forEach(function(patient) {
        dt.indicators[indicator].patients[patient].opportunities = [];
        dt.indicators[indicator].opportunities.forEach(function(opp, idx) {
          if (opp.patients.indexOf(+patient) > -1) {
            dt.indicators[indicator].patients[patient].opportunities.push(idx);
          }
        });
      });

    }
  });
  return dt.indicators[indicator];
};

var _getFakePatientData = function(callback) {
  var r = Math.random();
  $.getJSON("data/patient.json?v=" + r, function(file) {
    if (!dt.patients) dt.patients = {};
    dt.patients.patient = file;

    callback(dt.patients.patient);
  });
};

var _getPatientData = function(patient, callback) {
  var r = Math.random();
  $.getJSON("data/" + patient + ".json?v=" + r, function(file) {
    if (!dt.patients) dt.patients = {};
    dt.patients[patient] = file;

    callback(dt.patients[patient]);
  }).fail(function() {
    if (dt.patients.patient) return callback(dt.patients.patient);
    else _getFakePatientData(callback);
  });
};

var dt = {

  pathwayNames: {},
  diseases: [],
  options: [],

  getPatietListForStandard: function(pathwayId, pathwayStage, standard) {
    var patients = dt.removeDuplicates(dt[pathwayId][pathwayStage].standards[standard].opportunities.reduce(function(a, b) {
      return a.patients ? a.patients.concat(b.patients) : a.concat(b.patients);
    }));
    return patients;
  },

  getPatientStatus: function(patientId, pathwayId, pathwayStage, standard) {
    if (dt.patients[patientId].breach) {
      if (dt.patients[patientId].breach.filter(function(val) {
          return val.pathwayId === pathwayId && val.pathwayStage === pathwayStage && val.standard === standard;
        }).length > 0) {
        return "missed";
      } else if (dt.patients[patientId].breach.filter(function(val) {
          return val.pathwayId === pathwayId && val.pathwayStage === "diagnosis";
        }).length > 0 && pathwayStage !== "diagnosis") {
        return "not";
      } else if (dt.patients[patientId].breach.filter(function(val) {
          return val.pathwayId === pathwayId;
        }).length > 0) {
        return "ok";
      } else {
        return "not";
      }
    } else {
      return "not";
    }
  },

  getNumeratorForStandard: function(pathwayId, pathwayStage, standard) {
    var patients = dt.getPatietListForStandard(pathwayId, pathwayStage, standard);
    return patients.length;
  },

  getDenominatorForStandard: function(pathwayId, pathwayStage) {
    var patients = dt[pathwayId][pathwayStage].patientsOk;
    for (var standard in dt[pathwayId][pathwayStage].standards) {
      var newPatients = dt.getPatietListForStandard(pathwayId, pathwayStage, standard);
      patients = patients.concat(newPatients);
    }
    return dt.removeDuplicates(patients).length;
  },

  removeDuplicates: function(array) {
    var arrResult = {};
    var rtn = [];
    for (var i = 0; i < array.length; i++) {
      arrResult[array[i]] = array[i];
    }
    for (var item in arrResult) {
      rtn.push(arrResult[item]);
    }
    return rtn;
  },

  numberOfStandardsMissed: function(patientId) {
    if (!dt.patients[patientId].breach) return 0;
    var a = dt.patients[patientId].breach.map(function(val) {
      return val.pathwayId + val.pathwayStage + val.standard;
    });
    var obj = {};
    for (var i = 0; i < a.length; i++) {
      obj[a[i]] = "";
    }
    return Object.keys(obj).length;
  },

  getAllPatients: function() {
    var pList = [],
      i, k, prop;
    for (k = 0; k < dt.diseases.length; k++) {
      for (i in lookup.categories) {
        for (prop in dt[dt.diseases[k].id][i].bdown) {
          if (dt[dt.diseases[k].id][i].bdown.hasOwnProperty(prop)) {
            pList = pList.concat(dt[dt.diseases[k].id][i].bdown[prop].patients);
          }
        }
        pList = pList.concat(dt[dt.diseases[k].id][i].patientsOk);
      }
    }
    pList = dt.removeDuplicates(pList);
    var patients = pList.map(function(patientId) {
      var ret = dt.patients[patientId];
      ret.nhsNumber = dt.patLookup ? dt.patLookup[patientId] : patientId;
      ret.patientId = patientId;
      ret.items = []; //The fields in the patient list table
      ret.items.push(dt.numberOfStandardsMissed(patientId));
      return ret;
    });

    return patients;
  },

  get: function(callback, json) {
    if (json) {
      dt.load(json);
      if (typeof callback === 'function') callback();
    } else {
      var r = Math.random();
      $.getJSON("data.json?v=" + r, function(file) {
        dt.load(file);
        if (typeof callback === 'function') callback();
      }).fail(function(err) {
        alert("data.json failed to load!! - if you've changed it recently check it's valid json at jsonlint.com");
      });
    }
  },

  load: function(file) {
    var d = "",
      j, k, key, data = file.diseases;

    dt = jQuery.extend(dt, data); //copy

    dt.patients = file.patients;
    dt.codes = file.codes;
    dt.patientArray = [];
    for (var o in file.patients) {
      if (file.patients.hasOwnProperty(o)) {
        dt.patientArray.push(o);
      }
    }

    for (d in data) {
      dt.pathwayNames[d] = data[d]["display-name"];
      var diseaseObject = {
        "id": d,
        "link": data[d].link ? data[d].link : "dt/" + d,
        "faIcon": data[d].icon,
        "name": data[d]["display-name"],
        "text": {
          "dt": {
            "tooltip": data[d]["side-panel-tooltip"]
          }
        }
      };
      if (data[d].monitoring.text) {
        diseaseObject.text.monitoring = data[d].monitoring.text.sidePanel;
      }
      if (data[d].treatment.text) {
        diseaseObject.text.treatment = data[d].treatment.text.sidePanel;
      }
      if (data[d].diagnosis.text) {
        diseaseObject.text.diagnosis = data[d].diagnosis.text.sidePanel;
      }
      if (data[d].exclusions.text) {
        diseaseObject.text.exclusions = data[d].exclusions.text.sidePanel;
      }
      this.diseases.push(diseaseObject);
      dt[d].suggestions = log.plan[d].team;
      $.extend(dt[d].monitoring, {
        "breakdown": [],
        "bdown": {}
      });
      $.extend(dt[d].treatment, {
        "breakdown": [],
        "bdown": {}
      });
      $.extend(dt[d].diagnosis, {
        "breakdown": [],
        "bdown": {}
      });
      $.extend(dt[d].exclusions, {
        "breakdown": [],
        "bdown": {}
      });

      if (!dt[d].monitoring.header) continue;
      for (key in dt[d].monitoring.standards) {
        this.options.push({
          "value": this.options.length,
          "pathwayId": d,
          "pathwayStage": "monitoring",
          "standard": key,
          "text": this.pathwayNames[d] + ' - ' + "Monitoring" + ' - ' + dt[d].monitoring.standards[key].tab.title
        });
        for (j = 0; j < dt[d].monitoring.standards[key].opportunities.length; j++) {
          dt[d].monitoring.bdown[dt[d].monitoring.standards[key].opportunities[j].name] = dt[d].monitoring.standards[key].opportunities[j];
          dt[d].monitoring.bdown[dt[d].monitoring.standards[key].opportunities[j].name].suggestions = log.plan[d].monitoring.individual[dt[d].monitoring.standards[key].opportunities[j].name];
          for (k = 0; k < dt[d].monitoring.standards[key].opportunities[j].patients.length; k++) {
            if (!dt.patients[dt[d].monitoring.standards[key].opportunities[j].patients[k]].breach) dt.patients[dt[d].monitoring.standards[key].opportunities[j].patients[k]].breach = [];
            dt.patients[dt[d].monitoring.standards[key].opportunities[j].patients[k]].breach.push({
              "pathwayId": d,
              "pathwayStage": "monitoring",
              "standard": key,
              "subsection": dt[d].monitoring.standards[key].opportunities[j].name
            });
          }
        }
      }
      for (key in dt[d].diagnosis.standards) {
        this.options.push({
          "value": this.options.length,
          "pathwayId": d,
          "pathwayStage": "diagnosis",
          "standard": key,
          "text": this.pathwayNames[d] + ' - ' + "Diagnosis" + ' - ' + dt[d].diagnosis.standards[key].tab.title
        });
        for (j = 0; j < dt[d].diagnosis.standards[key].opportunities.length; j++) {
          dt[d].diagnosis.bdown[dt[d].diagnosis.standards[key].opportunities[j].name] = dt[d].diagnosis.standards[key].opportunities[j];
          dt[d].diagnosis.bdown[dt[d].diagnosis.standards[key].opportunities[j].name].suggestions = log.plan[d].diagnosis.individual[dt[d].diagnosis.standards[key].opportunities[j].name];
          for (k = 0; k < dt[d].diagnosis.standards[key].opportunities[j].patients.length; k++) {
            if (!dt.patients[dt[d].diagnosis.standards[key].opportunities[j].patients[k]].breach) dt.patients[dt[d].diagnosis.standards[key].opportunities[j].patients[k]].breach = [];
            dt.patients[dt[d].diagnosis.standards[key].opportunities[j].patients[k]].breach.push({
              "pathwayId": d,
              "pathwayStage": "diagnosis",
              "standard": key,
              "subsection": dt[d].diagnosis.standards[key].opportunities[j].name
            });
          }
        }
      }
      for (key in dt[d].treatment.standards) {
        this.options.push({
          "value": this.options.length,
          "pathwayId": d,
          "pathwayStage": "treatment",
          "standard": key,
          "text": this.pathwayNames[d] + ' - ' + "Treatment" + ' - ' + dt[d].treatment.standards[key].tab.title
        });
        for (j = 0; j < dt[d].treatment.standards[key].opportunities.length; j++) {
          dt[d].treatment.bdown[dt[d].treatment.standards[key].opportunities[j].name] = dt[d].treatment.standards[key].opportunities[j];
          dt[d].treatment.bdown[dt[d].treatment.standards[key].opportunities[j].name].suggestions = log.plan[d].treatment.individual[dt[d].treatment.standards[key].opportunities[j].name];
          for (k = 0; k < dt[d].treatment.standards[key].opportunities[j].patients.length; k++) {
            if (!dt.patients[dt[d].treatment.standards[key].opportunities[j].patients[k]].breach) dt.patients[dt[d].treatment.standards[key].opportunities[j].patients[k]].breach = [];
            dt.patients[dt[d].treatment.standards[key].opportunities[j].patients[k]].breach.push({
              "pathwayId": d,
              "pathwayStage": "treatment",
              "standard": key,
              "subsection": dt[d].treatment.standards[key].opportunities[j].name
            });
          }
        }
      }
      for (key in dt[d].exclusions.standards) {
        this.options.push({
          "value": this.options.length,
          "pathwayId": d,
          "pathwayStage": "exclusions",
          "standard": key,
          "text": this.pathwayNames[d] + ' - ' + "Exclusions" + ' - ' + dt[d].exclusions.standards[key].tab.title
        });
        for (j = 0; j < dt[d].exclusions.standards[key].opportunities.length; j++) {
          dt[d].exclusions.bdown[dt[d].exclusions.standards[key].opportunities[j].name] = dt[d].exclusions.standards[key].opportunities[j];
          dt[d].exclusions.bdown[dt[d].exclusions.standards[key].opportunities[j].name].suggestions = log.plan[d].exclusions.individual[dt[d].exclusions.standards[key].opportunities[j].name];
          for (k = 0; k < dt[d].exclusions.standards[key].opportunities[j].patients.length; k++) {
            if (!dt.patients[dt[d].exclusions.standards[key].opportunities[j].patients[k]].breach) dt.patients[dt[d].exclusions.standards[key].opportunities[j].patients[k]].breach = [];
            dt.patients[dt[d].exclusions.standards[key].opportunities[j].patients[k]].breach.push({
              "pathwayId": d,
              "pathwayStage": "exclusions",
              "standard": key,
              "subsection": dt[d].exclusions.standards[key].opportunities[j].name
            });
          }
        }
      }
    }
  },

  getAllIndicatorData: function(callback) {
    if (dt.indicators) {
      return callback(dt.indicators);
    } else {
      _getAllIndicatorData(callback);
    }
  },

  getAllIndicatorDataSync: function() {
    if (dt.indicators) {
      return dt.indicators;
    } else {
      return _getAllIndicatorDataSync();
    }
  },

  getIndicatorData: function(indicator, callback) {
    if (!dt.indicators) {
      _getAllIndicatorData(function(data) {
        _getIndicatorData(indicator, callback);
      });
    } else if (dt.indicators && dt.indicators[indicator]) {
      return callback(dt.indicators[indicator]);
    } else {
      _getIndicatorData(indicator, callback);
    }
  },

  getIndicatorDataSync: function(indicator) {
    dt.getAllIndicatorDataSync();
    if (dt.indicators[indicator]) {
      return dt.indicators[indicator];
    } else {
      return _getIndicatorDataSync(indicator);
    }
  },

  getPatientData: function(patientId, callback) {
    /*if(dt.patients && dt.patients[patientId]) {
      return callback(dt.patients[patientId]);
    } else {*/
    _getPatientData(patientId, callback);
    /*  }*/
  }

};

module.exports = dt;

},{"./log.js":11,"./lookup.js":12}],10:[function(require,module,exports){
var data = require('./data.js'),
Mustache = require('mustache');

var layout = {

  elements: {},

  //Side panel, navigation, header bar and main page
  showMainView: function() {
    //Set up navigation panel
    ////layout.showSidePanel();
    ////layout.showNavigation(data.diseases, idx, $('#main-dashboard'));

    $('#bottomnavbar').hide();
    layout.showHeaderBarItems();

    //Show main dashboard page
    layout.showPage('main-dashboard');
  },

  clearNavigation: function() {
    $("aside.left-panel nav.navigation > ul > li > ul").slideUp(300);
    $("aside.left-panel nav.navigation > ul > li").removeClass('active');
  },

  showNavigation: function(list, idx, parent) {
    if (layout.elements.navigation) {

      if (idx === -1) {
        layout.clearNavigation();
        $('aside a[href="#welcome"]:first').closest('li').addClass('active');
      } else if (idx >= list.length) {
        layout.clearNavigation();
        $('aside a[href="#patients"]').closest('li').addClass('active');
      } else if (!$('aside a[href="#' + list[idx].link + '"]:first').closest('li').hasClass('active')) {
        layout.clearNavigation();
        //set active
        $('aside a[href="#' + list[idx].link + '"]').next().slideToggle(300);
        $('aside a[href="#' + list[idx].link + '"]').closest('li').addClass('active');
      }

      return;
    }

    var tempMust = $('#pathway-picker').html();
    var itemTemplate = $('#pathway-picker-item').html();
    Mustache.parse(tempMust);
    Mustache.parse(itemTemplate);

    list = list.slice();
    list[0].isBreakAbovePractice = true;
    for (var i = 0; i < list.length; i++) {
      list[i].hasSubItems = true;
    }
    list.unshift({
      "link": "welcome",
      "faIcon": "fa-home",
      "name": "Agreed actions",
      "isBreakAboveHome": true,
      "text": {
        "main": {
          "tooltip": "Agreed tooltip - edit in script.js"
        }
      }
    });
    list.push({
      "link": "patients",
      "faIcon": "fa-users",
      "name": "All Patients",
      "isBreakAbovePatient": true,
      "text": {
        "main": {
          "tooltip": "All patients tooltip - edit in script.js"
        }
      }
    });

    list.map(function(v, i, arr) {
      v.isSelected = i === idx + 1;
      return v;
    });

    var renderedBefore = Mustache.render(tempMust, {
      "items": list
    }, {
      "item": itemTemplate,
      "subItem": $('#pathway-picker-sub-item').html()
    });
    $('#aside-toggle nav:first').html(renderedBefore);

    $('.user').on('click', function() {
      template.loadContent('#agreedactions');
    });

    layout.elements.navigation = true;
  },

  showPage: function(page) {
    if (layout.page === page) return;
    layout.page = page;
    $('.page').hide();
    $('#' + page).show();

    if (page !== 'main-dashboard') {
      ////layout.hideSidePanel();
      $('#bottomnavbar').show();
      layout.hideHeaderBarItems();
    }
  },

  showSidePanel: function() {
    if (layout.elements.navigtion) return;
    layout.elements.navigtion = true;
    $('#main').addClass('content');
    $('#topnavbar').addClass('full');
    $('#aside-toggle').show();
    $('#bottomnavbar').hide();
  },

  hideSidePanel: function() {
    if (layout.elements.navigtion === false) return;
    layout.elements.navigtion = false;
    $('#main').removeClass('content');
    $('#topnavbar').removeClass('full');
    $('#aside-toggle').hide();
    $('#bottomnavbar').show();
  },

  showHeaderBarItems: function() {
    if (layout.elements.headerbar) return;
    layout.elements.headerbar = true;
    $('.hide-if-logged-out').show();
  },

  hideHeaderBarItems: function() {
    if (layout.elements.headerbar === false) return;
    layout.elements.headerbar = false;
    $('.hide-if-logged-out').hide();
  }

};

module.exports = layout;

},{"./data.js":9,"mustache":4}],11:[function(require,module,exports){
var notify = require('./notify.js');

var log = {
  reason: {},

  getObj: function(options) {
    var obj = JSON.parse(localStorage.bb);

    if (options && options.length > 0) {
      options.forEach(function(opt) {
        if (!obj[opt.name]) {
          obj[opt.name] = opt.value;
          log.setObj(obj);
        }
      });
    }

    return obj;
  },

  setObj: function(obj) {
    localStorage.bb = JSON.stringify(obj);
  },

  loadActions: function(callback) {
    var r = Math.random();
    $.getJSON("action-plan.json?v=" + r, function(file) {
      log.plan = file.diseases;
      log.text = file.plans;
      callback();
    });
  },

  editAction: function(id, actionId, agree, done, reason) {
    var logText, obj = log.getObj([{
      name: "actions",
      value: {}
    }]);
    if (!id) alert("ACTION TEAM/IND ID");
    if (!actionId) alert("ACTION ID");

    if (!obj.actions[id]) {
      obj.actions[id] = {};
    }


    if (agree) {
      logText = "You agreed with this suggested action on " + (new Date()).toDateString();
    } else if (agree === false) {
      var reasonText = log.reason.reason === "" && log.reason.reasonText === "" ? " - no reason given" : " . You disagreed because you said: '" + log.reason.reason + "; " + log.reason.reasonText + ".'";
      logText = "You disagreed with this action on " + (new Date()).toDateString() + reasonText;
    }

    if (done) {
      logText = "You agreed with this suggested action on " + (new Date()).toDateString();
    }

    if (!obj.actions[id][actionId]) {
      obj.actions[id][actionId] = {
        "agree": agree ? agree : false,
        "done": done ? done : false,
        "history": [logText]
      };
    } else {
      if (agree === true || agree === false) obj.actions[id][actionId].agree = agree;
      if (done === true || done === false) obj.actions[id][actionId].done = done;
      if (logText) {
        if (obj.actions[id][actionId].history) obj.actions[id][actionId].history.unshift(logText);
        else obj.actions[id][actionId].done.history = [logText];
      }
    }

    if (reason && obj.actions[id][actionId].agree === false) {
      obj.actions[id][actionId].reason = reason;
    } else {
      delete obj.actions[id][actionId].reason;
    }

    log.setObj(obj);
    notify.showSaved();
  },

  ignoreAction: function(id, actionId) {
    var obj = log.getObj([{
      name: "actions",
      value: {}
    }]);
    obj.actions[id][actionId].agree = null;
    delete obj.actions[id][actionId].reason;
    log.setObj(obj);
  },

  getActions: function() {
    return log.getObj([{
      name: "actions",
      value: {}
    }]).actions;
  },

  listActions: function(id, pathwayId) {
    var obj = log.getObj([{
      name: "actions",
      value: {}
    }]);
    arr = [];
    if (!id) return obj.actions;
    if (!obj.actions[id]) return arr;
    for (var prop in obj.actions[id]) {
      obj.actions[id][prop].id = prop;
      if (!obj.actions[id][prop].text)
        arr.push(obj.actions[id][prop]);
    }
    return arr;
  },

  //id is either "team" or the patientId
  recordFeedback: function(pathwayId, id, suggestion, reason, reasonText) {
    log.reason = {
      "reason": reason,
      "reasonText": reasonText
    };
    var obj = log.getObj([{
      name: "feedback",
      value: []
    }]);

    var item = {
      "pathwayId": pathwayId,
      "id": id,
      "val": suggestion
    };
    if (reasonText !== "") item.reasonText = reasonText;
    if (reason !== "") item.reason = reason;
    obj.feedback.push(item);
    log.setObj(obj);
  },

  getEvents: function() {
    return log.getObj([{
      name: "events",
      value: []
    }]).events;
  },

  recordEvent: function(pathwayId, id, name) {
    var obj = log.getObj([{
      name: "events",
      value: []
    }]);
    obj.events.push({
      "pathwayId": pathwayId,
      "id": id,
      "name": name,
      "date": new Date()
    });
    log.setObj(obj);
  },

  recordPlan: function(id, text, pathwayId) {
    if (!id) alert("PLAN");
    var obj = log.getObj([{
      name: "actions",
      value: {}
    }]);

    if (!obj.actions[id]) obj.actions[id] = {};
    var planId = Date.now() + "";
    obj.actions[id][planId] = {
      "text": text,
      "agree": null,
      "done": false,
      "pathwayId": pathwayId,
      "history": ["You added this on " + (new Date()).toDateString()]
    };

    log.setObj(obj);
    return planId;
  },

  findPlan: function(obj, planId) {
    for (var k in obj.actions) {
      if (obj.actions[k][planId] && obj.actions[k][planId].text) return k;
    }
    return -1;
  },

  editPlan: function(planId, text, done) {
    var obj = log.getObj([{
      name: "actions",
      value: {}
    }]);
    var id = log.findPlan(obj, planId);
    if (text) obj.actions[id][planId].text = text;
    if (done === true || done === false) obj.actions[id][planId].done = done;
    log.setObj(obj);
  },

  deletePlan: function(planId) {
    var obj = log.getObj([{
      name: "actions",
      value: {}
    }]);
    var id = log.findPlan(obj, planId);
    delete obj.actions[id][planId];
    log.setObj(obj);
  },

  listPlans: function(id, pathwayId) {
    var obj = log.getObj([{
        name: "actions",
        value: {}
      }]),
      arr = [];
    if (!id) return obj.actions;
    for (var prop in obj.actions[id]) {
      obj.actions[id][prop].id = prop;
      if ((!pathwayId || pathwayId === obj.actions[id][prop].pathwayId) && obj.actions[id][prop].text) arr.push(obj.actions[id][prop]);
    }
    return arr;
  },

  getReason: function(id, actionId) {
    var obj = log.getObj([{
      name: "actions",
      value: {}
    }]);

    if (obj.actions[id] && obj.actions[id][actionId]) return obj.actions[id][actionId].reason;
    return null;
  },

  getAgreeReason: function(pathwayId, pathwayStage, standard, patientId, item) {
    var obj = log.getObj([{
      name: "agrees",
      value: {}
    }]);
    if (!pathwayId || !pathwayStage) alert("EDITPATIENTAGREE");

    if (!obj.agrees[patientId]) obj.agrees[patientId] = [];
    var items = obj.agrees[patientId].filter(function(val) {
      return val.pathwayId === pathwayId && val.pathwayStage === pathwayStage && val.standard === standard && val.item === item;
    });

    return items.length === 1 ? items[0].reason || {} : {};
  },

  editPatientAgree: function(pathwayId, pathwayStage, standard, patientId, item, agree, reason) {
    var obj = log.getObj();
    if (!pathwayId || !pathwayStage) alert("EDITPATIENTAGREE");

    if (!obj.agrees[patientId]) obj.agrees[patientId] = [];
    var items = obj.agrees[patientId].filter(function(val) {
      return val.pathwayId === pathwayId && val.pathwayStage === pathwayStage && val.standard === standard && val.item === item;
    });

    var logText = "You " + (agree ? "" : "dis") + "agreed with this on " + (new Date()).toDateString();

    if (items.length === 1) {
      items[0].agree = agree;
      items[0].history.push(logText);
      items[0].reason = reason;
    } else if (items.length === 0) {
      obj.agrees[patientId].push({
        "pathwayId": pathwayId,
        "pathwayStage": pathwayStage,
        "standard": standard,
        "item": item,
        "agree": agree,
        "reason": reason,
        "history": [logText]
      });
    } else {
      console.log("ERRORRR!!!!!!!");
    }

    log.setObj(obj);
    notify.showSaved();
  },

  getAgrees: function(){
    return log.getObj([{
      name: "agrees",
      value: {}
    }]).agrees;
  },

  getPatientAgreeObject: function(pathwayId, pathwayStage, standard, patientId, item) {
    var obj = log.getObj([{
      name: "agrees",
      value: {}
    }]);
    if (!pathwayId || !pathwayStage) alert("EDITPATIENTAGREE");

    if (!obj.agrees[patientId]) obj.agrees[patientId] = [];
    var items = obj.agrees[patientId].filter(function(val) {
      return val.pathwayId === pathwayId && val.pathwayStage === pathwayStage && val.standard === standard && val.item === item;
    });
    if (items.length === 1) return items[0];
    return {};
  },

  getPatientAgree: function(pathwayId, pathwayStage, standard, patientId, item) {
    var obj = log.getObj([{
      name: "agrees",
      value: {}
    }]);

    if (!obj.agrees[patientId]) return null;
    var item2 = obj.agrees[patientId].filter(function(val) {
      return val.pathwayId === pathwayId && val.pathwayStage === pathwayStage && val.standard === standard && val.item === item;
    });

    if (item.length === 1) {
      return item[0].agree;
    }
    return null;
  }

};

module.exports = log;

},{"./notify.js":14}],12:[function(require,module,exports){
module.exports = {
  "currentUrl": "",
  "options": [],
  "categories": {
    "diagnosis": {
      "name": "diagnosis",
      "display": "Diagnosis"
    },
    "monitoring": {
      "name": "monitoring",
      "display": "Monitoring"
    },
    "treatment": {
      "name": "treatment",
      "display": "Control"
    },
    "exclusions": {
      "name": "exclusions",
      "display": "Exclusions"
    }
  },
  "charts": {},
  "pathwayId": "htn",
  "colors": ['#1f77b4', '#ff7f0e', '#2ca02c', '#d62728', '#9467bd', '#8c564b', '#e377c2', '#7f7f7f', '#bcbd22', '#17becf'],
  "monitored": {
    "bp": "Blood Pressure",
    "asthma": "Peak Expiratory Flow"
  }
};

},{}],13:[function(require,module,exports){
var template = require('./template.js'),
  data = require('./data.js'),
  base = require('./base.js'),
  layout = require('./layout.js'),
  welcome = require('./panels/welcome.js'),
  log = require('./log.js'),
  patientView = require('./views/patient.js'),
  Mustache = require('mustache');

var states, patLookup, page, hash;

console.log("main.js: data.lastloader= " + data.lastloader);
data.lastloader = "main.js";

var main = {
  "version": "2.0.0",

  hash: hash,
  init: function() {
    main.preWireUpPages();

    log.loadActions(function() {
      data.get(main.wireUpPages);
    });
  },

  onSelected: function($e, nhsNumberObject) {
    //Hide the suggestions panel
    $('#search-box').find('.tt-dropdown-menu').css('display', 'none');

    history.pushState(null, null, '#patients/' + nhsNumberObject.id);
    template.loadContent('#patients/' + nhsNumberObject.id, true);


    //template.displaySelectedPatient(nhsNumberObject.id);
  },

  wireUpSearchBox: function() {
    if (states) {
      states.clearPrefetchCache();
    }

    states = new Bloodhound({
      datumTokenizer: Bloodhound.tokenizers.obj.whitespace('value'),
      queryTokenizer: Bloodhound.tokenizers.whitespace,
      local: $.map(data.patientArray, function(state) {
        return {
          id: state,
          value: patLookup ? patLookup[state] : state
        };
      })
    });

    states.initialize(true);

    $('#search-box').find('.typeahead').typeahead('destroy');
    $('#search-box').find('.typeahead').typeahead({
        hint: true,
        highlight: true,
        minLength: 1,
        autoselect: true
      }, {
        name: 'patients',
        displayKey: 'value',
        source: states.ttAdapter(),
        templates: {
          empty: [
              '<div class="empty-message">',
                '&nbsp; &nbsp; No matches',
              '</div>'
            ].join('\n')
        }
      }).on('typeahead:selected', main.onSelected)
      .on('typeahead:autocompleted', main.onSelected);

    $('#searchbtn').on('mousedown', function() {
      var val = $('.typeahead').eq(0).val();
      if (!val || val === "") val = $('.typeahead').eq(1).val();
      main.onSelected(null, {
        "id": val
      });
    });
  },

  wireUpPages: function() {
    base.wireUpTooltips();
    main.wireUpSearchBox();

    $('#data-file').on('change', function(evt) {
      $('#data-file-wrapper').addClass('disabled').text("Loading...");
      var file = evt.target.files[0]; // FileList object
      var reader = new FileReader();

      reader.onload = (function() {
        return function(e) {
          var JsonObj = JSON.parse(e.target.result);
          getData(null, JsonObj);
          console.log(JsonObj);

          main.wireUpSearchBox();

          setTimeout(function() {
            $('#data-file-wrapper').hide(500);
          }, 1000);
        };
      })(file);

      reader.readAsText(file);
    });

    $('#patient-file').on('change', function(evt) {
      $('#patient-file-wrapper').addClass('disabled').text("Loading...");
      var file = evt.target.files[0]; // FileList object
      var reader = new FileReader();

      reader.onload = (function() {
        return function(e) {
          var lines = e.target.result.split("\n");
          patLookup = {};
          for (var i = 0; i < lines.length; i++) {
            var fields = lines[i].split(",");
            if (fields.length !== 2) continue;
            patLookup[fields[0].trim()] = fields[1].trim();
          }

          main.wireUpSearchBox();

          setTimeout(function() {
            $('#patient-file-wrapper').hide(500);
          }, 1000);
        };
      })(file);

      reader.readAsText(file);
    });

    $('#outstandingTasks').on('click', function(e) {
      e.preventDefault();

      $('#welcome-tabs li').removeClass('active');
      $(this).closest('li').addClass('active');
      var tempMust = $('#welcome-task-list').html();
      var rendered = Mustache.render(tempMust);
      $('#welcome-tab-content').fadeOut(100, function() {
        $(this).html(rendered);
        welcome.populate();
        $(this).fadeIn(100);
      });
    });

    $('#completedTasks').on('click', function(e) {
      e.preventDefault();

      $('#welcome-tabs li').removeClass('active');
      $(this).closest('li').addClass('active');
      var tempMust = $('#welcome-task-list').html();
      var rendered = Mustache.render(tempMust);
      $('#welcome-tab-content').fadeOut(100, function() {
        $(this).html(rendered);
        welcome.populate(true);
        $(this).fadeIn(100);
      });
    });

    if (main.hash !== location.hash) location.hash = main.hash;
    template.loadContent(location.hash, true);
  },

  preWireUpPages: function() {
    layout.showPage('login');

    //Every link element stores href in history
    $(document).on('click', 'a.history', function() {
      // keep the link in the browser history
      history.pushState(null, null, this.href);
      template.loadContent(location.hash, true);
      // do not give a default action
      return false;
    });

    //Called when the back button is hit
    $(window).on('popstate', function(e) {
      template.loadContent(location.hash, true);
    });

    //Templates
    patientsPanelTemplate = $('#patients-panel');
    actionPlanPanel = $('#action-plan-panel');
    patientList = $('#patient-list');
    suggestedPlanTemplate = $('#suggested-plan-template');
    individualPanel = $('#individual-panel');
    valueTrendPanel = $('#value-trend-panel');
    medicationPanel = $('#medications-panel');
    actionPlanList = $('#action-plan-list');

    //Selectors
    bottomLeftPanel = $('#bottom-left-panel');
    bottomRightPanel = $('#bottom-right-panel');
    topPanel = $('#top-panel');
    topLeftPanel = $('#top-left-panel');
    topRightPanel = $('#top-right-panel');
    midPanel = $('#mid-panel');
    farLeftPanel = $('#left-panel');
    farRightPanel = $('#right-panel');
  }
    /*,
      "_local": local*/
};

module.exports = main;

},{"./base.js":7,"./data.js":9,"./layout.js":10,"./log.js":11,"./panels/welcome.js":31,"./template.js":33,"./views/patient.js":37,"mustache":4}],14:[function(require,module,exports){
module.exports = {

  showSaved: function() {
    $("#saved-message").hide().toggleClass("in").fadeIn(300);
    window.setTimeout(function() {
      $("#saved-message").fadeOut(300, function() {
        $(this).toggleClass("in");
      });
    }, 2000);
  }

};

},{}],15:[function(require,module,exports){
var base = require('../base.js'),
  data = require('../data.js'),
  qualityStandard = require('./qualityStandard.js'),
  otherCodes = require('./otherCodes.js'),
  medication = require('./medication.js'),
  trend = require('./trend.js'),
  individualActionPlan = require('./individualActionPlan.js'),
  layout = require('../layout.js'),
  chart = require('../chart.js'),
  Mustache = require('mustache');

var all = {

  populate: function() {
    var patients = data.getAllPatients();

    var localData = {
      "patients": patients,
      "n": patients.length,
      "header-items": [{
        "title": "NHS no.",
        "isUnSortable": true
      }, {
        "title": "All Opportunities",
        "titleHTML": '# of <i class="fa fa-flag" style="color:red"></i>',
        "isUnSortable": true,
        "tooltip": "Total number of improvement opportunities available across all conditions"
      }]
    };

    localData.patients.sort(function(a, b) {
      if (a.items[0] === b.items[0]) {
        return 0;
      }
      var A = Number(a.items[0]);
      var B = Number(b.items[0]);
      if (isNaN(A) || isNaN(B)) {
        A = a.items[0];
        B = b.items[0];
      }
      if (A > B) {
        return -1;
      } else if (A < B) {
        return 1;
      }
    });

    base.createPanelShow(patientList, patientsPanel, localData, {
      "header-item": $("#patient-list-header-item").html(),
      "item": $('#patient-list-item').html()
    });

    $('#patients-placeholder').hide();

    base.setupClipboard($('.btn-copy'), true);

    base.wireUpTooltips();

    var c = patientsPanel.find('div.table-scroll').getNiceScroll();
    if (c && c.length > 0) {
      c.resize();
    } else {
      patientsPanel.find('div.table-scroll').niceScroll({
        cursoropacitymin: 0.3,
        cursorwidth: "7px",
        horizrailenabled: false
      });
    }
  },

  //Show patient view from the all patient screen
  showIndividualPatientView: function(pathwayId, pathwayStage, standard, patientId) {
    data.patientId = patientId;

    data.options.sort(function(a, b) {
      a = data.getPatientStatus(patientId, a.pathwayId, a.pathwayStage, a.standard);
      b = data.getPatientStatus(patientId, b.pathwayId, b.pathwayStage, b.standard);

      if (a === b) return 0;
      if (a === "not") return 1;
      if (b === "not") return -1;
      if (a === "ok") return 1;
      if (b === "ok") return -1;
      alert("!!!!!!!");
    });

    if (pathwayId === null) {
      //Show patient but don't select
      var p = base.createPanel($('#patient-panel'), {
        "options": data.options,
        "numberOfStandardsMissed": data.numberOfStandardsMissed(patientId),
        "nhsNumber": data.patLookup ? data.patLookup[patientId] : patientId,
        "patientId": patientId
      }, {
        "option": $('#patient-panel-drop-down-options').html()
      });
      farRightPanel.html(p).show();
      farRightPanel.removeClass('standard-missed-page').removeClass('standard-achieved-page').removeClass('standard-not-relevant-page');

      $('select').select2({
        templateResult: base.formatStandard,
        minimumResultsForSearch: Infinity,
        placeholder: "Please select an improvement opportunity area..."
      });
      $('span.select2-selection__rendered').attr("title", "");
      $('select').on('change', function() {
        var localData = $(this).find(':selected').data();
        all.showIndividualPatientView(localData.pathwayId, localData.pathwayStage, localData.standard, data.patientId);
      }).on("select2:open", function(e) {
        base.wireUpTooltips();
      });
      return;
    }

    var panel = base.createPanel($('#patient-panel'), {
      "options": data.options,
      "numberOfStandardsMissed": data.numberOfStandardsMissed(patientId),
      "standard": data[pathwayId][pathwayStage].standards[standard].tab.title,
      "pathwayStage": pathwayStage,
      "nhsNumber": data.patLookup ? data.patLookup[patientId] : patientId,
      "patientId": patientId
    }, {
      "option": $('#patient-panel-drop-down-options').html()
    });

    farRightPanel.html("");
    $('#temp-hidden').html(panel);

    var actionPlan = individualActionPlan.create(pathwayStage);
    $('#temp-hidden #patient-panel-right').html(actionPlan);

    var qualPanel = qualityStandard.create(pathwayId, pathwayStage, standard, patientId);
    var trendPanel = trend.create(pathwayId, pathwayStage, standard, patientId);
    var medPanel = medication.create(pathwayId, pathwayStage, standard, patientId);
    var codesPanel = otherCodes.create(pathwayId, pathwayStage, standard, patientId);
    var medCodeWrapperPanel = base.createPanel($('#other-codes-and-meds-wrapper-panel'));
    $('#temp-hidden #patient-panel-top').html(qualPanel);
    $('#temp-hidden #patient-panel-left').html("").append(trendPanel).append(medCodeWrapperPanel);
    $('#temp-hidden #medCodeWrapperPanel').append(medPanel).append(codesPanel);

    if (farRightPanel.is(':visible')) {
      farRightPanel.fadeOut(100, function() {
        $(this).html($('#temp-hidden').html());
        $('#temp-hidden').html("");
        individualActionPlan.wireUp(pathwayId, pathwayStage, standard, patientId);
        qualityStandard.wireUp(pathwayId, pathwayStage, standard, patientId);
        base.wireUpStandardDropDown(pathwayId, pathwayStage, standard, all.showIndividualPatientView);
        trend.wireUp(pathwayId, pathwayStage, standard, patientId);
        medication.wireUp(pathwayId, pathwayStage, standard, patientId);
        otherCodes.wireUp(pathwayId, pathwayStage, standard, patientId);
        chart.drawTrendChart(patientId, pathwayId, pathwayStage, standard);
        $(this).fadeIn(100, function() {});
      });
    } else {
      farRightPanel.html($('#temp-hidden').html());
      $('#temp-hidden').html("");
      individualActionPlan.wireUp(pathwayId, pathwayStage, standard, patientId);
      qualityStandard.wireUp(pathwayId, pathwayStage, standard, patientId);
      base.wireUpStandardDropDown(pathwayId, pathwayStage, standard, all.showIndividualPatientView);
      trend.wireUp(pathwayId, pathwayStage, standard, patientId);
      medication.wireUp(pathwayId, pathwayStage, standard, patientId);
      otherCodes.wireUp(pathwayId, pathwayStage, standard, patientId);
      chart.drawTrendChart(patientId, pathwayId, pathwayStage, standard);
      farRightPanel.fadeIn(100, function() {});
    }
  },

  show: function(location) {
    base.createPanelShow($('#all-patients-panel'), location, {
      "n": data.getAllPatients().length
    });

    patientsPanel = $('#patients');

    patientsPanel.on('click', 'tbody tr', function(e) { //Select individual patient when row clicked
      $('[data-toggle="tooltip"]').tooltip('hide');
      $(this).tooltip('destroy');
      base.clearBox();
      $('.list-item').removeClass('highlighted');
      $(this).addClass('highlighted').removeAttr('title');

      var patientId = $(this).find('td button').attr('data-patient-id');

      all.showIndividualPatientView(null, null, null, patientId);

      e.preventDefault();
      e.stopPropagation();
    }).on('click', 'tbody tr button', function(e) {
      //don't want row selected if just button pressed?
      e.preventDefault();
      e.stopPropagation();
    });
  },

  showView: function(patientId, reload) {
    $('#mainTitle').hide();
    base.updateTitle("List of all patients at your practice");

    if (!patientId) data.pathwayId = "";
    if (!patientId || reload) {

      layout.showMainView(data.diseases.length);

      base.switchTo110Layout();
      base.hideAllPanels();

      all.show(farLeftPanel);
      all.populate();
    }

    if (patientId) {
      all.showIndividualPatientView(null, null, null, patientId);
    } else {
      var tempMust = $('#patient-panel-placeholder').html();
      farRightPanel.html(Mustache.render(tempMust)).show();
    }
  }

};

module.exports = all;

},{"../base.js":7,"../chart.js":8,"../data.js":9,"../layout.js":10,"./individualActionPlan.js":21,"./medication.js":23,"./otherCodes.js":24,"./qualityStandard.js":28,"./trend.js":30,"mustache":4}],16:[function(require,module,exports){
var base = require('../base.js'),
log = require('../log.js');

var confirm = {

  wireUp: function(agreeDivSelector, panelSelector, pathwayId, pathwayStage, standard, patientId, item, disagreeText) {
    confirm.wireUpAgreeDisagree(agreeDivSelector, log.getPatientAgreeObject(pathwayId, pathwayStage, standard, patientId, item));

    panelSelector.on('change', '.btn-toggle input[type=checkbox]', function() {
      confirm.wireUpAgreeDisagree(agreeDivSelector, log.getPatientAgreeObject(pathwayId, pathwayStage, standard, patientId, item));
      base.wireUpTooltips();
    }).on('click', '.btn-toggle', function(e) {
      var checkbox = $(this).find("input[type=checkbox]");
      var other = $(this).parent().find($(this).hasClass("btn-yes") ? ".btn-no" : ".btn-yes");
      var ACTIONID = $(this).closest('tr').data('id');
      if ($(this).hasClass("active") && other.hasClass("inactive")) {
        //unselecting
        if (checkbox.val() === "no") {
          confirm.launchStandardModal("Disagree with " + disagreeText, "?", log.getAgreeReason(pathwayId, pathwayStage, standard, patientId, item), true, function() {
            log.editPatientAgree(pathwayId, pathwayStage, standard, patientId, item, false, log.reason.reasonText);
            confirm.wireUpAgreeDisagree(agreeDivSelector, log.getPatientAgreeObject(pathwayId, pathwayStage, standard, patientId, item));
            base.wireUpTooltips();
          }, null, function() {
            log.editPatientAgree(pathwayId, pathwayStage, standard, patientId, item, null, "");
            other.removeClass("inactive");
            checkbox.removeAttr("checked");
            checkbox.parent().removeClass("active");
            confirm.wireUpAgreeDisagree(agreeDivSelector, log.getPatientAgreeObject(pathwayId, pathwayStage, standard, patientId, item));
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.editPatientAgree(pathwayId, pathwayStage, standard, patientId, item, null);
          other.removeClass("inactive");
        }
      } else if (!$(this).hasClass("active") && other.hasClass("active")) {
        //prevent clicking on unselected option or if the row is complete
        e.stopPropagation();
        e.preventDefault();
        return;
      } else {
        //selecting
        var self = this;
        if (checkbox.val() === "no") {
          confirm.launchStandardModal("Disagree with " + disagreeText, "", "", false, function() {
            log.editPatientAgree(pathwayId, pathwayStage, standard, patientId, item, false, log.reason.reasonText);
            $(self).removeClass("inactive");
            checkbox.attr("checked", "checked");
            checkbox.parent().addClass("active");
            //unselect other
            other.removeClass("active").addClass("inactive");
            other.find("input[type=checkbox]").prop("checked", false);
            confirm.wireUpAgreeDisagree(agreeDivSelector, log.getPatientAgreeObject(pathwayId, pathwayStage, standard, patientId, item));
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.editPatientAgree(pathwayId, pathwayStage, standard, patientId, item, true);
          $(this).removeClass("inactive");

          //unselect other
          other.removeClass("active").addClass("inactive");
          other.find("input[type=checkbox]").prop("checked", false);
        }
      }
    });
  },

  wireUpAgreeDisagree: function(selector, agreeObject) {
    if (agreeObject.agree === true) {
      selector.children(':nth(0)').addClass('active');
      selector.children(':nth(1)').addClass('inactive');
      selector.children(':nth(0)').attr("title", confirm.getAgreeTooltip(agreeObject)).attr("data-original-title", confirm.getAgreeTooltip(agreeObject)).tooltip('fixTitle').tooltip('hide');
      selector.children(':nth(1)').attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
      selector.parent().addClass('success').removeClass('danger');
    } else if (agreeObject.agree === false) {
      selector.children(':nth(0)').addClass('inactive');
      selector.children(':nth(1)').addClass('active');
      selector.children(':nth(0)').attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
      selector.children(':nth(1)').attr("title", confirm.getDisgreeTooltip(agreeObject)).attr("data-original-title", confirm.getDisgreeTooltip(agreeObject)).tooltip('fixTitle').tooltip('hide');
      selector.parent().addClass('danger').removeClass('success');
    } else {
      selector.children(':nth(0)').attr("title", "Click to agree").attr("data-original-title", "Click to agree").tooltip('fixTitle').tooltip('hide');
      selector.children(':nth(1)').attr("title", "Click to disagree").attr("data-original-title", "Click to disagree").tooltip('fixTitle').tooltip('hide');
      selector.parent().removeClass('success').removeClass('danger');
    }
  },

  getAgreeTooltip: function(agreeObject) {
    return agreeObject.history[agreeObject.history.length - 1];
  },

  getDisgreeTooltip: function(agreeObject) {
    return agreeObject.history[agreeObject.history.length - 1] + " You said: " + agreeObject.reason;
  },

  launchStandardModal: function(header, value, reason, isUndo, callbackOnSave, callbackOnCancel, callbackOnUndo) {
    base.launchModal({
      "header": header,
      "isUndo": isUndo,
      "item": value,
      "placeholder": "Provide more information here..."
    }, null, value, reason, callbackOnSave, callbackOnCancel, callbackOnUndo);
  }

};

module.exports = confirm;

},{"../base.js":7,"../log.js":11}],17:[function(require,module,exports){
var base = require('../base.js'),
  data = require('../data.js'),
  chart = require('../chart.js'),
  patientList = require('./patientList.js');

var ID = "INDICATOR_BENCHMARK";

var iTrend = {

  show: function(panel, isAppend, pathwayId, pathwayStage, standard) {

    var elem = $("<div id='benchmark-chart' class='fit-to-scrolling-section-height'></div>");

    if (isAppend) panel.append(elem);
    else panel.html(elem);

    chart.drawBenchmarkChartHC("benchmark-chart", null);

  },

  wireUp: function() {

  }

};

module.exports = iTrend;

},{"../base.js":7,"../chart.js":8,"../data.js":9,"./patientList.js":25}],18:[function(require,module,exports){
var data = require('../data.js'),
  chart = require('../chart.js');

var bd = {

  wireUp: function() {

  },

  show: function(panel, isAppend, pathwayId, pathwayStage, standard, selectSeriesFn) {

    var indicators = data.getIndicatorDataSync([pathwayId, pathwayStage, standard].join("."));

    var dataObj = indicators.opportunities.map(function(opp) {
      var c = opp.values[0].slice();
      c.splice(0, 1, opp.name);
      return c;
    });

    dataObj.splice(0, 0, indicators.opportunities[0].values[1]);

    var elem = $("<div id='breakdown-chart'></div>");

    if (isAppend) panel.append(elem);
    else panel.html(elem);

    chart.drawAnalytics("breakdown-chart", dataObj, selectSeriesFn);

    bd.wireUp();

  }

};

module.exports = bd;

},{"../chart.js":8,"../data.js":9}],19:[function(require,module,exports){
var base = require('../base.js'),
  log = require('../log.js'),
  data = require('../data.js'),
  sparkline = require('jquery-sparkline'),
  Mustache = require('mustache');

var indicatorList = {

  show: function(panel, isAppend, loadContentFn) {
    data.getAllIndicatorData(function(indicators) {

      var tempMust = $('#overview-panel-table').html();
      var html = Mustache.render(tempMust, {
        "indicators": indicators
      });
      if (isAppend) {
        panel.append(html);
      } else {
        panel.html(html);
      }

      $('.inlinesparkline').sparkline('html', {
        tooltipFormatter: function(sparkline, options, fields) {
          return indicators[$('.inlinesparkline').index(sparkline.el)].dates[fields.x] + ": " + fields.y + "%";
        },
        width: "100px"
      });

      indicatorList.wireUp(panel, loadContentFn);

    });
  },

  populate: function() {

  },

  wireUp: function(panel, loadContentFn) {
    panel.off('click', 'tr.standard-row');
    panel.on('click', 'tr.standard-row', function(e) {
      var url = $(this).data("id").replace(/\./g, "/");
      history.pushState(null, null, '#indicators/' + url);
      loadContentFn('#indicators/' + url);
      // do not give a default action
      e.preventDefault();
      e.stopPropagation();
      return false;
    });
  }

};

module.exports = indicatorList;

},{"../base.js":7,"../data.js":9,"../log.js":11,"jquery-sparkline":3,"mustache":4}],20:[function(require,module,exports){
var base = require('../base.js'),
  data = require('../data.js'),
  chart = require('../chart.js'),
  patientList = require('./patientList.js');

var ID = "INDICATOR_TREND";

var iTrend = {

  show: function(panel, isAppend, pathwayId, pathwayStage, standard) {

    var indicators = data.getAllIndicatorDataSync();

    var elem = $("<div id='trend-chart' class='fit-to-scrolling-section-height'></div>");

    if (isAppend) panel.append(elem);
    else panel.html(elem);

    chart.drawPerformanceTrendChartHC("trend-chart", indicators.filter(function(v){
      return v.id===[pathwayId, pathwayStage, standard].join(".");
    })[0]);

  },

  wireUp: function() {

  }

};

module.exports = iTrend;

},{"../base.js":7,"../chart.js":8,"../data.js":9,"./patientList.js":25}],21:[function(require,module,exports){
var base = require('../base.js'),
  confirm = require('./confirm.js'),
  data = require('../data.js'),
  log = require('../log.js');

var iap = {

  create: function(pathwayStage) {
    return base.createPanel($('#individual-action-plan-panel'), {
      "pathwayStage": pathwayStage || "default",
      "noHeader": true
    });
  },

  show: function(panel, pathwayId, pathwayStage, standard, patientId) {
    panel.html(iap.create(pathwayStage));
    iap.wireUp(pathwayId, pathwayStage, standard, patientId);

    panel.find('div.fit-to-screen-height').niceScroll({
      cursoropacitymin: 0.3,
      cursorwidth: "7px",
      horizrailenabled: false
    });
  },

  wireUp: function(pathwayId, pathwayStage, standard, patientId) {
    individualTab = $('#tab-plan-individual');

    $('#advice-list').on('click', '.cr-styled input[type=checkbox]', function() {
      var ACTIONID = $(this).closest('tr').data('id');
      log.editAction(data.patientId, ACTIONID, null, this.checked);

      if (this.checked) {
        log.recordEvent(pathwayId, data.patientId, "Item completed");
        var self = this;
        $(self).parent().attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
        setTimeout(function(e) {
          $(self).parent().fadeOut(300, function() {
            var parent = $(this).parent();
            $(this).replaceWith(base.createPanel($('#checkbox-template'), {
              "done": true
            }));
            base.wireUpTooltips();
            parent.find('button').on('click', function() {
              ACTIONID = $(this).closest('tr').data('id');
              log.editAction(data.patientId, ACTIONID, null, false);
              $(this).replaceWith(base.createPanel($('#checkbox-template'), {
                "done": false
              }));
              iap.updateIndividualSapRows();
            });
          });
        }, 1000);
      }

      iap.updateIndividualSapRows();
    });

    $('#personalPlanIndividual').on('click', 'input[type=checkbox]', function() {
      var PLANID = $(this).closest('tr').data("id");
      log.editPlan(PLANID, null, this.checked);

      if (this.checked) {
        $(this).parent().parent().parent().addClass('success');
        log.recordEvent(pathwayId, data.patientId, "Personal plan item");
        var self = this;
        $(self).parent().attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
        setTimeout(function(e) {
          $(self).parent().fadeOut(300, function() {
            var parent = $(this).parent();
            $(this).replaceWith(base.createPanel($('#checkbox-template'), {
              "done": true
            }));
            base.wireUpTooltips();
            parent.find('button').on('click', function() {
              PLANID = $(this).closest('tr').data('id');
              log.editPlan(data.patientId, PLANID, null, false);
              $(this).replaceWith(base.createPanel($('#checkbox-template'), {
                "done": false
              }));
              iap.updateIndividualSapRows();
            });
          });
        }, 1000);
      }
    }).on('click', '.btn-undo', function(e) {
      var PLANID = $(this).closest('tr').data('id');
      log.editPlan(PLANID, null, false);
      $(this).replaceWith(base.createPanel($('#checkbox-template'), {
        "done": false
      }));
      iap.updateIndividualSapRows();
      e.stopPropagation();
    });

    individualTab.on('click', '.edit-plan', function() {
      var PLANID = $(this).closest('tr').data("id");

      $('#editActionPlanItem').val($($(this).closest('tr').children('td')[0]).find('span').text());

      $('#editPlan').off('hidden.bs.modal').on('hidden.bs.modal', function() {
        iap.displayPersonalisedIndividualActionPlan(data.patientId, $('#personalPlanIndividual'));
      }).off('shown.bs.modal').on('shown.bs.modal', function() {
        $('#editActionPlanItem').focus();
      }).off('click', '.save-plan').on('click', '.save-plan', function() {

        log.editPlan(PLANID, $('#editActionPlanItem').val());

        $('#editPlan').modal('hide');
      }).off('keyup', '#editActionPlanItem').on('keyup', '#editActionPlanItem', function(e) {
        if (e.which === 13) $('#editPlan .save-plan').click();
      }).modal();
    }).on('click', '.delete-plan', function() {
      var PLANID = $(this).closest('tr').data("id");

      $('#individual-delete-item').html($($(this).closest('tr').children('td')[0]).find('span').text());

      $('#deletePlan').off('hidden.bs.modal').on('hidden.bs.modal', function() {
        iap.displayPersonalisedIndividualActionPlan(data.patientId, $('#personalPlanIndividual'));
      }).off('click', '.delete-plan').on('click', '.delete-plan', function() {
        log.deletePlan(PLANID);

        $('#deletePlan').modal('hide');
      }).modal();
    }).on('click', '.add-plan', function() {
      log.recordPlan(data.patientId, $(this).parent().parent().find('textarea').val(), pathwayId);

      iap.displayPersonalisedIndividualActionPlan(data.patientId, $('#personalPlanIndividual'));
    }).on('change', '.btn-toggle input[type=checkbox]', function() {
      iap.updateIndividualSapRows();
    }).on('click', '.btn-undo', function(e) {
      var ACTIONID = $(this).closest('tr').data('id');
      log.editAction(data.patientId, ACTIONID, null, false);
      $(this).replaceWith(base.createPanel($('#checkbox-template'), {
        "done": false
      }));
      iap.updateIndividualSapRows();
    }).on('click', '.btn-yes,.btn-no', function(e) {
      var checkbox = $(this).find("input[type=checkbox]");
      var other = $(this).parent().find($(this).hasClass("btn-yes") ? ".btn-no" : ".btn-yes");
      var ACTIONID = $(this).closest('tr').data('id');
      if ($(this).hasClass("active") && other.hasClass("inactive") && !$(this).closest('tr').hasClass('success')) {
        //unselecting
        if (checkbox.val() === "no") {
          iap.launchModal(data.selected, checkbox.closest('tr').children().first().children().first().text(), log.getReason(data.patientId, ACTIONID), true, function() {
            log.editAction(data.patientId, ACTIONID, false, null, log.reason);
            iap.updateIndividualSapRows();
            base.wireUpTooltips();
          }, null, function() {
            log.ignoreAction(data.patientId, ACTIONID);
            other.removeClass("inactive");
            checkbox.removeAttr("checked");
            checkbox.parent().removeClass("active");
            iap.updateIndividualSapRows();
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.ignoreAction(data.patientId, ACTIONID);
          other.removeClass("inactive");
        }
      } else if ((!$(this).hasClass("active") && other.hasClass("active")) || $(this).closest('tr').hasClass('success')) {
        //prevent clicking on unselected option or if the row is complete
        e.stopPropagation();
        e.preventDefault();
        return;
      } else {
        //selecting
        var self = this;
        if (checkbox.val() === "no") {
          iap.launchModal(data.selected, checkbox.closest('tr').children().first().children().first().text(), log.getReason(data.patientId, ACTIONID), false, function() {
            log.editAction(data.patientId, ACTIONID, false, null, log.reason);
            $(self).removeClass("inactive");

            checkbox.attr("checked", "checked");
            checkbox.parent().addClass("active");
            //unselect other
            other.removeClass("active").addClass("inactive");
            other.find("input[type=checkbox]").prop("checked", false);
            iap.updateIndividualSapRows();
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.editAction(data.patientId, ACTIONID, true);
          $(this).removeClass("inactive");

          //unselect other
          other.removeClass("active").addClass("inactive");
          other.find("input[type=checkbox]").prop("checked", false);
        }
      }
    }).on('keyup', 'input[type=text]', function(e) {
      if (e.which === 13) {
        individualTab.find('.add-plan').click();
      }
    });

    iap.populateIndividualSuggestedActions(patientId, pathwayId, pathwayStage, standard);
  },

  updateIndividualSapRows: function() {
    $('#advice-list').add('#personalPlanIndividual').find('.suggestion').each(function() {
      $(this).find('td').last().children().hide();
    });

    $('#advice-list').add('#personalPlanIndividual').find('.cr-styled input[type=checkbox]').each(function() {
      if (this.checked) {
        $(this).parent().parent().parent().addClass('success');
      } else {
        $(this).parent().parent().parent().removeClass('success');
      }
    });

    $('#advice-list').add('#personalPlanIndividual').find('.btn-undo').each(function() {
      $(this).parent().parent().addClass('success');
    });

    //no class - user not yet agreed/disagreed - no background / muted text
    //active - user agrees - green background / normal text
    //success - user completed - green background / strikethrough text
    //danger - user disagrees - red background / strikethrough text

    $('#advice-list').add('#personalPlanIndividual').find('tr').each(function() {
      var self = $(this);
      var any = false;
      self.find('.btn-toggle input[type=checkbox]:checked').each(function() {
        any = true;
        if (this.value === "yes") {
          self.removeClass('danger');
          self.addClass('active');
          self.find('td').last().children().show();
          if (log.getActions()[data.patientId][self.data("id")].history) {
            var tool = $(this).closest('tr').hasClass('success') ? "" : "<p>" + log.getActions()[data.patientId][self.data("id")].history[0] + "</p><p>Click again to cancel</p>";
            $(this).parent().attr("title", tool).attr("data-original-title", tool).tooltip('fixTitle').tooltip('hide');
          } else {
            $(this).parent().attr("title", "You agreed - click again to cancel").tooltip('fixTitle').tooltip('hide');
          }
        } else {
          self.removeClass('active');
          self.addClass('danger');
          self.removeClass('success');
          if (log.getActions()[data.patientId][self.data("id")] && log.getActions()[data.patientId][self.data("id")].history) {
            $(this).parent().attr("title", "<p>" + log.getActions()[data.patientId][self.data("id")].history[0] + "</p><p>Click again to edit/cancel</p>").tooltip('fixTitle').tooltip('hide');
          } else {
            $(this).parent().attr("title", "You disagreed - click again to edit/cancel").tooltip('fixTitle').tooltip('hide');
          }
        }
      });
      if (self.find('.btn-toggle input[type=checkbox]:not(:checked)').length == 1) {
        self.find('.btn-toggle input[type=checkbox]:not(:checked)').parent().addClass("inactive").attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
      }
      if (!any) {
        self.removeClass('danger');
        self.removeClass('active');
        self.removeClass('success');

        self.find('.btn-toggle.btn-yes').attr("title", "Click to agree with this action and save it in your agreed actions list  ").tooltip('fixTitle').tooltip('hide');
        self.find('.btn-toggle.btn-no').attr("title", "Click to disagree with this action and remove it from your suggested actions list ").tooltip('fixTitle').tooltip('hide');
      }

      base.wireUpTooltips();
    });
    base.wireUpTooltips();
  },

  displayPersonalisedIndividualActionPlan: function(id, parentElem) {
    var plans = base.sortSuggestions(base.addDisagreePersonalTeam(log.listPlans(id)));

    base.createPanelShow(actionPlanList, parentElem, {
      "hasSuggestions": plans && plans.length > 0,
      "suggestions": plans
    }, {
      "action-plan": $('#action-plan').html(),
      "action-plan-item": $('#action-plan-item').html(),
      "chk": $('#checkbox-template').html()
    });

    iap.updateIndividualSapRows();
  },

  populateIndividualSuggestedActions: function(patientId, pathwayId, pathwayStage, standard) {
    var localData = {
      "nhsNumber": data.patLookup ? data.patLookup[patientId] : patientId,
      "patientId": patientId
    };
    var breaches = data.patients[patientId].breach ? data.patients[patientId].breach.filter(function(v) {
      return v.pathwayId === pathwayId && v.pathwayStage === pathwayStage && v.standard === standard;
    }) : [];

    var fn = function(val) {
      return {
        "id": val,
        "subsection": subsection
      };
    };

    if (breaches.length === 0) {
      localData.noSuggestions = true;
    } else {
      var suggestions = [],
        subsection = "";
      for (var i = 0; i < breaches.length; i++) {
        subsection = breaches[i].subsection;
        suggestions = suggestions.concat(data[pathwayId][pathwayStage].bdown[subsection].suggestions ?
          data[pathwayId][pathwayStage].bdown[subsection].suggestions.map(fn) : []);
      }

      localData.suggestions = base.sortSuggestions(base.mergeIndividualStuff(base.suggestionList(suggestions), patientId));
      localData.section = {
        "name": data[pathwayId][pathwayStage].bdown[subsection].name,
        "agree": log.getPatientAgree(pathwayId, pathwayStage, patientId, "section") === true,
        "disagree": log.getPatientAgree(pathwayId, pathwayStage, patientId, "section") === false,
      };
      localData.category = {
        "name": data.patients[patientId].category,
        "agree": log.getPatientAgree(pathwayId, pathwayStage, patientId, "category") === true,
        "disagree": log.getPatientAgree(pathwayId, pathwayStage, patientId, "category") === false,
      };
    }

    $('#advice-placeholder').hide();
    $('#advice').show();

    base.createPanelShow(individualPanel, $('#advice-list'), localData, {
      "chk": $('#checkbox-template').html()
    });

    //Wire up any clipboard stuff in the suggestions
    $('#advice-list').find('span:contains("[COPY")').each(function() {
      var html = $(this).html();
      $(this).html(html.replace(/\[COPY:([^\]]*)\]/g, '$1 <button type="button" data-clipboard-text="$1" data-content="Copied" data-toggle="tooltip" data-placement="top" title="Copy $1 to clipboard." class="btn btn-xs btn-default btn-copy"><span class="fa fa-clipboard"></span></button>'));
    });

    $('#advice-list').find('span:contains("[INFO")').each(function() {
      var html = $(this).html();
      var subsection = $(this).data().subsection;
      var desc = data[pathwayId][pathwayStage].standards[standard].opportunities.filter(function(val) {
          return val.name === subsection;
        }).length > 0 ?
        data[pathwayId][pathwayStage].standards[standard].opportunities.filter(function(val) {
          return val.name === subsection;
        })[0].desc : subsection;
      var tooltip = subsection ? "This action is suggested because PINGR classified this patient as:'" + desc + "'" : '';
      var newHtml = ' <i class="fa fa-info-circle fa-lg info-button clickable" data-toggle="tooltip" data-placement="right" title="' + tooltip + '"></i>';
      $(this).html(html.replace(/\[INFO\]/g, newHtml));
    });

    $('#advice-list').find('span:contains("[MED-SUGGESTION")').each(function() {
      var html = $(this).html();
      var suggestion = Math.random() < 0.33 ? "Increase Ramipril to 10mg per day" : (Math.random() < 0.5 ? "Consider adding an ACE inhibior" : "Consider adding a thiazide-like diuretic");
      $(this).html(html.replace(/\[MED\-SUGGESTION\]/g, suggestion));
    });


    base.setupClipboard($('.btn-copy'), true);

    iap.displayPersonalisedIndividualActionPlan(patientId, $('#personalPlanIndividual'));
  },

  launchModal: function(label, value, reason, isUndo, callbackOnSave, callbackOnCancel, callbackOnUndo) {
    var reasons = [{
      "reason": "Already done this",
      "value": "done"
    }, {
      "reason": "Wouldn't work",
      "value": "nowork"
    }, {
      "reason": "Something else",
      "value": "else"
    }];
    if (reason && reason.reason) {
      for (var i = 0; i < reasons.length; i++) {
        if (reasons[i].reason === reason.reason) {
          reasons[i].checked = true;
          break;
        }
      }
    }
    base.launchModal({
      "header": "Disagree with a suggested action",
      "isUndo": isUndo,
      "item": value,
      "placeholder": "Provide more information here...",
      "reasons": reasons
    }, label, value, reason ? reason.reasonText : null, callbackOnSave, callbackOnCancel, callbackOnUndo);
  }

};

module.exports = iap;

},{"../base.js":7,"../data.js":9,"../log.js":11,"./confirm.js":16}],22:[function(require,module,exports){
var Highcharts = require('highcharts/highstock'),
  base = require('../base.js');
require('highcharts/highcharts-more')(Highcharts);

var ID = "LIFELINE";

var colour = {
  index: 0,
  next: function() {
    if (this.index >= Highcharts.getOptions().colors.length) this.index = 0;
    return Highcharts.getOptions().colors[this.index++];
  },
  reset: function() {
    this.index = 0;
  }
};

var ll = {
  chartArray: [],

  destroy: function(elementId) {
    $(elementId).html('');
    $(elementId).off('mousemove touchmove touchstart', '.sync-chart');

    for (var i = 0; i < Highcharts.charts.length; i++) {
      if (Highcharts.charts[i] && Highcharts.charts[i].renderTo.className.indexOf("h-chart") > -1) Highcharts.charts[i].destroy();
    }
  },

  show: function(panel, isAppend, patientId, data) {


    var element = 'lifeline-chart';
    var elementId = '#' + element;

    ll.destroy(elementId);

    if(isAppend) panel.append($('<div id="' + element + '"></div>'));
    else panel.html($('<div id="' + element + '"></div>'));

    colour.reset();
    /**
     * In order to synchronize tooltips and crosshairs, override the
     * built-in events with handlers defined on the parent element.
     */

    $(elementId).on('mousemove touchmove touchstart', '.sync-chart', function(e) {
      var chart, point, i, event, series;

      for (i = 1; i < ll.chartArray.length - 2; i = i + 1) {
        chart = ll.chartArray[i];
        event = chart.pointer.normalize(e.originalEvent); // Find coordinates within the chart
        //if (i === 0) console.log(event.chartX + " --- " + event.chartY);
        series = i === 0 ? Math.max(Math.min(Math.floor((130 - event.chartY) / 34), chart.series.length - 1), 0) : 0;
        point = chart.series[series].searchPoint(event, true); // Get the hovered point

        if (point) {
          point.onMouseOver(); // Show the hover marker
          chart.tooltip.refresh(point); // Show the tooltip
          chart.xAxis[0].drawCrosshair(event, point); // Show the crosshair
        }
      }
    });
    /**
     * Override the reset function, we don't need to hide the tooltips and crosshairs.
     */
    /*Highcharts.Pointer.prototype.reset = function() {
      return undefined;
    };*/

    /**
     * Synchronize zooming through the setExtremes event handler.
     */
    function syncExtremes(e) {
      var thisChart = this.chart;

      if (e.trigger !== 'syncExtremes') { // Prevent feedback loop
        Highcharts.each(ll.chartArray, function(chart) {
          if (chart !== thisChart) {
            if (chart.inverted) {
              if (chart.yAxis[0].setExtremes) { // It is null while updating
                chart.yAxis[0].setExtremes(e.min, e.max, undefined, false, {
                  trigger: 'syncExtremes'
                });
              }
            } else {
              if (chart.xAxis[0].setExtremes) { // It is null while updating
                chart.xAxis[0].setExtremes(e.min, e.max, undefined, false, {
                  trigger: 'syncExtremes'
                });
              }
            }
          }
        });
      }
    }


    var plotConditions = function(conditions, contacts) {
      var series = [];
      $.each(conditions.reverse(), function(i, task) {
        var item = {
          name: task.name,
          data: [],
          color: colour.next()
        };
        $.each(task.intervals, function(j, interval) {
          item.data.push([i + 0.49, interval.from, interval.to]);
        });

        series.push(item);
      });

      var markers = {
        "Face to face": {
          "symbol": "square",
          "lineWidth": 1,
          "lineColor": "black",
          "radius": 8
        },
        "Telephone": {
          "symbol": "circle",
          "lineWidth": 1,
          "lineColor": "black",
          "radius": 8
        },
        "Hospital admission": {
          "symbol": "triangle",
          "lineWidth": 1,
          "lineColor": "black",
          "radius": 8
        }
      };
      var contactSeries = {};
      $.each(contacts, function(i, contact) {
        if (!contactSeries[contact.name]) {
          contactSeries[contact.name] = Highcharts.extend(contact, {
            data: [],
            type: 'scatter',
            marker: markers[contact.name],
            color: colour.next()
          });
        }
        contactSeries[contact.name].data.push([
              contact.task,
              contact.time
          ]);
      });

      series = series.concat(Object.keys(contactSeries).map(function(key) {
        return contactSeries[key];
      }));

      // create the chart
      $('<div class="h-chart h-condition-chart">')
        .appendTo(elementId)
        .highcharts({

          chart: {
            renderTo: element,
            marginLeft: 40, // Keep all charts left aligned
            spacingTop: 20,
            spacingBottom: 20,
            type: 'columnrange',
            inverted: true
          },

          title: {
            text: ''
          },


          yAxis: {
            type: 'datetime',
            min: Date.UTC(2013, 6, 12),
            max: Date.UTC(2016, 3, 5),
            crosshair: true,
            events: {
              setExtremes: syncExtremes
            },
            labels: {
              enabled: false
            },

            //things that are normally xAxis defaults
            endOnTick: false,
            gridLineWidth: 0,
            lineWidth: 1,
            maxPadding: 0.01,
            minPadding: 0.01,
            startOnTick: false,
            tickWidth: 0,
            title: {
              text: ''
            },
            tickPixelInterval: 100
          },

          xAxis: {
            labels: {
              enabled: false
            },
            startOnTick: false,
            endOnTick: false,
            title: {
              text: ''
            },
            tickWidth: 0,
            minPadding: 0.2,
            maxPadding: 0.2,

            //things that are normally yAxis defaults
            gridLineWidth: 0,
            lineWidth: 0

          },
          credits: {
            enabled: false
          },

          legend: {
            enabled: false
          },

          tooltip: {
            formatter: function() {
              if (this.series.data[0].x !== 1) {
                //Range ergo condition
                var yCoord = this.y;
                var label = conditions[Math.floor(this.x)].intervals.filter(function(v) {
                  return yCoord >= v.from && yCoord <= v.to;
                })[0].label;
                return '<b>' + conditions[Math.floor(this.x)].name + (label ? ': ' + label : '') + '</b><br/>' +
                  Highcharts.dateFormat('%Y:%m:%d', this.point.options.low) +
                  ' - ' + Highcharts.dateFormat('%Y:%m:%d', this.point.options.high);
              } else {
                //Single value hence contact
                var time = this.y;
                return contacts.filter(function(val) {
                  return val.data && val.data.filter(function(v) {
                    return v[1] === time;
                  }).length > 0;
                }).map(function(val) {
                  return '<b>' + val.name + '</b><br/>' + Highcharts.dateFormat('%Y:%m:%d', val.time);
                }).join('<br/>');
              }
            },
            followPointer: true
          },

          plotOptions: {
            columnrange: {
              grouping: false,
              groupPadding: 0.3,
              dataLabels: {
                allowOverlap: true,
                enabled: true,
                formatter: function() {
                  var yCoord = this.y;
                  var idx = -1;
                  var label = conditions[Math.floor(this.x)].intervals.filter(function(v, i) {
                    if (yCoord >= v.from && yCoord <= v.to) {
                      idx = i;
                      return true;
                    }
                    return false;
                  })[0].label;
                  return this.y === this.point.low &&
                    (conditions[Math.floor(this.x)].intervals.length - 1 === idx ||
                      (this.series.chart.yAxis[0].min <= yCoord && this.series.chart.yAxis[0].max >= yCoord) ||
                      (this.series.chart.yAxis[0].min >= this.point.low && this.series.chart.yAxis[0].max <= this.point.high)) ? conditions[Math.floor(this.x)].name + (label ? ': ' + label : '') : '';
                }
              }
            }
          },
          /*plotOptions: {
            line: {
              lineWidth: 9,
              marker: {
                enabled: false
              },
              dataLabels: {
                enabled: true,
                align: 'left',
                formatter: function() {
                  return this.point.options && this.point.options.label;
                }
              }
            }
          },*/

          series: series

        });
    };

    var plotMeasurements = function(measurements) {
      $.each(measurements.datasets, function(i, dataset) {

        // Add X values
        if (dataset.data && typeof dataset.data[0] !== "object") {
          dataset.data = Highcharts.map(dataset.data, function(val, j) {
            return [measurements.xData[j], val];
          });
        }

        var chartOptions = {
          chart: {
            marginLeft: 40, // Keep all charts left aligned
            spacingTop: 0,
            spacingBottom: 8,
          },
          title: {
            text: '',
            align: 'left',
            margin: 0,
            x: 30
          },
          credits: {
            enabled: false
          },
          legend: {
            enabled: false
          },
          xAxis: {
            type: 'datetime',
            min: Date.UTC(2013, 6, 12),
            max: Date.UTC(2016, 3, 5),
            crosshair: {
              snap: false
            },
            events: {
              setExtremes: syncExtremes
            },
            labels: {
              enabled: false
            },
            lineWidth: 0,
            minorGridLineWidth: 0,
            lineColor: 'transparent',
            minorTickLength: 0,
            tickLength: 0
          },
          yAxis: {
            title: {
              text: null
            },
            startOnTick: false,
            endOnTick: false,
            labels: {
              style: {
                "textOverflow": "none"
              }
            },
            tickPixelInterval: 25,
            maxPadding: 0.1,
            minPadding: 0.1
          },
          tooltip: {
            positioner: function(labelWidth, labelHeight, point) {
              return {
                x: Math.max(50, point.plotX - labelWidth), // left aligned
                y: -1 // align to title
              };
            },
            borderWidth: 0,
            backgroundColor: 'rgba(252, 255, 197, 0.65)',
            pointFormat: '<b>' + dataset.name + ':</b> {point.y} ' + dataset.unit,
            headerFormat: '',
            shadow: true,
            style: {
              fontSize: '18px'
            },
            valueDecimals: dataset.valueDecimals
          },
          plotOptions:{
            series: {
                events: {
                    mouseOut: function () {
                      var chart,i;
                      for (i = 1; i < ll.chartArray.length - 2; i = i + 1) {
                        chart = ll.chartArray[i];
                        chart.tooltip.hide();
                      }
                    }
                }
            }
          },
          series: [{
            data: dataset.data,
            name: dataset.name,
            type: dataset.type,
            color: colour.next(),
            fillOpacity: 0.3
            }]
        };

        if (dataset.name === "Blood pressure") {
          chartOptions.tooltip.pointFormat = "<b>BP:</b> {point.low}/{point.high} mmHg<br/>";
          //chartOptions.series[0].tooltip = {};
          chartOptions.series[0].stemWidth = 3;
          chartOptions.series[0].whiskerWidth = 5;
        }

        /*if (i === measurements.datasets.length - 1) {
          chartOptions.xAxis = {
            crosshair: true,
            events: {
              setExtremes: syncExtremes
            },
            type: 'datetime'
          };
        }*/
        $('<div class="sync-chart h-chart' + (i === measurements.datasets.length - 1 ? " h-last-measurement-chart" : "") + '">')
          .appendTo(elementId)
          .highcharts(chartOptions);

      });
    };

    var plotNavigator = function() {
      var chart = $('<div class="h-chart h-navigator-chart">')
        .appendTo(elementId)
        .highcharts({

          chart: {
            renderTo: element,
            marginLeft: 40, // Keep all charts left aligned
            spacingTop: 20,
            spacingBottom: 20,
            ignoreHiddenSeries: false
          },

          title: {
            text: ''
          },

          xAxis: {
            type: 'datetime',
            min: Date.UTC(2013, 6, 12),
            max: Date.UTC(2016, 3, 5),
            crosshair: false,
            events: {
              setExtremes: syncExtremes
            },
            labels: {
              enabled: false
            },
            lineWidth: 0,
            minorGridLineWidth: 0,
            lineColor: 'transparent',
            minorTickLength: 0,
            tickLength: 0
          },

          yAxis: {
            min: 0,
            max: 1,
            tickInterval: 1,
            startOnTick: false,
            endOnTick: false,
            title: {
              text: ''
            },
            minPadding: 0.2,
            maxPadding: 0.2,
            labels: {
              enabled: false
            }
          },

          legend: {
            enabled: false
          },

          navigator: {
            enabled: true
          },

          plotOptions: {
            line: {
              lineWidth: 0,
              marker: {
                enabled: false
              },
              dataLabels: {
                enabled: false
              }
            }
          },

          series: [{
            "name": "HTN",
            "data": [{
              "x": 1373587200000,
              "y": 0,
              "from": 1373587200000,
              "to": 1459814400000
              }]
            }]

        });
      chart.highcharts().series[0].hide();
    };

    var plotMedications = function(medications) {
      var series = [];
      $.each(medications.reverse(), function(i, task) {
        var item = {
          name: task.name,
          data: [],
          color: colour.next()
        };
        $.each(task.intervals, function(j, interval) {
          item.data.push([i + 0.49, interval.from, interval.to]);
        });

        series.push(item);
      });

      // create the chart
      return $('<div class="h-chart h-condition-chart">')
        .appendTo(elementId)
        .highcharts({

          chart: {
            renderTo: element,
            marginLeft: 40, // Keep all charts left aligned
            spacingTop: 20,
            spacingBottom: 20,
            type: 'columnrange',
            inverted: true
          },

          title: {
            text: ''
          },


          yAxis: {
            type: 'datetime',
            min: Date.UTC(2013, 6, 12),
            max: Date.UTC(2016, 3, 5),
            crosshair: {
              snap: false
            },
            events: {
              setExtremes: syncExtremes
            },



            //things that are normally xAxis defaults
            endOnTick: false,
            gridLineWidth: 0,
            lineWidth: 1,
            maxPadding: 0.01,
            minPadding: 0.01,
            startOnTick: false,
            tickWidth: 1,
            title: {
              text: ''
            },
            tickPixelInterval: 100
          },

          xAxis: {
            labels: {
              enabled: false
            },
            startOnTick: false,
            endOnTick: false,
            title: {
              text: ''
            },
            tickWidth: 0,
            minPadding: 0.2,
            maxPadding: 0.2,

            //things that are normally yAxis defaults
            gridLineWidth: 0,
            lineWidth: 0
          },
          credits: {
            enabled: false
          },

          legend: {
            enabled: false
          },

          tooltip: {
            formatter: function() {
              var yCoord = this.y;
              var label = medications[Math.floor(this.x)].intervals.filter(function(v) {
                return yCoord >= v.from && yCoord <= v.to;
              })[0].label;
              return '<b>' + medications[Math.floor(this.x)].name + (label ? ': ' + label : '') + '</b><br/>' +
                Highcharts.dateFormat('%Y:%m:%d', this.point.options.low) +
                ' - ' + Highcharts.dateFormat('%Y:%m:%d', this.point.options.high);
            },
            followPointer: true
          },

          plotOptions: {
            columnrange: {
              grouping: false,
              dataLabels: {
                allowOverlap: true,
                enabled: true,
                formatter: function() {
                  var yCoord = this.y;
                  var idx = -1;
                  var label = medications[Math.floor(this.x)].intervals.filter(function(v, i) {
                    if (yCoord >= v.from && yCoord <= v.to) {
                      idx = i;
                      return true;
                    }
                    return false;
                  })[0].label;
                  return this.y === this.point.low &&
                    (medications[Math.floor(this.x)].intervals.length - 1 === idx ||
                      (this.series.chart.yAxis[0].min <= yCoord && this.series.chart.yAxis[0].max >= yCoord) ||
                      (this.series.chart.yAxis[0].min >= this.point.low && this.series.chart.yAxis[0].max <= this.point.high)) ? medications[Math.floor(this.x)].name + (label ? ': ' + label : '') : '';
                }
              }
            }
          },

          series: series

        });
    };

    plotConditions(data.conditions, data.contacts);
    plotMeasurements(data.measurements);
    var c = plotMedications(data.medications);
    plotNavigator();
    c.highcharts().axes[1].setExtremes(1434864000000, 1459814400000, undefined, false, {
      trigger: 'syncExtremes'
    });

    ll.chartArray = Highcharts.charts.slice(Highcharts.charts.length - 6, Highcharts.charts.length);

    var s = syncExtremes.bind(c.highcharts().series[0]);
    s({
      trigger: 'navigator',
      min: 1434864000000,
      max: 1459814400000
    });
  }

};

module.exports = ll;

},{"../base.js":7,"highcharts/highcharts-more":1,"highcharts/highstock":2}],23:[function(require,module,exports){
var base = require('../base.js'),
  confirm = require('./confirm.js'),
  data = require('../data.js'),
  log = require('../log.js');

var med = {

  create: function(pathwayId, pathwayStage, standard, patientId) {
    var medications = data.patients[patientId].medications || [];
    var agree = log.getPatientAgreeObject(pathwayId, pathwayStage, standard, patientId, "medication");
    return base.createPanel(medicationPanel, {
      "areMedications": medications.length > 0,
      "agree": agree && agree.agree,
      "disagree": agree && agree.agree === false,
      "pathway": data.pathwayNames[pathwayId],
      "medications": medications,
      "pathwayStage": pathwayStage
    }, {
      "medicationRow": $('#medication-row').html()
    });
  },

  wireUp: function(pathwayId, pathwayStage, standard, patientId) {
    confirm.wireUp($('#medication-agree-disagree'), $('#medication-panel'), pathwayId, pathwayStage, standard, patientId, "medication", "medication data");
  }

};

module.exports = med;

},{"../base.js":7,"../data.js":9,"../log.js":11,"./confirm.js":16}],24:[function(require,module,exports){
var base = require('../base.js'),
  confirm = require('./confirm.js'),
  data = require('../data.js'),
  log = require('../log.js');

var other = {

  create: function(pathwayId, pathwayStage, standard, patientId) {
    var codes = (data.patients[patientId].codes || []).map(function(val) {
      val.description = data.codes[val.code];
      return val;
    });
    var agree = log.getPatientAgreeObject(pathwayId, pathwayStage, standard, patientId, "codes");
    return base.createPanel($('#other-codes-panel'), {
      "areCodes": codes.length > 0,
      "agree": agree && agree.agree,
      "disagree": agree && agree.agree === false,
      "pathway": data.pathwayNames[pathwayId],
      "standard": data[pathwayId][pathwayStage].standards[standard].tab.title,
      "codes": codes,
      "pathwayStage": pathwayStage
    }, {
      "codeRow": $('#other-codes-row').html()
    });
  },

  wireUp: function(pathwayId, pathwayStage, standard, patientId) {
    confirm.wireUp($('#other-codes-agree-disagree'), $('#other-codes-panel'), pathwayId, pathwayStage, standard, patientId, "codes", "other codes");
  }

};

module.exports = other;

},{"../base.js":7,"../data.js":9,"../log.js":11,"./confirm.js":16}],25:[function(require,module,exports){
var Highcharts = require('highcharts/highstock'),
  base = require('../base.js'),
  data = require('../data.js'),
  lookup = require('../lookup.js'),
  Mustache = require('mustache');

var ID = "PATIENT_LIST";

var pl = {

  wireUp: function(onPatientSelected) {
    patientsPanel = $('#patients');

    patientsPanel.on('click', 'thead tr th.sortable', function() { //Sort columns when column header clicked
      var sortAsc = !$(this).hasClass('sort-asc');
      if (sortAsc) {
        $(this).removeClass('sort-desc').addClass('sort-asc');
      } else {
        $(this).removeClass('sort-asc').addClass('sort-desc');
      }
      pl.populate(pl.state[0], pl.state[1], pl.state[2], pl.state[3], $(this).index(), sortAsc);
    }).on('click', 'tbody tr', function(e) { //Select individual patient when row clicked#
      var callback = onPatientSelected.bind(this);
      var patientId = $(this).find('td button').attr('data-patient-id');
      callback(patientId);
      e.preventDefault();
      e.stopPropagation();
    }).on('click', 'tbody tr button', function(e) {
      //don't want row selected if just button pressed?
      e.preventDefault();
      e.stopPropagation();
    });
  },

  selectSubsection: function(section) {
    pl.populate(pl.state[0], pl.state[1], pl.state[2], section, pl.state[4], pl.state[5]);
  },

  populate: function(pathwayId, pathwayStage, standard, subsection, sortField, sortAsc) {
    pl.state = [pathwayId, pathwayStage, standard, subsection, sortField, sortAsc];
    patientsPanel = $('#patients');
    //Remove scroll if exists
    patientsPanel.find('div.table-scroll').getNiceScroll().remove();

    var i, k, prop, header, pList = [];

    data.getIndicatorData([pathwayId, pathwayStage, standard].join("."), function(indicators) {

      if (pathwayId && pathwayStage && standard && subsection) {
        pList = indicators.opportunities.filter(function(val) {
          return val.name === subsection;
        })[0].patients;
        header = indicators.opportunities.filter(function(val) {
          return val.name === subsection;
        })[0].description;
      } else if (pathwayId && pathwayStage && standard) {
        pList = indicators.opportunities.reduce(function(a, b) {
          return a.patients ? a.patients.concat(b.patients) : a.concat(b.patients);
        });
        header = data[pathwayId][pathwayStage].standards[standard].tableTitle;
      }

      pList = data.removeDuplicates(pList);
      var patients = pList.map(function(patientId) {
        var ret = indicators.patients[patientId];
        ret.nhsNumber = data.patLookup ? data.patLookup[patientId] : patientId;
        ret.patientId = patientId;
        ret.items = []; //The fields in the patient list table
        if (ret[data[pathwayId][pathwayStage].standards[standard].valueId]) {
          if (data[pathwayId][pathwayStage].standards[standard].dateORvalue === "date") {
            ret.items.push(ret[data[pathwayId][pathwayStage].standards[standard].valueId].date);
          } else {
            ret.items.push(ret[data[pathwayId][pathwayStage].standards[standard].valueId].value);
          }
        } else {
          ret.items.push("?");
        }
        ret.items.push(ret.opportunities.map(function(v){return '<span style="width:13px;height:13px;float:left;background-color:' + Highcharts.getOptions().colors[v] + '"></span>';}).join(""));
        ret.items.push(data.numberOfStandardsMissed(patientId));
        return ret;
      });

      var localData = {
        "patients": patients,
        "n": patients.length,
        "header": header,
        "header-items": [{
          "title": "NHS no.",
          "isSorted": false,
          "direction": "sort-asc",
          "tooltip": "NHS number of each patient"
        }]
      };

      //middle column is either value or date
      if (data[pathwayId][pathwayStage].standards[standard].dateORvalue) {
        localData["header-items"].push({
          "title": data[pathwayId][pathwayStage].standards[standard].valueName,
          "tooltip": data[pathwayId][pathwayStage].standards[standard].dateORvalue === "date" ? "Last date " + data[pathwayId][pathwayStage].standards[standard].value + " was measured" : "Last " + data[pathwayId][pathwayStage].standards[standard].value + " reading",
          "isSorted": false,
          "direction": "sort-asc"
        });
      } else {
        if (pathwayStage === lookup.categories.monitoring.name) {
          localData["header-items"].push({
            "title": "Last BP Date",
            "isSorted": false,
            "direction": "sort-asc",
            "tooltip": "Last date BP was measured"
          });
        } else {
          localData["header-items"].push({
            "title": "Last SBP",
            "tooltip": "Last systolic BP reading",
            "isSorted": false,
            "direction": "sort-asc"
          });
        }
      }

      //add qual standard column
      localData["header-items"].push({
        "title": "Categories",
        "titleHTML": 'tba',
        "isUnSortable": true,
        "tooltip": "Categories from above chart"
      });
      //add qual standard column
      localData["header-items"].push({
        "title": "All Opportunities",
        "titleHTML": '# of <i class="fa fa-flag" style="color:red"></i>',
        "isSorted": true,
        "direction": "sort-desc",
        "tooltip": "Total number of improvement opportunities available across all conditions"
      });

      if (sortField === undefined) sortField = 2;
      if (sortField !== undefined) {
        localData.patients.sort(function(a, b) {
          if (sortField === 0) { //NHS number
            if (a.nhsNumber === b.nhsNumber) {
              return 0;
            }

            if (a.nhsNumber > b.nhsNumber) {
              return sortAsc ? 1 : -1;
            } else if (a.nhsNumber < b.nhsNumber) {
              return sortAsc ? -1 : 1;
            }
          } else {
            if (a.items[sortField - 1] === b.items[sortField - 1]) {
              return 0;
            }

            if (a.items[sortField - 1] == "?") return 1;
            if (b.items[sortField - 1] == "?") return -1;

            var A = Number(a.items[sortField - 1]);
            var B = Number(b.items[sortField - 1]);
            if (isNaN(A) || isNaN(B)) {
              A = a.items[sortField - 1];
              B = b.items[sortField - 1];
            }
            if (A > B) {
              return sortAsc ? 1 : -1;
            } else if (A < B) {
              return sortAsc ? -1 : 1;
            }
          }
        });

        for (i = 0; i < localData["header-items"].length; i++) {
          if (i === sortField) {
            localData["header-items"][i].direction = sortAsc ? "sort-asc" : "sort-desc";
            localData["header-items"][i].isAsc = sortAsc;
            localData["header-items"][i].isSorted = true;
          } else {
            localData["header-items"][i].isSorted = false;
          }
        }
      }

      base.createPanelShow(patientList, patientsPanel, localData, {
        "header-item": $("#patient-list-header-item").html(),
        "item": $('#patient-list-item').html()
      });

      $('#patients-placeholder').hide();

      base.setupClipboard($('.btn-copy'), true);

      base.wireUpTooltips();

      patientsPanel.find('div.table-scroll').niceScroll({
        cursoropacitymin: 0.3,
        cursorwidth: "7px",
        horizrailenabled: false
      });

    });

  },

  show: function(panel, isAppend, pathwayId, pathwayStage, standard, loadContentFn) {

    var tempMust = $('#patients-panel-yes').html();

    if(isAppend) panel.append(Mustache.render(tempMust));
    else panel.html(Mustache.render(tempMust));

    pl.wireUp(function(patientId) {
      history.pushState(null, null, '#patient/' + [patientId, pathwayId, pathwayStage, standard].join("/"));
      loadContentFn('#patient/' + [patientId, pathwayId, pathwayStage, standard].join("/"));
    });
    pl.populate(pathwayId, pathwayStage, standard, null);
  }

};

module.exports = pl;

},{"../base.js":7,"../data.js":9,"../lookup.js":12,"highcharts/highstock":2,"mustache":4}],26:[function(require,module,exports){
var base = require('../base.js'),
  data = require('../data.js'),
  lookup = require('../lookup.js'),
  Mustache = require('mustache');
var states, loadContFn, ID = "PATIENT_SEARCH";

var ps = {

  wireUp: function() {
    if (states) {
      states.clearPrefetchCache();
    }

    states = new Bloodhound({
      datumTokenizer: Bloodhound.tokenizers.obj.whitespace('value'),
      queryTokenizer: Bloodhound.tokenizers.whitespace,
      local: $.map(data.patientArray, function(state) {
        return {
          id: state,
          value: state
        };
      })
    });

    states.initialize(true);

    $('#search-box').find('.typeahead').typeahead('destroy');
    $('#search-box').find('.typeahead').typeahead({
        hint: true,
        highlight: true,
        minLength: 1,
        autoselect: true
      }, {
        name: 'patients',
        displayKey: 'value',
        source: states.ttAdapter(),
        templates: {
          empty: [
              '<div class="empty-message">',
                '&nbsp; &nbsp; No matches',
              '</div>'
            ].join('\n')
        }
      }).on('typeahead:selected', ps.onSelected)
      .on('typeahead:autocompleted', ps.onSelected);

    $('#searchbtn').on('mousedown', function() {
      var val = $('.typeahead').eq(0).val();
      if (!val || val === "") val = $('.typeahead').eq(1).val();
      ps.onSelected(null, {
        "id": val
      });
    });
  },

  onSelected: function($e, nhsNumberObject) {
    //Hide the suggestions panel
    $('#search-box').find('.tt-dropdown-menu').css('display', 'none');

    history.pushState(null, null, '#patients/' + nhsNumberObject.id);
    loadContFn('#patients/' + nhsNumberObject.id, true);

  },

  show: function(panel, isAppend, loadContentFn) {

    loadContFn = loadContentFn;
    var tempMust = $('#patient-search').html();

    if(isAppend) panel.append(Mustache.render(tempMust));
    else panel.html(Mustache.render(tempMust));

    ps.wireUp();
  }

};

module.exports = ps;

},{"../base.js":7,"../data.js":9,"../lookup.js":12,"mustache":4}],27:[function(require,module,exports){
var base = require('../base.js'),
  data = require('../data.js'),
  lookup = require('../lookup.js'),
  chart = require('../chart.js'),
  qualityStandard = require('./qualityStandard.js'),
  otherCodes = require('./otherCodes.js'),
  medication = require('./medication.js'),
  trend = require('./trend.js'),
  individualActionPlan = require('./individualActionPlan.js'),
  patientList = require('./patientList.js');

var pt = {

  create: function(pathwayId, pathwayStage, standard) {
    var tabData = [];
    for (var key in data[pathwayId][pathwayStage].standards) {
      tabData.push({
        "header": data[pathwayId][pathwayStage].standards[key].tab,
        "active": key === standard,
        "url": window.location.hash.replace(/\/no.*/g, '\/no/' + key)
      });
    }
    return base.createPanel(patientsPanelTemplate, {
      "pathwayStage": pathwayStage,
      "header": data[pathwayId][pathwayStage].standards[standard].chartTitle,
      "tooltip": data[pathwayId][pathwayStage].standards[standard].tooltip,
      "url": window.location.hash.replace(/\/yes.*/g, '').replace(/\/no.*/g, ''),
      "tabs": tabData,
      "text": data[pathwayId][pathwayStage].text
    }, {
      "content": $('#patients-panel-no').html(),
      "tab-header": $('#patients-panel-no-tabs').html(),
      "tab-content": $('#patients-panel-no-page').html()
    });
  },

  createOk: function(pathwayId, pathwayStage) {
    return base.createPanel(patientsPanelTemplate, {
      "ok": true,
      "pathwayStage": pathwayStage,
      "url": window.location.hash.replace(/\/yes/g, '').replace(/\/no/g, ''),
      "text": data[pathwayId][pathwayStage].text
    }, {
      "content": $('#patients-panel-yes').html()
    });
  },

  wireUp: function(pathwayId, pathwayStage, location, standard) {

    patientList.wireUp(function(patientId){
      $('[data-toggle="tooltip"]').tooltip('hide');
      $(this).tooltip('destroy');
      base.clearBox();
      $('.list-item').removeClass('highlighted');
      $(this).addClass('highlighted').removeAttr("title");

      pt.showPathwayStagePatientView(patientId, pathwayId, selected, standard);
    });

    patientsPanel = $('#patients');

    location.off('click', '#breakdown-chart');
    location.on('click', '#breakdown-chart', function() {
      if (!lookup.chartClicked) {
        /*jshint unused: true*/
        $('path.c3-bar').attr('class', function(index, classNames) {
          return classNames.replace(/_unselected_/g, '');
        });
        /*jshint unused: false*/

        if (lookup.charts['breakdown-chart']) lookup.charts['breakdown-chart'].unselect();

        patientList.populate(pathwayId, pathwayStage, standard, null);
        data.subselected = null;

        farRightPanel.fadeOut(200);
      }
      lookup.chartClicked = false;
    });

    chart.destroyCharts(['breakdown-chart']);
    setTimeout(function() {
      lookup.charts['breakdown-chart'] = c3.generate({
        bindto: '#breakdown-chart',
        tooltip: {
          format: {
            name: function(name, a, b) {
              var text = data[pathwayId][pathwayStage].standards[standard].opportunities[lookup.index].desc;
              var html = "";
              while (text.length > 40) {
                if (text.indexOf(' ', 40) < 0) break;
                html += text.substr(0, text.indexOf(' ', 40)) + '<br>';
                text = text.substr(text.indexOf(' ', 40) + 1);
              }
              html += text;
              return html;
            },
            value: function(value, ratio, id, index) {
              lookup.index = index;
              return value;
            }
          }
        },
        data: {
          columns: [
            ["Patients"].concat(data[pathwayId][pathwayStage].standards[standard].opportunities.map(function(val) {
              return val.patients.length;
            }))
          ],
          type: 'bar',
          labels: true,
          color: function(color, d) {
            return lookup.colors[d.index];
          },
          selection: {
            enabled: true
          },
          onclick: function(d) {
            chart.selectPieSlice('breakdown-chart', d);
            patientList.populate(pathwayId, pathwayStage, standard, data[pathwayId][pathwayStage].standards[standard].opportunities[d.index].name);
            data.subselected = data[pathwayId][pathwayStage].standards[standard].opportunities[d.index].name;

            //colour table appropriately - need to add opacity
            var sliceColourHex = lookup.colors[d.index];
            var shorthandRegex = /^#?([a-f\d])([a-f\d])([a-f\d])$/i;
            sliceColourHex = sliceColourHex.replace(shorthandRegex, function(m, r, g, b) {
              return r + r + g + g + b + b;
            });
            var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(sliceColourHex);
            var opacity = 0.2;
            var sliceColour = 'rgba(' + parseInt(result[1], 16) + ',' + parseInt(result[2], 16) + ',' + parseInt(result[3], 16) + ',' + opacity + ')';

            $('.table.patient-list.table-head-hidden').css({
              "backgroundColor": sliceColour
            });
          }
        },
        bar: {
          width: {
            ratio: 0.5
          }
        },
        legend: {
          show: false
        },
        grid: {
          focus: {
            show: false
          }
        },
        axis: {
          x: {
            type: 'category',
            categories: data[pathwayId][pathwayStage].standards[standard].opportunities.map(function(val) {
              return val.name;
            }),
            label: false
          },
          y: {
            label: {
              text: 'Patient count (n)',
              position: 'outer-middle'
            }
          }
        }
      });
    }, 1);
  },

  wireUpOk: function(pathwayId, pathwayStage, location) {
    patientsPanel = $('#patients');

    patientsPanel.on('click', 'thead tr th.sortable', function() { //Sort columns when column header clicked
      var sortAsc = !$(this).hasClass('sort-asc');
      if (sortAsc) {
        $(this).removeClass('sort-desc').addClass('sort-asc');
      } else {
        $(this).removeClass('sort-asc').addClass('sort-desc');
      }
      pt.populateOk(pathwayId, data.selected, data.subselected, $(this).index(), sortAsc);
    }).on('click', 'tbody tr', function(e) { //Select individual patient when row clicked
      $('[data-toggle="tooltip"]').tooltip('hide');
      $(this).tooltip('destroy');
      base.clearBox();
      $('.list-item').removeClass('highlighted');
      $(this).addClass('highlighted').removeAttr('title');

      var patientId = $(this).find('td button').attr('data-patient-id');

      pt.showPathwayStagePatientView(patientId, pathwayId, data.selected, null);
      e.preventDefault();
      e.stopPropagation();
    }).on('click', 'tbody tr button', function(e) {
      //don't want row selected if just button pressed?
      e.preventDefault();
      e.stopPropagation();
    });

    data.selected = pathwayStage;
    data.subselected = null;
  },

  populateOk: function(pathwayId, pathwayStage, subsection, sortField, sortAsc) {
    var pList = [],
      i, k, prop, header, tooltip;
    patientsPanel.fadeOut(200, function() {
      $(this).fadeIn(200);
    });

    pList = data[pathwayId][pathwayStage].patientsOk;
    header = data[pathwayId][pathwayStage].text.panelOkHeader.text;
    tooltip = data[pathwayId][pathwayStage].text.panelOkHeader.tooltip;

    pList = data.removeDuplicates(pList);
    var patients = pList.map(function(patientId) {
      var ret = data.patients[patientId];
      ret.nhsNumber = data.patLookup ? data.patLookup[patientId] : patientId;
      ret.patientId = patientId;
      ret.items = []; //The fields in the patient list table
      ret.items.push(data.patients[patientId].breach ? data.numberOfStandardsMissed(patientId) : 0);
      return ret;
    });
    var localData = {
      "patients": patients,
      "n": patients.length,
      "header": header,
      "tooltip": tooltip,
      "header-items": [{
        "title": "NHS no.",
        "isSorted": false,
        "direction": "sort-asc"
      }, {
        "title": "All Opportunities",
        "titleHTML": '# of <i class="fa fa-flag" style="color:red"></i>',
        "isSorted": true,
        "direction": "sort-desc",
        "tooltip": "Total number of improvement opportunities available across all conditions"
      }]
    };

    if (sortField === undefined) sortField = 1;

    localData.patients.sort(function(a, b) {
      if (sortField === 0) { //NHS number
        if (a.nhsNumber === b.nhsNumber) {
          return 0;
        }

        if (a.nhsNumber > b.nhsNumber) {
          return sortAsc ? 1 : -1;
        } else if (a.nhsNumber < b.nhsNumber) {
          return sortAsc ? -1 : 1;
        }
      } else {
        if (a.items[sortField - 1] === b.items[sortField - 1]) {
          return 0;
        }

        var A = Number(a.items[sortField - 1]);
        var B = Number(b.items[sortField - 1]);
        if (isNaN(A) || isNaN(B)) {
          A = a.items[sortField - 1];
          B = b.items[sortField - 1];
        }
        if (A > B) {
          return sortAsc ? 1 : -1;
        } else if (A < B) {
          return sortAsc ? -1 : 1;
        }
      }
    });

    for (i = 0; i < localData["header-items"].length; i++) {
      if (i === sortField) {
        localData["header-items"][i].direction = sortAsc ? "sort-asc" : "sort-desc";
        localData["header-items"][i].isAsc = sortAsc;
        localData["header-items"][i].isSorted = true;
      } else {
        localData["header-items"][i].isSorted = false;
      }
    }


    base.createPanelShow(patientList, patientsPanel, localData, {
      "header-item": $("#patient-list-header-item").html(),
      "item": $('#patient-list-item').html()
    });

    $('#patients-placeholder').hide();

    base.setupClipboard($('.btn-copy'), true);

    base.wireUpTooltips();

    var c = patientsPanel.find('div.table-scroll').getNiceScroll();
    if (c && c.length > 0) {
      c.resize();
    } else {
      patientsPanel.find('div.table-scroll').niceScroll({
        cursoropacitymin: 0.3,
        cursorwidth: "7px",
        horizrailenabled: false
      });
    }
  },

  //Show patient view within the pathway stage view
  showPathwayStagePatientView: function(patientId, pathwayId, pathwayStage, standard) {
    data.patientId = patientId;

    base.switchTo110Layout();

    pt.showIndividualPatientPanel(pathwayId, pathwayStage, standard, patientId);
  },

  showIndividualPatientPanel: function(pathwayId, pathwayStage, standard, patientId) {
    var stan = data[pathwayId][pathwayStage].standards[standard] ? data[pathwayId][pathwayStage].standards[standard].tab.title : "UNSPECIFIED";

    data.options.sort(function(a, b) {
      a = data.getPatientStatus(patientId, a.pathwayId, a.pathwayStage, a.standard);
      b = data.getPatientStatus(patientId, b.pathwayId, b.pathwayStage, b.standard);

      if (a === b) return 0;
      if (a === "not") return 1;
      if (b === "not") return -1;
      if (a === "ok") return 1;
      if (b === "ok") return -1;
      alert("!!!!!!!");
    });

    var panel = base.createPanel($('#patient-panel'), {
      "options": data.options,
      "numberOfStandardsMissed": data.numberOfStandardsMissed(patientId),
      "standard": stan,
      "pathwayStage": pathwayStage,
      "nhsNumber": data.patLookup ? data.patLookup[patientId] : patientId,
      "patientId": patientId
    }, {
      "option": $('#patient-panel-drop-down-options').html()
    });

    if (standard === null) {
      //Must be a patient from the *** OK group
      standard = data.options.filter(function(val) {
        return val.pathwayId === pathwayId && val.pathwayStage === pathwayStage;
      })[0].standard;
    }

    farRightPanel.html("");
    $('#temp-hidden').html(panel);

    var actionPlan = individualActionPlan.create(pathwayStage);
    $('#temp-hidden #patient-panel-right').html(actionPlan);

    var qualPanel = qualityStandard.create(pathwayId, pathwayStage, standard, patientId);
    var trendPanel = trend.create(pathwayId, pathwayStage, standard, patientId);
    var medPanel = medication.create(pathwayId, pathwayStage, standard, patientId);
    var codesPanel = otherCodes.create(pathwayId, pathwayStage, standard, patientId);
    var medCodeWrapperPanel = base.createPanel($('#other-codes-and-meds-wrapper-panel'));
    $('#temp-hidden #patient-panel-top').html(qualPanel);
    $('#temp-hidden #patient-panel-left').html("").append(trendPanel).append(medCodeWrapperPanel);
    $('#temp-hidden #medCodeWrapperPanel').append(medPanel).append(codesPanel);

    if (farRightPanel.is(':visible')) {
      farRightPanel.fadeOut(500, function() {
        $(this).html($('#temp-hidden').html());
        $('#temp-hidden').html("");
        individualActionPlan.wireUp(pathwayId, pathwayStage, standard, patientId);
        qualityStandard.wireUp(pathwayId, pathwayStage, standard, patientId);
        base.wireUpStandardDropDown(pathwayId, pathwayStage, standard, pt.showIndividualPatientPanel);
        trend.wireUp(pathwayId, pathwayStage, standard, patientId);
        medication.wireUp(pathwayId, pathwayStage, standard, patientId);
        otherCodes.wireUp(pathwayId, pathwayStage, standard, patientId);
        chart.drawTrendChart(patientId, pathwayId, pathwayStage, standard);
        $(this).fadeIn(500, function() {});
      });
    } else {
      farRightPanel.html($('#temp-hidden').html());
      $('#temp-hidden').html("");
      individualActionPlan.wireUp(pathwayId, pathwayStage, standard, patientId);
      qualityStandard.wireUp(pathwayId, pathwayStage, standard, patientId);
      base.wireUpStandardDropDown(pathwayId, pathwayStage, standard, pt.showIndividualPatientPanel);
      trend.wireUp(pathwayId, pathwayStage, standard, patientId);
      medication.wireUp(pathwayId, pathwayStage, standard, patientId);
      otherCodes.wireUp(pathwayId, pathwayStage, standard, patientId);
      chart.drawTrendChart(patientId, pathwayId, pathwayStage, standard);
      farRightPanel.fadeIn(500, function() {});
    }
  }

};

module.exports = pt;

},{"../base.js":7,"../chart.js":8,"../data.js":9,"../lookup.js":12,"./individualActionPlan.js":21,"./medication.js":23,"./otherCodes.js":24,"./patientList.js":25,"./qualityStandard.js":28,"./trend.js":30}],28:[function(require,module,exports){
var base = require('../base.js'),
  data = require('../data.js'),
  log = require('../log.js'),
  confirm = require('./confirm.js');

var ID = "QUALITYSTANDARD";

var qs = {

  create: function(pathwayId, pathwayStage, standard, patientId) {

    var localData = {
      "nhsNumber": data.patLookup ? data.patLookup[patientId] : patientId,
      "patientId": patientId
    };
    localData.standard = data.pathwayNames[pathwayId] + ' - ' + pathwayStage;
    if (data.patients[patientId].standards && data.patients[patientId].standards[pathwayId] &&
      data.patients[patientId].standards[pathwayId][pathwayStage] &&
      data.patients[patientId].standards[pathwayId][pathwayStage][standard]) {
      localData.standard = data.patients[patientId].standards[pathwayId][pathwayStage][standard];
    }

    localData.tooltip = data[pathwayId][pathwayStage].standards[standard]["standard-met-tooltip"];

    switch (data.getPatientStatus(patientId, pathwayId, pathwayStage, standard)) {
      case "ok":
        ////farRightPanel.removeClass('standard-missed-page').addClass('standard-achieved-page').removeClass('standard-not-relevant-page');
        localData.achieved = true;
        localData.relevant = true;
        break;
      case "missed":
        ////farRightPanel.addClass('standard-missed-page').removeClass('standard-achieved-page').removeClass('standard-not-relevant-page');
        localData.relevant = true;
        localData.achieved = false;
        break;
      case "not":
        ////farRightPanel.removeClass('standard-missed-page').removeClass('standard-achieved-page').addClass('standard-not-relevant-page');
        localData.relevant = false;
        break;
    }

    var agObj = log.getPatientAgreeObject(pathwayId, pathwayStage, standard, patientId, "standard");
    if (agObj && agObj.agree) localData.agree = true;
    else if (agObj && agObj.agree === false) localData.disagree = true;

    return base.createPanel($('#qual-standard'), localData);
  },

  show: function(panel, pathwayId, pathwayStage, standard, patientId){

    var panelId = panel.attr("id");

    if (base.panels[panelId] &&
      base.panels[panelId].id === ID &&
      base.panels[panelId].patientId === patientId) {
        //Already showing the right thing
        return;
    }

    base.panels[panelId] = {
      id: ID,
      patientId: patientId
    };

    panel.html(qs.create(pathwayId, pathwayStage, standard, patientId));
    qs.wireUp(pathwayId, pathwayStage, standard, patientId);
  },

  wireUp: function(pathwayId, pathwayStage, standard, patientId) {
    confirm.wireUp($('#qual-agree-disagree'), $('#individual-panel-classification'), pathwayId, pathwayStage, standard, patientId, "standard", "quality standard");
  },

  update: function() {
    $('#individual-panel-classification').find('div').each(function() {
      var self = $(this);
      var any = false;
      self.find('.btn-toggle input[type=checkbox]:checked').each(function() {
        var isClassification = $(this).closest("div").data("isClassification") !== undefined;
        any = true;
        var item = log.getAgrees()[data.patientId].filter(function(i) {
          return isClassification ? i.item === "section" : i.item !== "section";
        });
        var tool;
        if (this.value === "yes") {
          if (item && item[0].history) {
            tool = "<p>" + item[0].history[0] + "</p><p>Click again to cancel</p>";
            $(this).parent().attr("title", tool).attr("data-original-title", tool).tooltip('fixTitle').tooltip('hide');
          } else {
            $(this).parent().attr("title", "You agreed - click again to cancel").tooltip('fixTitle').tooltip('hide');
          }
        } else {
          if (item && item[0].history) {
            tool = "<p>" + item[0].history[0] + "</p><p>Click again to edit/cancel</p>";
            $(this).parent().attr("title", tool).attr("data-original-title", tool).tooltip('fixTitle').tooltip('hide');
          } else {
            $(this).parent().attr("title", "You disagreed - click again to edit/cancel").tooltip('fixTitle').tooltip('hide');
          }
        }
      });

      if (self.find('.btn-toggle input[type=checkbox]:not(:checked)').length == 1) {
        self.find('.btn-toggle input[type=checkbox]:not(:checked)').parent().addClass("inactive").attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
      }

      if (!any) {
        self.find('.btn-toggle.btn-yes').attr("title", "Click to agree with this action and save it in your agreed actions list  ").tooltip('fixTitle').tooltip('hide');
        self.find('.btn-toggle.btn-no').attr("title", "Click to disagree with this action and remove it from your suggested actions list ").tooltip('fixTitle').tooltip('hide');
      }

      base.wireUpTooltips();
    });

    base.wireUpTooltips();
  }

};

module.exports = qs;

},{"../base.js":7,"../data.js":9,"../log.js":11,"./confirm.js":16}],29:[function(require,module,exports){
var base = require('../base.js'),
  confirm = require('./confirm.js'),
  data = require('../data.js'),
  log = require('../log.js');

var tap = {

  show: function(location) {
    location.removeClass('standard-missed-page').removeClass('standard-achieved-page').removeClass('standard-not-relevant-page');
    base.createPanelShow($('#team-action-plan-panel'), location);

    suggestedPlanTeam = $('#suggestedPlanTeam');

    suggestedPlanTeam.on('click', '.cr-styled input[type=checkbox]', function() {
      var ACTIONID = $(this).closest('tr').data('id');
      log.editAction("team", ACTIONID, null, this.checked);

      if (this.checked) {
        log.recordEvent(data.pathwayId, "team", "Item completed");
        var self = this;
        $(self).parent().attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
        base.wireUpTooltips();
        setTimeout(function(e) {
          $(self).parent().fadeOut(300, function() {
            var parent = $(this).parent();
            $(this).replaceWith(base.createPanel($('#checkbox-template'), {
              "done": true
            }));
            parent.find('button').on('click', function() {
              ACTIONID = $(this).closest('tr').data('id');
              log.editAction("team", ACTIONID, null, false);
              $(this).replaceWith(base.createPanel($('#checkbox-template'), {
                "done": false
              }));
              tap.updateTeamSapRows();
            });
          });
        }, 1000);
      }

      tap.updateTeamSapRows();
    });

    $('#personalPlanTeam').on('click', 'input[type=checkbox]', function() {
      var PLANID = $(this).closest('tr').data("id");
      editPlan(PLANID, null, this.checked);

      if (this.checked) {
        $(this).parent().parent().parent().addClass('success');
        recordEvent(data.pathwayId, "team", "Personal plan item");
        var self = this;
        $(self).parent().attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
        setTimeout(function(e) {
          $(self).parent().fadeOut(300, function() {
            var parent = $(this).parent();
            $(this).replaceWith(base.createPanel($('#checkbox-template'), {
              "done": true
            }));
            base.wireUpTooltips();
            parent.find('button').on('click', function() {
              PLANID = $(this).closest('tr').data('id');
              editPlan("team", PLANID, null, false);
              $(this).replaceWith(base.createPanel($('#checkbox-template'), {
                "done": false
              }));
              tap.updateTeamSapRows();
            });
          });
        }, 1000);
      }

    }).on('click', '.btn-undo', function(e) {
      var PLANID = $(this).closest('tr').data('id');
      log.editPlan(PLANID, null, false);
      $(this).replaceWith(base.createPanel($('#checkbox-template'), {
        "done": false
      }));
      tap.updateTeamSapRows();
      e.stopPropagation();
    });

    var teamTab = $('#tab-plan-team'),
      current;
    teamTab.on('click', '.edit-plan', function() {
      var PLANID = $(this).closest('tr').data("id");

      $('#editActionPlanItem').val($($(this).closest('tr').children('td')[0]).find('span').text());

      $('#editPlan').off('hidden.bs.modal').on('hidden.bs.modal', function() {
        tap.displayPersonalisedTeamActionPlan($('#personalPlanTeam'));
      }).off('shown.bs.modal').on('shown.bs.modal', function() {
        $('#editActionPlanItem').focus();
      }).off('click', '.save-plan').on('click', '.save-plan', function() {

        log.editPlan(PLANID, $('#editActionPlanItem').val());

        $('#editPlan').modal('hide');
      }).off('keyup', '#editActionPlanItem').on('keyup', '#editActionPlanItem', function(e) {
        if (e.which === 13) $('#editPlan .save-plan').click();
      }).modal();
    }).on('click', '.delete-plan', function() {
      var PLANID = $(this).closest('tr').data("id");

      $('#team-delete-item').html($($(this).closest('tr').children('td')[0]).find('span').text());

      $('#deletePlan').off('hidden.bs.modal').on('hidden.bs.modal', function() {
        tap.displayPersonalisedTeamActionPlan($('#personalPlanTeam'));
      }).off('click', '.delete-plan').on('click', '.delete-plan', function() {
        log.deletePlan(PLANID);

        $('#deletePlan').modal('hide');
      }).modal();
    }).on('click', '.add-plan', function() {
      log.recordPlan("team", $(this).parent().parent().find('textarea').val(), data.pathwayId);

      tap.displayPersonalisedTeamActionPlan($('#personalPlanTeam'));
    }).on('change', '.btn-toggle input[type=checkbox]', function() {
      tap.updateTeamSapRows();
    }).on('click', '.btn-undo', function(e) {
      var ACTIONID = $(this).closest('tr').data('id');
      log.editAction("team", ACTIONID, null, false);
      $(this).replaceWith(base.createPanel($('#checkbox-template'), {
        "done": false
      }));
      tap.updateTeamSapRows();
    }).on('click', '.btn-yes,.btn-no', function(e) {
      var checkbox = $(this).find("input[type=checkbox]");
      var other = $(this).parent().find($(this).hasClass("btn-yes") ? ".btn-no" : ".btn-yes");
      var ACTIONID = $(this).closest('tr').data('id');
      if ($(this).hasClass("active") && other.hasClass("inactive") && !$(this).closest('tr').hasClass('success')) {
        //unselecting
        if (checkbox.val() === "no") {
          tap.launchModal(data.selected, checkbox.closest('tr').children().first().children().first().text(), log.getReason("team", ACTIONID), true, function() {
            log.editAction("team", ACTIONID, false, null, log.reason);
            tap.updateTeamSapRows();
            base.wireUpTooltips();
          }, null, function() {
            log.ignoreAction("team", ACTIONID);
            other.removeClass("inactive");
            checkbox.removeAttr("checked");
            checkbox.parent().removeClass("active");
            tap.updateTeamSapRows();
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.ignoreAction("team", ACTIONID);
          other.removeClass("inactive");
        }
      } else if ((!$(this).hasClass("active") && other.hasClass("active")) || $(this).closest('tr').hasClass('success')) {
        //prevent clicking on unselected option or if the row is complete
        e.stopPropagation();
        e.preventDefault();
        return;
      } else {
        //selecting
        var self = this;
        if (checkbox.val() === "no") {
          tap.launchModal(data.selected, checkbox.closest('tr').children().first().children().first().text(), log.getReason("team", ACTIONID), false, function() {
            log.editAction("team", ACTIONID, false, null, log.reason);
            $(self).removeClass("inactive");

            checkbox.attr("checked", "checked");
            checkbox.parent().addClass("active");
            //unselect other
            other.removeClass("active").addClass("inactive");
            other.find("input[type=checkbox]").prop("checked", false);
            tap.updateTeamSapRows();
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.editAction("team", ACTIONID, true);
          $(this).removeClass("inactive");

          //unselect other
          other.removeClass("active").addClass("inactive");
          other.find("input[type=checkbox]").prop("checked", false);
        }
      }
    }).on('keyup', 'input[type=text]', function(e) {
      if (e.which === 13) {
        teamTab.find('.add-plan').click();
      }
    });

    tap.populateTeamSuggestedActionsPanel();

    location.find('div.fit-to-screen-height').niceScroll({
      cursoropacitymin: 0.3,
      cursorwidth: "7px",
      horizrailenabled: false
    });
  },

  populateTeamSuggestedActionsPanel: function() {
    var suggestions = base.suggestionList(log.plan[data.pathwayId].team);
    suggestions = base.sortSuggestions(tap.mergeTeamStuff(suggestions));

    base.createPanelShow(suggestedPlanTemplate, suggestedPlanTeam, {
      "suggestions": suggestions
    }, {
      "item": $('#suggested-plan-item').html(),
      "chk": $('#checkbox-template').html()
    });

    tap.displayPersonalisedTeamActionPlan($('#personalPlanTeam'));
  },

  updateTeamSapRows: function() {
    suggestedPlanTeam.add('#personalPlanTeam').find('.suggestion').each(function() {
      $(this).find('td').last().children().hide();
    });

    suggestedPlanTeam.add('#personalPlanTeam').find('.cr-styled input[type=checkbox]').each(function() {
      if (this.checked) {
        $(this).parent().parent().parent().addClass('success');
      } else {
        $(this).parent().parent().parent().removeClass('success');
      }
    });

    suggestedPlanTeam.add('#personalPlanTeam').find('.btn-undo').each(function() {
      $(this).parent().parent().addClass('success');
    });

    //no class - user not yet agreed/disagreed - no background / muted text
    //active - user agrees - green background / normal text
    //success - user completed - green background / strikethrough text
    //danger - user disagrees - red background / strikethrough text
    suggestedPlanTeam.add('#personalPlanTeam').find('tr').each(function() {
      var self = $(this);
      var any = false;
      self.find('.btn-toggle input[type=checkbox]:checked').each(function() {
        any = true;
        if (this.value === "yes") {
          self.removeClass('danger');
          self.addClass('active');
          self.find('td').last().children().show();
          if (log.getActions().team[self.data("id")].history) {
            var tool = $(this).closest('tr').hasClass('success') ? "" : "<p>" + log.getActions().team[self.data("id")].history[0] + "</p><p>Click again to cancel</p>";
            $(this).parent().attr("title", tool).attr("data-original-title", tool).tooltip('fixTitle').tooltip('hide');
          } else {
            $(this).parent().attr("title", "You agreed - click again to cancel").tooltip('fixTitle').tooltip('hide');
          }
        } else {
          self.removeClass('active');
          self.addClass('danger');
          self.removeClass('success');
          if (log.getActions().team[self.data("id")] && log.getActions().team[self.data("id")].history) {
            $(this).parent().attr("title", "<p>" + log.getActions().team[self.data("id")].history[0] + "</p><p>Click again to edit/cancel</p>").tooltip('fixTitle').tooltip('hide');
          } else {
            $(this).parent().attr("title", "You disagreed - click again to edit/cancel").tooltip('fixTitle').tooltip('hide');
          }
        }
      });
      if (self.find('.btn-toggle input[type=checkbox]:not(:checked)').length == 1) {
        self.find('.btn-toggle input[type=checkbox]:not(:checked)').parent().addClass("inactive").attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
      }
      if (!any) {
        self.removeClass('danger');
        self.removeClass('active');
        self.removeClass('success');

        self.find('.btn-toggle.btn-yes').attr("title", "Click to agree with this action and save it in your agreed actions list  ").tooltip('fixTitle').tooltip('hide');
        self.find('.btn-toggle.btn-no').attr("title", "Click to disagree with this action and remove it from your suggested actions list ").tooltip('fixTitle').tooltip('hide');
      }

      base.wireUpTooltips();
    });

    base.wireUpTooltips();
  },

  displayPersonalisedTeamActionPlan: function(parentElem) {
    var plans = base.sortSuggestions(base.addDisagreePersonalTeam(log.listPlans("team", data.pathwayId)));

    base.createPanelShow(actionPlanList, parentElem, {
      "hasSuggestions": plans && plans.length > 0,
      "suggestions": plans
    }, {
      "action-plan": $('#action-plan').html(),
      "action-plan-item": $('#action-plan-item').html(),
      "chk": $('#checkbox-template').html()
    });

    tap.updateTeamSapRows();
  },

  mergeTeamStuff: function(suggestions) {
    var teamActions = log.listActions();
    if (!teamActions.team) return suggestions;

    suggestions = tap.addDisagree(suggestions, teamActions, "team");
    return suggestions;
  },

  launchModal: function(label, value, reason, isUndo, callbackOnSave, callbackOnCancel, callbackOnUndo) {
    var reasons = [{
      "reason": "We've already done this",
      "value": "done"
    }, {
      "reason": "It wouldn't work",
      "value": "nowork"
    }, {
      "reason": "Other",
      "value": "else"
    }];
    if (reason && reason.reason) {
      for (var i = 0; i < reasons.length; i++) {
        if (reasons[i].reason === reason.reason) {
          reasons[i].checked = true;
          break;
        }
      }
    }
    base.launchModal({
      "header": "Disagree with a suggested action",
      "isUndo": isUndo,
      "item": value,
      "placeholder": "Enter free-text here...",
      "reasons": reasons
    }, label, value, reason ? reason.reasonText : null, callbackOnSave, callbackOnCancel, callbackOnUndo);
  },

  addDisagree: function(suggestions, actions, id) {
    for (var i = 0; i < suggestions.length; i++) {
      if (actions[id][suggestions[i].id]) {
        if (actions[id][suggestions[i].id].agree) {
          suggestions[i].agree = true;
          suggestions[i].disagree = false;
        } else if (actions[id][suggestions[i].id].agree === false) {
          suggestions[i].agree = false;
          suggestions[i].disagree = true;
        }
        if (actions[id][suggestions[i].id].done) suggestions[i].done = actions[id][suggestions[i].id].done;
        else suggestions[i].done = false;
      }
    }
    return suggestions;
  }

};

module.exports = tap;

},{"../base.js":7,"../data.js":9,"../log.js":11,"./confirm.js":16}],30:[function(require,module,exports){
var base = require('../base.js'),
  confirm = require('./confirm.js'),
  data = require('../data.js'),
  log = require('../log.js'),
  lookup = require('../lookup.js');

var trnd = {

  create: function(pathwayId, pathwayStage, standard, patientId) {
    var agree = log.getPatientAgreeObject(pathwayId, pathwayStage, standard, patientId, "trend");
    return base.createPanel(valueTrendPanel, {
      "pathway": lookup.monitored[pathwayId],
      "agree": agree && agree.agree,
      "disagree": agree && agree.agree === false,
      "standard": data[pathwayId][pathwayStage].standards[standard].tab.title,
      "pathwayStage": pathwayStage
    });
  },

  wireUp: function(pathwayId, pathwayStage, standard, patientId) {
    confirm.wireUp($('#trend-agree-disagree'), $('#trend-panel'), pathwayId, pathwayStage, standard, patientId, "trend", "trend data");

    $('#trend-panel').on('click', '.table-chart-toggle', function() {
      if ($(this).text() === "Table") {
        $(this).text("Chart");
        $('#chart-demo-trend').hide();
        $('#table-demo-trend').show();

        var c = $('#table-demo-trend .tableScroll').getNiceScroll();
        if (c && c.length > 0) {
          c.resize();
        } else {
          $('#table-demo-trend .tableScroll').niceScroll({
            cursoropacitymin: 0.3,
            cursorwidth: "7px",
            horizrailenabled: false
          });
        }
      } else {
        $(this).text("Table");
        $('#chart-demo-trend').show();
        $('#table-demo-trend').hide();
      }
    });
  }

};

module.exports = trnd;

},{"../base.js":7,"../data.js":9,"../log.js":11,"../lookup.js":12,"./confirm.js":16}],31:[function(require,module,exports){
var base = require('../base.js'),
  data = require('../data.js'),
  log = require('../log.js'),
  individualActionPlan = require('./individualActionPlan.js'),
  teamActionPlan = require('./teamActionPlan.js'),
  Mustache = require('mustache');

var welcome = {

  wireUpWelcomePage: function(pathwayId, pathwayStage) {
    $('#team-task-panel').on('click', '.cr-styled input[type=checkbox]', function() {
      var ACTIONID = $(this).closest('tr').data('id');
      log.editAction("team", ACTIONID, null, this.checked);

      if (this.checked) {
        log.recordEvent(pathwayId, "team", "Item completed");
        var self = this;
        $(self).parent().attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
        base.wireUpTooltips();
        setTimeout(function(e) {
          $(self).parent().fadeOut(300, function() {
            var parent = $(this).parent();
            $(this).replaceWith(base.createPanel($('#checkbox-template'), {
              "done": true
            }));
            parent.find('button').on('click', function() {
              ACTIONID = $(this).closest('tr').data('id');
              log.editAction("team", ACTIONID, null, false);
              $(this).replaceWith(base.createPanel($('#checkbox-template'), {
                "done": false
              }));
              welcome.updateWelcomePage();
            });
          });
        }, 1000);
      }
      welcome.updateWelcomePage();
    }).on('change', '.btn-toggle input[type=checkbox]', function() {
      welcome.updateWelcomePage();
    }).on('click', '.edit-plan', function() {
      var PLANID = $(this).closest('tr').data("id");

      $('#editActionPlanItem').val($($(this).closest('tr').children('td')[1]).find('span').text());

      $('#editPlan').off('hidden.bs.modal').on('hidden.bs.modal', function() {
        welcome.populate(!$('#outstandingTasks').parent().hasClass("active"));
      }).off('shown.bs.modal').on('shown.bs.modal', function() {
        $('#editActionPlanItem').focus();
      }).off('click', '.save-plan').on('click', '.save-plan', function() {

        log.editPlan(PLANID, $('#editActionPlanItem').val());

        $('#editPlan').modal('hide');
      }).off('keyup', '#editActionPlanItem').on('keyup', '#editActionPlanItem', function(e) {
        if (e.which === 13) $('#editPlan .save-plan').click();
      }).modal();
    }).on('click', '.delete-plan', function() {
      var PLANID = $(this).closest('tr').data("id");

      $('#team-delete-item').html($($(this).closest('tr').children('td')[1]).find('span').text());

      $('#deletePlan').off('hidden.bs.modal').on('hidden.bs.modal', function() {
        welcome.populate(!$('#outstandingTasks').parent().hasClass("active"));
      }).off('click', '.delete-plan').on('click', '.delete-plan', function() {
        log.deletePlan(PLANID);

        $('#deletePlan').modal('hide');
      }).modal();
    }).on('click', '.btn-undo', function(e) {
      var ACTIONID = $(this).closest('tr').data('id');
      log.editAction("team", ACTIONID, null, false);
      $(this).replaceWith(base.createPanel($('#checkbox-template'), {
        "done": false
      }));
      welcome.updateWelcomePage();
    }).on('click', '.btn-yes,.btn-no', function(e) {
      var checkbox = $(this).find("input[type=checkbox]");
      var other = $(this).parent().find($(this).hasClass("btn-yes") ? ".btn-no" : ".btn-yes");
      var ACTIONID = $(this).closest('tr').data('id');
      if ($(this).hasClass("active") && other.hasClass("inactive") && !$(this).closest('tr').hasClass('success')) {
        //unselecting
        if (checkbox.val() === "no") {
          teamActionPlan.launchModal(data.selected, checkbox.closest('tr').children(':nth(1)').find('span').text(), log.getReason("team", ACTIONID), true, function() {
            log.editAction("team", ACTIONID, false, null, log.reason);
            welcome.updateWelcomePage();
            base.wireUpTooltips();
          }, null, function() {
            log.ignoreAction("team", ACTIONID);
            other.removeClass("inactive");
            checkbox.removeAttr("checked");
            checkbox.parent().removeClass("active");
            welcome.updateWelcomePage();
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.ignoreAction("team", ACTIONID);
          other.removeClass("inactive");
        }
      } else if ((!$(this).hasClass("active") && other.hasClass("active")) || $(this).closest('tr').hasClass('success')) {
        //prevent clicking on unselected option or if the row is complete
        e.stopPropagation();
        e.preventDefault();
        return;
      } else {
        //selecting
        var self = this;
        if (checkbox.val() === "no") {
          teamActionPlan.launchModal(data.selected, checkbox.closest('tr').children(':nth(1)').find('span').text(), log.getReason("team", ACTIONID), false, function() {
            log.editAction("team", ACTIONID, false, null, log.reason);
            $(self).removeClass("inactive");

            checkbox.attr("checked", "checked");
            checkbox.parent().addClass("active");
            //unselect other
            other.removeClass("active").addClass("inactive");
            other.find("input[type=checkbox]").prop("checked", false);
            welcome.updateWelcomePage();
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.editAction("team", ACTIONID, true);
          $(this).removeClass("inactive");

          //unselect other
          other.removeClass("active").addClass("inactive");
          other.find("input[type=checkbox]").prop("checked", false);
        }
      }
    });

    $('#individual-task-panel').on('click', '.cr-styled input[type=checkbox]', function() {
      var ACTIONID = $(this).closest('tr').data('id');
      var patientId = $(this).closest('tr').data('team-or-patient-id');
      log.editAction(patientId, ACTIONID, null, this.checked);

      if (this.checked) {
        log.recordEvent(pathwayId, patientId, "Item completed");
        var self = this;
        $(self).parent().attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
        base.wireUpTooltips();
        setTimeout(function(e) {
          $(self).parent().fadeOut(300, function() {
            var parent = $(this).parent();
            $(this).replaceWith(base.createPanel($('#checkbox-template'), {
              "done": true
            }));
            parent.find('button').on('click', function() {
              ACTIONID = $(this).closest('tr').data('id');
              log.editAction(patientId, ACTIONID, null, false);
              $(this).replaceWith(base.createPanel($('#checkbox-template'), {
                "done": false
              }));
              welcome.updateWelcomePage();
            });
          });
        }, 1000);
      }
      welcome.updateWelcomePage();
    }).on('change', '.btn-toggle input[type=checkbox]', function() {
      welcome.updateWelcomePage();
    }).on('click', '.edit-plan', function() {
      var PLANID = $(this).closest('tr').data("id");

      $('#editActionPlanItem').val($($(this).closest('tr').children('td')[2]).find('span').text());

      $('#editPlan').off('hidden.bs.modal').on('hidden.bs.modal', function() {
        welcome.populate(!$('#outstandingTasks').parent().hasClass("active"));
      }).off('shown.bs.modal').on('shown.bs.modal', function() {
        $('#editActionPlanItem').focus();
      }).off('click', '.save-plan').on('click', '.save-plan', function() {

        log.editPlan(PLANID, $('#editActionPlanItem').val());

        $('#editPlan').modal('hide');
      }).off('keyup', '#editActionPlanItem').on('keyup', '#editActionPlanItem', function(e) {
        if (e.which === 13) $('#editPlan .save-plan').click();
      }).modal();
    }).on('click', '.delete-plan', function() {
      var PLANID = $(this).closest('tr').data("id");

      $('#team-delete-item').html($($(this).closest('tr').children('td')[2]).find('span').text());

      $('#deletePlan').off('hidden.bs.modal').on('hidden.bs.modal', function() {
        welcome.populate(!$('#outstandingTasks').parent().hasClass("active"));
      }).off('click', '.delete-plan').on('click', '.delete-plan', function() {
        log.deletePlan(PLANID);

        $('#deletePlan').modal('hide');
      }).modal();
    }).on('click', '.btn-undo', function(e) {
      var ACTIONID = $(this).closest('tr').data('id');
      var patientId = $(this).closest('tr').data('team-or-patient-id');
      log.editAction(patientId, ACTIONID, null, false);
      $(this).replaceWith(base.createPanel($('#checkbox-template'), {
        "done": false
      }));
      welcome.updateWelcomePage();
    }).on('click', '.btn-yes,.btn-no', function(e) {
      var checkbox = $(this).find("input[type=checkbox]");
      var other = $(this).parent().find($(this).hasClass("btn-yes") ? ".btn-no" : ".btn-yes");
      var ACTIONID = $(this).closest('tr').data('id');
      var patientId = $(this).closest('tr').data('team-or-patient-id');
      if ($(this).hasClass("active") && other.hasClass("inactive") && !$(this).closest('tr').hasClass('success')) {
        //unselecting
        if (checkbox.val() === "no") {
          individualActionPlan.launchModal(data.selected, checkbox.closest('tr').children(':nth(2)').find('span').text(), log.getReason(patientId, ACTIONID), true, function() {
            log.editAction(patientId, ACTIONID, false, null, log.reason);
            welcome.updateWelcomePage();
            base.wireUpTooltips();
          }, null, function() {
            log.ignoreAction(patientId, ACTIONID);
            other.removeClass("inactive");
            checkbox.removeAttr("checked");
            checkbox.parent().removeClass("active");
            welcome.updateWelcomePage();
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.ignoreAction(patientId, ACTIONID);
          other.removeClass("inactive");
        }
      } else if ((!$(this).hasClass("active") && other.hasClass("active")) || $(this).closest('tr').hasClass('success')) {
        //prevent clicking on unselected option or if the row is complete
        e.stopPropagation();
        e.preventDefault();
        return;
      } else {
        //selecting
        var self = this;
        if (checkbox.val() === "no") {
          individualActionPlan.launchModal(data.selected, checkbox.closest('tr').children(':nth(2)').find('span').text(), log.getReason(patientId, ACTIONID), false, function() {
            log.editAction(patientId, ACTIONID, false, null, log.reason);
            $(self).removeClass("inactive");

            checkbox.attr("checked", "checked");
            checkbox.parent().addClass("active");
            //unselect other
            other.removeClass("active").addClass("inactive");
            other.find("input[type=checkbox]").prop("checked", false);
            welcome.updateWelcomePage();
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.editAction(patientId, ACTIONID, true);
          $(this).removeClass("inactive");

          //unselect other
          other.removeClass("active").addClass("inactive");
          other.find("input[type=checkbox]").prop("checked", false);
        }
      }
    });

    welcome.updateWelcomePage();
  },

  updateWelcomePage: function() {
    $('#team-task-panel').add('#individual-task-panel').find('.suggestion').each(function() {
      $(this).find('td').last().children().hide();
    });

    $('#team-task-panel').add('#individual-task-panel').find('.cr-styled input[type=checkbox]').each(function() {
      if (this.checked) {
        $(this).parent().parent().parent().addClass('success');
      } else {
        $(this).parent().parent().parent().removeClass('success');
      }
    });

    $('#team-task-panel').add('#individual-task-panel').find('.btn-undo').each(function() {
      $(this).parent().parent().addClass('success');
    });

    //no class - user not yet agreed/disagreed - no background / muted text
    //active - user agrees - green background / normal text
    //success - user completed - green background / strikethrough text
    //danger - user disagrees - red background / strikethrough text
    $('#team-task-panel').add('#individual-task-panel').find('tr').each(function() {
      var self = $(this);
      var any = false;
      self.find('.btn-toggle input[type=checkbox]:checked').each(function() {
        any = true;
        if (this.value === "yes") {
          self.removeClass('danger');
          self.addClass('active');
          self.find('td').last().children().show();
          if (log.getActions().team[self.data("id")] && log.getActions().team[self.data("id")].history) {
            var tool = $(this).closest('tr').hasClass('success') ? "" : "<p>" + log.getActions().team[self.data("id")].history[0] + "</p><p>Click again to cancel</p>";
            $(this).parent().attr("title", tool).attr("data-original-title", tool).tooltip('fixTitle').tooltip('hide');
          } else {
            $(this).parent().attr("title", "You agreed - click again to cancel").tooltip('fixTitle').tooltip('hide');
          }
        } else {
          self.removeClass('active');
          self.addClass('danger');
          self.removeClass('success');
          if (log.getActions().team[self.data("id")] && log.getActions().team[self.data("id")].history) {
            $(this).parent().attr("title", "<p>" + log.getActions().team[self.data("id")].history[0] + "</p><p>Click again to edit/cancel</p>").tooltip('fixTitle').tooltip('hide');
          } else {
            $(this).parent().attr("title", "You disagreed - click again to edit/cancel").tooltip('fixTitle').tooltip('hide');
          }
        }
      });
      if (self.find('.btn-toggle input[type=checkbox]:not(:checked)').length == 1) {
        self.find('.btn-toggle input[type=checkbox]:not(:checked)').parent().addClass("inactive").attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
      }
      if (!any) {
        self.removeClass('danger');
        self.removeClass('active');
        self.removeClass('success');

        self.find('.btn-toggle.btn-yes').attr("title", "Click to agree with this action and save it in your agreed actions list  ").tooltip('fixTitle').tooltip('hide');
        self.find('.btn-toggle.btn-no').attr("title", "Click to disagree with this action and remove it from your suggested actions list ").tooltip('fixTitle').tooltip('hide');
      }

      base.wireUpTooltips();
    });

    base.wireUpTooltips();
  },

  populate: function(complete) {

    var k,l;
    //add tasks
    var teamTasks = [];
    var individualTasks = [];

    //Add the team tasks
    for (k in log.listActions("team")) {
      if (log.listActions("team")[k].agree && ((!log.listActions("team")[k].done && !complete) || (log.listActions("team")[k].done && complete))) {
        teamTasks.push({
          "pathway": "N/A",
          "task": log.text[log.listActions("team")[k].id].text,
          "data": log.listActions("team")[k].id,
          "tpId": "team",
          "agree": true,
          "done": complete
        });
      }
    }

    //Add the user added team tasks
    for (k in log.listPlans("team")) {
      if ((!log.listPlans("team")[k].done && !complete) || (log.listPlans("team")[k].done && complete)) {
        teamTasks.push({
          "canEdit": true,
          "pathway": data.pathwayNames[log.listPlans("team")[k].pathwayId],
          "pathwayId": log.listPlans("team")[k].pathwayId,
          "task": log.listPlans("team")[k].text,
          "data": log.listPlans("team")[k].id,
          "agree": log.listPlans("team")[k].agree,
          "disagree": log.listPlans("team")[k].agree === false,
          "done": complete
        });
      }
    }

    //Add individual
    for (k in log.listActions()) {
      if (k === "team") continue;
      for (l in log.listActions()[k]) {
        if (log.text[l] && log.listActions()[k][l].agree && ((!log.listActions()[k][l].done && !complete) || (log.listActions()[k][l].done && complete))) {
          individualTasks.push({
            "pathway": "N/A",
            "patientId": k,
            "task": log.text[l].text,
            "pathwayId": log.listPlans()[k][l].pathwayId,
            "data": l,
            "tpId": k,
            "agree": true,
            "done": complete
          });
        }
      }
    }

    //Add custom individual
    for (k in log.listPlans()) {
      if (k === "team") continue;
      for (l in log.listPlans()[k]) {
        if (log.listPlans()[k][l].text && (!log.listPlans()[k][l].done && !complete) || (log.listPlans()[k][l].done && complete)) {
          individualTasks.push({
            "canEdit": true,
            "pathway": data.pathwayNames[log.listPlans()[k][l].pathwayId],
            "pathwayId": log.listPlans()[k][l].pathwayId,
            "patientId": k,
            "tpId": k,
            "task": log.listPlans()[k][l].text,
            "data": l,
            "agree": true,
            "done": complete
          });
        }
      }
    }

    var listTemplate = $('#welcome-task-list').html();
    Mustache.parse(listTemplate);
    $('#welcome-tab-content').html(Mustache.render(listTemplate));

    var addTemplate = $('#action-plan').html();
    Mustache.parse(addTemplate);
    var rendered = Mustache.render(addTemplate);
    $('#team-add-plan').html(rendered);

    var tempMust = $('#welcome-task-items').html();
    var itemTemplate = $('#welcome-task-item').html();
    Mustache.parse(tempMust);
    Mustache.parse(itemTemplate);

    $('#team-add-plan').off('click').on('click', '.add-plan', function() {
      var plan = $(this).parent().parent().find('textarea').val();
      var planId = recordPlan("team", plan, "custom");
      $('#team-task-panel').find('table tbody').append(Mustache.render(itemTemplate, {
        "pathway": "",
        "pathwayId": "custom",
        "canEdit": true,
        "task": plan,
        "data": planId,
        "agree": null,
        "done": null
      }, {
        "chk": $('#checkbox-template').html()
      }));
    });

    rendered = Mustache.render(tempMust, {
      "tasks": teamTasks,
      "hasTasks": teamTasks.length > 0
    }, {
      "task-item": itemTemplate,
      "chk": $('#checkbox-template').html()
    });
    $('#team-task-panel').children().not(":first").remove();
    $('#team-task-panel').append(rendered);

    rendered = Mustache.render(tempMust, {
      "tasks": individualTasks,
      "isPatientTable": true,
      "hasTasks": individualTasks.length > 0
    }, {
      "task-item": itemTemplate,
      "chk": $('#checkbox-template').html()
    });
    $('#individual-task-panel').children().not(":first").remove();
    $('#individual-task-panel').append(rendered);

    welcome.wireUpWelcomePage();
  }

};

module.exports = welcome;

},{"../base.js":7,"../data.js":9,"../log.js":11,"./individualActionPlan.js":21,"./teamActionPlan.js":29,"mustache":4}],32:[function(require,module,exports){
var data = require('../data.js'),
  chart = require('../chart.js');

var bd = {

  wireUp: function() {

  },

  show: function(panel, isAppend, subPanels, isDownText, isUpText) {

    var sectionElement = $('<div class="section"></div>');

    if (isAppend) panel.append(sectionElement);
    else panel.html(sectionElement);

    subPanels.forEach(function(v) {
      var args = v.args;
      args.unshift(true);
      args.unshift(sectionElement);
      v.show.apply(null, args);
    });

    if (isUpText) sectionElement.prepend($('<div class="fp-controlArrow fp-up"><div>' + isUpText + '</div></div>'));
    if (isDownText) sectionElement.append($('<div class="fp-controlArrow fp-down"><div>' + isDownText + '</div></div>'));

  }

};

module.exports = bd;

},{"../chart.js":8,"../data.js":9}],33:[function(require,module,exports){
var data = require('./data.js'),
  lookup = require('./lookup.js'),
  base = require('./base.js'),
  patients = require('./panels/patients.js'),
  patientList = require('./panels/patientList.js'),
  teamActionPlan = require('./panels/teamActionPlan.js'),
  allPatients = require('./panels/allPatients.js'),
  welcome = require('./panels/welcome.js'),
  layout = require('./layout.js'),
  overview = require('./views/overview.js'),
  indicatorView = require('./views/indicator.js'),
  patientView = require('./views/patient.js'),
  actionPlan = require('./views/actions.js'),
  Mustache = require('mustache');

var template = {

  loadContent: function(hash, isPoppingState) {
    console.time("1");
    base.hideTooltips();
    console.timeEnd("1");

    console.time("2");

    var i, pathwayId, pathwayStage, standard, indicator, patientId;
    if (!isPoppingState) {
      window.location.hash = hash;
    }
    console.timeEnd("2");
    console.time("3");

    if (hash === '') {
      base.clearBox();
      base.showFooter();
      layout.showPage('login');
      $('html').removeClass('scroll-bar');
    } else {
      base.hideFooter();
      console.timeEnd("3");
      console.time("4");
      $('html').addClass('scroll-bar');
      console.timeEnd("4");
      console.time("5");
      var params = {};
      var urlBits = hash.split('/');

      if (hash.indexOf('?') > -1) {
        hash.split('?')[1].split('&').forEach(function(param) {
          var elems = param.split("=");
          params[elems[0]] = elems[1];
        });
        urlBits = hash.split('?')[0].split('/');
      }
      console.timeEnd("5");
      console.time("6");
      if (urlBits[0] === "#overview" && !urlBits[1]) {

        overview.create(template.loadContent);

      } else if (urlBits[0] === "#indicators") {

        indicatorView.create(urlBits[1], urlBits[2], urlBits[3], params.tab || "trend", template.loadContent);
        console.timeEnd("6");
      } else if (urlBits[0] === "#main") {
        base.clearBox();
        pathwayId = urlBits[1];
        data.pathwayId = pathwayId;
        pathwayStage = urlBits[2];
        var yesPeople = urlBits[3] !== "no";
        standard = urlBits[4];

        if (pathwayStage && layout.page !== 'main-dashboard') {
          $('.page').hide();
          $('#main-dashboard').show();

          ////layout.showSidePanel();
          layout.showOverviewPanels();
          layout.showHeaderBarItems();
        }

        if (pathwayStage) {
          if (yesPeople) {
            template.showPathwayStageViewOk(pathwayId, pathwayStage, template.shouldWeFade(lookup.currentUrl, hash));
          } else {
            template.showPathwayStageView(pathwayId, pathwayStage, standard, template.shouldWeFade(lookup.currentUrl, hash));
          }
        } else {
          template.showOverview(pathwayId);
        }

        base.wireUpTooltips();

      } else if (urlBits[0] === "#help") {
        base.clearBox();
        base.selectTab("");
        layout.showPage('help-page');

        layout.showHeaderBarItems();

      } else if (urlBits[0] === "#patient") {

        //create(pathwayId, pathwayStage, standard, patientId)
        patientView.create(urlBits[2], urlBits[3], urlBits[4], urlBits[1], template.loadContent);

      } else if (urlBits[0] === "#patients") {

        patientId = urlBits[1];

        patientView.create(null, null, null, patientId, template.loadContent);
        /*pathwayId = urlBits[2];

        allPatients.showView(patientId, true);

        base.wireUpTooltips();

        if (patientId) {
          var nhs = data.patLookup ? data.patLookup[patientId] : patientId;
          $('#patients').find('div.table-scroll').getNiceScroll().doScrollPos(0, $('#patients td').filter(function() {
            return $(this).text().trim() === nhs;
          }).position().top - 140);
          $('#patients').find('tr:contains(' + nhs + ')').addClass("highlighted");
        }*/
      } else if (urlBits[0] === "#agreedactions") {

        actionPlan.create();

      } else {
        //if screen not in correct segment then select it
        alert("shouldn't get here");
        pathwayStage = hash.substr(1);

        template.showPathwayStageView(pathwayStage);

        base.wireUpTooltips();
      }
    }

    lookup.currentUrl = hash;
  },

  //Show the overview page for a disease
  showOverview: function(disease) {
    data.pathwayId = disease;

    layout.showMainView(data.diseases.map(function(v) {
      return v.id;
    }).indexOf(disease));

    $('aside li ul li').removeClass('active');
    $('aside a[href="#main/' + disease + '"]:contains("Overview")').parent().addClass('active');

    $('#mainTitle').show();
    base.updateTitle(data[data.pathwayId]["display-name"] + ": Overview (practice-level data)");

    //Show overview panels
    template.showOverviewPanels();
    teamActionPlan.show(farRightPanel);
  },

  showOverviewPanels: function() {
    base.switchTo221Layout();

    template.showPanel(lookup.categories.diagnosis.name, topLeftPanel, true);
    template.showPanel(lookup.categories.monitoring.name, topRightPanel, true);
    template.showPanel(lookup.categories.treatment.name, bottomLeftPanel, true);
    template.showPanel(lookup.categories.exclusions.name, bottomRightPanel, true);

    base.wireUpTooltips();
  },

  showPanel: function(pathwayStage, location, enableHover) {
    base.showPathwayStageOverviewPanel(location, enableHover, data.pathwayId, pathwayStage);

    if (enableHover) template.highlightOnHoverAndEnableSelectByClick(location);
    else location.children('div').addClass('unclickable');
  },

  //Show the pathway stage for a disease
  showPathwayStageView: function(pathwayId, pathwayStage, standard, shouldFade) {
    farRightPanel.removeClass('standard-missed-page').removeClass('standard-achieved-page').removeClass('standard-not-relevant-page');
    data.pathwayId = pathwayId;
    layout.showMainView(data.diseases.map(function(v) {
      return v.id;
    }).indexOf(pathwayId));

    $('aside li ul li').removeClass('active');
    var re = new RegExp(pathwayStage, "g");
    $('aside a').filter(function() {
      return this.href.match(re);
    }).parent().addClass('active');

    base.switchTo110Layout();

    if (!standard) {
      standard = Object.keys(data[pathwayId][pathwayStage].standards)[0];
    }

    var panel = patients.create(pathwayId, pathwayStage, standard);

    if (shouldFade) {
      farLeftPanel.fadeOut(100, function() {
        $(this).html(panel);
        patients.wireUp(pathwayId, pathwayStage, farLeftPanel, standard);
        patientList.populate(pathwayId, pathwayStage, standard, null);
        $('#mainTitle').hide();
        base.updateTitle(data[pathwayId][pathwayStage].text.page.text, data[pathwayId][pathwayStage].text.page.tooltip);
        $(this).fadeIn(100);
      });
    } else {
      farLeftPanel.html(panel);
      patients.wireUp(pathwayId, pathwayStage, farLeftPanel, standard);
      patientList.populate(pathwayId, pathwayStage, standard, null);
      $('#mainTitle').hide();
      base.updateTitle(data[pathwayId][pathwayStage].text.page.text, data[pathwayId][pathwayStage].text.page.tooltip);
    }

    var tempMust = $('#patient-panel-placeholder').html();
    farRightPanel.html(Mustache.render(tempMust));
  },

  showPathwayStageViewOk: function(pathwayId, pathwayStage, shouldFade) {
    farRightPanel.removeClass('standard-missed-page').removeClass('standard-achieved-page').removeClass('standard-not-relevant-page');
    layout.showMainView(data.diseases.map(function(v) {
      return v.id;
    }).indexOf(pathwayId));

    $('aside li ul li').removeClass('active');
    var re = new RegExp(pathwayStage, "g");
    $('aside a').filter(function() {
      return this.href.match(re);
    }).parent().addClass('active');

    base.switchTo110Layout();

    var panel = patients.createOk(pathwayId, pathwayStage);

    if (shouldFade) {
      farLeftPanel.fadeOut(200, function() {
        $(this).html(panel);
        patients.wireUpOk(pathwayId, pathwayStage, farLeftPanel);
        patients.populateOk(pathwayId, pathwayStage, null);
        $('#mainTitle').hide();
        base.updateTitle(data[pathwayId][pathwayStage].text.page.text, data[pathwayId][pathwayStage].text.page.tooltip);
        $(this).fadeIn(300);
      });
      var tempMust = $('#patient-panel-placeholder').html();
      farRightPanel.html(Mustache.render(tempMust));
    } else {
      farLeftPanel.html(panel);
      patients.wireUpOk(pathwayId, pathwayStage, farLeftPanel);
      patients.populateOk(pathwayId, pathwayStage, null);
      $('#mainTitle').hide();
      base.updateTitle(data[pathwayId][pathwayStage].text.page.text, data[pathwayId][pathwayStage].text.page.tooltip);
    }
  },

  highlightOnHoverAndEnableSelectByClick: function(panelSelector) {
    panelSelector.children('div').removeClass('unclickable').on('mouseover', function() {
      $(this).removeClass('panel-default');
    }).on('mouseout', function(e) {
      $(this).addClass('panel-default');
    }).on('click', 'tr.standard-row', function(e) {
      history.pushState(null, null, '#main/' + data.pathwayId + '/' + $(this).closest('.panel').data('stage') + '/no/' + $(this).data('standard'));
      template.loadContent('#main/' + data.pathwayId + '/' + $(this).closest('.panel').data('stage') + '/no/' + $(this).data('standard'), true);
      // do not give a default action
      e.preventDefault();
      e.stopPropagation();
      return false;
    }).on('click', function(e) {
      // keep the link in the browser history
      history.pushState(null, null, '#main/' + data.pathwayId + '/' + $(this).data('stage') + '/no');
      template.loadContent('#main/' + data.pathwayId + '/' + $(this).data('stage') + '/no', true);
      // do not give a default action
      return false;
    });

  },

  displaySelectedPatient: function(id) {
    var nhs = data.patLookup ? data.patLookup[id] : id;

    history.pushState(null, null, '#patients/' + id);
    template.loadContent('#patients/' + id, true);

    $('.list-item').removeClass('highlighted');
    $('.list-item:has(button[data-clipboard-text=' + nhs + '])').addClass('highlighted');

    //scroll to patients
    $('#patients').find('div.table-scroll').getNiceScroll().doScrollPos(0, $('#patients td').filter(function() {
      return $(this).text().trim() === nhs;
    }).position().top - 140);
  },

  shouldWeFade: function(oldHash, newHash) {
    oldHash = oldHash.split('/');
    newHash = newHash.split('/');

    if (oldHash[0] === newHash[0] && oldHash[1] === newHash[1] && oldHash[2] === newHash[2] && oldHash[0] && newHash[0]) return false;
    return true;
  }

};

module.exports = template;

},{"./base.js":7,"./data.js":9,"./layout.js":10,"./lookup.js":12,"./panels/allPatients.js":15,"./panels/patientList.js":25,"./panels/patients.js":27,"./panels/teamActionPlan.js":29,"./panels/welcome.js":31,"./views/actions.js":34,"./views/indicator.js":35,"./views/overview.js":36,"./views/patient.js":37,"mustache":4}],34:[function(require,module,exports){
var base = require('../base.js'),
  layout = require('../layout.js'),
  welcome = require('../panels/welcome.js');

var ID = "ACTION_PLAN_VIEW";

var ap = {

  create: function() {

    base.selectTab("actions");

    if(layout.view !== ID) {
      //Not already in this view so we need to rejig a few things
      base.clearBox();
      layout.showPage('welcome');
      layout.showHeaderBarItems();

      $('#welcome-tabs li').removeClass('active');
      $('#outstandingTasks').closest('li').addClass('active');

      layout.view = ID;
    }

    welcome.populate();

  }

};

module.exports = ap;

},{"../base.js":7,"../layout.js":10,"../panels/welcome.js":31}],35:[function(require,module,exports){
var base = require('../base.js'),
  data = require('../data.js'),
  patientList = require('../panels/patientList.js'),
  indicatorBreakdown = require('../panels/indicatorBreakdown.js'),
  indicatorBenchmark = require('../panels/indicatorBenchmark.js'),
  indicatorTrend = require('../panels/indicatorTrend.js'),
  teamActionPlan = require('../panels/teamActionPlan.js'),
  wrapper = require('../panels/wrapper.js'),
  layout = require('../layout.js');

var ID = "INDICATOR";
/*
 * The indicator page consists of the panels:
 *   Tabbed panel
 *     - performance trend
 *     - performance benchmark
 *   Patient groups
 *   Patient list
 *   Team action plan
 */

var ind = {

  create: function(pathwayId, pathwayStage, standard, tab, loadContentFn) {

    base.selectTab("indicator");
    $('.loading-container').show();


    //use a setTimeout to force the UI to change e.g. show the loading-container
    //before further execution
    setTimeout(function() {
      if (layout.view !== ID) {
        //Not already in this view so we need to rejig a few things
        base.clearBox();
        //base.switchTo21Layout();
        layout.showMainView();

        base.removeFullPage(farRightPanel);
        base.hidePanels(farRightPanel);

        layout.view = ID;
      }

      if (!pathwayId) {
        if (layout.pathwayId) pathwayId = layout.pathwayId;
        else pathwayId = Object.keys(data.pathwayNames)[0];
      }

      if (!pathwayStage) {
        if (layout.pathwayStage) pathwayStage = layout.pathwayStage;
        else pathwayStage = "monitoring";
      }

      if (!standard) {
        if (layout.standard) standard = layout.standard;
        else standard = Object.keys(data[pathwayId][pathwayStage].standards)[0];
      }

      if (layout.pathwayId !== pathwayId || layout.pathwayStage !== pathwayStage) {
        //different pathway or stage so title needs updating
        base.updateTitle([{
          title: "Overview",
          url: "#overview"
        }, {
          title: data[pathwayId][pathwayStage].text.page.text,
          tooltip: data[pathwayId][pathwayStage].text.page.tooltip
        }]);
        $('#mainTitle').show();
      }

      layout.pathwayId = pathwayId;
      layout.pathwayStage = pathwayStage;
      layout.standard = standard;

      //TODO not sure if this needs moving..?
      data.pathwayId = pathwayId;

      //The three panels we need to show
      //Panels decide whether they need to redraw themselves
      teamActionPlan.show(farLeftPanel);

      base.updateTab("indicators", [pathwayId.toUpperCase(), standard.toUpperCase()].join(" "), [pathwayId, pathwayStage, standard].join("/"));

      wrapper.show(farRightPanel, false, [
        {
          show: indicatorBreakdown.show,
          args: [pathwayId, pathwayStage, standard, patientList.selectSubsection]
        }, {
          show: patientList.show,
          args: [pathwayId, pathwayStage, standard, loadContentFn]
        }
      ], "Scroll down or click for your performance over time", false);
      wrapper.show(farRightPanel, true, [
        {
          show: indicatorTrend.show,
          args: [pathwayId, pathwayStage, standard]
        }
      ], "Scroll down or click for your performance benchmark", "Scroll up or click for your patients at risk");
      wrapper.show(farRightPanel, true, [
        {
          show: indicatorBenchmark.show,
          args: [pathwayId, pathwayStage, standard]
        }
      ], false, "Scroll up or click for your performance over time");

      base.addFullPage(farRightPanel);

      $('#indicator-pane').show();

      base.wireUpTooltips();

      $('.loading-container').fadeOut(1000);
    }, 0);
  }

};

module.exports = ind;

},{"../base.js":7,"../data.js":9,"../layout.js":10,"../panels/indicatorBenchmark.js":17,"../panels/indicatorBreakdown.js":18,"../panels/indicatorTrend.js":20,"../panels/patientList.js":25,"../panels/teamActionPlan.js":29,"../panels/wrapper.js":32}],36:[function(require,module,exports){
var base = require('../base.js'),
  data = require('../data.js'),
  layout = require('../layout.js'),
  indicatorList = require('../panels/indicatorList.js'),
  teamActionPlan = require('../panels/teamActionPlan.js');

var ID = "OVERVIEW";
/*
 * The overview page consists of the panels:
 *   Indicator list
 *   Team action plan
 */
var overview = {

  create: function(loadContentFn) {

    base.selectTab("overview");

    if (layout.view !== ID) {
      //Not already in this view so we need to rejig a few things
      base.clearBox();
      //base.switchTo101Layout();
      layout.showMainView();

      $('#mainTitle').show();
      base.updateTitle("Overview");

      base.removeFullPage(farRightPanel);
      base.hidePanels(farRightPanel);

      layout.view = ID;
    }

    data.pathwayId = "htn"; //TODO fudge

    //The two panels we need to show
    //Panels decide whether they need to redraw themselves
    teamActionPlan.show(farLeftPanel);
    indicatorList.show(farRightPanel, false, loadContentFn);

    $('#overview-pane').show();

    base.wireUpTooltips();

  }

};

module.exports = overview;

},{"../base.js":7,"../data.js":9,"../layout.js":10,"../panels/indicatorList.js":19,"../panels/teamActionPlan.js":29}],37:[function(require,module,exports){
var lifeline = require('../panels/lifeline.js'),
  data = require('../data.js'),
  base = require('../base.js'),
  layout = require('../layout.js'),
  individualActionPlan = require('../panels/individualActionPlan.js'),
  qualityStandard = require('../panels/qualityStandard.js'),
  patientSearch = require('../panels/patientSearch.js');

var ID = "PATIENT_VIEW";
/*
 * The patient page consists of the panels:
 *   Lifeline chart
 *   Individual action plan
 */

var pv = {

  wireUp: function() {

  },

  create: function(pathwayId, pathwayStage, standard, patientId, loadContentFn) {

    base.selectTab("patient");

    if (layout.view !== ID) {
      //Not already in this view so we need to rejig a few things
      base.clearBox();
      //base.switchTo21Layout();
      layout.showMainView();

      base.removeFullPage(farRightPanel);
      base.hidePanels(farRightPanel);

      layout.view = ID;
    }

    if (layout.pathwayId !== pathwayId || layout.pathwayStage !== pathwayStage ||
      layout.standard !== standard || layout.patientId !== patientId) {
      //different pathway or stage or patientId so title needs updating
      $('#mainTitle').show();

      if (pathwayId && pathwayStage && standard) {

        base.updateTitle([{
          title: "Overview",
          url: "#overview"
                }, {
          title: data[pathwayId][pathwayStage].text.page.text,
          tooltip: data[pathwayId][pathwayStage].text.page.tooltip,
          url: ["#overview", pathwayId, pathwayStage, standard].join("/")
                }, {
          title: patientId
                }]);
      } else {
        base.updateTitle([{
          title: "Overview",
          url: "#overview"
                }, {
          title: patientId
              }]);
      }
    }


    base.hidePanels(farLeftPanel);
    patientSearch.show(farRightPanel, false, loadContentFn);

    if (patientId) {
      base.updateTab("patients", patientId, patientId);

      layout.patientId = patientId;
      data.pathwayId = pathwayId;

      data.getPatientData(patientId, function(data) {
        lifeline.show(farRightPanel, true, patientId, data);
      });
      individualActionPlan.show(farLeftPanel, pathwayId, pathwayStage, standard, patientId);
      //qualityStandard.show($('#patient-pane'), pathwayId, pathwayStage, standard, patientId);

      $('#patient-pane').show();
    } else {
      base.updateTab("patients", "", patientId);
    }

    base.wireUpTooltips();

  },

  populate: function() {

  }

};

module.exports = pv;

},{"../base.js":7,"../data.js":9,"../layout.js":10,"../panels/individualActionPlan.js":21,"../panels/lifeline.js":22,"../panels/patientSearch.js":26,"../panels/qualityStandard.js":28}]},{},[6])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvaGlnaGNoYXJ0cy9oaWdoY2hhcnRzLW1vcmUuanMiLCJub2RlX21vZHVsZXMvaGlnaGNoYXJ0cy9oaWdoc3RvY2suanMiLCJub2RlX21vZHVsZXMvanF1ZXJ5LXNwYXJrbGluZS9qcXVlcnkuc3BhcmtsaW5lLmpzIiwibm9kZV9tb2R1bGVzL211c3RhY2hlL211c3RhY2hlLmpzIiwibm9kZV9tb2R1bGVzL3plcm9jbGlwYm9hcmQvZGlzdC9aZXJvQ2xpcGJvYXJkLmpzIiwic2NyaXB0LmpzIiwic3JjL2Jhc2UuanMiLCJzcmMvY2hhcnQuanMiLCJzcmMvZGF0YS5qcyIsInNyYy9sYXlvdXQuanMiLCJzcmMvbG9nLmpzIiwic3JjL2xvb2t1cC5qcyIsInNyYy9tYWluLmpzIiwic3JjL25vdGlmeS5qcyIsInNyYy9wYW5lbHMvYWxsUGF0aWVudHMuanMiLCJzcmMvcGFuZWxzL2NvbmZpcm0uanMiLCJzcmMvcGFuZWxzL2luZGljYXRvckJlbmNobWFyay5qcyIsInNyYy9wYW5lbHMvaW5kaWNhdG9yQnJlYWtkb3duLmpzIiwic3JjL3BhbmVscy9pbmRpY2F0b3JMaXN0LmpzIiwic3JjL3BhbmVscy9pbmRpY2F0b3JUcmVuZC5qcyIsInNyYy9wYW5lbHMvaW5kaXZpZHVhbEFjdGlvblBsYW4uanMiLCJzcmMvcGFuZWxzL2xpZmVsaW5lLmpzIiwic3JjL3BhbmVscy9tZWRpY2F0aW9uLmpzIiwic3JjL3BhbmVscy9vdGhlckNvZGVzLmpzIiwic3JjL3BhbmVscy9wYXRpZW50TGlzdC5qcyIsInNyYy9wYW5lbHMvcGF0aWVudFNlYXJjaC5qcyIsInNyYy9wYW5lbHMvcGF0aWVudHMuanMiLCJzcmMvcGFuZWxzL3F1YWxpdHlTdGFuZGFyZC5qcyIsInNyYy9wYW5lbHMvdGVhbUFjdGlvblBsYW4uanMiLCJzcmMvcGFuZWxzL3RyZW5kLmpzIiwic3JjL3BhbmVscy93ZWxjb21lLmpzIiwic3JjL3BhbmVscy93cmFwcGVyLmpzIiwic3JjL3RlbXBsYXRlLmpzIiwic3JjL3ZpZXdzL2FjdGlvbnMuanMiLCJzcmMvdmlld3MvaW5kaWNhdG9yLmpzIiwic3JjL3ZpZXdzL292ZXJ2aWV3LmpzIiwic3JjL3ZpZXdzL3BhdGllbnQuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeERBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsYkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdi9GQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcm5CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwaEZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDemFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNybkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25iQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0lBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pVQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNaQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN05BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6WUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvb0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNU5BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6WUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0SEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNWQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5Y0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoVEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIvKlxuIEhpZ2hjaGFydHMgSlMgdjQuMi40ICgyMDE2LTA0LTE0KVxuXG4gKGMpIDIwMDktMjAxNiBUb3JzdGVpbiBIb25zaVxuXG4gTGljZW5zZTogd3d3LmhpZ2hjaGFydHMuY29tL2xpY2Vuc2VcbiovXG4oZnVuY3Rpb24obSl7dHlwZW9mIG1vZHVsZT09PVwib2JqZWN0XCImJm1vZHVsZS5leHBvcnRzP21vZHVsZS5leHBvcnRzPW06bShIaWdoY2hhcnRzKX0pKGZ1bmN0aW9uKG0pe2Z1bmN0aW9uIEwoYSxiLGMpe3RoaXMuaW5pdChhLGIsYyl9dmFyIFE9bS5hcnJheU1pbixSPW0uYXJyYXlNYXgsdD1tLmVhY2gsSD1tLmV4dGVuZCx1PW0ubWVyZ2UsUz1tLm1hcCxvPW0ucGljayxCPW0ucEludCxHPW0uY29ycmVjdEZsb2F0LHA9bS5nZXRPcHRpb25zKCkucGxvdE9wdGlvbnMsaT1tLnNlcmllc1R5cGVzLHY9bS5leHRlbmRDbGFzcyxNPW0uc3BsYXQsdz1tLndyYXAsTj1tLkF4aXMsej1tLlRpY2ssST1tLlBvaW50LFQ9bS5Qb2ludGVyLFU9bS5DZW50ZXJlZFNlcmllc01peGluLEM9bS5UcmFja2VyTWl4aW4seD1tLlNlcmllcyx5PU1hdGgsRj15LnJvdW5kLEQ9eS5mbG9vcixPPXkubWF4LFY9bS5Db2xvcixyPWZ1bmN0aW9uKCl7fTtIKEwucHJvdG90eXBlLHtpbml0OmZ1bmN0aW9uKGEsYixcbmMpe3ZhciBkPXRoaXMsZz1kLmRlZmF1bHRPcHRpb25zO2QuY2hhcnQ9YjtkLm9wdGlvbnM9YT11KGcsYi5hbmd1bGFyP3tiYWNrZ3JvdW5kOnt9fTp2b2lkIDAsYSk7KGE9YS5iYWNrZ3JvdW5kKSYmdChbXS5jb25jYXQoTShhKSkucmV2ZXJzZSgpLGZ1bmN0aW9uKGEpe3ZhciBiPWEuYmFja2dyb3VuZENvbG9yLGc9Yy51c2VyT3B0aW9ucyxhPXUoZC5kZWZhdWx0QmFja2dyb3VuZE9wdGlvbnMsYSk7aWYoYilhLmJhY2tncm91bmRDb2xvcj1iO2EuY29sb3I9YS5iYWNrZ3JvdW5kQ29sb3I7Yy5vcHRpb25zLnBsb3RCYW5kcy51bnNoaWZ0KGEpO2cucGxvdEJhbmRzPWcucGxvdEJhbmRzfHxbXTtnLnBsb3RCYW5kcyE9PWMub3B0aW9ucy5wbG90QmFuZHMmJmcucGxvdEJhbmRzLnVuc2hpZnQoYSl9KX0sZGVmYXVsdE9wdGlvbnM6e2NlbnRlcjpbXCI1MCVcIixcIjUwJVwiXSxzaXplOlwiODUlXCIsc3RhcnRBbmdsZTowfSxkZWZhdWx0QmFja2dyb3VuZE9wdGlvbnM6e3NoYXBlOlwiY2lyY2xlXCIsXG5ib3JkZXJXaWR0aDoxLGJvcmRlckNvbG9yOlwic2lsdmVyXCIsYmFja2dyb3VuZENvbG9yOntsaW5lYXJHcmFkaWVudDp7eDE6MCx5MTowLHgyOjAseTI6MX0sc3RvcHM6W1swLFwiI0ZGRlwiXSxbMSxcIiNERERcIl1dfSxmcm9tOi1OdW1iZXIuTUFYX1ZBTFVFLGlubmVyUmFkaXVzOjAsdG86TnVtYmVyLk1BWF9WQUxVRSxvdXRlclJhZGl1czpcIjEwNSVcIn19KTt2YXIgQT1OLnByb3RvdHlwZSx6PXoucHJvdG90eXBlLFc9e2dldE9mZnNldDpyLHJlZHJhdzpmdW5jdGlvbigpe3RoaXMuaXNEaXJ0eT0hMX0scmVuZGVyOmZ1bmN0aW9uKCl7dGhpcy5pc0RpcnR5PSExfSxzZXRTY2FsZTpyLHNldENhdGVnb3JpZXM6cixzZXRUaXRsZTpyfSxQPXtpc1JhZGlhbDohMCxkZWZhdWx0UmFkaWFsR2F1Z2VPcHRpb25zOntsYWJlbHM6e2FsaWduOlwiY2VudGVyXCIseDowLHk6bnVsbH0sbWlub3JHcmlkTGluZVdpZHRoOjAsbWlub3JUaWNrSW50ZXJ2YWw6XCJhdXRvXCIsbWlub3JUaWNrTGVuZ3RoOjEwLG1pbm9yVGlja1Bvc2l0aW9uOlwiaW5zaWRlXCIsXG5taW5vclRpY2tXaWR0aDoxLHRpY2tMZW5ndGg6MTAsdGlja1Bvc2l0aW9uOlwiaW5zaWRlXCIsdGlja1dpZHRoOjIsdGl0bGU6e3JvdGF0aW9uOjB9LHpJbmRleDoyfSxkZWZhdWx0UmFkaWFsWE9wdGlvbnM6e2dyaWRMaW5lV2lkdGg6MSxsYWJlbHM6e2FsaWduOm51bGwsZGlzdGFuY2U6MTUseDowLHk6bnVsbH0sbWF4UGFkZGluZzowLG1pblBhZGRpbmc6MCxzaG93TGFzdExhYmVsOiExLHRpY2tMZW5ndGg6MH0sZGVmYXVsdFJhZGlhbFlPcHRpb25zOntncmlkTGluZUludGVycG9sYXRpb246XCJjaXJjbGVcIixsYWJlbHM6e2FsaWduOlwicmlnaHRcIix4Oi0zLHk6LTJ9LHNob3dMYXN0TGFiZWw6ITEsdGl0bGU6e3g6NCx0ZXh0Om51bGwscm90YXRpb246OTB9fSxzZXRPcHRpb25zOmZ1bmN0aW9uKGEpe2E9dGhpcy5vcHRpb25zPXUodGhpcy5kZWZhdWx0T3B0aW9ucyx0aGlzLmRlZmF1bHRSYWRpYWxPcHRpb25zLGEpO2lmKCFhLnBsb3RCYW5kcylhLnBsb3RCYW5kcz1bXX0sZ2V0T2Zmc2V0OmZ1bmN0aW9uKCl7QS5nZXRPZmZzZXQuY2FsbCh0aGlzKTtcbnRoaXMuY2hhcnQuYXhpc09mZnNldFt0aGlzLnNpZGVdPTA7dGhpcy5jZW50ZXI9dGhpcy5wYW5lLmNlbnRlcj1VLmdldENlbnRlci5jYWxsKHRoaXMucGFuZSl9LGdldExpbmVQYXRoOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5jZW50ZXIsYj1vKGIsY1syXS8yLXRoaXMub2Zmc2V0KTtyZXR1cm4gdGhpcy5jaGFydC5yZW5kZXJlci5zeW1ib2xzLmFyYyh0aGlzLmxlZnQrY1swXSx0aGlzLnRvcCtjWzFdLGIsYix7c3RhcnQ6dGhpcy5zdGFydEFuZ2xlUmFkLGVuZDp0aGlzLmVuZEFuZ2xlUmFkLG9wZW46ITAsaW5uZXJSOjB9KX0sc2V0QXhpc1RyYW5zbGF0aW9uOmZ1bmN0aW9uKCl7QS5zZXRBeGlzVHJhbnNsYXRpb24uY2FsbCh0aGlzKTtpZih0aGlzLmNlbnRlcil0aGlzLnRyYW5zQT10aGlzLmlzQ2lyY3VsYXI/KHRoaXMuZW5kQW5nbGVSYWQtdGhpcy5zdGFydEFuZ2xlUmFkKS8odGhpcy5tYXgtdGhpcy5taW58fDEpOnRoaXMuY2VudGVyWzJdLzIvKHRoaXMubWF4LXRoaXMubWlufHxcbjEpLHRoaXMubWluUGl4ZWxQYWRkaW5nPXRoaXMuaXNYQXhpcz90aGlzLnRyYW5zQSp0aGlzLm1pblBvaW50T2Zmc2V0OjB9LGJlZm9yZVNldFRpY2tQb3NpdGlvbnM6ZnVuY3Rpb24oKXt0aGlzLmF1dG9Db25uZWN0JiYodGhpcy5tYXgrPXRoaXMuY2F0ZWdvcmllcyYmMXx8dGhpcy5wb2ludFJhbmdlfHx0aGlzLmNsb3Nlc3RQb2ludFJhbmdlfHwwKX0sc2V0QXhpc1NpemU6ZnVuY3Rpb24oKXtBLnNldEF4aXNTaXplLmNhbGwodGhpcyk7aWYodGhpcy5pc1JhZGlhbCl7dGhpcy5jZW50ZXI9dGhpcy5wYW5lLmNlbnRlcj1tLkNlbnRlcmVkU2VyaWVzTWl4aW4uZ2V0Q2VudGVyLmNhbGwodGhpcy5wYW5lKTtpZih0aGlzLmlzQ2lyY3VsYXIpdGhpcy5zZWN0b3I9dGhpcy5lbmRBbmdsZVJhZC10aGlzLnN0YXJ0QW5nbGVSYWQ7dGhpcy5sZW49dGhpcy53aWR0aD10aGlzLmhlaWdodD10aGlzLmNlbnRlclsyXSpvKHRoaXMuc2VjdG9yLDEpLzJ9fSxnZXRQb3NpdGlvbjpmdW5jdGlvbihhLFxuYil7cmV0dXJuIHRoaXMucG9zdFRyYW5zbGF0ZSh0aGlzLmlzQ2lyY3VsYXI/dGhpcy50cmFuc2xhdGUoYSk6MCxvKHRoaXMuaXNDaXJjdWxhcj9iOnRoaXMudHJhbnNsYXRlKGEpLHRoaXMuY2VudGVyWzJdLzIpLXRoaXMub2Zmc2V0KX0scG9zdFRyYW5zbGF0ZTpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuY2hhcnQsZD10aGlzLmNlbnRlcixhPXRoaXMuc3RhcnRBbmdsZVJhZCthO3JldHVybnt4OmMucGxvdExlZnQrZFswXStNYXRoLmNvcyhhKSpiLHk6Yy5wbG90VG9wK2RbMV0rTWF0aC5zaW4oYSkqYn19LGdldFBsb3RCYW5kUGF0aDpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9dGhpcy5jZW50ZXIsZz10aGlzLnN0YXJ0QW5nbGVSYWQsZT1kWzJdLzIsaj1bbyhjLm91dGVyUmFkaXVzLFwiMTAwJVwiKSxjLmlubmVyUmFkaXVzLG8oYy50aGlja25lc3MsMTApXSxsPS8lJC8saCxmPXRoaXMuaXNDaXJjdWxhcjt0aGlzLm9wdGlvbnMuZ3JpZExpbmVJbnRlcnBvbGF0aW9uPT09XCJwb2x5Z29uXCI/XG5kPXRoaXMuZ2V0UGxvdExpbmVQYXRoKGEpLmNvbmNhdCh0aGlzLmdldFBsb3RMaW5lUGF0aChiLCEwKSk6KGE9TWF0aC5tYXgoYSx0aGlzLm1pbiksYj1NYXRoLm1pbihiLHRoaXMubWF4KSxmfHwoalswXT10aGlzLnRyYW5zbGF0ZShhKSxqWzFdPXRoaXMudHJhbnNsYXRlKGIpKSxqPVMoaixmdW5jdGlvbihhKXtsLnRlc3QoYSkmJihhPUIoYSwxMCkqZS8xMDApO3JldHVybiBhfSksYy5zaGFwZT09PVwiY2lyY2xlXCJ8fCFmPyhhPS1NYXRoLlBJLzIsYj1NYXRoLlBJKjEuNSxoPSEwKTooYT1nK3RoaXMudHJhbnNsYXRlKGEpLGI9Zyt0aGlzLnRyYW5zbGF0ZShiKSksZD10aGlzLmNoYXJ0LnJlbmRlcmVyLnN5bWJvbHMuYXJjKHRoaXMubGVmdCtkWzBdLHRoaXMudG9wK2RbMV0salswXSxqWzBdLHtzdGFydDpNYXRoLm1pbihhLGIpLGVuZDpNYXRoLm1heChhLGIpLGlubmVyUjpvKGpbMV0salswXS1qWzJdKSxvcGVuOmh9KSk7cmV0dXJuIGR9LGdldFBsb3RMaW5lUGF0aDpmdW5jdGlvbihhLFxuYil7dmFyIGM9dGhpcyxkPWMuY2VudGVyLGc9Yy5jaGFydCxlPWMuZ2V0UG9zaXRpb24oYSksaixsLGg7Yy5pc0NpcmN1bGFyP2g9W1wiTVwiLGRbMF0rZy5wbG90TGVmdCxkWzFdK2cucGxvdFRvcCxcIkxcIixlLngsZS55XTpjLm9wdGlvbnMuZ3JpZExpbmVJbnRlcnBvbGF0aW9uPT09XCJjaXJjbGVcIj8oYT1jLnRyYW5zbGF0ZShhKSkmJihoPWMuZ2V0TGluZVBhdGgoMCxhKSk6KHQoZy54QXhpcyxmdW5jdGlvbihhKXthLnBhbmU9PT1jLnBhbmUmJihqPWEpfSksaD1bXSxhPWMudHJhbnNsYXRlKGEpLGQ9ai50aWNrUG9zaXRpb25zLGouYXV0b0Nvbm5lY3QmJihkPWQuY29uY2F0KFtkWzBdXSkpLGImJihkPVtdLmNvbmNhdChkKS5yZXZlcnNlKCkpLHQoZCxmdW5jdGlvbihlLGIpe2w9ai5nZXRQb3NpdGlvbihlLGEpO2gucHVzaChiP1wiTFwiOlwiTVwiLGwueCxsLnkpfSkpO3JldHVybiBofSxnZXRUaXRsZVBvc2l0aW9uOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5jZW50ZXIsYj10aGlzLmNoYXJ0LFxuYz10aGlzLm9wdGlvbnMudGl0bGU7cmV0dXJue3g6Yi5wbG90TGVmdCthWzBdKyhjLnh8fDApLHk6Yi5wbG90VG9wK2FbMV0te2hpZ2g6MC41LG1pZGRsZTowLjI1LGxvdzowfVtjLmFsaWduXSphWzJdKyhjLnl8fDApfX19O3coQSxcImluaXRcIixmdW5jdGlvbihhLGIsYyl7dmFyIGs7dmFyIGQ9Yi5hbmd1bGFyLGc9Yi5wb2xhcixlPWMuaXNYLGo9ZCYmZSxsLGg7aD1iLm9wdGlvbnM7dmFyIGY9Yy5wYW5lfHwwO2lmKGQpe2lmKEgodGhpcyxqP1c6UCksbD0hZSl0aGlzLmRlZmF1bHRSYWRpYWxPcHRpb25zPXRoaXMuZGVmYXVsdFJhZGlhbEdhdWdlT3B0aW9uc31lbHNlIGlmKGcpSCh0aGlzLFApLHRoaXMuZGVmYXVsdFJhZGlhbE9wdGlvbnM9KGw9ZSk/dGhpcy5kZWZhdWx0UmFkaWFsWE9wdGlvbnM6dSh0aGlzLmRlZmF1bHRZQXhpc09wdGlvbnMsdGhpcy5kZWZhdWx0UmFkaWFsWU9wdGlvbnMpO2EuY2FsbCh0aGlzLGIsYyk7aWYoIWomJihkfHxnKSl7YT10aGlzLm9wdGlvbnM7aWYoIWIucGFuZXMpYi5wYW5lcz1cbltdO3RoaXMucGFuZT0oaz1iLnBhbmVzW2ZdPWIucGFuZXNbZl18fG5ldyBMKE0oaC5wYW5lKVtmXSxiLHRoaXMpLGY9ayk7Zj1mLm9wdGlvbnM7Yi5pbnZlcnRlZD0hMTtoLmNoYXJ0Lnpvb21UeXBlPW51bGw7dGhpcy5zdGFydEFuZ2xlUmFkPWI9KGYuc3RhcnRBbmdsZS05MCkqTWF0aC5QSS8xODA7dGhpcy5lbmRBbmdsZVJhZD1oPShvKGYuZW5kQW5nbGUsZi5zdGFydEFuZ2xlKzM2MCktOTApKk1hdGguUEkvMTgwO3RoaXMub2Zmc2V0PWEub2Zmc2V0fHwwO2lmKCh0aGlzLmlzQ2lyY3VsYXI9bCkmJmMubWF4PT09dm9pZCAwJiZoLWI9PT0yKk1hdGguUEkpdGhpcy5hdXRvQ29ubmVjdD0hMH19KTt3KEEsXCJhdXRvTGFiZWxBbGlnblwiLGZ1bmN0aW9uKGEpe2lmKCF0aGlzLmlzUmFkaWFsKXJldHVybiBhLmFwcGx5KHRoaXMsW10uc2xpY2UuY2FsbChhcmd1bWVudHMsMSkpfSk7dyh6LFwiZ2V0UG9zaXRpb25cIixmdW5jdGlvbihhLGIsYyxkLGcpe3ZhciBlPXRoaXMuYXhpcztyZXR1cm4gZS5nZXRQb3NpdGlvbj9cbmUuZ2V0UG9zaXRpb24oYyk6YS5jYWxsKHRoaXMsYixjLGQsZyl9KTt3KHosXCJnZXRMYWJlbFBvc2l0aW9uXCIsZnVuY3Rpb24oYSxiLGMsZCxnLGUsaixsLGgpe3ZhciBmPXRoaXMuYXhpcyxrPWUueSxuPTIwLHM9ZS5hbGlnbixpPShmLnRyYW5zbGF0ZSh0aGlzLnBvcykrZi5zdGFydEFuZ2xlUmFkK01hdGguUEkvMikvTWF0aC5QSSoxODAlMzYwO2YuaXNSYWRpYWw/KGE9Zi5nZXRQb3NpdGlvbih0aGlzLnBvcyxmLmNlbnRlclsyXS8yK28oZS5kaXN0YW5jZSwtMjUpKSxlLnJvdGF0aW9uPT09XCJhdXRvXCI/ZC5hdHRyKHtyb3RhdGlvbjppfSk6az09PW51bGwmJihrPWYuY2hhcnQucmVuZGVyZXIuZm9udE1ldHJpY3MoZC5zdHlsZXMuZm9udFNpemUpLmItZC5nZXRCQm94KCkuaGVpZ2h0LzIpLHM9PT1udWxsJiYoZi5pc0NpcmN1bGFyPyh0aGlzLmxhYmVsLmdldEJCb3goKS53aWR0aD5mLmxlbipmLnRpY2tJbnRlcnZhbC8oZi5tYXgtZi5taW4pJiYobj0wKSxzPWk+biYmaTwxODAtbj9cblwibGVmdFwiOmk+MTgwK24mJmk8MzYwLW4/XCJyaWdodFwiOlwiY2VudGVyXCIpOnM9XCJjZW50ZXJcIixkLmF0dHIoe2FsaWduOnN9KSksYS54Kz1lLngsYS55Kz1rKTphPWEuY2FsbCh0aGlzLGIsYyxkLGcsZSxqLGwsaCk7cmV0dXJuIGF9KTt3KHosXCJnZXRNYXJrUGF0aFwiLGZ1bmN0aW9uKGEsYixjLGQsZyxlLGope3ZhciBsPXRoaXMuYXhpcztsLmlzUmFkaWFsPyhhPWwuZ2V0UG9zaXRpb24odGhpcy5wb3MsbC5jZW50ZXJbMl0vMitkKSxiPVtcIk1cIixiLGMsXCJMXCIsYS54LGEueV0pOmI9YS5jYWxsKHRoaXMsYixjLGQsZyxlLGopO3JldHVybiBifSk7cC5hcmVhcmFuZ2U9dShwLmFyZWEse2xpbmVXaWR0aDoxLG1hcmtlcjpudWxsLHRocmVzaG9sZDpudWxsLHRvb2x0aXA6e3BvaW50Rm9ybWF0Oic8c3BhbiBzdHlsZT1cImNvbG9yOntzZXJpZXMuY29sb3J9XCI+XFx1MjVjZjwvc3Bhbj4ge3Nlcmllcy5uYW1lfTogPGI+e3BvaW50Lmxvd308L2I+IC0gPGI+e3BvaW50LmhpZ2h9PC9iPjxici8+J30sXG50cmFja0J5QXJlYTohMCxkYXRhTGFiZWxzOnthbGlnbjpudWxsLHZlcnRpY2FsQWxpZ246bnVsbCx4TG93OjAseEhpZ2g6MCx5TG93OjAseUhpZ2g6MH0sc3RhdGVzOntob3Zlcjp7aGFsbzohMX19fSk7aS5hcmVhcmFuZ2U9dihpLmFyZWEse3R5cGU6XCJhcmVhcmFuZ2VcIixwb2ludEFycmF5TWFwOltcImxvd1wiLFwiaGlnaFwiXSxkYXRhTGFiZWxDb2xsZWN0aW9uczpbXCJkYXRhTGFiZWxcIixcImRhdGFMYWJlbFVwcGVyXCJdLHRvWURhdGE6ZnVuY3Rpb24oYSl7cmV0dXJuW2EubG93LGEuaGlnaF19LHBvaW50VmFsS2V5OlwibG93XCIsZGVmZXJUcmFuc2xhdGVQb2xhcjohMCxoaWdoVG9YWTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNoYXJ0LGM9dGhpcy54QXhpcy5wb3N0VHJhbnNsYXRlKGEucmVjdFBsb3RYLHRoaXMueUF4aXMubGVuLWEucGxvdEhpZ2gpO2EucGxvdEhpZ2hYPWMueC1iLnBsb3RMZWZ0O2EucGxvdEhpZ2g9Yy55LWIucGxvdFRvcH0sdHJhbnNsYXRlOmZ1bmN0aW9uKCl7dmFyIGE9XG50aGlzLGI9YS55QXhpcztpLmFyZWEucHJvdG90eXBlLnRyYW5zbGF0ZS5hcHBseShhKTt0KGEucG9pbnRzLGZ1bmN0aW9uKGEpe3ZhciBkPWEubG93LGc9YS5oaWdoLGU9YS5wbG90WTtnPT09bnVsbHx8ZD09PW51bGw/YS5pc051bGw9ITA6KGEucGxvdExvdz1lLGEucGxvdEhpZ2g9Yi50cmFuc2xhdGUoZywwLDEsMCwxKSl9KTt0aGlzLmNoYXJ0LnBvbGFyJiZ0KHRoaXMucG9pbnRzLGZ1bmN0aW9uKGIpe2EuaGlnaFRvWFkoYil9KX0sZ2V0R3JhcGhQYXRoOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5wb2ludHMsYj1bXSxjPVtdLGQ9YS5sZW5ndGgsZz14LnByb3RvdHlwZS5nZXRHcmFwaFBhdGgsZSxqLGw7bD10aGlzLm9wdGlvbnM7Zm9yKHZhciBoPWwuc3RlcCxkPWEubGVuZ3RoO2QtLTspZT1hW2RdLCFlLmlzTnVsbCYmKCFhW2QrMV18fGFbZCsxXS5pc051bGwpJiZjLnB1c2goe3Bsb3RYOmUucGxvdFgscGxvdFk6ZS5wbG90TG93fSksaj17cGxvdFg6ZS5wbG90WCxwbG90WTplLnBsb3RIaWdoLFxuaXNOdWxsOmUuaXNOdWxsfSxjLnB1c2goaiksYi5wdXNoKGopLCFlLmlzTnVsbCYmKCFhW2QtMV18fGFbZC0xXS5pc051bGwpJiZjLnB1c2goe3Bsb3RYOmUucGxvdFgscGxvdFk6ZS5wbG90TG93fSk7YT1nLmNhbGwodGhpcyxhKTtpZihoKWg9PT0hMCYmKGg9XCJsZWZ0XCIpLGwuc3RlcD17bGVmdDpcInJpZ2h0XCIsY2VudGVyOlwiY2VudGVyXCIscmlnaHQ6XCJsZWZ0XCJ9W2hdO2I9Zy5jYWxsKHRoaXMsYik7Yz1nLmNhbGwodGhpcyxjKTtsLnN0ZXA9aDtsPVtdLmNvbmNhdChhLGIpOyF0aGlzLmNoYXJ0LnBvbGFyJiZjWzBdPT09XCJNXCImJihjWzBdPVwiTFwiKTt0aGlzLmFyZWFQYXRoPXRoaXMuYXJlYVBhdGguY29uY2F0KGEsYyk7cmV0dXJuIGx9LGRyYXdEYXRhTGFiZWxzOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5kYXRhLGI9YS5sZW5ndGgsYyxkPVtdLGc9eC5wcm90b3R5cGUsZT10aGlzLm9wdGlvbnMuZGF0YUxhYmVscyxqPWUuYWxpZ24sbD1lLnZlcnRpY2FsQWxpZ24saD1lLmluc2lkZSxmLFxuayxuPXRoaXMuY2hhcnQuaW52ZXJ0ZWQ7aWYoZS5lbmFibGVkfHx0aGlzLl9oYXNQb2ludExhYmVscyl7Zm9yKGM9YjtjLS07KWlmKGY9YVtjXSl7az1oP2YucGxvdEhpZ2g8Zi5wbG90TG93OmYucGxvdEhpZ2g+Zi5wbG90TG93O2YueT1mLmhpZ2g7Zi5fcGxvdFk9Zi5wbG90WTtmLnBsb3RZPWYucGxvdEhpZ2g7ZFtjXT1mLmRhdGFMYWJlbDtmLmRhdGFMYWJlbD1mLmRhdGFMYWJlbFVwcGVyO2YuYmVsb3c9aztpZihuKXtpZighaillLmFsaWduPWs/XCJyaWdodFwiOlwibGVmdFwifWVsc2UgaWYoIWwpZS52ZXJ0aWNhbEFsaWduPWs/XCJ0b3BcIjpcImJvdHRvbVwiO2UueD1lLnhIaWdoO2UueT1lLnlIaWdofWcuZHJhd0RhdGFMYWJlbHMmJmcuZHJhd0RhdGFMYWJlbHMuYXBwbHkodGhpcyxhcmd1bWVudHMpO2ZvcihjPWI7Yy0tOylpZihmPWFbY10pe2s9aD9mLnBsb3RIaWdoPGYucGxvdExvdzpmLnBsb3RIaWdoPmYucGxvdExvdztmLmRhdGFMYWJlbFVwcGVyPWYuZGF0YUxhYmVsO2YuZGF0YUxhYmVsPVxuZFtjXTtmLnk9Zi5sb3c7Zi5wbG90WT1mLl9wbG90WTtmLmJlbG93PSFrO2lmKG4pe2lmKCFqKWUuYWxpZ249az9cImxlZnRcIjpcInJpZ2h0XCJ9ZWxzZSBpZighbCllLnZlcnRpY2FsQWxpZ249az9cImJvdHRvbVwiOlwidG9wXCI7ZS54PWUueExvdztlLnk9ZS55TG93fWcuZHJhd0RhdGFMYWJlbHMmJmcuZHJhd0RhdGFMYWJlbHMuYXBwbHkodGhpcyxhcmd1bWVudHMpfWUuYWxpZ249ajtlLnZlcnRpY2FsQWxpZ249bH0sYWxpZ25EYXRhTGFiZWw6ZnVuY3Rpb24oKXtpLmNvbHVtbi5wcm90b3R5cGUuYWxpZ25EYXRhTGFiZWwuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxzZXRTdGFja2VkUG9pbnRzOnIsZ2V0U3ltYm9sOnIsZHJhd1BvaW50czpyfSk7cC5hcmVhc3BsaW5lcmFuZ2U9dShwLmFyZWFyYW5nZSk7aS5hcmVhc3BsaW5lcmFuZ2U9dihpLmFyZWFyYW5nZSx7dHlwZTpcImFyZWFzcGxpbmVyYW5nZVwiLGdldFBvaW50U3BsaW5lOmkuc3BsaW5lLnByb3RvdHlwZS5nZXRQb2ludFNwbGluZX0pO1xuKGZ1bmN0aW9uKCl7dmFyIGE9aS5jb2x1bW4ucHJvdG90eXBlO3AuY29sdW1ucmFuZ2U9dShwLmNvbHVtbixwLmFyZWFyYW5nZSx7bGluZVdpZHRoOjEscG9pbnRSYW5nZTpudWxsfSk7aS5jb2x1bW5yYW5nZT12KGkuYXJlYXJhbmdlLHt0eXBlOlwiY29sdW1ucmFuZ2VcIix0cmFuc2xhdGU6ZnVuY3Rpb24oKXt2YXIgYj10aGlzLGM9Yi55QXhpcyxkPWIueEF4aXMsZz1kLnN0YXJ0QW5nbGVSYWQsZSxqPWIuY2hhcnQsbD1iLnhBeGlzLmlzUmFkaWFsLGg7YS50cmFuc2xhdGUuYXBwbHkoYik7dChiLnBvaW50cyxmdW5jdGlvbihhKXt2YXIgaz1hLnNoYXBlQXJncyxuPWIub3B0aW9ucy5taW5Qb2ludExlbmd0aCxzLGk7YS5wbG90SGlnaD1oPWMudHJhbnNsYXRlKGEuaGlnaCwwLDEsMCwxKTthLnBsb3RMb3c9YS5wbG90WTtpPWg7cz1vKGEucmVjdFBsb3RZLGEucGxvdFkpLWg7TWF0aC5hYnMocyk8bj8obi09cyxzKz1uLGktPW4vMik6czwwJiYocyo9LTEsaS09cyk7bD8oZT1hLmJhclgrXG5nLGEuc2hhcGVUeXBlPVwicGF0aFwiLGEuc2hhcGVBcmdzPXtkOmIucG9sYXJBcmMoaStzLGksZSxlK2EucG9pbnRXaWR0aCl9KTooay5oZWlnaHQ9cyxrLnk9aSxhLnRvb2x0aXBQb3M9ai5pbnZlcnRlZD9bYy5sZW4rYy5wb3Mtai5wbG90TGVmdC1pLXMvMixkLmxlbitkLnBvcy1qLnBsb3RUb3Atay54LWsud2lkdGgvMixzXTpbZC5sZWZ0LWoucGxvdExlZnQray54K2sud2lkdGgvMixjLnBvcy1qLnBsb3RUb3AraStzLzIsc10pfSl9LGRpcmVjdFRvdWNoOiEwLHRyYWNrZXJHcm91cHM6W1wiZ3JvdXBcIixcImRhdGFMYWJlbHNHcm91cFwiXSxkcmF3R3JhcGg6cixjcmlzcENvbDphLmNyaXNwQ29sLHBvaW50QXR0clRvT3B0aW9uczphLnBvaW50QXR0clRvT3B0aW9ucyxkcmF3UG9pbnRzOmEuZHJhd1BvaW50cyxkcmF3VHJhY2tlcjphLmRyYXdUcmFja2VyLGdldENvbHVtbk1ldHJpY3M6YS5nZXRDb2x1bW5NZXRyaWNzLGFuaW1hdGU6ZnVuY3Rpb24oKXtyZXR1cm4gYS5hbmltYXRlLmFwcGx5KHRoaXMsXG5hcmd1bWVudHMpfSxwb2xhckFyYzpmdW5jdGlvbigpe3JldHVybiBhLnBvbGFyQXJjLmFwcGx5KHRoaXMsYXJndW1lbnRzKX19KX0pKCk7cC5nYXVnZT11KHAubGluZSx7ZGF0YUxhYmVsczp7ZW5hYmxlZDohMCxkZWZlcjohMSx5OjE1LGJvcmRlcldpZHRoOjEsYm9yZGVyQ29sb3I6XCJzaWx2ZXJcIixib3JkZXJSYWRpdXM6Myxjcm9wOiExLHZlcnRpY2FsQWxpZ246XCJ0b3BcIix6SW5kZXg6Mn0sZGlhbDp7fSxwaXZvdDp7fSx0b29sdGlwOntoZWFkZXJGb3JtYXQ6XCJcIn0sc2hvd0luTGVnZW5kOiExfSk7Qz17dHlwZTpcImdhdWdlXCIscG9pbnRDbGFzczp2KEkse3NldFN0YXRlOmZ1bmN0aW9uKGEpe3RoaXMuc3RhdGU9YX19KSxhbmd1bGFyOiEwLGRpcmVjdFRvdWNoOiEwLGRyYXdHcmFwaDpyLGZpeGVkQm94OiEwLGZvcmNlREw6ITAsdHJhY2tlckdyb3VwczpbXCJncm91cFwiLFwiZGF0YUxhYmVsc0dyb3VwXCJdLHRyYW5zbGF0ZTpmdW5jdGlvbigpe3ZhciBhPXRoaXMueUF4aXMsYj10aGlzLm9wdGlvbnMsXG5jPWEuY2VudGVyO3RoaXMuZ2VuZXJhdGVQb2ludHMoKTt0KHRoaXMucG9pbnRzLGZ1bmN0aW9uKGQpe3ZhciBnPXUoYi5kaWFsLGQuZGlhbCksZT1CKG8oZy5yYWRpdXMsODApKSpjWzJdLzIwMCxqPUIobyhnLmJhc2VMZW5ndGgsNzApKSplLzEwMCxsPUIobyhnLnJlYXJMZW5ndGgsMTApKSplLzEwMCxoPWcuYmFzZVdpZHRofHwzLGY9Zy50b3BXaWR0aHx8MSxrPWIub3ZlcnNob290LG49YS5zdGFydEFuZ2xlUmFkK2EudHJhbnNsYXRlKGQueSxudWxsLG51bGwsbnVsbCwhMCk7ayYmdHlwZW9mIGs9PT1cIm51bWJlclwiPyhrPWsvMTgwKk1hdGguUEksbj1NYXRoLm1heChhLnN0YXJ0QW5nbGVSYWQtayxNYXRoLm1pbihhLmVuZEFuZ2xlUmFkK2ssbikpKTpiLndyYXA9PT0hMSYmKG49TWF0aC5tYXgoYS5zdGFydEFuZ2xlUmFkLE1hdGgubWluKGEuZW5kQW5nbGVSYWQsbikpKTtuPW4qMTgwL01hdGguUEk7ZC5zaGFwZVR5cGU9XCJwYXRoXCI7ZC5zaGFwZUFyZ3M9e2Q6Zy5wYXRofHxbXCJNXCIsXG4tbCwtaC8yLFwiTFwiLGosLWgvMixlLC1mLzIsZSxmLzIsaixoLzIsLWwsaC8yLFwielwiXSx0cmFuc2xhdGVYOmNbMF0sdHJhbnNsYXRlWTpjWzFdLHJvdGF0aW9uOm59O2QucGxvdFg9Y1swXTtkLnBsb3RZPWNbMV19KX0sZHJhd1BvaW50czpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLnlBeGlzLmNlbnRlcixjPWEucGl2b3QsZD1hLm9wdGlvbnMsZz1kLnBpdm90LGU9YS5jaGFydC5yZW5kZXJlcjt0KGEucG9pbnRzLGZ1bmN0aW9uKGIpe3ZhciBnPWIuZ3JhcGhpYyxjPWIuc2hhcGVBcmdzLGY9Yy5kLGs9dShkLmRpYWwsYi5kaWFsKTtnPyhnLmFuaW1hdGUoYyksYy5kPWYpOmIuZ3JhcGhpYz1lW2Iuc2hhcGVUeXBlXShjKS5hdHRyKHtzdHJva2U6ay5ib3JkZXJDb2xvcnx8XCJub25lXCIsXCJzdHJva2Utd2lkdGhcIjprLmJvcmRlcldpZHRofHwwLGZpbGw6ay5iYWNrZ3JvdW5kQ29sb3J8fFwiYmxhY2tcIixyb3RhdGlvbjpjLnJvdGF0aW9uLHpJbmRleDoxfSkuYWRkKGEuZ3JvdXApfSk7Yz9jLmFuaW1hdGUoe3RyYW5zbGF0ZVg6YlswXSxcbnRyYW5zbGF0ZVk6YlsxXX0pOmEucGl2b3Q9ZS5jaXJjbGUoMCwwLG8oZy5yYWRpdXMsNSkpLmF0dHIoe1wic3Ryb2tlLXdpZHRoXCI6Zy5ib3JkZXJXaWR0aHx8MCxzdHJva2U6Zy5ib3JkZXJDb2xvcnx8XCJzaWx2ZXJcIixmaWxsOmcuYmFja2dyb3VuZENvbG9yfHxcImJsYWNrXCIsekluZGV4OjJ9KS50cmFuc2xhdGUoYlswXSxiWzFdKS5hZGQoYS5ncm91cCl9LGFuaW1hdGU6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztpZighYSl0KGIucG9pbnRzLGZ1bmN0aW9uKGEpe3ZhciBkPWEuZ3JhcGhpYztkJiYoZC5hdHRyKHtyb3RhdGlvbjpiLnlBeGlzLnN0YXJ0QW5nbGVSYWQqMTgwL01hdGguUEl9KSxkLmFuaW1hdGUoe3JvdGF0aW9uOmEuc2hhcGVBcmdzLnJvdGF0aW9ufSxiLm9wdGlvbnMuYW5pbWF0aW9uKSl9KSxiLmFuaW1hdGU9bnVsbH0scmVuZGVyOmZ1bmN0aW9uKCl7dGhpcy5ncm91cD10aGlzLnBsb3RHcm91cChcImdyb3VwXCIsXCJzZXJpZXNcIix0aGlzLnZpc2libGU/XCJ2aXNpYmxlXCI6XCJoaWRkZW5cIixcbnRoaXMub3B0aW9ucy56SW5kZXgsdGhpcy5jaGFydC5zZXJpZXNHcm91cCk7eC5wcm90b3R5cGUucmVuZGVyLmNhbGwodGhpcyk7dGhpcy5ncm91cC5jbGlwKHRoaXMuY2hhcnQuY2xpcFJlY3QpfSxzZXREYXRhOmZ1bmN0aW9uKGEsYil7eC5wcm90b3R5cGUuc2V0RGF0YS5jYWxsKHRoaXMsYSwhMSk7dGhpcy5wcm9jZXNzRGF0YSgpO3RoaXMuZ2VuZXJhdGVQb2ludHMoKTtvKGIsITApJiZ0aGlzLmNoYXJ0LnJlZHJhdygpfSxkcmF3VHJhY2tlcjpDJiZDLmRyYXdUcmFja2VyUG9pbnR9O2kuZ2F1Z2U9dihpLmxpbmUsQyk7cC5ib3hwbG90PXUocC5jb2x1bW4se2ZpbGxDb2xvcjpcIiNGRkZGRkZcIixsaW5lV2lkdGg6MSxtZWRpYW5XaWR0aDoyLHN0YXRlczp7aG92ZXI6e2JyaWdodG5lc3M6LTAuM319LHRocmVzaG9sZDpudWxsLHRvb2x0aXA6e3BvaW50Rm9ybWF0Oic8c3BhbiBzdHlsZT1cImNvbG9yOntwb2ludC5jb2xvcn1cIj5cXHUyNWNmPC9zcGFuPiA8Yj4ge3Nlcmllcy5uYW1lfTwvYj48YnIvPk1heGltdW06IHtwb2ludC5oaWdofTxici8+VXBwZXIgcXVhcnRpbGU6IHtwb2ludC5xM308YnIvPk1lZGlhbjoge3BvaW50Lm1lZGlhbn08YnIvPkxvd2VyIHF1YXJ0aWxlOiB7cG9pbnQucTF9PGJyLz5NaW5pbXVtOiB7cG9pbnQubG93fTxici8+J30sXG53aGlza2VyTGVuZ3RoOlwiNTAlXCIsd2hpc2tlcldpZHRoOjJ9KTtpLmJveHBsb3Q9dihpLmNvbHVtbix7dHlwZTpcImJveHBsb3RcIixwb2ludEFycmF5TWFwOltcImxvd1wiLFwicTFcIixcIm1lZGlhblwiLFwicTNcIixcImhpZ2hcIl0sdG9ZRGF0YTpmdW5jdGlvbihhKXtyZXR1cm5bYS5sb3csYS5xMSxhLm1lZGlhbixhLnEzLGEuaGlnaF19LHBvaW50VmFsS2V5OlwiaGlnaFwiLHBvaW50QXR0clRvT3B0aW9uczp7ZmlsbDpcImZpbGxDb2xvclwiLHN0cm9rZTpcImNvbG9yXCIsXCJzdHJva2Utd2lkdGhcIjpcImxpbmVXaWR0aFwifSxkcmF3RGF0YUxhYmVsczpyLHRyYW5zbGF0ZTpmdW5jdGlvbigpe3ZhciBhPXRoaXMueUF4aXMsYj10aGlzLnBvaW50QXJyYXlNYXA7aS5jb2x1bW4ucHJvdG90eXBlLnRyYW5zbGF0ZS5hcHBseSh0aGlzKTt0KHRoaXMucG9pbnRzLGZ1bmN0aW9uKGMpe3QoYixmdW5jdGlvbihiKXtjW2JdIT09bnVsbCYmKGNbYitcIlBsb3RcIl09YS50cmFuc2xhdGUoY1tiXSwwLDEsMCwxKSl9KX0pfSxkcmF3UG9pbnRzOmZ1bmN0aW9uKCl7dmFyIGE9XG50aGlzLGI9YS5vcHRpb25zLGM9YS5jaGFydC5yZW5kZXJlcixkLGcsZSxqLGwsaCxmLGssbixpLG0sSixLLHAsdSxyLHcsdix4LHksQyxCLHo9YS5kb1F1YXJ0aWxlcyE9PSExLEEsRT1hLm9wdGlvbnMud2hpc2tlckxlbmd0aDt0KGEucG9pbnRzLGZ1bmN0aW9uKHEpe249cS5ncmFwaGljO0M9cS5zaGFwZUFyZ3M7bT17fTtwPXt9O3I9e307Qj1xLmNvbG9yfHxhLmNvbG9yO2lmKHEucGxvdFkhPT12b2lkIDApaWYoZD1xLnBvaW50QXR0cltxLnNlbGVjdGVkP1wic2VsZWN0ZWRcIjpcIlwiXSx3PUMud2lkdGgsdj1EKEMueCkseD12K3cseT1GKHcvMiksZz1EKHo/cS5xMVBsb3Q6cS5sb3dQbG90KSxlPUQoej9xLnEzUGxvdDpxLmxvd1Bsb3QpLGo9RChxLmhpZ2hQbG90KSxsPUQocS5sb3dQbG90KSxtLnN0cm9rZT1xLnN0ZW1Db2xvcnx8Yi5zdGVtQ29sb3J8fEIsbVtcInN0cm9rZS13aWR0aFwiXT1vKHEuc3RlbVdpZHRoLGIuc3RlbVdpZHRoLGIubGluZVdpZHRoKSxtLmRhc2hzdHlsZT1xLnN0ZW1EYXNoU3R5bGV8fFxuYi5zdGVtRGFzaFN0eWxlLHAuc3Ryb2tlPXEud2hpc2tlckNvbG9yfHxiLndoaXNrZXJDb2xvcnx8QixwW1wic3Ryb2tlLXdpZHRoXCJdPW8ocS53aGlza2VyV2lkdGgsYi53aGlza2VyV2lkdGgsYi5saW5lV2lkdGgpLHIuc3Ryb2tlPXEubWVkaWFuQ29sb3J8fGIubWVkaWFuQ29sb3J8fEIscltcInN0cm9rZS13aWR0aFwiXT1vKHEubWVkaWFuV2lkdGgsYi5tZWRpYW5XaWR0aCxiLmxpbmVXaWR0aCksZj1tW1wic3Ryb2tlLXdpZHRoXCJdJTIvMixrPXYreStmLGk9W1wiTVwiLGssZSxcIkxcIixrLGosXCJNXCIsayxnLFwiTFwiLGssbF0seiYmKGY9ZFtcInN0cm9rZS13aWR0aFwiXSUyLzIsaz1EKGspK2YsZz1EKGcpK2YsZT1EKGUpK2Ysdis9Zix4Kz1mLEo9W1wiTVwiLHYsZSxcIkxcIix2LGcsXCJMXCIseCxnLFwiTFwiLHgsZSxcIkxcIix2LGUsXCJ6XCJdKSxFJiYoZj1wW1wic3Ryb2tlLXdpZHRoXCJdJTIvMixqKz1mLGwrPWYsQT0vJSQvLnRlc3QoRSk/eSpwYXJzZUZsb2F0KEUpLzEwMDpFLzIsSz1bXCJNXCIsay1BLGosXCJMXCIsaytcbkEsaixcIk1cIixrLUEsbCxcIkxcIixrK0EsbF0pLGY9cltcInN0cm9rZS13aWR0aFwiXSUyLzIsaD1GKHEubWVkaWFuUGxvdCkrZix1PVtcIk1cIix2LGgsXCJMXCIseCxoXSxuKXEuc3RlbS5hbmltYXRlKHtkOml9KSxFJiZxLndoaXNrZXJzLmFuaW1hdGUoe2Q6S30pLHomJnEuYm94LmFuaW1hdGUoe2Q6Sn0pLHEubWVkaWFuU2hhcGUuYW5pbWF0ZSh7ZDp1fSk7ZWxzZXtxLmdyYXBoaWM9bj1jLmcoKS5hZGQoYS5ncm91cCk7cS5zdGVtPWMucGF0aChpKS5hdHRyKG0pLmFkZChuKTtpZihFKXEud2hpc2tlcnM9Yy5wYXRoKEspLmF0dHIocCkuYWRkKG4pO2lmKHopcS5ib3g9Yy5wYXRoKEopLmF0dHIoZCkuYWRkKG4pO3EubWVkaWFuU2hhcGU9Yy5wYXRoKHUpLmF0dHIocikuYWRkKG4pfX0pfSxzZXRTdGFja2VkUG9pbnRzOnJ9KTtwLmVycm9yYmFyPXUocC5ib3hwbG90LHtjb2xvcjpcIiMwMDAwMDBcIixncm91cGluZzohMSxsaW5rZWRUbzpcIjpwcmV2aW91c1wiLHRvb2x0aXA6e3BvaW50Rm9ybWF0Oic8c3BhbiBzdHlsZT1cImNvbG9yOntwb2ludC5jb2xvcn1cIj5cXHUyNWNmPC9zcGFuPiB7c2VyaWVzLm5hbWV9OiA8Yj57cG9pbnQubG93fTwvYj4gLSA8Yj57cG9pbnQuaGlnaH08L2I+PGJyLz4nfSxcbndoaXNrZXJXaWR0aDpudWxsfSk7aS5lcnJvcmJhcj12KGkuYm94cGxvdCx7dHlwZTpcImVycm9yYmFyXCIscG9pbnRBcnJheU1hcDpbXCJsb3dcIixcImhpZ2hcIl0sdG9ZRGF0YTpmdW5jdGlvbihhKXtyZXR1cm5bYS5sb3csYS5oaWdoXX0scG9pbnRWYWxLZXk6XCJoaWdoXCIsZG9RdWFydGlsZXM6ITEsZHJhd0RhdGFMYWJlbHM6aS5hcmVhcmFuZ2U/aS5hcmVhcmFuZ2UucHJvdG90eXBlLmRyYXdEYXRhTGFiZWxzOnIsZ2V0Q29sdW1uTWV0cmljczpmdW5jdGlvbigpe3JldHVybiB0aGlzLmxpbmtlZFBhcmVudCYmdGhpcy5saW5rZWRQYXJlbnQuY29sdW1uTWV0cmljc3x8aS5jb2x1bW4ucHJvdG90eXBlLmdldENvbHVtbk1ldHJpY3MuY2FsbCh0aGlzKX19KTtwLndhdGVyZmFsbD11KHAuY29sdW1uLHtsaW5lV2lkdGg6MSxsaW5lQ29sb3I6XCIjMzMzXCIsZGFzaFN0eWxlOlwiZG90XCIsYm9yZGVyQ29sb3I6XCIjMzMzXCIsZGF0YUxhYmVsczp7aW5zaWRlOiEwfSxzdGF0ZXM6e2hvdmVyOntsaW5lV2lkdGhQbHVzOjB9fX0pO1xuaS53YXRlcmZhbGw9dihpLmNvbHVtbix7dHlwZTpcIndhdGVyZmFsbFwiLHVwQ29sb3JQcm9wOlwiZmlsbFwiLHBvaW50VmFsS2V5OlwieVwiLHRyYW5zbGF0ZTpmdW5jdGlvbigpe3ZhciBhPXRoaXMub3B0aW9ucyxiPXRoaXMueUF4aXMsYyxkLGcsZSxqLGwsaCxmLGssbj1vKGEubWluUG9pbnRMZW5ndGgsNSkscz1hLnRocmVzaG9sZCxtPWEuc3RhY2tpbmc7aS5jb2x1bW4ucHJvdG90eXBlLnRyYW5zbGF0ZS5hcHBseSh0aGlzKTt0aGlzLm1pblBvaW50TGVuZ3RoT2Zmc2V0PTA7aD1mPXM7ZD10aGlzLnBvaW50cztmb3IoYz0wLGE9ZC5sZW5ndGg7YzxhO2MrKyl7Zz1kW2NdO2w9dGhpcy5wcm9jZXNzZWRZRGF0YVtjXTtlPWcuc2hhcGVBcmdzO2s9KGo9bSYmYi5zdGFja3NbKHRoaXMubmVnU3RhY2tzJiZsPHM/XCItXCI6XCJcIikrdGhpcy5zdGFja0tleV0pP2pbZy54XS5wb2ludHNbdGhpcy5pbmRleCtcIixcIitjXTpbMCxsXTtpZihnLmlzU3VtKWcueT1HKGwpO2Vsc2UgaWYoZy5pc0ludGVybWVkaWF0ZVN1bSlnLnk9XG5HKGwtZik7aj1PKGgsaCtnLnkpK2tbMF07ZS55PWIudHJhbnNsYXRlKGosMCwxKTtpZihnLmlzU3VtKWUueT1iLnRyYW5zbGF0ZShrWzFdLDAsMSksZS5oZWlnaHQ9TWF0aC5taW4oYi50cmFuc2xhdGUoa1swXSwwLDEpLGIubGVuKS1lLnkrdGhpcy5taW5Qb2ludExlbmd0aE9mZnNldDtlbHNlIGlmKGcuaXNJbnRlcm1lZGlhdGVTdW0pZS55PWIudHJhbnNsYXRlKGtbMV0sMCwxKSxlLmhlaWdodD1NYXRoLm1pbihiLnRyYW5zbGF0ZShmLDAsMSksYi5sZW4pLWUueSt0aGlzLm1pblBvaW50TGVuZ3RoT2Zmc2V0LGY9a1sxXTtlbHNle2lmKGghPT0wKWUuaGVpZ2h0PWw+MD9iLnRyYW5zbGF0ZShoLDAsMSktZS55OmIudHJhbnNsYXRlKGgsMCwxKS1iLnRyYW5zbGF0ZShoLWwsMCwxKTtoKz1sfWUuaGVpZ2h0PDAmJihlLnkrPWUuaGVpZ2h0LGUuaGVpZ2h0Kj0tMSk7Zy5wbG90WT1lLnk9RihlLnkpLXRoaXMuYm9yZGVyV2lkdGglMi8yO2UuaGVpZ2h0PU8oRihlLmhlaWdodCksMC4wMDEpO1xuZy55Qm90dG9tPWUueStlLmhlaWdodDtpZihlLmhlaWdodDw9billLmhlaWdodD1uLHRoaXMubWluUG9pbnRMZW5ndGhPZmZzZXQrPW47ZS55LT10aGlzLm1pblBvaW50TGVuZ3RoT2Zmc2V0O2U9Zy5wbG90WSsoZy5uZWdhdGl2ZT9lLmhlaWdodDowKS10aGlzLm1pblBvaW50TGVuZ3RoT2Zmc2V0O3RoaXMuY2hhcnQuaW52ZXJ0ZWQ/Zy50b29sdGlwUG9zWzBdPWIubGVuLWU6Zy50b29sdGlwUG9zWzFdPWV9fSxwcm9jZXNzRGF0YTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLnlEYXRhLGM9dGhpcy5vcHRpb25zLmRhdGEsZCxnPWIubGVuZ3RoLGUsaixsLGgsZixrO2o9ZT1sPWg9dGhpcy5vcHRpb25zLnRocmVzaG9sZHx8MDtmb3Ioaz0wO2s8ZztrKyspZj1iW2tdLGQ9YyYmY1trXT9jW2tdOnt9LGY9PT1cInN1bVwifHxkLmlzU3VtP2Jba109RyhqKTpmPT09XCJpbnRlcm1lZGlhdGVTdW1cInx8ZC5pc0ludGVybWVkaWF0ZVN1bT9iW2tdPUcoZSk6KGorPWYsZSs9ZiksbD1NYXRoLm1pbihqLFxubCksaD1NYXRoLm1heChqLGgpO3gucHJvdG90eXBlLnByb2Nlc3NEYXRhLmNhbGwodGhpcyxhKTt0aGlzLmRhdGFNaW49bDt0aGlzLmRhdGFNYXg9aH0sdG9ZRGF0YTpmdW5jdGlvbihhKXtyZXR1cm4gYS5pc1N1bT9hLng9PT0wP251bGw6XCJzdW1cIjphLmlzSW50ZXJtZWRpYXRlU3VtP2EueD09PTA/bnVsbDpcImludGVybWVkaWF0ZVN1bVwiOmEueX0sZ2V0QXR0cmliczpmdW5jdGlvbigpe2kuY29sdW1uLnByb3RvdHlwZS5nZXRBdHRyaWJzLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt2YXIgYT10aGlzLGI9YS5vcHRpb25zLGM9Yi5zdGF0ZXMsZD1iLnVwQ29sb3J8fGEuY29sb3IsYj1tLkNvbG9yKGQpLmJyaWdodGVuKDAuMSkuZ2V0KCksZz11KGEucG9pbnRBdHRyKSxlPWEudXBDb2xvclByb3A7Z1tcIlwiXVtlXT1kO2cuaG92ZXJbZV09Yy5ob3Zlci51cENvbG9yfHxiO2cuc2VsZWN0W2VdPWMuc2VsZWN0LnVwQ29sb3J8fGQ7dChhLnBvaW50cyxmdW5jdGlvbihlKXtpZighZS5vcHRpb25zLmNvbG9yKWUueT5cbjA/KGUucG9pbnRBdHRyPWcsZS5jb2xvcj1kKTplLnBvaW50QXR0cj1hLnBvaW50QXR0cn0pfSxnZXRHcmFwaFBhdGg6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmRhdGEsYj1hLmxlbmd0aCxjPUYodGhpcy5vcHRpb25zLmxpbmVXaWR0aCt0aGlzLmJvcmRlcldpZHRoKSUyLzIsZD1bXSxnLGUsajtmb3Ioaj0xO2o8YjtqKyspZT1hW2pdLnNoYXBlQXJncyxnPWFbai0xXS5zaGFwZUFyZ3MsZT1bXCJNXCIsZy54K2cud2lkdGgsZy55K2MsXCJMXCIsZS54LGcueStjXSxhW2otMV0ueTwwJiYoZVsyXSs9Zy5oZWlnaHQsZVs1XSs9Zy5oZWlnaHQpLGQ9ZC5jb25jYXQoZSk7cmV0dXJuIGR9LGdldEV4dHJlbWVzOnIsZHJhd0dyYXBoOngucHJvdG90eXBlLmRyYXdHcmFwaH0pO3AucG9seWdvbj11KHAuc2NhdHRlcix7bWFya2VyOntlbmFibGVkOiExfX0pO2kucG9seWdvbj12KGkuc2NhdHRlcix7dHlwZTpcInBvbHlnb25cIixmaWxsR3JhcGg6ITAsZ2V0U2VnbWVudFBhdGg6ZnVuY3Rpb24oYSl7cmV0dXJuIHgucHJvdG90eXBlLmdldFNlZ21lbnRQYXRoLmNhbGwodGhpcyxcbmEpLmNvbmNhdChcInpcIil9LGRyYXdHcmFwaDp4LnByb3RvdHlwZS5kcmF3R3JhcGgsZHJhd0xlZ2VuZFN5bWJvbDptLkxlZ2VuZFN5bWJvbE1peGluLmRyYXdSZWN0YW5nbGV9KTtwLmJ1YmJsZT11KHAuc2NhdHRlcix7ZGF0YUxhYmVsczp7Zm9ybWF0dGVyOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucG9pbnQuen0saW5zaWRlOiEwLHZlcnRpY2FsQWxpZ246XCJtaWRkbGVcIn0sbWFya2VyOntsaW5lQ29sb3I6bnVsbCxsaW5lV2lkdGg6MX0sbWluU2l6ZTo4LG1heFNpemU6XCIyMCVcIixzb2Z0VGhyZXNob2xkOiExLHN0YXRlczp7aG92ZXI6e2hhbG86e3NpemU6NX19fSx0b29sdGlwOntwb2ludEZvcm1hdDpcIih7cG9pbnQueH0sIHtwb2ludC55fSksIFNpemU6IHtwb2ludC56fVwifSx0dXJib1RocmVzaG9sZDowLHpUaHJlc2hvbGQ6MCx6b25lQXhpczpcInpcIn0pO0M9dihJLHtoYWxvUGF0aDpmdW5jdGlvbigpe3JldHVybiBJLnByb3RvdHlwZS5oYWxvUGF0aC5jYWxsKHRoaXMsdGhpcy5zaGFwZUFyZ3MucitcbnRoaXMuc2VyaWVzLm9wdGlvbnMuc3RhdGVzLmhvdmVyLmhhbG8uc2l6ZSl9LHR0QmVsb3c6ITF9KTtpLmJ1YmJsZT12KGkuc2NhdHRlcix7dHlwZTpcImJ1YmJsZVwiLHBvaW50Q2xhc3M6Qyxwb2ludEFycmF5TWFwOltcInlcIixcInpcIl0scGFyYWxsZWxBcnJheXM6W1wieFwiLFwieVwiLFwielwiXSx0cmFja2VyR3JvdXBzOltcImdyb3VwXCIsXCJkYXRhTGFiZWxzR3JvdXBcIl0sYnViYmxlUGFkZGluZzohMCx6b25lQXhpczpcInpcIixwb2ludEF0dHJUb09wdGlvbnM6e3N0cm9rZTpcImxpbmVDb2xvclwiLFwic3Ryb2tlLXdpZHRoXCI6XCJsaW5lV2lkdGhcIixmaWxsOlwiZmlsbENvbG9yXCJ9LGFwcGx5T3BhY2l0eTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLm9wdGlvbnMubWFya2VyLGM9byhiLmZpbGxPcGFjaXR5LDAuNSksYT1hfHxiLmZpbGxDb2xvcnx8dGhpcy5jb2xvcjtjIT09MSYmKGE9VihhKS5zZXRPcGFjaXR5KGMpLmdldChcInJnYmFcIikpO3JldHVybiBhfSxjb252ZXJ0QXR0cmliczpmdW5jdGlvbigpe3ZhciBhPVxueC5wcm90b3R5cGUuY29udmVydEF0dHJpYnMuYXBwbHkodGhpcyxhcmd1bWVudHMpO2EuZmlsbD10aGlzLmFwcGx5T3BhY2l0eShhLmZpbGwpO3JldHVybiBhfSxnZXRSYWRpaTpmdW5jdGlvbihhLGIsYyxkKXt2YXIgZyxlLGosbD10aGlzLnpEYXRhLGg9W10sZj10aGlzLm9wdGlvbnMsaz1mLnNpemVCeSE9PVwid2lkdGhcIixuPWYuelRocmVzaG9sZCxpPWItYTtmb3IoZT0wLGc9bC5sZW5ndGg7ZTxnO2UrKylqPWxbZV0sZi5zaXplQnlBYnNvbHV0ZVZhbHVlJiZqIT09bnVsbCYmKGo9TWF0aC5hYnMoai1uKSxiPU1hdGgubWF4KGItbixNYXRoLmFicyhhLW4pKSxhPTApLGo9PT1udWxsP2o9bnVsbDpqPGE/aj1jLzItMTooaj1pPjA/KGotYSkvaTowLjUsayYmaj49MCYmKGo9TWF0aC5zcXJ0KGopKSxqPXkuY2VpbChjK2oqKGQtYykpLzIpLGgucHVzaChqKTt0aGlzLnJhZGlpPWh9LGFuaW1hdGU6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5vcHRpb25zLmFuaW1hdGlvbjtpZighYSl0KHRoaXMucG9pbnRzLFxuZnVuY3Rpb24oYSl7dmFyIGQ9YS5ncmFwaGljLGE9YS5zaGFwZUFyZ3M7ZCYmYSYmKGQuYXR0cihcInJcIiwxKSxkLmFuaW1hdGUoe3I6YS5yfSxiKSl9KSx0aGlzLmFuaW1hdGU9bnVsbH0sdHJhbnNsYXRlOmZ1bmN0aW9uKCl7dmFyIGEsYj10aGlzLmRhdGEsYyxkLGc9dGhpcy5yYWRpaTtpLnNjYXR0ZXIucHJvdG90eXBlLnRyYW5zbGF0ZS5jYWxsKHRoaXMpO2ZvcihhPWIubGVuZ3RoO2EtLTspYz1iW2FdLGQ9Zz9nW2FdOjAsdHlwZW9mIGQ9PT1cIm51bWJlclwiJiZkPj10aGlzLm1pblB4U2l6ZS8yPyhjLnNoYXBlVHlwZT1cImNpcmNsZVwiLGMuc2hhcGVBcmdzPXt4OmMucGxvdFgseTpjLnBsb3RZLHI6ZH0sYy5kbEJveD17eDpjLnBsb3RYLWQseTpjLnBsb3RZLWQsd2lkdGg6MipkLGhlaWdodDoyKmR9KTpjLnNoYXBlQXJncz1jLnBsb3RZPWMuZGxCb3g9dm9pZCAwfSxkcmF3TGVnZW5kU3ltYm9sOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5jaGFydC5yZW5kZXJlcixkPWMuZm9udE1ldHJpY3MoYS5pdGVtU3R5bGUuZm9udFNpemUpLmYvXG4yO2IubGVnZW5kU3ltYm9sPWMuY2lyY2xlKGQsYS5iYXNlbGluZS1kLGQpLmF0dHIoe3pJbmRleDozfSkuYWRkKGIubGVnZW5kR3JvdXApO2IubGVnZW5kU3ltYm9sLmlzTWFya2VyPSEwfSxkcmF3UG9pbnRzOmkuY29sdW1uLnByb3RvdHlwZS5kcmF3UG9pbnRzLGFsaWduRGF0YUxhYmVsOmkuY29sdW1uLnByb3RvdHlwZS5hbGlnbkRhdGFMYWJlbCxidWlsZEtEVHJlZTpyLGFwcGx5Wm9uZXM6cn0pO04ucHJvdG90eXBlLmJlZm9yZVBhZGRpbmc9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9dGhpcy5sZW4sYz10aGlzLmNoYXJ0LGQ9MCxnPWIsZT10aGlzLmlzWEF4aXMsaj1lP1wieERhdGFcIjpcInlEYXRhXCIsbD10aGlzLm1pbixoPXt9LGY9eS5taW4oYy5wbG90V2lkdGgsYy5wbG90SGVpZ2h0KSxrPU51bWJlci5NQVhfVkFMVUUsbj0tTnVtYmVyLk1BWF9WQUxVRSxpPXRoaXMubWF4LWwsbT1iL2kscD1bXTt0KHRoaXMuc2VyaWVzLGZ1bmN0aW9uKGIpe3ZhciBnPWIub3B0aW9ucztpZihiLmJ1YmJsZVBhZGRpbmcmJlxuKGIudmlzaWJsZXx8IWMub3B0aW9ucy5jaGFydC5pZ25vcmVIaWRkZW5TZXJpZXMpKWlmKGEuYWxsb3dab29tT3V0c2lkZT0hMCxwLnB1c2goYiksZSl0KFtcIm1pblNpemVcIixcIm1heFNpemVcIl0sZnVuY3Rpb24oYSl7dmFyIGI9Z1thXSxlPS8lJC8udGVzdChiKSxiPUIoYik7aFthXT1lP2YqYi8xMDA6Yn0pLGIubWluUHhTaXplPWgubWluU2l6ZSxiLm1heFB4U2l6ZT1oLm1heFNpemUsYj1iLnpEYXRhLGIubGVuZ3RoJiYoaz1vKGcuek1pbix5Lm1pbihrLHkubWF4KFEoYiksZy5kaXNwbGF5TmVnYXRpdmU9PT0hMT9nLnpUaHJlc2hvbGQ6LU51bWJlci5NQVhfVkFMVUUpKSksbj1vKGcuek1heCx5Lm1heChuLFIoYikpKSl9KTt0KHAsZnVuY3Rpb24oYil7dmFyIGM9YltqXSxmPWMubGVuZ3RoLGg7ZSYmYi5nZXRSYWRpaShrLG4sYi5taW5QeFNpemUsYi5tYXhQeFNpemUpO2lmKGk+MClmb3IoO2YtLTspdHlwZW9mIGNbZl09PT1cIm51bWJlclwiJiZhLmRhdGFNaW48PWNbZl0mJmNbZl08PVxuYS5kYXRhTWF4JiYoaD1iLnJhZGlpW2ZdLGQ9TWF0aC5taW4oKGNbZl0tbCkqbS1oLGQpLGc9TWF0aC5tYXgoKGNbZl0tbCkqbStoLGcpKX0pO3AubGVuZ3RoJiZpPjAmJiF0aGlzLmlzTG9nJiYoZy09YixtKj0oYitkLWcpL2IsdChbW1wibWluXCIsXCJ1c2VyTWluXCIsZF0sW1wibWF4XCIsXCJ1c2VyTWF4XCIsZ11dLGZ1bmN0aW9uKGIpe28oYS5vcHRpb25zW2JbMF1dLGFbYlsxXV0pPT09dm9pZCAwJiYoYVtiWzBdXSs9YlsyXS9tKX0pKX07KGZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIpe3ZhciBjPXRoaXMuY2hhcnQsZD10aGlzLm9wdGlvbnMuYW5pbWF0aW9uLGg9dGhpcy5ncm91cCxmPXRoaXMubWFya2VyR3JvdXAsaz10aGlzLnhBeGlzLmNlbnRlcixpPWMucGxvdExlZnQsbT1jLnBsb3RUb3A7aWYoYy5wb2xhcil7aWYoYy5yZW5kZXJlci5pc1NWRylkPT09ITAmJihkPXt9KSxiPyhjPXt0cmFuc2xhdGVYOmtbMF0raSx0cmFuc2xhdGVZOmtbMV0rbSxzY2FsZVg6MC4wMDEsc2NhbGVZOjAuMDAxfSxcbmguYXR0cihjKSxmJiZmLmF0dHIoYykpOihjPXt0cmFuc2xhdGVYOmksdHJhbnNsYXRlWTptLHNjYWxlWDoxLHNjYWxlWToxfSxoLmFuaW1hdGUoYyxkKSxmJiZmLmFuaW1hdGUoYyxkKSx0aGlzLmFuaW1hdGU9bnVsbCl9ZWxzZSBhLmNhbGwodGhpcyxiKX12YXIgYj14LnByb3RvdHlwZSxjPVQucHJvdG90eXBlLGQ7Yi5zZWFyY2hQb2ludEJ5QW5nbGU9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jaGFydCxjPXRoaXMueEF4aXMucGFuZS5jZW50ZXI7cmV0dXJuIHRoaXMuc2VhcmNoS0RUcmVlKHtjbGllbnRYOjE4MCtNYXRoLmF0YW4yKGEuY2hhcnRYLWNbMF0tYi5wbG90TGVmdCxhLmNoYXJ0WS1jWzFdLWIucGxvdFRvcCkqKC0xODAvTWF0aC5QSSl9KX07dyhiLFwiYnVpbGRLRFRyZWVcIixmdW5jdGlvbihhKXtpZih0aGlzLmNoYXJ0LnBvbGFyKXRoaXMua2RCeUFuZ2xlP3RoaXMuc2VhcmNoUG9pbnQ9dGhpcy5zZWFyY2hQb2ludEJ5QW5nbGU6dGhpcy5rZERpbWVuc2lvbnM9MjthLmFwcGx5KHRoaXMpfSk7XG5iLnRvWFk9ZnVuY3Rpb24oYSl7dmFyIGIsYz10aGlzLmNoYXJ0LGQ9YS5wbG90WDtiPWEucGxvdFk7YS5yZWN0UGxvdFg9ZDthLnJlY3RQbG90WT1iO2I9dGhpcy54QXhpcy5wb3N0VHJhbnNsYXRlKGEucGxvdFgsdGhpcy55QXhpcy5sZW4tYik7YS5wbG90WD1hLnBvbGFyUGxvdFg9Yi54LWMucGxvdExlZnQ7YS5wbG90WT1hLnBvbGFyUGxvdFk9Yi55LWMucGxvdFRvcDt0aGlzLmtkQnlBbmdsZT8oYz0oZC9NYXRoLlBJKjE4MCt0aGlzLnhBeGlzLnBhbmUub3B0aW9ucy5zdGFydEFuZ2xlKSUzNjAsYzwwJiYoYys9MzYwKSxhLmNsaWVudFg9Yyk6YS5jbGllbnRYPWEucGxvdFh9O2kuc3BsaW5lJiZ3KGkuc3BsaW5lLnByb3RvdHlwZSxcImdldFBvaW50U3BsaW5lXCIsZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGgsZixrLGksbSxwLG87aWYodGhpcy5jaGFydC5wb2xhcil7aD1jLnBsb3RYO2Y9Yy5wbG90WTthPWJbZC0xXTtrPWJbZCsxXTt0aGlzLmNvbm5lY3RFbmRzJiYoYXx8KGE9YltiLmxlbmd0aC1cbjJdKSxrfHwoaz1iWzFdKSk7aWYoYSYmaylpPWEucGxvdFgsbT1hLnBsb3RZLGI9ay5wbG90WCxwPWsucGxvdFksaT0oMS41KmgraSkvMi41LG09KDEuNSpmK20pLzIuNSxrPSgxLjUqaCtiKS8yLjUsbz0oMS41KmYrcCkvMi41LGI9TWF0aC5zcXJ0KE1hdGgucG93KGktaCwyKStNYXRoLnBvdyhtLWYsMikpLHA9TWF0aC5zcXJ0KE1hdGgucG93KGstaCwyKStNYXRoLnBvdyhvLWYsMikpLGk9TWF0aC5hdGFuMihtLWYsaS1oKSxtPU1hdGguYXRhbjIoby1mLGstaCksbz1NYXRoLlBJLzIrKGkrbSkvMixNYXRoLmFicyhpLW8pPk1hdGguUEkvMiYmKG8tPU1hdGguUEkpLGk9aCtNYXRoLmNvcyhvKSpiLG09ZitNYXRoLnNpbihvKSpiLGs9aCtNYXRoLmNvcyhNYXRoLlBJK28pKnAsbz1mK01hdGguc2luKE1hdGguUEkrbykqcCxjLnJpZ2h0Q29udFg9ayxjLnJpZ2h0Q29udFk9bztkPyhjPVtcIkNcIixhLnJpZ2h0Q29udFh8fGEucGxvdFgsYS5yaWdodENvbnRZfHxhLnBsb3RZLGl8fGgsbXx8XG5mLGgsZl0sYS5yaWdodENvbnRYPWEucmlnaHRDb250WT1udWxsKTpjPVtcIk1cIixoLGZdfWVsc2UgYz1hLmNhbGwodGhpcyxiLGMsZCk7cmV0dXJuIGN9KTt3KGIsXCJ0cmFuc2xhdGVcIixmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNoYXJ0O2EuY2FsbCh0aGlzKTtpZihiLnBvbGFyJiYodGhpcy5rZEJ5QW5nbGU9Yi50b29sdGlwJiZiLnRvb2x0aXAuc2hhcmVkLCF0aGlzLnByZXZlbnRQb3N0VHJhbnNsYXRlKSl7YT10aGlzLnBvaW50cztmb3IoYj1hLmxlbmd0aDtiLS07KXRoaXMudG9YWShhW2JdKX19KTt3KGIsXCJnZXRHcmFwaFBhdGhcIixmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXM7aWYodGhpcy5jaGFydC5wb2xhcil7Yj1ifHx0aGlzLnBvaW50cztpZih0aGlzLm9wdGlvbnMuY29ubmVjdEVuZHMhPT0hMSYmYlswXS55IT09bnVsbCl0aGlzLmNvbm5lY3RFbmRzPSEwLGIuc3BsaWNlKGIubGVuZ3RoLDAsYlswXSk7dChiLGZ1bmN0aW9uKGEpe2EucG9sYXJQbG90WT09PXZvaWQgMCYmYy50b1hZKGEpfSl9cmV0dXJuIGEuYXBwbHkodGhpcyxcbltdLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpKX0pO3coYixcImFuaW1hdGVcIixhKTtpZihpLmNvbHVtbilkPWkuY29sdW1uLnByb3RvdHlwZSxkLnBvbGFyQXJjPWZ1bmN0aW9uKGEsYixjLGQpe3ZhciBoPXRoaXMueEF4aXMuY2VudGVyLGY9dGhpcy55QXhpcy5sZW47cmV0dXJuIHRoaXMuY2hhcnQucmVuZGVyZXIuc3ltYm9scy5hcmMoaFswXSxoWzFdLGYtYixudWxsLHtzdGFydDpjLGVuZDpkLGlubmVyUjpmLW8oYSxmKX0pfSx3KGQsXCJhbmltYXRlXCIsYSksdyhkLFwidHJhbnNsYXRlXCIsZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy54QXhpcyxjPWIuc3RhcnRBbmdsZVJhZCxkLGgsZjt0aGlzLnByZXZlbnRQb3N0VHJhbnNsYXRlPSEwO2EuY2FsbCh0aGlzKTtpZihiLmlzUmFkaWFsKXtkPXRoaXMucG9pbnRzO2ZvcihmPWQubGVuZ3RoO2YtLTspaD1kW2ZdLGE9aC5iYXJYK2MsaC5zaGFwZVR5cGU9XCJwYXRoXCIsaC5zaGFwZUFyZ3M9dGhpcy5wb2xhckFyYyhoLnlCb3R0b20saC5wbG90WSxhLFxuYStoLnBvaW50V2lkdGgpLHRoaXMudG9YWShoKSxoLnRvb2x0aXBQb3M9W2gucGxvdFgsaC5wbG90WV0saC50dEJlbG93PWgucGxvdFk+Yi5jZW50ZXJbMV19fSksdyhkLFwiYWxpZ25EYXRhTGFiZWxcIixmdW5jdGlvbihhLGMsZCxpLGgsZil7aWYodGhpcy5jaGFydC5wb2xhcil7YT1jLnJlY3RQbG90WC9NYXRoLlBJKjE4MDtpZihpLmFsaWduPT09bnVsbClpLmFsaWduPWE+MjAmJmE8MTYwP1wibGVmdFwiOmE+MjAwJiZhPDM0MD9cInJpZ2h0XCI6XCJjZW50ZXJcIjtpZihpLnZlcnRpY2FsQWxpZ249PT1udWxsKWkudmVydGljYWxBbGlnbj1hPDQ1fHxhPjMxNT9cImJvdHRvbVwiOmE+MTM1JiZhPDIyNT9cInRvcFwiOlwibWlkZGxlXCI7Yi5hbGlnbkRhdGFMYWJlbC5jYWxsKHRoaXMsYyxkLGksaCxmKX1lbHNlIGEuY2FsbCh0aGlzLGMsZCxpLGgsZil9KTt3KGMsXCJnZXRDb29yZGluYXRlc1wiLGZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5jaGFydCxkPXt4QXhpczpbXSx5QXhpczpbXX07Yy5wb2xhcj90KGMuYXhlcyxcbmZ1bmN0aW9uKGEpe3ZhciBmPWEuaXNYQXhpcyxnPWEuY2VudGVyLGk9Yi5jaGFydFgtZ1swXS1jLnBsb3RMZWZ0LGc9Yi5jaGFydFktZ1sxXS1jLnBsb3RUb3A7ZFtmP1wieEF4aXNcIjpcInlBeGlzXCJdLnB1c2goe2F4aXM6YSx2YWx1ZTphLnRyYW5zbGF0ZShmP01hdGguUEktTWF0aC5hdGFuMihpLGcpOk1hdGguc3FydChNYXRoLnBvdyhpLDIpK01hdGgucG93KGcsMikpLCEwKX0pfSk6ZD1hLmNhbGwodGhpcyxiKTtyZXR1cm4gZH0pfSkoKX0pO1xuIiwiLypcbiBIaWdoc3RvY2sgSlMgdjQuMi40ICgyMDE2LTA0LTE0KVxuXG4gKGMpIDIwMDktMjAxNiBUb3JzdGVpbiBIb25zaVxuXG4gTGljZW5zZTogd3d3LmhpZ2hjaGFydHMuY29tL2xpY2Vuc2VcbiovXG4oZnVuY3Rpb24oSixnYSl7dHlwZW9mIG1vZHVsZT09PVwib2JqZWN0XCImJm1vZHVsZS5leHBvcnRzP21vZHVsZS5leHBvcnRzPUouZG9jdW1lbnQ/Z2EoSik6Z2E6Si5IaWdoY2hhcnRzPWdhKEopfSkodHlwZW9mIHdpbmRvdyE9PVwidW5kZWZpbmVkXCI/d2luZG93OnRoaXMsZnVuY3Rpb24oSil7ZnVuY3Rpb24gZ2EoYSxiKXt2YXIgYz1cIkhpZ2hjaGFydHMgZXJyb3IgI1wiK2ErXCI6IHd3dy5oaWdoY2hhcnRzLmNvbS9lcnJvcnMvXCIrYTtpZihiKXRocm93IEVycm9yKGMpO0ouY29uc29sZSYmY29uc29sZS5sb2coYyl9ZnVuY3Rpb24geWIoYSxiLGMpe3RoaXMub3B0aW9ucz1iO3RoaXMuZWxlbT1hO3RoaXMucHJvcD1jfWZ1bmN0aW9uIEMoKXt2YXIgYSxiPWFyZ3VtZW50cyxjLGQ9e30sZT1mdW5jdGlvbihhLGIpe3ZhciBjLGQ7dHlwZW9mIGEhPT1cIm9iamVjdFwiJiYoYT17fSk7Zm9yKGQgaW4gYiliLmhhc093blByb3BlcnR5KGQpJiYoYz1iW2RdLGFbZF09YyYmdHlwZW9mIGM9PT1cIm9iamVjdFwiJiZcbk9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChjKSE9PVwiW29iamVjdCBBcnJheV1cIiYmZCE9PVwicmVuZGVyVG9cIiYmdHlwZW9mIGMubm9kZVR5cGUhPT1cIm51bWJlclwiP2UoYVtkXXx8e30sYyk6YltkXSk7cmV0dXJuIGF9O2JbMF09PT0hMCYmKGQ9YlsxXSxiPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGIsMikpO2M9Yi5sZW5ndGg7Zm9yKGE9MDthPGM7YSsrKWQ9ZShkLGJbYV0pO3JldHVybiBkfWZ1bmN0aW9uIEcoYSxiKXtyZXR1cm4gcGFyc2VJbnQoYSxifHwxMCl9ZnVuY3Rpb24gRGEoYSl7cmV0dXJuIHR5cGVvZiBhPT09XCJzdHJpbmdcIn1mdW5jdGlvbiBkYShhKXtyZXR1cm4gYSYmdHlwZW9mIGE9PT1cIm9iamVjdFwifWZ1bmN0aW9uIEphKGEpe3JldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoYSk9PT1cIltvYmplY3QgQXJyYXldXCJ9ZnVuY3Rpb24gdWEoYSl7cmV0dXJuIHR5cGVvZiBhPT09XCJudW1iZXJcIn1mdW5jdGlvbiBBYShhLGIpe2Zvcih2YXIgYz1cbmEubGVuZ3RoO2MtLTspaWYoYVtjXT09PWIpe2Euc3BsaWNlKGMsMSk7YnJlYWt9fWZ1bmN0aW9uIHMoYSl7cmV0dXJuIGEhPT10JiZhIT09bnVsbH1mdW5jdGlvbiBYKGEsYixjKXt2YXIgZCxlO2lmKERhKGIpKXMoYyk/YS5zZXRBdHRyaWJ1dGUoYixjKTphJiZhLmdldEF0dHJpYnV0ZSYmKGU9YS5nZXRBdHRyaWJ1dGUoYikpO2Vsc2UgaWYocyhiKSYmZGEoYikpZm9yKGQgaW4gYilhLnNldEF0dHJpYnV0ZShkLGJbZF0pO3JldHVybiBlfWZ1bmN0aW9uIHZhKGEpe3JldHVybiBKYShhKT9hOlthXX1mdW5jdGlvbiAkYShhLGIsYyl7aWYoYilyZXR1cm4gc2V0VGltZW91dChhLGIsYyk7YS5jYWxsKDAsYyl9ZnVuY3Rpb24gRihhLGIpe2lmKEthJiYhamEmJmImJmIub3BhY2l0eSE9PXQpYi5maWx0ZXI9XCJhbHBoYShvcGFjaXR5PVwiK2Iub3BhY2l0eSoxMDArXCIpXCI7eChhLnN0eWxlLGIpfWZ1bmN0aW9uIGVhKGEsYixjLGQsZSl7YT1CLmNyZWF0ZUVsZW1lbnQoYSk7YiYmeChhLGIpO2UmJlxuRihhLHtwYWRkaW5nOjAsYm9yZGVyOlwibm9uZVwiLG1hcmdpbjowfSk7YyYmRihhLGMpO2QmJmQuYXBwZW5kQ2hpbGQoYSk7cmV0dXJuIGF9ZnVuY3Rpb24gbGEoYSxiKXt2YXIgYz1mdW5jdGlvbigpe307Yy5wcm90b3R5cGU9bmV3IGE7eChjLnByb3RvdHlwZSxiKTtyZXR1cm4gY31mdW5jdGlvbiBOYShhLGIsYyl7cmV0dXJuIEFycmF5KChifHwyKSsxLVN0cmluZyhhKS5sZW5ndGgpLmpvaW4oY3x8MCkrYX1mdW5jdGlvbiBmYihhKXtyZXR1cm4oZ2ImJmdiKGEpfHx6Ynx8MCkqNkU0fWZ1bmN0aW9uIExhKGEsYil7Zm9yKHZhciBjPVwie1wiLGQ9ITEsZSxmLGcsaCxpLGo9W107KGM9YS5pbmRleE9mKGMpKSE9PS0xOyl7ZT1hLnNsaWNlKDAsYyk7aWYoZCl7Zj1lLnNwbGl0KFwiOlwiKTtnPWYuc2hpZnQoKS5zcGxpdChcIi5cIik7aT1nLmxlbmd0aDtlPWI7Zm9yKGg9MDtoPGk7aCsrKWU9ZVtnW2hdXTtpZihmLmxlbmd0aClmPWYuam9pbihcIjpcIiksZz0vXFwuKFswLTldKS8saD1OLmxhbmcsaT1cbnZvaWQgMCwvZiQvLnRlc3QoZik/KGk9KGk9Zi5tYXRjaChnKSk/aVsxXTotMSxlIT09bnVsbCYmKGU9ei5udW1iZXJGb3JtYXQoZSxpLGguZGVjaW1hbFBvaW50LGYuaW5kZXhPZihcIixcIik+LTE/aC50aG91c2FuZHNTZXA6XCJcIikpKTplPW1hKGYsZSl9ai5wdXNoKGUpO2E9YS5zbGljZShjKzEpO2M9KGQ9IWQpP1wifVwiOlwie1wifWoucHVzaChhKTtyZXR1cm4gai5qb2luKFwiXCIpfWZ1bmN0aW9uIEFiKGEpe3JldHVybiBZLnBvdygxMCxWKFkubG9nKGEpL1kuTE4xMCkpfWZ1bmN0aW9uIEJiKGEsYixjLGQsZSl7dmFyIGYsZz1hLGM9cShjLDEpO2Y9YS9jO2J8fChiPVsxLDIsMi41LDUsMTBdLGQ9PT0hMSYmKGM9PT0xP2I9WzEsMiw1LDEwXTpjPD0wLjEmJihiPVsxL2NdKSkpO2ZvcihkPTA7ZDxiLmxlbmd0aDtkKyspaWYoZz1iW2RdLGUmJmcqYz49YXx8IWUmJmY8PShiW2RdKyhiW2QrMV18fGJbZF0pKS8yKWJyZWFrO2cqPWM7cmV0dXJuIGd9ZnVuY3Rpb24gb2IoYSxiKXt2YXIgYz1hLmxlbmd0aCxcbmQsZTtmb3IoZT0wO2U8YztlKyspYVtlXS5zYWZlST1lO2Euc29ydChmdW5jdGlvbihhLGMpe2Q9YihhLGMpO3JldHVybiBkPT09MD9hLnNhZmVJLWMuc2FmZUk6ZH0pO2ZvcihlPTA7ZTxjO2UrKylkZWxldGUgYVtlXS5zYWZlSX1mdW5jdGlvbiBPYShhKXtmb3IodmFyIGI9YS5sZW5ndGgsYz1hWzBdO2ItLTspYVtiXTxjJiYoYz1hW2JdKTtyZXR1cm4gY31mdW5jdGlvbiBFYShhKXtmb3IodmFyIGI9YS5sZW5ndGgsYz1hWzBdO2ItLTspYVtiXT5jJiYoYz1hW2JdKTtyZXR1cm4gY31mdW5jdGlvbiBQYShhLGIpe2Zvcih2YXIgYyBpbiBhKWFbY10mJmFbY10hPT1iJiZhW2NdLmRlc3Ryb3kmJmFbY10uZGVzdHJveSgpLGRlbGV0ZSBhW2NdfWZ1bmN0aW9uIFZhKGEpe3BifHwocGI9ZWEoV2EpKTthJiZwYi5hcHBlbmRDaGlsZChhKTtwYi5pbm5lckhUTUw9XCJcIn1mdW5jdGlvbiBuYShhLGIpe3JldHVybiBwYXJzZUZsb2F0KGEudG9QcmVjaXNpb24oYnx8MTQpKX1mdW5jdGlvbiBhYihhLFxuYil7Yi5yZW5kZXJlci5nbG9iYWxBbmltYXRpb249cShhLGIuYW5pbWF0aW9uKX1mdW5jdGlvbiBoYihhKXtyZXR1cm4gZGEoYSk/QyhhKTp7ZHVyYXRpb246YT81MDA6MH19ZnVuY3Rpb24gT2IoKXt2YXIgYT1OLmdsb2JhbCxiPWEudXNlVVRDLGM9Yj9cImdldFVUQ1wiOlwiZ2V0XCIsZD1iP1wic2V0VVRDXCI6XCJzZXRcIjtmYT1hLkRhdGV8fEouRGF0ZTt6Yj1iJiZhLnRpbWV6b25lT2Zmc2V0O2diPWImJmEuZ2V0VGltZXpvbmVPZmZzZXQ7cWI9ZnVuY3Rpb24oYSxjLGQsaCxpLGope3ZhciBrO2I/KGs9ZmEuVVRDLmFwcGx5KDAsYXJndW1lbnRzKSxrKz1mYihrKSk6az0obmV3IGZhKGEsYyxxKGQsMSkscShoLDApLHEoaSwwKSxxKGosMCkpKS5nZXRUaW1lKCk7cmV0dXJuIGt9O0NiPWMrXCJNaW51dGVzXCI7RGI9YytcIkhvdXJzXCI7RWI9YytcIkRheVwiO2JiPWMrXCJEYXRlXCI7aWI9YytcIk1vbnRoXCI7amI9YytcIkZ1bGxZZWFyXCI7UGI9ZCtcIk1pbGxpc2Vjb25kc1wiO1FiPWQrXCJTZWNvbmRzXCI7UmI9ZCtcIk1pbnV0ZXNcIjtcblNiPWQrXCJIb3Vyc1wiO3JiPWQrXCJEYXRlXCI7RmI9ZCtcIk1vbnRoXCI7R2I9ZCtcIkZ1bGxZZWFyXCJ9ZnVuY3Rpb24gd2EoYSl7aWYoISh0aGlzIGluc3RhbmNlb2Ygd2EpKXJldHVybiBuZXcgd2EoYSk7dGhpcy5pbml0KGEpfWZ1bmN0aW9uIFooKXt9ZnVuY3Rpb24gY2IoYSxiLGMsZCl7dGhpcy5heGlzPWE7dGhpcy5wb3M9Yjt0aGlzLnR5cGU9Y3x8XCJcIjt0aGlzLmlzTmV3PSEwOyFjJiYhZCYmdGhpcy5hZGRMYWJlbCgpfWZ1bmN0aW9uIFRiKGEsYixjLGQsZSl7dmFyIGY9YS5jaGFydC5pbnZlcnRlZDt0aGlzLmF4aXM9YTt0aGlzLmlzTmVnYXRpdmU9Yzt0aGlzLm9wdGlvbnM9Yjt0aGlzLng9ZDt0aGlzLnRvdGFsPW51bGw7dGhpcy5wb2ludHM9e307dGhpcy5zdGFjaz1lO3RoaXMucmlnaHRDbGlmZj10aGlzLmxlZnRDbGlmZj0wO3RoaXMuYWxpZ25PcHRpb25zPXthbGlnbjpiLmFsaWdufHwoZj9jP1wibGVmdFwiOlwicmlnaHRcIjpcImNlbnRlclwiKSx2ZXJ0aWNhbEFsaWduOmIudmVydGljYWxBbGlnbnx8XG4oZj9cIm1pZGRsZVwiOmM/XCJib3R0b21cIjpcInRvcFwiKSx5OnEoYi55LGY/NDpjPzE0Oi02KSx4OnEoYi54LGY/Yz8tNjo2OjApfTt0aGlzLnRleHRBbGlnbj1iLnRleHRBbGlnbnx8KGY/Yz9cInJpZ2h0XCI6XCJsZWZ0XCI6XCJjZW50ZXJcIil9ZnVuY3Rpb24gSGIoYSl7dmFyIGI9YS5vcHRpb25zLGM9Yi5uYXZpZ2F0b3IsZD1jLmVuYWJsZWQsYj1iLnNjcm9sbGJhcixlPWIuZW5hYmxlZCxmPWQ/Yy5oZWlnaHQ6MCxnPWU/Yi5oZWlnaHQ6MDt0aGlzLmhhbmRsZXM9W107dGhpcy5zY3JvbGxiYXJCdXR0b25zPVtdO3RoaXMuZWxlbWVudHNUb0Rlc3Ryb3k9W107dGhpcy5jaGFydD1hO3RoaXMuc2V0QmFzZVNlcmllcygpO3RoaXMuaGVpZ2h0PWY7dGhpcy5zY3JvbGxiYXJIZWlnaHQ9Zzt0aGlzLnNjcm9sbGJhckVuYWJsZWQ9ZTt0aGlzLm5hdmlnYXRvckVuYWJsZWQ9ZDt0aGlzLm5hdmlnYXRvck9wdGlvbnM9Yzt0aGlzLnNjcm9sbGJhck9wdGlvbnM9Yjt0aGlzLm91dGxpbmVIZWlnaHQ9ZitnO3RoaXMuaW5pdCgpfVxuZnVuY3Rpb24gSWIoYSl7dGhpcy5pbml0KGEpfXZhciB0LEI9Si5kb2N1bWVudCxZPU1hdGgseT1ZLnJvdW5kLFY9WS5mbG9vcixGYT1ZLmNlaWwsdj1ZLm1heCxFPVkubWluLFM9WS5hYnMsYmE9WS5jb3Msa2E9WS5zaW4sQmE9WS5QSSxwYT1CYSoyLzM2MCxNYT1KLm5hdmlnYXRvciYmSi5uYXZpZ2F0b3IudXNlckFnZW50fHxcIlwiLFViPUoub3BlcmEsS2E9Lyhtc2llfHRyaWRlbnR8ZWRnZSkvaS50ZXN0KE1hKSYmIVViLHNiPUImJkIuZG9jdW1lbnRNb2RlPT09OCx0Yj0hS2EmJi9BcHBsZVdlYktpdC8udGVzdChNYSksWGE9L0ZpcmVmb3gvLnRlc3QoTWEpLGtiPS8oTW9iaWxlfEFuZHJvaWR8V2luZG93cyBQaG9uZSkvLnRlc3QoTWEpLFFhPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIixqYT1CJiZCLmNyZWF0ZUVsZW1lbnROUyYmISFCLmNyZWF0ZUVsZW1lbnROUyhRYSxcInN2Z1wiKS5jcmVhdGVTVkdSZWN0LFpiPVhhJiZwYXJzZUludChNYS5zcGxpdChcIkZpcmVmb3gvXCIpWzFdLFxuMTApPDQscWE9QiYmIWphJiYhS2EmJiEhQi5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpLmdldENvbnRleHQsWWEsZGIsVmI9e30sSmI9MCxwYixOLG1hLEgscmE9ZnVuY3Rpb24oKXt9LCQ9W10sbGI9MCxXYT1cImRpdlwiLCRiPS9eWzAtOV0rJC8sdWI9W1wicGxvdFRvcFwiLFwibWFyZ2luUmlnaHRcIixcIm1hcmdpbkJvdHRvbVwiLFwicGxvdExlZnRcIl0sZmEscWIsemIsZ2IsQ2IsRGIsRWIsYmIsaWIsamIsUGIsUWIsUmIsU2IscmIsRmIsR2IsSz17fSx6O3o9Si5IaWdoY2hhcnRzP2dhKDE2LCEwKTp7d2luOkp9O3ouc2VyaWVzVHlwZXM9Szt2YXIgUmE9W10seGEsc2EsbixTYSxLYix0YSxELFQsTSxlYixUYTt5Yi5wcm90b3R5cGU9e2RTZXR0ZXI6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLnBhdGhzWzBdLGI9dGhpcy5wYXRoc1sxXSxjPVtdLGQ9dGhpcy5ub3csZT1hLmxlbmd0aCxmO2lmKGQ9PT0xKWM9dGhpcy50b0Q7ZWxzZSBpZihlPT09Yi5sZW5ndGgmJmQ8MSlmb3IoO2UtLTspZj1wYXJzZUZsb2F0KGFbZV0pLFxuY1tlXT1pc05hTihmKT9hW2VdOmQqcGFyc2VGbG9hdChiW2VdLWYpK2Y7ZWxzZSBjPWI7dGhpcy5lbGVtLmF0dHIoXCJkXCIsYyl9LHVwZGF0ZTpmdW5jdGlvbigpe3ZhciBhPXRoaXMuZWxlbSxiPXRoaXMucHJvcCxjPXRoaXMubm93LGQ9dGhpcy5vcHRpb25zLnN0ZXA7aWYodGhpc1tiK1wiU2V0dGVyXCJdKXRoaXNbYitcIlNldHRlclwiXSgpO2Vsc2UgYS5hdHRyP2EuZWxlbWVudCYmYS5hdHRyKGIsYyk6YS5zdHlsZVtiXT1jK3RoaXMudW5pdDtkJiZkLmNhbGwoYSxjLHRoaXMpfSxydW46ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXRoaXMsZT1mdW5jdGlvbihhKXtyZXR1cm4gZS5zdG9wcGVkPyExOmQuc3RlcChhKX0sZjt0aGlzLnN0YXJ0VGltZT0rbmV3IGZhO3RoaXMuc3RhcnQ9YTt0aGlzLmVuZD1iO3RoaXMudW5pdD1jO3RoaXMubm93PXRoaXMuc3RhcnQ7dGhpcy5wb3M9MDtlLmVsZW09dGhpcy5lbGVtO2lmKGUoKSYmUmEucHVzaChlKT09PTEpZS50aW1lcklkPXNldEludGVydmFsKGZ1bmN0aW9uKCl7Zm9yKGY9XG4wO2Y8UmEubGVuZ3RoO2YrKylSYVtmXSgpfHxSYS5zcGxpY2UoZi0tLDEpO1JhLmxlbmd0aHx8Y2xlYXJJbnRlcnZhbChlLnRpbWVySWQpfSwxMyl9LHN0ZXA6ZnVuY3Rpb24oYSl7dmFyIGI9K25ldyBmYSxjLGQ9dGhpcy5vcHRpb25zO2M9dGhpcy5lbGVtO3ZhciBlPWQuY29tcGxldGUsZj1kLmR1cmF0aW9uLGc9ZC5jdXJBbmltLGg7aWYoYy5hdHRyJiYhYy5lbGVtZW50KWM9ITE7ZWxzZSBpZihhfHxiPj1mK3RoaXMuc3RhcnRUaW1lKXt0aGlzLm5vdz10aGlzLmVuZDt0aGlzLnBvcz0xO3RoaXMudXBkYXRlKCk7YT1nW3RoaXMucHJvcF09ITA7Zm9yKGggaW4gZylnW2hdIT09ITAmJihhPSExKTthJiZlJiZlLmNhbGwoYyk7Yz0hMX1lbHNlIHRoaXMucG9zPWQuZWFzaW5nKChiLXRoaXMuc3RhcnRUaW1lKS9mKSx0aGlzLm5vdz10aGlzLnN0YXJ0Kyh0aGlzLmVuZC10aGlzLnN0YXJ0KSp0aGlzLnBvcyx0aGlzLnVwZGF0ZSgpLGM9ITA7cmV0dXJuIGN9LGluaXRQYXRoOmZ1bmN0aW9uKGEsXG5iLGMpe3ZhciBiPWJ8fFwiXCIsZD1hLnNoaWZ0LGU9Yi5pbmRleE9mKFwiQ1wiKT4tMSxmPWU/NzozLGcsYj1iLnNwbGl0KFwiIFwiKSxjPVtdLmNvbmNhdChjKSxoPWEuaXNBcmVhLGk9aD8yOjEsaj1mdW5jdGlvbihhKXtmb3IoZz1hLmxlbmd0aDtnLS07KShhW2ddPT09XCJNXCJ8fGFbZ109PT1cIkxcIikmJmEuc3BsaWNlKGcrMSwwLGFbZysxXSxhW2crMl0sYVtnKzFdLGFbZysyXSl9O2UmJihqKGIpLGooYykpO2lmKGQ8PWMubGVuZ3RoL2YmJmIubGVuZ3RoPT09Yy5sZW5ndGgpZm9yKDtkLS07KWM9Yy5zbGljZSgwLGYpLmNvbmNhdChjKSxoJiYoYz1jLmNvbmNhdChjLnNsaWNlKGMubGVuZ3RoLWYpKSk7YS5zaGlmdD0wO2lmKGIubGVuZ3RoKWZvcihhPWMubGVuZ3RoO2IubGVuZ3RoPGE7KWQ9Yi5zbGljZSgpLnNwbGljZShiLmxlbmd0aC9pLWYsZippKSxlJiYoZFtmLTZdPWRbZi0yXSxkW2YtNV09ZFtmLTFdKSxbXS5zcGxpY2UuYXBwbHkoYixbYi5sZW5ndGgvaSwwXS5jb25jYXQoZCkpO3JldHVybltiLFxuY119fTt2YXIgeD16LmV4dGVuZD1mdW5jdGlvbihhLGIpe3ZhciBjO2F8fChhPXt9KTtmb3IoYyBpbiBiKWFbY109YltjXTtyZXR1cm4gYX0scT16LnBpY2s9ZnVuY3Rpb24oKXt2YXIgYT1hcmd1bWVudHMsYixjLGQ9YS5sZW5ndGg7Zm9yKGI9MDtiPGQ7YisrKWlmKGM9YVtiXSxjIT09dCYmYyE9PW51bGwpcmV0dXJuIGN9LFU9ei53cmFwPWZ1bmN0aW9uKGEsYixjKXt2YXIgZD1hW2JdO2FbYl09ZnVuY3Rpb24oKXt2YXIgYT1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpO2EudW5zaGlmdChkKTtyZXR1cm4gYy5hcHBseSh0aGlzLGEpfX07bWE9ZnVuY3Rpb24oYSxiLGMpe2lmKCFzKGIpfHxpc05hTihiKSlyZXR1cm4gTi5sYW5nLmludmFsaWREYXRlfHxcIlwiO3ZhciBhPXEoYSxcIiVZLSVtLSVkICVIOiVNOiVTXCIpLGQ9bmV3IGZhKGItZmIoYikpLGUsZj1kW0RiXSgpLGc9ZFtFYl0oKSxoPWRbYmJdKCksaT1kW2liXSgpLGo9ZFtqYl0oKSxrPU4ubGFuZyxsPWsud2Vla2RheXMsXG5tPWsuc2hvcnRXZWVrZGF5cyxkPXgoe2E6bT9tW2ddOmxbZ10uc3Vic3RyKDAsMyksQTpsW2ddLGQ6TmEoaCksZTpOYShoLDIsXCIgXCIpLHc6ZyxiOmsuc2hvcnRNb250aHNbaV0sQjprLm1vbnRoc1tpXSxtOk5hKGkrMSkseTpqLnRvU3RyaW5nKCkuc3Vic3RyKDIsMiksWTpqLEg6TmEoZiksazpmLEk6TmEoZiUxMnx8MTIpLGw6ZiUxMnx8MTIsTTpOYShkW0NiXSgpKSxwOmY8MTI/XCJBTVwiOlwiUE1cIixQOmY8MTI/XCJhbVwiOlwicG1cIixTOk5hKGQuZ2V0U2Vjb25kcygpKSxMOk5hKHkoYiUxRTMpLDMpfSx6LmRhdGVGb3JtYXRzKTtmb3IoZSBpbiBkKWZvcig7YS5pbmRleE9mKFwiJVwiK2UpIT09LTE7KWE9YS5yZXBsYWNlKFwiJVwiK2UsdHlwZW9mIGRbZV09PT1cImZ1bmN0aW9uXCI/ZFtlXShiKTpkW2VdKTtyZXR1cm4gYz9hLnN1YnN0cigwLDEpLnRvVXBwZXJDYXNlKCkrYS5zdWJzdHIoMSk6YX07SD17bWlsbGlzZWNvbmQ6MSxzZWNvbmQ6MUUzLG1pbnV0ZTo2RTQsaG91cjozNkU1LGRheTo4NjRFNSxcbndlZWs6NjA0OEU1LG1vbnRoOjI0MTkyRTUseWVhcjozMTQ0OTZFNX07ei5udW1iZXJGb3JtYXQ9ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGE9K2F8fDAsZT1OLmxhbmcsZj0oYS50b1N0cmluZygpLnNwbGl0KFwiLlwiKVsxXXx8XCJcIikubGVuZ3RoLGcsaCxpPU1hdGguYWJzKGEpO2I9PT0tMT9iPU1hdGgubWluKGYsMjApOmlzTmFOKGIpJiYoYj0yKTtnPVN0cmluZyhHKGkudG9GaXhlZChiKSkpO2g9Zy5sZW5ndGg+Mz9nLmxlbmd0aCUzOjA7Yz1xKGMsZS5kZWNpbWFsUG9pbnQpO2Q9cShkLGUudGhvdXNhbmRzU2VwKTthPWE8MD9cIi1cIjpcIlwiO2ErPWg/Zy5zdWJzdHIoMCxoKStkOlwiXCI7YSs9Zy5zdWJzdHIoaCkucmVwbGFjZSgvKFxcZHszfSkoPz1cXGQpL2csXCIkMVwiK2QpOytiJiYoZD1NYXRoLmFicyhpLWcrTWF0aC5wb3coMTAsLU1hdGgubWF4KGIsZiktMSkpLGErPWMrZC50b0ZpeGVkKGIpLnNsaWNlKDIpKTtyZXR1cm4gYX07TWF0aC5lYXNlSW5PdXRTaW5lPWZ1bmN0aW9uKGEpe3JldHVybi0wLjUqXG4oTWF0aC5jb3MoTWF0aC5QSSphKS0xKX07eGE9ZnVuY3Rpb24oYSxiKXt2YXIgYztpZihiPT09XCJ3aWR0aFwiKXJldHVybiBNYXRoLm1pbihhLm9mZnNldFdpZHRoLGEuc2Nyb2xsV2lkdGgpLXhhKGEsXCJwYWRkaW5nLWxlZnRcIikteGEoYSxcInBhZGRpbmctcmlnaHRcIik7ZWxzZSBpZihiPT09XCJoZWlnaHRcIilyZXR1cm4gTWF0aC5taW4oYS5vZmZzZXRIZWlnaHQsYS5zY3JvbGxIZWlnaHQpLXhhKGEsXCJwYWRkaW5nLXRvcFwiKS14YShhLFwicGFkZGluZy1ib3R0b21cIik7cmV0dXJuKGM9Si5nZXRDb21wdXRlZFN0eWxlKGEsdm9pZCAwKSkmJkcoYy5nZXRQcm9wZXJ0eVZhbHVlKGIpKX07c2E9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYi5pbmRleE9mP2IuaW5kZXhPZihhKTpbXS5pbmRleE9mLmNhbGwoYixhKX07U2E9ZnVuY3Rpb24oYSxiKXtyZXR1cm5bXS5maWx0ZXIuY2FsbChhLGIpfTt0YT1mdW5jdGlvbihhLGIpe2Zvcih2YXIgYz1bXSxkPTAsZT1hLmxlbmd0aDtkPGU7ZCsrKWNbZF09Yi5jYWxsKGFbZF0sXG5hW2RdLGQsYSk7cmV0dXJuIGN9O0tiPWZ1bmN0aW9uKGEpe3ZhciBiPUIuZG9jdW1lbnRFbGVtZW50LGE9YS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtyZXR1cm57dG9wOmEudG9wKyhKLnBhZ2VZT2Zmc2V0fHxiLnNjcm9sbFRvcCktKGIuY2xpZW50VG9wfHwwKSxsZWZ0OmEubGVmdCsoSi5wYWdlWE9mZnNldHx8Yi5zY3JvbGxMZWZ0KS0oYi5jbGllbnRMZWZ0fHwwKX19O1RhPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1SYS5sZW5ndGg7Yi0tOylpZihSYVtiXS5lbGVtPT09YSlSYVtiXS5zdG9wcGVkPSEwfTtuPWZ1bmN0aW9uKGEsYil7cmV0dXJuIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoYSxiKX07RD1mdW5jdGlvbihhLGIsYyl7ZnVuY3Rpb24gZChiKXtiLnRhcmdldD1iLnNyY0VsZW1lbnR8fEo7Yy5jYWxsKGEsYil9dmFyIGU9YS5oY0V2ZW50cz1hLmhjRXZlbnRzfHx7fTtpZihhLmFkZEV2ZW50TGlzdGVuZXIpYS5hZGRFdmVudExpc3RlbmVyKGIsYywhMSk7ZWxzZSBpZihhLmF0dGFjaEV2ZW50KXtpZighYS5oY0V2ZW50c0lFKWEuaGNFdmVudHNJRT1cbnt9O2EuaGNFdmVudHNJRVtjLnRvU3RyaW5nKCldPWQ7YS5hdHRhY2hFdmVudChcIm9uXCIrYixkKX1lW2JdfHwoZVtiXT1bXSk7ZVtiXS5wdXNoKGMpfTtUPWZ1bmN0aW9uKGEsYixjKXtmdW5jdGlvbiBkKGIsYyl7YS5yZW1vdmVFdmVudExpc3RlbmVyP2EucmVtb3ZlRXZlbnRMaXN0ZW5lcihiLGMsITEpOmEuYXR0YWNoRXZlbnQmJihjPWEuaGNFdmVudHNJRVtjLnRvU3RyaW5nKCldLGEuZGV0YWNoRXZlbnQoXCJvblwiK2IsYykpfWZ1bmN0aW9uIGUoKXt2YXIgYyxlLGY7aWYoYS5ub2RlTmFtZSlmb3IoZiBpbiBiPyhjPXt9LGNbYl09ITApOmM9ZyxjKWlmKGdbZl0pZm9yKGU9Z1tmXS5sZW5ndGg7ZS0tOylkKGYsZ1tmXVtlXSl9dmFyIGYsZz1hLmhjRXZlbnRzLGg7aWYoZyliPyhmPWdbYl18fFtdLGM/KGg9c2EoYyxmKSxoPi0xJiYoZi5zcGxpY2UoaCwxKSxnW2JdPWYpLGQoYixjKSk6KGUoKSxnW2JdPVtdKSk6KGUoKSxhLmhjRXZlbnRzPXt9KX07TT1mdW5jdGlvbihhLGIsYyxkKXt2YXIgZTtcbmU9YS5oY0V2ZW50czt2YXIgZixnLGM9Y3x8e307aWYoQi5jcmVhdGVFdmVudCYmKGEuZGlzcGF0Y2hFdmVudHx8YS5maXJlRXZlbnQpKWU9Qi5jcmVhdGVFdmVudChcIkV2ZW50c1wiKSxlLmluaXRFdmVudChiLCEwLCEwKSxlLnRhcmdldD1hLHgoZSxjKSxhLmRpc3BhdGNoRXZlbnQ/YS5kaXNwYXRjaEV2ZW50KGUpOmEuZmlyZUV2ZW50KGIsZSk7ZWxzZSBpZihlKXtlPWVbYl18fFtdO2Y9ZS5sZW5ndGg7aWYoIWMucHJldmVudERlZmF1bHQpYy5wcmV2ZW50RGVmYXVsdD1mdW5jdGlvbigpe2MuZGVmYXVsdFByZXZlbnRlZD0hMH07Yy50YXJnZXQ9YTtpZighYy50eXBlKWMudHlwZT1iO2ZvcihiPTA7YjxmO2IrKylnPWVbYl0sZy5jYWxsKGEsYyk9PT0hMSYmYy5wcmV2ZW50RGVmYXVsdCgpfWQmJiFjLmRlZmF1bHRQcmV2ZW50ZWQmJmQoYyl9O2ViPWZ1bmN0aW9uKGEsYixjKXt2YXIgZCxlPVwiXCIsZixnLGg7ZGEoYyl8fChkPWFyZ3VtZW50cyxjPXtkdXJhdGlvbjpkWzJdLGVhc2luZzpkWzNdLFxuY29tcGxldGU6ZFs0XX0pO2lmKCF1YShjLmR1cmF0aW9uKSljLmR1cmF0aW9uPTQwMDtjLmVhc2luZz10eXBlb2YgYy5lYXNpbmc9PT1cImZ1bmN0aW9uXCI/Yy5lYXNpbmc6TWF0aFtjLmVhc2luZ118fE1hdGguZWFzZUluT3V0U2luZTtjLmN1ckFuaW09QyhiKTtmb3IoaCBpbiBiKWc9bmV3IHliKGEsYyxoKSxmPW51bGwsaD09PVwiZFwiPyhnLnBhdGhzPWcuaW5pdFBhdGgoYSxhLmQsYi5kKSxnLnRvRD1iLmQsZD0wLGY9MSk6YS5hdHRyP2Q9YS5hdHRyKGgpOihkPXBhcnNlRmxvYXQoeGEoYSxoKSl8fDAsaCE9PVwib3BhY2l0eVwiJiYoZT1cInB4XCIpKSxmfHwoZj1iW2hdKSxmLm1hdGNoJiZmLm1hdGNoKFwicHhcIikmJihmPWYucmVwbGFjZSgvcHgvZyxcIlwiKSksZy5ydW4oZCxmLGUpfTtpZihKLmpRdWVyeSlKLmpRdWVyeS5mbi5oaWdoY2hhcnRzPWZ1bmN0aW9uKCl7dmFyIGE9W10uc2xpY2UuY2FsbChhcmd1bWVudHMpO2lmKHRoaXNbMF0pcmV0dXJuIGFbMF0/KG5ldyAoeltEYShhWzBdKT9hLnNoaWZ0KCk6XG5cIkNoYXJ0XCJdKSh0aGlzWzBdLGFbMF0sYVsxXSksdGhpcyk6JFtYKHRoaXNbMF0sXCJkYXRhLWhpZ2hjaGFydHMtY2hhcnRcIildfTtCJiYhQi5kZWZhdWx0VmlldyYmKHhhPWZ1bmN0aW9uKGEsYil7dmFyIGM7Yz17d2lkdGg6XCJjbGllbnRXaWR0aFwiLGhlaWdodDpcImNsaWVudEhlaWdodFwifVtiXTtpZihhLnN0eWxlW2JdKXJldHVybiBHKGEuc3R5bGVbYl0pO2I9PT1cIm9wYWNpdHlcIiYmKGI9XCJmaWx0ZXJcIik7aWYoYylyZXR1cm4gYS5zdHlsZS56b29tPTEsTWF0aC5tYXgoYVtjXS0yKnhhKGEsXCJwYWRkaW5nXCIpLDApO2M9YS5jdXJyZW50U3R5bGVbYi5yZXBsYWNlKC9cXC0oXFx3KS9nLGZ1bmN0aW9uKGEsYil7cmV0dXJuIGIudG9VcHBlckNhc2UoKX0pXTtiPT09XCJmaWx0ZXJcIiYmKGM9Yy5yZXBsYWNlKC9hbHBoYVxcKG9wYWNpdHk9KFswLTldKylcXCkvLGZ1bmN0aW9uKGEsYil7cmV0dXJuIGIvMTAwfSkpO3JldHVybiBjPT09XCJcIj8xOkcoYyl9KTtBcnJheS5wcm90b3R5cGUuZm9yRWFjaHx8XG4obj1mdW5jdGlvbihhLGIpe2Zvcih2YXIgYz0wLGQ9YS5sZW5ndGg7YzxkO2MrKylpZihiLmNhbGwoYVtjXSxhW2NdLGMsYSk9PT0hMSlyZXR1cm4gY30pO0FycmF5LnByb3RvdHlwZS5pbmRleE9mfHwoc2E9ZnVuY3Rpb24oYSxiKXt2YXIgYyxkPTA7aWYoYilmb3IoYz1iLmxlbmd0aDtkPGM7ZCsrKWlmKGJbZF09PT1hKXJldHVybiBkO3JldHVybi0xfSk7QXJyYXkucHJvdG90eXBlLmZpbHRlcnx8KFNhPWZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPVtdLGQ9MCxlPWEubGVuZ3RoO2Q8ZTtkKyspYihhW2RdLGQpJiZjLnB1c2goYVtkXSk7cmV0dXJuIGN9KTt6LkZ4PXliO3ouaW5BcnJheT1zYTt6LmVhY2g9bjt6LmdyZXA9U2E7ei5vZmZzZXQ9S2I7ei5tYXA9dGE7ei5hZGRFdmVudD1EO3oucmVtb3ZlRXZlbnQ9VDt6LmZpcmVFdmVudD1NO3ouYW5pbWF0ZT1lYjt6LmFuaW1PYmplY3Q9aGI7ei5zdG9wPVRhO049e2NvbG9yczpcIiM3Y2I1ZWMsIzQzNDM0OCwjOTBlZDdkLCNmN2EzNWMsIzgwODVlOSwjZjE1YzgwLCNlNGQzNTQsIzJiOTA4ZiwjZjQ1YjViLCM5MWU4ZTFcIi5zcGxpdChcIixcIiksXG5zeW1ib2xzOltcImNpcmNsZVwiLFwiZGlhbW9uZFwiLFwic3F1YXJlXCIsXCJ0cmlhbmdsZVwiLFwidHJpYW5nbGUtZG93blwiXSxsYW5nOntsb2FkaW5nOlwiTG9hZGluZy4uLlwiLG1vbnRoczpcIkphbnVhcnksRmVicnVhcnksTWFyY2gsQXByaWwsTWF5LEp1bmUsSnVseSxBdWd1c3QsU2VwdGVtYmVyLE9jdG9iZXIsTm92ZW1iZXIsRGVjZW1iZXJcIi5zcGxpdChcIixcIiksc2hvcnRNb250aHM6XCJKYW4sRmViLE1hcixBcHIsTWF5LEp1bixKdWwsQXVnLFNlcCxPY3QsTm92LERlY1wiLnNwbGl0KFwiLFwiKSx3ZWVrZGF5czpcIlN1bmRheSxNb25kYXksVHVlc2RheSxXZWRuZXNkYXksVGh1cnNkYXksRnJpZGF5LFNhdHVyZGF5XCIuc3BsaXQoXCIsXCIpLGRlY2ltYWxQb2ludDpcIi5cIixudW1lcmljU3ltYm9sczpcImssTSxHLFQsUCxFXCIuc3BsaXQoXCIsXCIpLHJlc2V0Wm9vbTpcIlJlc2V0IHpvb21cIixyZXNldFpvb21UaXRsZTpcIlJlc2V0IHpvb20gbGV2ZWwgMToxXCIsdGhvdXNhbmRzU2VwOlwiIFwifSxnbG9iYWw6e3VzZVVUQzohMCxcbmNhbnZhc1Rvb2xzVVJMOlwiaHR0cDovL2NvZGUuaGlnaGNoYXJ0cy5jb20vbW9kdWxlcy9jYW52YXMtdG9vbHMuanNcIixWTUxSYWRpYWxHcmFkaWVudFVSTDpcImh0dHA6Ly9jb2RlLmhpZ2hjaGFydHMuY29tL3N0b2NrLzQuMi40L2dmeC92bWwtcmFkaWFsLWdyYWRpZW50LnBuZ1wifSxjaGFydDp7Ym9yZGVyQ29sb3I6XCIjNDU3MkE3XCIsYm9yZGVyUmFkaXVzOjAsZGVmYXVsdFNlcmllc1R5cGU6XCJsaW5lXCIsaWdub3JlSGlkZGVuU2VyaWVzOiEwLHNwYWNpbmc6WzEwLDEwLDE1LDEwXSxiYWNrZ3JvdW5kQ29sb3I6XCIjRkZGRkZGXCIscGxvdEJvcmRlckNvbG9yOlwiI0MwQzBDMFwiLHJlc2V0Wm9vbUJ1dHRvbjp7dGhlbWU6e3pJbmRleDoyMH0scG9zaXRpb246e2FsaWduOlwicmlnaHRcIix4Oi0xMCx5OjEwfX19LHRpdGxlOnt0ZXh0OlwiQ2hhcnQgdGl0bGVcIixhbGlnbjpcImNlbnRlclwiLG1hcmdpbjoxNSxzdHlsZTp7Y29sb3I6XCIjMzMzMzMzXCIsZm9udFNpemU6XCIxOHB4XCJ9fSxzdWJ0aXRsZTp7dGV4dDpcIlwiLFxuYWxpZ246XCJjZW50ZXJcIixzdHlsZTp7Y29sb3I6XCIjNTU1NTU1XCJ9fSxwbG90T3B0aW9uczp7bGluZTp7YWxsb3dQb2ludFNlbGVjdDohMSxzaG93Q2hlY2tib3g6ITEsYW5pbWF0aW9uOntkdXJhdGlvbjoxRTN9LGV2ZW50czp7fSxsaW5lV2lkdGg6MixtYXJrZXI6e2xpbmVXaWR0aDowLHJhZGl1czo0LGxpbmVDb2xvcjpcIiNGRkZGRkZcIixzdGF0ZXM6e2hvdmVyOntlbmFibGVkOiEwLGxpbmVXaWR0aFBsdXM6MSxyYWRpdXNQbHVzOjJ9LHNlbGVjdDp7ZmlsbENvbG9yOlwiI0ZGRkZGRlwiLGxpbmVDb2xvcjpcIiMwMDAwMDBcIixsaW5lV2lkdGg6Mn19fSxwb2ludDp7ZXZlbnRzOnt9fSxkYXRhTGFiZWxzOnthbGlnbjpcImNlbnRlclwiLGZvcm1hdHRlcjpmdW5jdGlvbigpe3JldHVybiB0aGlzLnk9PT1udWxsP1wiXCI6ei5udW1iZXJGb3JtYXQodGhpcy55LC0xKX0sc3R5bGU6e2NvbG9yOlwiY29udHJhc3RcIixmb250U2l6ZTpcIjExcHhcIixmb250V2VpZ2h0OlwiYm9sZFwiLHRleHRTaGFkb3c6XCIwIDAgNnB4IGNvbnRyYXN0LCAwIDAgM3B4IGNvbnRyYXN0XCJ9LFxudmVydGljYWxBbGlnbjpcImJvdHRvbVwiLHg6MCx5OjAscGFkZGluZzo1fSxjcm9wVGhyZXNob2xkOjMwMCxwb2ludFJhbmdlOjAsc29mdFRocmVzaG9sZDohMCxzdGF0ZXM6e2hvdmVyOntsaW5lV2lkdGhQbHVzOjEsbWFya2VyOnt9LGhhbG86e3NpemU6MTAsb3BhY2l0eTowLjI1fX0sc2VsZWN0OnttYXJrZXI6e319fSxzdGlja3lUcmFja2luZzohMCx0dXJib1RocmVzaG9sZDoxRTN9fSxsYWJlbHM6e3N0eWxlOntwb3NpdGlvbjpcImFic29sdXRlXCIsY29sb3I6XCIjM0U1NzZGXCJ9fSxsZWdlbmQ6e2VuYWJsZWQ6ITAsYWxpZ246XCJjZW50ZXJcIixsYXlvdXQ6XCJob3Jpem9udGFsXCIsbGFiZWxGb3JtYXR0ZXI6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5uYW1lfSxib3JkZXJDb2xvcjpcIiM5MDkwOTBcIixib3JkZXJSYWRpdXM6MCxuYXZpZ2F0aW9uOnthY3RpdmVDb2xvcjpcIiMyNzRiNmRcIixpbmFjdGl2ZUNvbG9yOlwiI0NDQ1wifSxzaGFkb3c6ITEsaXRlbVN0eWxlOntjb2xvcjpcIiMzMzMzMzNcIixmb250U2l6ZTpcIjEycHhcIixcbmZvbnRXZWlnaHQ6XCJib2xkXCJ9LGl0ZW1Ib3ZlclN0eWxlOntjb2xvcjpcIiMwMDBcIn0saXRlbUhpZGRlblN0eWxlOntjb2xvcjpcIiNDQ0NcIn0saXRlbUNoZWNrYm94U3R5bGU6e3Bvc2l0aW9uOlwiYWJzb2x1dGVcIix3aWR0aDpcIjEzcHhcIixoZWlnaHQ6XCIxM3B4XCJ9LHN5bWJvbFBhZGRpbmc6NSx2ZXJ0aWNhbEFsaWduOlwiYm90dG9tXCIseDowLHk6MCx0aXRsZTp7c3R5bGU6e2ZvbnRXZWlnaHQ6XCJib2xkXCJ9fX0sbG9hZGluZzp7bGFiZWxTdHlsZTp7Zm9udFdlaWdodDpcImJvbGRcIixwb3NpdGlvbjpcInJlbGF0aXZlXCIsdG9wOlwiNDUlXCJ9LHN0eWxlOntwb3NpdGlvbjpcImFic29sdXRlXCIsYmFja2dyb3VuZENvbG9yOlwid2hpdGVcIixvcGFjaXR5OjAuNSx0ZXh0QWxpZ246XCJjZW50ZXJcIn19LHRvb2x0aXA6e2VuYWJsZWQ6ITAsYW5pbWF0aW9uOmphLGJhY2tncm91bmRDb2xvcjpcInJnYmEoMjQ5LCAyNDksIDI0OSwgLjg1KVwiLGJvcmRlcldpZHRoOjEsYm9yZGVyUmFkaXVzOjMsZGF0ZVRpbWVMYWJlbEZvcm1hdHM6e21pbGxpc2Vjb25kOlwiJUEsICViICVlLCAlSDolTTolUy4lTFwiLFxuc2Vjb25kOlwiJUEsICViICVlLCAlSDolTTolU1wiLG1pbnV0ZTpcIiVBLCAlYiAlZSwgJUg6JU1cIixob3VyOlwiJUEsICViICVlLCAlSDolTVwiLGRheTpcIiVBLCAlYiAlZSwgJVlcIix3ZWVrOlwiV2VlayBmcm9tICVBLCAlYiAlZSwgJVlcIixtb250aDpcIiVCICVZXCIseWVhcjpcIiVZXCJ9LGZvb3RlckZvcm1hdDpcIlwiLGhlYWRlckZvcm1hdDonPHNwYW4gc3R5bGU9XCJmb250LXNpemU6IDEwcHhcIj57cG9pbnQua2V5fTwvc3Bhbj48YnIvPicscG9pbnRGb3JtYXQ6JzxzcGFuIHN0eWxlPVwiY29sb3I6e3BvaW50LmNvbG9yfVwiPlxcdTI1Y2Y8L3NwYW4+IHtzZXJpZXMubmFtZX06IDxiPntwb2ludC55fTwvYj48YnIvPicsc2hhZG93OiEwLHNuYXA6a2I/MjU6MTAsc3R5bGU6e2NvbG9yOlwiIzMzMzMzM1wiLGN1cnNvcjpcImRlZmF1bHRcIixmb250U2l6ZTpcIjEycHhcIixwYWRkaW5nOlwiOHB4XCIscG9pbnRlckV2ZW50czpcIm5vbmVcIix3aGl0ZVNwYWNlOlwibm93cmFwXCJ9fSxjcmVkaXRzOntlbmFibGVkOiEwLHRleHQ6XCJIaWdoY2hhcnRzLmNvbVwiLFxuaHJlZjpcImh0dHA6Ly93d3cuaGlnaGNoYXJ0cy5jb21cIixwb3NpdGlvbjp7YWxpZ246XCJyaWdodFwiLHg6LTEwLHZlcnRpY2FsQWxpZ246XCJib3R0b21cIix5Oi01fSxzdHlsZTp7Y3Vyc29yOlwicG9pbnRlclwiLGNvbG9yOlwiIzkwOTA5MFwiLGZvbnRTaXplOlwiOXB4XCJ9fX07dmFyIFc9Ti5wbG90T3B0aW9ucyxjYT1XLmxpbmU7T2IoKTt3YS5wcm90b3R5cGU9e3BhcnNlcnM6W3tyZWdleDovcmdiYVxcKFxccyooWzAtOV17MSwzfSlcXHMqLFxccyooWzAtOV17MSwzfSlcXHMqLFxccyooWzAtOV17MSwzfSlcXHMqLFxccyooWzAtOV0/KD86XFwuWzAtOV0rKT8pXFxzKlxcKS8scGFyc2U6ZnVuY3Rpb24oYSl7cmV0dXJuW0coYVsxXSksRyhhWzJdKSxHKGFbM10pLHBhcnNlRmxvYXQoYVs0XSwxMCldfX0se3JlZ2V4Oi8jKFthLWZBLUYwLTldezJ9KShbYS1mQS1GMC05XXsyfSkoW2EtZkEtRjAtOV17Mn0pLyxwYXJzZTpmdW5jdGlvbihhKXtyZXR1cm5bRyhhWzFdLDE2KSxHKGFbMl0sMTYpLEcoYVszXSwxNiksMV19fSxcbntyZWdleDovcmdiXFwoXFxzKihbMC05XXsxLDN9KVxccyosXFxzKihbMC05XXsxLDN9KVxccyosXFxzKihbMC05XXsxLDN9KVxccypcXCkvLHBhcnNlOmZ1bmN0aW9uKGEpe3JldHVybltHKGFbMV0pLEcoYVsyXSksRyhhWzNdKSwxXX19XSxpbml0OmZ1bmN0aW9uKGEpe3ZhciBiLGMsZCxlO2lmKCh0aGlzLmlucHV0PWEpJiZhLnN0b3BzKXRoaXMuc3RvcHM9dGEoYS5zdG9wcyxmdW5jdGlvbihhKXtyZXR1cm4gbmV3IHdhKGFbMV0pfSk7ZWxzZSBmb3IoZD10aGlzLnBhcnNlcnMubGVuZ3RoO2QtLSYmIWM7KWU9dGhpcy5wYXJzZXJzW2RdLChiPWUucmVnZXguZXhlYyhhKSkmJihjPWUucGFyc2UoYikpO3RoaXMucmdiYT1jfHxbXX0sZ2V0OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuaW5wdXQsYz10aGlzLnJnYmEsZDt0aGlzLnN0b3BzPyhkPUMoYiksZC5zdG9wcz1bXS5jb25jYXQoZC5zdG9wcyksbih0aGlzLnN0b3BzLGZ1bmN0aW9uKGIsYyl7ZC5zdG9wc1tjXT1bZC5zdG9wc1tjXVswXSxiLmdldChhKV19KSk6XG5kPWMmJiFpc05hTihjWzBdKT9hPT09XCJyZ2JcInx8IWEmJmNbM109PT0xP1wicmdiKFwiK2NbMF0rXCIsXCIrY1sxXStcIixcIitjWzJdK1wiKVwiOmE9PT1cImFcIj9jWzNdOlwicmdiYShcIitjLmpvaW4oXCIsXCIpK1wiKVwiOmI7cmV0dXJuIGR9LGJyaWdodGVuOmZ1bmN0aW9uKGEpe3ZhciBiLGM9dGhpcy5yZ2JhO2lmKHRoaXMuc3RvcHMpbih0aGlzLnN0b3BzLGZ1bmN0aW9uKGIpe2IuYnJpZ2h0ZW4oYSl9KTtlbHNlIGlmKHVhKGEpJiZhIT09MClmb3IoYj0wO2I8MztiKyspY1tiXSs9RyhhKjI1NSksY1tiXTwwJiYoY1tiXT0wKSxjW2JdPjI1NSYmKGNbYl09MjU1KTtyZXR1cm4gdGhpc30sc2V0T3BhY2l0eTpmdW5jdGlvbihhKXt0aGlzLnJnYmFbM109YTtyZXR1cm4gdGhpc319O1oucHJvdG90eXBlPXtvcGFjaXR5OjEsdGV4dFByb3BzOlwiZGlyZWN0aW9uLGZvbnRTaXplLGZvbnRXZWlnaHQsZm9udEZhbWlseSxmb250U3R5bGUsY29sb3IsbGluZUhlaWdodCx3aWR0aCx0ZXh0RGVjb3JhdGlvbix0ZXh0T3ZlcmZsb3csdGV4dFNoYWRvd1wiLnNwbGl0KFwiLFwiKSxcbmluaXQ6ZnVuY3Rpb24oYSxiKXt0aGlzLmVsZW1lbnQ9Yj09PVwic3BhblwiP2VhKGIpOkIuY3JlYXRlRWxlbWVudE5TKFFhLGIpO3RoaXMucmVuZGVyZXI9YX0sYW5pbWF0ZTpmdW5jdGlvbihhLGIsYyl7Yj1xKGIsdGhpcy5yZW5kZXJlci5nbG9iYWxBbmltYXRpb24sITApO1RhKHRoaXMpO2lmKGIpe2lmKGMpYi5jb21wbGV0ZT1jO2ViKHRoaXMsYSxiKX1lbHNlIHRoaXMuYXR0cihhLG51bGwsYyk7cmV0dXJuIHRoaXN9LGNvbG9yR3JhZGllbnQ6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXRoaXMucmVuZGVyZXIsZSxmLGcsaCxpLGosayxsLG0sbyxwLHI9W10sQTthLmxpbmVhckdyYWRpZW50P2Y9XCJsaW5lYXJHcmFkaWVudFwiOmEucmFkaWFsR3JhZGllbnQmJihmPVwicmFkaWFsR3JhZGllbnRcIik7aWYoZil7Zz1hW2ZdO2k9ZC5ncmFkaWVudHM7az1hLnN0b3BzO289Yy5yYWRpYWxSZWZlcmVuY2U7SmEoZykmJihhW2ZdPWc9e3gxOmdbMF0seTE6Z1sxXSx4MjpnWzJdLHkyOmdbM10sZ3JhZGllbnRVbml0czpcInVzZXJTcGFjZU9uVXNlXCJ9KTtcbmY9PT1cInJhZGlhbEdyYWRpZW50XCImJm8mJiFzKGcuZ3JhZGllbnRVbml0cykmJihoPWcsZz1DKGcsZC5nZXRSYWRpYWxBdHRyKG8saCkse2dyYWRpZW50VW5pdHM6XCJ1c2VyU3BhY2VPblVzZVwifSkpO2ZvcihwIGluIGcpcCE9PVwiaWRcIiYmci5wdXNoKHAsZ1twXSk7Zm9yKHAgaW4gaylyLnB1c2goa1twXSk7cj1yLmpvaW4oXCIsXCIpO2lbcl0/bz1pW3JdLmF0dHIoXCJpZFwiKTooZy5pZD1vPVwiaGlnaGNoYXJ0cy1cIitKYisrLGlbcl09aj1kLmNyZWF0ZUVsZW1lbnQoZikuYXR0cihnKS5hZGQoZC5kZWZzKSxqLnJhZEF0dHI9aCxqLnN0b3BzPVtdLG4oayxmdW5jdGlvbihhKXthWzFdLmluZGV4T2YoXCJyZ2JhXCIpPT09MD8oZT13YShhWzFdKSxsPWUuZ2V0KFwicmdiXCIpLG09ZS5nZXQoXCJhXCIpKToobD1hWzFdLG09MSk7YT1kLmNyZWF0ZUVsZW1lbnQoXCJzdG9wXCIpLmF0dHIoe29mZnNldDphWzBdLFwic3RvcC1jb2xvclwiOmwsXCJzdG9wLW9wYWNpdHlcIjptfSkuYWRkKGopO2ouc3RvcHMucHVzaChhKX0pKTtcbkE9XCJ1cmwoXCIrZC51cmwrXCIjXCIrbytcIilcIjtjLnNldEF0dHJpYnV0ZShiLEEpO2MuZ3JhZGllbnQ9cjthLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIEF9fX0sYXBwbHlUZXh0U2hhZG93OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuZWxlbWVudCxjLGQ9YS5pbmRleE9mKFwiY29udHJhc3RcIikhPT0tMSxlPXt9LGY9dGhpcy5yZW5kZXJlci5mb3JFeHBvcnQsZz1mfHxiLnN0eWxlLnRleHRTaGFkb3chPT10JiYhS2E7aWYoZCllLnRleHRTaGFkb3c9YT1hLnJlcGxhY2UoL2NvbnRyYXN0L2csdGhpcy5yZW5kZXJlci5nZXRDb250cmFzdChiLnN0eWxlLmZpbGwpKTtpZih0Ynx8ZillLnRleHRSZW5kZXJpbmc9XCJnZW9tZXRyaWNQcmVjaXNpb25cIjtnP3RoaXMuY3NzKGUpOih0aGlzLmZha2VUUz0hMCx0aGlzLnlTZXR0ZXI9dGhpcy54U2V0dGVyLGM9W10uc2xpY2UuY2FsbChiLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwidHNwYW5cIikpLG4oYS5zcGxpdCgvXFxzPyxcXHM/L2cpLGZ1bmN0aW9uKGEpe3ZhciBkPVxuYi5maXJzdENoaWxkLGUsZixhPWEuc3BsaXQoXCIgXCIpO2U9YVthLmxlbmd0aC0xXTsoZj1hW2EubGVuZ3RoLTJdKSYmbihjLGZ1bmN0aW9uKGEsYyl7dmFyIGc7Yz09PTAmJihhLnNldEF0dHJpYnV0ZShcInhcIixiLmdldEF0dHJpYnV0ZShcInhcIikpLGM9Yi5nZXRBdHRyaWJ1dGUoXCJ5XCIpLGEuc2V0QXR0cmlidXRlKFwieVwiLGN8fDApLGM9PT1udWxsJiZiLnNldEF0dHJpYnV0ZShcInlcIiwwKSk7Zz1hLmNsb25lTm9kZSgxKTtYKGcse1wiY2xhc3NcIjpcImhpZ2hjaGFydHMtdGV4dC1zaGFkb3dcIixmaWxsOmUsc3Ryb2tlOmUsXCJzdHJva2Utb3BhY2l0eVwiOjEvdihHKGYpLDMpLFwic3Ryb2tlLXdpZHRoXCI6ZixcInN0cm9rZS1saW5lam9pblwiOlwicm91bmRcIn0pO2IuaW5zZXJ0QmVmb3JlKGcsZCl9KX0pKX0sYXR0cjpmdW5jdGlvbihhLGIsYyl7dmFyIGQsZT10aGlzLmVsZW1lbnQsZixnPXRoaXMsaDt0eXBlb2YgYT09PVwic3RyaW5nXCImJmIhPT10JiYoZD1hLGE9e30sYVtkXT1iKTtpZih0eXBlb2YgYT09PVxuXCJzdHJpbmdcIilnPSh0aGlzW2ErXCJHZXR0ZXJcIl18fHRoaXMuX2RlZmF1bHRHZXR0ZXIpLmNhbGwodGhpcyxhLGUpO2Vsc2V7Zm9yKGQgaW4gYSl7Yj1hW2RdO2g9ITE7dGhpcy5zeW1ib2xOYW1lJiYvXih4fHl8d2lkdGh8aGVpZ2h0fHJ8c3RhcnR8ZW5kfGlubmVyUnxhbmNob3JYfGFuY2hvclkpLy50ZXN0KGQpJiYoZnx8KHRoaXMuc3ltYm9sQXR0cihhKSxmPSEwKSxoPSEwKTtpZih0aGlzLnJvdGF0aW9uJiYoZD09PVwieFwifHxkPT09XCJ5XCIpKXRoaXMuZG9UcmFuc2Zvcm09ITA7aHx8KGg9dGhpc1tkK1wiU2V0dGVyXCJdfHx0aGlzLl9kZWZhdWx0U2V0dGVyLGguY2FsbCh0aGlzLGIsZCxlKSx0aGlzLnNoYWRvd3MmJi9eKHdpZHRofGhlaWdodHx2aXNpYmlsaXR5fHh8eXxkfHRyYW5zZm9ybXxjeHxjeXxyKSQvLnRlc3QoZCkmJnRoaXMudXBkYXRlU2hhZG93cyhkLGIsaCkpfWlmKHRoaXMuZG9UcmFuc2Zvcm0pdGhpcy51cGRhdGVUcmFuc2Zvcm0oKSx0aGlzLmRvVHJhbnNmb3JtPSExfWMmJlxuYygpO3JldHVybiBnfSx1cGRhdGVTaGFkb3dzOmZ1bmN0aW9uKGEsYixjKXtmb3IodmFyIGQ9dGhpcy5zaGFkb3dzLGU9ZC5sZW5ndGg7ZS0tOyljLmNhbGwoZFtlXSxhPT09XCJoZWlnaHRcIj9NYXRoLm1heChiLShkW2VdLmN1dEhlaWdodHx8MCksMCk6YT09PVwiZFwiP3RoaXMuZDpiLGEsZFtlXSl9LGFkZENsYXNzOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuZWxlbWVudCxjPVgoYixcImNsYXNzXCIpfHxcIlwiO2MuaW5kZXhPZihhKT09PS0xJiZYKGIsXCJjbGFzc1wiLGMrXCIgXCIrYSk7cmV0dXJuIHRoaXN9LHN5bWJvbEF0dHI6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztuKFwieCx5LHIsc3RhcnQsZW5kLHdpZHRoLGhlaWdodCxpbm5lclIsYW5jaG9yWCxhbmNob3JZXCIuc3BsaXQoXCIsXCIpLGZ1bmN0aW9uKGMpe2JbY109cShhW2NdLGJbY10pfSk7Yi5hdHRyKHtkOmIucmVuZGVyZXIuc3ltYm9sc1tiLnN5bWJvbE5hbWVdKGIueCxiLnksYi53aWR0aCxiLmhlaWdodCxiKX0pfSxjbGlwOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmF0dHIoXCJjbGlwLXBhdGhcIixcbmE/XCJ1cmwoXCIrdGhpcy5yZW5kZXJlci51cmwrXCIjXCIrYS5pZCtcIilcIjpcIm5vbmVcIil9LGNyaXNwOmZ1bmN0aW9uKGEpe3ZhciBiLGM9e30sZCxlPXRoaXMuc3Ryb2tlV2lkdGh8fDA7ZD15KGUpJTIvMjthLng9VihhLnh8fHRoaXMueHx8MCkrZDthLnk9VihhLnl8fHRoaXMueXx8MCkrZDthLndpZHRoPVYoKGEud2lkdGh8fHRoaXMud2lkdGh8fDApLTIqZCk7YS5oZWlnaHQ9VigoYS5oZWlnaHR8fHRoaXMuaGVpZ2h0fHwwKS0yKmQpO2Euc3Ryb2tlV2lkdGg9ZTtmb3IoYiBpbiBhKXRoaXNbYl0hPT1hW2JdJiYodGhpc1tiXT1jW2JdPWFbYl0pO3JldHVybiBjfSxjc3M6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5zdHlsZXMsYz17fSxkPXRoaXMuZWxlbWVudCxlLGYsZz1cIlwiO2U9IWI7aWYoYSYmYS5jb2xvcilhLmZpbGw9YS5jb2xvcjtpZihiKWZvcihmIGluIGEpYVtmXSE9PWJbZl0mJihjW2ZdPWFbZl0sZT0hMCk7aWYoZSl7ZT10aGlzLnRleHRXaWR0aD1hJiZhLndpZHRoJiZkLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk9PT1cblwidGV4dFwiJiZHKGEud2lkdGgpfHx0aGlzLnRleHRXaWR0aDtiJiYoYT14KGIsYykpO3RoaXMuc3R5bGVzPWE7ZSYmKHFhfHwhamEmJnRoaXMucmVuZGVyZXIuZm9yRXhwb3J0KSYmZGVsZXRlIGEud2lkdGg7aWYoS2EmJiFqYSlGKHRoaXMuZWxlbWVudCxhKTtlbHNle2I9ZnVuY3Rpb24oYSxiKXtyZXR1cm5cIi1cIitiLnRvTG93ZXJDYXNlKCl9O2ZvcihmIGluIGEpZys9Zi5yZXBsYWNlKC8oW0EtWl0pL2csYikrXCI6XCIrYVtmXStcIjtcIjtYKGQsXCJzdHlsZVwiLGcpfWUmJnRoaXMuYWRkZWQmJnRoaXMucmVuZGVyZXIuYnVpbGRUZXh0KHRoaXMpfXJldHVybiB0aGlzfSxvbjpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMsZD1jLmVsZW1lbnQ7ZGImJmE9PT1cImNsaWNrXCI/KGQub250b3VjaHN0YXJ0PWZ1bmN0aW9uKGEpe2MudG91Y2hFdmVudEZpcmVkPWZhLm5vdygpO2EucHJldmVudERlZmF1bHQoKTtiLmNhbGwoZCxhKX0sZC5vbmNsaWNrPWZ1bmN0aW9uKGEpeyhNYS5pbmRleE9mKFwiQW5kcm9pZFwiKT09PVxuLTF8fGZhLm5vdygpLShjLnRvdWNoRXZlbnRGaXJlZHx8MCk+MTEwMCkmJmIuY2FsbChkLGEpfSk6ZFtcIm9uXCIrYV09YjtyZXR1cm4gdGhpc30sc2V0UmFkaWFsUmVmZXJlbmNlOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMucmVuZGVyZXIuZ3JhZGllbnRzW3RoaXMuZWxlbWVudC5ncmFkaWVudF07dGhpcy5lbGVtZW50LnJhZGlhbFJlZmVyZW5jZT1hO2ImJmIucmFkQXR0ciYmYi5hbmltYXRlKHRoaXMucmVuZGVyZXIuZ2V0UmFkaWFsQXR0cihhLGIucmFkQXR0cikpO3JldHVybiB0aGlzfSx0cmFuc2xhdGU6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5hdHRyKHt0cmFuc2xhdGVYOmEsdHJhbnNsYXRlWTpifSl9LGludmVydDpmdW5jdGlvbigpe3RoaXMuaW52ZXJ0ZWQ9ITA7dGhpcy51cGRhdGVUcmFuc2Zvcm0oKTtyZXR1cm4gdGhpc30sdXBkYXRlVHJhbnNmb3JtOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy50cmFuc2xhdGVYfHwwLGI9dGhpcy50cmFuc2xhdGVZfHwwLGM9dGhpcy5zY2FsZVgsXG5kPXRoaXMuc2NhbGVZLGU9dGhpcy5pbnZlcnRlZCxmPXRoaXMucm90YXRpb24sZz10aGlzLmVsZW1lbnQ7ZSYmKGErPXRoaXMuYXR0cihcIndpZHRoXCIpLGIrPXRoaXMuYXR0cihcImhlaWdodFwiKSk7YT1bXCJ0cmFuc2xhdGUoXCIrYStcIixcIitiK1wiKVwiXTtlP2EucHVzaChcInJvdGF0ZSg5MCkgc2NhbGUoLTEsMSlcIik6ZiYmYS5wdXNoKFwicm90YXRlKFwiK2YrXCIgXCIrKGcuZ2V0QXR0cmlidXRlKFwieFwiKXx8MCkrXCIgXCIrKGcuZ2V0QXR0cmlidXRlKFwieVwiKXx8MCkrXCIpXCIpOyhzKGMpfHxzKGQpKSYmYS5wdXNoKFwic2NhbGUoXCIrcShjLDEpK1wiIFwiK3EoZCwxKStcIilcIik7YS5sZW5ndGgmJmcuc2V0QXR0cmlidXRlKFwidHJhbnNmb3JtXCIsYS5qb2luKFwiIFwiKSl9LHRvRnJvbnQ6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmVsZW1lbnQ7YS5wYXJlbnROb2RlLmFwcGVuZENoaWxkKGEpO3JldHVybiB0aGlzfSxhbGlnbjpmdW5jdGlvbihhLGIsYyl7dmFyIGQsZSxmLGcsaD17fTtlPXRoaXMucmVuZGVyZXI7Zj1lLmFsaWduZWRPYmplY3RzO1xuaWYoYSl7aWYodGhpcy5hbGlnbk9wdGlvbnM9YSx0aGlzLmFsaWduQnlUcmFuc2xhdGU9YiwhY3x8RGEoYykpdGhpcy5hbGlnblRvPWQ9Y3x8XCJyZW5kZXJlclwiLEFhKGYsdGhpcyksZi5wdXNoKHRoaXMpLGM9bnVsbH1lbHNlIGE9dGhpcy5hbGlnbk9wdGlvbnMsYj10aGlzLmFsaWduQnlUcmFuc2xhdGUsZD10aGlzLmFsaWduVG87Yz1xKGMsZVtkXSxlKTtkPWEuYWxpZ247ZT1hLnZlcnRpY2FsQWxpZ247Zj0oYy54fHwwKSsoYS54fHwwKTtnPShjLnl8fDApKyhhLnl8fDApO2lmKGQ9PT1cInJpZ2h0XCJ8fGQ9PT1cImNlbnRlclwiKWYrPShjLndpZHRoLShhLndpZHRofHwwKSkve3JpZ2h0OjEsY2VudGVyOjJ9W2RdO2hbYj9cInRyYW5zbGF0ZVhcIjpcInhcIl09eShmKTtpZihlPT09XCJib3R0b21cInx8ZT09PVwibWlkZGxlXCIpZys9KGMuaGVpZ2h0LShhLmhlaWdodHx8MCkpLyh7Ym90dG9tOjEsbWlkZGxlOjJ9W2VdfHwxKTtoW2I/XCJ0cmFuc2xhdGVZXCI6XCJ5XCJdPXkoZyk7dGhpc1t0aGlzLnBsYWNlZD9cblwiYW5pbWF0ZVwiOlwiYXR0clwiXShoKTt0aGlzLnBsYWNlZD0hMDt0aGlzLmFsaWduQXR0cj1oO3JldHVybiB0aGlzfSxnZXRCQm94OmZ1bmN0aW9uKGEsYil7dmFyIGMsZD10aGlzLnJlbmRlcmVyLGUsZixnLGg9dGhpcy5lbGVtZW50LGk9dGhpcy5zdHlsZXM7ZT10aGlzLnRleHRTdHI7dmFyIGosaz1oLnN0eWxlLGwsbT1kLmNhY2hlLG89ZC5jYWNoZUtleXMscDtmPXEoYix0aGlzLnJvdGF0aW9uKTtnPWYqcGE7ZSE9PXQmJihwPVtcIlwiLGZ8fDAsaSYmaS5mb250U2l6ZSxoLnN0eWxlLndpZHRoXS5qb2luKFwiLFwiKSxwPWU9PT1cIlwifHwkYi50ZXN0KGUpP1wibnVtOlwiK2UudG9TdHJpbmcoKS5sZW5ndGgrcDplK3ApO3AmJiFhJiYoYz1tW3BdKTtpZighYyl7aWYoaC5uYW1lc3BhY2VVUkk9PT1RYXx8ZC5mb3JFeHBvcnQpe3RyeXtsPXRoaXMuZmFrZVRTJiZmdW5jdGlvbihhKXtuKGgucXVlcnlTZWxlY3RvckFsbChcIi5oaWdoY2hhcnRzLXRleHQtc2hhZG93XCIpLGZ1bmN0aW9uKGIpe2Iuc3R5bGUuZGlzcGxheT1cbmF9KX0sWGEmJmsudGV4dFNoYWRvdz8oaj1rLnRleHRTaGFkb3csay50ZXh0U2hhZG93PVwiXCIpOmwmJmwoXCJub25lXCIpLGM9aC5nZXRCQm94P3goe30saC5nZXRCQm94KCkpOnt3aWR0aDpoLm9mZnNldFdpZHRoLGhlaWdodDpoLm9mZnNldEhlaWdodH0saj9rLnRleHRTaGFkb3c9ajpsJiZsKFwiXCIpfWNhdGNoKHIpe31pZighY3x8Yy53aWR0aDwwKWM9e3dpZHRoOjAsaGVpZ2h0OjB9fWVsc2UgYz10aGlzLmh0bWxHZXRCQm94KCk7aWYoZC5pc1NWRyl7ZD1jLndpZHRoO2U9Yy5oZWlnaHQ7aWYoS2EmJmkmJmkuZm9udFNpemU9PT1cIjExcHhcIiYmZS50b1ByZWNpc2lvbigzKT09PVwiMTYuOVwiKWMuaGVpZ2h0PWU9MTQ7aWYoZiljLndpZHRoPVMoZSprYShnKSkrUyhkKmJhKGcpKSxjLmhlaWdodD1TKGUqYmEoZykpK1MoZCprYShnKSl9aWYocCl7Zm9yKDtvLmxlbmd0aD4yNTA7KWRlbGV0ZSBtW28uc2hpZnQoKV07bVtwXXx8by5wdXNoKHApO21bcF09Y319cmV0dXJuIGN9LHNob3c6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuYXR0cih7dmlzaWJpbGl0eTphP1xuXCJpbmhlcml0XCI6XCJ2aXNpYmxlXCJ9KX0saGlkZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmF0dHIoe3Zpc2liaWxpdHk6XCJoaWRkZW5cIn0pfSxmYWRlT3V0OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7Yi5hbmltYXRlKHtvcGFjaXR5OjB9LHtkdXJhdGlvbjphfHwxNTAsY29tcGxldGU6ZnVuY3Rpb24oKXtiLmF0dHIoe3k6LTk5OTl9KX19KX0sYWRkOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMucmVuZGVyZXIsYz10aGlzLmVsZW1lbnQsZDtpZihhKXRoaXMucGFyZW50R3JvdXA9YTt0aGlzLnBhcmVudEludmVydGVkPWEmJmEuaW52ZXJ0ZWQ7dGhpcy50ZXh0U3RyIT09dm9pZCAwJiZiLmJ1aWxkVGV4dCh0aGlzKTt0aGlzLmFkZGVkPSEwO2lmKCFhfHxhLmhhbmRsZVp8fHRoaXMuekluZGV4KWQ9dGhpcy56SW5kZXhTZXR0ZXIoKTtkfHwoYT9hLmVsZW1lbnQ6Yi5ib3gpLmFwcGVuZENoaWxkKGMpO2lmKHRoaXMub25BZGQpdGhpcy5vbkFkZCgpO3JldHVybiB0aGlzfSxzYWZlUmVtb3ZlQ2hpbGQ6ZnVuY3Rpb24oYSl7dmFyIGI9XG5hLnBhcmVudE5vZGU7YiYmYi5yZW1vdmVDaGlsZChhKX0sZGVzdHJveTpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLmVsZW1lbnR8fHt9LGM9YS5zaGFkb3dzLGQ9YS5yZW5kZXJlci5pc1NWRyYmYi5ub2RlTmFtZT09PVwiU1BBTlwiJiZhLnBhcmVudEdyb3VwLGUsZjtiLm9uY2xpY2s9Yi5vbm1vdXNlb3V0PWIub25tb3VzZW92ZXI9Yi5vbm1vdXNlbW92ZT1iLnBvaW50PW51bGw7VGEoYSk7aWYoYS5jbGlwUGF0aClhLmNsaXBQYXRoPWEuY2xpcFBhdGguZGVzdHJveSgpO2lmKGEuc3RvcHMpe2ZvcihmPTA7ZjxhLnN0b3BzLmxlbmd0aDtmKyspYS5zdG9wc1tmXT1hLnN0b3BzW2ZdLmRlc3Ryb3koKTthLnN0b3BzPW51bGx9YS5zYWZlUmVtb3ZlQ2hpbGQoYik7Zm9yKGMmJm4oYyxmdW5jdGlvbihiKXthLnNhZmVSZW1vdmVDaGlsZChiKX0pO2QmJmQuZGl2JiZkLmRpdi5jaGlsZE5vZGVzLmxlbmd0aD09PTA7KWI9ZC5wYXJlbnRHcm91cCxhLnNhZmVSZW1vdmVDaGlsZChkLmRpdiksZGVsZXRlIGQuZGl2LFxuZD1iO2EuYWxpZ25UbyYmQWEoYS5yZW5kZXJlci5hbGlnbmVkT2JqZWN0cyxhKTtmb3IoZSBpbiBhKWRlbGV0ZSBhW2VdO3JldHVybiBudWxsfSxzaGFkb3c6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPVtdLGUsZixnPXRoaXMuZWxlbWVudCxoLGksaixrO2lmKGEpe2k9cShhLndpZHRoLDMpO2o9KGEub3BhY2l0eXx8MC4xNSkvaTtrPXRoaXMucGFyZW50SW52ZXJ0ZWQ/XCIoLTEsLTEpXCI6XCIoXCIrcShhLm9mZnNldFgsMSkrXCIsIFwiK3EoYS5vZmZzZXRZLDEpK1wiKVwiO2ZvcihlPTE7ZTw9aTtlKyspe2Y9Zy5jbG9uZU5vZGUoMCk7aD1pKjIrMS0yKmU7WChmLHtpc1NoYWRvdzpcInRydWVcIixzdHJva2U6YS5jb2xvcnx8XCJibGFja1wiLFwic3Ryb2tlLW9wYWNpdHlcIjpqKmUsXCJzdHJva2Utd2lkdGhcIjpoLHRyYW5zZm9ybTpcInRyYW5zbGF0ZVwiK2ssZmlsbDpcIm5vbmVcIn0pO2lmKGMpWChmLFwiaGVpZ2h0XCIsdihYKGYsXCJoZWlnaHRcIiktaCwwKSksZi5jdXRIZWlnaHQ9aDtiP2IuZWxlbWVudC5hcHBlbmRDaGlsZChmKTpcbmcucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZixnKTtkLnB1c2goZil9dGhpcy5zaGFkb3dzPWR9cmV0dXJuIHRoaXN9LHhHZXR0ZXI6ZnVuY3Rpb24oYSl7dGhpcy5lbGVtZW50Lm5vZGVOYW1lPT09XCJjaXJjbGVcIiYmKGE9e3g6XCJjeFwiLHk6XCJjeVwifVthXXx8YSk7cmV0dXJuIHRoaXMuX2RlZmF1bHRHZXR0ZXIoYSl9LF9kZWZhdWx0R2V0dGVyOmZ1bmN0aW9uKGEpe2E9cSh0aGlzW2FdLHRoaXMuZWxlbWVudD90aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKGEpOm51bGwsMCk7L15bXFwtMC05XFwuXSskLy50ZXN0KGEpJiYoYT1wYXJzZUZsb2F0KGEpKTtyZXR1cm4gYX0sZFNldHRlcjpmdW5jdGlvbihhLGIsYyl7YSYmYS5qb2luJiYoYT1hLmpvaW4oXCIgXCIpKTsvKE5hTnwgezJ9fF4kKS8udGVzdChhKSYmKGE9XCJNIDAgMFwiKTtjLnNldEF0dHJpYnV0ZShiLGEpO3RoaXNbYl09YX0sZGFzaHN0eWxlU2V0dGVyOmZ1bmN0aW9uKGEpe3ZhciBiLGM9dGhpc1tcInN0cm9rZS13aWR0aFwiXTtjPT09XG5cImluaGVyaXRcIiYmKGM9MSk7aWYoYT1hJiZhLnRvTG93ZXJDYXNlKCkpe2E9YS5yZXBsYWNlKFwic2hvcnRkYXNoZG90ZG90XCIsXCIzLDEsMSwxLDEsMSxcIikucmVwbGFjZShcInNob3J0ZGFzaGRvdFwiLFwiMywxLDEsMVwiKS5yZXBsYWNlKFwic2hvcnRkb3RcIixcIjEsMSxcIikucmVwbGFjZShcInNob3J0ZGFzaFwiLFwiMywxLFwiKS5yZXBsYWNlKFwibG9uZ2Rhc2hcIixcIjgsMyxcIikucmVwbGFjZSgvZG90L2csXCIxLDMsXCIpLnJlcGxhY2UoXCJkYXNoXCIsXCI0LDMsXCIpLnJlcGxhY2UoLywkLyxcIlwiKS5zcGxpdChcIixcIik7Zm9yKGI9YS5sZW5ndGg7Yi0tOylhW2JdPUcoYVtiXSkqYzthPWEuam9pbihcIixcIikucmVwbGFjZSgvTmFOL2csXCJub25lXCIpO3RoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJzdHJva2UtZGFzaGFycmF5XCIsYSl9fSxhbGlnblNldHRlcjpmdW5jdGlvbihhKXt0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKFwidGV4dC1hbmNob3JcIix7bGVmdDpcInN0YXJ0XCIsY2VudGVyOlwibWlkZGxlXCIscmlnaHQ6XCJlbmRcIn1bYV0pfSxcbm9wYWNpdHlTZXR0ZXI6ZnVuY3Rpb24oYSxiLGMpe3RoaXNbYl09YTtjLnNldEF0dHJpYnV0ZShiLGEpfSx0aXRsZVNldHRlcjpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmVsZW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJ0aXRsZVwiKVswXTtifHwoYj1CLmNyZWF0ZUVsZW1lbnROUyhRYSxcInRpdGxlXCIpLHRoaXMuZWxlbWVudC5hcHBlbmRDaGlsZChiKSk7Yi5hcHBlbmRDaGlsZChCLmNyZWF0ZVRleHROb2RlKFN0cmluZyhxKGEpLFwiXCIpLnJlcGxhY2UoLzxbXj5dKj4vZyxcIlwiKSkpfSx0ZXh0U2V0dGVyOmZ1bmN0aW9uKGEpe2lmKGEhPT10aGlzLnRleHRTdHIpZGVsZXRlIHRoaXMuYkJveCx0aGlzLnRleHRTdHI9YSx0aGlzLmFkZGVkJiZ0aGlzLnJlbmRlcmVyLmJ1aWxkVGV4dCh0aGlzKX0sZmlsbFNldHRlcjpmdW5jdGlvbihhLGIsYyl7dHlwZW9mIGE9PT1cInN0cmluZ1wiP2Muc2V0QXR0cmlidXRlKGIsYSk6YSYmdGhpcy5jb2xvckdyYWRpZW50KGEsYixjKX0sdmlzaWJpbGl0eVNldHRlcjpmdW5jdGlvbihhLFxuYixjKXthPT09XCJpbmhlcml0XCI/Yy5yZW1vdmVBdHRyaWJ1dGUoYik6Yy5zZXRBdHRyaWJ1dGUoYixhKX0sekluZGV4U2V0dGVyOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5yZW5kZXJlcixkPXRoaXMucGFyZW50R3JvdXAsYz0oZHx8YykuZWxlbWVudHx8Yy5ib3gsZSxmLGc9dGhpcy5lbGVtZW50LGg7ZT10aGlzLmFkZGVkO3ZhciBpO2lmKHMoYSkpZy56SW5kZXg9YSxhPSthLHRoaXNbYl09PT1hJiYoZT0hMSksdGhpc1tiXT1hO2lmKGUpe2lmKChhPXRoaXMuekluZGV4KSYmZClkLmhhbmRsZVo9ITA7ZD1jLmNoaWxkTm9kZXM7Zm9yKGk9MDtpPGQubGVuZ3RoJiYhaDtpKyspaWYoZT1kW2ldLGY9ZS56SW5kZXgsZSE9PWcmJihHKGYpPmF8fCFzKGEpJiZzKGYpKSljLmluc2VydEJlZm9yZShnLGUpLGg9ITA7aHx8Yy5hcHBlbmRDaGlsZChnKX1yZXR1cm4gaH0sX2RlZmF1bHRTZXR0ZXI6ZnVuY3Rpb24oYSxiLGMpe2Muc2V0QXR0cmlidXRlKGIsYSl9fTtaLnByb3RvdHlwZS55R2V0dGVyPVxuWi5wcm90b3R5cGUueEdldHRlcjtaLnByb3RvdHlwZS50cmFuc2xhdGVYU2V0dGVyPVoucHJvdG90eXBlLnRyYW5zbGF0ZVlTZXR0ZXI9Wi5wcm90b3R5cGUucm90YXRpb25TZXR0ZXI9Wi5wcm90b3R5cGUudmVydGljYWxBbGlnblNldHRlcj1aLnByb3RvdHlwZS5zY2FsZVhTZXR0ZXI9Wi5wcm90b3R5cGUuc2NhbGVZU2V0dGVyPWZ1bmN0aW9uKGEsYil7dGhpc1tiXT1hO3RoaXMuZG9UcmFuc2Zvcm09ITB9O1oucHJvdG90eXBlW1wic3Ryb2tlLXdpZHRoU2V0dGVyXCJdPVoucHJvdG90eXBlLnN0cm9rZVNldHRlcj1mdW5jdGlvbihhLGIsYyl7dGhpc1tiXT1hO2lmKHRoaXMuc3Ryb2tlJiZ0aGlzW1wic3Ryb2tlLXdpZHRoXCJdKXRoaXMuc3Ryb2tlV2lkdGg9dGhpc1tcInN0cm9rZS13aWR0aFwiXSxaLnByb3RvdHlwZS5maWxsU2V0dGVyLmNhbGwodGhpcyx0aGlzLnN0cm9rZSxcInN0cm9rZVwiLGMpLGMuc2V0QXR0cmlidXRlKFwic3Ryb2tlLXdpZHRoXCIsdGhpc1tcInN0cm9rZS13aWR0aFwiXSksXG50aGlzLmhhc1N0cm9rZT0hMDtlbHNlIGlmKGI9PT1cInN0cm9rZS13aWR0aFwiJiZhPT09MCYmdGhpcy5oYXNTdHJva2UpYy5yZW1vdmVBdHRyaWJ1dGUoXCJzdHJva2VcIiksdGhpcy5oYXNTdHJva2U9ITF9O3ZhciB5YT1mdW5jdGlvbigpe3RoaXMuaW5pdC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9O3lhLnByb3RvdHlwZT17RWxlbWVudDpaLGluaXQ6ZnVuY3Rpb24oYSxiLGMsZCxlLGYpe3ZhciBnLGQ9dGhpcy5jcmVhdGVFbGVtZW50KFwic3ZnXCIpLmF0dHIoe3ZlcnNpb246XCIxLjFcIn0pLmNzcyh0aGlzLmdldFN0eWxlKGQpKTtnPWQuZWxlbWVudDthLmFwcGVuZENoaWxkKGcpO2EuaW5uZXJIVE1MLmluZGV4T2YoXCJ4bWxuc1wiKT09PS0xJiZYKGcsXCJ4bWxuc1wiLFFhKTt0aGlzLmlzU1ZHPSEwO3RoaXMuYm94PWc7dGhpcy5ib3hXcmFwcGVyPWQ7dGhpcy5hbGlnbmVkT2JqZWN0cz1bXTt0aGlzLnVybD0oWGF8fHRiKSYmQi5nZXRFbGVtZW50c0J5VGFnTmFtZShcImJhc2VcIikubGVuZ3RoP0oubG9jYXRpb24uaHJlZi5yZXBsYWNlKC8jLio/JC8sXG5cIlwiKS5yZXBsYWNlKC8oW1xcKCdcXCldKS9nLFwiXFxcXCQxXCIpLnJlcGxhY2UoLyAvZyxcIiUyMFwiKTpcIlwiO3RoaXMuY3JlYXRlRWxlbWVudChcImRlc2NcIikuYWRkKCkuZWxlbWVudC5hcHBlbmRDaGlsZChCLmNyZWF0ZVRleHROb2RlKFwiQ3JlYXRlZCB3aXRoIEhpZ2hzdG9jayA0LjIuNFwiKSk7dGhpcy5kZWZzPXRoaXMuY3JlYXRlRWxlbWVudChcImRlZnNcIikuYWRkKCk7dGhpcy5hbGxvd0hUTUw9Zjt0aGlzLmZvckV4cG9ydD1lO3RoaXMuZ3JhZGllbnRzPXt9O3RoaXMuY2FjaGU9e307dGhpcy5jYWNoZUtleXM9W107dGhpcy5pbWdDb3VudD0wO3RoaXMuc2V0U2l6ZShiLGMsITEpO3ZhciBoO2lmKFhhJiZhLmdldEJvdW5kaW5nQ2xpZW50UmVjdCl0aGlzLnN1YlBpeGVsRml4PWI9ZnVuY3Rpb24oKXtGKGEse2xlZnQ6MCx0b3A6MH0pO2g9YS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtGKGEse2xlZnQ6RmEoaC5sZWZ0KS1oLmxlZnQrXCJweFwiLHRvcDpGYShoLnRvcCktaC50b3ArXCJweFwifSl9LGIoKSxcbkQoSixcInJlc2l6ZVwiLGIpfSxnZXRTdHlsZTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5zdHlsZT14KHtmb250RmFtaWx5OidcIkx1Y2lkYSBHcmFuZGVcIiwgXCJMdWNpZGEgU2FucyBVbmljb2RlXCIsIEFyaWFsLCBIZWx2ZXRpY2EsIHNhbnMtc2VyaWYnLGZvbnRTaXplOlwiMTJweFwifSxhKX0saXNIaWRkZW46ZnVuY3Rpb24oKXtyZXR1cm4hdGhpcy5ib3hXcmFwcGVyLmdldEJCb3goKS53aWR0aH0sZGVzdHJveTpmdW5jdGlvbigpe3ZhciBhPXRoaXMuZGVmczt0aGlzLmJveD1udWxsO3RoaXMuYm94V3JhcHBlcj10aGlzLmJveFdyYXBwZXIuZGVzdHJveSgpO1BhKHRoaXMuZ3JhZGllbnRzfHx7fSk7dGhpcy5ncmFkaWVudHM9bnVsbDtpZihhKXRoaXMuZGVmcz1hLmRlc3Ryb3koKTt0aGlzLnN1YlBpeGVsRml4JiZUKEosXCJyZXNpemVcIix0aGlzLnN1YlBpeGVsRml4KTtyZXR1cm4gdGhpcy5hbGlnbmVkT2JqZWN0cz1udWxsfSxjcmVhdGVFbGVtZW50OmZ1bmN0aW9uKGEpe3ZhciBiPW5ldyB0aGlzLkVsZW1lbnQ7XG5iLmluaXQodGhpcyxhKTtyZXR1cm4gYn0sZHJhdzpmdW5jdGlvbigpe30sZ2V0UmFkaWFsQXR0cjpmdW5jdGlvbihhLGIpe3JldHVybntjeDphWzBdLWFbMl0vMitiLmN4KmFbMl0sY3k6YVsxXS1hWzJdLzIrYi5jeSphWzJdLHI6Yi5yKmFbMl19fSxidWlsZFRleHQ6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPWEuZWxlbWVudCxjPXRoaXMsZD1jLmZvckV4cG9ydCxlPXEoYS50ZXh0U3RyLFwiXCIpLnRvU3RyaW5nKCksZj1lLmluZGV4T2YoXCI8XCIpIT09LTEsZz1iLmNoaWxkTm9kZXMsaCxpLGo9WChiLFwieFwiKSxrPWEuc3R5bGVzLGw9YS50ZXh0V2lkdGgsbT1rJiZrLmxpbmVIZWlnaHQsbz1rJiZrLnRleHRTaGFkb3cscD1rJiZrLnRleHRPdmVyZmxvdz09PVwiZWxsaXBzaXNcIixyPWcubGVuZ3RoLEE9bCYmIWEuYWRkZWQmJnRoaXMuYm94LFA9ZnVuY3Rpb24oYSl7cmV0dXJuIG0/RyhtKTpjLmZvbnRNZXRyaWNzKC8ocHh8ZW0pJC8udGVzdChhJiZhLnN0eWxlLmZvbnRTaXplKT9hLnN0eWxlLmZvbnRTaXplOlxuayYmay5mb250U2l6ZXx8Yy5zdHlsZS5mb250U2l6ZXx8MTIsYSkuaH0sdT1mdW5jdGlvbihhKXtyZXR1cm4gYS5yZXBsYWNlKC8mbHQ7L2csXCI8XCIpLnJlcGxhY2UoLyZndDsvZyxcIj5cIil9O3ItLTspYi5yZW1vdmVDaGlsZChnW3JdKTshZiYmIW8mJiFwJiZlLmluZGV4T2YoXCIgXCIpPT09LTE/Yi5hcHBlbmRDaGlsZChCLmNyZWF0ZVRleHROb2RlKHUoZSkpKTooaD0vPC4qc3R5bGU9XCIoW15cIl0rKVwiLio+LyxpPS88LipocmVmPVwiKGh0dHBbXlwiXSspXCIuKj4vLEEmJkEuYXBwZW5kQ2hpbGQoYiksZT1mP2UucmVwbGFjZSgvPChifHN0cm9uZyk+L2csJzxzcGFuIHN0eWxlPVwiZm9udC13ZWlnaHQ6Ym9sZFwiPicpLnJlcGxhY2UoLzwoaXxlbSk+L2csJzxzcGFuIHN0eWxlPVwiZm9udC1zdHlsZTppdGFsaWNcIj4nKS5yZXBsYWNlKC88YS9nLFwiPHNwYW5cIikucmVwbGFjZSgvPFxcLyhifHN0cm9uZ3xpfGVtfGEpPi9nLFwiPC9zcGFuPlwiKS5zcGxpdCgvPGJyLio/Pi9nKTpbZV0sZVtlLmxlbmd0aC0xXT09PVxuXCJcIiYmZS5wb3AoKSxuKGUsZnVuY3Rpb24oZSxmKXt2YXIgZyxtPTAsZT1lLnJlcGxhY2UoLzxzcGFuL2csXCJ8fHw8c3BhblwiKS5yZXBsYWNlKC88XFwvc3Bhbj4vZyxcIjwvc3Bhbj58fHxcIik7Zz1lLnNwbGl0KFwifHx8XCIpO24oZyxmdW5jdGlvbihlKXtpZihlIT09XCJcInx8Zy5sZW5ndGg9PT0xKXt2YXIgbz17fSxyPUIuY3JlYXRlRWxlbWVudE5TKFFhLFwidHNwYW5cIiksQTtoLnRlc3QoZSkmJihBPWUubWF0Y2goaClbMV0ucmVwbGFjZSgvKDt8IHxeKWNvbG9yKFsgOl0pLyxcIiQxZmlsbCQyXCIpLFgocixcInN0eWxlXCIsQSkpO2kudGVzdChlKSYmIWQmJihYKHIsXCJvbmNsaWNrXCIsJ2xvY2F0aW9uLmhyZWY9XCInK2UubWF0Y2goaSlbMV0rJ1wiJyksRihyLHtjdXJzb3I6XCJwb2ludGVyXCJ9KSk7ZT11KGUucmVwbGFjZSgvPCgufFxcbikqPz4vZyxcIlwiKXx8XCIgXCIpO2lmKGUhPT1cIiBcIil7ci5hcHBlbmRDaGlsZChCLmNyZWF0ZVRleHROb2RlKGUpKTtpZihtKW8uZHg9MDtlbHNlIGlmKGYmJmohPT1udWxsKW8ueD1cbmo7WChyLG8pO2IuYXBwZW5kQ2hpbGQocik7IW0mJmYmJighamEmJmQmJkYocix7ZGlzcGxheTpcImJsb2NrXCJ9KSxYKHIsXCJkeVwiLFAocikpKTtpZihsKXtmb3IodmFyIG89ZS5yZXBsYWNlKC8oW15cXF5dKS0vZyxcIiQxLSBcIikuc3BsaXQoXCIgXCIpLHE9Zy5sZW5ndGg+MXx8Znx8by5sZW5ndGg+MSYmay53aGl0ZVNwYWNlIT09XCJub3dyYXBcIix3LG4scyx0PVtdLHY9UChyKSx5PTEseD1hLnJvdGF0aW9uLEM9ZSx6PUMubGVuZ3RoOyhxfHxwKSYmKG8ubGVuZ3RofHx0Lmxlbmd0aCk7KWEucm90YXRpb249MCx3PWEuZ2V0QkJveCghMCkscz13LndpZHRoLCFqYSYmYy5mb3JFeHBvcnQmJihzPWMubWVhc3VyZVNwYW5XaWR0aChyLmZpcnN0Q2hpbGQuZGF0YSxhLnN0eWxlcykpLHc9cz5sLG49PT12b2lkIDAmJihuPXcpLHAmJm4/KHovPTIsQz09PVwiXCJ8fCF3JiZ6PDAuNT9vPVtdOih3JiYobj0hMCksQz1lLnN1YnN0cmluZygwLEMubGVuZ3RoKyh3Py0xOjEpKkZhKHopKSxvPVtDKyhsPjM/XCJcXHUyMDI2XCI6XG5cIlwiKV0sci5yZW1vdmVDaGlsZChyLmZpcnN0Q2hpbGQpKSk6IXd8fG8ubGVuZ3RoPT09MT8obz10LHQ9W10sby5sZW5ndGgmJih5Kysscj1CLmNyZWF0ZUVsZW1lbnROUyhRYSxcInRzcGFuXCIpLFgocix7ZHk6dix4Omp9KSxBJiZYKHIsXCJzdHlsZVwiLEEpLGIuYXBwZW5kQ2hpbGQocikpLHM+bCYmKGw9cykpOihyLnJlbW92ZUNoaWxkKHIuZmlyc3RDaGlsZCksdC51bnNoaWZ0KG8ucG9wKCkpKSxvLmxlbmd0aCYmci5hcHBlbmRDaGlsZChCLmNyZWF0ZVRleHROb2RlKG8uam9pbihcIiBcIikucmVwbGFjZSgvLSAvZyxcIi1cIikpKTtuJiZhLmF0dHIoXCJ0aXRsZVwiLGEudGV4dFN0cik7YS5yb3RhdGlvbj14fW0rK319fSl9KSxBJiZBLnJlbW92ZUNoaWxkKGIpLG8mJmEuYXBwbHlUZXh0U2hhZG93JiZhLmFwcGx5VGV4dFNoYWRvdyhvKSl9LGdldENvbnRyYXN0OmZ1bmN0aW9uKGEpe2E9d2EoYSkucmdiYTtyZXR1cm4gYVswXSthWzFdK2FbMl0+Mzg0P1wiIzAwMDAwMFwiOlwiI0ZGRkZGRlwifSxidXR0b246ZnVuY3Rpb24oYSxcbmIsYyxkLGUsZixnLGgsaSl7dmFyIGo9dGhpcy5sYWJlbChhLGIsYyxpLG51bGwsbnVsbCxudWxsLG51bGwsXCJidXR0b25cIiksaz0wLGwsbSxvLHAscixBLGE9e3gxOjAseTE6MCx4MjowLHkyOjF9LGU9Qyh7XCJzdHJva2Utd2lkdGhcIjoxLHN0cm9rZTpcIiNDQ0NDQ0NcIixmaWxsOntsaW5lYXJHcmFkaWVudDphLHN0b3BzOltbMCxcIiNGRUZFRkVcIl0sWzEsXCIjRjZGNkY2XCJdXX0scjoyLHBhZGRpbmc6NSxzdHlsZTp7Y29sb3I6XCJibGFja1wifX0sZSk7bz1lLnN0eWxlO2RlbGV0ZSBlLnN0eWxlO2Y9QyhlLHtzdHJva2U6XCIjNjhBXCIsZmlsbDp7bGluZWFyR3JhZGllbnQ6YSxzdG9wczpbWzAsXCIjRkZGXCJdLFsxLFwiI0FDRlwiXV19fSxmKTtwPWYuc3R5bGU7ZGVsZXRlIGYuc3R5bGU7Zz1DKGUse3N0cm9rZTpcIiM2OEFcIixmaWxsOntsaW5lYXJHcmFkaWVudDphLHN0b3BzOltbMCxcIiM5QkRcIl0sWzEsXCIjQ0RGXCJdXX19LGcpO3I9Zy5zdHlsZTtkZWxldGUgZy5zdHlsZTtoPUMoZSx7c3R5bGU6e2NvbG9yOlwiI0NDQ1wifX0sXG5oKTtBPWguc3R5bGU7ZGVsZXRlIGguc3R5bGU7RChqLmVsZW1lbnQsS2E/XCJtb3VzZW92ZXJcIjpcIm1vdXNlZW50ZXJcIixmdW5jdGlvbigpe2shPT0zJiZqLmF0dHIoZikuY3NzKHApfSk7RChqLmVsZW1lbnQsS2E/XCJtb3VzZW91dFwiOlwibW91c2VsZWF2ZVwiLGZ1bmN0aW9uKCl7ayE9PTMmJihsPVtlLGYsZ11ba10sbT1bbyxwLHJdW2tdLGouYXR0cihsKS5jc3MobSkpfSk7ai5zZXRTdGF0ZT1mdW5jdGlvbihhKXsoai5zdGF0ZT1rPWEpP2E9PT0yP2ouYXR0cihnKS5jc3Mocik6YT09PTMmJmouYXR0cihoKS5jc3MoQSk6ai5hdHRyKGUpLmNzcyhvKX07cmV0dXJuIGoub24oXCJjbGlja1wiLGZ1bmN0aW9uKGEpe2shPT0zJiZkLmNhbGwoaixhKX0pLmF0dHIoZSkuY3NzKHgoe2N1cnNvcjpcImRlZmF1bHRcIn0sbykpfSxjcmlzcExpbmU6ZnVuY3Rpb24oYSxiKXthWzFdPT09YVs0XSYmKGFbMV09YVs0XT15KGFbMV0pLWIlMi8yKTthWzJdPT09YVs1XSYmKGFbMl09YVs1XT15KGFbMl0pK2IlMi9cbjIpO3JldHVybiBhfSxwYXRoOmZ1bmN0aW9uKGEpe3ZhciBiPXtmaWxsOlwibm9uZVwifTtKYShhKT9iLmQ9YTpkYShhKSYmeChiLGEpO3JldHVybiB0aGlzLmNyZWF0ZUVsZW1lbnQoXCJwYXRoXCIpLmF0dHIoYil9LGNpcmNsZTpmdW5jdGlvbihhLGIsYyl7YT1kYShhKT9hOnt4OmEseTpiLHI6Y307Yj10aGlzLmNyZWF0ZUVsZW1lbnQoXCJjaXJjbGVcIik7Yi54U2V0dGVyPWIueVNldHRlcj1mdW5jdGlvbihhLGIsYyl7Yy5zZXRBdHRyaWJ1dGUoXCJjXCIrYixhKX07cmV0dXJuIGIuYXR0cihhKX0sYXJjOmZ1bmN0aW9uKGEsYixjLGQsZSxmKXtpZihkYShhKSliPWEueSxjPWEucixkPWEuaW5uZXJSLGU9YS5zdGFydCxmPWEuZW5kLGE9YS54O2E9dGhpcy5zeW1ib2woXCJhcmNcIixhfHwwLGJ8fDAsY3x8MCxjfHwwLHtpbm5lclI6ZHx8MCxzdGFydDplfHwwLGVuZDpmfHwwfSk7YS5yPWM7cmV0dXJuIGF9LHJlY3Q6ZnVuY3Rpb24oYSxiLGMsZCxlLGYpe3ZhciBlPWRhKGEpP2EucjplLGc9dGhpcy5jcmVhdGVFbGVtZW50KFwicmVjdFwiKSxcbmE9ZGEoYSk/YTphPT09dD97fTp7eDphLHk6Yix3aWR0aDp2KGMsMCksaGVpZ2h0OnYoZCwwKX07aWYoZiE9PXQpZy5zdHJva2VXaWR0aD1mLGE9Zy5jcmlzcChhKTtpZihlKWEucj1lO2cuclNldHRlcj1mdW5jdGlvbihhLGIsYyl7WChjLHtyeDphLHJ5OmF9KX07cmV0dXJuIGcuYXR0cihhKX0sc2V0U2l6ZTpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9dGhpcy5hbGlnbmVkT2JqZWN0cyxlPWQubGVuZ3RoO3RoaXMud2lkdGg9YTt0aGlzLmhlaWdodD1iO2Zvcih0aGlzLmJveFdyYXBwZXJbcShjLCEwKT9cImFuaW1hdGVcIjpcImF0dHJcIl0oe3dpZHRoOmEsaGVpZ2h0OmJ9KTtlLS07KWRbZV0uYWxpZ24oKX0sZzpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnQoXCJnXCIpO3JldHVybiBzKGEpP2IuYXR0cih7XCJjbGFzc1wiOlwiaGlnaGNoYXJ0cy1cIithfSk6Yn0saW1hZ2U6ZnVuY3Rpb24oYSxiLGMsZCxlKXt2YXIgZj17cHJlc2VydmVBc3BlY3RSYXRpbzpcIm5vbmVcIn07YXJndW1lbnRzLmxlbmd0aD5cbjEmJngoZix7eDpiLHk6Yyx3aWR0aDpkLGhlaWdodDplfSk7Zj10aGlzLmNyZWF0ZUVsZW1lbnQoXCJpbWFnZVwiKS5hdHRyKGYpO2YuZWxlbWVudC5zZXRBdHRyaWJ1dGVOUz9mLmVsZW1lbnQuc2V0QXR0cmlidXRlTlMoXCJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rXCIsXCJocmVmXCIsYSk6Zi5lbGVtZW50LnNldEF0dHJpYnV0ZShcImhjLXN2Zy1ocmVmXCIsYSk7cmV0dXJuIGZ9LHN5bWJvbDpmdW5jdGlvbihhLGIsYyxkLGUsZil7dmFyIGc9dGhpcyxoLGk9dGhpcy5zeW1ib2xzW2FdLGk9aSYmaSh5KGIpLHkoYyksZCxlLGYpLGo9L151cmxcXCgoLio/KVxcKSQvLGssbDtpZihpKWg9dGhpcy5wYXRoKGkpLHgoaCx7c3ltYm9sTmFtZTphLHg6Yix5OmMsd2lkdGg6ZCxoZWlnaHQ6ZX0pLGYmJngoaCxmKTtlbHNlIGlmKGoudGVzdChhKSlsPWZ1bmN0aW9uKGEsYil7YS5lbGVtZW50JiYoYS5hdHRyKHt3aWR0aDpiWzBdLGhlaWdodDpiWzFdfSksYS5hbGlnbkJ5VHJhbnNsYXRlfHxhLnRyYW5zbGF0ZSh5KChkLVxuYlswXSkvMikseSgoZS1iWzFdKS8yKSkpfSxrPWEubWF0Y2goailbMV0sYT1WYltrXXx8ZiYmZi53aWR0aCYmZi5oZWlnaHQmJltmLndpZHRoLGYuaGVpZ2h0XSxoPXRoaXMuaW1hZ2UoaykuYXR0cih7eDpiLHk6Y30pLGguaXNJbWc9ITAsYT9sKGgsYSk6KGguYXR0cih7d2lkdGg6MCxoZWlnaHQ6MH0pLGVhKFwiaW1nXCIse29ubG9hZDpmdW5jdGlvbigpe3RoaXMud2lkdGg9PT0wJiYoRih0aGlzLHtwb3NpdGlvbjpcImFic29sdXRlXCIsdG9wOlwiLTk5OWVtXCJ9KSxCLmJvZHkuYXBwZW5kQ2hpbGQodGhpcykpO2woaCxWYltrXT1bdGhpcy53aWR0aCx0aGlzLmhlaWdodF0pO3RoaXMucGFyZW50Tm9kZSYmdGhpcy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMpO2cuaW1nQ291bnQtLTtpZighZy5pbWdDb3VudCYmJFtnLmNoYXJ0SW5kZXhdLm9ubG9hZCkkW2cuY2hhcnRJbmRleF0ub25sb2FkKCl9LHNyYzprfSksdGhpcy5pbWdDb3VudCsrKTtyZXR1cm4gaH0sc3ltYm9sczp7Y2lyY2xlOmZ1bmN0aW9uKGEsXG5iLGMsZCl7dmFyIGU9MC4xNjYqYztyZXR1cm5bXCJNXCIsYStjLzIsYixcIkNcIixhK2MrZSxiLGErYytlLGIrZCxhK2MvMixiK2QsXCJDXCIsYS1lLGIrZCxhLWUsYixhK2MvMixiLFwiWlwiXX0sc3F1YXJlOmZ1bmN0aW9uKGEsYixjLGQpe3JldHVybltcIk1cIixhLGIsXCJMXCIsYStjLGIsYStjLGIrZCxhLGIrZCxcIlpcIl19LHRyaWFuZ2xlOmZ1bmN0aW9uKGEsYixjLGQpe3JldHVybltcIk1cIixhK2MvMixiLFwiTFwiLGErYyxiK2QsYSxiK2QsXCJaXCJdfSxcInRyaWFuZ2xlLWRvd25cIjpmdW5jdGlvbihhLGIsYyxkKXtyZXR1cm5bXCJNXCIsYSxiLFwiTFwiLGErYyxiLGErYy8yLGIrZCxcIlpcIl19LGRpYW1vbmQ6ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuW1wiTVwiLGErYy8yLGIsXCJMXCIsYStjLGIrZC8yLGErYy8yLGIrZCxhLGIrZC8yLFwiWlwiXX0sYXJjOmZ1bmN0aW9uKGEsYixjLGQsZSl7dmFyIGY9ZS5zdGFydCxjPWUucnx8Y3x8ZCxnPWUuZW5kLTAuMDAxLGQ9ZS5pbm5lclIsaD1lLm9wZW4saT1iYShmKSxqPWthKGYpLFxuaz1iYShnKSxnPWthKGcpLGU9ZS5lbmQtZjxCYT8wOjE7cmV0dXJuW1wiTVwiLGErYyppLGIrYypqLFwiQVwiLGMsYywwLGUsMSxhK2MqayxiK2MqZyxoP1wiTVwiOlwiTFwiLGErZCprLGIrZCpnLFwiQVwiLGQsZCwwLGUsMCxhK2QqaSxiK2QqaixoP1wiXCI6XCJaXCJdfSxjYWxsb3V0OmZ1bmN0aW9uKGEsYixjLGQsZSl7dmFyIGY9RShlJiZlLnJ8fDAsYyxkKSxnPWYrNixoPWUmJmUuYW5jaG9yWCxlPWUmJmUuYW5jaG9yWSxpO2k9W1wiTVwiLGErZixiLFwiTFwiLGErYy1mLGIsXCJDXCIsYStjLGIsYStjLGIsYStjLGIrZixcIkxcIixhK2MsYitkLWYsXCJDXCIsYStjLGIrZCxhK2MsYitkLGErYy1mLGIrZCxcIkxcIixhK2YsYitkLFwiQ1wiLGEsYitkLGEsYitkLGEsYitkLWYsXCJMXCIsYSxiK2YsXCJDXCIsYSxiLGEsYixhK2YsYl07aCYmaD5jJiZlPmIrZyYmZTxiK2QtZz9pLnNwbGljZSgxMywzLFwiTFwiLGErYyxlLTYsYStjKzYsZSxhK2MsZSs2LGErYyxiK2QtZik6aCYmaDwwJiZlPmIrZyYmZTxiK2QtZz9pLnNwbGljZSgzMywzLFxuXCJMXCIsYSxlKzYsYS02LGUsYSxlLTYsYSxiK2YpOmUmJmU+ZCYmaD5hK2cmJmg8YStjLWc/aS5zcGxpY2UoMjMsMyxcIkxcIixoKzYsYitkLGgsYitkKzYsaC02LGIrZCxhK2YsYitkKTplJiZlPDAmJmg+YStnJiZoPGErYy1nJiZpLnNwbGljZSgzLDMsXCJMXCIsaC02LGIsaCxiLTYsaCs2LGIsYy1mLGIpO3JldHVybiBpfX0sY2xpcFJlY3Q6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9XCJoaWdoY2hhcnRzLVwiK0piKyssZj10aGlzLmNyZWF0ZUVsZW1lbnQoXCJjbGlwUGF0aFwiKS5hdHRyKHtpZDplfSkuYWRkKHRoaXMuZGVmcyksYT10aGlzLnJlY3QoYSxiLGMsZCwwKS5hZGQoZik7YS5pZD1lO2EuY2xpcFBhdGg9ZjthLmNvdW50PTA7cmV0dXJuIGF9LHRleHQ6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9cWF8fCFqYSYmdGhpcy5mb3JFeHBvcnQsZj17fTtpZihkJiYodGhpcy5hbGxvd0hUTUx8fCF0aGlzLmZvckV4cG9ydCkpcmV0dXJuIHRoaXMuaHRtbChhLGIsYyk7Zi54PU1hdGgucm91bmQoYnx8XG4wKTtpZihjKWYueT1NYXRoLnJvdW5kKGMpO2lmKGF8fGE9PT0wKWYudGV4dD1hO2E9dGhpcy5jcmVhdGVFbGVtZW50KFwidGV4dFwiKS5hdHRyKGYpO2UmJmEuY3NzKHtwb3NpdGlvbjpcImFic29sdXRlXCJ9KTtpZighZClhLnhTZXR0ZXI9ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPWMuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJ0c3BhblwiKSxlLGY9Yy5nZXRBdHRyaWJ1dGUoYiksbTtmb3IobT0wO208ZC5sZW5ndGg7bSsrKWU9ZFttXSxlLmdldEF0dHJpYnV0ZShiKT09PWYmJmUuc2V0QXR0cmlidXRlKGIsYSk7Yy5zZXRBdHRyaWJ1dGUoYixhKX07cmV0dXJuIGF9LGZvbnRNZXRyaWNzOmZ1bmN0aW9uKGEsYil7dmFyIGMsZCxhPWF8fHRoaXMuc3R5bGUuZm9udFNpemU7IWEmJmImJkouZ2V0Q29tcHV0ZWRTdHlsZSYmKGI9Yi5lbGVtZW50fHxiLGE9KGM9Si5nZXRDb21wdXRlZFN0eWxlKGIsXCJcIikpJiZjLmZvbnRTaXplKTthPS9weC8udGVzdChhKT9HKGEpOi9lbS8udGVzdChhKT9wYXJzZUZsb2F0KGEpKlxuMTI6MTI7Yz1hPDI0P2ErMzp5KGEqMS4yKTtkPXkoYyowLjgpO3JldHVybntoOmMsYjpkLGY6YX19LHJvdENvcnI6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPWE7YiYmYyYmKGQ9dihkKmJhKGIqcGEpLDQpKTtyZXR1cm57eDotYS8zKmthKGIqcGEpLHk6ZH19LGxhYmVsOmZ1bmN0aW9uKGEsYixjLGQsZSxmLGcsaCxpKXt2YXIgaj10aGlzLGs9ai5nKGkpLGw9ai50ZXh0KFwiXCIsMCwwLGcpLmF0dHIoe3pJbmRleDoxfSksbSxvLHA9MCxyPTMsQT0wLHEsdSx3LE8sUj0wLGhhPXt9LHYseixMLEUsQjtMPWZ1bmN0aW9uKCl7dmFyIGEsYjthPWwuZWxlbWVudC5zdHlsZTtvPShxPT09dm9pZCAwfHx1PT09dm9pZCAwfHxrLnN0eWxlcy50ZXh0QWxpZ24pJiZzKGwudGV4dFN0cikmJmwuZ2V0QkJveCgpO2sud2lkdGg9KHF8fG8ud2lkdGh8fDApKzIqcitBO2suaGVpZ2h0PSh1fHxvLmhlaWdodHx8MCkrMipyO3Y9citqLmZvbnRNZXRyaWNzKGEmJmEuZm9udFNpemUsbCkuYjtpZih6KXtpZighbSlhPVxuUixiPShoPy12OjApK1Isay5ib3g9bT1kP2ouc3ltYm9sKGQsYSxiLGsud2lkdGgsay5oZWlnaHQsaGEpOmoucmVjdChhLGIsay53aWR0aCxrLmhlaWdodCwwLGhhW1wic3Ryb2tlLXdpZHRoXCJdKSxtLmlzSW1nfHxtLmF0dHIoXCJmaWxsXCIsXCJub25lXCIpLG0uYWRkKGspO20uaXNJbWd8fG0uYXR0cih4KHt3aWR0aDp5KGsud2lkdGgpLGhlaWdodDp5KGsuaGVpZ2h0KX0saGEpKTtoYT1udWxsfX07RT1mdW5jdGlvbigpe3ZhciBhPWsuc3R5bGVzLGE9YSYmYS50ZXh0QWxpZ24sYj1BK3IsYztjPWg/MDp2O2lmKHMocSkmJm8mJihhPT09XCJjZW50ZXJcInx8YT09PVwicmlnaHRcIikpYis9e2NlbnRlcjowLjUscmlnaHQ6MX1bYV0qKHEtby53aWR0aCk7aWYoYiE9PWwueHx8YyE9PWwueSlsLmF0dHIoXCJ4XCIsYiksYyE9PXQmJmwuYXR0cihcInlcIixjKTtsLng9YjtsLnk9Y307Qj1mdW5jdGlvbihhLGIpe20/bS5hdHRyKGEsYik6aGFbYV09Yn07ay5vbkFkZD1mdW5jdGlvbigpe2wuYWRkKGspO2suYXR0cih7dGV4dDphfHxcbmE9PT0wP2E6XCJcIix4OmIseTpjfSk7bSYmcyhlKSYmay5hdHRyKHthbmNob3JYOmUsYW5jaG9yWTpmfSl9O2sud2lkdGhTZXR0ZXI9ZnVuY3Rpb24oYSl7cT1hfTtrLmhlaWdodFNldHRlcj1mdW5jdGlvbihhKXt1PWF9O2sucGFkZGluZ1NldHRlcj1mdW5jdGlvbihhKXtpZihzKGEpJiZhIT09cilyPWsucGFkZGluZz1hLEUoKX07ay5wYWRkaW5nTGVmdFNldHRlcj1mdW5jdGlvbihhKXtzKGEpJiZhIT09QSYmKEE9YSxFKCkpfTtrLmFsaWduU2V0dGVyPWZ1bmN0aW9uKGEpe2E9e2xlZnQ6MCxjZW50ZXI6MC41LHJpZ2h0OjF9W2FdO2EhPT1wJiYocD1hLG8mJmsuYXR0cih7eDp3fSkpfTtrLnRleHRTZXR0ZXI9ZnVuY3Rpb24oYSl7YSE9PXQmJmwudGV4dFNldHRlcihhKTtMKCk7RSgpfTtrW1wic3Ryb2tlLXdpZHRoU2V0dGVyXCJdPWZ1bmN0aW9uKGEsYil7YSYmKHo9ITApO1I9YSUyLzI7QihiLGEpfTtrLnN0cm9rZVNldHRlcj1rLmZpbGxTZXR0ZXI9ay5yU2V0dGVyPWZ1bmN0aW9uKGEsXG5iKXtiPT09XCJmaWxsXCImJmEmJih6PSEwKTtCKGIsYSl9O2suYW5jaG9yWFNldHRlcj1mdW5jdGlvbihhLGIpe2U9YTtCKGIseShhKS1SLXcpfTtrLmFuY2hvcllTZXR0ZXI9ZnVuY3Rpb24oYSxiKXtmPWE7QihiLGEtTyl9O2sueFNldHRlcj1mdW5jdGlvbihhKXtrLng9YTtwJiYoYS09cCooKHF8fG8ud2lkdGgpKzIqcikpO3c9eShhKTtrLmF0dHIoXCJ0cmFuc2xhdGVYXCIsdyl9O2sueVNldHRlcj1mdW5jdGlvbihhKXtPPWsueT15KGEpO2suYXR0cihcInRyYW5zbGF0ZVlcIixPKX07dmFyIEQ9ay5jc3M7cmV0dXJuIHgoayx7Y3NzOmZ1bmN0aW9uKGEpe2lmKGEpe3ZhciBiPXt9LGE9QyhhKTtuKGsudGV4dFByb3BzLGZ1bmN0aW9uKGMpe2FbY10hPT10JiYoYltjXT1hW2NdLGRlbGV0ZSBhW2NdKX0pO2wuY3NzKGIpfXJldHVybiBELmNhbGwoayxhKX0sZ2V0QkJveDpmdW5jdGlvbigpe3JldHVybnt3aWR0aDpvLndpZHRoKzIqcixoZWlnaHQ6by5oZWlnaHQrMipyLHg6by54LXIseTpvLnktXG5yfX0sc2hhZG93OmZ1bmN0aW9uKGEpe20mJm0uc2hhZG93KGEpO3JldHVybiBrfSxkZXN0cm95OmZ1bmN0aW9uKCl7VChrLmVsZW1lbnQsXCJtb3VzZWVudGVyXCIpO1Qoay5lbGVtZW50LFwibW91c2VsZWF2ZVwiKTtsJiYobD1sLmRlc3Ryb3koKSk7bSYmKG09bS5kZXN0cm95KCkpO1oucHJvdG90eXBlLmRlc3Ryb3kuY2FsbChrKTtrPWo9TD1FPUI9bnVsbH19KX19O1lhPXlhO3goWi5wcm90b3R5cGUse2h0bWxDc3M6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5lbGVtZW50O2lmKGI9YSYmYi50YWdOYW1lPT09XCJTUEFOXCImJmEud2lkdGgpZGVsZXRlIGEud2lkdGgsdGhpcy50ZXh0V2lkdGg9Yix0aGlzLnVwZGF0ZVRyYW5zZm9ybSgpO2lmKGEmJmEudGV4dE92ZXJmbG93PT09XCJlbGxpcHNpc1wiKWEud2hpdGVTcGFjZT1cIm5vd3JhcFwiLGEub3ZlcmZsb3c9XCJoaWRkZW5cIjt0aGlzLnN0eWxlcz14KHRoaXMuc3R5bGVzLGEpO0YodGhpcy5lbGVtZW50LGEpO3JldHVybiB0aGlzfSxodG1sR2V0QkJveDpmdW5jdGlvbigpe3ZhciBhPVxudGhpcy5lbGVtZW50O2lmKGEubm9kZU5hbWU9PT1cInRleHRcIilhLnN0eWxlLnBvc2l0aW9uPVwiYWJzb2x1dGVcIjtyZXR1cm57eDphLm9mZnNldExlZnQseTphLm9mZnNldFRvcCx3aWR0aDphLm9mZnNldFdpZHRoLGhlaWdodDphLm9mZnNldEhlaWdodH19LGh0bWxVcGRhdGVUcmFuc2Zvcm06ZnVuY3Rpb24oKXtpZih0aGlzLmFkZGVkKXt2YXIgYT10aGlzLnJlbmRlcmVyLGI9dGhpcy5lbGVtZW50LGM9dGhpcy50cmFuc2xhdGVYfHwwLGQ9dGhpcy50cmFuc2xhdGVZfHwwLGU9dGhpcy54fHwwLGY9dGhpcy55fHwwLGc9dGhpcy50ZXh0QWxpZ258fFwibGVmdFwiLGg9e2xlZnQ6MCxjZW50ZXI6MC41LHJpZ2h0OjF9W2ddLGk9dGhpcy5zaGFkb3dzLGo9dGhpcy5zdHlsZXM7RihiLHttYXJnaW5MZWZ0OmMsbWFyZ2luVG9wOmR9KTtpJiZuKGksZnVuY3Rpb24oYSl7RihhLHttYXJnaW5MZWZ0OmMrMSxtYXJnaW5Ub3A6ZCsxfSl9KTt0aGlzLmludmVydGVkJiZuKGIuY2hpbGROb2RlcyxmdW5jdGlvbihjKXthLmludmVydENoaWxkKGMsXG5iKX0pO2lmKGIudGFnTmFtZT09PVwiU1BBTlwiKXt2YXIgaT10aGlzLnJvdGF0aW9uLGs9Ryh0aGlzLnRleHRXaWR0aCksbD1qJiZqLndoaXRlU3BhY2UsbT1baSxnLGIuaW5uZXJIVE1MLHRoaXMudGV4dFdpZHRoLHRoaXMudGV4dEFsaWduXS5qb2luKFwiLFwiKTtpZihtIT09dGhpcy5jVFQpe2o9YS5mb250TWV0cmljcyhiLnN0eWxlLmZvbnRTaXplKS5iO3MoaSkmJnRoaXMuc2V0U3BhblJvdGF0aW9uKGksaCxqKTtpZihiLm9mZnNldFdpZHRoPmsmJi9bIFxcLV0vLnRlc3QoYi50ZXh0Q29udGVudHx8Yi5pbm5lclRleHQpKUYoYix7d2lkdGg6aytcInB4XCIsZGlzcGxheTpcImJsb2NrXCIsd2hpdGVTcGFjZTpsfHxcIm5vcm1hbFwifSksdGhpcy5oYXNUZXh0V2lkdGg9ITA7ZWxzZSBpZih0aGlzLmhhc1RleHRXaWR0aClGKGIse3dpZHRoOlwiXCIsZGlzcGxheTpcIlwiLHdoaXRlU3BhY2U6bHx8XCJub3dyYXBcIn0pLHRoaXMuaGFzVGV4dFdpZHRoPSExO3RoaXMuZ2V0U3BhbkNvcnJlY3Rpb24odGhpcy5oYXNUZXh0V2lkdGg/XG5rOmIub2Zmc2V0V2lkdGgsaixoLGksZyl9RihiLHtsZWZ0OmUrKHRoaXMueENvcnJ8fDApK1wicHhcIix0b3A6ZisodGhpcy55Q29ycnx8MCkrXCJweFwifSk7aWYodGIpaj1iLm9mZnNldEhlaWdodDt0aGlzLmNUVD1tfX1lbHNlIHRoaXMuYWxpZ25PbkFkZD0hMH0sc2V0U3BhblJvdGF0aW9uOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD17fSxlPUthP1wiLW1zLXRyYW5zZm9ybVwiOnRiP1wiLXdlYmtpdC10cmFuc2Zvcm1cIjpYYT9cIk1velRyYW5zZm9ybVwiOlViP1wiLW8tdHJhbnNmb3JtXCI6XCJcIjtkW2VdPWQudHJhbnNmb3JtPVwicm90YXRlKFwiK2ErXCJkZWcpXCI7ZFtlKyhYYT9cIk9yaWdpblwiOlwiLW9yaWdpblwiKV09ZC50cmFuc2Zvcm1PcmlnaW49YioxMDArXCIlIFwiK2MrXCJweFwiO0YodGhpcy5lbGVtZW50LGQpfSxnZXRTcGFuQ29ycmVjdGlvbjpmdW5jdGlvbihhLGIsYyl7dGhpcy54Q29ycj0tYSpjO3RoaXMueUNvcnI9LWJ9fSk7eCh5YS5wcm90b3R5cGUse2h0bWw6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPVxudGhpcy5jcmVhdGVFbGVtZW50KFwic3BhblwiKSxlPWQuZWxlbWVudCxmPWQucmVuZGVyZXIsZz1mLmlzU1ZHLGg9ZnVuY3Rpb24oYSxiKXtuKFtcIm9wYWNpdHlcIixcInZpc2liaWxpdHlcIl0sZnVuY3Rpb24oYyl7VShhLGMrXCJTZXR0ZXJcIixmdW5jdGlvbihhLGMsZCxlKXthLmNhbGwodGhpcyxjLGQsZSk7YltkXT1jfSl9KX07ZC50ZXh0U2V0dGVyPWZ1bmN0aW9uKGEpe2EhPT1lLmlubmVySFRNTCYmZGVsZXRlIHRoaXMuYkJveDtlLmlubmVySFRNTD10aGlzLnRleHRTdHI9YTtkLmh0bWxVcGRhdGVUcmFuc2Zvcm0oKX07ZyYmaChkLGQuZWxlbWVudC5zdHlsZSk7ZC54U2V0dGVyPWQueVNldHRlcj1kLmFsaWduU2V0dGVyPWQucm90YXRpb25TZXR0ZXI9ZnVuY3Rpb24oYSxiKXtiPT09XCJhbGlnblwiJiYoYj1cInRleHRBbGlnblwiKTtkW2JdPWE7ZC5odG1sVXBkYXRlVHJhbnNmb3JtKCl9O2QuYXR0cih7dGV4dDphLHg6eShiKSx5OnkoYyl9KS5jc3Moe3Bvc2l0aW9uOlwiYWJzb2x1dGVcIixmb250RmFtaWx5OnRoaXMuc3R5bGUuZm9udEZhbWlseSxcbmZvbnRTaXplOnRoaXMuc3R5bGUuZm9udFNpemV9KTtlLnN0eWxlLndoaXRlU3BhY2U9XCJub3dyYXBcIjtkLmNzcz1kLmh0bWxDc3M7aWYoZylkLmFkZD1mdW5jdGlvbihhKXt2YXIgYixjPWYuYm94LnBhcmVudE5vZGUsZz1bXTtpZih0aGlzLnBhcmVudEdyb3VwPWEpe2lmKGI9YS5kaXYsIWIpe2Zvcig7YTspZy5wdXNoKGEpLGE9YS5wYXJlbnRHcm91cDtuKGcucmV2ZXJzZSgpLGZ1bmN0aW9uKGEpe3ZhciBkLGU9WChhLmVsZW1lbnQsXCJjbGFzc1wiKTtlJiYoZT17Y2xhc3NOYW1lOmV9KTtiPWEuZGl2PWEuZGl2fHxlYShXYSxlLHtwb3NpdGlvbjpcImFic29sdXRlXCIsbGVmdDooYS50cmFuc2xhdGVYfHwwKStcInB4XCIsdG9wOihhLnRyYW5zbGF0ZVl8fDApK1wicHhcIixvcGFjaXR5OmEub3BhY2l0eX0sYnx8Yyk7ZD1iLnN0eWxlO3goYSx7dHJhbnNsYXRlWFNldHRlcjpmdW5jdGlvbihiLGMpe2QubGVmdD1iK1wicHhcIjthW2NdPWI7YS5kb1RyYW5zZm9ybT0hMH0sdHJhbnNsYXRlWVNldHRlcjpmdW5jdGlvbihiLFxuYyl7ZC50b3A9YitcInB4XCI7YVtjXT1iO2EuZG9UcmFuc2Zvcm09ITB9fSk7aChhLGQpfSl9fWVsc2UgYj1jO2IuYXBwZW5kQ2hpbGQoZSk7ZC5hZGRlZD0hMDtkLmFsaWduT25BZGQmJmQuaHRtbFVwZGF0ZVRyYW5zZm9ybSgpO3JldHVybiBkfTtyZXR1cm4gZH19KTt2YXIgbWIsYWE7aWYoIWphJiYhcWEpYWE9e2luaXQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz1bXCI8XCIsYiwnIGZpbGxlZD1cImZcIiBzdHJva2VkPVwiZlwiJ10sZD1bXCJwb3NpdGlvbjogXCIsXCJhYnNvbHV0ZVwiLFwiO1wiXSxlPWI9PT1XYTsoYj09PVwic2hhcGVcInx8ZSkmJmQucHVzaChcImxlZnQ6MDt0b3A6MDt3aWR0aDoxcHg7aGVpZ2h0OjFweDtcIik7ZC5wdXNoKFwidmlzaWJpbGl0eTogXCIsZT9cImhpZGRlblwiOlwidmlzaWJsZVwiKTtjLnB1c2goJyBzdHlsZT1cIicsZC5qb2luKFwiXCIpLCdcIi8+Jyk7aWYoYiljPWV8fGI9PT1cInNwYW5cInx8Yj09PVwiaW1nXCI/Yy5qb2luKFwiXCIpOmEucHJlcFZNTChjKSx0aGlzLmVsZW1lbnQ9ZWEoYyk7dGhpcy5yZW5kZXJlcj1cbmF9LGFkZDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLnJlbmRlcmVyLGM9dGhpcy5lbGVtZW50LGQ9Yi5ib3gsZT1hJiZhLmludmVydGVkLGQ9YT9hLmVsZW1lbnR8fGE6ZDtpZihhKXRoaXMucGFyZW50R3JvdXA9YTtlJiZiLmludmVydENoaWxkKGMsZCk7ZC5hcHBlbmRDaGlsZChjKTt0aGlzLmFkZGVkPSEwO3RoaXMuYWxpZ25PbkFkZCYmIXRoaXMuZGVmZXJVcGRhdGVUcmFuc2Zvcm0mJnRoaXMudXBkYXRlVHJhbnNmb3JtKCk7aWYodGhpcy5vbkFkZCl0aGlzLm9uQWRkKCk7cmV0dXJuIHRoaXN9LHVwZGF0ZVRyYW5zZm9ybTpaLnByb3RvdHlwZS5odG1sVXBkYXRlVHJhbnNmb3JtLHNldFNwYW5Sb3RhdGlvbjpmdW5jdGlvbigpe3ZhciBhPXRoaXMucm90YXRpb24sYj1iYShhKnBhKSxjPWthKGEqcGEpO0YodGhpcy5lbGVtZW50LHtmaWx0ZXI6YT9bXCJwcm9naWQ6RFhJbWFnZVRyYW5zZm9ybS5NaWNyb3NvZnQuTWF0cml4KE0xMT1cIixiLFwiLCBNMTI9XCIsLWMsXCIsIE0yMT1cIixjLFwiLCBNMjI9XCIsXG5iLFwiLCBzaXppbmdNZXRob2Q9J2F1dG8gZXhwYW5kJylcIl0uam9pbihcIlwiKTpcIm5vbmVcIn0pfSxnZXRTcGFuQ29ycmVjdGlvbjpmdW5jdGlvbihhLGIsYyxkLGUpe3ZhciBmPWQ/YmEoZCpwYSk6MSxnPWQ/a2EoZCpwYSk6MCxoPXEodGhpcy5lbGVtSGVpZ2h0LHRoaXMuZWxlbWVudC5vZmZzZXRIZWlnaHQpLGk7dGhpcy54Q29ycj1mPDAmJi1hO3RoaXMueUNvcnI9ZzwwJiYtaDtpPWYqZzwwO3RoaXMueENvcnIrPWcqYiooaT8xLWM6Yyk7dGhpcy55Q29yci09ZipiKihkP2k/YzoxLWM6MSk7ZSYmZSE9PVwibGVmdFwiJiYodGhpcy54Q29yci09YSpjKihmPDA/LTE6MSksZCYmKHRoaXMueUNvcnItPWgqYyooZzwwPy0xOjEpKSxGKHRoaXMuZWxlbWVudCx7dGV4dEFsaWduOmV9KSl9LHBhdGhUb1ZNTDpmdW5jdGlvbihhKXtmb3IodmFyIGI9YS5sZW5ndGgsYz1bXTtiLS07KWlmKHVhKGFbYl0pKWNbYl09eShhW2JdKjEwKS01O2Vsc2UgaWYoYVtiXT09PVwiWlwiKWNbYl09XCJ4XCI7ZWxzZSBpZihjW2JdPVxuYVtiXSxhLmlzQXJjJiYoYVtiXT09PVwid2FcInx8YVtiXT09PVwiYXRcIikpY1tiKzVdPT09Y1tiKzddJiYoY1tiKzddKz1hW2IrN10+YVtiKzVdPzE6LTEpLGNbYis2XT09PWNbYis4XSYmKGNbYis4XSs9YVtiKzhdPmFbYis2XT8xOi0xKTtyZXR1cm4gYy5qb2luKFwiIFwiKXx8XCJ4XCJ9LGNsaXA6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcyxjO2E/KGM9YS5tZW1iZXJzLEFhKGMsYiksYy5wdXNoKGIpLGIuZGVzdHJveUNsaXA9ZnVuY3Rpb24oKXtBYShjLGIpfSxhPWEuZ2V0Q1NTKGIpKTooYi5kZXN0cm95Q2xpcCYmYi5kZXN0cm95Q2xpcCgpLGE9e2NsaXA6c2I/XCJpbmhlcml0XCI6XCJyZWN0KGF1dG8pXCJ9KTtyZXR1cm4gYi5jc3MoYSl9LGNzczpaLnByb3RvdHlwZS5odG1sQ3NzLHNhZmVSZW1vdmVDaGlsZDpmdW5jdGlvbihhKXthLnBhcmVudE5vZGUmJlZhKGEpfSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5kZXN0cm95Q2xpcCYmdGhpcy5kZXN0cm95Q2xpcCgpO3JldHVybiBaLnByb3RvdHlwZS5kZXN0cm95LmFwcGx5KHRoaXMpfSxcbm9uOmZ1bmN0aW9uKGEsYil7dGhpcy5lbGVtZW50W1wib25cIithXT1mdW5jdGlvbigpe3ZhciBhPUouZXZlbnQ7YS50YXJnZXQ9YS5zcmNFbGVtZW50O2IoYSl9O3JldHVybiB0aGlzfSxjdXRPZmZQYXRoOmZ1bmN0aW9uKGEsYil7dmFyIGMsYT1hLnNwbGl0KC9bICxdLyk7Yz1hLmxlbmd0aDtpZihjPT09OXx8Yz09PTExKWFbYy00XT1hW2MtMl09RyhhW2MtMl0pLTEwKmI7cmV0dXJuIGEuam9pbihcIiBcIil9LHNoYWRvdzpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9W10sZSxmPXRoaXMuZWxlbWVudCxnPXRoaXMucmVuZGVyZXIsaCxpPWYuc3R5bGUsaixrPWYucGF0aCxsLG0sbyxwO2smJnR5cGVvZiBrLnZhbHVlIT09XCJzdHJpbmdcIiYmKGs9XCJ4XCIpO209aztpZihhKXtvPXEoYS53aWR0aCwzKTtwPShhLm9wYWNpdHl8fDAuMTUpL287Zm9yKGU9MTtlPD0zO2UrKyl7bD1vKjIrMS0yKmU7YyYmKG09dGhpcy5jdXRPZmZQYXRoKGsudmFsdWUsbCswLjUpKTtqPVsnPHNoYXBlIGlzU2hhZG93PVwidHJ1ZVwiIHN0cm9rZXdlaWdodD1cIicsXG5sLCdcIiBmaWxsZWQ9XCJmYWxzZVwiIHBhdGg9XCInLG0sJ1wiIGNvb3Jkc2l6ZT1cIjEwIDEwXCIgc3R5bGU9XCInLGYuc3R5bGUuY3NzVGV4dCwnXCIgLz4nXTtoPWVhKGcucHJlcFZNTChqKSxudWxsLHtsZWZ0OkcoaS5sZWZ0KStxKGEub2Zmc2V0WCwxKSx0b3A6RyhpLnRvcCkrcShhLm9mZnNldFksMSl9KTtpZihjKWguY3V0T2ZmPWwrMTtqPVsnPHN0cm9rZSBjb2xvcj1cIicsYS5jb2xvcnx8XCJibGFja1wiLCdcIiBvcGFjaXR5PVwiJyxwKmUsJ1wiLz4nXTtlYShnLnByZXBWTUwoaiksbnVsbCxudWxsLGgpO2I/Yi5lbGVtZW50LmFwcGVuZENoaWxkKGgpOmYucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoaCxmKTtkLnB1c2goaCl9dGhpcy5zaGFkb3dzPWR9cmV0dXJuIHRoaXN9LHVwZGF0ZVNoYWRvd3M6cmEsc2V0QXR0cjpmdW5jdGlvbihhLGIpe3NiP3RoaXMuZWxlbWVudFthXT1iOnRoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGUoYSxiKX0sY2xhc3NTZXR0ZXI6ZnVuY3Rpb24oYSl7dGhpcy5lbGVtZW50LmNsYXNzTmFtZT1cbmF9LGRhc2hzdHlsZVNldHRlcjpmdW5jdGlvbihhLGIsYyl7KGMuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzdHJva2VcIilbMF18fGVhKHRoaXMucmVuZGVyZXIucHJlcFZNTChbXCI8c3Ryb2tlLz5cIl0pLG51bGwsbnVsbCxjKSlbYl09YXx8XCJzb2xpZFwiO3RoaXNbYl09YX0sZFNldHRlcjpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9dGhpcy5zaGFkb3dzLGE9YXx8W107dGhpcy5kPWEuam9pbiYmYS5qb2luKFwiIFwiKTtjLnBhdGg9YT10aGlzLnBhdGhUb1ZNTChhKTtpZihkKWZvcihjPWQubGVuZ3RoO2MtLTspZFtjXS5wYXRoPWRbY10uY3V0T2ZmP3RoaXMuY3V0T2ZmUGF0aChhLGRbY10uY3V0T2ZmKTphO3RoaXMuc2V0QXR0cihiLGEpfSxmaWxsU2V0dGVyOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD1jLm5vZGVOYW1lO2lmKGQ9PT1cIlNQQU5cIiljLnN0eWxlLmNvbG9yPWE7ZWxzZSBpZihkIT09XCJJTUdcIiljLmZpbGxlZD1hIT09XCJub25lXCIsdGhpcy5zZXRBdHRyKFwiZmlsbGNvbG9yXCIsdGhpcy5yZW5kZXJlci5jb2xvcihhLFxuYyxiLHRoaXMpKX0sXCJmaWxsLW9wYWNpdHlTZXR0ZXJcIjpmdW5jdGlvbihhLGIsYyl7ZWEodGhpcy5yZW5kZXJlci5wcmVwVk1MKFtcIjxcIixiLnNwbGl0KFwiLVwiKVswXSwnIG9wYWNpdHk9XCInLGEsJ1wiLz4nXSksbnVsbCxudWxsLGMpfSxvcGFjaXR5U2V0dGVyOnJhLHJvdGF0aW9uU2V0dGVyOmZ1bmN0aW9uKGEsYixjKXtjPWMuc3R5bGU7dGhpc1tiXT1jW2JdPWE7Yy5sZWZ0PS15KGthKGEqcGEpKzEpK1wicHhcIjtjLnRvcD15KGJhKGEqcGEpKStcInB4XCJ9LHN0cm9rZVNldHRlcjpmdW5jdGlvbihhLGIsYyl7dGhpcy5zZXRBdHRyKFwic3Ryb2tlY29sb3JcIix0aGlzLnJlbmRlcmVyLmNvbG9yKGEsYyxiLHRoaXMpKX0sXCJzdHJva2Utd2lkdGhTZXR0ZXJcIjpmdW5jdGlvbihhLGIsYyl7Yy5zdHJva2VkPSEhYTt0aGlzW2JdPWE7dWEoYSkmJihhKz1cInB4XCIpO3RoaXMuc2V0QXR0cihcInN0cm9rZXdlaWdodFwiLGEpfSx0aXRsZVNldHRlcjpmdW5jdGlvbihhLGIpe3RoaXMuc2V0QXR0cihiLGEpfSxcbnZpc2liaWxpdHlTZXR0ZXI6ZnVuY3Rpb24oYSxiLGMpe2E9PT1cImluaGVyaXRcIiYmKGE9XCJ2aXNpYmxlXCIpO3RoaXMuc2hhZG93cyYmbih0aGlzLnNoYWRvd3MsZnVuY3Rpb24oYyl7Yy5zdHlsZVtiXT1hfSk7Yy5ub2RlTmFtZT09PVwiRElWXCImJihhPWE9PT1cImhpZGRlblwiP1wiLTk5OWVtXCI6MCxzYnx8KGMuc3R5bGVbYl09YT9cInZpc2libGVcIjpcImhpZGRlblwiKSxiPVwidG9wXCIpO2Muc3R5bGVbYl09YX0seFNldHRlcjpmdW5jdGlvbihhLGIsYyl7dGhpc1tiXT1hO2I9PT1cInhcIj9iPVwibGVmdFwiOmI9PT1cInlcIiYmKGI9XCJ0b3BcIik7dGhpcy51cGRhdGVDbGlwcGluZz8odGhpc1tiXT1hLHRoaXMudXBkYXRlQ2xpcHBpbmcoKSk6Yy5zdHlsZVtiXT1hfSx6SW5kZXhTZXR0ZXI6ZnVuY3Rpb24oYSxiLGMpe2Muc3R5bGVbYl09YX19LGFhW1wic3Ryb2tlLW9wYWNpdHlTZXR0ZXJcIl09YWFbXCJmaWxsLW9wYWNpdHlTZXR0ZXJcIl0sei5WTUxFbGVtZW50PWFhPWxhKFosYWEpLGFhLnByb3RvdHlwZS55U2V0dGVyPVxuYWEucHJvdG90eXBlLndpZHRoU2V0dGVyPWFhLnByb3RvdHlwZS5oZWlnaHRTZXR0ZXI9YWEucHJvdG90eXBlLnhTZXR0ZXIsYWE9e0VsZW1lbnQ6YWEsaXNJRTg6TWEuaW5kZXhPZihcIk1TSUUgOC4wXCIpPi0xLGluaXQ6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU7dGhpcy5hbGlnbmVkT2JqZWN0cz1bXTtkPXRoaXMuY3JlYXRlRWxlbWVudChXYSkuY3NzKHgodGhpcy5nZXRTdHlsZShkKSx7cG9zaXRpb246XCJyZWxhdGl2ZVwifSkpO2U9ZC5lbGVtZW50O2EuYXBwZW5kQ2hpbGQoZC5lbGVtZW50KTt0aGlzLmlzVk1MPSEwO3RoaXMuYm94PWU7dGhpcy5ib3hXcmFwcGVyPWQ7dGhpcy5ncmFkaWVudHM9e307dGhpcy5jYWNoZT17fTt0aGlzLmNhY2hlS2V5cz1bXTt0aGlzLmltZ0NvdW50PTA7dGhpcy5zZXRTaXplKGIsYywhMSk7aWYoIUIubmFtZXNwYWNlcy5oY3Ype0IubmFtZXNwYWNlcy5hZGQoXCJoY3ZcIixcInVybjpzY2hlbWFzLW1pY3Jvc29mdC1jb206dm1sXCIpO3RyeXtCLmNyZWF0ZVN0eWxlU2hlZXQoKS5jc3NUZXh0PVxuXCJoY3ZcXFxcOmZpbGwsIGhjdlxcXFw6cGF0aCwgaGN2XFxcXDpzaGFwZSwgaGN2XFxcXDpzdHJva2V7IGJlaGF2aW9yOnVybCgjZGVmYXVsdCNWTUwpOyBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IH0gXCJ9Y2F0Y2goZil7Qi5zdHlsZVNoZWV0c1swXS5jc3NUZXh0Kz1cImhjdlxcXFw6ZmlsbCwgaGN2XFxcXDpwYXRoLCBoY3ZcXFxcOnNoYXBlLCBoY3ZcXFxcOnN0cm9rZXsgYmVoYXZpb3I6dXJsKCNkZWZhdWx0I1ZNTCk7IGRpc3BsYXk6IGlubGluZS1ibG9jazsgfSBcIn19fSxpc0hpZGRlbjpmdW5jdGlvbigpe3JldHVybiF0aGlzLmJveC5vZmZzZXRXaWR0aH0sY2xpcFJlY3Q6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9dGhpcy5jcmVhdGVFbGVtZW50KCksZj1kYShhKTtyZXR1cm4geChlLHttZW1iZXJzOltdLGNvdW50OjAsbGVmdDooZj9hLng6YSkrMSx0b3A6KGY/YS55OmIpKzEsd2lkdGg6KGY/YS53aWR0aDpjKS0xLGhlaWdodDooZj9hLmhlaWdodDpkKS0xLGdldENTUzpmdW5jdGlvbihhKXt2YXIgYj1hLmVsZW1lbnQsXG5jPWIubm9kZU5hbWUsYT1hLmludmVydGVkLGQ9dGhpcy50b3AtKGM9PT1cInNoYXBlXCI/Yi5vZmZzZXRUb3A6MCksZT10aGlzLmxlZnQsYj1lK3RoaXMud2lkdGgsZj1kK3RoaXMuaGVpZ2h0LGQ9e2NsaXA6XCJyZWN0KFwiK3koYT9lOmQpK1wicHgsXCIreShhP2Y6YikrXCJweCxcIit5KGE/YjpmKStcInB4LFwiK3koYT9kOmUpK1wicHgpXCJ9OyFhJiZzYiYmYz09PVwiRElWXCImJngoZCx7d2lkdGg6YitcInB4XCIsaGVpZ2h0OmYrXCJweFwifSk7cmV0dXJuIGR9LHVwZGF0ZUNsaXBwaW5nOmZ1bmN0aW9uKCl7bihlLm1lbWJlcnMsZnVuY3Rpb24oYSl7YS5lbGVtZW50JiZhLmNzcyhlLmdldENTUyhhKSl9KX19KX0sY29sb3I6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9dGhpcyxmLGc9L15yZ2JhLyxoLGksaj1cIm5vbmVcIjthJiZhLmxpbmVhckdyYWRpZW50P2k9XCJncmFkaWVudFwiOmEmJmEucmFkaWFsR3JhZGllbnQmJihpPVwicGF0dGVyblwiKTtpZihpKXt2YXIgayxsLG09YS5saW5lYXJHcmFkaWVudHx8YS5yYWRpYWxHcmFkaWVudCxcbm8scCxyLEEscSx1PVwiXCIsYT1hLnN0b3BzLHcsTz1bXSxSPWZ1bmN0aW9uKCl7aD1bJzxmaWxsIGNvbG9ycz1cIicrTy5qb2luKFwiLFwiKSsnXCIgb3BhY2l0eT1cIicsciwnXCIgbzpvcGFjaXR5Mj1cIicscCwnXCIgdHlwZT1cIicsaSwnXCIgJyx1LCdmb2N1cz1cIjEwMCVcIiBtZXRob2Q9XCJhbnlcIiAvPiddO2VhKGUucHJlcFZNTChoKSxudWxsLG51bGwsYil9O289YVswXTt3PWFbYS5sZW5ndGgtMV07b1swXT4wJiZhLnVuc2hpZnQoWzAsb1sxXV0pO3dbMF08MSYmYS5wdXNoKFsxLHdbMV1dKTtuKGEsZnVuY3Rpb24oYSxiKXtnLnRlc3QoYVsxXSk/KGY9d2EoYVsxXSksaz1mLmdldChcInJnYlwiKSxsPWYuZ2V0KFwiYVwiKSk6KGs9YVsxXSxsPTEpO08ucHVzaChhWzBdKjEwMCtcIiUgXCIrayk7Yj8ocj1sLEE9ayk6KHA9bCxxPWspfSk7aWYoYz09PVwiZmlsbFwiKWlmKGk9PT1cImdyYWRpZW50XCIpYz1tLngxfHxtWzBdfHwwLGE9bS55MXx8bVsxXXx8MCxvPW0ueDJ8fG1bMl18fDAsbT1tLnkyfHxtWzNdfHwwLHU9XG4nYW5nbGU9XCInKyg5MC1ZLmF0YW4oKG0tYSkvKG8tYykpKjE4MC9CYSkrJ1wiJyxSKCk7ZWxzZXt2YXIgaj1tLnIsaGE9aioyLHM9aioyLHY9bS5jeCx0PW0uY3kseT1iLnJhZGlhbFJlZmVyZW5jZSx4LGo9ZnVuY3Rpb24oKXt5JiYoeD1kLmdldEJCb3goKSx2Kz0oeVswXS14LngpL3gud2lkdGgtMC41LHQrPSh5WzFdLXgueSkveC5oZWlnaHQtMC41LGhhKj15WzJdL3gud2lkdGgscyo9eVsyXS94LmhlaWdodCk7dT0nc3JjPVwiJytOLmdsb2JhbC5WTUxSYWRpYWxHcmFkaWVudFVSTCsnXCIgc2l6ZT1cIicraGErXCIsXCIrcysnXCIgb3JpZ2luPVwiMC41LDAuNVwiIHBvc2l0aW9uPVwiJyt2K1wiLFwiK3QrJ1wiIGNvbG9yMj1cIicrcSsnXCIgJztSKCl9O2QuYWRkZWQ/aigpOmQub25BZGQ9ajtqPUF9ZWxzZSBqPWt9ZWxzZSBpZihnLnRlc3QoYSkmJmIudGFnTmFtZSE9PVwiSU1HXCIpZj13YShhKSxkW2MrXCItb3BhY2l0eVNldHRlclwiXShmLmdldChcImFcIiksYyxiKSxqPWYuZ2V0KFwicmdiXCIpO2Vsc2V7aj1iLmdldEVsZW1lbnRzQnlUYWdOYW1lKGMpO1xuaWYoai5sZW5ndGgpalswXS5vcGFjaXR5PTEsalswXS50eXBlPVwic29saWRcIjtqPWF9cmV0dXJuIGp9LHByZXBWTUw6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5pc0lFOCxhPWEuam9pbihcIlwiKTtiPyhhPWEucmVwbGFjZShcIi8+XCIsJyB4bWxucz1cInVybjpzY2hlbWFzLW1pY3Jvc29mdC1jb206dm1sXCIgLz4nKSxhPWEuaW5kZXhPZignc3R5bGU9XCInKT09PS0xP2EucmVwbGFjZShcIi8+XCIsJyBzdHlsZT1cImRpc3BsYXk6aW5saW5lLWJsb2NrO2JlaGF2aW9yOnVybCgjZGVmYXVsdCNWTUwpO1wiIC8+Jyk6YS5yZXBsYWNlKCdzdHlsZT1cIicsJ3N0eWxlPVwiZGlzcGxheTppbmxpbmUtYmxvY2s7YmVoYXZpb3I6dXJsKCNkZWZhdWx0I1ZNTCk7JykpOmE9YS5yZXBsYWNlKFwiPFwiLFwiPGhjdjpcIik7cmV0dXJuIGF9LHRleHQ6eWEucHJvdG90eXBlLmh0bWwscGF0aDpmdW5jdGlvbihhKXt2YXIgYj17Y29vcmRzaXplOlwiMTAgMTBcIn07SmEoYSk/Yi5kPWE6ZGEoYSkmJngoYixhKTtyZXR1cm4gdGhpcy5jcmVhdGVFbGVtZW50KFwic2hhcGVcIikuYXR0cihiKX0sXG5jaXJjbGU6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXRoaXMuc3ltYm9sKFwiY2lyY2xlXCIpO2lmKGRhKGEpKWM9YS5yLGI9YS55LGE9YS54O2QuaXNDaXJjbGU9ITA7ZC5yPWM7cmV0dXJuIGQuYXR0cih7eDphLHk6Yn0pfSxnOmZ1bmN0aW9uKGEpe3ZhciBiO2EmJihiPXtjbGFzc05hbWU6XCJoaWdoY2hhcnRzLVwiK2EsXCJjbGFzc1wiOlwiaGlnaGNoYXJ0cy1cIithfSk7cmV0dXJuIHRoaXMuY3JlYXRlRWxlbWVudChXYSkuYXR0cihiKX0saW1hZ2U6ZnVuY3Rpb24oYSxiLGMsZCxlKXt2YXIgZj10aGlzLmNyZWF0ZUVsZW1lbnQoXCJpbWdcIikuYXR0cih7c3JjOmF9KTthcmd1bWVudHMubGVuZ3RoPjEmJmYuYXR0cih7eDpiLHk6Yyx3aWR0aDpkLGhlaWdodDplfSk7cmV0dXJuIGZ9LGNyZWF0ZUVsZW1lbnQ6ZnVuY3Rpb24oYSl7cmV0dXJuIGE9PT1cInJlY3RcIj90aGlzLnN5bWJvbChhKTp5YS5wcm90b3R5cGUuY3JlYXRlRWxlbWVudC5jYWxsKHRoaXMsYSl9LGludmVydENoaWxkOmZ1bmN0aW9uKGEsXG5iKXt2YXIgYz10aGlzLGQ9Yi5zdHlsZSxlPWEudGFnTmFtZT09PVwiSU1HXCImJmEuc3R5bGU7RihhLHtmbGlwOlwieFwiLGxlZnQ6RyhkLndpZHRoKS0oZT9HKGUudG9wKToxKSx0b3A6RyhkLmhlaWdodCktKGU/RyhlLmxlZnQpOjEpLHJvdGF0aW9uOi05MH0pO24oYS5jaGlsZE5vZGVzLGZ1bmN0aW9uKGIpe2MuaW52ZXJ0Q2hpbGQoYixhKX0pfSxzeW1ib2xzOnthcmM6ZnVuY3Rpb24oYSxiLGMsZCxlKXt2YXIgZj1lLnN0YXJ0LGc9ZS5lbmQsaD1lLnJ8fGN8fGQsYz1lLmlubmVyUixkPWJhKGYpLGk9a2EoZiksaj1iYShnKSxrPWthKGcpO2lmKGctZj09PTApcmV0dXJuW1wieFwiXTtmPVtcIndhXCIsYS1oLGItaCxhK2gsYitoLGEraCpkLGIraCppLGEraCpqLGIraCprXTtlLm9wZW4mJiFjJiZmLnB1c2goXCJlXCIsXCJNXCIsYSxiKTtmLnB1c2goXCJhdFwiLGEtYyxiLWMsYStjLGIrYyxhK2MqaixiK2MqayxhK2MqZCxiK2MqaSxcInhcIixcImVcIik7Zi5pc0FyYz0hMDtyZXR1cm4gZn0sY2lyY2xlOmZ1bmN0aW9uKGEsXG5iLGMsZCxlKXtlJiYoYz1kPTIqZS5yKTtlJiZlLmlzQ2lyY2xlJiYoYS09Yy8yLGItPWQvMik7cmV0dXJuW1wid2FcIixhLGIsYStjLGIrZCxhK2MsYitkLzIsYStjLGIrZC8yLFwiZVwiXX0scmVjdDpmdW5jdGlvbihhLGIsYyxkLGUpe3JldHVybiB5YS5wcm90b3R5cGUuc3ltYm9sc1shcyhlKXx8IWUucj9cInNxdWFyZVwiOlwiY2FsbG91dFwiXS5jYWxsKDAsYSxiLGMsZCxlKX19fSx6LlZNTFJlbmRlcmVyPW1iPWZ1bmN0aW9uKCl7dGhpcy5pbml0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sbWIucHJvdG90eXBlPUMoeWEucHJvdG90eXBlLGFhKSxZYT1tYjt5YS5wcm90b3R5cGUubWVhc3VyZVNwYW5XaWR0aD1mdW5jdGlvbihhLGIpe3ZhciBjPUIuY3JlYXRlRWxlbWVudChcInNwYW5cIiksZDtkPUIuY3JlYXRlVGV4dE5vZGUoYSk7Yy5hcHBlbmRDaGlsZChkKTtGKGMsYik7dGhpcy5ib3guYXBwZW5kQ2hpbGQoYyk7ZD1jLm9mZnNldFdpZHRoO1ZhKGMpO3JldHVybiBkfTt2YXIgV2I7aWYocWEpei5DYW5WR1JlbmRlcmVyPVxuYWE9ZnVuY3Rpb24oKXtRYT1cImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWxcIn0sYWEucHJvdG90eXBlLnN5bWJvbHM9e30sV2I9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKCl7dmFyIGE9Yi5sZW5ndGgsZDtmb3IoZD0wO2Q8YTtkKyspYltkXSgpO2I9W119dmFyIGI9W107cmV0dXJue3B1c2g6ZnVuY3Rpb24oYyxkKXtpZihiLmxlbmd0aD09PTApe3ZhciBlPUIuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJoZWFkXCIpWzBdLGY9Qi5jcmVhdGVFbGVtZW50KFwic2NyaXB0XCIpO2YudHlwZT1cInRleHQvamF2YXNjcmlwdFwiO2Yuc3JjPWQ7Zi5vbmxvYWQ9YTtlLmFwcGVuZENoaWxkKGYpfWIucHVzaChjKX19fSgpLFlhPWFhO2NiLnByb3RvdHlwZT17YWRkTGFiZWw6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmF4aXMsYj1hLm9wdGlvbnMsYz1hLmNoYXJ0LGQ9YS5jYXRlZ29yaWVzLGU9YS5uYW1lcyxmPXRoaXMucG9zLGc9Yi5sYWJlbHMsaD1hLnRpY2tQb3NpdGlvbnMsaT1mPT09aFswXSxqPWY9PT1cbmhbaC5sZW5ndGgtMV0sZT1kP3EoZFtmXSxlW2ZdLGYpOmYsZD10aGlzLmxhYmVsLGg9aC5pbmZvLGs7YS5pc0RhdGV0aW1lQXhpcyYmaCYmKGs9Yi5kYXRlVGltZUxhYmVsRm9ybWF0c1toLmhpZ2hlclJhbmtzW2ZdfHxoLnVuaXROYW1lXSk7dGhpcy5pc0ZpcnN0PWk7dGhpcy5pc0xhc3Q9ajtiPWEubGFiZWxGb3JtYXR0ZXIuY2FsbCh7YXhpczphLGNoYXJ0OmMsaXNGaXJzdDppLGlzTGFzdDpqLGRhdGVUaW1lTGFiZWxGb3JtYXQ6ayx2YWx1ZTphLmlzTG9nP25hKGEubGluMmxvZyhlKSk6ZX0pO3MoZCk/ZCYmZC5hdHRyKHt0ZXh0OmJ9KToodGhpcy5sYWJlbExlbmd0aD0odGhpcy5sYWJlbD1kPXMoYikmJmcuZW5hYmxlZD9jLnJlbmRlcmVyLnRleHQoYiwwLDAsZy51c2VIVE1MKS5jc3MoQyhnLnN0eWxlKSkuYWRkKGEubGFiZWxHcm91cCk6bnVsbCkmJmQuZ2V0QkJveCgpLndpZHRoLHRoaXMucm90YXRpb249MCl9LGdldExhYmVsU2l6ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmxhYmVsP1xudGhpcy5sYWJlbC5nZXRCQm94KClbdGhpcy5heGlzLmhvcml6P1wiaGVpZ2h0XCI6XCJ3aWR0aFwiXTowfSxoYW5kbGVPdmVyZmxvdzpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmF4aXMsYz1hLngsZD1iLmNoYXJ0LmNoYXJ0V2lkdGgsZT1iLmNoYXJ0LnNwYWNpbmcsZj1xKGIubGFiZWxMZWZ0LEUoYi5wb3MsZVszXSkpLGU9cShiLmxhYmVsUmlnaHQsdihiLnBvcytiLmxlbixkLWVbMV0pKSxnPXRoaXMubGFiZWwsaD10aGlzLnJvdGF0aW9uLGk9e2xlZnQ6MCxjZW50ZXI6MC41LHJpZ2h0OjF9W2IubGFiZWxBbGlnbl0saj1nLmdldEJCb3goKS53aWR0aCxrPWIuZ2V0U2xvdFdpZHRoKCksbD1rLG09MSxvLHA9e307aWYoaCloPDAmJmMtaSpqPGY/bz15KGMvYmEoaCpwYSktZik6aD4wJiZjK2kqaj5lJiYobz15KChkLWMpL2JhKGgqcGEpKSk7ZWxzZSBpZihkPWMrKDEtaSkqaixjLWkqajxmP2w9YS54K2wqKDEtaSktZjpkPmUmJihsPWUtYS54K2wqaSxtPS0xKSxsPUUoayxsKSxsPGsmJmIubGFiZWxBbGlnbj09PVxuXCJjZW50ZXJcIiYmKGEueCs9bSooay1sLWkqKGstRShqLGwpKSkpLGo+bHx8Yi5hdXRvUm90YXRpb24mJmcuc3R5bGVzLndpZHRoKW89bDtpZihvKXtwLndpZHRoPW87aWYoIWIub3B0aW9ucy5sYWJlbHMuc3R5bGUudGV4dE92ZXJmbG93KXAudGV4dE92ZXJmbG93PVwiZWxsaXBzaXNcIjtnLmNzcyhwKX19LGdldFBvc2l0aW9uOmZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPXRoaXMuYXhpcyxmPWUuY2hhcnQsZz1kJiZmLm9sZENoYXJ0SGVpZ2h0fHxmLmNoYXJ0SGVpZ2h0O3JldHVybnt4OmE/ZS50cmFuc2xhdGUoYitjLG51bGwsbnVsbCxkKStlLnRyYW5zQjplLmxlZnQrZS5vZmZzZXQrKGUub3Bwb3NpdGU/KGQmJmYub2xkQ2hhcnRXaWR0aHx8Zi5jaGFydFdpZHRoKS1lLnJpZ2h0LWUubGVmdDowKSx5OmE/Zy1lLmJvdHRvbStlLm9mZnNldC0oZS5vcHBvc2l0ZT9lLmhlaWdodDowKTpnLWUudHJhbnNsYXRlKGIrYyxudWxsLG51bGwsZCktZS50cmFuc0J9fSxnZXRMYWJlbFBvc2l0aW9uOmZ1bmN0aW9uKGEsXG5iLGMsZCxlLGYsZyxoKXt2YXIgaT10aGlzLmF4aXMsaj1pLnRyYW5zQSxrPWkucmV2ZXJzZWQsbD1pLnN0YWdnZXJMaW5lcyxtPWkudGlja1JvdENvcnJ8fHt4OjAseTowfSxvPWUueTtzKG8pfHwobz1pLnNpZGU9PT0wP2Mucm90YXRpb24/LTg6LWMuZ2V0QkJveCgpLmhlaWdodDppLnNpZGU9PT0yP20ueSs4OmJhKGMucm90YXRpb24qcGEpKihtLnktYy5nZXRCQm94KCExLDApLmhlaWdodC8yKSk7YT1hK2UueCttLngtKGYmJmQ/ZipqKihrPy0xOjEpOjApO2I9YitvLShmJiYhZD9mKmoqKGs/MTotMSk6MCk7bCYmKGM9Zy8oaHx8MSklbCxpLm9wcG9zaXRlJiYoYz1sLWMtMSksYis9YyooaS5sYWJlbE9mZnNldC9sKSk7cmV0dXJue3g6YSx5OnkoYil9fSxnZXRNYXJrUGF0aDpmdW5jdGlvbihhLGIsYyxkLGUsZil7cmV0dXJuIGYuY3Jpc3BMaW5lKFtcIk1cIixhLGIsXCJMXCIsYSsoZT8wOi1jKSxiKyhlP2M6MCldLGQpfSxyZW5kZXI6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXRoaXMuYXhpcyxcbmU9ZC5vcHRpb25zLGY9ZC5jaGFydC5yZW5kZXJlcixnPWQuaG9yaXosaD10aGlzLnR5cGUsaT10aGlzLmxhYmVsLGo9dGhpcy5wb3Msaz1lLmxhYmVscyxsPXRoaXMuZ3JpZExpbmUsbT1oP2grXCJHcmlkXCI6XCJncmlkXCIsbz1oP2grXCJUaWNrXCI6XCJ0aWNrXCIscD1lW20rXCJMaW5lV2lkdGhcIl0scj1lW20rXCJMaW5lQ29sb3JcIl0sQT1lW20rXCJMaW5lRGFzaFN0eWxlXCJdLG09ZC50aWNrU2l6ZShvKSxvPWVbbytcIkNvbG9yXCJdLFA9dGhpcy5tYXJrLHU9ay5zdGVwLHc9ITAsbj1kLnRpY2ttYXJrT2Zmc2V0LFI9dGhpcy5nZXRQb3NpdGlvbihnLGosbixiKSxoYT1SLngsUj1SLnkscz1nJiZoYT09PWQucG9zK2QubGVufHwhZyYmUj09PWQucG9zPy0xOjEsYz1xKGMsMSk7dGhpcy5pc0FjdGl2ZT0hMDtpZihwKXtqPWQuZ2V0UGxvdExpbmVQYXRoKGorbixwKnMsYiwhMCk7aWYobD09PXQpe2w9e3N0cm9rZTpyLFwic3Ryb2tlLXdpZHRoXCI6cH07aWYoQSlsLmRhc2hzdHlsZT1BO2lmKCFoKWwuekluZGV4PVxuMTtpZihiKWwub3BhY2l0eT0wO3RoaXMuZ3JpZExpbmU9bD1wP2YucGF0aChqKS5hdHRyKGwpLmFkZChkLmdyaWRHcm91cCk6bnVsbH1pZighYiYmbCYmailsW3RoaXMuaXNOZXc/XCJhdHRyXCI6XCJhbmltYXRlXCJdKHtkOmosb3BhY2l0eTpjfSl9aWYobSlkLm9wcG9zaXRlJiYobVswXT0tbVswXSksaD10aGlzLmdldE1hcmtQYXRoKGhhLFIsbVswXSxtWzFdKnMsZyxmKSxQP1AuYW5pbWF0ZSh7ZDpoLG9wYWNpdHk6Y30pOnRoaXMubWFyaz1mLnBhdGgoaCkuYXR0cih7c3Ryb2tlOm8sXCJzdHJva2Utd2lkdGhcIjptWzFdLG9wYWNpdHk6Y30pLmFkZChkLmF4aXNHcm91cCk7aWYoaSYmIWlzTmFOKGhhKSlpLnh5PVI9dGhpcy5nZXRMYWJlbFBvc2l0aW9uKGhhLFIsaSxnLGssbixhLHUpLHRoaXMuaXNGaXJzdCYmIXRoaXMuaXNMYXN0JiYhcShlLnNob3dGaXJzdExhYmVsLDEpfHx0aGlzLmlzTGFzdCYmIXRoaXMuaXNGaXJzdCYmIXEoZS5zaG93TGFzdExhYmVsLDEpP3c9ITE6ZyYmIWQuaXNSYWRpYWwmJlxuIWsuc3RlcCYmIWsucm90YXRpb24mJiFiJiZjIT09MCYmdGhpcy5oYW5kbGVPdmVyZmxvdyhSKSx1JiZhJXUmJih3PSExKSx3JiYhaXNOYU4oUi55KT8oUi5vcGFjaXR5PWMsaVt0aGlzLmlzTmV3P1wiYXR0clwiOlwiYW5pbWF0ZVwiXShSKSx0aGlzLmlzTmV3PSExKTppLmF0dHIoXCJ5XCIsLTk5OTkpfSxkZXN0cm95OmZ1bmN0aW9uKCl7UGEodGhpcyx0aGlzLmF4aXMpfX07ei5QbG90TGluZU9yQmFuZD1mdW5jdGlvbihhLGIpe3RoaXMuYXhpcz1hO2lmKGIpdGhpcy5vcHRpb25zPWIsdGhpcy5pZD1iLmlkfTt6LlBsb3RMaW5lT3JCYW5kLnByb3RvdHlwZT17cmVuZGVyOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEuYXhpcyxjPWIuaG9yaXosZD1hLm9wdGlvbnMsZT1kLmxhYmVsLGY9YS5sYWJlbCxnPWQud2lkdGgsaD1kLnRvLGk9ZC5mcm9tLGo9cyhpKSYmcyhoKSxrPWQudmFsdWUsbD1kLmRhc2hTdHlsZSxtPWEuc3ZnRWxlbSxvPVtdLHAscj1kLmNvbG9yLEE9cShkLnpJbmRleCwwKSxuPVxuZC5ldmVudHMsdT17fSx3PWIuY2hhcnQucmVuZGVyZXIsbz1iLmxvZzJsaW47Yi5pc0xvZyYmKGk9byhpKSxoPW8oaCksaz1vKGspKTtpZihnKXtpZihvPWIuZ2V0UGxvdExpbmVQYXRoKGssZyksdT17c3Ryb2tlOnIsXCJzdHJva2Utd2lkdGhcIjpnfSxsKXUuZGFzaHN0eWxlPWx9ZWxzZSBpZihqKXtvPWIuZ2V0UGxvdEJhbmRQYXRoKGksaCxkKTtpZihyKXUuZmlsbD1yO2lmKGQuYm9yZGVyV2lkdGgpdS5zdHJva2U9ZC5ib3JkZXJDb2xvcix1W1wic3Ryb2tlLXdpZHRoXCJdPWQuYm9yZGVyV2lkdGh9ZWxzZSByZXR1cm47dS56SW5kZXg9QTtpZihtKWlmKG8pbS5zaG93KCksbS5hbmltYXRlKHtkOm99KTtlbHNle2lmKG0uaGlkZSgpLGYpYS5sYWJlbD1mPWYuZGVzdHJveSgpfWVsc2UgaWYobyYmby5sZW5ndGgmJihhLnN2Z0VsZW09bT13LnBhdGgobykuYXR0cih1KS5hZGQoKSxuKSlmb3IocCBpbiBkPWZ1bmN0aW9uKGIpe20ub24oYixmdW5jdGlvbihjKXtuW2JdLmFwcGx5KGEsW2NdKX0pfSxcbm4pZChwKTtlJiZzKGUudGV4dCkmJm8mJm8ubGVuZ3RoJiZiLndpZHRoPjAmJmIuaGVpZ2h0PjAmJiFvLmZsYXQ/KGU9Qyh7YWxpZ246YyYmaiYmXCJjZW50ZXJcIix4OmM/IWomJjQ6MTAsdmVydGljYWxBbGlnbjohYyYmaiYmXCJtaWRkbGVcIix5OmM/aj8xNjoxMDpqPzY6LTQscm90YXRpb246YyYmIWomJjkwfSxlKSx0aGlzLnJlbmRlckxhYmVsKGUsbyxqLEEpKTpmJiZmLmhpZGUoKTtyZXR1cm4gYX0scmVuZGVyTGFiZWw6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9dGhpcy5sYWJlbCxmPXRoaXMuYXhpcy5jaGFydC5yZW5kZXJlcjtpZighZSllPXthbGlnbjphLnRleHRBbGlnbnx8YS5hbGlnbixyb3RhdGlvbjphLnJvdGF0aW9ufSxlLnpJbmRleD1kLHRoaXMubGFiZWw9ZT1mLnRleHQoYS50ZXh0LDAsMCxhLnVzZUhUTUwpLmF0dHIoZSkuY3NzKGEuc3R5bGUpLmFkZCgpO2Q9W2JbMV0sYls0XSxjP2JbNl06YlsxXV07Yj1bYlsyXSxiWzVdLGM/Yls3XTpiWzJdXTtjPU9hKGQpO2Y9T2EoYik7XG5lLmFsaWduKGEsITEse3g6Yyx5OmYsd2lkdGg6RWEoZCktYyxoZWlnaHQ6RWEoYiktZn0pO2Uuc2hvdygpfSxkZXN0cm95OmZ1bmN0aW9uKCl7QWEodGhpcy5heGlzLnBsb3RMaW5lc0FuZEJhbmRzLHRoaXMpO2RlbGV0ZSB0aGlzLmF4aXM7UGEodGhpcyl9fTt2YXIgST16LkF4aXM9ZnVuY3Rpb24oKXt0aGlzLmluaXQuYXBwbHkodGhpcyxhcmd1bWVudHMpfTtJLnByb3RvdHlwZT17ZGVmYXVsdE9wdGlvbnM6e2RhdGVUaW1lTGFiZWxGb3JtYXRzOnttaWxsaXNlY29uZDpcIiVIOiVNOiVTLiVMXCIsc2Vjb25kOlwiJUg6JU06JVNcIixtaW51dGU6XCIlSDolTVwiLGhvdXI6XCIlSDolTVwiLGRheTpcIiVlLiAlYlwiLHdlZWs6XCIlZS4gJWJcIixtb250aDpcIiViICcleVwiLHllYXI6XCIlWVwifSxlbmRPblRpY2s6ITEsZ3JpZExpbmVDb2xvcjpcIiNEOEQ4RDhcIixsYWJlbHM6e2VuYWJsZWQ6ITAsc3R5bGU6e2NvbG9yOlwiIzYwNjA2MFwiLGN1cnNvcjpcImRlZmF1bHRcIixmb250U2l6ZTpcIjExcHhcIn0seDowfSxsaW5lQ29sb3I6XCIjQzBEMEUwXCIsXG5saW5lV2lkdGg6MSxtaW5QYWRkaW5nOjAuMDEsbWF4UGFkZGluZzowLjAxLG1pbm9yR3JpZExpbmVDb2xvcjpcIiNFMEUwRTBcIixtaW5vckdyaWRMaW5lV2lkdGg6MSxtaW5vclRpY2tDb2xvcjpcIiNBMEEwQTBcIixtaW5vclRpY2tMZW5ndGg6MixtaW5vclRpY2tQb3NpdGlvbjpcIm91dHNpZGVcIixzdGFydE9mV2VlazoxLHN0YXJ0T25UaWNrOiExLHRpY2tDb2xvcjpcIiNDMEQwRTBcIix0aWNrTGVuZ3RoOjEwLHRpY2ttYXJrUGxhY2VtZW50OlwiYmV0d2VlblwiLHRpY2tQaXhlbEludGVydmFsOjEwMCx0aWNrUG9zaXRpb246XCJvdXRzaWRlXCIsdGl0bGU6e2FsaWduOlwibWlkZGxlXCIsc3R5bGU6e2NvbG9yOlwiIzcwNzA3MFwifX0sdHlwZTpcImxpbmVhclwifSxkZWZhdWx0WUF4aXNPcHRpb25zOntlbmRPblRpY2s6ITAsZ3JpZExpbmVXaWR0aDoxLHRpY2tQaXhlbEludGVydmFsOjcyLHNob3dMYXN0TGFiZWw6ITAsbGFiZWxzOnt4Oi04fSxsaW5lV2lkdGg6MCxtYXhQYWRkaW5nOjAuMDUsbWluUGFkZGluZzowLjA1LFxuc3RhcnRPblRpY2s6ITAsdGl0bGU6e3JvdGF0aW9uOjI3MCx0ZXh0OlwiVmFsdWVzXCJ9LHN0YWNrTGFiZWxzOntlbmFibGVkOiExLGZvcm1hdHRlcjpmdW5jdGlvbigpe3JldHVybiB6Lm51bWJlckZvcm1hdCh0aGlzLnRvdGFsLC0xKX0sc3R5bGU6QyhXLmxpbmUuZGF0YUxhYmVscy5zdHlsZSx7Y29sb3I6XCIjMDAwMDAwXCJ9KX19LGRlZmF1bHRMZWZ0QXhpc09wdGlvbnM6e2xhYmVsczp7eDotMTV9LHRpdGxlOntyb3RhdGlvbjoyNzB9fSxkZWZhdWx0UmlnaHRBeGlzT3B0aW9uczp7bGFiZWxzOnt4OjE1fSx0aXRsZTp7cm90YXRpb246OTB9fSxkZWZhdWx0Qm90dG9tQXhpc09wdGlvbnM6e2xhYmVsczp7YXV0b1JvdGF0aW9uOlstNDVdLHg6MH0sdGl0bGU6e3JvdGF0aW9uOjB9fSxkZWZhdWx0VG9wQXhpc09wdGlvbnM6e2xhYmVsczp7YXV0b1JvdGF0aW9uOlstNDVdLHg6MH0sdGl0bGU6e3JvdGF0aW9uOjB9fSxpbml0OmZ1bmN0aW9uKGEsYil7dmFyIGM9Yi5pc1g7dGhpcy5jaGFydD1cbmE7dGhpcy5ob3Jpej1hLmludmVydGVkPyFjOmM7dGhpcy5jb2xsPSh0aGlzLmlzWEF4aXM9Yyk/XCJ4QXhpc1wiOlwieUF4aXNcIjt0aGlzLm9wcG9zaXRlPWIub3Bwb3NpdGU7dGhpcy5zaWRlPWIuc2lkZXx8KHRoaXMuaG9yaXo/dGhpcy5vcHBvc2l0ZT8wOjI6dGhpcy5vcHBvc2l0ZT8xOjMpO3RoaXMuc2V0T3B0aW9ucyhiKTt2YXIgZD10aGlzLm9wdGlvbnMsZT1kLnR5cGU7dGhpcy5sYWJlbEZvcm1hdHRlcj1kLmxhYmVscy5mb3JtYXR0ZXJ8fHRoaXMuZGVmYXVsdExhYmVsRm9ybWF0dGVyO3RoaXMudXNlck9wdGlvbnM9Yjt0aGlzLm1pblBpeGVsUGFkZGluZz0wO3RoaXMucmV2ZXJzZWQ9ZC5yZXZlcnNlZDt0aGlzLnZpc2libGU9ZC52aXNpYmxlIT09ITE7dGhpcy56b29tRW5hYmxlZD1kLnpvb21FbmFibGVkIT09ITE7dGhpcy5jYXRlZ29yaWVzPWQuY2F0ZWdvcmllc3x8ZT09PVwiY2F0ZWdvcnlcIjt0aGlzLm5hbWVzPXRoaXMubmFtZXN8fFtdO3RoaXMuaXNMb2c9ZT09PVwibG9nYXJpdGhtaWNcIjtcbnRoaXMuaXNEYXRldGltZUF4aXM9ZT09PVwiZGF0ZXRpbWVcIjt0aGlzLmlzTGlua2VkPXMoZC5saW5rZWRUbyk7dGhpcy50aWNrcz17fTt0aGlzLmxhYmVsRWRnZT1bXTt0aGlzLm1pbm9yVGlja3M9e307dGhpcy5wbG90TGluZXNBbmRCYW5kcz1bXTt0aGlzLmFsdGVybmF0ZUJhbmRzPXt9O3RoaXMubGVuPTA7dGhpcy5taW5SYW5nZT10aGlzLnVzZXJNaW5SYW5nZT1kLm1pblJhbmdlfHxkLm1heFpvb207dGhpcy5yYW5nZT1kLnJhbmdlO3RoaXMub2Zmc2V0PWQub2Zmc2V0fHwwO3RoaXMuc3RhY2tzPXt9O3RoaXMub2xkU3RhY2tzPXt9O3RoaXMuc3RhY2tzVG91Y2hlZD0wO3RoaXMubWluPXRoaXMubWF4PW51bGw7dGhpcy5jcm9zc2hhaXI9cShkLmNyb3NzaGFpcix2YShhLm9wdGlvbnMudG9vbHRpcC5jcm9zc2hhaXJzKVtjPzA6MV0sITEpO3ZhciBmLGQ9dGhpcy5vcHRpb25zLmV2ZW50cztzYSh0aGlzLGEuYXhlcyk9PT0tMSYmKGMmJiF0aGlzLmlzQ29sb3JBeGlzP2EuYXhlcy5zcGxpY2UoYS54QXhpcy5sZW5ndGgsXG4wLHRoaXMpOmEuYXhlcy5wdXNoKHRoaXMpLGFbdGhpcy5jb2xsXS5wdXNoKHRoaXMpKTt0aGlzLnNlcmllcz10aGlzLnNlcmllc3x8W107aWYoYS5pbnZlcnRlZCYmYyYmdGhpcy5yZXZlcnNlZD09PXQpdGhpcy5yZXZlcnNlZD0hMDt0aGlzLnJlbW92ZVBsb3RMaW5lPXRoaXMucmVtb3ZlUGxvdEJhbmQ9dGhpcy5yZW1vdmVQbG90QmFuZE9yTGluZTtmb3IoZiBpbiBkKUQodGhpcyxmLGRbZl0pO2lmKHRoaXMuaXNMb2cpdGhpcy52YWwybGluPXRoaXMubG9nMmxpbix0aGlzLmxpbjJ2YWw9dGhpcy5saW4ybG9nfSxzZXRPcHRpb25zOmZ1bmN0aW9uKGEpe3RoaXMub3B0aW9ucz1DKHRoaXMuZGVmYXVsdE9wdGlvbnMsdGhpcy5pc1hBeGlzP3t9OnRoaXMuZGVmYXVsdFlBeGlzT3B0aW9ucyxbdGhpcy5kZWZhdWx0VG9wQXhpc09wdGlvbnMsdGhpcy5kZWZhdWx0UmlnaHRBeGlzT3B0aW9ucyx0aGlzLmRlZmF1bHRCb3R0b21BeGlzT3B0aW9ucyx0aGlzLmRlZmF1bHRMZWZ0QXhpc09wdGlvbnNdW3RoaXMuc2lkZV0sXG5DKE5bdGhpcy5jb2xsXSxhKSl9LGRlZmF1bHRMYWJlbEZvcm1hdHRlcjpmdW5jdGlvbigpe3ZhciBhPXRoaXMuYXhpcyxiPXRoaXMudmFsdWUsYz1hLmNhdGVnb3JpZXMsZD10aGlzLmRhdGVUaW1lTGFiZWxGb3JtYXQsZT1OLmxhbmcubnVtZXJpY1N5bWJvbHMsZj1lJiZlLmxlbmd0aCxnLGg9YS5vcHRpb25zLmxhYmVscy5mb3JtYXQsYT1hLmlzTG9nP2I6YS50aWNrSW50ZXJ2YWw7aWYoaClnPUxhKGgsdGhpcyk7ZWxzZSBpZihjKWc9YjtlbHNlIGlmKGQpZz1tYShkLGIpO2Vsc2UgaWYoZiYmYT49MUUzKWZvcig7Zi0tJiZnPT09dDspYz1NYXRoLnBvdygxRTMsZisxKSxhPj1jJiZiKjEwJWM9PT0wJiZlW2ZdIT09bnVsbCYmKGc9ei5udW1iZXJGb3JtYXQoYi9jLC0xKStlW2ZdKTtnPT09dCYmKGc9UyhiKT49MUU0P3oubnVtYmVyRm9ybWF0KGIsLTEpOnoubnVtYmVyRm9ybWF0KGIsLTEsdCxcIlwiKSk7cmV0dXJuIGd9LGdldFNlcmllc0V4dHJlbWVzOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxcbmI9YS5jaGFydDthLmhhc1Zpc2libGVTZXJpZXM9ITE7YS5kYXRhTWluPWEuZGF0YU1heD1hLnRocmVzaG9sZD1udWxsO2Euc29mdFRocmVzaG9sZD0hYS5pc1hBeGlzO2EuYnVpbGRTdGFja3MmJmEuYnVpbGRTdGFja3MoKTtuKGEuc2VyaWVzLGZ1bmN0aW9uKGMpe2lmKGMudmlzaWJsZXx8IWIub3B0aW9ucy5jaGFydC5pZ25vcmVIaWRkZW5TZXJpZXMpe3ZhciBkPWMub3B0aW9ucyxlPWQudGhyZXNob2xkLGY7YS5oYXNWaXNpYmxlU2VyaWVzPSEwO2EuaXNMb2cmJmU8PTAmJihlPW51bGwpO2lmKGEuaXNYQXhpcyl7aWYoZD1jLnhEYXRhLGQubGVuZ3RoKWEuZGF0YU1pbj1FKHEoYS5kYXRhTWluLGRbMF0pLE9hKGQpKSxhLmRhdGFNYXg9dihxKGEuZGF0YU1heCxkWzBdKSxFYShkKSl9ZWxzZXtjLmdldEV4dHJlbWVzKCk7Zj1jLmRhdGFNYXg7Yz1jLmRhdGFNaW47aWYocyhjKSYmcyhmKSlhLmRhdGFNaW49RShxKGEuZGF0YU1pbixjKSxjKSxhLmRhdGFNYXg9dihxKGEuZGF0YU1heCxcbmYpLGYpO2lmKHMoZSkpYS50aHJlc2hvbGQ9ZTtpZighZC5zb2Z0VGhyZXNob2xkfHxhLmlzTG9nKWEuc29mdFRocmVzaG9sZD0hMX19fSl9LHRyYW5zbGF0ZTpmdW5jdGlvbihhLGIsYyxkLGUsZil7dmFyIGc9dGhpcy5saW5rZWRQYXJlbnR8fHRoaXMsaD0xLGk9MCxqPWQ/Zy5vbGRUcmFuc0E6Zy50cmFuc0EsZD1kP2cub2xkTWluOmcubWluLGs9Zy5taW5QaXhlbFBhZGRpbmcsZT0oZy5pc09yZGluYWx8fGcuaXNCcm9rZW58fGcuaXNMb2cmJmUpJiZnLmxpbjJ2YWw7aWYoIWopaj1nLnRyYW5zQTtpZihjKWgqPS0xLGk9Zy5sZW47Zy5yZXZlcnNlZCYmKGgqPS0xLGktPWgqKGcuc2VjdG9yfHxnLmxlbikpO2I/KGE9YSpoK2ksYS09ayxhPWEvaitkLGUmJihhPWcubGluMnZhbChhKSkpOihlJiYoYT1nLnZhbDJsaW4oYSkpLGY9PT1cImJldHdlZW5cIiYmKGY9MC41KSxhPWgqKGEtZCkqaitpK2gqaysodWEoZik/aipmKmcucG9pbnRSYW5nZTowKSk7cmV0dXJuIGF9LHRvUGl4ZWxzOmZ1bmN0aW9uKGEsXG5iKXtyZXR1cm4gdGhpcy50cmFuc2xhdGUoYSwhMSwhdGhpcy5ob3JpeixudWxsLCEwKSsoYj8wOnRoaXMucG9zKX0sdG9WYWx1ZTpmdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLnRyYW5zbGF0ZShhLShiPzA6dGhpcy5wb3MpLCEwLCF0aGlzLmhvcml6LG51bGwsITApfSxnZXRQbG90TGluZVBhdGg6ZnVuY3Rpb24oYSxiLGMsZCxlKXt2YXIgZj10aGlzLmNoYXJ0LGc9dGhpcy5sZWZ0LGg9dGhpcy50b3AsaSxqLGs9YyYmZi5vbGRDaGFydEhlaWdodHx8Zi5jaGFydEhlaWdodCxsPWMmJmYub2xkQ2hhcnRXaWR0aHx8Zi5jaGFydFdpZHRoLG07aT10aGlzLnRyYW5zQjt2YXIgbz1mdW5jdGlvbihhLGIsYyl7aWYoYTxifHxhPmMpZD9hPUUodihiLGEpLGMpOm09ITA7cmV0dXJuIGF9LGU9cShlLHRoaXMudHJhbnNsYXRlKGEsbnVsbCxudWxsLGMpKSxhPWM9eShlK2kpO2k9aj15KGstZS1pKTtpc05hTihlKT9tPSEwOnRoaXMuaG9yaXo/KGk9aCxqPWstdGhpcy5ib3R0b20sYT1jPW8oYSxcbmcsZyt0aGlzLndpZHRoKSk6KGE9ZyxjPWwtdGhpcy5yaWdodCxpPWo9byhpLGgsaCt0aGlzLmhlaWdodCkpO3JldHVybiBtJiYhZD9udWxsOmYucmVuZGVyZXIuY3Jpc3BMaW5lKFtcIk1cIixhLGksXCJMXCIsYyxqXSxifHwxKX0sZ2V0TGluZWFyVGlja1Bvc2l0aW9uczpmdW5jdGlvbihhLGIsYyl7dmFyIGQsZT1uYShWKGIvYSkqYSksZj1uYShGYShjL2EpKmEpLGc9W107aWYoYj09PWMmJnVhKGIpKXJldHVybltiXTtmb3IoYj1lO2I8PWY7KXtnLnB1c2goYik7Yj1uYShiK2EpO2lmKGI9PT1kKWJyZWFrO2Q9Yn1yZXR1cm4gZ30sZ2V0TWlub3JUaWNrUG9zaXRpb25zOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcHRpb25zLGI9dGhpcy50aWNrUG9zaXRpb25zLGM9dGhpcy5taW5vclRpY2tJbnRlcnZhbCxkPVtdLGUsZj10aGlzLnBvaW50UmFuZ2VQYWRkaW5nfHwwO2U9dGhpcy5taW4tZjt2YXIgZj10aGlzLm1heCtmLGc9Zi1lO2lmKGcmJmcvYzx0aGlzLmxlbi8zKWlmKHRoaXMuaXNMb2cpe2Y9XG5iLmxlbmd0aDtmb3IoZT0xO2U8ZjtlKyspZD1kLmNvbmNhdCh0aGlzLmdldExvZ1RpY2tQb3NpdGlvbnMoYyxiW2UtMV0sYltlXSwhMCkpfWVsc2UgaWYodGhpcy5pc0RhdGV0aW1lQXhpcyYmYS5taW5vclRpY2tJbnRlcnZhbD09PVwiYXV0b1wiKWQ9ZC5jb25jYXQodGhpcy5nZXRUaW1lVGlja3ModGhpcy5ub3JtYWxpemVUaW1lVGlja0ludGVydmFsKGMpLGUsZixhLnN0YXJ0T2ZXZWVrKSk7ZWxzZSBmb3IoYj1lKyhiWzBdLWUpJWM7Yjw9ZjtiKz1jKWQucHVzaChiKTtkLmxlbmd0aCE9PTAmJnRoaXMudHJpbVRpY2tzKGQsYS5zdGFydE9uVGljayxhLmVuZE9uVGljayk7cmV0dXJuIGR9LGFkanVzdEZvck1pblJhbmdlOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcHRpb25zLGI9dGhpcy5taW4sYz10aGlzLm1heCxkLGU9dGhpcy5kYXRhTWF4LXRoaXMuZGF0YU1pbj49dGhpcy5taW5SYW5nZSxmLGcsaCxpLGosaztpZih0aGlzLmlzWEF4aXMmJnRoaXMubWluUmFuZ2U9PT10JiYhdGhpcy5pc0xvZylzKGEubWluKXx8XG5zKGEubWF4KT90aGlzLm1pblJhbmdlPW51bGw6KG4odGhpcy5zZXJpZXMsZnVuY3Rpb24oYSl7aT1hLnhEYXRhO2ZvcihnPWo9YS54SW5jcmVtZW50PzE6aS5sZW5ndGgtMTtnPjA7Zy0tKWlmKGg9aVtnXS1pW2ctMV0sZj09PXR8fGg8ZilmPWh9KSx0aGlzLm1pblJhbmdlPUUoZio1LHRoaXMuZGF0YU1heC10aGlzLmRhdGFNaW4pKTtpZihjLWI8dGhpcy5taW5SYW5nZSl7az10aGlzLm1pblJhbmdlO2Q9KGstYytiKS8yO2Q9W2ItZCxxKGEubWluLGItZCldO2lmKGUpZFsyXT10aGlzLmRhdGFNaW47Yj1FYShkKTtjPVtiK2sscShhLm1heCxiK2spXTtpZihlKWNbMl09dGhpcy5kYXRhTWF4O2M9T2EoYyk7Yy1iPGsmJihkWzBdPWMtayxkWzFdPXEoYS5taW4sYy1rKSxiPUVhKGQpKX10aGlzLm1pbj1iO3RoaXMubWF4PWN9LGdldENsb3Nlc3Q6ZnVuY3Rpb24oKXt2YXIgYTtuKHRoaXMuc2VyaWVzLGZ1bmN0aW9uKGIpe3ZhciBjPWIuY2xvc2VzdFBvaW50UmFuZ2U7IWIubm9TaGFyZWRUb29sdGlwJiZcbnMoYykmJihhPXMoYSk/RShhLGMpOmMpfSk7cmV0dXJuIGF9LHNldEF4aXNUcmFuc2xhdGlvbjpmdW5jdGlvbihhKXt2YXIgYj10aGlzLGM9Yi5tYXgtYi5taW4sZD1iLmF4aXNQb2ludFJhbmdlfHwwLGUsZj0wLGc9MCxoPWIubGlua2VkUGFyZW50LGk9ISFiLmNhdGVnb3JpZXMsaj1iLnRyYW5zQSxrPWIuaXNYQXhpcztpZihrfHxpfHxkKWlmKGg/KGY9aC5taW5Qb2ludE9mZnNldCxnPWgucG9pbnRSYW5nZVBhZGRpbmcpOihlPWIuZ2V0Q2xvc2VzdCgpLG4oYi5zZXJpZXMsZnVuY3Rpb24oYSl7dmFyIGM9aT8xOms/cShhLm9wdGlvbnMucG9pbnRSYW5nZSxlLDApOmIuYXhpc1BvaW50UmFuZ2V8fDAsYT1hLm9wdGlvbnMucG9pbnRQbGFjZW1lbnQ7ZD12KGQsYyk7Yi5zaW5nbGV8fChmPXYoZixEYShhKT8wOmMvMiksZz12KGcsYT09PVwib25cIj8wOmMpKX0pKSxoPWIub3JkaW5hbFNsb3BlJiZlP2Iub3JkaW5hbFNsb3BlL2U6MSxiLm1pblBvaW50T2Zmc2V0PWYqPWgsYi5wb2ludFJhbmdlUGFkZGluZz1cbmcqPWgsYi5wb2ludFJhbmdlPUUoZCxjKSxrKWIuY2xvc2VzdFBvaW50UmFuZ2U9ZTtpZihhKWIub2xkVHJhbnNBPWo7Yi50cmFuc2xhdGlvblNsb3BlPWIudHJhbnNBPWo9Yi5sZW4vKGMrZ3x8MSk7Yi50cmFuc0I9Yi5ob3Jpej9iLmxlZnQ6Yi5ib3R0b207Yi5taW5QaXhlbFBhZGRpbmc9aipmfSxtaW5Gcm9tUmFuZ2U6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tYXgtdGhpcy5yYW5nZX0sc2V0VGlja0ludGVydmFsOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMsYz1iLmNoYXJ0LGQ9Yi5vcHRpb25zLGU9Yi5pc0xvZyxmPWIubG9nMmxpbixnPWIuaXNEYXRldGltZUF4aXMsaD1iLmlzWEF4aXMsaT1iLmlzTGlua2VkLGo9ZC5tYXhQYWRkaW5nLGs9ZC5taW5QYWRkaW5nLGw9ZC50aWNrSW50ZXJ2YWwsbT1kLnRpY2tQaXhlbEludGVydmFsLG89Yi5jYXRlZ29yaWVzLHA9Yi50aHJlc2hvbGQscj1iLnNvZnRUaHJlc2hvbGQsQSxQLHUsdzshZyYmIW8mJiFpJiZ0aGlzLmdldFRpY2tBbW91bnQoKTtcbnU9cShiLnVzZXJNaW4sZC5taW4pO3c9cShiLnVzZXJNYXgsZC5tYXgpO2k/KGIubGlua2VkUGFyZW50PWNbYi5jb2xsXVtkLmxpbmtlZFRvXSxjPWIubGlua2VkUGFyZW50LmdldEV4dHJlbWVzKCksYi5taW49cShjLm1pbixjLmRhdGFNaW4pLGIubWF4PXEoYy5tYXgsYy5kYXRhTWF4KSxkLnR5cGUhPT1iLmxpbmtlZFBhcmVudC5vcHRpb25zLnR5cGUmJmdhKDExLDEpKTooIXImJnMocCkmJihiLmRhdGFNaW4+PXA/KEE9cCxrPTApOmIuZGF0YU1heDw9cCYmKFA9cCxqPTApKSxiLm1pbj1xKHUsQSxiLmRhdGFNaW4pLGIubWF4PXEodyxQLGIuZGF0YU1heCkpO2lmKGUpIWEmJkUoYi5taW4scShiLmRhdGFNaW4sYi5taW4pKTw9MCYmZ2EoMTAsMSksYi5taW49bmEoZihiLm1pbiksMTUpLGIubWF4PW5hKGYoYi5tYXgpLDE1KTtpZihiLnJhbmdlJiZzKGIubWF4KSliLnVzZXJNaW49Yi5taW49dT12KGIubWluLGIubWluRnJvbVJhbmdlKCkpLGIudXNlck1heD13PWIubWF4LGIucmFuZ2U9XG5udWxsO2IuYmVmb3JlUGFkZGluZyYmYi5iZWZvcmVQYWRkaW5nKCk7Yi5hZGp1c3RGb3JNaW5SYW5nZSgpO2lmKCFvJiYhYi5heGlzUG9pbnRSYW5nZSYmIWIudXNlUGVyY2VudGFnZSYmIWkmJnMoYi5taW4pJiZzKGIubWF4KSYmKGY9Yi5tYXgtYi5taW4pKSFzKHUpJiZrJiYoYi5taW4tPWYqayksIXModykmJmomJihiLm1heCs9ZipqKTtpZih1YShkLmZsb29yKSliLm1pbj12KGIubWluLGQuZmxvb3IpO2lmKHVhKGQuY2VpbGluZykpYi5tYXg9RShiLm1heCxkLmNlaWxpbmcpO2lmKHImJnMoYi5kYXRhTWluKSlpZihwPXB8fDAsIXModSkmJmIubWluPHAmJmIuZGF0YU1pbj49cCliLm1pbj1wO2Vsc2UgaWYoIXModykmJmIubWF4PnAmJmIuZGF0YU1heDw9cCliLm1heD1wO2IudGlja0ludGVydmFsPWIubWluPT09Yi5tYXh8fGIubWluPT09dm9pZCAwfHxiLm1heD09PXZvaWQgMD8xOmkmJiFsJiZtPT09Yi5saW5rZWRQYXJlbnQub3B0aW9ucy50aWNrUGl4ZWxJbnRlcnZhbD9sPWIubGlua2VkUGFyZW50LnRpY2tJbnRlcnZhbDpcbnEobCx0aGlzLnRpY2tBbW91bnQ/KGIubWF4LWIubWluKS92KHRoaXMudGlja0Ftb3VudC0xLDEpOnZvaWQgMCxvPzE6KGIubWF4LWIubWluKSptL3YoYi5sZW4sbSkpO2gmJiFhJiZuKGIuc2VyaWVzLGZ1bmN0aW9uKGEpe2EucHJvY2Vzc0RhdGEoYi5taW4hPT1iLm9sZE1pbnx8Yi5tYXghPT1iLm9sZE1heCl9KTtiLnNldEF4aXNUcmFuc2xhdGlvbighMCk7Yi5iZWZvcmVTZXRUaWNrUG9zaXRpb25zJiZiLmJlZm9yZVNldFRpY2tQb3NpdGlvbnMoKTtpZihiLnBvc3RQcm9jZXNzVGlja0ludGVydmFsKWIudGlja0ludGVydmFsPWIucG9zdFByb2Nlc3NUaWNrSW50ZXJ2YWwoYi50aWNrSW50ZXJ2YWwpO2lmKGIucG9pbnRSYW5nZSYmIWwpYi50aWNrSW50ZXJ2YWw9dihiLnBvaW50UmFuZ2UsYi50aWNrSW50ZXJ2YWwpO2E9cShkLm1pblRpY2tJbnRlcnZhbCxiLmlzRGF0ZXRpbWVBeGlzJiZiLmNsb3Nlc3RQb2ludFJhbmdlKTtpZighbCYmYi50aWNrSW50ZXJ2YWw8YSliLnRpY2tJbnRlcnZhbD1cbmE7aWYoIWcmJiFlJiYhbCliLnRpY2tJbnRlcnZhbD1CYihiLnRpY2tJbnRlcnZhbCxudWxsLEFiKGIudGlja0ludGVydmFsKSxxKGQuYWxsb3dEZWNpbWFscywhKGIudGlja0ludGVydmFsPjAuNSYmYi50aWNrSW50ZXJ2YWw8NSYmYi5tYXg+MUUzJiZiLm1heDw5OTk5KSksISF0aGlzLnRpY2tBbW91bnQpO2lmKCF0aGlzLnRpY2tBbW91bnQmJnRoaXMubGVuKWIudGlja0ludGVydmFsPWIudW5zcXVpc2goKTt0aGlzLnNldFRpY2tQb3NpdGlvbnMoKX0sc2V0VGlja1Bvc2l0aW9uczpmdW5jdGlvbigpe3ZhciBhPXRoaXMub3B0aW9ucyxiLGM9YS50aWNrUG9zaXRpb25zLGQ9YS50aWNrUG9zaXRpb25lcixlPWEuc3RhcnRPblRpY2ssZj1hLmVuZE9uVGljayxnO3RoaXMudGlja21hcmtPZmZzZXQ9dGhpcy5jYXRlZ29yaWVzJiZhLnRpY2ttYXJrUGxhY2VtZW50PT09XCJiZXR3ZWVuXCImJnRoaXMudGlja0ludGVydmFsPT09MT8wLjU6MDt0aGlzLm1pbm9yVGlja0ludGVydmFsPWEubWlub3JUaWNrSW50ZXJ2YWw9PT1cblwiYXV0b1wiJiZ0aGlzLnRpY2tJbnRlcnZhbD90aGlzLnRpY2tJbnRlcnZhbC81OmEubWlub3JUaWNrSW50ZXJ2YWw7dGhpcy50aWNrUG9zaXRpb25zPWI9YyYmYy5zbGljZSgpO2lmKCFiJiYoYj10aGlzLmlzRGF0ZXRpbWVBeGlzP3RoaXMuZ2V0VGltZVRpY2tzKHRoaXMubm9ybWFsaXplVGltZVRpY2tJbnRlcnZhbCh0aGlzLnRpY2tJbnRlcnZhbCxhLnVuaXRzKSx0aGlzLm1pbix0aGlzLm1heCxhLnN0YXJ0T2ZXZWVrLHRoaXMub3JkaW5hbFBvc2l0aW9ucyx0aGlzLmNsb3Nlc3RQb2ludFJhbmdlLCEwKTp0aGlzLmlzTG9nP3RoaXMuZ2V0TG9nVGlja1Bvc2l0aW9ucyh0aGlzLnRpY2tJbnRlcnZhbCx0aGlzLm1pbix0aGlzLm1heCk6dGhpcy5nZXRMaW5lYXJUaWNrUG9zaXRpb25zKHRoaXMudGlja0ludGVydmFsLHRoaXMubWluLHRoaXMubWF4KSxiLmxlbmd0aD50aGlzLmxlbiYmKGI9W2JbMF0sYi5wb3AoKV0pLHRoaXMudGlja1Bvc2l0aW9ucz1iLGQmJihkPWQuYXBwbHkodGhpcyxcblt0aGlzLm1pbix0aGlzLm1heF0pKSkpdGhpcy50aWNrUG9zaXRpb25zPWI9ZDtpZighdGhpcy5pc0xpbmtlZCl0aGlzLnRyaW1UaWNrcyhiLGUsZiksdGhpcy5taW49PT10aGlzLm1heCYmcyh0aGlzLm1pbikmJiF0aGlzLnRpY2tBbW91bnQmJihnPSEwLHRoaXMubWluLT0wLjUsdGhpcy5tYXgrPTAuNSksdGhpcy5zaW5nbGU9ZywhYyYmIWQmJnRoaXMuYWRqdXN0VGlja0Ftb3VudCgpfSx0cmltVGlja3M6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPWFbMF0sZT1hW2EubGVuZ3RoLTFdLGY9dGhpcy5taW5Qb2ludE9mZnNldHx8MDtpZihiKXRoaXMubWluPWQ7ZWxzZSBmb3IoO3RoaXMubWluLWY+YVswXTspYS5zaGlmdCgpO2lmKGMpdGhpcy5tYXg9ZTtlbHNlIGZvcig7dGhpcy5tYXgrZjxhW2EubGVuZ3RoLTFdOylhLnBvcCgpO2EubGVuZ3RoPT09MCYmcyhkKSYmYS5wdXNoKChlK2QpLzIpfSxhbGlnblRvT3RoZXJzOmZ1bmN0aW9uKCl7dmFyIGE9e30sYixjPXRoaXMub3B0aW9uczt0aGlzLmNoYXJ0Lm9wdGlvbnMuY2hhcnQuYWxpZ25UaWNrcyE9PVxuITEmJmMuYWxpZ25UaWNrcyE9PSExJiZuKHRoaXMuY2hhcnRbdGhpcy5jb2xsXSxmdW5jdGlvbihjKXt2YXIgZT1jLm9wdGlvbnMsZT1bYy5ob3Jpej9lLmxlZnQ6ZS50b3AsZS53aWR0aCxlLmhlaWdodCxlLnBhbmVdLmpvaW4oXCIsXCIpO2Muc2VyaWVzLmxlbmd0aCYmKGFbZV0/Yj0hMDphW2VdPTEpfSk7cmV0dXJuIGJ9LGdldFRpY2tBbW91bnQ6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9wdGlvbnMsYj1hLnRpY2tBbW91bnQsYz1hLnRpY2tQaXhlbEludGVydmFsOyFzKGEudGlja0ludGVydmFsKSYmdGhpcy5sZW48YyYmIXRoaXMuaXNSYWRpYWwmJiF0aGlzLmlzTG9nJiZhLnN0YXJ0T25UaWNrJiZhLmVuZE9uVGljayYmKGI9Mik7IWImJnRoaXMuYWxpZ25Ub090aGVycygpJiYoYj1GYSh0aGlzLmxlbi9jKSsxKTtpZihiPDQpdGhpcy5maW5hbFRpY2tBbXQ9YixiPTU7dGhpcy50aWNrQW1vdW50PWJ9LGFkanVzdFRpY2tBbW91bnQ6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLnRpY2tJbnRlcnZhbCxcbmI9dGhpcy50aWNrUG9zaXRpb25zLGM9dGhpcy50aWNrQW1vdW50LGQ9dGhpcy5maW5hbFRpY2tBbXQsZT1iJiZiLmxlbmd0aDtpZihlPGMpe2Zvcig7Yi5sZW5ndGg8YzspYi5wdXNoKG5hKGJbYi5sZW5ndGgtMV0rYSkpO3RoaXMudHJhbnNBKj0oZS0xKS8oYy0xKTt0aGlzLm1heD1iW2IubGVuZ3RoLTFdfWVsc2UgZT5jJiYodGhpcy50aWNrSW50ZXJ2YWwqPTIsdGhpcy5zZXRUaWNrUG9zaXRpb25zKCkpO2lmKHMoZCkpe2ZvcihhPWM9Yi5sZW5ndGg7YS0tOykoZD09PTMmJmElMj09PTF8fGQ8PTImJmE+MCYmYTxjLTEpJiZiLnNwbGljZShhLDEpO3RoaXMuZmluYWxUaWNrQW10PXR9fSxzZXRTY2FsZTpmdW5jdGlvbigpe3ZhciBhLGI7dGhpcy5vbGRNaW49dGhpcy5taW47dGhpcy5vbGRNYXg9dGhpcy5tYXg7dGhpcy5vbGRBeGlzTGVuZ3RoPXRoaXMubGVuO3RoaXMuc2V0QXhpc1NpemUoKTtiPXRoaXMubGVuIT09dGhpcy5vbGRBeGlzTGVuZ3RoO24odGhpcy5zZXJpZXMsZnVuY3Rpb24oYil7aWYoYi5pc0RpcnR5RGF0YXx8XG5iLmlzRGlydHl8fGIueEF4aXMuaXNEaXJ0eSlhPSEwfSk7aWYoYnx8YXx8dGhpcy5pc0xpbmtlZHx8dGhpcy5mb3JjZVJlZHJhd3x8dGhpcy51c2VyTWluIT09dGhpcy5vbGRVc2VyTWlufHx0aGlzLnVzZXJNYXghPT10aGlzLm9sZFVzZXJNYXh8fHRoaXMuYWxpZ25Ub090aGVycygpKXtpZih0aGlzLnJlc2V0U3RhY2tzJiZ0aGlzLnJlc2V0U3RhY2tzKCksdGhpcy5mb3JjZVJlZHJhdz0hMSx0aGlzLmdldFNlcmllc0V4dHJlbWVzKCksdGhpcy5zZXRUaWNrSW50ZXJ2YWwoKSx0aGlzLm9sZFVzZXJNaW49dGhpcy51c2VyTWluLHRoaXMub2xkVXNlck1heD10aGlzLnVzZXJNYXgsIXRoaXMuaXNEaXJ0eSl0aGlzLmlzRGlydHk9Ynx8dGhpcy5taW4hPT10aGlzLm9sZE1pbnx8dGhpcy5tYXghPT10aGlzLm9sZE1heH1lbHNlIHRoaXMuY2xlYW5TdGFja3MmJnRoaXMuY2xlYW5TdGFja3MoKX0sc2V0RXh0cmVtZXM6ZnVuY3Rpb24oYSxiLGMsZCxlKXt2YXIgZj10aGlzLGc9Zi5jaGFydCxcbmM9cShjLCEwKTtuKGYuc2VyaWVzLGZ1bmN0aW9uKGEpe2RlbGV0ZSBhLmtkVHJlZX0pO2U9eChlLHttaW46YSxtYXg6Yn0pO00oZixcInNldEV4dHJlbWVzXCIsZSxmdW5jdGlvbigpe2YudXNlck1pbj1hO2YudXNlck1heD1iO2YuZXZlbnRBcmdzPWU7YyYmZy5yZWRyYXcoZCl9KX0sem9vbTpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuZGF0YU1pbixkPXRoaXMuZGF0YU1heCxlPXRoaXMub3B0aW9ucyxmPUUoYyxxKGUubWluLGMpKSxlPXYoZCxxKGUubWF4LGQpKTt0aGlzLmFsbG93Wm9vbU91dHNpZGV8fChzKGMpJiZhPD1mJiYoYT1mKSxzKGQpJiZiPj1lJiYoYj1lKSk7dGhpcy5kaXNwbGF5QnRuPWEhPT10fHxiIT09dDt0aGlzLnNldEV4dHJlbWVzKGEsYiwhMSx0LHt0cmlnZ2VyOlwiem9vbVwifSk7cmV0dXJuITB9LHNldEF4aXNTaXplOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5jaGFydCxiPXRoaXMub3B0aW9ucyxjPWIub2Zmc2V0TGVmdHx8MCxkPXRoaXMuaG9yaXosZT1xKGIud2lkdGgsXG5hLnBsb3RXaWR0aC1jKyhiLm9mZnNldFJpZ2h0fHwwKSksZj1xKGIuaGVpZ2h0LGEucGxvdEhlaWdodCksZz1xKGIudG9wLGEucGxvdFRvcCksYj1xKGIubGVmdCxhLnBsb3RMZWZ0K2MpLGM9LyUkLztjLnRlc3QoZikmJihmPU1hdGgucm91bmQocGFyc2VGbG9hdChmKS8xMDAqYS5wbG90SGVpZ2h0KSk7Yy50ZXN0KGcpJiYoZz1NYXRoLnJvdW5kKHBhcnNlRmxvYXQoZykvMTAwKmEucGxvdEhlaWdodCthLnBsb3RUb3ApKTt0aGlzLmxlZnQ9Yjt0aGlzLnRvcD1nO3RoaXMud2lkdGg9ZTt0aGlzLmhlaWdodD1mO3RoaXMuYm90dG9tPWEuY2hhcnRIZWlnaHQtZi1nO3RoaXMucmlnaHQ9YS5jaGFydFdpZHRoLWUtYjt0aGlzLmxlbj12KGQ/ZTpmLDApO3RoaXMucG9zPWQ/YjpnfSxnZXRFeHRyZW1lczpmdW5jdGlvbigpe3ZhciBhPXRoaXMuaXNMb2csYj10aGlzLmxpbjJsb2c7cmV0dXJue21pbjphP25hKGIodGhpcy5taW4pKTp0aGlzLm1pbixtYXg6YT9uYShiKHRoaXMubWF4KSk6dGhpcy5tYXgsXG5kYXRhTWluOnRoaXMuZGF0YU1pbixkYXRhTWF4OnRoaXMuZGF0YU1heCx1c2VyTWluOnRoaXMudXNlck1pbix1c2VyTWF4OnRoaXMudXNlck1heH19LGdldFRocmVzaG9sZDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmlzTG9nLGM9dGhpcy5saW4ybG9nLGQ9Yj9jKHRoaXMubWluKTp0aGlzLm1pbixiPWI/Yyh0aGlzLm1heCk6dGhpcy5tYXg7YT09PW51bGw/YT1iPDA/YjpkOmQ+YT9hPWQ6YjxhJiYoYT1iKTtyZXR1cm4gdGhpcy50cmFuc2xhdGUoYSwwLDEsMCwxKX0sYXV0b0xhYmVsQWxpZ246ZnVuY3Rpb24oYSl7YT0ocShhLDApLXRoaXMuc2lkZSo5MCs3MjApJTM2MDtyZXR1cm4gYT4xNSYmYTwxNjU/XCJyaWdodFwiOmE+MTk1JiZhPDM0NT9cImxlZnRcIjpcImNlbnRlclwifSx0aWNrU2l6ZTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLm9wdGlvbnMsYz1iW2ErXCJMZW5ndGhcIl0sZD1xKGJbYStcIldpZHRoXCJdLGE9PT1cInRpY2tcIiYmdGhpcy5pc1hBeGlzPzE6MCk7aWYoZCYmYylyZXR1cm4gYlthK1xuXCJQb3NpdGlvblwiXT09PVwiaW5zaWRlXCImJihjPS1jKSxbYyxkXX0sbGFiZWxNZXRyaWNzOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY2hhcnQucmVuZGVyZXIuZm9udE1ldHJpY3ModGhpcy5vcHRpb25zLmxhYmVscy5zdHlsZS5mb250U2l6ZSx0aGlzLnRpY2tzWzBdJiZ0aGlzLnRpY2tzWzBdLmxhYmVsKX0sdW5zcXVpc2g6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9wdGlvbnMubGFiZWxzLGI9dGhpcy5ob3JpeixjPXRoaXMudGlja0ludGVydmFsLGQ9YyxlPXRoaXMubGVuLygoKHRoaXMuY2F0ZWdvcmllcz8xOjApK3RoaXMubWF4LXRoaXMubWluKS9jKSxmLGc9YS5yb3RhdGlvbixoPXRoaXMubGFiZWxNZXRyaWNzKCksaSxqPU51bWJlci5NQVhfVkFMVUUsayxsPWZ1bmN0aW9uKGEpe2EvPWV8fDE7YT1hPjE/RmEoYSk6MTtyZXR1cm4gYSpjfTtiPyhrPSFhLnN0YWdnZXJMaW5lcyYmIWEuc3RlcCYmKHMoZyk/W2ddOmU8cShhLmF1dG9Sb3RhdGlvbkxpbWl0LDgwKSYmYS5hdXRvUm90YXRpb24pKSYmXG5uKGssZnVuY3Rpb24oYSl7dmFyIGI7aWYoYT09PWd8fGEmJmE+PS05MCYmYTw9OTApaT1sKFMoaC5oL2thKHBhKmEpKSksYj1pK1MoYS8zNjApLGI8aiYmKGo9YixmPWEsZD1pKX0pOmEuc3RlcHx8KGQ9bChoLmgpKTt0aGlzLmF1dG9Sb3RhdGlvbj1rO3RoaXMubGFiZWxSb3RhdGlvbj1xKGYsZyk7cmV0dXJuIGR9LGdldFNsb3RXaWR0aDpmdW5jdGlvbigpe3ZhciBhPXRoaXMuY2hhcnQsYj10aGlzLmhvcml6LGM9dGhpcy5vcHRpb25zLmxhYmVscyxkPU1hdGgubWF4KHRoaXMudGlja1Bvc2l0aW9ucy5sZW5ndGgtKHRoaXMuY2F0ZWdvcmllcz8wOjEpLDEpLGU9YS5tYXJnaW5bM107cmV0dXJuIGImJihjLnN0ZXB8fDApPDImJiFjLnJvdGF0aW9uJiYodGhpcy5zdGFnZ2VyTGluZXN8fDEpKmEucGxvdFdpZHRoL2R8fCFiJiYoZSYmZS1hLnNwYWNpbmdbM118fGEuY2hhcnRXaWR0aCowLjMzKX0scmVuZGVyVW5zcXVpc2g6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmNoYXJ0LGI9YS5yZW5kZXJlcixcbmM9dGhpcy50aWNrUG9zaXRpb25zLGQ9dGhpcy50aWNrcyxlPXRoaXMub3B0aW9ucy5sYWJlbHMsZj10aGlzLmhvcml6LGc9dGhpcy5nZXRTbG90V2lkdGgoKSxoPXYoMSx5KGctMiooZS5wYWRkaW5nfHw1KSkpLGk9e30saj10aGlzLmxhYmVsTWV0cmljcygpLGs9ZS5zdHlsZS50ZXh0T3ZlcmZsb3csbCxtPTAsbyxwO2lmKCFEYShlLnJvdGF0aW9uKSlpLnJvdGF0aW9uPWUucm90YXRpb258fDA7aWYodGhpcy5hdXRvUm90YXRpb24pbihjLGZ1bmN0aW9uKGEpe2lmKChhPWRbYV0pJiZhLmxhYmVsTGVuZ3RoPm0pbT1hLmxhYmVsTGVuZ3RofSksbT5oJiZtPmouaD9pLnJvdGF0aW9uPXRoaXMubGFiZWxSb3RhdGlvbjp0aGlzLmxhYmVsUm90YXRpb249MDtlbHNlIGlmKGcmJihsPXt3aWR0aDpoK1wicHhcIn0sIWspKXtsLnRleHRPdmVyZmxvdz1cImNsaXBcIjtmb3Iobz1jLmxlbmd0aDshZiYmby0tOylpZihwPWNbb10saD1kW3BdLmxhYmVsKWlmKGguc3R5bGVzLnRleHRPdmVyZmxvdz09PVwiZWxsaXBzaXNcIj9cbmguY3NzKHt0ZXh0T3ZlcmZsb3c6XCJjbGlwXCJ9KTpkW3BdLmxhYmVsTGVuZ3RoPmcmJmguY3NzKHt3aWR0aDpnK1wicHhcIn0pLGguZ2V0QkJveCgpLmhlaWdodD50aGlzLmxlbi9jLmxlbmd0aC0oai5oLWouZikpaC5zcGVjQ3NzPXt0ZXh0T3ZlcmZsb3c6XCJlbGxpcHNpc1wifX1pZihpLnJvdGF0aW9uJiYobD17d2lkdGg6KG0+YS5jaGFydEhlaWdodCowLjU/YS5jaGFydEhlaWdodCowLjMzOmEuY2hhcnRIZWlnaHQpK1wicHhcIn0sIWspKWwudGV4dE92ZXJmbG93PVwiZWxsaXBzaXNcIjtpZih0aGlzLmxhYmVsQWxpZ249ZS5hbGlnbnx8dGhpcy5hdXRvTGFiZWxBbGlnbih0aGlzLmxhYmVsUm90YXRpb24pKWkuYWxpZ249dGhpcy5sYWJlbEFsaWduO24oYyxmdW5jdGlvbihhKXt2YXIgYj0oYT1kW2FdKSYmYS5sYWJlbDtpZihiKWIuYXR0cihpKSxsJiZiLmNzcyhDKGwsYi5zcGVjQ3NzKSksZGVsZXRlIGIuc3BlY0NzcyxhLnJvdGF0aW9uPWkucm90YXRpb259KTt0aGlzLnRpY2tSb3RDb3JyPWIucm90Q29ycihqLmIsXG50aGlzLmxhYmVsUm90YXRpb258fDAsdGhpcy5zaWRlIT09MCl9LGhhc0RhdGE6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5oYXNWaXNpYmxlU2VyaWVzfHxzKHRoaXMubWluKSYmcyh0aGlzLm1heCkmJiEhdGhpcy50aWNrUG9zaXRpb25zfSxnZXRPZmZzZXQ6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5jaGFydCxjPWIucmVuZGVyZXIsZD1hLm9wdGlvbnMsZT1hLnRpY2tQb3NpdGlvbnMsZj1hLnRpY2tzLGc9YS5ob3JpeixoPWEuc2lkZSxpPWIuaW52ZXJ0ZWQ/WzEsMCwzLDJdW2hdOmgsaixrLGw9MCxtLG89MCxwPWQudGl0bGUscj1kLmxhYmVscyxBPTAsUD1hLm9wcG9zaXRlLHU9Yi5heGlzT2Zmc2V0LGI9Yi5jbGlwT2Zmc2V0LHc9Wy0xLDEsMSwtMV1baF0sTyxSPWEuYXhpc1BhcmVudCxoYT10aGlzLnRpY2tTaXplKFwidGlja1wiKTtqPWEuaGFzRGF0YSgpO2Euc2hvd0F4aXM9az1qfHxxKGQuc2hvd0VtcHR5LCEwKTthLnN0YWdnZXJMaW5lcz1hLmhvcml6JiZyLnN0YWdnZXJMaW5lcztcbmlmKCFhLmF4aXNHcm91cClhLmdyaWRHcm91cD1jLmcoXCJncmlkXCIpLmF0dHIoe3pJbmRleDpkLmdyaWRaSW5kZXh8fDF9KS5hZGQoUiksYS5heGlzR3JvdXA9Yy5nKFwiYXhpc1wiKS5hdHRyKHt6SW5kZXg6ZC56SW5kZXh8fDJ9KS5hZGQoUiksYS5sYWJlbEdyb3VwPWMuZyhcImF4aXMtbGFiZWxzXCIpLmF0dHIoe3pJbmRleDpyLnpJbmRleHx8N30pLmFkZENsYXNzKFwiaGlnaGNoYXJ0cy1cIithLmNvbGwudG9Mb3dlckNhc2UoKStcIi1sYWJlbHNcIikuYWRkKFIpO2lmKGp8fGEuaXNMaW5rZWQpe2lmKG4oZSxmdW5jdGlvbihiKXtmW2JdP2ZbYl0uYWRkTGFiZWwoKTpmW2JdPW5ldyBjYihhLGIpfSksYS5yZW5kZXJVbnNxdWlzaCgpLHIucmVzZXJ2ZVNwYWNlIT09ITEmJihoPT09MHx8aD09PTJ8fHsxOlwibGVmdFwiLDM6XCJyaWdodFwifVtoXT09PWEubGFiZWxBbGlnbnx8YS5sYWJlbEFsaWduPT09XCJjZW50ZXJcIikmJm4oZSxmdW5jdGlvbihhKXtBPXYoZlthXS5nZXRMYWJlbFNpemUoKSxBKX0pLGEuc3RhZ2dlckxpbmVzKUEqPVxuYS5zdGFnZ2VyTGluZXMsYS5sYWJlbE9mZnNldD1BKihhLm9wcG9zaXRlPy0xOjEpfWVsc2UgZm9yKE8gaW4gZilmW09dLmRlc3Ryb3koKSxkZWxldGUgZltPXTtpZihwJiZwLnRleHQmJnAuZW5hYmxlZCE9PSExKXtpZighYS5heGlzVGl0bGUpYS5heGlzVGl0bGU9Yy50ZXh0KHAudGV4dCwwLDAscC51c2VIVE1MKS5hdHRyKHt6SW5kZXg6Nyxyb3RhdGlvbjpwLnJvdGF0aW9ufHwwLGFsaWduOnAudGV4dEFsaWdufHx7bG93OlA/XCJyaWdodFwiOlwibGVmdFwiLG1pZGRsZTpcImNlbnRlclwiLGhpZ2g6UD9cImxlZnRcIjpcInJpZ2h0XCJ9W3AuYWxpZ25dfSkuYWRkQ2xhc3MoXCJoaWdoY2hhcnRzLVwiK3RoaXMuY29sbC50b0xvd2VyQ2FzZSgpK1wiLXRpdGxlXCIpLmNzcyhwLnN0eWxlKS5hZGQoYS5heGlzR3JvdXApLGEuYXhpc1RpdGxlLmlzTmV3PSEwO2lmKGspbD1hLmF4aXNUaXRsZS5nZXRCQm94KClbZz9cImhlaWdodFwiOlwid2lkdGhcIl0sbT1wLm9mZnNldCxvPXMobSk/MDpxKHAubWFyZ2luLGc/NToxMCk7XG5hLmF4aXNUaXRsZVtrP1wic2hvd1wiOlwiaGlkZVwiXSghMCl9YS5vZmZzZXQ9dypxKGQub2Zmc2V0LHVbaF0pO2EudGlja1JvdENvcnI9YS50aWNrUm90Q29ycnx8e3g6MCx5OjB9O2M9aD09PTA/LWEubGFiZWxNZXRyaWNzKCkuaDpoPT09Mj9hLnRpY2tSb3RDb3JyLnk6MDtvPU1hdGguYWJzKEEpK287QSYmKG8tPWMsbys9dyooZz9xKHIueSxhLnRpY2tSb3RDb3JyLnkrdyo4KTpyLngpKTthLmF4aXNUaXRsZU1hcmdpbj1xKG0sbyk7dVtoXT12KHVbaF0sYS5heGlzVGl0bGVNYXJnaW4rbCt3KmEub2Zmc2V0LG8saiYmZS5sZW5ndGgmJmhhP2hhWzBdOjApO2Q9ZC5vZmZzZXQ/MDpWKGQubGluZVdpZHRoLzIpKjI7YltpXT12KGJbaV0sZCl9LGdldExpbmVQYXRoOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY2hhcnQsYz10aGlzLm9wcG9zaXRlLGQ9dGhpcy5vZmZzZXQsZT10aGlzLmhvcml6LGY9dGhpcy5sZWZ0KyhjP3RoaXMud2lkdGg6MCkrZCxkPWIuY2hhcnRIZWlnaHQtdGhpcy5ib3R0b20tXG4oYz90aGlzLmhlaWdodDowKStkO2MmJihhKj0tMSk7cmV0dXJuIGIucmVuZGVyZXIuY3Jpc3BMaW5lKFtcIk1cIixlP3RoaXMubGVmdDpmLGU/ZDp0aGlzLnRvcCxcIkxcIixlP2IuY2hhcnRXaWR0aC10aGlzLnJpZ2h0OmYsZT9kOmIuY2hhcnRIZWlnaHQtdGhpcy5ib3R0b21dLGEpfSxnZXRUaXRsZVBvc2l0aW9uOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5ob3JpeixiPXRoaXMubGVmdCxjPXRoaXMudG9wLGQ9dGhpcy5sZW4sZT10aGlzLm9wdGlvbnMudGl0bGUsZj1hP2I6YyxnPXRoaXMub3Bwb3NpdGUsaD10aGlzLm9mZnNldCxpPWUueHx8MCxqPWUueXx8MCxrPUcoZS5zdHlsZS5mb250U2l6ZXx8MTIpLGQ9e2xvdzpmKyhhPzA6ZCksbWlkZGxlOmYrZC8yLGhpZ2g6ZisoYT9kOjApfVtlLmFsaWduXSxiPShhP2MrdGhpcy5oZWlnaHQ6YikrKGE/MTotMSkqKGc/LTE6MSkqdGhpcy5heGlzVGl0bGVNYXJnaW4rKHRoaXMuc2lkZT09PTI/azowKTtyZXR1cm57eDphP2QraTpiKyhnP3RoaXMud2lkdGg6XG4wKStoK2kseTphP2Irai0oZz90aGlzLmhlaWdodDowKStoOmQran19LHJlbmRlcjpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLmNoYXJ0LGM9Yi5yZW5kZXJlcixkPWEub3B0aW9ucyxlPWEuaXNMb2csZj1hLmxpbjJsb2csZz1hLmlzTGlua2VkLGg9YS50aWNrUG9zaXRpb25zLGk9YS5heGlzVGl0bGUsaj1hLnRpY2tzLGs9YS5taW5vclRpY2tzLGw9YS5hbHRlcm5hdGVCYW5kcyxtPWQuc3RhY2tMYWJlbHMsbz1kLmFsdGVybmF0ZUdyaWRDb2xvcixwPWEudGlja21hcmtPZmZzZXQscj1kLmxpbmVXaWR0aCxBLHE9Yi5oYXNSZW5kZXJlZCYmcyhhLm9sZE1pbikmJiFpc05hTihhLm9sZE1pbiksdT1hLnNob3dBeGlzLHc9aGIoYy5nbG9iYWxBbmltYXRpb24pLE8sUjthLmxhYmVsRWRnZS5sZW5ndGg9MDthLm92ZXJsYXA9ITE7bihbaixrLGxdLGZ1bmN0aW9uKGEpe2Zvcih2YXIgYiBpbiBhKWFbYl0uaXNBY3RpdmU9ITF9KTtpZihhLmhhc0RhdGEoKXx8Zyl7YS5taW5vclRpY2tJbnRlcnZhbCYmXG4hYS5jYXRlZ29yaWVzJiZuKGEuZ2V0TWlub3JUaWNrUG9zaXRpb25zKCksZnVuY3Rpb24oYil7a1tiXXx8KGtbYl09bmV3IGNiKGEsYixcIm1pbm9yXCIpKTtxJiZrW2JdLmlzTmV3JiZrW2JdLnJlbmRlcihudWxsLCEwKTtrW2JdLnJlbmRlcihudWxsLCExLDEpfSk7aWYoaC5sZW5ndGgmJihuKGgsZnVuY3Rpb24oYixjKXtpZighZ3x8Yj49YS5taW4mJmI8PWEubWF4KWpbYl18fChqW2JdPW5ldyBjYihhLGIpKSxxJiZqW2JdLmlzTmV3JiZqW2JdLnJlbmRlcihjLCEwLDAuMSksaltiXS5yZW5kZXIoYyl9KSxwJiYoYS5taW49PT0wfHxhLnNpbmdsZSkpKWpbLTFdfHwoalstMV09bmV3IGNiKGEsLTEsbnVsbCwhMCkpLGpbLTFdLnJlbmRlcigtMSk7byYmbihoLGZ1bmN0aW9uKGMsZCl7Uj1oW2QrMV0hPT10P2hbZCsxXStwOmEubWF4LXA7aWYoZCUyPT09MCYmYzxhLm1heCYmUjw9YS5tYXgrKGIucG9sYXI/LXA6cCkpbFtjXXx8KGxbY109bmV3IHouUGxvdExpbmVPckJhbmQoYSkpLE89YytcbnAsbFtjXS5vcHRpb25zPXtmcm9tOmU/ZihPKTpPLHRvOmU/ZihSKTpSLGNvbG9yOm99LGxbY10ucmVuZGVyKCksbFtjXS5pc0FjdGl2ZT0hMH0pO2lmKCFhLl9hZGRlZFBsb3RMQiluKChkLnBsb3RMaW5lc3x8W10pLmNvbmNhdChkLnBsb3RCYW5kc3x8W10pLGZ1bmN0aW9uKGIpe2EuYWRkUGxvdEJhbmRPckxpbmUoYil9KSxhLl9hZGRlZFBsb3RMQj0hMH1uKFtqLGssbF0sZnVuY3Rpb24oYSl7dmFyIGMsZCxlPVtdLGY9dy5kdXJhdGlvbjtmb3IoYyBpbiBhKWlmKCFhW2NdLmlzQWN0aXZlKWFbY10ucmVuZGVyKGMsITEsMCksYVtjXS5pc0FjdGl2ZT0hMSxlLnB1c2goYyk7JGEoZnVuY3Rpb24oKXtmb3IoZD1lLmxlbmd0aDtkLS07KWFbZVtkXV0mJiFhW2VbZF1dLmlzQWN0aXZlJiYoYVtlW2RdXS5kZXN0cm95KCksZGVsZXRlIGFbZVtkXV0pfSxhPT09bHx8IWIuaGFzUmVuZGVyZWR8fCFmPzA6Zil9KTtpZihyKUE9YS5nZXRMaW5lUGF0aChyKSxhLmF4aXNMaW5lP2EuYXhpc0xpbmUuYW5pbWF0ZSh7ZDpBfSk6XG5hLmF4aXNMaW5lPWMucGF0aChBKS5hdHRyKHtzdHJva2U6ZC5saW5lQ29sb3IsXCJzdHJva2Utd2lkdGhcIjpyLHpJbmRleDo3fSkuYWRkKGEuYXhpc0dyb3VwKSxhLmF4aXNMaW5lW3U/XCJzaG93XCI6XCJoaWRlXCJdKCEwKTtpZihpJiZ1KWlbaS5pc05ldz9cImF0dHJcIjpcImFuaW1hdGVcIl0oYS5nZXRUaXRsZVBvc2l0aW9uKCkpLGkuaXNOZXc9ITE7bSYmbS5lbmFibGVkJiZhLnJlbmRlclN0YWNrVG90YWxzKCk7YS5pc0RpcnR5PSExfSxyZWRyYXc6ZnVuY3Rpb24oKXt0aGlzLnZpc2libGUmJih0aGlzLnJlbmRlcigpLG4odGhpcy5wbG90TGluZXNBbmRCYW5kcyxmdW5jdGlvbihhKXthLnJlbmRlcigpfSkpO24odGhpcy5zZXJpZXMsZnVuY3Rpb24oYSl7YS5pc0RpcnR5PSEwfSl9LGRlc3Ryb3k6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcyxjPWIuc3RhY2tzLGQsZT1iLnBsb3RMaW5lc0FuZEJhbmRzO2F8fFQoYik7Zm9yKGQgaW4gYylQYShjW2RdKSxjW2RdPW51bGw7bihbYi50aWNrcyxiLm1pbm9yVGlja3MsXG5iLmFsdGVybmF0ZUJhbmRzXSxmdW5jdGlvbihhKXtQYShhKX0pO2ZvcihhPWUubGVuZ3RoO2EtLTspZVthXS5kZXN0cm95KCk7bihcInN0YWNrVG90YWxHcm91cCxheGlzTGluZSxheGlzVGl0bGUsYXhpc0dyb3VwLGNyb3NzLGdyaWRHcm91cCxsYWJlbEdyb3VwXCIuc3BsaXQoXCIsXCIpLGZ1bmN0aW9uKGEpe2JbYV0mJihiW2FdPWJbYV0uZGVzdHJveSgpKX0pO3RoaXMuY3Jvc3MmJnRoaXMuY3Jvc3MuZGVzdHJveSgpfSxkcmF3Q3Jvc3NoYWlyOmZ1bmN0aW9uKGEsYil7dmFyIGMsZD10aGlzLmNyb3NzaGFpcixlLGY7aWYoIXRoaXMuY3Jvc3NoYWlyfHwocyhiKXx8IXEoZC5zbmFwLCEwKSk9PT0hMSl0aGlzLmhpZGVDcm9zc2hhaXIoKTtlbHNlIGlmKHEoZC5zbmFwLCEwKT9zKGIpJiYoYz10aGlzLmlzWEF4aXM/Yi5wbG90WDp0aGlzLmxlbi1iLnBsb3RZKTpjPXRoaXMuaG9yaXo/YS5jaGFydFgtdGhpcy5wb3M6dGhpcy5sZW4tYS5jaGFydFkrdGhpcy5wb3MsYz10aGlzLmlzUmFkaWFsP1xudGhpcy5nZXRQbG90TGluZVBhdGgodGhpcy5pc1hBeGlzP2IueDpxKGIuc3RhY2tZLGIueSkpfHxudWxsOnRoaXMuZ2V0UGxvdExpbmVQYXRoKG51bGwsbnVsbCxudWxsLG51bGwsYyl8fG51bGwsYz09PW51bGwpdGhpcy5oaWRlQ3Jvc3NoYWlyKCk7ZWxzZSBpZihlPXRoaXMuY2F0ZWdvcmllcyYmIXRoaXMuaXNSYWRpYWwsZj1xKGQud2lkdGgsZT90aGlzLnRyYW5zQToxKSx0aGlzLmNyb3NzKXRoaXMuY3Jvc3MuYXR0cih7ZDpjLHZpc2liaWxpdHk6XCJ2aXNpYmxlXCIsXCJzdHJva2Utd2lkdGhcIjpmfSk7ZWxzZXtlPXtcInN0cm9rZS13aWR0aFwiOmYsc3Ryb2tlOmQuY29sb3J8fChlP1wicmdiYSgxNTUsMjAwLDI1NSwwLjIpXCI6XCIjQzBDMEMwXCIpLHpJbmRleDpxKGQuekluZGV4LDIpfTtpZihkLmRhc2hTdHlsZSllLmRhc2hzdHlsZT1kLmRhc2hTdHlsZTt0aGlzLmNyb3NzPXRoaXMuY2hhcnQucmVuZGVyZXIucGF0aChjKS5hdHRyKGUpLmFkZCgpfX0saGlkZUNyb3NzaGFpcjpmdW5jdGlvbigpe3RoaXMuY3Jvc3MmJlxudGhpcy5jcm9zcy5oaWRlKCl9fTt4KEkucHJvdG90eXBlLHtnZXRQbG90QmFuZFBhdGg6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmdldFBsb3RMaW5lUGF0aChiLG51bGwsbnVsbCwhMCksZD10aGlzLmdldFBsb3RMaW5lUGF0aChhLG51bGwsbnVsbCwhMCk7ZCYmYz8oZC5mbGF0PWQudG9TdHJpbmcoKT09PWMudG9TdHJpbmcoKSxkLnB1c2goY1s0XSxjWzVdLGNbMV0sY1syXSkpOmQ9bnVsbDtyZXR1cm4gZH0sYWRkUGxvdEJhbmQ6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuYWRkUGxvdEJhbmRPckxpbmUoYSxcInBsb3RCYW5kc1wiKX0sYWRkUGxvdExpbmU6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuYWRkUGxvdEJhbmRPckxpbmUoYSxcInBsb3RMaW5lc1wiKX0sYWRkUGxvdEJhbmRPckxpbmU6ZnVuY3Rpb24oYSxiKXt2YXIgYz0obmV3IHouUGxvdExpbmVPckJhbmQodGhpcyxhKSkucmVuZGVyKCksZD10aGlzLnVzZXJPcHRpb25zO2MmJihiJiYoZFtiXT1kW2JdfHxbXSxkW2JdLnB1c2goYSkpLFxudGhpcy5wbG90TGluZXNBbmRCYW5kcy5wdXNoKGMpKTtyZXR1cm4gY30scmVtb3ZlUGxvdEJhbmRPckxpbmU6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPXRoaXMucGxvdExpbmVzQW5kQmFuZHMsYz10aGlzLm9wdGlvbnMsZD10aGlzLnVzZXJPcHRpb25zLGU9Yi5sZW5ndGg7ZS0tOyliW2VdLmlkPT09YSYmYltlXS5kZXN0cm95KCk7bihbYy5wbG90TGluZXN8fFtdLGQucGxvdExpbmVzfHxbXSxjLnBsb3RCYW5kc3x8W10sZC5wbG90QmFuZHN8fFtdXSxmdW5jdGlvbihiKXtmb3IoZT1iLmxlbmd0aDtlLS07KWJbZV0uaWQ9PT1hJiZBYShiLGJbZV0pfSl9fSk7SS5wcm90b3R5cGUuZ2V0VGltZVRpY2tzPWZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPVtdLGY9e30sZz1OLmdsb2JhbC51c2VVVEMsaCxpPW5ldyBmYShiLWZiKGIpKSxqPWEudW5pdFJhbmdlLGs9YS5jb3VudDtpZihzKGIpKXtpW1BiXShqPj1ILnNlY29uZD8wOmsqVihpLmdldE1pbGxpc2Vjb25kcygpL2spKTtpZihqPj1ILnNlY29uZClpW1FiXShqPj1cbkgubWludXRlPzA6aypWKGkuZ2V0U2Vjb25kcygpL2spKTtpZihqPj1ILm1pbnV0ZSlpW1JiXShqPj1ILmhvdXI/MDprKlYoaVtDYl0oKS9rKSk7aWYoaj49SC5ob3VyKWlbU2JdKGo+PUguZGF5PzA6aypWKGlbRGJdKCkvaykpO2lmKGo+PUguZGF5KWlbcmJdKGo+PUgubW9udGg/MTprKlYoaVtiYl0oKS9rKSk7aj49SC5tb250aCYmKGlbRmJdKGo+PUgueWVhcj8wOmsqVihpW2liXSgpL2spKSxoPWlbamJdKCkpO2o+PUgueWVhciYmKGgtPWglayxpW0diXShoKSk7aWYoaj09PUgud2VlaylpW3JiXShpW2JiXSgpLWlbRWJdKCkrcShkLDEpKTtiPTE7aWYoemJ8fGdiKWk9aS5nZXRUaW1lKCksaT1uZXcgZmEoaStmYihpKSk7aD1pW2piXSgpO2Zvcih2YXIgZD1pLmdldFRpbWUoKSxsPWlbaWJdKCksbT1pW2JiXSgpLG89IWd8fCEhZ2IscD0oSC5kYXkrKGc/ZmIoaSk6aS5nZXRUaW1lem9uZU9mZnNldCgpKjZFNCkpJUguZGF5O2Q8YzspZS5wdXNoKGQpLGo9PT1ILnllYXI/ZD1xYihoK1xuYiprLDApOmo9PT1ILm1vbnRoP2Q9cWIoaCxsK2Iqayk6byYmKGo9PT1ILmRheXx8aj09PUgud2Vlayk/ZD1xYihoLGwsbStiKmsqKGo9PT1ILmRheT8xOjcpKTpkKz1qKmssYisrO2UucHVzaChkKTtuKFNhKGUsZnVuY3Rpb24oYSl7cmV0dXJuIGo8PUguaG91ciYmYSVILmRheT09PXB9KSxmdW5jdGlvbihhKXtmW2FdPVwiZGF5XCJ9KX1lLmluZm89eChhLHtoaWdoZXJSYW5rczpmLHRvdGFsUmFuZ2U6aiprfSk7cmV0dXJuIGV9O0kucHJvdG90eXBlLm5vcm1hbGl6ZVRpbWVUaWNrSW50ZXJ2YWw9ZnVuY3Rpb24oYSxiKXt2YXIgYz1ifHxbW1wibWlsbGlzZWNvbmRcIixbMSwyLDUsMTAsMjAsMjUsNTAsMTAwLDIwMCw1MDBdXSxbXCJzZWNvbmRcIixbMSwyLDUsMTAsMTUsMzBdXSxbXCJtaW51dGVcIixbMSwyLDUsMTAsMTUsMzBdXSxbXCJob3VyXCIsWzEsMiwzLDQsNiw4LDEyXV0sW1wiZGF5XCIsWzEsMl1dLFtcIndlZWtcIixbMSwyXV0sW1wibW9udGhcIixbMSwyLDMsNCw2XV0sW1wieWVhclwiLG51bGxdXSxkPVxuY1tjLmxlbmd0aC0xXSxlPUhbZFswXV0sZj1kWzFdLGc7Zm9yKGc9MDtnPGMubGVuZ3RoO2crKylpZihkPWNbZ10sZT1IW2RbMF1dLGY9ZFsxXSxjW2crMV0mJmE8PShlKmZbZi5sZW5ndGgtMV0rSFtjW2crMV1bMF1dKS8yKWJyZWFrO2U9PT1ILnllYXImJmE8NSplJiYoZj1bMSwyLDVdKTtjPUJiKGEvZSxmLGRbMF09PT1cInllYXJcIj92KEFiKGEvZSksMSk6MSk7cmV0dXJue3VuaXRSYW5nZTplLGNvdW50OmMsdW5pdE5hbWU6ZFswXX19O0kucHJvdG90eXBlLmdldExvZ1RpY2tQb3NpdGlvbnM9ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9dGhpcy5vcHRpb25zLGY9dGhpcy5sZW4sZz10aGlzLmxpbjJsb2csaD10aGlzLmxvZzJsaW4saT1bXTtpZighZCl0aGlzLl9taW5vckF1dG9JbnRlcnZhbD1udWxsO2lmKGE+PTAuNSlhPXkoYSksaT10aGlzLmdldExpbmVhclRpY2tQb3NpdGlvbnMoYSxiLGMpO2Vsc2UgaWYoYT49MC4wOClmb3IodmFyIGY9VihiKSxqLGssbCxtLG8sZT1hPjAuMz9cblsxLDIsNF06YT4wLjE1P1sxLDIsNCw2LDhdOlsxLDIsMyw0LDUsNiw3LDgsOV07ZjxjKzEmJiFvO2YrKyl7az1lLmxlbmd0aDtmb3Ioaj0wO2o8ayYmIW87aisrKWw9aChnKGYpKmVbal0pLGw+YiYmKCFkfHxtPD1jKSYmbSE9PXQmJmkucHVzaChtKSxtPmMmJihvPSEwKSxtPWx9ZWxzZSBpZihiPWcoYiksYz1nKGMpLGE9ZVtkP1wibWlub3JUaWNrSW50ZXJ2YWxcIjpcInRpY2tJbnRlcnZhbFwiXSxhPXEoYT09PVwiYXV0b1wiP251bGw6YSx0aGlzLl9taW5vckF1dG9JbnRlcnZhbCwoYy1iKSooZS50aWNrUGl4ZWxJbnRlcnZhbC8oZD81OjEpKS8oKGQ/Zi90aGlzLnRpY2tQb3NpdGlvbnMubGVuZ3RoOmYpfHwxKSksYT1CYihhLG51bGwsQWIoYSkpLGk9dGEodGhpcy5nZXRMaW5lYXJUaWNrUG9zaXRpb25zKGEsYixjKSxoKSwhZCl0aGlzLl9taW5vckF1dG9JbnRlcnZhbD1hLzU7aWYoIWQpdGhpcy50aWNrSW50ZXJ2YWw9YTtyZXR1cm4gaX07SS5wcm90b3R5cGUubG9nMmxpbj1mdW5jdGlvbihhKXtyZXR1cm4gWS5sb2coYSkvXG5ZLkxOMTB9O0kucHJvdG90eXBlLmxpbjJsb2c9ZnVuY3Rpb24oYSl7cmV0dXJuIFkucG93KDEwLGEpfTt2YXIgTGI9ei5Ub29sdGlwPWZ1bmN0aW9uKCl7dGhpcy5pbml0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX07TGIucHJvdG90eXBlPXtpbml0OmZ1bmN0aW9uKGEsYil7dmFyIGM9Yi5ib3JkZXJXaWR0aCxkPWIuc3R5bGUsZT1HKGQucGFkZGluZyk7dGhpcy5jaGFydD1hO3RoaXMub3B0aW9ucz1iO3RoaXMuY3Jvc3NoYWlycz1bXTt0aGlzLm5vdz17eDowLHk6MH07dGhpcy5pc0hpZGRlbj0hMDt0aGlzLmxhYmVsPWEucmVuZGVyZXIubGFiZWwoXCJcIiwwLDAsYi5zaGFwZXx8XCJjYWxsb3V0XCIsbnVsbCxudWxsLGIudXNlSFRNTCxudWxsLFwidG9vbHRpcFwiKS5hdHRyKHtwYWRkaW5nOmUsZmlsbDpiLmJhY2tncm91bmRDb2xvcixcInN0cm9rZS13aWR0aFwiOmMscjpiLmJvcmRlclJhZGl1cyx6SW5kZXg6OH0pLmNzcyhkKS5jc3Moe3BhZGRpbmc6MH0pLmFkZCgpLmF0dHIoe3k6LTk5OTl9KTtcbnFhfHx0aGlzLmxhYmVsLnNoYWRvdyhiLnNoYWRvdyk7dGhpcy5zaGFyZWQ9Yi5zaGFyZWR9LGRlc3Ryb3k6ZnVuY3Rpb24oKXtpZih0aGlzLmxhYmVsKXRoaXMubGFiZWw9dGhpcy5sYWJlbC5kZXN0cm95KCk7Y2xlYXJUaW1lb3V0KHRoaXMuaGlkZVRpbWVyKTtjbGVhclRpbWVvdXQodGhpcy50b29sdGlwVGltZW91dCl9LG1vdmU6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9dGhpcyxmPWUubm93LGc9ZS5vcHRpb25zLmFuaW1hdGlvbiE9PSExJiYhZS5pc0hpZGRlbiYmKFMoYS1mLngpPjF8fFMoYi1mLnkpPjEpLGg9ZS5mb2xsb3dQb2ludGVyfHxlLmxlbj4xO3goZix7eDpnPygyKmYueCthKS8zOmEseTpnPyhmLnkrYikvMjpiLGFuY2hvclg6aD90Omc/KDIqZi5hbmNob3JYK2MpLzM6YyxhbmNob3JZOmg/dDpnPyhmLmFuY2hvclkrZCkvMjpkfSk7ZS5sYWJlbC5hdHRyKGYpO2lmKGcpY2xlYXJUaW1lb3V0KHRoaXMudG9vbHRpcFRpbWVvdXQpLHRoaXMudG9vbHRpcFRpbWVvdXQ9c2V0VGltZW91dChmdW5jdGlvbigpe2UmJlxuZS5tb3ZlKGEsYixjLGQpfSwzMil9LGhpZGU6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztjbGVhclRpbWVvdXQodGhpcy5oaWRlVGltZXIpO2E9cShhLHRoaXMub3B0aW9ucy5oaWRlRGVsYXksNTAwKTtpZighdGhpcy5pc0hpZGRlbil0aGlzLmhpZGVUaW1lcj0kYShmdW5jdGlvbigpe2IubGFiZWxbYT9cImZhZGVPdXRcIjpcImhpZGVcIl0oKTtiLmlzSGlkZGVuPSEwfSxhKX0sZ2V0QW5jaG9yOmZ1bmN0aW9uKGEsYil7dmFyIGMsZD10aGlzLmNoYXJ0LGU9ZC5pbnZlcnRlZCxmPWQucGxvdFRvcCxnPWQucGxvdExlZnQsaD0wLGk9MCxqLGssYT12YShhKTtjPWFbMF0udG9vbHRpcFBvczt0aGlzLmZvbGxvd1BvaW50ZXImJmImJihiLmNoYXJ0WD09PXQmJihiPWQucG9pbnRlci5ub3JtYWxpemUoYikpLGM9W2IuY2hhcnRYLWQucGxvdExlZnQsYi5jaGFydFktZl0pO2N8fChuKGEsZnVuY3Rpb24oYSl7aj1hLnNlcmllcy55QXhpcztrPWEuc2VyaWVzLnhBeGlzO2grPWEucGxvdFgrKCFlJiZrP1xuay5sZWZ0LWc6MCk7aSs9KGEucGxvdExvdz8oYS5wbG90TG93K2EucGxvdEhpZ2gpLzI6YS5wbG90WSkrKCFlJiZqP2oudG9wLWY6MCl9KSxoLz1hLmxlbmd0aCxpLz1hLmxlbmd0aCxjPVtlP2QucGxvdFdpZHRoLWk6aCx0aGlzLnNoYXJlZCYmIWUmJmEubGVuZ3RoPjEmJmI/Yi5jaGFydFktZjplP2QucGxvdEhlaWdodC1oOmldKTtyZXR1cm4gdGEoYyx5KX0sZ2V0UG9zaXRpb246ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXRoaXMuY2hhcnQsZT10aGlzLmRpc3RhbmNlLGY9e30sZz1jLmh8fDAsaCxpPVtcInlcIixkLmNoYXJ0SGVpZ2h0LGIsYy5wbG90WStkLnBsb3RUb3AsZC5wbG90VG9wLGQucGxvdFRvcCtkLnBsb3RIZWlnaHRdLGo9W1wieFwiLGQuY2hhcnRXaWR0aCxhLGMucGxvdFgrZC5wbG90TGVmdCxkLnBsb3RMZWZ0LGQucGxvdExlZnQrZC5wbG90V2lkdGhdLGs9IXRoaXMuZm9sbG93UG9pbnRlciYmcShjLnR0QmVsb3csIWQuaW52ZXJ0ZWQ9PT0hIWMubmVnYXRpdmUpLGw9ZnVuY3Rpb24oYSxcbmIsYyxkLGgsaSl7dmFyIGo9YzxkLWUsbT1kK2UrYzxiLGw9ZC1lLWM7ZCs9ZTtpZihrJiZtKWZbYV09ZDtlbHNlIGlmKCFrJiZqKWZbYV09bDtlbHNlIGlmKGopZlthXT1FKGktYyxsLWc8MD9sOmwtZyk7ZWxzZSBpZihtKWZbYV09dihoLGQrZytjPmI/ZDpkK2cpO2Vsc2UgcmV0dXJuITF9LG09ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGc7ZDxlfHxkPmItZT9nPSExOmZbYV09ZDxjLzI/MTpkPmItYy8yP2ItYy0yOmQtYy8yO3JldHVybiBnfSxvPWZ1bmN0aW9uKGEpe3ZhciBiPWk7aT1qO2o9YjtoPWF9LHA9ZnVuY3Rpb24oKXtsLmFwcGx5KDAsaSkhPT0hMT9tLmFwcGx5KDAsaik9PT0hMSYmIWgmJihvKCEwKSxwKCkpOmg/Zi54PWYueT0wOihvKCEwKSxwKCkpfTsoZC5pbnZlcnRlZHx8dGhpcy5sZW4+MSkmJm8oKTtwKCk7cmV0dXJuIGZ9LGRlZmF1bHRGb3JtYXR0ZXI6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5wb2ludHN8fHZhKHRoaXMpLGM7Yz1bYS50b29sdGlwRm9vdGVySGVhZGVyRm9ybWF0dGVyKGJbMF0pXTtcbmM9Yy5jb25jYXQoYS5ib2R5Rm9ybWF0dGVyKGIpKTtjLnB1c2goYS50b29sdGlwRm9vdGVySGVhZGVyRm9ybWF0dGVyKGJbMF0sITApKTtyZXR1cm4gYy5qb2luKFwiXCIpfSxyZWZyZXNoOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5jaGFydCxkPXRoaXMubGFiZWwsZT10aGlzLm9wdGlvbnMsZixnLGgsaT17fSxqLGs9W107aj1lLmZvcm1hdHRlcnx8dGhpcy5kZWZhdWx0Rm9ybWF0dGVyO3ZhciBpPWMuaG92ZXJQb2ludHMsbCxtPXRoaXMuc2hhcmVkO2NsZWFyVGltZW91dCh0aGlzLmhpZGVUaW1lcik7dGhpcy5mb2xsb3dQb2ludGVyPXZhKGEpWzBdLnNlcmllcy50b29sdGlwT3B0aW9ucy5mb2xsb3dQb2ludGVyO2g9dGhpcy5nZXRBbmNob3IoYSxiKTtmPWhbMF07Zz1oWzFdO20mJighYS5zZXJpZXN8fCFhLnNlcmllcy5ub1NoYXJlZFRvb2x0aXApPyhjLmhvdmVyUG9pbnRzPWEsaSYmbihpLGZ1bmN0aW9uKGEpe2Euc2V0U3RhdGUoKX0pLG4oYSxmdW5jdGlvbihhKXthLnNldFN0YXRlKFwiaG92ZXJcIik7XG5rLnB1c2goYS5nZXRMYWJlbENvbmZpZygpKX0pLGk9e3g6YVswXS5jYXRlZ29yeSx5OmFbMF0ueX0saS5wb2ludHM9ayx0aGlzLmxlbj1rLmxlbmd0aCxhPWFbMF0pOmk9YS5nZXRMYWJlbENvbmZpZygpO2o9ai5jYWxsKGksdGhpcyk7aT1hLnNlcmllczt0aGlzLmRpc3RhbmNlPXEoaS50b29sdGlwT3B0aW9ucy5kaXN0YW5jZSwxNik7aj09PSExP3RoaXMuaGlkZSgpOih0aGlzLmlzSGlkZGVuJiYoVGEoZCksZC5hdHRyKFwib3BhY2l0eVwiLDEpLnNob3coKSksZC5hdHRyKHt0ZXh0Omp9KSxsPWUuYm9yZGVyQ29sb3J8fGEuY29sb3J8fGkuY29sb3J8fFwiIzYwNjA2MFwiLGQuYXR0cih7c3Ryb2tlOmx9KSx0aGlzLnVwZGF0ZVBvc2l0aW9uKHtwbG90WDpmLHBsb3RZOmcsbmVnYXRpdmU6YS5uZWdhdGl2ZSx0dEJlbG93OmEudHRCZWxvdyxoOmhbMl18fDB9KSx0aGlzLmlzSGlkZGVuPSExKTtNKGMsXCJ0b29sdGlwUmVmcmVzaFwiLHt0ZXh0OmoseDpmK2MucGxvdExlZnQseTpnK2MucGxvdFRvcCxcbmJvcmRlckNvbG9yOmx9KX0sdXBkYXRlUG9zaXRpb246ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jaGFydCxjPXRoaXMubGFiZWwsYz0odGhpcy5vcHRpb25zLnBvc2l0aW9uZXJ8fHRoaXMuZ2V0UG9zaXRpb24pLmNhbGwodGhpcyxjLndpZHRoLGMuaGVpZ2h0LGEpO3RoaXMubW92ZSh5KGMueCkseShjLnl8fDApLGEucGxvdFgrYi5wbG90TGVmdCxhLnBsb3RZK2IucGxvdFRvcCl9LGdldFhEYXRlRm9ybWF0OmZ1bmN0aW9uKGEsYixjKXt2YXIgZCxiPWIuZGF0ZVRpbWVMYWJlbEZvcm1hdHMsZT1jJiZjLmNsb3Nlc3RQb2ludFJhbmdlLGYsZz17bWlsbGlzZWNvbmQ6MTUsc2Vjb25kOjEyLG1pbnV0ZTo5LGhvdXI6NixkYXk6M30saCxpPVwibWlsbGlzZWNvbmRcIjtpZihlKXtoPW1hKFwiJW0tJWQgJUg6JU06JVMuJUxcIixhLngpO2ZvcihmIGluIEgpe2lmKGU9PT1ILndlZWsmJittYShcIiV3XCIsYS54KT09PWMub3B0aW9ucy5zdGFydE9mV2VlayYmaC5zdWJzdHIoNik9PT1cIjAwOjAwOjAwLjAwMFwiKXtmPVxuXCJ3ZWVrXCI7YnJlYWt9aWYoSFtmXT5lKXtmPWk7YnJlYWt9aWYoZ1tmXSYmaC5zdWJzdHIoZ1tmXSkhPT1cIjAxLTAxIDAwOjAwOjAwLjAwMFwiLnN1YnN0cihnW2ZdKSlicmVhaztmIT09XCJ3ZWVrXCImJihpPWYpfWYmJihkPWJbZl0pfWVsc2UgZD1iLmRheTtyZXR1cm4gZHx8Yi55ZWFyfSx0b29sdGlwRm9vdGVySGVhZGVyRm9ybWF0dGVyOmZ1bmN0aW9uKGEsYil7dmFyIGM9Yj9cImZvb3RlclwiOlwiaGVhZGVyXCIsZD1hLnNlcmllcyxlPWQudG9vbHRpcE9wdGlvbnMsZj1lLnhEYXRlRm9ybWF0LGc9ZC54QXhpcyxoPWcmJmcub3B0aW9ucy50eXBlPT09XCJkYXRldGltZVwiJiZ1YShhLmtleSksYz1lW2MrXCJGb3JtYXRcIl07aCYmIWYmJihmPXRoaXMuZ2V0WERhdGVGb3JtYXQoYSxlLGcpKTtoJiZmJiYoYz1jLnJlcGxhY2UoXCJ7cG9pbnQua2V5fVwiLFwie3BvaW50LmtleTpcIitmK1wifVwiKSk7cmV0dXJuIExhKGMse3BvaW50OmEsc2VyaWVzOmR9KX0sYm9keUZvcm1hdHRlcjpmdW5jdGlvbihhKXtyZXR1cm4gdGEoYSxcbmZ1bmN0aW9uKGEpe3ZhciBjPWEuc2VyaWVzLnRvb2x0aXBPcHRpb25zO3JldHVybihjLnBvaW50Rm9ybWF0dGVyfHxhLnBvaW50LnRvb2x0aXBGb3JtYXR0ZXIpLmNhbGwoYS5wb2ludCxjLnBvaW50Rm9ybWF0KX0pfX07dmFyIG9hO2RiPUImJkIuZG9jdW1lbnRFbGVtZW50Lm9udG91Y2hzdGFydCE9PXQ7dmFyIFphPXouUG9pbnRlcj1mdW5jdGlvbihhLGIpe3RoaXMuaW5pdChhLGIpfTtaYS5wcm90b3R5cGU9e2luaXQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz1iLmNoYXJ0LGQ9Yy5ldmVudHMsZT1xYT9cIlwiOmMuem9vbVR5cGUsYz1hLmludmVydGVkLGY7dGhpcy5vcHRpb25zPWI7dGhpcy5jaGFydD1hO3RoaXMuem9vbVg9Zj0veC8udGVzdChlKTt0aGlzLnpvb21ZPWU9L3kvLnRlc3QoZSk7dGhpcy56b29tSG9yPWYmJiFjfHxlJiZjO3RoaXMuem9vbVZlcnQ9ZSYmIWN8fGYmJmM7dGhpcy5oYXNab29tPWZ8fGU7dGhpcy5ydW5DaGFydENsaWNrPWQmJiEhZC5jbGljazt0aGlzLnBpbmNoRG93bj1cbltdO3RoaXMubGFzdFZhbGlkVG91Y2g9e307aWYoei5Ub29sdGlwJiZiLnRvb2x0aXAuZW5hYmxlZClhLnRvb2x0aXA9bmV3IExiKGEsYi50b29sdGlwKSx0aGlzLmZvbGxvd1RvdWNoTW92ZT1xKGIudG9vbHRpcC5mb2xsb3dUb3VjaE1vdmUsITApO3RoaXMuc2V0RE9NRXZlbnRzKCl9LG5vcm1hbGl6ZTpmdW5jdGlvbihhLGIpe3ZhciBjLGQsYT1hfHxKLmV2ZW50O2lmKCFhLnRhcmdldClhLnRhcmdldD1hLnNyY0VsZW1lbnQ7ZD1hLnRvdWNoZXM/YS50b3VjaGVzLmxlbmd0aD9hLnRvdWNoZXMuaXRlbSgwKTphLmNoYW5nZWRUb3VjaGVzWzBdOmE7aWYoIWIpdGhpcy5jaGFydFBvc2l0aW9uPWI9S2IodGhpcy5jaGFydC5jb250YWluZXIpO2QucGFnZVg9PT10PyhjPXYoYS54LGEuY2xpZW50WC1iLmxlZnQpLGQ9YS55KTooYz1kLnBhZ2VYLWIubGVmdCxkPWQucGFnZVktYi50b3ApO3JldHVybiB4KGEse2NoYXJ0WDp5KGMpLGNoYXJ0WTp5KGQpfSl9LGdldENvb3JkaW5hdGVzOmZ1bmN0aW9uKGEpe3ZhciBiPVxue3hBeGlzOltdLHlBeGlzOltdfTtuKHRoaXMuY2hhcnQuYXhlcyxmdW5jdGlvbihjKXtiW2MuaXNYQXhpcz9cInhBeGlzXCI6XCJ5QXhpc1wiXS5wdXNoKHtheGlzOmMsdmFsdWU6Yy50b1ZhbHVlKGFbYy5ob3Jpej9cImNoYXJ0WFwiOlwiY2hhcnRZXCJdKX0pfSk7cmV0dXJuIGJ9LHJ1blBvaW50QWN0aW9uczpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNoYXJ0LGM9Yi5zZXJpZXMsZD1iLnRvb2x0aXAsZT1kP2Quc2hhcmVkOiExLGY9Yi5ob3ZlclBvaW50LGc9Yi5ob3ZlclNlcmllcyxoLGk9W051bWJlci5NQVhfVkFMVUUsTnVtYmVyLk1BWF9WQUxVRV0saixrLGw9W10sbT1bXSxvO2lmKCFlJiYhZylmb3IoaD0wO2g8Yy5sZW5ndGg7aCsrKWlmKGNbaF0uZGlyZWN0VG91Y2h8fCFjW2hdLm9wdGlvbnMuc3RpY2t5VHJhY2tpbmcpYz1bXTtnJiYoZT9nLm5vU2hhcmVkVG9vbHRpcDpnLmRpcmVjdFRvdWNoKSYmZj9tPVtmXToobihjLGZ1bmN0aW9uKGIpe2o9Yi5ub1NoYXJlZFRvb2x0aXAmJmU7az1cbiFlJiZiLmRpcmVjdFRvdWNoO2IudmlzaWJsZSYmIWomJiFrJiZxKGIub3B0aW9ucy5lbmFibGVNb3VzZVRyYWNraW5nLCEwKSYmKG89Yi5zZWFyY2hQb2ludChhLCFqJiZiLmtkRGltZW5zaW9ucz09PTEpKSYmbC5wdXNoKG8pfSksbihsLGZ1bmN0aW9uKGEpe2EmJm4oW1wiZGlzdFwiLFwiZGlzdFhcIl0sZnVuY3Rpb24oYixjKXtpZih0eXBlb2YgYVtiXT09PVwibnVtYmVyXCIpe3ZhciBkPWFbYl09PT1pW2NdJiZhLnNlcmllcy5ncm91cC56SW5kZXg+PW1bY10uc2VyaWVzLmdyb3VwLnpJbmRleDtpZihhW2JdPGlbY118fGQpaVtjXT1hW2JdLG1bY109YX19KX0pKTtpZihlKWZvcihoPWwubGVuZ3RoO2gtLTspKGxbaF0uY2xpZW50WCE9PW1bMV0uY2xpZW50WHx8bFtoXS5zZXJpZXMubm9TaGFyZWRUb29sdGlwKSYmbC5zcGxpY2UoaCwxKTtpZihtWzBdJiYobVswXSE9PXRoaXMucHJldktEUG9pbnR8fGQmJmQuaXNIaWRkZW4pKWlmKGUmJiFtWzBdLnNlcmllcy5ub1NoYXJlZFRvb2x0aXApbC5sZW5ndGgmJlxuZCYmZC5yZWZyZXNoKGwsYSksbihsLGZ1bmN0aW9uKGIpe2Iub25Nb3VzZU92ZXIoYSxiIT09KGcmJmcuZGlyZWN0VG91Y2gmJmZ8fG1bMF0pKX0pLHRoaXMucHJldktEUG9pbnQ9bVsxXTtlbHNle2QmJmQucmVmcmVzaChtWzBdLGEpO2lmKCFnfHwhZy5kaXJlY3RUb3VjaCltWzBdLm9uTW91c2VPdmVyKGEpO3RoaXMucHJldktEUG9pbnQ9bVswXX1lbHNlIGM9ZyYmZy50b29sdGlwT3B0aW9ucy5mb2xsb3dQb2ludGVyLGQmJmMmJiFkLmlzSGlkZGVuJiYoYz1kLmdldEFuY2hvcihbe31dLGEpLGQudXBkYXRlUG9zaXRpb24oe3Bsb3RYOmNbMF0scGxvdFk6Y1sxXX0pKTtpZighdGhpcy5fb25Eb2N1bWVudE1vdXNlTW92ZSl0aGlzLl9vbkRvY3VtZW50TW91c2VNb3ZlPWZ1bmN0aW9uKGEpe2lmKCRbb2FdKSRbb2FdLnBvaW50ZXIub25Eb2N1bWVudE1vdXNlTW92ZShhKX0sRChCLFwibW91c2Vtb3ZlXCIsdGhpcy5fb25Eb2N1bWVudE1vdXNlTW92ZSk7bihlP2w6W3EobVsxXSxmKV0sZnVuY3Rpb24oYyl7bihiLmF4ZXMsXG5mdW5jdGlvbihiKXsoIWN8fGMuc2VyaWVzW2IuY29sbF09PT1iKSYmYi5kcmF3Q3Jvc3NoYWlyKGEsYyl9KX0pfSxyZXNldDpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuY2hhcnQsZD1jLmhvdmVyU2VyaWVzLGU9Yy5ob3ZlclBvaW50LGY9Yy5ob3ZlclBvaW50cyxnPWMudG9vbHRpcCxoPWcmJmcuc2hhcmVkP2Y6ZTthJiZoJiZuKHZhKGgpLGZ1bmN0aW9uKGIpe2Iuc2VyaWVzLmlzQ2FydGVzaWFuJiZiLnBsb3RYPT09dm9pZCAwJiYoYT0hMSl9KTtpZihhKWcmJmgmJihnLnJlZnJlc2goaCksZSYmKGUuc2V0U3RhdGUoZS5zdGF0ZSwhMCksbihjLmF4ZXMsZnVuY3Rpb24oYSl7cShhLmNyb3NzaGFpciYmYS5jcm9zc2hhaXIuc25hcCwhMCk/YS5kcmF3Q3Jvc3NoYWlyKG51bGwsZSk6YS5oaWRlQ3Jvc3NoYWlyKCl9KSkpO2Vsc2V7aWYoZSllLm9uTW91c2VPdXQoKTtmJiZuKGYsZnVuY3Rpb24oYSl7YS5zZXRTdGF0ZSgpfSk7aWYoZClkLm9uTW91c2VPdXQoKTtnJiZnLmhpZGUoYik7XG5pZih0aGlzLl9vbkRvY3VtZW50TW91c2VNb3ZlKVQoQixcIm1vdXNlbW92ZVwiLHRoaXMuX29uRG9jdW1lbnRNb3VzZU1vdmUpLHRoaXMuX29uRG9jdW1lbnRNb3VzZU1vdmU9bnVsbDtuKGMuYXhlcyxmdW5jdGlvbihhKXthLmhpZGVDcm9zc2hhaXIoKX0pO3RoaXMuaG92ZXJYPWMuaG92ZXJQb2ludHM9Yy5ob3ZlclBvaW50PW51bGx9fSxzY2FsZUdyb3VwczpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuY2hhcnQsZDtuKGMuc2VyaWVzLGZ1bmN0aW9uKGUpe2Q9YXx8ZS5nZXRQbG90Qm94KCk7ZS54QXhpcyYmZS54QXhpcy56b29tRW5hYmxlZCYmKGUuZ3JvdXAuYXR0cihkKSxlLm1hcmtlckdyb3VwJiYoZS5tYXJrZXJHcm91cC5hdHRyKGQpLGUubWFya2VyR3JvdXAuY2xpcChiP2MuY2xpcFJlY3Q6bnVsbCkpLGUuZGF0YUxhYmVsc0dyb3VwJiZlLmRhdGFMYWJlbHNHcm91cC5hdHRyKGQpKX0pO2MuY2xpcFJlY3QuYXR0cihifHxjLmNsaXBCb3gpfSxkcmFnU3RhcnQ6ZnVuY3Rpb24oYSl7dmFyIGI9XG50aGlzLmNoYXJ0O2IubW91c2VJc0Rvd249YS50eXBlO2IuY2FuY2VsQ2xpY2s9ITE7Yi5tb3VzZURvd25YPXRoaXMubW91c2VEb3duWD1hLmNoYXJ0WDtiLm1vdXNlRG93blk9dGhpcy5tb3VzZURvd25ZPWEuY2hhcnRZfSxkcmFnOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY2hhcnQsYz1iLm9wdGlvbnMuY2hhcnQsZD1hLmNoYXJ0WCxlPWEuY2hhcnRZLGY9dGhpcy56b29tSG9yLGc9dGhpcy56b29tVmVydCxoPWIucGxvdExlZnQsaT1iLnBsb3RUb3Asaj1iLnBsb3RXaWR0aCxrPWIucGxvdEhlaWdodCxsLG09dGhpcy5zZWxlY3Rpb25NYXJrZXIsbz10aGlzLm1vdXNlRG93blgscD10aGlzLm1vdXNlRG93blkscj1jLnBhbktleSYmYVtjLnBhbktleStcIktleVwiXTtpZighbXx8IW0udG91Y2gpaWYoZDxoP2Q9aDpkPmgraiYmKGQ9aCtqKSxlPGk/ZT1pOmU+aStrJiYoZT1pK2spLHRoaXMuaGFzRHJhZ2dlZD1NYXRoLnNxcnQoTWF0aC5wb3coby1kLDIpK01hdGgucG93KHAtZSwyKSksdGhpcy5oYXNEcmFnZ2VkPlxuMTApe2w9Yi5pc0luc2lkZVBsb3Qoby1oLHAtaSk7aWYoYi5oYXNDYXJ0ZXNpYW5TZXJpZXMmJih0aGlzLnpvb21YfHx0aGlzLnpvb21ZKSYmbCYmIXImJiFtKXRoaXMuc2VsZWN0aW9uTWFya2VyPW09Yi5yZW5kZXJlci5yZWN0KGgsaSxmPzE6aixnPzE6aywwKS5hdHRyKHtmaWxsOmMuc2VsZWN0aW9uTWFya2VyRmlsbHx8XCJyZ2JhKDY5LDExNCwxNjcsMC4yNSlcIix6SW5kZXg6N30pLmFkZCgpO20mJmYmJihkLT1vLG0uYXR0cih7d2lkdGg6UyhkKSx4OihkPjA/MDpkKStvfSkpO20mJmcmJihkPWUtcCxtLmF0dHIoe2hlaWdodDpTKGQpLHk6KGQ+MD8wOmQpK3B9KSk7bCYmIW0mJmMucGFubmluZyYmYi5wYW4oYSxjLnBhbm5pbmcpfX0sZHJvcDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLGM9dGhpcy5jaGFydCxkPXRoaXMuaGFzUGluY2hlZDtpZih0aGlzLnNlbGVjdGlvbk1hcmtlcil7dmFyIGU9e29yaWdpbmFsRXZlbnQ6YSx4QXhpczpbXSx5QXhpczpbXX0sZj10aGlzLnNlbGVjdGlvbk1hcmtlcixcbmc9Zi5hdHRyP2YuYXR0cihcInhcIik6Zi54LGg9Zi5hdHRyP2YuYXR0cihcInlcIik6Zi55LGk9Zi5hdHRyP2YuYXR0cihcIndpZHRoXCIpOmYud2lkdGgsaj1mLmF0dHI/Zi5hdHRyKFwiaGVpZ2h0XCIpOmYuaGVpZ2h0LGs7aWYodGhpcy5oYXNEcmFnZ2VkfHxkKW4oYy5heGVzLGZ1bmN0aW9uKGMpe2lmKGMuem9vbUVuYWJsZWQmJnMoYy5taW4pJiYoZHx8Ylt7eEF4aXM6XCJ6b29tWFwiLHlBeGlzOlwiem9vbVlcIn1bYy5jb2xsXV0pKXt2YXIgZj1jLmhvcml6LG89YS50eXBlPT09XCJ0b3VjaGVuZFwiP2MubWluUGl4ZWxQYWRkaW5nOjAscD1jLnRvVmFsdWUoKGY/ZzpoKStvKSxmPWMudG9WYWx1ZSgoZj9nK2k6aCtqKS1vKTtlW2MuY29sbF0ucHVzaCh7YXhpczpjLG1pbjpFKHAsZiksbWF4OnYocCxmKX0pO2s9ITB9fSksayYmTShjLFwic2VsZWN0aW9uXCIsZSxmdW5jdGlvbihhKXtjLnpvb20oeChhLGQ/e2FuaW1hdGlvbjohMX06bnVsbCkpfSk7dGhpcy5zZWxlY3Rpb25NYXJrZXI9dGhpcy5zZWxlY3Rpb25NYXJrZXIuZGVzdHJveSgpO1xuZCYmdGhpcy5zY2FsZUdyb3VwcygpfWlmKGMpRihjLmNvbnRhaW5lcix7Y3Vyc29yOmMuX2N1cnNvcn0pLGMuY2FuY2VsQ2xpY2s9dGhpcy5oYXNEcmFnZ2VkPjEwLGMubW91c2VJc0Rvd249dGhpcy5oYXNEcmFnZ2VkPXRoaXMuaGFzUGluY2hlZD0hMSx0aGlzLnBpbmNoRG93bj1bXX0sb25Db250YWluZXJNb3VzZURvd246ZnVuY3Rpb24oYSl7YT10aGlzLm5vcm1hbGl6ZShhKTthLnByZXZlbnREZWZhdWx0JiZhLnByZXZlbnREZWZhdWx0KCk7dGhpcy5kcmFnU3RhcnQoYSl9LG9uRG9jdW1lbnRNb3VzZVVwOmZ1bmN0aW9uKGEpeyRbb2FdJiYkW29hXS5wb2ludGVyLmRyb3AoYSl9LG9uRG9jdW1lbnRNb3VzZU1vdmU6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jaGFydCxjPXRoaXMuY2hhcnRQb3NpdGlvbixhPXRoaXMubm9ybWFsaXplKGEsYyk7YyYmIXRoaXMuaW5DbGFzcyhhLnRhcmdldCxcImhpZ2hjaGFydHMtdHJhY2tlclwiKSYmIWIuaXNJbnNpZGVQbG90KGEuY2hhcnRYLWIucGxvdExlZnQsXG5hLmNoYXJ0WS1iLnBsb3RUb3ApJiZ0aGlzLnJlc2V0KCl9LG9uQ29udGFpbmVyTW91c2VMZWF2ZTpmdW5jdGlvbihhKXt2YXIgYj0kW29hXTtpZihiJiYoYS5yZWxhdGVkVGFyZ2V0fHxhLnRvRWxlbWVudCkpYi5wb2ludGVyLnJlc2V0KCksYi5wb2ludGVyLmNoYXJ0UG9zaXRpb249bnVsbH0sb25Db250YWluZXJNb3VzZU1vdmU6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jaGFydDtpZighcyhvYSl8fCEkW29hXXx8ISRbb2FdLm1vdXNlSXNEb3duKW9hPWIuaW5kZXg7YT10aGlzLm5vcm1hbGl6ZShhKTthLnJldHVyblZhbHVlPSExO2IubW91c2VJc0Rvd249PT1cIm1vdXNlZG93blwiJiZ0aGlzLmRyYWcoYSk7KHRoaXMuaW5DbGFzcyhhLnRhcmdldCxcImhpZ2hjaGFydHMtdHJhY2tlclwiKXx8Yi5pc0luc2lkZVBsb3QoYS5jaGFydFgtYi5wbG90TGVmdCxhLmNoYXJ0WS1iLnBsb3RUb3ApKSYmIWIub3Blbk1lbnUmJnRoaXMucnVuUG9pbnRBY3Rpb25zKGEpfSxpbkNsYXNzOmZ1bmN0aW9uKGEsXG5iKXtmb3IodmFyIGM7YTspe2lmKGM9WChhLFwiY2xhc3NcIikpe2lmKGMuaW5kZXhPZihiKSE9PS0xKXJldHVybiEwO2lmKGMuaW5kZXhPZihcImhpZ2hjaGFydHMtY29udGFpbmVyXCIpIT09LTEpcmV0dXJuITF9YT1hLnBhcmVudE5vZGV9fSxvblRyYWNrZXJNb3VzZU91dDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNoYXJ0LmhvdmVyU2VyaWVzLGE9YS5yZWxhdGVkVGFyZ2V0fHxhLnRvRWxlbWVudDtpZihiJiZhJiYhYi5vcHRpb25zLnN0aWNreVRyYWNraW5nJiYhdGhpcy5pbkNsYXNzKGEsXCJoaWdoY2hhcnRzLXRvb2x0aXBcIikmJiF0aGlzLmluQ2xhc3MoYSxcImhpZ2hjaGFydHMtc2VyaWVzLVwiK2IuaW5kZXgpKWIub25Nb3VzZU91dCgpfSxvbkNvbnRhaW5lckNsaWNrOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY2hhcnQsYz1iLmhvdmVyUG9pbnQsZD1iLnBsb3RMZWZ0LGU9Yi5wbG90VG9wLGE9dGhpcy5ub3JtYWxpemUoYSk7Yi5jYW5jZWxDbGlja3x8KGMmJnRoaXMuaW5DbGFzcyhhLnRhcmdldCxcblwiaGlnaGNoYXJ0cy10cmFja2VyXCIpPyhNKGMuc2VyaWVzLFwiY2xpY2tcIix4KGEse3BvaW50OmN9KSksYi5ob3ZlclBvaW50JiZjLmZpcmVQb2ludEV2ZW50KFwiY2xpY2tcIixhKSk6KHgoYSx0aGlzLmdldENvb3JkaW5hdGVzKGEpKSxiLmlzSW5zaWRlUGxvdChhLmNoYXJ0WC1kLGEuY2hhcnRZLWUpJiZNKGIsXCJjbGlja1wiLGEpKSl9LHNldERPTUV2ZW50czpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLmNoYXJ0LmNvbnRhaW5lcjtiLm9ubW91c2Vkb3duPWZ1bmN0aW9uKGIpe2Eub25Db250YWluZXJNb3VzZURvd24oYil9O2Iub25tb3VzZW1vdmU9ZnVuY3Rpb24oYil7YS5vbkNvbnRhaW5lck1vdXNlTW92ZShiKX07Yi5vbmNsaWNrPWZ1bmN0aW9uKGIpe2Eub25Db250YWluZXJDbGljayhiKX07RChiLFwibW91c2VsZWF2ZVwiLGEub25Db250YWluZXJNb3VzZUxlYXZlKTtsYj09PTEmJkQoQixcIm1vdXNldXBcIixhLm9uRG9jdW1lbnRNb3VzZVVwKTtpZihkYiliLm9udG91Y2hzdGFydD1mdW5jdGlvbihiKXthLm9uQ29udGFpbmVyVG91Y2hTdGFydChiKX0sXG5iLm9udG91Y2htb3ZlPWZ1bmN0aW9uKGIpe2Eub25Db250YWluZXJUb3VjaE1vdmUoYil9LGxiPT09MSYmRChCLFwidG91Y2hlbmRcIixhLm9uRG9jdW1lbnRUb3VjaEVuZCl9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt2YXIgYTtUKHRoaXMuY2hhcnQuY29udGFpbmVyLFwibW91c2VsZWF2ZVwiLHRoaXMub25Db250YWluZXJNb3VzZUxlYXZlKTtsYnx8KFQoQixcIm1vdXNldXBcIix0aGlzLm9uRG9jdW1lbnRNb3VzZVVwKSxUKEIsXCJ0b3VjaGVuZFwiLHRoaXMub25Eb2N1bWVudFRvdWNoRW5kKSk7Y2xlYXJJbnRlcnZhbCh0aGlzLnRvb2x0aXBUaW1lb3V0KTtmb3IoYSBpbiB0aGlzKXRoaXNbYV09bnVsbH19O3goei5Qb2ludGVyLnByb3RvdHlwZSx7cGluY2hUcmFuc2xhdGU6ZnVuY3Rpb24oYSxiLGMsZCxlLGYpeyh0aGlzLnpvb21Ib3J8fHRoaXMucGluY2hIb3IpJiZ0aGlzLnBpbmNoVHJhbnNsYXRlRGlyZWN0aW9uKCEwLGEsYixjLGQsZSxmKTsodGhpcy56b29tVmVydHx8dGhpcy5waW5jaFZlcnQpJiZcbnRoaXMucGluY2hUcmFuc2xhdGVEaXJlY3Rpb24oITEsYSxiLGMsZCxlLGYpfSxwaW5jaFRyYW5zbGF0ZURpcmVjdGlvbjpmdW5jdGlvbihhLGIsYyxkLGUsZixnLGgpe3ZhciBpPXRoaXMuY2hhcnQsaj1hP1wieFwiOlwieVwiLGs9YT9cIlhcIjpcIllcIixsPVwiY2hhcnRcIitrLG09YT9cIndpZHRoXCI6XCJoZWlnaHRcIixvPWlbXCJwbG90XCIrKGE/XCJMZWZ0XCI6XCJUb3BcIildLHAscixBPWh8fDEscT1pLmludmVydGVkLG49aS5ib3VuZHNbYT9cImhcIjpcInZcIl0sdz1iLmxlbmd0aD09PTEsTz1iWzBdW2xdLHM9Y1swXVtsXSx2PSF3JiZiWzFdW2xdLHQ9IXcmJmNbMV1bbF0seSxjPWZ1bmN0aW9uKCl7IXcmJlMoTy12KT4yMCYmKEE9aHx8UyhzLXQpL1MoTy12KSk7cj0oby1zKS9BK087cD1pW1wicGxvdFwiKyhhP1wiV2lkdGhcIjpcIkhlaWdodFwiKV0vQX07YygpO2I9cjtiPG4ubWluPyhiPW4ubWluLHk9ITApOmIrcD5uLm1heCYmKGI9bi5tYXgtcCx5PSEwKTt5PyhzLT0wLjgqKHMtZ1tqXVswXSksd3x8KHQtPTAuOCoodC1cbmdbal1bMV0pKSxjKCkpOmdbal09W3MsdF07cXx8KGZbal09ci1vLGZbbV09cCk7Zj1xPzEvQTpBO2VbbV09cDtlW2pdPWI7ZFtxP2E/XCJzY2FsZVlcIjpcInNjYWxlWFwiOlwic2NhbGVcIitrXT1BO2RbXCJ0cmFuc2xhdGVcIitrXT1mKm8rKHMtZipPKX0scGluY2g6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcyxjPWIuY2hhcnQsZD1iLnBpbmNoRG93bixlPWEudG91Y2hlcyxmPWUubGVuZ3RoLGc9Yi5sYXN0VmFsaWRUb3VjaCxoPWIuaGFzWm9vbSxpPWIuc2VsZWN0aW9uTWFya2VyLGo9e30saz1mPT09MSYmKGIuaW5DbGFzcyhhLnRhcmdldCxcImhpZ2hjaGFydHMtdHJhY2tlclwiKSYmYy5ydW5UcmFja2VyQ2xpY2t8fGIucnVuQ2hhcnRDbGljayksbD17fTtpZihmPjEpYi5pbml0aWF0ZWQ9ITA7aCYmYi5pbml0aWF0ZWQmJiFrJiZhLnByZXZlbnREZWZhdWx0KCk7dGEoZSxmdW5jdGlvbihhKXtyZXR1cm4gYi5ub3JtYWxpemUoYSl9KTtpZihhLnR5cGU9PT1cInRvdWNoc3RhcnRcIiluKGUsZnVuY3Rpb24oYSxcbmIpe2RbYl09e2NoYXJ0WDphLmNoYXJ0WCxjaGFydFk6YS5jaGFydFl9fSksZy54PVtkWzBdLmNoYXJ0WCxkWzFdJiZkWzFdLmNoYXJ0WF0sZy55PVtkWzBdLmNoYXJ0WSxkWzFdJiZkWzFdLmNoYXJ0WV0sbihjLmF4ZXMsZnVuY3Rpb24oYSl7aWYoYS56b29tRW5hYmxlZCl7dmFyIGI9Yy5ib3VuZHNbYS5ob3Jpej9cImhcIjpcInZcIl0sZD1hLm1pblBpeGVsUGFkZGluZyxlPWEudG9QaXhlbHMocShhLm9wdGlvbnMubWluLGEuZGF0YU1pbikpLGY9YS50b1BpeGVscyhxKGEub3B0aW9ucy5tYXgsYS5kYXRhTWF4KSksZz1FKGUsZiksZT12KGUsZik7Yi5taW49RShhLnBvcyxnLWQpO2IubWF4PXYoYS5wb3MrYS5sZW4sZStkKX19KSxiLnJlcz0hMDtlbHNlIGlmKGQubGVuZ3RoKXtpZighaSliLnNlbGVjdGlvbk1hcmtlcj1pPXgoe2Rlc3Ryb3k6cmEsdG91Y2g6ITB9LGMucGxvdEJveCk7Yi5waW5jaFRyYW5zbGF0ZShkLGUsaixpLGwsZyk7Yi5oYXNQaW5jaGVkPWg7Yi5zY2FsZUdyb3VwcyhqLFxubCk7aWYoIWgmJmIuZm9sbG93VG91Y2hNb3ZlJiZmPT09MSl0aGlzLnJ1blBvaW50QWN0aW9ucyhiLm5vcm1hbGl6ZShhKSk7ZWxzZSBpZihiLnJlcyliLnJlcz0hMSx0aGlzLnJlc2V0KCExLDApfX0sdG91Y2g6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmNoYXJ0LGQ7b2E9Yy5pbmRleDtpZihhLnRvdWNoZXMubGVuZ3RoPT09MSlpZihhPXRoaXMubm9ybWFsaXplKGEpLGMuaXNJbnNpZGVQbG90KGEuY2hhcnRYLWMucGxvdExlZnQsYS5jaGFydFktYy5wbG90VG9wKSYmIWMub3Blbk1lbnUpe2ImJnRoaXMucnVuUG9pbnRBY3Rpb25zKGEpO2lmKGEudHlwZT09PVwidG91Y2htb3ZlXCIpYz10aGlzLnBpbmNoRG93bixkPU1hdGguc3FydChNYXRoLnBvdyhjWzBdLmNoYXJ0WC1hLmNoYXJ0WCwyKStNYXRoLnBvdyhjWzBdLmNoYXJ0WS1hLmNoYXJ0WSwyKSk+PTQ7cShkLCEwKSYmdGhpcy5waW5jaChhKX1lbHNlIGImJnRoaXMucmVzZXQoKTtlbHNlIGEudG91Y2hlcy5sZW5ndGg9PT0yJiZcbnRoaXMucGluY2goYSl9LG9uQ29udGFpbmVyVG91Y2hTdGFydDpmdW5jdGlvbihhKXt0aGlzLnRvdWNoKGEsITApfSxvbkNvbnRhaW5lclRvdWNoTW92ZTpmdW5jdGlvbihhKXt0aGlzLnRvdWNoKGEpfSxvbkRvY3VtZW50VG91Y2hFbmQ6ZnVuY3Rpb24oYSl7JFtvYV0mJiRbb2FdLnBvaW50ZXIuZHJvcChhKX19KTtpZihKLlBvaW50ZXJFdmVudHx8Si5NU1BvaW50ZXJFdmVudCl7dmFyIEdhPXt9LE1iPSEhSi5Qb2ludGVyRXZlbnQsYWM9ZnVuY3Rpb24oKXt2YXIgYSxiPVtdO2IuaXRlbT1mdW5jdGlvbihhKXtyZXR1cm4gdGhpc1thXX07Zm9yKGEgaW4gR2EpR2EuaGFzT3duUHJvcGVydHkoYSkmJmIucHVzaCh7cGFnZVg6R2FbYV0ucGFnZVgscGFnZVk6R2FbYV0ucGFnZVksdGFyZ2V0OkdhW2FdLnRhcmdldH0pO3JldHVybiBifSxOYj1mdW5jdGlvbihhLGIsYyxkKXtpZigoYS5wb2ludGVyVHlwZT09PVwidG91Y2hcInx8YS5wb2ludGVyVHlwZT09PWEuTVNQT0lOVEVSX1RZUEVfVE9VQ0gpJiZcbiRbb2FdKWQoYSksZD0kW29hXS5wb2ludGVyLGRbYl0oe3R5cGU6Yyx0YXJnZXQ6YS5jdXJyZW50VGFyZ2V0LHByZXZlbnREZWZhdWx0OnJhLHRvdWNoZXM6YWMoKX0pfTt4KFphLnByb3RvdHlwZSx7b25Db250YWluZXJQb2ludGVyRG93bjpmdW5jdGlvbihhKXtOYihhLFwib25Db250YWluZXJUb3VjaFN0YXJ0XCIsXCJ0b3VjaHN0YXJ0XCIsZnVuY3Rpb24oYSl7R2FbYS5wb2ludGVySWRdPXtwYWdlWDphLnBhZ2VYLHBhZ2VZOmEucGFnZVksdGFyZ2V0OmEuY3VycmVudFRhcmdldH19KX0sb25Db250YWluZXJQb2ludGVyTW92ZTpmdW5jdGlvbihhKXtOYihhLFwib25Db250YWluZXJUb3VjaE1vdmVcIixcInRvdWNobW92ZVwiLGZ1bmN0aW9uKGEpe0dhW2EucG9pbnRlcklkXT17cGFnZVg6YS5wYWdlWCxwYWdlWTphLnBhZ2VZfTtpZighR2FbYS5wb2ludGVySWRdLnRhcmdldClHYVthLnBvaW50ZXJJZF0udGFyZ2V0PWEuY3VycmVudFRhcmdldH0pfSxvbkRvY3VtZW50UG9pbnRlclVwOmZ1bmN0aW9uKGEpe05iKGEsXG5cIm9uRG9jdW1lbnRUb3VjaEVuZFwiLFwidG91Y2hlbmRcIixmdW5jdGlvbihhKXtkZWxldGUgR2FbYS5wb2ludGVySWRdfSl9LGJhdGNoTVNFdmVudHM6ZnVuY3Rpb24oYSl7YSh0aGlzLmNoYXJ0LmNvbnRhaW5lcixNYj9cInBvaW50ZXJkb3duXCI6XCJNU1BvaW50ZXJEb3duXCIsdGhpcy5vbkNvbnRhaW5lclBvaW50ZXJEb3duKTthKHRoaXMuY2hhcnQuY29udGFpbmVyLE1iP1wicG9pbnRlcm1vdmVcIjpcIk1TUG9pbnRlck1vdmVcIix0aGlzLm9uQ29udGFpbmVyUG9pbnRlck1vdmUpO2EoQixNYj9cInBvaW50ZXJ1cFwiOlwiTVNQb2ludGVyVXBcIix0aGlzLm9uRG9jdW1lbnRQb2ludGVyVXApfX0pO1UoWmEucHJvdG90eXBlLFwiaW5pdFwiLGZ1bmN0aW9uKGEsYixjKXthLmNhbGwodGhpcyxiLGMpO3RoaXMuaGFzWm9vbSYmRihiLmNvbnRhaW5lcix7XCItbXMtdG91Y2gtYWN0aW9uXCI6XCJub25lXCIsXCJ0b3VjaC1hY3Rpb25cIjpcIm5vbmVcIn0pfSk7VShaYS5wcm90b3R5cGUsXCJzZXRET01FdmVudHNcIixmdW5jdGlvbihhKXthLmFwcGx5KHRoaXMpO1xuKHRoaXMuaGFzWm9vbXx8dGhpcy5mb2xsb3dUb3VjaE1vdmUpJiZ0aGlzLmJhdGNoTVNFdmVudHMoRCl9KTtVKFphLnByb3RvdHlwZSxcImRlc3Ryb3lcIixmdW5jdGlvbihhKXt0aGlzLmJhdGNoTVNFdmVudHMoVCk7YS5jYWxsKHRoaXMpfSl9dmFyIHZiPXouTGVnZW5kPWZ1bmN0aW9uKGEsYil7dGhpcy5pbml0KGEsYil9O3ZiLnByb3RvdHlwZT17aW5pdDpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMsZD1iLml0ZW1TdHlsZSxlPWIuaXRlbU1hcmdpblRvcHx8MDt0aGlzLm9wdGlvbnM9YjtpZihiLmVuYWJsZWQpYy5pdGVtU3R5bGU9ZCxjLml0ZW1IaWRkZW5TdHlsZT1DKGQsYi5pdGVtSGlkZGVuU3R5bGUpLGMuaXRlbU1hcmdpblRvcD1lLGMucGFkZGluZz1kPXEoYi5wYWRkaW5nLDgpLGMuaW5pdGlhbEl0ZW1YPWQsYy5pbml0aWFsSXRlbVk9ZC01LGMubWF4SXRlbVdpZHRoPTAsYy5jaGFydD1hLGMuaXRlbUhlaWdodD0wLGMuc3ltYm9sV2lkdGg9cShiLnN5bWJvbFdpZHRoLDE2KSxcbmMucGFnZXM9W10sYy5yZW5kZXIoKSxEKGMuY2hhcnQsXCJlbmRSZXNpemVcIixmdW5jdGlvbigpe2MucG9zaXRpb25DaGVja2JveGVzKCl9KX0sY29sb3JpemVJdGVtOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5vcHRpb25zLGQ9YS5sZWdlbmRJdGVtLGU9YS5sZWdlbmRMaW5lLGY9YS5sZWdlbmRTeW1ib2wsZz10aGlzLml0ZW1IaWRkZW5TdHlsZS5jb2xvcixjPWI/Yy5pdGVtU3R5bGUuY29sb3I6ZyxoPWI/YS5sZWdlbmRDb2xvcnx8YS5jb2xvcnx8XCIjQ0NDXCI6ZyxnPWEub3B0aW9ucyYmYS5vcHRpb25zLm1hcmtlcixpPXtmaWxsOmh9LGo7ZCYmZC5jc3Moe2ZpbGw6Yyxjb2xvcjpjfSk7ZSYmZS5hdHRyKHtzdHJva2U6aH0pO2lmKGYpe2lmKGcmJmYuaXNNYXJrZXIpZm9yKGogaW4gaS5zdHJva2U9aCxnPWEuY29udmVydEF0dHJpYnMoZyksZylkPWdbal0sZCE9PXQmJihpW2pdPWQpO2YuYXR0cihpKX19LHBvc2l0aW9uSXRlbTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLm9wdGlvbnMsXG5jPWIuc3ltYm9sUGFkZGluZyxiPSFiLnJ0bCxkPWEuX2xlZ2VuZEl0ZW1Qb3MsZT1kWzBdLGQ9ZFsxXSxmPWEuY2hlY2tib3g7KGE9YS5sZWdlbmRHcm91cCkmJmEuZWxlbWVudCYmYS50cmFuc2xhdGUoYj9lOnRoaXMubGVnZW5kV2lkdGgtZS0yKmMtNCxkKTtpZihmKWYueD1lLGYueT1kfSxkZXN0cm95SXRlbTpmdW5jdGlvbihhKXt2YXIgYj1hLmNoZWNrYm94O24oW1wibGVnZW5kSXRlbVwiLFwibGVnZW5kTGluZVwiLFwibGVnZW5kU3ltYm9sXCIsXCJsZWdlbmRHcm91cFwiXSxmdW5jdGlvbihiKXthW2JdJiYoYVtiXT1hW2JdLmRlc3Ryb3koKSl9KTtiJiZWYShhLmNoZWNrYm94KX0sZGVzdHJveTpmdW5jdGlvbigpe3ZhciBhPXRoaXMuZ3JvdXAsYj10aGlzLmJveDtpZihiKXRoaXMuYm94PWIuZGVzdHJveSgpO2lmKGEpdGhpcy5ncm91cD1hLmRlc3Ryb3koKX0scG9zaXRpb25DaGVja2JveGVzOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuZ3JvdXAuYWxpZ25BdHRyLGMsZD10aGlzLmNsaXBIZWlnaHR8fFxudGhpcy5sZWdlbmRIZWlnaHQsZT10aGlzLnRpdGxlSGVpZ2h0O2lmKGIpYz1iLnRyYW5zbGF0ZVksbih0aGlzLmFsbEl0ZW1zLGZ1bmN0aW9uKGYpe3ZhciBnPWYuY2hlY2tib3gsaDtnJiYoaD1jK2UrZy55KyhhfHwwKSszLEYoZyx7bGVmdDpiLnRyYW5zbGF0ZVgrZi5jaGVja2JveE9mZnNldCtnLngtMjArXCJweFwiLHRvcDpoK1wicHhcIixkaXNwbGF5Omg+Yy02JiZoPGMrZC02P1wiXCI6XCJub25lXCJ9KSl9KX0scmVuZGVyVGl0bGU6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLnBhZGRpbmcsYj10aGlzLm9wdGlvbnMudGl0bGUsYz0wO2lmKGIudGV4dCl7aWYoIXRoaXMudGl0bGUpdGhpcy50aXRsZT10aGlzLmNoYXJ0LnJlbmRlcmVyLmxhYmVsKGIudGV4dCxhLTMsYS00LG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxcImxlZ2VuZC10aXRsZVwiKS5hdHRyKHt6SW5kZXg6MX0pLmNzcyhiLnN0eWxlKS5hZGQodGhpcy5ncm91cCk7YT10aGlzLnRpdGxlLmdldEJCb3goKTtjPWEuaGVpZ2h0O3RoaXMub2Zmc2V0V2lkdGg9XG5hLndpZHRoO3RoaXMuY29udGVudEdyb3VwLmF0dHIoe3RyYW5zbGF0ZVk6Y30pfXRoaXMudGl0bGVIZWlnaHQ9Y30sc2V0VGV4dDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLm9wdGlvbnM7YS5sZWdlbmRJdGVtLmF0dHIoe3RleHQ6Yi5sYWJlbEZvcm1hdD9MYShiLmxhYmVsRm9ybWF0LGEpOmIubGFiZWxGb3JtYXR0ZXIuY2FsbChhKX0pfSxyZW5kZXJJdGVtOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY2hhcnQsYz1iLnJlbmRlcmVyLGQ9dGhpcy5vcHRpb25zLGU9ZC5sYXlvdXQ9PT1cImhvcml6b250YWxcIixmPXRoaXMuc3ltYm9sV2lkdGgsZz1kLnN5bWJvbFBhZGRpbmcsaD10aGlzLml0ZW1TdHlsZSxpPXRoaXMuaXRlbUhpZGRlblN0eWxlLGo9dGhpcy5wYWRkaW5nLGs9ZT9xKGQuaXRlbURpc3RhbmNlLDIwKTowLGw9IWQucnRsLG09ZC53aWR0aCxvPWQuaXRlbU1hcmdpbkJvdHRvbXx8MCxwPXRoaXMuaXRlbU1hcmdpblRvcCxyPXRoaXMuaW5pdGlhbEl0ZW1YLEE9YS5sZWdlbmRJdGVtLFxubj1hLnNlcmllcyYmYS5zZXJpZXMuZHJhd0xlZ2VuZFN5bWJvbD9hLnNlcmllczphLHU9bi5vcHRpb25zLHU9dGhpcy5jcmVhdGVDaGVja2JveEZvckl0ZW0mJnUmJnUuc2hvd0NoZWNrYm94LHc9ZC51c2VIVE1MO2lmKCFBKXthLmxlZ2VuZEdyb3VwPWMuZyhcImxlZ2VuZC1pdGVtXCIpLmF0dHIoe3pJbmRleDoxfSkuYWRkKHRoaXMuc2Nyb2xsR3JvdXApO2EubGVnZW5kSXRlbT1BPWMudGV4dChcIlwiLGw/ZitnOi1nLHRoaXMuYmFzZWxpbmV8fDAsdykuY3NzKEMoYS52aXNpYmxlP2g6aSkpLmF0dHIoe2FsaWduOmw/XCJsZWZ0XCI6XCJyaWdodFwiLHpJbmRleDoyfSkuYWRkKGEubGVnZW5kR3JvdXApO2lmKCF0aGlzLmJhc2VsaW5lKXRoaXMuZm9udE1ldHJpY3M9Yy5mb250TWV0cmljcyhoLmZvbnRTaXplLEEpLHRoaXMuYmFzZWxpbmU9dGhpcy5mb250TWV0cmljcy5mKzMrcCxBLmF0dHIoXCJ5XCIsdGhpcy5iYXNlbGluZSk7bi5kcmF3TGVnZW5kU3ltYm9sKHRoaXMsYSk7dGhpcy5zZXRJdGVtRXZlbnRzJiZcbnRoaXMuc2V0SXRlbUV2ZW50cyhhLEEsdyxoLGkpO3UmJnRoaXMuY3JlYXRlQ2hlY2tib3hGb3JJdGVtKGEpfXRoaXMuY29sb3JpemVJdGVtKGEsYS52aXNpYmxlKTt0aGlzLnNldFRleHQoYSk7Yz1BLmdldEJCb3goKTtmPWEuY2hlY2tib3hPZmZzZXQ9ZC5pdGVtV2lkdGh8fGEubGVnZW5kSXRlbVdpZHRofHxmK2crYy53aWR0aCtrKyh1PzIwOjApO3RoaXMuaXRlbUhlaWdodD1nPXkoYS5sZWdlbmRJdGVtSGVpZ2h0fHxjLmhlaWdodCk7aWYoZSYmdGhpcy5pdGVtWC1yK2Y+KG18fGIuY2hhcnRXaWR0aC0yKmotci1kLngpKXRoaXMuaXRlbVg9cix0aGlzLml0ZW1ZKz1wK3RoaXMubGFzdExpbmVIZWlnaHQrbyx0aGlzLmxhc3RMaW5lSGVpZ2h0PTA7dGhpcy5tYXhJdGVtV2lkdGg9dih0aGlzLm1heEl0ZW1XaWR0aCxmKTt0aGlzLmxhc3RJdGVtWT1wK3RoaXMuaXRlbVkrbzt0aGlzLmxhc3RMaW5lSGVpZ2h0PXYoZyx0aGlzLmxhc3RMaW5lSGVpZ2h0KTthLl9sZWdlbmRJdGVtUG9zPVxuW3RoaXMuaXRlbVgsdGhpcy5pdGVtWV07ZT90aGlzLml0ZW1YKz1mOih0aGlzLml0ZW1ZKz1wK2crbyx0aGlzLmxhc3RMaW5lSGVpZ2h0PWcpO3RoaXMub2Zmc2V0V2lkdGg9bXx8digoZT90aGlzLml0ZW1YLXItazpmKStqLHRoaXMub2Zmc2V0V2lkdGgpfSxnZXRBbGxJdGVtczpmdW5jdGlvbigpe3ZhciBhPVtdO24odGhpcy5jaGFydC5zZXJpZXMsZnVuY3Rpb24oYil7dmFyIGM9Yi5vcHRpb25zO2lmKHEoYy5zaG93SW5MZWdlbmQsIXMoYy5saW5rZWRUbyk/dDohMSwhMCkpYT1hLmNvbmNhdChiLmxlZ2VuZEl0ZW1zfHwoYy5sZWdlbmRUeXBlPT09XCJwb2ludFwiP2IuZGF0YTpiKSl9KTtyZXR1cm4gYX0sYWRqdXN0TWFyZ2luczpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuY2hhcnQsZD10aGlzLm9wdGlvbnMsZT1kLmFsaWduLmNoYXJBdCgwKStkLnZlcnRpY2FsQWxpZ24uY2hhckF0KDApK2QubGF5b3V0LmNoYXJBdCgwKTt0aGlzLmRpc3BsYXkmJiFkLmZsb2F0aW5nJiZuKFsvKGx0aHxjdHxydGgpLyxcbi8ocnR2fHJtfHJidikvLC8ocmJofGNifGxiaCkvLC8obGJ2fGxtfGx0dikvXSxmdW5jdGlvbihmLGcpe2YudGVzdChlKSYmIXMoYVtnXSkmJihjW3ViW2ddXT12KGNbdWJbZ11dLGMubGVnZW5kWyhnKzEpJTI/XCJsZWdlbmRIZWlnaHRcIjpcImxlZ2VuZFdpZHRoXCJdK1sxLC0xLC0xLDFdW2ddKmRbZyUyP1wieFwiOlwieVwiXStxKGQubWFyZ2luLDEyKStiW2ddKSl9KX0scmVuZGVyOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEuY2hhcnQsYz1iLnJlbmRlcmVyLGQ9YS5ncm91cCxlLGYsZyxoLGk9YS5ib3gsaj1hLm9wdGlvbnMsaz1hLnBhZGRpbmcsbD1qLmJvcmRlcldpZHRoLG09ai5iYWNrZ3JvdW5kQ29sb3I7YS5pdGVtWD1hLmluaXRpYWxJdGVtWDthLml0ZW1ZPWEuaW5pdGlhbEl0ZW1ZO2Eub2Zmc2V0V2lkdGg9MDthLmxhc3RJdGVtWT0wO2lmKCFkKWEuZ3JvdXA9ZD1jLmcoXCJsZWdlbmRcIikuYXR0cih7ekluZGV4Ojd9KS5hZGQoKSxhLmNvbnRlbnRHcm91cD1jLmcoKS5hdHRyKHt6SW5kZXg6MX0pLmFkZChkKSxcbmEuc2Nyb2xsR3JvdXA9Yy5nKCkuYWRkKGEuY29udGVudEdyb3VwKTthLnJlbmRlclRpdGxlKCk7ZT1hLmdldEFsbEl0ZW1zKCk7b2IoZSxmdW5jdGlvbihhLGIpe3JldHVybihhLm9wdGlvbnMmJmEub3B0aW9ucy5sZWdlbmRJbmRleHx8MCktKGIub3B0aW9ucyYmYi5vcHRpb25zLmxlZ2VuZEluZGV4fHwwKX0pO2oucmV2ZXJzZWQmJmUucmV2ZXJzZSgpO2EuYWxsSXRlbXM9ZTthLmRpc3BsYXk9Zj0hIWUubGVuZ3RoO2EubGFzdExpbmVIZWlnaHQ9MDtuKGUsZnVuY3Rpb24oYil7YS5yZW5kZXJJdGVtKGIpfSk7Zz0oai53aWR0aHx8YS5vZmZzZXRXaWR0aCkraztoPWEubGFzdEl0ZW1ZK2EubGFzdExpbmVIZWlnaHQrYS50aXRsZUhlaWdodDtoPWEuaGFuZGxlT3ZlcmZsb3coaCk7aCs9aztpZihsfHxtKXtpZihpKXtpZihnPjAmJmg+MClpW2kuaXNOZXc/XCJhdHRyXCI6XCJhbmltYXRlXCJdKGkuY3Jpc3Aoe3dpZHRoOmcsaGVpZ2h0Omh9KSksaS5pc05ldz0hMX1lbHNlIGEuYm94PWk9Yy5yZWN0KDAsXG4wLGcsaCxqLmJvcmRlclJhZGl1cyxsfHwwKS5hdHRyKHtzdHJva2U6ai5ib3JkZXJDb2xvcixcInN0cm9rZS13aWR0aFwiOmx8fDAsZmlsbDptfHxcIm5vbmVcIn0pLmFkZChkKS5zaGFkb3coai5zaGFkb3cpLGkuaXNOZXc9ITA7aVtmP1wic2hvd1wiOlwiaGlkZVwiXSgpfWEubGVnZW5kV2lkdGg9ZzthLmxlZ2VuZEhlaWdodD1oO24oZSxmdW5jdGlvbihiKXthLnBvc2l0aW9uSXRlbShiKX0pO2YmJmQuYWxpZ24oeCh7d2lkdGg6ZyxoZWlnaHQ6aH0saiksITAsXCJzcGFjaW5nQm94XCIpO2IuaXNSZXNpemluZ3x8dGhpcy5wb3NpdGlvbkNoZWNrYm94ZXMoKX0saGFuZGxlT3ZlcmZsb3c6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcyxjPXRoaXMuY2hhcnQsZD1jLnJlbmRlcmVyLGU9dGhpcy5vcHRpb25zLGY9ZS55LGY9Yy5zcGFjaW5nQm94LmhlaWdodCsoZS52ZXJ0aWNhbEFsaWduPT09XCJ0b3BcIj8tZjpmKS10aGlzLnBhZGRpbmcsZz1lLm1heEhlaWdodCxoLGk9dGhpcy5jbGlwUmVjdCxqPWUubmF2aWdhdGlvbixcbms9cShqLmFuaW1hdGlvbiwhMCksbD1qLmFycm93U2l6ZXx8MTIsbT10aGlzLm5hdixvPXRoaXMucGFnZXMscD10aGlzLnBhZGRpbmcscixBPXRoaXMuYWxsSXRlbXMsUD1mdW5jdGlvbihhKXtpLmF0dHIoe2hlaWdodDphfSk7aWYoYi5jb250ZW50R3JvdXAuZGl2KWIuY29udGVudEdyb3VwLmRpdi5zdHlsZS5jbGlwPVwicmVjdChcIitwK1wicHgsOTk5OXB4LFwiKyhwK2EpK1wicHgsMClcIn07ZS5sYXlvdXQ9PT1cImhvcml6b250YWxcIiYmKGYvPTIpO2cmJihmPUUoZixnKSk7by5sZW5ndGg9MDtpZihhPmYmJmouZW5hYmxlZCE9PSExKXt0aGlzLmNsaXBIZWlnaHQ9aD12KGYtMjAtdGhpcy50aXRsZUhlaWdodC1wLDApO3RoaXMuY3VycmVudFBhZ2U9cSh0aGlzLmN1cnJlbnRQYWdlLDEpO3RoaXMuZnVsbEhlaWdodD1hO24oQSxmdW5jdGlvbihhLGIpe3ZhciBjPWEuX2xlZ2VuZEl0ZW1Qb3NbMV0sZD15KGEubGVnZW5kSXRlbS5nZXRCQm94KCkuaGVpZ2h0KSxlPW8ubGVuZ3RoO2lmKCFlfHxjLVxub1tlLTFdPmgmJihyfHxjKSE9PW9bZS0xXSlvLnB1c2gocnx8YyksZSsrO2I9PT1BLmxlbmd0aC0xJiZjK2Qtb1tlLTFdPmgmJm8ucHVzaChjKTtjIT09ciYmKHI9Yyl9KTtpZighaSlpPWIuY2xpcFJlY3Q9ZC5jbGlwUmVjdCgwLHAsOTk5OSwwKSxiLmNvbnRlbnRHcm91cC5jbGlwKGkpO1AoaCk7aWYoIW0pdGhpcy5uYXY9bT1kLmcoKS5hdHRyKHt6SW5kZXg6MX0pLmFkZCh0aGlzLmdyb3VwKSx0aGlzLnVwPWQuc3ltYm9sKFwidHJpYW5nbGVcIiwwLDAsbCxsKS5vbihcImNsaWNrXCIsZnVuY3Rpb24oKXtiLnNjcm9sbCgtMSxrKX0pLmFkZChtKSx0aGlzLnBhZ2VyPWQudGV4dChcIlwiLDE1LDEwKS5jc3Moai5zdHlsZSkuYWRkKG0pLHRoaXMuZG93bj1kLnN5bWJvbChcInRyaWFuZ2xlLWRvd25cIiwwLDAsbCxsKS5vbihcImNsaWNrXCIsZnVuY3Rpb24oKXtiLnNjcm9sbCgxLGspfSkuYWRkKG0pO2Iuc2Nyb2xsKDApO2E9Zn1lbHNlIGlmKG0pUChjLmNoYXJ0SGVpZ2h0KSxtLmhpZGUoKSx0aGlzLnNjcm9sbEdyb3VwLmF0dHIoe3RyYW5zbGF0ZVk6MX0pLFxudGhpcy5jbGlwSGVpZ2h0PTA7cmV0dXJuIGF9LHNjcm9sbDpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMucGFnZXMsZD1jLmxlbmd0aCxlPXRoaXMuY3VycmVudFBhZ2UrYSxmPXRoaXMuY2xpcEhlaWdodCxnPXRoaXMub3B0aW9ucy5uYXZpZ2F0aW9uLGg9Zy5hY3RpdmVDb2xvcixnPWcuaW5hY3RpdmVDb2xvcixpPXRoaXMucGFnZXIsaj10aGlzLnBhZGRpbmc7ZT5kJiYoZT1kKTtpZihlPjApYiE9PXQmJmFiKGIsdGhpcy5jaGFydCksdGhpcy5uYXYuYXR0cih7dHJhbnNsYXRlWDpqLHRyYW5zbGF0ZVk6Zit0aGlzLnBhZGRpbmcrNyt0aGlzLnRpdGxlSGVpZ2h0LHZpc2liaWxpdHk6XCJ2aXNpYmxlXCJ9KSx0aGlzLnVwLmF0dHIoe2ZpbGw6ZT09PTE/ZzpofSkuY3NzKHtjdXJzb3I6ZT09PTE/XCJkZWZhdWx0XCI6XCJwb2ludGVyXCJ9KSxpLmF0dHIoe3RleHQ6ZStcIi9cIitkfSksdGhpcy5kb3duLmF0dHIoe3g6MTgrdGhpcy5wYWdlci5nZXRCQm94KCkud2lkdGgsZmlsbDplPT09ZD9nOmh9KS5jc3Moe2N1cnNvcjplPT09XG5kP1wiZGVmYXVsdFwiOlwicG9pbnRlclwifSksYz0tY1tlLTFdK3RoaXMuaW5pdGlhbEl0ZW1ZLHRoaXMuc2Nyb2xsR3JvdXAuYW5pbWF0ZSh7dHJhbnNsYXRlWTpjfSksdGhpcy5jdXJyZW50UGFnZT1lLHRoaXMucG9zaXRpb25DaGVja2JveGVzKGMpfX07YWE9ei5MZWdlbmRTeW1ib2xNaXhpbj17ZHJhd1JlY3RhbmdsZTpmdW5jdGlvbihhLGIpe3ZhciBjPWEub3B0aW9ucy5zeW1ib2xIZWlnaHR8fGEuZm9udE1ldHJpY3MuZjtiLmxlZ2VuZFN5bWJvbD10aGlzLmNoYXJ0LnJlbmRlcmVyLnJlY3QoMCxhLmJhc2VsaW5lLWMrMSxhLnN5bWJvbFdpZHRoLGMsYS5vcHRpb25zLnN5bWJvbFJhZGl1c3x8MCkuYXR0cih7ekluZGV4OjN9KS5hZGQoYi5sZWdlbmRHcm91cCl9LGRyYXdMaW5lTWFya2VyOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMub3B0aW9ucyxjPWIubWFya2VyLGQ9YS5zeW1ib2xXaWR0aCxlPXRoaXMuY2hhcnQucmVuZGVyZXIsZj10aGlzLmxlZ2VuZEdyb3VwLGE9YS5iYXNlbGluZS1cbnkoYS5mb250TWV0cmljcy5iKjAuMyksZztpZihiLmxpbmVXaWR0aCl7Zz17XCJzdHJva2Utd2lkdGhcIjpiLmxpbmVXaWR0aH07aWYoYi5kYXNoU3R5bGUpZy5kYXNoc3R5bGU9Yi5kYXNoU3R5bGU7dGhpcy5sZWdlbmRMaW5lPWUucGF0aChbXCJNXCIsMCxhLFwiTFwiLGQsYV0pLmF0dHIoZykuYWRkKGYpfWlmKGMmJmMuZW5hYmxlZCE9PSExKWI9Yy5yYWRpdXMsdGhpcy5sZWdlbmRTeW1ib2w9Yz1lLnN5bWJvbCh0aGlzLnN5bWJvbCxkLzItYixhLWIsMipiLDIqYixjKS5hZGQoZiksYy5pc01hcmtlcj0hMH19OygvVHJpZGVudFxcLzdcXC4wLy50ZXN0KE1hKXx8WGEpJiZVKHZiLnByb3RvdHlwZSxcInBvc2l0aW9uSXRlbVwiLGZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcyxkPWZ1bmN0aW9uKCl7Yi5fbGVnZW5kSXRlbVBvcyYmYS5jYWxsKGMsYil9O2QoKTtzZXRUaW1lb3V0KGQpfSk7dmFyIENhPXouQ2hhcnQ9ZnVuY3Rpb24oKXt0aGlzLmdldEFyZ3MuYXBwbHkodGhpcyxhcmd1bWVudHMpfTt6LmNoYXJ0PVxuZnVuY3Rpb24oYSxiLGMpe3JldHVybiBuZXcgQ2EoYSxiLGMpfTtDYS5wcm90b3R5cGU9e2NhbGxiYWNrczpbXSxnZXRBcmdzOmZ1bmN0aW9uKCl7dmFyIGE9W10uc2xpY2UuY2FsbChhcmd1bWVudHMpO2lmKERhKGFbMF0pfHxhWzBdLm5vZGVOYW1lKXRoaXMucmVuZGVyVG89YS5zaGlmdCgpO3RoaXMuaW5pdChhWzBdLGFbMV0pfSxpbml0OmZ1bmN0aW9uKGEsYil7dmFyIGMsZD1hLnNlcmllczthLnNlcmllcz1udWxsO2M9QyhOLGEpO2Muc2VyaWVzPWEuc2VyaWVzPWQ7dGhpcy51c2VyT3B0aW9ucz1hO2Q9Yy5jaGFydDt0aGlzLm1hcmdpbj10aGlzLnNwbGFzaEFycmF5KFwibWFyZ2luXCIsZCk7dGhpcy5zcGFjaW5nPXRoaXMuc3BsYXNoQXJyYXkoXCJzcGFjaW5nXCIsZCk7dmFyIGU9ZC5ldmVudHM7dGhpcy5ib3VuZHM9e2g6e30sdjp7fX07dGhpcy5jYWxsYmFjaz1iO3RoaXMuaXNSZXNpemluZz0wO3RoaXMub3B0aW9ucz1jO3RoaXMuYXhlcz1bXTt0aGlzLnNlcmllcz1bXTt0aGlzLmhhc0NhcnRlc2lhblNlcmllcz1cbmQuc2hvd0F4ZXM7dmFyIGY9dGhpcyxnO2YuaW5kZXg9JC5sZW5ndGg7JC5wdXNoKGYpO2xiKys7ZC5yZWZsb3chPT0hMSYmRChmLFwibG9hZFwiLGZ1bmN0aW9uKCl7Zi5pbml0UmVmbG93KCl9KTtpZihlKWZvcihnIGluIGUpRChmLGcsZVtnXSk7Zi54QXhpcz1bXTtmLnlBeGlzPVtdO2YuYW5pbWF0aW9uPXFhPyExOnEoZC5hbmltYXRpb24sITApO2YucG9pbnRDb3VudD1mLmNvbG9yQ291bnRlcj1mLnN5bWJvbENvdW50ZXI9MDtmLmZpcnN0UmVuZGVyKCl9LGluaXRTZXJpZXM6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5vcHRpb25zLmNoYXJ0OyhiPUtbYS50eXBlfHxiLnR5cGV8fGIuZGVmYXVsdFNlcmllc1R5cGVdKXx8Z2EoMTcsITApO2I9bmV3IGI7Yi5pbml0KHRoaXMsYSk7cmV0dXJuIGJ9LGlzSW5zaWRlUGxvdDpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9Yz9iOmEsYT1jP2E6YjtyZXR1cm4gZD49MCYmZDw9dGhpcy5wbG90V2lkdGgmJmE+PTAmJmE8PXRoaXMucGxvdEhlaWdodH0sXG5yZWRyYXc6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5heGVzLGM9dGhpcy5zZXJpZXMsZD10aGlzLnBvaW50ZXIsZT10aGlzLmxlZ2VuZCxmPXRoaXMuaXNEaXJ0eUxlZ2VuZCxnLGgsaT10aGlzLmhhc0NhcnRlc2lhblNlcmllcyxqPXRoaXMuaXNEaXJ0eUJveCxrPWMubGVuZ3RoLGw9ayxtPXRoaXMucmVuZGVyZXIsbz1tLmlzSGlkZGVuKCkscD1bXTthYihhLHRoaXMpO28mJnRoaXMuY2xvbmVSZW5kZXJUbygpO2Zvcih0aGlzLmxheU91dFRpdGxlcygpO2wtLTspaWYoYT1jW2xdLGEub3B0aW9ucy5zdGFja2luZyYmKGc9ITAsYS5pc0RpcnR5KSl7aD0hMDticmVha31pZihoKWZvcihsPWs7bC0tOylpZihhPWNbbF0sYS5vcHRpb25zLnN0YWNraW5nKWEuaXNEaXJ0eT0hMDtuKGMsZnVuY3Rpb24oYSl7YS5pc0RpcnR5JiZhLm9wdGlvbnMubGVnZW5kVHlwZT09PVwicG9pbnRcIiYmKGEudXBkYXRlVG90YWxzJiZhLnVwZGF0ZVRvdGFscygpLGY9ITApfSk7aWYoZiYmZS5vcHRpb25zLmVuYWJsZWQpZS5yZW5kZXIoKSxcbnRoaXMuaXNEaXJ0eUxlZ2VuZD0hMTtnJiZ0aGlzLmdldFN0YWNrcygpO2lmKGkmJiF0aGlzLmlzUmVzaXppbmcpdGhpcy5tYXhUaWNrcz1udWxsLG4oYixmdW5jdGlvbihhKXthLnNldFNjYWxlKCl9KTt0aGlzLmdldE1hcmdpbnMoKTtpJiYobihiLGZ1bmN0aW9uKGEpe2EuaXNEaXJ0eSYmKGo9ITApfSksbihiLGZ1bmN0aW9uKGEpe3ZhciBiPWEubWluK1wiLFwiK2EubWF4O2lmKGEuZXh0S2V5IT09YilhLmV4dEtleT1iLHAucHVzaChmdW5jdGlvbigpe00oYSxcImFmdGVyU2V0RXh0cmVtZXNcIix4KGEuZXZlbnRBcmdzLGEuZ2V0RXh0cmVtZXMoKSkpO2RlbGV0ZSBhLmV2ZW50QXJnc30pOyhqfHxnKSYmYS5yZWRyYXcoKX0pKTtqJiZ0aGlzLmRyYXdDaGFydEJveCgpO24oYyxmdW5jdGlvbihhKXthLmlzRGlydHkmJmEudmlzaWJsZSYmKCFhLmlzQ2FydGVzaWFufHxhLnhBeGlzKSYmYS5yZWRyYXcoKX0pO2QmJmQucmVzZXQoITApO20uZHJhdygpO00odGhpcyxcInJlZHJhd1wiKTtvJiZ0aGlzLmNsb25lUmVuZGVyVG8oITApO1xubihwLGZ1bmN0aW9uKGEpe2EuY2FsbCgpfSl9LGdldDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmF4ZXMsYz10aGlzLnNlcmllcyxkLGU7Zm9yKGQ9MDtkPGIubGVuZ3RoO2QrKylpZihiW2RdLm9wdGlvbnMuaWQ9PT1hKXJldHVybiBiW2RdO2ZvcihkPTA7ZDxjLmxlbmd0aDtkKyspaWYoY1tkXS5vcHRpb25zLmlkPT09YSlyZXR1cm4gY1tkXTtmb3IoZD0wO2Q8Yy5sZW5ndGg7ZCsrKXtlPWNbZF0ucG9pbnRzfHxbXTtmb3IoYj0wO2I8ZS5sZW5ndGg7YisrKWlmKGVbYl0uaWQ9PT1hKXJldHVybiBlW2JdfXJldHVybiBudWxsfSxnZXRBeGVzOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPXRoaXMub3B0aW9ucyxjPWIueEF4aXM9dmEoYi54QXhpc3x8e30pLGI9Yi55QXhpcz12YShiLnlBeGlzfHx7fSk7bihjLGZ1bmN0aW9uKGEsYil7YS5pbmRleD1iO2EuaXNYPSEwfSk7bihiLGZ1bmN0aW9uKGEsYil7YS5pbmRleD1ifSk7Yz1jLmNvbmNhdChiKTtuKGMsZnVuY3Rpb24oYil7bmV3IEkoYSxcbmIpfSl9LGdldFNlbGVjdGVkUG9pbnRzOmZ1bmN0aW9uKCl7dmFyIGE9W107bih0aGlzLnNlcmllcyxmdW5jdGlvbihiKXthPWEuY29uY2F0KFNhKGIucG9pbnRzfHxbXSxmdW5jdGlvbihhKXtyZXR1cm4gYS5zZWxlY3RlZH0pKX0pO3JldHVybiBhfSxnZXRTZWxlY3RlZFNlcmllczpmdW5jdGlvbigpe3JldHVybiBTYSh0aGlzLnNlcmllcyxmdW5jdGlvbihhKXtyZXR1cm4gYS5zZWxlY3RlZH0pfSxzZXRUaXRsZTpmdW5jdGlvbihhLGIsYyl7dmFyIGc7dmFyIGQ9dGhpcyxlPWQub3B0aW9ucyxmO2Y9ZS50aXRsZT1DKGUudGl0bGUsYSk7Zz1lLnN1YnRpdGxlPUMoZS5zdWJ0aXRsZSxiKSxlPWc7bihbW1widGl0bGVcIixhLGZdLFtcInN1YnRpdGxlXCIsYixlXV0sZnVuY3Rpb24oYSl7dmFyIGI9YVswXSxjPWRbYl0sZT1hWzFdLGE9YVsyXTtjJiZlJiYoZFtiXT1jPWMuZGVzdHJveSgpKTthJiZhLnRleHQmJiFjJiYoZFtiXT1kLnJlbmRlcmVyLnRleHQoYS50ZXh0LDAsMCxhLnVzZUhUTUwpLmF0dHIoe2FsaWduOmEuYWxpZ24sXG5cImNsYXNzXCI6XCJoaWdoY2hhcnRzLVwiK2IsekluZGV4OmEuekluZGV4fHw0fSkuY3NzKGEuc3R5bGUpLmFkZCgpKX0pO2QubGF5T3V0VGl0bGVzKGMpfSxsYXlPdXRUaXRsZXM6ZnVuY3Rpb24oYSl7dmFyIGI9MCxjPXRoaXMudGl0bGUsZD10aGlzLnN1YnRpdGxlLGU9dGhpcy5vcHRpb25zLGY9ZS50aXRsZSxlPWUuc3VidGl0bGUsZz10aGlzLnJlbmRlcmVyLGg9dGhpcy5zcGFjaW5nQm94LndpZHRoLTQ0O2lmKGMmJihjLmNzcyh7d2lkdGg6KGYud2lkdGh8fGgpK1wicHhcIn0pLmFsaWduKHgoe3k6Zy5mb250TWV0cmljcyhmLnN0eWxlLmZvbnRTaXplLGMpLmItM30sZiksITEsXCJzcGFjaW5nQm94XCIpLCFmLmZsb2F0aW5nJiYhZi52ZXJ0aWNhbEFsaWduKSliPWMuZ2V0QkJveCgpLmhlaWdodDtkJiYoZC5jc3Moe3dpZHRoOihlLndpZHRofHxoKStcInB4XCJ9KS5hbGlnbih4KHt5OmIrKGYubWFyZ2luLTEzKStnLmZvbnRNZXRyaWNzKGUuc3R5bGUuZm9udFNpemUsYykuYn0sZSksITEsXCJzcGFjaW5nQm94XCIpLFxuIWUuZmxvYXRpbmcmJiFlLnZlcnRpY2FsQWxpZ24mJihiPUZhKGIrZC5nZXRCQm94KCkuaGVpZ2h0KSkpO2M9dGhpcy50aXRsZU9mZnNldCE9PWI7dGhpcy50aXRsZU9mZnNldD1iO2lmKCF0aGlzLmlzRGlydHlCb3gmJmMpdGhpcy5pc0RpcnR5Qm94PWMsdGhpcy5oYXNSZW5kZXJlZCYmcShhLCEwKSYmdGhpcy5pc0RpcnR5Qm94JiZ0aGlzLnJlZHJhdygpfSxnZXRDaGFydFNpemU6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9wdGlvbnMuY2hhcnQsYj1hLndpZHRoLGE9YS5oZWlnaHQsYz10aGlzLnJlbmRlclRvQ2xvbmV8fHRoaXMucmVuZGVyVG87aWYoIXMoYikpdGhpcy5jb250YWluZXJXaWR0aD14YShjLFwid2lkdGhcIik7aWYoIXMoYSkpdGhpcy5jb250YWluZXJIZWlnaHQ9eGEoYyxcImhlaWdodFwiKTt0aGlzLmNoYXJ0V2lkdGg9digwLGJ8fHRoaXMuY29udGFpbmVyV2lkdGh8fDYwMCk7dGhpcy5jaGFydEhlaWdodD12KDAscShhLHRoaXMuY29udGFpbmVySGVpZ2h0PjE5P3RoaXMuY29udGFpbmVySGVpZ2h0OlxuNDAwKSl9LGNsb25lUmVuZGVyVG86ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5yZW5kZXJUb0Nsb25lLGM9dGhpcy5jb250YWluZXI7YT9iJiYodGhpcy5yZW5kZXJUby5hcHBlbmRDaGlsZChjKSxWYShiKSxkZWxldGUgdGhpcy5yZW5kZXJUb0Nsb25lKTooYyYmYy5wYXJlbnROb2RlPT09dGhpcy5yZW5kZXJUbyYmdGhpcy5yZW5kZXJUby5yZW1vdmVDaGlsZChjKSx0aGlzLnJlbmRlclRvQ2xvbmU9Yj10aGlzLnJlbmRlclRvLmNsb25lTm9kZSgwKSxGKGIse3Bvc2l0aW9uOlwiYWJzb2x1dGVcIix0b3A6XCItOTk5OXB4XCIsZGlzcGxheTpcImJsb2NrXCJ9KSxiLnN0eWxlLnNldFByb3BlcnR5JiZiLnN0eWxlLnNldFByb3BlcnR5KFwiZGlzcGxheVwiLFwiYmxvY2tcIixcImltcG9ydGFudFwiKSxCLmJvZHkuYXBwZW5kQ2hpbGQoYiksYyYmYi5hcHBlbmRDaGlsZChjKSl9LGdldENvbnRhaW5lcjpmdW5jdGlvbigpe3ZhciBhLGI9dGhpcy5vcHRpb25zLGM9Yi5jaGFydCxkLGU7YT10aGlzLnJlbmRlclRvO1xudmFyIGY9XCJoaWdoY2hhcnRzLVwiK0piKys7aWYoIWEpdGhpcy5yZW5kZXJUbz1hPWMucmVuZGVyVG87aWYoRGEoYSkpdGhpcy5yZW5kZXJUbz1hPUIuZ2V0RWxlbWVudEJ5SWQoYSk7YXx8Z2EoMTMsITApO2Q9RyhYKGEsXCJkYXRhLWhpZ2hjaGFydHMtY2hhcnRcIikpOyFpc05hTihkKSYmJFtkXSYmJFtkXS5oYXNSZW5kZXJlZCYmJFtkXS5kZXN0cm95KCk7WChhLFwiZGF0YS1oaWdoY2hhcnRzLWNoYXJ0XCIsdGhpcy5pbmRleCk7YS5pbm5lckhUTUw9XCJcIjshYy5za2lwQ2xvbmUmJiFhLm9mZnNldFdpZHRoJiZ0aGlzLmNsb25lUmVuZGVyVG8oKTt0aGlzLmdldENoYXJ0U2l6ZSgpO2Q9dGhpcy5jaGFydFdpZHRoO2U9dGhpcy5jaGFydEhlaWdodDt0aGlzLmNvbnRhaW5lcj1hPWVhKFdhLHtjbGFzc05hbWU6XCJoaWdoY2hhcnRzLWNvbnRhaW5lclwiKyhjLmNsYXNzTmFtZT9cIiBcIitjLmNsYXNzTmFtZTpcIlwiKSxpZDpmfSx4KHtwb3NpdGlvbjpcInJlbGF0aXZlXCIsb3ZlcmZsb3c6XCJoaWRkZW5cIix3aWR0aDpkK1xuXCJweFwiLGhlaWdodDplK1wicHhcIix0ZXh0QWxpZ246XCJsZWZ0XCIsbGluZUhlaWdodDpcIm5vcm1hbFwiLHpJbmRleDowLFwiLXdlYmtpdC10YXAtaGlnaGxpZ2h0LWNvbG9yXCI6XCJyZ2JhKDAsMCwwLDApXCJ9LGMuc3R5bGUpLHRoaXMucmVuZGVyVG9DbG9uZXx8YSk7dGhpcy5fY3Vyc29yPWEuc3R5bGUuY3Vyc29yO3RoaXMucmVuZGVyZXI9bmV3ICh6W2MucmVuZGVyZXJdfHxZYSkoYSxkLGUsYy5zdHlsZSxjLmZvckV4cG9ydCxiLmV4cG9ydGluZyYmYi5leHBvcnRpbmcuYWxsb3dIVE1MKTtxYSYmdGhpcy5yZW5kZXJlci5jcmVhdGUodGhpcyxhLGQsZSk7dGhpcy5yZW5kZXJlci5jaGFydEluZGV4PXRoaXMuaW5kZXh9LGdldE1hcmdpbnM6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5zcGFjaW5nLGM9dGhpcy5tYXJnaW4sZD10aGlzLnRpdGxlT2Zmc2V0O3RoaXMucmVzZXRNYXJnaW5zKCk7aWYoZCYmIXMoY1swXSkpdGhpcy5wbG90VG9wPXYodGhpcy5wbG90VG9wLGQrdGhpcy5vcHRpb25zLnRpdGxlLm1hcmdpbitcbmJbMF0pO3RoaXMubGVnZW5kLmFkanVzdE1hcmdpbnMoYyxiKTt0aGlzLmV4dHJhQm90dG9tTWFyZ2luJiYodGhpcy5tYXJnaW5Cb3R0b20rPXRoaXMuZXh0cmFCb3R0b21NYXJnaW4pO3RoaXMuZXh0cmFUb3BNYXJnaW4mJih0aGlzLnBsb3RUb3ArPXRoaXMuZXh0cmFUb3BNYXJnaW4pO2F8fHRoaXMuZ2V0QXhpc01hcmdpbnMoKX0sZ2V0QXhpc01hcmdpbnM6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5heGlzT2Zmc2V0PVswLDAsMCwwXSxjPWEubWFyZ2luO2EuaGFzQ2FydGVzaWFuU2VyaWVzJiZuKGEuYXhlcyxmdW5jdGlvbihhKXthLnZpc2libGUmJmEuZ2V0T2Zmc2V0KCl9KTtuKHViLGZ1bmN0aW9uKGQsZSl7cyhjW2VdKXx8KGFbZF0rPWJbZV0pfSk7YS5zZXRDaGFydFNpemUoKX0scmVmbG93OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMsYz1iLm9wdGlvbnMuY2hhcnQsZD1iLnJlbmRlclRvLGU9Yy53aWR0aHx8eGEoZCxcIndpZHRoXCIpLGY9Yy5oZWlnaHR8fHhhKGQsXCJoZWlnaHRcIiksXG5jPWE/YS50YXJnZXQ6SjtpZighYi5oYXNVc2VyU2l6ZSYmIWIuaXNQcmludGluZyYmZSYmZiYmKGM9PT1KfHxjPT09Qikpe2lmKGUhPT1iLmNvbnRhaW5lcldpZHRofHxmIT09Yi5jb250YWluZXJIZWlnaHQpY2xlYXJUaW1lb3V0KGIucmVmbG93VGltZW91dCksYi5yZWZsb3dUaW1lb3V0PSRhKGZ1bmN0aW9uKCl7aWYoYi5jb250YWluZXIpYi5zZXRTaXplKGUsZiwhMSksYi5oYXNVc2VyU2l6ZT1udWxsfSxhPzEwMDowKTtiLmNvbnRhaW5lcldpZHRoPWU7Yi5jb250YWluZXJIZWlnaHQ9Zn19LGluaXRSZWZsb3c6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9ZnVuY3Rpb24oYil7YS5yZWZsb3coYil9O0QoSixcInJlc2l6ZVwiLGIpO0QoYSxcImRlc3Ryb3lcIixmdW5jdGlvbigpe1QoSixcInJlc2l6ZVwiLGIpfSl9LHNldFNpemU6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXRoaXMsZSxmLGc9ZC5yZW5kZXJlcjtkLmlzUmVzaXppbmcrPTE7YWIoYyxkKTtkLm9sZENoYXJ0SGVpZ2h0PWQuY2hhcnRIZWlnaHQ7XG5kLm9sZENoYXJ0V2lkdGg9ZC5jaGFydFdpZHRoO2lmKHMoYSkpZC5jaGFydFdpZHRoPWU9digwLHkoYSkpLGQuaGFzVXNlclNpemU9ISFlO2lmKHMoYikpZC5jaGFydEhlaWdodD1mPXYoMCx5KGIpKTthPWcuZ2xvYmFsQW5pbWF0aW9uOyhhP2ViOkYpKGQuY29udGFpbmVyLHt3aWR0aDplK1wicHhcIixoZWlnaHQ6ZitcInB4XCJ9LGEpO2Quc2V0Q2hhcnRTaXplKCEwKTtnLnNldFNpemUoZSxmLGMpO2QubWF4VGlja3M9bnVsbDtuKGQuYXhlcyxmdW5jdGlvbihhKXthLmlzRGlydHk9ITA7YS5zZXRTY2FsZSgpfSk7bihkLnNlcmllcyxmdW5jdGlvbihhKXthLmlzRGlydHk9ITB9KTtkLmlzRGlydHlMZWdlbmQ9ITA7ZC5pc0RpcnR5Qm94PSEwO2QubGF5T3V0VGl0bGVzKCk7ZC5nZXRNYXJnaW5zKCk7ZC5yZWRyYXcoYyk7ZC5vbGRDaGFydEhlaWdodD1udWxsO00oZCxcInJlc2l6ZVwiKTskYShmdW5jdGlvbigpe2QmJk0oZCxcImVuZFJlc2l6ZVwiLG51bGwsZnVuY3Rpb24oKXtkLmlzUmVzaXppbmctPVxuMX0pfSxoYihhKS5kdXJhdGlvbil9LHNldENoYXJ0U2l6ZTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmludmVydGVkLGM9dGhpcy5yZW5kZXJlcixkPXRoaXMuY2hhcnRXaWR0aCxlPXRoaXMuY2hhcnRIZWlnaHQsZj10aGlzLm9wdGlvbnMuY2hhcnQsZz10aGlzLnNwYWNpbmcsaD10aGlzLmNsaXBPZmZzZXQsaSxqLGssbDt0aGlzLnBsb3RMZWZ0PWk9eSh0aGlzLnBsb3RMZWZ0KTt0aGlzLnBsb3RUb3A9aj15KHRoaXMucGxvdFRvcCk7dGhpcy5wbG90V2lkdGg9az12KDAseShkLWktdGhpcy5tYXJnaW5SaWdodCkpO3RoaXMucGxvdEhlaWdodD1sPXYoMCx5KGUtai10aGlzLm1hcmdpbkJvdHRvbSkpO3RoaXMucGxvdFNpemVYPWI/bDprO3RoaXMucGxvdFNpemVZPWI/azpsO3RoaXMucGxvdEJvcmRlcldpZHRoPWYucGxvdEJvcmRlcldpZHRofHwwO3RoaXMuc3BhY2luZ0JveD1jLnNwYWNpbmdCb3g9e3g6Z1szXSx5OmdbMF0sd2lkdGg6ZC1nWzNdLWdbMV0saGVpZ2h0OmUtZ1swXS1nWzJdfTtcbnRoaXMucGxvdEJveD1jLnBsb3RCb3g9e3g6aSx5Omosd2lkdGg6ayxoZWlnaHQ6bH07ZD0yKlYodGhpcy5wbG90Qm9yZGVyV2lkdGgvMik7Yj1GYSh2KGQsaFszXSkvMik7Yz1GYSh2KGQsaFswXSkvMik7dGhpcy5jbGlwQm94PXt4OmIseTpjLHdpZHRoOlYodGhpcy5wbG90U2l6ZVgtdihkLGhbMV0pLzItYiksaGVpZ2h0OnYoMCxWKHRoaXMucGxvdFNpemVZLXYoZCxoWzJdKS8yLWMpKX07YXx8bih0aGlzLmF4ZXMsZnVuY3Rpb24oYSl7YS5zZXRBeGlzU2l6ZSgpO2Euc2V0QXhpc1RyYW5zbGF0aW9uKCl9KX0scmVzZXRNYXJnaW5zOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcztuKHViLGZ1bmN0aW9uKGIsYyl7YVtiXT1xKGEubWFyZ2luW2NdLGEuc3BhY2luZ1tjXSl9KTthLmF4aXNPZmZzZXQ9WzAsMCwwLDBdO2EuY2xpcE9mZnNldD1bMCwwLDAsMF19LGRyYXdDaGFydEJveDpmdW5jdGlvbigpe3ZhciBhPXRoaXMub3B0aW9ucy5jaGFydCxiPXRoaXMucmVuZGVyZXIsYz10aGlzLmNoYXJ0V2lkdGgsXG5kPXRoaXMuY2hhcnRIZWlnaHQsZT10aGlzLmNoYXJ0QmFja2dyb3VuZCxmPXRoaXMucGxvdEJhY2tncm91bmQsZz10aGlzLnBsb3RCb3JkZXIsaD10aGlzLnBsb3RCR0ltYWdlLGk9YS5ib3JkZXJXaWR0aHx8MCxqPWEuYmFja2dyb3VuZENvbG9yLGs9YS5wbG90QmFja2dyb3VuZENvbG9yLGw9YS5wbG90QmFja2dyb3VuZEltYWdlLG09YS5wbG90Qm9yZGVyV2lkdGh8fDAsbyxwPXRoaXMucGxvdExlZnQscj10aGlzLnBsb3RUb3AsQT10aGlzLnBsb3RXaWR0aCxxPXRoaXMucGxvdEhlaWdodCxuPXRoaXMucGxvdEJveCx3PXRoaXMuY2xpcFJlY3QsTz10aGlzLmNsaXBCb3g7bz1pKyhhLnNoYWRvdz84OjApO2lmKGl8fGopaWYoZSllLmFuaW1hdGUoZS5jcmlzcCh7d2lkdGg6Yy1vLGhlaWdodDpkLW99KSk7ZWxzZXtlPXtmaWxsOmp8fFwibm9uZVwifTtpZihpKWUuc3Ryb2tlPWEuYm9yZGVyQ29sb3IsZVtcInN0cm9rZS13aWR0aFwiXT1pO3RoaXMuY2hhcnRCYWNrZ3JvdW5kPWIucmVjdChvL1xuMixvLzIsYy1vLGQtbyxhLmJvcmRlclJhZGl1cyxpKS5hdHRyKGUpLmFkZENsYXNzKFwiaGlnaGNoYXJ0cy1iYWNrZ3JvdW5kXCIpLmFkZCgpLnNoYWRvdyhhLnNoYWRvdyl9aWYoaylmP2YuYW5pbWF0ZShuKTp0aGlzLnBsb3RCYWNrZ3JvdW5kPWIucmVjdChwLHIsQSxxLDApLmF0dHIoe2ZpbGw6a30pLmFkZCgpLnNoYWRvdyhhLnBsb3RTaGFkb3cpO2lmKGwpaD9oLmFuaW1hdGUobik6dGhpcy5wbG90QkdJbWFnZT1iLmltYWdlKGwscCxyLEEscSkuYWRkKCk7dz93LmFuaW1hdGUoe3dpZHRoOk8ud2lkdGgsaGVpZ2h0Ok8uaGVpZ2h0fSk6dGhpcy5jbGlwUmVjdD1iLmNsaXBSZWN0KE8pO2lmKG0pZz8oZy5zdHJva2VXaWR0aD0tbSxnLmFuaW1hdGUoZy5jcmlzcCh7eDpwLHk6cix3aWR0aDpBLGhlaWdodDpxfSkpKTp0aGlzLnBsb3RCb3JkZXI9Yi5yZWN0KHAscixBLHEsMCwtbSkuYXR0cih7c3Ryb2tlOmEucGxvdEJvcmRlckNvbG9yLFwic3Ryb2tlLXdpZHRoXCI6bSxmaWxsOlwibm9uZVwiLFxuekluZGV4OjF9KS5hZGQoKTt0aGlzLmlzRGlydHlCb3g9ITF9LHByb3BGcm9tU2VyaWVzOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEub3B0aW9ucy5jaGFydCxjLGQ9YS5vcHRpb25zLnNlcmllcyxlLGY7bihbXCJpbnZlcnRlZFwiLFwiYW5ndWxhclwiLFwicG9sYXJcIl0sZnVuY3Rpb24oZyl7Yz1LW2IudHlwZXx8Yi5kZWZhdWx0U2VyaWVzVHlwZV07Zj1hW2ddfHxiW2ddfHxjJiZjLnByb3RvdHlwZVtnXTtmb3IoZT1kJiZkLmxlbmd0aDshZiYmZS0tOykoYz1LW2RbZV0udHlwZV0pJiZjLnByb3RvdHlwZVtnXSYmKGY9ITApO2FbZ109Zn0pfSxsaW5rU2VyaWVzOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEuc2VyaWVzO24oYixmdW5jdGlvbihhKXthLmxpbmtlZFNlcmllcy5sZW5ndGg9MH0pO24oYixmdW5jdGlvbihiKXt2YXIgZD1iLm9wdGlvbnMubGlua2VkVG87aWYoRGEoZCkmJihkPWQ9PT1cIjpwcmV2aW91c1wiP2Euc2VyaWVzW2IuaW5kZXgtMV06YS5nZXQoZCkpKWQubGlua2VkU2VyaWVzLnB1c2goYiksXG5iLmxpbmtlZFBhcmVudD1kLGIudmlzaWJsZT1xKGIub3B0aW9ucy52aXNpYmxlLGQub3B0aW9ucy52aXNpYmxlLGIudmlzaWJsZSl9KX0scmVuZGVyU2VyaWVzOmZ1bmN0aW9uKCl7bih0aGlzLnNlcmllcyxmdW5jdGlvbihhKXthLnRyYW5zbGF0ZSgpO2EucmVuZGVyKCl9KX0scmVuZGVyTGFiZWxzOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEub3B0aW9ucy5sYWJlbHM7Yi5pdGVtcyYmbihiLml0ZW1zLGZ1bmN0aW9uKGMpe3ZhciBkPXgoYi5zdHlsZSxjLnN0eWxlKSxlPUcoZC5sZWZ0KSthLnBsb3RMZWZ0LGY9RyhkLnRvcCkrYS5wbG90VG9wKzEyO2RlbGV0ZSBkLmxlZnQ7ZGVsZXRlIGQudG9wO2EucmVuZGVyZXIudGV4dChjLmh0bWwsZSxmKS5hdHRyKHt6SW5kZXg6Mn0pLmNzcyhkKS5hZGQoKX0pfSxyZW5kZXI6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmF4ZXMsYj10aGlzLnJlbmRlcmVyLGM9dGhpcy5vcHRpb25zLGQsZSxmLGc7dGhpcy5zZXRUaXRsZSgpO3RoaXMubGVnZW5kPVxubmV3IHZiKHRoaXMsYy5sZWdlbmQpO3RoaXMuZ2V0U3RhY2tzJiZ0aGlzLmdldFN0YWNrcygpO3RoaXMuZ2V0TWFyZ2lucyghMCk7dGhpcy5zZXRDaGFydFNpemUoKTtkPXRoaXMucGxvdFdpZHRoO2U9dGhpcy5wbG90SGVpZ2h0LT0yMTtuKGEsZnVuY3Rpb24oYSl7YS5zZXRTY2FsZSgpfSk7dGhpcy5nZXRBeGlzTWFyZ2lucygpO2Y9ZC90aGlzLnBsb3RXaWR0aD4xLjE7Zz1lL3RoaXMucGxvdEhlaWdodD4xLjA1O2lmKGZ8fGcpdGhpcy5tYXhUaWNrcz1udWxsLG4oYSxmdW5jdGlvbihhKXsoYS5ob3JpeiYmZnx8IWEuaG9yaXomJmcpJiZhLnNldFRpY2tJbnRlcnZhbCghMCl9KSx0aGlzLmdldE1hcmdpbnMoKTt0aGlzLmRyYXdDaGFydEJveCgpO3RoaXMuaGFzQ2FydGVzaWFuU2VyaWVzJiZuKGEsZnVuY3Rpb24oYSl7YS52aXNpYmxlJiZhLnJlbmRlcigpfSk7aWYoIXRoaXMuc2VyaWVzR3JvdXApdGhpcy5zZXJpZXNHcm91cD1iLmcoXCJzZXJpZXMtZ3JvdXBcIikuYXR0cih7ekluZGV4OjN9KS5hZGQoKTtcbnRoaXMucmVuZGVyU2VyaWVzKCk7dGhpcy5yZW5kZXJMYWJlbHMoKTt0aGlzLnNob3dDcmVkaXRzKGMuY3JlZGl0cyk7dGhpcy5oYXNSZW5kZXJlZD0hMH0sc2hvd0NyZWRpdHM6ZnVuY3Rpb24oYSl7aWYoYS5lbmFibGVkJiYhdGhpcy5jcmVkaXRzKXRoaXMuY3JlZGl0cz10aGlzLnJlbmRlcmVyLnRleHQoYS50ZXh0LDAsMCkub24oXCJjbGlja1wiLGZ1bmN0aW9uKCl7aWYoYS5ocmVmKUoubG9jYXRpb24uaHJlZj1hLmhyZWZ9KS5hdHRyKHthbGlnbjphLnBvc2l0aW9uLmFsaWduLHpJbmRleDo4fSkuY3NzKGEuc3R5bGUpLmFkZCgpLmFsaWduKGEucG9zaXRpb24pfSxkZXN0cm95OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEuYXhlcyxjPWEuc2VyaWVzLGQ9YS5jb250YWluZXIsZSxmPWQmJmQucGFyZW50Tm9kZTtNKGEsXCJkZXN0cm95XCIpOyRbYS5pbmRleF09dDtsYi0tO2EucmVuZGVyVG8ucmVtb3ZlQXR0cmlidXRlKFwiZGF0YS1oaWdoY2hhcnRzLWNoYXJ0XCIpO1QoYSk7Zm9yKGU9Yi5sZW5ndGg7ZS0tOyliW2VdPVxuYltlXS5kZXN0cm95KCk7Zm9yKGU9Yy5sZW5ndGg7ZS0tOyljW2VdPWNbZV0uZGVzdHJveSgpO24oXCJ0aXRsZSxzdWJ0aXRsZSxjaGFydEJhY2tncm91bmQscGxvdEJhY2tncm91bmQscGxvdEJHSW1hZ2UscGxvdEJvcmRlcixzZXJpZXNHcm91cCxjbGlwUmVjdCxjcmVkaXRzLHBvaW50ZXIsc2Nyb2xsZXIscmFuZ2VTZWxlY3RvcixsZWdlbmQscmVzZXRab29tQnV0dG9uLHRvb2x0aXAscmVuZGVyZXJcIi5zcGxpdChcIixcIiksZnVuY3Rpb24oYil7dmFyIGM9YVtiXTtjJiZjLmRlc3Ryb3kmJihhW2JdPWMuZGVzdHJveSgpKX0pO2lmKGQpZC5pbm5lckhUTUw9XCJcIixUKGQpLGYmJlZhKGQpO2ZvcihlIGluIGEpZGVsZXRlIGFbZV19LGlzUmVhZHlUb1JlbmRlcjpmdW5jdGlvbigpe3ZhciBhPXRoaXM7cmV0dXJuIWphJiZKPT1KLnRvcCYmQi5yZWFkeVN0YXRlIT09XCJjb21wbGV0ZVwifHxxYSYmIUouY2Fudmc/KHFhP1diLnB1c2goZnVuY3Rpb24oKXthLmZpcnN0UmVuZGVyKCl9LGEub3B0aW9ucy5nbG9iYWwuY2FudmFzVG9vbHNVUkwpOlxuQi5hdHRhY2hFdmVudChcIm9ucmVhZHlzdGF0ZWNoYW5nZVwiLGZ1bmN0aW9uKCl7Qi5kZXRhY2hFdmVudChcIm9ucmVhZHlzdGF0ZWNoYW5nZVwiLGEuZmlyc3RSZW5kZXIpO0IucmVhZHlTdGF0ZT09PVwiY29tcGxldGVcIiYmYS5maXJzdFJlbmRlcigpfSksITEpOiEwfSxmaXJzdFJlbmRlcjpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLm9wdGlvbnM7aWYoYS5pc1JlYWR5VG9SZW5kZXIoKSl7YS5nZXRDb250YWluZXIoKTtNKGEsXCJpbml0XCIpO2EucmVzZXRNYXJnaW5zKCk7YS5zZXRDaGFydFNpemUoKTthLnByb3BGcm9tU2VyaWVzKCk7YS5nZXRBeGVzKCk7bihiLnNlcmllc3x8W10sZnVuY3Rpb24oYil7YS5pbml0U2VyaWVzKGIpfSk7YS5saW5rU2VyaWVzKCk7TShhLFwiYmVmb3JlUmVuZGVyXCIpO2lmKHouUG9pbnRlcilhLnBvaW50ZXI9bmV3IFphKGEsYik7YS5yZW5kZXIoKTthLnJlbmRlcmVyLmRyYXcoKTtpZighYS5yZW5kZXJlci5pbWdDb3VudCYmYS5vbmxvYWQpYS5vbmxvYWQoKTtcbmEuY2xvbmVSZW5kZXJUbyghMCl9fSxvbmxvYWQ6ZnVuY3Rpb24oKXt2YXIgYT10aGlzO24oW3RoaXMuY2FsbGJhY2tdLmNvbmNhdCh0aGlzLmNhbGxiYWNrcyksZnVuY3Rpb24oYil7YiYmYS5pbmRleCE9PXZvaWQgMCYmYi5hcHBseShhLFthXSl9KTtNKGEsXCJsb2FkXCIpO3RoaXMub25sb2FkPW51bGx9LHNwbGFzaEFycmF5OmZ1bmN0aW9uKGEsYil7dmFyIGM9YlthXSxjPWRhKGMpP2M6W2MsYyxjLGNdO3JldHVybltxKGJbYStcIlRvcFwiXSxjWzBdKSxxKGJbYStcIlJpZ2h0XCJdLGNbMV0pLHEoYlthK1wiQm90dG9tXCJdLGNbMl0pLHEoYlthK1wiTGVmdFwiXSxjWzNdKV19fTt2YXIgYmM9ei5DZW50ZXJlZFNlcmllc01peGluPXtnZXRDZW50ZXI6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9wdGlvbnMsYj10aGlzLmNoYXJ0LGM9MiooYS5zbGljZWRPZmZzZXR8fDApLGQ9Yi5wbG90V2lkdGgtMipjLGI9Yi5wbG90SGVpZ2h0LTIqYyxlPWEuY2VudGVyLGU9W3EoZVswXSxcIjUwJVwiKSxxKGVbMV0sXCI1MCVcIiksXG5hLnNpemV8fFwiMTAwJVwiLGEuaW5uZXJTaXplfHwwXSxmPUUoZCxiKSxnLGg7Zm9yKGc9MDtnPDQ7KytnKWg9ZVtnXSxhPWc8Mnx8Zz09PTImJi8lJC8udGVzdChoKSxlW2ddPSgvJSQvLnRlc3QoaCk/W2QsYixmLGVbMl1dW2ddKnBhcnNlRmxvYXQoaCkvMTAwOnBhcnNlRmxvYXQoaCkpKyhhP2M6MCk7ZVszXT5lWzJdJiYoZVszXT1lWzJdKTtyZXR1cm4gZX19LEhhPWZ1bmN0aW9uKCl7fTtIYS5wcm90b3R5cGU9e2luaXQ6ZnVuY3Rpb24oYSxiLGMpe3RoaXMuc2VyaWVzPWE7dGhpcy5jb2xvcj1hLmNvbG9yO3RoaXMuYXBwbHlPcHRpb25zKGIsYyk7dGhpcy5wb2ludEF0dHI9e307aWYoYS5vcHRpb25zLmNvbG9yQnlQb2ludCYmKGI9YS5vcHRpb25zLmNvbG9yc3x8YS5jaGFydC5vcHRpb25zLmNvbG9ycyx0aGlzLmNvbG9yPXRoaXMuY29sb3J8fGJbYS5jb2xvckNvdW50ZXIrK10sYS5jb2xvckNvdW50ZXI9PT1iLmxlbmd0aCkpYS5jb2xvckNvdW50ZXI9MDthLmNoYXJ0LnBvaW50Q291bnQrKztcbnJldHVybiB0aGlzfSxhcHBseU9wdGlvbnM6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLnNlcmllcyxkPWMub3B0aW9ucy5wb2ludFZhbEtleXx8Yy5wb2ludFZhbEtleSxhPUhhLnByb3RvdHlwZS5vcHRpb25zVG9PYmplY3QuY2FsbCh0aGlzLGEpO3godGhpcyxhKTt0aGlzLm9wdGlvbnM9dGhpcy5vcHRpb25zP3godGhpcy5vcHRpb25zLGEpOmE7aWYoZCl0aGlzLnk9dGhpc1tkXTt0aGlzLmlzTnVsbD10aGlzLnk9PT1udWxsO2lmKHRoaXMueD09PXZvaWQgMCYmYyl0aGlzLng9Yj09PXZvaWQgMD9jLmF1dG9JbmNyZW1lbnQoKTpiO3JldHVybiB0aGlzfSxvcHRpb25zVG9PYmplY3Q6ZnVuY3Rpb24oYSl7dmFyIGI9e30sYz10aGlzLnNlcmllcyxkPWMub3B0aW9ucy5rZXlzLGU9ZHx8Yy5wb2ludEFycmF5TWFwfHxbXCJ5XCJdLGY9ZS5sZW5ndGgsZz0wLGg9MDtpZih0eXBlb2YgYT09PVwibnVtYmVyXCJ8fGE9PT1udWxsKWJbZVswXV09YTtlbHNlIGlmKEphKGEpKXtpZighZCYmYS5sZW5ndGg+XG5mKXtjPXR5cGVvZiBhWzBdO2lmKGM9PT1cInN0cmluZ1wiKWIubmFtZT1hWzBdO2Vsc2UgaWYoYz09PVwibnVtYmVyXCIpYi54PWFbMF07ZysrfWZvcig7aDxmOyl7aWYoIWR8fGFbZ10hPT12b2lkIDApYltlW2hdXT1hW2ddO2crKztoKyt9fWVsc2UgaWYodHlwZW9mIGE9PT1cIm9iamVjdFwiKXtiPWE7aWYoYS5kYXRhTGFiZWxzKWMuX2hhc1BvaW50TGFiZWxzPSEwO2lmKGEubWFya2VyKWMuX2hhc1BvaW50TWFya2Vycz0hMH1yZXR1cm4gYn0sZGVzdHJveTpmdW5jdGlvbigpe3ZhciBhPXRoaXMuc2VyaWVzLmNoYXJ0LGI9YS5ob3ZlclBvaW50cyxjO2EucG9pbnRDb3VudC0tO2lmKGImJih0aGlzLnNldFN0YXRlKCksQWEoYix0aGlzKSwhYi5sZW5ndGgpKWEuaG92ZXJQb2ludHM9bnVsbDtpZih0aGlzPT09YS5ob3ZlclBvaW50KXRoaXMub25Nb3VzZU91dCgpO2lmKHRoaXMuZ3JhcGhpY3x8dGhpcy5kYXRhTGFiZWwpVCh0aGlzKSx0aGlzLmRlc3Ryb3lFbGVtZW50cygpO3RoaXMubGVnZW5kSXRlbSYmXG5hLmxlZ2VuZC5kZXN0cm95SXRlbSh0aGlzKTtmb3IoYyBpbiB0aGlzKXRoaXNbY109bnVsbH0sZGVzdHJveUVsZW1lbnRzOmZ1bmN0aW9uKCl7Zm9yKHZhciBhPVtcImdyYXBoaWNcIixcImRhdGFMYWJlbFwiLFwiZGF0YUxhYmVsVXBwZXJcIixcImNvbm5lY3RvclwiLFwic2hhZG93R3JvdXBcIl0sYixjPTY7Yy0tOyliPWFbY10sdGhpc1tiXSYmKHRoaXNbYl09dGhpc1tiXS5kZXN0cm95KCkpfSxnZXRMYWJlbENvbmZpZzpmdW5jdGlvbigpe3JldHVybnt4OnRoaXMuY2F0ZWdvcnkseTp0aGlzLnksY29sb3I6dGhpcy5jb2xvcixrZXk6dGhpcy5uYW1lfHx0aGlzLmNhdGVnb3J5LHNlcmllczp0aGlzLnNlcmllcyxwb2ludDp0aGlzLHBlcmNlbnRhZ2U6dGhpcy5wZXJjZW50YWdlLHRvdGFsOnRoaXMudG90YWx8fHRoaXMuc3RhY2tUb3RhbH19LHRvb2x0aXBGb3JtYXR0ZXI6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5zZXJpZXMsYz1iLnRvb2x0aXBPcHRpb25zLGQ9cShjLnZhbHVlRGVjaW1hbHMsXCJcIiksXG5lPWMudmFsdWVQcmVmaXh8fFwiXCIsZj1jLnZhbHVlU3VmZml4fHxcIlwiO24oYi5wb2ludEFycmF5TWFwfHxbXCJ5XCJdLGZ1bmN0aW9uKGIpe2I9XCJ7cG9pbnQuXCIrYjtpZihlfHxmKWE9YS5yZXBsYWNlKGIrXCJ9XCIsZStiK1wifVwiK2YpO2E9YS5yZXBsYWNlKGIrXCJ9XCIsYitcIjosLlwiK2QrXCJmfVwiKX0pO3JldHVybiBMYShhLHtwb2ludDp0aGlzLHNlcmllczp0aGlzLnNlcmllc30pfSxmaXJlUG9pbnRFdmVudDpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9dGhpcyxlPXRoaXMuc2VyaWVzLm9wdGlvbnM7KGUucG9pbnQuZXZlbnRzW2FdfHxkLm9wdGlvbnMmJmQub3B0aW9ucy5ldmVudHMmJmQub3B0aW9ucy5ldmVudHNbYV0pJiZ0aGlzLmltcG9ydEV2ZW50cygpO2E9PT1cImNsaWNrXCImJmUuYWxsb3dQb2ludFNlbGVjdCYmKGM9ZnVuY3Rpb24oYSl7ZC5zZWxlY3QmJmQuc2VsZWN0KG51bGwsYS5jdHJsS2V5fHxhLm1ldGFLZXl8fGEuc2hpZnRLZXkpfSk7TSh0aGlzLGEsYixjKX0sdmlzaWJsZTohMH07dmFyIFE9XG56LlNlcmllcz1mdW5jdGlvbigpe307US5wcm90b3R5cGU9e2lzQ2FydGVzaWFuOiEwLHR5cGU6XCJsaW5lXCIscG9pbnRDbGFzczpIYSxzb3J0ZWQ6ITAscmVxdWlyZVNvcnRpbmc6ITAscG9pbnRBdHRyVG9PcHRpb25zOntzdHJva2U6XCJsaW5lQ29sb3JcIixcInN0cm9rZS13aWR0aFwiOlwibGluZVdpZHRoXCIsZmlsbDpcImZpbGxDb2xvclwiLHI6XCJyYWRpdXNcIn0sZGlyZWN0VG91Y2g6ITEsYXhpc1R5cGVzOltcInhBeGlzXCIsXCJ5QXhpc1wiXSxjb2xvckNvdW50ZXI6MCxwYXJhbGxlbEFycmF5czpbXCJ4XCIsXCJ5XCJdLGluaXQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLGQsZSxmPWEuc2VyaWVzLGc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gcShhLm9wdGlvbnMuaW5kZXgsYS5faSktcShiLm9wdGlvbnMuaW5kZXgsYi5faSl9O2MuY2hhcnQ9YTtjLm9wdGlvbnM9Yj1jLnNldE9wdGlvbnMoYik7Yy5saW5rZWRTZXJpZXM9W107Yy5iaW5kQXhlcygpO3goYyx7bmFtZTpiLm5hbWUsc3RhdGU6XCJcIixwb2ludEF0dHI6e30sXG52aXNpYmxlOmIudmlzaWJsZSE9PSExLHNlbGVjdGVkOmIuc2VsZWN0ZWQ9PT0hMH0pO2lmKHFhKWIuYW5pbWF0aW9uPSExO2U9Yi5ldmVudHM7Zm9yKGQgaW4gZSlEKGMsZCxlW2RdKTtpZihlJiZlLmNsaWNrfHxiLnBvaW50JiZiLnBvaW50LmV2ZW50cyYmYi5wb2ludC5ldmVudHMuY2xpY2t8fGIuYWxsb3dQb2ludFNlbGVjdClhLnJ1blRyYWNrZXJDbGljaz0hMDtjLmdldENvbG9yKCk7Yy5nZXRTeW1ib2woKTtuKGMucGFyYWxsZWxBcnJheXMsZnVuY3Rpb24oYSl7Y1thK1wiRGF0YVwiXT1bXX0pO2Muc2V0RGF0YShiLmRhdGEsITEpO2lmKGMuaXNDYXJ0ZXNpYW4pYS5oYXNDYXJ0ZXNpYW5TZXJpZXM9ITA7Zi5wdXNoKGMpO2MuX2k9Zi5sZW5ndGgtMTtvYihmLGcpO3RoaXMueUF4aXMmJm9iKHRoaXMueUF4aXMuc2VyaWVzLGcpO24oZixmdW5jdGlvbihhLGIpe2EuaW5kZXg9YjthLm5hbWU9YS5uYW1lfHxcIlNlcmllcyBcIisoYisxKX0pfSxiaW5kQXhlczpmdW5jdGlvbigpe3ZhciBhPVxudGhpcyxiPWEub3B0aW9ucyxjPWEuY2hhcnQsZDtuKGEuYXhpc1R5cGVzfHxbXSxmdW5jdGlvbihlKXtuKGNbZV0sZnVuY3Rpb24oYyl7ZD1jLm9wdGlvbnM7aWYoYltlXT09PWQuaW5kZXh8fGJbZV0hPT10JiZiW2VdPT09ZC5pZHx8YltlXT09PXQmJmQuaW5kZXg9PT0wKWMuc2VyaWVzLnB1c2goYSksYVtlXT1jLGMuaXNEaXJ0eT0hMH0pOyFhW2VdJiZhLm9wdGlvbmFsQXhpcyE9PWUmJmdhKDE4LCEwKX0pfSx1cGRhdGVQYXJhbGxlbEFycmF5czpmdW5jdGlvbihhLGIpe3ZhciBjPWEuc2VyaWVzLGQ9YXJndW1lbnRzO24oYy5wYXJhbGxlbEFycmF5cyx0eXBlb2YgYj09PVwibnVtYmVyXCI/ZnVuY3Rpb24oZCl7dmFyIGY9ZD09PVwieVwiJiZjLnRvWURhdGE/Yy50b1lEYXRhKGEpOmFbZF07Y1tkK1wiRGF0YVwiXVtiXT1mfTpmdW5jdGlvbihhKXtBcnJheS5wcm90b3R5cGVbYl0uYXBwbHkoY1thK1wiRGF0YVwiXSxBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChkLDIpKX0pfSxhdXRvSW5jcmVtZW50OmZ1bmN0aW9uKCl7dmFyIGE9XG50aGlzLm9wdGlvbnMsYj10aGlzLnhJbmNyZW1lbnQsYyxkPWEucG9pbnRJbnRlcnZhbFVuaXQsYj1xKGIsYS5wb2ludFN0YXJ0LDApO3RoaXMucG9pbnRJbnRlcnZhbD1jPXEodGhpcy5wb2ludEludGVydmFsLGEucG9pbnRJbnRlcnZhbCwxKTtkJiYoYT1uZXcgZmEoYiksZD09PVwiZGF5XCI/YT0rYVtyYl0oYVtiYl0oKStjKTpkPT09XCJtb250aFwiP2E9K2FbRmJdKGFbaWJdKCkrYyk6ZD09PVwieWVhclwiJiYoYT0rYVtHYl0oYVtqYl0oKStjKSksYz1hLWIpO3RoaXMueEluY3JlbWVudD1iK2M7cmV0dXJuIGJ9LHNldE9wdGlvbnM6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jaGFydCxjPWIub3B0aW9ucy5wbG90T3B0aW9ucyxiPWIudXNlck9wdGlvbnN8fHt9LGQ9Yi5wbG90T3B0aW9uc3x8e30sZT1jW3RoaXMudHlwZV07dGhpcy51c2VyT3B0aW9ucz1hO2M9QyhlLGMuc2VyaWVzLGEpO3RoaXMudG9vbHRpcE9wdGlvbnM9QyhOLnRvb2x0aXAsTi5wbG90T3B0aW9uc1t0aGlzLnR5cGVdLnRvb2x0aXAsXG5iLnRvb2x0aXAsZC5zZXJpZXMmJmQuc2VyaWVzLnRvb2x0aXAsZFt0aGlzLnR5cGVdJiZkW3RoaXMudHlwZV0udG9vbHRpcCxhLnRvb2x0aXApO2UubWFya2VyPT09bnVsbCYmZGVsZXRlIGMubWFya2VyO3RoaXMuem9uZUF4aXM9Yy56b25lQXhpczthPXRoaXMuem9uZXM9KGMuem9uZXN8fFtdKS5zbGljZSgpO2lmKChjLm5lZ2F0aXZlQ29sb3J8fGMubmVnYXRpdmVGaWxsQ29sb3IpJiYhYy56b25lcylhLnB1c2goe3ZhbHVlOmNbdGhpcy56b25lQXhpcytcIlRocmVzaG9sZFwiXXx8Yy50aHJlc2hvbGR8fDAsY29sb3I6Yy5uZWdhdGl2ZUNvbG9yLGZpbGxDb2xvcjpjLm5lZ2F0aXZlRmlsbENvbG9yfSk7YS5sZW5ndGgmJnMoYVthLmxlbmd0aC0xXS52YWx1ZSkmJmEucHVzaCh7Y29sb3I6dGhpcy5jb2xvcixmaWxsQ29sb3I6dGhpcy5maWxsQ29sb3J9KTtyZXR1cm4gY30sZ2V0Q3ljbGljOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD10aGlzLnVzZXJPcHRpb25zLGU9XCJfXCIrYStcIkluZGV4XCIsXG5mPWErXCJDb3VudGVyXCI7Ynx8KHMoZFtlXSk/Yj1kW2VdOihkW2VdPWI9dGhpcy5jaGFydFtmXSVjLmxlbmd0aCx0aGlzLmNoYXJ0W2ZdKz0xKSxiPWNbYl0pO3RoaXNbYV09Yn0sZ2V0Q29sb3I6ZnVuY3Rpb24oKXt0aGlzLm9wdGlvbnMuY29sb3JCeVBvaW50P3RoaXMub3B0aW9ucy5jb2xvcj1udWxsOnRoaXMuZ2V0Q3ljbGljKFwiY29sb3JcIix0aGlzLm9wdGlvbnMuY29sb3J8fFdbdGhpcy50eXBlXS5jb2xvcix0aGlzLmNoYXJ0Lm9wdGlvbnMuY29sb3JzKX0sZ2V0U3ltYm9sOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcHRpb25zLm1hcmtlcjt0aGlzLmdldEN5Y2xpYyhcInN5bWJvbFwiLGEuc3ltYm9sLHRoaXMuY2hhcnQub3B0aW9ucy5zeW1ib2xzKTtpZigvXnVybC8udGVzdCh0aGlzLnN5bWJvbCkpYS5yYWRpdXM9MH0sZHJhd0xlZ2VuZFN5bWJvbDphYS5kcmF3TGluZU1hcmtlcixzZXREYXRhOmZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPXRoaXMsZj1lLnBvaW50cyxnPWYmJmYubGVuZ3RofHxcbjAsaCxpPWUub3B0aW9ucyxqPWUuY2hhcnQsaz1udWxsLGw9ZS54QXhpcyxtPWwmJiEhbC5jYXRlZ29yaWVzLG89aS50dXJib1RocmVzaG9sZCxwPXRoaXMueERhdGEscj10aGlzLnlEYXRhLEE9KGg9ZS5wb2ludEFycmF5TWFwKSYmaC5sZW5ndGgsYT1hfHxbXTtoPWEubGVuZ3RoO2I9cShiLCEwKTtpZihkIT09ITEmJmgmJmc9PT1oJiYhZS5jcm9wcGVkJiYhZS5oYXNHcm91cGVkRGF0YSYmZS52aXNpYmxlKW4oYSxmdW5jdGlvbihhLGIpe2ZbYl0udXBkYXRlJiZhIT09aS5kYXRhW2JdJiZmW2JdLnVwZGF0ZShhLCExLG51bGwsITEpfSk7ZWxzZXtlLnhJbmNyZW1lbnQ9bnVsbDtlLmNvbG9yQ291bnRlcj0wO24odGhpcy5wYXJhbGxlbEFycmF5cyxmdW5jdGlvbihhKXtlW2ErXCJEYXRhXCJdLmxlbmd0aD0wfSk7aWYobyYmaD5vKXtmb3IoYz0wO2s9PT1udWxsJiZjPGg7KWs9YVtjXSxjKys7aWYodWEoaykpe209cShpLnBvaW50U3RhcnQsMCk7az1xKGkucG9pbnRJbnRlcnZhbCwxKTtmb3IoYz1cbjA7YzxoO2MrKylwW2NdPW0scltjXT1hW2NdLG0rPWs7ZS54SW5jcmVtZW50PW19ZWxzZSBpZihKYShrKSlpZihBKWZvcihjPTA7YzxoO2MrKylrPWFbY10scFtjXT1rWzBdLHJbY109ay5zbGljZSgxLEErMSk7ZWxzZSBmb3IoYz0wO2M8aDtjKyspaz1hW2NdLHBbY109a1swXSxyW2NdPWtbMV07ZWxzZSBnYSgxMil9ZWxzZSBmb3IoYz0wO2M8aDtjKyspaWYoYVtjXSE9PXQmJihrPXtzZXJpZXM6ZX0sZS5wb2ludENsYXNzLnByb3RvdHlwZS5hcHBseU9wdGlvbnMuYXBwbHkoayxbYVtjXV0pLGUudXBkYXRlUGFyYWxsZWxBcnJheXMoayxjKSxtJiZzKGsubmFtZSkpKWwubmFtZXNbay54XT1rLm5hbWU7RGEoclswXSkmJmdhKDE0LCEwKTtlLmRhdGE9W107ZS5vcHRpb25zLmRhdGE9ZS51c2VyT3B0aW9ucy5kYXRhPWE7Zm9yKGM9ZztjLS07KWZbY10mJmZbY10uZGVzdHJveSYmZltjXS5kZXN0cm95KCk7aWYobClsLm1pblJhbmdlPWwudXNlck1pblJhbmdlO2UuaXNEaXJ0eT1lLmlzRGlydHlEYXRhPVxuai5pc0RpcnR5Qm94PSEwO2M9ITF9aS5sZWdlbmRUeXBlPT09XCJwb2ludFwiJiYodGhpcy5wcm9jZXNzRGF0YSgpLHRoaXMuZ2VuZXJhdGVQb2ludHMoKSk7YiYmai5yZWRyYXcoYyl9LHByb2Nlc3NEYXRhOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMueERhdGEsYz10aGlzLnlEYXRhLGQ9Yi5sZW5ndGgsZTtlPTA7dmFyIGYsZyxoPXRoaXMueEF4aXMsaSxqPXRoaXMub3B0aW9ucztpPWouY3JvcFRocmVzaG9sZDt2YXIgaz10aGlzLmdldEV4dHJlbWVzRnJvbUFsbHx8ai5nZXRFeHRyZW1lc0Zyb21BbGwsbD10aGlzLmlzQ2FydGVzaWFuLGo9aCYmaC52YWwybGluLG09aCYmaC5pc0xvZyxvLHA7aWYobCYmIXRoaXMuaXNEaXJ0eSYmIWguaXNEaXJ0eSYmIXRoaXMueUF4aXMuaXNEaXJ0eSYmIWEpcmV0dXJuITE7aWYoaClhPWguZ2V0RXh0cmVtZXMoKSxvPWEubWluLHA9YS5tYXg7aWYobCYmdGhpcy5zb3J0ZWQmJiFrJiYoIWl8fGQ+aXx8dGhpcy5mb3JjZUNyb3ApKWlmKGJbZC0xXTxvfHxcbmJbMF0+cCliPVtdLGM9W107ZWxzZSBpZihiWzBdPG98fGJbZC0xXT5wKWU9dGhpcy5jcm9wRGF0YSh0aGlzLnhEYXRhLHRoaXMueURhdGEsbyxwKSxiPWUueERhdGEsYz1lLnlEYXRhLGU9ZS5zdGFydCxmPSEwO2ZvcihpPWIubGVuZ3RofHwxOy0taTspZD1tP2ooYltpXSktaihiW2ktMV0pOmJbaV0tYltpLTFdLGQ+MCYmKGc9PT10fHxkPGcpP2c9ZDpkPDAmJnRoaXMucmVxdWlyZVNvcnRpbmcmJmdhKDE1KTt0aGlzLmNyb3BwZWQ9Zjt0aGlzLmNyb3BTdGFydD1lO3RoaXMucHJvY2Vzc2VkWERhdGE9Yjt0aGlzLnByb2Nlc3NlZFlEYXRhPWM7dGhpcy5jbG9zZXN0UG9pbnRSYW5nZT1nfSxjcm9wRGF0YTpmdW5jdGlvbihhLGIsYyxkKXt2YXIgZT1hLmxlbmd0aCxmPTAsZz1lLGg9cSh0aGlzLmNyb3BTaG91bGRlciwxKSxpO2ZvcihpPTA7aTxlO2krKylpZihhW2ldPj1jKXtmPXYoMCxpLWgpO2JyZWFrfWZvcihjPWk7YzxlO2MrKylpZihhW2NdPmQpe2c9YytoO2JyZWFrfXJldHVybnt4RGF0YTphLnNsaWNlKGYsXG5nKSx5RGF0YTpiLnNsaWNlKGYsZyksc3RhcnQ6ZixlbmQ6Z319LGdlbmVyYXRlUG9pbnRzOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcHRpb25zLmRhdGEsYj10aGlzLmRhdGEsYyxkPXRoaXMucHJvY2Vzc2VkWERhdGEsZT10aGlzLnByb2Nlc3NlZFlEYXRhLGY9dGhpcy5wb2ludENsYXNzLGc9ZC5sZW5ndGgsaD10aGlzLmNyb3BTdGFydHx8MCxpLGo9dGhpcy5oYXNHcm91cGVkRGF0YSxrLGw9W10sbTtpZighYiYmIWopYj1bXSxiLmxlbmd0aD1hLmxlbmd0aCxiPXRoaXMuZGF0YT1iO2ZvcihtPTA7bTxnO20rKylpPWgrbSxqPyhsW21dPShuZXcgZikuaW5pdCh0aGlzLFtkW21dXS5jb25jYXQodmEoZVttXSkpKSxsW21dLmRhdGFHcm91cD10aGlzLmdyb3VwTWFwW21dKTooYltpXT9rPWJbaV06YVtpXSE9PXQmJihiW2ldPWs9KG5ldyBmKS5pbml0KHRoaXMsYVtpXSxkW21dKSksbFttXT1rKSxsW21dLmluZGV4PWk7aWYoYiYmKGchPT0oYz1iLmxlbmd0aCl8fGopKWZvcihtPTA7bTxcbmM7bSsrKWlmKG09PT1oJiYhaiYmKG0rPWcpLGJbbV0pYlttXS5kZXN0cm95RWxlbWVudHMoKSxiW21dLnBsb3RYPXQ7dGhpcy5kYXRhPWI7dGhpcy5wb2ludHM9bH0sZ2V0RXh0cmVtZXM6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy55QXhpcyxjPXRoaXMucHJvY2Vzc2VkWERhdGEsZCxlPVtdLGY9MDtkPXRoaXMueEF4aXMuZ2V0RXh0cmVtZXMoKTt2YXIgZz1kLm1pbixoPWQubWF4LGksaixrLGwsYT1hfHx0aGlzLnN0YWNrZWRZRGF0YXx8dGhpcy5wcm9jZXNzZWRZRGF0YTtkPWEubGVuZ3RoO2ZvcihsPTA7bDxkO2wrKylpZihqPWNbbF0saz1hW2xdLGk9ayE9PW51bGwmJmshPT10JiYoIWIuaXNMb2d8fGsubGVuZ3RofHxrPjApLGo9dGhpcy5nZXRFeHRyZW1lc0Zyb21BbGx8fHRoaXMub3B0aW9ucy5nZXRFeHRyZW1lc0Zyb21BbGx8fHRoaXMuY3JvcHBlZHx8KGNbbCsxXXx8aik+PWcmJihjW2wtMV18fGopPD1oLGkmJmopaWYoaT1rLmxlbmd0aClmb3IoO2ktLTspa1tpXSE9PW51bGwmJlxuKGVbZisrXT1rW2ldKTtlbHNlIGVbZisrXT1rO3RoaXMuZGF0YU1pbj1PYShlKTt0aGlzLmRhdGFNYXg9RWEoZSl9LHRyYW5zbGF0ZTpmdW5jdGlvbigpe3RoaXMucHJvY2Vzc2VkWERhdGF8fHRoaXMucHJvY2Vzc0RhdGEoKTt0aGlzLmdlbmVyYXRlUG9pbnRzKCk7Zm9yKHZhciBhPXRoaXMub3B0aW9ucyxiPWEuc3RhY2tpbmcsYz10aGlzLnhBeGlzLGQ9Yy5jYXRlZ29yaWVzLGU9dGhpcy55QXhpcyxmPXRoaXMucG9pbnRzLGc9Zi5sZW5ndGgsaD0hIXRoaXMubW9kaWZ5VmFsdWUsaT1hLnBvaW50UGxhY2VtZW50LGo9aT09PVwiYmV0d2VlblwifHx1YShpKSxrPWEudGhyZXNob2xkLGw9YS5zdGFydEZyb21UaHJlc2hvbGQ/azowLG0sbyxwLHIsQT1OdW1iZXIuTUFYX1ZBTFVFLGE9MDthPGc7YSsrKXt2YXIgbj1mW2FdLHU9bi54LHc9bi55O289bi5sb3c7dmFyIE89YiYmZS5zdGFja3NbKHRoaXMubmVnU3RhY2tzJiZ3PChsPzA6ayk/XCItXCI6XCJcIikrdGhpcy5zdGFja0tleV07aWYoZS5pc0xvZyYmXG53IT09bnVsbCYmdzw9MCluLnk9dz1udWxsLGdhKDEwKTtuLnBsb3RYPW09RSh2KC0xRTUsYy50cmFuc2xhdGUodSwwLDAsMCwxLGksdGhpcy50eXBlPT09XCJmbGFnc1wiKSksMUU1KTtpZihiJiZ0aGlzLnZpc2libGUmJiFuLmlzTnVsbCYmTyYmT1t1XSlyPXRoaXMuZ2V0U3RhY2tJbmRpY2F0b3Iocix1LHRoaXMuaW5kZXgpLE89T1t1XSx3PU8ucG9pbnRzW3Iua2V5XSxvPXdbMF0sdz13WzFdLG89PT1sJiYobz1xKGssZS5taW4pKSxlLmlzTG9nJiZvPD0wJiYobz1udWxsKSxuLnRvdGFsPW4uc3RhY2tUb3RhbD1PLnRvdGFsLG4ucGVyY2VudGFnZT1PLnRvdGFsJiZuLnkvTy50b3RhbCoxMDAsbi5zdGFja1k9dyxPLnNldE9mZnNldCh0aGlzLnBvaW50WE9mZnNldHx8MCx0aGlzLmJhcld8fDApO24ueUJvdHRvbT1zKG8pP2UudHJhbnNsYXRlKG8sMCwxLDAsMSk6bnVsbDtoJiYodz10aGlzLm1vZGlmeVZhbHVlKHcsbikpO24ucGxvdFk9bz10eXBlb2Ygdz09PVwibnVtYmVyXCImJnchPT1JbmZpbml0eT9cbkUodigtMUU1LGUudHJhbnNsYXRlKHcsMCwxLDAsMSkpLDFFNSk6dDtuLmlzSW5zaWRlPW8hPT10JiZvPj0wJiZvPD1lLmxlbiYmbT49MCYmbTw9Yy5sZW47bi5jbGllbnRYPWo/Yy50cmFuc2xhdGUodSwwLDAsMCwxKTptO24ubmVnYXRpdmU9bi55PChrfHwwKTtuLmNhdGVnb3J5PWQmJmRbbi54XSE9PXQ/ZFtuLnhdOm4ueDtuLmlzTnVsbHx8KHAhPT12b2lkIDAmJihBPUUoQSxTKG0tcCkpKSxwPW0pfXRoaXMuY2xvc2VzdFBvaW50UmFuZ2VQeD1BfSxnZXRWYWxpZFBvaW50czpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuY2hhcnQ7cmV0dXJuIFNhKGF8fHRoaXMucG9pbnRzfHxbXSxmdW5jdGlvbihhKXtyZXR1cm4gYiYmIWMuaXNJbnNpZGVQbG90KGEucGxvdFgsYS5wbG90WSxjLmludmVydGVkKT8hMTohYS5pc051bGx9KX0sc2V0Q2xpcDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNoYXJ0LGM9dGhpcy5vcHRpb25zLGQ9Yi5yZW5kZXJlcixlPWIuaW52ZXJ0ZWQsZj10aGlzLmNsaXBCb3gsXG5nPWZ8fGIuY2xpcEJveCxoPXRoaXMuc2hhcmVkQ2xpcEtleXx8W1wiX3NoYXJlZENsaXBcIixhJiZhLmR1cmF0aW9uLGEmJmEuZWFzaW5nLGcuaGVpZ2h0LGMueEF4aXMsYy55QXhpc10uam9pbihcIixcIiksaT1iW2hdLGo9YltoK1wibVwiXTtpZighaSl7aWYoYSlnLndpZHRoPTAsYltoK1wibVwiXT1qPWQuY2xpcFJlY3QoLTk5LGU/LWIucGxvdExlZnQ6LWIucGxvdFRvcCw5OSxlP2IuY2hhcnRXaWR0aDpiLmNoYXJ0SGVpZ2h0KTtiW2hdPWk9ZC5jbGlwUmVjdChnKX1hJiYoaS5jb3VudCs9MSk7aWYoYy5jbGlwIT09ITEpdGhpcy5ncm91cC5jbGlwKGF8fGY/aTpiLmNsaXBSZWN0KSx0aGlzLm1hcmtlckdyb3VwLmNsaXAoaiksdGhpcy5zaGFyZWRDbGlwS2V5PWg7YXx8KGkuY291bnQtPTEsaS5jb3VudDw9MCYmaCYmYltoXSYmKGZ8fChiW2hdPWJbaF0uZGVzdHJveSgpKSxiW2grXCJtXCJdJiYoYltoK1wibVwiXT1iW2grXCJtXCJdLmRlc3Ryb3koKSkpKX0sYW5pbWF0ZTpmdW5jdGlvbihhKXt2YXIgYj1cbnRoaXMuY2hhcnQsYz10aGlzLm9wdGlvbnMuYW5pbWF0aW9uLGQ7aWYoYyYmIWRhKGMpKWM9V1t0aGlzLnR5cGVdLmFuaW1hdGlvbjthP3RoaXMuc2V0Q2xpcChjKTooZD10aGlzLnNoYXJlZENsaXBLZXksKGE9YltkXSkmJmEuYW5pbWF0ZSh7d2lkdGg6Yi5wbG90U2l6ZVh9LGMpLGJbZCtcIm1cIl0mJmJbZCtcIm1cIl0uYW5pbWF0ZSh7d2lkdGg6Yi5wbG90U2l6ZVgrOTl9LGMpLHRoaXMuYW5pbWF0ZT1udWxsKX0sYWZ0ZXJBbmltYXRlOmZ1bmN0aW9uKCl7dGhpcy5zZXRDbGlwKCk7TSh0aGlzLFwiYWZ0ZXJBbmltYXRlXCIpfSxkcmF3UG9pbnRzOmZ1bmN0aW9uKCl7dmFyIGEsYj10aGlzLnBvaW50cyxjPXRoaXMuY2hhcnQsZCxlLGYsZyxoLGksaixrLGw9dGhpcy5vcHRpb25zLm1hcmtlcixtPXRoaXMucG9pbnRBdHRyW1wiXCJdLG8scCxyLEE9dGhpcy5tYXJrZXJHcm91cCxuPXEobC5lbmFibGVkLHRoaXMueEF4aXMuaXNSYWRpYWwsdGhpcy5jbG9zZXN0UG9pbnRSYW5nZVB4PjIqbC5yYWRpdXMpO1xuaWYobC5lbmFibGVkIT09ITF8fHRoaXMuX2hhc1BvaW50TWFya2Vycylmb3IoZj1iLmxlbmd0aDtmLS07KWlmKGc9YltmXSxkPVYoZy5wbG90WCksZT1nLnBsb3RZLGs9Zy5ncmFwaGljLG89Zy5tYXJrZXJ8fHt9LHA9ISFnLm1hcmtlcixhPW4mJm8uZW5hYmxlZD09PXR8fG8uZW5hYmxlZCxyPWcuaXNJbnNpZGUsYSYmZSE9PXQmJiFpc05hTihlKSYmZy55IT09bnVsbClpZihhPWcucG9pbnRBdHRyW2cuc2VsZWN0ZWQ/XCJzZWxlY3RcIjpcIlwiXXx8bSxoPWEucixpPXEoby5zeW1ib2wsdGhpcy5zeW1ib2wpLGo9aS5pbmRleE9mKFwidXJsXCIpPT09MCxrKWtbcj9cInNob3dcIjpcImhpZGVcIl0oITApLmF0dHIoYSkuYW5pbWF0ZSh4KHt4OmQtaCx5OmUtaH0say5zeW1ib2xOYW1lP3t3aWR0aDoyKmgsaGVpZ2h0OjIqaH06e30pKTtlbHNle2lmKHImJihoPjB8fGopKWcuZ3JhcGhpYz1jLnJlbmRlcmVyLnN5bWJvbChpLGQtaCxlLWgsMipoLDIqaCxwP286bCkuYXR0cihhKS5hZGQoQSl9ZWxzZSBpZihrKWcuZ3JhcGhpYz1cbmsuZGVzdHJveSgpfSxjb252ZXJ0QXR0cmliczpmdW5jdGlvbihhLGIsYyxkKXt2YXIgZT10aGlzLnBvaW50QXR0clRvT3B0aW9ucyxmLGcsaD17fSxhPWF8fHt9LGI9Ynx8e30sYz1jfHx7fSxkPWR8fHt9O2ZvcihmIGluIGUpZz1lW2ZdLGhbZl09cShhW2ddLGJbZl0sY1tmXSxkW2ZdKTtyZXR1cm4gaH0sZ2V0QXR0cmliczpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLm9wdGlvbnMsYz1XW2EudHlwZV0ubWFya2VyP2IubWFya2VyOmIsZD1jLnN0YXRlcyxlPWQuaG92ZXIsZixnPWEuY29sb3IsaD1hLm9wdGlvbnMubmVnYXRpdmVDb2xvcjtmPXtzdHJva2U6ZyxmaWxsOmd9O3ZhciBpPWEucG9pbnRzfHxbXSxqLGssbD1bXSxtPWEucG9pbnRBdHRyVG9PcHRpb25zO2o9YS5oYXNQb2ludFNwZWNpZmljT3B0aW9uczt2YXIgbz1jLmxpbmVDb2xvcixwPWMuZmlsbENvbG9yO2s9Yi50dXJib1RocmVzaG9sZDt2YXIgcj1hLnpvbmVzLEE9YS56b25lQXhpc3x8XCJ5XCIsUDtiLm1hcmtlcj8oZS5yYWRpdXM9XG5lLnJhZGl1c3x8Yy5yYWRpdXMrZS5yYWRpdXNQbHVzLGUubGluZVdpZHRoPWUubGluZVdpZHRofHxjLmxpbmVXaWR0aCtlLmxpbmVXaWR0aFBsdXMpOihlLmNvbG9yPWUuY29sb3J8fHdhKGUuY29sb3J8fGcpLmJyaWdodGVuKGUuYnJpZ2h0bmVzcykuZ2V0KCksZS5uZWdhdGl2ZUNvbG9yPWUubmVnYXRpdmVDb2xvcnx8d2EoZS5uZWdhdGl2ZUNvbG9yfHxoKS5icmlnaHRlbihlLmJyaWdodG5lc3MpLmdldCgpKTtsW1wiXCJdPWEuY29udmVydEF0dHJpYnMoYyxmKTtuKFtcImhvdmVyXCIsXCJzZWxlY3RcIl0sZnVuY3Rpb24oYil7bFtiXT1hLmNvbnZlcnRBdHRyaWJzKGRbYl0sbFtcIlwiXSl9KTthLnBvaW50QXR0cj1sO2c9aS5sZW5ndGg7aWYoIWt8fGc8a3x8ailmb3IoO2ctLTspe2s9aVtnXTtpZigoYz1rLm9wdGlvbnMmJmsub3B0aW9ucy5tYXJrZXJ8fGsub3B0aW9ucykmJmMuZW5hYmxlZD09PSExKWMucmFkaXVzPTA7aWYoci5sZW5ndGgpe2o9MDtmb3IoZj1yW2pdO2tbQV0+PWYudmFsdWU7KWY9XG5yWysral07ay5jb2xvcj1rLmZpbGxDb2xvcj1xKGYuY29sb3IsYS5jb2xvcil9aj1iLmNvbG9yQnlQb2ludHx8ay5jb2xvcjtpZihrLm9wdGlvbnMpZm9yKFAgaW4gbSlzKGNbbVtQXV0pJiYoaj0hMCk7aWYoail7Yz1jfHx7fTtqPVtdO2Q9Yy5zdGF0ZXN8fHt9O2Y9ZC5ob3Zlcj1kLmhvdmVyfHx7fTtpZighYi5tYXJrZXJ8fGsubmVnYXRpdmUmJiFmLmZpbGxDb2xvciYmIWUuZmlsbENvbG9yKWZbYS5wb2ludEF0dHJUb09wdGlvbnMuZmlsbF09Zi5jb2xvcnx8IWsub3B0aW9ucy5jb2xvciYmZVtrLm5lZ2F0aXZlJiZoP1wibmVnYXRpdmVDb2xvclwiOlwiY29sb3JcIl18fHdhKGsuY29sb3IpLmJyaWdodGVuKGYuYnJpZ2h0bmVzc3x8ZS5icmlnaHRuZXNzKS5nZXQoKTtmPXtjb2xvcjprLmNvbG9yfTtpZighcClmLmZpbGxDb2xvcj1rLmNvbG9yO2lmKCFvKWYubGluZUNvbG9yPWsuY29sb3I7Yy5oYXNPd25Qcm9wZXJ0eShcImNvbG9yXCIpJiYhYy5jb2xvciYmZGVsZXRlIGMuY29sb3I7altcIlwiXT1cbmEuY29udmVydEF0dHJpYnMoeChmLGMpLGxbXCJcIl0pO2ouaG92ZXI9YS5jb252ZXJ0QXR0cmlicyhkLmhvdmVyLGwuaG92ZXIsaltcIlwiXSk7ai5zZWxlY3Q9YS5jb252ZXJ0QXR0cmlicyhkLnNlbGVjdCxsLnNlbGVjdCxqW1wiXCJdKX1lbHNlIGo9bDtrLnBvaW50QXR0cj1qfX0sZGVzdHJveTpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLmNoYXJ0LGM9L0FwcGxlV2ViS2l0XFwvNTMzLy50ZXN0KE1hKSxkLGU9YS5kYXRhfHxbXSxmLGcsaDtNKGEsXCJkZXN0cm95XCIpO1QoYSk7bihhLmF4aXNUeXBlc3x8W10sZnVuY3Rpb24oYil7aWYoaD1hW2JdKUFhKGguc2VyaWVzLGEpLGguaXNEaXJ0eT1oLmZvcmNlUmVkcmF3PSEwfSk7YS5sZWdlbmRJdGVtJiZhLmNoYXJ0LmxlZ2VuZC5kZXN0cm95SXRlbShhKTtmb3IoZD1lLmxlbmd0aDtkLS07KShmPWVbZF0pJiZmLmRlc3Ryb3kmJmYuZGVzdHJveSgpO2EucG9pbnRzPW51bGw7Y2xlYXJUaW1lb3V0KGEuYW5pbWF0aW9uVGltZW91dCk7Zm9yKGcgaW4gYSlhW2ddaW5zdGFuY2VvZlxuWiYmIWFbZ10uc3Vydml2ZSYmKGQ9YyYmZz09PVwiZ3JvdXBcIj9cImhpZGVcIjpcImRlc3Ryb3lcIixhW2ddW2RdKCkpO2lmKGIuaG92ZXJTZXJpZXM9PT1hKWIuaG92ZXJTZXJpZXM9bnVsbDtBYShiLnNlcmllcyxhKTtmb3IoZyBpbiBhKWRlbGV0ZSBhW2ddfSxnZXRHcmFwaFBhdGg6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXRoaXMsZT1kLm9wdGlvbnMsZj1lLnN0ZXAsZyxoPVtdLGksYT1hfHxkLnBvaW50czsoZz1hLnJldmVyc2VkKSYmYS5yZXZlcnNlKCk7KGY9e3JpZ2h0OjEsY2VudGVyOjJ9W2ZdfHxmJiYzKSYmZyYmKGY9NC1mKTtlLmNvbm5lY3ROdWxscyYmIWImJiFjJiYoYT10aGlzLmdldFZhbGlkUG9pbnRzKGEpKTtuKGEsZnVuY3Rpb24oZyxrKXt2YXIgbD1nLnBsb3RYLG09Zy5wbG90WSxvPWFbay0xXTtpZigoZy5sZWZ0Q2xpZmZ8fG8mJm8ucmlnaHRDbGlmZikmJiFjKWk9ITA7Zy5pc051bGwmJiFzKGIpJiZrPjA/aT0hZS5jb25uZWN0TnVsbHM6Zy5pc051bGwmJiFiP2k9ITA6XG4oaz09PTB8fGk/bz1bXCJNXCIsZy5wbG90WCxnLnBsb3RZXTpkLmdldFBvaW50U3BsaW5lP289ZC5nZXRQb2ludFNwbGluZShhLGcsayk6Zj8obz1mPT09MT9bXCJMXCIsby5wbG90WCxtXTpmPT09Mj9bXCJMXCIsKG8ucGxvdFgrbCkvMixvLnBsb3RZLFwiTFwiLChvLnBsb3RYK2wpLzIsbV06W1wiTFwiLGwsby5wbG90WV0sby5wdXNoKFwiTFwiLGwsbSkpOm89W1wiTFwiLGwsbV0saC5wdXNoLmFwcGx5KGgsbyksaT0hMSl9KTtyZXR1cm4gZC5ncmFwaFBhdGg9aH0sZHJhd0dyYXBoOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPXRoaXMub3B0aW9ucyxjPVtbXCJncmFwaFwiLGIubGluZUNvbG9yfHx0aGlzLmNvbG9yLGIuZGFzaFN0eWxlXV0sZD1iLmxpbmVXaWR0aCxlPWIubGluZWNhcCE9PVwic3F1YXJlXCIsZj0odGhpcy5nYXBwZWRQYXRofHx0aGlzLmdldEdyYXBoUGF0aCkuY2FsbCh0aGlzKSxnPXRoaXMuZmlsbEdyYXBoJiZ0aGlzLmNvbG9yfHxcIm5vbmVcIjtuKHRoaXMuem9uZXMsZnVuY3Rpb24oZCxlKXtjLnB1c2goW1wiem9uZUdyYXBoXCIrXG5lLGQuY29sb3J8fGEuY29sb3IsZC5kYXNoU3R5bGV8fGIuZGFzaFN0eWxlXSl9KTtuKGMsZnVuY3Rpb24oYyxpKXt2YXIgaj1jWzBdLGs9YVtqXTtpZihrKWsuYW5pbWF0ZSh7ZDpmfSk7ZWxzZSBpZigoZHx8ZykmJmYubGVuZ3RoKWs9e3N0cm9rZTpjWzFdLFwic3Ryb2tlLXdpZHRoXCI6ZCxmaWxsOmcsekluZGV4OjF9LGNbMl0/ay5kYXNoc3R5bGU9Y1syXTplJiYoa1tcInN0cm9rZS1saW5lY2FwXCJdPWtbXCJzdHJva2UtbGluZWpvaW5cIl09XCJyb3VuZFwiKSxhW2pdPWEuY2hhcnQucmVuZGVyZXIucGF0aChmKS5hdHRyKGspLmFkZChhLmdyb3VwKS5zaGFkb3coaTwyJiZiLnNoYWRvdyl9KX0sYXBwbHlab25lczpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj10aGlzLmNoYXJ0LGM9Yi5yZW5kZXJlcixkPXRoaXMuem9uZXMsZSxmLGc9dGhpcy5jbGlwc3x8W10saCxpPXRoaXMuZ3JhcGgsaj10aGlzLmFyZWEsaz12KGIuY2hhcnRXaWR0aCxiLmNoYXJ0SGVpZ2h0KSxsPXRoaXNbKHRoaXMuem9uZUF4aXN8fFxuXCJ5XCIpK1wiQXhpc1wiXSxtLG89bC5yZXZlcnNlZCxwPWIuaW52ZXJ0ZWQscj1sLmhvcml6LEEsUCx1LHc9ITE7aWYoZC5sZW5ndGgmJihpfHxqKSYmbC5taW4hPT10KWkmJmkuaGlkZSgpLGomJmouaGlkZSgpLG09bC5nZXRFeHRyZW1lcygpLG4oZCxmdW5jdGlvbihkLG4pe2U9bz9yP2IucGxvdFdpZHRoOjA6cj8wOmwudG9QaXhlbHMobS5taW4pO2U9RSh2KHEoZixlKSwwKSxrKTtmPUUodih5KGwudG9QaXhlbHMocShkLnZhbHVlLG0ubWF4KSwhMCkpLDApLGspO3cmJihlPWY9bC50b1BpeGVscyhtLm1heCkpO0E9TWF0aC5hYnMoZS1mKTtQPUUoZSxmKTt1PXYoZSxmKTtpZihsLmlzWEF4aXMpe2lmKGg9e3g6cD91OlAseTowLHdpZHRoOkEsaGVpZ2h0Omt9LCFyKWgueD1iLnBsb3RIZWlnaHQtaC54fWVsc2UgaWYoaD17eDowLHk6cD91OlAsd2lkdGg6ayxoZWlnaHQ6QX0sciloLnk9Yi5wbG90V2lkdGgtaC55O2IuaW52ZXJ0ZWQmJmMuaXNWTUwmJihoPWwuaXNYQXhpcz97eDowLHk6bz9cblA6dSxoZWlnaHQ6aC53aWR0aCx3aWR0aDpiLmNoYXJ0V2lkdGh9Ont4OmgueS1iLnBsb3RMZWZ0LWIuc3BhY2luZ0JveC54LHk6MCx3aWR0aDpoLmhlaWdodCxoZWlnaHQ6Yi5jaGFydEhlaWdodH0pO2dbbl0/Z1tuXS5hbmltYXRlKGgpOihnW25dPWMuY2xpcFJlY3QoaCksaSYmYVtcInpvbmVHcmFwaFwiK25dLmNsaXAoZ1tuXSksaiYmYVtcInpvbmVBcmVhXCIrbl0uY2xpcChnW25dKSk7dz1kLnZhbHVlPm0ubWF4fSksdGhpcy5jbGlwcz1nfSxpbnZlcnRHcm91cHM6ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKCl7dmFyIGE9e3dpZHRoOmIueUF4aXMubGVuLGhlaWdodDpiLnhBeGlzLmxlbn07bihbXCJncm91cFwiLFwibWFya2VyR3JvdXBcIl0sZnVuY3Rpb24oYyl7YltjXSYmYltjXS5hdHRyKGEpLmludmVydCgpfSl9dmFyIGI9dGhpcyxjPWIuY2hhcnQ7aWYoYi54QXhpcylEKGMsXCJyZXNpemVcIixhKSxEKGIsXCJkZXN0cm95XCIsZnVuY3Rpb24oKXtUKGMsXCJyZXNpemVcIixhKX0pLGEoKSxiLmludmVydEdyb3Vwcz1cbmF9LHBsb3RHcm91cDpmdW5jdGlvbihhLGIsYyxkLGUpe3ZhciBmPXRoaXNbYV0sZz0hZjtnJiYodGhpc1thXT1mPXRoaXMuY2hhcnQucmVuZGVyZXIuZyhiKS5hdHRyKHt6SW5kZXg6ZHx8MC4xfSkuYWRkKGUpLGYuYWRkQ2xhc3MoXCJoaWdoY2hhcnRzLXNlcmllcy1cIit0aGlzLmluZGV4KSk7Zi5hdHRyKHt2aXNpYmlsaXR5OmN9KVtnP1wiYXR0clwiOlwiYW5pbWF0ZVwiXSh0aGlzLmdldFBsb3RCb3goKSk7cmV0dXJuIGZ9LGdldFBsb3RCb3g6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmNoYXJ0LGI9dGhpcy54QXhpcyxjPXRoaXMueUF4aXM7aWYoYS5pbnZlcnRlZCliPWMsYz10aGlzLnhBeGlzO3JldHVybnt0cmFuc2xhdGVYOmI/Yi5sZWZ0OmEucGxvdExlZnQsdHJhbnNsYXRlWTpjP2MudG9wOmEucGxvdFRvcCxzY2FsZVg6MSxzY2FsZVk6MX19LHJlbmRlcjpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLmNoYXJ0LGMsZD1hLm9wdGlvbnMsZT0hIWEuYW5pbWF0ZSYmYi5yZW5kZXJlci5pc1NWRyYmXG5oYihkLmFuaW1hdGlvbikuZHVyYXRpb24sZj1hLnZpc2libGU/XCJpbmhlcml0XCI6XCJoaWRkZW5cIixnPWQuekluZGV4LGg9YS5oYXNSZW5kZXJlZCxpPWIuc2VyaWVzR3JvdXA7Yz1hLnBsb3RHcm91cChcImdyb3VwXCIsXCJzZXJpZXNcIixmLGcsaSk7YS5tYXJrZXJHcm91cD1hLnBsb3RHcm91cChcIm1hcmtlckdyb3VwXCIsXCJtYXJrZXJzXCIsZixnLGkpO2UmJmEuYW5pbWF0ZSghMCk7YS5nZXRBdHRyaWJzKCk7Yy5pbnZlcnRlZD1hLmlzQ2FydGVzaWFuP2IuaW52ZXJ0ZWQ6ITE7YS5kcmF3R3JhcGgmJihhLmRyYXdHcmFwaCgpLGEuYXBwbHlab25lcygpKTtuKGEucG9pbnRzLGZ1bmN0aW9uKGEpe2EucmVkcmF3JiZhLnJlZHJhdygpfSk7YS5kcmF3RGF0YUxhYmVscyYmYS5kcmF3RGF0YUxhYmVscygpO2EudmlzaWJsZSYmYS5kcmF3UG9pbnRzKCk7YS5kcmF3VHJhY2tlciYmYS5vcHRpb25zLmVuYWJsZU1vdXNlVHJhY2tpbmchPT0hMSYmYS5kcmF3VHJhY2tlcigpO2IuaW52ZXJ0ZWQmJmEuaW52ZXJ0R3JvdXBzKCk7XG5kLmNsaXAhPT0hMSYmIWEuc2hhcmVkQ2xpcEtleSYmIWgmJmMuY2xpcChiLmNsaXBSZWN0KTtlJiZhLmFuaW1hdGUoKTtpZighaClhLmFuaW1hdGlvblRpbWVvdXQ9JGEoZnVuY3Rpb24oKXthLmFmdGVyQW5pbWF0ZSgpfSxlKTthLmlzRGlydHk9YS5pc0RpcnR5RGF0YT0hMTthLmhhc1JlbmRlcmVkPSEwfSxyZWRyYXc6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmNoYXJ0LGI9dGhpcy5pc0RpcnR5RGF0YSxjPXRoaXMuaXNEaXJ0eSxkPXRoaXMuZ3JvdXAsZT10aGlzLnhBeGlzLGY9dGhpcy55QXhpcztkJiYoYS5pbnZlcnRlZCYmZC5hdHRyKHt3aWR0aDphLnBsb3RXaWR0aCxoZWlnaHQ6YS5wbG90SGVpZ2h0fSksZC5hbmltYXRlKHt0cmFuc2xhdGVYOnEoZSYmZS5sZWZ0LGEucGxvdExlZnQpLHRyYW5zbGF0ZVk6cShmJiZmLnRvcCxhLnBsb3RUb3ApfSkpO3RoaXMudHJhbnNsYXRlKCk7dGhpcy5yZW5kZXIoKTtiJiZNKHRoaXMsXCJ1cGRhdGVkRGF0YVwiKTsoY3x8YikmJmRlbGV0ZSB0aGlzLmtkVHJlZX0sXG5rZERpbWVuc2lvbnM6MSxrZEF4aXNBcnJheTpbXCJjbGllbnRYXCIsXCJwbG90WVwiXSxzZWFyY2hQb2ludDpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMueEF4aXMsZD10aGlzLnlBeGlzLGU9dGhpcy5jaGFydC5pbnZlcnRlZDtyZXR1cm4gdGhpcy5zZWFyY2hLRFRyZWUoe2NsaWVudFg6ZT9jLmxlbi1hLmNoYXJ0WStjLnBvczphLmNoYXJ0WC1jLnBvcyxwbG90WTplP2QubGVuLWEuY2hhcnRYK2QucG9zOmEuY2hhcnRZLWQucG9zfSxiKX0sYnVpbGRLRFRyZWU6ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGMsZSxmKXt2YXIgZyxoO2lmKGg9YyYmYy5sZW5ndGgpcmV0dXJuIGc9Yi5rZEF4aXNBcnJheVtlJWZdLGMuc29ydChmdW5jdGlvbihhLGIpe3JldHVybiBhW2ddLWJbZ119KSxoPU1hdGguZmxvb3IoaC8yKSx7cG9pbnQ6Y1toXSxsZWZ0OmEoYy5zbGljZSgwLGgpLGUrMSxmKSxyaWdodDphKGMuc2xpY2UoaCsxKSxlKzEsZil9fXZhciBiPXRoaXMsYz1iLmtkRGltZW5zaW9ucztkZWxldGUgYi5rZFRyZWU7XG4kYShmdW5jdGlvbigpe2Iua2RUcmVlPWEoYi5nZXRWYWxpZFBvaW50cyhudWxsLCFiLmRpcmVjdFRvdWNoKSxjLGMpfSxiLm9wdGlvbnMua2ROb3c/MDoxKX0sc2VhcmNoS0RUcmVlOmZ1bmN0aW9uKGEsYil7ZnVuY3Rpb24gYyhhLGIsaixrKXt2YXIgbD1iLnBvaW50LG09ZC5rZEF4aXNBcnJheVtqJWtdLG8scCxyPWw7cD1zKGFbZV0pJiZzKGxbZV0pP01hdGgucG93KGFbZV0tbFtlXSwyKTpudWxsO289cyhhW2ZdKSYmcyhsW2ZdKT9NYXRoLnBvdyhhW2ZdLWxbZl0sMik6bnVsbDtvPShwfHwwKSsob3x8MCk7bC5kaXN0PXMobyk/TWF0aC5zcXJ0KG8pOk51bWJlci5NQVhfVkFMVUU7bC5kaXN0WD1zKHApP01hdGguc3FydChwKTpOdW1iZXIuTUFYX1ZBTFVFO209YVttXS1sW21dO289bTwwP1wibGVmdFwiOlwicmlnaHRcIjtwPW08MD9cInJpZ2h0XCI6XCJsZWZ0XCI7YltvXSYmKG89YyhhLGJbb10saisxLGspLHI9b1tnXTxyW2ddP286bCk7YltwXSYmTWF0aC5zcXJ0KG0qbSk8cltnXSYmKGE9YyhhLFxuYltwXSxqKzEsaykscj1hW2ddPHJbZ10/YTpyKTtyZXR1cm4gcn12YXIgZD10aGlzLGU9dGhpcy5rZEF4aXNBcnJheVswXSxmPXRoaXMua2RBeGlzQXJyYXlbMV0sZz1iP1wiZGlzdFhcIjpcImRpc3RcIjt0aGlzLmtkVHJlZXx8dGhpcy5idWlsZEtEVHJlZSgpO2lmKHRoaXMua2RUcmVlKXJldHVybiBjKGEsdGhpcy5rZFRyZWUsdGhpcy5rZERpbWVuc2lvbnMsdGhpcy5rZERpbWVuc2lvbnMpfX07VGIucHJvdG90eXBlPXtkZXN0cm95OmZ1bmN0aW9uKCl7UGEodGhpcyx0aGlzLmF4aXMpfSxyZW5kZXI6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5vcHRpb25zLGM9Yi5mb3JtYXQsYz1jP0xhKGMsdGhpcyk6Yi5mb3JtYXR0ZXIuY2FsbCh0aGlzKTt0aGlzLmxhYmVsP3RoaXMubGFiZWwuYXR0cih7dGV4dDpjLHZpc2liaWxpdHk6XCJoaWRkZW5cIn0pOnRoaXMubGFiZWw9dGhpcy5heGlzLmNoYXJ0LnJlbmRlcmVyLnRleHQoYyxudWxsLG51bGwsYi51c2VIVE1MKS5jc3MoYi5zdHlsZSkuYXR0cih7YWxpZ246dGhpcy50ZXh0QWxpZ24sXG5yb3RhdGlvbjpiLnJvdGF0aW9uLHZpc2liaWxpdHk6XCJoaWRkZW5cIn0pLmFkZChhKX0sc2V0T2Zmc2V0OmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5heGlzLGQ9Yy5jaGFydCxlPWQuaW52ZXJ0ZWQsZj1jLnJldmVyc2VkLGY9dGhpcy5pc05lZ2F0aXZlJiYhZnx8IXRoaXMuaXNOZWdhdGl2ZSYmZixnPWMudHJhbnNsYXRlKGMudXNlUGVyY2VudGFnZT8xMDA6dGhpcy50b3RhbCwwLDAsMCwxKSxjPWMudHJhbnNsYXRlKDApLGM9UyhnLWMpLGg9ZC54QXhpc1swXS50cmFuc2xhdGUodGhpcy54KSthLGk9ZC5wbG90SGVpZ2h0LGY9e3g6ZT9mP2c6Zy1jOmgseTplP2ktaC1iOmY/aS1nLWM6aS1nLHdpZHRoOmU/YzpiLGhlaWdodDplP2I6Y307aWYoZT10aGlzLmxhYmVsKWUuYWxpZ24odGhpcy5hbGlnbk9wdGlvbnMsbnVsbCxmKSxmPWUuYWxpZ25BdHRyLGVbdGhpcy5vcHRpb25zLmNyb3A9PT0hMXx8ZC5pc0luc2lkZVBsb3QoZi54LGYueSk/XCJzaG93XCI6XCJoaWRlXCJdKCEwKX19O0NhLnByb3RvdHlwZS5nZXRTdGFja3M9XG5mdW5jdGlvbigpe3ZhciBhPXRoaXM7bihhLnlBeGlzLGZ1bmN0aW9uKGEpe2lmKGEuc3RhY2tzJiZhLmhhc1Zpc2libGVTZXJpZXMpYS5vbGRTdGFja3M9YS5zdGFja3N9KTtuKGEuc2VyaWVzLGZ1bmN0aW9uKGIpe2lmKGIub3B0aW9ucy5zdGFja2luZyYmKGIudmlzaWJsZT09PSEwfHxhLm9wdGlvbnMuY2hhcnQuaWdub3JlSGlkZGVuU2VyaWVzPT09ITEpKWIuc3RhY2tLZXk9Yi50eXBlK3EoYi5vcHRpb25zLnN0YWNrLFwiXCIpfSl9O0kucHJvdG90eXBlLmJ1aWxkU3RhY2tzPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5zZXJpZXMsYixjPXEodGhpcy5vcHRpb25zLnJldmVyc2VkU3RhY2tzLCEwKSxkPWEubGVuZ3RoLGU7aWYoIXRoaXMuaXNYQXhpcyl7dGhpcy51c2VQZXJjZW50YWdlPSExO2ZvcihlPWQ7ZS0tOylhW2M/ZTpkLWUtMV0uc2V0U3RhY2tlZFBvaW50cygpO2ZvcihlPWQ7ZS0tOyliPWFbYz9lOmQtZS0xXSxiLnNldFN0YWNrQ2xpZmZzJiZiLnNldFN0YWNrQ2xpZmZzKCk7aWYodGhpcy51c2VQZXJjZW50YWdlKWZvcihlPVxuMDtlPGQ7ZSsrKWFbZV0uc2V0UGVyY2VudFN0YWNrcygpfX07SS5wcm90b3R5cGUucmVuZGVyU3RhY2tUb3RhbHM9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmNoYXJ0LGI9YS5yZW5kZXJlcixjPXRoaXMuc3RhY2tzLGQsZSxmPXRoaXMuc3RhY2tUb3RhbEdyb3VwO2lmKCFmKXRoaXMuc3RhY2tUb3RhbEdyb3VwPWY9Yi5nKFwic3RhY2stbGFiZWxzXCIpLmF0dHIoe3Zpc2liaWxpdHk6XCJ2aXNpYmxlXCIsekluZGV4OjZ9KS5hZGQoKTtmLnRyYW5zbGF0ZShhLnBsb3RMZWZ0LGEucGxvdFRvcCk7Zm9yKGQgaW4gYylmb3IoZSBpbiBhPWNbZF0sYSlhW2VdLnJlbmRlcihmKX07SS5wcm90b3R5cGUucmVzZXRTdGFja3M9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLnN0YWNrcyxiLGM7aWYoIXRoaXMuaXNYQXhpcylmb3IoYiBpbiBhKWZvcihjIGluIGFbYl0pYVtiXVtjXS50b3VjaGVkPHRoaXMuc3RhY2tzVG91Y2hlZD8oYVtiXVtjXS5kZXN0cm95KCksZGVsZXRlIGFbYl1bY10pOihhW2JdW2NdLnRvdGFsPVxubnVsbCxhW2JdW2NdLmN1bT0wKX07SS5wcm90b3R5cGUuY2xlYW5TdGFja3M9ZnVuY3Rpb24oKXt2YXIgYSxiLGM7aWYoIXRoaXMuaXNYQXhpcyl7aWYodGhpcy5vbGRTdGFja3MpYT10aGlzLnN0YWNrcz10aGlzLm9sZFN0YWNrcztmb3IoYiBpbiBhKWZvcihjIGluIGFbYl0pYVtiXVtjXS5jdW09YVtiXVtjXS50b3RhbH19O1EucHJvdG90eXBlLnNldFN0YWNrZWRQb2ludHM9ZnVuY3Rpb24oKXtpZih0aGlzLm9wdGlvbnMuc3RhY2tpbmcmJiEodGhpcy52aXNpYmxlIT09ITAmJnRoaXMuY2hhcnQub3B0aW9ucy5jaGFydC5pZ25vcmVIaWRkZW5TZXJpZXMhPT0hMSkpe3ZhciBhPXRoaXMucHJvY2Vzc2VkWERhdGEsYj10aGlzLnByb2Nlc3NlZFlEYXRhLGM9W10sZD1iLmxlbmd0aCxlPXRoaXMub3B0aW9ucyxmPWUudGhyZXNob2xkLGc9ZS5zdGFydEZyb21UaHJlc2hvbGQ/ZjowLGg9ZS5zdGFjayxlPWUuc3RhY2tpbmcsaT10aGlzLnN0YWNrS2V5LGo9XCItXCIraSxrPXRoaXMubmVnU3RhY2tzLFxubD10aGlzLnlBeGlzLG09bC5zdGFja3Msbz1sLm9sZFN0YWNrcyxwLHIsbixQLHUsdyxzO2wuc3RhY2tzVG91Y2hlZCs9MTtmb3IodT0wO3U8ZDt1Kyspe3c9YVt1XTtzPWJbdV07cD10aGlzLmdldFN0YWNrSW5kaWNhdG9yKHAsdyx0aGlzLmluZGV4KTtQPXAua2V5O249KHI9ayYmczwoZz8wOmYpKT9qOmk7bVtuXXx8KG1bbl09e30pO2lmKCFtW25dW3ddKW9bbl0mJm9bbl1bd10/KG1bbl1bd109b1tuXVt3XSxtW25dW3ddLnRvdGFsPW51bGwpOm1bbl1bd109bmV3IFRiKGwsbC5vcHRpb25zLnN0YWNrTGFiZWxzLHIsdyxoKTtuPW1bbl1bd107aWYocyE9PW51bGwpbi5wb2ludHNbUF09bi5wb2ludHNbdGhpcy5pbmRleF09W3Eobi5jdW0sZyldLG4udG91Y2hlZD1sLnN0YWNrc1RvdWNoZWQscC5pbmRleD4wJiZ0aGlzLnNpbmdsZVN0YWNrcz09PSExJiYobi5wb2ludHNbUF1bMF09bi5wb2ludHNbdGhpcy5pbmRleCtcIixcIit3K1wiLDBcIl1bMF0pO2U9PT1cInBlcmNlbnRcIj8ocj1yP2k6XG5qLGsmJm1bcl0mJm1bcl1bd10/KHI9bVtyXVt3XSxuLnRvdGFsPXIudG90YWw9dihyLnRvdGFsLG4udG90YWwpK1Mocyl8fDApOm4udG90YWw9bmEobi50b3RhbCsoUyhzKXx8MCkpKTpuLnRvdGFsPW5hKG4udG90YWwrKHN8fDApKTtuLmN1bT1xKG4uY3VtLGcpKyhzfHwwKTtpZihzIT09bnVsbCluLnBvaW50c1tQXS5wdXNoKG4uY3VtKSxjW3VdPW4uY3VtfWlmKGU9PT1cInBlcmNlbnRcIilsLnVzZVBlcmNlbnRhZ2U9ITA7dGhpcy5zdGFja2VkWURhdGE9YztsLm9sZFN0YWNrcz17fX19O1EucHJvdG90eXBlLnNldFBlcmNlbnRTdGFja3M9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5zdGFja0tleSxjPWEueUF4aXMuc3RhY2tzLGQ9YS5wcm9jZXNzZWRYRGF0YSxlO24oW2IsXCItXCIrYl0sZnVuY3Rpb24oYil7dmFyIGY7Zm9yKHZhciBnPWQubGVuZ3RoLGgsaTtnLS07KWlmKGg9ZFtnXSxlPWEuZ2V0U3RhY2tJbmRpY2F0b3IoZSxoLGEuaW5kZXgpLGY9KGk9Y1tiXSYmY1tiXVtoXSkmJlxuaS5wb2ludHNbZS5rZXldLGg9ZilpPWkudG90YWw/MTAwL2kudG90YWw6MCxoWzBdPW5hKGhbMF0qaSksaFsxXT1uYShoWzFdKmkpLGEuc3RhY2tlZFlEYXRhW2ddPWhbMV19KX07US5wcm90b3R5cGUuZ2V0U3RhY2tJbmRpY2F0b3I9ZnVuY3Rpb24oYSxiLGMpeyFzKGEpfHxhLnghPT1iP2E9e3g6YixpbmRleDowfTphLmluZGV4Kys7YS5rZXk9W2MsYixhLmluZGV4XS5qb2luKFwiLFwiKTtyZXR1cm4gYX07eChDYS5wcm90b3R5cGUse2FkZFNlcmllczpmdW5jdGlvbihhLGIsYyl7dmFyIGQsZT10aGlzO2EmJihiPXEoYiwhMCksTShlLFwiYWRkU2VyaWVzXCIse29wdGlvbnM6YX0sZnVuY3Rpb24oKXtkPWUuaW5pdFNlcmllcyhhKTtlLmlzRGlydHlMZWdlbmQ9ITA7ZS5saW5rU2VyaWVzKCk7YiYmZS5yZWRyYXcoYyl9KSk7cmV0dXJuIGR9LGFkZEF4aXM6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9Yj9cInhBeGlzXCI6XCJ5QXhpc1wiLGY9dGhpcy5vcHRpb25zLGE9QyhhLHtpbmRleDp0aGlzW2VdLmxlbmd0aCxcbmlzWDpifSk7bmV3IEkodGhpcyxhKTtmW2VdPXZhKGZbZV18fHt9KTtmW2VdLnB1c2goYSk7cShjLCEwKSYmdGhpcy5yZWRyYXcoZCl9LHNob3dMb2FkaW5nOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMsYz1iLm9wdGlvbnMsZD1iLmxvYWRpbmdEaXYsZT1jLmxvYWRpbmcsZj1mdW5jdGlvbigpe2QmJkYoZCx7bGVmdDpiLnBsb3RMZWZ0K1wicHhcIix0b3A6Yi5wbG90VG9wK1wicHhcIix3aWR0aDpiLnBsb3RXaWR0aCtcInB4XCIsaGVpZ2h0OmIucGxvdEhlaWdodCtcInB4XCJ9KX07aWYoIWQpYi5sb2FkaW5nRGl2PWQ9ZWEoV2Ese2NsYXNzTmFtZTpcImhpZ2hjaGFydHMtbG9hZGluZ1wifSx4KGUuc3R5bGUse3pJbmRleDoxMCxkaXNwbGF5Olwibm9uZVwifSksYi5jb250YWluZXIpLGIubG9hZGluZ1NwYW49ZWEoXCJzcGFuXCIsbnVsbCxlLmxhYmVsU3R5bGUsZCksRChiLFwicmVkcmF3XCIsZik7Yi5sb2FkaW5nU3Bhbi5pbm5lckhUTUw9YXx8Yy5sYW5nLmxvYWRpbmc7aWYoIWIubG9hZGluZ1Nob3duKUYoZCxcbntvcGFjaXR5OjAsZGlzcGxheTpcIlwifSksZWIoZCx7b3BhY2l0eTplLnN0eWxlLm9wYWNpdHl9LHtkdXJhdGlvbjplLnNob3dEdXJhdGlvbnx8MH0pLGIubG9hZGluZ1Nob3duPSEwO2YoKX0saGlkZUxvYWRpbmc6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9wdGlvbnMsYj10aGlzLmxvYWRpbmdEaXY7YiYmZWIoYix7b3BhY2l0eTowfSx7ZHVyYXRpb246YS5sb2FkaW5nLmhpZGVEdXJhdGlvbnx8MTAwLGNvbXBsZXRlOmZ1bmN0aW9uKCl7RihiLHtkaXNwbGF5Olwibm9uZVwifSl9fSk7dGhpcy5sb2FkaW5nU2hvd249ITF9fSk7eChIYS5wcm90b3R5cGUse3VwZGF0ZTpmdW5jdGlvbihhLGIsYyxkKXtmdW5jdGlvbiBlKCl7Zi5hcHBseU9wdGlvbnMoYSk7aWYoZi55PT09bnVsbCYmaClmLmdyYXBoaWM9aC5kZXN0cm95KCk7aWYoZGEoYSkmJiFKYShhKSlmLnJlZHJhdz1mdW5jdGlvbigpe2lmKGgmJmguZWxlbWVudCYmYSYmYS5tYXJrZXImJmEubWFya2VyLnN5bWJvbClmLmdyYXBoaWM9aC5kZXN0cm95KCk7XG5pZihhJiZhLmRhdGFMYWJlbHMmJmYuZGF0YUxhYmVsKWYuZGF0YUxhYmVsPWYuZGF0YUxhYmVsLmRlc3Ryb3koKTtmLnJlZHJhdz1udWxsfTtpPWYuaW5kZXg7Zy51cGRhdGVQYXJhbGxlbEFycmF5cyhmLGkpO2lmKGwmJmYubmFtZSlsW2YueF09Zi5uYW1lO2suZGF0YVtpXT1kYShrLmRhdGFbaV0pJiYhSmEoay5kYXRhW2ldKT9mLm9wdGlvbnM6YTtnLmlzRGlydHk9Zy5pc0RpcnR5RGF0YT0hMDtpZighZy5maXhlZEJveCYmZy5oYXNDYXJ0ZXNpYW5TZXJpZXMpai5pc0RpcnR5Qm94PSEwO2lmKGsubGVnZW5kVHlwZT09PVwicG9pbnRcIilqLmlzRGlydHlMZWdlbmQ9ITA7YiYmai5yZWRyYXcoYyl9dmFyIGY9dGhpcyxnPWYuc2VyaWVzLGg9Zi5ncmFwaGljLGksaj1nLmNoYXJ0LGs9Zy5vcHRpb25zLGw9Zy54QXhpcyYmZy54QXhpcy5uYW1lcyxiPXEoYiwhMCk7ZD09PSExP2UoKTpmLmZpcmVQb2ludEV2ZW50KFwidXBkYXRlXCIse29wdGlvbnM6YX0sZSl9LHJlbW92ZTpmdW5jdGlvbihhLFxuYil7dGhpcy5zZXJpZXMucmVtb3ZlUG9pbnQoc2EodGhpcyx0aGlzLnNlcmllcy5kYXRhKSxhLGIpfX0pO3goUS5wcm90b3R5cGUse2FkZFBvaW50OmZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPXRoaXMsZj1lLm9wdGlvbnMsZz1lLmRhdGEsaD1lLmdyYXBoLGk9ZS5hcmVhLGo9ZS5jaGFydCxrPWUueEF4aXMmJmUueEF4aXMubmFtZXMsbD1oJiZoLnNoaWZ0fHwwLG09W1wiZ3JhcGhcIixcImFyZWFcIl0saD1mLmRhdGEsbyxwPWUueERhdGE7YWIoZCxqKTtpZihjKXtmb3IoZD1lLnpvbmVzLmxlbmd0aDtkLS07KW0ucHVzaChcInpvbmVHcmFwaFwiK2QsXCJ6b25lQXJlYVwiK2QpO24obSxmdW5jdGlvbihhKXtpZihlW2FdKWVbYV0uc2hpZnQ9bCsoZi5zdGVwPzI6MSl9KX1pZihpKWkuaXNBcmVhPSEwO2I9cShiLCEwKTtpPXtzZXJpZXM6ZX07ZS5wb2ludENsYXNzLnByb3RvdHlwZS5hcHBseU9wdGlvbnMuYXBwbHkoaSxbYV0pO209aS54O2Q9cC5sZW5ndGg7aWYoZS5yZXF1aXJlU29ydGluZyYmbTxcbnBbZC0xXSlmb3Iobz0hMDtkJiZwW2QtMV0+bTspZC0tO2UudXBkYXRlUGFyYWxsZWxBcnJheXMoaSxcInNwbGljZVwiLGQsMCwwKTtlLnVwZGF0ZVBhcmFsbGVsQXJyYXlzKGksZCk7aWYoayYmaS5uYW1lKWtbbV09aS5uYW1lO2guc3BsaWNlKGQsMCxhKTtvJiYoZS5kYXRhLnNwbGljZShkLDAsbnVsbCksZS5wcm9jZXNzRGF0YSgpKTtmLmxlZ2VuZFR5cGU9PT1cInBvaW50XCImJmUuZ2VuZXJhdGVQb2ludHMoKTtjJiYoZ1swXSYmZ1swXS5yZW1vdmU/Z1swXS5yZW1vdmUoITEpOihnLnNoaWZ0KCksZS51cGRhdGVQYXJhbGxlbEFycmF5cyhpLFwic2hpZnRcIiksaC5zaGlmdCgpKSk7ZS5pc0RpcnR5PSEwO2UuaXNEaXJ0eURhdGE9ITA7YiYmKGUuZ2V0QXR0cmlicygpLGoucmVkcmF3KCkpfSxyZW1vdmVQb2ludDpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9dGhpcyxlPWQuZGF0YSxmPWVbYV0sZz1kLnBvaW50cyxoPWQuY2hhcnQsaT1mdW5jdGlvbigpe2cmJmcubGVuZ3RoPT09ZS5sZW5ndGgmJlxuZy5zcGxpY2UoYSwxKTtlLnNwbGljZShhLDEpO2Qub3B0aW9ucy5kYXRhLnNwbGljZShhLDEpO2QudXBkYXRlUGFyYWxsZWxBcnJheXMoZnx8e3NlcmllczpkfSxcInNwbGljZVwiLGEsMSk7ZiYmZi5kZXN0cm95KCk7ZC5pc0RpcnR5PSEwO2QuaXNEaXJ0eURhdGE9ITA7YiYmaC5yZWRyYXcoKX07YWIoYyxoKTtiPXEoYiwhMCk7Zj9mLmZpcmVQb2ludEV2ZW50KFwicmVtb3ZlXCIsbnVsbCxpKTppKCl9LHJlbW92ZTpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMsZD1jLmNoYXJ0O00oYyxcInJlbW92ZVwiLG51bGwsZnVuY3Rpb24oKXtjLmRlc3Ryb3koKTtkLmlzRGlydHlMZWdlbmQ9ZC5pc0RpcnR5Qm94PSEwO2QubGlua1NlcmllcygpO3EoYSwhMCkmJmQucmVkcmF3KGIpfSl9LHVwZGF0ZTpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMsZD10aGlzLmNoYXJ0LGU9dGhpcy51c2VyT3B0aW9ucyxmPXRoaXMudHlwZSxnPUtbZl0ucHJvdG90eXBlLGg9W1wiZ3JvdXBcIixcIm1hcmtlckdyb3VwXCIsXCJkYXRhTGFiZWxzR3JvdXBcIl0sXG5pO2lmKGEudHlwZSYmYS50eXBlIT09Znx8YS56SW5kZXghPT12b2lkIDApaC5sZW5ndGg9MDtuKGgsZnVuY3Rpb24oYSl7aFthXT1jW2FdO2RlbGV0ZSBjW2FdfSk7YT1DKGUse2FuaW1hdGlvbjohMSxpbmRleDp0aGlzLmluZGV4LHBvaW50U3RhcnQ6dGhpcy54RGF0YVswXX0se2RhdGE6dGhpcy5vcHRpb25zLmRhdGF9LGEpO3RoaXMucmVtb3ZlKCExKTtmb3IoaSBpbiBnKXRoaXNbaV09dDt4KHRoaXMsS1thLnR5cGV8fGZdLnByb3RvdHlwZSk7bihoLGZ1bmN0aW9uKGEpe2NbYV09aFthXX0pO3RoaXMuaW5pdChkLGEpO2QubGlua1NlcmllcygpO3EoYiwhMCkmJmQucmVkcmF3KCExKX19KTt4KEkucHJvdG90eXBlLHt1cGRhdGU6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmNoYXJ0LGE9Yy5vcHRpb25zW3RoaXMuY29sbF1bdGhpcy5vcHRpb25zLmluZGV4XT1DKHRoaXMudXNlck9wdGlvbnMsYSk7dGhpcy5kZXN0cm95KCEwKTt0aGlzLl9hZGRlZFBsb3RMQj10aGlzLmNoYXJ0Ll9sYWJlbFBhbmVzPVxudDt0aGlzLmluaXQoYyx4KGEse2V2ZW50czp0fSkpO2MuaXNEaXJ0eUJveD0hMDtxKGIsITApJiZjLnJlZHJhdygpfSxyZW1vdmU6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPXRoaXMuY2hhcnQsYz10aGlzLmNvbGwsZD10aGlzLnNlcmllcyxlPWQubGVuZ3RoO2UtLTspZFtlXSYmZFtlXS5yZW1vdmUoITEpO0FhKGIuYXhlcyx0aGlzKTtBYShiW2NdLHRoaXMpO2Iub3B0aW9uc1tjXS5zcGxpY2UodGhpcy5vcHRpb25zLmluZGV4LDEpO24oYltjXSxmdW5jdGlvbihhLGIpe2Eub3B0aW9ucy5pbmRleD1ifSk7dGhpcy5kZXN0cm95KCk7Yi5pc0RpcnR5Qm94PSEwO3EoYSwhMCkmJmIucmVkcmF3KCl9LHNldFRpdGxlOmZ1bmN0aW9uKGEsYil7dGhpcy51cGRhdGUoe3RpdGxlOmF9LGIpfSxzZXRDYXRlZ29yaWVzOmZ1bmN0aW9uKGEsYil7dGhpcy51cGRhdGUoe2NhdGVnb3JpZXM6YX0sYil9fSk7dmFyIElhPWxhKFEpO0subGluZT1JYTtXLmFyZWE9QyhjYSx7c29mdFRocmVzaG9sZDohMSx0aHJlc2hvbGQ6MH0pO1xudmFyIHphPWxhKFEse3R5cGU6XCJhcmVhXCIsc2luZ2xlU3RhY2tzOiExLGdldFN0YWNrUG9pbnRzOmZ1bmN0aW9uKCl7dmFyIGE9W10sYj1bXSxjPXRoaXMueEF4aXMsZD10aGlzLnlBeGlzLGU9ZC5zdGFja3NbdGhpcy5zdGFja0tleV0sZj17fSxnPXRoaXMucG9pbnRzLGg9dGhpcy5pbmRleCxpPWQuc2VyaWVzLGo9aS5sZW5ndGgsayxsPXEoZC5vcHRpb25zLnJldmVyc2VkU3RhY2tzLCEwKT8xOi0xLG0sbztpZih0aGlzLm9wdGlvbnMuc3RhY2tpbmcpe2ZvcihtPTA7bTxnLmxlbmd0aDttKyspZltnW21dLnhdPWdbbV07Zm9yKG8gaW4gZSllW29dLnRvdGFsIT09bnVsbCYmYi5wdXNoKG8pO2Iuc29ydChmdW5jdGlvbihhLGIpe3JldHVybiBhLWJ9KTtrPXRhKGksZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy52aXNpYmxlfSk7bihiLGZ1bmN0aW9uKGcsaSl7dmFyIG89MCxxLHU7aWYoZltnXSYmIWZbZ10uaXNOdWxsKWEucHVzaChmW2ddKSxuKFstMSwxXSxmdW5jdGlvbihhKXt2YXIgYz1cbmE9PT0xP1wicmlnaHROdWxsXCI6XCJsZWZ0TnVsbFwiLGQ9MCxvPWVbYltpK2FdXTtpZihvKWZvcihtPWg7bT49MCYmbTxqOylxPW8ucG9pbnRzW21dLHF8fChtPT09aD9mW2ddW2NdPSEwOmtbbV0mJih1PWVbZ10ucG9pbnRzW21dKSYmKGQtPXVbMV0tdVswXSkpLG0rPWw7ZltnXVthPT09MT9cInJpZ2h0Q2xpZmZcIjpcImxlZnRDbGlmZlwiXT1kfSk7ZWxzZXtmb3IobT1oO20+PTAmJm08ajspe2lmKHE9ZVtnXS5wb2ludHNbbV0pe289cVsxXTticmVha31tKz1sfW89ZC50b1BpeGVscyhvLCEwKTthLnB1c2goe2lzTnVsbDohMCxwbG90WDpjLnRvUGl4ZWxzKGcsITApLHBsb3RZOm8seUJvdHRvbTpvfSl9fSl9cmV0dXJuIGF9LGdldEdyYXBoUGF0aDpmdW5jdGlvbihhKXt2YXIgYj1RLnByb3RvdHlwZS5nZXRHcmFwaFBhdGgsYz10aGlzLm9wdGlvbnMsZD1jLnN0YWNraW5nLGU9dGhpcy55QXhpcyxmLGcsaD1bXSxpPVtdLGo9dGhpcy5pbmRleCxrLGw9ZS5zdGFja3NbdGhpcy5zdGFja0tleV0sXG5tPWMudGhyZXNob2xkLG89ZS5nZXRUaHJlc2hvbGQoYy50aHJlc2hvbGQpLHAsYz1jLmNvbm5lY3ROdWxsc3x8ZD09PVwicGVyY2VudFwiLHI9ZnVuY3Rpb24oYixjLGYpe3ZhciBnPWFbYl0sYj1kJiZsW2cueF0ucG9pbnRzW2pdLHA9Z1tmK1wiTnVsbFwiXXx8MCxmPWdbZitcIkNsaWZmXCJdfHwwLHIsbixnPSEwO2Z8fHA/KHI9KHA/YlswXTpiWzFdKStmLG49YlswXStmLGc9ISFwKTohZCYmYVtjXSYmYVtjXS5pc051bGwmJihyPW49bSk7ciE9PXZvaWQgMCYmKGkucHVzaCh7cGxvdFg6ayxwbG90WTpyPT09bnVsbD9vOmUuZ2V0VGhyZXNob2xkKHIpLGlzTnVsbDpnfSksaC5wdXNoKHtwbG90WDprLHBsb3RZOm49PT1udWxsP286ZS5nZXRUaHJlc2hvbGQobil9KSl9LGE9YXx8dGhpcy5wb2ludHM7ZCYmKGE9dGhpcy5nZXRTdGFja1BvaW50cygpKTtmb3IoZj0wO2Y8YS5sZW5ndGg7ZisrKWlmKGc9YVtmXS5pc051bGwsaz1xKGFbZl0ucmVjdFBsb3RYLGFbZl0ucGxvdFgpLHA9cShhW2ZdLnlCb3R0b20sXG5vKSwhZ3x8Yyl7Y3x8cihmLGYtMSxcImxlZnRcIik7aWYoIWd8fGR8fCFjKWkucHVzaChhW2ZdKSxoLnB1c2goe3g6ZixwbG90WDprLHBsb3RZOnB9KTtjfHxyKGYsZisxLFwicmlnaHRcIil9Zj1iLmNhbGwodGhpcyxpLCEwLCEwKTtoLnJldmVyc2VkPSEwO2c9Yi5jYWxsKHRoaXMsaCwhMCwhMCk7Zy5sZW5ndGgmJihnWzBdPVwiTFwiKTtmPWYuY29uY2F0KGcpO2I9Yi5jYWxsKHRoaXMsaSwhMSxjKTt0aGlzLmFyZWFQYXRoPWY7cmV0dXJuIGJ9LGRyYXdHcmFwaDpmdW5jdGlvbigpe3RoaXMuYXJlYVBhdGg9W107US5wcm90b3R5cGUuZHJhd0dyYXBoLmFwcGx5KHRoaXMpO3ZhciBhPXRoaXMsYj10aGlzLmFyZWFQYXRoLGM9dGhpcy5vcHRpb25zLGQ9W1tcImFyZWFcIix0aGlzLmNvbG9yLGMuZmlsbENvbG9yXV07bih0aGlzLnpvbmVzLGZ1bmN0aW9uKGIsZil7ZC5wdXNoKFtcInpvbmVBcmVhXCIrZixiLmNvbG9yfHxhLmNvbG9yLGIuZmlsbENvbG9yfHxjLmZpbGxDb2xvcl0pfSk7bihkLGZ1bmN0aW9uKGQpe3ZhciBmPVxuZFswXSxnPWFbZl07Zz9nLmFuaW1hdGUoe2Q6Yn0pOihnPXtmaWxsOmRbMl18fGRbMV0sekluZGV4OjB9LGRbMl18fChnW1wiZmlsbC1vcGFjaXR5XCJdPXEoYy5maWxsT3BhY2l0eSwwLjc1KSksYVtmXT1hLmNoYXJ0LnJlbmRlcmVyLnBhdGgoYikuYXR0cihnKS5hZGQoYS5ncm91cCkpfSl9LGRyYXdMZWdlbmRTeW1ib2w6YWEuZHJhd1JlY3RhbmdsZX0pO0suYXJlYT16YTtXLnNwbGluZT1DKGNhKTtJYT1sYShRLHt0eXBlOlwic3BsaW5lXCIsZ2V0UG9pbnRTcGxpbmU6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPWIucGxvdFgsZT1iLnBsb3RZLGY9YVtjLTFdLGM9YVtjKzFdLGcsaCxpLGo7aWYoZiYmIWYuaXNOdWxsJiZjJiYhYy5pc051bGwpe2E9Zi5wbG90WTtpPWMucGxvdFg7dmFyIGM9Yy5wbG90WSxrPTA7Zz0oMS41KmQrZi5wbG90WCkvMi41O2g9KDEuNSplK2EpLzIuNTtpPSgxLjUqZCtpKS8yLjU7aj0oMS41KmUrYykvMi41O2khPT1nJiYoaz0oai1oKSooaS1kKS8oaS1nKStlLWopO1xuaCs9aztqKz1rO2g+YSYmaD5lPyhoPXYoYSxlKSxqPTIqZS1oKTpoPGEmJmg8ZSYmKGg9RShhLGUpLGo9MiplLWgpO2o+YyYmaj5lPyhqPXYoYyxlKSxoPTIqZS1qKTpqPGMmJmo8ZSYmKGo9RShjLGUpLGg9MiplLWopO2IucmlnaHRDb250WD1pO2IucmlnaHRDb250WT1qfWI9W1wiQ1wiLHEoZi5yaWdodENvbnRYLGYucGxvdFgpLHEoZi5yaWdodENvbnRZLGYucGxvdFkpLHEoZyxkKSxxKGgsZSksZCxlXTtmLnJpZ2h0Q29udFg9Zi5yaWdodENvbnRZPW51bGw7cmV0dXJuIGJ9fSk7Sy5zcGxpbmU9SWE7Vy5hcmVhc3BsaW5lPUMoVy5hcmVhKTt6YT16YS5wcm90b3R5cGU7SWE9bGEoSWEse3R5cGU6XCJhcmVhc3BsaW5lXCIsZ2V0U3RhY2tQb2ludHM6emEuZ2V0U3RhY2tQb2ludHMsZ2V0R3JhcGhQYXRoOnphLmdldEdyYXBoUGF0aCxzZXRTdGFja0NsaWZmczp6YS5zZXRTdGFja0NsaWZmcyxkcmF3R3JhcGg6emEuZHJhd0dyYXBoLGRyYXdMZWdlbmRTeW1ib2w6YWEuZHJhd1JlY3RhbmdsZX0pO1xuSy5hcmVhc3BsaW5lPUlhO1cuY29sdW1uPUMoY2Ese2JvcmRlckNvbG9yOlwiI0ZGRkZGRlwiLGJvcmRlclJhZGl1czowLGdyb3VwUGFkZGluZzowLjIsbWFya2VyOm51bGwscG9pbnRQYWRkaW5nOjAuMSxtaW5Qb2ludExlbmd0aDowLGNyb3BUaHJlc2hvbGQ6NTAscG9pbnRSYW5nZTpudWxsLHN0YXRlczp7aG92ZXI6e2JyaWdodG5lc3M6MC4xLHNoYWRvdzohMSxoYWxvOiExfSxzZWxlY3Q6e2NvbG9yOlwiI0MwQzBDMFwiLGJvcmRlckNvbG9yOlwiIzAwMDAwMFwiLHNoYWRvdzohMX19LGRhdGFMYWJlbHM6e2FsaWduOm51bGwsdmVydGljYWxBbGlnbjpudWxsLHk6bnVsbH0sc29mdFRocmVzaG9sZDohMSxzdGFydEZyb21UaHJlc2hvbGQ6ITAsc3RpY2t5VHJhY2tpbmc6ITEsdG9vbHRpcDp7ZGlzdGFuY2U6Nn0sdGhyZXNob2xkOjB9KTtJYT1sYShRLHt0eXBlOlwiY29sdW1uXCIscG9pbnRBdHRyVG9PcHRpb25zOntzdHJva2U6XCJib3JkZXJDb2xvclwiLGZpbGw6XCJjb2xvclwiLHI6XCJib3JkZXJSYWRpdXNcIn0sXG5jcm9wU2hvdWxkZXI6MCxkaXJlY3RUb3VjaDohMCx0cmFja2VyR3JvdXBzOltcImdyb3VwXCIsXCJkYXRhTGFiZWxzR3JvdXBcIl0sbmVnU3RhY2tzOiEwLGluaXQ6ZnVuY3Rpb24oKXtRLnByb3RvdHlwZS5pbml0LmFwcGx5KHRoaXMsYXJndW1lbnRzKTt2YXIgYT10aGlzLGI9YS5jaGFydDtiLmhhc1JlbmRlcmVkJiZuKGIuc2VyaWVzLGZ1bmN0aW9uKGIpe2lmKGIudHlwZT09PWEudHlwZSliLmlzRGlydHk9ITB9KX0sZ2V0Q29sdW1uTWV0cmljczpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLm9wdGlvbnMsYz1hLnhBeGlzLGQ9YS55QXhpcyxlPWMucmV2ZXJzZWQsZixnPXt9LGg9MDtiLmdyb3VwaW5nPT09ITE/aD0xOm4oYS5jaGFydC5zZXJpZXMsZnVuY3Rpb24oYil7dmFyIGM9Yi5vcHRpb25zLGU9Yi55QXhpcyxpO2lmKGIudHlwZT09PWEudHlwZSYmYi52aXNpYmxlJiZkLmxlbj09PWUubGVuJiZkLnBvcz09PWUucG9zKWMuc3RhY2tpbmc/KGY9Yi5zdGFja0tleSxnW2ZdPT09dCYmXG4oZ1tmXT1oKyspLGk9Z1tmXSk6Yy5ncm91cGluZyE9PSExJiYoaT1oKyspLGIuY29sdW1uSW5kZXg9aX0pO3ZhciBpPUUoUyhjLnRyYW5zQSkqKGMub3JkaW5hbFNsb3BlfHxiLnBvaW50UmFuZ2V8fGMuY2xvc2VzdFBvaW50UmFuZ2V8fGMudGlja0ludGVydmFsfHwxKSxjLmxlbiksaj1pKmIuZ3JvdXBQYWRkaW5nLGs9KGktMipqKS9oLGI9RShiLm1heFBvaW50V2lkdGh8fGMubGVuLHEoYi5wb2ludFdpZHRoLGsqKDEtMipiLnBvaW50UGFkZGluZykpKTthLmNvbHVtbk1ldHJpY3M9e3dpZHRoOmIsb2Zmc2V0OihrLWIpLzIrKGorKChhLmNvbHVtbkluZGV4fHwwKSsoZT8xOjApKSprLWkvMikqKGU/LTE6MSl9O3JldHVybiBhLmNvbHVtbk1ldHJpY3N9LGNyaXNwQ29sOmZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPXRoaXMuY2hhcnQsZj10aGlzLmJvcmRlcldpZHRoLGc9LShmJTI/MC41OjApLGY9ZiUyPzAuNToxO2UuaW52ZXJ0ZWQmJmUucmVuZGVyZXIuaXNWTUwmJihmKz0xKTtjPU1hdGgucm91bmQoYStcbmMpK2c7YT1NYXRoLnJvdW5kKGEpK2c7Yy09YTtkPU1hdGgucm91bmQoYitkKStmO2c9UyhiKTw9MC41JiZkPjAuNTtiPU1hdGgucm91bmQoYikrZjtkLT1iO2cmJmQmJihiLT0xLGQrPTEpO3JldHVybnt4OmEseTpiLHdpZHRoOmMsaGVpZ2h0OmR9fSx0cmFuc2xhdGU6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5jaGFydCxjPWEub3B0aW9ucyxkPWEuYm9yZGVyV2lkdGg9cShjLmJvcmRlcldpZHRoLGEuY2xvc2VzdFBvaW50UmFuZ2UqYS54QXhpcy50cmFuc0E8Mj8wOjEpLGU9YS55QXhpcyxmPWEudHJhbnNsYXRlZFRocmVzaG9sZD1lLmdldFRocmVzaG9sZChjLnRocmVzaG9sZCksZz1xKGMubWluUG9pbnRMZW5ndGgsNSksaD1hLmdldENvbHVtbk1ldHJpY3MoKSxpPWgud2lkdGgsaj1hLmJhclc9dihpLDErMipkKSxrPWEucG9pbnRYT2Zmc2V0PWgub2Zmc2V0O2IuaW52ZXJ0ZWQmJihmLT0wLjUpO2MucG9pbnRQYWRkaW5nJiYoaj1GYShqKSk7US5wcm90b3R5cGUudHJhbnNsYXRlLmFwcGx5KGEpO1xubihhLnBvaW50cyxmdW5jdGlvbihjKXt2YXIgZD1FKHEoYy55Qm90dG9tLGYpLDlFNCksaD05OTkrUyhkKSxoPUUodigtaCxjLnBsb3RZKSxlLmxlbitoKSxwPWMucGxvdFgrayxyPWosbj1FKGgsZCkscyx1PXYoaCxkKS1uO1ModSk8ZyYmZyYmKHU9ZyxzPSFlLnJldmVyc2VkJiYhYy5uZWdhdGl2ZXx8ZS5yZXZlcnNlZCYmYy5uZWdhdGl2ZSxuPVMobi1mKT5nP2QtZzpmLShzP2c6MCkpO2MuYmFyWD1wO2MucG9pbnRXaWR0aD1pO2MudG9vbHRpcFBvcz1iLmludmVydGVkP1tlLmxlbitlLnBvcy1iLnBsb3RMZWZ0LWgsYS54QXhpcy5sZW4tcC1yLzIsdV06W3Arci8yLGgrZS5wb3MtYi5wbG90VG9wLHVdO2Muc2hhcGVUeXBlPVwicmVjdFwiO2Muc2hhcGVBcmdzPWEuY3Jpc3BDb2wocCxuLHIsdSl9KX0sZ2V0U3ltYm9sOnJhLGRyYXdMZWdlbmRTeW1ib2w6YWEuZHJhd1JlY3RhbmdsZSxkcmF3R3JhcGg6cmEsZHJhd1BvaW50czpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj10aGlzLmNoYXJ0LFxuYz1hLm9wdGlvbnMsZD1iLnJlbmRlcmVyLGU9Yy5hbmltYXRpb25MaW1pdHx8MjUwLGYsZztuKGEucG9pbnRzLGZ1bmN0aW9uKGgpe3ZhciBpPWgucGxvdFksaj1oLmdyYXBoaWM7aWYoaSE9PXQmJiFpc05hTihpKSYmaC55IT09bnVsbClmPWguc2hhcGVBcmdzLGk9cyhhLmJvcmRlcldpZHRoKT97XCJzdHJva2Utd2lkdGhcIjphLmJvcmRlcldpZHRofTp7fSxnPWgucG9pbnRBdHRyW2guc2VsZWN0ZWQ/XCJzZWxlY3RcIjpcIlwiXXx8YS5wb2ludEF0dHJbXCJcIl0saj8oVGEoaiksai5hdHRyKGkpLmF0dHIoZylbYi5wb2ludENvdW50PGU/XCJhbmltYXRlXCI6XCJhdHRyXCJdKEMoZikpKTpoLmdyYXBoaWM9ZFtoLnNoYXBlVHlwZV0oZikuYXR0cihpKS5hdHRyKGcpLmFkZChoLmdyb3VwfHxhLmdyb3VwKS5zaGFkb3coYy5zaGFkb3csbnVsbCxjLnN0YWNraW5nJiYhYy5ib3JkZXJSYWRpdXMpO2Vsc2UgaWYoailoLmdyYXBoaWM9ai5kZXN0cm95KCl9KX0sYW5pbWF0ZTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLFxuYz10aGlzLnlBeGlzLGQ9Yi5vcHRpb25zLGU9dGhpcy5jaGFydC5pbnZlcnRlZCxmPXt9O2lmKGphKWE/KGYuc2NhbGVZPTAuMDAxLGE9RShjLnBvcytjLmxlbix2KGMucG9zLGMudG9QaXhlbHMoZC50aHJlc2hvbGQpKSksZT9mLnRyYW5zbGF0ZVg9YS1jLmxlbjpmLnRyYW5zbGF0ZVk9YSxiLmdyb3VwLmF0dHIoZikpOihmW2U/XCJ0cmFuc2xhdGVYXCI6XCJ0cmFuc2xhdGVZXCJdPWMucG9zLGIuZ3JvdXAuYW5pbWF0ZShmLHgoaGIoYi5vcHRpb25zLmFuaW1hdGlvbikse3N0ZXA6ZnVuY3Rpb24oYSxjKXtiLmdyb3VwLmF0dHIoe3NjYWxlWTpjLnBvc30pfX0pKSxiLmFuaW1hdGU9bnVsbCl9LHJlbW92ZTpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLmNoYXJ0O2IuaGFzUmVuZGVyZWQmJm4oYi5zZXJpZXMsZnVuY3Rpb24oYil7aWYoYi50eXBlPT09YS50eXBlKWIuaXNEaXJ0eT0hMH0pO1EucHJvdG90eXBlLnJlbW92ZS5hcHBseShhLGFyZ3VtZW50cyl9fSk7Sy5jb2x1bW49SWE7Vy5iYXI9XG5DKFcuY29sdW1uKTt6YT1sYShJYSx7dHlwZTpcImJhclwiLGludmVydGVkOiEwfSk7Sy5iYXI9emE7Vy5zY2F0dGVyPUMoY2Ese2xpbmVXaWR0aDowLG1hcmtlcjp7ZW5hYmxlZDohMH0sdG9vbHRpcDp7aGVhZGVyRm9ybWF0Oic8c3BhbiBzdHlsZT1cImNvbG9yOntwb2ludC5jb2xvcn1cIj5cXHUyNWNmPC9zcGFuPiA8c3BhbiBzdHlsZT1cImZvbnQtc2l6ZTogMTBweDtcIj4ge3Nlcmllcy5uYW1lfTwvc3Bhbj48YnIvPicscG9pbnRGb3JtYXQ6XCJ4OiA8Yj57cG9pbnQueH08L2I+PGJyLz55OiA8Yj57cG9pbnQueX08L2I+PGJyLz5cIn19KTt6YT1sYShRLHt0eXBlOlwic2NhdHRlclwiLHNvcnRlZDohMSxyZXF1aXJlU29ydGluZzohMSxub1NoYXJlZFRvb2x0aXA6ITAsdHJhY2tlckdyb3VwczpbXCJncm91cFwiLFwibWFya2VyR3JvdXBcIixcImRhdGFMYWJlbHNHcm91cFwiXSx0YWtlT3JkaW5hbFBvc2l0aW9uOiExLGtkRGltZW5zaW9uczoyLGRyYXdHcmFwaDpmdW5jdGlvbigpe3RoaXMub3B0aW9ucy5saW5lV2lkdGgmJlxuUS5wcm90b3R5cGUuZHJhd0dyYXBoLmNhbGwodGhpcyl9fSk7Sy5zY2F0dGVyPXphO1cucGllPUMoY2Ese2JvcmRlckNvbG9yOlwiI0ZGRkZGRlwiLGJvcmRlcldpZHRoOjEsY2VudGVyOltudWxsLG51bGxdLGNsaXA6ITEsY29sb3JCeVBvaW50OiEwLGRhdGFMYWJlbHM6e2Rpc3RhbmNlOjMwLGVuYWJsZWQ6ITAsZm9ybWF0dGVyOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMueT09PW51bGw/dm9pZCAwOnRoaXMucG9pbnQubmFtZX0seDowfSxpZ25vcmVIaWRkZW5Qb2ludDohMCxsZWdlbmRUeXBlOlwicG9pbnRcIixtYXJrZXI6bnVsbCxzaXplOm51bGwsc2hvd0luTGVnZW5kOiExLHNsaWNlZE9mZnNldDoxMCxzdGF0ZXM6e2hvdmVyOnticmlnaHRuZXNzOjAuMSxzaGFkb3c6ITF9fSxzdGlja3lUcmFja2luZzohMSx0b29sdGlwOntmb2xsb3dQb2ludGVyOiEwfX0pO2NhPXt0eXBlOlwicGllXCIsaXNDYXJ0ZXNpYW46ITEscG9pbnRDbGFzczpsYShIYSx7aW5pdDpmdW5jdGlvbigpe0hhLnByb3RvdHlwZS5pbml0LmFwcGx5KHRoaXMsXG5hcmd1bWVudHMpO3ZhciBhPXRoaXMsYjthLm5hbWU9cShhLm5hbWUsXCJTbGljZVwiKTtiPWZ1bmN0aW9uKGIpe2Euc2xpY2UoYi50eXBlPT09XCJzZWxlY3RcIil9O0QoYSxcInNlbGVjdFwiLGIpO0QoYSxcInVuc2VsZWN0XCIsYik7cmV0dXJuIGF9LHNldFZpc2libGU6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLGQ9Yy5zZXJpZXMsZT1kLmNoYXJ0LGY9ZC5vcHRpb25zLmlnbm9yZUhpZGRlblBvaW50LGI9cShiLGYpO2lmKGEhPT1jLnZpc2libGUpe2MudmlzaWJsZT1jLm9wdGlvbnMudmlzaWJsZT1hPWE9PT10PyFjLnZpc2libGU6YTtkLm9wdGlvbnMuZGF0YVtzYShjLGQuZGF0YSldPWMub3B0aW9ucztuKFtcImdyYXBoaWNcIixcImRhdGFMYWJlbFwiLFwiY29ubmVjdG9yXCIsXCJzaGFkb3dHcm91cFwiXSxmdW5jdGlvbihiKXtpZihjW2JdKWNbYl1bYT9cInNob3dcIjpcImhpZGVcIl0oITApfSk7Yy5sZWdlbmRJdGVtJiZlLmxlZ2VuZC5jb2xvcml6ZUl0ZW0oYyxhKTshYSYmYy5zdGF0ZT09PVwiaG92ZXJcIiYmXG5jLnNldFN0YXRlKFwiXCIpO2lmKGYpZC5pc0RpcnR5PSEwO2ImJmUucmVkcmF3KCl9fSxzbGljZTpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9dGhpcy5zZXJpZXM7YWIoYyxkLmNoYXJ0KTtxKGIsITApO3RoaXMuc2xpY2VkPXRoaXMub3B0aW9ucy5zbGljZWQ9YT1zKGEpP2E6IXRoaXMuc2xpY2VkO2Qub3B0aW9ucy5kYXRhW3NhKHRoaXMsZC5kYXRhKV09dGhpcy5vcHRpb25zO2E9YT90aGlzLnNsaWNlZFRyYW5zbGF0aW9uOnt0cmFuc2xhdGVYOjAsdHJhbnNsYXRlWTowfTt0aGlzLmdyYXBoaWMuYW5pbWF0ZShhKTt0aGlzLnNoYWRvd0dyb3VwJiZ0aGlzLnNoYWRvd0dyb3VwLmFuaW1hdGUoYSl9LGhhbG9QYXRoOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuc2hhcGVBcmdzLGM9dGhpcy5zZXJpZXMuY2hhcnQ7cmV0dXJuIHRoaXMuc2xpY2VkfHwhdGhpcy52aXNpYmxlP1tdOnRoaXMuc2VyaWVzLmNoYXJ0LnJlbmRlcmVyLnN5bWJvbHMuYXJjKGMucGxvdExlZnQrYi54LGMucGxvdFRvcCtiLnksXG5iLnIrYSxiLnIrYSx7aW5uZXJSOnRoaXMuc2hhcGVBcmdzLnIsc3RhcnQ6Yi5zdGFydCxlbmQ6Yi5lbmR9KX19KSxyZXF1aXJlU29ydGluZzohMSxkaXJlY3RUb3VjaDohMCxub1NoYXJlZFRvb2x0aXA6ITAsdHJhY2tlckdyb3VwczpbXCJncm91cFwiLFwiZGF0YUxhYmVsc0dyb3VwXCJdLGF4aXNUeXBlczpbXSxwb2ludEF0dHJUb09wdGlvbnM6e3N0cm9rZTpcImJvcmRlckNvbG9yXCIsXCJzdHJva2Utd2lkdGhcIjpcImJvcmRlcldpZHRoXCIsZmlsbDpcImNvbG9yXCJ9LGFuaW1hdGU6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcyxjPWIucG9pbnRzLGQ9Yi5zdGFydEFuZ2xlUmFkO2lmKCFhKW4oYyxmdW5jdGlvbihhKXt2YXIgYz1hLmdyYXBoaWMsZz1hLnNoYXBlQXJncztjJiYoYy5hdHRyKHtyOmEuc3RhcnRSfHxiLmNlbnRlclszXS8yLHN0YXJ0OmQsZW5kOmR9KSxjLmFuaW1hdGUoe3I6Zy5yLHN0YXJ0Omcuc3RhcnQsZW5kOmcuZW5kfSxiLm9wdGlvbnMuYW5pbWF0aW9uKSl9KSxiLmFuaW1hdGU9bnVsbH0sXG51cGRhdGVUb3RhbHM6ZnVuY3Rpb24oKXt2YXIgYSxiPTAsYz10aGlzLnBvaW50cyxkPWMubGVuZ3RoLGUsZj10aGlzLm9wdGlvbnMuaWdub3JlSGlkZGVuUG9pbnQ7Zm9yKGE9MDthPGQ7YSsrKWU9Y1thXSxiKz1mJiYhZS52aXNpYmxlPzA6ZS55O3RoaXMudG90YWw9Yjtmb3IoYT0wO2E8ZDthKyspZT1jW2FdLGUucGVyY2VudGFnZT1iPjAmJihlLnZpc2libGV8fCFmKT9lLnkvYioxMDA6MCxlLnRvdGFsPWJ9LGdlbmVyYXRlUG9pbnRzOmZ1bmN0aW9uKCl7US5wcm90b3R5cGUuZ2VuZXJhdGVQb2ludHMuY2FsbCh0aGlzKTt0aGlzLnVwZGF0ZVRvdGFscygpfSx0cmFuc2xhdGU6ZnVuY3Rpb24oYSl7dGhpcy5nZW5lcmF0ZVBvaW50cygpO3ZhciBiPTAsYz10aGlzLm9wdGlvbnMsZD1jLnNsaWNlZE9mZnNldCxlPWQrYy5ib3JkZXJXaWR0aCxmLGcsaCxpPWMuc3RhcnRBbmdsZXx8MCxqPXRoaXMuc3RhcnRBbmdsZVJhZD1CYS8xODAqKGktOTApLGk9KHRoaXMuZW5kQW5nbGVSYWQ9QmEvXG4xODAqKHEoYy5lbmRBbmdsZSxpKzM2MCktOTApKS1qLGs9dGhpcy5wb2ludHMsbD1jLmRhdGFMYWJlbHMuZGlzdGFuY2UsYz1jLmlnbm9yZUhpZGRlblBvaW50LG0sbz1rLmxlbmd0aCxwO2lmKCFhKXRoaXMuY2VudGVyPWE9dGhpcy5nZXRDZW50ZXIoKTt0aGlzLmdldFg9ZnVuY3Rpb24oYixjKXtoPVkuYXNpbihFKChiLWFbMV0pLyhhWzJdLzIrbCksMSkpO3JldHVybiBhWzBdKyhjPy0xOjEpKmJhKGgpKihhWzJdLzIrbCl9O2ZvcihtPTA7bTxvO20rKyl7cD1rW21dO2Y9aitiKmk7aWYoIWN8fHAudmlzaWJsZSliKz1wLnBlcmNlbnRhZ2UvMTAwO2c9aitiKmk7cC5zaGFwZVR5cGU9XCJhcmNcIjtwLnNoYXBlQXJncz17eDphWzBdLHk6YVsxXSxyOmFbMl0vMixpbm5lclI6YVszXS8yLHN0YXJ0OnkoZioxRTMpLzFFMyxlbmQ6eShnKjFFMykvMUUzfTtoPShnK2YpLzI7aD4xLjUqQmE/aC09MipCYTpoPC1CYS8yJiYoaCs9MipCYSk7cC5zbGljZWRUcmFuc2xhdGlvbj17dHJhbnNsYXRlWDp5KGJhKGgpKlxuZCksdHJhbnNsYXRlWTp5KGthKGgpKmQpfTtmPWJhKGgpKmFbMl0vMjtnPWthKGgpKmFbMl0vMjtwLnRvb2x0aXBQb3M9W2FbMF0rZiowLjcsYVsxXStnKjAuN107cC5oYWxmPWg8LUJhLzJ8fGg+QmEvMj8xOjA7cC5hbmdsZT1oO2U9RShlLGwvMik7cC5sYWJlbFBvcz1bYVswXStmK2JhKGgpKmwsYVsxXStnK2thKGgpKmwsYVswXStmK2JhKGgpKmUsYVsxXStnK2thKGgpKmUsYVswXStmLGFbMV0rZyxsPDA/XCJjZW50ZXJcIjpwLmhhbGY/XCJyaWdodFwiOlwibGVmdFwiLGhdfX0sZHJhd0dyYXBoOm51bGwsZHJhd1BvaW50czpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLmNoYXJ0LnJlbmRlcmVyLGMsZCxlPWEub3B0aW9ucy5zaGFkb3csZixnLGgsaTtpZihlJiYhYS5zaGFkb3dHcm91cClhLnNoYWRvd0dyb3VwPWIuZyhcInNoYWRvd1wiKS5hZGQoYS5ncm91cCk7bihhLnBvaW50cyxmdW5jdGlvbihqKXtpZihqLnkhPT1udWxsKXtkPWouZ3JhcGhpYztoPWouc2hhcGVBcmdzO2Y9ai5zaGFkb3dHcm91cDtcbmc9ai5wb2ludEF0dHJbai5zZWxlY3RlZD9cInNlbGVjdFwiOlwiXCJdO2lmKCFnLnN0cm9rZSlnLnN0cm9rZT1nLmZpbGw7aWYoZSYmIWYpZj1qLnNoYWRvd0dyb3VwPWIuZyhcInNoYWRvd1wiKS5hZGQoYS5zaGFkb3dHcm91cCk7Yz1qLnNsaWNlZD9qLnNsaWNlZFRyYW5zbGF0aW9uOnt0cmFuc2xhdGVYOjAsdHJhbnNsYXRlWTowfTtmJiZmLmF0dHIoYyk7aWYoZClkLnNldFJhZGlhbFJlZmVyZW5jZShhLmNlbnRlcikuYXR0cihnKS5hbmltYXRlKHgoaCxjKSk7ZWxzZXtpPXtcInN0cm9rZS1saW5lam9pblwiOlwicm91bmRcIn07aWYoIWoudmlzaWJsZSlpLnZpc2liaWxpdHk9XCJoaWRkZW5cIjtqLmdyYXBoaWM9ZD1iW2ouc2hhcGVUeXBlXShoKS5zZXRSYWRpYWxSZWZlcmVuY2UoYS5jZW50ZXIpLmF0dHIoZykuYXR0cihpKS5hdHRyKGMpLmFkZChhLmdyb3VwKS5zaGFkb3coZSxmKX19fSl9LHNlYXJjaFBvaW50OnJhLHNvcnRCeUFuZ2xlOmZ1bmN0aW9uKGEsYil7YS5zb3J0KGZ1bmN0aW9uKGEsZCl7cmV0dXJuIGEuYW5nbGUhPT1cbnZvaWQgMCYmKGQuYW5nbGUtYS5hbmdsZSkqYn0pfSxkcmF3TGVnZW5kU3ltYm9sOmFhLmRyYXdSZWN0YW5nbGUsZ2V0Q2VudGVyOmJjLmdldENlbnRlcixnZXRTeW1ib2w6cmF9O2NhPWxhKFEsY2EpO0sucGllPWNhO1EucHJvdG90eXBlLmRyYXdEYXRhTGFiZWxzPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEub3B0aW9ucyxjPWIuY3Vyc29yLGQ9Yi5kYXRhTGFiZWxzLGU9YS5wb2ludHMsZixnLGg9YS5oYXNSZW5kZXJlZHx8MCxpLGosaz1xKGQuZGVmZXIsITApLGw9YS5jaGFydC5yZW5kZXJlcjtpZihkLmVuYWJsZWR8fGEuX2hhc1BvaW50TGFiZWxzKWEuZGxQcm9jZXNzT3B0aW9ucyYmYS5kbFByb2Nlc3NPcHRpb25zKGQpLGo9YS5wbG90R3JvdXAoXCJkYXRhTGFiZWxzR3JvdXBcIixcImRhdGEtbGFiZWxzXCIsayYmIWg/XCJoaWRkZW5cIjpcInZpc2libGVcIixkLnpJbmRleHx8NiksayYmKGouYXR0cih7b3BhY2l0eToraH0pLGh8fEQoYSxcImFmdGVyQW5pbWF0ZVwiLGZ1bmN0aW9uKCl7YS52aXNpYmxlJiZcbmouc2hvdygpO2pbYi5hbmltYXRpb24/XCJhbmltYXRlXCI6XCJhdHRyXCJdKHtvcGFjaXR5OjF9LHtkdXJhdGlvbjoyMDB9KX0pKSxnPWQsbihlLGZ1bmN0aW9uKGUpe3ZhciBoLGs9ZS5kYXRhTGFiZWwscixuLFA9ZS5jb25uZWN0b3IsdT0hMCx3LHY9e307Zj1lLmRsT3B0aW9uc3x8ZS5vcHRpb25zJiZlLm9wdGlvbnMuZGF0YUxhYmVscztoPXEoZiYmZi5lbmFibGVkLGcuZW5hYmxlZCkmJmUueSE9PW51bGw7aWYoayYmIWgpZS5kYXRhTGFiZWw9ay5kZXN0cm95KCk7ZWxzZSBpZihoKXtkPUMoZyxmKTt3PWQuc3R5bGU7aD1kLnJvdGF0aW9uO3I9ZS5nZXRMYWJlbENvbmZpZygpO2k9ZC5mb3JtYXQ/TGEoZC5mb3JtYXQscik6ZC5mb3JtYXR0ZXIuY2FsbChyLGQpO3cuY29sb3I9cShkLmNvbG9yLHcuY29sb3IsYS5jb2xvcixcImJsYWNrXCIpO2lmKGspaWYocyhpKSlrLmF0dHIoe3RleHQ6aX0pLHU9ITE7ZWxzZXtpZihlLmRhdGFMYWJlbD1rPWsuZGVzdHJveSgpLFApZS5jb25uZWN0b3I9UC5kZXN0cm95KCl9ZWxzZSBpZihzKGkpKXtrPVxue2ZpbGw6ZC5iYWNrZ3JvdW5kQ29sb3Isc3Ryb2tlOmQuYm9yZGVyQ29sb3IsXCJzdHJva2Utd2lkdGhcIjpkLmJvcmRlcldpZHRoLHI6ZC5ib3JkZXJSYWRpdXN8fDAscm90YXRpb246aCxwYWRkaW5nOmQucGFkZGluZyx6SW5kZXg6MX07aWYody5jb2xvcj09PVwiY29udHJhc3RcIil2LmNvbG9yPWQuaW5zaWRlfHxkLmRpc3RhbmNlPDB8fGIuc3RhY2tpbmc/bC5nZXRDb250cmFzdChlLmNvbG9yfHxhLmNvbG9yKTpcIiMwMDAwMDBcIjtpZihjKXYuY3Vyc29yPWM7Zm9yKG4gaW4gaylrW25dPT09dCYmZGVsZXRlIGtbbl07az1lLmRhdGFMYWJlbD1sW2g/XCJ0ZXh0XCI6XCJsYWJlbFwiXShpLDAsLTk5OTksZC5zaGFwZSxudWxsLG51bGwsZC51c2VIVE1MKS5hdHRyKGspLmNzcyh4KHcsdikpLmFkZChqKS5zaGFkb3coZC5zaGFkb3cpfWsmJmEuYWxpZ25EYXRhTGFiZWwoZSxrLGQsbnVsbCx1KX19KX07US5wcm90b3R5cGUuYWxpZ25EYXRhTGFiZWw9ZnVuY3Rpb24oYSxiLGMsZCxlKXt2YXIgZj10aGlzLmNoYXJ0LFxuZz1mLmludmVydGVkLGg9cShhLnBsb3RYLC05OTk5KSxpPXEoYS5wbG90WSwtOTk5OSksaj1iLmdldEJCb3goKSxrPWYucmVuZGVyZXIuZm9udE1ldHJpY3MoYy5zdHlsZS5mb250U2l6ZSkuYixsPWMucm90YXRpb24sbT1jLmFsaWduLG89dGhpcy52aXNpYmxlJiYoYS5zZXJpZXMuZm9yY2VETHx8Zi5pc0luc2lkZVBsb3QoaCx5KGkpLGcpfHxkJiZmLmlzSW5zaWRlUGxvdChoLGc/ZC54KzE6ZC55K2QuaGVpZ2h0LTEsZykpLHA9cShjLm92ZXJmbG93LFwianVzdGlmeVwiKT09PVwianVzdGlmeVwiO2lmKG8pZD14KHt4Omc/Zi5wbG90V2lkdGgtaTpoLHk6eShnP2YucGxvdEhlaWdodC1oOmkpLHdpZHRoOjAsaGVpZ2h0OjB9LGQpLHgoYyx7d2lkdGg6ai53aWR0aCxoZWlnaHQ6ai5oZWlnaHR9KSxsPyhwPSExLGc9Zi5yZW5kZXJlci5yb3RDb3JyKGssbCksZz17eDpkLngrYy54K2Qud2lkdGgvMitnLngseTpkLnkrYy55K2QuaGVpZ2h0LzJ9LGJbZT9cImF0dHJcIjpcImFuaW1hdGVcIl0oZykuYXR0cih7YWxpZ246Yy5hbGlnbn0pLFxuaD0obCs3MjApJTM2MCxoPWg+MTgwJiZoPDM2MCxtPT09XCJsZWZ0XCI/Zy55LT1oP2ouaGVpZ2h0OjA6bT09PVwiY2VudGVyXCI/KGcueC09ai53aWR0aC8yLGcueS09ai5oZWlnaHQvMik6bT09PVwicmlnaHRcIiYmKGcueC09ai53aWR0aCxnLnktPWg/MDpqLmhlaWdodCkpOihiLmFsaWduKGMsbnVsbCxkKSxnPWIuYWxpZ25BdHRyKSxwP3RoaXMuanVzdGlmeURhdGFMYWJlbChiLGMsZyxqLGQsZSk6cShjLmNyb3AsITApJiYobz1mLmlzSW5zaWRlUGxvdChnLngsZy55KSYmZi5pc0luc2lkZVBsb3QoZy54K2oud2lkdGgsZy55K2ouaGVpZ2h0KSksYy5zaGFwZSYmIWwmJmIuYXR0cih7YW5jaG9yWDphLnBsb3RYLGFuY2hvclk6YS5wbG90WX0pO2lmKCFvKVRhKGIpLGIuYXR0cih7eTotOTk5OX0pLGIucGxhY2VkPSExfTtRLnByb3RvdHlwZS5qdXN0aWZ5RGF0YUxhYmVsPWZ1bmN0aW9uKGEsYixjLGQsZSxmKXt2YXIgZz10aGlzLmNoYXJ0LGg9Yi5hbGlnbixpPWIudmVydGljYWxBbGlnbixqLFxuayxsPWEuYm94PzA6YS5wYWRkaW5nfHwwO2o9Yy54K2w7aWYoajwwKWg9PT1cInJpZ2h0XCI/Yi5hbGlnbj1cImxlZnRcIjpiLng9LWosaz0hMDtqPWMueCtkLndpZHRoLWw7aWYoaj5nLnBsb3RXaWR0aCloPT09XCJsZWZ0XCI/Yi5hbGlnbj1cInJpZ2h0XCI6Yi54PWcucGxvdFdpZHRoLWosaz0hMDtqPWMueStsO2lmKGo8MClpPT09XCJib3R0b21cIj9iLnZlcnRpY2FsQWxpZ249XCJ0b3BcIjpiLnk9LWosaz0hMDtqPWMueStkLmhlaWdodC1sO2lmKGo+Zy5wbG90SGVpZ2h0KWk9PT1cInRvcFwiP2IudmVydGljYWxBbGlnbj1cImJvdHRvbVwiOmIueT1nLnBsb3RIZWlnaHQtaixrPSEwO2lmKGspYS5wbGFjZWQ9IWYsYS5hbGlnbihiLG51bGwsZSl9O2lmKEsucGllKUsucGllLnByb3RvdHlwZS5kcmF3RGF0YUxhYmVscz1mdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLmRhdGEsYyxkPWEuY2hhcnQsZT1hLm9wdGlvbnMuZGF0YUxhYmVscyxmPXEoZS5jb25uZWN0b3JQYWRkaW5nLDEwKSxnPXEoZS5jb25uZWN0b3JXaWR0aCxcbjEpLGg9ZC5wbG90V2lkdGgsaT1kLnBsb3RIZWlnaHQsaixrLGw9cShlLnNvZnRDb25uZWN0b3IsITApLG09ZS5kaXN0YW5jZSxvPWEuY2VudGVyLHA9b1syXS8yLHI9b1sxXSxBPW0+MCxzLHUsdyx0PVtbXSxbXV0seCx6LEMsQixMLEQ9WzAsMCwwLDBdLEo9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYi55LWEueX07aWYoYS52aXNpYmxlJiYoZS5lbmFibGVkfHxhLl9oYXNQb2ludExhYmVscykpe1EucHJvdG90eXBlLmRyYXdEYXRhTGFiZWxzLmFwcGx5KGEpO24oYixmdW5jdGlvbihhKXtpZihhLmRhdGFMYWJlbCYmYS52aXNpYmxlKXRbYS5oYWxmXS5wdXNoKGEpLGEuZGF0YUxhYmVsLl9wb3M9bnVsbH0pO2ZvcihCPTI7Qi0tOyl7dmFyIEc9W10sSz1bXSxJPXRbQl0sRj1JLmxlbmd0aCxIO2lmKEYpe2Euc29ydEJ5QW5nbGUoSSxCLTAuNSk7Zm9yKEw9Yj0wOyFiJiZJW0xdOyliPUlbTF0mJklbTF0uZGF0YUxhYmVsJiYoSVtMXS5kYXRhTGFiZWwuZ2V0QkJveCgpLmhlaWdodHx8MjEpLFxuTCsrO2lmKG0+MCl7dT1FKHIrcCttLGQucGxvdEhlaWdodCk7Zm9yKEw9digwLHItcC1tKTtMPD11O0wrPWIpRy5wdXNoKEwpO3U9Ry5sZW5ndGg7aWYoRj51KXtjPVtdLmNvbmNhdChJKTtjLnNvcnQoSik7Zm9yKEw9RjtMLS07KWNbTF0ucmFuaz1MO2ZvcihMPUY7TC0tOylJW0xdLnJhbms+PXUmJkkuc3BsaWNlKEwsMSk7Rj1JLmxlbmd0aH1mb3IoTD0wO0w8RjtMKyspe2M9SVtMXTt3PWMubGFiZWxQb3M7Yz05OTk5O3ZhciBNLE47Zm9yKE49MDtOPHU7TisrKU09UyhHW05dLXdbMV0pLE08YyYmKGM9TSxIPU4pO2lmKEg8TCYmR1tMXSE9PW51bGwpSD1MO2Vsc2UgZm9yKHU8Ri1MK0gmJkdbTF0hPT1udWxsJiYoSD11LUYrTCk7R1tIXT09PW51bGw7KUgrKztLLnB1c2goe2k6SCx5OkdbSF19KTtHW0hdPW51bGx9Sy5zb3J0KEopfWZvcihMPTA7TDxGO0wrKyl7Yz1JW0xdO3c9Yy5sYWJlbFBvcztzPWMuZGF0YUxhYmVsO0M9Yy52aXNpYmxlPT09ITE/XCJoaWRkZW5cIjpcImluaGVyaXRcIjtcbmM9d1sxXTtpZihtPjApe2lmKHU9Sy5wb3AoKSxIPXUuaSx6PXUueSxjPnomJkdbSCsxXSE9PW51bGx8fGM8eiYmR1tILTFdIT09bnVsbCl6PUUodigwLGMpLGQucGxvdEhlaWdodCl9ZWxzZSB6PWM7eD1lLmp1c3RpZnk/b1swXSsoQj8tMToxKSoocCttKTphLmdldFgoej09PXItcC1tfHx6PT09citwK20/Yzp6LEIpO3MuX2F0dHI9e3Zpc2liaWxpdHk6QyxhbGlnbjp3WzZdfTtzLl9wb3M9e3g6eCtlLngrKHtsZWZ0OmYscmlnaHQ6LWZ9W3dbNl1dfHwwKSx5OnorZS55LTEwfTtzLmNvbm5YPXg7cy5jb25uWT16O2lmKHRoaXMub3B0aW9ucy5zaXplPT09bnVsbCl1PXMud2lkdGgseC11PGY/RFszXT12KHkodS14K2YpLERbM10pOngrdT5oLWYmJihEWzFdPXYoeSh4K3UtaCtmKSxEWzFdKSksei1iLzI8MD9EWzBdPXYoeSgteitiLzIpLERbMF0pOnorYi8yPmkmJihEWzJdPXYoeSh6K2IvMi1pKSxEWzJdKSl9fX1pZihFYShEKT09PTB8fHRoaXMudmVyaWZ5RGF0YUxhYmVsT3ZlcmZsb3coRCkpdGhpcy5wbGFjZURhdGFMYWJlbHMoKSxcbkEmJmcmJm4odGhpcy5wb2ludHMsZnVuY3Rpb24oYil7aj1iLmNvbm5lY3Rvcjt3PWIubGFiZWxQb3M7aWYoKHM9Yi5kYXRhTGFiZWwpJiZzLl9wb3MmJmIudmlzaWJsZSlDPXMuX2F0dHIudmlzaWJpbGl0eSx4PXMuY29ublgsej1zLmNvbm5ZLGs9bD9bXCJNXCIseCsod1s2XT09PVwibGVmdFwiPzU6LTUpLHosXCJDXCIseCx6LDIqd1syXS13WzRdLDIqd1szXS13WzVdLHdbMl0sd1szXSxcIkxcIix3WzRdLHdbNV1dOltcIk1cIix4Kyh3WzZdPT09XCJsZWZ0XCI/NTotNSkseixcIkxcIix3WzJdLHdbM10sXCJMXCIsd1s0XSx3WzVdXSxqPyhqLmFuaW1hdGUoe2Q6a30pLGouYXR0cihcInZpc2liaWxpdHlcIixDKSk6Yi5jb25uZWN0b3I9aj1hLmNoYXJ0LnJlbmRlcmVyLnBhdGgoaykuYXR0cih7XCJzdHJva2Utd2lkdGhcIjpnLHN0cm9rZTplLmNvbm5lY3RvckNvbG9yfHxiLmNvbG9yfHxcIiM2MDYwNjBcIix2aXNpYmlsaXR5OkN9KS5hZGQoYS5kYXRhTGFiZWxzR3JvdXApO2Vsc2UgaWYoailiLmNvbm5lY3Rvcj1qLmRlc3Ryb3koKX0pfX0sXG5LLnBpZS5wcm90b3R5cGUucGxhY2VEYXRhTGFiZWxzPWZ1bmN0aW9uKCl7bih0aGlzLnBvaW50cyxmdW5jdGlvbihhKXt2YXIgYj1hLmRhdGFMYWJlbDtpZihiJiZhLnZpc2libGUpKGE9Yi5fcG9zKT8oYi5hdHRyKGIuX2F0dHIpLGJbYi5tb3ZlZD9cImFuaW1hdGVcIjpcImF0dHJcIl0oYSksYi5tb3ZlZD0hMCk6YiYmYi5hdHRyKHt5Oi05OTk5fSl9KX0sSy5waWUucHJvdG90eXBlLmFsaWduRGF0YUxhYmVsPXJhLEsucGllLnByb3RvdHlwZS52ZXJpZnlEYXRhTGFiZWxPdmVyZmxvdz1mdW5jdGlvbihhKXt2YXIgYj10aGlzLmNlbnRlcixjPXRoaXMub3B0aW9ucyxkPWMuY2VudGVyLGU9Yy5taW5TaXplfHw4MCxmPWUsZztkWzBdIT09bnVsbD9mPXYoYlsyXS12KGFbMV0sYVszXSksZSk6KGY9dihiWzJdLWFbMV0tYVszXSxlKSxiWzBdKz0oYVszXS1hWzFdKS8yKTtkWzFdIT09bnVsbD9mPXYoRShmLGJbMl0tdihhWzBdLGFbMl0pKSxlKTooZj12KEUoZixiWzJdLWFbMF0tYVsyXSksZSksXG5iWzFdKz0oYVswXS1hWzJdKS8yKTtmPGJbMl0/KGJbMl09ZixiWzNdPU1hdGgubWluKC8lJC8udGVzdChjLmlubmVyU2l6ZXx8MCk/ZipwYXJzZUZsb2F0KGMuaW5uZXJTaXplfHwwKS8xMDA6cGFyc2VGbG9hdChjLmlubmVyU2l6ZXx8MCksZiksdGhpcy50cmFuc2xhdGUoYiksdGhpcy5kcmF3RGF0YUxhYmVscyYmdGhpcy5kcmF3RGF0YUxhYmVscygpKTpnPSEwO3JldHVybiBnfTtpZihLLmNvbHVtbilLLmNvbHVtbi5wcm90b3R5cGUuYWxpZ25EYXRhTGFiZWw9ZnVuY3Rpb24oYSxiLGMsZCxlKXt2YXIgZj10aGlzLmNoYXJ0LmludmVydGVkLGc9YS5zZXJpZXMsaD1hLmRsQm94fHxhLnNoYXBlQXJncyxpPXEoYS5iZWxvdyxhLnBsb3RZPnEodGhpcy50cmFuc2xhdGVkVGhyZXNob2xkLGcueUF4aXMubGVuKSksaj1xKGMuaW5zaWRlLCEhdGhpcy5vcHRpb25zLnN0YWNraW5nKTtpZihoKXtkPUMoaCk7aWYoZC55PDApZC5oZWlnaHQrPWQueSxkLnk9MDtoPWQueStkLmhlaWdodC1nLnlBeGlzLmxlbjtcbmg+MCYmKGQuaGVpZ2h0LT1oKTtmJiYoZD17eDpnLnlBeGlzLmxlbi1kLnktZC5oZWlnaHQseTpnLnhBeGlzLmxlbi1kLngtZC53aWR0aCx3aWR0aDpkLmhlaWdodCxoZWlnaHQ6ZC53aWR0aH0pO2lmKCFqKWY/KGQueCs9aT8wOmQud2lkdGgsZC53aWR0aD0wKTooZC55Kz1pP2QuaGVpZ2h0OjAsZC5oZWlnaHQ9MCl9Yy5hbGlnbj1xKGMuYWxpZ24sIWZ8fGo/XCJjZW50ZXJcIjppP1wicmlnaHRcIjpcImxlZnRcIik7Yy52ZXJ0aWNhbEFsaWduPXEoYy52ZXJ0aWNhbEFsaWduLGZ8fGo/XCJtaWRkbGVcIjppP1widG9wXCI6XCJib3R0b21cIik7US5wcm90b3R5cGUuYWxpZ25EYXRhTGFiZWwuY2FsbCh0aGlzLGEsYixjLGQsZSl9OyhmdW5jdGlvbihhKXt2YXIgYj1hLkNoYXJ0LGM9YS5lYWNoLGQ9YS5waWNrLGU9YS5hZGRFdmVudDtiLnByb3RvdHlwZS5jYWxsYmFja3MucHVzaChmdW5jdGlvbihhKXtmdW5jdGlvbiBiKCl7dmFyIGU9W107YyhhLnNlcmllcyxmdW5jdGlvbihhKXt2YXIgYj1hLm9wdGlvbnMuZGF0YUxhYmVscyxcbmY9YS5kYXRhTGFiZWxDb2xsZWN0aW9uc3x8W1wiZGF0YUxhYmVsXCJdOyhiLmVuYWJsZWR8fGEuX2hhc1BvaW50TGFiZWxzKSYmIWIuYWxsb3dPdmVybGFwJiZhLnZpc2libGUmJmMoZixmdW5jdGlvbihiKXtjKGEucG9pbnRzLGZ1bmN0aW9uKGEpe2lmKGFbYl0pYVtiXS5sYWJlbHJhbms9ZChhLmxhYmVscmFuayxhLnNoYXBlQXJncyYmYS5zaGFwZUFyZ3MuaGVpZ2h0KSxlLnB1c2goYVtiXSl9KX0pfSk7YS5oaWRlT3ZlcmxhcHBpbmdMYWJlbHMoZSl9YigpO2UoYSxcInJlZHJhd1wiLGIpfSk7Yi5wcm90b3R5cGUuaGlkZU92ZXJsYXBwaW5nTGFiZWxzPWZ1bmN0aW9uKGEpe3ZhciBiPWEubGVuZ3RoLGQsZSxqLGssbCxtLG8scCxuO2ZvcihlPTA7ZTxiO2UrKylpZihkPWFbZV0pZC5vbGRPcGFjaXR5PWQub3BhY2l0eSxkLm5ld09wYWNpdHk9MTthLnNvcnQoZnVuY3Rpb24oYSxiKXtyZXR1cm4oYi5sYWJlbHJhbmt8fDApLShhLmxhYmVscmFua3x8MCl9KTtmb3IoZT0wO2U8YjtlKyspe2o9XG5hW2VdO2ZvcihkPWUrMTtkPGI7KytkKWlmKGs9YVtkXSxqJiZrJiZqLnBsYWNlZCYmay5wbGFjZWQmJmoubmV3T3BhY2l0eSE9PTAmJmsubmV3T3BhY2l0eSE9PTAmJihsPWouYWxpZ25BdHRyLG09ay5hbGlnbkF0dHIsbz1qLnBhcmVudEdyb3VwLHA9ay5wYXJlbnRHcm91cCxuPTIqKGouYm94PzA6ai5wYWRkaW5nKSxsPSEobS54K3AudHJhbnNsYXRlWD5sLngrby50cmFuc2xhdGVYKyhqLndpZHRoLW4pfHxtLngrcC50cmFuc2xhdGVYKyhrLndpZHRoLW4pPGwueCtvLnRyYW5zbGF0ZVh8fG0ueStwLnRyYW5zbGF0ZVk+bC55K28udHJhbnNsYXRlWSsoai5oZWlnaHQtbil8fG0ueStwLnRyYW5zbGF0ZVkrKGsuaGVpZ2h0LW4pPGwueStvLnRyYW5zbGF0ZVkpKSkoai5sYWJlbHJhbms8ay5sYWJlbHJhbms/ajprKS5uZXdPcGFjaXR5PTB9YyhhLGZ1bmN0aW9uKGEpe3ZhciBiLGM7aWYoYSl7Yz1hLm5ld09wYWNpdHk7aWYoYS5vbGRPcGFjaXR5IT09YyYmYS5wbGFjZWQpYz9hLnNob3coITApOlxuYj1mdW5jdGlvbigpe2EuaGlkZSgpfSxhLmFsaWduQXR0ci5vcGFjaXR5PWMsYVthLmlzT2xkP1wiYW5pbWF0ZVwiOlwiYXR0clwiXShhLmFsaWduQXR0cixudWxsLGIpO2EuaXNPbGQ9ITB9fSl9fSkoeik7dmFyIG5iPXouVHJhY2tlck1peGluPXtkcmF3VHJhY2tlclBvaW50OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEuY2hhcnQsYz1iLnBvaW50ZXIsZD1hLm9wdGlvbnMuY3Vyc29yLGU9ZCYme2N1cnNvcjpkfSxmPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYz1hLnRhcmdldCxkO2MmJiFkOylkPWMucG9pbnQsYz1jLnBhcmVudE5vZGU7aWYoZCE9PXQmJmQhPT1iLmhvdmVyUG9pbnQpZC5vbk1vdXNlT3ZlcihhKX07bihhLnBvaW50cyxmdW5jdGlvbihhKXtpZihhLmdyYXBoaWMpYS5ncmFwaGljLmVsZW1lbnQucG9pbnQ9YTtpZihhLmRhdGFMYWJlbClhLmRhdGFMYWJlbC5lbGVtZW50LnBvaW50PWF9KTtpZighYS5faGFzVHJhY2tpbmcpbihhLnRyYWNrZXJHcm91cHMsZnVuY3Rpb24oYil7aWYoYVtiXSYmXG4oYVtiXS5hZGRDbGFzcyhcImhpZ2hjaGFydHMtdHJhY2tlclwiKS5vbihcIm1vdXNlb3ZlclwiLGYpLm9uKFwibW91c2VvdXRcIixmdW5jdGlvbihhKXtjLm9uVHJhY2tlck1vdXNlT3V0KGEpfSkuY3NzKGUpLGRiKSlhW2JdLm9uKFwidG91Y2hzdGFydFwiLGYpfSksYS5faGFzVHJhY2tpbmc9ITB9LGRyYXdUcmFja2VyR3JhcGg6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5vcHRpb25zLGM9Yi50cmFja0J5QXJlYSxkPVtdLmNvbmNhdChjP2EuYXJlYVBhdGg6YS5ncmFwaFBhdGgpLGU9ZC5sZW5ndGgsZj1hLmNoYXJ0LGc9Zi5wb2ludGVyLGg9Zi5yZW5kZXJlcixpPWYub3B0aW9ucy50b29sdGlwLnNuYXAsaj1hLnRyYWNrZXIsaz1iLmN1cnNvcixsPWsmJntjdXJzb3I6a30sbT1mdW5jdGlvbigpe2lmKGYuaG92ZXJTZXJpZXMhPT1hKWEub25Nb3VzZU92ZXIoKX0sbz1cInJnYmEoMTkyLDE5MiwxOTIsXCIrKGphPzEuMEUtNDowLjAwMikrXCIpXCI7aWYoZSYmIWMpZm9yKGs9ZSsxO2stLTspZFtrXT09PVxuXCJNXCImJmQuc3BsaWNlKGsrMSwwLGRbaysxXS1pLGRbaysyXSxcIkxcIiksKGsmJmRba109PT1cIk1cInx8az09PWUpJiZkLnNwbGljZShrLDAsXCJMXCIsZFtrLTJdK2ksZFtrLTFdKTtqP2ouYXR0cih7ZDpkfSk6KGEudHJhY2tlcj1oLnBhdGgoZCkuYXR0cih7XCJzdHJva2UtbGluZWpvaW5cIjpcInJvdW5kXCIsdmlzaWJpbGl0eTphLnZpc2libGU/XCJ2aXNpYmxlXCI6XCJoaWRkZW5cIixzdHJva2U6byxmaWxsOmM/bzpcIm5vbmVcIixcInN0cm9rZS13aWR0aFwiOmIubGluZVdpZHRoKyhjPzA6MippKSx6SW5kZXg6Mn0pLmFkZChhLmdyb3VwKSxuKFthLnRyYWNrZXIsYS5tYXJrZXJHcm91cF0sZnVuY3Rpb24oYSl7YS5hZGRDbGFzcyhcImhpZ2hjaGFydHMtdHJhY2tlclwiKS5vbihcIm1vdXNlb3ZlclwiLG0pLm9uKFwibW91c2VvdXRcIixmdW5jdGlvbihhKXtnLm9uVHJhY2tlck1vdXNlT3V0KGEpfSkuY3NzKGwpO2lmKGRiKWEub24oXCJ0b3VjaHN0YXJ0XCIsbSl9KSl9fTtpZihLLmNvbHVtbilJYS5wcm90b3R5cGUuZHJhd1RyYWNrZXI9XG5uYi5kcmF3VHJhY2tlclBvaW50O2lmKEsucGllKUsucGllLnByb3RvdHlwZS5kcmF3VHJhY2tlcj1uYi5kcmF3VHJhY2tlclBvaW50O2lmKEsuc2NhdHRlcil6YS5wcm90b3R5cGUuZHJhd1RyYWNrZXI9bmIuZHJhd1RyYWNrZXJQb2ludDt4KHZiLnByb3RvdHlwZSx7c2V0SXRlbUV2ZW50czpmdW5jdGlvbihhLGIsYyxkLGUpe3ZhciBmPXRoaXM7KGM/YjphLmxlZ2VuZEdyb3VwKS5vbihcIm1vdXNlb3ZlclwiLGZ1bmN0aW9uKCl7YS5zZXRTdGF0ZShcImhvdmVyXCIpO2IuY3NzKGYub3B0aW9ucy5pdGVtSG92ZXJTdHlsZSl9KS5vbihcIm1vdXNlb3V0XCIsZnVuY3Rpb24oKXtiLmNzcyhhLnZpc2libGU/ZDplKTthLnNldFN0YXRlKCl9KS5vbihcImNsaWNrXCIsZnVuY3Rpb24oYil7dmFyIGM9ZnVuY3Rpb24oKXthLnNldFZpc2libGUmJmEuc2V0VmlzaWJsZSgpfSxiPXticm93c2VyRXZlbnQ6Yn07YS5maXJlUG9pbnRFdmVudD9hLmZpcmVQb2ludEV2ZW50KFwibGVnZW5kSXRlbUNsaWNrXCIsYixjKTpcbk0oYSxcImxlZ2VuZEl0ZW1DbGlja1wiLGIsYyl9KX0sY3JlYXRlQ2hlY2tib3hGb3JJdGVtOmZ1bmN0aW9uKGEpe2EuY2hlY2tib3g9ZWEoXCJpbnB1dFwiLHt0eXBlOlwiY2hlY2tib3hcIixjaGVja2VkOmEuc2VsZWN0ZWQsZGVmYXVsdENoZWNrZWQ6YS5zZWxlY3RlZH0sdGhpcy5vcHRpb25zLml0ZW1DaGVja2JveFN0eWxlLHRoaXMuY2hhcnQuY29udGFpbmVyKTtEKGEuY2hlY2tib3gsXCJjbGlja1wiLGZ1bmN0aW9uKGIpe00oYS5zZXJpZXN8fGEsXCJjaGVja2JveENsaWNrXCIse2NoZWNrZWQ6Yi50YXJnZXQuY2hlY2tlZCxpdGVtOmF9LGZ1bmN0aW9uKCl7YS5zZWxlY3QoKX0pfSl9fSk7Ti5sZWdlbmQuaXRlbVN0eWxlLmN1cnNvcj1cInBvaW50ZXJcIjt4KENhLnByb3RvdHlwZSx7c2hvd1Jlc2V0Wm9vbTpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1OLmxhbmcsYz1hLm9wdGlvbnMuY2hhcnQucmVzZXRab29tQnV0dG9uLGQ9Yy50aGVtZSxlPWQuc3RhdGVzLGY9Yy5yZWxhdGl2ZVRvPT09XCJjaGFydFwiP1xubnVsbDpcInBsb3RCb3hcIjt0aGlzLnJlc2V0Wm9vbUJ1dHRvbj1hLnJlbmRlcmVyLmJ1dHRvbihiLnJlc2V0Wm9vbSxudWxsLG51bGwsZnVuY3Rpb24oKXthLnpvb21PdXQoKX0sZCxlJiZlLmhvdmVyKS5hdHRyKHthbGlnbjpjLnBvc2l0aW9uLmFsaWduLHRpdGxlOmIucmVzZXRab29tVGl0bGV9KS5hZGQoKS5hbGlnbihjLnBvc2l0aW9uLCExLGYpfSx6b29tT3V0OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcztNKGEsXCJzZWxlY3Rpb25cIix7cmVzZXRTZWxlY3Rpb246ITB9LGZ1bmN0aW9uKCl7YS56b29tKCl9KX0sem9vbTpmdW5jdGlvbihhKXt2YXIgYixjPXRoaXMucG9pbnRlcixkPSExLGU7IWF8fGEucmVzZXRTZWxlY3Rpb24/bih0aGlzLmF4ZXMsZnVuY3Rpb24oYSl7Yj1hLnpvb20oKX0pOm4oYS54QXhpcy5jb25jYXQoYS55QXhpcyksZnVuY3Rpb24oYSl7dmFyIGU9YS5heGlzLGg9ZS5pc1hBeGlzO2lmKGNbaD9cInpvb21YXCI6XCJ6b29tWVwiXXx8Y1toP1wicGluY2hYXCI6XCJwaW5jaFlcIl0pYj1cbmUuem9vbShhLm1pbixhLm1heCksZS5kaXNwbGF5QnRuJiYoZD0hMCl9KTtlPXRoaXMucmVzZXRab29tQnV0dG9uO2lmKGQmJiFlKXRoaXMuc2hvd1Jlc2V0Wm9vbSgpO2Vsc2UgaWYoIWQmJmRhKGUpKXRoaXMucmVzZXRab29tQnV0dG9uPWUuZGVzdHJveSgpO2ImJnRoaXMucmVkcmF3KHEodGhpcy5vcHRpb25zLmNoYXJ0LmFuaW1hdGlvbixhJiZhLmFuaW1hdGlvbix0aGlzLnBvaW50Q291bnQ8MTAwKSl9LHBhbjpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMsZD1jLmhvdmVyUG9pbnRzLGU7ZCYmbihkLGZ1bmN0aW9uKGEpe2Euc2V0U3RhdGUoKX0pO24oYj09PVwieHlcIj9bMSwwXTpbMV0sZnVuY3Rpb24oYil7dmFyIGI9Y1tiP1wieEF4aXNcIjpcInlBeGlzXCJdWzBdLGQ9Yi5ob3JpeixoPWFbZD9cImNoYXJ0WFwiOlwiY2hhcnRZXCJdLGQ9ZD9cIm1vdXNlRG93blhcIjpcIm1vdXNlRG93bllcIixpPWNbZF0saj0oYi5wb2ludFJhbmdlfHwwKS8yLGs9Yi5nZXRFeHRyZW1lcygpLGw9Yi50b1ZhbHVlKGktXG5oLCEwKStqLGo9Yi50b1ZhbHVlKGkrYi5sZW4taCwhMCktaixpPWk+aDtpZihiLnNlcmllcy5sZW5ndGgmJihpfHxsPkUoay5kYXRhTWluLGsubWluKSkmJighaXx8ajx2KGsuZGF0YU1heCxrLm1heCkpKWIuc2V0RXh0cmVtZXMobCxqLCExLCExLHt0cmlnZ2VyOlwicGFuXCJ9KSxlPSEwO2NbZF09aH0pO2UmJmMucmVkcmF3KCExKTtGKGMuY29udGFpbmVyLHtjdXJzb3I6XCJtb3ZlXCJ9KX19KTt4KEhhLnByb3RvdHlwZSx7c2VsZWN0OmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcyxkPWMuc2VyaWVzLGU9ZC5jaGFydCxhPXEoYSwhYy5zZWxlY3RlZCk7Yy5maXJlUG9pbnRFdmVudChhP1wic2VsZWN0XCI6XCJ1bnNlbGVjdFwiLHthY2N1bXVsYXRlOmJ9LGZ1bmN0aW9uKCl7Yy5zZWxlY3RlZD1jLm9wdGlvbnMuc2VsZWN0ZWQ9YTtkLm9wdGlvbnMuZGF0YVtzYShjLGQuZGF0YSldPWMub3B0aW9ucztjLnNldFN0YXRlKGEmJlwic2VsZWN0XCIpO2J8fG4oZS5nZXRTZWxlY3RlZFBvaW50cygpLGZ1bmN0aW9uKGEpe2lmKGEuc2VsZWN0ZWQmJlxuYSE9PWMpYS5zZWxlY3RlZD1hLm9wdGlvbnMuc2VsZWN0ZWQ9ITEsZC5vcHRpb25zLmRhdGFbc2EoYSxkLmRhdGEpXT1hLm9wdGlvbnMsYS5zZXRTdGF0ZShcIlwiKSxhLmZpcmVQb2ludEV2ZW50KFwidW5zZWxlY3RcIil9KX0pfSxvbk1vdXNlT3ZlcjpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuc2VyaWVzLGQ9Yy5jaGFydCxlPWQudG9vbHRpcCxmPWQuaG92ZXJQb2ludDtpZihkLmhvdmVyU2VyaWVzIT09YyljLm9uTW91c2VPdmVyKCk7aWYoZiYmZiE9PXRoaXMpZi5vbk1vdXNlT3V0KCk7aWYodGhpcy5zZXJpZXMmJih0aGlzLmZpcmVQb2ludEV2ZW50KFwibW91c2VPdmVyXCIpLGUmJighZS5zaGFyZWR8fGMubm9TaGFyZWRUb29sdGlwKSYmZS5yZWZyZXNoKHRoaXMsYSksdGhpcy5zZXRTdGF0ZShcImhvdmVyXCIpLCFiKSlkLmhvdmVyUG9pbnQ9dGhpc30sb25Nb3VzZU91dDpmdW5jdGlvbigpe3ZhciBhPXRoaXMuc2VyaWVzLmNoYXJ0LGI9YS5ob3ZlclBvaW50czt0aGlzLmZpcmVQb2ludEV2ZW50KFwibW91c2VPdXRcIik7XG5pZighYnx8c2EodGhpcyxiKT09PS0xKXRoaXMuc2V0U3RhdGUoKSxhLmhvdmVyUG9pbnQ9bnVsbH0saW1wb3J0RXZlbnRzOmZ1bmN0aW9uKCl7aWYoIXRoaXMuaGFzSW1wb3J0ZWRFdmVudHMpe3ZhciBhPUModGhpcy5zZXJpZXMub3B0aW9ucy5wb2ludCx0aGlzLm9wdGlvbnMpLmV2ZW50cyxiO3RoaXMuZXZlbnRzPWE7Zm9yKGIgaW4gYSlEKHRoaXMsYixhW2JdKTt0aGlzLmhhc0ltcG9ydGVkRXZlbnRzPSEwfX0sc2V0U3RhdGU6ZnVuY3Rpb24oYSxiKXt2YXIgYz1WKHRoaXMucGxvdFgpLGQ9dGhpcy5wbG90WSxlPXRoaXMuc2VyaWVzLGY9ZS5vcHRpb25zLnN0YXRlcyxnPVdbZS50eXBlXS5tYXJrZXImJmUub3B0aW9ucy5tYXJrZXIsaD1nJiYhZy5lbmFibGVkLGk9ZyYmZy5zdGF0ZXNbYV0saj1pJiZpLmVuYWJsZWQ9PT0hMSxrPWUuc3RhdGVNYXJrZXJHcmFwaGljLGw9dGhpcy5tYXJrZXJ8fHt9LG09ZS5jaGFydCxvPWUuaGFsbyxwLGE9YXx8XCJcIjtwPXRoaXMucG9pbnRBdHRyW2FdfHxcbmUucG9pbnRBdHRyW2FdO2lmKCEoYT09PXRoaXMuc3RhdGUmJiFifHx0aGlzLnNlbGVjdGVkJiZhIT09XCJzZWxlY3RcInx8ZlthXSYmZlthXS5lbmFibGVkPT09ITF8fGEmJihqfHxoJiZpLmVuYWJsZWQ9PT0hMSl8fGEmJmwuc3RhdGVzJiZsLnN0YXRlc1thXSYmbC5zdGF0ZXNbYV0uZW5hYmxlZD09PSExKSl7aWYodGhpcy5ncmFwaGljKWc9ZyYmdGhpcy5ncmFwaGljLnN5bWJvbE5hbWUmJnAucix0aGlzLmdyYXBoaWMuYXR0cihDKHAsZz97eDpjLWcseTpkLWcsd2lkdGg6MipnLGhlaWdodDoyKmd9Ont9KSksayYmay5oaWRlKCk7ZWxzZXtpZihhJiZpKWlmKGc9aS5yYWRpdXMsbD1sLnN5bWJvbHx8ZS5zeW1ib2wsayYmay5jdXJyZW50U3ltYm9sIT09bCYmKGs9ay5kZXN0cm95KCkpLGspa1tiP1wiYW5pbWF0ZVwiOlwiYXR0clwiXSh7eDpjLWcseTpkLWd9KTtlbHNlIGlmKGwpZS5zdGF0ZU1hcmtlckdyYXBoaWM9az1tLnJlbmRlcmVyLnN5bWJvbChsLGMtZyxkLWcsMipnLDIqZykuYXR0cihwKS5hZGQoZS5tYXJrZXJHcm91cCksXG5rLmN1cnJlbnRTeW1ib2w9bDtpZihrKWtbYSYmbS5pc0luc2lkZVBsb3QoYyxkLG0uaW52ZXJ0ZWQpP1wic2hvd1wiOlwiaGlkZVwiXSgpLGsuZWxlbWVudC5wb2ludD10aGlzfWlmKChjPWZbYV0mJmZbYV0uaGFsbykmJmMuc2l6ZSl7aWYoIW8pZS5oYWxvPW89bS5yZW5kZXJlci5wYXRoKCkuYWRkKG0uc2VyaWVzR3JvdXApO28uYXR0cih4KHtmaWxsOnRoaXMuY29sb3J8fGUuY29sb3IsXCJmaWxsLW9wYWNpdHlcIjpjLm9wYWNpdHksekluZGV4Oi0xfSxjLmF0dHJpYnV0ZXMpKVtiP1wiYW5pbWF0ZVwiOlwiYXR0clwiXSh7ZDp0aGlzLmhhbG9QYXRoKGMuc2l6ZSl9KX1lbHNlIG8mJm8uYXR0cih7ZDpbXX0pO3RoaXMuc3RhdGU9YX19LGhhbG9QYXRoOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuc2VyaWVzLGM9Yi5jaGFydCxkPWIuZ2V0UGxvdEJveCgpLGU9Yy5pbnZlcnRlZCxmPU1hdGguZmxvb3IodGhpcy5wbG90WCk7cmV0dXJuIGMucmVuZGVyZXIuc3ltYm9scy5jaXJjbGUoZC50cmFuc2xhdGVYK1xuKGU/Yi55QXhpcy5sZW4tdGhpcy5wbG90WTpmKS1hLGQudHJhbnNsYXRlWSsoZT9iLnhBeGlzLmxlbi1mOnRoaXMucGxvdFkpLWEsYSoyLGEqMil9fSk7eChRLnByb3RvdHlwZSx7b25Nb3VzZU92ZXI6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmNoYXJ0LGI9YS5ob3ZlclNlcmllcztpZihiJiZiIT09dGhpcyliLm9uTW91c2VPdXQoKTt0aGlzLm9wdGlvbnMuZXZlbnRzLm1vdXNlT3ZlciYmTSh0aGlzLFwibW91c2VPdmVyXCIpO3RoaXMuc2V0U3RhdGUoXCJob3ZlclwiKTthLmhvdmVyU2VyaWVzPXRoaXN9LG9uTW91c2VPdXQ6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9wdGlvbnMsYj10aGlzLmNoYXJ0LGM9Yi50b29sdGlwLGQ9Yi5ob3ZlclBvaW50O2IuaG92ZXJTZXJpZXM9bnVsbDtpZihkKWQub25Nb3VzZU91dCgpO3RoaXMmJmEuZXZlbnRzLm1vdXNlT3V0JiZNKHRoaXMsXCJtb3VzZU91dFwiKTtjJiYhYS5zdGlja3lUcmFja2luZyYmKCFjLnNoYXJlZHx8dGhpcy5ub1NoYXJlZFRvb2x0aXApJiZcbmMuaGlkZSgpO3RoaXMuc2V0U3RhdGUoKX0sc2V0U3RhdGU6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5vcHRpb25zLGM9dGhpcy5ncmFwaCxkPWIuc3RhdGVzLGU9Yi5saW5lV2lkdGgsYj0wLGE9YXx8XCJcIjtpZih0aGlzLnN0YXRlIT09YSYmKHRoaXMuc3RhdGU9YSwhKGRbYV0mJmRbYV0uZW5hYmxlZD09PSExKSYmKGEmJihlPWRbYV0ubGluZVdpZHRofHxlKyhkW2FdLmxpbmVXaWR0aFBsdXN8fDApKSxjJiYhYy5kYXNoc3R5bGUpKSl7YT17XCJzdHJva2Utd2lkdGhcIjplfTtmb3IoYy5hdHRyKGEpO3RoaXNbXCJ6b25lR3JhcGhcIitiXTspdGhpc1tcInpvbmVHcmFwaFwiK2JdLmF0dHIoYSksYis9MX19LHNldFZpc2libGU6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLGQ9Yy5jaGFydCxlPWMubGVnZW5kSXRlbSxmLGc9ZC5vcHRpb25zLmNoYXJ0Lmlnbm9yZUhpZGRlblNlcmllcyxoPWMudmlzaWJsZTtmPShjLnZpc2libGU9YT1jLnVzZXJPcHRpb25zLnZpc2libGU9YT09PXQ/IWg6YSk/XCJzaG93XCI6XG5cImhpZGVcIjtuKFtcImdyb3VwXCIsXCJkYXRhTGFiZWxzR3JvdXBcIixcIm1hcmtlckdyb3VwXCIsXCJ0cmFja2VyXCJdLGZ1bmN0aW9uKGEpe2lmKGNbYV0pY1thXVtmXSgpfSk7aWYoZC5ob3ZlclNlcmllcz09PWN8fChkLmhvdmVyUG9pbnQmJmQuaG92ZXJQb2ludC5zZXJpZXMpPT09YyljLm9uTW91c2VPdXQoKTtlJiZkLmxlZ2VuZC5jb2xvcml6ZUl0ZW0oYyxhKTtjLmlzRGlydHk9ITA7Yy5vcHRpb25zLnN0YWNraW5nJiZuKGQuc2VyaWVzLGZ1bmN0aW9uKGEpe2lmKGEub3B0aW9ucy5zdGFja2luZyYmYS52aXNpYmxlKWEuaXNEaXJ0eT0hMH0pO24oYy5saW5rZWRTZXJpZXMsZnVuY3Rpb24oYil7Yi5zZXRWaXNpYmxlKGEsITEpfSk7aWYoZylkLmlzRGlydHlCb3g9ITA7YiE9PSExJiZkLnJlZHJhdygpO00oYyxmKX0sc2hvdzpmdW5jdGlvbigpe3RoaXMuc2V0VmlzaWJsZSghMCl9LGhpZGU6ZnVuY3Rpb24oKXt0aGlzLnNldFZpc2libGUoITEpfSxzZWxlY3Q6ZnVuY3Rpb24oYSl7dGhpcy5zZWxlY3RlZD1cbmE9YT09PXQ/IXRoaXMuc2VsZWN0ZWQ6YTtpZih0aGlzLmNoZWNrYm94KXRoaXMuY2hlY2tib3guY2hlY2tlZD1hO00odGhpcyxhP1wic2VsZWN0XCI6XCJ1bnNlbGVjdFwiKX0sZHJhd1RyYWNrZXI6bmIuZHJhd1RyYWNrZXJHcmFwaH0pO1UoUS5wcm90b3R5cGUsXCJpbml0XCIsZnVuY3Rpb24oYSl7dmFyIGI7YS5hcHBseSh0aGlzLEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSk7KGI9dGhpcy54QXhpcykmJmIub3B0aW9ucy5vcmRpbmFsJiZEKHRoaXMsXCJ1cGRhdGVkRGF0YVwiLGZ1bmN0aW9uKCl7ZGVsZXRlIGIub3JkaW5hbEluZGV4fSl9KTtVKEkucHJvdG90eXBlLFwiZ2V0VGltZVRpY2tzXCIsZnVuY3Rpb24oYSxiLGMsZCxlLGYsZyxoKXt2YXIgaT0wLGosayxsPXt9LG0sbyxwLG49W10scT0tTnVtYmVyLk1BWF9WQUxVRSx2PXRoaXMub3B0aW9ucy50aWNrUGl4ZWxJbnRlcnZhbDtpZighdGhpcy5vcHRpb25zLm9yZGluYWwmJiF0aGlzLm9wdGlvbnMuYnJlYWtzfHxcbiFmfHxmLmxlbmd0aDwzfHxjPT09dClyZXR1cm4gYS5jYWxsKHRoaXMsYixjLGQsZSk7bz1mLmxlbmd0aDtmb3Ioaj0wO2o8bztqKyspe3A9aiYmZltqLTFdPmQ7ZltqXTxjJiYoaT1qKTtpZihqPT09by0xfHxmW2orMV0tZltqXT5nKjV8fHApe2lmKGZbal0+cSl7Zm9yKGs9YS5jYWxsKHRoaXMsYixmW2ldLGZbal0sZSk7ay5sZW5ndGgmJmtbMF08PXE7KWsuc2hpZnQoKTtrLmxlbmd0aCYmKHE9a1trLmxlbmd0aC0xXSk7bj1uLmNvbmNhdChrKX1pPWorMX1pZihwKWJyZWFrfWE9ay5pbmZvO2lmKGgmJmEudW5pdFJhbmdlPD1ILmhvdXIpe2o9bi5sZW5ndGgtMTtmb3IoaT0xO2k8ajtpKyspbWEoXCIlZFwiLG5baV0pIT09bWEoXCIlZFwiLG5baS0xXSkmJihsW25baV1dPVwiZGF5XCIsbT0hMCk7bSYmKGxbblswXV09XCJkYXlcIik7YS5oaWdoZXJSYW5rcz1sfW4uaW5mbz1hO2lmKGgmJnModikpe2g9YT1uLmxlbmd0aDtqPVtdO3ZhciB1O2ZvcihtPVtdO2gtLTspaT10aGlzLnRyYW5zbGF0ZShuW2hdKSxcbnUmJihtW2hdPXUtaSksaltoXT11PWk7bS5zb3J0KCk7bT1tW1YobS5sZW5ndGgvMildO208diowLjYmJihtPW51bGwpO2g9blthLTFdPmQ/YS0xOmE7Zm9yKHU9dm9pZCAwO2gtLTspaT1qW2hdLGQ9dS1pLHUmJmQ8diowLjgmJihtPT09bnVsbHx8ZDxtKjAuOCk/KGxbbltoXV0mJiFsW25baCsxXV0/KGQ9aCsxLHU9aSk6ZD1oLG4uc3BsaWNlKGQsMSkpOnU9aX1yZXR1cm4gbn0pO3goSS5wcm90b3R5cGUse2JlZm9yZVNldFRpY2tQb3NpdGlvbnM6ZnVuY3Rpb24oKXt2YXIgYSxiPVtdLGM9ITEsZCxlPXRoaXMuZ2V0RXh0cmVtZXMoKSxmPWUubWluLGc9ZS5tYXgsaCxpPXRoaXMuaXNYQXhpcyYmISF0aGlzLm9wdGlvbnMuYnJlYWtzO2lmKChlPXRoaXMub3B0aW9ucy5vcmRpbmFsKXx8aSl7bih0aGlzLnNlcmllcyxmdW5jdGlvbihjLGQpe2lmKGMudmlzaWJsZSE9PSExJiYoYy50YWtlT3JkaW5hbFBvc2l0aW9uIT09ITF8fGkpKWlmKGI9Yi5jb25jYXQoYy5wcm9jZXNzZWRYRGF0YSksXG5hPWIubGVuZ3RoLGIuc29ydChmdW5jdGlvbihhLGIpe3JldHVybiBhLWJ9KSxhKWZvcihkPWEtMTtkLS07KWJbZF09PT1iW2QrMV0mJmIuc3BsaWNlKGQsMSl9KTthPWIubGVuZ3RoO2lmKGE+Mil7ZD1iWzFdLWJbMF07Zm9yKGg9YS0xO2gtLSYmIWM7KWJbaCsxXS1iW2hdIT09ZCYmKGM9ITApO2lmKCF0aGlzLm9wdGlvbnMua2VlcE9yZGluYWxQYWRkaW5nJiYoYlswXS1mPmR8fGctYltiLmxlbmd0aC0xXT5kKSljPSEwfWM/KHRoaXMub3JkaW5hbFBvc2l0aW9ucz1iLGQ9dGhpcy52YWwybGluKHYoZixiWzBdKSwhMCksaD12KHRoaXMudmFsMmxpbihFKGcsYltiLmxlbmd0aC0xXSksITApLDEpLHRoaXMub3JkaW5hbFNsb3BlPWc9KGctZikvKGgtZCksdGhpcy5vcmRpbmFsT2Zmc2V0PWYtZCpnKTp0aGlzLm9yZGluYWxQb3NpdGlvbnM9dGhpcy5vcmRpbmFsU2xvcGU9dGhpcy5vcmRpbmFsT2Zmc2V0PXR9dGhpcy5pc09yZGluYWw9ZSYmYzt0aGlzLmdyb3VwSW50ZXJ2YWxGYWN0b3I9XG5udWxsfSx2YWwybGluOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5vcmRpbmFsUG9zaXRpb25zLGQ7aWYoYyl7dmFyIGU9Yy5sZW5ndGgsZjtmb3IoZD1lO2QtLTspaWYoY1tkXT09PWEpe2Y9ZDticmVha31mb3IoZD1lLTE7ZC0tOylpZihhPmNbZF18fGQ9PT0wKXtjPShhLWNbZF0pLyhjW2QrMV0tY1tkXSk7Zj1kK2M7YnJlYWt9ZD1iP2Y6dGhpcy5vcmRpbmFsU2xvcGUqKGZ8fDApK3RoaXMub3JkaW5hbE9mZnNldH1lbHNlIGQ9YTtyZXR1cm4gZH0sbGluMnZhbDpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMub3JkaW5hbFBvc2l0aW9ucztpZihjKXt2YXIgZD10aGlzLm9yZGluYWxTbG9wZSxlPXRoaXMub3JkaW5hbE9mZnNldCxmPWMubGVuZ3RoLTEsZyxoO2lmKGIpYTwwP2E9Y1swXTphPmY/YT1jW2ZdOihmPVYoYSksaD1hLWYpO2Vsc2UgZm9yKDtmLS07KWlmKGc9ZCpmK2UsYT49Zyl7ZD1kKihmKzEpK2U7aD0oYS1nKS8oZC1nKTticmVha31jPWghPT10JiZjW2ZdIT09dD9jW2ZdK1xuKGg/aCooY1tmKzFdLWNbZl0pOjApOmF9ZWxzZSBjPWE7cmV0dXJuIGN9LGdldEV4dGVuZGVkUG9zaXRpb25zOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5jaGFydCxiPXRoaXMuc2VyaWVzWzBdLmN1cnJlbnREYXRhR3JvdXBpbmcsYz10aGlzLm9yZGluYWxJbmRleCxkPWI/Yi5jb3VudCtiLnVuaXROYW1lOlwicmF3XCIsZT10aGlzLmdldEV4dHJlbWVzKCksZixnO2lmKCFjKWM9dGhpcy5vcmRpbmFsSW5kZXg9e307aWYoIWNbZF0pZj17c2VyaWVzOltdLGdldEV4dHJlbWVzOmZ1bmN0aW9uKCl7cmV0dXJue21pbjplLmRhdGFNaW4sbWF4OmUuZGF0YU1heH19LG9wdGlvbnM6e29yZGluYWw6ITB9LHZhbDJsaW46SS5wcm90b3R5cGUudmFsMmxpbn0sbih0aGlzLnNlcmllcyxmdW5jdGlvbihjKXtnPXt4QXhpczpmLHhEYXRhOmMueERhdGEsY2hhcnQ6YSxkZXN0cm95R3JvdXBlZERhdGE6cmF9O2cub3B0aW9ucz17ZGF0YUdyb3VwaW5nOmI/e2VuYWJsZWQ6ITAsZm9yY2VkOiEwLGFwcHJveGltYXRpb246XCJvcGVuXCIsXG51bml0czpbW2IudW5pdE5hbWUsW2IuY291bnRdXV19OntlbmFibGVkOiExfX07Yy5wcm9jZXNzRGF0YS5hcHBseShnKTtmLnNlcmllcy5wdXNoKGcpfSksdGhpcy5iZWZvcmVTZXRUaWNrUG9zaXRpb25zLmFwcGx5KGYpLGNbZF09Zi5vcmRpbmFsUG9zaXRpb25zO3JldHVybiBjW2RdfSxnZXRHcm91cEludGVydmFsRmFjdG9yOmZ1bmN0aW9uKGEsYixjKXt2YXIgZCxjPWMucHJvY2Vzc2VkWERhdGEsZT1jLmxlbmd0aCxmPVtdO2Q9dGhpcy5ncm91cEludGVydmFsRmFjdG9yO2lmKCFkKXtmb3IoZD0wO2Q8ZS0xO2QrKylmW2RdPWNbZCsxXS1jW2RdO2Yuc29ydChmdW5jdGlvbihhLGIpe3JldHVybiBhLWJ9KTtmPWZbVihlLzIpXTthPXYoYSxjWzBdKTtiPUUoYixjW2UtMV0pO3RoaXMuZ3JvdXBJbnRlcnZhbEZhY3Rvcj1kPWUqZi8oYi1hKX1yZXR1cm4gZH0scG9zdFByb2Nlc3NUaWNrSW50ZXJ2YWw6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5vcmRpbmFsU2xvcGU7cmV0dXJuIGI/dGhpcy5vcHRpb25zLmJyZWFrcz9cbnRoaXMuY2xvc2VzdFBvaW50UmFuZ2U6YS8oYi90aGlzLmNsb3Nlc3RQb2ludFJhbmdlKTphfX0pO1UoQ2EucHJvdG90eXBlLFwicGFuXCIsZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLnhBeGlzWzBdLGQ9Yi5jaGFydFgsZT0hMTtpZihjLm9wdGlvbnMub3JkaW5hbCYmYy5zZXJpZXMubGVuZ3RoKXt2YXIgZj10aGlzLm1vdXNlRG93blgsZz1jLmdldEV4dHJlbWVzKCksaD1nLmRhdGFNYXgsaT1nLm1pbixqPWcubWF4LGs9dGhpcy5ob3ZlclBvaW50cyxsPWMuY2xvc2VzdFBvaW50UmFuZ2UsZj0oZi1kKS8oYy50cmFuc2xhdGlvblNsb3BlKihjLm9yZGluYWxTbG9wZXx8bCkpLG09e29yZGluYWxQb3NpdGlvbnM6Yy5nZXRFeHRlbmRlZFBvc2l0aW9ucygpfSxsPWMubGluMnZhbCxvPWMudmFsMmxpbixwO2lmKG0ub3JkaW5hbFBvc2l0aW9ucyl7aWYoUyhmKT4xKWsmJm4oayxmdW5jdGlvbihhKXthLnNldFN0YXRlKCl9KSxmPDA/KGs9bSxwPWMub3JkaW5hbFBvc2l0aW9ucz9jOm0pOihrPVxuYy5vcmRpbmFsUG9zaXRpb25zP2M6bSxwPW0pLG09cC5vcmRpbmFsUG9zaXRpb25zLGg+bVttLmxlbmd0aC0xXSYmbS5wdXNoKGgpLHRoaXMuZml4ZWRSYW5nZT1qLWksZj1jLnRvRml4ZWRSYW5nZShudWxsLG51bGwsbC5hcHBseShrLFtvLmFwcGx5KGssW2ksITBdKStmLCEwXSksbC5hcHBseShwLFtvLmFwcGx5KHAsW2osITBdKStmLCEwXSkpLGYubWluPj1FKGcuZGF0YU1pbixpKSYmZi5tYXg8PXYoaCxqKSYmYy5zZXRFeHRyZW1lcyhmLm1pbixmLm1heCwhMCwhMSx7dHJpZ2dlcjpcInBhblwifSksdGhpcy5tb3VzZURvd25YPWQsRih0aGlzLmNvbnRhaW5lcix7Y3Vyc29yOlwibW92ZVwifSl9ZWxzZSBlPSEwfWVsc2UgZT0hMDtlJiZhLmFwcGx5KHRoaXMsQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpKX0pO1EucHJvdG90eXBlLmdhcHBlZFBhdGg9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9wdGlvbnMuZ2FwU2l6ZSxiPXRoaXMucG9pbnRzLnNsaWNlKCksYz1iLmxlbmd0aC1cbjE7aWYoYSYmYz4wKWZvcig7Yy0tOyliW2MrMV0ueC1iW2NdLng+dGhpcy5jbG9zZXN0UG9pbnRSYW5nZSphJiZiLnNwbGljZShjKzEsMCx7aXNOdWxsOiEwfSk7cmV0dXJuIHRoaXMuZ2V0R3JhcGhQYXRoKGIpfTsoZnVuY3Rpb24oYSl7YSh6KX0pKGZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoKXtyZXR1cm4gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpfWZ1bmN0aW9uIGMoYSl7YS5hcHBseSh0aGlzKTt0aGlzLmRyYXdCcmVha3ModGhpcy54QXhpcyxbXCJ4XCJdKTt0aGlzLmRyYXdCcmVha3ModGhpcy55QXhpcyxkKHRoaXMucG9pbnRBcnJheU1hcCxbXCJ5XCJdKSl9dmFyIGQ9YS5waWNrLGU9YS53cmFwLGY9YS5lYWNoLGc9YS5leHRlbmQsaD1hLmZpcmVFdmVudCxpPWEuQXhpcyxqPWEuU2VyaWVzO2coaS5wcm90b3R5cGUse2lzSW5CcmVhazpmdW5jdGlvbihhLGIpe3ZhciBjPWEucmVwZWF0fHxJbmZpbml0eSxkPWEuZnJvbSxlPWEudG8tYS5mcm9tLGM9Yj49ZD9cbihiLWQpJWM6Yy0oZC1iKSVjO3JldHVybiBhLmluY2x1c2l2ZT9jPD1lOmM8ZSYmYyE9PTB9LGlzSW5BbnlCcmVhazpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMub3B0aW9ucy5icmVha3MsZT1jJiZjLmxlbmd0aCxmLGcsaDtpZihlKXtmb3IoO2UtLTspdGhpcy5pc0luQnJlYWsoY1tlXSxhKSYmKGY9ITAsZ3x8KGc9ZChjW2VdLnNob3dQb2ludHMsdGhpcy5pc1hBeGlzPyExOiEwKSkpO2g9ZiYmYj9mJiYhZzpmfXJldHVybiBofX0pO2UoaS5wcm90b3R5cGUsXCJzZXRUaWNrUG9zaXRpb25zXCIsZnVuY3Rpb24oYSl7YS5hcHBseSh0aGlzLEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSk7aWYodGhpcy5vcHRpb25zLmJyZWFrcyl7dmFyIGI9dGhpcy50aWNrUG9zaXRpb25zLGM9dGhpcy50aWNrUG9zaXRpb25zLmluZm8sZD1bXSxlO2ZvcihlPTA7ZTxiLmxlbmd0aDtlKyspdGhpcy5pc0luQW55QnJlYWsoYltlXSl8fGQucHVzaChiW2VdKTt0aGlzLnRpY2tQb3NpdGlvbnM9XG5kO3RoaXMudGlja1Bvc2l0aW9ucy5pbmZvPWN9fSk7ZShpLnByb3RvdHlwZSxcImluaXRcIixmdW5jdGlvbihhLGIsYyl7aWYoYy5icmVha3MmJmMuYnJlYWtzLmxlbmd0aCljLm9yZGluYWw9ITE7YS5jYWxsKHRoaXMsYixjKTtpZih0aGlzLm9wdGlvbnMuYnJlYWtzKXt2YXIgZD10aGlzO2QuaXNCcm9rZW49ITA7dGhpcy52YWwybGluPWZ1bmN0aW9uKGEpe3ZhciBiPWEsYyxlO2ZvcihlPTA7ZTxkLmJyZWFrQXJyYXkubGVuZ3RoO2UrKylpZihjPWQuYnJlYWtBcnJheVtlXSxjLnRvPD1hKWItPWMubGVuO2Vsc2UgaWYoYy5mcm9tPj1hKWJyZWFrO2Vsc2UgaWYoZC5pc0luQnJlYWsoYyxhKSl7Yi09YS1jLmZyb207YnJlYWt9cmV0dXJuIGJ9O3RoaXMubGluMnZhbD1mdW5jdGlvbihhKXt2YXIgYixjO2ZvcihjPTA7YzxkLmJyZWFrQXJyYXkubGVuZ3RoO2MrKylpZihiPWQuYnJlYWtBcnJheVtjXSxiLmZyb20+PWEpYnJlYWs7ZWxzZSBiLnRvPGE/YSs9Yi5sZW46ZC5pc0luQnJlYWsoYixcbmEpJiYoYSs9Yi5sZW4pO3JldHVybiBhfTt0aGlzLnNldEV4dHJlbWVzPWZ1bmN0aW9uKGEsYixjLGQsZSl7Zm9yKDt0aGlzLmlzSW5BbnlCcmVhayhhKTspYS09dGhpcy5jbG9zZXN0UG9pbnRSYW5nZTtmb3IoO3RoaXMuaXNJbkFueUJyZWFrKGIpOyliLT10aGlzLmNsb3Nlc3RQb2ludFJhbmdlO2kucHJvdG90eXBlLnNldEV4dHJlbWVzLmNhbGwodGhpcyxhLGIsYyxkLGUpfTt0aGlzLnNldEF4aXNUcmFuc2xhdGlvbj1mdW5jdGlvbihhKXtpLnByb3RvdHlwZS5zZXRBeGlzVHJhbnNsYXRpb24uY2FsbCh0aGlzLGEpO3ZhciBiPWQub3B0aW9ucy5icmVha3MsYT1bXSxjPVtdLGU9MCxmLGcsaz1kLnVzZXJNaW58fGQubWluLGo9ZC51c2VyTWF4fHxkLm1heCxsLG07Zm9yKG0gaW4gYilnPWJbbV0sZj1nLnJlcGVhdHx8SW5maW5pdHksZC5pc0luQnJlYWsoZyxrKSYmKGsrPWcudG8lZi1rJWYpLGQuaXNJbkJyZWFrKGcsaikmJihqLT1qJWYtZy5mcm9tJWYpO2ZvcihtIGluIGIpe2c9YlttXTtcbmw9Zy5mcm9tO2ZvcihmPWcucmVwZWF0fHxJbmZpbml0eTtsLWY+azspbC09Zjtmb3IoO2w8azspbCs9Zjtmb3IoO2w8ajtsKz1mKWEucHVzaCh7dmFsdWU6bCxtb3ZlOlwiaW5cIn0pLGEucHVzaCh7dmFsdWU6bCsoZy50by1nLmZyb20pLG1vdmU6XCJvdXRcIixzaXplOmcuYnJlYWtTaXplfSl9YS5zb3J0KGZ1bmN0aW9uKGEsYil7cmV0dXJuIGEudmFsdWU9PT1iLnZhbHVlPyhhLm1vdmU9PT1cImluXCI/MDoxKS0oYi5tb3ZlPT09XCJpblwiPzA6MSk6YS52YWx1ZS1iLnZhbHVlfSk7Yj0wO2w9aztmb3IobSBpbiBhKXtnPWFbbV07Yis9Zy5tb3ZlPT09XCJpblwiPzE6LTE7aWYoYj09PTEmJmcubW92ZT09PVwiaW5cIilsPWcudmFsdWU7Yj09PTAmJihjLnB1c2goe2Zyb206bCx0bzpnLnZhbHVlLGxlbjpnLnZhbHVlLWwtKGcuc2l6ZXx8MCl9KSxlKz1nLnZhbHVlLWwtKGcuc2l6ZXx8MCkpfWQuYnJlYWtBcnJheT1jO2goZCxcImFmdGVyQnJlYWtzXCIpO2QudHJhbnNBKj0oai1kLm1pbikvKGotay1lKTtkLm1pbj1cbms7ZC5tYXg9an19fSk7ZShqLnByb3RvdHlwZSxcImdlbmVyYXRlUG9pbnRzXCIsZnVuY3Rpb24oYSl7YS5hcHBseSh0aGlzLGIoYXJndW1lbnRzKSk7dmFyIGM9dGhpcy54QXhpcyxkPXRoaXMueUF4aXMsZT10aGlzLnBvaW50cyxmLGc9ZS5sZW5ndGgsaD10aGlzLm9wdGlvbnMuY29ubmVjdE51bGxzLGk7aWYoYyYmZCYmKGMub3B0aW9ucy5icmVha3N8fGQub3B0aW9ucy5icmVha3MpKWZvcig7Zy0tOylpZihmPWVbZ10saT1mLnk9PT1udWxsJiZoPT09ITEsIWkmJihjLmlzSW5BbnlCcmVhayhmLngsITApfHxkLmlzSW5BbnlCcmVhayhmLnksITApKSllLnNwbGljZShnLDEpLHRoaXMuZGF0YVtnXSYmdGhpcy5kYXRhW2ddLmRlc3Ryb3lFbGVtZW50cygpfSk7YS5TZXJpZXMucHJvdG90eXBlLmRyYXdCcmVha3M9ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLGU9Yy5wb2ludHMsZyxpLGosbjtmKGIsZnVuY3Rpb24oYil7Zz1hLmJyZWFrQXJyYXl8fFtdO2k9YS5pc1hBeGlzP2EubWluOmQoYy5vcHRpb25zLnRocmVzaG9sZCxcbmEubWluKTtmKGUsZnVuY3Rpb24oYyl7bj1kKGNbXCJzdGFja1wiK2IudG9VcHBlckNhc2UoKV0sY1tiXSk7ZihnLGZ1bmN0aW9uKGIpe2o9ITE7aWYoaTxiLmZyb20mJm4+Yi50b3x8aT5iLmZyb20mJm48Yi5mcm9tKWo9XCJwb2ludEJyZWFrXCI7ZWxzZSBpZihpPGIuZnJvbSYmbj5iLmZyb20mJm48Yi50b3x8aT5iLmZyb20mJm4+Yi50byYmbjxiLmZyb20paj1cInBvaW50SW5CcmVha1wiO2omJmgoYSxqLHtwb2ludDpjLGJyazpifSl9KX0pfSl9O2UoYS5zZXJpZXNUeXBlcy5jb2x1bW4ucHJvdG90eXBlLFwiZHJhd1BvaW50c1wiLGMpO2UoYS5TZXJpZXMucHJvdG90eXBlLFwiZHJhd1BvaW50c1wiLGMpfSk7dmFyIGlhPVEucHJvdG90eXBlLGNjPWlhLnByb2Nlc3NEYXRhLGRjPWlhLmdlbmVyYXRlUG9pbnRzLGVjPWlhLmRlc3Ryb3ksZmM9e2FwcHJveGltYXRpb246XCJhdmVyYWdlXCIsZ3JvdXBQaXhlbFdpZHRoOjIsZGF0ZVRpbWVMYWJlbEZvcm1hdHM6e21pbGxpc2Vjb25kOltcIiVBLCAlYiAlZSwgJUg6JU06JVMuJUxcIixcblwiJUEsICViICVlLCAlSDolTTolUy4lTFwiLFwiLSVIOiVNOiVTLiVMXCJdLHNlY29uZDpbXCIlQSwgJWIgJWUsICVIOiVNOiVTXCIsXCIlQSwgJWIgJWUsICVIOiVNOiVTXCIsXCItJUg6JU06JVNcIl0sbWludXRlOltcIiVBLCAlYiAlZSwgJUg6JU1cIixcIiVBLCAlYiAlZSwgJUg6JU1cIixcIi0lSDolTVwiXSxob3VyOltcIiVBLCAlYiAlZSwgJUg6JU1cIixcIiVBLCAlYiAlZSwgJUg6JU1cIixcIi0lSDolTVwiXSxkYXk6W1wiJUEsICViICVlLCAlWVwiLFwiJUEsICViICVlXCIsXCItJUEsICViICVlLCAlWVwiXSx3ZWVrOltcIldlZWsgZnJvbSAlQSwgJWIgJWUsICVZXCIsXCIlQSwgJWIgJWVcIixcIi0lQSwgJWIgJWUsICVZXCJdLG1vbnRoOltcIiVCICVZXCIsXCIlQlwiLFwiLSVCICVZXCJdLHllYXI6W1wiJVlcIixcIiVZXCIsXCItJVlcIl19fSxYYj17bGluZTp7fSxzcGxpbmU6e30sYXJlYTp7fSxhcmVhc3BsaW5lOnt9LGNvbHVtbjp7YXBwcm94aW1hdGlvbjpcInN1bVwiLGdyb3VwUGl4ZWxXaWR0aDoxMH0sYXJlYXJhbmdlOnthcHByb3hpbWF0aW9uOlwicmFuZ2VcIn0sXG5hcmVhc3BsaW5lcmFuZ2U6e2FwcHJveGltYXRpb246XCJyYW5nZVwifSxjb2x1bW5yYW5nZTp7YXBwcm94aW1hdGlvbjpcInJhbmdlXCIsZ3JvdXBQaXhlbFdpZHRoOjEwfSxjYW5kbGVzdGljazp7YXBwcm94aW1hdGlvbjpcIm9obGNcIixncm91cFBpeGVsV2lkdGg6MTB9LG9obGM6e2FwcHJveGltYXRpb246XCJvaGxjXCIsZ3JvdXBQaXhlbFdpZHRoOjV9fSxZYj1bW1wibWlsbGlzZWNvbmRcIixbMSwyLDUsMTAsMjAsMjUsNTAsMTAwLDIwMCw1MDBdXSxbXCJzZWNvbmRcIixbMSwyLDUsMTAsMTUsMzBdXSxbXCJtaW51dGVcIixbMSwyLDUsMTAsMTUsMzBdXSxbXCJob3VyXCIsWzEsMiwzLDQsNiw4LDEyXV0sW1wiZGF5XCIsWzFdXSxbXCJ3ZWVrXCIsWzFdXSxbXCJtb250aFwiLFsxLDMsNl1dLFtcInllYXJcIixudWxsXV0sVWE9e3N1bTpmdW5jdGlvbihhKXt2YXIgYj1hLmxlbmd0aCxjO2lmKCFiJiZhLmhhc051bGxzKWM9bnVsbDtlbHNlIGlmKGIpZm9yKGM9MDtiLS07KWMrPWFbYl07cmV0dXJuIGN9LGF2ZXJhZ2U6ZnVuY3Rpb24oYSl7dmFyIGI9XG5hLmxlbmd0aCxhPVVhLnN1bShhKTt0eXBlb2YgYT09PVwibnVtYmVyXCImJmImJihhLz1iKTtyZXR1cm4gYX0sb3BlbjpmdW5jdGlvbihhKXtyZXR1cm4gYS5sZW5ndGg/YVswXTphLmhhc051bGxzP251bGw6dH0saGlnaDpmdW5jdGlvbihhKXtyZXR1cm4gYS5sZW5ndGg/RWEoYSk6YS5oYXNOdWxscz9udWxsOnR9LGxvdzpmdW5jdGlvbihhKXtyZXR1cm4gYS5sZW5ndGg/T2EoYSk6YS5oYXNOdWxscz9udWxsOnR9LGNsb3NlOmZ1bmN0aW9uKGEpe3JldHVybiBhLmxlbmd0aD9hW2EubGVuZ3RoLTFdOmEuaGFzTnVsbHM/bnVsbDp0fSxvaGxjOmZ1bmN0aW9uKGEsYixjLGQpe2E9VWEub3BlbihhKTtiPVVhLmhpZ2goYik7Yz1VYS5sb3coYyk7ZD1VYS5jbG9zZShkKTtpZih0eXBlb2YgYT09PVwibnVtYmVyXCJ8fHR5cGVvZiBiPT09XCJudW1iZXJcInx8dHlwZW9mIGM9PT1cIm51bWJlclwifHx0eXBlb2YgZD09PVwibnVtYmVyXCIpcmV0dXJuW2EsYixjLGRdfSxyYW5nZTpmdW5jdGlvbihhLGIpe2E9XG5VYS5sb3coYSk7Yj1VYS5oaWdoKGIpO2lmKHR5cGVvZiBhPT09XCJudW1iZXJcInx8dHlwZW9mIGI9PT1cIm51bWJlclwiKXJldHVyblthLGJdfX07aWEuZ3JvdXBEYXRhPWZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPXRoaXMuZGF0YSxmPXRoaXMub3B0aW9ucy5kYXRhLGc9W10saD1bXSxpPVtdLGo9YS5sZW5ndGgsayxsLG09ISFiLG89W1tdLFtdLFtdLFtdXSxkPXR5cGVvZiBkPT09XCJmdW5jdGlvblwiP2Q6VWFbZF0scD10aGlzLnBvaW50QXJyYXlNYXAsbj1wJiZwLmxlbmd0aCxxLHM9MDtmb3IocT0wO3E8PWo7cSsrKWlmKGFbcV0+PWNbMF0pYnJlYWs7Zm9yKDtxPD1qO3ErKyl7Zm9yKDtjWzFdIT09dCYmYVtxXT49Y1sxXXx8cT09PWo7KWlmKGs9Yy5zaGlmdCgpLGw9ZC5hcHBseSgwLG8pLGwhPT10JiYoZy5wdXNoKGspLGgucHVzaChsKSxpLnB1c2goe3N0YXJ0OnMsbGVuZ3RoOm9bMF0ubGVuZ3RofSkpLHM9cSxvWzBdPVtdLG9bMV09W10sb1syXT1bXSxvWzNdPVtdLHE9PT1qKWJyZWFrO1xuaWYocT09PWopYnJlYWs7aWYocCl7az10aGlzLmNyb3BTdGFydCtxO2s9ZSYmZVtrXXx8dGhpcy5wb2ludENsYXNzLnByb3RvdHlwZS5hcHBseU9wdGlvbnMuYXBwbHkoe3Nlcmllczp0aGlzfSxbZltrXV0pO3ZhciB1O2ZvcihsPTA7bDxuO2wrKylpZih1PWtbcFtsXV0sdHlwZW9mIHU9PT1cIm51bWJlclwiKW9bbF0ucHVzaCh1KTtlbHNlIGlmKHU9PT1udWxsKW9bbF0uaGFzTnVsbHM9ITB9ZWxzZSBpZihrPW0/YltxXTpudWxsLHR5cGVvZiBrPT09XCJudW1iZXJcIilvWzBdLnB1c2goayk7ZWxzZSBpZihrPT09bnVsbClvWzBdLmhhc051bGxzPSEwfXJldHVybltnLGgsaV19O2lhLnByb2Nlc3NEYXRhPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5jaGFydCxiPXRoaXMub3B0aW9ucy5kYXRhR3JvdXBpbmcsYz10aGlzLmFsbG93REchPT0hMSYmYiYmcShiLmVuYWJsZWQsYS5vcHRpb25zLl9zdG9jayksZDt0aGlzLmZvcmNlQ3JvcD1jO3RoaXMuZ3JvdXBQaXhlbFdpZHRoPW51bGw7dGhpcy5oYXNQcm9jZXNzZWQ9XG4hMDtpZihjYy5hcHBseSh0aGlzLGFyZ3VtZW50cykhPT0hMSYmYyl7dGhpcy5kZXN0cm95R3JvdXBlZERhdGEoKTt2YXIgZT10aGlzLnByb2Nlc3NlZFhEYXRhLGY9dGhpcy5wcm9jZXNzZWRZRGF0YSxnPWEucGxvdFNpemVYLGE9dGhpcy54QXhpcyxoPWEub3B0aW9ucy5vcmRpbmFsLGk9dGhpcy5ncm91cFBpeGVsV2lkdGg9YS5nZXRHcm91cFBpeGVsV2lkdGgmJmEuZ2V0R3JvdXBQaXhlbFdpZHRoKCk7aWYoaSl7ZD0hMDt0aGlzLnBvaW50cz1udWxsO3ZhciBqPWEuZ2V0RXh0cmVtZXMoKSxjPWoubWluLGo9ai5tYXgsaD1oJiZhLmdldEdyb3VwSW50ZXJ2YWxGYWN0b3IoYyxqLHRoaXMpfHwxLGc9aSooai1jKS9nKmgsaT1hLmdldFRpbWVUaWNrcyhhLm5vcm1hbGl6ZVRpbWVUaWNrSW50ZXJ2YWwoZyxiLnVuaXRzfHxZYiksTWF0aC5taW4oYyxlWzBdKSxNYXRoLm1heChqLGVbZS5sZW5ndGgtMV0pLGEub3B0aW9ucy5zdGFydE9mV2VlayxlLHRoaXMuY2xvc2VzdFBvaW50UmFuZ2UpLFxuZT1pYS5ncm91cERhdGEuYXBwbHkodGhpcyxbZSxmLGksYi5hcHByb3hpbWF0aW9uXSksZj1lWzBdLGg9ZVsxXTtpZihiLnNtb290aGVkKXtiPWYubGVuZ3RoLTE7Zm9yKGZbYl09TWF0aC5taW4oZltiXSxqKTtiLS0mJmI+MDspZltiXSs9Zy8yO2ZbMF09TWF0aC5tYXgoZlswXSxjKX10aGlzLmN1cnJlbnREYXRhR3JvdXBpbmc9aS5pbmZvO3RoaXMuY2xvc2VzdFBvaW50UmFuZ2U9aS5pbmZvLnRvdGFsUmFuZ2U7dGhpcy5ncm91cE1hcD1lWzJdO2lmKHMoZlswXSkmJmZbMF08YS5kYXRhTWluKXtpZihhLm1pbj09PWEuZGF0YU1pbilhLm1pbj1mWzBdO2EuZGF0YU1pbj1mWzBdfXRoaXMucHJvY2Vzc2VkWERhdGE9Zjt0aGlzLnByb2Nlc3NlZFlEYXRhPWh9ZWxzZSB0aGlzLmN1cnJlbnREYXRhR3JvdXBpbmc9dGhpcy5ncm91cE1hcD1udWxsO3RoaXMuaGFzR3JvdXBlZERhdGE9ZH19O2lhLmRlc3Ryb3lHcm91cGVkRGF0YT1mdW5jdGlvbigpe3ZhciBhPXRoaXMuZ3JvdXBlZERhdGE7XG5uKGF8fFtdLGZ1bmN0aW9uKGIsYyl7YiYmKGFbY109Yi5kZXN0cm95P2IuZGVzdHJveSgpOm51bGwpfSk7dGhpcy5ncm91cGVkRGF0YT1udWxsfTtpYS5nZW5lcmF0ZVBvaW50cz1mdW5jdGlvbigpe2RjLmFwcGx5KHRoaXMpO3RoaXMuZGVzdHJveUdyb3VwZWREYXRhKCk7dGhpcy5ncm91cGVkRGF0YT10aGlzLmhhc0dyb3VwZWREYXRhP3RoaXMucG9pbnRzOm51bGx9O1UoTGIucHJvdG90eXBlLFwidG9vbHRpcEZvb3RlckhlYWRlckZvcm1hdHRlclwiLGZ1bmN0aW9uKGEsYixjKXt2YXIgZD1iLnNlcmllcyxlPWQudG9vbHRpcE9wdGlvbnMsZj1kLm9wdGlvbnMuZGF0YUdyb3VwaW5nLGc9ZS54RGF0ZUZvcm1hdCxoLGk9ZC54QXhpcztyZXR1cm4gaSYmaS5vcHRpb25zLnR5cGU9PT1cImRhdGV0aW1lXCImJmYmJnVhKGIua2V5KT8oYT1kLmN1cnJlbnREYXRhR3JvdXBpbmcsZj1mLmRhdGVUaW1lTGFiZWxGb3JtYXRzLGE/KGk9ZlthLnVuaXROYW1lXSxhLmNvdW50PT09MT9nPWlbMF06KGc9XG5pWzFdLGg9aVsyXSkpOiFnJiZmJiYoZz10aGlzLmdldFhEYXRlRm9ybWF0KGIsZSxpKSksZz1tYShnLGIua2V5KSxoJiYoZys9bWEoaCxiLmtleSthLnRvdGFsUmFuZ2UtMSkpLExhKGVbKGM/XCJmb290ZXJcIjpcImhlYWRlclwiKStcIkZvcm1hdFwiXSx7cG9pbnQ6eChiLHtrZXk6Z30pLHNlcmllczpkfSkpOmEuY2FsbCh0aGlzLGIsYyl9KTtpYS5kZXN0cm95PWZ1bmN0aW9uKCl7Zm9yKHZhciBhPXRoaXMuZ3JvdXBlZERhdGF8fFtdLGI9YS5sZW5ndGg7Yi0tOylhW2JdJiZhW2JdLmRlc3Ryb3koKTtlYy5hcHBseSh0aGlzKX07VShpYSxcInNldE9wdGlvbnNcIixmdW5jdGlvbihhLGIpe3ZhciBjPWEuY2FsbCh0aGlzLGIpLGQ9dGhpcy50eXBlLGU9dGhpcy5jaGFydC5vcHRpb25zLnBsb3RPcHRpb25zLGY9V1tkXS5kYXRhR3JvdXBpbmc7aWYoWGJbZF0pZnx8KGY9QyhmYyxYYltkXSkpLGMuZGF0YUdyb3VwaW5nPUMoZixlLnNlcmllcyYmZS5zZXJpZXMuZGF0YUdyb3VwaW5nLGVbZF0uZGF0YUdyb3VwaW5nLFxuYi5kYXRhR3JvdXBpbmcpO2lmKHRoaXMuY2hhcnQub3B0aW9ucy5fc3RvY2spdGhpcy5yZXF1aXJlU29ydGluZz0hMDtyZXR1cm4gY30pO1UoSS5wcm90b3R5cGUsXCJzZXRTY2FsZVwiLGZ1bmN0aW9uKGEpe2EuY2FsbCh0aGlzKTtuKHRoaXMuc2VyaWVzLGZ1bmN0aW9uKGEpe2EuaGFzUHJvY2Vzc2VkPSExfSl9KTtJLnByb3RvdHlwZS5nZXRHcm91cFBpeGVsV2lkdGg9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLnNlcmllcyxiPWEubGVuZ3RoLGMsZD0wLGU9ITEsZjtmb3IoYz1iO2MtLTspKGY9YVtjXS5vcHRpb25zLmRhdGFHcm91cGluZykmJihkPXYoZCxmLmdyb3VwUGl4ZWxXaWR0aCkpO2ZvcihjPWI7Yy0tOylpZigoZj1hW2NdLm9wdGlvbnMuZGF0YUdyb3VwaW5nKSYmYVtjXS5oYXNQcm9jZXNzZWQpaWYoYj0oYVtjXS5wcm9jZXNzZWRYRGF0YXx8YVtjXS5kYXRhKS5sZW5ndGgsYVtjXS5ncm91cFBpeGVsV2lkdGh8fGI+dGhpcy5jaGFydC5wbG90U2l6ZVgvZHx8YiYmZi5mb3JjZWQpZT1cbiEwO3JldHVybiBlP2Q6MH07SS5wcm90b3R5cGUuc2V0RGF0YUdyb3VwaW5nPWZ1bmN0aW9uKGEsYil7dmFyIGMsYj1xKGIsITApO2F8fChhPXtmb3JjZWQ6ITEsdW5pdHM6bnVsbH0pO2lmKHRoaXMgaW5zdGFuY2VvZiBJKWZvcihjPXRoaXMuc2VyaWVzLmxlbmd0aDtjLS07KXRoaXMuc2VyaWVzW2NdLnVwZGF0ZSh7ZGF0YUdyb3VwaW5nOmF9LCExKTtlbHNlIG4odGhpcy5jaGFydC5vcHRpb25zLnNlcmllcyxmdW5jdGlvbihiKXtiLmRhdGFHcm91cGluZz1hfSwhMSk7YiYmdGhpcy5jaGFydC5yZWRyYXcoKX07Vy5vaGxjPUMoVy5jb2x1bW4se2xpbmVXaWR0aDoxLHRvb2x0aXA6e3BvaW50Rm9ybWF0Oic8c3BhbiBzdHlsZT1cImNvbG9yOntwb2ludC5jb2xvcn1cIj5cXHUyNWNmPC9zcGFuPiA8Yj4ge3Nlcmllcy5uYW1lfTwvYj48YnIvPk9wZW46IHtwb2ludC5vcGVufTxici8+SGlnaDoge3BvaW50LmhpZ2h9PGJyLz5Mb3c6IHtwb2ludC5sb3d9PGJyLz5DbG9zZToge3BvaW50LmNsb3NlfTxici8+J30sXG5zdGF0ZXM6e2hvdmVyOntsaW5lV2lkdGg6M319LHRocmVzaG9sZDpudWxsfSk7Y2E9bGEoSy5jb2x1bW4se3R5cGU6XCJvaGxjXCIscG9pbnRBcnJheU1hcDpbXCJvcGVuXCIsXCJoaWdoXCIsXCJsb3dcIixcImNsb3NlXCJdLHRvWURhdGE6ZnVuY3Rpb24oYSl7cmV0dXJuW2Eub3BlbixhLmhpZ2gsYS5sb3csYS5jbG9zZV19LHBvaW50VmFsS2V5OlwiaGlnaFwiLHBvaW50QXR0clRvT3B0aW9uczp7c3Ryb2tlOlwiY29sb3JcIixcInN0cm9rZS13aWR0aFwiOlwibGluZVdpZHRoXCJ9LHVwQ29sb3JQcm9wOlwic3Ryb2tlXCIsZ2V0QXR0cmliczpmdW5jdGlvbigpe0suY29sdW1uLnByb3RvdHlwZS5nZXRBdHRyaWJzLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt2YXIgYT10aGlzLm9wdGlvbnMsYj1hLnN0YXRlcyxhPWEudXBDb2xvcnx8dGhpcy5jb2xvcixjPUModGhpcy5wb2ludEF0dHIpLGQ9dGhpcy51cENvbG9yUHJvcDtjW1wiXCJdW2RdPWE7Yy5ob3ZlcltkXT1iLmhvdmVyLnVwQ29sb3J8fGE7Yy5zZWxlY3RbZF09Yi5zZWxlY3QudXBDb2xvcnx8XG5hO24odGhpcy5wb2ludHMsZnVuY3Rpb24oYSl7aWYoYS5vcGVuPGEuY2xvc2UmJiFhLm9wdGlvbnMuY29sb3IpYS5wb2ludEF0dHI9Y30pfSx0cmFuc2xhdGU6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLnlBeGlzO0suY29sdW1uLnByb3RvdHlwZS50cmFuc2xhdGUuYXBwbHkodGhpcyk7bih0aGlzLnBvaW50cyxmdW5jdGlvbihiKXtpZihiLm9wZW4hPT1udWxsKWIucGxvdE9wZW49YS50cmFuc2xhdGUoYi5vcGVuLDAsMSwwLDEpO2lmKGIuY2xvc2UhPT1udWxsKWIucGxvdENsb3NlPWEudHJhbnNsYXRlKGIuY2xvc2UsMCwxLDAsMSl9KX0sZHJhd1BvaW50czpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLmNoYXJ0LGMsZCxlLGYsZyxoLGksajtuKGEucG9pbnRzLGZ1bmN0aW9uKGspe2lmKGsucGxvdFkhPT10KWk9ay5ncmFwaGljLGM9ay5wb2ludEF0dHJbay5zZWxlY3RlZD9cInNlbGVjdGVkXCI6XCJcIl18fGEucG9pbnRBdHRyW1wiXCJdLGY9Y1tcInN0cm9rZS13aWR0aFwiXSUyLzIsaj15KGsucGxvdFgpLVxuZixnPXkoay5zaGFwZUFyZ3Mud2lkdGgvMiksaD1bXCJNXCIsaix5KGsueUJvdHRvbSksXCJMXCIsaix5KGsucGxvdFkpXSxrLm9wZW4hPT1udWxsJiYoZD15KGsucGxvdE9wZW4pK2YsaC5wdXNoKFwiTVwiLGosZCxcIkxcIixqLWcsZCkpLGsuY2xvc2UhPT1udWxsJiYoZT15KGsucGxvdENsb3NlKStmLGgucHVzaChcIk1cIixqLGUsXCJMXCIsaitnLGUpKSxpP2kuYXR0cihjKS5hbmltYXRlKHtkOmh9KTprLmdyYXBoaWM9Yi5yZW5kZXJlci5wYXRoKGgpLmF0dHIoYykuYWRkKGEuZ3JvdXApfSl9LGFuaW1hdGU6bnVsbH0pO0sub2hsYz1jYTtXLmNhbmRsZXN0aWNrPUMoVy5jb2x1bW4se2xpbmVDb2xvcjpcImJsYWNrXCIsbGluZVdpZHRoOjEsc3RhdGVzOntob3Zlcjp7bGluZVdpZHRoOjJ9fSx0b29sdGlwOlcub2hsYy50b29sdGlwLHRocmVzaG9sZDpudWxsLHVwQ29sb3I6XCJ3aGl0ZVwifSk7Y2E9bGEoY2Ese3R5cGU6XCJjYW5kbGVzdGlja1wiLHBvaW50QXR0clRvT3B0aW9uczp7ZmlsbDpcImNvbG9yXCIsc3Ryb2tlOlwibGluZUNvbG9yXCIsXG5cInN0cm9rZS13aWR0aFwiOlwibGluZVdpZHRoXCJ9LHVwQ29sb3JQcm9wOlwiZmlsbFwiLGdldEF0dHJpYnM6ZnVuY3Rpb24oKXtLLm9obGMucHJvdG90eXBlLmdldEF0dHJpYnMuYXBwbHkodGhpcyxhcmd1bWVudHMpO3ZhciBhPXRoaXMub3B0aW9ucyxiPWEuc3RhdGVzLGM9YS51cExpbmVDb2xvcnx8YS5saW5lQ29sb3IsZD1iLmhvdmVyLnVwTGluZUNvbG9yfHxjLGU9Yi5zZWxlY3QudXBMaW5lQ29sb3J8fGM7bih0aGlzLnBvaW50cyxmdW5jdGlvbihhKXtpZihhLm9wZW48YS5jbG9zZSl7aWYoYS5saW5lQ29sb3IpYS5wb2ludEF0dHI9QyhhLnBvaW50QXR0ciksYz1hLmxpbmVDb2xvcjthLnBvaW50QXR0cltcIlwiXS5zdHJva2U9YzthLnBvaW50QXR0ci5ob3Zlci5zdHJva2U9ZDthLnBvaW50QXR0ci5zZWxlY3Quc3Ryb2tlPWV9fSl9LGRyYXdQb2ludHM6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5jaGFydCxjLGQ9YS5wb2ludEF0dHJbXCJcIl0sZSxmLGcsaCxpLGosayxsLG0sbyxwO24oYS5wb2ludHMsXG5mdW5jdGlvbihuKXttPW4uZ3JhcGhpYztpZihuLnBsb3RZIT09dCljPW4ucG9pbnRBdHRyW24uc2VsZWN0ZWQ/XCJzZWxlY3RlZFwiOlwiXCJdfHxkLGs9Y1tcInN0cm9rZS13aWR0aFwiXSUyLzIsbD15KG4ucGxvdFgpLWssZT1uLnBsb3RPcGVuLGY9bi5wbG90Q2xvc2UsZz1ZLm1pbihlLGYpLGg9WS5tYXgoZSxmKSxwPXkobi5zaGFwZUFyZ3Mud2lkdGgvMiksaT15KGcpIT09eShuLnBsb3RZKSxqPWghPT1uLnlCb3R0b20sZz15KGcpK2ssaD15KGgpK2ssbz1bXCJNXCIsbC1wLGgsXCJMXCIsbC1wLGcsXCJMXCIsbCtwLGcsXCJMXCIsbCtwLGgsXCJaXCIsXCJNXCIsbCxnLFwiTFwiLGwsaT95KG4ucGxvdFkpOmcsXCJNXCIsbCxoLFwiTFwiLGwsaj95KG4ueUJvdHRvbSk6aF0sbT9tLmF0dHIoYykuYW5pbWF0ZSh7ZDpvfSk6bi5ncmFwaGljPWIucmVuZGVyZXIucGF0aChvKS5hdHRyKGMpLmFkZChhLmdyb3VwKS5zaGFkb3coYS5vcHRpb25zLnNoYWRvdyl9KX19KTtLLmNhbmRsZXN0aWNrPWNhO3ZhciB3Yj15YS5wcm90b3R5cGUuc3ltYm9scztcblcuZmxhZ3M9QyhXLmNvbHVtbix7ZmlsbENvbG9yOlwid2hpdGVcIixsaW5lV2lkdGg6MSxwb2ludFJhbmdlOjAsc2hhcGU6XCJmbGFnXCIsc3RhY2tEaXN0YW5jZToxMixzdGF0ZXM6e2hvdmVyOntsaW5lQ29sb3I6XCJibGFja1wiLGZpbGxDb2xvcjpcIiNGQ0ZGQzVcIn19LHN0eWxlOntmb250U2l6ZTpcIjExcHhcIixmb250V2VpZ2h0OlwiYm9sZFwiLHRleHRBbGlnbjpcImNlbnRlclwifSx0b29sdGlwOntwb2ludEZvcm1hdDpcIntwb2ludC50ZXh0fTxici8+XCJ9LHRocmVzaG9sZDpudWxsLHk6LTMwfSk7Sy5mbGFncz1sYShLLmNvbHVtbix7dHlwZTpcImZsYWdzXCIsc29ydGVkOiExLG5vU2hhcmVkVG9vbHRpcDohMCxhbGxvd0RHOiExLHRha2VPcmRpbmFsUG9zaXRpb246ITEsdHJhY2tlckdyb3VwczpbXCJtYXJrZXJHcm91cFwiXSxmb3JjZUNyb3A6ITAsaW5pdDpRLnByb3RvdHlwZS5pbml0LHBvaW50QXR0clRvT3B0aW9uczp7ZmlsbDpcImZpbGxDb2xvclwiLHN0cm9rZTpcImNvbG9yXCIsXCJzdHJva2Utd2lkdGhcIjpcImxpbmVXaWR0aFwiLFxucjpcInJhZGl1c1wifSx0cmFuc2xhdGU6ZnVuY3Rpb24oKXtLLmNvbHVtbi5wcm90b3R5cGUudHJhbnNsYXRlLmFwcGx5KHRoaXMpO3ZhciBhPXRoaXMub3B0aW9ucyxiPXRoaXMuY2hhcnQsYz10aGlzLnBvaW50cyxkPWMubGVuZ3RoLTEsZSxmLGc9YS5vblNlcmllcztlPWcmJmIuZ2V0KGcpO3ZhciBhPWEub25LZXl8fFwieVwiLGc9ZSYmZS5vcHRpb25zLnN0ZXAsaD1lJiZlLnBvaW50cyxpPWgmJmgubGVuZ3RoLGo9dGhpcy54QXhpcyxrPWouZ2V0RXh0cmVtZXMoKSxsLG0sbztpZihlJiZlLnZpc2libGUmJmkpe2U9ZS5jdXJyZW50RGF0YUdyb3VwaW5nO209aFtpLTFdLngrKGU/ZS50b3RhbFJhbmdlOjApO2Muc29ydChmdW5jdGlvbihhLGIpe3JldHVybiBhLngtYi54fSk7Zm9yKGE9XCJwbG90XCIrYVswXS50b1VwcGVyQ2FzZSgpK2Euc3Vic3RyKDEpO2ktLSYmY1tkXTspaWYoZT1jW2RdLGw9aFtpXSxsLng8PWUueCYmbFthXSE9PXZvaWQgMCl7aWYoZS54PD1tKWUucGxvdFk9bFthXSxsLng8XG5lLngmJiFnJiYobz1oW2krMV0pJiZvW2FdIT09dCYmKGUucGxvdFkrPShlLngtbC54KS8oby54LWwueCkqKG9bYV0tbFthXSkpO2QtLTtpKys7aWYoZDwwKWJyZWFrfX1uKGMsZnVuY3Rpb24oYSxkKXt2YXIgZTtpZihhLnBsb3RZPT09dClhLng+PWsubWluJiZhLng8PWsubWF4P2EucGxvdFk9Yi5jaGFydEhlaWdodC1qLmJvdHRvbS0oai5vcHBvc2l0ZT9qLmhlaWdodDowKStqLm9mZnNldC1iLnBsb3RUb3A6YS5zaGFwZUFyZ3M9e307aWYoKGY9Y1tkLTFdKSYmZi5wbG90WD09PWEucGxvdFgpe2lmKGYuc3RhY2tJbmRleD09PXQpZi5zdGFja0luZGV4PTA7ZT1mLnN0YWNrSW5kZXgrMX1hLnN0YWNrSW5kZXg9ZX0pfSxkcmF3UG9pbnRzOmZ1bmN0aW9uKCl7dmFyIGEsYj10aGlzLnBvaW50QXR0cltcIlwiXSxjPXRoaXMucG9pbnRzLGQ9dGhpcy5jaGFydCxlPWQucmVuZGVyZXIsZixnLGg9dGhpcy5vcHRpb25zLGk9aC55LGosayxsLG0sbyxuLHI9dGhpcy55QXhpcztmb3Ioaz1jLmxlbmd0aDtrLS07KWlmKGw9XG5jW2tdLGE9bC5wbG90WD50aGlzLnhBeGlzLmxlbixmPWwucGxvdFgsZj4wJiYoZi09cShsLmxpbmVXaWR0aCxoLmxpbmVXaWR0aCklMiksbT1sLnN0YWNrSW5kZXgsaj1sLm9wdGlvbnMuc2hhcGV8fGguc2hhcGUsZz1sLnBsb3RZLGchPT10JiYoZz1sLnBsb3RZK2ktKG0hPT10JiZtKmguc3RhY2tEaXN0YW5jZSkpLG89bT90OmwucGxvdFgsbj1tP3Q6bC5wbG90WSxtPWwuZ3JhcGhpYyxnIT09dCYmZj49MCYmIWEpYT1sLnBvaW50QXR0cltsLnNlbGVjdGVkP1wic2VsZWN0XCI6XCJcIl18fGIsbT9tLmF0dHIoe3g6Zix5OmcscjphLnIsYW5jaG9yWDpvLGFuY2hvclk6bn0pOmwuZ3JhcGhpYz1lLmxhYmVsKGwub3B0aW9ucy50aXRsZXx8aC50aXRsZXx8XCJBXCIsZixnLGosbyxuLGgudXNlSFRNTCkuY3NzKEMoaC5zdHlsZSxsLnN0eWxlKSkuYXR0cihhKS5hdHRyKHthbGlnbjpqPT09XCJmbGFnXCI/XCJsZWZ0XCI6XCJjZW50ZXJcIix3aWR0aDpoLndpZHRoLGhlaWdodDpoLmhlaWdodH0pLmFkZCh0aGlzLm1hcmtlckdyb3VwKS5zaGFkb3coaC5zaGFkb3cpLFxubC50b29sdGlwUG9zPWQuaW52ZXJ0ZWQ/W3IubGVuK3IucG9zLWQucGxvdExlZnQtZyx0aGlzLnhBeGlzLmxlbi1mXTpbZixnXTtlbHNlIGlmKG0pbC5ncmFwaGljPW0uZGVzdHJveSgpfSxkcmF3VHJhY2tlcjpmdW5jdGlvbigpe3ZhciBhPXRoaXMucG9pbnRzO25iLmRyYXdUcmFja2VyUG9pbnQuYXBwbHkodGhpcyk7bihhLGZ1bmN0aW9uKGIpe3ZhciBjPWIuZ3JhcGhpYztjJiZEKGMuZWxlbWVudCxcIm1vdXNlb3ZlclwiLGZ1bmN0aW9uKCl7aWYoYi5zdGFja0luZGV4PjAmJiFiLnJhaXNlZCliLl95PWMueSxjLmF0dHIoe3k6Yi5feS04fSksYi5yYWlzZWQ9ITA7bihhLGZ1bmN0aW9uKGEpe2lmKGEhPT1iJiZhLnJhaXNlZCYmYS5ncmFwaGljKWEuZ3JhcGhpYy5hdHRyKHt5OmEuX3l9KSxhLnJhaXNlZD0hMX0pfSl9KX0sYW5pbWF0ZTpyYSxidWlsZEtEVHJlZTpyYSxzZXRDbGlwOnJhfSk7d2IuZmxhZz1mdW5jdGlvbihhLGIsYyxkLGUpe3JldHVybltcIk1cIixlJiZlLmFuY2hvclh8fFxuYSxlJiZlLmFuY2hvcll8fGIsXCJMXCIsYSxiK2QsYSxiLGErYyxiLGErYyxiK2QsYSxiK2QsXCJaXCJdfTtuKFtcImNpcmNsZVwiLFwic3F1YXJlXCJdLGZ1bmN0aW9uKGEpe3diW2ErXCJwaW5cIl09ZnVuY3Rpb24oYixjLGQsZSxmKXt2YXIgZz1mJiZmLmFuY2hvclgsZj1mJiZmLmFuY2hvclk7YT09PVwiY2lyY2xlXCImJmU+ZCYmKGItPXkoKGUtZCkvMiksZD1lKTtiPXdiW2FdKGIsYyxkLGUpO2cmJmYmJmIucHVzaChcIk1cIixnLGM+Zj9jOmMrZSxcIkxcIixnLGYpO3JldHVybiBifX0pO1lhPT09ei5WTUxSZW5kZXJlciYmbihbXCJmbGFnXCIsXCJjaXJjbGVwaW5cIixcInNxdWFyZXBpblwiXSxmdW5jdGlvbihhKXttYi5wcm90b3R5cGUuc3ltYm9sc1thXT13YlthXX0pO3ZhciBjYT1bXS5jb25jYXQoWWIpLHhiPWZ1bmN0aW9uKGEpe3ZhciBiPVNhKGFyZ3VtZW50cyxmdW5jdGlvbihhKXtyZXR1cm4gdHlwZW9mIGE9PT1cIm51bWJlclwifSk7aWYoYi5sZW5ndGgpcmV0dXJuIE1hdGhbYV0uYXBwbHkoMCxiKX07Y2FbNF09XG5bXCJkYXlcIixbMSwyLDMsNF1dO2NhWzVdPVtcIndlZWtcIixbMSwyLDNdXTt4KE4se25hdmlnYXRvcjp7aGFuZGxlczp7YmFja2dyb3VuZENvbG9yOlwiI2ViZTdlOFwiLGJvcmRlckNvbG9yOlwiI2IyYjFiNlwifSxoZWlnaHQ6NDAsbWFyZ2luOjI1LG1hc2tGaWxsOlwicmdiYSgxMjgsMTc5LDIzNiwwLjMpXCIsbWFza0luc2lkZTohMCxvdXRsaW5lQ29sb3I6XCIjYjJiMWI2XCIsb3V0bGluZVdpZHRoOjEsc2VyaWVzOnt0eXBlOksuYXJlYXNwbGluZT09PXQ/XCJsaW5lXCI6XCJhcmVhc3BsaW5lXCIsY29sb3I6XCIjNDU3MkE3XCIsY29tcGFyZTpudWxsLGZpbGxPcGFjaXR5OjAuMDUsZGF0YUdyb3VwaW5nOnthcHByb3hpbWF0aW9uOlwiYXZlcmFnZVwiLGVuYWJsZWQ6ITAsZ3JvdXBQaXhlbFdpZHRoOjIsc21vb3RoZWQ6ITAsdW5pdHM6Y2F9LGRhdGFMYWJlbHM6e2VuYWJsZWQ6ITEsekluZGV4OjJ9LGlkOlwiaGlnaGNoYXJ0cy1uYXZpZ2F0b3Itc2VyaWVzXCIsbGluZUNvbG9yOm51bGwsbGluZVdpZHRoOjEsbWFya2VyOntlbmFibGVkOiExfSxcbnBvaW50UmFuZ2U6MCxzaGFkb3c6ITEsdGhyZXNob2xkOm51bGx9LHhBeGlzOnt0aWNrV2lkdGg6MCxsaW5lV2lkdGg6MCxncmlkTGluZUNvbG9yOlwiI0VFRVwiLGdyaWRMaW5lV2lkdGg6MSx0aWNrUGl4ZWxJbnRlcnZhbDoyMDAsbGFiZWxzOnthbGlnbjpcImxlZnRcIixzdHlsZTp7Y29sb3I6XCIjODg4XCJ9LHg6Myx5Oi00fSxjcm9zc2hhaXI6ITF9LHlBeGlzOntncmlkTGluZVdpZHRoOjAsc3RhcnRPblRpY2s6ITEsZW5kT25UaWNrOiExLG1pblBhZGRpbmc6MC4xLG1heFBhZGRpbmc6MC4xLGxhYmVsczp7ZW5hYmxlZDohMX0sY3Jvc3NoYWlyOiExLHRpdGxlOnt0ZXh0Om51bGx9LHRpY2tXaWR0aDowfX0sc2Nyb2xsYmFyOntoZWlnaHQ6a2I/MjA6MTQsYmFyQmFja2dyb3VuZENvbG9yOlwiI2JmYzhkMVwiLGJhckJvcmRlclJhZGl1czowLGJhckJvcmRlcldpZHRoOjEsYmFyQm9yZGVyQ29sb3I6XCIjYmZjOGQxXCIsYnV0dG9uQXJyb3dDb2xvcjpcIiM2NjZcIixidXR0b25CYWNrZ3JvdW5kQ29sb3I6XCIjZWJlN2U4XCIsXG5idXR0b25Cb3JkZXJDb2xvcjpcIiNiYmJcIixidXR0b25Cb3JkZXJSYWRpdXM6MCxidXR0b25Cb3JkZXJXaWR0aDoxLG1pbldpZHRoOjYscmlmbGVDb2xvcjpcIiM2NjZcIix0cmFja0JhY2tncm91bmRDb2xvcjpcIiNlZWVlZWVcIix0cmFja0JvcmRlckNvbG9yOlwiI2VlZWVlZVwiLHRyYWNrQm9yZGVyV2lkdGg6MSxsaXZlUmVkcmF3OmphJiYha2J9fSk7SGIucHJvdG90eXBlPXtkcmF3SGFuZGxlOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5jaGFydCxkPWMucmVuZGVyZXIsZT10aGlzLmVsZW1lbnRzVG9EZXN0cm95LGY9dGhpcy5oYW5kbGVzLGc9dGhpcy5uYXZpZ2F0b3JPcHRpb25zLmhhbmRsZXMsZz17ZmlsbDpnLmJhY2tncm91bmRDb2xvcixzdHJva2U6Zy5ib3JkZXJDb2xvcixcInN0cm9rZS13aWR0aFwiOjF9LGg7dGhpcy5yZW5kZXJlZHx8KGZbYl09ZC5nKFwibmF2aWdhdG9yLWhhbmRsZS1cIitbXCJsZWZ0XCIsXCJyaWdodFwiXVtiXSkuY3NzKHtjdXJzb3I6XCJldy1yZXNpemVcIn0pLmF0dHIoe3pJbmRleDoxMC1cbmJ9KS5hZGQoKSxoPWQucmVjdCgtNC41LDAsOSwxNiwwLDEpLmF0dHIoZykuYWRkKGZbYl0pLGUucHVzaChoKSxoPWQucGF0aChbXCJNXCIsLTEuNSw0LFwiTFwiLC0xLjUsMTIsXCJNXCIsMC41LDQsXCJMXCIsMC41LDEyXSkuYXR0cihnKS5hZGQoZltiXSksZS5wdXNoKGgpKTtmW2JdW2MuaXNSZXNpemluZz9cImFuaW1hdGVcIjpcImF0dHJcIl0oe3RyYW5zbGF0ZVg6dGhpcy5zY3JvbGxlckxlZnQrdGhpcy5zY3JvbGxiYXJIZWlnaHQrcGFyc2VJbnQoYSwxMCksdHJhbnNsYXRlWTp0aGlzLnRvcCt0aGlzLmhlaWdodC8yLTh9KX0sZHJhd1Njcm9sbGJhckJ1dHRvbjpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNoYXJ0LnJlbmRlcmVyLGM9dGhpcy5lbGVtZW50c1RvRGVzdHJveSxkPXRoaXMuc2Nyb2xsYmFyQnV0dG9ucyxlPXRoaXMuc2Nyb2xsYmFySGVpZ2h0LGY9dGhpcy5zY3JvbGxiYXJPcHRpb25zLGc7dGhpcy5yZW5kZXJlZHx8KGRbYV09Yi5nKCkuYWRkKHRoaXMuc2Nyb2xsYmFyR3JvdXApLGc9Yi5yZWN0KC0wLjUsXG4tMC41LGUrMSxlKzEsZi5idXR0b25Cb3JkZXJSYWRpdXMsZi5idXR0b25Cb3JkZXJXaWR0aCkuYXR0cih7c3Ryb2tlOmYuYnV0dG9uQm9yZGVyQ29sb3IsXCJzdHJva2Utd2lkdGhcIjpmLmJ1dHRvbkJvcmRlcldpZHRoLGZpbGw6Zi5idXR0b25CYWNrZ3JvdW5kQ29sb3J9KS5hZGQoZFthXSksYy5wdXNoKGcpLGc9Yi5wYXRoKFtcIk1cIixlLzIrKGE/LTE6MSksZS8yLTMsXCJMXCIsZS8yKyhhPy0xOjEpLGUvMiszLGUvMisoYT8yOi0yKSxlLzJdKS5hdHRyKHtmaWxsOmYuYnV0dG9uQXJyb3dDb2xvcn0pLmFkZChkW2FdKSxjLnB1c2goZykpO2EmJmRbYV0uYXR0cih7dHJhbnNsYXRlWDp0aGlzLnNjcm9sbGVyV2lkdGgtZX0pfSxyZW5kZXI6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9dGhpcy5jaGFydCxmPWUucmVuZGVyZXIsZyxoLGksaixrPXRoaXMuc2Nyb2xsYmFyR3JvdXAsbD10aGlzLm5hdmlnYXRvckdyb3VwLG09dGhpcy5zY3JvbGxiYXIsbD10aGlzLnhBeGlzLG89dGhpcy5zY3JvbGxiYXJUcmFjayxcbm49dGhpcy5zY3JvbGxiYXJIZWlnaHQscj10aGlzLnNjcm9sbGJhckVuYWJsZWQsQT10aGlzLm5hdmlnYXRvck9wdGlvbnMsdD10aGlzLnNjcm9sbGJhck9wdGlvbnMsdT10Lm1pbldpZHRoLHc9dGhpcy5oZWlnaHQseD10aGlzLnRvcCx6PXRoaXMubmF2aWdhdG9yRW5hYmxlZCxDPUEub3V0bGluZVdpZHRoLEI9Qy8yLEQ9MCxHPXRoaXMub3V0bGluZUhlaWdodCxJPXQuYmFyQm9yZGVyUmFkaXVzLEg9dC5iYXJCb3JkZXJXaWR0aCxGPXgrQixKO2lmKHMoYSkmJiFpc05hTihhKSYmcyhiKSYmIShpc05hTihiKXx8dGhpcy5oYXNEcmFnZ2VkJiYhcyhjKSkpe3RoaXMubmF2aWdhdG9yTGVmdD1nPXEobC5sZWZ0LGUucGxvdExlZnQrbik7dGhpcy5uYXZpZ2F0b3JXaWR0aD1oPXEobC5sZW4sZS5wbG90V2lkdGgtMipuKTt0aGlzLnNjcm9sbGVyTGVmdD1pPWctbjt0aGlzLnNjcm9sbGVyV2lkdGg9aj1qPWgrMipuO2wuZ2V0RXh0cmVtZXMmJihKPXRoaXMuZ2V0VW5pb25FeHRyZW1lcyghMCkpJiZcbihKLmRhdGFNaW4hPT1sLm1pbnx8Si5kYXRhTWF4IT09bC5tYXgpJiZsLnNldEV4dHJlbWVzKEouZGF0YU1pbixKLmRhdGFNYXgsITAsITEpO2M9cShjLGwudHJhbnNsYXRlKGEpKTtkPXEoZCxsLnRyYW5zbGF0ZShiKSk7aWYoaXNOYU4oYyl8fFMoYyk9PT1JbmZpbml0eSljPTAsZD1qO2lmKCEobC50cmFuc2xhdGUoZCwhMCktbC50cmFuc2xhdGUoYywhMCk8ZS54QXhpc1swXS5taW5SYW5nZSkpe3RoaXMuem9vbWVkTWF4PUUodihjLGQsMCksaCk7dGhpcy56b29tZWRNaW49RSh2KHRoaXMuZml4ZWRXaWR0aD90aGlzLnpvb21lZE1heC10aGlzLmZpeGVkV2lkdGg6RShjLGQpLDApLGgpO3RoaXMucmFuZ2U9dGhpcy56b29tZWRNYXgtdGhpcy56b29tZWRNaW47Yz15KHRoaXMuem9vbWVkTWF4KTtiPXkodGhpcy56b29tZWRNaW4pO2E9Yy1iO2lmKCF0aGlzLnJlbmRlcmVkKXtpZih6KXRoaXMubmF2aWdhdG9yR3JvdXA9bD1mLmcoXCJuYXZpZ2F0b3JcIikuYXR0cih7ekluZGV4OjN9KS5hZGQoKSxcbnRoaXMubGVmdFNoYWRlPWYucmVjdCgpLmF0dHIoe2ZpbGw6QS5tYXNrRmlsbH0pLmFkZChsKSxBLm1hc2tJbnNpZGU/dGhpcy5sZWZ0U2hhZGUuY3NzKHtjdXJzb3I6XCJldy1yZXNpemVcIn0pOnRoaXMucmlnaHRTaGFkZT1mLnJlY3QoKS5hdHRyKHtmaWxsOkEubWFza0ZpbGx9KS5hZGQobCksdGhpcy5vdXRsaW5lPWYucGF0aCgpLmF0dHIoe1wic3Ryb2tlLXdpZHRoXCI6QyxzdHJva2U6QS5vdXRsaW5lQ29sb3J9KS5hZGQobCk7aWYocil0aGlzLnNjcm9sbGJhckdyb3VwPWs9Zi5nKFwic2Nyb2xsYmFyXCIpLmFkZCgpLG09dC50cmFja0JvcmRlcldpZHRoLHRoaXMuc2Nyb2xsYmFyVHJhY2s9bz1mLnJlY3QoKS5hdHRyKHt4OjAseTotbSUyLzIsZmlsbDp0LnRyYWNrQmFja2dyb3VuZENvbG9yLHN0cm9rZTp0LnRyYWNrQm9yZGVyQ29sb3IsXCJzdHJva2Utd2lkdGhcIjptLHI6dC50cmFja0JvcmRlclJhZGl1c3x8MCxoZWlnaHQ6bn0pLmFkZChrKSx0aGlzLnNjcm9sbGJhcj1tPWYucmVjdCgpLmF0dHIoe3k6LUglXG4yLzIsaGVpZ2h0Om4sZmlsbDp0LmJhckJhY2tncm91bmRDb2xvcixzdHJva2U6dC5iYXJCb3JkZXJDb2xvcixcInN0cm9rZS13aWR0aFwiOkgscjpJfSkuYWRkKGspLHRoaXMuc2Nyb2xsYmFyUmlmbGVzPWYucGF0aCgpLmF0dHIoe3N0cm9rZTp0LnJpZmxlQ29sb3IsXCJzdHJva2Utd2lkdGhcIjoxfSkuYWRkKGspfWU9ZS5pc1Jlc2l6aW5nP1wiYW5pbWF0ZVwiOlwiYXR0clwiO2lmKHope3RoaXMubGVmdFNoYWRlW2VdKEEubWFza0luc2lkZT97eDpnK2IseTp4LHdpZHRoOmMtYixoZWlnaHQ6d306e3g6Zyx5Ongsd2lkdGg6YixoZWlnaHQ6d30pO2lmKHRoaXMucmlnaHRTaGFkZSl0aGlzLnJpZ2h0U2hhZGVbZV0oe3g6ZytjLHk6eCx3aWR0aDpoLWMsaGVpZ2h0Ond9KTt0aGlzLm91dGxpbmVbZV0oe2Q6W1wiTVwiLGksRixcIkxcIixnK2ItQixGLGcrYi1CLEYrRyxcIkxcIixnK2MtQixGK0csXCJMXCIsZytjLUIsRixpK2osRl0uY29uY2F0KEEubWFza0luc2lkZT9bXCJNXCIsZytiK0IsRixcIkxcIixnK2MtQixGXTpcbltdKX0pO3RoaXMuZHJhd0hhbmRsZShiK0IsMCk7dGhpcy5kcmF3SGFuZGxlKGMrQiwxKX1pZihyJiZrKXRoaXMuZHJhd1Njcm9sbGJhckJ1dHRvbigwKSx0aGlzLmRyYXdTY3JvbGxiYXJCdXR0b24oMSksa1tlXSh7dHJhbnNsYXRlWDppLHRyYW5zbGF0ZVk6eShGK3cpfSksb1tlXSh7d2lkdGg6an0pLGc9bitiLGg9YS1ILGg8dSYmKEQ9KHUtaCkvMixoPXUsZy09RCksdGhpcy5zY3JvbGxiYXJQYWQ9RCxtW2VdKHt4OlYoZykrSCUyLzIsd2lkdGg6aH0pLHU9bitiK2EvMi0wLjUsdGhpcy5zY3JvbGxiYXJSaWZsZXMuYXR0cih7dmlzaWJpbGl0eTphPjEyP1widmlzaWJsZVwiOlwiaGlkZGVuXCJ9KVtlXSh7ZDpbXCJNXCIsdS0zLG4vNCxcIkxcIix1LTMsMipuLzMsXCJNXCIsdSxuLzQsXCJMXCIsdSwyKm4vMyxcIk1cIix1KzMsbi80LFwiTFwiLHUrMywyKm4vM119KTt0aGlzLnNjcm9sbGJhclBhZD1EO3RoaXMucmVuZGVyZWQ9ITB9fX0sYWRkRXZlbnRzOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5jaGFydC5jb250YWluZXIsXG5iPXRoaXMubW91c2VEb3duSGFuZGxlcixjPXRoaXMubW91c2VNb3ZlSGFuZGxlcixkPXRoaXMubW91c2VVcEhhbmRsZXIsZTtlPVtbYSxcIm1vdXNlZG93blwiLGJdLFthLFwibW91c2Vtb3ZlXCIsY10sW0IsXCJtb3VzZXVwXCIsZF1dO2RiJiZlLnB1c2goW2EsXCJ0b3VjaHN0YXJ0XCIsYl0sW2EsXCJ0b3VjaG1vdmVcIixjXSxbQixcInRvdWNoZW5kXCIsZF0pO24oZSxmdW5jdGlvbihhKXtELmFwcGx5KG51bGwsYSl9KTt0aGlzLl9ldmVudHM9ZX0scmVtb3ZlRXZlbnRzOmZ1bmN0aW9uKCl7bih0aGlzLl9ldmVudHMsZnVuY3Rpb24oYSl7VC5hcHBseShudWxsLGEpfSk7dGhpcy5fZXZlbnRzPXQ7dGhpcy5uYXZpZ2F0b3JFbmFibGVkJiZ0aGlzLmJhc2VTZXJpZXMmJlQodGhpcy5iYXNlU2VyaWVzLFwidXBkYXRlZERhdGFcIix0aGlzLnVwZGF0ZWREYXRhSGFuZGxlcil9LGluaXQ6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5jaGFydCxjLGQsZT1hLnNjcm9sbGJhckhlaWdodCxmPWEubmF2aWdhdG9yT3B0aW9ucyxcbmc9YS5oZWlnaHQsaD1hLnRvcCxpLGo9YS5iYXNlU2VyaWVzO2EubW91c2VEb3duSGFuZGxlcj1mdW5jdGlvbihkKXt2YXIgZD1iLnBvaW50ZXIubm9ybWFsaXplKGQpLGU9YS56b29tZWRNaW4sZj1hLnpvb21lZE1heCxoPWEudG9wLGo9YS5zY3JvbGxiYXJIZWlnaHQsaz1hLnNjcm9sbGVyTGVmdCxsPWEuc2Nyb2xsZXJXaWR0aCxuPWEubmF2aWdhdG9yTGVmdCxxPWEubmF2aWdhdG9yV2lkdGgscz1hLnNjcm9sbGJhclBhZCx0PWEucmFuZ2Usdj1kLmNoYXJ0WCx4PWQuY2hhcnRZLGQ9Yi54QXhpc1swXSx5LHo9a2I/MTA6NztpZih4PmgmJng8aCtnK2opaWYoKGg9IWEuc2Nyb2xsYmFyRW5hYmxlZHx8eDxoK2cpJiZZLmFicyh2LWUtbik8eilhLmdyYWJiZWRMZWZ0PSEwLGEub3RoZXJIYW5kbGVQb3M9ZixhLmZpeGVkRXh0cmVtZT1kLm1heCxiLmZpeGVkUmFuZ2U9bnVsbDtlbHNlIGlmKGgmJlkuYWJzKHYtZi1uKTx6KWEuZ3JhYmJlZFJpZ2h0PSEwLGEub3RoZXJIYW5kbGVQb3M9ZSxcbmEuZml4ZWRFeHRyZW1lPWQubWluLGIuZml4ZWRSYW5nZT1udWxsO2Vsc2UgaWYodj5uK2UtcyYmdjxuK2YrcylhLmdyYWJiZWRDZW50ZXI9dixhLmZpeGVkV2lkdGg9dCxpPXYtZTtlbHNlIGlmKHY+ayYmdjxrK2wpe2Y9aD92LW4tdC8yOnY8bj9lLXQqMC4yOnY+aytsLWo/ZSt0KjAuMjp2PG4rZT9lLXQ6ZjtpZihmPDApZj0wO2Vsc2UgaWYoZit0Pj1xKWY9cS10LHk9YS5nZXRVbmlvbkV4dHJlbWVzKCkuZGF0YU1heDtpZihmIT09ZSlhLmZpeGVkV2lkdGg9dCxlPWMudG9GaXhlZFJhbmdlKGYsZit0LG51bGwseSksZC5zZXRFeHRyZW1lcyhlLm1pbixlLm1heCwhMCwhMSx7dHJpZ2dlcjpcIm5hdmlnYXRvclwifSl9fTthLm1vdXNlTW92ZUhhbmRsZXI9ZnVuY3Rpb24oYyl7dmFyIGQ9YS5zY3JvbGxiYXJIZWlnaHQsZT1hLm5hdmlnYXRvckxlZnQsZj1hLm5hdmlnYXRvcldpZHRoLGc9YS5zY3JvbGxlckxlZnQsaD1hLnNjcm9sbGVyV2lkdGgsaj1hLnJhbmdlLGssbDtpZighYy50b3VjaGVzfHxcbmMudG91Y2hlc1swXS5wYWdlWCE9PTApYz1iLnBvaW50ZXIubm9ybWFsaXplKGMpLGs9Yy5jaGFydFgsazxlP2s9ZTprPmcraC1kJiYoaz1nK2gtZCksYS5ncmFiYmVkTGVmdD8obD0hMCxhLnJlbmRlcigwLDAsay1lLGEub3RoZXJIYW5kbGVQb3MpKTphLmdyYWJiZWRSaWdodD8obD0hMCxhLnJlbmRlcigwLDAsYS5vdGhlckhhbmRsZVBvcyxrLWUpKTphLmdyYWJiZWRDZW50ZXImJihsPSEwLGs8aT9rPWk6az5mK2ktaiYmKGs9ZitpLWopLGEucmVuZGVyKDAsMCxrLWksay1pK2opKSxsJiZhLnNjcm9sbGJhck9wdGlvbnMubGl2ZVJlZHJhdyYmc2V0VGltZW91dChmdW5jdGlvbigpe2EubW91c2VVcEhhbmRsZXIoYyl9LDApLGEuaGFzRHJhZ2dlZD1sfTthLm1vdXNlVXBIYW5kbGVyPWZ1bmN0aW9uKGQpe3ZhciBlLGY7aWYoYS5oYXNEcmFnZ2VkKXtpZihhLnpvb21lZE1pbj09PWEub3RoZXJIYW5kbGVQb3MpZT1hLmZpeGVkRXh0cmVtZTtlbHNlIGlmKGEuem9vbWVkTWF4PT09YS5vdGhlckhhbmRsZVBvcylmPVxuYS5maXhlZEV4dHJlbWU7aWYoYS56b29tZWRNYXg9PT1hLm5hdmlnYXRvcldpZHRoKWY9YS5nZXRVbmlvbkV4dHJlbWVzKCkuZGF0YU1heDtlPWMudG9GaXhlZFJhbmdlKGEuem9vbWVkTWluLGEuem9vbWVkTWF4LGUsZik7cyhlLm1pbikmJmIueEF4aXNbMF0uc2V0RXh0cmVtZXMoZS5taW4sZS5tYXgsITAsITEse3RyaWdnZXI6XCJuYXZpZ2F0b3JcIix0cmlnZ2VyT3A6XCJuYXZpZ2F0b3ItZHJhZ1wiLERPTUV2ZW50OmR9KX1pZihkLnR5cGUhPT1cIm1vdXNlbW92ZVwiKWEuZ3JhYmJlZExlZnQ9YS5ncmFiYmVkUmlnaHQ9YS5ncmFiYmVkQ2VudGVyPWEuZml4ZWRXaWR0aD1hLmZpeGVkRXh0cmVtZT1hLm90aGVySGFuZGxlUG9zPWEuaGFzRHJhZ2dlZD1pPW51bGx9O3ZhciBrPWIueEF4aXMubGVuZ3RoLGw9Yi55QXhpcy5sZW5ndGg7Yi5leHRyYUJvdHRvbU1hcmdpbj1hLm91dGxpbmVIZWlnaHQrZi5tYXJnaW47YS5uYXZpZ2F0b3JFbmFibGVkPyhhLnhBeGlzPWM9bmV3IEkoYixDKHticmVha3M6aiYmXG5qLnhBeGlzLm9wdGlvbnMuYnJlYWtzLG9yZGluYWw6aiYmai54QXhpcy5vcHRpb25zLm9yZGluYWx9LGYueEF4aXMse2lkOlwibmF2aWdhdG9yLXgtYXhpc1wiLGlzWDohMCx0eXBlOlwiZGF0ZXRpbWVcIixpbmRleDprLGhlaWdodDpnLG9mZnNldDowLG9mZnNldExlZnQ6ZSxvZmZzZXRSaWdodDotZSxrZWVwT3JkaW5hbFBhZGRpbmc6ITAsc3RhcnRPblRpY2s6ITEsZW5kT25UaWNrOiExLG1pblBhZGRpbmc6MCxtYXhQYWRkaW5nOjAsem9vbUVuYWJsZWQ6ITF9KSksYS55QXhpcz1kPW5ldyBJKGIsQyhmLnlBeGlzLHtpZDpcIm5hdmlnYXRvci15LWF4aXNcIixhbGlnblRpY2tzOiExLGhlaWdodDpnLG9mZnNldDowLGluZGV4Omwsem9vbUVuYWJsZWQ6ITF9KSksanx8Zi5zZXJpZXMuZGF0YT9hLmFkZEJhc2VTZXJpZXMoKTpiLnNlcmllcy5sZW5ndGg9PT0wJiZVKGIsXCJyZWRyYXdcIixmdW5jdGlvbihjLGQpe2lmKGIuc2VyaWVzLmxlbmd0aD4wJiYhYS5zZXJpZXMpYS5zZXRCYXNlU2VyaWVzKCksXG5iLnJlZHJhdz1jO2MuY2FsbChiLGQpfSkpOmEueEF4aXM9Yz17dHJhbnNsYXRlOmZ1bmN0aW9uKGEsYyl7dmFyIGQ9Yi54QXhpc1swXSxmPWQuZ2V0RXh0cmVtZXMoKSxnPWIucGxvdFdpZHRoLTIqZSxoPXhiKFwibWluXCIsZC5vcHRpb25zLm1pbixmLmRhdGFNaW4pLGQ9eGIoXCJtYXhcIixkLm9wdGlvbnMubWF4LGYuZGF0YU1heCktaDtyZXR1cm4gYz9hKmQvZytoOmcqKGEtaCkvZH0sdG9GaXhlZFJhbmdlOkkucHJvdG90eXBlLnRvRml4ZWRSYW5nZX07VShiLFwiZ2V0TWFyZ2luc1wiLGZ1bmN0aW9uKGIpe3ZhciBlPXRoaXMubGVnZW5kLGY9ZS5vcHRpb25zO2IuYXBwbHkodGhpcyxbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSk7YS50b3A9aD1hLm5hdmlnYXRvck9wdGlvbnMudG9wfHx0aGlzLmNoYXJ0SGVpZ2h0LWEuaGVpZ2h0LWEuc2Nyb2xsYmFySGVpZ2h0LXRoaXMuc3BhY2luZ1syXS0oZi52ZXJ0aWNhbEFsaWduPT09XCJib3R0b21cIiYmZi5lbmFibGVkJiYhZi5mbG9hdGluZz9lLmxlZ2VuZEhlaWdodCtcbnEoZi5tYXJnaW4sMTApOjApO2lmKGMmJmQpYy5vcHRpb25zLnRvcD1kLm9wdGlvbnMudG9wPWgsYy5zZXRBeGlzU2l6ZSgpLGQuc2V0QXhpc1NpemUoKX0pO2EuYWRkRXZlbnRzKCl9LGdldFVuaW9uRXh0cmVtZXM6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jaGFydC54QXhpc1swXSxjPXRoaXMueEF4aXMsZD1jLm9wdGlvbnMsZT1iLm9wdGlvbnMsZjtpZighYXx8Yi5kYXRhTWluIT09bnVsbClmPXtkYXRhTWluOnEoZCYmZC5taW4seGIoXCJtaW5cIixlLm1pbixiLmRhdGFNaW4sYy5kYXRhTWluKSksZGF0YU1heDpxKGQmJmQubWF4LHhiKFwibWF4XCIsZS5tYXgsYi5kYXRhTWF4LGMuZGF0YU1heCkpfTtyZXR1cm4gZn0sc2V0QmFzZVNlcmllczpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNoYXJ0LGE9YXx8Yi5vcHRpb25zLm5hdmlnYXRvci5iYXNlU2VyaWVzO3RoaXMuc2VyaWVzJiZ0aGlzLnNlcmllcy5yZW1vdmUoKTt0aGlzLmJhc2VTZXJpZXM9Yi5zZXJpZXNbYV18fHR5cGVvZiBhPT09XG5cInN0cmluZ1wiJiZiLmdldChhKXx8Yi5zZXJpZXNbMF07dGhpcy54QXhpcyYmdGhpcy5hZGRCYXNlU2VyaWVzKCl9LGFkZEJhc2VTZXJpZXM6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmJhc2VTZXJpZXMsYj1hP2Eub3B0aW9uczp7fSxjPWIuZGF0YSxkPXRoaXMubmF2aWdhdG9yT3B0aW9ucy5zZXJpZXMsZTtlPWQuZGF0YTt0aGlzLmhhc05hdmlnYXRvckRhdGE9ISFlO2I9QyhiLGQse2VuYWJsZU1vdXNlVHJhY2tpbmc6ITEsZ3JvdXA6XCJuYXZcIixwYWRYQXhpczohMSx4QXhpczpcIm5hdmlnYXRvci14LWF4aXNcIix5QXhpczpcIm5hdmlnYXRvci15LWF4aXNcIixuYW1lOlwiTmF2aWdhdG9yXCIsc2hvd0luTGVnZW5kOiExLHN0YWNraW5nOiExLGlzSW50ZXJuYWw6ITAsdmlzaWJsZTohMH0pO2IuZGF0YT1lfHxjLnNsaWNlKDApO3RoaXMuc2VyaWVzPXRoaXMuY2hhcnQuaW5pdFNlcmllcyhiKTtpZihhJiZ0aGlzLm5hdmlnYXRvck9wdGlvbnMuYWRhcHRUb1VwZGF0ZWREYXRhIT09ITEpRChhLFwidXBkYXRlZERhdGFcIixcbnRoaXMudXBkYXRlZERhdGFIYW5kbGVyKSxhLnVzZXJPcHRpb25zLmV2ZW50cz14KGEudXNlck9wdGlvbnMuZXZlbnQse3VwZGF0ZWREYXRhOnRoaXMudXBkYXRlZERhdGFIYW5kbGVyfSl9LHVwZGF0ZWREYXRhSGFuZGxlcjpmdW5jdGlvbigpe3ZhciBhPXRoaXMuY2hhcnQuc2Nyb2xsZXIsYj1hLmJhc2VTZXJpZXMsYz1iLnhBeGlzLGQ9Yy5nZXRFeHRyZW1lcygpLGU9ZC5taW4sZj1kLm1heCxnPWQuZGF0YU1pbixkPWQuZGF0YU1heCxoPWYtZSxpLGosayxsLG0sbz1hLnNlcmllcztpPW8ueERhdGE7dmFyIG49ISFjLnNldEV4dHJlbWVzO2o9Zj49aVtpLmxlbmd0aC0xXS0odGhpcy5jbG9zZXN0UG9pbnRSYW5nZXx8MCk7aT1lPD1nO2lmKCFhLmhhc05hdmlnYXRvckRhdGEpby5vcHRpb25zLnBvaW50U3RhcnQ9Yi54RGF0YVswXSxvLnNldERhdGEoYi5vcHRpb25zLmRhdGEsITEpLG09ITA7aSYmKGw9ZyxrPWwraCk7aiYmKGs9ZCxpfHwobD12KGstaCxvLnhEYXRhWzBdKSkpO24mJlxuKGl8fGopP2lzTmFOKGwpfHxjLnNldEV4dHJlbWVzKGwsaywhMCwhMSx7dHJpZ2dlcjpcInVwZGF0ZWREYXRhXCJ9KToobSYmdGhpcy5jaGFydC5yZWRyYXcoITEpLGEucmVuZGVyKHYoZSxnKSxFKGYsZCkpKX0sZGVzdHJveTpmdW5jdGlvbigpe3RoaXMucmVtb3ZlRXZlbnRzKCk7bihbdGhpcy54QXhpcyx0aGlzLnlBeGlzLHRoaXMubGVmdFNoYWRlLHRoaXMucmlnaHRTaGFkZSx0aGlzLm91dGxpbmUsdGhpcy5zY3JvbGxiYXJUcmFjayx0aGlzLnNjcm9sbGJhclJpZmxlcyx0aGlzLnNjcm9sbGJhckdyb3VwLHRoaXMuc2Nyb2xsYmFyXSxmdW5jdGlvbihhKXthJiZhLmRlc3Ryb3kmJmEuZGVzdHJveSgpfSk7dGhpcy54QXhpcz10aGlzLnlBeGlzPXRoaXMubGVmdFNoYWRlPXRoaXMucmlnaHRTaGFkZT10aGlzLm91dGxpbmU9dGhpcy5zY3JvbGxiYXJUcmFjaz10aGlzLnNjcm9sbGJhclJpZmxlcz10aGlzLnNjcm9sbGJhckdyb3VwPXRoaXMuc2Nyb2xsYmFyPW51bGw7bihbdGhpcy5zY3JvbGxiYXJCdXR0b25zLFxudGhpcy5oYW5kbGVzLHRoaXMuZWxlbWVudHNUb0Rlc3Ryb3ldLGZ1bmN0aW9uKGEpe1BhKGEpfSl9fTt6LlNjcm9sbGVyPUhiO1UoSS5wcm90b3R5cGUsXCJ6b29tXCIsZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXRoaXMuY2hhcnQsZT1kLm9wdGlvbnMsZj1lLmNoYXJ0Lnpvb21UeXBlLGc9ZS5uYXZpZ2F0b3IsZT1lLnJhbmdlU2VsZWN0b3IsaDtpZih0aGlzLmlzWEF4aXMmJihnJiZnLmVuYWJsZWR8fGUmJmUuZW5hYmxlZCkpaWYoZj09PVwieFwiKWQucmVzZXRab29tQnV0dG9uPVwiYmxvY2tlZFwiO2Vsc2UgaWYoZj09PVwieVwiKWg9ITE7ZWxzZSBpZihmPT09XCJ4eVwiKWQ9dGhpcy5wcmV2aW91c1pvb20scyhiKT90aGlzLnByZXZpb3VzWm9vbT1bdGhpcy5taW4sdGhpcy5tYXhdOmQmJihiPWRbMF0sYz1kWzFdLGRlbGV0ZSB0aGlzLnByZXZpb3VzWm9vbSk7cmV0dXJuIGghPT10P2g6YS5jYWxsKHRoaXMsYixjKX0pO1UoQ2EucHJvdG90eXBlLFwiaW5pdFwiLGZ1bmN0aW9uKGEsYixjKXtEKHRoaXMsXG5cImJlZm9yZVJlbmRlclwiLGZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcHRpb25zO2lmKGEubmF2aWdhdG9yLmVuYWJsZWR8fGEuc2Nyb2xsYmFyLmVuYWJsZWQpdGhpcy5zY3JvbGxlcj1uZXcgSGIodGhpcyl9KTthLmNhbGwodGhpcyxiLGMpfSk7VShRLnByb3RvdHlwZSxcImFkZFBvaW50XCIsZnVuY3Rpb24oYSxiLGMsZCxlKXt2YXIgZj10aGlzLm9wdGlvbnMudHVyYm9UaHJlc2hvbGQ7ZiYmdGhpcy54RGF0YS5sZW5ndGg+ZiYmZGEoYikmJiFKYShiKSYmdGhpcy5jaGFydC5zY3JvbGxlciYmZ2EoMjAsITApO2EuY2FsbCh0aGlzLGIsYyxkLGUpfSk7eChOLHtyYW5nZVNlbGVjdG9yOntidXR0b25UaGVtZTp7d2lkdGg6MjgsaGVpZ2h0OjE4LGZpbGw6XCIjZjdmN2Y3XCIscGFkZGluZzoyLHI6MCxcInN0cm9rZS13aWR0aFwiOjAsc3R5bGU6e2NvbG9yOlwiIzQ0NFwiLGN1cnNvcjpcInBvaW50ZXJcIixmb250V2VpZ2h0Olwibm9ybWFsXCJ9LHpJbmRleDo3LHN0YXRlczp7aG92ZXI6e2ZpbGw6XCIjZTdlN2U3XCJ9LFxuc2VsZWN0OntmaWxsOlwiI2U3ZjBmOVwiLHN0eWxlOntjb2xvcjpcImJsYWNrXCIsZm9udFdlaWdodDpcImJvbGRcIn19fX0saGVpZ2h0OjM1LGlucHV0UG9zaXRpb246e2FsaWduOlwicmlnaHRcIn0sbGFiZWxTdHlsZTp7Y29sb3I6XCIjNjY2XCJ9fX0pO04ubGFuZz1DKE4ubGFuZyx7cmFuZ2VTZWxlY3Rvclpvb206XCJab29tXCIscmFuZ2VTZWxlY3RvckZyb206XCJGcm9tXCIscmFuZ2VTZWxlY3RvclRvOlwiVG9cIn0pO0liLnByb3RvdHlwZT17Y2xpY2tCdXR0b246ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLGQ9Yy5zZWxlY3RlZCxlPWMuY2hhcnQsZj1jLmJ1dHRvbnMsZz1jLmJ1dHRvbk9wdGlvbnNbYV0saD1lLnhBeGlzWzBdLGk9ZS5zY3JvbGxlciYmZS5zY3JvbGxlci5nZXRVbmlvbkV4dHJlbWVzKCl8fGh8fHt9LGo9aS5kYXRhTWluLGs9aS5kYXRhTWF4LGwsbT1oJiZ5KEUoaC5tYXgscShrLGgubWF4KSkpLG89Zy50eXBlLHAsaT1nLl9yYW5nZSxyLHMseCx1PWcuZGF0YUdyb3VwaW5nO2lmKCEoaj09PVxubnVsbHx8az09PW51bGx8fGE9PT1jLnNlbGVjdGVkKSl7ZS5maXhlZFJhbmdlPWk7aWYodSl0aGlzLmZvcmNlZERhdGFHcm91cGluZz0hMCxJLnByb3RvdHlwZS5zZXREYXRhR3JvdXBpbmcuY2FsbChofHx7Y2hhcnQ6dGhpcy5jaGFydH0sdSwhMSk7aWYobz09PVwibW9udGhcInx8bz09PVwieWVhclwiKWlmKGgpe2lmKG89e3JhbmdlOmcsbWF4Om0sZGF0YU1pbjpqLGRhdGFNYXg6a30sbD1oLm1pbkZyb21SYW5nZS5jYWxsKG8pLHR5cGVvZiBvLm5ld01heD09PVwibnVtYmVyXCIpbT1vLm5ld01heH1lbHNlIGk9ZztlbHNlIGlmKGkpbD12KG0taSxqKSxtPUUobCtpLGspO2Vsc2UgaWYobz09PVwieXRkXCIpaWYoaCl7aWYoaz09PXQpaj1OdW1iZXIuTUFYX1ZBTFVFLGs9TnVtYmVyLk1JTl9WQUxVRSxuKGUuc2VyaWVzLGZ1bmN0aW9uKGEpe2E9YS54RGF0YTtqPUUoYVswXSxqKTtrPXYoYVthLmxlbmd0aC0xXSxrKX0pLGI9ITE7bT1uZXcgZmEoayk7bD1tLmdldEZ1bGxZZWFyKCk7bD1yPXYoanx8XG4wLGZhLlVUQyhsLDAsMSkpO209bS5nZXRUaW1lKCk7bT1FKGt8fG0sbSl9ZWxzZXtEKGUsXCJiZWZvcmVSZW5kZXJcIixmdW5jdGlvbigpe2MuY2xpY2tCdXR0b24oYSl9KTtyZXR1cm59ZWxzZSBvPT09XCJhbGxcIiYmaCYmKGw9aixtPWspO2ZbZF0mJmZbZF0uc2V0U3RhdGUoMCk7aWYoZlthXSlmW2FdLnNldFN0YXRlKDIpLGMubGFzdFNlbGVjdGVkPWE7aD8oaC5zZXRFeHRyZW1lcyhsLG0scShiLDEpLDAse3RyaWdnZXI6XCJyYW5nZVNlbGVjdG9yQnV0dG9uXCIscmFuZ2VTZWxlY3RvckJ1dHRvbjpnfSksYy5zZXRTZWxlY3RlZChhKSk6KHA9ZS5vcHRpb25zLnhBeGlzWzBdLHg9cC5yYW5nZSxwLnJhbmdlPWkscz1wLm1pbixwLm1pbj1yLGMuc2V0U2VsZWN0ZWQoYSksRChlLFwibG9hZFwiLGZ1bmN0aW9uKCl7cC5yYW5nZT14O3AubWluPXN9KSl9fSxzZXRTZWxlY3RlZDpmdW5jdGlvbihhKXt0aGlzLnNlbGVjdGVkPXRoaXMub3B0aW9ucy5zZWxlY3RlZD1hfSxkZWZhdWx0QnV0dG9uczpbe3R5cGU6XCJtb250aFwiLFxuY291bnQ6MSx0ZXh0OlwiMW1cIn0se3R5cGU6XCJtb250aFwiLGNvdW50OjMsdGV4dDpcIjNtXCJ9LHt0eXBlOlwibW9udGhcIixjb3VudDo2LHRleHQ6XCI2bVwifSx7dHlwZTpcInl0ZFwiLHRleHQ6XCJZVERcIn0se3R5cGU6XCJ5ZWFyXCIsY291bnQ6MSx0ZXh0OlwiMXlcIn0se3R5cGU6XCJhbGxcIix0ZXh0OlwiQWxsXCJ9XSxpbml0OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMsYz1hLm9wdGlvbnMucmFuZ2VTZWxlY3RvcixkPWMuYnV0dG9uc3x8W10uY29uY2F0KGIuZGVmYXVsdEJ1dHRvbnMpLGU9Yy5zZWxlY3RlZCxmPWIuYmx1cklucHV0cz1mdW5jdGlvbigpe3ZhciBhPWIubWluSW5wdXQsYz1iLm1heElucHV0O2EmJmEuYmx1ciYmTShhLFwiYmx1clwiKTtjJiZjLmJsdXImJk0oYyxcImJsdXJcIil9O2IuY2hhcnQ9YTtiLm9wdGlvbnM9YztiLmJ1dHRvbnM9W107YS5leHRyYVRvcE1hcmdpbj1jLmhlaWdodDtiLmJ1dHRvbk9wdGlvbnM9ZDtEKGEuY29udGFpbmVyLFwibW91c2Vkb3duXCIsZik7RChhLFwicmVzaXplXCIsZik7XG5uKGQsYi5jb21wdXRlQnV0dG9uUmFuZ2UpO2UhPT10JiZkW2VdJiZ0aGlzLmNsaWNrQnV0dG9uKGUsITEpO0QoYSxcImxvYWRcIixmdW5jdGlvbigpe0QoYS54QXhpc1swXSxcInNldEV4dHJlbWVzXCIsZnVuY3Rpb24oYyl7dGhpcy5tYXgtdGhpcy5taW4hPT1hLmZpeGVkUmFuZ2UmJmMudHJpZ2dlciE9PVwicmFuZ2VTZWxlY3RvckJ1dHRvblwiJiZjLnRyaWdnZXIhPT1cInVwZGF0ZWREYXRhXCImJmIuZm9yY2VkRGF0YUdyb3VwaW5nJiZ0aGlzLnNldERhdGFHcm91cGluZyghMSwhMSl9KTtEKGEueEF4aXNbMF0sXCJhZnRlclNldEV4dHJlbWVzXCIsZnVuY3Rpb24oKXtiLnVwZGF0ZUJ1dHRvblN0YXRlcyghMCl9KX0pfSx1cGRhdGVCdXR0b25TdGF0ZXM6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcyxjPXRoaXMuY2hhcnQsZD1jLnhBeGlzWzBdLGU9Yy5zY3JvbGxlciYmYy5zY3JvbGxlci5nZXRVbmlvbkV4dHJlbWVzKCl8fGQsZj1lLmRhdGFNaW4sZz1lLmRhdGFNYXgsaD1iLnNlbGVjdGVkLGk9Yi5vcHRpb25zLmFsbEJ1dHRvbnNFbmFibGVkLFxuaj1iLmJ1dHRvbnM7YSYmYy5maXhlZFJhbmdlIT09eShkLm1heC1kLm1pbikmJihqW2hdJiZqW2hdLnNldFN0YXRlKDApLGIuc2V0U2VsZWN0ZWQobnVsbCkpO24oYi5idXR0b25PcHRpb25zLGZ1bmN0aW9uKGEsZSl7dmFyIG09eShkLm1heC1kLm1pbiksbz1hLl9yYW5nZSxuPWEudHlwZSxxPWEuY291bnR8fDEscz1vPmctZix0PW88ZC5taW5SYW5nZSx1PWEudHlwZT09PVwiYWxsXCImJmQubWF4LWQubWluPj1nLWYmJmpbZV0uc3RhdGUhPT0yLHc9YS50eXBlPT09XCJ5dGRcIiYmbWEoXCIlWVwiLGYpPT09bWEoXCIlWVwiLGcpLHY9Yy5yZW5kZXJlci5mb3JFeHBvcnQmJmU9PT1oLG89bz09PW0seD0hZC5oYXNWaXNpYmxlU2VyaWVzO2lmKChuPT09XCJtb250aFwifHxuPT09XCJ5ZWFyXCIpJiZtPj17bW9udGg6MjgseWVhcjozNjV9W25dKjg2NEU1KnEmJm08PXttb250aDozMSx5ZWFyOjM2Nn1bbl0qODY0RTUqcSlvPSEwO3Z8fG8mJmUhPT1oJiZlPT09Yi5sYXN0U2VsZWN0ZWQ/KGIuc2V0U2VsZWN0ZWQoZSksXG5qW2VdLnNldFN0YXRlKDIpKTohaSYmKHN8fHR8fHV8fHd8fHgpP2pbZV0uc2V0U3RhdGUoMyk6altlXS5zdGF0ZT09PTMmJmpbZV0uc2V0U3RhdGUoMCl9KX0sY29tcHV0ZUJ1dHRvblJhbmdlOmZ1bmN0aW9uKGEpe3ZhciBiPWEudHlwZSxjPWEuY291bnR8fDEsZD17bWlsbGlzZWNvbmQ6MSxzZWNvbmQ6MUUzLG1pbnV0ZTo2RTQsaG91cjozNkU1LGRheTo4NjRFNSx3ZWVrOjYwNDhFNX07aWYoZFtiXSlhLl9yYW5nZT1kW2JdKmM7ZWxzZSBpZihiPT09XCJtb250aFwifHxiPT09XCJ5ZWFyXCIpYS5fcmFuZ2U9e21vbnRoOjMwLHllYXI6MzY1fVtiXSo4NjRFNSpjfSxzZXRJbnB1dFZhbHVlOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5jaGFydC5vcHRpb25zLnJhbmdlU2VsZWN0b3I7aWYocyhiKSl0aGlzW2ErXCJJbnB1dFwiXS5IQ1RpbWU9Yjt0aGlzW2ErXCJJbnB1dFwiXS52YWx1ZT1tYShjLmlucHV0RWRpdERhdGVGb3JtYXR8fFwiJVktJW0tJWRcIix0aGlzW2ErXCJJbnB1dFwiXS5IQ1RpbWUpO3RoaXNbYStcblwiRGF0ZUJveFwiXS5hdHRyKHt0ZXh0Om1hKGMuaW5wdXREYXRlRm9ybWF0fHxcIiViICVlLCAlWVwiLHRoaXNbYStcIklucHV0XCJdLkhDVGltZSl9KX0sc2hvd0lucHV0OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuaW5wdXRHcm91cCxjPXRoaXNbYStcIkRhdGVCb3hcIl07Rih0aGlzW2ErXCJJbnB1dFwiXSx7bGVmdDpiLnRyYW5zbGF0ZVgrYy54K1wicHhcIix0b3A6Yi50cmFuc2xhdGVZK1wicHhcIix3aWR0aDpjLndpZHRoLTIrXCJweFwiLGhlaWdodDpjLmhlaWdodC0yK1wicHhcIixib3JkZXI6XCIycHggc29saWQgc2lsdmVyXCJ9KX0saGlkZUlucHV0OmZ1bmN0aW9uKGEpe0YodGhpc1thK1wiSW5wdXRcIl0se2JvcmRlcjowLHdpZHRoOlwiMXB4XCIsaGVpZ2h0OlwiMXB4XCJ9KTt0aGlzLnNldElucHV0VmFsdWUoYSl9LGRyYXdJbnB1dDpmdW5jdGlvbihhKXtmdW5jdGlvbiBiKCl7dmFyIGE9ai52YWx1ZSxiPShnLmlucHV0RGF0ZVBhcnNlcnx8ZmEucGFyc2UpKGEpLGU9ZC54QXhpc1swXSxmPWUuZGF0YU1pbixoPWUuZGF0YU1heDtcbmlmKGIhPT1qLnByZXZpb3VzVmFsdWUpai5wcmV2aW91c1ZhbHVlPWIsaXNOYU4oYikmJihiPWEuc3BsaXQoXCItXCIpLGI9ZmEuVVRDKEcoYlswXSksRyhiWzFdKS0xLEcoYlsyXSkpKSxpc05hTihiKXx8KE4uZ2xvYmFsLnVzZVVUQ3x8KGIrPShuZXcgZmEpLmdldFRpbWV6b25lT2Zmc2V0KCkqNkU0KSxpP2I+Yy5tYXhJbnB1dC5IQ1RpbWU/Yj10OmI8ZiYmKGI9Zik6YjxjLm1pbklucHV0LkhDVGltZT9iPXQ6Yj5oJiYoYj1oKSxiIT09dCYmZC54QXhpc1swXS5zZXRFeHRyZW1lcyhpP2I6ZS5taW4saT9lLm1heDpiLHQsdCx7dHJpZ2dlcjpcInJhbmdlU2VsZWN0b3JJbnB1dFwifSkpfXZhciBjPXRoaXMsZD1jLmNoYXJ0LGU9ZC5yZW5kZXJlci5zdHlsZSxmPWQucmVuZGVyZXIsZz1kLm9wdGlvbnMucmFuZ2VTZWxlY3RvcixoPWMuZGl2LGk9YT09PVwibWluXCIsaixrLGw9dGhpcy5pbnB1dEdyb3VwO3RoaXNbYStcIkxhYmVsXCJdPWs9Zi5sYWJlbChOLmxhbmdbaT9cInJhbmdlU2VsZWN0b3JGcm9tXCI6XG5cInJhbmdlU2VsZWN0b3JUb1wiXSx0aGlzLmlucHV0R3JvdXAub2Zmc2V0KS5hdHRyKHtwYWRkaW5nOjJ9KS5jc3MoQyhlLGcubGFiZWxTdHlsZSkpLmFkZChsKTtsLm9mZnNldCs9ay53aWR0aCs1O3RoaXNbYStcIkRhdGVCb3hcIl09Zj1mLmxhYmVsKFwiXCIsbC5vZmZzZXQpLmF0dHIoe3BhZGRpbmc6Mix3aWR0aDpnLmlucHV0Qm94V2lkdGh8fDkwLGhlaWdodDpnLmlucHV0Qm94SGVpZ2h0fHwxNyxzdHJva2U6Zy5pbnB1dEJveEJvcmRlckNvbG9yfHxcInNpbHZlclwiLFwic3Ryb2tlLXdpZHRoXCI6MX0pLmNzcyhDKHt0ZXh0QWxpZ246XCJjZW50ZXJcIixjb2xvcjpcIiM0NDRcIn0sZSxnLmlucHV0U3R5bGUpKS5vbihcImNsaWNrXCIsZnVuY3Rpb24oKXtjLnNob3dJbnB1dChhKTtjW2ErXCJJbnB1dFwiXS5mb2N1cygpfSkuYWRkKGwpO2wub2Zmc2V0Kz1mLndpZHRoKyhpPzEwOjApO3RoaXNbYStcIklucHV0XCJdPWo9ZWEoXCJpbnB1dFwiLHtuYW1lOmEsY2xhc3NOYW1lOlwiaGlnaGNoYXJ0cy1yYW5nZS1zZWxlY3RvclwiLFxudHlwZTpcInRleHRcIn0seCh7cG9zaXRpb246XCJhYnNvbHV0ZVwiLGJvcmRlcjowLHdpZHRoOlwiMXB4XCIsaGVpZ2h0OlwiMXB4XCIscGFkZGluZzowLHRleHRBbGlnbjpcImNlbnRlclwiLGZvbnRTaXplOmUuZm9udFNpemUsZm9udEZhbWlseTplLmZvbnRGYW1pbHksbGVmdDpcIi05ZW1cIix0b3A6ZC5wbG90VG9wK1wicHhcIn0sZy5pbnB1dFN0eWxlKSxoKTtqLm9uZm9jdXM9ZnVuY3Rpb24oKXtjLnNob3dJbnB1dChhKX07ai5vbmJsdXI9ZnVuY3Rpb24oKXtjLmhpZGVJbnB1dChhKX07ai5vbmNoYW5nZT1iO2oub25rZXlwcmVzcz1mdW5jdGlvbihhKXthLmtleUNvZGU9PT0xMyYmYigpfX0sZ2V0UG9zaXRpb246ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmNoYXJ0LGI9YS5vcHRpb25zLnJhbmdlU2VsZWN0b3IsYT1xKChiLmJ1dHRvblBvc2l0aW9ufHx7fSkueSxhLnBsb3RUb3AtYS5heGlzT2Zmc2V0WzBdLWIuaGVpZ2h0KTtyZXR1cm57YnV0dG9uVG9wOmEsaW5wdXRUb3A6YS0xMH19LHJlbmRlcjpmdW5jdGlvbihhLFxuYil7dmFyIGM9dGhpcyxkPWMuY2hhcnQsZT1kLnJlbmRlcmVyLGY9ZC5jb250YWluZXIsZz1kLm9wdGlvbnMsaD1nLmV4cG9ydGluZyYmZy5leHBvcnRpbmcuZW5hYmxlZCE9PSExJiZnLm5hdmlnYXRpb24mJmcubmF2aWdhdGlvbi5idXR0b25PcHRpb25zLGk9Zy5yYW5nZVNlbGVjdG9yLGo9Yy5idXR0b25zLGc9Ti5sYW5nLGs9Yy5kaXYsaz1jLmlucHV0R3JvdXAsbD1pLmJ1dHRvblRoZW1lLG09aS5idXR0b25Qb3NpdGlvbnx8e30sbz1pLmlucHV0RW5hYmxlZCxwPWwmJmwuc3RhdGVzLHI9ZC5wbG90TGVmdCx0LHY9dGhpcy5nZXRQb3NpdGlvbigpLHU9Yy5ncm91cCx3PWMucmVuZGVyZWQ7aWYoIXcmJihjLmdyb3VwPXU9ZS5nKFwicmFuZ2Utc2VsZWN0b3ItYnV0dG9uc1wiKS5hZGQoKSxjLnpvb21UZXh0PWUudGV4dChnLnJhbmdlU2VsZWN0b3Jab29tLHEobS54LHIpLDE1KS5jc3MoaS5sYWJlbFN0eWxlKS5hZGQodSksdD1xKG0ueCxyKStjLnpvb21UZXh0LmdldEJCb3goKS53aWR0aCtcbjUsbihjLmJ1dHRvbk9wdGlvbnMsZnVuY3Rpb24oYSxiKXtqW2JdPWUuYnV0dG9uKGEudGV4dCx0LDAsZnVuY3Rpb24oKXtjLmNsaWNrQnV0dG9uKGIpO2MuaXNBY3RpdmU9ITB9LGwscCYmcC5ob3ZlcixwJiZwLnNlbGVjdCxwJiZwLmRpc2FibGVkKS5jc3Moe3RleHRBbGlnbjpcImNlbnRlclwifSkuYWRkKHUpO3QrPWpbYl0ud2lkdGgrcShpLmJ1dHRvblNwYWNpbmcsNSk7Yy5zZWxlY3RlZD09PWImJmpbYl0uc2V0U3RhdGUoMil9KSxjLnVwZGF0ZUJ1dHRvblN0YXRlcygpLG8hPT0hMSkpYy5kaXY9az1lYShcImRpdlwiLG51bGwse3Bvc2l0aW9uOlwicmVsYXRpdmVcIixoZWlnaHQ6MCx6SW5kZXg6MX0pLGYucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoayxmKSxjLmlucHV0R3JvdXA9az1lLmcoXCJpbnB1dC1ncm91cFwiKS5hZGQoKSxrLm9mZnNldD0wLGMuZHJhd0lucHV0KFwibWluXCIpLGMuZHJhd0lucHV0KFwibWF4XCIpO3Vbdz9cImFuaW1hdGVcIjpcImF0dHJcIl0oe3RyYW5zbGF0ZVk6di5idXR0b25Ub3B9KTtcbm8hPT0hMSYmKGsuYWxpZ24oeCh7eTp2LmlucHV0VG9wLHdpZHRoOmsub2Zmc2V0LHg6aCYmdi5pbnB1dFRvcDwoaC55fHwwKStoLmhlaWdodC1kLnNwYWNpbmdbMF0/LTQwOjB9LGkuaW5wdXRQb3NpdGlvbiksITAsZC5zcGFjaW5nQm94KSxzKG8pfHwoZD11LmdldEJCb3goKSxrW2sudHJhbnNsYXRlWDxkLngrZC53aWR0aCsxMD9cImhpZGVcIjpcInNob3dcIl0oKSksYy5zZXRJbnB1dFZhbHVlKFwibWluXCIsYSksYy5zZXRJbnB1dFZhbHVlKFwibWF4XCIsYikpO2MucmVuZGVyZWQ9ITB9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm1pbklucHV0LGI9dGhpcy5tYXhJbnB1dCxjPXRoaXMuY2hhcnQsZD10aGlzLmJsdXJJbnB1dHMsZTtUKGMuY29udGFpbmVyLFwibW91c2Vkb3duXCIsZCk7VChjLFwicmVzaXplXCIsZCk7UGEodGhpcy5idXR0b25zKTtpZihhKWEub25mb2N1cz1hLm9uYmx1cj1hLm9uY2hhbmdlPW51bGw7aWYoYiliLm9uZm9jdXM9Yi5vbmJsdXI9Yi5vbmNoYW5nZT1udWxsO1xuZm9yKGUgaW4gdGhpcyl0aGlzW2VdJiZlIT09XCJjaGFydFwiJiYodGhpc1tlXS5kZXN0cm95P3RoaXNbZV0uZGVzdHJveSgpOnRoaXNbZV0ubm9kZVR5cGUmJlZhKHRoaXNbZV0pKSx0aGlzW2VdPW51bGx9fTtJLnByb3RvdHlwZS50b0ZpeGVkUmFuZ2U9ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9dGhpcy5jaGFydCYmdGhpcy5jaGFydC5maXhlZFJhbmdlLGE9cShjLHRoaXMudHJhbnNsYXRlKGEsITApKSxiPXEoZCx0aGlzLnRyYW5zbGF0ZShiLCEwKSksYz1lJiYoYi1hKS9lO2M+MC43JiZjPDEuMyYmKGQ/YT1iLWU6Yj1hK2UpO2lzTmFOKGEpJiYoYT1iPXZvaWQgMCk7cmV0dXJue21pbjphLG1heDpifX07SS5wcm90b3R5cGUubWluRnJvbVJhbmdlPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5yYW5nZSxiPXttb250aDpcIk1vbnRoXCIseWVhcjpcIkZ1bGxZZWFyXCJ9W2EudHlwZV0sYyxkPXRoaXMubWF4LGUsZixnPWZ1bmN0aW9uKGEsYyl7dmFyIGQ9bmV3IGZhKGEpO2RbXCJzZXRcIitiXShkW1wiZ2V0XCIrXG5iXSgpK2MpO3JldHVybiBkLmdldFRpbWUoKS1hfTt0eXBlb2YgYT09PVwibnVtYmVyXCI/KGM9dGhpcy5tYXgtYSxmPWEpOmM9ZCtnKGQsLWEuY291bnQpO2U9cSh0aGlzLmRhdGFNaW4sTnVtYmVyLk1JTl9WQUxVRSk7aXNOYU4oYykmJihjPWUpO2lmKGM8PWUpYz1lLGY9PT12b2lkIDAmJihmPWcoYyxhLmNvdW50KSksdGhpcy5uZXdNYXg9RShjK2YsdGhpcy5kYXRhTWF4KTtpc05hTihkKSYmKGM9dm9pZCAwKTtyZXR1cm4gY307VShDYS5wcm90b3R5cGUsXCJpbml0XCIsZnVuY3Rpb24oYSxiLGMpe0QodGhpcyxcImluaXRcIixmdW5jdGlvbigpe2lmKHRoaXMub3B0aW9ucy5yYW5nZVNlbGVjdG9yLmVuYWJsZWQpdGhpcy5yYW5nZVNlbGVjdG9yPW5ldyBJYih0aGlzKX0pO2EuY2FsbCh0aGlzLGIsYyl9KTt6LlJhbmdlU2VsZWN0b3I9SWI7Q2EucHJvdG90eXBlLmNhbGxiYWNrcy5wdXNoKGZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoKXtmPWEueEF4aXNbMF0uZ2V0RXh0cmVtZXMoKTtnLnJlbmRlcihmLm1pbixcbmYubWF4KX1mdW5jdGlvbiBjKCl7Zj1hLnhBeGlzWzBdLmdldEV4dHJlbWVzKCk7aXNOYU4oZi5taW4pfHxoLnJlbmRlcihmLm1pbixmLm1heCl9ZnVuY3Rpb24gZChhKXthLnRyaWdnZXJPcCE9PVwibmF2aWdhdG9yLWRyYWdcIiYmZy5yZW5kZXIoYS5taW4sYS5tYXgpfWZ1bmN0aW9uIGUoYSl7aC5yZW5kZXIoYS5taW4sYS5tYXgpfXZhciBmLGc9YS5zY3JvbGxlcixoPWEucmFuZ2VTZWxlY3RvcjtnJiYoRChhLnhBeGlzWzBdLFwiYWZ0ZXJTZXRFeHRyZW1lc1wiLGQpLFUoYSxcImRyYXdDaGFydEJveFwiLGZ1bmN0aW9uKGEpe3ZhciBjPXRoaXMuaXNEaXJ0eUJveDthLmNhbGwodGhpcyk7YyYmYigpfSksYigpKTtoJiYoRChhLnhBeGlzWzBdLFwiYWZ0ZXJTZXRFeHRyZW1lc1wiLGUpLEQoYSxcInJlc2l6ZVwiLGMpLGMoKSk7RChhLFwiZGVzdHJveVwiLGZ1bmN0aW9uKCl7ZyYmVChhLnhBeGlzWzBdLFwiYWZ0ZXJTZXRFeHRyZW1lc1wiLGQpO2gmJihUKGEsXCJyZXNpemVcIixjKSxUKGEueEF4aXNbMF0sXCJhZnRlclNldEV4dHJlbWVzXCIsXG5lKSl9KX0pO3ouU3RvY2tDaGFydD16LnN0b2NrQ2hhcnQ9ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPURhKGEpfHxhLm5vZGVOYW1lLGU9YXJndW1lbnRzW2Q/MTowXSxmPWUuc2VyaWVzLGcsaD1xKGUubmF2aWdhdG9yJiZlLm5hdmlnYXRvci5lbmFibGVkLCEwKT97c3RhcnRPblRpY2s6ITEsZW5kT25UaWNrOiExfTpudWxsLGk9e21hcmtlcjp7ZW5hYmxlZDohMSxyYWRpdXM6Mn19LGo9e3NoYWRvdzohMSxib3JkZXJXaWR0aDowfTtlLnhBeGlzPXRhKHZhKGUueEF4aXN8fHt9KSxmdW5jdGlvbihhKXtyZXR1cm4gQyh7bWluUGFkZGluZzowLG1heFBhZGRpbmc6MCxvcmRpbmFsOiEwLHRpdGxlOnt0ZXh0Om51bGx9LGxhYmVsczp7b3ZlcmZsb3c6XCJqdXN0aWZ5XCJ9LHNob3dMYXN0TGFiZWw6ITB9LGEse3R5cGU6XCJkYXRldGltZVwiLGNhdGVnb3JpZXM6bnVsbH0saCl9KTtlLnlBeGlzPXRhKHZhKGUueUF4aXN8fHt9KSxmdW5jdGlvbihhKXtnPXEoYS5vcHBvc2l0ZSwhMCk7cmV0dXJuIEMoe2xhYmVsczp7eTotMn0sXG5vcHBvc2l0ZTpnLHNob3dMYXN0TGFiZWw6ITEsdGl0bGU6e3RleHQ6bnVsbH19LGEpfSk7ZS5zZXJpZXM9bnVsbDtlPUMoe2NoYXJ0OntwYW5uaW5nOiEwLHBpbmNoVHlwZTpcInhcIn0sbmF2aWdhdG9yOntlbmFibGVkOiEwfSxzY3JvbGxiYXI6e2VuYWJsZWQ6ITB9LHJhbmdlU2VsZWN0b3I6e2VuYWJsZWQ6ITB9LHRpdGxlOnt0ZXh0Om51bGwsc3R5bGU6e2ZvbnRTaXplOlwiMTZweFwifX0sdG9vbHRpcDp7c2hhcmVkOiEwLGNyb3NzaGFpcnM6ITB9LGxlZ2VuZDp7ZW5hYmxlZDohMX0scGxvdE9wdGlvbnM6e2xpbmU6aSxzcGxpbmU6aSxhcmVhOmksYXJlYXNwbGluZTppLGFyZWFyYW5nZTppLGFyZWFzcGxpbmVyYW5nZTppLGNvbHVtbjpqLGNvbHVtbnJhbmdlOmosY2FuZGxlc3RpY2s6aixvaGxjOmp9fSxlLHtfc3RvY2s6ITAsY2hhcnQ6e2ludmVydGVkOiExfX0pO2Uuc2VyaWVzPWY7cmV0dXJuIGQ/bmV3IENhKGEsZSxjKTpuZXcgQ2EoZSxiKX07VShaYS5wcm90b3R5cGUsXCJpbml0XCIsXG5mdW5jdGlvbihhLGIsYyl7dmFyIGQ9Yy5jaGFydC5waW5jaFR5cGV8fFwiXCI7YS5jYWxsKHRoaXMsYixjKTt0aGlzLnBpbmNoWD10aGlzLnBpbmNoSG9yPWQuaW5kZXhPZihcInhcIikhPT0tMTt0aGlzLnBpbmNoWT10aGlzLnBpbmNoVmVydD1kLmluZGV4T2YoXCJ5XCIpIT09LTE7dGhpcy5oYXNab29tPXRoaXMuaGFzWm9vbXx8dGhpcy5waW5jaEhvcnx8dGhpcy5waW5jaFZlcnR9KTtVKEkucHJvdG90eXBlLFwiYXV0b0xhYmVsQWxpZ25cIixmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNoYXJ0LGM9dGhpcy5vcHRpb25zLGI9Yi5fbGFiZWxQYW5lcz1iLl9sYWJlbFBhbmVzfHx7fSxkPXRoaXMub3B0aW9ucy5sYWJlbHM7aWYodGhpcy5jaGFydC5vcHRpb25zLl9zdG9jayYmdGhpcy5jb2xsPT09XCJ5QXhpc1wiJiYoYz1jLnRvcCtcIixcIitjLmhlaWdodCwhYltjXSYmZC5lbmFibGVkKSl7aWYoZC54PT09MTUpZC54PTA7aWYoZC5hbGlnbj09PXZvaWQgMClkLmFsaWduPVwicmlnaHRcIjtiW2NdPTE7cmV0dXJuXCJyaWdodFwifXJldHVybiBhLmNhbGwodGhpcyxcbltdLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpKX0pO1UoSS5wcm90b3R5cGUsXCJnZXRQbG90TGluZVBhdGhcIixmdW5jdGlvbihhLGIsYyxkLGUsZil7dmFyIGc9dGhpcyxoPXRoaXMuaXNMaW5rZWQmJiF0aGlzLnNlcmllcz90aGlzLmxpbmtlZFBhcmVudC5zZXJpZXM6dGhpcy5zZXJpZXMsaT1nLmNoYXJ0LGo9aS5yZW5kZXJlcixrPWcubGVmdCxsPWcudG9wLG0sbyxwLHIsdD1bXSx4PVtdLHUsdztpZihnLmNvbGw9PT1cImNvbG9yQXhpc1wiKXJldHVybiBhLmFwcGx5KHRoaXMsW10uc2xpY2UuY2FsbChhcmd1bWVudHMsMSkpO3g9Zy5pc1hBeGlzP3MoZy5vcHRpb25zLnlBeGlzKT9baS55QXhpc1tnLm9wdGlvbnMueUF4aXNdXTp0YShoLGZ1bmN0aW9uKGEpe3JldHVybiBhLnlBeGlzfSk6cyhnLm9wdGlvbnMueEF4aXMpP1tpLnhBeGlzW2cub3B0aW9ucy54QXhpc11dOnRhKGgsZnVuY3Rpb24oYSl7cmV0dXJuIGEueEF4aXN9KTtuKGcuaXNYQXhpcz9pLnlBeGlzOmkueEF4aXMsZnVuY3Rpb24oYSl7aWYocyhhLm9wdGlvbnMuaWQpP1xuYS5vcHRpb25zLmlkLmluZGV4T2YoXCJuYXZpZ2F0b3JcIik9PT0tMToxKXt2YXIgYj1hLmlzWEF4aXM/XCJ5QXhpc1wiOlwieEF4aXNcIixiPXMoYS5vcHRpb25zW2JdKT9pW2JdW2Eub3B0aW9uc1tiXV06aVtiXVswXTtnPT09YiYmeC5wdXNoKGEpfX0pO3U9eC5sZW5ndGg/W106W2cuaXNYQXhpcz9pLnlBeGlzWzBdOmkueEF4aXNbMF1dO24oeCxmdW5jdGlvbihhKXtzYShhLHUpPT09LTEmJnUucHVzaChhKX0pO3c9cShmLGcudHJhbnNsYXRlKGIsbnVsbCxudWxsLGQpKTtpc05hTih3KXx8KGcuaG9yaXo/bih1LGZ1bmN0aW9uKGEpe3ZhciBiO289YS5wb3M7cj1vK2EubGVuO209cD15KHcrZy50cmFuc0IpO2lmKG08a3x8bT5rK2cud2lkdGgpZT9tPXA9RSh2KGssbSksaytnLndpZHRoKTpiPSEwO2J8fHQucHVzaChcIk1cIixtLG8sXCJMXCIscCxyKX0pOm4odSxmdW5jdGlvbihhKXt2YXIgYjttPWEucG9zO3A9bSthLmxlbjtvPXI9eShsK2cuaGVpZ2h0LXcpO2lmKG88bHx8bz5sK2cuaGVpZ2h0KWU/XG5vPXI9RSh2KGwsbyksZy50b3ArZy5oZWlnaHQpOmI9ITA7Ynx8dC5wdXNoKFwiTVwiLG0sbyxcIkxcIixwLHIpfSkpO3JldHVybiB0Lmxlbmd0aD4wP2ouY3Jpc3BQb2x5TGluZSh0LGN8fDEpOm51bGx9KTtJLnByb3RvdHlwZS5nZXRQbG90QmFuZFBhdGg9ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmdldFBsb3RMaW5lUGF0aChiLG51bGwsbnVsbCwhMCksZD10aGlzLmdldFBsb3RMaW5lUGF0aChhLG51bGwsbnVsbCwhMCksZT1bXSxmO2lmKGQmJmMmJmQudG9TdHJpbmcoKSE9PWMudG9TdHJpbmcoKSlmb3IoZj0wO2Y8ZC5sZW5ndGg7Zis9NillLnB1c2goXCJNXCIsZFtmKzFdLGRbZisyXSxcIkxcIixkW2YrNF0sZFtmKzVdLGNbZis0XSxjW2YrNV0sY1tmKzFdLGNbZisyXSk7ZWxzZSBlPW51bGw7cmV0dXJuIGV9O3lhLnByb3RvdHlwZS5jcmlzcFBvbHlMaW5lPWZ1bmN0aW9uKGEsYil7dmFyIGM7Zm9yKGM9MDtjPGEubGVuZ3RoO2MrPTYpYVtjKzFdPT09YVtjKzRdJiYoYVtjKzFdPWFbYys0XT1cbnkoYVtjKzFdKS1iJTIvMiksYVtjKzJdPT09YVtjKzVdJiYoYVtjKzJdPWFbYys1XT15KGFbYysyXSkrYiUyLzIpO3JldHVybiBhfTtpZihZYT09PXouVk1MUmVuZGVyZXIpbWIucHJvdG90eXBlLmNyaXNwUG9seUxpbmU9eWEucHJvdG90eXBlLmNyaXNwUG9seUxpbmU7VShJLnByb3RvdHlwZSxcImhpZGVDcm9zc2hhaXJcIixmdW5jdGlvbihhLGIpe2EuY2FsbCh0aGlzLGIpO2lmKHRoaXMuY3Jvc3NMYWJlbCl0aGlzLmNyb3NzTGFiZWw9dGhpcy5jcm9zc0xhYmVsLmhpZGUoKX0pO1UoSS5wcm90b3R5cGUsXCJkcmF3Q3Jvc3NoYWlyXCIsZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGU7YS5jYWxsKHRoaXMsYixjKTtpZihzKHRoaXMuY3Jvc3NoYWlyLmxhYmVsKSYmdGhpcy5jcm9zc2hhaXIubGFiZWwuZW5hYmxlZCl7dmFyIGE9dGhpcy5jaGFydCxmPXRoaXMub3B0aW9ucy5jcm9zc2hhaXIubGFiZWwsZz10aGlzLmhvcml6LGg9dGhpcy5vcHBvc2l0ZSxpPXRoaXMubGVmdCxqPXRoaXMudG9wLGs9XG50aGlzLmNyb3NzTGFiZWwsbCxtPWYuZm9ybWF0LG49XCJcIixwPXRoaXMub3B0aW9ucy50aWNrUG9zaXRpb249PT1cImluc2lkZVwiLHI9dGhpcy5jcm9zc2hhaXIuc25hcCE9PSExO2w9Zz9cImNlbnRlclwiOmg/dGhpcy5sYWJlbEFsaWduPT09XCJyaWdodFwiP1wicmlnaHRcIjpcImxlZnRcIjp0aGlzLmxhYmVsQWxpZ249PT1cImxlZnRcIj9cImxlZnRcIjpcImNlbnRlclwiO2lmKCFrKWs9dGhpcy5jcm9zc0xhYmVsPWEucmVuZGVyZXIubGFiZWwobnVsbCxudWxsLG51bGwsZi5zaGFwZXx8XCJjYWxsb3V0XCIpLmF0dHIoe2FsaWduOmYuYWxpZ258fGwsekluZGV4OjEyLGZpbGw6Zi5iYWNrZ3JvdW5kQ29sb3J8fHRoaXMuc2VyaWVzWzBdJiZ0aGlzLnNlcmllc1swXS5jb2xvcnx8XCJncmF5XCIscGFkZGluZzpxKGYucGFkZGluZyw4KSxzdHJva2U6Zi5ib3JkZXJDb2xvcnx8XCJcIixcInN0cm9rZS13aWR0aFwiOmYuYm9yZGVyV2lkdGh8fDAscjpxKGYuYm9yZGVyUmFkaXVzLDMpfSkuY3NzKHgoe2NvbG9yOlwid2hpdGVcIixmb250V2VpZ2h0Olwibm9ybWFsXCIsXG5mb250U2l6ZTpcIjExcHhcIix0ZXh0QWxpZ246XCJjZW50ZXJcIn0sZi5zdHlsZSkpLmFkZCgpO2c/KGw9cj9jLnBsb3RYK2k6Yi5jaGFydFgsais9aD8wOnRoaXMuaGVpZ2h0KToobD1oP3RoaXMud2lkdGgraTowLGo9cj9jLnBsb3RZK2o6Yi5jaGFydFkpOyFtJiYhZi5mb3JtYXR0ZXImJih0aGlzLmlzRGF0ZXRpbWVBeGlzJiYobj1cIiViICVkLCAlWVwiKSxtPVwie3ZhbHVlXCIrKG4/XCI6XCIrbjpcIlwiKStcIn1cIik7Yj1yP2NbdGhpcy5pc1hBeGlzP1wieFwiOlwieVwiXTp0aGlzLnRvVmFsdWUoZz9iLmNoYXJ0WDpiLmNoYXJ0WSk7ay5hdHRyKHt0ZXh0Om0/TGEobSx7dmFsdWU6Yn0pOmYuZm9ybWF0dGVyLmNhbGwodGhpcyxiKSxhbmNob3JYOmc/bDp0aGlzLm9wcG9zaXRlPzA6YS5jaGFydFdpZHRoLGFuY2hvclk6Zz90aGlzLm9wcG9zaXRlP2EuY2hhcnRIZWlnaHQ6MDpqLHg6bCx5OmosdmlzaWJpbGl0eTpcInZpc2libGVcIn0pO2I9ay5nZXRCQm94KCk7aWYoZyl7aWYocCYmIWh8fCFwJiZoKWo9ay55LVxuYi5oZWlnaHR9ZWxzZSBqPWsueS1iLmhlaWdodC8yO2c/KGQ9aS1iLngsZT1pK3RoaXMud2lkdGgtYi54KTooZD10aGlzLmxhYmVsQWxpZ249PT1cImxlZnRcIj9pOjAsZT10aGlzLmxhYmVsQWxpZ249PT1cInJpZ2h0XCI/aSt0aGlzLndpZHRoOmEuY2hhcnRXaWR0aCk7ay50cmFuc2xhdGVYPGQmJihsKz1kLWsudHJhbnNsYXRlWCk7ay50cmFuc2xhdGVYK2Iud2lkdGg+PWUmJihsLT1rLnRyYW5zbGF0ZVgrYi53aWR0aC1lKTtrLmF0dHIoe3g6bCx5OmosdmlzaWJpbGl0eTpcInZpc2libGVcIn0pfX0pO3ZhciBnYz1pYS5pbml0LGhjPWlhLnByb2Nlc3NEYXRhLGljPUhhLnByb3RvdHlwZS50b29sdGlwRm9ybWF0dGVyO2lhLmluaXQ9ZnVuY3Rpb24oKXtnYy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5zZXRDb21wYXJlKHRoaXMub3B0aW9ucy5jb21wYXJlKX07aWEuc2V0Q29tcGFyZT1mdW5jdGlvbihhKXt0aGlzLm1vZGlmeVZhbHVlPWE9PT1cInZhbHVlXCJ8fGE9PT1cInBlcmNlbnRcIj9mdW5jdGlvbihiLFxuYyl7dmFyIGQ9dGhpcy5jb21wYXJlVmFsdWU7aWYoYiE9PXQmJihiPWE9PT1cInZhbHVlXCI/Yi1kOmI9MTAwKihiL2QpLTEwMCxjKSljLmNoYW5nZT1iO3JldHVybiBifTpudWxsO2lmKHRoaXMuY2hhcnQuaGFzUmVuZGVyZWQpdGhpcy5pc0RpcnR5PSEwfTtpYS5wcm9jZXNzRGF0YT1mdW5jdGlvbigpe3ZhciBhLGI9LTEsYyxkLGUsZjtoYy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7aWYodGhpcy54QXhpcyYmdGhpcy5wcm9jZXNzZWRZRGF0YSl7Yz10aGlzLnByb2Nlc3NlZFhEYXRhO2Q9dGhpcy5wcm9jZXNzZWRZRGF0YTtlPWQubGVuZ3RoO3RoaXMucG9pbnRBcnJheU1hcCYmKGI9c2EodGhpcy5wb2ludFZhbEtleXx8XCJ5XCIsdGhpcy5wb2ludEFycmF5TWFwKSk7Zm9yKGE9MDthPGU7YSsrKWlmKGY9Yj4tMT9kW2FdW2JdOmRbYV0sdHlwZW9mIGY9PT1cIm51bWJlclwiJiZjW2FdPj10aGlzLnhBeGlzLm1pbiYmZiE9PTApe3RoaXMuY29tcGFyZVZhbHVlPWY7YnJlYWt9fX07VShpYSxcImdldEV4dHJlbWVzXCIsXG5mdW5jdGlvbihhKXt2YXIgYjthLmFwcGx5KHRoaXMsW10uc2xpY2UuY2FsbChhcmd1bWVudHMsMSkpO2lmKHRoaXMubW9kaWZ5VmFsdWUpYj1bdGhpcy5tb2RpZnlWYWx1ZSh0aGlzLmRhdGFNaW4pLHRoaXMubW9kaWZ5VmFsdWUodGhpcy5kYXRhTWF4KV0sdGhpcy5kYXRhTWluPU9hKGIpLHRoaXMuZGF0YU1heD1FYShiKX0pO0kucHJvdG90eXBlLnNldENvbXBhcmU9ZnVuY3Rpb24oYSxiKXt0aGlzLmlzWEF4aXN8fChuKHRoaXMuc2VyaWVzLGZ1bmN0aW9uKGIpe2Iuc2V0Q29tcGFyZShhKX0pLHEoYiwhMCkmJnRoaXMuY2hhcnQucmVkcmF3KCkpfTtIYS5wcm90b3R5cGUudG9vbHRpcEZvcm1hdHRlcj1mdW5jdGlvbihhKXthPWEucmVwbGFjZShcIntwb2ludC5jaGFuZ2V9XCIsKHRoaXMuY2hhbmdlPjA/XCIrXCI6XCJcIikrei5udW1iZXJGb3JtYXQodGhpcy5jaGFuZ2UscSh0aGlzLnNlcmllcy50b29sdGlwT3B0aW9ucy5jaGFuZ2VEZWNpbWFscywyKSkpO3JldHVybiBpYy5hcHBseSh0aGlzLFxuW2FdKX07VShRLnByb3RvdHlwZSxcInJlbmRlclwiLGZ1bmN0aW9uKGEpe2lmKHRoaXMuY2hhcnQub3B0aW9ucy5fc3RvY2smJnRoaXMueEF4aXMpIXRoaXMuY2xpcEJveCYmdGhpcy5hbmltYXRlPyh0aGlzLmNsaXBCb3g9Qyh0aGlzLmNoYXJ0LmNsaXBCb3gpLHRoaXMuY2xpcEJveC53aWR0aD10aGlzLnhBeGlzLmxlbix0aGlzLmNsaXBCb3guaGVpZ2h0PXRoaXMueUF4aXMubGVuKTp0aGlzLmNoYXJ0W3RoaXMuc2hhcmVkQ2xpcEtleV0mJihUYSh0aGlzLmNoYXJ0W3RoaXMuc2hhcmVkQ2xpcEtleV0pLHRoaXMuY2hhcnRbdGhpcy5zaGFyZWRDbGlwS2V5XS5hdHRyKHt3aWR0aDp0aGlzLnhBeGlzLmxlbixoZWlnaHQ6dGhpcy55QXhpcy5sZW59KSk7YS5jYWxsKHRoaXMpfSk7eCh6LHtDb2xvcjp3YSxQb2ludDpIYSxUaWNrOmNiLFJlbmRlcmVyOllhLFNWR0VsZW1lbnQ6WixTVkdSZW5kZXJlcjp5YSxhcnJheU1pbjpPYSxhcnJheU1heDpFYSxjaGFydHM6JCxjb3JyZWN0RmxvYXQ6bmEsXG5kYXRlRm9ybWF0Om1hLGVycm9yOmdhLGZvcm1hdDpMYSxwYXRoQW5pbTp2b2lkIDAsZ2V0T3B0aW9uczpmdW5jdGlvbigpe3JldHVybiBOfSxoYXNCaWRpQnVnOlpiLGlzVG91Y2hEZXZpY2U6a2Isc2V0T3B0aW9uczpmdW5jdGlvbihhKXtOPUMoITAsTixhKTtPYigpO3JldHVybiBOfSxhZGRFdmVudDpELHJlbW92ZUV2ZW50OlQsY3JlYXRlRWxlbWVudDplYSxkaXNjYXJkRWxlbWVudDpWYSxjc3M6RixlYWNoOm4sbWFwOnRhLG1lcmdlOkMsc3BsYXQ6dmEsc3RhYmxlU29ydDpvYixleHRlbmRDbGFzczpsYSxwSW50Okcsc3ZnOmphLGNhbnZhczpxYSx2bWw6IWphJiYhcWEscHJvZHVjdDpcIkhpZ2hzdG9ja1wiLHZlcnNpb246XCI0LjIuNFwifSk7cmV0dXJuIHp9KTtcbiIsIi8qKlxuKlxuKiBqcXVlcnkuc3BhcmtsaW5lLmpzXG4qXG4qIHYyLjMuMlxuKiAoYykgU3BsdW5rLCBJbmNcbiogQ29udGFjdDogR2FyZXRoIFdhdHRzIChnYXJldGhAc3BsdW5rLmNvbSlcbiogaHR0cDovL29tbmlwb3RlbnQubmV0L2pxdWVyeS5zcGFya2xpbmUvXG4qXG4qIEdlbmVyYXRlcyBpbmxpbmUgc3BhcmtsaW5lIGNoYXJ0cyBmcm9tIGRhdGEgc3VwcGxpZWQgZWl0aGVyIHRvIHRoZSBtZXRob2Rcbiogb3IgaW5saW5lIGluIEhUTUxcbipcbiogQ29tcGF0aWJsZSB3aXRoIEludGVybmV0IEV4cGxvcmVyIDYuMCsgYW5kIG1vZGVybiBicm93c2VycyBlcXVpcHBlZCB3aXRoIHRoZSBjYW52YXMgdGFnXG4qIChGaXJlZm94IDIuMCssIFNhZmFyaSwgT3BlcmEsIGV0YylcbipcbiogTGljZW5zZTogTmV3IEJTRCBMaWNlbnNlXG4qXG4qIENvcHlyaWdodCAoYykgMjAxMiwgU3BsdW5rIEluYy5cbiogQWxsIHJpZ2h0cyByZXNlcnZlZC5cbipcbiogUmVkaXN0cmlidXRpb24gYW5kIHVzZSBpbiBzb3VyY2UgYW5kIGJpbmFyeSBmb3Jtcywgd2l0aCBvciB3aXRob3V0IG1vZGlmaWNhdGlvbixcbiogYXJlIHBlcm1pdHRlZCBwcm92aWRlZCB0aGF0IHRoZSBmb2xsb3dpbmcgY29uZGl0aW9ucyBhcmUgbWV0OlxuKlxuKiAgICAgKiBSZWRpc3RyaWJ1dGlvbnMgb2Ygc291cmNlIGNvZGUgbXVzdCByZXRhaW4gdGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UsXG4qICAgICAgIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIuXG4qICAgICAqIFJlZGlzdHJpYnV0aW9ucyBpbiBiaW5hcnkgZm9ybSBtdXN0IHJlcHJvZHVjZSB0aGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSxcbiogICAgICAgdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lciBpbiB0aGUgZG9jdW1lbnRhdGlvblxuKiAgICAgICBhbmQvb3Igb3RoZXIgbWF0ZXJpYWxzIHByb3ZpZGVkIHdpdGggdGhlIGRpc3RyaWJ1dGlvbi5cbiogICAgICogTmVpdGhlciB0aGUgbmFtZSBvZiBTcGx1bmsgSW5jIG5vciB0aGUgbmFtZXMgb2YgaXRzIGNvbnRyaWJ1dG9ycyBtYXlcbiogICAgICAgYmUgdXNlZCB0byBlbmRvcnNlIG9yIHByb21vdGUgcHJvZHVjdHMgZGVyaXZlZCBmcm9tIHRoaXMgc29mdHdhcmUgd2l0aG91dFxuKiAgICAgICBzcGVjaWZpYyBwcmlvciB3cml0dGVuIHBlcm1pc3Npb24uXG4qXG4qIFRISVMgU09GVFdBUkUgSVMgUFJPVklERUQgQlkgVEhFIENPUFlSSUdIVCBIT0xERVJTIEFORCBDT05UUklCVVRPUlMgXCJBUyBJU1wiIEFORCBBTllcbiogRVhQUkVTUyBPUiBJTVBMSUVEIFdBUlJBTlRJRVMsIElOQ0xVRElORywgQlVUIE5PVCBMSU1JVEVEIFRPLCBUSEUgSU1QTElFRCBXQVJSQU5USUVTXG4qIE9GIE1FUkNIQU5UQUJJTElUWSBBTkQgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQVJFIERJU0NMQUlNRUQuIElOIE5PIEVWRU5UXG4qIFNIQUxMIFRIRSBDT1BZUklHSFQgT1dORVIgT1IgQ09OVFJJQlVUT1JTIEJFIExJQUJMRSBGT1IgQU5ZIERJUkVDVCwgSU5ESVJFQ1QsIElOQ0lERU5UQUwsXG4qIFNQRUNJQUwsIEVYRU1QTEFSWSwgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTIChJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRCBUTywgUFJPQ1VSRU1FTlRcbiogT0YgU1VCU1RJVFVURSBHT09EUyBPUiBTRVJWSUNFUzsgTE9TUyBPRiBVU0UsIERBVEEsIE9SIFBST0ZJVFM7IE9SIEJVU0lORVNTIElOVEVSUlVQVElPTilcbiogSE9XRVZFUiBDQVVTRUQgQU5EIE9OIEFOWSBUSEVPUlkgT0YgTElBQklMSVRZLCBXSEVUSEVSIElOIENPTlRSQUNULCBTVFJJQ1QgTElBQklMSVRZLFxuKiBPUiBUT1JUIChJTkNMVURJTkcgTkVHTElHRU5DRSBPUiBPVEhFUldJU0UpIEFSSVNJTkcgSU4gQU5ZIFdBWSBPVVQgT0YgVEhFIFVTRSBPRiBUSElTXG4qIFNPRlRXQVJFLCBFVkVOIElGIEFEVklTRUQgT0YgVEhFIFBPU1NJQklMSVRZIE9GIFNVQ0ggREFNQUdFLlxuKlxuKlxuKiBVc2FnZTpcbiogICQoc2VsZWN0b3IpLnNwYXJrbGluZSh2YWx1ZXMsIG9wdGlvbnMpXG4qXG4qIElmIHZhbHVlcyBpcyB1bmRlZmluZWQgb3Igc2V0IHRvICdodG1sJyB0aGVuIHRoZSBkYXRhIHZhbHVlcyBhcmUgcmVhZCBmcm9tIHRoZSBzcGVjaWZpZWQgdGFnOlxuKiAgIDxwPlNwYXJrbGluZTogPHNwYW4gY2xhc3M9XCJzcGFya2xpbmVcIj4xLDQsNiw2LDgsNSwzLDU8L3NwYW4+PC9wPlxuKiAgICQoJy5zcGFya2xpbmUnKS5zcGFya2xpbmUoKTtcbiogVGhlcmUgbXVzdCBiZSBubyBzcGFjZXMgaW4gdGhlIGVuY2xvc2VkIGRhdGEgc2V0XG4qXG4qIE90aGVyd2lzZSB2YWx1ZXMgbXVzdCBiZSBhbiBhcnJheSBvZiBudW1iZXJzIG9yIG51bGwgdmFsdWVzXG4qICAgIDxwPlNwYXJrbGluZTogPHNwYW4gaWQ9XCJzcGFya2xpbmUxXCI+VGhpcyB0ZXh0IHJlcGxhY2VkIGlmIHRoZSBicm93c2VyIGlzIGNvbXBhdGlibGU8L3NwYW4+PC9wPlxuKiAgICAkKCcjc3BhcmtsaW5lMScpLnNwYXJrbGluZShbMSw0LDYsNiw4LDUsMyw1XSlcbiogICAgJCgnI3NwYXJrbGluZTInKS5zcGFya2xpbmUoWzEsNCw2LG51bGwsbnVsbCw1LDMsNV0pXG4qXG4qIFZhbHVlcyBjYW4gYWxzbyBiZSBzcGVjaWZpZWQgaW4gYW4gSFRNTCBjb21tZW50LCBvciBhcyBhIHZhbHVlcyBhdHRyaWJ1dGU6XG4qICAgIDxwPlNwYXJrbGluZTogPHNwYW4gY2xhc3M9XCJzcGFya2xpbmVcIj48IS0tMSw0LDYsNiw4LDUsMyw1IC0tPjwvc3Bhbj48L3A+XG4qICAgIDxwPlNwYXJrbGluZTogPHNwYW4gY2xhc3M9XCJzcGFya2xpbmVcIiB2YWx1ZXM9XCIxLDQsNiw2LDgsNSwzLDVcIj48L3NwYW4+PC9wPlxuKiAgICAkKCcuc3BhcmtsaW5lJykuc3BhcmtsaW5lKCk7XG4qXG4qIEZvciBsaW5lIGNoYXJ0cywgeCB2YWx1ZXMgY2FuIGFsc28gYmUgc3BlY2lmaWVkOlxuKiAgIDxwPlNwYXJrbGluZTogPHNwYW4gY2xhc3M9XCJzcGFya2xpbmVcIj4xOjEsMi43OjQsMy40OjYsNTo2LDY6OCw4Ljc6NSw5OjMsMTA6NTwvc3Bhbj48L3A+XG4qICAgICQoJyNzcGFya2xpbmUxJykuc3BhcmtsaW5lKFsgWzEsMV0sIFsyLjcsNF0sIFszLjQsNl0sIFs1LDZdLCBbNiw4XSwgWzguNyw1XSwgWzksM10sIFsxMCw1XSBdKVxuKlxuKiBCeSBkZWZhdWx0LCBvcHRpb25zIHNob3VsZCBiZSBwYXNzZWQgaW4gYXMgdGhlIHNlY29uZCBhcmd1bWVudCB0byB0aGUgc3BhcmtsaW5lIGZ1bmN0aW9uOlxuKiAgICQoJy5zcGFya2xpbmUnKS5zcGFya2xpbmUoWzEsMiwzLDRdLCB7dHlwZTogJ2Jhcid9KVxuKlxuKiBPcHRpb25zIGNhbiBhbHNvIGJlIHNldCBieSBwYXNzaW5nIHRoZW0gb24gdGhlIHRhZyBpdHNlbGYuICBUaGlzIGZlYXR1cmUgaXMgZGlzYWJsZWQgYnkgZGVmYXVsdCB0aG91Z2hcbiogYXMgdGhlcmUncyBhIHNsaWdodCBwZXJmb3JtYW5jZSBvdmVyaGVhZDpcbiogICAkKCcuc3BhcmtsaW5lJykuc3BhcmtsaW5lKFsxLDIsMyw0XSwge2VuYWJsZVRhZ09wdGlvbnM6IHRydWV9KVxuKiAgIDxwPlNwYXJrbGluZTogPHNwYW4gY2xhc3M9XCJzcGFya2xpbmVcIiBzcGFya1R5cGU9XCJiYXJcIiBzcGFya0JhckNvbG9yPVwicmVkXCI+bG9hZGluZzwvc3Bhbj48L3A+XG4qIFByZWZpeCBhbGwgb3B0aW9ucyBzdXBwbGllZCBhcyB0YWcgYXR0cmlidXRlIHdpdGggXCJzcGFya1wiIChjb25maWd1cmFibGUgYnkgc2V0dGluZyB0YWdPcHRpb25zUHJlZml4KVxuKlxuKiBTdXBwb3J0ZWQgb3B0aW9uczpcbiogICBsaW5lQ29sb3IgLSBDb2xvciBvZiB0aGUgbGluZSB1c2VkIGZvciB0aGUgY2hhcnRcbiogICBmaWxsQ29sb3IgLSBDb2xvciB1c2VkIHRvIGZpbGwgaW4gdGhlIGNoYXJ0IC0gU2V0IHRvICcnIG9yIGZhbHNlIGZvciBhIHRyYW5zcGFyZW50IGNoYXJ0XG4qICAgd2lkdGggLSBXaWR0aCBvZiB0aGUgY2hhcnQgLSBEZWZhdWx0cyB0byAzIHRpbWVzIHRoZSBudW1iZXIgb2YgdmFsdWVzIGluIHBpeGVsc1xuKiAgIGhlaWdodCAtIEhlaWdodCBvZiB0aGUgY2hhcnQgLSBEZWZhdWx0cyB0byB0aGUgaGVpZ2h0IG9mIHRoZSBjb250YWluaW5nIGVsZW1lbnRcbiogICBjaGFydFJhbmdlTWluIC0gU3BlY2lmeSB0aGUgbWluaW11bSB2YWx1ZSB0byB1c2UgZm9yIHRoZSBZIHJhbmdlIG9mIHRoZSBjaGFydCAtIERlZmF1bHRzIHRvIHRoZSBtaW5pbXVtIHZhbHVlIHN1cHBsaWVkXG4qICAgY2hhcnRSYW5nZU1heCAtIFNwZWNpZnkgdGhlIG1heGltdW0gdmFsdWUgdG8gdXNlIGZvciB0aGUgWSByYW5nZSBvZiB0aGUgY2hhcnQgLSBEZWZhdWx0cyB0byB0aGUgbWF4aW11bSB2YWx1ZSBzdXBwbGllZFxuKiAgIGNoYXJ0UmFuZ2VDbGlwIC0gQ2xpcCBvdXQgb2YgcmFuZ2UgdmFsdWVzIHRvIHRoZSBtYXgvbWluIHNwZWNpZmllZCBieSBjaGFydFJhbmdlTWluIGFuZCBjaGFydFJhbmdlTWF4XG4qICAgY2hhcnRSYW5nZU1pblggLSBTcGVjaWZ5IHRoZSBtaW5pbXVtIHZhbHVlIHRvIHVzZSBmb3IgdGhlIFggcmFuZ2Ugb2YgdGhlIGNoYXJ0IC0gRGVmYXVsdHMgdG8gdGhlIG1pbmltdW0gdmFsdWUgc3VwcGxpZWRcbiogICBjaGFydFJhbmdlTWF4WCAtIFNwZWNpZnkgdGhlIG1heGltdW0gdmFsdWUgdG8gdXNlIGZvciB0aGUgWCByYW5nZSBvZiB0aGUgY2hhcnQgLSBEZWZhdWx0cyB0byB0aGUgbWF4aW11bSB2YWx1ZSBzdXBwbGllZFxuKiAgIGNvbXBvc2l0ZSAtIElmIHRydWUgdGhlbiBkb24ndCBlcmFzZSBhbnkgZXhpc3RpbmcgY2hhcnQgYXR0YWNoZWQgdG8gdGhlIHRhZywgYnV0IGRyYXdcbiogICAgICAgICAgIGFub3RoZXIgY2hhcnQgb3ZlciB0aGUgdG9wIC0gTm90ZSB0aGF0IHdpZHRoIGFuZCBoZWlnaHQgYXJlIGlnbm9yZWQgaWYgYW5cbiogICAgICAgICAgIGV4aXN0aW5nIGNoYXJ0IGlzIGRldGVjdGVkLlxuKiAgIHRhZ1ZhbHVlc0F0dHJpYnV0ZSAtIE5hbWUgb2YgdGFnIGF0dHJpYnV0ZSB0byBjaGVjayBmb3IgZGF0YSB2YWx1ZXMgLSBEZWZhdWx0cyB0byAndmFsdWVzJ1xuKiAgIGVuYWJsZVRhZ09wdGlvbnMgLSBXaGV0aGVyIHRvIGNoZWNrIHRhZ3MgZm9yIHNwYXJrbGluZSBvcHRpb25zXG4qICAgdGFnT3B0aW9uc1ByZWZpeCAtIFByZWZpeCB1c2VkIGZvciBvcHRpb25zIHN1cHBsaWVkIGFzIHRhZyBhdHRyaWJ1dGVzIC0gRGVmYXVsdHMgdG8gJ3NwYXJrJ1xuKiAgIGRpc2FibGVIaWRkZW5DaGVjayAtIElmIHNldCB0byB0cnVlLCB0aGVuIHRoZSBwbHVnaW4gd2lsbCBhc3N1bWUgdGhhdCBjaGFydHMgd2lsbCBuZXZlciBiZSBkcmF3biBpbnRvIGFcbiogICAgICAgICAgIGhpZGRlbiBkb20gZWxlbWVudCwgYXZvZGluZyBhIGJyb3dzZXIgcmVmbG93XG4qICAgZGlzYWJsZUludGVyYWN0aW9uIC0gSWYgc2V0IHRvIHRydWUgdGhlbiBhbGwgbW91c2VvdmVyL2NsaWNrIGludGVyYWN0aW9uIGJlaGF2aW91ciB3aWxsIGJlIGRpc2FibGVkLFxuKiAgICAgICBtYWtpbmcgdGhlIHBsdWdpbiBwZXJmb3JtIG11Y2ggbGlrZSBpdCBkaWQgaW4gMS54XG4qICAgZGlzYWJsZVRvb2x0aXBzIC0gSWYgc2V0IHRvIHRydWUgdGhlbiB0b29sdGlwcyB3aWxsIGJlIGRpc2FibGVkIC0gRGVmYXVsdHMgdG8gZmFsc2UgKHRvb2x0aXBzIGVuYWJsZWQpXG4qICAgZGlzYWJsZUhpZ2hsaWdodCAtIElmIHNldCB0byB0cnVlIHRoZW4gaGlnaGxpZ2h0aW5nIG9mIHNlbGVjdGVkIGNoYXJ0IGVsZW1lbnRzIG9uIG1vdXNlb3ZlciB3aWxsIGJlIGRpc2FibGVkXG4qICAgICAgIGRlZmF1bHRzIHRvIGZhbHNlIChoaWdobGlnaHRzIGVuYWJsZWQpXG4qICAgaGlnaGxpZ2h0TGlnaHRlbiAtIEZhY3RvciB0byBsaWdodGVuL2RhcmtlbiBoaWdobGlnaHRlZCBjaGFydCB2YWx1ZXMgYnkgLSBEZWZhdWx0cyB0byAxLjQgZm9yIGEgNDAlIGluY3JlYXNlXG4qICAgdG9vbHRpcENvbnRhaW5lciAtIFNwZWNpZnkgd2hpY2ggRE9NIGVsZW1lbnQgdGhlIHRvb2x0aXAgc2hvdWxkIGJlIHJlbmRlcmVkIGludG8gLSBkZWZhdWx0cyB0byBkb2N1bWVudC5ib2R5XG4qICAgdG9vbHRpcENsYXNzbmFtZSAtIE9wdGlvbmFsIENTUyBjbGFzc25hbWUgdG8gYXBwbHkgdG8gdG9vbHRpcHMgLSBJZiBub3Qgc3BlY2lmaWVkIHRoZW4gYSBkZWZhdWx0IHN0eWxlIHdpbGwgYmUgYXBwbGllZFxuKiAgIHRvb2x0aXBPZmZzZXRYIC0gSG93IG1hbnkgcGl4ZWxzIGF3YXkgZnJvbSB0aGUgbW91c2UgcG9pbnRlciB0byByZW5kZXIgdGhlIHRvb2x0aXAgb24gdGhlIFggYXhpc1xuKiAgIHRvb2x0aXBPZmZzZXRZIC0gSG93IG1hbnkgcGl4ZWxzIGF3YXkgZnJvbSB0aGUgbW91c2UgcG9pbnRlciB0byByZW5kZXIgdGhlIHRvb2x0aXAgb24gdGhlIHIgYXhpc1xuKiAgIHRvb2x0aXBGb3JtYXR0ZXIgIC0gT3B0aW9uYWwgY2FsbGJhY2sgdGhhdCBhbGxvd3MgeW91IHRvIG92ZXJyaWRlIHRoZSBIVE1MIGRpc3BsYXllZCBpbiB0aGUgdG9vbHRpcFxuKiAgICAgICBjYWxsYmFjayBpcyBnaXZlbiBhcmd1bWVudHMgb2YgKHNwYXJrbGluZSwgb3B0aW9ucywgZmllbGRzKVxuKiAgIHRvb2x0aXBDaGFydFRpdGxlIC0gSWYgc3BlY2lmaWVkIHRoZW4gdGhlIHRvb2x0aXAgdXNlcyB0aGUgc3RyaW5nIHNwZWNpZmllZCBieSB0aGlzIHNldHRpbmcgYXMgYSB0aXRsZVxuKiAgIHRvb2x0aXBGb3JtYXQgLSBBIGZvcm1hdCBzdHJpbmcgb3IgU1BGb3JtYXQgb2JqZWN0ICAob3IgYW4gYXJyYXkgdGhlcmVvZiBmb3IgbXVsdGlwbGUgZW50cmllcylcbiogICAgICAgdG8gY29udHJvbCB0aGUgZm9ybWF0IG9mIHRoZSB0b29sdGlwXG4qICAgdG9vbHRpcFByZWZpeCAtIEEgc3RyaW5nIHRvIHByZXBlbmQgdG8gZWFjaCBmaWVsZCBkaXNwbGF5ZWQgaW4gYSB0b29sdGlwXG4qICAgdG9vbHRpcFN1ZmZpeCAtIEEgc3RyaW5nIHRvIGFwcGVuZCB0byBlYWNoIGZpZWxkIGRpc3BsYXllZCBpbiBhIHRvb2x0aXBcbiogICB0b29sdGlwU2tpcE51bGwgLSBJZiB0cnVlIHRoZW4gbnVsbCB2YWx1ZXMgd2lsbCBub3QgaGF2ZSBhIHRvb2x0aXAgZGlzcGxheWVkIChkZWZhdWx0cyB0byB0cnVlKVxuKiAgIHRvb2x0aXBWYWx1ZUxvb2t1cHMgLSBBbiBvYmplY3Qgb3IgcmFuZ2UgbWFwIHRvIG1hcCBmaWVsZCB2YWx1ZXMgdG8gdG9vbHRpcCBzdHJpbmdzXG4qICAgICAgIChlZy4gdG8gbWFwIC0xIHRvIFwiTG9zdFwiLCAwIHRvIFwiRHJhd1wiLCBhbmQgMSB0byBcIldpblwiKVxuKiAgIG51bWJlckZvcm1hdHRlciAtIE9wdGlvbmFsIGNhbGxiYWNrIGZvciBmb3JtYXR0aW5nIG51bWJlcnMgaW4gdG9vbHRpcHNcbiogICBudW1iZXJEaWdpdEdyb3VwU2VwIC0gQ2hhcmFjdGVyIHRvIHVzZSBmb3IgZ3JvdXAgc2VwYXJhdG9yIGluIG51bWJlcnMgXCIxLDIzNFwiIC0gRGVmYXVsdHMgdG8gXCIsXCJcbiogICBudW1iZXJEZWNpbWFsTWFyayAtIENoYXJhY3RlciB0byB1c2UgZm9yIHRoZSBkZWNpbWFsIHBvaW50IHdoZW4gZm9ybWF0dGluZyBudW1iZXJzIC0gRGVmYXVsdHMgdG8gXCIuXCJcbiogICBudW1iZXJEaWdpdEdyb3VwQ291bnQgLSBOdW1iZXIgb2YgZGlnaXRzIGJldHdlZW4gZ3JvdXAgc2VwYXJhdG9yIC0gRGVmYXVsdHMgdG8gM1xuKlxuKiBUaGVyZSBhcmUgNyB0eXBlcyBvZiBzcGFya2xpbmUsIHNlbGVjdGVkIGJ5IHN1cHBseWluZyBhIFwidHlwZVwiIG9wdGlvbiBvZiAnbGluZScgKGRlZmF1bHQpLFxuKiAnYmFyJywgJ3RyaXN0YXRlJywgJ2J1bGxldCcsICdkaXNjcmV0ZScsICdwaWUnIG9yICdib3gnXG4qICAgIGxpbmUgLSBMaW5lIGNoYXJ0LiAgT3B0aW9uczpcbiogICAgICAgc3BvdENvbG9yIC0gU2V0IHRvICcnIHRvIG5vdCBlbmQgZWFjaCBsaW5lIGluIGEgY2lyY3VsYXIgc3BvdFxuKiAgICAgICBtaW5TcG90Q29sb3IgLSBJZiBzZXQsIGNvbG9yIG9mIHNwb3QgYXQgbWluaW11bSB2YWx1ZVxuKiAgICAgICBtYXhTcG90Q29sb3IgLSBJZiBzZXQsIGNvbG9yIG9mIHNwb3QgYXQgbWF4aW11bSB2YWx1ZVxuKiAgICAgICBzcG90UmFkaXVzIC0gUmFkaXVzIGluIHBpeGVsc1xuKiAgICAgICBsaW5lV2lkdGggLSBXaWR0aCBvZiBsaW5lIGluIHBpeGVsc1xuKiAgICAgICBub3JtYWxSYW5nZU1pblxuKiAgICAgICBub3JtYWxSYW5nZU1heCAtIElmIHNldCBkcmF3cyBhIGZpbGxlZCBob3Jpem9udGFsIGJhciBiZXR3ZWVuIHRoZXNlIHR3byB2YWx1ZXMgbWFya2luZyB0aGUgXCJub3JtYWxcIlxuKiAgICAgICAgICAgICAgICAgICAgICBvciBleHBlY3RlZCByYW5nZSBvZiB2YWx1ZXNcbiogICAgICAgbm9ybWFsUmFuZ2VDb2xvciAtIENvbG9yIHRvIHVzZSBmb3IgdGhlIGFib3ZlIGJhclxuKiAgICAgICBkcmF3Tm9ybWFsT25Ub3AgLSBEcmF3IHRoZSBub3JtYWwgcmFuZ2UgYWJvdmUgdGhlIGNoYXJ0IGZpbGwgY29sb3IgaWYgdHJ1ZVxuKiAgICAgICBkZWZhdWx0UGl4ZWxzUGVyVmFsdWUgLSBEZWZhdWx0cyB0byAzIHBpeGVscyBvZiB3aWR0aCBmb3IgZWFjaCB2YWx1ZSBpbiB0aGUgY2hhcnRcbiogICAgICAgaGlnaGxpZ2h0U3BvdENvbG9yIC0gVGhlIGNvbG9yIHRvIHVzZSBmb3IgZHJhd2luZyBhIGhpZ2hsaWdodCBzcG90IG9uIG1vdXNlb3ZlciAtIFNldCB0byBudWxsIHRvIGRpc2FibGVcbiogICAgICAgaGlnaGxpZ2h0TGluZUNvbG9yIC0gVGhlIGNvbG9yIHRvIHVzZSBmb3IgZHJhd2luZyBhIGhpZ2hsaWdodCBsaW5lIG9uIG1vdXNlb3ZlciAtIFNldCB0byBudWxsIHRvIGRpc2FibGVcbiogICAgICAgdmFsdWVTcG90cyAtIFNwZWNpZnkgd2hpY2ggcG9pbnRzIHRvIGRyYXcgc3BvdHMgb24sIGFuZCBpbiB3aGljaCBjb2xvci4gIEFjY2VwdHMgYSByYW5nZSBtYXBcbipcbiogICBiYXIgLSBCYXIgY2hhcnQuICBPcHRpb25zOlxuKiAgICAgICBiYXJDb2xvciAtIENvbG9yIG9mIGJhcnMgZm9yIHBvc3RpdmUgdmFsdWVzXG4qICAgICAgIG5lZ0JhckNvbG9yIC0gQ29sb3Igb2YgYmFycyBmb3IgbmVnYXRpdmUgdmFsdWVzXG4qICAgICAgIHplcm9Db2xvciAtIENvbG9yIG9mIGJhcnMgd2l0aCB6ZXJvIHZhbHVlc1xuKiAgICAgICBudWxsQ29sb3IgLSBDb2xvciBvZiBiYXJzIHdpdGggbnVsbCB2YWx1ZXMgLSBEZWZhdWx0cyB0byBvbWl0dGluZyB0aGUgYmFyIGVudGlyZWx5XG4qICAgICAgIGJhcldpZHRoIC0gV2lkdGggb2YgYmFycyBpbiBwaXhlbHNcbiogICAgICAgY29sb3JNYXAgLSBPcHRpb25hbCBtYXBwbmlnIG9mIHZhbHVlcyB0byBjb2xvcnMgdG8gb3ZlcnJpZGUgdGhlICpCYXJDb2xvciB2YWx1ZXMgYWJvdmVcbiogICAgICAgICAgICAgICAgICBjYW4gYmUgYW4gQXJyYXkgb2YgdmFsdWVzIHRvIGNvbnRyb2wgdGhlIGNvbG9yIG9mIGluZGl2aWR1YWwgYmFycyBvciBhIHJhbmdlIG1hcFxuKiAgICAgICAgICAgICAgICAgIHRvIHNwZWNpZnkgY29sb3JzIGZvciBpbmRpdmlkdWFsIHJhbmdlcyBvZiB2YWx1ZXNcbiogICAgICAgYmFyU3BhY2luZyAtIEdhcCBiZXR3ZWVuIGJhcnMgaW4gcGl4ZWxzXG4qICAgICAgIHplcm9BeGlzIC0gQ2VudGVycyB0aGUgeS1heGlzIGFyb3VuZCB6ZXJvIGlmIHRydWVcbipcbiogICB0cmlzdGF0ZSAtIENoYXJ0cyB2YWx1ZXMgb2Ygd2luICg+MCksIGxvc2UgKDwwKSBvciBkcmF3ICg9MClcbiogICAgICAgcG9zQmFyQ29sb3IgLSBDb2xvciBvZiB3aW4gdmFsdWVzXG4qICAgICAgIG5lZ0JhckNvbG9yIC0gQ29sb3Igb2YgbG9zZSB2YWx1ZXNcbiogICAgICAgemVyb0JhckNvbG9yIC0gQ29sb3Igb2YgZHJhdyB2YWx1ZXNcbiogICAgICAgYmFyV2lkdGggLSBXaWR0aCBvZiBiYXJzIGluIHBpeGVsc1xuKiAgICAgICBiYXJTcGFjaW5nIC0gR2FwIGJldHdlZW4gYmFycyBpbiBwaXhlbHNcbiogICAgICAgY29sb3JNYXAgLSBPcHRpb25hbCBtYXBwbmlnIG9mIHZhbHVlcyB0byBjb2xvcnMgdG8gb3ZlcnJpZGUgdGhlICpCYXJDb2xvciB2YWx1ZXMgYWJvdmVcbiogICAgICAgICAgICAgICAgICBjYW4gYmUgYW4gQXJyYXkgb2YgdmFsdWVzIHRvIGNvbnRyb2wgdGhlIGNvbG9yIG9mIGluZGl2aWR1YWwgYmFycyBvciBhIHJhbmdlIG1hcFxuKiAgICAgICAgICAgICAgICAgIHRvIHNwZWNpZnkgY29sb3JzIGZvciBpbmRpdmlkdWFsIHJhbmdlcyBvZiB2YWx1ZXNcbipcbiogICBkaXNjcmV0ZSAtIE9wdGlvbnM6XG4qICAgICAgIGxpbmVIZWlnaHQgLSBIZWlnaHQgb2YgZWFjaCBsaW5lIGluIHBpeGVscyAtIERlZmF1bHRzIHRvIDMwJSBvZiB0aGUgZ3JhcGggaGVpZ2h0XG4qICAgICAgIHRoZXNob2xkVmFsdWUgLSBWYWx1ZXMgbGVzcyB0aGFuIHRoaXMgdmFsdWUgd2lsbCBiZSBkcmF3biB1c2luZyB0aHJlc2hvbGRDb2xvciBpbnN0ZWFkIG9mIGxpbmVDb2xvclxuKiAgICAgICB0aHJlc2hvbGRDb2xvclxuKlxuKiAgIGJ1bGxldCAtIFZhbHVlcyBmb3IgYnVsbGV0IGdyYXBocyBtc3V0IGJlIGluIHRoZSBvcmRlcjogdGFyZ2V0LCBwZXJmb3JtYW5jZSwgcmFuZ2UxLCByYW5nZTIsIHJhbmdlMywgLi4uXG4qICAgICAgIG9wdGlvbnM6XG4qICAgICAgIHRhcmdldENvbG9yIC0gVGhlIGNvbG9yIG9mIHRoZSB2ZXJ0aWNhbCB0YXJnZXQgbWFya2VyXG4qICAgICAgIHRhcmdldFdpZHRoIC0gVGhlIHdpZHRoIG9mIHRoZSB0YXJnZXQgbWFya2VyIGluIHBpeGVsc1xuKiAgICAgICBwZXJmb3JtYW5jZUNvbG9yIC0gVGhlIGNvbG9yIG9mIHRoZSBwZXJmb3JtYW5jZSBtZWFzdXJlIGhvcml6b250YWwgYmFyXG4qICAgICAgIHJhbmdlQ29sb3JzIC0gQ29sb3JzIHRvIHVzZSBmb3IgZWFjaCBxdWFsaXRhdGl2ZSByYW5nZSBiYWNrZ3JvdW5kIGNvbG9yXG4qXG4qICAgcGllIC0gUGllIGNoYXJ0LiBPcHRpb25zOlxuKiAgICAgICBzbGljZUNvbG9ycyAtIEFuIGFycmF5IG9mIGNvbG9ycyB0byB1c2UgZm9yIHBpZSBzbGljZXNcbiogICAgICAgb2Zmc2V0IC0gQW5nbGUgaW4gZGVncmVlcyB0byBvZmZzZXQgdGhlIGZpcnN0IHNsaWNlIC0gVHJ5IC05MCBvciArOTBcbiogICAgICAgYm9yZGVyV2lkdGggLSBXaWR0aCBvZiBib3JkZXIgdG8gZHJhdyBhcm91bmQgdGhlIHBpZSBjaGFydCwgaW4gcGl4ZWxzIC0gRGVmYXVsdHMgdG8gMCAobm8gYm9yZGVyKVxuKiAgICAgICBib3JkZXJDb2xvciAtIENvbG9yIHRvIHVzZSBmb3IgdGhlIHBpZSBjaGFydCBib3JkZXIgLSBEZWZhdWx0cyB0byAjMDAwXG4qXG4qICAgYm94IC0gQm94IHBsb3QuIE9wdGlvbnM6XG4qICAgICAgIHJhdyAtIFNldCB0byB0cnVlIHRvIHN1cHBseSBwcmUtY29tcHV0ZWQgcGxvdCBwb2ludHMgYXMgdmFsdWVzXG4qICAgICAgICAgICAgIHZhbHVlcyBzaG91bGQgYmU6IGxvd19vdXRsaWVyLCBsb3dfd2hpc2tlciwgcTEsIG1lZGlhbiwgcTMsIGhpZ2hfd2hpc2tlciwgaGlnaF9vdXRsaWVyXG4qICAgICAgICAgICAgIFdoZW4gc2V0IHRvIGZhbHNlIHlvdSBjYW4gc3VwcGx5IGFueSBudW1iZXIgb2YgdmFsdWVzIGFuZCB0aGUgYm94IHBsb3Qgd2lsbFxuKiAgICAgICAgICAgICBiZSBjb21wdXRlZCBmb3IgeW91LiAgRGVmYXVsdCBpcyBmYWxzZS5cbiogICAgICAgc2hvd091dGxpZXJzIC0gU2V0IHRvIHRydWUgKGRlZmF1bHQpIHRvIGRpc3BsYXkgb3V0bGllcnMgYXMgY2lyY2xlc1xuKiAgICAgICBvdXRsaWVySVFSIC0gSW50ZXJxdWFydGlsZSByYW5nZSB1c2VkIHRvIGRldGVybWluZSBvdXRsaWVycy4gIERlZmF1bHQgMS41XG4qICAgICAgIGJveExpbmVDb2xvciAtIE91dGxpbmUgY29sb3Igb2YgdGhlIGJveFxuKiAgICAgICBib3hGaWxsQ29sb3IgLSBGaWxsIGNvbG9yIGZvciB0aGUgYm94XG4qICAgICAgIHdoaXNrZXJDb2xvciAtIExpbmUgY29sb3IgdXNlZCBmb3Igd2hpc2tlcnNcbiogICAgICAgb3V0bGllckxpbmVDb2xvciAtIE91dGxpbmUgY29sb3Igb2Ygb3V0bGllciBjaXJjbGVzXG4qICAgICAgIG91dGxpZXJGaWxsQ29sb3IgLSBGaWxsIGNvbG9yIG9mIHRoZSBvdXRsaWVyIGNpcmNsZXNcbiogICAgICAgc3BvdFJhZGl1cyAtIFJhZGl1cyBvZiBvdXRsaWVyIGNpcmNsZXNcbiogICAgICAgbWVkaWFuQ29sb3IgLSBMaW5lIGNvbG9yIG9mIHRoZSBtZWRpYW4gbGluZVxuKiAgICAgICB0YXJnZXQgLSBEcmF3IGEgdGFyZ2V0IGNyb3NzIGhhaXIgYXQgdGhlIHN1cHBsaWVkIHZhbHVlIChkZWZhdWx0IHVuZGVmaW5lZClcbipcbipcbipcbiogICBFeGFtcGxlczpcbiogICAkKCcjc3BhcmtsaW5lMScpLnNwYXJrbGluZShteXZhbHVlcywgeyBsaW5lQ29sb3I6ICcjZjAwJywgZmlsbENvbG9yOiBmYWxzZSB9KTtcbiogICAkKCcuYmFyc3BhcmtzJykuc3BhcmtsaW5lKCdodG1sJywgeyB0eXBlOidiYXInLCBoZWlnaHQ6JzQwcHgnLCBiYXJXaWR0aDo1IH0pO1xuKiAgICQoJyN0cmlzdGF0ZScpLnNwYXJrbGluZShbMSwxLC0xLDEsMCwwLC0xXSwgeyB0eXBlOid0cmlzdGF0ZScgfSk6XG4qICAgJCgnI2Rpc2NyZXRlJykuc3BhcmtsaW5lKFsxLDMsNCw1LDUsMyw0LDVdLCB7IHR5cGU6J2Rpc2NyZXRlJyB9KTtcbiogICAkKCcjYnVsbGV0Jykuc3BhcmtsaW5lKFsxMCwxMiwxMiw5LDddLCB7IHR5cGU6J2J1bGxldCcgfSk7XG4qICAgJCgnI3BpZScpLnNwYXJrbGluZShbMSwxLDJdLCB7IHR5cGU6J3BpZScgfSk7XG4qL1xuXG4vKmpzbGludCByZWdleHA6IHRydWUsIGJyb3dzZXI6IHRydWUsIGpxdWVyeTogdHJ1ZSwgd2hpdGU6IHRydWUsIG5vbWVuOiBmYWxzZSwgcGx1c3BsdXM6IGZhbHNlLCBtYXhlcnI6IDUwMCwgaW5kZW50OiA0ICovXG5cbihmdW5jdGlvbihkb2N1bWVudCwgTWF0aCwgdW5kZWZpbmVkKSB7IC8vIHBlcmZvcm1hbmNlL21pbmlmaWVkLXNpemUgb3B0aW1pemF0aW9uXG4oZnVuY3Rpb24oZmFjdG9yeSkge1xuICAgIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuICAgICAgICBkZWZpbmUoWydqcXVlcnknXSwgZmFjdG9yeSk7XG4gICAgfSBlbHNlIGlmIChqUXVlcnkgJiYgIWpRdWVyeS5mbi5zcGFya2xpbmUpIHtcbiAgICAgICAgZmFjdG9yeShqUXVlcnkpO1xuICAgIH1cbn1cbihmdW5jdGlvbigkKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgdmFyIFVOU0VUX09QVElPTiA9IHt9LFxuICAgICAgICBnZXREZWZhdWx0cywgY3JlYXRlQ2xhc3MsIFNQRm9ybWF0LCBjbGlwdmFsLCBxdWFydGlsZSwgbm9ybWFsaXplVmFsdWUsIG5vcm1hbGl6ZVZhbHVlcyxcbiAgICAgICAgcmVtb3ZlLCBpc051bWJlciwgYWxsLCBzdW0sIGFkZENTUywgZW5zdXJlQXJyYXksIGZvcm1hdE51bWJlciwgUmFuZ2VNYXAsXG4gICAgICAgIE1vdXNlSGFuZGxlciwgVG9vbHRpcCwgYmFySGlnaGxpZ2h0TWl4aW4sXG4gICAgICAgIGxpbmUsIGJhciwgdHJpc3RhdGUsIGRpc2NyZXRlLCBidWxsZXQsIHBpZSwgYm94LCBkZWZhdWx0U3R5bGVzLCBpbml0U3R5bGVzLFxuICAgICAgICBWU2hhcGUsIFZDYW52YXNfYmFzZSwgVkNhbnZhc19jYW52YXMsIFZDYW52YXNfdm1sLCBwZW5kaW5nLCBzaGFwZUNvdW50ID0gMDtcblxuICAgIC8qKlxuICAgICAqIERlZmF1bHQgY29uZmlndXJhdGlvbiBzZXR0aW5nc1xuICAgICAqL1xuICAgIGdldERlZmF1bHRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgLy8gU2V0dGluZ3MgY29tbW9uIHRvIG1vc3QvYWxsIGNoYXJ0IHR5cGVzXG4gICAgICAgICAgICBjb21tb246IHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnbGluZScsXG4gICAgICAgICAgICAgICAgbGluZUNvbG9yOiAnIzAwZicsXG4gICAgICAgICAgICAgICAgZmlsbENvbG9yOiAnI2NkZicsXG4gICAgICAgICAgICAgICAgZGVmYXVsdFBpeGVsc1BlclZhbHVlOiAzLFxuICAgICAgICAgICAgICAgIHdpZHRoOiAnYXV0bycsXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiAnYXV0bycsXG4gICAgICAgICAgICAgICAgY29tcG9zaXRlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICB0YWdWYWx1ZXNBdHRyaWJ1dGU6ICd2YWx1ZXMnLFxuICAgICAgICAgICAgICAgIHRhZ09wdGlvbnNQcmVmaXg6ICdzcGFyaycsXG4gICAgICAgICAgICAgICAgZW5hYmxlVGFnT3B0aW9uczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZW5hYmxlSGlnaGxpZ2h0OiB0cnVlLFxuICAgICAgICAgICAgICAgIGhpZ2hsaWdodExpZ2h0ZW46IDEuNCxcbiAgICAgICAgICAgICAgICB0b29sdGlwU2tpcE51bGw6IHRydWUsXG4gICAgICAgICAgICAgICAgdG9vbHRpcFByZWZpeDogJycsXG4gICAgICAgICAgICAgICAgdG9vbHRpcFN1ZmZpeDogJycsXG4gICAgICAgICAgICAgICAgZGlzYWJsZUhpZGRlbkNoZWNrOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBudW1iZXJGb3JtYXR0ZXI6IGZhbHNlLFxuICAgICAgICAgICAgICAgIG51bWJlckRpZ2l0R3JvdXBDb3VudDogMyxcbiAgICAgICAgICAgICAgICBudW1iZXJEaWdpdEdyb3VwU2VwOiAnLCcsXG4gICAgICAgICAgICAgICAgbnVtYmVyRGVjaW1hbE1hcms6ICcuJyxcbiAgICAgICAgICAgICAgICBkaXNhYmxlVG9vbHRpcHM6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGRpc2FibGVJbnRlcmFjdGlvbjogZmFsc2VcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvLyBEZWZhdWx0cyBmb3IgbGluZSBjaGFydHNcbiAgICAgICAgICAgIGxpbmU6IHtcbiAgICAgICAgICAgICAgICBzcG90Q29sb3I6ICcjZjgwJyxcbiAgICAgICAgICAgICAgICBoaWdobGlnaHRTcG90Q29sb3I6ICcjNWY1JyxcbiAgICAgICAgICAgICAgICBoaWdobGlnaHRMaW5lQ29sb3I6ICcjZjIyJyxcbiAgICAgICAgICAgICAgICBzcG90UmFkaXVzOiAxLjUsXG4gICAgICAgICAgICAgICAgbWluU3BvdENvbG9yOiAnI2Y4MCcsXG4gICAgICAgICAgICAgICAgbWF4U3BvdENvbG9yOiAnI2Y4MCcsXG4gICAgICAgICAgICAgICAgbGluZVdpZHRoOiAxLFxuICAgICAgICAgICAgICAgIG5vcm1hbFJhbmdlTWluOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgbm9ybWFsUmFuZ2VNYXg6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICBub3JtYWxSYW5nZUNvbG9yOiAnI2NjYycsXG4gICAgICAgICAgICAgICAgZHJhd05vcm1hbE9uVG9wOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBjaGFydFJhbmdlTWluOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgY2hhcnRSYW5nZU1heDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIGNoYXJ0UmFuZ2VNaW5YOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgY2hhcnRSYW5nZU1heFg6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICB0b29sdGlwRm9ybWF0OiBuZXcgU1BGb3JtYXQoJzxzcGFuIHN0eWxlPVwiY29sb3I6IHt7Y29sb3J9fVwiPiYjOTY3OTs8L3NwYW4+IHt7cHJlZml4fX17e3l9fXt7c3VmZml4fX0nKVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIC8vIERlZmF1bHRzIGZvciBiYXIgY2hhcnRzXG4gICAgICAgICAgICBiYXI6IHtcbiAgICAgICAgICAgICAgICBiYXJDb2xvcjogJyMzMzY2Y2MnLFxuICAgICAgICAgICAgICAgIG5lZ0JhckNvbG9yOiAnI2Y0NCcsXG4gICAgICAgICAgICAgICAgc3RhY2tlZEJhckNvbG9yOiBbJyMzMzY2Y2MnLCAnI2RjMzkxMicsICcjZmY5OTAwJywgJyMxMDk2MTgnLCAnIzY2YWEwMCcsXG4gICAgICAgICAgICAgICAgICAgICcjZGQ0NDc3JywgJyMwMDk5YzYnLCAnIzk5MDA5OSddLFxuICAgICAgICAgICAgICAgIHplcm9Db2xvcjogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIG51bGxDb2xvcjogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIHplcm9BeGlzOiB0cnVlLFxuICAgICAgICAgICAgICAgIGJhcldpZHRoOiA0LFxuICAgICAgICAgICAgICAgIGJhclNwYWNpbmc6IDEsXG4gICAgICAgICAgICAgICAgY2hhcnRSYW5nZU1heDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIGNoYXJ0UmFuZ2VNaW46IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICBjaGFydFJhbmdlQ2xpcDogZmFsc2UsXG4gICAgICAgICAgICAgICAgY29sb3JNYXA6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICB0b29sdGlwRm9ybWF0OiBuZXcgU1BGb3JtYXQoJzxzcGFuIHN0eWxlPVwiY29sb3I6IHt7Y29sb3J9fVwiPiYjOTY3OTs8L3NwYW4+IHt7cHJlZml4fX17e3ZhbHVlfX17e3N1ZmZpeH19JylcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvLyBEZWZhdWx0cyBmb3IgdHJpc3RhdGUgY2hhcnRzXG4gICAgICAgICAgICB0cmlzdGF0ZToge1xuICAgICAgICAgICAgICAgIGJhcldpZHRoOiA0LFxuICAgICAgICAgICAgICAgIGJhclNwYWNpbmc6IDEsXG4gICAgICAgICAgICAgICAgcG9zQmFyQ29sb3I6ICcjNmY2JyxcbiAgICAgICAgICAgICAgICBuZWdCYXJDb2xvcjogJyNmNDQnLFxuICAgICAgICAgICAgICAgIHplcm9CYXJDb2xvcjogJyM5OTknLFxuICAgICAgICAgICAgICAgIGNvbG9yTWFwOiB7fSxcbiAgICAgICAgICAgICAgICB0b29sdGlwRm9ybWF0OiBuZXcgU1BGb3JtYXQoJzxzcGFuIHN0eWxlPVwiY29sb3I6IHt7Y29sb3J9fVwiPiYjOTY3OTs8L3NwYW4+IHt7dmFsdWU6bWFwfX0nKSxcbiAgICAgICAgICAgICAgICB0b29sdGlwVmFsdWVMb29rdXBzOiB7IG1hcDogeyAnLTEnOiAnTG9zcycsICcwJzogJ0RyYXcnLCAnMSc6ICdXaW4nIH0gfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIC8vIERlZmF1bHRzIGZvciBkaXNjcmV0ZSBjaGFydHNcbiAgICAgICAgICAgIGRpc2NyZXRlOiB7XG4gICAgICAgICAgICAgICAgbGluZUhlaWdodDogJ2F1dG8nLFxuICAgICAgICAgICAgICAgIHRocmVzaG9sZENvbG9yOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgdGhyZXNob2xkVmFsdWU6IDAsXG4gICAgICAgICAgICAgICAgY2hhcnRSYW5nZU1heDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIGNoYXJ0UmFuZ2VNaW46IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICBjaGFydFJhbmdlQ2xpcDogZmFsc2UsXG4gICAgICAgICAgICAgICAgdG9vbHRpcEZvcm1hdDogbmV3IFNQRm9ybWF0KCd7e3ByZWZpeH19e3t2YWx1ZX19e3tzdWZmaXh9fScpXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgLy8gRGVmYXVsdHMgZm9yIGJ1bGxldCBjaGFydHNcbiAgICAgICAgICAgIGJ1bGxldDoge1xuICAgICAgICAgICAgICAgIHRhcmdldENvbG9yOiAnI2YzMycsXG4gICAgICAgICAgICAgICAgdGFyZ2V0V2lkdGg6IDMsIC8vIHdpZHRoIG9mIHRoZSB0YXJnZXQgYmFyIGluIHBpeGVsc1xuICAgICAgICAgICAgICAgIHBlcmZvcm1hbmNlQ29sb3I6ICcjMzNmJyxcbiAgICAgICAgICAgICAgICByYW5nZUNvbG9yczogWycjZDNkYWZlJywgJyNhOGI2ZmYnLCAnIzdmOTRmZiddLFxuICAgICAgICAgICAgICAgIGJhc2U6IHVuZGVmaW5lZCwgLy8gc2V0IHRoaXMgdG8gYSBudW1iZXIgdG8gY2hhbmdlIHRoZSBiYXNlIHN0YXJ0IG51bWJlclxuICAgICAgICAgICAgICAgIHRvb2x0aXBGb3JtYXQ6IG5ldyBTUEZvcm1hdCgne3tmaWVsZGtleTpmaWVsZHN9fSAtIHt7dmFsdWV9fScpLFxuICAgICAgICAgICAgICAgIHRvb2x0aXBWYWx1ZUxvb2t1cHM6IHsgZmllbGRzOiB7cjogJ1JhbmdlJywgcDogJ1BlcmZvcm1hbmNlJywgdDogJ1RhcmdldCd9IH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvLyBEZWZhdWx0cyBmb3IgcGllIGNoYXJ0c1xuICAgICAgICAgICAgcGllOiB7XG4gICAgICAgICAgICAgICAgb2Zmc2V0OiAwLFxuICAgICAgICAgICAgICAgIHNsaWNlQ29sb3JzOiBbJyMzMzY2Y2MnLCAnI2RjMzkxMicsICcjZmY5OTAwJywgJyMxMDk2MTgnLCAnIzY2YWEwMCcsXG4gICAgICAgICAgICAgICAgICAgICcjZGQ0NDc3JywgJyMwMDk5YzYnLCAnIzk5MDA5OSddLFxuICAgICAgICAgICAgICAgIGJvcmRlcldpZHRoOiAwLFxuICAgICAgICAgICAgICAgIGJvcmRlckNvbG9yOiAnIzAwMCcsXG4gICAgICAgICAgICAgICAgdG9vbHRpcEZvcm1hdDogbmV3IFNQRm9ybWF0KCc8c3BhbiBzdHlsZT1cImNvbG9yOiB7e2NvbG9yfX1cIj4mIzk2Nzk7PC9zcGFuPiB7e3ZhbHVlfX0gKHt7cGVyY2VudC4xfX0lKScpXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgLy8gRGVmYXVsdHMgZm9yIGJveCBwbG90c1xuICAgICAgICAgICAgYm94OiB7XG4gICAgICAgICAgICAgICAgcmF3OiBmYWxzZSxcbiAgICAgICAgICAgICAgICBib3hMaW5lQ29sb3I6ICcjMDAwJyxcbiAgICAgICAgICAgICAgICBib3hGaWxsQ29sb3I6ICcjY2RmJyxcbiAgICAgICAgICAgICAgICB3aGlza2VyQ29sb3I6ICcjMDAwJyxcbiAgICAgICAgICAgICAgICBvdXRsaWVyTGluZUNvbG9yOiAnIzMzMycsXG4gICAgICAgICAgICAgICAgb3V0bGllckZpbGxDb2xvcjogJyNmZmYnLFxuICAgICAgICAgICAgICAgIG1lZGlhbkNvbG9yOiAnI2YwMCcsXG4gICAgICAgICAgICAgICAgc2hvd091dGxpZXJzOiB0cnVlLFxuICAgICAgICAgICAgICAgIG91dGxpZXJJUVI6IDEuNSxcbiAgICAgICAgICAgICAgICBzcG90UmFkaXVzOiAxLjUsXG4gICAgICAgICAgICAgICAgdGFyZ2V0OiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgdGFyZ2V0Q29sb3I6ICcjNGEyJyxcbiAgICAgICAgICAgICAgICBjaGFydFJhbmdlTWF4OiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgY2hhcnRSYW5nZU1pbjogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIHRvb2x0aXBGb3JtYXQ6IG5ldyBTUEZvcm1hdCgne3tmaWVsZDpmaWVsZHN9fToge3t2YWx1ZX19JyksXG4gICAgICAgICAgICAgICAgdG9vbHRpcEZvcm1hdEZpZWxkbGlzdEtleTogJ2ZpZWxkJyxcbiAgICAgICAgICAgICAgICB0b29sdGlwVmFsdWVMb29rdXBzOiB7IGZpZWxkczogeyBscTogJ0xvd2VyIFF1YXJ0aWxlJywgbWVkOiAnTWVkaWFuJyxcbiAgICAgICAgICAgICAgICAgICAgdXE6ICdVcHBlciBRdWFydGlsZScsIGxvOiAnTGVmdCBPdXRsaWVyJywgcm86ICdSaWdodCBPdXRsaWVyJyxcbiAgICAgICAgICAgICAgICAgICAgbHc6ICdMZWZ0IFdoaXNrZXInLCBydzogJ1JpZ2h0IFdoaXNrZXInfSB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIC8vIFlvdSBjYW4gaGF2ZSB0b29sdGlwcyB1c2UgYSBjc3MgY2xhc3Mgb3RoZXIgdGhhbiBqcXN0b29sdGlwIGJ5IHNwZWNpZnlpbmcgdG9vbHRpcENsYXNzbmFtZVxuICAgIGRlZmF1bHRTdHlsZXMgPSAnLmpxc3Rvb2x0aXAgeyAnICtcbiAgICAgICAgICAgICdwb3NpdGlvbjogYWJzb2x1dGU7JyArXG4gICAgICAgICAgICAnbGVmdDogMHB4OycgK1xuICAgICAgICAgICAgJ3RvcDogMHB4OycgK1xuICAgICAgICAgICAgJ3Zpc2liaWxpdHk6IGhpZGRlbjsnICtcbiAgICAgICAgICAgICdiYWNrZ3JvdW5kOiByZ2IoMCwgMCwgMCkgdHJhbnNwYXJlbnQ7JyArXG4gICAgICAgICAgICAnYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLDAsMCwwLjYpOycgK1xuICAgICAgICAgICAgJ2ZpbHRlcjpwcm9naWQ6RFhJbWFnZVRyYW5zZm9ybS5NaWNyb3NvZnQuZ3JhZGllbnQoc3RhcnRDb2xvcnN0cj0jOTkwMDAwMDAsIGVuZENvbG9yc3RyPSM5OTAwMDAwMCk7JyArXG4gICAgICAgICAgICAnLW1zLWZpbHRlcjogXCJwcm9naWQ6RFhJbWFnZVRyYW5zZm9ybS5NaWNyb3NvZnQuZ3JhZGllbnQoc3RhcnRDb2xvcnN0cj0jOTkwMDAwMDAsIGVuZENvbG9yc3RyPSM5OTAwMDAwMClcIjsnICtcbiAgICAgICAgICAgICdjb2xvcjogd2hpdGU7JyArXG4gICAgICAgICAgICAnZm9udDogMTBweCBhcmlhbCwgc2FuIHNlcmlmOycgK1xuICAgICAgICAgICAgJ3RleHQtYWxpZ246IGxlZnQ7JyArXG4gICAgICAgICAgICAnd2hpdGUtc3BhY2U6IG5vd3JhcDsnICtcbiAgICAgICAgICAgICdwYWRkaW5nOiA1cHg7JyArXG4gICAgICAgICAgICAnYm9yZGVyOiAxcHggc29saWQgd2hpdGU7JyArXG4gICAgICAgICAgICAnYm94LXNpemluZzogY29udGVudC1ib3g7JyArXG4gICAgICAgICAgICAnei1pbmRleDogMTAwMDA7JyArXG4gICAgICAgICAgICAnfScgK1xuICAgICAgICAgICAgJy5qcXNmaWVsZCB7ICcgK1xuICAgICAgICAgICAgJ2NvbG9yOiB3aGl0ZTsnICtcbiAgICAgICAgICAgICdmb250OiAxMHB4IGFyaWFsLCBzYW4gc2VyaWY7JyArXG4gICAgICAgICAgICAndGV4dC1hbGlnbjogbGVmdDsnICtcbiAgICAgICAgICAgICd9JztcblxuICAgIC8qKlxuICAgICAqIFV0aWxpdGllc1xuICAgICAqL1xuXG4gICAgY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoLyogW2Jhc2VjbGFzcywgW21peGluLCAuLi5dXSwgZGVmaW5pdGlvbiAqLykge1xuICAgICAgICB2YXIgQ2xhc3MsIGFyZ3M7XG4gICAgICAgIENsYXNzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5pbml0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgIH07XG4gICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgaWYgKGFyZ3VtZW50c1swXSkge1xuICAgICAgICAgICAgICAgIENsYXNzLnByb3RvdHlwZSA9ICQuZXh0ZW5kKG5ldyBhcmd1bWVudHNbMF0oKSwgYXJndW1lbnRzW2FyZ3VtZW50cy5sZW5ndGggLSAxXSk7XG4gICAgICAgICAgICAgICAgQ2xhc3MuX3N1cGVyID0gYXJndW1lbnRzWzBdLnByb3RvdHlwZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgQ2xhc3MucHJvdG90eXBlID0gYXJndW1lbnRzW2FyZ3VtZW50cy5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMikge1xuICAgICAgICAgICAgICAgIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEsIC0xKTtcbiAgICAgICAgICAgICAgICBhcmdzLnVuc2hpZnQoQ2xhc3MucHJvdG90eXBlKTtcbiAgICAgICAgICAgICAgICAkLmV4dGVuZC5hcHBseSgkLCBhcmdzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIENsYXNzLnByb3RvdHlwZSA9IGFyZ3VtZW50c1swXTtcbiAgICAgICAgfVxuICAgICAgICBDbGFzcy5wcm90b3R5cGUuY2xzID0gQ2xhc3M7XG4gICAgICAgIHJldHVybiBDbGFzcztcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogV3JhcHMgYSBmb3JtYXQgc3RyaW5nIGZvciB0b29sdGlwc1xuICAgICAqIHt7eH19XG4gICAgICoge3t4LjJ9XG4gICAgICoge3t4Om1vbnRoc319XG4gICAgICovXG4gICAgJC5TUEZvcm1hdENsYXNzID0gU1BGb3JtYXQgPSBjcmVhdGVDbGFzcyh7XG4gICAgICAgIGZyZTogL1xce1xceyhbXFx3Ll0rPykoOiguKz8pKT9cXH1cXH0vZyxcbiAgICAgICAgcHJlY3JlOiAvKFxcdyspXFwuKFxcZCspLyxcblxuICAgICAgICBpbml0OiBmdW5jdGlvbiAoZm9ybWF0LCBmY2xhc3MpIHtcbiAgICAgICAgICAgIHRoaXMuZm9ybWF0ID0gZm9ybWF0O1xuICAgICAgICAgICAgdGhpcy5mY2xhc3MgPSBmY2xhc3M7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoZmllbGRzZXQsIGxvb2t1cHMsIG9wdGlvbnMpIHtcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcyxcbiAgICAgICAgICAgICAgICBmaWVsZHMgPSBmaWVsZHNldCxcbiAgICAgICAgICAgICAgICBtYXRjaCwgdG9rZW4sIGxvb2t1cGtleSwgZmllbGR2YWx1ZSwgcHJlYztcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZvcm1hdC5yZXBsYWNlKHRoaXMuZnJlLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGxvb2t1cDtcbiAgICAgICAgICAgICAgICB0b2tlbiA9IGFyZ3VtZW50c1sxXTtcbiAgICAgICAgICAgICAgICBsb29rdXBrZXkgPSBhcmd1bWVudHNbM107XG4gICAgICAgICAgICAgICAgbWF0Y2ggPSBzZWxmLnByZWNyZS5leGVjKHRva2VuKTtcbiAgICAgICAgICAgICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgICAgICAgICAgICAgcHJlYyA9IG1hdGNoWzJdO1xuICAgICAgICAgICAgICAgICAgICB0b2tlbiA9IG1hdGNoWzFdO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHByZWMgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZmllbGR2YWx1ZSA9IGZpZWxkc1t0b2tlbl07XG4gICAgICAgICAgICAgICAgaWYgKGZpZWxkdmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChsb29rdXBrZXkgJiYgbG9va3VwcyAmJiBsb29rdXBzW2xvb2t1cGtleV0pIHtcbiAgICAgICAgICAgICAgICAgICAgbG9va3VwID0gbG9va3Vwc1tsb29rdXBrZXldO1xuICAgICAgICAgICAgICAgICAgICBpZiAobG9va3VwLmdldCkgeyAvLyBSYW5nZU1hcFxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxvb2t1cHNbbG9va3Vwa2V5XS5nZXQoZmllbGR2YWx1ZSkgfHwgZmllbGR2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBsb29rdXBzW2xvb2t1cGtleV1bZmllbGR2YWx1ZV0gfHwgZmllbGR2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoaXNOdW1iZXIoZmllbGR2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuZ2V0KCdudW1iZXJGb3JtYXR0ZXInKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZmllbGR2YWx1ZSA9IG9wdGlvbnMuZ2V0KCdudW1iZXJGb3JtYXR0ZXInKShmaWVsZHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkdmFsdWUgPSBmb3JtYXROdW1iZXIoZmllbGR2YWx1ZSwgcHJlYyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmdldCgnbnVtYmVyRGlnaXRHcm91cENvdW50JyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5nZXQoJ251bWJlckRpZ2l0R3JvdXBTZXAnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmdldCgnbnVtYmVyRGVjaW1hbE1hcmsnKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZpZWxkdmFsdWU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gY29udmllbmNlIG1ldGhvZCB0byBhdm9pZCBuZWVkaW5nIHRoZSBuZXcgb3BlcmF0b3JcbiAgICAkLnNwZm9ybWF0ID0gZnVuY3Rpb24oZm9ybWF0LCBmY2xhc3MpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBTUEZvcm1hdChmb3JtYXQsIGZjbGFzcyk7XG4gICAgfTtcblxuICAgIGNsaXB2YWwgPSBmdW5jdGlvbiAodmFsLCBtaW4sIG1heCkge1xuICAgICAgICBpZiAodmFsIDwgbWluKSB7XG4gICAgICAgICAgICByZXR1cm4gbWluO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2YWwgPiBtYXgpIHtcbiAgICAgICAgICAgIHJldHVybiBtYXg7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbDtcbiAgICB9O1xuXG4gICAgcXVhcnRpbGUgPSBmdW5jdGlvbiAodmFsdWVzLCBxKSB7XG4gICAgICAgIHZhciB2bDtcbiAgICAgICAgaWYgKHEgPT09IDIpIHtcbiAgICAgICAgICAgIHZsID0gTWF0aC5mbG9vcih2YWx1ZXMubGVuZ3RoIC8gMik7XG4gICAgICAgICAgICByZXR1cm4gdmFsdWVzLmxlbmd0aCAlIDIgPyB2YWx1ZXNbdmxdIDogKHZhbHVlc1t2bC0xXSArIHZhbHVlc1t2bF0pIC8gMjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmICh2YWx1ZXMubGVuZ3RoICUgMiApIHsgLy8gb2RkXG4gICAgICAgICAgICAgICAgdmwgPSAodmFsdWVzLmxlbmd0aCAqIHEgKyBxKSAvIDQ7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZsICUgMSA/ICh2YWx1ZXNbTWF0aC5mbG9vcih2bCldICsgdmFsdWVzW01hdGguZmxvb3IodmwpIC0gMV0pIC8gMiA6IHZhbHVlc1t2bC0xXTtcbiAgICAgICAgICAgIH0gZWxzZSB7IC8vZXZlblxuICAgICAgICAgICAgICAgIHZsID0gKHZhbHVlcy5sZW5ndGggKiBxICsgMikgLyA0O1xuICAgICAgICAgICAgICAgIHJldHVybiB2bCAlIDEgPyAodmFsdWVzW01hdGguZmxvb3IodmwpXSArIHZhbHVlc1tNYXRoLmZsb29yKHZsKSAtIDFdKSAvIDIgOiAgdmFsdWVzW3ZsLTFdO1xuXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgbm9ybWFsaXplVmFsdWUgPSBmdW5jdGlvbiAodmFsKSB7XG4gICAgICAgIHZhciBuZjtcbiAgICAgICAgc3dpdGNoICh2YWwpIHtcbiAgICAgICAgICAgIGNhc2UgJ3VuZGVmaW5lZCc6XG4gICAgICAgICAgICAgICAgdmFsID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnbnVsbCc6XG4gICAgICAgICAgICAgICAgdmFsID0gbnVsbDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3RydWUnOlxuICAgICAgICAgICAgICAgIHZhbCA9IHRydWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdmYWxzZSc6XG4gICAgICAgICAgICAgICAgdmFsID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIG5mID0gcGFyc2VGbG9hdCh2YWwpO1xuICAgICAgICAgICAgICAgIGlmICh2YWwgPT0gbmYpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsID0gbmY7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWw7XG4gICAgfTtcblxuICAgIG5vcm1hbGl6ZVZhbHVlcyA9IGZ1bmN0aW9uICh2YWxzKSB7XG4gICAgICAgIHZhciBpLCByZXN1bHQgPSBbXTtcbiAgICAgICAgZm9yIChpID0gdmFscy5sZW5ndGg7IGktLTspIHtcbiAgICAgICAgICAgIHJlc3VsdFtpXSA9IG5vcm1hbGl6ZVZhbHVlKHZhbHNbaV0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcblxuICAgIHJlbW92ZSA9IGZ1bmN0aW9uICh2YWxzLCBmaWx0ZXIpIHtcbiAgICAgICAgdmFyIGksIHZsLCByZXN1bHQgPSBbXTtcbiAgICAgICAgZm9yIChpID0gMCwgdmwgPSB2YWxzLmxlbmd0aDsgaSA8IHZsOyBpKyspIHtcbiAgICAgICAgICAgIGlmICh2YWxzW2ldICE9PSBmaWx0ZXIpIHtcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaCh2YWxzW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG5cbiAgICBpc051bWJlciA9IGZ1bmN0aW9uIChudW0pIHtcbiAgICAgICAgcmV0dXJuICFpc05hTihwYXJzZUZsb2F0KG51bSkpICYmIGlzRmluaXRlKG51bSk7XG4gICAgfTtcblxuICAgIGZvcm1hdE51bWJlciA9IGZ1bmN0aW9uIChudW0sIHByZWMsIGdyb3Vwc2l6ZSwgZ3JvdXBzZXAsIGRlY3NlcCkge1xuICAgICAgICB2YXIgcCwgaTtcbiAgICAgICAgbnVtID0gKHByZWMgPT09IGZhbHNlID8gcGFyc2VGbG9hdChudW0pLnRvU3RyaW5nKCkgOiBudW0udG9GaXhlZChwcmVjKSkuc3BsaXQoJycpO1xuICAgICAgICBwID0gKHAgPSAkLmluQXJyYXkoJy4nLCBudW0pKSA8IDAgPyBudW0ubGVuZ3RoIDogcDtcbiAgICAgICAgaWYgKHAgPCBudW0ubGVuZ3RoKSB7XG4gICAgICAgICAgICBudW1bcF0gPSBkZWNzZXA7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChpID0gcCAtIGdyb3Vwc2l6ZTsgaSA+IDA7IGkgLT0gZ3JvdXBzaXplKSB7XG4gICAgICAgICAgICBudW0uc3BsaWNlKGksIDAsIGdyb3Vwc2VwKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVtLmpvaW4oJycpO1xuICAgIH07XG5cbiAgICAvLyBkZXRlcm1pbmUgaWYgYWxsIHZhbHVlcyBvZiBhbiBhcnJheSBtYXRjaCBhIHZhbHVlXG4gICAgLy8gcmV0dXJucyB0cnVlIGlmIHRoZSBhcnJheSBpcyBlbXB0eVxuICAgIGFsbCA9IGZ1bmN0aW9uICh2YWwsIGFyciwgaWdub3JlTnVsbCkge1xuICAgICAgICB2YXIgaTtcbiAgICAgICAgZm9yIChpID0gYXJyLmxlbmd0aDsgaS0tOyApIHtcbiAgICAgICAgICAgIGlmIChpZ25vcmVOdWxsICYmIGFycltpXSA9PT0gbnVsbCkgY29udGludWU7XG4gICAgICAgICAgICBpZiAoYXJyW2ldICE9PSB2YWwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcblxuICAgIC8vIHN1bXMgdGhlIG51bWVyaWMgdmFsdWVzIGluIGFuIGFycmF5LCBpZ25vcmluZyBvdGhlciB2YWx1ZXNcbiAgICBzdW0gPSBmdW5jdGlvbiAodmFscykge1xuICAgICAgICB2YXIgdG90YWwgPSAwLCBpO1xuICAgICAgICBmb3IgKGkgPSB2YWxzLmxlbmd0aDsgaS0tOykge1xuICAgICAgICAgICAgdG90YWwgKz0gdHlwZW9mIHZhbHNbaV0gPT09ICdudW1iZXInID8gdmFsc1tpXSA6IDA7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsO1xuICAgIH07XG5cbiAgICBlbnN1cmVBcnJheSA9IGZ1bmN0aW9uICh2YWwpIHtcbiAgICAgICAgcmV0dXJuICQuaXNBcnJheSh2YWwpID8gdmFsIDogW3ZhbF07XG4gICAgfTtcblxuICAgIC8vIGh0dHA6Ly9wYXVsaXJpc2guY29tLzIwMDgvYm9va21hcmtsZXQtaW5qZWN0LW5ldy1jc3MtcnVsZXMvXG4gICAgYWRkQ1NTID0gZnVuY3Rpb24oY3NzKSB7XG4gICAgICAgIHZhciB0YWcsIGllZmFpbDtcbiAgICAgICAgaWYgKGRvY3VtZW50LmNyZWF0ZVN0eWxlU2hlZXQpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuY3JlYXRlU3R5bGVTaGVldCgpLmNzc1RleHQgPSBjc3M7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIC8vIElFIDw9IDkgbWF4ZXMgb3V0IGF0IDMxIHN0eWxlc2hlZXRzOyBpbmplY3QgaW50byBwYWdlIGluc3RlYWQuXG4gICAgICAgICAgICAgICAgaWVmYWlsID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0YWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdHlsZScpO1xuICAgICAgICB0YWcudHlwZSA9ICd0ZXh0L2Nzcyc7XG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoZWFkJylbMF0uYXBwZW5kQ2hpbGQodGFnKTtcbiAgICAgICAgaWYgKGllZmFpbCkge1xuICAgICAgICAgICAgZG9jdW1lbnQuc3R5bGVTaGVldHNbZG9jdW1lbnQuc3R5bGVTaGVldHMubGVuZ3RoIC0gMV0uY3NzVGV4dCA9IGNzcztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRhZ1sodHlwZW9mIGRvY3VtZW50LmJvZHkuc3R5bGUuV2Via2l0QXBwZWFyYW5jZSA9PSAnc3RyaW5nJykgLyogd2Via2l0IG9ubHkgKi8gPyAnaW5uZXJUZXh0JyA6ICdpbm5lckhUTUwnXSA9IGNzcztcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAvLyBQcm92aWRlIGEgY3Jvc3MtYnJvd3NlciBpbnRlcmZhY2UgdG8gYSBmZXcgc2ltcGxlIGRyYXdpbmcgcHJpbWl0aXZlc1xuICAgICQuZm4uc2ltcGxlZHJhdyA9IGZ1bmN0aW9uICh3aWR0aCwgaGVpZ2h0LCB1c2VFeGlzdGluZywgaW50ZXJhY3QpIHtcbiAgICAgICAgdmFyIHRhcmdldCwgbWhhbmRsZXI7XG4gICAgICAgIGlmICh1c2VFeGlzdGluZyAmJiAodGFyZ2V0ID0gdGhpcy5kYXRhKCdfanFzX3ZjYW52YXMnKSkpIHtcbiAgICAgICAgICAgIHJldHVybiB0YXJnZXQ7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoJC5mbi5zcGFya2xpbmUuY2FudmFzID09PSBmYWxzZSkge1xuICAgICAgICAgICAgLy8gV2UndmUgYWxyZWFkeSBkZXRlcm1pbmVkIHRoYXQgbmVpdGhlciBDYW52YXMgbm9yIFZNTCBhcmUgYXZhaWxhYmxlXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgfSBlbHNlIGlmICgkLmZuLnNwYXJrbGluZS5jYW52YXMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgLy8gTm8gZnVuY3Rpb24gZGVmaW5lZCB5ZXQgLS0gbmVlZCB0byBzZWUgaWYgd2Ugc3VwcG9ydCBDYW52YXMgb3IgVk1MXG4gICAgICAgICAgICB2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcbiAgICAgICAgICAgIGlmICghIShlbC5nZXRDb250ZXh0ICYmIGVsLmdldENvbnRleHQoJzJkJykpKSB7XG4gICAgICAgICAgICAgICAgLy8gQ2FudmFzIGlzIGF2YWlsYWJsZVxuICAgICAgICAgICAgICAgICQuZm4uc3BhcmtsaW5lLmNhbnZhcyA9IGZ1bmN0aW9uKHdpZHRoLCBoZWlnaHQsIHRhcmdldCwgaW50ZXJhY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBWQ2FudmFzX2NhbnZhcyh3aWR0aCwgaGVpZ2h0LCB0YXJnZXQsIGludGVyYWN0KTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIGlmIChkb2N1bWVudC5uYW1lc3BhY2VzICYmICFkb2N1bWVudC5uYW1lc3BhY2VzLnYpIHtcbiAgICAgICAgICAgICAgICAvLyBWTUwgaXMgYXZhaWxhYmxlXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQubmFtZXNwYWNlcy5hZGQoJ3YnLCAndXJuOnNjaGVtYXMtbWljcm9zb2Z0LWNvbTp2bWwnLCAnI2RlZmF1bHQjVk1MJyk7XG4gICAgICAgICAgICAgICAgJC5mbi5zcGFya2xpbmUuY2FudmFzID0gZnVuY3Rpb24od2lkdGgsIGhlaWdodCwgdGFyZ2V0LCBpbnRlcmFjdCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFZDYW52YXNfdm1sKHdpZHRoLCBoZWlnaHQsIHRhcmdldCk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gTmVpdGhlciBDYW52YXMgbm9yIFZNTCBhcmUgYXZhaWxhYmxlXG4gICAgICAgICAgICAgICAgJC5mbi5zcGFya2xpbmUuY2FudmFzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHdpZHRoID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHdpZHRoID0gJCh0aGlzKS5pbm5lcldpZHRoKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGhlaWdodCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBoZWlnaHQgPSAkKHRoaXMpLmlubmVySGVpZ2h0KCk7XG4gICAgICAgIH1cblxuICAgICAgICB0YXJnZXQgPSAkLmZuLnNwYXJrbGluZS5jYW52YXMod2lkdGgsIGhlaWdodCwgdGhpcywgaW50ZXJhY3QpO1xuXG4gICAgICAgIG1oYW5kbGVyID0gJCh0aGlzKS5kYXRhKCdfanFzX21oYW5kbGVyJyk7XG4gICAgICAgIGlmIChtaGFuZGxlcikge1xuICAgICAgICAgICAgbWhhbmRsZXIucmVnaXN0ZXJDYW52YXModGFyZ2V0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGFyZ2V0O1xuICAgIH07XG5cbiAgICAkLmZuLmNsZWFyZHJhdyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRhcmdldCA9IHRoaXMuZGF0YSgnX2pxc192Y2FudmFzJyk7XG4gICAgICAgIGlmICh0YXJnZXQpIHtcbiAgICAgICAgICAgIHRhcmdldC5yZXNldCgpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgICQuUmFuZ2VNYXBDbGFzcyA9IFJhbmdlTWFwID0gY3JlYXRlQ2xhc3Moe1xuICAgICAgICBpbml0OiBmdW5jdGlvbiAobWFwKSB7XG4gICAgICAgICAgICB2YXIga2V5LCByYW5nZSwgcmFuZ2VsaXN0ID0gW107XG4gICAgICAgICAgICBmb3IgKGtleSBpbiBtYXApIHtcbiAgICAgICAgICAgICAgICBpZiAobWFwLmhhc093blByb3BlcnR5KGtleSkgJiYgdHlwZW9mIGtleSA9PT0gJ3N0cmluZycgJiYga2V5LmluZGV4T2YoJzonKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHJhbmdlID0ga2V5LnNwbGl0KCc6Jyk7XG4gICAgICAgICAgICAgICAgICAgIHJhbmdlWzBdID0gcmFuZ2VbMF0ubGVuZ3RoID09PSAwID8gLUluZmluaXR5IDogcGFyc2VGbG9hdChyYW5nZVswXSk7XG4gICAgICAgICAgICAgICAgICAgIHJhbmdlWzFdID0gcmFuZ2VbMV0ubGVuZ3RoID09PSAwID8gSW5maW5pdHkgOiBwYXJzZUZsb2F0KHJhbmdlWzFdKTtcbiAgICAgICAgICAgICAgICAgICAgcmFuZ2VbMl0gPSBtYXBba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgcmFuZ2VsaXN0LnB1c2gocmFuZ2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubWFwID0gbWFwO1xuICAgICAgICAgICAgdGhpcy5yYW5nZWxpc3QgPSByYW5nZWxpc3QgfHwgZmFsc2U7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHZhciByYW5nZWxpc3QgPSB0aGlzLnJhbmdlbGlzdCxcbiAgICAgICAgICAgICAgICBpLCByYW5nZSwgcmVzdWx0O1xuICAgICAgICAgICAgaWYgKChyZXN1bHQgPSB0aGlzLm1hcFt2YWx1ZV0pICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHJhbmdlbGlzdCkge1xuICAgICAgICAgICAgICAgIGZvciAoaSA9IHJhbmdlbGlzdC5sZW5ndGg7IGktLTspIHtcbiAgICAgICAgICAgICAgICAgICAgcmFuZ2UgPSByYW5nZWxpc3RbaV07XG4gICAgICAgICAgICAgICAgICAgIGlmIChyYW5nZVswXSA8PSB2YWx1ZSAmJiByYW5nZVsxXSA+PSB2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJhbmdlWzJdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gQ29udmVuaWVuY2UgZnVuY3Rpb25cbiAgICAkLnJhbmdlX21hcCA9IGZ1bmN0aW9uKG1hcCkge1xuICAgICAgICByZXR1cm4gbmV3IFJhbmdlTWFwKG1hcCk7XG4gICAgfTtcblxuICAgIE1vdXNlSGFuZGxlciA9IGNyZWF0ZUNsYXNzKHtcbiAgICAgICAgaW5pdDogZnVuY3Rpb24gKGVsLCBvcHRpb25zKSB7XG4gICAgICAgICAgICB2YXIgJGVsID0gJChlbCk7XG4gICAgICAgICAgICB0aGlzLiRlbCA9ICRlbDtcbiAgICAgICAgICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRQYWdlWCA9IDA7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRQYWdlWSA9IDA7XG4gICAgICAgICAgICB0aGlzLmVsID0gZWw7XG4gICAgICAgICAgICB0aGlzLnNwbGlzdCA9IFtdO1xuICAgICAgICAgICAgdGhpcy50b29sdGlwID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMub3ZlciA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5kaXNwbGF5VG9vbHRpcHMgPSAhb3B0aW9ucy5nZXQoJ2Rpc2FibGVUb29sdGlwcycpO1xuICAgICAgICAgICAgdGhpcy5oaWdobGlnaHRFbmFibGVkID0gIW9wdGlvbnMuZ2V0KCdkaXNhYmxlSGlnaGxpZ2h0Jyk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVnaXN0ZXJTcGFya2xpbmU6IGZ1bmN0aW9uIChzcCkge1xuICAgICAgICAgICAgdGhpcy5zcGxpc3QucHVzaChzcCk7XG4gICAgICAgICAgICBpZiAodGhpcy5vdmVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVEaXNwbGF5KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVnaXN0ZXJDYW52YXM6IGZ1bmN0aW9uIChjYW52YXMpIHtcbiAgICAgICAgICAgIHZhciAkY2FudmFzID0gJChjYW52YXMuY2FudmFzKTtcbiAgICAgICAgICAgIHRoaXMuY2FudmFzID0gY2FudmFzO1xuICAgICAgICAgICAgdGhpcy4kY2FudmFzID0gJGNhbnZhcztcbiAgICAgICAgICAgICRjYW52YXMubW91c2VlbnRlcigkLnByb3h5KHRoaXMubW91c2VlbnRlciwgdGhpcykpO1xuICAgICAgICAgICAgJGNhbnZhcy5tb3VzZWxlYXZlKCQucHJveHkodGhpcy5tb3VzZWxlYXZlLCB0aGlzKSk7XG4gICAgICAgICAgICAkY2FudmFzLmNsaWNrKCQucHJveHkodGhpcy5tb3VzZWNsaWNrLCB0aGlzKSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVzZXQ6IGZ1bmN0aW9uIChyZW1vdmVUb29sdGlwKSB7XG4gICAgICAgICAgICB0aGlzLnNwbGlzdCA9IFtdO1xuICAgICAgICAgICAgaWYgKHRoaXMudG9vbHRpcCAmJiByZW1vdmVUb29sdGlwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy50b29sdGlwLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIHRoaXMudG9vbHRpcCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBtb3VzZWNsaWNrOiBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgdmFyIGNsaWNrRXZlbnQgPSAkLkV2ZW50KCdzcGFya2xpbmVDbGljaycpO1xuICAgICAgICAgICAgY2xpY2tFdmVudC5vcmlnaW5hbEV2ZW50ID0gZTtcbiAgICAgICAgICAgIGNsaWNrRXZlbnQuc3BhcmtsaW5lcyA9IHRoaXMuc3BsaXN0O1xuICAgICAgICAgICAgdGhpcy4kZWwudHJpZ2dlcihjbGlja0V2ZW50KTtcbiAgICAgICAgfSxcblxuICAgICAgICBtb3VzZWVudGVyOiBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgJChkb2N1bWVudC5ib2R5KS51bmJpbmQoJ21vdXNlbW92ZS5qcXMnKTtcbiAgICAgICAgICAgICQoZG9jdW1lbnQuYm9keSkuYmluZCgnbW91c2Vtb3ZlLmpxcycsICQucHJveHkodGhpcy5tb3VzZW1vdmUsIHRoaXMpKTtcbiAgICAgICAgICAgIHRoaXMub3ZlciA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRQYWdlWCA9IGUucGFnZVg7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRQYWdlWSA9IGUucGFnZVk7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRFbCA9IGUudGFyZ2V0O1xuICAgICAgICAgICAgaWYgKCF0aGlzLnRvb2x0aXAgJiYgdGhpcy5kaXNwbGF5VG9vbHRpcHMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRvb2x0aXAgPSBuZXcgVG9vbHRpcCh0aGlzLm9wdGlvbnMpO1xuICAgICAgICAgICAgICAgIHRoaXMudG9vbHRpcC51cGRhdGVQb3NpdGlvbihlLnBhZ2VYLCBlLnBhZ2VZKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMudXBkYXRlRGlzcGxheSgpO1xuICAgICAgICB9LFxuXG4gICAgICAgIG1vdXNlbGVhdmU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICQoZG9jdW1lbnQuYm9keSkudW5iaW5kKCdtb3VzZW1vdmUuanFzJyk7XG4gICAgICAgICAgICB2YXIgc3BsaXN0ID0gdGhpcy5zcGxpc3QsXG4gICAgICAgICAgICAgICAgIHNwY291bnQgPSBzcGxpc3QubGVuZ3RoLFxuICAgICAgICAgICAgICAgICBuZWVkc1JlZnJlc2ggPSBmYWxzZSxcbiAgICAgICAgICAgICAgICAgc3AsIGk7XG4gICAgICAgICAgICB0aGlzLm92ZXIgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudEVsID0gbnVsbDtcblxuICAgICAgICAgICAgaWYgKHRoaXMudG9vbHRpcCkge1xuICAgICAgICAgICAgICAgIHRoaXMudG9vbHRpcC5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnRvb2x0aXAgPSBudWxsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgc3Bjb3VudDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgc3AgPSBzcGxpc3RbaV07XG4gICAgICAgICAgICAgICAgaWYgKHNwLmNsZWFyUmVnaW9uSGlnaGxpZ2h0KCkpIHtcbiAgICAgICAgICAgICAgICAgICAgbmVlZHNSZWZyZXNoID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChuZWVkc1JlZnJlc2gpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNhbnZhcy5yZW5kZXIoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBtb3VzZW1vdmU6IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRQYWdlWCA9IGUucGFnZVg7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRQYWdlWSA9IGUucGFnZVk7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRFbCA9IGUudGFyZ2V0O1xuICAgICAgICAgICAgaWYgKHRoaXMudG9vbHRpcCkge1xuICAgICAgICAgICAgICAgIHRoaXMudG9vbHRpcC51cGRhdGVQb3NpdGlvbihlLnBhZ2VYLCBlLnBhZ2VZKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMudXBkYXRlRGlzcGxheSgpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHVwZGF0ZURpc3BsYXk6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBzcGxpc3QgPSB0aGlzLnNwbGlzdCxcbiAgICAgICAgICAgICAgICAgc3Bjb3VudCA9IHNwbGlzdC5sZW5ndGgsXG4gICAgICAgICAgICAgICAgIG5lZWRzUmVmcmVzaCA9IGZhbHNlLFxuICAgICAgICAgICAgICAgICBvZmZzZXQgPSB0aGlzLiRjYW52YXMub2Zmc2V0KCksXG4gICAgICAgICAgICAgICAgIGxvY2FsWCA9IHRoaXMuY3VycmVudFBhZ2VYIC0gb2Zmc2V0LmxlZnQsXG4gICAgICAgICAgICAgICAgIGxvY2FsWSA9IHRoaXMuY3VycmVudFBhZ2VZIC0gb2Zmc2V0LnRvcCxcbiAgICAgICAgICAgICAgICAgdG9vbHRpcGh0bWwsIHNwLCBpLCByZXN1bHQsIGNoYW5nZUV2ZW50O1xuICAgICAgICAgICAgaWYgKCF0aGlzLm92ZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgc3Bjb3VudDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgc3AgPSBzcGxpc3RbaV07XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gc3Auc2V0UmVnaW9uSGlnaGxpZ2h0KHRoaXMuY3VycmVudEVsLCBsb2NhbFgsIGxvY2FsWSk7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBuZWVkc1JlZnJlc2ggPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChuZWVkc1JlZnJlc2gpIHtcbiAgICAgICAgICAgICAgICBjaGFuZ2VFdmVudCA9ICQuRXZlbnQoJ3NwYXJrbGluZVJlZ2lvbkNoYW5nZScpO1xuICAgICAgICAgICAgICAgIGNoYW5nZUV2ZW50LnNwYXJrbGluZXMgPSB0aGlzLnNwbGlzdDtcbiAgICAgICAgICAgICAgICB0aGlzLiRlbC50cmlnZ2VyKGNoYW5nZUV2ZW50KTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy50b29sdGlwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRvb2x0aXBodG1sID0gJyc7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBzcGNvdW50OyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNwID0gc3BsaXN0W2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9vbHRpcGh0bWwgKz0gc3AuZ2V0Q3VycmVudFJlZ2lvblRvb2x0aXAoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRvb2x0aXAuc2V0Q29udGVudCh0b29sdGlwaHRtbCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5kaXNhYmxlSGlnaGxpZ2h0KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2FudmFzLnJlbmRlcigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChyZXN1bHQgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1vdXNlbGVhdmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuXG5cbiAgICBUb29sdGlwID0gY3JlYXRlQ2xhc3Moe1xuICAgICAgICBzaXplU3R5bGU6ICdwb3NpdGlvbjogc3RhdGljICFpbXBvcnRhbnQ7JyArXG4gICAgICAgICAgICAnZGlzcGxheTogYmxvY2sgIWltcG9ydGFudDsnICtcbiAgICAgICAgICAgICd2aXNpYmlsaXR5OiBoaWRkZW4gIWltcG9ydGFudDsnICtcbiAgICAgICAgICAgICdmbG9hdDogbGVmdCAhaW1wb3J0YW50OycsXG5cbiAgICAgICAgaW5pdDogZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICAgICAgICAgIHZhciB0b29sdGlwQ2xhc3NuYW1lID0gb3B0aW9ucy5nZXQoJ3Rvb2x0aXBDbGFzc25hbWUnLCAnanFzdG9vbHRpcCcpLFxuICAgICAgICAgICAgICAgIHNpemV0aXBTdHlsZSA9IHRoaXMuc2l6ZVN0eWxlLFxuICAgICAgICAgICAgICAgIG9mZnNldDtcbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVyID0gb3B0aW9ucy5nZXQoJ3Rvb2x0aXBDb250YWluZXInKSB8fCBkb2N1bWVudC5ib2R5O1xuICAgICAgICAgICAgdGhpcy50b29sdGlwT2Zmc2V0WCA9IG9wdGlvbnMuZ2V0KCd0b29sdGlwT2Zmc2V0WCcsIDEwKTtcbiAgICAgICAgICAgIHRoaXMudG9vbHRpcE9mZnNldFkgPSBvcHRpb25zLmdldCgndG9vbHRpcE9mZnNldFknLCAxMik7XG4gICAgICAgICAgICAvLyByZW1vdmUgYW55IHByZXZpb3VzIGxpbmdlcmluZyB0b29sdGlwXG4gICAgICAgICAgICAkKCcjanFzc2l6ZXRpcCcpLnJlbW92ZSgpO1xuICAgICAgICAgICAgJCgnI2pxc3Rvb2x0aXAnKS5yZW1vdmUoKTtcbiAgICAgICAgICAgIHRoaXMuc2l6ZXRpcCA9ICQoJzxkaXYvPicsIHtcbiAgICAgICAgICAgICAgICBpZDogJ2pxc3NpemV0aXAnLFxuICAgICAgICAgICAgICAgIHN0eWxlOiBzaXpldGlwU3R5bGUsXG4gICAgICAgICAgICAgICAgJ2NsYXNzJzogdG9vbHRpcENsYXNzbmFtZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLnRvb2x0aXAgPSAkKCc8ZGl2Lz4nLCB7XG4gICAgICAgICAgICAgICAgaWQ6ICdqcXN0b29sdGlwJyxcbiAgICAgICAgICAgICAgICAnY2xhc3MnOiB0b29sdGlwQ2xhc3NuYW1lXG4gICAgICAgICAgICB9KS5hcHBlbmRUbyh0aGlzLmNvbnRhaW5lcik7XG4gICAgICAgICAgICAvLyBhY2NvdW50IGZvciB0aGUgY29udGFpbmVyJ3MgbG9jYXRpb25cbiAgICAgICAgICAgIG9mZnNldCA9IHRoaXMudG9vbHRpcC5vZmZzZXQoKTtcbiAgICAgICAgICAgIHRoaXMub2Zmc2V0TGVmdCA9IG9mZnNldC5sZWZ0O1xuICAgICAgICAgICAgdGhpcy5vZmZzZXRUb3AgPSBvZmZzZXQudG9wO1xuICAgICAgICAgICAgdGhpcy5oaWRkZW4gPSB0cnVlO1xuICAgICAgICAgICAgJCh3aW5kb3cpLnVuYmluZCgncmVzaXplLmpxcyBzY3JvbGwuanFzJyk7XG4gICAgICAgICAgICAkKHdpbmRvdykuYmluZCgncmVzaXplLmpxcyBzY3JvbGwuanFzJywgJC5wcm94eSh0aGlzLnVwZGF0ZVdpbmRvd0RpbXMsIHRoaXMpKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlV2luZG93RGltcygpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHVwZGF0ZVdpbmRvd0RpbXM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsVG9wID0gJCh3aW5kb3cpLnNjcm9sbFRvcCgpO1xuICAgICAgICAgICAgdGhpcy5zY3JvbGxMZWZ0ID0gJCh3aW5kb3cpLnNjcm9sbExlZnQoKTtcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsUmlnaHQgPSB0aGlzLnNjcm9sbExlZnQgKyAkKHdpbmRvdykud2lkdGgoKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlUG9zaXRpb24oKTtcbiAgICAgICAgfSxcblxuICAgICAgICBnZXRTaXplOiBmdW5jdGlvbiAoY29udGVudCkge1xuICAgICAgICAgICAgdGhpcy5zaXpldGlwLmh0bWwoY29udGVudCkuYXBwZW5kVG8odGhpcy5jb250YWluZXIpO1xuICAgICAgICAgICAgdGhpcy53aWR0aCA9IHRoaXMuc2l6ZXRpcC53aWR0aCgpICsgMTtcbiAgICAgICAgICAgIHRoaXMuaGVpZ2h0ID0gdGhpcy5zaXpldGlwLmhlaWdodCgpO1xuICAgICAgICAgICAgdGhpcy5zaXpldGlwLnJlbW92ZSgpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNldENvbnRlbnQ6IGZ1bmN0aW9uIChjb250ZW50KSB7XG4gICAgICAgICAgICBpZiAoIWNvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRvb2x0aXAuY3NzKCd2aXNpYmlsaXR5JywgJ2hpZGRlbicpO1xuICAgICAgICAgICAgICAgIHRoaXMuaGlkZGVuID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmdldFNpemUoY29udGVudCk7XG4gICAgICAgICAgICB0aGlzLnRvb2x0aXAuaHRtbChjb250ZW50KVxuICAgICAgICAgICAgICAgIC5jc3Moe1xuICAgICAgICAgICAgICAgICAgICAnd2lkdGgnOiB0aGlzLndpZHRoLFxuICAgICAgICAgICAgICAgICAgICAnaGVpZ2h0JzogdGhpcy5oZWlnaHQsXG4gICAgICAgICAgICAgICAgICAgICd2aXNpYmlsaXR5JzogJ3Zpc2libGUnXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAodGhpcy5oaWRkZW4pIHtcbiAgICAgICAgICAgICAgICB0aGlzLmhpZGRlbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlUG9zaXRpb24oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICB1cGRhdGVQb3NpdGlvbjogZnVuY3Rpb24gKHgsIHkpIHtcbiAgICAgICAgICAgIGlmICh4ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5tb3VzZXggPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHggPSB0aGlzLm1vdXNleCAtIHRoaXMub2Zmc2V0TGVmdDtcbiAgICAgICAgICAgICAgICB5ID0gdGhpcy5tb3VzZXkgLSB0aGlzLm9mZnNldFRvcDtcblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1vdXNleCA9IHggPSB4IC0gdGhpcy5vZmZzZXRMZWZ0O1xuICAgICAgICAgICAgICAgIHRoaXMubW91c2V5ID0geSA9IHkgLSB0aGlzLm9mZnNldFRvcDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghdGhpcy5oZWlnaHQgfHwgIXRoaXMud2lkdGggfHwgdGhpcy5oaWRkZW4pIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHkgLT0gdGhpcy5oZWlnaHQgKyB0aGlzLnRvb2x0aXBPZmZzZXRZO1xuICAgICAgICAgICAgeCArPSB0aGlzLnRvb2x0aXBPZmZzZXRYO1xuXG4gICAgICAgICAgICBpZiAoeSA8IHRoaXMuc2Nyb2xsVG9wKSB7XG4gICAgICAgICAgICAgICAgeSA9IHRoaXMuc2Nyb2xsVG9wO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHggPCB0aGlzLnNjcm9sbExlZnQpIHtcbiAgICAgICAgICAgICAgICB4ID0gdGhpcy5zY3JvbGxMZWZ0O1xuICAgICAgICAgICAgfSBlbHNlIGlmICh4ICsgdGhpcy53aWR0aCA+IHRoaXMuc2Nyb2xsUmlnaHQpIHtcbiAgICAgICAgICAgICAgICB4ID0gdGhpcy5zY3JvbGxSaWdodCAtIHRoaXMud2lkdGg7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMudG9vbHRpcC5jc3Moe1xuICAgICAgICAgICAgICAgICdsZWZ0JzogeCxcbiAgICAgICAgICAgICAgICAndG9wJzogeVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVtb3ZlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLnRvb2x0aXAucmVtb3ZlKCk7XG4gICAgICAgICAgICB0aGlzLnNpemV0aXAucmVtb3ZlKCk7XG4gICAgICAgICAgICB0aGlzLnNpemV0aXAgPSB0aGlzLnRvb2x0aXAgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAkKHdpbmRvdykudW5iaW5kKCdyZXNpemUuanFzIHNjcm9sbC5qcXMnKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgaW5pdFN0eWxlcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBhZGRDU1MoZGVmYXVsdFN0eWxlcyk7XG4gICAgfTtcblxuICAgICQoaW5pdFN0eWxlcyk7XG5cbiAgICBwZW5kaW5nID0gW107XG4gICAgJC5mbi5zcGFya2xpbmUgPSBmdW5jdGlvbiAodXNlclZhbHVlcywgdXNlck9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgb3B0aW9ucyA9IG5ldyAkLmZuLnNwYXJrbGluZS5vcHRpb25zKHRoaXMsIHVzZXJPcHRpb25zKSxcbiAgICAgICAgICAgICAgICAgJHRoaXMgPSAkKHRoaXMpLFxuICAgICAgICAgICAgICAgICByZW5kZXIsIGk7XG4gICAgICAgICAgICByZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlcywgd2lkdGgsIGhlaWdodCwgdG1wLCBtaGFuZGxlciwgc3AsIHZhbHM7XG4gICAgICAgICAgICAgICAgaWYgKHVzZXJWYWx1ZXMgPT09ICdodG1sJyB8fCB1c2VyVmFsdWVzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFscyA9IHRoaXMuZ2V0QXR0cmlidXRlKG9wdGlvbnMuZ2V0KCd0YWdWYWx1ZXNBdHRyaWJ1dGUnKSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWxzID09PSB1bmRlZmluZWQgfHwgdmFscyA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFscyA9ICR0aGlzLmh0bWwoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YWx1ZXMgPSB2YWxzLnJlcGxhY2UoLyheXFxzKjwhLS0pfCgtLT5cXHMqJCl8XFxzKy9nLCAnJykuc3BsaXQoJywnKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZXMgPSB1c2VyVmFsdWVzO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHdpZHRoID0gb3B0aW9ucy5nZXQoJ3dpZHRoJykgPT09ICdhdXRvJyA/IHZhbHVlcy5sZW5ndGggKiBvcHRpb25zLmdldCgnZGVmYXVsdFBpeGVsc1BlclZhbHVlJykgOiBvcHRpb25zLmdldCgnd2lkdGgnKTtcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5nZXQoJ2hlaWdodCcpID09PSAnYXV0bycpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFvcHRpb25zLmdldCgnY29tcG9zaXRlJykgfHwgISQuZGF0YSh0aGlzLCAnX2pxc192Y2FudmFzJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG11c3QgYmUgYSBiZXR0ZXIgd2F5IHRvIGdldCB0aGUgbGluZSBoZWlnaHRcbiAgICAgICAgICAgICAgICAgICAgICAgIHRtcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRtcC5pbm5lckhUTUwgPSAnYSc7XG4gICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy5odG1sKHRtcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQgPSAkKHRtcCkuaW5uZXJIZWlnaHQoKSB8fCAkKHRtcCkuaGVpZ2h0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKHRtcCkucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0bXAgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0ID0gb3B0aW9ucy5nZXQoJ2hlaWdodCcpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICghb3B0aW9ucy5nZXQoJ2Rpc2FibGVJbnRlcmFjdGlvbicpKSB7XG4gICAgICAgICAgICAgICAgICAgIG1oYW5kbGVyID0gJC5kYXRhKHRoaXMsICdfanFzX21oYW5kbGVyJyk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghbWhhbmRsZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1oYW5kbGVyID0gbmV3IE1vdXNlSGFuZGxlcih0aGlzLCBvcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICQuZGF0YSh0aGlzLCAnX2pxc19taGFuZGxlcicsIG1oYW5kbGVyKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICghb3B0aW9ucy5nZXQoJ2NvbXBvc2l0ZScpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtaGFuZGxlci5yZXNldCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbWhhbmRsZXIgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5nZXQoJ2NvbXBvc2l0ZScpICYmICEkLmRhdGEodGhpcywgJ19qcXNfdmNhbnZhcycpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghJC5kYXRhKHRoaXMsICdfanFzX2Vycm5vdGlmeScpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbGVydCgnQXR0ZW1wdGVkIHRvIGF0dGFjaCBhIGNvbXBvc2l0ZSBzcGFya2xpbmUgdG8gYW4gZWxlbWVudCB3aXRoIG5vIGV4aXN0aW5nIHNwYXJrbGluZScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJC5kYXRhKHRoaXMsICdfanFzX2Vycm5vdGlmeScsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBzcCA9IG5ldyAkLmZuLnNwYXJrbGluZVtvcHRpb25zLmdldCgndHlwZScpXSh0aGlzLCB2YWx1ZXMsIG9wdGlvbnMsIHdpZHRoLCBoZWlnaHQpO1xuXG4gICAgICAgICAgICAgICAgc3AucmVuZGVyKCk7XG5cbiAgICAgICAgICAgICAgICBpZiAobWhhbmRsZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgbWhhbmRsZXIucmVnaXN0ZXJTcGFya2xpbmUoc3ApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAoKCQodGhpcykuaHRtbCgpICYmICFvcHRpb25zLmdldCgnZGlzYWJsZUhpZGRlbkNoZWNrJykgJiYgJCh0aGlzKS5pcygnOmhpZGRlbicpKSB8fCAhJCh0aGlzKS5wYXJlbnRzKCdib2R5JykubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFvcHRpb25zLmdldCgnY29tcG9zaXRlJykgJiYgJC5kYXRhKHRoaXMsICdfanFzX3BlbmRpbmcnKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyByZW1vdmUgYW55IGV4aXN0aW5nIHJlZmVyZW5jZXMgdG8gdGhlIGVsZW1lbnRcbiAgICAgICAgICAgICAgICAgICAgZm9yIChpID0gcGVuZGluZy5sZW5ndGg7IGk7IGktLSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBlbmRpbmdbaSAtIDFdWzBdID09IHRoaXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZW5kaW5nLnNwbGljZShpIC0gMSwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcGVuZGluZy5wdXNoKFt0aGlzLCByZW5kZXJdKTtcbiAgICAgICAgICAgICAgICAkLmRhdGEodGhpcywgJ19qcXNfcGVuZGluZycsIHRydWUpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZW5kZXIuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgICQuZm4uc3BhcmtsaW5lLmRlZmF1bHRzID0gZ2V0RGVmYXVsdHMoKTtcblxuXG4gICAgJC5zcGFya2xpbmVfZGlzcGxheV92aXNpYmxlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZWwsIGksIHBsO1xuICAgICAgICB2YXIgZG9uZSA9IFtdO1xuICAgICAgICBmb3IgKGkgPSAwLCBwbCA9IHBlbmRpbmcubGVuZ3RoOyBpIDwgcGw7IGkrKykge1xuICAgICAgICAgICAgZWwgPSBwZW5kaW5nW2ldWzBdO1xuICAgICAgICAgICAgaWYgKCQoZWwpLmlzKCc6dmlzaWJsZScpICYmICEkKGVsKS5wYXJlbnRzKCkuaXMoJzpoaWRkZW4nKSkge1xuICAgICAgICAgICAgICAgIHBlbmRpbmdbaV1bMV0uY2FsbChlbCk7XG4gICAgICAgICAgICAgICAgJC5kYXRhKHBlbmRpbmdbaV1bMF0sICdfanFzX3BlbmRpbmcnLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgZG9uZS5wdXNoKGkpO1xuICAgICAgICAgICAgfSBlbHNlIGlmICghJChlbCkuY2xvc2VzdCgnaHRtbCcpLmxlbmd0aCAmJiAhJC5kYXRhKGVsLCAnX2pxc19wZW5kaW5nJykpIHtcbiAgICAgICAgICAgICAgICAvLyBlbGVtZW50IGhhcyBiZWVuIGluc2VydGVkIGFuZCByZW1vdmVkIGZyb20gdGhlIERPTVxuICAgICAgICAgICAgICAgIC8vIElmIGl0IHdhcyBub3QgeWV0IGluc2VydGVkIGludG8gdGhlIGRvbSB0aGVuIHRoZSAuZGF0YSByZXF1ZXN0XG4gICAgICAgICAgICAgICAgLy8gd2lsbCByZXR1cm4gdHJ1ZS5cbiAgICAgICAgICAgICAgICAvLyByZW1vdmluZyBmcm9tIHRoZSBkb20gY2F1c2VzIHRoZSBkYXRhIHRvIGJlIHJlbW92ZWQuXG4gICAgICAgICAgICAgICAgJC5kYXRhKHBlbmRpbmdbaV1bMF0sICdfanFzX3BlbmRpbmcnLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgZG9uZS5wdXNoKGkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAoaSA9IGRvbmUubGVuZ3RoOyBpOyBpLS0pIHtcbiAgICAgICAgICAgIHBlbmRpbmcuc3BsaWNlKGRvbmVbaSAtIDFdLCAxKTtcbiAgICAgICAgfVxuICAgIH07XG5cblxuICAgIC8qKlxuICAgICAqIFVzZXIgb3B0aW9uIGhhbmRsZXJcbiAgICAgKi9cbiAgICAkLmZuLnNwYXJrbGluZS5vcHRpb25zID0gY3JlYXRlQ2xhc3Moe1xuICAgICAgICBpbml0OiBmdW5jdGlvbiAodGFnLCB1c2VyT3B0aW9ucykge1xuICAgICAgICAgICAgdmFyIGV4dGVuZGVkT3B0aW9ucywgZGVmYXVsdHMsIGJhc2UsIHRhZ09wdGlvblR5cGU7XG4gICAgICAgICAgICB0aGlzLnVzZXJPcHRpb25zID0gdXNlck9wdGlvbnMgPSB1c2VyT3B0aW9ucyB8fCB7fTtcbiAgICAgICAgICAgIHRoaXMudGFnID0gdGFnO1xuICAgICAgICAgICAgdGhpcy50YWdWYWxDYWNoZSA9IHt9O1xuICAgICAgICAgICAgZGVmYXVsdHMgPSAkLmZuLnNwYXJrbGluZS5kZWZhdWx0cztcbiAgICAgICAgICAgIGJhc2UgPSBkZWZhdWx0cy5jb21tb247XG4gICAgICAgICAgICB0aGlzLnRhZ09wdGlvbnNQcmVmaXggPSB1c2VyT3B0aW9ucy5lbmFibGVUYWdPcHRpb25zICYmICh1c2VyT3B0aW9ucy50YWdPcHRpb25zUHJlZml4IHx8IGJhc2UudGFnT3B0aW9uc1ByZWZpeCk7XG5cbiAgICAgICAgICAgIHRhZ09wdGlvblR5cGUgPSB0aGlzLmdldFRhZ1NldHRpbmcoJ3R5cGUnKTtcbiAgICAgICAgICAgIGlmICh0YWdPcHRpb25UeXBlID09PSBVTlNFVF9PUFRJT04pIHtcbiAgICAgICAgICAgICAgICBleHRlbmRlZE9wdGlvbnMgPSBkZWZhdWx0c1t1c2VyT3B0aW9ucy50eXBlIHx8IGJhc2UudHlwZV07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGV4dGVuZGVkT3B0aW9ucyA9IGRlZmF1bHRzW3RhZ09wdGlvblR5cGVdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5tZXJnZWRPcHRpb25zID0gJC5leHRlbmQoe30sIGJhc2UsIGV4dGVuZGVkT3B0aW9ucywgdXNlck9wdGlvbnMpO1xuICAgICAgICB9LFxuXG5cbiAgICAgICAgZ2V0VGFnU2V0dGluZzogZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgICAgdmFyIHByZWZpeCA9IHRoaXMudGFnT3B0aW9uc1ByZWZpeCxcbiAgICAgICAgICAgICAgICB2YWwsIGksIHBhaXJzLCBrZXl2YWw7XG4gICAgICAgICAgICBpZiAocHJlZml4ID09PSBmYWxzZSB8fCBwcmVmaXggPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBVTlNFVF9PUFRJT047XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy50YWdWYWxDYWNoZS5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICAgICAgdmFsID0gdGhpcy50YWdWYWxDYWNoZS5rZXk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhbCA9IHRoaXMudGFnLmdldEF0dHJpYnV0ZShwcmVmaXggKyBrZXkpO1xuICAgICAgICAgICAgICAgIGlmICh2YWwgPT09IHVuZGVmaW5lZCB8fCB2YWwgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsID0gVU5TRVRfT1BUSU9OO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodmFsLnN1YnN0cigwLCAxKSA9PT0gJ1snKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbCA9IHZhbC5zdWJzdHIoMSwgdmFsLmxlbmd0aCAtIDIpLnNwbGl0KCcsJyk7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoaSA9IHZhbC5sZW5ndGg7IGktLTspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbFtpXSA9IG5vcm1hbGl6ZVZhbHVlKHZhbFtpXS5yZXBsYWNlKC8oXlxccyopfChcXHMqJCkvZywgJycpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodmFsLnN1YnN0cigwLCAxKSA9PT0gJ3snKSB7XG4gICAgICAgICAgICAgICAgICAgIHBhaXJzID0gdmFsLnN1YnN0cigxLCB2YWwubGVuZ3RoIC0gMikuc3BsaXQoJywnKTtcbiAgICAgICAgICAgICAgICAgICAgdmFsID0ge307XG4gICAgICAgICAgICAgICAgICAgIGZvciAoaSA9IHBhaXJzLmxlbmd0aDsgaS0tOykge1xuICAgICAgICAgICAgICAgICAgICAgICAga2V5dmFsID0gcGFpcnNbaV0uc3BsaXQoJzonLCAyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbFtrZXl2YWxbMF0ucmVwbGFjZSgvKF5cXHMqKXwoXFxzKiQpL2csICcnKV0gPSBub3JtYWxpemVWYWx1ZShrZXl2YWxbMV0ucmVwbGFjZSgvKF5cXHMqKXwoXFxzKiQpL2csICcnKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YWwgPSBub3JtYWxpemVWYWx1ZSh2YWwpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnRhZ1ZhbENhY2hlLmtleSA9IHZhbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB2YWw7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoa2V5LCBkZWZhdWx0dmFsKSB7XG4gICAgICAgICAgICB2YXIgdGFnT3B0aW9uID0gdGhpcy5nZXRUYWdTZXR0aW5nKGtleSksXG4gICAgICAgICAgICAgICAgcmVzdWx0O1xuICAgICAgICAgICAgaWYgKHRhZ09wdGlvbiAhPT0gVU5TRVRfT1BUSU9OKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRhZ09wdGlvbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAocmVzdWx0ID0gdGhpcy5tZXJnZWRPcHRpb25zW2tleV0pID09PSB1bmRlZmluZWQgPyBkZWZhdWx0dmFsIDogcmVzdWx0O1xuICAgICAgICB9XG4gICAgfSk7XG5cblxuICAgICQuZm4uc3BhcmtsaW5lLl9iYXNlID0gY3JlYXRlQ2xhc3Moe1xuICAgICAgICBkaXNhYmxlZDogZmFsc2UsXG5cbiAgICAgICAgaW5pdDogZnVuY3Rpb24gKGVsLCB2YWx1ZXMsIG9wdGlvbnMsIHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgICAgIHRoaXMuZWwgPSBlbDtcbiAgICAgICAgICAgIHRoaXMuJGVsID0gJChlbCk7XG4gICAgICAgICAgICB0aGlzLnZhbHVlcyA9IHZhbHVlcztcbiAgICAgICAgICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgICAgICAgICB0aGlzLndpZHRoID0gd2lkdGg7XG4gICAgICAgICAgICB0aGlzLmhlaWdodCA9IGhlaWdodDtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFJlZ2lvbiA9IHVuZGVmaW5lZDtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogU2V0dXAgdGhlIGNhbnZhc1xuICAgICAgICAgKi9cbiAgICAgICAgaW5pdFRhcmdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGludGVyYWN0aXZlID0gIXRoaXMub3B0aW9ucy5nZXQoJ2Rpc2FibGVJbnRlcmFjdGlvbicpO1xuICAgICAgICAgICAgaWYgKCEodGhpcy50YXJnZXQgPSB0aGlzLiRlbC5zaW1wbGVkcmF3KHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0LCB0aGlzLm9wdGlvbnMuZ2V0KCdjb21wb3NpdGUnKSwgaW50ZXJhY3RpdmUpKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNhbnZhc1dpZHRoID0gdGhpcy50YXJnZXQucGl4ZWxXaWR0aDtcbiAgICAgICAgICAgICAgICB0aGlzLmNhbnZhc0hlaWdodCA9IHRoaXMudGFyZ2V0LnBpeGVsSGVpZ2h0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBY3R1YWxseSByZW5kZXIgdGhlIGNoYXJ0IHRvIHRoZSBjYW52YXNcbiAgICAgICAgICovXG4gICAgICAgIHJlbmRlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuZGlzYWJsZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVsLmlubmVySFRNTCA9ICcnO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSZXR1cm4gYSByZWdpb24gaWQgZm9yIGEgZ2l2ZW4geC95IGNvLW9yZGluYXRlXG4gICAgICAgICAqL1xuICAgICAgICBnZXRSZWdpb246IGZ1bmN0aW9uICh4LCB5KSB7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEhpZ2hsaWdodCBhbiBpdGVtIGJhc2VkIG9uIHRoZSBtb3VzZWQtb3ZlciB4LHkgY28tb3JkaW5hdGVcbiAgICAgICAgICovXG4gICAgICAgIHNldFJlZ2lvbkhpZ2hsaWdodDogZnVuY3Rpb24gKGVsLCB4LCB5KSB7XG4gICAgICAgICAgICB2YXIgY3VycmVudFJlZ2lvbiA9IHRoaXMuY3VycmVudFJlZ2lvbixcbiAgICAgICAgICAgICAgICBoaWdobGlnaHRFbmFibGVkID0gIXRoaXMub3B0aW9ucy5nZXQoJ2Rpc2FibGVIaWdobGlnaHQnKSxcbiAgICAgICAgICAgICAgICBuZXdSZWdpb247XG4gICAgICAgICAgICBpZiAoeCA+IHRoaXMuY2FudmFzV2lkdGggfHwgeSA+IHRoaXMuY2FudmFzSGVpZ2h0IHx8IHggPCAwIHx8IHkgPCAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBuZXdSZWdpb24gPSB0aGlzLmdldFJlZ2lvbihlbCwgeCwgeSk7XG4gICAgICAgICAgICBpZiAoY3VycmVudFJlZ2lvbiAhPT0gbmV3UmVnaW9uKSB7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRSZWdpb24gIT09IHVuZGVmaW5lZCAmJiBoaWdobGlnaHRFbmFibGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlSGlnaGxpZ2h0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFJlZ2lvbiA9IG5ld1JlZ2lvbjtcbiAgICAgICAgICAgICAgICBpZiAobmV3UmVnaW9uICE9PSB1bmRlZmluZWQgJiYgaGlnaGxpZ2h0RW5hYmxlZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlckhpZ2hsaWdodCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogUmVzZXQgYW55IGN1cnJlbnRseSBoaWdobGlnaHRlZCBpdGVtXG4gICAgICAgICAqL1xuICAgICAgICBjbGVhclJlZ2lvbkhpZ2hsaWdodDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudFJlZ2lvbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVIaWdobGlnaHQoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRSZWdpb24gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVuZGVySGlnaGxpZ2h0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLmNoYW5nZUhpZ2hsaWdodCh0cnVlKTtcbiAgICAgICAgfSxcblxuICAgICAgICByZW1vdmVIaWdobGlnaHQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlSGlnaGxpZ2h0KGZhbHNlKTtcbiAgICAgICAgfSxcblxuICAgICAgICBjaGFuZ2VIaWdobGlnaHQ6IGZ1bmN0aW9uIChoaWdobGlnaHQpICB7fSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogRmV0Y2ggdGhlIEhUTUwgdG8gZGlzcGxheSBhcyBhIHRvb2x0aXBcbiAgICAgICAgICovXG4gICAgICAgIGdldEN1cnJlbnRSZWdpb25Ub29sdGlwOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgb3B0aW9ucyA9IHRoaXMub3B0aW9ucyxcbiAgICAgICAgICAgICAgICBoZWFkZXIgPSAnJyxcbiAgICAgICAgICAgICAgICBlbnRyaWVzID0gW10sXG4gICAgICAgICAgICAgICAgZmllbGRzLCBmb3JtYXRzLCBmb3JtYXRsZW4sIGZjbGFzcywgdGV4dCwgaSxcbiAgICAgICAgICAgICAgICBzaG93RmllbGRzLCBzaG93RmllbGRzS2V5LCBuZXdGaWVsZHMsIGZ2LFxuICAgICAgICAgICAgICAgIGZvcm1hdHRlciwgZm9ybWF0LCBmaWVsZGxlbiwgajtcbiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRSZWdpb24gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZpZWxkcyA9IHRoaXMuZ2V0Q3VycmVudFJlZ2lvbkZpZWxkcygpO1xuICAgICAgICAgICAgZm9ybWF0dGVyID0gb3B0aW9ucy5nZXQoJ3Rvb2x0aXBGb3JtYXR0ZXInKTtcbiAgICAgICAgICAgIGlmIChmb3JtYXR0ZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZm9ybWF0dGVyKHRoaXMsIG9wdGlvbnMsIGZpZWxkcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAob3B0aW9ucy5nZXQoJ3Rvb2x0aXBDaGFydFRpdGxlJykpIHtcbiAgICAgICAgICAgICAgICBoZWFkZXIgKz0gJzxkaXYgY2xhc3M9XCJqcXMganFzdGl0bGVcIj4nICsgb3B0aW9ucy5nZXQoJ3Rvb2x0aXBDaGFydFRpdGxlJykgKyAnPC9kaXY+XFxuJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvcm1hdHMgPSB0aGlzLm9wdGlvbnMuZ2V0KCd0b29sdGlwRm9ybWF0Jyk7XG4gICAgICAgICAgICBpZiAoIWZvcm1hdHMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoISQuaXNBcnJheShmb3JtYXRzKSkge1xuICAgICAgICAgICAgICAgIGZvcm1hdHMgPSBbZm9ybWF0c107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoISQuaXNBcnJheShmaWVsZHMpKSB7XG4gICAgICAgICAgICAgICAgZmllbGRzID0gW2ZpZWxkc107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzaG93RmllbGRzID0gdGhpcy5vcHRpb25zLmdldCgndG9vbHRpcEZvcm1hdEZpZWxkbGlzdCcpO1xuICAgICAgICAgICAgc2hvd0ZpZWxkc0tleSA9IHRoaXMub3B0aW9ucy5nZXQoJ3Rvb2x0aXBGb3JtYXRGaWVsZGxpc3RLZXknKTtcbiAgICAgICAgICAgIGlmIChzaG93RmllbGRzICYmIHNob3dGaWVsZHNLZXkpIHtcbiAgICAgICAgICAgICAgICAvLyB1c2VyLXNlbGVjdGVkIG9yZGVyaW5nIG9mIGZpZWxkc1xuICAgICAgICAgICAgICAgIG5ld0ZpZWxkcyA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAoaSA9IGZpZWxkcy5sZW5ndGg7IGktLTspIHtcbiAgICAgICAgICAgICAgICAgICAgZnYgPSBmaWVsZHNbaV1bc2hvd0ZpZWxkc0tleV07XG4gICAgICAgICAgICAgICAgICAgIGlmICgoaiA9ICQuaW5BcnJheShmdiwgc2hvd0ZpZWxkcykpICE9IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdGaWVsZHNbal0gPSBmaWVsZHNbaV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZmllbGRzID0gbmV3RmllbGRzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9ybWF0bGVuID0gZm9ybWF0cy5sZW5ndGg7XG4gICAgICAgICAgICBmaWVsZGxlbiA9IGZpZWxkcy5sZW5ndGg7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgZm9ybWF0bGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgICBmb3JtYXQgPSBmb3JtYXRzW2ldO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZm9ybWF0ID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICBmb3JtYXQgPSBuZXcgU1BGb3JtYXQoZm9ybWF0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZmNsYXNzID0gZm9ybWF0LmZjbGFzcyB8fCAnanFzZmllbGQnO1xuICAgICAgICAgICAgICAgIGZvciAoaiA9IDA7IGogPCBmaWVsZGxlbjsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghZmllbGRzW2pdLmlzTnVsbCB8fCAhb3B0aW9ucy5nZXQoJ3Rvb2x0aXBTa2lwTnVsbCcpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkLmV4dGVuZChmaWVsZHNbal0sIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmVmaXg6IG9wdGlvbnMuZ2V0KCd0b29sdGlwUHJlZml4JyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VmZml4OiBvcHRpb25zLmdldCgndG9vbHRpcFN1ZmZpeCcpXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgPSBmb3JtYXQucmVuZGVyKGZpZWxkc1tqXSwgb3B0aW9ucy5nZXQoJ3Rvb2x0aXBWYWx1ZUxvb2t1cHMnKSwgb3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbnRyaWVzLnB1c2goJzxkaXYgY2xhc3M9XCInICsgZmNsYXNzICsgJ1wiPicgKyB0ZXh0ICsgJzwvZGl2PicpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGVudHJpZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGhlYWRlciArIGVudHJpZXMuam9pbignXFxuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2V0Q3VycmVudFJlZ2lvbkZpZWxkczogZnVuY3Rpb24gKCkge30sXG5cbiAgICAgICAgY2FsY0hpZ2hsaWdodENvbG9yOiBmdW5jdGlvbiAoY29sb3IsIG9wdGlvbnMpIHtcbiAgICAgICAgICAgIHZhciBoaWdobGlnaHRDb2xvciA9IG9wdGlvbnMuZ2V0KCdoaWdobGlnaHRDb2xvcicpLFxuICAgICAgICAgICAgICAgIGxpZ2h0ZW4gPSBvcHRpb25zLmdldCgnaGlnaGxpZ2h0TGlnaHRlbicpLFxuICAgICAgICAgICAgICAgIHBhcnNlLCBtdWx0LCByZ2JuZXcsIGk7XG4gICAgICAgICAgICBpZiAoaGlnaGxpZ2h0Q29sb3IpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaGlnaGxpZ2h0Q29sb3I7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobGlnaHRlbikge1xuICAgICAgICAgICAgICAgIC8vIGV4dHJhY3QgUkdCIHZhbHVlc1xuICAgICAgICAgICAgICAgIHBhcnNlID0gL14jKFswLTlhLWZdKShbMC05YS1mXSkoWzAtOWEtZl0pJC9pLmV4ZWMoY29sb3IpIHx8IC9eIyhbMC05YS1mXXsyfSkoWzAtOWEtZl17Mn0pKFswLTlhLWZdezJ9KSQvaS5leGVjKGNvbG9yKTtcbiAgICAgICAgICAgICAgICBpZiAocGFyc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgcmdibmV3ID0gW107XG4gICAgICAgICAgICAgICAgICAgIG11bHQgPSBjb2xvci5sZW5ndGggPT09IDQgPyAxNiA6IDE7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCAzOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJnYm5ld1tpXSA9IGNsaXB2YWwoTWF0aC5yb3VuZChwYXJzZUludChwYXJzZVtpICsgMV0sIDE2KSAqIG11bHQgKiBsaWdodGVuKSwgMCwgMjU1KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ3JnYignICsgcmdibmV3LmpvaW4oJywnKSArICcpJztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjb2xvcjtcbiAgICAgICAgfVxuXG4gICAgfSk7XG5cbiAgICBiYXJIaWdobGlnaHRNaXhpbiA9IHtcbiAgICAgICAgY2hhbmdlSGlnaGxpZ2h0OiBmdW5jdGlvbiAoaGlnaGxpZ2h0KSB7XG4gICAgICAgICAgICB2YXIgY3VycmVudFJlZ2lvbiA9IHRoaXMuY3VycmVudFJlZ2lvbixcbiAgICAgICAgICAgICAgICB0YXJnZXQgPSB0aGlzLnRhcmdldCxcbiAgICAgICAgICAgICAgICBzaGFwZWlkcyA9IHRoaXMucmVnaW9uU2hhcGVzW2N1cnJlbnRSZWdpb25dLFxuICAgICAgICAgICAgICAgIG5ld1NoYXBlcztcbiAgICAgICAgICAgIC8vIHdpbGwgYmUgbnVsbCBpZiB0aGUgcmVnaW9uIHZhbHVlIHdhcyBudWxsXG4gICAgICAgICAgICBpZiAoc2hhcGVpZHMpIHtcbiAgICAgICAgICAgICAgICBuZXdTaGFwZXMgPSB0aGlzLnJlbmRlclJlZ2lvbihjdXJyZW50UmVnaW9uLCBoaWdobGlnaHQpO1xuICAgICAgICAgICAgICAgIGlmICgkLmlzQXJyYXkobmV3U2hhcGVzKSB8fCAkLmlzQXJyYXkoc2hhcGVpZHMpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldC5yZXBsYWNlV2l0aFNoYXBlcyhzaGFwZWlkcywgbmV3U2hhcGVzKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWdpb25TaGFwZXNbY3VycmVudFJlZ2lvbl0gPSAkLm1hcChuZXdTaGFwZXMsIGZ1bmN0aW9uIChuZXdTaGFwZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ld1NoYXBlLmlkO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXQucmVwbGFjZVdpdGhTaGFwZShzaGFwZWlkcywgbmV3U2hhcGVzKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWdpb25TaGFwZXNbY3VycmVudFJlZ2lvbl0gPSBuZXdTaGFwZXMuaWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIHJlbmRlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHZhbHVlcyA9IHRoaXMudmFsdWVzLFxuICAgICAgICAgICAgICAgIHRhcmdldCA9IHRoaXMudGFyZ2V0LFxuICAgICAgICAgICAgICAgIHJlZ2lvblNoYXBlcyA9IHRoaXMucmVnaW9uU2hhcGVzLFxuICAgICAgICAgICAgICAgIHNoYXBlcywgaWRzLCBpLCBqO1xuXG4gICAgICAgICAgICBpZiAoIXRoaXMuY2xzLl9zdXBlci5yZW5kZXIuY2FsbCh0aGlzKSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAoaSA9IHZhbHVlcy5sZW5ndGg7IGktLTspIHtcbiAgICAgICAgICAgICAgICBzaGFwZXMgPSB0aGlzLnJlbmRlclJlZ2lvbihpKTtcbiAgICAgICAgICAgICAgICBpZiAoc2hhcGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkLmlzQXJyYXkoc2hhcGVzKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWRzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGogPSBzaGFwZXMubGVuZ3RoOyBqLS07KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcGVzW2pdLmFwcGVuZCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkcy5wdXNoKHNoYXBlc1tqXS5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZWdpb25TaGFwZXNbaV0gPSBpZHM7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzaGFwZXMuYXBwZW5kKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWdpb25TaGFwZXNbaV0gPSBzaGFwZXMuaWQ7IC8vIHN0b3JlIGp1c3QgdGhlIHNoYXBlaWRcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIG51bGwgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgcmVnaW9uU2hhcGVzW2ldID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0YXJnZXQucmVuZGVyKCk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogTGluZSBjaGFydHNcbiAgICAgKi9cbiAgICAkLmZuLnNwYXJrbGluZS5saW5lID0gbGluZSA9IGNyZWF0ZUNsYXNzKCQuZm4uc3BhcmtsaW5lLl9iYXNlLCB7XG4gICAgICAgIHR5cGU6ICdsaW5lJyxcblxuICAgICAgICBpbml0OiBmdW5jdGlvbiAoZWwsIHZhbHVlcywgb3B0aW9ucywgd2lkdGgsIGhlaWdodCkge1xuICAgICAgICAgICAgbGluZS5fc3VwZXIuaW5pdC5jYWxsKHRoaXMsIGVsLCB2YWx1ZXMsIG9wdGlvbnMsIHdpZHRoLCBoZWlnaHQpO1xuICAgICAgICAgICAgdGhpcy52ZXJ0aWNlcyA9IFtdO1xuICAgICAgICAgICAgdGhpcy5yZWdpb25NYXAgPSBbXTtcbiAgICAgICAgICAgIHRoaXMueHZhbHVlcyA9IFtdO1xuICAgICAgICAgICAgdGhpcy55dmFsdWVzID0gW107XG4gICAgICAgICAgICB0aGlzLnltaW5tYXggPSBbXTtcbiAgICAgICAgICAgIHRoaXMuaGlnaHRsaWdodFNwb3RJZCA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLmxhc3RTaGFwZUlkID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuaW5pdFRhcmdldCgpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGdldFJlZ2lvbjogZnVuY3Rpb24gKGVsLCB4LCB5KSB7XG4gICAgICAgICAgICB2YXIgaSxcbiAgICAgICAgICAgICAgICByZWdpb25NYXAgPSB0aGlzLnJlZ2lvbk1hcDsgLy8gbWFwcyByZWdpb25zIHRvIHZhbHVlIHBvc2l0aW9uc1xuICAgICAgICAgICAgZm9yIChpID0gcmVnaW9uTWFwLmxlbmd0aDsgaS0tOykge1xuICAgICAgICAgICAgICAgIGlmIChyZWdpb25NYXBbaV0gIT09IG51bGwgJiYgeCA+PSByZWdpb25NYXBbaV1bMF0gJiYgeCA8PSByZWdpb25NYXBbaV1bMV0pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2lvbk1hcFtpXVsyXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9LFxuXG4gICAgICAgIGdldEN1cnJlbnRSZWdpb25GaWVsZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBjdXJyZW50UmVnaW9uID0gdGhpcy5jdXJyZW50UmVnaW9uO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBpc051bGw6IHRoaXMueXZhbHVlc1tjdXJyZW50UmVnaW9uXSA9PT0gbnVsbCxcbiAgICAgICAgICAgICAgICB4OiB0aGlzLnh2YWx1ZXNbY3VycmVudFJlZ2lvbl0sXG4gICAgICAgICAgICAgICAgeTogdGhpcy55dmFsdWVzW2N1cnJlbnRSZWdpb25dLFxuICAgICAgICAgICAgICAgIGNvbG9yOiB0aGlzLm9wdGlvbnMuZ2V0KCdsaW5lQ29sb3InKSxcbiAgICAgICAgICAgICAgICBmaWxsQ29sb3I6IHRoaXMub3B0aW9ucy5nZXQoJ2ZpbGxDb2xvcicpLFxuICAgICAgICAgICAgICAgIG9mZnNldDogY3VycmVudFJlZ2lvblxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSxcblxuICAgICAgICByZW5kZXJIaWdobGlnaHQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBjdXJyZW50UmVnaW9uID0gdGhpcy5jdXJyZW50UmVnaW9uLFxuICAgICAgICAgICAgICAgIHRhcmdldCA9IHRoaXMudGFyZ2V0LFxuICAgICAgICAgICAgICAgIHZlcnRleCA9IHRoaXMudmVydGljZXNbY3VycmVudFJlZ2lvbl0sXG4gICAgICAgICAgICAgICAgb3B0aW9ucyA9IHRoaXMub3B0aW9ucyxcbiAgICAgICAgICAgICAgICBzcG90UmFkaXVzID0gb3B0aW9ucy5nZXQoJ3Nwb3RSYWRpdXMnKSxcbiAgICAgICAgICAgICAgICBoaWdobGlnaHRTcG90Q29sb3IgPSBvcHRpb25zLmdldCgnaGlnaGxpZ2h0U3BvdENvbG9yJyksXG4gICAgICAgICAgICAgICAgaGlnaGxpZ2h0TGluZUNvbG9yID0gb3B0aW9ucy5nZXQoJ2hpZ2hsaWdodExpbmVDb2xvcicpLFxuICAgICAgICAgICAgICAgIGhpZ2hsaWdodFNwb3QsIGhpZ2hsaWdodExpbmU7XG5cbiAgICAgICAgICAgIGlmICghdmVydGV4KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNwb3RSYWRpdXMgJiYgaGlnaGxpZ2h0U3BvdENvbG9yKSB7XG4gICAgICAgICAgICAgICAgaGlnaGxpZ2h0U3BvdCA9IHRhcmdldC5kcmF3Q2lyY2xlKHZlcnRleFswXSwgdmVydGV4WzFdLFxuICAgICAgICAgICAgICAgICAgICBzcG90UmFkaXVzLCB1bmRlZmluZWQsIGhpZ2hsaWdodFNwb3RDb2xvcik7XG4gICAgICAgICAgICAgICAgdGhpcy5oaWdobGlnaHRTcG90SWQgPSBoaWdobGlnaHRTcG90LmlkO1xuICAgICAgICAgICAgICAgIHRhcmdldC5pbnNlcnRBZnRlclNoYXBlKHRoaXMubGFzdFNoYXBlSWQsIGhpZ2hsaWdodFNwb3QpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGhpZ2hsaWdodExpbmVDb2xvcikge1xuICAgICAgICAgICAgICAgIGhpZ2hsaWdodExpbmUgPSB0YXJnZXQuZHJhd0xpbmUodmVydGV4WzBdLCB0aGlzLmNhbnZhc1RvcCwgdmVydGV4WzBdLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNhbnZhc1RvcCArIHRoaXMuY2FudmFzSGVpZ2h0LCBoaWdobGlnaHRMaW5lQ29sb3IpO1xuICAgICAgICAgICAgICAgIHRoaXMuaGlnaGxpZ2h0TGluZUlkID0gaGlnaGxpZ2h0TGluZS5pZDtcbiAgICAgICAgICAgICAgICB0YXJnZXQuaW5zZXJ0QWZ0ZXJTaGFwZSh0aGlzLmxhc3RTaGFwZUlkLCBoaWdobGlnaHRMaW5lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICByZW1vdmVIaWdobGlnaHQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB0YXJnZXQgPSB0aGlzLnRhcmdldDtcbiAgICAgICAgICAgIGlmICh0aGlzLmhpZ2hsaWdodFNwb3RJZCkge1xuICAgICAgICAgICAgICAgIHRhcmdldC5yZW1vdmVTaGFwZUlkKHRoaXMuaGlnaGxpZ2h0U3BvdElkKTtcbiAgICAgICAgICAgICAgICB0aGlzLmhpZ2hsaWdodFNwb3RJZCA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5oaWdobGlnaHRMaW5lSWQpIHtcbiAgICAgICAgICAgICAgICB0YXJnZXQucmVtb3ZlU2hhcGVJZCh0aGlzLmhpZ2hsaWdodExpbmVJZCk7XG4gICAgICAgICAgICAgICAgdGhpcy5oaWdobGlnaHRMaW5lSWQgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIHNjYW5WYWx1ZXM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB2YWx1ZXMgPSB0aGlzLnZhbHVlcyxcbiAgICAgICAgICAgICAgICB2YWxjb3VudCA9IHZhbHVlcy5sZW5ndGgsXG4gICAgICAgICAgICAgICAgeHZhbHVlcyA9IHRoaXMueHZhbHVlcyxcbiAgICAgICAgICAgICAgICB5dmFsdWVzID0gdGhpcy55dmFsdWVzLFxuICAgICAgICAgICAgICAgIHltaW5tYXggPSB0aGlzLnltaW5tYXgsXG4gICAgICAgICAgICAgICAgaSwgdmFsLCBpc1N0ciwgaXNBcnJheSwgc3A7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgdmFsY291bnQ7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhbCA9IHZhbHVlc1tpXTtcbiAgICAgICAgICAgICAgICBpc1N0ciA9IHR5cGVvZih2YWx1ZXNbaV0pID09PSAnc3RyaW5nJztcbiAgICAgICAgICAgICAgICBpc0FycmF5ID0gdHlwZW9mKHZhbHVlc1tpXSkgPT09ICdvYmplY3QnICYmIHZhbHVlc1tpXSBpbnN0YW5jZW9mIEFycmF5O1xuICAgICAgICAgICAgICAgIHNwID0gaXNTdHIgJiYgdmFsdWVzW2ldLnNwbGl0KCc6Jyk7XG4gICAgICAgICAgICAgICAgaWYgKGlzU3RyICYmIHNwLmxlbmd0aCA9PT0gMikgeyAvLyB4OnlcbiAgICAgICAgICAgICAgICAgICAgeHZhbHVlcy5wdXNoKE51bWJlcihzcFswXSkpO1xuICAgICAgICAgICAgICAgICAgICB5dmFsdWVzLnB1c2goTnVtYmVyKHNwWzFdKSk7XG4gICAgICAgICAgICAgICAgICAgIHltaW5tYXgucHVzaChOdW1iZXIoc3BbMV0pKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlzQXJyYXkpIHtcbiAgICAgICAgICAgICAgICAgICAgeHZhbHVlcy5wdXNoKHZhbFswXSk7XG4gICAgICAgICAgICAgICAgICAgIHl2YWx1ZXMucHVzaCh2YWxbMV0pO1xuICAgICAgICAgICAgICAgICAgICB5bWlubWF4LnB1c2godmFsWzFdKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB4dmFsdWVzLnB1c2goaSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZXNbaV0gPT09IG51bGwgfHwgdmFsdWVzW2ldID09PSAnbnVsbCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHl2YWx1ZXMucHVzaChudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHl2YWx1ZXMucHVzaChOdW1iZXIodmFsKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB5bWlubWF4LnB1c2goTnVtYmVyKHZhbCkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5nZXQoJ3h2YWx1ZXMnKSkge1xuICAgICAgICAgICAgICAgIHh2YWx1ZXMgPSB0aGlzLm9wdGlvbnMuZ2V0KCd4dmFsdWVzJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMubWF4eSA9IHRoaXMubWF4eW9yZyA9IE1hdGgubWF4LmFwcGx5KE1hdGgsIHltaW5tYXgpO1xuICAgICAgICAgICAgdGhpcy5taW55ID0gdGhpcy5taW55b3JnID0gTWF0aC5taW4uYXBwbHkoTWF0aCwgeW1pbm1heCk7XG5cbiAgICAgICAgICAgIHRoaXMubWF4eCA9IE1hdGgubWF4LmFwcGx5KE1hdGgsIHh2YWx1ZXMpO1xuICAgICAgICAgICAgdGhpcy5taW54ID0gTWF0aC5taW4uYXBwbHkoTWF0aCwgeHZhbHVlcyk7XG5cbiAgICAgICAgICAgIHRoaXMueHZhbHVlcyA9IHh2YWx1ZXM7XG4gICAgICAgICAgICB0aGlzLnl2YWx1ZXMgPSB5dmFsdWVzO1xuICAgICAgICAgICAgdGhpcy55bWlubWF4ID0geW1pbm1heDtcblxuICAgICAgICB9LFxuXG4gICAgICAgIHByb2Nlc3NSYW5nZU9wdGlvbnM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBvcHRpb25zID0gdGhpcy5vcHRpb25zLFxuICAgICAgICAgICAgICAgIG5vcm1hbFJhbmdlTWluID0gb3B0aW9ucy5nZXQoJ25vcm1hbFJhbmdlTWluJyksXG4gICAgICAgICAgICAgICAgbm9ybWFsUmFuZ2VNYXggPSBvcHRpb25zLmdldCgnbm9ybWFsUmFuZ2VNYXgnKTtcblxuICAgICAgICAgICAgaWYgKG5vcm1hbFJhbmdlTWluICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBpZiAobm9ybWFsUmFuZ2VNaW4gPCB0aGlzLm1pbnkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5taW55ID0gbm9ybWFsUmFuZ2VNaW47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChub3JtYWxSYW5nZU1heCA+IHRoaXMubWF4eSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm1heHkgPSBub3JtYWxSYW5nZU1heDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAob3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNaW4nKSAhPT0gdW5kZWZpbmVkICYmIChvcHRpb25zLmdldCgnY2hhcnRSYW5nZUNsaXAnKSB8fCBvcHRpb25zLmdldCgnY2hhcnRSYW5nZU1pbicpIDwgdGhpcy5taW55KSkge1xuICAgICAgICAgICAgICAgIHRoaXMubWlueSA9IG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlTWluJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAob3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNYXgnKSAhPT0gdW5kZWZpbmVkICYmIChvcHRpb25zLmdldCgnY2hhcnRSYW5nZUNsaXAnKSB8fCBvcHRpb25zLmdldCgnY2hhcnRSYW5nZU1heCcpID4gdGhpcy5tYXh5KSkge1xuICAgICAgICAgICAgICAgIHRoaXMubWF4eSA9IG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlTWF4Jyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAob3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNaW5YJykgIT09IHVuZGVmaW5lZCAmJiAob3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VDbGlwWCcpIHx8IG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlTWluWCcpIDwgdGhpcy5taW54KSkge1xuICAgICAgICAgICAgICAgIHRoaXMubWlueCA9IG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlTWluWCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlTWF4WCcpICE9PSB1bmRlZmluZWQgJiYgKG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlQ2xpcFgnKSB8fCBvcHRpb25zLmdldCgnY2hhcnRSYW5nZU1heFgnKSA+IHRoaXMubWF4eCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1heHggPSBvcHRpb25zLmdldCgnY2hhcnRSYW5nZU1heFgnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9LFxuXG4gICAgICAgIGRyYXdOb3JtYWxSYW5nZTogZnVuY3Rpb24gKGNhbnZhc0xlZnQsIGNhbnZhc1RvcCwgY2FudmFzSGVpZ2h0LCBjYW52YXNXaWR0aCwgcmFuZ2V5KSB7XG4gICAgICAgICAgICB2YXIgbm9ybWFsUmFuZ2VNaW4gPSB0aGlzLm9wdGlvbnMuZ2V0KCdub3JtYWxSYW5nZU1pbicpLFxuICAgICAgICAgICAgICAgIG5vcm1hbFJhbmdlTWF4ID0gdGhpcy5vcHRpb25zLmdldCgnbm9ybWFsUmFuZ2VNYXgnKSxcbiAgICAgICAgICAgICAgICB5dG9wID0gY2FudmFzVG9wICsgTWF0aC5yb3VuZChjYW52YXNIZWlnaHQgLSAoY2FudmFzSGVpZ2h0ICogKChub3JtYWxSYW5nZU1heCAtIHRoaXMubWlueSkgLyByYW5nZXkpKSksXG4gICAgICAgICAgICAgICAgaGVpZ2h0ID0gTWF0aC5yb3VuZCgoY2FudmFzSGVpZ2h0ICogKG5vcm1hbFJhbmdlTWF4IC0gbm9ybWFsUmFuZ2VNaW4pKSAvIHJhbmdleSk7XG4gICAgICAgICAgICB0aGlzLnRhcmdldC5kcmF3UmVjdChjYW52YXNMZWZ0LCB5dG9wLCBjYW52YXNXaWR0aCwgaGVpZ2h0LCB1bmRlZmluZWQsIHRoaXMub3B0aW9ucy5nZXQoJ25vcm1hbFJhbmdlQ29sb3InKSkuYXBwZW5kKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgb3B0aW9ucyA9IHRoaXMub3B0aW9ucyxcbiAgICAgICAgICAgICAgICB0YXJnZXQgPSB0aGlzLnRhcmdldCxcbiAgICAgICAgICAgICAgICBjYW52YXNXaWR0aCA9IHRoaXMuY2FudmFzV2lkdGgsXG4gICAgICAgICAgICAgICAgY2FudmFzSGVpZ2h0ID0gdGhpcy5jYW52YXNIZWlnaHQsXG4gICAgICAgICAgICAgICAgdmVydGljZXMgPSB0aGlzLnZlcnRpY2VzLFxuICAgICAgICAgICAgICAgIHNwb3RSYWRpdXMgPSBvcHRpb25zLmdldCgnc3BvdFJhZGl1cycpLFxuICAgICAgICAgICAgICAgIHJlZ2lvbk1hcCA9IHRoaXMucmVnaW9uTWFwLFxuICAgICAgICAgICAgICAgIHJhbmdleCwgcmFuZ2V5LCB5dmFsbGFzdCxcbiAgICAgICAgICAgICAgICBjYW52YXNUb3AsIGNhbnZhc0xlZnQsXG4gICAgICAgICAgICAgICAgdmVydGV4LCBwYXRoLCBwYXRocywgeCwgeSwgeG5leHQsIHhwb3MsIHhwb3NuZXh0LFxuICAgICAgICAgICAgICAgIGxhc3QsIG5leHQsIHl2YWxjb3VudCwgbGluZVNoYXBlcywgZmlsbFNoYXBlcywgcGxlbixcbiAgICAgICAgICAgICAgICB2YWx1ZVNwb3RzLCBobFNwb3RzRW5hYmxlZCwgY29sb3IsIHh2YWx1ZXMsIHl2YWx1ZXMsIGk7XG5cbiAgICAgICAgICAgIGlmICghbGluZS5fc3VwZXIucmVuZGVyLmNhbGwodGhpcykpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuc2NhblZhbHVlcygpO1xuICAgICAgICAgICAgdGhpcy5wcm9jZXNzUmFuZ2VPcHRpb25zKCk7XG5cbiAgICAgICAgICAgIHh2YWx1ZXMgPSB0aGlzLnh2YWx1ZXM7XG4gICAgICAgICAgICB5dmFsdWVzID0gdGhpcy55dmFsdWVzO1xuXG4gICAgICAgICAgICBpZiAoIXRoaXMueW1pbm1heC5sZW5ndGggfHwgdGhpcy55dmFsdWVzLmxlbmd0aCA8IDIpIHtcbiAgICAgICAgICAgICAgICAvLyBlbXB0eSBvciBhbGwgbnVsbCB2YWx1ZXNzXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYW52YXNUb3AgPSBjYW52YXNMZWZ0ID0gMDtcblxuICAgICAgICAgICAgcmFuZ2V4ID0gdGhpcy5tYXh4IC0gdGhpcy5taW54ID09PSAwID8gMSA6IHRoaXMubWF4eCAtIHRoaXMubWlueDtcbiAgICAgICAgICAgIHJhbmdleSA9IHRoaXMubWF4eSAtIHRoaXMubWlueSA9PT0gMCA/IDEgOiB0aGlzLm1heHkgLSB0aGlzLm1pbnk7XG4gICAgICAgICAgICB5dmFsbGFzdCA9IHRoaXMueXZhbHVlcy5sZW5ndGggLSAxO1xuXG4gICAgICAgICAgICBpZiAoc3BvdFJhZGl1cyAmJiAoY2FudmFzV2lkdGggPCAoc3BvdFJhZGl1cyAqIDQpIHx8IGNhbnZhc0hlaWdodCA8IChzcG90UmFkaXVzICogNCkpKSB7XG4gICAgICAgICAgICAgICAgc3BvdFJhZGl1cyA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc3BvdFJhZGl1cykge1xuICAgICAgICAgICAgICAgIC8vIGFkanVzdCB0aGUgY2FudmFzIHNpemUgYXMgcmVxdWlyZWQgc28gdGhhdCBzcG90cyB3aWxsIGZpdFxuICAgICAgICAgICAgICAgIGhsU3BvdHNFbmFibGVkID0gb3B0aW9ucy5nZXQoJ2hpZ2hsaWdodFNwb3RDb2xvcicpICYmICAhb3B0aW9ucy5nZXQoJ2Rpc2FibGVJbnRlcmFjdGlvbicpO1xuICAgICAgICAgICAgICAgIGlmIChobFNwb3RzRW5hYmxlZCB8fCBvcHRpb25zLmdldCgnbWluU3BvdENvbG9yJykgfHwgKG9wdGlvbnMuZ2V0KCdzcG90Q29sb3InKSAmJiB5dmFsdWVzW3l2YWxsYXN0XSA9PT0gdGhpcy5taW55KSkge1xuICAgICAgICAgICAgICAgICAgICBjYW52YXNIZWlnaHQgLT0gTWF0aC5jZWlsKHNwb3RSYWRpdXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoaGxTcG90c0VuYWJsZWQgfHwgb3B0aW9ucy5nZXQoJ21heFNwb3RDb2xvcicpIHx8IChvcHRpb25zLmdldCgnc3BvdENvbG9yJykgJiYgeXZhbHVlc1t5dmFsbGFzdF0gPT09IHRoaXMubWF4eSkpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzSGVpZ2h0IC09IE1hdGguY2VpbChzcG90UmFkaXVzKTtcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzVG9wICs9IE1hdGguY2VpbChzcG90UmFkaXVzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGhsU3BvdHNFbmFibGVkIHx8XG4gICAgICAgICAgICAgICAgICAgICAoKG9wdGlvbnMuZ2V0KCdtaW5TcG90Q29sb3InKSB8fCBvcHRpb25zLmdldCgnbWF4U3BvdENvbG9yJykpICYmICh5dmFsdWVzWzBdID09PSB0aGlzLm1pbnkgfHwgeXZhbHVlc1swXSA9PT0gdGhpcy5tYXh5KSkpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzTGVmdCArPSBNYXRoLmNlaWwoc3BvdFJhZGl1cyk7XG4gICAgICAgICAgICAgICAgICAgIGNhbnZhc1dpZHRoIC09IE1hdGguY2VpbChzcG90UmFkaXVzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGhsU3BvdHNFbmFibGVkIHx8IG9wdGlvbnMuZ2V0KCdzcG90Q29sb3InKSB8fFxuICAgICAgICAgICAgICAgICAgICAob3B0aW9ucy5nZXQoJ21pblNwb3RDb2xvcicpIHx8IG9wdGlvbnMuZ2V0KCdtYXhTcG90Q29sb3InKSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgKHl2YWx1ZXNbeXZhbGxhc3RdID09PSB0aGlzLm1pbnkgfHwgeXZhbHVlc1t5dmFsbGFzdF0gPT09IHRoaXMubWF4eSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhbnZhc1dpZHRoIC09IE1hdGguY2VpbChzcG90UmFkaXVzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgY2FudmFzSGVpZ2h0LS07XG5cbiAgICAgICAgICAgIGlmIChvcHRpb25zLmdldCgnbm9ybWFsUmFuZ2VNaW4nKSAhPT0gdW5kZWZpbmVkICYmICFvcHRpb25zLmdldCgnZHJhd05vcm1hbE9uVG9wJykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRyYXdOb3JtYWxSYW5nZShjYW52YXNMZWZ0LCBjYW52YXNUb3AsIGNhbnZhc0hlaWdodCwgY2FudmFzV2lkdGgsIHJhbmdleSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHBhdGggPSBbXTtcbiAgICAgICAgICAgIHBhdGhzID0gW3BhdGhdO1xuICAgICAgICAgICAgbGFzdCA9IG5leHQgPSBudWxsO1xuICAgICAgICAgICAgeXZhbGNvdW50ID0geXZhbHVlcy5sZW5ndGg7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgeXZhbGNvdW50OyBpKyspIHtcbiAgICAgICAgICAgICAgICB4ID0geHZhbHVlc1tpXTtcbiAgICAgICAgICAgICAgICB4bmV4dCA9IHh2YWx1ZXNbaSArIDFdO1xuICAgICAgICAgICAgICAgIHkgPSB5dmFsdWVzW2ldO1xuICAgICAgICAgICAgICAgIHhwb3MgPSBjYW52YXNMZWZ0ICsgTWF0aC5yb3VuZCgoeCAtIHRoaXMubWlueCkgKiAoY2FudmFzV2lkdGggLyByYW5nZXgpKTtcbiAgICAgICAgICAgICAgICB4cG9zbmV4dCA9IGkgPCB5dmFsY291bnQgLSAxID8gY2FudmFzTGVmdCArIE1hdGgucm91bmQoKHhuZXh0IC0gdGhpcy5taW54KSAqIChjYW52YXNXaWR0aCAvIHJhbmdleCkpIDogY2FudmFzV2lkdGg7XG4gICAgICAgICAgICAgICAgbmV4dCA9IHhwb3MgKyAoKHhwb3NuZXh0IC0geHBvcykgLyAyKTtcbiAgICAgICAgICAgICAgICByZWdpb25NYXBbaV0gPSBbbGFzdCB8fCAwLCBuZXh0LCBpXTtcbiAgICAgICAgICAgICAgICBsYXN0ID0gbmV4dDtcbiAgICAgICAgICAgICAgICBpZiAoeSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHl2YWx1ZXNbaSAtIDFdICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aCA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGhzLnB1c2gocGF0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB2ZXJ0aWNlcy5wdXNoKG51bGwpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHkgPCB0aGlzLm1pbnkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHkgPSB0aGlzLm1pbnk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHkgPiB0aGlzLm1heHkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHkgPSB0aGlzLm1heHk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFwYXRoLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gcHJldmlvdXMgdmFsdWUgd2FzIG51bGxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhdGgucHVzaChbeHBvcywgY2FudmFzVG9wICsgY2FudmFzSGVpZ2h0XSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmVydGV4ID0gW3hwb3MsIGNhbnZhc1RvcCArIE1hdGgucm91bmQoY2FudmFzSGVpZ2h0IC0gKGNhbnZhc0hlaWdodCAqICgoeSAtIHRoaXMubWlueSkgLyByYW5nZXkpKSldO1xuICAgICAgICAgICAgICAgICAgICBwYXRoLnB1c2godmVydGV4KTtcbiAgICAgICAgICAgICAgICAgICAgdmVydGljZXMucHVzaCh2ZXJ0ZXgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbGluZVNoYXBlcyA9IFtdO1xuICAgICAgICAgICAgZmlsbFNoYXBlcyA9IFtdO1xuICAgICAgICAgICAgcGxlbiA9IHBhdGhzLmxlbmd0aDtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBwbGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgICBwYXRoID0gcGF0aHNbaV07XG4gICAgICAgICAgICAgICAgaWYgKHBhdGgubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLmdldCgnZmlsbENvbG9yJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhdGgucHVzaChbcGF0aFtwYXRoLmxlbmd0aCAtIDFdWzBdLCAoY2FudmFzVG9wICsgY2FudmFzSGVpZ2h0KV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgZmlsbFNoYXBlcy5wdXNoKHBhdGguc2xpY2UoMCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcGF0aC5wb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyBpZiB0aGVyZSdzIG9ubHkgYSBzaW5nbGUgcG9pbnQgaW4gdGhpcyBwYXRoLCB0aGVuIHdlIHdhbnQgdG8gZGlzcGxheSBpdFxuICAgICAgICAgICAgICAgICAgICAvLyBhcyBhIHZlcnRpY2FsIGxpbmUgd2hpY2ggbWVhbnMgd2Uga2VlcCBwYXRoWzBdICBhcyBpc1xuICAgICAgICAgICAgICAgICAgICBpZiAocGF0aC5sZW5ndGggPiAyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBlbHNlIHdlIHdhbnQgdGhlIGZpcnN0IHZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXRoWzBdID0gW3BhdGhbMF1bMF0sIHBhdGhbMV1bMV1dO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGxpbmVTaGFwZXMucHVzaChwYXRoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGRyYXcgdGhlIGZpbGwgZmlyc3QsIHRoZW4gb3B0aW9uYWxseSB0aGUgbm9ybWFsIHJhbmdlLCB0aGVuIHRoZSBsaW5lIG9uIHRvcCBvZiB0aGF0XG4gICAgICAgICAgICBwbGVuID0gZmlsbFNoYXBlcy5sZW5ndGg7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgcGxlbjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0LmRyYXdTaGFwZShmaWxsU2hhcGVzW2ldLFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmdldCgnZmlsbENvbG9yJyksIG9wdGlvbnMuZ2V0KCdmaWxsQ29sb3InKSkuYXBwZW5kKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChvcHRpb25zLmdldCgnbm9ybWFsUmFuZ2VNaW4nKSAhPT0gdW5kZWZpbmVkICYmIG9wdGlvbnMuZ2V0KCdkcmF3Tm9ybWFsT25Ub3AnKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZHJhd05vcm1hbFJhbmdlKGNhbnZhc0xlZnQsIGNhbnZhc1RvcCwgY2FudmFzSGVpZ2h0LCBjYW52YXNXaWR0aCwgcmFuZ2V5KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcGxlbiA9IGxpbmVTaGFwZXMubGVuZ3RoO1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHBsZW47IGkrKykge1xuICAgICAgICAgICAgICAgIHRhcmdldC5kcmF3U2hhcGUobGluZVNoYXBlc1tpXSwgb3B0aW9ucy5nZXQoJ2xpbmVDb2xvcicpLCB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZ2V0KCdsaW5lV2lkdGgnKSkuYXBwZW5kKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChzcG90UmFkaXVzICYmIG9wdGlvbnMuZ2V0KCd2YWx1ZVNwb3RzJykpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZVNwb3RzID0gb3B0aW9ucy5nZXQoJ3ZhbHVlU3BvdHMnKTtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWVTcG90cy5nZXQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZVNwb3RzID0gbmV3IFJhbmdlTWFwKHZhbHVlU3BvdHMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgeXZhbGNvdW50OyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgY29sb3IgPSB2YWx1ZVNwb3RzLmdldCh5dmFsdWVzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbG9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQuZHJhd0NpcmNsZShjYW52YXNMZWZ0ICsgTWF0aC5yb3VuZCgoeHZhbHVlc1tpXSAtIHRoaXMubWlueCkgKiAoY2FudmFzV2lkdGggLyByYW5nZXgpKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYW52YXNUb3AgKyBNYXRoLnJvdW5kKGNhbnZhc0hlaWdodCAtIChjYW52YXNIZWlnaHQgKiAoKHl2YWx1ZXNbaV0gLSB0aGlzLm1pbnkpIC8gcmFuZ2V5KSkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwb3RSYWRpdXMsIHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcikuYXBwZW5kKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzcG90UmFkaXVzICYmIG9wdGlvbnMuZ2V0KCdzcG90Q29sb3InKSAmJiB5dmFsdWVzW3l2YWxsYXN0XSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRhcmdldC5kcmF3Q2lyY2xlKGNhbnZhc0xlZnQgKyBNYXRoLnJvdW5kKCh4dmFsdWVzW3h2YWx1ZXMubGVuZ3RoIC0gMV0gLSB0aGlzLm1pbngpICogKGNhbnZhc1dpZHRoIC8gcmFuZ2V4KSksXG4gICAgICAgICAgICAgICAgICAgIGNhbnZhc1RvcCArIE1hdGgucm91bmQoY2FudmFzSGVpZ2h0IC0gKGNhbnZhc0hlaWdodCAqICgoeXZhbHVlc1t5dmFsbGFzdF0gLSB0aGlzLm1pbnkpIC8gcmFuZ2V5KSkpLFxuICAgICAgICAgICAgICAgICAgICBzcG90UmFkaXVzLCB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZ2V0KCdzcG90Q29sb3InKSkuYXBwZW5kKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5tYXh5ICE9PSB0aGlzLm1pbnlvcmcpIHtcbiAgICAgICAgICAgICAgICBpZiAoc3BvdFJhZGl1cyAmJiBvcHRpb25zLmdldCgnbWluU3BvdENvbG9yJykpIHtcbiAgICAgICAgICAgICAgICAgICAgeCA9IHh2YWx1ZXNbJC5pbkFycmF5KHRoaXMubWlueW9yZywgeXZhbHVlcyldO1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXQuZHJhd0NpcmNsZShjYW52YXNMZWZ0ICsgTWF0aC5yb3VuZCgoeCAtIHRoaXMubWlueCkgKiAoY2FudmFzV2lkdGggLyByYW5nZXgpKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbnZhc1RvcCArIE1hdGgucm91bmQoY2FudmFzSGVpZ2h0IC0gKGNhbnZhc0hlaWdodCAqICgodGhpcy5taW55b3JnIC0gdGhpcy5taW55KSAvIHJhbmdleSkpKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNwb3RSYWRpdXMsIHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZ2V0KCdtaW5TcG90Q29sb3InKSkuYXBwZW5kKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChzcG90UmFkaXVzICYmIG9wdGlvbnMuZ2V0KCdtYXhTcG90Q29sb3InKSkge1xuICAgICAgICAgICAgICAgICAgICB4ID0geHZhbHVlc1skLmluQXJyYXkodGhpcy5tYXh5b3JnLCB5dmFsdWVzKV07XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldC5kcmF3Q2lyY2xlKGNhbnZhc0xlZnQgKyBNYXRoLnJvdW5kKCh4IC0gdGhpcy5taW54KSAqIChjYW52YXNXaWR0aCAvIHJhbmdleCkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzVG9wICsgTWF0aC5yb3VuZChjYW52YXNIZWlnaHQgLSAoY2FudmFzSGVpZ2h0ICogKCh0aGlzLm1heHlvcmcgLSB0aGlzLm1pbnkpIC8gcmFuZ2V5KSkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3BvdFJhZGl1cywgdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5nZXQoJ21heFNwb3RDb2xvcicpKS5hcHBlbmQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMubGFzdFNoYXBlSWQgPSB0YXJnZXQuZ2V0TGFzdFNoYXBlSWQoKTtcbiAgICAgICAgICAgIHRoaXMuY2FudmFzVG9wID0gY2FudmFzVG9wO1xuICAgICAgICAgICAgdGFyZ2V0LnJlbmRlcigpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBCYXIgY2hhcnRzXG4gICAgICovXG4gICAgJC5mbi5zcGFya2xpbmUuYmFyID0gYmFyID0gY3JlYXRlQ2xhc3MoJC5mbi5zcGFya2xpbmUuX2Jhc2UsIGJhckhpZ2hsaWdodE1peGluLCB7XG4gICAgICAgIHR5cGU6ICdiYXInLFxuXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uIChlbCwgdmFsdWVzLCBvcHRpb25zLCB3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICAgICAgICB2YXIgYmFyV2lkdGggPSBwYXJzZUludChvcHRpb25zLmdldCgnYmFyV2lkdGgnKSwgMTApLFxuICAgICAgICAgICAgICAgIGJhclNwYWNpbmcgPSBwYXJzZUludChvcHRpb25zLmdldCgnYmFyU3BhY2luZycpLCAxMCksXG4gICAgICAgICAgICAgICAgY2hhcnRSYW5nZU1pbiA9IG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlTWluJyksXG4gICAgICAgICAgICAgICAgY2hhcnRSYW5nZU1heCA9IG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlTWF4JyksXG4gICAgICAgICAgICAgICAgY2hhcnRSYW5nZUNsaXAgPSBvcHRpb25zLmdldCgnY2hhcnRSYW5nZUNsaXAnKSxcbiAgICAgICAgICAgICAgICBzdGFja01pbiA9IEluZmluaXR5LFxuICAgICAgICAgICAgICAgIHN0YWNrTWF4ID0gLUluZmluaXR5LFxuICAgICAgICAgICAgICAgIGlzU3RhY2tTdHJpbmcsIGdyb3VwTWluLCBncm91cE1heCwgc3RhY2tSYW5nZXMsXG4gICAgICAgICAgICAgICAgbnVtVmFsdWVzLCBpLCB2bGVuLCByYW5nZSwgemVyb0F4aXMsIHhheGlzT2Zmc2V0LCBtaW4sIG1heCwgY2xpcE1pbiwgY2xpcE1heCxcbiAgICAgICAgICAgICAgICBzdGFja2VkLCB2bGlzdCwgaiwgc2xlbiwgc3ZhbHMsIHZhbCwgeW9mZnNldCwgeU1heENhbGMsIGNhbnZhc0hlaWdodEVmO1xuICAgICAgICAgICAgYmFyLl9zdXBlci5pbml0LmNhbGwodGhpcywgZWwsIHZhbHVlcywgb3B0aW9ucywgd2lkdGgsIGhlaWdodCk7XG5cbiAgICAgICAgICAgIC8vIHNjYW4gdmFsdWVzIHRvIGRldGVybWluZSB3aGV0aGVyIHRvIHN0YWNrIGJhcnNcbiAgICAgICAgICAgIGZvciAoaSA9IDAsIHZsZW4gPSB2YWx1ZXMubGVuZ3RoOyBpIDwgdmxlbjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFsID0gdmFsdWVzW2ldO1xuICAgICAgICAgICAgICAgIGlzU3RhY2tTdHJpbmcgPSB0eXBlb2YodmFsKSA9PT0gJ3N0cmluZycgJiYgdmFsLmluZGV4T2YoJzonKSA+IC0xO1xuICAgICAgICAgICAgICAgIGlmIChpc1N0YWNrU3RyaW5nIHx8ICQuaXNBcnJheSh2YWwpKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YWNrZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaXNTdGFja1N0cmluZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsID0gdmFsdWVzW2ldID0gbm9ybWFsaXplVmFsdWVzKHZhbC5zcGxpdCgnOicpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YWwgPSByZW1vdmUodmFsLCBudWxsKTsgLy8gbWluL21heCB3aWxsIHRyZWF0IG51bGwgYXMgemVyb1xuICAgICAgICAgICAgICAgICAgICBncm91cE1pbiA9IE1hdGgubWluLmFwcGx5KE1hdGgsIHZhbCk7XG4gICAgICAgICAgICAgICAgICAgIGdyb3VwTWF4ID0gTWF0aC5tYXguYXBwbHkoTWF0aCwgdmFsKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGdyb3VwTWluIDwgc3RhY2tNaW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrTWluID0gZ3JvdXBNaW47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGdyb3VwTWF4ID4gc3RhY2tNYXgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrTWF4ID0gZ3JvdXBNYXg7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuc3RhY2tlZCA9IHN0YWNrZWQ7XG4gICAgICAgICAgICB0aGlzLnJlZ2lvblNoYXBlcyA9IHt9O1xuICAgICAgICAgICAgdGhpcy5iYXJXaWR0aCA9IGJhcldpZHRoO1xuICAgICAgICAgICAgdGhpcy5iYXJTcGFjaW5nID0gYmFyU3BhY2luZztcbiAgICAgICAgICAgIHRoaXMudG90YWxCYXJXaWR0aCA9IGJhcldpZHRoICsgYmFyU3BhY2luZztcbiAgICAgICAgICAgIHRoaXMud2lkdGggPSB3aWR0aCA9ICh2YWx1ZXMubGVuZ3RoICogYmFyV2lkdGgpICsgKCh2YWx1ZXMubGVuZ3RoIC0gMSkgKiBiYXJTcGFjaW5nKTtcblxuICAgICAgICAgICAgdGhpcy5pbml0VGFyZ2V0KCk7XG5cbiAgICAgICAgICAgIGlmIChjaGFydFJhbmdlQ2xpcCkge1xuICAgICAgICAgICAgICAgIGNsaXBNaW4gPSBjaGFydFJhbmdlTWluID09PSB1bmRlZmluZWQgPyAtSW5maW5pdHkgOiBjaGFydFJhbmdlTWluO1xuICAgICAgICAgICAgICAgIGNsaXBNYXggPSBjaGFydFJhbmdlTWF4ID09PSB1bmRlZmluZWQgPyBJbmZpbml0eSA6IGNoYXJ0UmFuZ2VNYXg7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIG51bVZhbHVlcyA9IFtdO1xuICAgICAgICAgICAgc3RhY2tSYW5nZXMgPSBzdGFja2VkID8gW10gOiBudW1WYWx1ZXM7XG4gICAgICAgICAgICB2YXIgc3RhY2tUb3RhbHMgPSBbXTtcbiAgICAgICAgICAgIHZhciBzdGFja1Jhbmdlc05lZyA9IFtdO1xuICAgICAgICAgICAgZm9yIChpID0gMCwgdmxlbiA9IHZhbHVlcy5sZW5ndGg7IGkgPCB2bGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoc3RhY2tlZCkge1xuICAgICAgICAgICAgICAgICAgICB2bGlzdCA9IHZhbHVlc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWVzW2ldID0gc3ZhbHMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgc3RhY2tUb3RhbHNbaV0gPSAwO1xuICAgICAgICAgICAgICAgICAgICBzdGFja1Jhbmdlc1tpXSA9IHN0YWNrUmFuZ2VzTmVnW2ldID0gMDtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChqID0gMCwgc2xlbiA9IHZsaXN0Lmxlbmd0aDsgaiA8IHNsZW47IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsID0gc3ZhbHNbal0gPSBjaGFydFJhbmdlQ2xpcCA/IGNsaXB2YWwodmxpc3Rbal0sIGNsaXBNaW4sIGNsaXBNYXgpIDogdmxpc3Rbal07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhbCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhY2tUb3RhbHNbaV0gKz0gdmFsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RhY2tNaW4gPCAwICYmIHN0YWNrTWF4ID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsIDwgMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhY2tSYW5nZXNOZWdbaV0gKz0gTWF0aC5hYnModmFsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrUmFuZ2VzW2ldICs9IHZhbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrUmFuZ2VzW2ldICs9IE1hdGguYWJzKHZhbCAtICh2YWwgPCAwID8gc3RhY2tNYXggOiBzdGFja01pbikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW1WYWx1ZXMucHVzaCh2YWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsID0gY2hhcnRSYW5nZUNsaXAgPyBjbGlwdmFsKHZhbHVlc1tpXSwgY2xpcE1pbiwgY2xpcE1heCkgOiB2YWx1ZXNbaV07XG4gICAgICAgICAgICAgICAgICAgIHZhbCA9IHZhbHVlc1tpXSA9IG5vcm1hbGl6ZVZhbHVlKHZhbCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWwgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG51bVZhbHVlcy5wdXNoKHZhbCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm1heCA9IG1heCA9IE1hdGgubWF4LmFwcGx5KE1hdGgsIG51bVZhbHVlcyk7XG4gICAgICAgICAgICB0aGlzLm1pbiA9IG1pbiA9IE1hdGgubWluLmFwcGx5KE1hdGgsIG51bVZhbHVlcyk7XG4gICAgICAgICAgICB0aGlzLnN0YWNrTWF4ID0gc3RhY2tNYXggPSBzdGFja2VkID8gTWF0aC5tYXguYXBwbHkoTWF0aCwgc3RhY2tUb3RhbHMpIDogbWF4O1xuICAgICAgICAgICAgdGhpcy5zdGFja01pbiA9IHN0YWNrTWluID0gc3RhY2tlZCA/IE1hdGgubWluLmFwcGx5KE1hdGgsIG51bVZhbHVlcykgOiBtaW47XG5cbiAgICAgICAgICAgIGlmIChvcHRpb25zLmdldCgnY2hhcnRSYW5nZU1pbicpICE9PSB1bmRlZmluZWQgJiYgKG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlQ2xpcCcpIHx8IG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlTWluJykgPCBtaW4pKSB7XG4gICAgICAgICAgICAgICAgbWluID0gb3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNaW4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChvcHRpb25zLmdldCgnY2hhcnRSYW5nZU1heCcpICE9PSB1bmRlZmluZWQgJiYgKG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlQ2xpcCcpIHx8IG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlTWF4JykgPiBtYXgpKSB7XG4gICAgICAgICAgICAgICAgbWF4ID0gb3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNYXgnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy56ZXJvQXhpcyA9IHplcm9BeGlzID0gb3B0aW9ucy5nZXQoJ3plcm9BeGlzJywgdHJ1ZSk7XG4gICAgICAgICAgICBpZiAobWluIDw9IDAgJiYgbWF4ID49IDAgJiYgemVyb0F4aXMpIHtcbiAgICAgICAgICAgICAgICB4YXhpc09mZnNldCA9IDA7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHplcm9BeGlzID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgeGF4aXNPZmZzZXQgPSBtaW47XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG1pbiA+IDApIHtcbiAgICAgICAgICAgICAgICB4YXhpc09mZnNldCA9IG1pbjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgeGF4aXNPZmZzZXQgPSBtYXg7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnhheGlzT2Zmc2V0ID0geGF4aXNPZmZzZXQ7XG5cbiAgICAgICAgICAgIHJhbmdlID0gc3RhY2tlZCA/IChNYXRoLm1heC5hcHBseShNYXRoLCBzdGFja1JhbmdlcykgKyBNYXRoLm1heC5hcHBseShNYXRoLCBzdGFja1Jhbmdlc05lZykpIDogbWF4IC0gbWluO1xuXG4gICAgICAgICAgICAvLyBhcyB3ZSBwbG90IHplcm8vbWluIHZhbHVlcyBhIHNpbmdsZSBwaXhlbCBsaW5lLCB3ZSBhZGQgYSBwaXhlbCB0byBhbGwgb3RoZXJcbiAgICAgICAgICAgIC8vIHZhbHVlcyAtIFJlZHVjZSB0aGUgZWZmZWN0aXZlIGNhbnZhcyBzaXplIHRvIHN1aXRcbiAgICAgICAgICAgIHRoaXMuY2FudmFzSGVpZ2h0RWYgPSAoemVyb0F4aXMgJiYgbWluIDwgMCkgPyB0aGlzLmNhbnZhc0hlaWdodCAtIDIgOiB0aGlzLmNhbnZhc0hlaWdodCAtIDE7XG5cbiAgICAgICAgICAgIGlmIChtaW4gPCB4YXhpc09mZnNldCkge1xuICAgICAgICAgICAgICAgIHlNYXhDYWxjID0gKHN0YWNrZWQgJiYgbWF4ID49IDApID8gc3RhY2tNYXggOiBtYXg7XG4gICAgICAgICAgICAgICAgeW9mZnNldCA9ICh5TWF4Q2FsYyAtIHhheGlzT2Zmc2V0KSAvIHJhbmdlICogdGhpcy5jYW52YXNIZWlnaHQ7XG4gICAgICAgICAgICAgICAgaWYgKHlvZmZzZXQgIT09IE1hdGguY2VpbCh5b2Zmc2V0KSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNhbnZhc0hlaWdodEVmIC09IDI7XG4gICAgICAgICAgICAgICAgICAgIHlvZmZzZXQgPSBNYXRoLmNlaWwoeW9mZnNldCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB5b2Zmc2V0ID0gdGhpcy5jYW52YXNIZWlnaHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnlvZmZzZXQgPSB5b2Zmc2V0O1xuXG4gICAgICAgICAgICBpZiAoJC5pc0FycmF5KG9wdGlvbnMuZ2V0KCdjb2xvck1hcCcpKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuY29sb3JNYXBCeUluZGV4ID0gb3B0aW9ucy5nZXQoJ2NvbG9yTWFwJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5jb2xvck1hcEJ5VmFsdWUgPSBudWxsO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbG9yTWFwQnlJbmRleCA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5jb2xvck1hcEJ5VmFsdWUgPSBvcHRpb25zLmdldCgnY29sb3JNYXAnKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jb2xvck1hcEJ5VmFsdWUgJiYgdGhpcy5jb2xvck1hcEJ5VmFsdWUuZ2V0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb2xvck1hcEJ5VmFsdWUgPSBuZXcgUmFuZ2VNYXAodGhpcy5jb2xvck1hcEJ5VmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5yYW5nZSA9IHJhbmdlO1xuICAgICAgICB9LFxuXG4gICAgICAgIGdldFJlZ2lvbjogZnVuY3Rpb24gKGVsLCB4LCB5KSB7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gTWF0aC5mbG9vcih4IC8gdGhpcy50b3RhbEJhcldpZHRoKTtcbiAgICAgICAgICAgIHJldHVybiAocmVzdWx0IDwgMCB8fCByZXN1bHQgPj0gdGhpcy52YWx1ZXMubGVuZ3RoKSA/IHVuZGVmaW5lZCA6IHJlc3VsdDtcbiAgICAgICAgfSxcblxuICAgICAgICBnZXRDdXJyZW50UmVnaW9uRmllbGRzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgY3VycmVudFJlZ2lvbiA9IHRoaXMuY3VycmVudFJlZ2lvbixcbiAgICAgICAgICAgICAgICB2YWx1ZXMgPSBlbnN1cmVBcnJheSh0aGlzLnZhbHVlc1tjdXJyZW50UmVnaW9uXSksXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gW10sXG4gICAgICAgICAgICAgICAgdmFsdWUsIGk7XG4gICAgICAgICAgICBmb3IgKGkgPSB2YWx1ZXMubGVuZ3RoOyBpLS07KSB7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZXNbaV07XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBpc051bGw6IHZhbHVlID09PSBudWxsLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdmFsdWUsXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiB0aGlzLmNhbGNDb2xvcihpLCB2YWx1ZSwgY3VycmVudFJlZ2lvbiksXG4gICAgICAgICAgICAgICAgICAgIG9mZnNldDogY3VycmVudFJlZ2lvblxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfSxcblxuICAgICAgICBjYWxjQ29sb3I6IGZ1bmN0aW9uIChzdGFja251bSwgdmFsdWUsIHZhbHVlbnVtKSB7XG4gICAgICAgICAgICB2YXIgY29sb3JNYXBCeUluZGV4ID0gdGhpcy5jb2xvck1hcEJ5SW5kZXgsXG4gICAgICAgICAgICAgICAgY29sb3JNYXBCeVZhbHVlID0gdGhpcy5jb2xvck1hcEJ5VmFsdWUsXG4gICAgICAgICAgICAgICAgb3B0aW9ucyA9IHRoaXMub3B0aW9ucyxcbiAgICAgICAgICAgICAgICBjb2xvciwgbmV3Q29sb3I7XG4gICAgICAgICAgICBpZiAodGhpcy5zdGFja2VkKSB7XG4gICAgICAgICAgICAgICAgY29sb3IgPSBvcHRpb25zLmdldCgnc3RhY2tlZEJhckNvbG9yJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbG9yID0gKHZhbHVlIDwgMCkgPyBvcHRpb25zLmdldCgnbmVnQmFyQ29sb3InKSA6IG9wdGlvbnMuZ2V0KCdiYXJDb2xvcicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHZhbHVlID09PSAwICYmIG9wdGlvbnMuZ2V0KCd6ZXJvQ29sb3InKSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgY29sb3IgPSBvcHRpb25zLmdldCgnemVyb0NvbG9yJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoY29sb3JNYXBCeVZhbHVlICYmIChuZXdDb2xvciA9IGNvbG9yTWFwQnlWYWx1ZS5nZXQodmFsdWUpKSkge1xuICAgICAgICAgICAgICAgIGNvbG9yID0gbmV3Q29sb3I7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGNvbG9yTWFwQnlJbmRleCAmJiBjb2xvck1hcEJ5SW5kZXgubGVuZ3RoID4gdmFsdWVudW0pIHtcbiAgICAgICAgICAgICAgICBjb2xvciA9IGNvbG9yTWFwQnlJbmRleFt2YWx1ZW51bV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gJC5pc0FycmF5KGNvbG9yKSA/IGNvbG9yW3N0YWNrbnVtICUgY29sb3IubGVuZ3RoXSA6IGNvbG9yO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSZW5kZXIgYmFyKHMpIGZvciBhIHJlZ2lvblxuICAgICAgICAgKi9cbiAgICAgICAgcmVuZGVyUmVnaW9uOiBmdW5jdGlvbiAodmFsdWVudW0sIGhpZ2hsaWdodCkge1xuICAgICAgICAgICAgdmFyIHZhbHMgPSB0aGlzLnZhbHVlc1t2YWx1ZW51bV0sXG4gICAgICAgICAgICAgICAgb3B0aW9ucyA9IHRoaXMub3B0aW9ucyxcbiAgICAgICAgICAgICAgICB4YXhpc09mZnNldCA9IHRoaXMueGF4aXNPZmZzZXQsXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gW10sXG4gICAgICAgICAgICAgICAgcmFuZ2UgPSB0aGlzLnJhbmdlLFxuICAgICAgICAgICAgICAgIHN0YWNrZWQgPSB0aGlzLnN0YWNrZWQsXG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0gdGhpcy50YXJnZXQsXG4gICAgICAgICAgICAgICAgeCA9IHZhbHVlbnVtICogdGhpcy50b3RhbEJhcldpZHRoLFxuICAgICAgICAgICAgICAgIGNhbnZhc0hlaWdodEVmID0gdGhpcy5jYW52YXNIZWlnaHRFZixcbiAgICAgICAgICAgICAgICB5b2Zmc2V0ID0gdGhpcy55b2Zmc2V0LFxuICAgICAgICAgICAgICAgIHksIGhlaWdodCwgY29sb3IsIGlzTnVsbCwgeW9mZnNldE5lZywgaSwgdmFsY291bnQsIHZhbCwgbWluUGxvdHRlZCwgYWxsTWluO1xuXG4gICAgICAgICAgICB2YWxzID0gJC5pc0FycmF5KHZhbHMpID8gdmFscyA6IFt2YWxzXTtcbiAgICAgICAgICAgIHZhbGNvdW50ID0gdmFscy5sZW5ndGg7XG4gICAgICAgICAgICB2YWwgPSB2YWxzWzBdO1xuICAgICAgICAgICAgaXNOdWxsID0gYWxsKG51bGwsIHZhbHMpO1xuICAgICAgICAgICAgYWxsTWluID0gYWxsKHhheGlzT2Zmc2V0LCB2YWxzLCB0cnVlKTtcblxuICAgICAgICAgICAgaWYgKGlzTnVsbCkge1xuICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLmdldCgnbnVsbENvbG9yJykpIHtcbiAgICAgICAgICAgICAgICAgICAgY29sb3IgPSBoaWdobGlnaHQgPyBvcHRpb25zLmdldCgnbnVsbENvbG9yJykgOiB0aGlzLmNhbGNIaWdobGlnaHRDb2xvcihvcHRpb25zLmdldCgnbnVsbENvbG9yJyksIG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICB5ID0gKHlvZmZzZXQgPiAwKSA/IHlvZmZzZXQgLSAxIDogeW9mZnNldDtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRhcmdldC5kcmF3UmVjdCh4LCB5LCB0aGlzLmJhcldpZHRoIC0gMSwgMCwgY29sb3IsIGNvbG9yKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHlvZmZzZXROZWcgPSB5b2Zmc2V0O1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHZhbGNvdW50OyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YWwgPSB2YWxzW2ldO1xuXG4gICAgICAgICAgICAgICAgaWYgKHN0YWNrZWQgJiYgdmFsID09PSB4YXhpc09mZnNldCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWFsbE1pbiB8fCBtaW5QbG90dGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBtaW5QbG90dGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAocmFuZ2UgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGhlaWdodCA9IE1hdGguZmxvb3IoY2FudmFzSGVpZ2h0RWYgKiAoKE1hdGguYWJzKHZhbCAtIHhheGlzT2Zmc2V0KSAvIHJhbmdlKSkpICsgMTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBoZWlnaHQgPSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodmFsIDwgeGF4aXNPZmZzZXQgfHwgKHZhbCA9PT0geGF4aXNPZmZzZXQgJiYgeW9mZnNldCA9PT0gMCkpIHtcbiAgICAgICAgICAgICAgICAgICAgeSA9IHlvZmZzZXROZWc7XG4gICAgICAgICAgICAgICAgICAgIHlvZmZzZXROZWcgKz0gaGVpZ2h0O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHkgPSB5b2Zmc2V0IC0gaGVpZ2h0O1xuICAgICAgICAgICAgICAgICAgICB5b2Zmc2V0IC09IGhlaWdodDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29sb3IgPSB0aGlzLmNhbGNDb2xvcihpLCB2YWwsIHZhbHVlbnVtKTtcbiAgICAgICAgICAgICAgICBpZiAoaGlnaGxpZ2h0KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbG9yID0gdGhpcy5jYWxjSGlnaGxpZ2h0Q29sb3IoY29sb3IsIG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaCh0YXJnZXQuZHJhd1JlY3QoeCwgeSwgdGhpcy5iYXJXaWR0aCAtIDEsIGhlaWdodCAtIDEsIGNvbG9yLCBjb2xvcikpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHJlc3VsdC5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0WzBdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogVHJpc3RhdGUgY2hhcnRzXG4gICAgICovXG4gICAgJC5mbi5zcGFya2xpbmUudHJpc3RhdGUgPSB0cmlzdGF0ZSA9IGNyZWF0ZUNsYXNzKCQuZm4uc3BhcmtsaW5lLl9iYXNlLCBiYXJIaWdobGlnaHRNaXhpbiwge1xuICAgICAgICB0eXBlOiAndHJpc3RhdGUnLFxuXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uIChlbCwgdmFsdWVzLCBvcHRpb25zLCB3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICAgICAgICB2YXIgYmFyV2lkdGggPSBwYXJzZUludChvcHRpb25zLmdldCgnYmFyV2lkdGgnKSwgMTApLFxuICAgICAgICAgICAgICAgIGJhclNwYWNpbmcgPSBwYXJzZUludChvcHRpb25zLmdldCgnYmFyU3BhY2luZycpLCAxMCk7XG4gICAgICAgICAgICB0cmlzdGF0ZS5fc3VwZXIuaW5pdC5jYWxsKHRoaXMsIGVsLCB2YWx1ZXMsIG9wdGlvbnMsIHdpZHRoLCBoZWlnaHQpO1xuXG4gICAgICAgICAgICB0aGlzLnJlZ2lvblNoYXBlcyA9IHt9O1xuICAgICAgICAgICAgdGhpcy5iYXJXaWR0aCA9IGJhcldpZHRoO1xuICAgICAgICAgICAgdGhpcy5iYXJTcGFjaW5nID0gYmFyU3BhY2luZztcbiAgICAgICAgICAgIHRoaXMudG90YWxCYXJXaWR0aCA9IGJhcldpZHRoICsgYmFyU3BhY2luZztcbiAgICAgICAgICAgIHRoaXMudmFsdWVzID0gJC5tYXAodmFsdWVzLCBOdW1iZXIpO1xuICAgICAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoID0gKHZhbHVlcy5sZW5ndGggKiBiYXJXaWR0aCkgKyAoKHZhbHVlcy5sZW5ndGggLSAxKSAqIGJhclNwYWNpbmcpO1xuXG4gICAgICAgICAgICBpZiAoJC5pc0FycmF5KG9wdGlvbnMuZ2V0KCdjb2xvck1hcCcpKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuY29sb3JNYXBCeUluZGV4ID0gb3B0aW9ucy5nZXQoJ2NvbG9yTWFwJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5jb2xvck1hcEJ5VmFsdWUgPSBudWxsO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbG9yTWFwQnlJbmRleCA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5jb2xvck1hcEJ5VmFsdWUgPSBvcHRpb25zLmdldCgnY29sb3JNYXAnKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jb2xvck1hcEJ5VmFsdWUgJiYgdGhpcy5jb2xvck1hcEJ5VmFsdWUuZ2V0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb2xvck1hcEJ5VmFsdWUgPSBuZXcgUmFuZ2VNYXAodGhpcy5jb2xvck1hcEJ5VmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuaW5pdFRhcmdldCgpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGdldFJlZ2lvbjogZnVuY3Rpb24gKGVsLCB4LCB5KSB7XG4gICAgICAgICAgICByZXR1cm4gTWF0aC5mbG9vcih4IC8gdGhpcy50b3RhbEJhcldpZHRoKTtcbiAgICAgICAgfSxcblxuICAgICAgICBnZXRDdXJyZW50UmVnaW9uRmllbGRzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgY3VycmVudFJlZ2lvbiA9IHRoaXMuY3VycmVudFJlZ2lvbjtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgaXNOdWxsOiB0aGlzLnZhbHVlc1tjdXJyZW50UmVnaW9uXSA9PT0gdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIHZhbHVlOiB0aGlzLnZhbHVlc1tjdXJyZW50UmVnaW9uXSxcbiAgICAgICAgICAgICAgICBjb2xvcjogdGhpcy5jYWxjQ29sb3IodGhpcy52YWx1ZXNbY3VycmVudFJlZ2lvbl0sIGN1cnJlbnRSZWdpb24pLFxuICAgICAgICAgICAgICAgIG9mZnNldDogY3VycmVudFJlZ2lvblxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSxcblxuICAgICAgICBjYWxjQ29sb3I6IGZ1bmN0aW9uICh2YWx1ZSwgdmFsdWVudW0pIHtcbiAgICAgICAgICAgIHZhciB2YWx1ZXMgPSB0aGlzLnZhbHVlcyxcbiAgICAgICAgICAgICAgICBvcHRpb25zID0gdGhpcy5vcHRpb25zLFxuICAgICAgICAgICAgICAgIGNvbG9yTWFwQnlJbmRleCA9IHRoaXMuY29sb3JNYXBCeUluZGV4LFxuICAgICAgICAgICAgICAgIGNvbG9yTWFwQnlWYWx1ZSA9IHRoaXMuY29sb3JNYXBCeVZhbHVlLFxuICAgICAgICAgICAgICAgIGNvbG9yLCBuZXdDb2xvcjtcblxuICAgICAgICAgICAgaWYgKGNvbG9yTWFwQnlWYWx1ZSAmJiAobmV3Q29sb3IgPSBjb2xvck1hcEJ5VmFsdWUuZ2V0KHZhbHVlKSkpIHtcbiAgICAgICAgICAgICAgICBjb2xvciA9IG5ld0NvbG9yO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChjb2xvck1hcEJ5SW5kZXggJiYgY29sb3JNYXBCeUluZGV4Lmxlbmd0aCA+IHZhbHVlbnVtKSB7XG4gICAgICAgICAgICAgICAgY29sb3IgPSBjb2xvck1hcEJ5SW5kZXhbdmFsdWVudW1dO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZXNbdmFsdWVudW1dIDwgMCkge1xuICAgICAgICAgICAgICAgIGNvbG9yID0gb3B0aW9ucy5nZXQoJ25lZ0JhckNvbG9yJyk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlc1t2YWx1ZW51bV0gPiAwKSB7XG4gICAgICAgICAgICAgICAgY29sb3IgPSBvcHRpb25zLmdldCgncG9zQmFyQ29sb3InKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29sb3IgPSBvcHRpb25zLmdldCgnemVyb0JhckNvbG9yJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY29sb3I7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVuZGVyUmVnaW9uOiBmdW5jdGlvbiAodmFsdWVudW0sIGhpZ2hsaWdodCkge1xuICAgICAgICAgICAgdmFyIHZhbHVlcyA9IHRoaXMudmFsdWVzLFxuICAgICAgICAgICAgICAgIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnMsXG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0gdGhpcy50YXJnZXQsXG4gICAgICAgICAgICAgICAgY2FudmFzSGVpZ2h0LCBoZWlnaHQsIGhhbGZIZWlnaHQsXG4gICAgICAgICAgICAgICAgeCwgeSwgY29sb3I7XG5cbiAgICAgICAgICAgIGNhbnZhc0hlaWdodCA9IHRhcmdldC5waXhlbEhlaWdodDtcbiAgICAgICAgICAgIGhhbGZIZWlnaHQgPSBNYXRoLnJvdW5kKGNhbnZhc0hlaWdodCAvIDIpO1xuXG4gICAgICAgICAgICB4ID0gdmFsdWVudW0gKiB0aGlzLnRvdGFsQmFyV2lkdGg7XG4gICAgICAgICAgICBpZiAodmFsdWVzW3ZhbHVlbnVtXSA8IDApIHtcbiAgICAgICAgICAgICAgICB5ID0gaGFsZkhlaWdodDtcbiAgICAgICAgICAgICAgICBoZWlnaHQgPSBoYWxmSGVpZ2h0IC0gMTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodmFsdWVzW3ZhbHVlbnVtXSA+IDApIHtcbiAgICAgICAgICAgICAgICB5ID0gMDtcbiAgICAgICAgICAgICAgICBoZWlnaHQgPSBoYWxmSGVpZ2h0IC0gMTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgeSA9IGhhbGZIZWlnaHQgLSAxO1xuICAgICAgICAgICAgICAgIGhlaWdodCA9IDI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb2xvciA9IHRoaXMuY2FsY0NvbG9yKHZhbHVlc1t2YWx1ZW51bV0sIHZhbHVlbnVtKTtcbiAgICAgICAgICAgIGlmIChjb2xvciA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChoaWdobGlnaHQpIHtcbiAgICAgICAgICAgICAgICBjb2xvciA9IHRoaXMuY2FsY0hpZ2hsaWdodENvbG9yKGNvbG9yLCBvcHRpb25zKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0YXJnZXQuZHJhd1JlY3QoeCwgeSwgdGhpcy5iYXJXaWR0aCAtIDEsIGhlaWdodCAtIDEsIGNvbG9yLCBjb2xvcik7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIERpc2NyZXRlIGNoYXJ0c1xuICAgICAqL1xuICAgICQuZm4uc3BhcmtsaW5lLmRpc2NyZXRlID0gZGlzY3JldGUgPSBjcmVhdGVDbGFzcygkLmZuLnNwYXJrbGluZS5fYmFzZSwgYmFySGlnaGxpZ2h0TWl4aW4sIHtcbiAgICAgICAgdHlwZTogJ2Rpc2NyZXRlJyxcblxuICAgICAgICBpbml0OiBmdW5jdGlvbiAoZWwsIHZhbHVlcywgb3B0aW9ucywgd2lkdGgsIGhlaWdodCkge1xuICAgICAgICAgICAgZGlzY3JldGUuX3N1cGVyLmluaXQuY2FsbCh0aGlzLCBlbCwgdmFsdWVzLCBvcHRpb25zLCB3aWR0aCwgaGVpZ2h0KTtcblxuICAgICAgICAgICAgdGhpcy5yZWdpb25TaGFwZXMgPSB7fTtcbiAgICAgICAgICAgIHRoaXMudmFsdWVzID0gdmFsdWVzID0gJC5tYXAodmFsdWVzLCBOdW1iZXIpO1xuICAgICAgICAgICAgdGhpcy5taW4gPSBNYXRoLm1pbi5hcHBseShNYXRoLCB2YWx1ZXMpO1xuICAgICAgICAgICAgdGhpcy5tYXggPSBNYXRoLm1heC5hcHBseShNYXRoLCB2YWx1ZXMpO1xuICAgICAgICAgICAgdGhpcy5yYW5nZSA9IHRoaXMubWF4IC0gdGhpcy5taW47XG4gICAgICAgICAgICB0aGlzLndpZHRoID0gd2lkdGggPSBvcHRpb25zLmdldCgnd2lkdGgnKSA9PT0gJ2F1dG8nID8gdmFsdWVzLmxlbmd0aCAqIDIgOiB0aGlzLndpZHRoO1xuICAgICAgICAgICAgdGhpcy5pbnRlcnZhbCA9IE1hdGguZmxvb3Iod2lkdGggLyB2YWx1ZXMubGVuZ3RoKTtcbiAgICAgICAgICAgIHRoaXMuaXRlbVdpZHRoID0gd2lkdGggLyB2YWx1ZXMubGVuZ3RoO1xuICAgICAgICAgICAgaWYgKG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlTWluJykgIT09IHVuZGVmaW5lZCAmJiAob3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VDbGlwJykgfHwgb3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNaW4nKSA8IHRoaXMubWluKSkge1xuICAgICAgICAgICAgICAgIHRoaXMubWluID0gb3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNaW4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChvcHRpb25zLmdldCgnY2hhcnRSYW5nZU1heCcpICE9PSB1bmRlZmluZWQgJiYgKG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlQ2xpcCcpIHx8IG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlTWF4JykgPiB0aGlzLm1heCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1heCA9IG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlTWF4Jyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmluaXRUYXJnZXQoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnRhcmdldCkge1xuICAgICAgICAgICAgICAgIHRoaXMubGluZUhlaWdodCA9IG9wdGlvbnMuZ2V0KCdsaW5lSGVpZ2h0JykgPT09ICdhdXRvJyA/IE1hdGgucm91bmQodGhpcy5jYW52YXNIZWlnaHQgKiAwLjMpIDogb3B0aW9ucy5nZXQoJ2xpbmVIZWlnaHQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBnZXRSZWdpb246IGZ1bmN0aW9uIChlbCwgeCwgeSkge1xuICAgICAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoeCAvIHRoaXMuaXRlbVdpZHRoKTtcbiAgICAgICAgfSxcblxuICAgICAgICBnZXRDdXJyZW50UmVnaW9uRmllbGRzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgY3VycmVudFJlZ2lvbiA9IHRoaXMuY3VycmVudFJlZ2lvbjtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgaXNOdWxsOiB0aGlzLnZhbHVlc1tjdXJyZW50UmVnaW9uXSA9PT0gdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIHZhbHVlOiB0aGlzLnZhbHVlc1tjdXJyZW50UmVnaW9uXSxcbiAgICAgICAgICAgICAgICBvZmZzZXQ6IGN1cnJlbnRSZWdpb25cbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVuZGVyUmVnaW9uOiBmdW5jdGlvbiAodmFsdWVudW0sIGhpZ2hsaWdodCkge1xuICAgICAgICAgICAgdmFyIHZhbHVlcyA9IHRoaXMudmFsdWVzLFxuICAgICAgICAgICAgICAgIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnMsXG4gICAgICAgICAgICAgICAgbWluID0gdGhpcy5taW4sXG4gICAgICAgICAgICAgICAgbWF4ID0gdGhpcy5tYXgsXG4gICAgICAgICAgICAgICAgcmFuZ2UgPSB0aGlzLnJhbmdlLFxuICAgICAgICAgICAgICAgIGludGVydmFsID0gdGhpcy5pbnRlcnZhbCxcbiAgICAgICAgICAgICAgICB0YXJnZXQgPSB0aGlzLnRhcmdldCxcbiAgICAgICAgICAgICAgICBjYW52YXNIZWlnaHQgPSB0aGlzLmNhbnZhc0hlaWdodCxcbiAgICAgICAgICAgICAgICBsaW5lSGVpZ2h0ID0gdGhpcy5saW5lSGVpZ2h0LFxuICAgICAgICAgICAgICAgIHBoZWlnaHQgPSBjYW52YXNIZWlnaHQgLSBsaW5lSGVpZ2h0LFxuICAgICAgICAgICAgICAgIHl0b3AsIHZhbCwgY29sb3IsIHg7XG5cbiAgICAgICAgICAgIHZhbCA9IGNsaXB2YWwodmFsdWVzW3ZhbHVlbnVtXSwgbWluLCBtYXgpO1xuICAgICAgICAgICAgeCA9IHZhbHVlbnVtICogaW50ZXJ2YWw7XG4gICAgICAgICAgICB5dG9wID0gTWF0aC5yb3VuZChwaGVpZ2h0IC0gcGhlaWdodCAqICgodmFsIC0gbWluKSAvIHJhbmdlKSk7XG4gICAgICAgICAgICBjb2xvciA9IChvcHRpb25zLmdldCgndGhyZXNob2xkQ29sb3InKSAmJiB2YWwgPCBvcHRpb25zLmdldCgndGhyZXNob2xkVmFsdWUnKSkgPyBvcHRpb25zLmdldCgndGhyZXNob2xkQ29sb3InKSA6IG9wdGlvbnMuZ2V0KCdsaW5lQ29sb3InKTtcbiAgICAgICAgICAgIGlmIChoaWdobGlnaHQpIHtcbiAgICAgICAgICAgICAgICBjb2xvciA9IHRoaXMuY2FsY0hpZ2hsaWdodENvbG9yKGNvbG9yLCBvcHRpb25zKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0YXJnZXQuZHJhd0xpbmUoeCwgeXRvcCwgeCwgeXRvcCArIGxpbmVIZWlnaHQsIGNvbG9yKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQnVsbGV0IGNoYXJ0c1xuICAgICAqL1xuICAgICQuZm4uc3BhcmtsaW5lLmJ1bGxldCA9IGJ1bGxldCA9IGNyZWF0ZUNsYXNzKCQuZm4uc3BhcmtsaW5lLl9iYXNlLCB7XG4gICAgICAgIHR5cGU6ICdidWxsZXQnLFxuXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uIChlbCwgdmFsdWVzLCBvcHRpb25zLCB3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICAgICAgICB2YXIgbWluLCBtYXgsIHZhbHM7XG4gICAgICAgICAgICBidWxsZXQuX3N1cGVyLmluaXQuY2FsbCh0aGlzLCBlbCwgdmFsdWVzLCBvcHRpb25zLCB3aWR0aCwgaGVpZ2h0KTtcblxuICAgICAgICAgICAgLy8gdmFsdWVzOiB0YXJnZXQsIHBlcmZvcm1hbmNlLCByYW5nZTEsIHJhbmdlMiwgcmFuZ2UzXG4gICAgICAgICAgICB0aGlzLnZhbHVlcyA9IHZhbHVlcyA9IG5vcm1hbGl6ZVZhbHVlcyh2YWx1ZXMpO1xuICAgICAgICAgICAgLy8gdGFyZ2V0IG9yIHBlcmZvcm1hbmNlIGNvdWxkIGJlIG51bGxcbiAgICAgICAgICAgIHZhbHMgPSB2YWx1ZXMuc2xpY2UoKTtcbiAgICAgICAgICAgIHZhbHNbMF0gPSB2YWxzWzBdID09PSBudWxsID8gdmFsc1syXSA6IHZhbHNbMF07XG4gICAgICAgICAgICB2YWxzWzFdID0gdmFsdWVzWzFdID09PSBudWxsID8gdmFsc1syXSA6IHZhbHNbMV07XG4gICAgICAgICAgICBtaW4gPSBNYXRoLm1pbi5hcHBseShNYXRoLCB2YWx1ZXMpO1xuICAgICAgICAgICAgbWF4ID0gTWF0aC5tYXguYXBwbHkoTWF0aCwgdmFsdWVzKTtcbiAgICAgICAgICAgIGlmIChvcHRpb25zLmdldCgnYmFzZScpID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBtaW4gPSBtaW4gPCAwID8gbWluIDogMDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbWluID0gb3B0aW9ucy5nZXQoJ2Jhc2UnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubWluID0gbWluO1xuICAgICAgICAgICAgdGhpcy5tYXggPSBtYXg7XG4gICAgICAgICAgICB0aGlzLnJhbmdlID0gbWF4IC0gbWluO1xuICAgICAgICAgICAgdGhpcy5zaGFwZXMgPSB7fTtcbiAgICAgICAgICAgIHRoaXMudmFsdWVTaGFwZXMgPSB7fTtcbiAgICAgICAgICAgIHRoaXMucmVnaW9uZGF0YSA9IHt9O1xuICAgICAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoID0gb3B0aW9ucy5nZXQoJ3dpZHRoJykgPT09ICdhdXRvJyA/ICc0LjBlbScgOiB3aWR0aDtcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0ID0gdGhpcy4kZWwuc2ltcGxlZHJhdyh3aWR0aCwgaGVpZ2h0LCBvcHRpb25zLmdldCgnY29tcG9zaXRlJykpO1xuICAgICAgICAgICAgaWYgKCF2YWx1ZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kaXNhYmxlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmluaXRUYXJnZXQoKTtcbiAgICAgICAgfSxcblxuICAgICAgICBnZXRSZWdpb246IGZ1bmN0aW9uIChlbCwgeCwgeSkge1xuICAgICAgICAgICAgdmFyIHNoYXBlaWQgPSB0aGlzLnRhcmdldC5nZXRTaGFwZUF0KGVsLCB4LCB5KTtcbiAgICAgICAgICAgIHJldHVybiAoc2hhcGVpZCAhPT0gdW5kZWZpbmVkICYmIHRoaXMuc2hhcGVzW3NoYXBlaWRdICE9PSB1bmRlZmluZWQpID8gdGhpcy5zaGFwZXNbc2hhcGVpZF0gOiB1bmRlZmluZWQ7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2V0Q3VycmVudFJlZ2lvbkZpZWxkczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRSZWdpb24gPSB0aGlzLmN1cnJlbnRSZWdpb247XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGZpZWxka2V5OiBjdXJyZW50UmVnaW9uLnN1YnN0cigwLCAxKSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy52YWx1ZXNbY3VycmVudFJlZ2lvbi5zdWJzdHIoMSldLFxuICAgICAgICAgICAgICAgIHJlZ2lvbjogY3VycmVudFJlZ2lvblxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSxcblxuICAgICAgICBjaGFuZ2VIaWdobGlnaHQ6IGZ1bmN0aW9uIChoaWdobGlnaHQpIHtcbiAgICAgICAgICAgIHZhciBjdXJyZW50UmVnaW9uID0gdGhpcy5jdXJyZW50UmVnaW9uLFxuICAgICAgICAgICAgICAgIHNoYXBlaWQgPSB0aGlzLnZhbHVlU2hhcGVzW2N1cnJlbnRSZWdpb25dLFxuICAgICAgICAgICAgICAgIHNoYXBlO1xuICAgICAgICAgICAgZGVsZXRlIHRoaXMuc2hhcGVzW3NoYXBlaWRdO1xuICAgICAgICAgICAgc3dpdGNoIChjdXJyZW50UmVnaW9uLnN1YnN0cigwLCAxKSkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ3InOlxuICAgICAgICAgICAgICAgICAgICBzaGFwZSA9IHRoaXMucmVuZGVyUmFuZ2UoY3VycmVudFJlZ2lvbi5zdWJzdHIoMSksIGhpZ2hsaWdodCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ3AnOlxuICAgICAgICAgICAgICAgICAgICBzaGFwZSA9IHRoaXMucmVuZGVyUGVyZm9ybWFuY2UoaGlnaGxpZ2h0KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAndCc6XG4gICAgICAgICAgICAgICAgICAgIHNoYXBlID0gdGhpcy5yZW5kZXJUYXJnZXQoaGlnaGxpZ2h0KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnZhbHVlU2hhcGVzW2N1cnJlbnRSZWdpb25dID0gc2hhcGUuaWQ7XG4gICAgICAgICAgICB0aGlzLnNoYXBlc1tzaGFwZS5pZF0gPSBjdXJyZW50UmVnaW9uO1xuICAgICAgICAgICAgdGhpcy50YXJnZXQucmVwbGFjZVdpdGhTaGFwZShzaGFwZWlkLCBzaGFwZSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVuZGVyUmFuZ2U6IGZ1bmN0aW9uIChybiwgaGlnaGxpZ2h0KSB7XG4gICAgICAgICAgICB2YXIgcmFuZ2V2YWwgPSB0aGlzLnZhbHVlc1tybl0sXG4gICAgICAgICAgICAgICAgcmFuZ2V3aWR0aCA9IE1hdGgucm91bmQodGhpcy5jYW52YXNXaWR0aCAqICgocmFuZ2V2YWwgLSB0aGlzLm1pbikgLyB0aGlzLnJhbmdlKSksXG4gICAgICAgICAgICAgICAgY29sb3IgPSB0aGlzLm9wdGlvbnMuZ2V0KCdyYW5nZUNvbG9ycycpW3JuIC0gMl07XG4gICAgICAgICAgICBpZiAoaGlnaGxpZ2h0KSB7XG4gICAgICAgICAgICAgICAgY29sb3IgPSB0aGlzLmNhbGNIaWdobGlnaHRDb2xvcihjb2xvciwgdGhpcy5vcHRpb25zKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLnRhcmdldC5kcmF3UmVjdCgwLCAwLCByYW5nZXdpZHRoIC0gMSwgdGhpcy5jYW52YXNIZWlnaHQgLSAxLCBjb2xvciwgY29sb3IpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlbmRlclBlcmZvcm1hbmNlOiBmdW5jdGlvbiAoaGlnaGxpZ2h0KSB7XG4gICAgICAgICAgICB2YXIgcGVyZnZhbCA9IHRoaXMudmFsdWVzWzFdLFxuICAgICAgICAgICAgICAgIHBlcmZ3aWR0aCA9IE1hdGgucm91bmQodGhpcy5jYW52YXNXaWR0aCAqICgocGVyZnZhbCAtIHRoaXMubWluKSAvIHRoaXMucmFuZ2UpKSxcbiAgICAgICAgICAgICAgICBjb2xvciA9IHRoaXMub3B0aW9ucy5nZXQoJ3BlcmZvcm1hbmNlQ29sb3InKTtcbiAgICAgICAgICAgIGlmIChoaWdobGlnaHQpIHtcbiAgICAgICAgICAgICAgICBjb2xvciA9IHRoaXMuY2FsY0hpZ2hsaWdodENvbG9yKGNvbG9yLCB0aGlzLm9wdGlvbnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMudGFyZ2V0LmRyYXdSZWN0KDAsIE1hdGgucm91bmQodGhpcy5jYW52YXNIZWlnaHQgKiAwLjMpLCBwZXJmd2lkdGggLSAxLFxuICAgICAgICAgICAgICAgIE1hdGgucm91bmQodGhpcy5jYW52YXNIZWlnaHQgKiAwLjQpIC0gMSwgY29sb3IsIGNvbG9yKTtcbiAgICAgICAgfSxcblxuICAgICAgICByZW5kZXJUYXJnZXQ6IGZ1bmN0aW9uIChoaWdobGlnaHQpIHtcbiAgICAgICAgICAgIHZhciB0YXJnZXR2YWwgPSB0aGlzLnZhbHVlc1swXSxcbiAgICAgICAgICAgICAgICB4ID0gTWF0aC5yb3VuZCh0aGlzLmNhbnZhc1dpZHRoICogKCh0YXJnZXR2YWwgLSB0aGlzLm1pbikgLyB0aGlzLnJhbmdlKSAtICh0aGlzLm9wdGlvbnMuZ2V0KCd0YXJnZXRXaWR0aCcpIC8gMikpLFxuICAgICAgICAgICAgICAgIHRhcmdldHRvcCA9IE1hdGgucm91bmQodGhpcy5jYW52YXNIZWlnaHQgKiAwLjEwKSxcbiAgICAgICAgICAgICAgICB0YXJnZXRoZWlnaHQgPSB0aGlzLmNhbnZhc0hlaWdodCAtICh0YXJnZXR0b3AgKiAyKSxcbiAgICAgICAgICAgICAgICBjb2xvciA9IHRoaXMub3B0aW9ucy5nZXQoJ3RhcmdldENvbG9yJyk7XG4gICAgICAgICAgICBpZiAoaGlnaGxpZ2h0KSB7XG4gICAgICAgICAgICAgICAgY29sb3IgPSB0aGlzLmNhbGNIaWdobGlnaHRDb2xvcihjb2xvciwgdGhpcy5vcHRpb25zKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLnRhcmdldC5kcmF3UmVjdCh4LCB0YXJnZXR0b3AsIHRoaXMub3B0aW9ucy5nZXQoJ3RhcmdldFdpZHRoJykgLSAxLCB0YXJnZXRoZWlnaHQgLSAxLCBjb2xvciwgY29sb3IpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlbmRlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHZsZW4gPSB0aGlzLnZhbHVlcy5sZW5ndGgsXG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0gdGhpcy50YXJnZXQsXG4gICAgICAgICAgICAgICAgaSwgc2hhcGU7XG4gICAgICAgICAgICBpZiAoIWJ1bGxldC5fc3VwZXIucmVuZGVyLmNhbGwodGhpcykpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGkgPSAyOyBpIDwgdmxlbjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgc2hhcGUgPSB0aGlzLnJlbmRlclJhbmdlKGkpLmFwcGVuZCgpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2hhcGVzW3NoYXBlLmlkXSA9ICdyJyArIGk7XG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZVNoYXBlc1sncicgKyBpXSA9IHNoYXBlLmlkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMudmFsdWVzWzFdICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgc2hhcGUgPSB0aGlzLnJlbmRlclBlcmZvcm1hbmNlKCkuYXBwZW5kKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zaGFwZXNbc2hhcGUuaWRdID0gJ3AxJztcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlU2hhcGVzLnAxID0gc2hhcGUuaWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy52YWx1ZXNbMF0gIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBzaGFwZSA9IHRoaXMucmVuZGVyVGFyZ2V0KCkuYXBwZW5kKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zaGFwZXNbc2hhcGUuaWRdID0gJ3QwJztcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlU2hhcGVzLnQwID0gc2hhcGUuaWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0YXJnZXQucmVuZGVyKCk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFBpZSBjaGFydHNcbiAgICAgKi9cbiAgICAkLmZuLnNwYXJrbGluZS5waWUgPSBwaWUgPSBjcmVhdGVDbGFzcygkLmZuLnNwYXJrbGluZS5fYmFzZSwge1xuICAgICAgICB0eXBlOiAncGllJyxcblxuICAgICAgICBpbml0OiBmdW5jdGlvbiAoZWwsIHZhbHVlcywgb3B0aW9ucywgd2lkdGgsIGhlaWdodCkge1xuICAgICAgICAgICAgdmFyIHRvdGFsID0gMCwgaTtcblxuICAgICAgICAgICAgcGllLl9zdXBlci5pbml0LmNhbGwodGhpcywgZWwsIHZhbHVlcywgb3B0aW9ucywgd2lkdGgsIGhlaWdodCk7XG5cbiAgICAgICAgICAgIHRoaXMuc2hhcGVzID0ge307IC8vIG1hcCBzaGFwZSBpZHMgdG8gdmFsdWUgb2Zmc2V0c1xuICAgICAgICAgICAgdGhpcy52YWx1ZVNoYXBlcyA9IHt9OyAvLyBtYXBzIHZhbHVlIG9mZnNldHMgdG8gc2hhcGUgaWRzXG4gICAgICAgICAgICB0aGlzLnZhbHVlcyA9IHZhbHVlcyA9ICQubWFwKHZhbHVlcywgTnVtYmVyKTtcblxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuZ2V0KCd3aWR0aCcpID09PSAnYXV0bycpIHtcbiAgICAgICAgICAgICAgICB0aGlzLndpZHRoID0gdGhpcy5oZWlnaHQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh2YWx1ZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGZvciAoaSA9IHZhbHVlcy5sZW5ndGg7IGktLTspIHtcbiAgICAgICAgICAgICAgICAgICAgdG90YWwgKz0gdmFsdWVzW2ldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMudG90YWwgPSB0b3RhbDtcbiAgICAgICAgICAgIHRoaXMuaW5pdFRhcmdldCgpO1xuICAgICAgICAgICAgdGhpcy5yYWRpdXMgPSBNYXRoLmZsb29yKE1hdGgubWluKHRoaXMuY2FudmFzV2lkdGgsIHRoaXMuY2FudmFzSGVpZ2h0KSAvIDIpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGdldFJlZ2lvbjogZnVuY3Rpb24gKGVsLCB4LCB5KSB7XG4gICAgICAgICAgICB2YXIgc2hhcGVpZCA9IHRoaXMudGFyZ2V0LmdldFNoYXBlQXQoZWwsIHgsIHkpO1xuICAgICAgICAgICAgcmV0dXJuIChzaGFwZWlkICE9PSB1bmRlZmluZWQgJiYgdGhpcy5zaGFwZXNbc2hhcGVpZF0gIT09IHVuZGVmaW5lZCkgPyB0aGlzLnNoYXBlc1tzaGFwZWlkXSA6IHVuZGVmaW5lZDtcbiAgICAgICAgfSxcblxuICAgICAgICBnZXRDdXJyZW50UmVnaW9uRmllbGRzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgY3VycmVudFJlZ2lvbiA9IHRoaXMuY3VycmVudFJlZ2lvbjtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgaXNOdWxsOiB0aGlzLnZhbHVlc1tjdXJyZW50UmVnaW9uXSA9PT0gdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIHZhbHVlOiB0aGlzLnZhbHVlc1tjdXJyZW50UmVnaW9uXSxcbiAgICAgICAgICAgICAgICBwZXJjZW50OiB0aGlzLnZhbHVlc1tjdXJyZW50UmVnaW9uXSAvIHRoaXMudG90YWwgKiAxMDAsXG4gICAgICAgICAgICAgICAgY29sb3I6IHRoaXMub3B0aW9ucy5nZXQoJ3NsaWNlQ29sb3JzJylbY3VycmVudFJlZ2lvbiAlIHRoaXMub3B0aW9ucy5nZXQoJ3NsaWNlQ29sb3JzJykubGVuZ3RoXSxcbiAgICAgICAgICAgICAgICBvZmZzZXQ6IGN1cnJlbnRSZWdpb25cbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG5cbiAgICAgICAgY2hhbmdlSGlnaGxpZ2h0OiBmdW5jdGlvbiAoaGlnaGxpZ2h0KSB7XG4gICAgICAgICAgICB2YXIgY3VycmVudFJlZ2lvbiA9IHRoaXMuY3VycmVudFJlZ2lvbixcbiAgICAgICAgICAgICAgICAgbmV3c2xpY2UgPSB0aGlzLnJlbmRlclNsaWNlKGN1cnJlbnRSZWdpb24sIGhpZ2hsaWdodCksXG4gICAgICAgICAgICAgICAgIHNoYXBlaWQgPSB0aGlzLnZhbHVlU2hhcGVzW2N1cnJlbnRSZWdpb25dO1xuICAgICAgICAgICAgZGVsZXRlIHRoaXMuc2hhcGVzW3NoYXBlaWRdO1xuICAgICAgICAgICAgdGhpcy50YXJnZXQucmVwbGFjZVdpdGhTaGFwZShzaGFwZWlkLCBuZXdzbGljZSk7XG4gICAgICAgICAgICB0aGlzLnZhbHVlU2hhcGVzW2N1cnJlbnRSZWdpb25dID0gbmV3c2xpY2UuaWQ7XG4gICAgICAgICAgICB0aGlzLnNoYXBlc1tuZXdzbGljZS5pZF0gPSBjdXJyZW50UmVnaW9uO1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlbmRlclNsaWNlOiBmdW5jdGlvbiAodmFsdWVudW0sIGhpZ2hsaWdodCkge1xuICAgICAgICAgICAgdmFyIHRhcmdldCA9IHRoaXMudGFyZ2V0LFxuICAgICAgICAgICAgICAgIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnMsXG4gICAgICAgICAgICAgICAgcmFkaXVzID0gdGhpcy5yYWRpdXMsXG4gICAgICAgICAgICAgICAgYm9yZGVyV2lkdGggPSBvcHRpb25zLmdldCgnYm9yZGVyV2lkdGgnKSxcbiAgICAgICAgICAgICAgICBvZmZzZXQgPSBvcHRpb25zLmdldCgnb2Zmc2V0JyksXG4gICAgICAgICAgICAgICAgY2lyY2xlID0gMiAqIE1hdGguUEksXG4gICAgICAgICAgICAgICAgdmFsdWVzID0gdGhpcy52YWx1ZXMsXG4gICAgICAgICAgICAgICAgdG90YWwgPSB0aGlzLnRvdGFsLFxuICAgICAgICAgICAgICAgIG5leHQgPSBvZmZzZXQgPyAoMipNYXRoLlBJKSoob2Zmc2V0LzM2MCkgOiAwLFxuICAgICAgICAgICAgICAgIHN0YXJ0LCBlbmQsIGksIHZsZW4sIGNvbG9yO1xuXG4gICAgICAgICAgICB2bGVuID0gdmFsdWVzLmxlbmd0aDtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCB2bGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgICBzdGFydCA9IG5leHQ7XG4gICAgICAgICAgICAgICAgZW5kID0gbmV4dDtcbiAgICAgICAgICAgICAgICBpZiAodG90YWwgPiAwKSB7ICAvLyBhdm9pZCBkaXZpZGUgYnkgemVyb1xuICAgICAgICAgICAgICAgICAgICBlbmQgPSBuZXh0ICsgKGNpcmNsZSAqICh2YWx1ZXNbaV0gLyB0b3RhbCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodmFsdWVudW0gPT09IGkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29sb3IgPSBvcHRpb25zLmdldCgnc2xpY2VDb2xvcnMnKVtpICUgb3B0aW9ucy5nZXQoJ3NsaWNlQ29sb3JzJykubGVuZ3RoXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGhpZ2hsaWdodCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29sb3IgPSB0aGlzLmNhbGNIaWdobGlnaHRDb2xvcihjb2xvciwgb3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGFyZ2V0LmRyYXdQaWVTbGljZShyYWRpdXMsIHJhZGl1cywgcmFkaXVzIC0gYm9yZGVyV2lkdGgsIHN0YXJ0LCBlbmQsIHVuZGVmaW5lZCwgY29sb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBuZXh0ID0gZW5kO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIHJlbmRlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHRhcmdldCA9IHRoaXMudGFyZ2V0LFxuICAgICAgICAgICAgICAgIHZhbHVlcyA9IHRoaXMudmFsdWVzLFxuICAgICAgICAgICAgICAgIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnMsXG4gICAgICAgICAgICAgICAgcmFkaXVzID0gdGhpcy5yYWRpdXMsXG4gICAgICAgICAgICAgICAgYm9yZGVyV2lkdGggPSBvcHRpb25zLmdldCgnYm9yZGVyV2lkdGgnKSxcbiAgICAgICAgICAgICAgICBzaGFwZSwgaTtcblxuICAgICAgICAgICAgaWYgKCFwaWUuX3N1cGVyLnJlbmRlci5jYWxsKHRoaXMpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGJvcmRlcldpZHRoKSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0LmRyYXdDaXJjbGUocmFkaXVzLCByYWRpdXMsIE1hdGguZmxvb3IocmFkaXVzIC0gKGJvcmRlcldpZHRoIC8gMikpLFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmdldCgnYm9yZGVyQ29sb3InKSwgdW5kZWZpbmVkLCBib3JkZXJXaWR0aCkuYXBwZW5kKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGkgPSB2YWx1ZXMubGVuZ3RoOyBpLS07KSB7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlc1tpXSkgeyAvLyBkb24ndCByZW5kZXIgemVybyB2YWx1ZXNcbiAgICAgICAgICAgICAgICAgICAgc2hhcGUgPSB0aGlzLnJlbmRlclNsaWNlKGkpLmFwcGVuZCgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnZhbHVlU2hhcGVzW2ldID0gc2hhcGUuaWQ7IC8vIHN0b3JlIGp1c3QgdGhlIHNoYXBlaWRcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaGFwZXNbc2hhcGUuaWRdID0gaTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0YXJnZXQucmVuZGVyKCk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIEJveCBwbG90c1xuICAgICAqL1xuICAgICQuZm4uc3BhcmtsaW5lLmJveCA9IGJveCA9IGNyZWF0ZUNsYXNzKCQuZm4uc3BhcmtsaW5lLl9iYXNlLCB7XG4gICAgICAgIHR5cGU6ICdib3gnLFxuXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uIChlbCwgdmFsdWVzLCBvcHRpb25zLCB3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICAgICAgICBib3guX3N1cGVyLmluaXQuY2FsbCh0aGlzLCBlbCwgdmFsdWVzLCBvcHRpb25zLCB3aWR0aCwgaGVpZ2h0KTtcbiAgICAgICAgICAgIHRoaXMudmFsdWVzID0gJC5tYXAodmFsdWVzLCBOdW1iZXIpO1xuICAgICAgICAgICAgdGhpcy53aWR0aCA9IG9wdGlvbnMuZ2V0KCd3aWR0aCcpID09PSAnYXV0bycgPyAnNC4wZW0nIDogd2lkdGg7XG4gICAgICAgICAgICB0aGlzLmluaXRUYXJnZXQoKTtcbiAgICAgICAgICAgIGlmICghdGhpcy52YWx1ZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kaXNhYmxlZCA9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNpbXVsYXRlIGEgc2luZ2xlIHJlZ2lvblxuICAgICAgICAgKi9cbiAgICAgICAgZ2V0UmVnaW9uOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgfSxcblxuICAgICAgICBnZXRDdXJyZW50UmVnaW9uRmllbGRzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gW1xuICAgICAgICAgICAgICAgIHsgZmllbGQ6ICdscScsIHZhbHVlOiB0aGlzLnF1YXJ0aWxlc1swXSB9LFxuICAgICAgICAgICAgICAgIHsgZmllbGQ6ICdtZWQnLCB2YWx1ZTogdGhpcy5xdWFydGlsZXNbMV0gfSxcbiAgICAgICAgICAgICAgICB7IGZpZWxkOiAndXEnLCB2YWx1ZTogdGhpcy5xdWFydGlsZXNbMl0gfVxuICAgICAgICAgICAgXTtcbiAgICAgICAgICAgIGlmICh0aGlzLmxvdXRsaWVyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaCh7IGZpZWxkOiAnbG8nLCB2YWx1ZTogdGhpcy5sb3V0bGllcn0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMucm91dGxpZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHsgZmllbGQ6ICdybycsIHZhbHVlOiB0aGlzLnJvdXRsaWVyfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5sd2hpc2tlciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goeyBmaWVsZDogJ2x3JywgdmFsdWU6IHRoaXMubHdoaXNrZXJ9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnJ3aGlza2VyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaCh7IGZpZWxkOiAncncnLCB2YWx1ZTogdGhpcy5yd2hpc2tlcn0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfSxcblxuICAgICAgICByZW5kZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB0YXJnZXQgPSB0aGlzLnRhcmdldCxcbiAgICAgICAgICAgICAgICB2YWx1ZXMgPSB0aGlzLnZhbHVlcyxcbiAgICAgICAgICAgICAgICB2bGVuID0gdmFsdWVzLmxlbmd0aCxcbiAgICAgICAgICAgICAgICBvcHRpb25zID0gdGhpcy5vcHRpb25zLFxuICAgICAgICAgICAgICAgIGNhbnZhc1dpZHRoID0gdGhpcy5jYW52YXNXaWR0aCxcbiAgICAgICAgICAgICAgICBjYW52YXNIZWlnaHQgPSB0aGlzLmNhbnZhc0hlaWdodCxcbiAgICAgICAgICAgICAgICBtaW5WYWx1ZSA9IG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlTWluJykgPT09IHVuZGVmaW5lZCA/IE1hdGgubWluLmFwcGx5KE1hdGgsIHZhbHVlcykgOiBvcHRpb25zLmdldCgnY2hhcnRSYW5nZU1pbicpLFxuICAgICAgICAgICAgICAgIG1heFZhbHVlID0gb3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNYXgnKSA9PT0gdW5kZWZpbmVkID8gTWF0aC5tYXguYXBwbHkoTWF0aCwgdmFsdWVzKSA6IG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlTWF4JyksXG4gICAgICAgICAgICAgICAgY2FudmFzTGVmdCA9IDAsXG4gICAgICAgICAgICAgICAgbHdoaXNrZXIsIGxvdXRsaWVyLCBpcXIsIHExLCBxMiwgcTMsIHJ3aGlza2VyLCByb3V0bGllciwgaSxcbiAgICAgICAgICAgICAgICBzaXplLCB1bml0U2l6ZTtcblxuICAgICAgICAgICAgaWYgKCFib3guX3N1cGVyLnJlbmRlci5jYWxsKHRoaXMpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAob3B0aW9ucy5nZXQoJ3JhdycpKSB7XG4gICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuZ2V0KCdzaG93T3V0bGllcnMnKSAmJiB2YWx1ZXMubGVuZ3RoID4gNSkge1xuICAgICAgICAgICAgICAgICAgICBsb3V0bGllciA9IHZhbHVlc1swXTtcbiAgICAgICAgICAgICAgICAgICAgbHdoaXNrZXIgPSB2YWx1ZXNbMV07XG4gICAgICAgICAgICAgICAgICAgIHExID0gdmFsdWVzWzJdO1xuICAgICAgICAgICAgICAgICAgICBxMiA9IHZhbHVlc1szXTtcbiAgICAgICAgICAgICAgICAgICAgcTMgPSB2YWx1ZXNbNF07XG4gICAgICAgICAgICAgICAgICAgIHJ3aGlza2VyID0gdmFsdWVzWzVdO1xuICAgICAgICAgICAgICAgICAgICByb3V0bGllciA9IHZhbHVlc1s2XTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBsd2hpc2tlciA9IHZhbHVlc1swXTtcbiAgICAgICAgICAgICAgICAgICAgcTEgPSB2YWx1ZXNbMV07XG4gICAgICAgICAgICAgICAgICAgIHEyID0gdmFsdWVzWzJdO1xuICAgICAgICAgICAgICAgICAgICBxMyA9IHZhbHVlc1szXTtcbiAgICAgICAgICAgICAgICAgICAgcndoaXNrZXIgPSB2YWx1ZXNbNF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YWx1ZXMuc29ydChmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gYSAtIGI7IH0pO1xuICAgICAgICAgICAgICAgIHExID0gcXVhcnRpbGUodmFsdWVzLCAxKTtcbiAgICAgICAgICAgICAgICBxMiA9IHF1YXJ0aWxlKHZhbHVlcywgMik7XG4gICAgICAgICAgICAgICAgcTMgPSBxdWFydGlsZSh2YWx1ZXMsIDMpO1xuICAgICAgICAgICAgICAgIGlxciA9IHEzIC0gcTE7XG4gICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuZ2V0KCdzaG93T3V0bGllcnMnKSkge1xuICAgICAgICAgICAgICAgICAgICBsd2hpc2tlciA9IHJ3aGlza2VyID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgdmxlbjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobHdoaXNrZXIgPT09IHVuZGVmaW5lZCAmJiB2YWx1ZXNbaV0gPiBxMSAtIChpcXIgKiBvcHRpb25zLmdldCgnb3V0bGllcklRUicpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGx3aGlza2VyID0gdmFsdWVzW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlc1tpXSA8IHEzICsgKGlxciAqIG9wdGlvbnMuZ2V0KCdvdXRsaWVySVFSJykpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcndoaXNrZXIgPSB2YWx1ZXNbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbG91dGxpZXIgPSB2YWx1ZXNbMF07XG4gICAgICAgICAgICAgICAgICAgIHJvdXRsaWVyID0gdmFsdWVzW3ZsZW4gLSAxXTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBsd2hpc2tlciA9IHZhbHVlc1swXTtcbiAgICAgICAgICAgICAgICAgICAgcndoaXNrZXIgPSB2YWx1ZXNbdmxlbiAtIDFdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucXVhcnRpbGVzID0gW3ExLCBxMiwgcTNdO1xuICAgICAgICAgICAgdGhpcy5sd2hpc2tlciA9IGx3aGlza2VyO1xuICAgICAgICAgICAgdGhpcy5yd2hpc2tlciA9IHJ3aGlza2VyO1xuICAgICAgICAgICAgdGhpcy5sb3V0bGllciA9IGxvdXRsaWVyO1xuICAgICAgICAgICAgdGhpcy5yb3V0bGllciA9IHJvdXRsaWVyO1xuXG4gICAgICAgICAgICB1bml0U2l6ZSA9IGNhbnZhc1dpZHRoIC8gKG1heFZhbHVlIC0gbWluVmFsdWUgKyAxKTtcbiAgICAgICAgICAgIGlmIChvcHRpb25zLmdldCgnc2hvd091dGxpZXJzJykpIHtcbiAgICAgICAgICAgICAgICBjYW52YXNMZWZ0ID0gTWF0aC5jZWlsKG9wdGlvbnMuZ2V0KCdzcG90UmFkaXVzJykpO1xuICAgICAgICAgICAgICAgIGNhbnZhc1dpZHRoIC09IDIgKiBNYXRoLmNlaWwob3B0aW9ucy5nZXQoJ3Nwb3RSYWRpdXMnKSk7XG4gICAgICAgICAgICAgICAgdW5pdFNpemUgPSBjYW52YXNXaWR0aCAvIChtYXhWYWx1ZSAtIG1pblZhbHVlICsgMSk7XG4gICAgICAgICAgICAgICAgaWYgKGxvdXRsaWVyIDwgbHdoaXNrZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LmRyYXdDaXJjbGUoKGxvdXRsaWVyIC0gbWluVmFsdWUpICogdW5pdFNpemUgKyBjYW52YXNMZWZ0LFxuICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzSGVpZ2h0IC8gMixcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZ2V0KCdzcG90UmFkaXVzJyksXG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmdldCgnb3V0bGllckxpbmVDb2xvcicpLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5nZXQoJ291dGxpZXJGaWxsQ29sb3InKSkuYXBwZW5kKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChyb3V0bGllciA+IHJ3aGlza2VyKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldC5kcmF3Q2lyY2xlKChyb3V0bGllciAtIG1pblZhbHVlKSAqIHVuaXRTaXplICsgY2FudmFzTGVmdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbnZhc0hlaWdodCAvIDIsXG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmdldCgnc3BvdFJhZGl1cycpLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5nZXQoJ291dGxpZXJMaW5lQ29sb3InKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZ2V0KCdvdXRsaWVyRmlsbENvbG9yJykpLmFwcGVuZCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gYm94XG4gICAgICAgICAgICB0YXJnZXQuZHJhd1JlY3QoXG4gICAgICAgICAgICAgICAgTWF0aC5yb3VuZCgocTEgLSBtaW5WYWx1ZSkgKiB1bml0U2l6ZSArIGNhbnZhc0xlZnQpLFxuICAgICAgICAgICAgICAgIE1hdGgucm91bmQoY2FudmFzSGVpZ2h0ICogMC4xKSxcbiAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKChxMyAtIHExKSAqIHVuaXRTaXplKSxcbiAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKGNhbnZhc0hlaWdodCAqIDAuOCksXG4gICAgICAgICAgICAgICAgb3B0aW9ucy5nZXQoJ2JveExpbmVDb2xvcicpLFxuICAgICAgICAgICAgICAgIG9wdGlvbnMuZ2V0KCdib3hGaWxsQ29sb3InKSkuYXBwZW5kKCk7XG4gICAgICAgICAgICAvLyBsZWZ0IHdoaXNrZXJcbiAgICAgICAgICAgIHRhcmdldC5kcmF3TGluZShcbiAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKChsd2hpc2tlciAtIG1pblZhbHVlKSAqIHVuaXRTaXplICsgY2FudmFzTGVmdCksXG4gICAgICAgICAgICAgICAgTWF0aC5yb3VuZChjYW52YXNIZWlnaHQgLyAyKSxcbiAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKChxMSAtIG1pblZhbHVlKSAqIHVuaXRTaXplICsgY2FudmFzTGVmdCksXG4gICAgICAgICAgICAgICAgTWF0aC5yb3VuZChjYW52YXNIZWlnaHQgLyAyKSxcbiAgICAgICAgICAgICAgICBvcHRpb25zLmdldCgnbGluZUNvbG9yJykpLmFwcGVuZCgpO1xuICAgICAgICAgICAgdGFyZ2V0LmRyYXdMaW5lKFxuICAgICAgICAgICAgICAgIE1hdGgucm91bmQoKGx3aGlza2VyIC0gbWluVmFsdWUpICogdW5pdFNpemUgKyBjYW52YXNMZWZ0KSxcbiAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKGNhbnZhc0hlaWdodCAvIDQpLFxuICAgICAgICAgICAgICAgIE1hdGgucm91bmQoKGx3aGlza2VyIC0gbWluVmFsdWUpICogdW5pdFNpemUgKyBjYW52YXNMZWZ0KSxcbiAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKGNhbnZhc0hlaWdodCAtIGNhbnZhc0hlaWdodCAvIDQpLFxuICAgICAgICAgICAgICAgIG9wdGlvbnMuZ2V0KCd3aGlza2VyQ29sb3InKSkuYXBwZW5kKCk7XG4gICAgICAgICAgICAvLyByaWdodCB3aGlza2VyXG4gICAgICAgICAgICB0YXJnZXQuZHJhd0xpbmUoTWF0aC5yb3VuZCgocndoaXNrZXIgLSBtaW5WYWx1ZSkgKiB1bml0U2l6ZSArIGNhbnZhc0xlZnQpLFxuICAgICAgICAgICAgICAgIE1hdGgucm91bmQoY2FudmFzSGVpZ2h0IC8gMiksXG4gICAgICAgICAgICAgICAgTWF0aC5yb3VuZCgocTMgLSBtaW5WYWx1ZSkgKiB1bml0U2l6ZSArIGNhbnZhc0xlZnQpLFxuICAgICAgICAgICAgICAgIE1hdGgucm91bmQoY2FudmFzSGVpZ2h0IC8gMiksXG4gICAgICAgICAgICAgICAgb3B0aW9ucy5nZXQoJ2xpbmVDb2xvcicpKS5hcHBlbmQoKTtcbiAgICAgICAgICAgIHRhcmdldC5kcmF3TGluZShcbiAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKChyd2hpc2tlciAtIG1pblZhbHVlKSAqIHVuaXRTaXplICsgY2FudmFzTGVmdCksXG4gICAgICAgICAgICAgICAgTWF0aC5yb3VuZChjYW52YXNIZWlnaHQgLyA0KSxcbiAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKChyd2hpc2tlciAtIG1pblZhbHVlKSAqIHVuaXRTaXplICsgY2FudmFzTGVmdCksXG4gICAgICAgICAgICAgICAgTWF0aC5yb3VuZChjYW52YXNIZWlnaHQgLSBjYW52YXNIZWlnaHQgLyA0KSxcbiAgICAgICAgICAgICAgICBvcHRpb25zLmdldCgnd2hpc2tlckNvbG9yJykpLmFwcGVuZCgpO1xuICAgICAgICAgICAgLy8gbWVkaWFuIGxpbmVcbiAgICAgICAgICAgIHRhcmdldC5kcmF3TGluZShcbiAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKChxMiAtIG1pblZhbHVlKSAqIHVuaXRTaXplICsgY2FudmFzTGVmdCksXG4gICAgICAgICAgICAgICAgTWF0aC5yb3VuZChjYW52YXNIZWlnaHQgKiAwLjEpLFxuICAgICAgICAgICAgICAgIE1hdGgucm91bmQoKHEyIC0gbWluVmFsdWUpICogdW5pdFNpemUgKyBjYW52YXNMZWZ0KSxcbiAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKGNhbnZhc0hlaWdodCAqIDAuOSksXG4gICAgICAgICAgICAgICAgb3B0aW9ucy5nZXQoJ21lZGlhbkNvbG9yJykpLmFwcGVuZCgpO1xuICAgICAgICAgICAgaWYgKG9wdGlvbnMuZ2V0KCd0YXJnZXQnKSkge1xuICAgICAgICAgICAgICAgIHNpemUgPSBNYXRoLmNlaWwob3B0aW9ucy5nZXQoJ3Nwb3RSYWRpdXMnKSk7XG4gICAgICAgICAgICAgICAgdGFyZ2V0LmRyYXdMaW5lKFxuICAgICAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKChvcHRpb25zLmdldCgndGFyZ2V0JykgLSBtaW5WYWx1ZSkgKiB1bml0U2l6ZSArIGNhbnZhc0xlZnQpLFxuICAgICAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKChjYW52YXNIZWlnaHQgLyAyKSAtIHNpemUpLFxuICAgICAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKChvcHRpb25zLmdldCgndGFyZ2V0JykgLSBtaW5WYWx1ZSkgKiB1bml0U2l6ZSArIGNhbnZhc0xlZnQpLFxuICAgICAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKChjYW52YXNIZWlnaHQgLyAyKSArIHNpemUpLFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmdldCgndGFyZ2V0Q29sb3InKSkuYXBwZW5kKCk7XG4gICAgICAgICAgICAgICAgdGFyZ2V0LmRyYXdMaW5lKFxuICAgICAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKChvcHRpb25zLmdldCgndGFyZ2V0JykgLSBtaW5WYWx1ZSkgKiB1bml0U2l6ZSArIGNhbnZhc0xlZnQgLSBzaXplKSxcbiAgICAgICAgICAgICAgICAgICAgTWF0aC5yb3VuZChjYW52YXNIZWlnaHQgLyAyKSxcbiAgICAgICAgICAgICAgICAgICAgTWF0aC5yb3VuZCgob3B0aW9ucy5nZXQoJ3RhcmdldCcpIC0gbWluVmFsdWUpICogdW5pdFNpemUgKyBjYW52YXNMZWZ0ICsgc2l6ZSksXG4gICAgICAgICAgICAgICAgICAgIE1hdGgucm91bmQoY2FudmFzSGVpZ2h0IC8gMiksXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZ2V0KCd0YXJnZXRDb2xvcicpKS5hcHBlbmQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRhcmdldC5yZW5kZXIoKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gU2V0dXAgYSB2ZXJ5IHNpbXBsZSBcInZpcnR1YWwgY2FudmFzXCIgdG8gbWFrZSBkcmF3aW5nIHRoZSBmZXcgc2hhcGVzIHdlIG5lZWQgZWFzaWVyXG4gICAgLy8gVGhpcyBpcyBhY2Nlc3NpYmxlIGFzICQoZm9vKS5zaW1wbGVkcmF3KClcblxuICAgIFZTaGFwZSA9IGNyZWF0ZUNsYXNzKHtcbiAgICAgICAgaW5pdDogZnVuY3Rpb24gKHRhcmdldCwgaWQsIHR5cGUsIGFyZ3MpIHtcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0ID0gdGFyZ2V0O1xuICAgICAgICAgICAgdGhpcy5pZCA9IGlkO1xuICAgICAgICAgICAgdGhpcy50eXBlID0gdHlwZTtcbiAgICAgICAgICAgIHRoaXMuYXJncyA9IGFyZ3M7XG4gICAgICAgIH0sXG4gICAgICAgIGFwcGVuZDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy50YXJnZXQuYXBwZW5kU2hhcGUodGhpcyk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgVkNhbnZhc19iYXNlID0gY3JlYXRlQ2xhc3Moe1xuICAgICAgICBfcHhyZWdleDogLyhcXGQrKShweCk/XFxzKiQvaSxcblxuICAgICAgICBpbml0OiBmdW5jdGlvbiAod2lkdGgsIGhlaWdodCwgdGFyZ2V0KSB7XG4gICAgICAgICAgICBpZiAoIXdpZHRoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoO1xuICAgICAgICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7XG4gICAgICAgICAgICB0aGlzLnRhcmdldCA9IHRhcmdldDtcbiAgICAgICAgICAgIHRoaXMubGFzdFNoYXBlSWQgPSBudWxsO1xuICAgICAgICAgICAgaWYgKHRhcmdldFswXSkge1xuICAgICAgICAgICAgICAgIHRhcmdldCA9IHRhcmdldFswXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICQuZGF0YSh0YXJnZXQsICdfanFzX3ZjYW52YXMnLCB0aGlzKTtcbiAgICAgICAgfSxcblxuICAgICAgICBkcmF3TGluZTogZnVuY3Rpb24gKHgxLCB5MSwgeDIsIHkyLCBsaW5lQ29sb3IsIGxpbmVXaWR0aCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZHJhd1NoYXBlKFtbeDEsIHkxXSwgW3gyLCB5Ml1dLCBsaW5lQ29sb3IsIGxpbmVXaWR0aCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZHJhd1NoYXBlOiBmdW5jdGlvbiAocGF0aCwgbGluZUNvbG9yLCBmaWxsQ29sb3IsIGxpbmVXaWR0aCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dlblNoYXBlKCdTaGFwZScsIFtwYXRoLCBsaW5lQ29sb3IsIGZpbGxDb2xvciwgbGluZVdpZHRoXSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZHJhd0NpcmNsZTogZnVuY3Rpb24gKHgsIHksIHJhZGl1cywgbGluZUNvbG9yLCBmaWxsQ29sb3IsIGxpbmVXaWR0aCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dlblNoYXBlKCdDaXJjbGUnLCBbeCwgeSwgcmFkaXVzLCBsaW5lQ29sb3IsIGZpbGxDb2xvciwgbGluZVdpZHRoXSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZHJhd1BpZVNsaWNlOiBmdW5jdGlvbiAoeCwgeSwgcmFkaXVzLCBzdGFydEFuZ2xlLCBlbmRBbmdsZSwgbGluZUNvbG9yLCBmaWxsQ29sb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9nZW5TaGFwZSgnUGllU2xpY2UnLCBbeCwgeSwgcmFkaXVzLCBzdGFydEFuZ2xlLCBlbmRBbmdsZSwgbGluZUNvbG9yLCBmaWxsQ29sb3JdKTtcbiAgICAgICAgfSxcblxuICAgICAgICBkcmF3UmVjdDogZnVuY3Rpb24gKHgsIHksIHdpZHRoLCBoZWlnaHQsIGxpbmVDb2xvciwgZmlsbENvbG9yKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZ2VuU2hhcGUoJ1JlY3QnLCBbeCwgeSwgd2lkdGgsIGhlaWdodCwgbGluZUNvbG9yLCBmaWxsQ29sb3JdKTtcbiAgICAgICAgfSxcblxuICAgICAgICBnZXRFbGVtZW50OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jYW52YXM7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJldHVybiB0aGUgbW9zdCByZWNlbnRseSBpbnNlcnRlZCBzaGFwZSBpZFxuICAgICAgICAgKi9cbiAgICAgICAgZ2V0TGFzdFNoYXBlSWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmxhc3RTaGFwZUlkO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDbGVhciBhbmQgcmVzZXQgdGhlIGNhbnZhc1xuICAgICAgICAgKi9cbiAgICAgICAgcmVzZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGFsZXJ0KCdyZXNldCBub3QgaW1wbGVtZW50ZWQnKTtcbiAgICAgICAgfSxcblxuICAgICAgICBfaW5zZXJ0OiBmdW5jdGlvbiAoZWwsIHRhcmdldCkge1xuICAgICAgICAgICAgJCh0YXJnZXQpLmh0bWwoZWwpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDYWxjdWxhdGUgdGhlIHBpeGVsIGRpbWVuc2lvbnMgb2YgdGhlIGNhbnZhc1xuICAgICAgICAgKi9cbiAgICAgICAgX2NhbGN1bGF0ZVBpeGVsRGltczogZnVuY3Rpb24gKHdpZHRoLCBoZWlnaHQsIGNhbnZhcykge1xuICAgICAgICAgICAgLy8gWFhYIFRoaXMgc2hvdWxkIHByb2JhYmx5IGJlIGEgY29uZmlndXJhYmxlIG9wdGlvblxuICAgICAgICAgICAgdmFyIG1hdGNoO1xuICAgICAgICAgICAgbWF0Y2ggPSB0aGlzLl9weHJlZ2V4LmV4ZWMoaGVpZ2h0KTtcbiAgICAgICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgICAgICAgIHRoaXMucGl4ZWxIZWlnaHQgPSBtYXRjaFsxXTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5waXhlbEhlaWdodCA9ICQoY2FudmFzKS5oZWlnaHQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG1hdGNoID0gdGhpcy5fcHhyZWdleC5leGVjKHdpZHRoKTtcbiAgICAgICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgICAgICAgIHRoaXMucGl4ZWxXaWR0aCA9IG1hdGNoWzFdO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBpeGVsV2lkdGggPSAkKGNhbnZhcykud2lkdGgoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogR2VuZXJhdGUgYSBzaGFwZSBvYmplY3QgYW5kIGlkIGZvciBsYXRlciByZW5kZXJpbmdcbiAgICAgICAgICovXG4gICAgICAgIF9nZW5TaGFwZTogZnVuY3Rpb24gKHNoYXBldHlwZSwgc2hhcGVhcmdzKSB7XG4gICAgICAgICAgICB2YXIgaWQgPSBzaGFwZUNvdW50Kys7XG4gICAgICAgICAgICBzaGFwZWFyZ3MudW5zaGlmdChpZCk7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFZTaGFwZSh0aGlzLCBpZCwgc2hhcGV0eXBlLCBzaGFwZWFyZ3MpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBZGQgYSBzaGFwZSB0byB0aGUgZW5kIG9mIHRoZSByZW5kZXIgcXVldWVcbiAgICAgICAgICovXG4gICAgICAgIGFwcGVuZFNoYXBlOiBmdW5jdGlvbiAoc2hhcGUpIHtcbiAgICAgICAgICAgIGFsZXJ0KCdhcHBlbmRTaGFwZSBub3QgaW1wbGVtZW50ZWQnKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogUmVwbGFjZSBvbmUgc2hhcGUgd2l0aCBhbm90aGVyXG4gICAgICAgICAqL1xuICAgICAgICByZXBsYWNlV2l0aFNoYXBlOiBmdW5jdGlvbiAoc2hhcGVpZCwgc2hhcGUpIHtcbiAgICAgICAgICAgIGFsZXJ0KCdyZXBsYWNlV2l0aFNoYXBlIG5vdCBpbXBsZW1lbnRlZCcpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJbnNlcnQgb25lIHNoYXBlIGFmdGVyIGFub3RoZXIgaW4gdGhlIHJlbmRlciBxdWV1ZVxuICAgICAgICAgKi9cbiAgICAgICAgaW5zZXJ0QWZ0ZXJTaGFwZTogZnVuY3Rpb24gKHNoYXBlaWQsIHNoYXBlKSB7XG4gICAgICAgICAgICBhbGVydCgnaW5zZXJ0QWZ0ZXJTaGFwZSBub3QgaW1wbGVtZW50ZWQnKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogUmVtb3ZlIGEgc2hhcGUgZnJvbSB0aGUgcXVldWVcbiAgICAgICAgICovXG4gICAgICAgIHJlbW92ZVNoYXBlSWQ6IGZ1bmN0aW9uIChzaGFwZWlkKSB7XG4gICAgICAgICAgICBhbGVydCgncmVtb3ZlU2hhcGVJZCBub3QgaW1wbGVtZW50ZWQnKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogRmluZCBhIHNoYXBlIGF0IHRoZSBzcGVjaWZpZWQgeC95IGNvLW9yZGluYXRlc1xuICAgICAgICAgKi9cbiAgICAgICAgZ2V0U2hhcGVBdDogZnVuY3Rpb24gKGVsLCB4LCB5KSB7XG4gICAgICAgICAgICBhbGVydCgnZ2V0U2hhcGVBdCBub3QgaW1wbGVtZW50ZWQnKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogUmVuZGVyIGFsbCBxdWV1ZWQgc2hhcGVzIG9udG8gdGhlIGNhbnZhc1xuICAgICAgICAgKi9cbiAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBhbGVydCgncmVuZGVyIG5vdCBpbXBsZW1lbnRlZCcpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICBWQ2FudmFzX2NhbnZhcyA9IGNyZWF0ZUNsYXNzKFZDYW52YXNfYmFzZSwge1xuICAgICAgICBpbml0OiBmdW5jdGlvbiAod2lkdGgsIGhlaWdodCwgdGFyZ2V0LCBpbnRlcmFjdCkge1xuICAgICAgICAgICAgVkNhbnZhc19jYW52YXMuX3N1cGVyLmluaXQuY2FsbCh0aGlzLCB3aWR0aCwgaGVpZ2h0LCB0YXJnZXQpO1xuICAgICAgICAgICAgdGhpcy5jYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcbiAgICAgICAgICAgIGlmICh0YXJnZXRbMF0pIHtcbiAgICAgICAgICAgICAgICB0YXJnZXQgPSB0YXJnZXRbMF07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkLmRhdGEodGFyZ2V0LCAnX2pxc192Y2FudmFzJywgdGhpcyk7XG4gICAgICAgICAgICAkKHRoaXMuY2FudmFzKS5jc3MoeyBkaXNwbGF5OiAnaW5saW5lLWJsb2NrJywgd2lkdGg6IHdpZHRoLCBoZWlnaHQ6IGhlaWdodCwgdmVydGljYWxBbGlnbjogJ3RvcCcgfSk7XG4gICAgICAgICAgICB0aGlzLl9pbnNlcnQodGhpcy5jYW52YXMsIHRhcmdldCk7XG4gICAgICAgICAgICB0aGlzLl9jYWxjdWxhdGVQaXhlbERpbXMod2lkdGgsIGhlaWdodCwgdGhpcy5jYW52YXMpO1xuICAgICAgICAgICAgdGhpcy5jYW52YXMud2lkdGggPSB0aGlzLnBpeGVsV2lkdGg7XG4gICAgICAgICAgICB0aGlzLmNhbnZhcy5oZWlnaHQgPSB0aGlzLnBpeGVsSGVpZ2h0O1xuICAgICAgICAgICAgdGhpcy5pbnRlcmFjdCA9IGludGVyYWN0O1xuICAgICAgICAgICAgdGhpcy5zaGFwZXMgPSB7fTtcbiAgICAgICAgICAgIHRoaXMuc2hhcGVzZXEgPSBbXTtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFRhcmdldFNoYXBlSWQgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAkKHRoaXMuY2FudmFzKS5jc3Moe3dpZHRoOiB0aGlzLnBpeGVsV2lkdGgsIGhlaWdodDogdGhpcy5waXhlbEhlaWdodH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIF9nZXRDb250ZXh0OiBmdW5jdGlvbiAobGluZUNvbG9yLCBmaWxsQ29sb3IsIGxpbmVXaWR0aCkge1xuICAgICAgICAgICAgdmFyIGNvbnRleHQgPSB0aGlzLmNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuICAgICAgICAgICAgaWYgKGxpbmVDb2xvciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgY29udGV4dC5zdHJva2VTdHlsZSA9IGxpbmVDb2xvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnRleHQubGluZVdpZHRoID0gbGluZVdpZHRoID09PSB1bmRlZmluZWQgPyAxIDogbGluZVdpZHRoO1xuICAgICAgICAgICAgaWYgKGZpbGxDb2xvciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgY29udGV4dC5maWxsU3R5bGUgPSBmaWxsQ29sb3I7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY29udGV4dDtcbiAgICAgICAgfSxcblxuICAgICAgICByZXNldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGNvbnRleHQgPSB0aGlzLl9nZXRDb250ZXh0KCk7XG4gICAgICAgICAgICBjb250ZXh0LmNsZWFyUmVjdCgwLCAwLCB0aGlzLnBpeGVsV2lkdGgsIHRoaXMucGl4ZWxIZWlnaHQpO1xuICAgICAgICAgICAgdGhpcy5zaGFwZXMgPSB7fTtcbiAgICAgICAgICAgIHRoaXMuc2hhcGVzZXEgPSBbXTtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFRhcmdldFNoYXBlSWQgPSB1bmRlZmluZWQ7XG4gICAgICAgIH0sXG5cbiAgICAgICAgX2RyYXdTaGFwZTogZnVuY3Rpb24gKHNoYXBlaWQsIHBhdGgsIGxpbmVDb2xvciwgZmlsbENvbG9yLCBsaW5lV2lkdGgpIHtcbiAgICAgICAgICAgIHZhciBjb250ZXh0ID0gdGhpcy5fZ2V0Q29udGV4dChsaW5lQ29sb3IsIGZpbGxDb2xvciwgbGluZVdpZHRoKSxcbiAgICAgICAgICAgICAgICBpLCBwbGVuO1xuICAgICAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKTtcbiAgICAgICAgICAgIGNvbnRleHQubW92ZVRvKHBhdGhbMF1bMF0gKyAwLjUsIHBhdGhbMF1bMV0gKyAwLjUpO1xuICAgICAgICAgICAgZm9yIChpID0gMSwgcGxlbiA9IHBhdGgubGVuZ3RoOyBpIDwgcGxlbjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgY29udGV4dC5saW5lVG8ocGF0aFtpXVswXSArIDAuNSwgcGF0aFtpXVsxXSArIDAuNSk7IC8vIHRoZSAwLjUgb2Zmc2V0IGdpdmVzIHVzIGNyaXNwIHBpeGVsLXdpZHRoIGxpbmVzXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobGluZUNvbG9yICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0LnN0cm9rZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGZpbGxDb2xvciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgY29udGV4dC5maWxsKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy50YXJnZXRYICE9PSB1bmRlZmluZWQgJiYgdGhpcy50YXJnZXRZICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgICAgICBjb250ZXh0LmlzUG9pbnRJblBhdGgodGhpcy50YXJnZXRYLCB0aGlzLnRhcmdldFkpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50VGFyZ2V0U2hhcGVJZCA9IHNoYXBlaWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgX2RyYXdDaXJjbGU6IGZ1bmN0aW9uIChzaGFwZWlkLCB4LCB5LCByYWRpdXMsIGxpbmVDb2xvciwgZmlsbENvbG9yLCBsaW5lV2lkdGgpIHtcbiAgICAgICAgICAgIHZhciBjb250ZXh0ID0gdGhpcy5fZ2V0Q29udGV4dChsaW5lQ29sb3IsIGZpbGxDb2xvciwgbGluZVdpZHRoKTtcbiAgICAgICAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICBjb250ZXh0LmFyYyh4LCB5LCByYWRpdXMsIDAsIDIgKiBNYXRoLlBJLCBmYWxzZSk7XG4gICAgICAgICAgICBpZiAodGhpcy50YXJnZXRYICE9PSB1bmRlZmluZWQgJiYgdGhpcy50YXJnZXRZICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgICAgICBjb250ZXh0LmlzUG9pbnRJblBhdGgodGhpcy50YXJnZXRYLCB0aGlzLnRhcmdldFkpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50VGFyZ2V0U2hhcGVJZCA9IHNoYXBlaWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobGluZUNvbG9yICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0LnN0cm9rZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGZpbGxDb2xvciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgY29udGV4dC5maWxsKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgX2RyYXdQaWVTbGljZTogZnVuY3Rpb24gKHNoYXBlaWQsIHgsIHksIHJhZGl1cywgc3RhcnRBbmdsZSwgZW5kQW5nbGUsIGxpbmVDb2xvciwgZmlsbENvbG9yKSB7XG4gICAgICAgICAgICB2YXIgY29udGV4dCA9IHRoaXMuX2dldENvbnRleHQobGluZUNvbG9yLCBmaWxsQ29sb3IpO1xuICAgICAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKTtcbiAgICAgICAgICAgIGNvbnRleHQubW92ZVRvKHgsIHkpO1xuICAgICAgICAgICAgY29udGV4dC5hcmMoeCwgeSwgcmFkaXVzLCBzdGFydEFuZ2xlLCBlbmRBbmdsZSwgZmFsc2UpO1xuICAgICAgICAgICAgY29udGV4dC5saW5lVG8oeCwgeSk7XG4gICAgICAgICAgICBjb250ZXh0LmNsb3NlUGF0aCgpO1xuICAgICAgICAgICAgaWYgKGxpbmVDb2xvciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgY29udGV4dC5zdHJva2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChmaWxsQ29sb3IpIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0LmZpbGwoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnRhcmdldFggIT09IHVuZGVmaW5lZCAmJiB0aGlzLnRhcmdldFkgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgIGNvbnRleHQuaXNQb2ludEluUGF0aCh0aGlzLnRhcmdldFgsIHRoaXMudGFyZ2V0WSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRUYXJnZXRTaGFwZUlkID0gc2hhcGVpZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBfZHJhd1JlY3Q6IGZ1bmN0aW9uIChzaGFwZWlkLCB4LCB5LCB3aWR0aCwgaGVpZ2h0LCBsaW5lQ29sb3IsIGZpbGxDb2xvcikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2RyYXdTaGFwZShzaGFwZWlkLCBbW3gsIHldLCBbeCArIHdpZHRoLCB5XSwgW3ggKyB3aWR0aCwgeSArIGhlaWdodF0sIFt4LCB5ICsgaGVpZ2h0XSwgW3gsIHldXSwgbGluZUNvbG9yLCBmaWxsQ29sb3IpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGFwcGVuZFNoYXBlOiBmdW5jdGlvbiAoc2hhcGUpIHtcbiAgICAgICAgICAgIHRoaXMuc2hhcGVzW3NoYXBlLmlkXSA9IHNoYXBlO1xuICAgICAgICAgICAgdGhpcy5zaGFwZXNlcS5wdXNoKHNoYXBlLmlkKTtcbiAgICAgICAgICAgIHRoaXMubGFzdFNoYXBlSWQgPSBzaGFwZS5pZDtcbiAgICAgICAgICAgIHJldHVybiBzaGFwZS5pZDtcbiAgICAgICAgfSxcblxuICAgICAgICByZXBsYWNlV2l0aFNoYXBlOiBmdW5jdGlvbiAoc2hhcGVpZCwgc2hhcGUpIHtcbiAgICAgICAgICAgIHZhciBzaGFwZXNlcSA9IHRoaXMuc2hhcGVzZXEsXG4gICAgICAgICAgICAgICAgaTtcbiAgICAgICAgICAgIHRoaXMuc2hhcGVzW3NoYXBlLmlkXSA9IHNoYXBlO1xuICAgICAgICAgICAgZm9yIChpID0gc2hhcGVzZXEubGVuZ3RoOyBpLS07KSB7XG4gICAgICAgICAgICAgICAgaWYgKHNoYXBlc2VxW2ldID09IHNoYXBlaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc2hhcGVzZXFbaV0gPSBzaGFwZS5pZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkZWxldGUgdGhpcy5zaGFwZXNbc2hhcGVpZF07XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVwbGFjZVdpdGhTaGFwZXM6IGZ1bmN0aW9uIChzaGFwZWlkcywgc2hhcGVzKSB7XG4gICAgICAgICAgICB2YXIgc2hhcGVzZXEgPSB0aGlzLnNoYXBlc2VxLFxuICAgICAgICAgICAgICAgIHNoYXBlbWFwID0ge30sXG4gICAgICAgICAgICAgICAgc2lkLCBpLCBmaXJzdDtcblxuICAgICAgICAgICAgZm9yIChpID0gc2hhcGVpZHMubGVuZ3RoOyBpLS07KSB7XG4gICAgICAgICAgICAgICAgc2hhcGVtYXBbc2hhcGVpZHNbaV1dID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAoaSA9IHNoYXBlc2VxLmxlbmd0aDsgaS0tOykge1xuICAgICAgICAgICAgICAgIHNpZCA9IHNoYXBlc2VxW2ldO1xuICAgICAgICAgICAgICAgIGlmIChzaGFwZW1hcFtzaWRdKSB7XG4gICAgICAgICAgICAgICAgICAgIHNoYXBlc2VxLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuc2hhcGVzW3NpZF07XG4gICAgICAgICAgICAgICAgICAgIGZpcnN0ID0gaTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGkgPSBzaGFwZXMubGVuZ3RoOyBpLS07KSB7XG4gICAgICAgICAgICAgICAgc2hhcGVzZXEuc3BsaWNlKGZpcnN0LCAwLCBzaGFwZXNbaV0uaWQpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2hhcGVzW3NoYXBlc1tpXS5pZF0gPSBzaGFwZXNbaV07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSxcblxuICAgICAgICBpbnNlcnRBZnRlclNoYXBlOiBmdW5jdGlvbiAoc2hhcGVpZCwgc2hhcGUpIHtcbiAgICAgICAgICAgIHZhciBzaGFwZXNlcSA9IHRoaXMuc2hhcGVzZXEsXG4gICAgICAgICAgICAgICAgaTtcbiAgICAgICAgICAgIGZvciAoaSA9IHNoYXBlc2VxLmxlbmd0aDsgaS0tOykge1xuICAgICAgICAgICAgICAgIGlmIChzaGFwZXNlcVtpXSA9PT0gc2hhcGVpZCkge1xuICAgICAgICAgICAgICAgICAgICBzaGFwZXNlcS5zcGxpY2UoaSArIDEsIDAsIHNoYXBlLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaGFwZXNbc2hhcGUuaWRdID0gc2hhcGU7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVtb3ZlU2hhcGVJZDogZnVuY3Rpb24gKHNoYXBlaWQpIHtcbiAgICAgICAgICAgIHZhciBzaGFwZXNlcSA9IHRoaXMuc2hhcGVzZXEsXG4gICAgICAgICAgICAgICAgaTtcbiAgICAgICAgICAgIGZvciAoaSA9IHNoYXBlc2VxLmxlbmd0aDsgaS0tOykge1xuICAgICAgICAgICAgICAgIGlmIChzaGFwZXNlcVtpXSA9PT0gc2hhcGVpZCkge1xuICAgICAgICAgICAgICAgICAgICBzaGFwZXNlcS5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRlbGV0ZSB0aGlzLnNoYXBlc1tzaGFwZWlkXTtcbiAgICAgICAgfSxcblxuICAgICAgICBnZXRTaGFwZUF0OiBmdW5jdGlvbiAoZWwsIHgsIHkpIHtcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0WCA9IHg7XG4gICAgICAgICAgICB0aGlzLnRhcmdldFkgPSB5O1xuICAgICAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRUYXJnZXRTaGFwZUlkO1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlbmRlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHNoYXBlc2VxID0gdGhpcy5zaGFwZXNlcSxcbiAgICAgICAgICAgICAgICBzaGFwZXMgPSB0aGlzLnNoYXBlcyxcbiAgICAgICAgICAgICAgICBzaGFwZUNvdW50ID0gc2hhcGVzZXEubGVuZ3RoLFxuICAgICAgICAgICAgICAgIGNvbnRleHQgPSB0aGlzLl9nZXRDb250ZXh0KCksXG4gICAgICAgICAgICAgICAgc2hhcGVpZCwgc2hhcGUsIGk7XG4gICAgICAgICAgICBjb250ZXh0LmNsZWFyUmVjdCgwLCAwLCB0aGlzLnBpeGVsV2lkdGgsIHRoaXMucGl4ZWxIZWlnaHQpO1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHNoYXBlQ291bnQ7IGkrKykge1xuICAgICAgICAgICAgICAgIHNoYXBlaWQgPSBzaGFwZXNlcVtpXTtcbiAgICAgICAgICAgICAgICBzaGFwZSA9IHNoYXBlc1tzaGFwZWlkXTtcbiAgICAgICAgICAgICAgICB0aGlzWydfZHJhdycgKyBzaGFwZS50eXBlXS5hcHBseSh0aGlzLCBzaGFwZS5hcmdzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghdGhpcy5pbnRlcmFjdCkge1xuICAgICAgICAgICAgICAgIC8vIG5vdCBpbnRlcmFjdGl2ZSBzbyBubyBuZWVkIHRvIGtlZXAgdGhlIHNoYXBlcyBhcnJheVxuICAgICAgICAgICAgICAgIHRoaXMuc2hhcGVzID0ge307XG4gICAgICAgICAgICAgICAgdGhpcy5zaGFwZXNlcSA9IFtdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICB9KTtcblxuICAgIFZDYW52YXNfdm1sID0gY3JlYXRlQ2xhc3MoVkNhbnZhc19iYXNlLCB7XG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uICh3aWR0aCwgaGVpZ2h0LCB0YXJnZXQpIHtcbiAgICAgICAgICAgIHZhciBncm91cGVsO1xuICAgICAgICAgICAgVkNhbnZhc192bWwuX3N1cGVyLmluaXQuY2FsbCh0aGlzLCB3aWR0aCwgaGVpZ2h0LCB0YXJnZXQpO1xuICAgICAgICAgICAgaWYgKHRhcmdldFswXSkge1xuICAgICAgICAgICAgICAgIHRhcmdldCA9IHRhcmdldFswXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICQuZGF0YSh0YXJnZXQsICdfanFzX3ZjYW52YXMnLCB0aGlzKTtcbiAgICAgICAgICAgIHRoaXMuY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgICAgICAgICAgJCh0aGlzLmNhbnZhcykuY3NzKHsgZGlzcGxheTogJ2lubGluZS1ibG9jaycsIHBvc2l0aW9uOiAncmVsYXRpdmUnLCBvdmVyZmxvdzogJ2hpZGRlbicsIHdpZHRoOiB3aWR0aCwgaGVpZ2h0OiBoZWlnaHQsIG1hcmdpbjogJzBweCcsIHBhZGRpbmc6ICcwcHgnLCB2ZXJ0aWNhbEFsaWduOiAndG9wJ30pO1xuICAgICAgICAgICAgdGhpcy5faW5zZXJ0KHRoaXMuY2FudmFzLCB0YXJnZXQpO1xuICAgICAgICAgICAgdGhpcy5fY2FsY3VsYXRlUGl4ZWxEaW1zKHdpZHRoLCBoZWlnaHQsIHRoaXMuY2FudmFzKTtcbiAgICAgICAgICAgIHRoaXMuY2FudmFzLndpZHRoID0gdGhpcy5waXhlbFdpZHRoO1xuICAgICAgICAgICAgdGhpcy5jYW52YXMuaGVpZ2h0ID0gdGhpcy5waXhlbEhlaWdodDtcbiAgICAgICAgICAgIGdyb3VwZWwgPSAnPHY6Z3JvdXAgY29vcmRvcmlnaW49XCIwIDBcIiBjb29yZHNpemU9XCInICsgdGhpcy5waXhlbFdpZHRoICsgJyAnICsgdGhpcy5waXhlbEhlaWdodCArICdcIicgK1xuICAgICAgICAgICAgICAgICAgICAnIHN0eWxlPVwicG9zaXRpb246YWJzb2x1dGU7dG9wOjA7bGVmdDowO3dpZHRoOicgKyB0aGlzLnBpeGVsV2lkdGggKyAncHg7aGVpZ2h0PScgKyB0aGlzLnBpeGVsSGVpZ2h0ICsgJ3B4O1wiPjwvdjpncm91cD4nO1xuICAgICAgICAgICAgdGhpcy5jYW52YXMuaW5zZXJ0QWRqYWNlbnRIVE1MKCdiZWZvcmVFbmQnLCBncm91cGVsKTtcbiAgICAgICAgICAgIHRoaXMuZ3JvdXAgPSAkKHRoaXMuY2FudmFzKS5jaGlsZHJlbigpWzBdO1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJlZCA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5wcmVyZW5kZXIgPSAnJztcbiAgICAgICAgfSxcblxuICAgICAgICBfZHJhd1NoYXBlOiBmdW5jdGlvbiAoc2hhcGVpZCwgcGF0aCwgbGluZUNvbG9yLCBmaWxsQ29sb3IsIGxpbmVXaWR0aCkge1xuICAgICAgICAgICAgdmFyIHZwYXRoID0gW10sXG4gICAgICAgICAgICAgICAgaW5pdGlhbCwgc3Ryb2tlLCBmaWxsLCBjbG9zZWQsIHZlbCwgcGxlbiwgaTtcbiAgICAgICAgICAgIGZvciAoaSA9IDAsIHBsZW4gPSBwYXRoLmxlbmd0aDsgaSA8IHBsZW47IGkrKykge1xuICAgICAgICAgICAgICAgIHZwYXRoW2ldID0gJycgKyAocGF0aFtpXVswXSkgKyAnLCcgKyAocGF0aFtpXVsxXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpbml0aWFsID0gdnBhdGguc3BsaWNlKDAsIDEpO1xuICAgICAgICAgICAgbGluZVdpZHRoID0gbGluZVdpZHRoID09PSB1bmRlZmluZWQgPyAxIDogbGluZVdpZHRoO1xuICAgICAgICAgICAgc3Ryb2tlID0gbGluZUNvbG9yID09PSB1bmRlZmluZWQgPyAnIHN0cm9rZWQ9XCJmYWxzZVwiICcgOiAnIHN0cm9rZVdlaWdodD1cIicgKyBsaW5lV2lkdGggKyAncHhcIiBzdHJva2VDb2xvcj1cIicgKyBsaW5lQ29sb3IgKyAnXCIgJztcbiAgICAgICAgICAgIGZpbGwgPSBmaWxsQ29sb3IgPT09IHVuZGVmaW5lZCA/ICcgZmlsbGVkPVwiZmFsc2VcIicgOiAnIGZpbGxDb2xvcj1cIicgKyBmaWxsQ29sb3IgKyAnXCIgZmlsbGVkPVwidHJ1ZVwiICc7XG4gICAgICAgICAgICBjbG9zZWQgPSB2cGF0aFswXSA9PT0gdnBhdGhbdnBhdGgubGVuZ3RoIC0gMV0gPyAneCAnIDogJyc7XG4gICAgICAgICAgICB2ZWwgPSAnPHY6c2hhcGUgY29vcmRvcmlnaW49XCIwIDBcIiBjb29yZHNpemU9XCInICsgdGhpcy5waXhlbFdpZHRoICsgJyAnICsgdGhpcy5waXhlbEhlaWdodCArICdcIiAnICtcbiAgICAgICAgICAgICAgICAgJyBpZD1cImpxc3NoYXBlJyArIHNoYXBlaWQgKyAnXCIgJyArXG4gICAgICAgICAgICAgICAgIHN0cm9rZSArXG4gICAgICAgICAgICAgICAgIGZpbGwgK1xuICAgICAgICAgICAgICAgICcgc3R5bGU9XCJwb3NpdGlvbjphYnNvbHV0ZTtsZWZ0OjBweDt0b3A6MHB4O2hlaWdodDonICsgdGhpcy5waXhlbEhlaWdodCArICdweDt3aWR0aDonICsgdGhpcy5waXhlbFdpZHRoICsgJ3B4O3BhZGRpbmc6MHB4O21hcmdpbjowcHg7XCIgJyArXG4gICAgICAgICAgICAgICAgJyBwYXRoPVwibSAnICsgaW5pdGlhbCArICcgbCAnICsgdnBhdGguam9pbignLCAnKSArICcgJyArIGNsb3NlZCArICdlXCI+JyArXG4gICAgICAgICAgICAgICAgJyA8L3Y6c2hhcGU+JztcbiAgICAgICAgICAgIHJldHVybiB2ZWw7XG4gICAgICAgIH0sXG5cbiAgICAgICAgX2RyYXdDaXJjbGU6IGZ1bmN0aW9uIChzaGFwZWlkLCB4LCB5LCByYWRpdXMsIGxpbmVDb2xvciwgZmlsbENvbG9yLCBsaW5lV2lkdGgpIHtcbiAgICAgICAgICAgIHZhciBzdHJva2UsIGZpbGwsIHZlbDtcbiAgICAgICAgICAgIHggLT0gcmFkaXVzO1xuICAgICAgICAgICAgeSAtPSByYWRpdXM7XG4gICAgICAgICAgICBzdHJva2UgPSBsaW5lQ29sb3IgPT09IHVuZGVmaW5lZCA/ICcgc3Ryb2tlZD1cImZhbHNlXCIgJyA6ICcgc3Ryb2tlV2VpZ2h0PVwiJyArIGxpbmVXaWR0aCArICdweFwiIHN0cm9rZUNvbG9yPVwiJyArIGxpbmVDb2xvciArICdcIiAnO1xuICAgICAgICAgICAgZmlsbCA9IGZpbGxDb2xvciA9PT0gdW5kZWZpbmVkID8gJyBmaWxsZWQ9XCJmYWxzZVwiJyA6ICcgZmlsbENvbG9yPVwiJyArIGZpbGxDb2xvciArICdcIiBmaWxsZWQ9XCJ0cnVlXCIgJztcbiAgICAgICAgICAgIHZlbCA9ICc8djpvdmFsICcgK1xuICAgICAgICAgICAgICAgICAnIGlkPVwianFzc2hhcGUnICsgc2hhcGVpZCArICdcIiAnICtcbiAgICAgICAgICAgICAgICBzdHJva2UgK1xuICAgICAgICAgICAgICAgIGZpbGwgK1xuICAgICAgICAgICAgICAgICcgc3R5bGU9XCJwb3NpdGlvbjphYnNvbHV0ZTt0b3A6JyArIHkgKyAncHg7IGxlZnQ6JyArIHggKyAncHg7IHdpZHRoOicgKyAocmFkaXVzICogMikgKyAncHg7IGhlaWdodDonICsgKHJhZGl1cyAqIDIpICsgJ3B4XCI+PC92Om92YWw+JztcbiAgICAgICAgICAgIHJldHVybiB2ZWw7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBfZHJhd1BpZVNsaWNlOiBmdW5jdGlvbiAoc2hhcGVpZCwgeCwgeSwgcmFkaXVzLCBzdGFydEFuZ2xlLCBlbmRBbmdsZSwgbGluZUNvbG9yLCBmaWxsQ29sb3IpIHtcbiAgICAgICAgICAgIHZhciB2cGF0aCwgc3RhcnR4LCBzdGFydHksIGVuZHgsIGVuZHksIHN0cm9rZSwgZmlsbCwgdmVsO1xuICAgICAgICAgICAgaWYgKHN0YXJ0QW5nbGUgPT09IGVuZEFuZ2xlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICcnOyAgLy8gVk1MIHNlZW1zIHRvIGhhdmUgcHJvYmxlbSB3aGVuIHN0YXJ0IGFuZ2xlIGVxdWFscyBlbmQgYW5nbGUuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoKGVuZEFuZ2xlIC0gc3RhcnRBbmdsZSkgPT09ICgyICogTWF0aC5QSSkpIHtcbiAgICAgICAgICAgICAgICBzdGFydEFuZ2xlID0gMC4wOyAgLy8gVk1MIHNlZW1zIHRvIGhhdmUgYSBwcm9ibGVtIHdoZW4gZHJhd2luZyBhIGZ1bGwgY2lyY2xlIHRoYXQgZG9lc24ndCBzdGFydCAwXG4gICAgICAgICAgICAgICAgZW5kQW5nbGUgPSAoMiAqIE1hdGguUEkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBzdGFydHggPSB4ICsgTWF0aC5yb3VuZChNYXRoLmNvcyhzdGFydEFuZ2xlKSAqIHJhZGl1cyk7XG4gICAgICAgICAgICBzdGFydHkgPSB5ICsgTWF0aC5yb3VuZChNYXRoLnNpbihzdGFydEFuZ2xlKSAqIHJhZGl1cyk7XG4gICAgICAgICAgICBlbmR4ID0geCArIE1hdGgucm91bmQoTWF0aC5jb3MoZW5kQW5nbGUpICogcmFkaXVzKTtcbiAgICAgICAgICAgIGVuZHkgPSB5ICsgTWF0aC5yb3VuZChNYXRoLnNpbihlbmRBbmdsZSkgKiByYWRpdXMpO1xuXG4gICAgICAgICAgICBpZiAoc3RhcnR4ID09PSBlbmR4ICYmIHN0YXJ0eSA9PT0gZW5keSkge1xuICAgICAgICAgICAgICAgIGlmICgoZW5kQW5nbGUgLSBzdGFydEFuZ2xlKSA8IE1hdGguUEkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gUHJldmVudCB2ZXJ5IHNtYWxsIHNsaWNlcyBmcm9tIGJlaW5nIG1pc3Rha2VuIGFzIGEgd2hvbGUgcGllXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gZXNzZW50aWFsbHkgZ29pbmcgdG8gYmUgdGhlIGVudGlyZSBjaXJjbGUsIHNvIGlnbm9yZSBzdGFydEFuZ2xlXG4gICAgICAgICAgICAgICAgc3RhcnR4ID0gZW5keCA9IHggKyByYWRpdXM7XG4gICAgICAgICAgICAgICAgc3RhcnR5ID0gZW5keSA9IHk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChzdGFydHggPT09IGVuZHggJiYgc3RhcnR5ID09PSBlbmR5ICYmIChlbmRBbmdsZSAtIHN0YXJ0QW5nbGUpIDwgTWF0aC5QSSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdnBhdGggPSBbeCAtIHJhZGl1cywgeSAtIHJhZGl1cywgeCArIHJhZGl1cywgeSArIHJhZGl1cywgc3RhcnR4LCBzdGFydHksIGVuZHgsIGVuZHldO1xuICAgICAgICAgICAgc3Ryb2tlID0gbGluZUNvbG9yID09PSB1bmRlZmluZWQgPyAnIHN0cm9rZWQ9XCJmYWxzZVwiICcgOiAnIHN0cm9rZVdlaWdodD1cIjFweFwiIHN0cm9rZUNvbG9yPVwiJyArIGxpbmVDb2xvciArICdcIiAnO1xuICAgICAgICAgICAgZmlsbCA9IGZpbGxDb2xvciA9PT0gdW5kZWZpbmVkID8gJyBmaWxsZWQ9XCJmYWxzZVwiJyA6ICcgZmlsbENvbG9yPVwiJyArIGZpbGxDb2xvciArICdcIiBmaWxsZWQ9XCJ0cnVlXCIgJztcbiAgICAgICAgICAgIHZlbCA9ICc8djpzaGFwZSBjb29yZG9yaWdpbj1cIjAgMFwiIGNvb3Jkc2l6ZT1cIicgKyB0aGlzLnBpeGVsV2lkdGggKyAnICcgKyB0aGlzLnBpeGVsSGVpZ2h0ICsgJ1wiICcgK1xuICAgICAgICAgICAgICAgICAnIGlkPVwianFzc2hhcGUnICsgc2hhcGVpZCArICdcIiAnICtcbiAgICAgICAgICAgICAgICAgc3Ryb2tlICtcbiAgICAgICAgICAgICAgICAgZmlsbCArXG4gICAgICAgICAgICAgICAgJyBzdHlsZT1cInBvc2l0aW9uOmFic29sdXRlO2xlZnQ6MHB4O3RvcDowcHg7aGVpZ2h0OicgKyB0aGlzLnBpeGVsSGVpZ2h0ICsgJ3B4O3dpZHRoOicgKyB0aGlzLnBpeGVsV2lkdGggKyAncHg7cGFkZGluZzowcHg7bWFyZ2luOjBweDtcIiAnICtcbiAgICAgICAgICAgICAgICAnIHBhdGg9XCJtICcgKyB4ICsgJywnICsgeSArICcgd2EgJyArIHZwYXRoLmpvaW4oJywgJykgKyAnIHggZVwiPicgK1xuICAgICAgICAgICAgICAgICcgPC92OnNoYXBlPic7XG4gICAgICAgICAgICByZXR1cm4gdmVsO1xuICAgICAgICB9LFxuXG4gICAgICAgIF9kcmF3UmVjdDogZnVuY3Rpb24gKHNoYXBlaWQsIHgsIHksIHdpZHRoLCBoZWlnaHQsIGxpbmVDb2xvciwgZmlsbENvbG9yKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZHJhd1NoYXBlKHNoYXBlaWQsIFtbeCwgeV0sIFt4LCB5ICsgaGVpZ2h0XSwgW3ggKyB3aWR0aCwgeSArIGhlaWdodF0sIFt4ICsgd2lkdGgsIHldLCBbeCwgeV1dLCBsaW5lQ29sb3IsIGZpbGxDb2xvcik7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVzZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuZ3JvdXAuaW5uZXJIVE1MID0gJyc7XG4gICAgICAgIH0sXG5cbiAgICAgICAgYXBwZW5kU2hhcGU6IGZ1bmN0aW9uIChzaGFwZSkge1xuICAgICAgICAgICAgdmFyIHZlbCA9IHRoaXNbJ19kcmF3JyArIHNoYXBlLnR5cGVdLmFwcGx5KHRoaXMsIHNoYXBlLmFyZ3MpO1xuICAgICAgICAgICAgaWYgKHRoaXMucmVuZGVyZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmdyb3VwLmluc2VydEFkamFjZW50SFRNTCgnYmVmb3JlRW5kJywgdmVsKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcmVyZW5kZXIgKz0gdmVsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5sYXN0U2hhcGVJZCA9IHNoYXBlLmlkO1xuICAgICAgICAgICAgcmV0dXJuIHNoYXBlLmlkO1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlcGxhY2VXaXRoU2hhcGU6IGZ1bmN0aW9uIChzaGFwZWlkLCBzaGFwZSkge1xuICAgICAgICAgICAgdmFyIGV4aXN0aW5nID0gJCgnI2pxc3NoYXBlJyArIHNoYXBlaWQpLFxuICAgICAgICAgICAgICAgIHZlbCA9IHRoaXNbJ19kcmF3JyArIHNoYXBlLnR5cGVdLmFwcGx5KHRoaXMsIHNoYXBlLmFyZ3MpO1xuICAgICAgICAgICAgZXhpc3RpbmdbMF0ub3V0ZXJIVE1MID0gdmVsO1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlcGxhY2VXaXRoU2hhcGVzOiBmdW5jdGlvbiAoc2hhcGVpZHMsIHNoYXBlcykge1xuICAgICAgICAgICAgLy8gcmVwbGFjZSB0aGUgZmlyc3Qgc2hhcGVpZCB3aXRoIGFsbCB0aGUgbmV3IHNoYXBlcyB0aGVuIHRvYXN0IHRoZSByZW1haW5pbmcgb2xkIHNoYXBlc1xuICAgICAgICAgICAgdmFyIGV4aXN0aW5nID0gJCgnI2pxc3NoYXBlJyArIHNoYXBlaWRzWzBdKSxcbiAgICAgICAgICAgICAgICByZXBsYWNlID0gJycsXG4gICAgICAgICAgICAgICAgc2xlbiA9IHNoYXBlcy5sZW5ndGgsXG4gICAgICAgICAgICAgICAgaTtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBzbGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgICByZXBsYWNlICs9IHRoaXNbJ19kcmF3JyArIHNoYXBlc1tpXS50eXBlXS5hcHBseSh0aGlzLCBzaGFwZXNbaV0uYXJncyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBleGlzdGluZ1swXS5vdXRlckhUTUwgPSByZXBsYWNlO1xuICAgICAgICAgICAgZm9yIChpID0gMTsgaSA8IHNoYXBlaWRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgJCgnI2pxc3NoYXBlJyArIHNoYXBlaWRzW2ldKS5yZW1vdmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBpbnNlcnRBZnRlclNoYXBlOiBmdW5jdGlvbiAoc2hhcGVpZCwgc2hhcGUpIHtcbiAgICAgICAgICAgIHZhciBleGlzdGluZyA9ICQoJyNqcXNzaGFwZScgKyBzaGFwZWlkKSxcbiAgICAgICAgICAgICAgICAgdmVsID0gdGhpc1snX2RyYXcnICsgc2hhcGUudHlwZV0uYXBwbHkodGhpcywgc2hhcGUuYXJncyk7XG4gICAgICAgICAgICBleGlzdGluZ1swXS5pbnNlcnRBZGphY2VudEhUTUwoJ2FmdGVyRW5kJywgdmVsKTtcbiAgICAgICAgfSxcblxuICAgICAgICByZW1vdmVTaGFwZUlkOiBmdW5jdGlvbiAoc2hhcGVpZCkge1xuICAgICAgICAgICAgdmFyIGV4aXN0aW5nID0gJCgnI2pxc3NoYXBlJyArIHNoYXBlaWQpO1xuICAgICAgICAgICAgdGhpcy5ncm91cC5yZW1vdmVDaGlsZChleGlzdGluZ1swXSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2V0U2hhcGVBdDogZnVuY3Rpb24gKGVsLCB4LCB5KSB7XG4gICAgICAgICAgICB2YXIgc2hhcGVpZCA9IGVsLmlkLnN1YnN0cig4KTtcbiAgICAgICAgICAgIHJldHVybiBzaGFwZWlkO1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlbmRlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnJlbmRlcmVkKSB7XG4gICAgICAgICAgICAgICAgLy8gYmF0Y2ggdGhlIGludGlhbCByZW5kZXIgaW50byBhIHNpbmdsZSByZXBhaW50XG4gICAgICAgICAgICAgICAgdGhpcy5ncm91cC5pbm5lckhUTUwgPSB0aGlzLnByZXJlbmRlcjtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcmVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuXG59KSl9KGRvY3VtZW50LCBNYXRoKSk7XG4iLCIvKiFcbiAqIG11c3RhY2hlLmpzIC0gTG9naWMtbGVzcyB7e211c3RhY2hlfX0gdGVtcGxhdGVzIHdpdGggSmF2YVNjcmlwdFxuICogaHR0cDovL2dpdGh1Yi5jb20vamFubC9tdXN0YWNoZS5qc1xuICovXG5cbi8qZ2xvYmFsIGRlZmluZTogZmFsc2UgTXVzdGFjaGU6IHRydWUqL1xuXG4oZnVuY3Rpb24gZGVmaW5lTXVzdGFjaGUgKGdsb2JhbCwgZmFjdG9yeSkge1xuICBpZiAodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIGV4cG9ydHMgJiYgdHlwZW9mIGV4cG9ydHMubm9kZU5hbWUgIT09ICdzdHJpbmcnKSB7XG4gICAgZmFjdG9yeShleHBvcnRzKTsgLy8gQ29tbW9uSlNcbiAgfSBlbHNlIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcbiAgICBkZWZpbmUoWydleHBvcnRzJ10sIGZhY3RvcnkpOyAvLyBBTURcbiAgfSBlbHNlIHtcbiAgICBnbG9iYWwuTXVzdGFjaGUgPSB7fTtcbiAgICBmYWN0b3J5KGdsb2JhbC5NdXN0YWNoZSk7IC8vIHNjcmlwdCwgd3NoLCBhc3BcbiAgfVxufSh0aGlzLCBmdW5jdGlvbiBtdXN0YWNoZUZhY3RvcnkgKG11c3RhY2hlKSB7XG5cbiAgdmFyIG9iamVjdFRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZztcbiAgdmFyIGlzQXJyYXkgPSBBcnJheS5pc0FycmF5IHx8IGZ1bmN0aW9uIGlzQXJyYXlQb2x5ZmlsbCAob2JqZWN0KSB7XG4gICAgcmV0dXJuIG9iamVjdFRvU3RyaW5nLmNhbGwob2JqZWN0KSA9PT0gJ1tvYmplY3QgQXJyYXldJztcbiAgfTtcblxuICBmdW5jdGlvbiBpc0Z1bmN0aW9uIChvYmplY3QpIHtcbiAgICByZXR1cm4gdHlwZW9mIG9iamVjdCA9PT0gJ2Z1bmN0aW9uJztcbiAgfVxuXG4gIC8qKlxuICAgKiBNb3JlIGNvcnJlY3QgdHlwZW9mIHN0cmluZyBoYW5kbGluZyBhcnJheVxuICAgKiB3aGljaCBub3JtYWxseSByZXR1cm5zIHR5cGVvZiAnb2JqZWN0J1xuICAgKi9cbiAgZnVuY3Rpb24gdHlwZVN0ciAob2JqKSB7XG4gICAgcmV0dXJuIGlzQXJyYXkob2JqKSA/ICdhcnJheScgOiB0eXBlb2Ygb2JqO1xuICB9XG5cbiAgZnVuY3Rpb24gZXNjYXBlUmVnRXhwIChzdHJpbmcpIHtcbiAgICByZXR1cm4gc3RyaW5nLnJlcGxhY2UoL1tcXC1cXFtcXF17fSgpKis/LixcXFxcXFxeJHwjXFxzXS9nLCAnXFxcXCQmJyk7XG4gIH1cblxuICAvKipcbiAgICogTnVsbCBzYWZlIHdheSBvZiBjaGVja2luZyB3aGV0aGVyIG9yIG5vdCBhbiBvYmplY3QsXG4gICAqIGluY2x1ZGluZyBpdHMgcHJvdG90eXBlLCBoYXMgYSBnaXZlbiBwcm9wZXJ0eVxuICAgKi9cbiAgZnVuY3Rpb24gaGFzUHJvcGVydHkgKG9iaiwgcHJvcE5hbWUpIHtcbiAgICByZXR1cm4gb2JqICE9IG51bGwgJiYgdHlwZW9mIG9iaiA9PT0gJ29iamVjdCcgJiYgKHByb3BOYW1lIGluIG9iaik7XG4gIH1cblxuICAvLyBXb3JrYXJvdW5kIGZvciBodHRwczovL2lzc3Vlcy5hcGFjaGUub3JnL2ppcmEvYnJvd3NlL0NPVUNIREItNTc3XG4gIC8vIFNlZSBodHRwczovL2dpdGh1Yi5jb20vamFubC9tdXN0YWNoZS5qcy9pc3N1ZXMvMTg5XG4gIHZhciByZWdFeHBUZXN0ID0gUmVnRXhwLnByb3RvdHlwZS50ZXN0O1xuICBmdW5jdGlvbiB0ZXN0UmVnRXhwIChyZSwgc3RyaW5nKSB7XG4gICAgcmV0dXJuIHJlZ0V4cFRlc3QuY2FsbChyZSwgc3RyaW5nKTtcbiAgfVxuXG4gIHZhciBub25TcGFjZVJlID0gL1xcUy87XG4gIGZ1bmN0aW9uIGlzV2hpdGVzcGFjZSAoc3RyaW5nKSB7XG4gICAgcmV0dXJuICF0ZXN0UmVnRXhwKG5vblNwYWNlUmUsIHN0cmluZyk7XG4gIH1cblxuICB2YXIgZW50aXR5TWFwID0ge1xuICAgICcmJzogJyZhbXA7JyxcbiAgICAnPCc6ICcmbHQ7JyxcbiAgICAnPic6ICcmZ3Q7JyxcbiAgICAnXCInOiAnJnF1b3Q7JyxcbiAgICBcIidcIjogJyYjMzk7JyxcbiAgICAnLyc6ICcmI3gyRjsnLFxuICAgICdgJzogJyYjeDYwOycsXG4gICAgJz0nOiAnJiN4M0Q7J1xuICB9O1xuXG4gIGZ1bmN0aW9uIGVzY2FwZUh0bWwgKHN0cmluZykge1xuICAgIHJldHVybiBTdHJpbmcoc3RyaW5nKS5yZXBsYWNlKC9bJjw+XCInYD1cXC9dL2csIGZ1bmN0aW9uIGZyb21FbnRpdHlNYXAgKHMpIHtcbiAgICAgIHJldHVybiBlbnRpdHlNYXBbc107XG4gICAgfSk7XG4gIH1cblxuICB2YXIgd2hpdGVSZSA9IC9cXHMqLztcbiAgdmFyIHNwYWNlUmUgPSAvXFxzKy87XG4gIHZhciBlcXVhbHNSZSA9IC9cXHMqPS87XG4gIHZhciBjdXJseVJlID0gL1xccypcXH0vO1xuICB2YXIgdGFnUmUgPSAvI3xcXF58XFwvfD58XFx7fCZ8PXwhLztcblxuICAvKipcbiAgICogQnJlYWtzIHVwIHRoZSBnaXZlbiBgdGVtcGxhdGVgIHN0cmluZyBpbnRvIGEgdHJlZSBvZiB0b2tlbnMuIElmIHRoZSBgdGFnc2BcbiAgICogYXJndW1lbnQgaXMgZ2l2ZW4gaGVyZSBpdCBtdXN0IGJlIGFuIGFycmF5IHdpdGggdHdvIHN0cmluZyB2YWx1ZXM6IHRoZVxuICAgKiBvcGVuaW5nIGFuZCBjbG9zaW5nIHRhZ3MgdXNlZCBpbiB0aGUgdGVtcGxhdGUgKGUuZy4gWyBcIjwlXCIsIFwiJT5cIiBdKS4gT2ZcbiAgICogY291cnNlLCB0aGUgZGVmYXVsdCBpcyB0byB1c2UgbXVzdGFjaGVzIChpLmUuIG11c3RhY2hlLnRhZ3MpLlxuICAgKlxuICAgKiBBIHRva2VuIGlzIGFuIGFycmF5IHdpdGggYXQgbGVhc3QgNCBlbGVtZW50cy4gVGhlIGZpcnN0IGVsZW1lbnQgaXMgdGhlXG4gICAqIG11c3RhY2hlIHN5bWJvbCB0aGF0IHdhcyB1c2VkIGluc2lkZSB0aGUgdGFnLCBlLmcuIFwiI1wiIG9yIFwiJlwiLiBJZiB0aGUgdGFnXG4gICAqIGRpZCBub3QgY29udGFpbiBhIHN5bWJvbCAoaS5lLiB7e215VmFsdWV9fSkgdGhpcyBlbGVtZW50IGlzIFwibmFtZVwiLiBGb3JcbiAgICogYWxsIHRleHQgdGhhdCBhcHBlYXJzIG91dHNpZGUgYSBzeW1ib2wgdGhpcyBlbGVtZW50IGlzIFwidGV4dFwiLlxuICAgKlxuICAgKiBUaGUgc2Vjb25kIGVsZW1lbnQgb2YgYSB0b2tlbiBpcyBpdHMgXCJ2YWx1ZVwiLiBGb3IgbXVzdGFjaGUgdGFncyB0aGlzIGlzXG4gICAqIHdoYXRldmVyIGVsc2Ugd2FzIGluc2lkZSB0aGUgdGFnIGJlc2lkZXMgdGhlIG9wZW5pbmcgc3ltYm9sLiBGb3IgdGV4dCB0b2tlbnNcbiAgICogdGhpcyBpcyB0aGUgdGV4dCBpdHNlbGYuXG4gICAqXG4gICAqIFRoZSB0aGlyZCBhbmQgZm91cnRoIGVsZW1lbnRzIG9mIHRoZSB0b2tlbiBhcmUgdGhlIHN0YXJ0IGFuZCBlbmQgaW5kaWNlcyxcbiAgICogcmVzcGVjdGl2ZWx5LCBvZiB0aGUgdG9rZW4gaW4gdGhlIG9yaWdpbmFsIHRlbXBsYXRlLlxuICAgKlxuICAgKiBUb2tlbnMgdGhhdCBhcmUgdGhlIHJvb3Qgbm9kZSBvZiBhIHN1YnRyZWUgY29udGFpbiB0d28gbW9yZSBlbGVtZW50czogMSkgYW5cbiAgICogYXJyYXkgb2YgdG9rZW5zIGluIHRoZSBzdWJ0cmVlIGFuZCAyKSB0aGUgaW5kZXggaW4gdGhlIG9yaWdpbmFsIHRlbXBsYXRlIGF0XG4gICAqIHdoaWNoIHRoZSBjbG9zaW5nIHRhZyBmb3IgdGhhdCBzZWN0aW9uIGJlZ2lucy5cbiAgICovXG4gIGZ1bmN0aW9uIHBhcnNlVGVtcGxhdGUgKHRlbXBsYXRlLCB0YWdzKSB7XG4gICAgaWYgKCF0ZW1wbGF0ZSlcbiAgICAgIHJldHVybiBbXTtcblxuICAgIHZhciBzZWN0aW9ucyA9IFtdOyAgICAgLy8gU3RhY2sgdG8gaG9sZCBzZWN0aW9uIHRva2Vuc1xuICAgIHZhciB0b2tlbnMgPSBbXTsgICAgICAgLy8gQnVmZmVyIHRvIGhvbGQgdGhlIHRva2Vuc1xuICAgIHZhciBzcGFjZXMgPSBbXTsgICAgICAgLy8gSW5kaWNlcyBvZiB3aGl0ZXNwYWNlIHRva2VucyBvbiB0aGUgY3VycmVudCBsaW5lXG4gICAgdmFyIGhhc1RhZyA9IGZhbHNlOyAgICAvLyBJcyB0aGVyZSBhIHt7dGFnfX0gb24gdGhlIGN1cnJlbnQgbGluZT9cbiAgICB2YXIgbm9uU3BhY2UgPSBmYWxzZTsgIC8vIElzIHRoZXJlIGEgbm9uLXNwYWNlIGNoYXIgb24gdGhlIGN1cnJlbnQgbGluZT9cblxuICAgIC8vIFN0cmlwcyBhbGwgd2hpdGVzcGFjZSB0b2tlbnMgYXJyYXkgZm9yIHRoZSBjdXJyZW50IGxpbmVcbiAgICAvLyBpZiB0aGVyZSB3YXMgYSB7eyN0YWd9fSBvbiBpdCBhbmQgb3RoZXJ3aXNlIG9ubHkgc3BhY2UuXG4gICAgZnVuY3Rpb24gc3RyaXBTcGFjZSAoKSB7XG4gICAgICBpZiAoaGFzVGFnICYmICFub25TcGFjZSkge1xuICAgICAgICB3aGlsZSAoc3BhY2VzLmxlbmd0aClcbiAgICAgICAgICBkZWxldGUgdG9rZW5zW3NwYWNlcy5wb3AoKV07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzcGFjZXMgPSBbXTtcbiAgICAgIH1cblxuICAgICAgaGFzVGFnID0gZmFsc2U7XG4gICAgICBub25TcGFjZSA9IGZhbHNlO1xuICAgIH1cblxuICAgIHZhciBvcGVuaW5nVGFnUmUsIGNsb3NpbmdUYWdSZSwgY2xvc2luZ0N1cmx5UmU7XG4gICAgZnVuY3Rpb24gY29tcGlsZVRhZ3MgKHRhZ3NUb0NvbXBpbGUpIHtcbiAgICAgIGlmICh0eXBlb2YgdGFnc1RvQ29tcGlsZSA9PT0gJ3N0cmluZycpXG4gICAgICAgIHRhZ3NUb0NvbXBpbGUgPSB0YWdzVG9Db21waWxlLnNwbGl0KHNwYWNlUmUsIDIpO1xuXG4gICAgICBpZiAoIWlzQXJyYXkodGFnc1RvQ29tcGlsZSkgfHwgdGFnc1RvQ29tcGlsZS5sZW5ndGggIT09IDIpXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCB0YWdzOiAnICsgdGFnc1RvQ29tcGlsZSk7XG5cbiAgICAgIG9wZW5pbmdUYWdSZSA9IG5ldyBSZWdFeHAoZXNjYXBlUmVnRXhwKHRhZ3NUb0NvbXBpbGVbMF0pICsgJ1xcXFxzKicpO1xuICAgICAgY2xvc2luZ1RhZ1JlID0gbmV3IFJlZ0V4cCgnXFxcXHMqJyArIGVzY2FwZVJlZ0V4cCh0YWdzVG9Db21waWxlWzFdKSk7XG4gICAgICBjbG9zaW5nQ3VybHlSZSA9IG5ldyBSZWdFeHAoJ1xcXFxzKicgKyBlc2NhcGVSZWdFeHAoJ30nICsgdGFnc1RvQ29tcGlsZVsxXSkpO1xuICAgIH1cblxuICAgIGNvbXBpbGVUYWdzKHRhZ3MgfHwgbXVzdGFjaGUudGFncyk7XG5cbiAgICB2YXIgc2Nhbm5lciA9IG5ldyBTY2FubmVyKHRlbXBsYXRlKTtcblxuICAgIHZhciBzdGFydCwgdHlwZSwgdmFsdWUsIGNociwgdG9rZW4sIG9wZW5TZWN0aW9uO1xuICAgIHdoaWxlICghc2Nhbm5lci5lb3MoKSkge1xuICAgICAgc3RhcnQgPSBzY2FubmVyLnBvcztcblxuICAgICAgLy8gTWF0Y2ggYW55IHRleHQgYmV0d2VlbiB0YWdzLlxuICAgICAgdmFsdWUgPSBzY2FubmVyLnNjYW5VbnRpbChvcGVuaW5nVGFnUmUpO1xuXG4gICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIHZhbHVlTGVuZ3RoID0gdmFsdWUubGVuZ3RoOyBpIDwgdmFsdWVMZW5ndGg7ICsraSkge1xuICAgICAgICAgIGNociA9IHZhbHVlLmNoYXJBdChpKTtcblxuICAgICAgICAgIGlmIChpc1doaXRlc3BhY2UoY2hyKSkge1xuICAgICAgICAgICAgc3BhY2VzLnB1c2godG9rZW5zLmxlbmd0aCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG5vblNwYWNlID0gdHJ1ZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB0b2tlbnMucHVzaChbICd0ZXh0JywgY2hyLCBzdGFydCwgc3RhcnQgKyAxIF0pO1xuICAgICAgICAgIHN0YXJ0ICs9IDE7XG5cbiAgICAgICAgICAvLyBDaGVjayBmb3Igd2hpdGVzcGFjZSBvbiB0aGUgY3VycmVudCBsaW5lLlxuICAgICAgICAgIGlmIChjaHIgPT09ICdcXG4nKVxuICAgICAgICAgICAgc3RyaXBTcGFjZSgpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIE1hdGNoIHRoZSBvcGVuaW5nIHRhZy5cbiAgICAgIGlmICghc2Nhbm5lci5zY2FuKG9wZW5pbmdUYWdSZSkpXG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBoYXNUYWcgPSB0cnVlO1xuXG4gICAgICAvLyBHZXQgdGhlIHRhZyB0eXBlLlxuICAgICAgdHlwZSA9IHNjYW5uZXIuc2Nhbih0YWdSZSkgfHwgJ25hbWUnO1xuICAgICAgc2Nhbm5lci5zY2FuKHdoaXRlUmUpO1xuXG4gICAgICAvLyBHZXQgdGhlIHRhZyB2YWx1ZS5cbiAgICAgIGlmICh0eXBlID09PSAnPScpIHtcbiAgICAgICAgdmFsdWUgPSBzY2FubmVyLnNjYW5VbnRpbChlcXVhbHNSZSk7XG4gICAgICAgIHNjYW5uZXIuc2NhbihlcXVhbHNSZSk7XG4gICAgICAgIHNjYW5uZXIuc2NhblVudGlsKGNsb3NpbmdUYWdSZSk7XG4gICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICd7Jykge1xuICAgICAgICB2YWx1ZSA9IHNjYW5uZXIuc2NhblVudGlsKGNsb3NpbmdDdXJseVJlKTtcbiAgICAgICAgc2Nhbm5lci5zY2FuKGN1cmx5UmUpO1xuICAgICAgICBzY2FubmVyLnNjYW5VbnRpbChjbG9zaW5nVGFnUmUpO1xuICAgICAgICB0eXBlID0gJyYnO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFsdWUgPSBzY2FubmVyLnNjYW5VbnRpbChjbG9zaW5nVGFnUmUpO1xuICAgICAgfVxuXG4gICAgICAvLyBNYXRjaCB0aGUgY2xvc2luZyB0YWcuXG4gICAgICBpZiAoIXNjYW5uZXIuc2NhbihjbG9zaW5nVGFnUmUpKVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VuY2xvc2VkIHRhZyBhdCAnICsgc2Nhbm5lci5wb3MpO1xuXG4gICAgICB0b2tlbiA9IFsgdHlwZSwgdmFsdWUsIHN0YXJ0LCBzY2FubmVyLnBvcyBdO1xuICAgICAgdG9rZW5zLnB1c2godG9rZW4pO1xuXG4gICAgICBpZiAodHlwZSA9PT0gJyMnIHx8IHR5cGUgPT09ICdeJykge1xuICAgICAgICBzZWN0aW9ucy5wdXNoKHRva2VuKTtcbiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJy8nKSB7XG4gICAgICAgIC8vIENoZWNrIHNlY3Rpb24gbmVzdGluZy5cbiAgICAgICAgb3BlblNlY3Rpb24gPSBzZWN0aW9ucy5wb3AoKTtcblxuICAgICAgICBpZiAoIW9wZW5TZWN0aW9uKVxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVW5vcGVuZWQgc2VjdGlvbiBcIicgKyB2YWx1ZSArICdcIiBhdCAnICsgc3RhcnQpO1xuXG4gICAgICAgIGlmIChvcGVuU2VjdGlvblsxXSAhPT0gdmFsdWUpXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdVbmNsb3NlZCBzZWN0aW9uIFwiJyArIG9wZW5TZWN0aW9uWzFdICsgJ1wiIGF0ICcgKyBzdGFydCk7XG4gICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICduYW1lJyB8fCB0eXBlID09PSAneycgfHwgdHlwZSA9PT0gJyYnKSB7XG4gICAgICAgIG5vblNwYWNlID0gdHJ1ZTtcbiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJz0nKSB7XG4gICAgICAgIC8vIFNldCB0aGUgdGFncyBmb3IgdGhlIG5leHQgdGltZSBhcm91bmQuXG4gICAgICAgIGNvbXBpbGVUYWdzKHZhbHVlKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBNYWtlIHN1cmUgdGhlcmUgYXJlIG5vIG9wZW4gc2VjdGlvbnMgd2hlbiB3ZSdyZSBkb25lLlxuICAgIG9wZW5TZWN0aW9uID0gc2VjdGlvbnMucG9wKCk7XG5cbiAgICBpZiAob3BlblNlY3Rpb24pXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VuY2xvc2VkIHNlY3Rpb24gXCInICsgb3BlblNlY3Rpb25bMV0gKyAnXCIgYXQgJyArIHNjYW5uZXIucG9zKTtcblxuICAgIHJldHVybiBuZXN0VG9rZW5zKHNxdWFzaFRva2Vucyh0b2tlbnMpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDb21iaW5lcyB0aGUgdmFsdWVzIG9mIGNvbnNlY3V0aXZlIHRleHQgdG9rZW5zIGluIHRoZSBnaXZlbiBgdG9rZW5zYCBhcnJheVxuICAgKiB0byBhIHNpbmdsZSB0b2tlbi5cbiAgICovXG4gIGZ1bmN0aW9uIHNxdWFzaFRva2VucyAodG9rZW5zKSB7XG4gICAgdmFyIHNxdWFzaGVkVG9rZW5zID0gW107XG5cbiAgICB2YXIgdG9rZW4sIGxhc3RUb2tlbjtcbiAgICBmb3IgKHZhciBpID0gMCwgbnVtVG9rZW5zID0gdG9rZW5zLmxlbmd0aDsgaSA8IG51bVRva2VuczsgKytpKSB7XG4gICAgICB0b2tlbiA9IHRva2Vuc1tpXTtcblxuICAgICAgaWYgKHRva2VuKSB7XG4gICAgICAgIGlmICh0b2tlblswXSA9PT0gJ3RleHQnICYmIGxhc3RUb2tlbiAmJiBsYXN0VG9rZW5bMF0gPT09ICd0ZXh0Jykge1xuICAgICAgICAgIGxhc3RUb2tlblsxXSArPSB0b2tlblsxXTtcbiAgICAgICAgICBsYXN0VG9rZW5bM10gPSB0b2tlblszXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzcXVhc2hlZFRva2Vucy5wdXNoKHRva2VuKTtcbiAgICAgICAgICBsYXN0VG9rZW4gPSB0b2tlbjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBzcXVhc2hlZFRva2VucztcbiAgfVxuXG4gIC8qKlxuICAgKiBGb3JtcyB0aGUgZ2l2ZW4gYXJyYXkgb2YgYHRva2Vuc2AgaW50byBhIG5lc3RlZCB0cmVlIHN0cnVjdHVyZSB3aGVyZVxuICAgKiB0b2tlbnMgdGhhdCByZXByZXNlbnQgYSBzZWN0aW9uIGhhdmUgdHdvIGFkZGl0aW9uYWwgaXRlbXM6IDEpIGFuIGFycmF5IG9mXG4gICAqIGFsbCB0b2tlbnMgdGhhdCBhcHBlYXIgaW4gdGhhdCBzZWN0aW9uIGFuZCAyKSB0aGUgaW5kZXggaW4gdGhlIG9yaWdpbmFsXG4gICAqIHRlbXBsYXRlIHRoYXQgcmVwcmVzZW50cyB0aGUgZW5kIG9mIHRoYXQgc2VjdGlvbi5cbiAgICovXG4gIGZ1bmN0aW9uIG5lc3RUb2tlbnMgKHRva2Vucykge1xuICAgIHZhciBuZXN0ZWRUb2tlbnMgPSBbXTtcbiAgICB2YXIgY29sbGVjdG9yID0gbmVzdGVkVG9rZW5zO1xuICAgIHZhciBzZWN0aW9ucyA9IFtdO1xuXG4gICAgdmFyIHRva2VuLCBzZWN0aW9uO1xuICAgIGZvciAodmFyIGkgPSAwLCBudW1Ub2tlbnMgPSB0b2tlbnMubGVuZ3RoOyBpIDwgbnVtVG9rZW5zOyArK2kpIHtcbiAgICAgIHRva2VuID0gdG9rZW5zW2ldO1xuXG4gICAgICBzd2l0Y2ggKHRva2VuWzBdKSB7XG4gICAgICAgIGNhc2UgJyMnOlxuICAgICAgICBjYXNlICdeJzpcbiAgICAgICAgICBjb2xsZWN0b3IucHVzaCh0b2tlbik7XG4gICAgICAgICAgc2VjdGlvbnMucHVzaCh0b2tlbik7XG4gICAgICAgICAgY29sbGVjdG9yID0gdG9rZW5bNF0gPSBbXTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnLyc6XG4gICAgICAgICAgc2VjdGlvbiA9IHNlY3Rpb25zLnBvcCgpO1xuICAgICAgICAgIHNlY3Rpb25bNV0gPSB0b2tlblsyXTtcbiAgICAgICAgICBjb2xsZWN0b3IgPSBzZWN0aW9ucy5sZW5ndGggPiAwID8gc2VjdGlvbnNbc2VjdGlvbnMubGVuZ3RoIC0gMV1bNF0gOiBuZXN0ZWRUb2tlbnM7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgY29sbGVjdG9yLnB1c2godG9rZW4pO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBuZXN0ZWRUb2tlbnM7XG4gIH1cblxuICAvKipcbiAgICogQSBzaW1wbGUgc3RyaW5nIHNjYW5uZXIgdGhhdCBpcyB1c2VkIGJ5IHRoZSB0ZW1wbGF0ZSBwYXJzZXIgdG8gZmluZFxuICAgKiB0b2tlbnMgaW4gdGVtcGxhdGUgc3RyaW5ncy5cbiAgICovXG4gIGZ1bmN0aW9uIFNjYW5uZXIgKHN0cmluZykge1xuICAgIHRoaXMuc3RyaW5nID0gc3RyaW5nO1xuICAgIHRoaXMudGFpbCA9IHN0cmluZztcbiAgICB0aGlzLnBvcyA9IDA7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIHRhaWwgaXMgZW1wdHkgKGVuZCBvZiBzdHJpbmcpLlxuICAgKi9cbiAgU2Nhbm5lci5wcm90b3R5cGUuZW9zID0gZnVuY3Rpb24gZW9zICgpIHtcbiAgICByZXR1cm4gdGhpcy50YWlsID09PSAnJztcbiAgfTtcblxuICAvKipcbiAgICogVHJpZXMgdG8gbWF0Y2ggdGhlIGdpdmVuIHJlZ3VsYXIgZXhwcmVzc2lvbiBhdCB0aGUgY3VycmVudCBwb3NpdGlvbi5cbiAgICogUmV0dXJucyB0aGUgbWF0Y2hlZCB0ZXh0IGlmIGl0IGNhbiBtYXRjaCwgdGhlIGVtcHR5IHN0cmluZyBvdGhlcndpc2UuXG4gICAqL1xuICBTY2FubmVyLnByb3RvdHlwZS5zY2FuID0gZnVuY3Rpb24gc2NhbiAocmUpIHtcbiAgICB2YXIgbWF0Y2ggPSB0aGlzLnRhaWwubWF0Y2gocmUpO1xuXG4gICAgaWYgKCFtYXRjaCB8fCBtYXRjaC5pbmRleCAhPT0gMClcbiAgICAgIHJldHVybiAnJztcblxuICAgIHZhciBzdHJpbmcgPSBtYXRjaFswXTtcblxuICAgIHRoaXMudGFpbCA9IHRoaXMudGFpbC5zdWJzdHJpbmcoc3RyaW5nLmxlbmd0aCk7XG4gICAgdGhpcy5wb3MgKz0gc3RyaW5nLmxlbmd0aDtcblxuICAgIHJldHVybiBzdHJpbmc7XG4gIH07XG5cbiAgLyoqXG4gICAqIFNraXBzIGFsbCB0ZXh0IHVudGlsIHRoZSBnaXZlbiByZWd1bGFyIGV4cHJlc3Npb24gY2FuIGJlIG1hdGNoZWQuIFJldHVybnNcbiAgICogdGhlIHNraXBwZWQgc3RyaW5nLCB3aGljaCBpcyB0aGUgZW50aXJlIHRhaWwgaWYgbm8gbWF0Y2ggY2FuIGJlIG1hZGUuXG4gICAqL1xuICBTY2FubmVyLnByb3RvdHlwZS5zY2FuVW50aWwgPSBmdW5jdGlvbiBzY2FuVW50aWwgKHJlKSB7XG4gICAgdmFyIGluZGV4ID0gdGhpcy50YWlsLnNlYXJjaChyZSksIG1hdGNoO1xuXG4gICAgc3dpdGNoIChpbmRleCkge1xuICAgICAgY2FzZSAtMTpcbiAgICAgICAgbWF0Y2ggPSB0aGlzLnRhaWw7XG4gICAgICAgIHRoaXMudGFpbCA9ICcnO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgMDpcbiAgICAgICAgbWF0Y2ggPSAnJztcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICBtYXRjaCA9IHRoaXMudGFpbC5zdWJzdHJpbmcoMCwgaW5kZXgpO1xuICAgICAgICB0aGlzLnRhaWwgPSB0aGlzLnRhaWwuc3Vic3RyaW5nKGluZGV4KTtcbiAgICB9XG5cbiAgICB0aGlzLnBvcyArPSBtYXRjaC5sZW5ndGg7XG5cbiAgICByZXR1cm4gbWF0Y2g7XG4gIH07XG5cbiAgLyoqXG4gICAqIFJlcHJlc2VudHMgYSByZW5kZXJpbmcgY29udGV4dCBieSB3cmFwcGluZyBhIHZpZXcgb2JqZWN0IGFuZFxuICAgKiBtYWludGFpbmluZyBhIHJlZmVyZW5jZSB0byB0aGUgcGFyZW50IGNvbnRleHQuXG4gICAqL1xuICBmdW5jdGlvbiBDb250ZXh0ICh2aWV3LCBwYXJlbnRDb250ZXh0KSB7XG4gICAgdGhpcy52aWV3ID0gdmlldztcbiAgICB0aGlzLmNhY2hlID0geyAnLic6IHRoaXMudmlldyB9O1xuICAgIHRoaXMucGFyZW50ID0gcGFyZW50Q29udGV4dDtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGEgbmV3IGNvbnRleHQgdXNpbmcgdGhlIGdpdmVuIHZpZXcgd2l0aCB0aGlzIGNvbnRleHRcbiAgICogYXMgdGhlIHBhcmVudC5cbiAgICovXG4gIENvbnRleHQucHJvdG90eXBlLnB1c2ggPSBmdW5jdGlvbiBwdXNoICh2aWV3KSB7XG4gICAgcmV0dXJuIG5ldyBDb250ZXh0KHZpZXcsIHRoaXMpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSB2YWx1ZSBvZiB0aGUgZ2l2ZW4gbmFtZSBpbiB0aGlzIGNvbnRleHQsIHRyYXZlcnNpbmdcbiAgICogdXAgdGhlIGNvbnRleHQgaGllcmFyY2h5IGlmIHRoZSB2YWx1ZSBpcyBhYnNlbnQgaW4gdGhpcyBjb250ZXh0J3Mgdmlldy5cbiAgICovXG4gIENvbnRleHQucHJvdG90eXBlLmxvb2t1cCA9IGZ1bmN0aW9uIGxvb2t1cCAobmFtZSkge1xuICAgIHZhciBjYWNoZSA9IHRoaXMuY2FjaGU7XG5cbiAgICB2YXIgdmFsdWU7XG4gICAgaWYgKGNhY2hlLmhhc093blByb3BlcnR5KG5hbWUpKSB7XG4gICAgICB2YWx1ZSA9IGNhY2hlW25hbWVdO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgY29udGV4dCA9IHRoaXMsIG5hbWVzLCBpbmRleCwgbG9va3VwSGl0ID0gZmFsc2U7XG5cbiAgICAgIHdoaWxlIChjb250ZXh0KSB7XG4gICAgICAgIGlmIChuYW1lLmluZGV4T2YoJy4nKSA+IDApIHtcbiAgICAgICAgICB2YWx1ZSA9IGNvbnRleHQudmlldztcbiAgICAgICAgICBuYW1lcyA9IG5hbWUuc3BsaXQoJy4nKTtcbiAgICAgICAgICBpbmRleCA9IDA7XG5cbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBVc2luZyB0aGUgZG90IG5vdGlvbiBwYXRoIGluIGBuYW1lYCwgd2UgZGVzY2VuZCB0aHJvdWdoIHRoZVxuICAgICAgICAgICAqIG5lc3RlZCBvYmplY3RzLlxuICAgICAgICAgICAqXG4gICAgICAgICAgICogVG8gYmUgY2VydGFpbiB0aGF0IHRoZSBsb29rdXAgaGFzIGJlZW4gc3VjY2Vzc2Z1bCwgd2UgaGF2ZSB0b1xuICAgICAgICAgICAqIGNoZWNrIGlmIHRoZSBsYXN0IG9iamVjdCBpbiB0aGUgcGF0aCBhY3R1YWxseSBoYXMgdGhlIHByb3BlcnR5XG4gICAgICAgICAgICogd2UgYXJlIGxvb2tpbmcgZm9yLiBXZSBzdG9yZSB0aGUgcmVzdWx0IGluIGBsb29rdXBIaXRgLlxuICAgICAgICAgICAqXG4gICAgICAgICAgICogVGhpcyBpcyBzcGVjaWFsbHkgbmVjZXNzYXJ5IGZvciB3aGVuIHRoZSB2YWx1ZSBoYXMgYmVlbiBzZXQgdG9cbiAgICAgICAgICAgKiBgdW5kZWZpbmVkYCBhbmQgd2Ugd2FudCB0byBhdm9pZCBsb29raW5nIHVwIHBhcmVudCBjb250ZXh0cy5cbiAgICAgICAgICAgKiovXG4gICAgICAgICAgd2hpbGUgKHZhbHVlICE9IG51bGwgJiYgaW5kZXggPCBuYW1lcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGlmIChpbmRleCA9PT0gbmFtZXMubGVuZ3RoIC0gMSlcbiAgICAgICAgICAgICAgbG9va3VwSGl0ID0gaGFzUHJvcGVydHkodmFsdWUsIG5hbWVzW2luZGV4XSk7XG5cbiAgICAgICAgICAgIHZhbHVlID0gdmFsdWVbbmFtZXNbaW5kZXgrK11dO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YWx1ZSA9IGNvbnRleHQudmlld1tuYW1lXTtcbiAgICAgICAgICBsb29rdXBIaXQgPSBoYXNQcm9wZXJ0eShjb250ZXh0LnZpZXcsIG5hbWUpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGxvb2t1cEhpdClcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjb250ZXh0ID0gY29udGV4dC5wYXJlbnQ7XG4gICAgICB9XG5cbiAgICAgIGNhY2hlW25hbWVdID0gdmFsdWU7XG4gICAgfVxuXG4gICAgaWYgKGlzRnVuY3Rpb24odmFsdWUpKVxuICAgICAgdmFsdWUgPSB2YWx1ZS5jYWxsKHRoaXMudmlldyk7XG5cbiAgICByZXR1cm4gdmFsdWU7XG4gIH07XG5cbiAgLyoqXG4gICAqIEEgV3JpdGVyIGtub3dzIGhvdyB0byB0YWtlIGEgc3RyZWFtIG9mIHRva2VucyBhbmQgcmVuZGVyIHRoZW0gdG8gYVxuICAgKiBzdHJpbmcsIGdpdmVuIGEgY29udGV4dC4gSXQgYWxzbyBtYWludGFpbnMgYSBjYWNoZSBvZiB0ZW1wbGF0ZXMgdG9cbiAgICogYXZvaWQgdGhlIG5lZWQgdG8gcGFyc2UgdGhlIHNhbWUgdGVtcGxhdGUgdHdpY2UuXG4gICAqL1xuICBmdW5jdGlvbiBXcml0ZXIgKCkge1xuICAgIHRoaXMuY2FjaGUgPSB7fTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDbGVhcnMgYWxsIGNhY2hlZCB0ZW1wbGF0ZXMgaW4gdGhpcyB3cml0ZXIuXG4gICAqL1xuICBXcml0ZXIucHJvdG90eXBlLmNsZWFyQ2FjaGUgPSBmdW5jdGlvbiBjbGVhckNhY2hlICgpIHtcbiAgICB0aGlzLmNhY2hlID0ge307XG4gIH07XG5cbiAgLyoqXG4gICAqIFBhcnNlcyBhbmQgY2FjaGVzIHRoZSBnaXZlbiBgdGVtcGxhdGVgIGFuZCByZXR1cm5zIHRoZSBhcnJheSBvZiB0b2tlbnNcbiAgICogdGhhdCBpcyBnZW5lcmF0ZWQgZnJvbSB0aGUgcGFyc2UuXG4gICAqL1xuICBXcml0ZXIucHJvdG90eXBlLnBhcnNlID0gZnVuY3Rpb24gcGFyc2UgKHRlbXBsYXRlLCB0YWdzKSB7XG4gICAgdmFyIGNhY2hlID0gdGhpcy5jYWNoZTtcbiAgICB2YXIgdG9rZW5zID0gY2FjaGVbdGVtcGxhdGVdO1xuXG4gICAgaWYgKHRva2VucyA9PSBudWxsKVxuICAgICAgdG9rZW5zID0gY2FjaGVbdGVtcGxhdGVdID0gcGFyc2VUZW1wbGF0ZSh0ZW1wbGF0ZSwgdGFncyk7XG5cbiAgICByZXR1cm4gdG9rZW5zO1xuICB9O1xuXG4gIC8qKlxuICAgKiBIaWdoLWxldmVsIG1ldGhvZCB0aGF0IGlzIHVzZWQgdG8gcmVuZGVyIHRoZSBnaXZlbiBgdGVtcGxhdGVgIHdpdGhcbiAgICogdGhlIGdpdmVuIGB2aWV3YC5cbiAgICpcbiAgICogVGhlIG9wdGlvbmFsIGBwYXJ0aWFsc2AgYXJndW1lbnQgbWF5IGJlIGFuIG9iamVjdCB0aGF0IGNvbnRhaW5zIHRoZVxuICAgKiBuYW1lcyBhbmQgdGVtcGxhdGVzIG9mIHBhcnRpYWxzIHRoYXQgYXJlIHVzZWQgaW4gdGhlIHRlbXBsYXRlLiBJdCBtYXlcbiAgICogYWxzbyBiZSBhIGZ1bmN0aW9uIHRoYXQgaXMgdXNlZCB0byBsb2FkIHBhcnRpYWwgdGVtcGxhdGVzIG9uIHRoZSBmbHlcbiAgICogdGhhdCB0YWtlcyBhIHNpbmdsZSBhcmd1bWVudDogdGhlIG5hbWUgb2YgdGhlIHBhcnRpYWwuXG4gICAqL1xuICBXcml0ZXIucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uIHJlbmRlciAodGVtcGxhdGUsIHZpZXcsIHBhcnRpYWxzKSB7XG4gICAgdmFyIHRva2VucyA9IHRoaXMucGFyc2UodGVtcGxhdGUpO1xuICAgIHZhciBjb250ZXh0ID0gKHZpZXcgaW5zdGFuY2VvZiBDb250ZXh0KSA/IHZpZXcgOiBuZXcgQ29udGV4dCh2aWV3KTtcbiAgICByZXR1cm4gdGhpcy5yZW5kZXJUb2tlbnModG9rZW5zLCBjb250ZXh0LCBwYXJ0aWFscywgdGVtcGxhdGUpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBMb3ctbGV2ZWwgbWV0aG9kIHRoYXQgcmVuZGVycyB0aGUgZ2l2ZW4gYXJyYXkgb2YgYHRva2Vuc2AgdXNpbmdcbiAgICogdGhlIGdpdmVuIGBjb250ZXh0YCBhbmQgYHBhcnRpYWxzYC5cbiAgICpcbiAgICogTm90ZTogVGhlIGBvcmlnaW5hbFRlbXBsYXRlYCBpcyBvbmx5IGV2ZXIgdXNlZCB0byBleHRyYWN0IHRoZSBwb3J0aW9uXG4gICAqIG9mIHRoZSBvcmlnaW5hbCB0ZW1wbGF0ZSB0aGF0IHdhcyBjb250YWluZWQgaW4gYSBoaWdoZXItb3JkZXIgc2VjdGlvbi5cbiAgICogSWYgdGhlIHRlbXBsYXRlIGRvZXNuJ3QgdXNlIGhpZ2hlci1vcmRlciBzZWN0aW9ucywgdGhpcyBhcmd1bWVudCBtYXlcbiAgICogYmUgb21pdHRlZC5cbiAgICovXG4gIFdyaXRlci5wcm90b3R5cGUucmVuZGVyVG9rZW5zID0gZnVuY3Rpb24gcmVuZGVyVG9rZW5zICh0b2tlbnMsIGNvbnRleHQsIHBhcnRpYWxzLCBvcmlnaW5hbFRlbXBsYXRlKSB7XG4gICAgdmFyIGJ1ZmZlciA9ICcnO1xuXG4gICAgdmFyIHRva2VuLCBzeW1ib2wsIHZhbHVlO1xuICAgIGZvciAodmFyIGkgPSAwLCBudW1Ub2tlbnMgPSB0b2tlbnMubGVuZ3RoOyBpIDwgbnVtVG9rZW5zOyArK2kpIHtcbiAgICAgIHZhbHVlID0gdW5kZWZpbmVkO1xuICAgICAgdG9rZW4gPSB0b2tlbnNbaV07XG4gICAgICBzeW1ib2wgPSB0b2tlblswXTtcblxuICAgICAgaWYgKHN5bWJvbCA9PT0gJyMnKSB2YWx1ZSA9IHRoaXMucmVuZGVyU2VjdGlvbih0b2tlbiwgY29udGV4dCwgcGFydGlhbHMsIG9yaWdpbmFsVGVtcGxhdGUpO1xuICAgICAgZWxzZSBpZiAoc3ltYm9sID09PSAnXicpIHZhbHVlID0gdGhpcy5yZW5kZXJJbnZlcnRlZCh0b2tlbiwgY29udGV4dCwgcGFydGlhbHMsIG9yaWdpbmFsVGVtcGxhdGUpO1xuICAgICAgZWxzZSBpZiAoc3ltYm9sID09PSAnPicpIHZhbHVlID0gdGhpcy5yZW5kZXJQYXJ0aWFsKHRva2VuLCBjb250ZXh0LCBwYXJ0aWFscywgb3JpZ2luYWxUZW1wbGF0ZSk7XG4gICAgICBlbHNlIGlmIChzeW1ib2wgPT09ICcmJykgdmFsdWUgPSB0aGlzLnVuZXNjYXBlZFZhbHVlKHRva2VuLCBjb250ZXh0KTtcbiAgICAgIGVsc2UgaWYgKHN5bWJvbCA9PT0gJ25hbWUnKSB2YWx1ZSA9IHRoaXMuZXNjYXBlZFZhbHVlKHRva2VuLCBjb250ZXh0KTtcbiAgICAgIGVsc2UgaWYgKHN5bWJvbCA9PT0gJ3RleHQnKSB2YWx1ZSA9IHRoaXMucmF3VmFsdWUodG9rZW4pO1xuXG4gICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZClcbiAgICAgICAgYnVmZmVyICs9IHZhbHVlO1xuICAgIH1cblxuICAgIHJldHVybiBidWZmZXI7XG4gIH07XG5cbiAgV3JpdGVyLnByb3RvdHlwZS5yZW5kZXJTZWN0aW9uID0gZnVuY3Rpb24gcmVuZGVyU2VjdGlvbiAodG9rZW4sIGNvbnRleHQsIHBhcnRpYWxzLCBvcmlnaW5hbFRlbXBsYXRlKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHZhciBidWZmZXIgPSAnJztcbiAgICB2YXIgdmFsdWUgPSBjb250ZXh0Lmxvb2t1cCh0b2tlblsxXSk7XG5cbiAgICAvLyBUaGlzIGZ1bmN0aW9uIGlzIHVzZWQgdG8gcmVuZGVyIGFuIGFyYml0cmFyeSB0ZW1wbGF0ZVxuICAgIC8vIGluIHRoZSBjdXJyZW50IGNvbnRleHQgYnkgaGlnaGVyLW9yZGVyIHNlY3Rpb25zLlxuICAgIGZ1bmN0aW9uIHN1YlJlbmRlciAodGVtcGxhdGUpIHtcbiAgICAgIHJldHVybiBzZWxmLnJlbmRlcih0ZW1wbGF0ZSwgY29udGV4dCwgcGFydGlhbHMpO1xuICAgIH1cblxuICAgIGlmICghdmFsdWUpIHJldHVybjtcblxuICAgIGlmIChpc0FycmF5KHZhbHVlKSkge1xuICAgICAgZm9yICh2YXIgaiA9IDAsIHZhbHVlTGVuZ3RoID0gdmFsdWUubGVuZ3RoOyBqIDwgdmFsdWVMZW5ndGg7ICsraikge1xuICAgICAgICBidWZmZXIgKz0gdGhpcy5yZW5kZXJUb2tlbnModG9rZW5bNF0sIGNvbnRleHQucHVzaCh2YWx1ZVtqXSksIHBhcnRpYWxzLCBvcmlnaW5hbFRlbXBsYXRlKTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgfHwgdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyB8fCB0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInKSB7XG4gICAgICBidWZmZXIgKz0gdGhpcy5yZW5kZXJUb2tlbnModG9rZW5bNF0sIGNvbnRleHQucHVzaCh2YWx1ZSksIHBhcnRpYWxzLCBvcmlnaW5hbFRlbXBsYXRlKTtcbiAgICB9IGVsc2UgaWYgKGlzRnVuY3Rpb24odmFsdWUpKSB7XG4gICAgICBpZiAodHlwZW9mIG9yaWdpbmFsVGVtcGxhdGUgIT09ICdzdHJpbmcnKVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCB1c2UgaGlnaGVyLW9yZGVyIHNlY3Rpb25zIHdpdGhvdXQgdGhlIG9yaWdpbmFsIHRlbXBsYXRlJyk7XG5cbiAgICAgIC8vIEV4dHJhY3QgdGhlIHBvcnRpb24gb2YgdGhlIG9yaWdpbmFsIHRlbXBsYXRlIHRoYXQgdGhlIHNlY3Rpb24gY29udGFpbnMuXG4gICAgICB2YWx1ZSA9IHZhbHVlLmNhbGwoY29udGV4dC52aWV3LCBvcmlnaW5hbFRlbXBsYXRlLnNsaWNlKHRva2VuWzNdLCB0b2tlbls1XSksIHN1YlJlbmRlcik7XG5cbiAgICAgIGlmICh2YWx1ZSAhPSBudWxsKVxuICAgICAgICBidWZmZXIgKz0gdmFsdWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIGJ1ZmZlciArPSB0aGlzLnJlbmRlclRva2Vucyh0b2tlbls0XSwgY29udGV4dCwgcGFydGlhbHMsIG9yaWdpbmFsVGVtcGxhdGUpO1xuICAgIH1cbiAgICByZXR1cm4gYnVmZmVyO1xuICB9O1xuXG4gIFdyaXRlci5wcm90b3R5cGUucmVuZGVySW52ZXJ0ZWQgPSBmdW5jdGlvbiByZW5kZXJJbnZlcnRlZCAodG9rZW4sIGNvbnRleHQsIHBhcnRpYWxzLCBvcmlnaW5hbFRlbXBsYXRlKSB7XG4gICAgdmFyIHZhbHVlID0gY29udGV4dC5sb29rdXAodG9rZW5bMV0pO1xuXG4gICAgLy8gVXNlIEphdmFTY3JpcHQncyBkZWZpbml0aW9uIG9mIGZhbHN5LiBJbmNsdWRlIGVtcHR5IGFycmF5cy5cbiAgICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2phbmwvbXVzdGFjaGUuanMvaXNzdWVzLzE4NlxuICAgIGlmICghdmFsdWUgfHwgKGlzQXJyYXkodmFsdWUpICYmIHZhbHVlLmxlbmd0aCA9PT0gMCkpXG4gICAgICByZXR1cm4gdGhpcy5yZW5kZXJUb2tlbnModG9rZW5bNF0sIGNvbnRleHQsIHBhcnRpYWxzLCBvcmlnaW5hbFRlbXBsYXRlKTtcbiAgfTtcblxuICBXcml0ZXIucHJvdG90eXBlLnJlbmRlclBhcnRpYWwgPSBmdW5jdGlvbiByZW5kZXJQYXJ0aWFsICh0b2tlbiwgY29udGV4dCwgcGFydGlhbHMpIHtcbiAgICBpZiAoIXBhcnRpYWxzKSByZXR1cm47XG5cbiAgICB2YXIgdmFsdWUgPSBpc0Z1bmN0aW9uKHBhcnRpYWxzKSA/IHBhcnRpYWxzKHRva2VuWzFdKSA6IHBhcnRpYWxzW3Rva2VuWzFdXTtcbiAgICBpZiAodmFsdWUgIT0gbnVsbClcbiAgICAgIHJldHVybiB0aGlzLnJlbmRlclRva2Vucyh0aGlzLnBhcnNlKHZhbHVlKSwgY29udGV4dCwgcGFydGlhbHMsIHZhbHVlKTtcbiAgfTtcblxuICBXcml0ZXIucHJvdG90eXBlLnVuZXNjYXBlZFZhbHVlID0gZnVuY3Rpb24gdW5lc2NhcGVkVmFsdWUgKHRva2VuLCBjb250ZXh0KSB7XG4gICAgdmFyIHZhbHVlID0gY29udGV4dC5sb29rdXAodG9rZW5bMV0pO1xuICAgIGlmICh2YWx1ZSAhPSBudWxsKVxuICAgICAgcmV0dXJuIHZhbHVlO1xuICB9O1xuXG4gIFdyaXRlci5wcm90b3R5cGUuZXNjYXBlZFZhbHVlID0gZnVuY3Rpb24gZXNjYXBlZFZhbHVlICh0b2tlbiwgY29udGV4dCkge1xuICAgIHZhciB2YWx1ZSA9IGNvbnRleHQubG9va3VwKHRva2VuWzFdKTtcbiAgICBpZiAodmFsdWUgIT0gbnVsbClcbiAgICAgIHJldHVybiBtdXN0YWNoZS5lc2NhcGUodmFsdWUpO1xuICB9O1xuXG4gIFdyaXRlci5wcm90b3R5cGUucmF3VmFsdWUgPSBmdW5jdGlvbiByYXdWYWx1ZSAodG9rZW4pIHtcbiAgICByZXR1cm4gdG9rZW5bMV07XG4gIH07XG5cbiAgbXVzdGFjaGUubmFtZSA9ICdtdXN0YWNoZS5qcyc7XG4gIG11c3RhY2hlLnZlcnNpb24gPSAnMi4yLjEnO1xuICBtdXN0YWNoZS50YWdzID0gWyAne3snLCAnfX0nIF07XG5cbiAgLy8gQWxsIGhpZ2gtbGV2ZWwgbXVzdGFjaGUuKiBmdW5jdGlvbnMgdXNlIHRoaXMgd3JpdGVyLlxuICB2YXIgZGVmYXVsdFdyaXRlciA9IG5ldyBXcml0ZXIoKTtcblxuICAvKipcbiAgICogQ2xlYXJzIGFsbCBjYWNoZWQgdGVtcGxhdGVzIGluIHRoZSBkZWZhdWx0IHdyaXRlci5cbiAgICovXG4gIG11c3RhY2hlLmNsZWFyQ2FjaGUgPSBmdW5jdGlvbiBjbGVhckNhY2hlICgpIHtcbiAgICByZXR1cm4gZGVmYXVsdFdyaXRlci5jbGVhckNhY2hlKCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFBhcnNlcyBhbmQgY2FjaGVzIHRoZSBnaXZlbiB0ZW1wbGF0ZSBpbiB0aGUgZGVmYXVsdCB3cml0ZXIgYW5kIHJldHVybnMgdGhlXG4gICAqIGFycmF5IG9mIHRva2VucyBpdCBjb250YWlucy4gRG9pbmcgdGhpcyBhaGVhZCBvZiB0aW1lIGF2b2lkcyB0aGUgbmVlZCB0b1xuICAgKiBwYXJzZSB0ZW1wbGF0ZXMgb24gdGhlIGZseSBhcyB0aGV5IGFyZSByZW5kZXJlZC5cbiAgICovXG4gIG11c3RhY2hlLnBhcnNlID0gZnVuY3Rpb24gcGFyc2UgKHRlbXBsYXRlLCB0YWdzKSB7XG4gICAgcmV0dXJuIGRlZmF1bHRXcml0ZXIucGFyc2UodGVtcGxhdGUsIHRhZ3MpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBSZW5kZXJzIHRoZSBgdGVtcGxhdGVgIHdpdGggdGhlIGdpdmVuIGB2aWV3YCBhbmQgYHBhcnRpYWxzYCB1c2luZyB0aGVcbiAgICogZGVmYXVsdCB3cml0ZXIuXG4gICAqL1xuICBtdXN0YWNoZS5yZW5kZXIgPSBmdW5jdGlvbiByZW5kZXIgKHRlbXBsYXRlLCB2aWV3LCBwYXJ0aWFscykge1xuICAgIGlmICh0eXBlb2YgdGVtcGxhdGUgIT09ICdzdHJpbmcnKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIHRlbXBsYXRlISBUZW1wbGF0ZSBzaG91bGQgYmUgYSBcInN0cmluZ1wiICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAnYnV0IFwiJyArIHR5cGVTdHIodGVtcGxhdGUpICsgJ1wiIHdhcyBnaXZlbiBhcyB0aGUgZmlyc3QgJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICdhcmd1bWVudCBmb3IgbXVzdGFjaGUjcmVuZGVyKHRlbXBsYXRlLCB2aWV3LCBwYXJ0aWFscyknKTtcbiAgICB9XG5cbiAgICByZXR1cm4gZGVmYXVsdFdyaXRlci5yZW5kZXIodGVtcGxhdGUsIHZpZXcsIHBhcnRpYWxzKTtcbiAgfTtcblxuICAvLyBUaGlzIGlzIGhlcmUgZm9yIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5IHdpdGggMC40LnguLFxuICAvKmVzbGludC1kaXNhYmxlICovIC8vIGVzbGludCB3YW50cyBjYW1lbCBjYXNlZCBmdW5jdGlvbiBuYW1lXG4gIG11c3RhY2hlLnRvX2h0bWwgPSBmdW5jdGlvbiB0b19odG1sICh0ZW1wbGF0ZSwgdmlldywgcGFydGlhbHMsIHNlbmQpIHtcbiAgICAvKmVzbGludC1lbmFibGUqL1xuXG4gICAgdmFyIHJlc3VsdCA9IG11c3RhY2hlLnJlbmRlcih0ZW1wbGF0ZSwgdmlldywgcGFydGlhbHMpO1xuXG4gICAgaWYgKGlzRnVuY3Rpb24oc2VuZCkpIHtcbiAgICAgIHNlbmQocmVzdWx0KTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gIH07XG5cbiAgLy8gRXhwb3J0IHRoZSBlc2NhcGluZyBmdW5jdGlvbiBzbyB0aGF0IHRoZSB1c2VyIG1heSBvdmVycmlkZSBpdC5cbiAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9qYW5sL211c3RhY2hlLmpzL2lzc3Vlcy8yNDRcbiAgbXVzdGFjaGUuZXNjYXBlID0gZXNjYXBlSHRtbDtcblxuICAvLyBFeHBvcnQgdGhlc2UgbWFpbmx5IGZvciB0ZXN0aW5nLCBidXQgYWxzbyBmb3IgYWR2YW5jZWQgdXNhZ2UuXG4gIG11c3RhY2hlLlNjYW5uZXIgPSBTY2FubmVyO1xuICBtdXN0YWNoZS5Db250ZXh0ID0gQ29udGV4dDtcbiAgbXVzdGFjaGUuV3JpdGVyID0gV3JpdGVyO1xuXG59KSk7XG4iLCIvKiFcbiAqIFplcm9DbGlwYm9hcmRcbiAqIFRoZSBaZXJvQ2xpcGJvYXJkIGxpYnJhcnkgcHJvdmlkZXMgYW4gZWFzeSB3YXkgdG8gY29weSB0ZXh0IHRvIHRoZSBjbGlwYm9hcmQgdXNpbmcgYW4gaW52aXNpYmxlIEFkb2JlIEZsYXNoIG1vdmllIGFuZCBhIEphdmFTY3JpcHQgaW50ZXJmYWNlLlxuICogQ29weXJpZ2h0IChjKSAyMDA5LTIwMTQgSm9uIFJvaGFuLCBKYW1lcyBNLiBHcmVlbmVcbiAqIExpY2Vuc2VkIE1JVFxuICogaHR0cDovL3plcm9jbGlwYm9hcmQub3JnL1xuICogdjIuMi4wXG4gKi9cbihmdW5jdGlvbih3aW5kb3csIHVuZGVmaW5lZCkge1xuICBcInVzZSBzdHJpY3RcIjtcbiAgLyoqXG4gKiBTdG9yZSByZWZlcmVuY2VzIHRvIGNyaXRpY2FsbHkgaW1wb3J0YW50IGdsb2JhbCBmdW5jdGlvbnMgdGhhdCBtYXkgYmVcbiAqIG92ZXJyaWRkZW4gb24gY2VydGFpbiB3ZWIgcGFnZXMuXG4gKi9cbiAgdmFyIF93aW5kb3cgPSB3aW5kb3csIF9kb2N1bWVudCA9IF93aW5kb3cuZG9jdW1lbnQsIF9uYXZpZ2F0b3IgPSBfd2luZG93Lm5hdmlnYXRvciwgX3NldFRpbWVvdXQgPSBfd2luZG93LnNldFRpbWVvdXQsIF9jbGVhclRpbWVvdXQgPSBfd2luZG93LmNsZWFyVGltZW91dCwgX3NldEludGVydmFsID0gX3dpbmRvdy5zZXRJbnRlcnZhbCwgX2NsZWFySW50ZXJ2YWwgPSBfd2luZG93LmNsZWFySW50ZXJ2YWwsIF9nZXRDb21wdXRlZFN0eWxlID0gX3dpbmRvdy5nZXRDb21wdXRlZFN0eWxlLCBfZW5jb2RlVVJJQ29tcG9uZW50ID0gX3dpbmRvdy5lbmNvZGVVUklDb21wb25lbnQsIF9BY3RpdmVYT2JqZWN0ID0gX3dpbmRvdy5BY3RpdmVYT2JqZWN0LCBfRXJyb3IgPSBfd2luZG93LkVycm9yLCBfcGFyc2VJbnQgPSBfd2luZG93Lk51bWJlci5wYXJzZUludCB8fCBfd2luZG93LnBhcnNlSW50LCBfcGFyc2VGbG9hdCA9IF93aW5kb3cuTnVtYmVyLnBhcnNlRmxvYXQgfHwgX3dpbmRvdy5wYXJzZUZsb2F0LCBfaXNOYU4gPSBfd2luZG93Lk51bWJlci5pc05hTiB8fCBfd2luZG93LmlzTmFOLCBfbm93ID0gX3dpbmRvdy5EYXRlLm5vdywgX2tleXMgPSBfd2luZG93Lk9iamVjdC5rZXlzLCBfZGVmaW5lUHJvcGVydHkgPSBfd2luZG93Lk9iamVjdC5kZWZpbmVQcm9wZXJ0eSwgX2hhc093biA9IF93aW5kb3cuT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eSwgX3NsaWNlID0gX3dpbmRvdy5BcnJheS5wcm90b3R5cGUuc2xpY2UsIF91bndyYXAgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgdW53cmFwcGVyID0gZnVuY3Rpb24oZWwpIHtcbiAgICAgIHJldHVybiBlbDtcbiAgICB9O1xuICAgIGlmICh0eXBlb2YgX3dpbmRvdy53cmFwID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIF93aW5kb3cudW53cmFwID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHZhciBkaXYgPSBfZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgdmFyIHVud3JhcHBlZERpdiA9IF93aW5kb3cudW53cmFwKGRpdik7XG4gICAgICAgIGlmIChkaXYubm9kZVR5cGUgPT09IDEgJiYgdW53cmFwcGVkRGl2ICYmIHVud3JhcHBlZERpdi5ub2RlVHlwZSA9PT0gMSkge1xuICAgICAgICAgIHVud3JhcHBlciA9IF93aW5kb3cudW53cmFwO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlKSB7fVxuICAgIH1cbiAgICByZXR1cm4gdW53cmFwcGVyO1xuICB9KCk7XG4gIC8qKlxuICogQ29udmVydCBhbiBgYXJndW1lbnRzYCBvYmplY3QgaW50byBhbiBBcnJheS5cbiAqXG4gKiBAcmV0dXJucyBUaGUgYXJndW1lbnRzIGFzIGFuIEFycmF5XG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfYXJncyA9IGZ1bmN0aW9uKGFyZ3VtZW50c09iaikge1xuICAgIHJldHVybiBfc2xpY2UuY2FsbChhcmd1bWVudHNPYmosIDApO1xuICB9O1xuICAvKipcbiAqIFNoYWxsb3ctY29weSB0aGUgb3duZWQsIGVudW1lcmFibGUgcHJvcGVydGllcyBvZiBvbmUgb2JqZWN0IG92ZXIgdG8gYW5vdGhlciwgc2ltaWxhciB0byBqUXVlcnkncyBgJC5leHRlbmRgLlxuICpcbiAqIEByZXR1cm5zIFRoZSB0YXJnZXQgb2JqZWN0LCBhdWdtZW50ZWRcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9leHRlbmQgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgaSwgbGVuLCBhcmcsIHByb3AsIHNyYywgY29weSwgYXJncyA9IF9hcmdzKGFyZ3VtZW50cyksIHRhcmdldCA9IGFyZ3NbMF0gfHwge307XG4gICAgZm9yIChpID0gMSwgbGVuID0gYXJncy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgaWYgKChhcmcgPSBhcmdzW2ldKSAhPSBudWxsKSB7XG4gICAgICAgIGZvciAocHJvcCBpbiBhcmcpIHtcbiAgICAgICAgICBpZiAoX2hhc093bi5jYWxsKGFyZywgcHJvcCkpIHtcbiAgICAgICAgICAgIHNyYyA9IHRhcmdldFtwcm9wXTtcbiAgICAgICAgICAgIGNvcHkgPSBhcmdbcHJvcF07XG4gICAgICAgICAgICBpZiAodGFyZ2V0ICE9PSBjb3B5ICYmIGNvcHkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICB0YXJnZXRbcHJvcF0gPSBjb3B5O1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGFyZ2V0O1xuICB9O1xuICAvKipcbiAqIFJldHVybiBhIGRlZXAgY29weSBvZiB0aGUgc291cmNlIG9iamVjdCBvciBhcnJheS5cbiAqXG4gKiBAcmV0dXJucyBPYmplY3Qgb3IgQXJyYXlcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9kZWVwQ29weSA9IGZ1bmN0aW9uKHNvdXJjZSkge1xuICAgIHZhciBjb3B5LCBpLCBsZW4sIHByb3A7XG4gICAgaWYgKHR5cGVvZiBzb3VyY2UgIT09IFwib2JqZWN0XCIgfHwgc291cmNlID09IG51bGwgfHwgdHlwZW9mIHNvdXJjZS5ub2RlVHlwZSA9PT0gXCJudW1iZXJcIikge1xuICAgICAgY29weSA9IHNvdXJjZTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBzb3VyY2UubGVuZ3RoID09PSBcIm51bWJlclwiKSB7XG4gICAgICBjb3B5ID0gW107XG4gICAgICBmb3IgKGkgPSAwLCBsZW4gPSBzb3VyY2UubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgaWYgKF9oYXNPd24uY2FsbChzb3VyY2UsIGkpKSB7XG4gICAgICAgICAgY29weVtpXSA9IF9kZWVwQ29weShzb3VyY2VbaV0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvcHkgPSB7fTtcbiAgICAgIGZvciAocHJvcCBpbiBzb3VyY2UpIHtcbiAgICAgICAgaWYgKF9oYXNPd24uY2FsbChzb3VyY2UsIHByb3ApKSB7XG4gICAgICAgICAgY29weVtwcm9wXSA9IF9kZWVwQ29weShzb3VyY2VbcHJvcF0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBjb3B5O1xuICB9O1xuICAvKipcbiAqIE1ha2VzIGEgc2hhbGxvdyBjb3B5IG9mIGBvYmpgIChsaWtlIGBfZXh0ZW5kYCkgYnV0IGZpbHRlcnMgaXRzIHByb3BlcnRpZXMgYmFzZWQgb24gYSBsaXN0IG9mIGBrZXlzYCB0byBrZWVwLlxuICogVGhlIGludmVyc2Ugb2YgYF9vbWl0YCwgbW9zdGx5LiBUaGUgYmlnIGRpZmZlcmVuY2UgaXMgdGhhdCB0aGVzZSBwcm9wZXJ0aWVzIGRvIE5PVCBuZWVkIHRvIGJlIGVudW1lcmFibGUgdG9cbiAqIGJlIGtlcHQuXG4gKlxuICogQHJldHVybnMgQSBuZXcgZmlsdGVyZWQgb2JqZWN0LlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX3BpY2sgPSBmdW5jdGlvbihvYmosIGtleXMpIHtcbiAgICB2YXIgbmV3T2JqID0ge307XG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGtleXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgIGlmIChrZXlzW2ldIGluIG9iaikge1xuICAgICAgICBuZXdPYmpba2V5c1tpXV0gPSBvYmpba2V5c1tpXV07XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBuZXdPYmo7XG4gIH07XG4gIC8qKlxuICogTWFrZXMgYSBzaGFsbG93IGNvcHkgb2YgYG9iamAgKGxpa2UgYF9leHRlbmRgKSBidXQgZmlsdGVycyBpdHMgcHJvcGVydGllcyBiYXNlZCBvbiBhIGxpc3Qgb2YgYGtleXNgIHRvIG9taXQuXG4gKiBUaGUgaW52ZXJzZSBvZiBgX3BpY2tgLlxuICpcbiAqIEByZXR1cm5zIEEgbmV3IGZpbHRlcmVkIG9iamVjdC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9vbWl0ID0gZnVuY3Rpb24ob2JqLCBrZXlzKSB7XG4gICAgdmFyIG5ld09iaiA9IHt9O1xuICAgIGZvciAodmFyIHByb3AgaW4gb2JqKSB7XG4gICAgICBpZiAoa2V5cy5pbmRleE9mKHByb3ApID09PSAtMSkge1xuICAgICAgICBuZXdPYmpbcHJvcF0gPSBvYmpbcHJvcF07XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBuZXdPYmo7XG4gIH07XG4gIC8qKlxuICogUmVtb3ZlIGFsbCBvd25lZCwgZW51bWVyYWJsZSBwcm9wZXJ0aWVzIGZyb20gYW4gb2JqZWN0LlxuICpcbiAqIEByZXR1cm5zIFRoZSBvcmlnaW5hbCBvYmplY3Qgd2l0aG91dCBpdHMgb3duZWQsIGVudW1lcmFibGUgcHJvcGVydGllcy5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9kZWxldGVPd25Qcm9wZXJ0aWVzID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgaWYgKG9iaikge1xuICAgICAgZm9yICh2YXIgcHJvcCBpbiBvYmopIHtcbiAgICAgICAgaWYgKF9oYXNPd24uY2FsbChvYmosIHByb3ApKSB7XG4gICAgICAgICAgZGVsZXRlIG9ialtwcm9wXTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gb2JqO1xuICB9O1xuICAvKipcbiAqIERldGVybWluZSBpZiBhbiBlbGVtZW50IGlzIGNvbnRhaW5lZCB3aXRoaW4gYW5vdGhlciBlbGVtZW50LlxuICpcbiAqIEByZXR1cm5zIEJvb2xlYW5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9jb250YWluZWRCeSA9IGZ1bmN0aW9uKGVsLCBhbmNlc3RvckVsKSB7XG4gICAgaWYgKGVsICYmIGVsLm5vZGVUeXBlID09PSAxICYmIGVsLm93bmVyRG9jdW1lbnQgJiYgYW5jZXN0b3JFbCAmJiAoYW5jZXN0b3JFbC5ub2RlVHlwZSA9PT0gMSAmJiBhbmNlc3RvckVsLm93bmVyRG9jdW1lbnQgJiYgYW5jZXN0b3JFbC5vd25lckRvY3VtZW50ID09PSBlbC5vd25lckRvY3VtZW50IHx8IGFuY2VzdG9yRWwubm9kZVR5cGUgPT09IDkgJiYgIWFuY2VzdG9yRWwub3duZXJEb2N1bWVudCAmJiBhbmNlc3RvckVsID09PSBlbC5vd25lckRvY3VtZW50KSkge1xuICAgICAgZG8ge1xuICAgICAgICBpZiAoZWwgPT09IGFuY2VzdG9yRWwpIHtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbCA9IGVsLnBhcmVudE5vZGU7XG4gICAgICB9IHdoaWxlIChlbCk7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcbiAgLyoqXG4gKiBHZXQgdGhlIFVSTCBwYXRoJ3MgcGFyZW50IGRpcmVjdG9yeS5cbiAqXG4gKiBAcmV0dXJucyBTdHJpbmcgb3IgYHVuZGVmaW5lZGBcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9nZXREaXJQYXRoT2ZVcmwgPSBmdW5jdGlvbih1cmwpIHtcbiAgICB2YXIgZGlyO1xuICAgIGlmICh0eXBlb2YgdXJsID09PSBcInN0cmluZ1wiICYmIHVybCkge1xuICAgICAgZGlyID0gdXJsLnNwbGl0KFwiI1wiKVswXS5zcGxpdChcIj9cIilbMF07XG4gICAgICBkaXIgPSB1cmwuc2xpY2UoMCwgdXJsLmxhc3RJbmRleE9mKFwiL1wiKSArIDEpO1xuICAgIH1cbiAgICByZXR1cm4gZGlyO1xuICB9O1xuICAvKipcbiAqIEdldCB0aGUgY3VycmVudCBzY3JpcHQncyBVUkwgYnkgdGhyb3dpbmcgYW4gYEVycm9yYCBhbmQgYW5hbHl6aW5nIGl0LlxuICpcbiAqIEByZXR1cm5zIFN0cmluZyBvciBgdW5kZWZpbmVkYFxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2dldEN1cnJlbnRTY3JpcHRVcmxGcm9tRXJyb3JTdGFjayA9IGZ1bmN0aW9uKHN0YWNrKSB7XG4gICAgdmFyIHVybCwgbWF0Y2hlcztcbiAgICBpZiAodHlwZW9mIHN0YWNrID09PSBcInN0cmluZ1wiICYmIHN0YWNrKSB7XG4gICAgICBtYXRjaGVzID0gc3RhY2subWF0Y2goL14oPzp8W146QF0qQHwuK1xcKUAoPz1odHRwW3NdP3xmaWxlKXwuKz9cXHMrKD86IGF0IHxAKSg/OlteOlxcKF0rICkqW1xcKF0/KSgoPzpodHRwW3NdP3xmaWxlKTpcXC9cXC9bXFwvXT8uKz9cXC9bXjpcXCldKj8pKD86OlxcZCspKD86OlxcZCspPy8pO1xuICAgICAgaWYgKG1hdGNoZXMgJiYgbWF0Y2hlc1sxXSkge1xuICAgICAgICB1cmwgPSBtYXRjaGVzWzFdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbWF0Y2hlcyA9IHN0YWNrLm1hdGNoKC9cXClAKCg/Omh0dHBbc10/fGZpbGUpOlxcL1xcL1tcXC9dPy4rP1xcL1teOlxcKV0qPykoPzo6XFxkKykoPzo6XFxkKyk/Lyk7XG4gICAgICAgIGlmIChtYXRjaGVzICYmIG1hdGNoZXNbMV0pIHtcbiAgICAgICAgICB1cmwgPSBtYXRjaGVzWzFdO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB1cmw7XG4gIH07XG4gIC8qKlxuICogR2V0IHRoZSBjdXJyZW50IHNjcmlwdCdzIFVSTCBieSB0aHJvd2luZyBhbiBgRXJyb3JgIGFuZCBhbmFseXppbmcgaXQuXG4gKlxuICogQHJldHVybnMgU3RyaW5nIG9yIGB1bmRlZmluZWRgXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZ2V0Q3VycmVudFNjcmlwdFVybEZyb21FcnJvciA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciB1cmwsIGVycjtcbiAgICB0cnkge1xuICAgICAgdGhyb3cgbmV3IF9FcnJvcigpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGVyciA9IGU7XG4gICAgfVxuICAgIGlmIChlcnIpIHtcbiAgICAgIHVybCA9IGVyci5zb3VyY2VVUkwgfHwgZXJyLmZpbGVOYW1lIHx8IF9nZXRDdXJyZW50U2NyaXB0VXJsRnJvbUVycm9yU3RhY2soZXJyLnN0YWNrKTtcbiAgICB9XG4gICAgcmV0dXJuIHVybDtcbiAgfTtcbiAgLyoqXG4gKiBHZXQgdGhlIGN1cnJlbnQgc2NyaXB0J3MgVVJMLlxuICpcbiAqIEByZXR1cm5zIFN0cmluZyBvciBgdW5kZWZpbmVkYFxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2dldEN1cnJlbnRTY3JpcHRVcmwgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIganNQYXRoLCBzY3JpcHRzLCBpO1xuICAgIGlmIChfZG9jdW1lbnQuY3VycmVudFNjcmlwdCAmJiAoanNQYXRoID0gX2RvY3VtZW50LmN1cnJlbnRTY3JpcHQuc3JjKSkge1xuICAgICAgcmV0dXJuIGpzUGF0aDtcbiAgICB9XG4gICAgc2NyaXB0cyA9IF9kb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcInNjcmlwdFwiKTtcbiAgICBpZiAoc2NyaXB0cy5sZW5ndGggPT09IDEpIHtcbiAgICAgIHJldHVybiBzY3JpcHRzWzBdLnNyYyB8fCB1bmRlZmluZWQ7XG4gICAgfVxuICAgIGlmIChcInJlYWR5U3RhdGVcIiBpbiBzY3JpcHRzWzBdKSB7XG4gICAgICBmb3IgKGkgPSBzY3JpcHRzLmxlbmd0aDsgaS0tOyApIHtcbiAgICAgICAgaWYgKHNjcmlwdHNbaV0ucmVhZHlTdGF0ZSA9PT0gXCJpbnRlcmFjdGl2ZVwiICYmIChqc1BhdGggPSBzY3JpcHRzW2ldLnNyYykpIHtcbiAgICAgICAgICByZXR1cm4ganNQYXRoO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChfZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gXCJsb2FkaW5nXCIgJiYgKGpzUGF0aCA9IHNjcmlwdHNbc2NyaXB0cy5sZW5ndGggLSAxXS5zcmMpKSB7XG4gICAgICByZXR1cm4ganNQYXRoO1xuICAgIH1cbiAgICBpZiAoanNQYXRoID0gX2dldEN1cnJlbnRTY3JpcHRVcmxGcm9tRXJyb3IoKSkge1xuICAgICAgcmV0dXJuIGpzUGF0aDtcbiAgICB9XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfTtcbiAgLyoqXG4gKiBHZXQgdGhlIHVuYW5pbW91cyBwYXJlbnQgZGlyZWN0b3J5IG9mIEFMTCBzY3JpcHQgdGFncy5cbiAqIElmIGFueSBzY3JpcHQgdGFncyBhcmUgZWl0aGVyIChhKSBpbmxpbmUgb3IgKGIpIGZyb20gZGlmZmVyaW5nIHBhcmVudFxuICogZGlyZWN0b3JpZXMsIHRoaXMgbWV0aG9kIG11c3QgcmV0dXJuIGB1bmRlZmluZWRgLlxuICpcbiAqIEByZXR1cm5zIFN0cmluZyBvciBgdW5kZWZpbmVkYFxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2dldFVuYW5pbW91c1NjcmlwdFBhcmVudERpciA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBpLCBqc0RpciwganNQYXRoLCBzY3JpcHRzID0gX2RvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwic2NyaXB0XCIpO1xuICAgIGZvciAoaSA9IHNjcmlwdHMubGVuZ3RoOyBpLS07ICkge1xuICAgICAgaWYgKCEoanNQYXRoID0gc2NyaXB0c1tpXS5zcmMpKSB7XG4gICAgICAgIGpzRGlyID0gbnVsbDtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBqc1BhdGggPSBfZ2V0RGlyUGF0aE9mVXJsKGpzUGF0aCk7XG4gICAgICBpZiAoanNEaXIgPT0gbnVsbCkge1xuICAgICAgICBqc0RpciA9IGpzUGF0aDtcbiAgICAgIH0gZWxzZSBpZiAoanNEaXIgIT09IGpzUGF0aCkge1xuICAgICAgICBqc0RpciA9IG51bGw7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4ganNEaXIgfHwgdW5kZWZpbmVkO1xuICB9O1xuICAvKipcbiAqIEdldCB0aGUgcHJlc3VtZWQgbG9jYXRpb24gb2YgdGhlIFwiWmVyb0NsaXBib2FyZC5zd2ZcIiBmaWxlLCBiYXNlZCBvbiB0aGUgbG9jYXRpb25cbiAqIG9mIHRoZSBleGVjdXRpbmcgSmF2YVNjcmlwdCBmaWxlIChlLmcuIFwiWmVyb0NsaXBib2FyZC5qc1wiLCBldGMuKS5cbiAqXG4gKiBAcmV0dXJucyBTdHJpbmdcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9nZXREZWZhdWx0U3dmUGF0aCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBqc0RpciA9IF9nZXREaXJQYXRoT2ZVcmwoX2dldEN1cnJlbnRTY3JpcHRVcmwoKSkgfHwgX2dldFVuYW5pbW91c1NjcmlwdFBhcmVudERpcigpIHx8IFwiXCI7XG4gICAgcmV0dXJuIGpzRGlyICsgXCJaZXJvQ2xpcGJvYXJkLnN3ZlwiO1xuICB9O1xuICAvKipcbiAqIEtlZXAgdHJhY2sgb2YgaWYgdGhlIHBhZ2UgaXMgZnJhbWVkIChpbiBhbiBgaWZyYW1lYCkuIFRoaXMgY2FuIG5ldmVyIGNoYW5nZS5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9wYWdlSXNGcmFtZWQgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gd2luZG93Lm9wZW5lciA9PSBudWxsICYmICghIXdpbmRvdy50b3AgJiYgd2luZG93ICE9IHdpbmRvdy50b3AgfHwgISF3aW5kb3cucGFyZW50ICYmIHdpbmRvdyAhPSB3aW5kb3cucGFyZW50KTtcbiAgfSgpO1xuICAvKipcbiAqIEtlZXAgdHJhY2sgb2YgdGhlIHN0YXRlIG9mIHRoZSBGbGFzaCBvYmplY3QuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZmxhc2hTdGF0ZSA9IHtcbiAgICBicmlkZ2U6IG51bGwsXG4gICAgdmVyc2lvbjogXCIwLjAuMFwiLFxuICAgIHBsdWdpblR5cGU6IFwidW5rbm93blwiLFxuICAgIGRpc2FibGVkOiBudWxsLFxuICAgIG91dGRhdGVkOiBudWxsLFxuICAgIHNhbmRib3hlZDogbnVsbCxcbiAgICB1bmF2YWlsYWJsZTogbnVsbCxcbiAgICBkZWdyYWRlZDogbnVsbCxcbiAgICBkZWFjdGl2YXRlZDogbnVsbCxcbiAgICBvdmVyZHVlOiBudWxsLFxuICAgIHJlYWR5OiBudWxsXG4gIH07XG4gIC8qKlxuICogVGhlIG1pbmltdW0gRmxhc2ggUGxheWVyIHZlcnNpb24gcmVxdWlyZWQgdG8gdXNlIFplcm9DbGlwYm9hcmQgY29tcGxldGVseS5cbiAqIEByZWFkb25seVxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX21pbmltdW1GbGFzaFZlcnNpb24gPSBcIjExLjAuMFwiO1xuICAvKipcbiAqIFRoZSBaZXJvQ2xpcGJvYXJkIGxpYnJhcnkgdmVyc2lvbiBudW1iZXIsIGFzIHJlcG9ydGVkIGJ5IEZsYXNoLCBhdCB0aGUgdGltZSB0aGUgU1dGIHdhcyBjb21waWxlZC5cbiAqL1xuICB2YXIgX3pjU3dmVmVyc2lvbjtcbiAgLyoqXG4gKiBLZWVwIHRyYWNrIG9mIGFsbCBldmVudCBsaXN0ZW5lciByZWdpc3RyYXRpb25zLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2hhbmRsZXJzID0ge307XG4gIC8qKlxuICogS2VlcCB0cmFjayBvZiB0aGUgY3VycmVudGx5IGFjdGl2YXRlZCBlbGVtZW50LlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2N1cnJlbnRFbGVtZW50O1xuICAvKipcbiAqIEtlZXAgdHJhY2sgb2YgdGhlIGVsZW1lbnQgdGhhdCB3YXMgYWN0aXZhdGVkIHdoZW4gYSBgY29weWAgcHJvY2VzcyBzdGFydGVkLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2NvcHlUYXJnZXQ7XG4gIC8qKlxuICogS2VlcCB0cmFjayBvZiBkYXRhIGZvciB0aGUgcGVuZGluZyBjbGlwYm9hcmQgdHJhbnNhY3Rpb24uXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY2xpcERhdGEgPSB7fTtcbiAgLyoqXG4gKiBLZWVwIHRyYWNrIG9mIGRhdGEgZm9ybWF0cyBmb3IgdGhlIHBlbmRpbmcgY2xpcGJvYXJkIHRyYW5zYWN0aW9uLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2NsaXBEYXRhRm9ybWF0TWFwID0gbnVsbDtcbiAgLyoqXG4gKiBLZWVwIHRyYWNrIG9mIHRoZSBGbGFzaCBhdmFpbGFiaWxpdHkgY2hlY2sgdGltZW91dC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9mbGFzaENoZWNrVGltZW91dCA9IDA7XG4gIC8qKlxuICogS2VlcCB0cmFjayBvZiBTV0YgbmV0d29yayBlcnJvcnMgaW50ZXJ2YWwgcG9sbGluZy5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9zd2ZGYWxsYmFja0NoZWNrSW50ZXJ2YWwgPSAwO1xuICAvKipcbiAqIFRoZSBgbWVzc2FnZWAgc3RvcmUgZm9yIGV2ZW50c1xuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2V2ZW50TWVzc2FnZXMgPSB7XG4gICAgcmVhZHk6IFwiRmxhc2ggY29tbXVuaWNhdGlvbiBpcyBlc3RhYmxpc2hlZFwiLFxuICAgIGVycm9yOiB7XG4gICAgICBcImZsYXNoLWRpc2FibGVkXCI6IFwiRmxhc2ggaXMgZGlzYWJsZWQgb3Igbm90IGluc3RhbGxlZC4gTWF5IGFsc28gYmUgYXR0ZW1wdGluZyB0byBydW4gRmxhc2ggaW4gYSBzYW5kYm94ZWQgaWZyYW1lLCB3aGljaCBpcyBpbXBvc3NpYmxlLlwiLFxuICAgICAgXCJmbGFzaC1vdXRkYXRlZFwiOiBcIkZsYXNoIGlzIHRvbyBvdXRkYXRlZCB0byBzdXBwb3J0IFplcm9DbGlwYm9hcmRcIixcbiAgICAgIFwiZmxhc2gtc2FuZGJveGVkXCI6IFwiQXR0ZW1wdGluZyB0byBydW4gRmxhc2ggaW4gYSBzYW5kYm94ZWQgaWZyYW1lLCB3aGljaCBpcyBpbXBvc3NpYmxlXCIsXG4gICAgICBcImZsYXNoLXVuYXZhaWxhYmxlXCI6IFwiRmxhc2ggaXMgdW5hYmxlIHRvIGNvbW11bmljYXRlIGJpZGlyZWN0aW9uYWxseSB3aXRoIEphdmFTY3JpcHRcIixcbiAgICAgIFwiZmxhc2gtZGVncmFkZWRcIjogXCJGbGFzaCBpcyB1bmFibGUgdG8gcHJlc2VydmUgZGF0YSBmaWRlbGl0eSB3aGVuIGNvbW11bmljYXRpbmcgd2l0aCBKYXZhU2NyaXB0XCIsXG4gICAgICBcImZsYXNoLWRlYWN0aXZhdGVkXCI6IFwiRmxhc2ggaXMgdG9vIG91dGRhdGVkIGZvciB5b3VyIGJyb3dzZXIgYW5kL29yIGlzIGNvbmZpZ3VyZWQgYXMgY2xpY2stdG8tYWN0aXZhdGUuXFxuVGhpcyBtYXkgYWxzbyBtZWFuIHRoYXQgdGhlIFplcm9DbGlwYm9hcmQgU1dGIG9iamVjdCBjb3VsZCBub3QgYmUgbG9hZGVkLCBzbyBwbGVhc2UgY2hlY2sgeW91ciBgc3dmUGF0aGAgY29uZmlndXJhdGlvbiBhbmQvb3IgbmV0d29yayBjb25uZWN0aXZpdHkuXFxuTWF5IGFsc28gYmUgYXR0ZW1wdGluZyB0byBydW4gRmxhc2ggaW4gYSBzYW5kYm94ZWQgaWZyYW1lLCB3aGljaCBpcyBpbXBvc3NpYmxlLlwiLFxuICAgICAgXCJmbGFzaC1vdmVyZHVlXCI6IFwiRmxhc2ggY29tbXVuaWNhdGlvbiB3YXMgZXN0YWJsaXNoZWQgYnV0IE5PVCB3aXRoaW4gdGhlIGFjY2VwdGFibGUgdGltZSBsaW1pdFwiLFxuICAgICAgXCJ2ZXJzaW9uLW1pc21hdGNoXCI6IFwiWmVyb0NsaXBib2FyZCBKUyB2ZXJzaW9uIG51bWJlciBkb2VzIG5vdCBtYXRjaCBaZXJvQ2xpcGJvYXJkIFNXRiB2ZXJzaW9uIG51bWJlclwiLFxuICAgICAgXCJjbGlwYm9hcmQtZXJyb3JcIjogXCJBdCBsZWFzdCBvbmUgZXJyb3Igd2FzIHRocm93biB3aGlsZSBaZXJvQ2xpcGJvYXJkIHdhcyBhdHRlbXB0aW5nIHRvIGluamVjdCB5b3VyIGRhdGEgaW50byB0aGUgY2xpcGJvYXJkXCIsXG4gICAgICBcImNvbmZpZy1taXNtYXRjaFwiOiBcIlplcm9DbGlwYm9hcmQgY29uZmlndXJhdGlvbiBkb2VzIG5vdCBtYXRjaCBGbGFzaCdzIHJlYWxpdHlcIixcbiAgICAgIFwic3dmLW5vdC1mb3VuZFwiOiBcIlRoZSBaZXJvQ2xpcGJvYXJkIFNXRiBvYmplY3QgY291bGQgbm90IGJlIGxvYWRlZCwgc28gcGxlYXNlIGNoZWNrIHlvdXIgYHN3ZlBhdGhgIGNvbmZpZ3VyYXRpb24gYW5kL29yIG5ldHdvcmsgY29ubmVjdGl2aXR5XCJcbiAgICB9XG4gIH07XG4gIC8qKlxuICogVGhlIGBuYW1lYHMgb2YgYGVycm9yYCBldmVudHMgdGhhdCBjYW4gb25seSBvY2N1ciBpcyBGbGFzaCBoYXMgYXQgbGVhc3RcbiAqIGJlZW4gYWJsZSB0byBsb2FkIHRoZSBTV0Ygc3VjY2Vzc2Z1bGx5LlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2Vycm9yc1RoYXRPbmx5T2NjdXJBZnRlckZsYXNoTG9hZHMgPSBbIFwiZmxhc2gtdW5hdmFpbGFibGVcIiwgXCJmbGFzaC1kZWdyYWRlZFwiLCBcImZsYXNoLW92ZXJkdWVcIiwgXCJ2ZXJzaW9uLW1pc21hdGNoXCIsIFwiY29uZmlnLW1pc21hdGNoXCIsIFwiY2xpcGJvYXJkLWVycm9yXCIgXTtcbiAgLyoqXG4gKiBUaGUgYG5hbWVgcyBvZiBgZXJyb3JgIGV2ZW50cyB0aGF0IHNob3VsZCBsaWtlbHkgcmVzdWx0IGluIHRoZSBgX2ZsYXNoU3RhdGVgXG4gKiB2YXJpYWJsZSdzIHByb3BlcnR5IHZhbHVlcyBiZWluZyB1cGRhdGVkLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2ZsYXNoU3RhdGVFcnJvck5hbWVzID0gWyBcImZsYXNoLWRpc2FibGVkXCIsIFwiZmxhc2gtb3V0ZGF0ZWRcIiwgXCJmbGFzaC1zYW5kYm94ZWRcIiwgXCJmbGFzaC11bmF2YWlsYWJsZVwiLCBcImZsYXNoLWRlZ3JhZGVkXCIsIFwiZmxhc2gtZGVhY3RpdmF0ZWRcIiwgXCJmbGFzaC1vdmVyZHVlXCIgXTtcbiAgLyoqXG4gKiBBIFJlZ0V4cCB0byBtYXRjaCB0aGUgYG5hbWVgIHByb3BlcnR5IG9mIGBlcnJvcmAgZXZlbnRzIHJlbGF0ZWQgdG8gRmxhc2guXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZmxhc2hTdGF0ZUVycm9yTmFtZU1hdGNoaW5nUmVnZXggPSBuZXcgUmVnRXhwKFwiXmZsYXNoLShcIiArIF9mbGFzaFN0YXRlRXJyb3JOYW1lcy5tYXAoZnVuY3Rpb24oZXJyb3JOYW1lKSB7XG4gICAgcmV0dXJuIGVycm9yTmFtZS5yZXBsYWNlKC9eZmxhc2gtLywgXCJcIik7XG4gIH0pLmpvaW4oXCJ8XCIpICsgXCIpJFwiKTtcbiAgLyoqXG4gKiBBIFJlZ0V4cCB0byBtYXRjaCB0aGUgYG5hbWVgIHByb3BlcnR5IG9mIGBlcnJvcmAgZXZlbnRzIHJlbGF0ZWQgdG8gRmxhc2gsXG4gKiB3aGljaCBpcyBlbmFibGVkLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2ZsYXNoU3RhdGVFbmFibGVkRXJyb3JOYW1lTWF0Y2hpbmdSZWdleCA9IG5ldyBSZWdFeHAoXCJeZmxhc2gtKFwiICsgX2ZsYXNoU3RhdGVFcnJvck5hbWVzLnNsaWNlKDEpLm1hcChmdW5jdGlvbihlcnJvck5hbWUpIHtcbiAgICByZXR1cm4gZXJyb3JOYW1lLnJlcGxhY2UoL15mbGFzaC0vLCBcIlwiKTtcbiAgfSkuam9pbihcInxcIikgKyBcIikkXCIpO1xuICAvKipcbiAqIFplcm9DbGlwYm9hcmQgY29uZmlndXJhdGlvbiBkZWZhdWx0cyBmb3IgdGhlIENvcmUgbW9kdWxlLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2dsb2JhbENvbmZpZyA9IHtcbiAgICBzd2ZQYXRoOiBfZ2V0RGVmYXVsdFN3ZlBhdGgoKSxcbiAgICB0cnVzdGVkRG9tYWluczogd2luZG93LmxvY2F0aW9uLmhvc3QgPyBbIHdpbmRvdy5sb2NhdGlvbi5ob3N0IF0gOiBbXSxcbiAgICBjYWNoZUJ1c3Q6IHRydWUsXG4gICAgZm9yY2VFbmhhbmNlZENsaXBib2FyZDogZmFsc2UsXG4gICAgZmxhc2hMb2FkVGltZW91dDogM2U0LFxuICAgIGF1dG9BY3RpdmF0ZTogdHJ1ZSxcbiAgICBidWJibGVFdmVudHM6IHRydWUsXG4gICAgY29udGFpbmVySWQ6IFwiZ2xvYmFsLXplcm9jbGlwYm9hcmQtaHRtbC1icmlkZ2VcIixcbiAgICBjb250YWluZXJDbGFzczogXCJnbG9iYWwtemVyb2NsaXBib2FyZC1jb250YWluZXJcIixcbiAgICBzd2ZPYmplY3RJZDogXCJnbG9iYWwtemVyb2NsaXBib2FyZC1mbGFzaC1icmlkZ2VcIixcbiAgICBob3ZlckNsYXNzOiBcInplcm9jbGlwYm9hcmQtaXMtaG92ZXJcIixcbiAgICBhY3RpdmVDbGFzczogXCJ6ZXJvY2xpcGJvYXJkLWlzLWFjdGl2ZVwiLFxuICAgIGZvcmNlSGFuZEN1cnNvcjogZmFsc2UsXG4gICAgdGl0bGU6IG51bGwsXG4gICAgekluZGV4OiA5OTk5OTk5OTlcbiAgfTtcbiAgLyoqXG4gKiBUaGUgdW5kZXJseWluZyBpbXBsZW1lbnRhdGlvbiBvZiBgWmVyb0NsaXBib2FyZC5jb25maWdgLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2NvbmZpZyA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICBpZiAodHlwZW9mIG9wdGlvbnMgPT09IFwib2JqZWN0XCIgJiYgb3B0aW9ucyAhPT0gbnVsbCkge1xuICAgICAgZm9yICh2YXIgcHJvcCBpbiBvcHRpb25zKSB7XG4gICAgICAgIGlmIChfaGFzT3duLmNhbGwob3B0aW9ucywgcHJvcCkpIHtcbiAgICAgICAgICBpZiAoL14oPzpmb3JjZUhhbmRDdXJzb3J8dGl0bGV8ekluZGV4fGJ1YmJsZUV2ZW50cykkLy50ZXN0KHByb3ApKSB7XG4gICAgICAgICAgICBfZ2xvYmFsQ29uZmlnW3Byb3BdID0gb3B0aW9uc1twcm9wXTtcbiAgICAgICAgICB9IGVsc2UgaWYgKF9mbGFzaFN0YXRlLmJyaWRnZSA9PSBudWxsKSB7XG4gICAgICAgICAgICBpZiAocHJvcCA9PT0gXCJjb250YWluZXJJZFwiIHx8IHByb3AgPT09IFwic3dmT2JqZWN0SWRcIikge1xuICAgICAgICAgICAgICBpZiAoX2lzVmFsaWRIdG1sNElkKG9wdGlvbnNbcHJvcF0pKSB7XG4gICAgICAgICAgICAgICAgX2dsb2JhbENvbmZpZ1twcm9wXSA9IG9wdGlvbnNbcHJvcF07XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVGhlIHNwZWNpZmllZCBgXCIgKyBwcm9wICsgXCJgIHZhbHVlIGlzIG5vdCB2YWxpZCBhcyBhbiBIVE1MNCBFbGVtZW50IElEXCIpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBfZ2xvYmFsQ29uZmlnW3Byb3BdID0gb3B0aW9uc1twcm9wXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKHR5cGVvZiBvcHRpb25zID09PSBcInN0cmluZ1wiICYmIG9wdGlvbnMpIHtcbiAgICAgIGlmIChfaGFzT3duLmNhbGwoX2dsb2JhbENvbmZpZywgb3B0aW9ucykpIHtcbiAgICAgICAgcmV0dXJuIF9nbG9iYWxDb25maWdbb3B0aW9uc107XG4gICAgICB9XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHJldHVybiBfZGVlcENvcHkoX2dsb2JhbENvbmZpZyk7XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuc3RhdGVgLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX3N0YXRlID0gZnVuY3Rpb24oKSB7XG4gICAgX2RldGVjdFNhbmRib3goKTtcbiAgICByZXR1cm4ge1xuICAgICAgYnJvd3NlcjogX3BpY2soX25hdmlnYXRvciwgWyBcInVzZXJBZ2VudFwiLCBcInBsYXRmb3JtXCIsIFwiYXBwTmFtZVwiIF0pLFxuICAgICAgZmxhc2g6IF9vbWl0KF9mbGFzaFN0YXRlLCBbIFwiYnJpZGdlXCIgXSksXG4gICAgICB6ZXJvY2xpcGJvYXJkOiB7XG4gICAgICAgIHZlcnNpb246IFplcm9DbGlwYm9hcmQudmVyc2lvbixcbiAgICAgICAgY29uZmlnOiBaZXJvQ2xpcGJvYXJkLmNvbmZpZygpXG4gICAgICB9XG4gICAgfTtcbiAgfTtcbiAgLyoqXG4gKiBUaGUgdW5kZXJseWluZyBpbXBsZW1lbnRhdGlvbiBvZiBgWmVyb0NsaXBib2FyZC5pc0ZsYXNoVW51c2FibGVgLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2lzRmxhc2hVbnVzYWJsZSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiAhIShfZmxhc2hTdGF0ZS5kaXNhYmxlZCB8fCBfZmxhc2hTdGF0ZS5vdXRkYXRlZCB8fCBfZmxhc2hTdGF0ZS5zYW5kYm94ZWQgfHwgX2ZsYXNoU3RhdGUudW5hdmFpbGFibGUgfHwgX2ZsYXNoU3RhdGUuZGVncmFkZWQgfHwgX2ZsYXNoU3RhdGUuZGVhY3RpdmF0ZWQpO1xuICB9O1xuICAvKipcbiAqIFRoZSB1bmRlcmx5aW5nIGltcGxlbWVudGF0aW9uIG9mIGBaZXJvQ2xpcGJvYXJkLm9uYC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9vbiA9IGZ1bmN0aW9uKGV2ZW50VHlwZSwgbGlzdGVuZXIpIHtcbiAgICB2YXIgaSwgbGVuLCBldmVudHMsIGFkZGVkID0ge307XG4gICAgaWYgKHR5cGVvZiBldmVudFR5cGUgPT09IFwic3RyaW5nXCIgJiYgZXZlbnRUeXBlKSB7XG4gICAgICBldmVudHMgPSBldmVudFR5cGUudG9Mb3dlckNhc2UoKS5zcGxpdCgvXFxzKy8pO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGV2ZW50VHlwZSA9PT0gXCJvYmplY3RcIiAmJiBldmVudFR5cGUgJiYgdHlwZW9mIGxpc3RlbmVyID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICBmb3IgKGkgaW4gZXZlbnRUeXBlKSB7XG4gICAgICAgIGlmIChfaGFzT3duLmNhbGwoZXZlbnRUeXBlLCBpKSAmJiB0eXBlb2YgaSA9PT0gXCJzdHJpbmdcIiAmJiBpICYmIHR5cGVvZiBldmVudFR5cGVbaV0gPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgIFplcm9DbGlwYm9hcmQub24oaSwgZXZlbnRUeXBlW2ldKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBpZiAoZXZlbnRzICYmIGV2ZW50cy5sZW5ndGgpIHtcbiAgICAgIGZvciAoaSA9IDAsIGxlbiA9IGV2ZW50cy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBldmVudFR5cGUgPSBldmVudHNbaV0ucmVwbGFjZSgvXm9uLywgXCJcIik7XG4gICAgICAgIGFkZGVkW2V2ZW50VHlwZV0gPSB0cnVlO1xuICAgICAgICBpZiAoIV9oYW5kbGVyc1tldmVudFR5cGVdKSB7XG4gICAgICAgICAgX2hhbmRsZXJzW2V2ZW50VHlwZV0gPSBbXTtcbiAgICAgICAgfVxuICAgICAgICBfaGFuZGxlcnNbZXZlbnRUeXBlXS5wdXNoKGxpc3RlbmVyKTtcbiAgICAgIH1cbiAgICAgIGlmIChhZGRlZC5yZWFkeSAmJiBfZmxhc2hTdGF0ZS5yZWFkeSkge1xuICAgICAgICBaZXJvQ2xpcGJvYXJkLmVtaXQoe1xuICAgICAgICAgIHR5cGU6IFwicmVhZHlcIlxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmIChhZGRlZC5lcnJvcikge1xuICAgICAgICBmb3IgKGkgPSAwLCBsZW4gPSBfZmxhc2hTdGF0ZUVycm9yTmFtZXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICBpZiAoX2ZsYXNoU3RhdGVbX2ZsYXNoU3RhdGVFcnJvck5hbWVzW2ldLnJlcGxhY2UoL15mbGFzaC0vLCBcIlwiKV0gPT09IHRydWUpIHtcbiAgICAgICAgICAgIFplcm9DbGlwYm9hcmQuZW1pdCh7XG4gICAgICAgICAgICAgIHR5cGU6IFwiZXJyb3JcIixcbiAgICAgICAgICAgICAgbmFtZTogX2ZsYXNoU3RhdGVFcnJvck5hbWVzW2ldXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoX3pjU3dmVmVyc2lvbiAhPT0gdW5kZWZpbmVkICYmIFplcm9DbGlwYm9hcmQudmVyc2lvbiAhPT0gX3pjU3dmVmVyc2lvbikge1xuICAgICAgICAgIFplcm9DbGlwYm9hcmQuZW1pdCh7XG4gICAgICAgICAgICB0eXBlOiBcImVycm9yXCIsXG4gICAgICAgICAgICBuYW1lOiBcInZlcnNpb24tbWlzbWF0Y2hcIixcbiAgICAgICAgICAgIGpzVmVyc2lvbjogWmVyb0NsaXBib2FyZC52ZXJzaW9uLFxuICAgICAgICAgICAgc3dmVmVyc2lvbjogX3pjU3dmVmVyc2lvblxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBaZXJvQ2xpcGJvYXJkO1xuICB9O1xuICAvKipcbiAqIFRoZSB1bmRlcmx5aW5nIGltcGxlbWVudGF0aW9uIG9mIGBaZXJvQ2xpcGJvYXJkLm9mZmAuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfb2ZmID0gZnVuY3Rpb24oZXZlbnRUeXBlLCBsaXN0ZW5lcikge1xuICAgIHZhciBpLCBsZW4sIGZvdW5kSW5kZXgsIGV2ZW50cywgcGVyRXZlbnRIYW5kbGVycztcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgZXZlbnRzID0gX2tleXMoX2hhbmRsZXJzKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBldmVudFR5cGUgPT09IFwic3RyaW5nXCIgJiYgZXZlbnRUeXBlKSB7XG4gICAgICBldmVudHMgPSBldmVudFR5cGUuc3BsaXQoL1xccysvKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBldmVudFR5cGUgPT09IFwib2JqZWN0XCIgJiYgZXZlbnRUeXBlICYmIHR5cGVvZiBsaXN0ZW5lciA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgZm9yIChpIGluIGV2ZW50VHlwZSkge1xuICAgICAgICBpZiAoX2hhc093bi5jYWxsKGV2ZW50VHlwZSwgaSkgJiYgdHlwZW9mIGkgPT09IFwic3RyaW5nXCIgJiYgaSAmJiB0eXBlb2YgZXZlbnRUeXBlW2ldID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICBaZXJvQ2xpcGJvYXJkLm9mZihpLCBldmVudFR5cGVbaV0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChldmVudHMgJiYgZXZlbnRzLmxlbmd0aCkge1xuICAgICAgZm9yIChpID0gMCwgbGVuID0gZXZlbnRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGV2ZW50VHlwZSA9IGV2ZW50c1tpXS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL15vbi8sIFwiXCIpO1xuICAgICAgICBwZXJFdmVudEhhbmRsZXJzID0gX2hhbmRsZXJzW2V2ZW50VHlwZV07XG4gICAgICAgIGlmIChwZXJFdmVudEhhbmRsZXJzICYmIHBlckV2ZW50SGFuZGxlcnMubGVuZ3RoKSB7XG4gICAgICAgICAgaWYgKGxpc3RlbmVyKSB7XG4gICAgICAgICAgICBmb3VuZEluZGV4ID0gcGVyRXZlbnRIYW5kbGVycy5pbmRleE9mKGxpc3RlbmVyKTtcbiAgICAgICAgICAgIHdoaWxlIChmb3VuZEluZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgICBwZXJFdmVudEhhbmRsZXJzLnNwbGljZShmb3VuZEluZGV4LCAxKTtcbiAgICAgICAgICAgICAgZm91bmRJbmRleCA9IHBlckV2ZW50SGFuZGxlcnMuaW5kZXhPZihsaXN0ZW5lciwgZm91bmRJbmRleCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHBlckV2ZW50SGFuZGxlcnMubGVuZ3RoID0gMDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIFplcm9DbGlwYm9hcmQ7XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuaGFuZGxlcnNgLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2xpc3RlbmVycyA9IGZ1bmN0aW9uKGV2ZW50VHlwZSkge1xuICAgIHZhciBjb3B5O1xuICAgIGlmICh0eXBlb2YgZXZlbnRUeXBlID09PSBcInN0cmluZ1wiICYmIGV2ZW50VHlwZSkge1xuICAgICAgY29weSA9IF9kZWVwQ29weShfaGFuZGxlcnNbZXZlbnRUeXBlXSkgfHwgbnVsbDtcbiAgICB9IGVsc2Uge1xuICAgICAgY29weSA9IF9kZWVwQ29weShfaGFuZGxlcnMpO1xuICAgIH1cbiAgICByZXR1cm4gY29weTtcbiAgfTtcbiAgLyoqXG4gKiBUaGUgdW5kZXJseWluZyBpbXBsZW1lbnRhdGlvbiBvZiBgWmVyb0NsaXBib2FyZC5lbWl0YC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9lbWl0ID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICB2YXIgZXZlbnRDb3B5LCByZXR1cm5WYWwsIHRtcDtcbiAgICBldmVudCA9IF9jcmVhdGVFdmVudChldmVudCk7XG4gICAgaWYgKCFldmVudCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoX3ByZXByb2Nlc3NFdmVudChldmVudCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGV2ZW50LnR5cGUgPT09IFwicmVhZHlcIiAmJiBfZmxhc2hTdGF0ZS5vdmVyZHVlID09PSB0cnVlKSB7XG4gICAgICByZXR1cm4gWmVyb0NsaXBib2FyZC5lbWl0KHtcbiAgICAgICAgdHlwZTogXCJlcnJvclwiLFxuICAgICAgICBuYW1lOiBcImZsYXNoLW92ZXJkdWVcIlxuICAgICAgfSk7XG4gICAgfVxuICAgIGV2ZW50Q29weSA9IF9leHRlbmQoe30sIGV2ZW50KTtcbiAgICBfZGlzcGF0Y2hDYWxsYmFja3MuY2FsbCh0aGlzLCBldmVudENvcHkpO1xuICAgIGlmIChldmVudC50eXBlID09PSBcImNvcHlcIikge1xuICAgICAgdG1wID0gX21hcENsaXBEYXRhVG9GbGFzaChfY2xpcERhdGEpO1xuICAgICAgcmV0dXJuVmFsID0gdG1wLmRhdGE7XG4gICAgICBfY2xpcERhdGFGb3JtYXRNYXAgPSB0bXAuZm9ybWF0TWFwO1xuICAgIH1cbiAgICByZXR1cm4gcmV0dXJuVmFsO1xuICB9O1xuICAvKipcbiAqIFRoZSB1bmRlcmx5aW5nIGltcGxlbWVudGF0aW9uIG9mIGBaZXJvQ2xpcGJvYXJkLmNyZWF0ZWAuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY3JlYXRlID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHByZXZpb3VzU3RhdGUgPSBfZmxhc2hTdGF0ZS5zYW5kYm94ZWQ7XG4gICAgX2RldGVjdFNhbmRib3goKTtcbiAgICBpZiAodHlwZW9mIF9mbGFzaFN0YXRlLnJlYWR5ICE9PSBcImJvb2xlYW5cIikge1xuICAgICAgX2ZsYXNoU3RhdGUucmVhZHkgPSBmYWxzZTtcbiAgICB9XG4gICAgaWYgKF9mbGFzaFN0YXRlLnNhbmRib3hlZCAhPT0gcHJldmlvdXNTdGF0ZSAmJiBfZmxhc2hTdGF0ZS5zYW5kYm94ZWQgPT09IHRydWUpIHtcbiAgICAgIF9mbGFzaFN0YXRlLnJlYWR5ID0gZmFsc2U7XG4gICAgICBaZXJvQ2xpcGJvYXJkLmVtaXQoe1xuICAgICAgICB0eXBlOiBcImVycm9yXCIsXG4gICAgICAgIG5hbWU6IFwiZmxhc2gtc2FuZGJveGVkXCJcbiAgICAgIH0pO1xuICAgIH0gZWxzZSBpZiAoIVplcm9DbGlwYm9hcmQuaXNGbGFzaFVudXNhYmxlKCkgJiYgX2ZsYXNoU3RhdGUuYnJpZGdlID09PSBudWxsKSB7XG4gICAgICB2YXIgbWF4V2FpdCA9IF9nbG9iYWxDb25maWcuZmxhc2hMb2FkVGltZW91dDtcbiAgICAgIGlmICh0eXBlb2YgbWF4V2FpdCA9PT0gXCJudW1iZXJcIiAmJiBtYXhXYWl0ID49IDApIHtcbiAgICAgICAgX2ZsYXNoQ2hlY2tUaW1lb3V0ID0gX3NldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiBfZmxhc2hTdGF0ZS5kZWFjdGl2YXRlZCAhPT0gXCJib29sZWFuXCIpIHtcbiAgICAgICAgICAgIF9mbGFzaFN0YXRlLmRlYWN0aXZhdGVkID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKF9mbGFzaFN0YXRlLmRlYWN0aXZhdGVkID09PSB0cnVlKSB7XG4gICAgICAgICAgICBaZXJvQ2xpcGJvYXJkLmVtaXQoe1xuICAgICAgICAgICAgICB0eXBlOiBcImVycm9yXCIsXG4gICAgICAgICAgICAgIG5hbWU6IFwiZmxhc2gtZGVhY3RpdmF0ZWRcIlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9LCBtYXhXYWl0KTtcbiAgICAgIH1cbiAgICAgIF9mbGFzaFN0YXRlLm92ZXJkdWUgPSBmYWxzZTtcbiAgICAgIF9lbWJlZFN3ZigpO1xuICAgIH1cbiAgfTtcbiAgLyoqXG4gKiBUaGUgdW5kZXJseWluZyBpbXBsZW1lbnRhdGlvbiBvZiBgWmVyb0NsaXBib2FyZC5kZXN0cm95YC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9kZXN0cm95ID0gZnVuY3Rpb24oKSB7XG4gICAgWmVyb0NsaXBib2FyZC5jbGVhckRhdGEoKTtcbiAgICBaZXJvQ2xpcGJvYXJkLmJsdXIoKTtcbiAgICBaZXJvQ2xpcGJvYXJkLmVtaXQoXCJkZXN0cm95XCIpO1xuICAgIF91bmVtYmVkU3dmKCk7XG4gICAgWmVyb0NsaXBib2FyZC5vZmYoKTtcbiAgfTtcbiAgLyoqXG4gKiBUaGUgdW5kZXJseWluZyBpbXBsZW1lbnRhdGlvbiBvZiBgWmVyb0NsaXBib2FyZC5zZXREYXRhYC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9zZXREYXRhID0gZnVuY3Rpb24oZm9ybWF0LCBkYXRhKSB7XG4gICAgdmFyIGRhdGFPYmo7XG4gICAgaWYgKHR5cGVvZiBmb3JtYXQgPT09IFwib2JqZWN0XCIgJiYgZm9ybWF0ICYmIHR5cGVvZiBkYXRhID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICBkYXRhT2JqID0gZm9ybWF0O1xuICAgICAgWmVyb0NsaXBib2FyZC5jbGVhckRhdGEoKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBmb3JtYXQgPT09IFwic3RyaW5nXCIgJiYgZm9ybWF0KSB7XG4gICAgICBkYXRhT2JqID0ge307XG4gICAgICBkYXRhT2JqW2Zvcm1hdF0gPSBkYXRhO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGZvciAodmFyIGRhdGFGb3JtYXQgaW4gZGF0YU9iaikge1xuICAgICAgaWYgKHR5cGVvZiBkYXRhRm9ybWF0ID09PSBcInN0cmluZ1wiICYmIGRhdGFGb3JtYXQgJiYgX2hhc093bi5jYWxsKGRhdGFPYmosIGRhdGFGb3JtYXQpICYmIHR5cGVvZiBkYXRhT2JqW2RhdGFGb3JtYXRdID09PSBcInN0cmluZ1wiICYmIGRhdGFPYmpbZGF0YUZvcm1hdF0pIHtcbiAgICAgICAgX2NsaXBEYXRhW2RhdGFGb3JtYXRdID0gZGF0YU9ialtkYXRhRm9ybWF0XTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuY2xlYXJEYXRhYC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9jbGVhckRhdGEgPSBmdW5jdGlvbihmb3JtYXQpIHtcbiAgICBpZiAodHlwZW9mIGZvcm1hdCA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgX2RlbGV0ZU93blByb3BlcnRpZXMoX2NsaXBEYXRhKTtcbiAgICAgIF9jbGlwRGF0YUZvcm1hdE1hcCA9IG51bGw7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgZm9ybWF0ID09PSBcInN0cmluZ1wiICYmIF9oYXNPd24uY2FsbChfY2xpcERhdGEsIGZvcm1hdCkpIHtcbiAgICAgIGRlbGV0ZSBfY2xpcERhdGFbZm9ybWF0XTtcbiAgICB9XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuZ2V0RGF0YWAuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZ2V0RGF0YSA9IGZ1bmN0aW9uKGZvcm1hdCkge1xuICAgIGlmICh0eXBlb2YgZm9ybWF0ID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICByZXR1cm4gX2RlZXBDb3B5KF9jbGlwRGF0YSk7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgZm9ybWF0ID09PSBcInN0cmluZ1wiICYmIF9oYXNPd24uY2FsbChfY2xpcERhdGEsIGZvcm1hdCkpIHtcbiAgICAgIHJldHVybiBfY2xpcERhdGFbZm9ybWF0XTtcbiAgICB9XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuZm9jdXNgL2BaZXJvQ2xpcGJvYXJkLmFjdGl2YXRlYC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9mb2N1cyA9IGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICBpZiAoIShlbGVtZW50ICYmIGVsZW1lbnQubm9kZVR5cGUgPT09IDEpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChfY3VycmVudEVsZW1lbnQpIHtcbiAgICAgIF9yZW1vdmVDbGFzcyhfY3VycmVudEVsZW1lbnQsIF9nbG9iYWxDb25maWcuYWN0aXZlQ2xhc3MpO1xuICAgICAgaWYgKF9jdXJyZW50RWxlbWVudCAhPT0gZWxlbWVudCkge1xuICAgICAgICBfcmVtb3ZlQ2xhc3MoX2N1cnJlbnRFbGVtZW50LCBfZ2xvYmFsQ29uZmlnLmhvdmVyQ2xhc3MpO1xuICAgICAgfVxuICAgIH1cbiAgICBfY3VycmVudEVsZW1lbnQgPSBlbGVtZW50O1xuICAgIF9hZGRDbGFzcyhlbGVtZW50LCBfZ2xvYmFsQ29uZmlnLmhvdmVyQ2xhc3MpO1xuICAgIHZhciBuZXdUaXRsZSA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwidGl0bGVcIikgfHwgX2dsb2JhbENvbmZpZy50aXRsZTtcbiAgICBpZiAodHlwZW9mIG5ld1RpdGxlID09PSBcInN0cmluZ1wiICYmIG5ld1RpdGxlKSB7XG4gICAgICB2YXIgaHRtbEJyaWRnZSA9IF9nZXRIdG1sQnJpZGdlKF9mbGFzaFN0YXRlLmJyaWRnZSk7XG4gICAgICBpZiAoaHRtbEJyaWRnZSkge1xuICAgICAgICBodG1sQnJpZGdlLnNldEF0dHJpYnV0ZShcInRpdGxlXCIsIG5ld1RpdGxlKTtcbiAgICAgIH1cbiAgICB9XG4gICAgdmFyIHVzZUhhbmRDdXJzb3IgPSBfZ2xvYmFsQ29uZmlnLmZvcmNlSGFuZEN1cnNvciA9PT0gdHJ1ZSB8fCBfZ2V0U3R5bGUoZWxlbWVudCwgXCJjdXJzb3JcIikgPT09IFwicG9pbnRlclwiO1xuICAgIF9zZXRIYW5kQ3Vyc29yKHVzZUhhbmRDdXJzb3IpO1xuICAgIF9yZXBvc2l0aW9uKCk7XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuYmx1cmAvYFplcm9DbGlwYm9hcmQuZGVhY3RpdmF0ZWAuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfYmx1ciA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBodG1sQnJpZGdlID0gX2dldEh0bWxCcmlkZ2UoX2ZsYXNoU3RhdGUuYnJpZGdlKTtcbiAgICBpZiAoaHRtbEJyaWRnZSkge1xuICAgICAgaHRtbEJyaWRnZS5yZW1vdmVBdHRyaWJ1dGUoXCJ0aXRsZVwiKTtcbiAgICAgIGh0bWxCcmlkZ2Uuc3R5bGUubGVmdCA9IFwiMHB4XCI7XG4gICAgICBodG1sQnJpZGdlLnN0eWxlLnRvcCA9IFwiLTk5OTlweFwiO1xuICAgICAgaHRtbEJyaWRnZS5zdHlsZS53aWR0aCA9IFwiMXB4XCI7XG4gICAgICBodG1sQnJpZGdlLnN0eWxlLmhlaWdodCA9IFwiMXB4XCI7XG4gICAgfVxuICAgIGlmIChfY3VycmVudEVsZW1lbnQpIHtcbiAgICAgIF9yZW1vdmVDbGFzcyhfY3VycmVudEVsZW1lbnQsIF9nbG9iYWxDb25maWcuaG92ZXJDbGFzcyk7XG4gICAgICBfcmVtb3ZlQ2xhc3MoX2N1cnJlbnRFbGVtZW50LCBfZ2xvYmFsQ29uZmlnLmFjdGl2ZUNsYXNzKTtcbiAgICAgIF9jdXJyZW50RWxlbWVudCA9IG51bGw7XG4gICAgfVxuICB9O1xuICAvKipcbiAqIFRoZSB1bmRlcmx5aW5nIGltcGxlbWVudGF0aW9uIG9mIGBaZXJvQ2xpcGJvYXJkLmFjdGl2ZUVsZW1lbnRgLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2FjdGl2ZUVsZW1lbnQgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX2N1cnJlbnRFbGVtZW50IHx8IG51bGw7XG4gIH07XG4gIC8qKlxuICogQ2hlY2sgaWYgYSB2YWx1ZSBpcyBhIHZhbGlkIEhUTUw0IGBJRGAgb3IgYE5hbWVgIHRva2VuLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2lzVmFsaWRIdG1sNElkID0gZnVuY3Rpb24oaWQpIHtcbiAgICByZXR1cm4gdHlwZW9mIGlkID09PSBcInN0cmluZ1wiICYmIGlkICYmIC9eW0EtWmEtel1bQS1aYS16MC05XzpcXC1cXC5dKiQvLnRlc3QoaWQpO1xuICB9O1xuICAvKipcbiAqIENyZWF0ZSBvciB1cGRhdGUgYW4gYGV2ZW50YCBvYmplY3QsIGJhc2VkIG9uIHRoZSBgZXZlbnRUeXBlYC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9jcmVhdGVFdmVudCA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgdmFyIGV2ZW50VHlwZTtcbiAgICBpZiAodHlwZW9mIGV2ZW50ID09PSBcInN0cmluZ1wiICYmIGV2ZW50KSB7XG4gICAgICBldmVudFR5cGUgPSBldmVudDtcbiAgICAgIGV2ZW50ID0ge307XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgZXZlbnQgPT09IFwib2JqZWN0XCIgJiYgZXZlbnQgJiYgdHlwZW9mIGV2ZW50LnR5cGUgPT09IFwic3RyaW5nXCIgJiYgZXZlbnQudHlwZSkge1xuICAgICAgZXZlbnRUeXBlID0gZXZlbnQudHlwZTtcbiAgICB9XG4gICAgaWYgKCFldmVudFR5cGUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZXZlbnRUeXBlID0gZXZlbnRUeXBlLnRvTG93ZXJDYXNlKCk7XG4gICAgaWYgKCFldmVudC50YXJnZXQgJiYgKC9eKGNvcHl8YWZ0ZXJjb3B5fF9jbGljaykkLy50ZXN0KGV2ZW50VHlwZSkgfHwgZXZlbnRUeXBlID09PSBcImVycm9yXCIgJiYgZXZlbnQubmFtZSA9PT0gXCJjbGlwYm9hcmQtZXJyb3JcIikpIHtcbiAgICAgIGV2ZW50LnRhcmdldCA9IF9jb3B5VGFyZ2V0O1xuICAgIH1cbiAgICBfZXh0ZW5kKGV2ZW50LCB7XG4gICAgICB0eXBlOiBldmVudFR5cGUsXG4gICAgICB0YXJnZXQ6IGV2ZW50LnRhcmdldCB8fCBfY3VycmVudEVsZW1lbnQgfHwgbnVsbCxcbiAgICAgIHJlbGF0ZWRUYXJnZXQ6IGV2ZW50LnJlbGF0ZWRUYXJnZXQgfHwgbnVsbCxcbiAgICAgIGN1cnJlbnRUYXJnZXQ6IF9mbGFzaFN0YXRlICYmIF9mbGFzaFN0YXRlLmJyaWRnZSB8fCBudWxsLFxuICAgICAgdGltZVN0YW1wOiBldmVudC50aW1lU3RhbXAgfHwgX25vdygpIHx8IG51bGxcbiAgICB9KTtcbiAgICB2YXIgbXNnID0gX2V2ZW50TWVzc2FnZXNbZXZlbnQudHlwZV07XG4gICAgaWYgKGV2ZW50LnR5cGUgPT09IFwiZXJyb3JcIiAmJiBldmVudC5uYW1lICYmIG1zZykge1xuICAgICAgbXNnID0gbXNnW2V2ZW50Lm5hbWVdO1xuICAgIH1cbiAgICBpZiAobXNnKSB7XG4gICAgICBldmVudC5tZXNzYWdlID0gbXNnO1xuICAgIH1cbiAgICBpZiAoZXZlbnQudHlwZSA9PT0gXCJyZWFkeVwiKSB7XG4gICAgICBfZXh0ZW5kKGV2ZW50LCB7XG4gICAgICAgIHRhcmdldDogbnVsbCxcbiAgICAgICAgdmVyc2lvbjogX2ZsYXNoU3RhdGUudmVyc2lvblxuICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChldmVudC50eXBlID09PSBcImVycm9yXCIpIHtcbiAgICAgIGlmIChfZmxhc2hTdGF0ZUVycm9yTmFtZU1hdGNoaW5nUmVnZXgudGVzdChldmVudC5uYW1lKSkge1xuICAgICAgICBfZXh0ZW5kKGV2ZW50LCB7XG4gICAgICAgICAgdGFyZ2V0OiBudWxsLFxuICAgICAgICAgIG1pbmltdW1WZXJzaW9uOiBfbWluaW11bUZsYXNoVmVyc2lvblxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmIChfZmxhc2hTdGF0ZUVuYWJsZWRFcnJvck5hbWVNYXRjaGluZ1JlZ2V4LnRlc3QoZXZlbnQubmFtZSkpIHtcbiAgICAgICAgX2V4dGVuZChldmVudCwge1xuICAgICAgICAgIHZlcnNpb246IF9mbGFzaFN0YXRlLnZlcnNpb25cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChldmVudC50eXBlID09PSBcImNvcHlcIikge1xuICAgICAgZXZlbnQuY2xpcGJvYXJkRGF0YSA9IHtcbiAgICAgICAgc2V0RGF0YTogWmVyb0NsaXBib2FyZC5zZXREYXRhLFxuICAgICAgICBjbGVhckRhdGE6IFplcm9DbGlwYm9hcmQuY2xlYXJEYXRhXG4gICAgICB9O1xuICAgIH1cbiAgICBpZiAoZXZlbnQudHlwZSA9PT0gXCJhZnRlcmNvcHlcIikge1xuICAgICAgZXZlbnQgPSBfbWFwQ2xpcFJlc3VsdHNGcm9tRmxhc2goZXZlbnQsIF9jbGlwRGF0YUZvcm1hdE1hcCk7XG4gICAgfVxuICAgIGlmIChldmVudC50YXJnZXQgJiYgIWV2ZW50LnJlbGF0ZWRUYXJnZXQpIHtcbiAgICAgIGV2ZW50LnJlbGF0ZWRUYXJnZXQgPSBfZ2V0UmVsYXRlZFRhcmdldChldmVudC50YXJnZXQpO1xuICAgIH1cbiAgICByZXR1cm4gX2FkZE1vdXNlRGF0YShldmVudCk7XG4gIH07XG4gIC8qKlxuICogR2V0IGEgcmVsYXRlZFRhcmdldCBmcm9tIHRoZSB0YXJnZXQncyBgZGF0YS1jbGlwYm9hcmQtdGFyZ2V0YCBhdHRyaWJ1dGVcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9nZXRSZWxhdGVkVGFyZ2V0ID0gZnVuY3Rpb24odGFyZ2V0RWwpIHtcbiAgICB2YXIgcmVsYXRlZFRhcmdldElkID0gdGFyZ2V0RWwgJiYgdGFyZ2V0RWwuZ2V0QXR0cmlidXRlICYmIHRhcmdldEVsLmdldEF0dHJpYnV0ZShcImRhdGEtY2xpcGJvYXJkLXRhcmdldFwiKTtcbiAgICByZXR1cm4gcmVsYXRlZFRhcmdldElkID8gX2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlbGF0ZWRUYXJnZXRJZCkgOiBudWxsO1xuICB9O1xuICAvKipcbiAqIEFkZCBlbGVtZW50IGFuZCBwb3NpdGlvbiBkYXRhIHRvIGBNb3VzZUV2ZW50YCBpbnN0YW5jZXNcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9hZGRNb3VzZURhdGEgPSBmdW5jdGlvbihldmVudCkge1xuICAgIGlmIChldmVudCAmJiAvXl8oPzpjbGlja3xtb3VzZSg/Om92ZXJ8b3V0fGRvd258dXB8bW92ZSkpJC8udGVzdChldmVudC50eXBlKSkge1xuICAgICAgdmFyIHNyY0VsZW1lbnQgPSBldmVudC50YXJnZXQ7XG4gICAgICB2YXIgZnJvbUVsZW1lbnQgPSBldmVudC50eXBlID09PSBcIl9tb3VzZW92ZXJcIiAmJiBldmVudC5yZWxhdGVkVGFyZ2V0ID8gZXZlbnQucmVsYXRlZFRhcmdldCA6IHVuZGVmaW5lZDtcbiAgICAgIHZhciB0b0VsZW1lbnQgPSBldmVudC50eXBlID09PSBcIl9tb3VzZW91dFwiICYmIGV2ZW50LnJlbGF0ZWRUYXJnZXQgPyBldmVudC5yZWxhdGVkVGFyZ2V0IDogdW5kZWZpbmVkO1xuICAgICAgdmFyIHBvcyA9IF9nZXRFbGVtZW50UG9zaXRpb24oc3JjRWxlbWVudCk7XG4gICAgICB2YXIgc2NyZWVuTGVmdCA9IF93aW5kb3cuc2NyZWVuTGVmdCB8fCBfd2luZG93LnNjcmVlblggfHwgMDtcbiAgICAgIHZhciBzY3JlZW5Ub3AgPSBfd2luZG93LnNjcmVlblRvcCB8fCBfd2luZG93LnNjcmVlblkgfHwgMDtcbiAgICAgIHZhciBzY3JvbGxMZWZ0ID0gX2RvY3VtZW50LmJvZHkuc2Nyb2xsTGVmdCArIF9kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsTGVmdDtcbiAgICAgIHZhciBzY3JvbGxUb3AgPSBfZG9jdW1lbnQuYm9keS5zY3JvbGxUb3AgKyBfZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcDtcbiAgICAgIHZhciBwYWdlWCA9IHBvcy5sZWZ0ICsgKHR5cGVvZiBldmVudC5fc3RhZ2VYID09PSBcIm51bWJlclwiID8gZXZlbnQuX3N0YWdlWCA6IDApO1xuICAgICAgdmFyIHBhZ2VZID0gcG9zLnRvcCArICh0eXBlb2YgZXZlbnQuX3N0YWdlWSA9PT0gXCJudW1iZXJcIiA/IGV2ZW50Ll9zdGFnZVkgOiAwKTtcbiAgICAgIHZhciBjbGllbnRYID0gcGFnZVggLSBzY3JvbGxMZWZ0O1xuICAgICAgdmFyIGNsaWVudFkgPSBwYWdlWSAtIHNjcm9sbFRvcDtcbiAgICAgIHZhciBzY3JlZW5YID0gc2NyZWVuTGVmdCArIGNsaWVudFg7XG4gICAgICB2YXIgc2NyZWVuWSA9IHNjcmVlblRvcCArIGNsaWVudFk7XG4gICAgICB2YXIgbW92ZVggPSB0eXBlb2YgZXZlbnQubW92ZW1lbnRYID09PSBcIm51bWJlclwiID8gZXZlbnQubW92ZW1lbnRYIDogMDtcbiAgICAgIHZhciBtb3ZlWSA9IHR5cGVvZiBldmVudC5tb3ZlbWVudFkgPT09IFwibnVtYmVyXCIgPyBldmVudC5tb3ZlbWVudFkgOiAwO1xuICAgICAgZGVsZXRlIGV2ZW50Ll9zdGFnZVg7XG4gICAgICBkZWxldGUgZXZlbnQuX3N0YWdlWTtcbiAgICAgIF9leHRlbmQoZXZlbnQsIHtcbiAgICAgICAgc3JjRWxlbWVudDogc3JjRWxlbWVudCxcbiAgICAgICAgZnJvbUVsZW1lbnQ6IGZyb21FbGVtZW50LFxuICAgICAgICB0b0VsZW1lbnQ6IHRvRWxlbWVudCxcbiAgICAgICAgc2NyZWVuWDogc2NyZWVuWCxcbiAgICAgICAgc2NyZWVuWTogc2NyZWVuWSxcbiAgICAgICAgcGFnZVg6IHBhZ2VYLFxuICAgICAgICBwYWdlWTogcGFnZVksXG4gICAgICAgIGNsaWVudFg6IGNsaWVudFgsXG4gICAgICAgIGNsaWVudFk6IGNsaWVudFksXG4gICAgICAgIHg6IGNsaWVudFgsXG4gICAgICAgIHk6IGNsaWVudFksXG4gICAgICAgIG1vdmVtZW50WDogbW92ZVgsXG4gICAgICAgIG1vdmVtZW50WTogbW92ZVksXG4gICAgICAgIG9mZnNldFg6IDAsXG4gICAgICAgIG9mZnNldFk6IDAsXG4gICAgICAgIGxheWVyWDogMCxcbiAgICAgICAgbGF5ZXJZOiAwXG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIGV2ZW50O1xuICB9O1xuICAvKipcbiAqIERldGVybWluZSBpZiBhbiBldmVudCdzIHJlZ2lzdGVyZWQgaGFuZGxlcnMgc2hvdWxkIGJlIGV4ZWN1dGUgc3luY2hyb25vdXNseSBvciBhc3luY2hyb25vdXNseS5cbiAqXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9zaG91bGRQZXJmb3JtQXN5bmMgPSBmdW5jdGlvbihldmVudCkge1xuICAgIHZhciBldmVudFR5cGUgPSBldmVudCAmJiB0eXBlb2YgZXZlbnQudHlwZSA9PT0gXCJzdHJpbmdcIiAmJiBldmVudC50eXBlIHx8IFwiXCI7XG4gICAgcmV0dXJuICEvXig/Oig/OmJlZm9yZSk/Y29weXxkZXN0cm95KSQvLnRlc3QoZXZlbnRUeXBlKTtcbiAgfTtcbiAgLyoqXG4gKiBDb250cm9sIGlmIGEgY2FsbGJhY2sgc2hvdWxkIGJlIGV4ZWN1dGVkIGFzeW5jaHJvbm91c2x5IG9yIG5vdC5cbiAqXG4gKiBAcmV0dXJucyBgdW5kZWZpbmVkYFxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2Rpc3BhdGNoQ2FsbGJhY2sgPSBmdW5jdGlvbihmdW5jLCBjb250ZXh0LCBhcmdzLCBhc3luYykge1xuICAgIGlmIChhc3luYykge1xuICAgICAgX3NldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgIGZ1bmMuYXBwbHkoY29udGV4dCwgYXJncyk7XG4gICAgICB9LCAwKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcbiAgICB9XG4gIH07XG4gIC8qKlxuICogSGFuZGxlIHRoZSBhY3R1YWwgZGlzcGF0Y2hpbmcgb2YgZXZlbnRzIHRvIGNsaWVudCBpbnN0YW5jZXMuXG4gKlxuICogQHJldHVybnMgYHVuZGVmaW5lZGBcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9kaXNwYXRjaENhbGxiYWNrcyA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgaWYgKCEodHlwZW9mIGV2ZW50ID09PSBcIm9iamVjdFwiICYmIGV2ZW50ICYmIGV2ZW50LnR5cGUpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBhc3luYyA9IF9zaG91bGRQZXJmb3JtQXN5bmMoZXZlbnQpO1xuICAgIHZhciB3aWxkY2FyZFR5cGVIYW5kbGVycyA9IF9oYW5kbGVyc1tcIipcIl0gfHwgW107XG4gICAgdmFyIHNwZWNpZmljVHlwZUhhbmRsZXJzID0gX2hhbmRsZXJzW2V2ZW50LnR5cGVdIHx8IFtdO1xuICAgIHZhciBoYW5kbGVycyA9IHdpbGRjYXJkVHlwZUhhbmRsZXJzLmNvbmNhdChzcGVjaWZpY1R5cGVIYW5kbGVycyk7XG4gICAgaWYgKGhhbmRsZXJzICYmIGhhbmRsZXJzLmxlbmd0aCkge1xuICAgICAgdmFyIGksIGxlbiwgZnVuYywgY29udGV4dCwgZXZlbnRDb3B5LCBvcmlnaW5hbENvbnRleHQgPSB0aGlzO1xuICAgICAgZm9yIChpID0gMCwgbGVuID0gaGFuZGxlcnMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgZnVuYyA9IGhhbmRsZXJzW2ldO1xuICAgICAgICBjb250ZXh0ID0gb3JpZ2luYWxDb250ZXh0O1xuICAgICAgICBpZiAodHlwZW9mIGZ1bmMgPT09IFwic3RyaW5nXCIgJiYgdHlwZW9mIF93aW5kb3dbZnVuY10gPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgIGZ1bmMgPSBfd2luZG93W2Z1bmNdO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgZnVuYyA9PT0gXCJvYmplY3RcIiAmJiBmdW5jICYmIHR5cGVvZiBmdW5jLmhhbmRsZUV2ZW50ID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICBjb250ZXh0ID0gZnVuYztcbiAgICAgICAgICBmdW5jID0gZnVuYy5oYW5kbGVFdmVudDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGZ1bmMgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgIGV2ZW50Q29weSA9IF9leHRlbmQoe30sIGV2ZW50KTtcbiAgICAgICAgICBfZGlzcGF0Y2hDYWxsYmFjayhmdW5jLCBjb250ZXh0LCBbIGV2ZW50Q29weSBdLCBhc3luYyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG4gIC8qKlxuICogQ2hlY2sgYW4gYGVycm9yYCBldmVudCdzIGBuYW1lYCBwcm9wZXJ0eSB0byBzZWUgaWYgRmxhc2ggaGFzXG4gKiBhbHJlYWR5IGxvYWRlZCwgd2hpY2ggcnVsZXMgb3V0IHBvc3NpYmxlIGBpZnJhbWVgIHNhbmRib3hpbmcuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZ2V0U2FuZGJveFN0YXR1c0Zyb21FcnJvckV2ZW50ID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICB2YXIgaXNTYW5kYm94ZWQgPSBudWxsO1xuICAgIGlmIChfcGFnZUlzRnJhbWVkID09PSBmYWxzZSB8fCBldmVudCAmJiBldmVudC50eXBlID09PSBcImVycm9yXCIgJiYgZXZlbnQubmFtZSAmJiBfZXJyb3JzVGhhdE9ubHlPY2N1ckFmdGVyRmxhc2hMb2Fkcy5pbmRleE9mKGV2ZW50Lm5hbWUpICE9PSAtMSkge1xuICAgICAgaXNTYW5kYm94ZWQgPSBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIGlzU2FuZGJveGVkO1xuICB9O1xuICAvKipcbiAqIFByZXByb2Nlc3MgYW55IHNwZWNpYWwgYmVoYXZpb3JzLCByZWFjdGlvbnMsIG9yIHN0YXRlIGNoYW5nZXMgYWZ0ZXIgcmVjZWl2aW5nIHRoaXMgZXZlbnQuXG4gKiBFeGVjdXRlcyBvbmx5IG9uY2UgcGVyIGV2ZW50IGVtaXR0ZWQsIE5PVCBvbmNlIHBlciBjbGllbnQuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfcHJlcHJvY2Vzc0V2ZW50ID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICB2YXIgZWxlbWVudCA9IGV2ZW50LnRhcmdldCB8fCBfY3VycmVudEVsZW1lbnQgfHwgbnVsbDtcbiAgICB2YXIgc291cmNlSXNTd2YgPSBldmVudC5fc291cmNlID09PSBcInN3ZlwiO1xuICAgIGRlbGV0ZSBldmVudC5fc291cmNlO1xuICAgIHN3aXRjaCAoZXZlbnQudHlwZSkge1xuICAgICBjYXNlIFwiZXJyb3JcIjpcbiAgICAgIHZhciBpc1NhbmRib3hlZCA9IGV2ZW50Lm5hbWUgPT09IFwiZmxhc2gtc2FuZGJveGVkXCIgfHwgX2dldFNhbmRib3hTdGF0dXNGcm9tRXJyb3JFdmVudChldmVudCk7XG4gICAgICBpZiAodHlwZW9mIGlzU2FuZGJveGVkID09PSBcImJvb2xlYW5cIikge1xuICAgICAgICBfZmxhc2hTdGF0ZS5zYW5kYm94ZWQgPSBpc1NhbmRib3hlZDtcbiAgICAgIH1cbiAgICAgIGlmIChfZmxhc2hTdGF0ZUVycm9yTmFtZXMuaW5kZXhPZihldmVudC5uYW1lKSAhPT0gLTEpIHtcbiAgICAgICAgX2V4dGVuZChfZmxhc2hTdGF0ZSwge1xuICAgICAgICAgIGRpc2FibGVkOiBldmVudC5uYW1lID09PSBcImZsYXNoLWRpc2FibGVkXCIsXG4gICAgICAgICAgb3V0ZGF0ZWQ6IGV2ZW50Lm5hbWUgPT09IFwiZmxhc2gtb3V0ZGF0ZWRcIixcbiAgICAgICAgICB1bmF2YWlsYWJsZTogZXZlbnQubmFtZSA9PT0gXCJmbGFzaC11bmF2YWlsYWJsZVwiLFxuICAgICAgICAgIGRlZ3JhZGVkOiBldmVudC5uYW1lID09PSBcImZsYXNoLWRlZ3JhZGVkXCIsXG4gICAgICAgICAgZGVhY3RpdmF0ZWQ6IGV2ZW50Lm5hbWUgPT09IFwiZmxhc2gtZGVhY3RpdmF0ZWRcIixcbiAgICAgICAgICBvdmVyZHVlOiBldmVudC5uYW1lID09PSBcImZsYXNoLW92ZXJkdWVcIixcbiAgICAgICAgICByZWFkeTogZmFsc2VcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2UgaWYgKGV2ZW50Lm5hbWUgPT09IFwidmVyc2lvbi1taXNtYXRjaFwiKSB7XG4gICAgICAgIF96Y1N3ZlZlcnNpb24gPSBldmVudC5zd2ZWZXJzaW9uO1xuICAgICAgICBfZXh0ZW5kKF9mbGFzaFN0YXRlLCB7XG4gICAgICAgICAgZGlzYWJsZWQ6IGZhbHNlLFxuICAgICAgICAgIG91dGRhdGVkOiBmYWxzZSxcbiAgICAgICAgICB1bmF2YWlsYWJsZTogZmFsc2UsXG4gICAgICAgICAgZGVncmFkZWQ6IGZhbHNlLFxuICAgICAgICAgIGRlYWN0aXZhdGVkOiBmYWxzZSxcbiAgICAgICAgICBvdmVyZHVlOiBmYWxzZSxcbiAgICAgICAgICByZWFkeTogZmFsc2VcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBfY2xlYXJUaW1lb3V0c0FuZFBvbGxpbmcoKTtcbiAgICAgIGJyZWFrO1xuXG4gICAgIGNhc2UgXCJyZWFkeVwiOlxuICAgICAgX3pjU3dmVmVyc2lvbiA9IGV2ZW50LnN3ZlZlcnNpb247XG4gICAgICB2YXIgd2FzRGVhY3RpdmF0ZWQgPSBfZmxhc2hTdGF0ZS5kZWFjdGl2YXRlZCA9PT0gdHJ1ZTtcbiAgICAgIF9leHRlbmQoX2ZsYXNoU3RhdGUsIHtcbiAgICAgICAgZGlzYWJsZWQ6IGZhbHNlLFxuICAgICAgICBvdXRkYXRlZDogZmFsc2UsXG4gICAgICAgIHNhbmRib3hlZDogZmFsc2UsXG4gICAgICAgIHVuYXZhaWxhYmxlOiBmYWxzZSxcbiAgICAgICAgZGVncmFkZWQ6IGZhbHNlLFxuICAgICAgICBkZWFjdGl2YXRlZDogZmFsc2UsXG4gICAgICAgIG92ZXJkdWU6IHdhc0RlYWN0aXZhdGVkLFxuICAgICAgICByZWFkeTogIXdhc0RlYWN0aXZhdGVkXG4gICAgICB9KTtcbiAgICAgIF9jbGVhclRpbWVvdXRzQW5kUG9sbGluZygpO1xuICAgICAgYnJlYWs7XG5cbiAgICAgY2FzZSBcImJlZm9yZWNvcHlcIjpcbiAgICAgIF9jb3B5VGFyZ2V0ID0gZWxlbWVudDtcbiAgICAgIGJyZWFrO1xuXG4gICAgIGNhc2UgXCJjb3B5XCI6XG4gICAgICB2YXIgdGV4dENvbnRlbnQsIGh0bWxDb250ZW50LCB0YXJnZXRFbCA9IGV2ZW50LnJlbGF0ZWRUYXJnZXQ7XG4gICAgICBpZiAoIShfY2xpcERhdGFbXCJ0ZXh0L2h0bWxcIl0gfHwgX2NsaXBEYXRhW1widGV4dC9wbGFpblwiXSkgJiYgdGFyZ2V0RWwgJiYgKGh0bWxDb250ZW50ID0gdGFyZ2V0RWwudmFsdWUgfHwgdGFyZ2V0RWwub3V0ZXJIVE1MIHx8IHRhcmdldEVsLmlubmVySFRNTCkgJiYgKHRleHRDb250ZW50ID0gdGFyZ2V0RWwudmFsdWUgfHwgdGFyZ2V0RWwudGV4dENvbnRlbnQgfHwgdGFyZ2V0RWwuaW5uZXJUZXh0KSkge1xuICAgICAgICBldmVudC5jbGlwYm9hcmREYXRhLmNsZWFyRGF0YSgpO1xuICAgICAgICBldmVudC5jbGlwYm9hcmREYXRhLnNldERhdGEoXCJ0ZXh0L3BsYWluXCIsIHRleHRDb250ZW50KTtcbiAgICAgICAgaWYgKGh0bWxDb250ZW50ICE9PSB0ZXh0Q29udGVudCkge1xuICAgICAgICAgIGV2ZW50LmNsaXBib2FyZERhdGEuc2V0RGF0YShcInRleHQvaHRtbFwiLCBodG1sQ29udGVudCk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoIV9jbGlwRGF0YVtcInRleHQvcGxhaW5cIl0gJiYgZXZlbnQudGFyZ2V0ICYmICh0ZXh0Q29udGVudCA9IGV2ZW50LnRhcmdldC5nZXRBdHRyaWJ1dGUoXCJkYXRhLWNsaXBib2FyZC10ZXh0XCIpKSkge1xuICAgICAgICBldmVudC5jbGlwYm9hcmREYXRhLmNsZWFyRGF0YSgpO1xuICAgICAgICBldmVudC5jbGlwYm9hcmREYXRhLnNldERhdGEoXCJ0ZXh0L3BsYWluXCIsIHRleHRDb250ZW50KTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuXG4gICAgIGNhc2UgXCJhZnRlcmNvcHlcIjpcbiAgICAgIF9xdWV1ZUVtaXRDbGlwYm9hcmRFcnJvcnMoZXZlbnQpO1xuICAgICAgWmVyb0NsaXBib2FyZC5jbGVhckRhdGEoKTtcbiAgICAgIGlmIChlbGVtZW50ICYmIGVsZW1lbnQgIT09IF9zYWZlQWN0aXZlRWxlbWVudCgpICYmIGVsZW1lbnQuZm9jdXMpIHtcbiAgICAgICAgZWxlbWVudC5mb2N1cygpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG5cbiAgICAgY2FzZSBcIl9tb3VzZW92ZXJcIjpcbiAgICAgIFplcm9DbGlwYm9hcmQuZm9jdXMoZWxlbWVudCk7XG4gICAgICBpZiAoX2dsb2JhbENvbmZpZy5idWJibGVFdmVudHMgPT09IHRydWUgJiYgc291cmNlSXNTd2YpIHtcbiAgICAgICAgaWYgKGVsZW1lbnQgJiYgZWxlbWVudCAhPT0gZXZlbnQucmVsYXRlZFRhcmdldCAmJiAhX2NvbnRhaW5lZEJ5KGV2ZW50LnJlbGF0ZWRUYXJnZXQsIGVsZW1lbnQpKSB7XG4gICAgICAgICAgX2ZpcmVNb3VzZUV2ZW50KF9leHRlbmQoe30sIGV2ZW50LCB7XG4gICAgICAgICAgICB0eXBlOiBcIm1vdXNlZW50ZXJcIixcbiAgICAgICAgICAgIGJ1YmJsZXM6IGZhbHNlLFxuICAgICAgICAgICAgY2FuY2VsYWJsZTogZmFsc2VcbiAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgX2ZpcmVNb3VzZUV2ZW50KF9leHRlbmQoe30sIGV2ZW50LCB7XG4gICAgICAgICAgdHlwZTogXCJtb3VzZW92ZXJcIlxuICAgICAgICB9KSk7XG4gICAgICB9XG4gICAgICBicmVhaztcblxuICAgICBjYXNlIFwiX21vdXNlb3V0XCI6XG4gICAgICBaZXJvQ2xpcGJvYXJkLmJsdXIoKTtcbiAgICAgIGlmIChfZ2xvYmFsQ29uZmlnLmJ1YmJsZUV2ZW50cyA9PT0gdHJ1ZSAmJiBzb3VyY2VJc1N3Zikge1xuICAgICAgICBpZiAoZWxlbWVudCAmJiBlbGVtZW50ICE9PSBldmVudC5yZWxhdGVkVGFyZ2V0ICYmICFfY29udGFpbmVkQnkoZXZlbnQucmVsYXRlZFRhcmdldCwgZWxlbWVudCkpIHtcbiAgICAgICAgICBfZmlyZU1vdXNlRXZlbnQoX2V4dGVuZCh7fSwgZXZlbnQsIHtcbiAgICAgICAgICAgIHR5cGU6IFwibW91c2VsZWF2ZVwiLFxuICAgICAgICAgICAgYnViYmxlczogZmFsc2UsXG4gICAgICAgICAgICBjYW5jZWxhYmxlOiBmYWxzZVxuICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBfZmlyZU1vdXNlRXZlbnQoX2V4dGVuZCh7fSwgZXZlbnQsIHtcbiAgICAgICAgICB0eXBlOiBcIm1vdXNlb3V0XCJcbiAgICAgICAgfSkpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG5cbiAgICAgY2FzZSBcIl9tb3VzZWRvd25cIjpcbiAgICAgIF9hZGRDbGFzcyhlbGVtZW50LCBfZ2xvYmFsQ29uZmlnLmFjdGl2ZUNsYXNzKTtcbiAgICAgIGlmIChfZ2xvYmFsQ29uZmlnLmJ1YmJsZUV2ZW50cyA9PT0gdHJ1ZSAmJiBzb3VyY2VJc1N3Zikge1xuICAgICAgICBfZmlyZU1vdXNlRXZlbnQoX2V4dGVuZCh7fSwgZXZlbnQsIHtcbiAgICAgICAgICB0eXBlOiBldmVudC50eXBlLnNsaWNlKDEpXG4gICAgICAgIH0pKTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuXG4gICAgIGNhc2UgXCJfbW91c2V1cFwiOlxuICAgICAgX3JlbW92ZUNsYXNzKGVsZW1lbnQsIF9nbG9iYWxDb25maWcuYWN0aXZlQ2xhc3MpO1xuICAgICAgaWYgKF9nbG9iYWxDb25maWcuYnViYmxlRXZlbnRzID09PSB0cnVlICYmIHNvdXJjZUlzU3dmKSB7XG4gICAgICAgIF9maXJlTW91c2VFdmVudChfZXh0ZW5kKHt9LCBldmVudCwge1xuICAgICAgICAgIHR5cGU6IGV2ZW50LnR5cGUuc2xpY2UoMSlcbiAgICAgICAgfSkpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG5cbiAgICAgY2FzZSBcIl9jbGlja1wiOlxuICAgICAgX2NvcHlUYXJnZXQgPSBudWxsO1xuICAgICAgaWYgKF9nbG9iYWxDb25maWcuYnViYmxlRXZlbnRzID09PSB0cnVlICYmIHNvdXJjZUlzU3dmKSB7XG4gICAgICAgIF9maXJlTW91c2VFdmVudChfZXh0ZW5kKHt9LCBldmVudCwge1xuICAgICAgICAgIHR5cGU6IGV2ZW50LnR5cGUuc2xpY2UoMSlcbiAgICAgICAgfSkpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG5cbiAgICAgY2FzZSBcIl9tb3VzZW1vdmVcIjpcbiAgICAgIGlmIChfZ2xvYmFsQ29uZmlnLmJ1YmJsZUV2ZW50cyA9PT0gdHJ1ZSAmJiBzb3VyY2VJc1N3Zikge1xuICAgICAgICBfZmlyZU1vdXNlRXZlbnQoX2V4dGVuZCh7fSwgZXZlbnQsIHtcbiAgICAgICAgICB0eXBlOiBldmVudC50eXBlLnNsaWNlKDEpXG4gICAgICAgIH0pKTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgICBpZiAoL15fKD86Y2xpY2t8bW91c2UoPzpvdmVyfG91dHxkb3dufHVwfG1vdmUpKSQvLnRlc3QoZXZlbnQudHlwZSkpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfTtcbiAgLyoqXG4gKiBDaGVjayBhbiBcImFmdGVyY29weVwiIGV2ZW50IGZvciBjbGlwYm9hcmQgZXJyb3JzIGFuZCBlbWl0IGEgY29ycmVzcG9uZGluZyBcImVycm9yXCIgZXZlbnQuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfcXVldWVFbWl0Q2xpcGJvYXJkRXJyb3JzID0gZnVuY3Rpb24oYWZ0ZXJjb3B5RXZlbnQpIHtcbiAgICBpZiAoYWZ0ZXJjb3B5RXZlbnQuZXJyb3JzICYmIGFmdGVyY29weUV2ZW50LmVycm9ycy5sZW5ndGggPiAwKSB7XG4gICAgICB2YXIgZXJyb3JFdmVudCA9IF9kZWVwQ29weShhZnRlcmNvcHlFdmVudCk7XG4gICAgICBfZXh0ZW5kKGVycm9yRXZlbnQsIHtcbiAgICAgICAgdHlwZTogXCJlcnJvclwiLFxuICAgICAgICBuYW1lOiBcImNsaXBib2FyZC1lcnJvclwiXG4gICAgICB9KTtcbiAgICAgIGRlbGV0ZSBlcnJvckV2ZW50LnN1Y2Nlc3M7XG4gICAgICBfc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgWmVyb0NsaXBib2FyZC5lbWl0KGVycm9yRXZlbnQpO1xuICAgICAgfSwgMCk7XG4gICAgfVxuICB9O1xuICAvKipcbiAqIERpc3BhdGNoIGEgc3ludGhldGljIE1vdXNlRXZlbnQuXG4gKlxuICogQHJldHVybnMgYHVuZGVmaW5lZGBcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9maXJlTW91c2VFdmVudCA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgaWYgKCEoZXZlbnQgJiYgdHlwZW9mIGV2ZW50LnR5cGUgPT09IFwic3RyaW5nXCIgJiYgZXZlbnQpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBlLCB0YXJnZXQgPSBldmVudC50YXJnZXQgfHwgbnVsbCwgZG9jID0gdGFyZ2V0ICYmIHRhcmdldC5vd25lckRvY3VtZW50IHx8IF9kb2N1bWVudCwgZGVmYXVsdHMgPSB7XG4gICAgICB2aWV3OiBkb2MuZGVmYXVsdFZpZXcgfHwgX3dpbmRvdyxcbiAgICAgIGNhbkJ1YmJsZTogdHJ1ZSxcbiAgICAgIGNhbmNlbGFibGU6IHRydWUsXG4gICAgICBkZXRhaWw6IGV2ZW50LnR5cGUgPT09IFwiY2xpY2tcIiA/IDEgOiAwLFxuICAgICAgYnV0dG9uOiB0eXBlb2YgZXZlbnQud2hpY2ggPT09IFwibnVtYmVyXCIgPyBldmVudC53aGljaCAtIDEgOiB0eXBlb2YgZXZlbnQuYnV0dG9uID09PSBcIm51bWJlclwiID8gZXZlbnQuYnV0dG9uIDogZG9jLmNyZWF0ZUV2ZW50ID8gMCA6IDFcbiAgICB9LCBhcmdzID0gX2V4dGVuZChkZWZhdWx0cywgZXZlbnQpO1xuICAgIGlmICghdGFyZ2V0KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChkb2MuY3JlYXRlRXZlbnQgJiYgdGFyZ2V0LmRpc3BhdGNoRXZlbnQpIHtcbiAgICAgIGFyZ3MgPSBbIGFyZ3MudHlwZSwgYXJncy5jYW5CdWJibGUsIGFyZ3MuY2FuY2VsYWJsZSwgYXJncy52aWV3LCBhcmdzLmRldGFpbCwgYXJncy5zY3JlZW5YLCBhcmdzLnNjcmVlblksIGFyZ3MuY2xpZW50WCwgYXJncy5jbGllbnRZLCBhcmdzLmN0cmxLZXksIGFyZ3MuYWx0S2V5LCBhcmdzLnNoaWZ0S2V5LCBhcmdzLm1ldGFLZXksIGFyZ3MuYnV0dG9uLCBhcmdzLnJlbGF0ZWRUYXJnZXQgXTtcbiAgICAgIGUgPSBkb2MuY3JlYXRlRXZlbnQoXCJNb3VzZUV2ZW50c1wiKTtcbiAgICAgIGlmIChlLmluaXRNb3VzZUV2ZW50KSB7XG4gICAgICAgIGUuaW5pdE1vdXNlRXZlbnQuYXBwbHkoZSwgYXJncyk7XG4gICAgICAgIGUuX3NvdXJjZSA9IFwianNcIjtcbiAgICAgICAgdGFyZ2V0LmRpc3BhdGNoRXZlbnQoZSk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuICAvKipcbiAqIENvbnRpbnVvdXNseSBwb2xsIHRoZSBET00gdW50aWwgZWl0aGVyOlxuICogIChhKSB0aGUgZmFsbGJhY2sgY29udGVudCBiZWNvbWVzIHZpc2libGUsIG9yXG4gKiAgKGIpIHdlIHJlY2VpdmUgYW4gZXZlbnQgZnJvbSBTV0YgKGhhbmRsZWQgZWxzZXdoZXJlKVxuICpcbiAqIElNUE9SVEFOVDpcbiAqIFRoaXMgaXMgTk9UIGEgbmVjZXNzYXJ5IGNoZWNrIGJ1dCBpdCBjYW4gcmVzdWx0IGluIHNpZ25pZmljYW50bHkgZmFzdGVyXG4gKiBkZXRlY3Rpb24gb2YgYmFkIGBzd2ZQYXRoYCBjb25maWd1cmF0aW9uIGFuZC9vciBuZXR3b3JrL3NlcnZlciBpc3N1ZXMgW2luXG4gKiBzdXBwb3J0ZWQgYnJvd3NlcnNdIHRoYW4gd2FpdGluZyBmb3IgdGhlIGVudGlyZSBgZmxhc2hMb2FkVGltZW91dGAgZHVyYXRpb25cbiAqIHRvIGVsYXBzZSBiZWZvcmUgZGV0ZWN0aW5nIHRoYXQgdGhlIFNXRiBjYW5ub3QgYmUgbG9hZGVkLiBUaGUgZGV0ZWN0aW9uXG4gKiBkdXJhdGlvbiBjYW4gYmUgYW55d2hlcmUgZnJvbSAxMC0zMCB0aW1lcyBmYXN0ZXIgW2luIHN1cHBvcnRlZCBicm93c2Vyc10gYnlcbiAqIHVzaW5nIHRoaXMgYXBwcm9hY2guXG4gKlxuICogQHJldHVybnMgYHVuZGVmaW5lZGBcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF93YXRjaEZvclN3ZkZhbGxiYWNrQ29udGVudCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBtYXhXYWl0ID0gX2dsb2JhbENvbmZpZy5mbGFzaExvYWRUaW1lb3V0O1xuICAgIGlmICh0eXBlb2YgbWF4V2FpdCA9PT0gXCJudW1iZXJcIiAmJiBtYXhXYWl0ID49IDApIHtcbiAgICAgIHZhciBwb2xsV2FpdCA9IE1hdGgubWluKDFlMywgbWF4V2FpdCAvIDEwKTtcbiAgICAgIHZhciBmYWxsYmFja0NvbnRlbnRJZCA9IF9nbG9iYWxDb25maWcuc3dmT2JqZWN0SWQgKyBcIl9mYWxsYmFja0NvbnRlbnRcIjtcbiAgICAgIF9zd2ZGYWxsYmFja0NoZWNrSW50ZXJ2YWwgPSBfc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBlbCA9IF9kb2N1bWVudC5nZXRFbGVtZW50QnlJZChmYWxsYmFja0NvbnRlbnRJZCk7XG4gICAgICAgIGlmIChfaXNFbGVtZW50VmlzaWJsZShlbCkpIHtcbiAgICAgICAgICBfY2xlYXJUaW1lb3V0c0FuZFBvbGxpbmcoKTtcbiAgICAgICAgICBfZmxhc2hTdGF0ZS5kZWFjdGl2YXRlZCA9IG51bGw7XG4gICAgICAgICAgWmVyb0NsaXBib2FyZC5lbWl0KHtcbiAgICAgICAgICAgIHR5cGU6IFwiZXJyb3JcIixcbiAgICAgICAgICAgIG5hbWU6IFwic3dmLW5vdC1mb3VuZFwiXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0sIHBvbGxXYWl0KTtcbiAgICB9XG4gIH07XG4gIC8qKlxuICogQ3JlYXRlIHRoZSBIVE1MIGJyaWRnZSBlbGVtZW50IHRvIGVtYmVkIHRoZSBGbGFzaCBvYmplY3QgaW50by5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9jcmVhdGVIdG1sQnJpZGdlID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGNvbnRhaW5lciA9IF9kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIGNvbnRhaW5lci5pZCA9IF9nbG9iYWxDb25maWcuY29udGFpbmVySWQ7XG4gICAgY29udGFpbmVyLmNsYXNzTmFtZSA9IF9nbG9iYWxDb25maWcuY29udGFpbmVyQ2xhc3M7XG4gICAgY29udGFpbmVyLnN0eWxlLnBvc2l0aW9uID0gXCJhYnNvbHV0ZVwiO1xuICAgIGNvbnRhaW5lci5zdHlsZS5sZWZ0ID0gXCIwcHhcIjtcbiAgICBjb250YWluZXIuc3R5bGUudG9wID0gXCItOTk5OXB4XCI7XG4gICAgY29udGFpbmVyLnN0eWxlLndpZHRoID0gXCIxcHhcIjtcbiAgICBjb250YWluZXIuc3R5bGUuaGVpZ2h0ID0gXCIxcHhcIjtcbiAgICBjb250YWluZXIuc3R5bGUuekluZGV4ID0gXCJcIiArIF9nZXRTYWZlWkluZGV4KF9nbG9iYWxDb25maWcuekluZGV4KTtcbiAgICByZXR1cm4gY29udGFpbmVyO1xuICB9O1xuICAvKipcbiAqIEdldCB0aGUgSFRNTCBlbGVtZW50IGNvbnRhaW5lciB0aGF0IHdyYXBzIHRoZSBGbGFzaCBicmlkZ2Ugb2JqZWN0L2VsZW1lbnQuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZ2V0SHRtbEJyaWRnZSA9IGZ1bmN0aW9uKGZsYXNoQnJpZGdlKSB7XG4gICAgdmFyIGh0bWxCcmlkZ2UgPSBmbGFzaEJyaWRnZSAmJiBmbGFzaEJyaWRnZS5wYXJlbnROb2RlO1xuICAgIHdoaWxlIChodG1sQnJpZGdlICYmIGh0bWxCcmlkZ2Uubm9kZU5hbWUgPT09IFwiT0JKRUNUXCIgJiYgaHRtbEJyaWRnZS5wYXJlbnROb2RlKSB7XG4gICAgICBodG1sQnJpZGdlID0gaHRtbEJyaWRnZS5wYXJlbnROb2RlO1xuICAgIH1cbiAgICByZXR1cm4gaHRtbEJyaWRnZSB8fCBudWxsO1xuICB9O1xuICAvKipcbiAqIENyZWF0ZSB0aGUgU1dGIG9iamVjdC5cbiAqXG4gKiBAcmV0dXJucyBUaGUgU1dGIG9iamVjdCByZWZlcmVuY2UuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZW1iZWRTd2YgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgbGVuLCBmbGFzaEJyaWRnZSA9IF9mbGFzaFN0YXRlLmJyaWRnZSwgY29udGFpbmVyID0gX2dldEh0bWxCcmlkZ2UoZmxhc2hCcmlkZ2UpO1xuICAgIGlmICghZmxhc2hCcmlkZ2UpIHtcbiAgICAgIHZhciBhbGxvd1NjcmlwdEFjY2VzcyA9IF9kZXRlcm1pbmVTY3JpcHRBY2Nlc3MoX3dpbmRvdy5sb2NhdGlvbi5ob3N0LCBfZ2xvYmFsQ29uZmlnKTtcbiAgICAgIHZhciBhbGxvd05ldHdvcmtpbmcgPSBhbGxvd1NjcmlwdEFjY2VzcyA9PT0gXCJuZXZlclwiID8gXCJub25lXCIgOiBcImFsbFwiO1xuICAgICAgdmFyIGZsYXNodmFycyA9IF92YXJzKF9leHRlbmQoe1xuICAgICAgICBqc1ZlcnNpb246IFplcm9DbGlwYm9hcmQudmVyc2lvblxuICAgICAgfSwgX2dsb2JhbENvbmZpZykpO1xuICAgICAgdmFyIHN3ZlVybCA9IF9nbG9iYWxDb25maWcuc3dmUGF0aCArIF9jYWNoZUJ1c3QoX2dsb2JhbENvbmZpZy5zd2ZQYXRoLCBfZ2xvYmFsQ29uZmlnKTtcbiAgICAgIGNvbnRhaW5lciA9IF9jcmVhdGVIdG1sQnJpZGdlKCk7XG4gICAgICB2YXIgZGl2VG9CZVJlcGxhY2VkID0gX2RvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoZGl2VG9CZVJlcGxhY2VkKTtcbiAgICAgIF9kb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGNvbnRhaW5lcik7XG4gICAgICB2YXIgdG1wRGl2ID0gX2RvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICB2YXIgdXNpbmdBY3RpdmVYID0gX2ZsYXNoU3RhdGUucGx1Z2luVHlwZSA9PT0gXCJhY3RpdmV4XCI7XG4gICAgICB0bXBEaXYuaW5uZXJIVE1MID0gJzxvYmplY3QgaWQ9XCInICsgX2dsb2JhbENvbmZpZy5zd2ZPYmplY3RJZCArICdcIiBuYW1lPVwiJyArIF9nbG9iYWxDb25maWcuc3dmT2JqZWN0SWQgKyAnXCIgJyArICd3aWR0aD1cIjEwMCVcIiBoZWlnaHQ9XCIxMDAlXCIgJyArICh1c2luZ0FjdGl2ZVggPyAnY2xhc3NpZD1cImNsc2lkOmQyN2NkYjZlLWFlNmQtMTFjZi05NmI4LTQ0NDU1MzU0MDAwMFwiJyA6ICd0eXBlPVwiYXBwbGljYXRpb24veC1zaG9ja3dhdmUtZmxhc2hcIiBkYXRhPVwiJyArIHN3ZlVybCArICdcIicpICsgXCI+XCIgKyAodXNpbmdBY3RpdmVYID8gJzxwYXJhbSBuYW1lPVwibW92aWVcIiB2YWx1ZT1cIicgKyBzd2ZVcmwgKyAnXCIvPicgOiBcIlwiKSArICc8cGFyYW0gbmFtZT1cImFsbG93U2NyaXB0QWNjZXNzXCIgdmFsdWU9XCInICsgYWxsb3dTY3JpcHRBY2Nlc3MgKyAnXCIvPicgKyAnPHBhcmFtIG5hbWU9XCJhbGxvd05ldHdvcmtpbmdcIiB2YWx1ZT1cIicgKyBhbGxvd05ldHdvcmtpbmcgKyAnXCIvPicgKyAnPHBhcmFtIG5hbWU9XCJtZW51XCIgdmFsdWU9XCJmYWxzZVwiLz4nICsgJzxwYXJhbSBuYW1lPVwid21vZGVcIiB2YWx1ZT1cInRyYW5zcGFyZW50XCIvPicgKyAnPHBhcmFtIG5hbWU9XCJmbGFzaHZhcnNcIiB2YWx1ZT1cIicgKyBmbGFzaHZhcnMgKyAnXCIvPicgKyAnPGRpdiBpZD1cIicgKyBfZ2xvYmFsQ29uZmlnLnN3Zk9iamVjdElkICsgJ19mYWxsYmFja0NvbnRlbnRcIj4mbmJzcDs8L2Rpdj4nICsgXCI8L29iamVjdD5cIjtcbiAgICAgIGZsYXNoQnJpZGdlID0gdG1wRGl2LmZpcnN0Q2hpbGQ7XG4gICAgICB0bXBEaXYgPSBudWxsO1xuICAgICAgX3Vud3JhcChmbGFzaEJyaWRnZSkuWmVyb0NsaXBib2FyZCA9IFplcm9DbGlwYm9hcmQ7XG4gICAgICBjb250YWluZXIucmVwbGFjZUNoaWxkKGZsYXNoQnJpZGdlLCBkaXZUb0JlUmVwbGFjZWQpO1xuICAgICAgX3dhdGNoRm9yU3dmRmFsbGJhY2tDb250ZW50KCk7XG4gICAgfVxuICAgIGlmICghZmxhc2hCcmlkZ2UpIHtcbiAgICAgIGZsYXNoQnJpZGdlID0gX2RvY3VtZW50W19nbG9iYWxDb25maWcuc3dmT2JqZWN0SWRdO1xuICAgICAgaWYgKGZsYXNoQnJpZGdlICYmIChsZW4gPSBmbGFzaEJyaWRnZS5sZW5ndGgpKSB7XG4gICAgICAgIGZsYXNoQnJpZGdlID0gZmxhc2hCcmlkZ2VbbGVuIC0gMV07XG4gICAgICB9XG4gICAgICBpZiAoIWZsYXNoQnJpZGdlICYmIGNvbnRhaW5lcikge1xuICAgICAgICBmbGFzaEJyaWRnZSA9IGNvbnRhaW5lci5maXJzdENoaWxkO1xuICAgICAgfVxuICAgIH1cbiAgICBfZmxhc2hTdGF0ZS5icmlkZ2UgPSBmbGFzaEJyaWRnZSB8fCBudWxsO1xuICAgIHJldHVybiBmbGFzaEJyaWRnZTtcbiAgfTtcbiAgLyoqXG4gKiBEZXN0cm95IHRoZSBTV0Ygb2JqZWN0LlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX3VuZW1iZWRTd2YgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgZmxhc2hCcmlkZ2UgPSBfZmxhc2hTdGF0ZS5icmlkZ2U7XG4gICAgaWYgKGZsYXNoQnJpZGdlKSB7XG4gICAgICB2YXIgaHRtbEJyaWRnZSA9IF9nZXRIdG1sQnJpZGdlKGZsYXNoQnJpZGdlKTtcbiAgICAgIGlmIChodG1sQnJpZGdlKSB7XG4gICAgICAgIGlmIChfZmxhc2hTdGF0ZS5wbHVnaW5UeXBlID09PSBcImFjdGl2ZXhcIiAmJiBcInJlYWR5U3RhdGVcIiBpbiBmbGFzaEJyaWRnZSkge1xuICAgICAgICAgIGZsYXNoQnJpZGdlLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICAgICAgICAoZnVuY3Rpb24gcmVtb3ZlU3dmRnJvbUlFKCkge1xuICAgICAgICAgICAgaWYgKGZsYXNoQnJpZGdlLnJlYWR5U3RhdGUgPT09IDQpIHtcbiAgICAgICAgICAgICAgZm9yICh2YXIgcHJvcCBpbiBmbGFzaEJyaWRnZSkge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZmxhc2hCcmlkZ2VbcHJvcF0gPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgICAgZmxhc2hCcmlkZ2VbcHJvcF0gPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBpZiAoZmxhc2hCcmlkZ2UucGFyZW50Tm9kZSkge1xuICAgICAgICAgICAgICAgIGZsYXNoQnJpZGdlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZmxhc2hCcmlkZ2UpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGlmIChodG1sQnJpZGdlLnBhcmVudE5vZGUpIHtcbiAgICAgICAgICAgICAgICBodG1sQnJpZGdlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoaHRtbEJyaWRnZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIF9zZXRUaW1lb3V0KHJlbW92ZVN3ZkZyb21JRSwgMTApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKGZsYXNoQnJpZGdlLnBhcmVudE5vZGUpIHtcbiAgICAgICAgICAgIGZsYXNoQnJpZGdlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZmxhc2hCcmlkZ2UpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoaHRtbEJyaWRnZS5wYXJlbnROb2RlKSB7XG4gICAgICAgICAgICBodG1sQnJpZGdlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoaHRtbEJyaWRnZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBfY2xlYXJUaW1lb3V0c0FuZFBvbGxpbmcoKTtcbiAgICAgIF9mbGFzaFN0YXRlLnJlYWR5ID0gbnVsbDtcbiAgICAgIF9mbGFzaFN0YXRlLmJyaWRnZSA9IG51bGw7XG4gICAgICBfZmxhc2hTdGF0ZS5kZWFjdGl2YXRlZCA9IG51bGw7XG4gICAgICBfemNTd2ZWZXJzaW9uID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgfTtcbiAgLyoqXG4gKiBNYXAgdGhlIGRhdGEgZm9ybWF0IG5hbWVzIG9mIHRoZSBcImNsaXBEYXRhXCIgdG8gRmxhc2gtZnJpZW5kbHkgbmFtZXMuXG4gKlxuICogQHJldHVybnMgQSBuZXcgdHJhbnNmb3JtZWQgb2JqZWN0LlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX21hcENsaXBEYXRhVG9GbGFzaCA9IGZ1bmN0aW9uKGNsaXBEYXRhKSB7XG4gICAgdmFyIG5ld0NsaXBEYXRhID0ge30sIGZvcm1hdE1hcCA9IHt9O1xuICAgIGlmICghKHR5cGVvZiBjbGlwRGF0YSA9PT0gXCJvYmplY3RcIiAmJiBjbGlwRGF0YSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZm9yICh2YXIgZGF0YUZvcm1hdCBpbiBjbGlwRGF0YSkge1xuICAgICAgaWYgKGRhdGFGb3JtYXQgJiYgX2hhc093bi5jYWxsKGNsaXBEYXRhLCBkYXRhRm9ybWF0KSAmJiB0eXBlb2YgY2xpcERhdGFbZGF0YUZvcm1hdF0gPT09IFwic3RyaW5nXCIgJiYgY2xpcERhdGFbZGF0YUZvcm1hdF0pIHtcbiAgICAgICAgc3dpdGNoIChkYXRhRm9ybWF0LnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgIGNhc2UgXCJ0ZXh0L3BsYWluXCI6XG4gICAgICAgICBjYXNlIFwidGV4dFwiOlxuICAgICAgICAgY2FzZSBcImFpcjp0ZXh0XCI6XG4gICAgICAgICBjYXNlIFwiZmxhc2g6dGV4dFwiOlxuICAgICAgICAgIG5ld0NsaXBEYXRhLnRleHQgPSBjbGlwRGF0YVtkYXRhRm9ybWF0XTtcbiAgICAgICAgICBmb3JtYXRNYXAudGV4dCA9IGRhdGFGb3JtYXQ7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgIGNhc2UgXCJ0ZXh0L2h0bWxcIjpcbiAgICAgICAgIGNhc2UgXCJodG1sXCI6XG4gICAgICAgICBjYXNlIFwiYWlyOmh0bWxcIjpcbiAgICAgICAgIGNhc2UgXCJmbGFzaDpodG1sXCI6XG4gICAgICAgICAgbmV3Q2xpcERhdGEuaHRtbCA9IGNsaXBEYXRhW2RhdGFGb3JtYXRdO1xuICAgICAgICAgIGZvcm1hdE1hcC5odG1sID0gZGF0YUZvcm1hdDtcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICAgY2FzZSBcImFwcGxpY2F0aW9uL3J0ZlwiOlxuICAgICAgICAgY2FzZSBcInRleHQvcnRmXCI6XG4gICAgICAgICBjYXNlIFwicnRmXCI6XG4gICAgICAgICBjYXNlIFwicmljaHRleHRcIjpcbiAgICAgICAgIGNhc2UgXCJhaXI6cnRmXCI6XG4gICAgICAgICBjYXNlIFwiZmxhc2g6cnRmXCI6XG4gICAgICAgICAgbmV3Q2xpcERhdGEucnRmID0gY2xpcERhdGFbZGF0YUZvcm1hdF07XG4gICAgICAgICAgZm9ybWF0TWFwLnJ0ZiA9IGRhdGFGb3JtYXQ7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgIGRhdGE6IG5ld0NsaXBEYXRhLFxuICAgICAgZm9ybWF0TWFwOiBmb3JtYXRNYXBcbiAgICB9O1xuICB9O1xuICAvKipcbiAqIE1hcCB0aGUgZGF0YSBmb3JtYXQgbmFtZXMgZnJvbSBGbGFzaC1mcmllbmRseSBuYW1lcyBiYWNrIHRvIHRoZWlyIG9yaWdpbmFsIFwiY2xpcERhdGFcIiBuYW1lcyAodmlhIGEgZm9ybWF0IG1hcHBpbmcpLlxuICpcbiAqIEByZXR1cm5zIEEgbmV3IHRyYW5zZm9ybWVkIG9iamVjdC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9tYXBDbGlwUmVzdWx0c0Zyb21GbGFzaCA9IGZ1bmN0aW9uKGNsaXBSZXN1bHRzLCBmb3JtYXRNYXApIHtcbiAgICBpZiAoISh0eXBlb2YgY2xpcFJlc3VsdHMgPT09IFwib2JqZWN0XCIgJiYgY2xpcFJlc3VsdHMgJiYgdHlwZW9mIGZvcm1hdE1hcCA9PT0gXCJvYmplY3RcIiAmJiBmb3JtYXRNYXApKSB7XG4gICAgICByZXR1cm4gY2xpcFJlc3VsdHM7XG4gICAgfVxuICAgIHZhciBuZXdSZXN1bHRzID0ge307XG4gICAgZm9yICh2YXIgcHJvcCBpbiBjbGlwUmVzdWx0cykge1xuICAgICAgaWYgKF9oYXNPd24uY2FsbChjbGlwUmVzdWx0cywgcHJvcCkpIHtcbiAgICAgICAgaWYgKHByb3AgPT09IFwiZXJyb3JzXCIpIHtcbiAgICAgICAgICBuZXdSZXN1bHRzW3Byb3BdID0gY2xpcFJlc3VsdHNbcHJvcF0gPyBjbGlwUmVzdWx0c1twcm9wXS5zbGljZSgpIDogW107XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IG5ld1Jlc3VsdHNbcHJvcF0ubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIG5ld1Jlc3VsdHNbcHJvcF1baV0uZm9ybWF0ID0gZm9ybWF0TWFwW25ld1Jlc3VsdHNbcHJvcF1baV0uZm9ybWF0XTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAocHJvcCAhPT0gXCJzdWNjZXNzXCIgJiYgcHJvcCAhPT0gXCJkYXRhXCIpIHtcbiAgICAgICAgICBuZXdSZXN1bHRzW3Byb3BdID0gY2xpcFJlc3VsdHNbcHJvcF07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbmV3UmVzdWx0c1twcm9wXSA9IHt9O1xuICAgICAgICAgIHZhciB0bXBIYXNoID0gY2xpcFJlc3VsdHNbcHJvcF07XG4gICAgICAgICAgZm9yICh2YXIgZGF0YUZvcm1hdCBpbiB0bXBIYXNoKSB7XG4gICAgICAgICAgICBpZiAoZGF0YUZvcm1hdCAmJiBfaGFzT3duLmNhbGwodG1wSGFzaCwgZGF0YUZvcm1hdCkgJiYgX2hhc093bi5jYWxsKGZvcm1hdE1hcCwgZGF0YUZvcm1hdCkpIHtcbiAgICAgICAgICAgICAgbmV3UmVzdWx0c1twcm9wXVtmb3JtYXRNYXBbZGF0YUZvcm1hdF1dID0gdG1wSGFzaFtkYXRhRm9ybWF0XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG5ld1Jlc3VsdHM7XG4gIH07XG4gIC8qKlxuICogV2lsbCBsb29rIGF0IGEgcGF0aCwgYW5kIHdpbGwgY3JlYXRlIGEgXCI/bm9DYWNoZT17dGltZX1cIiBvciBcIiZub0NhY2hlPXt0aW1lfVwiXG4gKiBxdWVyeSBwYXJhbSBzdHJpbmcgdG8gcmV0dXJuLiBEb2VzIE5PVCBhcHBlbmQgdGhhdCBzdHJpbmcgdG8gdGhlIG9yaWdpbmFsIHBhdGguXG4gKiBUaGlzIGlzIHVzZWZ1bCBiZWNhdXNlIEV4dGVybmFsSW50ZXJmYWNlIG9mdGVuIGJyZWFrcyB3aGVuIGEgRmxhc2ggU1dGIGlzIGNhY2hlZC5cbiAqXG4gKiBAcmV0dXJucyBUaGUgYG5vQ2FjaGVgIHF1ZXJ5IHBhcmFtIHdpdGggbmVjZXNzYXJ5IFwiP1wiL1wiJlwiIHByZWZpeC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9jYWNoZUJ1c3QgPSBmdW5jdGlvbihwYXRoLCBvcHRpb25zKSB7XG4gICAgdmFyIGNhY2hlQnVzdCA9IG9wdGlvbnMgPT0gbnVsbCB8fCBvcHRpb25zICYmIG9wdGlvbnMuY2FjaGVCdXN0ID09PSB0cnVlO1xuICAgIGlmIChjYWNoZUJ1c3QpIHtcbiAgICAgIHJldHVybiAocGF0aC5pbmRleE9mKFwiP1wiKSA9PT0gLTEgPyBcIj9cIiA6IFwiJlwiKSArIFwibm9DYWNoZT1cIiArIF9ub3coKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIFwiXCI7XG4gICAgfVxuICB9O1xuICAvKipcbiAqIENyZWF0ZXMgYSBxdWVyeSBzdHJpbmcgZm9yIHRoZSBGbGFzaFZhcnMgcGFyYW0uXG4gKiBEb2VzIE5PVCBpbmNsdWRlIHRoZSBjYWNoZS1idXN0aW5nIHF1ZXJ5IHBhcmFtLlxuICpcbiAqIEByZXR1cm5zIEZsYXNoVmFycyBxdWVyeSBzdHJpbmdcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF92YXJzID0gZnVuY3Rpb24ob3B0aW9ucykge1xuICAgIHZhciBpLCBsZW4sIGRvbWFpbiwgZG9tYWlucywgc3RyID0gXCJcIiwgdHJ1c3RlZE9yaWdpbnNFeHBhbmRlZCA9IFtdO1xuICAgIGlmIChvcHRpb25zLnRydXN0ZWREb21haW5zKSB7XG4gICAgICBpZiAodHlwZW9mIG9wdGlvbnMudHJ1c3RlZERvbWFpbnMgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgZG9tYWlucyA9IFsgb3B0aW9ucy50cnVzdGVkRG9tYWlucyBdO1xuICAgICAgfSBlbHNlIGlmICh0eXBlb2Ygb3B0aW9ucy50cnVzdGVkRG9tYWlucyA9PT0gXCJvYmplY3RcIiAmJiBcImxlbmd0aFwiIGluIG9wdGlvbnMudHJ1c3RlZERvbWFpbnMpIHtcbiAgICAgICAgZG9tYWlucyA9IG9wdGlvbnMudHJ1c3RlZERvbWFpbnM7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChkb21haW5zICYmIGRvbWFpbnMubGVuZ3RoKSB7XG4gICAgICBmb3IgKGkgPSAwLCBsZW4gPSBkb21haW5zLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGlmIChfaGFzT3duLmNhbGwoZG9tYWlucywgaSkgJiYgZG9tYWluc1tpXSAmJiB0eXBlb2YgZG9tYWluc1tpXSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgIGRvbWFpbiA9IF9leHRyYWN0RG9tYWluKGRvbWFpbnNbaV0pO1xuICAgICAgICAgIGlmICghZG9tYWluKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGRvbWFpbiA9PT0gXCIqXCIpIHtcbiAgICAgICAgICAgIHRydXN0ZWRPcmlnaW5zRXhwYW5kZWQubGVuZ3RoID0gMDtcbiAgICAgICAgICAgIHRydXN0ZWRPcmlnaW5zRXhwYW5kZWQucHVzaChkb21haW4pO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIHRydXN0ZWRPcmlnaW5zRXhwYW5kZWQucHVzaC5hcHBseSh0cnVzdGVkT3JpZ2luc0V4cGFuZGVkLCBbIGRvbWFpbiwgXCIvL1wiICsgZG9tYWluLCBfd2luZG93LmxvY2F0aW9uLnByb3RvY29sICsgXCIvL1wiICsgZG9tYWluIF0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGlmICh0cnVzdGVkT3JpZ2luc0V4cGFuZGVkLmxlbmd0aCkge1xuICAgICAgc3RyICs9IFwidHJ1c3RlZE9yaWdpbnM9XCIgKyBfZW5jb2RlVVJJQ29tcG9uZW50KHRydXN0ZWRPcmlnaW5zRXhwYW5kZWQuam9pbihcIixcIikpO1xuICAgIH1cbiAgICBpZiAob3B0aW9ucy5mb3JjZUVuaGFuY2VkQ2xpcGJvYXJkID09PSB0cnVlKSB7XG4gICAgICBzdHIgKz0gKHN0ciA/IFwiJlwiIDogXCJcIikgKyBcImZvcmNlRW5oYW5jZWRDbGlwYm9hcmQ9dHJ1ZVwiO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIG9wdGlvbnMuc3dmT2JqZWN0SWQgPT09IFwic3RyaW5nXCIgJiYgb3B0aW9ucy5zd2ZPYmplY3RJZCkge1xuICAgICAgc3RyICs9IChzdHIgPyBcIiZcIiA6IFwiXCIpICsgXCJzd2ZPYmplY3RJZD1cIiArIF9lbmNvZGVVUklDb21wb25lbnQob3B0aW9ucy5zd2ZPYmplY3RJZCk7XG4gICAgfVxuICAgIGlmICh0eXBlb2Ygb3B0aW9ucy5qc1ZlcnNpb24gPT09IFwic3RyaW5nXCIgJiYgb3B0aW9ucy5qc1ZlcnNpb24pIHtcbiAgICAgIHN0ciArPSAoc3RyID8gXCImXCIgOiBcIlwiKSArIFwianNWZXJzaW9uPVwiICsgX2VuY29kZVVSSUNvbXBvbmVudChvcHRpb25zLmpzVmVyc2lvbik7XG4gICAgfVxuICAgIHJldHVybiBzdHI7XG4gIH07XG4gIC8qKlxuICogRXh0cmFjdCB0aGUgZG9tYWluIChlLmcuIFwiZ2l0aHViLmNvbVwiKSBmcm9tIGFuIG9yaWdpbiAoZS5nLiBcImh0dHBzOi8vZ2l0aHViLmNvbVwiKSBvclxuICogVVJMIChlLmcuIFwiaHR0cHM6Ly9naXRodWIuY29tL3plcm9jbGlwYm9hcmQvemVyb2NsaXBib2FyZC9cIikuXG4gKlxuICogQHJldHVybnMgdGhlIGRvbWFpblxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2V4dHJhY3REb21haW4gPSBmdW5jdGlvbihvcmlnaW5PclVybCkge1xuICAgIGlmIChvcmlnaW5PclVybCA9PSBudWxsIHx8IG9yaWdpbk9yVXJsID09PSBcIlwiKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgb3JpZ2luT3JVcmwgPSBvcmlnaW5PclVybC5yZXBsYWNlKC9eXFxzK3xcXHMrJC9nLCBcIlwiKTtcbiAgICBpZiAob3JpZ2luT3JVcmwgPT09IFwiXCIpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICB2YXIgcHJvdG9jb2xJbmRleCA9IG9yaWdpbk9yVXJsLmluZGV4T2YoXCIvL1wiKTtcbiAgICBvcmlnaW5PclVybCA9IHByb3RvY29sSW5kZXggPT09IC0xID8gb3JpZ2luT3JVcmwgOiBvcmlnaW5PclVybC5zbGljZShwcm90b2NvbEluZGV4ICsgMik7XG4gICAgdmFyIHBhdGhJbmRleCA9IG9yaWdpbk9yVXJsLmluZGV4T2YoXCIvXCIpO1xuICAgIG9yaWdpbk9yVXJsID0gcGF0aEluZGV4ID09PSAtMSA/IG9yaWdpbk9yVXJsIDogcHJvdG9jb2xJbmRleCA9PT0gLTEgfHwgcGF0aEluZGV4ID09PSAwID8gbnVsbCA6IG9yaWdpbk9yVXJsLnNsaWNlKDAsIHBhdGhJbmRleCk7XG4gICAgaWYgKG9yaWdpbk9yVXJsICYmIG9yaWdpbk9yVXJsLnNsaWNlKC00KS50b0xvd2VyQ2FzZSgpID09PSBcIi5zd2ZcIikge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHJldHVybiBvcmlnaW5PclVybCB8fCBudWxsO1xuICB9O1xuICAvKipcbiAqIFNldCBgYWxsb3dTY3JpcHRBY2Nlc3NgIGJhc2VkIG9uIGB0cnVzdGVkRG9tYWluc2AgYW5kIGB3aW5kb3cubG9jYXRpb24uaG9zdGAgdnMuIGBzd2ZQYXRoYC5cbiAqXG4gKiBAcmV0dXJucyBUaGUgYXBwcm9wcmlhdGUgc2NyaXB0IGFjY2VzcyBsZXZlbC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9kZXRlcm1pbmVTY3JpcHRBY2Nlc3MgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgX2V4dHJhY3RBbGxEb21haW5zID0gZnVuY3Rpb24ob3JpZ2lucykge1xuICAgICAgdmFyIGksIGxlbiwgdG1wLCByZXN1bHRzQXJyYXkgPSBbXTtcbiAgICAgIGlmICh0eXBlb2Ygb3JpZ2lucyA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICBvcmlnaW5zID0gWyBvcmlnaW5zIF07XG4gICAgICB9XG4gICAgICBpZiAoISh0eXBlb2Ygb3JpZ2lucyA9PT0gXCJvYmplY3RcIiAmJiBvcmlnaW5zICYmIHR5cGVvZiBvcmlnaW5zLmxlbmd0aCA9PT0gXCJudW1iZXJcIikpIHtcbiAgICAgICAgcmV0dXJuIHJlc3VsdHNBcnJheTtcbiAgICAgIH1cbiAgICAgIGZvciAoaSA9IDAsIGxlbiA9IG9yaWdpbnMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgaWYgKF9oYXNPd24uY2FsbChvcmlnaW5zLCBpKSAmJiAodG1wID0gX2V4dHJhY3REb21haW4ob3JpZ2luc1tpXSkpKSB7XG4gICAgICAgICAgaWYgKHRtcCA9PT0gXCIqXCIpIHtcbiAgICAgICAgICAgIHJlc3VsdHNBcnJheS5sZW5ndGggPSAwO1xuICAgICAgICAgICAgcmVzdWx0c0FycmF5LnB1c2goXCIqXCIpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChyZXN1bHRzQXJyYXkuaW5kZXhPZih0bXApID09PSAtMSkge1xuICAgICAgICAgICAgcmVzdWx0c0FycmF5LnB1c2godG1wKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHRzQXJyYXk7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24oY3VycmVudERvbWFpbiwgY29uZmlnT3B0aW9ucykge1xuICAgICAgdmFyIHN3ZkRvbWFpbiA9IF9leHRyYWN0RG9tYWluKGNvbmZpZ09wdGlvbnMuc3dmUGF0aCk7XG4gICAgICBpZiAoc3dmRG9tYWluID09PSBudWxsKSB7XG4gICAgICAgIHN3ZkRvbWFpbiA9IGN1cnJlbnREb21haW47XG4gICAgICB9XG4gICAgICB2YXIgdHJ1c3RlZERvbWFpbnMgPSBfZXh0cmFjdEFsbERvbWFpbnMoY29uZmlnT3B0aW9ucy50cnVzdGVkRG9tYWlucyk7XG4gICAgICB2YXIgbGVuID0gdHJ1c3RlZERvbWFpbnMubGVuZ3RoO1xuICAgICAgaWYgKGxlbiA+IDApIHtcbiAgICAgICAgaWYgKGxlbiA9PT0gMSAmJiB0cnVzdGVkRG9tYWluc1swXSA9PT0gXCIqXCIpIHtcbiAgICAgICAgICByZXR1cm4gXCJhbHdheXNcIjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHJ1c3RlZERvbWFpbnMuaW5kZXhPZihjdXJyZW50RG9tYWluKSAhPT0gLTEpIHtcbiAgICAgICAgICBpZiAobGVuID09PSAxICYmIGN1cnJlbnREb21haW4gPT09IHN3ZkRvbWFpbikge1xuICAgICAgICAgICAgcmV0dXJuIFwic2FtZURvbWFpblwiO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gXCJhbHdheXNcIjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIFwibmV2ZXJcIjtcbiAgICB9O1xuICB9KCk7XG4gIC8qKlxuICogR2V0IHRoZSBjdXJyZW50bHkgYWN0aXZlL2ZvY3VzZWQgRE9NIGVsZW1lbnQuXG4gKlxuICogQHJldHVybnMgdGhlIGN1cnJlbnRseSBhY3RpdmUvZm9jdXNlZCBlbGVtZW50LCBvciBgbnVsbGBcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9zYWZlQWN0aXZlRWxlbWVudCA9IGZ1bmN0aW9uKCkge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gX2RvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gIH07XG4gIC8qKlxuICogQWRkIGEgY2xhc3MgdG8gYW4gZWxlbWVudCwgaWYgaXQgZG9lc24ndCBhbHJlYWR5IGhhdmUgaXQuXG4gKlxuICogQHJldHVybnMgVGhlIGVsZW1lbnQsIHdpdGggaXRzIG5ldyBjbGFzcyBhZGRlZC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9hZGRDbGFzcyA9IGZ1bmN0aW9uKGVsZW1lbnQsIHZhbHVlKSB7XG4gICAgdmFyIGMsIGNsLCBjbGFzc05hbWUsIGNsYXNzTmFtZXMgPSBbXTtcbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiICYmIHZhbHVlKSB7XG4gICAgICBjbGFzc05hbWVzID0gdmFsdWUuc3BsaXQoL1xccysvKTtcbiAgICB9XG4gICAgaWYgKGVsZW1lbnQgJiYgZWxlbWVudC5ub2RlVHlwZSA9PT0gMSAmJiBjbGFzc05hbWVzLmxlbmd0aCA+IDApIHtcbiAgICAgIGlmIChlbGVtZW50LmNsYXNzTGlzdCkge1xuICAgICAgICBmb3IgKGMgPSAwLCBjbCA9IGNsYXNzTmFtZXMubGVuZ3RoOyBjIDwgY2w7IGMrKykge1xuICAgICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZChjbGFzc05hbWVzW2NdKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChlbGVtZW50Lmhhc093blByb3BlcnR5KFwiY2xhc3NOYW1lXCIpKSB7XG4gICAgICAgIGNsYXNzTmFtZSA9IFwiIFwiICsgZWxlbWVudC5jbGFzc05hbWUgKyBcIiBcIjtcbiAgICAgICAgZm9yIChjID0gMCwgY2wgPSBjbGFzc05hbWVzLmxlbmd0aDsgYyA8IGNsOyBjKyspIHtcbiAgICAgICAgICBpZiAoY2xhc3NOYW1lLmluZGV4T2YoXCIgXCIgKyBjbGFzc05hbWVzW2NdICsgXCIgXCIpID09PSAtMSkge1xuICAgICAgICAgICAgY2xhc3NOYW1lICs9IGNsYXNzTmFtZXNbY10gKyBcIiBcIjtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxlbWVudC5jbGFzc05hbWUgPSBjbGFzc05hbWUucmVwbGFjZSgvXlxccyt8XFxzKyQvZywgXCJcIik7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBlbGVtZW50O1xuICB9O1xuICAvKipcbiAqIFJlbW92ZSBhIGNsYXNzIGZyb20gYW4gZWxlbWVudCwgaWYgaXQgaGFzIGl0LlxuICpcbiAqIEByZXR1cm5zIFRoZSBlbGVtZW50LCB3aXRoIGl0cyBjbGFzcyByZW1vdmVkLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX3JlbW92ZUNsYXNzID0gZnVuY3Rpb24oZWxlbWVudCwgdmFsdWUpIHtcbiAgICB2YXIgYywgY2wsIGNsYXNzTmFtZSwgY2xhc3NOYW1lcyA9IFtdO1xuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIgJiYgdmFsdWUpIHtcbiAgICAgIGNsYXNzTmFtZXMgPSB2YWx1ZS5zcGxpdCgvXFxzKy8pO1xuICAgIH1cbiAgICBpZiAoZWxlbWVudCAmJiBlbGVtZW50Lm5vZGVUeXBlID09PSAxICYmIGNsYXNzTmFtZXMubGVuZ3RoID4gMCkge1xuICAgICAgaWYgKGVsZW1lbnQuY2xhc3NMaXN0ICYmIGVsZW1lbnQuY2xhc3NMaXN0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgZm9yIChjID0gMCwgY2wgPSBjbGFzc05hbWVzLmxlbmd0aDsgYyA8IGNsOyBjKyspIHtcbiAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoY2xhc3NOYW1lc1tjXSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoZWxlbWVudC5jbGFzc05hbWUpIHtcbiAgICAgICAgY2xhc3NOYW1lID0gKFwiIFwiICsgZWxlbWVudC5jbGFzc05hbWUgKyBcIiBcIikucmVwbGFjZSgvW1xcclxcblxcdF0vZywgXCIgXCIpO1xuICAgICAgICBmb3IgKGMgPSAwLCBjbCA9IGNsYXNzTmFtZXMubGVuZ3RoOyBjIDwgY2w7IGMrKykge1xuICAgICAgICAgIGNsYXNzTmFtZSA9IGNsYXNzTmFtZS5yZXBsYWNlKFwiIFwiICsgY2xhc3NOYW1lc1tjXSArIFwiIFwiLCBcIiBcIik7XG4gICAgICAgIH1cbiAgICAgICAgZWxlbWVudC5jbGFzc05hbWUgPSBjbGFzc05hbWUucmVwbGFjZSgvXlxccyt8XFxzKyQvZywgXCJcIik7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBlbGVtZW50O1xuICB9O1xuICAvKipcbiAqIEF0dGVtcHQgdG8gaW50ZXJwcmV0IHRoZSBlbGVtZW50J3MgQ1NTIHN0eWxpbmcuIElmIGBwcm9wYCBpcyBgXCJjdXJzb3JcImAsXG4gKiB0aGVuIHdlIGFzc3VtZSB0aGF0IGl0IHNob3VsZCBiZSBhIGhhbmQgKFwicG9pbnRlclwiKSBjdXJzb3IgaWYgdGhlIGVsZW1lbnRcbiAqIGlzIGFuIGFuY2hvciBlbGVtZW50IChcImFcIiB0YWcpLlxuICpcbiAqIEByZXR1cm5zIFRoZSBjb21wdXRlZCBzdHlsZSBwcm9wZXJ0eS5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9nZXRTdHlsZSA9IGZ1bmN0aW9uKGVsLCBwcm9wKSB7XG4gICAgdmFyIHZhbHVlID0gX2dldENvbXB1dGVkU3R5bGUoZWwsIG51bGwpLmdldFByb3BlcnR5VmFsdWUocHJvcCk7XG4gICAgaWYgKHByb3AgPT09IFwiY3Vyc29yXCIpIHtcbiAgICAgIGlmICghdmFsdWUgfHwgdmFsdWUgPT09IFwiYXV0b1wiKSB7XG4gICAgICAgIGlmIChlbC5ub2RlTmFtZSA9PT0gXCJBXCIpIHtcbiAgICAgICAgICByZXR1cm4gXCJwb2ludGVyXCI7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9O1xuICAvKipcbiAqIEdldCB0aGUgYWJzb2x1dGVseSBwb3NpdGlvbmVkIGNvb3JkaW5hdGVzIG9mIGEgRE9NIGVsZW1lbnQuXG4gKlxuICogQHJldHVybnMgT2JqZWN0IGNvbnRhaW5pbmcgdGhlIGVsZW1lbnQncyBwb3NpdGlvbiwgd2lkdGgsIGFuZCBoZWlnaHQuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZ2V0RWxlbWVudFBvc2l0aW9uID0gZnVuY3Rpb24oZWwpIHtcbiAgICB2YXIgcG9zID0ge1xuICAgICAgbGVmdDogMCxcbiAgICAgIHRvcDogMCxcbiAgICAgIHdpZHRoOiAwLFxuICAgICAgaGVpZ2h0OiAwXG4gICAgfTtcbiAgICBpZiAoZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KSB7XG4gICAgICB2YXIgZWxSZWN0ID0gZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICB2YXIgcGFnZVhPZmZzZXQgPSBfd2luZG93LnBhZ2VYT2Zmc2V0O1xuICAgICAgdmFyIHBhZ2VZT2Zmc2V0ID0gX3dpbmRvdy5wYWdlWU9mZnNldDtcbiAgICAgIHZhciBsZWZ0Qm9yZGVyV2lkdGggPSBfZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudExlZnQgfHwgMDtcbiAgICAgIHZhciB0b3BCb3JkZXJXaWR0aCA9IF9kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50VG9wIHx8IDA7XG4gICAgICB2YXIgbGVmdEJvZHlPZmZzZXQgPSAwO1xuICAgICAgdmFyIHRvcEJvZHlPZmZzZXQgPSAwO1xuICAgICAgaWYgKF9nZXRTdHlsZShfZG9jdW1lbnQuYm9keSwgXCJwb3NpdGlvblwiKSA9PT0gXCJyZWxhdGl2ZVwiKSB7XG4gICAgICAgIHZhciBib2R5UmVjdCA9IF9kb2N1bWVudC5ib2R5LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICB2YXIgaHRtbFJlY3QgPSBfZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICBsZWZ0Qm9keU9mZnNldCA9IGJvZHlSZWN0LmxlZnQgLSBodG1sUmVjdC5sZWZ0IHx8IDA7XG4gICAgICAgIHRvcEJvZHlPZmZzZXQgPSBib2R5UmVjdC50b3AgLSBodG1sUmVjdC50b3AgfHwgMDtcbiAgICAgIH1cbiAgICAgIHBvcy5sZWZ0ID0gZWxSZWN0LmxlZnQgKyBwYWdlWE9mZnNldCAtIGxlZnRCb3JkZXJXaWR0aCAtIGxlZnRCb2R5T2Zmc2V0O1xuICAgICAgcG9zLnRvcCA9IGVsUmVjdC50b3AgKyBwYWdlWU9mZnNldCAtIHRvcEJvcmRlcldpZHRoIC0gdG9wQm9keU9mZnNldDtcbiAgICAgIHBvcy53aWR0aCA9IFwid2lkdGhcIiBpbiBlbFJlY3QgPyBlbFJlY3Qud2lkdGggOiBlbFJlY3QucmlnaHQgLSBlbFJlY3QubGVmdDtcbiAgICAgIHBvcy5oZWlnaHQgPSBcImhlaWdodFwiIGluIGVsUmVjdCA/IGVsUmVjdC5oZWlnaHQgOiBlbFJlY3QuYm90dG9tIC0gZWxSZWN0LnRvcDtcbiAgICB9XG4gICAgcmV0dXJuIHBvcztcbiAgfTtcbiAgLyoqXG4gKiBEZXRlcm1pbmUgaXMgYW4gZWxlbWVudCBpcyB2aXNpYmxlIHNvbWV3aGVyZSB3aXRoaW4gdGhlIGRvY3VtZW50IChwYWdlKS5cbiAqXG4gKiBAcmV0dXJucyBCb29sZWFuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfaXNFbGVtZW50VmlzaWJsZSA9IGZ1bmN0aW9uKGVsKSB7XG4gICAgaWYgKCFlbCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2YXIgc3R5bGVzID0gX2dldENvbXB1dGVkU3R5bGUoZWwsIG51bGwpO1xuICAgIHZhciBoYXNDc3NIZWlnaHQgPSBfcGFyc2VGbG9hdChzdHlsZXMuaGVpZ2h0KSA+IDA7XG4gICAgdmFyIGhhc0Nzc1dpZHRoID0gX3BhcnNlRmxvYXQoc3R5bGVzLndpZHRoKSA+IDA7XG4gICAgdmFyIGhhc0Nzc1RvcCA9IF9wYXJzZUZsb2F0KHN0eWxlcy50b3ApID49IDA7XG4gICAgdmFyIGhhc0Nzc0xlZnQgPSBfcGFyc2VGbG9hdChzdHlsZXMubGVmdCkgPj0gMDtcbiAgICB2YXIgY3NzS25vd3MgPSBoYXNDc3NIZWlnaHQgJiYgaGFzQ3NzV2lkdGggJiYgaGFzQ3NzVG9wICYmIGhhc0Nzc0xlZnQ7XG4gICAgdmFyIHJlY3QgPSBjc3NLbm93cyA/IG51bGwgOiBfZ2V0RWxlbWVudFBvc2l0aW9uKGVsKTtcbiAgICB2YXIgaXNWaXNpYmxlID0gc3R5bGVzLmRpc3BsYXkgIT09IFwibm9uZVwiICYmIHN0eWxlcy52aXNpYmlsaXR5ICE9PSBcImNvbGxhcHNlXCIgJiYgKGNzc0tub3dzIHx8ICEhcmVjdCAmJiAoaGFzQ3NzSGVpZ2h0IHx8IHJlY3QuaGVpZ2h0ID4gMCkgJiYgKGhhc0Nzc1dpZHRoIHx8IHJlY3Qud2lkdGggPiAwKSAmJiAoaGFzQ3NzVG9wIHx8IHJlY3QudG9wID49IDApICYmIChoYXNDc3NMZWZ0IHx8IHJlY3QubGVmdCA+PSAwKSk7XG4gICAgcmV0dXJuIGlzVmlzaWJsZTtcbiAgfTtcbiAgLyoqXG4gKiBDbGVhciBhbGwgZXhpc3RpbmcgdGltZW91dHMgYW5kIGludGVydmFsIHBvbGxpbmcgZGVsZWdhdGVzLlxuICpcbiAqIEByZXR1cm5zIGB1bmRlZmluZWRgXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY2xlYXJUaW1lb3V0c0FuZFBvbGxpbmcgPSBmdW5jdGlvbigpIHtcbiAgICBfY2xlYXJUaW1lb3V0KF9mbGFzaENoZWNrVGltZW91dCk7XG4gICAgX2ZsYXNoQ2hlY2tUaW1lb3V0ID0gMDtcbiAgICBfY2xlYXJJbnRlcnZhbChfc3dmRmFsbGJhY2tDaGVja0ludGVydmFsKTtcbiAgICBfc3dmRmFsbGJhY2tDaGVja0ludGVydmFsID0gMDtcbiAgfTtcbiAgLyoqXG4gKiBSZXBvc2l0aW9uIHRoZSBGbGFzaCBvYmplY3QgdG8gY292ZXIgdGhlIGN1cnJlbnRseSBhY3RpdmF0ZWQgZWxlbWVudC5cbiAqXG4gKiBAcmV0dXJucyBgdW5kZWZpbmVkYFxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX3JlcG9zaXRpb24gPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgaHRtbEJyaWRnZTtcbiAgICBpZiAoX2N1cnJlbnRFbGVtZW50ICYmIChodG1sQnJpZGdlID0gX2dldEh0bWxCcmlkZ2UoX2ZsYXNoU3RhdGUuYnJpZGdlKSkpIHtcbiAgICAgIHZhciBwb3MgPSBfZ2V0RWxlbWVudFBvc2l0aW9uKF9jdXJyZW50RWxlbWVudCk7XG4gICAgICBfZXh0ZW5kKGh0bWxCcmlkZ2Uuc3R5bGUsIHtcbiAgICAgICAgd2lkdGg6IHBvcy53aWR0aCArIFwicHhcIixcbiAgICAgICAgaGVpZ2h0OiBwb3MuaGVpZ2h0ICsgXCJweFwiLFxuICAgICAgICB0b3A6IHBvcy50b3AgKyBcInB4XCIsXG4gICAgICAgIGxlZnQ6IHBvcy5sZWZ0ICsgXCJweFwiLFxuICAgICAgICB6SW5kZXg6IFwiXCIgKyBfZ2V0U2FmZVpJbmRleChfZ2xvYmFsQ29uZmlnLnpJbmRleClcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcbiAgLyoqXG4gKiBTZW5kcyBhIHNpZ25hbCB0byB0aGUgRmxhc2ggb2JqZWN0IHRvIGRpc3BsYXkgdGhlIGhhbmQgY3Vyc29yIGlmIGB0cnVlYC5cbiAqXG4gKiBAcmV0dXJucyBgdW5kZWZpbmVkYFxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX3NldEhhbmRDdXJzb3IgPSBmdW5jdGlvbihlbmFibGVkKSB7XG4gICAgaWYgKF9mbGFzaFN0YXRlLnJlYWR5ID09PSB0cnVlKSB7XG4gICAgICBpZiAoX2ZsYXNoU3RhdGUuYnJpZGdlICYmIHR5cGVvZiBfZmxhc2hTdGF0ZS5icmlkZ2Uuc2V0SGFuZEN1cnNvciA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIF9mbGFzaFN0YXRlLmJyaWRnZS5zZXRIYW5kQ3Vyc29yKGVuYWJsZWQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgX2ZsYXNoU3RhdGUucmVhZHkgPSBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG4gIC8qKlxuICogR2V0IGEgc2FmZSB2YWx1ZSBmb3IgYHpJbmRleGBcbiAqXG4gKiBAcmV0dXJucyBhbiBpbnRlZ2VyLCBvciBcImF1dG9cIlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2dldFNhZmVaSW5kZXggPSBmdW5jdGlvbih2YWwpIHtcbiAgICBpZiAoL14oPzphdXRvfGluaGVyaXQpJC8udGVzdCh2YWwpKSB7XG4gICAgICByZXR1cm4gdmFsO1xuICAgIH1cbiAgICB2YXIgekluZGV4O1xuICAgIGlmICh0eXBlb2YgdmFsID09PSBcIm51bWJlclwiICYmICFfaXNOYU4odmFsKSkge1xuICAgICAgekluZGV4ID0gdmFsO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbCA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgekluZGV4ID0gX2dldFNhZmVaSW5kZXgoX3BhcnNlSW50KHZhbCwgMTApKTtcbiAgICB9XG4gICAgcmV0dXJuIHR5cGVvZiB6SW5kZXggPT09IFwibnVtYmVyXCIgPyB6SW5kZXggOiBcImF1dG9cIjtcbiAgfTtcbiAgLyoqXG4gKiBBdHRlbXB0IHRvIGRldGVjdCBpZiBaZXJvQ2xpcGJvYXJkIGlzIGV4ZWN1dGluZyBpbnNpZGUgb2YgYSBzYW5kYm94ZWQgaWZyYW1lLlxuICogSWYgaXQgaXMsIEZsYXNoIFBsYXllciBjYW5ub3QgYmUgdXNlZCwgc28gWmVyb0NsaXBib2FyZCBpcyBkZWFkIGluIHRoZSB3YXRlci5cbiAqXG4gKiBAc2VlIHtAbGluayBodHRwOi8vbGlzdHMudzMub3JnL0FyY2hpdmVzL1B1YmxpYy9wdWJsaWMtd2hhdHdnLWFyY2hpdmUvMjAxNERlYy8wMDAyLmh0bWx9XG4gKiBAc2VlIHtAbGluayBodHRwczovL2dpdGh1Yi5jb20vemVyb2NsaXBib2FyZC96ZXJvY2xpcGJvYXJkL2lzc3Vlcy81MTF9XG4gKiBAc2VlIHtAbGluayBodHRwOi8vemVyb2NsaXBib2FyZC5vcmcvdGVzdC1pZnJhbWVzLmh0bWx9XG4gKlxuICogQHJldHVybnMgYHRydWVgIChpcyBzYW5kYm94ZWQpLCBgZmFsc2VgIChpcyBub3Qgc2FuZGJveGVkKSwgb3IgYG51bGxgICh1bmNlcnRhaW4pIFxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2RldGVjdFNhbmRib3ggPSBmdW5jdGlvbihkb05vdFJlYXNzZXNzRmxhc2hTdXBwb3J0KSB7XG4gICAgdmFyIGVmZmVjdGl2ZVNjcmlwdE9yaWdpbiwgZnJhbWUsIGZyYW1lRXJyb3IsIHByZXZpb3VzU3RhdGUgPSBfZmxhc2hTdGF0ZS5zYW5kYm94ZWQsIGlzU2FuZGJveGVkID0gbnVsbDtcbiAgICBkb05vdFJlYXNzZXNzRmxhc2hTdXBwb3J0ID0gZG9Ob3RSZWFzc2Vzc0ZsYXNoU3VwcG9ydCA9PT0gdHJ1ZTtcbiAgICBpZiAoX3BhZ2VJc0ZyYW1lZCA9PT0gZmFsc2UpIHtcbiAgICAgIGlzU2FuZGJveGVkID0gZmFsc2U7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGZyYW1lID0gd2luZG93LmZyYW1lRWxlbWVudCB8fCBudWxsO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBmcmFtZUVycm9yID0ge1xuICAgICAgICAgIG5hbWU6IGUubmFtZSxcbiAgICAgICAgICBtZXNzYWdlOiBlLm1lc3NhZ2VcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIGlmIChmcmFtZSAmJiBmcmFtZS5ub2RlVHlwZSA9PT0gMSAmJiBmcmFtZS5ub2RlTmFtZSA9PT0gXCJJRlJBTUVcIikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGlzU2FuZGJveGVkID0gZnJhbWUuaGFzQXR0cmlidXRlKFwic2FuZGJveFwiKTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIGlzU2FuZGJveGVkID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBlZmZlY3RpdmVTY3JpcHRPcmlnaW4gPSBkb2N1bWVudC5kb21haW4gfHwgbnVsbDtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIGVmZmVjdGl2ZVNjcmlwdE9yaWdpbiA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGVmZmVjdGl2ZVNjcmlwdE9yaWdpbiA9PT0gbnVsbCB8fCBmcmFtZUVycm9yICYmIGZyYW1lRXJyb3IubmFtZSA9PT0gXCJTZWN1cml0eUVycm9yXCIgJiYgLyhefFtcXHNcXChcXFtAXSlzYW5kYm94KGVzfGVkfGluZ3xbXFxzXFwuLCFcXClcXF1AXXwkKS8udGVzdChmcmFtZUVycm9yLm1lc3NhZ2UudG9Mb3dlckNhc2UoKSkpIHtcbiAgICAgICAgICBpc1NhbmRib3hlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgX2ZsYXNoU3RhdGUuc2FuZGJveGVkID0gaXNTYW5kYm94ZWQ7XG4gICAgaWYgKHByZXZpb3VzU3RhdGUgIT09IGlzU2FuZGJveGVkICYmICFkb05vdFJlYXNzZXNzRmxhc2hTdXBwb3J0KSB7XG4gICAgICBfZGV0ZWN0Rmxhc2hTdXBwb3J0KF9BY3RpdmVYT2JqZWN0KTtcbiAgICB9XG4gICAgcmV0dXJuIGlzU2FuZGJveGVkO1xuICB9O1xuICAvKipcbiAqIERldGVjdCB0aGUgRmxhc2ggUGxheWVyIHN0YXR1cywgdmVyc2lvbiwgYW5kIHBsdWdpbiB0eXBlLlxuICpcbiAqIEBzZWUge0BsaW5rIGh0dHBzOi8vY29kZS5nb29nbGUuY29tL3AvZG9jdHlwZS1taXJyb3Ivd2lraS9BcnRpY2xlRGV0ZWN0Rmxhc2gjVGhlX2NvZGV9XG4gKiBAc2VlIHtAbGluayBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzEyODY2MDYwL2RldGVjdGluZy1wZXBwZXItcHBhcGktZmxhc2gtd2l0aC1qYXZhc2NyaXB0fVxuICpcbiAqIEByZXR1cm5zIGB1bmRlZmluZWRgXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZGV0ZWN0Rmxhc2hTdXBwb3J0ID0gZnVuY3Rpb24oQWN0aXZlWE9iamVjdCkge1xuICAgIHZhciBwbHVnaW4sIGF4LCBtaW1lVHlwZSwgaGFzRmxhc2ggPSBmYWxzZSwgaXNBY3RpdmVYID0gZmFsc2UsIGlzUFBBUEkgPSBmYWxzZSwgZmxhc2hWZXJzaW9uID0gXCJcIjtcbiAgICAvKipcbiAgICogRGVyaXZlZCBmcm9tIEFwcGxlJ3Mgc3VnZ2VzdGVkIHNuaWZmZXIuXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBkZXNjIGUuZy4gXCJTaG9ja3dhdmUgRmxhc2ggNy4wIHI2MVwiXG4gICAqIEByZXR1cm5zIHtTdHJpbmd9IFwiNy4wLjYxXCJcbiAgICogQHByaXZhdGVcbiAgICovXG4gICAgZnVuY3Rpb24gcGFyc2VGbGFzaFZlcnNpb24oZGVzYykge1xuICAgICAgdmFyIG1hdGNoZXMgPSBkZXNjLm1hdGNoKC9bXFxkXSsvZyk7XG4gICAgICBtYXRjaGVzLmxlbmd0aCA9IDM7XG4gICAgICByZXR1cm4gbWF0Y2hlcy5qb2luKFwiLlwiKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gaXNQZXBwZXJGbGFzaChmbGFzaFBsYXllckZpbGVOYW1lKSB7XG4gICAgICByZXR1cm4gISFmbGFzaFBsYXllckZpbGVOYW1lICYmIChmbGFzaFBsYXllckZpbGVOYW1lID0gZmxhc2hQbGF5ZXJGaWxlTmFtZS50b0xvd2VyQ2FzZSgpKSAmJiAoL14ocGVwZmxhc2hwbGF5ZXJcXC5kbGx8bGlicGVwZmxhc2hwbGF5ZXJcXC5zb3xwZXBwZXJmbGFzaHBsYXllclxcLnBsdWdpbikkLy50ZXN0KGZsYXNoUGxheWVyRmlsZU5hbWUpIHx8IGZsYXNoUGxheWVyRmlsZU5hbWUuc2xpY2UoLTEzKSA9PT0gXCJjaHJvbWUucGx1Z2luXCIpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBpbnNwZWN0UGx1Z2luKHBsdWdpbikge1xuICAgICAgaWYgKHBsdWdpbikge1xuICAgICAgICBoYXNGbGFzaCA9IHRydWU7XG4gICAgICAgIGlmIChwbHVnaW4udmVyc2lvbikge1xuICAgICAgICAgIGZsYXNoVmVyc2lvbiA9IHBhcnNlRmxhc2hWZXJzaW9uKHBsdWdpbi52ZXJzaW9uKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWZsYXNoVmVyc2lvbiAmJiBwbHVnaW4uZGVzY3JpcHRpb24pIHtcbiAgICAgICAgICBmbGFzaFZlcnNpb24gPSBwYXJzZUZsYXNoVmVyc2lvbihwbHVnaW4uZGVzY3JpcHRpb24pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwbHVnaW4uZmlsZW5hbWUpIHtcbiAgICAgICAgICBpc1BQQVBJID0gaXNQZXBwZXJGbGFzaChwbHVnaW4uZmlsZW5hbWUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChfbmF2aWdhdG9yLnBsdWdpbnMgJiYgX25hdmlnYXRvci5wbHVnaW5zLmxlbmd0aCkge1xuICAgICAgcGx1Z2luID0gX25hdmlnYXRvci5wbHVnaW5zW1wiU2hvY2t3YXZlIEZsYXNoXCJdO1xuICAgICAgaW5zcGVjdFBsdWdpbihwbHVnaW4pO1xuICAgICAgaWYgKF9uYXZpZ2F0b3IucGx1Z2luc1tcIlNob2Nrd2F2ZSBGbGFzaCAyLjBcIl0pIHtcbiAgICAgICAgaGFzRmxhc2ggPSB0cnVlO1xuICAgICAgICBmbGFzaFZlcnNpb24gPSBcIjIuMC4wLjExXCI7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChfbmF2aWdhdG9yLm1pbWVUeXBlcyAmJiBfbmF2aWdhdG9yLm1pbWVUeXBlcy5sZW5ndGgpIHtcbiAgICAgIG1pbWVUeXBlID0gX25hdmlnYXRvci5taW1lVHlwZXNbXCJhcHBsaWNhdGlvbi94LXNob2Nrd2F2ZS1mbGFzaFwiXTtcbiAgICAgIHBsdWdpbiA9IG1pbWVUeXBlICYmIG1pbWVUeXBlLmVuYWJsZWRQbHVnaW47XG4gICAgICBpbnNwZWN0UGx1Z2luKHBsdWdpbik7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgQWN0aXZlWE9iamVjdCAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgaXNBY3RpdmVYID0gdHJ1ZTtcbiAgICAgIHRyeSB7XG4gICAgICAgIGF4ID0gbmV3IEFjdGl2ZVhPYmplY3QoXCJTaG9ja3dhdmVGbGFzaC5TaG9ja3dhdmVGbGFzaC43XCIpO1xuICAgICAgICBoYXNGbGFzaCA9IHRydWU7XG4gICAgICAgIGZsYXNoVmVyc2lvbiA9IHBhcnNlRmxhc2hWZXJzaW9uKGF4LkdldFZhcmlhYmxlKFwiJHZlcnNpb25cIikpO1xuICAgICAgfSBjYXRjaCAoZTEpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBheCA9IG5ldyBBY3RpdmVYT2JqZWN0KFwiU2hvY2t3YXZlRmxhc2guU2hvY2t3YXZlRmxhc2guNlwiKTtcbiAgICAgICAgICBoYXNGbGFzaCA9IHRydWU7XG4gICAgICAgICAgZmxhc2hWZXJzaW9uID0gXCI2LjAuMjFcIjtcbiAgICAgICAgfSBjYXRjaCAoZTIpIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXggPSBuZXcgQWN0aXZlWE9iamVjdChcIlNob2Nrd2F2ZUZsYXNoLlNob2Nrd2F2ZUZsYXNoXCIpO1xuICAgICAgICAgICAgaGFzRmxhc2ggPSB0cnVlO1xuICAgICAgICAgICAgZmxhc2hWZXJzaW9uID0gcGFyc2VGbGFzaFZlcnNpb24oYXguR2V0VmFyaWFibGUoXCIkdmVyc2lvblwiKSk7XG4gICAgICAgICAgfSBjYXRjaCAoZTMpIHtcbiAgICAgICAgICAgIGlzQWN0aXZlWCA9IGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBfZmxhc2hTdGF0ZS5kaXNhYmxlZCA9IGhhc0ZsYXNoICE9PSB0cnVlO1xuICAgIF9mbGFzaFN0YXRlLm91dGRhdGVkID0gZmxhc2hWZXJzaW9uICYmIF9wYXJzZUZsb2F0KGZsYXNoVmVyc2lvbikgPCBfcGFyc2VGbG9hdChfbWluaW11bUZsYXNoVmVyc2lvbik7XG4gICAgX2ZsYXNoU3RhdGUudmVyc2lvbiA9IGZsYXNoVmVyc2lvbiB8fCBcIjAuMC4wXCI7XG4gICAgX2ZsYXNoU3RhdGUucGx1Z2luVHlwZSA9IGlzUFBBUEkgPyBcInBlcHBlclwiIDogaXNBY3RpdmVYID8gXCJhY3RpdmV4XCIgOiBoYXNGbGFzaCA/IFwibmV0c2NhcGVcIiA6IFwidW5rbm93blwiO1xuICB9O1xuICAvKipcbiAqIEludm9rZSB0aGUgRmxhc2ggZGV0ZWN0aW9uIGFsZ29yaXRobXMgaW1tZWRpYXRlbHkgdXBvbiBpbmNsdXNpb24gc28gd2UncmUgbm90IHdhaXRpbmcgbGF0ZXIuXG4gKi9cbiAgX2RldGVjdEZsYXNoU3VwcG9ydChfQWN0aXZlWE9iamVjdCk7XG4gIC8qKlxuICogQWx3YXlzIGFzc2VzcyB0aGUgYHNhbmRib3hlZGAgc3RhdGUgb2YgdGhlIHBhZ2UgYXQgaW1wb3J0YW50IEZsYXNoLXJlbGF0ZWQgbW9tZW50cy5cbiAqL1xuICBfZGV0ZWN0U2FuZGJveCh0cnVlKTtcbiAgLyoqXG4gKiBBIHNoZWxsIGNvbnN0cnVjdG9yIGZvciBgWmVyb0NsaXBib2FyZGAgY2xpZW50IGluc3RhbmNlcy5cbiAqXG4gKiBAY29uc3RydWN0b3JcbiAqL1xuICB2YXIgWmVyb0NsaXBib2FyZCA9IGZ1bmN0aW9uKCkge1xuICAgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBaZXJvQ2xpcGJvYXJkKSkge1xuICAgICAgcmV0dXJuIG5ldyBaZXJvQ2xpcGJvYXJkKCk7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgWmVyb0NsaXBib2FyZC5fY3JlYXRlQ2xpZW50ID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIFplcm9DbGlwYm9hcmQuX2NyZWF0ZUNsaWVudC5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgICB9XG4gIH07XG4gIC8qKlxuICogVGhlIFplcm9DbGlwYm9hcmQgbGlicmFyeSdzIHZlcnNpb24gbnVtYmVyLlxuICpcbiAqIEBzdGF0aWNcbiAqIEByZWFkb25seVxuICogQHByb3BlcnR5IHtzdHJpbmd9XG4gKi9cbiAgX2RlZmluZVByb3BlcnR5KFplcm9DbGlwYm9hcmQsIFwidmVyc2lvblwiLCB7XG4gICAgdmFsdWU6IFwiMi4yLjBcIixcbiAgICB3cml0YWJsZTogZmFsc2UsXG4gICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgIGVudW1lcmFibGU6IHRydWVcbiAgfSk7XG4gIC8qKlxuICogVXBkYXRlIG9yIGdldCBhIGNvcHkgb2YgdGhlIFplcm9DbGlwYm9hcmQgZ2xvYmFsIGNvbmZpZ3VyYXRpb24uXG4gKiBSZXR1cm5zIGEgY29weSBvZiB0aGUgY3VycmVudC91cGRhdGVkIGNvbmZpZ3VyYXRpb24uXG4gKlxuICogQHJldHVybnMgT2JqZWN0XG4gKiBAc3RhdGljXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5jb25maWcgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX2NvbmZpZy5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBEaWFnbm9zdGljIG1ldGhvZCB0aGF0IGRlc2NyaWJlcyB0aGUgc3RhdGUgb2YgdGhlIGJyb3dzZXIsIEZsYXNoIFBsYXllciwgYW5kIFplcm9DbGlwYm9hcmQuXG4gKlxuICogQHJldHVybnMgT2JqZWN0XG4gKiBAc3RhdGljXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5zdGF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfc3RhdGUuYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gIH07XG4gIC8qKlxuICogQ2hlY2sgaWYgRmxhc2ggaXMgdW51c2FibGUgZm9yIGFueSByZWFzb246IGRpc2FibGVkLCBvdXRkYXRlZCwgZGVhY3RpdmF0ZWQsIGV0Yy5cbiAqXG4gKiBAcmV0dXJucyBCb29sZWFuXG4gKiBAc3RhdGljXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5pc0ZsYXNoVW51c2FibGUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX2lzRmxhc2hVbnVzYWJsZS5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBSZWdpc3RlciBhbiBldmVudCBsaXN0ZW5lci5cbiAqXG4gKiBAcmV0dXJucyBgWmVyb0NsaXBib2FyZGBcbiAqIEBzdGF0aWNcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLm9uID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIF9vbi5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBVbnJlZ2lzdGVyIGFuIGV2ZW50IGxpc3RlbmVyLlxuICogSWYgbm8gYGxpc3RlbmVyYCBmdW5jdGlvbi9vYmplY3QgaXMgcHJvdmlkZWQsIGl0IHdpbGwgdW5yZWdpc3RlciBhbGwgbGlzdGVuZXJzIGZvciB0aGUgcHJvdmlkZWQgYGV2ZW50VHlwZWAuXG4gKiBJZiBubyBgZXZlbnRUeXBlYCBpcyBwcm92aWRlZCwgaXQgd2lsbCB1bnJlZ2lzdGVyIGFsbCBsaXN0ZW5lcnMgZm9yIGV2ZXJ5IGV2ZW50IHR5cGUuXG4gKlxuICogQHJldHVybnMgYFplcm9DbGlwYm9hcmRgXG4gKiBAc3RhdGljXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5vZmYgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX29mZi5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBSZXRyaWV2ZSBldmVudCBsaXN0ZW5lcnMgZm9yIGFuIGBldmVudFR5cGVgLlxuICogSWYgbm8gYGV2ZW50VHlwZWAgaXMgcHJvdmlkZWQsIGl0IHdpbGwgcmV0cmlldmUgYWxsIGxpc3RlbmVycyBmb3IgZXZlcnkgZXZlbnQgdHlwZS5cbiAqXG4gKiBAcmV0dXJucyBhcnJheSBvZiBsaXN0ZW5lcnMgZm9yIHRoZSBgZXZlbnRUeXBlYDsgaWYgbm8gYGV2ZW50VHlwZWAsIHRoZW4gYSBtYXAvaGFzaCBvYmplY3Qgb2YgbGlzdGVuZXJzIGZvciBhbGwgZXZlbnQgdHlwZXM7IG9yIGBudWxsYFxuICovXG4gIFplcm9DbGlwYm9hcmQuaGFuZGxlcnMgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX2xpc3RlbmVycy5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBFdmVudCBlbWlzc2lvbiByZWNlaXZlciBmcm9tIHRoZSBGbGFzaCBvYmplY3QsIGZvcndhcmRpbmcgdG8gYW55IHJlZ2lzdGVyZWQgSmF2YVNjcmlwdCBldmVudCBsaXN0ZW5lcnMuXG4gKlxuICogQHJldHVybnMgRm9yIHRoZSBcImNvcHlcIiBldmVudCwgcmV0dXJucyB0aGUgRmxhc2gtZnJpZW5kbHkgXCJjbGlwRGF0YVwiIG9iamVjdDsgb3RoZXJ3aXNlIGB1bmRlZmluZWRgLlxuICogQHN0YXRpY1xuICovXG4gIFplcm9DbGlwYm9hcmQuZW1pdCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfZW1pdC5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBDcmVhdGUgYW5kIGVtYmVkIHRoZSBGbGFzaCBvYmplY3QuXG4gKlxuICogQHJldHVybnMgVGhlIEZsYXNoIG9iamVjdFxuICogQHN0YXRpY1xuICovXG4gIFplcm9DbGlwYm9hcmQuY3JlYXRlID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIF9jcmVhdGUuYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gIH07XG4gIC8qKlxuICogU2VsZi1kZXN0cnVjdCBhbmQgY2xlYW4gdXAgZXZlcnl0aGluZywgaW5jbHVkaW5nIHRoZSBlbWJlZGRlZCBGbGFzaCBvYmplY3QuXG4gKlxuICogQHJldHVybnMgYHVuZGVmaW5lZGBcbiAqIEBzdGF0aWNcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLmRlc3Ryb3kgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX2Rlc3Ryb3kuYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gIH07XG4gIC8qKlxuICogU2V0IHRoZSBwZW5kaW5nIGRhdGEgZm9yIGNsaXBib2FyZCBpbmplY3Rpb24uXG4gKlxuICogQHJldHVybnMgYHVuZGVmaW5lZGBcbiAqIEBzdGF0aWNcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLnNldERhdGEgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX3NldERhdGEuYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gIH07XG4gIC8qKlxuICogQ2xlYXIgdGhlIHBlbmRpbmcgZGF0YSBmb3IgY2xpcGJvYXJkIGluamVjdGlvbi5cbiAqIElmIG5vIGBmb3JtYXRgIGlzIHByb3ZpZGVkLCBhbGwgcGVuZGluZyBkYXRhIGZvcm1hdHMgd2lsbCBiZSBjbGVhcmVkLlxuICpcbiAqIEByZXR1cm5zIGB1bmRlZmluZWRgXG4gKiBAc3RhdGljXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5jbGVhckRhdGEgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX2NsZWFyRGF0YS5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBHZXQgYSBjb3B5IG9mIHRoZSBwZW5kaW5nIGRhdGEgZm9yIGNsaXBib2FyZCBpbmplY3Rpb24uXG4gKiBJZiBubyBgZm9ybWF0YCBpcyBwcm92aWRlZCwgYSBjb3B5IG9mIEFMTCBwZW5kaW5nIGRhdGEgZm9ybWF0cyB3aWxsIGJlIHJldHVybmVkLlxuICpcbiAqIEByZXR1cm5zIGBTdHJpbmdgIG9yIGBPYmplY3RgXG4gKiBAc3RhdGljXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5nZXREYXRhID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIF9nZXREYXRhLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIFNldHMgdGhlIGN1cnJlbnQgSFRNTCBvYmplY3QgdGhhdCB0aGUgRmxhc2ggb2JqZWN0IHNob3VsZCBvdmVybGF5LiBUaGlzIHdpbGwgcHV0IHRoZSBnbG9iYWxcbiAqIEZsYXNoIG9iamVjdCBvbiB0b3Agb2YgdGhlIGN1cnJlbnQgZWxlbWVudDsgZGVwZW5kaW5nIG9uIHRoZSBzZXR1cCwgdGhpcyBtYXkgYWxzbyBzZXQgdGhlXG4gKiBwZW5kaW5nIGNsaXBib2FyZCB0ZXh0IGRhdGEgYXMgd2VsbCBhcyB0aGUgRmxhc2ggb2JqZWN0J3Mgd3JhcHBpbmcgZWxlbWVudCdzIHRpdGxlIGF0dHJpYnV0ZVxuICogYmFzZWQgb24gdGhlIHVuZGVybHlpbmcgSFRNTCBlbGVtZW50IGFuZCBaZXJvQ2xpcGJvYXJkIGNvbmZpZ3VyYXRpb24uXG4gKlxuICogQHJldHVybnMgYHVuZGVmaW5lZGBcbiAqIEBzdGF0aWNcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLmZvY3VzID0gWmVyb0NsaXBib2FyZC5hY3RpdmF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfZm9jdXMuYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gIH07XG4gIC8qKlxuICogVW4tb3ZlcmxheXMgdGhlIEZsYXNoIG9iamVjdC4gVGhpcyB3aWxsIHB1dCB0aGUgZ2xvYmFsIEZsYXNoIG9iamVjdCBvZmYtc2NyZWVuOyBkZXBlbmRpbmcgb25cbiAqIHRoZSBzZXR1cCwgdGhpcyBtYXkgYWxzbyB1bnNldCB0aGUgRmxhc2ggb2JqZWN0J3Mgd3JhcHBpbmcgZWxlbWVudCdzIHRpdGxlIGF0dHJpYnV0ZSBiYXNlZCBvblxuICogdGhlIHVuZGVybHlpbmcgSFRNTCBlbGVtZW50IGFuZCBaZXJvQ2xpcGJvYXJkIGNvbmZpZ3VyYXRpb24uXG4gKlxuICogQHJldHVybnMgYHVuZGVmaW5lZGBcbiAqIEBzdGF0aWNcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLmJsdXIgPSBaZXJvQ2xpcGJvYXJkLmRlYWN0aXZhdGUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX2JsdXIuYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gIH07XG4gIC8qKlxuICogUmV0dXJucyB0aGUgY3VycmVudGx5IGZvY3VzZWQvXCJhY3RpdmF0ZWRcIiBIVE1MIGVsZW1lbnQgdGhhdCB0aGUgRmxhc2ggb2JqZWN0IGlzIHdyYXBwaW5nLlxuICpcbiAqIEByZXR1cm5zIGBIVE1MRWxlbWVudGAgb3IgYG51bGxgXG4gKiBAc3RhdGljXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5hY3RpdmVFbGVtZW50ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIF9hY3RpdmVFbGVtZW50LmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIEtlZXAgdHJhY2sgb2YgdGhlIFplcm9DbGlwYm9hcmQgY2xpZW50IGluc3RhbmNlIGNvdW50ZXIuXG4gKi9cbiAgdmFyIF9jbGllbnRJZENvdW50ZXIgPSAwO1xuICAvKipcbiAqIEtlZXAgdHJhY2sgb2YgdGhlIHN0YXRlIG9mIHRoZSBjbGllbnQgaW5zdGFuY2VzLlxuICpcbiAqIEVudHJ5IHN0cnVjdHVyZTpcbiAqICAgX2NsaWVudE1ldGFbY2xpZW50LmlkXSA9IHtcbiAqICAgICBpbnN0YW5jZTogY2xpZW50LFxuICogICAgIGVsZW1lbnRzOiBbXSxcbiAqICAgICBoYW5kbGVyczoge31cbiAqICAgfTtcbiAqL1xuICB2YXIgX2NsaWVudE1ldGEgPSB7fTtcbiAgLyoqXG4gKiBLZWVwIHRyYWNrIG9mIHRoZSBaZXJvQ2xpcGJvYXJkIGNsaXBwZWQgZWxlbWVudHMgY291bnRlci5cbiAqL1xuICB2YXIgX2VsZW1lbnRJZENvdW50ZXIgPSAwO1xuICAvKipcbiAqIEtlZXAgdHJhY2sgb2YgdGhlIHN0YXRlIG9mIHRoZSBjbGlwcGVkIGVsZW1lbnQgcmVsYXRpb25zaGlwcyB0byBjbGllbnRzLlxuICpcbiAqIEVudHJ5IHN0cnVjdHVyZTpcbiAqICAgX2VsZW1lbnRNZXRhW2VsZW1lbnQuemNDbGlwcGluZ0lkXSA9IFtjbGllbnQxLmlkLCBjbGllbnQyLmlkXTtcbiAqL1xuICB2YXIgX2VsZW1lbnRNZXRhID0ge307XG4gIC8qKlxuICogS2VlcCB0cmFjayBvZiB0aGUgc3RhdGUgb2YgdGhlIG1vdXNlIGV2ZW50IGhhbmRsZXJzIGZvciBjbGlwcGVkIGVsZW1lbnRzLlxuICpcbiAqIEVudHJ5IHN0cnVjdHVyZTpcbiAqICAgX21vdXNlSGFuZGxlcnNbZWxlbWVudC56Y0NsaXBwaW5nSWRdID0ge1xuICogICAgIG1vdXNlb3ZlcjogIGZ1bmN0aW9uKGV2ZW50KSB7fSxcbiAqICAgICBtb3VzZW91dDogICBmdW5jdGlvbihldmVudCkge30sXG4gKiAgICAgbW91c2VlbnRlcjogZnVuY3Rpb24oZXZlbnQpIHt9LFxuICogICAgIG1vdXNlbGVhdmU6IGZ1bmN0aW9uKGV2ZW50KSB7fSxcbiAqICAgICBtb3VzZW1vdmU6ICBmdW5jdGlvbihldmVudCkge31cbiAqICAgfTtcbiAqL1xuICB2YXIgX21vdXNlSGFuZGxlcnMgPSB7fTtcbiAgLyoqXG4gKiBFeHRlbmRpbmcgdGhlIFplcm9DbGlwYm9hcmQgY29uZmlndXJhdGlvbiBkZWZhdWx0cyBmb3IgdGhlIENsaWVudCBtb2R1bGUuXG4gKi9cbiAgX2V4dGVuZChfZ2xvYmFsQ29uZmlnLCB7XG4gICAgYXV0b0FjdGl2YXRlOiB0cnVlXG4gIH0pO1xuICAvKipcbiAqIFRoZSByZWFsIGNvbnN0cnVjdG9yIGZvciBgWmVyb0NsaXBib2FyZGAgY2xpZW50IGluc3RhbmNlcy5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9jbGllbnRDb25zdHJ1Y3RvciA9IGZ1bmN0aW9uKGVsZW1lbnRzKSB7XG4gICAgdmFyIGNsaWVudCA9IHRoaXM7XG4gICAgY2xpZW50LmlkID0gXCJcIiArIF9jbGllbnRJZENvdW50ZXIrKztcbiAgICBfY2xpZW50TWV0YVtjbGllbnQuaWRdID0ge1xuICAgICAgaW5zdGFuY2U6IGNsaWVudCxcbiAgICAgIGVsZW1lbnRzOiBbXSxcbiAgICAgIGhhbmRsZXJzOiB7fVxuICAgIH07XG4gICAgaWYgKGVsZW1lbnRzKSB7XG4gICAgICBjbGllbnQuY2xpcChlbGVtZW50cyk7XG4gICAgfVxuICAgIFplcm9DbGlwYm9hcmQub24oXCIqXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICByZXR1cm4gY2xpZW50LmVtaXQoZXZlbnQpO1xuICAgIH0pO1xuICAgIFplcm9DbGlwYm9hcmQub24oXCJkZXN0cm95XCIsIGZ1bmN0aW9uKCkge1xuICAgICAgY2xpZW50LmRlc3Ryb3koKTtcbiAgICB9KTtcbiAgICBaZXJvQ2xpcGJvYXJkLmNyZWF0ZSgpO1xuICB9O1xuICAvKipcbiAqIFRoZSB1bmRlcmx5aW5nIGltcGxlbWVudGF0aW9uIG9mIGBaZXJvQ2xpcGJvYXJkLkNsaWVudC5wcm90b3R5cGUub25gLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2NsaWVudE9uID0gZnVuY3Rpb24oZXZlbnRUeXBlLCBsaXN0ZW5lcikge1xuICAgIHZhciBpLCBsZW4sIGV2ZW50cywgYWRkZWQgPSB7fSwgbWV0YSA9IF9jbGllbnRNZXRhW3RoaXMuaWRdLCBoYW5kbGVycyA9IG1ldGEgJiYgbWV0YS5oYW5kbGVycztcbiAgICBpZiAoIW1ldGEpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkF0dGVtcHRlZCB0byBhZGQgbmV3IGxpc3RlbmVyKHMpIHRvIGEgZGVzdHJveWVkIFplcm9DbGlwYm9hcmQgY2xpZW50IGluc3RhbmNlXCIpO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGV2ZW50VHlwZSA9PT0gXCJzdHJpbmdcIiAmJiBldmVudFR5cGUpIHtcbiAgICAgIGV2ZW50cyA9IGV2ZW50VHlwZS50b0xvd2VyQ2FzZSgpLnNwbGl0KC9cXHMrLyk7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgZXZlbnRUeXBlID09PSBcIm9iamVjdFwiICYmIGV2ZW50VHlwZSAmJiB0eXBlb2YgbGlzdGVuZXIgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIGZvciAoaSBpbiBldmVudFR5cGUpIHtcbiAgICAgICAgaWYgKF9oYXNPd24uY2FsbChldmVudFR5cGUsIGkpICYmIHR5cGVvZiBpID09PSBcInN0cmluZ1wiICYmIGkgJiYgdHlwZW9mIGV2ZW50VHlwZVtpXSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgdGhpcy5vbihpLCBldmVudFR5cGVbaV0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChldmVudHMgJiYgZXZlbnRzLmxlbmd0aCkge1xuICAgICAgZm9yIChpID0gMCwgbGVuID0gZXZlbnRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGV2ZW50VHlwZSA9IGV2ZW50c1tpXS5yZXBsYWNlKC9eb24vLCBcIlwiKTtcbiAgICAgICAgYWRkZWRbZXZlbnRUeXBlXSA9IHRydWU7XG4gICAgICAgIGlmICghaGFuZGxlcnNbZXZlbnRUeXBlXSkge1xuICAgICAgICAgIGhhbmRsZXJzW2V2ZW50VHlwZV0gPSBbXTtcbiAgICAgICAgfVxuICAgICAgICBoYW5kbGVyc1tldmVudFR5cGVdLnB1c2gobGlzdGVuZXIpO1xuICAgICAgfVxuICAgICAgaWYgKGFkZGVkLnJlYWR5ICYmIF9mbGFzaFN0YXRlLnJlYWR5KSB7XG4gICAgICAgIHRoaXMuZW1pdCh7XG4gICAgICAgICAgdHlwZTogXCJyZWFkeVwiLFxuICAgICAgICAgIGNsaWVudDogdGhpc1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmIChhZGRlZC5lcnJvcikge1xuICAgICAgICBmb3IgKGkgPSAwLCBsZW4gPSBfZmxhc2hTdGF0ZUVycm9yTmFtZXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICBpZiAoX2ZsYXNoU3RhdGVbX2ZsYXNoU3RhdGVFcnJvck5hbWVzW2ldLnJlcGxhY2UoL15mbGFzaC0vLCBcIlwiKV0pIHtcbiAgICAgICAgICAgIHRoaXMuZW1pdCh7XG4gICAgICAgICAgICAgIHR5cGU6IFwiZXJyb3JcIixcbiAgICAgICAgICAgICAgbmFtZTogX2ZsYXNoU3RhdGVFcnJvck5hbWVzW2ldLFxuICAgICAgICAgICAgICBjbGllbnQ6IHRoaXNcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChfemNTd2ZWZXJzaW9uICE9PSB1bmRlZmluZWQgJiYgWmVyb0NsaXBib2FyZC52ZXJzaW9uICE9PSBfemNTd2ZWZXJzaW9uKSB7XG4gICAgICAgICAgdGhpcy5lbWl0KHtcbiAgICAgICAgICAgIHR5cGU6IFwiZXJyb3JcIixcbiAgICAgICAgICAgIG5hbWU6IFwidmVyc2lvbi1taXNtYXRjaFwiLFxuICAgICAgICAgICAganNWZXJzaW9uOiBaZXJvQ2xpcGJvYXJkLnZlcnNpb24sXG4gICAgICAgICAgICBzd2ZWZXJzaW9uOiBfemNTd2ZWZXJzaW9uXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuQ2xpZW50LnByb3RvdHlwZS5vZmZgLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2NsaWVudE9mZiA9IGZ1bmN0aW9uKGV2ZW50VHlwZSwgbGlzdGVuZXIpIHtcbiAgICB2YXIgaSwgbGVuLCBmb3VuZEluZGV4LCBldmVudHMsIHBlckV2ZW50SGFuZGxlcnMsIG1ldGEgPSBfY2xpZW50TWV0YVt0aGlzLmlkXSwgaGFuZGxlcnMgPSBtZXRhICYmIG1ldGEuaGFuZGxlcnM7XG4gICAgaWYgKCFoYW5kbGVycykge1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSB7XG4gICAgICBldmVudHMgPSBfa2V5cyhoYW5kbGVycyk7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgZXZlbnRUeXBlID09PSBcInN0cmluZ1wiICYmIGV2ZW50VHlwZSkge1xuICAgICAgZXZlbnRzID0gZXZlbnRUeXBlLnNwbGl0KC9cXHMrLyk7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgZXZlbnRUeXBlID09PSBcIm9iamVjdFwiICYmIGV2ZW50VHlwZSAmJiB0eXBlb2YgbGlzdGVuZXIgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIGZvciAoaSBpbiBldmVudFR5cGUpIHtcbiAgICAgICAgaWYgKF9oYXNPd24uY2FsbChldmVudFR5cGUsIGkpICYmIHR5cGVvZiBpID09PSBcInN0cmluZ1wiICYmIGkgJiYgdHlwZW9mIGV2ZW50VHlwZVtpXSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgdGhpcy5vZmYoaSwgZXZlbnRUeXBlW2ldKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBpZiAoZXZlbnRzICYmIGV2ZW50cy5sZW5ndGgpIHtcbiAgICAgIGZvciAoaSA9IDAsIGxlbiA9IGV2ZW50cy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBldmVudFR5cGUgPSBldmVudHNbaV0udG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9eb24vLCBcIlwiKTtcbiAgICAgICAgcGVyRXZlbnRIYW5kbGVycyA9IGhhbmRsZXJzW2V2ZW50VHlwZV07XG4gICAgICAgIGlmIChwZXJFdmVudEhhbmRsZXJzICYmIHBlckV2ZW50SGFuZGxlcnMubGVuZ3RoKSB7XG4gICAgICAgICAgaWYgKGxpc3RlbmVyKSB7XG4gICAgICAgICAgICBmb3VuZEluZGV4ID0gcGVyRXZlbnRIYW5kbGVycy5pbmRleE9mKGxpc3RlbmVyKTtcbiAgICAgICAgICAgIHdoaWxlIChmb3VuZEluZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgICBwZXJFdmVudEhhbmRsZXJzLnNwbGljZShmb3VuZEluZGV4LCAxKTtcbiAgICAgICAgICAgICAgZm91bmRJbmRleCA9IHBlckV2ZW50SGFuZGxlcnMuaW5kZXhPZihsaXN0ZW5lciwgZm91bmRJbmRleCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHBlckV2ZW50SGFuZGxlcnMubGVuZ3RoID0gMDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuQ2xpZW50LnByb3RvdHlwZS5oYW5kbGVyc2AuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY2xpZW50TGlzdGVuZXJzID0gZnVuY3Rpb24oZXZlbnRUeXBlKSB7XG4gICAgdmFyIGNvcHkgPSBudWxsLCBoYW5kbGVycyA9IF9jbGllbnRNZXRhW3RoaXMuaWRdICYmIF9jbGllbnRNZXRhW3RoaXMuaWRdLmhhbmRsZXJzO1xuICAgIGlmIChoYW5kbGVycykge1xuICAgICAgaWYgKHR5cGVvZiBldmVudFR5cGUgPT09IFwic3RyaW5nXCIgJiYgZXZlbnRUeXBlKSB7XG4gICAgICAgIGNvcHkgPSBoYW5kbGVyc1tldmVudFR5cGVdID8gaGFuZGxlcnNbZXZlbnRUeXBlXS5zbGljZSgwKSA6IFtdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29weSA9IF9kZWVwQ29weShoYW5kbGVycyk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBjb3B5O1xuICB9O1xuICAvKipcbiAqIFRoZSB1bmRlcmx5aW5nIGltcGxlbWVudGF0aW9uIG9mIGBaZXJvQ2xpcGJvYXJkLkNsaWVudC5wcm90b3R5cGUuZW1pdGAuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY2xpZW50RW1pdCA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgaWYgKF9jbGllbnRTaG91bGRFbWl0LmNhbGwodGhpcywgZXZlbnQpKSB7XG4gICAgICBpZiAodHlwZW9mIGV2ZW50ID09PSBcIm9iamVjdFwiICYmIGV2ZW50ICYmIHR5cGVvZiBldmVudC50eXBlID09PSBcInN0cmluZ1wiICYmIGV2ZW50LnR5cGUpIHtcbiAgICAgICAgZXZlbnQgPSBfZXh0ZW5kKHt9LCBldmVudCk7XG4gICAgICB9XG4gICAgICB2YXIgZXZlbnRDb3B5ID0gX2V4dGVuZCh7fSwgX2NyZWF0ZUV2ZW50KGV2ZW50KSwge1xuICAgICAgICBjbGllbnQ6IHRoaXNcbiAgICAgIH0pO1xuICAgICAgX2NsaWVudERpc3BhdGNoQ2FsbGJhY2tzLmNhbGwodGhpcywgZXZlbnRDb3B5KTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuQ2xpZW50LnByb3RvdHlwZS5jbGlwYC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9jbGllbnRDbGlwID0gZnVuY3Rpb24oZWxlbWVudHMpIHtcbiAgICBpZiAoIV9jbGllbnRNZXRhW3RoaXMuaWRdKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBdHRlbXB0ZWQgdG8gY2xpcCBlbGVtZW50KHMpIHRvIGEgZGVzdHJveWVkIFplcm9DbGlwYm9hcmQgY2xpZW50IGluc3RhbmNlXCIpO1xuICAgIH1cbiAgICBlbGVtZW50cyA9IF9wcmVwQ2xpcChlbGVtZW50cyk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbGVtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKF9oYXNPd24uY2FsbChlbGVtZW50cywgaSkgJiYgZWxlbWVudHNbaV0gJiYgZWxlbWVudHNbaV0ubm9kZVR5cGUgPT09IDEpIHtcbiAgICAgICAgaWYgKCFlbGVtZW50c1tpXS56Y0NsaXBwaW5nSWQpIHtcbiAgICAgICAgICBlbGVtZW50c1tpXS56Y0NsaXBwaW5nSWQgPSBcInpjQ2xpcHBpbmdJZF9cIiArIF9lbGVtZW50SWRDb3VudGVyKys7XG4gICAgICAgICAgX2VsZW1lbnRNZXRhW2VsZW1lbnRzW2ldLnpjQ2xpcHBpbmdJZF0gPSBbIHRoaXMuaWQgXTtcbiAgICAgICAgICBpZiAoX2dsb2JhbENvbmZpZy5hdXRvQWN0aXZhdGUgPT09IHRydWUpIHtcbiAgICAgICAgICAgIF9hZGRNb3VzZUhhbmRsZXJzKGVsZW1lbnRzW2ldKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoX2VsZW1lbnRNZXRhW2VsZW1lbnRzW2ldLnpjQ2xpcHBpbmdJZF0uaW5kZXhPZih0aGlzLmlkKSA9PT0gLTEpIHtcbiAgICAgICAgICBfZWxlbWVudE1ldGFbZWxlbWVudHNbaV0uemNDbGlwcGluZ0lkXS5wdXNoKHRoaXMuaWQpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjbGlwcGVkRWxlbWVudHMgPSBfY2xpZW50TWV0YVt0aGlzLmlkXSAmJiBfY2xpZW50TWV0YVt0aGlzLmlkXS5lbGVtZW50cztcbiAgICAgICAgaWYgKGNsaXBwZWRFbGVtZW50cy5pbmRleE9mKGVsZW1lbnRzW2ldKSA9PT0gLTEpIHtcbiAgICAgICAgICBjbGlwcGVkRWxlbWVudHMucHVzaChlbGVtZW50c1tpXSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuQ2xpZW50LnByb3RvdHlwZS51bmNsaXBgLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2NsaWVudFVuY2xpcCA9IGZ1bmN0aW9uKGVsZW1lbnRzKSB7XG4gICAgdmFyIG1ldGEgPSBfY2xpZW50TWV0YVt0aGlzLmlkXTtcbiAgICBpZiAoIW1ldGEpIHtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICB2YXIgY2xpcHBlZEVsZW1lbnRzID0gbWV0YS5lbGVtZW50cztcbiAgICB2YXIgYXJyYXlJbmRleDtcbiAgICBpZiAodHlwZW9mIGVsZW1lbnRzID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICBlbGVtZW50cyA9IGNsaXBwZWRFbGVtZW50cy5zbGljZSgwKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZWxlbWVudHMgPSBfcHJlcENsaXAoZWxlbWVudHMpO1xuICAgIH1cbiAgICBmb3IgKHZhciBpID0gZWxlbWVudHMubGVuZ3RoOyBpLS07ICkge1xuICAgICAgaWYgKF9oYXNPd24uY2FsbChlbGVtZW50cywgaSkgJiYgZWxlbWVudHNbaV0gJiYgZWxlbWVudHNbaV0ubm9kZVR5cGUgPT09IDEpIHtcbiAgICAgICAgYXJyYXlJbmRleCA9IDA7XG4gICAgICAgIHdoaWxlICgoYXJyYXlJbmRleCA9IGNsaXBwZWRFbGVtZW50cy5pbmRleE9mKGVsZW1lbnRzW2ldLCBhcnJheUluZGV4KSkgIT09IC0xKSB7XG4gICAgICAgICAgY2xpcHBlZEVsZW1lbnRzLnNwbGljZShhcnJheUluZGV4LCAxKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY2xpZW50SWRzID0gX2VsZW1lbnRNZXRhW2VsZW1lbnRzW2ldLnpjQ2xpcHBpbmdJZF07XG4gICAgICAgIGlmIChjbGllbnRJZHMpIHtcbiAgICAgICAgICBhcnJheUluZGV4ID0gMDtcbiAgICAgICAgICB3aGlsZSAoKGFycmF5SW5kZXggPSBjbGllbnRJZHMuaW5kZXhPZih0aGlzLmlkLCBhcnJheUluZGV4KSkgIT09IC0xKSB7XG4gICAgICAgICAgICBjbGllbnRJZHMuc3BsaWNlKGFycmF5SW5kZXgsIDEpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoY2xpZW50SWRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgaWYgKF9nbG9iYWxDb25maWcuYXV0b0FjdGl2YXRlID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgIF9yZW1vdmVNb3VzZUhhbmRsZXJzKGVsZW1lbnRzW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRlbGV0ZSBlbGVtZW50c1tpXS56Y0NsaXBwaW5nSWQ7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuICAvKipcbiAqIFRoZSB1bmRlcmx5aW5nIGltcGxlbWVudGF0aW9uIG9mIGBaZXJvQ2xpcGJvYXJkLkNsaWVudC5wcm90b3R5cGUuZWxlbWVudHNgLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2NsaWVudEVsZW1lbnRzID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIG1ldGEgPSBfY2xpZW50TWV0YVt0aGlzLmlkXTtcbiAgICByZXR1cm4gbWV0YSAmJiBtZXRhLmVsZW1lbnRzID8gbWV0YS5lbGVtZW50cy5zbGljZSgwKSA6IFtdO1xuICB9O1xuICAvKipcbiAqIFRoZSB1bmRlcmx5aW5nIGltcGxlbWVudGF0aW9uIG9mIGBaZXJvQ2xpcGJvYXJkLkNsaWVudC5wcm90b3R5cGUuZGVzdHJveWAuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY2xpZW50RGVzdHJveSA9IGZ1bmN0aW9uKCkge1xuICAgIGlmICghX2NsaWVudE1ldGFbdGhpcy5pZF0pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy51bmNsaXAoKTtcbiAgICB0aGlzLm9mZigpO1xuICAgIGRlbGV0ZSBfY2xpZW50TWV0YVt0aGlzLmlkXTtcbiAgfTtcbiAgLyoqXG4gKiBJbnNwZWN0IGFuIEV2ZW50IHRvIHNlZSBpZiB0aGUgQ2xpZW50IChgdGhpc2ApIHNob3VsZCBob25vciBpdCBmb3IgZW1pc3Npb24uXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY2xpZW50U2hvdWxkRW1pdCA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgaWYgKCEoZXZlbnQgJiYgZXZlbnQudHlwZSkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKGV2ZW50LmNsaWVudCAmJiBldmVudC5jbGllbnQgIT09IHRoaXMpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdmFyIG1ldGEgPSBfY2xpZW50TWV0YVt0aGlzLmlkXTtcbiAgICB2YXIgY2xpcHBlZEVscyA9IG1ldGEgJiYgbWV0YS5lbGVtZW50cztcbiAgICB2YXIgaGFzQ2xpcHBlZEVscyA9ICEhY2xpcHBlZEVscyAmJiBjbGlwcGVkRWxzLmxlbmd0aCA+IDA7XG4gICAgdmFyIGdvb2RUYXJnZXQgPSAhZXZlbnQudGFyZ2V0IHx8IGhhc0NsaXBwZWRFbHMgJiYgY2xpcHBlZEVscy5pbmRleE9mKGV2ZW50LnRhcmdldCkgIT09IC0xO1xuICAgIHZhciBnb29kUmVsVGFyZ2V0ID0gZXZlbnQucmVsYXRlZFRhcmdldCAmJiBoYXNDbGlwcGVkRWxzICYmIGNsaXBwZWRFbHMuaW5kZXhPZihldmVudC5yZWxhdGVkVGFyZ2V0KSAhPT0gLTE7XG4gICAgdmFyIGdvb2RDbGllbnQgPSBldmVudC5jbGllbnQgJiYgZXZlbnQuY2xpZW50ID09PSB0aGlzO1xuICAgIGlmICghbWV0YSB8fCAhKGdvb2RUYXJnZXQgfHwgZ29vZFJlbFRhcmdldCB8fCBnb29kQ2xpZW50KSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfTtcbiAgLyoqXG4gKiBIYW5kbGUgdGhlIGFjdHVhbCBkaXNwYXRjaGluZyBvZiBldmVudHMgdG8gYSBjbGllbnQgaW5zdGFuY2UuXG4gKlxuICogQHJldHVybnMgYHVuZGVmaW5lZGBcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9jbGllbnREaXNwYXRjaENhbGxiYWNrcyA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgdmFyIG1ldGEgPSBfY2xpZW50TWV0YVt0aGlzLmlkXTtcbiAgICBpZiAoISh0eXBlb2YgZXZlbnQgPT09IFwib2JqZWN0XCIgJiYgZXZlbnQgJiYgZXZlbnQudHlwZSAmJiBtZXRhKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgYXN5bmMgPSBfc2hvdWxkUGVyZm9ybUFzeW5jKGV2ZW50KTtcbiAgICB2YXIgd2lsZGNhcmRUeXBlSGFuZGxlcnMgPSBtZXRhICYmIG1ldGEuaGFuZGxlcnNbXCIqXCJdIHx8IFtdO1xuICAgIHZhciBzcGVjaWZpY1R5cGVIYW5kbGVycyA9IG1ldGEgJiYgbWV0YS5oYW5kbGVyc1tldmVudC50eXBlXSB8fCBbXTtcbiAgICB2YXIgaGFuZGxlcnMgPSB3aWxkY2FyZFR5cGVIYW5kbGVycy5jb25jYXQoc3BlY2lmaWNUeXBlSGFuZGxlcnMpO1xuICAgIGlmIChoYW5kbGVycyAmJiBoYW5kbGVycy5sZW5ndGgpIHtcbiAgICAgIHZhciBpLCBsZW4sIGZ1bmMsIGNvbnRleHQsIGV2ZW50Q29weSwgb3JpZ2luYWxDb250ZXh0ID0gdGhpcztcbiAgICAgIGZvciAoaSA9IDAsIGxlbiA9IGhhbmRsZXJzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGZ1bmMgPSBoYW5kbGVyc1tpXTtcbiAgICAgICAgY29udGV4dCA9IG9yaWdpbmFsQ29udGV4dDtcbiAgICAgICAgaWYgKHR5cGVvZiBmdW5jID09PSBcInN0cmluZ1wiICYmIHR5cGVvZiBfd2luZG93W2Z1bmNdID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICBmdW5jID0gX3dpbmRvd1tmdW5jXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGZ1bmMgPT09IFwib2JqZWN0XCIgJiYgZnVuYyAmJiB0eXBlb2YgZnVuYy5oYW5kbGVFdmVudCA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgY29udGV4dCA9IGZ1bmM7XG4gICAgICAgICAgZnVuYyA9IGZ1bmMuaGFuZGxlRXZlbnQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBmdW5jID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICBldmVudENvcHkgPSBfZXh0ZW5kKHt9LCBldmVudCk7XG4gICAgICAgICAgX2Rpc3BhdGNoQ2FsbGJhY2soZnVuYywgY29udGV4dCwgWyBldmVudENvcHkgXSwgYXN5bmMpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9O1xuICAvKipcbiAqIFByZXBhcmVzIHRoZSBlbGVtZW50cyBmb3IgY2xpcHBpbmcvdW5jbGlwcGluZy5cbiAqXG4gKiBAcmV0dXJucyBBbiBBcnJheSBvZiBlbGVtZW50cy5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9wcmVwQ2xpcCA9IGZ1bmN0aW9uKGVsZW1lbnRzKSB7XG4gICAgaWYgKHR5cGVvZiBlbGVtZW50cyA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgZWxlbWVudHMgPSBbXTtcbiAgICB9XG4gICAgcmV0dXJuIHR5cGVvZiBlbGVtZW50cy5sZW5ndGggIT09IFwibnVtYmVyXCIgPyBbIGVsZW1lbnRzIF0gOiBlbGVtZW50cztcbiAgfTtcbiAgLyoqXG4gKiBBZGQgYSBgbW91c2VvdmVyYCBoYW5kbGVyIGZ1bmN0aW9uIGZvciBhIGNsaXBwZWQgZWxlbWVudC5cbiAqXG4gKiBAcmV0dXJucyBgdW5kZWZpbmVkYFxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2FkZE1vdXNlSGFuZGxlcnMgPSBmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgaWYgKCEoZWxlbWVudCAmJiBlbGVtZW50Lm5vZGVUeXBlID09PSAxKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgX3N1cHByZXNzTW91c2VFdmVudHMgPSBmdW5jdGlvbihldmVudCkge1xuICAgICAgaWYgKCEoZXZlbnQgfHwgKGV2ZW50ID0gX3dpbmRvdy5ldmVudCkpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmIChldmVudC5fc291cmNlICE9PSBcImpzXCIpIHtcbiAgICAgICAgZXZlbnQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB9XG4gICAgICBkZWxldGUgZXZlbnQuX3NvdXJjZTtcbiAgICB9O1xuICAgIHZhciBfZWxlbWVudE1vdXNlT3ZlciA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICBpZiAoIShldmVudCB8fCAoZXZlbnQgPSBfd2luZG93LmV2ZW50KSkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgX3N1cHByZXNzTW91c2VFdmVudHMoZXZlbnQpO1xuICAgICAgWmVyb0NsaXBib2FyZC5mb2N1cyhlbGVtZW50KTtcbiAgICB9O1xuICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlb3ZlclwiLCBfZWxlbWVudE1vdXNlT3ZlciwgZmFsc2UpO1xuICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlb3V0XCIsIF9zdXBwcmVzc01vdXNlRXZlbnRzLCBmYWxzZSk7XG4gICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2VlbnRlclwiLCBfc3VwcHJlc3NNb3VzZUV2ZW50cywgZmFsc2UpO1xuICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbGVhdmVcIiwgX3N1cHByZXNzTW91c2VFdmVudHMsIGZhbHNlKTtcbiAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgX3N1cHByZXNzTW91c2VFdmVudHMsIGZhbHNlKTtcbiAgICBfbW91c2VIYW5kbGVyc1tlbGVtZW50LnpjQ2xpcHBpbmdJZF0gPSB7XG4gICAgICBtb3VzZW92ZXI6IF9lbGVtZW50TW91c2VPdmVyLFxuICAgICAgbW91c2VvdXQ6IF9zdXBwcmVzc01vdXNlRXZlbnRzLFxuICAgICAgbW91c2VlbnRlcjogX3N1cHByZXNzTW91c2VFdmVudHMsXG4gICAgICBtb3VzZWxlYXZlOiBfc3VwcHJlc3NNb3VzZUV2ZW50cyxcbiAgICAgIG1vdXNlbW92ZTogX3N1cHByZXNzTW91c2VFdmVudHNcbiAgICB9O1xuICB9O1xuICAvKipcbiAqIFJlbW92ZSBhIGBtb3VzZW92ZXJgIGhhbmRsZXIgZnVuY3Rpb24gZm9yIGEgY2xpcHBlZCBlbGVtZW50LlxuICpcbiAqIEByZXR1cm5zIGB1bmRlZmluZWRgXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfcmVtb3ZlTW91c2VIYW5kbGVycyA9IGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICBpZiAoIShlbGVtZW50ICYmIGVsZW1lbnQubm9kZVR5cGUgPT09IDEpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBtb3VzZUhhbmRsZXJzID0gX21vdXNlSGFuZGxlcnNbZWxlbWVudC56Y0NsaXBwaW5nSWRdO1xuICAgIGlmICghKHR5cGVvZiBtb3VzZUhhbmRsZXJzID09PSBcIm9iamVjdFwiICYmIG1vdXNlSGFuZGxlcnMpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBrZXksIHZhbCwgbW91c2VFdmVudHMgPSBbIFwibW92ZVwiLCBcImxlYXZlXCIsIFwiZW50ZXJcIiwgXCJvdXRcIiwgXCJvdmVyXCIgXTtcbiAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gbW91c2VFdmVudHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgIGtleSA9IFwibW91c2VcIiArIG1vdXNlRXZlbnRzW2ldO1xuICAgICAgdmFsID0gbW91c2VIYW5kbGVyc1trZXldO1xuICAgICAgaWYgKHR5cGVvZiB2YWwgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICBlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoa2V5LCB2YWwsIGZhbHNlKTtcbiAgICAgIH1cbiAgICB9XG4gICAgZGVsZXRlIF9tb3VzZUhhbmRsZXJzW2VsZW1lbnQuemNDbGlwcGluZ0lkXTtcbiAgfTtcbiAgLyoqXG4gKiBDcmVhdGVzIGEgbmV3IFplcm9DbGlwYm9hcmQgY2xpZW50IGluc3RhbmNlLlxuICogT3B0aW9uYWxseSwgYXV0by1gY2xpcGAgYW4gZWxlbWVudCBvciBjb2xsZWN0aW9uIG9mIGVsZW1lbnRzLlxuICpcbiAqIEBjb25zdHJ1Y3RvclxuICovXG4gIFplcm9DbGlwYm9hcmQuX2NyZWF0ZUNsaWVudCA9IGZ1bmN0aW9uKCkge1xuICAgIF9jbGllbnRDb25zdHJ1Y3Rvci5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBSZWdpc3RlciBhbiBldmVudCBsaXN0ZW5lciB0byB0aGUgY2xpZW50LlxuICpcbiAqIEByZXR1cm5zIGB0aGlzYFxuICovXG4gIFplcm9DbGlwYm9hcmQucHJvdG90eXBlLm9uID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIF9jbGllbnRPbi5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBVbnJlZ2lzdGVyIGFuIGV2ZW50IGhhbmRsZXIgZnJvbSB0aGUgY2xpZW50LlxuICogSWYgbm8gYGxpc3RlbmVyYCBmdW5jdGlvbi9vYmplY3QgaXMgcHJvdmlkZWQsIGl0IHdpbGwgdW5yZWdpc3RlciBhbGwgaGFuZGxlcnMgZm9yIHRoZSBwcm92aWRlZCBgZXZlbnRUeXBlYC5cbiAqIElmIG5vIGBldmVudFR5cGVgIGlzIHByb3ZpZGVkLCBpdCB3aWxsIHVucmVnaXN0ZXIgYWxsIGhhbmRsZXJzIGZvciBldmVyeSBldmVudCB0eXBlLlxuICpcbiAqIEByZXR1cm5zIGB0aGlzYFxuICovXG4gIFplcm9DbGlwYm9hcmQucHJvdG90eXBlLm9mZiA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfY2xpZW50T2ZmLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIFJldHJpZXZlIGV2ZW50IGxpc3RlbmVycyBmb3IgYW4gYGV2ZW50VHlwZWAgZnJvbSB0aGUgY2xpZW50LlxuICogSWYgbm8gYGV2ZW50VHlwZWAgaXMgcHJvdmlkZWQsIGl0IHdpbGwgcmV0cmlldmUgYWxsIGxpc3RlbmVycyBmb3IgZXZlcnkgZXZlbnQgdHlwZS5cbiAqXG4gKiBAcmV0dXJucyBhcnJheSBvZiBsaXN0ZW5lcnMgZm9yIHRoZSBgZXZlbnRUeXBlYDsgaWYgbm8gYGV2ZW50VHlwZWAsIHRoZW4gYSBtYXAvaGFzaCBvYmplY3Qgb2YgbGlzdGVuZXJzIGZvciBhbGwgZXZlbnQgdHlwZXM7IG9yIGBudWxsYFxuICovXG4gIFplcm9DbGlwYm9hcmQucHJvdG90eXBlLmhhbmRsZXJzID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIF9jbGllbnRMaXN0ZW5lcnMuYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gIH07XG4gIC8qKlxuICogRXZlbnQgZW1pc3Npb24gcmVjZWl2ZXIgZnJvbSB0aGUgRmxhc2ggb2JqZWN0IGZvciB0aGlzIGNsaWVudCdzIHJlZ2lzdGVyZWQgSmF2YVNjcmlwdCBldmVudCBsaXN0ZW5lcnMuXG4gKlxuICogQHJldHVybnMgRm9yIHRoZSBcImNvcHlcIiBldmVudCwgcmV0dXJucyB0aGUgRmxhc2gtZnJpZW5kbHkgXCJjbGlwRGF0YVwiIG9iamVjdDsgb3RoZXJ3aXNlIGB1bmRlZmluZWRgLlxuICovXG4gIFplcm9DbGlwYm9hcmQucHJvdG90eXBlLmVtaXQgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX2NsaWVudEVtaXQuYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gIH07XG4gIC8qKlxuICogUmVnaXN0ZXIgY2xpcGJvYXJkIGFjdGlvbnMgZm9yIG5ldyBlbGVtZW50KHMpIHRvIHRoZSBjbGllbnQuXG4gKlxuICogQHJldHVybnMgYHRoaXNgXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5wcm90b3R5cGUuY2xpcCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfY2xpZW50Q2xpcC5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBVbnJlZ2lzdGVyIHRoZSBjbGlwYm9hcmQgYWN0aW9ucyBvZiBwcmV2aW91c2x5IHJlZ2lzdGVyZWQgZWxlbWVudChzKSBvbiB0aGUgcGFnZS5cbiAqIElmIG5vIGVsZW1lbnRzIGFyZSBwcm92aWRlZCwgQUxMIHJlZ2lzdGVyZWQgZWxlbWVudHMgd2lsbCBiZSB1bnJlZ2lzdGVyZWQuXG4gKlxuICogQHJldHVybnMgYHRoaXNgXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5wcm90b3R5cGUudW5jbGlwID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIF9jbGllbnRVbmNsaXAuYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gIH07XG4gIC8qKlxuICogR2V0IGFsbCBvZiB0aGUgZWxlbWVudHMgdG8gd2hpY2ggdGhpcyBjbGllbnQgaXMgY2xpcHBlZC5cbiAqXG4gKiBAcmV0dXJucyBhcnJheSBvZiBjbGlwcGVkIGVsZW1lbnRzXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5wcm90b3R5cGUuZWxlbWVudHMgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX2NsaWVudEVsZW1lbnRzLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIFNlbGYtZGVzdHJ1Y3QgYW5kIGNsZWFuIHVwIGV2ZXJ5dGhpbmcgZm9yIGEgc2luZ2xlIGNsaWVudC5cbiAqIFRoaXMgd2lsbCBOT1QgZGVzdHJveSB0aGUgZW1iZWRkZWQgRmxhc2ggb2JqZWN0LlxuICpcbiAqIEByZXR1cm5zIGB1bmRlZmluZWRgXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfY2xpZW50RGVzdHJveS5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBTdG9yZXMgdGhlIHBlbmRpbmcgcGxhaW4gdGV4dCB0byBpbmplY3QgaW50byB0aGUgY2xpcGJvYXJkLlxuICpcbiAqIEByZXR1cm5zIGB0aGlzYFxuICovXG4gIFplcm9DbGlwYm9hcmQucHJvdG90eXBlLnNldFRleHQgPSBmdW5jdGlvbih0ZXh0KSB7XG4gICAgaWYgKCFfY2xpZW50TWV0YVt0aGlzLmlkXSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQXR0ZW1wdGVkIHRvIHNldCBwZW5kaW5nIGNsaXBib2FyZCBkYXRhIGZyb20gYSBkZXN0cm95ZWQgWmVyb0NsaXBib2FyZCBjbGllbnQgaW5zdGFuY2VcIik7XG4gICAgfVxuICAgIFplcm9DbGlwYm9hcmQuc2V0RGF0YShcInRleHQvcGxhaW5cIiwgdGV4dCk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG4gIC8qKlxuICogU3RvcmVzIHRoZSBwZW5kaW5nIEhUTUwgdGV4dCB0byBpbmplY3QgaW50byB0aGUgY2xpcGJvYXJkLlxuICpcbiAqIEByZXR1cm5zIGB0aGlzYFxuICovXG4gIFplcm9DbGlwYm9hcmQucHJvdG90eXBlLnNldEh0bWwgPSBmdW5jdGlvbihodG1sKSB7XG4gICAgaWYgKCFfY2xpZW50TWV0YVt0aGlzLmlkXSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQXR0ZW1wdGVkIHRvIHNldCBwZW5kaW5nIGNsaXBib2FyZCBkYXRhIGZyb20gYSBkZXN0cm95ZWQgWmVyb0NsaXBib2FyZCBjbGllbnQgaW5zdGFuY2VcIik7XG4gICAgfVxuICAgIFplcm9DbGlwYm9hcmQuc2V0RGF0YShcInRleHQvaHRtbFwiLCBodG1sKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcbiAgLyoqXG4gKiBTdG9yZXMgdGhlIHBlbmRpbmcgcmljaCB0ZXh0IChSVEYpIHRvIGluamVjdCBpbnRvIHRoZSBjbGlwYm9hcmQuXG4gKlxuICogQHJldHVybnMgYHRoaXNgXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5wcm90b3R5cGUuc2V0UmljaFRleHQgPSBmdW5jdGlvbihyaWNoVGV4dCkge1xuICAgIGlmICghX2NsaWVudE1ldGFbdGhpcy5pZF0pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkF0dGVtcHRlZCB0byBzZXQgcGVuZGluZyBjbGlwYm9hcmQgZGF0YSBmcm9tIGEgZGVzdHJveWVkIFplcm9DbGlwYm9hcmQgY2xpZW50IGluc3RhbmNlXCIpO1xuICAgIH1cbiAgICBaZXJvQ2xpcGJvYXJkLnNldERhdGEoXCJhcHBsaWNhdGlvbi9ydGZcIiwgcmljaFRleHQpO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuICAvKipcbiAqIFN0b3JlcyB0aGUgcGVuZGluZyBkYXRhIHRvIGluamVjdCBpbnRvIHRoZSBjbGlwYm9hcmQuXG4gKlxuICogQHJldHVybnMgYHRoaXNgXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5wcm90b3R5cGUuc2V0RGF0YSA9IGZ1bmN0aW9uKCkge1xuICAgIGlmICghX2NsaWVudE1ldGFbdGhpcy5pZF0pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkF0dGVtcHRlZCB0byBzZXQgcGVuZGluZyBjbGlwYm9hcmQgZGF0YSBmcm9tIGEgZGVzdHJveWVkIFplcm9DbGlwYm9hcmQgY2xpZW50IGluc3RhbmNlXCIpO1xuICAgIH1cbiAgICBaZXJvQ2xpcGJvYXJkLnNldERhdGEuYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG4gIC8qKlxuICogQ2xlYXJzIHRoZSBwZW5kaW5nIGRhdGEgdG8gaW5qZWN0IGludG8gdGhlIGNsaXBib2FyZC5cbiAqIElmIG5vIGBmb3JtYXRgIGlzIHByb3ZpZGVkLCBhbGwgcGVuZGluZyBkYXRhIGZvcm1hdHMgd2lsbCBiZSBjbGVhcmVkLlxuICpcbiAqIEByZXR1cm5zIGB0aGlzYFxuICovXG4gIFplcm9DbGlwYm9hcmQucHJvdG90eXBlLmNsZWFyRGF0YSA9IGZ1bmN0aW9uKCkge1xuICAgIGlmICghX2NsaWVudE1ldGFbdGhpcy5pZF0pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkF0dGVtcHRlZCB0byBjbGVhciBwZW5kaW5nIGNsaXBib2FyZCBkYXRhIGZyb20gYSBkZXN0cm95ZWQgWmVyb0NsaXBib2FyZCBjbGllbnQgaW5zdGFuY2VcIik7XG4gICAgfVxuICAgIFplcm9DbGlwYm9hcmQuY2xlYXJEYXRhLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuICAvKipcbiAqIEdldHMgYSBjb3B5IG9mIHRoZSBwZW5kaW5nIGRhdGEgdG8gaW5qZWN0IGludG8gdGhlIGNsaXBib2FyZC5cbiAqIElmIG5vIGBmb3JtYXRgIGlzIHByb3ZpZGVkLCBhIGNvcHkgb2YgQUxMIHBlbmRpbmcgZGF0YSBmb3JtYXRzIHdpbGwgYmUgcmV0dXJuZWQuXG4gKlxuICogQHJldHVybnMgYFN0cmluZ2Agb3IgYE9iamVjdGBcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLnByb3RvdHlwZS5nZXREYXRhID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKCFfY2xpZW50TWV0YVt0aGlzLmlkXSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQXR0ZW1wdGVkIHRvIGdldCBwZW5kaW5nIGNsaXBib2FyZCBkYXRhIGZyb20gYSBkZXN0cm95ZWQgWmVyb0NsaXBib2FyZCBjbGllbnQgaW5zdGFuY2VcIik7XG4gICAgfVxuICAgIHJldHVybiBaZXJvQ2xpcGJvYXJkLmdldERhdGEuYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gIH07XG4gIGlmICh0eXBlb2YgZGVmaW5lID09PSBcImZ1bmN0aW9uXCIgJiYgZGVmaW5lLmFtZCkge1xuICAgIGRlZmluZShmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBaZXJvQ2xpcGJvYXJkO1xuICAgIH0pO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBtb2R1bGUgPT09IFwib2JqZWN0XCIgJiYgbW9kdWxlICYmIHR5cGVvZiBtb2R1bGUuZXhwb3J0cyA9PT0gXCJvYmplY3RcIiAmJiBtb2R1bGUuZXhwb3J0cykge1xuICAgIG1vZHVsZS5leHBvcnRzID0gWmVyb0NsaXBib2FyZDtcbiAgfSBlbHNlIHtcbiAgICB3aW5kb3cuWmVyb0NsaXBib2FyZCA9IFplcm9DbGlwYm9hcmQ7XG4gIH1cbn0pKGZ1bmN0aW9uKCkge1xuICByZXR1cm4gdGhpcyB8fCB3aW5kb3c7XG59KCkpOyIsIi8qanNsaW50IGJyb3dzZXI6IHRydWUqL1xyXG4vKmpzaGludCAtVzA1NSAqL1xyXG4vKmdsb2JhbCBjb25zb2xlLCBhbGVydCovXHJcblxyXG4vKlxyXG4gKiBGb3IgZWFjaCBkaXNlYXNlIGFyZWEgdGhlcmUgd2lsbCBiZSA0IHN0YWdlczogRGlhZ25vc2lzLCBNb25pdG9yaW5nLCBUcmVhdG1lbnQgYW5kIEV4Y2x1c2lvbnMuXHJcbiAqIEVhY2ggc3RhZ2UgZ2V0cyBhIHNpbmdsZSBwYW5lbCBvbiB0aGUgZnJvbnQgc2NyZWVuLlxyXG4gKiBDbGlja2luZyBvbiBhIHBhbmVsIHRha2VzIHlvdSB0byBhIHNjcmVlbiBzcGVjaWZpYyB0byB0aGF0IHN0YWdlLCBidXQgc2ltaWxhciBpbiBsYXlvdXQgYW5kIGNvbnRlbnRcclxuICogIHRvIGFsbCB0aGUgb3RoZXJzLlxyXG4gKi9cclxuXHJcbnZhciB0ZW1wbGF0ZSA9IHJlcXVpcmUoJy4vc3JjL3RlbXBsYXRlLmpzJyksXHJcbiAgbWFpbiA9IHJlcXVpcmUoJy4vc3JjL21haW4uanMnKTtcclxuXHJcbi8vVE9ETyBub3Qgc3VyZSB3aHkgaSBkaWQgdGhpcyAtIHdhcyBpbiBsb2NhbCB2YXJpYWJsZVxyXG4vL21heWJlIGEgc2VwYXJhdGUgbW9kdWxlXHJcbi8vd2luZG93LmxvY2F0aW9uID0gd2luZG93Lmhpc3RvcnkubG9jYXRpb24gfHwgd2luZG93LmxvY2F0aW9uO1xyXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuICoqKiBTaG93cyB0aGUgcHJlLWxvYWQgaW1hZ2UgYW5kIHNsb3dseSBmYWRlcyBpdCBvdXQuICoqKlxyXG4gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXHJcbiQod2luZG93KS5sb2FkKGZ1bmN0aW9uKCkge1xyXG4gICQoJy5sb2FkaW5nLWNvbnRhaW5lcicpLmZhZGVPdXQoMTAwMCwgZnVuY3Rpb24oKSB7XHJcbiAgICAvLyQodGhpcykucmVtb3ZlKCk7XHJcbiAgfSk7XHJcbn0pO1xyXG5cclxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG4gKioqIFRoaXMgaGFwcGVucyB3aGVuIHRoZSBwYWdlIGlzIHJlYWR5ICoqKlxyXG4gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xyXG4kKGRvY3VtZW50KS5vbigncmVhZHknLCBmdW5jdGlvbigpIHtcclxuICAvL0dyYWIgdGhlIGhhc2ggaWYgZXhpc3RzIC0gSUUgc2VlbXMgdG8gZm9yZ2V0IGl0XHJcbiAgbWFpbi5oYXNoID0gbG9jYXRpb24uaGFzaDtcclxuICAvL0xvYWQgdGhlIGRhdGEgdGhlbiB3aXJlIHVwIHRoZSBldmVudHMgb24gdGhlIHBhZ2VcclxuICBtYWluLmluaXQoKTtcclxuXHJcbiAgLy9Tb3J0cyBvdXQgdGhlIGRhdGEgaGVsZCBsb2NhbGx5IGluIHRoZSB1c2VyJ3MgYnJvd3NlclxyXG4gIGlmICghbG9jYWxTdG9yYWdlLmJiKSBsb2NhbFN0b3JhZ2UuYmIgPSBKU09OLnN0cmluZ2lmeSh7fSk7XHJcbiAgdmFyIG9iaiA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmJiKTtcclxuICBpZiAoIW9iai52ZXJzaW9uIHx8IG9iai52ZXJzaW9uICE9PSBtYWluLnZlcnNpb24pIHtcclxuICAgIGxvY2FsU3RvcmFnZS5iYiA9IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgXCJ2ZXJzaW9uXCI6IG1haW4udmVyc2lvblxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAkKCdbZGF0YS10b2dnbGU9XCJ0b29sdGlwXCJdJykudG9vbHRpcCh7XHJcbiAgICBjb250YWluZXI6ICdib2R5JyxcclxuICAgIGRlbGF5OiB7XHJcbiAgICAgIFwic2hvd1wiOiA1MDAsXHJcbiAgICAgIFwiaGlkZVwiOiAxMDBcclxuICAgIH0sXHJcbiAgICBodG1sOiB0cnVlXHJcbiAgfSk7XHJcbiAgJCgnW2RhdGEtdG9nZ2xlPVwibG9uZS10b29sdGlwXCJdJykudG9vbHRpcCh7XHJcbiAgICBjb250YWluZXI6ICdib2R5JyxcclxuICAgIGRlbGF5OiB7XHJcbiAgICAgIFwic2hvd1wiOiAzMDAsXHJcbiAgICAgIFwiaGlkZVwiOiAxMDBcclxuICAgIH1cclxuICB9KTtcclxuICAkKCdbZGF0YS10b2dnbGU9XCJsb25lLXRvb2x0aXBcIl0nKS5vbignc2hvd24uYnMudG9vbHRpcCcsIGZ1bmN0aW9uKGUpIHtcclxuICAgICQoJ1tkYXRhLXRvZ2dsZT1cInRvb2x0aXBcIl0nKS5ub3QodGhpcykudG9vbHRpcCgnaGlkZScpO1xyXG4gIH0pO1xyXG5cclxuICAvL2Vuc3VyZSBvbiBmaXJzdCBsb2FkIHRoZSBsb2dpbiBzY3JlZW4gaXMgY2FjaGVkIHRvIHRoZSBoaXN0b3J5XHJcbiAgaGlzdG9yeS5wdXNoU3RhdGUobnVsbCwgbnVsbCwgJycpO1xyXG59KTtcclxuIiwidmFyIGRhdGEgPSByZXF1aXJlKCcuL2RhdGEuanMnKSxcclxuICBsb29rdXAgPSByZXF1aXJlKCcuL2xvb2t1cC5qcycpLFxyXG4gIGNoYXJ0ID0gcmVxdWlyZSgnLi9jaGFydC5qcycpLFxyXG4gIGxvZyA9IHJlcXVpcmUoJy4vbG9nLmpzJyksXHJcbiAgTXVzdGFjaGUgPSByZXF1aXJlKCdtdXN0YWNoZScpLFxyXG4gIFplcm9DbGlwYm9hcmQgPSByZXF1aXJlKCd6ZXJvY2xpcGJvYXJkJyk7XHJcblxyXG52YXIgYmFzZSA9IHtcclxuXHJcbiAgLy9vYmplY3QgZm9yIGtlZXBpbmcgdHJhY2sgd2hhdCBpcyBpbiBlYWNoIHBhbmVsIHRvIHByZXZlbnQgdW5uZWNlc3NhcnkgcmVkcmF3c1xyXG4gIHBhbmVsczoge30sXHJcblxyXG4gIHNlbGVjdFRhYjogZnVuY3Rpb24oaWQpIHtcclxuICAgIHZhciBocmVmID0gJCgnI21haW5UYWIgbGkuYWN0aXZlIGEnKS5kYXRhKFwiaHJlZlwiKTtcclxuICAgICQoJyNtYWluVGFiIGxpLmFjdGl2ZScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKS5maW5kKCdhJykuYXR0cihcImhyZWZcIiwgaHJlZik7XHJcbiAgICAkKCcjbWFpblRhYiBsaVtkYXRhLWlkPVwiJyArIGlkICsgJ1wiXScpLmFkZENsYXNzKCdhY3RpdmUnKS5maW5kKCdhJykucmVtb3ZlQXR0cihcImhyZWZcIik7XHJcbiAgfSxcclxuXHJcbiAgY3JlYXRlUGFuZWw6IGZ1bmN0aW9uKHRlbXBsYXRlU2VsZWN0b3IsIGRhdGEsIHRlbXBsYXRlcykge1xyXG4gICAgdmFyIHRlbXBNdXN0ID0gdGVtcGxhdGVTZWxlY3Rvci5odG1sKCk7XHJcbiAgICBNdXN0YWNoZS5wYXJzZSh0ZW1wTXVzdCk7IC8vIG9wdGlvbmFsLCBzcGVlZHMgdXAgZnV0dXJlIHVzZXNcclxuICAgIGlmICh0ZW1wbGF0ZXMpIHtcclxuICAgICAgZm9yICh2YXIgbyBpbiB0ZW1wbGF0ZXMpIHtcclxuICAgICAgICBpZiAodGVtcGxhdGVzLmhhc093blByb3BlcnR5KG8pKSB7XHJcbiAgICAgICAgICBNdXN0YWNoZS5wYXJzZSh0ZW1wbGF0ZXNbb10pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgdmFyIHJlbmRlcmVkID0gTXVzdGFjaGUucmVuZGVyKHRlbXBNdXN0LCBkYXRhLCB0ZW1wbGF0ZXMpO1xyXG4gICAgcmV0dXJuIHJlbmRlcmVkO1xyXG4gIH0sXHJcblxyXG4gIGNyZWF0ZVBhbmVsU2hvdzogZnVuY3Rpb24odGVtcGxhdGVTZWxlY3RvciwgcGFuZWxTZWxlY3RvciwgZGF0YSwgdGVtcGxhdGVzKSB7XHJcbiAgICB2YXIgcmVuZGVyZWQgPSBiYXNlLmNyZWF0ZVBhbmVsKHRlbXBsYXRlU2VsZWN0b3IsIGRhdGEsIHRlbXBsYXRlcyk7XHJcbiAgICBwYW5lbFNlbGVjdG9yLmh0bWwocmVuZGVyZWQpLnNob3coKTtcclxuICB9LFxyXG5cclxuICBzaG93UGF0aHdheVN0YWdlT3ZlcnZpZXdQYW5lbDogZnVuY3Rpb24obG9jYXRpb24sIGVuYWJsZUhvdmVyLCBwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSkge1xyXG4gICAgdmFyIHN0YW5kYXJkcyA9IFtdO1xyXG4gICAgZm9yICh2YXIgc3RhbmRhcmQgaW4gZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzKSB7XHJcbiAgICAgIHZhciBkZW5vbSA9IGRhdGEuZ2V0RGVub21pbmF0b3JGb3JTdGFuZGFyZChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSk7XHJcbiAgICAgIHZhciBudW0gPSBkZW5vbSAtIGRhdGEuZ2V0TnVtZXJhdG9yRm9yU3RhbmRhcmQocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkKTtcclxuICAgICAgc3RhbmRhcmRzLnB1c2goe1xyXG4gICAgICAgIFwic3RhbmRhcmRcIjogZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS50YWIudGl0bGUsXHJcbiAgICAgICAgXCJzdGFuZGFyZEtleVwiOiBzdGFuZGFyZCxcclxuICAgICAgICBcInRvb2x0aXBcIjogZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXVtcInN0YW5kYXJkLW1ldC10b29sdGlwXCJdLFxyXG4gICAgICAgIFwibnVtZXJhdG9yXCI6IG51bSxcclxuICAgICAgICBcImRlbm9taW5hdG9yXCI6IGRlbm9tLFxyXG4gICAgICAgIFwicGVyY2VudGFnZVwiOiAobnVtICogMTAwIC8gZGVub20pLnRvRml4ZWQoMClcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgYmFzZS5jcmVhdGVQYW5lbFNob3coJCgnI3BhdGh3YXktc3RhZ2Utb3ZlcnZpZXctcGFuZWwnKSwgbG9jYXRpb24sIHtcclxuICAgICAgcGF0aHdheTogZGF0YS5wYXRod2F5TmFtZXNbcGF0aHdheUlkXSxcclxuICAgICAgcGF0aHdheVN0YWdlOiBwYXRod2F5U3RhZ2UsXHJcbiAgICAgIHBhdGh3YXlTdGFnZU5hbWU6IGxvb2t1cC5jYXRlZ29yaWVzW3BhdGh3YXlTdGFnZV0uZGlzcGxheSxcclxuICAgICAgcGF0aHdheU5hbWVTaG9ydDogcGF0aHdheUlkLFxyXG4gICAgICB0aXRsZTogZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0udGV4dC5wYW5lbC50ZXh0LFxyXG4gICAgICBzdGFuZGFyZHM6IHN0YW5kYXJkc1xyXG4gICAgfSwge1xyXG4gICAgICBcInJvd1wiOiAkKCcjb3ZlcnZpZXctcGFuZWwtdGFibGUtcm93JykuaHRtbCgpXHJcbiAgICB9KTtcclxuXHJcbiAgICAkKCcjJyArIHBhdGh3YXlTdGFnZSArICctdHJlbmQtdG9nZ2xlJykub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICBpZiAoJCh0aGlzKS50ZXh0KCkgPT09IFwiVHJlbmRcIikge1xyXG4gICAgICAgICQodGhpcykudGV4dChcIlRhYmxlXCIpO1xyXG4gICAgICAgICQoJyMnICsgcGF0aHdheVN0YWdlICsgJy1jaGFydC10YWJsZScpLmhpZGUoKTtcclxuICAgICAgICAkKCcjJyArIHBhdGh3YXlTdGFnZSArICctY2hhcnQtd3JhcHBlcicpLnNob3coKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAkKHRoaXMpLnRleHQoXCJUcmVuZFwiKTtcclxuICAgICAgICAkKCcjJyArIHBhdGh3YXlTdGFnZSArICctY2hhcnQtdGFibGUnKS5zaG93KCk7XHJcbiAgICAgICAgJCgnIycgKyBwYXRod2F5U3RhZ2UgKyAnLWNoYXJ0LXdyYXBwZXInKS5oaWRlKCk7XHJcbiAgICAgIH1cclxuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGNoYXJ0LmRyYXdPdmVydmlld0NoYXJ0KHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBlbmFibGVIb3Zlcik7XHJcblxyXG4gIH0sXHJcblxyXG4gIGhpZGVGb290ZXI6IGZ1bmN0aW9uKCkge1xyXG4gICAgJCgnZm9vdGVyJykuaGlkZSgpO1xyXG4gIH0sXHJcblxyXG4gIHNob3dGb290ZXI6IGZ1bmN0aW9uKCkge1xyXG4gICAgJCgnZm9vdGVyJykuc2hvdygpO1xyXG4gIH0sXHJcblxyXG4gIGhpZGVUb29sdGlwczogZnVuY3Rpb24oKSB7XHJcbiAgICAkKCdbZGF0YS10b2dnbGU9XCJ0b29sdGlwXCJdJykudG9vbHRpcCgnaGlkZScpO1xyXG4gIH0sXHJcblxyXG4gIHdpcmVVcFRvb2x0aXBzOiBmdW5jdGlvbigpIHtcclxuICAgICQoJ1tkYXRhLXRvZ2dsZT1cInRvb2x0aXBcIl0nKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAkKCcudG9vbHRpcCcpLnJlbW92ZSgpO1xyXG5cclxuICAgICQoJ1tkYXRhLXRvZ2dsZT1cInRvb2x0aXBcIl0nKS50b29sdGlwKHtcclxuICAgICAgY29udGFpbmVyOiAnYm9keScsXHJcbiAgICAgIGRlbGF5OiB7XHJcbiAgICAgICAgXCJzaG93XCI6IDUwMCxcclxuICAgICAgICBcImhpZGVcIjogMTAwXHJcbiAgICAgIH0sXHJcbiAgICAgIGh0bWw6IHRydWVcclxuICAgIH0pO1xyXG4gICAgJCgnW2RhdGEtdG9nZ2xlPVwibG9uZS10b29sdGlwXCJdJykudG9vbHRpcCh7XHJcbiAgICAgIGNvbnRhaW5lcjogJ2JvZHknLFxyXG4gICAgICBkZWxheToge1xyXG4gICAgICAgIFwic2hvd1wiOiAzMDAsXHJcbiAgICAgICAgXCJoaWRlXCI6IDEwMFxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgICQoJ1tkYXRhLXRvZ2dsZT1cImxvbmUtdG9vbHRpcFwiXScpLm9uKCdzaG93bi5icy50b29sdGlwJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAkKCdbZGF0YS10b2dnbGU9XCJ0b29sdGlwXCJdJykubm90KHRoaXMpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgIH0pO1xyXG4gICAgJCgnLnBhdGllbnQtcm93LXRvb2x0aXAnKS5vbignc2hvdy5icy50b29sdGlwJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICBpZiAoJCh0aGlzKS5oYXNDbGFzcygnaGlnaGxpZ2h0ZWQnKSkge1xyXG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICBzZXR1cENsaXBib2FyZDogZnVuY3Rpb24oc2VsZWN0b3IsIGRlc3Ryb3kpIHtcclxuICAgIGlmIChkZXN0cm95KSBaZXJvQ2xpcGJvYXJkLmRlc3Ryb3koKTsgLy90aWR5IHVwXHJcblxyXG4gICAgdmFyIGNsaWVudCA9IG5ldyBaZXJvQ2xpcGJvYXJkKHNlbGVjdG9yKTtcclxuXHJcbiAgICBjbGllbnQub24oJ3JlYWR5JywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIGNsaWVudC5vbignYWZ0ZXJjb3B5JywgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnQ29waWVkIHRleHQgdG8gY2xpcGJvYXJkOiAnICsgZXZlbnQuZGF0YVsndGV4dC9wbGFpbiddKTtcclxuICAgICAgICAkKGV2ZW50LnRhcmdldCkudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgICQoZXZlbnQudGFyZ2V0KS5wb3BvdmVyKHtcclxuICAgICAgICAgIHRyaWdnZXI6ICdtYW51YWwnLFxyXG4gICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IGNsYXNzPVwicG9wb3ZlclwiIHJvbGU9XCJ0b29sdGlwXCI+PGRpdiBjbGFzcz1cImFycm93XCI+PC9kaXY+PGRpdiBjbGFzcz1cInBvcG92ZXItY29udGVudFwiPjwvZGl2PjwvZGl2PicsXHJcbiAgICAgICAgICBkZWxheToge1xyXG4gICAgICAgICAgICBzaG93OiA1MDAsXHJcbiAgICAgICAgICAgIGhpZGU6IDUwMFxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNsZWFyVGltZW91dChsb29rdXAudG1wKTtcclxuICAgICAgICAkKGV2ZW50LnRhcmdldCkucG9wb3Zlcignc2hvdycpO1xyXG4gICAgICAgIGxvb2t1cC50bXAgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgJChldmVudC50YXJnZXQpLnBvcG92ZXIoJ2hpZGUnKTtcclxuICAgICAgICB9LCA2MDApO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIGNsZWFyQm94OiBmdW5jdGlvbigpIHtcclxuICAgIC8vQ2xlYXIgdGhlIHBhdGllbnQgc2VhcmNoIGJveFxyXG4gICAgJCgnLnR5cGVhaGVhZCcpLnR5cGVhaGVhZCgndmFsJywgJycpO1xyXG4gIH0sXHJcblxyXG4gIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG4gICAqIE1vZGFsc1xyXG4gICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cclxuXHJcbiAgbGF1bmNoTW9kYWw6IGZ1bmN0aW9uKGRhdGEsIGxhYmVsLCB2YWx1ZSwgcmVhc29uVGV4dCwgY2FsbGJhY2tPblNhdmUsIGNhbGxiYWNrT25DYW5jZWwsIGNhbGxiYWNrT25VbmRvKSB7XHJcbiAgICB2YXIgdGVtcGxhdGUgPSAkKCcjbW9kYWwtd2h5JykuaHRtbCgpO1xyXG4gICAgTXVzdGFjaGUucGFyc2UodGVtcGxhdGUpOyAvLyBvcHRpb25hbCwgc3BlZWRzIHVwIGZ1dHVyZSB1c2VzXHJcblxyXG4gICAgdmFyIHJlYXNvblRlbXBsYXRlID0gJCgnI21vZGFsLXdoeS1pdGVtJykuaHRtbCgpO1xyXG4gICAgTXVzdGFjaGUucGFyc2UocmVhc29uVGVtcGxhdGUpO1xyXG5cclxuICAgIGlmIChkYXRhLnJlYXNvbnMgJiYgZGF0YS5yZWFzb25zLmxlbmd0aCA+IDApIGRhdGEuaGFzUmVhc29ucyA9IHRydWU7XHJcblxyXG4gICAgdmFyIHJlbmRlcmVkID0gTXVzdGFjaGUucmVuZGVyKHRlbXBsYXRlLCBkYXRhLCB7XHJcbiAgICAgIFwiaXRlbVwiOiByZWFzb25UZW1wbGF0ZVxyXG4gICAgfSk7XHJcbiAgICAkKCcjbW9kYWwnKS5odG1sKHJlbmRlcmVkKTtcclxuXHJcbiAgICBpZiAocmVhc29uVGV4dCkge1xyXG4gICAgICAkKCcjbW9kYWwgdGV4dGFyZWEnKS52YWwocmVhc29uVGV4dCk7XHJcbiAgICB9XHJcbiAgICBsb29rdXAubW9kYWxTYXZlZCA9IGZhbHNlO1xyXG4gICAgbG9va3VwLm1vZGFsVW5kbyA9IGZhbHNlO1xyXG5cclxuICAgICQoJyNtb2RhbCAubW9kYWwnKS5vZmYoJ2NsaWNrJywgJy51bmRvLXBsYW4nKS5vbignY2xpY2snLCAnLnVuZG8tcGxhbicsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgbG9va3VwLm1vZGFsVW5kbyA9IHRydWU7XHJcbiAgICB9KS5vZmYoJ3N1Ym1pdCcsICdmb3JtJykub24oJ3N1Ym1pdCcsICdmb3JtJywge1xyXG4gICAgICBcImxhYmVsXCI6IGxhYmVsXHJcbiAgICB9LCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIGlmICghZS5kYXRhLmxhYmVsKSBlLmRhdGEubGFiZWwgPSBcInRlYW1cIjtcclxuICAgICAgdmFyIHJlYXNvbiA9ICQoJ2lucHV0OnJhZGlvW25hbWU9cmVhc29uXTpjaGVja2VkJykudmFsKCk7XHJcbiAgICAgIHZhciByZWFzb25UZXh0ID0gJCgnI21vZGFsIHRleHRhcmVhJykudmFsKCk7XHJcblxyXG4gICAgICBsb2cucmVjb3JkRmVlZGJhY2soZGF0YS5wYXRod2F5SWQsIGUuZGF0YS5sYWJlbCwgdmFsdWUsIHJlYXNvbiwgcmVhc29uVGV4dCk7XHJcblxyXG4gICAgICBsb29rdXAubW9kYWxTYXZlZCA9IHRydWU7XHJcblxyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICQoJyNtb2RhbCAubW9kYWwnKS5tb2RhbCgnaGlkZScpO1xyXG4gICAgfSkubW9kYWwoKTtcclxuXHJcbiAgICAkKCcjbW9kYWwnKS5vZmYoJ2hpZGRlbi5icy5tb2RhbCcpLm9uKCdoaWRkZW4uYnMubW9kYWwnLCB7XHJcbiAgICAgIFwibGFiZWxcIjogbGFiZWxcclxuICAgIH0sIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgaWYgKGxvb2t1cC5tb2RhbFNhdmVkKSB7XHJcbiAgICAgICAgbG9va3VwLm1vZGFsU2F2ZWQgPSBmYWxzZTtcclxuICAgICAgICBpZiAoY2FsbGJhY2tPblNhdmUpIGNhbGxiYWNrT25TYXZlKCk7XHJcbiAgICAgIH0gZWxzZSBpZiAobG9va3VwLm1vZGFsVW5kbykge1xyXG4gICAgICAgIGxvb2t1cC5tb2RhbFVuZG8gPSBmYWxzZTtcclxuICAgICAgICBpZiAoY2FsbGJhY2tPblVuZG8pIGNhbGxiYWNrT25VbmRvKCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy91bmNoZWNrIGFzIGNhbmNlbGxlZC4gLSBidXQgbm90IGlmIHZhbHVlIGlzIGVtcHR5IGFzIHRoaXMgdW5jaGVja3MgZXZlcnl0aGluZyAtIG9yIGlmIGFscmVhZHkgY2hlY2tlZFxyXG4gICAgICAgIGlmIChjYWxsYmFja09uQ2FuY2VsKSBjYWxsYmFja09uQ2FuY2VsKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIHNvcnRTdWdnZXN0aW9uczogZnVuY3Rpb24oc3VnZ2VzdGlvbnMpIHtcclxuICAgIHN1Z2dlc3Rpb25zLnNvcnQoZnVuY3Rpb24oYSwgYikge1xyXG4gICAgICBpZiAoYS5hZ3JlZSAmJiAhYS5kb25lKSB7XHJcbiAgICAgICAgaWYgKGIuYWdyZWUgJiYgIWIuZG9uZSkgcmV0dXJuIDA7XHJcbiAgICAgICAgcmV0dXJuIC0xO1xyXG4gICAgICB9IGVsc2UgaWYgKCFhLmFncmVlICYmICFhLmRpc2FncmVlKSB7XHJcbiAgICAgICAgaWYgKCFiLmFncmVlICYmICFiLmRpc2FncmVlKSByZXR1cm4gMDtcclxuICAgICAgICBpZiAoYi5hZ3JlZSAmJiAhYi5kb25lKSByZXR1cm4gMTtcclxuICAgICAgICByZXR1cm4gLTE7XHJcbiAgICAgIH0gZWxzZSBpZiAoYS5hZ3JlZSAmJiBhLmRvbmUpIHtcclxuICAgICAgICBpZiAoYi5hZ3JlZSAmJiBiLmRvbmUpIHJldHVybiAwO1xyXG4gICAgICAgIGlmIChiLmRpc2FncmVlKSByZXR1cm4gLTE7XHJcbiAgICAgICAgcmV0dXJuIDE7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaWYgKGIuZGlzYWdyZWUpIHJldHVybiAwO1xyXG4gICAgICAgIHJldHVybiAxO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gc3VnZ2VzdGlvbnM7XHJcbiAgfSxcclxuXHJcbiAgYWRkRGlzYWdyZWVQZXJzb25hbFRlYW06IGZ1bmN0aW9uKHBsYW5zKSB7XHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBsYW5zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIGlmIChwbGFuc1tpXS5hZ3JlZSkge1xyXG4gICAgICAgIHBsYW5zW2ldLmRpc2FncmVlID0gZmFsc2U7XHJcbiAgICAgIH0gZWxzZSBpZiAocGxhbnNbaV0uYWdyZWUgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgcGxhbnNbaV0uZGlzYWdyZWUgPSB0cnVlO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcGxhbnM7XHJcbiAgfSxcclxuXHJcbiAgc3VnZ2VzdGlvbkxpc3Q6IGZ1bmN0aW9uKGlkcykge1xyXG4gICAgcmV0dXJuIGlkcy5tYXAoZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgXCJpZFwiOiB2YWwuaWQgfHwgdmFsLFxyXG4gICAgICAgIFwidGV4dFwiOiBsb2cudGV4dFt2YWwuaWQgfHwgdmFsXS50ZXh0LFxyXG4gICAgICAgIFwic3Vic2VjdGlvblwiOiB2YWwuc3Vic2VjdGlvblxyXG4gICAgICB9O1xyXG4gICAgfSkuZmlsdGVyKGZ1bmN0aW9uKHYsIGkpIHsgLy9SVyB0byBhbHdheXMgbGltaXQgdG8gM1xyXG4gICAgICByZXR1cm4gaSA8IDM7XHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICBtZXJnZUluZGl2aWR1YWxTdHVmZjogZnVuY3Rpb24oc3VnZ2VzdGlvbnMsIHBhdGllbnRJZCkge1xyXG4gICAgdmFyIGxvY2FsQWN0aW9ucyA9IGxvZy5saXN0QWN0aW9ucygpO1xyXG4gICAgaWYgKCFsb2NhbEFjdGlvbnNbcGF0aWVudElkXSkgcmV0dXJuIHN1Z2dlc3Rpb25zO1xyXG5cclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3VnZ2VzdGlvbnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgaWYgKGxvY2FsQWN0aW9uc1twYXRpZW50SWRdW3N1Z2dlc3Rpb25zW2ldLmlkXSkge1xyXG4gICAgICAgIGlmIChsb2NhbEFjdGlvbnNbcGF0aWVudElkXVtzdWdnZXN0aW9uc1tpXS5pZF0uYWdyZWUpIHtcclxuICAgICAgICAgIHN1Z2dlc3Rpb25zW2ldLmFncmVlID0gdHJ1ZTtcclxuICAgICAgICB9IGVsc2UgaWYgKGxvY2FsQWN0aW9uc1twYXRpZW50SWRdW3N1Z2dlc3Rpb25zW2ldLmlkXS5hZ3JlZSA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgIHN1Z2dlc3Rpb25zW2ldLmRpc2FncmVlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGxvY2FsQWN0aW9uc1twYXRpZW50SWRdW3N1Z2dlc3Rpb25zW2ldLmlkXS5kb25lKSBzdWdnZXN0aW9uc1tpXS5kb25lID0gbG9jYWxBY3Rpb25zW3BhdGllbnRJZF1bc3VnZ2VzdGlvbnNbaV0uaWRdLmRvbmU7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBzdWdnZXN0aW9ucztcclxuICB9LFxyXG5cclxuICBzd2l0Y2hUbzExMExheW91dDogZnVuY3Rpb24oKSB7XHJcbiAgICBpZiAoYmFzZS5sYXlvdXQgPT09IFwiMTEwXCIpIHJldHVybjtcclxuICAgIGJhc2UubGF5b3V0ID0gXCIxMTBcIjtcclxuICAgIGZhckxlZnRQYW5lbC5yZW1vdmVDbGFzcygnY29sLWxnLTMgY29sLWxnLTgnKS5hZGRDbGFzcygnY29sLWxnLTYnKS5zaG93KCk7XHJcbiAgICB0b3BQYW5lbC5oaWRlKCk7XHJcbiAgICB0b3BMZWZ0UGFuZWwuaGlkZSgpO1xyXG4gICAgYm90dG9tTGVmdFBhbmVsLmhpZGUoKTtcclxuICAgIHRvcFJpZ2h0UGFuZWwuaGlkZSgpO1xyXG4gICAgYm90dG9tUmlnaHRQYW5lbC5oaWRlKCk7XHJcbiAgICBtaWRQYW5lbC5oaWRlKCk7XHJcbiAgICBmYXJSaWdodFBhbmVsLnJlbW92ZUNsYXNzKCdjb2wteGwtNCcpLmFkZENsYXNzKCdjb2wteGwtOCcpLnNob3coKTtcclxuICB9LFxyXG5cclxuICBzd2l0Y2hUbzEwMUxheW91dDogZnVuY3Rpb24oKSB7XHJcbiAgICBpZiAoYmFzZS5sYXlvdXQgPT09IFwiMTAxXCIpIHJldHVybjtcclxuICAgIGJhc2UubGF5b3V0ID0gXCIxMDFcIjtcclxuICAgIGZhckxlZnRQYW5lbC5yZW1vdmVDbGFzcygnY29sLWxnLTMgY29sLWxnLTYgY29sLXhsLTQnKS5hZGRDbGFzcygnY29sLWxnLTgnKS5zaG93KCk7XHJcbiAgICB0b3BQYW5lbC5oaWRlKCk7XHJcbiAgICB0b3BMZWZ0UGFuZWwuaGlkZSgpO1xyXG4gICAgYm90dG9tTGVmdFBhbmVsLmhpZGUoKTtcclxuICAgIHRvcFJpZ2h0UGFuZWwuaGlkZSgpO1xyXG4gICAgYm90dG9tUmlnaHRQYW5lbC5oaWRlKCk7XHJcbiAgICBtaWRQYW5lbC5oaWRlKCk7XHJcbiAgICBmYXJSaWdodFBhbmVsLnJlbW92ZUNsYXNzKCdjb2wteGwtOCcpLmFkZENsYXNzKCdjb2wteGwtNCcpLnNob3coKTtcclxuICB9LFxyXG5cclxuXHJcblxyXG4gIHN3aXRjaFRvMjIxTGF5b3V0OiBmdW5jdGlvbigpIHtcclxuICAgIGlmIChiYXNlLmxheW91dCA9PT0gXCIyMjFcIikgcmV0dXJuO1xyXG4gICAgYmFzZS5sYXlvdXQgPSBcIjIyMVwiO1xyXG4gICAgZmFyTGVmdFBhbmVsLmhpZGUoKTtcclxuICAgIHRvcFBhbmVsLmhpZGUoKTtcclxuICAgIHRvcExlZnRQYW5lbC5hZGRDbGFzcygnY29sLXhsLTYnKS5zaG93KCk7XHJcbiAgICBib3R0b21MZWZ0UGFuZWwuYWRkQ2xhc3MoJ2NvbC14bC02Jykuc2hvdygpO1xyXG4gICAgdG9wUmlnaHRQYW5lbC5yZW1vdmVDbGFzcygnY29sLXhsLTEyJykuYWRkQ2xhc3MoJ2NvbC14bC02Jykuc2hvdygpO1xyXG4gICAgYm90dG9tUmlnaHRQYW5lbC5yZW1vdmVDbGFzcygnY29sLXhsLTEyJykuYWRkQ2xhc3MoJ2NvbC14bC02Jykuc2hvdygpO1xyXG4gICAgbWlkUGFuZWwucmVtb3ZlQ2xhc3MoJ2NvbC14bC00JykuYWRkQ2xhc3MoJ2NvbC14bC04Jykuc2hvdygpO1xyXG4gICAgZmFyUmlnaHRQYW5lbC5yZW1vdmVDbGFzcygnY29sLXhsLTgnKS5hZGRDbGFzcygnY29sLXhsLTQnKS5zaG93KCk7XHJcbiAgfSxcclxuXHJcbiAgc3dpdGNoVG8yMUxheW91dDogZnVuY3Rpb24oKSB7XHJcbiAgICBpZiAoYmFzZS5sYXlvdXQgPT09IFwiMjFcIikgcmV0dXJuO1xyXG4gICAgYmFzZS5sYXlvdXQgPSBcIjIxXCI7XHJcbiAgICBmYXJMZWZ0UGFuZWwuaGlkZSgpO1xyXG4gICAgdG9wUGFuZWwuaGlkZSgpO1xyXG4gICAgdG9wTGVmdFBhbmVsLmhpZGUoKTtcclxuICAgIGJvdHRvbUxlZnRQYW5lbC5oaWRlKCk7XHJcbiAgICB0b3BSaWdodFBhbmVsLnJlbW92ZUNsYXNzKCdjb2wteGwtNicpLmFkZENsYXNzKCdjb2wteGwtMTInKS5zaG93KCk7XHJcbiAgICBib3R0b21SaWdodFBhbmVsLnJlbW92ZUNsYXNzKCdjb2wteGwtNicpLmFkZENsYXNzKCdjb2wteGwtMTInKS5zaG93KCk7XHJcbiAgICBtaWRQYW5lbC5yZW1vdmVDbGFzcygnY29sLXhsLTQnKS5hZGRDbGFzcygnY29sLXhsLTgnKS5zaG93KCk7XHJcbiAgICBmYXJSaWdodFBhbmVsLnJlbW92ZUNsYXNzKCdjb2wteGwtOCcpLmFkZENsYXNzKCdjb2wteGwtNCcpLnNob3coKTtcclxuICB9LFxyXG5cclxuICB3aXJlVXBTdGFuZGFyZERyb3BEb3duOiBmdW5jdGlvbihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIGNhbGxiYWNrKSB7XHJcbiAgICB2YXIgYnJlYWNoZXMgPSBkYXRhLm9wdGlvbnMuZmlsdGVyKGZ1bmN0aW9uKHZhbCkge1xyXG4gICAgICByZXR1cm4gdmFsLnBhdGh3YXlJZCA9PT0gcGF0aHdheUlkICYmIHZhbC5wYXRod2F5U3RhZ2UgPT09IHBhdGh3YXlTdGFnZSAmJiB2YWwuc3RhbmRhcmQgPT09IHN0YW5kYXJkO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKGJyZWFjaGVzLmxlbmd0aCA+IDApICQoJ3NlbGVjdCcpLnZhbChicmVhY2hlc1swXS52YWx1ZSk7XHJcblxyXG4gICAgJCgnc2VsZWN0Jykuc2VsZWN0Mih7XHJcbiAgICAgIHRlbXBsYXRlUmVzdWx0OiBiYXNlLmZvcm1hdFN0YW5kYXJkLFxyXG4gICAgICBtaW5pbXVtUmVzdWx0c0ZvclNlYXJjaDogSW5maW5pdHlcclxuICAgIH0pO1xyXG4gICAgJCgnc3Bhbi5zZWxlY3QyLXNlbGVjdGlvbl9fcmVuZGVyZWQnKS5hdHRyKFwidGl0bGVcIiwgXCJcIik7XHJcbiAgICAkKCdzZWxlY3QnKS5vbignY2hhbmdlJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBsb2NhbERhdGEgPSAkKHRoaXMpLmZpbmQoJzpzZWxlY3RlZCcpLmRhdGEoKTtcclxuICAgICAgY2FsbGJhY2sobG9jYWxEYXRhLnBhdGh3YXlJZCwgbG9jYWxEYXRhLnBhdGh3YXlTdGFnZSwgbG9jYWxEYXRhLnN0YW5kYXJkLCBkYXRhLnBhdGllbnRJZCk7XHJcbiAgICB9KS5vbihcInNlbGVjdDI6b3BlblwiLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIGZvcm1hdFN0YW5kYXJkOiBmdW5jdGlvbihzdGFuZGFyZCkge1xyXG4gICAgaWYgKCFzdGFuZGFyZC5pZCkge1xyXG4gICAgICByZXR1cm4gc3RhbmRhcmQudGV4dDtcclxuICAgIH1cclxuICAgIHZhciBsb2NhbERhdGEgPSAkKHN0YW5kYXJkLmVsZW1lbnQpLmRhdGEoKTtcclxuICAgIC8vIE5vdCByZWxldmFudFxyXG4gICAgdmFyIHN0YW5kYXJkSHRtbCA9ICcnO1xyXG4gICAgLy9pZiBkaWFnbm9zaXMgb3Bwb3J0dW5pdHkgdGhlbiBub3QgcmVsZXZhbnQgZm9yIG90aGVyIHN0YWdlc1xyXG4gICAgLy9pZiBubyBtZW50aW9uIGFueXdoZXJlIHRoZW4gbm90IHJlbGV2YW50IGZvciB0aGF0IGRpc2Vhc2VcclxuICAgIHN3aXRjaCAoZGF0YS5nZXRQYXRpZW50U3RhdHVzKGRhdGEucGF0aWVudElkLCBsb2NhbERhdGEucGF0aHdheUlkLCBsb2NhbERhdGEucGF0aHdheVN0YWdlLCBsb2NhbERhdGEuc3RhbmRhcmQpKSB7XHJcbiAgICAgIGNhc2UgXCJva1wiOlxyXG4gICAgICAgIHN0YW5kYXJkSHRtbCA9ICc8c3BhbiBjbGFzcz1cInN0YW5kYXJkLWFjaGlldmVkXCIgZGF0YS10b2dnbGU9XCJ0b29sdGlwXCIgZGF0YS1wbGFjZW1lbnQ9XCJsZWZ0XCIgdGl0bGU9XCInICsgZGF0YVtsb2NhbERhdGEucGF0aHdheUlkXVtsb2NhbERhdGEucGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbbG9jYWxEYXRhLnN0YW5kYXJkXVtcImRyb3Bkb3duLXRvb2x0aXBcIl0gKyAnIC0gUVVBTElUWSBJTkRJQ0FUT1IgQUNISUVWRURcIj4nICsgc3RhbmRhcmQudGV4dCArICcgPGkgY2xhc3M9XCJmYSBmYS1zbWlsZS1vXCIgc3R5bGU9XCJjb2xvcjpncmVlblwiPjwvaT48L3NwYW4+JztcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBcIm1pc3NlZFwiOlxyXG4gICAgICAgIHN0YW5kYXJkSHRtbCA9ICc8c3BhbiBjbGFzcz1cInN0YW5kYXJkLW1pc3NlZFwiIGRhdGEtdG9nZ2xlPVwidG9vbHRpcFwiIGRhdGEtcGxhY2VtZW50PVwibGVmdFwiIHRpdGxlPVwiJyArIGRhdGFbbG9jYWxEYXRhLnBhdGh3YXlJZF1bbG9jYWxEYXRhLnBhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW2xvY2FsRGF0YS5zdGFuZGFyZF1bXCJkcm9wZG93bi10b29sdGlwXCJdICsgJyAtIElNUFJPVkVNRU5UIE9QUE9SVFVOSVRZIEVYSVNUUyBGT1IgVEhJUyBQQVRJRU5UXCI+JyArIHN0YW5kYXJkLnRleHQgKyAnIDxpIGNsYXNzPVwiZmEgZmEtZmxhZ1wiIHN0eWxlPVwiY29sb3I6cmVkXCI+PC9pPjwvc3Bhbj4nO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIFwibm90XCI6XHJcbiAgICAgICAgc3RhbmRhcmRIdG1sID0gJzxzcGFuIGNsYXNzPVwic3RhbmRhcmQtbm90LXJlbGV2YW50XCIgZGF0YS10b2dnbGU9XCJ0b29sdGlwXCIgZGF0YS1wbGFjZW1lbnQ9XCJsZWZ0XCIgdGl0bGU9XCInICsgZGF0YVtsb2NhbERhdGEucGF0aHdheUlkXVtsb2NhbERhdGEucGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbbG9jYWxEYXRhLnN0YW5kYXJkXVtcImRyb3Bkb3duLXRvb2x0aXBcIl0gKyAnIC0gU1RBTkRBUkQgTk9UIFJFTEVWQU5UIFRPIFRISVMgUEFUSUVOVFwiPicgKyBzdGFuZGFyZC50ZXh0ICsgJyA8aSBjbGFzcz1cImZhIGZhLW1laC1vXCIgc3R5bGU9XCJjb2xvcjpncmF5XCI+PC9pPjwvc3Bhbj4nO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG4gICAgdmFyICRzdGFuZGFyZCA9ICQoc3RhbmRhcmRIdG1sKTtcclxuICAgIHJldHVybiAkc3RhbmRhcmQ7XHJcbiAgfSxcclxuXHJcbiAgdXBkYXRlVGl0bGU6IGZ1bmN0aW9uKHRpdGxlLCB0b29sdGlwKSB7XHJcbiAgICB2YXIgdGl0bGVzID0gdGl0bGU7XHJcbiAgICBpZiAodHlwZW9mIHRpdGxlID09PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgIHRpdGxlcyA9IFt7XHJcbiAgICAgICAgdGl0bGU6IHRpdGxlLFxyXG4gICAgICAgIHRvb2x0aXA6IHRvb2x0aXBcclxuICAgICAgfV07XHJcbiAgICB9XHJcbiAgICB2YXIgY29udGVudCA9IHRpdGxlcy5tYXAoZnVuY3Rpb24odCwgaWR4KSB7XHJcbiAgICAgIHJldHVybiBpZHggPT09IHRpdGxlcy5sZW5ndGggLSAxID8gJzxzcGFuIHRpdGxlPVwiJyArIHQudG9vbHRpcCArICdcIj4nICsgdC50aXRsZSArICc8L3NwYW4+JyA6ICc8YSBocmVmPVwiJyArIHQudXJsICsgJ1wiIHRpdGxlPVwiJyArIHQudG9vbHRpcCArICdcIj4nICsgdC50aXRsZSArICc8L2E+JztcclxuICAgIH0pLmpvaW4oXCIgPiBcIik7XHJcblxyXG4gICAgJCgnLnBhZ2V0aXRsZScpLmh0bWwoY29udGVudCk7XHJcbiAgfSxcclxuXHJcbiAgaGlkZUFsbFBhbmVsczogZnVuY3Rpb24oKSB7XHJcbiAgICB0b3BMZWZ0UGFuZWwuaGlkZSgpO1xyXG4gICAgYm90dG9tTGVmdFBhbmVsLmhpZGUoKTtcclxuICAgIHRvcFJpZ2h0UGFuZWwuaGlkZSgpO1xyXG4gICAgYm90dG9tUmlnaHRQYW5lbC5oaWRlKCk7XHJcbiAgICBmYXJMZWZ0UGFuZWwuaGlkZSgpO1xyXG4gICAgZmFyUmlnaHRQYW5lbC5oaWRlKCk7XHJcbiAgICB0b3BQYW5lbC5oaWRlKCk7XHJcbiAgfSxcclxuXHJcbiAgaGlkZVBhbmVsczogZnVuY3Rpb24ocGFuZWwpIHtcclxuICAgIHBhbmVsLmNoaWxkcmVuKCkuaGlkZSgpO1xyXG4gIH0sXHJcblxyXG4gIHVwZGF0ZVRhYjogZnVuY3Rpb24odGFiLCB2YWx1ZSwgdXJsKSB7XHJcbiAgICB2YXIgdGFiRWxlbWVudCA9ICQoJyNtYWluVGFiIGFbZGF0YS1ocmVmPVwiIycgKyB0YWIgKyAnXCJdJyk7XHJcbiAgICB0YWJFbGVtZW50Lmh0bWwodGFiRWxlbWVudC50ZXh0KCkuc3BsaXQoXCI6XCIpWzBdICsgXCI6PGJyPjxzcGFuPjxzdHJvbmc+XCIgKyB2YWx1ZSArIFwiPC9zdHJvbmc+PC9zcGFuPlwiKTtcclxuICAgIHRhYkVsZW1lbnQuZGF0YShcImhyZWZcIiwgXCIjXCIgKyB0YWIgKyBcIi9cIiArIHVybCk7XHJcbiAgfSxcclxuXHJcbiAgYWRkRnVsbFBhZ2U6IGZ1bmN0aW9uKHBhbmVsKSB7XHJcbiAgICBwYW5lbC5mdWxscGFnZSh7IHZlcnRpY2FsQ2VudGVyZWQ6IHRydWUsIHBhZGRpbmdCb3R0b206ICc4MHB4Jywgc2Nyb2xsQmFyOiB0cnVlIH0pO1xyXG5cclxuICAgICQoJy5mcC1kb3duJykub2ZmKCdjbGljaycpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAkLmZuLmZ1bGxwYWdlLm1vdmVTZWN0aW9uRG93bigpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgJCgnLmZwLXVwJykub2ZmKCdjbGljaycpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAkLmZuLmZ1bGxwYWdlLm1vdmVTZWN0aW9uVXAoKTtcclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIHJlbW92ZUZ1bGxQYWdlOiBmdW5jdGlvbihwYW5lbCkge1xyXG4gICAgaWYgKHBhbmVsLmNoaWxkcmVuKCcuc2VjdGlvbicpLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xyXG4gICAgaWYgKCQuZm4uZnVsbHBhZ2UgJiYgJC5mbi5mdWxscGFnZS5kZXN0cm95KSAkLmZuLmZ1bGxwYWdlLmRlc3Ryb3koJ2FsbCcpOyAvL3RpZHkgdXAgYmVmb3JlIGRvaW5nIGl0IGFnYWluXHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gYmFzZTtcclxuIiwidmFyIEhpZ2hjaGFydHMgPSByZXF1aXJlKCdoaWdoY2hhcnRzL2hpZ2hzdG9jaycpLFxyXG4gIGRhdGEgPSByZXF1aXJlKCcuL2RhdGEuanMnKSxcclxuICBsb29rdXAgPSByZXF1aXJlKCcuL2xvb2t1cC5qcycpLFxyXG4gIGxvZyA9IHJlcXVpcmUoJy4vbG9nLmpzJyksXHJcbiAgTXVzdGFjaGUgPSByZXF1aXJlKCdtdXN0YWNoZScpO1xyXG5cclxuY29uc29sZS5sb2coXCJjaGFydC5qczogZGF0YS5sYXN0bG9hZGVyPSBcIiArIGRhdGEubGFzdGxvYWRlcik7XHJcbmRhdGEubGFzdGxvYWRlciA9IFwiY2hhcnQuanNcIjtcclxuXHJcbnZhciBjaHQgPSB7XHJcblxyXG4gIGRlc3Ryb3lDaGFydHM6IGZ1bmN0aW9uKGNoYXJ0cykge1xyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGFydHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgaWYgKGxvb2t1cC5jaGFydHNbY2hhcnRzW2ldXSkge1xyXG4gICAgICAgIGxvb2t1cC5jaGFydHNbY2hhcnRzW2ldXS5kZXN0cm95KCk7XHJcbiAgICAgICAgZGVsZXRlIGxvb2t1cC5jaGFydHNbY2hhcnRzW2ldXTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIGRyYXdUcmVuZENoYXJ0OiBmdW5jdGlvbihwYXRpZW50SWQsIHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCkge1xyXG4gICAgdmFyIGksIGo7XHJcbiAgICBjaHQuZGVzdHJveUNoYXJ0cyhbJ2NoYXJ0LWRlbW8tdHJlbmQnXSk7XHJcbiAgICBpZiAoIWRhdGEucGF0aWVudHNbcGF0aWVudElkXVtkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLmNoYXJ0WzBdXSkge1xyXG4gICAgICAkKCcjY2hhcnQtZGVtby10cmVuZCcpLmh0bWwoJ05vIGRhdGEgZm9yIHRoaXMgcGF0aWVudHMnKTtcclxuICAgICAgJCgnI2NoYXJ0LWRlbW8tdHJlbmQnKS5wYXJlbnQoKS5maW5kKCcudGFibGUtY2hhcnQtdG9nZ2xlJykuaGlkZSgpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIGNoYXJ0RGF0YSA9IGRhdGEucGF0aWVudHNbcGF0aWVudElkXVtkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLmNoYXJ0WzBdXTtcclxuICAgIHZhciB0YWJsZURhdGEgPSBbXTtcclxuICAgIGZvciAoaSA9IDE7IGkgPCBkYXRhLnBhdGllbnRzW3BhdGllbnRJZF1bZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS5jaGFydFswXV1bMF0ubGVuZ3RoOyBpKyspIHtcclxuICAgICAgdGFibGVEYXRhLnB1c2goe1xyXG4gICAgICAgIFwiaXRlbVwiOiBkYXRhLnBhdGllbnRzW3BhdGllbnRJZF1bZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS5jaGFydFswXV1bMV1bMF0sXHJcbiAgICAgICAgXCJ2YWx1ZVwiOiBkYXRhLnBhdGllbnRzW3BhdGllbnRJZF1bZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS5jaGFydFswXV1bMV1baV0sXHJcbiAgICAgICAgXCJkYXRlXCI6IGRhdGEucGF0aWVudHNbcGF0aWVudElkXVtkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLmNoYXJ0WzBdXVswXVtpXVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICAgIGZvciAoaSA9IDE7IGkgPCBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLmNoYXJ0Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIGNoYXJ0RGF0YS5wdXNoKGRhdGEucGF0aWVudHNbcGF0aWVudElkXVtkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLmNoYXJ0W2ldXVsxXSk7IC8vUlcgVE9ETyBhc3N1bXB0aW9uIGhlcmUgdGhhdCBhbGwgZGF0ZXMgYXJlIHRoZSBzYW1lXHJcbiAgICAgIGZvciAoaiA9IDE7IGogPCBkYXRhLnBhdGllbnRzW3BhdGllbnRJZF1bZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS5jaGFydFswXV1bMF0ubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICB0YWJsZURhdGEucHVzaCh7XHJcbiAgICAgICAgICBcIml0ZW1cIjogZGF0YS5wYXRpZW50c1twYXRpZW50SWRdW2RhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0uY2hhcnRbaV1dWzFdWzBdLFxyXG4gICAgICAgICAgXCJ2YWx1ZVwiOiBkYXRhLnBhdGllbnRzW3BhdGllbnRJZF1bZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS5jaGFydFtpXV1bMV1bal0sXHJcbiAgICAgICAgICBcImRhdGVcIjogZGF0YS5wYXRpZW50c1twYXRpZW50SWRdW2RhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0uY2hhcnRbMF1dWzBdW2pdXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHZhciBjaGFydE9wdGlvbnMgPSB7XHJcbiAgICAgIGJpbmR0bzogJyNjaGFydC1kZW1vLXRyZW5kJyxcclxuICAgICAgZGF0YToge1xyXG4gICAgICAgIHhzOiB7fSxcclxuICAgICAgICBjbGFzc2VzOiB7fSxcclxuICAgICAgICBjb2x1bW5zOiBjaGFydERhdGEuc2xpY2UoKVxyXG4gICAgICB9LFxyXG4gICAgICB6b29tOiB7XHJcbiAgICAgICAgZW5hYmxlZDogdHJ1ZVxyXG4gICAgICB9LFxyXG4gICAgICBsaW5lOiB7XHJcbiAgICAgICAgY29ubmVjdE51bGw6IGZhbHNlXHJcbiAgICAgIH0sXHJcbiAgICAgIGF4aXM6IHtcclxuICAgICAgICB4OiB7XHJcbiAgICAgICAgICB0eXBlOiAndGltZXNlcmllcycsXHJcbiAgICAgICAgICB0aWNrOiB7XHJcbiAgICAgICAgICAgIGZpdDogZmFsc2UsXHJcbiAgICAgICAgICAgIGZvcm1hdDogJyVkLSVtLSVZJyxcclxuICAgICAgICAgICAgY291bnQ6IDVcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBtYXg6IG5ldyBEYXRlKClcclxuICAgICAgICB9LFxyXG4gICAgICAgIHk6IHtcclxuICAgICAgICAgIGxhYmVsOiB7XHJcbiAgICAgICAgICAgIHRleHQ6IGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0uY2hhcnRVbml0cyxcclxuICAgICAgICAgICAgcG9zaXRpb246ICdvdXRlci1taWRkbGUnXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBtYXhWYWx1ZSA9IDA7XHJcbiAgICB2YXIgc3RhbmRhcmRJdGVtcyA9IFtdO1xyXG5cclxuICAgIGZvciAoaSA9IDE7IGkgPCBjaGFydE9wdGlvbnMuZGF0YS5jb2x1bW5zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIGNoYXJ0T3B0aW9ucy5kYXRhLnhzW2NoYXJ0T3B0aW9ucy5kYXRhLmNvbHVtbnNbaV1bMF1dID0gXCJ4XCI7XHJcbiAgICAgIHN0YW5kYXJkSXRlbXMucHVzaChjaGFydE9wdGlvbnMuZGF0YS5jb2x1bW5zW2ldWzBdKTtcclxuXHJcbiAgICAgIGZvciAoaiA9IDE7IGogPCBjaGFydE9wdGlvbnMuZGF0YS5jb2x1bW5zW2ldLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgaWYgKHBhcnNlRmxvYXQoY2hhcnRPcHRpb25zLmRhdGEuY29sdW1uc1tpXVtqXSkgPiBtYXhWYWx1ZSkgbWF4VmFsdWUgPSBwYXJzZUZsb2F0KGNoYXJ0T3B0aW9ucy5kYXRhLmNvbHVtbnNbaV1bal0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY2hhcnRPcHRpb25zLnRvb2x0aXAgPSB7XHJcbiAgICAgIGZvcm1hdDoge1xyXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbih2YWx1ZSwgcmF0aW8sIGlkKSB7XHJcbiAgICAgICAgICB2YXIgdGV4dCA9IHN0YW5kYXJkSXRlbXMuaW5kZXhPZihpZCkgPiAtMSA/IHZhbHVlIDogXCJcIjtcclxuICAgICAgICAgIHJldHVybiB0ZXh0O1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgbGluZXMgPSBudWxsO1xyXG4gICAgdmFyIGF4aXNudW0gPSAxO1xyXG4gICAgaWYgKGRhdGEucGF0aWVudHNbcGF0aWVudElkXS5jb250YWN0cykge1xyXG4gICAgICBmb3IgKGkgPSAwOyBpIDwgZGF0YS5wYXRpZW50c1twYXRpZW50SWRdLmNvbnRhY3RzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgY2hhcnRPcHRpb25zLmRhdGEuY2xhc3Nlc1tkYXRhLnBhdGllbnRzW3BhdGllbnRJZF0uY29udGFjdHNbaV0udGV4dF0gPSAnbGFyZ2VyJztcclxuICAgICAgICBpZiAoIWNoYXJ0T3B0aW9ucy5kYXRhLnhzW2RhdGEucGF0aWVudHNbcGF0aWVudElkXS5jb250YWN0c1tpXS50ZXh0XSkge1xyXG4gICAgICAgICAgY2hhcnRPcHRpb25zLmRhdGEueHNbZGF0YS5wYXRpZW50c1twYXRpZW50SWRdLmNvbnRhY3RzW2ldLnRleHRdID0gXCJ4XCIgKyBheGlzbnVtO1xyXG4gICAgICAgICAgY2hhcnRPcHRpb25zLmRhdGEuY29sdW1ucy5wdXNoKFtcInhcIiArIGF4aXNudW0sIGRhdGEucGF0aWVudHNbcGF0aWVudElkXS5jb250YWN0c1tpXS52YWx1ZV0pO1xyXG4gICAgICAgICAgY2hhcnRPcHRpb25zLmRhdGEuY29sdW1ucy5wdXNoKFtkYXRhLnBhdGllbnRzW3BhdGllbnRJZF0uY29udGFjdHNbaV0udGV4dCwgKG1heFZhbHVlICogMS4xKS50b1N0cmluZygpXSk7XHJcbiAgICAgICAgICBheGlzbnVtKys7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHZhciBheGlzID0gY2hhcnRPcHRpb25zLmRhdGEueHNbZGF0YS5wYXRpZW50c1twYXRpZW50SWRdLmNvbnRhY3RzW2ldLnRleHRdO1xyXG4gICAgICAgICAgZm9yIChqID0gMTsgaiA8IGNoYXJ0T3B0aW9ucy5kYXRhLmNvbHVtbnMubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgICAgaWYgKGNoYXJ0T3B0aW9ucy5kYXRhLmNvbHVtbnNbal1bMF0gPT09IGF4aXMpIHtcclxuICAgICAgICAgICAgICBjaGFydE9wdGlvbnMuZGF0YS5jb2x1bW5zW2pdLnB1c2goZGF0YS5wYXRpZW50c1twYXRpZW50SWRdLmNvbnRhY3RzW2ldLnZhbHVlKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChjaGFydE9wdGlvbnMuZGF0YS5jb2x1bW5zW2pdWzBdID09PSBkYXRhLnBhdGllbnRzW3BhdGllbnRJZF0uY29udGFjdHNbaV0udGV4dCkge1xyXG4gICAgICAgICAgICAgIGNoYXJ0T3B0aW9ucy5kYXRhLmNvbHVtbnNbal0ucHVzaCgobWF4VmFsdWUgKiAxLjEpLnRvU3RyaW5nKCkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRhYmxlRGF0YS5wdXNoKHtcclxuICAgICAgICAgIFwiaXRlbVwiOiBcIkV2ZW50XCIsXHJcbiAgICAgICAgICBcInZhbHVlXCI6IGRhdGEucGF0aWVudHNbcGF0aWVudElkXS5jb250YWN0c1tpXS50ZXh0LFxyXG4gICAgICAgICAgXCJkYXRlXCI6IGRhdGEucGF0aWVudHNbcGF0aWVudElkXS5jb250YWN0c1tpXS52YWx1ZVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIHBhdGllbnRFdmVudHMgPSBsb2cuZ2V0RXZlbnRzKCkuZmlsdGVyKGZ1bmN0aW9uKHZhbCkge1xyXG4gICAgICByZXR1cm4gdmFsLmlkID09PSBwYXRpZW50SWQ7XHJcbiAgICB9KTtcclxuICAgIGlmIChwYXRpZW50RXZlbnRzLmxlbmd0aCA+IDApIHtcclxuXHJcbiAgICAgIGZvciAoaSA9IDA7IGkgPCBwYXRpZW50RXZlbnRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgY2hhcnRPcHRpb25zLmRhdGEuY2xhc3Nlc1twYXRpZW50RXZlbnRzW2ldLm5hbWVdID0gJ2xhcmdlcic7XHJcbiAgICAgICAgaWYgKCFjaGFydE9wdGlvbnMuZGF0YS54c1twYXRpZW50RXZlbnRzW2ldLm5hbWVdKSB7XHJcbiAgICAgICAgICBjaGFydE9wdGlvbnMuZGF0YS54c1twYXRpZW50RXZlbnRzW2ldLm5hbWVdID0gXCJ4XCIgKyBheGlzbnVtO1xyXG4gICAgICAgICAgY2hhcnRPcHRpb25zLmRhdGEuY29sdW1ucy5wdXNoKFtcInhcIiArIGF4aXNudW0sIHBhdGllbnRFdmVudHNbaV0uZGF0ZS5zdWJzdHIoMCwgMTApXSk7XHJcbiAgICAgICAgICBjaGFydE9wdGlvbnMuZGF0YS5jb2x1bW5zLnB1c2goW3BhdGllbnRFdmVudHNbaV0ubmFtZSwgKG1heFZhbHVlICogMS4xKS50b1N0cmluZygpXSk7XHJcbiAgICAgICAgICBheGlzbnVtKys7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHZhciBheGlzMiA9IGNoYXJ0T3B0aW9ucy5kYXRhLnhzW3BhdGllbnRFdmVudHNbaV0ubmFtZV07XHJcbiAgICAgICAgICBmb3IgKGogPSAxOyBqIDwgY2hhcnRPcHRpb25zLmRhdGEuY29sdW1ucy5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgICBpZiAoY2hhcnRPcHRpb25zLmRhdGEuY29sdW1uc1tqXVswXSA9PT0gYXhpczIpIHtcclxuICAgICAgICAgICAgICBjaGFydE9wdGlvbnMuZGF0YS5jb2x1bW5zW2pdLnB1c2gocGF0aWVudEV2ZW50c1tpXS5kYXRlLnN1YnN0cigwLCAxMCkpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGNoYXJ0T3B0aW9ucy5kYXRhLmNvbHVtbnNbal1bMF0gPT09IHBhdGllbnRFdmVudHNbaV0ubmFtZSkge1xyXG4gICAgICAgICAgICAgIGNoYXJ0T3B0aW9ucy5kYXRhLmNvbHVtbnNbal0ucHVzaCgobWF4VmFsdWUgKiAxLjEpLnRvU3RyaW5nKCkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRhYmxlRGF0YS5wdXNoKHtcclxuICAgICAgICAgIFwiaXRlbVwiOiBcIkV2ZW50XCIsXHJcbiAgICAgICAgICBcInZhbHVlXCI6IHBhdGllbnRFdmVudHNbaV0ubmFtZSxcclxuICAgICAgICAgIFwiZGF0ZVwiOiBwYXRpZW50RXZlbnRzW2ldLmRhdGUuc3Vic3RyKDAsIDEwKVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdGFibGVEYXRhLnNvcnQoZnVuY3Rpb24oYSwgYikge1xyXG4gICAgICBpZiAoYS5kYXRlID09PSBiLmRhdGUpIHJldHVybiAwO1xyXG4gICAgICBlbHNlIHJldHVybiBhLmRhdGUgPCBiLmRhdGUgPyAxIDogLTE7XHJcbiAgICB9KTtcclxuICAgIC8vZHJhdyBUYWJsZVxyXG4gICAgJCgnI3RhYmxlLWRlbW8tdHJlbmQnKS5odG1sKE11c3RhY2hlLnJlbmRlcigkKCcjdmFsdWUtdHJlbmQtcGFuZWwtdGFibGUnKS5odG1sKCksIHtcclxuICAgICAgXCJpdGVtc1wiOiB0YWJsZURhdGFcclxuICAgIH0sIHtcclxuICAgICAgXCJpdGVtLXJvd1wiOiAkKCcjdmFsdWUtdHJlbmQtcGFuZWwtdGFibGUtcm93JykuaHRtbCgpXHJcbiAgICB9KSk7XHJcblxyXG4gICAgLy9kcmF3IGNoYXJ0cyBpbiBzZXBhcmF0ZSB0aHJlYWQgYW5kIHdpdGggZGVsYXkgdG8gc3RvcCBzbHVnZ2lzaCBhcHBlYXJhbmNlXHJcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICBsb29rdXAuY2hhcnRzWydjaGFydC1kZW1vLXRyZW5kJ10gPSBjMy5nZW5lcmF0ZShjaGFydE9wdGlvbnMpO1xyXG4gICAgfSwgMSk7XHJcbiAgfSxcclxuXHJcbiAgc2VsZWN0UGllU2xpY2U6IGZ1bmN0aW9uKGNoYXJ0LCBkKSB7XHJcbiAgICBsb29rdXAuY2hhcnRDbGlja2VkID0gdHJ1ZTtcclxuICAgICQoJyMnICsgY2hhcnQgKyAnIHBhdGguYzMtYmFyJykuYXR0cignY2xhc3MnLCBmdW5jdGlvbihpbmRleCwgY2xhc3NOYW1lcykge1xyXG4gICAgICByZXR1cm4gY2xhc3NOYW1lcyArICcgX3Vuc2VsZWN0ZWRfJztcclxuICAgIH0pO1xyXG4gICAgbG9va3VwLmNoYXJ0c1tjaGFydF0uc2VsZWN0KFtkLmlkXSwgW2QuaW5kZXhdLCB0cnVlKTtcclxuXHJcbiAgICBmYXJSaWdodFBhbmVsLmZhZGVPdXQoMjAwLCBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIHRlbXBsYXRlID0gJCgnI3BhdGllbnQtcGFuZWwtcGxhY2Vob2xkZXInKS5odG1sKCk7XHJcbiAgICAgIGZhclJpZ2h0UGFuZWwuaHRtbChNdXN0YWNoZS5yZW5kZXIodGVtcGxhdGUpKS5zaG93KCk7XHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICBkcmF3T3ZlcnZpZXdDaGFydDogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIGVuYWJsZUhvdmVyKSB7XHJcbiAgICBjaHQuZGVzdHJveUNoYXJ0cyhbcGF0aHdheVN0YWdlICsgJy1jaGFydCddKTtcclxuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgIGxvb2t1cC5jaGFydHNbcGF0aHdheVN0YWdlICsgJy1jaGFydCddID0gYzMuZ2VuZXJhdGUoe1xyXG4gICAgICAgIGJpbmR0bzogJyMnICsgcGF0aHdheVN0YWdlICsgJy1jaGFydCcsXHJcbiAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgeDogJ3gnLFxyXG4gICAgICAgICAgY29sdW1uczogZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0udHJlbmRcclxuICAgICAgICB9LFxyXG4gICAgICAgIHpvb206IHtcclxuICAgICAgICAgIGVuYWJsZWQ6IHRydWVcclxuICAgICAgICB9LFxyXG4gICAgICAgIHRvb2x0aXA6IHtcclxuICAgICAgICAgIGZvcm1hdDoge1xyXG4gICAgICAgICAgICB0aXRsZTogZnVuY3Rpb24oeCkge1xyXG4gICAgICAgICAgICAgIHJldHVybiB4LnRvRGF0ZVN0cmluZygpICsgKGVuYWJsZUhvdmVyID8gJzxicj5DbGljayBmb3IgbW9yZSBkZXRhaWwnIDogJycpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgICAgICAgICByZXR1cm4gZW5hYmxlSG92ZXIgPyB2YWx1ZSArICclJyA6IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgYXhpczoge1xyXG4gICAgICAgICAgeDoge1xyXG4gICAgICAgICAgICB0eXBlOiAndGltZXNlcmllcycsXHJcbiAgICAgICAgICAgIHRpY2s6IHtcclxuICAgICAgICAgICAgICBmb3JtYXQ6ICclZC0lbS0lWScsXHJcbiAgICAgICAgICAgICAgY291bnQ6IDcsXHJcbiAgICAgICAgICAgICAgY3VsbGluZzoge1xyXG4gICAgICAgICAgICAgICAgbWF4OiA0XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBsYWJlbDoge1xyXG4gICAgICAgICAgICAgIHRleHQ6ICdEYXRlJyxcclxuICAgICAgICAgICAgICBwb3NpdGlvbjogJ291dGVyLWNlbnRlcidcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHk6IHtcclxuICAgICAgICAgICAgbWluOiAwLFxyXG4gICAgICAgICAgICBsYWJlbDoge1xyXG4gICAgICAgICAgICAgIHRleHQ6ICdQcm9wb3J0aW9uICglKScsXHJcbiAgICAgICAgICAgICAgcG9zaXRpb246ICdvdXRlci1taWRkbGUnXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIHBvaW50OiB7XHJcbiAgICAgICAgICBzaG93OiBmYWxzZVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2l6ZToge1xyXG4gICAgICAgICAgaGVpZ2h0OiBudWxsXHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0sIDEpO1xyXG4gIH0sXHJcblxyXG4gIGRyYXdCZW5jaG1hcmtDaGFydDogZnVuY3Rpb24oZWxlbWVudCwgZGF0YSkge1xyXG4gICAgY2h0LmRlc3Ryb3lDaGFydHMoW2VsZW1lbnQgKyAnLWNoYXJ0J10pO1xyXG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgbG9va3VwLmNoYXJ0c1tlbGVtZW50ICsgJy1jaGFydCddID0gYzMuZ2VuZXJhdGUoe1xyXG4gICAgICAgIGJpbmR0bzogJyMnICsgZWxlbWVudCxcclxuICAgICAgICBzaXplOiB7XHJcbiAgICAgICAgICBoZWlnaHQ6IDIwMFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZGF0YTogZGF0YSxcclxuICAgICAgICBheGlzOiB7XHJcbiAgICAgICAgICB4OiB7XHJcbiAgICAgICAgICAgIHR5cGU6ICdjYXRlZ29yeScsXHJcbiAgICAgICAgICAgIHRpY2s6IHtcclxuICAgICAgICAgICAgICByb3RhdGU6IDYwLFxyXG4gICAgICAgICAgICAgIG11bHRpbGluZTogZmFsc2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHk6IHtcclxuICAgICAgICAgICAgbGFiZWw6IHtcclxuICAgICAgICAgICAgICB0ZXh0OiAnJSBvZiBwYXRpZW50cyBtZWV0aW5nIHRoZSB0YXJnZXQnLFxyXG4gICAgICAgICAgICAgIHBvc2l0aW9uOiAnb3V0ZXItbWlkZGxlJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBncmlkOiB7XHJcbiAgICAgICAgICB5OiB7XHJcbiAgICAgICAgICAgIHNob3c6IHRydWVcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSwgMSk7XHJcbiAgfSxcclxuXHJcbiAgZHJhd1BlcmZvcm1hbmNlVHJlbmRDaGFydDogZnVuY3Rpb24oZWxlbWVudCwgZGF0YSkge1xyXG4gICAgY2h0LmRlc3Ryb3lDaGFydHMoW2VsZW1lbnQgKyAnLWNoYXJ0J10pO1xyXG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgbG9va3VwLmNoYXJ0c1tlbGVtZW50ICsgJy1jaGFydCddID0gYzMuZ2VuZXJhdGUoe1xyXG4gICAgICAgIGJpbmR0bzogJyMnICsgZWxlbWVudCxcclxuICAgICAgICBzaXplOiB7XHJcbiAgICAgICAgICBoZWlnaHQ6IDIwMFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZGF0YTogZGF0YSxcclxuICAgICAgICBheGlzOiB7XHJcbiAgICAgICAgICB4OiB7XHJcbiAgICAgICAgICAgIHR5cGU6ICd0aW1lc2VyaWVzJyxcclxuICAgICAgICAgICAgdGljazoge1xyXG4gICAgICAgICAgICAgIGZvcm1hdDogJyVZLSVtLSVkJyxcclxuICAgICAgICAgICAgICByb3RhdGU6IDYwLFxyXG4gICAgICAgICAgICAgIG11bHRpbGluZTogZmFsc2VcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgaGVpZ2h0OiA2MFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHk6IHtcclxuICAgICAgICAgICAgbGFiZWw6IHtcclxuICAgICAgICAgICAgICB0ZXh0OiBcIlBlcmZvcm1hbmNlXCIsXHJcbiAgICAgICAgICAgICAgcG9zaXRpb246ICdvdXRlci1taWRkbGUnXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIGdyaWQ6IHtcclxuICAgICAgICAgIHg6IHtcclxuICAgICAgICAgICAgc2hvdzogdHJ1ZVxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHk6IHtcclxuICAgICAgICAgICAgc2hvdzogdHJ1ZVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9LCAxKTtcclxuICB9LFxyXG5cclxuICBkcmF3QmVuY2htYXJrQ2hhcnRIQzogZnVuY3Rpb24oZWxlbWVudCwgZGF0YSkge1xyXG5cclxuICAgIGRhdGEgPSBbXHJcbiAgICAgIHsgeDogNDkuOSwgcDogJ1AxJywgbG9jYWw6IHRydWUgfSxcclxuICAgICAgeyB4OiA3MS41LCBwOiAnUDInLCBsb2NhbDogdHJ1ZSB9LFxyXG4gICAgICB7IHg6IDE2LjQsIHA6ICdQMycsIGxvY2FsOiB0cnVlIH0sXHJcbiAgICAgIHsgeDogMjkuMiwgcDogJ1A0JywgbG9jYWw6IHRydWUgfSxcclxuICAgICAgeyB4OiA0NC4wLCBwOiAnUDUnLCBsb2NhbDogdHJ1ZSB9LFxyXG4gICAgICB7IHg6IDc2LjAsIHA6ICdQNicsIGxvY2FsOiB0cnVlIH0sXHJcbiAgICAgIHsgeDogMzUuNiwgcDogJ1lPVScsIGxvY2FsOiB0cnVlIH0sXHJcbiAgICAgIHsgeDogNDguNSwgcDogJ1A3JywgbG9jYWw6IHRydWUgfSxcclxuICAgICAgeyB4OiAyNi40LCBwOiAnUDgnLCBsb2NhbDogdHJ1ZSB9LFxyXG4gICAgICB7IHg6IDk0LjEsIHA6ICdQOScsIGxvY2FsOiB0cnVlIH0sXHJcbiAgICAgIHsgeDogOTUuNiwgcDogJ1AxMCcgfSxcclxuICAgICAgeyB4OiA1NC4wLCBwOiAnUDExJyB9LFxyXG4gICAgICB7IHg6IDM5LjksIHA6ICdQMTInIH0sXHJcbiAgICAgIHsgeDogNjEuNSwgcDogJ1AxMycgfSxcclxuICAgICAgeyB4OiA2LjQsIHA6ICdQMTQnIH0sXHJcbiAgICAgIHsgeDogMTkuMiwgcDogJ1AxNScgfSxcclxuICAgICAgeyB4OiAzNC4wLCBwOiAnUDE2JyB9LFxyXG4gICAgICB7IHg6IDY2LjAsIHA6ICdQMTcnIH0sXHJcbiAgICAgIHsgeDogMjUuNiwgcDogJ1AxOCcgfSxcclxuICAgICAgeyB4OiAzOC41LCBwOiAnUDE5JyB9LFxyXG4gICAgICB7IHg6IDM2LjQsIHA6ICdQMjAnIH0sXHJcbiAgICAgIHsgeDogODQuMSwgcDogJ1AyMScgfSxcclxuICAgICAgeyB4OiA4NS42LCBwOiAnUDIyJyB9LFxyXG4gICAgICB7IHg6IDY0LjAsIHA6ICdQMjMnIH1cclxuICAgIF07XHJcbiAgICBkYXRhLnNvcnQoZnVuY3Rpb24oYSwgYikge1xyXG4gICAgICByZXR1cm4gYS54IC0gYi54O1xyXG4gICAgfSk7XHJcblxyXG4gICAgdmFyIGxvY2FsID0gdHJ1ZTtcclxuICAgIHZhciBiQ2hhcnQgPSAkKCcjJyArIGVsZW1lbnQpLmhpZ2hjaGFydHMoe1xyXG4gICAgICBjaGFydDoge1xyXG4gICAgICAgIHR5cGU6ICdjb2x1bW4nLFxyXG4gICAgICAgIGV2ZW50czoge1xyXG4gICAgICAgICAgbG9hZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciB0aGlzQ2hhcnQgPSB0aGlzO1xyXG4gICAgICAgICAgICB0aGlzQ2hhcnQucmVuZGVyZXIuYnV0dG9uKCdUb2dnbGUgbmVpZ2hib3VyaG9vZCAvIENDRycsIHRoaXNDaGFydC5wbG90V2lkdGggLSAxMDAsIDAsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgIGxvY2FsID0gIWxvY2FsO1xyXG4gICAgICAgICAgICAgIHRoaXNDaGFydC54QXhpc1swXS5jYXRlZ29yaWVzID0gZGF0YS5maWx0ZXIoZnVuY3Rpb24odikge1xyXG4gICAgICAgICAgICAgICAgaWYgKGxvY2FsKSByZXR1cm4gdi5sb2NhbDtcclxuICAgICAgICAgICAgICAgIGVsc2UgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgfSkubWFwKGZ1bmN0aW9uKHYpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB2LnA7XHJcbiAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgdGhpc0NoYXJ0LnNlcmllc1swXS5zZXREYXRhKGRhdGEuZmlsdGVyKGZ1bmN0aW9uKHYpIHtcclxuICAgICAgICAgICAgICAgIGlmIChsb2NhbCkgcmV0dXJuIHYubG9jYWw7XHJcbiAgICAgICAgICAgICAgICBlbHNlIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgIH0pLm1hcChmdW5jdGlvbih2KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodi5wID09PSBcIllPVVwiKSByZXR1cm4geyB5OiB2LngsIGNvbG9yOiBcInJlZFwiIH07XHJcbiAgICAgICAgICAgICAgICBlbHNlIHJldHVybiB2Lng7XHJcbiAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICB9KS5hZGQoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0sXHJcbiAgICAgIHRpdGxlOiB7IHRleHQ6ICdCZW5jaG1hcmsnIH0sXHJcbiAgICAgIHhBeGlzOiB7XHJcbiAgICAgICAgY2F0ZWdvcmllczogZGF0YS5maWx0ZXIoZnVuY3Rpb24odikge1xyXG4gICAgICAgICAgcmV0dXJuIHYubG9jYWwgPT09IGxvY2FsO1xyXG4gICAgICAgIH0pLm1hcChmdW5jdGlvbih2KSB7XHJcbiAgICAgICAgICByZXR1cm4gdi5wO1xyXG4gICAgICAgIH0pLFxyXG4gICAgICAgIGNyb3NzaGFpcjogdHJ1ZVxyXG4gICAgICB9LFxyXG4gICAgICB5QXhpczoge1xyXG4gICAgICAgIG1pbjogMCxcclxuICAgICAgICBtYXg6IDEwMCxcclxuICAgICAgICB0aXRsZTogeyB0ZXh0OiAnJSBwYXRpZW50cyBtZWV0aW5nIHRhcmdldCcgfVxyXG4gICAgICB9LFxyXG4gICAgICB0b29sdGlwOiB7XHJcbiAgICAgICAgaGVhZGVyRm9ybWF0OiAnPHNwYW4gc3R5bGU9XCJmb250LXNpemU6MTBweFwiPlByYWN0aWNlOiA8Yj57cG9pbnQua2V5fTwvYj48L3NwYW4+PHRhYmxlPicsXHJcbiAgICAgICAgcG9pbnRGb3JtYXQ6ICc8dHI+PHRkIHN0eWxlPVwiY29sb3I6e3Nlcmllcy5jb2xvcn07cGFkZGluZzowXCI+e3Nlcmllcy5uYW1lfTogPC90ZD4nICtcclxuICAgICAgICAgICc8dGQgc3R5bGU9XCJwYWRkaW5nOjBcIj48Yj57cG9pbnQueTouMWZ9JTwvYj48L3RkPjwvdHI+JyxcclxuICAgICAgICBmb290ZXJGb3JtYXQ6ICc8L3RhYmxlPicsXHJcbiAgICAgICAgc2hhcmVkOiB0cnVlLFxyXG4gICAgICAgIHVzZUhUTUw6IHRydWVcclxuICAgICAgfSxcclxuICAgICAgcGxvdE9wdGlvbnM6IHtcclxuICAgICAgICBjb2x1bW46IHtcclxuICAgICAgICAgIHBvaW50UGFkZGluZzogMC4yLFxyXG4gICAgICAgICAgYm9yZGVyV2lkdGg6IDBcclxuICAgICAgICB9XHJcbiAgICAgIH0sXHJcbiAgICAgIGxlZ2VuZDoge1xyXG4gICAgICAgIGVuYWJsZWQ6IGZhbHNlXHJcbiAgICAgIH0sXHJcbiAgICAgIHNlcmllczogW3tcclxuICAgICAgICBuYW1lOiAnUGVyZm9ybWFuY2UnLFxyXG4gICAgICAgIGRhdGE6IGRhdGEuZmlsdGVyKGZ1bmN0aW9uKHYpIHtcclxuICAgICAgICAgIHJldHVybiB2LmxvY2FsID09PSBsb2NhbDtcclxuICAgICAgICB9KS5tYXAoZnVuY3Rpb24odikge1xyXG4gICAgICAgICAgaWYgKHYucCA9PT0gXCJZT1VcIikgcmV0dXJuIHsgeTogdi54LCBjb2xvcjogXCJyZWRcIiB9O1xyXG4gICAgICAgICAgZWxzZSByZXR1cm4gdi54O1xyXG4gICAgICAgIH0pXHJcbiAgICAgIH1dXHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICBkcmF3UGVyZm9ybWFuY2VUcmVuZENoYXJ0SEM6IGZ1bmN0aW9uKGVsZW1lbnQsIGRhdGEpIHtcclxuXHJcbiAgICAvLy8gZGF0YSBpc1xyXG4gICAgLy8ge1xyXG4gICAgLy8gIFwidmFsdWVzXCI6XHJcbiAgICAvLyAgICBbXCJ4XCIsIFwiMjAxNS0wOC0yNFwiLCBcIjIwMTUtMDgtMjNcIiwuLi5cclxuICAgIC8vICAgIFtcIm51bWVyYXRvclwiLCAzNSwgMzcsIDMzLCAzMiwgMzEsLi4uXHJcbiAgICAvLyAgICBbXCJkZW5vbWluYXRvclwiLCAxMzUsIDEzMywgMTMzLCAxMywuLi5cclxuICAgIC8vICAgIFtcInRhcmdldFwiLCAwLjMsIDAuMywgMC4uLlxyXG4gICAgLy8gfVxyXG5cclxuICAgIHZhciB0YXJnZXQgPSAwLjc1LFxyXG4gICAgICBtYXhWYWx1ZSA9IHRhcmdldCxcclxuICAgICAgbWF4WHZhbHVlID0gMDtcclxuXHJcbiAgICB2YXIgc2VyaWVzID0gW1xyXG4gICAgICB7IHR5cGU6ICdsaW5lJywgbmFtZTogJ1RyZW5kJywgZGF0YTogW10gfSxcclxuICAgICAgeyB0eXBlOiAnbGluZScsIG5hbWU6ICdQcmVkaWN0aW9uJywgZGF0YTogW10sIGRhc2hTdHlsZTogJ2RvdCcgfVxyXG4gICAgXTtcclxuXHJcbiAgICB2YXIgdG9kYXkgPSBuZXcgRGF0ZSgpO1xyXG4gICAgdmFyIGxhc3RBcHJpbCA9IG5ldyBEYXRlKCk7XHJcbiAgICB2YXIgYXByaWxCZWZvcmVUaGF0ID0gbmV3IERhdGUoKTtcclxuICAgIHZhciBuZXh0QXByaWwgPSBuZXcgRGF0ZSgpO1xyXG4gICAgaWYgKHRvZGF5LmdldE1vbnRoKCkgPCAzKSB7XHJcbiAgICAgIC8vYWZ0ZXIgYXByaWxcclxuICAgICAgbGFzdEFwcmlsLnNldFllYXIodG9kYXkuZ2V0RnVsbFllYXIoKSAtIDEpO1xyXG4gICAgICBhcHJpbEJlZm9yZVRoYXQuc2V0WWVhcih0b2RheS5nZXRGdWxsWWVhcigpIC0gMSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBuZXh0QXByaWwuc2V0WWVhcih0b2RheS5nZXRGdWxsWWVhcigpICsgMSk7XHJcbiAgICB9XHJcbiAgICBhcHJpbEJlZm9yZVRoYXQuc2V0WWVhcihhcHJpbEJlZm9yZVRoYXQuZ2V0RnVsbFllYXIoKSAtIDEpO1xyXG4gICAgbGFzdEFwcmlsLnNldE1vbnRoKDMpO1xyXG4gICAgYXByaWxCZWZvcmVUaGF0LnNldE1vbnRoKDMpO1xyXG4gICAgbmV4dEFwcmlsLnNldE1vbnRoKDMpO1xyXG4gICAgbGFzdEFwcmlsLnNldERhdGUoMSk7XHJcbiAgICBhcHJpbEJlZm9yZVRoYXQuc2V0RGF0ZSgxKTtcclxuICAgIG5leHRBcHJpbC5zZXREYXRlKDEpO1xyXG5cclxuICAgIHZhciBuID0gMCxcclxuICAgICAgc3VtWCA9IDAsXHJcbiAgICAgIHN1bVkgPSAwLFxyXG4gICAgICBzdW1YWSA9IDAsXHJcbiAgICAgIHN1bVhYID0gMCxcclxuICAgICAgc3VtWVkgPSAwLFxyXG4gICAgICBpbnRlcmNlcHQsIGdyYWRpZW50LCBjb21wRGF0ZTtcclxuXHJcbiAgICBpZiAoZGF0YS52YWx1ZXNbMF0uZmlsdGVyKGZ1bmN0aW9uKHYpIHtcclxuICAgICAgICByZXR1cm4gbmV3IERhdGUodikuZ2V0VGltZSgpID4gbGFzdEFwcmlsLmdldFRpbWUoKTtcclxuICAgICAgfSkubGVuZ3RoID4gMikgY29tcERhdGUgPSBuZXcgRGF0ZShsYXN0QXByaWwuZ2V0VGltZSgpKTtcclxuICAgIGVsc2UgY29tcERhdGUgPSBuZXcgRGF0ZShhcHJpbEJlZm9yZVRoYXQuZ2V0VGltZSgpKTtcclxuXHJcbiAgICBkYXRhLnZhbHVlc1swXS5mb3JFYWNoKGZ1bmN0aW9uKHYsIGkpIHtcclxuICAgICAgaWYgKGkgPT09IDApIHJldHVybjtcclxuICAgICAgdmFyIHRpbWUgPSBuZXcgRGF0ZSh2KS5nZXRUaW1lKCk7XHJcbiAgICAgIHZhciB5ID0gK2RhdGEudmFsdWVzWzFdW2ldIC8gK2RhdGEudmFsdWVzWzJdW2ldO1xyXG4gICAgICBpZiAodGltZSA+PSBjb21wRGF0ZS5nZXRUaW1lKCkpIHtcclxuICAgICAgICBuKys7XHJcbiAgICAgICAgc3VtWCArPSB0aW1lO1xyXG4gICAgICAgIHN1bVkgKz0geTtcclxuICAgICAgICBzdW1YWSArPSB0aW1lICogeTtcclxuICAgICAgICBzdW1YWCArPSB0aW1lICogdGltZTtcclxuICAgICAgICBzdW1ZWSArPSB5ICogeTtcclxuICAgICAgfVxyXG4gICAgICBzZXJpZXNbMF0uZGF0YS5wdXNoKFt0aW1lLCB5XSk7XHJcbiAgICAgIG1heFZhbHVlID0gTWF0aC5tYXgobWF4VmFsdWUsIHkpO1xyXG4gICAgICBtYXhYdmFsdWUgPSBNYXRoLm1heChtYXhYdmFsdWUsIHRpbWUpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaW50ZXJjZXB0ID0gKHN1bVkgKiBzdW1YWCAtIHN1bVggKiBzdW1YWSkgLyAobiAqIHN1bVhYIC0gc3VtWCAqIHN1bVgpO1xyXG4gICAgZ3JhZGllbnQgPSAobiAqIHN1bVhZIC0gc3VtWCAqIHN1bVkpIC8gKG4gKiBzdW1YWCAtIHN1bVggKiBzdW1YKTtcclxuXHJcbiAgICBzZXJpZXNbMV0uZGF0YS5wdXNoKFttYXhYdmFsdWUsIG1heFh2YWx1ZSAqIGdyYWRpZW50ICsgaW50ZXJjZXB0XSk7XHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IDEzOyBpKyspIHtcclxuICAgICAgdmFyIHggPSBjb21wRGF0ZS5nZXRUaW1lKCk7XHJcbiAgICAgIGlmKHg8bWF4WHZhbHVlKSB7XHJcbiAgICAgICAgY29tcERhdGUuc2V0TW9udGgoY29tcERhdGUuZ2V0TW9udGgoKSArIDEpO1xyXG4gICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICB9XHJcbiAgICAgIHNlcmllc1sxXS5kYXRhLnB1c2goW3gsIHggKiBncmFkaWVudCArIGludGVyY2VwdF0pO1xyXG4gICAgICB2YXIgbSA9IGNvbXBEYXRlLmdldE1vbnRoKCk7XHJcbiAgICAgIGNvbXBEYXRlLnNldE1vbnRoKGNvbXBEYXRlLmdldE1vbnRoKCkgKyAxKTtcclxuICAgIH1cclxuXHJcbiAgICAvL0FkZCBsaW5lIG9mIGJlc3QgZml0IGZvciBsYXRlc3QgZGF0YSBzaW5jZSBhcHJpbCB0byBuZXh0IGFwcmlsXHJcblxyXG5cclxuICAgIC8vRGVmYXVsdCB0byBsYXN0IGFwcmlsIC0gYXByaWxcclxuXHJcblxyXG4gICAgdmFyIGMgPSAkKCcjJyArIGVsZW1lbnQpLmhpZ2hjaGFydHMoe1xyXG4gICAgICB0aXRsZTogeyB0ZXh0OiAnJyB9LFxyXG4gICAgICB4QXhpczoge1xyXG4gICAgICAgIG1heDogbmV4dEFwcmlsLmdldFRpbWUoKSxcclxuICAgICAgICB0eXBlOiAnZGF0ZXRpbWUnXHJcbiAgICAgIH0sXHJcbiAgICAgIHlBeGlzOiB7XHJcbiAgICAgICAgdGl0bGU6IHsgdGV4dDogJ1F1YWxpdHkgc3RhbmRhcmQgcGVyZm9ybWFuY2UnIH0sXHJcbiAgICAgICAgbWF4OiBtYXhWYWx1ZSswLjA1LFxyXG4gICAgICAgIG1pbjogMCxcclxuICAgICAgICBwbG90TGluZXM6IFt7XHJcbiAgICAgICAgICB2YWx1ZTogdGFyZ2V0LFxyXG4gICAgICAgICAgY29sb3I6ICdncmVlbicsXHJcbiAgICAgICAgICBkYXNoU3R5bGU6ICdzaG9ydGRhc2gnLFxyXG4gICAgICAgICAgd2lkdGg6IDIsXHJcbiAgICAgICAgICBsYWJlbDoge1xyXG4gICAgICAgICAgICB0ZXh0OiAnVGFyZ2V0IC0gJyArICh0YXJnZXQqMTAwKSArICclJ1xyXG4gICAgICAgICAgfSxcclxuICAgICAgICB9XVxyXG4gICAgICB9LFxyXG4gICAgICBsZWdlbmQ6IHsgZW5hYmxlZDogdHJ1ZSB9LFxyXG5cclxuICAgICAgbmF2aWdhdG9yOiB7XHJcbiAgICAgICAgZW5hYmxlZDogdHJ1ZVxyXG4gICAgICB9LFxyXG5cclxuICAgICAgc2VyaWVzOiBzZXJpZXNcclxuICAgIH0pO1xyXG5cclxuICAgIGMuaGlnaGNoYXJ0cygpLmF4ZXNbMF0uc2V0RXh0cmVtZXMoYXByaWxCZWZvcmVUaGF0LmdldFRpbWUoKSwgbGFzdEFwcmlsLmdldFRpbWUoKSwgdW5kZWZpbmVkLCBmYWxzZSk7XHJcblxyXG4gIH0sXHJcblxyXG4gIGRyYXdBbmFseXRpY3M6IGZ1bmN0aW9uKGVsZW1lbnQsIGRhdGEsIHNlbGVjdFNlcmllc0ZuKSB7XHJcblxyXG4gICAgY2h0LmNsb25lVG9vbFRpcCA9IG51bGw7XHJcbiAgICBjaHQuY2xvbmVUb29sVGlwMiA9IG51bGw7XHJcblxyXG4gICAgJCgnIycgKyBlbGVtZW50KS5oaWdoY2hhcnRzKHtcclxuICAgICAgY2hhcnQ6IHtcclxuICAgICAgICB0eXBlOiBcImNvbHVtblwiLFxyXG4gICAgICAgIGhlaWdodDogMjAwLFxyXG4gICAgICAgIGV2ZW50czoge1xyXG4gICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIHNlbGVjdFNlcmllc0ZuKCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoY2h0LmNsb25lVG9vbFRpcCkge1xyXG4gICAgICAgICAgICAgIHRoaXMuY29udGFpbmVyLmZpcnN0Q2hpbGQucmVtb3ZlQ2hpbGQoY2h0LmNsb25lVG9vbFRpcCk7XHJcbiAgICAgICAgICAgICAgY2h0LmNsb25lVG9vbFRpcCA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGNodC5jbG9uZVRvb2xUaXAyKSB7XHJcbiAgICAgICAgICAgICAgY2h0LmNsb25lVG9vbFRpcDIucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgY2h0LmNsb25lVG9vbFRpcDIgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICB0aXRsZToge1xyXG4gICAgICAgIHRleHQ6ICcnXHJcbiAgICAgIH0sXHJcbiAgICAgIHN1YnRpdGxlOiB7XHJcbiAgICAgICAgdGV4dDogZG9jdW1lbnQub250b3VjaHN0YXJ0ID09PSB1bmRlZmluZWQgP1xyXG4gICAgICAgICAgJ0NsaWNrIGEgY29sdW1uIHRvIGZpbHRlciB0aGUgcGF0aWVudCBsaXN0JyA6ICdUYXAgYSBjb2x1bW4gdG8gZmlsdGVyIHRoZSBwYXRpZW50IGxpc3QnXHJcbiAgICAgIH0sXHJcbiAgICAgIHhBeGlzOiB7XHJcbiAgICAgICAgY2F0ZWdvcmllczogZGF0YS5zbGljZSgxKS5tYXAoZnVuY3Rpb24odiwgaSkge1xyXG4gICAgICAgICAgcmV0dXJuIHZbMF07XHJcbiAgICAgICAgfSlcclxuICAgICAgfSxcclxuICAgICAgeUF4aXM6IHtcclxuICAgICAgICB0aXRsZToge1xyXG4gICAgICAgICAgdGV4dDogJ1F1YWxpdHkgc3RhbmRhcmQgcGVyZm9ybWFuY2UnXHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICBsZWdlbmQ6IHtcclxuICAgICAgICBlbmFibGVkOiBmYWxzZVxyXG4gICAgICB9LFxyXG5cclxuICAgICAgcGxvdE9wdGlvbnM6IHtcclxuICAgICAgICBzZXJpZXM6IHtcclxuICAgICAgICAgIGN1cnNvcjogJ3BvaW50ZXInLFxyXG4gICAgICAgICAgcG9pbnQ6IHtcclxuICAgICAgICAgICAgZXZlbnRzOiB7XHJcbiAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbnVtUG9pbnRzID0gdGhpcy5zZXJpZXMucG9pbnRzLmxlbmd0aDtcclxuXHJcbiAgICAgICAgICAgICAgICBzZWxlY3RTZXJpZXNGbih0aGlzLmNhdGVnb3J5KTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoY2h0LmNsb25lVG9vbFRpcCkge1xyXG4gICAgICAgICAgICAgICAgICB0aGlzLnNlcmllcy5jaGFydC5jb250YWluZXIuZmlyc3RDaGlsZC5yZW1vdmVDaGlsZChjaHQuY2xvbmVUb29sVGlwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChjaHQuY2xvbmVUb29sVGlwMikge1xyXG4gICAgICAgICAgICAgICAgICBjaHQuY2xvbmVUb29sVGlwMi5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNodC5jbG9uZVRvb2xUaXAgPSB0aGlzLnNlcmllcy5jaGFydC50b29sdGlwLmxhYmVsLmVsZW1lbnQuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXJpZXMuY2hhcnQuY29udGFpbmVyLmZpcnN0Q2hpbGQuYXBwZW5kQ2hpbGQoY2h0LmNsb25lVG9vbFRpcCk7XHJcblxyXG4gICAgICAgICAgICAgICAgY2h0LmNsb25lVG9vbFRpcDIgPSAkKCcuaGlnaGNoYXJ0cy10b29sdGlwJykuY2xvbmUoKTtcclxuICAgICAgICAgICAgICAgICQodGhpcy5zZXJpZXMuY2hhcnQuY29udGFpbmVyKS5hcHBlbmQoY2h0LmNsb25lVG9vbFRpcDIpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBzZXJpZXM6IFt7XHJcbiAgICAgICAgZGF0YTogZGF0YS5zbGljZSgxKS5tYXAoZnVuY3Rpb24odiwgaSkge1xyXG4gICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgeTogdlt2Lmxlbmd0aCAtIDFdLFxyXG4gICAgICAgICAgICBjb2xvcjogSGlnaGNoYXJ0cy5nZXRPcHRpb25zKCkuY29sb3JzW2ldXHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgIH0pXHJcbiAgICAgIH1dXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBjaHQ7XHJcbiIsInZhciBsb2cgPSByZXF1aXJlKCcuL2xvZy5qcycpLFxyXG4gIGxvb2t1cCA9IHJlcXVpcmUoJy4vbG9va3VwLmpzJyk7XHJcblxyXG52YXIgX2dldEFsbEluZGljYXRvckRhdGEgPSBmdW5jdGlvbihjYWxsYmFjaykge1xyXG4gIHZhciByID0gTWF0aC5yYW5kb20oKTtcclxuICAkLmdldEpTT04oXCJkYXRhL2luZGljYXRvcnMuanNvbj92PVwiICsgciwgZnVuY3Rpb24oZmlsZSkge1xyXG4gICAgZHQuaW5kaWNhdG9ycyA9IGZpbGU7XHJcblxyXG4gICAgZHQuaW5kaWNhdG9ycy5mb3JFYWNoKGZ1bmN0aW9uKGluZGljYXRvcikge1xyXG4gICAgICB2YXIgcGVyY2VudGFnZSA9IE1hdGgucm91bmQoMTAwICogaW5kaWNhdG9yLnZhbHVlc1sxXVsxXSAqIDEwMCAvIGluZGljYXRvci52YWx1ZXNbMl1bMV0pIC8gMTAwO1xyXG4gICAgICBpbmRpY2F0b3IucGVyZm9ybWFuY2UgPSBpbmRpY2F0b3IudmFsdWVzWzFdWzFdICsgXCIgLyBcIiArIGluZGljYXRvci52YWx1ZXNbMl1bMV0gKyBcIiAoXCIgKyBwZXJjZW50YWdlICsgXCIlKVwiO1xyXG4gICAgICBpbmRpY2F0b3IudGFyZ2V0ID0gaW5kaWNhdG9yLnZhbHVlc1szXVsxXSAqIDEwMCArIFwiJVwiO1xyXG4gICAgICBpbmRpY2F0b3IudXAgPSBwZXJjZW50YWdlID4gTWF0aC5yb3VuZCgxMDAgKiBpbmRpY2F0b3IudmFsdWVzWzFdWzJdICogMTAwIC8gaW5kaWNhdG9yLnZhbHVlc1syXVsyXSkgLyAxMDA7XHJcbiAgICAgIHZhciB0cmVuZCA9IGluZGljYXRvci52YWx1ZXNbMV0ubWFwKGZ1bmN0aW9uKHZhbCwgaWR4KSB7XHJcbiAgICAgICAgcmV0dXJuIE1hdGgucm91bmQoMTAwICogdmFsICogMTAwIC8gaW5kaWNhdG9yLnZhbHVlc1syXVtpZHhdKSAvIDEwMDtcclxuICAgICAgfSkuc2xpY2UoMSwgMTApO1xyXG4gICAgICB0cmVuZC5yZXZlcnNlKCk7XHJcbiAgICAgIGluZGljYXRvci50cmVuZCA9IHRyZW5kLmpvaW4oXCIsXCIpO1xyXG4gICAgICB2YXIgZGF0ZXMgPSBpbmRpY2F0b3IudmFsdWVzWzBdLnNsaWNlKDEsIDEwKTtcclxuICAgICAgZGF0ZXMucmV2ZXJzZSgpO1xyXG4gICAgICBpbmRpY2F0b3IuZGF0ZXMgPSBkYXRlcztcclxuICAgIH0pO1xyXG5cclxuXHJcbiAgICBjYWxsYmFjayhkdC5pbmRpY2F0b3JzKTtcclxuICB9KTtcclxufTtcclxuXHJcbnZhciBfZ2V0QWxsSW5kaWNhdG9yRGF0YVN5bmMgPSBmdW5jdGlvbihjYWxsYmFjaykge1xyXG4gIHZhciByID0gTWF0aC5yYW5kb20oKTtcclxuICAkLmFqYXgoe1xyXG4gICAgdXJsOiBcImRhdGEvaW5kaWNhdG9ycy5qc29uP3Y9XCIgKyByLFxyXG4gICAgYXN5bmM6IGZhbHNlLFxyXG4gICAgc3VjY2VzczogZnVuY3Rpb24oZmlsZSkge1xyXG4gICAgICBkdC5pbmRpY2F0b3JzID0gZmlsZTtcclxuXHJcbiAgICAgIGR0LmluZGljYXRvcnMuZm9yRWFjaChmdW5jdGlvbihpbmRpY2F0b3IpIHtcclxuICAgICAgICB2YXIgcGVyY2VudGFnZSA9IE1hdGgucm91bmQoMTAwICogaW5kaWNhdG9yLnZhbHVlc1sxXVsxXSAqIDEwMCAvIGluZGljYXRvci52YWx1ZXNbMl1bMV0pIC8gMTAwO1xyXG4gICAgICAgIGluZGljYXRvci5wZXJmb3JtYW5jZSA9IGluZGljYXRvci52YWx1ZXNbMV1bMV0gKyBcIiAvIFwiICsgaW5kaWNhdG9yLnZhbHVlc1syXVsxXSArIFwiIChcIiArIHBlcmNlbnRhZ2UgKyBcIiUpXCI7XHJcbiAgICAgICAgaW5kaWNhdG9yLnRhcmdldCA9IGluZGljYXRvci52YWx1ZXNbM11bMV0gKiAxMDAgKyBcIiVcIjtcclxuICAgICAgICBpbmRpY2F0b3IudXAgPSBwZXJjZW50YWdlID4gTWF0aC5yb3VuZCgxMDAgKiBpbmRpY2F0b3IudmFsdWVzWzFdWzJdICogMTAwIC8gaW5kaWNhdG9yLnZhbHVlc1syXVsyXSkgLyAxMDA7XHJcbiAgICAgICAgdmFyIHRyZW5kID0gaW5kaWNhdG9yLnZhbHVlc1sxXS5tYXAoZnVuY3Rpb24odmFsLCBpZHgpIHtcclxuICAgICAgICAgIHJldHVybiBNYXRoLnJvdW5kKDEwMCAqIHZhbCAqIDEwMCAvIGluZGljYXRvci52YWx1ZXNbMl1baWR4XSkgLyAxMDA7XHJcbiAgICAgICAgfSkuc2xpY2UoMSwgMTApO1xyXG4gICAgICAgIHRyZW5kLnJldmVyc2UoKTtcclxuICAgICAgICBpbmRpY2F0b3IudHJlbmQgPSB0cmVuZC5qb2luKFwiLFwiKTtcclxuICAgICAgICB2YXIgZGF0ZXMgPSBpbmRpY2F0b3IudmFsdWVzWzBdLnNsaWNlKDEsIDEwKTtcclxuICAgICAgICBkYXRlcy5yZXZlcnNlKCk7XHJcbiAgICAgICAgaW5kaWNhdG9yLmRhdGVzID0gZGF0ZXM7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgcmV0dXJuIGR0LmluZGljYXRvcnM7XHJcbn07XHJcblxyXG52YXIgX2dldEluZGljYXRvckRhdGEgPSBmdW5jdGlvbihpbmRpY2F0b3IsIGNhbGxiYWNrKSB7XHJcbiAgdmFyIHIgPSBNYXRoLnJhbmRvbSgpO1xyXG4gICQuZ2V0SlNPTihcImRhdGEvaWRhdGEuXCIgKyBpbmRpY2F0b3IgKyBcIi5qc29uP3Y9XCIgKyByLCBmdW5jdGlvbihmaWxlKSB7XHJcbiAgICBkdC5pbmRpY2F0b3JzW2luZGljYXRvcl0gPSBmaWxlO1xyXG5cclxuICAgIC8vYXBwbHkgd2hpY2ggY2F0ZWdvcmllcyBwZW9wbGUgYmVsb25nIHRvXHJcbiAgICBPYmplY3Qua2V5cyhkdC5pbmRpY2F0b3JzW2luZGljYXRvcl0ucGF0aWVudHMpLmZvckVhY2goZnVuY3Rpb24ocGF0aWVudCkge1xyXG4gICAgICBkdC5pbmRpY2F0b3JzW2luZGljYXRvcl0ucGF0aWVudHNbcGF0aWVudF0ub3Bwb3J0dW5pdGllcyA9IFtdO1xyXG4gICAgICBkdC5pbmRpY2F0b3JzW2luZGljYXRvcl0ub3Bwb3J0dW5pdGllcy5mb3JFYWNoKGZ1bmN0aW9uKG9wcCwgaWR4KSB7XHJcbiAgICAgICAgaWYgKG9wcC5wYXRpZW50cy5pbmRleE9mKCtwYXRpZW50KSA+IC0xKSB7XHJcbiAgICAgICAgICBkdC5pbmRpY2F0b3JzW2luZGljYXRvcl0ucGF0aWVudHNbcGF0aWVudF0ub3Bwb3J0dW5pdGllcy5wdXNoKGlkeCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGNhbGxiYWNrKGR0LmluZGljYXRvcnNbaW5kaWNhdG9yXSk7XHJcbiAgfSk7XHJcbn07XHJcblxyXG52YXIgX2dldEluZGljYXRvckRhdGFTeW5jID0gZnVuY3Rpb24oaW5kaWNhdG9yKSB7XHJcbiAgdmFyIHIgPSBNYXRoLnJhbmRvbSgpO1xyXG4gICQuYWpheCh7XHJcbiAgICB1cmw6IFwiZGF0YS9pZGF0YS5cIiArIGluZGljYXRvciArIFwiLmpzb24/dj1cIiArIHIsXHJcbiAgICBhc3luYzogZmFsc2UsXHJcbiAgICBzdWNjZXNzOiBmdW5jdGlvbihmaWxlKSB7XHJcbiAgICAgIGR0LmluZGljYXRvcnNbaW5kaWNhdG9yXSA9IGZpbGU7XHJcblxyXG4gICAgICAvL2FwcGx5IHdoaWNoIGNhdGVnb3JpZXMgcGVvcGxlIGJlbG9uZyB0b1xyXG4gICAgICBPYmplY3Qua2V5cyhkdC5pbmRpY2F0b3JzW2luZGljYXRvcl0ucGF0aWVudHMpLmZvckVhY2goZnVuY3Rpb24ocGF0aWVudCkge1xyXG4gICAgICAgIGR0LmluZGljYXRvcnNbaW5kaWNhdG9yXS5wYXRpZW50c1twYXRpZW50XS5vcHBvcnR1bml0aWVzID0gW107XHJcbiAgICAgICAgZHQuaW5kaWNhdG9yc1tpbmRpY2F0b3JdLm9wcG9ydHVuaXRpZXMuZm9yRWFjaChmdW5jdGlvbihvcHAsIGlkeCkge1xyXG4gICAgICAgICAgaWYgKG9wcC5wYXRpZW50cy5pbmRleE9mKCtwYXRpZW50KSA+IC0xKSB7XHJcbiAgICAgICAgICAgIGR0LmluZGljYXRvcnNbaW5kaWNhdG9yXS5wYXRpZW50c1twYXRpZW50XS5vcHBvcnR1bml0aWVzLnB1c2goaWR4KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgfVxyXG4gIH0pO1xyXG4gIHJldHVybiBkdC5pbmRpY2F0b3JzW2luZGljYXRvcl07XHJcbn07XHJcblxyXG52YXIgX2dldEZha2VQYXRpZW50RGF0YSA9IGZ1bmN0aW9uKGNhbGxiYWNrKSB7XHJcbiAgdmFyIHIgPSBNYXRoLnJhbmRvbSgpO1xyXG4gICQuZ2V0SlNPTihcImRhdGEvcGF0aWVudC5qc29uP3Y9XCIgKyByLCBmdW5jdGlvbihmaWxlKSB7XHJcbiAgICBpZiAoIWR0LnBhdGllbnRzKSBkdC5wYXRpZW50cyA9IHt9O1xyXG4gICAgZHQucGF0aWVudHMucGF0aWVudCA9IGZpbGU7XHJcblxyXG4gICAgY2FsbGJhY2soZHQucGF0aWVudHMucGF0aWVudCk7XHJcbiAgfSk7XHJcbn07XHJcblxyXG52YXIgX2dldFBhdGllbnREYXRhID0gZnVuY3Rpb24ocGF0aWVudCwgY2FsbGJhY2spIHtcclxuICB2YXIgciA9IE1hdGgucmFuZG9tKCk7XHJcbiAgJC5nZXRKU09OKFwiZGF0YS9cIiArIHBhdGllbnQgKyBcIi5qc29uP3Y9XCIgKyByLCBmdW5jdGlvbihmaWxlKSB7XHJcbiAgICBpZiAoIWR0LnBhdGllbnRzKSBkdC5wYXRpZW50cyA9IHt9O1xyXG4gICAgZHQucGF0aWVudHNbcGF0aWVudF0gPSBmaWxlO1xyXG5cclxuICAgIGNhbGxiYWNrKGR0LnBhdGllbnRzW3BhdGllbnRdKTtcclxuICB9KS5mYWlsKGZ1bmN0aW9uKCkge1xyXG4gICAgaWYgKGR0LnBhdGllbnRzLnBhdGllbnQpIHJldHVybiBjYWxsYmFjayhkdC5wYXRpZW50cy5wYXRpZW50KTtcclxuICAgIGVsc2UgX2dldEZha2VQYXRpZW50RGF0YShjYWxsYmFjayk7XHJcbiAgfSk7XHJcbn07XHJcblxyXG52YXIgZHQgPSB7XHJcblxyXG4gIHBhdGh3YXlOYW1lczoge30sXHJcbiAgZGlzZWFzZXM6IFtdLFxyXG4gIG9wdGlvbnM6IFtdLFxyXG5cclxuICBnZXRQYXRpZXRMaXN0Rm9yU3RhbmRhcmQ6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCkge1xyXG4gICAgdmFyIHBhdGllbnRzID0gZHQucmVtb3ZlRHVwbGljYXRlcyhkdFtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS5vcHBvcnR1bml0aWVzLnJlZHVjZShmdW5jdGlvbihhLCBiKSB7XHJcbiAgICAgIHJldHVybiBhLnBhdGllbnRzID8gYS5wYXRpZW50cy5jb25jYXQoYi5wYXRpZW50cykgOiBhLmNvbmNhdChiLnBhdGllbnRzKTtcclxuICAgIH0pKTtcclxuICAgIHJldHVybiBwYXRpZW50cztcclxuICB9LFxyXG5cclxuICBnZXRQYXRpZW50U3RhdHVzOiBmdW5jdGlvbihwYXRpZW50SWQsIHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCkge1xyXG4gICAgaWYgKGR0LnBhdGllbnRzW3BhdGllbnRJZF0uYnJlYWNoKSB7XHJcbiAgICAgIGlmIChkdC5wYXRpZW50c1twYXRpZW50SWRdLmJyZWFjaC5maWx0ZXIoZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgICAgICByZXR1cm4gdmFsLnBhdGh3YXlJZCA9PT0gcGF0aHdheUlkICYmIHZhbC5wYXRod2F5U3RhZ2UgPT09IHBhdGh3YXlTdGFnZSAmJiB2YWwuc3RhbmRhcmQgPT09IHN0YW5kYXJkO1xyXG4gICAgICAgIH0pLmxlbmd0aCA+IDApIHtcclxuICAgICAgICByZXR1cm4gXCJtaXNzZWRcIjtcclxuICAgICAgfSBlbHNlIGlmIChkdC5wYXRpZW50c1twYXRpZW50SWRdLmJyZWFjaC5maWx0ZXIoZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgICAgICByZXR1cm4gdmFsLnBhdGh3YXlJZCA9PT0gcGF0aHdheUlkICYmIHZhbC5wYXRod2F5U3RhZ2UgPT09IFwiZGlhZ25vc2lzXCI7XHJcbiAgICAgICAgfSkubGVuZ3RoID4gMCAmJiBwYXRod2F5U3RhZ2UgIT09IFwiZGlhZ25vc2lzXCIpIHtcclxuICAgICAgICByZXR1cm4gXCJub3RcIjtcclxuICAgICAgfSBlbHNlIGlmIChkdC5wYXRpZW50c1twYXRpZW50SWRdLmJyZWFjaC5maWx0ZXIoZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgICAgICByZXR1cm4gdmFsLnBhdGh3YXlJZCA9PT0gcGF0aHdheUlkO1xyXG4gICAgICAgIH0pLmxlbmd0aCA+IDApIHtcclxuICAgICAgICByZXR1cm4gXCJva1wiO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBcIm5vdFwiO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gXCJub3RcIjtcclxuICAgIH1cclxuICB9LFxyXG5cclxuICBnZXROdW1lcmF0b3JGb3JTdGFuZGFyZDogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkKSB7XHJcbiAgICB2YXIgcGF0aWVudHMgPSBkdC5nZXRQYXRpZXRMaXN0Rm9yU3RhbmRhcmQocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkKTtcclxuICAgIHJldHVybiBwYXRpZW50cy5sZW5ndGg7XHJcbiAgfSxcclxuXHJcbiAgZ2V0RGVub21pbmF0b3JGb3JTdGFuZGFyZDogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UpIHtcclxuICAgIHZhciBwYXRpZW50cyA9IGR0W3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5wYXRpZW50c09rO1xyXG4gICAgZm9yICh2YXIgc3RhbmRhcmQgaW4gZHRbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkcykge1xyXG4gICAgICB2YXIgbmV3UGF0aWVudHMgPSBkdC5nZXRQYXRpZXRMaXN0Rm9yU3RhbmRhcmQocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkKTtcclxuICAgICAgcGF0aWVudHMgPSBwYXRpZW50cy5jb25jYXQobmV3UGF0aWVudHMpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGR0LnJlbW92ZUR1cGxpY2F0ZXMocGF0aWVudHMpLmxlbmd0aDtcclxuICB9LFxyXG5cclxuICByZW1vdmVEdXBsaWNhdGVzOiBmdW5jdGlvbihhcnJheSkge1xyXG4gICAgdmFyIGFyclJlc3VsdCA9IHt9O1xyXG4gICAgdmFyIHJ0biA9IFtdO1xyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykge1xyXG4gICAgICBhcnJSZXN1bHRbYXJyYXlbaV1dID0gYXJyYXlbaV07XHJcbiAgICB9XHJcbiAgICBmb3IgKHZhciBpdGVtIGluIGFyclJlc3VsdCkge1xyXG4gICAgICBydG4ucHVzaChhcnJSZXN1bHRbaXRlbV0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJ0bjtcclxuICB9LFxyXG5cclxuICBudW1iZXJPZlN0YW5kYXJkc01pc3NlZDogZnVuY3Rpb24ocGF0aWVudElkKSB7XHJcbiAgICBpZiAoIWR0LnBhdGllbnRzW3BhdGllbnRJZF0uYnJlYWNoKSByZXR1cm4gMDtcclxuICAgIHZhciBhID0gZHQucGF0aWVudHNbcGF0aWVudElkXS5icmVhY2gubWFwKGZ1bmN0aW9uKHZhbCkge1xyXG4gICAgICByZXR1cm4gdmFsLnBhdGh3YXlJZCArIHZhbC5wYXRod2F5U3RhZ2UgKyB2YWwuc3RhbmRhcmQ7XHJcbiAgICB9KTtcclxuICAgIHZhciBvYmogPSB7fTtcclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYS5sZW5ndGg7IGkrKykge1xyXG4gICAgICBvYmpbYVtpXV0gPSBcIlwiO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKG9iaikubGVuZ3RoO1xyXG4gIH0sXHJcblxyXG4gIGdldEFsbFBhdGllbnRzOiBmdW5jdGlvbigpIHtcclxuICAgIHZhciBwTGlzdCA9IFtdLFxyXG4gICAgICBpLCBrLCBwcm9wO1xyXG4gICAgZm9yIChrID0gMDsgayA8IGR0LmRpc2Vhc2VzLmxlbmd0aDsgaysrKSB7XHJcbiAgICAgIGZvciAoaSBpbiBsb29rdXAuY2F0ZWdvcmllcykge1xyXG4gICAgICAgIGZvciAocHJvcCBpbiBkdFtkdC5kaXNlYXNlc1trXS5pZF1baV0uYmRvd24pIHtcclxuICAgICAgICAgIGlmIChkdFtkdC5kaXNlYXNlc1trXS5pZF1baV0uYmRvd24uaGFzT3duUHJvcGVydHkocHJvcCkpIHtcclxuICAgICAgICAgICAgcExpc3QgPSBwTGlzdC5jb25jYXQoZHRbZHQuZGlzZWFzZXNba10uaWRdW2ldLmJkb3duW3Byb3BdLnBhdGllbnRzKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcExpc3QgPSBwTGlzdC5jb25jYXQoZHRbZHQuZGlzZWFzZXNba10uaWRdW2ldLnBhdGllbnRzT2spO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBwTGlzdCA9IGR0LnJlbW92ZUR1cGxpY2F0ZXMocExpc3QpO1xyXG4gICAgdmFyIHBhdGllbnRzID0gcExpc3QubWFwKGZ1bmN0aW9uKHBhdGllbnRJZCkge1xyXG4gICAgICB2YXIgcmV0ID0gZHQucGF0aWVudHNbcGF0aWVudElkXTtcclxuICAgICAgcmV0Lm5oc051bWJlciA9IGR0LnBhdExvb2t1cCA/IGR0LnBhdExvb2t1cFtwYXRpZW50SWRdIDogcGF0aWVudElkO1xyXG4gICAgICByZXQucGF0aWVudElkID0gcGF0aWVudElkO1xyXG4gICAgICByZXQuaXRlbXMgPSBbXTsgLy9UaGUgZmllbGRzIGluIHRoZSBwYXRpZW50IGxpc3QgdGFibGVcclxuICAgICAgcmV0Lml0ZW1zLnB1c2goZHQubnVtYmVyT2ZTdGFuZGFyZHNNaXNzZWQocGF0aWVudElkKSk7XHJcbiAgICAgIHJldHVybiByZXQ7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gcGF0aWVudHM7XHJcbiAgfSxcclxuXHJcbiAgZ2V0OiBmdW5jdGlvbihjYWxsYmFjaywganNvbikge1xyXG4gICAgaWYgKGpzb24pIHtcclxuICAgICAgZHQubG9hZChqc29uKTtcclxuICAgICAgaWYgKHR5cGVvZiBjYWxsYmFjayA9PT0gJ2Z1bmN0aW9uJykgY2FsbGJhY2soKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHZhciByID0gTWF0aC5yYW5kb20oKTtcclxuICAgICAgJC5nZXRKU09OKFwiZGF0YS5qc29uP3Y9XCIgKyByLCBmdW5jdGlvbihmaWxlKSB7XHJcbiAgICAgICAgZHQubG9hZChmaWxlKTtcclxuICAgICAgICBpZiAodHlwZW9mIGNhbGxiYWNrID09PSAnZnVuY3Rpb24nKSBjYWxsYmFjaygpO1xyXG4gICAgICB9KS5mYWlsKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgIGFsZXJ0KFwiZGF0YS5qc29uIGZhaWxlZCB0byBsb2FkISEgLSBpZiB5b3UndmUgY2hhbmdlZCBpdCByZWNlbnRseSBjaGVjayBpdCdzIHZhbGlkIGpzb24gYXQganNvbmxpbnQuY29tXCIpO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9LFxyXG5cclxuICBsb2FkOiBmdW5jdGlvbihmaWxlKSB7XHJcbiAgICB2YXIgZCA9IFwiXCIsXHJcbiAgICAgIGosIGssIGtleSwgZGF0YSA9IGZpbGUuZGlzZWFzZXM7XHJcblxyXG4gICAgZHQgPSBqUXVlcnkuZXh0ZW5kKGR0LCBkYXRhKTsgLy9jb3B5XHJcblxyXG4gICAgZHQucGF0aWVudHMgPSBmaWxlLnBhdGllbnRzO1xyXG4gICAgZHQuY29kZXMgPSBmaWxlLmNvZGVzO1xyXG4gICAgZHQucGF0aWVudEFycmF5ID0gW107XHJcbiAgICBmb3IgKHZhciBvIGluIGZpbGUucGF0aWVudHMpIHtcclxuICAgICAgaWYgKGZpbGUucGF0aWVudHMuaGFzT3duUHJvcGVydHkobykpIHtcclxuICAgICAgICBkdC5wYXRpZW50QXJyYXkucHVzaChvKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZvciAoZCBpbiBkYXRhKSB7XHJcbiAgICAgIGR0LnBhdGh3YXlOYW1lc1tkXSA9IGRhdGFbZF1bXCJkaXNwbGF5LW5hbWVcIl07XHJcbiAgICAgIHZhciBkaXNlYXNlT2JqZWN0ID0ge1xyXG4gICAgICAgIFwiaWRcIjogZCxcclxuICAgICAgICBcImxpbmtcIjogZGF0YVtkXS5saW5rID8gZGF0YVtkXS5saW5rIDogXCJkdC9cIiArIGQsXHJcbiAgICAgICAgXCJmYUljb25cIjogZGF0YVtkXS5pY29uLFxyXG4gICAgICAgIFwibmFtZVwiOiBkYXRhW2RdW1wiZGlzcGxheS1uYW1lXCJdLFxyXG4gICAgICAgIFwidGV4dFwiOiB7XHJcbiAgICAgICAgICBcImR0XCI6IHtcclxuICAgICAgICAgICAgXCJ0b29sdGlwXCI6IGRhdGFbZF1bXCJzaWRlLXBhbmVsLXRvb2x0aXBcIl1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcbiAgICAgIGlmIChkYXRhW2RdLm1vbml0b3JpbmcudGV4dCkge1xyXG4gICAgICAgIGRpc2Vhc2VPYmplY3QudGV4dC5tb25pdG9yaW5nID0gZGF0YVtkXS5tb25pdG9yaW5nLnRleHQuc2lkZVBhbmVsO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChkYXRhW2RdLnRyZWF0bWVudC50ZXh0KSB7XHJcbiAgICAgICAgZGlzZWFzZU9iamVjdC50ZXh0LnRyZWF0bWVudCA9IGRhdGFbZF0udHJlYXRtZW50LnRleHQuc2lkZVBhbmVsO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChkYXRhW2RdLmRpYWdub3Npcy50ZXh0KSB7XHJcbiAgICAgICAgZGlzZWFzZU9iamVjdC50ZXh0LmRpYWdub3NpcyA9IGRhdGFbZF0uZGlhZ25vc2lzLnRleHQuc2lkZVBhbmVsO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChkYXRhW2RdLmV4Y2x1c2lvbnMudGV4dCkge1xyXG4gICAgICAgIGRpc2Vhc2VPYmplY3QudGV4dC5leGNsdXNpb25zID0gZGF0YVtkXS5leGNsdXNpb25zLnRleHQuc2lkZVBhbmVsO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuZGlzZWFzZXMucHVzaChkaXNlYXNlT2JqZWN0KTtcclxuICAgICAgZHRbZF0uc3VnZ2VzdGlvbnMgPSBsb2cucGxhbltkXS50ZWFtO1xyXG4gICAgICAkLmV4dGVuZChkdFtkXS5tb25pdG9yaW5nLCB7XHJcbiAgICAgICAgXCJicmVha2Rvd25cIjogW10sXHJcbiAgICAgICAgXCJiZG93blwiOiB7fVxyXG4gICAgICB9KTtcclxuICAgICAgJC5leHRlbmQoZHRbZF0udHJlYXRtZW50LCB7XHJcbiAgICAgICAgXCJicmVha2Rvd25cIjogW10sXHJcbiAgICAgICAgXCJiZG93blwiOiB7fVxyXG4gICAgICB9KTtcclxuICAgICAgJC5leHRlbmQoZHRbZF0uZGlhZ25vc2lzLCB7XHJcbiAgICAgICAgXCJicmVha2Rvd25cIjogW10sXHJcbiAgICAgICAgXCJiZG93blwiOiB7fVxyXG4gICAgICB9KTtcclxuICAgICAgJC5leHRlbmQoZHRbZF0uZXhjbHVzaW9ucywge1xyXG4gICAgICAgIFwiYnJlYWtkb3duXCI6IFtdLFxyXG4gICAgICAgIFwiYmRvd25cIjoge31cclxuICAgICAgfSk7XHJcblxyXG4gICAgICBpZiAoIWR0W2RdLm1vbml0b3JpbmcuaGVhZGVyKSBjb250aW51ZTtcclxuICAgICAgZm9yIChrZXkgaW4gZHRbZF0ubW9uaXRvcmluZy5zdGFuZGFyZHMpIHtcclxuICAgICAgICB0aGlzLm9wdGlvbnMucHVzaCh7XHJcbiAgICAgICAgICBcInZhbHVlXCI6IHRoaXMub3B0aW9ucy5sZW5ndGgsXHJcbiAgICAgICAgICBcInBhdGh3YXlJZFwiOiBkLFxyXG4gICAgICAgICAgXCJwYXRod2F5U3RhZ2VcIjogXCJtb25pdG9yaW5nXCIsXHJcbiAgICAgICAgICBcInN0YW5kYXJkXCI6IGtleSxcclxuICAgICAgICAgIFwidGV4dFwiOiB0aGlzLnBhdGh3YXlOYW1lc1tkXSArICcgLSAnICsgXCJNb25pdG9yaW5nXCIgKyAnIC0gJyArIGR0W2RdLm1vbml0b3Jpbmcuc3RhbmRhcmRzW2tleV0udGFiLnRpdGxlXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgZm9yIChqID0gMDsgaiA8IGR0W2RdLm1vbml0b3Jpbmcuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllcy5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgZHRbZF0ubW9uaXRvcmluZy5iZG93bltkdFtkXS5tb25pdG9yaW5nLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ubmFtZV0gPSBkdFtkXS5tb25pdG9yaW5nLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal07XHJcbiAgICAgICAgICBkdFtkXS5tb25pdG9yaW5nLmJkb3duW2R0W2RdLm1vbml0b3Jpbmcuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5uYW1lXS5zdWdnZXN0aW9ucyA9IGxvZy5wbGFuW2RdLm1vbml0b3JpbmcuaW5kaXZpZHVhbFtkdFtkXS5tb25pdG9yaW5nLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ubmFtZV07XHJcbiAgICAgICAgICBmb3IgKGsgPSAwOyBrIDwgZHRbZF0ubW9uaXRvcmluZy5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLnBhdGllbnRzLmxlbmd0aDsgaysrKSB7XHJcbiAgICAgICAgICAgIGlmICghZHQucGF0aWVudHNbZHRbZF0ubW9uaXRvcmluZy5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLnBhdGllbnRzW2tdXS5icmVhY2gpIGR0LnBhdGllbnRzW2R0W2RdLm1vbml0b3Jpbmcuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5wYXRpZW50c1trXV0uYnJlYWNoID0gW107XHJcbiAgICAgICAgICAgIGR0LnBhdGllbnRzW2R0W2RdLm1vbml0b3Jpbmcuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5wYXRpZW50c1trXV0uYnJlYWNoLnB1c2goe1xyXG4gICAgICAgICAgICAgIFwicGF0aHdheUlkXCI6IGQsXHJcbiAgICAgICAgICAgICAgXCJwYXRod2F5U3RhZ2VcIjogXCJtb25pdG9yaW5nXCIsXHJcbiAgICAgICAgICAgICAgXCJzdGFuZGFyZFwiOiBrZXksXHJcbiAgICAgICAgICAgICAgXCJzdWJzZWN0aW9uXCI6IGR0W2RdLm1vbml0b3Jpbmcuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5uYW1lXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBmb3IgKGtleSBpbiBkdFtkXS5kaWFnbm9zaXMuc3RhbmRhcmRzKSB7XHJcbiAgICAgICAgdGhpcy5vcHRpb25zLnB1c2goe1xyXG4gICAgICAgICAgXCJ2YWx1ZVwiOiB0aGlzLm9wdGlvbnMubGVuZ3RoLFxyXG4gICAgICAgICAgXCJwYXRod2F5SWRcIjogZCxcclxuICAgICAgICAgIFwicGF0aHdheVN0YWdlXCI6IFwiZGlhZ25vc2lzXCIsXHJcbiAgICAgICAgICBcInN0YW5kYXJkXCI6IGtleSxcclxuICAgICAgICAgIFwidGV4dFwiOiB0aGlzLnBhdGh3YXlOYW1lc1tkXSArICcgLSAnICsgXCJEaWFnbm9zaXNcIiArICcgLSAnICsgZHRbZF0uZGlhZ25vc2lzLnN0YW5kYXJkc1trZXldLnRhYi50aXRsZVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGZvciAoaiA9IDA7IGogPCBkdFtkXS5kaWFnbm9zaXMuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllcy5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgZHRbZF0uZGlhZ25vc2lzLmJkb3duW2R0W2RdLmRpYWdub3Npcy5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLm5hbWVdID0gZHRbZF0uZGlhZ25vc2lzLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal07XHJcbiAgICAgICAgICBkdFtkXS5kaWFnbm9zaXMuYmRvd25bZHRbZF0uZGlhZ25vc2lzLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ubmFtZV0uc3VnZ2VzdGlvbnMgPSBsb2cucGxhbltkXS5kaWFnbm9zaXMuaW5kaXZpZHVhbFtkdFtkXS5kaWFnbm9zaXMuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5uYW1lXTtcclxuICAgICAgICAgIGZvciAoayA9IDA7IGsgPCBkdFtkXS5kaWFnbm9zaXMuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5wYXRpZW50cy5sZW5ndGg7IGsrKykge1xyXG4gICAgICAgICAgICBpZiAoIWR0LnBhdGllbnRzW2R0W2RdLmRpYWdub3Npcy5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLnBhdGllbnRzW2tdXS5icmVhY2gpIGR0LnBhdGllbnRzW2R0W2RdLmRpYWdub3Npcy5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLnBhdGllbnRzW2tdXS5icmVhY2ggPSBbXTtcclxuICAgICAgICAgICAgZHQucGF0aWVudHNbZHRbZF0uZGlhZ25vc2lzLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ucGF0aWVudHNba11dLmJyZWFjaC5wdXNoKHtcclxuICAgICAgICAgICAgICBcInBhdGh3YXlJZFwiOiBkLFxyXG4gICAgICAgICAgICAgIFwicGF0aHdheVN0YWdlXCI6IFwiZGlhZ25vc2lzXCIsXHJcbiAgICAgICAgICAgICAgXCJzdGFuZGFyZFwiOiBrZXksXHJcbiAgICAgICAgICAgICAgXCJzdWJzZWN0aW9uXCI6IGR0W2RdLmRpYWdub3Npcy5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLm5hbWVcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGZvciAoa2V5IGluIGR0W2RdLnRyZWF0bWVudC5zdGFuZGFyZHMpIHtcclxuICAgICAgICB0aGlzLm9wdGlvbnMucHVzaCh7XHJcbiAgICAgICAgICBcInZhbHVlXCI6IHRoaXMub3B0aW9ucy5sZW5ndGgsXHJcbiAgICAgICAgICBcInBhdGh3YXlJZFwiOiBkLFxyXG4gICAgICAgICAgXCJwYXRod2F5U3RhZ2VcIjogXCJ0cmVhdG1lbnRcIixcclxuICAgICAgICAgIFwic3RhbmRhcmRcIjoga2V5LFxyXG4gICAgICAgICAgXCJ0ZXh0XCI6IHRoaXMucGF0aHdheU5hbWVzW2RdICsgJyAtICcgKyBcIlRyZWF0bWVudFwiICsgJyAtICcgKyBkdFtkXS50cmVhdG1lbnQuc3RhbmRhcmRzW2tleV0udGFiLnRpdGxlXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgZm9yIChqID0gMDsgaiA8IGR0W2RdLnRyZWF0bWVudC5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICBkdFtkXS50cmVhdG1lbnQuYmRvd25bZHRbZF0udHJlYXRtZW50LnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ubmFtZV0gPSBkdFtkXS50cmVhdG1lbnQuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXTtcclxuICAgICAgICAgIGR0W2RdLnRyZWF0bWVudC5iZG93bltkdFtkXS50cmVhdG1lbnQuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5uYW1lXS5zdWdnZXN0aW9ucyA9IGxvZy5wbGFuW2RdLnRyZWF0bWVudC5pbmRpdmlkdWFsW2R0W2RdLnRyZWF0bWVudC5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLm5hbWVdO1xyXG4gICAgICAgICAgZm9yIChrID0gMDsgayA8IGR0W2RdLnRyZWF0bWVudC5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLnBhdGllbnRzLmxlbmd0aDsgaysrKSB7XHJcbiAgICAgICAgICAgIGlmICghZHQucGF0aWVudHNbZHRbZF0udHJlYXRtZW50LnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ucGF0aWVudHNba11dLmJyZWFjaCkgZHQucGF0aWVudHNbZHRbZF0udHJlYXRtZW50LnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ucGF0aWVudHNba11dLmJyZWFjaCA9IFtdO1xyXG4gICAgICAgICAgICBkdC5wYXRpZW50c1tkdFtkXS50cmVhdG1lbnQuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5wYXRpZW50c1trXV0uYnJlYWNoLnB1c2goe1xyXG4gICAgICAgICAgICAgIFwicGF0aHdheUlkXCI6IGQsXHJcbiAgICAgICAgICAgICAgXCJwYXRod2F5U3RhZ2VcIjogXCJ0cmVhdG1lbnRcIixcclxuICAgICAgICAgICAgICBcInN0YW5kYXJkXCI6IGtleSxcclxuICAgICAgICAgICAgICBcInN1YnNlY3Rpb25cIjogZHRbZF0udHJlYXRtZW50LnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ubmFtZVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgZm9yIChrZXkgaW4gZHRbZF0uZXhjbHVzaW9ucy5zdGFuZGFyZHMpIHtcclxuICAgICAgICB0aGlzLm9wdGlvbnMucHVzaCh7XHJcbiAgICAgICAgICBcInZhbHVlXCI6IHRoaXMub3B0aW9ucy5sZW5ndGgsXHJcbiAgICAgICAgICBcInBhdGh3YXlJZFwiOiBkLFxyXG4gICAgICAgICAgXCJwYXRod2F5U3RhZ2VcIjogXCJleGNsdXNpb25zXCIsXHJcbiAgICAgICAgICBcInN0YW5kYXJkXCI6IGtleSxcclxuICAgICAgICAgIFwidGV4dFwiOiB0aGlzLnBhdGh3YXlOYW1lc1tkXSArICcgLSAnICsgXCJFeGNsdXNpb25zXCIgKyAnIC0gJyArIGR0W2RdLmV4Y2x1c2lvbnMuc3RhbmRhcmRzW2tleV0udGFiLnRpdGxlXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgZm9yIChqID0gMDsgaiA8IGR0W2RdLmV4Y2x1c2lvbnMuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllcy5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgZHRbZF0uZXhjbHVzaW9ucy5iZG93bltkdFtkXS5leGNsdXNpb25zLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ubmFtZV0gPSBkdFtkXS5leGNsdXNpb25zLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal07XHJcbiAgICAgICAgICBkdFtkXS5leGNsdXNpb25zLmJkb3duW2R0W2RdLmV4Y2x1c2lvbnMuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5uYW1lXS5zdWdnZXN0aW9ucyA9IGxvZy5wbGFuW2RdLmV4Y2x1c2lvbnMuaW5kaXZpZHVhbFtkdFtkXS5leGNsdXNpb25zLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ubmFtZV07XHJcbiAgICAgICAgICBmb3IgKGsgPSAwOyBrIDwgZHRbZF0uZXhjbHVzaW9ucy5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLnBhdGllbnRzLmxlbmd0aDsgaysrKSB7XHJcbiAgICAgICAgICAgIGlmICghZHQucGF0aWVudHNbZHRbZF0uZXhjbHVzaW9ucy5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLnBhdGllbnRzW2tdXS5icmVhY2gpIGR0LnBhdGllbnRzW2R0W2RdLmV4Y2x1c2lvbnMuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5wYXRpZW50c1trXV0uYnJlYWNoID0gW107XHJcbiAgICAgICAgICAgIGR0LnBhdGllbnRzW2R0W2RdLmV4Y2x1c2lvbnMuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5wYXRpZW50c1trXV0uYnJlYWNoLnB1c2goe1xyXG4gICAgICAgICAgICAgIFwicGF0aHdheUlkXCI6IGQsXHJcbiAgICAgICAgICAgICAgXCJwYXRod2F5U3RhZ2VcIjogXCJleGNsdXNpb25zXCIsXHJcbiAgICAgICAgICAgICAgXCJzdGFuZGFyZFwiOiBrZXksXHJcbiAgICAgICAgICAgICAgXCJzdWJzZWN0aW9uXCI6IGR0W2RdLmV4Y2x1c2lvbnMuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5uYW1lXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIGdldEFsbEluZGljYXRvckRhdGE6IGZ1bmN0aW9uKGNhbGxiYWNrKSB7XHJcbiAgICBpZiAoZHQuaW5kaWNhdG9ycykge1xyXG4gICAgICByZXR1cm4gY2FsbGJhY2soZHQuaW5kaWNhdG9ycyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBfZ2V0QWxsSW5kaWNhdG9yRGF0YShjYWxsYmFjayk7XHJcbiAgICB9XHJcbiAgfSxcclxuXHJcbiAgZ2V0QWxsSW5kaWNhdG9yRGF0YVN5bmM6IGZ1bmN0aW9uKCkge1xyXG4gICAgaWYgKGR0LmluZGljYXRvcnMpIHtcclxuICAgICAgcmV0dXJuIGR0LmluZGljYXRvcnM7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gX2dldEFsbEluZGljYXRvckRhdGFTeW5jKCk7XHJcbiAgICB9XHJcbiAgfSxcclxuXHJcbiAgZ2V0SW5kaWNhdG9yRGF0YTogZnVuY3Rpb24oaW5kaWNhdG9yLCBjYWxsYmFjaykge1xyXG4gICAgaWYgKCFkdC5pbmRpY2F0b3JzKSB7XHJcbiAgICAgIF9nZXRBbGxJbmRpY2F0b3JEYXRhKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICBfZ2V0SW5kaWNhdG9yRGF0YShpbmRpY2F0b3IsIGNhbGxiYWNrKTtcclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2UgaWYgKGR0LmluZGljYXRvcnMgJiYgZHQuaW5kaWNhdG9yc1tpbmRpY2F0b3JdKSB7XHJcbiAgICAgIHJldHVybiBjYWxsYmFjayhkdC5pbmRpY2F0b3JzW2luZGljYXRvcl0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgX2dldEluZGljYXRvckRhdGEoaW5kaWNhdG9yLCBjYWxsYmFjayk7XHJcbiAgICB9XHJcbiAgfSxcclxuXHJcbiAgZ2V0SW5kaWNhdG9yRGF0YVN5bmM6IGZ1bmN0aW9uKGluZGljYXRvcikge1xyXG4gICAgZHQuZ2V0QWxsSW5kaWNhdG9yRGF0YVN5bmMoKTtcclxuICAgIGlmIChkdC5pbmRpY2F0b3JzW2luZGljYXRvcl0pIHtcclxuICAgICAgcmV0dXJuIGR0LmluZGljYXRvcnNbaW5kaWNhdG9yXTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiBfZ2V0SW5kaWNhdG9yRGF0YVN5bmMoaW5kaWNhdG9yKTtcclxuICAgIH1cclxuICB9LFxyXG5cclxuICBnZXRQYXRpZW50RGF0YTogZnVuY3Rpb24ocGF0aWVudElkLCBjYWxsYmFjaykge1xyXG4gICAgLyppZihkdC5wYXRpZW50cyAmJiBkdC5wYXRpZW50c1twYXRpZW50SWRdKSB7XHJcbiAgICAgIHJldHVybiBjYWxsYmFjayhkdC5wYXRpZW50c1twYXRpZW50SWRdKTtcclxuICAgIH0gZWxzZSB7Ki9cclxuICAgIF9nZXRQYXRpZW50RGF0YShwYXRpZW50SWQsIGNhbGxiYWNrKTtcclxuICAgIC8qICB9Ki9cclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBkdDtcclxuIiwidmFyIGRhdGEgPSByZXF1aXJlKCcuL2RhdGEuanMnKSxcclxuTXVzdGFjaGUgPSByZXF1aXJlKCdtdXN0YWNoZScpO1xyXG5cclxudmFyIGxheW91dCA9IHtcclxuXHJcbiAgZWxlbWVudHM6IHt9LFxyXG5cclxuICAvL1NpZGUgcGFuZWwsIG5hdmlnYXRpb24sIGhlYWRlciBiYXIgYW5kIG1haW4gcGFnZVxyXG4gIHNob3dNYWluVmlldzogZnVuY3Rpb24oKSB7XHJcbiAgICAvL1NldCB1cCBuYXZpZ2F0aW9uIHBhbmVsXHJcbiAgICAvLy8vbGF5b3V0LnNob3dTaWRlUGFuZWwoKTtcclxuICAgIC8vLy9sYXlvdXQuc2hvd05hdmlnYXRpb24oZGF0YS5kaXNlYXNlcywgaWR4LCAkKCcjbWFpbi1kYXNoYm9hcmQnKSk7XHJcblxyXG4gICAgJCgnI2JvdHRvbW5hdmJhcicpLmhpZGUoKTtcclxuICAgIGxheW91dC5zaG93SGVhZGVyQmFySXRlbXMoKTtcclxuXHJcbiAgICAvL1Nob3cgbWFpbiBkYXNoYm9hcmQgcGFnZVxyXG4gICAgbGF5b3V0LnNob3dQYWdlKCdtYWluLWRhc2hib2FyZCcpO1xyXG4gIH0sXHJcblxyXG4gIGNsZWFyTmF2aWdhdGlvbjogZnVuY3Rpb24oKSB7XHJcbiAgICAkKFwiYXNpZGUubGVmdC1wYW5lbCBuYXYubmF2aWdhdGlvbiA+IHVsID4gbGkgPiB1bFwiKS5zbGlkZVVwKDMwMCk7XHJcbiAgICAkKFwiYXNpZGUubGVmdC1wYW5lbCBuYXYubmF2aWdhdGlvbiA+IHVsID4gbGlcIikucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gIH0sXHJcblxyXG4gIHNob3dOYXZpZ2F0aW9uOiBmdW5jdGlvbihsaXN0LCBpZHgsIHBhcmVudCkge1xyXG4gICAgaWYgKGxheW91dC5lbGVtZW50cy5uYXZpZ2F0aW9uKSB7XHJcblxyXG4gICAgICBpZiAoaWR4ID09PSAtMSkge1xyXG4gICAgICAgIGxheW91dC5jbGVhck5hdmlnYXRpb24oKTtcclxuICAgICAgICAkKCdhc2lkZSBhW2hyZWY9XCIjd2VsY29tZVwiXTpmaXJzdCcpLmNsb3Nlc3QoJ2xpJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICB9IGVsc2UgaWYgKGlkeCA+PSBsaXN0Lmxlbmd0aCkge1xyXG4gICAgICAgIGxheW91dC5jbGVhck5hdmlnYXRpb24oKTtcclxuICAgICAgICAkKCdhc2lkZSBhW2hyZWY9XCIjcGF0aWVudHNcIl0nKS5jbG9zZXN0KCdsaScpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgfSBlbHNlIGlmICghJCgnYXNpZGUgYVtocmVmPVwiIycgKyBsaXN0W2lkeF0ubGluayArICdcIl06Zmlyc3QnKS5jbG9zZXN0KCdsaScpLmhhc0NsYXNzKCdhY3RpdmUnKSkge1xyXG4gICAgICAgIGxheW91dC5jbGVhck5hdmlnYXRpb24oKTtcclxuICAgICAgICAvL3NldCBhY3RpdmVcclxuICAgICAgICAkKCdhc2lkZSBhW2hyZWY9XCIjJyArIGxpc3RbaWR4XS5saW5rICsgJ1wiXScpLm5leHQoKS5zbGlkZVRvZ2dsZSgzMDApO1xyXG4gICAgICAgICQoJ2FzaWRlIGFbaHJlZj1cIiMnICsgbGlzdFtpZHhdLmxpbmsgKyAnXCJdJykuY2xvc2VzdCgnbGknKS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICB2YXIgdGVtcE11c3QgPSAkKCcjcGF0aHdheS1waWNrZXInKS5odG1sKCk7XHJcbiAgICB2YXIgaXRlbVRlbXBsYXRlID0gJCgnI3BhdGh3YXktcGlja2VyLWl0ZW0nKS5odG1sKCk7XHJcbiAgICBNdXN0YWNoZS5wYXJzZSh0ZW1wTXVzdCk7XHJcbiAgICBNdXN0YWNoZS5wYXJzZShpdGVtVGVtcGxhdGUpO1xyXG5cclxuICAgIGxpc3QgPSBsaXN0LnNsaWNlKCk7XHJcbiAgICBsaXN0WzBdLmlzQnJlYWtBYm92ZVByYWN0aWNlID0gdHJ1ZTtcclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykge1xyXG4gICAgICBsaXN0W2ldLmhhc1N1Ykl0ZW1zID0gdHJ1ZTtcclxuICAgIH1cclxuICAgIGxpc3QudW5zaGlmdCh7XHJcbiAgICAgIFwibGlua1wiOiBcIndlbGNvbWVcIixcclxuICAgICAgXCJmYUljb25cIjogXCJmYS1ob21lXCIsXHJcbiAgICAgIFwibmFtZVwiOiBcIkFncmVlZCBhY3Rpb25zXCIsXHJcbiAgICAgIFwiaXNCcmVha0Fib3ZlSG9tZVwiOiB0cnVlLFxyXG4gICAgICBcInRleHRcIjoge1xyXG4gICAgICAgIFwibWFpblwiOiB7XHJcbiAgICAgICAgICBcInRvb2x0aXBcIjogXCJBZ3JlZWQgdG9vbHRpcCAtIGVkaXQgaW4gc2NyaXB0LmpzXCJcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgbGlzdC5wdXNoKHtcclxuICAgICAgXCJsaW5rXCI6IFwicGF0aWVudHNcIixcclxuICAgICAgXCJmYUljb25cIjogXCJmYS11c2Vyc1wiLFxyXG4gICAgICBcIm5hbWVcIjogXCJBbGwgUGF0aWVudHNcIixcclxuICAgICAgXCJpc0JyZWFrQWJvdmVQYXRpZW50XCI6IHRydWUsXHJcbiAgICAgIFwidGV4dFwiOiB7XHJcbiAgICAgICAgXCJtYWluXCI6IHtcclxuICAgICAgICAgIFwidG9vbHRpcFwiOiBcIkFsbCBwYXRpZW50cyB0b29sdGlwIC0gZWRpdCBpbiBzY3JpcHQuanNcIlxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgbGlzdC5tYXAoZnVuY3Rpb24odiwgaSwgYXJyKSB7XHJcbiAgICAgIHYuaXNTZWxlY3RlZCA9IGkgPT09IGlkeCArIDE7XHJcbiAgICAgIHJldHVybiB2O1xyXG4gICAgfSk7XHJcblxyXG4gICAgdmFyIHJlbmRlcmVkQmVmb3JlID0gTXVzdGFjaGUucmVuZGVyKHRlbXBNdXN0LCB7XHJcbiAgICAgIFwiaXRlbXNcIjogbGlzdFxyXG4gICAgfSwge1xyXG4gICAgICBcIml0ZW1cIjogaXRlbVRlbXBsYXRlLFxyXG4gICAgICBcInN1Ykl0ZW1cIjogJCgnI3BhdGh3YXktcGlja2VyLXN1Yi1pdGVtJykuaHRtbCgpXHJcbiAgICB9KTtcclxuICAgICQoJyNhc2lkZS10b2dnbGUgbmF2OmZpcnN0JykuaHRtbChyZW5kZXJlZEJlZm9yZSk7XHJcblxyXG4gICAgJCgnLnVzZXInKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcclxuICAgICAgdGVtcGxhdGUubG9hZENvbnRlbnQoJyNhZ3JlZWRhY3Rpb25zJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBsYXlvdXQuZWxlbWVudHMubmF2aWdhdGlvbiA9IHRydWU7XHJcbiAgfSxcclxuXHJcbiAgc2hvd1BhZ2U6IGZ1bmN0aW9uKHBhZ2UpIHtcclxuICAgIGlmIChsYXlvdXQucGFnZSA9PT0gcGFnZSkgcmV0dXJuO1xyXG4gICAgbGF5b3V0LnBhZ2UgPSBwYWdlO1xyXG4gICAgJCgnLnBhZ2UnKS5oaWRlKCk7XHJcbiAgICAkKCcjJyArIHBhZ2UpLnNob3coKTtcclxuXHJcbiAgICBpZiAocGFnZSAhPT0gJ21haW4tZGFzaGJvYXJkJykge1xyXG4gICAgICAvLy8vbGF5b3V0LmhpZGVTaWRlUGFuZWwoKTtcclxuICAgICAgJCgnI2JvdHRvbW5hdmJhcicpLnNob3coKTtcclxuICAgICAgbGF5b3V0LmhpZGVIZWFkZXJCYXJJdGVtcygpO1xyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIHNob3dTaWRlUGFuZWw6IGZ1bmN0aW9uKCkge1xyXG4gICAgaWYgKGxheW91dC5lbGVtZW50cy5uYXZpZ3Rpb24pIHJldHVybjtcclxuICAgIGxheW91dC5lbGVtZW50cy5uYXZpZ3Rpb24gPSB0cnVlO1xyXG4gICAgJCgnI21haW4nKS5hZGRDbGFzcygnY29udGVudCcpO1xyXG4gICAgJCgnI3RvcG5hdmJhcicpLmFkZENsYXNzKCdmdWxsJyk7XHJcbiAgICAkKCcjYXNpZGUtdG9nZ2xlJykuc2hvdygpO1xyXG4gICAgJCgnI2JvdHRvbW5hdmJhcicpLmhpZGUoKTtcclxuICB9LFxyXG5cclxuICBoaWRlU2lkZVBhbmVsOiBmdW5jdGlvbigpIHtcclxuICAgIGlmIChsYXlvdXQuZWxlbWVudHMubmF2aWd0aW9uID09PSBmYWxzZSkgcmV0dXJuO1xyXG4gICAgbGF5b3V0LmVsZW1lbnRzLm5hdmlndGlvbiA9IGZhbHNlO1xyXG4gICAgJCgnI21haW4nKS5yZW1vdmVDbGFzcygnY29udGVudCcpO1xyXG4gICAgJCgnI3RvcG5hdmJhcicpLnJlbW92ZUNsYXNzKCdmdWxsJyk7XHJcbiAgICAkKCcjYXNpZGUtdG9nZ2xlJykuaGlkZSgpO1xyXG4gICAgJCgnI2JvdHRvbW5hdmJhcicpLnNob3coKTtcclxuICB9LFxyXG5cclxuICBzaG93SGVhZGVyQmFySXRlbXM6IGZ1bmN0aW9uKCkge1xyXG4gICAgaWYgKGxheW91dC5lbGVtZW50cy5oZWFkZXJiYXIpIHJldHVybjtcclxuICAgIGxheW91dC5lbGVtZW50cy5oZWFkZXJiYXIgPSB0cnVlO1xyXG4gICAgJCgnLmhpZGUtaWYtbG9nZ2VkLW91dCcpLnNob3coKTtcclxuICB9LFxyXG5cclxuICBoaWRlSGVhZGVyQmFySXRlbXM6IGZ1bmN0aW9uKCkge1xyXG4gICAgaWYgKGxheW91dC5lbGVtZW50cy5oZWFkZXJiYXIgPT09IGZhbHNlKSByZXR1cm47XHJcbiAgICBsYXlvdXQuZWxlbWVudHMuaGVhZGVyYmFyID0gZmFsc2U7XHJcbiAgICAkKCcuaGlkZS1pZi1sb2dnZWQtb3V0JykuaGlkZSgpO1xyXG4gIH1cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGxheW91dDtcclxuIiwidmFyIG5vdGlmeSA9IHJlcXVpcmUoJy4vbm90aWZ5LmpzJyk7XHJcblxyXG52YXIgbG9nID0ge1xyXG4gIHJlYXNvbjoge30sXHJcblxyXG4gIGdldE9iajogZnVuY3Rpb24ob3B0aW9ucykge1xyXG4gICAgdmFyIG9iaiA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmJiKTtcclxuXHJcbiAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLmxlbmd0aCA+IDApIHtcclxuICAgICAgb3B0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uKG9wdCkge1xyXG4gICAgICAgIGlmICghb2JqW29wdC5uYW1lXSkge1xyXG4gICAgICAgICAgb2JqW29wdC5uYW1lXSA9IG9wdC52YWx1ZTtcclxuICAgICAgICAgIGxvZy5zZXRPYmoob2JqKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBvYmo7XHJcbiAgfSxcclxuXHJcbiAgc2V0T2JqOiBmdW5jdGlvbihvYmopIHtcclxuICAgIGxvY2FsU3RvcmFnZS5iYiA9IEpTT04uc3RyaW5naWZ5KG9iaik7XHJcbiAgfSxcclxuXHJcbiAgbG9hZEFjdGlvbnM6IGZ1bmN0aW9uKGNhbGxiYWNrKSB7XHJcbiAgICB2YXIgciA9IE1hdGgucmFuZG9tKCk7XHJcbiAgICAkLmdldEpTT04oXCJhY3Rpb24tcGxhbi5qc29uP3Y9XCIgKyByLCBmdW5jdGlvbihmaWxlKSB7XHJcbiAgICAgIGxvZy5wbGFuID0gZmlsZS5kaXNlYXNlcztcclxuICAgICAgbG9nLnRleHQgPSBmaWxlLnBsYW5zO1xyXG4gICAgICBjYWxsYmFjaygpO1xyXG4gICAgfSk7XHJcbiAgfSxcclxuXHJcbiAgZWRpdEFjdGlvbjogZnVuY3Rpb24oaWQsIGFjdGlvbklkLCBhZ3JlZSwgZG9uZSwgcmVhc29uKSB7XHJcbiAgICB2YXIgbG9nVGV4dCwgb2JqID0gbG9nLmdldE9iaihbe1xyXG4gICAgICBuYW1lOiBcImFjdGlvbnNcIixcclxuICAgICAgdmFsdWU6IHt9XHJcbiAgICB9XSk7XHJcbiAgICBpZiAoIWlkKSBhbGVydChcIkFDVElPTiBURUFNL0lORCBJRFwiKTtcclxuICAgIGlmICghYWN0aW9uSWQpIGFsZXJ0KFwiQUNUSU9OIElEXCIpO1xyXG5cclxuICAgIGlmICghb2JqLmFjdGlvbnNbaWRdKSB7XHJcbiAgICAgIG9iai5hY3Rpb25zW2lkXSA9IHt9O1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBpZiAoYWdyZWUpIHtcclxuICAgICAgbG9nVGV4dCA9IFwiWW91IGFncmVlZCB3aXRoIHRoaXMgc3VnZ2VzdGVkIGFjdGlvbiBvbiBcIiArIChuZXcgRGF0ZSgpKS50b0RhdGVTdHJpbmcoKTtcclxuICAgIH0gZWxzZSBpZiAoYWdyZWUgPT09IGZhbHNlKSB7XHJcbiAgICAgIHZhciByZWFzb25UZXh0ID0gbG9nLnJlYXNvbi5yZWFzb24gPT09IFwiXCIgJiYgbG9nLnJlYXNvbi5yZWFzb25UZXh0ID09PSBcIlwiID8gXCIgLSBubyByZWFzb24gZ2l2ZW5cIiA6IFwiIC4gWW91IGRpc2FncmVlZCBiZWNhdXNlIHlvdSBzYWlkOiAnXCIgKyBsb2cucmVhc29uLnJlYXNvbiArIFwiOyBcIiArIGxvZy5yZWFzb24ucmVhc29uVGV4dCArIFwiLidcIjtcclxuICAgICAgbG9nVGV4dCA9IFwiWW91IGRpc2FncmVlZCB3aXRoIHRoaXMgYWN0aW9uIG9uIFwiICsgKG5ldyBEYXRlKCkpLnRvRGF0ZVN0cmluZygpICsgcmVhc29uVGV4dDtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoZG9uZSkge1xyXG4gICAgICBsb2dUZXh0ID0gXCJZb3UgYWdyZWVkIHdpdGggdGhpcyBzdWdnZXN0ZWQgYWN0aW9uIG9uIFwiICsgKG5ldyBEYXRlKCkpLnRvRGF0ZVN0cmluZygpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICghb2JqLmFjdGlvbnNbaWRdW2FjdGlvbklkXSkge1xyXG4gICAgICBvYmouYWN0aW9uc1tpZF1bYWN0aW9uSWRdID0ge1xyXG4gICAgICAgIFwiYWdyZWVcIjogYWdyZWUgPyBhZ3JlZSA6IGZhbHNlLFxyXG4gICAgICAgIFwiZG9uZVwiOiBkb25lID8gZG9uZSA6IGZhbHNlLFxyXG4gICAgICAgIFwiaGlzdG9yeVwiOiBbbG9nVGV4dF1cclxuICAgICAgfTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGlmIChhZ3JlZSA9PT0gdHJ1ZSB8fCBhZ3JlZSA9PT0gZmFsc2UpIG9iai5hY3Rpb25zW2lkXVthY3Rpb25JZF0uYWdyZWUgPSBhZ3JlZTtcclxuICAgICAgaWYgKGRvbmUgPT09IHRydWUgfHwgZG9uZSA9PT0gZmFsc2UpIG9iai5hY3Rpb25zW2lkXVthY3Rpb25JZF0uZG9uZSA9IGRvbmU7XHJcbiAgICAgIGlmIChsb2dUZXh0KSB7XHJcbiAgICAgICAgaWYgKG9iai5hY3Rpb25zW2lkXVthY3Rpb25JZF0uaGlzdG9yeSkgb2JqLmFjdGlvbnNbaWRdW2FjdGlvbklkXS5oaXN0b3J5LnVuc2hpZnQobG9nVGV4dCk7XHJcbiAgICAgICAgZWxzZSBvYmouYWN0aW9uc1tpZF1bYWN0aW9uSWRdLmRvbmUuaGlzdG9yeSA9IFtsb2dUZXh0XTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmIChyZWFzb24gJiYgb2JqLmFjdGlvbnNbaWRdW2FjdGlvbklkXS5hZ3JlZSA9PT0gZmFsc2UpIHtcclxuICAgICAgb2JqLmFjdGlvbnNbaWRdW2FjdGlvbklkXS5yZWFzb24gPSByZWFzb247XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBkZWxldGUgb2JqLmFjdGlvbnNbaWRdW2FjdGlvbklkXS5yZWFzb247XHJcbiAgICB9XHJcblxyXG4gICAgbG9nLnNldE9iaihvYmopO1xyXG4gICAgbm90aWZ5LnNob3dTYXZlZCgpO1xyXG4gIH0sXHJcblxyXG4gIGlnbm9yZUFjdGlvbjogZnVuY3Rpb24oaWQsIGFjdGlvbklkKSB7XHJcbiAgICB2YXIgb2JqID0gbG9nLmdldE9iaihbe1xyXG4gICAgICBuYW1lOiBcImFjdGlvbnNcIixcclxuICAgICAgdmFsdWU6IHt9XHJcbiAgICB9XSk7XHJcbiAgICBvYmouYWN0aW9uc1tpZF1bYWN0aW9uSWRdLmFncmVlID0gbnVsbDtcclxuICAgIGRlbGV0ZSBvYmouYWN0aW9uc1tpZF1bYWN0aW9uSWRdLnJlYXNvbjtcclxuICAgIGxvZy5zZXRPYmoob2JqKTtcclxuICB9LFxyXG5cclxuICBnZXRBY3Rpb25zOiBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiBsb2cuZ2V0T2JqKFt7XHJcbiAgICAgIG5hbWU6IFwiYWN0aW9uc1wiLFxyXG4gICAgICB2YWx1ZToge31cclxuICAgIH1dKS5hY3Rpb25zO1xyXG4gIH0sXHJcblxyXG4gIGxpc3RBY3Rpb25zOiBmdW5jdGlvbihpZCwgcGF0aHdheUlkKSB7XHJcbiAgICB2YXIgb2JqID0gbG9nLmdldE9iaihbe1xyXG4gICAgICBuYW1lOiBcImFjdGlvbnNcIixcclxuICAgICAgdmFsdWU6IHt9XHJcbiAgICB9XSk7XHJcbiAgICBhcnIgPSBbXTtcclxuICAgIGlmICghaWQpIHJldHVybiBvYmouYWN0aW9ucztcclxuICAgIGlmICghb2JqLmFjdGlvbnNbaWRdKSByZXR1cm4gYXJyO1xyXG4gICAgZm9yICh2YXIgcHJvcCBpbiBvYmouYWN0aW9uc1tpZF0pIHtcclxuICAgICAgb2JqLmFjdGlvbnNbaWRdW3Byb3BdLmlkID0gcHJvcDtcclxuICAgICAgaWYgKCFvYmouYWN0aW9uc1tpZF1bcHJvcF0udGV4dClcclxuICAgICAgICBhcnIucHVzaChvYmouYWN0aW9uc1tpZF1bcHJvcF0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFycjtcclxuICB9LFxyXG5cclxuICAvL2lkIGlzIGVpdGhlciBcInRlYW1cIiBvciB0aGUgcGF0aWVudElkXHJcbiAgcmVjb3JkRmVlZGJhY2s6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgaWQsIHN1Z2dlc3Rpb24sIHJlYXNvbiwgcmVhc29uVGV4dCkge1xyXG4gICAgbG9nLnJlYXNvbiA9IHtcclxuICAgICAgXCJyZWFzb25cIjogcmVhc29uLFxyXG4gICAgICBcInJlYXNvblRleHRcIjogcmVhc29uVGV4dFxyXG4gICAgfTtcclxuICAgIHZhciBvYmogPSBsb2cuZ2V0T2JqKFt7XHJcbiAgICAgIG5hbWU6IFwiZmVlZGJhY2tcIixcclxuICAgICAgdmFsdWU6IFtdXHJcbiAgICB9XSk7XHJcblxyXG4gICAgdmFyIGl0ZW0gPSB7XHJcbiAgICAgIFwicGF0aHdheUlkXCI6IHBhdGh3YXlJZCxcclxuICAgICAgXCJpZFwiOiBpZCxcclxuICAgICAgXCJ2YWxcIjogc3VnZ2VzdGlvblxyXG4gICAgfTtcclxuICAgIGlmIChyZWFzb25UZXh0ICE9PSBcIlwiKSBpdGVtLnJlYXNvblRleHQgPSByZWFzb25UZXh0O1xyXG4gICAgaWYgKHJlYXNvbiAhPT0gXCJcIikgaXRlbS5yZWFzb24gPSByZWFzb247XHJcbiAgICBvYmouZmVlZGJhY2sucHVzaChpdGVtKTtcclxuICAgIGxvZy5zZXRPYmoob2JqKTtcclxuICB9LFxyXG5cclxuICBnZXRFdmVudHM6IGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIGxvZy5nZXRPYmooW3tcclxuICAgICAgbmFtZTogXCJldmVudHNcIixcclxuICAgICAgdmFsdWU6IFtdXHJcbiAgICB9XSkuZXZlbnRzO1xyXG4gIH0sXHJcblxyXG4gIHJlY29yZEV2ZW50OiBmdW5jdGlvbihwYXRod2F5SWQsIGlkLCBuYW1lKSB7XHJcbiAgICB2YXIgb2JqID0gbG9nLmdldE9iaihbe1xyXG4gICAgICBuYW1lOiBcImV2ZW50c1wiLFxyXG4gICAgICB2YWx1ZTogW11cclxuICAgIH1dKTtcclxuICAgIG9iai5ldmVudHMucHVzaCh7XHJcbiAgICAgIFwicGF0aHdheUlkXCI6IHBhdGh3YXlJZCxcclxuICAgICAgXCJpZFwiOiBpZCxcclxuICAgICAgXCJuYW1lXCI6IG5hbWUsXHJcbiAgICAgIFwiZGF0ZVwiOiBuZXcgRGF0ZSgpXHJcbiAgICB9KTtcclxuICAgIGxvZy5zZXRPYmoob2JqKTtcclxuICB9LFxyXG5cclxuICByZWNvcmRQbGFuOiBmdW5jdGlvbihpZCwgdGV4dCwgcGF0aHdheUlkKSB7XHJcbiAgICBpZiAoIWlkKSBhbGVydChcIlBMQU5cIik7XHJcbiAgICB2YXIgb2JqID0gbG9nLmdldE9iaihbe1xyXG4gICAgICBuYW1lOiBcImFjdGlvbnNcIixcclxuICAgICAgdmFsdWU6IHt9XHJcbiAgICB9XSk7XHJcblxyXG4gICAgaWYgKCFvYmouYWN0aW9uc1tpZF0pIG9iai5hY3Rpb25zW2lkXSA9IHt9O1xyXG4gICAgdmFyIHBsYW5JZCA9IERhdGUubm93KCkgKyBcIlwiO1xyXG4gICAgb2JqLmFjdGlvbnNbaWRdW3BsYW5JZF0gPSB7XHJcbiAgICAgIFwidGV4dFwiOiB0ZXh0LFxyXG4gICAgICBcImFncmVlXCI6IG51bGwsXHJcbiAgICAgIFwiZG9uZVwiOiBmYWxzZSxcclxuICAgICAgXCJwYXRod2F5SWRcIjogcGF0aHdheUlkLFxyXG4gICAgICBcImhpc3RvcnlcIjogW1wiWW91IGFkZGVkIHRoaXMgb24gXCIgKyAobmV3IERhdGUoKSkudG9EYXRlU3RyaW5nKCldXHJcbiAgICB9O1xyXG5cclxuICAgIGxvZy5zZXRPYmoob2JqKTtcclxuICAgIHJldHVybiBwbGFuSWQ7XHJcbiAgfSxcclxuXHJcbiAgZmluZFBsYW46IGZ1bmN0aW9uKG9iaiwgcGxhbklkKSB7XHJcbiAgICBmb3IgKHZhciBrIGluIG9iai5hY3Rpb25zKSB7XHJcbiAgICAgIGlmIChvYmouYWN0aW9uc1trXVtwbGFuSWRdICYmIG9iai5hY3Rpb25zW2tdW3BsYW5JZF0udGV4dCkgcmV0dXJuIGs7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gLTE7XHJcbiAgfSxcclxuXHJcbiAgZWRpdFBsYW46IGZ1bmN0aW9uKHBsYW5JZCwgdGV4dCwgZG9uZSkge1xyXG4gICAgdmFyIG9iaiA9IGxvZy5nZXRPYmooW3tcclxuICAgICAgbmFtZTogXCJhY3Rpb25zXCIsXHJcbiAgICAgIHZhbHVlOiB7fVxyXG4gICAgfV0pO1xyXG4gICAgdmFyIGlkID0gbG9nLmZpbmRQbGFuKG9iaiwgcGxhbklkKTtcclxuICAgIGlmICh0ZXh0KSBvYmouYWN0aW9uc1tpZF1bcGxhbklkXS50ZXh0ID0gdGV4dDtcclxuICAgIGlmIChkb25lID09PSB0cnVlIHx8IGRvbmUgPT09IGZhbHNlKSBvYmouYWN0aW9uc1tpZF1bcGxhbklkXS5kb25lID0gZG9uZTtcclxuICAgIGxvZy5zZXRPYmoob2JqKTtcclxuICB9LFxyXG5cclxuICBkZWxldGVQbGFuOiBmdW5jdGlvbihwbGFuSWQpIHtcclxuICAgIHZhciBvYmogPSBsb2cuZ2V0T2JqKFt7XHJcbiAgICAgIG5hbWU6IFwiYWN0aW9uc1wiLFxyXG4gICAgICB2YWx1ZToge31cclxuICAgIH1dKTtcclxuICAgIHZhciBpZCA9IGxvZy5maW5kUGxhbihvYmosIHBsYW5JZCk7XHJcbiAgICBkZWxldGUgb2JqLmFjdGlvbnNbaWRdW3BsYW5JZF07XHJcbiAgICBsb2cuc2V0T2JqKG9iaik7XHJcbiAgfSxcclxuXHJcbiAgbGlzdFBsYW5zOiBmdW5jdGlvbihpZCwgcGF0aHdheUlkKSB7XHJcbiAgICB2YXIgb2JqID0gbG9nLmdldE9iaihbe1xyXG4gICAgICAgIG5hbWU6IFwiYWN0aW9uc1wiLFxyXG4gICAgICAgIHZhbHVlOiB7fVxyXG4gICAgICB9XSksXHJcbiAgICAgIGFyciA9IFtdO1xyXG4gICAgaWYgKCFpZCkgcmV0dXJuIG9iai5hY3Rpb25zO1xyXG4gICAgZm9yICh2YXIgcHJvcCBpbiBvYmouYWN0aW9uc1tpZF0pIHtcclxuICAgICAgb2JqLmFjdGlvbnNbaWRdW3Byb3BdLmlkID0gcHJvcDtcclxuICAgICAgaWYgKCghcGF0aHdheUlkIHx8IHBhdGh3YXlJZCA9PT0gb2JqLmFjdGlvbnNbaWRdW3Byb3BdLnBhdGh3YXlJZCkgJiYgb2JqLmFjdGlvbnNbaWRdW3Byb3BdLnRleHQpIGFyci5wdXNoKG9iai5hY3Rpb25zW2lkXVtwcm9wXSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYXJyO1xyXG4gIH0sXHJcblxyXG4gIGdldFJlYXNvbjogZnVuY3Rpb24oaWQsIGFjdGlvbklkKSB7XHJcbiAgICB2YXIgb2JqID0gbG9nLmdldE9iaihbe1xyXG4gICAgICBuYW1lOiBcImFjdGlvbnNcIixcclxuICAgICAgdmFsdWU6IHt9XHJcbiAgICB9XSk7XHJcblxyXG4gICAgaWYgKG9iai5hY3Rpb25zW2lkXSAmJiBvYmouYWN0aW9uc1tpZF1bYWN0aW9uSWRdKSByZXR1cm4gb2JqLmFjdGlvbnNbaWRdW2FjdGlvbklkXS5yZWFzb247XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9LFxyXG5cclxuICBnZXRBZ3JlZVJlYXNvbjogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQsIGl0ZW0pIHtcclxuICAgIHZhciBvYmogPSBsb2cuZ2V0T2JqKFt7XHJcbiAgICAgIG5hbWU6IFwiYWdyZWVzXCIsXHJcbiAgICAgIHZhbHVlOiB7fVxyXG4gICAgfV0pO1xyXG4gICAgaWYgKCFwYXRod2F5SWQgfHwgIXBhdGh3YXlTdGFnZSkgYWxlcnQoXCJFRElUUEFUSUVOVEFHUkVFXCIpO1xyXG5cclxuICAgIGlmICghb2JqLmFncmVlc1twYXRpZW50SWRdKSBvYmouYWdyZWVzW3BhdGllbnRJZF0gPSBbXTtcclxuICAgIHZhciBpdGVtcyA9IG9iai5hZ3JlZXNbcGF0aWVudElkXS5maWx0ZXIoZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgIHJldHVybiB2YWwucGF0aHdheUlkID09PSBwYXRod2F5SWQgJiYgdmFsLnBhdGh3YXlTdGFnZSA9PT0gcGF0aHdheVN0YWdlICYmIHZhbC5zdGFuZGFyZCA9PT0gc3RhbmRhcmQgJiYgdmFsLml0ZW0gPT09IGl0ZW07XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gaXRlbXMubGVuZ3RoID09PSAxID8gaXRlbXNbMF0ucmVhc29uIHx8IHt9IDoge307XHJcbiAgfSxcclxuXHJcbiAgZWRpdFBhdGllbnRBZ3JlZTogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQsIGl0ZW0sIGFncmVlLCByZWFzb24pIHtcclxuICAgIHZhciBvYmogPSBsb2cuZ2V0T2JqKCk7XHJcbiAgICBpZiAoIXBhdGh3YXlJZCB8fCAhcGF0aHdheVN0YWdlKSBhbGVydChcIkVESVRQQVRJRU5UQUdSRUVcIik7XHJcblxyXG4gICAgaWYgKCFvYmouYWdyZWVzW3BhdGllbnRJZF0pIG9iai5hZ3JlZXNbcGF0aWVudElkXSA9IFtdO1xyXG4gICAgdmFyIGl0ZW1zID0gb2JqLmFncmVlc1twYXRpZW50SWRdLmZpbHRlcihmdW5jdGlvbih2YWwpIHtcclxuICAgICAgcmV0dXJuIHZhbC5wYXRod2F5SWQgPT09IHBhdGh3YXlJZCAmJiB2YWwucGF0aHdheVN0YWdlID09PSBwYXRod2F5U3RhZ2UgJiYgdmFsLnN0YW5kYXJkID09PSBzdGFuZGFyZCAmJiB2YWwuaXRlbSA9PT0gaXRlbTtcclxuICAgIH0pO1xyXG5cclxuICAgIHZhciBsb2dUZXh0ID0gXCJZb3UgXCIgKyAoYWdyZWUgPyBcIlwiIDogXCJkaXNcIikgKyBcImFncmVlZCB3aXRoIHRoaXMgb24gXCIgKyAobmV3IERhdGUoKSkudG9EYXRlU3RyaW5nKCk7XHJcblxyXG4gICAgaWYgKGl0ZW1zLmxlbmd0aCA9PT0gMSkge1xyXG4gICAgICBpdGVtc1swXS5hZ3JlZSA9IGFncmVlO1xyXG4gICAgICBpdGVtc1swXS5oaXN0b3J5LnB1c2gobG9nVGV4dCk7XHJcbiAgICAgIGl0ZW1zWzBdLnJlYXNvbiA9IHJlYXNvbjtcclxuICAgIH0gZWxzZSBpZiAoaXRlbXMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIG9iai5hZ3JlZXNbcGF0aWVudElkXS5wdXNoKHtcclxuICAgICAgICBcInBhdGh3YXlJZFwiOiBwYXRod2F5SWQsXHJcbiAgICAgICAgXCJwYXRod2F5U3RhZ2VcIjogcGF0aHdheVN0YWdlLFxyXG4gICAgICAgIFwic3RhbmRhcmRcIjogc3RhbmRhcmQsXHJcbiAgICAgICAgXCJpdGVtXCI6IGl0ZW0sXHJcbiAgICAgICAgXCJhZ3JlZVwiOiBhZ3JlZSxcclxuICAgICAgICBcInJlYXNvblwiOiByZWFzb24sXHJcbiAgICAgICAgXCJoaXN0b3J5XCI6IFtsb2dUZXh0XVxyXG4gICAgICB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKFwiRVJST1JSUiEhISEhISFcIik7XHJcbiAgICB9XHJcblxyXG4gICAgbG9nLnNldE9iaihvYmopO1xyXG4gICAgbm90aWZ5LnNob3dTYXZlZCgpO1xyXG4gIH0sXHJcblxyXG4gIGdldEFncmVlczogZnVuY3Rpb24oKXtcclxuICAgIHJldHVybiBsb2cuZ2V0T2JqKFt7XHJcbiAgICAgIG5hbWU6IFwiYWdyZWVzXCIsXHJcbiAgICAgIHZhbHVlOiB7fVxyXG4gICAgfV0pLmFncmVlcztcclxuICB9LFxyXG5cclxuICBnZXRQYXRpZW50QWdyZWVPYmplY3Q6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkLCBpdGVtKSB7XHJcbiAgICB2YXIgb2JqID0gbG9nLmdldE9iaihbe1xyXG4gICAgICBuYW1lOiBcImFncmVlc1wiLFxyXG4gICAgICB2YWx1ZToge31cclxuICAgIH1dKTtcclxuICAgIGlmICghcGF0aHdheUlkIHx8ICFwYXRod2F5U3RhZ2UpIGFsZXJ0KFwiRURJVFBBVElFTlRBR1JFRVwiKTtcclxuXHJcbiAgICBpZiAoIW9iai5hZ3JlZXNbcGF0aWVudElkXSkgb2JqLmFncmVlc1twYXRpZW50SWRdID0gW107XHJcbiAgICB2YXIgaXRlbXMgPSBvYmouYWdyZWVzW3BhdGllbnRJZF0uZmlsdGVyKGZ1bmN0aW9uKHZhbCkge1xyXG4gICAgICByZXR1cm4gdmFsLnBhdGh3YXlJZCA9PT0gcGF0aHdheUlkICYmIHZhbC5wYXRod2F5U3RhZ2UgPT09IHBhdGh3YXlTdGFnZSAmJiB2YWwuc3RhbmRhcmQgPT09IHN0YW5kYXJkICYmIHZhbC5pdGVtID09PSBpdGVtO1xyXG4gICAgfSk7XHJcbiAgICBpZiAoaXRlbXMubGVuZ3RoID09PSAxKSByZXR1cm4gaXRlbXNbMF07XHJcbiAgICByZXR1cm4ge307XHJcbiAgfSxcclxuXHJcbiAgZ2V0UGF0aWVudEFncmVlOiBmdW5jdGlvbihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCwgaXRlbSkge1xyXG4gICAgdmFyIG9iaiA9IGxvZy5nZXRPYmooW3tcclxuICAgICAgbmFtZTogXCJhZ3JlZXNcIixcclxuICAgICAgdmFsdWU6IHt9XHJcbiAgICB9XSk7XHJcblxyXG4gICAgaWYgKCFvYmouYWdyZWVzW3BhdGllbnRJZF0pIHJldHVybiBudWxsO1xyXG4gICAgdmFyIGl0ZW0yID0gb2JqLmFncmVlc1twYXRpZW50SWRdLmZpbHRlcihmdW5jdGlvbih2YWwpIHtcclxuICAgICAgcmV0dXJuIHZhbC5wYXRod2F5SWQgPT09IHBhdGh3YXlJZCAmJiB2YWwucGF0aHdheVN0YWdlID09PSBwYXRod2F5U3RhZ2UgJiYgdmFsLnN0YW5kYXJkID09PSBzdGFuZGFyZCAmJiB2YWwuaXRlbSA9PT0gaXRlbTtcclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChpdGVtLmxlbmd0aCA9PT0gMSkge1xyXG4gICAgICByZXR1cm4gaXRlbVswXS5hZ3JlZTtcclxuICAgIH1cclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGxvZztcclxuIiwibW9kdWxlLmV4cG9ydHMgPSB7XHJcbiAgXCJjdXJyZW50VXJsXCI6IFwiXCIsXHJcbiAgXCJvcHRpb25zXCI6IFtdLFxyXG4gIFwiY2F0ZWdvcmllc1wiOiB7XHJcbiAgICBcImRpYWdub3Npc1wiOiB7XHJcbiAgICAgIFwibmFtZVwiOiBcImRpYWdub3Npc1wiLFxyXG4gICAgICBcImRpc3BsYXlcIjogXCJEaWFnbm9zaXNcIlxyXG4gICAgfSxcclxuICAgIFwibW9uaXRvcmluZ1wiOiB7XHJcbiAgICAgIFwibmFtZVwiOiBcIm1vbml0b3JpbmdcIixcclxuICAgICAgXCJkaXNwbGF5XCI6IFwiTW9uaXRvcmluZ1wiXHJcbiAgICB9LFxyXG4gICAgXCJ0cmVhdG1lbnRcIjoge1xyXG4gICAgICBcIm5hbWVcIjogXCJ0cmVhdG1lbnRcIixcclxuICAgICAgXCJkaXNwbGF5XCI6IFwiQ29udHJvbFwiXHJcbiAgICB9LFxyXG4gICAgXCJleGNsdXNpb25zXCI6IHtcclxuICAgICAgXCJuYW1lXCI6IFwiZXhjbHVzaW9uc1wiLFxyXG4gICAgICBcImRpc3BsYXlcIjogXCJFeGNsdXNpb25zXCJcclxuICAgIH1cclxuICB9LFxyXG4gIFwiY2hhcnRzXCI6IHt9LFxyXG4gIFwicGF0aHdheUlkXCI6IFwiaHRuXCIsXHJcbiAgXCJjb2xvcnNcIjogWycjMWY3N2I0JywgJyNmZjdmMGUnLCAnIzJjYTAyYycsICcjZDYyNzI4JywgJyM5NDY3YmQnLCAnIzhjNTY0YicsICcjZTM3N2MyJywgJyM3ZjdmN2YnLCAnI2JjYmQyMicsICcjMTdiZWNmJ10sXHJcbiAgXCJtb25pdG9yZWRcIjoge1xyXG4gICAgXCJicFwiOiBcIkJsb29kIFByZXNzdXJlXCIsXHJcbiAgICBcImFzdGhtYVwiOiBcIlBlYWsgRXhwaXJhdG9yeSBGbG93XCJcclxuICB9XHJcbn07XHJcbiIsInZhciB0ZW1wbGF0ZSA9IHJlcXVpcmUoJy4vdGVtcGxhdGUuanMnKSxcclxuICBkYXRhID0gcmVxdWlyZSgnLi9kYXRhLmpzJyksXHJcbiAgYmFzZSA9IHJlcXVpcmUoJy4vYmFzZS5qcycpLFxyXG4gIGxheW91dCA9IHJlcXVpcmUoJy4vbGF5b3V0LmpzJyksXHJcbiAgd2VsY29tZSA9IHJlcXVpcmUoJy4vcGFuZWxzL3dlbGNvbWUuanMnKSxcclxuICBsb2cgPSByZXF1aXJlKCcuL2xvZy5qcycpLFxyXG4gIHBhdGllbnRWaWV3ID0gcmVxdWlyZSgnLi92aWV3cy9wYXRpZW50LmpzJyksXHJcbiAgTXVzdGFjaGUgPSByZXF1aXJlKCdtdXN0YWNoZScpO1xyXG5cclxudmFyIHN0YXRlcywgcGF0TG9va3VwLCBwYWdlLCBoYXNoO1xyXG5cclxuY29uc29sZS5sb2coXCJtYWluLmpzOiBkYXRhLmxhc3Rsb2FkZXI9IFwiICsgZGF0YS5sYXN0bG9hZGVyKTtcclxuZGF0YS5sYXN0bG9hZGVyID0gXCJtYWluLmpzXCI7XHJcblxyXG52YXIgbWFpbiA9IHtcclxuICBcInZlcnNpb25cIjogXCIyLjAuMFwiLFxyXG5cclxuICBoYXNoOiBoYXNoLFxyXG4gIGluaXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgbWFpbi5wcmVXaXJlVXBQYWdlcygpO1xyXG5cclxuICAgIGxvZy5sb2FkQWN0aW9ucyhmdW5jdGlvbigpIHtcclxuICAgICAgZGF0YS5nZXQobWFpbi53aXJlVXBQYWdlcyk7XHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICBvblNlbGVjdGVkOiBmdW5jdGlvbigkZSwgbmhzTnVtYmVyT2JqZWN0KSB7XHJcbiAgICAvL0hpZGUgdGhlIHN1Z2dlc3Rpb25zIHBhbmVsXHJcbiAgICAkKCcjc2VhcmNoLWJveCcpLmZpbmQoJy50dC1kcm9wZG93bi1tZW51JykuY3NzKCdkaXNwbGF5JywgJ25vbmUnKTtcclxuXHJcbiAgICBoaXN0b3J5LnB1c2hTdGF0ZShudWxsLCBudWxsLCAnI3BhdGllbnRzLycgKyBuaHNOdW1iZXJPYmplY3QuaWQpO1xyXG4gICAgdGVtcGxhdGUubG9hZENvbnRlbnQoJyNwYXRpZW50cy8nICsgbmhzTnVtYmVyT2JqZWN0LmlkLCB0cnVlKTtcclxuXHJcblxyXG4gICAgLy90ZW1wbGF0ZS5kaXNwbGF5U2VsZWN0ZWRQYXRpZW50KG5oc051bWJlck9iamVjdC5pZCk7XHJcbiAgfSxcclxuXHJcbiAgd2lyZVVwU2VhcmNoQm94OiBmdW5jdGlvbigpIHtcclxuICAgIGlmIChzdGF0ZXMpIHtcclxuICAgICAgc3RhdGVzLmNsZWFyUHJlZmV0Y2hDYWNoZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXRlcyA9IG5ldyBCbG9vZGhvdW5kKHtcclxuICAgICAgZGF0dW1Ub2tlbml6ZXI6IEJsb29kaG91bmQudG9rZW5pemVycy5vYmoud2hpdGVzcGFjZSgndmFsdWUnKSxcclxuICAgICAgcXVlcnlUb2tlbml6ZXI6IEJsb29kaG91bmQudG9rZW5pemVycy53aGl0ZXNwYWNlLFxyXG4gICAgICBsb2NhbDogJC5tYXAoZGF0YS5wYXRpZW50QXJyYXksIGZ1bmN0aW9uKHN0YXRlKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgIGlkOiBzdGF0ZSxcclxuICAgICAgICAgIHZhbHVlOiBwYXRMb29rdXAgPyBwYXRMb29rdXBbc3RhdGVdIDogc3RhdGVcclxuICAgICAgICB9O1xyXG4gICAgICB9KVxyXG4gICAgfSk7XHJcblxyXG4gICAgc3RhdGVzLmluaXRpYWxpemUodHJ1ZSk7XHJcblxyXG4gICAgJCgnI3NlYXJjaC1ib3gnKS5maW5kKCcudHlwZWFoZWFkJykudHlwZWFoZWFkKCdkZXN0cm95Jyk7XHJcbiAgICAkKCcjc2VhcmNoLWJveCcpLmZpbmQoJy50eXBlYWhlYWQnKS50eXBlYWhlYWQoe1xyXG4gICAgICAgIGhpbnQ6IHRydWUsXHJcbiAgICAgICAgaGlnaGxpZ2h0OiB0cnVlLFxyXG4gICAgICAgIG1pbkxlbmd0aDogMSxcclxuICAgICAgICBhdXRvc2VsZWN0OiB0cnVlXHJcbiAgICAgIH0sIHtcclxuICAgICAgICBuYW1lOiAncGF0aWVudHMnLFxyXG4gICAgICAgIGRpc3BsYXlLZXk6ICd2YWx1ZScsXHJcbiAgICAgICAgc291cmNlOiBzdGF0ZXMudHRBZGFwdGVyKCksXHJcbiAgICAgICAgdGVtcGxhdGVzOiB7XHJcbiAgICAgICAgICBlbXB0eTogW1xyXG4gICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiZW1wdHktbWVzc2FnZVwiPicsXHJcbiAgICAgICAgICAgICAgICAnJm5ic3A7ICZuYnNwOyBObyBtYXRjaGVzJyxcclxuICAgICAgICAgICAgICAnPC9kaXY+J1xyXG4gICAgICAgICAgICBdLmpvaW4oJ1xcbicpXHJcbiAgICAgICAgfVxyXG4gICAgICB9KS5vbigndHlwZWFoZWFkOnNlbGVjdGVkJywgbWFpbi5vblNlbGVjdGVkKVxyXG4gICAgICAub24oJ3R5cGVhaGVhZDphdXRvY29tcGxldGVkJywgbWFpbi5vblNlbGVjdGVkKTtcclxuXHJcbiAgICAkKCcjc2VhcmNoYnRuJykub24oJ21vdXNlZG93bicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgdmFsID0gJCgnLnR5cGVhaGVhZCcpLmVxKDApLnZhbCgpO1xyXG4gICAgICBpZiAoIXZhbCB8fCB2YWwgPT09IFwiXCIpIHZhbCA9ICQoJy50eXBlYWhlYWQnKS5lcSgxKS52YWwoKTtcclxuICAgICAgbWFpbi5vblNlbGVjdGVkKG51bGwsIHtcclxuICAgICAgICBcImlkXCI6IHZhbFxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIHdpcmVVcFBhZ2VzOiBmdW5jdGlvbigpIHtcclxuICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgIG1haW4ud2lyZVVwU2VhcmNoQm94KCk7XHJcblxyXG4gICAgJCgnI2RhdGEtZmlsZScpLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbihldnQpIHtcclxuICAgICAgJCgnI2RhdGEtZmlsZS13cmFwcGVyJykuYWRkQ2xhc3MoJ2Rpc2FibGVkJykudGV4dChcIkxvYWRpbmcuLi5cIik7XHJcbiAgICAgIHZhciBmaWxlID0gZXZ0LnRhcmdldC5maWxlc1swXTsgLy8gRmlsZUxpc3Qgb2JqZWN0XHJcbiAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xyXG5cclxuICAgICAgcmVhZGVyLm9ubG9hZCA9IChmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgdmFyIEpzb25PYmogPSBKU09OLnBhcnNlKGUudGFyZ2V0LnJlc3VsdCk7XHJcbiAgICAgICAgICBnZXREYXRhKG51bGwsIEpzb25PYmopO1xyXG4gICAgICAgICAgY29uc29sZS5sb2coSnNvbk9iaik7XHJcblxyXG4gICAgICAgICAgbWFpbi53aXJlVXBTZWFyY2hCb3goKTtcclxuXHJcbiAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkKCcjZGF0YS1maWxlLXdyYXBwZXInKS5oaWRlKDUwMCk7XHJcbiAgICAgICAgICB9LCAxMDAwKTtcclxuICAgICAgICB9O1xyXG4gICAgICB9KShmaWxlKTtcclxuXHJcbiAgICAgIHJlYWRlci5yZWFkQXNUZXh0KGZpbGUpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgJCgnI3BhdGllbnQtZmlsZScpLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbihldnQpIHtcclxuICAgICAgJCgnI3BhdGllbnQtZmlsZS13cmFwcGVyJykuYWRkQ2xhc3MoJ2Rpc2FibGVkJykudGV4dChcIkxvYWRpbmcuLi5cIik7XHJcbiAgICAgIHZhciBmaWxlID0gZXZ0LnRhcmdldC5maWxlc1swXTsgLy8gRmlsZUxpc3Qgb2JqZWN0XHJcbiAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xyXG5cclxuICAgICAgcmVhZGVyLm9ubG9hZCA9IChmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgdmFyIGxpbmVzID0gZS50YXJnZXQucmVzdWx0LnNwbGl0KFwiXFxuXCIpO1xyXG4gICAgICAgICAgcGF0TG9va3VwID0ge307XHJcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpbmVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBmaWVsZHMgPSBsaW5lc1tpXS5zcGxpdChcIixcIik7XHJcbiAgICAgICAgICAgIGlmIChmaWVsZHMubGVuZ3RoICE9PSAyKSBjb250aW51ZTtcclxuICAgICAgICAgICAgcGF0TG9va3VwW2ZpZWxkc1swXS50cmltKCldID0gZmllbGRzWzFdLnRyaW0oKTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBtYWluLndpcmVVcFNlYXJjaEJveCgpO1xyXG5cclxuICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICQoJyNwYXRpZW50LWZpbGUtd3JhcHBlcicpLmhpZGUoNTAwKTtcclxuICAgICAgICAgIH0sIDEwMDApO1xyXG4gICAgICAgIH07XHJcbiAgICAgIH0pKGZpbGUpO1xyXG5cclxuICAgICAgcmVhZGVyLnJlYWRBc1RleHQoZmlsZSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAkKCcjb3V0c3RhbmRpbmdUYXNrcycpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgJCgnI3dlbGNvbWUtdGFicyBsaScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgJCh0aGlzKS5jbG9zZXN0KCdsaScpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgdmFyIHRlbXBNdXN0ID0gJCgnI3dlbGNvbWUtdGFzay1saXN0JykuaHRtbCgpO1xyXG4gICAgICB2YXIgcmVuZGVyZWQgPSBNdXN0YWNoZS5yZW5kZXIodGVtcE11c3QpO1xyXG4gICAgICAkKCcjd2VsY29tZS10YWItY29udGVudCcpLmZhZGVPdXQoMTAwLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAkKHRoaXMpLmh0bWwocmVuZGVyZWQpO1xyXG4gICAgICAgIHdlbGNvbWUucG9wdWxhdGUoKTtcclxuICAgICAgICAkKHRoaXMpLmZhZGVJbigxMDApO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgICQoJyNjb21wbGV0ZWRUYXNrcycpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgJCgnI3dlbGNvbWUtdGFicyBsaScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgJCh0aGlzKS5jbG9zZXN0KCdsaScpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgdmFyIHRlbXBNdXN0ID0gJCgnI3dlbGNvbWUtdGFzay1saXN0JykuaHRtbCgpO1xyXG4gICAgICB2YXIgcmVuZGVyZWQgPSBNdXN0YWNoZS5yZW5kZXIodGVtcE11c3QpO1xyXG4gICAgICAkKCcjd2VsY29tZS10YWItY29udGVudCcpLmZhZGVPdXQoMTAwLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAkKHRoaXMpLmh0bWwocmVuZGVyZWQpO1xyXG4gICAgICAgIHdlbGNvbWUucG9wdWxhdGUodHJ1ZSk7XHJcbiAgICAgICAgJCh0aGlzKS5mYWRlSW4oMTAwKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpZiAobWFpbi5oYXNoICE9PSBsb2NhdGlvbi5oYXNoKSBsb2NhdGlvbi5oYXNoID0gbWFpbi5oYXNoO1xyXG4gICAgdGVtcGxhdGUubG9hZENvbnRlbnQobG9jYXRpb24uaGFzaCwgdHJ1ZSk7XHJcbiAgfSxcclxuXHJcbiAgcHJlV2lyZVVwUGFnZXM6IGZ1bmN0aW9uKCkge1xyXG4gICAgbGF5b3V0LnNob3dQYWdlKCdsb2dpbicpO1xyXG5cclxuICAgIC8vRXZlcnkgbGluayBlbGVtZW50IHN0b3JlcyBocmVmIGluIGhpc3RvcnlcclxuICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICdhLmhpc3RvcnknLCBmdW5jdGlvbigpIHtcclxuICAgICAgLy8ga2VlcCB0aGUgbGluayBpbiB0aGUgYnJvd3NlciBoaXN0b3J5XHJcbiAgICAgIGhpc3RvcnkucHVzaFN0YXRlKG51bGwsIG51bGwsIHRoaXMuaHJlZik7XHJcbiAgICAgIHRlbXBsYXRlLmxvYWRDb250ZW50KGxvY2F0aW9uLmhhc2gsIHRydWUpO1xyXG4gICAgICAvLyBkbyBub3QgZ2l2ZSBhIGRlZmF1bHQgYWN0aW9uXHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vQ2FsbGVkIHdoZW4gdGhlIGJhY2sgYnV0dG9uIGlzIGhpdFxyXG4gICAgJCh3aW5kb3cpLm9uKCdwb3BzdGF0ZScsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgdGVtcGxhdGUubG9hZENvbnRlbnQobG9jYXRpb24uaGFzaCwgdHJ1ZSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvL1RlbXBsYXRlc1xyXG4gICAgcGF0aWVudHNQYW5lbFRlbXBsYXRlID0gJCgnI3BhdGllbnRzLXBhbmVsJyk7XHJcbiAgICBhY3Rpb25QbGFuUGFuZWwgPSAkKCcjYWN0aW9uLXBsYW4tcGFuZWwnKTtcclxuICAgIHBhdGllbnRMaXN0ID0gJCgnI3BhdGllbnQtbGlzdCcpO1xyXG4gICAgc3VnZ2VzdGVkUGxhblRlbXBsYXRlID0gJCgnI3N1Z2dlc3RlZC1wbGFuLXRlbXBsYXRlJyk7XHJcbiAgICBpbmRpdmlkdWFsUGFuZWwgPSAkKCcjaW5kaXZpZHVhbC1wYW5lbCcpO1xyXG4gICAgdmFsdWVUcmVuZFBhbmVsID0gJCgnI3ZhbHVlLXRyZW5kLXBhbmVsJyk7XHJcbiAgICBtZWRpY2F0aW9uUGFuZWwgPSAkKCcjbWVkaWNhdGlvbnMtcGFuZWwnKTtcclxuICAgIGFjdGlvblBsYW5MaXN0ID0gJCgnI2FjdGlvbi1wbGFuLWxpc3QnKTtcclxuXHJcbiAgICAvL1NlbGVjdG9yc1xyXG4gICAgYm90dG9tTGVmdFBhbmVsID0gJCgnI2JvdHRvbS1sZWZ0LXBhbmVsJyk7XHJcbiAgICBib3R0b21SaWdodFBhbmVsID0gJCgnI2JvdHRvbS1yaWdodC1wYW5lbCcpO1xyXG4gICAgdG9wUGFuZWwgPSAkKCcjdG9wLXBhbmVsJyk7XHJcbiAgICB0b3BMZWZ0UGFuZWwgPSAkKCcjdG9wLWxlZnQtcGFuZWwnKTtcclxuICAgIHRvcFJpZ2h0UGFuZWwgPSAkKCcjdG9wLXJpZ2h0LXBhbmVsJyk7XHJcbiAgICBtaWRQYW5lbCA9ICQoJyNtaWQtcGFuZWwnKTtcclxuICAgIGZhckxlZnRQYW5lbCA9ICQoJyNsZWZ0LXBhbmVsJyk7XHJcbiAgICBmYXJSaWdodFBhbmVsID0gJCgnI3JpZ2h0LXBhbmVsJyk7XHJcbiAgfVxyXG4gICAgLyosXHJcbiAgICAgIFwiX2xvY2FsXCI6IGxvY2FsKi9cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gbWFpbjtcclxuIiwibW9kdWxlLmV4cG9ydHMgPSB7XHJcblxyXG4gIHNob3dTYXZlZDogZnVuY3Rpb24oKSB7XHJcbiAgICAkKFwiI3NhdmVkLW1lc3NhZ2VcIikuaGlkZSgpLnRvZ2dsZUNsYXNzKFwiaW5cIikuZmFkZUluKDMwMCk7XHJcbiAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgJChcIiNzYXZlZC1tZXNzYWdlXCIpLmZhZGVPdXQoMzAwLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAkKHRoaXMpLnRvZ2dsZUNsYXNzKFwiaW5cIik7XHJcbiAgICAgIH0pO1xyXG4gICAgfSwgMjAwMCk7XHJcbiAgfVxyXG5cclxufTtcclxuIiwidmFyIGJhc2UgPSByZXF1aXJlKCcuLi9iYXNlLmpzJyksXHJcbiAgZGF0YSA9IHJlcXVpcmUoJy4uL2RhdGEuanMnKSxcclxuICBxdWFsaXR5U3RhbmRhcmQgPSByZXF1aXJlKCcuL3F1YWxpdHlTdGFuZGFyZC5qcycpLFxyXG4gIG90aGVyQ29kZXMgPSByZXF1aXJlKCcuL290aGVyQ29kZXMuanMnKSxcclxuICBtZWRpY2F0aW9uID0gcmVxdWlyZSgnLi9tZWRpY2F0aW9uLmpzJyksXHJcbiAgdHJlbmQgPSByZXF1aXJlKCcuL3RyZW5kLmpzJyksXHJcbiAgaW5kaXZpZHVhbEFjdGlvblBsYW4gPSByZXF1aXJlKCcuL2luZGl2aWR1YWxBY3Rpb25QbGFuLmpzJyksXHJcbiAgbGF5b3V0ID0gcmVxdWlyZSgnLi4vbGF5b3V0LmpzJyksXHJcbiAgY2hhcnQgPSByZXF1aXJlKCcuLi9jaGFydC5qcycpLFxyXG4gIE11c3RhY2hlID0gcmVxdWlyZSgnbXVzdGFjaGUnKTtcclxuXHJcbnZhciBhbGwgPSB7XHJcblxyXG4gIHBvcHVsYXRlOiBmdW5jdGlvbigpIHtcclxuICAgIHZhciBwYXRpZW50cyA9IGRhdGEuZ2V0QWxsUGF0aWVudHMoKTtcclxuXHJcbiAgICB2YXIgbG9jYWxEYXRhID0ge1xyXG4gICAgICBcInBhdGllbnRzXCI6IHBhdGllbnRzLFxyXG4gICAgICBcIm5cIjogcGF0aWVudHMubGVuZ3RoLFxyXG4gICAgICBcImhlYWRlci1pdGVtc1wiOiBbe1xyXG4gICAgICAgIFwidGl0bGVcIjogXCJOSFMgbm8uXCIsXHJcbiAgICAgICAgXCJpc1VuU29ydGFibGVcIjogdHJ1ZVxyXG4gICAgICB9LCB7XHJcbiAgICAgICAgXCJ0aXRsZVwiOiBcIkFsbCBPcHBvcnR1bml0aWVzXCIsXHJcbiAgICAgICAgXCJ0aXRsZUhUTUxcIjogJyMgb2YgPGkgY2xhc3M9XCJmYSBmYS1mbGFnXCIgc3R5bGU9XCJjb2xvcjpyZWRcIj48L2k+JyxcclxuICAgICAgICBcImlzVW5Tb3J0YWJsZVwiOiB0cnVlLFxyXG4gICAgICAgIFwidG9vbHRpcFwiOiBcIlRvdGFsIG51bWJlciBvZiBpbXByb3ZlbWVudCBvcHBvcnR1bml0aWVzIGF2YWlsYWJsZSBhY3Jvc3MgYWxsIGNvbmRpdGlvbnNcIlxyXG4gICAgICB9XVxyXG4gICAgfTtcclxuXHJcbiAgICBsb2NhbERhdGEucGF0aWVudHMuc29ydChmdW5jdGlvbihhLCBiKSB7XHJcbiAgICAgIGlmIChhLml0ZW1zWzBdID09PSBiLml0ZW1zWzBdKSB7XHJcbiAgICAgICAgcmV0dXJuIDA7XHJcbiAgICAgIH1cclxuICAgICAgdmFyIEEgPSBOdW1iZXIoYS5pdGVtc1swXSk7XHJcbiAgICAgIHZhciBCID0gTnVtYmVyKGIuaXRlbXNbMF0pO1xyXG4gICAgICBpZiAoaXNOYU4oQSkgfHwgaXNOYU4oQikpIHtcclxuICAgICAgICBBID0gYS5pdGVtc1swXTtcclxuICAgICAgICBCID0gYi5pdGVtc1swXTtcclxuICAgICAgfVxyXG4gICAgICBpZiAoQSA+IEIpIHtcclxuICAgICAgICByZXR1cm4gLTE7XHJcbiAgICAgIH0gZWxzZSBpZiAoQSA8IEIpIHtcclxuICAgICAgICByZXR1cm4gMTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgYmFzZS5jcmVhdGVQYW5lbFNob3cocGF0aWVudExpc3QsIHBhdGllbnRzUGFuZWwsIGxvY2FsRGF0YSwge1xyXG4gICAgICBcImhlYWRlci1pdGVtXCI6ICQoXCIjcGF0aWVudC1saXN0LWhlYWRlci1pdGVtXCIpLmh0bWwoKSxcclxuICAgICAgXCJpdGVtXCI6ICQoJyNwYXRpZW50LWxpc3QtaXRlbScpLmh0bWwoKVxyXG4gICAgfSk7XHJcblxyXG4gICAgJCgnI3BhdGllbnRzLXBsYWNlaG9sZGVyJykuaGlkZSgpO1xyXG5cclxuICAgIGJhc2Uuc2V0dXBDbGlwYm9hcmQoJCgnLmJ0bi1jb3B5JyksIHRydWUpO1xyXG5cclxuICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuXHJcbiAgICB2YXIgYyA9IHBhdGllbnRzUGFuZWwuZmluZCgnZGl2LnRhYmxlLXNjcm9sbCcpLmdldE5pY2VTY3JvbGwoKTtcclxuICAgIGlmIChjICYmIGMubGVuZ3RoID4gMCkge1xyXG4gICAgICBjLnJlc2l6ZSgpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcGF0aWVudHNQYW5lbC5maW5kKCdkaXYudGFibGUtc2Nyb2xsJykubmljZVNjcm9sbCh7XHJcbiAgICAgICAgY3Vyc29yb3BhY2l0eW1pbjogMC4zLFxyXG4gICAgICAgIGN1cnNvcndpZHRoOiBcIjdweFwiLFxyXG4gICAgICAgIGhvcml6cmFpbGVuYWJsZWQ6IGZhbHNlXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIC8vU2hvdyBwYXRpZW50IHZpZXcgZnJvbSB0aGUgYWxsIHBhdGllbnQgc2NyZWVuXHJcbiAgc2hvd0luZGl2aWR1YWxQYXRpZW50VmlldzogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpIHtcclxuICAgIGRhdGEucGF0aWVudElkID0gcGF0aWVudElkO1xyXG5cclxuICAgIGRhdGEub3B0aW9ucy5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcclxuICAgICAgYSA9IGRhdGEuZ2V0UGF0aWVudFN0YXR1cyhwYXRpZW50SWQsIGEucGF0aHdheUlkLCBhLnBhdGh3YXlTdGFnZSwgYS5zdGFuZGFyZCk7XHJcbiAgICAgIGIgPSBkYXRhLmdldFBhdGllbnRTdGF0dXMocGF0aWVudElkLCBiLnBhdGh3YXlJZCwgYi5wYXRod2F5U3RhZ2UsIGIuc3RhbmRhcmQpO1xyXG5cclxuICAgICAgaWYgKGEgPT09IGIpIHJldHVybiAwO1xyXG4gICAgICBpZiAoYSA9PT0gXCJub3RcIikgcmV0dXJuIDE7XHJcbiAgICAgIGlmIChiID09PSBcIm5vdFwiKSByZXR1cm4gLTE7XHJcbiAgICAgIGlmIChhID09PSBcIm9rXCIpIHJldHVybiAxO1xyXG4gICAgICBpZiAoYiA9PT0gXCJva1wiKSByZXR1cm4gLTE7XHJcbiAgICAgIGFsZXJ0KFwiISEhISEhIVwiKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChwYXRod2F5SWQgPT09IG51bGwpIHtcclxuICAgICAgLy9TaG93IHBhdGllbnQgYnV0IGRvbid0IHNlbGVjdFxyXG4gICAgICB2YXIgcCA9IGJhc2UuY3JlYXRlUGFuZWwoJCgnI3BhdGllbnQtcGFuZWwnKSwge1xyXG4gICAgICAgIFwib3B0aW9uc1wiOiBkYXRhLm9wdGlvbnMsXHJcbiAgICAgICAgXCJudW1iZXJPZlN0YW5kYXJkc01pc3NlZFwiOiBkYXRhLm51bWJlck9mU3RhbmRhcmRzTWlzc2VkKHBhdGllbnRJZCksXHJcbiAgICAgICAgXCJuaHNOdW1iZXJcIjogZGF0YS5wYXRMb29rdXAgPyBkYXRhLnBhdExvb2t1cFtwYXRpZW50SWRdIDogcGF0aWVudElkLFxyXG4gICAgICAgIFwicGF0aWVudElkXCI6IHBhdGllbnRJZFxyXG4gICAgICB9LCB7XHJcbiAgICAgICAgXCJvcHRpb25cIjogJCgnI3BhdGllbnQtcGFuZWwtZHJvcC1kb3duLW9wdGlvbnMnKS5odG1sKClcclxuICAgICAgfSk7XHJcbiAgICAgIGZhclJpZ2h0UGFuZWwuaHRtbChwKS5zaG93KCk7XHJcbiAgICAgIGZhclJpZ2h0UGFuZWwucmVtb3ZlQ2xhc3MoJ3N0YW5kYXJkLW1pc3NlZC1wYWdlJykucmVtb3ZlQ2xhc3MoJ3N0YW5kYXJkLWFjaGlldmVkLXBhZ2UnKS5yZW1vdmVDbGFzcygnc3RhbmRhcmQtbm90LXJlbGV2YW50LXBhZ2UnKTtcclxuXHJcbiAgICAgICQoJ3NlbGVjdCcpLnNlbGVjdDIoe1xyXG4gICAgICAgIHRlbXBsYXRlUmVzdWx0OiBiYXNlLmZvcm1hdFN0YW5kYXJkLFxyXG4gICAgICAgIG1pbmltdW1SZXN1bHRzRm9yU2VhcmNoOiBJbmZpbml0eSxcclxuICAgICAgICBwbGFjZWhvbGRlcjogXCJQbGVhc2Ugc2VsZWN0IGFuIGltcHJvdmVtZW50IG9wcG9ydHVuaXR5IGFyZWEuLi5cIlxyXG4gICAgICB9KTtcclxuICAgICAgJCgnc3Bhbi5zZWxlY3QyLXNlbGVjdGlvbl9fcmVuZGVyZWQnKS5hdHRyKFwidGl0bGVcIiwgXCJcIik7XHJcbiAgICAgICQoJ3NlbGVjdCcpLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgbG9jYWxEYXRhID0gJCh0aGlzKS5maW5kKCc6c2VsZWN0ZWQnKS5kYXRhKCk7XHJcbiAgICAgICAgYWxsLnNob3dJbmRpdmlkdWFsUGF0aWVudFZpZXcobG9jYWxEYXRhLnBhdGh3YXlJZCwgbG9jYWxEYXRhLnBhdGh3YXlTdGFnZSwgbG9jYWxEYXRhLnN0YW5kYXJkLCBkYXRhLnBhdGllbnRJZCk7XHJcbiAgICAgIH0pLm9uKFwic2VsZWN0MjpvcGVuXCIsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIHBhbmVsID0gYmFzZS5jcmVhdGVQYW5lbCgkKCcjcGF0aWVudC1wYW5lbCcpLCB7XHJcbiAgICAgIFwib3B0aW9uc1wiOiBkYXRhLm9wdGlvbnMsXHJcbiAgICAgIFwibnVtYmVyT2ZTdGFuZGFyZHNNaXNzZWRcIjogZGF0YS5udW1iZXJPZlN0YW5kYXJkc01pc3NlZChwYXRpZW50SWQpLFxyXG4gICAgICBcInN0YW5kYXJkXCI6IGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0udGFiLnRpdGxlLFxyXG4gICAgICBcInBhdGh3YXlTdGFnZVwiOiBwYXRod2F5U3RhZ2UsXHJcbiAgICAgIFwibmhzTnVtYmVyXCI6IGRhdGEucGF0TG9va3VwID8gZGF0YS5wYXRMb29rdXBbcGF0aWVudElkXSA6IHBhdGllbnRJZCxcclxuICAgICAgXCJwYXRpZW50SWRcIjogcGF0aWVudElkXHJcbiAgICB9LCB7XHJcbiAgICAgIFwib3B0aW9uXCI6ICQoJyNwYXRpZW50LXBhbmVsLWRyb3AtZG93bi1vcHRpb25zJykuaHRtbCgpXHJcbiAgICB9KTtcclxuXHJcbiAgICBmYXJSaWdodFBhbmVsLmh0bWwoXCJcIik7XHJcbiAgICAkKCcjdGVtcC1oaWRkZW4nKS5odG1sKHBhbmVsKTtcclxuXHJcbiAgICB2YXIgYWN0aW9uUGxhbiA9IGluZGl2aWR1YWxBY3Rpb25QbGFuLmNyZWF0ZShwYXRod2F5U3RhZ2UpO1xyXG4gICAgJCgnI3RlbXAtaGlkZGVuICNwYXRpZW50LXBhbmVsLXJpZ2h0JykuaHRtbChhY3Rpb25QbGFuKTtcclxuXHJcbiAgICB2YXIgcXVhbFBhbmVsID0gcXVhbGl0eVN0YW5kYXJkLmNyZWF0ZShwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcbiAgICB2YXIgdHJlbmRQYW5lbCA9IHRyZW5kLmNyZWF0ZShwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcbiAgICB2YXIgbWVkUGFuZWwgPSBtZWRpY2F0aW9uLmNyZWF0ZShwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcbiAgICB2YXIgY29kZXNQYW5lbCA9IG90aGVyQ29kZXMuY3JlYXRlKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgIHZhciBtZWRDb2RlV3JhcHBlclBhbmVsID0gYmFzZS5jcmVhdGVQYW5lbCgkKCcjb3RoZXItY29kZXMtYW5kLW1lZHMtd3JhcHBlci1wYW5lbCcpKTtcclxuICAgICQoJyN0ZW1wLWhpZGRlbiAjcGF0aWVudC1wYW5lbC10b3AnKS5odG1sKHF1YWxQYW5lbCk7XHJcbiAgICAkKCcjdGVtcC1oaWRkZW4gI3BhdGllbnQtcGFuZWwtbGVmdCcpLmh0bWwoXCJcIikuYXBwZW5kKHRyZW5kUGFuZWwpLmFwcGVuZChtZWRDb2RlV3JhcHBlclBhbmVsKTtcclxuICAgICQoJyN0ZW1wLWhpZGRlbiAjbWVkQ29kZVdyYXBwZXJQYW5lbCcpLmFwcGVuZChtZWRQYW5lbCkuYXBwZW5kKGNvZGVzUGFuZWwpO1xyXG5cclxuICAgIGlmIChmYXJSaWdodFBhbmVsLmlzKCc6dmlzaWJsZScpKSB7XHJcbiAgICAgIGZhclJpZ2h0UGFuZWwuZmFkZU91dCgxMDAsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICQodGhpcykuaHRtbCgkKCcjdGVtcC1oaWRkZW4nKS5odG1sKCkpO1xyXG4gICAgICAgICQoJyN0ZW1wLWhpZGRlbicpLmh0bWwoXCJcIik7XHJcbiAgICAgICAgaW5kaXZpZHVhbEFjdGlvblBsYW4ud2lyZVVwKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgICAgICBxdWFsaXR5U3RhbmRhcmQud2lyZVVwKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgICAgICBiYXNlLndpcmVVcFN0YW5kYXJkRHJvcERvd24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBhbGwuc2hvd0luZGl2aWR1YWxQYXRpZW50Vmlldyk7XHJcbiAgICAgICAgdHJlbmQud2lyZVVwKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgICAgICBtZWRpY2F0aW9uLndpcmVVcChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcbiAgICAgICAgb3RoZXJDb2Rlcy53aXJlVXAocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gICAgICAgIGNoYXJ0LmRyYXdUcmVuZENoYXJ0KHBhdGllbnRJZCwgcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkKTtcclxuICAgICAgICAkKHRoaXMpLmZhZGVJbigxMDAsIGZ1bmN0aW9uKCkge30pO1xyXG4gICAgICB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGZhclJpZ2h0UGFuZWwuaHRtbCgkKCcjdGVtcC1oaWRkZW4nKS5odG1sKCkpO1xyXG4gICAgICAkKCcjdGVtcC1oaWRkZW4nKS5odG1sKFwiXCIpO1xyXG4gICAgICBpbmRpdmlkdWFsQWN0aW9uUGxhbi53aXJlVXAocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gICAgICBxdWFsaXR5U3RhbmRhcmQud2lyZVVwKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgICAgYmFzZS53aXJlVXBTdGFuZGFyZERyb3BEb3duKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgYWxsLnNob3dJbmRpdmlkdWFsUGF0aWVudFZpZXcpO1xyXG4gICAgICB0cmVuZC53aXJlVXAocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gICAgICBtZWRpY2F0aW9uLndpcmVVcChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcbiAgICAgIG90aGVyQ29kZXMud2lyZVVwKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgICAgY2hhcnQuZHJhd1RyZW5kQ2hhcnQocGF0aWVudElkLCBwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQpO1xyXG4gICAgICBmYXJSaWdodFBhbmVsLmZhZGVJbigxMDAsIGZ1bmN0aW9uKCkge30pO1xyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIHNob3c6IGZ1bmN0aW9uKGxvY2F0aW9uKSB7XHJcbiAgICBiYXNlLmNyZWF0ZVBhbmVsU2hvdygkKCcjYWxsLXBhdGllbnRzLXBhbmVsJyksIGxvY2F0aW9uLCB7XHJcbiAgICAgIFwiblwiOiBkYXRhLmdldEFsbFBhdGllbnRzKCkubGVuZ3RoXHJcbiAgICB9KTtcclxuXHJcbiAgICBwYXRpZW50c1BhbmVsID0gJCgnI3BhdGllbnRzJyk7XHJcblxyXG4gICAgcGF0aWVudHNQYW5lbC5vbignY2xpY2snLCAndGJvZHkgdHInLCBmdW5jdGlvbihlKSB7IC8vU2VsZWN0IGluZGl2aWR1YWwgcGF0aWVudCB3aGVuIHJvdyBjbGlja2VkXHJcbiAgICAgICQoJ1tkYXRhLXRvZ2dsZT1cInRvb2x0aXBcIl0nKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgICQodGhpcykudG9vbHRpcCgnZGVzdHJveScpO1xyXG4gICAgICBiYXNlLmNsZWFyQm94KCk7XHJcbiAgICAgICQoJy5saXN0LWl0ZW0nKS5yZW1vdmVDbGFzcygnaGlnaGxpZ2h0ZWQnKTtcclxuICAgICAgJCh0aGlzKS5hZGRDbGFzcygnaGlnaGxpZ2h0ZWQnKS5yZW1vdmVBdHRyKCd0aXRsZScpO1xyXG5cclxuICAgICAgdmFyIHBhdGllbnRJZCA9ICQodGhpcykuZmluZCgndGQgYnV0dG9uJykuYXR0cignZGF0YS1wYXRpZW50LWlkJyk7XHJcblxyXG4gICAgICBhbGwuc2hvd0luZGl2aWR1YWxQYXRpZW50VmlldyhudWxsLCBudWxsLCBudWxsLCBwYXRpZW50SWQpO1xyXG5cclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgfSkub24oJ2NsaWNrJywgJ3Rib2R5IHRyIGJ1dHRvbicsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgLy9kb24ndCB3YW50IHJvdyBzZWxlY3RlZCBpZiBqdXN0IGJ1dHRvbiBwcmVzc2VkP1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICBzaG93VmlldzogZnVuY3Rpb24ocGF0aWVudElkLCByZWxvYWQpIHtcclxuICAgICQoJyNtYWluVGl0bGUnKS5oaWRlKCk7XHJcbiAgICBiYXNlLnVwZGF0ZVRpdGxlKFwiTGlzdCBvZiBhbGwgcGF0aWVudHMgYXQgeW91ciBwcmFjdGljZVwiKTtcclxuXHJcbiAgICBpZiAoIXBhdGllbnRJZCkgZGF0YS5wYXRod2F5SWQgPSBcIlwiO1xyXG4gICAgaWYgKCFwYXRpZW50SWQgfHwgcmVsb2FkKSB7XHJcblxyXG4gICAgICBsYXlvdXQuc2hvd01haW5WaWV3KGRhdGEuZGlzZWFzZXMubGVuZ3RoKTtcclxuXHJcbiAgICAgIGJhc2Uuc3dpdGNoVG8xMTBMYXlvdXQoKTtcclxuICAgICAgYmFzZS5oaWRlQWxsUGFuZWxzKCk7XHJcblxyXG4gICAgICBhbGwuc2hvdyhmYXJMZWZ0UGFuZWwpO1xyXG4gICAgICBhbGwucG9wdWxhdGUoKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAocGF0aWVudElkKSB7XHJcbiAgICAgIGFsbC5zaG93SW5kaXZpZHVhbFBhdGllbnRWaWV3KG51bGwsIG51bGwsIG51bGwsIHBhdGllbnRJZCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB2YXIgdGVtcE11c3QgPSAkKCcjcGF0aWVudC1wYW5lbC1wbGFjZWhvbGRlcicpLmh0bWwoKTtcclxuICAgICAgZmFyUmlnaHRQYW5lbC5odG1sKE11c3RhY2hlLnJlbmRlcih0ZW1wTXVzdCkpLnNob3coKTtcclxuICAgIH1cclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBhbGw7XHJcbiIsInZhciBiYXNlID0gcmVxdWlyZSgnLi4vYmFzZS5qcycpLFxyXG5sb2cgPSByZXF1aXJlKCcuLi9sb2cuanMnKTtcclxuXHJcbnZhciBjb25maXJtID0ge1xyXG5cclxuICB3aXJlVXA6IGZ1bmN0aW9uKGFncmVlRGl2U2VsZWN0b3IsIHBhbmVsU2VsZWN0b3IsIHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkLCBpdGVtLCBkaXNhZ3JlZVRleHQpIHtcclxuICAgIGNvbmZpcm0ud2lyZVVwQWdyZWVEaXNhZ3JlZShhZ3JlZURpdlNlbGVjdG9yLCBsb2cuZ2V0UGF0aWVudEFncmVlT2JqZWN0KHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkLCBpdGVtKSk7XHJcblxyXG4gICAgcGFuZWxTZWxlY3Rvci5vbignY2hhbmdlJywgJy5idG4tdG9nZ2xlIGlucHV0W3R5cGU9Y2hlY2tib3hdJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIGNvbmZpcm0ud2lyZVVwQWdyZWVEaXNhZ3JlZShhZ3JlZURpdlNlbGVjdG9yLCBsb2cuZ2V0UGF0aWVudEFncmVlT2JqZWN0KHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkLCBpdGVtKSk7XHJcbiAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgIH0pLm9uKCdjbGljaycsICcuYnRuLXRvZ2dsZScsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgdmFyIGNoZWNrYm94ID0gJCh0aGlzKS5maW5kKFwiaW5wdXRbdHlwZT1jaGVja2JveF1cIik7XHJcbiAgICAgIHZhciBvdGhlciA9ICQodGhpcykucGFyZW50KCkuZmluZCgkKHRoaXMpLmhhc0NsYXNzKFwiYnRuLXllc1wiKSA/IFwiLmJ0bi1ub1wiIDogXCIuYnRuLXllc1wiKTtcclxuICAgICAgdmFyIEFDVElPTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoJ2lkJyk7XHJcbiAgICAgIGlmICgkKHRoaXMpLmhhc0NsYXNzKFwiYWN0aXZlXCIpICYmIG90aGVyLmhhc0NsYXNzKFwiaW5hY3RpdmVcIikpIHtcclxuICAgICAgICAvL3Vuc2VsZWN0aW5nXHJcbiAgICAgICAgaWYgKGNoZWNrYm94LnZhbCgpID09PSBcIm5vXCIpIHtcclxuICAgICAgICAgIGNvbmZpcm0ubGF1bmNoU3RhbmRhcmRNb2RhbChcIkRpc2FncmVlIHdpdGggXCIgKyBkaXNhZ3JlZVRleHQsIFwiP1wiLCBsb2cuZ2V0QWdyZWVSZWFzb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQsIGl0ZW0pLCB0cnVlLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgbG9nLmVkaXRQYXRpZW50QWdyZWUocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQsIGl0ZW0sIGZhbHNlLCBsb2cucmVhc29uLnJlYXNvblRleHQpO1xyXG4gICAgICAgICAgICBjb25maXJtLndpcmVVcEFncmVlRGlzYWdyZWUoYWdyZWVEaXZTZWxlY3RvciwgbG9nLmdldFBhdGllbnRBZ3JlZU9iamVjdChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCwgaXRlbSkpO1xyXG4gICAgICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICAgICAgICB9LCBudWxsLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgbG9nLmVkaXRQYXRpZW50QWdyZWUocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQsIGl0ZW0sIG51bGwsIFwiXCIpO1xyXG4gICAgICAgICAgICBvdGhlci5yZW1vdmVDbGFzcyhcImluYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICBjaGVja2JveC5yZW1vdmVBdHRyKFwiY2hlY2tlZFwiKTtcclxuICAgICAgICAgICAgY2hlY2tib3gucGFyZW50KCkucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XHJcbiAgICAgICAgICAgIGNvbmZpcm0ud2lyZVVwQWdyZWVEaXNhZ3JlZShhZ3JlZURpdlNlbGVjdG9yLCBsb2cuZ2V0UGF0aWVudEFncmVlT2JqZWN0KHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkLCBpdGVtKSk7XHJcbiAgICAgICAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgbG9nLmVkaXRQYXRpZW50QWdyZWUocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQsIGl0ZW0sIG51bGwpO1xyXG4gICAgICAgICAgb3RoZXIucmVtb3ZlQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSBpZiAoISQodGhpcykuaGFzQ2xhc3MoXCJhY3RpdmVcIikgJiYgb3RoZXIuaGFzQ2xhc3MoXCJhY3RpdmVcIikpIHtcclxuICAgICAgICAvL3ByZXZlbnQgY2xpY2tpbmcgb24gdW5zZWxlY3RlZCBvcHRpb24gb3IgaWYgdGhlIHJvdyBpcyBjb21wbGV0ZVxyXG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvL3NlbGVjdGluZ1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBpZiAoY2hlY2tib3gudmFsKCkgPT09IFwibm9cIikge1xyXG4gICAgICAgICAgY29uZmlybS5sYXVuY2hTdGFuZGFyZE1vZGFsKFwiRGlzYWdyZWUgd2l0aCBcIiArIGRpc2FncmVlVGV4dCwgXCJcIiwgXCJcIiwgZmFsc2UsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBsb2cuZWRpdFBhdGllbnRBZ3JlZShwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCwgaXRlbSwgZmFsc2UsIGxvZy5yZWFzb24ucmVhc29uVGV4dCk7XHJcbiAgICAgICAgICAgICQoc2VsZikucmVtb3ZlQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgY2hlY2tib3guYXR0cihcImNoZWNrZWRcIiwgXCJjaGVja2VkXCIpO1xyXG4gICAgICAgICAgICBjaGVja2JveC5wYXJlbnQoKS5hZGRDbGFzcyhcImFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgLy91bnNlbGVjdCBvdGhlclxyXG4gICAgICAgICAgICBvdGhlci5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKS5hZGRDbGFzcyhcImluYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICBvdGhlci5maW5kKFwiaW5wdXRbdHlwZT1jaGVja2JveF1cIikucHJvcChcImNoZWNrZWRcIiwgZmFsc2UpO1xyXG4gICAgICAgICAgICBjb25maXJtLndpcmVVcEFncmVlRGlzYWdyZWUoYWdyZWVEaXZTZWxlY3RvciwgbG9nLmdldFBhdGllbnRBZ3JlZU9iamVjdChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCwgaXRlbSkpO1xyXG4gICAgICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGxvZy5lZGl0UGF0aWVudEFncmVlKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkLCBpdGVtLCB0cnVlKTtcclxuICAgICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuXHJcbiAgICAgICAgICAvL3Vuc2VsZWN0IG90aGVyXHJcbiAgICAgICAgICBvdGhlci5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKS5hZGRDbGFzcyhcImluYWN0aXZlXCIpO1xyXG4gICAgICAgICAgb3RoZXIuZmluZChcImlucHV0W3R5cGU9Y2hlY2tib3hdXCIpLnByb3AoXCJjaGVja2VkXCIsIGZhbHNlKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIHdpcmVVcEFncmVlRGlzYWdyZWU6IGZ1bmN0aW9uKHNlbGVjdG9yLCBhZ3JlZU9iamVjdCkge1xyXG4gICAgaWYgKGFncmVlT2JqZWN0LmFncmVlID09PSB0cnVlKSB7XHJcbiAgICAgIHNlbGVjdG9yLmNoaWxkcmVuKCc6bnRoKDApJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICBzZWxlY3Rvci5jaGlsZHJlbignOm50aCgxKScpLmFkZENsYXNzKCdpbmFjdGl2ZScpO1xyXG4gICAgICBzZWxlY3Rvci5jaGlsZHJlbignOm50aCgwKScpLmF0dHIoXCJ0aXRsZVwiLCBjb25maXJtLmdldEFncmVlVG9vbHRpcChhZ3JlZU9iamVjdCkpLmF0dHIoXCJkYXRhLW9yaWdpbmFsLXRpdGxlXCIsIGNvbmZpcm0uZ2V0QWdyZWVUb29sdGlwKGFncmVlT2JqZWN0KSkudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgIHNlbGVjdG9yLmNoaWxkcmVuKCc6bnRoKDEpJykuYXR0cihcInRpdGxlXCIsIFwiXCIpLmF0dHIoXCJkYXRhLW9yaWdpbmFsLXRpdGxlXCIsIFwiXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICBzZWxlY3Rvci5wYXJlbnQoKS5hZGRDbGFzcygnc3VjY2VzcycpLnJlbW92ZUNsYXNzKCdkYW5nZXInKTtcclxuICAgIH0gZWxzZSBpZiAoYWdyZWVPYmplY3QuYWdyZWUgPT09IGZhbHNlKSB7XHJcbiAgICAgIHNlbGVjdG9yLmNoaWxkcmVuKCc6bnRoKDApJykuYWRkQ2xhc3MoJ2luYWN0aXZlJyk7XHJcbiAgICAgIHNlbGVjdG9yLmNoaWxkcmVuKCc6bnRoKDEpJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICBzZWxlY3Rvci5jaGlsZHJlbignOm50aCgwKScpLmF0dHIoXCJ0aXRsZVwiLCBcIlwiKS5hdHRyKFwiZGF0YS1vcmlnaW5hbC10aXRsZVwiLCBcIlwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgc2VsZWN0b3IuY2hpbGRyZW4oJzpudGgoMSknKS5hdHRyKFwidGl0bGVcIiwgY29uZmlybS5nZXREaXNncmVlVG9vbHRpcChhZ3JlZU9iamVjdCkpLmF0dHIoXCJkYXRhLW9yaWdpbmFsLXRpdGxlXCIsIGNvbmZpcm0uZ2V0RGlzZ3JlZVRvb2x0aXAoYWdyZWVPYmplY3QpKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgc2VsZWN0b3IucGFyZW50KCkuYWRkQ2xhc3MoJ2RhbmdlcicpLnJlbW92ZUNsYXNzKCdzdWNjZXNzJyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBzZWxlY3Rvci5jaGlsZHJlbignOm50aCgwKScpLmF0dHIoXCJ0aXRsZVwiLCBcIkNsaWNrIHRvIGFncmVlXCIpLmF0dHIoXCJkYXRhLW9yaWdpbmFsLXRpdGxlXCIsIFwiQ2xpY2sgdG8gYWdyZWVcIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgIHNlbGVjdG9yLmNoaWxkcmVuKCc6bnRoKDEpJykuYXR0cihcInRpdGxlXCIsIFwiQ2xpY2sgdG8gZGlzYWdyZWVcIikuYXR0cihcImRhdGEtb3JpZ2luYWwtdGl0bGVcIiwgXCJDbGljayB0byBkaXNhZ3JlZVwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgc2VsZWN0b3IucGFyZW50KCkucmVtb3ZlQ2xhc3MoJ3N1Y2Nlc3MnKS5yZW1vdmVDbGFzcygnZGFuZ2VyJyk7XHJcbiAgICB9XHJcbiAgfSxcclxuXHJcbiAgZ2V0QWdyZWVUb29sdGlwOiBmdW5jdGlvbihhZ3JlZU9iamVjdCkge1xyXG4gICAgcmV0dXJuIGFncmVlT2JqZWN0Lmhpc3RvcnlbYWdyZWVPYmplY3QuaGlzdG9yeS5sZW5ndGggLSAxXTtcclxuICB9LFxyXG5cclxuICBnZXREaXNncmVlVG9vbHRpcDogZnVuY3Rpb24oYWdyZWVPYmplY3QpIHtcclxuICAgIHJldHVybiBhZ3JlZU9iamVjdC5oaXN0b3J5W2FncmVlT2JqZWN0Lmhpc3RvcnkubGVuZ3RoIC0gMV0gKyBcIiBZb3Ugc2FpZDogXCIgKyBhZ3JlZU9iamVjdC5yZWFzb247XHJcbiAgfSxcclxuXHJcbiAgbGF1bmNoU3RhbmRhcmRNb2RhbDogZnVuY3Rpb24oaGVhZGVyLCB2YWx1ZSwgcmVhc29uLCBpc1VuZG8sIGNhbGxiYWNrT25TYXZlLCBjYWxsYmFja09uQ2FuY2VsLCBjYWxsYmFja09uVW5kbykge1xyXG4gICAgYmFzZS5sYXVuY2hNb2RhbCh7XHJcbiAgICAgIFwiaGVhZGVyXCI6IGhlYWRlcixcclxuICAgICAgXCJpc1VuZG9cIjogaXNVbmRvLFxyXG4gICAgICBcIml0ZW1cIjogdmFsdWUsXHJcbiAgICAgIFwicGxhY2Vob2xkZXJcIjogXCJQcm92aWRlIG1vcmUgaW5mb3JtYXRpb24gaGVyZS4uLlwiXHJcbiAgICB9LCBudWxsLCB2YWx1ZSwgcmVhc29uLCBjYWxsYmFja09uU2F2ZSwgY2FsbGJhY2tPbkNhbmNlbCwgY2FsbGJhY2tPblVuZG8pO1xyXG4gIH1cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGNvbmZpcm07XHJcbiIsInZhciBiYXNlID0gcmVxdWlyZSgnLi4vYmFzZS5qcycpLFxyXG4gIGRhdGEgPSByZXF1aXJlKCcuLi9kYXRhLmpzJyksXHJcbiAgY2hhcnQgPSByZXF1aXJlKCcuLi9jaGFydC5qcycpLFxyXG4gIHBhdGllbnRMaXN0ID0gcmVxdWlyZSgnLi9wYXRpZW50TGlzdC5qcycpO1xyXG5cclxudmFyIElEID0gXCJJTkRJQ0FUT1JfQkVOQ0hNQVJLXCI7XHJcblxyXG52YXIgaVRyZW5kID0ge1xyXG5cclxuICBzaG93OiBmdW5jdGlvbihwYW5lbCwgaXNBcHBlbmQsIHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCkge1xyXG5cclxuICAgIHZhciBlbGVtID0gJChcIjxkaXYgaWQ9J2JlbmNobWFyay1jaGFydCcgY2xhc3M9J2ZpdC10by1zY3JvbGxpbmctc2VjdGlvbi1oZWlnaHQnPjwvZGl2PlwiKTtcclxuXHJcbiAgICBpZiAoaXNBcHBlbmQpIHBhbmVsLmFwcGVuZChlbGVtKTtcclxuICAgIGVsc2UgcGFuZWwuaHRtbChlbGVtKTtcclxuXHJcbiAgICBjaGFydC5kcmF3QmVuY2htYXJrQ2hhcnRIQyhcImJlbmNobWFyay1jaGFydFwiLCBudWxsKTtcclxuXHJcbiAgfSxcclxuXHJcbiAgd2lyZVVwOiBmdW5jdGlvbigpIHtcclxuXHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gaVRyZW5kO1xyXG4iLCJ2YXIgZGF0YSA9IHJlcXVpcmUoJy4uL2RhdGEuanMnKSxcclxuICBjaGFydCA9IHJlcXVpcmUoJy4uL2NoYXJ0LmpzJyk7XHJcblxyXG52YXIgYmQgPSB7XHJcblxyXG4gIHdpcmVVcDogZnVuY3Rpb24oKSB7XHJcblxyXG4gIH0sXHJcblxyXG4gIHNob3c6IGZ1bmN0aW9uKHBhbmVsLCBpc0FwcGVuZCwgcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBzZWxlY3RTZXJpZXNGbikge1xyXG5cclxuICAgIHZhciBpbmRpY2F0b3JzID0gZGF0YS5nZXRJbmRpY2F0b3JEYXRhU3luYyhbcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkXS5qb2luKFwiLlwiKSk7XHJcblxyXG4gICAgdmFyIGRhdGFPYmogPSBpbmRpY2F0b3JzLm9wcG9ydHVuaXRpZXMubWFwKGZ1bmN0aW9uKG9wcCkge1xyXG4gICAgICB2YXIgYyA9IG9wcC52YWx1ZXNbMF0uc2xpY2UoKTtcclxuICAgICAgYy5zcGxpY2UoMCwgMSwgb3BwLm5hbWUpO1xyXG4gICAgICByZXR1cm4gYztcclxuICAgIH0pO1xyXG5cclxuICAgIGRhdGFPYmouc3BsaWNlKDAsIDAsIGluZGljYXRvcnMub3Bwb3J0dW5pdGllc1swXS52YWx1ZXNbMV0pO1xyXG5cclxuICAgIHZhciBlbGVtID0gJChcIjxkaXYgaWQ9J2JyZWFrZG93bi1jaGFydCc+PC9kaXY+XCIpO1xyXG5cclxuICAgIGlmIChpc0FwcGVuZCkgcGFuZWwuYXBwZW5kKGVsZW0pO1xyXG4gICAgZWxzZSBwYW5lbC5odG1sKGVsZW0pO1xyXG5cclxuICAgIGNoYXJ0LmRyYXdBbmFseXRpY3MoXCJicmVha2Rvd24tY2hhcnRcIiwgZGF0YU9iaiwgc2VsZWN0U2VyaWVzRm4pO1xyXG5cclxuICAgIGJkLndpcmVVcCgpO1xyXG5cclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBiZDtcclxuIiwidmFyIGJhc2UgPSByZXF1aXJlKCcuLi9iYXNlLmpzJyksXHJcbiAgbG9nID0gcmVxdWlyZSgnLi4vbG9nLmpzJyksXHJcbiAgZGF0YSA9IHJlcXVpcmUoJy4uL2RhdGEuanMnKSxcclxuICBzcGFya2xpbmUgPSByZXF1aXJlKCdqcXVlcnktc3BhcmtsaW5lJyksXHJcbiAgTXVzdGFjaGUgPSByZXF1aXJlKCdtdXN0YWNoZScpO1xyXG5cclxudmFyIGluZGljYXRvckxpc3QgPSB7XHJcblxyXG4gIHNob3c6IGZ1bmN0aW9uKHBhbmVsLCBpc0FwcGVuZCwgbG9hZENvbnRlbnRGbikge1xyXG4gICAgZGF0YS5nZXRBbGxJbmRpY2F0b3JEYXRhKGZ1bmN0aW9uKGluZGljYXRvcnMpIHtcclxuXHJcbiAgICAgIHZhciB0ZW1wTXVzdCA9ICQoJyNvdmVydmlldy1wYW5lbC10YWJsZScpLmh0bWwoKTtcclxuICAgICAgdmFyIGh0bWwgPSBNdXN0YWNoZS5yZW5kZXIodGVtcE11c3QsIHtcclxuICAgICAgICBcImluZGljYXRvcnNcIjogaW5kaWNhdG9yc1xyXG4gICAgICB9KTtcclxuICAgICAgaWYgKGlzQXBwZW5kKSB7XHJcbiAgICAgICAgcGFuZWwuYXBwZW5kKGh0bWwpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHBhbmVsLmh0bWwoaHRtbCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgICQoJy5pbmxpbmVzcGFya2xpbmUnKS5zcGFya2xpbmUoJ2h0bWwnLCB7XHJcbiAgICAgICAgdG9vbHRpcEZvcm1hdHRlcjogZnVuY3Rpb24oc3BhcmtsaW5lLCBvcHRpb25zLCBmaWVsZHMpIHtcclxuICAgICAgICAgIHJldHVybiBpbmRpY2F0b3JzWyQoJy5pbmxpbmVzcGFya2xpbmUnKS5pbmRleChzcGFya2xpbmUuZWwpXS5kYXRlc1tmaWVsZHMueF0gKyBcIjogXCIgKyBmaWVsZHMueSArIFwiJVwiO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgd2lkdGg6IFwiMTAwcHhcIlxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGluZGljYXRvckxpc3Qud2lyZVVwKHBhbmVsLCBsb2FkQ29udGVudEZuKTtcclxuXHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICBwb3B1bGF0ZTogZnVuY3Rpb24oKSB7XHJcblxyXG4gIH0sXHJcblxyXG4gIHdpcmVVcDogZnVuY3Rpb24ocGFuZWwsIGxvYWRDb250ZW50Rm4pIHtcclxuICAgIHBhbmVsLm9mZignY2xpY2snLCAndHIuc3RhbmRhcmQtcm93Jyk7XHJcbiAgICBwYW5lbC5vbignY2xpY2snLCAndHIuc3RhbmRhcmQtcm93JywgZnVuY3Rpb24oZSkge1xyXG4gICAgICB2YXIgdXJsID0gJCh0aGlzKS5kYXRhKFwiaWRcIikucmVwbGFjZSgvXFwuL2csIFwiL1wiKTtcclxuICAgICAgaGlzdG9yeS5wdXNoU3RhdGUobnVsbCwgbnVsbCwgJyNpbmRpY2F0b3JzLycgKyB1cmwpO1xyXG4gICAgICBsb2FkQ29udGVudEZuKCcjaW5kaWNhdG9ycy8nICsgdXJsKTtcclxuICAgICAgLy8gZG8gbm90IGdpdmUgYSBkZWZhdWx0IGFjdGlvblxyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGluZGljYXRvckxpc3Q7XHJcbiIsInZhciBiYXNlID0gcmVxdWlyZSgnLi4vYmFzZS5qcycpLFxyXG4gIGRhdGEgPSByZXF1aXJlKCcuLi9kYXRhLmpzJyksXHJcbiAgY2hhcnQgPSByZXF1aXJlKCcuLi9jaGFydC5qcycpLFxyXG4gIHBhdGllbnRMaXN0ID0gcmVxdWlyZSgnLi9wYXRpZW50TGlzdC5qcycpO1xyXG5cclxudmFyIElEID0gXCJJTkRJQ0FUT1JfVFJFTkRcIjtcclxuXHJcbnZhciBpVHJlbmQgPSB7XHJcblxyXG4gIHNob3c6IGZ1bmN0aW9uKHBhbmVsLCBpc0FwcGVuZCwgcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkKSB7XHJcblxyXG4gICAgdmFyIGluZGljYXRvcnMgPSBkYXRhLmdldEFsbEluZGljYXRvckRhdGFTeW5jKCk7XHJcblxyXG4gICAgdmFyIGVsZW0gPSAkKFwiPGRpdiBpZD0ndHJlbmQtY2hhcnQnIGNsYXNzPSdmaXQtdG8tc2Nyb2xsaW5nLXNlY3Rpb24taGVpZ2h0Jz48L2Rpdj5cIik7XHJcblxyXG4gICAgaWYgKGlzQXBwZW5kKSBwYW5lbC5hcHBlbmQoZWxlbSk7XHJcbiAgICBlbHNlIHBhbmVsLmh0bWwoZWxlbSk7XHJcblxyXG4gICAgY2hhcnQuZHJhd1BlcmZvcm1hbmNlVHJlbmRDaGFydEhDKFwidHJlbmQtY2hhcnRcIiwgaW5kaWNhdG9ycy5maWx0ZXIoZnVuY3Rpb24odil7XHJcbiAgICAgIHJldHVybiB2LmlkPT09W3BhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZF0uam9pbihcIi5cIik7XHJcbiAgICB9KVswXSk7XHJcblxyXG4gIH0sXHJcblxyXG4gIHdpcmVVcDogZnVuY3Rpb24oKSB7XHJcblxyXG4gIH1cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGlUcmVuZDtcclxuIiwidmFyIGJhc2UgPSByZXF1aXJlKCcuLi9iYXNlLmpzJyksXHJcbiAgY29uZmlybSA9IHJlcXVpcmUoJy4vY29uZmlybS5qcycpLFxyXG4gIGRhdGEgPSByZXF1aXJlKCcuLi9kYXRhLmpzJyksXHJcbiAgbG9nID0gcmVxdWlyZSgnLi4vbG9nLmpzJyk7XHJcblxyXG52YXIgaWFwID0ge1xyXG5cclxuICBjcmVhdGU6IGZ1bmN0aW9uKHBhdGh3YXlTdGFnZSkge1xyXG4gICAgcmV0dXJuIGJhc2UuY3JlYXRlUGFuZWwoJCgnI2luZGl2aWR1YWwtYWN0aW9uLXBsYW4tcGFuZWwnKSwge1xyXG4gICAgICBcInBhdGh3YXlTdGFnZVwiOiBwYXRod2F5U3RhZ2UgfHwgXCJkZWZhdWx0XCIsXHJcbiAgICAgIFwibm9IZWFkZXJcIjogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgfSxcclxuXHJcbiAgc2hvdzogZnVuY3Rpb24ocGFuZWwsIHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKSB7XHJcbiAgICBwYW5lbC5odG1sKGlhcC5jcmVhdGUocGF0aHdheVN0YWdlKSk7XHJcbiAgICBpYXAud2lyZVVwKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuXHJcbiAgICBwYW5lbC5maW5kKCdkaXYuZml0LXRvLXNjcmVlbi1oZWlnaHQnKS5uaWNlU2Nyb2xsKHtcclxuICAgICAgY3Vyc29yb3BhY2l0eW1pbjogMC4zLFxyXG4gICAgICBjdXJzb3J3aWR0aDogXCI3cHhcIixcclxuICAgICAgaG9yaXpyYWlsZW5hYmxlZDogZmFsc2VcclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIHdpcmVVcDogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpIHtcclxuICAgIGluZGl2aWR1YWxUYWIgPSAkKCcjdGFiLXBsYW4taW5kaXZpZHVhbCcpO1xyXG5cclxuICAgICQoJyNhZHZpY2UtbGlzdCcpLm9uKCdjbGljaycsICcuY3Itc3R5bGVkIGlucHV0W3R5cGU9Y2hlY2tib3hdJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBBQ1RJT05JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKCdpZCcpO1xyXG4gICAgICBsb2cuZWRpdEFjdGlvbihkYXRhLnBhdGllbnRJZCwgQUNUSU9OSUQsIG51bGwsIHRoaXMuY2hlY2tlZCk7XHJcblxyXG4gICAgICBpZiAodGhpcy5jaGVja2VkKSB7XHJcbiAgICAgICAgbG9nLnJlY29yZEV2ZW50KHBhdGh3YXlJZCwgZGF0YS5wYXRpZW50SWQsIFwiSXRlbSBjb21wbGV0ZWRcIik7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgICQoc2VsZikucGFyZW50KCkuYXR0cihcInRpdGxlXCIsIFwiXCIpLmF0dHIoXCJkYXRhLW9yaWdpbmFsLXRpdGxlXCIsIFwiXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgJChzZWxmKS5wYXJlbnQoKS5mYWRlT3V0KDMwMCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBwYXJlbnQgPSAkKHRoaXMpLnBhcmVudCgpO1xyXG4gICAgICAgICAgICAkKHRoaXMpLnJlcGxhY2VXaXRoKGJhc2UuY3JlYXRlUGFuZWwoJCgnI2NoZWNrYm94LXRlbXBsYXRlJyksIHtcclxuICAgICAgICAgICAgICBcImRvbmVcIjogdHJ1ZVxyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgICAgICAgICAgcGFyZW50LmZpbmQoJ2J1dHRvbicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgIEFDVElPTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoJ2lkJyk7XHJcbiAgICAgICAgICAgICAgbG9nLmVkaXRBY3Rpb24oZGF0YS5wYXRpZW50SWQsIEFDVElPTklELCBudWxsLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgJCh0aGlzKS5yZXBsYWNlV2l0aChiYXNlLmNyZWF0ZVBhbmVsKCQoJyNjaGVja2JveC10ZW1wbGF0ZScpLCB7XHJcbiAgICAgICAgICAgICAgICBcImRvbmVcIjogZmFsc2VcclxuICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgaWFwLnVwZGF0ZUluZGl2aWR1YWxTYXBSb3dzKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSwgMTAwMCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlhcC51cGRhdGVJbmRpdmlkdWFsU2FwUm93cygpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgJCgnI3BlcnNvbmFsUGxhbkluZGl2aWR1YWwnKS5vbignY2xpY2snLCAnaW5wdXRbdHlwZT1jaGVja2JveF0nLCBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIFBMQU5JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKFwiaWRcIik7XHJcbiAgICAgIGxvZy5lZGl0UGxhbihQTEFOSUQsIG51bGwsIHRoaXMuY2hlY2tlZCk7XHJcblxyXG4gICAgICBpZiAodGhpcy5jaGVja2VkKSB7XHJcbiAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5wYXJlbnQoKS5wYXJlbnQoKS5hZGRDbGFzcygnc3VjY2VzcycpO1xyXG4gICAgICAgIGxvZy5yZWNvcmRFdmVudChwYXRod2F5SWQsIGRhdGEucGF0aWVudElkLCBcIlBlcnNvbmFsIHBsYW4gaXRlbVwiKTtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgJChzZWxmKS5wYXJlbnQoKS5hdHRyKFwidGl0bGVcIiwgXCJcIikuYXR0cihcImRhdGEtb3JpZ2luYWwtdGl0bGVcIiwgXCJcIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAkKHNlbGYpLnBhcmVudCgpLmZhZGVPdXQoMzAwLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIHBhcmVudCA9ICQodGhpcykucGFyZW50KCk7XHJcbiAgICAgICAgICAgICQodGhpcykucmVwbGFjZVdpdGgoYmFzZS5jcmVhdGVQYW5lbCgkKCcjY2hlY2tib3gtdGVtcGxhdGUnKSwge1xyXG4gICAgICAgICAgICAgIFwiZG9uZVwiOiB0cnVlXHJcbiAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgICAgICAgICBwYXJlbnQuZmluZCgnYnV0dG9uJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgUExBTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoJ2lkJyk7XHJcbiAgICAgICAgICAgICAgbG9nLmVkaXRQbGFuKGRhdGEucGF0aWVudElkLCBQTEFOSUQsIG51bGwsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAkKHRoaXMpLnJlcGxhY2VXaXRoKGJhc2UuY3JlYXRlUGFuZWwoJCgnI2NoZWNrYm94LXRlbXBsYXRlJyksIHtcclxuICAgICAgICAgICAgICAgIFwiZG9uZVwiOiBmYWxzZVxyXG4gICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgICBpYXAudXBkYXRlSW5kaXZpZHVhbFNhcFJvd3MoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9LCAxMDAwKTtcclxuICAgICAgfVxyXG4gICAgfSkub24oJ2NsaWNrJywgJy5idG4tdW5kbycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgdmFyIFBMQU5JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKCdpZCcpO1xyXG4gICAgICBsb2cuZWRpdFBsYW4oUExBTklELCBudWxsLCBmYWxzZSk7XHJcbiAgICAgICQodGhpcykucmVwbGFjZVdpdGgoYmFzZS5jcmVhdGVQYW5lbCgkKCcjY2hlY2tib3gtdGVtcGxhdGUnKSwge1xyXG4gICAgICAgIFwiZG9uZVwiOiBmYWxzZVxyXG4gICAgICB9KSk7XHJcbiAgICAgIGlhcC51cGRhdGVJbmRpdmlkdWFsU2FwUm93cygpO1xyXG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaW5kaXZpZHVhbFRhYi5vbignY2xpY2snLCAnLmVkaXQtcGxhbicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgUExBTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoXCJpZFwiKTtcclxuXHJcbiAgICAgICQoJyNlZGl0QWN0aW9uUGxhbkl0ZW0nKS52YWwoJCgkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuY2hpbGRyZW4oJ3RkJylbMF0pLmZpbmQoJ3NwYW4nKS50ZXh0KCkpO1xyXG5cclxuICAgICAgJCgnI2VkaXRQbGFuJykub2ZmKCdoaWRkZW4uYnMubW9kYWwnKS5vbignaGlkZGVuLmJzLm1vZGFsJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWFwLmRpc3BsYXlQZXJzb25hbGlzZWRJbmRpdmlkdWFsQWN0aW9uUGxhbihkYXRhLnBhdGllbnRJZCwgJCgnI3BlcnNvbmFsUGxhbkluZGl2aWR1YWwnKSk7XHJcbiAgICAgIH0pLm9mZignc2hvd24uYnMubW9kYWwnKS5vbignc2hvd24uYnMubW9kYWwnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAkKCcjZWRpdEFjdGlvblBsYW5JdGVtJykuZm9jdXMoKTtcclxuICAgICAgfSkub2ZmKCdjbGljaycsICcuc2F2ZS1wbGFuJykub24oJ2NsaWNrJywgJy5zYXZlLXBsYW4nLCBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgbG9nLmVkaXRQbGFuKFBMQU5JRCwgJCgnI2VkaXRBY3Rpb25QbGFuSXRlbScpLnZhbCgpKTtcclxuXHJcbiAgICAgICAgJCgnI2VkaXRQbGFuJykubW9kYWwoJ2hpZGUnKTtcclxuICAgICAgfSkub2ZmKCdrZXl1cCcsICcjZWRpdEFjdGlvblBsYW5JdGVtJykub24oJ2tleXVwJywgJyNlZGl0QWN0aW9uUGxhbkl0ZW0nLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgaWYgKGUud2hpY2ggPT09IDEzKSAkKCcjZWRpdFBsYW4gLnNhdmUtcGxhbicpLmNsaWNrKCk7XHJcbiAgICAgIH0pLm1vZGFsKCk7XHJcbiAgICB9KS5vbignY2xpY2snLCAnLmRlbGV0ZS1wbGFuJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBQTEFOSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YShcImlkXCIpO1xyXG5cclxuICAgICAgJCgnI2luZGl2aWR1YWwtZGVsZXRlLWl0ZW0nKS5odG1sKCQoJCh0aGlzKS5jbG9zZXN0KCd0cicpLmNoaWxkcmVuKCd0ZCcpWzBdKS5maW5kKCdzcGFuJykudGV4dCgpKTtcclxuXHJcbiAgICAgICQoJyNkZWxldGVQbGFuJykub2ZmKCdoaWRkZW4uYnMubW9kYWwnKS5vbignaGlkZGVuLmJzLm1vZGFsJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWFwLmRpc3BsYXlQZXJzb25hbGlzZWRJbmRpdmlkdWFsQWN0aW9uUGxhbihkYXRhLnBhdGllbnRJZCwgJCgnI3BlcnNvbmFsUGxhbkluZGl2aWR1YWwnKSk7XHJcbiAgICAgIH0pLm9mZignY2xpY2snLCAnLmRlbGV0ZS1wbGFuJykub24oJ2NsaWNrJywgJy5kZWxldGUtcGxhbicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGxvZy5kZWxldGVQbGFuKFBMQU5JRCk7XHJcblxyXG4gICAgICAgICQoJyNkZWxldGVQbGFuJykubW9kYWwoJ2hpZGUnKTtcclxuICAgICAgfSkubW9kYWwoKTtcclxuICAgIH0pLm9uKCdjbGljaycsICcuYWRkLXBsYW4nLCBmdW5jdGlvbigpIHtcclxuICAgICAgbG9nLnJlY29yZFBsYW4oZGF0YS5wYXRpZW50SWQsICQodGhpcykucGFyZW50KCkucGFyZW50KCkuZmluZCgndGV4dGFyZWEnKS52YWwoKSwgcGF0aHdheUlkKTtcclxuXHJcbiAgICAgIGlhcC5kaXNwbGF5UGVyc29uYWxpc2VkSW5kaXZpZHVhbEFjdGlvblBsYW4oZGF0YS5wYXRpZW50SWQsICQoJyNwZXJzb25hbFBsYW5JbmRpdmlkdWFsJykpO1xyXG4gICAgfSkub24oJ2NoYW5nZScsICcuYnRuLXRvZ2dsZSBpbnB1dFt0eXBlPWNoZWNrYm94XScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICBpYXAudXBkYXRlSW5kaXZpZHVhbFNhcFJvd3MoKTtcclxuICAgIH0pLm9uKCdjbGljaycsICcuYnRuLXVuZG8nLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIHZhciBBQ1RJT05JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKCdpZCcpO1xyXG4gICAgICBsb2cuZWRpdEFjdGlvbihkYXRhLnBhdGllbnRJZCwgQUNUSU9OSUQsIG51bGwsIGZhbHNlKTtcclxuICAgICAgJCh0aGlzKS5yZXBsYWNlV2l0aChiYXNlLmNyZWF0ZVBhbmVsKCQoJyNjaGVja2JveC10ZW1wbGF0ZScpLCB7XHJcbiAgICAgICAgXCJkb25lXCI6IGZhbHNlXHJcbiAgICAgIH0pKTtcclxuICAgICAgaWFwLnVwZGF0ZUluZGl2aWR1YWxTYXBSb3dzKCk7XHJcbiAgICB9KS5vbignY2xpY2snLCAnLmJ0bi15ZXMsLmJ0bi1ubycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgdmFyIGNoZWNrYm94ID0gJCh0aGlzKS5maW5kKFwiaW5wdXRbdHlwZT1jaGVja2JveF1cIik7XHJcbiAgICAgIHZhciBvdGhlciA9ICQodGhpcykucGFyZW50KCkuZmluZCgkKHRoaXMpLmhhc0NsYXNzKFwiYnRuLXllc1wiKSA/IFwiLmJ0bi1ub1wiIDogXCIuYnRuLXllc1wiKTtcclxuICAgICAgdmFyIEFDVElPTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoJ2lkJyk7XHJcbiAgICAgIGlmICgkKHRoaXMpLmhhc0NsYXNzKFwiYWN0aXZlXCIpICYmIG90aGVyLmhhc0NsYXNzKFwiaW5hY3RpdmVcIikgJiYgISQodGhpcykuY2xvc2VzdCgndHInKS5oYXNDbGFzcygnc3VjY2VzcycpKSB7XHJcbiAgICAgICAgLy91bnNlbGVjdGluZ1xyXG4gICAgICAgIGlmIChjaGVja2JveC52YWwoKSA9PT0gXCJub1wiKSB7XHJcbiAgICAgICAgICBpYXAubGF1bmNoTW9kYWwoZGF0YS5zZWxlY3RlZCwgY2hlY2tib3guY2xvc2VzdCgndHInKS5jaGlsZHJlbigpLmZpcnN0KCkuY2hpbGRyZW4oKS5maXJzdCgpLnRleHQoKSwgbG9nLmdldFJlYXNvbihkYXRhLnBhdGllbnRJZCwgQUNUSU9OSUQpLCB0cnVlLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgbG9nLmVkaXRBY3Rpb24oZGF0YS5wYXRpZW50SWQsIEFDVElPTklELCBmYWxzZSwgbnVsbCwgbG9nLnJlYXNvbik7XHJcbiAgICAgICAgICAgIGlhcC51cGRhdGVJbmRpdmlkdWFsU2FwUm93cygpO1xyXG4gICAgICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICAgICAgICB9LCBudWxsLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgbG9nLmlnbm9yZUFjdGlvbihkYXRhLnBhdGllbnRJZCwgQUNUSU9OSUQpO1xyXG4gICAgICAgICAgICBvdGhlci5yZW1vdmVDbGFzcyhcImluYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICBjaGVja2JveC5yZW1vdmVBdHRyKFwiY2hlY2tlZFwiKTtcclxuICAgICAgICAgICAgY2hlY2tib3gucGFyZW50KCkucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XHJcbiAgICAgICAgICAgIGlhcC51cGRhdGVJbmRpdmlkdWFsU2FwUm93cygpO1xyXG4gICAgICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGxvZy5pZ25vcmVBY3Rpb24oZGF0YS5wYXRpZW50SWQsIEFDVElPTklEKTtcclxuICAgICAgICAgIG90aGVyLnJlbW92ZUNsYXNzKFwiaW5hY3RpdmVcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2UgaWYgKCghJCh0aGlzKS5oYXNDbGFzcyhcImFjdGl2ZVwiKSAmJiBvdGhlci5oYXNDbGFzcyhcImFjdGl2ZVwiKSkgfHwgJCh0aGlzKS5jbG9zZXN0KCd0cicpLmhhc0NsYXNzKCdzdWNjZXNzJykpIHtcclxuICAgICAgICAvL3ByZXZlbnQgY2xpY2tpbmcgb24gdW5zZWxlY3RlZCBvcHRpb24gb3IgaWYgdGhlIHJvdyBpcyBjb21wbGV0ZVxyXG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvL3NlbGVjdGluZ1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBpZiAoY2hlY2tib3gudmFsKCkgPT09IFwibm9cIikge1xyXG4gICAgICAgICAgaWFwLmxhdW5jaE1vZGFsKGRhdGEuc2VsZWN0ZWQsIGNoZWNrYm94LmNsb3Nlc3QoJ3RyJykuY2hpbGRyZW4oKS5maXJzdCgpLmNoaWxkcmVuKCkuZmlyc3QoKS50ZXh0KCksIGxvZy5nZXRSZWFzb24oZGF0YS5wYXRpZW50SWQsIEFDVElPTklEKSwgZmFsc2UsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBsb2cuZWRpdEFjdGlvbihkYXRhLnBhdGllbnRJZCwgQUNUSU9OSUQsIGZhbHNlLCBudWxsLCBsb2cucmVhc29uKTtcclxuICAgICAgICAgICAgJChzZWxmKS5yZW1vdmVDbGFzcyhcImluYWN0aXZlXCIpO1xyXG5cclxuICAgICAgICAgICAgY2hlY2tib3guYXR0cihcImNoZWNrZWRcIiwgXCJjaGVja2VkXCIpO1xyXG4gICAgICAgICAgICBjaGVja2JveC5wYXJlbnQoKS5hZGRDbGFzcyhcImFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgLy91bnNlbGVjdCBvdGhlclxyXG4gICAgICAgICAgICBvdGhlci5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKS5hZGRDbGFzcyhcImluYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICBvdGhlci5maW5kKFwiaW5wdXRbdHlwZT1jaGVja2JveF1cIikucHJvcChcImNoZWNrZWRcIiwgZmFsc2UpO1xyXG4gICAgICAgICAgICBpYXAudXBkYXRlSW5kaXZpZHVhbFNhcFJvd3MoKTtcclxuICAgICAgICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBsb2cuZWRpdEFjdGlvbihkYXRhLnBhdGllbnRJZCwgQUNUSU9OSUQsIHRydWUpO1xyXG4gICAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcyhcImluYWN0aXZlXCIpO1xyXG5cclxuICAgICAgICAgIC8vdW5zZWxlY3Qgb3RoZXJcclxuICAgICAgICAgIG90aGVyLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpLmFkZENsYXNzKFwiaW5hY3RpdmVcIik7XHJcbiAgICAgICAgICBvdGhlci5maW5kKFwiaW5wdXRbdHlwZT1jaGVja2JveF1cIikucHJvcChcImNoZWNrZWRcIiwgZmFsc2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSkub24oJ2tleXVwJywgJ2lucHV0W3R5cGU9dGV4dF0nLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIGlmIChlLndoaWNoID09PSAxMykge1xyXG4gICAgICAgIGluZGl2aWR1YWxUYWIuZmluZCgnLmFkZC1wbGFuJykuY2xpY2soKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgaWFwLnBvcHVsYXRlSW5kaXZpZHVhbFN1Z2dlc3RlZEFjdGlvbnMocGF0aWVudElkLCBwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQpO1xyXG4gIH0sXHJcblxyXG4gIHVwZGF0ZUluZGl2aWR1YWxTYXBSb3dzOiBmdW5jdGlvbigpIHtcclxuICAgICQoJyNhZHZpY2UtbGlzdCcpLmFkZCgnI3BlcnNvbmFsUGxhbkluZGl2aWR1YWwnKS5maW5kKCcuc3VnZ2VzdGlvbicpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgICQodGhpcykuZmluZCgndGQnKS5sYXN0KCkuY2hpbGRyZW4oKS5oaWRlKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAkKCcjYWR2aWNlLWxpc3QnKS5hZGQoJyNwZXJzb25hbFBsYW5JbmRpdmlkdWFsJykuZmluZCgnLmNyLXN0eWxlZCBpbnB1dFt0eXBlPWNoZWNrYm94XScpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgIGlmICh0aGlzLmNoZWNrZWQpIHtcclxuICAgICAgICAkKHRoaXMpLnBhcmVudCgpLnBhcmVudCgpLnBhcmVudCgpLmFkZENsYXNzKCdzdWNjZXNzJyk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5wYXJlbnQoKS5wYXJlbnQoKS5yZW1vdmVDbGFzcygnc3VjY2VzcycpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAkKCcjYWR2aWNlLWxpc3QnKS5hZGQoJyNwZXJzb25hbFBsYW5JbmRpdmlkdWFsJykuZmluZCgnLmJ0bi11bmRvJykuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgJCh0aGlzKS5wYXJlbnQoKS5wYXJlbnQoKS5hZGRDbGFzcygnc3VjY2VzcycpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy9ubyBjbGFzcyAtIHVzZXIgbm90IHlldCBhZ3JlZWQvZGlzYWdyZWVkIC0gbm8gYmFja2dyb3VuZCAvIG11dGVkIHRleHRcclxuICAgIC8vYWN0aXZlIC0gdXNlciBhZ3JlZXMgLSBncmVlbiBiYWNrZ3JvdW5kIC8gbm9ybWFsIHRleHRcclxuICAgIC8vc3VjY2VzcyAtIHVzZXIgY29tcGxldGVkIC0gZ3JlZW4gYmFja2dyb3VuZCAvIHN0cmlrZXRocm91Z2ggdGV4dFxyXG4gICAgLy9kYW5nZXIgLSB1c2VyIGRpc2FncmVlcyAtIHJlZCBiYWNrZ3JvdW5kIC8gc3RyaWtldGhyb3VnaCB0ZXh0XHJcblxyXG4gICAgJCgnI2FkdmljZS1saXN0JykuYWRkKCcjcGVyc29uYWxQbGFuSW5kaXZpZHVhbCcpLmZpbmQoJ3RyJykuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIHNlbGYgPSAkKHRoaXMpO1xyXG4gICAgICB2YXIgYW55ID0gZmFsc2U7XHJcbiAgICAgIHNlbGYuZmluZCgnLmJ0bi10b2dnbGUgaW5wdXRbdHlwZT1jaGVja2JveF06Y2hlY2tlZCcpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgYW55ID0gdHJ1ZTtcclxuICAgICAgICBpZiAodGhpcy52YWx1ZSA9PT0gXCJ5ZXNcIikge1xyXG4gICAgICAgICAgc2VsZi5yZW1vdmVDbGFzcygnZGFuZ2VyJyk7XHJcbiAgICAgICAgICBzZWxmLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgIHNlbGYuZmluZCgndGQnKS5sYXN0KCkuY2hpbGRyZW4oKS5zaG93KCk7XHJcbiAgICAgICAgICBpZiAobG9nLmdldEFjdGlvbnMoKVtkYXRhLnBhdGllbnRJZF1bc2VsZi5kYXRhKFwiaWRcIildLmhpc3RvcnkpIHtcclxuICAgICAgICAgICAgdmFyIHRvb2wgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuaGFzQ2xhc3MoJ3N1Y2Nlc3MnKSA/IFwiXCIgOiBcIjxwPlwiICsgbG9nLmdldEFjdGlvbnMoKVtkYXRhLnBhdGllbnRJZF1bc2VsZi5kYXRhKFwiaWRcIildLmhpc3RvcnlbMF0gKyBcIjwvcD48cD5DbGljayBhZ2FpbiB0byBjYW5jZWw8L3A+XCI7XHJcbiAgICAgICAgICAgICQodGhpcykucGFyZW50KCkuYXR0cihcInRpdGxlXCIsIHRvb2wpLmF0dHIoXCJkYXRhLW9yaWdpbmFsLXRpdGxlXCIsIHRvb2wpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5hdHRyKFwidGl0bGVcIiwgXCJZb3UgYWdyZWVkIC0gY2xpY2sgYWdhaW4gdG8gY2FuY2VsXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBzZWxmLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgIHNlbGYuYWRkQ2xhc3MoJ2RhbmdlcicpO1xyXG4gICAgICAgICAgc2VsZi5yZW1vdmVDbGFzcygnc3VjY2VzcycpO1xyXG4gICAgICAgICAgaWYgKGxvZy5nZXRBY3Rpb25zKClbZGF0YS5wYXRpZW50SWRdW3NlbGYuZGF0YShcImlkXCIpXSAmJiBsb2cuZ2V0QWN0aW9ucygpW2RhdGEucGF0aWVudElkXVtzZWxmLmRhdGEoXCJpZFwiKV0uaGlzdG9yeSkge1xyXG4gICAgICAgICAgICAkKHRoaXMpLnBhcmVudCgpLmF0dHIoXCJ0aXRsZVwiLCBcIjxwPlwiICsgbG9nLmdldEFjdGlvbnMoKVtkYXRhLnBhdGllbnRJZF1bc2VsZi5kYXRhKFwiaWRcIildLmhpc3RvcnlbMF0gKyBcIjwvcD48cD5DbGljayBhZ2FpbiB0byBlZGl0L2NhbmNlbDwvcD5cIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAkKHRoaXMpLnBhcmVudCgpLmF0dHIoXCJ0aXRsZVwiLCBcIllvdSBkaXNhZ3JlZWQgLSBjbGljayBhZ2FpbiB0byBlZGl0L2NhbmNlbFwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgICBpZiAoc2VsZi5maW5kKCcuYnRuLXRvZ2dsZSBpbnB1dFt0eXBlPWNoZWNrYm94XTpub3QoOmNoZWNrZWQpJykubGVuZ3RoID09IDEpIHtcclxuICAgICAgICBzZWxmLmZpbmQoJy5idG4tdG9nZ2xlIGlucHV0W3R5cGU9Y2hlY2tib3hdOm5vdCg6Y2hlY2tlZCknKS5wYXJlbnQoKS5hZGRDbGFzcyhcImluYWN0aXZlXCIpLmF0dHIoXCJ0aXRsZVwiLCBcIlwiKS5hdHRyKFwiZGF0YS1vcmlnaW5hbC10aXRsZVwiLCBcIlwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAoIWFueSkge1xyXG4gICAgICAgIHNlbGYucmVtb3ZlQ2xhc3MoJ2RhbmdlcicpO1xyXG4gICAgICAgIHNlbGYucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgIHNlbGYucmVtb3ZlQ2xhc3MoJ3N1Y2Nlc3MnKTtcclxuXHJcbiAgICAgICAgc2VsZi5maW5kKCcuYnRuLXRvZ2dsZS5idG4teWVzJykuYXR0cihcInRpdGxlXCIsIFwiQ2xpY2sgdG8gYWdyZWUgd2l0aCB0aGlzIGFjdGlvbiBhbmQgc2F2ZSBpdCBpbiB5b3VyIGFncmVlZCBhY3Rpb25zIGxpc3QgIFwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgICBzZWxmLmZpbmQoJy5idG4tdG9nZ2xlLmJ0bi1ubycpLmF0dHIoXCJ0aXRsZVwiLCBcIkNsaWNrIHRvIGRpc2FncmVlIHdpdGggdGhpcyBhY3Rpb24gYW5kIHJlbW92ZSBpdCBmcm9tIHlvdXIgc3VnZ2VzdGVkIGFjdGlvbnMgbGlzdCBcIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgIH0pO1xyXG4gICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gIH0sXHJcblxyXG4gIGRpc3BsYXlQZXJzb25hbGlzZWRJbmRpdmlkdWFsQWN0aW9uUGxhbjogZnVuY3Rpb24oaWQsIHBhcmVudEVsZW0pIHtcclxuICAgIHZhciBwbGFucyA9IGJhc2Uuc29ydFN1Z2dlc3Rpb25zKGJhc2UuYWRkRGlzYWdyZWVQZXJzb25hbFRlYW0obG9nLmxpc3RQbGFucyhpZCkpKTtcclxuXHJcbiAgICBiYXNlLmNyZWF0ZVBhbmVsU2hvdyhhY3Rpb25QbGFuTGlzdCwgcGFyZW50RWxlbSwge1xyXG4gICAgICBcImhhc1N1Z2dlc3Rpb25zXCI6IHBsYW5zICYmIHBsYW5zLmxlbmd0aCA+IDAsXHJcbiAgICAgIFwic3VnZ2VzdGlvbnNcIjogcGxhbnNcclxuICAgIH0sIHtcclxuICAgICAgXCJhY3Rpb24tcGxhblwiOiAkKCcjYWN0aW9uLXBsYW4nKS5odG1sKCksXHJcbiAgICAgIFwiYWN0aW9uLXBsYW4taXRlbVwiOiAkKCcjYWN0aW9uLXBsYW4taXRlbScpLmh0bWwoKSxcclxuICAgICAgXCJjaGtcIjogJCgnI2NoZWNrYm94LXRlbXBsYXRlJykuaHRtbCgpXHJcbiAgICB9KTtcclxuXHJcbiAgICBpYXAudXBkYXRlSW5kaXZpZHVhbFNhcFJvd3MoKTtcclxuICB9LFxyXG5cclxuICBwb3B1bGF0ZUluZGl2aWR1YWxTdWdnZXN0ZWRBY3Rpb25zOiBmdW5jdGlvbihwYXRpZW50SWQsIHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCkge1xyXG4gICAgdmFyIGxvY2FsRGF0YSA9IHtcclxuICAgICAgXCJuaHNOdW1iZXJcIjogZGF0YS5wYXRMb29rdXAgPyBkYXRhLnBhdExvb2t1cFtwYXRpZW50SWRdIDogcGF0aWVudElkLFxyXG4gICAgICBcInBhdGllbnRJZFwiOiBwYXRpZW50SWRcclxuICAgIH07XHJcbiAgICB2YXIgYnJlYWNoZXMgPSBkYXRhLnBhdGllbnRzW3BhdGllbnRJZF0uYnJlYWNoID8gZGF0YS5wYXRpZW50c1twYXRpZW50SWRdLmJyZWFjaC5maWx0ZXIoZnVuY3Rpb24odikge1xyXG4gICAgICByZXR1cm4gdi5wYXRod2F5SWQgPT09IHBhdGh3YXlJZCAmJiB2LnBhdGh3YXlTdGFnZSA9PT0gcGF0aHdheVN0YWdlICYmIHYuc3RhbmRhcmQgPT09IHN0YW5kYXJkO1xyXG4gICAgfSkgOiBbXTtcclxuXHJcbiAgICB2YXIgZm4gPSBmdW5jdGlvbih2YWwpIHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBcImlkXCI6IHZhbCxcclxuICAgICAgICBcInN1YnNlY3Rpb25cIjogc3Vic2VjdGlvblxyXG4gICAgICB9O1xyXG4gICAgfTtcclxuXHJcbiAgICBpZiAoYnJlYWNoZXMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIGxvY2FsRGF0YS5ub1N1Z2dlc3Rpb25zID0gdHJ1ZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHZhciBzdWdnZXN0aW9ucyA9IFtdLFxyXG4gICAgICAgIHN1YnNlY3Rpb24gPSBcIlwiO1xyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGJyZWFjaGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgc3Vic2VjdGlvbiA9IGJyZWFjaGVzW2ldLnN1YnNlY3Rpb247XHJcbiAgICAgICAgc3VnZ2VzdGlvbnMgPSBzdWdnZXN0aW9ucy5jb25jYXQoZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uYmRvd25bc3Vic2VjdGlvbl0uc3VnZ2VzdGlvbnMgP1xyXG4gICAgICAgICAgZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uYmRvd25bc3Vic2VjdGlvbl0uc3VnZ2VzdGlvbnMubWFwKGZuKSA6IFtdKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgbG9jYWxEYXRhLnN1Z2dlc3Rpb25zID0gYmFzZS5zb3J0U3VnZ2VzdGlvbnMoYmFzZS5tZXJnZUluZGl2aWR1YWxTdHVmZihiYXNlLnN1Z2dlc3Rpb25MaXN0KHN1Z2dlc3Rpb25zKSwgcGF0aWVudElkKSk7XHJcbiAgICAgIGxvY2FsRGF0YS5zZWN0aW9uID0ge1xyXG4gICAgICAgIFwibmFtZVwiOiBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5iZG93bltzdWJzZWN0aW9uXS5uYW1lLFxyXG4gICAgICAgIFwiYWdyZWVcIjogbG9nLmdldFBhdGllbnRBZ3JlZShwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgcGF0aWVudElkLCBcInNlY3Rpb25cIikgPT09IHRydWUsXHJcbiAgICAgICAgXCJkaXNhZ3JlZVwiOiBsb2cuZ2V0UGF0aWVudEFncmVlKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBwYXRpZW50SWQsIFwic2VjdGlvblwiKSA9PT0gZmFsc2UsXHJcbiAgICAgIH07XHJcbiAgICAgIGxvY2FsRGF0YS5jYXRlZ29yeSA9IHtcclxuICAgICAgICBcIm5hbWVcIjogZGF0YS5wYXRpZW50c1twYXRpZW50SWRdLmNhdGVnb3J5LFxyXG4gICAgICAgIFwiYWdyZWVcIjogbG9nLmdldFBhdGllbnRBZ3JlZShwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgcGF0aWVudElkLCBcImNhdGVnb3J5XCIpID09PSB0cnVlLFxyXG4gICAgICAgIFwiZGlzYWdyZWVcIjogbG9nLmdldFBhdGllbnRBZ3JlZShwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgcGF0aWVudElkLCBcImNhdGVnb3J5XCIpID09PSBmYWxzZSxcclxuICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICAkKCcjYWR2aWNlLXBsYWNlaG9sZGVyJykuaGlkZSgpO1xyXG4gICAgJCgnI2FkdmljZScpLnNob3coKTtcclxuXHJcbiAgICBiYXNlLmNyZWF0ZVBhbmVsU2hvdyhpbmRpdmlkdWFsUGFuZWwsICQoJyNhZHZpY2UtbGlzdCcpLCBsb2NhbERhdGEsIHtcclxuICAgICAgXCJjaGtcIjogJCgnI2NoZWNrYm94LXRlbXBsYXRlJykuaHRtbCgpXHJcbiAgICB9KTtcclxuXHJcbiAgICAvL1dpcmUgdXAgYW55IGNsaXBib2FyZCBzdHVmZiBpbiB0aGUgc3VnZ2VzdGlvbnNcclxuICAgICQoJyNhZHZpY2UtbGlzdCcpLmZpbmQoJ3NwYW46Y29udGFpbnMoXCJbQ09QWVwiKScpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBodG1sID0gJCh0aGlzKS5odG1sKCk7XHJcbiAgICAgICQodGhpcykuaHRtbChodG1sLnJlcGxhY2UoL1xcW0NPUFk6KFteXFxdXSopXFxdL2csICckMSA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBkYXRhLWNsaXBib2FyZC10ZXh0PVwiJDFcIiBkYXRhLWNvbnRlbnQ9XCJDb3BpZWRcIiBkYXRhLXRvZ2dsZT1cInRvb2x0aXBcIiBkYXRhLXBsYWNlbWVudD1cInRvcFwiIHRpdGxlPVwiQ29weSAkMSB0byBjbGlwYm9hcmQuXCIgY2xhc3M9XCJidG4gYnRuLXhzIGJ0bi1kZWZhdWx0IGJ0bi1jb3B5XCI+PHNwYW4gY2xhc3M9XCJmYSBmYS1jbGlwYm9hcmRcIj48L3NwYW4+PC9idXR0b24+JykpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgJCgnI2FkdmljZS1saXN0JykuZmluZCgnc3Bhbjpjb250YWlucyhcIltJTkZPXCIpJykuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIGh0bWwgPSAkKHRoaXMpLmh0bWwoKTtcclxuICAgICAgdmFyIHN1YnNlY3Rpb24gPSAkKHRoaXMpLmRhdGEoKS5zdWJzZWN0aW9uO1xyXG4gICAgICB2YXIgZGVzYyA9IGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0ub3Bwb3J0dW5pdGllcy5maWx0ZXIoZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgICAgICByZXR1cm4gdmFsLm5hbWUgPT09IHN1YnNlY3Rpb247XHJcbiAgICAgICAgfSkubGVuZ3RoID4gMCA/XHJcbiAgICAgICAgZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS5vcHBvcnR1bml0aWVzLmZpbHRlcihmdW5jdGlvbih2YWwpIHtcclxuICAgICAgICAgIHJldHVybiB2YWwubmFtZSA9PT0gc3Vic2VjdGlvbjtcclxuICAgICAgICB9KVswXS5kZXNjIDogc3Vic2VjdGlvbjtcclxuICAgICAgdmFyIHRvb2x0aXAgPSBzdWJzZWN0aW9uID8gXCJUaGlzIGFjdGlvbiBpcyBzdWdnZXN0ZWQgYmVjYXVzZSBQSU5HUiBjbGFzc2lmaWVkIHRoaXMgcGF0aWVudCBhczonXCIgKyBkZXNjICsgXCInXCIgOiAnJztcclxuICAgICAgdmFyIG5ld0h0bWwgPSAnIDxpIGNsYXNzPVwiZmEgZmEtaW5mby1jaXJjbGUgZmEtbGcgaW5mby1idXR0b24gY2xpY2thYmxlXCIgZGF0YS10b2dnbGU9XCJ0b29sdGlwXCIgZGF0YS1wbGFjZW1lbnQ9XCJyaWdodFwiIHRpdGxlPVwiJyArIHRvb2x0aXAgKyAnXCI+PC9pPic7XHJcbiAgICAgICQodGhpcykuaHRtbChodG1sLnJlcGxhY2UoL1xcW0lORk9cXF0vZywgbmV3SHRtbCkpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgJCgnI2FkdmljZS1saXN0JykuZmluZCgnc3Bhbjpjb250YWlucyhcIltNRUQtU1VHR0VTVElPTlwiKScpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBodG1sID0gJCh0aGlzKS5odG1sKCk7XHJcbiAgICAgIHZhciBzdWdnZXN0aW9uID0gTWF0aC5yYW5kb20oKSA8IDAuMzMgPyBcIkluY3JlYXNlIFJhbWlwcmlsIHRvIDEwbWcgcGVyIGRheVwiIDogKE1hdGgucmFuZG9tKCkgPCAwLjUgPyBcIkNvbnNpZGVyIGFkZGluZyBhbiBBQ0UgaW5oaWJpb3JcIiA6IFwiQ29uc2lkZXIgYWRkaW5nIGEgdGhpYXppZGUtbGlrZSBkaXVyZXRpY1wiKTtcclxuICAgICAgJCh0aGlzKS5odG1sKGh0bWwucmVwbGFjZSgvXFxbTUVEXFwtU1VHR0VTVElPTlxcXS9nLCBzdWdnZXN0aW9uKSk7XHJcbiAgICB9KTtcclxuXHJcblxyXG4gICAgYmFzZS5zZXR1cENsaXBib2FyZCgkKCcuYnRuLWNvcHknKSwgdHJ1ZSk7XHJcblxyXG4gICAgaWFwLmRpc3BsYXlQZXJzb25hbGlzZWRJbmRpdmlkdWFsQWN0aW9uUGxhbihwYXRpZW50SWQsICQoJyNwZXJzb25hbFBsYW5JbmRpdmlkdWFsJykpO1xyXG4gIH0sXHJcblxyXG4gIGxhdW5jaE1vZGFsOiBmdW5jdGlvbihsYWJlbCwgdmFsdWUsIHJlYXNvbiwgaXNVbmRvLCBjYWxsYmFja09uU2F2ZSwgY2FsbGJhY2tPbkNhbmNlbCwgY2FsbGJhY2tPblVuZG8pIHtcclxuICAgIHZhciByZWFzb25zID0gW3tcclxuICAgICAgXCJyZWFzb25cIjogXCJBbHJlYWR5IGRvbmUgdGhpc1wiLFxyXG4gICAgICBcInZhbHVlXCI6IFwiZG9uZVwiXHJcbiAgICB9LCB7XHJcbiAgICAgIFwicmVhc29uXCI6IFwiV291bGRuJ3Qgd29ya1wiLFxyXG4gICAgICBcInZhbHVlXCI6IFwibm93b3JrXCJcclxuICAgIH0sIHtcclxuICAgICAgXCJyZWFzb25cIjogXCJTb21ldGhpbmcgZWxzZVwiLFxyXG4gICAgICBcInZhbHVlXCI6IFwiZWxzZVwiXHJcbiAgICB9XTtcclxuICAgIGlmIChyZWFzb24gJiYgcmVhc29uLnJlYXNvbikge1xyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlYXNvbnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBpZiAocmVhc29uc1tpXS5yZWFzb24gPT09IHJlYXNvbi5yZWFzb24pIHtcclxuICAgICAgICAgIHJlYXNvbnNbaV0uY2hlY2tlZCA9IHRydWU7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGJhc2UubGF1bmNoTW9kYWwoe1xyXG4gICAgICBcImhlYWRlclwiOiBcIkRpc2FncmVlIHdpdGggYSBzdWdnZXN0ZWQgYWN0aW9uXCIsXHJcbiAgICAgIFwiaXNVbmRvXCI6IGlzVW5kbyxcclxuICAgICAgXCJpdGVtXCI6IHZhbHVlLFxyXG4gICAgICBcInBsYWNlaG9sZGVyXCI6IFwiUHJvdmlkZSBtb3JlIGluZm9ybWF0aW9uIGhlcmUuLi5cIixcclxuICAgICAgXCJyZWFzb25zXCI6IHJlYXNvbnNcclxuICAgIH0sIGxhYmVsLCB2YWx1ZSwgcmVhc29uID8gcmVhc29uLnJlYXNvblRleHQgOiBudWxsLCBjYWxsYmFja09uU2F2ZSwgY2FsbGJhY2tPbkNhbmNlbCwgY2FsbGJhY2tPblVuZG8pO1xyXG4gIH1cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGlhcDtcclxuIiwidmFyIEhpZ2hjaGFydHMgPSByZXF1aXJlKCdoaWdoY2hhcnRzL2hpZ2hzdG9jaycpLFxyXG4gIGJhc2UgPSByZXF1aXJlKCcuLi9iYXNlLmpzJyk7XHJcbnJlcXVpcmUoJ2hpZ2hjaGFydHMvaGlnaGNoYXJ0cy1tb3JlJykoSGlnaGNoYXJ0cyk7XHJcblxyXG52YXIgSUQgPSBcIkxJRkVMSU5FXCI7XHJcblxyXG52YXIgY29sb3VyID0ge1xyXG4gIGluZGV4OiAwLFxyXG4gIG5leHQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgaWYgKHRoaXMuaW5kZXggPj0gSGlnaGNoYXJ0cy5nZXRPcHRpb25zKCkuY29sb3JzLmxlbmd0aCkgdGhpcy5pbmRleCA9IDA7XHJcbiAgICByZXR1cm4gSGlnaGNoYXJ0cy5nZXRPcHRpb25zKCkuY29sb3JzW3RoaXMuaW5kZXgrK107XHJcbiAgfSxcclxuICByZXNldDogZnVuY3Rpb24oKSB7XHJcbiAgICB0aGlzLmluZGV4ID0gMDtcclxuICB9XHJcbn07XHJcblxyXG52YXIgbGwgPSB7XHJcbiAgY2hhcnRBcnJheTogW10sXHJcblxyXG4gIGRlc3Ryb3k6IGZ1bmN0aW9uKGVsZW1lbnRJZCkge1xyXG4gICAgJChlbGVtZW50SWQpLmh0bWwoJycpO1xyXG4gICAgJChlbGVtZW50SWQpLm9mZignbW91c2Vtb3ZlIHRvdWNobW92ZSB0b3VjaHN0YXJ0JywgJy5zeW5jLWNoYXJ0Jyk7XHJcblxyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBIaWdoY2hhcnRzLmNoYXJ0cy5sZW5ndGg7IGkrKykge1xyXG4gICAgICBpZiAoSGlnaGNoYXJ0cy5jaGFydHNbaV0gJiYgSGlnaGNoYXJ0cy5jaGFydHNbaV0ucmVuZGVyVG8uY2xhc3NOYW1lLmluZGV4T2YoXCJoLWNoYXJ0XCIpID4gLTEpIEhpZ2hjaGFydHMuY2hhcnRzW2ldLmRlc3Ryb3koKTtcclxuICAgIH1cclxuICB9LFxyXG5cclxuICBzaG93OiBmdW5jdGlvbihwYW5lbCwgaXNBcHBlbmQsIHBhdGllbnRJZCwgZGF0YSkge1xyXG5cclxuXHJcbiAgICB2YXIgZWxlbWVudCA9ICdsaWZlbGluZS1jaGFydCc7XHJcbiAgICB2YXIgZWxlbWVudElkID0gJyMnICsgZWxlbWVudDtcclxuXHJcbiAgICBsbC5kZXN0cm95KGVsZW1lbnRJZCk7XHJcblxyXG4gICAgaWYoaXNBcHBlbmQpIHBhbmVsLmFwcGVuZCgkKCc8ZGl2IGlkPVwiJyArIGVsZW1lbnQgKyAnXCI+PC9kaXY+JykpO1xyXG4gICAgZWxzZSBwYW5lbC5odG1sKCQoJzxkaXYgaWQ9XCInICsgZWxlbWVudCArICdcIj48L2Rpdj4nKSk7XHJcblxyXG4gICAgY29sb3VyLnJlc2V0KCk7XHJcbiAgICAvKipcclxuICAgICAqIEluIG9yZGVyIHRvIHN5bmNocm9uaXplIHRvb2x0aXBzIGFuZCBjcm9zc2hhaXJzLCBvdmVycmlkZSB0aGVcclxuICAgICAqIGJ1aWx0LWluIGV2ZW50cyB3aXRoIGhhbmRsZXJzIGRlZmluZWQgb24gdGhlIHBhcmVudCBlbGVtZW50LlxyXG4gICAgICovXHJcblxyXG4gICAgJChlbGVtZW50SWQpLm9uKCdtb3VzZW1vdmUgdG91Y2htb3ZlIHRvdWNoc3RhcnQnLCAnLnN5bmMtY2hhcnQnLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIHZhciBjaGFydCwgcG9pbnQsIGksIGV2ZW50LCBzZXJpZXM7XHJcblxyXG4gICAgICBmb3IgKGkgPSAxOyBpIDwgbGwuY2hhcnRBcnJheS5sZW5ndGggLSAyOyBpID0gaSArIDEpIHtcclxuICAgICAgICBjaGFydCA9IGxsLmNoYXJ0QXJyYXlbaV07XHJcbiAgICAgICAgZXZlbnQgPSBjaGFydC5wb2ludGVyLm5vcm1hbGl6ZShlLm9yaWdpbmFsRXZlbnQpOyAvLyBGaW5kIGNvb3JkaW5hdGVzIHdpdGhpbiB0aGUgY2hhcnRcclxuICAgICAgICAvL2lmIChpID09PSAwKSBjb25zb2xlLmxvZyhldmVudC5jaGFydFggKyBcIiAtLS0gXCIgKyBldmVudC5jaGFydFkpO1xyXG4gICAgICAgIHNlcmllcyA9IGkgPT09IDAgPyBNYXRoLm1heChNYXRoLm1pbihNYXRoLmZsb29yKCgxMzAgLSBldmVudC5jaGFydFkpIC8gMzQpLCBjaGFydC5zZXJpZXMubGVuZ3RoIC0gMSksIDApIDogMDtcclxuICAgICAgICBwb2ludCA9IGNoYXJ0LnNlcmllc1tzZXJpZXNdLnNlYXJjaFBvaW50KGV2ZW50LCB0cnVlKTsgLy8gR2V0IHRoZSBob3ZlcmVkIHBvaW50XHJcblxyXG4gICAgICAgIGlmIChwb2ludCkge1xyXG4gICAgICAgICAgcG9pbnQub25Nb3VzZU92ZXIoKTsgLy8gU2hvdyB0aGUgaG92ZXIgbWFya2VyXHJcbiAgICAgICAgICBjaGFydC50b29sdGlwLnJlZnJlc2gocG9pbnQpOyAvLyBTaG93IHRoZSB0b29sdGlwXHJcbiAgICAgICAgICBjaGFydC54QXhpc1swXS5kcmF3Q3Jvc3NoYWlyKGV2ZW50LCBwb2ludCk7IC8vIFNob3cgdGhlIGNyb3NzaGFpclxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICAvKipcclxuICAgICAqIE92ZXJyaWRlIHRoZSByZXNldCBmdW5jdGlvbiwgd2UgZG9uJ3QgbmVlZCB0byBoaWRlIHRoZSB0b29sdGlwcyBhbmQgY3Jvc3NoYWlycy5cclxuICAgICAqL1xyXG4gICAgLypIaWdoY2hhcnRzLlBvaW50ZXIucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICB9OyovXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTeW5jaHJvbml6ZSB6b29taW5nIHRocm91Z2ggdGhlIHNldEV4dHJlbWVzIGV2ZW50IGhhbmRsZXIuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIHN5bmNFeHRyZW1lcyhlKSB7XHJcbiAgICAgIHZhciB0aGlzQ2hhcnQgPSB0aGlzLmNoYXJ0O1xyXG5cclxuICAgICAgaWYgKGUudHJpZ2dlciAhPT0gJ3N5bmNFeHRyZW1lcycpIHsgLy8gUHJldmVudCBmZWVkYmFjayBsb29wXHJcbiAgICAgICAgSGlnaGNoYXJ0cy5lYWNoKGxsLmNoYXJ0QXJyYXksIGZ1bmN0aW9uKGNoYXJ0KSB7XHJcbiAgICAgICAgICBpZiAoY2hhcnQgIT09IHRoaXNDaGFydCkge1xyXG4gICAgICAgICAgICBpZiAoY2hhcnQuaW52ZXJ0ZWQpIHtcclxuICAgICAgICAgICAgICBpZiAoY2hhcnQueUF4aXNbMF0uc2V0RXh0cmVtZXMpIHsgLy8gSXQgaXMgbnVsbCB3aGlsZSB1cGRhdGluZ1xyXG4gICAgICAgICAgICAgICAgY2hhcnQueUF4aXNbMF0uc2V0RXh0cmVtZXMoZS5taW4sIGUubWF4LCB1bmRlZmluZWQsIGZhbHNlLCB7XHJcbiAgICAgICAgICAgICAgICAgIHRyaWdnZXI6ICdzeW5jRXh0cmVtZXMnXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgaWYgKGNoYXJ0LnhBeGlzWzBdLnNldEV4dHJlbWVzKSB7IC8vIEl0IGlzIG51bGwgd2hpbGUgdXBkYXRpbmdcclxuICAgICAgICAgICAgICAgIGNoYXJ0LnhBeGlzWzBdLnNldEV4dHJlbWVzKGUubWluLCBlLm1heCwgdW5kZWZpbmVkLCBmYWxzZSwge1xyXG4gICAgICAgICAgICAgICAgICB0cmlnZ2VyOiAnc3luY0V4dHJlbWVzJ1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG4gICAgdmFyIHBsb3RDb25kaXRpb25zID0gZnVuY3Rpb24oY29uZGl0aW9ucywgY29udGFjdHMpIHtcclxuICAgICAgdmFyIHNlcmllcyA9IFtdO1xyXG4gICAgICAkLmVhY2goY29uZGl0aW9ucy5yZXZlcnNlKCksIGZ1bmN0aW9uKGksIHRhc2spIHtcclxuICAgICAgICB2YXIgaXRlbSA9IHtcclxuICAgICAgICAgIG5hbWU6IHRhc2submFtZSxcclxuICAgICAgICAgIGRhdGE6IFtdLFxyXG4gICAgICAgICAgY29sb3I6IGNvbG91ci5uZXh0KClcclxuICAgICAgICB9O1xyXG4gICAgICAgICQuZWFjaCh0YXNrLmludGVydmFscywgZnVuY3Rpb24oaiwgaW50ZXJ2YWwpIHtcclxuICAgICAgICAgIGl0ZW0uZGF0YS5wdXNoKFtpICsgMC40OSwgaW50ZXJ2YWwuZnJvbSwgaW50ZXJ2YWwudG9dKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgc2VyaWVzLnB1c2goaXRlbSk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgdmFyIG1hcmtlcnMgPSB7XHJcbiAgICAgICAgXCJGYWNlIHRvIGZhY2VcIjoge1xyXG4gICAgICAgICAgXCJzeW1ib2xcIjogXCJzcXVhcmVcIixcclxuICAgICAgICAgIFwibGluZVdpZHRoXCI6IDEsXHJcbiAgICAgICAgICBcImxpbmVDb2xvclwiOiBcImJsYWNrXCIsXHJcbiAgICAgICAgICBcInJhZGl1c1wiOiA4XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcIlRlbGVwaG9uZVwiOiB7XHJcbiAgICAgICAgICBcInN5bWJvbFwiOiBcImNpcmNsZVwiLFxyXG4gICAgICAgICAgXCJsaW5lV2lkdGhcIjogMSxcclxuICAgICAgICAgIFwibGluZUNvbG9yXCI6IFwiYmxhY2tcIixcclxuICAgICAgICAgIFwicmFkaXVzXCI6IDhcclxuICAgICAgICB9LFxyXG4gICAgICAgIFwiSG9zcGl0YWwgYWRtaXNzaW9uXCI6IHtcclxuICAgICAgICAgIFwic3ltYm9sXCI6IFwidHJpYW5nbGVcIixcclxuICAgICAgICAgIFwibGluZVdpZHRoXCI6IDEsXHJcbiAgICAgICAgICBcImxpbmVDb2xvclwiOiBcImJsYWNrXCIsXHJcbiAgICAgICAgICBcInJhZGl1c1wiOiA4XHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG4gICAgICB2YXIgY29udGFjdFNlcmllcyA9IHt9O1xyXG4gICAgICAkLmVhY2goY29udGFjdHMsIGZ1bmN0aW9uKGksIGNvbnRhY3QpIHtcclxuICAgICAgICBpZiAoIWNvbnRhY3RTZXJpZXNbY29udGFjdC5uYW1lXSkge1xyXG4gICAgICAgICAgY29udGFjdFNlcmllc1tjb250YWN0Lm5hbWVdID0gSGlnaGNoYXJ0cy5leHRlbmQoY29udGFjdCwge1xyXG4gICAgICAgICAgICBkYXRhOiBbXSxcclxuICAgICAgICAgICAgdHlwZTogJ3NjYXR0ZXInLFxyXG4gICAgICAgICAgICBtYXJrZXI6IG1hcmtlcnNbY29udGFjdC5uYW1lXSxcclxuICAgICAgICAgICAgY29sb3I6IGNvbG91ci5uZXh0KClcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb250YWN0U2VyaWVzW2NvbnRhY3QubmFtZV0uZGF0YS5wdXNoKFtcclxuICAgICAgICAgICAgICBjb250YWN0LnRhc2ssXHJcbiAgICAgICAgICAgICAgY29udGFjdC50aW1lXHJcbiAgICAgICAgICBdKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBzZXJpZXMgPSBzZXJpZXMuY29uY2F0KE9iamVjdC5rZXlzKGNvbnRhY3RTZXJpZXMpLm1hcChmdW5jdGlvbihrZXkpIHtcclxuICAgICAgICByZXR1cm4gY29udGFjdFNlcmllc1trZXldO1xyXG4gICAgICB9KSk7XHJcblxyXG4gICAgICAvLyBjcmVhdGUgdGhlIGNoYXJ0XHJcbiAgICAgICQoJzxkaXYgY2xhc3M9XCJoLWNoYXJ0IGgtY29uZGl0aW9uLWNoYXJ0XCI+JylcclxuICAgICAgICAuYXBwZW5kVG8oZWxlbWVudElkKVxyXG4gICAgICAgIC5oaWdoY2hhcnRzKHtcclxuXHJcbiAgICAgICAgICBjaGFydDoge1xyXG4gICAgICAgICAgICByZW5kZXJUbzogZWxlbWVudCxcclxuICAgICAgICAgICAgbWFyZ2luTGVmdDogNDAsIC8vIEtlZXAgYWxsIGNoYXJ0cyBsZWZ0IGFsaWduZWRcclxuICAgICAgICAgICAgc3BhY2luZ1RvcDogMjAsXHJcbiAgICAgICAgICAgIHNwYWNpbmdCb3R0b206IDIwLFxyXG4gICAgICAgICAgICB0eXBlOiAnY29sdW1ucmFuZ2UnLFxyXG4gICAgICAgICAgICBpbnZlcnRlZDogdHJ1ZVxyXG4gICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICB0aXRsZToge1xyXG4gICAgICAgICAgICB0ZXh0OiAnJ1xyXG4gICAgICAgICAgfSxcclxuXHJcblxyXG4gICAgICAgICAgeUF4aXM6IHtcclxuICAgICAgICAgICAgdHlwZTogJ2RhdGV0aW1lJyxcclxuICAgICAgICAgICAgbWluOiBEYXRlLlVUQygyMDEzLCA2LCAxMiksXHJcbiAgICAgICAgICAgIG1heDogRGF0ZS5VVEMoMjAxNiwgMywgNSksXHJcbiAgICAgICAgICAgIGNyb3NzaGFpcjogdHJ1ZSxcclxuICAgICAgICAgICAgZXZlbnRzOiB7XHJcbiAgICAgICAgICAgICAgc2V0RXh0cmVtZXM6IHN5bmNFeHRyZW1lc1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBsYWJlbHM6IHtcclxuICAgICAgICAgICAgICBlbmFibGVkOiBmYWxzZVxyXG4gICAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgICAgLy90aGluZ3MgdGhhdCBhcmUgbm9ybWFsbHkgeEF4aXMgZGVmYXVsdHNcclxuICAgICAgICAgICAgZW5kT25UaWNrOiBmYWxzZSxcclxuICAgICAgICAgICAgZ3JpZExpbmVXaWR0aDogMCxcclxuICAgICAgICAgICAgbGluZVdpZHRoOiAxLFxyXG4gICAgICAgICAgICBtYXhQYWRkaW5nOiAwLjAxLFxyXG4gICAgICAgICAgICBtaW5QYWRkaW5nOiAwLjAxLFxyXG4gICAgICAgICAgICBzdGFydE9uVGljazogZmFsc2UsXHJcbiAgICAgICAgICAgIHRpY2tXaWR0aDogMCxcclxuICAgICAgICAgICAgdGl0bGU6IHtcclxuICAgICAgICAgICAgICB0ZXh0OiAnJ1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB0aWNrUGl4ZWxJbnRlcnZhbDogMTAwXHJcbiAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgIHhBeGlzOiB7XHJcbiAgICAgICAgICAgIGxhYmVsczoge1xyXG4gICAgICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHN0YXJ0T25UaWNrOiBmYWxzZSxcclxuICAgICAgICAgICAgZW5kT25UaWNrOiBmYWxzZSxcclxuICAgICAgICAgICAgdGl0bGU6IHtcclxuICAgICAgICAgICAgICB0ZXh0OiAnJ1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB0aWNrV2lkdGg6IDAsXHJcbiAgICAgICAgICAgIG1pblBhZGRpbmc6IDAuMixcclxuICAgICAgICAgICAgbWF4UGFkZGluZzogMC4yLFxyXG5cclxuICAgICAgICAgICAgLy90aGluZ3MgdGhhdCBhcmUgbm9ybWFsbHkgeUF4aXMgZGVmYXVsdHNcclxuICAgICAgICAgICAgZ3JpZExpbmVXaWR0aDogMCxcclxuICAgICAgICAgICAgbGluZVdpZHRoOiAwXHJcblxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIGNyZWRpdHM6IHtcclxuICAgICAgICAgICAgZW5hYmxlZDogZmFsc2VcclxuICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgbGVnZW5kOiB7XHJcbiAgICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlXHJcbiAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgIHRvb2x0aXA6IHtcclxuICAgICAgICAgICAgZm9ybWF0dGVyOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICBpZiAodGhpcy5zZXJpZXMuZGF0YVswXS54ICE9PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAvL1JhbmdlIGVyZ28gY29uZGl0aW9uXHJcbiAgICAgICAgICAgICAgICB2YXIgeUNvb3JkID0gdGhpcy55O1xyXG4gICAgICAgICAgICAgICAgdmFyIGxhYmVsID0gY29uZGl0aW9uc1tNYXRoLmZsb29yKHRoaXMueCldLmludGVydmFscy5maWx0ZXIoZnVuY3Rpb24odikge1xyXG4gICAgICAgICAgICAgICAgICByZXR1cm4geUNvb3JkID49IHYuZnJvbSAmJiB5Q29vcmQgPD0gdi50bztcclxuICAgICAgICAgICAgICAgIH0pWzBdLmxhYmVsO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICc8Yj4nICsgY29uZGl0aW9uc1tNYXRoLmZsb29yKHRoaXMueCldLm5hbWUgKyAobGFiZWwgPyAnOiAnICsgbGFiZWwgOiAnJykgKyAnPC9iPjxici8+JyArXHJcbiAgICAgICAgICAgICAgICAgIEhpZ2hjaGFydHMuZGF0ZUZvcm1hdCgnJVk6JW06JWQnLCB0aGlzLnBvaW50Lm9wdGlvbnMubG93KSArXHJcbiAgICAgICAgICAgICAgICAgICcgLSAnICsgSGlnaGNoYXJ0cy5kYXRlRm9ybWF0KCclWTolbTolZCcsIHRoaXMucG9pbnQub3B0aW9ucy5oaWdoKTtcclxuICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy9TaW5nbGUgdmFsdWUgaGVuY2UgY29udGFjdFxyXG4gICAgICAgICAgICAgICAgdmFyIHRpbWUgPSB0aGlzLnk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY29udGFjdHMuZmlsdGVyKGZ1bmN0aW9uKHZhbCkge1xyXG4gICAgICAgICAgICAgICAgICByZXR1cm4gdmFsLmRhdGEgJiYgdmFsLmRhdGEuZmlsdGVyKGZ1bmN0aW9uKHYpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdlsxXSA9PT0gdGltZTtcclxuICAgICAgICAgICAgICAgICAgfSkubGVuZ3RoID4gMDtcclxuICAgICAgICAgICAgICAgIH0pLm1hcChmdW5jdGlvbih2YWwpIHtcclxuICAgICAgICAgICAgICAgICAgcmV0dXJuICc8Yj4nICsgdmFsLm5hbWUgKyAnPC9iPjxici8+JyArIEhpZ2hjaGFydHMuZGF0ZUZvcm1hdCgnJVk6JW06JWQnLCB2YWwudGltZSk7XHJcbiAgICAgICAgICAgICAgICB9KS5qb2luKCc8YnIvPicpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZm9sbG93UG9pbnRlcjogdHJ1ZVxyXG4gICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICBwbG90T3B0aW9uczoge1xyXG4gICAgICAgICAgICBjb2x1bW5yYW5nZToge1xyXG4gICAgICAgICAgICAgIGdyb3VwaW5nOiBmYWxzZSxcclxuICAgICAgICAgICAgICBncm91cFBhZGRpbmc6IDAuMyxcclxuICAgICAgICAgICAgICBkYXRhTGFiZWxzOiB7XHJcbiAgICAgICAgICAgICAgICBhbGxvd092ZXJsYXA6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBlbmFibGVkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgZm9ybWF0dGVyOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgdmFyIHlDb29yZCA9IHRoaXMueTtcclxuICAgICAgICAgICAgICAgICAgdmFyIGlkeCA9IC0xO1xyXG4gICAgICAgICAgICAgICAgICB2YXIgbGFiZWwgPSBjb25kaXRpb25zW01hdGguZmxvb3IodGhpcy54KV0uaW50ZXJ2YWxzLmZpbHRlcihmdW5jdGlvbih2LCBpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHlDb29yZCA+PSB2LmZyb20gJiYgeUNvb3JkIDw9IHYudG8pIHtcclxuICAgICAgICAgICAgICAgICAgICAgIGlkeCA9IGk7XHJcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICB9KVswXS5sYWJlbDtcclxuICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMueSA9PT0gdGhpcy5wb2ludC5sb3cgJiZcclxuICAgICAgICAgICAgICAgICAgICAoY29uZGl0aW9uc1tNYXRoLmZsb29yKHRoaXMueCldLmludGVydmFscy5sZW5ndGggLSAxID09PSBpZHggfHxcclxuICAgICAgICAgICAgICAgICAgICAgICh0aGlzLnNlcmllcy5jaGFydC55QXhpc1swXS5taW4gPD0geUNvb3JkICYmIHRoaXMuc2VyaWVzLmNoYXJ0LnlBeGlzWzBdLm1heCA+PSB5Q29vcmQpIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAodGhpcy5zZXJpZXMuY2hhcnQueUF4aXNbMF0ubWluID49IHRoaXMucG9pbnQubG93ICYmIHRoaXMuc2VyaWVzLmNoYXJ0LnlBeGlzWzBdLm1heCA8PSB0aGlzLnBvaW50LmhpZ2gpKSA/IGNvbmRpdGlvbnNbTWF0aC5mbG9vcih0aGlzLngpXS5uYW1lICsgKGxhYmVsID8gJzogJyArIGxhYmVsIDogJycpIDogJyc7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgLypwbG90T3B0aW9uczoge1xyXG4gICAgICAgICAgICBsaW5lOiB7XHJcbiAgICAgICAgICAgICAgbGluZVdpZHRoOiA5LFxyXG4gICAgICAgICAgICAgIG1hcmtlcjoge1xyXG4gICAgICAgICAgICAgICAgZW5hYmxlZDogZmFsc2VcclxuICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgIGRhdGFMYWJlbHM6IHtcclxuICAgICAgICAgICAgICAgIGVuYWJsZWQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBhbGlnbjogJ2xlZnQnLFxyXG4gICAgICAgICAgICAgICAgZm9ybWF0dGVyOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucG9pbnQub3B0aW9ucyAmJiB0aGlzLnBvaW50Lm9wdGlvbnMubGFiZWw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9LCovXHJcblxyXG4gICAgICAgICAgc2VyaWVzOiBzZXJpZXNcclxuXHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBwbG90TWVhc3VyZW1lbnRzID0gZnVuY3Rpb24obWVhc3VyZW1lbnRzKSB7XHJcbiAgICAgICQuZWFjaChtZWFzdXJlbWVudHMuZGF0YXNldHMsIGZ1bmN0aW9uKGksIGRhdGFzZXQpIHtcclxuXHJcbiAgICAgICAgLy8gQWRkIFggdmFsdWVzXHJcbiAgICAgICAgaWYgKGRhdGFzZXQuZGF0YSAmJiB0eXBlb2YgZGF0YXNldC5kYXRhWzBdICE9PSBcIm9iamVjdFwiKSB7XHJcbiAgICAgICAgICBkYXRhc2V0LmRhdGEgPSBIaWdoY2hhcnRzLm1hcChkYXRhc2V0LmRhdGEsIGZ1bmN0aW9uKHZhbCwgaikge1xyXG4gICAgICAgICAgICByZXR1cm4gW21lYXN1cmVtZW50cy54RGF0YVtqXSwgdmFsXTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGNoYXJ0T3B0aW9ucyA9IHtcclxuICAgICAgICAgIGNoYXJ0OiB7XHJcbiAgICAgICAgICAgIG1hcmdpbkxlZnQ6IDQwLCAvLyBLZWVwIGFsbCBjaGFydHMgbGVmdCBhbGlnbmVkXHJcbiAgICAgICAgICAgIHNwYWNpbmdUb3A6IDAsXHJcbiAgICAgICAgICAgIHNwYWNpbmdCb3R0b206IDgsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgdGl0bGU6IHtcclxuICAgICAgICAgICAgdGV4dDogJycsXHJcbiAgICAgICAgICAgIGFsaWduOiAnbGVmdCcsXHJcbiAgICAgICAgICAgIG1hcmdpbjogMCxcclxuICAgICAgICAgICAgeDogMzBcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBjcmVkaXRzOiB7XHJcbiAgICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgbGVnZW5kOiB7XHJcbiAgICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgeEF4aXM6IHtcclxuICAgICAgICAgICAgdHlwZTogJ2RhdGV0aW1lJyxcclxuICAgICAgICAgICAgbWluOiBEYXRlLlVUQygyMDEzLCA2LCAxMiksXHJcbiAgICAgICAgICAgIG1heDogRGF0ZS5VVEMoMjAxNiwgMywgNSksXHJcbiAgICAgICAgICAgIGNyb3NzaGFpcjoge1xyXG4gICAgICAgICAgICAgIHNuYXA6IGZhbHNlXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGV2ZW50czoge1xyXG4gICAgICAgICAgICAgIHNldEV4dHJlbWVzOiBzeW5jRXh0cmVtZXNcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbGFiZWxzOiB7XHJcbiAgICAgICAgICAgICAgZW5hYmxlZDogZmFsc2VcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbGluZVdpZHRoOiAwLFxyXG4gICAgICAgICAgICBtaW5vckdyaWRMaW5lV2lkdGg6IDAsXHJcbiAgICAgICAgICAgIGxpbmVDb2xvcjogJ3RyYW5zcGFyZW50JyxcclxuICAgICAgICAgICAgbWlub3JUaWNrTGVuZ3RoOiAwLFxyXG4gICAgICAgICAgICB0aWNrTGVuZ3RoOiAwXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgeUF4aXM6IHtcclxuICAgICAgICAgICAgdGl0bGU6IHtcclxuICAgICAgICAgICAgICB0ZXh0OiBudWxsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHN0YXJ0T25UaWNrOiBmYWxzZSxcclxuICAgICAgICAgICAgZW5kT25UaWNrOiBmYWxzZSxcclxuICAgICAgICAgICAgbGFiZWxzOiB7XHJcbiAgICAgICAgICAgICAgc3R5bGU6IHtcclxuICAgICAgICAgICAgICAgIFwidGV4dE92ZXJmbG93XCI6IFwibm9uZVwiXHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB0aWNrUGl4ZWxJbnRlcnZhbDogMjUsXHJcbiAgICAgICAgICAgIG1heFBhZGRpbmc6IDAuMSxcclxuICAgICAgICAgICAgbWluUGFkZGluZzogMC4xXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgdG9vbHRpcDoge1xyXG4gICAgICAgICAgICBwb3NpdGlvbmVyOiBmdW5jdGlvbihsYWJlbFdpZHRoLCBsYWJlbEhlaWdodCwgcG9pbnQpIHtcclxuICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgeDogTWF0aC5tYXgoNTAsIHBvaW50LnBsb3RYIC0gbGFiZWxXaWR0aCksIC8vIGxlZnQgYWxpZ25lZFxyXG4gICAgICAgICAgICAgICAgeTogLTEgLy8gYWxpZ24gdG8gdGl0bGVcclxuICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBib3JkZXJXaWR0aDogMCxcclxuICAgICAgICAgICAgYmFja2dyb3VuZENvbG9yOiAncmdiYSgyNTIsIDI1NSwgMTk3LCAwLjY1KScsXHJcbiAgICAgICAgICAgIHBvaW50Rm9ybWF0OiAnPGI+JyArIGRhdGFzZXQubmFtZSArICc6PC9iPiB7cG9pbnQueX0gJyArIGRhdGFzZXQudW5pdCxcclxuICAgICAgICAgICAgaGVhZGVyRm9ybWF0OiAnJyxcclxuICAgICAgICAgICAgc2hhZG93OiB0cnVlLFxyXG4gICAgICAgICAgICBzdHlsZToge1xyXG4gICAgICAgICAgICAgIGZvbnRTaXplOiAnMThweCdcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdmFsdWVEZWNpbWFsczogZGF0YXNldC52YWx1ZURlY2ltYWxzXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgcGxvdE9wdGlvbnM6e1xyXG4gICAgICAgICAgICBzZXJpZXM6IHtcclxuICAgICAgICAgICAgICAgIGV2ZW50czoge1xyXG4gICAgICAgICAgICAgICAgICAgIG1vdXNlT3V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICB2YXIgY2hhcnQsaTtcclxuICAgICAgICAgICAgICAgICAgICAgIGZvciAoaSA9IDE7IGkgPCBsbC5jaGFydEFycmF5Lmxlbmd0aCAtIDI7IGkgPSBpICsgMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGFydCA9IGxsLmNoYXJ0QXJyYXlbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYXJ0LnRvb2x0aXAuaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHNlcmllczogW3tcclxuICAgICAgICAgICAgZGF0YTogZGF0YXNldC5kYXRhLFxyXG4gICAgICAgICAgICBuYW1lOiBkYXRhc2V0Lm5hbWUsXHJcbiAgICAgICAgICAgIHR5cGU6IGRhdGFzZXQudHlwZSxcclxuICAgICAgICAgICAgY29sb3I6IGNvbG91ci5uZXh0KCksXHJcbiAgICAgICAgICAgIGZpbGxPcGFjaXR5OiAwLjNcclxuICAgICAgICAgICAgfV1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBpZiAoZGF0YXNldC5uYW1lID09PSBcIkJsb29kIHByZXNzdXJlXCIpIHtcclxuICAgICAgICAgIGNoYXJ0T3B0aW9ucy50b29sdGlwLnBvaW50Rm9ybWF0ID0gXCI8Yj5CUDo8L2I+IHtwb2ludC5sb3d9L3twb2ludC5oaWdofSBtbUhnPGJyLz5cIjtcclxuICAgICAgICAgIC8vY2hhcnRPcHRpb25zLnNlcmllc1swXS50b29sdGlwID0ge307XHJcbiAgICAgICAgICBjaGFydE9wdGlvbnMuc2VyaWVzWzBdLnN0ZW1XaWR0aCA9IDM7XHJcbiAgICAgICAgICBjaGFydE9wdGlvbnMuc2VyaWVzWzBdLndoaXNrZXJXaWR0aCA9IDU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvKmlmIChpID09PSBtZWFzdXJlbWVudHMuZGF0YXNldHMubGVuZ3RoIC0gMSkge1xyXG4gICAgICAgICAgY2hhcnRPcHRpb25zLnhBeGlzID0ge1xyXG4gICAgICAgICAgICBjcm9zc2hhaXI6IHRydWUsXHJcbiAgICAgICAgICAgIGV2ZW50czoge1xyXG4gICAgICAgICAgICAgIHNldEV4dHJlbWVzOiBzeW5jRXh0cmVtZXNcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdHlwZTogJ2RhdGV0aW1lJ1xyXG4gICAgICAgICAgfTtcclxuICAgICAgICB9Ki9cclxuICAgICAgICAkKCc8ZGl2IGNsYXNzPVwic3luYy1jaGFydCBoLWNoYXJ0JyArIChpID09PSBtZWFzdXJlbWVudHMuZGF0YXNldHMubGVuZ3RoIC0gMSA/IFwiIGgtbGFzdC1tZWFzdXJlbWVudC1jaGFydFwiIDogXCJcIikgKyAnXCI+JylcclxuICAgICAgICAgIC5hcHBlbmRUbyhlbGVtZW50SWQpXHJcbiAgICAgICAgICAuaGlnaGNoYXJ0cyhjaGFydE9wdGlvbnMpO1xyXG5cclxuICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBwbG90TmF2aWdhdG9yID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBjaGFydCA9ICQoJzxkaXYgY2xhc3M9XCJoLWNoYXJ0IGgtbmF2aWdhdG9yLWNoYXJ0XCI+JylcclxuICAgICAgICAuYXBwZW5kVG8oZWxlbWVudElkKVxyXG4gICAgICAgIC5oaWdoY2hhcnRzKHtcclxuXHJcbiAgICAgICAgICBjaGFydDoge1xyXG4gICAgICAgICAgICByZW5kZXJUbzogZWxlbWVudCxcclxuICAgICAgICAgICAgbWFyZ2luTGVmdDogNDAsIC8vIEtlZXAgYWxsIGNoYXJ0cyBsZWZ0IGFsaWduZWRcclxuICAgICAgICAgICAgc3BhY2luZ1RvcDogMjAsXHJcbiAgICAgICAgICAgIHNwYWNpbmdCb3R0b206IDIwLFxyXG4gICAgICAgICAgICBpZ25vcmVIaWRkZW5TZXJpZXM6IGZhbHNlXHJcbiAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgIHRpdGxlOiB7XHJcbiAgICAgICAgICAgIHRleHQ6ICcnXHJcbiAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgIHhBeGlzOiB7XHJcbiAgICAgICAgICAgIHR5cGU6ICdkYXRldGltZScsXHJcbiAgICAgICAgICAgIG1pbjogRGF0ZS5VVEMoMjAxMywgNiwgMTIpLFxyXG4gICAgICAgICAgICBtYXg6IERhdGUuVVRDKDIwMTYsIDMsIDUpLFxyXG4gICAgICAgICAgICBjcm9zc2hhaXI6IGZhbHNlLFxyXG4gICAgICAgICAgICBldmVudHM6IHtcclxuICAgICAgICAgICAgICBzZXRFeHRyZW1lczogc3luY0V4dHJlbWVzXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGxhYmVsczoge1xyXG4gICAgICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGxpbmVXaWR0aDogMCxcclxuICAgICAgICAgICAgbWlub3JHcmlkTGluZVdpZHRoOiAwLFxyXG4gICAgICAgICAgICBsaW5lQ29sb3I6ICd0cmFuc3BhcmVudCcsXHJcbiAgICAgICAgICAgIG1pbm9yVGlja0xlbmd0aDogMCxcclxuICAgICAgICAgICAgdGlja0xlbmd0aDogMFxyXG4gICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICB5QXhpczoge1xyXG4gICAgICAgICAgICBtaW46IDAsXHJcbiAgICAgICAgICAgIG1heDogMSxcclxuICAgICAgICAgICAgdGlja0ludGVydmFsOiAxLFxyXG4gICAgICAgICAgICBzdGFydE9uVGljazogZmFsc2UsXHJcbiAgICAgICAgICAgIGVuZE9uVGljazogZmFsc2UsXHJcbiAgICAgICAgICAgIHRpdGxlOiB7XHJcbiAgICAgICAgICAgICAgdGV4dDogJydcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbWluUGFkZGluZzogMC4yLFxyXG4gICAgICAgICAgICBtYXhQYWRkaW5nOiAwLjIsXHJcbiAgICAgICAgICAgIGxhYmVsczoge1xyXG4gICAgICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgbGVnZW5kOiB7XHJcbiAgICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlXHJcbiAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgIG5hdmlnYXRvcjoge1xyXG4gICAgICAgICAgICBlbmFibGVkOiB0cnVlXHJcbiAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgIHBsb3RPcHRpb25zOiB7XHJcbiAgICAgICAgICAgIGxpbmU6IHtcclxuICAgICAgICAgICAgICBsaW5lV2lkdGg6IDAsXHJcbiAgICAgICAgICAgICAgbWFya2VyOiB7XHJcbiAgICAgICAgICAgICAgICBlbmFibGVkOiBmYWxzZVxyXG4gICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgZGF0YUxhYmVsczoge1xyXG4gICAgICAgICAgICAgICAgZW5hYmxlZDogZmFsc2VcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgc2VyaWVzOiBbe1xyXG4gICAgICAgICAgICBcIm5hbWVcIjogXCJIVE5cIixcclxuICAgICAgICAgICAgXCJkYXRhXCI6IFt7XHJcbiAgICAgICAgICAgICAgXCJ4XCI6IDEzNzM1ODcyMDAwMDAsXHJcbiAgICAgICAgICAgICAgXCJ5XCI6IDAsXHJcbiAgICAgICAgICAgICAgXCJmcm9tXCI6IDEzNzM1ODcyMDAwMDAsXHJcbiAgICAgICAgICAgICAgXCJ0b1wiOiAxNDU5ODE0NDAwMDAwXHJcbiAgICAgICAgICAgICAgfV1cclxuICAgICAgICAgICAgfV1cclxuXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIGNoYXJ0LmhpZ2hjaGFydHMoKS5zZXJpZXNbMF0uaGlkZSgpO1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgcGxvdE1lZGljYXRpb25zID0gZnVuY3Rpb24obWVkaWNhdGlvbnMpIHtcclxuICAgICAgdmFyIHNlcmllcyA9IFtdO1xyXG4gICAgICAkLmVhY2gobWVkaWNhdGlvbnMucmV2ZXJzZSgpLCBmdW5jdGlvbihpLCB0YXNrKSB7XHJcbiAgICAgICAgdmFyIGl0ZW0gPSB7XHJcbiAgICAgICAgICBuYW1lOiB0YXNrLm5hbWUsXHJcbiAgICAgICAgICBkYXRhOiBbXSxcclxuICAgICAgICAgIGNvbG9yOiBjb2xvdXIubmV4dCgpXHJcbiAgICAgICAgfTtcclxuICAgICAgICAkLmVhY2godGFzay5pbnRlcnZhbHMsIGZ1bmN0aW9uKGosIGludGVydmFsKSB7XHJcbiAgICAgICAgICBpdGVtLmRhdGEucHVzaChbaSArIDAuNDksIGludGVydmFsLmZyb20sIGludGVydmFsLnRvXSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHNlcmllcy5wdXNoKGl0ZW0pO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIC8vIGNyZWF0ZSB0aGUgY2hhcnRcclxuICAgICAgcmV0dXJuICQoJzxkaXYgY2xhc3M9XCJoLWNoYXJ0IGgtY29uZGl0aW9uLWNoYXJ0XCI+JylcclxuICAgICAgICAuYXBwZW5kVG8oZWxlbWVudElkKVxyXG4gICAgICAgIC5oaWdoY2hhcnRzKHtcclxuXHJcbiAgICAgICAgICBjaGFydDoge1xyXG4gICAgICAgICAgICByZW5kZXJUbzogZWxlbWVudCxcclxuICAgICAgICAgICAgbWFyZ2luTGVmdDogNDAsIC8vIEtlZXAgYWxsIGNoYXJ0cyBsZWZ0IGFsaWduZWRcclxuICAgICAgICAgICAgc3BhY2luZ1RvcDogMjAsXHJcbiAgICAgICAgICAgIHNwYWNpbmdCb3R0b206IDIwLFxyXG4gICAgICAgICAgICB0eXBlOiAnY29sdW1ucmFuZ2UnLFxyXG4gICAgICAgICAgICBpbnZlcnRlZDogdHJ1ZVxyXG4gICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICB0aXRsZToge1xyXG4gICAgICAgICAgICB0ZXh0OiAnJ1xyXG4gICAgICAgICAgfSxcclxuXHJcblxyXG4gICAgICAgICAgeUF4aXM6IHtcclxuICAgICAgICAgICAgdHlwZTogJ2RhdGV0aW1lJyxcclxuICAgICAgICAgICAgbWluOiBEYXRlLlVUQygyMDEzLCA2LCAxMiksXHJcbiAgICAgICAgICAgIG1heDogRGF0ZS5VVEMoMjAxNiwgMywgNSksXHJcbiAgICAgICAgICAgIGNyb3NzaGFpcjoge1xyXG4gICAgICAgICAgICAgIHNuYXA6IGZhbHNlXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGV2ZW50czoge1xyXG4gICAgICAgICAgICAgIHNldEV4dHJlbWVzOiBzeW5jRXh0cmVtZXNcclxuICAgICAgICAgICAgfSxcclxuXHJcblxyXG5cclxuICAgICAgICAgICAgLy90aGluZ3MgdGhhdCBhcmUgbm9ybWFsbHkgeEF4aXMgZGVmYXVsdHNcclxuICAgICAgICAgICAgZW5kT25UaWNrOiBmYWxzZSxcclxuICAgICAgICAgICAgZ3JpZExpbmVXaWR0aDogMCxcclxuICAgICAgICAgICAgbGluZVdpZHRoOiAxLFxyXG4gICAgICAgICAgICBtYXhQYWRkaW5nOiAwLjAxLFxyXG4gICAgICAgICAgICBtaW5QYWRkaW5nOiAwLjAxLFxyXG4gICAgICAgICAgICBzdGFydE9uVGljazogZmFsc2UsXHJcbiAgICAgICAgICAgIHRpY2tXaWR0aDogMSxcclxuICAgICAgICAgICAgdGl0bGU6IHtcclxuICAgICAgICAgICAgICB0ZXh0OiAnJ1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB0aWNrUGl4ZWxJbnRlcnZhbDogMTAwXHJcbiAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgIHhBeGlzOiB7XHJcbiAgICAgICAgICAgIGxhYmVsczoge1xyXG4gICAgICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHN0YXJ0T25UaWNrOiBmYWxzZSxcclxuICAgICAgICAgICAgZW5kT25UaWNrOiBmYWxzZSxcclxuICAgICAgICAgICAgdGl0bGU6IHtcclxuICAgICAgICAgICAgICB0ZXh0OiAnJ1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB0aWNrV2lkdGg6IDAsXHJcbiAgICAgICAgICAgIG1pblBhZGRpbmc6IDAuMixcclxuICAgICAgICAgICAgbWF4UGFkZGluZzogMC4yLFxyXG5cclxuICAgICAgICAgICAgLy90aGluZ3MgdGhhdCBhcmUgbm9ybWFsbHkgeUF4aXMgZGVmYXVsdHNcclxuICAgICAgICAgICAgZ3JpZExpbmVXaWR0aDogMCxcclxuICAgICAgICAgICAgbGluZVdpZHRoOiAwXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgY3JlZGl0czoge1xyXG4gICAgICAgICAgICBlbmFibGVkOiBmYWxzZVxyXG4gICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICBsZWdlbmQ6IHtcclxuICAgICAgICAgICAgZW5hYmxlZDogZmFsc2VcclxuICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgdG9vbHRpcDoge1xyXG4gICAgICAgICAgICBmb3JtYXR0ZXI6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgIHZhciB5Q29vcmQgPSB0aGlzLnk7XHJcbiAgICAgICAgICAgICAgdmFyIGxhYmVsID0gbWVkaWNhdGlvbnNbTWF0aC5mbG9vcih0aGlzLngpXS5pbnRlcnZhbHMuZmlsdGVyKGZ1bmN0aW9uKHYpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB5Q29vcmQgPj0gdi5mcm9tICYmIHlDb29yZCA8PSB2LnRvO1xyXG4gICAgICAgICAgICAgIH0pWzBdLmxhYmVsO1xyXG4gICAgICAgICAgICAgIHJldHVybiAnPGI+JyArIG1lZGljYXRpb25zW01hdGguZmxvb3IodGhpcy54KV0ubmFtZSArIChsYWJlbCA/ICc6ICcgKyBsYWJlbCA6ICcnKSArICc8L2I+PGJyLz4nICtcclxuICAgICAgICAgICAgICAgIEhpZ2hjaGFydHMuZGF0ZUZvcm1hdCgnJVk6JW06JWQnLCB0aGlzLnBvaW50Lm9wdGlvbnMubG93KSArXHJcbiAgICAgICAgICAgICAgICAnIC0gJyArIEhpZ2hjaGFydHMuZGF0ZUZvcm1hdCgnJVk6JW06JWQnLCB0aGlzLnBvaW50Lm9wdGlvbnMuaGlnaCk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGZvbGxvd1BvaW50ZXI6IHRydWVcclxuICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgcGxvdE9wdGlvbnM6IHtcclxuICAgICAgICAgICAgY29sdW1ucmFuZ2U6IHtcclxuICAgICAgICAgICAgICBncm91cGluZzogZmFsc2UsXHJcbiAgICAgICAgICAgICAgZGF0YUxhYmVsczoge1xyXG4gICAgICAgICAgICAgICAgYWxsb3dPdmVybGFwOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgZW5hYmxlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGZvcm1hdHRlcjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgIHZhciB5Q29vcmQgPSB0aGlzLnk7XHJcbiAgICAgICAgICAgICAgICAgIHZhciBpZHggPSAtMTtcclxuICAgICAgICAgICAgICAgICAgdmFyIGxhYmVsID0gbWVkaWNhdGlvbnNbTWF0aC5mbG9vcih0aGlzLngpXS5pbnRlcnZhbHMuZmlsdGVyKGZ1bmN0aW9uKHYsIGkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoeUNvb3JkID49IHYuZnJvbSAmJiB5Q29vcmQgPD0gdi50bykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgaWR4ID0gaTtcclxuICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgIH0pWzBdLmxhYmVsO1xyXG4gICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy55ID09PSB0aGlzLnBvaW50LmxvdyAmJlxyXG4gICAgICAgICAgICAgICAgICAgIChtZWRpY2F0aW9uc1tNYXRoLmZsb29yKHRoaXMueCldLmludGVydmFscy5sZW5ndGggLSAxID09PSBpZHggfHxcclxuICAgICAgICAgICAgICAgICAgICAgICh0aGlzLnNlcmllcy5jaGFydC55QXhpc1swXS5taW4gPD0geUNvb3JkICYmIHRoaXMuc2VyaWVzLmNoYXJ0LnlBeGlzWzBdLm1heCA+PSB5Q29vcmQpIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAodGhpcy5zZXJpZXMuY2hhcnQueUF4aXNbMF0ubWluID49IHRoaXMucG9pbnQubG93ICYmIHRoaXMuc2VyaWVzLmNoYXJ0LnlBeGlzWzBdLm1heCA8PSB0aGlzLnBvaW50LmhpZ2gpKSA/IG1lZGljYXRpb25zW01hdGguZmxvb3IodGhpcy54KV0ubmFtZSArIChsYWJlbCA/ICc6ICcgKyBsYWJlbCA6ICcnKSA6ICcnO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICBzZXJpZXM6IHNlcmllc1xyXG5cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgcGxvdENvbmRpdGlvbnMoZGF0YS5jb25kaXRpb25zLCBkYXRhLmNvbnRhY3RzKTtcclxuICAgIHBsb3RNZWFzdXJlbWVudHMoZGF0YS5tZWFzdXJlbWVudHMpO1xyXG4gICAgdmFyIGMgPSBwbG90TWVkaWNhdGlvbnMoZGF0YS5tZWRpY2F0aW9ucyk7XHJcbiAgICBwbG90TmF2aWdhdG9yKCk7XHJcbiAgICBjLmhpZ2hjaGFydHMoKS5heGVzWzFdLnNldEV4dHJlbWVzKDE0MzQ4NjQwMDAwMDAsIDE0NTk4MTQ0MDAwMDAsIHVuZGVmaW5lZCwgZmFsc2UsIHtcclxuICAgICAgdHJpZ2dlcjogJ3N5bmNFeHRyZW1lcydcclxuICAgIH0pO1xyXG5cclxuICAgIGxsLmNoYXJ0QXJyYXkgPSBIaWdoY2hhcnRzLmNoYXJ0cy5zbGljZShIaWdoY2hhcnRzLmNoYXJ0cy5sZW5ndGggLSA2LCBIaWdoY2hhcnRzLmNoYXJ0cy5sZW5ndGgpO1xyXG5cclxuICAgIHZhciBzID0gc3luY0V4dHJlbWVzLmJpbmQoYy5oaWdoY2hhcnRzKCkuc2VyaWVzWzBdKTtcclxuICAgIHMoe1xyXG4gICAgICB0cmlnZ2VyOiAnbmF2aWdhdG9yJyxcclxuICAgICAgbWluOiAxNDM0ODY0MDAwMDAwLFxyXG4gICAgICBtYXg6IDE0NTk4MTQ0MDAwMDBcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGxsO1xyXG4iLCJ2YXIgYmFzZSA9IHJlcXVpcmUoJy4uL2Jhc2UuanMnKSxcclxuICBjb25maXJtID0gcmVxdWlyZSgnLi9jb25maXJtLmpzJyksXHJcbiAgZGF0YSA9IHJlcXVpcmUoJy4uL2RhdGEuanMnKSxcclxuICBsb2cgPSByZXF1aXJlKCcuLi9sb2cuanMnKTtcclxuXHJcbnZhciBtZWQgPSB7XHJcblxyXG4gIGNyZWF0ZTogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpIHtcclxuICAgIHZhciBtZWRpY2F0aW9ucyA9IGRhdGEucGF0aWVudHNbcGF0aWVudElkXS5tZWRpY2F0aW9ucyB8fCBbXTtcclxuICAgIHZhciBhZ3JlZSA9IGxvZy5nZXRQYXRpZW50QWdyZWVPYmplY3QocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQsIFwibWVkaWNhdGlvblwiKTtcclxuICAgIHJldHVybiBiYXNlLmNyZWF0ZVBhbmVsKG1lZGljYXRpb25QYW5lbCwge1xyXG4gICAgICBcImFyZU1lZGljYXRpb25zXCI6IG1lZGljYXRpb25zLmxlbmd0aCA+IDAsXHJcbiAgICAgIFwiYWdyZWVcIjogYWdyZWUgJiYgYWdyZWUuYWdyZWUsXHJcbiAgICAgIFwiZGlzYWdyZWVcIjogYWdyZWUgJiYgYWdyZWUuYWdyZWUgPT09IGZhbHNlLFxyXG4gICAgICBcInBhdGh3YXlcIjogZGF0YS5wYXRod2F5TmFtZXNbcGF0aHdheUlkXSxcclxuICAgICAgXCJtZWRpY2F0aW9uc1wiOiBtZWRpY2F0aW9ucyxcclxuICAgICAgXCJwYXRod2F5U3RhZ2VcIjogcGF0aHdheVN0YWdlXHJcbiAgICB9LCB7XHJcbiAgICAgIFwibWVkaWNhdGlvblJvd1wiOiAkKCcjbWVkaWNhdGlvbi1yb3cnKS5odG1sKClcclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIHdpcmVVcDogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpIHtcclxuICAgIGNvbmZpcm0ud2lyZVVwKCQoJyNtZWRpY2F0aW9uLWFncmVlLWRpc2FncmVlJyksICQoJyNtZWRpY2F0aW9uLXBhbmVsJyksIHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkLCBcIm1lZGljYXRpb25cIiwgXCJtZWRpY2F0aW9uIGRhdGFcIik7XHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gbWVkO1xyXG4iLCJ2YXIgYmFzZSA9IHJlcXVpcmUoJy4uL2Jhc2UuanMnKSxcclxuICBjb25maXJtID0gcmVxdWlyZSgnLi9jb25maXJtLmpzJyksXHJcbiAgZGF0YSA9IHJlcXVpcmUoJy4uL2RhdGEuanMnKSxcclxuICBsb2cgPSByZXF1aXJlKCcuLi9sb2cuanMnKTtcclxuXHJcbnZhciBvdGhlciA9IHtcclxuXHJcbiAgY3JlYXRlOiBmdW5jdGlvbihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCkge1xyXG4gICAgdmFyIGNvZGVzID0gKGRhdGEucGF0aWVudHNbcGF0aWVudElkXS5jb2RlcyB8fCBbXSkubWFwKGZ1bmN0aW9uKHZhbCkge1xyXG4gICAgICB2YWwuZGVzY3JpcHRpb24gPSBkYXRhLmNvZGVzW3ZhbC5jb2RlXTtcclxuICAgICAgcmV0dXJuIHZhbDtcclxuICAgIH0pO1xyXG4gICAgdmFyIGFncmVlID0gbG9nLmdldFBhdGllbnRBZ3JlZU9iamVjdChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCwgXCJjb2Rlc1wiKTtcclxuICAgIHJldHVybiBiYXNlLmNyZWF0ZVBhbmVsKCQoJyNvdGhlci1jb2Rlcy1wYW5lbCcpLCB7XHJcbiAgICAgIFwiYXJlQ29kZXNcIjogY29kZXMubGVuZ3RoID4gMCxcclxuICAgICAgXCJhZ3JlZVwiOiBhZ3JlZSAmJiBhZ3JlZS5hZ3JlZSxcclxuICAgICAgXCJkaXNhZ3JlZVwiOiBhZ3JlZSAmJiBhZ3JlZS5hZ3JlZSA9PT0gZmFsc2UsXHJcbiAgICAgIFwicGF0aHdheVwiOiBkYXRhLnBhdGh3YXlOYW1lc1twYXRod2F5SWRdLFxyXG4gICAgICBcInN0YW5kYXJkXCI6IGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0udGFiLnRpdGxlLFxyXG4gICAgICBcImNvZGVzXCI6IGNvZGVzLFxyXG4gICAgICBcInBhdGh3YXlTdGFnZVwiOiBwYXRod2F5U3RhZ2VcclxuICAgIH0sIHtcclxuICAgICAgXCJjb2RlUm93XCI6ICQoJyNvdGhlci1jb2Rlcy1yb3cnKS5odG1sKClcclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIHdpcmVVcDogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpIHtcclxuICAgIGNvbmZpcm0ud2lyZVVwKCQoJyNvdGhlci1jb2Rlcy1hZ3JlZS1kaXNhZ3JlZScpLCAkKCcjb3RoZXItY29kZXMtcGFuZWwnKSwgcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQsIFwiY29kZXNcIiwgXCJvdGhlciBjb2Rlc1wiKTtcclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBvdGhlcjtcclxuIiwidmFyIEhpZ2hjaGFydHMgPSByZXF1aXJlKCdoaWdoY2hhcnRzL2hpZ2hzdG9jaycpLFxyXG4gIGJhc2UgPSByZXF1aXJlKCcuLi9iYXNlLmpzJyksXHJcbiAgZGF0YSA9IHJlcXVpcmUoJy4uL2RhdGEuanMnKSxcclxuICBsb29rdXAgPSByZXF1aXJlKCcuLi9sb29rdXAuanMnKSxcclxuICBNdXN0YWNoZSA9IHJlcXVpcmUoJ211c3RhY2hlJyk7XHJcblxyXG52YXIgSUQgPSBcIlBBVElFTlRfTElTVFwiO1xyXG5cclxudmFyIHBsID0ge1xyXG5cclxuICB3aXJlVXA6IGZ1bmN0aW9uKG9uUGF0aWVudFNlbGVjdGVkKSB7XHJcbiAgICBwYXRpZW50c1BhbmVsID0gJCgnI3BhdGllbnRzJyk7XHJcblxyXG4gICAgcGF0aWVudHNQYW5lbC5vbignY2xpY2snLCAndGhlYWQgdHIgdGguc29ydGFibGUnLCBmdW5jdGlvbigpIHsgLy9Tb3J0IGNvbHVtbnMgd2hlbiBjb2x1bW4gaGVhZGVyIGNsaWNrZWRcclxuICAgICAgdmFyIHNvcnRBc2MgPSAhJCh0aGlzKS5oYXNDbGFzcygnc29ydC1hc2MnKTtcclxuICAgICAgaWYgKHNvcnRBc2MpIHtcclxuICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKCdzb3J0LWRlc2MnKS5hZGRDbGFzcygnc29ydC1hc2MnKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKCdzb3J0LWFzYycpLmFkZENsYXNzKCdzb3J0LWRlc2MnKTtcclxuICAgICAgfVxyXG4gICAgICBwbC5wb3B1bGF0ZShwbC5zdGF0ZVswXSwgcGwuc3RhdGVbMV0sIHBsLnN0YXRlWzJdLCBwbC5zdGF0ZVszXSwgJCh0aGlzKS5pbmRleCgpLCBzb3J0QXNjKTtcclxuICAgIH0pLm9uKCdjbGljaycsICd0Ym9keSB0cicsIGZ1bmN0aW9uKGUpIHsgLy9TZWxlY3QgaW5kaXZpZHVhbCBwYXRpZW50IHdoZW4gcm93IGNsaWNrZWQjXHJcbiAgICAgIHZhciBjYWxsYmFjayA9IG9uUGF0aWVudFNlbGVjdGVkLmJpbmQodGhpcyk7XHJcbiAgICAgIHZhciBwYXRpZW50SWQgPSAkKHRoaXMpLmZpbmQoJ3RkIGJ1dHRvbicpLmF0dHIoJ2RhdGEtcGF0aWVudC1pZCcpO1xyXG4gICAgICBjYWxsYmFjayhwYXRpZW50SWQpO1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICB9KS5vbignY2xpY2snLCAndGJvZHkgdHIgYnV0dG9uJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAvL2Rvbid0IHdhbnQgcm93IHNlbGVjdGVkIGlmIGp1c3QgYnV0dG9uIHByZXNzZWQ/XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIHNlbGVjdFN1YnNlY3Rpb246IGZ1bmN0aW9uKHNlY3Rpb24pIHtcclxuICAgIHBsLnBvcHVsYXRlKHBsLnN0YXRlWzBdLCBwbC5zdGF0ZVsxXSwgcGwuc3RhdGVbMl0sIHNlY3Rpb24sIHBsLnN0YXRlWzRdLCBwbC5zdGF0ZVs1XSk7XHJcbiAgfSxcclxuXHJcbiAgcG9wdWxhdGU6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgc3Vic2VjdGlvbiwgc29ydEZpZWxkLCBzb3J0QXNjKSB7XHJcbiAgICBwbC5zdGF0ZSA9IFtwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHN1YnNlY3Rpb24sIHNvcnRGaWVsZCwgc29ydEFzY107XHJcbiAgICBwYXRpZW50c1BhbmVsID0gJCgnI3BhdGllbnRzJyk7XHJcbiAgICAvL1JlbW92ZSBzY3JvbGwgaWYgZXhpc3RzXHJcbiAgICBwYXRpZW50c1BhbmVsLmZpbmQoJ2Rpdi50YWJsZS1zY3JvbGwnKS5nZXROaWNlU2Nyb2xsKCkucmVtb3ZlKCk7XHJcblxyXG4gICAgdmFyIGksIGssIHByb3AsIGhlYWRlciwgcExpc3QgPSBbXTtcclxuXHJcbiAgICBkYXRhLmdldEluZGljYXRvckRhdGEoW3BhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZF0uam9pbihcIi5cIiksIGZ1bmN0aW9uKGluZGljYXRvcnMpIHtcclxuXHJcbiAgICAgIGlmIChwYXRod2F5SWQgJiYgcGF0aHdheVN0YWdlICYmIHN0YW5kYXJkICYmIHN1YnNlY3Rpb24pIHtcclxuICAgICAgICBwTGlzdCA9IGluZGljYXRvcnMub3Bwb3J0dW5pdGllcy5maWx0ZXIoZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgICAgICByZXR1cm4gdmFsLm5hbWUgPT09IHN1YnNlY3Rpb247XHJcbiAgICAgICAgfSlbMF0ucGF0aWVudHM7XHJcbiAgICAgICAgaGVhZGVyID0gaW5kaWNhdG9ycy5vcHBvcnR1bml0aWVzLmZpbHRlcihmdW5jdGlvbih2YWwpIHtcclxuICAgICAgICAgIHJldHVybiB2YWwubmFtZSA9PT0gc3Vic2VjdGlvbjtcclxuICAgICAgICB9KVswXS5kZXNjcmlwdGlvbjtcclxuICAgICAgfSBlbHNlIGlmIChwYXRod2F5SWQgJiYgcGF0aHdheVN0YWdlICYmIHN0YW5kYXJkKSB7XHJcbiAgICAgICAgcExpc3QgPSBpbmRpY2F0b3JzLm9wcG9ydHVuaXRpZXMucmVkdWNlKGZ1bmN0aW9uKGEsIGIpIHtcclxuICAgICAgICAgIHJldHVybiBhLnBhdGllbnRzID8gYS5wYXRpZW50cy5jb25jYXQoYi5wYXRpZW50cykgOiBhLmNvbmNhdChiLnBhdGllbnRzKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBoZWFkZXIgPSBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLnRhYmxlVGl0bGU7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHBMaXN0ID0gZGF0YS5yZW1vdmVEdXBsaWNhdGVzKHBMaXN0KTtcclxuICAgICAgdmFyIHBhdGllbnRzID0gcExpc3QubWFwKGZ1bmN0aW9uKHBhdGllbnRJZCkge1xyXG4gICAgICAgIHZhciByZXQgPSBpbmRpY2F0b3JzLnBhdGllbnRzW3BhdGllbnRJZF07XHJcbiAgICAgICAgcmV0Lm5oc051bWJlciA9IGRhdGEucGF0TG9va3VwID8gZGF0YS5wYXRMb29rdXBbcGF0aWVudElkXSA6IHBhdGllbnRJZDtcclxuICAgICAgICByZXQucGF0aWVudElkID0gcGF0aWVudElkO1xyXG4gICAgICAgIHJldC5pdGVtcyA9IFtdOyAvL1RoZSBmaWVsZHMgaW4gdGhlIHBhdGllbnQgbGlzdCB0YWJsZVxyXG4gICAgICAgIGlmIChyZXRbZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS52YWx1ZUlkXSkge1xyXG4gICAgICAgICAgaWYgKGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0uZGF0ZU9SdmFsdWUgPT09IFwiZGF0ZVwiKSB7XHJcbiAgICAgICAgICAgIHJldC5pdGVtcy5wdXNoKHJldFtkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLnZhbHVlSWRdLmRhdGUpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0Lml0ZW1zLnB1c2gocmV0W2RhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0udmFsdWVJZF0udmFsdWUpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZXQuaXRlbXMucHVzaChcIj9cIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldC5pdGVtcy5wdXNoKHJldC5vcHBvcnR1bml0aWVzLm1hcChmdW5jdGlvbih2KXtyZXR1cm4gJzxzcGFuIHN0eWxlPVwid2lkdGg6MTNweDtoZWlnaHQ6MTNweDtmbG9hdDpsZWZ0O2JhY2tncm91bmQtY29sb3I6JyArIEhpZ2hjaGFydHMuZ2V0T3B0aW9ucygpLmNvbG9yc1t2XSArICdcIj48L3NwYW4+Jzt9KS5qb2luKFwiXCIpKTtcclxuICAgICAgICByZXQuaXRlbXMucHVzaChkYXRhLm51bWJlck9mU3RhbmRhcmRzTWlzc2VkKHBhdGllbnRJZCkpO1xyXG4gICAgICAgIHJldHVybiByZXQ7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgdmFyIGxvY2FsRGF0YSA9IHtcclxuICAgICAgICBcInBhdGllbnRzXCI6IHBhdGllbnRzLFxyXG4gICAgICAgIFwiblwiOiBwYXRpZW50cy5sZW5ndGgsXHJcbiAgICAgICAgXCJoZWFkZXJcIjogaGVhZGVyLFxyXG4gICAgICAgIFwiaGVhZGVyLWl0ZW1zXCI6IFt7XHJcbiAgICAgICAgICBcInRpdGxlXCI6IFwiTkhTIG5vLlwiLFxyXG4gICAgICAgICAgXCJpc1NvcnRlZFwiOiBmYWxzZSxcclxuICAgICAgICAgIFwiZGlyZWN0aW9uXCI6IFwic29ydC1hc2NcIixcclxuICAgICAgICAgIFwidG9vbHRpcFwiOiBcIk5IUyBudW1iZXIgb2YgZWFjaCBwYXRpZW50XCJcclxuICAgICAgICB9XVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgLy9taWRkbGUgY29sdW1uIGlzIGVpdGhlciB2YWx1ZSBvciBkYXRlXHJcbiAgICAgIGlmIChkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLmRhdGVPUnZhbHVlKSB7XHJcbiAgICAgICAgbG9jYWxEYXRhW1wiaGVhZGVyLWl0ZW1zXCJdLnB1c2goe1xyXG4gICAgICAgICAgXCJ0aXRsZVwiOiBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLnZhbHVlTmFtZSxcclxuICAgICAgICAgIFwidG9vbHRpcFwiOiBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLmRhdGVPUnZhbHVlID09PSBcImRhdGVcIiA/IFwiTGFzdCBkYXRlIFwiICsgZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS52YWx1ZSArIFwiIHdhcyBtZWFzdXJlZFwiIDogXCJMYXN0IFwiICsgZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS52YWx1ZSArIFwiIHJlYWRpbmdcIixcclxuICAgICAgICAgIFwiaXNTb3J0ZWRcIjogZmFsc2UsXHJcbiAgICAgICAgICBcImRpcmVjdGlvblwiOiBcInNvcnQtYXNjXCJcclxuICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBpZiAocGF0aHdheVN0YWdlID09PSBsb29rdXAuY2F0ZWdvcmllcy5tb25pdG9yaW5nLm5hbWUpIHtcclxuICAgICAgICAgIGxvY2FsRGF0YVtcImhlYWRlci1pdGVtc1wiXS5wdXNoKHtcclxuICAgICAgICAgICAgXCJ0aXRsZVwiOiBcIkxhc3QgQlAgRGF0ZVwiLFxyXG4gICAgICAgICAgICBcImlzU29ydGVkXCI6IGZhbHNlLFxyXG4gICAgICAgICAgICBcImRpcmVjdGlvblwiOiBcInNvcnQtYXNjXCIsXHJcbiAgICAgICAgICAgIFwidG9vbHRpcFwiOiBcIkxhc3QgZGF0ZSBCUCB3YXMgbWVhc3VyZWRcIlxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGxvY2FsRGF0YVtcImhlYWRlci1pdGVtc1wiXS5wdXNoKHtcclxuICAgICAgICAgICAgXCJ0aXRsZVwiOiBcIkxhc3QgU0JQXCIsXHJcbiAgICAgICAgICAgIFwidG9vbHRpcFwiOiBcIkxhc3Qgc3lzdG9saWMgQlAgcmVhZGluZ1wiLFxyXG4gICAgICAgICAgICBcImlzU29ydGVkXCI6IGZhbHNlLFxyXG4gICAgICAgICAgICBcImRpcmVjdGlvblwiOiBcInNvcnQtYXNjXCJcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgLy9hZGQgcXVhbCBzdGFuZGFyZCBjb2x1bW5cclxuICAgICAgbG9jYWxEYXRhW1wiaGVhZGVyLWl0ZW1zXCJdLnB1c2goe1xyXG4gICAgICAgIFwidGl0bGVcIjogXCJDYXRlZ29yaWVzXCIsXHJcbiAgICAgICAgXCJ0aXRsZUhUTUxcIjogJ3RiYScsXHJcbiAgICAgICAgXCJpc1VuU29ydGFibGVcIjogdHJ1ZSxcclxuICAgICAgICBcInRvb2x0aXBcIjogXCJDYXRlZ29yaWVzIGZyb20gYWJvdmUgY2hhcnRcIlxyXG4gICAgICB9KTtcclxuICAgICAgLy9hZGQgcXVhbCBzdGFuZGFyZCBjb2x1bW5cclxuICAgICAgbG9jYWxEYXRhW1wiaGVhZGVyLWl0ZW1zXCJdLnB1c2goe1xyXG4gICAgICAgIFwidGl0bGVcIjogXCJBbGwgT3Bwb3J0dW5pdGllc1wiLFxyXG4gICAgICAgIFwidGl0bGVIVE1MXCI6ICcjIG9mIDxpIGNsYXNzPVwiZmEgZmEtZmxhZ1wiIHN0eWxlPVwiY29sb3I6cmVkXCI+PC9pPicsXHJcbiAgICAgICAgXCJpc1NvcnRlZFwiOiB0cnVlLFxyXG4gICAgICAgIFwiZGlyZWN0aW9uXCI6IFwic29ydC1kZXNjXCIsXHJcbiAgICAgICAgXCJ0b29sdGlwXCI6IFwiVG90YWwgbnVtYmVyIG9mIGltcHJvdmVtZW50IG9wcG9ydHVuaXRpZXMgYXZhaWxhYmxlIGFjcm9zcyBhbGwgY29uZGl0aW9uc1wiXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgaWYgKHNvcnRGaWVsZCA9PT0gdW5kZWZpbmVkKSBzb3J0RmllbGQgPSAyO1xyXG4gICAgICBpZiAoc29ydEZpZWxkICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICBsb2NhbERhdGEucGF0aWVudHMuc29ydChmdW5jdGlvbihhLCBiKSB7XHJcbiAgICAgICAgICBpZiAoc29ydEZpZWxkID09PSAwKSB7IC8vTkhTIG51bWJlclxyXG4gICAgICAgICAgICBpZiAoYS5uaHNOdW1iZXIgPT09IGIubmhzTnVtYmVyKSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIDA7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChhLm5oc051bWJlciA+IGIubmhzTnVtYmVyKSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIHNvcnRBc2MgPyAxIDogLTE7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoYS5uaHNOdW1iZXIgPCBiLm5oc051bWJlcikge1xyXG4gICAgICAgICAgICAgIHJldHVybiBzb3J0QXNjID8gLTEgOiAxO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAoYS5pdGVtc1tzb3J0RmllbGQgLSAxXSA9PT0gYi5pdGVtc1tzb3J0RmllbGQgLSAxXSkge1xyXG4gICAgICAgICAgICAgIHJldHVybiAwO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoYS5pdGVtc1tzb3J0RmllbGQgLSAxXSA9PSBcIj9cIikgcmV0dXJuIDE7XHJcbiAgICAgICAgICAgIGlmIChiLml0ZW1zW3NvcnRGaWVsZCAtIDFdID09IFwiP1wiKSByZXR1cm4gLTE7XHJcblxyXG4gICAgICAgICAgICB2YXIgQSA9IE51bWJlcihhLml0ZW1zW3NvcnRGaWVsZCAtIDFdKTtcclxuICAgICAgICAgICAgdmFyIEIgPSBOdW1iZXIoYi5pdGVtc1tzb3J0RmllbGQgLSAxXSk7XHJcbiAgICAgICAgICAgIGlmIChpc05hTihBKSB8fCBpc05hTihCKSkge1xyXG4gICAgICAgICAgICAgIEEgPSBhLml0ZW1zW3NvcnRGaWVsZCAtIDFdO1xyXG4gICAgICAgICAgICAgIEIgPSBiLml0ZW1zW3NvcnRGaWVsZCAtIDFdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChBID4gQikge1xyXG4gICAgICAgICAgICAgIHJldHVybiBzb3J0QXNjID8gMSA6IC0xO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKEEgPCBCKSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIHNvcnRBc2MgPyAtMSA6IDE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGxvY2FsRGF0YVtcImhlYWRlci1pdGVtc1wiXS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgaWYgKGkgPT09IHNvcnRGaWVsZCkge1xyXG4gICAgICAgICAgICBsb2NhbERhdGFbXCJoZWFkZXItaXRlbXNcIl1baV0uZGlyZWN0aW9uID0gc29ydEFzYyA/IFwic29ydC1hc2NcIiA6IFwic29ydC1kZXNjXCI7XHJcbiAgICAgICAgICAgIGxvY2FsRGF0YVtcImhlYWRlci1pdGVtc1wiXVtpXS5pc0FzYyA9IHNvcnRBc2M7XHJcbiAgICAgICAgICAgIGxvY2FsRGF0YVtcImhlYWRlci1pdGVtc1wiXVtpXS5pc1NvcnRlZCA9IHRydWU7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBsb2NhbERhdGFbXCJoZWFkZXItaXRlbXNcIl1baV0uaXNTb3J0ZWQgPSBmYWxzZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGJhc2UuY3JlYXRlUGFuZWxTaG93KHBhdGllbnRMaXN0LCBwYXRpZW50c1BhbmVsLCBsb2NhbERhdGEsIHtcclxuICAgICAgICBcImhlYWRlci1pdGVtXCI6ICQoXCIjcGF0aWVudC1saXN0LWhlYWRlci1pdGVtXCIpLmh0bWwoKSxcclxuICAgICAgICBcIml0ZW1cIjogJCgnI3BhdGllbnQtbGlzdC1pdGVtJykuaHRtbCgpXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgJCgnI3BhdGllbnRzLXBsYWNlaG9sZGVyJykuaGlkZSgpO1xyXG5cclxuICAgICAgYmFzZS5zZXR1cENsaXBib2FyZCgkKCcuYnRuLWNvcHknKSwgdHJ1ZSk7XHJcblxyXG4gICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcblxyXG4gICAgICBwYXRpZW50c1BhbmVsLmZpbmQoJ2Rpdi50YWJsZS1zY3JvbGwnKS5uaWNlU2Nyb2xsKHtcclxuICAgICAgICBjdXJzb3JvcGFjaXR5bWluOiAwLjMsXHJcbiAgICAgICAgY3Vyc29yd2lkdGg6IFwiN3B4XCIsXHJcbiAgICAgICAgaG9yaXpyYWlsZW5hYmxlZDogZmFsc2VcclxuICAgICAgfSk7XHJcblxyXG4gICAgfSk7XHJcblxyXG4gIH0sXHJcblxyXG4gIHNob3c6IGZ1bmN0aW9uKHBhbmVsLCBpc0FwcGVuZCwgcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBsb2FkQ29udGVudEZuKSB7XHJcblxyXG4gICAgdmFyIHRlbXBNdXN0ID0gJCgnI3BhdGllbnRzLXBhbmVsLXllcycpLmh0bWwoKTtcclxuXHJcbiAgICBpZihpc0FwcGVuZCkgcGFuZWwuYXBwZW5kKE11c3RhY2hlLnJlbmRlcih0ZW1wTXVzdCkpO1xyXG4gICAgZWxzZSBwYW5lbC5odG1sKE11c3RhY2hlLnJlbmRlcih0ZW1wTXVzdCkpO1xyXG5cclxuICAgIHBsLndpcmVVcChmdW5jdGlvbihwYXRpZW50SWQpIHtcclxuICAgICAgaGlzdG9yeS5wdXNoU3RhdGUobnVsbCwgbnVsbCwgJyNwYXRpZW50LycgKyBbcGF0aWVudElkLCBwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmRdLmpvaW4oXCIvXCIpKTtcclxuICAgICAgbG9hZENvbnRlbnRGbignI3BhdGllbnQvJyArIFtwYXRpZW50SWQsIHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZF0uam9pbihcIi9cIikpO1xyXG4gICAgfSk7XHJcbiAgICBwbC5wb3B1bGF0ZShwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIG51bGwpO1xyXG4gIH1cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHBsO1xyXG4iLCJ2YXIgYmFzZSA9IHJlcXVpcmUoJy4uL2Jhc2UuanMnKSxcclxuICBkYXRhID0gcmVxdWlyZSgnLi4vZGF0YS5qcycpLFxyXG4gIGxvb2t1cCA9IHJlcXVpcmUoJy4uL2xvb2t1cC5qcycpLFxyXG4gIE11c3RhY2hlID0gcmVxdWlyZSgnbXVzdGFjaGUnKTtcclxudmFyIHN0YXRlcywgbG9hZENvbnRGbiwgSUQgPSBcIlBBVElFTlRfU0VBUkNIXCI7XHJcblxyXG52YXIgcHMgPSB7XHJcblxyXG4gIHdpcmVVcDogZnVuY3Rpb24oKSB7XHJcbiAgICBpZiAoc3RhdGVzKSB7XHJcbiAgICAgIHN0YXRlcy5jbGVhclByZWZldGNoQ2FjaGUoKTtcclxuICAgIH1cclxuXHJcbiAgICBzdGF0ZXMgPSBuZXcgQmxvb2Rob3VuZCh7XHJcbiAgICAgIGRhdHVtVG9rZW5pemVyOiBCbG9vZGhvdW5kLnRva2VuaXplcnMub2JqLndoaXRlc3BhY2UoJ3ZhbHVlJyksXHJcbiAgICAgIHF1ZXJ5VG9rZW5pemVyOiBCbG9vZGhvdW5kLnRva2VuaXplcnMud2hpdGVzcGFjZSxcclxuICAgICAgbG9jYWw6ICQubWFwKGRhdGEucGF0aWVudEFycmF5LCBmdW5jdGlvbihzdGF0ZSkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICBpZDogc3RhdGUsXHJcbiAgICAgICAgICB2YWx1ZTogc3RhdGVcclxuICAgICAgICB9O1xyXG4gICAgICB9KVxyXG4gICAgfSk7XHJcblxyXG4gICAgc3RhdGVzLmluaXRpYWxpemUodHJ1ZSk7XHJcblxyXG4gICAgJCgnI3NlYXJjaC1ib3gnKS5maW5kKCcudHlwZWFoZWFkJykudHlwZWFoZWFkKCdkZXN0cm95Jyk7XHJcbiAgICAkKCcjc2VhcmNoLWJveCcpLmZpbmQoJy50eXBlYWhlYWQnKS50eXBlYWhlYWQoe1xyXG4gICAgICAgIGhpbnQ6IHRydWUsXHJcbiAgICAgICAgaGlnaGxpZ2h0OiB0cnVlLFxyXG4gICAgICAgIG1pbkxlbmd0aDogMSxcclxuICAgICAgICBhdXRvc2VsZWN0OiB0cnVlXHJcbiAgICAgIH0sIHtcclxuICAgICAgICBuYW1lOiAncGF0aWVudHMnLFxyXG4gICAgICAgIGRpc3BsYXlLZXk6ICd2YWx1ZScsXHJcbiAgICAgICAgc291cmNlOiBzdGF0ZXMudHRBZGFwdGVyKCksXHJcbiAgICAgICAgdGVtcGxhdGVzOiB7XHJcbiAgICAgICAgICBlbXB0eTogW1xyXG4gICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiZW1wdHktbWVzc2FnZVwiPicsXHJcbiAgICAgICAgICAgICAgICAnJm5ic3A7ICZuYnNwOyBObyBtYXRjaGVzJyxcclxuICAgICAgICAgICAgICAnPC9kaXY+J1xyXG4gICAgICAgICAgICBdLmpvaW4oJ1xcbicpXHJcbiAgICAgICAgfVxyXG4gICAgICB9KS5vbigndHlwZWFoZWFkOnNlbGVjdGVkJywgcHMub25TZWxlY3RlZClcclxuICAgICAgLm9uKCd0eXBlYWhlYWQ6YXV0b2NvbXBsZXRlZCcsIHBzLm9uU2VsZWN0ZWQpO1xyXG5cclxuICAgICQoJyNzZWFyY2hidG4nKS5vbignbW91c2Vkb3duJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciB2YWwgPSAkKCcudHlwZWFoZWFkJykuZXEoMCkudmFsKCk7XHJcbiAgICAgIGlmICghdmFsIHx8IHZhbCA9PT0gXCJcIikgdmFsID0gJCgnLnR5cGVhaGVhZCcpLmVxKDEpLnZhbCgpO1xyXG4gICAgICBwcy5vblNlbGVjdGVkKG51bGwsIHtcclxuICAgICAgICBcImlkXCI6IHZhbFxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIG9uU2VsZWN0ZWQ6IGZ1bmN0aW9uKCRlLCBuaHNOdW1iZXJPYmplY3QpIHtcclxuICAgIC8vSGlkZSB0aGUgc3VnZ2VzdGlvbnMgcGFuZWxcclxuICAgICQoJyNzZWFyY2gtYm94JykuZmluZCgnLnR0LWRyb3Bkb3duLW1lbnUnKS5jc3MoJ2Rpc3BsYXknLCAnbm9uZScpO1xyXG5cclxuICAgIGhpc3RvcnkucHVzaFN0YXRlKG51bGwsIG51bGwsICcjcGF0aWVudHMvJyArIG5oc051bWJlck9iamVjdC5pZCk7XHJcbiAgICBsb2FkQ29udEZuKCcjcGF0aWVudHMvJyArIG5oc051bWJlck9iamVjdC5pZCwgdHJ1ZSk7XHJcblxyXG4gIH0sXHJcblxyXG4gIHNob3c6IGZ1bmN0aW9uKHBhbmVsLCBpc0FwcGVuZCwgbG9hZENvbnRlbnRGbikge1xyXG5cclxuICAgIGxvYWRDb250Rm4gPSBsb2FkQ29udGVudEZuO1xyXG4gICAgdmFyIHRlbXBNdXN0ID0gJCgnI3BhdGllbnQtc2VhcmNoJykuaHRtbCgpO1xyXG5cclxuICAgIGlmKGlzQXBwZW5kKSBwYW5lbC5hcHBlbmQoTXVzdGFjaGUucmVuZGVyKHRlbXBNdXN0KSk7XHJcbiAgICBlbHNlIHBhbmVsLmh0bWwoTXVzdGFjaGUucmVuZGVyKHRlbXBNdXN0KSk7XHJcblxyXG4gICAgcHMud2lyZVVwKCk7XHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gcHM7XHJcbiIsInZhciBiYXNlID0gcmVxdWlyZSgnLi4vYmFzZS5qcycpLFxyXG4gIGRhdGEgPSByZXF1aXJlKCcuLi9kYXRhLmpzJyksXHJcbiAgbG9va3VwID0gcmVxdWlyZSgnLi4vbG9va3VwLmpzJyksXHJcbiAgY2hhcnQgPSByZXF1aXJlKCcuLi9jaGFydC5qcycpLFxyXG4gIHF1YWxpdHlTdGFuZGFyZCA9IHJlcXVpcmUoJy4vcXVhbGl0eVN0YW5kYXJkLmpzJyksXHJcbiAgb3RoZXJDb2RlcyA9IHJlcXVpcmUoJy4vb3RoZXJDb2Rlcy5qcycpLFxyXG4gIG1lZGljYXRpb24gPSByZXF1aXJlKCcuL21lZGljYXRpb24uanMnKSxcclxuICB0cmVuZCA9IHJlcXVpcmUoJy4vdHJlbmQuanMnKSxcclxuICBpbmRpdmlkdWFsQWN0aW9uUGxhbiA9IHJlcXVpcmUoJy4vaW5kaXZpZHVhbEFjdGlvblBsYW4uanMnKSxcclxuICBwYXRpZW50TGlzdCA9IHJlcXVpcmUoJy4vcGF0aWVudExpc3QuanMnKTtcclxuXHJcbnZhciBwdCA9IHtcclxuXHJcbiAgY3JlYXRlOiBmdW5jdGlvbihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQpIHtcclxuICAgIHZhciB0YWJEYXRhID0gW107XHJcbiAgICBmb3IgKHZhciBrZXkgaW4gZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzKSB7XHJcbiAgICAgIHRhYkRhdGEucHVzaCh7XHJcbiAgICAgICAgXCJoZWFkZXJcIjogZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW2tleV0udGFiLFxyXG4gICAgICAgIFwiYWN0aXZlXCI6IGtleSA9PT0gc3RhbmRhcmQsXHJcbiAgICAgICAgXCJ1cmxcIjogd2luZG93LmxvY2F0aW9uLmhhc2gucmVwbGFjZSgvXFwvbm8uKi9nLCAnXFwvbm8vJyArIGtleSlcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYmFzZS5jcmVhdGVQYW5lbChwYXRpZW50c1BhbmVsVGVtcGxhdGUsIHtcclxuICAgICAgXCJwYXRod2F5U3RhZ2VcIjogcGF0aHdheVN0YWdlLFxyXG4gICAgICBcImhlYWRlclwiOiBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLmNoYXJ0VGl0bGUsXHJcbiAgICAgIFwidG9vbHRpcFwiOiBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLnRvb2x0aXAsXHJcbiAgICAgIFwidXJsXCI6IHdpbmRvdy5sb2NhdGlvbi5oYXNoLnJlcGxhY2UoL1xcL3llcy4qL2csICcnKS5yZXBsYWNlKC9cXC9uby4qL2csICcnKSxcclxuICAgICAgXCJ0YWJzXCI6IHRhYkRhdGEsXHJcbiAgICAgIFwidGV4dFwiOiBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS50ZXh0XHJcbiAgICB9LCB7XHJcbiAgICAgIFwiY29udGVudFwiOiAkKCcjcGF0aWVudHMtcGFuZWwtbm8nKS5odG1sKCksXHJcbiAgICAgIFwidGFiLWhlYWRlclwiOiAkKCcjcGF0aWVudHMtcGFuZWwtbm8tdGFicycpLmh0bWwoKSxcclxuICAgICAgXCJ0YWItY29udGVudFwiOiAkKCcjcGF0aWVudHMtcGFuZWwtbm8tcGFnZScpLmh0bWwoKVxyXG4gICAgfSk7XHJcbiAgfSxcclxuXHJcbiAgY3JlYXRlT2s6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlKSB7XHJcbiAgICByZXR1cm4gYmFzZS5jcmVhdGVQYW5lbChwYXRpZW50c1BhbmVsVGVtcGxhdGUsIHtcclxuICAgICAgXCJva1wiOiB0cnVlLFxyXG4gICAgICBcInBhdGh3YXlTdGFnZVwiOiBwYXRod2F5U3RhZ2UsXHJcbiAgICAgIFwidXJsXCI6IHdpbmRvdy5sb2NhdGlvbi5oYXNoLnJlcGxhY2UoL1xcL3llcy9nLCAnJykucmVwbGFjZSgvXFwvbm8vZywgJycpLFxyXG4gICAgICBcInRleHRcIjogZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0udGV4dFxyXG4gICAgfSwge1xyXG4gICAgICBcImNvbnRlbnRcIjogJCgnI3BhdGllbnRzLXBhbmVsLXllcycpLmh0bWwoKVxyXG4gICAgfSk7XHJcbiAgfSxcclxuXHJcbiAgd2lyZVVwOiBmdW5jdGlvbihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgbG9jYXRpb24sIHN0YW5kYXJkKSB7XHJcblxyXG4gICAgcGF0aWVudExpc3Qud2lyZVVwKGZ1bmN0aW9uKHBhdGllbnRJZCl7XHJcbiAgICAgICQoJ1tkYXRhLXRvZ2dsZT1cInRvb2x0aXBcIl0nKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgICQodGhpcykudG9vbHRpcCgnZGVzdHJveScpO1xyXG4gICAgICBiYXNlLmNsZWFyQm94KCk7XHJcbiAgICAgICQoJy5saXN0LWl0ZW0nKS5yZW1vdmVDbGFzcygnaGlnaGxpZ2h0ZWQnKTtcclxuICAgICAgJCh0aGlzKS5hZGRDbGFzcygnaGlnaGxpZ2h0ZWQnKS5yZW1vdmVBdHRyKFwidGl0bGVcIik7XHJcblxyXG4gICAgICBwdC5zaG93UGF0aHdheVN0YWdlUGF0aWVudFZpZXcocGF0aWVudElkLCBwYXRod2F5SWQsIHNlbGVjdGVkLCBzdGFuZGFyZCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBwYXRpZW50c1BhbmVsID0gJCgnI3BhdGllbnRzJyk7XHJcblxyXG4gICAgbG9jYXRpb24ub2ZmKCdjbGljaycsICcjYnJlYWtkb3duLWNoYXJ0Jyk7XHJcbiAgICBsb2NhdGlvbi5vbignY2xpY2snLCAnI2JyZWFrZG93bi1jaGFydCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgICBpZiAoIWxvb2t1cC5jaGFydENsaWNrZWQpIHtcclxuICAgICAgICAvKmpzaGludCB1bnVzZWQ6IHRydWUqL1xyXG4gICAgICAgICQoJ3BhdGguYzMtYmFyJykuYXR0cignY2xhc3MnLCBmdW5jdGlvbihpbmRleCwgY2xhc3NOYW1lcykge1xyXG4gICAgICAgICAgcmV0dXJuIGNsYXNzTmFtZXMucmVwbGFjZSgvX3Vuc2VsZWN0ZWRfL2csICcnKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAvKmpzaGludCB1bnVzZWQ6IGZhbHNlKi9cclxuXHJcbiAgICAgICAgaWYgKGxvb2t1cC5jaGFydHNbJ2JyZWFrZG93bi1jaGFydCddKSBsb29rdXAuY2hhcnRzWydicmVha2Rvd24tY2hhcnQnXS51bnNlbGVjdCgpO1xyXG5cclxuICAgICAgICBwYXRpZW50TGlzdC5wb3B1bGF0ZShwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIG51bGwpO1xyXG4gICAgICAgIGRhdGEuc3Vic2VsZWN0ZWQgPSBudWxsO1xyXG5cclxuICAgICAgICBmYXJSaWdodFBhbmVsLmZhZGVPdXQoMjAwKTtcclxuICAgICAgfVxyXG4gICAgICBsb29rdXAuY2hhcnRDbGlja2VkID0gZmFsc2U7XHJcbiAgICB9KTtcclxuXHJcbiAgICBjaGFydC5kZXN0cm95Q2hhcnRzKFsnYnJlYWtkb3duLWNoYXJ0J10pO1xyXG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgbG9va3VwLmNoYXJ0c1snYnJlYWtkb3duLWNoYXJ0J10gPSBjMy5nZW5lcmF0ZSh7XHJcbiAgICAgICAgYmluZHRvOiAnI2JyZWFrZG93bi1jaGFydCcsXHJcbiAgICAgICAgdG9vbHRpcDoge1xyXG4gICAgICAgICAgZm9ybWF0OiB7XHJcbiAgICAgICAgICAgIG5hbWU6IGZ1bmN0aW9uKG5hbWUsIGEsIGIpIHtcclxuICAgICAgICAgICAgICB2YXIgdGV4dCA9IGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0ub3Bwb3J0dW5pdGllc1tsb29rdXAuaW5kZXhdLmRlc2M7XHJcbiAgICAgICAgICAgICAgdmFyIGh0bWwgPSBcIlwiO1xyXG4gICAgICAgICAgICAgIHdoaWxlICh0ZXh0Lmxlbmd0aCA+IDQwKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGV4dC5pbmRleE9mKCcgJywgNDApIDwgMCkgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBodG1sICs9IHRleHQuc3Vic3RyKDAsIHRleHQuaW5kZXhPZignICcsIDQwKSkgKyAnPGJyPic7XHJcbiAgICAgICAgICAgICAgICB0ZXh0ID0gdGV4dC5zdWJzdHIodGV4dC5pbmRleE9mKCcgJywgNDApICsgMSk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIGh0bWwgKz0gdGV4dDtcclxuICAgICAgICAgICAgICByZXR1cm4gaHRtbDtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uKHZhbHVlLCByYXRpbywgaWQsIGluZGV4KSB7XHJcbiAgICAgICAgICAgICAgbG9va3VwLmluZGV4ID0gaW5kZXg7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICBjb2x1bW5zOiBbXHJcbiAgICAgICAgICAgIFtcIlBhdGllbnRzXCJdLmNvbmNhdChkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLm9wcG9ydHVuaXRpZXMubWFwKGZ1bmN0aW9uKHZhbCkge1xyXG4gICAgICAgICAgICAgIHJldHVybiB2YWwucGF0aWVudHMubGVuZ3RoO1xyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICAgIF0sXHJcbiAgICAgICAgICB0eXBlOiAnYmFyJyxcclxuICAgICAgICAgIGxhYmVsczogdHJ1ZSxcclxuICAgICAgICAgIGNvbG9yOiBmdW5jdGlvbihjb2xvciwgZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbG9va3VwLmNvbG9yc1tkLmluZGV4XTtcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBzZWxlY3Rpb246IHtcclxuICAgICAgICAgICAgZW5hYmxlZDogdHJ1ZVxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIG9uY2xpY2s6IGZ1bmN0aW9uKGQpIHtcclxuICAgICAgICAgICAgY2hhcnQuc2VsZWN0UGllU2xpY2UoJ2JyZWFrZG93bi1jaGFydCcsIGQpO1xyXG4gICAgICAgICAgICBwYXRpZW50TGlzdC5wb3B1bGF0ZShwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0ub3Bwb3J0dW5pdGllc1tkLmluZGV4XS5uYW1lKTtcclxuICAgICAgICAgICAgZGF0YS5zdWJzZWxlY3RlZCA9IGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0ub3Bwb3J0dW5pdGllc1tkLmluZGV4XS5uYW1lO1xyXG5cclxuICAgICAgICAgICAgLy9jb2xvdXIgdGFibGUgYXBwcm9wcmlhdGVseSAtIG5lZWQgdG8gYWRkIG9wYWNpdHlcclxuICAgICAgICAgICAgdmFyIHNsaWNlQ29sb3VySGV4ID0gbG9va3VwLmNvbG9yc1tkLmluZGV4XTtcclxuICAgICAgICAgICAgdmFyIHNob3J0aGFuZFJlZ2V4ID0gL14jPyhbYS1mXFxkXSkoW2EtZlxcZF0pKFthLWZcXGRdKSQvaTtcclxuICAgICAgICAgICAgc2xpY2VDb2xvdXJIZXggPSBzbGljZUNvbG91ckhleC5yZXBsYWNlKHNob3J0aGFuZFJlZ2V4LCBmdW5jdGlvbihtLCByLCBnLCBiKSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIHIgKyByICsgZyArIGcgKyBiICsgYjtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSAvXiM/KFthLWZcXGRdezJ9KShbYS1mXFxkXXsyfSkoW2EtZlxcZF17Mn0pJC9pLmV4ZWMoc2xpY2VDb2xvdXJIZXgpO1xyXG4gICAgICAgICAgICB2YXIgb3BhY2l0eSA9IDAuMjtcclxuICAgICAgICAgICAgdmFyIHNsaWNlQ29sb3VyID0gJ3JnYmEoJyArIHBhcnNlSW50KHJlc3VsdFsxXSwgMTYpICsgJywnICsgcGFyc2VJbnQocmVzdWx0WzJdLCAxNikgKyAnLCcgKyBwYXJzZUludChyZXN1bHRbM10sIDE2KSArICcsJyArIG9wYWNpdHkgKyAnKSc7XHJcblxyXG4gICAgICAgICAgICAkKCcudGFibGUucGF0aWVudC1saXN0LnRhYmxlLWhlYWQtaGlkZGVuJykuY3NzKHtcclxuICAgICAgICAgICAgICBcImJhY2tncm91bmRDb2xvclwiOiBzbGljZUNvbG91clxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIGJhcjoge1xyXG4gICAgICAgICAgd2lkdGg6IHtcclxuICAgICAgICAgICAgcmF0aW86IDAuNVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgbGVnZW5kOiB7XHJcbiAgICAgICAgICBzaG93OiBmYWxzZVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZ3JpZDoge1xyXG4gICAgICAgICAgZm9jdXM6IHtcclxuICAgICAgICAgICAgc2hvdzogZmFsc2VcclxuICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIGF4aXM6IHtcclxuICAgICAgICAgIHg6IHtcclxuICAgICAgICAgICAgdHlwZTogJ2NhdGVnb3J5JyxcclxuICAgICAgICAgICAgY2F0ZWdvcmllczogZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS5vcHBvcnR1bml0aWVzLm1hcChmdW5jdGlvbih2YWwpIHtcclxuICAgICAgICAgICAgICByZXR1cm4gdmFsLm5hbWU7XHJcbiAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICBsYWJlbDogZmFsc2VcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICB5OiB7XHJcbiAgICAgICAgICAgIGxhYmVsOiB7XHJcbiAgICAgICAgICAgICAgdGV4dDogJ1BhdGllbnQgY291bnQgKG4pJyxcclxuICAgICAgICAgICAgICBwb3NpdGlvbjogJ291dGVyLW1pZGRsZSdcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9LCAxKTtcclxuICB9LFxyXG5cclxuICB3aXJlVXBPazogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIGxvY2F0aW9uKSB7XHJcbiAgICBwYXRpZW50c1BhbmVsID0gJCgnI3BhdGllbnRzJyk7XHJcblxyXG4gICAgcGF0aWVudHNQYW5lbC5vbignY2xpY2snLCAndGhlYWQgdHIgdGguc29ydGFibGUnLCBmdW5jdGlvbigpIHsgLy9Tb3J0IGNvbHVtbnMgd2hlbiBjb2x1bW4gaGVhZGVyIGNsaWNrZWRcclxuICAgICAgdmFyIHNvcnRBc2MgPSAhJCh0aGlzKS5oYXNDbGFzcygnc29ydC1hc2MnKTtcclxuICAgICAgaWYgKHNvcnRBc2MpIHtcclxuICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKCdzb3J0LWRlc2MnKS5hZGRDbGFzcygnc29ydC1hc2MnKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKCdzb3J0LWFzYycpLmFkZENsYXNzKCdzb3J0LWRlc2MnKTtcclxuICAgICAgfVxyXG4gICAgICBwdC5wb3B1bGF0ZU9rKHBhdGh3YXlJZCwgZGF0YS5zZWxlY3RlZCwgZGF0YS5zdWJzZWxlY3RlZCwgJCh0aGlzKS5pbmRleCgpLCBzb3J0QXNjKTtcclxuICAgIH0pLm9uKCdjbGljaycsICd0Ym9keSB0cicsIGZ1bmN0aW9uKGUpIHsgLy9TZWxlY3QgaW5kaXZpZHVhbCBwYXRpZW50IHdoZW4gcm93IGNsaWNrZWRcclxuICAgICAgJCgnW2RhdGEtdG9nZ2xlPVwidG9vbHRpcFwiXScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgJCh0aGlzKS50b29sdGlwKCdkZXN0cm95Jyk7XHJcbiAgICAgIGJhc2UuY2xlYXJCb3goKTtcclxuICAgICAgJCgnLmxpc3QtaXRlbScpLnJlbW92ZUNsYXNzKCdoaWdobGlnaHRlZCcpO1xyXG4gICAgICAkKHRoaXMpLmFkZENsYXNzKCdoaWdobGlnaHRlZCcpLnJlbW92ZUF0dHIoJ3RpdGxlJyk7XHJcblxyXG4gICAgICB2YXIgcGF0aWVudElkID0gJCh0aGlzKS5maW5kKCd0ZCBidXR0b24nKS5hdHRyKCdkYXRhLXBhdGllbnQtaWQnKTtcclxuXHJcbiAgICAgIHB0LnNob3dQYXRod2F5U3RhZ2VQYXRpZW50VmlldyhwYXRpZW50SWQsIHBhdGh3YXlJZCwgZGF0YS5zZWxlY3RlZCwgbnVsbCk7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgIH0pLm9uKCdjbGljaycsICd0Ym9keSB0ciBidXR0b24nLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIC8vZG9uJ3Qgd2FudCByb3cgc2VsZWN0ZWQgaWYganVzdCBidXR0b24gcHJlc3NlZD9cclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGF0YS5zZWxlY3RlZCA9IHBhdGh3YXlTdGFnZTtcclxuICAgIGRhdGEuc3Vic2VsZWN0ZWQgPSBudWxsO1xyXG4gIH0sXHJcblxyXG4gIHBvcHVsYXRlT2s6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdWJzZWN0aW9uLCBzb3J0RmllbGQsIHNvcnRBc2MpIHtcclxuICAgIHZhciBwTGlzdCA9IFtdLFxyXG4gICAgICBpLCBrLCBwcm9wLCBoZWFkZXIsIHRvb2x0aXA7XHJcbiAgICBwYXRpZW50c1BhbmVsLmZhZGVPdXQoMjAwLCBmdW5jdGlvbigpIHtcclxuICAgICAgJCh0aGlzKS5mYWRlSW4oMjAwKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHBMaXN0ID0gZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0ucGF0aWVudHNPaztcclxuICAgIGhlYWRlciA9IGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnRleHQucGFuZWxPa0hlYWRlci50ZXh0O1xyXG4gICAgdG9vbHRpcCA9IGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnRleHQucGFuZWxPa0hlYWRlci50b29sdGlwO1xyXG5cclxuICAgIHBMaXN0ID0gZGF0YS5yZW1vdmVEdXBsaWNhdGVzKHBMaXN0KTtcclxuICAgIHZhciBwYXRpZW50cyA9IHBMaXN0Lm1hcChmdW5jdGlvbihwYXRpZW50SWQpIHtcclxuICAgICAgdmFyIHJldCA9IGRhdGEucGF0aWVudHNbcGF0aWVudElkXTtcclxuICAgICAgcmV0Lm5oc051bWJlciA9IGRhdGEucGF0TG9va3VwID8gZGF0YS5wYXRMb29rdXBbcGF0aWVudElkXSA6IHBhdGllbnRJZDtcclxuICAgICAgcmV0LnBhdGllbnRJZCA9IHBhdGllbnRJZDtcclxuICAgICAgcmV0Lml0ZW1zID0gW107IC8vVGhlIGZpZWxkcyBpbiB0aGUgcGF0aWVudCBsaXN0IHRhYmxlXHJcbiAgICAgIHJldC5pdGVtcy5wdXNoKGRhdGEucGF0aWVudHNbcGF0aWVudElkXS5icmVhY2ggPyBkYXRhLm51bWJlck9mU3RhbmRhcmRzTWlzc2VkKHBhdGllbnRJZCkgOiAwKTtcclxuICAgICAgcmV0dXJuIHJldDtcclxuICAgIH0pO1xyXG4gICAgdmFyIGxvY2FsRGF0YSA9IHtcclxuICAgICAgXCJwYXRpZW50c1wiOiBwYXRpZW50cyxcclxuICAgICAgXCJuXCI6IHBhdGllbnRzLmxlbmd0aCxcclxuICAgICAgXCJoZWFkZXJcIjogaGVhZGVyLFxyXG4gICAgICBcInRvb2x0aXBcIjogdG9vbHRpcCxcclxuICAgICAgXCJoZWFkZXItaXRlbXNcIjogW3tcclxuICAgICAgICBcInRpdGxlXCI6IFwiTkhTIG5vLlwiLFxyXG4gICAgICAgIFwiaXNTb3J0ZWRcIjogZmFsc2UsXHJcbiAgICAgICAgXCJkaXJlY3Rpb25cIjogXCJzb3J0LWFzY1wiXHJcbiAgICAgIH0sIHtcclxuICAgICAgICBcInRpdGxlXCI6IFwiQWxsIE9wcG9ydHVuaXRpZXNcIixcclxuICAgICAgICBcInRpdGxlSFRNTFwiOiAnIyBvZiA8aSBjbGFzcz1cImZhIGZhLWZsYWdcIiBzdHlsZT1cImNvbG9yOnJlZFwiPjwvaT4nLFxyXG4gICAgICAgIFwiaXNTb3J0ZWRcIjogdHJ1ZSxcclxuICAgICAgICBcImRpcmVjdGlvblwiOiBcInNvcnQtZGVzY1wiLFxyXG4gICAgICAgIFwidG9vbHRpcFwiOiBcIlRvdGFsIG51bWJlciBvZiBpbXByb3ZlbWVudCBvcHBvcnR1bml0aWVzIGF2YWlsYWJsZSBhY3Jvc3MgYWxsIGNvbmRpdGlvbnNcIlxyXG4gICAgICB9XVxyXG4gICAgfTtcclxuXHJcbiAgICBpZiAoc29ydEZpZWxkID09PSB1bmRlZmluZWQpIHNvcnRGaWVsZCA9IDE7XHJcblxyXG4gICAgbG9jYWxEYXRhLnBhdGllbnRzLnNvcnQoZnVuY3Rpb24oYSwgYikge1xyXG4gICAgICBpZiAoc29ydEZpZWxkID09PSAwKSB7IC8vTkhTIG51bWJlclxyXG4gICAgICAgIGlmIChhLm5oc051bWJlciA9PT0gYi5uaHNOdW1iZXIpIHtcclxuICAgICAgICAgIHJldHVybiAwO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGEubmhzTnVtYmVyID4gYi5uaHNOdW1iZXIpIHtcclxuICAgICAgICAgIHJldHVybiBzb3J0QXNjID8gMSA6IC0xO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoYS5uaHNOdW1iZXIgPCBiLm5oc051bWJlcikge1xyXG4gICAgICAgICAgcmV0dXJuIHNvcnRBc2MgPyAtMSA6IDE7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGlmIChhLml0ZW1zW3NvcnRGaWVsZCAtIDFdID09PSBiLml0ZW1zW3NvcnRGaWVsZCAtIDFdKSB7XHJcbiAgICAgICAgICByZXR1cm4gMDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBBID0gTnVtYmVyKGEuaXRlbXNbc29ydEZpZWxkIC0gMV0pO1xyXG4gICAgICAgIHZhciBCID0gTnVtYmVyKGIuaXRlbXNbc29ydEZpZWxkIC0gMV0pO1xyXG4gICAgICAgIGlmIChpc05hTihBKSB8fCBpc05hTihCKSkge1xyXG4gICAgICAgICAgQSA9IGEuaXRlbXNbc29ydEZpZWxkIC0gMV07XHJcbiAgICAgICAgICBCID0gYi5pdGVtc1tzb3J0RmllbGQgLSAxXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKEEgPiBCKSB7XHJcbiAgICAgICAgICByZXR1cm4gc29ydEFzYyA/IDEgOiAtMTtcclxuICAgICAgICB9IGVsc2UgaWYgKEEgPCBCKSB7XHJcbiAgICAgICAgICByZXR1cm4gc29ydEFzYyA/IC0xIDogMTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGZvciAoaSA9IDA7IGkgPCBsb2NhbERhdGFbXCJoZWFkZXItaXRlbXNcIl0ubGVuZ3RoOyBpKyspIHtcclxuICAgICAgaWYgKGkgPT09IHNvcnRGaWVsZCkge1xyXG4gICAgICAgIGxvY2FsRGF0YVtcImhlYWRlci1pdGVtc1wiXVtpXS5kaXJlY3Rpb24gPSBzb3J0QXNjID8gXCJzb3J0LWFzY1wiIDogXCJzb3J0LWRlc2NcIjtcclxuICAgICAgICBsb2NhbERhdGFbXCJoZWFkZXItaXRlbXNcIl1baV0uaXNBc2MgPSBzb3J0QXNjO1xyXG4gICAgICAgIGxvY2FsRGF0YVtcImhlYWRlci1pdGVtc1wiXVtpXS5pc1NvcnRlZCA9IHRydWU7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgbG9jYWxEYXRhW1wiaGVhZGVyLWl0ZW1zXCJdW2ldLmlzU29ydGVkID0gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG4gICAgYmFzZS5jcmVhdGVQYW5lbFNob3cocGF0aWVudExpc3QsIHBhdGllbnRzUGFuZWwsIGxvY2FsRGF0YSwge1xyXG4gICAgICBcImhlYWRlci1pdGVtXCI6ICQoXCIjcGF0aWVudC1saXN0LWhlYWRlci1pdGVtXCIpLmh0bWwoKSxcclxuICAgICAgXCJpdGVtXCI6ICQoJyNwYXRpZW50LWxpc3QtaXRlbScpLmh0bWwoKVxyXG4gICAgfSk7XHJcblxyXG4gICAgJCgnI3BhdGllbnRzLXBsYWNlaG9sZGVyJykuaGlkZSgpO1xyXG5cclxuICAgIGJhc2Uuc2V0dXBDbGlwYm9hcmQoJCgnLmJ0bi1jb3B5JyksIHRydWUpO1xyXG5cclxuICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuXHJcbiAgICB2YXIgYyA9IHBhdGllbnRzUGFuZWwuZmluZCgnZGl2LnRhYmxlLXNjcm9sbCcpLmdldE5pY2VTY3JvbGwoKTtcclxuICAgIGlmIChjICYmIGMubGVuZ3RoID4gMCkge1xyXG4gICAgICBjLnJlc2l6ZSgpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcGF0aWVudHNQYW5lbC5maW5kKCdkaXYudGFibGUtc2Nyb2xsJykubmljZVNjcm9sbCh7XHJcbiAgICAgICAgY3Vyc29yb3BhY2l0eW1pbjogMC4zLFxyXG4gICAgICAgIGN1cnNvcndpZHRoOiBcIjdweFwiLFxyXG4gICAgICAgIGhvcml6cmFpbGVuYWJsZWQ6IGZhbHNlXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIC8vU2hvdyBwYXRpZW50IHZpZXcgd2l0aGluIHRoZSBwYXRod2F5IHN0YWdlIHZpZXdcclxuICBzaG93UGF0aHdheVN0YWdlUGF0aWVudFZpZXc6IGZ1bmN0aW9uKHBhdGllbnRJZCwgcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkKSB7XHJcbiAgICBkYXRhLnBhdGllbnRJZCA9IHBhdGllbnRJZDtcclxuXHJcbiAgICBiYXNlLnN3aXRjaFRvMTEwTGF5b3V0KCk7XHJcblxyXG4gICAgcHQuc2hvd0luZGl2aWR1YWxQYXRpZW50UGFuZWwocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gIH0sXHJcblxyXG4gIHNob3dJbmRpdmlkdWFsUGF0aWVudFBhbmVsOiBmdW5jdGlvbihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCkge1xyXG4gICAgdmFyIHN0YW4gPSBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdID8gZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS50YWIudGl0bGUgOiBcIlVOU1BFQ0lGSUVEXCI7XHJcblxyXG4gICAgZGF0YS5vcHRpb25zLnNvcnQoZnVuY3Rpb24oYSwgYikge1xyXG4gICAgICBhID0gZGF0YS5nZXRQYXRpZW50U3RhdHVzKHBhdGllbnRJZCwgYS5wYXRod2F5SWQsIGEucGF0aHdheVN0YWdlLCBhLnN0YW5kYXJkKTtcclxuICAgICAgYiA9IGRhdGEuZ2V0UGF0aWVudFN0YXR1cyhwYXRpZW50SWQsIGIucGF0aHdheUlkLCBiLnBhdGh3YXlTdGFnZSwgYi5zdGFuZGFyZCk7XHJcblxyXG4gICAgICBpZiAoYSA9PT0gYikgcmV0dXJuIDA7XHJcbiAgICAgIGlmIChhID09PSBcIm5vdFwiKSByZXR1cm4gMTtcclxuICAgICAgaWYgKGIgPT09IFwibm90XCIpIHJldHVybiAtMTtcclxuICAgICAgaWYgKGEgPT09IFwib2tcIikgcmV0dXJuIDE7XHJcbiAgICAgIGlmIChiID09PSBcIm9rXCIpIHJldHVybiAtMTtcclxuICAgICAgYWxlcnQoXCIhISEhISEhXCIpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdmFyIHBhbmVsID0gYmFzZS5jcmVhdGVQYW5lbCgkKCcjcGF0aWVudC1wYW5lbCcpLCB7XHJcbiAgICAgIFwib3B0aW9uc1wiOiBkYXRhLm9wdGlvbnMsXHJcbiAgICAgIFwibnVtYmVyT2ZTdGFuZGFyZHNNaXNzZWRcIjogZGF0YS5udW1iZXJPZlN0YW5kYXJkc01pc3NlZChwYXRpZW50SWQpLFxyXG4gICAgICBcInN0YW5kYXJkXCI6IHN0YW4sXHJcbiAgICAgIFwicGF0aHdheVN0YWdlXCI6IHBhdGh3YXlTdGFnZSxcclxuICAgICAgXCJuaHNOdW1iZXJcIjogZGF0YS5wYXRMb29rdXAgPyBkYXRhLnBhdExvb2t1cFtwYXRpZW50SWRdIDogcGF0aWVudElkLFxyXG4gICAgICBcInBhdGllbnRJZFwiOiBwYXRpZW50SWRcclxuICAgIH0sIHtcclxuICAgICAgXCJvcHRpb25cIjogJCgnI3BhdGllbnQtcGFuZWwtZHJvcC1kb3duLW9wdGlvbnMnKS5odG1sKClcclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChzdGFuZGFyZCA9PT0gbnVsbCkge1xyXG4gICAgICAvL011c3QgYmUgYSBwYXRpZW50IGZyb20gdGhlICoqKiBPSyBncm91cFxyXG4gICAgICBzdGFuZGFyZCA9IGRhdGEub3B0aW9ucy5maWx0ZXIoZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgICAgcmV0dXJuIHZhbC5wYXRod2F5SWQgPT09IHBhdGh3YXlJZCAmJiB2YWwucGF0aHdheVN0YWdlID09PSBwYXRod2F5U3RhZ2U7XHJcbiAgICAgIH0pWzBdLnN0YW5kYXJkO1xyXG4gICAgfVxyXG5cclxuICAgIGZhclJpZ2h0UGFuZWwuaHRtbChcIlwiKTtcclxuICAgICQoJyN0ZW1wLWhpZGRlbicpLmh0bWwocGFuZWwpO1xyXG5cclxuICAgIHZhciBhY3Rpb25QbGFuID0gaW5kaXZpZHVhbEFjdGlvblBsYW4uY3JlYXRlKHBhdGh3YXlTdGFnZSk7XHJcbiAgICAkKCcjdGVtcC1oaWRkZW4gI3BhdGllbnQtcGFuZWwtcmlnaHQnKS5odG1sKGFjdGlvblBsYW4pO1xyXG5cclxuICAgIHZhciBxdWFsUGFuZWwgPSBxdWFsaXR5U3RhbmRhcmQuY3JlYXRlKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgIHZhciB0cmVuZFBhbmVsID0gdHJlbmQuY3JlYXRlKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgIHZhciBtZWRQYW5lbCA9IG1lZGljYXRpb24uY3JlYXRlKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgIHZhciBjb2Rlc1BhbmVsID0gb3RoZXJDb2Rlcy5jcmVhdGUocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gICAgdmFyIG1lZENvZGVXcmFwcGVyUGFuZWwgPSBiYXNlLmNyZWF0ZVBhbmVsKCQoJyNvdGhlci1jb2Rlcy1hbmQtbWVkcy13cmFwcGVyLXBhbmVsJykpO1xyXG4gICAgJCgnI3RlbXAtaGlkZGVuICNwYXRpZW50LXBhbmVsLXRvcCcpLmh0bWwocXVhbFBhbmVsKTtcclxuICAgICQoJyN0ZW1wLWhpZGRlbiAjcGF0aWVudC1wYW5lbC1sZWZ0JykuaHRtbChcIlwiKS5hcHBlbmQodHJlbmRQYW5lbCkuYXBwZW5kKG1lZENvZGVXcmFwcGVyUGFuZWwpO1xyXG4gICAgJCgnI3RlbXAtaGlkZGVuICNtZWRDb2RlV3JhcHBlclBhbmVsJykuYXBwZW5kKG1lZFBhbmVsKS5hcHBlbmQoY29kZXNQYW5lbCk7XHJcblxyXG4gICAgaWYgKGZhclJpZ2h0UGFuZWwuaXMoJzp2aXNpYmxlJykpIHtcclxuICAgICAgZmFyUmlnaHRQYW5lbC5mYWRlT3V0KDUwMCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgJCh0aGlzKS5odG1sKCQoJyN0ZW1wLWhpZGRlbicpLmh0bWwoKSk7XHJcbiAgICAgICAgJCgnI3RlbXAtaGlkZGVuJykuaHRtbChcIlwiKTtcclxuICAgICAgICBpbmRpdmlkdWFsQWN0aW9uUGxhbi53aXJlVXAocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gICAgICAgIHF1YWxpdHlTdGFuZGFyZC53aXJlVXAocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gICAgICAgIGJhc2Uud2lyZVVwU3RhbmRhcmREcm9wRG93bihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHB0LnNob3dJbmRpdmlkdWFsUGF0aWVudFBhbmVsKTtcclxuICAgICAgICB0cmVuZC53aXJlVXAocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gICAgICAgIG1lZGljYXRpb24ud2lyZVVwKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgICAgICBvdGhlckNvZGVzLndpcmVVcChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcbiAgICAgICAgY2hhcnQuZHJhd1RyZW5kQ2hhcnQocGF0aWVudElkLCBwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQpO1xyXG4gICAgICAgICQodGhpcykuZmFkZUluKDUwMCwgZnVuY3Rpb24oKSB7fSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgZmFyUmlnaHRQYW5lbC5odG1sKCQoJyN0ZW1wLWhpZGRlbicpLmh0bWwoKSk7XHJcbiAgICAgICQoJyN0ZW1wLWhpZGRlbicpLmh0bWwoXCJcIik7XHJcbiAgICAgIGluZGl2aWR1YWxBY3Rpb25QbGFuLndpcmVVcChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcbiAgICAgIHF1YWxpdHlTdGFuZGFyZC53aXJlVXAocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gICAgICBiYXNlLndpcmVVcFN0YW5kYXJkRHJvcERvd24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwdC5zaG93SW5kaXZpZHVhbFBhdGllbnRQYW5lbCk7XHJcbiAgICAgIHRyZW5kLndpcmVVcChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcbiAgICAgIG1lZGljYXRpb24ud2lyZVVwKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgICAgb3RoZXJDb2Rlcy53aXJlVXAocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gICAgICBjaGFydC5kcmF3VHJlbmRDaGFydChwYXRpZW50SWQsIHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCk7XHJcbiAgICAgIGZhclJpZ2h0UGFuZWwuZmFkZUluKDUwMCwgZnVuY3Rpb24oKSB7fSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gcHQ7XHJcbiIsInZhciBiYXNlID0gcmVxdWlyZSgnLi4vYmFzZS5qcycpLFxyXG4gIGRhdGEgPSByZXF1aXJlKCcuLi9kYXRhLmpzJyksXHJcbiAgbG9nID0gcmVxdWlyZSgnLi4vbG9nLmpzJyksXHJcbiAgY29uZmlybSA9IHJlcXVpcmUoJy4vY29uZmlybS5qcycpO1xyXG5cclxudmFyIElEID0gXCJRVUFMSVRZU1RBTkRBUkRcIjtcclxuXHJcbnZhciBxcyA9IHtcclxuXHJcbiAgY3JlYXRlOiBmdW5jdGlvbihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCkge1xyXG5cclxuICAgIHZhciBsb2NhbERhdGEgPSB7XHJcbiAgICAgIFwibmhzTnVtYmVyXCI6IGRhdGEucGF0TG9va3VwID8gZGF0YS5wYXRMb29rdXBbcGF0aWVudElkXSA6IHBhdGllbnRJZCxcclxuICAgICAgXCJwYXRpZW50SWRcIjogcGF0aWVudElkXHJcbiAgICB9O1xyXG4gICAgbG9jYWxEYXRhLnN0YW5kYXJkID0gZGF0YS5wYXRod2F5TmFtZXNbcGF0aHdheUlkXSArICcgLSAnICsgcGF0aHdheVN0YWdlO1xyXG4gICAgaWYgKGRhdGEucGF0aWVudHNbcGF0aWVudElkXS5zdGFuZGFyZHMgJiYgZGF0YS5wYXRpZW50c1twYXRpZW50SWRdLnN0YW5kYXJkc1twYXRod2F5SWRdICYmXHJcbiAgICAgIGRhdGEucGF0aWVudHNbcGF0aWVudElkXS5zdGFuZGFyZHNbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdICYmXHJcbiAgICAgIGRhdGEucGF0aWVudHNbcGF0aWVudElkXS5zdGFuZGFyZHNbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdW3N0YW5kYXJkXSkge1xyXG4gICAgICBsb2NhbERhdGEuc3RhbmRhcmQgPSBkYXRhLnBhdGllbnRzW3BhdGllbnRJZF0uc3RhbmRhcmRzW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXVtzdGFuZGFyZF07XHJcbiAgICB9XHJcblxyXG4gICAgbG9jYWxEYXRhLnRvb2x0aXAgPSBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdW1wic3RhbmRhcmQtbWV0LXRvb2x0aXBcIl07XHJcblxyXG4gICAgc3dpdGNoIChkYXRhLmdldFBhdGllbnRTdGF0dXMocGF0aWVudElkLCBwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQpKSB7XHJcbiAgICAgIGNhc2UgXCJva1wiOlxyXG4gICAgICAgIC8vLy9mYXJSaWdodFBhbmVsLnJlbW92ZUNsYXNzKCdzdGFuZGFyZC1taXNzZWQtcGFnZScpLmFkZENsYXNzKCdzdGFuZGFyZC1hY2hpZXZlZC1wYWdlJykucmVtb3ZlQ2xhc3MoJ3N0YW5kYXJkLW5vdC1yZWxldmFudC1wYWdlJyk7XHJcbiAgICAgICAgbG9jYWxEYXRhLmFjaGlldmVkID0gdHJ1ZTtcclxuICAgICAgICBsb2NhbERhdGEucmVsZXZhbnQgPSB0cnVlO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIFwibWlzc2VkXCI6XHJcbiAgICAgICAgLy8vL2ZhclJpZ2h0UGFuZWwuYWRkQ2xhc3MoJ3N0YW5kYXJkLW1pc3NlZC1wYWdlJykucmVtb3ZlQ2xhc3MoJ3N0YW5kYXJkLWFjaGlldmVkLXBhZ2UnKS5yZW1vdmVDbGFzcygnc3RhbmRhcmQtbm90LXJlbGV2YW50LXBhZ2UnKTtcclxuICAgICAgICBsb2NhbERhdGEucmVsZXZhbnQgPSB0cnVlO1xyXG4gICAgICAgIGxvY2FsRGF0YS5hY2hpZXZlZCA9IGZhbHNlO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIFwibm90XCI6XHJcbiAgICAgICAgLy8vL2ZhclJpZ2h0UGFuZWwucmVtb3ZlQ2xhc3MoJ3N0YW5kYXJkLW1pc3NlZC1wYWdlJykucmVtb3ZlQ2xhc3MoJ3N0YW5kYXJkLWFjaGlldmVkLXBhZ2UnKS5hZGRDbGFzcygnc3RhbmRhcmQtbm90LXJlbGV2YW50LXBhZ2UnKTtcclxuICAgICAgICBsb2NhbERhdGEucmVsZXZhbnQgPSBmYWxzZTtcclxuICAgICAgICBicmVhaztcclxuICAgIH1cclxuXHJcbiAgICB2YXIgYWdPYmogPSBsb2cuZ2V0UGF0aWVudEFncmVlT2JqZWN0KHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkLCBcInN0YW5kYXJkXCIpO1xyXG4gICAgaWYgKGFnT2JqICYmIGFnT2JqLmFncmVlKSBsb2NhbERhdGEuYWdyZWUgPSB0cnVlO1xyXG4gICAgZWxzZSBpZiAoYWdPYmogJiYgYWdPYmouYWdyZWUgPT09IGZhbHNlKSBsb2NhbERhdGEuZGlzYWdyZWUgPSB0cnVlO1xyXG5cclxuICAgIHJldHVybiBiYXNlLmNyZWF0ZVBhbmVsKCQoJyNxdWFsLXN0YW5kYXJkJyksIGxvY2FsRGF0YSk7XHJcbiAgfSxcclxuXHJcbiAgc2hvdzogZnVuY3Rpb24ocGFuZWwsIHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKXtcclxuXHJcbiAgICB2YXIgcGFuZWxJZCA9IHBhbmVsLmF0dHIoXCJpZFwiKTtcclxuXHJcbiAgICBpZiAoYmFzZS5wYW5lbHNbcGFuZWxJZF0gJiZcclxuICAgICAgYmFzZS5wYW5lbHNbcGFuZWxJZF0uaWQgPT09IElEICYmXHJcbiAgICAgIGJhc2UucGFuZWxzW3BhbmVsSWRdLnBhdGllbnRJZCA9PT0gcGF0aWVudElkKSB7XHJcbiAgICAgICAgLy9BbHJlYWR5IHNob3dpbmcgdGhlIHJpZ2h0IHRoaW5nXHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGJhc2UucGFuZWxzW3BhbmVsSWRdID0ge1xyXG4gICAgICBpZDogSUQsXHJcbiAgICAgIHBhdGllbnRJZDogcGF0aWVudElkXHJcbiAgICB9O1xyXG5cclxuICAgIHBhbmVsLmh0bWwocXMuY3JlYXRlKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKSk7XHJcbiAgICBxcy53aXJlVXAocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gIH0sXHJcblxyXG4gIHdpcmVVcDogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpIHtcclxuICAgIGNvbmZpcm0ud2lyZVVwKCQoJyNxdWFsLWFncmVlLWRpc2FncmVlJyksICQoJyNpbmRpdmlkdWFsLXBhbmVsLWNsYXNzaWZpY2F0aW9uJyksIHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkLCBcInN0YW5kYXJkXCIsIFwicXVhbGl0eSBzdGFuZGFyZFwiKTtcclxuICB9LFxyXG5cclxuICB1cGRhdGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgJCgnI2luZGl2aWR1YWwtcGFuZWwtY2xhc3NpZmljYXRpb24nKS5maW5kKCdkaXYnKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgc2VsZiA9ICQodGhpcyk7XHJcbiAgICAgIHZhciBhbnkgPSBmYWxzZTtcclxuICAgICAgc2VsZi5maW5kKCcuYnRuLXRvZ2dsZSBpbnB1dFt0eXBlPWNoZWNrYm94XTpjaGVja2VkJykuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgaXNDbGFzc2lmaWNhdGlvbiA9ICQodGhpcykuY2xvc2VzdChcImRpdlwiKS5kYXRhKFwiaXNDbGFzc2lmaWNhdGlvblwiKSAhPT0gdW5kZWZpbmVkO1xyXG4gICAgICAgIGFueSA9IHRydWU7XHJcbiAgICAgICAgdmFyIGl0ZW0gPSBsb2cuZ2V0QWdyZWVzKClbZGF0YS5wYXRpZW50SWRdLmZpbHRlcihmdW5jdGlvbihpKSB7XHJcbiAgICAgICAgICByZXR1cm4gaXNDbGFzc2lmaWNhdGlvbiA/IGkuaXRlbSA9PT0gXCJzZWN0aW9uXCIgOiBpLml0ZW0gIT09IFwic2VjdGlvblwiO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciB0b29sO1xyXG4gICAgICAgIGlmICh0aGlzLnZhbHVlID09PSBcInllc1wiKSB7XHJcbiAgICAgICAgICBpZiAoaXRlbSAmJiBpdGVtWzBdLmhpc3RvcnkpIHtcclxuICAgICAgICAgICAgdG9vbCA9IFwiPHA+XCIgKyBpdGVtWzBdLmhpc3RvcnlbMF0gKyBcIjwvcD48cD5DbGljayBhZ2FpbiB0byBjYW5jZWw8L3A+XCI7XHJcbiAgICAgICAgICAgICQodGhpcykucGFyZW50KCkuYXR0cihcInRpdGxlXCIsIHRvb2wpLmF0dHIoXCJkYXRhLW9yaWdpbmFsLXRpdGxlXCIsIHRvb2wpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5hdHRyKFwidGl0bGVcIiwgXCJZb3UgYWdyZWVkIC0gY2xpY2sgYWdhaW4gdG8gY2FuY2VsXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBpZiAoaXRlbSAmJiBpdGVtWzBdLmhpc3RvcnkpIHtcclxuICAgICAgICAgICAgdG9vbCA9IFwiPHA+XCIgKyBpdGVtWzBdLmhpc3RvcnlbMF0gKyBcIjwvcD48cD5DbGljayBhZ2FpbiB0byBlZGl0L2NhbmNlbDwvcD5cIjtcclxuICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5hdHRyKFwidGl0bGVcIiwgdG9vbCkuYXR0cihcImRhdGEtb3JpZ2luYWwtdGl0bGVcIiwgdG9vbCkudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAkKHRoaXMpLnBhcmVudCgpLmF0dHIoXCJ0aXRsZVwiLCBcIllvdSBkaXNhZ3JlZWQgLSBjbGljayBhZ2FpbiB0byBlZGl0L2NhbmNlbFwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgaWYgKHNlbGYuZmluZCgnLmJ0bi10b2dnbGUgaW5wdXRbdHlwZT1jaGVja2JveF06bm90KDpjaGVja2VkKScpLmxlbmd0aCA9PSAxKSB7XHJcbiAgICAgICAgc2VsZi5maW5kKCcuYnRuLXRvZ2dsZSBpbnB1dFt0eXBlPWNoZWNrYm94XTpub3QoOmNoZWNrZWQpJykucGFyZW50KCkuYWRkQ2xhc3MoXCJpbmFjdGl2ZVwiKS5hdHRyKFwidGl0bGVcIiwgXCJcIikuYXR0cihcImRhdGEtb3JpZ2luYWwtdGl0bGVcIiwgXCJcIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmICghYW55KSB7XHJcbiAgICAgICAgc2VsZi5maW5kKCcuYnRuLXRvZ2dsZS5idG4teWVzJykuYXR0cihcInRpdGxlXCIsIFwiQ2xpY2sgdG8gYWdyZWUgd2l0aCB0aGlzIGFjdGlvbiBhbmQgc2F2ZSBpdCBpbiB5b3VyIGFncmVlZCBhY3Rpb25zIGxpc3QgIFwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgICBzZWxmLmZpbmQoJy5idG4tdG9nZ2xlLmJ0bi1ubycpLmF0dHIoXCJ0aXRsZVwiLCBcIkNsaWNrIHRvIGRpc2FncmVlIHdpdGggdGhpcyBhY3Rpb24gYW5kIHJlbW92ZSBpdCBmcm9tIHlvdXIgc3VnZ2VzdGVkIGFjdGlvbnMgbGlzdCBcIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBxcztcclxuIiwidmFyIGJhc2UgPSByZXF1aXJlKCcuLi9iYXNlLmpzJyksXHJcbiAgY29uZmlybSA9IHJlcXVpcmUoJy4vY29uZmlybS5qcycpLFxyXG4gIGRhdGEgPSByZXF1aXJlKCcuLi9kYXRhLmpzJyksXHJcbiAgbG9nID0gcmVxdWlyZSgnLi4vbG9nLmpzJyk7XHJcblxyXG52YXIgdGFwID0ge1xyXG5cclxuICBzaG93OiBmdW5jdGlvbihsb2NhdGlvbikge1xyXG4gICAgbG9jYXRpb24ucmVtb3ZlQ2xhc3MoJ3N0YW5kYXJkLW1pc3NlZC1wYWdlJykucmVtb3ZlQ2xhc3MoJ3N0YW5kYXJkLWFjaGlldmVkLXBhZ2UnKS5yZW1vdmVDbGFzcygnc3RhbmRhcmQtbm90LXJlbGV2YW50LXBhZ2UnKTtcclxuICAgIGJhc2UuY3JlYXRlUGFuZWxTaG93KCQoJyN0ZWFtLWFjdGlvbi1wbGFuLXBhbmVsJyksIGxvY2F0aW9uKTtcclxuXHJcbiAgICBzdWdnZXN0ZWRQbGFuVGVhbSA9ICQoJyNzdWdnZXN0ZWRQbGFuVGVhbScpO1xyXG5cclxuICAgIHN1Z2dlc3RlZFBsYW5UZWFtLm9uKCdjbGljaycsICcuY3Itc3R5bGVkIGlucHV0W3R5cGU9Y2hlY2tib3hdJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBBQ1RJT05JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKCdpZCcpO1xyXG4gICAgICBsb2cuZWRpdEFjdGlvbihcInRlYW1cIiwgQUNUSU9OSUQsIG51bGwsIHRoaXMuY2hlY2tlZCk7XHJcblxyXG4gICAgICBpZiAodGhpcy5jaGVja2VkKSB7XHJcbiAgICAgICAgbG9nLnJlY29yZEV2ZW50KGRhdGEucGF0aHdheUlkLCBcInRlYW1cIiwgXCJJdGVtIGNvbXBsZXRlZFwiKTtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgJChzZWxmKS5wYXJlbnQoKS5hdHRyKFwidGl0bGVcIiwgXCJcIikuYXR0cihcImRhdGEtb3JpZ2luYWwtdGl0bGVcIiwgXCJcIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgJChzZWxmKS5wYXJlbnQoKS5mYWRlT3V0KDMwMCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBwYXJlbnQgPSAkKHRoaXMpLnBhcmVudCgpO1xyXG4gICAgICAgICAgICAkKHRoaXMpLnJlcGxhY2VXaXRoKGJhc2UuY3JlYXRlUGFuZWwoJCgnI2NoZWNrYm94LXRlbXBsYXRlJyksIHtcclxuICAgICAgICAgICAgICBcImRvbmVcIjogdHJ1ZVxyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgIHBhcmVudC5maW5kKCdidXR0b24nKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICBBQ1RJT05JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKCdpZCcpO1xyXG4gICAgICAgICAgICAgIGxvZy5lZGl0QWN0aW9uKFwidGVhbVwiLCBBQ1RJT05JRCwgbnVsbCwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICQodGhpcykucmVwbGFjZVdpdGgoYmFzZS5jcmVhdGVQYW5lbCgkKCcjY2hlY2tib3gtdGVtcGxhdGUnKSwge1xyXG4gICAgICAgICAgICAgICAgXCJkb25lXCI6IGZhbHNlXHJcbiAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgIHRhcC51cGRhdGVUZWFtU2FwUm93cygpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sIDEwMDApO1xyXG4gICAgICB9XHJcblxyXG4gICAgICB0YXAudXBkYXRlVGVhbVNhcFJvd3MoKTtcclxuICAgIH0pO1xyXG5cclxuICAgICQoJyNwZXJzb25hbFBsYW5UZWFtJykub24oJ2NsaWNrJywgJ2lucHV0W3R5cGU9Y2hlY2tib3hdJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBQTEFOSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YShcImlkXCIpO1xyXG4gICAgICBlZGl0UGxhbihQTEFOSUQsIG51bGwsIHRoaXMuY2hlY2tlZCk7XHJcblxyXG4gICAgICBpZiAodGhpcy5jaGVja2VkKSB7XHJcbiAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5wYXJlbnQoKS5wYXJlbnQoKS5hZGRDbGFzcygnc3VjY2VzcycpO1xyXG4gICAgICAgIHJlY29yZEV2ZW50KGRhdGEucGF0aHdheUlkLCBcInRlYW1cIiwgXCJQZXJzb25hbCBwbGFuIGl0ZW1cIik7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgICQoc2VsZikucGFyZW50KCkuYXR0cihcInRpdGxlXCIsIFwiXCIpLmF0dHIoXCJkYXRhLW9yaWdpbmFsLXRpdGxlXCIsIFwiXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgJChzZWxmKS5wYXJlbnQoKS5mYWRlT3V0KDMwMCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBwYXJlbnQgPSAkKHRoaXMpLnBhcmVudCgpO1xyXG4gICAgICAgICAgICAkKHRoaXMpLnJlcGxhY2VXaXRoKGJhc2UuY3JlYXRlUGFuZWwoJCgnI2NoZWNrYm94LXRlbXBsYXRlJyksIHtcclxuICAgICAgICAgICAgICBcImRvbmVcIjogdHJ1ZVxyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgICAgICAgICAgcGFyZW50LmZpbmQoJ2J1dHRvbicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgIFBMQU5JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKCdpZCcpO1xyXG4gICAgICAgICAgICAgIGVkaXRQbGFuKFwidGVhbVwiLCBQTEFOSUQsIG51bGwsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAkKHRoaXMpLnJlcGxhY2VXaXRoKGJhc2UuY3JlYXRlUGFuZWwoJCgnI2NoZWNrYm94LXRlbXBsYXRlJyksIHtcclxuICAgICAgICAgICAgICAgIFwiZG9uZVwiOiBmYWxzZVxyXG4gICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgICB0YXAudXBkYXRlVGVhbVNhcFJvd3MoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9LCAxMDAwKTtcclxuICAgICAgfVxyXG5cclxuICAgIH0pLm9uKCdjbGljaycsICcuYnRuLXVuZG8nLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIHZhciBQTEFOSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YSgnaWQnKTtcclxuICAgICAgbG9nLmVkaXRQbGFuKFBMQU5JRCwgbnVsbCwgZmFsc2UpO1xyXG4gICAgICAkKHRoaXMpLnJlcGxhY2VXaXRoKGJhc2UuY3JlYXRlUGFuZWwoJCgnI2NoZWNrYm94LXRlbXBsYXRlJyksIHtcclxuICAgICAgICBcImRvbmVcIjogZmFsc2VcclxuICAgICAgfSkpO1xyXG4gICAgICB0YXAudXBkYXRlVGVhbVNhcFJvd3MoKTtcclxuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHZhciB0ZWFtVGFiID0gJCgnI3RhYi1wbGFuLXRlYW0nKSxcclxuICAgICAgY3VycmVudDtcclxuICAgIHRlYW1UYWIub24oJ2NsaWNrJywgJy5lZGl0LXBsYW4nLCBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIFBMQU5JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKFwiaWRcIik7XHJcblxyXG4gICAgICAkKCcjZWRpdEFjdGlvblBsYW5JdGVtJykudmFsKCQoJCh0aGlzKS5jbG9zZXN0KCd0cicpLmNoaWxkcmVuKCd0ZCcpWzBdKS5maW5kKCdzcGFuJykudGV4dCgpKTtcclxuXHJcbiAgICAgICQoJyNlZGl0UGxhbicpLm9mZignaGlkZGVuLmJzLm1vZGFsJykub24oJ2hpZGRlbi5icy5tb2RhbCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRhcC5kaXNwbGF5UGVyc29uYWxpc2VkVGVhbUFjdGlvblBsYW4oJCgnI3BlcnNvbmFsUGxhblRlYW0nKSk7XHJcbiAgICAgIH0pLm9mZignc2hvd24uYnMubW9kYWwnKS5vbignc2hvd24uYnMubW9kYWwnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAkKCcjZWRpdEFjdGlvblBsYW5JdGVtJykuZm9jdXMoKTtcclxuICAgICAgfSkub2ZmKCdjbGljaycsICcuc2F2ZS1wbGFuJykub24oJ2NsaWNrJywgJy5zYXZlLXBsYW4nLCBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgbG9nLmVkaXRQbGFuKFBMQU5JRCwgJCgnI2VkaXRBY3Rpb25QbGFuSXRlbScpLnZhbCgpKTtcclxuXHJcbiAgICAgICAgJCgnI2VkaXRQbGFuJykubW9kYWwoJ2hpZGUnKTtcclxuICAgICAgfSkub2ZmKCdrZXl1cCcsICcjZWRpdEFjdGlvblBsYW5JdGVtJykub24oJ2tleXVwJywgJyNlZGl0QWN0aW9uUGxhbkl0ZW0nLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgaWYgKGUud2hpY2ggPT09IDEzKSAkKCcjZWRpdFBsYW4gLnNhdmUtcGxhbicpLmNsaWNrKCk7XHJcbiAgICAgIH0pLm1vZGFsKCk7XHJcbiAgICB9KS5vbignY2xpY2snLCAnLmRlbGV0ZS1wbGFuJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBQTEFOSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YShcImlkXCIpO1xyXG5cclxuICAgICAgJCgnI3RlYW0tZGVsZXRlLWl0ZW0nKS5odG1sKCQoJCh0aGlzKS5jbG9zZXN0KCd0cicpLmNoaWxkcmVuKCd0ZCcpWzBdKS5maW5kKCdzcGFuJykudGV4dCgpKTtcclxuXHJcbiAgICAgICQoJyNkZWxldGVQbGFuJykub2ZmKCdoaWRkZW4uYnMubW9kYWwnKS5vbignaGlkZGVuLmJzLm1vZGFsJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGFwLmRpc3BsYXlQZXJzb25hbGlzZWRUZWFtQWN0aW9uUGxhbigkKCcjcGVyc29uYWxQbGFuVGVhbScpKTtcclxuICAgICAgfSkub2ZmKCdjbGljaycsICcuZGVsZXRlLXBsYW4nKS5vbignY2xpY2snLCAnLmRlbGV0ZS1wbGFuJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgbG9nLmRlbGV0ZVBsYW4oUExBTklEKTtcclxuXHJcbiAgICAgICAgJCgnI2RlbGV0ZVBsYW4nKS5tb2RhbCgnaGlkZScpO1xyXG4gICAgICB9KS5tb2RhbCgpO1xyXG4gICAgfSkub24oJ2NsaWNrJywgJy5hZGQtcGxhbicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICBsb2cucmVjb3JkUGxhbihcInRlYW1cIiwgJCh0aGlzKS5wYXJlbnQoKS5wYXJlbnQoKS5maW5kKCd0ZXh0YXJlYScpLnZhbCgpLCBkYXRhLnBhdGh3YXlJZCk7XHJcblxyXG4gICAgICB0YXAuZGlzcGxheVBlcnNvbmFsaXNlZFRlYW1BY3Rpb25QbGFuKCQoJyNwZXJzb25hbFBsYW5UZWFtJykpO1xyXG4gICAgfSkub24oJ2NoYW5nZScsICcuYnRuLXRvZ2dsZSBpbnB1dFt0eXBlPWNoZWNrYm94XScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICB0YXAudXBkYXRlVGVhbVNhcFJvd3MoKTtcclxuICAgIH0pLm9uKCdjbGljaycsICcuYnRuLXVuZG8nLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIHZhciBBQ1RJT05JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKCdpZCcpO1xyXG4gICAgICBsb2cuZWRpdEFjdGlvbihcInRlYW1cIiwgQUNUSU9OSUQsIG51bGwsIGZhbHNlKTtcclxuICAgICAgJCh0aGlzKS5yZXBsYWNlV2l0aChiYXNlLmNyZWF0ZVBhbmVsKCQoJyNjaGVja2JveC10ZW1wbGF0ZScpLCB7XHJcbiAgICAgICAgXCJkb25lXCI6IGZhbHNlXHJcbiAgICAgIH0pKTtcclxuICAgICAgdGFwLnVwZGF0ZVRlYW1TYXBSb3dzKCk7XHJcbiAgICB9KS5vbignY2xpY2snLCAnLmJ0bi15ZXMsLmJ0bi1ubycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgdmFyIGNoZWNrYm94ID0gJCh0aGlzKS5maW5kKFwiaW5wdXRbdHlwZT1jaGVja2JveF1cIik7XHJcbiAgICAgIHZhciBvdGhlciA9ICQodGhpcykucGFyZW50KCkuZmluZCgkKHRoaXMpLmhhc0NsYXNzKFwiYnRuLXllc1wiKSA/IFwiLmJ0bi1ub1wiIDogXCIuYnRuLXllc1wiKTtcclxuICAgICAgdmFyIEFDVElPTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoJ2lkJyk7XHJcbiAgICAgIGlmICgkKHRoaXMpLmhhc0NsYXNzKFwiYWN0aXZlXCIpICYmIG90aGVyLmhhc0NsYXNzKFwiaW5hY3RpdmVcIikgJiYgISQodGhpcykuY2xvc2VzdCgndHInKS5oYXNDbGFzcygnc3VjY2VzcycpKSB7XHJcbiAgICAgICAgLy91bnNlbGVjdGluZ1xyXG4gICAgICAgIGlmIChjaGVja2JveC52YWwoKSA9PT0gXCJub1wiKSB7XHJcbiAgICAgICAgICB0YXAubGF1bmNoTW9kYWwoZGF0YS5zZWxlY3RlZCwgY2hlY2tib3guY2xvc2VzdCgndHInKS5jaGlsZHJlbigpLmZpcnN0KCkuY2hpbGRyZW4oKS5maXJzdCgpLnRleHQoKSwgbG9nLmdldFJlYXNvbihcInRlYW1cIiwgQUNUSU9OSUQpLCB0cnVlLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgbG9nLmVkaXRBY3Rpb24oXCJ0ZWFtXCIsIEFDVElPTklELCBmYWxzZSwgbnVsbCwgbG9nLnJlYXNvbik7XHJcbiAgICAgICAgICAgIHRhcC51cGRhdGVUZWFtU2FwUm93cygpO1xyXG4gICAgICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICAgICAgICB9LCBudWxsLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgbG9nLmlnbm9yZUFjdGlvbihcInRlYW1cIiwgQUNUSU9OSUQpO1xyXG4gICAgICAgICAgICBvdGhlci5yZW1vdmVDbGFzcyhcImluYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICBjaGVja2JveC5yZW1vdmVBdHRyKFwiY2hlY2tlZFwiKTtcclxuICAgICAgICAgICAgY2hlY2tib3gucGFyZW50KCkucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XHJcbiAgICAgICAgICAgIHRhcC51cGRhdGVUZWFtU2FwUm93cygpO1xyXG4gICAgICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGxvZy5pZ25vcmVBY3Rpb24oXCJ0ZWFtXCIsIEFDVElPTklEKTtcclxuICAgICAgICAgIG90aGVyLnJlbW92ZUNsYXNzKFwiaW5hY3RpdmVcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2UgaWYgKCghJCh0aGlzKS5oYXNDbGFzcyhcImFjdGl2ZVwiKSAmJiBvdGhlci5oYXNDbGFzcyhcImFjdGl2ZVwiKSkgfHwgJCh0aGlzKS5jbG9zZXN0KCd0cicpLmhhc0NsYXNzKCdzdWNjZXNzJykpIHtcclxuICAgICAgICAvL3ByZXZlbnQgY2xpY2tpbmcgb24gdW5zZWxlY3RlZCBvcHRpb24gb3IgaWYgdGhlIHJvdyBpcyBjb21wbGV0ZVxyXG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvL3NlbGVjdGluZ1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBpZiAoY2hlY2tib3gudmFsKCkgPT09IFwibm9cIikge1xyXG4gICAgICAgICAgdGFwLmxhdW5jaE1vZGFsKGRhdGEuc2VsZWN0ZWQsIGNoZWNrYm94LmNsb3Nlc3QoJ3RyJykuY2hpbGRyZW4oKS5maXJzdCgpLmNoaWxkcmVuKCkuZmlyc3QoKS50ZXh0KCksIGxvZy5nZXRSZWFzb24oXCJ0ZWFtXCIsIEFDVElPTklEKSwgZmFsc2UsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBsb2cuZWRpdEFjdGlvbihcInRlYW1cIiwgQUNUSU9OSUQsIGZhbHNlLCBudWxsLCBsb2cucmVhc29uKTtcclxuICAgICAgICAgICAgJChzZWxmKS5yZW1vdmVDbGFzcyhcImluYWN0aXZlXCIpO1xyXG5cclxuICAgICAgICAgICAgY2hlY2tib3guYXR0cihcImNoZWNrZWRcIiwgXCJjaGVja2VkXCIpO1xyXG4gICAgICAgICAgICBjaGVja2JveC5wYXJlbnQoKS5hZGRDbGFzcyhcImFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgLy91bnNlbGVjdCBvdGhlclxyXG4gICAgICAgICAgICBvdGhlci5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKS5hZGRDbGFzcyhcImluYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICBvdGhlci5maW5kKFwiaW5wdXRbdHlwZT1jaGVja2JveF1cIikucHJvcChcImNoZWNrZWRcIiwgZmFsc2UpO1xyXG4gICAgICAgICAgICB0YXAudXBkYXRlVGVhbVNhcFJvd3MoKTtcclxuICAgICAgICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBsb2cuZWRpdEFjdGlvbihcInRlYW1cIiwgQUNUSU9OSUQsIHRydWUpO1xyXG4gICAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcyhcImluYWN0aXZlXCIpO1xyXG5cclxuICAgICAgICAgIC8vdW5zZWxlY3Qgb3RoZXJcclxuICAgICAgICAgIG90aGVyLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpLmFkZENsYXNzKFwiaW5hY3RpdmVcIik7XHJcbiAgICAgICAgICBvdGhlci5maW5kKFwiaW5wdXRbdHlwZT1jaGVja2JveF1cIikucHJvcChcImNoZWNrZWRcIiwgZmFsc2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSkub24oJ2tleXVwJywgJ2lucHV0W3R5cGU9dGV4dF0nLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIGlmIChlLndoaWNoID09PSAxMykge1xyXG4gICAgICAgIHRlYW1UYWIuZmluZCgnLmFkZC1wbGFuJykuY2xpY2soKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgdGFwLnBvcHVsYXRlVGVhbVN1Z2dlc3RlZEFjdGlvbnNQYW5lbCgpO1xyXG5cclxuICAgIGxvY2F0aW9uLmZpbmQoJ2Rpdi5maXQtdG8tc2NyZWVuLWhlaWdodCcpLm5pY2VTY3JvbGwoe1xyXG4gICAgICBjdXJzb3JvcGFjaXR5bWluOiAwLjMsXHJcbiAgICAgIGN1cnNvcndpZHRoOiBcIjdweFwiLFxyXG4gICAgICBob3JpenJhaWxlbmFibGVkOiBmYWxzZVxyXG4gICAgfSk7XHJcbiAgfSxcclxuXHJcbiAgcG9wdWxhdGVUZWFtU3VnZ2VzdGVkQWN0aW9uc1BhbmVsOiBmdW5jdGlvbigpIHtcclxuICAgIHZhciBzdWdnZXN0aW9ucyA9IGJhc2Uuc3VnZ2VzdGlvbkxpc3QobG9nLnBsYW5bZGF0YS5wYXRod2F5SWRdLnRlYW0pO1xyXG4gICAgc3VnZ2VzdGlvbnMgPSBiYXNlLnNvcnRTdWdnZXN0aW9ucyh0YXAubWVyZ2VUZWFtU3R1ZmYoc3VnZ2VzdGlvbnMpKTtcclxuXHJcbiAgICBiYXNlLmNyZWF0ZVBhbmVsU2hvdyhzdWdnZXN0ZWRQbGFuVGVtcGxhdGUsIHN1Z2dlc3RlZFBsYW5UZWFtLCB7XHJcbiAgICAgIFwic3VnZ2VzdGlvbnNcIjogc3VnZ2VzdGlvbnNcclxuICAgIH0sIHtcclxuICAgICAgXCJpdGVtXCI6ICQoJyNzdWdnZXN0ZWQtcGxhbi1pdGVtJykuaHRtbCgpLFxyXG4gICAgICBcImNoa1wiOiAkKCcjY2hlY2tib3gtdGVtcGxhdGUnKS5odG1sKClcclxuICAgIH0pO1xyXG5cclxuICAgIHRhcC5kaXNwbGF5UGVyc29uYWxpc2VkVGVhbUFjdGlvblBsYW4oJCgnI3BlcnNvbmFsUGxhblRlYW0nKSk7XHJcbiAgfSxcclxuXHJcbiAgdXBkYXRlVGVhbVNhcFJvd3M6IGZ1bmN0aW9uKCkge1xyXG4gICAgc3VnZ2VzdGVkUGxhblRlYW0uYWRkKCcjcGVyc29uYWxQbGFuVGVhbScpLmZpbmQoJy5zdWdnZXN0aW9uJykuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgJCh0aGlzKS5maW5kKCd0ZCcpLmxhc3QoKS5jaGlsZHJlbigpLmhpZGUoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHN1Z2dlc3RlZFBsYW5UZWFtLmFkZCgnI3BlcnNvbmFsUGxhblRlYW0nKS5maW5kKCcuY3Itc3R5bGVkIGlucHV0W3R5cGU9Y2hlY2tib3hdJykuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgaWYgKHRoaXMuY2hlY2tlZCkge1xyXG4gICAgICAgICQodGhpcykucGFyZW50KCkucGFyZW50KCkucGFyZW50KCkuYWRkQ2xhc3MoJ3N1Y2Nlc3MnKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAkKHRoaXMpLnBhcmVudCgpLnBhcmVudCgpLnBhcmVudCgpLnJlbW92ZUNsYXNzKCdzdWNjZXNzJyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHN1Z2dlc3RlZFBsYW5UZWFtLmFkZCgnI3BlcnNvbmFsUGxhblRlYW0nKS5maW5kKCcuYnRuLXVuZG8nKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICAkKHRoaXMpLnBhcmVudCgpLnBhcmVudCgpLmFkZENsYXNzKCdzdWNjZXNzJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvL25vIGNsYXNzIC0gdXNlciBub3QgeWV0IGFncmVlZC9kaXNhZ3JlZWQgLSBubyBiYWNrZ3JvdW5kIC8gbXV0ZWQgdGV4dFxyXG4gICAgLy9hY3RpdmUgLSB1c2VyIGFncmVlcyAtIGdyZWVuIGJhY2tncm91bmQgLyBub3JtYWwgdGV4dFxyXG4gICAgLy9zdWNjZXNzIC0gdXNlciBjb21wbGV0ZWQgLSBncmVlbiBiYWNrZ3JvdW5kIC8gc3RyaWtldGhyb3VnaCB0ZXh0XHJcbiAgICAvL2RhbmdlciAtIHVzZXIgZGlzYWdyZWVzIC0gcmVkIGJhY2tncm91bmQgLyBzdHJpa2V0aHJvdWdoIHRleHRcclxuICAgIHN1Z2dlc3RlZFBsYW5UZWFtLmFkZCgnI3BlcnNvbmFsUGxhblRlYW0nKS5maW5kKCd0cicpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBzZWxmID0gJCh0aGlzKTtcclxuICAgICAgdmFyIGFueSA9IGZhbHNlO1xyXG4gICAgICBzZWxmLmZpbmQoJy5idG4tdG9nZ2xlIGlucHV0W3R5cGU9Y2hlY2tib3hdOmNoZWNrZWQnKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGFueSA9IHRydWU7XHJcbiAgICAgICAgaWYgKHRoaXMudmFsdWUgPT09IFwieWVzXCIpIHtcclxuICAgICAgICAgIHNlbGYucmVtb3ZlQ2xhc3MoJ2RhbmdlcicpO1xyXG4gICAgICAgICAgc2VsZi5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgICBzZWxmLmZpbmQoJ3RkJykubGFzdCgpLmNoaWxkcmVuKCkuc2hvdygpO1xyXG4gICAgICAgICAgaWYgKGxvZy5nZXRBY3Rpb25zKCkudGVhbVtzZWxmLmRhdGEoXCJpZFwiKV0uaGlzdG9yeSkge1xyXG4gICAgICAgICAgICB2YXIgdG9vbCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5oYXNDbGFzcygnc3VjY2VzcycpID8gXCJcIiA6IFwiPHA+XCIgKyBsb2cuZ2V0QWN0aW9ucygpLnRlYW1bc2VsZi5kYXRhKFwiaWRcIildLmhpc3RvcnlbMF0gKyBcIjwvcD48cD5DbGljayBhZ2FpbiB0byBjYW5jZWw8L3A+XCI7XHJcbiAgICAgICAgICAgICQodGhpcykucGFyZW50KCkuYXR0cihcInRpdGxlXCIsIHRvb2wpLmF0dHIoXCJkYXRhLW9yaWdpbmFsLXRpdGxlXCIsIHRvb2wpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5hdHRyKFwidGl0bGVcIiwgXCJZb3UgYWdyZWVkIC0gY2xpY2sgYWdhaW4gdG8gY2FuY2VsXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBzZWxmLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgIHNlbGYuYWRkQ2xhc3MoJ2RhbmdlcicpO1xyXG4gICAgICAgICAgc2VsZi5yZW1vdmVDbGFzcygnc3VjY2VzcycpO1xyXG4gICAgICAgICAgaWYgKGxvZy5nZXRBY3Rpb25zKCkudGVhbVtzZWxmLmRhdGEoXCJpZFwiKV0gJiYgbG9nLmdldEFjdGlvbnMoKS50ZWFtW3NlbGYuZGF0YShcImlkXCIpXS5oaXN0b3J5KSB7XHJcbiAgICAgICAgICAgICQodGhpcykucGFyZW50KCkuYXR0cihcInRpdGxlXCIsIFwiPHA+XCIgKyBsb2cuZ2V0QWN0aW9ucygpLnRlYW1bc2VsZi5kYXRhKFwiaWRcIildLmhpc3RvcnlbMF0gKyBcIjwvcD48cD5DbGljayBhZ2FpbiB0byBlZGl0L2NhbmNlbDwvcD5cIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAkKHRoaXMpLnBhcmVudCgpLmF0dHIoXCJ0aXRsZVwiLCBcIllvdSBkaXNhZ3JlZWQgLSBjbGljayBhZ2FpbiB0byBlZGl0L2NhbmNlbFwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgICBpZiAoc2VsZi5maW5kKCcuYnRuLXRvZ2dsZSBpbnB1dFt0eXBlPWNoZWNrYm94XTpub3QoOmNoZWNrZWQpJykubGVuZ3RoID09IDEpIHtcclxuICAgICAgICBzZWxmLmZpbmQoJy5idG4tdG9nZ2xlIGlucHV0W3R5cGU9Y2hlY2tib3hdOm5vdCg6Y2hlY2tlZCknKS5wYXJlbnQoKS5hZGRDbGFzcyhcImluYWN0aXZlXCIpLmF0dHIoXCJ0aXRsZVwiLCBcIlwiKS5hdHRyKFwiZGF0YS1vcmlnaW5hbC10aXRsZVwiLCBcIlwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAoIWFueSkge1xyXG4gICAgICAgIHNlbGYucmVtb3ZlQ2xhc3MoJ2RhbmdlcicpO1xyXG4gICAgICAgIHNlbGYucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgIHNlbGYucmVtb3ZlQ2xhc3MoJ3N1Y2Nlc3MnKTtcclxuXHJcbiAgICAgICAgc2VsZi5maW5kKCcuYnRuLXRvZ2dsZS5idG4teWVzJykuYXR0cihcInRpdGxlXCIsIFwiQ2xpY2sgdG8gYWdyZWUgd2l0aCB0aGlzIGFjdGlvbiBhbmQgc2F2ZSBpdCBpbiB5b3VyIGFncmVlZCBhY3Rpb25zIGxpc3QgIFwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgICBzZWxmLmZpbmQoJy5idG4tdG9nZ2xlLmJ0bi1ubycpLmF0dHIoXCJ0aXRsZVwiLCBcIkNsaWNrIHRvIGRpc2FncmVlIHdpdGggdGhpcyBhY3Rpb24gYW5kIHJlbW92ZSBpdCBmcm9tIHlvdXIgc3VnZ2VzdGVkIGFjdGlvbnMgbGlzdCBcIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICB9LFxyXG5cclxuICBkaXNwbGF5UGVyc29uYWxpc2VkVGVhbUFjdGlvblBsYW46IGZ1bmN0aW9uKHBhcmVudEVsZW0pIHtcclxuICAgIHZhciBwbGFucyA9IGJhc2Uuc29ydFN1Z2dlc3Rpb25zKGJhc2UuYWRkRGlzYWdyZWVQZXJzb25hbFRlYW0obG9nLmxpc3RQbGFucyhcInRlYW1cIiwgZGF0YS5wYXRod2F5SWQpKSk7XHJcblxyXG4gICAgYmFzZS5jcmVhdGVQYW5lbFNob3coYWN0aW9uUGxhbkxpc3QsIHBhcmVudEVsZW0sIHtcclxuICAgICAgXCJoYXNTdWdnZXN0aW9uc1wiOiBwbGFucyAmJiBwbGFucy5sZW5ndGggPiAwLFxyXG4gICAgICBcInN1Z2dlc3Rpb25zXCI6IHBsYW5zXHJcbiAgICB9LCB7XHJcbiAgICAgIFwiYWN0aW9uLXBsYW5cIjogJCgnI2FjdGlvbi1wbGFuJykuaHRtbCgpLFxyXG4gICAgICBcImFjdGlvbi1wbGFuLWl0ZW1cIjogJCgnI2FjdGlvbi1wbGFuLWl0ZW0nKS5odG1sKCksXHJcbiAgICAgIFwiY2hrXCI6ICQoJyNjaGVja2JveC10ZW1wbGF0ZScpLmh0bWwoKVxyXG4gICAgfSk7XHJcblxyXG4gICAgdGFwLnVwZGF0ZVRlYW1TYXBSb3dzKCk7XHJcbiAgfSxcclxuXHJcbiAgbWVyZ2VUZWFtU3R1ZmY6IGZ1bmN0aW9uKHN1Z2dlc3Rpb25zKSB7XHJcbiAgICB2YXIgdGVhbUFjdGlvbnMgPSBsb2cubGlzdEFjdGlvbnMoKTtcclxuICAgIGlmICghdGVhbUFjdGlvbnMudGVhbSkgcmV0dXJuIHN1Z2dlc3Rpb25zO1xyXG5cclxuICAgIHN1Z2dlc3Rpb25zID0gdGFwLmFkZERpc2FncmVlKHN1Z2dlc3Rpb25zLCB0ZWFtQWN0aW9ucywgXCJ0ZWFtXCIpO1xyXG4gICAgcmV0dXJuIHN1Z2dlc3Rpb25zO1xyXG4gIH0sXHJcblxyXG4gIGxhdW5jaE1vZGFsOiBmdW5jdGlvbihsYWJlbCwgdmFsdWUsIHJlYXNvbiwgaXNVbmRvLCBjYWxsYmFja09uU2F2ZSwgY2FsbGJhY2tPbkNhbmNlbCwgY2FsbGJhY2tPblVuZG8pIHtcclxuICAgIHZhciByZWFzb25zID0gW3tcclxuICAgICAgXCJyZWFzb25cIjogXCJXZSd2ZSBhbHJlYWR5IGRvbmUgdGhpc1wiLFxyXG4gICAgICBcInZhbHVlXCI6IFwiZG9uZVwiXHJcbiAgICB9LCB7XHJcbiAgICAgIFwicmVhc29uXCI6IFwiSXQgd291bGRuJ3Qgd29ya1wiLFxyXG4gICAgICBcInZhbHVlXCI6IFwibm93b3JrXCJcclxuICAgIH0sIHtcclxuICAgICAgXCJyZWFzb25cIjogXCJPdGhlclwiLFxyXG4gICAgICBcInZhbHVlXCI6IFwiZWxzZVwiXHJcbiAgICB9XTtcclxuICAgIGlmIChyZWFzb24gJiYgcmVhc29uLnJlYXNvbikge1xyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlYXNvbnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBpZiAocmVhc29uc1tpXS5yZWFzb24gPT09IHJlYXNvbi5yZWFzb24pIHtcclxuICAgICAgICAgIHJlYXNvbnNbaV0uY2hlY2tlZCA9IHRydWU7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGJhc2UubGF1bmNoTW9kYWwoe1xyXG4gICAgICBcImhlYWRlclwiOiBcIkRpc2FncmVlIHdpdGggYSBzdWdnZXN0ZWQgYWN0aW9uXCIsXHJcbiAgICAgIFwiaXNVbmRvXCI6IGlzVW5kbyxcclxuICAgICAgXCJpdGVtXCI6IHZhbHVlLFxyXG4gICAgICBcInBsYWNlaG9sZGVyXCI6IFwiRW50ZXIgZnJlZS10ZXh0IGhlcmUuLi5cIixcclxuICAgICAgXCJyZWFzb25zXCI6IHJlYXNvbnNcclxuICAgIH0sIGxhYmVsLCB2YWx1ZSwgcmVhc29uID8gcmVhc29uLnJlYXNvblRleHQgOiBudWxsLCBjYWxsYmFja09uU2F2ZSwgY2FsbGJhY2tPbkNhbmNlbCwgY2FsbGJhY2tPblVuZG8pO1xyXG4gIH0sXHJcblxyXG4gIGFkZERpc2FncmVlOiBmdW5jdGlvbihzdWdnZXN0aW9ucywgYWN0aW9ucywgaWQpIHtcclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3VnZ2VzdGlvbnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgaWYgKGFjdGlvbnNbaWRdW3N1Z2dlc3Rpb25zW2ldLmlkXSkge1xyXG4gICAgICAgIGlmIChhY3Rpb25zW2lkXVtzdWdnZXN0aW9uc1tpXS5pZF0uYWdyZWUpIHtcclxuICAgICAgICAgIHN1Z2dlc3Rpb25zW2ldLmFncmVlID0gdHJ1ZTtcclxuICAgICAgICAgIHN1Z2dlc3Rpb25zW2ldLmRpc2FncmVlID0gZmFsc2U7XHJcbiAgICAgICAgfSBlbHNlIGlmIChhY3Rpb25zW2lkXVtzdWdnZXN0aW9uc1tpXS5pZF0uYWdyZWUgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgICBzdWdnZXN0aW9uc1tpXS5hZ3JlZSA9IGZhbHNlO1xyXG4gICAgICAgICAgc3VnZ2VzdGlvbnNbaV0uZGlzYWdyZWUgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoYWN0aW9uc1tpZF1bc3VnZ2VzdGlvbnNbaV0uaWRdLmRvbmUpIHN1Z2dlc3Rpb25zW2ldLmRvbmUgPSBhY3Rpb25zW2lkXVtzdWdnZXN0aW9uc1tpXS5pZF0uZG9uZTtcclxuICAgICAgICBlbHNlIHN1Z2dlc3Rpb25zW2ldLmRvbmUgPSBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHN1Z2dlc3Rpb25zO1xyXG4gIH1cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHRhcDtcclxuIiwidmFyIGJhc2UgPSByZXF1aXJlKCcuLi9iYXNlLmpzJyksXHJcbiAgY29uZmlybSA9IHJlcXVpcmUoJy4vY29uZmlybS5qcycpLFxyXG4gIGRhdGEgPSByZXF1aXJlKCcuLi9kYXRhLmpzJyksXHJcbiAgbG9nID0gcmVxdWlyZSgnLi4vbG9nLmpzJyksXHJcbiAgbG9va3VwID0gcmVxdWlyZSgnLi4vbG9va3VwLmpzJyk7XHJcblxyXG52YXIgdHJuZCA9IHtcclxuXHJcbiAgY3JlYXRlOiBmdW5jdGlvbihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCkge1xyXG4gICAgdmFyIGFncmVlID0gbG9nLmdldFBhdGllbnRBZ3JlZU9iamVjdChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCwgXCJ0cmVuZFwiKTtcclxuICAgIHJldHVybiBiYXNlLmNyZWF0ZVBhbmVsKHZhbHVlVHJlbmRQYW5lbCwge1xyXG4gICAgICBcInBhdGh3YXlcIjogbG9va3VwLm1vbml0b3JlZFtwYXRod2F5SWRdLFxyXG4gICAgICBcImFncmVlXCI6IGFncmVlICYmIGFncmVlLmFncmVlLFxyXG4gICAgICBcImRpc2FncmVlXCI6IGFncmVlICYmIGFncmVlLmFncmVlID09PSBmYWxzZSxcclxuICAgICAgXCJzdGFuZGFyZFwiOiBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLnRhYi50aXRsZSxcclxuICAgICAgXCJwYXRod2F5U3RhZ2VcIjogcGF0aHdheVN0YWdlXHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICB3aXJlVXA6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKSB7XHJcbiAgICBjb25maXJtLndpcmVVcCgkKCcjdHJlbmQtYWdyZWUtZGlzYWdyZWUnKSwgJCgnI3RyZW5kLXBhbmVsJyksIHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkLCBcInRyZW5kXCIsIFwidHJlbmQgZGF0YVwiKTtcclxuXHJcbiAgICAkKCcjdHJlbmQtcGFuZWwnKS5vbignY2xpY2snLCAnLnRhYmxlLWNoYXJ0LXRvZ2dsZScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICBpZiAoJCh0aGlzKS50ZXh0KCkgPT09IFwiVGFibGVcIikge1xyXG4gICAgICAgICQodGhpcykudGV4dChcIkNoYXJ0XCIpO1xyXG4gICAgICAgICQoJyNjaGFydC1kZW1vLXRyZW5kJykuaGlkZSgpO1xyXG4gICAgICAgICQoJyN0YWJsZS1kZW1vLXRyZW5kJykuc2hvdygpO1xyXG5cclxuICAgICAgICB2YXIgYyA9ICQoJyN0YWJsZS1kZW1vLXRyZW5kIC50YWJsZVNjcm9sbCcpLmdldE5pY2VTY3JvbGwoKTtcclxuICAgICAgICBpZiAoYyAmJiBjLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgIGMucmVzaXplKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICQoJyN0YWJsZS1kZW1vLXRyZW5kIC50YWJsZVNjcm9sbCcpLm5pY2VTY3JvbGwoe1xyXG4gICAgICAgICAgICBjdXJzb3JvcGFjaXR5bWluOiAwLjMsXHJcbiAgICAgICAgICAgIGN1cnNvcndpZHRoOiBcIjdweFwiLFxyXG4gICAgICAgICAgICBob3JpenJhaWxlbmFibGVkOiBmYWxzZVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgICQodGhpcykudGV4dChcIlRhYmxlXCIpO1xyXG4gICAgICAgICQoJyNjaGFydC1kZW1vLXRyZW5kJykuc2hvdygpO1xyXG4gICAgICAgICQoJyN0YWJsZS1kZW1vLXRyZW5kJykuaGlkZSgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSB0cm5kO1xyXG4iLCJ2YXIgYmFzZSA9IHJlcXVpcmUoJy4uL2Jhc2UuanMnKSxcclxuICBkYXRhID0gcmVxdWlyZSgnLi4vZGF0YS5qcycpLFxyXG4gIGxvZyA9IHJlcXVpcmUoJy4uL2xvZy5qcycpLFxyXG4gIGluZGl2aWR1YWxBY3Rpb25QbGFuID0gcmVxdWlyZSgnLi9pbmRpdmlkdWFsQWN0aW9uUGxhbi5qcycpLFxyXG4gIHRlYW1BY3Rpb25QbGFuID0gcmVxdWlyZSgnLi90ZWFtQWN0aW9uUGxhbi5qcycpLFxyXG4gIE11c3RhY2hlID0gcmVxdWlyZSgnbXVzdGFjaGUnKTtcclxuXHJcbnZhciB3ZWxjb21lID0ge1xyXG5cclxuICB3aXJlVXBXZWxjb21lUGFnZTogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UpIHtcclxuICAgICQoJyN0ZWFtLXRhc2stcGFuZWwnKS5vbignY2xpY2snLCAnLmNyLXN0eWxlZCBpbnB1dFt0eXBlPWNoZWNrYm94XScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgQUNUSU9OSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YSgnaWQnKTtcclxuICAgICAgbG9nLmVkaXRBY3Rpb24oXCJ0ZWFtXCIsIEFDVElPTklELCBudWxsLCB0aGlzLmNoZWNrZWQpO1xyXG5cclxuICAgICAgaWYgKHRoaXMuY2hlY2tlZCkge1xyXG4gICAgICAgIGxvZy5yZWNvcmRFdmVudChwYXRod2F5SWQsIFwidGVhbVwiLCBcIkl0ZW0gY29tcGxldGVkXCIpO1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAkKHNlbGYpLnBhcmVudCgpLmF0dHIoXCJ0aXRsZVwiLCBcIlwiKS5hdHRyKFwiZGF0YS1vcmlnaW5hbC10aXRsZVwiLCBcIlwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAkKHNlbGYpLnBhcmVudCgpLmZhZGVPdXQoMzAwLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIHBhcmVudCA9ICQodGhpcykucGFyZW50KCk7XHJcbiAgICAgICAgICAgICQodGhpcykucmVwbGFjZVdpdGgoYmFzZS5jcmVhdGVQYW5lbCgkKCcjY2hlY2tib3gtdGVtcGxhdGUnKSwge1xyXG4gICAgICAgICAgICAgIFwiZG9uZVwiOiB0cnVlXHJcbiAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgcGFyZW50LmZpbmQoJ2J1dHRvbicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgIEFDVElPTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoJ2lkJyk7XHJcbiAgICAgICAgICAgICAgbG9nLmVkaXRBY3Rpb24oXCJ0ZWFtXCIsIEFDVElPTklELCBudWxsLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgJCh0aGlzKS5yZXBsYWNlV2l0aChiYXNlLmNyZWF0ZVBhbmVsKCQoJyNjaGVja2JveC10ZW1wbGF0ZScpLCB7XHJcbiAgICAgICAgICAgICAgICBcImRvbmVcIjogZmFsc2VcclxuICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgd2VsY29tZS51cGRhdGVXZWxjb21lUGFnZSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sIDEwMDApO1xyXG4gICAgICB9XHJcbiAgICAgIHdlbGNvbWUudXBkYXRlV2VsY29tZVBhZ2UoKTtcclxuICAgIH0pLm9uKCdjaGFuZ2UnLCAnLmJ0bi10b2dnbGUgaW5wdXRbdHlwZT1jaGVja2JveF0nLCBmdW5jdGlvbigpIHtcclxuICAgICAgd2VsY29tZS51cGRhdGVXZWxjb21lUGFnZSgpO1xyXG4gICAgfSkub24oJ2NsaWNrJywgJy5lZGl0LXBsYW4nLCBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIFBMQU5JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKFwiaWRcIik7XHJcblxyXG4gICAgICAkKCcjZWRpdEFjdGlvblBsYW5JdGVtJykudmFsKCQoJCh0aGlzKS5jbG9zZXN0KCd0cicpLmNoaWxkcmVuKCd0ZCcpWzFdKS5maW5kKCdzcGFuJykudGV4dCgpKTtcclxuXHJcbiAgICAgICQoJyNlZGl0UGxhbicpLm9mZignaGlkZGVuLmJzLm1vZGFsJykub24oJ2hpZGRlbi5icy5tb2RhbCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHdlbGNvbWUucG9wdWxhdGUoISQoJyNvdXRzdGFuZGluZ1Rhc2tzJykucGFyZW50KCkuaGFzQ2xhc3MoXCJhY3RpdmVcIikpO1xyXG4gICAgICB9KS5vZmYoJ3Nob3duLmJzLm1vZGFsJykub24oJ3Nob3duLmJzLm1vZGFsJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgJCgnI2VkaXRBY3Rpb25QbGFuSXRlbScpLmZvY3VzKCk7XHJcbiAgICAgIH0pLm9mZignY2xpY2snLCAnLnNhdmUtcGxhbicpLm9uKCdjbGljaycsICcuc2F2ZS1wbGFuJywgZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgIGxvZy5lZGl0UGxhbihQTEFOSUQsICQoJyNlZGl0QWN0aW9uUGxhbkl0ZW0nKS52YWwoKSk7XHJcblxyXG4gICAgICAgICQoJyNlZGl0UGxhbicpLm1vZGFsKCdoaWRlJyk7XHJcbiAgICAgIH0pLm9mZigna2V5dXAnLCAnI2VkaXRBY3Rpb25QbGFuSXRlbScpLm9uKCdrZXl1cCcsICcjZWRpdEFjdGlvblBsYW5JdGVtJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgIGlmIChlLndoaWNoID09PSAxMykgJCgnI2VkaXRQbGFuIC5zYXZlLXBsYW4nKS5jbGljaygpO1xyXG4gICAgICB9KS5tb2RhbCgpO1xyXG4gICAgfSkub24oJ2NsaWNrJywgJy5kZWxldGUtcGxhbicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgUExBTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoXCJpZFwiKTtcclxuXHJcbiAgICAgICQoJyN0ZWFtLWRlbGV0ZS1pdGVtJykuaHRtbCgkKCQodGhpcykuY2xvc2VzdCgndHInKS5jaGlsZHJlbigndGQnKVsxXSkuZmluZCgnc3BhbicpLnRleHQoKSk7XHJcblxyXG4gICAgICAkKCcjZGVsZXRlUGxhbicpLm9mZignaGlkZGVuLmJzLm1vZGFsJykub24oJ2hpZGRlbi5icy5tb2RhbCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHdlbGNvbWUucG9wdWxhdGUoISQoJyNvdXRzdGFuZGluZ1Rhc2tzJykucGFyZW50KCkuaGFzQ2xhc3MoXCJhY3RpdmVcIikpO1xyXG4gICAgICB9KS5vZmYoJ2NsaWNrJywgJy5kZWxldGUtcGxhbicpLm9uKCdjbGljaycsICcuZGVsZXRlLXBsYW4nLCBmdW5jdGlvbigpIHtcclxuICAgICAgICBsb2cuZGVsZXRlUGxhbihQTEFOSUQpO1xyXG5cclxuICAgICAgICAkKCcjZGVsZXRlUGxhbicpLm1vZGFsKCdoaWRlJyk7XHJcbiAgICAgIH0pLm1vZGFsKCk7XHJcbiAgICB9KS5vbignY2xpY2snLCAnLmJ0bi11bmRvJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICB2YXIgQUNUSU9OSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YSgnaWQnKTtcclxuICAgICAgbG9nLmVkaXRBY3Rpb24oXCJ0ZWFtXCIsIEFDVElPTklELCBudWxsLCBmYWxzZSk7XHJcbiAgICAgICQodGhpcykucmVwbGFjZVdpdGgoYmFzZS5jcmVhdGVQYW5lbCgkKCcjY2hlY2tib3gtdGVtcGxhdGUnKSwge1xyXG4gICAgICAgIFwiZG9uZVwiOiBmYWxzZVxyXG4gICAgICB9KSk7XHJcbiAgICAgIHdlbGNvbWUudXBkYXRlV2VsY29tZVBhZ2UoKTtcclxuICAgIH0pLm9uKCdjbGljaycsICcuYnRuLXllcywuYnRuLW5vJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICB2YXIgY2hlY2tib3ggPSAkKHRoaXMpLmZpbmQoXCJpbnB1dFt0eXBlPWNoZWNrYm94XVwiKTtcclxuICAgICAgdmFyIG90aGVyID0gJCh0aGlzKS5wYXJlbnQoKS5maW5kKCQodGhpcykuaGFzQ2xhc3MoXCJidG4teWVzXCIpID8gXCIuYnRuLW5vXCIgOiBcIi5idG4teWVzXCIpO1xyXG4gICAgICB2YXIgQUNUSU9OSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YSgnaWQnKTtcclxuICAgICAgaWYgKCQodGhpcykuaGFzQ2xhc3MoXCJhY3RpdmVcIikgJiYgb3RoZXIuaGFzQ2xhc3MoXCJpbmFjdGl2ZVwiKSAmJiAhJCh0aGlzKS5jbG9zZXN0KCd0cicpLmhhc0NsYXNzKCdzdWNjZXNzJykpIHtcclxuICAgICAgICAvL3Vuc2VsZWN0aW5nXHJcbiAgICAgICAgaWYgKGNoZWNrYm94LnZhbCgpID09PSBcIm5vXCIpIHtcclxuICAgICAgICAgIHRlYW1BY3Rpb25QbGFuLmxhdW5jaE1vZGFsKGRhdGEuc2VsZWN0ZWQsIGNoZWNrYm94LmNsb3Nlc3QoJ3RyJykuY2hpbGRyZW4oJzpudGgoMSknKS5maW5kKCdzcGFuJykudGV4dCgpLCBsb2cuZ2V0UmVhc29uKFwidGVhbVwiLCBBQ1RJT05JRCksIHRydWUsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBsb2cuZWRpdEFjdGlvbihcInRlYW1cIiwgQUNUSU9OSUQsIGZhbHNlLCBudWxsLCBsb2cucmVhc29uKTtcclxuICAgICAgICAgICAgd2VsY29tZS51cGRhdGVXZWxjb21lUGFnZSgpO1xyXG4gICAgICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICAgICAgICB9LCBudWxsLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgbG9nLmlnbm9yZUFjdGlvbihcInRlYW1cIiwgQUNUSU9OSUQpO1xyXG4gICAgICAgICAgICBvdGhlci5yZW1vdmVDbGFzcyhcImluYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICBjaGVja2JveC5yZW1vdmVBdHRyKFwiY2hlY2tlZFwiKTtcclxuICAgICAgICAgICAgY2hlY2tib3gucGFyZW50KCkucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XHJcbiAgICAgICAgICAgIHdlbGNvbWUudXBkYXRlV2VsY29tZVBhZ2UoKTtcclxuICAgICAgICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBsb2cuaWdub3JlQWN0aW9uKFwidGVhbVwiLCBBQ1RJT05JRCk7XHJcbiAgICAgICAgICBvdGhlci5yZW1vdmVDbGFzcyhcImluYWN0aXZlXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIGlmICgoISQodGhpcykuaGFzQ2xhc3MoXCJhY3RpdmVcIikgJiYgb3RoZXIuaGFzQ2xhc3MoXCJhY3RpdmVcIikpIHx8ICQodGhpcykuY2xvc2VzdCgndHInKS5oYXNDbGFzcygnc3VjY2VzcycpKSB7XHJcbiAgICAgICAgLy9wcmV2ZW50IGNsaWNraW5nIG9uIHVuc2VsZWN0ZWQgb3B0aW9uIG9yIGlmIHRoZSByb3cgaXMgY29tcGxldGVcclxuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy9zZWxlY3RpbmdcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgaWYgKGNoZWNrYm94LnZhbCgpID09PSBcIm5vXCIpIHtcclxuICAgICAgICAgIHRlYW1BY3Rpb25QbGFuLmxhdW5jaE1vZGFsKGRhdGEuc2VsZWN0ZWQsIGNoZWNrYm94LmNsb3Nlc3QoJ3RyJykuY2hpbGRyZW4oJzpudGgoMSknKS5maW5kKCdzcGFuJykudGV4dCgpLCBsb2cuZ2V0UmVhc29uKFwidGVhbVwiLCBBQ1RJT05JRCksIGZhbHNlLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgbG9nLmVkaXRBY3Rpb24oXCJ0ZWFtXCIsIEFDVElPTklELCBmYWxzZSwgbnVsbCwgbG9nLnJlYXNvbik7XHJcbiAgICAgICAgICAgICQoc2VsZikucmVtb3ZlQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuXHJcbiAgICAgICAgICAgIGNoZWNrYm94LmF0dHIoXCJjaGVja2VkXCIsIFwiY2hlY2tlZFwiKTtcclxuICAgICAgICAgICAgY2hlY2tib3gucGFyZW50KCkuYWRkQ2xhc3MoXCJhY3RpdmVcIik7XHJcbiAgICAgICAgICAgIC8vdW5zZWxlY3Qgb3RoZXJcclxuICAgICAgICAgICAgb3RoZXIucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIikuYWRkQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgb3RoZXIuZmluZChcImlucHV0W3R5cGU9Y2hlY2tib3hdXCIpLnByb3AoXCJjaGVja2VkXCIsIGZhbHNlKTtcclxuICAgICAgICAgICAgd2VsY29tZS51cGRhdGVXZWxjb21lUGFnZSgpO1xyXG4gICAgICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGxvZy5lZGl0QWN0aW9uKFwidGVhbVwiLCBBQ1RJT05JRCwgdHJ1ZSk7XHJcbiAgICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKFwiaW5hY3RpdmVcIik7XHJcblxyXG4gICAgICAgICAgLy91bnNlbGVjdCBvdGhlclxyXG4gICAgICAgICAgb3RoZXIucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIikuYWRkQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuICAgICAgICAgIG90aGVyLmZpbmQoXCJpbnB1dFt0eXBlPWNoZWNrYm94XVwiKS5wcm9wKFwiY2hlY2tlZFwiLCBmYWxzZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAkKCcjaW5kaXZpZHVhbC10YXNrLXBhbmVsJykub24oJ2NsaWNrJywgJy5jci1zdHlsZWQgaW5wdXRbdHlwZT1jaGVja2JveF0nLCBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIEFDVElPTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoJ2lkJyk7XHJcbiAgICAgIHZhciBwYXRpZW50SWQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YSgndGVhbS1vci1wYXRpZW50LWlkJyk7XHJcbiAgICAgIGxvZy5lZGl0QWN0aW9uKHBhdGllbnRJZCwgQUNUSU9OSUQsIG51bGwsIHRoaXMuY2hlY2tlZCk7XHJcblxyXG4gICAgICBpZiAodGhpcy5jaGVja2VkKSB7XHJcbiAgICAgICAgbG9nLnJlY29yZEV2ZW50KHBhdGh3YXlJZCwgcGF0aWVudElkLCBcIkl0ZW0gY29tcGxldGVkXCIpO1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAkKHNlbGYpLnBhcmVudCgpLmF0dHIoXCJ0aXRsZVwiLCBcIlwiKS5hdHRyKFwiZGF0YS1vcmlnaW5hbC10aXRsZVwiLCBcIlwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAkKHNlbGYpLnBhcmVudCgpLmZhZGVPdXQoMzAwLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIHBhcmVudCA9ICQodGhpcykucGFyZW50KCk7XHJcbiAgICAgICAgICAgICQodGhpcykucmVwbGFjZVdpdGgoYmFzZS5jcmVhdGVQYW5lbCgkKCcjY2hlY2tib3gtdGVtcGxhdGUnKSwge1xyXG4gICAgICAgICAgICAgIFwiZG9uZVwiOiB0cnVlXHJcbiAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgcGFyZW50LmZpbmQoJ2J1dHRvbicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgIEFDVElPTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoJ2lkJyk7XHJcbiAgICAgICAgICAgICAgbG9nLmVkaXRBY3Rpb24ocGF0aWVudElkLCBBQ1RJT05JRCwgbnVsbCwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICQodGhpcykucmVwbGFjZVdpdGgoYmFzZS5jcmVhdGVQYW5lbCgkKCcjY2hlY2tib3gtdGVtcGxhdGUnKSwge1xyXG4gICAgICAgICAgICAgICAgXCJkb25lXCI6IGZhbHNlXHJcbiAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgIHdlbGNvbWUudXBkYXRlV2VsY29tZVBhZ2UoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9LCAxMDAwKTtcclxuICAgICAgfVxyXG4gICAgICB3ZWxjb21lLnVwZGF0ZVdlbGNvbWVQYWdlKCk7XHJcbiAgICB9KS5vbignY2hhbmdlJywgJy5idG4tdG9nZ2xlIGlucHV0W3R5cGU9Y2hlY2tib3hdJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIHdlbGNvbWUudXBkYXRlV2VsY29tZVBhZ2UoKTtcclxuICAgIH0pLm9uKCdjbGljaycsICcuZWRpdC1wbGFuJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBQTEFOSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YShcImlkXCIpO1xyXG5cclxuICAgICAgJCgnI2VkaXRBY3Rpb25QbGFuSXRlbScpLnZhbCgkKCQodGhpcykuY2xvc2VzdCgndHInKS5jaGlsZHJlbigndGQnKVsyXSkuZmluZCgnc3BhbicpLnRleHQoKSk7XHJcblxyXG4gICAgICAkKCcjZWRpdFBsYW4nKS5vZmYoJ2hpZGRlbi5icy5tb2RhbCcpLm9uKCdoaWRkZW4uYnMubW9kYWwnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICB3ZWxjb21lLnBvcHVsYXRlKCEkKCcjb3V0c3RhbmRpbmdUYXNrcycpLnBhcmVudCgpLmhhc0NsYXNzKFwiYWN0aXZlXCIpKTtcclxuICAgICAgfSkub2ZmKCdzaG93bi5icy5tb2RhbCcpLm9uKCdzaG93bi5icy5tb2RhbCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICQoJyNlZGl0QWN0aW9uUGxhbkl0ZW0nKS5mb2N1cygpO1xyXG4gICAgICB9KS5vZmYoJ2NsaWNrJywgJy5zYXZlLXBsYW4nKS5vbignY2xpY2snLCAnLnNhdmUtcGxhbicsIGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICBsb2cuZWRpdFBsYW4oUExBTklELCAkKCcjZWRpdEFjdGlvblBsYW5JdGVtJykudmFsKCkpO1xyXG5cclxuICAgICAgICAkKCcjZWRpdFBsYW4nKS5tb2RhbCgnaGlkZScpO1xyXG4gICAgICB9KS5vZmYoJ2tleXVwJywgJyNlZGl0QWN0aW9uUGxhbkl0ZW0nKS5vbigna2V5dXAnLCAnI2VkaXRBY3Rpb25QbGFuSXRlbScsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICBpZiAoZS53aGljaCA9PT0gMTMpICQoJyNlZGl0UGxhbiAuc2F2ZS1wbGFuJykuY2xpY2soKTtcclxuICAgICAgfSkubW9kYWwoKTtcclxuICAgIH0pLm9uKCdjbGljaycsICcuZGVsZXRlLXBsYW4nLCBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIFBMQU5JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKFwiaWRcIik7XHJcblxyXG4gICAgICAkKCcjdGVhbS1kZWxldGUtaXRlbScpLmh0bWwoJCgkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuY2hpbGRyZW4oJ3RkJylbMl0pLmZpbmQoJ3NwYW4nKS50ZXh0KCkpO1xyXG5cclxuICAgICAgJCgnI2RlbGV0ZVBsYW4nKS5vZmYoJ2hpZGRlbi5icy5tb2RhbCcpLm9uKCdoaWRkZW4uYnMubW9kYWwnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICB3ZWxjb21lLnBvcHVsYXRlKCEkKCcjb3V0c3RhbmRpbmdUYXNrcycpLnBhcmVudCgpLmhhc0NsYXNzKFwiYWN0aXZlXCIpKTtcclxuICAgICAgfSkub2ZmKCdjbGljaycsICcuZGVsZXRlLXBsYW4nKS5vbignY2xpY2snLCAnLmRlbGV0ZS1wbGFuJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgbG9nLmRlbGV0ZVBsYW4oUExBTklEKTtcclxuXHJcbiAgICAgICAgJCgnI2RlbGV0ZVBsYW4nKS5tb2RhbCgnaGlkZScpO1xyXG4gICAgICB9KS5tb2RhbCgpO1xyXG4gICAgfSkub24oJ2NsaWNrJywgJy5idG4tdW5kbycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgdmFyIEFDVElPTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoJ2lkJyk7XHJcbiAgICAgIHZhciBwYXRpZW50SWQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YSgndGVhbS1vci1wYXRpZW50LWlkJyk7XHJcbiAgICAgIGxvZy5lZGl0QWN0aW9uKHBhdGllbnRJZCwgQUNUSU9OSUQsIG51bGwsIGZhbHNlKTtcclxuICAgICAgJCh0aGlzKS5yZXBsYWNlV2l0aChiYXNlLmNyZWF0ZVBhbmVsKCQoJyNjaGVja2JveC10ZW1wbGF0ZScpLCB7XHJcbiAgICAgICAgXCJkb25lXCI6IGZhbHNlXHJcbiAgICAgIH0pKTtcclxuICAgICAgd2VsY29tZS51cGRhdGVXZWxjb21lUGFnZSgpO1xyXG4gICAgfSkub24oJ2NsaWNrJywgJy5idG4teWVzLC5idG4tbm8nLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIHZhciBjaGVja2JveCA9ICQodGhpcykuZmluZChcImlucHV0W3R5cGU9Y2hlY2tib3hdXCIpO1xyXG4gICAgICB2YXIgb3RoZXIgPSAkKHRoaXMpLnBhcmVudCgpLmZpbmQoJCh0aGlzKS5oYXNDbGFzcyhcImJ0bi15ZXNcIikgPyBcIi5idG4tbm9cIiA6IFwiLmJ0bi15ZXNcIik7XHJcbiAgICAgIHZhciBBQ1RJT05JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKCdpZCcpO1xyXG4gICAgICB2YXIgcGF0aWVudElkID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoJ3RlYW0tb3ItcGF0aWVudC1pZCcpO1xyXG4gICAgICBpZiAoJCh0aGlzKS5oYXNDbGFzcyhcImFjdGl2ZVwiKSAmJiBvdGhlci5oYXNDbGFzcyhcImluYWN0aXZlXCIpICYmICEkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuaGFzQ2xhc3MoJ3N1Y2Nlc3MnKSkge1xyXG4gICAgICAgIC8vdW5zZWxlY3RpbmdcclxuICAgICAgICBpZiAoY2hlY2tib3gudmFsKCkgPT09IFwibm9cIikge1xyXG4gICAgICAgICAgaW5kaXZpZHVhbEFjdGlvblBsYW4ubGF1bmNoTW9kYWwoZGF0YS5zZWxlY3RlZCwgY2hlY2tib3guY2xvc2VzdCgndHInKS5jaGlsZHJlbignOm50aCgyKScpLmZpbmQoJ3NwYW4nKS50ZXh0KCksIGxvZy5nZXRSZWFzb24ocGF0aWVudElkLCBBQ1RJT05JRCksIHRydWUsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBsb2cuZWRpdEFjdGlvbihwYXRpZW50SWQsIEFDVElPTklELCBmYWxzZSwgbnVsbCwgbG9nLnJlYXNvbik7XHJcbiAgICAgICAgICAgIHdlbGNvbWUudXBkYXRlV2VsY29tZVBhZ2UoKTtcclxuICAgICAgICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgICAgICAgfSwgbnVsbCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGxvZy5pZ25vcmVBY3Rpb24ocGF0aWVudElkLCBBQ1RJT05JRCk7XHJcbiAgICAgICAgICAgIG90aGVyLnJlbW92ZUNsYXNzKFwiaW5hY3RpdmVcIik7XHJcbiAgICAgICAgICAgIGNoZWNrYm94LnJlbW92ZUF0dHIoXCJjaGVja2VkXCIpO1xyXG4gICAgICAgICAgICBjaGVja2JveC5wYXJlbnQoKS5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgd2VsY29tZS51cGRhdGVXZWxjb21lUGFnZSgpO1xyXG4gICAgICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGxvZy5pZ25vcmVBY3Rpb24ocGF0aWVudElkLCBBQ1RJT05JRCk7XHJcbiAgICAgICAgICBvdGhlci5yZW1vdmVDbGFzcyhcImluYWN0aXZlXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIGlmICgoISQodGhpcykuaGFzQ2xhc3MoXCJhY3RpdmVcIikgJiYgb3RoZXIuaGFzQ2xhc3MoXCJhY3RpdmVcIikpIHx8ICQodGhpcykuY2xvc2VzdCgndHInKS5oYXNDbGFzcygnc3VjY2VzcycpKSB7XHJcbiAgICAgICAgLy9wcmV2ZW50IGNsaWNraW5nIG9uIHVuc2VsZWN0ZWQgb3B0aW9uIG9yIGlmIHRoZSByb3cgaXMgY29tcGxldGVcclxuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy9zZWxlY3RpbmdcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgaWYgKGNoZWNrYm94LnZhbCgpID09PSBcIm5vXCIpIHtcclxuICAgICAgICAgIGluZGl2aWR1YWxBY3Rpb25QbGFuLmxhdW5jaE1vZGFsKGRhdGEuc2VsZWN0ZWQsIGNoZWNrYm94LmNsb3Nlc3QoJ3RyJykuY2hpbGRyZW4oJzpudGgoMiknKS5maW5kKCdzcGFuJykudGV4dCgpLCBsb2cuZ2V0UmVhc29uKHBhdGllbnRJZCwgQUNUSU9OSUQpLCBmYWxzZSwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGxvZy5lZGl0QWN0aW9uKHBhdGllbnRJZCwgQUNUSU9OSUQsIGZhbHNlLCBudWxsLCBsb2cucmVhc29uKTtcclxuICAgICAgICAgICAgJChzZWxmKS5yZW1vdmVDbGFzcyhcImluYWN0aXZlXCIpO1xyXG5cclxuICAgICAgICAgICAgY2hlY2tib3guYXR0cihcImNoZWNrZWRcIiwgXCJjaGVja2VkXCIpO1xyXG4gICAgICAgICAgICBjaGVja2JveC5wYXJlbnQoKS5hZGRDbGFzcyhcImFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgLy91bnNlbGVjdCBvdGhlclxyXG4gICAgICAgICAgICBvdGhlci5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKS5hZGRDbGFzcyhcImluYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICBvdGhlci5maW5kKFwiaW5wdXRbdHlwZT1jaGVja2JveF1cIikucHJvcChcImNoZWNrZWRcIiwgZmFsc2UpO1xyXG4gICAgICAgICAgICB3ZWxjb21lLnVwZGF0ZVdlbGNvbWVQYWdlKCk7XHJcbiAgICAgICAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgbG9nLmVkaXRBY3Rpb24ocGF0aWVudElkLCBBQ1RJT05JRCwgdHJ1ZSk7XHJcbiAgICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKFwiaW5hY3RpdmVcIik7XHJcblxyXG4gICAgICAgICAgLy91bnNlbGVjdCBvdGhlclxyXG4gICAgICAgICAgb3RoZXIucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIikuYWRkQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuICAgICAgICAgIG90aGVyLmZpbmQoXCJpbnB1dFt0eXBlPWNoZWNrYm94XVwiKS5wcm9wKFwiY2hlY2tlZFwiLCBmYWxzZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICB3ZWxjb21lLnVwZGF0ZVdlbGNvbWVQYWdlKCk7XHJcbiAgfSxcclxuXHJcbiAgdXBkYXRlV2VsY29tZVBhZ2U6IGZ1bmN0aW9uKCkge1xyXG4gICAgJCgnI3RlYW0tdGFzay1wYW5lbCcpLmFkZCgnI2luZGl2aWR1YWwtdGFzay1wYW5lbCcpLmZpbmQoJy5zdWdnZXN0aW9uJykuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgJCh0aGlzKS5maW5kKCd0ZCcpLmxhc3QoKS5jaGlsZHJlbigpLmhpZGUoKTtcclxuICAgIH0pO1xyXG5cclxuICAgICQoJyN0ZWFtLXRhc2stcGFuZWwnKS5hZGQoJyNpbmRpdmlkdWFsLXRhc2stcGFuZWwnKS5maW5kKCcuY3Itc3R5bGVkIGlucHV0W3R5cGU9Y2hlY2tib3hdJykuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgaWYgKHRoaXMuY2hlY2tlZCkge1xyXG4gICAgICAgICQodGhpcykucGFyZW50KCkucGFyZW50KCkucGFyZW50KCkuYWRkQ2xhc3MoJ3N1Y2Nlc3MnKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAkKHRoaXMpLnBhcmVudCgpLnBhcmVudCgpLnBhcmVudCgpLnJlbW92ZUNsYXNzKCdzdWNjZXNzJyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgICQoJyN0ZWFtLXRhc2stcGFuZWwnKS5hZGQoJyNpbmRpdmlkdWFsLXRhc2stcGFuZWwnKS5maW5kKCcuYnRuLXVuZG8nKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICAkKHRoaXMpLnBhcmVudCgpLnBhcmVudCgpLmFkZENsYXNzKCdzdWNjZXNzJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvL25vIGNsYXNzIC0gdXNlciBub3QgeWV0IGFncmVlZC9kaXNhZ3JlZWQgLSBubyBiYWNrZ3JvdW5kIC8gbXV0ZWQgdGV4dFxyXG4gICAgLy9hY3RpdmUgLSB1c2VyIGFncmVlcyAtIGdyZWVuIGJhY2tncm91bmQgLyBub3JtYWwgdGV4dFxyXG4gICAgLy9zdWNjZXNzIC0gdXNlciBjb21wbGV0ZWQgLSBncmVlbiBiYWNrZ3JvdW5kIC8gc3RyaWtldGhyb3VnaCB0ZXh0XHJcbiAgICAvL2RhbmdlciAtIHVzZXIgZGlzYWdyZWVzIC0gcmVkIGJhY2tncm91bmQgLyBzdHJpa2V0aHJvdWdoIHRleHRcclxuICAgICQoJyN0ZWFtLXRhc2stcGFuZWwnKS5hZGQoJyNpbmRpdmlkdWFsLXRhc2stcGFuZWwnKS5maW5kKCd0cicpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBzZWxmID0gJCh0aGlzKTtcclxuICAgICAgdmFyIGFueSA9IGZhbHNlO1xyXG4gICAgICBzZWxmLmZpbmQoJy5idG4tdG9nZ2xlIGlucHV0W3R5cGU9Y2hlY2tib3hdOmNoZWNrZWQnKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGFueSA9IHRydWU7XHJcbiAgICAgICAgaWYgKHRoaXMudmFsdWUgPT09IFwieWVzXCIpIHtcclxuICAgICAgICAgIHNlbGYucmVtb3ZlQ2xhc3MoJ2RhbmdlcicpO1xyXG4gICAgICAgICAgc2VsZi5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgICBzZWxmLmZpbmQoJ3RkJykubGFzdCgpLmNoaWxkcmVuKCkuc2hvdygpO1xyXG4gICAgICAgICAgaWYgKGxvZy5nZXRBY3Rpb25zKCkudGVhbVtzZWxmLmRhdGEoXCJpZFwiKV0gJiYgbG9nLmdldEFjdGlvbnMoKS50ZWFtW3NlbGYuZGF0YShcImlkXCIpXS5oaXN0b3J5KSB7XHJcbiAgICAgICAgICAgIHZhciB0b29sID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmhhc0NsYXNzKCdzdWNjZXNzJykgPyBcIlwiIDogXCI8cD5cIiArIGxvZy5nZXRBY3Rpb25zKCkudGVhbVtzZWxmLmRhdGEoXCJpZFwiKV0uaGlzdG9yeVswXSArIFwiPC9wPjxwPkNsaWNrIGFnYWluIHRvIGNhbmNlbDwvcD5cIjtcclxuICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5hdHRyKFwidGl0bGVcIiwgdG9vbCkuYXR0cihcImRhdGEtb3JpZ2luYWwtdGl0bGVcIiwgdG9vbCkudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAkKHRoaXMpLnBhcmVudCgpLmF0dHIoXCJ0aXRsZVwiLCBcIllvdSBhZ3JlZWQgLSBjbGljayBhZ2FpbiB0byBjYW5jZWxcIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHNlbGYucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgc2VsZi5hZGRDbGFzcygnZGFuZ2VyJyk7XHJcbiAgICAgICAgICBzZWxmLnJlbW92ZUNsYXNzKCdzdWNjZXNzJyk7XHJcbiAgICAgICAgICBpZiAobG9nLmdldEFjdGlvbnMoKS50ZWFtW3NlbGYuZGF0YShcImlkXCIpXSAmJiBsb2cuZ2V0QWN0aW9ucygpLnRlYW1bc2VsZi5kYXRhKFwiaWRcIildLmhpc3RvcnkpIHtcclxuICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5hdHRyKFwidGl0bGVcIiwgXCI8cD5cIiArIGxvZy5nZXRBY3Rpb25zKCkudGVhbVtzZWxmLmRhdGEoXCJpZFwiKV0uaGlzdG9yeVswXSArIFwiPC9wPjxwPkNsaWNrIGFnYWluIHRvIGVkaXQvY2FuY2VsPC9wPlwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICQodGhpcykucGFyZW50KCkuYXR0cihcInRpdGxlXCIsIFwiWW91IGRpc2FncmVlZCAtIGNsaWNrIGFnYWluIHRvIGVkaXQvY2FuY2VsXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICAgIGlmIChzZWxmLmZpbmQoJy5idG4tdG9nZ2xlIGlucHV0W3R5cGU9Y2hlY2tib3hdOm5vdCg6Y2hlY2tlZCknKS5sZW5ndGggPT0gMSkge1xyXG4gICAgICAgIHNlbGYuZmluZCgnLmJ0bi10b2dnbGUgaW5wdXRbdHlwZT1jaGVja2JveF06bm90KDpjaGVja2VkKScpLnBhcmVudCgpLmFkZENsYXNzKFwiaW5hY3RpdmVcIikuYXR0cihcInRpdGxlXCIsIFwiXCIpLmF0dHIoXCJkYXRhLW9yaWdpbmFsLXRpdGxlXCIsIFwiXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICghYW55KSB7XHJcbiAgICAgICAgc2VsZi5yZW1vdmVDbGFzcygnZGFuZ2VyJyk7XHJcbiAgICAgICAgc2VsZi5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgc2VsZi5yZW1vdmVDbGFzcygnc3VjY2VzcycpO1xyXG5cclxuICAgICAgICBzZWxmLmZpbmQoJy5idG4tdG9nZ2xlLmJ0bi15ZXMnKS5hdHRyKFwidGl0bGVcIiwgXCJDbGljayB0byBhZ3JlZSB3aXRoIHRoaXMgYWN0aW9uIGFuZCBzYXZlIGl0IGluIHlvdXIgYWdyZWVkIGFjdGlvbnMgbGlzdCAgXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgIHNlbGYuZmluZCgnLmJ0bi10b2dnbGUuYnRuLW5vJykuYXR0cihcInRpdGxlXCIsIFwiQ2xpY2sgdG8gZGlzYWdyZWUgd2l0aCB0aGlzIGFjdGlvbiBhbmQgcmVtb3ZlIGl0IGZyb20geW91ciBzdWdnZXN0ZWQgYWN0aW9ucyBsaXN0IFwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gIH0sXHJcblxyXG4gIHBvcHVsYXRlOiBmdW5jdGlvbihjb21wbGV0ZSkge1xyXG5cclxuICAgIHZhciBrLGw7XHJcbiAgICAvL2FkZCB0YXNrc1xyXG4gICAgdmFyIHRlYW1UYXNrcyA9IFtdO1xyXG4gICAgdmFyIGluZGl2aWR1YWxUYXNrcyA9IFtdO1xyXG5cclxuICAgIC8vQWRkIHRoZSB0ZWFtIHRhc2tzXHJcbiAgICBmb3IgKGsgaW4gbG9nLmxpc3RBY3Rpb25zKFwidGVhbVwiKSkge1xyXG4gICAgICBpZiAobG9nLmxpc3RBY3Rpb25zKFwidGVhbVwiKVtrXS5hZ3JlZSAmJiAoKCFsb2cubGlzdEFjdGlvbnMoXCJ0ZWFtXCIpW2tdLmRvbmUgJiYgIWNvbXBsZXRlKSB8fCAobG9nLmxpc3RBY3Rpb25zKFwidGVhbVwiKVtrXS5kb25lICYmIGNvbXBsZXRlKSkpIHtcclxuICAgICAgICB0ZWFtVGFza3MucHVzaCh7XHJcbiAgICAgICAgICBcInBhdGh3YXlcIjogXCJOL0FcIixcclxuICAgICAgICAgIFwidGFza1wiOiBsb2cudGV4dFtsb2cubGlzdEFjdGlvbnMoXCJ0ZWFtXCIpW2tdLmlkXS50ZXh0LFxyXG4gICAgICAgICAgXCJkYXRhXCI6IGxvZy5saXN0QWN0aW9ucyhcInRlYW1cIilba10uaWQsXHJcbiAgICAgICAgICBcInRwSWRcIjogXCJ0ZWFtXCIsXHJcbiAgICAgICAgICBcImFncmVlXCI6IHRydWUsXHJcbiAgICAgICAgICBcImRvbmVcIjogY29tcGxldGVcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vQWRkIHRoZSB1c2VyIGFkZGVkIHRlYW0gdGFza3NcclxuICAgIGZvciAoayBpbiBsb2cubGlzdFBsYW5zKFwidGVhbVwiKSkge1xyXG4gICAgICBpZiAoKCFsb2cubGlzdFBsYW5zKFwidGVhbVwiKVtrXS5kb25lICYmICFjb21wbGV0ZSkgfHwgKGxvZy5saXN0UGxhbnMoXCJ0ZWFtXCIpW2tdLmRvbmUgJiYgY29tcGxldGUpKSB7XHJcbiAgICAgICAgdGVhbVRhc2tzLnB1c2goe1xyXG4gICAgICAgICAgXCJjYW5FZGl0XCI6IHRydWUsXHJcbiAgICAgICAgICBcInBhdGh3YXlcIjogZGF0YS5wYXRod2F5TmFtZXNbbG9nLmxpc3RQbGFucyhcInRlYW1cIilba10ucGF0aHdheUlkXSxcclxuICAgICAgICAgIFwicGF0aHdheUlkXCI6IGxvZy5saXN0UGxhbnMoXCJ0ZWFtXCIpW2tdLnBhdGh3YXlJZCxcclxuICAgICAgICAgIFwidGFza1wiOiBsb2cubGlzdFBsYW5zKFwidGVhbVwiKVtrXS50ZXh0LFxyXG4gICAgICAgICAgXCJkYXRhXCI6IGxvZy5saXN0UGxhbnMoXCJ0ZWFtXCIpW2tdLmlkLFxyXG4gICAgICAgICAgXCJhZ3JlZVwiOiBsb2cubGlzdFBsYW5zKFwidGVhbVwiKVtrXS5hZ3JlZSxcclxuICAgICAgICAgIFwiZGlzYWdyZWVcIjogbG9nLmxpc3RQbGFucyhcInRlYW1cIilba10uYWdyZWUgPT09IGZhbHNlLFxyXG4gICAgICAgICAgXCJkb25lXCI6IGNvbXBsZXRlXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvL0FkZCBpbmRpdmlkdWFsXHJcbiAgICBmb3IgKGsgaW4gbG9nLmxpc3RBY3Rpb25zKCkpIHtcclxuICAgICAgaWYgKGsgPT09IFwidGVhbVwiKSBjb250aW51ZTtcclxuICAgICAgZm9yIChsIGluIGxvZy5saXN0QWN0aW9ucygpW2tdKSB7XHJcbiAgICAgICAgaWYgKGxvZy50ZXh0W2xdICYmIGxvZy5saXN0QWN0aW9ucygpW2tdW2xdLmFncmVlICYmICgoIWxvZy5saXN0QWN0aW9ucygpW2tdW2xdLmRvbmUgJiYgIWNvbXBsZXRlKSB8fCAobG9nLmxpc3RBY3Rpb25zKClba11bbF0uZG9uZSAmJiBjb21wbGV0ZSkpKSB7XHJcbiAgICAgICAgICBpbmRpdmlkdWFsVGFza3MucHVzaCh7XHJcbiAgICAgICAgICAgIFwicGF0aHdheVwiOiBcIk4vQVwiLFxyXG4gICAgICAgICAgICBcInBhdGllbnRJZFwiOiBrLFxyXG4gICAgICAgICAgICBcInRhc2tcIjogbG9nLnRleHRbbF0udGV4dCxcclxuICAgICAgICAgICAgXCJwYXRod2F5SWRcIjogbG9nLmxpc3RQbGFucygpW2tdW2xdLnBhdGh3YXlJZCxcclxuICAgICAgICAgICAgXCJkYXRhXCI6IGwsXHJcbiAgICAgICAgICAgIFwidHBJZFwiOiBrLFxyXG4gICAgICAgICAgICBcImFncmVlXCI6IHRydWUsXHJcbiAgICAgICAgICAgIFwiZG9uZVwiOiBjb21wbGV0ZVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy9BZGQgY3VzdG9tIGluZGl2aWR1YWxcclxuICAgIGZvciAoayBpbiBsb2cubGlzdFBsYW5zKCkpIHtcclxuICAgICAgaWYgKGsgPT09IFwidGVhbVwiKSBjb250aW51ZTtcclxuICAgICAgZm9yIChsIGluIGxvZy5saXN0UGxhbnMoKVtrXSkge1xyXG4gICAgICAgIGlmIChsb2cubGlzdFBsYW5zKClba11bbF0udGV4dCAmJiAoIWxvZy5saXN0UGxhbnMoKVtrXVtsXS5kb25lICYmICFjb21wbGV0ZSkgfHwgKGxvZy5saXN0UGxhbnMoKVtrXVtsXS5kb25lICYmIGNvbXBsZXRlKSkge1xyXG4gICAgICAgICAgaW5kaXZpZHVhbFRhc2tzLnB1c2goe1xyXG4gICAgICAgICAgICBcImNhbkVkaXRcIjogdHJ1ZSxcclxuICAgICAgICAgICAgXCJwYXRod2F5XCI6IGRhdGEucGF0aHdheU5hbWVzW2xvZy5saXN0UGxhbnMoKVtrXVtsXS5wYXRod2F5SWRdLFxyXG4gICAgICAgICAgICBcInBhdGh3YXlJZFwiOiBsb2cubGlzdFBsYW5zKClba11bbF0ucGF0aHdheUlkLFxyXG4gICAgICAgICAgICBcInBhdGllbnRJZFwiOiBrLFxyXG4gICAgICAgICAgICBcInRwSWRcIjogayxcclxuICAgICAgICAgICAgXCJ0YXNrXCI6IGxvZy5saXN0UGxhbnMoKVtrXVtsXS50ZXh0LFxyXG4gICAgICAgICAgICBcImRhdGFcIjogbCxcclxuICAgICAgICAgICAgXCJhZ3JlZVwiOiB0cnVlLFxyXG4gICAgICAgICAgICBcImRvbmVcIjogY29tcGxldGVcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHZhciBsaXN0VGVtcGxhdGUgPSAkKCcjd2VsY29tZS10YXNrLWxpc3QnKS5odG1sKCk7XHJcbiAgICBNdXN0YWNoZS5wYXJzZShsaXN0VGVtcGxhdGUpO1xyXG4gICAgJCgnI3dlbGNvbWUtdGFiLWNvbnRlbnQnKS5odG1sKE11c3RhY2hlLnJlbmRlcihsaXN0VGVtcGxhdGUpKTtcclxuXHJcbiAgICB2YXIgYWRkVGVtcGxhdGUgPSAkKCcjYWN0aW9uLXBsYW4nKS5odG1sKCk7XHJcbiAgICBNdXN0YWNoZS5wYXJzZShhZGRUZW1wbGF0ZSk7XHJcbiAgICB2YXIgcmVuZGVyZWQgPSBNdXN0YWNoZS5yZW5kZXIoYWRkVGVtcGxhdGUpO1xyXG4gICAgJCgnI3RlYW0tYWRkLXBsYW4nKS5odG1sKHJlbmRlcmVkKTtcclxuXHJcbiAgICB2YXIgdGVtcE11c3QgPSAkKCcjd2VsY29tZS10YXNrLWl0ZW1zJykuaHRtbCgpO1xyXG4gICAgdmFyIGl0ZW1UZW1wbGF0ZSA9ICQoJyN3ZWxjb21lLXRhc2staXRlbScpLmh0bWwoKTtcclxuICAgIE11c3RhY2hlLnBhcnNlKHRlbXBNdXN0KTtcclxuICAgIE11c3RhY2hlLnBhcnNlKGl0ZW1UZW1wbGF0ZSk7XHJcblxyXG4gICAgJCgnI3RlYW0tYWRkLXBsYW4nKS5vZmYoJ2NsaWNrJykub24oJ2NsaWNrJywgJy5hZGQtcGxhbicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgcGxhbiA9ICQodGhpcykucGFyZW50KCkucGFyZW50KCkuZmluZCgndGV4dGFyZWEnKS52YWwoKTtcclxuICAgICAgdmFyIHBsYW5JZCA9IHJlY29yZFBsYW4oXCJ0ZWFtXCIsIHBsYW4sIFwiY3VzdG9tXCIpO1xyXG4gICAgICAkKCcjdGVhbS10YXNrLXBhbmVsJykuZmluZCgndGFibGUgdGJvZHknKS5hcHBlbmQoTXVzdGFjaGUucmVuZGVyKGl0ZW1UZW1wbGF0ZSwge1xyXG4gICAgICAgIFwicGF0aHdheVwiOiBcIlwiLFxyXG4gICAgICAgIFwicGF0aHdheUlkXCI6IFwiY3VzdG9tXCIsXHJcbiAgICAgICAgXCJjYW5FZGl0XCI6IHRydWUsXHJcbiAgICAgICAgXCJ0YXNrXCI6IHBsYW4sXHJcbiAgICAgICAgXCJkYXRhXCI6IHBsYW5JZCxcclxuICAgICAgICBcImFncmVlXCI6IG51bGwsXHJcbiAgICAgICAgXCJkb25lXCI6IG51bGxcclxuICAgICAgfSwge1xyXG4gICAgICAgIFwiY2hrXCI6ICQoJyNjaGVja2JveC10ZW1wbGF0ZScpLmh0bWwoKVxyXG4gICAgICB9KSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZW5kZXJlZCA9IE11c3RhY2hlLnJlbmRlcih0ZW1wTXVzdCwge1xyXG4gICAgICBcInRhc2tzXCI6IHRlYW1UYXNrcyxcclxuICAgICAgXCJoYXNUYXNrc1wiOiB0ZWFtVGFza3MubGVuZ3RoID4gMFxyXG4gICAgfSwge1xyXG4gICAgICBcInRhc2staXRlbVwiOiBpdGVtVGVtcGxhdGUsXHJcbiAgICAgIFwiY2hrXCI6ICQoJyNjaGVja2JveC10ZW1wbGF0ZScpLmh0bWwoKVxyXG4gICAgfSk7XHJcbiAgICAkKCcjdGVhbS10YXNrLXBhbmVsJykuY2hpbGRyZW4oKS5ub3QoXCI6Zmlyc3RcIikucmVtb3ZlKCk7XHJcbiAgICAkKCcjdGVhbS10YXNrLXBhbmVsJykuYXBwZW5kKHJlbmRlcmVkKTtcclxuXHJcbiAgICByZW5kZXJlZCA9IE11c3RhY2hlLnJlbmRlcih0ZW1wTXVzdCwge1xyXG4gICAgICBcInRhc2tzXCI6IGluZGl2aWR1YWxUYXNrcyxcclxuICAgICAgXCJpc1BhdGllbnRUYWJsZVwiOiB0cnVlLFxyXG4gICAgICBcImhhc1Rhc2tzXCI6IGluZGl2aWR1YWxUYXNrcy5sZW5ndGggPiAwXHJcbiAgICB9LCB7XHJcbiAgICAgIFwidGFzay1pdGVtXCI6IGl0ZW1UZW1wbGF0ZSxcclxuICAgICAgXCJjaGtcIjogJCgnI2NoZWNrYm94LXRlbXBsYXRlJykuaHRtbCgpXHJcbiAgICB9KTtcclxuICAgICQoJyNpbmRpdmlkdWFsLXRhc2stcGFuZWwnKS5jaGlsZHJlbigpLm5vdChcIjpmaXJzdFwiKS5yZW1vdmUoKTtcclxuICAgICQoJyNpbmRpdmlkdWFsLXRhc2stcGFuZWwnKS5hcHBlbmQocmVuZGVyZWQpO1xyXG5cclxuICAgIHdlbGNvbWUud2lyZVVwV2VsY29tZVBhZ2UoKTtcclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSB3ZWxjb21lO1xyXG4iLCJ2YXIgZGF0YSA9IHJlcXVpcmUoJy4uL2RhdGEuanMnKSxcclxuICBjaGFydCA9IHJlcXVpcmUoJy4uL2NoYXJ0LmpzJyk7XHJcblxyXG52YXIgYmQgPSB7XHJcblxyXG4gIHdpcmVVcDogZnVuY3Rpb24oKSB7XHJcblxyXG4gIH0sXHJcblxyXG4gIHNob3c6IGZ1bmN0aW9uKHBhbmVsLCBpc0FwcGVuZCwgc3ViUGFuZWxzLCBpc0Rvd25UZXh0LCBpc1VwVGV4dCkge1xyXG5cclxuICAgIHZhciBzZWN0aW9uRWxlbWVudCA9ICQoJzxkaXYgY2xhc3M9XCJzZWN0aW9uXCI+PC9kaXY+Jyk7XHJcblxyXG4gICAgaWYgKGlzQXBwZW5kKSBwYW5lbC5hcHBlbmQoc2VjdGlvbkVsZW1lbnQpO1xyXG4gICAgZWxzZSBwYW5lbC5odG1sKHNlY3Rpb25FbGVtZW50KTtcclxuXHJcbiAgICBzdWJQYW5lbHMuZm9yRWFjaChmdW5jdGlvbih2KSB7XHJcbiAgICAgIHZhciBhcmdzID0gdi5hcmdzO1xyXG4gICAgICBhcmdzLnVuc2hpZnQodHJ1ZSk7XHJcbiAgICAgIGFyZ3MudW5zaGlmdChzZWN0aW9uRWxlbWVudCk7XHJcbiAgICAgIHYuc2hvdy5hcHBseShudWxsLCBhcmdzKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChpc1VwVGV4dCkgc2VjdGlvbkVsZW1lbnQucHJlcGVuZCgkKCc8ZGl2IGNsYXNzPVwiZnAtY29udHJvbEFycm93IGZwLXVwXCI+PGRpdj4nICsgaXNVcFRleHQgKyAnPC9kaXY+PC9kaXY+JykpO1xyXG4gICAgaWYgKGlzRG93blRleHQpIHNlY3Rpb25FbGVtZW50LmFwcGVuZCgkKCc8ZGl2IGNsYXNzPVwiZnAtY29udHJvbEFycm93IGZwLWRvd25cIj48ZGl2PicgKyBpc0Rvd25UZXh0ICsgJzwvZGl2PjwvZGl2PicpKTtcclxuXHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gYmQ7XHJcbiIsInZhciBkYXRhID0gcmVxdWlyZSgnLi9kYXRhLmpzJyksXHJcbiAgbG9va3VwID0gcmVxdWlyZSgnLi9sb29rdXAuanMnKSxcclxuICBiYXNlID0gcmVxdWlyZSgnLi9iYXNlLmpzJyksXHJcbiAgcGF0aWVudHMgPSByZXF1aXJlKCcuL3BhbmVscy9wYXRpZW50cy5qcycpLFxyXG4gIHBhdGllbnRMaXN0ID0gcmVxdWlyZSgnLi9wYW5lbHMvcGF0aWVudExpc3QuanMnKSxcclxuICB0ZWFtQWN0aW9uUGxhbiA9IHJlcXVpcmUoJy4vcGFuZWxzL3RlYW1BY3Rpb25QbGFuLmpzJyksXHJcbiAgYWxsUGF0aWVudHMgPSByZXF1aXJlKCcuL3BhbmVscy9hbGxQYXRpZW50cy5qcycpLFxyXG4gIHdlbGNvbWUgPSByZXF1aXJlKCcuL3BhbmVscy93ZWxjb21lLmpzJyksXHJcbiAgbGF5b3V0ID0gcmVxdWlyZSgnLi9sYXlvdXQuanMnKSxcclxuICBvdmVydmlldyA9IHJlcXVpcmUoJy4vdmlld3Mvb3ZlcnZpZXcuanMnKSxcclxuICBpbmRpY2F0b3JWaWV3ID0gcmVxdWlyZSgnLi92aWV3cy9pbmRpY2F0b3IuanMnKSxcclxuICBwYXRpZW50VmlldyA9IHJlcXVpcmUoJy4vdmlld3MvcGF0aWVudC5qcycpLFxyXG4gIGFjdGlvblBsYW4gPSByZXF1aXJlKCcuL3ZpZXdzL2FjdGlvbnMuanMnKSxcclxuICBNdXN0YWNoZSA9IHJlcXVpcmUoJ211c3RhY2hlJyk7XHJcblxyXG52YXIgdGVtcGxhdGUgPSB7XHJcblxyXG4gIGxvYWRDb250ZW50OiBmdW5jdGlvbihoYXNoLCBpc1BvcHBpbmdTdGF0ZSkge1xyXG4gICAgY29uc29sZS50aW1lKFwiMVwiKTtcclxuICAgIGJhc2UuaGlkZVRvb2x0aXBzKCk7XHJcbiAgICBjb25zb2xlLnRpbWVFbmQoXCIxXCIpO1xyXG5cclxuICAgIGNvbnNvbGUudGltZShcIjJcIik7XHJcblxyXG4gICAgdmFyIGksIHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgaW5kaWNhdG9yLCBwYXRpZW50SWQ7XHJcbiAgICBpZiAoIWlzUG9wcGluZ1N0YXRlKSB7XHJcbiAgICAgIHdpbmRvdy5sb2NhdGlvbi5oYXNoID0gaGFzaDtcclxuICAgIH1cclxuICAgIGNvbnNvbGUudGltZUVuZChcIjJcIik7XHJcbiAgICBjb25zb2xlLnRpbWUoXCIzXCIpO1xyXG5cclxuICAgIGlmIChoYXNoID09PSAnJykge1xyXG4gICAgICBiYXNlLmNsZWFyQm94KCk7XHJcbiAgICAgIGJhc2Uuc2hvd0Zvb3RlcigpO1xyXG4gICAgICBsYXlvdXQuc2hvd1BhZ2UoJ2xvZ2luJyk7XHJcbiAgICAgICQoJ2h0bWwnKS5yZW1vdmVDbGFzcygnc2Nyb2xsLWJhcicpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgYmFzZS5oaWRlRm9vdGVyKCk7XHJcbiAgICAgIGNvbnNvbGUudGltZUVuZChcIjNcIik7XHJcbiAgICAgIGNvbnNvbGUudGltZShcIjRcIik7XHJcbiAgICAgICQoJ2h0bWwnKS5hZGRDbGFzcygnc2Nyb2xsLWJhcicpO1xyXG4gICAgICBjb25zb2xlLnRpbWVFbmQoXCI0XCIpO1xyXG4gICAgICBjb25zb2xlLnRpbWUoXCI1XCIpO1xyXG4gICAgICB2YXIgcGFyYW1zID0ge307XHJcbiAgICAgIHZhciB1cmxCaXRzID0gaGFzaC5zcGxpdCgnLycpO1xyXG5cclxuICAgICAgaWYgKGhhc2guaW5kZXhPZignPycpID4gLTEpIHtcclxuICAgICAgICBoYXNoLnNwbGl0KCc/JylbMV0uc3BsaXQoJyYnKS5mb3JFYWNoKGZ1bmN0aW9uKHBhcmFtKSB7XHJcbiAgICAgICAgICB2YXIgZWxlbXMgPSBwYXJhbS5zcGxpdChcIj1cIik7XHJcbiAgICAgICAgICBwYXJhbXNbZWxlbXNbMF1dID0gZWxlbXNbMV07XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdXJsQml0cyA9IGhhc2guc3BsaXQoJz8nKVswXS5zcGxpdCgnLycpO1xyXG4gICAgICB9XHJcbiAgICAgIGNvbnNvbGUudGltZUVuZChcIjVcIik7XHJcbiAgICAgIGNvbnNvbGUudGltZShcIjZcIik7XHJcbiAgICAgIGlmICh1cmxCaXRzWzBdID09PSBcIiNvdmVydmlld1wiICYmICF1cmxCaXRzWzFdKSB7XHJcblxyXG4gICAgICAgIG92ZXJ2aWV3LmNyZWF0ZSh0ZW1wbGF0ZS5sb2FkQ29udGVudCk7XHJcblxyXG4gICAgICB9IGVsc2UgaWYgKHVybEJpdHNbMF0gPT09IFwiI2luZGljYXRvcnNcIikge1xyXG5cclxuICAgICAgICBpbmRpY2F0b3JWaWV3LmNyZWF0ZSh1cmxCaXRzWzFdLCB1cmxCaXRzWzJdLCB1cmxCaXRzWzNdLCBwYXJhbXMudGFiIHx8IFwidHJlbmRcIiwgdGVtcGxhdGUubG9hZENvbnRlbnQpO1xyXG4gICAgICAgIGNvbnNvbGUudGltZUVuZChcIjZcIik7XHJcbiAgICAgIH0gZWxzZSBpZiAodXJsQml0c1swXSA9PT0gXCIjbWFpblwiKSB7XHJcbiAgICAgICAgYmFzZS5jbGVhckJveCgpO1xyXG4gICAgICAgIHBhdGh3YXlJZCA9IHVybEJpdHNbMV07XHJcbiAgICAgICAgZGF0YS5wYXRod2F5SWQgPSBwYXRod2F5SWQ7XHJcbiAgICAgICAgcGF0aHdheVN0YWdlID0gdXJsQml0c1syXTtcclxuICAgICAgICB2YXIgeWVzUGVvcGxlID0gdXJsQml0c1szXSAhPT0gXCJub1wiO1xyXG4gICAgICAgIHN0YW5kYXJkID0gdXJsQml0c1s0XTtcclxuXHJcbiAgICAgICAgaWYgKHBhdGh3YXlTdGFnZSAmJiBsYXlvdXQucGFnZSAhPT0gJ21haW4tZGFzaGJvYXJkJykge1xyXG4gICAgICAgICAgJCgnLnBhZ2UnKS5oaWRlKCk7XHJcbiAgICAgICAgICAkKCcjbWFpbi1kYXNoYm9hcmQnKS5zaG93KCk7XHJcblxyXG4gICAgICAgICAgLy8vL2xheW91dC5zaG93U2lkZVBhbmVsKCk7XHJcbiAgICAgICAgICBsYXlvdXQuc2hvd092ZXJ2aWV3UGFuZWxzKCk7XHJcbiAgICAgICAgICBsYXlvdXQuc2hvd0hlYWRlckJhckl0ZW1zKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAocGF0aHdheVN0YWdlKSB7XHJcbiAgICAgICAgICBpZiAoeWVzUGVvcGxlKSB7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlLnNob3dQYXRod2F5U3RhZ2VWaWV3T2socGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHRlbXBsYXRlLnNob3VsZFdlRmFkZShsb29rdXAuY3VycmVudFVybCwgaGFzaCkpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGVtcGxhdGUuc2hvd1BhdGh3YXlTdGFnZVZpZXcocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCB0ZW1wbGF0ZS5zaG91bGRXZUZhZGUobG9va3VwLmN1cnJlbnRVcmwsIGhhc2gpKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgdGVtcGxhdGUuc2hvd092ZXJ2aWV3KHBhdGh3YXlJZCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcblxyXG4gICAgICB9IGVsc2UgaWYgKHVybEJpdHNbMF0gPT09IFwiI2hlbHBcIikge1xyXG4gICAgICAgIGJhc2UuY2xlYXJCb3goKTtcclxuICAgICAgICBiYXNlLnNlbGVjdFRhYihcIlwiKTtcclxuICAgICAgICBsYXlvdXQuc2hvd1BhZ2UoJ2hlbHAtcGFnZScpO1xyXG5cclxuICAgICAgICBsYXlvdXQuc2hvd0hlYWRlckJhckl0ZW1zKCk7XHJcblxyXG4gICAgICB9IGVsc2UgaWYgKHVybEJpdHNbMF0gPT09IFwiI3BhdGllbnRcIikge1xyXG5cclxuICAgICAgICAvL2NyZWF0ZShwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZClcclxuICAgICAgICBwYXRpZW50Vmlldy5jcmVhdGUodXJsQml0c1syXSwgdXJsQml0c1szXSwgdXJsQml0c1s0XSwgdXJsQml0c1sxXSwgdGVtcGxhdGUubG9hZENvbnRlbnQpO1xyXG5cclxuICAgICAgfSBlbHNlIGlmICh1cmxCaXRzWzBdID09PSBcIiNwYXRpZW50c1wiKSB7XHJcblxyXG4gICAgICAgIHBhdGllbnRJZCA9IHVybEJpdHNbMV07XHJcblxyXG4gICAgICAgIHBhdGllbnRWaWV3LmNyZWF0ZShudWxsLCBudWxsLCBudWxsLCBwYXRpZW50SWQsIHRlbXBsYXRlLmxvYWRDb250ZW50KTtcclxuICAgICAgICAvKnBhdGh3YXlJZCA9IHVybEJpdHNbMl07XHJcblxyXG4gICAgICAgIGFsbFBhdGllbnRzLnNob3dWaWV3KHBhdGllbnRJZCwgdHJ1ZSk7XHJcblxyXG4gICAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuXHJcbiAgICAgICAgaWYgKHBhdGllbnRJZCkge1xyXG4gICAgICAgICAgdmFyIG5ocyA9IGRhdGEucGF0TG9va3VwID8gZGF0YS5wYXRMb29rdXBbcGF0aWVudElkXSA6IHBhdGllbnRJZDtcclxuICAgICAgICAgICQoJyNwYXRpZW50cycpLmZpbmQoJ2Rpdi50YWJsZS1zY3JvbGwnKS5nZXROaWNlU2Nyb2xsKCkuZG9TY3JvbGxQb3MoMCwgJCgnI3BhdGllbnRzIHRkJykuZmlsdGVyKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJCh0aGlzKS50ZXh0KCkudHJpbSgpID09PSBuaHM7XHJcbiAgICAgICAgICB9KS5wb3NpdGlvbigpLnRvcCAtIDE0MCk7XHJcbiAgICAgICAgICAkKCcjcGF0aWVudHMnKS5maW5kKCd0cjpjb250YWlucygnICsgbmhzICsgJyknKS5hZGRDbGFzcyhcImhpZ2hsaWdodGVkXCIpO1xyXG4gICAgICAgIH0qL1xyXG4gICAgICB9IGVsc2UgaWYgKHVybEJpdHNbMF0gPT09IFwiI2FncmVlZGFjdGlvbnNcIikge1xyXG5cclxuICAgICAgICBhY3Rpb25QbGFuLmNyZWF0ZSgpO1xyXG5cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvL2lmIHNjcmVlbiBub3QgaW4gY29ycmVjdCBzZWdtZW50IHRoZW4gc2VsZWN0IGl0XHJcbiAgICAgICAgYWxlcnQoXCJzaG91bGRuJ3QgZ2V0IGhlcmVcIik7XHJcbiAgICAgICAgcGF0aHdheVN0YWdlID0gaGFzaC5zdWJzdHIoMSk7XHJcblxyXG4gICAgICAgIHRlbXBsYXRlLnNob3dQYXRod2F5U3RhZ2VWaWV3KHBhdGh3YXlTdGFnZSk7XHJcblxyXG4gICAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGxvb2t1cC5jdXJyZW50VXJsID0gaGFzaDtcclxuICB9LFxyXG5cclxuICAvL1Nob3cgdGhlIG92ZXJ2aWV3IHBhZ2UgZm9yIGEgZGlzZWFzZVxyXG4gIHNob3dPdmVydmlldzogZnVuY3Rpb24oZGlzZWFzZSkge1xyXG4gICAgZGF0YS5wYXRod2F5SWQgPSBkaXNlYXNlO1xyXG5cclxuICAgIGxheW91dC5zaG93TWFpblZpZXcoZGF0YS5kaXNlYXNlcy5tYXAoZnVuY3Rpb24odikge1xyXG4gICAgICByZXR1cm4gdi5pZDtcclxuICAgIH0pLmluZGV4T2YoZGlzZWFzZSkpO1xyXG5cclxuICAgICQoJ2FzaWRlIGxpIHVsIGxpJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgJCgnYXNpZGUgYVtocmVmPVwiI21haW4vJyArIGRpc2Vhc2UgKyAnXCJdOmNvbnRhaW5zKFwiT3ZlcnZpZXdcIiknKS5wYXJlbnQoKS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcblxyXG4gICAgJCgnI21haW5UaXRsZScpLnNob3coKTtcclxuICAgIGJhc2UudXBkYXRlVGl0bGUoZGF0YVtkYXRhLnBhdGh3YXlJZF1bXCJkaXNwbGF5LW5hbWVcIl0gKyBcIjogT3ZlcnZpZXcgKHByYWN0aWNlLWxldmVsIGRhdGEpXCIpO1xyXG5cclxuICAgIC8vU2hvdyBvdmVydmlldyBwYW5lbHNcclxuICAgIHRlbXBsYXRlLnNob3dPdmVydmlld1BhbmVscygpO1xyXG4gICAgdGVhbUFjdGlvblBsYW4uc2hvdyhmYXJSaWdodFBhbmVsKTtcclxuICB9LFxyXG5cclxuICBzaG93T3ZlcnZpZXdQYW5lbHM6IGZ1bmN0aW9uKCkge1xyXG4gICAgYmFzZS5zd2l0Y2hUbzIyMUxheW91dCgpO1xyXG5cclxuICAgIHRlbXBsYXRlLnNob3dQYW5lbChsb29rdXAuY2F0ZWdvcmllcy5kaWFnbm9zaXMubmFtZSwgdG9wTGVmdFBhbmVsLCB0cnVlKTtcclxuICAgIHRlbXBsYXRlLnNob3dQYW5lbChsb29rdXAuY2F0ZWdvcmllcy5tb25pdG9yaW5nLm5hbWUsIHRvcFJpZ2h0UGFuZWwsIHRydWUpO1xyXG4gICAgdGVtcGxhdGUuc2hvd1BhbmVsKGxvb2t1cC5jYXRlZ29yaWVzLnRyZWF0bWVudC5uYW1lLCBib3R0b21MZWZ0UGFuZWwsIHRydWUpO1xyXG4gICAgdGVtcGxhdGUuc2hvd1BhbmVsKGxvb2t1cC5jYXRlZ29yaWVzLmV4Y2x1c2lvbnMubmFtZSwgYm90dG9tUmlnaHRQYW5lbCwgdHJ1ZSk7XHJcblxyXG4gICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gIH0sXHJcblxyXG4gIHNob3dQYW5lbDogZnVuY3Rpb24ocGF0aHdheVN0YWdlLCBsb2NhdGlvbiwgZW5hYmxlSG92ZXIpIHtcclxuICAgIGJhc2Uuc2hvd1BhdGh3YXlTdGFnZU92ZXJ2aWV3UGFuZWwobG9jYXRpb24sIGVuYWJsZUhvdmVyLCBkYXRhLnBhdGh3YXlJZCwgcGF0aHdheVN0YWdlKTtcclxuXHJcbiAgICBpZiAoZW5hYmxlSG92ZXIpIHRlbXBsYXRlLmhpZ2hsaWdodE9uSG92ZXJBbmRFbmFibGVTZWxlY3RCeUNsaWNrKGxvY2F0aW9uKTtcclxuICAgIGVsc2UgbG9jYXRpb24uY2hpbGRyZW4oJ2RpdicpLmFkZENsYXNzKCd1bmNsaWNrYWJsZScpO1xyXG4gIH0sXHJcblxyXG4gIC8vU2hvdyB0aGUgcGF0aHdheSBzdGFnZSBmb3IgYSBkaXNlYXNlXHJcbiAgc2hvd1BhdGh3YXlTdGFnZVZpZXc6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgc2hvdWxkRmFkZSkge1xyXG4gICAgZmFyUmlnaHRQYW5lbC5yZW1vdmVDbGFzcygnc3RhbmRhcmQtbWlzc2VkLXBhZ2UnKS5yZW1vdmVDbGFzcygnc3RhbmRhcmQtYWNoaWV2ZWQtcGFnZScpLnJlbW92ZUNsYXNzKCdzdGFuZGFyZC1ub3QtcmVsZXZhbnQtcGFnZScpO1xyXG4gICAgZGF0YS5wYXRod2F5SWQgPSBwYXRod2F5SWQ7XHJcbiAgICBsYXlvdXQuc2hvd01haW5WaWV3KGRhdGEuZGlzZWFzZXMubWFwKGZ1bmN0aW9uKHYpIHtcclxuICAgICAgcmV0dXJuIHYuaWQ7XHJcbiAgICB9KS5pbmRleE9mKHBhdGh3YXlJZCkpO1xyXG5cclxuICAgICQoJ2FzaWRlIGxpIHVsIGxpJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgdmFyIHJlID0gbmV3IFJlZ0V4cChwYXRod2F5U3RhZ2UsIFwiZ1wiKTtcclxuICAgICQoJ2FzaWRlIGEnKS5maWx0ZXIoZnVuY3Rpb24oKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLmhyZWYubWF0Y2gocmUpO1xyXG4gICAgfSkucGFyZW50KCkuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG5cclxuICAgIGJhc2Uuc3dpdGNoVG8xMTBMYXlvdXQoKTtcclxuXHJcbiAgICBpZiAoIXN0YW5kYXJkKSB7XHJcbiAgICAgIHN0YW5kYXJkID0gT2JqZWN0LmtleXMoZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzKVswXTtcclxuICAgIH1cclxuXHJcbiAgICB2YXIgcGFuZWwgPSBwYXRpZW50cy5jcmVhdGUocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkKTtcclxuXHJcbiAgICBpZiAoc2hvdWxkRmFkZSkge1xyXG4gICAgICBmYXJMZWZ0UGFuZWwuZmFkZU91dCgxMDAsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICQodGhpcykuaHRtbChwYW5lbCk7XHJcbiAgICAgICAgcGF0aWVudHMud2lyZVVwKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBmYXJMZWZ0UGFuZWwsIHN0YW5kYXJkKTtcclxuICAgICAgICBwYXRpZW50TGlzdC5wb3B1bGF0ZShwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIG51bGwpO1xyXG4gICAgICAgICQoJyNtYWluVGl0bGUnKS5oaWRlKCk7XHJcbiAgICAgICAgYmFzZS51cGRhdGVUaXRsZShkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS50ZXh0LnBhZ2UudGV4dCwgZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0udGV4dC5wYWdlLnRvb2x0aXApO1xyXG4gICAgICAgICQodGhpcykuZmFkZUluKDEwMCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgZmFyTGVmdFBhbmVsLmh0bWwocGFuZWwpO1xyXG4gICAgICBwYXRpZW50cy53aXJlVXAocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIGZhckxlZnRQYW5lbCwgc3RhbmRhcmQpO1xyXG4gICAgICBwYXRpZW50TGlzdC5wb3B1bGF0ZShwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIG51bGwpO1xyXG4gICAgICAkKCcjbWFpblRpdGxlJykuaGlkZSgpO1xyXG4gICAgICBiYXNlLnVwZGF0ZVRpdGxlKGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnRleHQucGFnZS50ZXh0LCBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS50ZXh0LnBhZ2UudG9vbHRpcCk7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIHRlbXBNdXN0ID0gJCgnI3BhdGllbnQtcGFuZWwtcGxhY2Vob2xkZXInKS5odG1sKCk7XHJcbiAgICBmYXJSaWdodFBhbmVsLmh0bWwoTXVzdGFjaGUucmVuZGVyKHRlbXBNdXN0KSk7XHJcbiAgfSxcclxuXHJcbiAgc2hvd1BhdGh3YXlTdGFnZVZpZXdPazogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHNob3VsZEZhZGUpIHtcclxuICAgIGZhclJpZ2h0UGFuZWwucmVtb3ZlQ2xhc3MoJ3N0YW5kYXJkLW1pc3NlZC1wYWdlJykucmVtb3ZlQ2xhc3MoJ3N0YW5kYXJkLWFjaGlldmVkLXBhZ2UnKS5yZW1vdmVDbGFzcygnc3RhbmRhcmQtbm90LXJlbGV2YW50LXBhZ2UnKTtcclxuICAgIGxheW91dC5zaG93TWFpblZpZXcoZGF0YS5kaXNlYXNlcy5tYXAoZnVuY3Rpb24odikge1xyXG4gICAgICByZXR1cm4gdi5pZDtcclxuICAgIH0pLmluZGV4T2YocGF0aHdheUlkKSk7XHJcblxyXG4gICAgJCgnYXNpZGUgbGkgdWwgbGknKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICB2YXIgcmUgPSBuZXcgUmVnRXhwKHBhdGh3YXlTdGFnZSwgXCJnXCIpO1xyXG4gICAgJCgnYXNpZGUgYScpLmZpbHRlcihmdW5jdGlvbigpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuaHJlZi5tYXRjaChyZSk7XHJcbiAgICB9KS5wYXJlbnQoKS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcblxyXG4gICAgYmFzZS5zd2l0Y2hUbzExMExheW91dCgpO1xyXG5cclxuICAgIHZhciBwYW5lbCA9IHBhdGllbnRzLmNyZWF0ZU9rKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlKTtcclxuXHJcbiAgICBpZiAoc2hvdWxkRmFkZSkge1xyXG4gICAgICBmYXJMZWZ0UGFuZWwuZmFkZU91dCgyMDAsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICQodGhpcykuaHRtbChwYW5lbCk7XHJcbiAgICAgICAgcGF0aWVudHMud2lyZVVwT2socGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIGZhckxlZnRQYW5lbCk7XHJcbiAgICAgICAgcGF0aWVudHMucG9wdWxhdGVPayhwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgbnVsbCk7XHJcbiAgICAgICAgJCgnI21haW5UaXRsZScpLmhpZGUoKTtcclxuICAgICAgICBiYXNlLnVwZGF0ZVRpdGxlKGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnRleHQucGFnZS50ZXh0LCBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS50ZXh0LnBhZ2UudG9vbHRpcCk7XHJcbiAgICAgICAgJCh0aGlzKS5mYWRlSW4oMzAwKTtcclxuICAgICAgfSk7XHJcbiAgICAgIHZhciB0ZW1wTXVzdCA9ICQoJyNwYXRpZW50LXBhbmVsLXBsYWNlaG9sZGVyJykuaHRtbCgpO1xyXG4gICAgICBmYXJSaWdodFBhbmVsLmh0bWwoTXVzdGFjaGUucmVuZGVyKHRlbXBNdXN0KSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBmYXJMZWZ0UGFuZWwuaHRtbChwYW5lbCk7XHJcbiAgICAgIHBhdGllbnRzLndpcmVVcE9rKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBmYXJMZWZ0UGFuZWwpO1xyXG4gICAgICBwYXRpZW50cy5wb3B1bGF0ZU9rKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBudWxsKTtcclxuICAgICAgJCgnI21haW5UaXRsZScpLmhpZGUoKTtcclxuICAgICAgYmFzZS51cGRhdGVUaXRsZShkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS50ZXh0LnBhZ2UudGV4dCwgZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0udGV4dC5wYWdlLnRvb2x0aXApO1xyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIGhpZ2hsaWdodE9uSG92ZXJBbmRFbmFibGVTZWxlY3RCeUNsaWNrOiBmdW5jdGlvbihwYW5lbFNlbGVjdG9yKSB7XHJcbiAgICBwYW5lbFNlbGVjdG9yLmNoaWxkcmVuKCdkaXYnKS5yZW1vdmVDbGFzcygndW5jbGlja2FibGUnKS5vbignbW91c2VvdmVyJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoJ3BhbmVsLWRlZmF1bHQnKTtcclxuICAgIH0pLm9uKCdtb3VzZW91dCcsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgJCh0aGlzKS5hZGRDbGFzcygncGFuZWwtZGVmYXVsdCcpO1xyXG4gICAgfSkub24oJ2NsaWNrJywgJ3RyLnN0YW5kYXJkLXJvdycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgaGlzdG9yeS5wdXNoU3RhdGUobnVsbCwgbnVsbCwgJyNtYWluLycgKyBkYXRhLnBhdGh3YXlJZCArICcvJyArICQodGhpcykuY2xvc2VzdCgnLnBhbmVsJykuZGF0YSgnc3RhZ2UnKSArICcvbm8vJyArICQodGhpcykuZGF0YSgnc3RhbmRhcmQnKSk7XHJcbiAgICAgIHRlbXBsYXRlLmxvYWRDb250ZW50KCcjbWFpbi8nICsgZGF0YS5wYXRod2F5SWQgKyAnLycgKyAkKHRoaXMpLmNsb3Nlc3QoJy5wYW5lbCcpLmRhdGEoJ3N0YWdlJykgKyAnL25vLycgKyAkKHRoaXMpLmRhdGEoJ3N0YW5kYXJkJyksIHRydWUpO1xyXG4gICAgICAvLyBkbyBub3QgZ2l2ZSBhIGRlZmF1bHQgYWN0aW9uXHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfSkub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAvLyBrZWVwIHRoZSBsaW5rIGluIHRoZSBicm93c2VyIGhpc3RvcnlcclxuICAgICAgaGlzdG9yeS5wdXNoU3RhdGUobnVsbCwgbnVsbCwgJyNtYWluLycgKyBkYXRhLnBhdGh3YXlJZCArICcvJyArICQodGhpcykuZGF0YSgnc3RhZ2UnKSArICcvbm8nKTtcclxuICAgICAgdGVtcGxhdGUubG9hZENvbnRlbnQoJyNtYWluLycgKyBkYXRhLnBhdGh3YXlJZCArICcvJyArICQodGhpcykuZGF0YSgnc3RhZ2UnKSArICcvbm8nLCB0cnVlKTtcclxuICAgICAgLy8gZG8gbm90IGdpdmUgYSBkZWZhdWx0IGFjdGlvblxyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9KTtcclxuXHJcbiAgfSxcclxuXHJcbiAgZGlzcGxheVNlbGVjdGVkUGF0aWVudDogZnVuY3Rpb24oaWQpIHtcclxuICAgIHZhciBuaHMgPSBkYXRhLnBhdExvb2t1cCA/IGRhdGEucGF0TG9va3VwW2lkXSA6IGlkO1xyXG5cclxuICAgIGhpc3RvcnkucHVzaFN0YXRlKG51bGwsIG51bGwsICcjcGF0aWVudHMvJyArIGlkKTtcclxuICAgIHRlbXBsYXRlLmxvYWRDb250ZW50KCcjcGF0aWVudHMvJyArIGlkLCB0cnVlKTtcclxuXHJcbiAgICAkKCcubGlzdC1pdGVtJykucmVtb3ZlQ2xhc3MoJ2hpZ2hsaWdodGVkJyk7XHJcbiAgICAkKCcubGlzdC1pdGVtOmhhcyhidXR0b25bZGF0YS1jbGlwYm9hcmQtdGV4dD0nICsgbmhzICsgJ10pJykuYWRkQ2xhc3MoJ2hpZ2hsaWdodGVkJyk7XHJcblxyXG4gICAgLy9zY3JvbGwgdG8gcGF0aWVudHNcclxuICAgICQoJyNwYXRpZW50cycpLmZpbmQoJ2Rpdi50YWJsZS1zY3JvbGwnKS5nZXROaWNlU2Nyb2xsKCkuZG9TY3JvbGxQb3MoMCwgJCgnI3BhdGllbnRzIHRkJykuZmlsdGVyKGZ1bmN0aW9uKCkge1xyXG4gICAgICByZXR1cm4gJCh0aGlzKS50ZXh0KCkudHJpbSgpID09PSBuaHM7XHJcbiAgICB9KS5wb3NpdGlvbigpLnRvcCAtIDE0MCk7XHJcbiAgfSxcclxuXHJcbiAgc2hvdWxkV2VGYWRlOiBmdW5jdGlvbihvbGRIYXNoLCBuZXdIYXNoKSB7XHJcbiAgICBvbGRIYXNoID0gb2xkSGFzaC5zcGxpdCgnLycpO1xyXG4gICAgbmV3SGFzaCA9IG5ld0hhc2guc3BsaXQoJy8nKTtcclxuXHJcbiAgICBpZiAob2xkSGFzaFswXSA9PT0gbmV3SGFzaFswXSAmJiBvbGRIYXNoWzFdID09PSBuZXdIYXNoWzFdICYmIG9sZEhhc2hbMl0gPT09IG5ld0hhc2hbMl0gJiYgb2xkSGFzaFswXSAmJiBuZXdIYXNoWzBdKSByZXR1cm4gZmFsc2U7XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSB0ZW1wbGF0ZTtcclxuIiwidmFyIGJhc2UgPSByZXF1aXJlKCcuLi9iYXNlLmpzJyksXHJcbiAgbGF5b3V0ID0gcmVxdWlyZSgnLi4vbGF5b3V0LmpzJyksXHJcbiAgd2VsY29tZSA9IHJlcXVpcmUoJy4uL3BhbmVscy93ZWxjb21lLmpzJyk7XHJcblxyXG52YXIgSUQgPSBcIkFDVElPTl9QTEFOX1ZJRVdcIjtcclxuXHJcbnZhciBhcCA9IHtcclxuXHJcbiAgY3JlYXRlOiBmdW5jdGlvbigpIHtcclxuXHJcbiAgICBiYXNlLnNlbGVjdFRhYihcImFjdGlvbnNcIik7XHJcblxyXG4gICAgaWYobGF5b3V0LnZpZXcgIT09IElEKSB7XHJcbiAgICAgIC8vTm90IGFscmVhZHkgaW4gdGhpcyB2aWV3IHNvIHdlIG5lZWQgdG8gcmVqaWcgYSBmZXcgdGhpbmdzXHJcbiAgICAgIGJhc2UuY2xlYXJCb3goKTtcclxuICAgICAgbGF5b3V0LnNob3dQYWdlKCd3ZWxjb21lJyk7XHJcbiAgICAgIGxheW91dC5zaG93SGVhZGVyQmFySXRlbXMoKTtcclxuXHJcbiAgICAgICQoJyN3ZWxjb21lLXRhYnMgbGknKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICQoJyNvdXRzdGFuZGluZ1Rhc2tzJykuY2xvc2VzdCgnbGknKS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcblxyXG4gICAgICBsYXlvdXQudmlldyA9IElEO1xyXG4gICAgfVxyXG5cclxuICAgIHdlbGNvbWUucG9wdWxhdGUoKTtcclxuXHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gYXA7XHJcbiIsInZhciBiYXNlID0gcmVxdWlyZSgnLi4vYmFzZS5qcycpLFxyXG4gIGRhdGEgPSByZXF1aXJlKCcuLi9kYXRhLmpzJyksXHJcbiAgcGF0aWVudExpc3QgPSByZXF1aXJlKCcuLi9wYW5lbHMvcGF0aWVudExpc3QuanMnKSxcclxuICBpbmRpY2F0b3JCcmVha2Rvd24gPSByZXF1aXJlKCcuLi9wYW5lbHMvaW5kaWNhdG9yQnJlYWtkb3duLmpzJyksXHJcbiAgaW5kaWNhdG9yQmVuY2htYXJrID0gcmVxdWlyZSgnLi4vcGFuZWxzL2luZGljYXRvckJlbmNobWFyay5qcycpLFxyXG4gIGluZGljYXRvclRyZW5kID0gcmVxdWlyZSgnLi4vcGFuZWxzL2luZGljYXRvclRyZW5kLmpzJyksXHJcbiAgdGVhbUFjdGlvblBsYW4gPSByZXF1aXJlKCcuLi9wYW5lbHMvdGVhbUFjdGlvblBsYW4uanMnKSxcclxuICB3cmFwcGVyID0gcmVxdWlyZSgnLi4vcGFuZWxzL3dyYXBwZXIuanMnKSxcclxuICBsYXlvdXQgPSByZXF1aXJlKCcuLi9sYXlvdXQuanMnKTtcclxuXHJcbnZhciBJRCA9IFwiSU5ESUNBVE9SXCI7XHJcbi8qXHJcbiAqIFRoZSBpbmRpY2F0b3IgcGFnZSBjb25zaXN0cyBvZiB0aGUgcGFuZWxzOlxyXG4gKiAgIFRhYmJlZCBwYW5lbFxyXG4gKiAgICAgLSBwZXJmb3JtYW5jZSB0cmVuZFxyXG4gKiAgICAgLSBwZXJmb3JtYW5jZSBiZW5jaG1hcmtcclxuICogICBQYXRpZW50IGdyb3Vwc1xyXG4gKiAgIFBhdGllbnQgbGlzdFxyXG4gKiAgIFRlYW0gYWN0aW9uIHBsYW5cclxuICovXHJcblxyXG52YXIgaW5kID0ge1xyXG5cclxuICBjcmVhdGU6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgdGFiLCBsb2FkQ29udGVudEZuKSB7XHJcblxyXG4gICAgYmFzZS5zZWxlY3RUYWIoXCJpbmRpY2F0b3JcIik7XHJcbiAgICAkKCcubG9hZGluZy1jb250YWluZXInKS5zaG93KCk7XHJcblxyXG5cclxuICAgIC8vdXNlIGEgc2V0VGltZW91dCB0byBmb3JjZSB0aGUgVUkgdG8gY2hhbmdlIGUuZy4gc2hvdyB0aGUgbG9hZGluZy1jb250YWluZXJcclxuICAgIC8vYmVmb3JlIGZ1cnRoZXIgZXhlY3V0aW9uXHJcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICBpZiAobGF5b3V0LnZpZXcgIT09IElEKSB7XHJcbiAgICAgICAgLy9Ob3QgYWxyZWFkeSBpbiB0aGlzIHZpZXcgc28gd2UgbmVlZCB0byByZWppZyBhIGZldyB0aGluZ3NcclxuICAgICAgICBiYXNlLmNsZWFyQm94KCk7XHJcbiAgICAgICAgLy9iYXNlLnN3aXRjaFRvMjFMYXlvdXQoKTtcclxuICAgICAgICBsYXlvdXQuc2hvd01haW5WaWV3KCk7XHJcblxyXG4gICAgICAgIGJhc2UucmVtb3ZlRnVsbFBhZ2UoZmFyUmlnaHRQYW5lbCk7XHJcbiAgICAgICAgYmFzZS5oaWRlUGFuZWxzKGZhclJpZ2h0UGFuZWwpO1xyXG5cclxuICAgICAgICBsYXlvdXQudmlldyA9IElEO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoIXBhdGh3YXlJZCkge1xyXG4gICAgICAgIGlmIChsYXlvdXQucGF0aHdheUlkKSBwYXRod2F5SWQgPSBsYXlvdXQucGF0aHdheUlkO1xyXG4gICAgICAgIGVsc2UgcGF0aHdheUlkID0gT2JqZWN0LmtleXMoZGF0YS5wYXRod2F5TmFtZXMpWzBdO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoIXBhdGh3YXlTdGFnZSkge1xyXG4gICAgICAgIGlmIChsYXlvdXQucGF0aHdheVN0YWdlKSBwYXRod2F5U3RhZ2UgPSBsYXlvdXQucGF0aHdheVN0YWdlO1xyXG4gICAgICAgIGVsc2UgcGF0aHdheVN0YWdlID0gXCJtb25pdG9yaW5nXCI7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmICghc3RhbmRhcmQpIHtcclxuICAgICAgICBpZiAobGF5b3V0LnN0YW5kYXJkKSBzdGFuZGFyZCA9IGxheW91dC5zdGFuZGFyZDtcclxuICAgICAgICBlbHNlIHN0YW5kYXJkID0gT2JqZWN0LmtleXMoZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzKVswXTtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKGxheW91dC5wYXRod2F5SWQgIT09IHBhdGh3YXlJZCB8fCBsYXlvdXQucGF0aHdheVN0YWdlICE9PSBwYXRod2F5U3RhZ2UpIHtcclxuICAgICAgICAvL2RpZmZlcmVudCBwYXRod2F5IG9yIHN0YWdlIHNvIHRpdGxlIG5lZWRzIHVwZGF0aW5nXHJcbiAgICAgICAgYmFzZS51cGRhdGVUaXRsZShbe1xyXG4gICAgICAgICAgdGl0bGU6IFwiT3ZlcnZpZXdcIixcclxuICAgICAgICAgIHVybDogXCIjb3ZlcnZpZXdcIlxyXG4gICAgICAgIH0sIHtcclxuICAgICAgICAgIHRpdGxlOiBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS50ZXh0LnBhZ2UudGV4dCxcclxuICAgICAgICAgIHRvb2x0aXA6IGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnRleHQucGFnZS50b29sdGlwXHJcbiAgICAgICAgfV0pO1xyXG4gICAgICAgICQoJyNtYWluVGl0bGUnKS5zaG93KCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGxheW91dC5wYXRod2F5SWQgPSBwYXRod2F5SWQ7XHJcbiAgICAgIGxheW91dC5wYXRod2F5U3RhZ2UgPSBwYXRod2F5U3RhZ2U7XHJcbiAgICAgIGxheW91dC5zdGFuZGFyZCA9IHN0YW5kYXJkO1xyXG5cclxuICAgICAgLy9UT0RPIG5vdCBzdXJlIGlmIHRoaXMgbmVlZHMgbW92aW5nLi4/XHJcbiAgICAgIGRhdGEucGF0aHdheUlkID0gcGF0aHdheUlkO1xyXG5cclxuICAgICAgLy9UaGUgdGhyZWUgcGFuZWxzIHdlIG5lZWQgdG8gc2hvd1xyXG4gICAgICAvL1BhbmVscyBkZWNpZGUgd2hldGhlciB0aGV5IG5lZWQgdG8gcmVkcmF3IHRoZW1zZWx2ZXNcclxuICAgICAgdGVhbUFjdGlvblBsYW4uc2hvdyhmYXJMZWZ0UGFuZWwpO1xyXG5cclxuICAgICAgYmFzZS51cGRhdGVUYWIoXCJpbmRpY2F0b3JzXCIsIFtwYXRod2F5SWQudG9VcHBlckNhc2UoKSwgc3RhbmRhcmQudG9VcHBlckNhc2UoKV0uam9pbihcIiBcIiksIFtwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmRdLmpvaW4oXCIvXCIpKTtcclxuXHJcbiAgICAgIHdyYXBwZXIuc2hvdyhmYXJSaWdodFBhbmVsLCBmYWxzZSwgW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgIHNob3c6IGluZGljYXRvckJyZWFrZG93bi5zaG93LFxyXG4gICAgICAgICAgYXJnczogW3BhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudExpc3Quc2VsZWN0U3Vic2VjdGlvbl1cclxuICAgICAgICB9LCB7XHJcbiAgICAgICAgICBzaG93OiBwYXRpZW50TGlzdC5zaG93LFxyXG4gICAgICAgICAgYXJnczogW3BhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgbG9hZENvbnRlbnRGbl1cclxuICAgICAgICB9XHJcbiAgICAgIF0sIFwiU2Nyb2xsIGRvd24gb3IgY2xpY2sgZm9yIHlvdXIgcGVyZm9ybWFuY2Ugb3ZlciB0aW1lXCIsIGZhbHNlKTtcclxuICAgICAgd3JhcHBlci5zaG93KGZhclJpZ2h0UGFuZWwsIHRydWUsIFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICBzaG93OiBpbmRpY2F0b3JUcmVuZC5zaG93LFxyXG4gICAgICAgICAgYXJnczogW3BhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZF1cclxuICAgICAgICB9XHJcbiAgICAgIF0sIFwiU2Nyb2xsIGRvd24gb3IgY2xpY2sgZm9yIHlvdXIgcGVyZm9ybWFuY2UgYmVuY2htYXJrXCIsIFwiU2Nyb2xsIHVwIG9yIGNsaWNrIGZvciB5b3VyIHBhdGllbnRzIGF0IHJpc2tcIik7XHJcbiAgICAgIHdyYXBwZXIuc2hvdyhmYXJSaWdodFBhbmVsLCB0cnVlLCBbXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgc2hvdzogaW5kaWNhdG9yQmVuY2htYXJrLnNob3csXHJcbiAgICAgICAgICBhcmdzOiBbcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkXVxyXG4gICAgICAgIH1cclxuICAgICAgXSwgZmFsc2UsIFwiU2Nyb2xsIHVwIG9yIGNsaWNrIGZvciB5b3VyIHBlcmZvcm1hbmNlIG92ZXIgdGltZVwiKTtcclxuXHJcbiAgICAgIGJhc2UuYWRkRnVsbFBhZ2UoZmFyUmlnaHRQYW5lbCk7XHJcblxyXG4gICAgICAkKCcjaW5kaWNhdG9yLXBhbmUnKS5zaG93KCk7XHJcblxyXG4gICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcblxyXG4gICAgICAkKCcubG9hZGluZy1jb250YWluZXInKS5mYWRlT3V0KDEwMDApO1xyXG4gICAgfSwgMCk7XHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gaW5kO1xyXG4iLCJ2YXIgYmFzZSA9IHJlcXVpcmUoJy4uL2Jhc2UuanMnKSxcclxuICBkYXRhID0gcmVxdWlyZSgnLi4vZGF0YS5qcycpLFxyXG4gIGxheW91dCA9IHJlcXVpcmUoJy4uL2xheW91dC5qcycpLFxyXG4gIGluZGljYXRvckxpc3QgPSByZXF1aXJlKCcuLi9wYW5lbHMvaW5kaWNhdG9yTGlzdC5qcycpLFxyXG4gIHRlYW1BY3Rpb25QbGFuID0gcmVxdWlyZSgnLi4vcGFuZWxzL3RlYW1BY3Rpb25QbGFuLmpzJyk7XHJcblxyXG52YXIgSUQgPSBcIk9WRVJWSUVXXCI7XHJcbi8qXHJcbiAqIFRoZSBvdmVydmlldyBwYWdlIGNvbnNpc3RzIG9mIHRoZSBwYW5lbHM6XHJcbiAqICAgSW5kaWNhdG9yIGxpc3RcclxuICogICBUZWFtIGFjdGlvbiBwbGFuXHJcbiAqL1xyXG52YXIgb3ZlcnZpZXcgPSB7XHJcblxyXG4gIGNyZWF0ZTogZnVuY3Rpb24obG9hZENvbnRlbnRGbikge1xyXG5cclxuICAgIGJhc2Uuc2VsZWN0VGFiKFwib3ZlcnZpZXdcIik7XHJcblxyXG4gICAgaWYgKGxheW91dC52aWV3ICE9PSBJRCkge1xyXG4gICAgICAvL05vdCBhbHJlYWR5IGluIHRoaXMgdmlldyBzbyB3ZSBuZWVkIHRvIHJlamlnIGEgZmV3IHRoaW5nc1xyXG4gICAgICBiYXNlLmNsZWFyQm94KCk7XHJcbiAgICAgIC8vYmFzZS5zd2l0Y2hUbzEwMUxheW91dCgpO1xyXG4gICAgICBsYXlvdXQuc2hvd01haW5WaWV3KCk7XHJcblxyXG4gICAgICAkKCcjbWFpblRpdGxlJykuc2hvdygpO1xyXG4gICAgICBiYXNlLnVwZGF0ZVRpdGxlKFwiT3ZlcnZpZXdcIik7XHJcblxyXG4gICAgICBiYXNlLnJlbW92ZUZ1bGxQYWdlKGZhclJpZ2h0UGFuZWwpO1xyXG4gICAgICBiYXNlLmhpZGVQYW5lbHMoZmFyUmlnaHRQYW5lbCk7XHJcblxyXG4gICAgICBsYXlvdXQudmlldyA9IElEO1xyXG4gICAgfVxyXG5cclxuICAgIGRhdGEucGF0aHdheUlkID0gXCJodG5cIjsgLy9UT0RPIGZ1ZGdlXHJcblxyXG4gICAgLy9UaGUgdHdvIHBhbmVscyB3ZSBuZWVkIHRvIHNob3dcclxuICAgIC8vUGFuZWxzIGRlY2lkZSB3aGV0aGVyIHRoZXkgbmVlZCB0byByZWRyYXcgdGhlbXNlbHZlc1xyXG4gICAgdGVhbUFjdGlvblBsYW4uc2hvdyhmYXJMZWZ0UGFuZWwpO1xyXG4gICAgaW5kaWNhdG9yTGlzdC5zaG93KGZhclJpZ2h0UGFuZWwsIGZhbHNlLCBsb2FkQ29udGVudEZuKTtcclxuXHJcbiAgICAkKCcjb3ZlcnZpZXctcGFuZScpLnNob3coKTtcclxuXHJcbiAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcblxyXG4gIH1cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IG92ZXJ2aWV3O1xyXG4iLCJ2YXIgbGlmZWxpbmUgPSByZXF1aXJlKCcuLi9wYW5lbHMvbGlmZWxpbmUuanMnKSxcclxuICBkYXRhID0gcmVxdWlyZSgnLi4vZGF0YS5qcycpLFxyXG4gIGJhc2UgPSByZXF1aXJlKCcuLi9iYXNlLmpzJyksXHJcbiAgbGF5b3V0ID0gcmVxdWlyZSgnLi4vbGF5b3V0LmpzJyksXHJcbiAgaW5kaXZpZHVhbEFjdGlvblBsYW4gPSByZXF1aXJlKCcuLi9wYW5lbHMvaW5kaXZpZHVhbEFjdGlvblBsYW4uanMnKSxcclxuICBxdWFsaXR5U3RhbmRhcmQgPSByZXF1aXJlKCcuLi9wYW5lbHMvcXVhbGl0eVN0YW5kYXJkLmpzJyksXHJcbiAgcGF0aWVudFNlYXJjaCA9IHJlcXVpcmUoJy4uL3BhbmVscy9wYXRpZW50U2VhcmNoLmpzJyk7XHJcblxyXG52YXIgSUQgPSBcIlBBVElFTlRfVklFV1wiO1xyXG4vKlxyXG4gKiBUaGUgcGF0aWVudCBwYWdlIGNvbnNpc3RzIG9mIHRoZSBwYW5lbHM6XHJcbiAqICAgTGlmZWxpbmUgY2hhcnRcclxuICogICBJbmRpdmlkdWFsIGFjdGlvbiBwbGFuXHJcbiAqL1xyXG5cclxudmFyIHB2ID0ge1xyXG5cclxuICB3aXJlVXA6IGZ1bmN0aW9uKCkge1xyXG5cclxuICB9LFxyXG5cclxuICBjcmVhdGU6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkLCBsb2FkQ29udGVudEZuKSB7XHJcblxyXG4gICAgYmFzZS5zZWxlY3RUYWIoXCJwYXRpZW50XCIpO1xyXG5cclxuICAgIGlmIChsYXlvdXQudmlldyAhPT0gSUQpIHtcclxuICAgICAgLy9Ob3QgYWxyZWFkeSBpbiB0aGlzIHZpZXcgc28gd2UgbmVlZCB0byByZWppZyBhIGZldyB0aGluZ3NcclxuICAgICAgYmFzZS5jbGVhckJveCgpO1xyXG4gICAgICAvL2Jhc2Uuc3dpdGNoVG8yMUxheW91dCgpO1xyXG4gICAgICBsYXlvdXQuc2hvd01haW5WaWV3KCk7XHJcblxyXG4gICAgICBiYXNlLnJlbW92ZUZ1bGxQYWdlKGZhclJpZ2h0UGFuZWwpO1xyXG4gICAgICBiYXNlLmhpZGVQYW5lbHMoZmFyUmlnaHRQYW5lbCk7XHJcblxyXG4gICAgICBsYXlvdXQudmlldyA9IElEO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChsYXlvdXQucGF0aHdheUlkICE9PSBwYXRod2F5SWQgfHwgbGF5b3V0LnBhdGh3YXlTdGFnZSAhPT0gcGF0aHdheVN0YWdlIHx8XHJcbiAgICAgIGxheW91dC5zdGFuZGFyZCAhPT0gc3RhbmRhcmQgfHwgbGF5b3V0LnBhdGllbnRJZCAhPT0gcGF0aWVudElkKSB7XHJcbiAgICAgIC8vZGlmZmVyZW50IHBhdGh3YXkgb3Igc3RhZ2Ugb3IgcGF0aWVudElkIHNvIHRpdGxlIG5lZWRzIHVwZGF0aW5nXHJcbiAgICAgICQoJyNtYWluVGl0bGUnKS5zaG93KCk7XHJcblxyXG4gICAgICBpZiAocGF0aHdheUlkICYmIHBhdGh3YXlTdGFnZSAmJiBzdGFuZGFyZCkge1xyXG5cclxuICAgICAgICBiYXNlLnVwZGF0ZVRpdGxlKFt7XHJcbiAgICAgICAgICB0aXRsZTogXCJPdmVydmlld1wiLFxyXG4gICAgICAgICAgdXJsOiBcIiNvdmVydmlld1wiXHJcbiAgICAgICAgICAgICAgICB9LCB7XHJcbiAgICAgICAgICB0aXRsZTogZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0udGV4dC5wYWdlLnRleHQsXHJcbiAgICAgICAgICB0b29sdGlwOiBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS50ZXh0LnBhZ2UudG9vbHRpcCxcclxuICAgICAgICAgIHVybDogW1wiI292ZXJ2aWV3XCIsIHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZF0uam9pbihcIi9cIilcclxuICAgICAgICAgICAgICAgIH0sIHtcclxuICAgICAgICAgIHRpdGxlOiBwYXRpZW50SWRcclxuICAgICAgICAgICAgICAgIH1dKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBiYXNlLnVwZGF0ZVRpdGxlKFt7XHJcbiAgICAgICAgICB0aXRsZTogXCJPdmVydmlld1wiLFxyXG4gICAgICAgICAgdXJsOiBcIiNvdmVydmlld1wiXHJcbiAgICAgICAgICAgICAgICB9LCB7XHJcbiAgICAgICAgICB0aXRsZTogcGF0aWVudElkXHJcbiAgICAgICAgICAgICAgfV0pO1xyXG4gICAgICB9XHJcbiAgICB9XG5cblxuICAgIGJhc2UuaGlkZVBhbmVscyhmYXJMZWZ0UGFuZWwpO1xuICAgIHBhdGllbnRTZWFyY2guc2hvdyhmYXJSaWdodFBhbmVsLCBmYWxzZSwgbG9hZENvbnRlbnRGbik7XHJcblxyXG4gICAgaWYgKHBhdGllbnRJZCkge1xyXG4gICAgICBiYXNlLnVwZGF0ZVRhYihcInBhdGllbnRzXCIsIHBhdGllbnRJZCwgcGF0aWVudElkKTtcclxuXHJcbiAgICAgIGxheW91dC5wYXRpZW50SWQgPSBwYXRpZW50SWQ7XHJcbiAgICAgIGRhdGEucGF0aHdheUlkID0gcGF0aHdheUlkO1xyXG5cclxuICAgICAgZGF0YS5nZXRQYXRpZW50RGF0YShwYXRpZW50SWQsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICBsaWZlbGluZS5zaG93KGZhclJpZ2h0UGFuZWwsIHRydWUsIHBhdGllbnRJZCwgZGF0YSk7XHJcbiAgICAgIH0pO1xyXG4gICAgICBpbmRpdmlkdWFsQWN0aW9uUGxhbi5zaG93KGZhckxlZnRQYW5lbCwgcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gICAgICAvL3F1YWxpdHlTdGFuZGFyZC5zaG93KCQoJyNwYXRpZW50LXBhbmUnKSwgcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG5cclxuICAgICAgJCgnI3BhdGllbnQtcGFuZScpLnNob3coKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGJhc2UudXBkYXRlVGFiKFwicGF0aWVudHNcIiwgXCJcIiwgcGF0aWVudElkKTtcclxuICAgIH1cclxuXHJcbiAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcblxyXG4gIH0sXHJcblxyXG4gIHBvcHVsYXRlOiBmdW5jdGlvbigpIHtcclxuXHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gcHY7XHJcbiJdfQ==
