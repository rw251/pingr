(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/*
 Highcharts JS v4.2.5 (2016-05-06)

 (c) 2009-2016 Torstein Honsi

 License: www.highcharts.com/license
*/
(function(m){typeof module==="object"&&module.exports?module.exports=m:m(Highcharts)})(function(m){function M(a,b,c){this.init(a,b,c)}var R=m.arrayMin,S=m.arrayMax,t=m.each,H=m.extend,I=m.isNumber,u=m.merge,T=m.map,o=m.pick,B=m.pInt,G=m.correctFloat,p=m.getOptions().plotOptions,i=m.seriesTypes,v=m.extendClass,N=m.splat,w=m.wrap,O=m.Axis,z=m.Tick,J=m.Point,U=m.Pointer,V=m.CenteredSeriesMixin,C=m.TrackerMixin,x=m.Series,y=Math,F=y.round,D=y.floor,P=y.max,W=m.Color,r=function(){};H(M.prototype,{init:function(a,
b,c){var d=this,g=d.defaultOptions;d.chart=b;d.options=a=u(g,b.angular?{background:{}}:void 0,a);(a=a.background)&&t([].concat(N(a)).reverse(),function(a){var b=a.backgroundColor,g=c.userOptions,a=u(d.defaultBackgroundOptions,a);if(b)a.backgroundColor=b;a.color=a.backgroundColor;c.options.plotBands.unshift(a);g.plotBands=g.plotBands||[];g.plotBands!==c.options.plotBands&&g.plotBands.unshift(a)})},defaultOptions:{center:["50%","50%"],size:"85%",startAngle:0},defaultBackgroundOptions:{shape:"circle",
borderWidth:1,borderColor:"silver",backgroundColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,"#FFF"],[1,"#DDD"]]},from:-Number.MAX_VALUE,innerRadius:0,to:Number.MAX_VALUE,outerRadius:"105%"}});var A=O.prototype,z=z.prototype,X={getOffset:r,redraw:function(){this.isDirty=!1},render:function(){this.isDirty=!1},setScale:r,setCategories:r,setTitle:r},Q={isRadial:!0,defaultRadialGaugeOptions:{labels:{align:"center",x:0,y:null},minorGridLineWidth:0,minorTickInterval:"auto",minorTickLength:10,minorTickPosition:"inside",
minorTickWidth:1,tickLength:10,tickPosition:"inside",tickWidth:2,title:{rotation:0},zIndex:2},defaultRadialXOptions:{gridLineWidth:1,labels:{align:null,distance:15,x:0,y:null},maxPadding:0,minPadding:0,showLastLabel:!1,tickLength:0},defaultRadialYOptions:{gridLineInterpolation:"circle",labels:{align:"right",x:-3,y:-2},showLastLabel:!1,title:{x:4,text:null,rotation:90}},setOptions:function(a){a=this.options=u(this.defaultOptions,this.defaultRadialOptions,a);if(!a.plotBands)a.plotBands=[]},getOffset:function(){A.getOffset.call(this);
this.chart.axisOffset[this.side]=0;this.center=this.pane.center=V.getCenter.call(this.pane)},getLinePath:function(a,b){var c=this.center,b=o(b,c[2]/2-this.offset);return this.chart.renderer.symbols.arc(this.left+c[0],this.top+c[1],b,b,{start:this.startAngleRad,end:this.endAngleRad,open:!0,innerR:0})},setAxisTranslation:function(){A.setAxisTranslation.call(this);if(this.center)this.transA=this.isCircular?(this.endAngleRad-this.startAngleRad)/(this.max-this.min||1):this.center[2]/2/(this.max-this.min||
1),this.minPixelPadding=this.isXAxis?this.transA*this.minPointOffset:0},beforeSetTickPositions:function(){this.autoConnect&&(this.max+=this.categories&&1||this.pointRange||this.closestPointRange||0)},setAxisSize:function(){A.setAxisSize.call(this);if(this.isRadial){this.center=this.pane.center=m.CenteredSeriesMixin.getCenter.call(this.pane);if(this.isCircular)this.sector=this.endAngleRad-this.startAngleRad;this.len=this.width=this.height=this.center[2]*o(this.sector,1)/2}},getPosition:function(a,
b){return this.postTranslate(this.isCircular?this.translate(a):0,o(this.isCircular?b:this.translate(a),this.center[2]/2)-this.offset)},postTranslate:function(a,b){var c=this.chart,d=this.center,a=this.startAngleRad+a;return{x:c.plotLeft+d[0]+Math.cos(a)*b,y:c.plotTop+d[1]+Math.sin(a)*b}},getPlotBandPath:function(a,b,c){var d=this.center,g=this.startAngleRad,e=d[2]/2,j=[o(c.outerRadius,"100%"),c.innerRadius,o(c.thickness,10)],l=/%$/,h,f=this.isCircular;this.options.gridLineInterpolation==="polygon"?
d=this.getPlotLinePath(a).concat(this.getPlotLinePath(b,!0)):(a=Math.max(a,this.min),b=Math.min(b,this.max),f||(j[0]=this.translate(a),j[1]=this.translate(b)),j=T(j,function(a){l.test(a)&&(a=B(a,10)*e/100);return a}),c.shape==="circle"||!f?(a=-Math.PI/2,b=Math.PI*1.5,h=!0):(a=g+this.translate(a),b=g+this.translate(b)),d=this.chart.renderer.symbols.arc(this.left+d[0],this.top+d[1],j[0],j[0],{start:Math.min(a,b),end:Math.max(a,b),innerR:o(j[1],j[0]-j[2]),open:h}));return d},getPlotLinePath:function(a,
b){var c=this,d=c.center,g=c.chart,e=c.getPosition(a),j,l,h;c.isCircular?h=["M",d[0]+g.plotLeft,d[1]+g.plotTop,"L",e.x,e.y]:c.options.gridLineInterpolation==="circle"?(a=c.translate(a))&&(h=c.getLinePath(0,a)):(t(g.xAxis,function(a){a.pane===c.pane&&(j=a)}),h=[],a=c.translate(a),d=j.tickPositions,j.autoConnect&&(d=d.concat([d[0]])),b&&(d=[].concat(d).reverse()),t(d,function(e,b){l=j.getPosition(e,a);h.push(b?"L":"M",l.x,l.y)}));return h},getTitlePosition:function(){var a=this.center,b=this.chart,
c=this.options.title;return{x:b.plotLeft+a[0]+(c.x||0),y:b.plotTop+a[1]-{high:0.5,middle:0.25,low:0}[c.align]*a[2]+(c.y||0)}}};w(A,"init",function(a,b,c){var k;var d=b.angular,g=b.polar,e=c.isX,j=d&&e,l,h;h=b.options;var f=c.pane||0;if(d){if(H(this,j?X:Q),l=!e)this.defaultRadialOptions=this.defaultRadialGaugeOptions}else if(g)H(this,Q),this.defaultRadialOptions=(l=e)?this.defaultRadialXOptions:u(this.defaultYAxisOptions,this.defaultRadialYOptions);if(d||g)b.inverted=!1,h.chart.zoomType=null;a.call(this,
b,c);if(!j&&(d||g)){a=this.options;if(!b.panes)b.panes=[];this.pane=(k=b.panes[f]=b.panes[f]||new M(N(h.pane)[f],b,this),b=k);h=b.options;this.startAngleRad=b=(h.startAngle-90)*Math.PI/180;this.endAngleRad=h=(o(h.endAngle,h.startAngle+360)-90)*Math.PI/180;this.offset=a.offset||0;if((this.isCircular=l)&&c.max===void 0&&h-b===2*Math.PI)this.autoConnect=!0}});w(A,"autoLabelAlign",function(a){if(!this.isRadial)return a.apply(this,[].slice.call(arguments,1))});w(z,"getPosition",function(a,b,c,d,g){var e=
this.axis;return e.getPosition?e.getPosition(c):a.call(this,b,c,d,g)});w(z,"getLabelPosition",function(a,b,c,d,g,e,j,l,h){var f=this.axis,k=e.y,n=20,s=e.align,i=(f.translate(this.pos)+f.startAngleRad+Math.PI/2)/Math.PI*180%360;f.isRadial?(a=f.getPosition(this.pos,f.center[2]/2+o(e.distance,-25)),e.rotation==="auto"?d.attr({rotation:i}):k===null&&(k=f.chart.renderer.fontMetrics(d.styles.fontSize).b-d.getBBox().height/2),s===null&&(f.isCircular?(this.label.getBBox().width>f.len*f.tickInterval/(f.max-
f.min)&&(n=0),s=i>n&&i<180-n?"left":i>180+n&&i<360-n?"right":"center"):s="center",d.attr({align:s})),a.x+=e.x,a.y+=k):a=a.call(this,b,c,d,g,e,j,l,h);return a});w(z,"getMarkPath",function(a,b,c,d,g,e,j){var l=this.axis;l.isRadial?(a=l.getPosition(this.pos,l.center[2]/2+d),b=["M",b,c,"L",a.x,a.y]):b=a.call(this,b,c,d,g,e,j);return b});p.arearange=u(p.area,{lineWidth:1,marker:null,threshold:null,tooltip:{pointFormat:'<span style="color:{series.color}">\u25cf</span> {series.name}: <b>{point.low}</b> - <b>{point.high}</b><br/>'},
trackByArea:!0,dataLabels:{align:null,verticalAlign:null,xLow:0,xHigh:0,yLow:0,yHigh:0},states:{hover:{halo:!1}}});i.arearange=v(i.area,{type:"arearange",pointArrayMap:["low","high"],dataLabelCollections:["dataLabel","dataLabelUpper"],toYData:function(a){return[a.low,a.high]},pointValKey:"low",deferTranslatePolar:!0,highToXY:function(a){var b=this.chart,c=this.xAxis.postTranslate(a.rectPlotX,this.yAxis.len-a.plotHigh);a.plotHighX=c.x-b.plotLeft;a.plotHigh=c.y-b.plotTop},translate:function(){var a=
this,b=a.yAxis;i.area.prototype.translate.apply(a);t(a.points,function(a){var d=a.low,g=a.high,e=a.plotY;g===null||d===null?a.isNull=!0:(a.plotLow=e,a.plotHigh=b.translate(g,0,1,0,1))});this.chart.polar&&t(this.points,function(b){a.highToXY(b)})},getGraphPath:function(){var a=this.points,b=[],c=[],d=a.length,g=x.prototype.getGraphPath,e,j,l;l=this.options;for(var h=l.step,d=a.length;d--;)e=a[d],!e.isNull&&(!a[d+1]||a[d+1].isNull)&&c.push({plotX:e.plotX,plotY:e.plotLow}),j={plotX:e.plotX,plotY:e.plotHigh,
isNull:e.isNull},c.push(j),b.push(j),!e.isNull&&(!a[d-1]||a[d-1].isNull)&&c.push({plotX:e.plotX,plotY:e.plotLow});a=g.call(this,a);if(h)h===!0&&(h="left"),l.step={left:"right",center:"center",right:"left"}[h];b=g.call(this,b);c=g.call(this,c);l.step=h;l=[].concat(a,b);!this.chart.polar&&c[0]==="M"&&(c[0]="L");this.areaPath=this.areaPath.concat(a,c);return l},drawDataLabels:function(){var a=this.data,b=a.length,c,d=[],g=x.prototype,e=this.options.dataLabels,j=e.align,l=e.verticalAlign,h=e.inside,f,
k,n=this.chart.inverted;if(e.enabled||this._hasPointLabels){for(c=b;c--;)if(f=a[c]){k=h?f.plotHigh<f.plotLow:f.plotHigh>f.plotLow;f.y=f.high;f._plotY=f.plotY;f.plotY=f.plotHigh;d[c]=f.dataLabel;f.dataLabel=f.dataLabelUpper;f.below=k;if(n){if(!j)e.align=k?"right":"left"}else if(!l)e.verticalAlign=k?"top":"bottom";e.x=e.xHigh;e.y=e.yHigh}g.drawDataLabels&&g.drawDataLabels.apply(this,arguments);for(c=b;c--;)if(f=a[c]){k=h?f.plotHigh<f.plotLow:f.plotHigh>f.plotLow;f.dataLabelUpper=f.dataLabel;f.dataLabel=
d[c];f.y=f.low;f.plotY=f._plotY;f.below=!k;if(n){if(!j)e.align=k?"left":"right"}else if(!l)e.verticalAlign=k?"bottom":"top";e.x=e.xLow;e.y=e.yLow}g.drawDataLabels&&g.drawDataLabels.apply(this,arguments)}e.align=j;e.verticalAlign=l},alignDataLabel:function(){i.column.prototype.alignDataLabel.apply(this,arguments)},setStackedPoints:r,getSymbol:r,drawPoints:r});p.areasplinerange=u(p.arearange);i.areasplinerange=v(i.arearange,{type:"areasplinerange",getPointSpline:i.spline.prototype.getPointSpline});
(function(){var a=i.column.prototype;p.columnrange=u(p.column,p.arearange,{lineWidth:1,pointRange:null});i.columnrange=v(i.arearange,{type:"columnrange",translate:function(){var b=this,c=b.yAxis,d=b.xAxis,g=d.startAngleRad,e,j=b.chart,l=b.xAxis.isRadial,h;a.translate.apply(b);t(b.points,function(a){var k=a.shapeArgs,n=b.options.minPointLength,s,i;a.plotHigh=h=c.translate(a.high,0,1,0,1);a.plotLow=a.plotY;i=h;s=o(a.rectPlotY,a.plotY)-h;Math.abs(s)<n?(n-=s,s+=n,i-=n/2):s<0&&(s*=-1,i-=s);l?(e=a.barX+
g,a.shapeType="path",a.shapeArgs={d:b.polarArc(i+s,i,e,e+a.pointWidth)}):(k.height=s,k.y=i,a.tooltipPos=j.inverted?[c.len+c.pos-j.plotLeft-i-s/2,d.len+d.pos-j.plotTop-k.x-k.width/2,s]:[d.left-j.plotLeft+k.x+k.width/2,c.pos-j.plotTop+i+s/2,s])})},directTouch:!0,trackerGroups:["group","dataLabelsGroup"],drawGraph:r,crispCol:a.crispCol,pointAttrToOptions:a.pointAttrToOptions,drawPoints:a.drawPoints,drawTracker:a.drawTracker,getColumnMetrics:a.getColumnMetrics,animate:function(){return a.animate.apply(this,
arguments)},polarArc:function(){return a.polarArc.apply(this,arguments)}})})();p.gauge=u(p.line,{dataLabels:{enabled:!0,defer:!1,y:15,borderWidth:1,borderColor:"silver",borderRadius:3,crop:!1,verticalAlign:"top",zIndex:2},dial:{},pivot:{},tooltip:{headerFormat:""},showInLegend:!1});C={type:"gauge",pointClass:v(J,{setState:function(a){this.state=a}}),angular:!0,directTouch:!0,drawGraph:r,fixedBox:!0,forceDL:!0,trackerGroups:["group","dataLabelsGroup"],translate:function(){var a=this.yAxis,b=this.options,
c=a.center;this.generatePoints();t(this.points,function(d){var g=u(b.dial,d.dial),e=B(o(g.radius,80))*c[2]/200,j=B(o(g.baseLength,70))*e/100,l=B(o(g.rearLength,10))*e/100,h=g.baseWidth||3,f=g.topWidth||1,k=b.overshoot,n=a.startAngleRad+a.translate(d.y,null,null,null,!0);I(k)?(k=k/180*Math.PI,n=Math.max(a.startAngleRad-k,Math.min(a.endAngleRad+k,n))):b.wrap===!1&&(n=Math.max(a.startAngleRad,Math.min(a.endAngleRad,n)));n=n*180/Math.PI;d.shapeType="path";d.shapeArgs={d:g.path||["M",-l,-h/2,"L",j,-h/
2,e,-f/2,e,f/2,j,h/2,-l,h/2,"z"],translateX:c[0],translateY:c[1],rotation:n};d.plotX=c[0];d.plotY=c[1]})},drawPoints:function(){var a=this,b=a.yAxis.center,c=a.pivot,d=a.options,g=d.pivot,e=a.chart.renderer;t(a.points,function(b){var g=b.graphic,c=b.shapeArgs,f=c.d,k=u(d.dial,b.dial);g?(g.animate(c),c.d=f):b.graphic=e[b.shapeType](c).attr({stroke:k.borderColor||"none","stroke-width":k.borderWidth||0,fill:k.backgroundColor||"black",rotation:c.rotation,zIndex:1}).add(a.group)});c?c.animate({translateX:b[0],
translateY:b[1]}):a.pivot=e.circle(0,0,o(g.radius,5)).attr({"stroke-width":g.borderWidth||0,stroke:g.borderColor||"silver",fill:g.backgroundColor||"black",zIndex:2}).translate(b[0],b[1]).add(a.group)},animate:function(a){var b=this;if(!a)t(b.points,function(a){var d=a.graphic;d&&(d.attr({rotation:b.yAxis.startAngleRad*180/Math.PI}),d.animate({rotation:a.shapeArgs.rotation},b.options.animation))}),b.animate=null},render:function(){this.group=this.plotGroup("group","series",this.visible?"visible":"hidden",
this.options.zIndex,this.chart.seriesGroup);x.prototype.render.call(this);this.group.clip(this.chart.clipRect)},setData:function(a,b){x.prototype.setData.call(this,a,!1);this.processData();this.generatePoints();o(b,!0)&&this.chart.redraw()},drawTracker:C&&C.drawTrackerPoint};i.gauge=v(i.line,C);p.boxplot=u(p.column,{fillColor:"#FFFFFF",lineWidth:1,medianWidth:2,states:{hover:{brightness:-0.3}},threshold:null,tooltip:{pointFormat:'<span style="color:{point.color}">\u25cf</span> <b> {series.name}</b><br/>Maximum: {point.high}<br/>Upper quartile: {point.q3}<br/>Median: {point.median}<br/>Lower quartile: {point.q1}<br/>Minimum: {point.low}<br/>'},
whiskerLength:"50%",whiskerWidth:2});i.boxplot=v(i.column,{type:"boxplot",pointArrayMap:["low","q1","median","q3","high"],toYData:function(a){return[a.low,a.q1,a.median,a.q3,a.high]},pointValKey:"high",pointAttrToOptions:{fill:"fillColor",stroke:"color","stroke-width":"lineWidth"},drawDataLabels:r,translate:function(){var a=this.yAxis,b=this.pointArrayMap;i.column.prototype.translate.apply(this);t(this.points,function(c){t(b,function(b){c[b]!==null&&(c[b+"Plot"]=a.translate(c[b],0,1,0,1))})})},drawPoints:function(){var a=
this,b=a.options,c=a.chart.renderer,d,g,e,j,l,h,f,k,n,i,m,K,L,p,u,r,w,v,x,y,C,B,z=a.doQuartiles!==!1,A,E=a.options.whiskerLength;t(a.points,function(q){n=q.graphic;C=q.shapeArgs;m={};p={};r={};B=q.color||a.color;if(q.plotY!==void 0)if(d=q.pointAttr[q.selected?"selected":""],w=C.width,v=D(C.x),x=v+w,y=F(w/2),g=D(z?q.q1Plot:q.lowPlot),e=D(z?q.q3Plot:q.lowPlot),j=D(q.highPlot),l=D(q.lowPlot),m.stroke=q.stemColor||b.stemColor||B,m["stroke-width"]=o(q.stemWidth,b.stemWidth,b.lineWidth),m.dashstyle=q.stemDashStyle||
b.stemDashStyle,p.stroke=q.whiskerColor||b.whiskerColor||B,p["stroke-width"]=o(q.whiskerWidth,b.whiskerWidth,b.lineWidth),r.stroke=q.medianColor||b.medianColor||B,r["stroke-width"]=o(q.medianWidth,b.medianWidth,b.lineWidth),f=m["stroke-width"]%2/2,k=v+y+f,i=["M",k,e,"L",k,j,"M",k,g,"L",k,l],z&&(f=d["stroke-width"]%2/2,k=D(k)+f,g=D(g)+f,e=D(e)+f,v+=f,x+=f,K=["M",v,e,"L",v,g,"L",x,g,"L",x,e,"L",v,e,"z"]),E&&(f=p["stroke-width"]%2/2,j+=f,l+=f,A=/%$/.test(E)?y*parseFloat(E)/100:E/2,L=["M",k-A,j,"L",k+
A,j,"M",k-A,l,"L",k+A,l]),f=r["stroke-width"]%2/2,h=F(q.medianPlot)+f,u=["M",v,h,"L",x,h],n)q.stem.animate({d:i}),E&&q.whiskers.animate({d:L}),z&&q.box.animate({d:K}),q.medianShape.animate({d:u});else{q.graphic=n=c.g().add(a.group);q.stem=c.path(i).attr(m).add(n);if(E)q.whiskers=c.path(L).attr(p).add(n);if(z)q.box=c.path(K).attr(d).add(n);q.medianShape=c.path(u).attr(r).add(n)}})},setStackedPoints:r});p.errorbar=u(p.boxplot,{color:"#000000",grouping:!1,linkedTo:":previous",tooltip:{pointFormat:'<span style="color:{point.color}">\u25cf</span> {series.name}: <b>{point.low}</b> - <b>{point.high}</b><br/>'},
whiskerWidth:null});i.errorbar=v(i.boxplot,{type:"errorbar",pointArrayMap:["low","high"],toYData:function(a){return[a.low,a.high]},pointValKey:"high",doQuartiles:!1,drawDataLabels:i.arearange?i.arearange.prototype.drawDataLabels:r,getColumnMetrics:function(){return this.linkedParent&&this.linkedParent.columnMetrics||i.column.prototype.getColumnMetrics.call(this)}});p.waterfall=u(p.column,{lineWidth:1,lineColor:"#333",dashStyle:"dot",borderColor:"#333",dataLabels:{inside:!0},states:{hover:{lineWidthPlus:0}}});
i.waterfall=v(i.column,{type:"waterfall",upColorProp:"fill",pointValKey:"y",translate:function(){var a=this.options,b=this.yAxis,c,d,g,e,j,l,h,f,k,n=o(a.minPointLength,5),s=a.threshold,m=a.stacking;i.column.prototype.translate.apply(this);this.minPointLengthOffset=0;h=f=s;d=this.points;for(c=0,a=d.length;c<a;c++){g=d[c];l=this.processedYData[c];e=g.shapeArgs;k=(j=m&&b.stacks[(this.negStacks&&l<s?"-":"")+this.stackKey])?j[g.x].points[this.index+","+c]:[0,l];if(g.isSum)g.y=G(l);else if(g.isIntermediateSum)g.y=
G(l-f);j=P(h,h+g.y)+k[0];e.y=b.translate(j,0,1);if(g.isSum)e.y=b.translate(k[1],0,1),e.height=Math.min(b.translate(k[0],0,1),b.len)-e.y+this.minPointLengthOffset;else if(g.isIntermediateSum)e.y=b.translate(k[1],0,1),e.height=Math.min(b.translate(f,0,1),b.len)-e.y+this.minPointLengthOffset,f=k[1];else{if(h!==0)e.height=l>0?b.translate(h,0,1)-e.y:b.translate(h,0,1)-b.translate(h-l,0,1);h+=l}e.height<0&&(e.y+=e.height,e.height*=-1);g.plotY=e.y=F(e.y)-this.borderWidth%2/2;e.height=P(F(e.height),0.001);
g.yBottom=e.y+e.height;if(e.height<=n)e.height=n,this.minPointLengthOffset+=n;e.y-=this.minPointLengthOffset;e=g.plotY+(g.negative?e.height:0)-this.minPointLengthOffset;this.chart.inverted?g.tooltipPos[0]=b.len-e:g.tooltipPos[1]=e}},processData:function(a){var b=this.yData,c=this.options.data,d,g=b.length,e,j,l,h,f,k;j=e=l=h=this.options.threshold||0;for(k=0;k<g;k++)f=b[k],d=c&&c[k]?c[k]:{},f==="sum"||d.isSum?b[k]=G(j):f==="intermediateSum"||d.isIntermediateSum?b[k]=G(e):(j+=f,e+=f),l=Math.min(j,
l),h=Math.max(j,h);x.prototype.processData.call(this,a);this.dataMin=l;this.dataMax=h},toYData:function(a){return a.isSum?a.x===0?null:"sum":a.isIntermediateSum?a.x===0?null:"intermediateSum":a.y},getAttribs:function(){i.column.prototype.getAttribs.apply(this,arguments);var a=this,b=a.options,c=b.states,d=b.upColor||a.color,b=m.Color(d).brighten(0.1).get(),g=u(a.pointAttr),e=a.upColorProp;g[""][e]=d;g.hover[e]=c.hover.upColor||b;g.select[e]=c.select.upColor||d;t(a.points,function(e){if(!e.options.color)e.y>
0?(e.pointAttr=g,e.color=d):e.pointAttr=a.pointAttr})},getGraphPath:function(){var a=this.data,b=a.length,c=F(this.options.lineWidth+this.borderWidth)%2/2,d=[],g,e,j;for(j=1;j<b;j++)e=a[j].shapeArgs,g=a[j-1].shapeArgs,e=["M",g.x+g.width,g.y+c,"L",e.x,g.y+c],a[j-1].y<0&&(e[2]+=g.height,e[5]+=g.height),d=d.concat(e);return d},getExtremes:r,drawGraph:x.prototype.drawGraph});p.polygon=u(p.scatter,{marker:{enabled:!1}});i.polygon=v(i.scatter,{type:"polygon",fillGraph:!0,getSegmentPath:function(a){return x.prototype.getSegmentPath.call(this,
a).concat("z")},drawGraph:x.prototype.drawGraph,drawLegendSymbol:m.LegendSymbolMixin.drawRectangle});p.bubble=u(p.scatter,{dataLabels:{formatter:function(){return this.point.z},inside:!0,verticalAlign:"middle"},marker:{lineColor:null,lineWidth:1},minSize:8,maxSize:"20%",softThreshold:!1,states:{hover:{halo:{size:5}}},tooltip:{pointFormat:"({point.x}, {point.y}), Size: {point.z}"},turboThreshold:0,zThreshold:0,zoneAxis:"z"});C=v(J,{haloPath:function(){return J.prototype.haloPath.call(this,this.shapeArgs.r+
this.series.options.states.hover.halo.size)},ttBelow:!1});i.bubble=v(i.scatter,{type:"bubble",pointClass:C,pointArrayMap:["y","z"],parallelArrays:["x","y","z"],trackerGroups:["group","dataLabelsGroup"],bubblePadding:!0,zoneAxis:"z",pointAttrToOptions:{stroke:"lineColor","stroke-width":"lineWidth",fill:"fillColor"},applyOpacity:function(a){var b=this.options.marker,c=o(b.fillOpacity,0.5),a=a||b.fillColor||this.color;c!==1&&(a=W(a).setOpacity(c).get("rgba"));return a},convertAttribs:function(){var a=
x.prototype.convertAttribs.apply(this,arguments);a.fill=this.applyOpacity(a.fill);return a},getRadii:function(a,b,c,d){var g,e,j,l=this.zData,h=[],f=this.options,k=f.sizeBy!=="width",n=f.zThreshold,i=b-a;for(e=0,g=l.length;e<g;e++)j=l[e],f.sizeByAbsoluteValue&&j!==null&&(j=Math.abs(j-n),b=Math.max(b-n,Math.abs(a-n)),a=0),j===null?j=null:j<a?j=c/2-1:(j=i>0?(j-a)/i:0.5,k&&j>=0&&(j=Math.sqrt(j)),j=y.ceil(c+j*(d-c))/2),h.push(j);this.radii=h},animate:function(a){var b=this.options.animation;if(!a)t(this.points,
function(a){var d=a.graphic,a=a.shapeArgs;d&&a&&(d.attr("r",1),d.animate({r:a.r},b))}),this.animate=null},translate:function(){var a,b=this.data,c,d,g=this.radii;i.scatter.prototype.translate.call(this);for(a=b.length;a--;)c=b[a],d=g?g[a]:0,I(d)&&d>=this.minPxSize/2?(c.shapeType="circle",c.shapeArgs={x:c.plotX,y:c.plotY,r:d},c.dlBox={x:c.plotX-d,y:c.plotY-d,width:2*d,height:2*d}):c.shapeArgs=c.plotY=c.dlBox=void 0},drawLegendSymbol:function(a,b){var c=this.chart.renderer,d=c.fontMetrics(a.itemStyle.fontSize).f/
2;b.legendSymbol=c.circle(d,a.baseline-d,d).attr({zIndex:3}).add(b.legendGroup);b.legendSymbol.isMarker=!0},drawPoints:i.column.prototype.drawPoints,alignDataLabel:i.column.prototype.alignDataLabel,buildKDTree:r,applyZones:r});O.prototype.beforePadding=function(){var a=this,b=this.len,c=this.chart,d=0,g=b,e=this.isXAxis,j=e?"xData":"yData",l=this.min,h={},f=y.min(c.plotWidth,c.plotHeight),k=Number.MAX_VALUE,n=-Number.MAX_VALUE,i=this.max-l,m=b/i,p=[];t(this.series,function(b){var g=b.options;if(b.bubblePadding&&
(b.visible||!c.options.chart.ignoreHiddenSeries))if(a.allowZoomOutside=!0,p.push(b),e)t(["minSize","maxSize"],function(a){var b=g[a],e=/%$/.test(b),b=B(b);h[a]=e?f*b/100:b}),b.minPxSize=h.minSize,b.maxPxSize=h.maxSize,b=b.zData,b.length&&(k=o(g.zMin,y.min(k,y.max(R(b),g.displayNegative===!1?g.zThreshold:-Number.MAX_VALUE))),n=o(g.zMax,y.max(n,S(b))))});t(p,function(b){var c=b[j],f=c.length,h;e&&b.getRadii(k,n,b.minPxSize,b.maxPxSize);if(i>0)for(;f--;)I(c[f])&&a.dataMin<=c[f]&&c[f]<=a.dataMax&&(h=
b.radii[f],d=Math.min((c[f]-l)*m-h,d),g=Math.max((c[f]-l)*m+h,g))});p.length&&i>0&&!this.isLog&&(g-=b,m*=(b+d-g)/b,t([["min","userMin",d],["max","userMax",g]],function(b){o(a.options[b[0]],a[b[1]])===void 0&&(a[b[0]]+=b[2]/m)}))};(function(){function a(a,b){var c=this.chart,d=this.options.animation,h=this.group,f=this.markerGroup,k=this.xAxis.center,i=c.plotLeft,m=c.plotTop;if(c.polar){if(c.renderer.isSVG)d===!0&&(d={}),b?(c={translateX:k[0]+i,translateY:k[1]+m,scaleX:0.001,scaleY:0.001},h.attr(c),
f&&f.attr(c)):(c={translateX:i,translateY:m,scaleX:1,scaleY:1},h.animate(c,d),f&&f.animate(c,d),this.animate=null)}else a.call(this,b)}var b=x.prototype,c=U.prototype,d;b.searchPointByAngle=function(a){var b=this.chart,c=this.xAxis.pane.center;return this.searchKDTree({clientX:180+Math.atan2(a.chartX-c[0]-b.plotLeft,a.chartY-c[1]-b.plotTop)*(-180/Math.PI)})};w(b,"buildKDTree",function(a){if(this.chart.polar)this.kdByAngle?this.searchPoint=this.searchPointByAngle:this.kdDimensions=2;a.apply(this)});
b.toXY=function(a){var b,c=this.chart,d=a.plotX;b=a.plotY;a.rectPlotX=d;a.rectPlotY=b;b=this.xAxis.postTranslate(a.plotX,this.yAxis.len-b);a.plotX=a.polarPlotX=b.x-c.plotLeft;a.plotY=a.polarPlotY=b.y-c.plotTop;this.kdByAngle?(c=(d/Math.PI*180+this.xAxis.pane.options.startAngle)%360,c<0&&(c+=360),a.clientX=c):a.clientX=a.plotX};i.spline&&w(i.spline.prototype,"getPointSpline",function(a,b,c,d){var h,f,k,i,m,p,o;if(this.chart.polar){h=c.plotX;f=c.plotY;a=b[d-1];k=b[d+1];this.connectEnds&&(a||(a=b[b.length-
2]),k||(k=b[1]));if(a&&k)i=a.plotX,m=a.plotY,b=k.plotX,p=k.plotY,i=(1.5*h+i)/2.5,m=(1.5*f+m)/2.5,k=(1.5*h+b)/2.5,o=(1.5*f+p)/2.5,b=Math.sqrt(Math.pow(i-h,2)+Math.pow(m-f,2)),p=Math.sqrt(Math.pow(k-h,2)+Math.pow(o-f,2)),i=Math.atan2(m-f,i-h),m=Math.atan2(o-f,k-h),o=Math.PI/2+(i+m)/2,Math.abs(i-o)>Math.PI/2&&(o-=Math.PI),i=h+Math.cos(o)*b,m=f+Math.sin(o)*b,k=h+Math.cos(Math.PI+o)*p,o=f+Math.sin(Math.PI+o)*p,c.rightContX=k,c.rightContY=o;d?(c=["C",a.rightContX||a.plotX,a.rightContY||a.plotY,i||h,m||
f,h,f],a.rightContX=a.rightContY=null):c=["M",h,f]}else c=a.call(this,b,c,d);return c});w(b,"translate",function(a){var b=this.chart;a.call(this);if(b.polar&&(this.kdByAngle=b.tooltip&&b.tooltip.shared,!this.preventPostTranslate)){a=this.points;for(b=a.length;b--;)this.toXY(a[b])}});w(b,"getGraphPath",function(a,b){var c=this;if(this.chart.polar){b=b||this.points;if(this.options.connectEnds!==!1&&b[0]&&b[0].y!==null)this.connectEnds=!0,b.splice(b.length,0,b[0]);t(b,function(a){a.polarPlotY===void 0&&
c.toXY(a)})}return a.apply(this,[].slice.call(arguments,1))});w(b,"animate",a);if(i.column)d=i.column.prototype,d.polarArc=function(a,b,c,d){var h=this.xAxis.center,f=this.yAxis.len;return this.chart.renderer.symbols.arc(h[0],h[1],f-b,null,{start:c,end:d,innerR:f-o(a,f)})},w(d,"animate",a),w(d,"translate",function(a){var b=this.xAxis,c=b.startAngleRad,d,h,f;this.preventPostTranslate=!0;a.call(this);if(b.isRadial){d=this.points;for(f=d.length;f--;)h=d[f],a=h.barX+c,h.shapeType="path",h.shapeArgs={d:this.polarArc(h.yBottom,
h.plotY,a,a+h.pointWidth)},this.toXY(h),h.tooltipPos=[h.plotX,h.plotY],h.ttBelow=h.plotY>b.center[1]}}),w(d,"alignDataLabel",function(a,c,d,i,h,f){if(this.chart.polar){a=c.rectPlotX/Math.PI*180;if(i.align===null)i.align=a>20&&a<160?"left":a>200&&a<340?"right":"center";if(i.verticalAlign===null)i.verticalAlign=a<45||a>315?"bottom":a>135&&a<225?"top":"middle";b.alignDataLabel.call(this,c,d,i,h,f)}else a.call(this,c,d,i,h,f)});w(c,"getCoordinates",function(a,b){var c=this.chart,d={xAxis:[],yAxis:[]};
c.polar?t(c.axes,function(a){var f=a.isXAxis,g=a.center,i=b.chartX-g[0]-c.plotLeft,g=b.chartY-g[1]-c.plotTop;d[f?"xAxis":"yAxis"].push({axis:a,value:a.translate(f?Math.PI-Math.atan2(i,g):Math.sqrt(Math.pow(i,2)+Math.pow(g,2)),!0)})}):d=a.call(this,b);return d})})()});

},{}],2:[function(require,module,exports){
/*
 Highstock JS v4.2.5 (2016-05-06)

 (c) 2009-2016 Torstein Honsi

 License: www.highcharts.com/license
*/
(function(L,ga){typeof module==="object"&&module.exports?module.exports=L.document?ga(L):ga:L.Highcharts=ga(L)})(typeof window!=="undefined"?window:this,function(L){function ga(a,b){var c="Highcharts error #"+a+": www.highcharts.com/errors/"+a;if(b)throw Error(c);L.console&&console.log(c)}function xb(a,b,c){this.options=b;this.elem=a;this.prop=c}function z(){var a,b=arguments,c,d={},e=function(a,b){var c,d;typeof a!=="object"&&(a={});for(d in b)b.hasOwnProperty(d)&&(c=b[d],a[d]=c&&typeof c==="object"&&
Object.prototype.toString.call(c)!=="[object Array]"&&d!=="renderTo"&&typeof c.nodeType!=="number"?e(a[d]||{},c):b[d]);return a};b[0]===!0&&(d=b[1],b=Array.prototype.slice.call(b,2));c=b.length;for(a=0;a<c;a++)d=e(d,b[a]);return d}function K(a,b){return parseInt(a,b||10)}function Ca(a){return typeof a==="string"}function ea(a){return a&&typeof a==="object"}function Ja(a){return Object.prototype.toString.call(a)==="[object Array]"}function za(a,b){for(var c=a.length;c--;)if(a[c]===b){a.splice(c,1);
break}}function v(a){return a!==t&&a!==null}function X(a,b,c){var d,e;if(Ca(b))v(c)?a.setAttribute(b,c):a&&a.getAttribute&&(e=a.getAttribute(b));else if(v(b)&&ea(b))for(d in b)a.setAttribute(d,b[d]);return e}function ua(a){return Ja(a)?a:[a]}function Za(a,b,c){if(b)return setTimeout(a,b,c);a.call(0,c)}function N(a,b){if(Ka&&!ja&&b&&b.opacity!==t)b.filter="alpha(opacity="+b.opacity*100+")";A(a.style,b)}function fa(a,b,c,d,e){a=H.createElement(a);b&&A(a,b);e&&N(a,{padding:0,border:"none",margin:0});
c&&N(a,c);d&&d.appendChild(a);return a}function ma(a,b){var c=function(){};c.prototype=new a;A(c.prototype,b);return c}function Oa(a,b,c){return Array((b||2)+1-String(a).length).join(c||0)+a}function eb(a){return(fb&&fb(a)||yb||0)*6E4}function La(a,b){for(var c="{",d=!1,e,f,g,h,i,j=[];(c=a.indexOf(c))!==-1;){e=a.slice(0,c);if(d){f=e.split(":");g=f.shift().split(".");i=g.length;e=b;for(h=0;h<i;h++)e=e[g[h]];if(f.length)f=f.join(":"),g=/\.([0-9])/,h=R.lang,i=void 0,/f$/.test(f)?(i=(i=f.match(g))?i[1]:
-1,e!==null&&(e=B.numberFormat(e,i,h.decimalPoint,f.indexOf(",")>-1?h.thousandsSep:""))):e=na(f,e)}j.push(e);a=a.slice(c+1);c=(d=!d)?"}":"{"}j.push(a);return j.join("")}function zb(a){return Y.pow(10,V(Y.log(a)/Y.LN10))}function Ab(a,b,c,d,e){var f,g=a,c=q(c,1);f=a/c;b||(b=[1,2,2.5,5,10],d===!1&&(c===1?b=[1,2,5,10]:c<=0.1&&(b=[1/c])));for(d=0;d<b.length;d++)if(g=b[d],e&&g*c>=a||!e&&f<=(b[d]+(b[d+1]||b[d]))/2)break;g*=c;return g}function nb(a,b){var c=a.length,d,e;for(e=0;e<c;e++)a[e].safeI=e;a.sort(function(a,
c){d=b(a,c);return d===0?a.safeI-c.safeI:d});for(e=0;e<c;e++)delete a[e].safeI}function Ma(a){for(var b=a.length,c=a[0];b--;)a[b]<c&&(c=a[b]);return c}function Da(a){for(var b=a.length,c=a[0];b--;)a[b]>c&&(c=a[b]);return c}function Pa(a,b){for(var c in a)a[c]&&a[c]!==b&&a[c].destroy&&a[c].destroy(),delete a[c]}function Ua(a){ob||(ob=fa(Va));a&&ob.appendChild(a);ob.innerHTML=""}function ka(a,b){return parseFloat(a.toPrecision(b||14))}function $a(a,b){b.renderer.globalAnimation=q(a,b.animation)}function gb(a){return ea(a)?
z(a):{duration:a?500:0}}function Ob(){var a=R.global,b=a.useUTC,c=b?"getUTC":"get",d=b?"setUTC":"set";ba=a.Date||L.Date;yb=b&&a.timezoneOffset;fb=b&&a.getTimezoneOffset;pb=function(a,c,d,h,i,j){var k;b?(k=ba.UTC.apply(0,arguments),k+=eb(k)):k=(new ba(a,c,q(d,1),q(h,0),q(i,0),q(j,0))).getTime();return k};Bb=c+"Minutes";Cb=c+"Hours";Db=c+"Day";ab=c+"Date";hb=c+"Month";ib=c+"FullYear";Pb=d+"Milliseconds";Qb=d+"Seconds";Rb=d+"Minutes";Sb=d+"Hours";qb=d+"Date";Eb=d+"Month";Fb=d+"FullYear"}function va(a){if(!(this instanceof
va))return new va(a);this.init(a)}function Z(){}function bb(a,b,c,d){this.axis=a;this.pos=b;this.type=c||"";this.isNew=!0;!c&&!d&&this.addLabel()}function Tb(a,b,c,d,e){var f=a.chart.inverted;this.axis=a;this.isNegative=c;this.options=b;this.x=d;this.total=null;this.points={};this.stack=e;this.rightCliff=this.leftCliff=0;this.alignOptions={align:b.align||(f?c?"left":"right":"center"),verticalAlign:b.verticalAlign||(f?"middle":c?"bottom":"top"),y:q(b.y,f?4:c?14:-6),x:q(b.x,f?c?-6:6:0)};this.textAlign=
b.textAlign||(f?c?"right":"left":"center")}function Gb(a){var b=a.options,c=b.navigator,d=c.enabled,b=b.scrollbar,e=b.enabled,f=d?c.height:0,g=e?b.height:0;this.handles=[];this.scrollbarButtons=[];this.elementsToDestroy=[];this.chart=a;this.setBaseSeries();this.height=f;this.scrollbarHeight=g;this.scrollbarEnabled=e;this.navigatorEnabled=d;this.navigatorOptions=c;this.scrollbarOptions=b;this.outlineHeight=f+g;this.init()}function Hb(a){this.init(a)}var t,H=L.document,Y=Math,y=Y.round,V=Y.floor,Ea=
Y.ceil,w=Y.max,G=Y.min,S=Y.abs,ca=Y.cos,la=Y.sin,Aa=Y.PI,pa=Aa*2/360,Na=L.navigator&&L.navigator.userAgent||"",Ub=L.opera,Ka=/(msie|trident|edge)/i.test(Na)&&!Ub,rb=H&&H.documentMode===8,sb=!Ka&&/AppleWebKit/.test(Na),Wa=/Firefox/.test(Na),jb=/(Mobile|Android|Windows Phone)/.test(Na),Qa="http://www.w3.org/2000/svg",ja=H&&H.createElementNS&&!!H.createElementNS(Qa,"svg").createSVGRect,Zb=Wa&&parseInt(Na.split("Firefox/")[1],10)<4,qa=H&&!ja&&!Ka&&!!H.createElement("canvas").getContext,Xa,cb,Vb={},Ib=
0,ob,R,na,M,ra=function(){},$=[],kb=0,Va="div",$b=/^[0-9]+$/,tb=["plotTop","marginRight","marginBottom","plotLeft"],ba,pb,yb,fb,Bb,Cb,Db,ab,hb,ib,Pb,Qb,Rb,Sb,qb,Eb,Fb,I={},B;B=L.Highcharts?ga(16,!0):{win:L};B.seriesTypes=I;var Ra=[],wa,sa,o,Fa,Jb,ta,E,T,O,db,Sa;xb.prototype={dSetter:function(){var a=this.paths[0],b=this.paths[1],c=[],d=this.now,e=a.length,f;if(d===1)c=this.toD;else if(e===b.length&&d<1)for(;e--;)f=parseFloat(a[e]),c[e]=isNaN(f)?a[e]:d*parseFloat(b[e]-f)+f;else c=b;this.elem.attr("d",
c)},update:function(){var a=this.elem,b=this.prop,c=this.now,d=this.options.step;if(this[b+"Setter"])this[b+"Setter"]();else a.attr?a.element&&a.attr(b,c):a.style[b]=c+this.unit;d&&d.call(a,c,this)},run:function(a,b,c){var d=this,e=function(a){return e.stopped?!1:d.step(a)},f;this.startTime=+new ba;this.start=a;this.end=b;this.unit=c;this.now=this.start;this.pos=0;e.elem=this.elem;if(e()&&Ra.push(e)===1)e.timerId=setInterval(function(){for(f=0;f<Ra.length;f++)Ra[f]()||Ra.splice(f--,1);Ra.length||
clearInterval(e.timerId)},13)},step:function(a){var b=+new ba,c,d=this.options;c=this.elem;var e=d.complete,f=d.duration,g=d.curAnim,h;if(c.attr&&!c.element)c=!1;else if(a||b>=f+this.startTime){this.now=this.end;this.pos=1;this.update();a=g[this.prop]=!0;for(h in g)g[h]!==!0&&(a=!1);a&&e&&e.call(c);c=!1}else this.pos=d.easing((b-this.startTime)/f),this.now=this.start+(this.end-this.start)*this.pos,this.update(),c=!0;return c},initPath:function(a,b,c){var b=b||"",d=a.shift,e=b.indexOf("C")>-1,f=e?
7:3,g,b=b.split(" "),c=[].concat(c),h=a.isArea,i=h?2:1,j=function(a){for(g=a.length;g--;)(a[g]==="M"||a[g]==="L")&&a.splice(g+1,0,a[g+1],a[g+2],a[g+1],a[g+2])};e&&(j(b),j(c));if(d<=c.length/f&&b.length===c.length)for(;d--;)c=c.slice(0,f).concat(c),h&&(c=c.concat(c.slice(c.length-f)));a.shift=0;if(b.length)for(a=c.length;b.length<a;)d=b.slice().splice(b.length/i-f,f*i),e&&(d[f-6]=d[f-2],d[f-5]=d[f-1]),[].splice.apply(b,[b.length/i,0].concat(d));return[b,c]}};var A=B.extend=function(a,b){var c;a||(a=
{});for(c in b)a[c]=b[c];return a},C=B.isNumber=function(a){return typeof a==="number"&&!isNaN(a)},q=B.pick=function(){var a=arguments,b,c,d=a.length;for(b=0;b<d;b++)if(c=a[b],c!==t&&c!==null)return c},U=B.wrap=function(a,b,c){var d=a[b];a[b]=function(){var a=Array.prototype.slice.call(arguments);a.unshift(d);return c.apply(this,a)}};na=function(a,b,c){if(!C(b))return R.lang.invalidDate||"";var a=q(a,"%Y-%m-%d %H:%M:%S"),d=new ba(b-eb(b)),e,f=d[Cb](),g=d[Db](),h=d[ab](),i=d[hb](),j=d[ib](),k=R.lang,
l=k.weekdays,m=k.shortWeekdays,d=A({a:m?m[g]:l[g].substr(0,3),A:l[g],d:Oa(h),e:Oa(h,2," "),w:g,b:k.shortMonths[i],B:k.months[i],m:Oa(i+1),y:j.toString().substr(2,2),Y:j,H:Oa(f),k:f,I:Oa(f%12||12),l:f%12||12,M:Oa(d[Bb]()),p:f<12?"AM":"PM",P:f<12?"am":"pm",S:Oa(d.getSeconds()),L:Oa(y(b%1E3),3)},B.dateFormats);for(e in d)for(;a.indexOf("%"+e)!==-1;)a=a.replace("%"+e,typeof d[e]==="function"?d[e](b):d[e]);return c?a.substr(0,1).toUpperCase()+a.substr(1):a};M={millisecond:1,second:1E3,minute:6E4,hour:36E5,
day:864E5,week:6048E5,month:24192E5,year:314496E5};B.numberFormat=function(a,b,c,d){var a=+a||0,b=+b,e=R.lang,f=(a.toString().split(".")[1]||"").length,g,h,i=Math.abs(a);b===-1?b=Math.min(f,20):C(b)||(b=2);g=String(K(i.toFixed(b)));h=g.length>3?g.length%3:0;c=q(c,e.decimalPoint);d=q(d,e.thousandsSep);a=a<0?"-":"";a+=h?g.substr(0,h)+d:"";a+=g.substr(h).replace(/(\d{3})(?=\d)/g,"$1"+d);b&&(d=Math.abs(i-g+Math.pow(10,-Math.max(b,f)-1)),a+=c+d.toFixed(b).slice(2));return a};Math.easeInOutSine=function(a){return-0.5*
(Math.cos(Math.PI*a)-1)};wa=function(a,b){var c;if(b==="width")return Math.min(a.offsetWidth,a.scrollWidth)-wa(a,"padding-left")-wa(a,"padding-right");else if(b==="height")return Math.min(a.offsetHeight,a.scrollHeight)-wa(a,"padding-top")-wa(a,"padding-bottom");return(c=L.getComputedStyle(a,void 0))&&K(c.getPropertyValue(b))};sa=function(a,b){return b.indexOf?b.indexOf(a):[].indexOf.call(b,a)};Fa=function(a,b){return[].filter.call(a,b)};ta=function(a,b){for(var c=[],d=0,e=a.length;d<e;d++)c[d]=b.call(a[d],
a[d],d,a);return c};Jb=function(a){var b=H.documentElement,a=a.getBoundingClientRect();return{top:a.top+(L.pageYOffset||b.scrollTop)-(b.clientTop||0),left:a.left+(L.pageXOffset||b.scrollLeft)-(b.clientLeft||0)}};Sa=function(a){for(var b=Ra.length;b--;)if(Ra[b].elem===a)Ra[b].stopped=!0};o=function(a,b){return Array.prototype.forEach.call(a,b)};E=function(a,b,c){function d(b){b.target=b.srcElement||L;c.call(a,b)}var e=a.hcEvents=a.hcEvents||{};if(a.addEventListener)a.addEventListener(b,c,!1);else if(a.attachEvent){if(!a.hcEventsIE)a.hcEventsIE=
{};a.hcEventsIE[c.toString()]=d;a.attachEvent("on"+b,d)}e[b]||(e[b]=[]);e[b].push(c)};T=function(a,b,c){function d(b,c){a.removeEventListener?a.removeEventListener(b,c,!1):a.attachEvent&&(c=a.hcEventsIE[c.toString()],a.detachEvent("on"+b,c))}function e(){var c,e,f;if(a.nodeName)for(f in b?(c={},c[b]=!0):c=g,c)if(g[f])for(e=g[f].length;e--;)d(f,g[f][e])}var f,g=a.hcEvents,h;if(g)b?(f=g[b]||[],c?(h=sa(c,f),h>-1&&(f.splice(h,1),g[b]=f),d(b,c)):(e(),g[b]=[])):(e(),a.hcEvents={})};O=function(a,b,c,d){var e;
e=a.hcEvents;var f,g,c=c||{};if(H.createEvent&&(a.dispatchEvent||a.fireEvent))e=H.createEvent("Events"),e.initEvent(b,!0,!0),e.target=a,A(e,c),a.dispatchEvent?a.dispatchEvent(e):a.fireEvent(b,e);else if(e){e=e[b]||[];f=e.length;if(!c.preventDefault)c.preventDefault=function(){c.defaultPrevented=!0};c.target=a;if(!c.type)c.type=b;for(b=0;b<f;b++)g=e[b],g.call(a,c)===!1&&c.preventDefault()}d&&!c.defaultPrevented&&d(c)};db=function(a,b,c){var d,e="",f,g,h;ea(c)||(d=arguments,c={duration:d[2],easing:d[3],
complete:d[4]});if(!C(c.duration))c.duration=400;c.easing=typeof c.easing==="function"?c.easing:Math[c.easing]||Math.easeInOutSine;c.curAnim=z(b);for(h in b)g=new xb(a,c,h),f=null,h==="d"?(g.paths=g.initPath(a,a.d,b.d),g.toD=b.d,d=0,f=1):a.attr?d=a.attr(h):(d=parseFloat(wa(a,h))||0,h!=="opacity"&&(e="px")),f||(f=b[h]),f.match&&f.match("px")&&(f=f.replace(/px/g,"")),g.run(d,f,e)};if(L.jQuery)L.jQuery.fn.highcharts=function(){var a=[].slice.call(arguments);if(this[0])return a[0]?(new (B[Ca(a[0])?a.shift():
"Chart"])(this[0],a[0],a[1]),this):$[X(this[0],"data-highcharts-chart")]};H&&!H.defaultView&&(wa=function(a,b){var c;c={width:"clientWidth",height:"clientHeight"}[b];if(a.style[b])return K(a.style[b]);b==="opacity"&&(b="filter");if(c)return a.style.zoom=1,Math.max(a[c]-2*wa(a,"padding"),0);c=a.currentStyle[b.replace(/\-(\w)/g,function(a,b){return b.toUpperCase()})];b==="filter"&&(c=c.replace(/alpha\(opacity=([0-9]+)\)/,function(a,b){return b/100}));return c===""?1:K(c)});Array.prototype.forEach||
(o=function(a,b){for(var c=0,d=a.length;c<d;c++)if(b.call(a[c],a[c],c,a)===!1)return c});Array.prototype.indexOf||(sa=function(a,b){var c,d=0;if(b)for(c=b.length;d<c;d++)if(b[d]===a)return d;return-1});Array.prototype.filter||(Fa=function(a,b){for(var c=[],d=0,e=a.length;d<e;d++)b(a[d],d)&&c.push(a[d]);return c});B.Fx=xb;B.inArray=sa;B.each=o;B.grep=Fa;B.offset=Jb;B.map=ta;B.addEvent=E;B.removeEvent=T;B.fireEvent=O;B.animate=db;B.animObject=gb;B.stop=Sa;R={colors:"#7cb5ec,#434348,#90ed7d,#f7a35c,#8085e9,#f15c80,#e4d354,#2b908f,#f45b5b,#91e8e1".split(","),
symbols:["circle","diamond","square","triangle","triangle-down"],lang:{loading:"Loading...",months:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),shortMonths:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),weekdays:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),decimalPoint:".",numericSymbols:"k,M,G,T,P,E".split(","),resetZoom:"Reset zoom",resetZoomTitle:"Reset zoom level 1:1",thousandsSep:" "},global:{useUTC:!0,
canvasToolsURL:"http://code.highcharts.com/modules/canvas-tools.js",VMLRadialGradientURL:"http://code.highcharts.com/stock/4.2.5/gfx/vml-radial-gradient.png"},chart:{borderColor:"#4572A7",borderRadius:0,defaultSeriesType:"line",ignoreHiddenSeries:!0,spacing:[10,10,15,10],backgroundColor:"#FFFFFF",plotBorderColor:"#C0C0C0",resetZoomButton:{theme:{zIndex:20},position:{align:"right",x:-10,y:10}}},title:{text:"Chart title",align:"center",margin:15,style:{color:"#333333",fontSize:"18px"},widthAdjust:-44},
subtitle:{text:"",align:"center",style:{color:"#555555"},widthAdjust:-44},plotOptions:{line:{allowPointSelect:!1,showCheckbox:!1,animation:{duration:1E3},events:{},lineWidth:2,marker:{lineWidth:0,radius:4,lineColor:"#FFFFFF",states:{hover:{enabled:!0,lineWidthPlus:1,radiusPlus:2},select:{fillColor:"#FFFFFF",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:{align:"center",formatter:function(){return this.y===null?"":B.numberFormat(this.y,-1)},style:{color:"contrast",fontSize:"11px",
fontWeight:"bold",textShadow:"0 0 6px contrast, 0 0 3px contrast"},verticalAlign:"bottom",x:0,y:0,padding:5},cropThreshold:300,pointRange:0,softThreshold:!0,states:{hover:{lineWidthPlus:1,marker:{},halo:{size:10,opacity:0.25}},select:{marker:{}}},stickyTracking:!0,turboThreshold:1E3}},labels:{style:{position:"absolute",color:"#3E576F"}},legend:{enabled:!0,align:"center",layout:"horizontal",labelFormatter:function(){return this.name},borderColor:"#909090",borderRadius:0,navigation:{activeColor:"#274b6d",
inactiveColor:"#CCC"},shadow:!1,itemStyle:{color:"#333333",fontSize:"12px",fontWeight:"bold"},itemHoverStyle:{color:"#000"},itemHiddenStyle:{color:"#CCC"},itemCheckboxStyle:{position:"absolute",width:"13px",height:"13px"},symbolPadding:5,verticalAlign:"bottom",x:0,y:0,title:{style:{fontWeight:"bold"}}},loading:{labelStyle:{fontWeight:"bold",position:"relative",top:"45%"},style:{position:"absolute",backgroundColor:"white",opacity:0.5,textAlign:"center"}},tooltip:{enabled:!0,animation:ja,backgroundColor:"rgba(249, 249, 249, .85)",
borderWidth:1,borderRadius:3,dateTimeLabelFormats:{millisecond:"%A, %b %e, %H:%M:%S.%L",second:"%A, %b %e, %H:%M:%S",minute:"%A, %b %e, %H:%M",hour:"%A, %b %e, %H:%M",day:"%A, %b %e, %Y",week:"Week from %A, %b %e, %Y",month:"%B %Y",year:"%Y"},footerFormat:"",headerFormat:'<span style="font-size: 10px">{point.key}</span><br/>',pointFormat:'<span style="color:{point.color}">\u25cf</span> {series.name}: <b>{point.y}</b><br/>',shadow:!0,snap:jb?25:10,style:{color:"#333333",cursor:"default",fontSize:"12px",
padding:"8px",pointerEvents:"none",whiteSpace:"nowrap"}},credits:{enabled:!0,text:"Highcharts.com",href:"http://www.highcharts.com",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#909090",fontSize:"9px"}}};var W=R.plotOptions,da=W.line;Ob();va.prototype={parsers:[{regex:/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]?(?:\.[0-9]+)?)\s*\)/,parse:function(a){return[K(a[1]),K(a[2]),K(a[3]),parseFloat(a[4],10)]}},{regex:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,
parse:function(a){return[K(a[1],16),K(a[2],16),K(a[3],16),1]}},{regex:/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/,parse:function(a){return[K(a[1]),K(a[2]),K(a[3]),1]}}],init:function(a){var b,c,d,e;if((this.input=a)&&a.stops)this.stops=ta(a.stops,function(a){return new va(a[1])});else for(d=this.parsers.length;d--&&!c;)e=this.parsers[d],(b=e.regex.exec(a))&&(c=e.parse(b));this.rgba=c||[]},get:function(a){var b=this.input,c=this.rgba,d;this.stops?(d=z(b),d.stops=[].concat(d.stops),
o(this.stops,function(b,c){d.stops[c]=[d.stops[c][0],b.get(a)]})):d=c&&C(c[0])?a==="rgb"||!a&&c[3]===1?"rgb("+c[0]+","+c[1]+","+c[2]+")":a==="a"?c[3]:"rgba("+c.join(",")+")":b;return d},brighten:function(a){var b,c=this.rgba;if(this.stops)o(this.stops,function(b){b.brighten(a)});else if(C(a)&&a!==0)for(b=0;b<3;b++)c[b]+=K(a*255),c[b]<0&&(c[b]=0),c[b]>255&&(c[b]=255);return this},setOpacity:function(a){this.rgba[3]=a;return this}};Z.prototype={opacity:1,textProps:"direction,fontSize,fontWeight,fontFamily,fontStyle,color,lineHeight,width,textDecoration,textOverflow,textShadow".split(","),
init:function(a,b){this.element=b==="span"?fa(b):H.createElementNS(Qa,b);this.renderer=a},animate:function(a,b,c){b=q(b,this.renderer.globalAnimation,!0);Sa(this);if(b){if(c)b.complete=c;db(this,a,b)}else this.attr(a,null,c);return this},colorGradient:function(a,b,c){var d=this.renderer,e,f,g,h,i,j,k,l,m,n,p,r=[],s;a.linearGradient?f="linearGradient":a.radialGradient&&(f="radialGradient");if(f){g=a[f];i=d.gradients;k=a.stops;n=c.radialReference;Ja(g)&&(a[f]=g={x1:g[0],y1:g[1],x2:g[2],y2:g[3],gradientUnits:"userSpaceOnUse"});
f==="radialGradient"&&n&&!v(g.gradientUnits)&&(h=g,g=z(g,d.getRadialAttr(n,h),{gradientUnits:"userSpaceOnUse"}));for(p in g)p!=="id"&&r.push(p,g[p]);for(p in k)r.push(k[p]);r=r.join(",");i[r]?n=i[r].attr("id"):(g.id=n="highcharts-"+Ib++,i[r]=j=d.createElement(f).attr(g).add(d.defs),j.radAttr=h,j.stops=[],o(k,function(a){a[1].indexOf("rgba")===0?(e=va(a[1]),l=e.get("rgb"),m=e.get("a")):(l=a[1],m=1);a=d.createElement("stop").attr({offset:a[0],"stop-color":l,"stop-opacity":m}).add(j);j.stops.push(a)}));
s="url("+d.url+"#"+n+")";c.setAttribute(b,s);c.gradient=r;a.toString=function(){return s}}},applyTextShadow:function(a){var b=this.element,c,d=a.indexOf("contrast")!==-1,e={},f=this.renderer.forExport,g=f||b.style.textShadow!==t&&!Ka;if(d)e.textShadow=a=a.replace(/contrast/g,this.renderer.getContrast(b.style.fill));if(sb||f)e.textRendering="geometricPrecision";g?this.css(e):(this.fakeTS=!0,this.ySetter=this.xSetter,c=[].slice.call(b.getElementsByTagName("tspan")),o(a.split(/\s?,\s?/g),function(a){var d=
b.firstChild,e,f,a=a.split(" ");e=a[a.length-1];(f=a[a.length-2])&&o(c,function(a,c){var g;c===0&&(a.setAttribute("x",b.getAttribute("x")),c=b.getAttribute("y"),a.setAttribute("y",c||0),c===null&&b.setAttribute("y",0));g=a.cloneNode(1);X(g,{"class":"highcharts-text-shadow",fill:e,stroke:e,"stroke-opacity":1/w(K(f),3),"stroke-width":f,"stroke-linejoin":"round"});b.insertBefore(g,d)})}))},attr:function(a,b,c){var d,e=this.element,f,g=this,h;typeof a==="string"&&b!==t&&(d=a,a={},a[d]=b);if(typeof a===
"string")g=(this[a+"Getter"]||this._defaultGetter).call(this,a,e);else{for(d in a){b=a[d];h=!1;this.symbolName&&/^(x|y|width|height|r|start|end|innerR|anchorX|anchorY)/.test(d)&&(f||(this.symbolAttr(a),f=!0),h=!0);if(this.rotation&&(d==="x"||d==="y"))this.doTransform=!0;h||(h=this[d+"Setter"]||this._defaultSetter,h.call(this,b,d,e),this.shadows&&/^(width|height|visibility|x|y|d|transform|cx|cy|r)$/.test(d)&&this.updateShadows(d,b,h))}if(this.doTransform)this.updateTransform(),this.doTransform=!1}c&&
c();return g},updateShadows:function(a,b,c){for(var d=this.shadows,e=d.length;e--;)c.call(d[e],a==="height"?Math.max(b-(d[e].cutHeight||0),0):a==="d"?this.d:b,a,d[e])},addClass:function(a){var b=this.element,c=X(b,"class")||"";c.indexOf(a)===-1&&X(b,"class",c+" "+a);return this},symbolAttr:function(a){var b=this;o("x,y,r,start,end,width,height,innerR,anchorX,anchorY".split(","),function(c){b[c]=q(a[c],b[c])});b.attr({d:b.renderer.symbols[b.symbolName](b.x,b.y,b.width,b.height,b)})},clip:function(a){return this.attr("clip-path",
a?"url("+this.renderer.url+"#"+a.id+")":"none")},crisp:function(a){var b,c={},d,e=this.strokeWidth||0;d=y(e)%2/2;a.x=V(a.x||this.x||0)+d;a.y=V(a.y||this.y||0)+d;a.width=V((a.width||this.width||0)-2*d);a.height=V((a.height||this.height||0)-2*d);a.strokeWidth=e;for(b in a)this[b]!==a[b]&&(this[b]=c[b]=a[b]);return c},css:function(a){var b=this.styles,c={},d=this.element,e,f,g="";e=!b;if(a&&a.color)a.fill=a.color;if(b)for(f in a)a[f]!==b[f]&&(c[f]=a[f],e=!0);if(e){e=this.textWidth=a&&a.width&&d.nodeName.toLowerCase()===
"text"&&K(a.width)||this.textWidth;b&&(a=A(b,c));this.styles=a;e&&(qa||!ja&&this.renderer.forExport)&&delete a.width;if(Ka&&!ja)N(this.element,a);else{b=function(a,b){return"-"+b.toLowerCase()};for(f in a)g+=f.replace(/([A-Z])/g,b)+":"+a[f]+";";X(d,"style",g)}e&&this.added&&this.renderer.buildText(this)}return this},on:function(a,b){var c=this,d=c.element;cb&&a==="click"?(d.ontouchstart=function(a){c.touchEventFired=ba.now();a.preventDefault();b.call(d,a)},d.onclick=function(a){(Na.indexOf("Android")===
-1||ba.now()-(c.touchEventFired||0)>1100)&&b.call(d,a)}):d["on"+a]=b;return this},setRadialReference:function(a){var b=this.renderer.gradients[this.element.gradient];this.element.radialReference=a;b&&b.radAttr&&b.animate(this.renderer.getRadialAttr(a,b.radAttr));return this},translate:function(a,b){return this.attr({translateX:a,translateY:b})},invert:function(){this.inverted=!0;this.updateTransform();return this},updateTransform:function(){var a=this.translateX||0,b=this.translateY||0,c=this.scaleX,
d=this.scaleY,e=this.inverted,f=this.rotation,g=this.element;e&&(a+=this.attr("width"),b+=this.attr("height"));a=["translate("+a+","+b+")"];e?a.push("rotate(90) scale(-1,1)"):f&&a.push("rotate("+f+" "+(g.getAttribute("x")||0)+" "+(g.getAttribute("y")||0)+")");(v(c)||v(d))&&a.push("scale("+q(c,1)+" "+q(d,1)+")");a.length&&g.setAttribute("transform",a.join(" "))},toFront:function(){var a=this.element;a.parentNode.appendChild(a);return this},align:function(a,b,c){var d,e,f,g,h={};e=this.renderer;f=e.alignedObjects;
if(a){if(this.alignOptions=a,this.alignByTranslate=b,!c||Ca(c))this.alignTo=d=c||"renderer",za(f,this),f.push(this),c=null}else a=this.alignOptions,b=this.alignByTranslate,d=this.alignTo;c=q(c,e[d],e);d=a.align;e=a.verticalAlign;f=(c.x||0)+(a.x||0);g=(c.y||0)+(a.y||0);if(d==="right"||d==="center")f+=(c.width-(a.width||0))/{right:1,center:2}[d];h[b?"translateX":"x"]=y(f);if(e==="bottom"||e==="middle")g+=(c.height-(a.height||0))/({bottom:1,middle:2}[e]||1);h[b?"translateY":"y"]=y(g);this[this.placed?
"animate":"attr"](h);this.placed=!0;this.alignAttr=h;return this},getBBox:function(a,b){var c,d=this.renderer,e,f,g,h=this.element,i=this.styles;e=this.textStr;var j,k=h.style,l,m=d.cache,n=d.cacheKeys,p;f=q(b,this.rotation);g=f*pa;e!==t&&(p=["",f||0,i&&i.fontSize,h.style.width].join(","),p=e===""||$b.test(e)?"num:"+e.toString().length+p:e+p);p&&!a&&(c=m[p]);if(!c){if(h.namespaceURI===Qa||d.forExport){try{l=this.fakeTS&&function(a){o(h.querySelectorAll(".highcharts-text-shadow"),function(b){b.style.display=
a})},Wa&&k.textShadow?(j=k.textShadow,k.textShadow=""):l&&l("none"),c=h.getBBox?A({},h.getBBox()):{width:h.offsetWidth,height:h.offsetHeight},j?k.textShadow=j:l&&l("")}catch(r){}if(!c||c.width<0)c={width:0,height:0}}else c=this.htmlGetBBox();if(d.isSVG){d=c.width;e=c.height;if(Ka&&i&&i.fontSize==="11px"&&e.toPrecision(3)==="16.9")c.height=e=14;if(f)c.width=S(e*la(g))+S(d*ca(g)),c.height=S(e*ca(g))+S(d*la(g))}if(p){for(;n.length>250;)delete m[n.shift()];m[p]||n.push(p);m[p]=c}}return c},show:function(a){return this.attr({visibility:a?
"inherit":"visible"})},hide:function(){return this.attr({visibility:"hidden"})},fadeOut:function(a){var b=this;b.animate({opacity:0},{duration:a||150,complete:function(){b.attr({y:-9999})}})},add:function(a){var b=this.renderer,c=this.element,d;if(a)this.parentGroup=a;this.parentInverted=a&&a.inverted;this.textStr!==void 0&&b.buildText(this);this.added=!0;if(!a||a.handleZ||this.zIndex)d=this.zIndexSetter();d||(a?a.element:b.box).appendChild(c);if(this.onAdd)this.onAdd();return this},safeRemoveChild:function(a){var b=
a.parentNode;b&&b.removeChild(a)},destroy:function(){var a=this,b=a.element||{},c=a.shadows,d=a.renderer.isSVG&&b.nodeName==="SPAN"&&a.parentGroup,e,f;b.onclick=b.onmouseout=b.onmouseover=b.onmousemove=b.point=null;Sa(a);if(a.clipPath)a.clipPath=a.clipPath.destroy();if(a.stops){for(f=0;f<a.stops.length;f++)a.stops[f]=a.stops[f].destroy();a.stops=null}a.safeRemoveChild(b);for(c&&o(c,function(b){a.safeRemoveChild(b)});d&&d.div&&d.div.childNodes.length===0;)b=d.parentGroup,a.safeRemoveChild(d.div),delete d.div,
d=b;a.alignTo&&za(a.renderer.alignedObjects,a);for(e in a)delete a[e];return null},shadow:function(a,b,c){var d=[],e,f,g=this.element,h,i,j,k;if(a){i=q(a.width,3);j=(a.opacity||0.15)/i;k=this.parentInverted?"(-1,-1)":"("+q(a.offsetX,1)+", "+q(a.offsetY,1)+")";for(e=1;e<=i;e++){f=g.cloneNode(0);h=i*2+1-2*e;X(f,{isShadow:"true",stroke:a.color||"black","stroke-opacity":j*e,"stroke-width":h,transform:"translate"+k,fill:"none"});if(c)X(f,"height",w(X(f,"height")-h,0)),f.cutHeight=h;b?b.element.appendChild(f):
g.parentNode.insertBefore(f,g);d.push(f)}this.shadows=d}return this},xGetter:function(a){this.element.nodeName==="circle"&&(a={x:"cx",y:"cy"}[a]||a);return this._defaultGetter(a)},_defaultGetter:function(a){a=q(this[a],this.element?this.element.getAttribute(a):null,0);/^[\-0-9\.]+$/.test(a)&&(a=parseFloat(a));return a},dSetter:function(a,b,c){a&&a.join&&(a=a.join(" "));/(NaN| {2}|^$)/.test(a)&&(a="M 0 0");c.setAttribute(b,a);this[b]=a},dashstyleSetter:function(a){var b,c=this["stroke-width"];c===
"inherit"&&(c=1);if(a=a&&a.toLowerCase()){a=a.replace("shortdashdotdot","3,1,1,1,1,1,").replace("shortdashdot","3,1,1,1").replace("shortdot","1,1,").replace("shortdash","3,1,").replace("longdash","8,3,").replace(/dot/g,"1,3,").replace("dash","4,3,").replace(/,$/,"").split(",");for(b=a.length;b--;)a[b]=K(a[b])*c;a=a.join(",").replace(/NaN/g,"none");this.element.setAttribute("stroke-dasharray",a)}},alignSetter:function(a){this.element.setAttribute("text-anchor",{left:"start",center:"middle",right:"end"}[a])},
opacitySetter:function(a,b,c){this[b]=a;c.setAttribute(b,a)},titleSetter:function(a){var b=this.element.getElementsByTagName("title")[0];b||(b=H.createElementNS(Qa,"title"),this.element.appendChild(b));b.firstChild&&b.removeChild(b.firstChild);b.appendChild(H.createTextNode(String(q(a),"").replace(/<[^>]*>/g,"")))},textSetter:function(a){if(a!==this.textStr)delete this.bBox,this.textStr=a,this.added&&this.renderer.buildText(this)},fillSetter:function(a,b,c){typeof a==="string"?c.setAttribute(b,a):
a&&this.colorGradient(a,b,c)},visibilitySetter:function(a,b,c){a==="inherit"?c.removeAttribute(b):c.setAttribute(b,a)},zIndexSetter:function(a,b){var c=this.renderer,d=this.parentGroup,c=(d||c).element||c.box,e,f,g=this.element,h;e=this.added;var i;if(v(a))g.zIndex=a,a=+a,this[b]===a&&(e=!1),this[b]=a;if(e){if((a=this.zIndex)&&d)d.handleZ=!0;d=c.childNodes;for(i=0;i<d.length&&!h;i++)if(e=d[i],f=e.zIndex,e!==g&&(K(f)>a||!v(a)&&v(f)))c.insertBefore(g,e),h=!0;h||c.appendChild(g)}return h},_defaultSetter:function(a,
b,c){c.setAttribute(b,a)}};Z.prototype.yGetter=Z.prototype.xGetter;Z.prototype.translateXSetter=Z.prototype.translateYSetter=Z.prototype.rotationSetter=Z.prototype.verticalAlignSetter=Z.prototype.scaleXSetter=Z.prototype.scaleYSetter=function(a,b){this[b]=a;this.doTransform=!0};Z.prototype["stroke-widthSetter"]=Z.prototype.strokeSetter=function(a,b,c){this[b]=a;if(this.stroke&&this["stroke-width"])this.strokeWidth=this["stroke-width"],Z.prototype.fillSetter.call(this,this.stroke,"stroke",c),c.setAttribute("stroke-width",
this["stroke-width"]),this.hasStroke=!0;else if(b==="stroke-width"&&a===0&&this.hasStroke)c.removeAttribute("stroke"),this.hasStroke=!1};var xa=function(){this.init.apply(this,arguments)};xa.prototype={Element:Z,init:function(a,b,c,d,e,f){var g,d=this.createElement("svg").attr({version:"1.1"}).css(this.getStyle(d));g=d.element;a.appendChild(g);a.innerHTML.indexOf("xmlns")===-1&&X(g,"xmlns",Qa);this.isSVG=!0;this.box=g;this.boxWrapper=d;this.alignedObjects=[];this.url=(Wa||sb)&&H.getElementsByTagName("base").length?
L.location.href.replace(/#.*?$/,"").replace(/([\('\)])/g,"\\$1").replace(/ /g,"%20"):"";this.createElement("desc").add().element.appendChild(H.createTextNode("Created with Highstock 4.2.5"));this.defs=this.createElement("defs").add();this.allowHTML=f;this.forExport=e;this.gradients={};this.cache={};this.cacheKeys=[];this.imgCount=0;this.setSize(b,c,!1);var h;if(Wa&&a.getBoundingClientRect)this.subPixelFix=b=function(){N(a,{left:0,top:0});h=a.getBoundingClientRect();N(a,{left:Ea(h.left)-h.left+"px",
top:Ea(h.top)-h.top+"px"})},b(),E(L,"resize",b)},getStyle:function(a){return this.style=A({fontFamily:'"Lucida Grande", "Lucida Sans Unicode", Arial, Helvetica, sans-serif',fontSize:"12px"},a)},isHidden:function(){return!this.boxWrapper.getBBox().width},destroy:function(){var a=this.defs;this.box=null;this.boxWrapper=this.boxWrapper.destroy();Pa(this.gradients||{});this.gradients=null;if(a)this.defs=a.destroy();this.subPixelFix&&T(L,"resize",this.subPixelFix);return this.alignedObjects=null},createElement:function(a){var b=
new this.Element;b.init(this,a);return b},draw:function(){},getRadialAttr:function(a,b){return{cx:a[0]-a[2]/2+b.cx*a[2],cy:a[1]-a[2]/2+b.cy*a[2],r:b.r*a[2]}},buildText:function(a){for(var b=a.element,c=this,d=c.forExport,e=q(a.textStr,"").toString(),f=e.indexOf("<")!==-1,g=b.childNodes,h,i,j,k=X(b,"x"),l=a.styles,m=a.textWidth,n=l&&l.lineHeight,p=l&&l.textShadow,r=l&&l.textOverflow==="ellipsis",s=g.length,F=m&&!a.added&&this.box,u=function(a){return n?K(n):c.fontMetrics(/(px|em)$/.test(a&&a.style.fontSize)?
a.style.fontSize:l&&l.fontSize||c.style.fontSize||12,a).h},x=function(a){return a.replace(/&lt;/g,"<").replace(/&gt;/g,">")};s--;)b.removeChild(g[s]);!f&&!p&&!r&&e.indexOf(" ")===-1?b.appendChild(H.createTextNode(x(e))):(h=/<.*style="([^"]+)".*>/,i=/<.*href="(http[^"]+)".*>/,F&&F.appendChild(b),e=f?e.replace(/<(b|strong)>/g,'<span style="font-weight:bold">').replace(/<(i|em)>/g,'<span style="font-style:italic">').replace(/<a/g,"<span").replace(/<\/(b|strong|i|em|a)>/g,"</span>").split(/<br.*?>/g):
[e],e=Fa(e,function(a){return a!==""}),o(e,function(e,f){var g,n=0,e=e.replace(/^\s+|\s+$/g,"").replace(/<span/g,"|||<span").replace(/<\/span>/g,"</span>|||");g=e.split("|||");o(g,function(e){if(e!==""||g.length===1){var p={},s=H.createElementNS(Qa,"tspan"),F;h.test(e)&&(F=e.match(h)[1].replace(/(;| |^)color([ :])/,"$1fill$2"),X(s,"style",F));i.test(e)&&!d&&(X(s,"onclick",'location.href="'+e.match(i)[1]+'"'),N(s,{cursor:"pointer"}));e=x(e.replace(/<(.|\n)*?>/g,"")||" ");if(e!==" "){s.appendChild(H.createTextNode(e));
if(n)p.dx=0;else if(f&&k!==null)p.x=k;X(s,p);b.appendChild(s);!n&&f&&(!ja&&d&&N(s,{display:"block"}),X(s,"dy",u(s)));if(m){for(var p=e.replace(/([^\^])-/g,"$1- ").split(" "),q=g.length>1||f||p.length>1&&l.whiteSpace!=="nowrap",o,D,v=[],w=u(s),t=1,y=a.rotation,A=e,B=A.length;(q||r)&&(p.length||v.length);)a.rotation=0,o=a.getBBox(!0),D=o.width,!ja&&c.forExport&&(D=c.measureSpanWidth(s.firstChild.data,a.styles)),o=D>m,j===void 0&&(j=o),r&&j?(B/=2,A===""||!o&&B<0.5?p=[]:(A=e.substring(0,A.length+(o?-1:
1)*Ea(B)),p=[A+(m>3?"\u2026":"")],s.removeChild(s.firstChild))):!o||p.length===1?(p=v,v=[],p.length&&(t++,s=H.createElementNS(Qa,"tspan"),X(s,{dy:w,x:k}),F&&X(s,"style",F),b.appendChild(s)),D>m&&(m=D)):(s.removeChild(s.firstChild),v.unshift(p.pop())),p.length&&s.appendChild(H.createTextNode(p.join(" ").replace(/- /g,"-")));a.rotation=y}n++}}})}),j&&a.attr("title",a.textStr),F&&F.removeChild(b),p&&a.applyTextShadow&&a.applyTextShadow(p))},getContrast:function(a){a=va(a).rgba;return a[0]+a[1]+a[2]>
384?"#000000":"#FFFFFF"},button:function(a,b,c,d,e,f,g,h,i){var j=this.label(a,b,c,i,null,null,null,null,"button"),k=0,l,m,n,p,r,s,a={x1:0,y1:0,x2:0,y2:1},e=z({"stroke-width":1,stroke:"#CCCCCC",fill:{linearGradient:a,stops:[[0,"#FEFEFE"],[1,"#F6F6F6"]]},r:2,padding:5,style:{color:"black"}},e);n=e.style;delete e.style;f=z(e,{stroke:"#68A",fill:{linearGradient:a,stops:[[0,"#FFF"],[1,"#ACF"]]}},f);p=f.style;delete f.style;g=z(e,{stroke:"#68A",fill:{linearGradient:a,stops:[[0,"#9BD"],[1,"#CDF"]]}},g);
r=g.style;delete g.style;h=z(e,{style:{color:"#CCC"}},h);s=h.style;delete h.style;E(j.element,Ka?"mouseover":"mouseenter",function(){k!==3&&j.attr(f).css(p)});E(j.element,Ka?"mouseout":"mouseleave",function(){k!==3&&(l=[e,f,g][k],m=[n,p,r][k],j.attr(l).css(m))});j.setState=function(a){(j.state=k=a)?a===2?j.attr(g).css(r):a===3&&j.attr(h).css(s):j.attr(e).css(n)};return j.on("click",function(a){k!==3&&d.call(j,a)}).attr(e).css(A({cursor:"default"},n))},crispLine:function(a,b){a[1]===a[4]&&(a[1]=a[4]=
y(a[1])-b%2/2);a[2]===a[5]&&(a[2]=a[5]=y(a[2])+b%2/2);return a},path:function(a){var b={fill:"none"};Ja(a)?b.d=a:ea(a)&&A(b,a);return this.createElement("path").attr(b)},circle:function(a,b,c){a=ea(a)?a:{x:a,y:b,r:c};b=this.createElement("circle");b.xSetter=b.ySetter=function(a,b,c){c.setAttribute("c"+b,a)};return b.attr(a)},arc:function(a,b,c,d,e,f){if(ea(a))b=a.y,c=a.r,d=a.innerR,e=a.start,f=a.end,a=a.x;a=this.symbol("arc",a||0,b||0,c||0,c||0,{innerR:d||0,start:e||0,end:f||0});a.r=c;return a},rect:function(a,
b,c,d,e,f){var e=ea(a)?a.r:e,g=this.createElement("rect"),a=ea(a)?a:a===t?{}:{x:a,y:b,width:w(c,0),height:w(d,0)};if(f!==t)g.strokeWidth=f,a=g.crisp(a);if(e)a.r=e;g.rSetter=function(a,b,c){X(c,{rx:a,ry:a})};return g.attr(a)},setSize:function(a,b,c){var d=this.alignedObjects,e=d.length;this.width=a;this.height=b;for(this.boxWrapper[q(c,!0)?"animate":"attr"]({width:a,height:b});e--;)d[e].align()},g:function(a){var b=this.createElement("g");return v(a)?b.attr({"class":"highcharts-"+a}):b},image:function(a,
b,c,d,e){var f={preserveAspectRatio:"none"};arguments.length>1&&A(f,{x:b,y:c,width:d,height:e});f=this.createElement("image").attr(f);f.element.setAttributeNS?f.element.setAttributeNS("http://www.w3.org/1999/xlink","href",a):f.element.setAttribute("hc-svg-href",a);return f},symbol:function(a,b,c,d,e,f){var g=this,h,i=this.symbols[a],i=i&&i(y(b),y(c),d,e,f),j=/^url\((.*?)\)$/,k,l;if(i)h=this.path(i),A(h,{symbolName:a,x:b,y:c,width:d,height:e}),f&&A(h,f);else if(j.test(a))l=function(a,b){a.element&&
(a.attr({width:b[0],height:b[1]}),a.alignByTranslate||a.translate(y((d-b[0])/2),y((e-b[1])/2)))},k=a.match(j)[1],a=Vb[k]||f&&f.width&&f.height&&[f.width,f.height],h=this.image(k).attr({x:b,y:c}),h.isImg=!0,a?l(h,a):(h.attr({width:0,height:0}),fa("img",{onload:function(){this.width===0&&(N(this,{position:"absolute",top:"-999em"}),H.body.appendChild(this));l(h,Vb[k]=[this.width,this.height]);this.parentNode&&this.parentNode.removeChild(this);g.imgCount--;if(!g.imgCount&&$[g.chartIndex].onload)$[g.chartIndex].onload()},
src:k}),this.imgCount++);return h},symbols:{circle:function(a,b,c,d){var e=0.166*c;return["M",a+c/2,b,"C",a+c+e,b,a+c+e,b+d,a+c/2,b+d,"C",a-e,b+d,a-e,b,a+c/2,b,"Z"]},square:function(a,b,c,d){return["M",a,b,"L",a+c,b,a+c,b+d,a,b+d,"Z"]},triangle:function(a,b,c,d){return["M",a+c/2,b,"L",a+c,b+d,a,b+d,"Z"]},"triangle-down":function(a,b,c,d){return["M",a,b,"L",a+c,b,a+c/2,b+d,"Z"]},diamond:function(a,b,c,d){return["M",a+c/2,b,"L",a+c,b+d/2,a+c/2,b+d,a,b+d/2,"Z"]},arc:function(a,b,c,d,e){var f=e.start,
c=e.r||c||d,g=e.end-0.001,d=e.innerR,h=e.open,i=ca(f),j=la(f),k=ca(g),g=la(g),e=e.end-f<Aa?0:1;return["M",a+c*i,b+c*j,"A",c,c,0,e,1,a+c*k,b+c*g,h?"M":"L",a+d*k,b+d*g,"A",d,d,0,e,0,a+d*i,b+d*j,h?"":"Z"]},callout:function(a,b,c,d,e){var f=G(e&&e.r||0,c,d),g=f+6,h=e&&e.anchorX,e=e&&e.anchorY,i;i=["M",a+f,b,"L",a+c-f,b,"C",a+c,b,a+c,b,a+c,b+f,"L",a+c,b+d-f,"C",a+c,b+d,a+c,b+d,a+c-f,b+d,"L",a+f,b+d,"C",a,b+d,a,b+d,a,b+d-f,"L",a,b+f,"C",a,b,a,b,a+f,b];h&&h>c&&e>b+g&&e<b+d-g?i.splice(13,3,"L",a+c,e-6,a+
c+6,e,a+c,e+6,a+c,b+d-f):h&&h<0&&e>b+g&&e<b+d-g?i.splice(33,3,"L",a,e+6,a-6,e,a,e-6,a,b+f):e&&e>d&&h>a+g&&h<a+c-g?i.splice(23,3,"L",h+6,b+d,h,b+d+6,h-6,b+d,a+f,b+d):e&&e<0&&h>a+g&&h<a+c-g&&i.splice(3,3,"L",h-6,b,h,b-6,h+6,b,c-f,b);return i}},clipRect:function(a,b,c,d){var e="highcharts-"+Ib++,f=this.createElement("clipPath").attr({id:e}).add(this.defs),a=this.rect(a,b,c,d,0).add(f);a.id=e;a.clipPath=f;a.count=0;return a},text:function(a,b,c,d){var e=qa||!ja&&this.forExport,f={};if(d&&(this.allowHTML||
!this.forExport))return this.html(a,b,c);f.x=Math.round(b||0);if(c)f.y=Math.round(c);if(a||a===0)f.text=a;a=this.createElement("text").attr(f);e&&a.css({position:"absolute"});if(!d)a.xSetter=function(a,b,c){var d=c.getElementsByTagName("tspan"),e,f=c.getAttribute(b),m;for(m=0;m<d.length;m++)e=d[m],e.getAttribute(b)===f&&e.setAttribute(b,a);c.setAttribute(b,a)};return a},fontMetrics:function(a,b){var c,d,a=a||this.style.fontSize;!a&&b&&L.getComputedStyle&&(b=b.element||b,a=(c=L.getComputedStyle(b,
""))&&c.fontSize);a=/px/.test(a)?K(a):/em/.test(a)?parseFloat(a)*12:12;c=a<24?a+3:y(a*1.2);d=y(c*0.8);return{h:c,b:d,f:a}},rotCorr:function(a,b,c){var d=a;b&&c&&(d=w(d*ca(b*pa),4));return{x:-a/3*la(b*pa),y:d}},label:function(a,b,c,d,e,f,g,h,i){var j=this,k=j.g(i),l=j.text("",0,0,g).attr({zIndex:1}),m,n,p=0,r=3,s=0,F,u,q,D,Q=0,ha={},w,B,Kb,G,C;Kb=function(){var a,b;a=l.element.style;n=(F===void 0||u===void 0||k.styles.textAlign)&&v(l.textStr)&&l.getBBox();k.width=(F||n.width||0)+2*r+s;k.height=(u||
n.height||0)+2*r;w=r+j.fontMetrics(a&&a.fontSize,l).b;if(B){if(!m)a=Q,b=(h?-w:0)+Q,k.box=m=d?j.symbol(d,a,b,k.width,k.height,ha):j.rect(a,b,k.width,k.height,0,ha["stroke-width"]),m.isImg||m.attr("fill","none"),m.add(k);m.isImg||m.attr(A({width:y(k.width),height:y(k.height)},ha));ha=null}};G=function(){var a=k.styles,a=a&&a.textAlign,b=s+r,c;c=h?0:w;if(v(F)&&n&&(a==="center"||a==="right"))b+={center:0.5,right:1}[a]*(F-n.width);if(b!==l.x||c!==l.y)l.attr("x",b),c!==t&&l.attr("y",c);l.x=b;l.y=c};C=function(a,
b){m?m.attr(a,b):ha[a]=b};k.onAdd=function(){l.add(k);k.attr({text:a||a===0?a:"",x:b,y:c});m&&v(e)&&k.attr({anchorX:e,anchorY:f})};k.widthSetter=function(a){F=a};k.heightSetter=function(a){u=a};k.paddingSetter=function(a){if(v(a)&&a!==r)r=k.padding=a,G()};k.paddingLeftSetter=function(a){v(a)&&a!==s&&(s=a,G())};k.alignSetter=function(a){a={left:0,center:0.5,right:1}[a];a!==p&&(p=a,n&&k.attr({x:q}))};k.textSetter=function(a){a!==t&&l.textSetter(a);Kb();G()};k["stroke-widthSetter"]=function(a,b){a&&
(B=!0);Q=a%2/2;C(b,a)};k.strokeSetter=k.fillSetter=k.rSetter=function(a,b){b==="fill"&&a&&(B=!0);C(b,a)};k.anchorXSetter=function(a,b){e=a;C(b,y(a)-Q-q)};k.anchorYSetter=function(a,b){f=a;C(b,a-D)};k.xSetter=function(a){k.x=a;p&&(a-=p*((F||n.width)+2*r));q=y(a);k.attr("translateX",q)};k.ySetter=function(a){D=k.y=y(a);k.attr("translateY",D)};var H=k.css;return A(k,{css:function(a){if(a){var b={},a=z(a);o(k.textProps,function(c){a[c]!==t&&(b[c]=a[c],delete a[c])});l.css(b)}return H.call(k,a)},getBBox:function(){return{width:n.width+
2*r,height:n.height+2*r,x:n.x-r,y:n.y-r}},shadow:function(a){m&&m.shadow(a);return k},destroy:function(){T(k.element,"mouseenter");T(k.element,"mouseleave");l&&(l=l.destroy());m&&(m=m.destroy());Z.prototype.destroy.call(k);k=j=Kb=G=C=null}})}};Xa=xa;A(Z.prototype,{htmlCss:function(a){var b=this.element;if(b=a&&b.tagName==="SPAN"&&a.width)delete a.width,this.textWidth=b,this.updateTransform();if(a&&a.textOverflow==="ellipsis")a.whiteSpace="nowrap",a.overflow="hidden";this.styles=A(this.styles,a);N(this.element,
a);return this},htmlGetBBox:function(){var a=this.element;if(a.nodeName==="text")a.style.position="absolute";return{x:a.offsetLeft,y:a.offsetTop,width:a.offsetWidth,height:a.offsetHeight}},htmlUpdateTransform:function(){if(this.added){var a=this.renderer,b=this.element,c=this.translateX||0,d=this.translateY||0,e=this.x||0,f=this.y||0,g=this.textAlign||"left",h={left:0,center:0.5,right:1}[g],i=this.shadows,j=this.styles;N(b,{marginLeft:c,marginTop:d});i&&o(i,function(a){N(a,{marginLeft:c+1,marginTop:d+
1})});this.inverted&&o(b.childNodes,function(c){a.invertChild(c,b)});if(b.tagName==="SPAN"){var i=this.rotation,k=K(this.textWidth),l=j&&j.whiteSpace,m=[i,g,b.innerHTML,this.textWidth,this.textAlign].join(",");if(m!==this.cTT){j=a.fontMetrics(b.style.fontSize).b;v(i)&&this.setSpanRotation(i,h,j);if(b.offsetWidth>k&&/[ \-]/.test(b.textContent||b.innerText))N(b,{width:k+"px",display:"block",whiteSpace:l||"normal"}),this.hasTextWidth=!0;else if(this.hasTextWidth)N(b,{width:"",display:"",whiteSpace:l||
"nowrap"}),this.hasTextWidth=!1;this.getSpanCorrection(this.hasTextWidth?k:b.offsetWidth,j,h,i,g)}N(b,{left:e+(this.xCorr||0)+"px",top:f+(this.yCorr||0)+"px"});if(sb)j=b.offsetHeight;this.cTT=m}}else this.alignOnAdd=!0},setSpanRotation:function(a,b,c){var d={},e=Ka?"-ms-transform":sb?"-webkit-transform":Wa?"MozTransform":Ub?"-o-transform":"";d[e]=d.transform="rotate("+a+"deg)";d[e+(Wa?"Origin":"-origin")]=d.transformOrigin=b*100+"% "+c+"px";N(this.element,d)},getSpanCorrection:function(a,b,c){this.xCorr=
-a*c;this.yCorr=-b}});A(xa.prototype,{html:function(a,b,c){var d=this.createElement("span"),e=d.element,f=d.renderer,g=f.isSVG,h=function(a,b){o(["opacity","visibility"],function(c){U(a,c+"Setter",function(a,c,d,e){a.call(this,c,d,e);b[d]=c})})};d.textSetter=function(a){a!==e.innerHTML&&delete this.bBox;e.innerHTML=this.textStr=a;d.htmlUpdateTransform()};g&&h(d,d.element.style);d.xSetter=d.ySetter=d.alignSetter=d.rotationSetter=function(a,b){b==="align"&&(b="textAlign");d[b]=a;d.htmlUpdateTransform()};
d.attr({text:a,x:y(b),y:y(c)}).css({position:"absolute",fontFamily:this.style.fontFamily,fontSize:this.style.fontSize});e.style.whiteSpace="nowrap";d.css=d.htmlCss;if(g)d.add=function(a){var b,c=f.box.parentNode,g=[];if(this.parentGroup=a){if(b=a.div,!b){for(;a;)g.push(a),a=a.parentGroup;o(g.reverse(),function(a){var d,e=X(a.element,"class");e&&(e={className:e});b=a.div=a.div||fa(Va,e,{position:"absolute",left:(a.translateX||0)+"px",top:(a.translateY||0)+"px",opacity:a.opacity},b||c);d=b.style;A(a,
{translateXSetter:function(b,c){d.left=b+"px";a[c]=b;a.doTransform=!0},translateYSetter:function(b,c){d.top=b+"px";a[c]=b;a.doTransform=!0}});h(a,d)})}}else b=c;b.appendChild(e);d.added=!0;d.alignOnAdd&&d.htmlUpdateTransform();return d};return d}});var lb,aa;if(!ja&&!qa)aa={init:function(a,b){var c=["<",b,' filled="f" stroked="f"'],d=["position: ","absolute",";"],e=b===Va;(b==="shape"||e)&&d.push("left:0;top:0;width:1px;height:1px;");d.push("visibility: ",e?"hidden":"visible");c.push(' style="',d.join(""),
'"/>');if(b)c=e||b==="span"||b==="img"?c.join(""):a.prepVML(c),this.element=fa(c);this.renderer=a},add:function(a){var b=this.renderer,c=this.element,d=b.box,e=a&&a.inverted,d=a?a.element||a:d;if(a)this.parentGroup=a;e&&b.invertChild(c,d);d.appendChild(c);this.added=!0;this.alignOnAdd&&!this.deferUpdateTransform&&this.updateTransform();if(this.onAdd)this.onAdd();return this},updateTransform:Z.prototype.htmlUpdateTransform,setSpanRotation:function(){var a=this.rotation,b=ca(a*pa),c=la(a*pa);N(this.element,
{filter:a?["progid:DXImageTransform.Microsoft.Matrix(M11=",b,", M12=",-c,", M21=",c,", M22=",b,", sizingMethod='auto expand')"].join(""):"none"})},getSpanCorrection:function(a,b,c,d,e){var f=d?ca(d*pa):1,g=d?la(d*pa):0,h=q(this.elemHeight,this.element.offsetHeight),i;this.xCorr=f<0&&-a;this.yCorr=g<0&&-h;i=f*g<0;this.xCorr+=g*b*(i?1-c:c);this.yCorr-=f*b*(d?i?c:1-c:1);e&&e!=="left"&&(this.xCorr-=a*c*(f<0?-1:1),d&&(this.yCorr-=h*c*(g<0?-1:1)),N(this.element,{textAlign:e}))},pathToVML:function(a){for(var b=
a.length,c=[];b--;)if(C(a[b]))c[b]=y(a[b]*10)-5;else if(a[b]==="Z")c[b]="x";else if(c[b]=a[b],a.isArc&&(a[b]==="wa"||a[b]==="at"))c[b+5]===c[b+7]&&(c[b+7]+=a[b+7]>a[b+5]?1:-1),c[b+6]===c[b+8]&&(c[b+8]+=a[b+8]>a[b+6]?1:-1);return c.join(" ")||"x"},clip:function(a){var b=this,c;a?(c=a.members,za(c,b),c.push(b),b.destroyClip=function(){za(c,b)},a=a.getCSS(b)):(b.destroyClip&&b.destroyClip(),a={clip:rb?"inherit":"rect(auto)"});return b.css(a)},css:Z.prototype.htmlCss,safeRemoveChild:function(a){a.parentNode&&
Ua(a)},destroy:function(){this.destroyClip&&this.destroyClip();return Z.prototype.destroy.apply(this)},on:function(a,b){this.element["on"+a]=function(){var a=L.event;a.target=a.srcElement;b(a)};return this},cutOffPath:function(a,b){var c,a=a.split(/[ ,]/);c=a.length;if(c===9||c===11)a[c-4]=a[c-2]=K(a[c-2])-10*b;return a.join(" ")},shadow:function(a,b,c){var d=[],e,f=this.element,g=this.renderer,h,i=f.style,j,k=f.path,l,m,n,p;k&&typeof k.value!=="string"&&(k="x");m=k;if(a){n=q(a.width,3);p=(a.opacity||
0.15)/n;for(e=1;e<=3;e++){l=n*2+1-2*e;c&&(m=this.cutOffPath(k.value,l+0.5));j=['<shape isShadow="true" strokeweight="',l,'" filled="false" path="',m,'" coordsize="10 10" style="',f.style.cssText,'" />'];h=fa(g.prepVML(j),null,{left:K(i.left)+q(a.offsetX,1),top:K(i.top)+q(a.offsetY,1)});if(c)h.cutOff=l+1;j=['<stroke color="',a.color||"black",'" opacity="',p*e,'"/>'];fa(g.prepVML(j),null,null,h);b?b.element.appendChild(h):f.parentNode.insertBefore(h,f);d.push(h)}this.shadows=d}return this},updateShadows:ra,
setAttr:function(a,b){rb?this.element[a]=b:this.element.setAttribute(a,b)},classSetter:function(a){this.element.className=a},dashstyleSetter:function(a,b,c){(c.getElementsByTagName("stroke")[0]||fa(this.renderer.prepVML(["<stroke/>"]),null,null,c))[b]=a||"solid";this[b]=a},dSetter:function(a,b,c){var d=this.shadows,a=a||[];this.d=a.join&&a.join(" ");c.path=a=this.pathToVML(a);if(d)for(c=d.length;c--;)d[c].path=d[c].cutOff?this.cutOffPath(a,d[c].cutOff):a;this.setAttr(b,a)},fillSetter:function(a,b,
c){var d=c.nodeName;if(d==="SPAN")c.style.color=a;else if(d!=="IMG")c.filled=a!=="none",this.setAttr("fillcolor",this.renderer.color(a,c,b,this))},"fill-opacitySetter":function(a,b,c){fa(this.renderer.prepVML(["<",b.split("-")[0],' opacity="',a,'"/>']),null,null,c)},opacitySetter:ra,rotationSetter:function(a,b,c){c=c.style;this[b]=c[b]=a;c.left=-y(la(a*pa)+1)+"px";c.top=y(ca(a*pa))+"px"},strokeSetter:function(a,b,c){this.setAttr("strokecolor",this.renderer.color(a,c,b,this))},"stroke-widthSetter":function(a,
b,c){c.stroked=!!a;this[b]=a;C(a)&&(a+="px");this.setAttr("strokeweight",a)},titleSetter:function(a,b){this.setAttr(b,a)},visibilitySetter:function(a,b,c){a==="inherit"&&(a="visible");this.shadows&&o(this.shadows,function(c){c.style[b]=a});c.nodeName==="DIV"&&(a=a==="hidden"?"-999em":0,rb||(c.style[b]=a?"visible":"hidden"),b="top");c.style[b]=a},xSetter:function(a,b,c){this[b]=a;b==="x"?b="left":b==="y"&&(b="top");this.updateClipping?(this[b]=a,this.updateClipping()):c.style[b]=a},zIndexSetter:function(a,
b,c){c.style[b]=a}},aa["stroke-opacitySetter"]=aa["fill-opacitySetter"],B.VMLElement=aa=ma(Z,aa),aa.prototype.ySetter=aa.prototype.widthSetter=aa.prototype.heightSetter=aa.prototype.xSetter,aa={Element:aa,isIE8:Na.indexOf("MSIE 8.0")>-1,init:function(a,b,c,d){var e;this.alignedObjects=[];d=this.createElement(Va).css(A(this.getStyle(d),{position:"relative"}));e=d.element;a.appendChild(d.element);this.isVML=!0;this.box=e;this.boxWrapper=d;this.gradients={};this.cache={};this.cacheKeys=[];this.imgCount=
0;this.setSize(b,c,!1);if(!H.namespaces.hcv){H.namespaces.add("hcv","urn:schemas-microsoft-com:vml");try{H.createStyleSheet().cssText="hcv\\:fill, hcv\\:path, hcv\\:shape, hcv\\:stroke{ behavior:url(#default#VML); display: inline-block; } "}catch(f){H.styleSheets[0].cssText+="hcv\\:fill, hcv\\:path, hcv\\:shape, hcv\\:stroke{ behavior:url(#default#VML); display: inline-block; } "}}},isHidden:function(){return!this.box.offsetWidth},clipRect:function(a,b,c,d){var e=this.createElement(),f=ea(a);return A(e,
{members:[],count:0,left:(f?a.x:a)+1,top:(f?a.y:b)+1,width:(f?a.width:c)-1,height:(f?a.height:d)-1,getCSS:function(a){var b=a.element,c=b.nodeName,a=a.inverted,d=this.top-(c==="shape"?b.offsetTop:0),e=this.left,b=e+this.width,f=d+this.height,d={clip:"rect("+y(a?e:d)+"px,"+y(a?f:b)+"px,"+y(a?b:f)+"px,"+y(a?d:e)+"px)"};!a&&rb&&c==="DIV"&&A(d,{width:b+"px",height:f+"px"});return d},updateClipping:function(){o(e.members,function(a){a.element&&a.css(e.getCSS(a))})}})},color:function(a,b,c,d){var e=this,
f,g=/^rgba/,h,i,j="none";a&&a.linearGradient?i="gradient":a&&a.radialGradient&&(i="pattern");if(i){var k,l,m=a.linearGradient||a.radialGradient,n,p,r,s,q,u="",a=a.stops,x,D=[],Q=function(){h=['<fill colors="'+D.join(",")+'" opacity="',r,'" o:opacity2="',p,'" type="',i,'" ',u,'focus="100%" method="any" />'];fa(e.prepVML(h),null,null,b)};n=a[0];x=a[a.length-1];n[0]>0&&a.unshift([0,n[1]]);x[0]<1&&a.push([1,x[1]]);o(a,function(a,b){g.test(a[1])?(f=va(a[1]),k=f.get("rgb"),l=f.get("a")):(k=a[1],l=1);D.push(a[0]*
100+"% "+k);b?(r=l,s=k):(p=l,q=k)});if(c==="fill")if(i==="gradient")c=m.x1||m[0]||0,a=m.y1||m[1]||0,n=m.x2||m[2]||0,m=m.y2||m[3]||0,u='angle="'+(90-Y.atan((m-a)/(n-c))*180/Aa)+'"',Q();else{var j=m.r,ha=j*2,v=j*2,w=m.cx,t=m.cy,y=b.radialReference,A,j=function(){y&&(A=d.getBBox(),w+=(y[0]-A.x)/A.width-0.5,t+=(y[1]-A.y)/A.height-0.5,ha*=y[2]/A.width,v*=y[2]/A.height);u='src="'+R.global.VMLRadialGradientURL+'" size="'+ha+","+v+'" origin="0.5,0.5" position="'+w+","+t+'" color2="'+q+'" ';Q()};d.added?j():
d.onAdd=j;j=s}else j=k}else if(g.test(a)&&b.tagName!=="IMG")f=va(a),d[c+"-opacitySetter"](f.get("a"),c,b),j=f.get("rgb");else{j=b.getElementsByTagName(c);if(j.length)j[0].opacity=1,j[0].type="solid";j=a}return j},prepVML:function(a){var b=this.isIE8,a=a.join("");b?(a=a.replace("/>",' xmlns="urn:schemas-microsoft-com:vml" />'),a=a.indexOf('style="')===-1?a.replace("/>",' style="display:inline-block;behavior:url(#default#VML);" />'):a.replace('style="','style="display:inline-block;behavior:url(#default#VML);')):
a=a.replace("<","<hcv:");return a},text:xa.prototype.html,path:function(a){var b={coordsize:"10 10"};Ja(a)?b.d=a:ea(a)&&A(b,a);return this.createElement("shape").attr(b)},circle:function(a,b,c){var d=this.symbol("circle");if(ea(a))c=a.r,b=a.y,a=a.x;d.isCircle=!0;d.r=c;return d.attr({x:a,y:b})},g:function(a){var b;a&&(b={className:"highcharts-"+a,"class":"highcharts-"+a});return this.createElement(Va).attr(b)},image:function(a,b,c,d,e){var f=this.createElement("img").attr({src:a});arguments.length>
1&&f.attr({x:b,y:c,width:d,height:e});return f},createElement:function(a){return a==="rect"?this.symbol(a):xa.prototype.createElement.call(this,a)},invertChild:function(a,b){var c=this,d=b.style,e=a.tagName==="IMG"&&a.style;N(a,{flip:"x",left:K(d.width)-(e?K(e.top):1),top:K(d.height)-(e?K(e.left):1),rotation:-90});o(a.childNodes,function(b){c.invertChild(b,a)})},symbols:{arc:function(a,b,c,d,e){var f=e.start,g=e.end,h=e.r||c||d,c=e.innerR,d=ca(f),i=la(f),j=ca(g),k=la(g);if(g-f===0)return["x"];f=["wa",
a-h,b-h,a+h,b+h,a+h*d,b+h*i,a+h*j,b+h*k];e.open&&!c&&f.push("e","M",a,b);f.push("at",a-c,b-c,a+c,b+c,a+c*j,b+c*k,a+c*d,b+c*i,"x","e");f.isArc=!0;return f},circle:function(a,b,c,d,e){e&&(c=d=2*e.r);e&&e.isCircle&&(a-=c/2,b-=d/2);return["wa",a,b,a+c,b+d,a+c,b+d/2,a+c,b+d/2,"e"]},rect:function(a,b,c,d,e){return xa.prototype.symbols[!v(e)||!e.r?"square":"callout"].call(0,a,b,c,d,e)}}},B.VMLRenderer=lb=function(){this.init.apply(this,arguments)},lb.prototype=z(xa.prototype,aa),Xa=lb;xa.prototype.measureSpanWidth=
function(a,b){var c=H.createElement("span"),d;d=H.createTextNode(a);c.appendChild(d);N(c,b);this.box.appendChild(c);d=c.offsetWidth;Ua(c);return d};var Wb;if(qa)B.CanVGRenderer=aa=function(){Qa="http://www.w3.org/1999/xhtml"},aa.prototype.symbols={},Wb=function(){function a(){var a=b.length,d;for(d=0;d<a;d++)b[d]();b=[]}var b=[];return{push:function(c,d){if(b.length===0){var e=H.getElementsByTagName("head")[0],f=H.createElement("script");f.type="text/javascript";f.src=d;f.onload=a;e.appendChild(f)}b.push(c)}}}(),
Xa=aa;bb.prototype={addLabel:function(){var a=this.axis,b=a.options,c=a.chart,d=a.categories,e=a.names,f=this.pos,g=b.labels,h=a.tickPositions,i=f===h[0],j=f===h[h.length-1],e=d?q(d[f],e[f],f):f,d=this.label,h=h.info,k;a.isDatetimeAxis&&h&&(k=b.dateTimeLabelFormats[h.higherRanks[f]||h.unitName]);this.isFirst=i;this.isLast=j;b=a.labelFormatter.call({axis:a,chart:c,isFirst:i,isLast:j,dateTimeLabelFormat:k,value:a.isLog?ka(a.lin2log(e)):e});v(d)?d&&d.attr({text:b}):(this.labelLength=(this.label=d=v(b)&&
g.enabled?c.renderer.text(b,0,0,g.useHTML).css(z(g.style)).add(a.labelGroup):null)&&d.getBBox().width,this.rotation=0)},getLabelSize:function(){return this.label?this.label.getBBox()[this.axis.horiz?"height":"width"]:0},handleOverflow:function(a){var b=this.axis,c=a.x,d=b.chart.chartWidth,e=b.chart.spacing,f=q(b.labelLeft,G(b.pos,e[3])),e=q(b.labelRight,w(b.pos+b.len,d-e[1])),g=this.label,h=this.rotation,i={left:0,center:0.5,right:1}[b.labelAlign],j=g.getBBox().width,k=b.getSlotWidth(),l=k,m=1,n,
p={};if(h)h<0&&c-i*j<f?n=y(c/ca(h*pa)-f):h>0&&c+i*j>e&&(n=y((d-c)/ca(h*pa)));else if(d=c+(1-i)*j,c-i*j<f?l=a.x+l*(1-i)-f:d>e&&(l=e-a.x+l*i,m=-1),l=G(k,l),l<k&&b.labelAlign==="center"&&(a.x+=m*(k-l-i*(k-G(j,l)))),j>l||b.autoRotation&&g.styles.width)n=l;if(n){p.width=n;if(!b.options.labels.style.textOverflow)p.textOverflow="ellipsis";g.css(p)}},getPosition:function(a,b,c,d){var e=this.axis,f=e.chart,g=d&&f.oldChartHeight||f.chartHeight;return{x:a?e.translate(b+c,null,null,d)+e.transB:e.left+e.offset+
(e.opposite?(d&&f.oldChartWidth||f.chartWidth)-e.right-e.left:0),y:a?g-e.bottom+e.offset-(e.opposite?e.height:0):g-e.translate(b+c,null,null,d)-e.transB}},getLabelPosition:function(a,b,c,d,e,f,g,h){var i=this.axis,j=i.transA,k=i.reversed,l=i.staggerLines,m=i.tickRotCorr||{x:0,y:0},n=e.y;v(n)||(n=i.side===0?c.rotation?-8:-c.getBBox().height:i.side===2?m.y+8:ca(c.rotation*pa)*(m.y-c.getBBox(!1,0).height/2));a=a+e.x+m.x-(f&&d?f*j*(k?-1:1):0);b=b+n-(f&&!d?f*j*(k?1:-1):0);l&&(c=g/(h||1)%l,i.opposite&&
(c=l-c-1),b+=c*(i.labelOffset/l));return{x:a,y:y(b)}},getMarkPath:function(a,b,c,d,e,f){return f.crispLine(["M",a,b,"L",a+(e?0:-c),b+(e?c:0)],d)},render:function(a,b,c){var d=this.axis,e=d.options,f=d.chart.renderer,g=d.horiz,h=this.type,i=this.label,j=this.pos,k=e.labels,l=this.gridLine,m=h?h+"Grid":"grid",n=h?h+"Tick":"tick",p=e[m+"LineWidth"],r=e[m+"LineColor"],s=e[m+"LineDashStyle"],m=d.tickSize(n),n=e[n+"Color"],F=this.mark,u=k.step,o=!0,D=d.tickmarkOffset,Q=this.getPosition(g,j,D,b),ha=Q.x,
Q=Q.y,v=g&&ha===d.pos+d.len||!g&&Q===d.pos?-1:1,c=q(c,1);this.isActive=!0;if(p){j=d.getPlotLinePath(j+D,p*v,b,!0);if(l===t){l={stroke:r,"stroke-width":p};if(s)l.dashstyle=s;if(!h)l.zIndex=1;if(b)l.opacity=0;this.gridLine=l=p?f.path(j).attr(l).add(d.gridGroup):null}if(!b&&l&&j)l[this.isNew?"attr":"animate"]({d:j,opacity:c})}if(m)d.opposite&&(m[0]=-m[0]),h=this.getMarkPath(ha,Q,m[0],m[1]*v,g,f),F?F.animate({d:h,opacity:c}):this.mark=f.path(h).attr({stroke:n,"stroke-width":m[1],opacity:c}).add(d.axisGroup);
if(i&&C(ha))i.xy=Q=this.getLabelPosition(ha,Q,i,g,k,D,a,u),this.isFirst&&!this.isLast&&!q(e.showFirstLabel,1)||this.isLast&&!this.isFirst&&!q(e.showLastLabel,1)?o=!1:g&&!d.isRadial&&!k.step&&!k.rotation&&!b&&c!==0&&this.handleOverflow(Q),u&&a%u&&(o=!1),o&&C(Q.y)?(Q.opacity=c,i[this.isNew?"attr":"animate"](Q),this.isNew=!1):i.attr("y",-9999)},destroy:function(){Pa(this,this.axis)}};B.PlotLineOrBand=function(a,b){this.axis=a;if(b)this.options=b,this.id=b.id};B.PlotLineOrBand.prototype={render:function(){var a=
this,b=a.axis,c=b.horiz,d=a.options,e=d.label,f=a.label,g=d.width,h=d.to,i=d.from,j=v(i)&&v(h),k=d.value,l=d.dashStyle,m=a.svgElem,n=[],p,r=d.color,s=q(d.zIndex,0),F=d.events,u={},o=b.chart.renderer,n=b.log2lin;b.isLog&&(i=n(i),h=n(h),k=n(k));if(g){if(n=b.getPlotLinePath(k,g),u={stroke:r,"stroke-width":g},l)u.dashstyle=l}else if(j){n=b.getPlotBandPath(i,h,d);if(r)u.fill=r;if(d.borderWidth)u.stroke=d.borderColor,u["stroke-width"]=d.borderWidth}else return;u.zIndex=s;if(m)if(n)m.show(),m.animate({d:n});
else{if(m.hide(),f)a.label=f=f.destroy()}else if(n&&n.length&&(a.svgElem=m=o.path(n).attr(u).add(),F))for(p in d=function(b){m.on(b,function(c){F[b].apply(a,[c])})},F)d(p);e&&v(e.text)&&n&&n.length&&b.width>0&&b.height>0&&!n.flat?(e=z({align:c&&j&&"center",x:c?!j&&4:10,verticalAlign:!c&&j&&"middle",y:c?j?16:10:j?6:-4,rotation:c&&!j&&90},e),this.renderLabel(e,n,j,s)):f&&f.hide();return a},renderLabel:function(a,b,c,d){var e=this.label,f=this.axis.chart.renderer;if(!e)e={align:a.textAlign||a.align,
rotation:a.rotation},e.zIndex=d,this.label=e=f.text(a.text,0,0,a.useHTML).attr(e).css(a.style).add();d=[b[1],b[4],c?b[6]:b[1]];b=[b[2],b[5],c?b[7]:b[2]];c=Ma(d);f=Ma(b);e.align(a,!1,{x:c,y:f,width:Da(d)-c,height:Da(b)-f});e.show()},destroy:function(){za(this.axis.plotLinesAndBands,this);delete this.axis;Pa(this)}};var J=B.Axis=function(){this.init.apply(this,arguments)};J.prototype={defaultOptions:{dateTimeLabelFormats:{millisecond:"%H:%M:%S.%L",second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%e. %b",
week:"%e. %b",month:"%b '%y",year:"%Y"},endOnTick:!1,gridLineColor:"#D8D8D8",labels:{enabled:!0,style:{color:"#606060",cursor:"default",fontSize:"11px"},x:0},lineColor:"#C0D0E0",lineWidth:1,minPadding:0.01,maxPadding:0.01,minorGridLineColor:"#E0E0E0",minorGridLineWidth:1,minorTickColor:"#A0A0A0",minorTickLength:2,minorTickPosition:"outside",startOfWeek:1,startOnTick:!1,tickColor:"#C0D0E0",tickLength:10,tickmarkPlacement:"between",tickPixelInterval:100,tickPosition:"outside",title:{align:"middle",
style:{color:"#707070"}},type:"linear"},defaultYAxisOptions:{endOnTick:!0,gridLineWidth:1,tickPixelInterval:72,showLastLabel:!0,labels:{x:-8},lineWidth:0,maxPadding:0.05,minPadding:0.05,startOnTick:!0,title:{rotation:270,text:"Values"},stackLabels:{enabled:!1,formatter:function(){return B.numberFormat(this.total,-1)},style:z(W.line.dataLabels.style,{color:"#000000"})}},defaultLeftAxisOptions:{labels:{x:-15},title:{rotation:270}},defaultRightAxisOptions:{labels:{x:15},title:{rotation:90}},defaultBottomAxisOptions:{labels:{autoRotation:[-45],
x:0},title:{rotation:0}},defaultTopAxisOptions:{labels:{autoRotation:[-45],x:0},title:{rotation:0}},init:function(a,b){var c=b.isX;this.chart=a;this.horiz=a.inverted?!c:c;this.coll=(this.isXAxis=c)?"xAxis":"yAxis";this.opposite=b.opposite;this.side=b.side||(this.horiz?this.opposite?0:2:this.opposite?1:3);this.setOptions(b);var d=this.options,e=d.type;this.labelFormatter=d.labels.formatter||this.defaultLabelFormatter;this.userOptions=b;this.minPixelPadding=0;this.reversed=d.reversed;this.visible=d.visible!==
!1;this.zoomEnabled=d.zoomEnabled!==!1;this.categories=d.categories||e==="category";this.names=this.names||[];this.isLog=e==="logarithmic";this.isDatetimeAxis=e==="datetime";this.isLinked=v(d.linkedTo);this.ticks={};this.labelEdge=[];this.minorTicks={};this.plotLinesAndBands=[];this.alternateBands={};this.len=0;this.minRange=this.userMinRange=d.minRange||d.maxZoom;this.range=d.range;this.offset=d.offset||0;this.stacks={};this.oldStacks={};this.stacksTouched=0;this.min=this.max=null;this.crosshair=
q(d.crosshair,ua(a.options.tooltip.crosshairs)[c?0:1],!1);var f,d=this.options.events;sa(this,a.axes)===-1&&(c&&!this.isColorAxis?a.axes.splice(a.xAxis.length,0,this):a.axes.push(this),a[this.coll].push(this));this.series=this.series||[];if(a.inverted&&c&&this.reversed===t)this.reversed=!0;this.removePlotLine=this.removePlotBand=this.removePlotBandOrLine;for(f in d)E(this,f,d[f]);if(this.isLog)this.val2lin=this.log2lin,this.lin2val=this.lin2log},setOptions:function(a){this.options=z(this.defaultOptions,
this.isXAxis?{}:this.defaultYAxisOptions,[this.defaultTopAxisOptions,this.defaultRightAxisOptions,this.defaultBottomAxisOptions,this.defaultLeftAxisOptions][this.side],z(R[this.coll],a))},defaultLabelFormatter:function(){var a=this.axis,b=this.value,c=a.categories,d=this.dateTimeLabelFormat,e=R.lang.numericSymbols,f=e&&e.length,g,h=a.options.labels.format,a=a.isLog?b:a.tickInterval;if(h)g=La(h,this);else if(c)g=b;else if(d)g=na(d,b);else if(f&&a>=1E3)for(;f--&&g===t;)c=Math.pow(1E3,f+1),a>=c&&b*10%
c===0&&e[f]!==null&&(g=B.numberFormat(b/c,-1)+e[f]);g===t&&(g=S(b)>=1E4?B.numberFormat(b,-1):B.numberFormat(b,-1,t,""));return g},getSeriesExtremes:function(){var a=this,b=a.chart;a.hasVisibleSeries=!1;a.dataMin=a.dataMax=a.threshold=null;a.softThreshold=!a.isXAxis;a.buildStacks&&a.buildStacks();o(a.series,function(c){if(c.visible||!b.options.chart.ignoreHiddenSeries){var d=c.options,e=d.threshold,f;a.hasVisibleSeries=!0;a.isLog&&e<=0&&(e=null);if(a.isXAxis){if(d=c.xData,d.length)c=Ma(d),!C(c)&&!(c instanceof
ba)&&(d=Fa(d,function(a){return C(a)}),c=Ma(d)),a.dataMin=G(q(a.dataMin,d[0]),c),a.dataMax=w(q(a.dataMax,d[0]),Da(d))}else{c.getExtremes();f=c.dataMax;c=c.dataMin;if(v(c)&&v(f))a.dataMin=G(q(a.dataMin,c),c),a.dataMax=w(q(a.dataMax,f),f);if(v(e))a.threshold=e;if(!d.softThreshold||a.isLog)a.softThreshold=!1}}})},translate:function(a,b,c,d,e,f){var g=this.linkedParent||this,h=1,i=0,j=d?g.oldTransA:g.transA,d=d?g.oldMin:g.min,k=g.minPixelPadding,e=(g.isOrdinal||g.isBroken||g.isLog&&e)&&g.lin2val;if(!j)j=
g.transA;if(c)h*=-1,i=g.len;g.reversed&&(h*=-1,i-=h*(g.sector||g.len));b?(a=a*h+i,a-=k,a=a/j+d,e&&(a=g.lin2val(a))):(e&&(a=g.val2lin(a)),f==="between"&&(f=0.5),a=h*(a-d)*j+i+h*k+(C(f)?j*f*g.pointRange:0));return a},toPixels:function(a,b){return this.translate(a,!1,!this.horiz,null,!0)+(b?0:this.pos)},toValue:function(a,b){return this.translate(a-(b?0:this.pos),!0,!this.horiz,null,!0)},getPlotLinePath:function(a,b,c,d,e){var f=this.chart,g=this.left,h=this.top,i,j,k=c&&f.oldChartHeight||f.chartHeight,
l=c&&f.oldChartWidth||f.chartWidth,m;i=this.transB;var n=function(a,b,c){if(a<b||a>c)d?a=G(w(b,a),c):m=!0;return a},e=q(e,this.translate(a,null,null,c)),a=c=y(e+i);i=j=y(k-e-i);C(e)?this.horiz?(i=h,j=k-this.bottom,a=c=n(a,g,g+this.width)):(a=g,c=l-this.right,i=j=n(i,h,h+this.height)):m=!0;return m&&!d?null:f.renderer.crispLine(["M",a,i,"L",c,j],b||1)},getLinearTickPositions:function(a,b,c){var d,e=ka(V(b/a)*a),f=ka(Ea(c/a)*a),g=[];if(b===c&&C(b))return[b];for(b=e;b<=f;){g.push(b);b=ka(b+a);if(b===
d)break;d=b}return g},getMinorTickPositions:function(){var a=this.options,b=this.tickPositions,c=this.minorTickInterval,d=[],e,f=this.pointRangePadding||0;e=this.min-f;var f=this.max+f,g=f-e;if(g&&g/c<this.len/3)if(this.isLog){f=b.length;for(e=1;e<f;e++)d=d.concat(this.getLogTickPositions(c,b[e-1],b[e],!0))}else if(this.isDatetimeAxis&&a.minorTickInterval==="auto")d=d.concat(this.getTimeTicks(this.normalizeTimeTickInterval(c),e,f,a.startOfWeek));else for(b=e+(b[0]-e)%c;b<=f;b+=c)d.push(b);d.length!==
0&&this.trimTicks(d,a.startOnTick,a.endOnTick);return d},adjustForMinRange:function(){var a=this.options,b=this.min,c=this.max,d,e=this.dataMax-this.dataMin>=this.minRange,f,g,h,i,j,k;if(this.isXAxis&&this.minRange===t&&!this.isLog)v(a.min)||v(a.max)?this.minRange=null:(o(this.series,function(a){i=a.xData;for(g=j=a.xIncrement?1:i.length-1;g>0;g--)if(h=i[g]-i[g-1],f===t||h<f)f=h}),this.minRange=G(f*5,this.dataMax-this.dataMin));if(c-b<this.minRange){k=this.minRange;d=(k-c+b)/2;d=[b-d,q(a.min,b-d)];
if(e)d[2]=this.dataMin;b=Da(d);c=[b+k,q(a.max,b+k)];if(e)c[2]=this.dataMax;c=Ma(c);c-b<k&&(d[0]=c-k,d[1]=q(a.min,c-k),b=Da(d))}this.min=b;this.max=c},getClosest:function(){var a;o(this.series,function(b){var c=b.closestPointRange;!b.noSharedTooltip&&v(c)&&(a=v(a)?G(a,c):c)});return a},setAxisTranslation:function(a){var b=this,c=b.max-b.min,d=b.axisPointRange||0,e,f=0,g=0,h=b.linkedParent,i=!!b.categories,j=b.transA,k=b.isXAxis;if(k||i||d)if(h?(f=h.minPointOffset,g=h.pointRangePadding):(e=b.getClosest(),
o(b.series,function(a){var c=i?1:k?q(a.options.pointRange,e,0):b.axisPointRange||0,a=a.options.pointPlacement;d=w(d,c);b.single||(f=w(f,Ca(a)?0:c/2),g=w(g,a==="on"?0:c))})),h=b.ordinalSlope&&e?b.ordinalSlope/e:1,b.minPointOffset=f*=h,b.pointRangePadding=g*=h,b.pointRange=G(d,c),k)b.closestPointRange=e;if(a)b.oldTransA=j;b.translationSlope=b.transA=j=b.len/(c+g||1);b.transB=b.horiz?b.left:b.bottom;b.minPixelPadding=j*f},minFromRange:function(){return this.max-this.range},setTickInterval:function(a){var b=
this,c=b.chart,d=b.options,e=b.isLog,f=b.log2lin,g=b.isDatetimeAxis,h=b.isXAxis,i=b.isLinked,j=d.maxPadding,k=d.minPadding,l=d.tickInterval,m=d.tickPixelInterval,n=b.categories,p=b.threshold,r=b.softThreshold,s,F,u,x;!g&&!n&&!i&&this.getTickAmount();u=q(b.userMin,d.min);x=q(b.userMax,d.max);i?(b.linkedParent=c[b.coll][d.linkedTo],c=b.linkedParent.getExtremes(),b.min=q(c.min,c.dataMin),b.max=q(c.max,c.dataMax),d.type!==b.linkedParent.options.type&&ga(11,1)):(!r&&v(p)&&(b.dataMin>=p?(s=p,k=0):b.dataMax<=
p&&(F=p,j=0)),b.min=q(u,s,b.dataMin),b.max=q(x,F,b.dataMax));if(e)!a&&G(b.min,q(b.dataMin,b.min))<=0&&ga(10,1),b.min=ka(f(b.min),15),b.max=ka(f(b.max),15);if(b.range&&v(b.max))b.userMin=b.min=u=w(b.min,b.minFromRange()),b.userMax=x=b.max,b.range=null;O(b,"foundExtremes");b.beforePadding&&b.beforePadding();b.adjustForMinRange();if(!n&&!b.axisPointRange&&!b.usePercentage&&!i&&v(b.min)&&v(b.max)&&(f=b.max-b.min))!v(u)&&k&&(b.min-=f*k),!v(x)&&j&&(b.max+=f*j);if(C(d.floor))b.min=w(b.min,d.floor);if(C(d.ceiling))b.max=
G(b.max,d.ceiling);if(r&&v(b.dataMin))if(p=p||0,!v(u)&&b.min<p&&b.dataMin>=p)b.min=p;else if(!v(x)&&b.max>p&&b.dataMax<=p)b.max=p;b.tickInterval=b.min===b.max||b.min===void 0||b.max===void 0?1:i&&!l&&m===b.linkedParent.options.tickPixelInterval?l=b.linkedParent.tickInterval:q(l,this.tickAmount?(b.max-b.min)/w(this.tickAmount-1,1):void 0,n?1:(b.max-b.min)*m/w(b.len,m));h&&!a&&o(b.series,function(a){a.processData(b.min!==b.oldMin||b.max!==b.oldMax)});b.setAxisTranslation(!0);b.beforeSetTickPositions&&
b.beforeSetTickPositions();if(b.postProcessTickInterval)b.tickInterval=b.postProcessTickInterval(b.tickInterval);if(b.pointRange&&!l)b.tickInterval=w(b.pointRange,b.tickInterval);a=q(d.minTickInterval,b.isDatetimeAxis&&b.closestPointRange);if(!l&&b.tickInterval<a)b.tickInterval=a;if(!g&&!e&&!l)b.tickInterval=Ab(b.tickInterval,null,zb(b.tickInterval),q(d.allowDecimals,!(b.tickInterval>0.5&&b.tickInterval<5&&b.max>1E3&&b.max<9999)),!!this.tickAmount);if(!this.tickAmount&&this.len)b.tickInterval=b.unsquish();
this.setTickPositions()},setTickPositions:function(){var a=this.options,b,c=a.tickPositions,d=a.tickPositioner,e=a.startOnTick,f=a.endOnTick,g;this.tickmarkOffset=this.categories&&a.tickmarkPlacement==="between"&&this.tickInterval===1?0.5:0;this.minorTickInterval=a.minorTickInterval==="auto"&&this.tickInterval?this.tickInterval/5:a.minorTickInterval;this.tickPositions=b=c&&c.slice();if(!b&&(b=this.isDatetimeAxis?this.getTimeTicks(this.normalizeTimeTickInterval(this.tickInterval,a.units),this.min,
this.max,a.startOfWeek,this.ordinalPositions,this.closestPointRange,!0):this.isLog?this.getLogTickPositions(this.tickInterval,this.min,this.max):this.getLinearTickPositions(this.tickInterval,this.min,this.max),b.length>this.len&&(b=[b[0],b.pop()]),this.tickPositions=b,d&&(d=d.apply(this,[this.min,this.max]))))this.tickPositions=b=d;if(!this.isLinked)this.trimTicks(b,e,f),this.min===this.max&&v(this.min)&&!this.tickAmount&&(g=!0,this.min-=0.5,this.max+=0.5),this.single=g,!c&&!d&&this.adjustTickAmount()},
trimTicks:function(a,b,c){var d=a[0],e=a[a.length-1],f=this.minPointOffset||0;if(b)this.min=d;else for(;this.min-f>a[0];)a.shift();if(c)this.max=e;else for(;this.max+f<a[a.length-1];)a.pop();a.length===0&&v(d)&&a.push((e+d)/2)},alignToOthers:function(){var a={},b,c=this.options;this.chart.options.chart.alignTicks!==!1&&c.alignTicks!==!1&&o(this.chart[this.coll],function(c){var e=c.options,e=[c.horiz?e.left:e.top,e.width,e.height,e.pane].join(",");c.series.length&&(a[e]?b=!0:a[e]=1)});return b},getTickAmount:function(){var a=
this.options,b=a.tickAmount,c=a.tickPixelInterval;!v(a.tickInterval)&&this.len<c&&!this.isRadial&&!this.isLog&&a.startOnTick&&a.endOnTick&&(b=2);!b&&this.alignToOthers()&&(b=Ea(this.len/c)+1);if(b<4)this.finalTickAmt=b,b=5;this.tickAmount=b},adjustTickAmount:function(){var a=this.tickInterval,b=this.tickPositions,c=this.tickAmount,d=this.finalTickAmt,e=b&&b.length;if(e<c){for(;b.length<c;)b.push(ka(b[b.length-1]+a));this.transA*=(e-1)/(c-1);this.max=b[b.length-1]}else e>c&&(this.tickInterval*=2,this.setTickPositions());
if(v(d)){for(a=c=b.length;a--;)(d===3&&a%2===1||d<=2&&a>0&&a<c-1)&&b.splice(a,1);this.finalTickAmt=t}},setScale:function(){var a,b;this.oldMin=this.min;this.oldMax=this.max;this.oldAxisLength=this.len;this.setAxisSize();b=this.len!==this.oldAxisLength;o(this.series,function(b){if(b.isDirtyData||b.isDirty||b.xAxis.isDirty)a=!0});if(b||a||this.isLinked||this.forceRedraw||this.userMin!==this.oldUserMin||this.userMax!==this.oldUserMax||this.alignToOthers()){if(this.resetStacks&&this.resetStacks(),this.forceRedraw=
!1,this.getSeriesExtremes(),this.setTickInterval(),this.oldUserMin=this.userMin,this.oldUserMax=this.userMax,!this.isDirty)this.isDirty=b||this.min!==this.oldMin||this.max!==this.oldMax}else this.cleanStacks&&this.cleanStacks()},setExtremes:function(a,b,c,d,e){var f=this,g=f.chart,c=q(c,!0);o(f.series,function(a){delete a.kdTree});e=A(e,{min:a,max:b});O(f,"setExtremes",e,function(){f.userMin=a;f.userMax=b;f.eventArgs=e;c&&g.redraw(d)})},zoom:function(a,b){var c=this.dataMin,d=this.dataMax,e=this.options,
f=G(c,q(e.min,c)),e=w(d,q(e.max,d));this.allowZoomOutside||(v(c)&&a<=f&&(a=f),v(d)&&b>=e&&(b=e));this.displayBtn=a!==t||b!==t;this.setExtremes(a,b,!1,t,{trigger:"zoom"});return!0},setAxisSize:function(){var a=this.chart,b=this.options,c=b.offsetLeft||0,d=this.horiz,e=q(b.width,a.plotWidth-c+(b.offsetRight||0)),f=q(b.height,a.plotHeight),g=q(b.top,a.plotTop),b=q(b.left,a.plotLeft+c),c=/%$/;c.test(f)&&(f=Math.round(parseFloat(f)/100*a.plotHeight));c.test(g)&&(g=Math.round(parseFloat(g)/100*a.plotHeight+
a.plotTop));this.left=b;this.top=g;this.width=e;this.height=f;this.bottom=a.chartHeight-f-g;this.right=a.chartWidth-e-b;this.len=w(d?e:f,0);this.pos=d?b:g},getExtremes:function(){var a=this.isLog,b=this.lin2log;return{min:a?ka(b(this.min)):this.min,max:a?ka(b(this.max)):this.max,dataMin:this.dataMin,dataMax:this.dataMax,userMin:this.userMin,userMax:this.userMax}},getThreshold:function(a){var b=this.isLog,c=this.lin2log,d=b?c(this.min):this.min,b=b?c(this.max):this.max;a===null?a=b<0?b:d:d>a?a=d:b<
a&&(a=b);return this.translate(a,0,1,0,1)},autoLabelAlign:function(a){a=(q(a,0)-this.side*90+720)%360;return a>15&&a<165?"right":a>195&&a<345?"left":"center"},tickSize:function(a){var b=this.options,c=b[a+"Length"],d=q(b[a+"Width"],a==="tick"&&this.isXAxis?1:0);if(d&&c)return b[a+"Position"]==="inside"&&(c=-c),[c,d]},labelMetrics:function(){return this.chart.renderer.fontMetrics(this.options.labels.style.fontSize,this.ticks[0]&&this.ticks[0].label)},unsquish:function(){var a=this.options.labels,b=
this.horiz,c=this.tickInterval,d=c,e=this.len/(((this.categories?1:0)+this.max-this.min)/c),f,g=a.rotation,h=this.labelMetrics(),i,j=Number.MAX_VALUE,k,l=function(a){a/=e||1;a=a>1?Ea(a):1;return a*c};b?(k=!a.staggerLines&&!a.step&&(v(g)?[g]:e<q(a.autoRotationLimit,80)&&a.autoRotation))&&o(k,function(a){var b;if(a===g||a&&a>=-90&&a<=90)i=l(S(h.h/la(pa*a))),b=i+S(a/360),b<j&&(j=b,f=a,d=i)}):a.step||(d=l(h.h));this.autoRotation=k;this.labelRotation=q(f,g);return d},getSlotWidth:function(){var a=this.chart,
b=this.horiz,c=this.options.labels,d=Math.max(this.tickPositions.length-(this.categories?0:1),1),e=a.margin[3];return b&&(c.step||0)<2&&!c.rotation&&(this.staggerLines||1)*a.plotWidth/d||!b&&(e&&e-a.spacing[3]||a.chartWidth*0.33)},renderUnsquish:function(){var a=this.chart,b=a.renderer,c=this.tickPositions,d=this.ticks,e=this.options.labels,f=this.horiz,g=this.getSlotWidth(),h=w(1,y(g-2*(e.padding||5))),i={},j=this.labelMetrics(),k=e.style.textOverflow,l,m=0,n,p;if(!Ca(e.rotation))i.rotation=e.rotation||
0;if(this.autoRotation)o(c,function(a){if((a=d[a])&&a.labelLength>m)m=a.labelLength}),m>h&&m>j.h?i.rotation=this.labelRotation:this.labelRotation=0;else if(g&&(l={width:h+"px"},!k)){l.textOverflow="clip";for(n=c.length;!f&&n--;)if(p=c[n],h=d[p].label)if(h.styles.textOverflow==="ellipsis"?h.css({textOverflow:"clip"}):d[p].labelLength>g&&h.css({width:g+"px"}),h.getBBox().height>this.len/c.length-(j.h-j.f))h.specCss={textOverflow:"ellipsis"}}if(i.rotation&&(l={width:(m>a.chartHeight*0.5?a.chartHeight*
0.33:a.chartHeight)+"px"},!k))l.textOverflow="ellipsis";if(this.labelAlign=e.align||this.autoLabelAlign(this.labelRotation))i.align=this.labelAlign;o(c,function(a){var b=(a=d[a])&&a.label;if(b)b.attr(i),l&&b.css(z(l,b.specCss)),delete b.specCss,a.rotation=i.rotation});this.tickRotCorr=b.rotCorr(j.b,this.labelRotation||0,this.side!==0)},hasData:function(){return this.hasVisibleSeries||v(this.min)&&v(this.max)&&!!this.tickPositions},getOffset:function(){var a=this,b=a.chart,c=b.renderer,d=a.options,
e=a.tickPositions,f=a.ticks,g=a.horiz,h=a.side,i=b.inverted?[1,0,3,2][h]:h,j,k,l=0,m,n=0,p=d.title,r=d.labels,s=0,F=a.opposite,u=b.axisOffset,b=b.clipOffset,x=[-1,1,1,-1][h],D,Q=a.axisParent,ha=this.tickSize("tick");j=a.hasData();a.showAxis=k=j||q(d.showEmpty,!0);a.staggerLines=a.horiz&&r.staggerLines;if(!a.axisGroup)a.gridGroup=c.g("grid").attr({zIndex:d.gridZIndex||1}).add(Q),a.axisGroup=c.g("axis").attr({zIndex:d.zIndex||2}).add(Q),a.labelGroup=c.g("axis-labels").attr({zIndex:r.zIndex||7}).addClass("highcharts-"+
a.coll.toLowerCase()+"-labels").add(Q);if(j||a.isLinked){if(o(e,function(b){f[b]?f[b].addLabel():f[b]=new bb(a,b)}),a.renderUnsquish(),r.reserveSpace!==!1&&(h===0||h===2||{1:"left",3:"right"}[h]===a.labelAlign||a.labelAlign==="center")&&o(e,function(a){s=w(f[a].getLabelSize(),s)}),a.staggerLines)s*=a.staggerLines,a.labelOffset=s*(a.opposite?-1:1)}else for(D in f)f[D].destroy(),delete f[D];if(p&&p.text&&p.enabled!==!1){if(!a.axisTitle)(D=p.textAlign)||(D=(g?{low:"left",middle:"center",high:"right"}:
{low:F?"right":"left",middle:"center",high:F?"left":"right"})[p.align]),a.axisTitle=c.text(p.text,0,0,p.useHTML).attr({zIndex:7,rotation:p.rotation||0,align:D}).addClass("highcharts-"+this.coll.toLowerCase()+"-title").css(p.style).add(a.axisGroup),a.axisTitle.isNew=!0;if(k)l=a.axisTitle.getBBox()[g?"height":"width"],m=p.offset,n=v(m)?0:q(p.margin,g?5:10);a.axisTitle[k?"show":"hide"](!0)}a.offset=x*q(d.offset,u[h]);a.tickRotCorr=a.tickRotCorr||{x:0,y:0};c=h===0?-a.labelMetrics().h:h===2?a.tickRotCorr.y:
0;n=Math.abs(s)+n;s&&(n-=c,n+=x*(g?q(r.y,a.tickRotCorr.y+x*8):r.x));a.axisTitleMargin=q(m,n);u[h]=w(u[h],a.axisTitleMargin+l+x*a.offset,n,j&&e.length&&ha?ha[0]:0);d=d.offset?0:V(d.lineWidth/2)*2;b[i]=w(b[i],d)},getLinePath:function(a){var b=this.chart,c=this.opposite,d=this.offset,e=this.horiz,f=this.left+(c?this.width:0)+d,d=b.chartHeight-this.bottom-(c?this.height:0)+d;c&&(a*=-1);return b.renderer.crispLine(["M",e?this.left:f,e?d:this.top,"L",e?b.chartWidth-this.right:f,e?d:b.chartHeight-this.bottom],
a)},getTitlePosition:function(){var a=this.horiz,b=this.left,c=this.top,d=this.len,e=this.options.title,f=a?b:c,g=this.opposite,h=this.offset,i=e.x||0,j=e.y||0,k=K(e.style.fontSize||12),d={low:f+(a?0:d),middle:f+d/2,high:f+(a?d:0)}[e.align],b=(a?c+this.height:b)+(a?1:-1)*(g?-1:1)*this.axisTitleMargin+(this.side===2?k:0);return{x:a?d+i:b+(g?this.width:0)+h+i,y:a?b+j-(g?this.height:0)+h:d+j}},render:function(){var a=this,b=a.chart,c=b.renderer,d=a.options,e=a.isLog,f=a.lin2log,g=a.isLinked,h=a.tickPositions,
i=a.axisTitle,j=a.ticks,k=a.minorTicks,l=a.alternateBands,m=d.stackLabels,n=d.alternateGridColor,p=a.tickmarkOffset,r=d.lineWidth,s,q=b.hasRendered&&C(a.oldMin),u=a.showAxis,x=gb(c.globalAnimation),D,Q;a.labelEdge.length=0;a.overlap=!1;o([j,k,l],function(a){for(var b in a)a[b].isActive=!1});if(a.hasData()||g){a.minorTickInterval&&!a.categories&&o(a.getMinorTickPositions(),function(b){k[b]||(k[b]=new bb(a,b,"minor"));q&&k[b].isNew&&k[b].render(null,!0);k[b].render(null,!1,1)});if(h.length&&(o(h,function(b,
c){if(!g||b>=a.min&&b<=a.max)j[b]||(j[b]=new bb(a,b)),q&&j[b].isNew&&j[b].render(c,!0,0.1),j[b].render(c)}),p&&(a.min===0||a.single)))j[-1]||(j[-1]=new bb(a,-1,null,!0)),j[-1].render(-1);n&&o(h,function(c,d){Q=h[d+1]!==t?h[d+1]+p:a.max-p;if(d%2===0&&c<a.max&&Q<=a.max+(b.polar?-p:p))l[c]||(l[c]=new B.PlotLineOrBand(a)),D=c+p,l[c].options={from:e?f(D):D,to:e?f(Q):Q,color:n},l[c].render(),l[c].isActive=!0});if(!a._addedPlotLB)o((d.plotLines||[]).concat(d.plotBands||[]),function(b){a.addPlotBandOrLine(b)}),
a._addedPlotLB=!0}o([j,k,l],function(a){var c,d,e=[],f=x.duration;for(c in a)if(!a[c].isActive)a[c].render(c,!1,0),a[c].isActive=!1,e.push(c);Za(function(){for(d=e.length;d--;)a[e[d]]&&!a[e[d]].isActive&&(a[e[d]].destroy(),delete a[e[d]])},a===l||!b.hasRendered||!f?0:f)});if(r)s=a.getLinePath(r),a.axisLine?a.axisLine.animate({d:s}):a.axisLine=c.path(s).attr({stroke:d.lineColor,"stroke-width":r,zIndex:7}).add(a.axisGroup),a.axisLine[u?"show":"hide"](!0);if(i&&u)i[i.isNew?"attr":"animate"](a.getTitlePosition()),
i.isNew=!1;m&&m.enabled&&a.renderStackTotals();a.isDirty=!1},redraw:function(){this.visible&&(this.render(),o(this.plotLinesAndBands,function(a){a.render()}));o(this.series,function(a){a.isDirty=!0})},destroy:function(a){var b=this,c=b.stacks,d,e=b.plotLinesAndBands;a||T(b);for(d in c)Pa(c[d]),c[d]=null;o([b.ticks,b.minorTicks,b.alternateBands],function(a){Pa(a)});for(a=e.length;a--;)e[a].destroy();o("stackTotalGroup,axisLine,axisTitle,axisGroup,cross,gridGroup,labelGroup".split(","),function(a){b[a]&&
(b[a]=b[a].destroy())});this.cross&&this.cross.destroy()},drawCrosshair:function(a,b){var c,d=this.crosshair,e,f;if(!this.crosshair||(v(b)||!q(d.snap,!0))===!1)this.hideCrosshair();else if(q(d.snap,!0)?v(b)&&(c=this.isXAxis?b.plotX:this.len-b.plotY):c=this.horiz?a.chartX-this.pos:this.len-a.chartY+this.pos,c=this.isRadial?this.getPlotLinePath(this.isXAxis?b.x:q(b.stackY,b.y))||null:this.getPlotLinePath(null,null,null,null,c)||null,c===null)this.hideCrosshair();else if(e=this.categories&&!this.isRadial,
f=q(d.width,e?this.transA:1),this.cross)this.cross.attr({d:c,visibility:"visible","stroke-width":f});else{e={"pointer-events":"none","stroke-width":f,stroke:d.color||(e?"rgba(155,200,255,0.2)":"#C0C0C0"),zIndex:q(d.zIndex,2)};if(d.dashStyle)e.dashstyle=d.dashStyle;this.cross=this.chart.renderer.path(c).attr(e).add()}},hideCrosshair:function(){this.cross&&this.cross.hide()}};A(J.prototype,{getPlotBandPath:function(a,b){var c=this.getPlotLinePath(b,null,null,!0),d=this.getPlotLinePath(a,null,null,!0);
d&&c?(d.flat=d.toString()===c.toString(),d.push(c[4],c[5],c[1],c[2])):d=null;return d},addPlotBand:function(a){return this.addPlotBandOrLine(a,"plotBands")},addPlotLine:function(a){return this.addPlotBandOrLine(a,"plotLines")},addPlotBandOrLine:function(a,b){var c=(new B.PlotLineOrBand(this,a)).render(),d=this.userOptions;c&&(b&&(d[b]=d[b]||[],d[b].push(a)),this.plotLinesAndBands.push(c));return c},removePlotBandOrLine:function(a){for(var b=this.plotLinesAndBands,c=this.options,d=this.userOptions,
e=b.length;e--;)b[e].id===a&&b[e].destroy();o([c.plotLines||[],d.plotLines||[],c.plotBands||[],d.plotBands||[]],function(b){for(e=b.length;e--;)b[e].id===a&&za(b,b[e])})}});J.prototype.getTimeTicks=function(a,b,c,d){var e=[],f={},g=R.global.useUTC,h,i=new ba(b-eb(b)),j=a.unitRange,k=a.count;if(v(b)){i[Pb](j>=M.second?0:k*V(i.getMilliseconds()/k));if(j>=M.second)i[Qb](j>=M.minute?0:k*V(i.getSeconds()/k));if(j>=M.minute)i[Rb](j>=M.hour?0:k*V(i[Bb]()/k));if(j>=M.hour)i[Sb](j>=M.day?0:k*V(i[Cb]()/k));
if(j>=M.day)i[qb](j>=M.month?1:k*V(i[ab]()/k));j>=M.month&&(i[Eb](j>=M.year?0:k*V(i[hb]()/k)),h=i[ib]());j>=M.year&&(h-=h%k,i[Fb](h));if(j===M.week)i[qb](i[ab]()-i[Db]()+q(d,1));b=1;if(yb||fb)i=i.getTime(),i=new ba(i+eb(i));h=i[ib]();for(var d=i.getTime(),l=i[hb](),m=i[ab](),n=!g||!!fb,p=(M.day+(g?eb(i):i.getTimezoneOffset()*6E4))%M.day;d<c;)e.push(d),j===M.year?d=pb(h+b*k,0):j===M.month?d=pb(h,l+b*k):n&&(j===M.day||j===M.week)?d=pb(h,l,m+b*k*(j===M.day?1:7)):d+=j*k,b++;e.push(d);o(Fa(e,function(a){return j<=
M.hour&&a%M.day===p}),function(a){f[a]="day"})}e.info=A(a,{higherRanks:f,totalRange:j*k});return e};J.prototype.normalizeTimeTickInterval=function(a,b){var c=b||[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1,2]],["week",[1,2]],["month",[1,2,3,4,6]],["year",null]],d=c[c.length-1],e=M[d[0]],f=d[1],g;for(g=0;g<c.length;g++)if(d=c[g],e=M[d[0]],f=d[1],c[g+1]&&a<=(e*f[f.length-1]+M[c[g+1][0]])/2)break;e===M.year&&
a<5*e&&(f=[1,2,5]);c=Ab(a/e,f,d[0]==="year"?w(zb(a/e),1):1);return{unitRange:e,count:c,unitName:d[0]}};J.prototype.getLogTickPositions=function(a,b,c,d){var e=this.options,f=this.len,g=this.lin2log,h=this.log2lin,i=[];if(!d)this._minorAutoInterval=null;if(a>=0.5)a=y(a),i=this.getLinearTickPositions(a,b,c);else if(a>=0.08)for(var f=V(b),j,k,l,m,n,e=a>0.3?[1,2,4]:a>0.15?[1,2,4,6,8]:[1,2,3,4,5,6,7,8,9];f<c+1&&!n;f++){k=e.length;for(j=0;j<k&&!n;j++)l=h(g(f)*e[j]),l>b&&(!d||m<=c)&&m!==t&&i.push(m),m>c&&
(n=!0),m=l}else if(b=g(b),c=g(c),a=e[d?"minorTickInterval":"tickInterval"],a=q(a==="auto"?null:a,this._minorAutoInterval,(c-b)*(e.tickPixelInterval/(d?5:1))/((d?f/this.tickPositions.length:f)||1)),a=Ab(a,null,zb(a)),i=ta(this.getLinearTickPositions(a,b,c),h),!d)this._minorAutoInterval=a/5;if(!d)this.tickInterval=a;return i};J.prototype.log2lin=function(a){return Y.log(a)/Y.LN10};J.prototype.lin2log=function(a){return Y.pow(10,a)};var Lb=B.Tooltip=function(){this.init.apply(this,arguments)};Lb.prototype=
{init:function(a,b){var c=b.borderWidth,d=b.style,e=K(d.padding);this.chart=a;this.options=b;this.crosshairs=[];this.now={x:0,y:0};this.isHidden=!0;this.label=a.renderer.label("",0,0,b.shape||"callout",null,null,b.useHTML,null,"tooltip").attr({padding:e,fill:b.backgroundColor,"stroke-width":c,r:b.borderRadius,zIndex:8}).css(d).css({padding:0}).add().attr({y:-9999});qa||this.label.shadow(b.shadow);this.shared=b.shared},destroy:function(){if(this.label)this.label=this.label.destroy();clearTimeout(this.hideTimer);
clearTimeout(this.tooltipTimeout)},move:function(a,b,c,d){var e=this,f=e.now,g=e.options.animation!==!1&&!e.isHidden&&(S(a-f.x)>1||S(b-f.y)>1),h=e.followPointer||e.len>1;A(f,{x:g?(2*f.x+a)/3:a,y:g?(f.y+b)/2:b,anchorX:h?t:g?(2*f.anchorX+c)/3:c,anchorY:h?t:g?(f.anchorY+d)/2:d});e.label.attr(f);if(g)clearTimeout(this.tooltipTimeout),this.tooltipTimeout=setTimeout(function(){e&&e.move(a,b,c,d)},32)},hide:function(a){var b=this;clearTimeout(this.hideTimer);a=q(a,this.options.hideDelay,500);if(!this.isHidden)this.hideTimer=
Za(function(){b.label[a?"fadeOut":"hide"]();b.isHidden=!0},a)},getAnchor:function(a,b){var c,d=this.chart,e=d.inverted,f=d.plotTop,g=d.plotLeft,h=0,i=0,j,k,a=ua(a);c=a[0].tooltipPos;this.followPointer&&b&&(b.chartX===t&&(b=d.pointer.normalize(b)),c=[b.chartX-d.plotLeft,b.chartY-f]);c||(o(a,function(a){j=a.series.yAxis;k=a.series.xAxis;h+=a.plotX+(!e&&k?k.left-g:0);i+=(a.plotLow?(a.plotLow+a.plotHigh)/2:a.plotY)+(!e&&j?j.top-f:0)}),h/=a.length,i/=a.length,c=[e?d.plotWidth-i:h,this.shared&&!e&&a.length>
1&&b?b.chartY-f:e?d.plotHeight-h:i]);return ta(c,y)},getPosition:function(a,b,c){var d=this.chart,e=this.distance,f={},g=c.h||0,h,i=["y",d.chartHeight,b,c.plotY+d.plotTop,d.plotTop,d.plotTop+d.plotHeight],j=["x",d.chartWidth,a,c.plotX+d.plotLeft,d.plotLeft,d.plotLeft+d.plotWidth],k=!this.followPointer&&q(c.ttBelow,!d.inverted===!!c.negative),l=function(a,b,c,d,h,i){var j=c<d-e,m=d+e+c<b,l=d-e-c;d+=e;if(k&&m)f[a]=d;else if(!k&&j)f[a]=l;else if(j)f[a]=G(i-c,l-g<0?l:l-g);else if(m)f[a]=w(h,d+g+c>b?d:
d+g);else return!1},m=function(a,b,c,d){var g;d<e||d>b-e?g=!1:f[a]=d<c/2?1:d>b-c/2?b-c-2:d-c/2;return g},n=function(a){var b=i;i=j;j=b;h=a},p=function(){l.apply(0,i)!==!1?m.apply(0,j)===!1&&!h&&(n(!0),p()):h?f.x=f.y=0:(n(!0),p())};(d.inverted||this.len>1)&&n();p();return f},defaultFormatter:function(a){var b=this.points||ua(this),c;c=[a.tooltipFooterHeaderFormatter(b[0])];c=c.concat(a.bodyFormatter(b));c.push(a.tooltipFooterHeaderFormatter(b[0],!0));return c.join("")},refresh:function(a,b){var c=
this.chart,d=this.label,e=this.options,f,g,h,i={},j,k=[];j=e.formatter||this.defaultFormatter;var i=c.hoverPoints,l,m=this.shared;clearTimeout(this.hideTimer);this.followPointer=ua(a)[0].series.tooltipOptions.followPointer;h=this.getAnchor(a,b);f=h[0];g=h[1];m&&(!a.series||!a.series.noSharedTooltip)?(c.hoverPoints=a,i&&o(i,function(a){a.setState()}),o(a,function(a){a.setState("hover");k.push(a.getLabelConfig())}),i={x:a[0].category,y:a[0].y},i.points=k,this.len=k.length,a=a[0]):i=a.getLabelConfig();
j=j.call(i,this);i=a.series;this.distance=q(i.tooltipOptions.distance,16);j===!1?this.hide():(this.isHidden&&(Sa(d),d.attr("opacity",1).show()),d.attr({text:j}),l=e.borderColor||a.color||i.color||"#606060",d.attr({stroke:l}),this.updatePosition({plotX:f,plotY:g,negative:a.negative,ttBelow:a.ttBelow,h:h[2]||0}),this.isHidden=!1);O(c,"tooltipRefresh",{text:j,x:f+c.plotLeft,y:g+c.plotTop,borderColor:l})},updatePosition:function(a){var b=this.chart,c=this.label,c=(this.options.positioner||this.getPosition).call(this,
c.width,c.height,a);this.move(y(c.x),y(c.y||0),a.plotX+b.plotLeft,a.plotY+b.plotTop)},getXDateFormat:function(a,b,c){var d,b=b.dateTimeLabelFormats,e=c&&c.closestPointRange,f,g={millisecond:15,second:12,minute:9,hour:6,day:3},h,i="millisecond";if(e){h=na("%m-%d %H:%M:%S.%L",a.x);for(f in M){if(e===M.week&&+na("%w",a.x)===c.options.startOfWeek&&h.substr(6)==="00:00:00.000"){f="week";break}if(M[f]>e){f=i;break}if(g[f]&&h.substr(g[f])!=="01-01 00:00:00.000".substr(g[f]))break;f!=="week"&&(i=f)}f&&(d=
b[f])}else d=b.day;return d||b.year},tooltipFooterHeaderFormatter:function(a,b){var c=b?"footer":"header",d=a.series,e=d.tooltipOptions,f=e.xDateFormat,g=d.xAxis,h=g&&g.options.type==="datetime"&&C(a.key),c=e[c+"Format"];h&&!f&&(f=this.getXDateFormat(a,e,g));h&&f&&(c=c.replace("{point.key}","{point.key:"+f+"}"));return La(c,{point:a,series:d})},bodyFormatter:function(a){return ta(a,function(a){var c=a.series.tooltipOptions;return(c.pointFormatter||a.point.tooltipFormatter).call(a.point,c.pointFormat)})}};
var oa;cb=H&&H.documentElement.ontouchstart!==t;var Ya=B.Pointer=function(a,b){this.init(a,b)};Ya.prototype={init:function(a,b){var c=b.chart,d=c.events,e=qa?"":c.zoomType,c=a.inverted,f;this.options=b;this.chart=a;this.zoomX=f=/x/.test(e);this.zoomY=e=/y/.test(e);this.zoomHor=f&&!c||e&&c;this.zoomVert=e&&!c||f&&c;this.hasZoom=f||e;this.runChartClick=d&&!!d.click;this.pinchDown=[];this.lastValidTouch={};if(B.Tooltip&&b.tooltip.enabled)a.tooltip=new Lb(a,b.tooltip),this.followTouchMove=q(b.tooltip.followTouchMove,
!0);this.setDOMEvents()},normalize:function(a,b){var c,d,a=a||L.event;if(!a.target)a.target=a.srcElement;d=a.touches?a.touches.length?a.touches.item(0):a.changedTouches[0]:a;if(!b)this.chartPosition=b=Jb(this.chart.container);d.pageX===t?(c=w(a.x,a.clientX-b.left),d=a.y):(c=d.pageX-b.left,d=d.pageY-b.top);return A(a,{chartX:y(c),chartY:y(d)})},getCoordinates:function(a){var b={xAxis:[],yAxis:[]};o(this.chart.axes,function(c){b[c.isXAxis?"xAxis":"yAxis"].push({axis:c,value:c.toValue(a[c.horiz?"chartX":
"chartY"])})});return b},runPointActions:function(a){var b=this.chart,c=b.series,d=b.tooltip,e=d?d.shared:!1,f=b.hoverPoint,g=b.hoverSeries,h,i=[Number.MAX_VALUE,Number.MAX_VALUE],j,k,l=[],m=[],n;if(!e&&!g)for(h=0;h<c.length;h++)if(c[h].directTouch||!c[h].options.stickyTracking)c=[];g&&(e?g.noSharedTooltip:g.directTouch)&&f?m=[f]:(o(c,function(b){j=b.noSharedTooltip&&e;k=!e&&b.directTouch;b.visible&&!j&&!k&&q(b.options.enableMouseTracking,!0)&&(n=b.searchPoint(a,!j&&b.kdDimensions===1))&&l.push(n)}),
o(l,function(a){a&&o(["dist","distX"],function(b,c){if(C(a[b])){var d=a[b]===i[c]&&a.series.group.zIndex>=m[c].series.group.zIndex;if(a[b]<i[c]||d)i[c]=a[b],m[c]=a}})}));if(e)for(h=l.length;h--;)(l[h].clientX!==m[1].clientX||l[h].series.noSharedTooltip)&&l.splice(h,1);if(m[0]&&(m[0]!==this.prevKDPoint||d&&d.isHidden))if(e&&!m[0].series.noSharedTooltip)l.length&&d&&d.refresh(l,a),o(l,function(b){b.onMouseOver(a,b!==(g&&g.directTouch&&f||m[0]))}),this.prevKDPoint=m[1];else{d&&d.refresh(m[0],a);if(!g||
!g.directTouch)m[0].onMouseOver(a);this.prevKDPoint=m[0]}else c=g&&g.tooltipOptions.followPointer,d&&c&&!d.isHidden&&(c=d.getAnchor([{}],a),d.updatePosition({plotX:c[0],plotY:c[1]}));if(!this._onDocumentMouseMove)this._onDocumentMouseMove=function(a){if($[oa])$[oa].pointer.onDocumentMouseMove(a)},E(H,"mousemove",this._onDocumentMouseMove);o(e?l:[q(f,m[1])],function(c){o(b.axes,function(b){(!c||c.series[b.coll]===b)&&b.drawCrosshair(a,c)})})},reset:function(a,b){var c=this.chart,d=c.hoverSeries,e=
c.hoverPoint,f=c.hoverPoints,g=c.tooltip,h=g&&g.shared?f:e;a&&h&&o(ua(h),function(b){b.series.isCartesian&&b.plotX===void 0&&(a=!1)});if(a)g&&h&&(g.refresh(h),e&&(e.setState(e.state,!0),o(c.axes,function(a){q(a.crosshair&&a.crosshair.snap,!0)?a.drawCrosshair(null,e):a.hideCrosshair()})));else{if(e)e.onMouseOut();f&&o(f,function(a){a.setState()});if(d)d.onMouseOut();g&&g.hide(b);if(this._onDocumentMouseMove)T(H,"mousemove",this._onDocumentMouseMove),this._onDocumentMouseMove=null;o(c.axes,function(a){a.hideCrosshair()});
this.hoverX=c.hoverPoints=c.hoverPoint=null}},scaleGroups:function(a,b){var c=this.chart,d;o(c.series,function(e){d=a||e.getPlotBox();e.xAxis&&e.xAxis.zoomEnabled&&(e.group.attr(d),e.markerGroup&&(e.markerGroup.attr(d),e.markerGroup.clip(b?c.clipRect:null)),e.dataLabelsGroup&&e.dataLabelsGroup.attr(d))});c.clipRect.attr(b||c.clipBox)},dragStart:function(a){var b=this.chart;b.mouseIsDown=a.type;b.cancelClick=!1;b.mouseDownX=this.mouseDownX=a.chartX;b.mouseDownY=this.mouseDownY=a.chartY},drag:function(a){var b=
this.chart,c=b.options.chart,d=a.chartX,e=a.chartY,f=this.zoomHor,g=this.zoomVert,h=b.plotLeft,i=b.plotTop,j=b.plotWidth,k=b.plotHeight,l,m=this.selectionMarker,n=this.mouseDownX,p=this.mouseDownY,r=c.panKey&&a[c.panKey+"Key"];if(!m||!m.touch)if(d<h?d=h:d>h+j&&(d=h+j),e<i?e=i:e>i+k&&(e=i+k),this.hasDragged=Math.sqrt(Math.pow(n-d,2)+Math.pow(p-e,2)),this.hasDragged>10){l=b.isInsidePlot(n-h,p-i);if(b.hasCartesianSeries&&(this.zoomX||this.zoomY)&&l&&!r&&!m)this.selectionMarker=m=b.renderer.rect(h,i,
f?1:j,g?1:k,0).attr({fill:c.selectionMarkerFill||"rgba(69,114,167,0.25)",zIndex:7}).add();m&&f&&(d-=n,m.attr({width:S(d),x:(d>0?0:d)+n}));m&&g&&(d=e-p,m.attr({height:S(d),y:(d>0?0:d)+p}));l&&!m&&c.panning&&b.pan(a,c.panning)}},drop:function(a){var b=this,c=this.chart,d=this.hasPinched;if(this.selectionMarker){var e={originalEvent:a,xAxis:[],yAxis:[]},f=this.selectionMarker,g=f.attr?f.attr("x"):f.x,h=f.attr?f.attr("y"):f.y,i=f.attr?f.attr("width"):f.width,j=f.attr?f.attr("height"):f.height,k;if(this.hasDragged||
d)o(c.axes,function(c){if(c.zoomEnabled&&v(c.min)&&(d||b[{xAxis:"zoomX",yAxis:"zoomY"}[c.coll]])){var f=c.horiz,n=a.type==="touchend"?c.minPixelPadding:0,p=c.toValue((f?g:h)+n),f=c.toValue((f?g+i:h+j)-n);e[c.coll].push({axis:c,min:G(p,f),max:w(p,f)});k=!0}}),k&&O(c,"selection",e,function(a){c.zoom(A(a,d?{animation:!1}:null))});this.selectionMarker=this.selectionMarker.destroy();d&&this.scaleGroups()}if(c)N(c.container,{cursor:c._cursor}),c.cancelClick=this.hasDragged>10,c.mouseIsDown=this.hasDragged=
this.hasPinched=!1,this.pinchDown=[]},onContainerMouseDown:function(a){a=this.normalize(a);a.preventDefault&&a.preventDefault();this.dragStart(a)},onDocumentMouseUp:function(a){$[oa]&&$[oa].pointer.drop(a)},onDocumentMouseMove:function(a){var b=this.chart,c=this.chartPosition,a=this.normalize(a,c);c&&!this.inClass(a.target,"highcharts-tracker")&&!b.isInsidePlot(a.chartX-b.plotLeft,a.chartY-b.plotTop)&&this.reset()},onContainerMouseLeave:function(a){var b=$[oa];if(b&&(a.relatedTarget||a.toElement))b.pointer.reset(),
b.pointer.chartPosition=null},onContainerMouseMove:function(a){var b=this.chart;if(!v(oa)||!$[oa]||!$[oa].mouseIsDown)oa=b.index;a=this.normalize(a);a.returnValue=!1;b.mouseIsDown==="mousedown"&&this.drag(a);(this.inClass(a.target,"highcharts-tracker")||b.isInsidePlot(a.chartX-b.plotLeft,a.chartY-b.plotTop))&&!b.openMenu&&this.runPointActions(a)},inClass:function(a,b){for(var c;a;){if(c=X(a,"class")){if(c.indexOf(b)!==-1)return!0;if(c.indexOf("highcharts-container")!==-1)return!1}a=a.parentNode}},
onTrackerMouseOut:function(a){var b=this.chart.hoverSeries,a=a.relatedTarget||a.toElement;if(b&&a&&!b.options.stickyTracking&&!this.inClass(a,"highcharts-tooltip")&&!this.inClass(a,"highcharts-series-"+b.index))b.onMouseOut()},onContainerClick:function(a){var b=this.chart,c=b.hoverPoint,d=b.plotLeft,e=b.plotTop,a=this.normalize(a);b.cancelClick||(c&&this.inClass(a.target,"highcharts-tracker")?(O(c.series,"click",A(a,{point:c})),b.hoverPoint&&c.firePointEvent("click",a)):(A(a,this.getCoordinates(a)),
b.isInsidePlot(a.chartX-d,a.chartY-e)&&O(b,"click",a)))},setDOMEvents:function(){var a=this,b=a.chart.container;b.onmousedown=function(b){a.onContainerMouseDown(b)};b.onmousemove=function(b){a.onContainerMouseMove(b)};b.onclick=function(b){a.onContainerClick(b)};E(b,"mouseleave",a.onContainerMouseLeave);kb===1&&E(H,"mouseup",a.onDocumentMouseUp);if(cb)b.ontouchstart=function(b){a.onContainerTouchStart(b)},b.ontouchmove=function(b){a.onContainerTouchMove(b)},kb===1&&E(H,"touchend",a.onDocumentTouchEnd)},
destroy:function(){var a;T(this.chart.container,"mouseleave",this.onContainerMouseLeave);kb||(T(H,"mouseup",this.onDocumentMouseUp),T(H,"touchend",this.onDocumentTouchEnd));clearInterval(this.tooltipTimeout);for(a in this)this[a]=null}};A(B.Pointer.prototype,{pinchTranslate:function(a,b,c,d,e,f){(this.zoomHor||this.pinchHor)&&this.pinchTranslateDirection(!0,a,b,c,d,e,f);(this.zoomVert||this.pinchVert)&&this.pinchTranslateDirection(!1,a,b,c,d,e,f)},pinchTranslateDirection:function(a,b,c,d,e,f,g,h){var i=
this.chart,j=a?"x":"y",k=a?"X":"Y",l="chart"+k,m=a?"width":"height",n=i["plot"+(a?"Left":"Top")],p,r,s=h||1,q=i.inverted,o=i.bounds[a?"h":"v"],x=b.length===1,D=b[0][l],v=c[0][l],w=!x&&b[1][l],y=!x&&c[1][l],t,c=function(){!x&&S(D-w)>20&&(s=h||S(v-y)/S(D-w));r=(n-v)/s+D;p=i["plot"+(a?"Width":"Height")]/s};c();b=r;b<o.min?(b=o.min,t=!0):b+p>o.max&&(b=o.max-p,t=!0);t?(v-=0.8*(v-g[j][0]),x||(y-=0.8*(y-g[j][1])),c()):g[j]=[v,y];q||(f[j]=r-n,f[m]=p);f=q?1/s:s;e[m]=p;e[j]=b;d[q?a?"scaleY":"scaleX":"scale"+
k]=s;d["translate"+k]=f*n+(v-f*D)},pinch:function(a){var b=this,c=b.chart,d=b.pinchDown,e=a.touches,f=e.length,g=b.lastValidTouch,h=b.hasZoom,i=b.selectionMarker,j={},k=f===1&&(b.inClass(a.target,"highcharts-tracker")&&c.runTrackerClick||b.runChartClick),l={};if(f>1)b.initiated=!0;h&&b.initiated&&!k&&a.preventDefault();ta(e,function(a){return b.normalize(a)});if(a.type==="touchstart")o(e,function(a,b){d[b]={chartX:a.chartX,chartY:a.chartY}}),g.x=[d[0].chartX,d[1]&&d[1].chartX],g.y=[d[0].chartY,d[1]&&
d[1].chartY],o(c.axes,function(a){if(a.zoomEnabled){var b=c.bounds[a.horiz?"h":"v"],d=a.minPixelPadding,e=a.toPixels(q(a.options.min,a.dataMin)),f=a.toPixels(q(a.options.max,a.dataMax)),g=G(e,f),e=w(e,f);b.min=G(a.pos,g-d);b.max=w(a.pos+a.len,e+d)}}),b.res=!0;else if(d.length){if(!i)b.selectionMarker=i=A({destroy:ra,touch:!0},c.plotBox);b.pinchTranslate(d,e,j,i,l,g);b.hasPinched=h;b.scaleGroups(j,l);if(!h&&b.followTouchMove&&f===1)this.runPointActions(b.normalize(a));else if(b.res)b.res=!1,this.reset(!1,
0)}},touch:function(a,b){var c=this.chart,d;oa=c.index;if(a.touches.length===1)if(a=this.normalize(a),c.isInsidePlot(a.chartX-c.plotLeft,a.chartY-c.plotTop)&&!c.openMenu){b&&this.runPointActions(a);if(a.type==="touchmove")c=this.pinchDown,d=c[0]?Math.sqrt(Math.pow(c[0].chartX-a.chartX,2)+Math.pow(c[0].chartY-a.chartY,2))>=4:!1;q(d,!0)&&this.pinch(a)}else b&&this.reset();else a.touches.length===2&&this.pinch(a)},onContainerTouchStart:function(a){this.touch(a,!0)},onContainerTouchMove:function(a){this.touch(a)},
onDocumentTouchEnd:function(a){$[oa]&&$[oa].pointer.drop(a)}});if(L.PointerEvent||L.MSPointerEvent){var Ga={},Mb=!!L.PointerEvent,ac=function(){var a,b=[];b.item=function(a){return this[a]};for(a in Ga)Ga.hasOwnProperty(a)&&b.push({pageX:Ga[a].pageX,pageY:Ga[a].pageY,target:Ga[a].target});return b},Nb=function(a,b,c,d){if((a.pointerType==="touch"||a.pointerType===a.MSPOINTER_TYPE_TOUCH)&&$[oa])d(a),d=$[oa].pointer,d[b]({type:c,target:a.currentTarget,preventDefault:ra,touches:ac()})};A(Ya.prototype,
{onContainerPointerDown:function(a){Nb(a,"onContainerTouchStart","touchstart",function(a){Ga[a.pointerId]={pageX:a.pageX,pageY:a.pageY,target:a.currentTarget}})},onContainerPointerMove:function(a){Nb(a,"onContainerTouchMove","touchmove",function(a){Ga[a.pointerId]={pageX:a.pageX,pageY:a.pageY};if(!Ga[a.pointerId].target)Ga[a.pointerId].target=a.currentTarget})},onDocumentPointerUp:function(a){Nb(a,"onDocumentTouchEnd","touchend",function(a){delete Ga[a.pointerId]})},batchMSEvents:function(a){a(this.chart.container,
Mb?"pointerdown":"MSPointerDown",this.onContainerPointerDown);a(this.chart.container,Mb?"pointermove":"MSPointerMove",this.onContainerPointerMove);a(H,Mb?"pointerup":"MSPointerUp",this.onDocumentPointerUp)}});U(Ya.prototype,"init",function(a,b,c){a.call(this,b,c);this.hasZoom&&N(b.container,{"-ms-touch-action":"none","touch-action":"none"})});U(Ya.prototype,"setDOMEvents",function(a){a.apply(this);(this.hasZoom||this.followTouchMove)&&this.batchMSEvents(E)});U(Ya.prototype,"destroy",function(a){this.batchMSEvents(T);
a.call(this)})}var ub=B.Legend=function(a,b){this.init(a,b)};ub.prototype={init:function(a,b){var c=this,d=b.itemStyle,e=b.itemMarginTop||0;this.options=b;if(b.enabled)c.itemStyle=d,c.itemHiddenStyle=z(d,b.itemHiddenStyle),c.itemMarginTop=e,c.padding=d=q(b.padding,8),c.initialItemX=d,c.initialItemY=d-5,c.maxItemWidth=0,c.chart=a,c.itemHeight=0,c.symbolWidth=q(b.symbolWidth,16),c.pages=[],c.render(),E(c.chart,"endResize",function(){c.positionCheckboxes()})},colorizeItem:function(a,b){var c=this.options,
d=a.legendItem,e=a.legendLine,f=a.legendSymbol,g=this.itemHiddenStyle.color,c=b?c.itemStyle.color:g,h=b?a.legendColor||a.color||"#CCC":g,g=a.options&&a.options.marker,i={fill:h},j;d&&d.css({fill:c,color:c});e&&e.attr({stroke:h});if(f){if(g&&f.isMarker)for(j in i.stroke=h,g=a.convertAttribs(g),g)d=g[j],d!==t&&(i[j]=d);f.attr(i)}},positionItem:function(a){var b=this.options,c=b.symbolPadding,b=!b.rtl,d=a._legendItemPos,e=d[0],d=d[1],f=a.checkbox;(a=a.legendGroup)&&a.element&&a.translate(b?e:this.legendWidth-
e-2*c-4,d);if(f)f.x=e,f.y=d},destroyItem:function(a){var b=a.checkbox;o(["legendItem","legendLine","legendSymbol","legendGroup"],function(b){a[b]&&(a[b]=a[b].destroy())});b&&Ua(a.checkbox)},destroy:function(){var a=this.group,b=this.box;if(b)this.box=b.destroy();if(a)this.group=a.destroy()},positionCheckboxes:function(a){var b=this.group.alignAttr,c,d=this.clipHeight||this.legendHeight,e=this.titleHeight;if(b)c=b.translateY,o(this.allItems,function(f){var g=f.checkbox,h;g&&(h=c+e+g.y+(a||0)+3,N(g,
{left:b.translateX+f.checkboxOffset+g.x-20+"px",top:h+"px",display:h>c-6&&h<c+d-6?"":"none"}))})},renderTitle:function(){var a=this.padding,b=this.options.title,c=0;if(b.text){if(!this.title)this.title=this.chart.renderer.label(b.text,a-3,a-4,null,null,null,null,null,"legend-title").attr({zIndex:1}).css(b.style).add(this.group);a=this.title.getBBox();c=a.height;this.offsetWidth=a.width;this.contentGroup.attr({translateY:c})}this.titleHeight=c},setText:function(a){var b=this.options;a.legendItem.attr({text:b.labelFormat?
La(b.labelFormat,a):b.labelFormatter.call(a)})},renderItem:function(a){var b=this.chart,c=b.renderer,d=this.options,e=d.layout==="horizontal",f=this.symbolWidth,g=d.symbolPadding,h=this.itemStyle,i=this.itemHiddenStyle,j=this.padding,k=e?q(d.itemDistance,20):0,l=!d.rtl,m=d.width,n=d.itemMarginBottom||0,p=this.itemMarginTop,r=this.initialItemX,s=a.legendItem,o=a.series&&a.series.drawLegendSymbol?a.series:a,u=o.options,u=this.createCheckboxForItem&&u&&u.showCheckbox,x=d.useHTML;if(!s){a.legendGroup=
c.g("legend-item").attr({zIndex:1}).add(this.scrollGroup);a.legendItem=s=c.text("",l?f+g:-g,this.baseline||0,x).css(z(a.visible?h:i)).attr({align:l?"left":"right",zIndex:2}).add(a.legendGroup);if(!this.baseline)this.fontMetrics=c.fontMetrics(h.fontSize,s),this.baseline=this.fontMetrics.f+3+p,s.attr("y",this.baseline);o.drawLegendSymbol(this,a);this.setItemEvents&&this.setItemEvents(a,s,x,h,i);u&&this.createCheckboxForItem(a)}this.colorizeItem(a,a.visible);this.setText(a);c=s.getBBox();f=a.checkboxOffset=
d.itemWidth||a.legendItemWidth||f+g+c.width+k+(u?20:0);this.itemHeight=g=y(a.legendItemHeight||c.height);if(e&&this.itemX-r+f>(m||b.chartWidth-2*j-r-d.x))this.itemX=r,this.itemY+=p+this.lastLineHeight+n,this.lastLineHeight=0;this.maxItemWidth=w(this.maxItemWidth,f);this.lastItemY=p+this.itemY+n;this.lastLineHeight=w(g,this.lastLineHeight);a._legendItemPos=[this.itemX,this.itemY];e?this.itemX+=f:(this.itemY+=p+g+n,this.lastLineHeight=g);this.offsetWidth=m||w((e?this.itemX-r-k:f)+j,this.offsetWidth)},
getAllItems:function(){var a=[];o(this.chart.series,function(b){var c=b.options;if(q(c.showInLegend,!v(c.linkedTo)?t:!1,!0))a=a.concat(b.legendItems||(c.legendType==="point"?b.data:b))});return a},adjustMargins:function(a,b){var c=this.chart,d=this.options,e=d.align.charAt(0)+d.verticalAlign.charAt(0)+d.layout.charAt(0);this.display&&!d.floating&&o([/(lth|ct|rth)/,/(rtv|rm|rbv)/,/(rbh|cb|lbh)/,/(lbv|lm|ltv)/],function(f,g){f.test(e)&&!v(a[g])&&(c[tb[g]]=w(c[tb[g]],c.legend[(g+1)%2?"legendHeight":
"legendWidth"]+[1,-1,-1,1][g]*d[g%2?"x":"y"]+q(d.margin,12)+b[g]))})},render:function(){var a=this,b=a.chart,c=b.renderer,d=a.group,e,f,g,h,i=a.box,j=a.options,k=a.padding,l=j.borderWidth,m=j.backgroundColor;a.itemX=a.initialItemX;a.itemY=a.initialItemY;a.offsetWidth=0;a.lastItemY=0;if(!d)a.group=d=c.g("legend").attr({zIndex:7}).add(),a.contentGroup=c.g().attr({zIndex:1}).add(d),a.scrollGroup=c.g().add(a.contentGroup);a.renderTitle();e=a.getAllItems();nb(e,function(a,b){return(a.options&&a.options.legendIndex||
0)-(b.options&&b.options.legendIndex||0)});j.reversed&&e.reverse();a.allItems=e;a.display=f=!!e.length;a.lastLineHeight=0;o(e,function(b){a.renderItem(b)});g=(j.width||a.offsetWidth)+k;h=a.lastItemY+a.lastLineHeight+a.titleHeight;h=a.handleOverflow(h);h+=k;if(l||m){if(i){if(g>0&&h>0)i[i.isNew?"attr":"animate"](i.crisp({width:g,height:h})),i.isNew=!1}else a.box=i=c.rect(0,0,g,h,j.borderRadius,l||0).attr({stroke:j.borderColor,"stroke-width":l||0,fill:m||"none"}).add(d).shadow(j.shadow),i.isNew=!0;i[f?
"show":"hide"]()}a.legendWidth=g;a.legendHeight=h;o(e,function(b){a.positionItem(b)});f&&d.align(A({width:g,height:h},j),!0,"spacingBox");b.isResizing||this.positionCheckboxes()},handleOverflow:function(a){var b=this,c=this.chart,d=c.renderer,e=this.options,f=e.y,f=c.spacingBox.height+(e.verticalAlign==="top"?-f:f)-this.padding,g=e.maxHeight,h,i=this.clipRect,j=e.navigation,k=q(j.animation,!0),l=j.arrowSize||12,m=this.nav,n=this.pages,p=this.padding,r,s=this.allItems,F=function(a){i.attr({height:a});
if(b.contentGroup.div)b.contentGroup.div.style.clip="rect("+p+"px,9999px,"+(p+a)+"px,0)"};e.layout==="horizontal"&&(f/=2);g&&(f=G(f,g));n.length=0;if(a>f&&j.enabled!==!1){this.clipHeight=h=w(f-20-this.titleHeight-p,0);this.currentPage=q(this.currentPage,1);this.fullHeight=a;o(s,function(a,b){var c=a._legendItemPos[1],d=y(a.legendItem.getBBox().height),e=n.length;if(!e||c-n[e-1]>h&&(r||c)!==n[e-1])n.push(r||c),e++;b===s.length-1&&c+d-n[e-1]>h&&n.push(c);c!==r&&(r=c)});if(!i)i=b.clipRect=d.clipRect(0,
p,9999,0),b.contentGroup.clip(i);F(h);if(!m)this.nav=m=d.g().attr({zIndex:1}).add(this.group),this.up=d.symbol("triangle",0,0,l,l).on("click",function(){b.scroll(-1,k)}).add(m),this.pager=d.text("",15,10).css(j.style).add(m),this.down=d.symbol("triangle-down",0,0,l,l).on("click",function(){b.scroll(1,k)}).add(m);b.scroll(0);a=f}else if(m)F(c.chartHeight),m.hide(),this.scrollGroup.attr({translateY:1}),this.clipHeight=0;return a},scroll:function(a,b){var c=this.pages,d=c.length,e=this.currentPage+a,
f=this.clipHeight,g=this.options.navigation,h=g.activeColor,g=g.inactiveColor,i=this.pager,j=this.padding;e>d&&(e=d);if(e>0)b!==t&&$a(b,this.chart),this.nav.attr({translateX:j,translateY:f+this.padding+7+this.titleHeight,visibility:"visible"}),this.up.attr({fill:e===1?g:h}).css({cursor:e===1?"default":"pointer"}),i.attr({text:e+"/"+d}),this.down.attr({x:18+this.pager.getBBox().width,fill:e===d?g:h}).css({cursor:e===d?"default":"pointer"}),c=-c[e-1]+this.initialItemY,this.scrollGroup.animate({translateY:c}),
this.currentPage=e,this.positionCheckboxes(c)}};aa=B.LegendSymbolMixin={drawRectangle:function(a,b){var c=a.options.symbolHeight||a.fontMetrics.f;b.legendSymbol=this.chart.renderer.rect(0,a.baseline-c+1,a.symbolWidth,c,a.options.symbolRadius||0).attr({zIndex:3}).add(b.legendGroup)},drawLineMarker:function(a){var b=this.options,c=b.marker,d=a.symbolWidth,e=this.chart.renderer,f=this.legendGroup,a=a.baseline-y(a.fontMetrics.b*0.3),g;if(b.lineWidth){g={"stroke-width":b.lineWidth};if(b.dashStyle)g.dashstyle=
b.dashStyle;this.legendLine=e.path(["M",0,a,"L",d,a]).attr(g).add(f)}if(c&&c.enabled!==!1)b=c.radius,this.legendSymbol=c=e.symbol(this.symbol,d/2-b,a-b,2*b,2*b,c).add(f),c.isMarker=!0}};(/Trident\/7\.0/.test(Na)||Wa)&&U(ub.prototype,"positionItem",function(a,b){var c=this,d=function(){b._legendItemPos&&a.call(c,b)};d();setTimeout(d)});var Ba=B.Chart=function(){this.getArgs.apply(this,arguments)};B.chart=function(a,b,c){return new Ba(a,b,c)};Ba.prototype={callbacks:[],getArgs:function(){var a=[].slice.call(arguments);
if(Ca(a[0])||a[0].nodeName)this.renderTo=a.shift();this.init(a[0],a[1])},init:function(a,b){var c,d=a.series;a.series=null;c=z(R,a);c.series=a.series=d;this.userOptions=a;d=c.chart;this.margin=this.splashArray("margin",d);this.spacing=this.splashArray("spacing",d);var e=d.events;this.bounds={h:{},v:{}};this.callback=b;this.isResizing=0;this.options=c;this.axes=[];this.series=[];this.hasCartesianSeries=d.showAxes;var f=this,g;f.index=$.length;$.push(f);kb++;d.reflow!==!1&&E(f,"load",function(){f.initReflow()});
if(e)for(g in e)E(f,g,e[g]);f.xAxis=[];f.yAxis=[];f.animation=qa?!1:q(d.animation,!0);f.pointCount=f.colorCounter=f.symbolCounter=0;f.firstRender()},initSeries:function(a){var b=this.options.chart;(b=I[a.type||b.type||b.defaultSeriesType])||ga(17,!0);b=new b;b.init(this,a);return b},isInsidePlot:function(a,b,c){var d=c?b:a,a=c?a:b;return d>=0&&d<=this.plotWidth&&a>=0&&a<=this.plotHeight},redraw:function(a){var b=this.axes,c=this.series,d=this.pointer,e=this.legend,f=this.isDirtyLegend,g,h,i=this.hasCartesianSeries,
j=this.isDirtyBox,k=c.length,l=k,m=this.renderer,n=m.isHidden(),p=[];$a(a,this);n&&this.cloneRenderTo();for(this.layOutTitles();l--;)if(a=c[l],a.options.stacking&&(g=!0,a.isDirty)){h=!0;break}if(h)for(l=k;l--;)if(a=c[l],a.options.stacking)a.isDirty=!0;o(c,function(a){a.isDirty&&a.options.legendType==="point"&&(a.updateTotals&&a.updateTotals(),f=!0);a.isDirtyData&&O(a,"updatedData")});if(f&&e.options.enabled)e.render(),this.isDirtyLegend=!1;g&&this.getStacks();if(i&&!this.isResizing)this.maxTicks=
null,o(b,function(a){a.setScale()});this.getMargins();i&&(o(b,function(a){a.isDirty&&(j=!0)}),o(b,function(a){var b=a.min+","+a.max;if(a.extKey!==b)a.extKey=b,p.push(function(){O(a,"afterSetExtremes",A(a.eventArgs,a.getExtremes()));delete a.eventArgs});(j||g)&&a.redraw()}));j&&this.drawChartBox();o(c,function(a){a.isDirty&&a.visible&&(!a.isCartesian||a.xAxis)&&a.redraw()});d&&d.reset(!0);m.draw();O(this,"redraw");n&&this.cloneRenderTo(!0);o(p,function(a){a.call()})},get:function(a){var b=this.axes,
c=this.series,d,e;for(d=0;d<b.length;d++)if(b[d].options.id===a)return b[d];for(d=0;d<c.length;d++)if(c[d].options.id===a)return c[d];for(d=0;d<c.length;d++){e=c[d].points||[];for(b=0;b<e.length;b++)if(e[b].id===a)return e[b]}return null},getAxes:function(){var a=this,b=this.options,c=b.xAxis=ua(b.xAxis||{}),b=b.yAxis=ua(b.yAxis||{});o(c,function(a,b){a.index=b;a.isX=!0});o(b,function(a,b){a.index=b});c=c.concat(b);o(c,function(b){new J(a,b)})},getSelectedPoints:function(){var a=[];o(this.series,
function(b){a=a.concat(Fa(b.points||[],function(a){return a.selected}))});return a},getSelectedSeries:function(){return Fa(this.series,function(a){return a.selected})},setTitle:function(a,b,c){var g;var d=this,e=d.options,f;f=e.title=z(e.title,a);g=e.subtitle=z(e.subtitle,b),e=g;o([["title",a,f],["subtitle",b,e]],function(a){var b=a[0],c=d[b],e=a[1],a=a[2];c&&e&&(d[b]=c=c.destroy());a&&a.text&&!c&&(d[b]=d.renderer.text(a.text,0,0,a.useHTML).attr({align:a.align,"class":"highcharts-"+b,zIndex:a.zIndex||
4}).css(a.style).add())});d.layOutTitles(c)},layOutTitles:function(a){var b=0,c=this.title,d=this.subtitle,e=this.options,f=e.title,e=e.subtitle,g=this.renderer,h=this.spacingBox;if(c&&(c.css({width:(f.width||h.width+f.widthAdjust)+"px"}).align(A({y:g.fontMetrics(f.style.fontSize,c).b-3},f),!1,h),!f.floating&&!f.verticalAlign))b=c.getBBox().height;d&&(d.css({width:(e.width||h.width+e.widthAdjust)+"px"}).align(A({y:b+(f.margin-13)+g.fontMetrics(e.style.fontSize,c).b},e),!1,h),!e.floating&&!e.verticalAlign&&
(b=Ea(b+d.getBBox().height)));c=this.titleOffset!==b;this.titleOffset=b;if(!this.isDirtyBox&&c)this.isDirtyBox=c,this.hasRendered&&q(a,!0)&&this.isDirtyBox&&this.redraw()},getChartSize:function(){var a=this.options.chart,b=a.width,a=a.height,c=this.renderToClone||this.renderTo;if(!v(b))this.containerWidth=wa(c,"width");if(!v(a))this.containerHeight=wa(c,"height");this.chartWidth=w(0,b||this.containerWidth||600);this.chartHeight=w(0,q(a,this.containerHeight>19?this.containerHeight:400))},cloneRenderTo:function(a){var b=
this.renderToClone,c=this.container;a?b&&(this.renderTo.appendChild(c),Ua(b),delete this.renderToClone):(c&&c.parentNode===this.renderTo&&this.renderTo.removeChild(c),this.renderToClone=b=this.renderTo.cloneNode(0),N(b,{position:"absolute",top:"-9999px",display:"block"}),b.style.setProperty&&b.style.setProperty("display","block","important"),H.body.appendChild(b),c&&b.appendChild(c))},getContainer:function(){var a,b=this.options,c=b.chart,d,e;a=this.renderTo;var f="highcharts-"+Ib++;if(!a)this.renderTo=
a=c.renderTo;if(Ca(a))this.renderTo=a=H.getElementById(a);a||ga(13,!0);d=K(X(a,"data-highcharts-chart"));C(d)&&$[d]&&$[d].hasRendered&&$[d].destroy();X(a,"data-highcharts-chart",this.index);a.innerHTML="";!c.skipClone&&!a.offsetWidth&&this.cloneRenderTo();this.getChartSize();d=this.chartWidth;e=this.chartHeight;this.container=a=fa(Va,{className:"highcharts-container"+(c.className?" "+c.className:""),id:f},A({position:"relative",overflow:"hidden",width:d+"px",height:e+"px",textAlign:"left",lineHeight:"normal",
zIndex:0,"-webkit-tap-highlight-color":"rgba(0,0,0,0)"},c.style),this.renderToClone||a);this._cursor=a.style.cursor;this.renderer=new (B[c.renderer]||Xa)(a,d,e,c.style,c.forExport,b.exporting&&b.exporting.allowHTML);qa&&this.renderer.create(this,a,d,e);this.renderer.chartIndex=this.index},getMargins:function(a){var b=this.spacing,c=this.margin,d=this.titleOffset;this.resetMargins();if(d&&!v(c[0]))this.plotTop=w(this.plotTop,d+this.options.title.margin+b[0]);this.legend.adjustMargins(c,b);this.extraBottomMargin&&
(this.marginBottom+=this.extraBottomMargin);this.extraTopMargin&&(this.plotTop+=this.extraTopMargin);a||this.getAxisMargins()},getAxisMargins:function(){var a=this,b=a.axisOffset=[0,0,0,0],c=a.margin;a.hasCartesianSeries&&o(a.axes,function(a){a.visible&&a.getOffset()});o(tb,function(d,e){v(c[e])||(a[d]+=b[e])});a.setChartSize()},reflow:function(a){var b=this,c=b.options.chart,d=b.renderTo,e=c.width||wa(d,"width"),f=c.height||wa(d,"height"),c=a?a.target:L;if(!b.hasUserSize&&!b.isPrinting&&e&&f&&(c===
L||c===H)){if(e!==b.containerWidth||f!==b.containerHeight)clearTimeout(b.reflowTimeout),b.reflowTimeout=Za(function(){if(b.container)b.setSize(e,f,!1),b.hasUserSize=null},a?100:0);b.containerWidth=e;b.containerHeight=f}},initReflow:function(){var a=this,b=function(b){a.reflow(b)};E(L,"resize",b);E(a,"destroy",function(){T(L,"resize",b)})},setSize:function(a,b,c){var d=this,e,f,g=d.renderer;d.isResizing+=1;$a(c,d);d.oldChartHeight=d.chartHeight;d.oldChartWidth=d.chartWidth;if(v(a))d.chartWidth=e=w(0,
y(a)),d.hasUserSize=!!e;if(v(b))d.chartHeight=f=w(0,y(b));a=g.globalAnimation;(a?db:N)(d.container,{width:e+"px",height:f+"px"},a);d.setChartSize(!0);g.setSize(e,f,c);d.maxTicks=null;o(d.axes,function(a){a.isDirty=!0;a.setScale()});o(d.series,function(a){a.isDirty=!0});d.isDirtyLegend=!0;d.isDirtyBox=!0;d.layOutTitles();d.getMargins();d.redraw(c);d.oldChartHeight=null;O(d,"resize");Za(function(){d&&O(d,"endResize",null,function(){d.isResizing-=1})},gb(a).duration)},setChartSize:function(a){var b=
this.inverted,c=this.renderer,d=this.chartWidth,e=this.chartHeight,f=this.options.chart,g=this.spacing,h=this.clipOffset,i,j,k,l;this.plotLeft=i=y(this.plotLeft);this.plotTop=j=y(this.plotTop);this.plotWidth=k=w(0,y(d-i-this.marginRight));this.plotHeight=l=w(0,y(e-j-this.marginBottom));this.plotSizeX=b?l:k;this.plotSizeY=b?k:l;this.plotBorderWidth=f.plotBorderWidth||0;this.spacingBox=c.spacingBox={x:g[3],y:g[0],width:d-g[3]-g[1],height:e-g[0]-g[2]};this.plotBox=c.plotBox={x:i,y:j,width:k,height:l};
d=2*V(this.plotBorderWidth/2);b=Ea(w(d,h[3])/2);c=Ea(w(d,h[0])/2);this.clipBox={x:b,y:c,width:V(this.plotSizeX-w(d,h[1])/2-b),height:w(0,V(this.plotSizeY-w(d,h[2])/2-c))};a||o(this.axes,function(a){a.setAxisSize();a.setAxisTranslation()})},resetMargins:function(){var a=this;o(tb,function(b,c){a[b]=q(a.margin[c],a.spacing[c])});a.axisOffset=[0,0,0,0];a.clipOffset=[0,0,0,0]},drawChartBox:function(){var a=this.options.chart,b=this.renderer,c=this.chartWidth,d=this.chartHeight,e=this.chartBackground,
f=this.plotBackground,g=this.plotBorder,h=this.plotBGImage,i=a.borderWidth||0,j=a.backgroundColor,k=a.plotBackgroundColor,l=a.plotBackgroundImage,m=a.plotBorderWidth||0,n,p=this.plotLeft,r=this.plotTop,s=this.plotWidth,q=this.plotHeight,o=this.plotBox,x=this.clipRect,D=this.clipBox;n=i+(a.shadow?8:0);if(i||j)if(e)e.animate(e.crisp({width:c-n,height:d-n}));else{e={fill:j||"none"};if(i)e.stroke=a.borderColor,e["stroke-width"]=i;this.chartBackground=b.rect(n/2,n/2,c-n,d-n,a.borderRadius,i).attr(e).addClass("highcharts-background").add().shadow(a.shadow)}if(k)f?
f.animate(o):this.plotBackground=b.rect(p,r,s,q,0).attr({fill:k}).add().shadow(a.plotShadow);if(l)h?h.animate(o):this.plotBGImage=b.image(l,p,r,s,q).add();x?x.animate({width:D.width,height:D.height}):this.clipRect=b.clipRect(D);if(m)g?(g.strokeWidth=-m,g.animate(g.crisp({x:p,y:r,width:s,height:q}))):this.plotBorder=b.rect(p,r,s,q,0,-m).attr({stroke:a.plotBorderColor,"stroke-width":m,fill:"none",zIndex:1}).add();this.isDirtyBox=!1},propFromSeries:function(){var a=this,b=a.options.chart,c,d=a.options.series,
e,f;o(["inverted","angular","polar"],function(g){c=I[b.type||b.defaultSeriesType];f=a[g]||b[g]||c&&c.prototype[g];for(e=d&&d.length;!f&&e--;)(c=I[d[e].type])&&c.prototype[g]&&(f=!0);a[g]=f})},linkSeries:function(){var a=this,b=a.series;o(b,function(a){a.linkedSeries.length=0});o(b,function(b){var d=b.options.linkedTo;if(Ca(d)&&(d=d===":previous"?a.series[b.index-1]:a.get(d)))d.linkedSeries.push(b),b.linkedParent=d,b.visible=q(b.options.visible,d.options.visible,b.visible)})},renderSeries:function(){o(this.series,
function(a){a.translate();a.render()})},renderLabels:function(){var a=this,b=a.options.labels;b.items&&o(b.items,function(c){var d=A(b.style,c.style),e=K(d.left)+a.plotLeft,f=K(d.top)+a.plotTop+12;delete d.left;delete d.top;a.renderer.text(c.html,e,f).attr({zIndex:2}).css(d).add()})},render:function(){var a=this.axes,b=this.renderer,c=this.options,d,e,f,g;this.setTitle();this.legend=new ub(this,c.legend);this.getStacks&&this.getStacks();this.getMargins(!0);this.setChartSize();d=this.plotWidth;e=this.plotHeight-=
21;o(a,function(a){a.setScale()});this.getAxisMargins();f=d/this.plotWidth>1.1;g=e/this.plotHeight>1.05;if(f||g)this.maxTicks=null,o(a,function(a){(a.horiz&&f||!a.horiz&&g)&&a.setTickInterval(!0)}),this.getMargins();this.drawChartBox();this.hasCartesianSeries&&o(a,function(a){a.visible&&a.render()});if(!this.seriesGroup)this.seriesGroup=b.g("series-group").attr({zIndex:3}).add();this.renderSeries();this.renderLabels();this.showCredits(c.credits);this.hasRendered=!0},showCredits:function(a){if(a.enabled&&
!this.credits)this.credits=this.renderer.text(a.text,0,0).on("click",function(){if(a.href)L.location.href=a.href}).attr({align:a.position.align,zIndex:8}).css(a.style).add().align(a.position)},destroy:function(){var a=this,b=a.axes,c=a.series,d=a.container,e,f=d&&d.parentNode;O(a,"destroy");$[a.index]=t;kb--;a.renderTo.removeAttribute("data-highcharts-chart");T(a);for(e=b.length;e--;)b[e]=b[e].destroy();for(e=c.length;e--;)c[e]=c[e].destroy();o("title,subtitle,chartBackground,plotBackground,plotBGImage,plotBorder,seriesGroup,clipRect,credits,pointer,scroller,rangeSelector,legend,resetZoomButton,tooltip,renderer".split(","),
function(b){var c=a[b];c&&c.destroy&&(a[b]=c.destroy())});if(d)d.innerHTML="",T(d),f&&Ua(d);for(e in a)delete a[e]},isReadyToRender:function(){var a=this;return!ja&&L==L.top&&H.readyState!=="complete"||qa&&!L.canvg?(qa?Wb.push(function(){a.firstRender()},a.options.global.canvasToolsURL):H.attachEvent("onreadystatechange",function(){H.detachEvent("onreadystatechange",a.firstRender);H.readyState==="complete"&&a.firstRender()}),!1):!0},firstRender:function(){var a=this,b=a.options;if(a.isReadyToRender()){a.getContainer();
O(a,"init");a.resetMargins();a.setChartSize();a.propFromSeries();a.getAxes();o(b.series||[],function(b){a.initSeries(b)});a.linkSeries();O(a,"beforeRender");if(B.Pointer)a.pointer=new Ya(a,b);a.render();a.renderer.draw();if(!a.renderer.imgCount&&a.onload)a.onload();a.cloneRenderTo(!0)}},onload:function(){var a=this;o([this.callback].concat(this.callbacks),function(b){b&&a.index!==void 0&&b.apply(a,[a])});O(a,"load");this.onload=null},splashArray:function(a,b){var c=b[a],c=ea(c)?c:[c,c,c,c];return[q(b[a+
"Top"],c[0]),q(b[a+"Right"],c[1]),q(b[a+"Bottom"],c[2]),q(b[a+"Left"],c[3])]}};var bc=B.CenteredSeriesMixin={getCenter:function(){var a=this.options,b=this.chart,c=2*(a.slicedOffset||0),d=b.plotWidth-2*c,b=b.plotHeight-2*c,e=a.center,e=[q(e[0],"50%"),q(e[1],"50%"),a.size||"100%",a.innerSize||0],f=G(d,b),g,h;for(g=0;g<4;++g)h=e[g],a=g<2||g===2&&/%$/.test(h),e[g]=(/%$/.test(h)?[d,b,f,e[2]][g]*parseFloat(h)/100:parseFloat(h))+(a?c:0);e[3]>e[2]&&(e[3]=e[2]);return e}},Ha=function(){};Ha.prototype={init:function(a,
b,c){this.series=a;this.color=a.color;this.applyOptions(b,c);this.pointAttr={};if(a.options.colorByPoint&&(b=a.options.colors||a.chart.options.colors,this.color=this.color||b[a.colorCounter++],a.colorCounter===b.length))a.colorCounter=0;a.chart.pointCount++;return this},applyOptions:function(a,b){var c=this.series,d=c.options.pointValKey||c.pointValKey,a=Ha.prototype.optionsToObject.call(this,a);A(this,a);this.options=this.options?A(this.options,a):a;if(d)this.y=this[d];this.isNull=this.x===null||
this.y===null;if(this.x===void 0&&c)this.x=b===void 0?c.autoIncrement():b;return this},optionsToObject:function(a){var b={},c=this.series,d=c.options.keys,e=d||c.pointArrayMap||["y"],f=e.length,g=0,h=0;if(C(a)||a===null)b[e[0]]=a;else if(Ja(a)){if(!d&&a.length>f){c=typeof a[0];if(c==="string")b.name=a[0];else if(c==="number")b.x=a[0];g++}for(;h<f;){if(!d||a[g]!==void 0)b[e[h]]=a[g];g++;h++}}else if(typeof a==="object"){b=a;if(a.dataLabels)c._hasPointLabels=!0;if(a.marker)c._hasPointMarkers=!0}return b},
destroy:function(){var a=this.series.chart,b=a.hoverPoints,c;a.pointCount--;if(b&&(this.setState(),za(b,this),!b.length))a.hoverPoints=null;if(this===a.hoverPoint)this.onMouseOut();if(this.graphic||this.dataLabel)T(this),this.destroyElements();this.legendItem&&a.legend.destroyItem(this);for(c in this)this[c]=null},destroyElements:function(){for(var a=["graphic","dataLabel","dataLabelUpper","connector","shadowGroup"],b,c=6;c--;)b=a[c],this[b]&&(this[b]=this[b].destroy())},getLabelConfig:function(){return{x:this.category,
y:this.y,color:this.color,key:this.name||this.category,series:this.series,point:this,percentage:this.percentage,total:this.total||this.stackTotal}},tooltipFormatter:function(a){var b=this.series,c=b.tooltipOptions,d=q(c.valueDecimals,""),e=c.valuePrefix||"",f=c.valueSuffix||"";o(b.pointArrayMap||["y"],function(b){b="{point."+b;if(e||f)a=a.replace(b+"}",e+b+"}"+f);a=a.replace(b+"}",b+":,."+d+"f}")});return La(a,{point:this,series:this.series})},firePointEvent:function(a,b,c){var d=this,e=this.series.options;
(e.point.events[a]||d.options&&d.options.events&&d.options.events[a])&&this.importEvents();a==="click"&&e.allowPointSelect&&(c=function(a){d.select&&d.select(null,a.ctrlKey||a.metaKey||a.shiftKey)});O(this,a,b,c)},visible:!0};var P=B.Series=function(){};P.prototype={isCartesian:!0,type:"line",pointClass:Ha,sorted:!0,requireSorting:!0,pointAttrToOptions:{stroke:"lineColor","stroke-width":"lineWidth",fill:"fillColor",r:"radius"},directTouch:!1,axisTypes:["xAxis","yAxis"],colorCounter:0,parallelArrays:["x",
"y"],init:function(a,b){var c=this,d,e,f=a.series,g=function(a,b){return q(a.options.index,a._i)-q(b.options.index,b._i)};c.chart=a;c.options=b=c.setOptions(b);c.linkedSeries=[];c.bindAxes();A(c,{name:b.name,state:"",pointAttr:{},visible:b.visible!==!1,selected:b.selected===!0});if(qa)b.animation=!1;e=b.events;for(d in e)E(c,d,e[d]);if(e&&e.click||b.point&&b.point.events&&b.point.events.click||b.allowPointSelect)a.runTrackerClick=!0;c.getColor();c.getSymbol();o(c.parallelArrays,function(a){c[a+"Data"]=
[]});c.setData(b.data,!1);if(c.isCartesian)a.hasCartesianSeries=!0;f.push(c);c._i=f.length-1;nb(f,g);this.yAxis&&nb(this.yAxis.series,g);o(f,function(a,b){a.index=b;a.name=a.name||"Series "+(b+1)})},bindAxes:function(){var a=this,b=a.options,c=a.chart,d;o(a.axisTypes||[],function(e){o(c[e],function(c){d=c.options;if(b[e]===d.index||b[e]!==t&&b[e]===d.id||b[e]===t&&d.index===0)c.series.push(a),a[e]=c,c.isDirty=!0});!a[e]&&a.optionalAxis!==e&&ga(18,!0)})},updateParallelArrays:function(a,b){var c=a.series,
d=arguments,e=C(b)?function(d){var e=d==="y"&&c.toYData?c.toYData(a):a[d];c[d+"Data"][b]=e}:function(a){Array.prototype[b].apply(c[a+"Data"],Array.prototype.slice.call(d,2))};o(c.parallelArrays,e)},autoIncrement:function(){var a=this.options,b=this.xIncrement,c,d=a.pointIntervalUnit,b=q(b,a.pointStart,0);this.pointInterval=c=q(this.pointInterval,a.pointInterval,1);d&&(a=new ba(b),d==="day"?a=+a[qb](a[ab]()+c):d==="month"?a=+a[Eb](a[hb]()+c):d==="year"&&(a=+a[Fb](a[ib]()+c)),c=a-b);this.xIncrement=
b+c;return b},setOptions:function(a){var b=this.chart,c=b.options.plotOptions,b=b.userOptions||{},d=b.plotOptions||{},e=c[this.type];this.userOptions=a;c=z(e,c.series,a);this.tooltipOptions=z(R.tooltip,R.plotOptions[this.type].tooltip,b.tooltip,d.series&&d.series.tooltip,d[this.type]&&d[this.type].tooltip,a.tooltip);e.marker===null&&delete c.marker;this.zoneAxis=c.zoneAxis;a=this.zones=(c.zones||[]).slice();if((c.negativeColor||c.negativeFillColor)&&!c.zones)a.push({value:c[this.zoneAxis+"Threshold"]||
c.threshold||0,color:c.negativeColor,fillColor:c.negativeFillColor});a.length&&v(a[a.length-1].value)&&a.push({color:this.color,fillColor:this.fillColor});return c},getCyclic:function(a,b,c){var d=this.userOptions,e="_"+a+"Index",f=a+"Counter";b||(v(d[e])?b=d[e]:(d[e]=b=this.chart[f]%c.length,this.chart[f]+=1),b=c[b]);this[a]=b},getColor:function(){this.options.colorByPoint?this.options.color=null:this.getCyclic("color",this.options.color||W[this.type].color,this.chart.options.colors)},getSymbol:function(){var a=
this.options.marker;this.getCyclic("symbol",a.symbol,this.chart.options.symbols);if(/^url/.test(this.symbol))a.radius=0},drawLegendSymbol:aa.drawLineMarker,setData:function(a,b,c,d){var e=this,f=e.points,g=f&&f.length||0,h,i=e.options,j=e.chart,k=null,l=e.xAxis,m=l&&!!l.categories,n=i.turboThreshold,p=this.xData,r=this.yData,s=(h=e.pointArrayMap)&&h.length,a=a||[];h=a.length;b=q(b,!0);if(d!==!1&&h&&g===h&&!e.cropped&&!e.hasGroupedData&&e.visible)o(a,function(a,b){f[b].update&&a!==i.data[b]&&f[b].update(a,
!1,null,!1)});else{e.xIncrement=null;e.colorCounter=0;o(this.parallelArrays,function(a){e[a+"Data"].length=0});if(n&&h>n){for(c=0;k===null&&c<h;)k=a[c],c++;if(C(k)){m=q(i.pointStart,0);k=q(i.pointInterval,1);for(c=0;c<h;c++)p[c]=m,r[c]=a[c],m+=k;e.xIncrement=m}else if(Ja(k))if(s)for(c=0;c<h;c++)k=a[c],p[c]=k[0],r[c]=k.slice(1,s+1);else for(c=0;c<h;c++)k=a[c],p[c]=k[0],r[c]=k[1];else ga(12)}else for(c=0;c<h;c++)if(a[c]!==t&&(k={series:e},e.pointClass.prototype.applyOptions.apply(k,[a[c]]),e.updateParallelArrays(k,
c),m&&v(k.name)))l.names[k.x]=k.name;Ca(r[0])&&ga(14,!0);e.data=[];e.options.data=e.userOptions.data=a;for(c=g;c--;)f[c]&&f[c].destroy&&f[c].destroy();if(l)l.minRange=l.userMinRange;e.isDirty=e.isDirtyData=j.isDirtyBox=!0;c=!1}i.legendType==="point"&&(this.processData(),this.generatePoints());b&&j.redraw(c)},processData:function(a){var b=this.xData,c=this.yData,d=b.length,e;e=0;var f,g,h=this.xAxis,i,j=this.options;i=j.cropThreshold;var k=this.getExtremesFromAll||j.getExtremesFromAll,l=this.isCartesian,
j=h&&h.val2lin,m=h&&h.isLog,n,p;if(l&&!this.isDirty&&!h.isDirty&&!this.yAxis.isDirty&&!a)return!1;if(h)a=h.getExtremes(),n=a.min,p=a.max;if(l&&this.sorted&&!k&&(!i||d>i||this.forceCrop))if(b[d-1]<n||b[0]>p)b=[],c=[];else if(b[0]<n||b[d-1]>p)e=this.cropData(this.xData,this.yData,n,p),b=e.xData,c=e.yData,e=e.start,f=!0;for(i=b.length||1;--i;)d=m?j(b[i])-j(b[i-1]):b[i]-b[i-1],d>0&&(g===t||d<g)?g=d:d<0&&this.requireSorting&&ga(15);this.cropped=f;this.cropStart=e;this.processedXData=b;this.processedYData=
c;this.closestPointRange=g},cropData:function(a,b,c,d){var e=a.length,f=0,g=e,h=q(this.cropShoulder,1),i;for(i=0;i<e;i++)if(a[i]>=c){f=w(0,i-h);break}for(c=i;c<e;c++)if(a[c]>d){g=c+h;break}return{xData:a.slice(f,g),yData:b.slice(f,g),start:f,end:g}},generatePoints:function(){var a=this.options.data,b=this.data,c,d=this.processedXData,e=this.processedYData,f=this.pointClass,g=d.length,h=this.cropStart||0,i,j=this.hasGroupedData,k,l=[],m;if(!b&&!j)b=[],b.length=a.length,b=this.data=b;for(m=0;m<g;m++)i=
h+m,j?(l[m]=(new f).init(this,[d[m]].concat(ua(e[m]))),l[m].dataGroup=this.groupMap[m]):(b[i]?k=b[i]:a[i]!==t&&(b[i]=k=(new f).init(this,a[i],d[m])),l[m]=k),l[m].index=i;if(b&&(g!==(c=b.length)||j))for(m=0;m<c;m++)if(m===h&&!j&&(m+=g),b[m])b[m].destroyElements(),b[m].plotX=t;this.data=b;this.points=l},getExtremes:function(a){var b=this.yAxis,c=this.processedXData,d,e=[],f=0;d=this.xAxis.getExtremes();var g=d.min,h=d.max,i,j,k,l,a=a||this.stackedYData||this.processedYData||[];d=a.length;for(l=0;l<
d;l++)if(j=c[l],k=a[l],i=k!==null&&k!==t&&(!b.isLog||k.length||k>0),j=this.getExtremesFromAll||this.options.getExtremesFromAll||this.cropped||(c[l+1]||j)>=g&&(c[l-1]||j)<=h,i&&j)if(i=k.length)for(;i--;)k[i]!==null&&(e[f++]=k[i]);else e[f++]=k;this.dataMin=Ma(e);this.dataMax=Da(e)},translate:function(){this.processedXData||this.processData();this.generatePoints();for(var a=this.options,b=a.stacking,c=this.xAxis,d=c.categories,e=this.yAxis,f=this.points,g=f.length,h=!!this.modifyValue,i=a.pointPlacement,
j=i==="between"||C(i),k=a.threshold,l=a.startFromThreshold?k:0,m,n,p,r,s=Number.MAX_VALUE,a=0;a<g;a++){var o=f[a],u=o.x,x=o.y;n=o.low;var D=b&&e.stacks[(this.negStacks&&x<(l?0:k)?"-":"")+this.stackKey];if(e.isLog&&x!==null&&x<=0)o.y=x=null,ga(10);o.plotX=m=ka(G(w(-1E5,c.translate(u,0,0,0,1,i,this.type==="flags")),1E5));if(b&&this.visible&&!o.isNull&&D&&D[u])r=this.getStackIndicator(r,u,this.index),D=D[u],x=D.points[r.key],n=x[0],x=x[1],n===l&&(n=q(k,e.min)),e.isLog&&n<=0&&(n=null),o.total=o.stackTotal=
D.total,o.percentage=D.total&&o.y/D.total*100,o.stackY=x,D.setOffset(this.pointXOffset||0,this.barW||0);o.yBottom=v(n)?e.translate(n,0,1,0,1):null;h&&(x=this.modifyValue(x,o));o.plotY=n=typeof x==="number"&&x!==Infinity?G(w(-1E5,e.translate(x,0,1,0,1)),1E5):t;o.isInside=n!==t&&n>=0&&n<=e.len&&m>=0&&m<=c.len;o.clientX=j?c.translate(u,0,0,0,1):m;o.negative=o.y<(k||0);o.category=d&&d[o.x]!==t?d[o.x]:o.x;o.isNull||(p!==void 0&&(s=G(s,S(m-p))),p=m)}this.closestPointRangePx=s},getValidPoints:function(a,
b){var c=this.chart;return Fa(a||this.points||[],function(a){return b&&!c.isInsidePlot(a.plotX,a.plotY,c.inverted)?!1:!a.isNull})},setClip:function(a){var b=this.chart,c=this.options,d=b.renderer,e=b.inverted,f=this.clipBox,g=f||b.clipBox,h=this.sharedClipKey||["_sharedClip",a&&a.duration,a&&a.easing,g.height,c.xAxis,c.yAxis].join(","),i=b[h],j=b[h+"m"];if(!i){if(a)g.width=0,b[h+"m"]=j=d.clipRect(-99,e?-b.plotLeft:-b.plotTop,99,e?b.chartWidth:b.chartHeight);b[h]=i=d.clipRect(g)}a&&(i.count+=1);if(c.clip!==
!1)this.group.clip(a||f?i:b.clipRect),this.markerGroup.clip(j),this.sharedClipKey=h;a||(i.count-=1,i.count<=0&&h&&b[h]&&(f||(b[h]=b[h].destroy()),b[h+"m"]&&(b[h+"m"]=b[h+"m"].destroy())))},animate:function(a){var b=this.chart,c=this.options.animation,d;if(c&&!ea(c))c=W[this.type].animation;a?this.setClip(c):(d=this.sharedClipKey,(a=b[d])&&a.animate({width:b.plotSizeX},c),b[d+"m"]&&b[d+"m"].animate({width:b.plotSizeX+99},c),this.animate=null)},afterAnimate:function(){this.setClip();O(this,"afterAnimate")},
drawPoints:function(){var a,b=this.points,c=this.chart,d,e,f,g,h,i,j,k,l=this.options.marker,m=this.pointAttr[""],n,p,r,s=this.markerGroup,o=q(l.enabled,this.xAxis.isRadial,this.closestPointRangePx>2*l.radius);if(l.enabled!==!1||this._hasPointMarkers)for(f=b.length;f--;)if(g=b[f],d=V(g.plotX),e=g.plotY,k=g.graphic,n=g.marker||{},p=!!g.marker,a=o&&n.enabled===t||n.enabled,r=g.isInside,a&&C(e)&&g.y!==null)if(a=g.pointAttr[g.selected?"select":""]||m,h=a.r,i=q(n.symbol,this.symbol),j=i.indexOf("url")===
0,k)k[r?"show":"hide"](!0).attr(a).animate(A({x:d-h,y:e-h},k.symbolName?{width:2*h,height:2*h}:{}));else{if(r&&(h>0||j))g.graphic=c.renderer.symbol(i,d-h,e-h,2*h,2*h,p?n:l).attr(a).add(s)}else if(k)g.graphic=k.destroy()},convertAttribs:function(a,b,c,d){var e=this.pointAttrToOptions,f,g,h={},a=a||{},b=b||{},c=c||{},d=d||{};for(f in e)g=e[f],h[f]=q(a[g],b[f],c[f],d[f]);return h},getAttribs:function(){var a=this,b=a.options,c=W[a.type].marker?b.marker:b,d=c.states,e=d.hover,f,g=a.color,h=a.options.negativeColor,
i={stroke:g,fill:g},j=a.points||[],k,l=[],m,n=a.pointAttrToOptions;f=a.hasPointSpecificOptions;var p=c.lineColor,r=c.fillColor;k=b.turboThreshold;var s=a.zones,F=a.zoneAxis||"y",u,x;b.marker?(e.radius=e.radius||c.radius+e.radiusPlus,e.lineWidth=e.lineWidth||c.lineWidth+e.lineWidthPlus):(e.color=e.color||va(e.color||g).brighten(e.brightness).get(),e.negativeColor=e.negativeColor||va(e.negativeColor||h).brighten(e.brightness).get());l[""]=a.convertAttribs(c,i);o(["hover","select"],function(b){l[b]=
a.convertAttribs(d[b],l[""])});a.pointAttr=l;g=j.length;if(!k||g<k||f)for(;g--;){k=j[g];if((c=k.options&&k.options.marker||k.options)&&c.enabled===!1)c.radius=0;i=null;if(s.length){f=0;for(i=s[f];k[F]>=i.value;)i=s[++f];k.color=k.fillColor=i=q(i.color,a.color)}f=b.colorByPoint||k.color;if(k.options)for(x in n)v(c[n[x]])&&(f=!0);if(f){c=c||{};m=[];d=c.states||{};f=d.hover=d.hover||{};if(!b.marker||k.negative&&!f.fillColor&&!e.fillColor)f[a.pointAttrToOptions.fill]=f.color||!k.options.color&&e[k.negative&&
h?"negativeColor":"color"]||va(k.color).brighten(f.brightness||e.brightness).get();u={color:k.color};if(!r)u.fillColor=k.color;if(!p)u.lineColor=k.color;c.hasOwnProperty("color")&&!c.color&&delete c.color;if(i&&!e.fillColor)f.fillColor=i;m[""]=a.convertAttribs(A(u,c),l[""]);m.hover=a.convertAttribs(d.hover,l.hover,m[""]);m.select=a.convertAttribs(d.select,l.select,m[""])}else m=l;k.pointAttr=m}},destroy:function(){var a=this,b=a.chart,c=/AppleWebKit\/533/.test(Na),d,e=a.data||[],f,g,h;O(a,"destroy");
T(a);o(a.axisTypes||[],function(b){if(h=a[b])za(h.series,a),h.isDirty=h.forceRedraw=!0});a.legendItem&&a.chart.legend.destroyItem(a);for(d=e.length;d--;)(f=e[d])&&f.destroy&&f.destroy();a.points=null;clearTimeout(a.animationTimeout);for(g in a)a[g]instanceof Z&&!a[g].survive&&(d=c&&g==="group"?"hide":"destroy",a[g][d]());if(b.hoverSeries===a)b.hoverSeries=null;za(b.series,a);for(g in a)delete a[g]},getGraphPath:function(a,b,c){var d=this,e=d.options,f=e.step,g,h=[],i,a=a||d.points;(g=a.reversed)&&
a.reverse();(f={right:1,center:2}[f]||f&&3)&&g&&(f=4-f);e.connectNulls&&!b&&!c&&(a=this.getValidPoints(a));o(a,function(g,k){var l=g.plotX,m=g.plotY,n=a[k-1];if((g.leftCliff||n&&n.rightCliff)&&!c)i=!0;g.isNull&&!v(b)&&k>0?i=!e.connectNulls:g.isNull&&!b?i=!0:(k===0||i?n=["M",g.plotX,g.plotY]:d.getPointSpline?n=d.getPointSpline(a,g,k):f?(n=f===1?["L",n.plotX,m]:f===2?["L",(n.plotX+l)/2,n.plotY,"L",(n.plotX+l)/2,m]:["L",l,n.plotY],n.push("L",l,m)):n=["L",l,m],h.push.apply(h,n),i=!1)});return d.graphPath=
h},drawGraph:function(){var a=this,b=this.options,c=[["graph",b.lineColor||this.color,b.dashStyle]],d=b.lineWidth,e=b.linecap!=="square",f=(this.gappedPath||this.getGraphPath).call(this),g=this.fillGraph&&this.color||"none";o(this.zones,function(d,e){c.push(["zoneGraph"+e,d.color||a.color,d.dashStyle||b.dashStyle])});o(c,function(c,i){var j=c[0],k=a[j];if(k)k.animate({d:f});else if((d||g)&&f.length)k={stroke:c[1],"stroke-width":d,fill:g,zIndex:1},c[2]?k.dashstyle=c[2]:e&&(k["stroke-linecap"]=k["stroke-linejoin"]=
"round"),a[j]=a.chart.renderer.path(f).attr(k).add(a.group).shadow(i<2&&b.shadow)})},applyZones:function(){var a=this,b=this.chart,c=b.renderer,d=this.zones,e,f,g=this.clips||[],h,i=this.graph,j=this.area,k=w(b.chartWidth,b.chartHeight),l=this[(this.zoneAxis||"y")+"Axis"],m,n=l.reversed,p=b.inverted,r=l.horiz,s,F,u,x=!1;if(d.length&&(i||j)&&l.min!==t)i&&i.hide(),j&&j.hide(),m=l.getExtremes(),o(d,function(d,o){e=n?r?b.plotWidth:0:r?0:l.toPixels(m.min);e=G(w(q(f,e),0),k);f=G(w(y(l.toPixels(q(d.value,
m.max),!0)),0),k);x&&(e=f=l.toPixels(m.max));s=Math.abs(e-f);F=G(e,f);u=w(e,f);if(l.isXAxis){if(h={x:p?u:F,y:0,width:s,height:k},!r)h.x=b.plotHeight-h.x}else if(h={x:0,y:p?u:F,width:k,height:s},r)h.y=b.plotWidth-h.y;b.inverted&&c.isVML&&(h=l.isXAxis?{x:0,y:n?F:u,height:h.width,width:b.chartWidth}:{x:h.y-b.plotLeft-b.spacingBox.x,y:0,width:h.height,height:b.chartHeight});g[o]?g[o].animate(h):(g[o]=c.clipRect(h),i&&a["zoneGraph"+o].clip(g[o]),j&&a["zoneArea"+o].clip(g[o]));x=d.value>m.max}),this.clips=
g},invertGroups:function(){function a(){var a={width:b.yAxis.len,height:b.xAxis.len};o(["group","markerGroup"],function(c){b[c]&&b[c].attr(a).invert()})}var b=this,c=b.chart;if(b.xAxis)E(c,"resize",a),E(b,"destroy",function(){T(c,"resize",a)}),a(),b.invertGroups=a},plotGroup:function(a,b,c,d,e){var f=this[a],g=!f;g&&(this[a]=f=this.chart.renderer.g(b).attr({zIndex:d||0.1}).add(e),f.addClass("highcharts-series-"+this.index));f.attr({visibility:c})[g?"attr":"animate"](this.getPlotBox());return f},getPlotBox:function(){var a=
this.chart,b=this.xAxis,c=this.yAxis;if(a.inverted)b=c,c=this.xAxis;return{translateX:b?b.left:a.plotLeft,translateY:c?c.top:a.plotTop,scaleX:1,scaleY:1}},render:function(){var a=this,b=a.chart,c,d=a.options,e=!!a.animate&&b.renderer.isSVG&&gb(d.animation).duration,f=a.visible?"inherit":"hidden",g=d.zIndex,h=a.hasRendered,i=b.seriesGroup;c=a.plotGroup("group","series",f,g,i);a.markerGroup=a.plotGroup("markerGroup","markers",f,g,i);e&&a.animate(!0);a.getAttribs();c.inverted=a.isCartesian?b.inverted:
!1;a.drawGraph&&(a.drawGraph(),a.applyZones());o(a.points,function(a){a.redraw&&a.redraw()});a.drawDataLabels&&a.drawDataLabels();a.visible&&a.drawPoints();a.drawTracker&&a.options.enableMouseTracking!==!1&&a.drawTracker();b.inverted&&a.invertGroups();d.clip!==!1&&!a.sharedClipKey&&!h&&c.clip(b.clipRect);e&&a.animate();if(!h)a.animationTimeout=Za(function(){a.afterAnimate()},e);a.isDirty=a.isDirtyData=!1;a.hasRendered=!0},redraw:function(){var a=this.chart,b=this.isDirty||this.isDirtyData,c=this.group,
d=this.xAxis,e=this.yAxis;c&&(a.inverted&&c.attr({width:a.plotWidth,height:a.plotHeight}),c.animate({translateX:q(d&&d.left,a.plotLeft),translateY:q(e&&e.top,a.plotTop)}));this.translate();this.render();b&&delete this.kdTree},kdDimensions:1,kdAxisArray:["clientX","plotY"],searchPoint:function(a,b){var c=this.xAxis,d=this.yAxis,e=this.chart.inverted;return this.searchKDTree({clientX:e?c.len-a.chartY+c.pos:a.chartX-c.pos,plotY:e?d.len-a.chartX+d.pos:a.chartY-d.pos},b)},buildKDTree:function(){function a(c,
e,f){var g,h;if(h=c&&c.length)return g=b.kdAxisArray[e%f],c.sort(function(a,b){return a[g]-b[g]}),h=Math.floor(h/2),{point:c[h],left:a(c.slice(0,h),e+1,f),right:a(c.slice(h+1),e+1,f)}}var b=this,c=b.kdDimensions;delete b.kdTree;Za(function(){b.kdTree=a(b.getValidPoints(null,!b.directTouch),c,c)},b.options.kdNow?0:1)},searchKDTree:function(a,b){function c(a,b,j,k){var l=b.point,m=d.kdAxisArray[j%k],n,p,r=l;p=v(a[e])&&v(l[e])?Math.pow(a[e]-l[e],2):null;n=v(a[f])&&v(l[f])?Math.pow(a[f]-l[f],2):null;
n=(p||0)+(n||0);l.dist=v(n)?Math.sqrt(n):Number.MAX_VALUE;l.distX=v(p)?Math.sqrt(p):Number.MAX_VALUE;m=a[m]-l[m];n=m<0?"left":"right";p=m<0?"right":"left";b[n]&&(n=c(a,b[n],j+1,k),r=n[g]<r[g]?n:l);b[p]&&Math.sqrt(m*m)<r[g]&&(a=c(a,b[p],j+1,k),r=a[g]<r[g]?a:r);return r}var d=this,e=this.kdAxisArray[0],f=this.kdAxisArray[1],g=b?"distX":"dist";this.kdTree||this.buildKDTree();if(this.kdTree)return c(a,this.kdTree,this.kdDimensions,this.kdDimensions)}};Tb.prototype={destroy:function(){Pa(this,this.axis)},
render:function(a){var b=this.options,c=b.format,c=c?La(c,this):b.formatter.call(this);this.label?this.label.attr({text:c,visibility:"hidden"}):this.label=this.axis.chart.renderer.text(c,null,null,b.useHTML).css(b.style).attr({align:this.textAlign,rotation:b.rotation,visibility:"hidden"}).add(a)},setOffset:function(a,b){var c=this.axis,d=c.chart,e=d.inverted,f=c.reversed,f=this.isNegative&&!f||!this.isNegative&&f,g=c.translate(c.usePercentage?100:this.total,0,0,0,1),c=c.translate(0),c=S(g-c),h=d.xAxis[0].translate(this.x)+
a,i=d.plotHeight,f={x:e?f?g:g-c:h,y:e?i-h-b:f?i-g-c:i-g,width:e?c:b,height:e?b:c};if(e=this.label)e.align(this.alignOptions,null,f),f=e.alignAttr,e[this.options.crop===!1||d.isInsidePlot(f.x,f.y)?"show":"hide"](!0)}};Ba.prototype.getStacks=function(){var a=this;o(a.yAxis,function(a){if(a.stacks&&a.hasVisibleSeries)a.oldStacks=a.stacks});o(a.series,function(b){if(b.options.stacking&&(b.visible===!0||a.options.chart.ignoreHiddenSeries===!1))b.stackKey=b.type+q(b.options.stack,"")})};J.prototype.buildStacks=
function(){var a=this.series,b,c=q(this.options.reversedStacks,!0),d=a.length,e;if(!this.isXAxis){this.usePercentage=!1;for(e=d;e--;)a[c?e:d-e-1].setStackedPoints();for(e=d;e--;)b=a[c?e:d-e-1],b.setStackCliffs&&b.setStackCliffs();if(this.usePercentage)for(e=0;e<d;e++)a[e].setPercentStacks()}};J.prototype.renderStackTotals=function(){var a=this.chart,b=a.renderer,c=this.stacks,d,e,f=this.stackTotalGroup;if(!f)this.stackTotalGroup=f=b.g("stack-labels").attr({visibility:"visible",zIndex:6}).add();f.translate(a.plotLeft,
a.plotTop);for(d in c)for(e in a=c[d],a)a[e].render(f)};J.prototype.resetStacks=function(){var a=this.stacks,b,c;if(!this.isXAxis)for(b in a)for(c in a[b])a[b][c].touched<this.stacksTouched?(a[b][c].destroy(),delete a[b][c]):(a[b][c].total=null,a[b][c].cum=0)};J.prototype.cleanStacks=function(){var a,b,c;if(!this.isXAxis){if(this.oldStacks)a=this.stacks=this.oldStacks;for(b in a)for(c in a[b])a[b][c].cum=a[b][c].total}};P.prototype.setStackedPoints=function(){if(this.options.stacking&&!(this.visible!==
!0&&this.chart.options.chart.ignoreHiddenSeries!==!1)){var a=this.processedXData,b=this.processedYData,c=[],d=b.length,e=this.options,f=e.threshold,g=e.startFromThreshold?f:0,h=e.stack,e=e.stacking,i=this.stackKey,j="-"+i,k=this.negStacks,l=this.yAxis,m=l.stacks,n=l.oldStacks,p,r,s,o,u,x,D;l.stacksTouched+=1;for(u=0;u<d;u++){x=a[u];D=b[u];p=this.getStackIndicator(p,x,this.index);o=p.key;s=(r=k&&D<(g?0:f))?j:i;m[s]||(m[s]={});if(!m[s][x])n[s]&&n[s][x]?(m[s][x]=n[s][x],m[s][x].total=null):m[s][x]=new Tb(l,
l.options.stackLabels,r,x,h);s=m[s][x];if(D!==null)s.points[o]=s.points[this.index]=[q(s.cum,g)],s.touched=l.stacksTouched,p.index>0&&this.singleStacks===!1&&(s.points[o][0]=s.points[this.index+","+x+",0"][0]);e==="percent"?(r=r?i:j,k&&m[r]&&m[r][x]?(r=m[r][x],s.total=r.total=w(r.total,s.total)+S(D)||0):s.total=ka(s.total+(S(D)||0))):s.total=ka(s.total+(D||0));s.cum=q(s.cum,g)+(D||0);if(D!==null)s.points[o].push(s.cum),c[u]=s.cum}if(e==="percent")l.usePercentage=!0;this.stackedYData=c;l.oldStacks=
{}}};P.prototype.setPercentStacks=function(){var a=this,b=a.stackKey,c=a.yAxis.stacks,d=a.processedXData,e;o([b,"-"+b],function(b){var f;for(var g=d.length,h,i;g--;)if(h=d[g],e=a.getStackIndicator(e,h,a.index),f=(i=c[b]&&c[b][h])&&i.points[e.key],h=f)i=i.total?100/i.total:0,h[0]=ka(h[0]*i),h[1]=ka(h[1]*i),a.stackedYData[g]=h[1]})};P.prototype.getStackIndicator=function(a,b,c){!v(a)||a.x!==b?a={x:b,index:0}:a.index++;a.key=[c,b,a.index].join(",");return a};A(Ba.prototype,{addSeries:function(a,b,c){var d,
e=this;a&&(b=q(b,!0),O(e,"addSeries",{options:a},function(){d=e.initSeries(a);e.isDirtyLegend=!0;e.linkSeries();b&&e.redraw(c)}));return d},addAxis:function(a,b,c,d){var e=b?"xAxis":"yAxis",f=this.options,a=z(a,{index:this[e].length,isX:b});new J(this,a);f[e]=ua(f[e]||{});f[e].push(a);q(c,!0)&&this.redraw(d)},showLoading:function(a){var b=this,c=b.options,d=b.loadingDiv,e=c.loading,f=function(){d&&N(d,{left:b.plotLeft+"px",top:b.plotTop+"px",width:b.plotWidth+"px",height:b.plotHeight+"px"})};if(!d)b.loadingDiv=
d=fa(Va,{className:"highcharts-loading"},A(e.style,{zIndex:10,display:"none"}),b.container),b.loadingSpan=fa("span",null,e.labelStyle,d),E(b,"redraw",f);b.loadingSpan.innerHTML=a||c.lang.loading;if(!b.loadingShown)N(d,{opacity:0,display:""}),db(d,{opacity:e.style.opacity},{duration:e.showDuration||0}),b.loadingShown=!0;f()},hideLoading:function(){var a=this.options,b=this.loadingDiv;b&&db(b,{opacity:0},{duration:a.loading.hideDuration||100,complete:function(){N(b,{display:"none"})}});this.loadingShown=
!1}});A(Ha.prototype,{update:function(a,b,c,d){function e(){f.applyOptions(a);if(f.y===null&&h)f.graphic=h.destroy();if(ea(a)&&!Ja(a))f.redraw=function(){if(h&&h.element&&a&&a.marker&&a.marker.symbol)f.graphic=h.destroy();if(a&&a.dataLabels&&f.dataLabel)f.dataLabel=f.dataLabel.destroy();f.redraw=null};i=f.index;g.updateParallelArrays(f,i);if(l&&f.name)l[f.x]=f.name;k.data[i]=ea(k.data[i])&&!Ja(k.data[i])?f.options:a;g.isDirty=g.isDirtyData=!0;if(!g.fixedBox&&g.hasCartesianSeries)j.isDirtyBox=!0;if(k.legendType===
"point")j.isDirtyLegend=!0;b&&j.redraw(c)}var f=this,g=f.series,h=f.graphic,i,j=g.chart,k=g.options,l=g.xAxis&&g.xAxis.names,b=q(b,!0);d===!1?e():f.firePointEvent("update",{options:a},e)},remove:function(a,b){this.series.removePoint(sa(this,this.series.data),a,b)}});A(P.prototype,{addPoint:function(a,b,c,d){var e=this,f=e.options,g=e.data,h=e.graph,i=e.area,j=e.chart,k=e.xAxis&&e.xAxis.names,l=h&&h.shift||0,m=["graph","area"],h=f.data,n,p=e.xData;$a(d,j);if(c){for(d=e.zones.length;d--;)m.push("zoneGraph"+
d,"zoneArea"+d);o(m,function(a){if(e[a])e[a].shift=l+(f.step?2:1)})}if(i)i.isArea=!0;b=q(b,!0);i={series:e};e.pointClass.prototype.applyOptions.apply(i,[a]);m=i.x;d=p.length;if(e.requireSorting&&m<p[d-1])for(n=!0;d&&p[d-1]>m;)d--;e.updateParallelArrays(i,"splice",d,0,0);e.updateParallelArrays(i,d);if(k&&i.name)k[m]=i.name;h.splice(d,0,a);n&&(e.data.splice(d,0,null),e.processData());f.legendType==="point"&&e.generatePoints();c&&(g[0]&&g[0].remove?g[0].remove(!1):(g.shift(),e.updateParallelArrays(i,
"shift"),h.shift()));e.isDirty=!0;e.isDirtyData=!0;b&&(e.getAttribs(),j.redraw())},removePoint:function(a,b,c){var d=this,e=d.data,f=e[a],g=d.points,h=d.chart,i=function(){g&&g.length===e.length&&g.splice(a,1);e.splice(a,1);d.options.data.splice(a,1);d.updateParallelArrays(f||{series:d},"splice",a,1);f&&f.destroy();d.isDirty=!0;d.isDirtyData=!0;b&&h.redraw()};$a(c,h);b=q(b,!0);f?f.firePointEvent("remove",null,i):i()},remove:function(a,b){var c=this,d=c.chart;O(c,"remove",null,function(){c.destroy();
d.isDirtyLegend=d.isDirtyBox=!0;d.linkSeries();q(a,!0)&&d.redraw(b)})},update:function(a,b){var c=this,d=this.chart,e=this.userOptions,f=this.type,g=I[f].prototype,h=["group","markerGroup","dataLabelsGroup"],i;if(a.type&&a.type!==f||a.zIndex!==void 0)h.length=0;o(h,function(a){h[a]=c[a];delete c[a]});a=z(e,{animation:!1,index:this.index,pointStart:this.xData[0]},{data:this.options.data},a);this.remove(!1);for(i in g)this[i]=t;A(this,I[a.type||f].prototype);o(h,function(a){c[a]=h[a]});this.init(d,
a);d.linkSeries();q(b,!0)&&d.redraw(!1)}});A(J.prototype,{update:function(a,b){var c=this.chart,a=c.options[this.coll][this.options.index]=z(this.userOptions,a);this.destroy(!0);this._addedPlotLB=this.chart._labelPanes=t;this.init(c,A(a,{events:t}));c.isDirtyBox=!0;q(b,!0)&&c.redraw()},remove:function(a){for(var b=this.chart,c=this.coll,d=this.series,e=d.length;e--;)d[e]&&d[e].remove(!1);za(b.axes,this);za(b[c],this);b.options[c].splice(this.options.index,1);o(b[c],function(a,b){a.options.index=b});
this.destroy();b.isDirtyBox=!0;q(a,!0)&&b.redraw()},setTitle:function(a,b){this.update({title:a},b)},setCategories:function(a,b){this.update({categories:a},b)}});var Ia=ma(P);I.line=Ia;W.area=z(da,{softThreshold:!1,threshold:0});var ya=ma(P,{type:"area",singleStacks:!1,getStackPoints:function(){var a=[],b=[],c=this.xAxis,d=this.yAxis,e=d.stacks[this.stackKey],f={},g=this.points,h=this.index,i=d.series,j=i.length,k,l=q(d.options.reversedStacks,!0)?1:-1,m,n;if(this.options.stacking){for(m=0;m<g.length;m++)f[g[m].x]=
g[m];for(n in e)e[n].total!==null&&b.push(n);b.sort(function(a,b){return a-b});k=ta(i,function(){return this.visible});o(b,function(g,i){var n=0,q,u;if(f[g]&&!f[g].isNull)a.push(f[g]),o([-1,1],function(a){var c=a===1?"rightNull":"leftNull",d=0,n=e[b[i+a]];if(n)for(m=h;m>=0&&m<j;)q=n.points[m],q||(m===h?f[g][c]=!0:k[m]&&(u=e[g].points[m])&&(d-=u[1]-u[0])),m+=l;f[g][a===1?"rightCliff":"leftCliff"]=d});else{for(m=h;m>=0&&m<j;){if(q=e[g].points[m]){n=q[1];break}m+=l}n=d.toPixels(n,!0);a.push({isNull:!0,
plotX:c.toPixels(g,!0),plotY:n,yBottom:n})}})}return a},getGraphPath:function(a){var b=P.prototype.getGraphPath,c=this.options,d=c.stacking,e=this.yAxis,f,g,h=[],i=[],j=this.index,k,l=e.stacks[this.stackKey],m=c.threshold,n=e.getThreshold(c.threshold),p,c=c.connectNulls||d==="percent",r=function(b,c,f){var g=a[b],b=d&&l[g.x].points[j],p=g[f+"Null"]||0,f=g[f+"Cliff"]||0,r,o,g=!0;f||p?(r=(p?b[0]:b[1])+f,o=b[0]+f,g=!!p):!d&&a[c]&&a[c].isNull&&(r=o=m);r!==void 0&&(i.push({plotX:k,plotY:r===null?n:e.getThreshold(r),
isNull:g}),h.push({plotX:k,plotY:o===null?n:e.getThreshold(o)}))},a=a||this.points;d&&(a=this.getStackPoints());for(f=0;f<a.length;f++)if(g=a[f].isNull,k=q(a[f].rectPlotX,a[f].plotX),p=q(a[f].yBottom,n),!g||c){c||r(f,f-1,"left");if(!g||d||!c)i.push(a[f]),h.push({x:f,plotX:k,plotY:p});c||r(f,f+1,"right")}f=b.call(this,i,!0,!0);h.reversed=!0;g=b.call(this,h,!0,!0);g.length&&(g[0]="L");f=f.concat(g);b=b.call(this,i,!1,c);this.areaPath=f;return b},drawGraph:function(){this.areaPath=[];P.prototype.drawGraph.apply(this);
var a=this,b=this.areaPath,c=this.options,d=[["area",this.color,c.fillColor]];o(this.zones,function(b,f){d.push(["zoneArea"+f,b.color||a.color,b.fillColor||c.fillColor])});o(d,function(d){var f=d[0],g=a[f];g?g.animate({d:b}):(g={fill:d[2]||d[1],zIndex:0},d[2]||(g["fill-opacity"]=q(c.fillOpacity,0.75)),a[f]=a.chart.renderer.path(b).attr(g).add(a.group))})},drawLegendSymbol:aa.drawRectangle});I.area=ya;W.spline=z(da);Ia=ma(P,{type:"spline",getPointSpline:function(a,b,c){var d=b.plotX,e=b.plotY,f=a[c-
1],c=a[c+1],g,h,i,j;if(f&&!f.isNull&&c&&!c.isNull){a=f.plotY;i=c.plotX;var c=c.plotY,k=0;g=(1.5*d+f.plotX)/2.5;h=(1.5*e+a)/2.5;i=(1.5*d+i)/2.5;j=(1.5*e+c)/2.5;i!==g&&(k=(j-h)*(i-d)/(i-g)+e-j);h+=k;j+=k;h>a&&h>e?(h=w(a,e),j=2*e-h):h<a&&h<e&&(h=G(a,e),j=2*e-h);j>c&&j>e?(j=w(c,e),h=2*e-j):j<c&&j<e&&(j=G(c,e),h=2*e-j);b.rightContX=i;b.rightContY=j}b=["C",q(f.rightContX,f.plotX),q(f.rightContY,f.plotY),q(g,d),q(h,e),d,e];f.rightContX=f.rightContY=null;return b}});I.spline=Ia;W.areaspline=z(W.area);ya=
ya.prototype;Ia=ma(Ia,{type:"areaspline",getStackPoints:ya.getStackPoints,getGraphPath:ya.getGraphPath,setStackCliffs:ya.setStackCliffs,drawGraph:ya.drawGraph,drawLegendSymbol:aa.drawRectangle});I.areaspline=Ia;W.column=z(da,{borderColor:"#FFFFFF",borderRadius:0,groupPadding:0.2,marker:null,pointPadding:0.1,minPointLength:0,cropThreshold:50,pointRange:null,states:{hover:{brightness:0.1,shadow:!1,halo:!1},select:{color:"#C0C0C0",borderColor:"#000000",shadow:!1}},dataLabels:{align:null,verticalAlign:null,
y:null},softThreshold:!1,startFromThreshold:!0,stickyTracking:!1,tooltip:{distance:6},threshold:0});Ia=ma(P,{type:"column",pointAttrToOptions:{stroke:"borderColor",fill:"color",r:"borderRadius"},cropShoulder:0,directTouch:!0,trackerGroups:["group","dataLabelsGroup"],negStacks:!0,init:function(){P.prototype.init.apply(this,arguments);var a=this,b=a.chart;b.hasRendered&&o(b.series,function(b){if(b.type===a.type)b.isDirty=!0})},getColumnMetrics:function(){var a=this,b=a.options,c=a.xAxis,d=a.yAxis,e=
c.reversed,f,g={},h=0;b.grouping===!1?h=1:o(a.chart.series,function(b){var c=b.options,e=b.yAxis,i;if(b.type===a.type&&b.visible&&d.len===e.len&&d.pos===e.pos)c.stacking?(f=b.stackKey,g[f]===t&&(g[f]=h++),i=g[f]):c.grouping!==!1&&(i=h++),b.columnIndex=i});var i=G(S(c.transA)*(c.ordinalSlope||b.pointRange||c.closestPointRange||c.tickInterval||1),c.len),j=i*b.groupPadding,k=(i-2*j)/h,b=G(b.maxPointWidth||c.len,q(b.pointWidth,k*(1-2*b.pointPadding)));a.columnMetrics={width:b,offset:(k-b)/2+(j+((a.columnIndex||
0)+(e?1:0))*k-i/2)*(e?-1:1)};return a.columnMetrics},crispCol:function(a,b,c,d){var e=this.chart,f=this.borderWidth,g=-(f%2?0.5:0),f=f%2?0.5:1;e.inverted&&e.renderer.isVML&&(f+=1);c=Math.round(a+c)+g;a=Math.round(a)+g;c-=a;d=Math.round(b+d)+f;g=S(b)<=0.5&&d>0.5;b=Math.round(b)+f;d-=b;g&&d&&(b-=1,d+=1);return{x:a,y:b,width:c,height:d}},translate:function(){var a=this,b=a.chart,c=a.options,d=a.borderWidth=q(c.borderWidth,a.closestPointRange*a.xAxis.transA<2?0:1),e=a.yAxis,f=a.translatedThreshold=e.getThreshold(c.threshold),
g=q(c.minPointLength,5),h=a.getColumnMetrics(),i=h.width,j=a.barW=w(i,1+2*d),k=a.pointXOffset=h.offset;b.inverted&&(f-=0.5);c.pointPadding&&(j=Ea(j));P.prototype.translate.apply(a);o(a.points,function(c){var d=G(q(c.yBottom,f),9E4),h=999+S(d),h=G(w(-h,c.plotY),e.len+h),p=c.plotX+k,r=j,o=G(h,d),F,u=w(h,d)-o;S(u)<g&&g&&(u=g,F=!e.reversed&&!c.negative||e.reversed&&c.negative,o=S(o-f)>g?d-g:f-(F?g:0));c.barX=p;c.pointWidth=i;c.tooltipPos=b.inverted?[e.len+e.pos-b.plotLeft-h,a.xAxis.len-p-r/2,u]:[p+r/
2,h+e.pos-b.plotTop,u];c.shapeType="rect";c.shapeArgs=a.crispCol(p,o,r,u)})},getSymbol:ra,drawLegendSymbol:aa.drawRectangle,drawGraph:ra,drawPoints:function(){var a=this,b=this.chart,c=a.options,d=b.renderer,e=c.animationLimit||250,f,g;o(a.points,function(h){var i=h.graphic,j;if(C(h.plotY)&&h.y!==null)f=h.shapeArgs,j=v(a.borderWidth)?{"stroke-width":a.borderWidth}:{},g=h.pointAttr[h.selected?"select":""]||a.pointAttr[""],i?(Sa(i),i.attr(j).attr(g)[b.pointCount<e?"animate":"attr"](z(f))):h.graphic=
d[h.shapeType](f).attr(j).attr(g).add(h.group||a.group).shadow(c.shadow,null,c.stacking&&!c.borderRadius);else if(i)h.graphic=i.destroy()})},animate:function(a){var b=this,c=this.yAxis,d=b.options,e=this.chart.inverted,f={};if(ja)a?(f.scaleY=0.001,a=G(c.pos+c.len,w(c.pos,c.toPixels(d.threshold))),e?f.translateX=a-c.len:f.translateY=a,b.group.attr(f)):(f[e?"translateX":"translateY"]=c.pos,b.group.animate(f,A(gb(b.options.animation),{step:function(a,c){b.group.attr({scaleY:w(0.001,c.pos)})}})),b.animate=
null)},remove:function(){var a=this,b=a.chart;b.hasRendered&&o(b.series,function(b){if(b.type===a.type)b.isDirty=!0});P.prototype.remove.apply(a,arguments)}});I.column=Ia;W.bar=z(W.column);ya=ma(Ia,{type:"bar",inverted:!0});I.bar=ya;W.scatter=z(da,{lineWidth:0,marker:{enabled:!0},tooltip:{headerFormat:'<span style="color:{point.color}">\u25cf</span> <span style="font-size: 10px;"> {series.name}</span><br/>',pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>"}});ya=ma(P,{type:"scatter",
sorted:!1,requireSorting:!1,noSharedTooltip:!0,trackerGroups:["group","markerGroup","dataLabelsGroup"],takeOrdinalPosition:!1,kdDimensions:2,drawGraph:function(){this.options.lineWidth&&P.prototype.drawGraph.call(this)}});I.scatter=ya;W.pie=z(da,{borderColor:"#FFFFFF",borderWidth:1,center:[null,null],clip:!1,colorByPoint:!0,dataLabels:{distance:30,enabled:!0,formatter:function(){return this.y===null?void 0:this.point.name},x:0},ignoreHiddenPoint:!0,legendType:"point",marker:null,size:null,showInLegend:!1,
slicedOffset:10,states:{hover:{brightness:0.1,shadow:!1}},stickyTracking:!1,tooltip:{followPointer:!0}});da={type:"pie",isCartesian:!1,pointClass:ma(Ha,{init:function(){Ha.prototype.init.apply(this,arguments);var a=this,b;a.name=q(a.name,"Slice");b=function(b){a.slice(b.type==="select")};E(a,"select",b);E(a,"unselect",b);return a},setVisible:function(a,b){var c=this,d=c.series,e=d.chart,f=d.options.ignoreHiddenPoint,b=q(b,f);if(a!==c.visible){c.visible=c.options.visible=a=a===t?!c.visible:a;d.options.data[sa(c,
d.data)]=c.options;o(["graphic","dataLabel","connector","shadowGroup"],function(b){if(c[b])c[b][a?"show":"hide"](!0)});c.legendItem&&e.legend.colorizeItem(c,a);!a&&c.state==="hover"&&c.setState("");if(f)d.isDirty=!0;b&&e.redraw()}},slice:function(a,b,c){var d=this.series;$a(c,d.chart);q(b,!0);this.sliced=this.options.sliced=a=v(a)?a:!this.sliced;d.options.data[sa(this,d.data)]=this.options;a=a?this.slicedTranslation:{translateX:0,translateY:0};this.graphic.animate(a);this.shadowGroup&&this.shadowGroup.animate(a)},
haloPath:function(a){var b=this.shapeArgs,c=this.series.chart;return this.sliced||!this.visible?[]:this.series.chart.renderer.symbols.arc(c.plotLeft+b.x,c.plotTop+b.y,b.r+a,b.r+a,{innerR:this.shapeArgs.r,start:b.start,end:b.end})}}),requireSorting:!1,directTouch:!0,noSharedTooltip:!0,trackerGroups:["group","dataLabelsGroup"],axisTypes:[],pointAttrToOptions:{stroke:"borderColor","stroke-width":"borderWidth",fill:"color"},animate:function(a){var b=this,c=b.points,d=b.startAngleRad;if(!a)o(c,function(a){var c=
a.graphic,g=a.shapeArgs;c&&(c.attr({r:a.startR||b.center[3]/2,start:d,end:d}),c.animate({r:g.r,start:g.start,end:g.end},b.options.animation))}),b.animate=null},updateTotals:function(){var a,b=0,c=this.points,d=c.length,e,f=this.options.ignoreHiddenPoint;for(a=0;a<d;a++)e=c[a],b+=f&&!e.visible?0:e.y;this.total=b;for(a=0;a<d;a++)e=c[a],e.percentage=b>0&&(e.visible||!f)?e.y/b*100:0,e.total=b},generatePoints:function(){P.prototype.generatePoints.call(this);this.updateTotals()},translate:function(a){this.generatePoints();
var b=0,c=this.options,d=c.slicedOffset,e=d+c.borderWidth,f,g,h,i=c.startAngle||0,j=this.startAngleRad=Aa/180*(i-90),i=(this.endAngleRad=Aa/180*(q(c.endAngle,i+360)-90))-j,k=this.points,l=c.dataLabels.distance,c=c.ignoreHiddenPoint,m,n=k.length,p;if(!a)this.center=a=this.getCenter();this.getX=function(b,c){h=Y.asin(G((b-a[1])/(a[2]/2+l),1));return a[0]+(c?-1:1)*ca(h)*(a[2]/2+l)};for(m=0;m<n;m++){p=k[m];f=j+b*i;if(!c||p.visible)b+=p.percentage/100;g=j+b*i;p.shapeType="arc";p.shapeArgs={x:a[0],y:a[1],
r:a[2]/2,innerR:a[3]/2,start:y(f*1E3)/1E3,end:y(g*1E3)/1E3};h=(g+f)/2;h>1.5*Aa?h-=2*Aa:h<-Aa/2&&(h+=2*Aa);p.slicedTranslation={translateX:y(ca(h)*d),translateY:y(la(h)*d)};f=ca(h)*a[2]/2;g=la(h)*a[2]/2;p.tooltipPos=[a[0]+f*0.7,a[1]+g*0.7];p.half=h<-Aa/2||h>Aa/2?1:0;p.angle=h;e=G(e,l/2);p.labelPos=[a[0]+f+ca(h)*l,a[1]+g+la(h)*l,a[0]+f+ca(h)*e,a[1]+g+la(h)*e,a[0]+f,a[1]+g,l<0?"center":p.half?"right":"left",h]}},drawGraph:null,drawPoints:function(){var a=this,b=a.chart.renderer,c,d,e=a.options.shadow,
f,g,h,i;if(e&&!a.shadowGroup)a.shadowGroup=b.g("shadow").add(a.group);o(a.points,function(j){if(j.y!==null){d=j.graphic;h=j.shapeArgs;f=j.shadowGroup;g=j.pointAttr[j.selected?"select":""];if(!g.stroke)g.stroke=g.fill;if(e&&!f)f=j.shadowGroup=b.g("shadow").add(a.shadowGroup);c=j.sliced?j.slicedTranslation:{translateX:0,translateY:0};f&&f.attr(c);if(d)d.setRadialReference(a.center).attr(g).animate(A(h,c));else{i={"stroke-linejoin":"round"};if(!j.visible)i.visibility="hidden";j.graphic=d=b[j.shapeType](h).setRadialReference(a.center).attr(g).attr(i).attr(c).add(a.group).shadow(e,
f)}}})},searchPoint:ra,sortByAngle:function(a,b){a.sort(function(a,d){return a.angle!==void 0&&(d.angle-a.angle)*b})},drawLegendSymbol:aa.drawRectangle,getCenter:bc.getCenter,getSymbol:ra};da=ma(P,da);I.pie=da;P.prototype.drawDataLabels=function(){var a=this,b=a.options,c=b.cursor,d=b.dataLabels,e=a.points,f,g,h=a.hasRendered||0,i,j,k=q(d.defer,!0),l=a.chart.renderer;if(d.enabled||a._hasPointLabels)a.dlProcessOptions&&a.dlProcessOptions(d),j=a.plotGroup("dataLabelsGroup","data-labels",k&&!h?"hidden":
"visible",d.zIndex||6),k&&(j.attr({opacity:+h}),h||E(a,"afterAnimate",function(){a.visible&&j.show();j[b.animation?"animate":"attr"]({opacity:1},{duration:200})})),g=d,o(e,function(e){var h,k=e.dataLabel,r,o,F=e.connector,u=!0,x,D={};f=e.dlOptions||e.options&&e.options.dataLabels;h=q(f&&f.enabled,g.enabled)&&e.y!==null;if(k&&!h)e.dataLabel=k.destroy();else if(h){d=z(g,f);x=d.style;h=d.rotation;r=e.getLabelConfig();i=d.format?La(d.format,r):d.formatter.call(r,d);x.color=q(d.color,x.color,a.color,"black");
if(k)if(v(i))k.attr({text:i}),u=!1;else{if(e.dataLabel=k=k.destroy(),F)e.connector=F.destroy()}else if(v(i)){k={fill:d.backgroundColor,stroke:d.borderColor,"stroke-width":d.borderWidth,r:d.borderRadius||0,rotation:h,padding:d.padding,zIndex:1};if(x.color==="contrast")D.color=d.inside||d.distance<0||b.stacking?l.getContrast(e.color||a.color):"#000000";if(c)D.cursor=c;for(o in k)k[o]===t&&delete k[o];k=e.dataLabel=l[h?"text":"label"](i,0,-9999,d.shape,null,null,d.useHTML).attr(k).css(A(x,D)).add(j).shadow(d.shadow)}k&&
a.alignDataLabel(e,k,d,null,u)}})};P.prototype.alignDataLabel=function(a,b,c,d,e){var f=this.chart,g=f.inverted,h=q(a.plotX,-9999),i=q(a.plotY,-9999),j=b.getBBox(),k=f.renderer.fontMetrics(c.style.fontSize).b,l=c.rotation,m=c.align,n=this.visible&&(a.series.forceDL||f.isInsidePlot(h,y(i),g)||d&&f.isInsidePlot(h,g?d.x+1:d.y+d.height-1,g)),p=q(c.overflow,"justify")==="justify";if(n)d=A({x:g?f.plotWidth-i:h,y:y(g?f.plotHeight-h:i),width:0,height:0},d),A(c,{width:j.width,height:j.height}),l?(p=!1,g=f.renderer.rotCorr(k,
l),g={x:d.x+c.x+d.width/2+g.x,y:d.y+c.y+{top:0,middle:0.5,bottom:1}[c.verticalAlign]*d.height},b[e?"attr":"animate"](g).attr({align:m}),h=(l+720)%360,h=h>180&&h<360,m==="left"?g.y-=h?j.height:0:m==="center"?(g.x-=j.width/2,g.y-=j.height/2):m==="right"&&(g.x-=j.width,g.y-=h?0:j.height)):(b.align(c,null,d),g=b.alignAttr),p?this.justifyDataLabel(b,c,g,j,d,e):q(c.crop,!0)&&(n=f.isInsidePlot(g.x,g.y)&&f.isInsidePlot(g.x+j.width,g.y+j.height)),c.shape&&!l&&b.attr({anchorX:a.plotX,anchorY:a.plotY});if(!n)Sa(b),
b.attr({y:-9999}),b.placed=!1};P.prototype.justifyDataLabel=function(a,b,c,d,e,f){var g=this.chart,h=b.align,i=b.verticalAlign,j,k,l=a.box?0:a.padding||0;j=c.x+l;if(j<0)h==="right"?b.align="left":b.x=-j,k=!0;j=c.x+d.width-l;if(j>g.plotWidth)h==="left"?b.align="right":b.x=g.plotWidth-j,k=!0;j=c.y+l;if(j<0)i==="bottom"?b.verticalAlign="top":b.y=-j,k=!0;j=c.y+d.height-l;if(j>g.plotHeight)i==="top"?b.verticalAlign="bottom":b.y=g.plotHeight-j,k=!0;if(k)a.placed=!f,a.align(b,null,e)};if(I.pie)I.pie.prototype.drawDataLabels=
function(){var a=this,b=a.data,c,d=a.chart,e=a.options.dataLabels,f=q(e.connectorPadding,10),g=q(e.connectorWidth,1),h=d.plotWidth,i=d.plotHeight,j,k,l=q(e.softConnector,!0),m=e.distance,n=a.center,p=n[2]/2,r=n[1],s=m>0,F,u,x,D=[[],[]],v,t,A,B,z,C=[0,0,0,0],H=function(a,b){return b.y-a.y};if(a.visible&&(e.enabled||a._hasPointLabels)){P.prototype.drawDataLabels.apply(a);o(b,function(a){if(a.dataLabel&&a.visible)D[a.half].push(a),a.dataLabel._pos=null});for(B=2;B--;){var E=[],L=[],K=D[B],I=K.length,
J;if(I){a.sortByAngle(K,B-0.5);for(z=b=0;!b&&K[z];)b=K[z]&&K[z].dataLabel&&(K[z].dataLabel.getBBox().height||21),z++;if(m>0){u=G(r+p+m,d.plotHeight);for(z=w(0,r-p-m);z<=u;z+=b)E.push(z);u=E.length;if(I>u){c=[].concat(K);c.sort(H);for(z=I;z--;)c[z].rank=z;for(z=I;z--;)K[z].rank>=u&&K.splice(z,1);I=K.length}for(z=0;z<I;z++){c=K[z];x=c.labelPos;c=9999;var N,M;for(M=0;M<u;M++)N=S(E[M]-x[1]),N<c&&(c=N,J=M);if(J<z&&E[z]!==null)J=z;else for(u<I-z+J&&E[z]!==null&&(J=u-I+z);E[J]===null;)J++;L.push({i:J,y:E[J]});
E[J]=null}L.sort(H)}for(z=0;z<I;z++){c=K[z];x=c.labelPos;F=c.dataLabel;A=c.visible===!1?"hidden":"inherit";c=x[1];if(m>0){if(u=L.pop(),J=u.i,t=u.y,c>t&&E[J+1]!==null||c<t&&E[J-1]!==null)t=G(w(0,c),d.plotHeight)}else t=c;v=e.justify?n[0]+(B?-1:1)*(p+m):a.getX(t===r-p-m||t===r+p+m?c:t,B);F._attr={visibility:A,align:x[6]};F._pos={x:v+e.x+({left:f,right:-f}[x[6]]||0),y:t+e.y-10};F.connX=v;F.connY=t;if(this.options.size===null)u=F.width,v-u<f?C[3]=w(y(u-v+f),C[3]):v+u>h-f&&(C[1]=w(y(v+u-h+f),C[1])),t-
b/2<0?C[0]=w(y(-t+b/2),C[0]):t+b/2>i&&(C[2]=w(y(t+b/2-i),C[2]))}}}if(Da(C)===0||this.verifyDataLabelOverflow(C))this.placeDataLabels(),s&&g&&o(this.points,function(b){j=b.connector;x=b.labelPos;if((F=b.dataLabel)&&F._pos&&b.visible)A=F._attr.visibility,v=F.connX,t=F.connY,k=l?["M",v+(x[6]==="left"?5:-5),t,"C",v,t,2*x[2]-x[4],2*x[3]-x[5],x[2],x[3],"L",x[4],x[5]]:["M",v+(x[6]==="left"?5:-5),t,"L",x[2],x[3],"L",x[4],x[5]],j?(j.animate({d:k}),j.attr("visibility",A)):b.connector=j=a.chart.renderer.path(k).attr({"stroke-width":g,
stroke:e.connectorColor||b.color||"#606060",visibility:A}).add(a.dataLabelsGroup);else if(j)b.connector=j.destroy()})}},I.pie.prototype.placeDataLabels=function(){o(this.points,function(a){var b=a.dataLabel;if(b&&a.visible)(a=b._pos)?(b.attr(b._attr),b[b.moved?"animate":"attr"](a),b.moved=!0):b&&b.attr({y:-9999})})},I.pie.prototype.alignDataLabel=ra,I.pie.prototype.verifyDataLabelOverflow=function(a){var b=this.center,c=this.options,d=c.center,e=c.minSize||80,f=e,g;d[0]!==null?f=w(b[2]-w(a[1],a[3]),
e):(f=w(b[2]-a[1]-a[3],e),b[0]+=(a[3]-a[1])/2);d[1]!==null?f=w(G(f,b[2]-w(a[0],a[2])),e):(f=w(G(f,b[2]-a[0]-a[2]),e),b[1]+=(a[0]-a[2])/2);f<b[2]?(b[2]=f,b[3]=Math.min(/%$/.test(c.innerSize||0)?f*parseFloat(c.innerSize||0)/100:parseFloat(c.innerSize||0),f),this.translate(b),this.drawDataLabels&&this.drawDataLabels()):g=!0;return g};if(I.column)I.column.prototype.alignDataLabel=function(a,b,c,d,e){var f=this.chart.inverted,g=a.series,h=a.dlBox||a.shapeArgs,i=q(a.below,a.plotY>q(this.translatedThreshold,
g.yAxis.len)),j=q(c.inside,!!this.options.stacking);if(h){d=z(h);if(d.y<0)d.height+=d.y,d.y=0;h=d.y+d.height-g.yAxis.len;h>0&&(d.height-=h);f&&(d={x:g.yAxis.len-d.y-d.height,y:g.xAxis.len-d.x-d.width,width:d.height,height:d.width});if(!j)f?(d.x+=i?0:d.width,d.width=0):(d.y+=i?d.height:0,d.height=0)}c.align=q(c.align,!f||j?"center":i?"right":"left");c.verticalAlign=q(c.verticalAlign,f||j?"middle":i?"top":"bottom");P.prototype.alignDataLabel.call(this,a,b,c,d,e)};(function(a){var b=a.Chart,c=a.each,
d=a.pick,e=a.addEvent;b.prototype.callbacks.push(function(a){function b(){var e=[];c(a.series,function(a){var b=a.options.dataLabels,f=a.dataLabelCollections||["dataLabel"];(b.enabled||a._hasPointLabels)&&!b.allowOverlap&&a.visible&&c(f,function(b){c(a.points,function(a){if(a[b])a[b].labelrank=d(a.labelrank,a.shapeArgs&&a.shapeArgs.height),e.push(a[b])})})});a.hideOverlappingLabels(e)}b();e(a,"redraw",b)});b.prototype.hideOverlappingLabels=function(a){var b=a.length,d,e,j,k,l,m,n,p,r;for(e=0;e<b;e++)if(d=
a[e])d.oldOpacity=d.opacity,d.newOpacity=1;a.sort(function(a,b){return(b.labelrank||0)-(a.labelrank||0)});for(e=0;e<b;e++){j=a[e];for(d=e+1;d<b;++d)if(k=a[d],j&&k&&j.placed&&k.placed&&j.newOpacity!==0&&k.newOpacity!==0&&(l=j.alignAttr,m=k.alignAttr,n=j.parentGroup,p=k.parentGroup,r=2*(j.box?0:j.padding),l=!(m.x+p.translateX>l.x+n.translateX+(j.width-r)||m.x+p.translateX+(k.width-r)<l.x+n.translateX||m.y+p.translateY>l.y+n.translateY+(j.height-r)||m.y+p.translateY+(k.height-r)<l.y+n.translateY)))(j.labelrank<
k.labelrank?j:k).newOpacity=0}c(a,function(a){var b,c;if(a){c=a.newOpacity;if(a.oldOpacity!==c&&a.placed)c?a.show(!0):b=function(){a.hide()},a.alignAttr.opacity=c,a[a.isOld?"animate":"attr"](a.alignAttr,null,b);a.isOld=!0}})}})(B);var mb=B.TrackerMixin={drawTrackerPoint:function(){var a=this,b=a.chart,c=b.pointer,d=a.options.cursor,e=d&&{cursor:d},f=function(a){for(var c=a.target,d;c&&!d;)d=c.point,c=c.parentNode;if(d!==t&&d!==b.hoverPoint)d.onMouseOver(a)};o(a.points,function(a){if(a.graphic)a.graphic.element.point=
a;if(a.dataLabel)a.dataLabel.element.point=a});if(!a._hasTracking)o(a.trackerGroups,function(b){if(a[b]&&(a[b].addClass("highcharts-tracker").on("mouseover",f).on("mouseout",function(a){c.onTrackerMouseOut(a)}).css(e),cb))a[b].on("touchstart",f)}),a._hasTracking=!0},drawTrackerGraph:function(){var a=this,b=a.options,c=b.trackByArea,d=[].concat(c?a.areaPath:a.graphPath),e=d.length,f=a.chart,g=f.pointer,h=f.renderer,i=f.options.tooltip.snap,j=a.tracker,k=b.cursor,l=k&&{cursor:k},m=function(){if(f.hoverSeries!==
a)a.onMouseOver()},n="rgba(192,192,192,"+(ja?1.0E-4:0.002)+")";if(e&&!c)for(k=e+1;k--;)d[k]==="M"&&d.splice(k+1,0,d[k+1]-i,d[k+2],"L"),(k&&d[k]==="M"||k===e)&&d.splice(k,0,"L",d[k-2]+i,d[k-1]);j?j.attr({d:d}):(a.tracker=h.path(d).attr({"stroke-linejoin":"round",visibility:a.visible?"visible":"hidden",stroke:n,fill:c?n:"none","stroke-width":b.lineWidth+(c?0:2*i),zIndex:2}).add(a.group),o([a.tracker,a.markerGroup],function(a){a.addClass("highcharts-tracker").on("mouseover",m).on("mouseout",function(a){g.onTrackerMouseOut(a)}).css(l);
if(cb)a.on("touchstart",m)}))}};if(I.column)Ia.prototype.drawTracker=mb.drawTrackerPoint;if(I.pie)I.pie.prototype.drawTracker=mb.drawTrackerPoint;if(I.scatter)ya.prototype.drawTracker=mb.drawTrackerPoint;A(ub.prototype,{setItemEvents:function(a,b,c,d,e){var f=this;(c?b:a.legendGroup).on("mouseover",function(){a.setState("hover");b.css(f.options.itemHoverStyle)}).on("mouseout",function(){b.css(a.visible?d:e);a.setState()}).on("click",function(b){var c=function(){a.setVisible&&a.setVisible()},b={browserEvent:b};
a.firePointEvent?a.firePointEvent("legendItemClick",b,c):O(a,"legendItemClick",b,c)})},createCheckboxForItem:function(a){a.checkbox=fa("input",{type:"checkbox",checked:a.selected,defaultChecked:a.selected},this.options.itemCheckboxStyle,this.chart.container);E(a.checkbox,"click",function(b){O(a.series||a,"checkboxClick",{checked:b.target.checked,item:a},function(){a.select()})})}});R.legend.itemStyle.cursor="pointer";A(Ba.prototype,{showResetZoom:function(){var a=this,b=R.lang,c=a.options.chart.resetZoomButton,
d=c.theme,e=d.states,f=c.relativeTo==="chart"?null:"plotBox";this.resetZoomButton=a.renderer.button(b.resetZoom,null,null,function(){a.zoomOut()},d,e&&e.hover).attr({align:c.position.align,title:b.resetZoomTitle}).add().align(c.position,!1,f)},zoomOut:function(){var a=this;O(a,"selection",{resetSelection:!0},function(){a.zoom()})},zoom:function(a){var b,c=this.pointer,d=!1,e;!a||a.resetSelection?o(this.axes,function(a){b=a.zoom()}):o(a.xAxis.concat(a.yAxis),function(a){var e=a.axis,h=e.isXAxis;if(c[h?
"zoomX":"zoomY"]||c[h?"pinchX":"pinchY"])b=e.zoom(a.min,a.max),e.displayBtn&&(d=!0)});e=this.resetZoomButton;if(d&&!e)this.showResetZoom();else if(!d&&ea(e))this.resetZoomButton=e.destroy();b&&this.redraw(q(this.options.chart.animation,a&&a.animation,this.pointCount<100))},pan:function(a,b){var c=this,d=c.hoverPoints,e;d&&o(d,function(a){a.setState()});o(b==="xy"?[1,0]:[1],function(b){var b=c[b?"xAxis":"yAxis"][0],d=b.horiz,h=a[d?"chartX":"chartY"],d=d?"mouseDownX":"mouseDownY",i=c[d],j=(b.pointRange||
0)/2,k=b.getExtremes(),l=b.toValue(i-h,!0)+j,j=b.toValue(i+b.len-h,!0)-j,i=i>h;if(b.series.length&&(i||l>G(k.dataMin,k.min))&&(!i||j<w(k.dataMax,k.max)))b.setExtremes(l,j,!1,!1,{trigger:"pan"}),e=!0;c[d]=h});e&&c.redraw(!1);N(c.container,{cursor:"move"})}});A(Ha.prototype,{select:function(a,b){var c=this,d=c.series,e=d.chart,a=q(a,!c.selected);c.firePointEvent(a?"select":"unselect",{accumulate:b},function(){c.selected=c.options.selected=a;d.options.data[sa(c,d.data)]=c.options;c.setState(a&&"select");
b||o(e.getSelectedPoints(),function(a){if(a.selected&&a!==c)a.selected=a.options.selected=!1,d.options.data[sa(a,d.data)]=a.options,a.setState(""),a.firePointEvent("unselect")})})},onMouseOver:function(a,b){var c=this.series,d=c.chart,e=d.tooltip,f=d.hoverPoint;if(d.hoverSeries!==c)c.onMouseOver();if(f&&f!==this)f.onMouseOut();if(this.series&&(this.firePointEvent("mouseOver"),e&&(!e.shared||c.noSharedTooltip)&&e.refresh(this,a),this.setState("hover"),!b))d.hoverPoint=this},onMouseOut:function(){var a=
this.series.chart,b=a.hoverPoints;this.firePointEvent("mouseOut");if(!b||sa(this,b)===-1)this.setState(),a.hoverPoint=null},importEvents:function(){if(!this.hasImportedEvents){var a=z(this.series.options.point,this.options).events,b;this.events=a;for(b in a)E(this,b,a[b]);this.hasImportedEvents=!0}},setState:function(a,b){var c=V(this.plotX),d=this.plotY,e=this.series,f=e.options.states,g=W[e.type].marker&&e.options.marker,h=g&&!g.enabled,i=g&&g.states[a],j=i&&i.enabled===!1,k=e.stateMarkerGraphic,
l=this.marker||{},m=e.chart,n=e.halo,p,a=a||"";p=this.pointAttr[a]||e.pointAttr[a];if(!(a===this.state&&!b||this.selected&&a!=="select"||f[a]&&f[a].enabled===!1||a&&(j||h&&i.enabled===!1)||a&&l.states&&l.states[a]&&l.states[a].enabled===!1)){if(this.graphic)g=g&&this.graphic.symbolName&&p.r,this.graphic.attr(z(p,g?{x:c-g,y:d-g,width:2*g,height:2*g}:{})),k&&k.hide();else{if(a&&i)if(g=i.radius,l=l.symbol||e.symbol,k&&k.currentSymbol!==l&&(k=k.destroy()),k)k[b?"animate":"attr"]({x:c-g,y:d-g});else if(l)e.stateMarkerGraphic=
k=m.renderer.symbol(l,c-g,d-g,2*g,2*g).attr(p).add(e.markerGroup),k.currentSymbol=l;if(k)k[a&&m.isInsidePlot(c,d,m.inverted)?"show":"hide"](),k.element.point=this}if((c=f[a]&&f[a].halo)&&c.size){if(!n)e.halo=n=m.renderer.path().add(m.seriesGroup);n.attr(A({fill:this.color||e.color,"fill-opacity":c.opacity,zIndex:-1},c.attributes))[b?"animate":"attr"]({d:this.haloPath(c.size)})}else n&&n.attr({d:[]});this.state=a}},haloPath:function(a){var b=this.series,c=b.chart,d=b.getPlotBox(),e=c.inverted,f=Math.floor(this.plotX);
return c.renderer.symbols.circle(d.translateX+(e?b.yAxis.len-this.plotY:f)-a,d.translateY+(e?b.xAxis.len-f:this.plotY)-a,a*2,a*2)}});A(P.prototype,{onMouseOver:function(){var a=this.chart,b=a.hoverSeries;if(b&&b!==this)b.onMouseOut();this.options.events.mouseOver&&O(this,"mouseOver");this.setState("hover");a.hoverSeries=this},onMouseOut:function(){var a=this.options,b=this.chart,c=b.tooltip,d=b.hoverPoint;b.hoverSeries=null;if(d)d.onMouseOut();this&&a.events.mouseOut&&O(this,"mouseOut");c&&!a.stickyTracking&&
(!c.shared||this.noSharedTooltip)&&c.hide();this.setState()},setState:function(a){var b=this.options,c=this.graph,d=b.states,e=b.lineWidth,b=0,a=a||"";if(this.state!==a&&(this.state=a,!(d[a]&&d[a].enabled===!1)&&(a&&(e=d[a].lineWidth||e+(d[a].lineWidthPlus||0)),c&&!c.dashstyle))){a={"stroke-width":e};for(c.attr(a);this["zoneGraph"+b];)this["zoneGraph"+b].attr(a),b+=1}},setVisible:function(a,b){var c=this,d=c.chart,e=c.legendItem,f,g=d.options.chart.ignoreHiddenSeries,h=c.visible;f=(c.visible=a=c.userOptions.visible=
a===t?!h:a)?"show":"hide";o(["group","dataLabelsGroup","markerGroup","tracker"],function(a){if(c[a])c[a][f]()});if(d.hoverSeries===c||(d.hoverPoint&&d.hoverPoint.series)===c)c.onMouseOut();e&&d.legend.colorizeItem(c,a);c.isDirty=!0;c.options.stacking&&o(d.series,function(a){if(a.options.stacking&&a.visible)a.isDirty=!0});o(c.linkedSeries,function(b){b.setVisible(a,!1)});if(g)d.isDirtyBox=!0;b!==!1&&d.redraw();O(c,f)},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)},select:function(a){this.selected=
a=a===t?!this.selected:a;if(this.checkbox)this.checkbox.checked=a;O(this,a?"select":"unselect")},drawTracker:mb.drawTrackerGraph});U(P.prototype,"init",function(a){var b;a.apply(this,Array.prototype.slice.call(arguments,1));(b=this.xAxis)&&b.options.ordinal&&E(this,"updatedData",function(){delete b.ordinalIndex})});U(J.prototype,"getTimeTicks",function(a,b,c,d,e,f,g,h){var i=0,j,k,l={},m,n,p,o=[],q=-Number.MAX_VALUE,F=this.options.tickPixelInterval;if(!this.options.ordinal&&!this.options.breaks||
!f||f.length<3||c===t)return a.call(this,b,c,d,e);n=f.length;for(j=0;j<n;j++){p=j&&f[j-1]>d;f[j]<c&&(i=j);if(j===n-1||f[j+1]-f[j]>g*5||p){if(f[j]>q){for(k=a.call(this,b,f[i],f[j],e);k.length&&k[0]<=q;)k.shift();k.length&&(q=k[k.length-1]);o=o.concat(k)}i=j+1}if(p)break}a=k.info;if(h&&a.unitRange<=M.hour){j=o.length-1;for(i=1;i<j;i++)na("%d",o[i])!==na("%d",o[i-1])&&(l[o[i]]="day",m=!0);m&&(l[o[0]]="day");a.higherRanks=l}o.info=a;if(h&&v(F)){h=a=o.length;j=[];var u;for(m=[];h--;)i=this.translate(o[h]),
u&&(m[h]=u-i),j[h]=u=i;m.sort();m=m[V(m.length/2)];m<F*0.6&&(m=null);h=o[a-1]>d?a-1:a;for(u=void 0;h--;)i=j[h],d=u-i,u&&d<F*0.8&&(m===null||d<m*0.8)?(l[o[h]]&&!l[o[h+1]]?(d=h+1,u=i):d=h,o.splice(d,1)):u=i}return o});A(J.prototype,{beforeSetTickPositions:function(){var a,b=[],c=!1,d,e=this.getExtremes(),f=e.min,g=e.max,h,i=this.isXAxis&&!!this.options.breaks;if((e=this.options.ordinal)||i){o(this.series,function(c,d){if(c.visible!==!1&&(c.takeOrdinalPosition!==!1||i))if(b=b.concat(c.processedXData),
a=b.length,b.sort(function(a,b){return a-b}),a)for(d=a-1;d--;)b[d]===b[d+1]&&b.splice(d,1)});a=b.length;if(a>2){d=b[1]-b[0];for(h=a-1;h--&&!c;)b[h+1]-b[h]!==d&&(c=!0);if(!this.options.keepOrdinalPadding&&(b[0]-f>d||g-b[b.length-1]>d))c=!0}c?(this.ordinalPositions=b,d=this.val2lin(w(f,b[0]),!0),h=w(this.val2lin(G(g,b[b.length-1]),!0),1),this.ordinalSlope=g=(g-f)/(h-d),this.ordinalOffset=f-d*g):this.ordinalPositions=this.ordinalSlope=this.ordinalOffset=t}this.isOrdinal=e&&c;this.groupIntervalFactor=
null},val2lin:function(a,b){var c=this.ordinalPositions,d;if(c){var e=c.length,f;for(d=e;d--;)if(c[d]===a){f=d;break}for(d=e-1;d--;)if(a>c[d]||d===0){c=(a-c[d])/(c[d+1]-c[d]);f=d+c;break}d=b?f:this.ordinalSlope*(f||0)+this.ordinalOffset}else d=a;return d},lin2val:function(a,b){var c=this.ordinalPositions;if(c){var d=this.ordinalSlope,e=this.ordinalOffset,f=c.length-1,g,h;if(b)a<0?a=c[0]:a>f?a=c[f]:(f=V(a),h=a-f);else for(;f--;)if(g=d*f+e,a>=g){d=d*(f+1)+e;h=(a-g)/(d-g);break}c=h!==t&&c[f]!==t?c[f]+
(h?h*(c[f+1]-c[f]):0):a}else c=a;return c},getExtendedPositions:function(){var a=this.chart,b=this.series[0].currentDataGrouping,c=this.ordinalIndex,d=b?b.count+b.unitName:"raw",e=this.getExtremes(),f,g;if(!c)c=this.ordinalIndex={};if(!c[d])f={series:[],getExtremes:function(){return{min:e.dataMin,max:e.dataMax}},options:{ordinal:!0},val2lin:J.prototype.val2lin},o(this.series,function(c){g={xAxis:f,xData:c.xData,chart:a,destroyGroupedData:ra};g.options={dataGrouping:b?{enabled:!0,forced:!0,approximation:"open",
units:[[b.unitName,[b.count]]]}:{enabled:!1}};c.processData.apply(g);f.series.push(g)}),this.beforeSetTickPositions.apply(f),c[d]=f.ordinalPositions;return c[d]},getGroupIntervalFactor:function(a,b,c){var d,c=c.processedXData,e=c.length,f=[];d=this.groupIntervalFactor;if(!d){for(d=0;d<e-1;d++)f[d]=c[d+1]-c[d];f.sort(function(a,b){return a-b});f=f[V(e/2)];a=w(a,c[0]);b=G(b,c[e-1]);this.groupIntervalFactor=d=e*f/(b-a)}return d},postProcessTickInterval:function(a){var b=this.ordinalSlope;return b?this.options.breaks?
this.closestPointRange:a/(b/this.closestPointRange):a}});U(Ba.prototype,"pan",function(a,b){var c=this.xAxis[0],d=b.chartX,e=!1;if(c.options.ordinal&&c.series.length){var f=this.mouseDownX,g=c.getExtremes(),h=g.dataMax,i=g.min,j=g.max,k=this.hoverPoints,l=c.closestPointRange,f=(f-d)/(c.translationSlope*(c.ordinalSlope||l)),m={ordinalPositions:c.getExtendedPositions()},l=c.lin2val,n=c.val2lin,p;if(m.ordinalPositions){if(S(f)>1)k&&o(k,function(a){a.setState()}),f<0?(k=m,p=c.ordinalPositions?c:m):(k=
c.ordinalPositions?c:m,p=m),m=p.ordinalPositions,h>m[m.length-1]&&m.push(h),this.fixedRange=j-i,f=c.toFixedRange(null,null,l.apply(k,[n.apply(k,[i,!0])+f,!0]),l.apply(p,[n.apply(p,[j,!0])+f,!0])),f.min>=G(g.dataMin,i)&&f.max<=w(h,j)&&c.setExtremes(f.min,f.max,!0,!1,{trigger:"pan"}),this.mouseDownX=d,N(this.container,{cursor:"move"})}else e=!0}else e=!0;e&&a.apply(this,Array.prototype.slice.call(arguments,1))});P.prototype.gappedPath=function(){var a=this.options.gapSize,b=this.points.slice(),c=b.length-
1;if(a&&c>0)for(;c--;)b[c+1].x-b[c].x>this.closestPointRange*a&&b.splice(c+1,0,{isNull:!0});return this.getGraphPath(b)};(function(a){a(B)})(function(a){function b(){return Array.prototype.slice.call(arguments,1)}function c(a){a.apply(this);this.drawBreaks(this.xAxis,["x"]);this.drawBreaks(this.yAxis,d(this.pointArrayMap,["y"]))}var d=a.pick,e=a.wrap,f=a.each,g=a.extend,h=a.fireEvent,i=a.Axis,j=a.Series;g(i.prototype,{isInBreak:function(a,b){var c=a.repeat||Infinity,d=a.from,e=a.to-a.from,c=b>=d?
(b-d)%c:c-(d-b)%c;return a.inclusive?c<=e:c<e&&c!==0},isInAnyBreak:function(a,b){var c=this.options.breaks,e=c&&c.length,f,g,h;if(e){for(;e--;)this.isInBreak(c[e],a)&&(f=!0,g||(g=d(c[e].showPoints,this.isXAxis?!1:!0)));h=f&&b?f&&!g:f}return h}});e(i.prototype,"setTickPositions",function(a){a.apply(this,Array.prototype.slice.call(arguments,1));if(this.options.breaks){var b=this.tickPositions,c=this.tickPositions.info,d=[],e;for(e=0;e<b.length;e++)this.isInAnyBreak(b[e])||d.push(b[e]);this.tickPositions=
d;this.tickPositions.info=c}});e(i.prototype,"init",function(a,b,c){if(c.breaks&&c.breaks.length)c.ordinal=!1;a.call(this,b,c);if(this.options.breaks){var d=this;d.isBroken=!0;this.val2lin=function(a){var b=a,c,e;for(e=0;e<d.breakArray.length;e++)if(c=d.breakArray[e],c.to<=a)b-=c.len;else if(c.from>=a)break;else if(d.isInBreak(c,a)){b-=a-c.from;break}return b};this.lin2val=function(a){var b,c;for(c=0;c<d.breakArray.length;c++)if(b=d.breakArray[c],b.from>=a)break;else b.to<a?a+=b.len:d.isInBreak(b,
a)&&(a+=b.len);return a};this.setExtremes=function(a,b,c,d,e){for(;this.isInAnyBreak(a);)a-=this.closestPointRange;for(;this.isInAnyBreak(b);)b-=this.closestPointRange;i.prototype.setExtremes.call(this,a,b,c,d,e)};this.setAxisTranslation=function(a){i.prototype.setAxisTranslation.call(this,a);var b=d.options.breaks,a=[],c=[],e=0,f,g,k=d.userMin||d.min,j=d.userMax||d.max,l,m;for(m in b)g=b[m],f=g.repeat||Infinity,d.isInBreak(g,k)&&(k+=g.to%f-k%f),d.isInBreak(g,j)&&(j-=j%f-g.from%f);for(m in b){g=b[m];
l=g.from;for(f=g.repeat||Infinity;l-f>k;)l-=f;for(;l<k;)l+=f;for(;l<j;l+=f)a.push({value:l,move:"in"}),a.push({value:l+(g.to-g.from),move:"out",size:g.breakSize})}a.sort(function(a,b){return a.value===b.value?(a.move==="in"?0:1)-(b.move==="in"?0:1):a.value-b.value});b=0;l=k;for(m in a){g=a[m];b+=g.move==="in"?1:-1;if(b===1&&g.move==="in")l=g.value;b===0&&(c.push({from:l,to:g.value,len:g.value-l-(g.size||0)}),e+=g.value-l-(g.size||0))}d.breakArray=c;h(d,"afterBreaks");d.transA*=(j-d.min)/(j-k-e);d.min=
k;d.max=j}}});e(j.prototype,"generatePoints",function(a){a.apply(this,b(arguments));var c=this.xAxis,d=this.yAxis,e=this.points,f,g=e.length,h=this.options.connectNulls,i;if(c&&d&&(c.options.breaks||d.options.breaks))for(;g--;)if(f=e[g],i=f.y===null&&h===!1,!i&&(c.isInAnyBreak(f.x,!0)||d.isInAnyBreak(f.y,!0)))e.splice(g,1),this.data[g]&&this.data[g].destroyElements()});a.Series.prototype.drawBreaks=function(a,b){var c=this,e=c.points,g,i,j,o;f(b,function(b){g=a.breakArray||[];i=a.isXAxis?a.min:d(c.options.threshold,
a.min);f(e,function(c){o=d(c["stack"+b.toUpperCase()],c[b]);f(g,function(b){j=!1;if(i<b.from&&o>b.to||i>b.from&&o<b.from)j="pointBreak";else if(i<b.from&&o>b.from&&o<b.to||i>b.from&&o>b.to&&o<b.from)j="pointInBreak";j&&h(a,j,{point:c,brk:b})})})})};e(a.seriesTypes.column.prototype,"drawPoints",c);e(a.Series.prototype,"drawPoints",c)});var ia=P.prototype,cc=ia.processData,dc=ia.generatePoints,ec=ia.destroy,fc={approximation:"average",groupPixelWidth:2,dateTimeLabelFormats:{millisecond:["%A, %b %e, %H:%M:%S.%L",
"%A, %b %e, %H:%M:%S.%L","-%H:%M:%S.%L"],second:["%A, %b %e, %H:%M:%S","%A, %b %e, %H:%M:%S","-%H:%M:%S"],minute:["%A, %b %e, %H:%M","%A, %b %e, %H:%M","-%H:%M"],hour:["%A, %b %e, %H:%M","%A, %b %e, %H:%M","-%H:%M"],day:["%A, %b %e, %Y","%A, %b %e","-%A, %b %e, %Y"],week:["Week from %A, %b %e, %Y","%A, %b %e","-%A, %b %e, %Y"],month:["%B %Y","%B","-%B %Y"],year:["%Y","%Y","-%Y"]}},Xb={line:{},spline:{},area:{},areaspline:{},column:{approximation:"sum",groupPixelWidth:10},arearange:{approximation:"range"},
areasplinerange:{approximation:"range"},columnrange:{approximation:"range",groupPixelWidth:10},candlestick:{approximation:"ohlc",groupPixelWidth:10},ohlc:{approximation:"ohlc",groupPixelWidth:5}},Yb=[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1]],["week",[1]],["month",[1,3,6]],["year",null]],Ta={sum:function(a){var b=a.length,c;if(!b&&a.hasNulls)c=null;else if(b)for(c=0;b--;)c+=a[b];return c},average:function(a){var b=
a.length,a=Ta.sum(a);C(a)&&b&&(a/=b);return a},open:function(a){return a.length?a[0]:a.hasNulls?null:t},high:function(a){return a.length?Da(a):a.hasNulls?null:t},low:function(a){return a.length?Ma(a):a.hasNulls?null:t},close:function(a){return a.length?a[a.length-1]:a.hasNulls?null:t},ohlc:function(a,b,c,d){a=Ta.open(a);b=Ta.high(b);c=Ta.low(c);d=Ta.close(d);if(C(a)||C(b)||C(c)||C(d))return[a,b,c,d]},range:function(a,b){a=Ta.low(a);b=Ta.high(b);if(C(a)||C(b))return[a,b]}};ia.groupData=function(a,
b,c,d){var e=this.data,f=this.options.data,g=[],h=[],i=[],j=a.length,k,l,m=!!b,n=[[],[],[],[]],d=typeof d==="function"?d:Ta[d],p=this.pointArrayMap,o=p&&p.length,q,v=0;for(q=0;q<=j;q++)if(a[q]>=c[0])break;for(;q<=j;q++){for(;c[1]!==t&&a[q]>=c[1]||q===j;)if(k=c.shift(),l=d.apply(0,n),l!==t&&(g.push(k),h.push(l),i.push({start:v,length:n[0].length})),v=q,n[0]=[],n[1]=[],n[2]=[],n[3]=[],q===j)break;if(q===j)break;if(p){k=this.cropStart+q;k=e&&e[k]||this.pointClass.prototype.applyOptions.apply({series:this},
[f[k]]);var u;for(l=0;l<o;l++)if(u=k[p[l]],C(u))n[l].push(u);else if(u===null)n[l].hasNulls=!0}else if(k=m?b[q]:null,C(k))n[0].push(k);else if(k===null)n[0].hasNulls=!0}return[g,h,i]};ia.processData=function(){var a=this.chart,b=this.options.dataGrouping,c=this.allowDG!==!1&&b&&q(b.enabled,a.options._stock),d;this.forceCrop=c;this.groupPixelWidth=null;this.hasProcessed=!0;if(cc.apply(this,arguments)!==!1&&c){this.destroyGroupedData();var e=this.processedXData,f=this.processedYData,g=a.plotSizeX,a=
this.xAxis,h=a.options.ordinal,i=this.groupPixelWidth=a.getGroupPixelWidth&&a.getGroupPixelWidth();if(i){d=!0;this.points=null;var j=a.getExtremes(),c=j.min,j=j.max,h=h&&a.getGroupIntervalFactor(c,j,this)||1,g=i*(j-c)/g*h,i=a.getTimeTicks(a.normalizeTimeTickInterval(g,b.units||Yb),Math.min(c,e[0]),Math.max(j,e[e.length-1]),a.options.startOfWeek,e,this.closestPointRange),e=ia.groupData.apply(this,[e,f,i,b.approximation]),f=e[0],h=e[1];if(b.smoothed){b=f.length-1;for(f[b]=Math.min(f[b],j);b--&&b>0;)f[b]+=
g/2;f[0]=Math.max(f[0],c)}this.currentDataGrouping=i.info;this.closestPointRange=i.info.totalRange;this.groupMap=e[2];if(v(f[0])&&f[0]<a.dataMin){if(a.min===a.dataMin)a.min=f[0];a.dataMin=f[0]}this.processedXData=f;this.processedYData=h}else this.currentDataGrouping=this.groupMap=null;this.hasGroupedData=d}};ia.destroyGroupedData=function(){var a=this.groupedData;o(a||[],function(b,c){b&&(a[c]=b.destroy?b.destroy():null)});this.groupedData=null};ia.generatePoints=function(){dc.apply(this);this.destroyGroupedData();
this.groupedData=this.hasGroupedData?this.points:null};U(Lb.prototype,"tooltipFooterHeaderFormatter",function(a,b,c){var d=b.series,e=d.tooltipOptions,f=d.options.dataGrouping,g=e.xDateFormat,h,i=d.xAxis;return i&&i.options.type==="datetime"&&f&&C(b.key)?(a=d.currentDataGrouping,f=f.dateTimeLabelFormats,a?(i=f[a.unitName],a.count===1?g=i[0]:(g=i[1],h=i[2])):!g&&f&&(g=this.getXDateFormat(b,e,i)),g=na(g,b.key),h&&(g+=na(h,b.key+a.totalRange-1)),La(e[(c?"footer":"header")+"Format"],{point:A(b,{key:g}),
series:d})):a.call(this,b,c)});ia.destroy=function(){for(var a=this.groupedData||[],b=a.length;b--;)a[b]&&a[b].destroy();ec.apply(this)};U(ia,"setOptions",function(a,b){var c=a.call(this,b),d=this.type,e=this.chart.options.plotOptions,f=W[d].dataGrouping;if(Xb[d])f||(f=z(fc,Xb[d])),c.dataGrouping=z(f,e.series&&e.series.dataGrouping,e[d].dataGrouping,b.dataGrouping);if(this.chart.options._stock)this.requireSorting=!0;return c});U(J.prototype,"setScale",function(a){a.call(this);o(this.series,function(a){a.hasProcessed=
!1})});J.prototype.getGroupPixelWidth=function(){var a=this.series,b=a.length,c,d=0,e=!1,f;for(c=b;c--;)(f=a[c].options.dataGrouping)&&(d=w(d,f.groupPixelWidth));for(c=b;c--;)if((f=a[c].options.dataGrouping)&&a[c].hasProcessed)if(b=(a[c].processedXData||a[c].data).length,a[c].groupPixelWidth||b>this.chart.plotSizeX/d||b&&f.forced)e=!0;return e?d:0};J.prototype.setDataGrouping=function(a,b){var c,b=q(b,!0);a||(a={forced:!1,units:null});if(this instanceof J)for(c=this.series.length;c--;)this.series[c].update({dataGrouping:a},
!1);else o(this.chart.options.series,function(b){b.dataGrouping=a},!1);b&&this.chart.redraw()};W.ohlc=z(W.column,{lineWidth:1,tooltip:{pointFormat:'<span style="color:{point.color}">\u25cf</span> <b> {series.name}</b><br/>Open: {point.open}<br/>High: {point.high}<br/>Low: {point.low}<br/>Close: {point.close}<br/>'},states:{hover:{lineWidth:3}},threshold:null});da=ma(I.column,{type:"ohlc",pointArrayMap:["open","high","low","close"],toYData:function(a){return[a.open,a.high,a.low,a.close]},pointValKey:"high",
pointAttrToOptions:{stroke:"color","stroke-width":"lineWidth"},upColorProp:"stroke",getAttribs:function(){I.column.prototype.getAttribs.apply(this,arguments);var a=this.options,b=a.states,a=a.upColor||this.color,c=z(this.pointAttr),d=this.upColorProp;c[""][d]=a;c.hover[d]=b.hover.upColor||a;c.select[d]=b.select.upColor||a;o(this.points,function(a){if(a.open<a.close&&!a.options.color)a.pointAttr=c})},translate:function(){var a=this.yAxis;I.column.prototype.translate.apply(this);o(this.points,function(b){if(b.open!==
null)b.plotOpen=a.translate(b.open,0,1,0,1);if(b.close!==null)b.plotClose=a.translate(b.close,0,1,0,1)})},drawPoints:function(){var a=this,b=a.chart,c,d,e,f,g,h,i,j;o(a.points,function(k){if(k.plotY!==t)i=k.graphic,c=k.pointAttr[k.selected?"selected":""]||a.pointAttr[""],f=c["stroke-width"]%2/2,j=y(k.plotX)-f,g=y(k.shapeArgs.width/2),h=["M",j,y(k.yBottom),"L",j,y(k.plotY)],k.open!==null&&(d=y(k.plotOpen)+f,h.push("M",j,d,"L",j-g,d)),k.close!==null&&(e=y(k.plotClose)+f,h.push("M",j,e,"L",j+g,e)),i?
i.attr(c).animate({d:h}):k.graphic=b.renderer.path(h).attr(c).add(a.group)})},animate:null});I.ohlc=da;W.candlestick=z(W.column,{lineColor:"black",lineWidth:1,states:{hover:{lineWidth:2}},tooltip:W.ohlc.tooltip,threshold:null,upColor:"white"});da=ma(da,{type:"candlestick",pointAttrToOptions:{fill:"color",stroke:"lineColor","stroke-width":"lineWidth"},upColorProp:"fill",getAttribs:function(){I.ohlc.prototype.getAttribs.apply(this,arguments);var a=this.options,b=a.states,c=a.upLineColor||a.lineColor,
d=b.hover.upLineColor||c,e=b.select.upLineColor||c;o(this.points,function(a){if(a.open<a.close){if(a.lineColor)a.pointAttr=z(a.pointAttr),c=a.lineColor;a.pointAttr[""].stroke=c;a.pointAttr.hover.stroke=d;a.pointAttr.select.stroke=e}})},drawPoints:function(){var a=this,b=a.chart,c,d=a.pointAttr[""],e,f,g,h,i,j,k,l,m,n,p;o(a.points,function(o){m=o.graphic;if(o.plotY!==t)c=o.pointAttr[o.selected?"selected":""]||d,k=c["stroke-width"]%2/2,l=y(o.plotX)-k,e=o.plotOpen,f=o.plotClose,g=Y.min(e,f),h=Y.max(e,
f),p=y(o.shapeArgs.width/2),i=y(g)!==y(o.plotY),j=h!==o.yBottom,g=y(g)+k,h=y(h)+k,n=[],n.push("M",l-p,h,"L",l-p,g,"L",l+p,g,"L",l+p,h,"Z","M",l,g,"L",l,i?y(o.plotY):g,"M",l,h,"L",l,j?y(o.yBottom):h),m?m.attr(c).animate({d:n}):o.graphic=b.renderer.path(n).attr(c).add(a.group).shadow(a.options.shadow)})}});I.candlestick=da;var vb=xa.prototype.symbols;W.flags=z(W.column,{fillColor:"white",lineWidth:1,pointRange:0,shape:"flag",stackDistance:12,states:{hover:{lineColor:"black",fillColor:"#FCFFC5"}},style:{fontSize:"11px",
fontWeight:"bold",textAlign:"center"},tooltip:{pointFormat:"{point.text}<br/>"},threshold:null,y:-30});I.flags=ma(I.column,{type:"flags",sorted:!1,noSharedTooltip:!0,allowDG:!1,takeOrdinalPosition:!1,trackerGroups:["markerGroup"],forceCrop:!0,init:P.prototype.init,pointAttrToOptions:{fill:"fillColor",stroke:"color","stroke-width":"lineWidth",r:"radius"},translate:function(){I.column.prototype.translate.apply(this);var a=this.options,b=this.chart,c=this.points,d=c.length-1,e,f,g=a.onSeries;e=g&&b.get(g);
var a=a.onKey||"y",g=e&&e.options.step,h=e&&e.points,i=h&&h.length,j=this.xAxis,k=j.getExtremes(),l,m,n;if(e&&e.visible&&i){e=e.currentDataGrouping;m=h[i-1].x+(e?e.totalRange:0);c.sort(function(a,b){return a.x-b.x});for(a="plot"+a[0].toUpperCase()+a.substr(1);i--&&c[d];)if(e=c[d],l=h[i],l.x<=e.x&&l[a]!==void 0){if(e.x<=m)e.plotY=l[a],l.x<e.x&&!g&&(n=h[i+1])&&n[a]!==t&&(e.plotY+=(e.x-l.x)/(n.x-l.x)*(n[a]-l[a]));d--;i++;if(d<0)break}}o(c,function(a,d){var e;if(a.plotY===t)a.x>=k.min&&a.x<=k.max?a.plotY=
b.chartHeight-j.bottom-(j.opposite?j.height:0)+j.offset-b.plotTop:a.shapeArgs={};if((f=c[d-1])&&f.plotX===a.plotX){if(f.stackIndex===t)f.stackIndex=0;e=f.stackIndex+1}a.stackIndex=e})},drawPoints:function(){var a,b=this.pointAttr[""],c=this.points,d=this.chart,e=d.renderer,f,g,h=this.options,i=h.y,j,k,l,m,n,p,o=this.yAxis;for(k=c.length;k--;)if(l=c[k],a=l.plotX>this.xAxis.len,f=l.plotX,f>0&&(f-=q(l.lineWidth,h.lineWidth)%2),m=l.stackIndex,j=l.options.shape||h.shape,g=l.plotY,g!==t&&(g=l.plotY+i-(m!==
t&&m*h.stackDistance)),n=m?t:l.plotX,p=m?t:l.plotY,m=l.graphic,g!==t&&f>=0&&!a)a=l.pointAttr[l.selected?"select":""]||b,m?m.attr({x:f,y:g,r:a.r,anchorX:n,anchorY:p}):l.graphic=e.label(l.options.title||h.title||"A",f,g,j,n,p,h.useHTML).css(z(h.style,l.style)).attr(a).attr({align:j==="flag"?"left":"center",width:h.width,height:h.height}).add(this.markerGroup).shadow(h.shadow),l.tooltipPos=d.inverted?[o.len+o.pos-d.plotLeft-g,this.xAxis.len-f]:[f,g];else if(m)l.graphic=m.destroy()},drawTracker:function(){var a=
this.points;mb.drawTrackerPoint.apply(this);o(a,function(b){var c=b.graphic;c&&E(c.element,"mouseover",function(){if(b.stackIndex>0&&!b.raised)b._y=c.y,c.attr({y:b._y-8}),b.raised=!0;o(a,function(a){if(a!==b&&a.raised&&a.graphic)a.graphic.attr({y:a._y}),a.raised=!1})})})},animate:ra,buildKDTree:ra,setClip:ra});vb.flag=function(a,b,c,d,e){return["M",e&&e.anchorX||a,e&&e.anchorY||b,"L",a,b+d,a,b,a+c,b,a+c,b+d,a,b+d,"Z"]};o(["circle","square"],function(a){vb[a+"pin"]=function(b,c,d,e,f){var g=f&&f.anchorX,
f=f&&f.anchorY;a==="circle"&&e>d&&(b-=y((e-d)/2),d=e);b=vb[a](b,c,d,e);g&&f&&b.push("M",g,c>f?c:c+e,"L",g,f);return b}});Xa===B.VMLRenderer&&o(["flag","circlepin","squarepin"],function(a){lb.prototype.symbols[a]=vb[a]});var da=[].concat(Yb),wb=function(a){var b=Fa(arguments,function(a){return C(a)});if(b.length)return Math[a].apply(0,b)};da[4]=["day",[1,2,3,4]];da[5]=["week",[1,2,3]];A(R,{navigator:{handles:{backgroundColor:"#ebe7e8",borderColor:"#b2b1b6"},height:40,margin:25,maskFill:"rgba(128,179,236,0.3)",
maskInside:!0,outlineColor:"#b2b1b6",outlineWidth:1,series:{type:I.areaspline===t?"line":"areaspline",color:"#4572A7",compare:null,fillOpacity:0.05,dataGrouping:{approximation:"average",enabled:!0,groupPixelWidth:2,smoothed:!0,units:da},dataLabels:{enabled:!1,zIndex:2},id:"highcharts-navigator-series",lineColor:null,lineWidth:1,marker:{enabled:!1},pointRange:0,shadow:!1,threshold:null},xAxis:{tickWidth:0,lineWidth:0,gridLineColor:"#EEE",gridLineWidth:1,tickPixelInterval:200,labels:{align:"left",style:{color:"#888"},
x:3,y:-4},crosshair:!1},yAxis:{gridLineWidth:0,startOnTick:!1,endOnTick:!1,minPadding:0.1,maxPadding:0.1,labels:{enabled:!1},crosshair:!1,title:{text:null},tickWidth:0}},scrollbar:{height:jb?20:14,barBackgroundColor:"#bfc8d1",barBorderRadius:0,barBorderWidth:1,barBorderColor:"#bfc8d1",buttonArrowColor:"#666",buttonBackgroundColor:"#ebe7e8",buttonBorderColor:"#bbb",buttonBorderRadius:0,buttonBorderWidth:1,minWidth:6,rifleColor:"#666",trackBackgroundColor:"#eeeeee",trackBorderColor:"#eeeeee",trackBorderWidth:1,
liveRedraw:ja&&!jb}});Gb.prototype={drawHandle:function(a,b){var c=this.chart.renderer,d=this.elementsToDestroy,e=this.handles,f=this.navigatorOptions.handles,f={fill:f.backgroundColor,stroke:f.borderColor,"stroke-width":1},g;this.rendered||(e[b]=c.g("navigator-handle-"+["left","right"][b]).css({cursor:"ew-resize"}).attr({zIndex:10-b}).add(),g=c.rect(-4.5,0,9,16,0,1).attr(f).add(e[b]),d.push(g),g=c.path(["M",-1.5,4,"L",-1.5,12,"M",0.5,4,"L",0.5,12]).attr(f).add(e[b]),d.push(g));e[b][this.rendered?
"animate":"attr"]({translateX:this.scrollerLeft+this.scrollbarHeight+parseInt(a,10),translateY:this.top+this.height/2-8})},drawScrollbarButton:function(a){var b=this.chart.renderer,c=this.elementsToDestroy,d=this.scrollbarButtons,e=this.scrollbarHeight,f=this.scrollbarOptions,g;this.rendered||(d[a]=b.g().add(this.scrollbarGroup),g=b.rect(-0.5,-0.5,e+1,e+1,f.buttonBorderRadius,f.buttonBorderWidth).attr({stroke:f.buttonBorderColor,"stroke-width":f.buttonBorderWidth,fill:f.buttonBackgroundColor}).add(d[a]),
c.push(g),g=b.path(["M",e/2+(a?-1:1),e/2-3,"L",e/2+(a?-1:1),e/2+3,e/2+(a?2:-2),e/2]).attr({fill:f.buttonArrowColor}).add(d[a]),c.push(g));a&&d[a].attr({translateX:this.scrollerWidth-e})},render:function(a,b,c,d){var e=this.chart,f=e.renderer,g,h,i,j,k=this.scrollbarGroup,l=this.navigatorGroup,m=this.scrollbar,l=this.xAxis,n=this.scrollbarTrack,p=this.scrollbarHeight,o=this.scrollbarEnabled,s=this.navigatorOptions,t=this.scrollbarOptions,u=t.minWidth,x=this.height,D=this.top,z=this.navigatorEnabled,
A=s.outlineWidth,B=A/2,E=0,H=this.outlineHeight,K=t.barBorderRadius,J=t.barBorderWidth,I=D+B,L=this.rendered;if(C(a)&&C(b)&&(!this.hasDragged||v(c))){this.navigatorLeft=g=q(l.left,e.plotLeft+p);this.navigatorWidth=h=q(l.len,e.plotWidth-2*p);this.scrollerLeft=i=g-p;this.scrollerWidth=j=j=h+2*p;c=q(c,l.translate(a));d=q(d,l.translate(b));if(!C(c)||S(c)===Infinity)c=0,d=j;if(!(l.translate(d,!0)-l.translate(c,!0)<e.xAxis[0].minRange)){this.zoomedMax=G(w(c,d,0),h);this.zoomedMin=G(w(this.fixedWidth?this.zoomedMax-
this.fixedWidth:G(c,d),0),h);this.range=this.zoomedMax-this.zoomedMin;c=y(this.zoomedMax);b=y(this.zoomedMin);a=c-b;if(!L){if(z)this.navigatorGroup=l=f.g("navigator").attr({zIndex:3}).add(),this.leftShade=f.rect().attr({fill:s.maskFill}).add(l),s.maskInside?this.leftShade.css({cursor:"ew-resize"}):this.rightShade=f.rect().attr({fill:s.maskFill}).add(l),this.outline=f.path().attr({"stroke-width":A,stroke:s.outlineColor}).add(l);if(o)this.scrollbarGroup=k=f.g("scrollbar").add(),m=t.trackBorderWidth,
this.scrollbarTrack=n=f.rect().attr({x:0,y:-m%2/2,fill:t.trackBackgroundColor,stroke:t.trackBorderColor,"stroke-width":m,r:t.trackBorderRadius||0,height:p}).add(k),this.scrollbar=m=f.rect().attr({y:-J%2/2,height:p,fill:t.barBackgroundColor,stroke:t.barBorderColor,"stroke-width":J,r:K}).add(k),this.scrollbarRifles=f.path().attr({stroke:t.rifleColor,"stroke-width":1}).add(k)}f=L?"animate":"attr";if(z){this.leftShade[f](s.maskInside?{x:g+b,y:D,width:c-b,height:x}:{x:g,y:D,width:b,height:x});if(this.rightShade)this.rightShade[f]({x:g+
c,y:D,width:h-c,height:x});this.outline[f]({d:["M",i,I,"L",g+b-B,I,g+b-B,I+H,"L",g+c-B,I+H,"L",g+c-B,I,i+j,I].concat(s.maskInside?["M",g+b+B,I,"L",g+c-B,I]:[])});this.drawHandle(b+B,0);this.drawHandle(c+B,1)}if(o&&k)this.drawScrollbarButton(0),this.drawScrollbarButton(1),k[f]({translateX:i,translateY:y(I+x)}),n[f]({width:j}),g=p+b,h=a-J,h<u&&(E=(u-h)/2,h=u,g-=E),this.scrollbarPad=E,m[f]({x:V(g)+J%2/2,width:h}),u=p+b+a/2-0.5,this.scrollbarRifles.attr({visibility:a>12?"visible":"hidden"})[f]({d:["M",
u-3,p/4,"L",u-3,2*p/3,"M",u,p/4,"L",u,2*p/3,"M",u+3,p/4,"L",u+3,2*p/3]});this.scrollbarPad=E;this.rendered=!0}}},addEvents:function(){var a=this.chart,b=a.container,c=this.mouseDownHandler,d=this.mouseMoveHandler,e=this.mouseUpHandler,f;f=[[b,"mousedown",c],[b,"mousemove",d],[H,"mouseup",e]];cb&&f.push([b,"touchstart",c],[b,"touchmove",d],[H,"touchend",e]);o(f,function(a){E.apply(null,a)});this._events=f;this.series&&E(this.series.xAxis,"foundExtremes",function(){a.scroller.modifyNavigatorAxisExtremes()});
E(a,"redraw",function(){var a=this.scroller,b;if(a)(b=a.baseSeries.xAxis)&&a.render(b.min,b.max)})},removeEvents:function(){o(this._events,function(a){T.apply(null,a)});this._events=t;this.navigatorEnabled&&this.baseSeries&&T(this.baseSeries,"updatedData",this.updatedDataHandler)},init:function(){var a=this,b=a.chart,c,d,e=a.scrollbarHeight,f=a.navigatorOptions,g=a.height,h=a.top,i,j=a.baseSeries;a.mouseDownHandler=function(d){var d=b.pointer.normalize(d),e=a.zoomedMin,f=a.zoomedMax,h=a.top,j=a.scrollbarHeight,
k=a.scrollerLeft,l=a.scrollerWidth,o=a.navigatorLeft,q=a.navigatorWidth,v=a.scrollbarPad,t=a.range,w=d.chartX,y=d.chartY,d=b.xAxis[0],z,A=jb?10:7;if(y>h&&y<h+g+j)if((h=!a.scrollbarEnabled||y<h+g)&&Y.abs(w-e-o)<A)a.grabbedLeft=!0,a.otherHandlePos=f,a.fixedExtreme=d.max,b.fixedRange=null;else if(h&&Y.abs(w-f-o)<A)a.grabbedRight=!0,a.otherHandlePos=e,a.fixedExtreme=d.min,b.fixedRange=null;else if(w>o+e-v&&w<o+f+v)a.grabbedCenter=w,a.fixedWidth=t,i=w-e;else if(w>k&&w<k+l){f=h?w-o-t/2:w<o?e-t*0.2:w>k+
l-j?e+t*0.2:w<o+e?e-t:f;if(f<0)f=0;else if(f+t>=q)f=q-t,z=a.getUnionExtremes().dataMax;if(f!==e)a.fixedWidth=t,e=c.toFixedRange(f,f+t,null,z),d.setExtremes(e.min,e.max,!0,!1,{trigger:"navigator"})}};a.mouseMoveHandler=function(c){var d=a.scrollbarHeight,e=a.navigatorLeft,f=a.navigatorWidth,g=a.scrollerLeft,h=a.scrollerWidth,j=a.range,k,l;if(!c.touches||c.touches[0].pageX!==0)c=b.pointer.normalize(c),k=c.chartX,k<e?k=e:k>g+h-d&&(k=g+h-d),a.grabbedLeft?(l=!0,a.render(0,0,k-e,a.otherHandlePos)):a.grabbedRight?
(l=!0,a.render(0,0,a.otherHandlePos,k-e)):a.grabbedCenter&&(l=!0,k<i?k=i:k>f+i-j&&(k=f+i-j),a.render(0,0,k-i,k-i+j)),l&&a.scrollbarOptions.liveRedraw&&setTimeout(function(){a.mouseUpHandler(c)},0),a.hasDragged=l};a.mouseUpHandler=function(d){var e,f;if(a.hasDragged){if(a.zoomedMin===a.otherHandlePos)e=a.fixedExtreme;else if(a.zoomedMax===a.otherHandlePos)f=a.fixedExtreme;if(a.zoomedMax===a.navigatorWidth)f=a.getUnionExtremes().dataMax;e=c.toFixedRange(a.zoomedMin,a.zoomedMax,e,f);v(e.min)&&b.xAxis[0].setExtremes(e.min,
e.max,!0,!1,{trigger:"navigator",triggerOp:"navigator-drag",DOMEvent:d})}if(d.type!=="mousemove")a.grabbedLeft=a.grabbedRight=a.grabbedCenter=a.fixedWidth=a.fixedExtreme=a.otherHandlePos=a.hasDragged=i=null};var k=b.xAxis.length,l=b.yAxis.length;b.extraBottomMargin=a.outlineHeight+f.margin;a.navigatorEnabled?(a.xAxis=c=new J(b,z({breaks:j&&j.xAxis.options.breaks,ordinal:j&&j.xAxis.options.ordinal},f.xAxis,{id:"navigator-x-axis",isX:!0,type:"datetime",index:k,height:g,offset:0,offsetLeft:e,offsetRight:-e,
keepOrdinalPadding:!0,startOnTick:!1,endOnTick:!1,minPadding:0,maxPadding:0,zoomEnabled:!1})),a.yAxis=d=new J(b,z(f.yAxis,{id:"navigator-y-axis",alignTicks:!1,height:g,offset:0,index:l,zoomEnabled:!1})),j||f.series.data?a.addBaseSeries():b.series.length===0&&U(b,"redraw",function(c,d){if(b.series.length>0&&!a.series)a.setBaseSeries(),b.redraw=c;c.call(b,d)})):a.xAxis=c={translate:function(a,c){var d=b.xAxis[0],f=d.getExtremes(),g=b.plotWidth-2*e,h=wb("min",d.options.min,f.dataMin),d=wb("max",d.options.max,
f.dataMax)-h;return c?a*d/g+h:g*(a-h)/d},toFixedRange:J.prototype.toFixedRange};if(j&&j.xAxis&&this.navigatorOptions.adaptToUpdatedData!==!1)E(j,"updatedData",this.updatedDataHandler),E(j.xAxis,"foundExtremes",function(){j.xAxis&&this.chart.scroller.modifyBaseAxisExtremes()}),j.userOptions.events=A(j.userOptions.event,{updatedData:this.updatedDataHandler});U(b,"getMargins",function(b){var e=this.legend,f=e.options;b.apply(this,[].slice.call(arguments,1));a.top=h=a.navigatorOptions.top||this.chartHeight-
a.height-a.scrollbarHeight-this.spacing[2]-(f.verticalAlign==="bottom"&&f.enabled&&!f.floating?e.legendHeight+q(f.margin,10):0);if(c&&d)c.options.top=d.options.top=h,c.setAxisSize(),d.setAxisSize()});a.addEvents()},getUnionExtremes:function(a){var b=this.chart.xAxis[0],c=this.xAxis,d=c.options,e=b.options,f;if(!a||b.dataMin!==null)f={dataMin:q(d&&d.min,wb("min",e.min,b.dataMin,c.dataMin,c.min)),dataMax:q(d&&d.max,wb("max",e.max,b.dataMax,c.dataMax,c.max))};return f},setBaseSeries:function(a){var b=
this.chart,a=a||b.options.navigator.baseSeries;this.series&&this.series.remove();this.baseSeries=b.series[a]||typeof a==="string"&&b.get(a)||b.series[0];this.xAxis&&this.addBaseSeries()},addBaseSeries:function(){var a=this.baseSeries,b=a?a.options:{},a=b.data,c=this.navigatorOptions.series,d;d=c.data;this.hasNavigatorData=!!d;b=z(b,c,{enableMouseTracking:!1,group:"nav",padXAxis:!1,xAxis:"navigator-x-axis",yAxis:"navigator-y-axis",name:"Navigator",showInLegend:!1,stacking:!1,isInternal:!0,visible:!0});
b.data=d||a.slice(0);this.series=this.chart.initSeries(b)},modifyNavigatorAxisExtremes:function(){var a=this.xAxis,b;if(a.getExtremes&&(b=this.getUnionExtremes(!0))&&(b.dataMin!==a.min||b.dataMax!==a.max))a.min=b.dataMin,a.max=b.dataMax},modifyBaseAxisExtremes:function(){var a=this.baseSeries.xAxis,b=a.getExtremes(),c=b.dataMin,d=b.dataMax,b=b.max-b.min,e=this.stickToMin,f=this.stickToMax,g,h,i=this.series,j=!!a.setExtremes;e&&(h=c,g=h+b);f&&(g=d,e||(h=w(g-b,i?i.xData[0]:-Number.MAX_VALUE)));if(j&&
(e||f)&&C(h))a.min=a.userMin=h,a.max=a.userMax=g;this.stickToMin=this.stickToMax=null},updatedDataHandler:function(){var a=this.chart.scroller,b=a.baseSeries,c=a.series;a.stickToMin=b.xAxis.min<=b.xData[0];a.stickToMax=a.zoomedMax>=a.navigatorWidth;if(c&&!a.hasNavigatorData&&(c.options.pointStart=b.xData[0],c.setData(b.options.data,!1),c.graph&&b.graph))c.graph.shift=b.graph.shift},destroy:function(){this.removeEvents();o([this.xAxis,this.yAxis,this.leftShade,this.rightShade,this.outline,this.scrollbarTrack,
this.scrollbarRifles,this.scrollbarGroup,this.scrollbar],function(a){a&&a.destroy&&a.destroy()});this.xAxis=this.yAxis=this.leftShade=this.rightShade=this.outline=this.scrollbarTrack=this.scrollbarRifles=this.scrollbarGroup=this.scrollbar=null;o([this.scrollbarButtons,this.handles,this.elementsToDestroy],function(a){Pa(a)})}};B.Scroller=Gb;U(J.prototype,"zoom",function(a,b,c){var d=this.chart,e=d.options,f=e.chart.zoomType,g=e.navigator,e=e.rangeSelector,h;if(this.isXAxis&&(g&&g.enabled||e&&e.enabled))if(f===
"x")d.resetZoomButton="blocked";else if(f==="y")h=!1;else if(f==="xy")d=this.previousZoom,v(b)?this.previousZoom=[this.min,this.max]:d&&(b=d[0],c=d[1],delete this.previousZoom);return h!==t?h:a.call(this,b,c)});U(Ba.prototype,"init",function(a,b,c){E(this,"beforeRender",function(){var a=this.options;if(a.navigator.enabled||a.scrollbar.enabled)this.scroller=new Gb(this)});a.call(this,b,c)});U(P.prototype,"addPoint",function(a,b,c,d,e){var f=this.options.turboThreshold;f&&this.xData.length>f&&ea(b)&&
!Ja(b)&&this.chart.scroller&&ga(20,!0);a.call(this,b,c,d,e)});A(R,{rangeSelector:{buttonTheme:{width:28,height:18,fill:"#f7f7f7",padding:2,r:0,"stroke-width":0,style:{color:"#444",cursor:"pointer",fontWeight:"normal"},zIndex:7,states:{hover:{fill:"#e7e7e7"},select:{fill:"#e7f0f9",style:{color:"black",fontWeight:"bold"}}}},height:35,inputPosition:{align:"right"},labelStyle:{color:"#666"}}});R.lang=z(R.lang,{rangeSelectorZoom:"Zoom",rangeSelectorFrom:"From",rangeSelectorTo:"To"});Hb.prototype={clickButton:function(a,
b){var c=this,d=c.selected,e=c.chart,f=c.buttons,g=c.buttonOptions[a],h=e.xAxis[0],i=e.scroller&&e.scroller.getUnionExtremes()||h||{},j=i.dataMin,k=i.dataMax,l,m=h&&y(G(h.max,q(k,h.max))),n=g.type,p,i=g._range,r,s,v,u=g.dataGrouping;if(!(j===null||k===null||a===c.selected)){e.fixedRange=i;if(u)this.forcedDataGrouping=!0,J.prototype.setDataGrouping.call(h||{chart:this.chart},u,!1);if(n==="month"||n==="year")if(h){if(n={range:g,max:m,dataMin:j,dataMax:k},l=h.minFromRange.call(n),C(n.newMax))m=n.newMax}else i=
g;else if(i)l=w(m-i,j),m=G(l+i,k);else if(n==="ytd")if(h){if(k===t)j=Number.MAX_VALUE,k=Number.MIN_VALUE,o(e.series,function(a){a=a.xData;j=G(a[0],j);k=w(a[a.length-1],k)}),b=!1;m=new ba(k);l=m.getFullYear();l=r=w(j||0,ba.UTC(l,0,1));m=m.getTime();m=G(k||m,m)}else{E(e,"beforeRender",function(){c.clickButton(a)});return}else n==="all"&&h&&(l=j,m=k);f[d]&&f[d].setState(0);if(f[a])f[a].setState(2),c.lastSelected=a;h?(h.setExtremes(l,m,q(b,1),0,{trigger:"rangeSelectorButton",rangeSelectorButton:g}),c.setSelected(a)):
(p=e.options.xAxis[0],v=p.range,p.range=i,s=p.min,p.min=r,c.setSelected(a),E(e,"load",function(){p.range=v;p.min=s}))}},setSelected:function(a){this.selected=this.options.selected=a},defaultButtons:[{type:"month",count:1,text:"1m"},{type:"month",count:3,text:"3m"},{type:"month",count:6,text:"6m"},{type:"ytd",text:"YTD"},{type:"year",count:1,text:"1y"},{type:"all",text:"All"}],init:function(a){var b=this,c=a.options.rangeSelector,d=c.buttons||[].concat(b.defaultButtons),e=c.selected,f=b.blurInputs=
function(){var a=b.minInput,c=b.maxInput;a&&a.blur&&O(a,"blur");c&&c.blur&&O(c,"blur")};b.chart=a;b.options=c;b.buttons=[];a.extraTopMargin=c.height;b.buttonOptions=d;E(a.container,"mousedown",f);E(a,"resize",f);o(d,b.computeButtonRange);e!==t&&d[e]&&this.clickButton(e,!1);E(a,"load",function(){E(a.xAxis[0],"setExtremes",function(c){this.max-this.min!==a.fixedRange&&c.trigger!=="rangeSelectorButton"&&c.trigger!=="updatedData"&&b.forcedDataGrouping&&this.setDataGrouping(!1,!1)});E(a.xAxis[0],"afterSetExtremes",
function(){b.updateButtonStates(!0)})})},updateButtonStates:function(a){var b=this,c=this.chart,d=c.xAxis[0],e=c.scroller&&c.scroller.getUnionExtremes()||d,f=e.dataMin,g=e.dataMax,h=b.selected,i=b.options.allButtonsEnabled,j=b.buttons;a&&c.fixedRange!==y(d.max-d.min)&&(j[h]&&j[h].setState(0),b.setSelected(null));o(b.buttonOptions,function(a,e){var m=y(d.max-d.min),n=a._range,o=a.type,q=a.count||1,s=n>g-f,t=n<d.minRange,u=a.type==="all"&&d.max-d.min>=g-f&&j[e].state!==2,v=a.type==="ytd"&&na("%Y",f)===
na("%Y",g),w=c.renderer.forExport&&e===h,n=n===m,z=!d.hasVisibleSeries;if((o==="month"||o==="year")&&m>={month:28,year:365}[o]*864E5*q&&m<={month:31,year:366}[o]*864E5*q)n=!0;w||n&&e!==h&&e===b.lastSelected?(b.setSelected(e),j[e].setState(2)):!i&&(s||t||u||v||z)?j[e].setState(3):j[e].state===3&&j[e].setState(0)})},computeButtonRange:function(a){var b=a.type,c=a.count||1,d={millisecond:1,second:1E3,minute:6E4,hour:36E5,day:864E5,week:6048E5};if(d[b])a._range=d[b]*c;else if(b==="month"||b==="year")a._range=
{month:30,year:365}[b]*864E5*c},setInputValue:function(a,b){var c=this.chart.options.rangeSelector;if(v(b))this[a+"Input"].HCTime=b;this[a+"Input"].value=na(c.inputEditDateFormat||"%Y-%m-%d",this[a+"Input"].HCTime);this[a+"DateBox"].attr({text:na(c.inputDateFormat||"%b %e, %Y",this[a+"Input"].HCTime)})},showInput:function(a){var b=this.inputGroup,c=this[a+"DateBox"];N(this[a+"Input"],{left:b.translateX+c.x+"px",top:b.translateY+"px",width:c.width-2+"px",height:c.height-2+"px",border:"2px solid silver"})},
hideInput:function(a){N(this[a+"Input"],{border:0,width:"1px",height:"1px"});this.setInputValue(a)},drawInput:function(a){function b(){var a=j.value,b=(g.inputDateParser||ba.parse)(a),e=d.xAxis[0],f=e.dataMin,h=e.dataMax;if(b!==j.previousValue)j.previousValue=b,C(b)||(b=a.split("-"),b=ba.UTC(K(b[0]),K(b[1])-1,K(b[2]))),C(b)&&(R.global.useUTC||(b+=(new ba).getTimezoneOffset()*6E4),i?b>c.maxInput.HCTime?b=t:b<f&&(b=f):b<c.minInput.HCTime?b=t:b>h&&(b=h),b!==t&&d.xAxis[0].setExtremes(i?b:e.min,i?e.max:
b,t,t,{trigger:"rangeSelectorInput"}))}var c=this,d=c.chart,e=d.renderer.style,f=d.renderer,g=d.options.rangeSelector,h=c.div,i=a==="min",j,k,l=this.inputGroup;this[a+"Label"]=k=f.label(R.lang[i?"rangeSelectorFrom":"rangeSelectorTo"],this.inputGroup.offset).attr({padding:2}).css(z(e,g.labelStyle)).add(l);l.offset+=k.width+5;this[a+"DateBox"]=f=f.label("",l.offset).attr({padding:2,width:g.inputBoxWidth||90,height:g.inputBoxHeight||17,stroke:g.inputBoxBorderColor||"silver","stroke-width":1}).css(z({textAlign:"center",
color:"#444"},e,g.inputStyle)).on("click",function(){c.showInput(a);c[a+"Input"].focus()}).add(l);l.offset+=f.width+(i?10:0);this[a+"Input"]=j=fa("input",{name:a,className:"highcharts-range-selector",type:"text"},A({position:"absolute",border:0,width:"1px",height:"1px",padding:0,textAlign:"center",fontSize:e.fontSize,fontFamily:e.fontFamily,left:"-9em",top:d.plotTop+"px"},g.inputStyle),h);j.onfocus=function(){c.showInput(a)};j.onblur=function(){c.hideInput(a)};j.onchange=b;j.onkeypress=function(a){a.keyCode===
13&&b()}},getPosition:function(){var a=this.chart,b=a.options.rangeSelector,a=q((b.buttonPosition||{}).y,a.plotTop-a.axisOffset[0]-b.height);return{buttonTop:a,inputTop:a-10}},render:function(a,b){var c=this,d=c.chart,e=d.renderer,f=d.container,g=d.options,h=g.exporting&&g.exporting.enabled!==!1&&g.navigation&&g.navigation.buttonOptions,i=g.rangeSelector,j=c.buttons,g=R.lang,k=c.div,k=c.inputGroup,l=i.buttonTheme,m=i.buttonPosition||{},n=i.inputEnabled,p=l&&l.states,r=d.plotLeft,s,t=this.getPosition(),
u=c.group,w=c.rendered;if(!w&&(c.group=u=e.g("range-selector-buttons").add(),c.zoomText=e.text(g.rangeSelectorZoom,q(m.x,r),15).css(i.labelStyle).add(u),s=q(m.x,r)+c.zoomText.getBBox().width+5,o(c.buttonOptions,function(a,b){j[b]=e.button(a.text,s,0,function(){c.clickButton(b);c.isActive=!0},l,p&&p.hover,p&&p.select,p&&p.disabled).css({textAlign:"center"}).add(u);s+=j[b].width+q(i.buttonSpacing,5);c.selected===b&&j[b].setState(2)}),c.updateButtonStates(),n!==!1))c.div=k=fa("div",null,{position:"relative",
height:0,zIndex:1}),f.parentNode.insertBefore(k,f),c.inputGroup=k=e.g("input-group").add(),k.offset=0,c.drawInput("min"),c.drawInput("max");u[w?"animate":"attr"]({translateY:t.buttonTop});n!==!1&&(k.align(A({y:t.inputTop,width:k.offset,x:h&&t.inputTop<(h.y||0)+h.height-d.spacing[0]?-40:0},i.inputPosition),!0,d.spacingBox),v(n)||(d=u.getBBox(),k[k.translateX<d.x+d.width+10?"hide":"show"]()),c.setInputValue("min",a),c.setInputValue("max",b));c.rendered=!0},destroy:function(){var a=this.minInput,b=this.maxInput,
c=this.chart,d=this.blurInputs,e;T(c.container,"mousedown",d);T(c,"resize",d);Pa(this.buttons);if(a)a.onfocus=a.onblur=a.onchange=null;if(b)b.onfocus=b.onblur=b.onchange=null;for(e in this)this[e]&&e!=="chart"&&(this[e].destroy?this[e].destroy():this[e].nodeType&&Ua(this[e])),this[e]=null}};J.prototype.toFixedRange=function(a,b,c,d){var e=this.chart&&this.chart.fixedRange,a=q(c,this.translate(a,!0)),b=q(d,this.translate(b,!0)),c=e&&(b-a)/e;c>0.7&&c<1.3&&(d?a=b-e:b=a+e);C(a)||(a=b=void 0);return{min:a,
max:b}};J.prototype.minFromRange=function(){var a=this.range,b={month:"Month",year:"FullYear"}[a.type],c,d=this.max,e,f,g=function(a,c){var d=new ba(a);d["set"+b](d["get"+b]()+c);return d.getTime()-a};C(a)?(c=this.max-a,f=a):c=d+g(d,-a.count);e=q(this.dataMin,Number.MIN_VALUE);C(c)||(c=e);if(c<=e)c=e,f===void 0&&(f=g(c,a.count)),this.newMax=G(c+f,this.dataMax);C(d)||(c=void 0);return c};U(Ba.prototype,"init",function(a,b,c){E(this,"init",function(){if(this.options.rangeSelector.enabled)this.rangeSelector=
new Hb(this)});a.call(this,b,c)});B.RangeSelector=Hb;Ba.prototype.callbacks.push(function(a){function b(){d=a.xAxis[0].getExtremes();C(d.min)&&f.render(d.min,d.max)}function c(a){f.render(a.min,a.max)}var d,e=a.scroller,f=a.rangeSelector;e&&(d=a.xAxis[0].getExtremes(),e.render(d.min,d.max));f&&(E(a.xAxis[0],"afterSetExtremes",c),E(a,"resize",b),b());E(a,"destroy",function(){f&&(T(a,"resize",b),T(a.xAxis[0],"afterSetExtremes",c))})});B.StockChart=B.stockChart=function(a,b,c){var d=Ca(a)||a.nodeName,
e=arguments[d?1:0],f=e.series,g,h=q(e.navigator&&e.navigator.enabled,!0)?{startOnTick:!1,endOnTick:!1}:null,i={marker:{enabled:!1,radius:2}},j={shadow:!1,borderWidth:0};e.xAxis=ta(ua(e.xAxis||{}),function(a){return z({minPadding:0,maxPadding:0,ordinal:!0,title:{text:null},labels:{overflow:"justify"},showLastLabel:!0},a,{type:"datetime",categories:null},h)});e.yAxis=ta(ua(e.yAxis||{}),function(a){g=q(a.opposite,!0);return z({labels:{y:-2},opposite:g,showLastLabel:!1,title:{text:null}},a)});e.series=
null;e=z({chart:{panning:!0,pinchType:"x"},navigator:{enabled:!0},scrollbar:{enabled:!0},rangeSelector:{enabled:!0},title:{text:null,style:{fontSize:"16px"}},tooltip:{shared:!0,crosshairs:!0},legend:{enabled:!1},plotOptions:{line:i,spline:i,area:i,areaspline:i,arearange:i,areasplinerange:i,column:j,columnrange:j,candlestick:j,ohlc:j}},e,{_stock:!0,chart:{inverted:!1}});e.series=f;return d?new Ba(a,e,c):new Ba(e,b)};U(Ya.prototype,"init",function(a,b,c){var d=c.chart.pinchType||"";a.call(this,b,c);
this.pinchX=this.pinchHor=d.indexOf("x")!==-1;this.pinchY=this.pinchVert=d.indexOf("y")!==-1;this.hasZoom=this.hasZoom||this.pinchHor||this.pinchVert});U(J.prototype,"autoLabelAlign",function(a){var b=this.chart,c=this.options,b=b._labelPanes=b._labelPanes||{},d=this.options.labels;if(this.chart.options._stock&&this.coll==="yAxis"&&(c=c.top+","+c.height,!b[c]&&d.enabled)){if(d.x===15)d.x=0;if(d.align===void 0)d.align="right";b[c]=1;return"right"}return a.call(this,[].slice.call(arguments,1))});U(J.prototype,
"getPlotLinePath",function(a,b,c,d,e,f){var g=this,h=this.isLinked&&!this.series?this.linkedParent.series:this.series,i=g.chart,j=i.renderer,k=g.left,l=g.top,m,n,p,r,s=[],t=[],u,x;if(g.coll==="colorAxis")return a.apply(this,[].slice.call(arguments,1));t=g.isXAxis?v(g.options.yAxis)?[i.yAxis[g.options.yAxis]]:ta(h,function(a){return a.yAxis}):v(g.options.xAxis)?[i.xAxis[g.options.xAxis]]:ta(h,function(a){return a.xAxis});o(g.isXAxis?i.yAxis:i.xAxis,function(a){if(v(a.options.id)?a.options.id.indexOf("navigator")===
-1:1){var b=a.isXAxis?"yAxis":"xAxis",b=v(a.options[b])?i[b][a.options[b]]:i[b][0];g===b&&t.push(a)}});u=t.length?[]:[g.isXAxis?i.yAxis[0]:i.xAxis[0]];o(t,function(a){sa(a,u)===-1&&u.push(a)});x=q(f,g.translate(b,null,null,d));C(x)&&(g.horiz?o(u,function(a){var b;n=a.pos;r=n+a.len;m=p=y(x+g.transB);if(m<k||m>k+g.width)e?m=p=G(w(k,m),k+g.width):b=!0;b||s.push("M",m,n,"L",p,r)}):o(u,function(a){var b;m=a.pos;p=m+a.len;n=r=y(l+g.height-x);if(n<l||n>l+g.height)e?n=r=G(w(l,n),g.top+g.height):b=!0;b||s.push("M",
m,n,"L",p,r)}));return s.length>0?j.crispPolyLine(s,c||1):null});J.prototype.getPlotBandPath=function(a,b){var c=this.getPlotLinePath(b,null,null,!0),d=this.getPlotLinePath(a,null,null,!0),e=[],f;if(d&&c&&d.toString()!==c.toString())for(f=0;f<d.length;f+=6)e.push("M",d[f+1],d[f+2],"L",d[f+4],d[f+5],c[f+4],c[f+5],c[f+1],c[f+2]);else e=null;return e};xa.prototype.crispPolyLine=function(a,b){var c;for(c=0;c<a.length;c+=6)a[c+1]===a[c+4]&&(a[c+1]=a[c+4]=y(a[c+1])-b%2/2),a[c+2]===a[c+5]&&(a[c+2]=a[c+5]=
y(a[c+2])+b%2/2);return a};if(Xa===B.VMLRenderer)lb.prototype.crispPolyLine=xa.prototype.crispPolyLine;U(J.prototype,"hideCrosshair",function(a,b){a.call(this,b);if(this.crossLabel)this.crossLabel=this.crossLabel.hide()});U(J.prototype,"drawCrosshair",function(a,b,c){var d,e;a.call(this,b,c);if(v(this.crosshair.label)&&this.crosshair.label.enabled){var a=this.chart,f=this.options.crosshair.label,g=this.horiz,h=this.opposite,i=this.left,j=this.top,k=this.crossLabel,l,m=f.format,n="",o=this.options.tickPosition===
"inside",r=this.crosshair.snap!==!1;l=g?"center":h?this.labelAlign==="right"?"right":"left":this.labelAlign==="left"?"left":"center";if(!k)k=this.crossLabel=a.renderer.label(null,null,null,f.shape||"callout").attr({align:f.align||l,zIndex:12,fill:f.backgroundColor||this.series[0]&&this.series[0].color||"gray",padding:q(f.padding,8),stroke:f.borderColor||"","stroke-width":f.borderWidth||0,r:q(f.borderRadius,3)}).css(A({color:"white",fontWeight:"normal",fontSize:"11px",textAlign:"center"},f.style)).add();
g?(l=r?c.plotX+i:b.chartX,j+=h?0:this.height):(l=h?this.width+i:0,j=r?c.plotY+j:b.chartY);!m&&!f.formatter&&(this.isDatetimeAxis&&(n="%b %d, %Y"),m="{value"+(n?":"+n:"")+"}");b=r?c[this.isXAxis?"x":"y"]:this.toValue(g?b.chartX:b.chartY);k.attr({text:m?La(m,{value:b}):f.formatter.call(this,b),anchorX:g?l:this.opposite?0:a.chartWidth,anchorY:g?this.opposite?a.chartHeight:0:j,x:l,y:j,visibility:"visible"});b=k.getBBox();if(g){if(o&&!h||!o&&h)j=k.y-b.height}else j=k.y-b.height/2;g?(d=i-b.x,e=i+this.width-
b.x):(d=this.labelAlign==="left"?i:0,e=this.labelAlign==="right"?i+this.width:a.chartWidth);k.translateX<d&&(l+=d-k.translateX);k.translateX+b.width>=e&&(l-=k.translateX+b.width-e);k.attr({x:l,y:j,visibility:"visible"})}});var gc=ia.init,hc=ia.processData,ic=Ha.prototype.tooltipFormatter;ia.init=function(){gc.apply(this,arguments);this.setCompare(this.options.compare)};ia.setCompare=function(a){this.modifyValue=a==="value"||a==="percent"?function(b,c){var d=this.compareValue;if(b!==t&&(b=a==="value"?
b-d:b=100*(b/d)-100,c))c.change=b;return b}:null;if(this.chart.hasRendered)this.isDirty=!0};ia.processData=function(){var a,b=-1,c,d,e,f;hc.apply(this,arguments);if(this.xAxis&&this.processedYData){c=this.processedXData;d=this.processedYData;e=d.length;this.pointArrayMap&&(b=sa(this.pointValKey||"y",this.pointArrayMap));for(a=0;a<e;a++)if(f=b>-1?d[a][b]:d[a],C(f)&&c[a]>=this.xAxis.min&&f!==0){this.compareValue=f;break}}};U(ia,"getExtremes",function(a){var b;a.apply(this,[].slice.call(arguments,1));
if(this.modifyValue)b=[this.modifyValue(this.dataMin),this.modifyValue(this.dataMax)],this.dataMin=Ma(b),this.dataMax=Da(b)});J.prototype.setCompare=function(a,b){this.isXAxis||(o(this.series,function(b){b.setCompare(a)}),q(b,!0)&&this.chart.redraw())};Ha.prototype.tooltipFormatter=function(a){a=a.replace("{point.change}",(this.change>0?"+":"")+B.numberFormat(this.change,q(this.series.tooltipOptions.changeDecimals,2)));return ic.apply(this,[a])};U(P.prototype,"render",function(a){if(this.chart.options._stock&&
this.xAxis)!this.clipBox&&this.animate?(this.clipBox=z(this.chart.clipBox),this.clipBox.width=this.xAxis.len,this.clipBox.height=this.yAxis.len):this.chart[this.sharedClipKey]&&(Sa(this.chart[this.sharedClipKey]),this.chart[this.sharedClipKey].attr({width:this.xAxis.len,height:this.yAxis.len}));a.call(this)});A(B,{Color:va,Point:Ha,Tick:bb,Renderer:Xa,SVGElement:Z,SVGRenderer:xa,arrayMin:Ma,arrayMax:Da,charts:$,correctFloat:ka,dateFormat:na,error:ga,format:La,pathAnim:void 0,getOptions:function(){return R},
hasBidiBug:Zb,isTouchDevice:jb,setOptions:function(a){R=z(!0,R,a);Ob();return R},addEvent:E,removeEvent:T,createElement:fa,discardElement:Ua,css:N,each:o,map:ta,merge:z,splat:ua,stableSort:nb,extendClass:ma,pInt:K,svg:ja,canvas:qa,vml:!ja&&!qa,product:"Highstock",version:"4.2.5"});return B});

},{}],3:[function(require,module,exports){
/**
*
* jquery.sparkline.js
*
* v2.3.2
* (c) Splunk, Inc
* Contact: Gareth Watts (gareth@splunk.com)
* http://omnipotent.net/jquery.sparkline/
*
* Generates inline sparkline charts from data supplied either to the method
* or inline in HTML
*
* Compatible with Internet Explorer 6.0+ and modern browsers equipped with the canvas tag
* (Firefox 2.0+, Safari, Opera, etc)
*
* License: New BSD License
*
* Copyright (c) 2012, Splunk Inc.
* All rights reserved.
*
* Redistribution and use in source and binary forms, with or without modification,
* are permitted provided that the following conditions are met:
*
*     * Redistributions of source code must retain the above copyright notice,
*       this list of conditions and the following disclaimer.
*     * Redistributions in binary form must reproduce the above copyright notice,
*       this list of conditions and the following disclaimer in the documentation
*       and/or other materials provided with the distribution.
*     * Neither the name of Splunk Inc nor the names of its contributors may
*       be used to endorse or promote products derived from this software without
*       specific prior written permission.
*
* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY
* EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
* OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT
* SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
* SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT
* OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
* HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
* OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
* SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*
*
* Usage:
*  $(selector).sparkline(values, options)
*
* If values is undefined or set to 'html' then the data values are read from the specified tag:
*   <p>Sparkline: <span class="sparkline">1,4,6,6,8,5,3,5</span></p>
*   $('.sparkline').sparkline();
* There must be no spaces in the enclosed data set
*
* Otherwise values must be an array of numbers or null values
*    <p>Sparkline: <span id="sparkline1">This text replaced if the browser is compatible</span></p>
*    $('#sparkline1').sparkline([1,4,6,6,8,5,3,5])
*    $('#sparkline2').sparkline([1,4,6,null,null,5,3,5])
*
* Values can also be specified in an HTML comment, or as a values attribute:
*    <p>Sparkline: <span class="sparkline"><!--1,4,6,6,8,5,3,5 --></span></p>
*    <p>Sparkline: <span class="sparkline" values="1,4,6,6,8,5,3,5"></span></p>
*    $('.sparkline').sparkline();
*
* For line charts, x values can also be specified:
*   <p>Sparkline: <span class="sparkline">1:1,2.7:4,3.4:6,5:6,6:8,8.7:5,9:3,10:5</span></p>
*    $('#sparkline1').sparkline([ [1,1], [2.7,4], [3.4,6], [5,6], [6,8], [8.7,5], [9,3], [10,5] ])
*
* By default, options should be passed in as the second argument to the sparkline function:
*   $('.sparkline').sparkline([1,2,3,4], {type: 'bar'})
*
* Options can also be set by passing them on the tag itself.  This feature is disabled by default though
* as there's a slight performance overhead:
*   $('.sparkline').sparkline([1,2,3,4], {enableTagOptions: true})
*   <p>Sparkline: <span class="sparkline" sparkType="bar" sparkBarColor="red">loading</span></p>
* Prefix all options supplied as tag attribute with "spark" (configurable by setting tagOptionsPrefix)
*
* Supported options:
*   lineColor - Color of the line used for the chart
*   fillColor - Color used to fill in the chart - Set to '' or false for a transparent chart
*   width - Width of the chart - Defaults to 3 times the number of values in pixels
*   height - Height of the chart - Defaults to the height of the containing element
*   chartRangeMin - Specify the minimum value to use for the Y range of the chart - Defaults to the minimum value supplied
*   chartRangeMax - Specify the maximum value to use for the Y range of the chart - Defaults to the maximum value supplied
*   chartRangeClip - Clip out of range values to the max/min specified by chartRangeMin and chartRangeMax
*   chartRangeMinX - Specify the minimum value to use for the X range of the chart - Defaults to the minimum value supplied
*   chartRangeMaxX - Specify the maximum value to use for the X range of the chart - Defaults to the maximum value supplied
*   composite - If true then don't erase any existing chart attached to the tag, but draw
*           another chart over the top - Note that width and height are ignored if an
*           existing chart is detected.
*   tagValuesAttribute - Name of tag attribute to check for data values - Defaults to 'values'
*   enableTagOptions - Whether to check tags for sparkline options
*   tagOptionsPrefix - Prefix used for options supplied as tag attributes - Defaults to 'spark'
*   disableHiddenCheck - If set to true, then the plugin will assume that charts will never be drawn into a
*           hidden dom element, avoding a browser reflow
*   disableInteraction - If set to true then all mouseover/click interaction behaviour will be disabled,
*       making the plugin perform much like it did in 1.x
*   disableTooltips - If set to true then tooltips will be disabled - Defaults to false (tooltips enabled)
*   disableHighlight - If set to true then highlighting of selected chart elements on mouseover will be disabled
*       defaults to false (highlights enabled)
*   highlightLighten - Factor to lighten/darken highlighted chart values by - Defaults to 1.4 for a 40% increase
*   tooltipContainer - Specify which DOM element the tooltip should be rendered into - defaults to document.body
*   tooltipClassname - Optional CSS classname to apply to tooltips - If not specified then a default style will be applied
*   tooltipOffsetX - How many pixels away from the mouse pointer to render the tooltip on the X axis
*   tooltipOffsetY - How many pixels away from the mouse pointer to render the tooltip on the r axis
*   tooltipFormatter  - Optional callback that allows you to override the HTML displayed in the tooltip
*       callback is given arguments of (sparkline, options, fields)
*   tooltipChartTitle - If specified then the tooltip uses the string specified by this setting as a title
*   tooltipFormat - A format string or SPFormat object  (or an array thereof for multiple entries)
*       to control the format of the tooltip
*   tooltipPrefix - A string to prepend to each field displayed in a tooltip
*   tooltipSuffix - A string to append to each field displayed in a tooltip
*   tooltipSkipNull - If true then null values will not have a tooltip displayed (defaults to true)
*   tooltipValueLookups - An object or range map to map field values to tooltip strings
*       (eg. to map -1 to "Lost", 0 to "Draw", and 1 to "Win")
*   numberFormatter - Optional callback for formatting numbers in tooltips
*   numberDigitGroupSep - Character to use for group separator in numbers "1,234" - Defaults to ","
*   numberDecimalMark - Character to use for the decimal point when formatting numbers - Defaults to "."
*   numberDigitGroupCount - Number of digits between group separator - Defaults to 3
*
* There are 7 types of sparkline, selected by supplying a "type" option of 'line' (default),
* 'bar', 'tristate', 'bullet', 'discrete', 'pie' or 'box'
*    line - Line chart.  Options:
*       spotColor - Set to '' to not end each line in a circular spot
*       minSpotColor - If set, color of spot at minimum value
*       maxSpotColor - If set, color of spot at maximum value
*       spotRadius - Radius in pixels
*       lineWidth - Width of line in pixels
*       normalRangeMin
*       normalRangeMax - If set draws a filled horizontal bar between these two values marking the "normal"
*                      or expected range of values
*       normalRangeColor - Color to use for the above bar
*       drawNormalOnTop - Draw the normal range above the chart fill color if true
*       defaultPixelsPerValue - Defaults to 3 pixels of width for each value in the chart
*       highlightSpotColor - The color to use for drawing a highlight spot on mouseover - Set to null to disable
*       highlightLineColor - The color to use for drawing a highlight line on mouseover - Set to null to disable
*       valueSpots - Specify which points to draw spots on, and in which color.  Accepts a range map
*
*   bar - Bar chart.  Options:
*       barColor - Color of bars for postive values
*       negBarColor - Color of bars for negative values
*       zeroColor - Color of bars with zero values
*       nullColor - Color of bars with null values - Defaults to omitting the bar entirely
*       barWidth - Width of bars in pixels
*       colorMap - Optional mappnig of values to colors to override the *BarColor values above
*                  can be an Array of values to control the color of individual bars or a range map
*                  to specify colors for individual ranges of values
*       barSpacing - Gap between bars in pixels
*       zeroAxis - Centers the y-axis around zero if true
*
*   tristate - Charts values of win (>0), lose (<0) or draw (=0)
*       posBarColor - Color of win values
*       negBarColor - Color of lose values
*       zeroBarColor - Color of draw values
*       barWidth - Width of bars in pixels
*       barSpacing - Gap between bars in pixels
*       colorMap - Optional mappnig of values to colors to override the *BarColor values above
*                  can be an Array of values to control the color of individual bars or a range map
*                  to specify colors for individual ranges of values
*
*   discrete - Options:
*       lineHeight - Height of each line in pixels - Defaults to 30% of the graph height
*       thesholdValue - Values less than this value will be drawn using thresholdColor instead of lineColor
*       thresholdColor
*
*   bullet - Values for bullet graphs msut be in the order: target, performance, range1, range2, range3, ...
*       options:
*       targetColor - The color of the vertical target marker
*       targetWidth - The width of the target marker in pixels
*       performanceColor - The color of the performance measure horizontal bar
*       rangeColors - Colors to use for each qualitative range background color
*
*   pie - Pie chart. Options:
*       sliceColors - An array of colors to use for pie slices
*       offset - Angle in degrees to offset the first slice - Try -90 or +90
*       borderWidth - Width of border to draw around the pie chart, in pixels - Defaults to 0 (no border)
*       borderColor - Color to use for the pie chart border - Defaults to #000
*
*   box - Box plot. Options:
*       raw - Set to true to supply pre-computed plot points as values
*             values should be: low_outlier, low_whisker, q1, median, q3, high_whisker, high_outlier
*             When set to false you can supply any number of values and the box plot will
*             be computed for you.  Default is false.
*       showOutliers - Set to true (default) to display outliers as circles
*       outlierIQR - Interquartile range used to determine outliers.  Default 1.5
*       boxLineColor - Outline color of the box
*       boxFillColor - Fill color for the box
*       whiskerColor - Line color used for whiskers
*       outlierLineColor - Outline color of outlier circles
*       outlierFillColor - Fill color of the outlier circles
*       spotRadius - Radius of outlier circles
*       medianColor - Line color of the median line
*       target - Draw a target cross hair at the supplied value (default undefined)
*
*
*
*   Examples:
*   $('#sparkline1').sparkline(myvalues, { lineColor: '#f00', fillColor: false });
*   $('.barsparks').sparkline('html', { type:'bar', height:'40px', barWidth:5 });
*   $('#tristate').sparkline([1,1,-1,1,0,0,-1], { type:'tristate' }):
*   $('#discrete').sparkline([1,3,4,5,5,3,4,5], { type:'discrete' });
*   $('#bullet').sparkline([10,12,12,9,7], { type:'bullet' });
*   $('#pie').sparkline([1,1,2], { type:'pie' });
*/

/*jslint regexp: true, browser: true, jquery: true, white: true, nomen: false, plusplus: false, maxerr: 500, indent: 4 */

(function(document, Math, undefined) { // performance/minified-size optimization
(function(factory) {
    if(typeof define === 'function' && define.amd) {
        define(['jquery'], factory);
    } else if (jQuery && !jQuery.fn.sparkline) {
        factory(jQuery);
    }
}
(function($) {
    'use strict';

    var UNSET_OPTION = {},
        getDefaults, createClass, SPFormat, clipval, quartile, normalizeValue, normalizeValues,
        remove, isNumber, all, sum, addCSS, ensureArray, formatNumber, RangeMap,
        MouseHandler, Tooltip, barHighlightMixin,
        line, bar, tristate, discrete, bullet, pie, box, defaultStyles, initStyles,
        VShape, VCanvas_base, VCanvas_canvas, VCanvas_vml, pending, shapeCount = 0;

    /**
     * Default configuration settings
     */
    getDefaults = function () {
        return {
            // Settings common to most/all chart types
            common: {
                type: 'line',
                lineColor: '#00f',
                fillColor: '#cdf',
                defaultPixelsPerValue: 3,
                width: 'auto',
                height: 'auto',
                composite: false,
                tagValuesAttribute: 'values',
                tagOptionsPrefix: 'spark',
                enableTagOptions: false,
                enableHighlight: true,
                highlightLighten: 1.4,
                tooltipSkipNull: true,
                tooltipPrefix: '',
                tooltipSuffix: '',
                disableHiddenCheck: false,
                numberFormatter: false,
                numberDigitGroupCount: 3,
                numberDigitGroupSep: ',',
                numberDecimalMark: '.',
                disableTooltips: false,
                disableInteraction: false
            },
            // Defaults for line charts
            line: {
                spotColor: '#f80',
                highlightSpotColor: '#5f5',
                highlightLineColor: '#f22',
                spotRadius: 1.5,
                minSpotColor: '#f80',
                maxSpotColor: '#f80',
                lineWidth: 1,
                normalRangeMin: undefined,
                normalRangeMax: undefined,
                normalRangeColor: '#ccc',
                drawNormalOnTop: false,
                chartRangeMin: undefined,
                chartRangeMax: undefined,
                chartRangeMinX: undefined,
                chartRangeMaxX: undefined,
                tooltipFormat: new SPFormat('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{y}}{{suffix}}')
            },
            // Defaults for bar charts
            bar: {
                barColor: '#3366cc',
                negBarColor: '#f44',
                stackedBarColor: ['#3366cc', '#dc3912', '#ff9900', '#109618', '#66aa00',
                    '#dd4477', '#0099c6', '#990099'],
                zeroColor: undefined,
                nullColor: undefined,
                zeroAxis: true,
                barWidth: 4,
                barSpacing: 1,
                chartRangeMax: undefined,
                chartRangeMin: undefined,
                chartRangeClip: false,
                colorMap: undefined,
                tooltipFormat: new SPFormat('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{value}}{{suffix}}')
            },
            // Defaults for tristate charts
            tristate: {
                barWidth: 4,
                barSpacing: 1,
                posBarColor: '#6f6',
                negBarColor: '#f44',
                zeroBarColor: '#999',
                colorMap: {},
                tooltipFormat: new SPFormat('<span style="color: {{color}}">&#9679;</span> {{value:map}}'),
                tooltipValueLookups: { map: { '-1': 'Loss', '0': 'Draw', '1': 'Win' } }
            },
            // Defaults for discrete charts
            discrete: {
                lineHeight: 'auto',
                thresholdColor: undefined,
                thresholdValue: 0,
                chartRangeMax: undefined,
                chartRangeMin: undefined,
                chartRangeClip: false,
                tooltipFormat: new SPFormat('{{prefix}}{{value}}{{suffix}}')
            },
            // Defaults for bullet charts
            bullet: {
                targetColor: '#f33',
                targetWidth: 3, // width of the target bar in pixels
                performanceColor: '#33f',
                rangeColors: ['#d3dafe', '#a8b6ff', '#7f94ff'],
                base: undefined, // set this to a number to change the base start number
                tooltipFormat: new SPFormat('{{fieldkey:fields}} - {{value}}'),
                tooltipValueLookups: { fields: {r: 'Range', p: 'Performance', t: 'Target'} }
            },
            // Defaults for pie charts
            pie: {
                offset: 0,
                sliceColors: ['#3366cc', '#dc3912', '#ff9900', '#109618', '#66aa00',
                    '#dd4477', '#0099c6', '#990099'],
                borderWidth: 0,
                borderColor: '#000',
                tooltipFormat: new SPFormat('<span style="color: {{color}}">&#9679;</span> {{value}} ({{percent.1}}%)')
            },
            // Defaults for box plots
            box: {
                raw: false,
                boxLineColor: '#000',
                boxFillColor: '#cdf',
                whiskerColor: '#000',
                outlierLineColor: '#333',
                outlierFillColor: '#fff',
                medianColor: '#f00',
                showOutliers: true,
                outlierIQR: 1.5,
                spotRadius: 1.5,
                target: undefined,
                targetColor: '#4a2',
                chartRangeMax: undefined,
                chartRangeMin: undefined,
                tooltipFormat: new SPFormat('{{field:fields}}: {{value}}'),
                tooltipFormatFieldlistKey: 'field',
                tooltipValueLookups: { fields: { lq: 'Lower Quartile', med: 'Median',
                    uq: 'Upper Quartile', lo: 'Left Outlier', ro: 'Right Outlier',
                    lw: 'Left Whisker', rw: 'Right Whisker'} }
            }
        };
    };

    // You can have tooltips use a css class other than jqstooltip by specifying tooltipClassname
    defaultStyles = '.jqstooltip { ' +
            'position: absolute;' +
            'left: 0px;' +
            'top: 0px;' +
            'visibility: hidden;' +
            'background: rgb(0, 0, 0) transparent;' +
            'background-color: rgba(0,0,0,0.6);' +
            'filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000);' +
            '-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000)";' +
            'color: white;' +
            'font: 10px arial, san serif;' +
            'text-align: left;' +
            'white-space: nowrap;' +
            'padding: 5px;' +
            'border: 1px solid white;' +
            'box-sizing: content-box;' +
            'z-index: 10000;' +
            '}' +
            '.jqsfield { ' +
            'color: white;' +
            'font: 10px arial, san serif;' +
            'text-align: left;' +
            '}';

    /**
     * Utilities
     */

    createClass = function (/* [baseclass, [mixin, ...]], definition */) {
        var Class, args;
        Class = function () {
            this.init.apply(this, arguments);
        };
        if (arguments.length > 1) {
            if (arguments[0]) {
                Class.prototype = $.extend(new arguments[0](), arguments[arguments.length - 1]);
                Class._super = arguments[0].prototype;
            } else {
                Class.prototype = arguments[arguments.length - 1];
            }
            if (arguments.length > 2) {
                args = Array.prototype.slice.call(arguments, 1, -1);
                args.unshift(Class.prototype);
                $.extend.apply($, args);
            }
        } else {
            Class.prototype = arguments[0];
        }
        Class.prototype.cls = Class;
        return Class;
    };

    /**
     * Wraps a format string for tooltips
     * {{x}}
     * {{x.2}
     * {{x:months}}
     */
    $.SPFormatClass = SPFormat = createClass({
        fre: /\{\{([\w.]+?)(:(.+?))?\}\}/g,
        precre: /(\w+)\.(\d+)/,

        init: function (format, fclass) {
            this.format = format;
            this.fclass = fclass;
        },

        render: function (fieldset, lookups, options) {
            var self = this,
                fields = fieldset,
                match, token, lookupkey, fieldvalue, prec;
            return this.format.replace(this.fre, function () {
                var lookup;
                token = arguments[1];
                lookupkey = arguments[3];
                match = self.precre.exec(token);
                if (match) {
                    prec = match[2];
                    token = match[1];
                } else {
                    prec = false;
                }
                fieldvalue = fields[token];
                if (fieldvalue === undefined) {
                    return '';
                }
                if (lookupkey && lookups && lookups[lookupkey]) {
                    lookup = lookups[lookupkey];
                    if (lookup.get) { // RangeMap
                        return lookups[lookupkey].get(fieldvalue) || fieldvalue;
                    } else {
                        return lookups[lookupkey][fieldvalue] || fieldvalue;
                    }
                }
                if (isNumber(fieldvalue)) {
                    if (options.get('numberFormatter')) {
                        fieldvalue = options.get('numberFormatter')(fieldvalue);
                    } else {
                        fieldvalue = formatNumber(fieldvalue, prec,
                            options.get('numberDigitGroupCount'),
                            options.get('numberDigitGroupSep'),
                            options.get('numberDecimalMark'));
                    }
                }
                return fieldvalue;
            });
        }
    });

    // convience method to avoid needing the new operator
    $.spformat = function(format, fclass) {
        return new SPFormat(format, fclass);
    };

    clipval = function (val, min, max) {
        if (val < min) {
            return min;
        }
        if (val > max) {
            return max;
        }
        return val;
    };

    quartile = function (values, q) {
        var vl;
        if (q === 2) {
            vl = Math.floor(values.length / 2);
            return values.length % 2 ? values[vl] : (values[vl-1] + values[vl]) / 2;
        } else {
            if (values.length % 2 ) { // odd
                vl = (values.length * q + q) / 4;
                return vl % 1 ? (values[Math.floor(vl)] + values[Math.floor(vl) - 1]) / 2 : values[vl-1];
            } else { //even
                vl = (values.length * q + 2) / 4;
                return vl % 1 ? (values[Math.floor(vl)] + values[Math.floor(vl) - 1]) / 2 :  values[vl-1];

            }
        }
    };

    normalizeValue = function (val) {
        var nf;
        switch (val) {
            case 'undefined':
                val = undefined;
                break;
            case 'null':
                val = null;
                break;
            case 'true':
                val = true;
                break;
            case 'false':
                val = false;
                break;
            default:
                nf = parseFloat(val);
                if (val == nf) {
                    val = nf;
                }
        }
        return val;
    };

    normalizeValues = function (vals) {
        var i, result = [];
        for (i = vals.length; i--;) {
            result[i] = normalizeValue(vals[i]);
        }
        return result;
    };

    remove = function (vals, filter) {
        var i, vl, result = [];
        for (i = 0, vl = vals.length; i < vl; i++) {
            if (vals[i] !== filter) {
                result.push(vals[i]);
            }
        }
        return result;
    };

    isNumber = function (num) {
        return !isNaN(parseFloat(num)) && isFinite(num);
    };

    formatNumber = function (num, prec, groupsize, groupsep, decsep) {
        var p, i;
        num = (prec === false ? parseFloat(num).toString() : num.toFixed(prec)).split('');
        p = (p = $.inArray('.', num)) < 0 ? num.length : p;
        if (p < num.length) {
            num[p] = decsep;
        }
        for (i = p - groupsize; i > 0; i -= groupsize) {
            num.splice(i, 0, groupsep);
        }
        return num.join('');
    };

    // determine if all values of an array match a value
    // returns true if the array is empty
    all = function (val, arr, ignoreNull) {
        var i;
        for (i = arr.length; i--; ) {
            if (ignoreNull && arr[i] === null) continue;
            if (arr[i] !== val) {
                return false;
            }
        }
        return true;
    };

    // sums the numeric values in an array, ignoring other values
    sum = function (vals) {
        var total = 0, i;
        for (i = vals.length; i--;) {
            total += typeof vals[i] === 'number' ? vals[i] : 0;
        }
        return total;
    };

    ensureArray = function (val) {
        return $.isArray(val) ? val : [val];
    };

    // http://paulirish.com/2008/bookmarklet-inject-new-css-rules/
    addCSS = function(css) {
        var tag, iefail;
        if (document.createStyleSheet) {
            try {
                document.createStyleSheet().cssText = css;
                return;
            } catch (e) {
                // IE <= 9 maxes out at 31 stylesheets; inject into page instead.
                iefail = true;
            }
        }
        tag = document.createElement('style');
        tag.type = 'text/css';
        document.getElementsByTagName('head')[0].appendChild(tag);
        if (iefail) {
            document.styleSheets[document.styleSheets.length - 1].cssText = css;
        } else {
            tag[(typeof document.body.style.WebkitAppearance == 'string') /* webkit only */ ? 'innerText' : 'innerHTML'] = css;
        }
    };

    // Provide a cross-browser interface to a few simple drawing primitives
    $.fn.simpledraw = function (width, height, useExisting, interact) {
        var target, mhandler;
        if (useExisting && (target = this.data('_jqs_vcanvas'))) {
            return target;
        }

        if ($.fn.sparkline.canvas === false) {
            // We've already determined that neither Canvas nor VML are available
            return false;

        } else if ($.fn.sparkline.canvas === undefined) {
            // No function defined yet -- need to see if we support Canvas or VML
            var el = document.createElement('canvas');
            if (!!(el.getContext && el.getContext('2d'))) {
                // Canvas is available
                $.fn.sparkline.canvas = function(width, height, target, interact) {
                    return new VCanvas_canvas(width, height, target, interact);
                };
            } else if (document.namespaces && !document.namespaces.v) {
                // VML is available
                document.namespaces.add('v', 'urn:schemas-microsoft-com:vml', '#default#VML');
                $.fn.sparkline.canvas = function(width, height, target, interact) {
                    return new VCanvas_vml(width, height, target);
                };
            } else {
                // Neither Canvas nor VML are available
                $.fn.sparkline.canvas = false;
                return false;
            }
        }

        if (width === undefined) {
            width = $(this).innerWidth();
        }
        if (height === undefined) {
            height = $(this).innerHeight();
        }

        target = $.fn.sparkline.canvas(width, height, this, interact);

        mhandler = $(this).data('_jqs_mhandler');
        if (mhandler) {
            mhandler.registerCanvas(target);
        }
        return target;
    };

    $.fn.cleardraw = function () {
        var target = this.data('_jqs_vcanvas');
        if (target) {
            target.reset();
        }
    };

    $.RangeMapClass = RangeMap = createClass({
        init: function (map) {
            var key, range, rangelist = [];
            for (key in map) {
                if (map.hasOwnProperty(key) && typeof key === 'string' && key.indexOf(':') > -1) {
                    range = key.split(':');
                    range[0] = range[0].length === 0 ? -Infinity : parseFloat(range[0]);
                    range[1] = range[1].length === 0 ? Infinity : parseFloat(range[1]);
                    range[2] = map[key];
                    rangelist.push(range);
                }
            }
            this.map = map;
            this.rangelist = rangelist || false;
        },

        get: function (value) {
            var rangelist = this.rangelist,
                i, range, result;
            if ((result = this.map[value]) !== undefined) {
                return result;
            }
            if (rangelist) {
                for (i = rangelist.length; i--;) {
                    range = rangelist[i];
                    if (range[0] <= value && range[1] >= value) {
                        return range[2];
                    }
                }
            }
            return undefined;
        }
    });

    // Convenience function
    $.range_map = function(map) {
        return new RangeMap(map);
    };

    MouseHandler = createClass({
        init: function (el, options) {
            var $el = $(el);
            this.$el = $el;
            this.options = options;
            this.currentPageX = 0;
            this.currentPageY = 0;
            this.el = el;
            this.splist = [];
            this.tooltip = null;
            this.over = false;
            this.displayTooltips = !options.get('disableTooltips');
            this.highlightEnabled = !options.get('disableHighlight');
        },

        registerSparkline: function (sp) {
            this.splist.push(sp);
            if (this.over) {
                this.updateDisplay();
            }
        },

        registerCanvas: function (canvas) {
            var $canvas = $(canvas.canvas);
            this.canvas = canvas;
            this.$canvas = $canvas;
            $canvas.mouseenter($.proxy(this.mouseenter, this));
            $canvas.mouseleave($.proxy(this.mouseleave, this));
            $canvas.click($.proxy(this.mouseclick, this));
        },

        reset: function (removeTooltip) {
            this.splist = [];
            if (this.tooltip && removeTooltip) {
                this.tooltip.remove();
                this.tooltip = undefined;
            }
        },

        mouseclick: function (e) {
            var clickEvent = $.Event('sparklineClick');
            clickEvent.originalEvent = e;
            clickEvent.sparklines = this.splist;
            this.$el.trigger(clickEvent);
        },

        mouseenter: function (e) {
            $(document.body).unbind('mousemove.jqs');
            $(document.body).bind('mousemove.jqs', $.proxy(this.mousemove, this));
            this.over = true;
            this.currentPageX = e.pageX;
            this.currentPageY = e.pageY;
            this.currentEl = e.target;
            if (!this.tooltip && this.displayTooltips) {
                this.tooltip = new Tooltip(this.options);
                this.tooltip.updatePosition(e.pageX, e.pageY);
            }
            this.updateDisplay();
        },

        mouseleave: function () {
            $(document.body).unbind('mousemove.jqs');
            var splist = this.splist,
                 spcount = splist.length,
                 needsRefresh = false,
                 sp, i;
            this.over = false;
            this.currentEl = null;

            if (this.tooltip) {
                this.tooltip.remove();
                this.tooltip = null;
            }

            for (i = 0; i < spcount; i++) {
                sp = splist[i];
                if (sp.clearRegionHighlight()) {
                    needsRefresh = true;
                }
            }

            if (needsRefresh) {
                this.canvas.render();
            }
        },

        mousemove: function (e) {
            this.currentPageX = e.pageX;
            this.currentPageY = e.pageY;
            this.currentEl = e.target;
            if (this.tooltip) {
                this.tooltip.updatePosition(e.pageX, e.pageY);
            }
            this.updateDisplay();
        },

        updateDisplay: function () {
            var splist = this.splist,
                 spcount = splist.length,
                 needsRefresh = false,
                 offset = this.$canvas.offset(),
                 localX = this.currentPageX - offset.left,
                 localY = this.currentPageY - offset.top,
                 tooltiphtml, sp, i, result, changeEvent;
            if (!this.over) {
                return;
            }
            for (i = 0; i < spcount; i++) {
                sp = splist[i];
                result = sp.setRegionHighlight(this.currentEl, localX, localY);
                if (result) {
                    needsRefresh = true;
                }
            }
            if (needsRefresh) {
                changeEvent = $.Event('sparklineRegionChange');
                changeEvent.sparklines = this.splist;
                this.$el.trigger(changeEvent);
                if (this.tooltip) {
                    tooltiphtml = '';
                    for (i = 0; i < spcount; i++) {
                        sp = splist[i];
                        tooltiphtml += sp.getCurrentRegionTooltip();
                    }
                    this.tooltip.setContent(tooltiphtml);
                }
                if (!this.disableHighlight) {
                    this.canvas.render();
                }
            }
            if (result === null) {
                this.mouseleave();
            }
        }
    });


    Tooltip = createClass({
        sizeStyle: 'position: static !important;' +
            'display: block !important;' +
            'visibility: hidden !important;' +
            'float: left !important;',

        init: function (options) {
            var tooltipClassname = options.get('tooltipClassname', 'jqstooltip'),
                sizetipStyle = this.sizeStyle,
                offset;
            this.container = options.get('tooltipContainer') || document.body;
            this.tooltipOffsetX = options.get('tooltipOffsetX', 10);
            this.tooltipOffsetY = options.get('tooltipOffsetY', 12);
            // remove any previous lingering tooltip
            $('#jqssizetip').remove();
            $('#jqstooltip').remove();
            this.sizetip = $('<div/>', {
                id: 'jqssizetip',
                style: sizetipStyle,
                'class': tooltipClassname
            });
            this.tooltip = $('<div/>', {
                id: 'jqstooltip',
                'class': tooltipClassname
            }).appendTo(this.container);
            // account for the container's location
            offset = this.tooltip.offset();
            this.offsetLeft = offset.left;
            this.offsetTop = offset.top;
            this.hidden = true;
            $(window).unbind('resize.jqs scroll.jqs');
            $(window).bind('resize.jqs scroll.jqs', $.proxy(this.updateWindowDims, this));
            this.updateWindowDims();
        },

        updateWindowDims: function () {
            this.scrollTop = $(window).scrollTop();
            this.scrollLeft = $(window).scrollLeft();
            this.scrollRight = this.scrollLeft + $(window).width();
            this.updatePosition();
        },

        getSize: function (content) {
            this.sizetip.html(content).appendTo(this.container);
            this.width = this.sizetip.width() + 1;
            this.height = this.sizetip.height();
            this.sizetip.remove();
        },

        setContent: function (content) {
            if (!content) {
                this.tooltip.css('visibility', 'hidden');
                this.hidden = true;
                return;
            }
            this.getSize(content);
            this.tooltip.html(content)
                .css({
                    'width': this.width,
                    'height': this.height,
                    'visibility': 'visible'
                });
            if (this.hidden) {
                this.hidden = false;
                this.updatePosition();
            }
        },

        updatePosition: function (x, y) {
            if (x === undefined) {
                if (this.mousex === undefined) {
                    return;
                }
                x = this.mousex - this.offsetLeft;
                y = this.mousey - this.offsetTop;

            } else {
                this.mousex = x = x - this.offsetLeft;
                this.mousey = y = y - this.offsetTop;
            }
            if (!this.height || !this.width || this.hidden) {
                return;
            }

            y -= this.height + this.tooltipOffsetY;
            x += this.tooltipOffsetX;

            if (y < this.scrollTop) {
                y = this.scrollTop;
            }
            if (x < this.scrollLeft) {
                x = this.scrollLeft;
            } else if (x + this.width > this.scrollRight) {
                x = this.scrollRight - this.width;
            }

            this.tooltip.css({
                'left': x,
                'top': y
            });
        },

        remove: function () {
            this.tooltip.remove();
            this.sizetip.remove();
            this.sizetip = this.tooltip = undefined;
            $(window).unbind('resize.jqs scroll.jqs');
        }
    });

    initStyles = function() {
        addCSS(defaultStyles);
    };

    $(initStyles);

    pending = [];
    $.fn.sparkline = function (userValues, userOptions) {
        return this.each(function () {
            var options = new $.fn.sparkline.options(this, userOptions),
                 $this = $(this),
                 render, i;
            render = function () {
                var values, width, height, tmp, mhandler, sp, vals;
                if (userValues === 'html' || userValues === undefined) {
                    vals = this.getAttribute(options.get('tagValuesAttribute'));
                    if (vals === undefined || vals === null) {
                        vals = $this.html();
                    }
                    values = vals.replace(/(^\s*<!--)|(-->\s*$)|\s+/g, '').split(',');
                } else {
                    values = userValues;
                }

                width = options.get('width') === 'auto' ? values.length * options.get('defaultPixelsPerValue') : options.get('width');
                if (options.get('height') === 'auto') {
                    if (!options.get('composite') || !$.data(this, '_jqs_vcanvas')) {
                        // must be a better way to get the line height
                        tmp = document.createElement('span');
                        tmp.innerHTML = 'a';
                        $this.html(tmp);
                        height = $(tmp).innerHeight() || $(tmp).height();
                        $(tmp).remove();
                        tmp = null;
                    }
                } else {
                    height = options.get('height');
                }

                if (!options.get('disableInteraction')) {
                    mhandler = $.data(this, '_jqs_mhandler');
                    if (!mhandler) {
                        mhandler = new MouseHandler(this, options);
                        $.data(this, '_jqs_mhandler', mhandler);
                    } else if (!options.get('composite')) {
                        mhandler.reset();
                    }
                } else {
                    mhandler = false;
                }

                if (options.get('composite') && !$.data(this, '_jqs_vcanvas')) {
                    if (!$.data(this, '_jqs_errnotify')) {
                        alert('Attempted to attach a composite sparkline to an element with no existing sparkline');
                        $.data(this, '_jqs_errnotify', true);
                    }
                    return;
                }

                sp = new $.fn.sparkline[options.get('type')](this, values, options, width, height);

                sp.render();

                if (mhandler) {
                    mhandler.registerSparkline(sp);
                }
            };
            if (($(this).html() && !options.get('disableHiddenCheck') && $(this).is(':hidden')) || !$(this).parents('body').length) {
                if (!options.get('composite') && $.data(this, '_jqs_pending')) {
                    // remove any existing references to the element
                    for (i = pending.length; i; i--) {
                        if (pending[i - 1][0] == this) {
                            pending.splice(i - 1, 1);
                        }
                    }
                }
                pending.push([this, render]);
                $.data(this, '_jqs_pending', true);
            } else {
                render.call(this);
            }
        });
    };

    $.fn.sparkline.defaults = getDefaults();


    $.sparkline_display_visible = function () {
        var el, i, pl;
        var done = [];
        for (i = 0, pl = pending.length; i < pl; i++) {
            el = pending[i][0];
            if ($(el).is(':visible') && !$(el).parents().is(':hidden')) {
                pending[i][1].call(el);
                $.data(pending[i][0], '_jqs_pending', false);
                done.push(i);
            } else if (!$(el).closest('html').length && !$.data(el, '_jqs_pending')) {
                // element has been inserted and removed from the DOM
                // If it was not yet inserted into the dom then the .data request
                // will return true.
                // removing from the dom causes the data to be removed.
                $.data(pending[i][0], '_jqs_pending', false);
                done.push(i);
            }
        }
        for (i = done.length; i; i--) {
            pending.splice(done[i - 1], 1);
        }
    };


    /**
     * User option handler
     */
    $.fn.sparkline.options = createClass({
        init: function (tag, userOptions) {
            var extendedOptions, defaults, base, tagOptionType;
            this.userOptions = userOptions = userOptions || {};
            this.tag = tag;
            this.tagValCache = {};
            defaults = $.fn.sparkline.defaults;
            base = defaults.common;
            this.tagOptionsPrefix = userOptions.enableTagOptions && (userOptions.tagOptionsPrefix || base.tagOptionsPrefix);

            tagOptionType = this.getTagSetting('type');
            if (tagOptionType === UNSET_OPTION) {
                extendedOptions = defaults[userOptions.type || base.type];
            } else {
                extendedOptions = defaults[tagOptionType];
            }
            this.mergedOptions = $.extend({}, base, extendedOptions, userOptions);
        },


        getTagSetting: function (key) {
            var prefix = this.tagOptionsPrefix,
                val, i, pairs, keyval;
            if (prefix === false || prefix === undefined) {
                return UNSET_OPTION;
            }
            if (this.tagValCache.hasOwnProperty(key)) {
                val = this.tagValCache.key;
            } else {
                val = this.tag.getAttribute(prefix + key);
                if (val === undefined || val === null) {
                    val = UNSET_OPTION;
                } else if (val.substr(0, 1) === '[') {
                    val = val.substr(1, val.length - 2).split(',');
                    for (i = val.length; i--;) {
                        val[i] = normalizeValue(val[i].replace(/(^\s*)|(\s*$)/g, ''));
                    }
                } else if (val.substr(0, 1) === '{') {
                    pairs = val.substr(1, val.length - 2).split(',');
                    val = {};
                    for (i = pairs.length; i--;) {
                        keyval = pairs[i].split(':', 2);
                        val[keyval[0].replace(/(^\s*)|(\s*$)/g, '')] = normalizeValue(keyval[1].replace(/(^\s*)|(\s*$)/g, ''));
                    }
                } else {
                    val = normalizeValue(val);
                }
                this.tagValCache.key = val;
            }
            return val;
        },

        get: function (key, defaultval) {
            var tagOption = this.getTagSetting(key),
                result;
            if (tagOption !== UNSET_OPTION) {
                return tagOption;
            }
            return (result = this.mergedOptions[key]) === undefined ? defaultval : result;
        }
    });


    $.fn.sparkline._base = createClass({
        disabled: false,

        init: function (el, values, options, width, height) {
            this.el = el;
            this.$el = $(el);
            this.values = values;
            this.options = options;
            this.width = width;
            this.height = height;
            this.currentRegion = undefined;
        },

        /**
         * Setup the canvas
         */
        initTarget: function () {
            var interactive = !this.options.get('disableInteraction');
            if (!(this.target = this.$el.simpledraw(this.width, this.height, this.options.get('composite'), interactive))) {
                this.disabled = true;
            } else {
                this.canvasWidth = this.target.pixelWidth;
                this.canvasHeight = this.target.pixelHeight;
            }
        },

        /**
         * Actually render the chart to the canvas
         */
        render: function () {
            if (this.disabled) {
                this.el.innerHTML = '';
                return false;
            }
            return true;
        },

        /**
         * Return a region id for a given x/y co-ordinate
         */
        getRegion: function (x, y) {
        },

        /**
         * Highlight an item based on the moused-over x,y co-ordinate
         */
        setRegionHighlight: function (el, x, y) {
            var currentRegion = this.currentRegion,
                highlightEnabled = !this.options.get('disableHighlight'),
                newRegion;
            if (x > this.canvasWidth || y > this.canvasHeight || x < 0 || y < 0) {
                return null;
            }
            newRegion = this.getRegion(el, x, y);
            if (currentRegion !== newRegion) {
                if (currentRegion !== undefined && highlightEnabled) {
                    this.removeHighlight();
                }
                this.currentRegion = newRegion;
                if (newRegion !== undefined && highlightEnabled) {
                    this.renderHighlight();
                }
                return true;
            }
            return false;
        },

        /**
         * Reset any currently highlighted item
         */
        clearRegionHighlight: function () {
            if (this.currentRegion !== undefined) {
                this.removeHighlight();
                this.currentRegion = undefined;
                return true;
            }
            return false;
        },

        renderHighlight: function () {
            this.changeHighlight(true);
        },

        removeHighlight: function () {
            this.changeHighlight(false);
        },

        changeHighlight: function (highlight)  {},

        /**
         * Fetch the HTML to display as a tooltip
         */
        getCurrentRegionTooltip: function () {
            var options = this.options,
                header = '',
                entries = [],
                fields, formats, formatlen, fclass, text, i,
                showFields, showFieldsKey, newFields, fv,
                formatter, format, fieldlen, j;
            if (this.currentRegion === undefined) {
                return '';
            }
            fields = this.getCurrentRegionFields();
            formatter = options.get('tooltipFormatter');
            if (formatter) {
                return formatter(this, options, fields);
            }
            if (options.get('tooltipChartTitle')) {
                header += '<div class="jqs jqstitle">' + options.get('tooltipChartTitle') + '</div>\n';
            }
            formats = this.options.get('tooltipFormat');
            if (!formats) {
                return '';
            }
            if (!$.isArray(formats)) {
                formats = [formats];
            }
            if (!$.isArray(fields)) {
                fields = [fields];
            }
            showFields = this.options.get('tooltipFormatFieldlist');
            showFieldsKey = this.options.get('tooltipFormatFieldlistKey');
            if (showFields && showFieldsKey) {
                // user-selected ordering of fields
                newFields = [];
                for (i = fields.length; i--;) {
                    fv = fields[i][showFieldsKey];
                    if ((j = $.inArray(fv, showFields)) != -1) {
                        newFields[j] = fields[i];
                    }
                }
                fields = newFields;
            }
            formatlen = formats.length;
            fieldlen = fields.length;
            for (i = 0; i < formatlen; i++) {
                format = formats[i];
                if (typeof format === 'string') {
                    format = new SPFormat(format);
                }
                fclass = format.fclass || 'jqsfield';
                for (j = 0; j < fieldlen; j++) {
                    if (!fields[j].isNull || !options.get('tooltipSkipNull')) {
                        $.extend(fields[j], {
                            prefix: options.get('tooltipPrefix'),
                            suffix: options.get('tooltipSuffix')
                        });
                        text = format.render(fields[j], options.get('tooltipValueLookups'), options);
                        entries.push('<div class="' + fclass + '">' + text + '</div>');
                    }
                }
            }
            if (entries.length) {
                return header + entries.join('\n');
            }
            return '';
        },

        getCurrentRegionFields: function () {},

        calcHighlightColor: function (color, options) {
            var highlightColor = options.get('highlightColor'),
                lighten = options.get('highlightLighten'),
                parse, mult, rgbnew, i;
            if (highlightColor) {
                return highlightColor;
            }
            if (lighten) {
                // extract RGB values
                parse = /^#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(color) || /^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(color);
                if (parse) {
                    rgbnew = [];
                    mult = color.length === 4 ? 16 : 1;
                    for (i = 0; i < 3; i++) {
                        rgbnew[i] = clipval(Math.round(parseInt(parse[i + 1], 16) * mult * lighten), 0, 255);
                    }
                    return 'rgb(' + rgbnew.join(',') + ')';
                }

            }
            return color;
        }

    });

    barHighlightMixin = {
        changeHighlight: function (highlight) {
            var currentRegion = this.currentRegion,
                target = this.target,
                shapeids = this.regionShapes[currentRegion],
                newShapes;
            // will be null if the region value was null
            if (shapeids) {
                newShapes = this.renderRegion(currentRegion, highlight);
                if ($.isArray(newShapes) || $.isArray(shapeids)) {
                    target.replaceWithShapes(shapeids, newShapes);
                    this.regionShapes[currentRegion] = $.map(newShapes, function (newShape) {
                        return newShape.id;
                    });
                } else {
                    target.replaceWithShape(shapeids, newShapes);
                    this.regionShapes[currentRegion] = newShapes.id;
                }
            }
        },

        render: function () {
            var values = this.values,
                target = this.target,
                regionShapes = this.regionShapes,
                shapes, ids, i, j;

            if (!this.cls._super.render.call(this)) {
                return;
            }
            for (i = values.length; i--;) {
                shapes = this.renderRegion(i);
                if (shapes) {
                    if ($.isArray(shapes)) {
                        ids = [];
                        for (j = shapes.length; j--;) {
                            shapes[j].append();
                            ids.push(shapes[j].id);
                        }
                        regionShapes[i] = ids;
                    } else {
                        shapes.append();
                        regionShapes[i] = shapes.id; // store just the shapeid
                    }
                } else {
                    // null value
                    regionShapes[i] = null;
                }
            }
            target.render();
        }
    };

    /**
     * Line charts
     */
    $.fn.sparkline.line = line = createClass($.fn.sparkline._base, {
        type: 'line',

        init: function (el, values, options, width, height) {
            line._super.init.call(this, el, values, options, width, height);
            this.vertices = [];
            this.regionMap = [];
            this.xvalues = [];
            this.yvalues = [];
            this.yminmax = [];
            this.hightlightSpotId = null;
            this.lastShapeId = null;
            this.initTarget();
        },

        getRegion: function (el, x, y) {
            var i,
                regionMap = this.regionMap; // maps regions to value positions
            for (i = regionMap.length; i--;) {
                if (regionMap[i] !== null && x >= regionMap[i][0] && x <= regionMap[i][1]) {
                    return regionMap[i][2];
                }
            }
            return undefined;
        },

        getCurrentRegionFields: function () {
            var currentRegion = this.currentRegion;
            return {
                isNull: this.yvalues[currentRegion] === null,
                x: this.xvalues[currentRegion],
                y: this.yvalues[currentRegion],
                color: this.options.get('lineColor'),
                fillColor: this.options.get('fillColor'),
                offset: currentRegion
            };
        },

        renderHighlight: function () {
            var currentRegion = this.currentRegion,
                target = this.target,
                vertex = this.vertices[currentRegion],
                options = this.options,
                spotRadius = options.get('spotRadius'),
                highlightSpotColor = options.get('highlightSpotColor'),
                highlightLineColor = options.get('highlightLineColor'),
                highlightSpot, highlightLine;

            if (!vertex) {
                return;
            }
            if (spotRadius && highlightSpotColor) {
                highlightSpot = target.drawCircle(vertex[0], vertex[1],
                    spotRadius, undefined, highlightSpotColor);
                this.highlightSpotId = highlightSpot.id;
                target.insertAfterShape(this.lastShapeId, highlightSpot);
            }
            if (highlightLineColor) {
                highlightLine = target.drawLine(vertex[0], this.canvasTop, vertex[0],
                    this.canvasTop + this.canvasHeight, highlightLineColor);
                this.highlightLineId = highlightLine.id;
                target.insertAfterShape(this.lastShapeId, highlightLine);
            }
        },

        removeHighlight: function () {
            var target = this.target;
            if (this.highlightSpotId) {
                target.removeShapeId(this.highlightSpotId);
                this.highlightSpotId = null;
            }
            if (this.highlightLineId) {
                target.removeShapeId(this.highlightLineId);
                this.highlightLineId = null;
            }
        },

        scanValues: function () {
            var values = this.values,
                valcount = values.length,
                xvalues = this.xvalues,
                yvalues = this.yvalues,
                yminmax = this.yminmax,
                i, val, isStr, isArray, sp;
            for (i = 0; i < valcount; i++) {
                val = values[i];
                isStr = typeof(values[i]) === 'string';
                isArray = typeof(values[i]) === 'object' && values[i] instanceof Array;
                sp = isStr && values[i].split(':');
                if (isStr && sp.length === 2) { // x:y
                    xvalues.push(Number(sp[0]));
                    yvalues.push(Number(sp[1]));
                    yminmax.push(Number(sp[1]));
                } else if (isArray) {
                    xvalues.push(val[0]);
                    yvalues.push(val[1]);
                    yminmax.push(val[1]);
                } else {
                    xvalues.push(i);
                    if (values[i] === null || values[i] === 'null') {
                        yvalues.push(null);
                    } else {
                        yvalues.push(Number(val));
                        yminmax.push(Number(val));
                    }
                }
            }
            if (this.options.get('xvalues')) {
                xvalues = this.options.get('xvalues');
            }

            this.maxy = this.maxyorg = Math.max.apply(Math, yminmax);
            this.miny = this.minyorg = Math.min.apply(Math, yminmax);

            this.maxx = Math.max.apply(Math, xvalues);
            this.minx = Math.min.apply(Math, xvalues);

            this.xvalues = xvalues;
            this.yvalues = yvalues;
            this.yminmax = yminmax;

        },

        processRangeOptions: function () {
            var options = this.options,
                normalRangeMin = options.get('normalRangeMin'),
                normalRangeMax = options.get('normalRangeMax');

            if (normalRangeMin !== undefined) {
                if (normalRangeMin < this.miny) {
                    this.miny = normalRangeMin;
                }
                if (normalRangeMax > this.maxy) {
                    this.maxy = normalRangeMax;
                }
            }
            if (options.get('chartRangeMin') !== undefined && (options.get('chartRangeClip') || options.get('chartRangeMin') < this.miny)) {
                this.miny = options.get('chartRangeMin');
            }
            if (options.get('chartRangeMax') !== undefined && (options.get('chartRangeClip') || options.get('chartRangeMax') > this.maxy)) {
                this.maxy = options.get('chartRangeMax');
            }
            if (options.get('chartRangeMinX') !== undefined && (options.get('chartRangeClipX') || options.get('chartRangeMinX') < this.minx)) {
                this.minx = options.get('chartRangeMinX');
            }
            if (options.get('chartRangeMaxX') !== undefined && (options.get('chartRangeClipX') || options.get('chartRangeMaxX') > this.maxx)) {
                this.maxx = options.get('chartRangeMaxX');
            }

        },

        drawNormalRange: function (canvasLeft, canvasTop, canvasHeight, canvasWidth, rangey) {
            var normalRangeMin = this.options.get('normalRangeMin'),
                normalRangeMax = this.options.get('normalRangeMax'),
                ytop = canvasTop + Math.round(canvasHeight - (canvasHeight * ((normalRangeMax - this.miny) / rangey))),
                height = Math.round((canvasHeight * (normalRangeMax - normalRangeMin)) / rangey);
            this.target.drawRect(canvasLeft, ytop, canvasWidth, height, undefined, this.options.get('normalRangeColor')).append();
        },

        render: function () {
            var options = this.options,
                target = this.target,
                canvasWidth = this.canvasWidth,
                canvasHeight = this.canvasHeight,
                vertices = this.vertices,
                spotRadius = options.get('spotRadius'),
                regionMap = this.regionMap,
                rangex, rangey, yvallast,
                canvasTop, canvasLeft,
                vertex, path, paths, x, y, xnext, xpos, xposnext,
                last, next, yvalcount, lineShapes, fillShapes, plen,
                valueSpots, hlSpotsEnabled, color, xvalues, yvalues, i;

            if (!line._super.render.call(this)) {
                return;
            }

            this.scanValues();
            this.processRangeOptions();

            xvalues = this.xvalues;
            yvalues = this.yvalues;

            if (!this.yminmax.length || this.yvalues.length < 2) {
                // empty or all null valuess
                return;
            }

            canvasTop = canvasLeft = 0;

            rangex = this.maxx - this.minx === 0 ? 1 : this.maxx - this.minx;
            rangey = this.maxy - this.miny === 0 ? 1 : this.maxy - this.miny;
            yvallast = this.yvalues.length - 1;

            if (spotRadius && (canvasWidth < (spotRadius * 4) || canvasHeight < (spotRadius * 4))) {
                spotRadius = 0;
            }
            if (spotRadius) {
                // adjust the canvas size as required so that spots will fit
                hlSpotsEnabled = options.get('highlightSpotColor') &&  !options.get('disableInteraction');
                if (hlSpotsEnabled || options.get('minSpotColor') || (options.get('spotColor') && yvalues[yvallast] === this.miny)) {
                    canvasHeight -= Math.ceil(spotRadius);
                }
                if (hlSpotsEnabled || options.get('maxSpotColor') || (options.get('spotColor') && yvalues[yvallast] === this.maxy)) {
                    canvasHeight -= Math.ceil(spotRadius);
                    canvasTop += Math.ceil(spotRadius);
                }
                if (hlSpotsEnabled ||
                     ((options.get('minSpotColor') || options.get('maxSpotColor')) && (yvalues[0] === this.miny || yvalues[0] === this.maxy))) {
                    canvasLeft += Math.ceil(spotRadius);
                    canvasWidth -= Math.ceil(spotRadius);
                }
                if (hlSpotsEnabled || options.get('spotColor') ||
                    (options.get('minSpotColor') || options.get('maxSpotColor') &&
                        (yvalues[yvallast] === this.miny || yvalues[yvallast] === this.maxy))) {
                    canvasWidth -= Math.ceil(spotRadius);
                }
            }


            canvasHeight--;

            if (options.get('normalRangeMin') !== undefined && !options.get('drawNormalOnTop')) {
                this.drawNormalRange(canvasLeft, canvasTop, canvasHeight, canvasWidth, rangey);
            }

            path = [];
            paths = [path];
            last = next = null;
            yvalcount = yvalues.length;
            for (i = 0; i < yvalcount; i++) {
                x = xvalues[i];
                xnext = xvalues[i + 1];
                y = yvalues[i];
                xpos = canvasLeft + Math.round((x - this.minx) * (canvasWidth / rangex));
                xposnext = i < yvalcount - 1 ? canvasLeft + Math.round((xnext - this.minx) * (canvasWidth / rangex)) : canvasWidth;
                next = xpos + ((xposnext - xpos) / 2);
                regionMap[i] = [last || 0, next, i];
                last = next;
                if (y === null) {
                    if (i) {
                        if (yvalues[i - 1] !== null) {
                            path = [];
                            paths.push(path);
                        }
                        vertices.push(null);
                    }
                } else {
                    if (y < this.miny) {
                        y = this.miny;
                    }
                    if (y > this.maxy) {
                        y = this.maxy;
                    }
                    if (!path.length) {
                        // previous value was null
                        path.push([xpos, canvasTop + canvasHeight]);
                    }
                    vertex = [xpos, canvasTop + Math.round(canvasHeight - (canvasHeight * ((y - this.miny) / rangey)))];
                    path.push(vertex);
                    vertices.push(vertex);
                }
            }

            lineShapes = [];
            fillShapes = [];
            plen = paths.length;
            for (i = 0; i < plen; i++) {
                path = paths[i];
                if (path.length) {
                    if (options.get('fillColor')) {
                        path.push([path[path.length - 1][0], (canvasTop + canvasHeight)]);
                        fillShapes.push(path.slice(0));
                        path.pop();
                    }
                    // if there's only a single point in this path, then we want to display it
                    // as a vertical line which means we keep path[0]  as is
                    if (path.length > 2) {
                        // else we want the first value
                        path[0] = [path[0][0], path[1][1]];
                    }
                    lineShapes.push(path);
                }
            }

            // draw the fill first, then optionally the normal range, then the line on top of that
            plen = fillShapes.length;
            for (i = 0; i < plen; i++) {
                target.drawShape(fillShapes[i],
                    options.get('fillColor'), options.get('fillColor')).append();
            }

            if (options.get('normalRangeMin') !== undefined && options.get('drawNormalOnTop')) {
                this.drawNormalRange(canvasLeft, canvasTop, canvasHeight, canvasWidth, rangey);
            }

            plen = lineShapes.length;
            for (i = 0; i < plen; i++) {
                target.drawShape(lineShapes[i], options.get('lineColor'), undefined,
                    options.get('lineWidth')).append();
            }

            if (spotRadius && options.get('valueSpots')) {
                valueSpots = options.get('valueSpots');
                if (valueSpots.get === undefined) {
                    valueSpots = new RangeMap(valueSpots);
                }
                for (i = 0; i < yvalcount; i++) {
                    color = valueSpots.get(yvalues[i]);
                    if (color) {
                        target.drawCircle(canvasLeft + Math.round((xvalues[i] - this.minx) * (canvasWidth / rangex)),
                            canvasTop + Math.round(canvasHeight - (canvasHeight * ((yvalues[i] - this.miny) / rangey))),
                            spotRadius, undefined,
                            color).append();
                    }
                }

            }
            if (spotRadius && options.get('spotColor') && yvalues[yvallast] !== null) {
                target.drawCircle(canvasLeft + Math.round((xvalues[xvalues.length - 1] - this.minx) * (canvasWidth / rangex)),
                    canvasTop + Math.round(canvasHeight - (canvasHeight * ((yvalues[yvallast] - this.miny) / rangey))),
                    spotRadius, undefined,
                    options.get('spotColor')).append();
            }
            if (this.maxy !== this.minyorg) {
                if (spotRadius && options.get('minSpotColor')) {
                    x = xvalues[$.inArray(this.minyorg, yvalues)];
                    target.drawCircle(canvasLeft + Math.round((x - this.minx) * (canvasWidth / rangex)),
                        canvasTop + Math.round(canvasHeight - (canvasHeight * ((this.minyorg - this.miny) / rangey))),
                        spotRadius, undefined,
                        options.get('minSpotColor')).append();
                }
                if (spotRadius && options.get('maxSpotColor')) {
                    x = xvalues[$.inArray(this.maxyorg, yvalues)];
                    target.drawCircle(canvasLeft + Math.round((x - this.minx) * (canvasWidth / rangex)),
                        canvasTop + Math.round(canvasHeight - (canvasHeight * ((this.maxyorg - this.miny) / rangey))),
                        spotRadius, undefined,
                        options.get('maxSpotColor')).append();
                }
            }

            this.lastShapeId = target.getLastShapeId();
            this.canvasTop = canvasTop;
            target.render();
        }
    });

    /**
     * Bar charts
     */
    $.fn.sparkline.bar = bar = createClass($.fn.sparkline._base, barHighlightMixin, {
        type: 'bar',

        init: function (el, values, options, width, height) {
            var barWidth = parseInt(options.get('barWidth'), 10),
                barSpacing = parseInt(options.get('barSpacing'), 10),
                chartRangeMin = options.get('chartRangeMin'),
                chartRangeMax = options.get('chartRangeMax'),
                chartRangeClip = options.get('chartRangeClip'),
                stackMin = Infinity,
                stackMax = -Infinity,
                isStackString, groupMin, groupMax, stackRanges,
                numValues, i, vlen, range, zeroAxis, xaxisOffset, min, max, clipMin, clipMax,
                stacked, vlist, j, slen, svals, val, yoffset, yMaxCalc, canvasHeightEf;
            bar._super.init.call(this, el, values, options, width, height);

            // scan values to determine whether to stack bars
            for (i = 0, vlen = values.length; i < vlen; i++) {
                val = values[i];
                isStackString = typeof(val) === 'string' && val.indexOf(':') > -1;
                if (isStackString || $.isArray(val)) {
                    stacked = true;
                    if (isStackString) {
                        val = values[i] = normalizeValues(val.split(':'));
                    }
                    val = remove(val, null); // min/max will treat null as zero
                    groupMin = Math.min.apply(Math, val);
                    groupMax = Math.max.apply(Math, val);
                    if (groupMin < stackMin) {
                        stackMin = groupMin;
                    }
                    if (groupMax > stackMax) {
                        stackMax = groupMax;
                    }
                }
            }

            this.stacked = stacked;
            this.regionShapes = {};
            this.barWidth = barWidth;
            this.barSpacing = barSpacing;
            this.totalBarWidth = barWidth + barSpacing;
            this.width = width = (values.length * barWidth) + ((values.length - 1) * barSpacing);

            this.initTarget();

            if (chartRangeClip) {
                clipMin = chartRangeMin === undefined ? -Infinity : chartRangeMin;
                clipMax = chartRangeMax === undefined ? Infinity : chartRangeMax;
            }

            numValues = [];
            stackRanges = stacked ? [] : numValues;
            var stackTotals = [];
            var stackRangesNeg = [];
            for (i = 0, vlen = values.length; i < vlen; i++) {
                if (stacked) {
                    vlist = values[i];
                    values[i] = svals = [];
                    stackTotals[i] = 0;
                    stackRanges[i] = stackRangesNeg[i] = 0;
                    for (j = 0, slen = vlist.length; j < slen; j++) {
                        val = svals[j] = chartRangeClip ? clipval(vlist[j], clipMin, clipMax) : vlist[j];
                        if (val !== null) {
                            if (val > 0) {
                                stackTotals[i] += val;
                            }
                            if (stackMin < 0 && stackMax > 0) {
                                if (val < 0) {
                                    stackRangesNeg[i] += Math.abs(val);
                                } else {
                                    stackRanges[i] += val;
                                }
                            } else {
                                stackRanges[i] += Math.abs(val - (val < 0 ? stackMax : stackMin));
                            }
                            numValues.push(val);
                        }
                    }
                } else {
                    val = chartRangeClip ? clipval(values[i], clipMin, clipMax) : values[i];
                    val = values[i] = normalizeValue(val);
                    if (val !== null) {
                        numValues.push(val);
                    }
                }
            }
            this.max = max = Math.max.apply(Math, numValues);
            this.min = min = Math.min.apply(Math, numValues);
            this.stackMax = stackMax = stacked ? Math.max.apply(Math, stackTotals) : max;
            this.stackMin = stackMin = stacked ? Math.min.apply(Math, numValues) : min;

            if (options.get('chartRangeMin') !== undefined && (options.get('chartRangeClip') || options.get('chartRangeMin') < min)) {
                min = options.get('chartRangeMin');
            }
            if (options.get('chartRangeMax') !== undefined && (options.get('chartRangeClip') || options.get('chartRangeMax') > max)) {
                max = options.get('chartRangeMax');
            }

            this.zeroAxis = zeroAxis = options.get('zeroAxis', true);
            if (min <= 0 && max >= 0 && zeroAxis) {
                xaxisOffset = 0;
            } else if (zeroAxis == false) {
                xaxisOffset = min;
            } else if (min > 0) {
                xaxisOffset = min;
            } else {
                xaxisOffset = max;
            }
            this.xaxisOffset = xaxisOffset;

            range = stacked ? (Math.max.apply(Math, stackRanges) + Math.max.apply(Math, stackRangesNeg)) : max - min;

            // as we plot zero/min values a single pixel line, we add a pixel to all other
            // values - Reduce the effective canvas size to suit
            this.canvasHeightEf = (zeroAxis && min < 0) ? this.canvasHeight - 2 : this.canvasHeight - 1;

            if (min < xaxisOffset) {
                yMaxCalc = (stacked && max >= 0) ? stackMax : max;
                yoffset = (yMaxCalc - xaxisOffset) / range * this.canvasHeight;
                if (yoffset !== Math.ceil(yoffset)) {
                    this.canvasHeightEf -= 2;
                    yoffset = Math.ceil(yoffset);
                }
            } else {
                yoffset = this.canvasHeight;
            }
            this.yoffset = yoffset;

            if ($.isArray(options.get('colorMap'))) {
                this.colorMapByIndex = options.get('colorMap');
                this.colorMapByValue = null;
            } else {
                this.colorMapByIndex = null;
                this.colorMapByValue = options.get('colorMap');
                if (this.colorMapByValue && this.colorMapByValue.get === undefined) {
                    this.colorMapByValue = new RangeMap(this.colorMapByValue);
                }
            }

            this.range = range;
        },

        getRegion: function (el, x, y) {
            var result = Math.floor(x / this.totalBarWidth);
            return (result < 0 || result >= this.values.length) ? undefined : result;
        },

        getCurrentRegionFields: function () {
            var currentRegion = this.currentRegion,
                values = ensureArray(this.values[currentRegion]),
                result = [],
                value, i;
            for (i = values.length; i--;) {
                value = values[i];
                result.push({
                    isNull: value === null,
                    value: value,
                    color: this.calcColor(i, value, currentRegion),
                    offset: currentRegion
                });
            }
            return result;
        },

        calcColor: function (stacknum, value, valuenum) {
            var colorMapByIndex = this.colorMapByIndex,
                colorMapByValue = this.colorMapByValue,
                options = this.options,
                color, newColor;
            if (this.stacked) {
                color = options.get('stackedBarColor');
            } else {
                color = (value < 0) ? options.get('negBarColor') : options.get('barColor');
            }
            if (value === 0 && options.get('zeroColor') !== undefined) {
                color = options.get('zeroColor');
            }
            if (colorMapByValue && (newColor = colorMapByValue.get(value))) {
                color = newColor;
            } else if (colorMapByIndex && colorMapByIndex.length > valuenum) {
                color = colorMapByIndex[valuenum];
            }
            return $.isArray(color) ? color[stacknum % color.length] : color;
        },

        /**
         * Render bar(s) for a region
         */
        renderRegion: function (valuenum, highlight) {
            var vals = this.values[valuenum],
                options = this.options,
                xaxisOffset = this.xaxisOffset,
                result = [],
                range = this.range,
                stacked = this.stacked,
                target = this.target,
                x = valuenum * this.totalBarWidth,
                canvasHeightEf = this.canvasHeightEf,
                yoffset = this.yoffset,
                y, height, color, isNull, yoffsetNeg, i, valcount, val, minPlotted, allMin;

            vals = $.isArray(vals) ? vals : [vals];
            valcount = vals.length;
            val = vals[0];
            isNull = all(null, vals);
            allMin = all(xaxisOffset, vals, true);

            if (isNull) {
                if (options.get('nullColor')) {
                    color = highlight ? options.get('nullColor') : this.calcHighlightColor(options.get('nullColor'), options);
                    y = (yoffset > 0) ? yoffset - 1 : yoffset;
                    return target.drawRect(x, y, this.barWidth - 1, 0, color, color);
                } else {
                    return undefined;
                }
            }
            yoffsetNeg = yoffset;
            for (i = 0; i < valcount; i++) {
                val = vals[i];

                if (stacked && val === xaxisOffset) {
                    if (!allMin || minPlotted) {
                        continue;
                    }
                    minPlotted = true;
                }

                if (range > 0) {
                    height = Math.floor(canvasHeightEf * ((Math.abs(val - xaxisOffset) / range))) + 1;
                } else {
                    height = 1;
                }
                if (val < xaxisOffset || (val === xaxisOffset && yoffset === 0)) {
                    y = yoffsetNeg;
                    yoffsetNeg += height;
                } else {
                    y = yoffset - height;
                    yoffset -= height;
                }
                color = this.calcColor(i, val, valuenum);
                if (highlight) {
                    color = this.calcHighlightColor(color, options);
                }
                result.push(target.drawRect(x, y, this.barWidth - 1, height - 1, color, color));
            }
            if (result.length === 1) {
                return result[0];
            }
            return result;
        }
    });

    /**
     * Tristate charts
     */
    $.fn.sparkline.tristate = tristate = createClass($.fn.sparkline._base, barHighlightMixin, {
        type: 'tristate',

        init: function (el, values, options, width, height) {
            var barWidth = parseInt(options.get('barWidth'), 10),
                barSpacing = parseInt(options.get('barSpacing'), 10);
            tristate._super.init.call(this, el, values, options, width, height);

            this.regionShapes = {};
            this.barWidth = barWidth;
            this.barSpacing = barSpacing;
            this.totalBarWidth = barWidth + barSpacing;
            this.values = $.map(values, Number);
            this.width = width = (values.length * barWidth) + ((values.length - 1) * barSpacing);

            if ($.isArray(options.get('colorMap'))) {
                this.colorMapByIndex = options.get('colorMap');
                this.colorMapByValue = null;
            } else {
                this.colorMapByIndex = null;
                this.colorMapByValue = options.get('colorMap');
                if (this.colorMapByValue && this.colorMapByValue.get === undefined) {
                    this.colorMapByValue = new RangeMap(this.colorMapByValue);
                }
            }
            this.initTarget();
        },

        getRegion: function (el, x, y) {
            return Math.floor(x / this.totalBarWidth);
        },

        getCurrentRegionFields: function () {
            var currentRegion = this.currentRegion;
            return {
                isNull: this.values[currentRegion] === undefined,
                value: this.values[currentRegion],
                color: this.calcColor(this.values[currentRegion], currentRegion),
                offset: currentRegion
            };
        },

        calcColor: function (value, valuenum) {
            var values = this.values,
                options = this.options,
                colorMapByIndex = this.colorMapByIndex,
                colorMapByValue = this.colorMapByValue,
                color, newColor;

            if (colorMapByValue && (newColor = colorMapByValue.get(value))) {
                color = newColor;
            } else if (colorMapByIndex && colorMapByIndex.length > valuenum) {
                color = colorMapByIndex[valuenum];
            } else if (values[valuenum] < 0) {
                color = options.get('negBarColor');
            } else if (values[valuenum] > 0) {
                color = options.get('posBarColor');
            } else {
                color = options.get('zeroBarColor');
            }
            return color;
        },

        renderRegion: function (valuenum, highlight) {
            var values = this.values,
                options = this.options,
                target = this.target,
                canvasHeight, height, halfHeight,
                x, y, color;

            canvasHeight = target.pixelHeight;
            halfHeight = Math.round(canvasHeight / 2);

            x = valuenum * this.totalBarWidth;
            if (values[valuenum] < 0) {
                y = halfHeight;
                height = halfHeight - 1;
            } else if (values[valuenum] > 0) {
                y = 0;
                height = halfHeight - 1;
            } else {
                y = halfHeight - 1;
                height = 2;
            }
            color = this.calcColor(values[valuenum], valuenum);
            if (color === null) {
                return;
            }
            if (highlight) {
                color = this.calcHighlightColor(color, options);
            }
            return target.drawRect(x, y, this.barWidth - 1, height - 1, color, color);
        }
    });

    /**
     * Discrete charts
     */
    $.fn.sparkline.discrete = discrete = createClass($.fn.sparkline._base, barHighlightMixin, {
        type: 'discrete',

        init: function (el, values, options, width, height) {
            discrete._super.init.call(this, el, values, options, width, height);

            this.regionShapes = {};
            this.values = values = $.map(values, Number);
            this.min = Math.min.apply(Math, values);
            this.max = Math.max.apply(Math, values);
            this.range = this.max - this.min;
            this.width = width = options.get('width') === 'auto' ? values.length * 2 : this.width;
            this.interval = Math.floor(width / values.length);
            this.itemWidth = width / values.length;
            if (options.get('chartRangeMin') !== undefined && (options.get('chartRangeClip') || options.get('chartRangeMin') < this.min)) {
                this.min = options.get('chartRangeMin');
            }
            if (options.get('chartRangeMax') !== undefined && (options.get('chartRangeClip') || options.get('chartRangeMax') > this.max)) {
                this.max = options.get('chartRangeMax');
            }
            this.initTarget();
            if (this.target) {
                this.lineHeight = options.get('lineHeight') === 'auto' ? Math.round(this.canvasHeight * 0.3) : options.get('lineHeight');
            }
        },

        getRegion: function (el, x, y) {
            return Math.floor(x / this.itemWidth);
        },

        getCurrentRegionFields: function () {
            var currentRegion = this.currentRegion;
            return {
                isNull: this.values[currentRegion] === undefined,
                value: this.values[currentRegion],
                offset: currentRegion
            };
        },

        renderRegion: function (valuenum, highlight) {
            var values = this.values,
                options = this.options,
                min = this.min,
                max = this.max,
                range = this.range,
                interval = this.interval,
                target = this.target,
                canvasHeight = this.canvasHeight,
                lineHeight = this.lineHeight,
                pheight = canvasHeight - lineHeight,
                ytop, val, color, x;

            val = clipval(values[valuenum], min, max);
            x = valuenum * interval;
            ytop = Math.round(pheight - pheight * ((val - min) / range));
            color = (options.get('thresholdColor') && val < options.get('thresholdValue')) ? options.get('thresholdColor') : options.get('lineColor');
            if (highlight) {
                color = this.calcHighlightColor(color, options);
            }
            return target.drawLine(x, ytop, x, ytop + lineHeight, color);
        }
    });

    /**
     * Bullet charts
     */
    $.fn.sparkline.bullet = bullet = createClass($.fn.sparkline._base, {
        type: 'bullet',

        init: function (el, values, options, width, height) {
            var min, max, vals;
            bullet._super.init.call(this, el, values, options, width, height);

            // values: target, performance, range1, range2, range3
            this.values = values = normalizeValues(values);
            // target or performance could be null
            vals = values.slice();
            vals[0] = vals[0] === null ? vals[2] : vals[0];
            vals[1] = values[1] === null ? vals[2] : vals[1];
            min = Math.min.apply(Math, values);
            max = Math.max.apply(Math, values);
            if (options.get('base') === undefined) {
                min = min < 0 ? min : 0;
            } else {
                min = options.get('base');
            }
            this.min = min;
            this.max = max;
            this.range = max - min;
            this.shapes = {};
            this.valueShapes = {};
            this.regiondata = {};
            this.width = width = options.get('width') === 'auto' ? '4.0em' : width;
            this.target = this.$el.simpledraw(width, height, options.get('composite'));
            if (!values.length) {
                this.disabled = true;
            }
            this.initTarget();
        },

        getRegion: function (el, x, y) {
            var shapeid = this.target.getShapeAt(el, x, y);
            return (shapeid !== undefined && this.shapes[shapeid] !== undefined) ? this.shapes[shapeid] : undefined;
        },

        getCurrentRegionFields: function () {
            var currentRegion = this.currentRegion;
            return {
                fieldkey: currentRegion.substr(0, 1),
                value: this.values[currentRegion.substr(1)],
                region: currentRegion
            };
        },

        changeHighlight: function (highlight) {
            var currentRegion = this.currentRegion,
                shapeid = this.valueShapes[currentRegion],
                shape;
            delete this.shapes[shapeid];
            switch (currentRegion.substr(0, 1)) {
                case 'r':
                    shape = this.renderRange(currentRegion.substr(1), highlight);
                    break;
                case 'p':
                    shape = this.renderPerformance(highlight);
                    break;
                case 't':
                    shape = this.renderTarget(highlight);
                    break;
            }
            this.valueShapes[currentRegion] = shape.id;
            this.shapes[shape.id] = currentRegion;
            this.target.replaceWithShape(shapeid, shape);
        },

        renderRange: function (rn, highlight) {
            var rangeval = this.values[rn],
                rangewidth = Math.round(this.canvasWidth * ((rangeval - this.min) / this.range)),
                color = this.options.get('rangeColors')[rn - 2];
            if (highlight) {
                color = this.calcHighlightColor(color, this.options);
            }
            return this.target.drawRect(0, 0, rangewidth - 1, this.canvasHeight - 1, color, color);
        },

        renderPerformance: function (highlight) {
            var perfval = this.values[1],
                perfwidth = Math.round(this.canvasWidth * ((perfval - this.min) / this.range)),
                color = this.options.get('performanceColor');
            if (highlight) {
                color = this.calcHighlightColor(color, this.options);
            }
            return this.target.drawRect(0, Math.round(this.canvasHeight * 0.3), perfwidth - 1,
                Math.round(this.canvasHeight * 0.4) - 1, color, color);
        },

        renderTarget: function (highlight) {
            var targetval = this.values[0],
                x = Math.round(this.canvasWidth * ((targetval - this.min) / this.range) - (this.options.get('targetWidth') / 2)),
                targettop = Math.round(this.canvasHeight * 0.10),
                targetheight = this.canvasHeight - (targettop * 2),
                color = this.options.get('targetColor');
            if (highlight) {
                color = this.calcHighlightColor(color, this.options);
            }
            return this.target.drawRect(x, targettop, this.options.get('targetWidth') - 1, targetheight - 1, color, color);
        },

        render: function () {
            var vlen = this.values.length,
                target = this.target,
                i, shape;
            if (!bullet._super.render.call(this)) {
                return;
            }
            for (i = 2; i < vlen; i++) {
                shape = this.renderRange(i).append();
                this.shapes[shape.id] = 'r' + i;
                this.valueShapes['r' + i] = shape.id;
            }
            if (this.values[1] !== null) {
                shape = this.renderPerformance().append();
                this.shapes[shape.id] = 'p1';
                this.valueShapes.p1 = shape.id;
            }
            if (this.values[0] !== null) {
                shape = this.renderTarget().append();
                this.shapes[shape.id] = 't0';
                this.valueShapes.t0 = shape.id;
            }
            target.render();
        }
    });

    /**
     * Pie charts
     */
    $.fn.sparkline.pie = pie = createClass($.fn.sparkline._base, {
        type: 'pie',

        init: function (el, values, options, width, height) {
            var total = 0, i;

            pie._super.init.call(this, el, values, options, width, height);

            this.shapes = {}; // map shape ids to value offsets
            this.valueShapes = {}; // maps value offsets to shape ids
            this.values = values = $.map(values, Number);

            if (options.get('width') === 'auto') {
                this.width = this.height;
            }

            if (values.length > 0) {
                for (i = values.length; i--;) {
                    total += values[i];
                }
            }
            this.total = total;
            this.initTarget();
            this.radius = Math.floor(Math.min(this.canvasWidth, this.canvasHeight) / 2);
        },

        getRegion: function (el, x, y) {
            var shapeid = this.target.getShapeAt(el, x, y);
            return (shapeid !== undefined && this.shapes[shapeid] !== undefined) ? this.shapes[shapeid] : undefined;
        },

        getCurrentRegionFields: function () {
            var currentRegion = this.currentRegion;
            return {
                isNull: this.values[currentRegion] === undefined,
                value: this.values[currentRegion],
                percent: this.values[currentRegion] / this.total * 100,
                color: this.options.get('sliceColors')[currentRegion % this.options.get('sliceColors').length],
                offset: currentRegion
            };
        },

        changeHighlight: function (highlight) {
            var currentRegion = this.currentRegion,
                 newslice = this.renderSlice(currentRegion, highlight),
                 shapeid = this.valueShapes[currentRegion];
            delete this.shapes[shapeid];
            this.target.replaceWithShape(shapeid, newslice);
            this.valueShapes[currentRegion] = newslice.id;
            this.shapes[newslice.id] = currentRegion;
        },

        renderSlice: function (valuenum, highlight) {
            var target = this.target,
                options = this.options,
                radius = this.radius,
                borderWidth = options.get('borderWidth'),
                offset = options.get('offset'),
                circle = 2 * Math.PI,
                values = this.values,
                total = this.total,
                next = offset ? (2*Math.PI)*(offset/360) : 0,
                start, end, i, vlen, color;

            vlen = values.length;
            for (i = 0; i < vlen; i++) {
                start = next;
                end = next;
                if (total > 0) {  // avoid divide by zero
                    end = next + (circle * (values[i] / total));
                }
                if (valuenum === i) {
                    color = options.get('sliceColors')[i % options.get('sliceColors').length];
                    if (highlight) {
                        color = this.calcHighlightColor(color, options);
                    }

                    return target.drawPieSlice(radius, radius, radius - borderWidth, start, end, undefined, color);
                }
                next = end;
            }
        },

        render: function () {
            var target = this.target,
                values = this.values,
                options = this.options,
                radius = this.radius,
                borderWidth = options.get('borderWidth'),
                shape, i;

            if (!pie._super.render.call(this)) {
                return;
            }
            if (borderWidth) {
                target.drawCircle(radius, radius, Math.floor(radius - (borderWidth / 2)),
                    options.get('borderColor'), undefined, borderWidth).append();
            }
            for (i = values.length; i--;) {
                if (values[i]) { // don't render zero values
                    shape = this.renderSlice(i).append();
                    this.valueShapes[i] = shape.id; // store just the shapeid
                    this.shapes[shape.id] = i;
                }
            }
            target.render();
        }
    });

    /**
     * Box plots
     */
    $.fn.sparkline.box = box = createClass($.fn.sparkline._base, {
        type: 'box',

        init: function (el, values, options, width, height) {
            box._super.init.call(this, el, values, options, width, height);
            this.values = $.map(values, Number);
            this.width = options.get('width') === 'auto' ? '4.0em' : width;
            this.initTarget();
            if (!this.values.length) {
                this.disabled = 1;
            }
        },

        /**
         * Simulate a single region
         */
        getRegion: function () {
            return 1;
        },

        getCurrentRegionFields: function () {
            var result = [
                { field: 'lq', value: this.quartiles[0] },
                { field: 'med', value: this.quartiles[1] },
                { field: 'uq', value: this.quartiles[2] }
            ];
            if (this.loutlier !== undefined) {
                result.push({ field: 'lo', value: this.loutlier});
            }
            if (this.routlier !== undefined) {
                result.push({ field: 'ro', value: this.routlier});
            }
            if (this.lwhisker !== undefined) {
                result.push({ field: 'lw', value: this.lwhisker});
            }
            if (this.rwhisker !== undefined) {
                result.push({ field: 'rw', value: this.rwhisker});
            }
            return result;
        },

        render: function () {
            var target = this.target,
                values = this.values,
                vlen = values.length,
                options = this.options,
                canvasWidth = this.canvasWidth,
                canvasHeight = this.canvasHeight,
                minValue = options.get('chartRangeMin') === undefined ? Math.min.apply(Math, values) : options.get('chartRangeMin'),
                maxValue = options.get('chartRangeMax') === undefined ? Math.max.apply(Math, values) : options.get('chartRangeMax'),
                canvasLeft = 0,
                lwhisker, loutlier, iqr, q1, q2, q3, rwhisker, routlier, i,
                size, unitSize;

            if (!box._super.render.call(this)) {
                return;
            }

            if (options.get('raw')) {
                if (options.get('showOutliers') && values.length > 5) {
                    loutlier = values[0];
                    lwhisker = values[1];
                    q1 = values[2];
                    q2 = values[3];
                    q3 = values[4];
                    rwhisker = values[5];
                    routlier = values[6];
                } else {
                    lwhisker = values[0];
                    q1 = values[1];
                    q2 = values[2];
                    q3 = values[3];
                    rwhisker = values[4];
                }
            } else {
                values.sort(function (a, b) { return a - b; });
                q1 = quartile(values, 1);
                q2 = quartile(values, 2);
                q3 = quartile(values, 3);
                iqr = q3 - q1;
                if (options.get('showOutliers')) {
                    lwhisker = rwhisker = undefined;
                    for (i = 0; i < vlen; i++) {
                        if (lwhisker === undefined && values[i] > q1 - (iqr * options.get('outlierIQR'))) {
                            lwhisker = values[i];
                        }
                        if (values[i] < q3 + (iqr * options.get('outlierIQR'))) {
                            rwhisker = values[i];
                        }
                    }
                    loutlier = values[0];
                    routlier = values[vlen - 1];
                } else {
                    lwhisker = values[0];
                    rwhisker = values[vlen - 1];
                }
            }
            this.quartiles = [q1, q2, q3];
            this.lwhisker = lwhisker;
            this.rwhisker = rwhisker;
            this.loutlier = loutlier;
            this.routlier = routlier;

            unitSize = canvasWidth / (maxValue - minValue + 1);
            if (options.get('showOutliers')) {
                canvasLeft = Math.ceil(options.get('spotRadius'));
                canvasWidth -= 2 * Math.ceil(options.get('spotRadius'));
                unitSize = canvasWidth / (maxValue - minValue + 1);
                if (loutlier < lwhisker) {
                    target.drawCircle((loutlier - minValue) * unitSize + canvasLeft,
                        canvasHeight / 2,
                        options.get('spotRadius'),
                        options.get('outlierLineColor'),
                        options.get('outlierFillColor')).append();
                }
                if (routlier > rwhisker) {
                    target.drawCircle((routlier - minValue) * unitSize + canvasLeft,
                        canvasHeight / 2,
                        options.get('spotRadius'),
                        options.get('outlierLineColor'),
                        options.get('outlierFillColor')).append();
                }
            }

            // box
            target.drawRect(
                Math.round((q1 - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight * 0.1),
                Math.round((q3 - q1) * unitSize),
                Math.round(canvasHeight * 0.8),
                options.get('boxLineColor'),
                options.get('boxFillColor')).append();
            // left whisker
            target.drawLine(
                Math.round((lwhisker - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight / 2),
                Math.round((q1 - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight / 2),
                options.get('lineColor')).append();
            target.drawLine(
                Math.round((lwhisker - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight / 4),
                Math.round((lwhisker - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight - canvasHeight / 4),
                options.get('whiskerColor')).append();
            // right whisker
            target.drawLine(Math.round((rwhisker - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight / 2),
                Math.round((q3 - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight / 2),
                options.get('lineColor')).append();
            target.drawLine(
                Math.round((rwhisker - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight / 4),
                Math.round((rwhisker - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight - canvasHeight / 4),
                options.get('whiskerColor')).append();
            // median line
            target.drawLine(
                Math.round((q2 - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight * 0.1),
                Math.round((q2 - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight * 0.9),
                options.get('medianColor')).append();
            if (options.get('target')) {
                size = Math.ceil(options.get('spotRadius'));
                target.drawLine(
                    Math.round((options.get('target') - minValue) * unitSize + canvasLeft),
                    Math.round((canvasHeight / 2) - size),
                    Math.round((options.get('target') - minValue) * unitSize + canvasLeft),
                    Math.round((canvasHeight / 2) + size),
                    options.get('targetColor')).append();
                target.drawLine(
                    Math.round((options.get('target') - minValue) * unitSize + canvasLeft - size),
                    Math.round(canvasHeight / 2),
                    Math.round((options.get('target') - minValue) * unitSize + canvasLeft + size),
                    Math.round(canvasHeight / 2),
                    options.get('targetColor')).append();
            }
            target.render();
        }
    });

    // Setup a very simple "virtual canvas" to make drawing the few shapes we need easier
    // This is accessible as $(foo).simpledraw()

    VShape = createClass({
        init: function (target, id, type, args) {
            this.target = target;
            this.id = id;
            this.type = type;
            this.args = args;
        },
        append: function () {
            this.target.appendShape(this);
            return this;
        }
    });

    VCanvas_base = createClass({
        _pxregex: /(\d+)(px)?\s*$/i,

        init: function (width, height, target) {
            if (!width) {
                return;
            }
            this.width = width;
            this.height = height;
            this.target = target;
            this.lastShapeId = null;
            if (target[0]) {
                target = target[0];
            }
            $.data(target, '_jqs_vcanvas', this);
        },

        drawLine: function (x1, y1, x2, y2, lineColor, lineWidth) {
            return this.drawShape([[x1, y1], [x2, y2]], lineColor, lineWidth);
        },

        drawShape: function (path, lineColor, fillColor, lineWidth) {
            return this._genShape('Shape', [path, lineColor, fillColor, lineWidth]);
        },

        drawCircle: function (x, y, radius, lineColor, fillColor, lineWidth) {
            return this._genShape('Circle', [x, y, radius, lineColor, fillColor, lineWidth]);
        },

        drawPieSlice: function (x, y, radius, startAngle, endAngle, lineColor, fillColor) {
            return this._genShape('PieSlice', [x, y, radius, startAngle, endAngle, lineColor, fillColor]);
        },

        drawRect: function (x, y, width, height, lineColor, fillColor) {
            return this._genShape('Rect', [x, y, width, height, lineColor, fillColor]);
        },

        getElement: function () {
            return this.canvas;
        },

        /**
         * Return the most recently inserted shape id
         */
        getLastShapeId: function () {
            return this.lastShapeId;
        },

        /**
         * Clear and reset the canvas
         */
        reset: function () {
            alert('reset not implemented');
        },

        _insert: function (el, target) {
            $(target).html(el);
        },

        /**
         * Calculate the pixel dimensions of the canvas
         */
        _calculatePixelDims: function (width, height, canvas) {
            // XXX This should probably be a configurable option
            var match;
            match = this._pxregex.exec(height);
            if (match) {
                this.pixelHeight = match[1];
            } else {
                this.pixelHeight = $(canvas).height();
            }
            match = this._pxregex.exec(width);
            if (match) {
                this.pixelWidth = match[1];
            } else {
                this.pixelWidth = $(canvas).width();
            }
        },

        /**
         * Generate a shape object and id for later rendering
         */
        _genShape: function (shapetype, shapeargs) {
            var id = shapeCount++;
            shapeargs.unshift(id);
            return new VShape(this, id, shapetype, shapeargs);
        },

        /**
         * Add a shape to the end of the render queue
         */
        appendShape: function (shape) {
            alert('appendShape not implemented');
        },

        /**
         * Replace one shape with another
         */
        replaceWithShape: function (shapeid, shape) {
            alert('replaceWithShape not implemented');
        },

        /**
         * Insert one shape after another in the render queue
         */
        insertAfterShape: function (shapeid, shape) {
            alert('insertAfterShape not implemented');
        },

        /**
         * Remove a shape from the queue
         */
        removeShapeId: function (shapeid) {
            alert('removeShapeId not implemented');
        },

        /**
         * Find a shape at the specified x/y co-ordinates
         */
        getShapeAt: function (el, x, y) {
            alert('getShapeAt not implemented');
        },

        /**
         * Render all queued shapes onto the canvas
         */
        render: function () {
            alert('render not implemented');
        }
    });

    VCanvas_canvas = createClass(VCanvas_base, {
        init: function (width, height, target, interact) {
            VCanvas_canvas._super.init.call(this, width, height, target);
            this.canvas = document.createElement('canvas');
            if (target[0]) {
                target = target[0];
            }
            $.data(target, '_jqs_vcanvas', this);
            $(this.canvas).css({ display: 'inline-block', width: width, height: height, verticalAlign: 'top' });
            this._insert(this.canvas, target);
            this._calculatePixelDims(width, height, this.canvas);
            this.canvas.width = this.pixelWidth;
            this.canvas.height = this.pixelHeight;
            this.interact = interact;
            this.shapes = {};
            this.shapeseq = [];
            this.currentTargetShapeId = undefined;
            $(this.canvas).css({width: this.pixelWidth, height: this.pixelHeight});
        },

        _getContext: function (lineColor, fillColor, lineWidth) {
            var context = this.canvas.getContext('2d');
            if (lineColor !== undefined) {
                context.strokeStyle = lineColor;
            }
            context.lineWidth = lineWidth === undefined ? 1 : lineWidth;
            if (fillColor !== undefined) {
                context.fillStyle = fillColor;
            }
            return context;
        },

        reset: function () {
            var context = this._getContext();
            context.clearRect(0, 0, this.pixelWidth, this.pixelHeight);
            this.shapes = {};
            this.shapeseq = [];
            this.currentTargetShapeId = undefined;
        },

        _drawShape: function (shapeid, path, lineColor, fillColor, lineWidth) {
            var context = this._getContext(lineColor, fillColor, lineWidth),
                i, plen;
            context.beginPath();
            context.moveTo(path[0][0] + 0.5, path[0][1] + 0.5);
            for (i = 1, plen = path.length; i < plen; i++) {
                context.lineTo(path[i][0] + 0.5, path[i][1] + 0.5); // the 0.5 offset gives us crisp pixel-width lines
            }
            if (lineColor !== undefined) {
                context.stroke();
            }
            if (fillColor !== undefined) {
                context.fill();
            }
            if (this.targetX !== undefined && this.targetY !== undefined &&
                context.isPointInPath(this.targetX, this.targetY)) {
                this.currentTargetShapeId = shapeid;
            }
        },

        _drawCircle: function (shapeid, x, y, radius, lineColor, fillColor, lineWidth) {
            var context = this._getContext(lineColor, fillColor, lineWidth);
            context.beginPath();
            context.arc(x, y, radius, 0, 2 * Math.PI, false);
            if (this.targetX !== undefined && this.targetY !== undefined &&
                context.isPointInPath(this.targetX, this.targetY)) {
                this.currentTargetShapeId = shapeid;
            }
            if (lineColor !== undefined) {
                context.stroke();
            }
            if (fillColor !== undefined) {
                context.fill();
            }
        },

        _drawPieSlice: function (shapeid, x, y, radius, startAngle, endAngle, lineColor, fillColor) {
            var context = this._getContext(lineColor, fillColor);
            context.beginPath();
            context.moveTo(x, y);
            context.arc(x, y, radius, startAngle, endAngle, false);
            context.lineTo(x, y);
            context.closePath();
            if (lineColor !== undefined) {
                context.stroke();
            }
            if (fillColor) {
                context.fill();
            }
            if (this.targetX !== undefined && this.targetY !== undefined &&
                context.isPointInPath(this.targetX, this.targetY)) {
                this.currentTargetShapeId = shapeid;
            }
        },

        _drawRect: function (shapeid, x, y, width, height, lineColor, fillColor) {
            return this._drawShape(shapeid, [[x, y], [x + width, y], [x + width, y + height], [x, y + height], [x, y]], lineColor, fillColor);
        },

        appendShape: function (shape) {
            this.shapes[shape.id] = shape;
            this.shapeseq.push(shape.id);
            this.lastShapeId = shape.id;
            return shape.id;
        },

        replaceWithShape: function (shapeid, shape) {
            var shapeseq = this.shapeseq,
                i;
            this.shapes[shape.id] = shape;
            for (i = shapeseq.length; i--;) {
                if (shapeseq[i] == shapeid) {
                    shapeseq[i] = shape.id;
                }
            }
            delete this.shapes[shapeid];
        },

        replaceWithShapes: function (shapeids, shapes) {
            var shapeseq = this.shapeseq,
                shapemap = {},
                sid, i, first;

            for (i = shapeids.length; i--;) {
                shapemap[shapeids[i]] = true;
            }
            for (i = shapeseq.length; i--;) {
                sid = shapeseq[i];
                if (shapemap[sid]) {
                    shapeseq.splice(i, 1);
                    delete this.shapes[sid];
                    first = i;
                }
            }
            for (i = shapes.length; i--;) {
                shapeseq.splice(first, 0, shapes[i].id);
                this.shapes[shapes[i].id] = shapes[i];
            }

        },

        insertAfterShape: function (shapeid, shape) {
            var shapeseq = this.shapeseq,
                i;
            for (i = shapeseq.length; i--;) {
                if (shapeseq[i] === shapeid) {
                    shapeseq.splice(i + 1, 0, shape.id);
                    this.shapes[shape.id] = shape;
                    return;
                }
            }
        },

        removeShapeId: function (shapeid) {
            var shapeseq = this.shapeseq,
                i;
            for (i = shapeseq.length; i--;) {
                if (shapeseq[i] === shapeid) {
                    shapeseq.splice(i, 1);
                    break;
                }
            }
            delete this.shapes[shapeid];
        },

        getShapeAt: function (el, x, y) {
            this.targetX = x;
            this.targetY = y;
            this.render();
            return this.currentTargetShapeId;
        },

        render: function () {
            var shapeseq = this.shapeseq,
                shapes = this.shapes,
                shapeCount = shapeseq.length,
                context = this._getContext(),
                shapeid, shape, i;
            context.clearRect(0, 0, this.pixelWidth, this.pixelHeight);
            for (i = 0; i < shapeCount; i++) {
                shapeid = shapeseq[i];
                shape = shapes[shapeid];
                this['_draw' + shape.type].apply(this, shape.args);
            }
            if (!this.interact) {
                // not interactive so no need to keep the shapes array
                this.shapes = {};
                this.shapeseq = [];
            }
        }

    });

    VCanvas_vml = createClass(VCanvas_base, {
        init: function (width, height, target) {
            var groupel;
            VCanvas_vml._super.init.call(this, width, height, target);
            if (target[0]) {
                target = target[0];
            }
            $.data(target, '_jqs_vcanvas', this);
            this.canvas = document.createElement('span');
            $(this.canvas).css({ display: 'inline-block', position: 'relative', overflow: 'hidden', width: width, height: height, margin: '0px', padding: '0px', verticalAlign: 'top'});
            this._insert(this.canvas, target);
            this._calculatePixelDims(width, height, this.canvas);
            this.canvas.width = this.pixelWidth;
            this.canvas.height = this.pixelHeight;
            groupel = '<v:group coordorigin="0 0" coordsize="' + this.pixelWidth + ' ' + this.pixelHeight + '"' +
                    ' style="position:absolute;top:0;left:0;width:' + this.pixelWidth + 'px;height=' + this.pixelHeight + 'px;"></v:group>';
            this.canvas.insertAdjacentHTML('beforeEnd', groupel);
            this.group = $(this.canvas).children()[0];
            this.rendered = false;
            this.prerender = '';
        },

        _drawShape: function (shapeid, path, lineColor, fillColor, lineWidth) {
            var vpath = [],
                initial, stroke, fill, closed, vel, plen, i;
            for (i = 0, plen = path.length; i < plen; i++) {
                vpath[i] = '' + (path[i][0]) + ',' + (path[i][1]);
            }
            initial = vpath.splice(0, 1);
            lineWidth = lineWidth === undefined ? 1 : lineWidth;
            stroke = lineColor === undefined ? ' stroked="false" ' : ' strokeWeight="' + lineWidth + 'px" strokeColor="' + lineColor + '" ';
            fill = fillColor === undefined ? ' filled="false"' : ' fillColor="' + fillColor + '" filled="true" ';
            closed = vpath[0] === vpath[vpath.length - 1] ? 'x ' : '';
            vel = '<v:shape coordorigin="0 0" coordsize="' + this.pixelWidth + ' ' + this.pixelHeight + '" ' +
                 ' id="jqsshape' + shapeid + '" ' +
                 stroke +
                 fill +
                ' style="position:absolute;left:0px;top:0px;height:' + this.pixelHeight + 'px;width:' + this.pixelWidth + 'px;padding:0px;margin:0px;" ' +
                ' path="m ' + initial + ' l ' + vpath.join(', ') + ' ' + closed + 'e">' +
                ' </v:shape>';
            return vel;
        },

        _drawCircle: function (shapeid, x, y, radius, lineColor, fillColor, lineWidth) {
            var stroke, fill, vel;
            x -= radius;
            y -= radius;
            stroke = lineColor === undefined ? ' stroked="false" ' : ' strokeWeight="' + lineWidth + 'px" strokeColor="' + lineColor + '" ';
            fill = fillColor === undefined ? ' filled="false"' : ' fillColor="' + fillColor + '" filled="true" ';
            vel = '<v:oval ' +
                 ' id="jqsshape' + shapeid + '" ' +
                stroke +
                fill +
                ' style="position:absolute;top:' + y + 'px; left:' + x + 'px; width:' + (radius * 2) + 'px; height:' + (radius * 2) + 'px"></v:oval>';
            return vel;

        },

        _drawPieSlice: function (shapeid, x, y, radius, startAngle, endAngle, lineColor, fillColor) {
            var vpath, startx, starty, endx, endy, stroke, fill, vel;
            if (startAngle === endAngle) {
                return '';  // VML seems to have problem when start angle equals end angle.
            }
            if ((endAngle - startAngle) === (2 * Math.PI)) {
                startAngle = 0.0;  // VML seems to have a problem when drawing a full circle that doesn't start 0
                endAngle = (2 * Math.PI);
            }

            startx = x + Math.round(Math.cos(startAngle) * radius);
            starty = y + Math.round(Math.sin(startAngle) * radius);
            endx = x + Math.round(Math.cos(endAngle) * radius);
            endy = y + Math.round(Math.sin(endAngle) * radius);

            if (startx === endx && starty === endy) {
                if ((endAngle - startAngle) < Math.PI) {
                    // Prevent very small slices from being mistaken as a whole pie
                    return '';
                }
                // essentially going to be the entire circle, so ignore startAngle
                startx = endx = x + radius;
                starty = endy = y;
            }

            if (startx === endx && starty === endy && (endAngle - startAngle) < Math.PI) {
                return '';
            }

            vpath = [x - radius, y - radius, x + radius, y + radius, startx, starty, endx, endy];
            stroke = lineColor === undefined ? ' stroked="false" ' : ' strokeWeight="1px" strokeColor="' + lineColor + '" ';
            fill = fillColor === undefined ? ' filled="false"' : ' fillColor="' + fillColor + '" filled="true" ';
            vel = '<v:shape coordorigin="0 0" coordsize="' + this.pixelWidth + ' ' + this.pixelHeight + '" ' +
                 ' id="jqsshape' + shapeid + '" ' +
                 stroke +
                 fill +
                ' style="position:absolute;left:0px;top:0px;height:' + this.pixelHeight + 'px;width:' + this.pixelWidth + 'px;padding:0px;margin:0px;" ' +
                ' path="m ' + x + ',' + y + ' wa ' + vpath.join(', ') + ' x e">' +
                ' </v:shape>';
            return vel;
        },

        _drawRect: function (shapeid, x, y, width, height, lineColor, fillColor) {
            return this._drawShape(shapeid, [[x, y], [x, y + height], [x + width, y + height], [x + width, y], [x, y]], lineColor, fillColor);
        },

        reset: function () {
            this.group.innerHTML = '';
        },

        appendShape: function (shape) {
            var vel = this['_draw' + shape.type].apply(this, shape.args);
            if (this.rendered) {
                this.group.insertAdjacentHTML('beforeEnd', vel);
            } else {
                this.prerender += vel;
            }
            this.lastShapeId = shape.id;
            return shape.id;
        },

        replaceWithShape: function (shapeid, shape) {
            var existing = $('#jqsshape' + shapeid),
                vel = this['_draw' + shape.type].apply(this, shape.args);
            existing[0].outerHTML = vel;
        },

        replaceWithShapes: function (shapeids, shapes) {
            // replace the first shapeid with all the new shapes then toast the remaining old shapes
            var existing = $('#jqsshape' + shapeids[0]),
                replace = '',
                slen = shapes.length,
                i;
            for (i = 0; i < slen; i++) {
                replace += this['_draw' + shapes[i].type].apply(this, shapes[i].args);
            }
            existing[0].outerHTML = replace;
            for (i = 1; i < shapeids.length; i++) {
                $('#jqsshape' + shapeids[i]).remove();
            }
        },

        insertAfterShape: function (shapeid, shape) {
            var existing = $('#jqsshape' + shapeid),
                 vel = this['_draw' + shape.type].apply(this, shape.args);
            existing[0].insertAdjacentHTML('afterEnd', vel);
        },

        removeShapeId: function (shapeid) {
            var existing = $('#jqsshape' + shapeid);
            this.group.removeChild(existing[0]);
        },

        getShapeAt: function (el, x, y) {
            var shapeid = el.id.substr(8);
            return shapeid;
        },

        render: function () {
            if (!this.rendered) {
                // batch the intial render into a single repaint
                this.group.innerHTML = this.prerender;
                this.rendered = true;
            }
        }
    });

}))}(document, Math));

},{}],4:[function(require,module,exports){
/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */

/*global define: false Mustache: true*/

(function defineMustache (global, factory) {
  if (typeof exports === 'object' && exports && typeof exports.nodeName !== 'string') {
    factory(exports); // CommonJS
  } else if (typeof define === 'function' && define.amd) {
    define(['exports'], factory); // AMD
  } else {
    global.Mustache = {};
    factory(global.Mustache); // script, wsh, asp
  }
}(this, function mustacheFactory (mustache) {

  var objectToString = Object.prototype.toString;
  var isArray = Array.isArray || function isArrayPolyfill (object) {
    return objectToString.call(object) === '[object Array]';
  };

  function isFunction (object) {
    return typeof object === 'function';
  }

  /**
   * More correct typeof string handling array
   * which normally returns typeof 'object'
   */
  function typeStr (obj) {
    return isArray(obj) ? 'array' : typeof obj;
  }

  function escapeRegExp (string) {
    return string.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g, '\\$&');
  }

  /**
   * Null safe way of checking whether or not an object,
   * including its prototype, has a given property
   */
  function hasProperty (obj, propName) {
    return obj != null && typeof obj === 'object' && (propName in obj);
  }

  // Workaround for https://issues.apache.org/jira/browse/COUCHDB-577
  // See https://github.com/janl/mustache.js/issues/189
  var regExpTest = RegExp.prototype.test;
  function testRegExp (re, string) {
    return regExpTest.call(re, string);
  }

  var nonSpaceRe = /\S/;
  function isWhitespace (string) {
    return !testRegExp(nonSpaceRe, string);
  }

  var entityMap = {
    '&': '&amp;',
    '<': '&lt;',
    '>': '&gt;',
    '"': '&quot;',
    "'": '&#39;',
    '/': '&#x2F;',
    '`': '&#x60;',
    '=': '&#x3D;'
  };

  function escapeHtml (string) {
    return String(string).replace(/[&<>"'`=\/]/g, function fromEntityMap (s) {
      return entityMap[s];
    });
  }

  var whiteRe = /\s*/;
  var spaceRe = /\s+/;
  var equalsRe = /\s*=/;
  var curlyRe = /\s*\}/;
  var tagRe = /#|\^|\/|>|\{|&|=|!/;

  /**
   * Breaks up the given `template` string into a tree of tokens. If the `tags`
   * argument is given here it must be an array with two string values: the
   * opening and closing tags used in the template (e.g. [ "<%", "%>" ]). Of
   * course, the default is to use mustaches (i.e. mustache.tags).
   *
   * A token is an array with at least 4 elements. The first element is the
   * mustache symbol that was used inside the tag, e.g. "#" or "&". If the tag
   * did not contain a symbol (i.e. {{myValue}}) this element is "name". For
   * all text that appears outside a symbol this element is "text".
   *
   * The second element of a token is its "value". For mustache tags this is
   * whatever else was inside the tag besides the opening symbol. For text tokens
   * this is the text itself.
   *
   * The third and fourth elements of the token are the start and end indices,
   * respectively, of the token in the original template.
   *
   * Tokens that are the root node of a subtree contain two more elements: 1) an
   * array of tokens in the subtree and 2) the index in the original template at
   * which the closing tag for that section begins.
   */
  function parseTemplate (template, tags) {
    if (!template)
      return [];

    var sections = [];     // Stack to hold section tokens
    var tokens = [];       // Buffer to hold the tokens
    var spaces = [];       // Indices of whitespace tokens on the current line
    var hasTag = false;    // Is there a {{tag}} on the current line?
    var nonSpace = false;  // Is there a non-space char on the current line?

    // Strips all whitespace tokens array for the current line
    // if there was a {{#tag}} on it and otherwise only space.
    function stripSpace () {
      if (hasTag && !nonSpace) {
        while (spaces.length)
          delete tokens[spaces.pop()];
      } else {
        spaces = [];
      }

      hasTag = false;
      nonSpace = false;
    }

    var openingTagRe, closingTagRe, closingCurlyRe;
    function compileTags (tagsToCompile) {
      if (typeof tagsToCompile === 'string')
        tagsToCompile = tagsToCompile.split(spaceRe, 2);

      if (!isArray(tagsToCompile) || tagsToCompile.length !== 2)
        throw new Error('Invalid tags: ' + tagsToCompile);

      openingTagRe = new RegExp(escapeRegExp(tagsToCompile[0]) + '\\s*');
      closingTagRe = new RegExp('\\s*' + escapeRegExp(tagsToCompile[1]));
      closingCurlyRe = new RegExp('\\s*' + escapeRegExp('}' + tagsToCompile[1]));
    }

    compileTags(tags || mustache.tags);

    var scanner = new Scanner(template);

    var start, type, value, chr, token, openSection;
    while (!scanner.eos()) {
      start = scanner.pos;

      // Match any text between tags.
      value = scanner.scanUntil(openingTagRe);

      if (value) {
        for (var i = 0, valueLength = value.length; i < valueLength; ++i) {
          chr = value.charAt(i);

          if (isWhitespace(chr)) {
            spaces.push(tokens.length);
          } else {
            nonSpace = true;
          }

          tokens.push([ 'text', chr, start, start + 1 ]);
          start += 1;

          // Check for whitespace on the current line.
          if (chr === '\n')
            stripSpace();
        }
      }

      // Match the opening tag.
      if (!scanner.scan(openingTagRe))
        break;

      hasTag = true;

      // Get the tag type.
      type = scanner.scan(tagRe) || 'name';
      scanner.scan(whiteRe);

      // Get the tag value.
      if (type === '=') {
        value = scanner.scanUntil(equalsRe);
        scanner.scan(equalsRe);
        scanner.scanUntil(closingTagRe);
      } else if (type === '{') {
        value = scanner.scanUntil(closingCurlyRe);
        scanner.scan(curlyRe);
        scanner.scanUntil(closingTagRe);
        type = '&';
      } else {
        value = scanner.scanUntil(closingTagRe);
      }

      // Match the closing tag.
      if (!scanner.scan(closingTagRe))
        throw new Error('Unclosed tag at ' + scanner.pos);

      token = [ type, value, start, scanner.pos ];
      tokens.push(token);

      if (type === '#' || type === '^') {
        sections.push(token);
      } else if (type === '/') {
        // Check section nesting.
        openSection = sections.pop();

        if (!openSection)
          throw new Error('Unopened section "' + value + '" at ' + start);

        if (openSection[1] !== value)
          throw new Error('Unclosed section "' + openSection[1] + '" at ' + start);
      } else if (type === 'name' || type === '{' || type === '&') {
        nonSpace = true;
      } else if (type === '=') {
        // Set the tags for the next time around.
        compileTags(value);
      }
    }

    // Make sure there are no open sections when we're done.
    openSection = sections.pop();

    if (openSection)
      throw new Error('Unclosed section "' + openSection[1] + '" at ' + scanner.pos);

    return nestTokens(squashTokens(tokens));
  }

  /**
   * Combines the values of consecutive text tokens in the given `tokens` array
   * to a single token.
   */
  function squashTokens (tokens) {
    var squashedTokens = [];

    var token, lastToken;
    for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {
      token = tokens[i];

      if (token) {
        if (token[0] === 'text' && lastToken && lastToken[0] === 'text') {
          lastToken[1] += token[1];
          lastToken[3] = token[3];
        } else {
          squashedTokens.push(token);
          lastToken = token;
        }
      }
    }

    return squashedTokens;
  }

  /**
   * Forms the given array of `tokens` into a nested tree structure where
   * tokens that represent a section have two additional items: 1) an array of
   * all tokens that appear in that section and 2) the index in the original
   * template that represents the end of that section.
   */
  function nestTokens (tokens) {
    var nestedTokens = [];
    var collector = nestedTokens;
    var sections = [];

    var token, section;
    for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {
      token = tokens[i];

      switch (token[0]) {
        case '#':
        case '^':
          collector.push(token);
          sections.push(token);
          collector = token[4] = [];
          break;
        case '/':
          section = sections.pop();
          section[5] = token[2];
          collector = sections.length > 0 ? sections[sections.length - 1][4] : nestedTokens;
          break;
        default:
          collector.push(token);
      }
    }

    return nestedTokens;
  }

  /**
   * A simple string scanner that is used by the template parser to find
   * tokens in template strings.
   */
  function Scanner (string) {
    this.string = string;
    this.tail = string;
    this.pos = 0;
  }

  /**
   * Returns `true` if the tail is empty (end of string).
   */
  Scanner.prototype.eos = function eos () {
    return this.tail === '';
  };

  /**
   * Tries to match the given regular expression at the current position.
   * Returns the matched text if it can match, the empty string otherwise.
   */
  Scanner.prototype.scan = function scan (re) {
    var match = this.tail.match(re);

    if (!match || match.index !== 0)
      return '';

    var string = match[0];

    this.tail = this.tail.substring(string.length);
    this.pos += string.length;

    return string;
  };

  /**
   * Skips all text until the given regular expression can be matched. Returns
   * the skipped string, which is the entire tail if no match can be made.
   */
  Scanner.prototype.scanUntil = function scanUntil (re) {
    var index = this.tail.search(re), match;

    switch (index) {
      case -1:
        match = this.tail;
        this.tail = '';
        break;
      case 0:
        match = '';
        break;
      default:
        match = this.tail.substring(0, index);
        this.tail = this.tail.substring(index);
    }

    this.pos += match.length;

    return match;
  };

  /**
   * Represents a rendering context by wrapping a view object and
   * maintaining a reference to the parent context.
   */
  function Context (view, parentContext) {
    this.view = view;
    this.cache = { '.': this.view };
    this.parent = parentContext;
  }

  /**
   * Creates a new context using the given view with this context
   * as the parent.
   */
  Context.prototype.push = function push (view) {
    return new Context(view, this);
  };

  /**
   * Returns the value of the given name in this context, traversing
   * up the context hierarchy if the value is absent in this context's view.
   */
  Context.prototype.lookup = function lookup (name) {
    var cache = this.cache;

    var value;
    if (cache.hasOwnProperty(name)) {
      value = cache[name];
    } else {
      var context = this, names, index, lookupHit = false;

      while (context) {
        if (name.indexOf('.') > 0) {
          value = context.view;
          names = name.split('.');
          index = 0;

          /**
           * Using the dot notion path in `name`, we descend through the
           * nested objects.
           *
           * To be certain that the lookup has been successful, we have to
           * check if the last object in the path actually has the property
           * we are looking for. We store the result in `lookupHit`.
           *
           * This is specially necessary for when the value has been set to
           * `undefined` and we want to avoid looking up parent contexts.
           **/
          while (value != null && index < names.length) {
            if (index === names.length - 1)
              lookupHit = hasProperty(value, names[index]);

            value = value[names[index++]];
          }
        } else {
          value = context.view[name];
          lookupHit = hasProperty(context.view, name);
        }

        if (lookupHit)
          break;

        context = context.parent;
      }

      cache[name] = value;
    }

    if (isFunction(value))
      value = value.call(this.view);

    return value;
  };

  /**
   * A Writer knows how to take a stream of tokens and render them to a
   * string, given a context. It also maintains a cache of templates to
   * avoid the need to parse the same template twice.
   */
  function Writer () {
    this.cache = {};
  }

  /**
   * Clears all cached templates in this writer.
   */
  Writer.prototype.clearCache = function clearCache () {
    this.cache = {};
  };

  /**
   * Parses and caches the given `template` and returns the array of tokens
   * that is generated from the parse.
   */
  Writer.prototype.parse = function parse (template, tags) {
    var cache = this.cache;
    var tokens = cache[template];

    if (tokens == null)
      tokens = cache[template] = parseTemplate(template, tags);

    return tokens;
  };

  /**
   * High-level method that is used to render the given `template` with
   * the given `view`.
   *
   * The optional `partials` argument may be an object that contains the
   * names and templates of partials that are used in the template. It may
   * also be a function that is used to load partial templates on the fly
   * that takes a single argument: the name of the partial.
   */
  Writer.prototype.render = function render (template, view, partials) {
    var tokens = this.parse(template);
    var context = (view instanceof Context) ? view : new Context(view);
    return this.renderTokens(tokens, context, partials, template);
  };

  /**
   * Low-level method that renders the given array of `tokens` using
   * the given `context` and `partials`.
   *
   * Note: The `originalTemplate` is only ever used to extract the portion
   * of the original template that was contained in a higher-order section.
   * If the template doesn't use higher-order sections, this argument may
   * be omitted.
   */
  Writer.prototype.renderTokens = function renderTokens (tokens, context, partials, originalTemplate) {
    var buffer = '';

    var token, symbol, value;
    for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {
      value = undefined;
      token = tokens[i];
      symbol = token[0];

      if (symbol === '#') value = this.renderSection(token, context, partials, originalTemplate);
      else if (symbol === '^') value = this.renderInverted(token, context, partials, originalTemplate);
      else if (symbol === '>') value = this.renderPartial(token, context, partials, originalTemplate);
      else if (symbol === '&') value = this.unescapedValue(token, context);
      else if (symbol === 'name') value = this.escapedValue(token, context);
      else if (symbol === 'text') value = this.rawValue(token);

      if (value !== undefined)
        buffer += value;
    }

    return buffer;
  };

  Writer.prototype.renderSection = function renderSection (token, context, partials, originalTemplate) {
    var self = this;
    var buffer = '';
    var value = context.lookup(token[1]);

    // This function is used to render an arbitrary template
    // in the current context by higher-order sections.
    function subRender (template) {
      return self.render(template, context, partials);
    }

    if (!value) return;

    if (isArray(value)) {
      for (var j = 0, valueLength = value.length; j < valueLength; ++j) {
        buffer += this.renderTokens(token[4], context.push(value[j]), partials, originalTemplate);
      }
    } else if (typeof value === 'object' || typeof value === 'string' || typeof value === 'number') {
      buffer += this.renderTokens(token[4], context.push(value), partials, originalTemplate);
    } else if (isFunction(value)) {
      if (typeof originalTemplate !== 'string')
        throw new Error('Cannot use higher-order sections without the original template');

      // Extract the portion of the original template that the section contains.
      value = value.call(context.view, originalTemplate.slice(token[3], token[5]), subRender);

      if (value != null)
        buffer += value;
    } else {
      buffer += this.renderTokens(token[4], context, partials, originalTemplate);
    }
    return buffer;
  };

  Writer.prototype.renderInverted = function renderInverted (token, context, partials, originalTemplate) {
    var value = context.lookup(token[1]);

    // Use JavaScript's definition of falsy. Include empty arrays.
    // See https://github.com/janl/mustache.js/issues/186
    if (!value || (isArray(value) && value.length === 0))
      return this.renderTokens(token[4], context, partials, originalTemplate);
  };

  Writer.prototype.renderPartial = function renderPartial (token, context, partials) {
    if (!partials) return;

    var value = isFunction(partials) ? partials(token[1]) : partials[token[1]];
    if (value != null)
      return this.renderTokens(this.parse(value), context, partials, value);
  };

  Writer.prototype.unescapedValue = function unescapedValue (token, context) {
    var value = context.lookup(token[1]);
    if (value != null)
      return value;
  };

  Writer.prototype.escapedValue = function escapedValue (token, context) {
    var value = context.lookup(token[1]);
    if (value != null)
      return mustache.escape(value);
  };

  Writer.prototype.rawValue = function rawValue (token) {
    return token[1];
  };

  mustache.name = 'mustache.js';
  mustache.version = '2.2.1';
  mustache.tags = [ '{{', '}}' ];

  // All high-level mustache.* functions use this writer.
  var defaultWriter = new Writer();

  /**
   * Clears all cached templates in the default writer.
   */
  mustache.clearCache = function clearCache () {
    return defaultWriter.clearCache();
  };

  /**
   * Parses and caches the given template in the default writer and returns the
   * array of tokens it contains. Doing this ahead of time avoids the need to
   * parse templates on the fly as they are rendered.
   */
  mustache.parse = function parse (template, tags) {
    return defaultWriter.parse(template, tags);
  };

  /**
   * Renders the `template` with the given `view` and `partials` using the
   * default writer.
   */
  mustache.render = function render (template, view, partials) {
    if (typeof template !== 'string') {
      throw new TypeError('Invalid template! Template should be a "string" ' +
                          'but "' + typeStr(template) + '" was given as the first ' +
                          'argument for mustache#render(template, view, partials)');
    }

    return defaultWriter.render(template, view, partials);
  };

  // This is here for backwards compatibility with 0.4.x.,
  /*eslint-disable */ // eslint wants camel cased function name
  mustache.to_html = function to_html (template, view, partials, send) {
    /*eslint-enable*/

    var result = mustache.render(template, view, partials);

    if (isFunction(send)) {
      send(result);
    } else {
      return result;
    }
  };

  // Export the escaping function so that the user may override it.
  // See https://github.com/janl/mustache.js/issues/244
  mustache.escape = escapeHtml;

  // Export these mainly for testing, but also for advanced usage.
  mustache.Scanner = Scanner;
  mustache.Context = Context;
  mustache.Writer = Writer;

}));

},{}],5:[function(require,module,exports){
/*!
 * ZeroClipboard
 * The ZeroClipboard library provides an easy way to copy text to the clipboard using an invisible Adobe Flash movie and a JavaScript interface.
 * Copyright (c) 2009-2014 Jon Rohan, James M. Greene
 * Licensed MIT
 * http://zeroclipboard.org/
 * v2.2.0
 */
(function(window, undefined) {
  "use strict";
  /**
 * Store references to critically important global functions that may be
 * overridden on certain web pages.
 */
  var _window = window, _document = _window.document, _navigator = _window.navigator, _setTimeout = _window.setTimeout, _clearTimeout = _window.clearTimeout, _setInterval = _window.setInterval, _clearInterval = _window.clearInterval, _getComputedStyle = _window.getComputedStyle, _encodeURIComponent = _window.encodeURIComponent, _ActiveXObject = _window.ActiveXObject, _Error = _window.Error, _parseInt = _window.Number.parseInt || _window.parseInt, _parseFloat = _window.Number.parseFloat || _window.parseFloat, _isNaN = _window.Number.isNaN || _window.isNaN, _now = _window.Date.now, _keys = _window.Object.keys, _defineProperty = _window.Object.defineProperty, _hasOwn = _window.Object.prototype.hasOwnProperty, _slice = _window.Array.prototype.slice, _unwrap = function() {
    var unwrapper = function(el) {
      return el;
    };
    if (typeof _window.wrap === "function" && typeof _window.unwrap === "function") {
      try {
        var div = _document.createElement("div");
        var unwrappedDiv = _window.unwrap(div);
        if (div.nodeType === 1 && unwrappedDiv && unwrappedDiv.nodeType === 1) {
          unwrapper = _window.unwrap;
        }
      } catch (e) {}
    }
    return unwrapper;
  }();
  /**
 * Convert an `arguments` object into an Array.
 *
 * @returns The arguments as an Array
 * @private
 */
  var _args = function(argumentsObj) {
    return _slice.call(argumentsObj, 0);
  };
  /**
 * Shallow-copy the owned, enumerable properties of one object over to another, similar to jQuery's `$.extend`.
 *
 * @returns The target object, augmented
 * @private
 */
  var _extend = function() {
    var i, len, arg, prop, src, copy, args = _args(arguments), target = args[0] || {};
    for (i = 1, len = args.length; i < len; i++) {
      if ((arg = args[i]) != null) {
        for (prop in arg) {
          if (_hasOwn.call(arg, prop)) {
            src = target[prop];
            copy = arg[prop];
            if (target !== copy && copy !== undefined) {
              target[prop] = copy;
            }
          }
        }
      }
    }
    return target;
  };
  /**
 * Return a deep copy of the source object or array.
 *
 * @returns Object or Array
 * @private
 */
  var _deepCopy = function(source) {
    var copy, i, len, prop;
    if (typeof source !== "object" || source == null || typeof source.nodeType === "number") {
      copy = source;
    } else if (typeof source.length === "number") {
      copy = [];
      for (i = 0, len = source.length; i < len; i++) {
        if (_hasOwn.call(source, i)) {
          copy[i] = _deepCopy(source[i]);
        }
      }
    } else {
      copy = {};
      for (prop in source) {
        if (_hasOwn.call(source, prop)) {
          copy[prop] = _deepCopy(source[prop]);
        }
      }
    }
    return copy;
  };
  /**
 * Makes a shallow copy of `obj` (like `_extend`) but filters its properties based on a list of `keys` to keep.
 * The inverse of `_omit`, mostly. The big difference is that these properties do NOT need to be enumerable to
 * be kept.
 *
 * @returns A new filtered object.
 * @private
 */
  var _pick = function(obj, keys) {
    var newObj = {};
    for (var i = 0, len = keys.length; i < len; i++) {
      if (keys[i] in obj) {
        newObj[keys[i]] = obj[keys[i]];
      }
    }
    return newObj;
  };
  /**
 * Makes a shallow copy of `obj` (like `_extend`) but filters its properties based on a list of `keys` to omit.
 * The inverse of `_pick`.
 *
 * @returns A new filtered object.
 * @private
 */
  var _omit = function(obj, keys) {
    var newObj = {};
    for (var prop in obj) {
      if (keys.indexOf(prop) === -1) {
        newObj[prop] = obj[prop];
      }
    }
    return newObj;
  };
  /**
 * Remove all owned, enumerable properties from an object.
 *
 * @returns The original object without its owned, enumerable properties.
 * @private
 */
  var _deleteOwnProperties = function(obj) {
    if (obj) {
      for (var prop in obj) {
        if (_hasOwn.call(obj, prop)) {
          delete obj[prop];
        }
      }
    }
    return obj;
  };
  /**
 * Determine if an element is contained within another element.
 *
 * @returns Boolean
 * @private
 */
  var _containedBy = function(el, ancestorEl) {
    if (el && el.nodeType === 1 && el.ownerDocument && ancestorEl && (ancestorEl.nodeType === 1 && ancestorEl.ownerDocument && ancestorEl.ownerDocument === el.ownerDocument || ancestorEl.nodeType === 9 && !ancestorEl.ownerDocument && ancestorEl === el.ownerDocument)) {
      do {
        if (el === ancestorEl) {
          return true;
        }
        el = el.parentNode;
      } while (el);
    }
    return false;
  };
  /**
 * Get the URL path's parent directory.
 *
 * @returns String or `undefined`
 * @private
 */
  var _getDirPathOfUrl = function(url) {
    var dir;
    if (typeof url === "string" && url) {
      dir = url.split("#")[0].split("?")[0];
      dir = url.slice(0, url.lastIndexOf("/") + 1);
    }
    return dir;
  };
  /**
 * Get the current script's URL by throwing an `Error` and analyzing it.
 *
 * @returns String or `undefined`
 * @private
 */
  var _getCurrentScriptUrlFromErrorStack = function(stack) {
    var url, matches;
    if (typeof stack === "string" && stack) {
      matches = stack.match(/^(?:|[^:@]*@|.+\)@(?=http[s]?|file)|.+?\s+(?: at |@)(?:[^:\(]+ )*[\(]?)((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/);
      if (matches && matches[1]) {
        url = matches[1];
      } else {
        matches = stack.match(/\)@((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/);
        if (matches && matches[1]) {
          url = matches[1];
        }
      }
    }
    return url;
  };
  /**
 * Get the current script's URL by throwing an `Error` and analyzing it.
 *
 * @returns String or `undefined`
 * @private
 */
  var _getCurrentScriptUrlFromError = function() {
    var url, err;
    try {
      throw new _Error();
    } catch (e) {
      err = e;
    }
    if (err) {
      url = err.sourceURL || err.fileName || _getCurrentScriptUrlFromErrorStack(err.stack);
    }
    return url;
  };
  /**
 * Get the current script's URL.
 *
 * @returns String or `undefined`
 * @private
 */
  var _getCurrentScriptUrl = function() {
    var jsPath, scripts, i;
    if (_document.currentScript && (jsPath = _document.currentScript.src)) {
      return jsPath;
    }
    scripts = _document.getElementsByTagName("script");
    if (scripts.length === 1) {
      return scripts[0].src || undefined;
    }
    if ("readyState" in scripts[0]) {
      for (i = scripts.length; i--; ) {
        if (scripts[i].readyState === "interactive" && (jsPath = scripts[i].src)) {
          return jsPath;
        }
      }
    }
    if (_document.readyState === "loading" && (jsPath = scripts[scripts.length - 1].src)) {
      return jsPath;
    }
    if (jsPath = _getCurrentScriptUrlFromError()) {
      return jsPath;
    }
    return undefined;
  };
  /**
 * Get the unanimous parent directory of ALL script tags.
 * If any script tags are either (a) inline or (b) from differing parent
 * directories, this method must return `undefined`.
 *
 * @returns String or `undefined`
 * @private
 */
  var _getUnanimousScriptParentDir = function() {
    var i, jsDir, jsPath, scripts = _document.getElementsByTagName("script");
    for (i = scripts.length; i--; ) {
      if (!(jsPath = scripts[i].src)) {
        jsDir = null;
        break;
      }
      jsPath = _getDirPathOfUrl(jsPath);
      if (jsDir == null) {
        jsDir = jsPath;
      } else if (jsDir !== jsPath) {
        jsDir = null;
        break;
      }
    }
    return jsDir || undefined;
  };
  /**
 * Get the presumed location of the "ZeroClipboard.swf" file, based on the location
 * of the executing JavaScript file (e.g. "ZeroClipboard.js", etc.).
 *
 * @returns String
 * @private
 */
  var _getDefaultSwfPath = function() {
    var jsDir = _getDirPathOfUrl(_getCurrentScriptUrl()) || _getUnanimousScriptParentDir() || "";
    return jsDir + "ZeroClipboard.swf";
  };
  /**
 * Keep track of if the page is framed (in an `iframe`). This can never change.
 * @private
 */
  var _pageIsFramed = function() {
    return window.opener == null && (!!window.top && window != window.top || !!window.parent && window != window.parent);
  }();
  /**
 * Keep track of the state of the Flash object.
 * @private
 */
  var _flashState = {
    bridge: null,
    version: "0.0.0",
    pluginType: "unknown",
    disabled: null,
    outdated: null,
    sandboxed: null,
    unavailable: null,
    degraded: null,
    deactivated: null,
    overdue: null,
    ready: null
  };
  /**
 * The minimum Flash Player version required to use ZeroClipboard completely.
 * @readonly
 * @private
 */
  var _minimumFlashVersion = "11.0.0";
  /**
 * The ZeroClipboard library version number, as reported by Flash, at the time the SWF was compiled.
 */
  var _zcSwfVersion;
  /**
 * Keep track of all event listener registrations.
 * @private
 */
  var _handlers = {};
  /**
 * Keep track of the currently activated element.
 * @private
 */
  var _currentElement;
  /**
 * Keep track of the element that was activated when a `copy` process started.
 * @private
 */
  var _copyTarget;
  /**
 * Keep track of data for the pending clipboard transaction.
 * @private
 */
  var _clipData = {};
  /**
 * Keep track of data formats for the pending clipboard transaction.
 * @private
 */
  var _clipDataFormatMap = null;
  /**
 * Keep track of the Flash availability check timeout.
 * @private
 */
  var _flashCheckTimeout = 0;
  /**
 * Keep track of SWF network errors interval polling.
 * @private
 */
  var _swfFallbackCheckInterval = 0;
  /**
 * The `message` store for events
 * @private
 */
  var _eventMessages = {
    ready: "Flash communication is established",
    error: {
      "flash-disabled": "Flash is disabled or not installed. May also be attempting to run Flash in a sandboxed iframe, which is impossible.",
      "flash-outdated": "Flash is too outdated to support ZeroClipboard",
      "flash-sandboxed": "Attempting to run Flash in a sandboxed iframe, which is impossible",
      "flash-unavailable": "Flash is unable to communicate bidirectionally with JavaScript",
      "flash-degraded": "Flash is unable to preserve data fidelity when communicating with JavaScript",
      "flash-deactivated": "Flash is too outdated for your browser and/or is configured as click-to-activate.\nThis may also mean that the ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity.\nMay also be attempting to run Flash in a sandboxed iframe, which is impossible.",
      "flash-overdue": "Flash communication was established but NOT within the acceptable time limit",
      "version-mismatch": "ZeroClipboard JS version number does not match ZeroClipboard SWF version number",
      "clipboard-error": "At least one error was thrown while ZeroClipboard was attempting to inject your data into the clipboard",
      "config-mismatch": "ZeroClipboard configuration does not match Flash's reality",
      "swf-not-found": "The ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity"
    }
  };
  /**
 * The `name`s of `error` events that can only occur is Flash has at least
 * been able to load the SWF successfully.
 * @private
 */
  var _errorsThatOnlyOccurAfterFlashLoads = [ "flash-unavailable", "flash-degraded", "flash-overdue", "version-mismatch", "config-mismatch", "clipboard-error" ];
  /**
 * The `name`s of `error` events that should likely result in the `_flashState`
 * variable's property values being updated.
 * @private
 */
  var _flashStateErrorNames = [ "flash-disabled", "flash-outdated", "flash-sandboxed", "flash-unavailable", "flash-degraded", "flash-deactivated", "flash-overdue" ];
  /**
 * A RegExp to match the `name` property of `error` events related to Flash.
 * @private
 */
  var _flashStateErrorNameMatchingRegex = new RegExp("^flash-(" + _flashStateErrorNames.map(function(errorName) {
    return errorName.replace(/^flash-/, "");
  }).join("|") + ")$");
  /**
 * A RegExp to match the `name` property of `error` events related to Flash,
 * which is enabled.
 * @private
 */
  var _flashStateEnabledErrorNameMatchingRegex = new RegExp("^flash-(" + _flashStateErrorNames.slice(1).map(function(errorName) {
    return errorName.replace(/^flash-/, "");
  }).join("|") + ")$");
  /**
 * ZeroClipboard configuration defaults for the Core module.
 * @private
 */
  var _globalConfig = {
    swfPath: _getDefaultSwfPath(),
    trustedDomains: window.location.host ? [ window.location.host ] : [],
    cacheBust: true,
    forceEnhancedClipboard: false,
    flashLoadTimeout: 3e4,
    autoActivate: true,
    bubbleEvents: true,
    containerId: "global-zeroclipboard-html-bridge",
    containerClass: "global-zeroclipboard-container",
    swfObjectId: "global-zeroclipboard-flash-bridge",
    hoverClass: "zeroclipboard-is-hover",
    activeClass: "zeroclipboard-is-active",
    forceHandCursor: false,
    title: null,
    zIndex: 999999999
  };
  /**
 * The underlying implementation of `ZeroClipboard.config`.
 * @private
 */
  var _config = function(options) {
    if (typeof options === "object" && options !== null) {
      for (var prop in options) {
        if (_hasOwn.call(options, prop)) {
          if (/^(?:forceHandCursor|title|zIndex|bubbleEvents)$/.test(prop)) {
            _globalConfig[prop] = options[prop];
          } else if (_flashState.bridge == null) {
            if (prop === "containerId" || prop === "swfObjectId") {
              if (_isValidHtml4Id(options[prop])) {
                _globalConfig[prop] = options[prop];
              } else {
                throw new Error("The specified `" + prop + "` value is not valid as an HTML4 Element ID");
              }
            } else {
              _globalConfig[prop] = options[prop];
            }
          }
        }
      }
    }
    if (typeof options === "string" && options) {
      if (_hasOwn.call(_globalConfig, options)) {
        return _globalConfig[options];
      }
      return;
    }
    return _deepCopy(_globalConfig);
  };
  /**
 * The underlying implementation of `ZeroClipboard.state`.
 * @private
 */
  var _state = function() {
    _detectSandbox();
    return {
      browser: _pick(_navigator, [ "userAgent", "platform", "appName" ]),
      flash: _omit(_flashState, [ "bridge" ]),
      zeroclipboard: {
        version: ZeroClipboard.version,
        config: ZeroClipboard.config()
      }
    };
  };
  /**
 * The underlying implementation of `ZeroClipboard.isFlashUnusable`.
 * @private
 */
  var _isFlashUnusable = function() {
    return !!(_flashState.disabled || _flashState.outdated || _flashState.sandboxed || _flashState.unavailable || _flashState.degraded || _flashState.deactivated);
  };
  /**
 * The underlying implementation of `ZeroClipboard.on`.
 * @private
 */
  var _on = function(eventType, listener) {
    var i, len, events, added = {};
    if (typeof eventType === "string" && eventType) {
      events = eventType.toLowerCase().split(/\s+/);
    } else if (typeof eventType === "object" && eventType && typeof listener === "undefined") {
      for (i in eventType) {
        if (_hasOwn.call(eventType, i) && typeof i === "string" && i && typeof eventType[i] === "function") {
          ZeroClipboard.on(i, eventType[i]);
        }
      }
    }
    if (events && events.length) {
      for (i = 0, len = events.length; i < len; i++) {
        eventType = events[i].replace(/^on/, "");
        added[eventType] = true;
        if (!_handlers[eventType]) {
          _handlers[eventType] = [];
        }
        _handlers[eventType].push(listener);
      }
      if (added.ready && _flashState.ready) {
        ZeroClipboard.emit({
          type: "ready"
        });
      }
      if (added.error) {
        for (i = 0, len = _flashStateErrorNames.length; i < len; i++) {
          if (_flashState[_flashStateErrorNames[i].replace(/^flash-/, "")] === true) {
            ZeroClipboard.emit({
              type: "error",
              name: _flashStateErrorNames[i]
            });
            break;
          }
        }
        if (_zcSwfVersion !== undefined && ZeroClipboard.version !== _zcSwfVersion) {
          ZeroClipboard.emit({
            type: "error",
            name: "version-mismatch",
            jsVersion: ZeroClipboard.version,
            swfVersion: _zcSwfVersion
          });
        }
      }
    }
    return ZeroClipboard;
  };
  /**
 * The underlying implementation of `ZeroClipboard.off`.
 * @private
 */
  var _off = function(eventType, listener) {
    var i, len, foundIndex, events, perEventHandlers;
    if (arguments.length === 0) {
      events = _keys(_handlers);
    } else if (typeof eventType === "string" && eventType) {
      events = eventType.split(/\s+/);
    } else if (typeof eventType === "object" && eventType && typeof listener === "undefined") {
      for (i in eventType) {
        if (_hasOwn.call(eventType, i) && typeof i === "string" && i && typeof eventType[i] === "function") {
          ZeroClipboard.off(i, eventType[i]);
        }
      }
    }
    if (events && events.length) {
      for (i = 0, len = events.length; i < len; i++) {
        eventType = events[i].toLowerCase().replace(/^on/, "");
        perEventHandlers = _handlers[eventType];
        if (perEventHandlers && perEventHandlers.length) {
          if (listener) {
            foundIndex = perEventHandlers.indexOf(listener);
            while (foundIndex !== -1) {
              perEventHandlers.splice(foundIndex, 1);
              foundIndex = perEventHandlers.indexOf(listener, foundIndex);
            }
          } else {
            perEventHandlers.length = 0;
          }
        }
      }
    }
    return ZeroClipboard;
  };
  /**
 * The underlying implementation of `ZeroClipboard.handlers`.
 * @private
 */
  var _listeners = function(eventType) {
    var copy;
    if (typeof eventType === "string" && eventType) {
      copy = _deepCopy(_handlers[eventType]) || null;
    } else {
      copy = _deepCopy(_handlers);
    }
    return copy;
  };
  /**
 * The underlying implementation of `ZeroClipboard.emit`.
 * @private
 */
  var _emit = function(event) {
    var eventCopy, returnVal, tmp;
    event = _createEvent(event);
    if (!event) {
      return;
    }
    if (_preprocessEvent(event)) {
      return;
    }
    if (event.type === "ready" && _flashState.overdue === true) {
      return ZeroClipboard.emit({
        type: "error",
        name: "flash-overdue"
      });
    }
    eventCopy = _extend({}, event);
    _dispatchCallbacks.call(this, eventCopy);
    if (event.type === "copy") {
      tmp = _mapClipDataToFlash(_clipData);
      returnVal = tmp.data;
      _clipDataFormatMap = tmp.formatMap;
    }
    return returnVal;
  };
  /**
 * The underlying implementation of `ZeroClipboard.create`.
 * @private
 */
  var _create = function() {
    var previousState = _flashState.sandboxed;
    _detectSandbox();
    if (typeof _flashState.ready !== "boolean") {
      _flashState.ready = false;
    }
    if (_flashState.sandboxed !== previousState && _flashState.sandboxed === true) {
      _flashState.ready = false;
      ZeroClipboard.emit({
        type: "error",
        name: "flash-sandboxed"
      });
    } else if (!ZeroClipboard.isFlashUnusable() && _flashState.bridge === null) {
      var maxWait = _globalConfig.flashLoadTimeout;
      if (typeof maxWait === "number" && maxWait >= 0) {
        _flashCheckTimeout = _setTimeout(function() {
          if (typeof _flashState.deactivated !== "boolean") {
            _flashState.deactivated = true;
          }
          if (_flashState.deactivated === true) {
            ZeroClipboard.emit({
              type: "error",
              name: "flash-deactivated"
            });
          }
        }, maxWait);
      }
      _flashState.overdue = false;
      _embedSwf();
    }
  };
  /**
 * The underlying implementation of `ZeroClipboard.destroy`.
 * @private
 */
  var _destroy = function() {
    ZeroClipboard.clearData();
    ZeroClipboard.blur();
    ZeroClipboard.emit("destroy");
    _unembedSwf();
    ZeroClipboard.off();
  };
  /**
 * The underlying implementation of `ZeroClipboard.setData`.
 * @private
 */
  var _setData = function(format, data) {
    var dataObj;
    if (typeof format === "object" && format && typeof data === "undefined") {
      dataObj = format;
      ZeroClipboard.clearData();
    } else if (typeof format === "string" && format) {
      dataObj = {};
      dataObj[format] = data;
    } else {
      return;
    }
    for (var dataFormat in dataObj) {
      if (typeof dataFormat === "string" && dataFormat && _hasOwn.call(dataObj, dataFormat) && typeof dataObj[dataFormat] === "string" && dataObj[dataFormat]) {
        _clipData[dataFormat] = dataObj[dataFormat];
      }
    }
  };
  /**
 * The underlying implementation of `ZeroClipboard.clearData`.
 * @private
 */
  var _clearData = function(format) {
    if (typeof format === "undefined") {
      _deleteOwnProperties(_clipData);
      _clipDataFormatMap = null;
    } else if (typeof format === "string" && _hasOwn.call(_clipData, format)) {
      delete _clipData[format];
    }
  };
  /**
 * The underlying implementation of `ZeroClipboard.getData`.
 * @private
 */
  var _getData = function(format) {
    if (typeof format === "undefined") {
      return _deepCopy(_clipData);
    } else if (typeof format === "string" && _hasOwn.call(_clipData, format)) {
      return _clipData[format];
    }
  };
  /**
 * The underlying implementation of `ZeroClipboard.focus`/`ZeroClipboard.activate`.
 * @private
 */
  var _focus = function(element) {
    if (!(element && element.nodeType === 1)) {
      return;
    }
    if (_currentElement) {
      _removeClass(_currentElement, _globalConfig.activeClass);
      if (_currentElement !== element) {
        _removeClass(_currentElement, _globalConfig.hoverClass);
      }
    }
    _currentElement = element;
    _addClass(element, _globalConfig.hoverClass);
    var newTitle = element.getAttribute("title") || _globalConfig.title;
    if (typeof newTitle === "string" && newTitle) {
      var htmlBridge = _getHtmlBridge(_flashState.bridge);
      if (htmlBridge) {
        htmlBridge.setAttribute("title", newTitle);
      }
    }
    var useHandCursor = _globalConfig.forceHandCursor === true || _getStyle(element, "cursor") === "pointer";
    _setHandCursor(useHandCursor);
    _reposition();
  };
  /**
 * The underlying implementation of `ZeroClipboard.blur`/`ZeroClipboard.deactivate`.
 * @private
 */
  var _blur = function() {
    var htmlBridge = _getHtmlBridge(_flashState.bridge);
    if (htmlBridge) {
      htmlBridge.removeAttribute("title");
      htmlBridge.style.left = "0px";
      htmlBridge.style.top = "-9999px";
      htmlBridge.style.width = "1px";
      htmlBridge.style.height = "1px";
    }
    if (_currentElement) {
      _removeClass(_currentElement, _globalConfig.hoverClass);
      _removeClass(_currentElement, _globalConfig.activeClass);
      _currentElement = null;
    }
  };
  /**
 * The underlying implementation of `ZeroClipboard.activeElement`.
 * @private
 */
  var _activeElement = function() {
    return _currentElement || null;
  };
  /**
 * Check if a value is a valid HTML4 `ID` or `Name` token.
 * @private
 */
  var _isValidHtml4Id = function(id) {
    return typeof id === "string" && id && /^[A-Za-z][A-Za-z0-9_:\-\.]*$/.test(id);
  };
  /**
 * Create or update an `event` object, based on the `eventType`.
 * @private
 */
  var _createEvent = function(event) {
    var eventType;
    if (typeof event === "string" && event) {
      eventType = event;
      event = {};
    } else if (typeof event === "object" && event && typeof event.type === "string" && event.type) {
      eventType = event.type;
    }
    if (!eventType) {
      return;
    }
    eventType = eventType.toLowerCase();
    if (!event.target && (/^(copy|aftercopy|_click)$/.test(eventType) || eventType === "error" && event.name === "clipboard-error")) {
      event.target = _copyTarget;
    }
    _extend(event, {
      type: eventType,
      target: event.target || _currentElement || null,
      relatedTarget: event.relatedTarget || null,
      currentTarget: _flashState && _flashState.bridge || null,
      timeStamp: event.timeStamp || _now() || null
    });
    var msg = _eventMessages[event.type];
    if (event.type === "error" && event.name && msg) {
      msg = msg[event.name];
    }
    if (msg) {
      event.message = msg;
    }
    if (event.type === "ready") {
      _extend(event, {
        target: null,
        version: _flashState.version
      });
    }
    if (event.type === "error") {
      if (_flashStateErrorNameMatchingRegex.test(event.name)) {
        _extend(event, {
          target: null,
          minimumVersion: _minimumFlashVersion
        });
      }
      if (_flashStateEnabledErrorNameMatchingRegex.test(event.name)) {
        _extend(event, {
          version: _flashState.version
        });
      }
    }
    if (event.type === "copy") {
      event.clipboardData = {
        setData: ZeroClipboard.setData,
        clearData: ZeroClipboard.clearData
      };
    }
    if (event.type === "aftercopy") {
      event = _mapClipResultsFromFlash(event, _clipDataFormatMap);
    }
    if (event.target && !event.relatedTarget) {
      event.relatedTarget = _getRelatedTarget(event.target);
    }
    return _addMouseData(event);
  };
  /**
 * Get a relatedTarget from the target's `data-clipboard-target` attribute
 * @private
 */
  var _getRelatedTarget = function(targetEl) {
    var relatedTargetId = targetEl && targetEl.getAttribute && targetEl.getAttribute("data-clipboard-target");
    return relatedTargetId ? _document.getElementById(relatedTargetId) : null;
  };
  /**
 * Add element and position data to `MouseEvent` instances
 * @private
 */
  var _addMouseData = function(event) {
    if (event && /^_(?:click|mouse(?:over|out|down|up|move))$/.test(event.type)) {
      var srcElement = event.target;
      var fromElement = event.type === "_mouseover" && event.relatedTarget ? event.relatedTarget : undefined;
      var toElement = event.type === "_mouseout" && event.relatedTarget ? event.relatedTarget : undefined;
      var pos = _getElementPosition(srcElement);
      var screenLeft = _window.screenLeft || _window.screenX || 0;
      var screenTop = _window.screenTop || _window.screenY || 0;
      var scrollLeft = _document.body.scrollLeft + _document.documentElement.scrollLeft;
      var scrollTop = _document.body.scrollTop + _document.documentElement.scrollTop;
      var pageX = pos.left + (typeof event._stageX === "number" ? event._stageX : 0);
      var pageY = pos.top + (typeof event._stageY === "number" ? event._stageY : 0);
      var clientX = pageX - scrollLeft;
      var clientY = pageY - scrollTop;
      var screenX = screenLeft + clientX;
      var screenY = screenTop + clientY;
      var moveX = typeof event.movementX === "number" ? event.movementX : 0;
      var moveY = typeof event.movementY === "number" ? event.movementY : 0;
      delete event._stageX;
      delete event._stageY;
      _extend(event, {
        srcElement: srcElement,
        fromElement: fromElement,
        toElement: toElement,
        screenX: screenX,
        screenY: screenY,
        pageX: pageX,
        pageY: pageY,
        clientX: clientX,
        clientY: clientY,
        x: clientX,
        y: clientY,
        movementX: moveX,
        movementY: moveY,
        offsetX: 0,
        offsetY: 0,
        layerX: 0,
        layerY: 0
      });
    }
    return event;
  };
  /**
 * Determine if an event's registered handlers should be execute synchronously or asynchronously.
 *
 * @returns {boolean}
 * @private
 */
  var _shouldPerformAsync = function(event) {
    var eventType = event && typeof event.type === "string" && event.type || "";
    return !/^(?:(?:before)?copy|destroy)$/.test(eventType);
  };
  /**
 * Control if a callback should be executed asynchronously or not.
 *
 * @returns `undefined`
 * @private
 */
  var _dispatchCallback = function(func, context, args, async) {
    if (async) {
      _setTimeout(function() {
        func.apply(context, args);
      }, 0);
    } else {
      func.apply(context, args);
    }
  };
  /**
 * Handle the actual dispatching of events to client instances.
 *
 * @returns `undefined`
 * @private
 */
  var _dispatchCallbacks = function(event) {
    if (!(typeof event === "object" && event && event.type)) {
      return;
    }
    var async = _shouldPerformAsync(event);
    var wildcardTypeHandlers = _handlers["*"] || [];
    var specificTypeHandlers = _handlers[event.type] || [];
    var handlers = wildcardTypeHandlers.concat(specificTypeHandlers);
    if (handlers && handlers.length) {
      var i, len, func, context, eventCopy, originalContext = this;
      for (i = 0, len = handlers.length; i < len; i++) {
        func = handlers[i];
        context = originalContext;
        if (typeof func === "string" && typeof _window[func] === "function") {
          func = _window[func];
        }
        if (typeof func === "object" && func && typeof func.handleEvent === "function") {
          context = func;
          func = func.handleEvent;
        }
        if (typeof func === "function") {
          eventCopy = _extend({}, event);
          _dispatchCallback(func, context, [ eventCopy ], async);
        }
      }
    }
    return this;
  };
  /**
 * Check an `error` event's `name` property to see if Flash has
 * already loaded, which rules out possible `iframe` sandboxing.
 * @private
 */
  var _getSandboxStatusFromErrorEvent = function(event) {
    var isSandboxed = null;
    if (_pageIsFramed === false || event && event.type === "error" && event.name && _errorsThatOnlyOccurAfterFlashLoads.indexOf(event.name) !== -1) {
      isSandboxed = false;
    }
    return isSandboxed;
  };
  /**
 * Preprocess any special behaviors, reactions, or state changes after receiving this event.
 * Executes only once per event emitted, NOT once per client.
 * @private
 */
  var _preprocessEvent = function(event) {
    var element = event.target || _currentElement || null;
    var sourceIsSwf = event._source === "swf";
    delete event._source;
    switch (event.type) {
     case "error":
      var isSandboxed = event.name === "flash-sandboxed" || _getSandboxStatusFromErrorEvent(event);
      if (typeof isSandboxed === "boolean") {
        _flashState.sandboxed = isSandboxed;
      }
      if (_flashStateErrorNames.indexOf(event.name) !== -1) {
        _extend(_flashState, {
          disabled: event.name === "flash-disabled",
          outdated: event.name === "flash-outdated",
          unavailable: event.name === "flash-unavailable",
          degraded: event.name === "flash-degraded",
          deactivated: event.name === "flash-deactivated",
          overdue: event.name === "flash-overdue",
          ready: false
        });
      } else if (event.name === "version-mismatch") {
        _zcSwfVersion = event.swfVersion;
        _extend(_flashState, {
          disabled: false,
          outdated: false,
          unavailable: false,
          degraded: false,
          deactivated: false,
          overdue: false,
          ready: false
        });
      }
      _clearTimeoutsAndPolling();
      break;

     case "ready":
      _zcSwfVersion = event.swfVersion;
      var wasDeactivated = _flashState.deactivated === true;
      _extend(_flashState, {
        disabled: false,
        outdated: false,
        sandboxed: false,
        unavailable: false,
        degraded: false,
        deactivated: false,
        overdue: wasDeactivated,
        ready: !wasDeactivated
      });
      _clearTimeoutsAndPolling();
      break;

     case "beforecopy":
      _copyTarget = element;
      break;

     case "copy":
      var textContent, htmlContent, targetEl = event.relatedTarget;
      if (!(_clipData["text/html"] || _clipData["text/plain"]) && targetEl && (htmlContent = targetEl.value || targetEl.outerHTML || targetEl.innerHTML) && (textContent = targetEl.value || targetEl.textContent || targetEl.innerText)) {
        event.clipboardData.clearData();
        event.clipboardData.setData("text/plain", textContent);
        if (htmlContent !== textContent) {
          event.clipboardData.setData("text/html", htmlContent);
        }
      } else if (!_clipData["text/plain"] && event.target && (textContent = event.target.getAttribute("data-clipboard-text"))) {
        event.clipboardData.clearData();
        event.clipboardData.setData("text/plain", textContent);
      }
      break;

     case "aftercopy":
      _queueEmitClipboardErrors(event);
      ZeroClipboard.clearData();
      if (element && element !== _safeActiveElement() && element.focus) {
        element.focus();
      }
      break;

     case "_mouseover":
      ZeroClipboard.focus(element);
      if (_globalConfig.bubbleEvents === true && sourceIsSwf) {
        if (element && element !== event.relatedTarget && !_containedBy(event.relatedTarget, element)) {
          _fireMouseEvent(_extend({}, event, {
            type: "mouseenter",
            bubbles: false,
            cancelable: false
          }));
        }
        _fireMouseEvent(_extend({}, event, {
          type: "mouseover"
        }));
      }
      break;

     case "_mouseout":
      ZeroClipboard.blur();
      if (_globalConfig.bubbleEvents === true && sourceIsSwf) {
        if (element && element !== event.relatedTarget && !_containedBy(event.relatedTarget, element)) {
          _fireMouseEvent(_extend({}, event, {
            type: "mouseleave",
            bubbles: false,
            cancelable: false
          }));
        }
        _fireMouseEvent(_extend({}, event, {
          type: "mouseout"
        }));
      }
      break;

     case "_mousedown":
      _addClass(element, _globalConfig.activeClass);
      if (_globalConfig.bubbleEvents === true && sourceIsSwf) {
        _fireMouseEvent(_extend({}, event, {
          type: event.type.slice(1)
        }));
      }
      break;

     case "_mouseup":
      _removeClass(element, _globalConfig.activeClass);
      if (_globalConfig.bubbleEvents === true && sourceIsSwf) {
        _fireMouseEvent(_extend({}, event, {
          type: event.type.slice(1)
        }));
      }
      break;

     case "_click":
      _copyTarget = null;
      if (_globalConfig.bubbleEvents === true && sourceIsSwf) {
        _fireMouseEvent(_extend({}, event, {
          type: event.type.slice(1)
        }));
      }
      break;

     case "_mousemove":
      if (_globalConfig.bubbleEvents === true && sourceIsSwf) {
        _fireMouseEvent(_extend({}, event, {
          type: event.type.slice(1)
        }));
      }
      break;
    }
    if (/^_(?:click|mouse(?:over|out|down|up|move))$/.test(event.type)) {
      return true;
    }
  };
  /**
 * Check an "aftercopy" event for clipboard errors and emit a corresponding "error" event.
 * @private
 */
  var _queueEmitClipboardErrors = function(aftercopyEvent) {
    if (aftercopyEvent.errors && aftercopyEvent.errors.length > 0) {
      var errorEvent = _deepCopy(aftercopyEvent);
      _extend(errorEvent, {
        type: "error",
        name: "clipboard-error"
      });
      delete errorEvent.success;
      _setTimeout(function() {
        ZeroClipboard.emit(errorEvent);
      }, 0);
    }
  };
  /**
 * Dispatch a synthetic MouseEvent.
 *
 * @returns `undefined`
 * @private
 */
  var _fireMouseEvent = function(event) {
    if (!(event && typeof event.type === "string" && event)) {
      return;
    }
    var e, target = event.target || null, doc = target && target.ownerDocument || _document, defaults = {
      view: doc.defaultView || _window,
      canBubble: true,
      cancelable: true,
      detail: event.type === "click" ? 1 : 0,
      button: typeof event.which === "number" ? event.which - 1 : typeof event.button === "number" ? event.button : doc.createEvent ? 0 : 1
    }, args = _extend(defaults, event);
    if (!target) {
      return;
    }
    if (doc.createEvent && target.dispatchEvent) {
      args = [ args.type, args.canBubble, args.cancelable, args.view, args.detail, args.screenX, args.screenY, args.clientX, args.clientY, args.ctrlKey, args.altKey, args.shiftKey, args.metaKey, args.button, args.relatedTarget ];
      e = doc.createEvent("MouseEvents");
      if (e.initMouseEvent) {
        e.initMouseEvent.apply(e, args);
        e._source = "js";
        target.dispatchEvent(e);
      }
    }
  };
  /**
 * Continuously poll the DOM until either:
 *  (a) the fallback content becomes visible, or
 *  (b) we receive an event from SWF (handled elsewhere)
 *
 * IMPORTANT:
 * This is NOT a necessary check but it can result in significantly faster
 * detection of bad `swfPath` configuration and/or network/server issues [in
 * supported browsers] than waiting for the entire `flashLoadTimeout` duration
 * to elapse before detecting that the SWF cannot be loaded. The detection
 * duration can be anywhere from 10-30 times faster [in supported browsers] by
 * using this approach.
 *
 * @returns `undefined`
 * @private
 */
  var _watchForSwfFallbackContent = function() {
    var maxWait = _globalConfig.flashLoadTimeout;
    if (typeof maxWait === "number" && maxWait >= 0) {
      var pollWait = Math.min(1e3, maxWait / 10);
      var fallbackContentId = _globalConfig.swfObjectId + "_fallbackContent";
      _swfFallbackCheckInterval = _setInterval(function() {
        var el = _document.getElementById(fallbackContentId);
        if (_isElementVisible(el)) {
          _clearTimeoutsAndPolling();
          _flashState.deactivated = null;
          ZeroClipboard.emit({
            type: "error",
            name: "swf-not-found"
          });
        }
      }, pollWait);
    }
  };
  /**
 * Create the HTML bridge element to embed the Flash object into.
 * @private
 */
  var _createHtmlBridge = function() {
    var container = _document.createElement("div");
    container.id = _globalConfig.containerId;
    container.className = _globalConfig.containerClass;
    container.style.position = "absolute";
    container.style.left = "0px";
    container.style.top = "-9999px";
    container.style.width = "1px";
    container.style.height = "1px";
    container.style.zIndex = "" + _getSafeZIndex(_globalConfig.zIndex);
    return container;
  };
  /**
 * Get the HTML element container that wraps the Flash bridge object/element.
 * @private
 */
  var _getHtmlBridge = function(flashBridge) {
    var htmlBridge = flashBridge && flashBridge.parentNode;
    while (htmlBridge && htmlBridge.nodeName === "OBJECT" && htmlBridge.parentNode) {
      htmlBridge = htmlBridge.parentNode;
    }
    return htmlBridge || null;
  };
  /**
 * Create the SWF object.
 *
 * @returns The SWF object reference.
 * @private
 */
  var _embedSwf = function() {
    var len, flashBridge = _flashState.bridge, container = _getHtmlBridge(flashBridge);
    if (!flashBridge) {
      var allowScriptAccess = _determineScriptAccess(_window.location.host, _globalConfig);
      var allowNetworking = allowScriptAccess === "never" ? "none" : "all";
      var flashvars = _vars(_extend({
        jsVersion: ZeroClipboard.version
      }, _globalConfig));
      var swfUrl = _globalConfig.swfPath + _cacheBust(_globalConfig.swfPath, _globalConfig);
      container = _createHtmlBridge();
      var divToBeReplaced = _document.createElement("div");
      container.appendChild(divToBeReplaced);
      _document.body.appendChild(container);
      var tmpDiv = _document.createElement("div");
      var usingActiveX = _flashState.pluginType === "activex";
      tmpDiv.innerHTML = '<object id="' + _globalConfig.swfObjectId + '" name="' + _globalConfig.swfObjectId + '" ' + 'width="100%" height="100%" ' + (usingActiveX ? 'classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"' : 'type="application/x-shockwave-flash" data="' + swfUrl + '"') + ">" + (usingActiveX ? '<param name="movie" value="' + swfUrl + '"/>' : "") + '<param name="allowScriptAccess" value="' + allowScriptAccess + '"/>' + '<param name="allowNetworking" value="' + allowNetworking + '"/>' + '<param name="menu" value="false"/>' + '<param name="wmode" value="transparent"/>' + '<param name="flashvars" value="' + flashvars + '"/>' + '<div id="' + _globalConfig.swfObjectId + '_fallbackContent">&nbsp;</div>' + "</object>";
      flashBridge = tmpDiv.firstChild;
      tmpDiv = null;
      _unwrap(flashBridge).ZeroClipboard = ZeroClipboard;
      container.replaceChild(flashBridge, divToBeReplaced);
      _watchForSwfFallbackContent();
    }
    if (!flashBridge) {
      flashBridge = _document[_globalConfig.swfObjectId];
      if (flashBridge && (len = flashBridge.length)) {
        flashBridge = flashBridge[len - 1];
      }
      if (!flashBridge && container) {
        flashBridge = container.firstChild;
      }
    }
    _flashState.bridge = flashBridge || null;
    return flashBridge;
  };
  /**
 * Destroy the SWF object.
 * @private
 */
  var _unembedSwf = function() {
    var flashBridge = _flashState.bridge;
    if (flashBridge) {
      var htmlBridge = _getHtmlBridge(flashBridge);
      if (htmlBridge) {
        if (_flashState.pluginType === "activex" && "readyState" in flashBridge) {
          flashBridge.style.display = "none";
          (function removeSwfFromIE() {
            if (flashBridge.readyState === 4) {
              for (var prop in flashBridge) {
                if (typeof flashBridge[prop] === "function") {
                  flashBridge[prop] = null;
                }
              }
              if (flashBridge.parentNode) {
                flashBridge.parentNode.removeChild(flashBridge);
              }
              if (htmlBridge.parentNode) {
                htmlBridge.parentNode.removeChild(htmlBridge);
              }
            } else {
              _setTimeout(removeSwfFromIE, 10);
            }
          })();
        } else {
          if (flashBridge.parentNode) {
            flashBridge.parentNode.removeChild(flashBridge);
          }
          if (htmlBridge.parentNode) {
            htmlBridge.parentNode.removeChild(htmlBridge);
          }
        }
      }
      _clearTimeoutsAndPolling();
      _flashState.ready = null;
      _flashState.bridge = null;
      _flashState.deactivated = null;
      _zcSwfVersion = undefined;
    }
  };
  /**
 * Map the data format names of the "clipData" to Flash-friendly names.
 *
 * @returns A new transformed object.
 * @private
 */
  var _mapClipDataToFlash = function(clipData) {
    var newClipData = {}, formatMap = {};
    if (!(typeof clipData === "object" && clipData)) {
      return;
    }
    for (var dataFormat in clipData) {
      if (dataFormat && _hasOwn.call(clipData, dataFormat) && typeof clipData[dataFormat] === "string" && clipData[dataFormat]) {
        switch (dataFormat.toLowerCase()) {
         case "text/plain":
         case "text":
         case "air:text":
         case "flash:text":
          newClipData.text = clipData[dataFormat];
          formatMap.text = dataFormat;
          break;

         case "text/html":
         case "html":
         case "air:html":
         case "flash:html":
          newClipData.html = clipData[dataFormat];
          formatMap.html = dataFormat;
          break;

         case "application/rtf":
         case "text/rtf":
         case "rtf":
         case "richtext":
         case "air:rtf":
         case "flash:rtf":
          newClipData.rtf = clipData[dataFormat];
          formatMap.rtf = dataFormat;
          break;

         default:
          break;
        }
      }
    }
    return {
      data: newClipData,
      formatMap: formatMap
    };
  };
  /**
 * Map the data format names from Flash-friendly names back to their original "clipData" names (via a format mapping).
 *
 * @returns A new transformed object.
 * @private
 */
  var _mapClipResultsFromFlash = function(clipResults, formatMap) {
    if (!(typeof clipResults === "object" && clipResults && typeof formatMap === "object" && formatMap)) {
      return clipResults;
    }
    var newResults = {};
    for (var prop in clipResults) {
      if (_hasOwn.call(clipResults, prop)) {
        if (prop === "errors") {
          newResults[prop] = clipResults[prop] ? clipResults[prop].slice() : [];
          for (var i = 0, len = newResults[prop].length; i < len; i++) {
            newResults[prop][i].format = formatMap[newResults[prop][i].format];
          }
        } else if (prop !== "success" && prop !== "data") {
          newResults[prop] = clipResults[prop];
        } else {
          newResults[prop] = {};
          var tmpHash = clipResults[prop];
          for (var dataFormat in tmpHash) {
            if (dataFormat && _hasOwn.call(tmpHash, dataFormat) && _hasOwn.call(formatMap, dataFormat)) {
              newResults[prop][formatMap[dataFormat]] = tmpHash[dataFormat];
            }
          }
        }
      }
    }
    return newResults;
  };
  /**
 * Will look at a path, and will create a "?noCache={time}" or "&noCache={time}"
 * query param string to return. Does NOT append that string to the original path.
 * This is useful because ExternalInterface often breaks when a Flash SWF is cached.
 *
 * @returns The `noCache` query param with necessary "?"/"&" prefix.
 * @private
 */
  var _cacheBust = function(path, options) {
    var cacheBust = options == null || options && options.cacheBust === true;
    if (cacheBust) {
      return (path.indexOf("?") === -1 ? "?" : "&") + "noCache=" + _now();
    } else {
      return "";
    }
  };
  /**
 * Creates a query string for the FlashVars param.
 * Does NOT include the cache-busting query param.
 *
 * @returns FlashVars query string
 * @private
 */
  var _vars = function(options) {
    var i, len, domain, domains, str = "", trustedOriginsExpanded = [];
    if (options.trustedDomains) {
      if (typeof options.trustedDomains === "string") {
        domains = [ options.trustedDomains ];
      } else if (typeof options.trustedDomains === "object" && "length" in options.trustedDomains) {
        domains = options.trustedDomains;
      }
    }
    if (domains && domains.length) {
      for (i = 0, len = domains.length; i < len; i++) {
        if (_hasOwn.call(domains, i) && domains[i] && typeof domains[i] === "string") {
          domain = _extractDomain(domains[i]);
          if (!domain) {
            continue;
          }
          if (domain === "*") {
            trustedOriginsExpanded.length = 0;
            trustedOriginsExpanded.push(domain);
            break;
          }
          trustedOriginsExpanded.push.apply(trustedOriginsExpanded, [ domain, "//" + domain, _window.location.protocol + "//" + domain ]);
        }
      }
    }
    if (trustedOriginsExpanded.length) {
      str += "trustedOrigins=" + _encodeURIComponent(trustedOriginsExpanded.join(","));
    }
    if (options.forceEnhancedClipboard === true) {
      str += (str ? "&" : "") + "forceEnhancedClipboard=true";
    }
    if (typeof options.swfObjectId === "string" && options.swfObjectId) {
      str += (str ? "&" : "") + "swfObjectId=" + _encodeURIComponent(options.swfObjectId);
    }
    if (typeof options.jsVersion === "string" && options.jsVersion) {
      str += (str ? "&" : "") + "jsVersion=" + _encodeURIComponent(options.jsVersion);
    }
    return str;
  };
  /**
 * Extract the domain (e.g. "github.com") from an origin (e.g. "https://github.com") or
 * URL (e.g. "https://github.com/zeroclipboard/zeroclipboard/").
 *
 * @returns the domain
 * @private
 */
  var _extractDomain = function(originOrUrl) {
    if (originOrUrl == null || originOrUrl === "") {
      return null;
    }
    originOrUrl = originOrUrl.replace(/^\s+|\s+$/g, "");
    if (originOrUrl === "") {
      return null;
    }
    var protocolIndex = originOrUrl.indexOf("//");
    originOrUrl = protocolIndex === -1 ? originOrUrl : originOrUrl.slice(protocolIndex + 2);
    var pathIndex = originOrUrl.indexOf("/");
    originOrUrl = pathIndex === -1 ? originOrUrl : protocolIndex === -1 || pathIndex === 0 ? null : originOrUrl.slice(0, pathIndex);
    if (originOrUrl && originOrUrl.slice(-4).toLowerCase() === ".swf") {
      return null;
    }
    return originOrUrl || null;
  };
  /**
 * Set `allowScriptAccess` based on `trustedDomains` and `window.location.host` vs. `swfPath`.
 *
 * @returns The appropriate script access level.
 * @private
 */
  var _determineScriptAccess = function() {
    var _extractAllDomains = function(origins) {
      var i, len, tmp, resultsArray = [];
      if (typeof origins === "string") {
        origins = [ origins ];
      }
      if (!(typeof origins === "object" && origins && typeof origins.length === "number")) {
        return resultsArray;
      }
      for (i = 0, len = origins.length; i < len; i++) {
        if (_hasOwn.call(origins, i) && (tmp = _extractDomain(origins[i]))) {
          if (tmp === "*") {
            resultsArray.length = 0;
            resultsArray.push("*");
            break;
          }
          if (resultsArray.indexOf(tmp) === -1) {
            resultsArray.push(tmp);
          }
        }
      }
      return resultsArray;
    };
    return function(currentDomain, configOptions) {
      var swfDomain = _extractDomain(configOptions.swfPath);
      if (swfDomain === null) {
        swfDomain = currentDomain;
      }
      var trustedDomains = _extractAllDomains(configOptions.trustedDomains);
      var len = trustedDomains.length;
      if (len > 0) {
        if (len === 1 && trustedDomains[0] === "*") {
          return "always";
        }
        if (trustedDomains.indexOf(currentDomain) !== -1) {
          if (len === 1 && currentDomain === swfDomain) {
            return "sameDomain";
          }
          return "always";
        }
      }
      return "never";
    };
  }();
  /**
 * Get the currently active/focused DOM element.
 *
 * @returns the currently active/focused element, or `null`
 * @private
 */
  var _safeActiveElement = function() {
    try {
      return _document.activeElement;
    } catch (err) {
      return null;
    }
  };
  /**
 * Add a class to an element, if it doesn't already have it.
 *
 * @returns The element, with its new class added.
 * @private
 */
  var _addClass = function(element, value) {
    var c, cl, className, classNames = [];
    if (typeof value === "string" && value) {
      classNames = value.split(/\s+/);
    }
    if (element && element.nodeType === 1 && classNames.length > 0) {
      if (element.classList) {
        for (c = 0, cl = classNames.length; c < cl; c++) {
          element.classList.add(classNames[c]);
        }
      } else if (element.hasOwnProperty("className")) {
        className = " " + element.className + " ";
        for (c = 0, cl = classNames.length; c < cl; c++) {
          if (className.indexOf(" " + classNames[c] + " ") === -1) {
            className += classNames[c] + " ";
          }
        }
        element.className = className.replace(/^\s+|\s+$/g, "");
      }
    }
    return element;
  };
  /**
 * Remove a class from an element, if it has it.
 *
 * @returns The element, with its class removed.
 * @private
 */
  var _removeClass = function(element, value) {
    var c, cl, className, classNames = [];
    if (typeof value === "string" && value) {
      classNames = value.split(/\s+/);
    }
    if (element && element.nodeType === 1 && classNames.length > 0) {
      if (element.classList && element.classList.length > 0) {
        for (c = 0, cl = classNames.length; c < cl; c++) {
          element.classList.remove(classNames[c]);
        }
      } else if (element.className) {
        className = (" " + element.className + " ").replace(/[\r\n\t]/g, " ");
        for (c = 0, cl = classNames.length; c < cl; c++) {
          className = className.replace(" " + classNames[c] + " ", " ");
        }
        element.className = className.replace(/^\s+|\s+$/g, "");
      }
    }
    return element;
  };
  /**
 * Attempt to interpret the element's CSS styling. If `prop` is `"cursor"`,
 * then we assume that it should be a hand ("pointer") cursor if the element
 * is an anchor element ("a" tag).
 *
 * @returns The computed style property.
 * @private
 */
  var _getStyle = function(el, prop) {
    var value = _getComputedStyle(el, null).getPropertyValue(prop);
    if (prop === "cursor") {
      if (!value || value === "auto") {
        if (el.nodeName === "A") {
          return "pointer";
        }
      }
    }
    return value;
  };
  /**
 * Get the absolutely positioned coordinates of a DOM element.
 *
 * @returns Object containing the element's position, width, and height.
 * @private
 */
  var _getElementPosition = function(el) {
    var pos = {
      left: 0,
      top: 0,
      width: 0,
      height: 0
    };
    if (el.getBoundingClientRect) {
      var elRect = el.getBoundingClientRect();
      var pageXOffset = _window.pageXOffset;
      var pageYOffset = _window.pageYOffset;
      var leftBorderWidth = _document.documentElement.clientLeft || 0;
      var topBorderWidth = _document.documentElement.clientTop || 0;
      var leftBodyOffset = 0;
      var topBodyOffset = 0;
      if (_getStyle(_document.body, "position") === "relative") {
        var bodyRect = _document.body.getBoundingClientRect();
        var htmlRect = _document.documentElement.getBoundingClientRect();
        leftBodyOffset = bodyRect.left - htmlRect.left || 0;
        topBodyOffset = bodyRect.top - htmlRect.top || 0;
      }
      pos.left = elRect.left + pageXOffset - leftBorderWidth - leftBodyOffset;
      pos.top = elRect.top + pageYOffset - topBorderWidth - topBodyOffset;
      pos.width = "width" in elRect ? elRect.width : elRect.right - elRect.left;
      pos.height = "height" in elRect ? elRect.height : elRect.bottom - elRect.top;
    }
    return pos;
  };
  /**
 * Determine is an element is visible somewhere within the document (page).
 *
 * @returns Boolean
 * @private
 */
  var _isElementVisible = function(el) {
    if (!el) {
      return false;
    }
    var styles = _getComputedStyle(el, null);
    var hasCssHeight = _parseFloat(styles.height) > 0;
    var hasCssWidth = _parseFloat(styles.width) > 0;
    var hasCssTop = _parseFloat(styles.top) >= 0;
    var hasCssLeft = _parseFloat(styles.left) >= 0;
    var cssKnows = hasCssHeight && hasCssWidth && hasCssTop && hasCssLeft;
    var rect = cssKnows ? null : _getElementPosition(el);
    var isVisible = styles.display !== "none" && styles.visibility !== "collapse" && (cssKnows || !!rect && (hasCssHeight || rect.height > 0) && (hasCssWidth || rect.width > 0) && (hasCssTop || rect.top >= 0) && (hasCssLeft || rect.left >= 0));
    return isVisible;
  };
  /**
 * Clear all existing timeouts and interval polling delegates.
 *
 * @returns `undefined`
 * @private
 */
  var _clearTimeoutsAndPolling = function() {
    _clearTimeout(_flashCheckTimeout);
    _flashCheckTimeout = 0;
    _clearInterval(_swfFallbackCheckInterval);
    _swfFallbackCheckInterval = 0;
  };
  /**
 * Reposition the Flash object to cover the currently activated element.
 *
 * @returns `undefined`
 * @private
 */
  var _reposition = function() {
    var htmlBridge;
    if (_currentElement && (htmlBridge = _getHtmlBridge(_flashState.bridge))) {
      var pos = _getElementPosition(_currentElement);
      _extend(htmlBridge.style, {
        width: pos.width + "px",
        height: pos.height + "px",
        top: pos.top + "px",
        left: pos.left + "px",
        zIndex: "" + _getSafeZIndex(_globalConfig.zIndex)
      });
    }
  };
  /**
 * Sends a signal to the Flash object to display the hand cursor if `true`.
 *
 * @returns `undefined`
 * @private
 */
  var _setHandCursor = function(enabled) {
    if (_flashState.ready === true) {
      if (_flashState.bridge && typeof _flashState.bridge.setHandCursor === "function") {
        _flashState.bridge.setHandCursor(enabled);
      } else {
        _flashState.ready = false;
      }
    }
  };
  /**
 * Get a safe value for `zIndex`
 *
 * @returns an integer, or "auto"
 * @private
 */
  var _getSafeZIndex = function(val) {
    if (/^(?:auto|inherit)$/.test(val)) {
      return val;
    }
    var zIndex;
    if (typeof val === "number" && !_isNaN(val)) {
      zIndex = val;
    } else if (typeof val === "string") {
      zIndex = _getSafeZIndex(_parseInt(val, 10));
    }
    return typeof zIndex === "number" ? zIndex : "auto";
  };
  /**
 * Attempt to detect if ZeroClipboard is executing inside of a sandboxed iframe.
 * If it is, Flash Player cannot be used, so ZeroClipboard is dead in the water.
 *
 * @see {@link http://lists.w3.org/Archives/Public/public-whatwg-archive/2014Dec/0002.html}
 * @see {@link https://github.com/zeroclipboard/zeroclipboard/issues/511}
 * @see {@link http://zeroclipboard.org/test-iframes.html}
 *
 * @returns `true` (is sandboxed), `false` (is not sandboxed), or `null` (uncertain) 
 * @private
 */
  var _detectSandbox = function(doNotReassessFlashSupport) {
    var effectiveScriptOrigin, frame, frameError, previousState = _flashState.sandboxed, isSandboxed = null;
    doNotReassessFlashSupport = doNotReassessFlashSupport === true;
    if (_pageIsFramed === false) {
      isSandboxed = false;
    } else {
      try {
        frame = window.frameElement || null;
      } catch (e) {
        frameError = {
          name: e.name,
          message: e.message
        };
      }
      if (frame && frame.nodeType === 1 && frame.nodeName === "IFRAME") {
        try {
          isSandboxed = frame.hasAttribute("sandbox");
        } catch (e) {
          isSandboxed = null;
        }
      } else {
        try {
          effectiveScriptOrigin = document.domain || null;
        } catch (e) {
          effectiveScriptOrigin = null;
        }
        if (effectiveScriptOrigin === null || frameError && frameError.name === "SecurityError" && /(^|[\s\(\[@])sandbox(es|ed|ing|[\s\.,!\)\]@]|$)/.test(frameError.message.toLowerCase())) {
          isSandboxed = true;
        }
      }
    }
    _flashState.sandboxed = isSandboxed;
    if (previousState !== isSandboxed && !doNotReassessFlashSupport) {
      _detectFlashSupport(_ActiveXObject);
    }
    return isSandboxed;
  };
  /**
 * Detect the Flash Player status, version, and plugin type.
 *
 * @see {@link https://code.google.com/p/doctype-mirror/wiki/ArticleDetectFlash#The_code}
 * @see {@link http://stackoverflow.com/questions/12866060/detecting-pepper-ppapi-flash-with-javascript}
 *
 * @returns `undefined`
 * @private
 */
  var _detectFlashSupport = function(ActiveXObject) {
    var plugin, ax, mimeType, hasFlash = false, isActiveX = false, isPPAPI = false, flashVersion = "";
    /**
   * Derived from Apple's suggested sniffer.
   * @param {String} desc e.g. "Shockwave Flash 7.0 r61"
   * @returns {String} "7.0.61"
   * @private
   */
    function parseFlashVersion(desc) {
      var matches = desc.match(/[\d]+/g);
      matches.length = 3;
      return matches.join(".");
    }
    function isPepperFlash(flashPlayerFileName) {
      return !!flashPlayerFileName && (flashPlayerFileName = flashPlayerFileName.toLowerCase()) && (/^(pepflashplayer\.dll|libpepflashplayer\.so|pepperflashplayer\.plugin)$/.test(flashPlayerFileName) || flashPlayerFileName.slice(-13) === "chrome.plugin");
    }
    function inspectPlugin(plugin) {
      if (plugin) {
        hasFlash = true;
        if (plugin.version) {
          flashVersion = parseFlashVersion(plugin.version);
        }
        if (!flashVersion && plugin.description) {
          flashVersion = parseFlashVersion(plugin.description);
        }
        if (plugin.filename) {
          isPPAPI = isPepperFlash(plugin.filename);
        }
      }
    }
    if (_navigator.plugins && _navigator.plugins.length) {
      plugin = _navigator.plugins["Shockwave Flash"];
      inspectPlugin(plugin);
      if (_navigator.plugins["Shockwave Flash 2.0"]) {
        hasFlash = true;
        flashVersion = "2.0.0.11";
      }
    } else if (_navigator.mimeTypes && _navigator.mimeTypes.length) {
      mimeType = _navigator.mimeTypes["application/x-shockwave-flash"];
      plugin = mimeType && mimeType.enabledPlugin;
      inspectPlugin(plugin);
    } else if (typeof ActiveXObject !== "undefined") {
      isActiveX = true;
      try {
        ax = new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");
        hasFlash = true;
        flashVersion = parseFlashVersion(ax.GetVariable("$version"));
      } catch (e1) {
        try {
          ax = new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");
          hasFlash = true;
          flashVersion = "6.0.21";
        } catch (e2) {
          try {
            ax = new ActiveXObject("ShockwaveFlash.ShockwaveFlash");
            hasFlash = true;
            flashVersion = parseFlashVersion(ax.GetVariable("$version"));
          } catch (e3) {
            isActiveX = false;
          }
        }
      }
    }
    _flashState.disabled = hasFlash !== true;
    _flashState.outdated = flashVersion && _parseFloat(flashVersion) < _parseFloat(_minimumFlashVersion);
    _flashState.version = flashVersion || "0.0.0";
    _flashState.pluginType = isPPAPI ? "pepper" : isActiveX ? "activex" : hasFlash ? "netscape" : "unknown";
  };
  /**
 * Invoke the Flash detection algorithms immediately upon inclusion so we're not waiting later.
 */
  _detectFlashSupport(_ActiveXObject);
  /**
 * Always assess the `sandboxed` state of the page at important Flash-related moments.
 */
  _detectSandbox(true);
  /**
 * A shell constructor for `ZeroClipboard` client instances.
 *
 * @constructor
 */
  var ZeroClipboard = function() {
    if (!(this instanceof ZeroClipboard)) {
      return new ZeroClipboard();
    }
    if (typeof ZeroClipboard._createClient === "function") {
      ZeroClipboard._createClient.apply(this, _args(arguments));
    }
  };
  /**
 * The ZeroClipboard library's version number.
 *
 * @static
 * @readonly
 * @property {string}
 */
  _defineProperty(ZeroClipboard, "version", {
    value: "2.2.0",
    writable: false,
    configurable: true,
    enumerable: true
  });
  /**
 * Update or get a copy of the ZeroClipboard global configuration.
 * Returns a copy of the current/updated configuration.
 *
 * @returns Object
 * @static
 */
  ZeroClipboard.config = function() {
    return _config.apply(this, _args(arguments));
  };
  /**
 * Diagnostic method that describes the state of the browser, Flash Player, and ZeroClipboard.
 *
 * @returns Object
 * @static
 */
  ZeroClipboard.state = function() {
    return _state.apply(this, _args(arguments));
  };
  /**
 * Check if Flash is unusable for any reason: disabled, outdated, deactivated, etc.
 *
 * @returns Boolean
 * @static
 */
  ZeroClipboard.isFlashUnusable = function() {
    return _isFlashUnusable.apply(this, _args(arguments));
  };
  /**
 * Register an event listener.
 *
 * @returns `ZeroClipboard`
 * @static
 */
  ZeroClipboard.on = function() {
    return _on.apply(this, _args(arguments));
  };
  /**
 * Unregister an event listener.
 * If no `listener` function/object is provided, it will unregister all listeners for the provided `eventType`.
 * If no `eventType` is provided, it will unregister all listeners for every event type.
 *
 * @returns `ZeroClipboard`
 * @static
 */
  ZeroClipboard.off = function() {
    return _off.apply(this, _args(arguments));
  };
  /**
 * Retrieve event listeners for an `eventType`.
 * If no `eventType` is provided, it will retrieve all listeners for every event type.
 *
 * @returns array of listeners for the `eventType`; if no `eventType`, then a map/hash object of listeners for all event types; or `null`
 */
  ZeroClipboard.handlers = function() {
    return _listeners.apply(this, _args(arguments));
  };
  /**
 * Event emission receiver from the Flash object, forwarding to any registered JavaScript event listeners.
 *
 * @returns For the "copy" event, returns the Flash-friendly "clipData" object; otherwise `undefined`.
 * @static
 */
  ZeroClipboard.emit = function() {
    return _emit.apply(this, _args(arguments));
  };
  /**
 * Create and embed the Flash object.
 *
 * @returns The Flash object
 * @static
 */
  ZeroClipboard.create = function() {
    return _create.apply(this, _args(arguments));
  };
  /**
 * Self-destruct and clean up everything, including the embedded Flash object.
 *
 * @returns `undefined`
 * @static
 */
  ZeroClipboard.destroy = function() {
    return _destroy.apply(this, _args(arguments));
  };
  /**
 * Set the pending data for clipboard injection.
 *
 * @returns `undefined`
 * @static
 */
  ZeroClipboard.setData = function() {
    return _setData.apply(this, _args(arguments));
  };
  /**
 * Clear the pending data for clipboard injection.
 * If no `format` is provided, all pending data formats will be cleared.
 *
 * @returns `undefined`
 * @static
 */
  ZeroClipboard.clearData = function() {
    return _clearData.apply(this, _args(arguments));
  };
  /**
 * Get a copy of the pending data for clipboard injection.
 * If no `format` is provided, a copy of ALL pending data formats will be returned.
 *
 * @returns `String` or `Object`
 * @static
 */
  ZeroClipboard.getData = function() {
    return _getData.apply(this, _args(arguments));
  };
  /**
 * Sets the current HTML object that the Flash object should overlay. This will put the global
 * Flash object on top of the current element; depending on the setup, this may also set the
 * pending clipboard text data as well as the Flash object's wrapping element's title attribute
 * based on the underlying HTML element and ZeroClipboard configuration.
 *
 * @returns `undefined`
 * @static
 */
  ZeroClipboard.focus = ZeroClipboard.activate = function() {
    return _focus.apply(this, _args(arguments));
  };
  /**
 * Un-overlays the Flash object. This will put the global Flash object off-screen; depending on
 * the setup, this may also unset the Flash object's wrapping element's title attribute based on
 * the underlying HTML element and ZeroClipboard configuration.
 *
 * @returns `undefined`
 * @static
 */
  ZeroClipboard.blur = ZeroClipboard.deactivate = function() {
    return _blur.apply(this, _args(arguments));
  };
  /**
 * Returns the currently focused/"activated" HTML element that the Flash object is wrapping.
 *
 * @returns `HTMLElement` or `null`
 * @static
 */
  ZeroClipboard.activeElement = function() {
    return _activeElement.apply(this, _args(arguments));
  };
  /**
 * Keep track of the ZeroClipboard client instance counter.
 */
  var _clientIdCounter = 0;
  /**
 * Keep track of the state of the client instances.
 *
 * Entry structure:
 *   _clientMeta[client.id] = {
 *     instance: client,
 *     elements: [],
 *     handlers: {}
 *   };
 */
  var _clientMeta = {};
  /**
 * Keep track of the ZeroClipboard clipped elements counter.
 */
  var _elementIdCounter = 0;
  /**
 * Keep track of the state of the clipped element relationships to clients.
 *
 * Entry structure:
 *   _elementMeta[element.zcClippingId] = [client1.id, client2.id];
 */
  var _elementMeta = {};
  /**
 * Keep track of the state of the mouse event handlers for clipped elements.
 *
 * Entry structure:
 *   _mouseHandlers[element.zcClippingId] = {
 *     mouseover:  function(event) {},
 *     mouseout:   function(event) {},
 *     mouseenter: function(event) {},
 *     mouseleave: function(event) {},
 *     mousemove:  function(event) {}
 *   };
 */
  var _mouseHandlers = {};
  /**
 * Extending the ZeroClipboard configuration defaults for the Client module.
 */
  _extend(_globalConfig, {
    autoActivate: true
  });
  /**
 * The real constructor for `ZeroClipboard` client instances.
 * @private
 */
  var _clientConstructor = function(elements) {
    var client = this;
    client.id = "" + _clientIdCounter++;
    _clientMeta[client.id] = {
      instance: client,
      elements: [],
      handlers: {}
    };
    if (elements) {
      client.clip(elements);
    }
    ZeroClipboard.on("*", function(event) {
      return client.emit(event);
    });
    ZeroClipboard.on("destroy", function() {
      client.destroy();
    });
    ZeroClipboard.create();
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.on`.
 * @private
 */
  var _clientOn = function(eventType, listener) {
    var i, len, events, added = {}, meta = _clientMeta[this.id], handlers = meta && meta.handlers;
    if (!meta) {
      throw new Error("Attempted to add new listener(s) to a destroyed ZeroClipboard client instance");
    }
    if (typeof eventType === "string" && eventType) {
      events = eventType.toLowerCase().split(/\s+/);
    } else if (typeof eventType === "object" && eventType && typeof listener === "undefined") {
      for (i in eventType) {
        if (_hasOwn.call(eventType, i) && typeof i === "string" && i && typeof eventType[i] === "function") {
          this.on(i, eventType[i]);
        }
      }
    }
    if (events && events.length) {
      for (i = 0, len = events.length; i < len; i++) {
        eventType = events[i].replace(/^on/, "");
        added[eventType] = true;
        if (!handlers[eventType]) {
          handlers[eventType] = [];
        }
        handlers[eventType].push(listener);
      }
      if (added.ready && _flashState.ready) {
        this.emit({
          type: "ready",
          client: this
        });
      }
      if (added.error) {
        for (i = 0, len = _flashStateErrorNames.length; i < len; i++) {
          if (_flashState[_flashStateErrorNames[i].replace(/^flash-/, "")]) {
            this.emit({
              type: "error",
              name: _flashStateErrorNames[i],
              client: this
            });
            break;
          }
        }
        if (_zcSwfVersion !== undefined && ZeroClipboard.version !== _zcSwfVersion) {
          this.emit({
            type: "error",
            name: "version-mismatch",
            jsVersion: ZeroClipboard.version,
            swfVersion: _zcSwfVersion
          });
        }
      }
    }
    return this;
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.off`.
 * @private
 */
  var _clientOff = function(eventType, listener) {
    var i, len, foundIndex, events, perEventHandlers, meta = _clientMeta[this.id], handlers = meta && meta.handlers;
    if (!handlers) {
      return this;
    }
    if (arguments.length === 0) {
      events = _keys(handlers);
    } else if (typeof eventType === "string" && eventType) {
      events = eventType.split(/\s+/);
    } else if (typeof eventType === "object" && eventType && typeof listener === "undefined") {
      for (i in eventType) {
        if (_hasOwn.call(eventType, i) && typeof i === "string" && i && typeof eventType[i] === "function") {
          this.off(i, eventType[i]);
        }
      }
    }
    if (events && events.length) {
      for (i = 0, len = events.length; i < len; i++) {
        eventType = events[i].toLowerCase().replace(/^on/, "");
        perEventHandlers = handlers[eventType];
        if (perEventHandlers && perEventHandlers.length) {
          if (listener) {
            foundIndex = perEventHandlers.indexOf(listener);
            while (foundIndex !== -1) {
              perEventHandlers.splice(foundIndex, 1);
              foundIndex = perEventHandlers.indexOf(listener, foundIndex);
            }
          } else {
            perEventHandlers.length = 0;
          }
        }
      }
    }
    return this;
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.handlers`.
 * @private
 */
  var _clientListeners = function(eventType) {
    var copy = null, handlers = _clientMeta[this.id] && _clientMeta[this.id].handlers;
    if (handlers) {
      if (typeof eventType === "string" && eventType) {
        copy = handlers[eventType] ? handlers[eventType].slice(0) : [];
      } else {
        copy = _deepCopy(handlers);
      }
    }
    return copy;
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.emit`.
 * @private
 */
  var _clientEmit = function(event) {
    if (_clientShouldEmit.call(this, event)) {
      if (typeof event === "object" && event && typeof event.type === "string" && event.type) {
        event = _extend({}, event);
      }
      var eventCopy = _extend({}, _createEvent(event), {
        client: this
      });
      _clientDispatchCallbacks.call(this, eventCopy);
    }
    return this;
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.clip`.
 * @private
 */
  var _clientClip = function(elements) {
    if (!_clientMeta[this.id]) {
      throw new Error("Attempted to clip element(s) to a destroyed ZeroClipboard client instance");
    }
    elements = _prepClip(elements);
    for (var i = 0; i < elements.length; i++) {
      if (_hasOwn.call(elements, i) && elements[i] && elements[i].nodeType === 1) {
        if (!elements[i].zcClippingId) {
          elements[i].zcClippingId = "zcClippingId_" + _elementIdCounter++;
          _elementMeta[elements[i].zcClippingId] = [ this.id ];
          if (_globalConfig.autoActivate === true) {
            _addMouseHandlers(elements[i]);
          }
        } else if (_elementMeta[elements[i].zcClippingId].indexOf(this.id) === -1) {
          _elementMeta[elements[i].zcClippingId].push(this.id);
        }
        var clippedElements = _clientMeta[this.id] && _clientMeta[this.id].elements;
        if (clippedElements.indexOf(elements[i]) === -1) {
          clippedElements.push(elements[i]);
        }
      }
    }
    return this;
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.unclip`.
 * @private
 */
  var _clientUnclip = function(elements) {
    var meta = _clientMeta[this.id];
    if (!meta) {
      return this;
    }
    var clippedElements = meta.elements;
    var arrayIndex;
    if (typeof elements === "undefined") {
      elements = clippedElements.slice(0);
    } else {
      elements = _prepClip(elements);
    }
    for (var i = elements.length; i--; ) {
      if (_hasOwn.call(elements, i) && elements[i] && elements[i].nodeType === 1) {
        arrayIndex = 0;
        while ((arrayIndex = clippedElements.indexOf(elements[i], arrayIndex)) !== -1) {
          clippedElements.splice(arrayIndex, 1);
        }
        var clientIds = _elementMeta[elements[i].zcClippingId];
        if (clientIds) {
          arrayIndex = 0;
          while ((arrayIndex = clientIds.indexOf(this.id, arrayIndex)) !== -1) {
            clientIds.splice(arrayIndex, 1);
          }
          if (clientIds.length === 0) {
            if (_globalConfig.autoActivate === true) {
              _removeMouseHandlers(elements[i]);
            }
            delete elements[i].zcClippingId;
          }
        }
      }
    }
    return this;
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.elements`.
 * @private
 */
  var _clientElements = function() {
    var meta = _clientMeta[this.id];
    return meta && meta.elements ? meta.elements.slice(0) : [];
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.destroy`.
 * @private
 */
  var _clientDestroy = function() {
    if (!_clientMeta[this.id]) {
      return;
    }
    this.unclip();
    this.off();
    delete _clientMeta[this.id];
  };
  /**
 * Inspect an Event to see if the Client (`this`) should honor it for emission.
 * @private
 */
  var _clientShouldEmit = function(event) {
    if (!(event && event.type)) {
      return false;
    }
    if (event.client && event.client !== this) {
      return false;
    }
    var meta = _clientMeta[this.id];
    var clippedEls = meta && meta.elements;
    var hasClippedEls = !!clippedEls && clippedEls.length > 0;
    var goodTarget = !event.target || hasClippedEls && clippedEls.indexOf(event.target) !== -1;
    var goodRelTarget = event.relatedTarget && hasClippedEls && clippedEls.indexOf(event.relatedTarget) !== -1;
    var goodClient = event.client && event.client === this;
    if (!meta || !(goodTarget || goodRelTarget || goodClient)) {
      return false;
    }
    return true;
  };
  /**
 * Handle the actual dispatching of events to a client instance.
 *
 * @returns `undefined`
 * @private
 */
  var _clientDispatchCallbacks = function(event) {
    var meta = _clientMeta[this.id];
    if (!(typeof event === "object" && event && event.type && meta)) {
      return;
    }
    var async = _shouldPerformAsync(event);
    var wildcardTypeHandlers = meta && meta.handlers["*"] || [];
    var specificTypeHandlers = meta && meta.handlers[event.type] || [];
    var handlers = wildcardTypeHandlers.concat(specificTypeHandlers);
    if (handlers && handlers.length) {
      var i, len, func, context, eventCopy, originalContext = this;
      for (i = 0, len = handlers.length; i < len; i++) {
        func = handlers[i];
        context = originalContext;
        if (typeof func === "string" && typeof _window[func] === "function") {
          func = _window[func];
        }
        if (typeof func === "object" && func && typeof func.handleEvent === "function") {
          context = func;
          func = func.handleEvent;
        }
        if (typeof func === "function") {
          eventCopy = _extend({}, event);
          _dispatchCallback(func, context, [ eventCopy ], async);
        }
      }
    }
  };
  /**
 * Prepares the elements for clipping/unclipping.
 *
 * @returns An Array of elements.
 * @private
 */
  var _prepClip = function(elements) {
    if (typeof elements === "string") {
      elements = [];
    }
    return typeof elements.length !== "number" ? [ elements ] : elements;
  };
  /**
 * Add a `mouseover` handler function for a clipped element.
 *
 * @returns `undefined`
 * @private
 */
  var _addMouseHandlers = function(element) {
    if (!(element && element.nodeType === 1)) {
      return;
    }
    var _suppressMouseEvents = function(event) {
      if (!(event || (event = _window.event))) {
        return;
      }
      if (event._source !== "js") {
        event.stopImmediatePropagation();
        event.preventDefault();
      }
      delete event._source;
    };
    var _elementMouseOver = function(event) {
      if (!(event || (event = _window.event))) {
        return;
      }
      _suppressMouseEvents(event);
      ZeroClipboard.focus(element);
    };
    element.addEventListener("mouseover", _elementMouseOver, false);
    element.addEventListener("mouseout", _suppressMouseEvents, false);
    element.addEventListener("mouseenter", _suppressMouseEvents, false);
    element.addEventListener("mouseleave", _suppressMouseEvents, false);
    element.addEventListener("mousemove", _suppressMouseEvents, false);
    _mouseHandlers[element.zcClippingId] = {
      mouseover: _elementMouseOver,
      mouseout: _suppressMouseEvents,
      mouseenter: _suppressMouseEvents,
      mouseleave: _suppressMouseEvents,
      mousemove: _suppressMouseEvents
    };
  };
  /**
 * Remove a `mouseover` handler function for a clipped element.
 *
 * @returns `undefined`
 * @private
 */
  var _removeMouseHandlers = function(element) {
    if (!(element && element.nodeType === 1)) {
      return;
    }
    var mouseHandlers = _mouseHandlers[element.zcClippingId];
    if (!(typeof mouseHandlers === "object" && mouseHandlers)) {
      return;
    }
    var key, val, mouseEvents = [ "move", "leave", "enter", "out", "over" ];
    for (var i = 0, len = mouseEvents.length; i < len; i++) {
      key = "mouse" + mouseEvents[i];
      val = mouseHandlers[key];
      if (typeof val === "function") {
        element.removeEventListener(key, val, false);
      }
    }
    delete _mouseHandlers[element.zcClippingId];
  };
  /**
 * Creates a new ZeroClipboard client instance.
 * Optionally, auto-`clip` an element or collection of elements.
 *
 * @constructor
 */
  ZeroClipboard._createClient = function() {
    _clientConstructor.apply(this, _args(arguments));
  };
  /**
 * Register an event listener to the client.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.on = function() {
    return _clientOn.apply(this, _args(arguments));
  };
  /**
 * Unregister an event handler from the client.
 * If no `listener` function/object is provided, it will unregister all handlers for the provided `eventType`.
 * If no `eventType` is provided, it will unregister all handlers for every event type.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.off = function() {
    return _clientOff.apply(this, _args(arguments));
  };
  /**
 * Retrieve event listeners for an `eventType` from the client.
 * If no `eventType` is provided, it will retrieve all listeners for every event type.
 *
 * @returns array of listeners for the `eventType`; if no `eventType`, then a map/hash object of listeners for all event types; or `null`
 */
  ZeroClipboard.prototype.handlers = function() {
    return _clientListeners.apply(this, _args(arguments));
  };
  /**
 * Event emission receiver from the Flash object for this client's registered JavaScript event listeners.
 *
 * @returns For the "copy" event, returns the Flash-friendly "clipData" object; otherwise `undefined`.
 */
  ZeroClipboard.prototype.emit = function() {
    return _clientEmit.apply(this, _args(arguments));
  };
  /**
 * Register clipboard actions for new element(s) to the client.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.clip = function() {
    return _clientClip.apply(this, _args(arguments));
  };
  /**
 * Unregister the clipboard actions of previously registered element(s) on the page.
 * If no elements are provided, ALL registered elements will be unregistered.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.unclip = function() {
    return _clientUnclip.apply(this, _args(arguments));
  };
  /**
 * Get all of the elements to which this client is clipped.
 *
 * @returns array of clipped elements
 */
  ZeroClipboard.prototype.elements = function() {
    return _clientElements.apply(this, _args(arguments));
  };
  /**
 * Self-destruct and clean up everything for a single client.
 * This will NOT destroy the embedded Flash object.
 *
 * @returns `undefined`
 */
  ZeroClipboard.prototype.destroy = function() {
    return _clientDestroy.apply(this, _args(arguments));
  };
  /**
 * Stores the pending plain text to inject into the clipboard.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.setText = function(text) {
    if (!_clientMeta[this.id]) {
      throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");
    }
    ZeroClipboard.setData("text/plain", text);
    return this;
  };
  /**
 * Stores the pending HTML text to inject into the clipboard.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.setHtml = function(html) {
    if (!_clientMeta[this.id]) {
      throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");
    }
    ZeroClipboard.setData("text/html", html);
    return this;
  };
  /**
 * Stores the pending rich text (RTF) to inject into the clipboard.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.setRichText = function(richText) {
    if (!_clientMeta[this.id]) {
      throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");
    }
    ZeroClipboard.setData("application/rtf", richText);
    return this;
  };
  /**
 * Stores the pending data to inject into the clipboard.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.setData = function() {
    if (!_clientMeta[this.id]) {
      throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");
    }
    ZeroClipboard.setData.apply(this, _args(arguments));
    return this;
  };
  /**
 * Clears the pending data to inject into the clipboard.
 * If no `format` is provided, all pending data formats will be cleared.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.clearData = function() {
    if (!_clientMeta[this.id]) {
      throw new Error("Attempted to clear pending clipboard data from a destroyed ZeroClipboard client instance");
    }
    ZeroClipboard.clearData.apply(this, _args(arguments));
    return this;
  };
  /**
 * Gets a copy of the pending data to inject into the clipboard.
 * If no `format` is provided, a copy of ALL pending data formats will be returned.
 *
 * @returns `String` or `Object`
 */
  ZeroClipboard.prototype.getData = function() {
    if (!_clientMeta[this.id]) {
      throw new Error("Attempted to get pending clipboard data from a destroyed ZeroClipboard client instance");
    }
    return ZeroClipboard.getData.apply(this, _args(arguments));
  };
  if (typeof define === "function" && define.amd) {
    define(function() {
      return ZeroClipboard;
    });
  } else if (typeof module === "object" && module && typeof module.exports === "object" && module.exports) {
    module.exports = ZeroClipboard;
  } else {
    window.ZeroClipboard = ZeroClipboard;
  }
})(function() {
  return this || window;
}());
},{}],6:[function(require,module,exports){
/*jslint browser: true*/
/*jshint -W055 */
/*global console, alert*/

/*
 * For each disease area there will be 4 stages: Diagnosis, Monitoring, Treatment and Exclusions.
 * Each stage gets a single panel on the front screen.
 * Clicking on a panel takes you to a screen specific to that stage, but similar in layout and content
 *  to all the others.
 */

var template = require('./src/template.js'),
  main = require('./src/main.js');

//TODO not sure why i did this - was in local variable
//maybe a separate module
//window.location = window.history.location || window.location;
/********************************************************
 *** Shows the pre-load image and slowly fades it out. ***
 ********************************************************/
$(window).load(function() {
  $('.loading-container').fadeOut(1000, function() {
    //$(this).remove();
  });
});

/******************************************
 *** This happens when the page is ready ***
 ******************************************/
$(document).on('ready', function() {
  //Grab the hash if exists - IE seems to forget it
  main.hash = location.hash;

  //CHANGE THIS - added to spoof login
  location.hash="";
  main.hash="";
  $('#signin').on('click', function(){
    if($('#inpEmail').val().length<8) alert("Please enter your email address.");
    else {
      console.log('{"event":{"what":"login","when":' + new Date().getTime() + ',"who":"' + $("#inpEmail").val() + '"}}');
      $.ajax({
        type: "POST",
        url: "http://130.88.250.206:9100/pingr",
        data: '{"event":{"what":"login","when":' + new Date().getTime() + ',"who":"' + $("#inpEmail").val() + '"}}',
        success: function(d){console.log(d);},
        dataType: "json",
        contentType:"application/json"
      });

      var obj = JSON.parse(localStorage.bb);
      obj.email=$('#inpEmail').val();
      localStorage.bb = JSON.stringify(obj);


      history.pushState(null, null, '#overview');
      template.loadContent('#overview');
    }
  });
  $('#inpEmail').on('keyup', function(){
    var code = e.which;
    if(code==13){
      $('#signin').click();
    }
  });

  //Load the data then wire up the events on the page
  main.init();

  //Sorts out the data held locally in the user's browser
  if (!localStorage.bb) localStorage.bb = JSON.stringify({});
  var obj = JSON.parse(localStorage.bb);
  if (!obj.version || obj.version !== main.version) {
    localStorage.bb = JSON.stringify({
      "version": main.version
    });
  }

  if(JSON.parse(localStorage.bb).email) {
    $('#inpEmail').val(JSON.parse(localStorage.bb).email);
  }

  $('[data-toggle="tooltip"]').tooltip({
    container: 'body',
    delay: {
      "show": 500,
      "hide": 100
    },
    html: true
  });
  $('[data-toggle="lone-tooltip"]').tooltip({
    container: 'body',
    delay: {
      "show": 300,
      "hide": 100
    }
  });
  $('[data-toggle="lone-tooltip"]').on('shown.bs.tooltip', function(e) {
    $('[data-toggle="tooltip"]').not(this).tooltip('hide');
  });

  //ensure on first load the login screen is cached to the history
  history.pushState(null, null, '');
});

},{"./src/main.js":13,"./src/template.js":36}],7:[function(require,module,exports){
var data = require('./data.js'),
  lookup = require('./lookup.js'),
  chart = require('./chart.js'),
  log = require('./log.js'),
  Mustache = require('mustache'),
  ZeroClipboard = require('zeroclipboard');

var base = {

  //object for keeping track what is in each panel to prevent unnecessary redraws
  panels: {},

  selectTab: function(id) {
    var href = $('#mainTab li.active a').data("href");
    $('#mainTab li.active').removeClass('active').find('a').attr("href", href);
    $('#mainTab li[data-id="' + id + '"]').addClass('active').find('a').removeAttr("href");
  },

  createPanel: function(templateSelector, data, templates) {
    var tempMust = templateSelector.html();
    Mustache.parse(tempMust); // optional, speeds up future uses
    if (templates) {
      for (var o in templates) {
        if (templates.hasOwnProperty(o)) {
          Mustache.parse(templates[o]);
        }
      }
    }
    var rendered = Mustache.render(tempMust, data, templates);
    return rendered;
  },

  createPanelShow: function(templateSelector, panelSelector, data, templates) {
    var rendered = base.createPanel(templateSelector, data, templates);
    panelSelector.html(rendered).show();
  },

  showPathwayStageOverviewPanel: function(location, enableHover, pathwayId, pathwayStage) {
    var standards = [];
    for (var standard in data[pathwayId][pathwayStage].standards) {
      var denom = data.getDenominatorForStandard(pathwayId, pathwayStage);
      var num = denom - data.getNumeratorForStandard(pathwayId, pathwayStage, standard);
      standards.push({
        "standard": data[pathwayId][pathwayStage].standards[standard].tab.title,
        "standardKey": standard,
        "tooltip": data[pathwayId][pathwayStage].standards[standard]["standard-met-tooltip"],
        "numerator": num,
        "denominator": denom,
        "percentage": (num * 100 / denom).toFixed(0)
      });
    }

    base.createPanelShow($('#pathway-stage-overview-panel'), location, {
      pathway: data.pathwayNames[pathwayId],
      pathwayStage: pathwayStage,
      pathwayStageName: lookup.categories[pathwayStage].display,
      pathwayNameShort: pathwayId,
      title: data[pathwayId][pathwayStage].text.panel.text,
      standards: standards
    }, {
      "row": $('#overview-panel-table-row').html()
    });

    $('#' + pathwayStage + '-trend-toggle').on('click', function(e) {
      if ($(this).text() === "Trend") {
        $(this).text("Table");
        $('#' + pathwayStage + '-chart-table').hide();
        $('#' + pathwayStage + '-chart-wrapper').show();
      } else {
        $(this).text("Trend");
        $('#' + pathwayStage + '-chart-table').show();
        $('#' + pathwayStage + '-chart-wrapper').hide();
      }
      e.stopPropagation();
    });

    chart.drawOverviewChart(pathwayId, pathwayStage, enableHover);

  },

  hideFooter: function() {
    $('footer').hide();
  },

  showFooter: function() {
    $('footer').show();
  },

  hideTooltips: function() {
    $('[data-toggle="tooltip"]').tooltip('hide');
  },

  wireUpTooltips: function() {
    $('[data-toggle="tooltip"]').tooltip('hide');
    $('.tooltip').remove();

    $('[data-toggle="tooltip"]').tooltip({
      container: 'body',
      delay: {
        "show": 500,
        "hide": 100
      },
      html: true
    });
    $('[data-toggle="lone-tooltip"]').tooltip({
      container: 'body',
      delay: {
        "show": 300,
        "hide": 100
      }
    });
    $('[data-toggle="lone-tooltip"]').on('shown.bs.tooltip', function(e) {
      $('[data-toggle="tooltip"]').not(this).tooltip('hide');
    });
    $('.patient-row-tooltip').on('show.bs.tooltip', function(e) {
      if ($(this).hasClass('highlighted')) {
        e.stopPropagation();
        e.preventDefault();
      }
    });
  },

  setupClipboard: function(selector, destroy) {
    if (destroy) ZeroClipboard.destroy(); //tidy up

    var client = new ZeroClipboard(selector);

    client.on('ready', function() {
      client.on('aftercopy', function(event) {
        console.log('Copied text to clipboard: ' + event.data['text/plain']);
        $(event.target).tooltip('hide');
        $(event.target).popover({
          trigger: 'manual',
          template: '<div class="popover" role="tooltip"><div class="arrow"></div><div class="popover-content"></div></div>',
          delay: {
            show: 500,
            hide: 500
          }
        });
        clearTimeout(lookup.tmp);
        $(event.target).popover('show');
        lookup.tmp = setTimeout(function() {
          $(event.target).popover('hide');
        }, 600);
      });
    });
  },

  clearBox: function() {
    //Clear the patient search box
    $('.typeahead').typeahead('val', '');
  },

  /********************************
   * Modals
   ********************************/

  launchModal: function(data, label, value, reasonText, callbackOnSave, callbackOnCancel, callbackOnUndo) {
    var template = $('#modal-why').html();
    Mustache.parse(template); // optional, speeds up future uses

    var reasonTemplate = $('#modal-why-item').html();
    Mustache.parse(reasonTemplate);

    if (data.reasons && data.reasons.length > 0) data.hasReasons = true;

    var rendered = Mustache.render(template, data, {
      "item": reasonTemplate
    });
    $('#modal').html(rendered);

    if (reasonText) {
      $('#modal textarea').val(reasonText);
    }
    lookup.modalSaved = false;
    lookup.modalUndo = false;

    $('#modal .modal').off('click', '.undo-plan').on('click', '.undo-plan', function(e) {
      lookup.modalUndo = true;
    }).off('submit', 'form').on('submit', 'form', {
      "label": label
    }, function(e) {
      if (!e.data.label) e.data.label = "team";
      var reason = $('input:radio[name=reason]:checked').val();
      var reasonText = $('#modal textarea').val();

      log.recordFeedback(data.pathwayId, e.data.label, value, reason, reasonText);

      lookup.modalSaved = true;

      e.preventDefault();
      $('#modal .modal').modal('hide');
    }).modal();

    $('#modal').off('hidden.bs.modal').on('hidden.bs.modal', {
      "label": label
    }, function(e) {
      if (lookup.modalSaved) {
        lookup.modalSaved = false;
        if (callbackOnSave) callbackOnSave();
      } else if (lookup.modalUndo) {
        lookup.modalUndo = false;
        if (callbackOnUndo) callbackOnUndo();
      } else {
        //uncheck as cancelled. - but not if value is empty as this unchecks everything - or if already checked
        if (callbackOnCancel) callbackOnCancel();
      }
    });
  },

  sortSuggestions: function(suggestions) {
    suggestions.sort(function(a, b) {
      if (a.agree && !a.done) {
        if (b.agree && !b.done) return 0;
        return -1;
      } else if (!a.agree && !a.disagree) {
        if (!b.agree && !b.disagree) return 0;
        if (b.agree && !b.done) return 1;
        return -1;
      } else if (a.agree && a.done) {
        if (b.agree && b.done) return 0;
        if (b.disagree) return -1;
        return 1;
      } else {
        if (b.disagree) return 0;
        return 1;
      }
    });

    return suggestions;
  },

  addDisagreePersonalTeam: function(plans) {
    for (var i = 0; i < plans.length; i++) {
      if (plans[i].agree) {
        plans[i].disagree = false;
      } else if (plans[i].agree === false) {
        plans[i].disagree = true;
      }
    }
    return plans;
  },

  suggestionList: function(ids) {
    return ids.map(function(val) {
      return {
        "id": val.id || val,
        "text": log.text[val.id || val].text,
        "subsection": val.subsection
      };
    }).filter(function(v, i) { //RW to always limit to 3
      return i < 3;
    });
  },

  mergeIndividualStuff: function(suggestions, patientId) {
    var localActions = log.listActions();
    if (!localActions[patientId]) return suggestions;

    for (var i = 0; i < suggestions.length; i++) {
      if (localActions[patientId][suggestions[i].id]) {
        if (localActions[patientId][suggestions[i].id].agree) {
          suggestions[i].agree = true;
        } else if (localActions[patientId][suggestions[i].id].agree === false) {
          suggestions[i].disagree = true;
        }
        if (localActions[patientId][suggestions[i].id].done) suggestions[i].done = localActions[patientId][suggestions[i].id].done;
      }
    }
    return suggestions;
  },

  switchTo110Layout: function() {
    if (base.layout === "110") return;
    base.layout = "110";
    farLeftPanel.removeClass('col-lg-3 col-lg-8').addClass('col-lg-6').show();
    topPanel.hide();
    topLeftPanel.hide();
    bottomLeftPanel.hide();
    topRightPanel.hide();
    bottomRightPanel.hide();
    midPanel.hide();
    farRightPanel.removeClass('col-xl-4').addClass('col-xl-8').show();
  },

  switchTo101Layout: function() {
    if (base.layout === "101") return;
    base.layout = "101";
    farLeftPanel.removeClass('col-lg-3 col-lg-6 col-xl-4').addClass('col-lg-8').show();
    topPanel.hide();
    topLeftPanel.hide();
    bottomLeftPanel.hide();
    topRightPanel.hide();
    bottomRightPanel.hide();
    midPanel.hide();
    farRightPanel.removeClass('col-xl-8').addClass('col-xl-4').show();
  },



  switchTo221Layout: function() {
    if (base.layout === "221") return;
    base.layout = "221";
    farLeftPanel.hide();
    topPanel.hide();
    topLeftPanel.addClass('col-xl-6').show();
    bottomLeftPanel.addClass('col-xl-6').show();
    topRightPanel.removeClass('col-xl-12').addClass('col-xl-6').show();
    bottomRightPanel.removeClass('col-xl-12').addClass('col-xl-6').show();
    midPanel.removeClass('col-xl-4').addClass('col-xl-8').show();
    farRightPanel.removeClass('col-xl-8').addClass('col-xl-4').show();
  },

  switchTo21Layout: function() {
    if (base.layout === "21") return;
    base.layout = "21";
    farLeftPanel.hide();
    topPanel.hide();
    topLeftPanel.hide();
    bottomLeftPanel.hide();
    topRightPanel.removeClass('col-xl-6').addClass('col-xl-12').show();
    bottomRightPanel.removeClass('col-xl-6').addClass('col-xl-12').show();
    midPanel.removeClass('col-xl-4').addClass('col-xl-8').show();
    farRightPanel.removeClass('col-xl-8').addClass('col-xl-4').show();
  },

  wireUpStandardDropDown: function(pathwayId, pathwayStage, standard, callback) {
    var breaches = data.options.filter(function(val) {
      return val.pathwayId === pathwayId && val.pathwayStage === pathwayStage && val.standard === standard;
    });

    if (breaches.length > 0) $('select').val(breaches[0].value);

    $('select').select2({
      templateResult: base.formatStandard,
      minimumResultsForSearch: Infinity
    });
    $('span.select2-selection__rendered').attr("title", "");
    $('select').on('change', function() {
      var localData = $(this).find(':selected').data();
      callback(localData.pathwayId, localData.pathwayStage, localData.standard, data.patientId);
    }).on("select2:open", function(e) {
      base.wireUpTooltips();
    });
  },

  formatStandard: function(standard) {
    if (!standard.id) {
      return standard.text;
    }
    var localData = $(standard.element).data();
    // Not relevant
    var standardHtml = '';
    //if diagnosis opportunity then not relevant for other stages
    //if no mention anywhere then not relevant for that disease
    switch (data.getPatientStatus(data.patientId, localData.pathwayId, localData.pathwayStage, localData.standard)) {
      case "ok":
        standardHtml = '<span class="standard-achieved" data-toggle="tooltip" data-placement="left" title="' + data[localData.pathwayId][localData.pathwayStage].standards[localData.standard]["dropdown-tooltip"] + ' - QUALITY INDICATOR ACHIEVED">' + standard.text + ' <i class="fa fa-smile-o" style="color:green"></i></span>';
        break;
      case "missed":
        standardHtml = '<span class="standard-missed" data-toggle="tooltip" data-placement="left" title="' + data[localData.pathwayId][localData.pathwayStage].standards[localData.standard]["dropdown-tooltip"] + ' - IMPROVEMENT OPPORTUNITY EXISTS FOR THIS PATIENT">' + standard.text + ' <i class="fa fa-flag" style="color:red"></i></span>';
        break;
      case "not":
        standardHtml = '<span class="standard-not-relevant" data-toggle="tooltip" data-placement="left" title="' + data[localData.pathwayId][localData.pathwayStage].standards[localData.standard]["dropdown-tooltip"] + ' - STANDARD NOT RELEVANT TO THIS PATIENT">' + standard.text + ' <i class="fa fa-meh-o" style="color:gray"></i></span>';
        break;
    }
    var $standard = $(standardHtml);
    return $standard;
  },

  updateTitle: function(title){
    $('#title-left').html(title);
    $('#title-right').html("");
  },
  /*updateTitle: function(title, tooltip) {
    var titles = title;
    if (typeof title === "string") {
      titles = [{
        title: title,
        tooltip: tooltip
      }];
    }
    var content = titles.map(function(t, idx) {
      return idx === titles.length - 1 ? '<span title="' + t.tooltip + '">' + t.title + '</span>' : '<a href="' + t.url + '" title="' + t.tooltip + '">' + t.title + '</a>';
    }).join(" > ");

    $('.pagetitle').html(content);
  },*/

  hideAllPanels: function() {
    topLeftPanel.hide();
    bottomLeftPanel.hide();
    topRightPanel.hide();
    bottomRightPanel.hide();
    farLeftPanel.hide();
    farRightPanel.hide();
    topPanel.hide();
  },

  hidePanels: function(panel) {
    panel.children().hide();
  },

  updateTab: function(tab, value, url) {
    var tabElement = $('#mainTab a[data-href="#' + tab + '"]');
    tabElement.html(tabElement.text().split(":")[0] + ":<br><span><strong>" + value + "</strong></span>");
    tabElement.data("href", "#" + tab + "/" + url);
  },

  addFullPage: function(panel) {
    panel.fullpage({ verticalCentered: false, paddingBottom: '80px', scrollBar: true });

    $('.fp-down').off('click').on('click', function() {
      $.fn.fullpage.moveSectionDown();
    });

    $('.fp-up').off('click').on('click', function() {
      $.fn.fullpage.moveSectionUp();
    });
  },

  removeFullPage: function(panel) {
    if (panel.children('.section').length === 0) return;
    if ($.fn.fullpage && $.fn.fullpage.destroy) $.fn.fullpage.destroy('all'); //tidy up before doing it again
  },

  showLoading: function(){
    $('.loading-container').show();
    $('#title-row').hide();
  },

  hideLoading: function(){
    $('.loading-container').fadeOut(1000);
    $('#title-row').fadeIn(1000);
  },

};

module.exports = base;

},{"./chart.js":8,"./data.js":9,"./log.js":11,"./lookup.js":12,"mustache":4,"zeroclipboard":5}],8:[function(require,module,exports){
var Highcharts = require('highcharts/highstock'),
  data = require('./data.js'),
  lookup = require('./lookup.js'),
  log = require('./log.js'),
  Mustache = require('mustache');

console.log("chart.js: data.lastloader= " + data.lastloader);
data.lastloader = "chart.js";

var cht = {

  destroyCharts: function(charts) {
    for (var i = 0; i < charts.length; i++) {
      if (lookup.charts[charts[i]]) {
        lookup.charts[charts[i]].destroy();
        delete lookup.charts[charts[i]];
      }
    }
  },

  drawTrendChart: function(patientId, pathwayId, pathwayStage, standard) {
    var i, j;
    cht.destroyCharts(['chart-demo-trend']);
    if (!data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[0]]) {
      $('#chart-demo-trend').html('No data for this patients');
      $('#chart-demo-trend').parent().find('.table-chart-toggle').hide();
      return;
    }

    var chartData = data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[0]];
    var tableData = [];
    for (i = 1; i < data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[0]][0].length; i++) {
      tableData.push({
        "item": data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[0]][1][0],
        "value": data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[0]][1][i],
        "date": data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[0]][0][i]
      });
    }
    for (i = 1; i < data[pathwayId][pathwayStage].standards[standard].chart.length; i++) {
      chartData.push(data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[i]][1]); //RW TODO assumption here that all dates are the same
      for (j = 1; j < data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[0]][0].length; j++) {
        tableData.push({
          "item": data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[i]][1][0],
          "value": data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[i]][1][j],
          "date": data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[0]][0][j]
        });
      }
    }
    var chartOptions = {
      bindto: '#chart-demo-trend',
      data: {
        xs: {},
        classes: {},
        columns: chartData.slice()
      },
      zoom: {
        enabled: true
      },
      line: {
        connectNull: false
      },
      axis: {
        x: {
          type: 'timeseries',
          tick: {
            fit: false,
            format: '%d-%m-%Y',
            count: 5
          },
          max: new Date()
        },
        y: {
          label: {
            text: data[pathwayId][pathwayStage].standards[standard].chartUnits,
            position: 'outer-middle'
          }
        }
      }
    };

    var maxValue = 0;
    var standardItems = [];

    for (i = 1; i < chartOptions.data.columns.length; i++) {
      chartOptions.data.xs[chartOptions.data.columns[i][0]] = "x";
      standardItems.push(chartOptions.data.columns[i][0]);

      for (j = 1; j < chartOptions.data.columns[i].length; j++) {
        if (parseFloat(chartOptions.data.columns[i][j]) > maxValue) maxValue = parseFloat(chartOptions.data.columns[i][j]);
      }
    }

    chartOptions.tooltip = {
      format: {
        value: function(value, ratio, id) {
          var text = standardItems.indexOf(id) > -1 ? value : "";
          return text;
        }
      }
    };

    var lines = null;
    var axisnum = 1;
    if (data.patients[patientId].contacts) {
      for (i = 0; i < data.patients[patientId].contacts.length; i++) {
        chartOptions.data.classes[data.patients[patientId].contacts[i].text] = 'larger';
        if (!chartOptions.data.xs[data.patients[patientId].contacts[i].text]) {
          chartOptions.data.xs[data.patients[patientId].contacts[i].text] = "x" + axisnum;
          chartOptions.data.columns.push(["x" + axisnum, data.patients[patientId].contacts[i].value]);
          chartOptions.data.columns.push([data.patients[patientId].contacts[i].text, (maxValue * 1.1).toString()]);
          axisnum++;
        } else {
          var axis = chartOptions.data.xs[data.patients[patientId].contacts[i].text];
          for (j = 1; j < chartOptions.data.columns.length; j++) {
            if (chartOptions.data.columns[j][0] === axis) {
              chartOptions.data.columns[j].push(data.patients[patientId].contacts[i].value);
            } else if (chartOptions.data.columns[j][0] === data.patients[patientId].contacts[i].text) {
              chartOptions.data.columns[j].push((maxValue * 1.1).toString());
            }
          }
        }
        tableData.push({
          "item": "Event",
          "value": data.patients[patientId].contacts[i].text,
          "date": data.patients[patientId].contacts[i].value
        });
      }
    }

    var patientEvents = log.getEvents().filter(function(val) {
      return val.id === patientId;
    });
    if (patientEvents.length > 0) {

      for (i = 0; i < patientEvents.length; i++) {
        chartOptions.data.classes[patientEvents[i].name] = 'larger';
        if (!chartOptions.data.xs[patientEvents[i].name]) {
          chartOptions.data.xs[patientEvents[i].name] = "x" + axisnum;
          chartOptions.data.columns.push(["x" + axisnum, patientEvents[i].date.substr(0, 10)]);
          chartOptions.data.columns.push([patientEvents[i].name, (maxValue * 1.1).toString()]);
          axisnum++;
        } else {
          var axis2 = chartOptions.data.xs[patientEvents[i].name];
          for (j = 1; j < chartOptions.data.columns.length; j++) {
            if (chartOptions.data.columns[j][0] === axis2) {
              chartOptions.data.columns[j].push(patientEvents[i].date.substr(0, 10));
            } else if (chartOptions.data.columns[j][0] === patientEvents[i].name) {
              chartOptions.data.columns[j].push((maxValue * 1.1).toString());
            }
          }
        }
        tableData.push({
          "item": "Event",
          "value": patientEvents[i].name,
          "date": patientEvents[i].date.substr(0, 10)
        });
      }
    }

    tableData.sort(function(a, b) {
      if (a.date === b.date) return 0;
      else return a.date < b.date ? 1 : -1;
    });
    //draw Table
    $('#table-demo-trend').html(Mustache.render($('#value-trend-panel-table').html(), {
      "items": tableData
    }, {
      "item-row": $('#value-trend-panel-table-row').html()
    }));

    //draw charts in separate thread and with delay to stop sluggish appearance
    setTimeout(function() {
      lookup.charts['chart-demo-trend'] = c3.generate(chartOptions);
    }, 1);
  },

  selectPieSlice: function(chart, d) {
    lookup.chartClicked = true;
    $('#' + chart + ' path.c3-bar').attr('class', function(index, classNames) {
      return classNames + ' _unselected_';
    });
    lookup.charts[chart].select([d.id], [d.index], true);

    farRightPanel.fadeOut(200, function() {
      var template = $('#patient-panel-placeholder').html();
      farRightPanel.html(Mustache.render(template)).show();
    });
  },

  drawOverviewChart: function(pathwayId, pathwayStage, enableHover) {
    cht.destroyCharts([pathwayStage + '-chart']);
    setTimeout(function() {
      lookup.charts[pathwayStage + '-chart'] = c3.generate({
        bindto: '#' + pathwayStage + '-chart',
        data: {
          x: 'x',
          columns: data[pathwayId][pathwayStage].trend
        },
        zoom: {
          enabled: true
        },
        tooltip: {
          format: {
            title: function(x) {
              return x.toDateString() + (enableHover ? '<br>Click for more detail' : '');
            },
            value: function(value) {
              return enableHover ? value + '%' : undefined;
            }
          }
        },
        axis: {
          x: {
            type: 'timeseries',
            tick: {
              format: '%d-%m-%Y',
              count: 7,
              culling: {
                max: 4
              }
            },
            label: {
              text: 'Date',
              position: 'outer-center'
            }
          },
          y: {
            min: 0,
            label: {
              text: 'Proportion (%)',
              position: 'outer-middle'
            }
          }
        },
        point: {
          show: false
        },
        size: {
          height: null
        }
      });
    }, 1);
  },

  drawBenchmarkChart: function(element, data) {
    cht.destroyCharts([element + '-chart']);
    setTimeout(function() {
      lookup.charts[element + '-chart'] = c3.generate({
        bindto: '#' + element,
        size: {
          height: 200
        },
        data: data,
        axis: {
          x: {
            type: 'category',
            tick: {
              rotate: 60,
              multiline: false
            }
          },
          y: {
            label: {
              text: '% of patients meeting the target',
              position: 'outer-middle'
            }
          }
        },
        grid: {
          y: {
            show: true
          }
        }
      });
    }, 1);
  },

  drawPerformanceTrendChart: function(element, data) {
    cht.destroyCharts([element + '-chart']);
    setTimeout(function() {
      lookup.charts[element + '-chart'] = c3.generate({
        bindto: '#' + element,
        size: {
          height: 200
        },
        data: data,
        axis: {
          x: {
            type: 'timeseries',
            tick: {
              format: '%Y-%m-%d',
              rotate: 60,
              multiline: false
            },
            height: 60
          },
          y: {
            label: {
              text: "Performance",
              position: 'outer-middle'
            }
          }
        },
        grid: {
          x: {
            show: true
          },
          y: {
            show: true
          }
        }
      });
    }, 1);
  },

  drawBenchmarkChartHC: function(element, data) {

    data = [
      { x: 49.9, p: 'P1', local: true },
      { x: 71.5, p: 'P2', local: true },
      { x: 16.4, p: 'P3', local: true },
      { x: 29.2, p: 'P4', local: true },
      { x: 44.0, p: 'P5', local: true },
      { x: 76.0, p: 'P6', local: true },
      { x: 35.6, p: 'YOU', local: true },
      { x: 48.5, p: 'P7', local: true },
      { x: 26.4, p: 'P8', local: true },
      { x: 94.1, p: 'P9', local: true },
      { x: 95.6, p: 'P10' },
      { x: 54.0, p: 'P11' },
      { x: 39.9, p: 'P12' },
      { x: 61.5, p: 'P13' },
      { x: 6.4, p: 'P14' },
      { x: 19.2, p: 'P15' },
      { x: 34.0, p: 'P16' },
      { x: 66.0, p: 'P17' },
      { x: 25.6, p: 'P18' },
      { x: 38.5, p: 'P19' },
      { x: 36.4, p: 'P20' },
      { x: 84.1, p: 'P21' },
      { x: 85.6, p: 'P22' },
      { x: 64.0, p: 'P23' }
    ];
    data.sort(function(a, b) {
      return a.x - b.x;
    });

    var local = true;
    var bChart = $('#' + element).highcharts({
        chart: {
          type: 'column',
          events: {
            load: function() {
              var thisChart = this;
              thisChart.renderer.button('Toggle neighbourhood / CCG', thisChart.plotWidth - 100, 0, function() {
                local = !local;
                thisChart.xAxis[0].categories = data.filter(function(v) {
                  if (local) return v.local;
                  else return true;
                }).map(function(v) {
                  return v.p;
                });
                thisChart.series[0].setData(data.filter(function(v) {
                  if (local) return v.local;
                  else return true;
                }).map(function(v) {
                  if (v.p === "YOU") return { y: v.x, color: "red" };
                  else return v.x;
                }));
              }).add();
            }
          }
        },
        title: { text: 'Benchmark' },
        xAxis: {
          categories: data.filter(function(v) {
            return v.local === local;
          }).map(function(v) {
            return v.p;
          }),
          crosshair: true
        },
        yAxis: {
          min: 0,
          max: 100,
          title: { text: '% patients meeting target' }
        },
        tooltip: {
          headerFormat: '<span style="font-size:10px">Practice: <b>{point.key}</b></span><table>',
          pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
            '<td style="padding:0"><b>{point.y:.1f}%</b></td></tr>',
          footerFormat: '</table>',
          shared: true,
          useHTML: true
        },
        plotOptions: {
          column: {
            pointPadding: 0.2,
            borderWidth: 0
          }
        },
        legend: {
          enabled: false
        },
        series: [{
          name: 'Performance',
          data: data.filter(function(v) {
            return v.local === local;
          }).map(function(v) {
            if (v.p === "YOU") return { y: v.x, color: "red" };
            else return v.x;
          })
      }]
      },
      function(chart) { // on complete
        var textX = chart.plotLeft + (chart.plotWidth * 0.5);
        var textY = chart.plotTop + (chart.plotHeight * 0.5);

        var span = '<span id="pieChartInfoText" style="position:absolute; text-align:center;-ms-transform: rotate(335deg);-webkit-transform: rotate(335deg);transform: rotate(335deg);">';
        span += '<span style="font-size: 64px">Coming Soon!</span>';
        span += '</span>';

        $("#benchmark-chart").append(span);
        span = $('#pieChartInfoText');
        span.css('left', textX + (span.width() * -0.5));
        span.css('top', textY + (span.height() * -0.5));
      });

  },

  drawPerformanceTrendChartHC: function(element, data) {

    /// data is
    // {
    //  "values":
    //    ["x", "2015-08-24", "2015-08-23",...
    //    ["numerator", 35, 37, 33, 32, 31,...
    //    ["denominator", 135, 133, 133, 13,...
    //    ["target", 0.3, 0.3, 0...
    // }

    var target = 75,
      maxValue = target,
      maxXvalue = 0;

    var series = [
      { type: 'line', name: 'Trend', data: [] },
      { type: 'line', name: 'Prediction', data: [], dashStyle: 'dot' }
    ];

    var today = new Date();
    var lastApril = new Date();
    var aprilBeforeThat = new Date();
    var nextApril = new Date();
    if (today.getMonth() < 3) {
      //after april
      lastApril.setYear(today.getFullYear() - 1);
      aprilBeforeThat.setYear(today.getFullYear() - 1);
    } else {
      nextApril.setYear(today.getFullYear() + 1);
    }
    aprilBeforeThat.setYear(aprilBeforeThat.getFullYear() - 1);
    lastApril.setMonth(3);
    aprilBeforeThat.setMonth(3);
    nextApril.setMonth(3);
    lastApril.setDate(1);
    aprilBeforeThat.setDate(1);
    nextApril.setDate(1);

    var n = 0,
      sumX = 0,
      sumY = 0,
      sumXY = 0,
      sumXX = 0,
      sumYY = 0,
      intercept, gradient, compDate;

    if (data.values[0].filter(function(v) {
        return new Date(v).getTime() > lastApril.getTime();
      }).length > 2) compDate = new Date(lastApril.getTime());
    else compDate = new Date(aprilBeforeThat.getTime());

    data.values[0].forEach(function(v, i) {
      if (i === 0) return;
      var time = new Date(v).getTime();
      var y = +data.values[1][i] * 100 / +data.values[2][i];
      if (time >= compDate.getTime()) {
        n++;
        sumX += time;
        sumY += y;
        sumXY += time * y;
        sumXX += time * time;
        sumYY += y * y;
      }
      series[0].data.push([time, y]);
      maxValue = Math.max(maxValue, y);
      maxXvalue = Math.max(maxXvalue, time);
    });

    intercept = (sumY * sumXX - sumX * sumXY) / (n * sumXX - sumX * sumX);
    gradient = (n * sumXY - sumX * sumY) / (n * sumXX - sumX * sumX);

    var newCompDate = new Date(lastApril.getTime());
    series[1].data.push([maxXvalue, maxXvalue * gradient + intercept]);
    for (var i = 0; i < 13; i++) {
      var x = newCompDate.getTime();
      if (x < maxXvalue) {
        newCompDate.setMonth(newCompDate.getMonth() + 1);
        continue;
      }
      series[1].data.push([x, x * gradient + intercept]);
      var m = newCompDate.getMonth();
      newCompDate.setMonth(newCompDate.getMonth() + 1);
    }

    //Add line of best fit for latest data since april to next april


    //Default to last april - april


    var c = $('#' + element).highcharts({
      title: { text: '' },
      xAxis: {
        max: nextApril.getTime(),
        type: 'datetime'
      },
      yAxis: {
        title: { text: 'Quality standard performance' },
        max: maxValue + 5,
        min: 0,
        plotLines: [{
          value: target,
          color: 'green',
          dashStyle: 'shortdash',
          width: 2,
          label: {
            text: 'Target - ' + (target) + '%'
          },
        }]
      },
      legend: { enabled: true },
      tooltip: {
        pointFormat: '<span style="color:{point.color}">\u25CF</span> {series.name}: <b>{point.y:.2f}%</b><br/>'
      },

      navigator: {
        enabled: true
      },

      series: series
    });

    c.highcharts().axes[0].setExtremes(aprilBeforeThat.getTime(), lastApril.getTime(), undefined, false);

  },

  drawAnalytics: function(element, data, selectSeriesFn) {

    cht.cloneToolTip = null;
    cht.cloneToolTip2 = null;

    $('#' + element).highcharts({
      chart: {
        type: "column",
        backgroundColor: "#F3F9F9",
        height: 200,
        events: {
          click: function(event) {
            selectSeriesFn();

            if (cht.cloneToolTip) {
              this.container.firstChild.removeChild(cht.cloneToolTip);
              cht.cloneToolTip = null;
            }
            if (cht.cloneToolTip2) {
              cht.cloneToolTip2.remove();
              cht.cloneToolTip2 = null;
            }

            return false;
          }
        }
      },
      title: {
        text: 'Patients not meeting the standard'
      },
      subtitle: {
        text: document.ontouchstart === undefined ?
          'Click a column to filter the patient list' : 'Tap a column to filter the patient list'
      },
      xAxis: {
        categories: data.map(function(v, i) {
          return v[0];
        })
      },
      yAxis: {
        title: {
          text: 'Number of patients'
        },
        stackLabels: {
          enabled: true,
          style: {
            fontWeight: 'bold',
            color: (Highcharts.theme && Highcharts.theme.textColor) || 'gray'
          }
        }
      },
      legend: {
        enabled: false
      },

      tooltip: {
        animation: false,

        formatter: function() {
          return this.point.desc.match(/.{1,40}[^ ]* ?/g).join("<br>");
        },

        style: {
          "whiteSpace": "normal"
        },

        useHTML: true
      },

      plotOptions: {

        column: {
          dataLabels: {
            enabled: true,
            color: 'black'
          }
        },

        series: {
          cursor: 'pointer',
          point: {
            events: {
              click: function(event) {
                var numPoints = this.series.points.length;

                selectSeriesFn(this.category);

                if (cht.cloneToolTip) {
                  this.series.chart.container.firstChild.removeChild(cht.cloneToolTip);
                }
                if (cht.cloneToolTip2) {
                  cht.cloneToolTip2.remove();
                }
                cht.cloneToolTip = this.series.chart.tooltip.label.element.cloneNode(true);
                this.series.chart.container.firstChild.appendChild(cht.cloneToolTip);

                cht.cloneToolTip2 = $('.highcharts-tooltip').clone();
                $(this.series.chart.container).append(cht.cloneToolTip2);

                return false;
              }
            }
          }
        }
      },

      series: [{
        data: data.map(function(v, i) {
          return {
            y: v[2],
            desc: v[1],
            color: Highcharts.getOptions().colors[i]
          };
        })
      }]
    });
  }

};

module.exports = cht;

},{"./data.js":9,"./log.js":11,"./lookup.js":12,"highcharts/highstock":2,"mustache":4}],9:[function(require,module,exports){
var log = require('./log.js'),
  lookup = require('./lookup.js');


var _getAllIndicatorData = function(callback) {
  var r = Math.random();
  $.getJSON("data/indicators.json?v=" + r, function(file) {
    dt.indicators = file;

    dt.indicators.forEach(function(indicator) {
      var percentage = Math.round(100 * indicator.values[1][1] * 100 / indicator.values[2][1]) / 100;
      indicator.performance = indicator.values[1][1] + " / " + indicator.values[2][1] + " (" + percentage + "%)";
      indicator.target = indicator.values[3][1] * 100 + "%";
      indicator.up = percentage > Math.round(100 * indicator.values[1][2] * 100 / indicator.values[2][2]) / 100;
      var trend = indicator.values[1].map(function(val, idx) {
        return Math.round(100 * val * 100 / indicator.values[2][idx]) / 100;
      }).slice(1, 10);
      trend.reverse();
      indicator.trend = trend.join(",");
      var dates = indicator.values[0].slice(1, 10);
      dates.reverse();
      indicator.dates = dates;
    });


    callback(dt.indicators);
  });
};

var _getAllIndicatorDataSync = function(callback) {
  var r = Math.random();
  $.ajax({
    url: "data/indicators.json?v=" + r,
    async: false,
    success: function(file) {
      dt.indicators = file;

      dt.indicators.forEach(function(indicator) {
        var percentage = Math.round(100 * indicator.values[1][1] * 100 / indicator.values[2][1]) / 100;
        indicator.performance = indicator.values[1][1] + " / " + indicator.values[2][1] + " (" + percentage + "%)";
        indicator.target = indicator.values[3][1] * 100 + "%";
        indicator.up = percentage > Math.round(100 * indicator.values[1][2] * 100 / indicator.values[2][2]) / 100;
        var trend = indicator.values[1].map(function(val, idx) {
          return Math.round(100 * val * 100 / indicator.values[2][idx]) / 100;
        }).slice(1, 10);
        trend.reverse();
        indicator.trend = trend.join(",");
        var dates = indicator.values[0].slice(1, 10);
        dates.reverse();
        indicator.dates = dates;
      });

    }
  });

  return dt.indicators;
};

var _getIndicatorData = function(indicator, callback) {
  var r = Math.random();
  $.getJSON("data/idata." + indicator + ".json?v=" + r, function(file) {
    dt.indicators[indicator] = file;

    //apply which categories people belong to
    Object.keys(dt.indicators[indicator].patients).forEach(function(patient) {
      dt.indicators[indicator].patients[patient].opportunities = [];
      dt.indicators[indicator].opportunities.forEach(function(opp, idx) {
        if (opp.patients.indexOf(+patient) > -1) {
          dt.indicators[indicator].patients[patient].opportunities.push(idx);
        }
      });
    });

    callback(dt.indicators[indicator]);
  });
};

var _getIndicatorDataSync = function(indicator) {
  var r = Math.random();
  $.ajax({
    url: "data/idata." + indicator + ".json?v=" + r,
    async: false,
    success: function(file) {
      dt.indicators[indicator] = file;

      //apply which categories people belong to
      Object.keys(dt.indicators[indicator].patients).forEach(function(patient) {
        dt.indicators[indicator].patients[patient].opportunities = [];
        dt.indicators[indicator].opportunities.forEach(function(opp, idx) {
          if (opp.patients.indexOf(+patient) > -1) {
            dt.indicators[indicator].patients[patient].opportunities.push(idx);
          }
        });
      });

    }
  });
  return dt.indicators[indicator];
};

var _getFakePatientData = function(patient, callback) {
  var r = Math.random(),
    isAsync = typeof(callback) === "function";
  if (dt.patients && dt.patients.patient) {
    if (isAsync) return callback(dt.patients.patient);
    else return dt.patients.patient;
  }
  $.ajax({
    url: "data/patient.json?v=" + r,
    async: isAsync,
    success: function(file) {
      if (!dt.patients) dt.patients = {};
      dt.patients.patient = file;
      dt.patients[patient] = file;

      if (isAsync) callback(dt.patients.patient);
    }
  });
  if (!isAsync) return dt.patients.patient;
};

var _getPatientData = function(patient, callback) {
  //if callback provided do async - else do sync
  var r = Math.random(),
    isAsync = typeof(callback) === "function";

  if (dt.patients && dt.patients[patient]) {
    if (isAsync) return callback(dt.patients[patient]);
    else return dt.patients[patient];
  }

  $.ajax({
    url: "data/" + patient + ".json?v=" + r,
    async: isAsync,
    success: function(file) {
      if (!dt.patients) dt.patients = {};
      dt.patients[patient] = file;

      if (isAsync) callback(dt.patients[patient]);
    },
    error: function() {
      if (dt.patients.patient && isAsync) {
        dt.patients[patient] = dt.patients.patient;
        return callback(dt.patients.patient);
      } else if (!dt.patients.patient) {
        _getFakePatientData(patient, callback);
      }
    }
  });

  if (!isAsync) return dt.patients.patient;
};

var dt = {

  pathwayNames: {},
  diseases: [],
  options: [],
  patLookup: {},

  getPatietListForStandard: function(pathwayId, pathwayStage, standard) {
    var patients = dt.removeDuplicates(dt[pathwayId][pathwayStage].standards[standard].opportunities.reduce(function(a, b) {
      return a.patients ? a.patients.concat(b.patients) : a.concat(b.patients);
    }));
    return patients;
  },

  getPatientStatus: function(patientId, pathwayId, pathwayStage, standard) {
    if (dt.patients[patientId].breach) {
      if (dt.patients[patientId].breach.filter(function(val) {
          return val.pathwayId === pathwayId && val.pathwayStage === pathwayStage && val.standard === standard;
        }).length > 0) {
        return "missed";
      } else if (dt.patients[patientId].breach.filter(function(val) {
          return val.pathwayId === pathwayId && val.pathwayStage === "diagnosis";
        }).length > 0 && pathwayStage !== "diagnosis") {
        return "not";
      } else if (dt.patients[patientId].breach.filter(function(val) {
          return val.pathwayId === pathwayId;
        }).length > 0) {
        return "ok";
      } else {
        return "not";
      }
    } else {
      return "not";
    }
  },

  getNumeratorForStandard: function(pathwayId, pathwayStage, standard) {
    var patients = dt.getPatietListForStandard(pathwayId, pathwayStage, standard);
    return patients.length;
  },

  getDenominatorForStandard: function(pathwayId, pathwayStage) {
    var patients = dt[pathwayId][pathwayStage].patientsOk;
    for (var standard in dt[pathwayId][pathwayStage].standards) {
      var newPatients = dt.getPatietListForStandard(pathwayId, pathwayStage, standard);
      patients = patients.concat(newPatients);
    }
    return dt.removeDuplicates(patients).length;
  },

  removeDuplicates: function(array) {
    var arrResult = {};
    var rtn = [];
    for (var i = 0; i < array.length; i++) {
      arrResult[array[i]] = array[i];
    }
    for (var item in arrResult) {
      rtn.push(arrResult[item]);
    }
    return rtn;
  },

  numberOfStandardsMissed: function(patientId) {
    if (!dt.patients[patientId].breach) return 0;
    var a = dt.patients[patientId].breach.map(function(val) {
      return val.pathwayId + val.pathwayStage + val.standard;
    });
    var obj = {};
    for (var i = 0; i < a.length; i++) {
      obj[a[i]] = "";
    }
    return Object.keys(obj).length;
  },

  getAllPatients: function() {
    var pList = [],
      i, k, prop;
    for (k = 0; k < dt.diseases.length; k++) {
      for (i in lookup.categories) {
        for (prop in dt[dt.diseases[k].id][i].bdown) {
          if (dt[dt.diseases[k].id][i].bdown.hasOwnProperty(prop)) {
            pList = pList.concat(dt[dt.diseases[k].id][i].bdown[prop].patients);
          }
        }
        pList = pList.concat(dt[dt.diseases[k].id][i].patientsOk);
      }
    }
    pList = dt.removeDuplicates(pList);
    var patients = pList.map(function(patientId) {
      var ret = dt.patients[patientId];
      ret.nhsNumber = dt.patLookup ? dt.patLookup[patientId] : patientId;
      ret.patientId = patientId;
      ret.items = []; //The fields in the patient list table
      ret.items.push(dt.numberOfStandardsMissed(patientId));
      return ret;
    });

    return patients;
  },

  get: function(callback, json) {
    //get text
    $.getJSON("data/text.json?v=" + Math.random(), function(textfile) {
      dt.text = textfile.pathways;

      if (json) {
        dt.newload(json);
        if (typeof callback === 'function') callback();
      } else {
        $.getJSON("data/data.json?v=" + Math.random(), function(file) {
          dt.newload(file);
          if (typeof callback === 'function') callback();
        }).fail(function(err) {
          alert("data/data.json failed to load!! - if you've changed it recently check it's valid json at jsonlint.com");
        });
      }

    }).fail(function(err) {
      alert("data/text.json failed to load!! - if you've changed it recently check it's valid json at jsonlint.com");
    });
  },

  newload: function(file) {
    dt.indicators = file.indicators;
    dt.pathwayNames = {};

    dt.indicators.forEach(function(indicator) {
      var last = indicator.values[0].length-1;
      var pathwayId = indicator.id.split(".")[0];
      var pathwayStage = indicator.id.split(".")[1];
      var standard = indicator.id.split(".")[2];
      if (!dt.pathwayNames[pathwayId]) dt.pathwayNames[pathwayId] = "";
      var percentage = Math.round(100 * indicator.values[1][last] * 100 / indicator.values[2][last]) / 100;
      indicator.performance = {
        fraction: indicator.values[1][last] + "/" + indicator.values[2][last],
        percentage: percentage
      };
      indicator.benchmark = "90%"; //TODO magic number
      indicator.target = indicator.values[3][last] * 100 + "%";
      indicator.up = percentage > Math.round(100 * indicator.values[1][last-1] * 100 / indicator.values[2][last-1]) / 100;
      var trend = indicator.values[1].map(function(val, idx) {
        return Math.round(100 * val * 100 / indicator.values[2][idx]) / 100;
      }).slice(1, 10);
      //trend.reverse();
      indicator.trend = trend.join(",");
      var dates = indicator.values[0].slice(Math.max(1,last-10), 10);
      //dates.reverse();
      indicator.dates = dates;
      if (dt.text[pathwayId] && dt.text[pathwayId][pathwayStage] && dt.text[pathwayId][pathwayStage].standards[standard]) {
        indicator.description = dt.text[pathwayId][pathwayStage].standards[standard].description;
        indicator.tagline = dt.text[pathwayId][pathwayStage].standards[standard].tagline;
        indicator.positiveMessage = dt.text[pathwayId][pathwayStage].standards[standard].positiveMessage;
      } else {
        indicator.description = "No description specified";
        indicator.tagline = "";
      }
      indicator.aboveTarget = indicator.performance.percentage > +indicator.values[3][last]*100;

      dt.indicators[indicator.id] = { performance: indicator.performance, tagline: indicator.tagline, positiveMessage: indicator.positiveMessage, target: indicator.target, "opportunities": indicator.opportunities || [], "patients": {} };

      //apply which categories people belong to
      dt.patients = {};
      dt.patientArray = [];

      Object.keys(file.patients).forEach(function(patient) {
        dt.patientArray.push(patient);
        dt.patients[patient] = file.patients[patient];
        dt.indicators[indicator.id].patients[patient] = {};
        dt.indicators[indicator.id].patients[patient].opportunities = [];
        dt.indicators[indicator.id].opportunities.forEach(function(opp, idx) {
          if (opp.patients.indexOf(+patient) > -1) {
            dt.indicators[indicator.id].patients[patient].opportunities.push(idx);
          }
        });
      });
    });


  },

  load: function(file) {
    var d = "",
      j, k, key, data = file.diseases;

    dt = jQuery.extend(dt, data); //copy

    dt.patients = file.patients;
    dt.codes = file.codes;
    dt.patientArray = [];
    for (var o in file.patients) {
      if (file.patients.hasOwnProperty(o)) {
        dt.patientArray.push(o);
      }
    }

    for (d in data) {
      dt.pathwayNames[d] = data[d]["display-name"];
      var diseaseObject = {
        "id": d,
        "link": data[d].link ? data[d].link : "dt/" + d,
        "faIcon": data[d].icon,
        "name": data[d]["display-name"],
        "text": {
          "dt": {
            "tooltip": data[d]["side-panel-tooltip"]
          }
        }
      };
      if (data[d].monitoring.text) {
        diseaseObject.text.monitoring = data[d].monitoring.text.sidePanel;
      }
      if (data[d].treatment.text) {
        diseaseObject.text.treatment = data[d].treatment.text.sidePanel;
      }
      if (data[d].diagnosis.text) {
        diseaseObject.text.diagnosis = data[d].diagnosis.text.sidePanel;
      }
      if (data[d].exclusions.text) {
        diseaseObject.text.exclusions = data[d].exclusions.text.sidePanel;
      }
      this.diseases.push(diseaseObject);
      dt[d].suggestions = log.plan[d].team;
      $.extend(dt[d].monitoring, {
        "breakdown": [],
        "bdown": {}
      });
      $.extend(dt[d].treatment, {
        "breakdown": [],
        "bdown": {}
      });
      $.extend(dt[d].diagnosis, {
        "breakdown": [],
        "bdown": {}
      });
      $.extend(dt[d].exclusions, {
        "breakdown": [],
        "bdown": {}
      });

      if (!dt[d].monitoring.header) continue;
      for (key in dt[d].monitoring.standards) {
        this.options.push({
          "value": this.options.length,
          "pathwayId": d,
          "pathwayStage": "monitoring",
          "standard": key,
          "text": this.pathwayNames[d] + ' - ' + "Monitoring" + ' - ' + dt[d].monitoring.standards[key].tab.title
        });
        for (j = 0; j < dt[d].monitoring.standards[key].opportunities.length; j++) {
          dt[d].monitoring.bdown[dt[d].monitoring.standards[key].opportunities[j].name] = dt[d].monitoring.standards[key].opportunities[j];
          dt[d].monitoring.bdown[dt[d].monitoring.standards[key].opportunities[j].name].suggestions = log.plan[d].monitoring.individual[dt[d].monitoring.standards[key].opportunities[j].name];
          for (k = 0; k < dt[d].monitoring.standards[key].opportunities[j].patients.length; k++) {
            if (!dt.patients[dt[d].monitoring.standards[key].opportunities[j].patients[k]].breach) dt.patients[dt[d].monitoring.standards[key].opportunities[j].patients[k]].breach = [];
            dt.patients[dt[d].monitoring.standards[key].opportunities[j].patients[k]].breach.push({
              "pathwayId": d,
              "pathwayStage": "monitoring",
              "standard": key,
              "subsection": dt[d].monitoring.standards[key].opportunities[j].name
            });
          }
        }
      }
      for (key in dt[d].diagnosis.standards) {
        this.options.push({
          "value": this.options.length,
          "pathwayId": d,
          "pathwayStage": "diagnosis",
          "standard": key,
          "text": this.pathwayNames[d] + ' - ' + "Diagnosis" + ' - ' + dt[d].diagnosis.standards[key].tab.title
        });
        for (j = 0; j < dt[d].diagnosis.standards[key].opportunities.length; j++) {
          dt[d].diagnosis.bdown[dt[d].diagnosis.standards[key].opportunities[j].name] = dt[d].diagnosis.standards[key].opportunities[j];
          dt[d].diagnosis.bdown[dt[d].diagnosis.standards[key].opportunities[j].name].suggestions = log.plan[d].diagnosis.individual[dt[d].diagnosis.standards[key].opportunities[j].name];
          for (k = 0; k < dt[d].diagnosis.standards[key].opportunities[j].patients.length; k++) {
            if (!dt.patients[dt[d].diagnosis.standards[key].opportunities[j].patients[k]].breach) dt.patients[dt[d].diagnosis.standards[key].opportunities[j].patients[k]].breach = [];
            dt.patients[dt[d].diagnosis.standards[key].opportunities[j].patients[k]].breach.push({
              "pathwayId": d,
              "pathwayStage": "diagnosis",
              "standard": key,
              "subsection": dt[d].diagnosis.standards[key].opportunities[j].name
            });
          }
        }
      }
      for (key in dt[d].treatment.standards) {
        this.options.push({
          "value": this.options.length,
          "pathwayId": d,
          "pathwayStage": "treatment",
          "standard": key,
          "text": this.pathwayNames[d] + ' - ' + "Treatment" + ' - ' + dt[d].treatment.standards[key].tab.title
        });
        for (j = 0; j < dt[d].treatment.standards[key].opportunities.length; j++) {
          dt[d].treatment.bdown[dt[d].treatment.standards[key].opportunities[j].name] = dt[d].treatment.standards[key].opportunities[j];
          dt[d].treatment.bdown[dt[d].treatment.standards[key].opportunities[j].name].suggestions = log.plan[d].treatment.individual[dt[d].treatment.standards[key].opportunities[j].name];
          for (k = 0; k < dt[d].treatment.standards[key].opportunities[j].patients.length; k++) {
            if (!dt.patients[dt[d].treatment.standards[key].opportunities[j].patients[k]].breach) dt.patients[dt[d].treatment.standards[key].opportunities[j].patients[k]].breach = [];
            dt.patients[dt[d].treatment.standards[key].opportunities[j].patients[k]].breach.push({
              "pathwayId": d,
              "pathwayStage": "treatment",
              "standard": key,
              "subsection": dt[d].treatment.standards[key].opportunities[j].name
            });
          }
        }
      }
      for (key in dt[d].exclusions.standards) {
        this.options.push({
          "value": this.options.length,
          "pathwayId": d,
          "pathwayStage": "exclusions",
          "standard": key,
          "text": this.pathwayNames[d] + ' - ' + "Exclusions" + ' - ' + dt[d].exclusions.standards[key].tab.title
        });
        for (j = 0; j < dt[d].exclusions.standards[key].opportunities.length; j++) {
          dt[d].exclusions.bdown[dt[d].exclusions.standards[key].opportunities[j].name] = dt[d].exclusions.standards[key].opportunities[j];
          dt[d].exclusions.bdown[dt[d].exclusions.standards[key].opportunities[j].name].suggestions = log.plan[d].exclusions.individual[dt[d].exclusions.standards[key].opportunities[j].name];
          for (k = 0; k < dt[d].exclusions.standards[key].opportunities[j].patients.length; k++) {
            if (!dt.patients[dt[d].exclusions.standards[key].opportunities[j].patients[k]].breach) dt.patients[dt[d].exclusions.standards[key].opportunities[j].patients[k]].breach = [];
            dt.patients[dt[d].exclusions.standards[key].opportunities[j].patients[k]].breach.push({
              "pathwayId": d,
              "pathwayStage": "exclusions",
              "standard": key,
              "subsection": dt[d].exclusions.standards[key].opportunities[j].name
            });
          }
        }
      }
    }
  },

  getAllIndicatorData: function(callback) {
    if (dt.indicators) {
      return callback(dt.indicators);
    } else {
      _getAllIndicatorData(callback);
    }
  },

  getAllIndicatorDataSync: function() {
    if (dt.indicators) {
      return dt.indicators;
    } else {
      return _getAllIndicatorDataSync();
    }
  },

  getIndicatorData: function(indicator, callback) {
    if (!dt.indicators) {
      _getAllIndicatorData(function(data) {
        _getIndicatorData(indicator, callback);
      });
    } else if (dt.indicators && dt.indicators[indicator]) {
      return callback(dt.indicators[indicator]);
    } else {
      _getIndicatorData(indicator, callback);
    }
  },

  getIndicatorDataSync: function(indicator) {
    dt.getAllIndicatorDataSync();
    if (dt.indicators[indicator]) {
      return dt.indicators[indicator];
    } else {
      return _getIndicatorDataSync(indicator);
    }
  },

  getPatientData: function(patientId, callback) {
    return _getPatientData(patientId, callback);
  }

};

module.exports = dt;

},{"./log.js":11,"./lookup.js":12}],10:[function(require,module,exports){
var data = require('./data.js'),
Mustache = require('mustache');

var layout = {

  elements: {},

  //Side panel, navigation, header bar and main page
  showMainView: function() {
    //Set up navigation panel
    ////layout.showSidePanel();
    ////layout.showNavigation(data.diseases, idx, $('#main-dashboard'));

    $('#bottomnavbar').hide();
    layout.showHeaderBarItems();

    //Show main dashboard page
    layout.showPage('main-dashboard');
  },

  clearNavigation: function() {
    $("aside.left-panel nav.navigation > ul > li > ul").slideUp(300);
    $("aside.left-panel nav.navigation > ul > li").removeClass('active');
  },

  showNavigation: function(list, idx, parent) {
    if (layout.elements.navigation) {

      if (idx === -1) {
        layout.clearNavigation();
        $('aside a[href="#welcome"]:first').closest('li').addClass('active');
      } else if (idx >= list.length) {
        layout.clearNavigation();
        $('aside a[href="#patients"]').closest('li').addClass('active');
      } else if (!$('aside a[href="#' + list[idx].link + '"]:first').closest('li').hasClass('active')) {
        layout.clearNavigation();
        //set active
        $('aside a[href="#' + list[idx].link + '"]').next().slideToggle(300);
        $('aside a[href="#' + list[idx].link + '"]').closest('li').addClass('active');
      }

      return;
    }

    var tempMust = $('#pathway-picker').html();
    var itemTemplate = $('#pathway-picker-item').html();
    Mustache.parse(tempMust);
    Mustache.parse(itemTemplate);

    list = list.slice();
    list[0].isBreakAbovePractice = true;
    for (var i = 0; i < list.length; i++) {
      list[i].hasSubItems = true;
    }
    list.unshift({
      "link": "welcome",
      "faIcon": "fa-home",
      "name": "Agreed actions",
      "isBreakAboveHome": true,
      "text": {
        "main": {
          "tooltip": "Agreed tooltip - edit in script.js"
        }
      }
    });
    list.push({
      "link": "patients",
      "faIcon": "fa-users",
      "name": "All Patients",
      "isBreakAbovePatient": true,
      "text": {
        "main": {
          "tooltip": "All patients tooltip - edit in script.js"
        }
      }
    });

    list.map(function(v, i, arr) {
      v.isSelected = i === idx + 1;
      return v;
    });

    var renderedBefore = Mustache.render(tempMust, {
      "items": list
    }, {
      "item": itemTemplate,
      "subItem": $('#pathway-picker-sub-item').html()
    });
    $('#aside-toggle nav:first').html(renderedBefore);

    $('.user').on('click', function() {
      template.loadContent('#agreedactions');
    });

    layout.elements.navigation = true;
  },

  showPage: function(page) {
    if (layout.page === page) return;
    layout.page = page;
    $('.page').hide();
    $('#' + page).show();

    if (page !== 'main-dashboard') {
      ////layout.hideSidePanel();
      $('#bottomnavbar').show();
      layout.hideHeaderBarItems();
    }
  },

  showSidePanel: function() {
    if (layout.elements.navigtion) return;
    layout.elements.navigtion = true;
    $('#main').addClass('content');
    $('#topnavbar').addClass('full');
    $('#aside-toggle').show();
    $('#bottomnavbar').hide();
  },

  hideSidePanel: function() {
    if (layout.elements.navigtion === false) return;
    layout.elements.navigtion = false;
    $('#main').removeClass('content');
    $('#topnavbar').removeClass('full');
    $('#aside-toggle').hide();
    $('#bottomnavbar').show();
  },

  showHeaderBarItems: function() {
    if (layout.elements.headerbar) return;
    layout.elements.headerbar = true;
    $('.hide-if-logged-out').show();
  },

  hideHeaderBarItems: function() {
    if (layout.elements.headerbar === false) return;
    layout.elements.headerbar = false;
    $('.hide-if-logged-out').hide();
  }

};

module.exports = layout;

},{"./data.js":9,"mustache":4}],11:[function(require,module,exports){
var notify = require('./notify.js');

var log = {
  reason: {},

  getObj: function(options) {
    var obj = JSON.parse(localStorage.bb);

    if (options && options.length > 0) {
      options.forEach(function(opt) {
        if (!obj[opt.name]) {
          obj[opt.name] = opt.value;
          log.setObj(obj);
        }
      });
    }

    return obj;
  },

  setObj: function(obj) {
    localStorage.bb = JSON.stringify(obj);
  },

  loadActions: function(callback) {
    var r = Math.random();
    $.getJSON("action-plan.json?v=" + r, function(file) {
      log.plan = file.diseases;
      log.text = file.plans;
      callback();
    });
  },

  editAction: function(id, actionId, agree, done, reason) {
    var logText, obj = log.getObj([{
      name: "actions",
      value: {}
    }]);
    if (!id) alert("ACTION TEAM/IND ID");
    if (!actionId) alert("ACTION ID");

    if (!obj.actions[id]) {
      obj.actions[id] = {};
    }


    if (agree) {
      logText = "You agreed with this suggested action on " + (new Date()).toDateString();
    } else if (agree === false) {
      var reasonText = log.reason.reason === "" && log.reason.reasonText === "" ? " - no reason given" : " . You disagreed because you said: '" + log.reason.reason + "; " + log.reason.reasonText + ".'";
      logText = "You disagreed with this action on " + (new Date()).toDateString() + reasonText;
    }

    if (done) {
      logText = "You agreed with this suggested action on " + (new Date()).toDateString();
    }

    if (!obj.actions[id][actionId]) {
      obj.actions[id][actionId] = {
        "agree": agree ? agree : false,
        "done": done ? done : false,
        "history": [logText]
      };
    } else {
      if (agree === true || agree === false) obj.actions[id][actionId].agree = agree;
      if (done === true || done === false) obj.actions[id][actionId].done = done;
      if (logText) {
        if (obj.actions[id][actionId].history) obj.actions[id][actionId].history.unshift(logText);
        else obj.actions[id][actionId].done.history = [logText];
      }
    }

    if (reason && obj.actions[id][actionId].agree === false) {
      obj.actions[id][actionId].reason = reason;
    } else {
      delete obj.actions[id][actionId].reason;
    }

    log.setObj(obj);
    notify.showSaved();
  },

  ignoreAction: function(id, actionId) {
    var obj = log.getObj([{
      name: "actions",
      value: {}
    }]);
    obj.actions[id][actionId].agree = null;
    delete obj.actions[id][actionId].reason;
    log.setObj(obj);
  },

  getActions: function() {
    return log.getObj([{
      name: "actions",
      value: {}
    }]).actions;
  },

  listActions: function(id, pathwayId) {
    var obj = log.getObj([{
      name: "actions",
      value: {}
    }]);
    arr = [];
    if (!id) return obj.actions;
    if (!obj.actions[id]) return arr;
    for (var prop in obj.actions[id]) {
      obj.actions[id][prop].id = prop;
      if (!obj.actions[id][prop].text)
        arr.push(obj.actions[id][prop]);
    }
    return arr;
  },

  //id is either "team" or the patientId
  recordFeedback: function(pathwayId, id, suggestion, reason, reasonText) {
    log.reason = {
      "reason": reason,
      "reasonText": reasonText
    };
    var obj = log.getObj([{
      name: "feedback",
      value: []
    }]);

    var item = {
      "pathwayId": pathwayId,
      "id": id,
      "val": suggestion
    };
    if (reasonText !== "") item.reasonText = reasonText;
    if (reason !== "") item.reason = reason;
    obj.feedback.push(item);
    log.setObj(obj);
  },

  getEvents: function() {
    return log.getObj([{
      name: "events",
      value: []
    }]).events;
  },

  recordEvent: function(pathwayId, id, name) {
    var obj = log.getObj([{
      name: "events",
      value: []
    }]);
    obj.events.push({
      "pathwayId": pathwayId,
      "id": id,
      "name": name,
      "date": new Date()
    });
    log.setObj(obj);
  },

  recordPlan: function(id, text, pathwayId) {
    if (!id) alert("PLAN");
    var obj = log.getObj([{
      name: "actions",
      value: {}
    }]);

    if (!obj.actions[id]) obj.actions[id] = {};
    var planId = Date.now() + "";
    obj.actions[id][planId] = {
      "text": text,
      "agree": null,
      "done": false,
      "pathwayId": pathwayId,
      "history": ["You added this on " + (new Date()).toDateString()]
    };

    log.setObj(obj);
    return planId;
  },

  findPlan: function(obj, planId) {
    for (var k in obj.actions) {
      if (obj.actions[k][planId] && obj.actions[k][planId].text) return k;
    }
    return -1;
  },

  editPlan: function(planId, text, done) {
    var obj = log.getObj([{
      name: "actions",
      value: {}
    }]);
    var id = log.findPlan(obj, planId);
    if (text) obj.actions[id][planId].text = text;
    if (done === true || done === false) obj.actions[id][planId].done = done;
    log.setObj(obj);
  },

  deletePlan: function(planId) {
    var obj = log.getObj([{
      name: "actions",
      value: {}
    }]);
    var id = log.findPlan(obj, planId);
    delete obj.actions[id][planId];
    log.setObj(obj);
  },

  listPlans: function(id, pathwayId) {
    var obj = log.getObj([{
        name: "actions",
        value: {}
      }]),
      arr = [];
    if (!id) return obj.actions;
    for (var prop in obj.actions[id]) {
      obj.actions[id][prop].id = prop;
      if ((!pathwayId || pathwayId === obj.actions[id][prop].pathwayId) && obj.actions[id][prop].text) arr.push(obj.actions[id][prop]);
    }
    return arr;
  },

  getReason: function(id, actionId) {
    var obj = log.getObj([{
      name: "actions",
      value: {}
    }]);

    if (obj.actions[id] && obj.actions[id][actionId]) return obj.actions[id][actionId].reason;
    return null;
  },

  getAgreeReason: function(pathwayId, pathwayStage, standard, patientId, item) {
    var obj = log.getObj([{
      name: "agrees",
      value: {}
    }]);
    if (!pathwayId || !pathwayStage) alert("EDITPATIENTAGREE");

    if (!obj.agrees[patientId]) obj.agrees[patientId] = [];
    var items = obj.agrees[patientId].filter(function(val) {
      return val.pathwayId === pathwayId && val.pathwayStage === pathwayStage && val.standard === standard && val.item === item;
    });

    return items.length === 1 ? items[0].reason || {} : {};
  },

  editPatientAgree: function(pathwayId, pathwayStage, standard, patientId, item, agree, reason) {
    var obj = log.getObj();
    if (!pathwayId || !pathwayStage) alert("EDITPATIENTAGREE");

    if (!obj.agrees[patientId]) obj.agrees[patientId] = [];
    var items = obj.agrees[patientId].filter(function(val) {
      return val.pathwayId === pathwayId && val.pathwayStage === pathwayStage && val.standard === standard && val.item === item;
    });

    var logText = "You " + (agree ? "" : "dis") + "agreed with this on " + (new Date()).toDateString();

    if (items.length === 1) {
      items[0].agree = agree;
      items[0].history.push(logText);
      items[0].reason = reason;
    } else if (items.length === 0) {
      obj.agrees[patientId].push({
        "pathwayId": pathwayId,
        "pathwayStage": pathwayStage,
        "standard": standard,
        "item": item,
        "agree": agree,
        "reason": reason,
        "history": [logText]
      });
    } else {
      console.log("ERRORRR!!!!!!!");
    }

    log.setObj(obj);
    notify.showSaved();
  },

  getAgrees: function(){
    return log.getObj([{
      name: "agrees",
      value: {}
    }]).agrees;
  },

  getPatientAgreeObject: function(pathwayId, pathwayStage, standard, patientId, item) {
    var obj = log.getObj([{
      name: "agrees",
      value: {}
    }]);
    if (!pathwayId || !pathwayStage) alert("EDITPATIENTAGREE");

    if (!obj.agrees[patientId]) obj.agrees[patientId] = [];
    var items = obj.agrees[patientId].filter(function(val) {
      return val.pathwayId === pathwayId && val.pathwayStage === pathwayStage && val.standard === standard && val.item === item;
    });
    if (items.length === 1) return items[0];
    return {};
  },

  getPatientAgree: function(pathwayId, pathwayStage, standard, patientId, item) {
    var obj = log.getObj([{
      name: "agrees",
      value: {}
    }]);

    if (!obj.agrees[patientId]) return null;
    var item2 = obj.agrees[patientId].filter(function(val) {
      return val.pathwayId === pathwayId && val.pathwayStage === pathwayStage && val.standard === standard && val.item === item;
    });

    if (item.length === 1) {
      return item[0].agree;
    }
    return null;
  }

};

module.exports = log;

},{"./notify.js":14}],12:[function(require,module,exports){
module.exports = {
  "currentUrl": "",
  "options": [],
  "categories": {
    "diagnosis": {
      "name": "diagnosis",
      "display": "Diagnosis"
    },
    "monitoring": {
      "name": "monitoring",
      "display": "Monitoring"
    },
    "treatment": {
      "name": "treatment",
      "display": "Control"
    },
    "exclusions": {
      "name": "exclusions",
      "display": "Exclusions"
    }
  },
  "charts": {},
  "pathwayId": "htn",
  "colors": ['#1f77b4', '#ff7f0e', '#2ca02c', '#d62728', '#9467bd', '#8c564b', '#e377c2', '#7f7f7f', '#bcbd22', '#17becf'],
  "monitored": {
    "bp": "Blood Pressure",
    "asthma": "Peak Expiratory Flow"
  }
};

},{}],13:[function(require,module,exports){
var template = require('./template.js'),
  data = require('./data.js'),
  base = require('./base.js'),
  layout = require('./layout.js'),
  welcome = require('./panels/welcome.js'),
  log = require('./log.js'),
  patientView = require('./views/patient.js'),
  Mustache = require('mustache');

var states, patLookup, page, hash;

console.log("main.js: data.lastloader= " + data.lastloader);
data.lastloader = "main.js";

var main = {
  "version": "2.0.0",

  hash: hash,
  init: function() {
    main.preWireUpPages();

    log.loadActions(function() {
      data.get(main.wireUpPages);
    });
  },

  onSelected: function($e, nhsNumberObject) {
    //Hide the suggestions panel
    $('#search-box').find('.tt-dropdown-menu').css('display', 'none');

    history.pushState(null, null, '#patients/' + nhsNumberObject.id);
    template.loadContent('#patients/' + nhsNumberObject.id, true);


    //template.displaySelectedPatient(nhsNumberObject.id);
  },

  wireUpSearchBox: function() {
    if (states) {
      states.clearPrefetchCache();
    }

    states = new Bloodhound({
      datumTokenizer: Bloodhound.tokenizers.obj.whitespace('value'),
      queryTokenizer: Bloodhound.tokenizers.whitespace,
      local: $.map(data.patientArray, function(state) {
        return {
          id: state,
          value: data.patLookup && data.patLookup[state] ? data.patLookup[state] : state
        };
      })
    });

    states.initialize(true);

    $('#search-box').find('.typeahead').typeahead('destroy');
    $('#search-box').find('.typeahead').typeahead({
        hint: true,
        highlight: true,
        minLength: 1,
        autoselect: true
      }, {
        name: 'patients',
        displayKey: 'value',
        source: states.ttAdapter(),
        templates: {
          empty: [
              '<div class="empty-message">',
                '&nbsp; &nbsp; No matches',
              '</div>'
            ].join('\n')
        }
      }).on('typeahead:selected', main.onSelected)
      .on('typeahead:autocompleted', main.onSelected);

    $('#searchbtn').on('mousedown', function() {
      var val = $('.typeahead').eq(0).val();
      if (!val || val === "") val = $('.typeahead').eq(1).val();
      main.onSelected(null, {
        "id": val
      });
    });
  },

  wireUpPages: function() {
    base.wireUpTooltips();
    main.wireUpSearchBox();

    $('#data-file').on('change', function(evt) {
      $('#data-file-wrapper').addClass('disabled').text("Loading...");
      var file = evt.target.files[0]; // FileList object
      var reader = new FileReader();

      reader.onload = (function() {
        return function(e) {
          var JsonObj = JSON.parse(e.target.result);
          data.get(null, JsonObj);
          console.log(JsonObj);

          main.wireUpSearchBox();

          setTimeout(function() {
            if (!$('#patient-file-wrapper').is(':visible')) {
              $('#file-loader').hide(500);
            } else {
              $('#data-file-wrapper').hide(500);
            }
            template.loadContent('#overview');
          }, 1000);
        };
      })(file);

      reader.readAsText(file);
    });

    $('#patient-file').on('change', function(evt) {
      $('#patient-file-wrapper').addClass('disabled').text("Loading...");
      var file = evt.target.files[0]; // FileList object
      var reader = new FileReader();

      reader.onload = (function() {
        return function(e) {
          var lines = e.target.result.split("\n");
          data.patLookup = {};
          for (var i = 0; i < lines.length; i++) {
            var fields = lines[i].split("\t");
            if (fields.length !== 2) continue;
            data.patLookup[fields[0].trim()] = fields[1].trim();
          }

          main.wireUpSearchBox();

          setTimeout(function() {
            if (!$('#data-file-wrapper').is(':visible')) {
              $('#file-loader').hide(500);
            } else {
              $('#patient-file-wrapper').hide(500);
            }
            template.loadContent('#overview');
          }, 1000);
        };
      })(file);

      reader.readAsText(file);
    });

    $('#outstandingTasks').on('click', function(e) {
      e.preventDefault();

      $('#welcome-tabs li').removeClass('active');
      $(this).closest('li').addClass('active');
      var tempMust = $('#welcome-task-list').html();
      var rendered = Mustache.render(tempMust);
      $('#welcome-tab-content').fadeOut(100, function() {
        $(this).html(rendered);
        welcome.populate();
        $(this).fadeIn(100);
      });
    });

    $('#completedTasks').on('click', function(e) {
      e.preventDefault();

      $('#welcome-tabs li').removeClass('active');
      $(this).closest('li').addClass('active');
      var tempMust = $('#welcome-task-list').html();
      var rendered = Mustache.render(tempMust);
      $('#welcome-tab-content').fadeOut(100, function() {
        $(this).html(rendered);
        welcome.populate(true);
        $(this).fadeIn(100);
      });
    });

    if (main.hash !== location.hash) location.hash = main.hash;
    template.loadContent(location.hash, true);
  },

  preWireUpPages: function() {
      layout.showPage('login');

      //Every link element stores href in history
      $(document).on('click', 'a.history', function() {
        // keep the link in the browser history
        history.pushState(null, null, this.href);
        template.loadContent(location.hash, true);
        // do not give a default action
        return false;
      });

      //Called when the back button is hit
      $(window).on('popstate', function(e) {
        template.loadContent(location.hash, true);
      });

      //Templates
      patientsPanelTemplate = $('#patients-panel');
      actionPlanPanel = $('#action-plan-panel');
      patientList = $('#patient-list');
      suggestedPlanTemplate = $('#suggested-plan-template');
      individualPanel = $('#individual-panel');
      valueTrendPanel = $('#value-trend-panel');
      medicationPanel = $('#medications-panel');
      actionPlanList = $('#action-plan-list');

      //Selectors
      bottomLeftPanel = $('#bottom-left-panel');
      bottomRightPanel = $('#bottom-right-panel');
      topPanel = $('#top-panel');
      topLeftPanel = $('#top-left-panel');
      topRightPanel = $('#top-right-panel');
      midPanel = $('#mid-panel');
      farLeftPanel = $('#left-panel');
      farRightPanel = $('#right-panel');
    }
    /*,
      "_local": local*/
};

module.exports = main;

},{"./base.js":7,"./data.js":9,"./layout.js":10,"./log.js":11,"./panels/welcome.js":34,"./template.js":36,"./views/patient.js":40,"mustache":4}],14:[function(require,module,exports){
module.exports = {

  showSaved: function() {
    $("#saved-message").hide().toggleClass("in").fadeIn(300);
    window.setTimeout(function() {
      $("#saved-message").fadeOut(300, function() {
        $(this).toggleClass("in");
      });
    }, 2000);
  }

};

},{}],15:[function(require,module,exports){
var base = require('../base.js'),
  data = require('../data.js'),
  qualityStandard = require('./qualityStandard.js'),
  otherCodes = require('./otherCodes.js'),
  medication = require('./medication.js'),
  trend = require('./trend.js'),
  individualActionPlan = require('./individualActionPlan.js'),
  layout = require('../layout.js'),
  chart = require('../chart.js'),
  Mustache = require('mustache');

var all = {

  populate: function() {
    var patients = data.getAllPatients();

    var localData = {
      "patients": patients,
      "n": patients.length,
      "header-items": [{
        "title": "NHS no.",
        "isUnSortable": true
      }, {
        "title": "All Opportunities",
        "titleHTML": '# of <i class="fa fa-flag" style="color:red"></i>',
        "isUnSortable": true,
        "tooltip": "Total number of improvement opportunities available across all conditions"
      }]
    };

    localData.patients.sort(function(a, b) {
      if (a.items[0] === b.items[0]) {
        return 0;
      }
      var A = Number(a.items[0]);
      var B = Number(b.items[0]);
      if (isNaN(A) || isNaN(B)) {
        A = a.items[0];
        B = b.items[0];
      }
      if (A > B) {
        return -1;
      } else if (A < B) {
        return 1;
      }
    });

    base.createPanelShow(patientList, patientsPanel, localData, {
      "header-item": $("#patient-list-header-item").html(),
      "item": $('#patient-list-item').html()
    });

    $('#patients-placeholder').hide();

    base.setupClipboard($('.btn-copy'), true);

    base.wireUpTooltips();

    var c = patientsPanel.find('div.table-scroll').getNiceScroll();
    if (c && c.length > 0) {
      c.resize();
    } else {
      patientsPanel.find('div.table-scroll').niceScroll({
        cursoropacitymin: 0.3,
        cursorwidth: "7px",
        horizrailenabled: false
      });
    }
  },

  //Show patient view from the all patient screen
  showIndividualPatientView: function(pathwayId, pathwayStage, standard, patientId) {
    data.patientId = patientId;

    data.options.sort(function(a, b) {
      a = data.getPatientStatus(patientId, a.pathwayId, a.pathwayStage, a.standard);
      b = data.getPatientStatus(patientId, b.pathwayId, b.pathwayStage, b.standard);

      if (a === b) return 0;
      if (a === "not") return 1;
      if (b === "not") return -1;
      if (a === "ok") return 1;
      if (b === "ok") return -1;
      alert("!!!!!!!");
    });

    if (pathwayId === null) {
      //Show patient but don't select
      var p = base.createPanel($('#patient-panel'), {
        "options": data.options,
        "numberOfStandardsMissed": data.numberOfStandardsMissed(patientId),
        "nhsNumber": data.patLookup ? data.patLookup[patientId] : patientId,
        "patientId": patientId
      }, {
        "option": $('#patient-panel-drop-down-options').html()
      });
      farRightPanel.html(p).show();
      farRightPanel.removeClass('standard-missed-page').removeClass('standard-achieved-page').removeClass('standard-not-relevant-page');

      $('select').select2({
        templateResult: base.formatStandard,
        minimumResultsForSearch: Infinity,
        placeholder: "Please select an improvement opportunity area..."
      });
      $('span.select2-selection__rendered').attr("title", "");
      $('select').on('change', function() {
        var localData = $(this).find(':selected').data();
        all.showIndividualPatientView(localData.pathwayId, localData.pathwayStage, localData.standard, data.patientId);
      }).on("select2:open", function(e) {
        base.wireUpTooltips();
      });
      return;
    }

    var panel = base.createPanel($('#patient-panel'), {
      "options": data.options,
      "numberOfStandardsMissed": data.numberOfStandardsMissed(patientId),
      "standard": data[pathwayId][pathwayStage].standards[standard].tab.title,
      "pathwayStage": pathwayStage,
      "nhsNumber": data.patLookup ? data.patLookup[patientId] : patientId,
      "patientId": patientId
    }, {
      "option": $('#patient-panel-drop-down-options').html()
    });

    farRightPanel.html("");
    $('#temp-hidden').html(panel);

    var actionPlan = individualActionPlan.create(pathwayStage);
    $('#temp-hidden #patient-panel-right').html(actionPlan);

    var qualPanel = qualityStandard.create(pathwayId, pathwayStage, standard, patientId);
    var trendPanel = trend.create(pathwayId, pathwayStage, standard, patientId);
    var medPanel = medication.create(pathwayId, pathwayStage, standard, patientId);
    var codesPanel = otherCodes.create(pathwayId, pathwayStage, standard, patientId);
    var medCodeWrapperPanel = base.createPanel($('#other-codes-and-meds-wrapper-panel'));
    $('#temp-hidden #patient-panel-top').html(qualPanel);
    $('#temp-hidden #patient-panel-left').html("").append(trendPanel).append(medCodeWrapperPanel);
    $('#temp-hidden #medCodeWrapperPanel').append(medPanel).append(codesPanel);

    if (farRightPanel.is(':visible')) {
      farRightPanel.fadeOut(100, function() {
        $(this).html($('#temp-hidden').html());
        $('#temp-hidden').html("");
        individualActionPlan.wireUp(pathwayId, pathwayStage, standard, patientId);
        qualityStandard.wireUp(pathwayId, pathwayStage, standard, patientId);
        base.wireUpStandardDropDown(pathwayId, pathwayStage, standard, all.showIndividualPatientView);
        trend.wireUp(pathwayId, pathwayStage, standard, patientId);
        medication.wireUp(pathwayId, pathwayStage, standard, patientId);
        otherCodes.wireUp(pathwayId, pathwayStage, standard, patientId);
        chart.drawTrendChart(patientId, pathwayId, pathwayStage, standard);
        $(this).fadeIn(100, function() {});
      });
    } else {
      farRightPanel.html($('#temp-hidden').html());
      $('#temp-hidden').html("");
      individualActionPlan.wireUp(pathwayId, pathwayStage, standard, patientId);
      qualityStandard.wireUp(pathwayId, pathwayStage, standard, patientId);
      base.wireUpStandardDropDown(pathwayId, pathwayStage, standard, all.showIndividualPatientView);
      trend.wireUp(pathwayId, pathwayStage, standard, patientId);
      medication.wireUp(pathwayId, pathwayStage, standard, patientId);
      otherCodes.wireUp(pathwayId, pathwayStage, standard, patientId);
      chart.drawTrendChart(patientId, pathwayId, pathwayStage, standard);
      farRightPanel.fadeIn(100, function() {});
    }
  },

  show: function(location) {
    base.createPanelShow($('#all-patients-panel'), location, {
      "n": data.getAllPatients().length
    });

    patientsPanel = $('#patients');

    patientsPanel.on('click', 'tbody tr', function(e) { //Select individual patient when row clicked
      $('[data-toggle="tooltip"]').tooltip('hide');
      $(this).tooltip('destroy');
      base.clearBox();
      $('.list-item').removeClass('highlighted');
      $(this).addClass('highlighted').removeAttr('title');

      var patientId = $(this).find('td button').attr('data-patient-id');

      all.showIndividualPatientView(null, null, null, patientId);

      e.preventDefault();
      e.stopPropagation();
    }).on('click', 'tbody tr button', function(e) {
      //don't want row selected if just button pressed?
      e.preventDefault();
      e.stopPropagation();
    });
  },

  showView: function(patientId, reload) {
    $('#mainTitle').hide();
    base.updateTitle("List of all patients at your practice");

    if (!patientId) data.pathwayId = "";
    if (!patientId || reload) {

      layout.showMainView(data.diseases.length);

      base.switchTo110Layout();
      base.hideAllPanels();

      all.show(farLeftPanel);
      all.populate();
    }

    if (patientId) {
      all.showIndividualPatientView(null, null, null, patientId);
    } else {
      var tempMust = $('#patient-panel-placeholder').html();
      farRightPanel.html(Mustache.render(tempMust)).show();
    }
  }

};

module.exports = all;

},{"../base.js":7,"../chart.js":8,"../data.js":9,"../layout.js":10,"./individualActionPlan.js":22,"./medication.js":24,"./otherCodes.js":25,"./qualityStandard.js":30,"./trend.js":33,"mustache":4}],16:[function(require,module,exports){
var base = require('../base.js'),
log = require('../log.js');

var confirm = {

  wireUp: function(agreeDivSelector, panelSelector, pathwayId, pathwayStage, standard, patientId, item, disagreeText) {
    confirm.wireUpAgreeDisagree(agreeDivSelector, log.getPatientAgreeObject(pathwayId, pathwayStage, standard, patientId, item));

    panelSelector.on('change', '.btn-toggle input[type=checkbox]', function() {
      confirm.wireUpAgreeDisagree(agreeDivSelector, log.getPatientAgreeObject(pathwayId, pathwayStage, standard, patientId, item));
      base.wireUpTooltips();
    }).on('click', '.btn-toggle', function(e) {
      var checkbox = $(this).find("input[type=checkbox]");
      var other = $(this).parent().find($(this).hasClass("btn-yes") ? ".btn-no" : ".btn-yes");
      var ACTIONID = $(this).closest('tr').data('id');
      if ($(this).hasClass("active") && other.hasClass("inactive")) {
        //unselecting
        if (checkbox.val() === "no") {
          confirm.launchStandardModal("Disagree with " + disagreeText, "?", log.getAgreeReason(pathwayId, pathwayStage, standard, patientId, item), true, function() {
            log.editPatientAgree(pathwayId, pathwayStage, standard, patientId, item, false, log.reason.reasonText);
            confirm.wireUpAgreeDisagree(agreeDivSelector, log.getPatientAgreeObject(pathwayId, pathwayStage, standard, patientId, item));
            base.wireUpTooltips();
          }, null, function() {
            log.editPatientAgree(pathwayId, pathwayStage, standard, patientId, item, null, "");
            other.removeClass("inactive");
            checkbox.removeAttr("checked");
            checkbox.parent().removeClass("active");
            confirm.wireUpAgreeDisagree(agreeDivSelector, log.getPatientAgreeObject(pathwayId, pathwayStage, standard, patientId, item));
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.editPatientAgree(pathwayId, pathwayStage, standard, patientId, item, null);
          other.removeClass("inactive");
        }
      } else if (!$(this).hasClass("active") && other.hasClass("active")) {
        //prevent clicking on unselected option or if the row is complete
        e.stopPropagation();
        e.preventDefault();
        return;
      } else {
        //selecting
        var self = this;
        if (checkbox.val() === "no") {
          confirm.launchStandardModal("Disagree with " + disagreeText, "", "", false, function() {
            log.editPatientAgree(pathwayId, pathwayStage, standard, patientId, item, false, log.reason.reasonText);
            $(self).removeClass("inactive");
            checkbox.attr("checked", "checked");
            checkbox.parent().addClass("active");
            //unselect other
            other.removeClass("active").addClass("inactive");
            other.find("input[type=checkbox]").prop("checked", false);
            confirm.wireUpAgreeDisagree(agreeDivSelector, log.getPatientAgreeObject(pathwayId, pathwayStage, standard, patientId, item));
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.editPatientAgree(pathwayId, pathwayStage, standard, patientId, item, true);
          $(this).removeClass("inactive");

          //unselect other
          other.removeClass("active").addClass("inactive");
          other.find("input[type=checkbox]").prop("checked", false);
        }
      }
    });
  },

  wireUpAgreeDisagree: function(selector, agreeObject) {
    if (agreeObject.agree === true) {
      selector.children(':nth(0)').addClass('active');
      selector.children(':nth(1)').addClass('inactive');
      selector.children(':nth(0)').attr("title", confirm.getAgreeTooltip(agreeObject)).attr("data-original-title", confirm.getAgreeTooltip(agreeObject)).tooltip('fixTitle').tooltip('hide');
      selector.children(':nth(1)').attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
      selector.parent().addClass('success').removeClass('danger');
    } else if (agreeObject.agree === false) {
      selector.children(':nth(0)').addClass('inactive');
      selector.children(':nth(1)').addClass('active');
      selector.children(':nth(0)').attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
      selector.children(':nth(1)').attr("title", confirm.getDisgreeTooltip(agreeObject)).attr("data-original-title", confirm.getDisgreeTooltip(agreeObject)).tooltip('fixTitle').tooltip('hide');
      selector.parent().addClass('danger').removeClass('success');
    } else {
      selector.children(':nth(0)').attr("title", "Click to agree").attr("data-original-title", "Click to agree").tooltip('fixTitle').tooltip('hide');
      selector.children(':nth(1)').attr("title", "Click to disagree").attr("data-original-title", "Click to disagree").tooltip('fixTitle').tooltip('hide');
      selector.parent().removeClass('success').removeClass('danger');
    }
  },

  getAgreeTooltip: function(agreeObject) {
    return agreeObject.history[agreeObject.history.length - 1];
  },

  getDisgreeTooltip: function(agreeObject) {
    return agreeObject.history[agreeObject.history.length - 1] + " You said: " + agreeObject.reason;
  },

  launchStandardModal: function(header, value, reason, isUndo, callbackOnSave, callbackOnCancel, callbackOnUndo) {
    base.launchModal({
      "header": header,
      "isUndo": isUndo,
      "item": value,
      "placeholder": "Provide more information here..."
    }, null, value, reason, callbackOnSave, callbackOnCancel, callbackOnUndo);
  }

};

module.exports = confirm;

},{"../base.js":7,"../log.js":11}],17:[function(require,module,exports){
var base = require('../base.js'),
  data = require('../data.js'),
  chart = require('../chart.js'),
  patientList = require('./patientList.js');

var ID = "INDICATOR_BENCHMARK";

var iTrend = {

  show: function(panel, isAppend, pathwayId, pathwayStage, standard) {

    var elem = $("<div id='benchmark-chart' class='fit-to-scrolling-section-height'></div>");

    if (isAppend) panel.append(elem);
    else panel.html(elem);

    chart.drawBenchmarkChartHC("benchmark-chart", null);

  },

  wireUp: function() {

  }

};

module.exports = iTrend;

},{"../base.js":7,"../chart.js":8,"../data.js":9,"./patientList.js":27}],18:[function(require,module,exports){
var data = require('../data.js'),
  chart = require('../chart.js');

var bd = {

  wireUp: function() {

  },

  show: function(panel, isAppend, pathwayId, pathwayStage, standard, selectSeriesFn) {

    var indicators = data.getIndicatorDataSync([pathwayId, pathwayStage, standard].join("."));

    var dataObj = indicators.opportunities.map(function(opp) {
      return [opp.name, opp.description, opp.patients.length];
    });

    var elem = $("<div id='breakdown-chart'></div>");

    if (isAppend) panel.append(elem);
    else panel.html(elem);

    chart.drawAnalytics("breakdown-chart", dataObj, selectSeriesFn);

    bd.wireUp();

  }

};

module.exports = bd;

},{"../chart.js":8,"../data.js":9}],19:[function(require,module,exports){
var data = require('../data.js'),
  chart = require('../chart.js'),
  Mustache = require('mustache');

var hl = {

  wireUp: function() {

  },

  show: function(panel, isAppend, pathwayId, pathwayStage, standard) {

    var indicators = data.getIndicatorDataSync([pathwayId, pathwayStage, standard].join("."));

    var tempMust = $('#indicator-headline-panel').html();
    var html = Mustache.render(tempMust, indicators);

    if(isAppend) panel.append(html);
    else panel.html(html);

  }

};

module.exports = hl;

},{"../chart.js":8,"../data.js":9,"mustache":4}],20:[function(require,module,exports){
var base = require('../base.js'),
  log = require('../log.js'),
  data = require('../data.js'),
  sparkline = require('jquery-sparkline'),
  Mustache = require('mustache');

var indicatorList = {

  show: function(panel, isAppend, loadContentFn) {
    data.getAllIndicatorData(function(indicators) {
      indicators.sort(function(a,b){
        return a.performance - b.performance;
      });
      var tempMust = $('#overview-panel-table').html();
      var html = Mustache.render(tempMust, {
        "indicators": indicators
      });
      if (isAppend) {
        panel.append(html);
      } else {
        panel.html(html);
      }

      $('.inlinesparkline').sparkline('html', {
        tooltipFormatter: function(sparkline, options, fields) {
          var dts = indicators[$('.inlinesparkline').index(sparkline.el)].dates;
          return dts[dts.length - 1 - fields.x] + ": " + fields.y + "%";
        },
        width: "100px"
      });

      indicatorList.wireUp(panel, loadContentFn);

    });
  },

  populate: function() {

  },

  wireUp: function(panel, loadContentFn) {
    panel.off('click', 'tr.show-more-row a');
    panel.on('click', 'tr.show-more-row a', function(e) {

      // do not give a default action
      //e.preventDefault();
      e.stopPropagation();
      //return false;
    });

    panel.off('click', 'tr.standard-row,tr.show-more-row');
    panel.on('click', 'tr.standard-row,tr.show-more-row', function(e) {
      var url = $(this).data("id").replace(/\./g, "/");
      history.pushState(null, null, '#indicators/' + url);
      loadContentFn('#indicators/' + url);
      // do not give a default action
      e.preventDefault();
      e.stopPropagation();
      return false;
    });

    panel.off('mouseenter', '.show-more-row,.standard-row');
    panel.off('mouseleave', '.show-more-row,.standard-row');
    panel.on('mouseenter', '.show-more-row,.standard-row', function(e){
      var id = $(this).data("id");
      $('.show-more-row[data-id="' + id + '"],.standard-row[data-id="' + id + '"]').addClass('hover');
    });
    panel.on('mouseleave', '.show-more-row,.standard-row', function(e){
      var id = $(this).data("id");
      $('.show-more-row[data-id="' + id + '"],.standard-row[data-id="' + id + '"]').removeClass('hover');
    });

    panel.off('click', '.show-more');
    panel.on('click', '.show-more', function(e) {
      var id = $(this).data("id");
      var elem = $('.show-more-row[data-id="' + id + '"]');
      if(elem.is(':visible')){
        $('.show-more[data-id="' + id + '"]:first').show();
        elem.hide();
      } else {
        $(this).hide();
        elem.show('fast');
      }
      // do not give a default action
      e.preventDefault();
      e.stopPropagation();
      return false;
    });
  }

};

module.exports = indicatorList;

},{"../base.js":7,"../data.js":9,"../log.js":11,"jquery-sparkline":3,"mustache":4}],21:[function(require,module,exports){
var base = require('../base.js'),
  data = require('../data.js'),
  chart = require('../chart.js'),
  patientList = require('./patientList.js');

var ID = "INDICATOR_TREND";

var iTrend = {

  show: function(panel, isAppend, pathwayId, pathwayStage, standard) {

    var indicators = data.getAllIndicatorDataSync();

    var elem = $("<div id='trend-chart' class='fit-to-scrolling-section-height'></div>");

    if (isAppend) panel.append(elem);
    else panel.html(elem);

    chart.drawPerformanceTrendChartHC("trend-chart", indicators.filter(function(v){
      return v.id===[pathwayId, pathwayStage, standard].join(".");
    })[0]);

  },

  wireUp: function() {

  }

};

module.exports = iTrend;

},{"../base.js":7,"../chart.js":8,"../data.js":9,"./patientList.js":27}],22:[function(require,module,exports){
var base = require('../base.js'),
  confirm = require('./confirm.js'),
  data = require('../data.js'),
  log = require('../log.js');

var iap = {

  create: function(pathwayStage) {
    return base.createPanel($('#individual-action-plan-panel'), {
      "pathwayStage": pathwayStage || "default",
      "noHeader": true
    });
  },

  show: function(panel, pathwayId, pathwayStage, standard, patientId) {
    panel.html(iap.create(pathwayStage));
    iap.wireUp(pathwayId, pathwayStage, standard, patientId);

    panel.find('div.fit-to-screen-height').niceScroll({
      cursoropacitymin: 0.3,
      cursorwidth: "7px",
      horizrailenabled: false
    });
  },

  wireUp: function(pathwayId, pathwayStage, standard, patientId) {
    individualTab = $('#tab-plan-individual');

    //find [] and replace with copy button

    $('#advice-list').on('click', '.cr-styled input[type=checkbox]', function() {
      var ACTIONID = $(this).closest('tr').data('id');
      log.editAction(data.patientId, ACTIONID, null, this.checked);

      if (this.checked) {
        log.recordEvent(pathwayId, data.patientId, "Item completed");
        var self = this;
        $(self).parent().attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
        setTimeout(function(e) {
          $(self).parent().fadeOut(300, function() {
            var parent = $(this).parent();
            $(this).replaceWith(base.createPanel($('#checkbox-template'), {
              "done": true
            }));
            base.wireUpTooltips();
            parent.find('button').on('click', function() {
              ACTIONID = $(this).closest('tr').data('id');
              log.editAction(data.patientId, ACTIONID, null, false);
              $(this).replaceWith(base.createPanel($('#checkbox-template'), {
                "done": false
              }));
              iap.updateIndividualSapRows();
            });
          });
        }, 1000);
      }

      iap.updateIndividualSapRows();
    });

    $('#personalPlanIndividual').on('click', 'input[type=checkbox]', function() {
      var PLANID = $(this).closest('tr').data("id");
      log.editPlan(PLANID, null, this.checked);

      if (this.checked) {
        $(this).parent().parent().parent().addClass('success');
        log.recordEvent(pathwayId, data.patientId, "Personal plan item");
        var self = this;
        $(self).parent().attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
        setTimeout(function(e) {
          $(self).parent().fadeOut(300, function() {
            var parent = $(this).parent();
            $(this).replaceWith(base.createPanel($('#checkbox-template'), {
              "done": true
            }));
            base.wireUpTooltips();
            parent.find('button').on('click', function() {
              PLANID = $(this).closest('tr').data('id');
              log.editPlan(data.patientId, PLANID, null, false);
              $(this).replaceWith(base.createPanel($('#checkbox-template'), {
                "done": false
              }));
              iap.updateIndividualSapRows();
            });
          });
        }, 1000);
      }
    }).on('click', '.btn-undo', function(e) {
      var PLANID = $(this).closest('tr').data('id');
      log.editPlan(PLANID, null, false);
      $(this).replaceWith(base.createPanel($('#checkbox-template'), {
        "done": false
      }));
      iap.updateIndividualSapRows();
      e.stopPropagation();
    });

    individualTab.on('click', '.edit-plan', function() {
      var PLANID = $(this).closest('tr').data("id");

      $('#editActionPlanItem').val($($(this).closest('tr').children('td')[0]).find('span').text());

      $('#editPlan').off('hidden.bs.modal').on('hidden.bs.modal', function() {
        iap.displayPersonalisedIndividualActionPlan(data.patientId, $('#personalPlanIndividual'));
      }).off('shown.bs.modal').on('shown.bs.modal', function() {
        $('#editActionPlanItem').focus();
      }).off('click', '.save-plan').on('click', '.save-plan', function() {

        log.editPlan(PLANID, $('#editActionPlanItem').val());

        $('#editPlan').modal('hide');
      }).off('keyup', '#editActionPlanItem').on('keyup', '#editActionPlanItem', function(e) {
        if (e.which === 13) $('#editPlan .save-plan').click();
      }).modal();
    }).on('click', '.delete-plan', function() {
      var PLANID = $(this).closest('tr').data("id");

      $('#individual-delete-item').html($($(this).closest('tr').children('td')[0]).find('span').text());

      $('#deletePlan').off('hidden.bs.modal').on('hidden.bs.modal', function() {
        iap.displayPersonalisedIndividualActionPlan(data.patientId, $('#personalPlanIndividual'));
      }).off('click', '.delete-plan').on('click', '.delete-plan', function() {
        log.deletePlan(PLANID);

        $('#deletePlan').modal('hide');
      }).modal();
    }).on('click', '.add-plan', function() {
      log.recordPlan(data.patientId, $(this).parent().parent().find('textarea').val(), pathwayId);

      iap.displayPersonalisedIndividualActionPlan(data.patientId, $('#personalPlanIndividual'));
    }).on('change', '.btn-toggle input[type=checkbox]', function() {
      iap.updateIndividualSapRows();
    }).on('click', '.btn-undo', function(e) {
      var ACTIONID = $(this).closest('tr').data('id');
      log.editAction(data.patientId, ACTIONID, null, false);
      $(this).replaceWith(base.createPanel($('#checkbox-template'), {
        "done": false
      }));
      iap.updateIndividualSapRows();
    }).on('click', '.btn-yes,.btn-no', function(e) {
      var checkbox = $(this).find("input[type=checkbox]");
      var other = $(this).parent().find($(this).hasClass("btn-yes") ? ".btn-no" : ".btn-yes");
      var ACTIONID = $(this).closest('tr').data('id');
      if ($(this).hasClass("active") && other.hasClass("inactive") && !$(this).closest('tr').hasClass('success')) {
        //unselecting
        if (checkbox.val() === "no") {
          iap.launchModal(data.selected, checkbox.closest('tr').children().first().children().first().text(), log.getReason(data.patientId, ACTIONID), true, function() {
            log.editAction(data.patientId, ACTIONID, false, null, log.reason);
            iap.updateIndividualSapRows();
            base.wireUpTooltips();
          }, null, function() {
            log.ignoreAction(data.patientId, ACTIONID);
            other.removeClass("inactive");
            checkbox.removeAttr("checked");
            checkbox.parent().removeClass("active");
            iap.updateIndividualSapRows();
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.ignoreAction(data.patientId, ACTIONID);
          other.removeClass("inactive");
        }
      } else if ((!$(this).hasClass("active") && other.hasClass("active")) || $(this).closest('tr').hasClass('success')) {
        //prevent clicking on unselected option or if the row is complete
        e.stopPropagation();
        e.preventDefault();
        return;
      } else {
        //selecting
        var self = this;
        if (checkbox.val() === "no") {
          iap.launchModal(data.selected, checkbox.closest('tr').children().first().children().first().text(), log.getReason(data.patientId, ACTIONID), false, function() {
            log.editAction(data.patientId, ACTIONID, false, null, log.reason);
            $(self).removeClass("inactive");

            checkbox.attr("checked", "checked");
            checkbox.parent().addClass("active");
            //unselect other
            other.removeClass("active").addClass("inactive");
            other.find("input[type=checkbox]").prop("checked", false);
            iap.updateIndividualSapRows();
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.editAction(data.patientId, ACTIONID, true);
          $(this).removeClass("inactive");

          //unselect other
          other.removeClass("active").addClass("inactive");
          other.find("input[type=checkbox]").prop("checked", false);
        }
      }
    }).on('keyup', 'input[type=text]', function(e) {
      if (e.which === 13) {
        individualTab.find('.add-plan').click();
      }
    });

    $('#advice-list').off('click', '.show-more');
    $('#advice-list').on('click', '.show-more', function(e) {
      var id = $(this).data("id");
      var elem = $('.show-more-row[data-id="' + id + '"]');
      if(elem.is(':visible')){
        $('.show-more[data-id="' + id + '"]:first').show();
        elem.hide();
      } else {
        $(this).hide();
        elem.show('fast');
      }
      // do not give a default action
      e.preventDefault();
      e.stopPropagation();
      return false;
    });

    iap.populateIndividualSuggestedActions(patientId, pathwayId, pathwayStage, standard);
  },

  updateIndividualSapRows: function() {
    /*$('#advice-list').add('#personalPlanIndividual').find('.suggestion').each(function() {
      $(this).find('td').last().children().hide();
    });*/

    /*$('#advice-list').add('#personalPlanIndividual').find('.cr-styled input[type=checkbox]').each(function() {
      if (this.checked) {
        $(this).parent().parent().parent().addClass('success');
      } else {
        $(this).parent().parent().parent().removeClass('success');
      }
    });*/

    /*$('#advice-list').add('#personalPlanIndividual').find('.btn-undo').each(function() {
      $(this).parent().parent().addClass('success');
    });*/

    //no class - user not yet agreed/disagreed - no background / muted text
    //active - user agrees - green background / normal text
    //success - user completed - green background / strikethrough text
    //danger - user disagrees - red background / strikethrough text

    $('#advice-list').add('#personalPlanIndividual').find('tr.suggestion').each(function() {
      var self = $(this);
      var id = self.data("id");
      var all = $('.show-more-row[data-id="' + id + '"],.suggestion[data-id="' + id + '"]');
      var any = false;
      self.find('.btn-toggle input[type=checkbox]:checked').each(function() {
        any = true;
        if (this.value === "yes") {
          all.removeClass('danger');
          all.addClass('active');
          //self.find('td').last().children().show();
          if (log.getActions()[data.patientId][self.data("id")].history) {
            var tool = $(this).closest('tr').hasClass('success') ? "" : "<p>" + log.getActions()[data.patientId][self.data("id")].history[0] + "</p><p>Click again to cancel</p>";
            $(this).parent().attr("title", tool).attr("data-original-title", tool).tooltip('fixTitle').tooltip('hide');
          } else {
            $(this).parent().attr("title", "You agreed - click again to cancel").tooltip('fixTitle').tooltip('hide');
          }
        } else {
          all.removeClass('active');
          all.addClass('danger');
          all.removeClass('success');
          if (log.getActions()[data.patientId][self.data("id")] && log.getActions()[data.patientId][self.data("id")].history) {
            $(this).parent().attr("title", "<p>" + log.getActions()[data.patientId][self.data("id")].history[0] + "</p><p>Click again to edit/cancel</p>").tooltip('fixTitle').tooltip('hide');
          } else {
            $(this).parent().attr("title", "You disagreed - click again to edit/cancel").tooltip('fixTitle').tooltip('hide');
          }
        }
      });
      if (self.find('.btn-toggle input[type=checkbox]:not(:checked)').length == 1) {
        self.find('.btn-toggle input[type=checkbox]:not(:checked)').parent().addClass("inactive").attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
      }
      if (!any) {
        all.removeClass('danger');
        all.removeClass('active');
        all.removeClass('success');

        self.find('.btn-toggle.btn-yes').attr("title", "Click to agree with this action and save it in your agreed actions list  ").tooltip('fixTitle').tooltip('hide');
        self.find('.btn-toggle.btn-no').attr("title", "Click to disagree with this action and remove it from your suggested actions list ").tooltip('fixTitle').tooltip('hide');
      }

      base.wireUpTooltips();
    });
    base.wireUpTooltips();
  },

  displayPersonalisedIndividualActionPlan: function(id, parentElem) {
    var plans = base.sortSuggestions(base.addDisagreePersonalTeam(log.listPlans(id)));

    base.createPanelShow(actionPlanList, parentElem, {
      "hasSuggestions": plans && plans.length > 0,
      "suggestions": plans
    }, {
      "action-plan": $('#action-plan').html(),
      "action-plan-item": $('#action-plan-item').html(),
      "chk": $('#checkbox-template').html()
    });

    iap.updateIndividualSapRows();
  },

  populateIndividualSuggestedActions: function(patientId, pathwayId, pathwayStage, standard) {
    var localData = {
      "nhsNumber": data.patLookup ? data.patLookup[patientId] : patientId,
      "patientId": patientId
    };

    var patientData = data.getPatientData(patientId);

    var breaches = data.patients[patientId].breach ? data.patients[patientId].breach.filter(function(v) {
      return v.pathwayId === pathwayId && v.pathwayStage === pathwayStage && v.standard === standard;
    }) : [];

    var fn = function(val) {
      return {
        "id": val,
        "subsection": subsection
      };
    };

    if (patientData.actions.length === 0) {
      localData.noSuggestions = true;
    } else {
      /*var suggestions = [],
        subsection = "";
      for (var i = 0; i < breaches.length; i++) {
        subsection = breaches[i].subsection;
        suggestions = suggestions.concat(data[pathwayId][pathwayStage].bdown[subsection].suggestions ?
          data[pathwayId][pathwayStage].bdown[subsection].suggestions.map(fn) : []);
      }*/

      localData.suggestions = base.sortSuggestions(base.mergeIndividualStuff(patientData.actions, patientId));
      /*localData.section = {
        "name": data[pathwayId][pathwayStage].bdown[subsection].name,
        "agree": log.getPatientAgree(pathwayId, pathwayStage, patientId, "section") === true,
        "disagree": log.getPatientAgree(pathwayId, pathwayStage, patientId, "section") === false,
      };
      localData.category = {
        "name": data.patients[patientId].category,
        "agree": log.getPatientAgree(pathwayId, pathwayStage, patientId, "category") === true,
        "disagree": log.getPatientAgree(pathwayId, pathwayStage, patientId, "category") === false,
      };*/
    }

    $('#advice-placeholder').hide();
    $('#advice').show();

    base.createPanelShow(individualPanel, $('#advice-list'), localData);

    //Wire up any clipboard stuff in the suggestions
    $('#advice-list').find('span:contains("[COPY")').each(function() {
      var html = $(this).html();
      $(this).html(html.replace(/\[COPY:([^\]]*)\]/g, '$1 <button type="button" data-clipboard-text="$1" data-content="Copied" data-toggle="tooltip" data-placement="top" title="Copy $1 to clipboard." class="btn btn-xs btn-default btn-copy"><span class="fa fa-clipboard"></span></button>'));
    });
    $('#advice-list').find('span:contains("[")').each(function() {
      var html = $(this).html();
      $(this).html(html.replace(/\[([^\]]*)\]/g, ' <button type="button" data-clipboard-text="$1" data-content="Copied" data-toggle="tooltip" data-placement="top" title="Copy $1 to clipboard." class="btn btn-xs btn-default btn-copy"><span class="fa fa-clipboard"></span></button>'));
    });

    $('#advice-list').find('span:contains("[INFO")').each(function() {
      var html = $(this).html();
      var subsection = $(this).data().subsection;
      var desc = data[pathwayId][pathwayStage].standards[standard].opportunities.filter(function(val) {
          return val.name === subsection;
        }).length > 0 ?
        data[pathwayId][pathwayStage].standards[standard].opportunities.filter(function(val) {
          return val.name === subsection;
        })[0].desc : subsection;
      var tooltip = subsection ? "This action is suggested because PINGR classified this patient as:'" + desc + "'" : '';
      var newHtml = ' <i class="fa fa-info-circle fa-lg info-button clickable" data-toggle="tooltip" data-placement="right" title="' + tooltip + '"></i>';
      $(this).html(html.replace(/\[INFO\]/g, newHtml));
    });

    $('#advice-list').find('span:contains("[MED-SUGGESTION")').each(function() {
      var html = $(this).html();
      var suggestion = Math.random() < 0.33 ? "Increase Ramipril to 10mg per day" : (Math.random() < 0.5 ? "Consider adding an ACE inhibior" : "Consider adding a thiazide-like diuretic");
      $(this).html(html.replace(/\[MED\-SUGGESTION\]/g, suggestion));
    });


    base.setupClipboard($('.btn-copy'), true);

    iap.displayPersonalisedIndividualActionPlan(patientId, $('#personalPlanIndividual'));
  },

  launchModal: function(label, value, reason, isUndo, callbackOnSave, callbackOnCancel, callbackOnUndo) {
    var reasons = [{
      "reason": "Already done this",
      "value": "done"
    }, {
      "reason": "Wouldn't work",
      "value": "nowork"
    }, {
      "reason": "Something else",
      "value": "else"
    }];
    if (reason && reason.reason) {
      for (var i = 0; i < reasons.length; i++) {
        if (reasons[i].reason === reason.reason) {
          reasons[i].checked = true;
          break;
        }
      }
    }
    base.launchModal({
      "header": "Disagree with a suggested action",
      "isUndo": isUndo,
      "item": value,
      "placeholder": "Provide more information here...",
      "reasons": reasons
    }, label, value, reason ? reason.reasonText : null, callbackOnSave, callbackOnCancel, callbackOnUndo);
  }

};

module.exports = iap;

},{"../base.js":7,"../data.js":9,"../log.js":11,"./confirm.js":16}],23:[function(require,module,exports){
var Highcharts = require('highcharts/highstock'),
  base = require('../base.js');
require('highcharts/highcharts-more')(Highcharts);

var ID = "LIFELINE";

var colour = {
  index: 0,
  next: function() {
    if (this.index >= Highcharts.getOptions().colors.length) this.index = 0;
    return Highcharts.getOptions().colors[this.index++];
  },
  reset: function() {
    this.index = 0;
  }
};

var ll = {
  chartArray: [],

  destroy: function(elementId) {
    $(elementId).html('');
    $(elementId).off('mousemove touchmove touchstart', '.sync-chart');

    for (var i = 0; i < Highcharts.charts.length; i++) {
      if (Highcharts.charts[i] && Highcharts.charts[i].renderTo.className.indexOf("h-chart") > -1) Highcharts.charts[i].destroy();
    }
  },

  show: function(panel, isAppend, patientId, data) {

    var element = 'lifeline-chart';
    var elementId = '#' + element;

    ll.destroy(elementId);

    var htmlElement = $('<div class="panel panel-default"><div class="panel-body"><div id="' + element + '"></div></div></div>');

    if (isAppend) panel.append(htmlElement);
    else panel.html(htmlElement);

    colour.reset();
    /**
     * In order to synchronize tooltips and crosshairs, override the
     * built-in events with handlers defined on the parent element.
     */

    $(elementId).on('mousemove touchmove touchstart', '.sync-chart', function(e) {
      var chart, point, i, event, series;

      for (i = 1; i < ll.chartArray.length - 2; i = i + 1) {
        chart = ll.chartArray[i];
        event = chart.pointer.normalize(e.originalEvent); // Find coordinates within the chart
        //if (i === 0) console.log(event.chartX + " --- " + event.chartY);
        series = i === 0 ? Math.max(Math.min(Math.floor((130 - event.chartY) / 34), chart.series.length - 1), 0) : 0;
        point = chart.series[series].searchPoint(event, true); // Get the hovered point

        if (point) {
          point.onMouseOver(); // Show the hover marker
          chart.tooltip.refresh(point); // Show the tooltip
          chart.xAxis[0].drawCrosshair(event, point); // Show the crosshair
        }
      }
    });

    /**
     * Synchronize zooming through the setExtremes event handler.
     */
    function syncExtremes(e) {
      var thisChart = this.chart;

      if (e.trigger !== 'syncExtremes') { // Prevent feedback loop
        Highcharts.each(ll.chartArray, function(chart) {
          if (chart !== thisChart) {
            if (chart.inverted) {
              if (chart.yAxis[0].setExtremes) { // It is null while updating
                chart.yAxis[0].setExtremes(e.min, e.max, undefined, false, {
                  trigger: 'syncExtremes'
                });
              }
            } else {
              if (chart.xAxis[0].setExtremes) { // It is null while updating
                chart.xAxis[0].setExtremes(e.min, e.max, undefined, false, {
                  trigger: 'syncExtremes'
                });
              }
            }
          }
        });
      }
    }


    var plotConditions = function(conditions, importantCodes, contacts) {
      ll.charts = 1;
      var series = [];
      $.each(conditions.reverse(), function(i, task) {
        var item = {
          name: task.name,
          data: [],
          color: colour.next()
        };
        $.each(task.intervals, function(j, interval) {
          item.data.push([i + 0.49, interval.from, interval.to]);
        });

        series.push(item);
      });

      var markerTemplate = { "lineWidth": 1, "lineColor": "black", "radius": 8 };
      var markers = {
        "default": $.extend({ "symbol": "triangle" }, markerTemplate),
        "Face to face": $.extend({ "symbol": "square" }, markerTemplate),
        "Telephone": $.extend({ "symbol": "circle" }, markerTemplate),
        "Hospital admission": $.extend({ "symbol": "triangle" }, markerTemplate)
      };
      var contactSeries = {};
      var eventSeries = {};
      $.each(contacts, function(i, contact) {
        if (!contactSeries[contact.name]) {
          contactSeries[contact.name] = Highcharts.extend(contact, {
            data: [],
            type: 'scatter',
            marker: markers[contact.name] || markers.default,
            color: colour.next()
          });
        }
        contactSeries[contact.name].data.push([
              contact.task,
              contact.time
          ]);
      });

      $.each(importantCodes, function(i, event) {
        if (!eventSeries[event.name]) {
          eventSeries[event.name] = Highcharts.extend(event, {
            data: [],
            type: 'scatter',
            marker: markers[event.name] || markers.default,
            color: colour.next()
          });
        }
        eventSeries[event.name].data.push([
              event.task,
              event.time
          ]);
      });

      series = series.concat(Object.keys(contactSeries).map(function(key) {
        return contactSeries[key];
      }));

      series = series.concat(Object.keys(eventSeries).map(function(key) {
        return eventSeries[key];
      }));

      $(elementId).append($('<div class="chart-title">Patient conditions and contacts</div>'));
      // create the chart
      $('<div class="h-chart h-condition-chart">')
        .appendTo(elementId)
        .highcharts({

          chart: {
            renderTo: element,
            marginLeft: 120, // Keep all charts left aligned
            spacingTop: 20,
            spacingBottom: 20,
            type: 'columnrange',
            inverted: true,
            backgroundColor: '#F9F3F9',
            borderWidth: 2,
            borderColor: '#ddd'
          },

          title: '',

          yAxis: {
            type: 'datetime',
            min: Date.UTC(2005, 6, 12),
            max: new Date().getTime(),
            crosshair: true,
            events: {
              setExtremes: syncExtremes
            },
            labels: {
              enabled: false
            },

            //things that are normally xAxis defaults
            endOnTick: false,
            gridLineWidth: 0,
            lineWidth: 1,
            maxPadding: 0.01,
            minPadding: 0.01,
            startOnTick: false,
            tickWidth: 0,
            title: {
              text: ''
            },
            tickPixelInterval: 100
          },

          xAxis: {
            labels: {
              enabled: false
            },
            startOnTick: false,
            endOnTick: false,
            title: {
              text: ''
            },
            tickWidth: 0,
            minPadding: 0.2,
            maxPadding: 0.2,

            //things that are normally yAxis defaults
            gridLineWidth: 0,
            lineWidth: 0

          },
          credits: {
            enabled: false
          },

          legend: {
            enabled: false
          },

          tooltip: {
            formatter: function() {
              if (this.series.data[0].x !== 1 && this.series.data[0].x !== 2) {
                //Range ergo condition
                var yCoord = this.y;
                var labelTmp = conditions[Math.floor(this.x)].intervals.filter(function(v) {
                  return yCoord >= v.from && yCoord <= v.to;
                });
                var label = labelTmp.length > 0 ? labelTmp[0].label : "No label A";
                return '<b>' + conditions[Math.floor(this.x)].name + (label ? ': ' + label : '') + '</b><br/>' +
                  Highcharts.dateFormat('%d/%m/%Y', this.point.options.low) +
                  ' - ' + Highcharts.dateFormat('%d/%m/%Y', this.point.options.high);
              } else {
                //Single value hence contact
                var time = this.y;
                return (this.series.data[0].x === 1 ? importantCodes : contacts).filter(function(val) {
                  return val.data && val.data.filter(function(v) {
                    return v[1] === time;
                  }).length > 0;
                }).map(function(val) {
                  return '<b>' + val.name + '</b><br/>' + Highcharts.dateFormat('%d/%m/%Y', time);
                }).join('<br/>');
              }
            },
            followPointer: true
          },

          plotOptions: {
            columnrange: {
              grouping: false,
              /*groupPadding: 0.3,*/
              dataLabels: {
                allowOverlap: true,
                enabled: true,
                formatter: function() {
                  var yCoord = this.y;
                  var idx = -1;
                  var labelTmp = conditions[Math.floor(this.x)].intervals.filter(function(v, i) {
                    if (yCoord >= v.from && yCoord <= v.to) {
                      idx = i;
                      return true;
                    }
                    return false;
                  });
                  var label = labelTmp.length > 0 ? labelTmp[0].label : "No label B";
                  return this.y === this.point.low &&
                    (conditions[Math.floor(this.x)].intervals.length - 1 === idx ||
                      (this.series.chart.yAxis[0].min <= yCoord && this.series.chart.yAxis[0].max >= yCoord) ||
                      (this.series.chart.yAxis[0].min >= this.point.low && this.series.chart.yAxis[0].max <= this.point.high)) ? conditions[Math.floor(this.x)].name + (label ? ': ' + label : '') : '';
                }
              }
            }
          },

          series: series

        });
    };

    var plotMeasurements = function(measurements) {
      $(elementId).append($('<div class="chart-title">Patient measurements</div>'));
      $.each(measurements, function(i, dataset) {
        ll.charts++;
        // Add X values
        /*if (dataset.data && typeof dataset.data[0] !== "object") {
          dataset.data = Highcharts.map(dataset.data, function(val, j) {
            return [measurements.xData[j], val];
          });
        }*/

        var chartOptions = {
          chart: {
            marginLeft: 120, // Keep all charts left aligned
            spacingTop: 0,
            spacingBottom: 8,
            backgroundColor: '#F9F9F3',
            borderWidth: 2,
            borderColor: '#ddd'
          },
          title: {
            text: '',
            align: 'left',
            margin: 0,
            x: 30
          },
          marker: {
            enabled: true
          },
          credits: {
            enabled: false
          },
          legend: {
            enabled: false
          },
          xAxis: {
            type: 'datetime',
            min: Date.UTC(2005, 6, 12),
            max: new Date().getTime(),
            crosshair: {
              snap: false
            },
            events: {
              setExtremes: syncExtremes
            },
            labels: {
              enabled: false
            },
            lineWidth: 0,
            minorGridLineWidth: 0,
            lineColor: 'transparent',
            minorTickLength: 0,
            tickLength: 0
          },
          yAxis: {
            title: {
              text: dataset.name + "<br>" + dataset.unit.replace(/\^([0-9]+)/, "<sup>$1</sup>") + "",
              margin: 60,
              rotation: 0
            },
            startOnTick: false,
            endOnTick: false,
            labels: {
              style: {
                "textOverflow": "none"
              }
            },
            tickPixelInterval: 25,
            maxPadding: 0.1,
            minPadding: 0.1
          },
          tooltip: {
            positioner: function(labelWidth, labelHeight, point) {
              return {
                x: Math.max(50, point.plotX - labelWidth), // left aligned
                y: -1 // align to title
              };
            },
            useHTML: true,
            pointFormat: '<b>' + dataset.name + ':</b> {point.y} ' + dataset.unit.replace(/\^([0-9]+)/, "<sup>$1</sup>"),
            valueDecimals: dataset.valueDecimals
          },
          plotOptions: {
            series: {
              events: {
                mouseOut: function() {
                  var chart, i;
                  for (i = 1; i < ll.chartArray.length - 2; i = i + 1) {
                    chart = ll.chartArray[i];
                    chart.tooltip.hide();
                  }
                }
              }
            }
          },
          series: [{
            data: dataset.data,
            name: dataset.name,
            type: dataset.type,
            color: colour.next(),
            fillOpacity: 0.3
            }]
        };

        if (dataset.name === "BP") {
          chartOptions.tooltip.pointFormat = "<b>BP:</b> {point.low}/{point.high} mmHg<br/>";
          //chartOptions.series[0].tooltip = {};
          chartOptions.series[0].stemWidth = 3;
          chartOptions.series[0].whiskerWidth = 5;
        }

        /*if (i === 0) {
          chartOptions.title = {
            text: 'Patient measurements',
            align: 'left',
            margin: 1,
            style: {
              color: "#333333",
              fontSize: "12px",
              fontWeight: "bold"
            }
          };
        }*/

        /*if (i === measurements.datasets.length - 1) {
          chartOptions.xAxis = {
            crosshair: true,
            events: {
              setExtremes: syncExtremes
            },
            type: 'datetime'
          };
        }*/
        $('<div class="sync-chart h-chart' + (i === measurements.length - 1 ? " h-last-measurement-chart" : "") + '">')
          .appendTo(elementId)
          .highcharts(chartOptions);

      });
    };

    var plotNavigator = function() {
      ll.charts++;
      var chart = $('<div class="h-chart h-navigator-chart">')
        .appendTo(elementId)
        .highcharts({

          chart: {
            renderTo: element,
            marginLeft: 120, // Keep all charts left aligned
            spacingTop: 20,
            spacingBottom: 20,
            ignoreHiddenSeries: false,
            borderWidth: 2,
            borderColor: '#ddd'
          },

          title: {
            text: ''
          },

          xAxis: {
            type: 'datetime',
            min: Date.UTC(2005, 6, 12),
            max: new Date().getTime(),
            crosshair: false,
            events: {
              setExtremes: syncExtremes
            },
            labels: {
              enabled: false
            },
            lineWidth: 0,
            minorGridLineWidth: 0,
            lineColor: 'transparent',
            minorTickLength: 0,
            tickLength: 0
          },

          yAxis: {
            min: 0,
            max: 1,
            tickInterval: 1,
            startOnTick: false,
            endOnTick: false,
            title: {
              text: ''
            },
            minPadding: 0.2,
            maxPadding: 0.2,
            labels: {
              enabled: false
            }
          },

          legend: {
            enabled: false
          },

          navigator: {
            enabled: true
          },

          plotOptions: {
            line: {
              lineWidth: 0,
              marker: {
                enabled: false
              },
              dataLabels: {
                enabled: false
              }
            }
          },

          series: [{
            "name": "HTN",
            "data": [{
              "x": 1373587200000,
              "y": 0,
              "from": 1373587200000,
              "to": 1459814400000
              }]
            }]

        });
      chart.highcharts().series[0].hide();
    };

    var plotMedications = function(medications) {
      ll.charts++;
      var series = [];
      $.each(medications.reverse(), function(i, task) {
        var item = {
          name: task.name,
          data: [],
          color: colour.next()
        };
        $.each(task.intervals, function(j, interval) {
          item.data.push([i + 0.49, interval.from, interval.to]);
        });

        series.push(item);
      });
      var noData = false;
      if (series.length === 0) {
        series.push({
          type: 'line',
          name: 'Random data',
          data: []
        });
        noData = true;
      }

      //$(elementId).append($('<div class="chart-title"' + (noData ? 'style="display:none"' : '') + '>Patient medications</div>'));
      $(elementId).append($('<div class="chart-title">Patient medications</div>'));
      // create the chart
      //return $('<div class="h-chart h-medication-chart"' + (noData ? 'style="display:none"' : '') + '>')
      return $('<div class="h-chart h-medication-chart">')
        .appendTo(elementId)
        .highcharts({

          chart: {
            renderTo: element,
            marginLeft: 120, // Keep all charts left aligned
            spacingTop: 20,
            spacingBottom: 20,
            type: 'columnrange',
            inverted: true,
            backgroundColor: '#F3F9F9'
          },
          lang: {
            noData: "No relevant medications"
          },
          noData: {
            style: {
              fontWeight: 'bold',
              fontSize: '15px',
              color: '#303030'
            }
          },

          title: '',
          /*{
                      text: 'Patient medications',
                      align: 'left',
                      margin: 1,
                      style: {
                        color: "#333333",
                        fontSize: "12px",
                        fontWeight: "bold"
                      }
                    },*/


          yAxis: {
            type: 'datetime',
            min: Date.UTC(2005, 6, 12),
            max: new Date().getTime(),
            crosshair: {
              snap: false
            },
            events: {
              setExtremes: syncExtremes
            },



            //things that are normally xAxis defaults
            endOnTick: false,
            gridLineWidth: 0,
            lineWidth: 1,
            maxPadding: 0.01,
            minPadding: 0.01,
            startOnTick: false,
            tickWidth: 1,
            title: {
              text: ''
            },
            tickPixelInterval: 100
          },

          xAxis: {
            labels: {
              enabled: false
            },
            startOnTick: false,
            endOnTick: false,
            title: {
              text: ''
            },
            tickWidth: 0,
            minPadding: 0.2,
            maxPadding: 0.2,

            //things that are normally yAxis defaults
            gridLineWidth: 0,
            lineWidth: 0
          },
          credits: {
            enabled: false
          },

          legend: {
            enabled: false
          },

          tooltip: {
            formatter: function() {
              var yCoord = this.y;
              var labelTmp = medications[Math.floor(this.x)].intervals.filter(function(v) {
                return yCoord >= v.from && yCoord <= v.to;
              });
              var label = labelTmp.length > 0 ? labelTmp[0].label : "No label C";
              return '<b>' + medications[Math.floor(this.x)].name + (label ? ': ' + label : '') + '</b><br/>' +
                Highcharts.dateFormat('%d/%m/%Y', this.point.options.low) +
                ' - ' + Highcharts.dateFormat('%d/%m/%Y', this.point.options.high);
            },
            followPointer: true
          },

          plotOptions: {
            columnrange: {
              grouping: false,
              dataLabels: {
                allowOverlap: true,
                enabled: true,
                formatter: function() {
                  var yCoord = this.y;
                  var idx = -1;
                  var labelTmp = medications[Math.floor(this.x)].intervals.filter(function(v, i) {
                    if (yCoord >= v.from && yCoord <= v.to) {
                      idx = i;
                      return true;
                    }
                    return false;
                  });
                  var label = labelTmp.length > 0 ? labelTmp[0].label : "No label D";
                  return this.y === this.point.low &&
                    (medications[Math.floor(this.x)].intervals.length - 1 === idx ||
                      (this.series.chart.yAxis[0].min <= yCoord && this.series.chart.yAxis[0].max >= yCoord) ||
                      (this.series.chart.yAxis[0].min >= this.point.low && this.series.chart.yAxis[0].max <= this.point.high)) ? medications[Math.floor(this.x)].name + (label ? ': ' + label : '') : '';
                }
              }
            }
          },

          series: series

        });
    };

    plotConditions(data.conditions, data.events, data.contacts);
    plotMeasurements(data.measurements);
    var c = plotMedications(data.medications);
    plotNavigator();
    c.highcharts().axes[1].setExtremes(1434864000000, 1459814400000, undefined, false, {
      trigger: 'syncExtremes'
    });

    ll.chartArray = Highcharts.charts.slice(Highcharts.charts.length - ll.charts, Highcharts.charts.length);

    var s = syncExtremes.bind(c.highcharts().series[0]);
    s({
      trigger: 'navigator',
      min: 1434864000000,
      max: 1459814400000
    });
  }

};

module.exports = ll;

},{"../base.js":7,"highcharts/highcharts-more":1,"highcharts/highstock":2}],24:[function(require,module,exports){
var base = require('../base.js'),
  confirm = require('./confirm.js'),
  data = require('../data.js'),
  log = require('../log.js');

var med = {

  create: function(pathwayId, pathwayStage, standard, patientId) {
    var medications = data.patients[patientId].medications || [];
    var agree = log.getPatientAgreeObject(pathwayId, pathwayStage, standard, patientId, "medication");
    return base.createPanel(medicationPanel, {
      "areMedications": medications.length > 0,
      "agree": agree && agree.agree,
      "disagree": agree && agree.agree === false,
      "pathway": data.pathwayNames[pathwayId],
      "medications": medications,
      "pathwayStage": pathwayStage
    }, {
      "medicationRow": $('#medication-row').html()
    });
  },

  wireUp: function(pathwayId, pathwayStage, standard, patientId) {
    confirm.wireUp($('#medication-agree-disagree'), $('#medication-panel'), pathwayId, pathwayStage, standard, patientId, "medication", "medication data");
  }

};

module.exports = med;

},{"../base.js":7,"../data.js":9,"../log.js":11,"./confirm.js":16}],25:[function(require,module,exports){
var base = require('../base.js'),
  confirm = require('./confirm.js'),
  data = require('../data.js'),
  log = require('../log.js');

var other = {

  create: function(pathwayId, pathwayStage, standard, patientId) {
    var codes = (data.patients[patientId].codes || []).map(function(val) {
      val.description = data.codes[val.code];
      return val;
    });
    var agree = log.getPatientAgreeObject(pathwayId, pathwayStage, standard, patientId, "codes");
    return base.createPanel($('#other-codes-panel'), {
      "areCodes": codes.length > 0,
      "agree": agree && agree.agree,
      "disagree": agree && agree.agree === false,
      "pathway": data.pathwayNames[pathwayId],
      "standard": data[pathwayId][pathwayStage].standards[standard].tab.title,
      "codes": codes,
      "pathwayStage": pathwayStage
    }, {
      "codeRow": $('#other-codes-row').html()
    });
  },

  wireUp: function(pathwayId, pathwayStage, standard, patientId) {
    confirm.wireUp($('#other-codes-agree-disagree'), $('#other-codes-panel'), pathwayId, pathwayStage, standard, patientId, "codes", "other codes");
  }

};

module.exports = other;

},{"../base.js":7,"../data.js":9,"../log.js":11,"./confirm.js":16}],26:[function(require,module,exports){
var data = require('../data.js'),
  Mustache = require('mustache');

var pc = {

  show: function(panel, isAppend, patientId) {

    var patientData = data.getPatientData(patientId);

    var tempMust = $('#patient-characteristics-panel').html();
    var html = Mustache.render(tempMust, patientData.characteristics);

    if (isAppend) panel.append(html);
    else panel.html(html);

  }

};

module.exports = pc;

},{"../data.js":9,"mustache":4}],27:[function(require,module,exports){
var Highcharts = require('highcharts/highstock'),
  base = require('../base.js'),
  data = require('../data.js'),
  lookup = require('../lookup.js'),
  Mustache = require('mustache');

var ID = "PATIENT_LIST";

var pl = {

  wireUp: function(onPatientSelected) {
    patientsPanel = $('#patients');

    patientsPanel.on('click', 'thead tr th.sortable', function() { //Sort columns when column header clicked
      var sortAsc = !$(this).hasClass('sort-asc');
      if (sortAsc) {
        $(this).removeClass('sort-desc').addClass('sort-asc');
      } else {
        $(this).removeClass('sort-asc').addClass('sort-desc');
      }
      pl.populate(pl.state[0], pl.state[1], pl.state[2], pl.state[3], $(this).index(), sortAsc);
    }).on('click', 'tbody tr', function(e) { //Select individual patient when row clicked#
      var callback = onPatientSelected.bind(this);
      var patientId = $(this).find('td button').attr('data-patient-id');
      callback(patientId);
      e.preventDefault();
      e.stopPropagation();
    }).on('click', 'tbody tr button', function(e) {
      //don't want row selected if just button pressed?
      e.preventDefault();
      e.stopPropagation();
    });
  },

  selectSubsection: function(section) {
    pl.populate(pl.state[0], pl.state[1], pl.state[2], section, pl.state[4], pl.state[5]);
  },

  populate: function(pathwayId, pathwayStage, standard, subsection, sortField, sortAsc) {
    pl.state = [pathwayId, pathwayStage, standard, subsection, sortField, sortAsc];
    patientsPanel = $('#patients');
    //Remove scroll if exists
    patientsPanel.find('div.table-scroll').getNiceScroll().remove();

    var i, k, prop, header, pList = [];

    data.getIndicatorData([pathwayId, pathwayStage, standard].join("."), function(indicators) {

      if (pathwayId && pathwayStage && standard && subsection) {
        pList = indicators.opportunities.filter(function(val) {
          return val.name === subsection;
        })[0].patients;
        header = indicators.opportunities.filter(function(val) {
          return val.name === subsection;
        })[0].description;
      } else if (pathwayId && pathwayStage && standard) {
        pList = indicators.opportunities.reduce(function(a, b) {
          return a.patients ? a.patients.concat(b.patients) : a.concat(b.patients);
        });
        header = data.text[pathwayId][pathwayStage].standards[standard].tableTitle;
      }

      pList = data.removeDuplicates(pList);
      var vId = data.text[pathwayId][pathwayStage].standards[standard].valueId;
      var dOv = data.text[pathwayId][pathwayStage].standards[standard].dateORvalue;
      var patients = pList.map(function(patientId) {
        var ret = indicators.patients[patientId];
        ret.nhsNumber = data.patLookup[patientId] || patientId;
        ret.patientId = patientId;
        ret.items = [data.patients[patientId].characteristics.age]; //The fields in the patient list table

        var measures = data.patients[patientId].measurements.filter(function(v){return v.id===vId;});

        if ( measures[0] && measures[0].data) {
          if (dOv === "date") {
            ret.items.push(new Date(measures[0].data[measures[0].data.length-1][0]));
          } else {
            ret.items.push(measures[0].data[measures[0].data.length-1][1]);
          }
        } else {
          ret.items.push("?");
        }
        ret.items.push(indicators.patients[patientId].opportunities.map(function(v){return '<span style="width:13px;height:13px;float:left;background-color:' + Highcharts.getOptions().colors[v] + '"></span>';}).join(""));
        //ret.items.push(data.numberOfStandardsMissed(patientId));
        return ret;
      });

      var localData = {
        "patients": patients,
        "n": patients.length,
        "header": header,
        "header-items": [{
          "title": "NHS no.",
          "isSorted": false,
          "direction": "sort-asc",
          "tooltip": "NHS number of each patient"
        },{
          "title": "Age",
          "isSorted": false,
          "direction": "sort-asc",
          "tooltip": "The age of the patient"
        }]
      };

      //middle column is either value or date
      if (dOv) {
        localData["header-items"].push({
          "title": data.text[pathwayId][pathwayStage].standards[standard].valueName,
          "tooltip": dOv === "date" ? "Last date " + vId + " was measured" : "Last " + vId + " reading",
          "isSorted": false,
          "direction": "sort-asc"
        });
      } else {
        if (pathwayStage === lookup.categories.monitoring.name) {
          localData["header-items"].push({
            "title": "Last BP Date",
            "isSorted": false,
            "direction": "sort-asc",
            "tooltip": "Last date BP was measured"
          });
        } else {
          localData["header-items"].push({
            "title": "Last SBP",
            "tooltip": "Last systolic BP reading",
            "isSorted": false,
            "direction": "sort-asc"
          });
        }
      }

      //add qual standard column
      localData["header-items"].push({
        "title": "Categories",
        "titleHTML": 'Categories',
        "isSorted": true,
        "tooltip": "Categories from above chart"
      });

      if (sortField === undefined) sortField = 2;
      if (sortField !== undefined) {
        localData.patients.sort(function(a, b) {
          if (sortField === 0) { //NHS number
            if (a.nhsNumber === b.nhsNumber) {
              return 0;
            }

            if (a.nhsNumber > b.nhsNumber) {
              return sortAsc ? 1 : -1;
            } else if (a.nhsNumber < b.nhsNumber) {
              return sortAsc ? -1 : 1;
            }
          } else {
            if (a.items[sortField - 1] === b.items[sortField - 1]) {
              return 0;
            }

            if (a.items[sortField - 1] == "?") return 1;
            if (b.items[sortField - 1] == "?") return -1;

            var A = Number(a.items[sortField - 1]);
            var B = Number(b.items[sortField - 1]);
            if (isNaN(A) || isNaN(B)) {
              A = a.items[sortField - 1];
              B = b.items[sortField - 1];
            }
            if (A > B) {
              return sortAsc ? 1 : -1;
            } else if (A < B) {
              return sortAsc ? -1 : 1;
            }
          }
        });

        for (i = 0; i < localData["header-items"].length; i++) {
          if (i === sortField) {
            localData["header-items"][i].direction = sortAsc ? "sort-asc" : "sort-desc";
            localData["header-items"][i].isAsc = sortAsc;
            localData["header-items"][i].isSorted = true;
          } else {
            localData["header-items"][i].isSorted = false;
          }
        }
      }

      base.createPanelShow(patientList, patientsPanel, localData, {
        "header-item": $("#patient-list-header-item").html(),
        "item": $('#patient-list-item').html()
      });

      $('#patients-placeholder').hide();

      base.setupClipboard($('.btn-copy'), true);

      base.wireUpTooltips();

      patientsPanel.find('div.table-scroll').niceScroll({
        cursoropacitymin: 0.3,
        cursorwidth: "7px",
        horizrailenabled: false
      });

    });

  },

  show: function(panel, isAppend, pathwayId, pathwayStage, standard, loadContentFn) {

    var tempMust = $('#patients-panel-yes').html();

    if(isAppend) panel.append(Mustache.render(tempMust));
    else panel.html(Mustache.render(tempMust));

    pl.wireUp(function(patientId) {
      history.pushState(null, null, '#patient/' + patientId);
      loadContentFn('#patient/' + patientId);
    });
    pl.populate(pathwayId, pathwayStage, standard, null);
  }

};

module.exports = pl;

},{"../base.js":7,"../data.js":9,"../lookup.js":12,"highcharts/highstock":2,"mustache":4}],28:[function(require,module,exports){
var base = require('../base.js'),
  data = require('../data.js'),
  lookup = require('../lookup.js'),
  Mustache = require('mustache');
var states, loadContFn, ID = "PATIENT_SEARCH";

var ps = {

  wireUp: function() {
    if (states) {
      states.clearPrefetchCache();
    }

    states = new Bloodhound({
      datumTokenizer: Bloodhound.tokenizers.obj.whitespace('value'),
      queryTokenizer: Bloodhound.tokenizers.whitespace,
      local: $.map(data.patientArray, function(state) {
        return {
          id: state,
          value: data.patLookup && data.patLookup[state] ? data.patLookup[state] : state
        };
      })
    });

    states.initialize(true);

    $('#search-box').find('.typeahead').typeahead('destroy');
    $('#search-box').find('.typeahead').typeahead({
        hint: true,
        highlight: true,
        minLength: 1,
        autoselect: true
      }, {
        name: 'patients',
        displayKey: 'value',
        source: states.ttAdapter(),
        templates: {
          empty: [
              '<div class="empty-message">',
                '&nbsp; &nbsp; No matches',
              '</div>'
            ].join('\n')
        }
      }).on('typeahead:selected', ps.onSelected)
      .on('typeahead:autocompleted', ps.onSelected);

    $('#searchbtn').on('mousedown', function() {
      var val = $('.typeahead').eq(0).val();
      if (!val || val === "") val = $('.typeahead').eq(1).val();
      ps.onSelected(null, {
        "id": val
      });
    });
  },

  onSelected: function($e, nhsNumberObject) {
    //Hide the suggestions panel
    $('#search-box').find('.tt-dropdown-menu').css('display', 'none');

    history.pushState(null, null, '#patients/' + nhsNumberObject.id);
    loadContFn('#patients/' + nhsNumberObject.id, true);

  },

  show: function(panel, isAppend, loadContentFn) {

    loadContFn = loadContentFn;
    var tempMust = $('#patient-search').html();

    if(isAppend) panel.append(Mustache.render(tempMust));
    else panel.html(Mustache.render(tempMust));

    ps.wireUp();
  }

};

module.exports = ps;

},{"../base.js":7,"../data.js":9,"../lookup.js":12,"mustache":4}],29:[function(require,module,exports){
var base = require('../base.js'),
  data = require('../data.js'),
  lookup = require('../lookup.js'),
  chart = require('../chart.js'),
  qualityStandard = require('./qualityStandard.js'),
  otherCodes = require('./otherCodes.js'),
  medication = require('./medication.js'),
  trend = require('./trend.js'),
  individualActionPlan = require('./individualActionPlan.js'),
  patientList = require('./patientList.js');

var pt = {

  create: function(pathwayId, pathwayStage, standard) {
    var tabData = [];
    for (var key in data[pathwayId][pathwayStage].standards) {
      tabData.push({
        "header": data[pathwayId][pathwayStage].standards[key].tab,
        "active": key === standard,
        "url": window.location.hash.replace(/\/no.*/g, '\/no/' + key)
      });
    }
    return base.createPanel(patientsPanelTemplate, {
      "pathwayStage": pathwayStage,
      "header": data[pathwayId][pathwayStage].standards[standard].chartTitle,
      "tooltip": data[pathwayId][pathwayStage].standards[standard].tooltip,
      "url": window.location.hash.replace(/\/yes.*/g, '').replace(/\/no.*/g, ''),
      "tabs": tabData,
      "text": data[pathwayId][pathwayStage].text
    }, {
      "content": $('#patients-panel-no').html(),
      "tab-header": $('#patients-panel-no-tabs').html(),
      "tab-content": $('#patients-panel-no-page').html()
    });
  },

  createOk: function(pathwayId, pathwayStage) {
    return base.createPanel(patientsPanelTemplate, {
      "ok": true,
      "pathwayStage": pathwayStage,
      "url": window.location.hash.replace(/\/yes/g, '').replace(/\/no/g, ''),
      "text": data[pathwayId][pathwayStage].text
    }, {
      "content": $('#patients-panel-yes').html()
    });
  },

  wireUp: function(pathwayId, pathwayStage, location, standard) {

    patientList.wireUp(function(patientId){
      $('[data-toggle="tooltip"]').tooltip('hide');
      $(this).tooltip('destroy');
      base.clearBox();
      $('.list-item').removeClass('highlighted');
      $(this).addClass('highlighted').removeAttr("title");

      pt.showPathwayStagePatientView(patientId, pathwayId, selected, standard);
    });

    patientsPanel = $('#patients');

    location.off('click', '#breakdown-chart');
    location.on('click', '#breakdown-chart', function() {
      if (!lookup.chartClicked) {
        /*jshint unused: true*/
        $('path.c3-bar').attr('class', function(index, classNames) {
          return classNames.replace(/_unselected_/g, '');
        });
        /*jshint unused: false*/

        if (lookup.charts['breakdown-chart']) lookup.charts['breakdown-chart'].unselect();

        patientList.populate(pathwayId, pathwayStage, standard, null);
        data.subselected = null;

        farRightPanel.fadeOut(200);
      }
      lookup.chartClicked = false;
    });

    chart.destroyCharts(['breakdown-chart']);
    setTimeout(function() {
      lookup.charts['breakdown-chart'] = c3.generate({
        bindto: '#breakdown-chart',
        tooltip: {
          format: {
            name: function(name, a, b) {
              var text = data[pathwayId][pathwayStage].standards[standard].opportunities[lookup.index].desc;
              var html = "";
              while (text.length > 40) {
                if (text.indexOf(' ', 40) < 0) break;
                html += text.substr(0, text.indexOf(' ', 40)) + '<br>';
                text = text.substr(text.indexOf(' ', 40) + 1);
              }
              html += text;
              return html;
            },
            value: function(value, ratio, id, index) {
              lookup.index = index;
              return value;
            }
          }
        },
        data: {
          columns: [
            ["Patients"].concat(data[pathwayId][pathwayStage].standards[standard].opportunities.map(function(val) {
              return val.patients.length;
            }))
          ],
          type: 'bar',
          labels: true,
          color: function(color, d) {
            return lookup.colors[d.index];
          },
          selection: {
            enabled: true
          },
          onclick: function(d) {
            chart.selectPieSlice('breakdown-chart', d);
            patientList.populate(pathwayId, pathwayStage, standard, data[pathwayId][pathwayStage].standards[standard].opportunities[d.index].name);
            data.subselected = data[pathwayId][pathwayStage].standards[standard].opportunities[d.index].name;

            //colour table appropriately - need to add opacity
            var sliceColourHex = lookup.colors[d.index];
            var shorthandRegex = /^#?([a-f\d])([a-f\d])([a-f\d])$/i;
            sliceColourHex = sliceColourHex.replace(shorthandRegex, function(m, r, g, b) {
              return r + r + g + g + b + b;
            });
            var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(sliceColourHex);
            var opacity = 0.2;
            var sliceColour = 'rgba(' + parseInt(result[1], 16) + ',' + parseInt(result[2], 16) + ',' + parseInt(result[3], 16) + ',' + opacity + ')';

            $('.table.patient-list.table-head-hidden').css({
              "backgroundColor": sliceColour
            });
          }
        },
        bar: {
          width: {
            ratio: 0.5
          }
        },
        legend: {
          show: false
        },
        grid: {
          focus: {
            show: false
          }
        },
        axis: {
          x: {
            type: 'category',
            categories: data[pathwayId][pathwayStage].standards[standard].opportunities.map(function(val) {
              return val.name;
            }),
            label: false
          },
          y: {
            label: {
              text: 'Patient count (n)',
              position: 'outer-middle'
            }
          }
        }
      });
    }, 1);
  },

  wireUpOk: function(pathwayId, pathwayStage, location) {
    patientsPanel = $('#patients');

    patientsPanel.on('click', 'thead tr th.sortable', function() { //Sort columns when column header clicked
      var sortAsc = !$(this).hasClass('sort-asc');
      if (sortAsc) {
        $(this).removeClass('sort-desc').addClass('sort-asc');
      } else {
        $(this).removeClass('sort-asc').addClass('sort-desc');
      }
      pt.populateOk(pathwayId, data.selected, data.subselected, $(this).index(), sortAsc);
    }).on('click', 'tbody tr', function(e) { //Select individual patient when row clicked
      $('[data-toggle="tooltip"]').tooltip('hide');
      $(this).tooltip('destroy');
      base.clearBox();
      $('.list-item').removeClass('highlighted');
      $(this).addClass('highlighted').removeAttr('title');

      var patientId = $(this).find('td button').attr('data-patient-id');

      pt.showPathwayStagePatientView(patientId, pathwayId, data.selected, null);
      e.preventDefault();
      e.stopPropagation();
    }).on('click', 'tbody tr button', function(e) {
      //don't want row selected if just button pressed?
      e.preventDefault();
      e.stopPropagation();
    });

    data.selected = pathwayStage;
    data.subselected = null;
  },

  populateOk: function(pathwayId, pathwayStage, subsection, sortField, sortAsc) {
    var pList = [],
      i, k, prop, header, tooltip;
    patientsPanel.fadeOut(200, function() {
      $(this).fadeIn(200);
    });

    pList = data[pathwayId][pathwayStage].patientsOk;
    header = data[pathwayId][pathwayStage].text.panelOkHeader.text;
    tooltip = data[pathwayId][pathwayStage].text.panelOkHeader.tooltip;

    pList = data.removeDuplicates(pList);
    var patients = pList.map(function(patientId) {
      var ret = data.patients[patientId];
      ret.nhsNumber = data.patLookup ? data.patLookup[patientId] : patientId;
      ret.patientId = patientId;
      ret.items = []; //The fields in the patient list table
      ret.items.push(data.patients[patientId].breach ? data.numberOfStandardsMissed(patientId) : 0);
      return ret;
    });
    var localData = {
      "patients": patients,
      "n": patients.length,
      "header": header,
      "tooltip": tooltip,
      "header-items": [{
        "title": "NHS no.",
        "isSorted": false,
        "direction": "sort-asc"
      }, {
        "title": "All Opportunities",
        "titleHTML": '# of <i class="fa fa-flag" style="color:red"></i>',
        "isSorted": true,
        "direction": "sort-desc",
        "tooltip": "Total number of improvement opportunities available across all conditions"
      }]
    };

    if (sortField === undefined) sortField = 1;

    localData.patients.sort(function(a, b) {
      if (sortField === 0) { //NHS number
        if (a.nhsNumber === b.nhsNumber) {
          return 0;
        }

        if (a.nhsNumber > b.nhsNumber) {
          return sortAsc ? 1 : -1;
        } else if (a.nhsNumber < b.nhsNumber) {
          return sortAsc ? -1 : 1;
        }
      } else {
        if (a.items[sortField - 1] === b.items[sortField - 1]) {
          return 0;
        }

        var A = Number(a.items[sortField - 1]);
        var B = Number(b.items[sortField - 1]);
        if (isNaN(A) || isNaN(B)) {
          A = a.items[sortField - 1];
          B = b.items[sortField - 1];
        }
        if (A > B) {
          return sortAsc ? 1 : -1;
        } else if (A < B) {
          return sortAsc ? -1 : 1;
        }
      }
    });

    for (i = 0; i < localData["header-items"].length; i++) {
      if (i === sortField) {
        localData["header-items"][i].direction = sortAsc ? "sort-asc" : "sort-desc";
        localData["header-items"][i].isAsc = sortAsc;
        localData["header-items"][i].isSorted = true;
      } else {
        localData["header-items"][i].isSorted = false;
      }
    }


    base.createPanelShow(patientList, patientsPanel, localData, {
      "header-item": $("#patient-list-header-item").html(),
      "item": $('#patient-list-item').html()
    });

    $('#patients-placeholder').hide();

    base.setupClipboard($('.btn-copy'), true);

    base.wireUpTooltips();

    var c = patientsPanel.find('div.table-scroll').getNiceScroll();
    if (c && c.length > 0) {
      c.resize();
    } else {
      patientsPanel.find('div.table-scroll').niceScroll({
        cursoropacitymin: 0.3,
        cursorwidth: "7px",
        horizrailenabled: false
      });
    }
  },

  //Show patient view within the pathway stage view
  showPathwayStagePatientView: function(patientId, pathwayId, pathwayStage, standard) {
    data.patientId = patientId;

    base.switchTo110Layout();

    pt.showIndividualPatientPanel(pathwayId, pathwayStage, standard, patientId);
  },

  showIndividualPatientPanel: function(pathwayId, pathwayStage, standard, patientId) {
    var stan = data[pathwayId][pathwayStage].standards[standard] ? data[pathwayId][pathwayStage].standards[standard].tab.title : "UNSPECIFIED";

    data.options.sort(function(a, b) {
      a = data.getPatientStatus(patientId, a.pathwayId, a.pathwayStage, a.standard);
      b = data.getPatientStatus(patientId, b.pathwayId, b.pathwayStage, b.standard);

      if (a === b) return 0;
      if (a === "not") return 1;
      if (b === "not") return -1;
      if (a === "ok") return 1;
      if (b === "ok") return -1;
      alert("!!!!!!!");
    });

    var panel = base.createPanel($('#patient-panel'), {
      "options": data.options,
      "numberOfStandardsMissed": data.numberOfStandardsMissed(patientId),
      "standard": stan,
      "pathwayStage": pathwayStage,
      "nhsNumber": data.patLookup ? data.patLookup[patientId] : patientId,
      "patientId": patientId
    }, {
      "option": $('#patient-panel-drop-down-options').html()
    });

    if (standard === null) {
      //Must be a patient from the *** OK group
      standard = data.options.filter(function(val) {
        return val.pathwayId === pathwayId && val.pathwayStage === pathwayStage;
      })[0].standard;
    }

    farRightPanel.html("");
    $('#temp-hidden').html(panel);

    var actionPlan = individualActionPlan.create(pathwayStage);
    $('#temp-hidden #patient-panel-right').html(actionPlan);

    var qualPanel = qualityStandard.create(pathwayId, pathwayStage, standard, patientId);
    var trendPanel = trend.create(pathwayId, pathwayStage, standard, patientId);
    var medPanel = medication.create(pathwayId, pathwayStage, standard, patientId);
    var codesPanel = otherCodes.create(pathwayId, pathwayStage, standard, patientId);
    var medCodeWrapperPanel = base.createPanel($('#other-codes-and-meds-wrapper-panel'));
    $('#temp-hidden #patient-panel-top').html(qualPanel);
    $('#temp-hidden #patient-panel-left').html("").append(trendPanel).append(medCodeWrapperPanel);
    $('#temp-hidden #medCodeWrapperPanel').append(medPanel).append(codesPanel);

    if (farRightPanel.is(':visible')) {
      farRightPanel.fadeOut(500, function() {
        $(this).html($('#temp-hidden').html());
        $('#temp-hidden').html("");
        individualActionPlan.wireUp(pathwayId, pathwayStage, standard, patientId);
        qualityStandard.wireUp(pathwayId, pathwayStage, standard, patientId);
        base.wireUpStandardDropDown(pathwayId, pathwayStage, standard, pt.showIndividualPatientPanel);
        trend.wireUp(pathwayId, pathwayStage, standard, patientId);
        medication.wireUp(pathwayId, pathwayStage, standard, patientId);
        otherCodes.wireUp(pathwayId, pathwayStage, standard, patientId);
        chart.drawTrendChart(patientId, pathwayId, pathwayStage, standard);
        $(this).fadeIn(500, function() {});
      });
    } else {
      farRightPanel.html($('#temp-hidden').html());
      $('#temp-hidden').html("");
      individualActionPlan.wireUp(pathwayId, pathwayStage, standard, patientId);
      qualityStandard.wireUp(pathwayId, pathwayStage, standard, patientId);
      base.wireUpStandardDropDown(pathwayId, pathwayStage, standard, pt.showIndividualPatientPanel);
      trend.wireUp(pathwayId, pathwayStage, standard, patientId);
      medication.wireUp(pathwayId, pathwayStage, standard, patientId);
      otherCodes.wireUp(pathwayId, pathwayStage, standard, patientId);
      chart.drawTrendChart(patientId, pathwayId, pathwayStage, standard);
      farRightPanel.fadeIn(500, function() {});
    }
  }

};

module.exports = pt;

},{"../base.js":7,"../chart.js":8,"../data.js":9,"../lookup.js":12,"./individualActionPlan.js":22,"./medication.js":24,"./otherCodes.js":25,"./patientList.js":27,"./qualityStandard.js":30,"./trend.js":33}],30:[function(require,module,exports){
var base = require('../base.js'),
  data = require('../data.js'),
  log = require('../log.js'),
  confirm = require('./confirm.js');

var ID = "QUALITYSTANDARD";

var qs = {

  create: function(pathwayId, pathwayStage, standard, patientId) {

    var localData = {
      "nhsNumber": data.patLookup ? data.patLookup[patientId] : patientId,
      "patientId": patientId
    };
    localData.standard = data.pathwayNames[pathwayId] + ' - ' + pathwayStage;
    if (data.patients[patientId].standards && data.patients[patientId].standards[pathwayId] &&
      data.patients[patientId].standards[pathwayId][pathwayStage] &&
      data.patients[patientId].standards[pathwayId][pathwayStage][standard]) {
      localData.standard = data.patients[patientId].standards[pathwayId][pathwayStage][standard];
    }

    localData.tooltip = data[pathwayId][pathwayStage].standards[standard]["standard-met-tooltip"];

    switch (data.getPatientStatus(patientId, pathwayId, pathwayStage, standard)) {
      case "ok":
        ////farRightPanel.removeClass('standard-missed-page').addClass('standard-achieved-page').removeClass('standard-not-relevant-page');
        localData.achieved = true;
        localData.relevant = true;
        break;
      case "missed":
        ////farRightPanel.addClass('standard-missed-page').removeClass('standard-achieved-page').removeClass('standard-not-relevant-page');
        localData.relevant = true;
        localData.achieved = false;
        break;
      case "not":
        ////farRightPanel.removeClass('standard-missed-page').removeClass('standard-achieved-page').addClass('standard-not-relevant-page');
        localData.relevant = false;
        break;
    }

    var agObj = log.getPatientAgreeObject(pathwayId, pathwayStage, standard, patientId, "standard");
    if (agObj && agObj.agree) localData.agree = true;
    else if (agObj && agObj.agree === false) localData.disagree = true;

    return base.createPanel($('#qual-standard'), localData);
  },

  show: function(panel, pathwayId, pathwayStage, standard, patientId){

    var panelId = panel.attr("id");

    if (base.panels[panelId] &&
      base.panels[panelId].id === ID &&
      base.panels[panelId].patientId === patientId) {
        //Already showing the right thing
        return;
    }

    base.panels[panelId] = {
      id: ID,
      patientId: patientId
    };

    panel.html(qs.create(pathwayId, pathwayStage, standard, patientId));
    qs.wireUp(pathwayId, pathwayStage, standard, patientId);
  },

  wireUp: function(pathwayId, pathwayStage, standard, patientId) {
    confirm.wireUp($('#qual-agree-disagree'), $('#individual-panel-classification'), pathwayId, pathwayStage, standard, patientId, "standard", "quality standard");
  },

  update: function() {
    $('#individual-panel-classification').find('div').each(function() {
      var self = $(this);
      var any = false;
      self.find('.btn-toggle input[type=checkbox]:checked').each(function() {
        var isClassification = $(this).closest("div").data("isClassification") !== undefined;
        any = true;
        var item = log.getAgrees()[data.patientId].filter(function(i) {
          return isClassification ? i.item === "section" : i.item !== "section";
        });
        var tool;
        if (this.value === "yes") {
          if (item && item[0].history) {
            tool = "<p>" + item[0].history[0] + "</p><p>Click again to cancel</p>";
            $(this).parent().attr("title", tool).attr("data-original-title", tool).tooltip('fixTitle').tooltip('hide');
          } else {
            $(this).parent().attr("title", "You agreed - click again to cancel").tooltip('fixTitle').tooltip('hide');
          }
        } else {
          if (item && item[0].history) {
            tool = "<p>" + item[0].history[0] + "</p><p>Click again to edit/cancel</p>";
            $(this).parent().attr("title", tool).attr("data-original-title", tool).tooltip('fixTitle').tooltip('hide');
          } else {
            $(this).parent().attr("title", "You disagreed - click again to edit/cancel").tooltip('fixTitle').tooltip('hide');
          }
        }
      });

      if (self.find('.btn-toggle input[type=checkbox]:not(:checked)').length == 1) {
        self.find('.btn-toggle input[type=checkbox]:not(:checked)').parent().addClass("inactive").attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
      }

      if (!any) {
        self.find('.btn-toggle.btn-yes').attr("title", "Click to agree with this action and save it in your agreed actions list  ").tooltip('fixTitle').tooltip('hide');
        self.find('.btn-toggle.btn-no').attr("title", "Click to disagree with this action and remove it from your suggested actions list ").tooltip('fixTitle').tooltip('hide');
      }

      base.wireUpTooltips();
    });

    base.wireUpTooltips();
  }

};

module.exports = qs;

},{"../base.js":7,"../data.js":9,"../log.js":11,"./confirm.js":16}],31:[function(require,module,exports){
var data = require('../data.js'),
  Mustache = require('mustache');

var qs = {

  show: function(panel, isAppend, patientId) {

    var patientData = data.getPatientData(patientId);

    var tempMust = $('#quality-standard-panel').html();
    var html = Mustache.render(tempMust, {
      "standards": patientData.standards
    });

    if (isAppend) panel.append(html);
    else panel.html(html);

  }

};

module.exports = qs;

},{"../data.js":9,"mustache":4}],32:[function(require,module,exports){
var base = require('../base.js'),
  confirm = require('./confirm.js'),
  data = require('../data.js'),
  log = require('../log.js');

var tap = {

  show: function(location) {
    location.removeClass('standard-missed-page').removeClass('standard-achieved-page').removeClass('standard-not-relevant-page');
    base.createPanelShow($('#team-action-plan-panel'), location);

    suggestedPlanTeam = $('#suggestedPlanTeam');

    suggestedPlanTeam.on('click', '.cr-styled input[type=checkbox]', function() {
      var ACTIONID = $(this).closest('tr').data('id');
      log.editAction("team", ACTIONID, null, this.checked);

      if (this.checked) {
        log.recordEvent(data.pathwayId, "team", "Item completed");
        var self = this;
        $(self).parent().attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
        base.wireUpTooltips();
        setTimeout(function(e) {
          $(self).parent().fadeOut(300, function() {
            var parent = $(this).parent();
            $(this).replaceWith(base.createPanel($('#checkbox-template'), {
              "done": true
            }));
            parent.find('button').on('click', function() {
              ACTIONID = $(this).closest('tr').data('id');
              log.editAction("team", ACTIONID, null, false);
              $(this).replaceWith(base.createPanel($('#checkbox-template'), {
                "done": false
              }));
              tap.updateTeamSapRows();
            });
          });
        }, 1000);
      }

      tap.updateTeamSapRows();
    });

    $('#personalPlanTeam').on('click', 'input[type=checkbox]', function() {
      var PLANID = $(this).closest('tr').data("id");
      editPlan(PLANID, null, this.checked);

      if (this.checked) {
        $(this).parent().parent().parent().addClass('success');
        recordEvent(data.pathwayId, "team", "Personal plan item");
        var self = this;
        $(self).parent().attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
        setTimeout(function(e) {
          $(self).parent().fadeOut(300, function() {
            var parent = $(this).parent();
            $(this).replaceWith(base.createPanel($('#checkbox-template'), {
              "done": true
            }));
            base.wireUpTooltips();
            parent.find('button').on('click', function() {
              PLANID = $(this).closest('tr').data('id');
              editPlan("team", PLANID, null, false);
              $(this).replaceWith(base.createPanel($('#checkbox-template'), {
                "done": false
              }));
              tap.updateTeamSapRows();
            });
          });
        }, 1000);
      }

    }).on('click', '.btn-undo', function(e) {
      var PLANID = $(this).closest('tr').data('id');
      log.editPlan(PLANID, null, false);
      $(this).replaceWith(base.createPanel($('#checkbox-template'), {
        "done": false
      }));
      tap.updateTeamSapRows();
      e.stopPropagation();
    });

    var teamTab = $('#tab-plan-team'),
      current;
    teamTab.on('click', '.edit-plan', function() {
      var PLANID = $(this).closest('tr').data("id");

      $('#editActionPlanItem').val($($(this).closest('tr').children('td')[0]).find('span').text());

      $('#editPlan').off('hidden.bs.modal').on('hidden.bs.modal', function() {
        tap.displayPersonalisedTeamActionPlan($('#personalPlanTeam'));
      }).off('shown.bs.modal').on('shown.bs.modal', function() {
        $('#editActionPlanItem').focus();
      }).off('click', '.save-plan').on('click', '.save-plan', function() {

        log.editPlan(PLANID, $('#editActionPlanItem').val());

        $('#editPlan').modal('hide');
      }).off('keyup', '#editActionPlanItem').on('keyup', '#editActionPlanItem', function(e) {
        if (e.which === 13) $('#editPlan .save-plan').click();
      }).modal();
    }).on('click', '.delete-plan', function() {
      var PLANID = $(this).closest('tr').data("id");

      $('#team-delete-item').html($($(this).closest('tr').children('td')[0]).find('span').text());

      $('#deletePlan').off('hidden.bs.modal').on('hidden.bs.modal', function() {
        tap.displayPersonalisedTeamActionPlan($('#personalPlanTeam'));
      }).off('click', '.delete-plan').on('click', '.delete-plan', function() {
        log.deletePlan(PLANID);

        $('#deletePlan').modal('hide');
      }).modal();
    }).on('click', '.add-plan', function() {
      log.recordPlan("team", $(this).parent().parent().find('textarea').val(), data.pathwayId);

      tap.displayPersonalisedTeamActionPlan($('#personalPlanTeam'));
    }).on('change', '.btn-toggle input[type=checkbox]', function() {
      tap.updateTeamSapRows();
    }).on('click', '.btn-undo', function(e) {
      var ACTIONID = $(this).closest('tr').data('id');
      log.editAction("team", ACTIONID, null, false);
      $(this).replaceWith(base.createPanel($('#checkbox-template'), {
        "done": false
      }));
      tap.updateTeamSapRows();
    }).on('click', '.btn-yes,.btn-no', function(e) {
      var checkbox = $(this).find("input[type=checkbox]");
      var other = $(this).parent().find($(this).hasClass("btn-yes") ? ".btn-no" : ".btn-yes");
      var ACTIONID = $(this).closest('tr').data('id');
      if ($(this).hasClass("active") && other.hasClass("inactive") && !$(this).closest('tr').hasClass('success')) {
        //unselecting
        if (checkbox.val() === "no") {
          tap.launchModal(data.selected, checkbox.closest('tr').children().first().children().first().text(), log.getReason("team", ACTIONID), true, function() {
            log.editAction("team", ACTIONID, false, null, log.reason);
            tap.updateTeamSapRows();
            base.wireUpTooltips();
          }, null, function() {
            log.ignoreAction("team", ACTIONID);
            other.removeClass("inactive");
            checkbox.removeAttr("checked");
            checkbox.parent().removeClass("active");
            tap.updateTeamSapRows();
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.ignoreAction("team", ACTIONID);
          other.removeClass("inactive");
        }
      } else if ((!$(this).hasClass("active") && other.hasClass("active")) || $(this).closest('tr').hasClass('success')) {
        //prevent clicking on unselected option or if the row is complete
        e.stopPropagation();
        e.preventDefault();
        return;
      } else {
        //selecting
        var self = this;
        if (checkbox.val() === "no") {
          tap.launchModal(data.selected, checkbox.closest('tr').children().first().children().first().text(), log.getReason("team", ACTIONID), false, function() {
            log.editAction("team", ACTIONID, false, null, log.reason);
            $(self).removeClass("inactive");

            checkbox.attr("checked", "checked");
            checkbox.parent().addClass("active");
            //unselect other
            other.removeClass("active").addClass("inactive");
            other.find("input[type=checkbox]").prop("checked", false);
            tap.updateTeamSapRows();
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.editAction("team", ACTIONID, true);
          $(this).removeClass("inactive");

          //unselect other
          other.removeClass("active").addClass("inactive");
          other.find("input[type=checkbox]").prop("checked", false);
        }
      }
    }).on('keyup', 'input[type=text]', function(e) {
      if (e.which === 13) {
        teamTab.find('.add-plan').click();
      }
    });

    tap.populateTeamSuggestedActionsPanel();

    location.find('div.fit-to-screen-height').niceScroll({
      cursoropacitymin: 0.3,
      cursorwidth: "7px",
      horizrailenabled: false
    });
  },

  populateTeamSuggestedActionsPanel: function() {
    var suggestions = base.suggestionList(log.plan[data.pathwayId].team);
    suggestions = base.sortSuggestions(tap.mergeTeamStuff(suggestions));

    base.createPanelShow(suggestedPlanTemplate, suggestedPlanTeam, {
      "suggestions": suggestions
    }, {
      "item": $('#suggested-plan-item').html(),
      "chk": $('#checkbox-template').html()
    });

    tap.displayPersonalisedTeamActionPlan($('#personalPlanTeam'));
  },

  updateTeamSapRows: function() {
    suggestedPlanTeam.add('#personalPlanTeam').find('.suggestion').each(function() {
      $(this).find('td').last().children().hide();
    });

    suggestedPlanTeam.add('#personalPlanTeam').find('.cr-styled input[type=checkbox]').each(function() {
      if (this.checked) {
        $(this).parent().parent().parent().addClass('success');
      } else {
        $(this).parent().parent().parent().removeClass('success');
      }
    });

    suggestedPlanTeam.add('#personalPlanTeam').find('.btn-undo').each(function() {
      $(this).parent().parent().addClass('success');
    });

    //no class - user not yet agreed/disagreed - no background / muted text
    //active - user agrees - green background / normal text
    //success - user completed - green background / strikethrough text
    //danger - user disagrees - red background / strikethrough text
    suggestedPlanTeam.add('#personalPlanTeam').find('tr').each(function() {
      var self = $(this);
      var any = false;
      self.find('.btn-toggle input[type=checkbox]:checked').each(function() {
        any = true;
        if (this.value === "yes") {
          self.removeClass('danger');
          self.addClass('active');
          self.find('td').last().children().show();
          if (log.getActions().team[self.data("id")].history) {
            var tool = $(this).closest('tr').hasClass('success') ? "" : "<p>" + log.getActions().team[self.data("id")].history[0] + "</p><p>Click again to cancel</p>";
            $(this).parent().attr("title", tool).attr("data-original-title", tool).tooltip('fixTitle').tooltip('hide');
          } else {
            $(this).parent().attr("title", "You agreed - click again to cancel").tooltip('fixTitle').tooltip('hide');
          }
        } else {
          self.removeClass('active');
          self.addClass('danger');
          self.removeClass('success');
          if (log.getActions().team[self.data("id")] && log.getActions().team[self.data("id")].history) {
            $(this).parent().attr("title", "<p>" + log.getActions().team[self.data("id")].history[0] + "</p><p>Click again to edit/cancel</p>").tooltip('fixTitle').tooltip('hide');
          } else {
            $(this).parent().attr("title", "You disagreed - click again to edit/cancel").tooltip('fixTitle').tooltip('hide');
          }
        }
      });
      if (self.find('.btn-toggle input[type=checkbox]:not(:checked)').length == 1) {
        self.find('.btn-toggle input[type=checkbox]:not(:checked)').parent().addClass("inactive").attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
      }
      if (!any) {
        self.removeClass('danger');
        self.removeClass('active');
        self.removeClass('success');

        self.find('.btn-toggle.btn-yes').attr("title", "Click to agree with this action and save it in your agreed actions list  ").tooltip('fixTitle').tooltip('hide');
        self.find('.btn-toggle.btn-no').attr("title", "Click to disagree with this action and remove it from your suggested actions list ").tooltip('fixTitle').tooltip('hide');
      }

      base.wireUpTooltips();
    });

    base.wireUpTooltips();
  },

  displayPersonalisedTeamActionPlan: function(parentElem) {
    var plans = base.sortSuggestions(base.addDisagreePersonalTeam(log.listPlans("team", data.pathwayId)));

    base.createPanelShow(actionPlanList, parentElem, {
      "hasSuggestions": plans && plans.length > 0,
      "suggestions": plans
    }, {
      "action-plan": $('#action-plan').html(),
      "action-plan-item": $('#action-plan-item').html(),
      "chk": $('#checkbox-template').html()
    });

    tap.updateTeamSapRows();
  },

  mergeTeamStuff: function(suggestions) {
    var teamActions = log.listActions();
    if (!teamActions.team) return suggestions;

    suggestions = tap.addDisagree(suggestions, teamActions, "team");
    return suggestions;
  },

  launchModal: function(label, value, reason, isUndo, callbackOnSave, callbackOnCancel, callbackOnUndo) {
    var reasons = [{
      "reason": "We've already done this",
      "value": "done"
    }, {
      "reason": "It wouldn't work",
      "value": "nowork"
    }, {
      "reason": "Other",
      "value": "else"
    }];
    if (reason && reason.reason) {
      for (var i = 0; i < reasons.length; i++) {
        if (reasons[i].reason === reason.reason) {
          reasons[i].checked = true;
          break;
        }
      }
    }
    base.launchModal({
      "header": "Disagree with a suggested action",
      "isUndo": isUndo,
      "item": value,
      "placeholder": "Enter free-text here...",
      "reasons": reasons
    }, label, value, reason ? reason.reasonText : null, callbackOnSave, callbackOnCancel, callbackOnUndo);
  },

  addDisagree: function(suggestions, actions, id) {
    for (var i = 0; i < suggestions.length; i++) {
      if (actions[id][suggestions[i].id]) {
        if (actions[id][suggestions[i].id].agree) {
          suggestions[i].agree = true;
          suggestions[i].disagree = false;
        } else if (actions[id][suggestions[i].id].agree === false) {
          suggestions[i].agree = false;
          suggestions[i].disagree = true;
        }
        if (actions[id][suggestions[i].id].done) suggestions[i].done = actions[id][suggestions[i].id].done;
        else suggestions[i].done = false;
      }
    }
    return suggestions;
  }

};

module.exports = tap;

},{"../base.js":7,"../data.js":9,"../log.js":11,"./confirm.js":16}],33:[function(require,module,exports){
var base = require('../base.js'),
  confirm = require('./confirm.js'),
  data = require('../data.js'),
  log = require('../log.js'),
  lookup = require('../lookup.js');

var trnd = {

  create: function(pathwayId, pathwayStage, standard, patientId) {
    var agree = log.getPatientAgreeObject(pathwayId, pathwayStage, standard, patientId, "trend");
    return base.createPanel(valueTrendPanel, {
      "pathway": lookup.monitored[pathwayId],
      "agree": agree && agree.agree,
      "disagree": agree && agree.agree === false,
      "standard": data[pathwayId][pathwayStage].standards[standard].tab.title,
      "pathwayStage": pathwayStage
    });
  },

  wireUp: function(pathwayId, pathwayStage, standard, patientId) {
    confirm.wireUp($('#trend-agree-disagree'), $('#trend-panel'), pathwayId, pathwayStage, standard, patientId, "trend", "trend data");

    $('#trend-panel').on('click', '.table-chart-toggle', function() {
      if ($(this).text() === "Table") {
        $(this).text("Chart");
        $('#chart-demo-trend').hide();
        $('#table-demo-trend').show();

        var c = $('#table-demo-trend .tableScroll').getNiceScroll();
        if (c && c.length > 0) {
          c.resize();
        } else {
          $('#table-demo-trend .tableScroll').niceScroll({
            cursoropacitymin: 0.3,
            cursorwidth: "7px",
            horizrailenabled: false
          });
        }
      } else {
        $(this).text("Table");
        $('#chart-demo-trend').show();
        $('#table-demo-trend').hide();
      }
    });
  }

};

module.exports = trnd;

},{"../base.js":7,"../data.js":9,"../log.js":11,"../lookup.js":12,"./confirm.js":16}],34:[function(require,module,exports){
var base = require('../base.js'),
  data = require('../data.js'),
  log = require('../log.js'),
  individualActionPlan = require('./individualActionPlan.js'),
  teamActionPlan = require('./teamActionPlan.js'),
  Mustache = require('mustache');

var welcome = {

  wireUpWelcomePage: function(pathwayId, pathwayStage) {
    $('#team-task-panel').on('click', '.cr-styled input[type=checkbox]', function() {
      var ACTIONID = $(this).closest('tr').data('id');
      log.editAction("team", ACTIONID, null, this.checked);

      if (this.checked) {
        log.recordEvent(pathwayId, "team", "Item completed");
        var self = this;
        $(self).parent().attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
        base.wireUpTooltips();
        setTimeout(function(e) {
          $(self).parent().fadeOut(300, function() {
            var parent = $(this).parent();
            $(this).replaceWith(base.createPanel($('#checkbox-template'), {
              "done": true
            }));
            parent.find('button').on('click', function() {
              ACTIONID = $(this).closest('tr').data('id');
              log.editAction("team", ACTIONID, null, false);
              $(this).replaceWith(base.createPanel($('#checkbox-template'), {
                "done": false
              }));
              welcome.updateWelcomePage();
            });
          });
        }, 1000);
      }
      welcome.updateWelcomePage();
    }).on('change', '.btn-toggle input[type=checkbox]', function() {
      welcome.updateWelcomePage();
    }).on('click', '.edit-plan', function() {
      var PLANID = $(this).closest('tr').data("id");

      $('#editActionPlanItem').val($($(this).closest('tr').children('td')[1]).find('span').text());

      $('#editPlan').off('hidden.bs.modal').on('hidden.bs.modal', function() {
        welcome.populate(!$('#outstandingTasks').parent().hasClass("active"));
      }).off('shown.bs.modal').on('shown.bs.modal', function() {
        $('#editActionPlanItem').focus();
      }).off('click', '.save-plan').on('click', '.save-plan', function() {

        log.editPlan(PLANID, $('#editActionPlanItem').val());

        $('#editPlan').modal('hide');
      }).off('keyup', '#editActionPlanItem').on('keyup', '#editActionPlanItem', function(e) {
        if (e.which === 13) $('#editPlan .save-plan').click();
      }).modal();
    }).on('click', '.delete-plan', function() {
      var PLANID = $(this).closest('tr').data("id");

      $('#team-delete-item').html($($(this).closest('tr').children('td')[1]).find('span').text());

      $('#deletePlan').off('hidden.bs.modal').on('hidden.bs.modal', function() {
        welcome.populate(!$('#outstandingTasks').parent().hasClass("active"));
      }).off('click', '.delete-plan').on('click', '.delete-plan', function() {
        log.deletePlan(PLANID);

        $('#deletePlan').modal('hide');
      }).modal();
    }).on('click', '.btn-undo', function(e) {
      var ACTIONID = $(this).closest('tr').data('id');
      log.editAction("team", ACTIONID, null, false);
      $(this).replaceWith(base.createPanel($('#checkbox-template'), {
        "done": false
      }));
      welcome.updateWelcomePage();
    }).on('click', '.btn-yes,.btn-no', function(e) {
      var checkbox = $(this).find("input[type=checkbox]");
      var other = $(this).parent().find($(this).hasClass("btn-yes") ? ".btn-no" : ".btn-yes");
      var ACTIONID = $(this).closest('tr').data('id');
      if ($(this).hasClass("active") && other.hasClass("inactive") && !$(this).closest('tr').hasClass('success')) {
        //unselecting
        if (checkbox.val() === "no") {
          teamActionPlan.launchModal(data.selected, checkbox.closest('tr').children(':nth(1)').find('span').text(), log.getReason("team", ACTIONID), true, function() {
            log.editAction("team", ACTIONID, false, null, log.reason);
            welcome.updateWelcomePage();
            base.wireUpTooltips();
          }, null, function() {
            log.ignoreAction("team", ACTIONID);
            other.removeClass("inactive");
            checkbox.removeAttr("checked");
            checkbox.parent().removeClass("active");
            welcome.updateWelcomePage();
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.ignoreAction("team", ACTIONID);
          other.removeClass("inactive");
        }
      } else if ((!$(this).hasClass("active") && other.hasClass("active")) || $(this).closest('tr').hasClass('success')) {
        //prevent clicking on unselected option or if the row is complete
        e.stopPropagation();
        e.preventDefault();
        return;
      } else {
        //selecting
        var self = this;
        if (checkbox.val() === "no") {
          teamActionPlan.launchModal(data.selected, checkbox.closest('tr').children(':nth(1)').find('span').text(), log.getReason("team", ACTIONID), false, function() {
            log.editAction("team", ACTIONID, false, null, log.reason);
            $(self).removeClass("inactive");

            checkbox.attr("checked", "checked");
            checkbox.parent().addClass("active");
            //unselect other
            other.removeClass("active").addClass("inactive");
            other.find("input[type=checkbox]").prop("checked", false);
            welcome.updateWelcomePage();
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.editAction("team", ACTIONID, true);
          $(this).removeClass("inactive");

          //unselect other
          other.removeClass("active").addClass("inactive");
          other.find("input[type=checkbox]").prop("checked", false);
        }
      }
    });

    $('#individual-task-panel').on('click', '.cr-styled input[type=checkbox]', function() {
      var ACTIONID = $(this).closest('tr').data('id');
      var patientId = $(this).closest('tr').data('team-or-patient-id');
      log.editAction(patientId, ACTIONID, null, this.checked);

      if (this.checked) {
        log.recordEvent(pathwayId, patientId, "Item completed");
        var self = this;
        $(self).parent().attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
        base.wireUpTooltips();
        setTimeout(function(e) {
          $(self).parent().fadeOut(300, function() {
            var parent = $(this).parent();
            $(this).replaceWith(base.createPanel($('#checkbox-template'), {
              "done": true
            }));
            parent.find('button').on('click', function() {
              ACTIONID = $(this).closest('tr').data('id');
              log.editAction(patientId, ACTIONID, null, false);
              $(this).replaceWith(base.createPanel($('#checkbox-template'), {
                "done": false
              }));
              welcome.updateWelcomePage();
            });
          });
        }, 1000);
      }
      welcome.updateWelcomePage();
    }).on('change', '.btn-toggle input[type=checkbox]', function() {
      welcome.updateWelcomePage();
    }).on('click', '.edit-plan', function() {
      var PLANID = $(this).closest('tr').data("id");

      $('#editActionPlanItem').val($($(this).closest('tr').children('td')[2]).find('span').text());

      $('#editPlan').off('hidden.bs.modal').on('hidden.bs.modal', function() {
        welcome.populate(!$('#outstandingTasks').parent().hasClass("active"));
      }).off('shown.bs.modal').on('shown.bs.modal', function() {
        $('#editActionPlanItem').focus();
      }).off('click', '.save-plan').on('click', '.save-plan', function() {

        log.editPlan(PLANID, $('#editActionPlanItem').val());

        $('#editPlan').modal('hide');
      }).off('keyup', '#editActionPlanItem').on('keyup', '#editActionPlanItem', function(e) {
        if (e.which === 13) $('#editPlan .save-plan').click();
      }).modal();
    }).on('click', '.delete-plan', function() {
      var PLANID = $(this).closest('tr').data("id");

      $('#team-delete-item').html($($(this).closest('tr').children('td')[2]).find('span').text());

      $('#deletePlan').off('hidden.bs.modal').on('hidden.bs.modal', function() {
        welcome.populate(!$('#outstandingTasks').parent().hasClass("active"));
      }).off('click', '.delete-plan').on('click', '.delete-plan', function() {
        log.deletePlan(PLANID);

        $('#deletePlan').modal('hide');
      }).modal();
    }).on('click', '.btn-undo', function(e) {
      var ACTIONID = $(this).closest('tr').data('id');
      var patientId = $(this).closest('tr').data('team-or-patient-id');
      log.editAction(patientId, ACTIONID, null, false);
      $(this).replaceWith(base.createPanel($('#checkbox-template'), {
        "done": false
      }));
      welcome.updateWelcomePage();
    }).on('click', '.btn-yes,.btn-no', function(e) {
      var checkbox = $(this).find("input[type=checkbox]");
      var other = $(this).parent().find($(this).hasClass("btn-yes") ? ".btn-no" : ".btn-yes");
      var ACTIONID = $(this).closest('tr').data('id');
      var patientId = $(this).closest('tr').data('team-or-patient-id');
      if ($(this).hasClass("active") && other.hasClass("inactive") && !$(this).closest('tr').hasClass('success')) {
        //unselecting
        if (checkbox.val() === "no") {
          individualActionPlan.launchModal(data.selected, checkbox.closest('tr').children(':nth(2)').find('span').text(), log.getReason(patientId, ACTIONID), true, function() {
            log.editAction(patientId, ACTIONID, false, null, log.reason);
            welcome.updateWelcomePage();
            base.wireUpTooltips();
          }, null, function() {
            log.ignoreAction(patientId, ACTIONID);
            other.removeClass("inactive");
            checkbox.removeAttr("checked");
            checkbox.parent().removeClass("active");
            welcome.updateWelcomePage();
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.ignoreAction(patientId, ACTIONID);
          other.removeClass("inactive");
        }
      } else if ((!$(this).hasClass("active") && other.hasClass("active")) || $(this).closest('tr').hasClass('success')) {
        //prevent clicking on unselected option or if the row is complete
        e.stopPropagation();
        e.preventDefault();
        return;
      } else {
        //selecting
        var self = this;
        if (checkbox.val() === "no") {
          individualActionPlan.launchModal(data.selected, checkbox.closest('tr').children(':nth(2)').find('span').text(), log.getReason(patientId, ACTIONID), false, function() {
            log.editAction(patientId, ACTIONID, false, null, log.reason);
            $(self).removeClass("inactive");

            checkbox.attr("checked", "checked");
            checkbox.parent().addClass("active");
            //unselect other
            other.removeClass("active").addClass("inactive");
            other.find("input[type=checkbox]").prop("checked", false);
            welcome.updateWelcomePage();
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.editAction(patientId, ACTIONID, true);
          $(this).removeClass("inactive");

          //unselect other
          other.removeClass("active").addClass("inactive");
          other.find("input[type=checkbox]").prop("checked", false);
        }
      }
    });

    welcome.updateWelcomePage();
  },

  updateWelcomePage: function() {
    $('#team-task-panel').add('#individual-task-panel').find('.suggestion').each(function() {
      $(this).find('td').last().children().hide();
    });

    $('#team-task-panel').add('#individual-task-panel').find('.cr-styled input[type=checkbox]').each(function() {
      if (this.checked) {
        $(this).parent().parent().parent().addClass('success');
      } else {
        $(this).parent().parent().parent().removeClass('success');
      }
    });

    $('#team-task-panel').add('#individual-task-panel').find('.btn-undo').each(function() {
      $(this).parent().parent().addClass('success');
    });

    //no class - user not yet agreed/disagreed - no background / muted text
    //active - user agrees - green background / normal text
    //success - user completed - green background / strikethrough text
    //danger - user disagrees - red background / strikethrough text
    $('#team-task-panel').add('#individual-task-panel').find('tr').each(function() {
      var self = $(this);
      var any = false;
      self.find('.btn-toggle input[type=checkbox]:checked').each(function() {
        any = true;
        if (this.value === "yes") {
          self.removeClass('danger');
          self.addClass('active');
          self.find('td').last().children().show();
          if (log.getActions().team[self.data("id")] && log.getActions().team[self.data("id")].history) {
            var tool = $(this).closest('tr').hasClass('success') ? "" : "<p>" + log.getActions().team[self.data("id")].history[0] + "</p><p>Click again to cancel</p>";
            $(this).parent().attr("title", tool).attr("data-original-title", tool).tooltip('fixTitle').tooltip('hide');
          } else {
            $(this).parent().attr("title", "You agreed - click again to cancel").tooltip('fixTitle').tooltip('hide');
          }
        } else {
          self.removeClass('active');
          self.addClass('danger');
          self.removeClass('success');
          if (log.getActions().team[self.data("id")] && log.getActions().team[self.data("id")].history) {
            $(this).parent().attr("title", "<p>" + log.getActions().team[self.data("id")].history[0] + "</p><p>Click again to edit/cancel</p>").tooltip('fixTitle').tooltip('hide');
          } else {
            $(this).parent().attr("title", "You disagreed - click again to edit/cancel").tooltip('fixTitle').tooltip('hide');
          }
        }
      });
      if (self.find('.btn-toggle input[type=checkbox]:not(:checked)').length == 1) {
        self.find('.btn-toggle input[type=checkbox]:not(:checked)').parent().addClass("inactive").attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
      }
      if (!any) {
        self.removeClass('danger');
        self.removeClass('active');
        self.removeClass('success');

        self.find('.btn-toggle.btn-yes').attr("title", "Click to agree with this action and save it in your agreed actions list  ").tooltip('fixTitle').tooltip('hide');
        self.find('.btn-toggle.btn-no').attr("title", "Click to disagree with this action and remove it from your suggested actions list ").tooltip('fixTitle').tooltip('hide');
      }

      base.wireUpTooltips();
    });

    base.wireUpTooltips();
  },

  populate: function(complete) {

    var k,l;
    //add tasks
    var teamTasks = [];
    var individualTasks = [];

    //Add the team tasks
    for (k in log.listActions("team")) {
      if (log.listActions("team")[k].agree && ((!log.listActions("team")[k].done && !complete) || (log.listActions("team")[k].done && complete))) {
        teamTasks.push({
          "pathway": "N/A",
          "task": log.text[log.listActions("team")[k].id].text,
          "data": log.listActions("team")[k].id,
          "tpId": "team",
          "agree": true,
          "done": complete
        });
      }
    }

    //Add the user added team tasks
    for (k in log.listPlans("team")) {
      if ((!log.listPlans("team")[k].done && !complete) || (log.listPlans("team")[k].done && complete)) {
        teamTasks.push({
          "canEdit": true,
          "pathway": data.pathwayNames[log.listPlans("team")[k].pathwayId],
          "pathwayId": log.listPlans("team")[k].pathwayId,
          "task": log.listPlans("team")[k].text,
          "data": log.listPlans("team")[k].id,
          "agree": log.listPlans("team")[k].agree,
          "disagree": log.listPlans("team")[k].agree === false,
          "done": complete
        });
      }
    }

    //Add individual
    for (k in log.listActions()) {
      if (k === "team") continue;
      for (l in log.listActions()[k]) {
        if (log.text[l] && log.listActions()[k][l].agree && ((!log.listActions()[k][l].done && !complete) || (log.listActions()[k][l].done && complete))) {
          individualTasks.push({
            "pathway": "N/A",
            "patientId": k,
            "task": log.text[l].text,
            "pathwayId": log.listPlans()[k][l].pathwayId,
            "data": l,
            "tpId": k,
            "agree": true,
            "done": complete
          });
        }
      }
    }

    //Add custom individual
    for (k in log.listPlans()) {
      if (k === "team") continue;
      for (l in log.listPlans()[k]) {
        if (log.listPlans()[k][l].text && (!log.listPlans()[k][l].done && !complete) || (log.listPlans()[k][l].done && complete)) {
          individualTasks.push({
            "canEdit": true,
            "pathway": data.pathwayNames[log.listPlans()[k][l].pathwayId],
            "pathwayId": log.listPlans()[k][l].pathwayId,
            "patientId": k,
            "tpId": k,
            "task": log.listPlans()[k][l].text,
            "data": l,
            "agree": true,
            "done": complete
          });
        }
      }
    }

    var listTemplate = $('#welcome-task-list').html();
    Mustache.parse(listTemplate);
    $('#welcome-tab-content').html(Mustache.render(listTemplate));

    var addTemplate = $('#action-plan').html();
    Mustache.parse(addTemplate);
    var rendered = Mustache.render(addTemplate);
    $('#team-add-plan').html(rendered);

    var tempMust = $('#welcome-task-items').html();
    var itemTemplate = $('#welcome-task-item').html();
    Mustache.parse(tempMust);
    Mustache.parse(itemTemplate);

    $('#team-add-plan').off('click').on('click', '.add-plan', function() {
      var plan = $(this).parent().parent().find('textarea').val();
      var planId = recordPlan("team", plan, "custom");
      $('#team-task-panel').find('table tbody').append(Mustache.render(itemTemplate, {
        "pathway": "",
        "pathwayId": "custom",
        "canEdit": true,
        "task": plan,
        "data": planId,
        "agree": null,
        "done": null
      }, {
        "chk": $('#checkbox-template').html()
      }));
    });

    rendered = Mustache.render(tempMust, {
      "tasks": teamTasks,
      "hasTasks": teamTasks.length > 0
    }, {
      "task-item": itemTemplate,
      "chk": $('#checkbox-template').html()
    });
    $('#team-task-panel').children().not(":first").remove();
    $('#team-task-panel').append(rendered);

    rendered = Mustache.render(tempMust, {
      "tasks": individualTasks,
      "isPatientTable": true,
      "hasTasks": individualTasks.length > 0
    }, {
      "task-item": itemTemplate,
      "chk": $('#checkbox-template').html()
    });
    $('#individual-task-panel').children().not(":first").remove();
    $('#individual-task-panel').append(rendered);

    welcome.wireUpWelcomePage();
  }

};

module.exports = welcome;

},{"../base.js":7,"../data.js":9,"../log.js":11,"./individualActionPlan.js":22,"./teamActionPlan.js":32,"mustache":4}],35:[function(require,module,exports){
var data = require('../data.js'),
  chart = require('../chart.js');

var bd = {

  wireUp: function() {

  },

  show: function(panel, isAppend, subPanels, isDownText, isUpText) {

    var sectionElement = $('<div class="section"></div>');

    if (isAppend) panel.append(sectionElement);
    else panel.html(sectionElement);

    subPanels.forEach(function(v) {
      var args = v.args;
      args.unshift(true);
      args.unshift(sectionElement);
      v.show.apply(null, args);
    });

    if (isUpText) sectionElement.prepend($('<div class="fp-controlArrow fp-up"><div>' + isUpText + '</div></div>'));
    if (isDownText) sectionElement.append($('<div class="fp-controlArrow fp-down"><div>' + isDownText + '</div></div>'));

  }

};

module.exports = bd;

},{"../chart.js":8,"../data.js":9}],36:[function(require,module,exports){
var data = require('./data.js'),
  lookup = require('./lookup.js'),
  base = require('./base.js'),
  patients = require('./panels/patients.js'),
  patientList = require('./panels/patientList.js'),
  teamActionPlan = require('./panels/teamActionPlan.js'),
  allPatients = require('./panels/allPatients.js'),
  welcome = require('./panels/welcome.js'),
  layout = require('./layout.js'),
  overview = require('./views/overview.js'),
  indicatorView = require('./views/indicator.js'),
  patientView = require('./views/patient.js'),
  actionPlan = require('./views/actions.js'),
  Mustache = require('mustache');

var template = {

  loadContent: function(hash, isPoppingState) {
    base.hideTooltips();

    var i, pathwayId, pathwayStage, standard, indicator, patientId;
    if (!isPoppingState) {
      window.location.hash = hash;
    }

    if (hash === '') {
      base.clearBox();
      base.showFooter();
      layout.showPage('login');
      $('html').removeClass('scroll-bar');
    } else {
      base.hideFooter();
      $('html').addClass('scroll-bar');
      var params = {};
      var urlBits = hash.split('/');

      if (hash.indexOf('?') > -1) {
        hash.split('?')[1].split('&').forEach(function(param) {
          var elems = param.split("=");
          params[elems[0]] = elems[1];
        });
        urlBits = hash.split('?')[0].split('/');
      }

      if (urlBits[0] === "#overview" && !urlBits[1]) {

        overview.create(template.loadContent);

      } else if (urlBits[0] === "#indicators") {

        indicatorView.create(urlBits[1], urlBits[2], urlBits[3], params.tab || "trend", template.loadContent);

      } else if (urlBits[0] === "#main") {
        base.clearBox();
        pathwayId = urlBits[1];
        data.pathwayId = pathwayId;
        pathwayStage = urlBits[2];
        var yesPeople = urlBits[3] !== "no";
        standard = urlBits[4];

        if (pathwayStage && layout.page !== 'main-dashboard') {
          $('.page').hide();
          $('#main-dashboard').show();

          ////layout.showSidePanel();
          layout.showOverviewPanels();
          layout.showHeaderBarItems();
        }

        if (pathwayStage) {
          if (yesPeople) {
            template.showPathwayStageViewOk(pathwayId, pathwayStage, template.shouldWeFade(lookup.currentUrl, hash));
          } else {
            template.showPathwayStageView(pathwayId, pathwayStage, standard, template.shouldWeFade(lookup.currentUrl, hash));
          }
        } else {
          template.showOverview(pathwayId);
        }

        base.wireUpTooltips();

      } else if (urlBits[0] === "#help") {
        base.clearBox();
        base.selectTab("");
        layout.showPage('help-page');

        layout.showHeaderBarItems();

      } else if (urlBits[0] === "#patient") {

        //create(pathwayId, pathwayStage, standard, patientId)
        patientView.create(urlBits[2], urlBits[3], urlBits[4], urlBits[1], template.loadContent);

      } else if (urlBits[0] === "#patients") {

        patientId = urlBits[1];

        patientView.create(null, null, null, patientId, template.loadContent);
        /*pathwayId = urlBits[2];

        allPatients.showView(patientId, true);

        base.wireUpTooltips();

        if (patientId) {
          var nhs = data.patLookup ? data.patLookup[patientId] : patientId;
          $('#patients').find('div.table-scroll').getNiceScroll().doScrollPos(0, $('#patients td').filter(function() {
            return $(this).text().trim() === nhs;
          }).position().top - 140);
          $('#patients').find('tr:contains(' + nhs + ')').addClass("highlighted");
        }*/
      } else if (urlBits[0] === "#agreedactions") {

        actionPlan.create();

      } else {
        //if screen not in correct segment then select it
        alert("shouldn't get here");
        pathwayStage = hash.substr(1);

        template.showPathwayStageView(pathwayStage);

        base.wireUpTooltips();
      }
    }

    lookup.currentUrl = hash;
  },

  //Show the overview page for a disease
  showOverview: function(disease) {
    data.pathwayId = disease;

    layout.showMainView(data.diseases.map(function(v) {
      return v.id;
    }).indexOf(disease));

    $('aside li ul li').removeClass('active');
    $('aside a[href="#main/' + disease + '"]:contains("Overview")').parent().addClass('active');

    $('#mainTitle').show();
    base.updateTitle(data.text[data.pathwayId]["display-name"] + ": Overview (practice-level data)");

    //Show overview panels
    template.showOverviewPanels();
    teamActionPlan.show(farRightPanel);
  },

  showOverviewPanels: function() {
    base.switchTo221Layout();

    template.showPanel(lookup.categories.diagnosis.name, topLeftPanel, true);
    template.showPanel(lookup.categories.monitoring.name, topRightPanel, true);
    template.showPanel(lookup.categories.treatment.name, bottomLeftPanel, true);
    template.showPanel(lookup.categories.exclusions.name, bottomRightPanel, true);

    base.wireUpTooltips();
  },

  showPanel: function(pathwayStage, location, enableHover) {
    base.showPathwayStageOverviewPanel(location, enableHover, data.pathwayId, pathwayStage);

    if (enableHover) template.highlightOnHoverAndEnableSelectByClick(location);
    else location.children('div').addClass('unclickable');
  },

  //Show the pathway stage for a disease
  showPathwayStageView: function(pathwayId, pathwayStage, standard, shouldFade) {
    farRightPanel.removeClass('standard-missed-page').removeClass('standard-achieved-page').removeClass('standard-not-relevant-page');
    data.pathwayId = pathwayId;
    layout.showMainView(data.diseases.map(function(v) {
      return v.id;
    }).indexOf(pathwayId));

    $('aside li ul li').removeClass('active');
    var re = new RegExp(pathwayStage, "g");
    $('aside a').filter(function() {
      return this.href.match(re);
    }).parent().addClass('active');

    base.switchTo110Layout();

    if (!standard) {
      standard = Object.keys(data[pathwayId][pathwayStage].standards)[0];
    }

    var panel = patients.create(pathwayId, pathwayStage, standard);

    if (shouldFade) {
      farLeftPanel.fadeOut(100, function() {
        $(this).html(panel);
        patients.wireUp(pathwayId, pathwayStage, farLeftPanel, standard);
        patientList.populate(pathwayId, pathwayStage, standard, null);
        $('#mainTitle').hide();
        base.updateTitle(data.text[pathwayId][pathwayStage].text.page.text, data.text[pathwayId][pathwayStage].text.page.tooltip);
        $(this).fadeIn(100);
      });
    } else {
      farLeftPanel.html(panel);
      patients.wireUp(pathwayId, pathwayStage, farLeftPanel, standard);
      patientList.populate(pathwayId, pathwayStage, standard, null);
      $('#mainTitle').hide();
      base.updateTitle(data.text[pathwayId][pathwayStage].text.page.text, data.text[pathwayId][pathwayStage].text.page.tooltip);
    }

    var tempMust = $('#patient-panel-placeholder').html();
    farRightPanel.html(Mustache.render(tempMust));
  },

  showPathwayStageViewOk: function(pathwayId, pathwayStage, shouldFade) {
    farRightPanel.removeClass('standard-missed-page').removeClass('standard-achieved-page').removeClass('standard-not-relevant-page');
    layout.showMainView(data.diseases.map(function(v) {
      return v.id;
    }).indexOf(pathwayId));

    $('aside li ul li').removeClass('active');
    var re = new RegExp(pathwayStage, "g");
    $('aside a').filter(function() {
      return this.href.match(re);
    }).parent().addClass('active');

    base.switchTo110Layout();

    var panel = patients.createOk(pathwayId, pathwayStage);

    if (shouldFade) {
      farLeftPanel.fadeOut(200, function() {
        $(this).html(panel);
        patients.wireUpOk(pathwayId, pathwayStage, farLeftPanel);
        patients.populateOk(pathwayId, pathwayStage, null);
        $('#mainTitle').hide();
        base.updateTitle(data.text[pathwayId][pathwayStage].text.page.text, data.text[pathwayId][pathwayStage].text.page.tooltip);
        $(this).fadeIn(300);
      });
      var tempMust = $('#patient-panel-placeholder').html();
      farRightPanel.html(Mustache.render(tempMust));
    } else {
      farLeftPanel.html(panel);
      patients.wireUpOk(pathwayId, pathwayStage, farLeftPanel);
      patients.populateOk(pathwayId, pathwayStage, null);
      $('#mainTitle').hide();
      base.updateTitle(data.text[pathwayId][pathwayStage].text.page.text, data.text[pathwayId][pathwayStage].text.page.tooltip);
    }
  },

  highlightOnHoverAndEnableSelectByClick: function(panelSelector) {
    panelSelector.children('div').removeClass('unclickable').on('mouseover', function() {
      $(this).removeClass('panel-default');
    }).on('mouseout', function(e) {
      $(this).addClass('panel-default');
    }).on('click', 'tr.standard-row', function(e) {
      history.pushState(null, null, '#main/' + data.pathwayId + '/' + $(this).closest('.panel').data('stage') + '/no/' + $(this).data('standard'));
      template.loadContent('#main/' + data.pathwayId + '/' + $(this).closest('.panel').data('stage') + '/no/' + $(this).data('standard'), true);
      // do not give a default action
      e.preventDefault();
      e.stopPropagation();
      return false;
    }).on('click', function(e) {
      // keep the link in the browser history
      history.pushState(null, null, '#main/' + data.pathwayId + '/' + $(this).data('stage') + '/no');
      template.loadContent('#main/' + data.pathwayId + '/' + $(this).data('stage') + '/no', true);
      // do not give a default action
      return false;
    });

  },

  displaySelectedPatient: function(id) {
    var nhs = data.patLookup ? data.patLookup[id] : id;

    history.pushState(null, null, '#patients/' + id);
    template.loadContent('#patients/' + id, true);

    $('.list-item').removeClass('highlighted');
    $('.list-item:has(button[data-clipboard-text=' + nhs + '])').addClass('highlighted');

    //scroll to patients
    $('#patients').find('div.table-scroll').getNiceScroll().doScrollPos(0, $('#patients td').filter(function() {
      return $(this).text().trim() === nhs;
    }).position().top - 140);
  },

  shouldWeFade: function(oldHash, newHash) {
    oldHash = oldHash.split('/');
    newHash = newHash.split('/');

    if (oldHash[0] === newHash[0] && oldHash[1] === newHash[1] && oldHash[2] === newHash[2] && oldHash[0] && newHash[0]) return false;
    return true;
  }

};

module.exports = template;

},{"./base.js":7,"./data.js":9,"./layout.js":10,"./lookup.js":12,"./panels/allPatients.js":15,"./panels/patientList.js":27,"./panels/patients.js":29,"./panels/teamActionPlan.js":32,"./panels/welcome.js":34,"./views/actions.js":37,"./views/indicator.js":38,"./views/overview.js":39,"./views/patient.js":40,"mustache":4}],37:[function(require,module,exports){
var base = require('../base.js'),
  layout = require('../layout.js'),
  welcome = require('../panels/welcome.js');

var ID = "ACTION_PLAN_VIEW";

var ap = {

  create: function() {

    base.selectTab("actions");

    if(layout.view !== ID) {
      //Not already in this view so we need to rejig a few things
      base.clearBox();
      layout.showPage('welcome');
      layout.showHeaderBarItems();

      $('#welcome-tabs li').removeClass('active');
      $('#outstandingTasks').closest('li').addClass('active');

      layout.view = ID;
    }

    welcome.populate();

  }

};

module.exports = ap;

},{"../base.js":7,"../layout.js":10,"../panels/welcome.js":34}],38:[function(require,module,exports){
var base = require('../base.js'),
  data = require('../data.js'),
  patientList = require('../panels/patientList.js'),
  indicatorBreakdown = require('../panels/indicatorBreakdown.js'),
  indicatorBenchmark = require('../panels/indicatorBenchmark.js'),
  indicatorTrend = require('../panels/indicatorTrend.js'),
  indicatorHeadlines = require('../panels/indicatorHeadlines.js'),
  teamActionPlan = require('../panels/teamActionPlan.js'),
  wrapper = require('../panels/wrapper.js'),
  layout = require('../layout.js');

var ID = "INDICATOR";
/*
 * The indicator page consists of the panels:
 *   Tabbed panel
 *     - performance trend
 *     - performance benchmark
 *   Patient groups
 *   Patient list
 *   Team action plan
 */

var ind = {

  create: function(pathwayId, pathwayStage, standard, tab, loadContentFn) {

    base.selectTab("indicator");
    base.showLoading();

    //use a setTimeout to force the UI to change e.g. show the loading-container
    //before further execution
    setTimeout(function() {
      if (layout.view !== ID) {
        //Not already in this view so we need to rejig a few things
        base.clearBox();
        //base.switchTo21Layout();
        layout.showMainView();

        base.removeFullPage(farRightPanel);
        base.hidePanels(farRightPanel);

        layout.view = ID;
      }

      if (!pathwayId) {
        if (layout.pathwayId) pathwayId = layout.pathwayId;
        else pathwayId = Object.keys(data.pathwayNames)[0];
      }

      if (!pathwayStage) {
        if (layout.pathwayStage) pathwayStage = layout.pathwayStage;
        else pathwayStage = Object.keys(data.text[pathwayId])[0];
      }

      if (!standard) {
        if (layout.standard) standard = layout.standard;
        else standard = Object.keys(data.text[pathwayId][pathwayStage].standards)[0];
      }

      //if (layout.pathwayId !== pathwayId || layout.pathwayStage !== pathwayStage) {
        //different pathway or stage so title needs updating
        base.updateTitle(data.text[pathwayId][pathwayStage].standards[standard].name);
        /*base.updateTitle([{
          title: "Overview",
          url: "#overview"
        }, {
          title: data.text[pathwayId][pathwayStage].text.page.text,
          tooltip: data.text[pathwayId][pathwayStage].text.page.tooltip
        }]);
        $('#mainTitle').show();*/
      //}

      layout.pathwayId = pathwayId;
      layout.pathwayStage = pathwayStage;
      layout.standard = standard;

      //TODO not sure if this needs moving..?
      data.pathwayId = pathwayId;

      //The three panels we need to show
      //Panels decide whether they need to redraw themselves
      teamActionPlan.show(farLeftPanel);

      base.updateTab("indicators", data.text[pathwayId][pathwayStage].standards[standard].tabText, [pathwayId, pathwayStage, standard].join("/"));

      wrapper.show(farRightPanel, false, [
        {
          show: indicatorHeadlines.show,
          args: [pathwayId, pathwayStage, standard]
        }, {
          show: indicatorBreakdown.show,
          args: [pathwayId, pathwayStage, standard, patientList.selectSubsection]
        }, {
          show: patientList.show,
          args: [pathwayId, pathwayStage, standard, loadContentFn]
        }
      ], "Performance over time", false);
      wrapper.show(farRightPanel, true, [
        {
          show: indicatorTrend.show,
          args: [pathwayId, pathwayStage, standard]
        }
      ], "Benchmarking", "Patients at risk");
      wrapper.show(farRightPanel, true, [
        {
          show: indicatorBenchmark.show,
          args: [pathwayId, pathwayStage, standard]
        }
      ], false, "Performance over time");

      base.addFullPage(farRightPanel);

      $('#indicator-pane').show();

      base.wireUpTooltips();

      /*setTimeout($('.fp-controlArrow').each(function(idx, el) {
        if(el.is(":visible"))
      }), 2000);*/

      base.hideLoading();
    }, 0);
  }

};

module.exports = ind;

},{"../base.js":7,"../data.js":9,"../layout.js":10,"../panels/indicatorBenchmark.js":17,"../panels/indicatorBreakdown.js":18,"../panels/indicatorHeadlines.js":19,"../panels/indicatorTrend.js":21,"../panels/patientList.js":27,"../panels/teamActionPlan.js":32,"../panels/wrapper.js":35}],39:[function(require,module,exports){
var base = require('../base.js'),
  data = require('../data.js'),
  layout = require('../layout.js'),
  indicatorList = require('../panels/indicatorList.js'),
  teamActionPlan = require('../panels/teamActionPlan.js');

var ID = "OVERVIEW";
/*
 * The overview page consists of the panels:
 *   Indicator list
 *   Team action plan
 */
var overview = {

  create: function(loadContentFn) {

    base.selectTab("overview");
    base.showLoading();

    //use a setTimeout to force the UI to change e.g. show the loading-container
    //before further execution
    setTimeout(function() {

      if (layout.view !== ID) {
        //Not already in this view so we need to rejig a few things
        base.clearBox();
        //base.switchTo101Layout();
        layout.showMainView();

        $('#mainTitle').show();
        base.updateTitle("Overview of your practice performance");

        base.removeFullPage(farRightPanel);
        base.hidePanels(farRightPanel);

        layout.view = ID;
      }

      data.pathwayId = "htn"; //TODO fudge

      //The two panels we need to show
      //Panels decide whether they need to redraw themselves
      teamActionPlan.show(farLeftPanel);
      indicatorList.show(farRightPanel, false, loadContentFn);

      $('#overview-pane').show();

      base.wireUpTooltips();
      base.hideLoading();
    }, 0);

  }

};

module.exports = overview;

},{"../base.js":7,"../data.js":9,"../layout.js":10,"../panels/indicatorList.js":20,"../panels/teamActionPlan.js":32}],40:[function(require,module,exports){
var lifeline = require('../panels/lifeline.js'),
  data = require('../data.js'),
  base = require('../base.js'),
  layout = require('../layout.js'),
  individualActionPlan = require('../panels/individualActionPlan.js'),
  qualityStandards = require('../panels/qualityStandards.js'),
  patientCharacteristics = require('../panels/patientCharacteristics.js'),
  patientSearch = require('../panels/patientSearch.js');

var ID = "PATIENT_VIEW";
/*
 * The patient page consists of the panels:
 *   Lifeline chart
 *   Individual action plan
 */

var pv = {

  wireUp: function() {

  },

  create: function(pathwayId, pathwayStage, standard, patientId, loadContentFn) {

    base.selectTab("patient");
    base.showLoading();

    //use a setTimeout to force the UI to change e.g. show the loading-container
    //before further execution
    setTimeout(function() {

      if (layout.view !== ID) {
        //Not already in this view so we need to rejig a few things
        base.clearBox();
        //base.switchTo21Layout();
        layout.showMainView();

        base.removeFullPage(farRightPanel);
        base.hidePanels(farRightPanel);

        layout.view = ID;
      }

      base.hidePanels(farLeftPanel);

      if (patientId) {
        data.getPatientData(patientId, function(patientData) {


          if (layout.pathwayId !== pathwayId || layout.pathwayStage !== pathwayStage ||
            layout.standard !== standard || layout.patientId !== patientId) {
            //different pathway or stage or patientId so title needs updating
            $('#mainTitle').show();

            var patid = (data.patLookup && data.patLookup[patientId] ? data.patLookup[patientId] : patientId);
            var sex = patientData.characteristics.sex.toLowerCase() === "m" ?
              "male" : (patientData.characteristics.sex.toLowerCase() === "f" ? "female" : patientData.characteristics.sex.toLowerCase());
            base.updateTitle("Patient " + patid +
              " - " + patientData.characteristics.age + " year old " + sex);
          }

          base.updateTab("patients", data.patLookup[patientId] || patientId, patientId);

          layout.patientId = patientId;
          data.patientId = patientId;
          data.pathwayId = pathwayId;

          patientSearch.show($('#title-right'), true, loadContentFn);
          qualityStandards.show(farRightPanel, false, patientId);

          lifeline.show(farRightPanel, true, patientId, patientData);
          individualActionPlan.show(farLeftPanel, pathwayId, pathwayStage, standard, patientId);

          patientSearch.wireUp();
          $('#patient-pane').show();

          base.wireUpTooltips();
          base.hideLoading();

        });
      } else {
        base.updateTitle("No patient currently selected");

        patientSearch.show(farRightPanel, true, loadContentFn);

        base.wireUpTooltips();
        base.hideLoading();
      }

    }, 0);

  },

  populate: function() {

  }

};

module.exports = pv;

},{"../base.js":7,"../data.js":9,"../layout.js":10,"../panels/individualActionPlan.js":22,"../panels/lifeline.js":23,"../panels/patientCharacteristics.js":26,"../panels/patientSearch.js":28,"../panels/qualityStandards.js":31}]},{},[6])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvaGlnaGNoYXJ0cy9oaWdoY2hhcnRzLW1vcmUuanMiLCJub2RlX21vZHVsZXMvaGlnaGNoYXJ0cy9oaWdoc3RvY2suanMiLCJub2RlX21vZHVsZXMvanF1ZXJ5LXNwYXJrbGluZS9qcXVlcnkuc3BhcmtsaW5lLmpzIiwibm9kZV9tb2R1bGVzL211c3RhY2hlL211c3RhY2hlLmpzIiwibm9kZV9tb2R1bGVzL3plcm9jbGlwYm9hcmQvZGlzdC9aZXJvQ2xpcGJvYXJkLmpzIiwic2NyaXB0LmpzIiwic3JjL2Jhc2UuanMiLCJzcmMvY2hhcnQuanMiLCJzcmMvZGF0YS5qcyIsInNyYy9sYXlvdXQuanMiLCJzcmMvbG9nLmpzIiwic3JjL2xvb2t1cC5qcyIsInNyYy9tYWluLmpzIiwic3JjL25vdGlmeS5qcyIsInNyYy9wYW5lbHMvYWxsUGF0aWVudHMuanMiLCJzcmMvcGFuZWxzL2NvbmZpcm0uanMiLCJzcmMvcGFuZWxzL2luZGljYXRvckJlbmNobWFyay5qcyIsInNyYy9wYW5lbHMvaW5kaWNhdG9yQnJlYWtkb3duLmpzIiwic3JjL3BhbmVscy9pbmRpY2F0b3JIZWFkbGluZXMuanMiLCJzcmMvcGFuZWxzL2luZGljYXRvckxpc3QuanMiLCJzcmMvcGFuZWxzL2luZGljYXRvclRyZW5kLmpzIiwic3JjL3BhbmVscy9pbmRpdmlkdWFsQWN0aW9uUGxhbi5qcyIsInNyYy9wYW5lbHMvbGlmZWxpbmUuanMiLCJzcmMvcGFuZWxzL21lZGljYXRpb24uanMiLCJzcmMvcGFuZWxzL290aGVyQ29kZXMuanMiLCJzcmMvcGFuZWxzL3BhdGllbnRDaGFyYWN0ZXJpc3RpY3MuanMiLCJzcmMvcGFuZWxzL3BhdGllbnRMaXN0LmpzIiwic3JjL3BhbmVscy9wYXRpZW50U2VhcmNoLmpzIiwic3JjL3BhbmVscy9wYXRpZW50cy5qcyIsInNyYy9wYW5lbHMvcXVhbGl0eVN0YW5kYXJkLmpzIiwic3JjL3BhbmVscy9xdWFsaXR5U3RhbmRhcmRzLmpzIiwic3JjL3BhbmVscy90ZWFtQWN0aW9uUGxhbi5qcyIsInNyYy9wYW5lbHMvdHJlbmQuanMiLCJzcmMvcGFuZWxzL3dlbGNvbWUuanMiLCJzcmMvcGFuZWxzL3dyYXBwZXIuanMiLCJzcmMvdGVtcGxhdGUuanMiLCJzcmMvdmlld3MvYWN0aW9ucy5qcyIsInNyYy92aWV3cy9pbmRpY2F0b3IuanMiLCJzcmMvdmlld3Mvb3ZlcnZpZXcuanMiLCJzcmMvdmlld3MvcGF0aWVudC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xiQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2L0ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNybkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BoRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2YkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdHFCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoaEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDalVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1TkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDWkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3RkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25hQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzckJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOU5BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6WUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0SEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNWQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5Y0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9IQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeERBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiLypcbiBIaWdoY2hhcnRzIEpTIHY0LjIuNSAoMjAxNi0wNS0wNilcblxuIChjKSAyMDA5LTIwMTYgVG9yc3RlaW4gSG9uc2lcblxuIExpY2Vuc2U6IHd3dy5oaWdoY2hhcnRzLmNvbS9saWNlbnNlXG4qL1xuKGZ1bmN0aW9uKG0pe3R5cGVvZiBtb2R1bGU9PT1cIm9iamVjdFwiJiZtb2R1bGUuZXhwb3J0cz9tb2R1bGUuZXhwb3J0cz1tOm0oSGlnaGNoYXJ0cyl9KShmdW5jdGlvbihtKXtmdW5jdGlvbiBNKGEsYixjKXt0aGlzLmluaXQoYSxiLGMpfXZhciBSPW0uYXJyYXlNaW4sUz1tLmFycmF5TWF4LHQ9bS5lYWNoLEg9bS5leHRlbmQsST1tLmlzTnVtYmVyLHU9bS5tZXJnZSxUPW0ubWFwLG89bS5waWNrLEI9bS5wSW50LEc9bS5jb3JyZWN0RmxvYXQscD1tLmdldE9wdGlvbnMoKS5wbG90T3B0aW9ucyxpPW0uc2VyaWVzVHlwZXMsdj1tLmV4dGVuZENsYXNzLE49bS5zcGxhdCx3PW0ud3JhcCxPPW0uQXhpcyx6PW0uVGljayxKPW0uUG9pbnQsVT1tLlBvaW50ZXIsVj1tLkNlbnRlcmVkU2VyaWVzTWl4aW4sQz1tLlRyYWNrZXJNaXhpbix4PW0uU2VyaWVzLHk9TWF0aCxGPXkucm91bmQsRD15LmZsb29yLFA9eS5tYXgsVz1tLkNvbG9yLHI9ZnVuY3Rpb24oKXt9O0goTS5wcm90b3R5cGUse2luaXQ6ZnVuY3Rpb24oYSxcbmIsYyl7dmFyIGQ9dGhpcyxnPWQuZGVmYXVsdE9wdGlvbnM7ZC5jaGFydD1iO2Qub3B0aW9ucz1hPXUoZyxiLmFuZ3VsYXI/e2JhY2tncm91bmQ6e319OnZvaWQgMCxhKTsoYT1hLmJhY2tncm91bmQpJiZ0KFtdLmNvbmNhdChOKGEpKS5yZXZlcnNlKCksZnVuY3Rpb24oYSl7dmFyIGI9YS5iYWNrZ3JvdW5kQ29sb3IsZz1jLnVzZXJPcHRpb25zLGE9dShkLmRlZmF1bHRCYWNrZ3JvdW5kT3B0aW9ucyxhKTtpZihiKWEuYmFja2dyb3VuZENvbG9yPWI7YS5jb2xvcj1hLmJhY2tncm91bmRDb2xvcjtjLm9wdGlvbnMucGxvdEJhbmRzLnVuc2hpZnQoYSk7Zy5wbG90QmFuZHM9Zy5wbG90QmFuZHN8fFtdO2cucGxvdEJhbmRzIT09Yy5vcHRpb25zLnBsb3RCYW5kcyYmZy5wbG90QmFuZHMudW5zaGlmdChhKX0pfSxkZWZhdWx0T3B0aW9uczp7Y2VudGVyOltcIjUwJVwiLFwiNTAlXCJdLHNpemU6XCI4NSVcIixzdGFydEFuZ2xlOjB9LGRlZmF1bHRCYWNrZ3JvdW5kT3B0aW9uczp7c2hhcGU6XCJjaXJjbGVcIixcbmJvcmRlcldpZHRoOjEsYm9yZGVyQ29sb3I6XCJzaWx2ZXJcIixiYWNrZ3JvdW5kQ29sb3I6e2xpbmVhckdyYWRpZW50Ont4MTowLHkxOjAseDI6MCx5MjoxfSxzdG9wczpbWzAsXCIjRkZGXCJdLFsxLFwiI0RERFwiXV19LGZyb206LU51bWJlci5NQVhfVkFMVUUsaW5uZXJSYWRpdXM6MCx0bzpOdW1iZXIuTUFYX1ZBTFVFLG91dGVyUmFkaXVzOlwiMTA1JVwifX0pO3ZhciBBPU8ucHJvdG90eXBlLHo9ei5wcm90b3R5cGUsWD17Z2V0T2Zmc2V0OnIscmVkcmF3OmZ1bmN0aW9uKCl7dGhpcy5pc0RpcnR5PSExfSxyZW5kZXI6ZnVuY3Rpb24oKXt0aGlzLmlzRGlydHk9ITF9LHNldFNjYWxlOnIsc2V0Q2F0ZWdvcmllczpyLHNldFRpdGxlOnJ9LFE9e2lzUmFkaWFsOiEwLGRlZmF1bHRSYWRpYWxHYXVnZU9wdGlvbnM6e2xhYmVsczp7YWxpZ246XCJjZW50ZXJcIix4OjAseTpudWxsfSxtaW5vckdyaWRMaW5lV2lkdGg6MCxtaW5vclRpY2tJbnRlcnZhbDpcImF1dG9cIixtaW5vclRpY2tMZW5ndGg6MTAsbWlub3JUaWNrUG9zaXRpb246XCJpbnNpZGVcIixcbm1pbm9yVGlja1dpZHRoOjEsdGlja0xlbmd0aDoxMCx0aWNrUG9zaXRpb246XCJpbnNpZGVcIix0aWNrV2lkdGg6Mix0aXRsZTp7cm90YXRpb246MH0sekluZGV4OjJ9LGRlZmF1bHRSYWRpYWxYT3B0aW9uczp7Z3JpZExpbmVXaWR0aDoxLGxhYmVsczp7YWxpZ246bnVsbCxkaXN0YW5jZToxNSx4OjAseTpudWxsfSxtYXhQYWRkaW5nOjAsbWluUGFkZGluZzowLHNob3dMYXN0TGFiZWw6ITEsdGlja0xlbmd0aDowfSxkZWZhdWx0UmFkaWFsWU9wdGlvbnM6e2dyaWRMaW5lSW50ZXJwb2xhdGlvbjpcImNpcmNsZVwiLGxhYmVsczp7YWxpZ246XCJyaWdodFwiLHg6LTMseTotMn0sc2hvd0xhc3RMYWJlbDohMSx0aXRsZTp7eDo0LHRleHQ6bnVsbCxyb3RhdGlvbjo5MH19LHNldE9wdGlvbnM6ZnVuY3Rpb24oYSl7YT10aGlzLm9wdGlvbnM9dSh0aGlzLmRlZmF1bHRPcHRpb25zLHRoaXMuZGVmYXVsdFJhZGlhbE9wdGlvbnMsYSk7aWYoIWEucGxvdEJhbmRzKWEucGxvdEJhbmRzPVtdfSxnZXRPZmZzZXQ6ZnVuY3Rpb24oKXtBLmdldE9mZnNldC5jYWxsKHRoaXMpO1xudGhpcy5jaGFydC5heGlzT2Zmc2V0W3RoaXMuc2lkZV09MDt0aGlzLmNlbnRlcj10aGlzLnBhbmUuY2VudGVyPVYuZ2V0Q2VudGVyLmNhbGwodGhpcy5wYW5lKX0sZ2V0TGluZVBhdGg6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmNlbnRlcixiPW8oYixjWzJdLzItdGhpcy5vZmZzZXQpO3JldHVybiB0aGlzLmNoYXJ0LnJlbmRlcmVyLnN5bWJvbHMuYXJjKHRoaXMubGVmdCtjWzBdLHRoaXMudG9wK2NbMV0sYixiLHtzdGFydDp0aGlzLnN0YXJ0QW5nbGVSYWQsZW5kOnRoaXMuZW5kQW5nbGVSYWQsb3BlbjohMCxpbm5lclI6MH0pfSxzZXRBeGlzVHJhbnNsYXRpb246ZnVuY3Rpb24oKXtBLnNldEF4aXNUcmFuc2xhdGlvbi5jYWxsKHRoaXMpO2lmKHRoaXMuY2VudGVyKXRoaXMudHJhbnNBPXRoaXMuaXNDaXJjdWxhcj8odGhpcy5lbmRBbmdsZVJhZC10aGlzLnN0YXJ0QW5nbGVSYWQpLyh0aGlzLm1heC10aGlzLm1pbnx8MSk6dGhpcy5jZW50ZXJbMl0vMi8odGhpcy5tYXgtdGhpcy5taW58fFxuMSksdGhpcy5taW5QaXhlbFBhZGRpbmc9dGhpcy5pc1hBeGlzP3RoaXMudHJhbnNBKnRoaXMubWluUG9pbnRPZmZzZXQ6MH0sYmVmb3JlU2V0VGlja1Bvc2l0aW9uczpmdW5jdGlvbigpe3RoaXMuYXV0b0Nvbm5lY3QmJih0aGlzLm1heCs9dGhpcy5jYXRlZ29yaWVzJiYxfHx0aGlzLnBvaW50UmFuZ2V8fHRoaXMuY2xvc2VzdFBvaW50UmFuZ2V8fDApfSxzZXRBeGlzU2l6ZTpmdW5jdGlvbigpe0Euc2V0QXhpc1NpemUuY2FsbCh0aGlzKTtpZih0aGlzLmlzUmFkaWFsKXt0aGlzLmNlbnRlcj10aGlzLnBhbmUuY2VudGVyPW0uQ2VudGVyZWRTZXJpZXNNaXhpbi5nZXRDZW50ZXIuY2FsbCh0aGlzLnBhbmUpO2lmKHRoaXMuaXNDaXJjdWxhcil0aGlzLnNlY3Rvcj10aGlzLmVuZEFuZ2xlUmFkLXRoaXMuc3RhcnRBbmdsZVJhZDt0aGlzLmxlbj10aGlzLndpZHRoPXRoaXMuaGVpZ2h0PXRoaXMuY2VudGVyWzJdKm8odGhpcy5zZWN0b3IsMSkvMn19LGdldFBvc2l0aW9uOmZ1bmN0aW9uKGEsXG5iKXtyZXR1cm4gdGhpcy5wb3N0VHJhbnNsYXRlKHRoaXMuaXNDaXJjdWxhcj90aGlzLnRyYW5zbGF0ZShhKTowLG8odGhpcy5pc0NpcmN1bGFyP2I6dGhpcy50cmFuc2xhdGUoYSksdGhpcy5jZW50ZXJbMl0vMiktdGhpcy5vZmZzZXQpfSxwb3N0VHJhbnNsYXRlOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5jaGFydCxkPXRoaXMuY2VudGVyLGE9dGhpcy5zdGFydEFuZ2xlUmFkK2E7cmV0dXJue3g6Yy5wbG90TGVmdCtkWzBdK01hdGguY29zKGEpKmIseTpjLnBsb3RUb3ArZFsxXStNYXRoLnNpbihhKSpifX0sZ2V0UGxvdEJhbmRQYXRoOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD10aGlzLmNlbnRlcixnPXRoaXMuc3RhcnRBbmdsZVJhZCxlPWRbMl0vMixqPVtvKGMub3V0ZXJSYWRpdXMsXCIxMDAlXCIpLGMuaW5uZXJSYWRpdXMsbyhjLnRoaWNrbmVzcywxMCldLGw9LyUkLyxoLGY9dGhpcy5pc0NpcmN1bGFyO3RoaXMub3B0aW9ucy5ncmlkTGluZUludGVycG9sYXRpb249PT1cInBvbHlnb25cIj9cbmQ9dGhpcy5nZXRQbG90TGluZVBhdGgoYSkuY29uY2F0KHRoaXMuZ2V0UGxvdExpbmVQYXRoKGIsITApKTooYT1NYXRoLm1heChhLHRoaXMubWluKSxiPU1hdGgubWluKGIsdGhpcy5tYXgpLGZ8fChqWzBdPXRoaXMudHJhbnNsYXRlKGEpLGpbMV09dGhpcy50cmFuc2xhdGUoYikpLGo9VChqLGZ1bmN0aW9uKGEpe2wudGVzdChhKSYmKGE9QihhLDEwKSplLzEwMCk7cmV0dXJuIGF9KSxjLnNoYXBlPT09XCJjaXJjbGVcInx8IWY/KGE9LU1hdGguUEkvMixiPU1hdGguUEkqMS41LGg9ITApOihhPWcrdGhpcy50cmFuc2xhdGUoYSksYj1nK3RoaXMudHJhbnNsYXRlKGIpKSxkPXRoaXMuY2hhcnQucmVuZGVyZXIuc3ltYm9scy5hcmModGhpcy5sZWZ0K2RbMF0sdGhpcy50b3ArZFsxXSxqWzBdLGpbMF0se3N0YXJ0Ok1hdGgubWluKGEsYiksZW5kOk1hdGgubWF4KGEsYiksaW5uZXJSOm8oalsxXSxqWzBdLWpbMl0pLG9wZW46aH0pKTtyZXR1cm4gZH0sZ2V0UGxvdExpbmVQYXRoOmZ1bmN0aW9uKGEsXG5iKXt2YXIgYz10aGlzLGQ9Yy5jZW50ZXIsZz1jLmNoYXJ0LGU9Yy5nZXRQb3NpdGlvbihhKSxqLGwsaDtjLmlzQ2lyY3VsYXI/aD1bXCJNXCIsZFswXStnLnBsb3RMZWZ0LGRbMV0rZy5wbG90VG9wLFwiTFwiLGUueCxlLnldOmMub3B0aW9ucy5ncmlkTGluZUludGVycG9sYXRpb249PT1cImNpcmNsZVwiPyhhPWMudHJhbnNsYXRlKGEpKSYmKGg9Yy5nZXRMaW5lUGF0aCgwLGEpKToodChnLnhBeGlzLGZ1bmN0aW9uKGEpe2EucGFuZT09PWMucGFuZSYmKGo9YSl9KSxoPVtdLGE9Yy50cmFuc2xhdGUoYSksZD1qLnRpY2tQb3NpdGlvbnMsai5hdXRvQ29ubmVjdCYmKGQ9ZC5jb25jYXQoW2RbMF1dKSksYiYmKGQ9W10uY29uY2F0KGQpLnJldmVyc2UoKSksdChkLGZ1bmN0aW9uKGUsYil7bD1qLmdldFBvc2l0aW9uKGUsYSk7aC5wdXNoKGI/XCJMXCI6XCJNXCIsbC54LGwueSl9KSk7cmV0dXJuIGh9LGdldFRpdGxlUG9zaXRpb246ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmNlbnRlcixiPXRoaXMuY2hhcnQsXG5jPXRoaXMub3B0aW9ucy50aXRsZTtyZXR1cm57eDpiLnBsb3RMZWZ0K2FbMF0rKGMueHx8MCkseTpiLnBsb3RUb3ArYVsxXS17aGlnaDowLjUsbWlkZGxlOjAuMjUsbG93OjB9W2MuYWxpZ25dKmFbMl0rKGMueXx8MCl9fX07dyhBLFwiaW5pdFwiLGZ1bmN0aW9uKGEsYixjKXt2YXIgazt2YXIgZD1iLmFuZ3VsYXIsZz1iLnBvbGFyLGU9Yy5pc1gsaj1kJiZlLGwsaDtoPWIub3B0aW9uczt2YXIgZj1jLnBhbmV8fDA7aWYoZCl7aWYoSCh0aGlzLGo/WDpRKSxsPSFlKXRoaXMuZGVmYXVsdFJhZGlhbE9wdGlvbnM9dGhpcy5kZWZhdWx0UmFkaWFsR2F1Z2VPcHRpb25zfWVsc2UgaWYoZylIKHRoaXMsUSksdGhpcy5kZWZhdWx0UmFkaWFsT3B0aW9ucz0obD1lKT90aGlzLmRlZmF1bHRSYWRpYWxYT3B0aW9uczp1KHRoaXMuZGVmYXVsdFlBeGlzT3B0aW9ucyx0aGlzLmRlZmF1bHRSYWRpYWxZT3B0aW9ucyk7aWYoZHx8ZyliLmludmVydGVkPSExLGguY2hhcnQuem9vbVR5cGU9bnVsbDthLmNhbGwodGhpcyxcbmIsYyk7aWYoIWomJihkfHxnKSl7YT10aGlzLm9wdGlvbnM7aWYoIWIucGFuZXMpYi5wYW5lcz1bXTt0aGlzLnBhbmU9KGs9Yi5wYW5lc1tmXT1iLnBhbmVzW2ZdfHxuZXcgTShOKGgucGFuZSlbZl0sYix0aGlzKSxiPWspO2g9Yi5vcHRpb25zO3RoaXMuc3RhcnRBbmdsZVJhZD1iPShoLnN0YXJ0QW5nbGUtOTApKk1hdGguUEkvMTgwO3RoaXMuZW5kQW5nbGVSYWQ9aD0obyhoLmVuZEFuZ2xlLGguc3RhcnRBbmdsZSszNjApLTkwKSpNYXRoLlBJLzE4MDt0aGlzLm9mZnNldD1hLm9mZnNldHx8MDtpZigodGhpcy5pc0NpcmN1bGFyPWwpJiZjLm1heD09PXZvaWQgMCYmaC1iPT09MipNYXRoLlBJKXRoaXMuYXV0b0Nvbm5lY3Q9ITB9fSk7dyhBLFwiYXV0b0xhYmVsQWxpZ25cIixmdW5jdGlvbihhKXtpZighdGhpcy5pc1JhZGlhbClyZXR1cm4gYS5hcHBseSh0aGlzLFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpKX0pO3coeixcImdldFBvc2l0aW9uXCIsZnVuY3Rpb24oYSxiLGMsZCxnKXt2YXIgZT1cbnRoaXMuYXhpcztyZXR1cm4gZS5nZXRQb3NpdGlvbj9lLmdldFBvc2l0aW9uKGMpOmEuY2FsbCh0aGlzLGIsYyxkLGcpfSk7dyh6LFwiZ2V0TGFiZWxQb3NpdGlvblwiLGZ1bmN0aW9uKGEsYixjLGQsZyxlLGosbCxoKXt2YXIgZj10aGlzLmF4aXMsaz1lLnksbj0yMCxzPWUuYWxpZ24saT0oZi50cmFuc2xhdGUodGhpcy5wb3MpK2Yuc3RhcnRBbmdsZVJhZCtNYXRoLlBJLzIpL01hdGguUEkqMTgwJTM2MDtmLmlzUmFkaWFsPyhhPWYuZ2V0UG9zaXRpb24odGhpcy5wb3MsZi5jZW50ZXJbMl0vMitvKGUuZGlzdGFuY2UsLTI1KSksZS5yb3RhdGlvbj09PVwiYXV0b1wiP2QuYXR0cih7cm90YXRpb246aX0pOms9PT1udWxsJiYoaz1mLmNoYXJ0LnJlbmRlcmVyLmZvbnRNZXRyaWNzKGQuc3R5bGVzLmZvbnRTaXplKS5iLWQuZ2V0QkJveCgpLmhlaWdodC8yKSxzPT09bnVsbCYmKGYuaXNDaXJjdWxhcj8odGhpcy5sYWJlbC5nZXRCQm94KCkud2lkdGg+Zi5sZW4qZi50aWNrSW50ZXJ2YWwvKGYubWF4LVxuZi5taW4pJiYobj0wKSxzPWk+biYmaTwxODAtbj9cImxlZnRcIjppPjE4MCtuJiZpPDM2MC1uP1wicmlnaHRcIjpcImNlbnRlclwiKTpzPVwiY2VudGVyXCIsZC5hdHRyKHthbGlnbjpzfSkpLGEueCs9ZS54LGEueSs9ayk6YT1hLmNhbGwodGhpcyxiLGMsZCxnLGUsaixsLGgpO3JldHVybiBhfSk7dyh6LFwiZ2V0TWFya1BhdGhcIixmdW5jdGlvbihhLGIsYyxkLGcsZSxqKXt2YXIgbD10aGlzLmF4aXM7bC5pc1JhZGlhbD8oYT1sLmdldFBvc2l0aW9uKHRoaXMucG9zLGwuY2VudGVyWzJdLzIrZCksYj1bXCJNXCIsYixjLFwiTFwiLGEueCxhLnldKTpiPWEuY2FsbCh0aGlzLGIsYyxkLGcsZSxqKTtyZXR1cm4gYn0pO3AuYXJlYXJhbmdlPXUocC5hcmVhLHtsaW5lV2lkdGg6MSxtYXJrZXI6bnVsbCx0aHJlc2hvbGQ6bnVsbCx0b29sdGlwOntwb2ludEZvcm1hdDonPHNwYW4gc3R5bGU9XCJjb2xvcjp7c2VyaWVzLmNvbG9yfVwiPlxcdTI1Y2Y8L3NwYW4+IHtzZXJpZXMubmFtZX06IDxiPntwb2ludC5sb3d9PC9iPiAtIDxiPntwb2ludC5oaWdofTwvYj48YnIvPid9LFxudHJhY2tCeUFyZWE6ITAsZGF0YUxhYmVsczp7YWxpZ246bnVsbCx2ZXJ0aWNhbEFsaWduOm51bGwseExvdzowLHhIaWdoOjAseUxvdzowLHlIaWdoOjB9LHN0YXRlczp7aG92ZXI6e2hhbG86ITF9fX0pO2kuYXJlYXJhbmdlPXYoaS5hcmVhLHt0eXBlOlwiYXJlYXJhbmdlXCIscG9pbnRBcnJheU1hcDpbXCJsb3dcIixcImhpZ2hcIl0sZGF0YUxhYmVsQ29sbGVjdGlvbnM6W1wiZGF0YUxhYmVsXCIsXCJkYXRhTGFiZWxVcHBlclwiXSx0b1lEYXRhOmZ1bmN0aW9uKGEpe3JldHVyblthLmxvdyxhLmhpZ2hdfSxwb2ludFZhbEtleTpcImxvd1wiLGRlZmVyVHJhbnNsYXRlUG9sYXI6ITAsaGlnaFRvWFk6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jaGFydCxjPXRoaXMueEF4aXMucG9zdFRyYW5zbGF0ZShhLnJlY3RQbG90WCx0aGlzLnlBeGlzLmxlbi1hLnBsb3RIaWdoKTthLnBsb3RIaWdoWD1jLngtYi5wbG90TGVmdDthLnBsb3RIaWdoPWMueS1iLnBsb3RUb3B9LHRyYW5zbGF0ZTpmdW5jdGlvbigpe3ZhciBhPVxudGhpcyxiPWEueUF4aXM7aS5hcmVhLnByb3RvdHlwZS50cmFuc2xhdGUuYXBwbHkoYSk7dChhLnBvaW50cyxmdW5jdGlvbihhKXt2YXIgZD1hLmxvdyxnPWEuaGlnaCxlPWEucGxvdFk7Zz09PW51bGx8fGQ9PT1udWxsP2EuaXNOdWxsPSEwOihhLnBsb3RMb3c9ZSxhLnBsb3RIaWdoPWIudHJhbnNsYXRlKGcsMCwxLDAsMSkpfSk7dGhpcy5jaGFydC5wb2xhciYmdCh0aGlzLnBvaW50cyxmdW5jdGlvbihiKXthLmhpZ2hUb1hZKGIpfSl9LGdldEdyYXBoUGF0aDpmdW5jdGlvbigpe3ZhciBhPXRoaXMucG9pbnRzLGI9W10sYz1bXSxkPWEubGVuZ3RoLGc9eC5wcm90b3R5cGUuZ2V0R3JhcGhQYXRoLGUsaixsO2w9dGhpcy5vcHRpb25zO2Zvcih2YXIgaD1sLnN0ZXAsZD1hLmxlbmd0aDtkLS07KWU9YVtkXSwhZS5pc051bGwmJighYVtkKzFdfHxhW2QrMV0uaXNOdWxsKSYmYy5wdXNoKHtwbG90WDplLnBsb3RYLHBsb3RZOmUucGxvdExvd30pLGo9e3Bsb3RYOmUucGxvdFgscGxvdFk6ZS5wbG90SGlnaCxcbmlzTnVsbDplLmlzTnVsbH0sYy5wdXNoKGopLGIucHVzaChqKSwhZS5pc051bGwmJighYVtkLTFdfHxhW2QtMV0uaXNOdWxsKSYmYy5wdXNoKHtwbG90WDplLnBsb3RYLHBsb3RZOmUucGxvdExvd30pO2E9Zy5jYWxsKHRoaXMsYSk7aWYoaCloPT09ITAmJihoPVwibGVmdFwiKSxsLnN0ZXA9e2xlZnQ6XCJyaWdodFwiLGNlbnRlcjpcImNlbnRlclwiLHJpZ2h0OlwibGVmdFwifVtoXTtiPWcuY2FsbCh0aGlzLGIpO2M9Zy5jYWxsKHRoaXMsYyk7bC5zdGVwPWg7bD1bXS5jb25jYXQoYSxiKTshdGhpcy5jaGFydC5wb2xhciYmY1swXT09PVwiTVwiJiYoY1swXT1cIkxcIik7dGhpcy5hcmVhUGF0aD10aGlzLmFyZWFQYXRoLmNvbmNhdChhLGMpO3JldHVybiBsfSxkcmF3RGF0YUxhYmVsczpmdW5jdGlvbigpe3ZhciBhPXRoaXMuZGF0YSxiPWEubGVuZ3RoLGMsZD1bXSxnPXgucHJvdG90eXBlLGU9dGhpcy5vcHRpb25zLmRhdGFMYWJlbHMsaj1lLmFsaWduLGw9ZS52ZXJ0aWNhbEFsaWduLGg9ZS5pbnNpZGUsZixcbmssbj10aGlzLmNoYXJ0LmludmVydGVkO2lmKGUuZW5hYmxlZHx8dGhpcy5faGFzUG9pbnRMYWJlbHMpe2ZvcihjPWI7Yy0tOylpZihmPWFbY10pe2s9aD9mLnBsb3RIaWdoPGYucGxvdExvdzpmLnBsb3RIaWdoPmYucGxvdExvdztmLnk9Zi5oaWdoO2YuX3Bsb3RZPWYucGxvdFk7Zi5wbG90WT1mLnBsb3RIaWdoO2RbY109Zi5kYXRhTGFiZWw7Zi5kYXRhTGFiZWw9Zi5kYXRhTGFiZWxVcHBlcjtmLmJlbG93PWs7aWYobil7aWYoIWopZS5hbGlnbj1rP1wicmlnaHRcIjpcImxlZnRcIn1lbHNlIGlmKCFsKWUudmVydGljYWxBbGlnbj1rP1widG9wXCI6XCJib3R0b21cIjtlLng9ZS54SGlnaDtlLnk9ZS55SGlnaH1nLmRyYXdEYXRhTGFiZWxzJiZnLmRyYXdEYXRhTGFiZWxzLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtmb3IoYz1iO2MtLTspaWYoZj1hW2NdKXtrPWg/Zi5wbG90SGlnaDxmLnBsb3RMb3c6Zi5wbG90SGlnaD5mLnBsb3RMb3c7Zi5kYXRhTGFiZWxVcHBlcj1mLmRhdGFMYWJlbDtmLmRhdGFMYWJlbD1cbmRbY107Zi55PWYubG93O2YucGxvdFk9Zi5fcGxvdFk7Zi5iZWxvdz0haztpZihuKXtpZighaillLmFsaWduPWs/XCJsZWZ0XCI6XCJyaWdodFwifWVsc2UgaWYoIWwpZS52ZXJ0aWNhbEFsaWduPWs/XCJib3R0b21cIjpcInRvcFwiO2UueD1lLnhMb3c7ZS55PWUueUxvd31nLmRyYXdEYXRhTGFiZWxzJiZnLmRyYXdEYXRhTGFiZWxzLmFwcGx5KHRoaXMsYXJndW1lbnRzKX1lLmFsaWduPWo7ZS52ZXJ0aWNhbEFsaWduPWx9LGFsaWduRGF0YUxhYmVsOmZ1bmN0aW9uKCl7aS5jb2x1bW4ucHJvdG90eXBlLmFsaWduRGF0YUxhYmVsLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sc2V0U3RhY2tlZFBvaW50czpyLGdldFN5bWJvbDpyLGRyYXdQb2ludHM6cn0pO3AuYXJlYXNwbGluZXJhbmdlPXUocC5hcmVhcmFuZ2UpO2kuYXJlYXNwbGluZXJhbmdlPXYoaS5hcmVhcmFuZ2Use3R5cGU6XCJhcmVhc3BsaW5lcmFuZ2VcIixnZXRQb2ludFNwbGluZTppLnNwbGluZS5wcm90b3R5cGUuZ2V0UG9pbnRTcGxpbmV9KTtcbihmdW5jdGlvbigpe3ZhciBhPWkuY29sdW1uLnByb3RvdHlwZTtwLmNvbHVtbnJhbmdlPXUocC5jb2x1bW4scC5hcmVhcmFuZ2Use2xpbmVXaWR0aDoxLHBvaW50UmFuZ2U6bnVsbH0pO2kuY29sdW1ucmFuZ2U9dihpLmFyZWFyYW5nZSx7dHlwZTpcImNvbHVtbnJhbmdlXCIsdHJhbnNsYXRlOmZ1bmN0aW9uKCl7dmFyIGI9dGhpcyxjPWIueUF4aXMsZD1iLnhBeGlzLGc9ZC5zdGFydEFuZ2xlUmFkLGUsaj1iLmNoYXJ0LGw9Yi54QXhpcy5pc1JhZGlhbCxoO2EudHJhbnNsYXRlLmFwcGx5KGIpO3QoYi5wb2ludHMsZnVuY3Rpb24oYSl7dmFyIGs9YS5zaGFwZUFyZ3Msbj1iLm9wdGlvbnMubWluUG9pbnRMZW5ndGgscyxpO2EucGxvdEhpZ2g9aD1jLnRyYW5zbGF0ZShhLmhpZ2gsMCwxLDAsMSk7YS5wbG90TG93PWEucGxvdFk7aT1oO3M9byhhLnJlY3RQbG90WSxhLnBsb3RZKS1oO01hdGguYWJzKHMpPG4/KG4tPXMscys9bixpLT1uLzIpOnM8MCYmKHMqPS0xLGktPXMpO2w/KGU9YS5iYXJYK1xuZyxhLnNoYXBlVHlwZT1cInBhdGhcIixhLnNoYXBlQXJncz17ZDpiLnBvbGFyQXJjKGkrcyxpLGUsZSthLnBvaW50V2lkdGgpfSk6KGsuaGVpZ2h0PXMsay55PWksYS50b29sdGlwUG9zPWouaW52ZXJ0ZWQ/W2MubGVuK2MucG9zLWoucGxvdExlZnQtaS1zLzIsZC5sZW4rZC5wb3Mtai5wbG90VG9wLWsueC1rLndpZHRoLzIsc106W2QubGVmdC1qLnBsb3RMZWZ0K2sueCtrLndpZHRoLzIsYy5wb3Mtai5wbG90VG9wK2krcy8yLHNdKX0pfSxkaXJlY3RUb3VjaDohMCx0cmFja2VyR3JvdXBzOltcImdyb3VwXCIsXCJkYXRhTGFiZWxzR3JvdXBcIl0sZHJhd0dyYXBoOnIsY3Jpc3BDb2w6YS5jcmlzcENvbCxwb2ludEF0dHJUb09wdGlvbnM6YS5wb2ludEF0dHJUb09wdGlvbnMsZHJhd1BvaW50czphLmRyYXdQb2ludHMsZHJhd1RyYWNrZXI6YS5kcmF3VHJhY2tlcixnZXRDb2x1bW5NZXRyaWNzOmEuZ2V0Q29sdW1uTWV0cmljcyxhbmltYXRlOmZ1bmN0aW9uKCl7cmV0dXJuIGEuYW5pbWF0ZS5hcHBseSh0aGlzLFxuYXJndW1lbnRzKX0scG9sYXJBcmM6ZnVuY3Rpb24oKXtyZXR1cm4gYS5wb2xhckFyYy5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fSl9KSgpO3AuZ2F1Z2U9dShwLmxpbmUse2RhdGFMYWJlbHM6e2VuYWJsZWQ6ITAsZGVmZXI6ITEseToxNSxib3JkZXJXaWR0aDoxLGJvcmRlckNvbG9yOlwic2lsdmVyXCIsYm9yZGVyUmFkaXVzOjMsY3JvcDohMSx2ZXJ0aWNhbEFsaWduOlwidG9wXCIsekluZGV4OjJ9LGRpYWw6e30scGl2b3Q6e30sdG9vbHRpcDp7aGVhZGVyRm9ybWF0OlwiXCJ9LHNob3dJbkxlZ2VuZDohMX0pO0M9e3R5cGU6XCJnYXVnZVwiLHBvaW50Q2xhc3M6dihKLHtzZXRTdGF0ZTpmdW5jdGlvbihhKXt0aGlzLnN0YXRlPWF9fSksYW5ndWxhcjohMCxkaXJlY3RUb3VjaDohMCxkcmF3R3JhcGg6cixmaXhlZEJveDohMCxmb3JjZURMOiEwLHRyYWNrZXJHcm91cHM6W1wiZ3JvdXBcIixcImRhdGFMYWJlbHNHcm91cFwiXSx0cmFuc2xhdGU6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLnlBeGlzLGI9dGhpcy5vcHRpb25zLFxuYz1hLmNlbnRlcjt0aGlzLmdlbmVyYXRlUG9pbnRzKCk7dCh0aGlzLnBvaW50cyxmdW5jdGlvbihkKXt2YXIgZz11KGIuZGlhbCxkLmRpYWwpLGU9QihvKGcucmFkaXVzLDgwKSkqY1syXS8yMDAsaj1CKG8oZy5iYXNlTGVuZ3RoLDcwKSkqZS8xMDAsbD1CKG8oZy5yZWFyTGVuZ3RoLDEwKSkqZS8xMDAsaD1nLmJhc2VXaWR0aHx8MyxmPWcudG9wV2lkdGh8fDEsaz1iLm92ZXJzaG9vdCxuPWEuc3RhcnRBbmdsZVJhZCthLnRyYW5zbGF0ZShkLnksbnVsbCxudWxsLG51bGwsITApO0koayk/KGs9ay8xODAqTWF0aC5QSSxuPU1hdGgubWF4KGEuc3RhcnRBbmdsZVJhZC1rLE1hdGgubWluKGEuZW5kQW5nbGVSYWQrayxuKSkpOmIud3JhcD09PSExJiYobj1NYXRoLm1heChhLnN0YXJ0QW5nbGVSYWQsTWF0aC5taW4oYS5lbmRBbmdsZVJhZCxuKSkpO249bioxODAvTWF0aC5QSTtkLnNoYXBlVHlwZT1cInBhdGhcIjtkLnNoYXBlQXJncz17ZDpnLnBhdGh8fFtcIk1cIiwtbCwtaC8yLFwiTFwiLGosLWgvXG4yLGUsLWYvMixlLGYvMixqLGgvMiwtbCxoLzIsXCJ6XCJdLHRyYW5zbGF0ZVg6Y1swXSx0cmFuc2xhdGVZOmNbMV0scm90YXRpb246bn07ZC5wbG90WD1jWzBdO2QucGxvdFk9Y1sxXX0pfSxkcmF3UG9pbnRzOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEueUF4aXMuY2VudGVyLGM9YS5waXZvdCxkPWEub3B0aW9ucyxnPWQucGl2b3QsZT1hLmNoYXJ0LnJlbmRlcmVyO3QoYS5wb2ludHMsZnVuY3Rpb24oYil7dmFyIGc9Yi5ncmFwaGljLGM9Yi5zaGFwZUFyZ3MsZj1jLmQsaz11KGQuZGlhbCxiLmRpYWwpO2c/KGcuYW5pbWF0ZShjKSxjLmQ9Zik6Yi5ncmFwaGljPWVbYi5zaGFwZVR5cGVdKGMpLmF0dHIoe3N0cm9rZTprLmJvcmRlckNvbG9yfHxcIm5vbmVcIixcInN0cm9rZS13aWR0aFwiOmsuYm9yZGVyV2lkdGh8fDAsZmlsbDprLmJhY2tncm91bmRDb2xvcnx8XCJibGFja1wiLHJvdGF0aW9uOmMucm90YXRpb24sekluZGV4OjF9KS5hZGQoYS5ncm91cCl9KTtjP2MuYW5pbWF0ZSh7dHJhbnNsYXRlWDpiWzBdLFxudHJhbnNsYXRlWTpiWzFdfSk6YS5waXZvdD1lLmNpcmNsZSgwLDAsbyhnLnJhZGl1cyw1KSkuYXR0cih7XCJzdHJva2Utd2lkdGhcIjpnLmJvcmRlcldpZHRofHwwLHN0cm9rZTpnLmJvcmRlckNvbG9yfHxcInNpbHZlclwiLGZpbGw6Zy5iYWNrZ3JvdW5kQ29sb3J8fFwiYmxhY2tcIix6SW5kZXg6Mn0pLnRyYW5zbGF0ZShiWzBdLGJbMV0pLmFkZChhLmdyb3VwKX0sYW5pbWF0ZTpmdW5jdGlvbihhKXt2YXIgYj10aGlzO2lmKCFhKXQoYi5wb2ludHMsZnVuY3Rpb24oYSl7dmFyIGQ9YS5ncmFwaGljO2QmJihkLmF0dHIoe3JvdGF0aW9uOmIueUF4aXMuc3RhcnRBbmdsZVJhZCoxODAvTWF0aC5QSX0pLGQuYW5pbWF0ZSh7cm90YXRpb246YS5zaGFwZUFyZ3Mucm90YXRpb259LGIub3B0aW9ucy5hbmltYXRpb24pKX0pLGIuYW5pbWF0ZT1udWxsfSxyZW5kZXI6ZnVuY3Rpb24oKXt0aGlzLmdyb3VwPXRoaXMucGxvdEdyb3VwKFwiZ3JvdXBcIixcInNlcmllc1wiLHRoaXMudmlzaWJsZT9cInZpc2libGVcIjpcImhpZGRlblwiLFxudGhpcy5vcHRpb25zLnpJbmRleCx0aGlzLmNoYXJ0LnNlcmllc0dyb3VwKTt4LnByb3RvdHlwZS5yZW5kZXIuY2FsbCh0aGlzKTt0aGlzLmdyb3VwLmNsaXAodGhpcy5jaGFydC5jbGlwUmVjdCl9LHNldERhdGE6ZnVuY3Rpb24oYSxiKXt4LnByb3RvdHlwZS5zZXREYXRhLmNhbGwodGhpcyxhLCExKTt0aGlzLnByb2Nlc3NEYXRhKCk7dGhpcy5nZW5lcmF0ZVBvaW50cygpO28oYiwhMCkmJnRoaXMuY2hhcnQucmVkcmF3KCl9LGRyYXdUcmFja2VyOkMmJkMuZHJhd1RyYWNrZXJQb2ludH07aS5nYXVnZT12KGkubGluZSxDKTtwLmJveHBsb3Q9dShwLmNvbHVtbix7ZmlsbENvbG9yOlwiI0ZGRkZGRlwiLGxpbmVXaWR0aDoxLG1lZGlhbldpZHRoOjIsc3RhdGVzOntob3Zlcjp7YnJpZ2h0bmVzczotMC4zfX0sdGhyZXNob2xkOm51bGwsdG9vbHRpcDp7cG9pbnRGb3JtYXQ6JzxzcGFuIHN0eWxlPVwiY29sb3I6e3BvaW50LmNvbG9yfVwiPlxcdTI1Y2Y8L3NwYW4+IDxiPiB7c2VyaWVzLm5hbWV9PC9iPjxici8+TWF4aW11bToge3BvaW50LmhpZ2h9PGJyLz5VcHBlciBxdWFydGlsZToge3BvaW50LnEzfTxici8+TWVkaWFuOiB7cG9pbnQubWVkaWFufTxici8+TG93ZXIgcXVhcnRpbGU6IHtwb2ludC5xMX08YnIvPk1pbmltdW06IHtwb2ludC5sb3d9PGJyLz4nfSxcbndoaXNrZXJMZW5ndGg6XCI1MCVcIix3aGlza2VyV2lkdGg6Mn0pO2kuYm94cGxvdD12KGkuY29sdW1uLHt0eXBlOlwiYm94cGxvdFwiLHBvaW50QXJyYXlNYXA6W1wibG93XCIsXCJxMVwiLFwibWVkaWFuXCIsXCJxM1wiLFwiaGlnaFwiXSx0b1lEYXRhOmZ1bmN0aW9uKGEpe3JldHVyblthLmxvdyxhLnExLGEubWVkaWFuLGEucTMsYS5oaWdoXX0scG9pbnRWYWxLZXk6XCJoaWdoXCIscG9pbnRBdHRyVG9PcHRpb25zOntmaWxsOlwiZmlsbENvbG9yXCIsc3Ryb2tlOlwiY29sb3JcIixcInN0cm9rZS13aWR0aFwiOlwibGluZVdpZHRoXCJ9LGRyYXdEYXRhTGFiZWxzOnIsdHJhbnNsYXRlOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy55QXhpcyxiPXRoaXMucG9pbnRBcnJheU1hcDtpLmNvbHVtbi5wcm90b3R5cGUudHJhbnNsYXRlLmFwcGx5KHRoaXMpO3QodGhpcy5wb2ludHMsZnVuY3Rpb24oYyl7dChiLGZ1bmN0aW9uKGIpe2NbYl0hPT1udWxsJiYoY1tiK1wiUGxvdFwiXT1hLnRyYW5zbGF0ZShjW2JdLDAsMSwwLDEpKX0pfSl9LGRyYXdQb2ludHM6ZnVuY3Rpb24oKXt2YXIgYT1cbnRoaXMsYj1hLm9wdGlvbnMsYz1hLmNoYXJ0LnJlbmRlcmVyLGQsZyxlLGosbCxoLGYsayxuLGksbSxLLEwscCx1LHIsdyx2LHgseSxDLEIsej1hLmRvUXVhcnRpbGVzIT09ITEsQSxFPWEub3B0aW9ucy53aGlza2VyTGVuZ3RoO3QoYS5wb2ludHMsZnVuY3Rpb24ocSl7bj1xLmdyYXBoaWM7Qz1xLnNoYXBlQXJnczttPXt9O3A9e307cj17fTtCPXEuY29sb3J8fGEuY29sb3I7aWYocS5wbG90WSE9PXZvaWQgMClpZihkPXEucG9pbnRBdHRyW3Euc2VsZWN0ZWQ/XCJzZWxlY3RlZFwiOlwiXCJdLHc9Qy53aWR0aCx2PUQoQy54KSx4PXYrdyx5PUYody8yKSxnPUQoej9xLnExUGxvdDpxLmxvd1Bsb3QpLGU9RCh6P3EucTNQbG90OnEubG93UGxvdCksaj1EKHEuaGlnaFBsb3QpLGw9RChxLmxvd1Bsb3QpLG0uc3Ryb2tlPXEuc3RlbUNvbG9yfHxiLnN0ZW1Db2xvcnx8QixtW1wic3Ryb2tlLXdpZHRoXCJdPW8ocS5zdGVtV2lkdGgsYi5zdGVtV2lkdGgsYi5saW5lV2lkdGgpLG0uZGFzaHN0eWxlPXEuc3RlbURhc2hTdHlsZXx8XG5iLnN0ZW1EYXNoU3R5bGUscC5zdHJva2U9cS53aGlza2VyQ29sb3J8fGIud2hpc2tlckNvbG9yfHxCLHBbXCJzdHJva2Utd2lkdGhcIl09byhxLndoaXNrZXJXaWR0aCxiLndoaXNrZXJXaWR0aCxiLmxpbmVXaWR0aCksci5zdHJva2U9cS5tZWRpYW5Db2xvcnx8Yi5tZWRpYW5Db2xvcnx8QixyW1wic3Ryb2tlLXdpZHRoXCJdPW8ocS5tZWRpYW5XaWR0aCxiLm1lZGlhbldpZHRoLGIubGluZVdpZHRoKSxmPW1bXCJzdHJva2Utd2lkdGhcIl0lMi8yLGs9dit5K2YsaT1bXCJNXCIsayxlLFwiTFwiLGssaixcIk1cIixrLGcsXCJMXCIsayxsXSx6JiYoZj1kW1wic3Ryb2tlLXdpZHRoXCJdJTIvMixrPUQoaykrZixnPUQoZykrZixlPUQoZSkrZix2Kz1mLHgrPWYsSz1bXCJNXCIsdixlLFwiTFwiLHYsZyxcIkxcIix4LGcsXCJMXCIseCxlLFwiTFwiLHYsZSxcInpcIl0pLEUmJihmPXBbXCJzdHJva2Utd2lkdGhcIl0lMi8yLGorPWYsbCs9ZixBPS8lJC8udGVzdChFKT95KnBhcnNlRmxvYXQoRSkvMTAwOkUvMixMPVtcIk1cIixrLUEsaixcIkxcIixrK1xuQSxqLFwiTVwiLGstQSxsLFwiTFwiLGsrQSxsXSksZj1yW1wic3Ryb2tlLXdpZHRoXCJdJTIvMixoPUYocS5tZWRpYW5QbG90KStmLHU9W1wiTVwiLHYsaCxcIkxcIix4LGhdLG4pcS5zdGVtLmFuaW1hdGUoe2Q6aX0pLEUmJnEud2hpc2tlcnMuYW5pbWF0ZSh7ZDpMfSkseiYmcS5ib3guYW5pbWF0ZSh7ZDpLfSkscS5tZWRpYW5TaGFwZS5hbmltYXRlKHtkOnV9KTtlbHNle3EuZ3JhcGhpYz1uPWMuZygpLmFkZChhLmdyb3VwKTtxLnN0ZW09Yy5wYXRoKGkpLmF0dHIobSkuYWRkKG4pO2lmKEUpcS53aGlza2Vycz1jLnBhdGgoTCkuYXR0cihwKS5hZGQobik7aWYoeilxLmJveD1jLnBhdGgoSykuYXR0cihkKS5hZGQobik7cS5tZWRpYW5TaGFwZT1jLnBhdGgodSkuYXR0cihyKS5hZGQobil9fSl9LHNldFN0YWNrZWRQb2ludHM6cn0pO3AuZXJyb3JiYXI9dShwLmJveHBsb3Qse2NvbG9yOlwiIzAwMDAwMFwiLGdyb3VwaW5nOiExLGxpbmtlZFRvOlwiOnByZXZpb3VzXCIsdG9vbHRpcDp7cG9pbnRGb3JtYXQ6JzxzcGFuIHN0eWxlPVwiY29sb3I6e3BvaW50LmNvbG9yfVwiPlxcdTI1Y2Y8L3NwYW4+IHtzZXJpZXMubmFtZX06IDxiPntwb2ludC5sb3d9PC9iPiAtIDxiPntwb2ludC5oaWdofTwvYj48YnIvPid9LFxud2hpc2tlcldpZHRoOm51bGx9KTtpLmVycm9yYmFyPXYoaS5ib3hwbG90LHt0eXBlOlwiZXJyb3JiYXJcIixwb2ludEFycmF5TWFwOltcImxvd1wiLFwiaGlnaFwiXSx0b1lEYXRhOmZ1bmN0aW9uKGEpe3JldHVyblthLmxvdyxhLmhpZ2hdfSxwb2ludFZhbEtleTpcImhpZ2hcIixkb1F1YXJ0aWxlczohMSxkcmF3RGF0YUxhYmVsczppLmFyZWFyYW5nZT9pLmFyZWFyYW5nZS5wcm90b3R5cGUuZHJhd0RhdGFMYWJlbHM6cixnZXRDb2x1bW5NZXRyaWNzOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubGlua2VkUGFyZW50JiZ0aGlzLmxpbmtlZFBhcmVudC5jb2x1bW5NZXRyaWNzfHxpLmNvbHVtbi5wcm90b3R5cGUuZ2V0Q29sdW1uTWV0cmljcy5jYWxsKHRoaXMpfX0pO3Aud2F0ZXJmYWxsPXUocC5jb2x1bW4se2xpbmVXaWR0aDoxLGxpbmVDb2xvcjpcIiMzMzNcIixkYXNoU3R5bGU6XCJkb3RcIixib3JkZXJDb2xvcjpcIiMzMzNcIixkYXRhTGFiZWxzOntpbnNpZGU6ITB9LHN0YXRlczp7aG92ZXI6e2xpbmVXaWR0aFBsdXM6MH19fSk7XG5pLndhdGVyZmFsbD12KGkuY29sdW1uLHt0eXBlOlwid2F0ZXJmYWxsXCIsdXBDb2xvclByb3A6XCJmaWxsXCIscG9pbnRWYWxLZXk6XCJ5XCIsdHJhbnNsYXRlOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcHRpb25zLGI9dGhpcy55QXhpcyxjLGQsZyxlLGosbCxoLGYsayxuPW8oYS5taW5Qb2ludExlbmd0aCw1KSxzPWEudGhyZXNob2xkLG09YS5zdGFja2luZztpLmNvbHVtbi5wcm90b3R5cGUudHJhbnNsYXRlLmFwcGx5KHRoaXMpO3RoaXMubWluUG9pbnRMZW5ndGhPZmZzZXQ9MDtoPWY9cztkPXRoaXMucG9pbnRzO2ZvcihjPTAsYT1kLmxlbmd0aDtjPGE7YysrKXtnPWRbY107bD10aGlzLnByb2Nlc3NlZFlEYXRhW2NdO2U9Zy5zaGFwZUFyZ3M7az0oaj1tJiZiLnN0YWNrc1sodGhpcy5uZWdTdGFja3MmJmw8cz9cIi1cIjpcIlwiKSt0aGlzLnN0YWNrS2V5XSk/altnLnhdLnBvaW50c1t0aGlzLmluZGV4K1wiLFwiK2NdOlswLGxdO2lmKGcuaXNTdW0pZy55PUcobCk7ZWxzZSBpZihnLmlzSW50ZXJtZWRpYXRlU3VtKWcueT1cbkcobC1mKTtqPVAoaCxoK2cueSkra1swXTtlLnk9Yi50cmFuc2xhdGUoaiwwLDEpO2lmKGcuaXNTdW0pZS55PWIudHJhbnNsYXRlKGtbMV0sMCwxKSxlLmhlaWdodD1NYXRoLm1pbihiLnRyYW5zbGF0ZShrWzBdLDAsMSksYi5sZW4pLWUueSt0aGlzLm1pblBvaW50TGVuZ3RoT2Zmc2V0O2Vsc2UgaWYoZy5pc0ludGVybWVkaWF0ZVN1bSllLnk9Yi50cmFuc2xhdGUoa1sxXSwwLDEpLGUuaGVpZ2h0PU1hdGgubWluKGIudHJhbnNsYXRlKGYsMCwxKSxiLmxlbiktZS55K3RoaXMubWluUG9pbnRMZW5ndGhPZmZzZXQsZj1rWzFdO2Vsc2V7aWYoaCE9PTApZS5oZWlnaHQ9bD4wP2IudHJhbnNsYXRlKGgsMCwxKS1lLnk6Yi50cmFuc2xhdGUoaCwwLDEpLWIudHJhbnNsYXRlKGgtbCwwLDEpO2grPWx9ZS5oZWlnaHQ8MCYmKGUueSs9ZS5oZWlnaHQsZS5oZWlnaHQqPS0xKTtnLnBsb3RZPWUueT1GKGUueSktdGhpcy5ib3JkZXJXaWR0aCUyLzI7ZS5oZWlnaHQ9UChGKGUuaGVpZ2h0KSwwLjAwMSk7XG5nLnlCb3R0b209ZS55K2UuaGVpZ2h0O2lmKGUuaGVpZ2h0PD1uKWUuaGVpZ2h0PW4sdGhpcy5taW5Qb2ludExlbmd0aE9mZnNldCs9bjtlLnktPXRoaXMubWluUG9pbnRMZW5ndGhPZmZzZXQ7ZT1nLnBsb3RZKyhnLm5lZ2F0aXZlP2UuaGVpZ2h0OjApLXRoaXMubWluUG9pbnRMZW5ndGhPZmZzZXQ7dGhpcy5jaGFydC5pbnZlcnRlZD9nLnRvb2x0aXBQb3NbMF09Yi5sZW4tZTpnLnRvb2x0aXBQb3NbMV09ZX19LHByb2Nlc3NEYXRhOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMueURhdGEsYz10aGlzLm9wdGlvbnMuZGF0YSxkLGc9Yi5sZW5ndGgsZSxqLGwsaCxmLGs7aj1lPWw9aD10aGlzLm9wdGlvbnMudGhyZXNob2xkfHwwO2ZvcihrPTA7azxnO2srKylmPWJba10sZD1jJiZjW2tdP2Nba106e30sZj09PVwic3VtXCJ8fGQuaXNTdW0/YltrXT1HKGopOmY9PT1cImludGVybWVkaWF0ZVN1bVwifHxkLmlzSW50ZXJtZWRpYXRlU3VtP2Jba109RyhlKTooais9ZixlKz1mKSxsPU1hdGgubWluKGosXG5sKSxoPU1hdGgubWF4KGosaCk7eC5wcm90b3R5cGUucHJvY2Vzc0RhdGEuY2FsbCh0aGlzLGEpO3RoaXMuZGF0YU1pbj1sO3RoaXMuZGF0YU1heD1ofSx0b1lEYXRhOmZ1bmN0aW9uKGEpe3JldHVybiBhLmlzU3VtP2EueD09PTA/bnVsbDpcInN1bVwiOmEuaXNJbnRlcm1lZGlhdGVTdW0/YS54PT09MD9udWxsOlwiaW50ZXJtZWRpYXRlU3VtXCI6YS55fSxnZXRBdHRyaWJzOmZ1bmN0aW9uKCl7aS5jb2x1bW4ucHJvdG90eXBlLmdldEF0dHJpYnMuYXBwbHkodGhpcyxhcmd1bWVudHMpO3ZhciBhPXRoaXMsYj1hLm9wdGlvbnMsYz1iLnN0YXRlcyxkPWIudXBDb2xvcnx8YS5jb2xvcixiPW0uQ29sb3IoZCkuYnJpZ2h0ZW4oMC4xKS5nZXQoKSxnPXUoYS5wb2ludEF0dHIpLGU9YS51cENvbG9yUHJvcDtnW1wiXCJdW2VdPWQ7Zy5ob3ZlcltlXT1jLmhvdmVyLnVwQ29sb3J8fGI7Zy5zZWxlY3RbZV09Yy5zZWxlY3QudXBDb2xvcnx8ZDt0KGEucG9pbnRzLGZ1bmN0aW9uKGUpe2lmKCFlLm9wdGlvbnMuY29sb3IpZS55PlxuMD8oZS5wb2ludEF0dHI9ZyxlLmNvbG9yPWQpOmUucG9pbnRBdHRyPWEucG9pbnRBdHRyfSl9LGdldEdyYXBoUGF0aDpmdW5jdGlvbigpe3ZhciBhPXRoaXMuZGF0YSxiPWEubGVuZ3RoLGM9Rih0aGlzLm9wdGlvbnMubGluZVdpZHRoK3RoaXMuYm9yZGVyV2lkdGgpJTIvMixkPVtdLGcsZSxqO2ZvcihqPTE7ajxiO2orKyllPWFbal0uc2hhcGVBcmdzLGc9YVtqLTFdLnNoYXBlQXJncyxlPVtcIk1cIixnLngrZy53aWR0aCxnLnkrYyxcIkxcIixlLngsZy55K2NdLGFbai0xXS55PDAmJihlWzJdKz1nLmhlaWdodCxlWzVdKz1nLmhlaWdodCksZD1kLmNvbmNhdChlKTtyZXR1cm4gZH0sZ2V0RXh0cmVtZXM6cixkcmF3R3JhcGg6eC5wcm90b3R5cGUuZHJhd0dyYXBofSk7cC5wb2x5Z29uPXUocC5zY2F0dGVyLHttYXJrZXI6e2VuYWJsZWQ6ITF9fSk7aS5wb2x5Z29uPXYoaS5zY2F0dGVyLHt0eXBlOlwicG9seWdvblwiLGZpbGxHcmFwaDohMCxnZXRTZWdtZW50UGF0aDpmdW5jdGlvbihhKXtyZXR1cm4geC5wcm90b3R5cGUuZ2V0U2VnbWVudFBhdGguY2FsbCh0aGlzLFxuYSkuY29uY2F0KFwielwiKX0sZHJhd0dyYXBoOngucHJvdG90eXBlLmRyYXdHcmFwaCxkcmF3TGVnZW5kU3ltYm9sOm0uTGVnZW5kU3ltYm9sTWl4aW4uZHJhd1JlY3RhbmdsZX0pO3AuYnViYmxlPXUocC5zY2F0dGVyLHtkYXRhTGFiZWxzOntmb3JtYXR0ZXI6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wb2ludC56fSxpbnNpZGU6ITAsdmVydGljYWxBbGlnbjpcIm1pZGRsZVwifSxtYXJrZXI6e2xpbmVDb2xvcjpudWxsLGxpbmVXaWR0aDoxfSxtaW5TaXplOjgsbWF4U2l6ZTpcIjIwJVwiLHNvZnRUaHJlc2hvbGQ6ITEsc3RhdGVzOntob3Zlcjp7aGFsbzp7c2l6ZTo1fX19LHRvb2x0aXA6e3BvaW50Rm9ybWF0OlwiKHtwb2ludC54fSwge3BvaW50Lnl9KSwgU2l6ZToge3BvaW50Lnp9XCJ9LHR1cmJvVGhyZXNob2xkOjAselRocmVzaG9sZDowLHpvbmVBeGlzOlwielwifSk7Qz12KEose2hhbG9QYXRoOmZ1bmN0aW9uKCl7cmV0dXJuIEoucHJvdG90eXBlLmhhbG9QYXRoLmNhbGwodGhpcyx0aGlzLnNoYXBlQXJncy5yK1xudGhpcy5zZXJpZXMub3B0aW9ucy5zdGF0ZXMuaG92ZXIuaGFsby5zaXplKX0sdHRCZWxvdzohMX0pO2kuYnViYmxlPXYoaS5zY2F0dGVyLHt0eXBlOlwiYnViYmxlXCIscG9pbnRDbGFzczpDLHBvaW50QXJyYXlNYXA6W1wieVwiLFwielwiXSxwYXJhbGxlbEFycmF5czpbXCJ4XCIsXCJ5XCIsXCJ6XCJdLHRyYWNrZXJHcm91cHM6W1wiZ3JvdXBcIixcImRhdGFMYWJlbHNHcm91cFwiXSxidWJibGVQYWRkaW5nOiEwLHpvbmVBeGlzOlwielwiLHBvaW50QXR0clRvT3B0aW9uczp7c3Ryb2tlOlwibGluZUNvbG9yXCIsXCJzdHJva2Utd2lkdGhcIjpcImxpbmVXaWR0aFwiLGZpbGw6XCJmaWxsQ29sb3JcIn0sYXBwbHlPcGFjaXR5OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMub3B0aW9ucy5tYXJrZXIsYz1vKGIuZmlsbE9wYWNpdHksMC41KSxhPWF8fGIuZmlsbENvbG9yfHx0aGlzLmNvbG9yO2MhPT0xJiYoYT1XKGEpLnNldE9wYWNpdHkoYykuZ2V0KFwicmdiYVwiKSk7cmV0dXJuIGF9LGNvbnZlcnRBdHRyaWJzOmZ1bmN0aW9uKCl7dmFyIGE9XG54LnByb3RvdHlwZS5jb252ZXJ0QXR0cmlicy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7YS5maWxsPXRoaXMuYXBwbHlPcGFjaXR5KGEuZmlsbCk7cmV0dXJuIGF9LGdldFJhZGlpOmZ1bmN0aW9uKGEsYixjLGQpe3ZhciBnLGUsaixsPXRoaXMuekRhdGEsaD1bXSxmPXRoaXMub3B0aW9ucyxrPWYuc2l6ZUJ5IT09XCJ3aWR0aFwiLG49Zi56VGhyZXNob2xkLGk9Yi1hO2ZvcihlPTAsZz1sLmxlbmd0aDtlPGc7ZSsrKWo9bFtlXSxmLnNpemVCeUFic29sdXRlVmFsdWUmJmohPT1udWxsJiYoaj1NYXRoLmFicyhqLW4pLGI9TWF0aC5tYXgoYi1uLE1hdGguYWJzKGEtbikpLGE9MCksaj09PW51bGw/aj1udWxsOmo8YT9qPWMvMi0xOihqPWk+MD8oai1hKS9pOjAuNSxrJiZqPj0wJiYoaj1NYXRoLnNxcnQoaikpLGo9eS5jZWlsKGMraiooZC1jKSkvMiksaC5wdXNoKGopO3RoaXMucmFkaWk9aH0sYW5pbWF0ZTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLm9wdGlvbnMuYW5pbWF0aW9uO2lmKCFhKXQodGhpcy5wb2ludHMsXG5mdW5jdGlvbihhKXt2YXIgZD1hLmdyYXBoaWMsYT1hLnNoYXBlQXJncztkJiZhJiYoZC5hdHRyKFwiclwiLDEpLGQuYW5pbWF0ZSh7cjphLnJ9LGIpKX0pLHRoaXMuYW5pbWF0ZT1udWxsfSx0cmFuc2xhdGU6ZnVuY3Rpb24oKXt2YXIgYSxiPXRoaXMuZGF0YSxjLGQsZz10aGlzLnJhZGlpO2kuc2NhdHRlci5wcm90b3R5cGUudHJhbnNsYXRlLmNhbGwodGhpcyk7Zm9yKGE9Yi5sZW5ndGg7YS0tOyljPWJbYV0sZD1nP2dbYV06MCxJKGQpJiZkPj10aGlzLm1pblB4U2l6ZS8yPyhjLnNoYXBlVHlwZT1cImNpcmNsZVwiLGMuc2hhcGVBcmdzPXt4OmMucGxvdFgseTpjLnBsb3RZLHI6ZH0sYy5kbEJveD17eDpjLnBsb3RYLWQseTpjLnBsb3RZLWQsd2lkdGg6MipkLGhlaWdodDoyKmR9KTpjLnNoYXBlQXJncz1jLnBsb3RZPWMuZGxCb3g9dm9pZCAwfSxkcmF3TGVnZW5kU3ltYm9sOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5jaGFydC5yZW5kZXJlcixkPWMuZm9udE1ldHJpY3MoYS5pdGVtU3R5bGUuZm9udFNpemUpLmYvXG4yO2IubGVnZW5kU3ltYm9sPWMuY2lyY2xlKGQsYS5iYXNlbGluZS1kLGQpLmF0dHIoe3pJbmRleDozfSkuYWRkKGIubGVnZW5kR3JvdXApO2IubGVnZW5kU3ltYm9sLmlzTWFya2VyPSEwfSxkcmF3UG9pbnRzOmkuY29sdW1uLnByb3RvdHlwZS5kcmF3UG9pbnRzLGFsaWduRGF0YUxhYmVsOmkuY29sdW1uLnByb3RvdHlwZS5hbGlnbkRhdGFMYWJlbCxidWlsZEtEVHJlZTpyLGFwcGx5Wm9uZXM6cn0pO08ucHJvdG90eXBlLmJlZm9yZVBhZGRpbmc9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9dGhpcy5sZW4sYz10aGlzLmNoYXJ0LGQ9MCxnPWIsZT10aGlzLmlzWEF4aXMsaj1lP1wieERhdGFcIjpcInlEYXRhXCIsbD10aGlzLm1pbixoPXt9LGY9eS5taW4oYy5wbG90V2lkdGgsYy5wbG90SGVpZ2h0KSxrPU51bWJlci5NQVhfVkFMVUUsbj0tTnVtYmVyLk1BWF9WQUxVRSxpPXRoaXMubWF4LWwsbT1iL2kscD1bXTt0KHRoaXMuc2VyaWVzLGZ1bmN0aW9uKGIpe3ZhciBnPWIub3B0aW9ucztpZihiLmJ1YmJsZVBhZGRpbmcmJlxuKGIudmlzaWJsZXx8IWMub3B0aW9ucy5jaGFydC5pZ25vcmVIaWRkZW5TZXJpZXMpKWlmKGEuYWxsb3dab29tT3V0c2lkZT0hMCxwLnB1c2goYiksZSl0KFtcIm1pblNpemVcIixcIm1heFNpemVcIl0sZnVuY3Rpb24oYSl7dmFyIGI9Z1thXSxlPS8lJC8udGVzdChiKSxiPUIoYik7aFthXT1lP2YqYi8xMDA6Yn0pLGIubWluUHhTaXplPWgubWluU2l6ZSxiLm1heFB4U2l6ZT1oLm1heFNpemUsYj1iLnpEYXRhLGIubGVuZ3RoJiYoaz1vKGcuek1pbix5Lm1pbihrLHkubWF4KFIoYiksZy5kaXNwbGF5TmVnYXRpdmU9PT0hMT9nLnpUaHJlc2hvbGQ6LU51bWJlci5NQVhfVkFMVUUpKSksbj1vKGcuek1heCx5Lm1heChuLFMoYikpKSl9KTt0KHAsZnVuY3Rpb24oYil7dmFyIGM9YltqXSxmPWMubGVuZ3RoLGg7ZSYmYi5nZXRSYWRpaShrLG4sYi5taW5QeFNpemUsYi5tYXhQeFNpemUpO2lmKGk+MClmb3IoO2YtLTspSShjW2ZdKSYmYS5kYXRhTWluPD1jW2ZdJiZjW2ZdPD1hLmRhdGFNYXgmJihoPVxuYi5yYWRpaVtmXSxkPU1hdGgubWluKChjW2ZdLWwpKm0taCxkKSxnPU1hdGgubWF4KChjW2ZdLWwpKm0raCxnKSl9KTtwLmxlbmd0aCYmaT4wJiYhdGhpcy5pc0xvZyYmKGctPWIsbSo9KGIrZC1nKS9iLHQoW1tcIm1pblwiLFwidXNlck1pblwiLGRdLFtcIm1heFwiLFwidXNlck1heFwiLGddXSxmdW5jdGlvbihiKXtvKGEub3B0aW9uc1tiWzBdXSxhW2JbMV1dKT09PXZvaWQgMCYmKGFbYlswXV0rPWJbMl0vbSl9KSl9OyhmdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXt2YXIgYz10aGlzLmNoYXJ0LGQ9dGhpcy5vcHRpb25zLmFuaW1hdGlvbixoPXRoaXMuZ3JvdXAsZj10aGlzLm1hcmtlckdyb3VwLGs9dGhpcy54QXhpcy5jZW50ZXIsaT1jLnBsb3RMZWZ0LG09Yy5wbG90VG9wO2lmKGMucG9sYXIpe2lmKGMucmVuZGVyZXIuaXNTVkcpZD09PSEwJiYoZD17fSksYj8oYz17dHJhbnNsYXRlWDprWzBdK2ksdHJhbnNsYXRlWTprWzFdK20sc2NhbGVYOjAuMDAxLHNjYWxlWTowLjAwMX0saC5hdHRyKGMpLFxuZiYmZi5hdHRyKGMpKTooYz17dHJhbnNsYXRlWDppLHRyYW5zbGF0ZVk6bSxzY2FsZVg6MSxzY2FsZVk6MX0saC5hbmltYXRlKGMsZCksZiYmZi5hbmltYXRlKGMsZCksdGhpcy5hbmltYXRlPW51bGwpfWVsc2UgYS5jYWxsKHRoaXMsYil9dmFyIGI9eC5wcm90b3R5cGUsYz1VLnByb3RvdHlwZSxkO2Iuc2VhcmNoUG9pbnRCeUFuZ2xlPWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY2hhcnQsYz10aGlzLnhBeGlzLnBhbmUuY2VudGVyO3JldHVybiB0aGlzLnNlYXJjaEtEVHJlZSh7Y2xpZW50WDoxODArTWF0aC5hdGFuMihhLmNoYXJ0WC1jWzBdLWIucGxvdExlZnQsYS5jaGFydFktY1sxXS1iLnBsb3RUb3ApKigtMTgwL01hdGguUEkpfSl9O3coYixcImJ1aWxkS0RUcmVlXCIsZnVuY3Rpb24oYSl7aWYodGhpcy5jaGFydC5wb2xhcil0aGlzLmtkQnlBbmdsZT90aGlzLnNlYXJjaFBvaW50PXRoaXMuc2VhcmNoUG9pbnRCeUFuZ2xlOnRoaXMua2REaW1lbnNpb25zPTI7YS5hcHBseSh0aGlzKX0pO1xuYi50b1hZPWZ1bmN0aW9uKGEpe3ZhciBiLGM9dGhpcy5jaGFydCxkPWEucGxvdFg7Yj1hLnBsb3RZO2EucmVjdFBsb3RYPWQ7YS5yZWN0UGxvdFk9YjtiPXRoaXMueEF4aXMucG9zdFRyYW5zbGF0ZShhLnBsb3RYLHRoaXMueUF4aXMubGVuLWIpO2EucGxvdFg9YS5wb2xhclBsb3RYPWIueC1jLnBsb3RMZWZ0O2EucGxvdFk9YS5wb2xhclBsb3RZPWIueS1jLnBsb3RUb3A7dGhpcy5rZEJ5QW5nbGU/KGM9KGQvTWF0aC5QSSoxODArdGhpcy54QXhpcy5wYW5lLm9wdGlvbnMuc3RhcnRBbmdsZSklMzYwLGM8MCYmKGMrPTM2MCksYS5jbGllbnRYPWMpOmEuY2xpZW50WD1hLnBsb3RYfTtpLnNwbGluZSYmdyhpLnNwbGluZS5wcm90b3R5cGUsXCJnZXRQb2ludFNwbGluZVwiLGZ1bmN0aW9uKGEsYixjLGQpe3ZhciBoLGYsayxpLG0scCxvO2lmKHRoaXMuY2hhcnQucG9sYXIpe2g9Yy5wbG90WDtmPWMucGxvdFk7YT1iW2QtMV07az1iW2QrMV07dGhpcy5jb25uZWN0RW5kcyYmKGF8fChhPWJbYi5sZW5ndGgtXG4yXSksa3x8KGs9YlsxXSkpO2lmKGEmJmspaT1hLnBsb3RYLG09YS5wbG90WSxiPWsucGxvdFgscD1rLnBsb3RZLGk9KDEuNSpoK2kpLzIuNSxtPSgxLjUqZittKS8yLjUsaz0oMS41KmgrYikvMi41LG89KDEuNSpmK3ApLzIuNSxiPU1hdGguc3FydChNYXRoLnBvdyhpLWgsMikrTWF0aC5wb3cobS1mLDIpKSxwPU1hdGguc3FydChNYXRoLnBvdyhrLWgsMikrTWF0aC5wb3coby1mLDIpKSxpPU1hdGguYXRhbjIobS1mLGktaCksbT1NYXRoLmF0YW4yKG8tZixrLWgpLG89TWF0aC5QSS8yKyhpK20pLzIsTWF0aC5hYnMoaS1vKT5NYXRoLlBJLzImJihvLT1NYXRoLlBJKSxpPWgrTWF0aC5jb3MobykqYixtPWYrTWF0aC5zaW4obykqYixrPWgrTWF0aC5jb3MoTWF0aC5QSStvKSpwLG89ZitNYXRoLnNpbihNYXRoLlBJK28pKnAsYy5yaWdodENvbnRYPWssYy5yaWdodENvbnRZPW87ZD8oYz1bXCJDXCIsYS5yaWdodENvbnRYfHxhLnBsb3RYLGEucmlnaHRDb250WXx8YS5wbG90WSxpfHxoLG18fFxuZixoLGZdLGEucmlnaHRDb250WD1hLnJpZ2h0Q29udFk9bnVsbCk6Yz1bXCJNXCIsaCxmXX1lbHNlIGM9YS5jYWxsKHRoaXMsYixjLGQpO3JldHVybiBjfSk7dyhiLFwidHJhbnNsYXRlXCIsZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jaGFydDthLmNhbGwodGhpcyk7aWYoYi5wb2xhciYmKHRoaXMua2RCeUFuZ2xlPWIudG9vbHRpcCYmYi50b29sdGlwLnNoYXJlZCwhdGhpcy5wcmV2ZW50UG9zdFRyYW5zbGF0ZSkpe2E9dGhpcy5wb2ludHM7Zm9yKGI9YS5sZW5ndGg7Yi0tOyl0aGlzLnRvWFkoYVtiXSl9fSk7dyhiLFwiZ2V0R3JhcGhQYXRoXCIsZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzO2lmKHRoaXMuY2hhcnQucG9sYXIpe2I9Ynx8dGhpcy5wb2ludHM7aWYodGhpcy5vcHRpb25zLmNvbm5lY3RFbmRzIT09ITEmJmJbMF0mJmJbMF0ueSE9PW51bGwpdGhpcy5jb25uZWN0RW5kcz0hMCxiLnNwbGljZShiLmxlbmd0aCwwLGJbMF0pO3QoYixmdW5jdGlvbihhKXthLnBvbGFyUGxvdFk9PT12b2lkIDAmJlxuYy50b1hZKGEpfSl9cmV0dXJuIGEuYXBwbHkodGhpcyxbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSl9KTt3KGIsXCJhbmltYXRlXCIsYSk7aWYoaS5jb2x1bW4pZD1pLmNvbHVtbi5wcm90b3R5cGUsZC5wb2xhckFyYz1mdW5jdGlvbihhLGIsYyxkKXt2YXIgaD10aGlzLnhBeGlzLmNlbnRlcixmPXRoaXMueUF4aXMubGVuO3JldHVybiB0aGlzLmNoYXJ0LnJlbmRlcmVyLnN5bWJvbHMuYXJjKGhbMF0saFsxXSxmLWIsbnVsbCx7c3RhcnQ6YyxlbmQ6ZCxpbm5lclI6Zi1vKGEsZil9KX0sdyhkLFwiYW5pbWF0ZVwiLGEpLHcoZCxcInRyYW5zbGF0ZVwiLGZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMueEF4aXMsYz1iLnN0YXJ0QW5nbGVSYWQsZCxoLGY7dGhpcy5wcmV2ZW50UG9zdFRyYW5zbGF0ZT0hMDthLmNhbGwodGhpcyk7aWYoYi5pc1JhZGlhbCl7ZD10aGlzLnBvaW50cztmb3IoZj1kLmxlbmd0aDtmLS07KWg9ZFtmXSxhPWguYmFyWCtjLGguc2hhcGVUeXBlPVwicGF0aFwiLGguc2hhcGVBcmdzPXtkOnRoaXMucG9sYXJBcmMoaC55Qm90dG9tLFxuaC5wbG90WSxhLGEraC5wb2ludFdpZHRoKX0sdGhpcy50b1hZKGgpLGgudG9vbHRpcFBvcz1baC5wbG90WCxoLnBsb3RZXSxoLnR0QmVsb3c9aC5wbG90WT5iLmNlbnRlclsxXX19KSx3KGQsXCJhbGlnbkRhdGFMYWJlbFwiLGZ1bmN0aW9uKGEsYyxkLGksaCxmKXtpZih0aGlzLmNoYXJ0LnBvbGFyKXthPWMucmVjdFBsb3RYL01hdGguUEkqMTgwO2lmKGkuYWxpZ249PT1udWxsKWkuYWxpZ249YT4yMCYmYTwxNjA/XCJsZWZ0XCI6YT4yMDAmJmE8MzQwP1wicmlnaHRcIjpcImNlbnRlclwiO2lmKGkudmVydGljYWxBbGlnbj09PW51bGwpaS52ZXJ0aWNhbEFsaWduPWE8NDV8fGE+MzE1P1wiYm90dG9tXCI6YT4xMzUmJmE8MjI1P1widG9wXCI6XCJtaWRkbGVcIjtiLmFsaWduRGF0YUxhYmVsLmNhbGwodGhpcyxjLGQsaSxoLGYpfWVsc2UgYS5jYWxsKHRoaXMsYyxkLGksaCxmKX0pO3coYyxcImdldENvb3JkaW5hdGVzXCIsZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmNoYXJ0LGQ9e3hBeGlzOltdLHlBeGlzOltdfTtcbmMucG9sYXI/dChjLmF4ZXMsZnVuY3Rpb24oYSl7dmFyIGY9YS5pc1hBeGlzLGc9YS5jZW50ZXIsaT1iLmNoYXJ0WC1nWzBdLWMucGxvdExlZnQsZz1iLmNoYXJ0WS1nWzFdLWMucGxvdFRvcDtkW2Y/XCJ4QXhpc1wiOlwieUF4aXNcIl0ucHVzaCh7YXhpczphLHZhbHVlOmEudHJhbnNsYXRlKGY/TWF0aC5QSS1NYXRoLmF0YW4yKGksZyk6TWF0aC5zcXJ0KE1hdGgucG93KGksMikrTWF0aC5wb3coZywyKSksITApfSl9KTpkPWEuY2FsbCh0aGlzLGIpO3JldHVybiBkfSl9KSgpfSk7XG4iLCIvKlxuIEhpZ2hzdG9jayBKUyB2NC4yLjUgKDIwMTYtMDUtMDYpXG5cbiAoYykgMjAwOS0yMDE2IFRvcnN0ZWluIEhvbnNpXG5cbiBMaWNlbnNlOiB3d3cuaGlnaGNoYXJ0cy5jb20vbGljZW5zZVxuKi9cbihmdW5jdGlvbihMLGdhKXt0eXBlb2YgbW9kdWxlPT09XCJvYmplY3RcIiYmbW9kdWxlLmV4cG9ydHM/bW9kdWxlLmV4cG9ydHM9TC5kb2N1bWVudD9nYShMKTpnYTpMLkhpZ2hjaGFydHM9Z2EoTCl9KSh0eXBlb2Ygd2luZG93IT09XCJ1bmRlZmluZWRcIj93aW5kb3c6dGhpcyxmdW5jdGlvbihMKXtmdW5jdGlvbiBnYShhLGIpe3ZhciBjPVwiSGlnaGNoYXJ0cyBlcnJvciAjXCIrYStcIjogd3d3LmhpZ2hjaGFydHMuY29tL2Vycm9ycy9cIithO2lmKGIpdGhyb3cgRXJyb3IoYyk7TC5jb25zb2xlJiZjb25zb2xlLmxvZyhjKX1mdW5jdGlvbiB4YihhLGIsYyl7dGhpcy5vcHRpb25zPWI7dGhpcy5lbGVtPWE7dGhpcy5wcm9wPWN9ZnVuY3Rpb24geigpe3ZhciBhLGI9YXJndW1lbnRzLGMsZD17fSxlPWZ1bmN0aW9uKGEsYil7dmFyIGMsZDt0eXBlb2YgYSE9PVwib2JqZWN0XCImJihhPXt9KTtmb3IoZCBpbiBiKWIuaGFzT3duUHJvcGVydHkoZCkmJihjPWJbZF0sYVtkXT1jJiZ0eXBlb2YgYz09PVwib2JqZWN0XCImJlxuT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGMpIT09XCJbb2JqZWN0IEFycmF5XVwiJiZkIT09XCJyZW5kZXJUb1wiJiZ0eXBlb2YgYy5ub2RlVHlwZSE9PVwibnVtYmVyXCI/ZShhW2RdfHx7fSxjKTpiW2RdKTtyZXR1cm4gYX07YlswXT09PSEwJiYoZD1iWzFdLGI9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYiwyKSk7Yz1iLmxlbmd0aDtmb3IoYT0wO2E8YzthKyspZD1lKGQsYlthXSk7cmV0dXJuIGR9ZnVuY3Rpb24gSyhhLGIpe3JldHVybiBwYXJzZUludChhLGJ8fDEwKX1mdW5jdGlvbiBDYShhKXtyZXR1cm4gdHlwZW9mIGE9PT1cInN0cmluZ1wifWZ1bmN0aW9uIGVhKGEpe3JldHVybiBhJiZ0eXBlb2YgYT09PVwib2JqZWN0XCJ9ZnVuY3Rpb24gSmEoYSl7cmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChhKT09PVwiW29iamVjdCBBcnJheV1cIn1mdW5jdGlvbiB6YShhLGIpe2Zvcih2YXIgYz1hLmxlbmd0aDtjLS07KWlmKGFbY109PT1iKXthLnNwbGljZShjLDEpO1xuYnJlYWt9fWZ1bmN0aW9uIHYoYSl7cmV0dXJuIGEhPT10JiZhIT09bnVsbH1mdW5jdGlvbiBYKGEsYixjKXt2YXIgZCxlO2lmKENhKGIpKXYoYyk/YS5zZXRBdHRyaWJ1dGUoYixjKTphJiZhLmdldEF0dHJpYnV0ZSYmKGU9YS5nZXRBdHRyaWJ1dGUoYikpO2Vsc2UgaWYodihiKSYmZWEoYikpZm9yKGQgaW4gYilhLnNldEF0dHJpYnV0ZShkLGJbZF0pO3JldHVybiBlfWZ1bmN0aW9uIHVhKGEpe3JldHVybiBKYShhKT9hOlthXX1mdW5jdGlvbiBaYShhLGIsYyl7aWYoYilyZXR1cm4gc2V0VGltZW91dChhLGIsYyk7YS5jYWxsKDAsYyl9ZnVuY3Rpb24gTihhLGIpe2lmKEthJiYhamEmJmImJmIub3BhY2l0eSE9PXQpYi5maWx0ZXI9XCJhbHBoYShvcGFjaXR5PVwiK2Iub3BhY2l0eSoxMDArXCIpXCI7QShhLnN0eWxlLGIpfWZ1bmN0aW9uIGZhKGEsYixjLGQsZSl7YT1ILmNyZWF0ZUVsZW1lbnQoYSk7YiYmQShhLGIpO2UmJk4oYSx7cGFkZGluZzowLGJvcmRlcjpcIm5vbmVcIixtYXJnaW46MH0pO1xuYyYmTihhLGMpO2QmJmQuYXBwZW5kQ2hpbGQoYSk7cmV0dXJuIGF9ZnVuY3Rpb24gbWEoYSxiKXt2YXIgYz1mdW5jdGlvbigpe307Yy5wcm90b3R5cGU9bmV3IGE7QShjLnByb3RvdHlwZSxiKTtyZXR1cm4gY31mdW5jdGlvbiBPYShhLGIsYyl7cmV0dXJuIEFycmF5KChifHwyKSsxLVN0cmluZyhhKS5sZW5ndGgpLmpvaW4oY3x8MCkrYX1mdW5jdGlvbiBlYihhKXtyZXR1cm4oZmImJmZiKGEpfHx5Ynx8MCkqNkU0fWZ1bmN0aW9uIExhKGEsYil7Zm9yKHZhciBjPVwie1wiLGQ9ITEsZSxmLGcsaCxpLGo9W107KGM9YS5pbmRleE9mKGMpKSE9PS0xOyl7ZT1hLnNsaWNlKDAsYyk7aWYoZCl7Zj1lLnNwbGl0KFwiOlwiKTtnPWYuc2hpZnQoKS5zcGxpdChcIi5cIik7aT1nLmxlbmd0aDtlPWI7Zm9yKGg9MDtoPGk7aCsrKWU9ZVtnW2hdXTtpZihmLmxlbmd0aClmPWYuam9pbihcIjpcIiksZz0vXFwuKFswLTldKS8saD1SLmxhbmcsaT12b2lkIDAsL2YkLy50ZXN0KGYpPyhpPShpPWYubWF0Y2goZykpP2lbMV06XG4tMSxlIT09bnVsbCYmKGU9Qi5udW1iZXJGb3JtYXQoZSxpLGguZGVjaW1hbFBvaW50LGYuaW5kZXhPZihcIixcIik+LTE/aC50aG91c2FuZHNTZXA6XCJcIikpKTplPW5hKGYsZSl9ai5wdXNoKGUpO2E9YS5zbGljZShjKzEpO2M9KGQ9IWQpP1wifVwiOlwie1wifWoucHVzaChhKTtyZXR1cm4gai5qb2luKFwiXCIpfWZ1bmN0aW9uIHpiKGEpe3JldHVybiBZLnBvdygxMCxWKFkubG9nKGEpL1kuTE4xMCkpfWZ1bmN0aW9uIEFiKGEsYixjLGQsZSl7dmFyIGYsZz1hLGM9cShjLDEpO2Y9YS9jO2J8fChiPVsxLDIsMi41LDUsMTBdLGQ9PT0hMSYmKGM9PT0xP2I9WzEsMiw1LDEwXTpjPD0wLjEmJihiPVsxL2NdKSkpO2ZvcihkPTA7ZDxiLmxlbmd0aDtkKyspaWYoZz1iW2RdLGUmJmcqYz49YXx8IWUmJmY8PShiW2RdKyhiW2QrMV18fGJbZF0pKS8yKWJyZWFrO2cqPWM7cmV0dXJuIGd9ZnVuY3Rpb24gbmIoYSxiKXt2YXIgYz1hLmxlbmd0aCxkLGU7Zm9yKGU9MDtlPGM7ZSsrKWFbZV0uc2FmZUk9ZTthLnNvcnQoZnVuY3Rpb24oYSxcbmMpe2Q9YihhLGMpO3JldHVybiBkPT09MD9hLnNhZmVJLWMuc2FmZUk6ZH0pO2ZvcihlPTA7ZTxjO2UrKylkZWxldGUgYVtlXS5zYWZlSX1mdW5jdGlvbiBNYShhKXtmb3IodmFyIGI9YS5sZW5ndGgsYz1hWzBdO2ItLTspYVtiXTxjJiYoYz1hW2JdKTtyZXR1cm4gY31mdW5jdGlvbiBEYShhKXtmb3IodmFyIGI9YS5sZW5ndGgsYz1hWzBdO2ItLTspYVtiXT5jJiYoYz1hW2JdKTtyZXR1cm4gY31mdW5jdGlvbiBQYShhLGIpe2Zvcih2YXIgYyBpbiBhKWFbY10mJmFbY10hPT1iJiZhW2NdLmRlc3Ryb3kmJmFbY10uZGVzdHJveSgpLGRlbGV0ZSBhW2NdfWZ1bmN0aW9uIFVhKGEpe29ifHwob2I9ZmEoVmEpKTthJiZvYi5hcHBlbmRDaGlsZChhKTtvYi5pbm5lckhUTUw9XCJcIn1mdW5jdGlvbiBrYShhLGIpe3JldHVybiBwYXJzZUZsb2F0KGEudG9QcmVjaXNpb24oYnx8MTQpKX1mdW5jdGlvbiAkYShhLGIpe2IucmVuZGVyZXIuZ2xvYmFsQW5pbWF0aW9uPXEoYSxiLmFuaW1hdGlvbil9ZnVuY3Rpb24gZ2IoYSl7cmV0dXJuIGVhKGEpP1xueihhKTp7ZHVyYXRpb246YT81MDA6MH19ZnVuY3Rpb24gT2IoKXt2YXIgYT1SLmdsb2JhbCxiPWEudXNlVVRDLGM9Yj9cImdldFVUQ1wiOlwiZ2V0XCIsZD1iP1wic2V0VVRDXCI6XCJzZXRcIjtiYT1hLkRhdGV8fEwuRGF0ZTt5Yj1iJiZhLnRpbWV6b25lT2Zmc2V0O2ZiPWImJmEuZ2V0VGltZXpvbmVPZmZzZXQ7cGI9ZnVuY3Rpb24oYSxjLGQsaCxpLGope3ZhciBrO2I/KGs9YmEuVVRDLmFwcGx5KDAsYXJndW1lbnRzKSxrKz1lYihrKSk6az0obmV3IGJhKGEsYyxxKGQsMSkscShoLDApLHEoaSwwKSxxKGosMCkpKS5nZXRUaW1lKCk7cmV0dXJuIGt9O0JiPWMrXCJNaW51dGVzXCI7Q2I9YytcIkhvdXJzXCI7RGI9YytcIkRheVwiO2FiPWMrXCJEYXRlXCI7aGI9YytcIk1vbnRoXCI7aWI9YytcIkZ1bGxZZWFyXCI7UGI9ZCtcIk1pbGxpc2Vjb25kc1wiO1FiPWQrXCJTZWNvbmRzXCI7UmI9ZCtcIk1pbnV0ZXNcIjtTYj1kK1wiSG91cnNcIjtxYj1kK1wiRGF0ZVwiO0ViPWQrXCJNb250aFwiO0ZiPWQrXCJGdWxsWWVhclwifWZ1bmN0aW9uIHZhKGEpe2lmKCEodGhpcyBpbnN0YW5jZW9mXG52YSkpcmV0dXJuIG5ldyB2YShhKTt0aGlzLmluaXQoYSl9ZnVuY3Rpb24gWigpe31mdW5jdGlvbiBiYihhLGIsYyxkKXt0aGlzLmF4aXM9YTt0aGlzLnBvcz1iO3RoaXMudHlwZT1jfHxcIlwiO3RoaXMuaXNOZXc9ITA7IWMmJiFkJiZ0aGlzLmFkZExhYmVsKCl9ZnVuY3Rpb24gVGIoYSxiLGMsZCxlKXt2YXIgZj1hLmNoYXJ0LmludmVydGVkO3RoaXMuYXhpcz1hO3RoaXMuaXNOZWdhdGl2ZT1jO3RoaXMub3B0aW9ucz1iO3RoaXMueD1kO3RoaXMudG90YWw9bnVsbDt0aGlzLnBvaW50cz17fTt0aGlzLnN0YWNrPWU7dGhpcy5yaWdodENsaWZmPXRoaXMubGVmdENsaWZmPTA7dGhpcy5hbGlnbk9wdGlvbnM9e2FsaWduOmIuYWxpZ258fChmP2M/XCJsZWZ0XCI6XCJyaWdodFwiOlwiY2VudGVyXCIpLHZlcnRpY2FsQWxpZ246Yi52ZXJ0aWNhbEFsaWdufHwoZj9cIm1pZGRsZVwiOmM/XCJib3R0b21cIjpcInRvcFwiKSx5OnEoYi55LGY/NDpjPzE0Oi02KSx4OnEoYi54LGY/Yz8tNjo2OjApfTt0aGlzLnRleHRBbGlnbj1cbmIudGV4dEFsaWdufHwoZj9jP1wicmlnaHRcIjpcImxlZnRcIjpcImNlbnRlclwiKX1mdW5jdGlvbiBHYihhKXt2YXIgYj1hLm9wdGlvbnMsYz1iLm5hdmlnYXRvcixkPWMuZW5hYmxlZCxiPWIuc2Nyb2xsYmFyLGU9Yi5lbmFibGVkLGY9ZD9jLmhlaWdodDowLGc9ZT9iLmhlaWdodDowO3RoaXMuaGFuZGxlcz1bXTt0aGlzLnNjcm9sbGJhckJ1dHRvbnM9W107dGhpcy5lbGVtZW50c1RvRGVzdHJveT1bXTt0aGlzLmNoYXJ0PWE7dGhpcy5zZXRCYXNlU2VyaWVzKCk7dGhpcy5oZWlnaHQ9Zjt0aGlzLnNjcm9sbGJhckhlaWdodD1nO3RoaXMuc2Nyb2xsYmFyRW5hYmxlZD1lO3RoaXMubmF2aWdhdG9yRW5hYmxlZD1kO3RoaXMubmF2aWdhdG9yT3B0aW9ucz1jO3RoaXMuc2Nyb2xsYmFyT3B0aW9ucz1iO3RoaXMub3V0bGluZUhlaWdodD1mK2c7dGhpcy5pbml0KCl9ZnVuY3Rpb24gSGIoYSl7dGhpcy5pbml0KGEpfXZhciB0LEg9TC5kb2N1bWVudCxZPU1hdGgseT1ZLnJvdW5kLFY9WS5mbG9vcixFYT1cblkuY2VpbCx3PVkubWF4LEc9WS5taW4sUz1ZLmFicyxjYT1ZLmNvcyxsYT1ZLnNpbixBYT1ZLlBJLHBhPUFhKjIvMzYwLE5hPUwubmF2aWdhdG9yJiZMLm5hdmlnYXRvci51c2VyQWdlbnR8fFwiXCIsVWI9TC5vcGVyYSxLYT0vKG1zaWV8dHJpZGVudHxlZGdlKS9pLnRlc3QoTmEpJiYhVWIscmI9SCYmSC5kb2N1bWVudE1vZGU9PT04LHNiPSFLYSYmL0FwcGxlV2ViS2l0Ly50ZXN0KE5hKSxXYT0vRmlyZWZveC8udGVzdChOYSksamI9LyhNb2JpbGV8QW5kcm9pZHxXaW5kb3dzIFBob25lKS8udGVzdChOYSksUWE9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiLGphPUgmJkguY3JlYXRlRWxlbWVudE5TJiYhIUguY3JlYXRlRWxlbWVudE5TKFFhLFwic3ZnXCIpLmNyZWF0ZVNWR1JlY3QsWmI9V2EmJnBhcnNlSW50KE5hLnNwbGl0KFwiRmlyZWZveC9cIilbMV0sMTApPDQscWE9SCYmIWphJiYhS2EmJiEhSC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpLmdldENvbnRleHQsWGEsY2IsVmI9e30sSWI9XG4wLG9iLFIsbmEsTSxyYT1mdW5jdGlvbigpe30sJD1bXSxrYj0wLFZhPVwiZGl2XCIsJGI9L15bMC05XSskLyx0Yj1bXCJwbG90VG9wXCIsXCJtYXJnaW5SaWdodFwiLFwibWFyZ2luQm90dG9tXCIsXCJwbG90TGVmdFwiXSxiYSxwYix5YixmYixCYixDYixEYixhYixoYixpYixQYixRYixSYixTYixxYixFYixGYixJPXt9LEI7Qj1MLkhpZ2hjaGFydHM/Z2EoMTYsITApOnt3aW46TH07Qi5zZXJpZXNUeXBlcz1JO3ZhciBSYT1bXSx3YSxzYSxvLEZhLEpiLHRhLEUsVCxPLGRiLFNhO3hiLnByb3RvdHlwZT17ZFNldHRlcjpmdW5jdGlvbigpe3ZhciBhPXRoaXMucGF0aHNbMF0sYj10aGlzLnBhdGhzWzFdLGM9W10sZD10aGlzLm5vdyxlPWEubGVuZ3RoLGY7aWYoZD09PTEpYz10aGlzLnRvRDtlbHNlIGlmKGU9PT1iLmxlbmd0aCYmZDwxKWZvcig7ZS0tOylmPXBhcnNlRmxvYXQoYVtlXSksY1tlXT1pc05hTihmKT9hW2VdOmQqcGFyc2VGbG9hdChiW2VdLWYpK2Y7ZWxzZSBjPWI7dGhpcy5lbGVtLmF0dHIoXCJkXCIsXG5jKX0sdXBkYXRlOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5lbGVtLGI9dGhpcy5wcm9wLGM9dGhpcy5ub3csZD10aGlzLm9wdGlvbnMuc3RlcDtpZih0aGlzW2IrXCJTZXR0ZXJcIl0pdGhpc1tiK1wiU2V0dGVyXCJdKCk7ZWxzZSBhLmF0dHI/YS5lbGVtZW50JiZhLmF0dHIoYixjKTphLnN0eWxlW2JdPWMrdGhpcy51bml0O2QmJmQuY2FsbChhLGMsdGhpcyl9LHJ1bjpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9dGhpcyxlPWZ1bmN0aW9uKGEpe3JldHVybiBlLnN0b3BwZWQ/ITE6ZC5zdGVwKGEpfSxmO3RoaXMuc3RhcnRUaW1lPStuZXcgYmE7dGhpcy5zdGFydD1hO3RoaXMuZW5kPWI7dGhpcy51bml0PWM7dGhpcy5ub3c9dGhpcy5zdGFydDt0aGlzLnBvcz0wO2UuZWxlbT10aGlzLmVsZW07aWYoZSgpJiZSYS5wdXNoKGUpPT09MSllLnRpbWVySWQ9c2V0SW50ZXJ2YWwoZnVuY3Rpb24oKXtmb3IoZj0wO2Y8UmEubGVuZ3RoO2YrKylSYVtmXSgpfHxSYS5zcGxpY2UoZi0tLDEpO1JhLmxlbmd0aHx8XG5jbGVhckludGVydmFsKGUudGltZXJJZCl9LDEzKX0sc3RlcDpmdW5jdGlvbihhKXt2YXIgYj0rbmV3IGJhLGMsZD10aGlzLm9wdGlvbnM7Yz10aGlzLmVsZW07dmFyIGU9ZC5jb21wbGV0ZSxmPWQuZHVyYXRpb24sZz1kLmN1ckFuaW0saDtpZihjLmF0dHImJiFjLmVsZW1lbnQpYz0hMTtlbHNlIGlmKGF8fGI+PWYrdGhpcy5zdGFydFRpbWUpe3RoaXMubm93PXRoaXMuZW5kO3RoaXMucG9zPTE7dGhpcy51cGRhdGUoKTthPWdbdGhpcy5wcm9wXT0hMDtmb3IoaCBpbiBnKWdbaF0hPT0hMCYmKGE9ITEpO2EmJmUmJmUuY2FsbChjKTtjPSExfWVsc2UgdGhpcy5wb3M9ZC5lYXNpbmcoKGItdGhpcy5zdGFydFRpbWUpL2YpLHRoaXMubm93PXRoaXMuc3RhcnQrKHRoaXMuZW5kLXRoaXMuc3RhcnQpKnRoaXMucG9zLHRoaXMudXBkYXRlKCksYz0hMDtyZXR1cm4gY30saW5pdFBhdGg6ZnVuY3Rpb24oYSxiLGMpe3ZhciBiPWJ8fFwiXCIsZD1hLnNoaWZ0LGU9Yi5pbmRleE9mKFwiQ1wiKT4tMSxmPWU/XG43OjMsZyxiPWIuc3BsaXQoXCIgXCIpLGM9W10uY29uY2F0KGMpLGg9YS5pc0FyZWEsaT1oPzI6MSxqPWZ1bmN0aW9uKGEpe2ZvcihnPWEubGVuZ3RoO2ctLTspKGFbZ109PT1cIk1cInx8YVtnXT09PVwiTFwiKSYmYS5zcGxpY2UoZysxLDAsYVtnKzFdLGFbZysyXSxhW2crMV0sYVtnKzJdKX07ZSYmKGooYiksaihjKSk7aWYoZDw9Yy5sZW5ndGgvZiYmYi5sZW5ndGg9PT1jLmxlbmd0aClmb3IoO2QtLTspYz1jLnNsaWNlKDAsZikuY29uY2F0KGMpLGgmJihjPWMuY29uY2F0KGMuc2xpY2UoYy5sZW5ndGgtZikpKTthLnNoaWZ0PTA7aWYoYi5sZW5ndGgpZm9yKGE9Yy5sZW5ndGg7Yi5sZW5ndGg8YTspZD1iLnNsaWNlKCkuc3BsaWNlKGIubGVuZ3RoL2ktZixmKmkpLGUmJihkW2YtNl09ZFtmLTJdLGRbZi01XT1kW2YtMV0pLFtdLnNwbGljZS5hcHBseShiLFtiLmxlbmd0aC9pLDBdLmNvbmNhdChkKSk7cmV0dXJuW2IsY119fTt2YXIgQT1CLmV4dGVuZD1mdW5jdGlvbihhLGIpe3ZhciBjO2F8fChhPVxue30pO2ZvcihjIGluIGIpYVtjXT1iW2NdO3JldHVybiBhfSxDPUIuaXNOdW1iZXI9ZnVuY3Rpb24oYSl7cmV0dXJuIHR5cGVvZiBhPT09XCJudW1iZXJcIiYmIWlzTmFOKGEpfSxxPUIucGljaz1mdW5jdGlvbigpe3ZhciBhPWFyZ3VtZW50cyxiLGMsZD1hLmxlbmd0aDtmb3IoYj0wO2I8ZDtiKyspaWYoYz1hW2JdLGMhPT10JiZjIT09bnVsbClyZXR1cm4gY30sVT1CLndyYXA9ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPWFbYl07YVtiXT1mdW5jdGlvbigpe3ZhciBhPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7YS51bnNoaWZ0KGQpO3JldHVybiBjLmFwcGx5KHRoaXMsYSl9fTtuYT1mdW5jdGlvbihhLGIsYyl7aWYoIUMoYikpcmV0dXJuIFIubGFuZy5pbnZhbGlkRGF0ZXx8XCJcIjt2YXIgYT1xKGEsXCIlWS0lbS0lZCAlSDolTTolU1wiKSxkPW5ldyBiYShiLWViKGIpKSxlLGY9ZFtDYl0oKSxnPWRbRGJdKCksaD1kW2FiXSgpLGk9ZFtoYl0oKSxqPWRbaWJdKCksaz1SLmxhbmcsXG5sPWsud2Vla2RheXMsbT1rLnNob3J0V2Vla2RheXMsZD1BKHthOm0/bVtnXTpsW2ddLnN1YnN0cigwLDMpLEE6bFtnXSxkOk9hKGgpLGU6T2EoaCwyLFwiIFwiKSx3OmcsYjprLnNob3J0TW9udGhzW2ldLEI6ay5tb250aHNbaV0sbTpPYShpKzEpLHk6ai50b1N0cmluZygpLnN1YnN0cigyLDIpLFk6aixIOk9hKGYpLGs6ZixJOk9hKGYlMTJ8fDEyKSxsOmYlMTJ8fDEyLE06T2EoZFtCYl0oKSkscDpmPDEyP1wiQU1cIjpcIlBNXCIsUDpmPDEyP1wiYW1cIjpcInBtXCIsUzpPYShkLmdldFNlY29uZHMoKSksTDpPYSh5KGIlMUUzKSwzKX0sQi5kYXRlRm9ybWF0cyk7Zm9yKGUgaW4gZClmb3IoO2EuaW5kZXhPZihcIiVcIitlKSE9PS0xOylhPWEucmVwbGFjZShcIiVcIitlLHR5cGVvZiBkW2VdPT09XCJmdW5jdGlvblwiP2RbZV0oYik6ZFtlXSk7cmV0dXJuIGM/YS5zdWJzdHIoMCwxKS50b1VwcGVyQ2FzZSgpK2Euc3Vic3RyKDEpOmF9O009e21pbGxpc2Vjb25kOjEsc2Vjb25kOjFFMyxtaW51dGU6NkU0LGhvdXI6MzZFNSxcbmRheTo4NjRFNSx3ZWVrOjYwNDhFNSxtb250aDoyNDE5MkU1LHllYXI6MzE0NDk2RTV9O0IubnVtYmVyRm9ybWF0PWZ1bmN0aW9uKGEsYixjLGQpe3ZhciBhPSthfHwwLGI9K2IsZT1SLmxhbmcsZj0oYS50b1N0cmluZygpLnNwbGl0KFwiLlwiKVsxXXx8XCJcIikubGVuZ3RoLGcsaCxpPU1hdGguYWJzKGEpO2I9PT0tMT9iPU1hdGgubWluKGYsMjApOkMoYil8fChiPTIpO2c9U3RyaW5nKEsoaS50b0ZpeGVkKGIpKSk7aD1nLmxlbmd0aD4zP2cubGVuZ3RoJTM6MDtjPXEoYyxlLmRlY2ltYWxQb2ludCk7ZD1xKGQsZS50aG91c2FuZHNTZXApO2E9YTwwP1wiLVwiOlwiXCI7YSs9aD9nLnN1YnN0cigwLGgpK2Q6XCJcIjthKz1nLnN1YnN0cihoKS5yZXBsYWNlKC8oXFxkezN9KSg/PVxcZCkvZyxcIiQxXCIrZCk7YiYmKGQ9TWF0aC5hYnMoaS1nK01hdGgucG93KDEwLC1NYXRoLm1heChiLGYpLTEpKSxhKz1jK2QudG9GaXhlZChiKS5zbGljZSgyKSk7cmV0dXJuIGF9O01hdGguZWFzZUluT3V0U2luZT1mdW5jdGlvbihhKXtyZXR1cm4tMC41KlxuKE1hdGguY29zKE1hdGguUEkqYSktMSl9O3dhPWZ1bmN0aW9uKGEsYil7dmFyIGM7aWYoYj09PVwid2lkdGhcIilyZXR1cm4gTWF0aC5taW4oYS5vZmZzZXRXaWR0aCxhLnNjcm9sbFdpZHRoKS13YShhLFwicGFkZGluZy1sZWZ0XCIpLXdhKGEsXCJwYWRkaW5nLXJpZ2h0XCIpO2Vsc2UgaWYoYj09PVwiaGVpZ2h0XCIpcmV0dXJuIE1hdGgubWluKGEub2Zmc2V0SGVpZ2h0LGEuc2Nyb2xsSGVpZ2h0KS13YShhLFwicGFkZGluZy10b3BcIiktd2EoYSxcInBhZGRpbmctYm90dG9tXCIpO3JldHVybihjPUwuZ2V0Q29tcHV0ZWRTdHlsZShhLHZvaWQgMCkpJiZLKGMuZ2V0UHJvcGVydHlWYWx1ZShiKSl9O3NhPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGIuaW5kZXhPZj9iLmluZGV4T2YoYSk6W10uaW5kZXhPZi5jYWxsKGIsYSl9O0ZhPWZ1bmN0aW9uKGEsYil7cmV0dXJuW10uZmlsdGVyLmNhbGwoYSxiKX07dGE9ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9W10sZD0wLGU9YS5sZW5ndGg7ZDxlO2QrKyljW2RdPWIuY2FsbChhW2RdLFxuYVtkXSxkLGEpO3JldHVybiBjfTtKYj1mdW5jdGlvbihhKXt2YXIgYj1ILmRvY3VtZW50RWxlbWVudCxhPWEuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7cmV0dXJue3RvcDphLnRvcCsoTC5wYWdlWU9mZnNldHx8Yi5zY3JvbGxUb3ApLShiLmNsaWVudFRvcHx8MCksbGVmdDphLmxlZnQrKEwucGFnZVhPZmZzZXR8fGIuc2Nyb2xsTGVmdCktKGIuY2xpZW50TGVmdHx8MCl9fTtTYT1mdW5jdGlvbihhKXtmb3IodmFyIGI9UmEubGVuZ3RoO2ItLTspaWYoUmFbYl0uZWxlbT09PWEpUmFbYl0uc3RvcHBlZD0hMH07bz1mdW5jdGlvbihhLGIpe3JldHVybiBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGEsYil9O0U9ZnVuY3Rpb24oYSxiLGMpe2Z1bmN0aW9uIGQoYil7Yi50YXJnZXQ9Yi5zcmNFbGVtZW50fHxMO2MuY2FsbChhLGIpfXZhciBlPWEuaGNFdmVudHM9YS5oY0V2ZW50c3x8e307aWYoYS5hZGRFdmVudExpc3RlbmVyKWEuYWRkRXZlbnRMaXN0ZW5lcihiLGMsITEpO2Vsc2UgaWYoYS5hdHRhY2hFdmVudCl7aWYoIWEuaGNFdmVudHNJRSlhLmhjRXZlbnRzSUU9XG57fTthLmhjRXZlbnRzSUVbYy50b1N0cmluZygpXT1kO2EuYXR0YWNoRXZlbnQoXCJvblwiK2IsZCl9ZVtiXXx8KGVbYl09W10pO2VbYl0ucHVzaChjKX07VD1mdW5jdGlvbihhLGIsYyl7ZnVuY3Rpb24gZChiLGMpe2EucmVtb3ZlRXZlbnRMaXN0ZW5lcj9hLnJlbW92ZUV2ZW50TGlzdGVuZXIoYixjLCExKTphLmF0dGFjaEV2ZW50JiYoYz1hLmhjRXZlbnRzSUVbYy50b1N0cmluZygpXSxhLmRldGFjaEV2ZW50KFwib25cIitiLGMpKX1mdW5jdGlvbiBlKCl7dmFyIGMsZSxmO2lmKGEubm9kZU5hbWUpZm9yKGYgaW4gYj8oYz17fSxjW2JdPSEwKTpjPWcsYylpZihnW2ZdKWZvcihlPWdbZl0ubGVuZ3RoO2UtLTspZChmLGdbZl1bZV0pfXZhciBmLGc9YS5oY0V2ZW50cyxoO2lmKGcpYj8oZj1nW2JdfHxbXSxjPyhoPXNhKGMsZiksaD4tMSYmKGYuc3BsaWNlKGgsMSksZ1tiXT1mKSxkKGIsYykpOihlKCksZ1tiXT1bXSkpOihlKCksYS5oY0V2ZW50cz17fSl9O089ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU7XG5lPWEuaGNFdmVudHM7dmFyIGYsZyxjPWN8fHt9O2lmKEguY3JlYXRlRXZlbnQmJihhLmRpc3BhdGNoRXZlbnR8fGEuZmlyZUV2ZW50KSllPUguY3JlYXRlRXZlbnQoXCJFdmVudHNcIiksZS5pbml0RXZlbnQoYiwhMCwhMCksZS50YXJnZXQ9YSxBKGUsYyksYS5kaXNwYXRjaEV2ZW50P2EuZGlzcGF0Y2hFdmVudChlKTphLmZpcmVFdmVudChiLGUpO2Vsc2UgaWYoZSl7ZT1lW2JdfHxbXTtmPWUubGVuZ3RoO2lmKCFjLnByZXZlbnREZWZhdWx0KWMucHJldmVudERlZmF1bHQ9ZnVuY3Rpb24oKXtjLmRlZmF1bHRQcmV2ZW50ZWQ9ITB9O2MudGFyZ2V0PWE7aWYoIWMudHlwZSljLnR5cGU9Yjtmb3IoYj0wO2I8ZjtiKyspZz1lW2JdLGcuY2FsbChhLGMpPT09ITEmJmMucHJldmVudERlZmF1bHQoKX1kJiYhYy5kZWZhdWx0UHJldmVudGVkJiZkKGMpfTtkYj1mdW5jdGlvbihhLGIsYyl7dmFyIGQsZT1cIlwiLGYsZyxoO2VhKGMpfHwoZD1hcmd1bWVudHMsYz17ZHVyYXRpb246ZFsyXSxlYXNpbmc6ZFszXSxcbmNvbXBsZXRlOmRbNF19KTtpZighQyhjLmR1cmF0aW9uKSljLmR1cmF0aW9uPTQwMDtjLmVhc2luZz10eXBlb2YgYy5lYXNpbmc9PT1cImZ1bmN0aW9uXCI/Yy5lYXNpbmc6TWF0aFtjLmVhc2luZ118fE1hdGguZWFzZUluT3V0U2luZTtjLmN1ckFuaW09eihiKTtmb3IoaCBpbiBiKWc9bmV3IHhiKGEsYyxoKSxmPW51bGwsaD09PVwiZFwiPyhnLnBhdGhzPWcuaW5pdFBhdGgoYSxhLmQsYi5kKSxnLnRvRD1iLmQsZD0wLGY9MSk6YS5hdHRyP2Q9YS5hdHRyKGgpOihkPXBhcnNlRmxvYXQod2EoYSxoKSl8fDAsaCE9PVwib3BhY2l0eVwiJiYoZT1cInB4XCIpKSxmfHwoZj1iW2hdKSxmLm1hdGNoJiZmLm1hdGNoKFwicHhcIikmJihmPWYucmVwbGFjZSgvcHgvZyxcIlwiKSksZy5ydW4oZCxmLGUpfTtpZihMLmpRdWVyeSlMLmpRdWVyeS5mbi5oaWdoY2hhcnRzPWZ1bmN0aW9uKCl7dmFyIGE9W10uc2xpY2UuY2FsbChhcmd1bWVudHMpO2lmKHRoaXNbMF0pcmV0dXJuIGFbMF0/KG5ldyAoQltDYShhWzBdKT9hLnNoaWZ0KCk6XG5cIkNoYXJ0XCJdKSh0aGlzWzBdLGFbMF0sYVsxXSksdGhpcyk6JFtYKHRoaXNbMF0sXCJkYXRhLWhpZ2hjaGFydHMtY2hhcnRcIildfTtIJiYhSC5kZWZhdWx0VmlldyYmKHdhPWZ1bmN0aW9uKGEsYil7dmFyIGM7Yz17d2lkdGg6XCJjbGllbnRXaWR0aFwiLGhlaWdodDpcImNsaWVudEhlaWdodFwifVtiXTtpZihhLnN0eWxlW2JdKXJldHVybiBLKGEuc3R5bGVbYl0pO2I9PT1cIm9wYWNpdHlcIiYmKGI9XCJmaWx0ZXJcIik7aWYoYylyZXR1cm4gYS5zdHlsZS56b29tPTEsTWF0aC5tYXgoYVtjXS0yKndhKGEsXCJwYWRkaW5nXCIpLDApO2M9YS5jdXJyZW50U3R5bGVbYi5yZXBsYWNlKC9cXC0oXFx3KS9nLGZ1bmN0aW9uKGEsYil7cmV0dXJuIGIudG9VcHBlckNhc2UoKX0pXTtiPT09XCJmaWx0ZXJcIiYmKGM9Yy5yZXBsYWNlKC9hbHBoYVxcKG9wYWNpdHk9KFswLTldKylcXCkvLGZ1bmN0aW9uKGEsYil7cmV0dXJuIGIvMTAwfSkpO3JldHVybiBjPT09XCJcIj8xOksoYyl9KTtBcnJheS5wcm90b3R5cGUuZm9yRWFjaHx8XG4obz1mdW5jdGlvbihhLGIpe2Zvcih2YXIgYz0wLGQ9YS5sZW5ndGg7YzxkO2MrKylpZihiLmNhbGwoYVtjXSxhW2NdLGMsYSk9PT0hMSlyZXR1cm4gY30pO0FycmF5LnByb3RvdHlwZS5pbmRleE9mfHwoc2E9ZnVuY3Rpb24oYSxiKXt2YXIgYyxkPTA7aWYoYilmb3IoYz1iLmxlbmd0aDtkPGM7ZCsrKWlmKGJbZF09PT1hKXJldHVybiBkO3JldHVybi0xfSk7QXJyYXkucHJvdG90eXBlLmZpbHRlcnx8KEZhPWZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPVtdLGQ9MCxlPWEubGVuZ3RoO2Q8ZTtkKyspYihhW2RdLGQpJiZjLnB1c2goYVtkXSk7cmV0dXJuIGN9KTtCLkZ4PXhiO0IuaW5BcnJheT1zYTtCLmVhY2g9bztCLmdyZXA9RmE7Qi5vZmZzZXQ9SmI7Qi5tYXA9dGE7Qi5hZGRFdmVudD1FO0IucmVtb3ZlRXZlbnQ9VDtCLmZpcmVFdmVudD1PO0IuYW5pbWF0ZT1kYjtCLmFuaW1PYmplY3Q9Z2I7Qi5zdG9wPVNhO1I9e2NvbG9yczpcIiM3Y2I1ZWMsIzQzNDM0OCwjOTBlZDdkLCNmN2EzNWMsIzgwODVlOSwjZjE1YzgwLCNlNGQzNTQsIzJiOTA4ZiwjZjQ1YjViLCM5MWU4ZTFcIi5zcGxpdChcIixcIiksXG5zeW1ib2xzOltcImNpcmNsZVwiLFwiZGlhbW9uZFwiLFwic3F1YXJlXCIsXCJ0cmlhbmdsZVwiLFwidHJpYW5nbGUtZG93blwiXSxsYW5nOntsb2FkaW5nOlwiTG9hZGluZy4uLlwiLG1vbnRoczpcIkphbnVhcnksRmVicnVhcnksTWFyY2gsQXByaWwsTWF5LEp1bmUsSnVseSxBdWd1c3QsU2VwdGVtYmVyLE9jdG9iZXIsTm92ZW1iZXIsRGVjZW1iZXJcIi5zcGxpdChcIixcIiksc2hvcnRNb250aHM6XCJKYW4sRmViLE1hcixBcHIsTWF5LEp1bixKdWwsQXVnLFNlcCxPY3QsTm92LERlY1wiLnNwbGl0KFwiLFwiKSx3ZWVrZGF5czpcIlN1bmRheSxNb25kYXksVHVlc2RheSxXZWRuZXNkYXksVGh1cnNkYXksRnJpZGF5LFNhdHVyZGF5XCIuc3BsaXQoXCIsXCIpLGRlY2ltYWxQb2ludDpcIi5cIixudW1lcmljU3ltYm9sczpcImssTSxHLFQsUCxFXCIuc3BsaXQoXCIsXCIpLHJlc2V0Wm9vbTpcIlJlc2V0IHpvb21cIixyZXNldFpvb21UaXRsZTpcIlJlc2V0IHpvb20gbGV2ZWwgMToxXCIsdGhvdXNhbmRzU2VwOlwiIFwifSxnbG9iYWw6e3VzZVVUQzohMCxcbmNhbnZhc1Rvb2xzVVJMOlwiaHR0cDovL2NvZGUuaGlnaGNoYXJ0cy5jb20vbW9kdWxlcy9jYW52YXMtdG9vbHMuanNcIixWTUxSYWRpYWxHcmFkaWVudFVSTDpcImh0dHA6Ly9jb2RlLmhpZ2hjaGFydHMuY29tL3N0b2NrLzQuMi41L2dmeC92bWwtcmFkaWFsLWdyYWRpZW50LnBuZ1wifSxjaGFydDp7Ym9yZGVyQ29sb3I6XCIjNDU3MkE3XCIsYm9yZGVyUmFkaXVzOjAsZGVmYXVsdFNlcmllc1R5cGU6XCJsaW5lXCIsaWdub3JlSGlkZGVuU2VyaWVzOiEwLHNwYWNpbmc6WzEwLDEwLDE1LDEwXSxiYWNrZ3JvdW5kQ29sb3I6XCIjRkZGRkZGXCIscGxvdEJvcmRlckNvbG9yOlwiI0MwQzBDMFwiLHJlc2V0Wm9vbUJ1dHRvbjp7dGhlbWU6e3pJbmRleDoyMH0scG9zaXRpb246e2FsaWduOlwicmlnaHRcIix4Oi0xMCx5OjEwfX19LHRpdGxlOnt0ZXh0OlwiQ2hhcnQgdGl0bGVcIixhbGlnbjpcImNlbnRlclwiLG1hcmdpbjoxNSxzdHlsZTp7Y29sb3I6XCIjMzMzMzMzXCIsZm9udFNpemU6XCIxOHB4XCJ9LHdpZHRoQWRqdXN0Oi00NH0sXG5zdWJ0aXRsZTp7dGV4dDpcIlwiLGFsaWduOlwiY2VudGVyXCIsc3R5bGU6e2NvbG9yOlwiIzU1NTU1NVwifSx3aWR0aEFkanVzdDotNDR9LHBsb3RPcHRpb25zOntsaW5lOnthbGxvd1BvaW50U2VsZWN0OiExLHNob3dDaGVja2JveDohMSxhbmltYXRpb246e2R1cmF0aW9uOjFFM30sZXZlbnRzOnt9LGxpbmVXaWR0aDoyLG1hcmtlcjp7bGluZVdpZHRoOjAscmFkaXVzOjQsbGluZUNvbG9yOlwiI0ZGRkZGRlwiLHN0YXRlczp7aG92ZXI6e2VuYWJsZWQ6ITAsbGluZVdpZHRoUGx1czoxLHJhZGl1c1BsdXM6Mn0sc2VsZWN0OntmaWxsQ29sb3I6XCIjRkZGRkZGXCIsbGluZUNvbG9yOlwiIzAwMDAwMFwiLGxpbmVXaWR0aDoyfX19LHBvaW50OntldmVudHM6e319LGRhdGFMYWJlbHM6e2FsaWduOlwiY2VudGVyXCIsZm9ybWF0dGVyOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMueT09PW51bGw/XCJcIjpCLm51bWJlckZvcm1hdCh0aGlzLnksLTEpfSxzdHlsZTp7Y29sb3I6XCJjb250cmFzdFwiLGZvbnRTaXplOlwiMTFweFwiLFxuZm9udFdlaWdodDpcImJvbGRcIix0ZXh0U2hhZG93OlwiMCAwIDZweCBjb250cmFzdCwgMCAwIDNweCBjb250cmFzdFwifSx2ZXJ0aWNhbEFsaWduOlwiYm90dG9tXCIseDowLHk6MCxwYWRkaW5nOjV9LGNyb3BUaHJlc2hvbGQ6MzAwLHBvaW50UmFuZ2U6MCxzb2Z0VGhyZXNob2xkOiEwLHN0YXRlczp7aG92ZXI6e2xpbmVXaWR0aFBsdXM6MSxtYXJrZXI6e30saGFsbzp7c2l6ZToxMCxvcGFjaXR5OjAuMjV9fSxzZWxlY3Q6e21hcmtlcjp7fX19LHN0aWNreVRyYWNraW5nOiEwLHR1cmJvVGhyZXNob2xkOjFFM319LGxhYmVsczp7c3R5bGU6e3Bvc2l0aW9uOlwiYWJzb2x1dGVcIixjb2xvcjpcIiMzRTU3NkZcIn19LGxlZ2VuZDp7ZW5hYmxlZDohMCxhbGlnbjpcImNlbnRlclwiLGxheW91dDpcImhvcml6b250YWxcIixsYWJlbEZvcm1hdHRlcjpmdW5jdGlvbigpe3JldHVybiB0aGlzLm5hbWV9LGJvcmRlckNvbG9yOlwiIzkwOTA5MFwiLGJvcmRlclJhZGl1czowLG5hdmlnYXRpb246e2FjdGl2ZUNvbG9yOlwiIzI3NGI2ZFwiLFxuaW5hY3RpdmVDb2xvcjpcIiNDQ0NcIn0sc2hhZG93OiExLGl0ZW1TdHlsZTp7Y29sb3I6XCIjMzMzMzMzXCIsZm9udFNpemU6XCIxMnB4XCIsZm9udFdlaWdodDpcImJvbGRcIn0saXRlbUhvdmVyU3R5bGU6e2NvbG9yOlwiIzAwMFwifSxpdGVtSGlkZGVuU3R5bGU6e2NvbG9yOlwiI0NDQ1wifSxpdGVtQ2hlY2tib3hTdHlsZTp7cG9zaXRpb246XCJhYnNvbHV0ZVwiLHdpZHRoOlwiMTNweFwiLGhlaWdodDpcIjEzcHhcIn0sc3ltYm9sUGFkZGluZzo1LHZlcnRpY2FsQWxpZ246XCJib3R0b21cIix4OjAseTowLHRpdGxlOntzdHlsZTp7Zm9udFdlaWdodDpcImJvbGRcIn19fSxsb2FkaW5nOntsYWJlbFN0eWxlOntmb250V2VpZ2h0OlwiYm9sZFwiLHBvc2l0aW9uOlwicmVsYXRpdmVcIix0b3A6XCI0NSVcIn0sc3R5bGU6e3Bvc2l0aW9uOlwiYWJzb2x1dGVcIixiYWNrZ3JvdW5kQ29sb3I6XCJ3aGl0ZVwiLG9wYWNpdHk6MC41LHRleHRBbGlnbjpcImNlbnRlclwifX0sdG9vbHRpcDp7ZW5hYmxlZDohMCxhbmltYXRpb246amEsYmFja2dyb3VuZENvbG9yOlwicmdiYSgyNDksIDI0OSwgMjQ5LCAuODUpXCIsXG5ib3JkZXJXaWR0aDoxLGJvcmRlclJhZGl1czozLGRhdGVUaW1lTGFiZWxGb3JtYXRzOnttaWxsaXNlY29uZDpcIiVBLCAlYiAlZSwgJUg6JU06JVMuJUxcIixzZWNvbmQ6XCIlQSwgJWIgJWUsICVIOiVNOiVTXCIsbWludXRlOlwiJUEsICViICVlLCAlSDolTVwiLGhvdXI6XCIlQSwgJWIgJWUsICVIOiVNXCIsZGF5OlwiJUEsICViICVlLCAlWVwiLHdlZWs6XCJXZWVrIGZyb20gJUEsICViICVlLCAlWVwiLG1vbnRoOlwiJUIgJVlcIix5ZWFyOlwiJVlcIn0sZm9vdGVyRm9ybWF0OlwiXCIsaGVhZGVyRm9ybWF0Oic8c3BhbiBzdHlsZT1cImZvbnQtc2l6ZTogMTBweFwiPntwb2ludC5rZXl9PC9zcGFuPjxici8+Jyxwb2ludEZvcm1hdDonPHNwYW4gc3R5bGU9XCJjb2xvcjp7cG9pbnQuY29sb3J9XCI+XFx1MjVjZjwvc3Bhbj4ge3Nlcmllcy5uYW1lfTogPGI+e3BvaW50Lnl9PC9iPjxici8+JyxzaGFkb3c6ITAsc25hcDpqYj8yNToxMCxzdHlsZTp7Y29sb3I6XCIjMzMzMzMzXCIsY3Vyc29yOlwiZGVmYXVsdFwiLGZvbnRTaXplOlwiMTJweFwiLFxucGFkZGluZzpcIjhweFwiLHBvaW50ZXJFdmVudHM6XCJub25lXCIsd2hpdGVTcGFjZTpcIm5vd3JhcFwifX0sY3JlZGl0czp7ZW5hYmxlZDohMCx0ZXh0OlwiSGlnaGNoYXJ0cy5jb21cIixocmVmOlwiaHR0cDovL3d3dy5oaWdoY2hhcnRzLmNvbVwiLHBvc2l0aW9uOnthbGlnbjpcInJpZ2h0XCIseDotMTAsdmVydGljYWxBbGlnbjpcImJvdHRvbVwiLHk6LTV9LHN0eWxlOntjdXJzb3I6XCJwb2ludGVyXCIsY29sb3I6XCIjOTA5MDkwXCIsZm9udFNpemU6XCI5cHhcIn19fTt2YXIgVz1SLnBsb3RPcHRpb25zLGRhPVcubGluZTtPYigpO3ZhLnByb3RvdHlwZT17cGFyc2Vyczpbe3JlZ2V4Oi9yZ2JhXFwoXFxzKihbMC05XXsxLDN9KVxccyosXFxzKihbMC05XXsxLDN9KVxccyosXFxzKihbMC05XXsxLDN9KVxccyosXFxzKihbMC05XT8oPzpcXC5bMC05XSspPylcXHMqXFwpLyxwYXJzZTpmdW5jdGlvbihhKXtyZXR1cm5bSyhhWzFdKSxLKGFbMl0pLEsoYVszXSkscGFyc2VGbG9hdChhWzRdLDEwKV19fSx7cmVnZXg6LyMoW2EtZkEtRjAtOV17Mn0pKFthLWZBLUYwLTldezJ9KShbYS1mQS1GMC05XXsyfSkvLFxucGFyc2U6ZnVuY3Rpb24oYSl7cmV0dXJuW0soYVsxXSwxNiksSyhhWzJdLDE2KSxLKGFbM10sMTYpLDFdfX0se3JlZ2V4Oi9yZ2JcXChcXHMqKFswLTldezEsM30pXFxzKixcXHMqKFswLTldezEsM30pXFxzKixcXHMqKFswLTldezEsM30pXFxzKlxcKS8scGFyc2U6ZnVuY3Rpb24oYSl7cmV0dXJuW0soYVsxXSksSyhhWzJdKSxLKGFbM10pLDFdfX1dLGluaXQ6ZnVuY3Rpb24oYSl7dmFyIGIsYyxkLGU7aWYoKHRoaXMuaW5wdXQ9YSkmJmEuc3RvcHMpdGhpcy5zdG9wcz10YShhLnN0b3BzLGZ1bmN0aW9uKGEpe3JldHVybiBuZXcgdmEoYVsxXSl9KTtlbHNlIGZvcihkPXRoaXMucGFyc2Vycy5sZW5ndGg7ZC0tJiYhYzspZT10aGlzLnBhcnNlcnNbZF0sKGI9ZS5yZWdleC5leGVjKGEpKSYmKGM9ZS5wYXJzZShiKSk7dGhpcy5yZ2JhPWN8fFtdfSxnZXQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5pbnB1dCxjPXRoaXMucmdiYSxkO3RoaXMuc3RvcHM/KGQ9eihiKSxkLnN0b3BzPVtdLmNvbmNhdChkLnN0b3BzKSxcbm8odGhpcy5zdG9wcyxmdW5jdGlvbihiLGMpe2Quc3RvcHNbY109W2Quc3RvcHNbY11bMF0sYi5nZXQoYSldfSkpOmQ9YyYmQyhjWzBdKT9hPT09XCJyZ2JcInx8IWEmJmNbM109PT0xP1wicmdiKFwiK2NbMF0rXCIsXCIrY1sxXStcIixcIitjWzJdK1wiKVwiOmE9PT1cImFcIj9jWzNdOlwicmdiYShcIitjLmpvaW4oXCIsXCIpK1wiKVwiOmI7cmV0dXJuIGR9LGJyaWdodGVuOmZ1bmN0aW9uKGEpe3ZhciBiLGM9dGhpcy5yZ2JhO2lmKHRoaXMuc3RvcHMpbyh0aGlzLnN0b3BzLGZ1bmN0aW9uKGIpe2IuYnJpZ2h0ZW4oYSl9KTtlbHNlIGlmKEMoYSkmJmEhPT0wKWZvcihiPTA7YjwzO2IrKyljW2JdKz1LKGEqMjU1KSxjW2JdPDAmJihjW2JdPTApLGNbYl0+MjU1JiYoY1tiXT0yNTUpO3JldHVybiB0aGlzfSxzZXRPcGFjaXR5OmZ1bmN0aW9uKGEpe3RoaXMucmdiYVszXT1hO3JldHVybiB0aGlzfX07Wi5wcm90b3R5cGU9e29wYWNpdHk6MSx0ZXh0UHJvcHM6XCJkaXJlY3Rpb24sZm9udFNpemUsZm9udFdlaWdodCxmb250RmFtaWx5LGZvbnRTdHlsZSxjb2xvcixsaW5lSGVpZ2h0LHdpZHRoLHRleHREZWNvcmF0aW9uLHRleHRPdmVyZmxvdyx0ZXh0U2hhZG93XCIuc3BsaXQoXCIsXCIpLFxuaW5pdDpmdW5jdGlvbihhLGIpe3RoaXMuZWxlbWVudD1iPT09XCJzcGFuXCI/ZmEoYik6SC5jcmVhdGVFbGVtZW50TlMoUWEsYik7dGhpcy5yZW5kZXJlcj1hfSxhbmltYXRlOmZ1bmN0aW9uKGEsYixjKXtiPXEoYix0aGlzLnJlbmRlcmVyLmdsb2JhbEFuaW1hdGlvbiwhMCk7U2EodGhpcyk7aWYoYil7aWYoYyliLmNvbXBsZXRlPWM7ZGIodGhpcyxhLGIpfWVsc2UgdGhpcy5hdHRyKGEsbnVsbCxjKTtyZXR1cm4gdGhpc30sY29sb3JHcmFkaWVudDpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9dGhpcy5yZW5kZXJlcixlLGYsZyxoLGksaixrLGwsbSxuLHAscj1bXSxzO2EubGluZWFyR3JhZGllbnQ/Zj1cImxpbmVhckdyYWRpZW50XCI6YS5yYWRpYWxHcmFkaWVudCYmKGY9XCJyYWRpYWxHcmFkaWVudFwiKTtpZihmKXtnPWFbZl07aT1kLmdyYWRpZW50cztrPWEuc3RvcHM7bj1jLnJhZGlhbFJlZmVyZW5jZTtKYShnKSYmKGFbZl09Zz17eDE6Z1swXSx5MTpnWzFdLHgyOmdbMl0seTI6Z1szXSxncmFkaWVudFVuaXRzOlwidXNlclNwYWNlT25Vc2VcIn0pO1xuZj09PVwicmFkaWFsR3JhZGllbnRcIiYmbiYmIXYoZy5ncmFkaWVudFVuaXRzKSYmKGg9ZyxnPXooZyxkLmdldFJhZGlhbEF0dHIobixoKSx7Z3JhZGllbnRVbml0czpcInVzZXJTcGFjZU9uVXNlXCJ9KSk7Zm9yKHAgaW4gZylwIT09XCJpZFwiJiZyLnB1c2gocCxnW3BdKTtmb3IocCBpbiBrKXIucHVzaChrW3BdKTtyPXIuam9pbihcIixcIik7aVtyXT9uPWlbcl0uYXR0cihcImlkXCIpOihnLmlkPW49XCJoaWdoY2hhcnRzLVwiK0liKyssaVtyXT1qPWQuY3JlYXRlRWxlbWVudChmKS5hdHRyKGcpLmFkZChkLmRlZnMpLGoucmFkQXR0cj1oLGouc3RvcHM9W10sbyhrLGZ1bmN0aW9uKGEpe2FbMV0uaW5kZXhPZihcInJnYmFcIik9PT0wPyhlPXZhKGFbMV0pLGw9ZS5nZXQoXCJyZ2JcIiksbT1lLmdldChcImFcIikpOihsPWFbMV0sbT0xKTthPWQuY3JlYXRlRWxlbWVudChcInN0b3BcIikuYXR0cih7b2Zmc2V0OmFbMF0sXCJzdG9wLWNvbG9yXCI6bCxcInN0b3Atb3BhY2l0eVwiOm19KS5hZGQoaik7ai5zdG9wcy5wdXNoKGEpfSkpO1xucz1cInVybChcIitkLnVybCtcIiNcIituK1wiKVwiO2Muc2V0QXR0cmlidXRlKGIscyk7Yy5ncmFkaWVudD1yO2EudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gc319fSxhcHBseVRleHRTaGFkb3c6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5lbGVtZW50LGMsZD1hLmluZGV4T2YoXCJjb250cmFzdFwiKSE9PS0xLGU9e30sZj10aGlzLnJlbmRlcmVyLmZvckV4cG9ydCxnPWZ8fGIuc3R5bGUudGV4dFNoYWRvdyE9PXQmJiFLYTtpZihkKWUudGV4dFNoYWRvdz1hPWEucmVwbGFjZSgvY29udHJhc3QvZyx0aGlzLnJlbmRlcmVyLmdldENvbnRyYXN0KGIuc3R5bGUuZmlsbCkpO2lmKHNifHxmKWUudGV4dFJlbmRlcmluZz1cImdlb21ldHJpY1ByZWNpc2lvblwiO2c/dGhpcy5jc3MoZSk6KHRoaXMuZmFrZVRTPSEwLHRoaXMueVNldHRlcj10aGlzLnhTZXR0ZXIsYz1bXS5zbGljZS5jYWxsKGIuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJ0c3BhblwiKSksbyhhLnNwbGl0KC9cXHM/LFxccz8vZyksZnVuY3Rpb24oYSl7dmFyIGQ9XG5iLmZpcnN0Q2hpbGQsZSxmLGE9YS5zcGxpdChcIiBcIik7ZT1hW2EubGVuZ3RoLTFdOyhmPWFbYS5sZW5ndGgtMl0pJiZvKGMsZnVuY3Rpb24oYSxjKXt2YXIgZztjPT09MCYmKGEuc2V0QXR0cmlidXRlKFwieFwiLGIuZ2V0QXR0cmlidXRlKFwieFwiKSksYz1iLmdldEF0dHJpYnV0ZShcInlcIiksYS5zZXRBdHRyaWJ1dGUoXCJ5XCIsY3x8MCksYz09PW51bGwmJmIuc2V0QXR0cmlidXRlKFwieVwiLDApKTtnPWEuY2xvbmVOb2RlKDEpO1goZyx7XCJjbGFzc1wiOlwiaGlnaGNoYXJ0cy10ZXh0LXNoYWRvd1wiLGZpbGw6ZSxzdHJva2U6ZSxcInN0cm9rZS1vcGFjaXR5XCI6MS93KEsoZiksMyksXCJzdHJva2Utd2lkdGhcIjpmLFwic3Ryb2tlLWxpbmVqb2luXCI6XCJyb3VuZFwifSk7Yi5pbnNlcnRCZWZvcmUoZyxkKX0pfSkpfSxhdHRyOmZ1bmN0aW9uKGEsYixjKXt2YXIgZCxlPXRoaXMuZWxlbWVudCxmLGc9dGhpcyxoO3R5cGVvZiBhPT09XCJzdHJpbmdcIiYmYiE9PXQmJihkPWEsYT17fSxhW2RdPWIpO2lmKHR5cGVvZiBhPT09XG5cInN0cmluZ1wiKWc9KHRoaXNbYStcIkdldHRlclwiXXx8dGhpcy5fZGVmYXVsdEdldHRlcikuY2FsbCh0aGlzLGEsZSk7ZWxzZXtmb3IoZCBpbiBhKXtiPWFbZF07aD0hMTt0aGlzLnN5bWJvbE5hbWUmJi9eKHh8eXx3aWR0aHxoZWlnaHR8cnxzdGFydHxlbmR8aW5uZXJSfGFuY2hvclh8YW5jaG9yWSkvLnRlc3QoZCkmJihmfHwodGhpcy5zeW1ib2xBdHRyKGEpLGY9ITApLGg9ITApO2lmKHRoaXMucm90YXRpb24mJihkPT09XCJ4XCJ8fGQ9PT1cInlcIikpdGhpcy5kb1RyYW5zZm9ybT0hMDtofHwoaD10aGlzW2QrXCJTZXR0ZXJcIl18fHRoaXMuX2RlZmF1bHRTZXR0ZXIsaC5jYWxsKHRoaXMsYixkLGUpLHRoaXMuc2hhZG93cyYmL14od2lkdGh8aGVpZ2h0fHZpc2liaWxpdHl8eHx5fGR8dHJhbnNmb3JtfGN4fGN5fHIpJC8udGVzdChkKSYmdGhpcy51cGRhdGVTaGFkb3dzKGQsYixoKSl9aWYodGhpcy5kb1RyYW5zZm9ybSl0aGlzLnVwZGF0ZVRyYW5zZm9ybSgpLHRoaXMuZG9UcmFuc2Zvcm09ITF9YyYmXG5jKCk7cmV0dXJuIGd9LHVwZGF0ZVNoYWRvd3M6ZnVuY3Rpb24oYSxiLGMpe2Zvcih2YXIgZD10aGlzLnNoYWRvd3MsZT1kLmxlbmd0aDtlLS07KWMuY2FsbChkW2VdLGE9PT1cImhlaWdodFwiP01hdGgubWF4KGItKGRbZV0uY3V0SGVpZ2h0fHwwKSwwKTphPT09XCJkXCI/dGhpcy5kOmIsYSxkW2VdKX0sYWRkQ2xhc3M6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5lbGVtZW50LGM9WChiLFwiY2xhc3NcIil8fFwiXCI7Yy5pbmRleE9mKGEpPT09LTEmJlgoYixcImNsYXNzXCIsYytcIiBcIithKTtyZXR1cm4gdGhpc30sc3ltYm9sQXR0cjpmdW5jdGlvbihhKXt2YXIgYj10aGlzO28oXCJ4LHkscixzdGFydCxlbmQsd2lkdGgsaGVpZ2h0LGlubmVyUixhbmNob3JYLGFuY2hvcllcIi5zcGxpdChcIixcIiksZnVuY3Rpb24oYyl7YltjXT1xKGFbY10sYltjXSl9KTtiLmF0dHIoe2Q6Yi5yZW5kZXJlci5zeW1ib2xzW2Iuc3ltYm9sTmFtZV0oYi54LGIueSxiLndpZHRoLGIuaGVpZ2h0LGIpfSl9LGNsaXA6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuYXR0cihcImNsaXAtcGF0aFwiLFxuYT9cInVybChcIit0aGlzLnJlbmRlcmVyLnVybCtcIiNcIithLmlkK1wiKVwiOlwibm9uZVwiKX0sY3Jpc3A6ZnVuY3Rpb24oYSl7dmFyIGIsYz17fSxkLGU9dGhpcy5zdHJva2VXaWR0aHx8MDtkPXkoZSklMi8yO2EueD1WKGEueHx8dGhpcy54fHwwKStkO2EueT1WKGEueXx8dGhpcy55fHwwKStkO2Eud2lkdGg9VigoYS53aWR0aHx8dGhpcy53aWR0aHx8MCktMipkKTthLmhlaWdodD1WKChhLmhlaWdodHx8dGhpcy5oZWlnaHR8fDApLTIqZCk7YS5zdHJva2VXaWR0aD1lO2ZvcihiIGluIGEpdGhpc1tiXSE9PWFbYl0mJih0aGlzW2JdPWNbYl09YVtiXSk7cmV0dXJuIGN9LGNzczpmdW5jdGlvbihhKXt2YXIgYj10aGlzLnN0eWxlcyxjPXt9LGQ9dGhpcy5lbGVtZW50LGUsZixnPVwiXCI7ZT0hYjtpZihhJiZhLmNvbG9yKWEuZmlsbD1hLmNvbG9yO2lmKGIpZm9yKGYgaW4gYSlhW2ZdIT09YltmXSYmKGNbZl09YVtmXSxlPSEwKTtpZihlKXtlPXRoaXMudGV4dFdpZHRoPWEmJmEud2lkdGgmJmQubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PVxuXCJ0ZXh0XCImJksoYS53aWR0aCl8fHRoaXMudGV4dFdpZHRoO2ImJihhPUEoYixjKSk7dGhpcy5zdHlsZXM9YTtlJiYocWF8fCFqYSYmdGhpcy5yZW5kZXJlci5mb3JFeHBvcnQpJiZkZWxldGUgYS53aWR0aDtpZihLYSYmIWphKU4odGhpcy5lbGVtZW50LGEpO2Vsc2V7Yj1mdW5jdGlvbihhLGIpe3JldHVyblwiLVwiK2IudG9Mb3dlckNhc2UoKX07Zm9yKGYgaW4gYSlnKz1mLnJlcGxhY2UoLyhbQS1aXSkvZyxiKStcIjpcIithW2ZdK1wiO1wiO1goZCxcInN0eWxlXCIsZyl9ZSYmdGhpcy5hZGRlZCYmdGhpcy5yZW5kZXJlci5idWlsZFRleHQodGhpcyl9cmV0dXJuIHRoaXN9LG9uOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcyxkPWMuZWxlbWVudDtjYiYmYT09PVwiY2xpY2tcIj8oZC5vbnRvdWNoc3RhcnQ9ZnVuY3Rpb24oYSl7Yy50b3VjaEV2ZW50RmlyZWQ9YmEubm93KCk7YS5wcmV2ZW50RGVmYXVsdCgpO2IuY2FsbChkLGEpfSxkLm9uY2xpY2s9ZnVuY3Rpb24oYSl7KE5hLmluZGV4T2YoXCJBbmRyb2lkXCIpPT09XG4tMXx8YmEubm93KCktKGMudG91Y2hFdmVudEZpcmVkfHwwKT4xMTAwKSYmYi5jYWxsKGQsYSl9KTpkW1wib25cIithXT1iO3JldHVybiB0aGlzfSxzZXRSYWRpYWxSZWZlcmVuY2U6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5yZW5kZXJlci5ncmFkaWVudHNbdGhpcy5lbGVtZW50LmdyYWRpZW50XTt0aGlzLmVsZW1lbnQucmFkaWFsUmVmZXJlbmNlPWE7YiYmYi5yYWRBdHRyJiZiLmFuaW1hdGUodGhpcy5yZW5kZXJlci5nZXRSYWRpYWxBdHRyKGEsYi5yYWRBdHRyKSk7cmV0dXJuIHRoaXN9LHRyYW5zbGF0ZTpmdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmF0dHIoe3RyYW5zbGF0ZVg6YSx0cmFuc2xhdGVZOmJ9KX0saW52ZXJ0OmZ1bmN0aW9uKCl7dGhpcy5pbnZlcnRlZD0hMDt0aGlzLnVwZGF0ZVRyYW5zZm9ybSgpO3JldHVybiB0aGlzfSx1cGRhdGVUcmFuc2Zvcm06ZnVuY3Rpb24oKXt2YXIgYT10aGlzLnRyYW5zbGF0ZVh8fDAsYj10aGlzLnRyYW5zbGF0ZVl8fDAsYz10aGlzLnNjYWxlWCxcbmQ9dGhpcy5zY2FsZVksZT10aGlzLmludmVydGVkLGY9dGhpcy5yb3RhdGlvbixnPXRoaXMuZWxlbWVudDtlJiYoYSs9dGhpcy5hdHRyKFwid2lkdGhcIiksYis9dGhpcy5hdHRyKFwiaGVpZ2h0XCIpKTthPVtcInRyYW5zbGF0ZShcIithK1wiLFwiK2IrXCIpXCJdO2U/YS5wdXNoKFwicm90YXRlKDkwKSBzY2FsZSgtMSwxKVwiKTpmJiZhLnB1c2goXCJyb3RhdGUoXCIrZitcIiBcIisoZy5nZXRBdHRyaWJ1dGUoXCJ4XCIpfHwwKStcIiBcIisoZy5nZXRBdHRyaWJ1dGUoXCJ5XCIpfHwwKStcIilcIik7KHYoYyl8fHYoZCkpJiZhLnB1c2goXCJzY2FsZShcIitxKGMsMSkrXCIgXCIrcShkLDEpK1wiKVwiKTthLmxlbmd0aCYmZy5zZXRBdHRyaWJ1dGUoXCJ0cmFuc2Zvcm1cIixhLmpvaW4oXCIgXCIpKX0sdG9Gcm9udDpmdW5jdGlvbigpe3ZhciBhPXRoaXMuZWxlbWVudDthLnBhcmVudE5vZGUuYXBwZW5kQ2hpbGQoYSk7cmV0dXJuIHRoaXN9LGFsaWduOmZ1bmN0aW9uKGEsYixjKXt2YXIgZCxlLGYsZyxoPXt9O2U9dGhpcy5yZW5kZXJlcjtmPWUuYWxpZ25lZE9iamVjdHM7XG5pZihhKXtpZih0aGlzLmFsaWduT3B0aW9ucz1hLHRoaXMuYWxpZ25CeVRyYW5zbGF0ZT1iLCFjfHxDYShjKSl0aGlzLmFsaWduVG89ZD1jfHxcInJlbmRlcmVyXCIsemEoZix0aGlzKSxmLnB1c2godGhpcyksYz1udWxsfWVsc2UgYT10aGlzLmFsaWduT3B0aW9ucyxiPXRoaXMuYWxpZ25CeVRyYW5zbGF0ZSxkPXRoaXMuYWxpZ25UbztjPXEoYyxlW2RdLGUpO2Q9YS5hbGlnbjtlPWEudmVydGljYWxBbGlnbjtmPShjLnh8fDApKyhhLnh8fDApO2c9KGMueXx8MCkrKGEueXx8MCk7aWYoZD09PVwicmlnaHRcInx8ZD09PVwiY2VudGVyXCIpZis9KGMud2lkdGgtKGEud2lkdGh8fDApKS97cmlnaHQ6MSxjZW50ZXI6Mn1bZF07aFtiP1widHJhbnNsYXRlWFwiOlwieFwiXT15KGYpO2lmKGU9PT1cImJvdHRvbVwifHxlPT09XCJtaWRkbGVcIilnKz0oYy5oZWlnaHQtKGEuaGVpZ2h0fHwwKSkvKHtib3R0b206MSxtaWRkbGU6Mn1bZV18fDEpO2hbYj9cInRyYW5zbGF0ZVlcIjpcInlcIl09eShnKTt0aGlzW3RoaXMucGxhY2VkP1xuXCJhbmltYXRlXCI6XCJhdHRyXCJdKGgpO3RoaXMucGxhY2VkPSEwO3RoaXMuYWxpZ25BdHRyPWg7cmV0dXJuIHRoaXN9LGdldEJCb3g6ZnVuY3Rpb24oYSxiKXt2YXIgYyxkPXRoaXMucmVuZGVyZXIsZSxmLGcsaD10aGlzLmVsZW1lbnQsaT10aGlzLnN0eWxlcztlPXRoaXMudGV4dFN0cjt2YXIgaixrPWguc3R5bGUsbCxtPWQuY2FjaGUsbj1kLmNhY2hlS2V5cyxwO2Y9cShiLHRoaXMucm90YXRpb24pO2c9ZipwYTtlIT09dCYmKHA9W1wiXCIsZnx8MCxpJiZpLmZvbnRTaXplLGguc3R5bGUud2lkdGhdLmpvaW4oXCIsXCIpLHA9ZT09PVwiXCJ8fCRiLnRlc3QoZSk/XCJudW06XCIrZS50b1N0cmluZygpLmxlbmd0aCtwOmUrcCk7cCYmIWEmJihjPW1bcF0pO2lmKCFjKXtpZihoLm5hbWVzcGFjZVVSST09PVFhfHxkLmZvckV4cG9ydCl7dHJ5e2w9dGhpcy5mYWtlVFMmJmZ1bmN0aW9uKGEpe28oaC5xdWVyeVNlbGVjdG9yQWxsKFwiLmhpZ2hjaGFydHMtdGV4dC1zaGFkb3dcIiksZnVuY3Rpb24oYil7Yi5zdHlsZS5kaXNwbGF5PVxuYX0pfSxXYSYmay50ZXh0U2hhZG93PyhqPWsudGV4dFNoYWRvdyxrLnRleHRTaGFkb3c9XCJcIik6bCYmbChcIm5vbmVcIiksYz1oLmdldEJCb3g/QSh7fSxoLmdldEJCb3goKSk6e3dpZHRoOmgub2Zmc2V0V2lkdGgsaGVpZ2h0Omgub2Zmc2V0SGVpZ2h0fSxqP2sudGV4dFNoYWRvdz1qOmwmJmwoXCJcIil9Y2F0Y2gocil7fWlmKCFjfHxjLndpZHRoPDApYz17d2lkdGg6MCxoZWlnaHQ6MH19ZWxzZSBjPXRoaXMuaHRtbEdldEJCb3goKTtpZihkLmlzU1ZHKXtkPWMud2lkdGg7ZT1jLmhlaWdodDtpZihLYSYmaSYmaS5mb250U2l6ZT09PVwiMTFweFwiJiZlLnRvUHJlY2lzaW9uKDMpPT09XCIxNi45XCIpYy5oZWlnaHQ9ZT0xNDtpZihmKWMud2lkdGg9UyhlKmxhKGcpKStTKGQqY2EoZykpLGMuaGVpZ2h0PVMoZSpjYShnKSkrUyhkKmxhKGcpKX1pZihwKXtmb3IoO24ubGVuZ3RoPjI1MDspZGVsZXRlIG1bbi5zaGlmdCgpXTttW3BdfHxuLnB1c2gocCk7bVtwXT1jfX1yZXR1cm4gY30sc2hvdzpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5hdHRyKHt2aXNpYmlsaXR5OmE/XG5cImluaGVyaXRcIjpcInZpc2libGVcIn0pfSxoaWRlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYXR0cih7dmlzaWJpbGl0eTpcImhpZGRlblwifSl9LGZhZGVPdXQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztiLmFuaW1hdGUoe29wYWNpdHk6MH0se2R1cmF0aW9uOmF8fDE1MCxjb21wbGV0ZTpmdW5jdGlvbigpe2IuYXR0cih7eTotOTk5OX0pfX0pfSxhZGQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5yZW5kZXJlcixjPXRoaXMuZWxlbWVudCxkO2lmKGEpdGhpcy5wYXJlbnRHcm91cD1hO3RoaXMucGFyZW50SW52ZXJ0ZWQ9YSYmYS5pbnZlcnRlZDt0aGlzLnRleHRTdHIhPT12b2lkIDAmJmIuYnVpbGRUZXh0KHRoaXMpO3RoaXMuYWRkZWQ9ITA7aWYoIWF8fGEuaGFuZGxlWnx8dGhpcy56SW5kZXgpZD10aGlzLnpJbmRleFNldHRlcigpO2R8fChhP2EuZWxlbWVudDpiLmJveCkuYXBwZW5kQ2hpbGQoYyk7aWYodGhpcy5vbkFkZCl0aGlzLm9uQWRkKCk7cmV0dXJuIHRoaXN9LHNhZmVSZW1vdmVDaGlsZDpmdW5jdGlvbihhKXt2YXIgYj1cbmEucGFyZW50Tm9kZTtiJiZiLnJlbW92ZUNoaWxkKGEpfSxkZXN0cm95OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEuZWxlbWVudHx8e30sYz1hLnNoYWRvd3MsZD1hLnJlbmRlcmVyLmlzU1ZHJiZiLm5vZGVOYW1lPT09XCJTUEFOXCImJmEucGFyZW50R3JvdXAsZSxmO2Iub25jbGljaz1iLm9ubW91c2VvdXQ9Yi5vbm1vdXNlb3Zlcj1iLm9ubW91c2Vtb3ZlPWIucG9pbnQ9bnVsbDtTYShhKTtpZihhLmNsaXBQYXRoKWEuY2xpcFBhdGg9YS5jbGlwUGF0aC5kZXN0cm95KCk7aWYoYS5zdG9wcyl7Zm9yKGY9MDtmPGEuc3RvcHMubGVuZ3RoO2YrKylhLnN0b3BzW2ZdPWEuc3RvcHNbZl0uZGVzdHJveSgpO2Euc3RvcHM9bnVsbH1hLnNhZmVSZW1vdmVDaGlsZChiKTtmb3IoYyYmbyhjLGZ1bmN0aW9uKGIpe2Euc2FmZVJlbW92ZUNoaWxkKGIpfSk7ZCYmZC5kaXYmJmQuZGl2LmNoaWxkTm9kZXMubGVuZ3RoPT09MDspYj1kLnBhcmVudEdyb3VwLGEuc2FmZVJlbW92ZUNoaWxkKGQuZGl2KSxkZWxldGUgZC5kaXYsXG5kPWI7YS5hbGlnblRvJiZ6YShhLnJlbmRlcmVyLmFsaWduZWRPYmplY3RzLGEpO2ZvcihlIGluIGEpZGVsZXRlIGFbZV07cmV0dXJuIG51bGx9LHNoYWRvdzpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9W10sZSxmLGc9dGhpcy5lbGVtZW50LGgsaSxqLGs7aWYoYSl7aT1xKGEud2lkdGgsMyk7aj0oYS5vcGFjaXR5fHwwLjE1KS9pO2s9dGhpcy5wYXJlbnRJbnZlcnRlZD9cIigtMSwtMSlcIjpcIihcIitxKGEub2Zmc2V0WCwxKStcIiwgXCIrcShhLm9mZnNldFksMSkrXCIpXCI7Zm9yKGU9MTtlPD1pO2UrKyl7Zj1nLmNsb25lTm9kZSgwKTtoPWkqMisxLTIqZTtYKGYse2lzU2hhZG93OlwidHJ1ZVwiLHN0cm9rZTphLmNvbG9yfHxcImJsYWNrXCIsXCJzdHJva2Utb3BhY2l0eVwiOmoqZSxcInN0cm9rZS13aWR0aFwiOmgsdHJhbnNmb3JtOlwidHJhbnNsYXRlXCIrayxmaWxsOlwibm9uZVwifSk7aWYoYylYKGYsXCJoZWlnaHRcIix3KFgoZixcImhlaWdodFwiKS1oLDApKSxmLmN1dEhlaWdodD1oO2I/Yi5lbGVtZW50LmFwcGVuZENoaWxkKGYpOlxuZy5wYXJlbnROb2RlLmluc2VydEJlZm9yZShmLGcpO2QucHVzaChmKX10aGlzLnNoYWRvd3M9ZH1yZXR1cm4gdGhpc30seEdldHRlcjpmdW5jdGlvbihhKXt0aGlzLmVsZW1lbnQubm9kZU5hbWU9PT1cImNpcmNsZVwiJiYoYT17eDpcImN4XCIseTpcImN5XCJ9W2FdfHxhKTtyZXR1cm4gdGhpcy5fZGVmYXVsdEdldHRlcihhKX0sX2RlZmF1bHRHZXR0ZXI6ZnVuY3Rpb24oYSl7YT1xKHRoaXNbYV0sdGhpcy5lbGVtZW50P3RoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoYSk6bnVsbCwwKTsvXltcXC0wLTlcXC5dKyQvLnRlc3QoYSkmJihhPXBhcnNlRmxvYXQoYSkpO3JldHVybiBhfSxkU2V0dGVyOmZ1bmN0aW9uKGEsYixjKXthJiZhLmpvaW4mJihhPWEuam9pbihcIiBcIikpOy8oTmFOfCB7Mn18XiQpLy50ZXN0KGEpJiYoYT1cIk0gMCAwXCIpO2Muc2V0QXR0cmlidXRlKGIsYSk7dGhpc1tiXT1hfSxkYXNoc3R5bGVTZXR0ZXI6ZnVuY3Rpb24oYSl7dmFyIGIsYz10aGlzW1wic3Ryb2tlLXdpZHRoXCJdO2M9PT1cblwiaW5oZXJpdFwiJiYoYz0xKTtpZihhPWEmJmEudG9Mb3dlckNhc2UoKSl7YT1hLnJlcGxhY2UoXCJzaG9ydGRhc2hkb3Rkb3RcIixcIjMsMSwxLDEsMSwxLFwiKS5yZXBsYWNlKFwic2hvcnRkYXNoZG90XCIsXCIzLDEsMSwxXCIpLnJlcGxhY2UoXCJzaG9ydGRvdFwiLFwiMSwxLFwiKS5yZXBsYWNlKFwic2hvcnRkYXNoXCIsXCIzLDEsXCIpLnJlcGxhY2UoXCJsb25nZGFzaFwiLFwiOCwzLFwiKS5yZXBsYWNlKC9kb3QvZyxcIjEsMyxcIikucmVwbGFjZShcImRhc2hcIixcIjQsMyxcIikucmVwbGFjZSgvLCQvLFwiXCIpLnNwbGl0KFwiLFwiKTtmb3IoYj1hLmxlbmd0aDtiLS07KWFbYl09SyhhW2JdKSpjO2E9YS5qb2luKFwiLFwiKS5yZXBsYWNlKC9OYU4vZyxcIm5vbmVcIik7dGhpcy5lbGVtZW50LnNldEF0dHJpYnV0ZShcInN0cm9rZS1kYXNoYXJyYXlcIixhKX19LGFsaWduU2V0dGVyOmZ1bmN0aW9uKGEpe3RoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJ0ZXh0LWFuY2hvclwiLHtsZWZ0Olwic3RhcnRcIixjZW50ZXI6XCJtaWRkbGVcIixyaWdodDpcImVuZFwifVthXSl9LFxub3BhY2l0eVNldHRlcjpmdW5jdGlvbihhLGIsYyl7dGhpc1tiXT1hO2Muc2V0QXR0cmlidXRlKGIsYSl9LHRpdGxlU2V0dGVyOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuZWxlbWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcInRpdGxlXCIpWzBdO2J8fChiPUguY3JlYXRlRWxlbWVudE5TKFFhLFwidGl0bGVcIiksdGhpcy5lbGVtZW50LmFwcGVuZENoaWxkKGIpKTtiLmZpcnN0Q2hpbGQmJmIucmVtb3ZlQ2hpbGQoYi5maXJzdENoaWxkKTtiLmFwcGVuZENoaWxkKEguY3JlYXRlVGV4dE5vZGUoU3RyaW5nKHEoYSksXCJcIikucmVwbGFjZSgvPFtePl0qPi9nLFwiXCIpKSl9LHRleHRTZXR0ZXI6ZnVuY3Rpb24oYSl7aWYoYSE9PXRoaXMudGV4dFN0cilkZWxldGUgdGhpcy5iQm94LHRoaXMudGV4dFN0cj1hLHRoaXMuYWRkZWQmJnRoaXMucmVuZGVyZXIuYnVpbGRUZXh0KHRoaXMpfSxmaWxsU2V0dGVyOmZ1bmN0aW9uKGEsYixjKXt0eXBlb2YgYT09PVwic3RyaW5nXCI/Yy5zZXRBdHRyaWJ1dGUoYixhKTpcbmEmJnRoaXMuY29sb3JHcmFkaWVudChhLGIsYyl9LHZpc2liaWxpdHlTZXR0ZXI6ZnVuY3Rpb24oYSxiLGMpe2E9PT1cImluaGVyaXRcIj9jLnJlbW92ZUF0dHJpYnV0ZShiKTpjLnNldEF0dHJpYnV0ZShiLGEpfSx6SW5kZXhTZXR0ZXI6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLnJlbmRlcmVyLGQ9dGhpcy5wYXJlbnRHcm91cCxjPShkfHxjKS5lbGVtZW50fHxjLmJveCxlLGYsZz10aGlzLmVsZW1lbnQsaDtlPXRoaXMuYWRkZWQ7dmFyIGk7aWYodihhKSlnLnpJbmRleD1hLGE9K2EsdGhpc1tiXT09PWEmJihlPSExKSx0aGlzW2JdPWE7aWYoZSl7aWYoKGE9dGhpcy56SW5kZXgpJiZkKWQuaGFuZGxlWj0hMDtkPWMuY2hpbGROb2Rlcztmb3IoaT0wO2k8ZC5sZW5ndGgmJiFoO2krKylpZihlPWRbaV0sZj1lLnpJbmRleCxlIT09ZyYmKEsoZik+YXx8IXYoYSkmJnYoZikpKWMuaW5zZXJ0QmVmb3JlKGcsZSksaD0hMDtofHxjLmFwcGVuZENoaWxkKGcpfXJldHVybiBofSxfZGVmYXVsdFNldHRlcjpmdW5jdGlvbihhLFxuYixjKXtjLnNldEF0dHJpYnV0ZShiLGEpfX07Wi5wcm90b3R5cGUueUdldHRlcj1aLnByb3RvdHlwZS54R2V0dGVyO1oucHJvdG90eXBlLnRyYW5zbGF0ZVhTZXR0ZXI9Wi5wcm90b3R5cGUudHJhbnNsYXRlWVNldHRlcj1aLnByb3RvdHlwZS5yb3RhdGlvblNldHRlcj1aLnByb3RvdHlwZS52ZXJ0aWNhbEFsaWduU2V0dGVyPVoucHJvdG90eXBlLnNjYWxlWFNldHRlcj1aLnByb3RvdHlwZS5zY2FsZVlTZXR0ZXI9ZnVuY3Rpb24oYSxiKXt0aGlzW2JdPWE7dGhpcy5kb1RyYW5zZm9ybT0hMH07Wi5wcm90b3R5cGVbXCJzdHJva2Utd2lkdGhTZXR0ZXJcIl09Wi5wcm90b3R5cGUuc3Ryb2tlU2V0dGVyPWZ1bmN0aW9uKGEsYixjKXt0aGlzW2JdPWE7aWYodGhpcy5zdHJva2UmJnRoaXNbXCJzdHJva2Utd2lkdGhcIl0pdGhpcy5zdHJva2VXaWR0aD10aGlzW1wic3Ryb2tlLXdpZHRoXCJdLFoucHJvdG90eXBlLmZpbGxTZXR0ZXIuY2FsbCh0aGlzLHRoaXMuc3Ryb2tlLFwic3Ryb2tlXCIsYyksYy5zZXRBdHRyaWJ1dGUoXCJzdHJva2Utd2lkdGhcIixcbnRoaXNbXCJzdHJva2Utd2lkdGhcIl0pLHRoaXMuaGFzU3Ryb2tlPSEwO2Vsc2UgaWYoYj09PVwic3Ryb2tlLXdpZHRoXCImJmE9PT0wJiZ0aGlzLmhhc1N0cm9rZSljLnJlbW92ZUF0dHJpYnV0ZShcInN0cm9rZVwiKSx0aGlzLmhhc1N0cm9rZT0hMX07dmFyIHhhPWZ1bmN0aW9uKCl7dGhpcy5pbml0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX07eGEucHJvdG90eXBlPXtFbGVtZW50OlosaW5pdDpmdW5jdGlvbihhLGIsYyxkLGUsZil7dmFyIGcsZD10aGlzLmNyZWF0ZUVsZW1lbnQoXCJzdmdcIikuYXR0cih7dmVyc2lvbjpcIjEuMVwifSkuY3NzKHRoaXMuZ2V0U3R5bGUoZCkpO2c9ZC5lbGVtZW50O2EuYXBwZW5kQ2hpbGQoZyk7YS5pbm5lckhUTUwuaW5kZXhPZihcInhtbG5zXCIpPT09LTEmJlgoZyxcInhtbG5zXCIsUWEpO3RoaXMuaXNTVkc9ITA7dGhpcy5ib3g9Zzt0aGlzLmJveFdyYXBwZXI9ZDt0aGlzLmFsaWduZWRPYmplY3RzPVtdO3RoaXMudXJsPShXYXx8c2IpJiZILmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiYmFzZVwiKS5sZW5ndGg/XG5MLmxvY2F0aW9uLmhyZWYucmVwbGFjZSgvIy4qPyQvLFwiXCIpLnJlcGxhY2UoLyhbXFwoJ1xcKV0pL2csXCJcXFxcJDFcIikucmVwbGFjZSgvIC9nLFwiJTIwXCIpOlwiXCI7dGhpcy5jcmVhdGVFbGVtZW50KFwiZGVzY1wiKS5hZGQoKS5lbGVtZW50LmFwcGVuZENoaWxkKEguY3JlYXRlVGV4dE5vZGUoXCJDcmVhdGVkIHdpdGggSGlnaHN0b2NrIDQuMi41XCIpKTt0aGlzLmRlZnM9dGhpcy5jcmVhdGVFbGVtZW50KFwiZGVmc1wiKS5hZGQoKTt0aGlzLmFsbG93SFRNTD1mO3RoaXMuZm9yRXhwb3J0PWU7dGhpcy5ncmFkaWVudHM9e307dGhpcy5jYWNoZT17fTt0aGlzLmNhY2hlS2V5cz1bXTt0aGlzLmltZ0NvdW50PTA7dGhpcy5zZXRTaXplKGIsYywhMSk7dmFyIGg7aWYoV2EmJmEuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KXRoaXMuc3ViUGl4ZWxGaXg9Yj1mdW5jdGlvbigpe04oYSx7bGVmdDowLHRvcDowfSk7aD1hLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO04oYSx7bGVmdDpFYShoLmxlZnQpLWgubGVmdCtcInB4XCIsXG50b3A6RWEoaC50b3ApLWgudG9wK1wicHhcIn0pfSxiKCksRShMLFwicmVzaXplXCIsYil9LGdldFN0eWxlOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnN0eWxlPUEoe2ZvbnRGYW1pbHk6J1wiTHVjaWRhIEdyYW5kZVwiLCBcIkx1Y2lkYSBTYW5zIFVuaWNvZGVcIiwgQXJpYWwsIEhlbHZldGljYSwgc2Fucy1zZXJpZicsZm9udFNpemU6XCIxMnB4XCJ9LGEpfSxpc0hpZGRlbjpmdW5jdGlvbigpe3JldHVybiF0aGlzLmJveFdyYXBwZXIuZ2V0QkJveCgpLndpZHRofSxkZXN0cm95OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5kZWZzO3RoaXMuYm94PW51bGw7dGhpcy5ib3hXcmFwcGVyPXRoaXMuYm94V3JhcHBlci5kZXN0cm95KCk7UGEodGhpcy5ncmFkaWVudHN8fHt9KTt0aGlzLmdyYWRpZW50cz1udWxsO2lmKGEpdGhpcy5kZWZzPWEuZGVzdHJveSgpO3RoaXMuc3ViUGl4ZWxGaXgmJlQoTCxcInJlc2l6ZVwiLHRoaXMuc3ViUGl4ZWxGaXgpO3JldHVybiB0aGlzLmFsaWduZWRPYmplY3RzPW51bGx9LGNyZWF0ZUVsZW1lbnQ6ZnVuY3Rpb24oYSl7dmFyIGI9XG5uZXcgdGhpcy5FbGVtZW50O2IuaW5pdCh0aGlzLGEpO3JldHVybiBifSxkcmF3OmZ1bmN0aW9uKCl7fSxnZXRSYWRpYWxBdHRyOmZ1bmN0aW9uKGEsYil7cmV0dXJue2N4OmFbMF0tYVsyXS8yK2IuY3gqYVsyXSxjeTphWzFdLWFbMl0vMitiLmN5KmFbMl0scjpiLnIqYVsyXX19LGJ1aWxkVGV4dDpmdW5jdGlvbihhKXtmb3IodmFyIGI9YS5lbGVtZW50LGM9dGhpcyxkPWMuZm9yRXhwb3J0LGU9cShhLnRleHRTdHIsXCJcIikudG9TdHJpbmcoKSxmPWUuaW5kZXhPZihcIjxcIikhPT0tMSxnPWIuY2hpbGROb2RlcyxoLGksaixrPVgoYixcInhcIiksbD1hLnN0eWxlcyxtPWEudGV4dFdpZHRoLG49bCYmbC5saW5lSGVpZ2h0LHA9bCYmbC50ZXh0U2hhZG93LHI9bCYmbC50ZXh0T3ZlcmZsb3c9PT1cImVsbGlwc2lzXCIscz1nLmxlbmd0aCxGPW0mJiFhLmFkZGVkJiZ0aGlzLmJveCx1PWZ1bmN0aW9uKGEpe3JldHVybiBuP0sobik6Yy5mb250TWV0cmljcygvKHB4fGVtKSQvLnRlc3QoYSYmYS5zdHlsZS5mb250U2l6ZSk/XG5hLnN0eWxlLmZvbnRTaXplOmwmJmwuZm9udFNpemV8fGMuc3R5bGUuZm9udFNpemV8fDEyLGEpLmh9LHg9ZnVuY3Rpb24oYSl7cmV0dXJuIGEucmVwbGFjZSgvJmx0Oy9nLFwiPFwiKS5yZXBsYWNlKC8mZ3Q7L2csXCI+XCIpfTtzLS07KWIucmVtb3ZlQ2hpbGQoZ1tzXSk7IWYmJiFwJiYhciYmZS5pbmRleE9mKFwiIFwiKT09PS0xP2IuYXBwZW5kQ2hpbGQoSC5jcmVhdGVUZXh0Tm9kZSh4KGUpKSk6KGg9LzwuKnN0eWxlPVwiKFteXCJdKylcIi4qPi8saT0vPC4qaHJlZj1cIihodHRwW15cIl0rKVwiLio+LyxGJiZGLmFwcGVuZENoaWxkKGIpLGU9Zj9lLnJlcGxhY2UoLzwoYnxzdHJvbmcpPi9nLCc8c3BhbiBzdHlsZT1cImZvbnQtd2VpZ2h0OmJvbGRcIj4nKS5yZXBsYWNlKC88KGl8ZW0pPi9nLCc8c3BhbiBzdHlsZT1cImZvbnQtc3R5bGU6aXRhbGljXCI+JykucmVwbGFjZSgvPGEvZyxcIjxzcGFuXCIpLnJlcGxhY2UoLzxcXC8oYnxzdHJvbmd8aXxlbXxhKT4vZyxcIjwvc3Bhbj5cIikuc3BsaXQoLzxici4qPz4vZyk6XG5bZV0sZT1GYShlLGZ1bmN0aW9uKGEpe3JldHVybiBhIT09XCJcIn0pLG8oZSxmdW5jdGlvbihlLGYpe3ZhciBnLG49MCxlPWUucmVwbGFjZSgvXlxccyt8XFxzKyQvZyxcIlwiKS5yZXBsYWNlKC88c3Bhbi9nLFwifHx8PHNwYW5cIikucmVwbGFjZSgvPFxcL3NwYW4+L2csXCI8L3NwYW4+fHx8XCIpO2c9ZS5zcGxpdChcInx8fFwiKTtvKGcsZnVuY3Rpb24oZSl7aWYoZSE9PVwiXCJ8fGcubGVuZ3RoPT09MSl7dmFyIHA9e30scz1ILmNyZWF0ZUVsZW1lbnROUyhRYSxcInRzcGFuXCIpLEY7aC50ZXN0KGUpJiYoRj1lLm1hdGNoKGgpWzFdLnJlcGxhY2UoLyg7fCB8Xiljb2xvcihbIDpdKS8sXCIkMWZpbGwkMlwiKSxYKHMsXCJzdHlsZVwiLEYpKTtpLnRlc3QoZSkmJiFkJiYoWChzLFwib25jbGlja1wiLCdsb2NhdGlvbi5ocmVmPVwiJytlLm1hdGNoKGkpWzFdKydcIicpLE4ocyx7Y3Vyc29yOlwicG9pbnRlclwifSkpO2U9eChlLnJlcGxhY2UoLzwoLnxcXG4pKj8+L2csXCJcIil8fFwiIFwiKTtpZihlIT09XCIgXCIpe3MuYXBwZW5kQ2hpbGQoSC5jcmVhdGVUZXh0Tm9kZShlKSk7XG5pZihuKXAuZHg9MDtlbHNlIGlmKGYmJmshPT1udWxsKXAueD1rO1gocyxwKTtiLmFwcGVuZENoaWxkKHMpOyFuJiZmJiYoIWphJiZkJiZOKHMse2Rpc3BsYXk6XCJibG9ja1wifSksWChzLFwiZHlcIix1KHMpKSk7aWYobSl7Zm9yKHZhciBwPWUucmVwbGFjZSgvKFteXFxeXSktL2csXCIkMS0gXCIpLnNwbGl0KFwiIFwiKSxxPWcubGVuZ3RoPjF8fGZ8fHAubGVuZ3RoPjEmJmwud2hpdGVTcGFjZSE9PVwibm93cmFwXCIsbyxELHY9W10sdz11KHMpLHQ9MSx5PWEucm90YXRpb24sQT1lLEI9QS5sZW5ndGg7KHF8fHIpJiYocC5sZW5ndGh8fHYubGVuZ3RoKTspYS5yb3RhdGlvbj0wLG89YS5nZXRCQm94KCEwKSxEPW8ud2lkdGgsIWphJiZjLmZvckV4cG9ydCYmKEQ9Yy5tZWFzdXJlU3BhbldpZHRoKHMuZmlyc3RDaGlsZC5kYXRhLGEuc3R5bGVzKSksbz1EPm0saj09PXZvaWQgMCYmKGo9byksciYmaj8oQi89MixBPT09XCJcInx8IW8mJkI8MC41P3A9W106KEE9ZS5zdWJzdHJpbmcoMCxBLmxlbmd0aCsobz8tMTpcbjEpKkVhKEIpKSxwPVtBKyhtPjM/XCJcXHUyMDI2XCI6XCJcIildLHMucmVtb3ZlQ2hpbGQocy5maXJzdENoaWxkKSkpOiFvfHxwLmxlbmd0aD09PTE/KHA9dix2PVtdLHAubGVuZ3RoJiYodCsrLHM9SC5jcmVhdGVFbGVtZW50TlMoUWEsXCJ0c3BhblwiKSxYKHMse2R5OncseDprfSksRiYmWChzLFwic3R5bGVcIixGKSxiLmFwcGVuZENoaWxkKHMpKSxEPm0mJihtPUQpKToocy5yZW1vdmVDaGlsZChzLmZpcnN0Q2hpbGQpLHYudW5zaGlmdChwLnBvcCgpKSkscC5sZW5ndGgmJnMuYXBwZW5kQ2hpbGQoSC5jcmVhdGVUZXh0Tm9kZShwLmpvaW4oXCIgXCIpLnJlcGxhY2UoLy0gL2csXCItXCIpKSk7YS5yb3RhdGlvbj15fW4rK319fSl9KSxqJiZhLmF0dHIoXCJ0aXRsZVwiLGEudGV4dFN0ciksRiYmRi5yZW1vdmVDaGlsZChiKSxwJiZhLmFwcGx5VGV4dFNoYWRvdyYmYS5hcHBseVRleHRTaGFkb3cocCkpfSxnZXRDb250cmFzdDpmdW5jdGlvbihhKXthPXZhKGEpLnJnYmE7cmV0dXJuIGFbMF0rYVsxXSthWzJdPlxuMzg0P1wiIzAwMDAwMFwiOlwiI0ZGRkZGRlwifSxidXR0b246ZnVuY3Rpb24oYSxiLGMsZCxlLGYsZyxoLGkpe3ZhciBqPXRoaXMubGFiZWwoYSxiLGMsaSxudWxsLG51bGwsbnVsbCxudWxsLFwiYnV0dG9uXCIpLGs9MCxsLG0sbixwLHIscyxhPXt4MTowLHkxOjAseDI6MCx5MjoxfSxlPXooe1wic3Ryb2tlLXdpZHRoXCI6MSxzdHJva2U6XCIjQ0NDQ0NDXCIsZmlsbDp7bGluZWFyR3JhZGllbnQ6YSxzdG9wczpbWzAsXCIjRkVGRUZFXCJdLFsxLFwiI0Y2RjZGNlwiXV19LHI6MixwYWRkaW5nOjUsc3R5bGU6e2NvbG9yOlwiYmxhY2tcIn19LGUpO249ZS5zdHlsZTtkZWxldGUgZS5zdHlsZTtmPXooZSx7c3Ryb2tlOlwiIzY4QVwiLGZpbGw6e2xpbmVhckdyYWRpZW50OmEsc3RvcHM6W1swLFwiI0ZGRlwiXSxbMSxcIiNBQ0ZcIl1dfX0sZik7cD1mLnN0eWxlO2RlbGV0ZSBmLnN0eWxlO2c9eihlLHtzdHJva2U6XCIjNjhBXCIsZmlsbDp7bGluZWFyR3JhZGllbnQ6YSxzdG9wczpbWzAsXCIjOUJEXCJdLFsxLFwiI0NERlwiXV19fSxnKTtcbnI9Zy5zdHlsZTtkZWxldGUgZy5zdHlsZTtoPXooZSx7c3R5bGU6e2NvbG9yOlwiI0NDQ1wifX0saCk7cz1oLnN0eWxlO2RlbGV0ZSBoLnN0eWxlO0Uoai5lbGVtZW50LEthP1wibW91c2VvdmVyXCI6XCJtb3VzZWVudGVyXCIsZnVuY3Rpb24oKXtrIT09MyYmai5hdHRyKGYpLmNzcyhwKX0pO0Uoai5lbGVtZW50LEthP1wibW91c2VvdXRcIjpcIm1vdXNlbGVhdmVcIixmdW5jdGlvbigpe2shPT0zJiYobD1bZSxmLGddW2tdLG09W24scCxyXVtrXSxqLmF0dHIobCkuY3NzKG0pKX0pO2ouc2V0U3RhdGU9ZnVuY3Rpb24oYSl7KGouc3RhdGU9az1hKT9hPT09Mj9qLmF0dHIoZykuY3NzKHIpOmE9PT0zJiZqLmF0dHIoaCkuY3NzKHMpOmouYXR0cihlKS5jc3Mobil9O3JldHVybiBqLm9uKFwiY2xpY2tcIixmdW5jdGlvbihhKXtrIT09MyYmZC5jYWxsKGosYSl9KS5hdHRyKGUpLmNzcyhBKHtjdXJzb3I6XCJkZWZhdWx0XCJ9LG4pKX0sY3Jpc3BMaW5lOmZ1bmN0aW9uKGEsYil7YVsxXT09PWFbNF0mJihhWzFdPWFbNF09XG55KGFbMV0pLWIlMi8yKTthWzJdPT09YVs1XSYmKGFbMl09YVs1XT15KGFbMl0pK2IlMi8yKTtyZXR1cm4gYX0scGF0aDpmdW5jdGlvbihhKXt2YXIgYj17ZmlsbDpcIm5vbmVcIn07SmEoYSk/Yi5kPWE6ZWEoYSkmJkEoYixhKTtyZXR1cm4gdGhpcy5jcmVhdGVFbGVtZW50KFwicGF0aFwiKS5hdHRyKGIpfSxjaXJjbGU6ZnVuY3Rpb24oYSxiLGMpe2E9ZWEoYSk/YTp7eDphLHk6YixyOmN9O2I9dGhpcy5jcmVhdGVFbGVtZW50KFwiY2lyY2xlXCIpO2IueFNldHRlcj1iLnlTZXR0ZXI9ZnVuY3Rpb24oYSxiLGMpe2Muc2V0QXR0cmlidXRlKFwiY1wiK2IsYSl9O3JldHVybiBiLmF0dHIoYSl9LGFyYzpmdW5jdGlvbihhLGIsYyxkLGUsZil7aWYoZWEoYSkpYj1hLnksYz1hLnIsZD1hLmlubmVyUixlPWEuc3RhcnQsZj1hLmVuZCxhPWEueDthPXRoaXMuc3ltYm9sKFwiYXJjXCIsYXx8MCxifHwwLGN8fDAsY3x8MCx7aW5uZXJSOmR8fDAsc3RhcnQ6ZXx8MCxlbmQ6Znx8MH0pO2Eucj1jO3JldHVybiBhfSxyZWN0OmZ1bmN0aW9uKGEsXG5iLGMsZCxlLGYpe3ZhciBlPWVhKGEpP2EucjplLGc9dGhpcy5jcmVhdGVFbGVtZW50KFwicmVjdFwiKSxhPWVhKGEpP2E6YT09PXQ/e306e3g6YSx5OmIsd2lkdGg6dyhjLDApLGhlaWdodDp3KGQsMCl9O2lmKGYhPT10KWcuc3Ryb2tlV2lkdGg9ZixhPWcuY3Jpc3AoYSk7aWYoZSlhLnI9ZTtnLnJTZXR0ZXI9ZnVuY3Rpb24oYSxiLGMpe1goYyx7cng6YSxyeTphfSl9O3JldHVybiBnLmF0dHIoYSl9LHNldFNpemU6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXRoaXMuYWxpZ25lZE9iamVjdHMsZT1kLmxlbmd0aDt0aGlzLndpZHRoPWE7dGhpcy5oZWlnaHQ9Yjtmb3IodGhpcy5ib3hXcmFwcGVyW3EoYywhMCk/XCJhbmltYXRlXCI6XCJhdHRyXCJdKHt3aWR0aDphLGhlaWdodDpifSk7ZS0tOylkW2VdLmFsaWduKCl9LGc6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50KFwiZ1wiKTtyZXR1cm4gdihhKT9iLmF0dHIoe1wiY2xhc3NcIjpcImhpZ2hjaGFydHMtXCIrYX0pOmJ9LGltYWdlOmZ1bmN0aW9uKGEsXG5iLGMsZCxlKXt2YXIgZj17cHJlc2VydmVBc3BlY3RSYXRpbzpcIm5vbmVcIn07YXJndW1lbnRzLmxlbmd0aD4xJiZBKGYse3g6Yix5OmMsd2lkdGg6ZCxoZWlnaHQ6ZX0pO2Y9dGhpcy5jcmVhdGVFbGVtZW50KFwiaW1hZ2VcIikuYXR0cihmKTtmLmVsZW1lbnQuc2V0QXR0cmlidXRlTlM/Zi5lbGVtZW50LnNldEF0dHJpYnV0ZU5TKFwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGlua1wiLFwiaHJlZlwiLGEpOmYuZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJoYy1zdmctaHJlZlwiLGEpO3JldHVybiBmfSxzeW1ib2w6ZnVuY3Rpb24oYSxiLGMsZCxlLGYpe3ZhciBnPXRoaXMsaCxpPXRoaXMuc3ltYm9sc1thXSxpPWkmJmkoeShiKSx5KGMpLGQsZSxmKSxqPS9edXJsXFwoKC4qPylcXCkkLyxrLGw7aWYoaSloPXRoaXMucGF0aChpKSxBKGgse3N5bWJvbE5hbWU6YSx4OmIseTpjLHdpZHRoOmQsaGVpZ2h0OmV9KSxmJiZBKGgsZik7ZWxzZSBpZihqLnRlc3QoYSkpbD1mdW5jdGlvbihhLGIpe2EuZWxlbWVudCYmXG4oYS5hdHRyKHt3aWR0aDpiWzBdLGhlaWdodDpiWzFdfSksYS5hbGlnbkJ5VHJhbnNsYXRlfHxhLnRyYW5zbGF0ZSh5KChkLWJbMF0pLzIpLHkoKGUtYlsxXSkvMikpKX0saz1hLm1hdGNoKGopWzFdLGE9VmJba118fGYmJmYud2lkdGgmJmYuaGVpZ2h0JiZbZi53aWR0aCxmLmhlaWdodF0saD10aGlzLmltYWdlKGspLmF0dHIoe3g6Yix5OmN9KSxoLmlzSW1nPSEwLGE/bChoLGEpOihoLmF0dHIoe3dpZHRoOjAsaGVpZ2h0OjB9KSxmYShcImltZ1wiLHtvbmxvYWQ6ZnVuY3Rpb24oKXt0aGlzLndpZHRoPT09MCYmKE4odGhpcyx7cG9zaXRpb246XCJhYnNvbHV0ZVwiLHRvcDpcIi05OTllbVwifSksSC5ib2R5LmFwcGVuZENoaWxkKHRoaXMpKTtsKGgsVmJba109W3RoaXMud2lkdGgsdGhpcy5oZWlnaHRdKTt0aGlzLnBhcmVudE5vZGUmJnRoaXMucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzKTtnLmltZ0NvdW50LS07aWYoIWcuaW1nQ291bnQmJiRbZy5jaGFydEluZGV4XS5vbmxvYWQpJFtnLmNoYXJ0SW5kZXhdLm9ubG9hZCgpfSxcbnNyYzprfSksdGhpcy5pbWdDb3VudCsrKTtyZXR1cm4gaH0sc3ltYm9sczp7Y2lyY2xlOmZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPTAuMTY2KmM7cmV0dXJuW1wiTVwiLGErYy8yLGIsXCJDXCIsYStjK2UsYixhK2MrZSxiK2QsYStjLzIsYitkLFwiQ1wiLGEtZSxiK2QsYS1lLGIsYStjLzIsYixcIlpcIl19LHNxdWFyZTpmdW5jdGlvbihhLGIsYyxkKXtyZXR1cm5bXCJNXCIsYSxiLFwiTFwiLGErYyxiLGErYyxiK2QsYSxiK2QsXCJaXCJdfSx0cmlhbmdsZTpmdW5jdGlvbihhLGIsYyxkKXtyZXR1cm5bXCJNXCIsYStjLzIsYixcIkxcIixhK2MsYitkLGEsYitkLFwiWlwiXX0sXCJ0cmlhbmdsZS1kb3duXCI6ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuW1wiTVwiLGEsYixcIkxcIixhK2MsYixhK2MvMixiK2QsXCJaXCJdfSxkaWFtb25kOmZ1bmN0aW9uKGEsYixjLGQpe3JldHVybltcIk1cIixhK2MvMixiLFwiTFwiLGErYyxiK2QvMixhK2MvMixiK2QsYSxiK2QvMixcIlpcIl19LGFyYzpmdW5jdGlvbihhLGIsYyxkLGUpe3ZhciBmPWUuc3RhcnQsXG5jPWUucnx8Y3x8ZCxnPWUuZW5kLTAuMDAxLGQ9ZS5pbm5lclIsaD1lLm9wZW4saT1jYShmKSxqPWxhKGYpLGs9Y2EoZyksZz1sYShnKSxlPWUuZW5kLWY8QWE/MDoxO3JldHVybltcIk1cIixhK2MqaSxiK2MqaixcIkFcIixjLGMsMCxlLDEsYStjKmssYitjKmcsaD9cIk1cIjpcIkxcIixhK2QqayxiK2QqZyxcIkFcIixkLGQsMCxlLDAsYStkKmksYitkKmosaD9cIlwiOlwiWlwiXX0sY2FsbG91dDpmdW5jdGlvbihhLGIsYyxkLGUpe3ZhciBmPUcoZSYmZS5yfHwwLGMsZCksZz1mKzYsaD1lJiZlLmFuY2hvclgsZT1lJiZlLmFuY2hvclksaTtpPVtcIk1cIixhK2YsYixcIkxcIixhK2MtZixiLFwiQ1wiLGErYyxiLGErYyxiLGErYyxiK2YsXCJMXCIsYStjLGIrZC1mLFwiQ1wiLGErYyxiK2QsYStjLGIrZCxhK2MtZixiK2QsXCJMXCIsYStmLGIrZCxcIkNcIixhLGIrZCxhLGIrZCxhLGIrZC1mLFwiTFwiLGEsYitmLFwiQ1wiLGEsYixhLGIsYStmLGJdO2gmJmg+YyYmZT5iK2cmJmU8YitkLWc/aS5zcGxpY2UoMTMsMyxcIkxcIixhK2MsZS02LGErXG5jKzYsZSxhK2MsZSs2LGErYyxiK2QtZik6aCYmaDwwJiZlPmIrZyYmZTxiK2QtZz9pLnNwbGljZSgzMywzLFwiTFwiLGEsZSs2LGEtNixlLGEsZS02LGEsYitmKTplJiZlPmQmJmg+YStnJiZoPGErYy1nP2kuc3BsaWNlKDIzLDMsXCJMXCIsaCs2LGIrZCxoLGIrZCs2LGgtNixiK2QsYStmLGIrZCk6ZSYmZTwwJiZoPmErZyYmaDxhK2MtZyYmaS5zcGxpY2UoMywzLFwiTFwiLGgtNixiLGgsYi02LGgrNixiLGMtZixiKTtyZXR1cm4gaX19LGNsaXBSZWN0OmZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPVwiaGlnaGNoYXJ0cy1cIitJYisrLGY9dGhpcy5jcmVhdGVFbGVtZW50KFwiY2xpcFBhdGhcIikuYXR0cih7aWQ6ZX0pLmFkZCh0aGlzLmRlZnMpLGE9dGhpcy5yZWN0KGEsYixjLGQsMCkuYWRkKGYpO2EuaWQ9ZTthLmNsaXBQYXRoPWY7YS5jb3VudD0wO3JldHVybiBhfSx0ZXh0OmZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPXFhfHwhamEmJnRoaXMuZm9yRXhwb3J0LGY9e307aWYoZCYmKHRoaXMuYWxsb3dIVE1MfHxcbiF0aGlzLmZvckV4cG9ydCkpcmV0dXJuIHRoaXMuaHRtbChhLGIsYyk7Zi54PU1hdGgucm91bmQoYnx8MCk7aWYoYylmLnk9TWF0aC5yb3VuZChjKTtpZihhfHxhPT09MClmLnRleHQ9YTthPXRoaXMuY3JlYXRlRWxlbWVudChcInRleHRcIikuYXR0cihmKTtlJiZhLmNzcyh7cG9zaXRpb246XCJhYnNvbHV0ZVwifSk7aWYoIWQpYS54U2V0dGVyPWZ1bmN0aW9uKGEsYixjKXt2YXIgZD1jLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwidHNwYW5cIiksZSxmPWMuZ2V0QXR0cmlidXRlKGIpLG07Zm9yKG09MDttPGQubGVuZ3RoO20rKyllPWRbbV0sZS5nZXRBdHRyaWJ1dGUoYik9PT1mJiZlLnNldEF0dHJpYnV0ZShiLGEpO2Muc2V0QXR0cmlidXRlKGIsYSl9O3JldHVybiBhfSxmb250TWV0cmljczpmdW5jdGlvbihhLGIpe3ZhciBjLGQsYT1hfHx0aGlzLnN0eWxlLmZvbnRTaXplOyFhJiZiJiZMLmdldENvbXB1dGVkU3R5bGUmJihiPWIuZWxlbWVudHx8YixhPShjPUwuZ2V0Q29tcHV0ZWRTdHlsZShiLFxuXCJcIikpJiZjLmZvbnRTaXplKTthPS9weC8udGVzdChhKT9LKGEpOi9lbS8udGVzdChhKT9wYXJzZUZsb2F0KGEpKjEyOjEyO2M9YTwyND9hKzM6eShhKjEuMik7ZD15KGMqMC44KTtyZXR1cm57aDpjLGI6ZCxmOmF9fSxyb3RDb3JyOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD1hO2ImJmMmJihkPXcoZCpjYShiKnBhKSw0KSk7cmV0dXJue3g6LWEvMypsYShiKnBhKSx5OmR9fSxsYWJlbDpmdW5jdGlvbihhLGIsYyxkLGUsZixnLGgsaSl7dmFyIGo9dGhpcyxrPWouZyhpKSxsPWoudGV4dChcIlwiLDAsMCxnKS5hdHRyKHt6SW5kZXg6MX0pLG0sbixwPTAscj0zLHM9MCxGLHUscSxELFE9MCxoYT17fSx3LEIsS2IsRyxDO0tiPWZ1bmN0aW9uKCl7dmFyIGEsYjthPWwuZWxlbWVudC5zdHlsZTtuPShGPT09dm9pZCAwfHx1PT09dm9pZCAwfHxrLnN0eWxlcy50ZXh0QWxpZ24pJiZ2KGwudGV4dFN0cikmJmwuZ2V0QkJveCgpO2sud2lkdGg9KEZ8fG4ud2lkdGh8fDApKzIqcitzO2suaGVpZ2h0PSh1fHxcbm4uaGVpZ2h0fHwwKSsyKnI7dz1yK2ouZm9udE1ldHJpY3MoYSYmYS5mb250U2l6ZSxsKS5iO2lmKEIpe2lmKCFtKWE9USxiPShoPy13OjApK1Esay5ib3g9bT1kP2ouc3ltYm9sKGQsYSxiLGsud2lkdGgsay5oZWlnaHQsaGEpOmoucmVjdChhLGIsay53aWR0aCxrLmhlaWdodCwwLGhhW1wic3Ryb2tlLXdpZHRoXCJdKSxtLmlzSW1nfHxtLmF0dHIoXCJmaWxsXCIsXCJub25lXCIpLG0uYWRkKGspO20uaXNJbWd8fG0uYXR0cihBKHt3aWR0aDp5KGsud2lkdGgpLGhlaWdodDp5KGsuaGVpZ2h0KX0saGEpKTtoYT1udWxsfX07Rz1mdW5jdGlvbigpe3ZhciBhPWsuc3R5bGVzLGE9YSYmYS50ZXh0QWxpZ24sYj1zK3IsYztjPWg/MDp3O2lmKHYoRikmJm4mJihhPT09XCJjZW50ZXJcInx8YT09PVwicmlnaHRcIikpYis9e2NlbnRlcjowLjUscmlnaHQ6MX1bYV0qKEYtbi53aWR0aCk7aWYoYiE9PWwueHx8YyE9PWwueSlsLmF0dHIoXCJ4XCIsYiksYyE9PXQmJmwuYXR0cihcInlcIixjKTtsLng9YjtsLnk9Y307Qz1mdW5jdGlvbihhLFxuYil7bT9tLmF0dHIoYSxiKTpoYVthXT1ifTtrLm9uQWRkPWZ1bmN0aW9uKCl7bC5hZGQoayk7ay5hdHRyKHt0ZXh0OmF8fGE9PT0wP2E6XCJcIix4OmIseTpjfSk7bSYmdihlKSYmay5hdHRyKHthbmNob3JYOmUsYW5jaG9yWTpmfSl9O2sud2lkdGhTZXR0ZXI9ZnVuY3Rpb24oYSl7Rj1hfTtrLmhlaWdodFNldHRlcj1mdW5jdGlvbihhKXt1PWF9O2sucGFkZGluZ1NldHRlcj1mdW5jdGlvbihhKXtpZih2KGEpJiZhIT09cilyPWsucGFkZGluZz1hLEcoKX07ay5wYWRkaW5nTGVmdFNldHRlcj1mdW5jdGlvbihhKXt2KGEpJiZhIT09cyYmKHM9YSxHKCkpfTtrLmFsaWduU2V0dGVyPWZ1bmN0aW9uKGEpe2E9e2xlZnQ6MCxjZW50ZXI6MC41LHJpZ2h0OjF9W2FdO2EhPT1wJiYocD1hLG4mJmsuYXR0cih7eDpxfSkpfTtrLnRleHRTZXR0ZXI9ZnVuY3Rpb24oYSl7YSE9PXQmJmwudGV4dFNldHRlcihhKTtLYigpO0coKX07a1tcInN0cm9rZS13aWR0aFNldHRlclwiXT1mdW5jdGlvbihhLGIpe2EmJlxuKEI9ITApO1E9YSUyLzI7QyhiLGEpfTtrLnN0cm9rZVNldHRlcj1rLmZpbGxTZXR0ZXI9ay5yU2V0dGVyPWZ1bmN0aW9uKGEsYil7Yj09PVwiZmlsbFwiJiZhJiYoQj0hMCk7QyhiLGEpfTtrLmFuY2hvclhTZXR0ZXI9ZnVuY3Rpb24oYSxiKXtlPWE7QyhiLHkoYSktUS1xKX07ay5hbmNob3JZU2V0dGVyPWZ1bmN0aW9uKGEsYil7Zj1hO0MoYixhLUQpfTtrLnhTZXR0ZXI9ZnVuY3Rpb24oYSl7ay54PWE7cCYmKGEtPXAqKChGfHxuLndpZHRoKSsyKnIpKTtxPXkoYSk7ay5hdHRyKFwidHJhbnNsYXRlWFwiLHEpfTtrLnlTZXR0ZXI9ZnVuY3Rpb24oYSl7RD1rLnk9eShhKTtrLmF0dHIoXCJ0cmFuc2xhdGVZXCIsRCl9O3ZhciBIPWsuY3NzO3JldHVybiBBKGsse2NzczpmdW5jdGlvbihhKXtpZihhKXt2YXIgYj17fSxhPXooYSk7byhrLnRleHRQcm9wcyxmdW5jdGlvbihjKXthW2NdIT09dCYmKGJbY109YVtjXSxkZWxldGUgYVtjXSl9KTtsLmNzcyhiKX1yZXR1cm4gSC5jYWxsKGssYSl9LGdldEJCb3g6ZnVuY3Rpb24oKXtyZXR1cm57d2lkdGg6bi53aWR0aCtcbjIqcixoZWlnaHQ6bi5oZWlnaHQrMipyLHg6bi54LXIseTpuLnktcn19LHNoYWRvdzpmdW5jdGlvbihhKXttJiZtLnNoYWRvdyhhKTtyZXR1cm4ga30sZGVzdHJveTpmdW5jdGlvbigpe1Qoay5lbGVtZW50LFwibW91c2VlbnRlclwiKTtUKGsuZWxlbWVudCxcIm1vdXNlbGVhdmVcIik7bCYmKGw9bC5kZXN0cm95KCkpO20mJihtPW0uZGVzdHJveSgpKTtaLnByb3RvdHlwZS5kZXN0cm95LmNhbGwoayk7az1qPUtiPUc9Qz1udWxsfX0pfX07WGE9eGE7QShaLnByb3RvdHlwZSx7aHRtbENzczpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmVsZW1lbnQ7aWYoYj1hJiZiLnRhZ05hbWU9PT1cIlNQQU5cIiYmYS53aWR0aClkZWxldGUgYS53aWR0aCx0aGlzLnRleHRXaWR0aD1iLHRoaXMudXBkYXRlVHJhbnNmb3JtKCk7aWYoYSYmYS50ZXh0T3ZlcmZsb3c9PT1cImVsbGlwc2lzXCIpYS53aGl0ZVNwYWNlPVwibm93cmFwXCIsYS5vdmVyZmxvdz1cImhpZGRlblwiO3RoaXMuc3R5bGVzPUEodGhpcy5zdHlsZXMsYSk7Tih0aGlzLmVsZW1lbnQsXG5hKTtyZXR1cm4gdGhpc30saHRtbEdldEJCb3g6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmVsZW1lbnQ7aWYoYS5ub2RlTmFtZT09PVwidGV4dFwiKWEuc3R5bGUucG9zaXRpb249XCJhYnNvbHV0ZVwiO3JldHVybnt4OmEub2Zmc2V0TGVmdCx5OmEub2Zmc2V0VG9wLHdpZHRoOmEub2Zmc2V0V2lkdGgsaGVpZ2h0OmEub2Zmc2V0SGVpZ2h0fX0saHRtbFVwZGF0ZVRyYW5zZm9ybTpmdW5jdGlvbigpe2lmKHRoaXMuYWRkZWQpe3ZhciBhPXRoaXMucmVuZGVyZXIsYj10aGlzLmVsZW1lbnQsYz10aGlzLnRyYW5zbGF0ZVh8fDAsZD10aGlzLnRyYW5zbGF0ZVl8fDAsZT10aGlzLnh8fDAsZj10aGlzLnl8fDAsZz10aGlzLnRleHRBbGlnbnx8XCJsZWZ0XCIsaD17bGVmdDowLGNlbnRlcjowLjUscmlnaHQ6MX1bZ10saT10aGlzLnNoYWRvd3Msaj10aGlzLnN0eWxlcztOKGIse21hcmdpbkxlZnQ6YyxtYXJnaW5Ub3A6ZH0pO2kmJm8oaSxmdW5jdGlvbihhKXtOKGEse21hcmdpbkxlZnQ6YysxLG1hcmdpblRvcDpkK1xuMX0pfSk7dGhpcy5pbnZlcnRlZCYmbyhiLmNoaWxkTm9kZXMsZnVuY3Rpb24oYyl7YS5pbnZlcnRDaGlsZChjLGIpfSk7aWYoYi50YWdOYW1lPT09XCJTUEFOXCIpe3ZhciBpPXRoaXMucm90YXRpb24saz1LKHRoaXMudGV4dFdpZHRoKSxsPWomJmoud2hpdGVTcGFjZSxtPVtpLGcsYi5pbm5lckhUTUwsdGhpcy50ZXh0V2lkdGgsdGhpcy50ZXh0QWxpZ25dLmpvaW4oXCIsXCIpO2lmKG0hPT10aGlzLmNUVCl7aj1hLmZvbnRNZXRyaWNzKGIuc3R5bGUuZm9udFNpemUpLmI7dihpKSYmdGhpcy5zZXRTcGFuUm90YXRpb24oaSxoLGopO2lmKGIub2Zmc2V0V2lkdGg+ayYmL1sgXFwtXS8udGVzdChiLnRleHRDb250ZW50fHxiLmlubmVyVGV4dCkpTihiLHt3aWR0aDprK1wicHhcIixkaXNwbGF5OlwiYmxvY2tcIix3aGl0ZVNwYWNlOmx8fFwibm9ybWFsXCJ9KSx0aGlzLmhhc1RleHRXaWR0aD0hMDtlbHNlIGlmKHRoaXMuaGFzVGV4dFdpZHRoKU4oYix7d2lkdGg6XCJcIixkaXNwbGF5OlwiXCIsd2hpdGVTcGFjZTpsfHxcblwibm93cmFwXCJ9KSx0aGlzLmhhc1RleHRXaWR0aD0hMTt0aGlzLmdldFNwYW5Db3JyZWN0aW9uKHRoaXMuaGFzVGV4dFdpZHRoP2s6Yi5vZmZzZXRXaWR0aCxqLGgsaSxnKX1OKGIse2xlZnQ6ZSsodGhpcy54Q29ycnx8MCkrXCJweFwiLHRvcDpmKyh0aGlzLnlDb3JyfHwwKStcInB4XCJ9KTtpZihzYilqPWIub2Zmc2V0SGVpZ2h0O3RoaXMuY1RUPW19fWVsc2UgdGhpcy5hbGlnbk9uQWRkPSEwfSxzZXRTcGFuUm90YXRpb246ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXt9LGU9S2E/XCItbXMtdHJhbnNmb3JtXCI6c2I/XCItd2Via2l0LXRyYW5zZm9ybVwiOldhP1wiTW96VHJhbnNmb3JtXCI6VWI/XCItby10cmFuc2Zvcm1cIjpcIlwiO2RbZV09ZC50cmFuc2Zvcm09XCJyb3RhdGUoXCIrYStcImRlZylcIjtkW2UrKFdhP1wiT3JpZ2luXCI6XCItb3JpZ2luXCIpXT1kLnRyYW5zZm9ybU9yaWdpbj1iKjEwMCtcIiUgXCIrYytcInB4XCI7Tih0aGlzLmVsZW1lbnQsZCl9LGdldFNwYW5Db3JyZWN0aW9uOmZ1bmN0aW9uKGEsYixjKXt0aGlzLnhDb3JyPVxuLWEqYzt0aGlzLnlDb3JyPS1ifX0pO0EoeGEucHJvdG90eXBlLHtodG1sOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD10aGlzLmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpLGU9ZC5lbGVtZW50LGY9ZC5yZW5kZXJlcixnPWYuaXNTVkcsaD1mdW5jdGlvbihhLGIpe28oW1wib3BhY2l0eVwiLFwidmlzaWJpbGl0eVwiXSxmdW5jdGlvbihjKXtVKGEsYytcIlNldHRlclwiLGZ1bmN0aW9uKGEsYyxkLGUpe2EuY2FsbCh0aGlzLGMsZCxlKTtiW2RdPWN9KX0pfTtkLnRleHRTZXR0ZXI9ZnVuY3Rpb24oYSl7YSE9PWUuaW5uZXJIVE1MJiZkZWxldGUgdGhpcy5iQm94O2UuaW5uZXJIVE1MPXRoaXMudGV4dFN0cj1hO2QuaHRtbFVwZGF0ZVRyYW5zZm9ybSgpfTtnJiZoKGQsZC5lbGVtZW50LnN0eWxlKTtkLnhTZXR0ZXI9ZC55U2V0dGVyPWQuYWxpZ25TZXR0ZXI9ZC5yb3RhdGlvblNldHRlcj1mdW5jdGlvbihhLGIpe2I9PT1cImFsaWduXCImJihiPVwidGV4dEFsaWduXCIpO2RbYl09YTtkLmh0bWxVcGRhdGVUcmFuc2Zvcm0oKX07XG5kLmF0dHIoe3RleHQ6YSx4OnkoYikseTp5KGMpfSkuY3NzKHtwb3NpdGlvbjpcImFic29sdXRlXCIsZm9udEZhbWlseTp0aGlzLnN0eWxlLmZvbnRGYW1pbHksZm9udFNpemU6dGhpcy5zdHlsZS5mb250U2l6ZX0pO2Uuc3R5bGUud2hpdGVTcGFjZT1cIm5vd3JhcFwiO2QuY3NzPWQuaHRtbENzcztpZihnKWQuYWRkPWZ1bmN0aW9uKGEpe3ZhciBiLGM9Zi5ib3gucGFyZW50Tm9kZSxnPVtdO2lmKHRoaXMucGFyZW50R3JvdXA9YSl7aWYoYj1hLmRpdiwhYil7Zm9yKDthOylnLnB1c2goYSksYT1hLnBhcmVudEdyb3VwO28oZy5yZXZlcnNlKCksZnVuY3Rpb24oYSl7dmFyIGQsZT1YKGEuZWxlbWVudCxcImNsYXNzXCIpO2UmJihlPXtjbGFzc05hbWU6ZX0pO2I9YS5kaXY9YS5kaXZ8fGZhKFZhLGUse3Bvc2l0aW9uOlwiYWJzb2x1dGVcIixsZWZ0OihhLnRyYW5zbGF0ZVh8fDApK1wicHhcIix0b3A6KGEudHJhbnNsYXRlWXx8MCkrXCJweFwiLG9wYWNpdHk6YS5vcGFjaXR5fSxifHxjKTtkPWIuc3R5bGU7QShhLFxue3RyYW5zbGF0ZVhTZXR0ZXI6ZnVuY3Rpb24oYixjKXtkLmxlZnQ9YitcInB4XCI7YVtjXT1iO2EuZG9UcmFuc2Zvcm09ITB9LHRyYW5zbGF0ZVlTZXR0ZXI6ZnVuY3Rpb24oYixjKXtkLnRvcD1iK1wicHhcIjthW2NdPWI7YS5kb1RyYW5zZm9ybT0hMH19KTtoKGEsZCl9KX19ZWxzZSBiPWM7Yi5hcHBlbmRDaGlsZChlKTtkLmFkZGVkPSEwO2QuYWxpZ25PbkFkZCYmZC5odG1sVXBkYXRlVHJhbnNmb3JtKCk7cmV0dXJuIGR9O3JldHVybiBkfX0pO3ZhciBsYixhYTtpZighamEmJiFxYSlhYT17aW5pdDpmdW5jdGlvbihhLGIpe3ZhciBjPVtcIjxcIixiLCcgZmlsbGVkPVwiZlwiIHN0cm9rZWQ9XCJmXCInXSxkPVtcInBvc2l0aW9uOiBcIixcImFic29sdXRlXCIsXCI7XCJdLGU9Yj09PVZhOyhiPT09XCJzaGFwZVwifHxlKSYmZC5wdXNoKFwibGVmdDowO3RvcDowO3dpZHRoOjFweDtoZWlnaHQ6MXB4O1wiKTtkLnB1c2goXCJ2aXNpYmlsaXR5OiBcIixlP1wiaGlkZGVuXCI6XCJ2aXNpYmxlXCIpO2MucHVzaCgnIHN0eWxlPVwiJyxkLmpvaW4oXCJcIiksXG4nXCIvPicpO2lmKGIpYz1lfHxiPT09XCJzcGFuXCJ8fGI9PT1cImltZ1wiP2Muam9pbihcIlwiKTphLnByZXBWTUwoYyksdGhpcy5lbGVtZW50PWZhKGMpO3RoaXMucmVuZGVyZXI9YX0sYWRkOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMucmVuZGVyZXIsYz10aGlzLmVsZW1lbnQsZD1iLmJveCxlPWEmJmEuaW52ZXJ0ZWQsZD1hP2EuZWxlbWVudHx8YTpkO2lmKGEpdGhpcy5wYXJlbnRHcm91cD1hO2UmJmIuaW52ZXJ0Q2hpbGQoYyxkKTtkLmFwcGVuZENoaWxkKGMpO3RoaXMuYWRkZWQ9ITA7dGhpcy5hbGlnbk9uQWRkJiYhdGhpcy5kZWZlclVwZGF0ZVRyYW5zZm9ybSYmdGhpcy51cGRhdGVUcmFuc2Zvcm0oKTtpZih0aGlzLm9uQWRkKXRoaXMub25BZGQoKTtyZXR1cm4gdGhpc30sdXBkYXRlVHJhbnNmb3JtOloucHJvdG90eXBlLmh0bWxVcGRhdGVUcmFuc2Zvcm0sc2V0U3BhblJvdGF0aW9uOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5yb3RhdGlvbixiPWNhKGEqcGEpLGM9bGEoYSpwYSk7Tih0aGlzLmVsZW1lbnQsXG57ZmlsdGVyOmE/W1wicHJvZ2lkOkRYSW1hZ2VUcmFuc2Zvcm0uTWljcm9zb2Z0Lk1hdHJpeChNMTE9XCIsYixcIiwgTTEyPVwiLC1jLFwiLCBNMjE9XCIsYyxcIiwgTTIyPVwiLGIsXCIsIHNpemluZ01ldGhvZD0nYXV0byBleHBhbmQnKVwiXS5qb2luKFwiXCIpOlwibm9uZVwifSl9LGdldFNwYW5Db3JyZWN0aW9uOmZ1bmN0aW9uKGEsYixjLGQsZSl7dmFyIGY9ZD9jYShkKnBhKToxLGc9ZD9sYShkKnBhKTowLGg9cSh0aGlzLmVsZW1IZWlnaHQsdGhpcy5lbGVtZW50Lm9mZnNldEhlaWdodCksaTt0aGlzLnhDb3JyPWY8MCYmLWE7dGhpcy55Q29ycj1nPDAmJi1oO2k9ZipnPDA7dGhpcy54Q29ycis9ZypiKihpPzEtYzpjKTt0aGlzLnlDb3JyLT1mKmIqKGQ/aT9jOjEtYzoxKTtlJiZlIT09XCJsZWZ0XCImJih0aGlzLnhDb3JyLT1hKmMqKGY8MD8tMToxKSxkJiYodGhpcy55Q29yci09aCpjKihnPDA/LTE6MSkpLE4odGhpcy5lbGVtZW50LHt0ZXh0QWxpZ246ZX0pKX0scGF0aFRvVk1MOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1cbmEubGVuZ3RoLGM9W107Yi0tOylpZihDKGFbYl0pKWNbYl09eShhW2JdKjEwKS01O2Vsc2UgaWYoYVtiXT09PVwiWlwiKWNbYl09XCJ4XCI7ZWxzZSBpZihjW2JdPWFbYl0sYS5pc0FyYyYmKGFbYl09PT1cIndhXCJ8fGFbYl09PT1cImF0XCIpKWNbYis1XT09PWNbYis3XSYmKGNbYis3XSs9YVtiKzddPmFbYis1XT8xOi0xKSxjW2IrNl09PT1jW2IrOF0mJihjW2IrOF0rPWFbYis4XT5hW2IrNl0/MTotMSk7cmV0dXJuIGMuam9pbihcIiBcIil8fFwieFwifSxjbGlwOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMsYzthPyhjPWEubWVtYmVycyx6YShjLGIpLGMucHVzaChiKSxiLmRlc3Ryb3lDbGlwPWZ1bmN0aW9uKCl7emEoYyxiKX0sYT1hLmdldENTUyhiKSk6KGIuZGVzdHJveUNsaXAmJmIuZGVzdHJveUNsaXAoKSxhPXtjbGlwOnJiP1wiaW5oZXJpdFwiOlwicmVjdChhdXRvKVwifSk7cmV0dXJuIGIuY3NzKGEpfSxjc3M6Wi5wcm90b3R5cGUuaHRtbENzcyxzYWZlUmVtb3ZlQ2hpbGQ6ZnVuY3Rpb24oYSl7YS5wYXJlbnROb2RlJiZcblVhKGEpfSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5kZXN0cm95Q2xpcCYmdGhpcy5kZXN0cm95Q2xpcCgpO3JldHVybiBaLnByb3RvdHlwZS5kZXN0cm95LmFwcGx5KHRoaXMpfSxvbjpmdW5jdGlvbihhLGIpe3RoaXMuZWxlbWVudFtcIm9uXCIrYV09ZnVuY3Rpb24oKXt2YXIgYT1MLmV2ZW50O2EudGFyZ2V0PWEuc3JjRWxlbWVudDtiKGEpfTtyZXR1cm4gdGhpc30sY3V0T2ZmUGF0aDpmdW5jdGlvbihhLGIpe3ZhciBjLGE9YS5zcGxpdCgvWyAsXS8pO2M9YS5sZW5ndGg7aWYoYz09PTl8fGM9PT0xMSlhW2MtNF09YVtjLTJdPUsoYVtjLTJdKS0xMCpiO3JldHVybiBhLmpvaW4oXCIgXCIpfSxzaGFkb3c6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPVtdLGUsZj10aGlzLmVsZW1lbnQsZz10aGlzLnJlbmRlcmVyLGgsaT1mLnN0eWxlLGosaz1mLnBhdGgsbCxtLG4scDtrJiZ0eXBlb2Ygay52YWx1ZSE9PVwic3RyaW5nXCImJihrPVwieFwiKTttPWs7aWYoYSl7bj1xKGEud2lkdGgsMyk7cD0oYS5vcGFjaXR5fHxcbjAuMTUpL247Zm9yKGU9MTtlPD0zO2UrKyl7bD1uKjIrMS0yKmU7YyYmKG09dGhpcy5jdXRPZmZQYXRoKGsudmFsdWUsbCswLjUpKTtqPVsnPHNoYXBlIGlzU2hhZG93PVwidHJ1ZVwiIHN0cm9rZXdlaWdodD1cIicsbCwnXCIgZmlsbGVkPVwiZmFsc2VcIiBwYXRoPVwiJyxtLCdcIiBjb29yZHNpemU9XCIxMCAxMFwiIHN0eWxlPVwiJyxmLnN0eWxlLmNzc1RleHQsJ1wiIC8+J107aD1mYShnLnByZXBWTUwoaiksbnVsbCx7bGVmdDpLKGkubGVmdCkrcShhLm9mZnNldFgsMSksdG9wOksoaS50b3ApK3EoYS5vZmZzZXRZLDEpfSk7aWYoYyloLmN1dE9mZj1sKzE7aj1bJzxzdHJva2UgY29sb3I9XCInLGEuY29sb3J8fFwiYmxhY2tcIiwnXCIgb3BhY2l0eT1cIicscCplLCdcIi8+J107ZmEoZy5wcmVwVk1MKGopLG51bGwsbnVsbCxoKTtiP2IuZWxlbWVudC5hcHBlbmRDaGlsZChoKTpmLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGgsZik7ZC5wdXNoKGgpfXRoaXMuc2hhZG93cz1kfXJldHVybiB0aGlzfSx1cGRhdGVTaGFkb3dzOnJhLFxuc2V0QXR0cjpmdW5jdGlvbihhLGIpe3JiP3RoaXMuZWxlbWVudFthXT1iOnRoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGUoYSxiKX0sY2xhc3NTZXR0ZXI6ZnVuY3Rpb24oYSl7dGhpcy5lbGVtZW50LmNsYXNzTmFtZT1hfSxkYXNoc3R5bGVTZXR0ZXI6ZnVuY3Rpb24oYSxiLGMpeyhjLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwic3Ryb2tlXCIpWzBdfHxmYSh0aGlzLnJlbmRlcmVyLnByZXBWTUwoW1wiPHN0cm9rZS8+XCJdKSxudWxsLG51bGwsYykpW2JdPWF8fFwic29saWRcIjt0aGlzW2JdPWF9LGRTZXR0ZXI6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXRoaXMuc2hhZG93cyxhPWF8fFtdO3RoaXMuZD1hLmpvaW4mJmEuam9pbihcIiBcIik7Yy5wYXRoPWE9dGhpcy5wYXRoVG9WTUwoYSk7aWYoZClmb3IoYz1kLmxlbmd0aDtjLS07KWRbY10ucGF0aD1kW2NdLmN1dE9mZj90aGlzLmN1dE9mZlBhdGgoYSxkW2NdLmN1dE9mZik6YTt0aGlzLnNldEF0dHIoYixhKX0sZmlsbFNldHRlcjpmdW5jdGlvbihhLGIsXG5jKXt2YXIgZD1jLm5vZGVOYW1lO2lmKGQ9PT1cIlNQQU5cIiljLnN0eWxlLmNvbG9yPWE7ZWxzZSBpZihkIT09XCJJTUdcIiljLmZpbGxlZD1hIT09XCJub25lXCIsdGhpcy5zZXRBdHRyKFwiZmlsbGNvbG9yXCIsdGhpcy5yZW5kZXJlci5jb2xvcihhLGMsYix0aGlzKSl9LFwiZmlsbC1vcGFjaXR5U2V0dGVyXCI6ZnVuY3Rpb24oYSxiLGMpe2ZhKHRoaXMucmVuZGVyZXIucHJlcFZNTChbXCI8XCIsYi5zcGxpdChcIi1cIilbMF0sJyBvcGFjaXR5PVwiJyxhLCdcIi8+J10pLG51bGwsbnVsbCxjKX0sb3BhY2l0eVNldHRlcjpyYSxyb3RhdGlvblNldHRlcjpmdW5jdGlvbihhLGIsYyl7Yz1jLnN0eWxlO3RoaXNbYl09Y1tiXT1hO2MubGVmdD0teShsYShhKnBhKSsxKStcInB4XCI7Yy50b3A9eShjYShhKnBhKSkrXCJweFwifSxzdHJva2VTZXR0ZXI6ZnVuY3Rpb24oYSxiLGMpe3RoaXMuc2V0QXR0cihcInN0cm9rZWNvbG9yXCIsdGhpcy5yZW5kZXJlci5jb2xvcihhLGMsYix0aGlzKSl9LFwic3Ryb2tlLXdpZHRoU2V0dGVyXCI6ZnVuY3Rpb24oYSxcbmIsYyl7Yy5zdHJva2VkPSEhYTt0aGlzW2JdPWE7QyhhKSYmKGErPVwicHhcIik7dGhpcy5zZXRBdHRyKFwic3Ryb2tld2VpZ2h0XCIsYSl9LHRpdGxlU2V0dGVyOmZ1bmN0aW9uKGEsYil7dGhpcy5zZXRBdHRyKGIsYSl9LHZpc2liaWxpdHlTZXR0ZXI6ZnVuY3Rpb24oYSxiLGMpe2E9PT1cImluaGVyaXRcIiYmKGE9XCJ2aXNpYmxlXCIpO3RoaXMuc2hhZG93cyYmbyh0aGlzLnNoYWRvd3MsZnVuY3Rpb24oYyl7Yy5zdHlsZVtiXT1hfSk7Yy5ub2RlTmFtZT09PVwiRElWXCImJihhPWE9PT1cImhpZGRlblwiP1wiLTk5OWVtXCI6MCxyYnx8KGMuc3R5bGVbYl09YT9cInZpc2libGVcIjpcImhpZGRlblwiKSxiPVwidG9wXCIpO2Muc3R5bGVbYl09YX0seFNldHRlcjpmdW5jdGlvbihhLGIsYyl7dGhpc1tiXT1hO2I9PT1cInhcIj9iPVwibGVmdFwiOmI9PT1cInlcIiYmKGI9XCJ0b3BcIik7dGhpcy51cGRhdGVDbGlwcGluZz8odGhpc1tiXT1hLHRoaXMudXBkYXRlQ2xpcHBpbmcoKSk6Yy5zdHlsZVtiXT1hfSx6SW5kZXhTZXR0ZXI6ZnVuY3Rpb24oYSxcbmIsYyl7Yy5zdHlsZVtiXT1hfX0sYWFbXCJzdHJva2Utb3BhY2l0eVNldHRlclwiXT1hYVtcImZpbGwtb3BhY2l0eVNldHRlclwiXSxCLlZNTEVsZW1lbnQ9YWE9bWEoWixhYSksYWEucHJvdG90eXBlLnlTZXR0ZXI9YWEucHJvdG90eXBlLndpZHRoU2V0dGVyPWFhLnByb3RvdHlwZS5oZWlnaHRTZXR0ZXI9YWEucHJvdG90eXBlLnhTZXR0ZXIsYWE9e0VsZW1lbnQ6YWEsaXNJRTg6TmEuaW5kZXhPZihcIk1TSUUgOC4wXCIpPi0xLGluaXQ6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU7dGhpcy5hbGlnbmVkT2JqZWN0cz1bXTtkPXRoaXMuY3JlYXRlRWxlbWVudChWYSkuY3NzKEEodGhpcy5nZXRTdHlsZShkKSx7cG9zaXRpb246XCJyZWxhdGl2ZVwifSkpO2U9ZC5lbGVtZW50O2EuYXBwZW5kQ2hpbGQoZC5lbGVtZW50KTt0aGlzLmlzVk1MPSEwO3RoaXMuYm94PWU7dGhpcy5ib3hXcmFwcGVyPWQ7dGhpcy5ncmFkaWVudHM9e307dGhpcy5jYWNoZT17fTt0aGlzLmNhY2hlS2V5cz1bXTt0aGlzLmltZ0NvdW50PVxuMDt0aGlzLnNldFNpemUoYixjLCExKTtpZighSC5uYW1lc3BhY2VzLmhjdil7SC5uYW1lc3BhY2VzLmFkZChcImhjdlwiLFwidXJuOnNjaGVtYXMtbWljcm9zb2Z0LWNvbTp2bWxcIik7dHJ5e0guY3JlYXRlU3R5bGVTaGVldCgpLmNzc1RleHQ9XCJoY3ZcXFxcOmZpbGwsIGhjdlxcXFw6cGF0aCwgaGN2XFxcXDpzaGFwZSwgaGN2XFxcXDpzdHJva2V7IGJlaGF2aW9yOnVybCgjZGVmYXVsdCNWTUwpOyBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IH0gXCJ9Y2F0Y2goZil7SC5zdHlsZVNoZWV0c1swXS5jc3NUZXh0Kz1cImhjdlxcXFw6ZmlsbCwgaGN2XFxcXDpwYXRoLCBoY3ZcXFxcOnNoYXBlLCBoY3ZcXFxcOnN0cm9rZXsgYmVoYXZpb3I6dXJsKCNkZWZhdWx0I1ZNTCk7IGRpc3BsYXk6IGlubGluZS1ibG9jazsgfSBcIn19fSxpc0hpZGRlbjpmdW5jdGlvbigpe3JldHVybiF0aGlzLmJveC5vZmZzZXRXaWR0aH0sY2xpcFJlY3Q6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9dGhpcy5jcmVhdGVFbGVtZW50KCksZj1lYShhKTtyZXR1cm4gQShlLFxue21lbWJlcnM6W10sY291bnQ6MCxsZWZ0OihmP2EueDphKSsxLHRvcDooZj9hLnk6YikrMSx3aWR0aDooZj9hLndpZHRoOmMpLTEsaGVpZ2h0OihmP2EuaGVpZ2h0OmQpLTEsZ2V0Q1NTOmZ1bmN0aW9uKGEpe3ZhciBiPWEuZWxlbWVudCxjPWIubm9kZU5hbWUsYT1hLmludmVydGVkLGQ9dGhpcy50b3AtKGM9PT1cInNoYXBlXCI/Yi5vZmZzZXRUb3A6MCksZT10aGlzLmxlZnQsYj1lK3RoaXMud2lkdGgsZj1kK3RoaXMuaGVpZ2h0LGQ9e2NsaXA6XCJyZWN0KFwiK3koYT9lOmQpK1wicHgsXCIreShhP2Y6YikrXCJweCxcIit5KGE/YjpmKStcInB4LFwiK3koYT9kOmUpK1wicHgpXCJ9OyFhJiZyYiYmYz09PVwiRElWXCImJkEoZCx7d2lkdGg6YitcInB4XCIsaGVpZ2h0OmYrXCJweFwifSk7cmV0dXJuIGR9LHVwZGF0ZUNsaXBwaW5nOmZ1bmN0aW9uKCl7byhlLm1lbWJlcnMsZnVuY3Rpb24oYSl7YS5lbGVtZW50JiZhLmNzcyhlLmdldENTUyhhKSl9KX19KX0sY29sb3I6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9dGhpcyxcbmYsZz0vXnJnYmEvLGgsaSxqPVwibm9uZVwiO2EmJmEubGluZWFyR3JhZGllbnQ/aT1cImdyYWRpZW50XCI6YSYmYS5yYWRpYWxHcmFkaWVudCYmKGk9XCJwYXR0ZXJuXCIpO2lmKGkpe3ZhciBrLGwsbT1hLmxpbmVhckdyYWRpZW50fHxhLnJhZGlhbEdyYWRpZW50LG4scCxyLHMscSx1PVwiXCIsYT1hLnN0b3BzLHgsRD1bXSxRPWZ1bmN0aW9uKCl7aD1bJzxmaWxsIGNvbG9ycz1cIicrRC5qb2luKFwiLFwiKSsnXCIgb3BhY2l0eT1cIicsciwnXCIgbzpvcGFjaXR5Mj1cIicscCwnXCIgdHlwZT1cIicsaSwnXCIgJyx1LCdmb2N1cz1cIjEwMCVcIiBtZXRob2Q9XCJhbnlcIiAvPiddO2ZhKGUucHJlcFZNTChoKSxudWxsLG51bGwsYil9O249YVswXTt4PWFbYS5sZW5ndGgtMV07blswXT4wJiZhLnVuc2hpZnQoWzAsblsxXV0pO3hbMF08MSYmYS5wdXNoKFsxLHhbMV1dKTtvKGEsZnVuY3Rpb24oYSxiKXtnLnRlc3QoYVsxXSk/KGY9dmEoYVsxXSksaz1mLmdldChcInJnYlwiKSxsPWYuZ2V0KFwiYVwiKSk6KGs9YVsxXSxsPTEpO0QucHVzaChhWzBdKlxuMTAwK1wiJSBcIitrKTtiPyhyPWwscz1rKToocD1sLHE9ayl9KTtpZihjPT09XCJmaWxsXCIpaWYoaT09PVwiZ3JhZGllbnRcIiljPW0ueDF8fG1bMF18fDAsYT1tLnkxfHxtWzFdfHwwLG49bS54Mnx8bVsyXXx8MCxtPW0ueTJ8fG1bM118fDAsdT0nYW5nbGU9XCInKyg5MC1ZLmF0YW4oKG0tYSkvKG4tYykpKjE4MC9BYSkrJ1wiJyxRKCk7ZWxzZXt2YXIgaj1tLnIsaGE9aioyLHY9aioyLHc9bS5jeCx0PW0uY3kseT1iLnJhZGlhbFJlZmVyZW5jZSxBLGo9ZnVuY3Rpb24oKXt5JiYoQT1kLmdldEJCb3goKSx3Kz0oeVswXS1BLngpL0Eud2lkdGgtMC41LHQrPSh5WzFdLUEueSkvQS5oZWlnaHQtMC41LGhhKj15WzJdL0Eud2lkdGgsdio9eVsyXS9BLmhlaWdodCk7dT0nc3JjPVwiJytSLmdsb2JhbC5WTUxSYWRpYWxHcmFkaWVudFVSTCsnXCIgc2l6ZT1cIicraGErXCIsXCIrdisnXCIgb3JpZ2luPVwiMC41LDAuNVwiIHBvc2l0aW9uPVwiJyt3K1wiLFwiK3QrJ1wiIGNvbG9yMj1cIicrcSsnXCIgJztRKCl9O2QuYWRkZWQ/aigpOlxuZC5vbkFkZD1qO2o9c31lbHNlIGo9a31lbHNlIGlmKGcudGVzdChhKSYmYi50YWdOYW1lIT09XCJJTUdcIilmPXZhKGEpLGRbYytcIi1vcGFjaXR5U2V0dGVyXCJdKGYuZ2V0KFwiYVwiKSxjLGIpLGo9Zi5nZXQoXCJyZ2JcIik7ZWxzZXtqPWIuZ2V0RWxlbWVudHNCeVRhZ05hbWUoYyk7aWYoai5sZW5ndGgpalswXS5vcGFjaXR5PTEsalswXS50eXBlPVwic29saWRcIjtqPWF9cmV0dXJuIGp9LHByZXBWTUw6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5pc0lFOCxhPWEuam9pbihcIlwiKTtiPyhhPWEucmVwbGFjZShcIi8+XCIsJyB4bWxucz1cInVybjpzY2hlbWFzLW1pY3Jvc29mdC1jb206dm1sXCIgLz4nKSxhPWEuaW5kZXhPZignc3R5bGU9XCInKT09PS0xP2EucmVwbGFjZShcIi8+XCIsJyBzdHlsZT1cImRpc3BsYXk6aW5saW5lLWJsb2NrO2JlaGF2aW9yOnVybCgjZGVmYXVsdCNWTUwpO1wiIC8+Jyk6YS5yZXBsYWNlKCdzdHlsZT1cIicsJ3N0eWxlPVwiZGlzcGxheTppbmxpbmUtYmxvY2s7YmVoYXZpb3I6dXJsKCNkZWZhdWx0I1ZNTCk7JykpOlxuYT1hLnJlcGxhY2UoXCI8XCIsXCI8aGN2OlwiKTtyZXR1cm4gYX0sdGV4dDp4YS5wcm90b3R5cGUuaHRtbCxwYXRoOmZ1bmN0aW9uKGEpe3ZhciBiPXtjb29yZHNpemU6XCIxMCAxMFwifTtKYShhKT9iLmQ9YTplYShhKSYmQShiLGEpO3JldHVybiB0aGlzLmNyZWF0ZUVsZW1lbnQoXCJzaGFwZVwiKS5hdHRyKGIpfSxjaXJjbGU6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXRoaXMuc3ltYm9sKFwiY2lyY2xlXCIpO2lmKGVhKGEpKWM9YS5yLGI9YS55LGE9YS54O2QuaXNDaXJjbGU9ITA7ZC5yPWM7cmV0dXJuIGQuYXR0cih7eDphLHk6Yn0pfSxnOmZ1bmN0aW9uKGEpe3ZhciBiO2EmJihiPXtjbGFzc05hbWU6XCJoaWdoY2hhcnRzLVwiK2EsXCJjbGFzc1wiOlwiaGlnaGNoYXJ0cy1cIithfSk7cmV0dXJuIHRoaXMuY3JlYXRlRWxlbWVudChWYSkuYXR0cihiKX0saW1hZ2U6ZnVuY3Rpb24oYSxiLGMsZCxlKXt2YXIgZj10aGlzLmNyZWF0ZUVsZW1lbnQoXCJpbWdcIikuYXR0cih7c3JjOmF9KTthcmd1bWVudHMubGVuZ3RoPlxuMSYmZi5hdHRyKHt4OmIseTpjLHdpZHRoOmQsaGVpZ2h0OmV9KTtyZXR1cm4gZn0sY3JlYXRlRWxlbWVudDpmdW5jdGlvbihhKXtyZXR1cm4gYT09PVwicmVjdFwiP3RoaXMuc3ltYm9sKGEpOnhhLnByb3RvdHlwZS5jcmVhdGVFbGVtZW50LmNhbGwodGhpcyxhKX0saW52ZXJ0Q2hpbGQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLGQ9Yi5zdHlsZSxlPWEudGFnTmFtZT09PVwiSU1HXCImJmEuc3R5bGU7TihhLHtmbGlwOlwieFwiLGxlZnQ6SyhkLndpZHRoKS0oZT9LKGUudG9wKToxKSx0b3A6SyhkLmhlaWdodCktKGU/SyhlLmxlZnQpOjEpLHJvdGF0aW9uOi05MH0pO28oYS5jaGlsZE5vZGVzLGZ1bmN0aW9uKGIpe2MuaW52ZXJ0Q2hpbGQoYixhKX0pfSxzeW1ib2xzOnthcmM6ZnVuY3Rpb24oYSxiLGMsZCxlKXt2YXIgZj1lLnN0YXJ0LGc9ZS5lbmQsaD1lLnJ8fGN8fGQsYz1lLmlubmVyUixkPWNhKGYpLGk9bGEoZiksaj1jYShnKSxrPWxhKGcpO2lmKGctZj09PTApcmV0dXJuW1wieFwiXTtmPVtcIndhXCIsXG5hLWgsYi1oLGEraCxiK2gsYStoKmQsYitoKmksYStoKmosYitoKmtdO2Uub3BlbiYmIWMmJmYucHVzaChcImVcIixcIk1cIixhLGIpO2YucHVzaChcImF0XCIsYS1jLGItYyxhK2MsYitjLGErYypqLGIrYyprLGErYypkLGIrYyppLFwieFwiLFwiZVwiKTtmLmlzQXJjPSEwO3JldHVybiBmfSxjaXJjbGU6ZnVuY3Rpb24oYSxiLGMsZCxlKXtlJiYoYz1kPTIqZS5yKTtlJiZlLmlzQ2lyY2xlJiYoYS09Yy8yLGItPWQvMik7cmV0dXJuW1wid2FcIixhLGIsYStjLGIrZCxhK2MsYitkLzIsYStjLGIrZC8yLFwiZVwiXX0scmVjdDpmdW5jdGlvbihhLGIsYyxkLGUpe3JldHVybiB4YS5wcm90b3R5cGUuc3ltYm9sc1shdihlKXx8IWUucj9cInNxdWFyZVwiOlwiY2FsbG91dFwiXS5jYWxsKDAsYSxiLGMsZCxlKX19fSxCLlZNTFJlbmRlcmVyPWxiPWZ1bmN0aW9uKCl7dGhpcy5pbml0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sbGIucHJvdG90eXBlPXooeGEucHJvdG90eXBlLGFhKSxYYT1sYjt4YS5wcm90b3R5cGUubWVhc3VyZVNwYW5XaWR0aD1cbmZ1bmN0aW9uKGEsYil7dmFyIGM9SC5jcmVhdGVFbGVtZW50KFwic3BhblwiKSxkO2Q9SC5jcmVhdGVUZXh0Tm9kZShhKTtjLmFwcGVuZENoaWxkKGQpO04oYyxiKTt0aGlzLmJveC5hcHBlbmRDaGlsZChjKTtkPWMub2Zmc2V0V2lkdGg7VWEoYyk7cmV0dXJuIGR9O3ZhciBXYjtpZihxYSlCLkNhblZHUmVuZGVyZXI9YWE9ZnVuY3Rpb24oKXtRYT1cImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWxcIn0sYWEucHJvdG90eXBlLnN5bWJvbHM9e30sV2I9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKCl7dmFyIGE9Yi5sZW5ndGgsZDtmb3IoZD0wO2Q8YTtkKyspYltkXSgpO2I9W119dmFyIGI9W107cmV0dXJue3B1c2g6ZnVuY3Rpb24oYyxkKXtpZihiLmxlbmd0aD09PTApe3ZhciBlPUguZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJoZWFkXCIpWzBdLGY9SC5jcmVhdGVFbGVtZW50KFwic2NyaXB0XCIpO2YudHlwZT1cInRleHQvamF2YXNjcmlwdFwiO2Yuc3JjPWQ7Zi5vbmxvYWQ9YTtlLmFwcGVuZENoaWxkKGYpfWIucHVzaChjKX19fSgpLFxuWGE9YWE7YmIucHJvdG90eXBlPXthZGRMYWJlbDpmdW5jdGlvbigpe3ZhciBhPXRoaXMuYXhpcyxiPWEub3B0aW9ucyxjPWEuY2hhcnQsZD1hLmNhdGVnb3JpZXMsZT1hLm5hbWVzLGY9dGhpcy5wb3MsZz1iLmxhYmVscyxoPWEudGlja1Bvc2l0aW9ucyxpPWY9PT1oWzBdLGo9Zj09PWhbaC5sZW5ndGgtMV0sZT1kP3EoZFtmXSxlW2ZdLGYpOmYsZD10aGlzLmxhYmVsLGg9aC5pbmZvLGs7YS5pc0RhdGV0aW1lQXhpcyYmaCYmKGs9Yi5kYXRlVGltZUxhYmVsRm9ybWF0c1toLmhpZ2hlclJhbmtzW2ZdfHxoLnVuaXROYW1lXSk7dGhpcy5pc0ZpcnN0PWk7dGhpcy5pc0xhc3Q9ajtiPWEubGFiZWxGb3JtYXR0ZXIuY2FsbCh7YXhpczphLGNoYXJ0OmMsaXNGaXJzdDppLGlzTGFzdDpqLGRhdGVUaW1lTGFiZWxGb3JtYXQ6ayx2YWx1ZTphLmlzTG9nP2thKGEubGluMmxvZyhlKSk6ZX0pO3YoZCk/ZCYmZC5hdHRyKHt0ZXh0OmJ9KToodGhpcy5sYWJlbExlbmd0aD0odGhpcy5sYWJlbD1kPXYoYikmJlxuZy5lbmFibGVkP2MucmVuZGVyZXIudGV4dChiLDAsMCxnLnVzZUhUTUwpLmNzcyh6KGcuc3R5bGUpKS5hZGQoYS5sYWJlbEdyb3VwKTpudWxsKSYmZC5nZXRCQm94KCkud2lkdGgsdGhpcy5yb3RhdGlvbj0wKX0sZ2V0TGFiZWxTaXplOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubGFiZWw/dGhpcy5sYWJlbC5nZXRCQm94KClbdGhpcy5heGlzLmhvcml6P1wiaGVpZ2h0XCI6XCJ3aWR0aFwiXTowfSxoYW5kbGVPdmVyZmxvdzpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmF4aXMsYz1hLngsZD1iLmNoYXJ0LmNoYXJ0V2lkdGgsZT1iLmNoYXJ0LnNwYWNpbmcsZj1xKGIubGFiZWxMZWZ0LEcoYi5wb3MsZVszXSkpLGU9cShiLmxhYmVsUmlnaHQsdyhiLnBvcytiLmxlbixkLWVbMV0pKSxnPXRoaXMubGFiZWwsaD10aGlzLnJvdGF0aW9uLGk9e2xlZnQ6MCxjZW50ZXI6MC41LHJpZ2h0OjF9W2IubGFiZWxBbGlnbl0saj1nLmdldEJCb3goKS53aWR0aCxrPWIuZ2V0U2xvdFdpZHRoKCksbD1rLG09MSxuLFxucD17fTtpZihoKWg8MCYmYy1pKmo8Zj9uPXkoYy9jYShoKnBhKS1mKTpoPjAmJmMraSpqPmUmJihuPXkoKGQtYykvY2EoaCpwYSkpKTtlbHNlIGlmKGQ9YysoMS1pKSpqLGMtaSpqPGY/bD1hLngrbCooMS1pKS1mOmQ+ZSYmKGw9ZS1hLngrbCppLG09LTEpLGw9RyhrLGwpLGw8ayYmYi5sYWJlbEFsaWduPT09XCJjZW50ZXJcIiYmKGEueCs9bSooay1sLWkqKGstRyhqLGwpKSkpLGo+bHx8Yi5hdXRvUm90YXRpb24mJmcuc3R5bGVzLndpZHRoKW49bDtpZihuKXtwLndpZHRoPW47aWYoIWIub3B0aW9ucy5sYWJlbHMuc3R5bGUudGV4dE92ZXJmbG93KXAudGV4dE92ZXJmbG93PVwiZWxsaXBzaXNcIjtnLmNzcyhwKX19LGdldFBvc2l0aW9uOmZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPXRoaXMuYXhpcyxmPWUuY2hhcnQsZz1kJiZmLm9sZENoYXJ0SGVpZ2h0fHxmLmNoYXJ0SGVpZ2h0O3JldHVybnt4OmE/ZS50cmFuc2xhdGUoYitjLG51bGwsbnVsbCxkKStlLnRyYW5zQjplLmxlZnQrZS5vZmZzZXQrXG4oZS5vcHBvc2l0ZT8oZCYmZi5vbGRDaGFydFdpZHRofHxmLmNoYXJ0V2lkdGgpLWUucmlnaHQtZS5sZWZ0OjApLHk6YT9nLWUuYm90dG9tK2Uub2Zmc2V0LShlLm9wcG9zaXRlP2UuaGVpZ2h0OjApOmctZS50cmFuc2xhdGUoYitjLG51bGwsbnVsbCxkKS1lLnRyYW5zQn19LGdldExhYmVsUG9zaXRpb246ZnVuY3Rpb24oYSxiLGMsZCxlLGYsZyxoKXt2YXIgaT10aGlzLmF4aXMsaj1pLnRyYW5zQSxrPWkucmV2ZXJzZWQsbD1pLnN0YWdnZXJMaW5lcyxtPWkudGlja1JvdENvcnJ8fHt4OjAseTowfSxuPWUueTt2KG4pfHwobj1pLnNpZGU9PT0wP2Mucm90YXRpb24/LTg6LWMuZ2V0QkJveCgpLmhlaWdodDppLnNpZGU9PT0yP20ueSs4OmNhKGMucm90YXRpb24qcGEpKihtLnktYy5nZXRCQm94KCExLDApLmhlaWdodC8yKSk7YT1hK2UueCttLngtKGYmJmQ/ZipqKihrPy0xOjEpOjApO2I9YituLShmJiYhZD9mKmoqKGs/MTotMSk6MCk7bCYmKGM9Zy8oaHx8MSklbCxpLm9wcG9zaXRlJiZcbihjPWwtYy0xKSxiKz1jKihpLmxhYmVsT2Zmc2V0L2wpKTtyZXR1cm57eDphLHk6eShiKX19LGdldE1hcmtQYXRoOmZ1bmN0aW9uKGEsYixjLGQsZSxmKXtyZXR1cm4gZi5jcmlzcExpbmUoW1wiTVwiLGEsYixcIkxcIixhKyhlPzA6LWMpLGIrKGU/YzowKV0sZCl9LHJlbmRlcjpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9dGhpcy5heGlzLGU9ZC5vcHRpb25zLGY9ZC5jaGFydC5yZW5kZXJlcixnPWQuaG9yaXosaD10aGlzLnR5cGUsaT10aGlzLmxhYmVsLGo9dGhpcy5wb3Msaz1lLmxhYmVscyxsPXRoaXMuZ3JpZExpbmUsbT1oP2grXCJHcmlkXCI6XCJncmlkXCIsbj1oP2grXCJUaWNrXCI6XCJ0aWNrXCIscD1lW20rXCJMaW5lV2lkdGhcIl0scj1lW20rXCJMaW5lQ29sb3JcIl0scz1lW20rXCJMaW5lRGFzaFN0eWxlXCJdLG09ZC50aWNrU2l6ZShuKSxuPWVbbitcIkNvbG9yXCJdLEY9dGhpcy5tYXJrLHU9ay5zdGVwLG89ITAsRD1kLnRpY2ttYXJrT2Zmc2V0LFE9dGhpcy5nZXRQb3NpdGlvbihnLGosRCxiKSxoYT1RLngsXG5RPVEueSx2PWcmJmhhPT09ZC5wb3MrZC5sZW58fCFnJiZRPT09ZC5wb3M/LTE6MSxjPXEoYywxKTt0aGlzLmlzQWN0aXZlPSEwO2lmKHApe2o9ZC5nZXRQbG90TGluZVBhdGgoaitELHAqdixiLCEwKTtpZihsPT09dCl7bD17c3Ryb2tlOnIsXCJzdHJva2Utd2lkdGhcIjpwfTtpZihzKWwuZGFzaHN0eWxlPXM7aWYoIWgpbC56SW5kZXg9MTtpZihiKWwub3BhY2l0eT0wO3RoaXMuZ3JpZExpbmU9bD1wP2YucGF0aChqKS5hdHRyKGwpLmFkZChkLmdyaWRHcm91cCk6bnVsbH1pZighYiYmbCYmailsW3RoaXMuaXNOZXc/XCJhdHRyXCI6XCJhbmltYXRlXCJdKHtkOmosb3BhY2l0eTpjfSl9aWYobSlkLm9wcG9zaXRlJiYobVswXT0tbVswXSksaD10aGlzLmdldE1hcmtQYXRoKGhhLFEsbVswXSxtWzFdKnYsZyxmKSxGP0YuYW5pbWF0ZSh7ZDpoLG9wYWNpdHk6Y30pOnRoaXMubWFyaz1mLnBhdGgoaCkuYXR0cih7c3Ryb2tlOm4sXCJzdHJva2Utd2lkdGhcIjptWzFdLG9wYWNpdHk6Y30pLmFkZChkLmF4aXNHcm91cCk7XG5pZihpJiZDKGhhKSlpLnh5PVE9dGhpcy5nZXRMYWJlbFBvc2l0aW9uKGhhLFEsaSxnLGssRCxhLHUpLHRoaXMuaXNGaXJzdCYmIXRoaXMuaXNMYXN0JiYhcShlLnNob3dGaXJzdExhYmVsLDEpfHx0aGlzLmlzTGFzdCYmIXRoaXMuaXNGaXJzdCYmIXEoZS5zaG93TGFzdExhYmVsLDEpP289ITE6ZyYmIWQuaXNSYWRpYWwmJiFrLnN0ZXAmJiFrLnJvdGF0aW9uJiYhYiYmYyE9PTAmJnRoaXMuaGFuZGxlT3ZlcmZsb3coUSksdSYmYSV1JiYobz0hMSksbyYmQyhRLnkpPyhRLm9wYWNpdHk9YyxpW3RoaXMuaXNOZXc/XCJhdHRyXCI6XCJhbmltYXRlXCJdKFEpLHRoaXMuaXNOZXc9ITEpOmkuYXR0cihcInlcIiwtOTk5OSl9LGRlc3Ryb3k6ZnVuY3Rpb24oKXtQYSh0aGlzLHRoaXMuYXhpcyl9fTtCLlBsb3RMaW5lT3JCYW5kPWZ1bmN0aW9uKGEsYil7dGhpcy5heGlzPWE7aWYoYil0aGlzLm9wdGlvbnM9Yix0aGlzLmlkPWIuaWR9O0IuUGxvdExpbmVPckJhbmQucHJvdG90eXBlPXtyZW5kZXI6ZnVuY3Rpb24oKXt2YXIgYT1cbnRoaXMsYj1hLmF4aXMsYz1iLmhvcml6LGQ9YS5vcHRpb25zLGU9ZC5sYWJlbCxmPWEubGFiZWwsZz1kLndpZHRoLGg9ZC50byxpPWQuZnJvbSxqPXYoaSkmJnYoaCksaz1kLnZhbHVlLGw9ZC5kYXNoU3R5bGUsbT1hLnN2Z0VsZW0sbj1bXSxwLHI9ZC5jb2xvcixzPXEoZC56SW5kZXgsMCksRj1kLmV2ZW50cyx1PXt9LG89Yi5jaGFydC5yZW5kZXJlcixuPWIubG9nMmxpbjtiLmlzTG9nJiYoaT1uKGkpLGg9bihoKSxrPW4oaykpO2lmKGcpe2lmKG49Yi5nZXRQbG90TGluZVBhdGgoayxnKSx1PXtzdHJva2U6cixcInN0cm9rZS13aWR0aFwiOmd9LGwpdS5kYXNoc3R5bGU9bH1lbHNlIGlmKGope249Yi5nZXRQbG90QmFuZFBhdGgoaSxoLGQpO2lmKHIpdS5maWxsPXI7aWYoZC5ib3JkZXJXaWR0aCl1LnN0cm9rZT1kLmJvcmRlckNvbG9yLHVbXCJzdHJva2Utd2lkdGhcIl09ZC5ib3JkZXJXaWR0aH1lbHNlIHJldHVybjt1LnpJbmRleD1zO2lmKG0paWYobiltLnNob3coKSxtLmFuaW1hdGUoe2Q6bn0pO1xuZWxzZXtpZihtLmhpZGUoKSxmKWEubGFiZWw9Zj1mLmRlc3Ryb3koKX1lbHNlIGlmKG4mJm4ubGVuZ3RoJiYoYS5zdmdFbGVtPW09by5wYXRoKG4pLmF0dHIodSkuYWRkKCksRikpZm9yKHAgaW4gZD1mdW5jdGlvbihiKXttLm9uKGIsZnVuY3Rpb24oYyl7RltiXS5hcHBseShhLFtjXSl9KX0sRilkKHApO2UmJnYoZS50ZXh0KSYmbiYmbi5sZW5ndGgmJmIud2lkdGg+MCYmYi5oZWlnaHQ+MCYmIW4uZmxhdD8oZT16KHthbGlnbjpjJiZqJiZcImNlbnRlclwiLHg6Yz8haiYmNDoxMCx2ZXJ0aWNhbEFsaWduOiFjJiZqJiZcIm1pZGRsZVwiLHk6Yz9qPzE2OjEwOmo/NjotNCxyb3RhdGlvbjpjJiYhaiYmOTB9LGUpLHRoaXMucmVuZGVyTGFiZWwoZSxuLGoscykpOmYmJmYuaGlkZSgpO3JldHVybiBhfSxyZW5kZXJMYWJlbDpmdW5jdGlvbihhLGIsYyxkKXt2YXIgZT10aGlzLmxhYmVsLGY9dGhpcy5heGlzLmNoYXJ0LnJlbmRlcmVyO2lmKCFlKWU9e2FsaWduOmEudGV4dEFsaWdufHxhLmFsaWduLFxucm90YXRpb246YS5yb3RhdGlvbn0sZS56SW5kZXg9ZCx0aGlzLmxhYmVsPWU9Zi50ZXh0KGEudGV4dCwwLDAsYS51c2VIVE1MKS5hdHRyKGUpLmNzcyhhLnN0eWxlKS5hZGQoKTtkPVtiWzFdLGJbNF0sYz9iWzZdOmJbMV1dO2I9W2JbMl0sYls1XSxjP2JbN106YlsyXV07Yz1NYShkKTtmPU1hKGIpO2UuYWxpZ24oYSwhMSx7eDpjLHk6Zix3aWR0aDpEYShkKS1jLGhlaWdodDpEYShiKS1mfSk7ZS5zaG93KCl9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt6YSh0aGlzLmF4aXMucGxvdExpbmVzQW5kQmFuZHMsdGhpcyk7ZGVsZXRlIHRoaXMuYXhpcztQYSh0aGlzKX19O3ZhciBKPUIuQXhpcz1mdW5jdGlvbigpe3RoaXMuaW5pdC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9O0oucHJvdG90eXBlPXtkZWZhdWx0T3B0aW9uczp7ZGF0ZVRpbWVMYWJlbEZvcm1hdHM6e21pbGxpc2Vjb25kOlwiJUg6JU06JVMuJUxcIixzZWNvbmQ6XCIlSDolTTolU1wiLG1pbnV0ZTpcIiVIOiVNXCIsaG91cjpcIiVIOiVNXCIsZGF5OlwiJWUuICViXCIsXG53ZWVrOlwiJWUuICViXCIsbW9udGg6XCIlYiAnJXlcIix5ZWFyOlwiJVlcIn0sZW5kT25UaWNrOiExLGdyaWRMaW5lQ29sb3I6XCIjRDhEOEQ4XCIsbGFiZWxzOntlbmFibGVkOiEwLHN0eWxlOntjb2xvcjpcIiM2MDYwNjBcIixjdXJzb3I6XCJkZWZhdWx0XCIsZm9udFNpemU6XCIxMXB4XCJ9LHg6MH0sbGluZUNvbG9yOlwiI0MwRDBFMFwiLGxpbmVXaWR0aDoxLG1pblBhZGRpbmc6MC4wMSxtYXhQYWRkaW5nOjAuMDEsbWlub3JHcmlkTGluZUNvbG9yOlwiI0UwRTBFMFwiLG1pbm9yR3JpZExpbmVXaWR0aDoxLG1pbm9yVGlja0NvbG9yOlwiI0EwQTBBMFwiLG1pbm9yVGlja0xlbmd0aDoyLG1pbm9yVGlja1Bvc2l0aW9uOlwib3V0c2lkZVwiLHN0YXJ0T2ZXZWVrOjEsc3RhcnRPblRpY2s6ITEsdGlja0NvbG9yOlwiI0MwRDBFMFwiLHRpY2tMZW5ndGg6MTAsdGlja21hcmtQbGFjZW1lbnQ6XCJiZXR3ZWVuXCIsdGlja1BpeGVsSW50ZXJ2YWw6MTAwLHRpY2tQb3NpdGlvbjpcIm91dHNpZGVcIix0aXRsZTp7YWxpZ246XCJtaWRkbGVcIixcbnN0eWxlOntjb2xvcjpcIiM3MDcwNzBcIn19LHR5cGU6XCJsaW5lYXJcIn0sZGVmYXVsdFlBeGlzT3B0aW9uczp7ZW5kT25UaWNrOiEwLGdyaWRMaW5lV2lkdGg6MSx0aWNrUGl4ZWxJbnRlcnZhbDo3MixzaG93TGFzdExhYmVsOiEwLGxhYmVsczp7eDotOH0sbGluZVdpZHRoOjAsbWF4UGFkZGluZzowLjA1LG1pblBhZGRpbmc6MC4wNSxzdGFydE9uVGljazohMCx0aXRsZTp7cm90YXRpb246MjcwLHRleHQ6XCJWYWx1ZXNcIn0sc3RhY2tMYWJlbHM6e2VuYWJsZWQ6ITEsZm9ybWF0dGVyOmZ1bmN0aW9uKCl7cmV0dXJuIEIubnVtYmVyRm9ybWF0KHRoaXMudG90YWwsLTEpfSxzdHlsZTp6KFcubGluZS5kYXRhTGFiZWxzLnN0eWxlLHtjb2xvcjpcIiMwMDAwMDBcIn0pfX0sZGVmYXVsdExlZnRBeGlzT3B0aW9uczp7bGFiZWxzOnt4Oi0xNX0sdGl0bGU6e3JvdGF0aW9uOjI3MH19LGRlZmF1bHRSaWdodEF4aXNPcHRpb25zOntsYWJlbHM6e3g6MTV9LHRpdGxlOntyb3RhdGlvbjo5MH19LGRlZmF1bHRCb3R0b21BeGlzT3B0aW9uczp7bGFiZWxzOnthdXRvUm90YXRpb246Wy00NV0sXG54OjB9LHRpdGxlOntyb3RhdGlvbjowfX0sZGVmYXVsdFRvcEF4aXNPcHRpb25zOntsYWJlbHM6e2F1dG9Sb3RhdGlvbjpbLTQ1XSx4OjB9LHRpdGxlOntyb3RhdGlvbjowfX0saW5pdDpmdW5jdGlvbihhLGIpe3ZhciBjPWIuaXNYO3RoaXMuY2hhcnQ9YTt0aGlzLmhvcml6PWEuaW52ZXJ0ZWQ/IWM6Yzt0aGlzLmNvbGw9KHRoaXMuaXNYQXhpcz1jKT9cInhBeGlzXCI6XCJ5QXhpc1wiO3RoaXMub3Bwb3NpdGU9Yi5vcHBvc2l0ZTt0aGlzLnNpZGU9Yi5zaWRlfHwodGhpcy5ob3Jpej90aGlzLm9wcG9zaXRlPzA6Mjp0aGlzLm9wcG9zaXRlPzE6Myk7dGhpcy5zZXRPcHRpb25zKGIpO3ZhciBkPXRoaXMub3B0aW9ucyxlPWQudHlwZTt0aGlzLmxhYmVsRm9ybWF0dGVyPWQubGFiZWxzLmZvcm1hdHRlcnx8dGhpcy5kZWZhdWx0TGFiZWxGb3JtYXR0ZXI7dGhpcy51c2VyT3B0aW9ucz1iO3RoaXMubWluUGl4ZWxQYWRkaW5nPTA7dGhpcy5yZXZlcnNlZD1kLnJldmVyc2VkO3RoaXMudmlzaWJsZT1kLnZpc2libGUhPT1cbiExO3RoaXMuem9vbUVuYWJsZWQ9ZC56b29tRW5hYmxlZCE9PSExO3RoaXMuY2F0ZWdvcmllcz1kLmNhdGVnb3JpZXN8fGU9PT1cImNhdGVnb3J5XCI7dGhpcy5uYW1lcz10aGlzLm5hbWVzfHxbXTt0aGlzLmlzTG9nPWU9PT1cImxvZ2FyaXRobWljXCI7dGhpcy5pc0RhdGV0aW1lQXhpcz1lPT09XCJkYXRldGltZVwiO3RoaXMuaXNMaW5rZWQ9dihkLmxpbmtlZFRvKTt0aGlzLnRpY2tzPXt9O3RoaXMubGFiZWxFZGdlPVtdO3RoaXMubWlub3JUaWNrcz17fTt0aGlzLnBsb3RMaW5lc0FuZEJhbmRzPVtdO3RoaXMuYWx0ZXJuYXRlQmFuZHM9e307dGhpcy5sZW49MDt0aGlzLm1pblJhbmdlPXRoaXMudXNlck1pblJhbmdlPWQubWluUmFuZ2V8fGQubWF4Wm9vbTt0aGlzLnJhbmdlPWQucmFuZ2U7dGhpcy5vZmZzZXQ9ZC5vZmZzZXR8fDA7dGhpcy5zdGFja3M9e307dGhpcy5vbGRTdGFja3M9e307dGhpcy5zdGFja3NUb3VjaGVkPTA7dGhpcy5taW49dGhpcy5tYXg9bnVsbDt0aGlzLmNyb3NzaGFpcj1cbnEoZC5jcm9zc2hhaXIsdWEoYS5vcHRpb25zLnRvb2x0aXAuY3Jvc3NoYWlycylbYz8wOjFdLCExKTt2YXIgZixkPXRoaXMub3B0aW9ucy5ldmVudHM7c2EodGhpcyxhLmF4ZXMpPT09LTEmJihjJiYhdGhpcy5pc0NvbG9yQXhpcz9hLmF4ZXMuc3BsaWNlKGEueEF4aXMubGVuZ3RoLDAsdGhpcyk6YS5heGVzLnB1c2godGhpcyksYVt0aGlzLmNvbGxdLnB1c2godGhpcykpO3RoaXMuc2VyaWVzPXRoaXMuc2VyaWVzfHxbXTtpZihhLmludmVydGVkJiZjJiZ0aGlzLnJldmVyc2VkPT09dCl0aGlzLnJldmVyc2VkPSEwO3RoaXMucmVtb3ZlUGxvdExpbmU9dGhpcy5yZW1vdmVQbG90QmFuZD10aGlzLnJlbW92ZVBsb3RCYW5kT3JMaW5lO2ZvcihmIGluIGQpRSh0aGlzLGYsZFtmXSk7aWYodGhpcy5pc0xvZyl0aGlzLnZhbDJsaW49dGhpcy5sb2cybGluLHRoaXMubGluMnZhbD10aGlzLmxpbjJsb2d9LHNldE9wdGlvbnM6ZnVuY3Rpb24oYSl7dGhpcy5vcHRpb25zPXoodGhpcy5kZWZhdWx0T3B0aW9ucyxcbnRoaXMuaXNYQXhpcz97fTp0aGlzLmRlZmF1bHRZQXhpc09wdGlvbnMsW3RoaXMuZGVmYXVsdFRvcEF4aXNPcHRpb25zLHRoaXMuZGVmYXVsdFJpZ2h0QXhpc09wdGlvbnMsdGhpcy5kZWZhdWx0Qm90dG9tQXhpc09wdGlvbnMsdGhpcy5kZWZhdWx0TGVmdEF4aXNPcHRpb25zXVt0aGlzLnNpZGVdLHooUlt0aGlzLmNvbGxdLGEpKX0sZGVmYXVsdExhYmVsRm9ybWF0dGVyOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5heGlzLGI9dGhpcy52YWx1ZSxjPWEuY2F0ZWdvcmllcyxkPXRoaXMuZGF0ZVRpbWVMYWJlbEZvcm1hdCxlPVIubGFuZy5udW1lcmljU3ltYm9scyxmPWUmJmUubGVuZ3RoLGcsaD1hLm9wdGlvbnMubGFiZWxzLmZvcm1hdCxhPWEuaXNMb2c/YjphLnRpY2tJbnRlcnZhbDtpZihoKWc9TGEoaCx0aGlzKTtlbHNlIGlmKGMpZz1iO2Vsc2UgaWYoZClnPW5hKGQsYik7ZWxzZSBpZihmJiZhPj0xRTMpZm9yKDtmLS0mJmc9PT10OyljPU1hdGgucG93KDFFMyxmKzEpLGE+PWMmJmIqMTAlXG5jPT09MCYmZVtmXSE9PW51bGwmJihnPUIubnVtYmVyRm9ybWF0KGIvYywtMSkrZVtmXSk7Zz09PXQmJihnPVMoYik+PTFFND9CLm51bWJlckZvcm1hdChiLC0xKTpCLm51bWJlckZvcm1hdChiLC0xLHQsXCJcIikpO3JldHVybiBnfSxnZXRTZXJpZXNFeHRyZW1lczpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLmNoYXJ0O2EuaGFzVmlzaWJsZVNlcmllcz0hMTthLmRhdGFNaW49YS5kYXRhTWF4PWEudGhyZXNob2xkPW51bGw7YS5zb2Z0VGhyZXNob2xkPSFhLmlzWEF4aXM7YS5idWlsZFN0YWNrcyYmYS5idWlsZFN0YWNrcygpO28oYS5zZXJpZXMsZnVuY3Rpb24oYyl7aWYoYy52aXNpYmxlfHwhYi5vcHRpb25zLmNoYXJ0Lmlnbm9yZUhpZGRlblNlcmllcyl7dmFyIGQ9Yy5vcHRpb25zLGU9ZC50aHJlc2hvbGQsZjthLmhhc1Zpc2libGVTZXJpZXM9ITA7YS5pc0xvZyYmZTw9MCYmKGU9bnVsbCk7aWYoYS5pc1hBeGlzKXtpZihkPWMueERhdGEsZC5sZW5ndGgpYz1NYShkKSwhQyhjKSYmIShjIGluc3RhbmNlb2ZcbmJhKSYmKGQ9RmEoZCxmdW5jdGlvbihhKXtyZXR1cm4gQyhhKX0pLGM9TWEoZCkpLGEuZGF0YU1pbj1HKHEoYS5kYXRhTWluLGRbMF0pLGMpLGEuZGF0YU1heD13KHEoYS5kYXRhTWF4LGRbMF0pLERhKGQpKX1lbHNle2MuZ2V0RXh0cmVtZXMoKTtmPWMuZGF0YU1heDtjPWMuZGF0YU1pbjtpZih2KGMpJiZ2KGYpKWEuZGF0YU1pbj1HKHEoYS5kYXRhTWluLGMpLGMpLGEuZGF0YU1heD13KHEoYS5kYXRhTWF4LGYpLGYpO2lmKHYoZSkpYS50aHJlc2hvbGQ9ZTtpZighZC5zb2Z0VGhyZXNob2xkfHxhLmlzTG9nKWEuc29mdFRocmVzaG9sZD0hMX19fSl9LHRyYW5zbGF0ZTpmdW5jdGlvbihhLGIsYyxkLGUsZil7dmFyIGc9dGhpcy5saW5rZWRQYXJlbnR8fHRoaXMsaD0xLGk9MCxqPWQ/Zy5vbGRUcmFuc0E6Zy50cmFuc0EsZD1kP2cub2xkTWluOmcubWluLGs9Zy5taW5QaXhlbFBhZGRpbmcsZT0oZy5pc09yZGluYWx8fGcuaXNCcm9rZW58fGcuaXNMb2cmJmUpJiZnLmxpbjJ2YWw7aWYoIWopaj1cbmcudHJhbnNBO2lmKGMpaCo9LTEsaT1nLmxlbjtnLnJldmVyc2VkJiYoaCo9LTEsaS09aCooZy5zZWN0b3J8fGcubGVuKSk7Yj8oYT1hKmgraSxhLT1rLGE9YS9qK2QsZSYmKGE9Zy5saW4ydmFsKGEpKSk6KGUmJihhPWcudmFsMmxpbihhKSksZj09PVwiYmV0d2VlblwiJiYoZj0wLjUpLGE9aCooYS1kKSpqK2kraCprKyhDKGYpP2oqZipnLnBvaW50UmFuZ2U6MCkpO3JldHVybiBhfSx0b1BpeGVsczpmdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLnRyYW5zbGF0ZShhLCExLCF0aGlzLmhvcml6LG51bGwsITApKyhiPzA6dGhpcy5wb3MpfSx0b1ZhbHVlOmZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMudHJhbnNsYXRlKGEtKGI/MDp0aGlzLnBvcyksITAsIXRoaXMuaG9yaXosbnVsbCwhMCl9LGdldFBsb3RMaW5lUGF0aDpmdW5jdGlvbihhLGIsYyxkLGUpe3ZhciBmPXRoaXMuY2hhcnQsZz10aGlzLmxlZnQsaD10aGlzLnRvcCxpLGosaz1jJiZmLm9sZENoYXJ0SGVpZ2h0fHxmLmNoYXJ0SGVpZ2h0LFxubD1jJiZmLm9sZENoYXJ0V2lkdGh8fGYuY2hhcnRXaWR0aCxtO2k9dGhpcy50cmFuc0I7dmFyIG49ZnVuY3Rpb24oYSxiLGMpe2lmKGE8Ynx8YT5jKWQ/YT1HKHcoYixhKSxjKTptPSEwO3JldHVybiBhfSxlPXEoZSx0aGlzLnRyYW5zbGF0ZShhLG51bGwsbnVsbCxjKSksYT1jPXkoZStpKTtpPWo9eShrLWUtaSk7QyhlKT90aGlzLmhvcml6PyhpPWgsaj1rLXRoaXMuYm90dG9tLGE9Yz1uKGEsZyxnK3RoaXMud2lkdGgpKTooYT1nLGM9bC10aGlzLnJpZ2h0LGk9aj1uKGksaCxoK3RoaXMuaGVpZ2h0KSk6bT0hMDtyZXR1cm4gbSYmIWQ/bnVsbDpmLnJlbmRlcmVyLmNyaXNwTGluZShbXCJNXCIsYSxpLFwiTFwiLGMsal0sYnx8MSl9LGdldExpbmVhclRpY2tQb3NpdGlvbnM6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGU9a2EoVihiL2EpKmEpLGY9a2EoRWEoYy9hKSphKSxnPVtdO2lmKGI9PT1jJiZDKGIpKXJldHVybltiXTtmb3IoYj1lO2I8PWY7KXtnLnB1c2goYik7Yj1rYShiK2EpO2lmKGI9PT1cbmQpYnJlYWs7ZD1ifXJldHVybiBnfSxnZXRNaW5vclRpY2tQb3NpdGlvbnM6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9wdGlvbnMsYj10aGlzLnRpY2tQb3NpdGlvbnMsYz10aGlzLm1pbm9yVGlja0ludGVydmFsLGQ9W10sZSxmPXRoaXMucG9pbnRSYW5nZVBhZGRpbmd8fDA7ZT10aGlzLm1pbi1mO3ZhciBmPXRoaXMubWF4K2YsZz1mLWU7aWYoZyYmZy9jPHRoaXMubGVuLzMpaWYodGhpcy5pc0xvZyl7Zj1iLmxlbmd0aDtmb3IoZT0xO2U8ZjtlKyspZD1kLmNvbmNhdCh0aGlzLmdldExvZ1RpY2tQb3NpdGlvbnMoYyxiW2UtMV0sYltlXSwhMCkpfWVsc2UgaWYodGhpcy5pc0RhdGV0aW1lQXhpcyYmYS5taW5vclRpY2tJbnRlcnZhbD09PVwiYXV0b1wiKWQ9ZC5jb25jYXQodGhpcy5nZXRUaW1lVGlja3ModGhpcy5ub3JtYWxpemVUaW1lVGlja0ludGVydmFsKGMpLGUsZixhLnN0YXJ0T2ZXZWVrKSk7ZWxzZSBmb3IoYj1lKyhiWzBdLWUpJWM7Yjw9ZjtiKz1jKWQucHVzaChiKTtkLmxlbmd0aCE9PVxuMCYmdGhpcy50cmltVGlja3MoZCxhLnN0YXJ0T25UaWNrLGEuZW5kT25UaWNrKTtyZXR1cm4gZH0sYWRqdXN0Rm9yTWluUmFuZ2U6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9wdGlvbnMsYj10aGlzLm1pbixjPXRoaXMubWF4LGQsZT10aGlzLmRhdGFNYXgtdGhpcy5kYXRhTWluPj10aGlzLm1pblJhbmdlLGYsZyxoLGksaixrO2lmKHRoaXMuaXNYQXhpcyYmdGhpcy5taW5SYW5nZT09PXQmJiF0aGlzLmlzTG9nKXYoYS5taW4pfHx2KGEubWF4KT90aGlzLm1pblJhbmdlPW51bGw6KG8odGhpcy5zZXJpZXMsZnVuY3Rpb24oYSl7aT1hLnhEYXRhO2ZvcihnPWo9YS54SW5jcmVtZW50PzE6aS5sZW5ndGgtMTtnPjA7Zy0tKWlmKGg9aVtnXS1pW2ctMV0sZj09PXR8fGg8ZilmPWh9KSx0aGlzLm1pblJhbmdlPUcoZio1LHRoaXMuZGF0YU1heC10aGlzLmRhdGFNaW4pKTtpZihjLWI8dGhpcy5taW5SYW5nZSl7az10aGlzLm1pblJhbmdlO2Q9KGstYytiKS8yO2Q9W2ItZCxxKGEubWluLGItZCldO1xuaWYoZSlkWzJdPXRoaXMuZGF0YU1pbjtiPURhKGQpO2M9W2IrayxxKGEubWF4LGIrayldO2lmKGUpY1syXT10aGlzLmRhdGFNYXg7Yz1NYShjKTtjLWI8ayYmKGRbMF09Yy1rLGRbMV09cShhLm1pbixjLWspLGI9RGEoZCkpfXRoaXMubWluPWI7dGhpcy5tYXg9Y30sZ2V0Q2xvc2VzdDpmdW5jdGlvbigpe3ZhciBhO28odGhpcy5zZXJpZXMsZnVuY3Rpb24oYil7dmFyIGM9Yi5jbG9zZXN0UG9pbnRSYW5nZTshYi5ub1NoYXJlZFRvb2x0aXAmJnYoYykmJihhPXYoYSk/RyhhLGMpOmMpfSk7cmV0dXJuIGF9LHNldEF4aXNUcmFuc2xhdGlvbjpmdW5jdGlvbihhKXt2YXIgYj10aGlzLGM9Yi5tYXgtYi5taW4sZD1iLmF4aXNQb2ludFJhbmdlfHwwLGUsZj0wLGc9MCxoPWIubGlua2VkUGFyZW50LGk9ISFiLmNhdGVnb3JpZXMsaj1iLnRyYW5zQSxrPWIuaXNYQXhpcztpZihrfHxpfHxkKWlmKGg/KGY9aC5taW5Qb2ludE9mZnNldCxnPWgucG9pbnRSYW5nZVBhZGRpbmcpOihlPWIuZ2V0Q2xvc2VzdCgpLFxubyhiLnNlcmllcyxmdW5jdGlvbihhKXt2YXIgYz1pPzE6az9xKGEub3B0aW9ucy5wb2ludFJhbmdlLGUsMCk6Yi5heGlzUG9pbnRSYW5nZXx8MCxhPWEub3B0aW9ucy5wb2ludFBsYWNlbWVudDtkPXcoZCxjKTtiLnNpbmdsZXx8KGY9dyhmLENhKGEpPzA6Yy8yKSxnPXcoZyxhPT09XCJvblwiPzA6YykpfSkpLGg9Yi5vcmRpbmFsU2xvcGUmJmU/Yi5vcmRpbmFsU2xvcGUvZToxLGIubWluUG9pbnRPZmZzZXQ9Zio9aCxiLnBvaW50UmFuZ2VQYWRkaW5nPWcqPWgsYi5wb2ludFJhbmdlPUcoZCxjKSxrKWIuY2xvc2VzdFBvaW50UmFuZ2U9ZTtpZihhKWIub2xkVHJhbnNBPWo7Yi50cmFuc2xhdGlvblNsb3BlPWIudHJhbnNBPWo9Yi5sZW4vKGMrZ3x8MSk7Yi50cmFuc0I9Yi5ob3Jpej9iLmxlZnQ6Yi5ib3R0b207Yi5taW5QaXhlbFBhZGRpbmc9aipmfSxtaW5Gcm9tUmFuZ2U6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tYXgtdGhpcy5yYW5nZX0sc2V0VGlja0ludGVydmFsOmZ1bmN0aW9uKGEpe3ZhciBiPVxudGhpcyxjPWIuY2hhcnQsZD1iLm9wdGlvbnMsZT1iLmlzTG9nLGY9Yi5sb2cybGluLGc9Yi5pc0RhdGV0aW1lQXhpcyxoPWIuaXNYQXhpcyxpPWIuaXNMaW5rZWQsaj1kLm1heFBhZGRpbmcsaz1kLm1pblBhZGRpbmcsbD1kLnRpY2tJbnRlcnZhbCxtPWQudGlja1BpeGVsSW50ZXJ2YWwsbj1iLmNhdGVnb3JpZXMscD1iLnRocmVzaG9sZCxyPWIuc29mdFRocmVzaG9sZCxzLEYsdSx4OyFnJiYhbiYmIWkmJnRoaXMuZ2V0VGlja0Ftb3VudCgpO3U9cShiLnVzZXJNaW4sZC5taW4pO3g9cShiLnVzZXJNYXgsZC5tYXgpO2k/KGIubGlua2VkUGFyZW50PWNbYi5jb2xsXVtkLmxpbmtlZFRvXSxjPWIubGlua2VkUGFyZW50LmdldEV4dHJlbWVzKCksYi5taW49cShjLm1pbixjLmRhdGFNaW4pLGIubWF4PXEoYy5tYXgsYy5kYXRhTWF4KSxkLnR5cGUhPT1iLmxpbmtlZFBhcmVudC5vcHRpb25zLnR5cGUmJmdhKDExLDEpKTooIXImJnYocCkmJihiLmRhdGFNaW4+PXA/KHM9cCxrPTApOmIuZGF0YU1heDw9XG5wJiYoRj1wLGo9MCkpLGIubWluPXEodSxzLGIuZGF0YU1pbiksYi5tYXg9cSh4LEYsYi5kYXRhTWF4KSk7aWYoZSkhYSYmRyhiLm1pbixxKGIuZGF0YU1pbixiLm1pbikpPD0wJiZnYSgxMCwxKSxiLm1pbj1rYShmKGIubWluKSwxNSksYi5tYXg9a2EoZihiLm1heCksMTUpO2lmKGIucmFuZ2UmJnYoYi5tYXgpKWIudXNlck1pbj1iLm1pbj11PXcoYi5taW4sYi5taW5Gcm9tUmFuZ2UoKSksYi51c2VyTWF4PXg9Yi5tYXgsYi5yYW5nZT1udWxsO08oYixcImZvdW5kRXh0cmVtZXNcIik7Yi5iZWZvcmVQYWRkaW5nJiZiLmJlZm9yZVBhZGRpbmcoKTtiLmFkanVzdEZvck1pblJhbmdlKCk7aWYoIW4mJiFiLmF4aXNQb2ludFJhbmdlJiYhYi51c2VQZXJjZW50YWdlJiYhaSYmdihiLm1pbikmJnYoYi5tYXgpJiYoZj1iLm1heC1iLm1pbikpIXYodSkmJmsmJihiLm1pbi09ZiprKSwhdih4KSYmaiYmKGIubWF4Kz1mKmopO2lmKEMoZC5mbG9vcikpYi5taW49dyhiLm1pbixkLmZsb29yKTtpZihDKGQuY2VpbGluZykpYi5tYXg9XG5HKGIubWF4LGQuY2VpbGluZyk7aWYociYmdihiLmRhdGFNaW4pKWlmKHA9cHx8MCwhdih1KSYmYi5taW48cCYmYi5kYXRhTWluPj1wKWIubWluPXA7ZWxzZSBpZighdih4KSYmYi5tYXg+cCYmYi5kYXRhTWF4PD1wKWIubWF4PXA7Yi50aWNrSW50ZXJ2YWw9Yi5taW49PT1iLm1heHx8Yi5taW49PT12b2lkIDB8fGIubWF4PT09dm9pZCAwPzE6aSYmIWwmJm09PT1iLmxpbmtlZFBhcmVudC5vcHRpb25zLnRpY2tQaXhlbEludGVydmFsP2w9Yi5saW5rZWRQYXJlbnQudGlja0ludGVydmFsOnEobCx0aGlzLnRpY2tBbW91bnQ/KGIubWF4LWIubWluKS93KHRoaXMudGlja0Ftb3VudC0xLDEpOnZvaWQgMCxuPzE6KGIubWF4LWIubWluKSptL3coYi5sZW4sbSkpO2gmJiFhJiZvKGIuc2VyaWVzLGZ1bmN0aW9uKGEpe2EucHJvY2Vzc0RhdGEoYi5taW4hPT1iLm9sZE1pbnx8Yi5tYXghPT1iLm9sZE1heCl9KTtiLnNldEF4aXNUcmFuc2xhdGlvbighMCk7Yi5iZWZvcmVTZXRUaWNrUG9zaXRpb25zJiZcbmIuYmVmb3JlU2V0VGlja1Bvc2l0aW9ucygpO2lmKGIucG9zdFByb2Nlc3NUaWNrSW50ZXJ2YWwpYi50aWNrSW50ZXJ2YWw9Yi5wb3N0UHJvY2Vzc1RpY2tJbnRlcnZhbChiLnRpY2tJbnRlcnZhbCk7aWYoYi5wb2ludFJhbmdlJiYhbCliLnRpY2tJbnRlcnZhbD13KGIucG9pbnRSYW5nZSxiLnRpY2tJbnRlcnZhbCk7YT1xKGQubWluVGlja0ludGVydmFsLGIuaXNEYXRldGltZUF4aXMmJmIuY2xvc2VzdFBvaW50UmFuZ2UpO2lmKCFsJiZiLnRpY2tJbnRlcnZhbDxhKWIudGlja0ludGVydmFsPWE7aWYoIWcmJiFlJiYhbCliLnRpY2tJbnRlcnZhbD1BYihiLnRpY2tJbnRlcnZhbCxudWxsLHpiKGIudGlja0ludGVydmFsKSxxKGQuYWxsb3dEZWNpbWFscywhKGIudGlja0ludGVydmFsPjAuNSYmYi50aWNrSW50ZXJ2YWw8NSYmYi5tYXg+MUUzJiZiLm1heDw5OTk5KSksISF0aGlzLnRpY2tBbW91bnQpO2lmKCF0aGlzLnRpY2tBbW91bnQmJnRoaXMubGVuKWIudGlja0ludGVydmFsPWIudW5zcXVpc2goKTtcbnRoaXMuc2V0VGlja1Bvc2l0aW9ucygpfSxzZXRUaWNrUG9zaXRpb25zOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcHRpb25zLGIsYz1hLnRpY2tQb3NpdGlvbnMsZD1hLnRpY2tQb3NpdGlvbmVyLGU9YS5zdGFydE9uVGljayxmPWEuZW5kT25UaWNrLGc7dGhpcy50aWNrbWFya09mZnNldD10aGlzLmNhdGVnb3JpZXMmJmEudGlja21hcmtQbGFjZW1lbnQ9PT1cImJldHdlZW5cIiYmdGhpcy50aWNrSW50ZXJ2YWw9PT0xPzAuNTowO3RoaXMubWlub3JUaWNrSW50ZXJ2YWw9YS5taW5vclRpY2tJbnRlcnZhbD09PVwiYXV0b1wiJiZ0aGlzLnRpY2tJbnRlcnZhbD90aGlzLnRpY2tJbnRlcnZhbC81OmEubWlub3JUaWNrSW50ZXJ2YWw7dGhpcy50aWNrUG9zaXRpb25zPWI9YyYmYy5zbGljZSgpO2lmKCFiJiYoYj10aGlzLmlzRGF0ZXRpbWVBeGlzP3RoaXMuZ2V0VGltZVRpY2tzKHRoaXMubm9ybWFsaXplVGltZVRpY2tJbnRlcnZhbCh0aGlzLnRpY2tJbnRlcnZhbCxhLnVuaXRzKSx0aGlzLm1pbixcbnRoaXMubWF4LGEuc3RhcnRPZldlZWssdGhpcy5vcmRpbmFsUG9zaXRpb25zLHRoaXMuY2xvc2VzdFBvaW50UmFuZ2UsITApOnRoaXMuaXNMb2c/dGhpcy5nZXRMb2dUaWNrUG9zaXRpb25zKHRoaXMudGlja0ludGVydmFsLHRoaXMubWluLHRoaXMubWF4KTp0aGlzLmdldExpbmVhclRpY2tQb3NpdGlvbnModGhpcy50aWNrSW50ZXJ2YWwsdGhpcy5taW4sdGhpcy5tYXgpLGIubGVuZ3RoPnRoaXMubGVuJiYoYj1bYlswXSxiLnBvcCgpXSksdGhpcy50aWNrUG9zaXRpb25zPWIsZCYmKGQ9ZC5hcHBseSh0aGlzLFt0aGlzLm1pbix0aGlzLm1heF0pKSkpdGhpcy50aWNrUG9zaXRpb25zPWI9ZDtpZighdGhpcy5pc0xpbmtlZCl0aGlzLnRyaW1UaWNrcyhiLGUsZiksdGhpcy5taW49PT10aGlzLm1heCYmdih0aGlzLm1pbikmJiF0aGlzLnRpY2tBbW91bnQmJihnPSEwLHRoaXMubWluLT0wLjUsdGhpcy5tYXgrPTAuNSksdGhpcy5zaW5nbGU9ZywhYyYmIWQmJnRoaXMuYWRqdXN0VGlja0Ftb3VudCgpfSxcbnRyaW1UaWNrczpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9YVswXSxlPWFbYS5sZW5ndGgtMV0sZj10aGlzLm1pblBvaW50T2Zmc2V0fHwwO2lmKGIpdGhpcy5taW49ZDtlbHNlIGZvcig7dGhpcy5taW4tZj5hWzBdOylhLnNoaWZ0KCk7aWYoYyl0aGlzLm1heD1lO2Vsc2UgZm9yKDt0aGlzLm1heCtmPGFbYS5sZW5ndGgtMV07KWEucG9wKCk7YS5sZW5ndGg9PT0wJiZ2KGQpJiZhLnB1c2goKGUrZCkvMil9LGFsaWduVG9PdGhlcnM6ZnVuY3Rpb24oKXt2YXIgYT17fSxiLGM9dGhpcy5vcHRpb25zO3RoaXMuY2hhcnQub3B0aW9ucy5jaGFydC5hbGlnblRpY2tzIT09ITEmJmMuYWxpZ25UaWNrcyE9PSExJiZvKHRoaXMuY2hhcnRbdGhpcy5jb2xsXSxmdW5jdGlvbihjKXt2YXIgZT1jLm9wdGlvbnMsZT1bYy5ob3Jpej9lLmxlZnQ6ZS50b3AsZS53aWR0aCxlLmhlaWdodCxlLnBhbmVdLmpvaW4oXCIsXCIpO2Muc2VyaWVzLmxlbmd0aCYmKGFbZV0/Yj0hMDphW2VdPTEpfSk7cmV0dXJuIGJ9LGdldFRpY2tBbW91bnQ6ZnVuY3Rpb24oKXt2YXIgYT1cbnRoaXMub3B0aW9ucyxiPWEudGlja0Ftb3VudCxjPWEudGlja1BpeGVsSW50ZXJ2YWw7IXYoYS50aWNrSW50ZXJ2YWwpJiZ0aGlzLmxlbjxjJiYhdGhpcy5pc1JhZGlhbCYmIXRoaXMuaXNMb2cmJmEuc3RhcnRPblRpY2smJmEuZW5kT25UaWNrJiYoYj0yKTshYiYmdGhpcy5hbGlnblRvT3RoZXJzKCkmJihiPUVhKHRoaXMubGVuL2MpKzEpO2lmKGI8NCl0aGlzLmZpbmFsVGlja0FtdD1iLGI9NTt0aGlzLnRpY2tBbW91bnQ9Yn0sYWRqdXN0VGlja0Ftb3VudDpmdW5jdGlvbigpe3ZhciBhPXRoaXMudGlja0ludGVydmFsLGI9dGhpcy50aWNrUG9zaXRpb25zLGM9dGhpcy50aWNrQW1vdW50LGQ9dGhpcy5maW5hbFRpY2tBbXQsZT1iJiZiLmxlbmd0aDtpZihlPGMpe2Zvcig7Yi5sZW5ndGg8YzspYi5wdXNoKGthKGJbYi5sZW5ndGgtMV0rYSkpO3RoaXMudHJhbnNBKj0oZS0xKS8oYy0xKTt0aGlzLm1heD1iW2IubGVuZ3RoLTFdfWVsc2UgZT5jJiYodGhpcy50aWNrSW50ZXJ2YWwqPTIsdGhpcy5zZXRUaWNrUG9zaXRpb25zKCkpO1xuaWYodihkKSl7Zm9yKGE9Yz1iLmxlbmd0aDthLS07KShkPT09MyYmYSUyPT09MXx8ZDw9MiYmYT4wJiZhPGMtMSkmJmIuc3BsaWNlKGEsMSk7dGhpcy5maW5hbFRpY2tBbXQ9dH19LHNldFNjYWxlOmZ1bmN0aW9uKCl7dmFyIGEsYjt0aGlzLm9sZE1pbj10aGlzLm1pbjt0aGlzLm9sZE1heD10aGlzLm1heDt0aGlzLm9sZEF4aXNMZW5ndGg9dGhpcy5sZW47dGhpcy5zZXRBeGlzU2l6ZSgpO2I9dGhpcy5sZW4hPT10aGlzLm9sZEF4aXNMZW5ndGg7byh0aGlzLnNlcmllcyxmdW5jdGlvbihiKXtpZihiLmlzRGlydHlEYXRhfHxiLmlzRGlydHl8fGIueEF4aXMuaXNEaXJ0eSlhPSEwfSk7aWYoYnx8YXx8dGhpcy5pc0xpbmtlZHx8dGhpcy5mb3JjZVJlZHJhd3x8dGhpcy51c2VyTWluIT09dGhpcy5vbGRVc2VyTWlufHx0aGlzLnVzZXJNYXghPT10aGlzLm9sZFVzZXJNYXh8fHRoaXMuYWxpZ25Ub090aGVycygpKXtpZih0aGlzLnJlc2V0U3RhY2tzJiZ0aGlzLnJlc2V0U3RhY2tzKCksdGhpcy5mb3JjZVJlZHJhdz1cbiExLHRoaXMuZ2V0U2VyaWVzRXh0cmVtZXMoKSx0aGlzLnNldFRpY2tJbnRlcnZhbCgpLHRoaXMub2xkVXNlck1pbj10aGlzLnVzZXJNaW4sdGhpcy5vbGRVc2VyTWF4PXRoaXMudXNlck1heCwhdGhpcy5pc0RpcnR5KXRoaXMuaXNEaXJ0eT1ifHx0aGlzLm1pbiE9PXRoaXMub2xkTWlufHx0aGlzLm1heCE9PXRoaXMub2xkTWF4fWVsc2UgdGhpcy5jbGVhblN0YWNrcyYmdGhpcy5jbGVhblN0YWNrcygpfSxzZXRFeHRyZW1lczpmdW5jdGlvbihhLGIsYyxkLGUpe3ZhciBmPXRoaXMsZz1mLmNoYXJ0LGM9cShjLCEwKTtvKGYuc2VyaWVzLGZ1bmN0aW9uKGEpe2RlbGV0ZSBhLmtkVHJlZX0pO2U9QShlLHttaW46YSxtYXg6Yn0pO08oZixcInNldEV4dHJlbWVzXCIsZSxmdW5jdGlvbigpe2YudXNlck1pbj1hO2YudXNlck1heD1iO2YuZXZlbnRBcmdzPWU7YyYmZy5yZWRyYXcoZCl9KX0sem9vbTpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuZGF0YU1pbixkPXRoaXMuZGF0YU1heCxlPXRoaXMub3B0aW9ucyxcbmY9RyhjLHEoZS5taW4sYykpLGU9dyhkLHEoZS5tYXgsZCkpO3RoaXMuYWxsb3dab29tT3V0c2lkZXx8KHYoYykmJmE8PWYmJihhPWYpLHYoZCkmJmI+PWUmJihiPWUpKTt0aGlzLmRpc3BsYXlCdG49YSE9PXR8fGIhPT10O3RoaXMuc2V0RXh0cmVtZXMoYSxiLCExLHQse3RyaWdnZXI6XCJ6b29tXCJ9KTtyZXR1cm4hMH0sc2V0QXhpc1NpemU6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmNoYXJ0LGI9dGhpcy5vcHRpb25zLGM9Yi5vZmZzZXRMZWZ0fHwwLGQ9dGhpcy5ob3JpeixlPXEoYi53aWR0aCxhLnBsb3RXaWR0aC1jKyhiLm9mZnNldFJpZ2h0fHwwKSksZj1xKGIuaGVpZ2h0LGEucGxvdEhlaWdodCksZz1xKGIudG9wLGEucGxvdFRvcCksYj1xKGIubGVmdCxhLnBsb3RMZWZ0K2MpLGM9LyUkLztjLnRlc3QoZikmJihmPU1hdGgucm91bmQocGFyc2VGbG9hdChmKS8xMDAqYS5wbG90SGVpZ2h0KSk7Yy50ZXN0KGcpJiYoZz1NYXRoLnJvdW5kKHBhcnNlRmxvYXQoZykvMTAwKmEucGxvdEhlaWdodCtcbmEucGxvdFRvcCkpO3RoaXMubGVmdD1iO3RoaXMudG9wPWc7dGhpcy53aWR0aD1lO3RoaXMuaGVpZ2h0PWY7dGhpcy5ib3R0b209YS5jaGFydEhlaWdodC1mLWc7dGhpcy5yaWdodD1hLmNoYXJ0V2lkdGgtZS1iO3RoaXMubGVuPXcoZD9lOmYsMCk7dGhpcy5wb3M9ZD9iOmd9LGdldEV4dHJlbWVzOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5pc0xvZyxiPXRoaXMubGluMmxvZztyZXR1cm57bWluOmE/a2EoYih0aGlzLm1pbikpOnRoaXMubWluLG1heDphP2thKGIodGhpcy5tYXgpKTp0aGlzLm1heCxkYXRhTWluOnRoaXMuZGF0YU1pbixkYXRhTWF4OnRoaXMuZGF0YU1heCx1c2VyTWluOnRoaXMudXNlck1pbix1c2VyTWF4OnRoaXMudXNlck1heH19LGdldFRocmVzaG9sZDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmlzTG9nLGM9dGhpcy5saW4ybG9nLGQ9Yj9jKHRoaXMubWluKTp0aGlzLm1pbixiPWI/Yyh0aGlzLm1heCk6dGhpcy5tYXg7YT09PW51bGw/YT1iPDA/YjpkOmQ+YT9hPWQ6YjxcbmEmJihhPWIpO3JldHVybiB0aGlzLnRyYW5zbGF0ZShhLDAsMSwwLDEpfSxhdXRvTGFiZWxBbGlnbjpmdW5jdGlvbihhKXthPShxKGEsMCktdGhpcy5zaWRlKjkwKzcyMCklMzYwO3JldHVybiBhPjE1JiZhPDE2NT9cInJpZ2h0XCI6YT4xOTUmJmE8MzQ1P1wibGVmdFwiOlwiY2VudGVyXCJ9LHRpY2tTaXplOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMub3B0aW9ucyxjPWJbYStcIkxlbmd0aFwiXSxkPXEoYlthK1wiV2lkdGhcIl0sYT09PVwidGlja1wiJiZ0aGlzLmlzWEF4aXM/MTowKTtpZihkJiZjKXJldHVybiBiW2ErXCJQb3NpdGlvblwiXT09PVwiaW5zaWRlXCImJihjPS1jKSxbYyxkXX0sbGFiZWxNZXRyaWNzOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY2hhcnQucmVuZGVyZXIuZm9udE1ldHJpY3ModGhpcy5vcHRpb25zLmxhYmVscy5zdHlsZS5mb250U2l6ZSx0aGlzLnRpY2tzWzBdJiZ0aGlzLnRpY2tzWzBdLmxhYmVsKX0sdW5zcXVpc2g6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9wdGlvbnMubGFiZWxzLGI9XG50aGlzLmhvcml6LGM9dGhpcy50aWNrSW50ZXJ2YWwsZD1jLGU9dGhpcy5sZW4vKCgodGhpcy5jYXRlZ29yaWVzPzE6MCkrdGhpcy5tYXgtdGhpcy5taW4pL2MpLGYsZz1hLnJvdGF0aW9uLGg9dGhpcy5sYWJlbE1ldHJpY3MoKSxpLGo9TnVtYmVyLk1BWF9WQUxVRSxrLGw9ZnVuY3Rpb24oYSl7YS89ZXx8MTthPWE+MT9FYShhKToxO3JldHVybiBhKmN9O2I/KGs9IWEuc3RhZ2dlckxpbmVzJiYhYS5zdGVwJiYodihnKT9bZ106ZTxxKGEuYXV0b1JvdGF0aW9uTGltaXQsODApJiZhLmF1dG9Sb3RhdGlvbikpJiZvKGssZnVuY3Rpb24oYSl7dmFyIGI7aWYoYT09PWd8fGEmJmE+PS05MCYmYTw9OTApaT1sKFMoaC5oL2xhKHBhKmEpKSksYj1pK1MoYS8zNjApLGI8aiYmKGo9YixmPWEsZD1pKX0pOmEuc3RlcHx8KGQ9bChoLmgpKTt0aGlzLmF1dG9Sb3RhdGlvbj1rO3RoaXMubGFiZWxSb3RhdGlvbj1xKGYsZyk7cmV0dXJuIGR9LGdldFNsb3RXaWR0aDpmdW5jdGlvbigpe3ZhciBhPXRoaXMuY2hhcnQsXG5iPXRoaXMuaG9yaXosYz10aGlzLm9wdGlvbnMubGFiZWxzLGQ9TWF0aC5tYXgodGhpcy50aWNrUG9zaXRpb25zLmxlbmd0aC0odGhpcy5jYXRlZ29yaWVzPzA6MSksMSksZT1hLm1hcmdpblszXTtyZXR1cm4gYiYmKGMuc3RlcHx8MCk8MiYmIWMucm90YXRpb24mJih0aGlzLnN0YWdnZXJMaW5lc3x8MSkqYS5wbG90V2lkdGgvZHx8IWImJihlJiZlLWEuc3BhY2luZ1szXXx8YS5jaGFydFdpZHRoKjAuMzMpfSxyZW5kZXJVbnNxdWlzaDpmdW5jdGlvbigpe3ZhciBhPXRoaXMuY2hhcnQsYj1hLnJlbmRlcmVyLGM9dGhpcy50aWNrUG9zaXRpb25zLGQ9dGhpcy50aWNrcyxlPXRoaXMub3B0aW9ucy5sYWJlbHMsZj10aGlzLmhvcml6LGc9dGhpcy5nZXRTbG90V2lkdGgoKSxoPXcoMSx5KGctMiooZS5wYWRkaW5nfHw1KSkpLGk9e30saj10aGlzLmxhYmVsTWV0cmljcygpLGs9ZS5zdHlsZS50ZXh0T3ZlcmZsb3csbCxtPTAsbixwO2lmKCFDYShlLnJvdGF0aW9uKSlpLnJvdGF0aW9uPWUucm90YXRpb258fFxuMDtpZih0aGlzLmF1dG9Sb3RhdGlvbilvKGMsZnVuY3Rpb24oYSl7aWYoKGE9ZFthXSkmJmEubGFiZWxMZW5ndGg+bSltPWEubGFiZWxMZW5ndGh9KSxtPmgmJm0+ai5oP2kucm90YXRpb249dGhpcy5sYWJlbFJvdGF0aW9uOnRoaXMubGFiZWxSb3RhdGlvbj0wO2Vsc2UgaWYoZyYmKGw9e3dpZHRoOmgrXCJweFwifSwhaykpe2wudGV4dE92ZXJmbG93PVwiY2xpcFwiO2ZvcihuPWMubGVuZ3RoOyFmJiZuLS07KWlmKHA9Y1tuXSxoPWRbcF0ubGFiZWwpaWYoaC5zdHlsZXMudGV4dE92ZXJmbG93PT09XCJlbGxpcHNpc1wiP2guY3NzKHt0ZXh0T3ZlcmZsb3c6XCJjbGlwXCJ9KTpkW3BdLmxhYmVsTGVuZ3RoPmcmJmguY3NzKHt3aWR0aDpnK1wicHhcIn0pLGguZ2V0QkJveCgpLmhlaWdodD50aGlzLmxlbi9jLmxlbmd0aC0oai5oLWouZikpaC5zcGVjQ3NzPXt0ZXh0T3ZlcmZsb3c6XCJlbGxpcHNpc1wifX1pZihpLnJvdGF0aW9uJiYobD17d2lkdGg6KG0+YS5jaGFydEhlaWdodCowLjU/YS5jaGFydEhlaWdodCpcbjAuMzM6YS5jaGFydEhlaWdodCkrXCJweFwifSwhaykpbC50ZXh0T3ZlcmZsb3c9XCJlbGxpcHNpc1wiO2lmKHRoaXMubGFiZWxBbGlnbj1lLmFsaWdufHx0aGlzLmF1dG9MYWJlbEFsaWduKHRoaXMubGFiZWxSb3RhdGlvbikpaS5hbGlnbj10aGlzLmxhYmVsQWxpZ247byhjLGZ1bmN0aW9uKGEpe3ZhciBiPShhPWRbYV0pJiZhLmxhYmVsO2lmKGIpYi5hdHRyKGkpLGwmJmIuY3NzKHoobCxiLnNwZWNDc3MpKSxkZWxldGUgYi5zcGVjQ3NzLGEucm90YXRpb249aS5yb3RhdGlvbn0pO3RoaXMudGlja1JvdENvcnI9Yi5yb3RDb3JyKGouYix0aGlzLmxhYmVsUm90YXRpb258fDAsdGhpcy5zaWRlIT09MCl9LGhhc0RhdGE6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5oYXNWaXNpYmxlU2VyaWVzfHx2KHRoaXMubWluKSYmdih0aGlzLm1heCkmJiEhdGhpcy50aWNrUG9zaXRpb25zfSxnZXRPZmZzZXQ6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5jaGFydCxjPWIucmVuZGVyZXIsZD1hLm9wdGlvbnMsXG5lPWEudGlja1Bvc2l0aW9ucyxmPWEudGlja3MsZz1hLmhvcml6LGg9YS5zaWRlLGk9Yi5pbnZlcnRlZD9bMSwwLDMsMl1baF06aCxqLGssbD0wLG0sbj0wLHA9ZC50aXRsZSxyPWQubGFiZWxzLHM9MCxGPWEub3Bwb3NpdGUsdT1iLmF4aXNPZmZzZXQsYj1iLmNsaXBPZmZzZXQseD1bLTEsMSwxLC0xXVtoXSxELFE9YS5heGlzUGFyZW50LGhhPXRoaXMudGlja1NpemUoXCJ0aWNrXCIpO2o9YS5oYXNEYXRhKCk7YS5zaG93QXhpcz1rPWp8fHEoZC5zaG93RW1wdHksITApO2Euc3RhZ2dlckxpbmVzPWEuaG9yaXomJnIuc3RhZ2dlckxpbmVzO2lmKCFhLmF4aXNHcm91cClhLmdyaWRHcm91cD1jLmcoXCJncmlkXCIpLmF0dHIoe3pJbmRleDpkLmdyaWRaSW5kZXh8fDF9KS5hZGQoUSksYS5heGlzR3JvdXA9Yy5nKFwiYXhpc1wiKS5hdHRyKHt6SW5kZXg6ZC56SW5kZXh8fDJ9KS5hZGQoUSksYS5sYWJlbEdyb3VwPWMuZyhcImF4aXMtbGFiZWxzXCIpLmF0dHIoe3pJbmRleDpyLnpJbmRleHx8N30pLmFkZENsYXNzKFwiaGlnaGNoYXJ0cy1cIitcbmEuY29sbC50b0xvd2VyQ2FzZSgpK1wiLWxhYmVsc1wiKS5hZGQoUSk7aWYoanx8YS5pc0xpbmtlZCl7aWYobyhlLGZ1bmN0aW9uKGIpe2ZbYl0/ZltiXS5hZGRMYWJlbCgpOmZbYl09bmV3IGJiKGEsYil9KSxhLnJlbmRlclVuc3F1aXNoKCksci5yZXNlcnZlU3BhY2UhPT0hMSYmKGg9PT0wfHxoPT09Mnx8ezE6XCJsZWZ0XCIsMzpcInJpZ2h0XCJ9W2hdPT09YS5sYWJlbEFsaWdufHxhLmxhYmVsQWxpZ249PT1cImNlbnRlclwiKSYmbyhlLGZ1bmN0aW9uKGEpe3M9dyhmW2FdLmdldExhYmVsU2l6ZSgpLHMpfSksYS5zdGFnZ2VyTGluZXMpcyo9YS5zdGFnZ2VyTGluZXMsYS5sYWJlbE9mZnNldD1zKihhLm9wcG9zaXRlPy0xOjEpfWVsc2UgZm9yKEQgaW4gZilmW0RdLmRlc3Ryb3koKSxkZWxldGUgZltEXTtpZihwJiZwLnRleHQmJnAuZW5hYmxlZCE9PSExKXtpZighYS5heGlzVGl0bGUpKEQ9cC50ZXh0QWxpZ24pfHwoRD0oZz97bG93OlwibGVmdFwiLG1pZGRsZTpcImNlbnRlclwiLGhpZ2g6XCJyaWdodFwifTpcbntsb3c6Rj9cInJpZ2h0XCI6XCJsZWZ0XCIsbWlkZGxlOlwiY2VudGVyXCIsaGlnaDpGP1wibGVmdFwiOlwicmlnaHRcIn0pW3AuYWxpZ25dKSxhLmF4aXNUaXRsZT1jLnRleHQocC50ZXh0LDAsMCxwLnVzZUhUTUwpLmF0dHIoe3pJbmRleDo3LHJvdGF0aW9uOnAucm90YXRpb258fDAsYWxpZ246RH0pLmFkZENsYXNzKFwiaGlnaGNoYXJ0cy1cIit0aGlzLmNvbGwudG9Mb3dlckNhc2UoKStcIi10aXRsZVwiKS5jc3MocC5zdHlsZSkuYWRkKGEuYXhpc0dyb3VwKSxhLmF4aXNUaXRsZS5pc05ldz0hMDtpZihrKWw9YS5heGlzVGl0bGUuZ2V0QkJveCgpW2c/XCJoZWlnaHRcIjpcIndpZHRoXCJdLG09cC5vZmZzZXQsbj12KG0pPzA6cShwLm1hcmdpbixnPzU6MTApO2EuYXhpc1RpdGxlW2s/XCJzaG93XCI6XCJoaWRlXCJdKCEwKX1hLm9mZnNldD14KnEoZC5vZmZzZXQsdVtoXSk7YS50aWNrUm90Q29ycj1hLnRpY2tSb3RDb3JyfHx7eDowLHk6MH07Yz1oPT09MD8tYS5sYWJlbE1ldHJpY3MoKS5oOmg9PT0yP2EudGlja1JvdENvcnIueTpcbjA7bj1NYXRoLmFicyhzKStuO3MmJihuLT1jLG4rPXgqKGc/cShyLnksYS50aWNrUm90Q29yci55K3gqOCk6ci54KSk7YS5heGlzVGl0bGVNYXJnaW49cShtLG4pO3VbaF09dyh1W2hdLGEuYXhpc1RpdGxlTWFyZ2luK2wreCphLm9mZnNldCxuLGomJmUubGVuZ3RoJiZoYT9oYVswXTowKTtkPWQub2Zmc2V0PzA6VihkLmxpbmVXaWR0aC8yKSoyO2JbaV09dyhiW2ldLGQpfSxnZXRMaW5lUGF0aDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNoYXJ0LGM9dGhpcy5vcHBvc2l0ZSxkPXRoaXMub2Zmc2V0LGU9dGhpcy5ob3JpeixmPXRoaXMubGVmdCsoYz90aGlzLndpZHRoOjApK2QsZD1iLmNoYXJ0SGVpZ2h0LXRoaXMuYm90dG9tLShjP3RoaXMuaGVpZ2h0OjApK2Q7YyYmKGEqPS0xKTtyZXR1cm4gYi5yZW5kZXJlci5jcmlzcExpbmUoW1wiTVwiLGU/dGhpcy5sZWZ0OmYsZT9kOnRoaXMudG9wLFwiTFwiLGU/Yi5jaGFydFdpZHRoLXRoaXMucmlnaHQ6ZixlP2Q6Yi5jaGFydEhlaWdodC10aGlzLmJvdHRvbV0sXG5hKX0sZ2V0VGl0bGVQb3NpdGlvbjpmdW5jdGlvbigpe3ZhciBhPXRoaXMuaG9yaXosYj10aGlzLmxlZnQsYz10aGlzLnRvcCxkPXRoaXMubGVuLGU9dGhpcy5vcHRpb25zLnRpdGxlLGY9YT9iOmMsZz10aGlzLm9wcG9zaXRlLGg9dGhpcy5vZmZzZXQsaT1lLnh8fDAsaj1lLnl8fDAsaz1LKGUuc3R5bGUuZm9udFNpemV8fDEyKSxkPXtsb3c6ZisoYT8wOmQpLG1pZGRsZTpmK2QvMixoaWdoOmYrKGE/ZDowKX1bZS5hbGlnbl0sYj0oYT9jK3RoaXMuaGVpZ2h0OmIpKyhhPzE6LTEpKihnPy0xOjEpKnRoaXMuYXhpc1RpdGxlTWFyZ2luKyh0aGlzLnNpZGU9PT0yP2s6MCk7cmV0dXJue3g6YT9kK2k6YisoZz90aGlzLndpZHRoOjApK2graSx5OmE/YitqLShnP3RoaXMuaGVpZ2h0OjApK2g6ZCtqfX0scmVuZGVyOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEuY2hhcnQsYz1iLnJlbmRlcmVyLGQ9YS5vcHRpb25zLGU9YS5pc0xvZyxmPWEubGluMmxvZyxnPWEuaXNMaW5rZWQsaD1hLnRpY2tQb3NpdGlvbnMsXG5pPWEuYXhpc1RpdGxlLGo9YS50aWNrcyxrPWEubWlub3JUaWNrcyxsPWEuYWx0ZXJuYXRlQmFuZHMsbT1kLnN0YWNrTGFiZWxzLG49ZC5hbHRlcm5hdGVHcmlkQ29sb3IscD1hLnRpY2ttYXJrT2Zmc2V0LHI9ZC5saW5lV2lkdGgscyxxPWIuaGFzUmVuZGVyZWQmJkMoYS5vbGRNaW4pLHU9YS5zaG93QXhpcyx4PWdiKGMuZ2xvYmFsQW5pbWF0aW9uKSxELFE7YS5sYWJlbEVkZ2UubGVuZ3RoPTA7YS5vdmVybGFwPSExO28oW2osayxsXSxmdW5jdGlvbihhKXtmb3IodmFyIGIgaW4gYSlhW2JdLmlzQWN0aXZlPSExfSk7aWYoYS5oYXNEYXRhKCl8fGcpe2EubWlub3JUaWNrSW50ZXJ2YWwmJiFhLmNhdGVnb3JpZXMmJm8oYS5nZXRNaW5vclRpY2tQb3NpdGlvbnMoKSxmdW5jdGlvbihiKXtrW2JdfHwoa1tiXT1uZXcgYmIoYSxiLFwibWlub3JcIikpO3EmJmtbYl0uaXNOZXcmJmtbYl0ucmVuZGVyKG51bGwsITApO2tbYl0ucmVuZGVyKG51bGwsITEsMSl9KTtpZihoLmxlbmd0aCYmKG8oaCxmdW5jdGlvbihiLFxuYyl7aWYoIWd8fGI+PWEubWluJiZiPD1hLm1heClqW2JdfHwoaltiXT1uZXcgYmIoYSxiKSkscSYmaltiXS5pc05ldyYmaltiXS5yZW5kZXIoYywhMCwwLjEpLGpbYl0ucmVuZGVyKGMpfSkscCYmKGEubWluPT09MHx8YS5zaW5nbGUpKSlqWy0xXXx8KGpbLTFdPW5ldyBiYihhLC0xLG51bGwsITApKSxqWy0xXS5yZW5kZXIoLTEpO24mJm8oaCxmdW5jdGlvbihjLGQpe1E9aFtkKzFdIT09dD9oW2QrMV0rcDphLm1heC1wO2lmKGQlMj09PTAmJmM8YS5tYXgmJlE8PWEubWF4KyhiLnBvbGFyPy1wOnApKWxbY118fChsW2NdPW5ldyBCLlBsb3RMaW5lT3JCYW5kKGEpKSxEPWMrcCxsW2NdLm9wdGlvbnM9e2Zyb206ZT9mKEQpOkQsdG86ZT9mKFEpOlEsY29sb3I6bn0sbFtjXS5yZW5kZXIoKSxsW2NdLmlzQWN0aXZlPSEwfSk7aWYoIWEuX2FkZGVkUGxvdExCKW8oKGQucGxvdExpbmVzfHxbXSkuY29uY2F0KGQucGxvdEJhbmRzfHxbXSksZnVuY3Rpb24oYil7YS5hZGRQbG90QmFuZE9yTGluZShiKX0pLFxuYS5fYWRkZWRQbG90TEI9ITB9byhbaixrLGxdLGZ1bmN0aW9uKGEpe3ZhciBjLGQsZT1bXSxmPXguZHVyYXRpb247Zm9yKGMgaW4gYSlpZighYVtjXS5pc0FjdGl2ZSlhW2NdLnJlbmRlcihjLCExLDApLGFbY10uaXNBY3RpdmU9ITEsZS5wdXNoKGMpO1phKGZ1bmN0aW9uKCl7Zm9yKGQ9ZS5sZW5ndGg7ZC0tOylhW2VbZF1dJiYhYVtlW2RdXS5pc0FjdGl2ZSYmKGFbZVtkXV0uZGVzdHJveSgpLGRlbGV0ZSBhW2VbZF1dKX0sYT09PWx8fCFiLmhhc1JlbmRlcmVkfHwhZj8wOmYpfSk7aWYocilzPWEuZ2V0TGluZVBhdGgociksYS5heGlzTGluZT9hLmF4aXNMaW5lLmFuaW1hdGUoe2Q6c30pOmEuYXhpc0xpbmU9Yy5wYXRoKHMpLmF0dHIoe3N0cm9rZTpkLmxpbmVDb2xvcixcInN0cm9rZS13aWR0aFwiOnIsekluZGV4Ojd9KS5hZGQoYS5heGlzR3JvdXApLGEuYXhpc0xpbmVbdT9cInNob3dcIjpcImhpZGVcIl0oITApO2lmKGkmJnUpaVtpLmlzTmV3P1wiYXR0clwiOlwiYW5pbWF0ZVwiXShhLmdldFRpdGxlUG9zaXRpb24oKSksXG5pLmlzTmV3PSExO20mJm0uZW5hYmxlZCYmYS5yZW5kZXJTdGFja1RvdGFscygpO2EuaXNEaXJ0eT0hMX0scmVkcmF3OmZ1bmN0aW9uKCl7dGhpcy52aXNpYmxlJiYodGhpcy5yZW5kZXIoKSxvKHRoaXMucGxvdExpbmVzQW5kQmFuZHMsZnVuY3Rpb24oYSl7YS5yZW5kZXIoKX0pKTtvKHRoaXMuc2VyaWVzLGZ1bmN0aW9uKGEpe2EuaXNEaXJ0eT0hMH0pfSxkZXN0cm95OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMsYz1iLnN0YWNrcyxkLGU9Yi5wbG90TGluZXNBbmRCYW5kczthfHxUKGIpO2ZvcihkIGluIGMpUGEoY1tkXSksY1tkXT1udWxsO28oW2IudGlja3MsYi5taW5vclRpY2tzLGIuYWx0ZXJuYXRlQmFuZHNdLGZ1bmN0aW9uKGEpe1BhKGEpfSk7Zm9yKGE9ZS5sZW5ndGg7YS0tOyllW2FdLmRlc3Ryb3koKTtvKFwic3RhY2tUb3RhbEdyb3VwLGF4aXNMaW5lLGF4aXNUaXRsZSxheGlzR3JvdXAsY3Jvc3MsZ3JpZEdyb3VwLGxhYmVsR3JvdXBcIi5zcGxpdChcIixcIiksZnVuY3Rpb24oYSl7YlthXSYmXG4oYlthXT1iW2FdLmRlc3Ryb3koKSl9KTt0aGlzLmNyb3NzJiZ0aGlzLmNyb3NzLmRlc3Ryb3koKX0sZHJhd0Nyb3NzaGFpcjpmdW5jdGlvbihhLGIpe3ZhciBjLGQ9dGhpcy5jcm9zc2hhaXIsZSxmO2lmKCF0aGlzLmNyb3NzaGFpcnx8KHYoYil8fCFxKGQuc25hcCwhMCkpPT09ITEpdGhpcy5oaWRlQ3Jvc3NoYWlyKCk7ZWxzZSBpZihxKGQuc25hcCwhMCk/dihiKSYmKGM9dGhpcy5pc1hBeGlzP2IucGxvdFg6dGhpcy5sZW4tYi5wbG90WSk6Yz10aGlzLmhvcml6P2EuY2hhcnRYLXRoaXMucG9zOnRoaXMubGVuLWEuY2hhcnRZK3RoaXMucG9zLGM9dGhpcy5pc1JhZGlhbD90aGlzLmdldFBsb3RMaW5lUGF0aCh0aGlzLmlzWEF4aXM/Yi54OnEoYi5zdGFja1ksYi55KSl8fG51bGw6dGhpcy5nZXRQbG90TGluZVBhdGgobnVsbCxudWxsLG51bGwsbnVsbCxjKXx8bnVsbCxjPT09bnVsbCl0aGlzLmhpZGVDcm9zc2hhaXIoKTtlbHNlIGlmKGU9dGhpcy5jYXRlZ29yaWVzJiYhdGhpcy5pc1JhZGlhbCxcbmY9cShkLndpZHRoLGU/dGhpcy50cmFuc0E6MSksdGhpcy5jcm9zcyl0aGlzLmNyb3NzLmF0dHIoe2Q6Yyx2aXNpYmlsaXR5OlwidmlzaWJsZVwiLFwic3Ryb2tlLXdpZHRoXCI6Zn0pO2Vsc2V7ZT17XCJwb2ludGVyLWV2ZW50c1wiOlwibm9uZVwiLFwic3Ryb2tlLXdpZHRoXCI6ZixzdHJva2U6ZC5jb2xvcnx8KGU/XCJyZ2JhKDE1NSwyMDAsMjU1LDAuMilcIjpcIiNDMEMwQzBcIiksekluZGV4OnEoZC56SW5kZXgsMil9O2lmKGQuZGFzaFN0eWxlKWUuZGFzaHN0eWxlPWQuZGFzaFN0eWxlO3RoaXMuY3Jvc3M9dGhpcy5jaGFydC5yZW5kZXJlci5wYXRoKGMpLmF0dHIoZSkuYWRkKCl9fSxoaWRlQ3Jvc3NoYWlyOmZ1bmN0aW9uKCl7dGhpcy5jcm9zcyYmdGhpcy5jcm9zcy5oaWRlKCl9fTtBKEoucHJvdG90eXBlLHtnZXRQbG90QmFuZFBhdGg6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmdldFBsb3RMaW5lUGF0aChiLG51bGwsbnVsbCwhMCksZD10aGlzLmdldFBsb3RMaW5lUGF0aChhLG51bGwsbnVsbCwhMCk7XG5kJiZjPyhkLmZsYXQ9ZC50b1N0cmluZygpPT09Yy50b1N0cmluZygpLGQucHVzaChjWzRdLGNbNV0sY1sxXSxjWzJdKSk6ZD1udWxsO3JldHVybiBkfSxhZGRQbG90QmFuZDpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5hZGRQbG90QmFuZE9yTGluZShhLFwicGxvdEJhbmRzXCIpfSxhZGRQbG90TGluZTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5hZGRQbG90QmFuZE9yTGluZShhLFwicGxvdExpbmVzXCIpfSxhZGRQbG90QmFuZE9yTGluZTpmdW5jdGlvbihhLGIpe3ZhciBjPShuZXcgQi5QbG90TGluZU9yQmFuZCh0aGlzLGEpKS5yZW5kZXIoKSxkPXRoaXMudXNlck9wdGlvbnM7YyYmKGImJihkW2JdPWRbYl18fFtdLGRbYl0ucHVzaChhKSksdGhpcy5wbG90TGluZXNBbmRCYW5kcy5wdXNoKGMpKTtyZXR1cm4gY30scmVtb3ZlUGxvdEJhbmRPckxpbmU6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPXRoaXMucGxvdExpbmVzQW5kQmFuZHMsYz10aGlzLm9wdGlvbnMsZD10aGlzLnVzZXJPcHRpb25zLFxuZT1iLmxlbmd0aDtlLS07KWJbZV0uaWQ9PT1hJiZiW2VdLmRlc3Ryb3koKTtvKFtjLnBsb3RMaW5lc3x8W10sZC5wbG90TGluZXN8fFtdLGMucGxvdEJhbmRzfHxbXSxkLnBsb3RCYW5kc3x8W11dLGZ1bmN0aW9uKGIpe2ZvcihlPWIubGVuZ3RoO2UtLTspYltlXS5pZD09PWEmJnphKGIsYltlXSl9KX19KTtKLnByb3RvdHlwZS5nZXRUaW1lVGlja3M9ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9W10sZj17fSxnPVIuZ2xvYmFsLnVzZVVUQyxoLGk9bmV3IGJhKGItZWIoYikpLGo9YS51bml0UmFuZ2Usaz1hLmNvdW50O2lmKHYoYikpe2lbUGJdKGo+PU0uc2Vjb25kPzA6aypWKGkuZ2V0TWlsbGlzZWNvbmRzKCkvaykpO2lmKGo+PU0uc2Vjb25kKWlbUWJdKGo+PU0ubWludXRlPzA6aypWKGkuZ2V0U2Vjb25kcygpL2spKTtpZihqPj1NLm1pbnV0ZSlpW1JiXShqPj1NLmhvdXI/MDprKlYoaVtCYl0oKS9rKSk7aWYoaj49TS5ob3VyKWlbU2JdKGo+PU0uZGF5PzA6aypWKGlbQ2JdKCkvaykpO1xuaWYoaj49TS5kYXkpaVtxYl0oaj49TS5tb250aD8xOmsqVihpW2FiXSgpL2spKTtqPj1NLm1vbnRoJiYoaVtFYl0oaj49TS55ZWFyPzA6aypWKGlbaGJdKCkvaykpLGg9aVtpYl0oKSk7aj49TS55ZWFyJiYoaC09aCVrLGlbRmJdKGgpKTtpZihqPT09TS53ZWVrKWlbcWJdKGlbYWJdKCktaVtEYl0oKStxKGQsMSkpO2I9MTtpZih5Ynx8ZmIpaT1pLmdldFRpbWUoKSxpPW5ldyBiYShpK2ViKGkpKTtoPWlbaWJdKCk7Zm9yKHZhciBkPWkuZ2V0VGltZSgpLGw9aVtoYl0oKSxtPWlbYWJdKCksbj0hZ3x8ISFmYixwPShNLmRheSsoZz9lYihpKTppLmdldFRpbWV6b25lT2Zmc2V0KCkqNkU0KSklTS5kYXk7ZDxjOyllLnB1c2goZCksaj09PU0ueWVhcj9kPXBiKGgrYiprLDApOmo9PT1NLm1vbnRoP2Q9cGIoaCxsK2Iqayk6biYmKGo9PT1NLmRheXx8aj09PU0ud2Vlayk/ZD1wYihoLGwsbStiKmsqKGo9PT1NLmRheT8xOjcpKTpkKz1qKmssYisrO2UucHVzaChkKTtvKEZhKGUsZnVuY3Rpb24oYSl7cmV0dXJuIGo8PVxuTS5ob3VyJiZhJU0uZGF5PT09cH0pLGZ1bmN0aW9uKGEpe2ZbYV09XCJkYXlcIn0pfWUuaW5mbz1BKGEse2hpZ2hlclJhbmtzOmYsdG90YWxSYW5nZTpqKmt9KTtyZXR1cm4gZX07Si5wcm90b3R5cGUubm9ybWFsaXplVGltZVRpY2tJbnRlcnZhbD1mdW5jdGlvbihhLGIpe3ZhciBjPWJ8fFtbXCJtaWxsaXNlY29uZFwiLFsxLDIsNSwxMCwyMCwyNSw1MCwxMDAsMjAwLDUwMF1dLFtcInNlY29uZFwiLFsxLDIsNSwxMCwxNSwzMF1dLFtcIm1pbnV0ZVwiLFsxLDIsNSwxMCwxNSwzMF1dLFtcImhvdXJcIixbMSwyLDMsNCw2LDgsMTJdXSxbXCJkYXlcIixbMSwyXV0sW1wid2Vla1wiLFsxLDJdXSxbXCJtb250aFwiLFsxLDIsMyw0LDZdXSxbXCJ5ZWFyXCIsbnVsbF1dLGQ9Y1tjLmxlbmd0aC0xXSxlPU1bZFswXV0sZj1kWzFdLGc7Zm9yKGc9MDtnPGMubGVuZ3RoO2crKylpZihkPWNbZ10sZT1NW2RbMF1dLGY9ZFsxXSxjW2crMV0mJmE8PShlKmZbZi5sZW5ndGgtMV0rTVtjW2crMV1bMF1dKS8yKWJyZWFrO2U9PT1NLnllYXImJlxuYTw1KmUmJihmPVsxLDIsNV0pO2M9QWIoYS9lLGYsZFswXT09PVwieWVhclwiP3coemIoYS9lKSwxKToxKTtyZXR1cm57dW5pdFJhbmdlOmUsY291bnQ6Yyx1bml0TmFtZTpkWzBdfX07Si5wcm90b3R5cGUuZ2V0TG9nVGlja1Bvc2l0aW9ucz1mdW5jdGlvbihhLGIsYyxkKXt2YXIgZT10aGlzLm9wdGlvbnMsZj10aGlzLmxlbixnPXRoaXMubGluMmxvZyxoPXRoaXMubG9nMmxpbixpPVtdO2lmKCFkKXRoaXMuX21pbm9yQXV0b0ludGVydmFsPW51bGw7aWYoYT49MC41KWE9eShhKSxpPXRoaXMuZ2V0TGluZWFyVGlja1Bvc2l0aW9ucyhhLGIsYyk7ZWxzZSBpZihhPj0wLjA4KWZvcih2YXIgZj1WKGIpLGosayxsLG0sbixlPWE+MC4zP1sxLDIsNF06YT4wLjE1P1sxLDIsNCw2LDhdOlsxLDIsMyw0LDUsNiw3LDgsOV07ZjxjKzEmJiFuO2YrKyl7az1lLmxlbmd0aDtmb3Ioaj0wO2o8ayYmIW47aisrKWw9aChnKGYpKmVbal0pLGw+YiYmKCFkfHxtPD1jKSYmbSE9PXQmJmkucHVzaChtKSxtPmMmJlxuKG49ITApLG09bH1lbHNlIGlmKGI9ZyhiKSxjPWcoYyksYT1lW2Q/XCJtaW5vclRpY2tJbnRlcnZhbFwiOlwidGlja0ludGVydmFsXCJdLGE9cShhPT09XCJhdXRvXCI/bnVsbDphLHRoaXMuX21pbm9yQXV0b0ludGVydmFsLChjLWIpKihlLnRpY2tQaXhlbEludGVydmFsLyhkPzU6MSkpLygoZD9mL3RoaXMudGlja1Bvc2l0aW9ucy5sZW5ndGg6Zil8fDEpKSxhPUFiKGEsbnVsbCx6YihhKSksaT10YSh0aGlzLmdldExpbmVhclRpY2tQb3NpdGlvbnMoYSxiLGMpLGgpLCFkKXRoaXMuX21pbm9yQXV0b0ludGVydmFsPWEvNTtpZighZCl0aGlzLnRpY2tJbnRlcnZhbD1hO3JldHVybiBpfTtKLnByb3RvdHlwZS5sb2cybGluPWZ1bmN0aW9uKGEpe3JldHVybiBZLmxvZyhhKS9ZLkxOMTB9O0oucHJvdG90eXBlLmxpbjJsb2c9ZnVuY3Rpb24oYSl7cmV0dXJuIFkucG93KDEwLGEpfTt2YXIgTGI9Qi5Ub29sdGlwPWZ1bmN0aW9uKCl7dGhpcy5pbml0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX07TGIucHJvdG90eXBlPVxue2luaXQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz1iLmJvcmRlcldpZHRoLGQ9Yi5zdHlsZSxlPUsoZC5wYWRkaW5nKTt0aGlzLmNoYXJ0PWE7dGhpcy5vcHRpb25zPWI7dGhpcy5jcm9zc2hhaXJzPVtdO3RoaXMubm93PXt4OjAseTowfTt0aGlzLmlzSGlkZGVuPSEwO3RoaXMubGFiZWw9YS5yZW5kZXJlci5sYWJlbChcIlwiLDAsMCxiLnNoYXBlfHxcImNhbGxvdXRcIixudWxsLG51bGwsYi51c2VIVE1MLG51bGwsXCJ0b29sdGlwXCIpLmF0dHIoe3BhZGRpbmc6ZSxmaWxsOmIuYmFja2dyb3VuZENvbG9yLFwic3Ryb2tlLXdpZHRoXCI6YyxyOmIuYm9yZGVyUmFkaXVzLHpJbmRleDo4fSkuY3NzKGQpLmNzcyh7cGFkZGluZzowfSkuYWRkKCkuYXR0cih7eTotOTk5OX0pO3FhfHx0aGlzLmxhYmVsLnNoYWRvdyhiLnNoYWRvdyk7dGhpcy5zaGFyZWQ9Yi5zaGFyZWR9LGRlc3Ryb3k6ZnVuY3Rpb24oKXtpZih0aGlzLmxhYmVsKXRoaXMubGFiZWw9dGhpcy5sYWJlbC5kZXN0cm95KCk7Y2xlYXJUaW1lb3V0KHRoaXMuaGlkZVRpbWVyKTtcbmNsZWFyVGltZW91dCh0aGlzLnRvb2x0aXBUaW1lb3V0KX0sbW92ZTpmdW5jdGlvbihhLGIsYyxkKXt2YXIgZT10aGlzLGY9ZS5ub3csZz1lLm9wdGlvbnMuYW5pbWF0aW9uIT09ITEmJiFlLmlzSGlkZGVuJiYoUyhhLWYueCk+MXx8UyhiLWYueSk+MSksaD1lLmZvbGxvd1BvaW50ZXJ8fGUubGVuPjE7QShmLHt4Omc/KDIqZi54K2EpLzM6YSx5Omc/KGYueStiKS8yOmIsYW5jaG9yWDpoP3Q6Zz8oMipmLmFuY2hvclgrYykvMzpjLGFuY2hvclk6aD90Omc/KGYuYW5jaG9yWStkKS8yOmR9KTtlLmxhYmVsLmF0dHIoZik7aWYoZyljbGVhclRpbWVvdXQodGhpcy50b29sdGlwVGltZW91dCksdGhpcy50b29sdGlwVGltZW91dD1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7ZSYmZS5tb3ZlKGEsYixjLGQpfSwzMil9LGhpZGU6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztjbGVhclRpbWVvdXQodGhpcy5oaWRlVGltZXIpO2E9cShhLHRoaXMub3B0aW9ucy5oaWRlRGVsYXksNTAwKTtpZighdGhpcy5pc0hpZGRlbil0aGlzLmhpZGVUaW1lcj1cblphKGZ1bmN0aW9uKCl7Yi5sYWJlbFthP1wiZmFkZU91dFwiOlwiaGlkZVwiXSgpO2IuaXNIaWRkZW49ITB9LGEpfSxnZXRBbmNob3I6ZnVuY3Rpb24oYSxiKXt2YXIgYyxkPXRoaXMuY2hhcnQsZT1kLmludmVydGVkLGY9ZC5wbG90VG9wLGc9ZC5wbG90TGVmdCxoPTAsaT0wLGosayxhPXVhKGEpO2M9YVswXS50b29sdGlwUG9zO3RoaXMuZm9sbG93UG9pbnRlciYmYiYmKGIuY2hhcnRYPT09dCYmKGI9ZC5wb2ludGVyLm5vcm1hbGl6ZShiKSksYz1bYi5jaGFydFgtZC5wbG90TGVmdCxiLmNoYXJ0WS1mXSk7Y3x8KG8oYSxmdW5jdGlvbihhKXtqPWEuc2VyaWVzLnlBeGlzO2s9YS5zZXJpZXMueEF4aXM7aCs9YS5wbG90WCsoIWUmJms/ay5sZWZ0LWc6MCk7aSs9KGEucGxvdExvdz8oYS5wbG90TG93K2EucGxvdEhpZ2gpLzI6YS5wbG90WSkrKCFlJiZqP2oudG9wLWY6MCl9KSxoLz1hLmxlbmd0aCxpLz1hLmxlbmd0aCxjPVtlP2QucGxvdFdpZHRoLWk6aCx0aGlzLnNoYXJlZCYmIWUmJmEubGVuZ3RoPlxuMSYmYj9iLmNoYXJ0WS1mOmU/ZC5wbG90SGVpZ2h0LWg6aV0pO3JldHVybiB0YShjLHkpfSxnZXRQb3NpdGlvbjpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9dGhpcy5jaGFydCxlPXRoaXMuZGlzdGFuY2UsZj17fSxnPWMuaHx8MCxoLGk9W1wieVwiLGQuY2hhcnRIZWlnaHQsYixjLnBsb3RZK2QucGxvdFRvcCxkLnBsb3RUb3AsZC5wbG90VG9wK2QucGxvdEhlaWdodF0saj1bXCJ4XCIsZC5jaGFydFdpZHRoLGEsYy5wbG90WCtkLnBsb3RMZWZ0LGQucGxvdExlZnQsZC5wbG90TGVmdCtkLnBsb3RXaWR0aF0saz0hdGhpcy5mb2xsb3dQb2ludGVyJiZxKGMudHRCZWxvdywhZC5pbnZlcnRlZD09PSEhYy5uZWdhdGl2ZSksbD1mdW5jdGlvbihhLGIsYyxkLGgsaSl7dmFyIGo9YzxkLWUsbT1kK2UrYzxiLGw9ZC1lLWM7ZCs9ZTtpZihrJiZtKWZbYV09ZDtlbHNlIGlmKCFrJiZqKWZbYV09bDtlbHNlIGlmKGopZlthXT1HKGktYyxsLWc8MD9sOmwtZyk7ZWxzZSBpZihtKWZbYV09dyhoLGQrZytjPmI/ZDpcbmQrZyk7ZWxzZSByZXR1cm4hMX0sbT1mdW5jdGlvbihhLGIsYyxkKXt2YXIgZztkPGV8fGQ+Yi1lP2c9ITE6ZlthXT1kPGMvMj8xOmQ+Yi1jLzI/Yi1jLTI6ZC1jLzI7cmV0dXJuIGd9LG49ZnVuY3Rpb24oYSl7dmFyIGI9aTtpPWo7aj1iO2g9YX0scD1mdW5jdGlvbigpe2wuYXBwbHkoMCxpKSE9PSExP20uYXBwbHkoMCxqKT09PSExJiYhaCYmKG4oITApLHAoKSk6aD9mLng9Zi55PTA6KG4oITApLHAoKSl9OyhkLmludmVydGVkfHx0aGlzLmxlbj4xKSYmbigpO3AoKTtyZXR1cm4gZn0sZGVmYXVsdEZvcm1hdHRlcjpmdW5jdGlvbihhKXt2YXIgYj10aGlzLnBvaW50c3x8dWEodGhpcyksYztjPVthLnRvb2x0aXBGb290ZXJIZWFkZXJGb3JtYXR0ZXIoYlswXSldO2M9Yy5jb25jYXQoYS5ib2R5Rm9ybWF0dGVyKGIpKTtjLnB1c2goYS50b29sdGlwRm9vdGVySGVhZGVyRm9ybWF0dGVyKGJbMF0sITApKTtyZXR1cm4gYy5qb2luKFwiXCIpfSxyZWZyZXNoOmZ1bmN0aW9uKGEsYil7dmFyIGM9XG50aGlzLmNoYXJ0LGQ9dGhpcy5sYWJlbCxlPXRoaXMub3B0aW9ucyxmLGcsaCxpPXt9LGosaz1bXTtqPWUuZm9ybWF0dGVyfHx0aGlzLmRlZmF1bHRGb3JtYXR0ZXI7dmFyIGk9Yy5ob3ZlclBvaW50cyxsLG09dGhpcy5zaGFyZWQ7Y2xlYXJUaW1lb3V0KHRoaXMuaGlkZVRpbWVyKTt0aGlzLmZvbGxvd1BvaW50ZXI9dWEoYSlbMF0uc2VyaWVzLnRvb2x0aXBPcHRpb25zLmZvbGxvd1BvaW50ZXI7aD10aGlzLmdldEFuY2hvcihhLGIpO2Y9aFswXTtnPWhbMV07bSYmKCFhLnNlcmllc3x8IWEuc2VyaWVzLm5vU2hhcmVkVG9vbHRpcCk/KGMuaG92ZXJQb2ludHM9YSxpJiZvKGksZnVuY3Rpb24oYSl7YS5zZXRTdGF0ZSgpfSksbyhhLGZ1bmN0aW9uKGEpe2Euc2V0U3RhdGUoXCJob3ZlclwiKTtrLnB1c2goYS5nZXRMYWJlbENvbmZpZygpKX0pLGk9e3g6YVswXS5jYXRlZ29yeSx5OmFbMF0ueX0saS5wb2ludHM9ayx0aGlzLmxlbj1rLmxlbmd0aCxhPWFbMF0pOmk9YS5nZXRMYWJlbENvbmZpZygpO1xuaj1qLmNhbGwoaSx0aGlzKTtpPWEuc2VyaWVzO3RoaXMuZGlzdGFuY2U9cShpLnRvb2x0aXBPcHRpb25zLmRpc3RhbmNlLDE2KTtqPT09ITE/dGhpcy5oaWRlKCk6KHRoaXMuaXNIaWRkZW4mJihTYShkKSxkLmF0dHIoXCJvcGFjaXR5XCIsMSkuc2hvdygpKSxkLmF0dHIoe3RleHQ6an0pLGw9ZS5ib3JkZXJDb2xvcnx8YS5jb2xvcnx8aS5jb2xvcnx8XCIjNjA2MDYwXCIsZC5hdHRyKHtzdHJva2U6bH0pLHRoaXMudXBkYXRlUG9zaXRpb24oe3Bsb3RYOmYscGxvdFk6ZyxuZWdhdGl2ZTphLm5lZ2F0aXZlLHR0QmVsb3c6YS50dEJlbG93LGg6aFsyXXx8MH0pLHRoaXMuaXNIaWRkZW49ITEpO08oYyxcInRvb2x0aXBSZWZyZXNoXCIse3RleHQ6aix4OmYrYy5wbG90TGVmdCx5OmcrYy5wbG90VG9wLGJvcmRlckNvbG9yOmx9KX0sdXBkYXRlUG9zaXRpb246ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jaGFydCxjPXRoaXMubGFiZWwsYz0odGhpcy5vcHRpb25zLnBvc2l0aW9uZXJ8fHRoaXMuZ2V0UG9zaXRpb24pLmNhbGwodGhpcyxcbmMud2lkdGgsYy5oZWlnaHQsYSk7dGhpcy5tb3ZlKHkoYy54KSx5KGMueXx8MCksYS5wbG90WCtiLnBsb3RMZWZ0LGEucGxvdFkrYi5wbG90VG9wKX0sZ2V0WERhdGVGb3JtYXQ6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGI9Yi5kYXRlVGltZUxhYmVsRm9ybWF0cyxlPWMmJmMuY2xvc2VzdFBvaW50UmFuZ2UsZixnPXttaWxsaXNlY29uZDoxNSxzZWNvbmQ6MTIsbWludXRlOjksaG91cjo2LGRheTozfSxoLGk9XCJtaWxsaXNlY29uZFwiO2lmKGUpe2g9bmEoXCIlbS0lZCAlSDolTTolUy4lTFwiLGEueCk7Zm9yKGYgaW4gTSl7aWYoZT09PU0ud2VlayYmK25hKFwiJXdcIixhLngpPT09Yy5vcHRpb25zLnN0YXJ0T2ZXZWVrJiZoLnN1YnN0cig2KT09PVwiMDA6MDA6MDAuMDAwXCIpe2Y9XCJ3ZWVrXCI7YnJlYWt9aWYoTVtmXT5lKXtmPWk7YnJlYWt9aWYoZ1tmXSYmaC5zdWJzdHIoZ1tmXSkhPT1cIjAxLTAxIDAwOjAwOjAwLjAwMFwiLnN1YnN0cihnW2ZdKSlicmVhaztmIT09XCJ3ZWVrXCImJihpPWYpfWYmJihkPVxuYltmXSl9ZWxzZSBkPWIuZGF5O3JldHVybiBkfHxiLnllYXJ9LHRvb2x0aXBGb290ZXJIZWFkZXJGb3JtYXR0ZXI6ZnVuY3Rpb24oYSxiKXt2YXIgYz1iP1wiZm9vdGVyXCI6XCJoZWFkZXJcIixkPWEuc2VyaWVzLGU9ZC50b29sdGlwT3B0aW9ucyxmPWUueERhdGVGb3JtYXQsZz1kLnhBeGlzLGg9ZyYmZy5vcHRpb25zLnR5cGU9PT1cImRhdGV0aW1lXCImJkMoYS5rZXkpLGM9ZVtjK1wiRm9ybWF0XCJdO2gmJiFmJiYoZj10aGlzLmdldFhEYXRlRm9ybWF0KGEsZSxnKSk7aCYmZiYmKGM9Yy5yZXBsYWNlKFwie3BvaW50LmtleX1cIixcIntwb2ludC5rZXk6XCIrZitcIn1cIikpO3JldHVybiBMYShjLHtwb2ludDphLHNlcmllczpkfSl9LGJvZHlGb3JtYXR0ZXI6ZnVuY3Rpb24oYSl7cmV0dXJuIHRhKGEsZnVuY3Rpb24oYSl7dmFyIGM9YS5zZXJpZXMudG9vbHRpcE9wdGlvbnM7cmV0dXJuKGMucG9pbnRGb3JtYXR0ZXJ8fGEucG9pbnQudG9vbHRpcEZvcm1hdHRlcikuY2FsbChhLnBvaW50LGMucG9pbnRGb3JtYXQpfSl9fTtcbnZhciBvYTtjYj1IJiZILmRvY3VtZW50RWxlbWVudC5vbnRvdWNoc3RhcnQhPT10O3ZhciBZYT1CLlBvaW50ZXI9ZnVuY3Rpb24oYSxiKXt0aGlzLmluaXQoYSxiKX07WWEucHJvdG90eXBlPXtpbml0OmZ1bmN0aW9uKGEsYil7dmFyIGM9Yi5jaGFydCxkPWMuZXZlbnRzLGU9cWE/XCJcIjpjLnpvb21UeXBlLGM9YS5pbnZlcnRlZCxmO3RoaXMub3B0aW9ucz1iO3RoaXMuY2hhcnQ9YTt0aGlzLnpvb21YPWY9L3gvLnRlc3QoZSk7dGhpcy56b29tWT1lPS95Ly50ZXN0KGUpO3RoaXMuem9vbUhvcj1mJiYhY3x8ZSYmYzt0aGlzLnpvb21WZXJ0PWUmJiFjfHxmJiZjO3RoaXMuaGFzWm9vbT1mfHxlO3RoaXMucnVuQ2hhcnRDbGljaz1kJiYhIWQuY2xpY2s7dGhpcy5waW5jaERvd249W107dGhpcy5sYXN0VmFsaWRUb3VjaD17fTtpZihCLlRvb2x0aXAmJmIudG9vbHRpcC5lbmFibGVkKWEudG9vbHRpcD1uZXcgTGIoYSxiLnRvb2x0aXApLHRoaXMuZm9sbG93VG91Y2hNb3ZlPXEoYi50b29sdGlwLmZvbGxvd1RvdWNoTW92ZSxcbiEwKTt0aGlzLnNldERPTUV2ZW50cygpfSxub3JtYWxpemU6ZnVuY3Rpb24oYSxiKXt2YXIgYyxkLGE9YXx8TC5ldmVudDtpZighYS50YXJnZXQpYS50YXJnZXQ9YS5zcmNFbGVtZW50O2Q9YS50b3VjaGVzP2EudG91Y2hlcy5sZW5ndGg/YS50b3VjaGVzLml0ZW0oMCk6YS5jaGFuZ2VkVG91Y2hlc1swXTphO2lmKCFiKXRoaXMuY2hhcnRQb3NpdGlvbj1iPUpiKHRoaXMuY2hhcnQuY29udGFpbmVyKTtkLnBhZ2VYPT09dD8oYz13KGEueCxhLmNsaWVudFgtYi5sZWZ0KSxkPWEueSk6KGM9ZC5wYWdlWC1iLmxlZnQsZD1kLnBhZ2VZLWIudG9wKTtyZXR1cm4gQShhLHtjaGFydFg6eShjKSxjaGFydFk6eShkKX0pfSxnZXRDb29yZGluYXRlczpmdW5jdGlvbihhKXt2YXIgYj17eEF4aXM6W10seUF4aXM6W119O28odGhpcy5jaGFydC5heGVzLGZ1bmN0aW9uKGMpe2JbYy5pc1hBeGlzP1wieEF4aXNcIjpcInlBeGlzXCJdLnB1c2goe2F4aXM6Yyx2YWx1ZTpjLnRvVmFsdWUoYVtjLmhvcml6P1wiY2hhcnRYXCI6XG5cImNoYXJ0WVwiXSl9KX0pO3JldHVybiBifSxydW5Qb2ludEFjdGlvbnM6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jaGFydCxjPWIuc2VyaWVzLGQ9Yi50b29sdGlwLGU9ZD9kLnNoYXJlZDohMSxmPWIuaG92ZXJQb2ludCxnPWIuaG92ZXJTZXJpZXMsaCxpPVtOdW1iZXIuTUFYX1ZBTFVFLE51bWJlci5NQVhfVkFMVUVdLGosayxsPVtdLG09W10sbjtpZighZSYmIWcpZm9yKGg9MDtoPGMubGVuZ3RoO2grKylpZihjW2hdLmRpcmVjdFRvdWNofHwhY1toXS5vcHRpb25zLnN0aWNreVRyYWNraW5nKWM9W107ZyYmKGU/Zy5ub1NoYXJlZFRvb2x0aXA6Zy5kaXJlY3RUb3VjaCkmJmY/bT1bZl06KG8oYyxmdW5jdGlvbihiKXtqPWIubm9TaGFyZWRUb29sdGlwJiZlO2s9IWUmJmIuZGlyZWN0VG91Y2g7Yi52aXNpYmxlJiYhaiYmIWsmJnEoYi5vcHRpb25zLmVuYWJsZU1vdXNlVHJhY2tpbmcsITApJiYobj1iLnNlYXJjaFBvaW50KGEsIWomJmIua2REaW1lbnNpb25zPT09MSkpJiZsLnB1c2gobil9KSxcbm8obCxmdW5jdGlvbihhKXthJiZvKFtcImRpc3RcIixcImRpc3RYXCJdLGZ1bmN0aW9uKGIsYyl7aWYoQyhhW2JdKSl7dmFyIGQ9YVtiXT09PWlbY10mJmEuc2VyaWVzLmdyb3VwLnpJbmRleD49bVtjXS5zZXJpZXMuZ3JvdXAuekluZGV4O2lmKGFbYl08aVtjXXx8ZClpW2NdPWFbYl0sbVtjXT1hfX0pfSkpO2lmKGUpZm9yKGg9bC5sZW5ndGg7aC0tOykobFtoXS5jbGllbnRYIT09bVsxXS5jbGllbnRYfHxsW2hdLnNlcmllcy5ub1NoYXJlZFRvb2x0aXApJiZsLnNwbGljZShoLDEpO2lmKG1bMF0mJihtWzBdIT09dGhpcy5wcmV2S0RQb2ludHx8ZCYmZC5pc0hpZGRlbikpaWYoZSYmIW1bMF0uc2VyaWVzLm5vU2hhcmVkVG9vbHRpcClsLmxlbmd0aCYmZCYmZC5yZWZyZXNoKGwsYSksbyhsLGZ1bmN0aW9uKGIpe2Iub25Nb3VzZU92ZXIoYSxiIT09KGcmJmcuZGlyZWN0VG91Y2gmJmZ8fG1bMF0pKX0pLHRoaXMucHJldktEUG9pbnQ9bVsxXTtlbHNle2QmJmQucmVmcmVzaChtWzBdLGEpO2lmKCFnfHxcbiFnLmRpcmVjdFRvdWNoKW1bMF0ub25Nb3VzZU92ZXIoYSk7dGhpcy5wcmV2S0RQb2ludD1tWzBdfWVsc2UgYz1nJiZnLnRvb2x0aXBPcHRpb25zLmZvbGxvd1BvaW50ZXIsZCYmYyYmIWQuaXNIaWRkZW4mJihjPWQuZ2V0QW5jaG9yKFt7fV0sYSksZC51cGRhdGVQb3NpdGlvbih7cGxvdFg6Y1swXSxwbG90WTpjWzFdfSkpO2lmKCF0aGlzLl9vbkRvY3VtZW50TW91c2VNb3ZlKXRoaXMuX29uRG9jdW1lbnRNb3VzZU1vdmU9ZnVuY3Rpb24oYSl7aWYoJFtvYV0pJFtvYV0ucG9pbnRlci5vbkRvY3VtZW50TW91c2VNb3ZlKGEpfSxFKEgsXCJtb3VzZW1vdmVcIix0aGlzLl9vbkRvY3VtZW50TW91c2VNb3ZlKTtvKGU/bDpbcShmLG1bMV0pXSxmdW5jdGlvbihjKXtvKGIuYXhlcyxmdW5jdGlvbihiKXsoIWN8fGMuc2VyaWVzW2IuY29sbF09PT1iKSYmYi5kcmF3Q3Jvc3NoYWlyKGEsYyl9KX0pfSxyZXNldDpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuY2hhcnQsZD1jLmhvdmVyU2VyaWVzLGU9XG5jLmhvdmVyUG9pbnQsZj1jLmhvdmVyUG9pbnRzLGc9Yy50b29sdGlwLGg9ZyYmZy5zaGFyZWQ/ZjplO2EmJmgmJm8odWEoaCksZnVuY3Rpb24oYil7Yi5zZXJpZXMuaXNDYXJ0ZXNpYW4mJmIucGxvdFg9PT12b2lkIDAmJihhPSExKX0pO2lmKGEpZyYmaCYmKGcucmVmcmVzaChoKSxlJiYoZS5zZXRTdGF0ZShlLnN0YXRlLCEwKSxvKGMuYXhlcyxmdW5jdGlvbihhKXtxKGEuY3Jvc3NoYWlyJiZhLmNyb3NzaGFpci5zbmFwLCEwKT9hLmRyYXdDcm9zc2hhaXIobnVsbCxlKTphLmhpZGVDcm9zc2hhaXIoKX0pKSk7ZWxzZXtpZihlKWUub25Nb3VzZU91dCgpO2YmJm8oZixmdW5jdGlvbihhKXthLnNldFN0YXRlKCl9KTtpZihkKWQub25Nb3VzZU91dCgpO2cmJmcuaGlkZShiKTtpZih0aGlzLl9vbkRvY3VtZW50TW91c2VNb3ZlKVQoSCxcIm1vdXNlbW92ZVwiLHRoaXMuX29uRG9jdW1lbnRNb3VzZU1vdmUpLHRoaXMuX29uRG9jdW1lbnRNb3VzZU1vdmU9bnVsbDtvKGMuYXhlcyxmdW5jdGlvbihhKXthLmhpZGVDcm9zc2hhaXIoKX0pO1xudGhpcy5ob3Zlclg9Yy5ob3ZlclBvaW50cz1jLmhvdmVyUG9pbnQ9bnVsbH19LHNjYWxlR3JvdXBzOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5jaGFydCxkO28oYy5zZXJpZXMsZnVuY3Rpb24oZSl7ZD1hfHxlLmdldFBsb3RCb3goKTtlLnhBeGlzJiZlLnhBeGlzLnpvb21FbmFibGVkJiYoZS5ncm91cC5hdHRyKGQpLGUubWFya2VyR3JvdXAmJihlLm1hcmtlckdyb3VwLmF0dHIoZCksZS5tYXJrZXJHcm91cC5jbGlwKGI/Yy5jbGlwUmVjdDpudWxsKSksZS5kYXRhTGFiZWxzR3JvdXAmJmUuZGF0YUxhYmVsc0dyb3VwLmF0dHIoZCkpfSk7Yy5jbGlwUmVjdC5hdHRyKGJ8fGMuY2xpcEJveCl9LGRyYWdTdGFydDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNoYXJ0O2IubW91c2VJc0Rvd249YS50eXBlO2IuY2FuY2VsQ2xpY2s9ITE7Yi5tb3VzZURvd25YPXRoaXMubW91c2VEb3duWD1hLmNoYXJ0WDtiLm1vdXNlRG93blk9dGhpcy5tb3VzZURvd25ZPWEuY2hhcnRZfSxkcmFnOmZ1bmN0aW9uKGEpe3ZhciBiPVxudGhpcy5jaGFydCxjPWIub3B0aW9ucy5jaGFydCxkPWEuY2hhcnRYLGU9YS5jaGFydFksZj10aGlzLnpvb21Ib3IsZz10aGlzLnpvb21WZXJ0LGg9Yi5wbG90TGVmdCxpPWIucGxvdFRvcCxqPWIucGxvdFdpZHRoLGs9Yi5wbG90SGVpZ2h0LGwsbT10aGlzLnNlbGVjdGlvbk1hcmtlcixuPXRoaXMubW91c2VEb3duWCxwPXRoaXMubW91c2VEb3duWSxyPWMucGFuS2V5JiZhW2MucGFuS2V5K1wiS2V5XCJdO2lmKCFtfHwhbS50b3VjaClpZihkPGg/ZD1oOmQ+aCtqJiYoZD1oK2opLGU8aT9lPWk6ZT5pK2smJihlPWkrayksdGhpcy5oYXNEcmFnZ2VkPU1hdGguc3FydChNYXRoLnBvdyhuLWQsMikrTWF0aC5wb3cocC1lLDIpKSx0aGlzLmhhc0RyYWdnZWQ+MTApe2w9Yi5pc0luc2lkZVBsb3Qobi1oLHAtaSk7aWYoYi5oYXNDYXJ0ZXNpYW5TZXJpZXMmJih0aGlzLnpvb21YfHx0aGlzLnpvb21ZKSYmbCYmIXImJiFtKXRoaXMuc2VsZWN0aW9uTWFya2VyPW09Yi5yZW5kZXJlci5yZWN0KGgsaSxcbmY/MTpqLGc/MTprLDApLmF0dHIoe2ZpbGw6Yy5zZWxlY3Rpb25NYXJrZXJGaWxsfHxcInJnYmEoNjksMTE0LDE2NywwLjI1KVwiLHpJbmRleDo3fSkuYWRkKCk7bSYmZiYmKGQtPW4sbS5hdHRyKHt3aWR0aDpTKGQpLHg6KGQ+MD8wOmQpK259KSk7bSYmZyYmKGQ9ZS1wLG0uYXR0cih7aGVpZ2h0OlMoZCkseTooZD4wPzA6ZCkrcH0pKTtsJiYhbSYmYy5wYW5uaW5nJiZiLnBhbihhLGMucGFubmluZyl9fSxkcm9wOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMsYz10aGlzLmNoYXJ0LGQ9dGhpcy5oYXNQaW5jaGVkO2lmKHRoaXMuc2VsZWN0aW9uTWFya2VyKXt2YXIgZT17b3JpZ2luYWxFdmVudDphLHhBeGlzOltdLHlBeGlzOltdfSxmPXRoaXMuc2VsZWN0aW9uTWFya2VyLGc9Zi5hdHRyP2YuYXR0cihcInhcIik6Zi54LGg9Zi5hdHRyP2YuYXR0cihcInlcIik6Zi55LGk9Zi5hdHRyP2YuYXR0cihcIndpZHRoXCIpOmYud2lkdGgsaj1mLmF0dHI/Zi5hdHRyKFwiaGVpZ2h0XCIpOmYuaGVpZ2h0LGs7aWYodGhpcy5oYXNEcmFnZ2VkfHxcbmQpbyhjLmF4ZXMsZnVuY3Rpb24oYyl7aWYoYy56b29tRW5hYmxlZCYmdihjLm1pbikmJihkfHxiW3t4QXhpczpcInpvb21YXCIseUF4aXM6XCJ6b29tWVwifVtjLmNvbGxdXSkpe3ZhciBmPWMuaG9yaXosbj1hLnR5cGU9PT1cInRvdWNoZW5kXCI/Yy5taW5QaXhlbFBhZGRpbmc6MCxwPWMudG9WYWx1ZSgoZj9nOmgpK24pLGY9Yy50b1ZhbHVlKChmP2craTpoK2opLW4pO2VbYy5jb2xsXS5wdXNoKHtheGlzOmMsbWluOkcocCxmKSxtYXg6dyhwLGYpfSk7az0hMH19KSxrJiZPKGMsXCJzZWxlY3Rpb25cIixlLGZ1bmN0aW9uKGEpe2Muem9vbShBKGEsZD97YW5pbWF0aW9uOiExfTpudWxsKSl9KTt0aGlzLnNlbGVjdGlvbk1hcmtlcj10aGlzLnNlbGVjdGlvbk1hcmtlci5kZXN0cm95KCk7ZCYmdGhpcy5zY2FsZUdyb3VwcygpfWlmKGMpTihjLmNvbnRhaW5lcix7Y3Vyc29yOmMuX2N1cnNvcn0pLGMuY2FuY2VsQ2xpY2s9dGhpcy5oYXNEcmFnZ2VkPjEwLGMubW91c2VJc0Rvd249dGhpcy5oYXNEcmFnZ2VkPVxudGhpcy5oYXNQaW5jaGVkPSExLHRoaXMucGluY2hEb3duPVtdfSxvbkNvbnRhaW5lck1vdXNlRG93bjpmdW5jdGlvbihhKXthPXRoaXMubm9ybWFsaXplKGEpO2EucHJldmVudERlZmF1bHQmJmEucHJldmVudERlZmF1bHQoKTt0aGlzLmRyYWdTdGFydChhKX0sb25Eb2N1bWVudE1vdXNlVXA6ZnVuY3Rpb24oYSl7JFtvYV0mJiRbb2FdLnBvaW50ZXIuZHJvcChhKX0sb25Eb2N1bWVudE1vdXNlTW92ZTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNoYXJ0LGM9dGhpcy5jaGFydFBvc2l0aW9uLGE9dGhpcy5ub3JtYWxpemUoYSxjKTtjJiYhdGhpcy5pbkNsYXNzKGEudGFyZ2V0LFwiaGlnaGNoYXJ0cy10cmFja2VyXCIpJiYhYi5pc0luc2lkZVBsb3QoYS5jaGFydFgtYi5wbG90TGVmdCxhLmNoYXJ0WS1iLnBsb3RUb3ApJiZ0aGlzLnJlc2V0KCl9LG9uQ29udGFpbmVyTW91c2VMZWF2ZTpmdW5jdGlvbihhKXt2YXIgYj0kW29hXTtpZihiJiYoYS5yZWxhdGVkVGFyZ2V0fHxhLnRvRWxlbWVudCkpYi5wb2ludGVyLnJlc2V0KCksXG5iLnBvaW50ZXIuY2hhcnRQb3NpdGlvbj1udWxsfSxvbkNvbnRhaW5lck1vdXNlTW92ZTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNoYXJ0O2lmKCF2KG9hKXx8ISRbb2FdfHwhJFtvYV0ubW91c2VJc0Rvd24pb2E9Yi5pbmRleDthPXRoaXMubm9ybWFsaXplKGEpO2EucmV0dXJuVmFsdWU9ITE7Yi5tb3VzZUlzRG93bj09PVwibW91c2Vkb3duXCImJnRoaXMuZHJhZyhhKTsodGhpcy5pbkNsYXNzKGEudGFyZ2V0LFwiaGlnaGNoYXJ0cy10cmFja2VyXCIpfHxiLmlzSW5zaWRlUGxvdChhLmNoYXJ0WC1iLnBsb3RMZWZ0LGEuY2hhcnRZLWIucGxvdFRvcCkpJiYhYi5vcGVuTWVudSYmdGhpcy5ydW5Qb2ludEFjdGlvbnMoYSl9LGluQ2xhc3M6ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM7YTspe2lmKGM9WChhLFwiY2xhc3NcIikpe2lmKGMuaW5kZXhPZihiKSE9PS0xKXJldHVybiEwO2lmKGMuaW5kZXhPZihcImhpZ2hjaGFydHMtY29udGFpbmVyXCIpIT09LTEpcmV0dXJuITF9YT1hLnBhcmVudE5vZGV9fSxcbm9uVHJhY2tlck1vdXNlT3V0OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY2hhcnQuaG92ZXJTZXJpZXMsYT1hLnJlbGF0ZWRUYXJnZXR8fGEudG9FbGVtZW50O2lmKGImJmEmJiFiLm9wdGlvbnMuc3RpY2t5VHJhY2tpbmcmJiF0aGlzLmluQ2xhc3MoYSxcImhpZ2hjaGFydHMtdG9vbHRpcFwiKSYmIXRoaXMuaW5DbGFzcyhhLFwiaGlnaGNoYXJ0cy1zZXJpZXMtXCIrYi5pbmRleCkpYi5vbk1vdXNlT3V0KCl9LG9uQ29udGFpbmVyQ2xpY2s6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jaGFydCxjPWIuaG92ZXJQb2ludCxkPWIucGxvdExlZnQsZT1iLnBsb3RUb3AsYT10aGlzLm5vcm1hbGl6ZShhKTtiLmNhbmNlbENsaWNrfHwoYyYmdGhpcy5pbkNsYXNzKGEudGFyZ2V0LFwiaGlnaGNoYXJ0cy10cmFja2VyXCIpPyhPKGMuc2VyaWVzLFwiY2xpY2tcIixBKGEse3BvaW50OmN9KSksYi5ob3ZlclBvaW50JiZjLmZpcmVQb2ludEV2ZW50KFwiY2xpY2tcIixhKSk6KEEoYSx0aGlzLmdldENvb3JkaW5hdGVzKGEpKSxcbmIuaXNJbnNpZGVQbG90KGEuY2hhcnRYLWQsYS5jaGFydFktZSkmJk8oYixcImNsaWNrXCIsYSkpKX0sc2V0RE9NRXZlbnRzOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEuY2hhcnQuY29udGFpbmVyO2Iub25tb3VzZWRvd249ZnVuY3Rpb24oYil7YS5vbkNvbnRhaW5lck1vdXNlRG93bihiKX07Yi5vbm1vdXNlbW92ZT1mdW5jdGlvbihiKXthLm9uQ29udGFpbmVyTW91c2VNb3ZlKGIpfTtiLm9uY2xpY2s9ZnVuY3Rpb24oYil7YS5vbkNvbnRhaW5lckNsaWNrKGIpfTtFKGIsXCJtb3VzZWxlYXZlXCIsYS5vbkNvbnRhaW5lck1vdXNlTGVhdmUpO2tiPT09MSYmRShILFwibW91c2V1cFwiLGEub25Eb2N1bWVudE1vdXNlVXApO2lmKGNiKWIub250b3VjaHN0YXJ0PWZ1bmN0aW9uKGIpe2Eub25Db250YWluZXJUb3VjaFN0YXJ0KGIpfSxiLm9udG91Y2htb3ZlPWZ1bmN0aW9uKGIpe2Eub25Db250YWluZXJUb3VjaE1vdmUoYil9LGtiPT09MSYmRShILFwidG91Y2hlbmRcIixhLm9uRG9jdW1lbnRUb3VjaEVuZCl9LFxuZGVzdHJveTpmdW5jdGlvbigpe3ZhciBhO1QodGhpcy5jaGFydC5jb250YWluZXIsXCJtb3VzZWxlYXZlXCIsdGhpcy5vbkNvbnRhaW5lck1vdXNlTGVhdmUpO2tifHwoVChILFwibW91c2V1cFwiLHRoaXMub25Eb2N1bWVudE1vdXNlVXApLFQoSCxcInRvdWNoZW5kXCIsdGhpcy5vbkRvY3VtZW50VG91Y2hFbmQpKTtjbGVhckludGVydmFsKHRoaXMudG9vbHRpcFRpbWVvdXQpO2ZvcihhIGluIHRoaXMpdGhpc1thXT1udWxsfX07QShCLlBvaW50ZXIucHJvdG90eXBlLHtwaW5jaFRyYW5zbGF0ZTpmdW5jdGlvbihhLGIsYyxkLGUsZil7KHRoaXMuem9vbUhvcnx8dGhpcy5waW5jaEhvcikmJnRoaXMucGluY2hUcmFuc2xhdGVEaXJlY3Rpb24oITAsYSxiLGMsZCxlLGYpOyh0aGlzLnpvb21WZXJ0fHx0aGlzLnBpbmNoVmVydCkmJnRoaXMucGluY2hUcmFuc2xhdGVEaXJlY3Rpb24oITEsYSxiLGMsZCxlLGYpfSxwaW5jaFRyYW5zbGF0ZURpcmVjdGlvbjpmdW5jdGlvbihhLGIsYyxkLGUsZixnLGgpe3ZhciBpPVxudGhpcy5jaGFydCxqPWE/XCJ4XCI6XCJ5XCIsaz1hP1wiWFwiOlwiWVwiLGw9XCJjaGFydFwiK2ssbT1hP1wid2lkdGhcIjpcImhlaWdodFwiLG49aVtcInBsb3RcIisoYT9cIkxlZnRcIjpcIlRvcFwiKV0scCxyLHM9aHx8MSxxPWkuaW52ZXJ0ZWQsbz1pLmJvdW5kc1thP1wiaFwiOlwidlwiXSx4PWIubGVuZ3RoPT09MSxEPWJbMF1bbF0sdj1jWzBdW2xdLHc9IXgmJmJbMV1bbF0seT0heCYmY1sxXVtsXSx0LGM9ZnVuY3Rpb24oKXsheCYmUyhELXcpPjIwJiYocz1ofHxTKHYteSkvUyhELXcpKTtyPShuLXYpL3MrRDtwPWlbXCJwbG90XCIrKGE/XCJXaWR0aFwiOlwiSGVpZ2h0XCIpXS9zfTtjKCk7Yj1yO2I8by5taW4/KGI9by5taW4sdD0hMCk6YitwPm8ubWF4JiYoYj1vLm1heC1wLHQ9ITApO3Q/KHYtPTAuOCoodi1nW2pdWzBdKSx4fHwoeS09MC44Kih5LWdbal1bMV0pKSxjKCkpOmdbal09W3YseV07cXx8KGZbal09ci1uLGZbbV09cCk7Zj1xPzEvczpzO2VbbV09cDtlW2pdPWI7ZFtxP2E/XCJzY2FsZVlcIjpcInNjYWxlWFwiOlwic2NhbGVcIitcbmtdPXM7ZFtcInRyYW5zbGF0ZVwiK2tdPWYqbisodi1mKkQpfSxwaW5jaDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLGM9Yi5jaGFydCxkPWIucGluY2hEb3duLGU9YS50b3VjaGVzLGY9ZS5sZW5ndGgsZz1iLmxhc3RWYWxpZFRvdWNoLGg9Yi5oYXNab29tLGk9Yi5zZWxlY3Rpb25NYXJrZXIsaj17fSxrPWY9PT0xJiYoYi5pbkNsYXNzKGEudGFyZ2V0LFwiaGlnaGNoYXJ0cy10cmFja2VyXCIpJiZjLnJ1blRyYWNrZXJDbGlja3x8Yi5ydW5DaGFydENsaWNrKSxsPXt9O2lmKGY+MSliLmluaXRpYXRlZD0hMDtoJiZiLmluaXRpYXRlZCYmIWsmJmEucHJldmVudERlZmF1bHQoKTt0YShlLGZ1bmN0aW9uKGEpe3JldHVybiBiLm5vcm1hbGl6ZShhKX0pO2lmKGEudHlwZT09PVwidG91Y2hzdGFydFwiKW8oZSxmdW5jdGlvbihhLGIpe2RbYl09e2NoYXJ0WDphLmNoYXJ0WCxjaGFydFk6YS5jaGFydFl9fSksZy54PVtkWzBdLmNoYXJ0WCxkWzFdJiZkWzFdLmNoYXJ0WF0sZy55PVtkWzBdLmNoYXJ0WSxkWzFdJiZcbmRbMV0uY2hhcnRZXSxvKGMuYXhlcyxmdW5jdGlvbihhKXtpZihhLnpvb21FbmFibGVkKXt2YXIgYj1jLmJvdW5kc1thLmhvcml6P1wiaFwiOlwidlwiXSxkPWEubWluUGl4ZWxQYWRkaW5nLGU9YS50b1BpeGVscyhxKGEub3B0aW9ucy5taW4sYS5kYXRhTWluKSksZj1hLnRvUGl4ZWxzKHEoYS5vcHRpb25zLm1heCxhLmRhdGFNYXgpKSxnPUcoZSxmKSxlPXcoZSxmKTtiLm1pbj1HKGEucG9zLGctZCk7Yi5tYXg9dyhhLnBvcythLmxlbixlK2QpfX0pLGIucmVzPSEwO2Vsc2UgaWYoZC5sZW5ndGgpe2lmKCFpKWIuc2VsZWN0aW9uTWFya2VyPWk9QSh7ZGVzdHJveTpyYSx0b3VjaDohMH0sYy5wbG90Qm94KTtiLnBpbmNoVHJhbnNsYXRlKGQsZSxqLGksbCxnKTtiLmhhc1BpbmNoZWQ9aDtiLnNjYWxlR3JvdXBzKGosbCk7aWYoIWgmJmIuZm9sbG93VG91Y2hNb3ZlJiZmPT09MSl0aGlzLnJ1blBvaW50QWN0aW9ucyhiLm5vcm1hbGl6ZShhKSk7ZWxzZSBpZihiLnJlcyliLnJlcz0hMSx0aGlzLnJlc2V0KCExLFxuMCl9fSx0b3VjaDpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuY2hhcnQsZDtvYT1jLmluZGV4O2lmKGEudG91Y2hlcy5sZW5ndGg9PT0xKWlmKGE9dGhpcy5ub3JtYWxpemUoYSksYy5pc0luc2lkZVBsb3QoYS5jaGFydFgtYy5wbG90TGVmdCxhLmNoYXJ0WS1jLnBsb3RUb3ApJiYhYy5vcGVuTWVudSl7YiYmdGhpcy5ydW5Qb2ludEFjdGlvbnMoYSk7aWYoYS50eXBlPT09XCJ0b3VjaG1vdmVcIiljPXRoaXMucGluY2hEb3duLGQ9Y1swXT9NYXRoLnNxcnQoTWF0aC5wb3coY1swXS5jaGFydFgtYS5jaGFydFgsMikrTWF0aC5wb3coY1swXS5jaGFydFktYS5jaGFydFksMikpPj00OiExO3EoZCwhMCkmJnRoaXMucGluY2goYSl9ZWxzZSBiJiZ0aGlzLnJlc2V0KCk7ZWxzZSBhLnRvdWNoZXMubGVuZ3RoPT09MiYmdGhpcy5waW5jaChhKX0sb25Db250YWluZXJUb3VjaFN0YXJ0OmZ1bmN0aW9uKGEpe3RoaXMudG91Y2goYSwhMCl9LG9uQ29udGFpbmVyVG91Y2hNb3ZlOmZ1bmN0aW9uKGEpe3RoaXMudG91Y2goYSl9LFxub25Eb2N1bWVudFRvdWNoRW5kOmZ1bmN0aW9uKGEpeyRbb2FdJiYkW29hXS5wb2ludGVyLmRyb3AoYSl9fSk7aWYoTC5Qb2ludGVyRXZlbnR8fEwuTVNQb2ludGVyRXZlbnQpe3ZhciBHYT17fSxNYj0hIUwuUG9pbnRlckV2ZW50LGFjPWZ1bmN0aW9uKCl7dmFyIGEsYj1bXTtiLml0ZW09ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXNbYV19O2ZvcihhIGluIEdhKUdhLmhhc093blByb3BlcnR5KGEpJiZiLnB1c2goe3BhZ2VYOkdhW2FdLnBhZ2VYLHBhZ2VZOkdhW2FdLnBhZ2VZLHRhcmdldDpHYVthXS50YXJnZXR9KTtyZXR1cm4gYn0sTmI9ZnVuY3Rpb24oYSxiLGMsZCl7aWYoKGEucG9pbnRlclR5cGU9PT1cInRvdWNoXCJ8fGEucG9pbnRlclR5cGU9PT1hLk1TUE9JTlRFUl9UWVBFX1RPVUNIKSYmJFtvYV0pZChhKSxkPSRbb2FdLnBvaW50ZXIsZFtiXSh7dHlwZTpjLHRhcmdldDphLmN1cnJlbnRUYXJnZXQscHJldmVudERlZmF1bHQ6cmEsdG91Y2hlczphYygpfSl9O0EoWWEucHJvdG90eXBlLFxue29uQ29udGFpbmVyUG9pbnRlckRvd246ZnVuY3Rpb24oYSl7TmIoYSxcIm9uQ29udGFpbmVyVG91Y2hTdGFydFwiLFwidG91Y2hzdGFydFwiLGZ1bmN0aW9uKGEpe0dhW2EucG9pbnRlcklkXT17cGFnZVg6YS5wYWdlWCxwYWdlWTphLnBhZ2VZLHRhcmdldDphLmN1cnJlbnRUYXJnZXR9fSl9LG9uQ29udGFpbmVyUG9pbnRlck1vdmU6ZnVuY3Rpb24oYSl7TmIoYSxcIm9uQ29udGFpbmVyVG91Y2hNb3ZlXCIsXCJ0b3VjaG1vdmVcIixmdW5jdGlvbihhKXtHYVthLnBvaW50ZXJJZF09e3BhZ2VYOmEucGFnZVgscGFnZVk6YS5wYWdlWX07aWYoIUdhW2EucG9pbnRlcklkXS50YXJnZXQpR2FbYS5wb2ludGVySWRdLnRhcmdldD1hLmN1cnJlbnRUYXJnZXR9KX0sb25Eb2N1bWVudFBvaW50ZXJVcDpmdW5jdGlvbihhKXtOYihhLFwib25Eb2N1bWVudFRvdWNoRW5kXCIsXCJ0b3VjaGVuZFwiLGZ1bmN0aW9uKGEpe2RlbGV0ZSBHYVthLnBvaW50ZXJJZF19KX0sYmF0Y2hNU0V2ZW50czpmdW5jdGlvbihhKXthKHRoaXMuY2hhcnQuY29udGFpbmVyLFxuTWI/XCJwb2ludGVyZG93blwiOlwiTVNQb2ludGVyRG93blwiLHRoaXMub25Db250YWluZXJQb2ludGVyRG93bik7YSh0aGlzLmNoYXJ0LmNvbnRhaW5lcixNYj9cInBvaW50ZXJtb3ZlXCI6XCJNU1BvaW50ZXJNb3ZlXCIsdGhpcy5vbkNvbnRhaW5lclBvaW50ZXJNb3ZlKTthKEgsTWI/XCJwb2ludGVydXBcIjpcIk1TUG9pbnRlclVwXCIsdGhpcy5vbkRvY3VtZW50UG9pbnRlclVwKX19KTtVKFlhLnByb3RvdHlwZSxcImluaXRcIixmdW5jdGlvbihhLGIsYyl7YS5jYWxsKHRoaXMsYixjKTt0aGlzLmhhc1pvb20mJk4oYi5jb250YWluZXIse1wiLW1zLXRvdWNoLWFjdGlvblwiOlwibm9uZVwiLFwidG91Y2gtYWN0aW9uXCI6XCJub25lXCJ9KX0pO1UoWWEucHJvdG90eXBlLFwic2V0RE9NRXZlbnRzXCIsZnVuY3Rpb24oYSl7YS5hcHBseSh0aGlzKTsodGhpcy5oYXNab29tfHx0aGlzLmZvbGxvd1RvdWNoTW92ZSkmJnRoaXMuYmF0Y2hNU0V2ZW50cyhFKX0pO1UoWWEucHJvdG90eXBlLFwiZGVzdHJveVwiLGZ1bmN0aW9uKGEpe3RoaXMuYmF0Y2hNU0V2ZW50cyhUKTtcbmEuY2FsbCh0aGlzKX0pfXZhciB1Yj1CLkxlZ2VuZD1mdW5jdGlvbihhLGIpe3RoaXMuaW5pdChhLGIpfTt1Yi5wcm90b3R5cGU9e2luaXQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLGQ9Yi5pdGVtU3R5bGUsZT1iLml0ZW1NYXJnaW5Ub3B8fDA7dGhpcy5vcHRpb25zPWI7aWYoYi5lbmFibGVkKWMuaXRlbVN0eWxlPWQsYy5pdGVtSGlkZGVuU3R5bGU9eihkLGIuaXRlbUhpZGRlblN0eWxlKSxjLml0ZW1NYXJnaW5Ub3A9ZSxjLnBhZGRpbmc9ZD1xKGIucGFkZGluZyw4KSxjLmluaXRpYWxJdGVtWD1kLGMuaW5pdGlhbEl0ZW1ZPWQtNSxjLm1heEl0ZW1XaWR0aD0wLGMuY2hhcnQ9YSxjLml0ZW1IZWlnaHQ9MCxjLnN5bWJvbFdpZHRoPXEoYi5zeW1ib2xXaWR0aCwxNiksYy5wYWdlcz1bXSxjLnJlbmRlcigpLEUoYy5jaGFydCxcImVuZFJlc2l6ZVwiLGZ1bmN0aW9uKCl7Yy5wb3NpdGlvbkNoZWNrYm94ZXMoKX0pfSxjb2xvcml6ZUl0ZW06ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLm9wdGlvbnMsXG5kPWEubGVnZW5kSXRlbSxlPWEubGVnZW5kTGluZSxmPWEubGVnZW5kU3ltYm9sLGc9dGhpcy5pdGVtSGlkZGVuU3R5bGUuY29sb3IsYz1iP2MuaXRlbVN0eWxlLmNvbG9yOmcsaD1iP2EubGVnZW5kQ29sb3J8fGEuY29sb3J8fFwiI0NDQ1wiOmcsZz1hLm9wdGlvbnMmJmEub3B0aW9ucy5tYXJrZXIsaT17ZmlsbDpofSxqO2QmJmQuY3NzKHtmaWxsOmMsY29sb3I6Y30pO2UmJmUuYXR0cih7c3Ryb2tlOmh9KTtpZihmKXtpZihnJiZmLmlzTWFya2VyKWZvcihqIGluIGkuc3Ryb2tlPWgsZz1hLmNvbnZlcnRBdHRyaWJzKGcpLGcpZD1nW2pdLGQhPT10JiYoaVtqXT1kKTtmLmF0dHIoaSl9fSxwb3NpdGlvbkl0ZW06ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5vcHRpb25zLGM9Yi5zeW1ib2xQYWRkaW5nLGI9IWIucnRsLGQ9YS5fbGVnZW5kSXRlbVBvcyxlPWRbMF0sZD1kWzFdLGY9YS5jaGVja2JveDsoYT1hLmxlZ2VuZEdyb3VwKSYmYS5lbGVtZW50JiZhLnRyYW5zbGF0ZShiP2U6dGhpcy5sZWdlbmRXaWR0aC1cbmUtMipjLTQsZCk7aWYoZilmLng9ZSxmLnk9ZH0sZGVzdHJveUl0ZW06ZnVuY3Rpb24oYSl7dmFyIGI9YS5jaGVja2JveDtvKFtcImxlZ2VuZEl0ZW1cIixcImxlZ2VuZExpbmVcIixcImxlZ2VuZFN5bWJvbFwiLFwibGVnZW5kR3JvdXBcIl0sZnVuY3Rpb24oYil7YVtiXSYmKGFbYl09YVtiXS5kZXN0cm95KCkpfSk7YiYmVWEoYS5jaGVja2JveCl9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmdyb3VwLGI9dGhpcy5ib3g7aWYoYil0aGlzLmJveD1iLmRlc3Ryb3koKTtpZihhKXRoaXMuZ3JvdXA9YS5kZXN0cm95KCl9LHBvc2l0aW9uQ2hlY2tib3hlczpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmdyb3VwLmFsaWduQXR0cixjLGQ9dGhpcy5jbGlwSGVpZ2h0fHx0aGlzLmxlZ2VuZEhlaWdodCxlPXRoaXMudGl0bGVIZWlnaHQ7aWYoYiljPWIudHJhbnNsYXRlWSxvKHRoaXMuYWxsSXRlbXMsZnVuY3Rpb24oZil7dmFyIGc9Zi5jaGVja2JveCxoO2cmJihoPWMrZStnLnkrKGF8fDApKzMsTihnLFxue2xlZnQ6Yi50cmFuc2xhdGVYK2YuY2hlY2tib3hPZmZzZXQrZy54LTIwK1wicHhcIix0b3A6aCtcInB4XCIsZGlzcGxheTpoPmMtNiYmaDxjK2QtNj9cIlwiOlwibm9uZVwifSkpfSl9LHJlbmRlclRpdGxlOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5wYWRkaW5nLGI9dGhpcy5vcHRpb25zLnRpdGxlLGM9MDtpZihiLnRleHQpe2lmKCF0aGlzLnRpdGxlKXRoaXMudGl0bGU9dGhpcy5jaGFydC5yZW5kZXJlci5sYWJlbChiLnRleHQsYS0zLGEtNCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsXCJsZWdlbmQtdGl0bGVcIikuYXR0cih7ekluZGV4OjF9KS5jc3MoYi5zdHlsZSkuYWRkKHRoaXMuZ3JvdXApO2E9dGhpcy50aXRsZS5nZXRCQm94KCk7Yz1hLmhlaWdodDt0aGlzLm9mZnNldFdpZHRoPWEud2lkdGg7dGhpcy5jb250ZW50R3JvdXAuYXR0cih7dHJhbnNsYXRlWTpjfSl9dGhpcy50aXRsZUhlaWdodD1jfSxzZXRUZXh0OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMub3B0aW9uczthLmxlZ2VuZEl0ZW0uYXR0cih7dGV4dDpiLmxhYmVsRm9ybWF0P1xuTGEoYi5sYWJlbEZvcm1hdCxhKTpiLmxhYmVsRm9ybWF0dGVyLmNhbGwoYSl9KX0scmVuZGVySXRlbTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNoYXJ0LGM9Yi5yZW5kZXJlcixkPXRoaXMub3B0aW9ucyxlPWQubGF5b3V0PT09XCJob3Jpem9udGFsXCIsZj10aGlzLnN5bWJvbFdpZHRoLGc9ZC5zeW1ib2xQYWRkaW5nLGg9dGhpcy5pdGVtU3R5bGUsaT10aGlzLml0ZW1IaWRkZW5TdHlsZSxqPXRoaXMucGFkZGluZyxrPWU/cShkLml0ZW1EaXN0YW5jZSwyMCk6MCxsPSFkLnJ0bCxtPWQud2lkdGgsbj1kLml0ZW1NYXJnaW5Cb3R0b218fDAscD10aGlzLml0ZW1NYXJnaW5Ub3Ascj10aGlzLmluaXRpYWxJdGVtWCxzPWEubGVnZW5kSXRlbSxvPWEuc2VyaWVzJiZhLnNlcmllcy5kcmF3TGVnZW5kU3ltYm9sP2Euc2VyaWVzOmEsdT1vLm9wdGlvbnMsdT10aGlzLmNyZWF0ZUNoZWNrYm94Rm9ySXRlbSYmdSYmdS5zaG93Q2hlY2tib3gseD1kLnVzZUhUTUw7aWYoIXMpe2EubGVnZW5kR3JvdXA9XG5jLmcoXCJsZWdlbmQtaXRlbVwiKS5hdHRyKHt6SW5kZXg6MX0pLmFkZCh0aGlzLnNjcm9sbEdyb3VwKTthLmxlZ2VuZEl0ZW09cz1jLnRleHQoXCJcIixsP2YrZzotZyx0aGlzLmJhc2VsaW5lfHwwLHgpLmNzcyh6KGEudmlzaWJsZT9oOmkpKS5hdHRyKHthbGlnbjpsP1wibGVmdFwiOlwicmlnaHRcIix6SW5kZXg6Mn0pLmFkZChhLmxlZ2VuZEdyb3VwKTtpZighdGhpcy5iYXNlbGluZSl0aGlzLmZvbnRNZXRyaWNzPWMuZm9udE1ldHJpY3MoaC5mb250U2l6ZSxzKSx0aGlzLmJhc2VsaW5lPXRoaXMuZm9udE1ldHJpY3MuZiszK3Ascy5hdHRyKFwieVwiLHRoaXMuYmFzZWxpbmUpO28uZHJhd0xlZ2VuZFN5bWJvbCh0aGlzLGEpO3RoaXMuc2V0SXRlbUV2ZW50cyYmdGhpcy5zZXRJdGVtRXZlbnRzKGEscyx4LGgsaSk7dSYmdGhpcy5jcmVhdGVDaGVja2JveEZvckl0ZW0oYSl9dGhpcy5jb2xvcml6ZUl0ZW0oYSxhLnZpc2libGUpO3RoaXMuc2V0VGV4dChhKTtjPXMuZ2V0QkJveCgpO2Y9YS5jaGVja2JveE9mZnNldD1cbmQuaXRlbVdpZHRofHxhLmxlZ2VuZEl0ZW1XaWR0aHx8ZitnK2Mud2lkdGgraysodT8yMDowKTt0aGlzLml0ZW1IZWlnaHQ9Zz15KGEubGVnZW5kSXRlbUhlaWdodHx8Yy5oZWlnaHQpO2lmKGUmJnRoaXMuaXRlbVgtcitmPihtfHxiLmNoYXJ0V2lkdGgtMipqLXItZC54KSl0aGlzLml0ZW1YPXIsdGhpcy5pdGVtWSs9cCt0aGlzLmxhc3RMaW5lSGVpZ2h0K24sdGhpcy5sYXN0TGluZUhlaWdodD0wO3RoaXMubWF4SXRlbVdpZHRoPXcodGhpcy5tYXhJdGVtV2lkdGgsZik7dGhpcy5sYXN0SXRlbVk9cCt0aGlzLml0ZW1ZK247dGhpcy5sYXN0TGluZUhlaWdodD13KGcsdGhpcy5sYXN0TGluZUhlaWdodCk7YS5fbGVnZW5kSXRlbVBvcz1bdGhpcy5pdGVtWCx0aGlzLml0ZW1ZXTtlP3RoaXMuaXRlbVgrPWY6KHRoaXMuaXRlbVkrPXArZytuLHRoaXMubGFzdExpbmVIZWlnaHQ9Zyk7dGhpcy5vZmZzZXRXaWR0aD1tfHx3KChlP3RoaXMuaXRlbVgtci1rOmYpK2osdGhpcy5vZmZzZXRXaWR0aCl9LFxuZ2V0QWxsSXRlbXM6ZnVuY3Rpb24oKXt2YXIgYT1bXTtvKHRoaXMuY2hhcnQuc2VyaWVzLGZ1bmN0aW9uKGIpe3ZhciBjPWIub3B0aW9ucztpZihxKGMuc2hvd0luTGVnZW5kLCF2KGMubGlua2VkVG8pP3Q6ITEsITApKWE9YS5jb25jYXQoYi5sZWdlbmRJdGVtc3x8KGMubGVnZW5kVHlwZT09PVwicG9pbnRcIj9iLmRhdGE6YikpfSk7cmV0dXJuIGF9LGFkanVzdE1hcmdpbnM6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmNoYXJ0LGQ9dGhpcy5vcHRpb25zLGU9ZC5hbGlnbi5jaGFyQXQoMCkrZC52ZXJ0aWNhbEFsaWduLmNoYXJBdCgwKStkLmxheW91dC5jaGFyQXQoMCk7dGhpcy5kaXNwbGF5JiYhZC5mbG9hdGluZyYmbyhbLyhsdGh8Y3R8cnRoKS8sLyhydHZ8cm18cmJ2KS8sLyhyYmh8Y2J8bGJoKS8sLyhsYnZ8bG18bHR2KS9dLGZ1bmN0aW9uKGYsZyl7Zi50ZXN0KGUpJiYhdihhW2ddKSYmKGNbdGJbZ11dPXcoY1t0YltnXV0sYy5sZWdlbmRbKGcrMSklMj9cImxlZ2VuZEhlaWdodFwiOlxuXCJsZWdlbmRXaWR0aFwiXStbMSwtMSwtMSwxXVtnXSpkW2clMj9cInhcIjpcInlcIl0rcShkLm1hcmdpbiwxMikrYltnXSkpfSl9LHJlbmRlcjpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLmNoYXJ0LGM9Yi5yZW5kZXJlcixkPWEuZ3JvdXAsZSxmLGcsaCxpPWEuYm94LGo9YS5vcHRpb25zLGs9YS5wYWRkaW5nLGw9ai5ib3JkZXJXaWR0aCxtPWouYmFja2dyb3VuZENvbG9yO2EuaXRlbVg9YS5pbml0aWFsSXRlbVg7YS5pdGVtWT1hLmluaXRpYWxJdGVtWTthLm9mZnNldFdpZHRoPTA7YS5sYXN0SXRlbVk9MDtpZighZClhLmdyb3VwPWQ9Yy5nKFwibGVnZW5kXCIpLmF0dHIoe3pJbmRleDo3fSkuYWRkKCksYS5jb250ZW50R3JvdXA9Yy5nKCkuYXR0cih7ekluZGV4OjF9KS5hZGQoZCksYS5zY3JvbGxHcm91cD1jLmcoKS5hZGQoYS5jb250ZW50R3JvdXApO2EucmVuZGVyVGl0bGUoKTtlPWEuZ2V0QWxsSXRlbXMoKTtuYihlLGZ1bmN0aW9uKGEsYil7cmV0dXJuKGEub3B0aW9ucyYmYS5vcHRpb25zLmxlZ2VuZEluZGV4fHxcbjApLShiLm9wdGlvbnMmJmIub3B0aW9ucy5sZWdlbmRJbmRleHx8MCl9KTtqLnJldmVyc2VkJiZlLnJldmVyc2UoKTthLmFsbEl0ZW1zPWU7YS5kaXNwbGF5PWY9ISFlLmxlbmd0aDthLmxhc3RMaW5lSGVpZ2h0PTA7byhlLGZ1bmN0aW9uKGIpe2EucmVuZGVySXRlbShiKX0pO2c9KGoud2lkdGh8fGEub2Zmc2V0V2lkdGgpK2s7aD1hLmxhc3RJdGVtWSthLmxhc3RMaW5lSGVpZ2h0K2EudGl0bGVIZWlnaHQ7aD1hLmhhbmRsZU92ZXJmbG93KGgpO2grPWs7aWYobHx8bSl7aWYoaSl7aWYoZz4wJiZoPjApaVtpLmlzTmV3P1wiYXR0clwiOlwiYW5pbWF0ZVwiXShpLmNyaXNwKHt3aWR0aDpnLGhlaWdodDpofSkpLGkuaXNOZXc9ITF9ZWxzZSBhLmJveD1pPWMucmVjdCgwLDAsZyxoLGouYm9yZGVyUmFkaXVzLGx8fDApLmF0dHIoe3N0cm9rZTpqLmJvcmRlckNvbG9yLFwic3Ryb2tlLXdpZHRoXCI6bHx8MCxmaWxsOm18fFwibm9uZVwifSkuYWRkKGQpLnNoYWRvdyhqLnNoYWRvdyksaS5pc05ldz0hMDtpW2Y/XG5cInNob3dcIjpcImhpZGVcIl0oKX1hLmxlZ2VuZFdpZHRoPWc7YS5sZWdlbmRIZWlnaHQ9aDtvKGUsZnVuY3Rpb24oYil7YS5wb3NpdGlvbkl0ZW0oYil9KTtmJiZkLmFsaWduKEEoe3dpZHRoOmcsaGVpZ2h0Omh9LGopLCEwLFwic3BhY2luZ0JveFwiKTtiLmlzUmVzaXppbmd8fHRoaXMucG9zaXRpb25DaGVja2JveGVzKCl9LGhhbmRsZU92ZXJmbG93OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMsYz10aGlzLmNoYXJ0LGQ9Yy5yZW5kZXJlcixlPXRoaXMub3B0aW9ucyxmPWUueSxmPWMuc3BhY2luZ0JveC5oZWlnaHQrKGUudmVydGljYWxBbGlnbj09PVwidG9wXCI/LWY6ZiktdGhpcy5wYWRkaW5nLGc9ZS5tYXhIZWlnaHQsaCxpPXRoaXMuY2xpcFJlY3Qsaj1lLm5hdmlnYXRpb24saz1xKGouYW5pbWF0aW9uLCEwKSxsPWouYXJyb3dTaXplfHwxMixtPXRoaXMubmF2LG49dGhpcy5wYWdlcyxwPXRoaXMucGFkZGluZyxyLHM9dGhpcy5hbGxJdGVtcyxGPWZ1bmN0aW9uKGEpe2kuYXR0cih7aGVpZ2h0OmF9KTtcbmlmKGIuY29udGVudEdyb3VwLmRpdiliLmNvbnRlbnRHcm91cC5kaXYuc3R5bGUuY2xpcD1cInJlY3QoXCIrcCtcInB4LDk5OTlweCxcIisocCthKStcInB4LDApXCJ9O2UubGF5b3V0PT09XCJob3Jpem9udGFsXCImJihmLz0yKTtnJiYoZj1HKGYsZykpO24ubGVuZ3RoPTA7aWYoYT5mJiZqLmVuYWJsZWQhPT0hMSl7dGhpcy5jbGlwSGVpZ2h0PWg9dyhmLTIwLXRoaXMudGl0bGVIZWlnaHQtcCwwKTt0aGlzLmN1cnJlbnRQYWdlPXEodGhpcy5jdXJyZW50UGFnZSwxKTt0aGlzLmZ1bGxIZWlnaHQ9YTtvKHMsZnVuY3Rpb24oYSxiKXt2YXIgYz1hLl9sZWdlbmRJdGVtUG9zWzFdLGQ9eShhLmxlZ2VuZEl0ZW0uZ2V0QkJveCgpLmhlaWdodCksZT1uLmxlbmd0aDtpZighZXx8Yy1uW2UtMV0+aCYmKHJ8fGMpIT09bltlLTFdKW4ucHVzaChyfHxjKSxlKys7Yj09PXMubGVuZ3RoLTEmJmMrZC1uW2UtMV0+aCYmbi5wdXNoKGMpO2MhPT1yJiYocj1jKX0pO2lmKCFpKWk9Yi5jbGlwUmVjdD1kLmNsaXBSZWN0KDAsXG5wLDk5OTksMCksYi5jb250ZW50R3JvdXAuY2xpcChpKTtGKGgpO2lmKCFtKXRoaXMubmF2PW09ZC5nKCkuYXR0cih7ekluZGV4OjF9KS5hZGQodGhpcy5ncm91cCksdGhpcy51cD1kLnN5bWJvbChcInRyaWFuZ2xlXCIsMCwwLGwsbCkub24oXCJjbGlja1wiLGZ1bmN0aW9uKCl7Yi5zY3JvbGwoLTEsayl9KS5hZGQobSksdGhpcy5wYWdlcj1kLnRleHQoXCJcIiwxNSwxMCkuY3NzKGouc3R5bGUpLmFkZChtKSx0aGlzLmRvd249ZC5zeW1ib2woXCJ0cmlhbmdsZS1kb3duXCIsMCwwLGwsbCkub24oXCJjbGlja1wiLGZ1bmN0aW9uKCl7Yi5zY3JvbGwoMSxrKX0pLmFkZChtKTtiLnNjcm9sbCgwKTthPWZ9ZWxzZSBpZihtKUYoYy5jaGFydEhlaWdodCksbS5oaWRlKCksdGhpcy5zY3JvbGxHcm91cC5hdHRyKHt0cmFuc2xhdGVZOjF9KSx0aGlzLmNsaXBIZWlnaHQ9MDtyZXR1cm4gYX0sc2Nyb2xsOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5wYWdlcyxkPWMubGVuZ3RoLGU9dGhpcy5jdXJyZW50UGFnZSthLFxuZj10aGlzLmNsaXBIZWlnaHQsZz10aGlzLm9wdGlvbnMubmF2aWdhdGlvbixoPWcuYWN0aXZlQ29sb3IsZz1nLmluYWN0aXZlQ29sb3IsaT10aGlzLnBhZ2VyLGo9dGhpcy5wYWRkaW5nO2U+ZCYmKGU9ZCk7aWYoZT4wKWIhPT10JiYkYShiLHRoaXMuY2hhcnQpLHRoaXMubmF2LmF0dHIoe3RyYW5zbGF0ZVg6aix0cmFuc2xhdGVZOmYrdGhpcy5wYWRkaW5nKzcrdGhpcy50aXRsZUhlaWdodCx2aXNpYmlsaXR5OlwidmlzaWJsZVwifSksdGhpcy51cC5hdHRyKHtmaWxsOmU9PT0xP2c6aH0pLmNzcyh7Y3Vyc29yOmU9PT0xP1wiZGVmYXVsdFwiOlwicG9pbnRlclwifSksaS5hdHRyKHt0ZXh0OmUrXCIvXCIrZH0pLHRoaXMuZG93bi5hdHRyKHt4OjE4K3RoaXMucGFnZXIuZ2V0QkJveCgpLndpZHRoLGZpbGw6ZT09PWQ/ZzpofSkuY3NzKHtjdXJzb3I6ZT09PWQ/XCJkZWZhdWx0XCI6XCJwb2ludGVyXCJ9KSxjPS1jW2UtMV0rdGhpcy5pbml0aWFsSXRlbVksdGhpcy5zY3JvbGxHcm91cC5hbmltYXRlKHt0cmFuc2xhdGVZOmN9KSxcbnRoaXMuY3VycmVudFBhZ2U9ZSx0aGlzLnBvc2l0aW9uQ2hlY2tib3hlcyhjKX19O2FhPUIuTGVnZW5kU3ltYm9sTWl4aW49e2RyYXdSZWN0YW5nbGU6ZnVuY3Rpb24oYSxiKXt2YXIgYz1hLm9wdGlvbnMuc3ltYm9sSGVpZ2h0fHxhLmZvbnRNZXRyaWNzLmY7Yi5sZWdlbmRTeW1ib2w9dGhpcy5jaGFydC5yZW5kZXJlci5yZWN0KDAsYS5iYXNlbGluZS1jKzEsYS5zeW1ib2xXaWR0aCxjLGEub3B0aW9ucy5zeW1ib2xSYWRpdXN8fDApLmF0dHIoe3pJbmRleDozfSkuYWRkKGIubGVnZW5kR3JvdXApfSxkcmF3TGluZU1hcmtlcjpmdW5jdGlvbihhKXt2YXIgYj10aGlzLm9wdGlvbnMsYz1iLm1hcmtlcixkPWEuc3ltYm9sV2lkdGgsZT10aGlzLmNoYXJ0LnJlbmRlcmVyLGY9dGhpcy5sZWdlbmRHcm91cCxhPWEuYmFzZWxpbmUteShhLmZvbnRNZXRyaWNzLmIqMC4zKSxnO2lmKGIubGluZVdpZHRoKXtnPXtcInN0cm9rZS13aWR0aFwiOmIubGluZVdpZHRofTtpZihiLmRhc2hTdHlsZSlnLmRhc2hzdHlsZT1cbmIuZGFzaFN0eWxlO3RoaXMubGVnZW5kTGluZT1lLnBhdGgoW1wiTVwiLDAsYSxcIkxcIixkLGFdKS5hdHRyKGcpLmFkZChmKX1pZihjJiZjLmVuYWJsZWQhPT0hMSliPWMucmFkaXVzLHRoaXMubGVnZW5kU3ltYm9sPWM9ZS5zeW1ib2wodGhpcy5zeW1ib2wsZC8yLWIsYS1iLDIqYiwyKmIsYykuYWRkKGYpLGMuaXNNYXJrZXI9ITB9fTsoL1RyaWRlbnRcXC83XFwuMC8udGVzdChOYSl8fFdhKSYmVSh1Yi5wcm90b3R5cGUsXCJwb3NpdGlvbkl0ZW1cIixmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMsZD1mdW5jdGlvbigpe2IuX2xlZ2VuZEl0ZW1Qb3MmJmEuY2FsbChjLGIpfTtkKCk7c2V0VGltZW91dChkKX0pO3ZhciBCYT1CLkNoYXJ0PWZ1bmN0aW9uKCl7dGhpcy5nZXRBcmdzLmFwcGx5KHRoaXMsYXJndW1lbnRzKX07Qi5jaGFydD1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIG5ldyBCYShhLGIsYyl9O0JhLnByb3RvdHlwZT17Y2FsbGJhY2tzOltdLGdldEFyZ3M6ZnVuY3Rpb24oKXt2YXIgYT1bXS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7XG5pZihDYShhWzBdKXx8YVswXS5ub2RlTmFtZSl0aGlzLnJlbmRlclRvPWEuc2hpZnQoKTt0aGlzLmluaXQoYVswXSxhWzFdKX0saW5pdDpmdW5jdGlvbihhLGIpe3ZhciBjLGQ9YS5zZXJpZXM7YS5zZXJpZXM9bnVsbDtjPXooUixhKTtjLnNlcmllcz1hLnNlcmllcz1kO3RoaXMudXNlck9wdGlvbnM9YTtkPWMuY2hhcnQ7dGhpcy5tYXJnaW49dGhpcy5zcGxhc2hBcnJheShcIm1hcmdpblwiLGQpO3RoaXMuc3BhY2luZz10aGlzLnNwbGFzaEFycmF5KFwic3BhY2luZ1wiLGQpO3ZhciBlPWQuZXZlbnRzO3RoaXMuYm91bmRzPXtoOnt9LHY6e319O3RoaXMuY2FsbGJhY2s9Yjt0aGlzLmlzUmVzaXppbmc9MDt0aGlzLm9wdGlvbnM9Yzt0aGlzLmF4ZXM9W107dGhpcy5zZXJpZXM9W107dGhpcy5oYXNDYXJ0ZXNpYW5TZXJpZXM9ZC5zaG93QXhlczt2YXIgZj10aGlzLGc7Zi5pbmRleD0kLmxlbmd0aDskLnB1c2goZik7a2IrKztkLnJlZmxvdyE9PSExJiZFKGYsXCJsb2FkXCIsZnVuY3Rpb24oKXtmLmluaXRSZWZsb3coKX0pO1xuaWYoZSlmb3IoZyBpbiBlKUUoZixnLGVbZ10pO2YueEF4aXM9W107Zi55QXhpcz1bXTtmLmFuaW1hdGlvbj1xYT8hMTpxKGQuYW5pbWF0aW9uLCEwKTtmLnBvaW50Q291bnQ9Zi5jb2xvckNvdW50ZXI9Zi5zeW1ib2xDb3VudGVyPTA7Zi5maXJzdFJlbmRlcigpfSxpbml0U2VyaWVzOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMub3B0aW9ucy5jaGFydDsoYj1JW2EudHlwZXx8Yi50eXBlfHxiLmRlZmF1bHRTZXJpZXNUeXBlXSl8fGdhKDE3LCEwKTtiPW5ldyBiO2IuaW5pdCh0aGlzLGEpO3JldHVybiBifSxpc0luc2lkZVBsb3Q6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPWM/YjphLGE9Yz9hOmI7cmV0dXJuIGQ+PTAmJmQ8PXRoaXMucGxvdFdpZHRoJiZhPj0wJiZhPD10aGlzLnBsb3RIZWlnaHR9LHJlZHJhdzpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmF4ZXMsYz10aGlzLnNlcmllcyxkPXRoaXMucG9pbnRlcixlPXRoaXMubGVnZW5kLGY9dGhpcy5pc0RpcnR5TGVnZW5kLGcsaCxpPXRoaXMuaGFzQ2FydGVzaWFuU2VyaWVzLFxuaj10aGlzLmlzRGlydHlCb3gsaz1jLmxlbmd0aCxsPWssbT10aGlzLnJlbmRlcmVyLG49bS5pc0hpZGRlbigpLHA9W107JGEoYSx0aGlzKTtuJiZ0aGlzLmNsb25lUmVuZGVyVG8oKTtmb3IodGhpcy5sYXlPdXRUaXRsZXMoKTtsLS07KWlmKGE9Y1tsXSxhLm9wdGlvbnMuc3RhY2tpbmcmJihnPSEwLGEuaXNEaXJ0eSkpe2g9ITA7YnJlYWt9aWYoaClmb3IobD1rO2wtLTspaWYoYT1jW2xdLGEub3B0aW9ucy5zdGFja2luZylhLmlzRGlydHk9ITA7byhjLGZ1bmN0aW9uKGEpe2EuaXNEaXJ0eSYmYS5vcHRpb25zLmxlZ2VuZFR5cGU9PT1cInBvaW50XCImJihhLnVwZGF0ZVRvdGFscyYmYS51cGRhdGVUb3RhbHMoKSxmPSEwKTthLmlzRGlydHlEYXRhJiZPKGEsXCJ1cGRhdGVkRGF0YVwiKX0pO2lmKGYmJmUub3B0aW9ucy5lbmFibGVkKWUucmVuZGVyKCksdGhpcy5pc0RpcnR5TGVnZW5kPSExO2cmJnRoaXMuZ2V0U3RhY2tzKCk7aWYoaSYmIXRoaXMuaXNSZXNpemluZyl0aGlzLm1heFRpY2tzPVxubnVsbCxvKGIsZnVuY3Rpb24oYSl7YS5zZXRTY2FsZSgpfSk7dGhpcy5nZXRNYXJnaW5zKCk7aSYmKG8oYixmdW5jdGlvbihhKXthLmlzRGlydHkmJihqPSEwKX0pLG8oYixmdW5jdGlvbihhKXt2YXIgYj1hLm1pbitcIixcIithLm1heDtpZihhLmV4dEtleSE9PWIpYS5leHRLZXk9YixwLnB1c2goZnVuY3Rpb24oKXtPKGEsXCJhZnRlclNldEV4dHJlbWVzXCIsQShhLmV2ZW50QXJncyxhLmdldEV4dHJlbWVzKCkpKTtkZWxldGUgYS5ldmVudEFyZ3N9KTsoanx8ZykmJmEucmVkcmF3KCl9KSk7aiYmdGhpcy5kcmF3Q2hhcnRCb3goKTtvKGMsZnVuY3Rpb24oYSl7YS5pc0RpcnR5JiZhLnZpc2libGUmJighYS5pc0NhcnRlc2lhbnx8YS54QXhpcykmJmEucmVkcmF3KCl9KTtkJiZkLnJlc2V0KCEwKTttLmRyYXcoKTtPKHRoaXMsXCJyZWRyYXdcIik7biYmdGhpcy5jbG9uZVJlbmRlclRvKCEwKTtvKHAsZnVuY3Rpb24oYSl7YS5jYWxsKCl9KX0sZ2V0OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuYXhlcyxcbmM9dGhpcy5zZXJpZXMsZCxlO2ZvcihkPTA7ZDxiLmxlbmd0aDtkKyspaWYoYltkXS5vcHRpb25zLmlkPT09YSlyZXR1cm4gYltkXTtmb3IoZD0wO2Q8Yy5sZW5ndGg7ZCsrKWlmKGNbZF0ub3B0aW9ucy5pZD09PWEpcmV0dXJuIGNbZF07Zm9yKGQ9MDtkPGMubGVuZ3RoO2QrKyl7ZT1jW2RdLnBvaW50c3x8W107Zm9yKGI9MDtiPGUubGVuZ3RoO2IrKylpZihlW2JdLmlkPT09YSlyZXR1cm4gZVtiXX1yZXR1cm4gbnVsbH0sZ2V0QXhlczpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj10aGlzLm9wdGlvbnMsYz1iLnhBeGlzPXVhKGIueEF4aXN8fHt9KSxiPWIueUF4aXM9dWEoYi55QXhpc3x8e30pO28oYyxmdW5jdGlvbihhLGIpe2EuaW5kZXg9YjthLmlzWD0hMH0pO28oYixmdW5jdGlvbihhLGIpe2EuaW5kZXg9Yn0pO2M9Yy5jb25jYXQoYik7byhjLGZ1bmN0aW9uKGIpe25ldyBKKGEsYil9KX0sZ2V0U2VsZWN0ZWRQb2ludHM6ZnVuY3Rpb24oKXt2YXIgYT1bXTtvKHRoaXMuc2VyaWVzLFxuZnVuY3Rpb24oYil7YT1hLmNvbmNhdChGYShiLnBvaW50c3x8W10sZnVuY3Rpb24oYSl7cmV0dXJuIGEuc2VsZWN0ZWR9KSl9KTtyZXR1cm4gYX0sZ2V0U2VsZWN0ZWRTZXJpZXM6ZnVuY3Rpb24oKXtyZXR1cm4gRmEodGhpcy5zZXJpZXMsZnVuY3Rpb24oYSl7cmV0dXJuIGEuc2VsZWN0ZWR9KX0sc2V0VGl0bGU6ZnVuY3Rpb24oYSxiLGMpe3ZhciBnO3ZhciBkPXRoaXMsZT1kLm9wdGlvbnMsZjtmPWUudGl0bGU9eihlLnRpdGxlLGEpO2c9ZS5zdWJ0aXRsZT16KGUuc3VidGl0bGUsYiksZT1nO28oW1tcInRpdGxlXCIsYSxmXSxbXCJzdWJ0aXRsZVwiLGIsZV1dLGZ1bmN0aW9uKGEpe3ZhciBiPWFbMF0sYz1kW2JdLGU9YVsxXSxhPWFbMl07YyYmZSYmKGRbYl09Yz1jLmRlc3Ryb3koKSk7YSYmYS50ZXh0JiYhYyYmKGRbYl09ZC5yZW5kZXJlci50ZXh0KGEudGV4dCwwLDAsYS51c2VIVE1MKS5hdHRyKHthbGlnbjphLmFsaWduLFwiY2xhc3NcIjpcImhpZ2hjaGFydHMtXCIrYix6SW5kZXg6YS56SW5kZXh8fFxuNH0pLmNzcyhhLnN0eWxlKS5hZGQoKSl9KTtkLmxheU91dFRpdGxlcyhjKX0sbGF5T3V0VGl0bGVzOmZ1bmN0aW9uKGEpe3ZhciBiPTAsYz10aGlzLnRpdGxlLGQ9dGhpcy5zdWJ0aXRsZSxlPXRoaXMub3B0aW9ucyxmPWUudGl0bGUsZT1lLnN1YnRpdGxlLGc9dGhpcy5yZW5kZXJlcixoPXRoaXMuc3BhY2luZ0JveDtpZihjJiYoYy5jc3Moe3dpZHRoOihmLndpZHRofHxoLndpZHRoK2Yud2lkdGhBZGp1c3QpK1wicHhcIn0pLmFsaWduKEEoe3k6Zy5mb250TWV0cmljcyhmLnN0eWxlLmZvbnRTaXplLGMpLmItM30sZiksITEsaCksIWYuZmxvYXRpbmcmJiFmLnZlcnRpY2FsQWxpZ24pKWI9Yy5nZXRCQm94KCkuaGVpZ2h0O2QmJihkLmNzcyh7d2lkdGg6KGUud2lkdGh8fGgud2lkdGgrZS53aWR0aEFkanVzdCkrXCJweFwifSkuYWxpZ24oQSh7eTpiKyhmLm1hcmdpbi0xMykrZy5mb250TWV0cmljcyhlLnN0eWxlLmZvbnRTaXplLGMpLmJ9LGUpLCExLGgpLCFlLmZsb2F0aW5nJiYhZS52ZXJ0aWNhbEFsaWduJiZcbihiPUVhKGIrZC5nZXRCQm94KCkuaGVpZ2h0KSkpO2M9dGhpcy50aXRsZU9mZnNldCE9PWI7dGhpcy50aXRsZU9mZnNldD1iO2lmKCF0aGlzLmlzRGlydHlCb3gmJmMpdGhpcy5pc0RpcnR5Qm94PWMsdGhpcy5oYXNSZW5kZXJlZCYmcShhLCEwKSYmdGhpcy5pc0RpcnR5Qm94JiZ0aGlzLnJlZHJhdygpfSxnZXRDaGFydFNpemU6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9wdGlvbnMuY2hhcnQsYj1hLndpZHRoLGE9YS5oZWlnaHQsYz10aGlzLnJlbmRlclRvQ2xvbmV8fHRoaXMucmVuZGVyVG87aWYoIXYoYikpdGhpcy5jb250YWluZXJXaWR0aD13YShjLFwid2lkdGhcIik7aWYoIXYoYSkpdGhpcy5jb250YWluZXJIZWlnaHQ9d2EoYyxcImhlaWdodFwiKTt0aGlzLmNoYXJ0V2lkdGg9dygwLGJ8fHRoaXMuY29udGFpbmVyV2lkdGh8fDYwMCk7dGhpcy5jaGFydEhlaWdodD13KDAscShhLHRoaXMuY29udGFpbmVySGVpZ2h0PjE5P3RoaXMuY29udGFpbmVySGVpZ2h0OjQwMCkpfSxjbG9uZVJlbmRlclRvOmZ1bmN0aW9uKGEpe3ZhciBiPVxudGhpcy5yZW5kZXJUb0Nsb25lLGM9dGhpcy5jb250YWluZXI7YT9iJiYodGhpcy5yZW5kZXJUby5hcHBlbmRDaGlsZChjKSxVYShiKSxkZWxldGUgdGhpcy5yZW5kZXJUb0Nsb25lKTooYyYmYy5wYXJlbnROb2RlPT09dGhpcy5yZW5kZXJUbyYmdGhpcy5yZW5kZXJUby5yZW1vdmVDaGlsZChjKSx0aGlzLnJlbmRlclRvQ2xvbmU9Yj10aGlzLnJlbmRlclRvLmNsb25lTm9kZSgwKSxOKGIse3Bvc2l0aW9uOlwiYWJzb2x1dGVcIix0b3A6XCItOTk5OXB4XCIsZGlzcGxheTpcImJsb2NrXCJ9KSxiLnN0eWxlLnNldFByb3BlcnR5JiZiLnN0eWxlLnNldFByb3BlcnR5KFwiZGlzcGxheVwiLFwiYmxvY2tcIixcImltcG9ydGFudFwiKSxILmJvZHkuYXBwZW5kQ2hpbGQoYiksYyYmYi5hcHBlbmRDaGlsZChjKSl9LGdldENvbnRhaW5lcjpmdW5jdGlvbigpe3ZhciBhLGI9dGhpcy5vcHRpb25zLGM9Yi5jaGFydCxkLGU7YT10aGlzLnJlbmRlclRvO3ZhciBmPVwiaGlnaGNoYXJ0cy1cIitJYisrO2lmKCFhKXRoaXMucmVuZGVyVG89XG5hPWMucmVuZGVyVG87aWYoQ2EoYSkpdGhpcy5yZW5kZXJUbz1hPUguZ2V0RWxlbWVudEJ5SWQoYSk7YXx8Z2EoMTMsITApO2Q9SyhYKGEsXCJkYXRhLWhpZ2hjaGFydHMtY2hhcnRcIikpO0MoZCkmJiRbZF0mJiRbZF0uaGFzUmVuZGVyZWQmJiRbZF0uZGVzdHJveSgpO1goYSxcImRhdGEtaGlnaGNoYXJ0cy1jaGFydFwiLHRoaXMuaW5kZXgpO2EuaW5uZXJIVE1MPVwiXCI7IWMuc2tpcENsb25lJiYhYS5vZmZzZXRXaWR0aCYmdGhpcy5jbG9uZVJlbmRlclRvKCk7dGhpcy5nZXRDaGFydFNpemUoKTtkPXRoaXMuY2hhcnRXaWR0aDtlPXRoaXMuY2hhcnRIZWlnaHQ7dGhpcy5jb250YWluZXI9YT1mYShWYSx7Y2xhc3NOYW1lOlwiaGlnaGNoYXJ0cy1jb250YWluZXJcIisoYy5jbGFzc05hbWU/XCIgXCIrYy5jbGFzc05hbWU6XCJcIiksaWQ6Zn0sQSh7cG9zaXRpb246XCJyZWxhdGl2ZVwiLG92ZXJmbG93OlwiaGlkZGVuXCIsd2lkdGg6ZCtcInB4XCIsaGVpZ2h0OmUrXCJweFwiLHRleHRBbGlnbjpcImxlZnRcIixsaW5lSGVpZ2h0Olwibm9ybWFsXCIsXG56SW5kZXg6MCxcIi13ZWJraXQtdGFwLWhpZ2hsaWdodC1jb2xvclwiOlwicmdiYSgwLDAsMCwwKVwifSxjLnN0eWxlKSx0aGlzLnJlbmRlclRvQ2xvbmV8fGEpO3RoaXMuX2N1cnNvcj1hLnN0eWxlLmN1cnNvcjt0aGlzLnJlbmRlcmVyPW5ldyAoQltjLnJlbmRlcmVyXXx8WGEpKGEsZCxlLGMuc3R5bGUsYy5mb3JFeHBvcnQsYi5leHBvcnRpbmcmJmIuZXhwb3J0aW5nLmFsbG93SFRNTCk7cWEmJnRoaXMucmVuZGVyZXIuY3JlYXRlKHRoaXMsYSxkLGUpO3RoaXMucmVuZGVyZXIuY2hhcnRJbmRleD10aGlzLmluZGV4fSxnZXRNYXJnaW5zOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuc3BhY2luZyxjPXRoaXMubWFyZ2luLGQ9dGhpcy50aXRsZU9mZnNldDt0aGlzLnJlc2V0TWFyZ2lucygpO2lmKGQmJiF2KGNbMF0pKXRoaXMucGxvdFRvcD13KHRoaXMucGxvdFRvcCxkK3RoaXMub3B0aW9ucy50aXRsZS5tYXJnaW4rYlswXSk7dGhpcy5sZWdlbmQuYWRqdXN0TWFyZ2lucyhjLGIpO3RoaXMuZXh0cmFCb3R0b21NYXJnaW4mJlxuKHRoaXMubWFyZ2luQm90dG9tKz10aGlzLmV4dHJhQm90dG9tTWFyZ2luKTt0aGlzLmV4dHJhVG9wTWFyZ2luJiYodGhpcy5wbG90VG9wKz10aGlzLmV4dHJhVG9wTWFyZ2luKTthfHx0aGlzLmdldEF4aXNNYXJnaW5zKCl9LGdldEF4aXNNYXJnaW5zOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEuYXhpc09mZnNldD1bMCwwLDAsMF0sYz1hLm1hcmdpbjthLmhhc0NhcnRlc2lhblNlcmllcyYmbyhhLmF4ZXMsZnVuY3Rpb24oYSl7YS52aXNpYmxlJiZhLmdldE9mZnNldCgpfSk7byh0YixmdW5jdGlvbihkLGUpe3YoY1tlXSl8fChhW2RdKz1iW2VdKX0pO2Euc2V0Q2hhcnRTaXplKCl9LHJlZmxvdzpmdW5jdGlvbihhKXt2YXIgYj10aGlzLGM9Yi5vcHRpb25zLmNoYXJ0LGQ9Yi5yZW5kZXJUbyxlPWMud2lkdGh8fHdhKGQsXCJ3aWR0aFwiKSxmPWMuaGVpZ2h0fHx3YShkLFwiaGVpZ2h0XCIpLGM9YT9hLnRhcmdldDpMO2lmKCFiLmhhc1VzZXJTaXplJiYhYi5pc1ByaW50aW5nJiZlJiZmJiYoYz09PVxuTHx8Yz09PUgpKXtpZihlIT09Yi5jb250YWluZXJXaWR0aHx8ZiE9PWIuY29udGFpbmVySGVpZ2h0KWNsZWFyVGltZW91dChiLnJlZmxvd1RpbWVvdXQpLGIucmVmbG93VGltZW91dD1aYShmdW5jdGlvbigpe2lmKGIuY29udGFpbmVyKWIuc2V0U2l6ZShlLGYsITEpLGIuaGFzVXNlclNpemU9bnVsbH0sYT8xMDA6MCk7Yi5jb250YWluZXJXaWR0aD1lO2IuY29udGFpbmVySGVpZ2h0PWZ9fSxpbml0UmVmbG93OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWZ1bmN0aW9uKGIpe2EucmVmbG93KGIpfTtFKEwsXCJyZXNpemVcIixiKTtFKGEsXCJkZXN0cm95XCIsZnVuY3Rpb24oKXtUKEwsXCJyZXNpemVcIixiKX0pfSxzZXRTaXplOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD10aGlzLGUsZixnPWQucmVuZGVyZXI7ZC5pc1Jlc2l6aW5nKz0xOyRhKGMsZCk7ZC5vbGRDaGFydEhlaWdodD1kLmNoYXJ0SGVpZ2h0O2Qub2xkQ2hhcnRXaWR0aD1kLmNoYXJ0V2lkdGg7aWYodihhKSlkLmNoYXJ0V2lkdGg9ZT13KDAsXG55KGEpKSxkLmhhc1VzZXJTaXplPSEhZTtpZih2KGIpKWQuY2hhcnRIZWlnaHQ9Zj13KDAseShiKSk7YT1nLmdsb2JhbEFuaW1hdGlvbjsoYT9kYjpOKShkLmNvbnRhaW5lcix7d2lkdGg6ZStcInB4XCIsaGVpZ2h0OmYrXCJweFwifSxhKTtkLnNldENoYXJ0U2l6ZSghMCk7Zy5zZXRTaXplKGUsZixjKTtkLm1heFRpY2tzPW51bGw7byhkLmF4ZXMsZnVuY3Rpb24oYSl7YS5pc0RpcnR5PSEwO2Euc2V0U2NhbGUoKX0pO28oZC5zZXJpZXMsZnVuY3Rpb24oYSl7YS5pc0RpcnR5PSEwfSk7ZC5pc0RpcnR5TGVnZW5kPSEwO2QuaXNEaXJ0eUJveD0hMDtkLmxheU91dFRpdGxlcygpO2QuZ2V0TWFyZ2lucygpO2QucmVkcmF3KGMpO2Qub2xkQ2hhcnRIZWlnaHQ9bnVsbDtPKGQsXCJyZXNpemVcIik7WmEoZnVuY3Rpb24oKXtkJiZPKGQsXCJlbmRSZXNpemVcIixudWxsLGZ1bmN0aW9uKCl7ZC5pc1Jlc2l6aW5nLT0xfSl9LGdiKGEpLmR1cmF0aW9uKX0sc2V0Q2hhcnRTaXplOmZ1bmN0aW9uKGEpe3ZhciBiPVxudGhpcy5pbnZlcnRlZCxjPXRoaXMucmVuZGVyZXIsZD10aGlzLmNoYXJ0V2lkdGgsZT10aGlzLmNoYXJ0SGVpZ2h0LGY9dGhpcy5vcHRpb25zLmNoYXJ0LGc9dGhpcy5zcGFjaW5nLGg9dGhpcy5jbGlwT2Zmc2V0LGksaixrLGw7dGhpcy5wbG90TGVmdD1pPXkodGhpcy5wbG90TGVmdCk7dGhpcy5wbG90VG9wPWo9eSh0aGlzLnBsb3RUb3ApO3RoaXMucGxvdFdpZHRoPWs9dygwLHkoZC1pLXRoaXMubWFyZ2luUmlnaHQpKTt0aGlzLnBsb3RIZWlnaHQ9bD13KDAseShlLWotdGhpcy5tYXJnaW5Cb3R0b20pKTt0aGlzLnBsb3RTaXplWD1iP2w6azt0aGlzLnBsb3RTaXplWT1iP2s6bDt0aGlzLnBsb3RCb3JkZXJXaWR0aD1mLnBsb3RCb3JkZXJXaWR0aHx8MDt0aGlzLnNwYWNpbmdCb3g9Yy5zcGFjaW5nQm94PXt4OmdbM10seTpnWzBdLHdpZHRoOmQtZ1szXS1nWzFdLGhlaWdodDplLWdbMF0tZ1syXX07dGhpcy5wbG90Qm94PWMucGxvdEJveD17eDppLHk6aix3aWR0aDprLGhlaWdodDpsfTtcbmQ9MipWKHRoaXMucGxvdEJvcmRlcldpZHRoLzIpO2I9RWEodyhkLGhbM10pLzIpO2M9RWEodyhkLGhbMF0pLzIpO3RoaXMuY2xpcEJveD17eDpiLHk6Yyx3aWR0aDpWKHRoaXMucGxvdFNpemVYLXcoZCxoWzFdKS8yLWIpLGhlaWdodDp3KDAsVih0aGlzLnBsb3RTaXplWS13KGQsaFsyXSkvMi1jKSl9O2F8fG8odGhpcy5heGVzLGZ1bmN0aW9uKGEpe2Euc2V0QXhpc1NpemUoKTthLnNldEF4aXNUcmFuc2xhdGlvbigpfSl9LHJlc2V0TWFyZ2luczpmdW5jdGlvbigpe3ZhciBhPXRoaXM7byh0YixmdW5jdGlvbihiLGMpe2FbYl09cShhLm1hcmdpbltjXSxhLnNwYWNpbmdbY10pfSk7YS5heGlzT2Zmc2V0PVswLDAsMCwwXTthLmNsaXBPZmZzZXQ9WzAsMCwwLDBdfSxkcmF3Q2hhcnRCb3g6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9wdGlvbnMuY2hhcnQsYj10aGlzLnJlbmRlcmVyLGM9dGhpcy5jaGFydFdpZHRoLGQ9dGhpcy5jaGFydEhlaWdodCxlPXRoaXMuY2hhcnRCYWNrZ3JvdW5kLFxuZj10aGlzLnBsb3RCYWNrZ3JvdW5kLGc9dGhpcy5wbG90Qm9yZGVyLGg9dGhpcy5wbG90QkdJbWFnZSxpPWEuYm9yZGVyV2lkdGh8fDAsaj1hLmJhY2tncm91bmRDb2xvcixrPWEucGxvdEJhY2tncm91bmRDb2xvcixsPWEucGxvdEJhY2tncm91bmRJbWFnZSxtPWEucGxvdEJvcmRlcldpZHRofHwwLG4scD10aGlzLnBsb3RMZWZ0LHI9dGhpcy5wbG90VG9wLHM9dGhpcy5wbG90V2lkdGgscT10aGlzLnBsb3RIZWlnaHQsbz10aGlzLnBsb3RCb3gseD10aGlzLmNsaXBSZWN0LEQ9dGhpcy5jbGlwQm94O249aSsoYS5zaGFkb3c/ODowKTtpZihpfHxqKWlmKGUpZS5hbmltYXRlKGUuY3Jpc3Aoe3dpZHRoOmMtbixoZWlnaHQ6ZC1ufSkpO2Vsc2V7ZT17ZmlsbDpqfHxcIm5vbmVcIn07aWYoaSllLnN0cm9rZT1hLmJvcmRlckNvbG9yLGVbXCJzdHJva2Utd2lkdGhcIl09aTt0aGlzLmNoYXJ0QmFja2dyb3VuZD1iLnJlY3Qobi8yLG4vMixjLW4sZC1uLGEuYm9yZGVyUmFkaXVzLGkpLmF0dHIoZSkuYWRkQ2xhc3MoXCJoaWdoY2hhcnRzLWJhY2tncm91bmRcIikuYWRkKCkuc2hhZG93KGEuc2hhZG93KX1pZihrKWY/XG5mLmFuaW1hdGUobyk6dGhpcy5wbG90QmFja2dyb3VuZD1iLnJlY3QocCxyLHMscSwwKS5hdHRyKHtmaWxsOmt9KS5hZGQoKS5zaGFkb3coYS5wbG90U2hhZG93KTtpZihsKWg/aC5hbmltYXRlKG8pOnRoaXMucGxvdEJHSW1hZ2U9Yi5pbWFnZShsLHAscixzLHEpLmFkZCgpO3g/eC5hbmltYXRlKHt3aWR0aDpELndpZHRoLGhlaWdodDpELmhlaWdodH0pOnRoaXMuY2xpcFJlY3Q9Yi5jbGlwUmVjdChEKTtpZihtKWc/KGcuc3Ryb2tlV2lkdGg9LW0sZy5hbmltYXRlKGcuY3Jpc3Aoe3g6cCx5OnIsd2lkdGg6cyxoZWlnaHQ6cX0pKSk6dGhpcy5wbG90Qm9yZGVyPWIucmVjdChwLHIscyxxLDAsLW0pLmF0dHIoe3N0cm9rZTphLnBsb3RCb3JkZXJDb2xvcixcInN0cm9rZS13aWR0aFwiOm0sZmlsbDpcIm5vbmVcIix6SW5kZXg6MX0pLmFkZCgpO3RoaXMuaXNEaXJ0eUJveD0hMX0scHJvcEZyb21TZXJpZXM6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5vcHRpb25zLmNoYXJ0LGMsZD1hLm9wdGlvbnMuc2VyaWVzLFxuZSxmO28oW1wiaW52ZXJ0ZWRcIixcImFuZ3VsYXJcIixcInBvbGFyXCJdLGZ1bmN0aW9uKGcpe2M9SVtiLnR5cGV8fGIuZGVmYXVsdFNlcmllc1R5cGVdO2Y9YVtnXXx8YltnXXx8YyYmYy5wcm90b3R5cGVbZ107Zm9yKGU9ZCYmZC5sZW5ndGg7IWYmJmUtLTspKGM9SVtkW2VdLnR5cGVdKSYmYy5wcm90b3R5cGVbZ10mJihmPSEwKTthW2ddPWZ9KX0sbGlua1NlcmllczpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLnNlcmllcztvKGIsZnVuY3Rpb24oYSl7YS5saW5rZWRTZXJpZXMubGVuZ3RoPTB9KTtvKGIsZnVuY3Rpb24oYil7dmFyIGQ9Yi5vcHRpb25zLmxpbmtlZFRvO2lmKENhKGQpJiYoZD1kPT09XCI6cHJldmlvdXNcIj9hLnNlcmllc1tiLmluZGV4LTFdOmEuZ2V0KGQpKSlkLmxpbmtlZFNlcmllcy5wdXNoKGIpLGIubGlua2VkUGFyZW50PWQsYi52aXNpYmxlPXEoYi5vcHRpb25zLnZpc2libGUsZC5vcHRpb25zLnZpc2libGUsYi52aXNpYmxlKX0pfSxyZW5kZXJTZXJpZXM6ZnVuY3Rpb24oKXtvKHRoaXMuc2VyaWVzLFxuZnVuY3Rpb24oYSl7YS50cmFuc2xhdGUoKTthLnJlbmRlcigpfSl9LHJlbmRlckxhYmVsczpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLm9wdGlvbnMubGFiZWxzO2IuaXRlbXMmJm8oYi5pdGVtcyxmdW5jdGlvbihjKXt2YXIgZD1BKGIuc3R5bGUsYy5zdHlsZSksZT1LKGQubGVmdCkrYS5wbG90TGVmdCxmPUsoZC50b3ApK2EucGxvdFRvcCsxMjtkZWxldGUgZC5sZWZ0O2RlbGV0ZSBkLnRvcDthLnJlbmRlcmVyLnRleHQoYy5odG1sLGUsZikuYXR0cih7ekluZGV4OjJ9KS5jc3MoZCkuYWRkKCl9KX0scmVuZGVyOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5heGVzLGI9dGhpcy5yZW5kZXJlcixjPXRoaXMub3B0aW9ucyxkLGUsZixnO3RoaXMuc2V0VGl0bGUoKTt0aGlzLmxlZ2VuZD1uZXcgdWIodGhpcyxjLmxlZ2VuZCk7dGhpcy5nZXRTdGFja3MmJnRoaXMuZ2V0U3RhY2tzKCk7dGhpcy5nZXRNYXJnaW5zKCEwKTt0aGlzLnNldENoYXJ0U2l6ZSgpO2Q9dGhpcy5wbG90V2lkdGg7ZT10aGlzLnBsb3RIZWlnaHQtPVxuMjE7byhhLGZ1bmN0aW9uKGEpe2Euc2V0U2NhbGUoKX0pO3RoaXMuZ2V0QXhpc01hcmdpbnMoKTtmPWQvdGhpcy5wbG90V2lkdGg+MS4xO2c9ZS90aGlzLnBsb3RIZWlnaHQ+MS4wNTtpZihmfHxnKXRoaXMubWF4VGlja3M9bnVsbCxvKGEsZnVuY3Rpb24oYSl7KGEuaG9yaXomJmZ8fCFhLmhvcml6JiZnKSYmYS5zZXRUaWNrSW50ZXJ2YWwoITApfSksdGhpcy5nZXRNYXJnaW5zKCk7dGhpcy5kcmF3Q2hhcnRCb3goKTt0aGlzLmhhc0NhcnRlc2lhblNlcmllcyYmbyhhLGZ1bmN0aW9uKGEpe2EudmlzaWJsZSYmYS5yZW5kZXIoKX0pO2lmKCF0aGlzLnNlcmllc0dyb3VwKXRoaXMuc2VyaWVzR3JvdXA9Yi5nKFwic2VyaWVzLWdyb3VwXCIpLmF0dHIoe3pJbmRleDozfSkuYWRkKCk7dGhpcy5yZW5kZXJTZXJpZXMoKTt0aGlzLnJlbmRlckxhYmVscygpO3RoaXMuc2hvd0NyZWRpdHMoYy5jcmVkaXRzKTt0aGlzLmhhc1JlbmRlcmVkPSEwfSxzaG93Q3JlZGl0czpmdW5jdGlvbihhKXtpZihhLmVuYWJsZWQmJlxuIXRoaXMuY3JlZGl0cyl0aGlzLmNyZWRpdHM9dGhpcy5yZW5kZXJlci50ZXh0KGEudGV4dCwwLDApLm9uKFwiY2xpY2tcIixmdW5jdGlvbigpe2lmKGEuaHJlZilMLmxvY2F0aW9uLmhyZWY9YS5ocmVmfSkuYXR0cih7YWxpZ246YS5wb3NpdGlvbi5hbGlnbix6SW5kZXg6OH0pLmNzcyhhLnN0eWxlKS5hZGQoKS5hbGlnbihhLnBvc2l0aW9uKX0sZGVzdHJveTpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLmF4ZXMsYz1hLnNlcmllcyxkPWEuY29udGFpbmVyLGUsZj1kJiZkLnBhcmVudE5vZGU7TyhhLFwiZGVzdHJveVwiKTskW2EuaW5kZXhdPXQ7a2ItLTthLnJlbmRlclRvLnJlbW92ZUF0dHJpYnV0ZShcImRhdGEtaGlnaGNoYXJ0cy1jaGFydFwiKTtUKGEpO2ZvcihlPWIubGVuZ3RoO2UtLTspYltlXT1iW2VdLmRlc3Ryb3koKTtmb3IoZT1jLmxlbmd0aDtlLS07KWNbZV09Y1tlXS5kZXN0cm95KCk7byhcInRpdGxlLHN1YnRpdGxlLGNoYXJ0QmFja2dyb3VuZCxwbG90QmFja2dyb3VuZCxwbG90QkdJbWFnZSxwbG90Qm9yZGVyLHNlcmllc0dyb3VwLGNsaXBSZWN0LGNyZWRpdHMscG9pbnRlcixzY3JvbGxlcixyYW5nZVNlbGVjdG9yLGxlZ2VuZCxyZXNldFpvb21CdXR0b24sdG9vbHRpcCxyZW5kZXJlclwiLnNwbGl0KFwiLFwiKSxcbmZ1bmN0aW9uKGIpe3ZhciBjPWFbYl07YyYmYy5kZXN0cm95JiYoYVtiXT1jLmRlc3Ryb3koKSl9KTtpZihkKWQuaW5uZXJIVE1MPVwiXCIsVChkKSxmJiZVYShkKTtmb3IoZSBpbiBhKWRlbGV0ZSBhW2VdfSxpc1JlYWR5VG9SZW5kZXI6ZnVuY3Rpb24oKXt2YXIgYT10aGlzO3JldHVybiFqYSYmTD09TC50b3AmJkgucmVhZHlTdGF0ZSE9PVwiY29tcGxldGVcInx8cWEmJiFMLmNhbnZnPyhxYT9XYi5wdXNoKGZ1bmN0aW9uKCl7YS5maXJzdFJlbmRlcigpfSxhLm9wdGlvbnMuZ2xvYmFsLmNhbnZhc1Rvb2xzVVJMKTpILmF0dGFjaEV2ZW50KFwib25yZWFkeXN0YXRlY2hhbmdlXCIsZnVuY3Rpb24oKXtILmRldGFjaEV2ZW50KFwib25yZWFkeXN0YXRlY2hhbmdlXCIsYS5maXJzdFJlbmRlcik7SC5yZWFkeVN0YXRlPT09XCJjb21wbGV0ZVwiJiZhLmZpcnN0UmVuZGVyKCl9KSwhMSk6ITB9LGZpcnN0UmVuZGVyOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEub3B0aW9ucztpZihhLmlzUmVhZHlUb1JlbmRlcigpKXthLmdldENvbnRhaW5lcigpO1xuTyhhLFwiaW5pdFwiKTthLnJlc2V0TWFyZ2lucygpO2Euc2V0Q2hhcnRTaXplKCk7YS5wcm9wRnJvbVNlcmllcygpO2EuZ2V0QXhlcygpO28oYi5zZXJpZXN8fFtdLGZ1bmN0aW9uKGIpe2EuaW5pdFNlcmllcyhiKX0pO2EubGlua1NlcmllcygpO08oYSxcImJlZm9yZVJlbmRlclwiKTtpZihCLlBvaW50ZXIpYS5wb2ludGVyPW5ldyBZYShhLGIpO2EucmVuZGVyKCk7YS5yZW5kZXJlci5kcmF3KCk7aWYoIWEucmVuZGVyZXIuaW1nQ291bnQmJmEub25sb2FkKWEub25sb2FkKCk7YS5jbG9uZVJlbmRlclRvKCEwKX19LG9ubG9hZDpmdW5jdGlvbigpe3ZhciBhPXRoaXM7byhbdGhpcy5jYWxsYmFja10uY29uY2F0KHRoaXMuY2FsbGJhY2tzKSxmdW5jdGlvbihiKXtiJiZhLmluZGV4IT09dm9pZCAwJiZiLmFwcGx5KGEsW2FdKX0pO08oYSxcImxvYWRcIik7dGhpcy5vbmxvYWQ9bnVsbH0sc3BsYXNoQXJyYXk6ZnVuY3Rpb24oYSxiKXt2YXIgYz1iW2FdLGM9ZWEoYyk/YzpbYyxjLGMsY107cmV0dXJuW3EoYlthK1xuXCJUb3BcIl0sY1swXSkscShiW2ErXCJSaWdodFwiXSxjWzFdKSxxKGJbYStcIkJvdHRvbVwiXSxjWzJdKSxxKGJbYStcIkxlZnRcIl0sY1szXSldfX07dmFyIGJjPUIuQ2VudGVyZWRTZXJpZXNNaXhpbj17Z2V0Q2VudGVyOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcHRpb25zLGI9dGhpcy5jaGFydCxjPTIqKGEuc2xpY2VkT2Zmc2V0fHwwKSxkPWIucGxvdFdpZHRoLTIqYyxiPWIucGxvdEhlaWdodC0yKmMsZT1hLmNlbnRlcixlPVtxKGVbMF0sXCI1MCVcIikscShlWzFdLFwiNTAlXCIpLGEuc2l6ZXx8XCIxMDAlXCIsYS5pbm5lclNpemV8fDBdLGY9RyhkLGIpLGcsaDtmb3IoZz0wO2c8NDsrK2cpaD1lW2ddLGE9ZzwyfHxnPT09MiYmLyUkLy50ZXN0KGgpLGVbZ109KC8lJC8udGVzdChoKT9bZCxiLGYsZVsyXV1bZ10qcGFyc2VGbG9hdChoKS8xMDA6cGFyc2VGbG9hdChoKSkrKGE/YzowKTtlWzNdPmVbMl0mJihlWzNdPWVbMl0pO3JldHVybiBlfX0sSGE9ZnVuY3Rpb24oKXt9O0hhLnByb3RvdHlwZT17aW5pdDpmdW5jdGlvbihhLFxuYixjKXt0aGlzLnNlcmllcz1hO3RoaXMuY29sb3I9YS5jb2xvcjt0aGlzLmFwcGx5T3B0aW9ucyhiLGMpO3RoaXMucG9pbnRBdHRyPXt9O2lmKGEub3B0aW9ucy5jb2xvckJ5UG9pbnQmJihiPWEub3B0aW9ucy5jb2xvcnN8fGEuY2hhcnQub3B0aW9ucy5jb2xvcnMsdGhpcy5jb2xvcj10aGlzLmNvbG9yfHxiW2EuY29sb3JDb3VudGVyKytdLGEuY29sb3JDb3VudGVyPT09Yi5sZW5ndGgpKWEuY29sb3JDb3VudGVyPTA7YS5jaGFydC5wb2ludENvdW50Kys7cmV0dXJuIHRoaXN9LGFwcGx5T3B0aW9uczpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuc2VyaWVzLGQ9Yy5vcHRpb25zLnBvaW50VmFsS2V5fHxjLnBvaW50VmFsS2V5LGE9SGEucHJvdG90eXBlLm9wdGlvbnNUb09iamVjdC5jYWxsKHRoaXMsYSk7QSh0aGlzLGEpO3RoaXMub3B0aW9ucz10aGlzLm9wdGlvbnM/QSh0aGlzLm9wdGlvbnMsYSk6YTtpZihkKXRoaXMueT10aGlzW2RdO3RoaXMuaXNOdWxsPXRoaXMueD09PW51bGx8fFxudGhpcy55PT09bnVsbDtpZih0aGlzLng9PT12b2lkIDAmJmMpdGhpcy54PWI9PT12b2lkIDA/Yy5hdXRvSW5jcmVtZW50KCk6YjtyZXR1cm4gdGhpc30sb3B0aW9uc1RvT2JqZWN0OmZ1bmN0aW9uKGEpe3ZhciBiPXt9LGM9dGhpcy5zZXJpZXMsZD1jLm9wdGlvbnMua2V5cyxlPWR8fGMucG9pbnRBcnJheU1hcHx8W1wieVwiXSxmPWUubGVuZ3RoLGc9MCxoPTA7aWYoQyhhKXx8YT09PW51bGwpYltlWzBdXT1hO2Vsc2UgaWYoSmEoYSkpe2lmKCFkJiZhLmxlbmd0aD5mKXtjPXR5cGVvZiBhWzBdO2lmKGM9PT1cInN0cmluZ1wiKWIubmFtZT1hWzBdO2Vsc2UgaWYoYz09PVwibnVtYmVyXCIpYi54PWFbMF07ZysrfWZvcig7aDxmOyl7aWYoIWR8fGFbZ10hPT12b2lkIDApYltlW2hdXT1hW2ddO2crKztoKyt9fWVsc2UgaWYodHlwZW9mIGE9PT1cIm9iamVjdFwiKXtiPWE7aWYoYS5kYXRhTGFiZWxzKWMuX2hhc1BvaW50TGFiZWxzPSEwO2lmKGEubWFya2VyKWMuX2hhc1BvaW50TWFya2Vycz0hMH1yZXR1cm4gYn0sXG5kZXN0cm95OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5zZXJpZXMuY2hhcnQsYj1hLmhvdmVyUG9pbnRzLGM7YS5wb2ludENvdW50LS07aWYoYiYmKHRoaXMuc2V0U3RhdGUoKSx6YShiLHRoaXMpLCFiLmxlbmd0aCkpYS5ob3ZlclBvaW50cz1udWxsO2lmKHRoaXM9PT1hLmhvdmVyUG9pbnQpdGhpcy5vbk1vdXNlT3V0KCk7aWYodGhpcy5ncmFwaGljfHx0aGlzLmRhdGFMYWJlbClUKHRoaXMpLHRoaXMuZGVzdHJveUVsZW1lbnRzKCk7dGhpcy5sZWdlbmRJdGVtJiZhLmxlZ2VuZC5kZXN0cm95SXRlbSh0aGlzKTtmb3IoYyBpbiB0aGlzKXRoaXNbY109bnVsbH0sZGVzdHJveUVsZW1lbnRzOmZ1bmN0aW9uKCl7Zm9yKHZhciBhPVtcImdyYXBoaWNcIixcImRhdGFMYWJlbFwiLFwiZGF0YUxhYmVsVXBwZXJcIixcImNvbm5lY3RvclwiLFwic2hhZG93R3JvdXBcIl0sYixjPTY7Yy0tOyliPWFbY10sdGhpc1tiXSYmKHRoaXNbYl09dGhpc1tiXS5kZXN0cm95KCkpfSxnZXRMYWJlbENvbmZpZzpmdW5jdGlvbigpe3JldHVybnt4OnRoaXMuY2F0ZWdvcnksXG55OnRoaXMueSxjb2xvcjp0aGlzLmNvbG9yLGtleTp0aGlzLm5hbWV8fHRoaXMuY2F0ZWdvcnksc2VyaWVzOnRoaXMuc2VyaWVzLHBvaW50OnRoaXMscGVyY2VudGFnZTp0aGlzLnBlcmNlbnRhZ2UsdG90YWw6dGhpcy50b3RhbHx8dGhpcy5zdGFja1RvdGFsfX0sdG9vbHRpcEZvcm1hdHRlcjpmdW5jdGlvbihhKXt2YXIgYj10aGlzLnNlcmllcyxjPWIudG9vbHRpcE9wdGlvbnMsZD1xKGMudmFsdWVEZWNpbWFscyxcIlwiKSxlPWMudmFsdWVQcmVmaXh8fFwiXCIsZj1jLnZhbHVlU3VmZml4fHxcIlwiO28oYi5wb2ludEFycmF5TWFwfHxbXCJ5XCJdLGZ1bmN0aW9uKGIpe2I9XCJ7cG9pbnQuXCIrYjtpZihlfHxmKWE9YS5yZXBsYWNlKGIrXCJ9XCIsZStiK1wifVwiK2YpO2E9YS5yZXBsYWNlKGIrXCJ9XCIsYitcIjosLlwiK2QrXCJmfVwiKX0pO3JldHVybiBMYShhLHtwb2ludDp0aGlzLHNlcmllczp0aGlzLnNlcmllc30pfSxmaXJlUG9pbnRFdmVudDpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9dGhpcyxlPXRoaXMuc2VyaWVzLm9wdGlvbnM7XG4oZS5wb2ludC5ldmVudHNbYV18fGQub3B0aW9ucyYmZC5vcHRpb25zLmV2ZW50cyYmZC5vcHRpb25zLmV2ZW50c1thXSkmJnRoaXMuaW1wb3J0RXZlbnRzKCk7YT09PVwiY2xpY2tcIiYmZS5hbGxvd1BvaW50U2VsZWN0JiYoYz1mdW5jdGlvbihhKXtkLnNlbGVjdCYmZC5zZWxlY3QobnVsbCxhLmN0cmxLZXl8fGEubWV0YUtleXx8YS5zaGlmdEtleSl9KTtPKHRoaXMsYSxiLGMpfSx2aXNpYmxlOiEwfTt2YXIgUD1CLlNlcmllcz1mdW5jdGlvbigpe307UC5wcm90b3R5cGU9e2lzQ2FydGVzaWFuOiEwLHR5cGU6XCJsaW5lXCIscG9pbnRDbGFzczpIYSxzb3J0ZWQ6ITAscmVxdWlyZVNvcnRpbmc6ITAscG9pbnRBdHRyVG9PcHRpb25zOntzdHJva2U6XCJsaW5lQ29sb3JcIixcInN0cm9rZS13aWR0aFwiOlwibGluZVdpZHRoXCIsZmlsbDpcImZpbGxDb2xvclwiLHI6XCJyYWRpdXNcIn0sZGlyZWN0VG91Y2g6ITEsYXhpc1R5cGVzOltcInhBeGlzXCIsXCJ5QXhpc1wiXSxjb2xvckNvdW50ZXI6MCxwYXJhbGxlbEFycmF5czpbXCJ4XCIsXG5cInlcIl0saW5pdDpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMsZCxlLGY9YS5zZXJpZXMsZz1mdW5jdGlvbihhLGIpe3JldHVybiBxKGEub3B0aW9ucy5pbmRleCxhLl9pKS1xKGIub3B0aW9ucy5pbmRleCxiLl9pKX07Yy5jaGFydD1hO2Mub3B0aW9ucz1iPWMuc2V0T3B0aW9ucyhiKTtjLmxpbmtlZFNlcmllcz1bXTtjLmJpbmRBeGVzKCk7QShjLHtuYW1lOmIubmFtZSxzdGF0ZTpcIlwiLHBvaW50QXR0cjp7fSx2aXNpYmxlOmIudmlzaWJsZSE9PSExLHNlbGVjdGVkOmIuc2VsZWN0ZWQ9PT0hMH0pO2lmKHFhKWIuYW5pbWF0aW9uPSExO2U9Yi5ldmVudHM7Zm9yKGQgaW4gZSlFKGMsZCxlW2RdKTtpZihlJiZlLmNsaWNrfHxiLnBvaW50JiZiLnBvaW50LmV2ZW50cyYmYi5wb2ludC5ldmVudHMuY2xpY2t8fGIuYWxsb3dQb2ludFNlbGVjdClhLnJ1blRyYWNrZXJDbGljaz0hMDtjLmdldENvbG9yKCk7Yy5nZXRTeW1ib2woKTtvKGMucGFyYWxsZWxBcnJheXMsZnVuY3Rpb24oYSl7Y1thK1wiRGF0YVwiXT1cbltdfSk7Yy5zZXREYXRhKGIuZGF0YSwhMSk7aWYoYy5pc0NhcnRlc2lhbilhLmhhc0NhcnRlc2lhblNlcmllcz0hMDtmLnB1c2goYyk7Yy5faT1mLmxlbmd0aC0xO25iKGYsZyk7dGhpcy55QXhpcyYmbmIodGhpcy55QXhpcy5zZXJpZXMsZyk7byhmLGZ1bmN0aW9uKGEsYil7YS5pbmRleD1iO2EubmFtZT1hLm5hbWV8fFwiU2VyaWVzIFwiKyhiKzEpfSl9LGJpbmRBeGVzOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEub3B0aW9ucyxjPWEuY2hhcnQsZDtvKGEuYXhpc1R5cGVzfHxbXSxmdW5jdGlvbihlKXtvKGNbZV0sZnVuY3Rpb24oYyl7ZD1jLm9wdGlvbnM7aWYoYltlXT09PWQuaW5kZXh8fGJbZV0hPT10JiZiW2VdPT09ZC5pZHx8YltlXT09PXQmJmQuaW5kZXg9PT0wKWMuc2VyaWVzLnB1c2goYSksYVtlXT1jLGMuaXNEaXJ0eT0hMH0pOyFhW2VdJiZhLm9wdGlvbmFsQXhpcyE9PWUmJmdhKDE4LCEwKX0pfSx1cGRhdGVQYXJhbGxlbEFycmF5czpmdW5jdGlvbihhLGIpe3ZhciBjPWEuc2VyaWVzLFxuZD1hcmd1bWVudHMsZT1DKGIpP2Z1bmN0aW9uKGQpe3ZhciBlPWQ9PT1cInlcIiYmYy50b1lEYXRhP2MudG9ZRGF0YShhKTphW2RdO2NbZCtcIkRhdGFcIl1bYl09ZX06ZnVuY3Rpb24oYSl7QXJyYXkucHJvdG90eXBlW2JdLmFwcGx5KGNbYStcIkRhdGFcIl0sQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZCwyKSl9O28oYy5wYXJhbGxlbEFycmF5cyxlKX0sYXV0b0luY3JlbWVudDpmdW5jdGlvbigpe3ZhciBhPXRoaXMub3B0aW9ucyxiPXRoaXMueEluY3JlbWVudCxjLGQ9YS5wb2ludEludGVydmFsVW5pdCxiPXEoYixhLnBvaW50U3RhcnQsMCk7dGhpcy5wb2ludEludGVydmFsPWM9cSh0aGlzLnBvaW50SW50ZXJ2YWwsYS5wb2ludEludGVydmFsLDEpO2QmJihhPW5ldyBiYShiKSxkPT09XCJkYXlcIj9hPSthW3FiXShhW2FiXSgpK2MpOmQ9PT1cIm1vbnRoXCI/YT0rYVtFYl0oYVtoYl0oKStjKTpkPT09XCJ5ZWFyXCImJihhPSthW0ZiXShhW2liXSgpK2MpKSxjPWEtYik7dGhpcy54SW5jcmVtZW50PVxuYitjO3JldHVybiBifSxzZXRPcHRpb25zOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY2hhcnQsYz1iLm9wdGlvbnMucGxvdE9wdGlvbnMsYj1iLnVzZXJPcHRpb25zfHx7fSxkPWIucGxvdE9wdGlvbnN8fHt9LGU9Y1t0aGlzLnR5cGVdO3RoaXMudXNlck9wdGlvbnM9YTtjPXooZSxjLnNlcmllcyxhKTt0aGlzLnRvb2x0aXBPcHRpb25zPXooUi50b29sdGlwLFIucGxvdE9wdGlvbnNbdGhpcy50eXBlXS50b29sdGlwLGIudG9vbHRpcCxkLnNlcmllcyYmZC5zZXJpZXMudG9vbHRpcCxkW3RoaXMudHlwZV0mJmRbdGhpcy50eXBlXS50b29sdGlwLGEudG9vbHRpcCk7ZS5tYXJrZXI9PT1udWxsJiZkZWxldGUgYy5tYXJrZXI7dGhpcy56b25lQXhpcz1jLnpvbmVBeGlzO2E9dGhpcy56b25lcz0oYy56b25lc3x8W10pLnNsaWNlKCk7aWYoKGMubmVnYXRpdmVDb2xvcnx8Yy5uZWdhdGl2ZUZpbGxDb2xvcikmJiFjLnpvbmVzKWEucHVzaCh7dmFsdWU6Y1t0aGlzLnpvbmVBeGlzK1wiVGhyZXNob2xkXCJdfHxcbmMudGhyZXNob2xkfHwwLGNvbG9yOmMubmVnYXRpdmVDb2xvcixmaWxsQ29sb3I6Yy5uZWdhdGl2ZUZpbGxDb2xvcn0pO2EubGVuZ3RoJiZ2KGFbYS5sZW5ndGgtMV0udmFsdWUpJiZhLnB1c2goe2NvbG9yOnRoaXMuY29sb3IsZmlsbENvbG9yOnRoaXMuZmlsbENvbG9yfSk7cmV0dXJuIGN9LGdldEN5Y2xpYzpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9dGhpcy51c2VyT3B0aW9ucyxlPVwiX1wiK2ErXCJJbmRleFwiLGY9YStcIkNvdW50ZXJcIjtifHwodihkW2VdKT9iPWRbZV06KGRbZV09Yj10aGlzLmNoYXJ0W2ZdJWMubGVuZ3RoLHRoaXMuY2hhcnRbZl0rPTEpLGI9Y1tiXSk7dGhpc1thXT1ifSxnZXRDb2xvcjpmdW5jdGlvbigpe3RoaXMub3B0aW9ucy5jb2xvckJ5UG9pbnQ/dGhpcy5vcHRpb25zLmNvbG9yPW51bGw6dGhpcy5nZXRDeWNsaWMoXCJjb2xvclwiLHRoaXMub3B0aW9ucy5jb2xvcnx8V1t0aGlzLnR5cGVdLmNvbG9yLHRoaXMuY2hhcnQub3B0aW9ucy5jb2xvcnMpfSxnZXRTeW1ib2w6ZnVuY3Rpb24oKXt2YXIgYT1cbnRoaXMub3B0aW9ucy5tYXJrZXI7dGhpcy5nZXRDeWNsaWMoXCJzeW1ib2xcIixhLnN5bWJvbCx0aGlzLmNoYXJ0Lm9wdGlvbnMuc3ltYm9scyk7aWYoL151cmwvLnRlc3QodGhpcy5zeW1ib2wpKWEucmFkaXVzPTB9LGRyYXdMZWdlbmRTeW1ib2w6YWEuZHJhd0xpbmVNYXJrZXIsc2V0RGF0YTpmdW5jdGlvbihhLGIsYyxkKXt2YXIgZT10aGlzLGY9ZS5wb2ludHMsZz1mJiZmLmxlbmd0aHx8MCxoLGk9ZS5vcHRpb25zLGo9ZS5jaGFydCxrPW51bGwsbD1lLnhBeGlzLG09bCYmISFsLmNhdGVnb3JpZXMsbj1pLnR1cmJvVGhyZXNob2xkLHA9dGhpcy54RGF0YSxyPXRoaXMueURhdGEscz0oaD1lLnBvaW50QXJyYXlNYXApJiZoLmxlbmd0aCxhPWF8fFtdO2g9YS5sZW5ndGg7Yj1xKGIsITApO2lmKGQhPT0hMSYmaCYmZz09PWgmJiFlLmNyb3BwZWQmJiFlLmhhc0dyb3VwZWREYXRhJiZlLnZpc2libGUpbyhhLGZ1bmN0aW9uKGEsYil7ZltiXS51cGRhdGUmJmEhPT1pLmRhdGFbYl0mJmZbYl0udXBkYXRlKGEsXG4hMSxudWxsLCExKX0pO2Vsc2V7ZS54SW5jcmVtZW50PW51bGw7ZS5jb2xvckNvdW50ZXI9MDtvKHRoaXMucGFyYWxsZWxBcnJheXMsZnVuY3Rpb24oYSl7ZVthK1wiRGF0YVwiXS5sZW5ndGg9MH0pO2lmKG4mJmg+bil7Zm9yKGM9MDtrPT09bnVsbCYmYzxoOylrPWFbY10sYysrO2lmKEMoaykpe209cShpLnBvaW50U3RhcnQsMCk7az1xKGkucG9pbnRJbnRlcnZhbCwxKTtmb3IoYz0wO2M8aDtjKyspcFtjXT1tLHJbY109YVtjXSxtKz1rO2UueEluY3JlbWVudD1tfWVsc2UgaWYoSmEoaykpaWYocylmb3IoYz0wO2M8aDtjKyspaz1hW2NdLHBbY109a1swXSxyW2NdPWsuc2xpY2UoMSxzKzEpO2Vsc2UgZm9yKGM9MDtjPGg7YysrKWs9YVtjXSxwW2NdPWtbMF0scltjXT1rWzFdO2Vsc2UgZ2EoMTIpfWVsc2UgZm9yKGM9MDtjPGg7YysrKWlmKGFbY10hPT10JiYoaz17c2VyaWVzOmV9LGUucG9pbnRDbGFzcy5wcm90b3R5cGUuYXBwbHlPcHRpb25zLmFwcGx5KGssW2FbY11dKSxlLnVwZGF0ZVBhcmFsbGVsQXJyYXlzKGssXG5jKSxtJiZ2KGsubmFtZSkpKWwubmFtZXNbay54XT1rLm5hbWU7Q2EoclswXSkmJmdhKDE0LCEwKTtlLmRhdGE9W107ZS5vcHRpb25zLmRhdGE9ZS51c2VyT3B0aW9ucy5kYXRhPWE7Zm9yKGM9ZztjLS07KWZbY10mJmZbY10uZGVzdHJveSYmZltjXS5kZXN0cm95KCk7aWYobClsLm1pblJhbmdlPWwudXNlck1pblJhbmdlO2UuaXNEaXJ0eT1lLmlzRGlydHlEYXRhPWouaXNEaXJ0eUJveD0hMDtjPSExfWkubGVnZW5kVHlwZT09PVwicG9pbnRcIiYmKHRoaXMucHJvY2Vzc0RhdGEoKSx0aGlzLmdlbmVyYXRlUG9pbnRzKCkpO2ImJmoucmVkcmF3KGMpfSxwcm9jZXNzRGF0YTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLnhEYXRhLGM9dGhpcy55RGF0YSxkPWIubGVuZ3RoLGU7ZT0wO3ZhciBmLGcsaD10aGlzLnhBeGlzLGksaj10aGlzLm9wdGlvbnM7aT1qLmNyb3BUaHJlc2hvbGQ7dmFyIGs9dGhpcy5nZXRFeHRyZW1lc0Zyb21BbGx8fGouZ2V0RXh0cmVtZXNGcm9tQWxsLGw9dGhpcy5pc0NhcnRlc2lhbixcbmo9aCYmaC52YWwybGluLG09aCYmaC5pc0xvZyxuLHA7aWYobCYmIXRoaXMuaXNEaXJ0eSYmIWguaXNEaXJ0eSYmIXRoaXMueUF4aXMuaXNEaXJ0eSYmIWEpcmV0dXJuITE7aWYoaClhPWguZ2V0RXh0cmVtZXMoKSxuPWEubWluLHA9YS5tYXg7aWYobCYmdGhpcy5zb3J0ZWQmJiFrJiYoIWl8fGQ+aXx8dGhpcy5mb3JjZUNyb3ApKWlmKGJbZC0xXTxufHxiWzBdPnApYj1bXSxjPVtdO2Vsc2UgaWYoYlswXTxufHxiW2QtMV0+cCllPXRoaXMuY3JvcERhdGEodGhpcy54RGF0YSx0aGlzLnlEYXRhLG4scCksYj1lLnhEYXRhLGM9ZS55RGF0YSxlPWUuc3RhcnQsZj0hMDtmb3IoaT1iLmxlbmd0aHx8MTstLWk7KWQ9bT9qKGJbaV0pLWooYltpLTFdKTpiW2ldLWJbaS0xXSxkPjAmJihnPT09dHx8ZDxnKT9nPWQ6ZDwwJiZ0aGlzLnJlcXVpcmVTb3J0aW5nJiZnYSgxNSk7dGhpcy5jcm9wcGVkPWY7dGhpcy5jcm9wU3RhcnQ9ZTt0aGlzLnByb2Nlc3NlZFhEYXRhPWI7dGhpcy5wcm9jZXNzZWRZRGF0YT1cbmM7dGhpcy5jbG9zZXN0UG9pbnRSYW5nZT1nfSxjcm9wRGF0YTpmdW5jdGlvbihhLGIsYyxkKXt2YXIgZT1hLmxlbmd0aCxmPTAsZz1lLGg9cSh0aGlzLmNyb3BTaG91bGRlciwxKSxpO2ZvcihpPTA7aTxlO2krKylpZihhW2ldPj1jKXtmPXcoMCxpLWgpO2JyZWFrfWZvcihjPWk7YzxlO2MrKylpZihhW2NdPmQpe2c9YytoO2JyZWFrfXJldHVybnt4RGF0YTphLnNsaWNlKGYsZykseURhdGE6Yi5zbGljZShmLGcpLHN0YXJ0OmYsZW5kOmd9fSxnZW5lcmF0ZVBvaW50czpmdW5jdGlvbigpe3ZhciBhPXRoaXMub3B0aW9ucy5kYXRhLGI9dGhpcy5kYXRhLGMsZD10aGlzLnByb2Nlc3NlZFhEYXRhLGU9dGhpcy5wcm9jZXNzZWRZRGF0YSxmPXRoaXMucG9pbnRDbGFzcyxnPWQubGVuZ3RoLGg9dGhpcy5jcm9wU3RhcnR8fDAsaSxqPXRoaXMuaGFzR3JvdXBlZERhdGEsayxsPVtdLG07aWYoIWImJiFqKWI9W10sYi5sZW5ndGg9YS5sZW5ndGgsYj10aGlzLmRhdGE9Yjtmb3IobT0wO208ZzttKyspaT1cbmgrbSxqPyhsW21dPShuZXcgZikuaW5pdCh0aGlzLFtkW21dXS5jb25jYXQodWEoZVttXSkpKSxsW21dLmRhdGFHcm91cD10aGlzLmdyb3VwTWFwW21dKTooYltpXT9rPWJbaV06YVtpXSE9PXQmJihiW2ldPWs9KG5ldyBmKS5pbml0KHRoaXMsYVtpXSxkW21dKSksbFttXT1rKSxsW21dLmluZGV4PWk7aWYoYiYmKGchPT0oYz1iLmxlbmd0aCl8fGopKWZvcihtPTA7bTxjO20rKylpZihtPT09aCYmIWomJihtKz1nKSxiW21dKWJbbV0uZGVzdHJveUVsZW1lbnRzKCksYlttXS5wbG90WD10O3RoaXMuZGF0YT1iO3RoaXMucG9pbnRzPWx9LGdldEV4dHJlbWVzOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMueUF4aXMsYz10aGlzLnByb2Nlc3NlZFhEYXRhLGQsZT1bXSxmPTA7ZD10aGlzLnhBeGlzLmdldEV4dHJlbWVzKCk7dmFyIGc9ZC5taW4saD1kLm1heCxpLGosayxsLGE9YXx8dGhpcy5zdGFja2VkWURhdGF8fHRoaXMucHJvY2Vzc2VkWURhdGF8fFtdO2Q9YS5sZW5ndGg7Zm9yKGw9MDtsPFxuZDtsKyspaWYoaj1jW2xdLGs9YVtsXSxpPWshPT1udWxsJiZrIT09dCYmKCFiLmlzTG9nfHxrLmxlbmd0aHx8az4wKSxqPXRoaXMuZ2V0RXh0cmVtZXNGcm9tQWxsfHx0aGlzLm9wdGlvbnMuZ2V0RXh0cmVtZXNGcm9tQWxsfHx0aGlzLmNyb3BwZWR8fChjW2wrMV18fGopPj1nJiYoY1tsLTFdfHxqKTw9aCxpJiZqKWlmKGk9ay5sZW5ndGgpZm9yKDtpLS07KWtbaV0hPT1udWxsJiYoZVtmKytdPWtbaV0pO2Vsc2UgZVtmKytdPWs7dGhpcy5kYXRhTWluPU1hKGUpO3RoaXMuZGF0YU1heD1EYShlKX0sdHJhbnNsYXRlOmZ1bmN0aW9uKCl7dGhpcy5wcm9jZXNzZWRYRGF0YXx8dGhpcy5wcm9jZXNzRGF0YSgpO3RoaXMuZ2VuZXJhdGVQb2ludHMoKTtmb3IodmFyIGE9dGhpcy5vcHRpb25zLGI9YS5zdGFja2luZyxjPXRoaXMueEF4aXMsZD1jLmNhdGVnb3JpZXMsZT10aGlzLnlBeGlzLGY9dGhpcy5wb2ludHMsZz1mLmxlbmd0aCxoPSEhdGhpcy5tb2RpZnlWYWx1ZSxpPWEucG9pbnRQbGFjZW1lbnQsXG5qPWk9PT1cImJldHdlZW5cInx8QyhpKSxrPWEudGhyZXNob2xkLGw9YS5zdGFydEZyb21UaHJlc2hvbGQ/azowLG0sbixwLHIscz1OdW1iZXIuTUFYX1ZBTFVFLGE9MDthPGc7YSsrKXt2YXIgbz1mW2FdLHU9by54LHg9by55O249by5sb3c7dmFyIEQ9YiYmZS5zdGFja3NbKHRoaXMubmVnU3RhY2tzJiZ4PChsPzA6ayk/XCItXCI6XCJcIikrdGhpcy5zdGFja0tleV07aWYoZS5pc0xvZyYmeCE9PW51bGwmJng8PTApby55PXg9bnVsbCxnYSgxMCk7by5wbG90WD1tPWthKEcodygtMUU1LGMudHJhbnNsYXRlKHUsMCwwLDAsMSxpLHRoaXMudHlwZT09PVwiZmxhZ3NcIikpLDFFNSkpO2lmKGImJnRoaXMudmlzaWJsZSYmIW8uaXNOdWxsJiZEJiZEW3VdKXI9dGhpcy5nZXRTdGFja0luZGljYXRvcihyLHUsdGhpcy5pbmRleCksRD1EW3VdLHg9RC5wb2ludHNbci5rZXldLG49eFswXSx4PXhbMV0sbj09PWwmJihuPXEoayxlLm1pbikpLGUuaXNMb2cmJm48PTAmJihuPW51bGwpLG8udG90YWw9by5zdGFja1RvdGFsPVxuRC50b3RhbCxvLnBlcmNlbnRhZ2U9RC50b3RhbCYmby55L0QudG90YWwqMTAwLG8uc3RhY2tZPXgsRC5zZXRPZmZzZXQodGhpcy5wb2ludFhPZmZzZXR8fDAsdGhpcy5iYXJXfHwwKTtvLnlCb3R0b209dihuKT9lLnRyYW5zbGF0ZShuLDAsMSwwLDEpOm51bGw7aCYmKHg9dGhpcy5tb2RpZnlWYWx1ZSh4LG8pKTtvLnBsb3RZPW49dHlwZW9mIHg9PT1cIm51bWJlclwiJiZ4IT09SW5maW5pdHk/Ryh3KC0xRTUsZS50cmFuc2xhdGUoeCwwLDEsMCwxKSksMUU1KTp0O28uaXNJbnNpZGU9biE9PXQmJm4+PTAmJm48PWUubGVuJiZtPj0wJiZtPD1jLmxlbjtvLmNsaWVudFg9aj9jLnRyYW5zbGF0ZSh1LDAsMCwwLDEpOm07by5uZWdhdGl2ZT1vLnk8KGt8fDApO28uY2F0ZWdvcnk9ZCYmZFtvLnhdIT09dD9kW28ueF06by54O28uaXNOdWxsfHwocCE9PXZvaWQgMCYmKHM9RyhzLFMobS1wKSkpLHA9bSl9dGhpcy5jbG9zZXN0UG9pbnRSYW5nZVB4PXN9LGdldFZhbGlkUG9pbnRzOmZ1bmN0aW9uKGEsXG5iKXt2YXIgYz10aGlzLmNoYXJ0O3JldHVybiBGYShhfHx0aGlzLnBvaW50c3x8W10sZnVuY3Rpb24oYSl7cmV0dXJuIGImJiFjLmlzSW5zaWRlUGxvdChhLnBsb3RYLGEucGxvdFksYy5pbnZlcnRlZCk/ITE6IWEuaXNOdWxsfSl9LHNldENsaXA6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jaGFydCxjPXRoaXMub3B0aW9ucyxkPWIucmVuZGVyZXIsZT1iLmludmVydGVkLGY9dGhpcy5jbGlwQm94LGc9Znx8Yi5jbGlwQm94LGg9dGhpcy5zaGFyZWRDbGlwS2V5fHxbXCJfc2hhcmVkQ2xpcFwiLGEmJmEuZHVyYXRpb24sYSYmYS5lYXNpbmcsZy5oZWlnaHQsYy54QXhpcyxjLnlBeGlzXS5qb2luKFwiLFwiKSxpPWJbaF0saj1iW2grXCJtXCJdO2lmKCFpKXtpZihhKWcud2lkdGg9MCxiW2grXCJtXCJdPWo9ZC5jbGlwUmVjdCgtOTksZT8tYi5wbG90TGVmdDotYi5wbG90VG9wLDk5LGU/Yi5jaGFydFdpZHRoOmIuY2hhcnRIZWlnaHQpO2JbaF09aT1kLmNsaXBSZWN0KGcpfWEmJihpLmNvdW50Kz0xKTtpZihjLmNsaXAhPT1cbiExKXRoaXMuZ3JvdXAuY2xpcChhfHxmP2k6Yi5jbGlwUmVjdCksdGhpcy5tYXJrZXJHcm91cC5jbGlwKGopLHRoaXMuc2hhcmVkQ2xpcEtleT1oO2F8fChpLmNvdW50LT0xLGkuY291bnQ8PTAmJmgmJmJbaF0mJihmfHwoYltoXT1iW2hdLmRlc3Ryb3koKSksYltoK1wibVwiXSYmKGJbaCtcIm1cIl09YltoK1wibVwiXS5kZXN0cm95KCkpKSl9LGFuaW1hdGU6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jaGFydCxjPXRoaXMub3B0aW9ucy5hbmltYXRpb24sZDtpZihjJiYhZWEoYykpYz1XW3RoaXMudHlwZV0uYW5pbWF0aW9uO2E/dGhpcy5zZXRDbGlwKGMpOihkPXRoaXMuc2hhcmVkQ2xpcEtleSwoYT1iW2RdKSYmYS5hbmltYXRlKHt3aWR0aDpiLnBsb3RTaXplWH0sYyksYltkK1wibVwiXSYmYltkK1wibVwiXS5hbmltYXRlKHt3aWR0aDpiLnBsb3RTaXplWCs5OX0sYyksdGhpcy5hbmltYXRlPW51bGwpfSxhZnRlckFuaW1hdGU6ZnVuY3Rpb24oKXt0aGlzLnNldENsaXAoKTtPKHRoaXMsXCJhZnRlckFuaW1hdGVcIil9LFxuZHJhd1BvaW50czpmdW5jdGlvbigpe3ZhciBhLGI9dGhpcy5wb2ludHMsYz10aGlzLmNoYXJ0LGQsZSxmLGcsaCxpLGosayxsPXRoaXMub3B0aW9ucy5tYXJrZXIsbT10aGlzLnBvaW50QXR0cltcIlwiXSxuLHAscixzPXRoaXMubWFya2VyR3JvdXAsbz1xKGwuZW5hYmxlZCx0aGlzLnhBeGlzLmlzUmFkaWFsLHRoaXMuY2xvc2VzdFBvaW50UmFuZ2VQeD4yKmwucmFkaXVzKTtpZihsLmVuYWJsZWQhPT0hMXx8dGhpcy5faGFzUG9pbnRNYXJrZXJzKWZvcihmPWIubGVuZ3RoO2YtLTspaWYoZz1iW2ZdLGQ9VihnLnBsb3RYKSxlPWcucGxvdFksaz1nLmdyYXBoaWMsbj1nLm1hcmtlcnx8e30scD0hIWcubWFya2VyLGE9byYmbi5lbmFibGVkPT09dHx8bi5lbmFibGVkLHI9Zy5pc0luc2lkZSxhJiZDKGUpJiZnLnkhPT1udWxsKWlmKGE9Zy5wb2ludEF0dHJbZy5zZWxlY3RlZD9cInNlbGVjdFwiOlwiXCJdfHxtLGg9YS5yLGk9cShuLnN5bWJvbCx0aGlzLnN5bWJvbCksaj1pLmluZGV4T2YoXCJ1cmxcIik9PT1cbjAsaylrW3I/XCJzaG93XCI6XCJoaWRlXCJdKCEwKS5hdHRyKGEpLmFuaW1hdGUoQSh7eDpkLWgseTplLWh9LGsuc3ltYm9sTmFtZT97d2lkdGg6MipoLGhlaWdodDoyKmh9Ont9KSk7ZWxzZXtpZihyJiYoaD4wfHxqKSlnLmdyYXBoaWM9Yy5yZW5kZXJlci5zeW1ib2woaSxkLWgsZS1oLDIqaCwyKmgscD9uOmwpLmF0dHIoYSkuYWRkKHMpfWVsc2UgaWYoaylnLmdyYXBoaWM9ay5kZXN0cm95KCl9LGNvbnZlcnRBdHRyaWJzOmZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPXRoaXMucG9pbnRBdHRyVG9PcHRpb25zLGYsZyxoPXt9LGE9YXx8e30sYj1ifHx7fSxjPWN8fHt9LGQ9ZHx8e307Zm9yKGYgaW4gZSlnPWVbZl0saFtmXT1xKGFbZ10sYltmXSxjW2ZdLGRbZl0pO3JldHVybiBofSxnZXRBdHRyaWJzOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEub3B0aW9ucyxjPVdbYS50eXBlXS5tYXJrZXI/Yi5tYXJrZXI6YixkPWMuc3RhdGVzLGU9ZC5ob3ZlcixmLGc9YS5jb2xvcixoPWEub3B0aW9ucy5uZWdhdGl2ZUNvbG9yLFxuaT17c3Ryb2tlOmcsZmlsbDpnfSxqPWEucG9pbnRzfHxbXSxrLGw9W10sbSxuPWEucG9pbnRBdHRyVG9PcHRpb25zO2Y9YS5oYXNQb2ludFNwZWNpZmljT3B0aW9uczt2YXIgcD1jLmxpbmVDb2xvcixyPWMuZmlsbENvbG9yO2s9Yi50dXJib1RocmVzaG9sZDt2YXIgcz1hLnpvbmVzLEY9YS56b25lQXhpc3x8XCJ5XCIsdSx4O2IubWFya2VyPyhlLnJhZGl1cz1lLnJhZGl1c3x8Yy5yYWRpdXMrZS5yYWRpdXNQbHVzLGUubGluZVdpZHRoPWUubGluZVdpZHRofHxjLmxpbmVXaWR0aCtlLmxpbmVXaWR0aFBsdXMpOihlLmNvbG9yPWUuY29sb3J8fHZhKGUuY29sb3J8fGcpLmJyaWdodGVuKGUuYnJpZ2h0bmVzcykuZ2V0KCksZS5uZWdhdGl2ZUNvbG9yPWUubmVnYXRpdmVDb2xvcnx8dmEoZS5uZWdhdGl2ZUNvbG9yfHxoKS5icmlnaHRlbihlLmJyaWdodG5lc3MpLmdldCgpKTtsW1wiXCJdPWEuY29udmVydEF0dHJpYnMoYyxpKTtvKFtcImhvdmVyXCIsXCJzZWxlY3RcIl0sZnVuY3Rpb24oYil7bFtiXT1cbmEuY29udmVydEF0dHJpYnMoZFtiXSxsW1wiXCJdKX0pO2EucG9pbnRBdHRyPWw7Zz1qLmxlbmd0aDtpZigha3x8ZzxrfHxmKWZvcig7Zy0tOyl7az1qW2ddO2lmKChjPWsub3B0aW9ucyYmay5vcHRpb25zLm1hcmtlcnx8ay5vcHRpb25zKSYmYy5lbmFibGVkPT09ITEpYy5yYWRpdXM9MDtpPW51bGw7aWYocy5sZW5ndGgpe2Y9MDtmb3IoaT1zW2ZdO2tbRl0+PWkudmFsdWU7KWk9c1srK2ZdO2suY29sb3I9ay5maWxsQ29sb3I9aT1xKGkuY29sb3IsYS5jb2xvcil9Zj1iLmNvbG9yQnlQb2ludHx8ay5jb2xvcjtpZihrLm9wdGlvbnMpZm9yKHggaW4gbil2KGNbblt4XV0pJiYoZj0hMCk7aWYoZil7Yz1jfHx7fTttPVtdO2Q9Yy5zdGF0ZXN8fHt9O2Y9ZC5ob3Zlcj1kLmhvdmVyfHx7fTtpZighYi5tYXJrZXJ8fGsubmVnYXRpdmUmJiFmLmZpbGxDb2xvciYmIWUuZmlsbENvbG9yKWZbYS5wb2ludEF0dHJUb09wdGlvbnMuZmlsbF09Zi5jb2xvcnx8IWsub3B0aW9ucy5jb2xvciYmZVtrLm5lZ2F0aXZlJiZcbmg/XCJuZWdhdGl2ZUNvbG9yXCI6XCJjb2xvclwiXXx8dmEoay5jb2xvcikuYnJpZ2h0ZW4oZi5icmlnaHRuZXNzfHxlLmJyaWdodG5lc3MpLmdldCgpO3U9e2NvbG9yOmsuY29sb3J9O2lmKCFyKXUuZmlsbENvbG9yPWsuY29sb3I7aWYoIXApdS5saW5lQ29sb3I9ay5jb2xvcjtjLmhhc093blByb3BlcnR5KFwiY29sb3JcIikmJiFjLmNvbG9yJiZkZWxldGUgYy5jb2xvcjtpZihpJiYhZS5maWxsQ29sb3IpZi5maWxsQ29sb3I9aTttW1wiXCJdPWEuY29udmVydEF0dHJpYnMoQSh1LGMpLGxbXCJcIl0pO20uaG92ZXI9YS5jb252ZXJ0QXR0cmlicyhkLmhvdmVyLGwuaG92ZXIsbVtcIlwiXSk7bS5zZWxlY3Q9YS5jb252ZXJ0QXR0cmlicyhkLnNlbGVjdCxsLnNlbGVjdCxtW1wiXCJdKX1lbHNlIG09bDtrLnBvaW50QXR0cj1tfX0sZGVzdHJveTpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLmNoYXJ0LGM9L0FwcGxlV2ViS2l0XFwvNTMzLy50ZXN0KE5hKSxkLGU9YS5kYXRhfHxbXSxmLGcsaDtPKGEsXCJkZXN0cm95XCIpO1xuVChhKTtvKGEuYXhpc1R5cGVzfHxbXSxmdW5jdGlvbihiKXtpZihoPWFbYl0pemEoaC5zZXJpZXMsYSksaC5pc0RpcnR5PWguZm9yY2VSZWRyYXc9ITB9KTthLmxlZ2VuZEl0ZW0mJmEuY2hhcnQubGVnZW5kLmRlc3Ryb3lJdGVtKGEpO2ZvcihkPWUubGVuZ3RoO2QtLTspKGY9ZVtkXSkmJmYuZGVzdHJveSYmZi5kZXN0cm95KCk7YS5wb2ludHM9bnVsbDtjbGVhclRpbWVvdXQoYS5hbmltYXRpb25UaW1lb3V0KTtmb3IoZyBpbiBhKWFbZ11pbnN0YW5jZW9mIFomJiFhW2ddLnN1cnZpdmUmJihkPWMmJmc9PT1cImdyb3VwXCI/XCJoaWRlXCI6XCJkZXN0cm95XCIsYVtnXVtkXSgpKTtpZihiLmhvdmVyU2VyaWVzPT09YSliLmhvdmVyU2VyaWVzPW51bGw7emEoYi5zZXJpZXMsYSk7Zm9yKGcgaW4gYSlkZWxldGUgYVtnXX0sZ2V0R3JhcGhQYXRoOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD10aGlzLGU9ZC5vcHRpb25zLGY9ZS5zdGVwLGcsaD1bXSxpLGE9YXx8ZC5wb2ludHM7KGc9YS5yZXZlcnNlZCkmJlxuYS5yZXZlcnNlKCk7KGY9e3JpZ2h0OjEsY2VudGVyOjJ9W2ZdfHxmJiYzKSYmZyYmKGY9NC1mKTtlLmNvbm5lY3ROdWxscyYmIWImJiFjJiYoYT10aGlzLmdldFZhbGlkUG9pbnRzKGEpKTtvKGEsZnVuY3Rpb24oZyxrKXt2YXIgbD1nLnBsb3RYLG09Zy5wbG90WSxuPWFbay0xXTtpZigoZy5sZWZ0Q2xpZmZ8fG4mJm4ucmlnaHRDbGlmZikmJiFjKWk9ITA7Zy5pc051bGwmJiF2KGIpJiZrPjA/aT0hZS5jb25uZWN0TnVsbHM6Zy5pc051bGwmJiFiP2k9ITA6KGs9PT0wfHxpP249W1wiTVwiLGcucGxvdFgsZy5wbG90WV06ZC5nZXRQb2ludFNwbGluZT9uPWQuZ2V0UG9pbnRTcGxpbmUoYSxnLGspOmY/KG49Zj09PTE/W1wiTFwiLG4ucGxvdFgsbV06Zj09PTI/W1wiTFwiLChuLnBsb3RYK2wpLzIsbi5wbG90WSxcIkxcIiwobi5wbG90WCtsKS8yLG1dOltcIkxcIixsLG4ucGxvdFldLG4ucHVzaChcIkxcIixsLG0pKTpuPVtcIkxcIixsLG1dLGgucHVzaC5hcHBseShoLG4pLGk9ITEpfSk7cmV0dXJuIGQuZ3JhcGhQYXRoPVxuaH0sZHJhd0dyYXBoOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPXRoaXMub3B0aW9ucyxjPVtbXCJncmFwaFwiLGIubGluZUNvbG9yfHx0aGlzLmNvbG9yLGIuZGFzaFN0eWxlXV0sZD1iLmxpbmVXaWR0aCxlPWIubGluZWNhcCE9PVwic3F1YXJlXCIsZj0odGhpcy5nYXBwZWRQYXRofHx0aGlzLmdldEdyYXBoUGF0aCkuY2FsbCh0aGlzKSxnPXRoaXMuZmlsbEdyYXBoJiZ0aGlzLmNvbG9yfHxcIm5vbmVcIjtvKHRoaXMuem9uZXMsZnVuY3Rpb24oZCxlKXtjLnB1c2goW1wiem9uZUdyYXBoXCIrZSxkLmNvbG9yfHxhLmNvbG9yLGQuZGFzaFN0eWxlfHxiLmRhc2hTdHlsZV0pfSk7byhjLGZ1bmN0aW9uKGMsaSl7dmFyIGo9Y1swXSxrPWFbal07aWYoaylrLmFuaW1hdGUoe2Q6Zn0pO2Vsc2UgaWYoKGR8fGcpJiZmLmxlbmd0aClrPXtzdHJva2U6Y1sxXSxcInN0cm9rZS13aWR0aFwiOmQsZmlsbDpnLHpJbmRleDoxfSxjWzJdP2suZGFzaHN0eWxlPWNbMl06ZSYmKGtbXCJzdHJva2UtbGluZWNhcFwiXT1rW1wic3Ryb2tlLWxpbmVqb2luXCJdPVxuXCJyb3VuZFwiKSxhW2pdPWEuY2hhcnQucmVuZGVyZXIucGF0aChmKS5hdHRyKGspLmFkZChhLmdyb3VwKS5zaGFkb3coaTwyJiZiLnNoYWRvdyl9KX0sYXBwbHlab25lczpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj10aGlzLmNoYXJ0LGM9Yi5yZW5kZXJlcixkPXRoaXMuem9uZXMsZSxmLGc9dGhpcy5jbGlwc3x8W10saCxpPXRoaXMuZ3JhcGgsaj10aGlzLmFyZWEsaz13KGIuY2hhcnRXaWR0aCxiLmNoYXJ0SGVpZ2h0KSxsPXRoaXNbKHRoaXMuem9uZUF4aXN8fFwieVwiKStcIkF4aXNcIl0sbSxuPWwucmV2ZXJzZWQscD1iLmludmVydGVkLHI9bC5ob3JpeixzLEYsdSx4PSExO2lmKGQubGVuZ3RoJiYoaXx8aikmJmwubWluIT09dClpJiZpLmhpZGUoKSxqJiZqLmhpZGUoKSxtPWwuZ2V0RXh0cmVtZXMoKSxvKGQsZnVuY3Rpb24oZCxvKXtlPW4/cj9iLnBsb3RXaWR0aDowOnI/MDpsLnRvUGl4ZWxzKG0ubWluKTtlPUcodyhxKGYsZSksMCksayk7Zj1HKHcoeShsLnRvUGl4ZWxzKHEoZC52YWx1ZSxcbm0ubWF4KSwhMCkpLDApLGspO3gmJihlPWY9bC50b1BpeGVscyhtLm1heCkpO3M9TWF0aC5hYnMoZS1mKTtGPUcoZSxmKTt1PXcoZSxmKTtpZihsLmlzWEF4aXMpe2lmKGg9e3g6cD91OkYseTowLHdpZHRoOnMsaGVpZ2h0Omt9LCFyKWgueD1iLnBsb3RIZWlnaHQtaC54fWVsc2UgaWYoaD17eDowLHk6cD91OkYsd2lkdGg6ayxoZWlnaHQ6c30sciloLnk9Yi5wbG90V2lkdGgtaC55O2IuaW52ZXJ0ZWQmJmMuaXNWTUwmJihoPWwuaXNYQXhpcz97eDowLHk6bj9GOnUsaGVpZ2h0Omgud2lkdGgsd2lkdGg6Yi5jaGFydFdpZHRofTp7eDpoLnktYi5wbG90TGVmdC1iLnNwYWNpbmdCb3gueCx5OjAsd2lkdGg6aC5oZWlnaHQsaGVpZ2h0OmIuY2hhcnRIZWlnaHR9KTtnW29dP2dbb10uYW5pbWF0ZShoKTooZ1tvXT1jLmNsaXBSZWN0KGgpLGkmJmFbXCJ6b25lR3JhcGhcIitvXS5jbGlwKGdbb10pLGomJmFbXCJ6b25lQXJlYVwiK29dLmNsaXAoZ1tvXSkpO3g9ZC52YWx1ZT5tLm1heH0pLHRoaXMuY2xpcHM9XG5nfSxpbnZlcnRHcm91cHM6ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKCl7dmFyIGE9e3dpZHRoOmIueUF4aXMubGVuLGhlaWdodDpiLnhBeGlzLmxlbn07byhbXCJncm91cFwiLFwibWFya2VyR3JvdXBcIl0sZnVuY3Rpb24oYyl7YltjXSYmYltjXS5hdHRyKGEpLmludmVydCgpfSl9dmFyIGI9dGhpcyxjPWIuY2hhcnQ7aWYoYi54QXhpcylFKGMsXCJyZXNpemVcIixhKSxFKGIsXCJkZXN0cm95XCIsZnVuY3Rpb24oKXtUKGMsXCJyZXNpemVcIixhKX0pLGEoKSxiLmludmVydEdyb3Vwcz1hfSxwbG90R3JvdXA6ZnVuY3Rpb24oYSxiLGMsZCxlKXt2YXIgZj10aGlzW2FdLGc9IWY7ZyYmKHRoaXNbYV09Zj10aGlzLmNoYXJ0LnJlbmRlcmVyLmcoYikuYXR0cih7ekluZGV4OmR8fDAuMX0pLmFkZChlKSxmLmFkZENsYXNzKFwiaGlnaGNoYXJ0cy1zZXJpZXMtXCIrdGhpcy5pbmRleCkpO2YuYXR0cih7dmlzaWJpbGl0eTpjfSlbZz9cImF0dHJcIjpcImFuaW1hdGVcIl0odGhpcy5nZXRQbG90Qm94KCkpO3JldHVybiBmfSxnZXRQbG90Qm94OmZ1bmN0aW9uKCl7dmFyIGE9XG50aGlzLmNoYXJ0LGI9dGhpcy54QXhpcyxjPXRoaXMueUF4aXM7aWYoYS5pbnZlcnRlZCliPWMsYz10aGlzLnhBeGlzO3JldHVybnt0cmFuc2xhdGVYOmI/Yi5sZWZ0OmEucGxvdExlZnQsdHJhbnNsYXRlWTpjP2MudG9wOmEucGxvdFRvcCxzY2FsZVg6MSxzY2FsZVk6MX19LHJlbmRlcjpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLmNoYXJ0LGMsZD1hLm9wdGlvbnMsZT0hIWEuYW5pbWF0ZSYmYi5yZW5kZXJlci5pc1NWRyYmZ2IoZC5hbmltYXRpb24pLmR1cmF0aW9uLGY9YS52aXNpYmxlP1wiaW5oZXJpdFwiOlwiaGlkZGVuXCIsZz1kLnpJbmRleCxoPWEuaGFzUmVuZGVyZWQsaT1iLnNlcmllc0dyb3VwO2M9YS5wbG90R3JvdXAoXCJncm91cFwiLFwic2VyaWVzXCIsZixnLGkpO2EubWFya2VyR3JvdXA9YS5wbG90R3JvdXAoXCJtYXJrZXJHcm91cFwiLFwibWFya2Vyc1wiLGYsZyxpKTtlJiZhLmFuaW1hdGUoITApO2EuZ2V0QXR0cmlicygpO2MuaW52ZXJ0ZWQ9YS5pc0NhcnRlc2lhbj9iLmludmVydGVkOlxuITE7YS5kcmF3R3JhcGgmJihhLmRyYXdHcmFwaCgpLGEuYXBwbHlab25lcygpKTtvKGEucG9pbnRzLGZ1bmN0aW9uKGEpe2EucmVkcmF3JiZhLnJlZHJhdygpfSk7YS5kcmF3RGF0YUxhYmVscyYmYS5kcmF3RGF0YUxhYmVscygpO2EudmlzaWJsZSYmYS5kcmF3UG9pbnRzKCk7YS5kcmF3VHJhY2tlciYmYS5vcHRpb25zLmVuYWJsZU1vdXNlVHJhY2tpbmchPT0hMSYmYS5kcmF3VHJhY2tlcigpO2IuaW52ZXJ0ZWQmJmEuaW52ZXJ0R3JvdXBzKCk7ZC5jbGlwIT09ITEmJiFhLnNoYXJlZENsaXBLZXkmJiFoJiZjLmNsaXAoYi5jbGlwUmVjdCk7ZSYmYS5hbmltYXRlKCk7aWYoIWgpYS5hbmltYXRpb25UaW1lb3V0PVphKGZ1bmN0aW9uKCl7YS5hZnRlckFuaW1hdGUoKX0sZSk7YS5pc0RpcnR5PWEuaXNEaXJ0eURhdGE9ITE7YS5oYXNSZW5kZXJlZD0hMH0scmVkcmF3OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5jaGFydCxiPXRoaXMuaXNEaXJ0eXx8dGhpcy5pc0RpcnR5RGF0YSxjPXRoaXMuZ3JvdXAsXG5kPXRoaXMueEF4aXMsZT10aGlzLnlBeGlzO2MmJihhLmludmVydGVkJiZjLmF0dHIoe3dpZHRoOmEucGxvdFdpZHRoLGhlaWdodDphLnBsb3RIZWlnaHR9KSxjLmFuaW1hdGUoe3RyYW5zbGF0ZVg6cShkJiZkLmxlZnQsYS5wbG90TGVmdCksdHJhbnNsYXRlWTpxKGUmJmUudG9wLGEucGxvdFRvcCl9KSk7dGhpcy50cmFuc2xhdGUoKTt0aGlzLnJlbmRlcigpO2ImJmRlbGV0ZSB0aGlzLmtkVHJlZX0sa2REaW1lbnNpb25zOjEsa2RBeGlzQXJyYXk6W1wiY2xpZW50WFwiLFwicGxvdFlcIl0sc2VhcmNoUG9pbnQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLnhBeGlzLGQ9dGhpcy55QXhpcyxlPXRoaXMuY2hhcnQuaW52ZXJ0ZWQ7cmV0dXJuIHRoaXMuc2VhcmNoS0RUcmVlKHtjbGllbnRYOmU/Yy5sZW4tYS5jaGFydFkrYy5wb3M6YS5jaGFydFgtYy5wb3MscGxvdFk6ZT9kLmxlbi1hLmNoYXJ0WCtkLnBvczphLmNoYXJ0WS1kLnBvc30sYil9LGJ1aWxkS0RUcmVlOmZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShjLFxuZSxmKXt2YXIgZyxoO2lmKGg9YyYmYy5sZW5ndGgpcmV0dXJuIGc9Yi5rZEF4aXNBcnJheVtlJWZdLGMuc29ydChmdW5jdGlvbihhLGIpe3JldHVybiBhW2ddLWJbZ119KSxoPU1hdGguZmxvb3IoaC8yKSx7cG9pbnQ6Y1toXSxsZWZ0OmEoYy5zbGljZSgwLGgpLGUrMSxmKSxyaWdodDphKGMuc2xpY2UoaCsxKSxlKzEsZil9fXZhciBiPXRoaXMsYz1iLmtkRGltZW5zaW9ucztkZWxldGUgYi5rZFRyZWU7WmEoZnVuY3Rpb24oKXtiLmtkVHJlZT1hKGIuZ2V0VmFsaWRQb2ludHMobnVsbCwhYi5kaXJlY3RUb3VjaCksYyxjKX0sYi5vcHRpb25zLmtkTm93PzA6MSl9LHNlYXJjaEtEVHJlZTpmdW5jdGlvbihhLGIpe2Z1bmN0aW9uIGMoYSxiLGosayl7dmFyIGw9Yi5wb2ludCxtPWQua2RBeGlzQXJyYXlbaiVrXSxuLHAscj1sO3A9dihhW2VdKSYmdihsW2VdKT9NYXRoLnBvdyhhW2VdLWxbZV0sMik6bnVsbDtuPXYoYVtmXSkmJnYobFtmXSk/TWF0aC5wb3coYVtmXS1sW2ZdLDIpOm51bGw7XG5uPShwfHwwKSsobnx8MCk7bC5kaXN0PXYobik/TWF0aC5zcXJ0KG4pOk51bWJlci5NQVhfVkFMVUU7bC5kaXN0WD12KHApP01hdGguc3FydChwKTpOdW1iZXIuTUFYX1ZBTFVFO209YVttXS1sW21dO249bTwwP1wibGVmdFwiOlwicmlnaHRcIjtwPW08MD9cInJpZ2h0XCI6XCJsZWZ0XCI7YltuXSYmKG49YyhhLGJbbl0saisxLGspLHI9bltnXTxyW2ddP246bCk7YltwXSYmTWF0aC5zcXJ0KG0qbSk8cltnXSYmKGE9YyhhLGJbcF0saisxLGspLHI9YVtnXTxyW2ddP2E6cik7cmV0dXJuIHJ9dmFyIGQ9dGhpcyxlPXRoaXMua2RBeGlzQXJyYXlbMF0sZj10aGlzLmtkQXhpc0FycmF5WzFdLGc9Yj9cImRpc3RYXCI6XCJkaXN0XCI7dGhpcy5rZFRyZWV8fHRoaXMuYnVpbGRLRFRyZWUoKTtpZih0aGlzLmtkVHJlZSlyZXR1cm4gYyhhLHRoaXMua2RUcmVlLHRoaXMua2REaW1lbnNpb25zLHRoaXMua2REaW1lbnNpb25zKX19O1RiLnByb3RvdHlwZT17ZGVzdHJveTpmdW5jdGlvbigpe1BhKHRoaXMsdGhpcy5heGlzKX0sXG5yZW5kZXI6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5vcHRpb25zLGM9Yi5mb3JtYXQsYz1jP0xhKGMsdGhpcyk6Yi5mb3JtYXR0ZXIuY2FsbCh0aGlzKTt0aGlzLmxhYmVsP3RoaXMubGFiZWwuYXR0cih7dGV4dDpjLHZpc2liaWxpdHk6XCJoaWRkZW5cIn0pOnRoaXMubGFiZWw9dGhpcy5heGlzLmNoYXJ0LnJlbmRlcmVyLnRleHQoYyxudWxsLG51bGwsYi51c2VIVE1MKS5jc3MoYi5zdHlsZSkuYXR0cih7YWxpZ246dGhpcy50ZXh0QWxpZ24scm90YXRpb246Yi5yb3RhdGlvbix2aXNpYmlsaXR5OlwiaGlkZGVuXCJ9KS5hZGQoYSl9LHNldE9mZnNldDpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuYXhpcyxkPWMuY2hhcnQsZT1kLmludmVydGVkLGY9Yy5yZXZlcnNlZCxmPXRoaXMuaXNOZWdhdGl2ZSYmIWZ8fCF0aGlzLmlzTmVnYXRpdmUmJmYsZz1jLnRyYW5zbGF0ZShjLnVzZVBlcmNlbnRhZ2U/MTAwOnRoaXMudG90YWwsMCwwLDAsMSksYz1jLnRyYW5zbGF0ZSgwKSxjPVMoZy1jKSxoPWQueEF4aXNbMF0udHJhbnNsYXRlKHRoaXMueCkrXG5hLGk9ZC5wbG90SGVpZ2h0LGY9e3g6ZT9mP2c6Zy1jOmgseTplP2ktaC1iOmY/aS1nLWM6aS1nLHdpZHRoOmU/YzpiLGhlaWdodDplP2I6Y307aWYoZT10aGlzLmxhYmVsKWUuYWxpZ24odGhpcy5hbGlnbk9wdGlvbnMsbnVsbCxmKSxmPWUuYWxpZ25BdHRyLGVbdGhpcy5vcHRpb25zLmNyb3A9PT0hMXx8ZC5pc0luc2lkZVBsb3QoZi54LGYueSk/XCJzaG93XCI6XCJoaWRlXCJdKCEwKX19O0JhLnByb3RvdHlwZS5nZXRTdGFja3M9ZnVuY3Rpb24oKXt2YXIgYT10aGlzO28oYS55QXhpcyxmdW5jdGlvbihhKXtpZihhLnN0YWNrcyYmYS5oYXNWaXNpYmxlU2VyaWVzKWEub2xkU3RhY2tzPWEuc3RhY2tzfSk7byhhLnNlcmllcyxmdW5jdGlvbihiKXtpZihiLm9wdGlvbnMuc3RhY2tpbmcmJihiLnZpc2libGU9PT0hMHx8YS5vcHRpb25zLmNoYXJ0Lmlnbm9yZUhpZGRlblNlcmllcz09PSExKSliLnN0YWNrS2V5PWIudHlwZStxKGIub3B0aW9ucy5zdGFjayxcIlwiKX0pfTtKLnByb3RvdHlwZS5idWlsZFN0YWNrcz1cbmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5zZXJpZXMsYixjPXEodGhpcy5vcHRpb25zLnJldmVyc2VkU3RhY2tzLCEwKSxkPWEubGVuZ3RoLGU7aWYoIXRoaXMuaXNYQXhpcyl7dGhpcy51c2VQZXJjZW50YWdlPSExO2ZvcihlPWQ7ZS0tOylhW2M/ZTpkLWUtMV0uc2V0U3RhY2tlZFBvaW50cygpO2ZvcihlPWQ7ZS0tOyliPWFbYz9lOmQtZS0xXSxiLnNldFN0YWNrQ2xpZmZzJiZiLnNldFN0YWNrQ2xpZmZzKCk7aWYodGhpcy51c2VQZXJjZW50YWdlKWZvcihlPTA7ZTxkO2UrKylhW2VdLnNldFBlcmNlbnRTdGFja3MoKX19O0oucHJvdG90eXBlLnJlbmRlclN0YWNrVG90YWxzPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5jaGFydCxiPWEucmVuZGVyZXIsYz10aGlzLnN0YWNrcyxkLGUsZj10aGlzLnN0YWNrVG90YWxHcm91cDtpZighZil0aGlzLnN0YWNrVG90YWxHcm91cD1mPWIuZyhcInN0YWNrLWxhYmVsc1wiKS5hdHRyKHt2aXNpYmlsaXR5OlwidmlzaWJsZVwiLHpJbmRleDo2fSkuYWRkKCk7Zi50cmFuc2xhdGUoYS5wbG90TGVmdCxcbmEucGxvdFRvcCk7Zm9yKGQgaW4gYylmb3IoZSBpbiBhPWNbZF0sYSlhW2VdLnJlbmRlcihmKX07Si5wcm90b3R5cGUucmVzZXRTdGFja3M9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLnN0YWNrcyxiLGM7aWYoIXRoaXMuaXNYQXhpcylmb3IoYiBpbiBhKWZvcihjIGluIGFbYl0pYVtiXVtjXS50b3VjaGVkPHRoaXMuc3RhY2tzVG91Y2hlZD8oYVtiXVtjXS5kZXN0cm95KCksZGVsZXRlIGFbYl1bY10pOihhW2JdW2NdLnRvdGFsPW51bGwsYVtiXVtjXS5jdW09MCl9O0oucHJvdG90eXBlLmNsZWFuU3RhY2tzPWZ1bmN0aW9uKCl7dmFyIGEsYixjO2lmKCF0aGlzLmlzWEF4aXMpe2lmKHRoaXMub2xkU3RhY2tzKWE9dGhpcy5zdGFja3M9dGhpcy5vbGRTdGFja3M7Zm9yKGIgaW4gYSlmb3IoYyBpbiBhW2JdKWFbYl1bY10uY3VtPWFbYl1bY10udG90YWx9fTtQLnByb3RvdHlwZS5zZXRTdGFja2VkUG9pbnRzPWZ1bmN0aW9uKCl7aWYodGhpcy5vcHRpb25zLnN0YWNraW5nJiYhKHRoaXMudmlzaWJsZSE9PVxuITAmJnRoaXMuY2hhcnQub3B0aW9ucy5jaGFydC5pZ25vcmVIaWRkZW5TZXJpZXMhPT0hMSkpe3ZhciBhPXRoaXMucHJvY2Vzc2VkWERhdGEsYj10aGlzLnByb2Nlc3NlZFlEYXRhLGM9W10sZD1iLmxlbmd0aCxlPXRoaXMub3B0aW9ucyxmPWUudGhyZXNob2xkLGc9ZS5zdGFydEZyb21UaHJlc2hvbGQ/ZjowLGg9ZS5zdGFjayxlPWUuc3RhY2tpbmcsaT10aGlzLnN0YWNrS2V5LGo9XCItXCIraSxrPXRoaXMubmVnU3RhY2tzLGw9dGhpcy55QXhpcyxtPWwuc3RhY2tzLG49bC5vbGRTdGFja3MscCxyLHMsbyx1LHgsRDtsLnN0YWNrc1RvdWNoZWQrPTE7Zm9yKHU9MDt1PGQ7dSsrKXt4PWFbdV07RD1iW3VdO3A9dGhpcy5nZXRTdGFja0luZGljYXRvcihwLHgsdGhpcy5pbmRleCk7bz1wLmtleTtzPShyPWsmJkQ8KGc/MDpmKSk/ajppO21bc118fChtW3NdPXt9KTtpZighbVtzXVt4XSluW3NdJiZuW3NdW3hdPyhtW3NdW3hdPW5bc11beF0sbVtzXVt4XS50b3RhbD1udWxsKTptW3NdW3hdPW5ldyBUYihsLFxubC5vcHRpb25zLnN0YWNrTGFiZWxzLHIseCxoKTtzPW1bc11beF07aWYoRCE9PW51bGwpcy5wb2ludHNbb109cy5wb2ludHNbdGhpcy5pbmRleF09W3Eocy5jdW0sZyldLHMudG91Y2hlZD1sLnN0YWNrc1RvdWNoZWQscC5pbmRleD4wJiZ0aGlzLnNpbmdsZVN0YWNrcz09PSExJiYocy5wb2ludHNbb11bMF09cy5wb2ludHNbdGhpcy5pbmRleCtcIixcIit4K1wiLDBcIl1bMF0pO2U9PT1cInBlcmNlbnRcIj8ocj1yP2k6aixrJiZtW3JdJiZtW3JdW3hdPyhyPW1bcl1beF0scy50b3RhbD1yLnRvdGFsPXcoci50b3RhbCxzLnRvdGFsKStTKEQpfHwwKTpzLnRvdGFsPWthKHMudG90YWwrKFMoRCl8fDApKSk6cy50b3RhbD1rYShzLnRvdGFsKyhEfHwwKSk7cy5jdW09cShzLmN1bSxnKSsoRHx8MCk7aWYoRCE9PW51bGwpcy5wb2ludHNbb10ucHVzaChzLmN1bSksY1t1XT1zLmN1bX1pZihlPT09XCJwZXJjZW50XCIpbC51c2VQZXJjZW50YWdlPSEwO3RoaXMuc3RhY2tlZFlEYXRhPWM7bC5vbGRTdGFja3M9XG57fX19O1AucHJvdG90eXBlLnNldFBlcmNlbnRTdGFja3M9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5zdGFja0tleSxjPWEueUF4aXMuc3RhY2tzLGQ9YS5wcm9jZXNzZWRYRGF0YSxlO28oW2IsXCItXCIrYl0sZnVuY3Rpb24oYil7dmFyIGY7Zm9yKHZhciBnPWQubGVuZ3RoLGgsaTtnLS07KWlmKGg9ZFtnXSxlPWEuZ2V0U3RhY2tJbmRpY2F0b3IoZSxoLGEuaW5kZXgpLGY9KGk9Y1tiXSYmY1tiXVtoXSkmJmkucG9pbnRzW2Uua2V5XSxoPWYpaT1pLnRvdGFsPzEwMC9pLnRvdGFsOjAsaFswXT1rYShoWzBdKmkpLGhbMV09a2EoaFsxXSppKSxhLnN0YWNrZWRZRGF0YVtnXT1oWzFdfSl9O1AucHJvdG90eXBlLmdldFN0YWNrSW5kaWNhdG9yPWZ1bmN0aW9uKGEsYixjKXshdihhKXx8YS54IT09Yj9hPXt4OmIsaW5kZXg6MH06YS5pbmRleCsrO2Eua2V5PVtjLGIsYS5pbmRleF0uam9pbihcIixcIik7cmV0dXJuIGF9O0EoQmEucHJvdG90eXBlLHthZGRTZXJpZXM6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLFxuZT10aGlzO2EmJihiPXEoYiwhMCksTyhlLFwiYWRkU2VyaWVzXCIse29wdGlvbnM6YX0sZnVuY3Rpb24oKXtkPWUuaW5pdFNlcmllcyhhKTtlLmlzRGlydHlMZWdlbmQ9ITA7ZS5saW5rU2VyaWVzKCk7YiYmZS5yZWRyYXcoYyl9KSk7cmV0dXJuIGR9LGFkZEF4aXM6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9Yj9cInhBeGlzXCI6XCJ5QXhpc1wiLGY9dGhpcy5vcHRpb25zLGE9eihhLHtpbmRleDp0aGlzW2VdLmxlbmd0aCxpc1g6Yn0pO25ldyBKKHRoaXMsYSk7ZltlXT11YShmW2VdfHx7fSk7ZltlXS5wdXNoKGEpO3EoYywhMCkmJnRoaXMucmVkcmF3KGQpfSxzaG93TG9hZGluZzpmdW5jdGlvbihhKXt2YXIgYj10aGlzLGM9Yi5vcHRpb25zLGQ9Yi5sb2FkaW5nRGl2LGU9Yy5sb2FkaW5nLGY9ZnVuY3Rpb24oKXtkJiZOKGQse2xlZnQ6Yi5wbG90TGVmdCtcInB4XCIsdG9wOmIucGxvdFRvcCtcInB4XCIsd2lkdGg6Yi5wbG90V2lkdGgrXCJweFwiLGhlaWdodDpiLnBsb3RIZWlnaHQrXCJweFwifSl9O2lmKCFkKWIubG9hZGluZ0Rpdj1cbmQ9ZmEoVmEse2NsYXNzTmFtZTpcImhpZ2hjaGFydHMtbG9hZGluZ1wifSxBKGUuc3R5bGUse3pJbmRleDoxMCxkaXNwbGF5Olwibm9uZVwifSksYi5jb250YWluZXIpLGIubG9hZGluZ1NwYW49ZmEoXCJzcGFuXCIsbnVsbCxlLmxhYmVsU3R5bGUsZCksRShiLFwicmVkcmF3XCIsZik7Yi5sb2FkaW5nU3Bhbi5pbm5lckhUTUw9YXx8Yy5sYW5nLmxvYWRpbmc7aWYoIWIubG9hZGluZ1Nob3duKU4oZCx7b3BhY2l0eTowLGRpc3BsYXk6XCJcIn0pLGRiKGQse29wYWNpdHk6ZS5zdHlsZS5vcGFjaXR5fSx7ZHVyYXRpb246ZS5zaG93RHVyYXRpb258fDB9KSxiLmxvYWRpbmdTaG93bj0hMDtmKCl9LGhpZGVMb2FkaW5nOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcHRpb25zLGI9dGhpcy5sb2FkaW5nRGl2O2ImJmRiKGIse29wYWNpdHk6MH0se2R1cmF0aW9uOmEubG9hZGluZy5oaWRlRHVyYXRpb258fDEwMCxjb21wbGV0ZTpmdW5jdGlvbigpe04oYix7ZGlzcGxheTpcIm5vbmVcIn0pfX0pO3RoaXMubG9hZGluZ1Nob3duPVxuITF9fSk7QShIYS5wcm90b3R5cGUse3VwZGF0ZTpmdW5jdGlvbihhLGIsYyxkKXtmdW5jdGlvbiBlKCl7Zi5hcHBseU9wdGlvbnMoYSk7aWYoZi55PT09bnVsbCYmaClmLmdyYXBoaWM9aC5kZXN0cm95KCk7aWYoZWEoYSkmJiFKYShhKSlmLnJlZHJhdz1mdW5jdGlvbigpe2lmKGgmJmguZWxlbWVudCYmYSYmYS5tYXJrZXImJmEubWFya2VyLnN5bWJvbClmLmdyYXBoaWM9aC5kZXN0cm95KCk7aWYoYSYmYS5kYXRhTGFiZWxzJiZmLmRhdGFMYWJlbClmLmRhdGFMYWJlbD1mLmRhdGFMYWJlbC5kZXN0cm95KCk7Zi5yZWRyYXc9bnVsbH07aT1mLmluZGV4O2cudXBkYXRlUGFyYWxsZWxBcnJheXMoZixpKTtpZihsJiZmLm5hbWUpbFtmLnhdPWYubmFtZTtrLmRhdGFbaV09ZWEoay5kYXRhW2ldKSYmIUphKGsuZGF0YVtpXSk/Zi5vcHRpb25zOmE7Zy5pc0RpcnR5PWcuaXNEaXJ0eURhdGE9ITA7aWYoIWcuZml4ZWRCb3gmJmcuaGFzQ2FydGVzaWFuU2VyaWVzKWouaXNEaXJ0eUJveD0hMDtpZihrLmxlZ2VuZFR5cGU9PT1cblwicG9pbnRcIilqLmlzRGlydHlMZWdlbmQ9ITA7YiYmai5yZWRyYXcoYyl9dmFyIGY9dGhpcyxnPWYuc2VyaWVzLGg9Zi5ncmFwaGljLGksaj1nLmNoYXJ0LGs9Zy5vcHRpb25zLGw9Zy54QXhpcyYmZy54QXhpcy5uYW1lcyxiPXEoYiwhMCk7ZD09PSExP2UoKTpmLmZpcmVQb2ludEV2ZW50KFwidXBkYXRlXCIse29wdGlvbnM6YX0sZSl9LHJlbW92ZTpmdW5jdGlvbihhLGIpe3RoaXMuc2VyaWVzLnJlbW92ZVBvaW50KHNhKHRoaXMsdGhpcy5zZXJpZXMuZGF0YSksYSxiKX19KTtBKFAucHJvdG90eXBlLHthZGRQb2ludDpmdW5jdGlvbihhLGIsYyxkKXt2YXIgZT10aGlzLGY9ZS5vcHRpb25zLGc9ZS5kYXRhLGg9ZS5ncmFwaCxpPWUuYXJlYSxqPWUuY2hhcnQsaz1lLnhBeGlzJiZlLnhBeGlzLm5hbWVzLGw9aCYmaC5zaGlmdHx8MCxtPVtcImdyYXBoXCIsXCJhcmVhXCJdLGg9Zi5kYXRhLG4scD1lLnhEYXRhOyRhKGQsaik7aWYoYyl7Zm9yKGQ9ZS56b25lcy5sZW5ndGg7ZC0tOyltLnB1c2goXCJ6b25lR3JhcGhcIitcbmQsXCJ6b25lQXJlYVwiK2QpO28obSxmdW5jdGlvbihhKXtpZihlW2FdKWVbYV0uc2hpZnQ9bCsoZi5zdGVwPzI6MSl9KX1pZihpKWkuaXNBcmVhPSEwO2I9cShiLCEwKTtpPXtzZXJpZXM6ZX07ZS5wb2ludENsYXNzLnByb3RvdHlwZS5hcHBseU9wdGlvbnMuYXBwbHkoaSxbYV0pO209aS54O2Q9cC5sZW5ndGg7aWYoZS5yZXF1aXJlU29ydGluZyYmbTxwW2QtMV0pZm9yKG49ITA7ZCYmcFtkLTFdPm07KWQtLTtlLnVwZGF0ZVBhcmFsbGVsQXJyYXlzKGksXCJzcGxpY2VcIixkLDAsMCk7ZS51cGRhdGVQYXJhbGxlbEFycmF5cyhpLGQpO2lmKGsmJmkubmFtZSlrW21dPWkubmFtZTtoLnNwbGljZShkLDAsYSk7biYmKGUuZGF0YS5zcGxpY2UoZCwwLG51bGwpLGUucHJvY2Vzc0RhdGEoKSk7Zi5sZWdlbmRUeXBlPT09XCJwb2ludFwiJiZlLmdlbmVyYXRlUG9pbnRzKCk7YyYmKGdbMF0mJmdbMF0ucmVtb3ZlP2dbMF0ucmVtb3ZlKCExKTooZy5zaGlmdCgpLGUudXBkYXRlUGFyYWxsZWxBcnJheXMoaSxcblwic2hpZnRcIiksaC5zaGlmdCgpKSk7ZS5pc0RpcnR5PSEwO2UuaXNEaXJ0eURhdGE9ITA7YiYmKGUuZ2V0QXR0cmlicygpLGoucmVkcmF3KCkpfSxyZW1vdmVQb2ludDpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9dGhpcyxlPWQuZGF0YSxmPWVbYV0sZz1kLnBvaW50cyxoPWQuY2hhcnQsaT1mdW5jdGlvbigpe2cmJmcubGVuZ3RoPT09ZS5sZW5ndGgmJmcuc3BsaWNlKGEsMSk7ZS5zcGxpY2UoYSwxKTtkLm9wdGlvbnMuZGF0YS5zcGxpY2UoYSwxKTtkLnVwZGF0ZVBhcmFsbGVsQXJyYXlzKGZ8fHtzZXJpZXM6ZH0sXCJzcGxpY2VcIixhLDEpO2YmJmYuZGVzdHJveSgpO2QuaXNEaXJ0eT0hMDtkLmlzRGlydHlEYXRhPSEwO2ImJmgucmVkcmF3KCl9OyRhKGMsaCk7Yj1xKGIsITApO2Y/Zi5maXJlUG9pbnRFdmVudChcInJlbW92ZVwiLG51bGwsaSk6aSgpfSxyZW1vdmU6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLGQ9Yy5jaGFydDtPKGMsXCJyZW1vdmVcIixudWxsLGZ1bmN0aW9uKCl7Yy5kZXN0cm95KCk7XG5kLmlzRGlydHlMZWdlbmQ9ZC5pc0RpcnR5Qm94PSEwO2QubGlua1NlcmllcygpO3EoYSwhMCkmJmQucmVkcmF3KGIpfSl9LHVwZGF0ZTpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMsZD10aGlzLmNoYXJ0LGU9dGhpcy51c2VyT3B0aW9ucyxmPXRoaXMudHlwZSxnPUlbZl0ucHJvdG90eXBlLGg9W1wiZ3JvdXBcIixcIm1hcmtlckdyb3VwXCIsXCJkYXRhTGFiZWxzR3JvdXBcIl0saTtpZihhLnR5cGUmJmEudHlwZSE9PWZ8fGEuekluZGV4IT09dm9pZCAwKWgubGVuZ3RoPTA7byhoLGZ1bmN0aW9uKGEpe2hbYV09Y1thXTtkZWxldGUgY1thXX0pO2E9eihlLHthbmltYXRpb246ITEsaW5kZXg6dGhpcy5pbmRleCxwb2ludFN0YXJ0OnRoaXMueERhdGFbMF19LHtkYXRhOnRoaXMub3B0aW9ucy5kYXRhfSxhKTt0aGlzLnJlbW92ZSghMSk7Zm9yKGkgaW4gZyl0aGlzW2ldPXQ7QSh0aGlzLElbYS50eXBlfHxmXS5wcm90b3R5cGUpO28oaCxmdW5jdGlvbihhKXtjW2FdPWhbYV19KTt0aGlzLmluaXQoZCxcbmEpO2QubGlua1NlcmllcygpO3EoYiwhMCkmJmQucmVkcmF3KCExKX19KTtBKEoucHJvdG90eXBlLHt1cGRhdGU6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmNoYXJ0LGE9Yy5vcHRpb25zW3RoaXMuY29sbF1bdGhpcy5vcHRpb25zLmluZGV4XT16KHRoaXMudXNlck9wdGlvbnMsYSk7dGhpcy5kZXN0cm95KCEwKTt0aGlzLl9hZGRlZFBsb3RMQj10aGlzLmNoYXJ0Ll9sYWJlbFBhbmVzPXQ7dGhpcy5pbml0KGMsQShhLHtldmVudHM6dH0pKTtjLmlzRGlydHlCb3g9ITA7cShiLCEwKSYmYy5yZWRyYXcoKX0scmVtb3ZlOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj10aGlzLmNoYXJ0LGM9dGhpcy5jb2xsLGQ9dGhpcy5zZXJpZXMsZT1kLmxlbmd0aDtlLS07KWRbZV0mJmRbZV0ucmVtb3ZlKCExKTt6YShiLmF4ZXMsdGhpcyk7emEoYltjXSx0aGlzKTtiLm9wdGlvbnNbY10uc3BsaWNlKHRoaXMub3B0aW9ucy5pbmRleCwxKTtvKGJbY10sZnVuY3Rpb24oYSxiKXthLm9wdGlvbnMuaW5kZXg9Yn0pO1xudGhpcy5kZXN0cm95KCk7Yi5pc0RpcnR5Qm94PSEwO3EoYSwhMCkmJmIucmVkcmF3KCl9LHNldFRpdGxlOmZ1bmN0aW9uKGEsYil7dGhpcy51cGRhdGUoe3RpdGxlOmF9LGIpfSxzZXRDYXRlZ29yaWVzOmZ1bmN0aW9uKGEsYil7dGhpcy51cGRhdGUoe2NhdGVnb3JpZXM6YX0sYil9fSk7dmFyIElhPW1hKFApO0kubGluZT1JYTtXLmFyZWE9eihkYSx7c29mdFRocmVzaG9sZDohMSx0aHJlc2hvbGQ6MH0pO3ZhciB5YT1tYShQLHt0eXBlOlwiYXJlYVwiLHNpbmdsZVN0YWNrczohMSxnZXRTdGFja1BvaW50czpmdW5jdGlvbigpe3ZhciBhPVtdLGI9W10sYz10aGlzLnhBeGlzLGQ9dGhpcy55QXhpcyxlPWQuc3RhY2tzW3RoaXMuc3RhY2tLZXldLGY9e30sZz10aGlzLnBvaW50cyxoPXRoaXMuaW5kZXgsaT1kLnNlcmllcyxqPWkubGVuZ3RoLGssbD1xKGQub3B0aW9ucy5yZXZlcnNlZFN0YWNrcywhMCk/MTotMSxtLG47aWYodGhpcy5vcHRpb25zLnN0YWNraW5nKXtmb3IobT0wO208Zy5sZW5ndGg7bSsrKWZbZ1ttXS54XT1cbmdbbV07Zm9yKG4gaW4gZSllW25dLnRvdGFsIT09bnVsbCYmYi5wdXNoKG4pO2Iuc29ydChmdW5jdGlvbihhLGIpe3JldHVybiBhLWJ9KTtrPXRhKGksZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy52aXNpYmxlfSk7byhiLGZ1bmN0aW9uKGcsaSl7dmFyIG49MCxxLHU7aWYoZltnXSYmIWZbZ10uaXNOdWxsKWEucHVzaChmW2ddKSxvKFstMSwxXSxmdW5jdGlvbihhKXt2YXIgYz1hPT09MT9cInJpZ2h0TnVsbFwiOlwibGVmdE51bGxcIixkPTAsbj1lW2JbaSthXV07aWYobilmb3IobT1oO20+PTAmJm08ajspcT1uLnBvaW50c1ttXSxxfHwobT09PWg/ZltnXVtjXT0hMDprW21dJiYodT1lW2ddLnBvaW50c1ttXSkmJihkLT11WzFdLXVbMF0pKSxtKz1sO2ZbZ11bYT09PTE/XCJyaWdodENsaWZmXCI6XCJsZWZ0Q2xpZmZcIl09ZH0pO2Vsc2V7Zm9yKG09aDttPj0wJiZtPGo7KXtpZihxPWVbZ10ucG9pbnRzW21dKXtuPXFbMV07YnJlYWt9bSs9bH1uPWQudG9QaXhlbHMobiwhMCk7YS5wdXNoKHtpc051bGw6ITAsXG5wbG90WDpjLnRvUGl4ZWxzKGcsITApLHBsb3RZOm4seUJvdHRvbTpufSl9fSl9cmV0dXJuIGF9LGdldEdyYXBoUGF0aDpmdW5jdGlvbihhKXt2YXIgYj1QLnByb3RvdHlwZS5nZXRHcmFwaFBhdGgsYz10aGlzLm9wdGlvbnMsZD1jLnN0YWNraW5nLGU9dGhpcy55QXhpcyxmLGcsaD1bXSxpPVtdLGo9dGhpcy5pbmRleCxrLGw9ZS5zdGFja3NbdGhpcy5zdGFja0tleV0sbT1jLnRocmVzaG9sZCxuPWUuZ2V0VGhyZXNob2xkKGMudGhyZXNob2xkKSxwLGM9Yy5jb25uZWN0TnVsbHN8fGQ9PT1cInBlcmNlbnRcIixyPWZ1bmN0aW9uKGIsYyxmKXt2YXIgZz1hW2JdLGI9ZCYmbFtnLnhdLnBvaW50c1tqXSxwPWdbZitcIk51bGxcIl18fDAsZj1nW2YrXCJDbGlmZlwiXXx8MCxyLG8sZz0hMDtmfHxwPyhyPShwP2JbMF06YlsxXSkrZixvPWJbMF0rZixnPSEhcCk6IWQmJmFbY10mJmFbY10uaXNOdWxsJiYocj1vPW0pO3IhPT12b2lkIDAmJihpLnB1c2goe3Bsb3RYOmsscGxvdFk6cj09PW51bGw/bjplLmdldFRocmVzaG9sZChyKSxcbmlzTnVsbDpnfSksaC5wdXNoKHtwbG90WDprLHBsb3RZOm89PT1udWxsP246ZS5nZXRUaHJlc2hvbGQobyl9KSl9LGE9YXx8dGhpcy5wb2ludHM7ZCYmKGE9dGhpcy5nZXRTdGFja1BvaW50cygpKTtmb3IoZj0wO2Y8YS5sZW5ndGg7ZisrKWlmKGc9YVtmXS5pc051bGwsaz1xKGFbZl0ucmVjdFBsb3RYLGFbZl0ucGxvdFgpLHA9cShhW2ZdLnlCb3R0b20sbiksIWd8fGMpe2N8fHIoZixmLTEsXCJsZWZ0XCIpO2lmKCFnfHxkfHwhYylpLnB1c2goYVtmXSksaC5wdXNoKHt4OmYscGxvdFg6ayxwbG90WTpwfSk7Y3x8cihmLGYrMSxcInJpZ2h0XCIpfWY9Yi5jYWxsKHRoaXMsaSwhMCwhMCk7aC5yZXZlcnNlZD0hMDtnPWIuY2FsbCh0aGlzLGgsITAsITApO2cubGVuZ3RoJiYoZ1swXT1cIkxcIik7Zj1mLmNvbmNhdChnKTtiPWIuY2FsbCh0aGlzLGksITEsYyk7dGhpcy5hcmVhUGF0aD1mO3JldHVybiBifSxkcmF3R3JhcGg6ZnVuY3Rpb24oKXt0aGlzLmFyZWFQYXRoPVtdO1AucHJvdG90eXBlLmRyYXdHcmFwaC5hcHBseSh0aGlzKTtcbnZhciBhPXRoaXMsYj10aGlzLmFyZWFQYXRoLGM9dGhpcy5vcHRpb25zLGQ9W1tcImFyZWFcIix0aGlzLmNvbG9yLGMuZmlsbENvbG9yXV07byh0aGlzLnpvbmVzLGZ1bmN0aW9uKGIsZil7ZC5wdXNoKFtcInpvbmVBcmVhXCIrZixiLmNvbG9yfHxhLmNvbG9yLGIuZmlsbENvbG9yfHxjLmZpbGxDb2xvcl0pfSk7byhkLGZ1bmN0aW9uKGQpe3ZhciBmPWRbMF0sZz1hW2ZdO2c/Zy5hbmltYXRlKHtkOmJ9KTooZz17ZmlsbDpkWzJdfHxkWzFdLHpJbmRleDowfSxkWzJdfHwoZ1tcImZpbGwtb3BhY2l0eVwiXT1xKGMuZmlsbE9wYWNpdHksMC43NSkpLGFbZl09YS5jaGFydC5yZW5kZXJlci5wYXRoKGIpLmF0dHIoZykuYWRkKGEuZ3JvdXApKX0pfSxkcmF3TGVnZW5kU3ltYm9sOmFhLmRyYXdSZWN0YW5nbGV9KTtJLmFyZWE9eWE7Vy5zcGxpbmU9eihkYSk7SWE9bWEoUCx7dHlwZTpcInNwbGluZVwiLGdldFBvaW50U3BsaW5lOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD1iLnBsb3RYLGU9Yi5wbG90WSxmPWFbYy1cbjFdLGM9YVtjKzFdLGcsaCxpLGo7aWYoZiYmIWYuaXNOdWxsJiZjJiYhYy5pc051bGwpe2E9Zi5wbG90WTtpPWMucGxvdFg7dmFyIGM9Yy5wbG90WSxrPTA7Zz0oMS41KmQrZi5wbG90WCkvMi41O2g9KDEuNSplK2EpLzIuNTtpPSgxLjUqZCtpKS8yLjU7aj0oMS41KmUrYykvMi41O2khPT1nJiYoaz0oai1oKSooaS1kKS8oaS1nKStlLWopO2grPWs7ais9aztoPmEmJmg+ZT8oaD13KGEsZSksaj0yKmUtaCk6aDxhJiZoPGUmJihoPUcoYSxlKSxqPTIqZS1oKTtqPmMmJmo+ZT8oaj13KGMsZSksaD0yKmUtaik6ajxjJiZqPGUmJihqPUcoYyxlKSxoPTIqZS1qKTtiLnJpZ2h0Q29udFg9aTtiLnJpZ2h0Q29udFk9an1iPVtcIkNcIixxKGYucmlnaHRDb250WCxmLnBsb3RYKSxxKGYucmlnaHRDb250WSxmLnBsb3RZKSxxKGcsZCkscShoLGUpLGQsZV07Zi5yaWdodENvbnRYPWYucmlnaHRDb250WT1udWxsO3JldHVybiBifX0pO0kuc3BsaW5lPUlhO1cuYXJlYXNwbGluZT16KFcuYXJlYSk7eWE9XG55YS5wcm90b3R5cGU7SWE9bWEoSWEse3R5cGU6XCJhcmVhc3BsaW5lXCIsZ2V0U3RhY2tQb2ludHM6eWEuZ2V0U3RhY2tQb2ludHMsZ2V0R3JhcGhQYXRoOnlhLmdldEdyYXBoUGF0aCxzZXRTdGFja0NsaWZmczp5YS5zZXRTdGFja0NsaWZmcyxkcmF3R3JhcGg6eWEuZHJhd0dyYXBoLGRyYXdMZWdlbmRTeW1ib2w6YWEuZHJhd1JlY3RhbmdsZX0pO0kuYXJlYXNwbGluZT1JYTtXLmNvbHVtbj16KGRhLHtib3JkZXJDb2xvcjpcIiNGRkZGRkZcIixib3JkZXJSYWRpdXM6MCxncm91cFBhZGRpbmc6MC4yLG1hcmtlcjpudWxsLHBvaW50UGFkZGluZzowLjEsbWluUG9pbnRMZW5ndGg6MCxjcm9wVGhyZXNob2xkOjUwLHBvaW50UmFuZ2U6bnVsbCxzdGF0ZXM6e2hvdmVyOnticmlnaHRuZXNzOjAuMSxzaGFkb3c6ITEsaGFsbzohMX0sc2VsZWN0Ontjb2xvcjpcIiNDMEMwQzBcIixib3JkZXJDb2xvcjpcIiMwMDAwMDBcIixzaGFkb3c6ITF9fSxkYXRhTGFiZWxzOnthbGlnbjpudWxsLHZlcnRpY2FsQWxpZ246bnVsbCxcbnk6bnVsbH0sc29mdFRocmVzaG9sZDohMSxzdGFydEZyb21UaHJlc2hvbGQ6ITAsc3RpY2t5VHJhY2tpbmc6ITEsdG9vbHRpcDp7ZGlzdGFuY2U6Nn0sdGhyZXNob2xkOjB9KTtJYT1tYShQLHt0eXBlOlwiY29sdW1uXCIscG9pbnRBdHRyVG9PcHRpb25zOntzdHJva2U6XCJib3JkZXJDb2xvclwiLGZpbGw6XCJjb2xvclwiLHI6XCJib3JkZXJSYWRpdXNcIn0sY3JvcFNob3VsZGVyOjAsZGlyZWN0VG91Y2g6ITAsdHJhY2tlckdyb3VwczpbXCJncm91cFwiLFwiZGF0YUxhYmVsc0dyb3VwXCJdLG5lZ1N0YWNrczohMCxpbml0OmZ1bmN0aW9uKCl7UC5wcm90b3R5cGUuaW5pdC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dmFyIGE9dGhpcyxiPWEuY2hhcnQ7Yi5oYXNSZW5kZXJlZCYmbyhiLnNlcmllcyxmdW5jdGlvbihiKXtpZihiLnR5cGU9PT1hLnR5cGUpYi5pc0RpcnR5PSEwfSl9LGdldENvbHVtbk1ldHJpY3M6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5vcHRpb25zLGM9YS54QXhpcyxkPWEueUF4aXMsZT1cbmMucmV2ZXJzZWQsZixnPXt9LGg9MDtiLmdyb3VwaW5nPT09ITE/aD0xOm8oYS5jaGFydC5zZXJpZXMsZnVuY3Rpb24oYil7dmFyIGM9Yi5vcHRpb25zLGU9Yi55QXhpcyxpO2lmKGIudHlwZT09PWEudHlwZSYmYi52aXNpYmxlJiZkLmxlbj09PWUubGVuJiZkLnBvcz09PWUucG9zKWMuc3RhY2tpbmc/KGY9Yi5zdGFja0tleSxnW2ZdPT09dCYmKGdbZl09aCsrKSxpPWdbZl0pOmMuZ3JvdXBpbmchPT0hMSYmKGk9aCsrKSxiLmNvbHVtbkluZGV4PWl9KTt2YXIgaT1HKFMoYy50cmFuc0EpKihjLm9yZGluYWxTbG9wZXx8Yi5wb2ludFJhbmdlfHxjLmNsb3Nlc3RQb2ludFJhbmdlfHxjLnRpY2tJbnRlcnZhbHx8MSksYy5sZW4pLGo9aSpiLmdyb3VwUGFkZGluZyxrPShpLTIqaikvaCxiPUcoYi5tYXhQb2ludFdpZHRofHxjLmxlbixxKGIucG9pbnRXaWR0aCxrKigxLTIqYi5wb2ludFBhZGRpbmcpKSk7YS5jb2x1bW5NZXRyaWNzPXt3aWR0aDpiLG9mZnNldDooay1iKS8yKyhqKygoYS5jb2x1bW5JbmRleHx8XG4wKSsoZT8xOjApKSprLWkvMikqKGU/LTE6MSl9O3JldHVybiBhLmNvbHVtbk1ldHJpY3N9LGNyaXNwQ29sOmZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPXRoaXMuY2hhcnQsZj10aGlzLmJvcmRlcldpZHRoLGc9LShmJTI/MC41OjApLGY9ZiUyPzAuNToxO2UuaW52ZXJ0ZWQmJmUucmVuZGVyZXIuaXNWTUwmJihmKz0xKTtjPU1hdGgucm91bmQoYStjKStnO2E9TWF0aC5yb3VuZChhKStnO2MtPWE7ZD1NYXRoLnJvdW5kKGIrZCkrZjtnPVMoYik8PTAuNSYmZD4wLjU7Yj1NYXRoLnJvdW5kKGIpK2Y7ZC09YjtnJiZkJiYoYi09MSxkKz0xKTtyZXR1cm57eDphLHk6Yix3aWR0aDpjLGhlaWdodDpkfX0sdHJhbnNsYXRlOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEuY2hhcnQsYz1hLm9wdGlvbnMsZD1hLmJvcmRlcldpZHRoPXEoYy5ib3JkZXJXaWR0aCxhLmNsb3Nlc3RQb2ludFJhbmdlKmEueEF4aXMudHJhbnNBPDI/MDoxKSxlPWEueUF4aXMsZj1hLnRyYW5zbGF0ZWRUaHJlc2hvbGQ9ZS5nZXRUaHJlc2hvbGQoYy50aHJlc2hvbGQpLFxuZz1xKGMubWluUG9pbnRMZW5ndGgsNSksaD1hLmdldENvbHVtbk1ldHJpY3MoKSxpPWgud2lkdGgsaj1hLmJhclc9dyhpLDErMipkKSxrPWEucG9pbnRYT2Zmc2V0PWgub2Zmc2V0O2IuaW52ZXJ0ZWQmJihmLT0wLjUpO2MucG9pbnRQYWRkaW5nJiYoaj1FYShqKSk7UC5wcm90b3R5cGUudHJhbnNsYXRlLmFwcGx5KGEpO28oYS5wb2ludHMsZnVuY3Rpb24oYyl7dmFyIGQ9RyhxKGMueUJvdHRvbSxmKSw5RTQpLGg9OTk5K1MoZCksaD1HKHcoLWgsYy5wbG90WSksZS5sZW4raCkscD1jLnBsb3RYK2sscj1qLG89RyhoLGQpLEYsdT13KGgsZCktbztTKHUpPGcmJmcmJih1PWcsRj0hZS5yZXZlcnNlZCYmIWMubmVnYXRpdmV8fGUucmV2ZXJzZWQmJmMubmVnYXRpdmUsbz1TKG8tZik+Zz9kLWc6Zi0oRj9nOjApKTtjLmJhclg9cDtjLnBvaW50V2lkdGg9aTtjLnRvb2x0aXBQb3M9Yi5pbnZlcnRlZD9bZS5sZW4rZS5wb3MtYi5wbG90TGVmdC1oLGEueEF4aXMubGVuLXAtci8yLHVdOltwK3IvXG4yLGgrZS5wb3MtYi5wbG90VG9wLHVdO2Muc2hhcGVUeXBlPVwicmVjdFwiO2Muc2hhcGVBcmdzPWEuY3Jpc3BDb2wocCxvLHIsdSl9KX0sZ2V0U3ltYm9sOnJhLGRyYXdMZWdlbmRTeW1ib2w6YWEuZHJhd1JlY3RhbmdsZSxkcmF3R3JhcGg6cmEsZHJhd1BvaW50czpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj10aGlzLmNoYXJ0LGM9YS5vcHRpb25zLGQ9Yi5yZW5kZXJlcixlPWMuYW5pbWF0aW9uTGltaXR8fDI1MCxmLGc7byhhLnBvaW50cyxmdW5jdGlvbihoKXt2YXIgaT1oLmdyYXBoaWMsajtpZihDKGgucGxvdFkpJiZoLnkhPT1udWxsKWY9aC5zaGFwZUFyZ3Msaj12KGEuYm9yZGVyV2lkdGgpP3tcInN0cm9rZS13aWR0aFwiOmEuYm9yZGVyV2lkdGh9Ont9LGc9aC5wb2ludEF0dHJbaC5zZWxlY3RlZD9cInNlbGVjdFwiOlwiXCJdfHxhLnBvaW50QXR0cltcIlwiXSxpPyhTYShpKSxpLmF0dHIoaikuYXR0cihnKVtiLnBvaW50Q291bnQ8ZT9cImFuaW1hdGVcIjpcImF0dHJcIl0oeihmKSkpOmguZ3JhcGhpYz1cbmRbaC5zaGFwZVR5cGVdKGYpLmF0dHIoaikuYXR0cihnKS5hZGQoaC5ncm91cHx8YS5ncm91cCkuc2hhZG93KGMuc2hhZG93LG51bGwsYy5zdGFja2luZyYmIWMuYm9yZGVyUmFkaXVzKTtlbHNlIGlmKGkpaC5ncmFwaGljPWkuZGVzdHJveSgpfSl9LGFuaW1hdGU6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcyxjPXRoaXMueUF4aXMsZD1iLm9wdGlvbnMsZT10aGlzLmNoYXJ0LmludmVydGVkLGY9e307aWYoamEpYT8oZi5zY2FsZVk9MC4wMDEsYT1HKGMucG9zK2MubGVuLHcoYy5wb3MsYy50b1BpeGVscyhkLnRocmVzaG9sZCkpKSxlP2YudHJhbnNsYXRlWD1hLWMubGVuOmYudHJhbnNsYXRlWT1hLGIuZ3JvdXAuYXR0cihmKSk6KGZbZT9cInRyYW5zbGF0ZVhcIjpcInRyYW5zbGF0ZVlcIl09Yy5wb3MsYi5ncm91cC5hbmltYXRlKGYsQShnYihiLm9wdGlvbnMuYW5pbWF0aW9uKSx7c3RlcDpmdW5jdGlvbihhLGMpe2IuZ3JvdXAuYXR0cih7c2NhbGVZOncoMC4wMDEsYy5wb3MpfSl9fSkpLGIuYW5pbWF0ZT1cbm51bGwpfSxyZW1vdmU6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5jaGFydDtiLmhhc1JlbmRlcmVkJiZvKGIuc2VyaWVzLGZ1bmN0aW9uKGIpe2lmKGIudHlwZT09PWEudHlwZSliLmlzRGlydHk9ITB9KTtQLnByb3RvdHlwZS5yZW1vdmUuYXBwbHkoYSxhcmd1bWVudHMpfX0pO0kuY29sdW1uPUlhO1cuYmFyPXooVy5jb2x1bW4pO3lhPW1hKElhLHt0eXBlOlwiYmFyXCIsaW52ZXJ0ZWQ6ITB9KTtJLmJhcj15YTtXLnNjYXR0ZXI9eihkYSx7bGluZVdpZHRoOjAsbWFya2VyOntlbmFibGVkOiEwfSx0b29sdGlwOntoZWFkZXJGb3JtYXQ6JzxzcGFuIHN0eWxlPVwiY29sb3I6e3BvaW50LmNvbG9yfVwiPlxcdTI1Y2Y8L3NwYW4+IDxzcGFuIHN0eWxlPVwiZm9udC1zaXplOiAxMHB4O1wiPiB7c2VyaWVzLm5hbWV9PC9zcGFuPjxici8+Jyxwb2ludEZvcm1hdDpcIng6IDxiPntwb2ludC54fTwvYj48YnIvPnk6IDxiPntwb2ludC55fTwvYj48YnIvPlwifX0pO3lhPW1hKFAse3R5cGU6XCJzY2F0dGVyXCIsXG5zb3J0ZWQ6ITEscmVxdWlyZVNvcnRpbmc6ITEsbm9TaGFyZWRUb29sdGlwOiEwLHRyYWNrZXJHcm91cHM6W1wiZ3JvdXBcIixcIm1hcmtlckdyb3VwXCIsXCJkYXRhTGFiZWxzR3JvdXBcIl0sdGFrZU9yZGluYWxQb3NpdGlvbjohMSxrZERpbWVuc2lvbnM6MixkcmF3R3JhcGg6ZnVuY3Rpb24oKXt0aGlzLm9wdGlvbnMubGluZVdpZHRoJiZQLnByb3RvdHlwZS5kcmF3R3JhcGguY2FsbCh0aGlzKX19KTtJLnNjYXR0ZXI9eWE7Vy5waWU9eihkYSx7Ym9yZGVyQ29sb3I6XCIjRkZGRkZGXCIsYm9yZGVyV2lkdGg6MSxjZW50ZXI6W251bGwsbnVsbF0sY2xpcDohMSxjb2xvckJ5UG9pbnQ6ITAsZGF0YUxhYmVsczp7ZGlzdGFuY2U6MzAsZW5hYmxlZDohMCxmb3JtYXR0ZXI6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy55PT09bnVsbD92b2lkIDA6dGhpcy5wb2ludC5uYW1lfSx4OjB9LGlnbm9yZUhpZGRlblBvaW50OiEwLGxlZ2VuZFR5cGU6XCJwb2ludFwiLG1hcmtlcjpudWxsLHNpemU6bnVsbCxzaG93SW5MZWdlbmQ6ITEsXG5zbGljZWRPZmZzZXQ6MTAsc3RhdGVzOntob3Zlcjp7YnJpZ2h0bmVzczowLjEsc2hhZG93OiExfX0sc3RpY2t5VHJhY2tpbmc6ITEsdG9vbHRpcDp7Zm9sbG93UG9pbnRlcjohMH19KTtkYT17dHlwZTpcInBpZVwiLGlzQ2FydGVzaWFuOiExLHBvaW50Q2xhc3M6bWEoSGEse2luaXQ6ZnVuY3Rpb24oKXtIYS5wcm90b3R5cGUuaW5pdC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dmFyIGE9dGhpcyxiO2EubmFtZT1xKGEubmFtZSxcIlNsaWNlXCIpO2I9ZnVuY3Rpb24oYil7YS5zbGljZShiLnR5cGU9PT1cInNlbGVjdFwiKX07RShhLFwic2VsZWN0XCIsYik7RShhLFwidW5zZWxlY3RcIixiKTtyZXR1cm4gYX0sc2V0VmlzaWJsZTpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMsZD1jLnNlcmllcyxlPWQuY2hhcnQsZj1kLm9wdGlvbnMuaWdub3JlSGlkZGVuUG9pbnQsYj1xKGIsZik7aWYoYSE9PWMudmlzaWJsZSl7Yy52aXNpYmxlPWMub3B0aW9ucy52aXNpYmxlPWE9YT09PXQ/IWMudmlzaWJsZTphO2Qub3B0aW9ucy5kYXRhW3NhKGMsXG5kLmRhdGEpXT1jLm9wdGlvbnM7byhbXCJncmFwaGljXCIsXCJkYXRhTGFiZWxcIixcImNvbm5lY3RvclwiLFwic2hhZG93R3JvdXBcIl0sZnVuY3Rpb24oYil7aWYoY1tiXSljW2JdW2E/XCJzaG93XCI6XCJoaWRlXCJdKCEwKX0pO2MubGVnZW5kSXRlbSYmZS5sZWdlbmQuY29sb3JpemVJdGVtKGMsYSk7IWEmJmMuc3RhdGU9PT1cImhvdmVyXCImJmMuc2V0U3RhdGUoXCJcIik7aWYoZilkLmlzRGlydHk9ITA7YiYmZS5yZWRyYXcoKX19LHNsaWNlOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD10aGlzLnNlcmllczskYShjLGQuY2hhcnQpO3EoYiwhMCk7dGhpcy5zbGljZWQ9dGhpcy5vcHRpb25zLnNsaWNlZD1hPXYoYSk/YTohdGhpcy5zbGljZWQ7ZC5vcHRpb25zLmRhdGFbc2EodGhpcyxkLmRhdGEpXT10aGlzLm9wdGlvbnM7YT1hP3RoaXMuc2xpY2VkVHJhbnNsYXRpb246e3RyYW5zbGF0ZVg6MCx0cmFuc2xhdGVZOjB9O3RoaXMuZ3JhcGhpYy5hbmltYXRlKGEpO3RoaXMuc2hhZG93R3JvdXAmJnRoaXMuc2hhZG93R3JvdXAuYW5pbWF0ZShhKX0sXG5oYWxvUGF0aDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLnNoYXBlQXJncyxjPXRoaXMuc2VyaWVzLmNoYXJ0O3JldHVybiB0aGlzLnNsaWNlZHx8IXRoaXMudmlzaWJsZT9bXTp0aGlzLnNlcmllcy5jaGFydC5yZW5kZXJlci5zeW1ib2xzLmFyYyhjLnBsb3RMZWZ0K2IueCxjLnBsb3RUb3ArYi55LGIucithLGIucithLHtpbm5lclI6dGhpcy5zaGFwZUFyZ3MucixzdGFydDpiLnN0YXJ0LGVuZDpiLmVuZH0pfX0pLHJlcXVpcmVTb3J0aW5nOiExLGRpcmVjdFRvdWNoOiEwLG5vU2hhcmVkVG9vbHRpcDohMCx0cmFja2VyR3JvdXBzOltcImdyb3VwXCIsXCJkYXRhTGFiZWxzR3JvdXBcIl0sYXhpc1R5cGVzOltdLHBvaW50QXR0clRvT3B0aW9uczp7c3Ryb2tlOlwiYm9yZGVyQ29sb3JcIixcInN0cm9rZS13aWR0aFwiOlwiYm9yZGVyV2lkdGhcIixmaWxsOlwiY29sb3JcIn0sYW5pbWF0ZTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLGM9Yi5wb2ludHMsZD1iLnN0YXJ0QW5nbGVSYWQ7aWYoIWEpbyhjLGZ1bmN0aW9uKGEpe3ZhciBjPVxuYS5ncmFwaGljLGc9YS5zaGFwZUFyZ3M7YyYmKGMuYXR0cih7cjphLnN0YXJ0Unx8Yi5jZW50ZXJbM10vMixzdGFydDpkLGVuZDpkfSksYy5hbmltYXRlKHtyOmcucixzdGFydDpnLnN0YXJ0LGVuZDpnLmVuZH0sYi5vcHRpb25zLmFuaW1hdGlvbikpfSksYi5hbmltYXRlPW51bGx9LHVwZGF0ZVRvdGFsczpmdW5jdGlvbigpe3ZhciBhLGI9MCxjPXRoaXMucG9pbnRzLGQ9Yy5sZW5ndGgsZSxmPXRoaXMub3B0aW9ucy5pZ25vcmVIaWRkZW5Qb2ludDtmb3IoYT0wO2E8ZDthKyspZT1jW2FdLGIrPWYmJiFlLnZpc2libGU/MDplLnk7dGhpcy50b3RhbD1iO2ZvcihhPTA7YTxkO2ErKyllPWNbYV0sZS5wZXJjZW50YWdlPWI+MCYmKGUudmlzaWJsZXx8IWYpP2UueS9iKjEwMDowLGUudG90YWw9Yn0sZ2VuZXJhdGVQb2ludHM6ZnVuY3Rpb24oKXtQLnByb3RvdHlwZS5nZW5lcmF0ZVBvaW50cy5jYWxsKHRoaXMpO3RoaXMudXBkYXRlVG90YWxzKCl9LHRyYW5zbGF0ZTpmdW5jdGlvbihhKXt0aGlzLmdlbmVyYXRlUG9pbnRzKCk7XG52YXIgYj0wLGM9dGhpcy5vcHRpb25zLGQ9Yy5zbGljZWRPZmZzZXQsZT1kK2MuYm9yZGVyV2lkdGgsZixnLGgsaT1jLnN0YXJ0QW5nbGV8fDAsaj10aGlzLnN0YXJ0QW5nbGVSYWQ9QWEvMTgwKihpLTkwKSxpPSh0aGlzLmVuZEFuZ2xlUmFkPUFhLzE4MCoocShjLmVuZEFuZ2xlLGkrMzYwKS05MCkpLWosaz10aGlzLnBvaW50cyxsPWMuZGF0YUxhYmVscy5kaXN0YW5jZSxjPWMuaWdub3JlSGlkZGVuUG9pbnQsbSxuPWsubGVuZ3RoLHA7aWYoIWEpdGhpcy5jZW50ZXI9YT10aGlzLmdldENlbnRlcigpO3RoaXMuZ2V0WD1mdW5jdGlvbihiLGMpe2g9WS5hc2luKEcoKGItYVsxXSkvKGFbMl0vMitsKSwxKSk7cmV0dXJuIGFbMF0rKGM/LTE6MSkqY2EoaCkqKGFbMl0vMitsKX07Zm9yKG09MDttPG47bSsrKXtwPWtbbV07Zj1qK2IqaTtpZighY3x8cC52aXNpYmxlKWIrPXAucGVyY2VudGFnZS8xMDA7Zz1qK2IqaTtwLnNoYXBlVHlwZT1cImFyY1wiO3Auc2hhcGVBcmdzPXt4OmFbMF0seTphWzFdLFxucjphWzJdLzIsaW5uZXJSOmFbM10vMixzdGFydDp5KGYqMUUzKS8xRTMsZW5kOnkoZyoxRTMpLzFFM307aD0oZytmKS8yO2g+MS41KkFhP2gtPTIqQWE6aDwtQWEvMiYmKGgrPTIqQWEpO3Auc2xpY2VkVHJhbnNsYXRpb249e3RyYW5zbGF0ZVg6eShjYShoKSpkKSx0cmFuc2xhdGVZOnkobGEoaCkqZCl9O2Y9Y2EoaCkqYVsyXS8yO2c9bGEoaCkqYVsyXS8yO3AudG9vbHRpcFBvcz1bYVswXStmKjAuNyxhWzFdK2cqMC43XTtwLmhhbGY9aDwtQWEvMnx8aD5BYS8yPzE6MDtwLmFuZ2xlPWg7ZT1HKGUsbC8yKTtwLmxhYmVsUG9zPVthWzBdK2YrY2EoaCkqbCxhWzFdK2crbGEoaCkqbCxhWzBdK2YrY2EoaCkqZSxhWzFdK2crbGEoaCkqZSxhWzBdK2YsYVsxXStnLGw8MD9cImNlbnRlclwiOnAuaGFsZj9cInJpZ2h0XCI6XCJsZWZ0XCIsaF19fSxkcmF3R3JhcGg6bnVsbCxkcmF3UG9pbnRzOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEuY2hhcnQucmVuZGVyZXIsYyxkLGU9YS5vcHRpb25zLnNoYWRvdyxcbmYsZyxoLGk7aWYoZSYmIWEuc2hhZG93R3JvdXApYS5zaGFkb3dHcm91cD1iLmcoXCJzaGFkb3dcIikuYWRkKGEuZ3JvdXApO28oYS5wb2ludHMsZnVuY3Rpb24oail7aWYoai55IT09bnVsbCl7ZD1qLmdyYXBoaWM7aD1qLnNoYXBlQXJncztmPWouc2hhZG93R3JvdXA7Zz1qLnBvaW50QXR0cltqLnNlbGVjdGVkP1wic2VsZWN0XCI6XCJcIl07aWYoIWcuc3Ryb2tlKWcuc3Ryb2tlPWcuZmlsbDtpZihlJiYhZilmPWouc2hhZG93R3JvdXA9Yi5nKFwic2hhZG93XCIpLmFkZChhLnNoYWRvd0dyb3VwKTtjPWouc2xpY2VkP2ouc2xpY2VkVHJhbnNsYXRpb246e3RyYW5zbGF0ZVg6MCx0cmFuc2xhdGVZOjB9O2YmJmYuYXR0cihjKTtpZihkKWQuc2V0UmFkaWFsUmVmZXJlbmNlKGEuY2VudGVyKS5hdHRyKGcpLmFuaW1hdGUoQShoLGMpKTtlbHNle2k9e1wic3Ryb2tlLWxpbmVqb2luXCI6XCJyb3VuZFwifTtpZighai52aXNpYmxlKWkudmlzaWJpbGl0eT1cImhpZGRlblwiO2ouZ3JhcGhpYz1kPWJbai5zaGFwZVR5cGVdKGgpLnNldFJhZGlhbFJlZmVyZW5jZShhLmNlbnRlcikuYXR0cihnKS5hdHRyKGkpLmF0dHIoYykuYWRkKGEuZ3JvdXApLnNoYWRvdyhlLFxuZil9fX0pfSxzZWFyY2hQb2ludDpyYSxzb3J0QnlBbmdsZTpmdW5jdGlvbihhLGIpe2Euc29ydChmdW5jdGlvbihhLGQpe3JldHVybiBhLmFuZ2xlIT09dm9pZCAwJiYoZC5hbmdsZS1hLmFuZ2xlKSpifSl9LGRyYXdMZWdlbmRTeW1ib2w6YWEuZHJhd1JlY3RhbmdsZSxnZXRDZW50ZXI6YmMuZ2V0Q2VudGVyLGdldFN5bWJvbDpyYX07ZGE9bWEoUCxkYSk7SS5waWU9ZGE7UC5wcm90b3R5cGUuZHJhd0RhdGFMYWJlbHM9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5vcHRpb25zLGM9Yi5jdXJzb3IsZD1iLmRhdGFMYWJlbHMsZT1hLnBvaW50cyxmLGcsaD1hLmhhc1JlbmRlcmVkfHwwLGksaixrPXEoZC5kZWZlciwhMCksbD1hLmNoYXJ0LnJlbmRlcmVyO2lmKGQuZW5hYmxlZHx8YS5faGFzUG9pbnRMYWJlbHMpYS5kbFByb2Nlc3NPcHRpb25zJiZhLmRsUHJvY2Vzc09wdGlvbnMoZCksaj1hLnBsb3RHcm91cChcImRhdGFMYWJlbHNHcm91cFwiLFwiZGF0YS1sYWJlbHNcIixrJiYhaD9cImhpZGRlblwiOlxuXCJ2aXNpYmxlXCIsZC56SW5kZXh8fDYpLGsmJihqLmF0dHIoe29wYWNpdHk6K2h9KSxofHxFKGEsXCJhZnRlckFuaW1hdGVcIixmdW5jdGlvbigpe2EudmlzaWJsZSYmai5zaG93KCk7altiLmFuaW1hdGlvbj9cImFuaW1hdGVcIjpcImF0dHJcIl0oe29wYWNpdHk6MX0se2R1cmF0aW9uOjIwMH0pfSkpLGc9ZCxvKGUsZnVuY3Rpb24oZSl7dmFyIGgsaz1lLmRhdGFMYWJlbCxyLG8sRj1lLmNvbm5lY3Rvcix1PSEwLHgsRD17fTtmPWUuZGxPcHRpb25zfHxlLm9wdGlvbnMmJmUub3B0aW9ucy5kYXRhTGFiZWxzO2g9cShmJiZmLmVuYWJsZWQsZy5lbmFibGVkKSYmZS55IT09bnVsbDtpZihrJiYhaCllLmRhdGFMYWJlbD1rLmRlc3Ryb3koKTtlbHNlIGlmKGgpe2Q9eihnLGYpO3g9ZC5zdHlsZTtoPWQucm90YXRpb247cj1lLmdldExhYmVsQ29uZmlnKCk7aT1kLmZvcm1hdD9MYShkLmZvcm1hdCxyKTpkLmZvcm1hdHRlci5jYWxsKHIsZCk7eC5jb2xvcj1xKGQuY29sb3IseC5jb2xvcixhLmNvbG9yLFwiYmxhY2tcIik7XG5pZihrKWlmKHYoaSkpay5hdHRyKHt0ZXh0Oml9KSx1PSExO2Vsc2V7aWYoZS5kYXRhTGFiZWw9az1rLmRlc3Ryb3koKSxGKWUuY29ubmVjdG9yPUYuZGVzdHJveSgpfWVsc2UgaWYodihpKSl7az17ZmlsbDpkLmJhY2tncm91bmRDb2xvcixzdHJva2U6ZC5ib3JkZXJDb2xvcixcInN0cm9rZS13aWR0aFwiOmQuYm9yZGVyV2lkdGgscjpkLmJvcmRlclJhZGl1c3x8MCxyb3RhdGlvbjpoLHBhZGRpbmc6ZC5wYWRkaW5nLHpJbmRleDoxfTtpZih4LmNvbG9yPT09XCJjb250cmFzdFwiKUQuY29sb3I9ZC5pbnNpZGV8fGQuZGlzdGFuY2U8MHx8Yi5zdGFja2luZz9sLmdldENvbnRyYXN0KGUuY29sb3J8fGEuY29sb3IpOlwiIzAwMDAwMFwiO2lmKGMpRC5jdXJzb3I9Yztmb3IobyBpbiBrKWtbb109PT10JiZkZWxldGUga1tvXTtrPWUuZGF0YUxhYmVsPWxbaD9cInRleHRcIjpcImxhYmVsXCJdKGksMCwtOTk5OSxkLnNoYXBlLG51bGwsbnVsbCxkLnVzZUhUTUwpLmF0dHIoaykuY3NzKEEoeCxEKSkuYWRkKGopLnNoYWRvdyhkLnNoYWRvdyl9ayYmXG5hLmFsaWduRGF0YUxhYmVsKGUsayxkLG51bGwsdSl9fSl9O1AucHJvdG90eXBlLmFsaWduRGF0YUxhYmVsPWZ1bmN0aW9uKGEsYixjLGQsZSl7dmFyIGY9dGhpcy5jaGFydCxnPWYuaW52ZXJ0ZWQsaD1xKGEucGxvdFgsLTk5OTkpLGk9cShhLnBsb3RZLC05OTk5KSxqPWIuZ2V0QkJveCgpLGs9Zi5yZW5kZXJlci5mb250TWV0cmljcyhjLnN0eWxlLmZvbnRTaXplKS5iLGw9Yy5yb3RhdGlvbixtPWMuYWxpZ24sbj10aGlzLnZpc2libGUmJihhLnNlcmllcy5mb3JjZURMfHxmLmlzSW5zaWRlUGxvdChoLHkoaSksZyl8fGQmJmYuaXNJbnNpZGVQbG90KGgsZz9kLngrMTpkLnkrZC5oZWlnaHQtMSxnKSkscD1xKGMub3ZlcmZsb3csXCJqdXN0aWZ5XCIpPT09XCJqdXN0aWZ5XCI7aWYobilkPUEoe3g6Zz9mLnBsb3RXaWR0aC1pOmgseTp5KGc/Zi5wbG90SGVpZ2h0LWg6aSksd2lkdGg6MCxoZWlnaHQ6MH0sZCksQShjLHt3aWR0aDpqLndpZHRoLGhlaWdodDpqLmhlaWdodH0pLGw/KHA9ITEsZz1mLnJlbmRlcmVyLnJvdENvcnIoayxcbmwpLGc9e3g6ZC54K2MueCtkLndpZHRoLzIrZy54LHk6ZC55K2MueSt7dG9wOjAsbWlkZGxlOjAuNSxib3R0b206MX1bYy52ZXJ0aWNhbEFsaWduXSpkLmhlaWdodH0sYltlP1wiYXR0clwiOlwiYW5pbWF0ZVwiXShnKS5hdHRyKHthbGlnbjptfSksaD0obCs3MjApJTM2MCxoPWg+MTgwJiZoPDM2MCxtPT09XCJsZWZ0XCI/Zy55LT1oP2ouaGVpZ2h0OjA6bT09PVwiY2VudGVyXCI/KGcueC09ai53aWR0aC8yLGcueS09ai5oZWlnaHQvMik6bT09PVwicmlnaHRcIiYmKGcueC09ai53aWR0aCxnLnktPWg/MDpqLmhlaWdodCkpOihiLmFsaWduKGMsbnVsbCxkKSxnPWIuYWxpZ25BdHRyKSxwP3RoaXMuanVzdGlmeURhdGFMYWJlbChiLGMsZyxqLGQsZSk6cShjLmNyb3AsITApJiYobj1mLmlzSW5zaWRlUGxvdChnLngsZy55KSYmZi5pc0luc2lkZVBsb3QoZy54K2oud2lkdGgsZy55K2ouaGVpZ2h0KSksYy5zaGFwZSYmIWwmJmIuYXR0cih7YW5jaG9yWDphLnBsb3RYLGFuY2hvclk6YS5wbG90WX0pO2lmKCFuKVNhKGIpLFxuYi5hdHRyKHt5Oi05OTk5fSksYi5wbGFjZWQ9ITF9O1AucHJvdG90eXBlLmp1c3RpZnlEYXRhTGFiZWw9ZnVuY3Rpb24oYSxiLGMsZCxlLGYpe3ZhciBnPXRoaXMuY2hhcnQsaD1iLmFsaWduLGk9Yi52ZXJ0aWNhbEFsaWduLGosayxsPWEuYm94PzA6YS5wYWRkaW5nfHwwO2o9Yy54K2w7aWYoajwwKWg9PT1cInJpZ2h0XCI/Yi5hbGlnbj1cImxlZnRcIjpiLng9LWosaz0hMDtqPWMueCtkLndpZHRoLWw7aWYoaj5nLnBsb3RXaWR0aCloPT09XCJsZWZ0XCI/Yi5hbGlnbj1cInJpZ2h0XCI6Yi54PWcucGxvdFdpZHRoLWosaz0hMDtqPWMueStsO2lmKGo8MClpPT09XCJib3R0b21cIj9iLnZlcnRpY2FsQWxpZ249XCJ0b3BcIjpiLnk9LWosaz0hMDtqPWMueStkLmhlaWdodC1sO2lmKGo+Zy5wbG90SGVpZ2h0KWk9PT1cInRvcFwiP2IudmVydGljYWxBbGlnbj1cImJvdHRvbVwiOmIueT1nLnBsb3RIZWlnaHQtaixrPSEwO2lmKGspYS5wbGFjZWQ9IWYsYS5hbGlnbihiLG51bGwsZSl9O2lmKEkucGllKUkucGllLnByb3RvdHlwZS5kcmF3RGF0YUxhYmVscz1cbmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEuZGF0YSxjLGQ9YS5jaGFydCxlPWEub3B0aW9ucy5kYXRhTGFiZWxzLGY9cShlLmNvbm5lY3RvclBhZGRpbmcsMTApLGc9cShlLmNvbm5lY3RvcldpZHRoLDEpLGg9ZC5wbG90V2lkdGgsaT1kLnBsb3RIZWlnaHQsaixrLGw9cShlLnNvZnRDb25uZWN0b3IsITApLG09ZS5kaXN0YW5jZSxuPWEuY2VudGVyLHA9blsyXS8yLHI9blsxXSxzPW0+MCxGLHUseCxEPVtbXSxbXV0sdix0LEEsQix6LEM9WzAsMCwwLDBdLEg9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYi55LWEueX07aWYoYS52aXNpYmxlJiYoZS5lbmFibGVkfHxhLl9oYXNQb2ludExhYmVscykpe1AucHJvdG90eXBlLmRyYXdEYXRhTGFiZWxzLmFwcGx5KGEpO28oYixmdW5jdGlvbihhKXtpZihhLmRhdGFMYWJlbCYmYS52aXNpYmxlKURbYS5oYWxmXS5wdXNoKGEpLGEuZGF0YUxhYmVsLl9wb3M9bnVsbH0pO2ZvcihCPTI7Qi0tOyl7dmFyIEU9W10sTD1bXSxLPURbQl0sST1LLmxlbmd0aCxcbko7aWYoSSl7YS5zb3J0QnlBbmdsZShLLEItMC41KTtmb3Ioej1iPTA7IWImJktbel07KWI9S1t6XSYmS1t6XS5kYXRhTGFiZWwmJihLW3pdLmRhdGFMYWJlbC5nZXRCQm94KCkuaGVpZ2h0fHwyMSkseisrO2lmKG0+MCl7dT1HKHIrcCttLGQucGxvdEhlaWdodCk7Zm9yKHo9dygwLHItcC1tKTt6PD11O3orPWIpRS5wdXNoKHopO3U9RS5sZW5ndGg7aWYoST51KXtjPVtdLmNvbmNhdChLKTtjLnNvcnQoSCk7Zm9yKHo9STt6LS07KWNbel0ucmFuaz16O2Zvcih6PUk7ei0tOylLW3pdLnJhbms+PXUmJksuc3BsaWNlKHosMSk7ST1LLmxlbmd0aH1mb3Ioej0wO3o8STt6Kyspe2M9S1t6XTt4PWMubGFiZWxQb3M7Yz05OTk5O3ZhciBOLE07Zm9yKE09MDtNPHU7TSsrKU49UyhFW01dLXhbMV0pLE48YyYmKGM9TixKPU0pO2lmKEo8eiYmRVt6XSE9PW51bGwpSj16O2Vsc2UgZm9yKHU8SS16K0omJkVbel0hPT1udWxsJiYoSj11LUkreik7RVtKXT09PW51bGw7KUorKztMLnB1c2goe2k6Six5OkVbSl19KTtcbkVbSl09bnVsbH1MLnNvcnQoSCl9Zm9yKHo9MDt6PEk7eisrKXtjPUtbel07eD1jLmxhYmVsUG9zO0Y9Yy5kYXRhTGFiZWw7QT1jLnZpc2libGU9PT0hMT9cImhpZGRlblwiOlwiaW5oZXJpdFwiO2M9eFsxXTtpZihtPjApe2lmKHU9TC5wb3AoKSxKPXUuaSx0PXUueSxjPnQmJkVbSisxXSE9PW51bGx8fGM8dCYmRVtKLTFdIT09bnVsbCl0PUcodygwLGMpLGQucGxvdEhlaWdodCl9ZWxzZSB0PWM7dj1lLmp1c3RpZnk/blswXSsoQj8tMToxKSoocCttKTphLmdldFgodD09PXItcC1tfHx0PT09citwK20/Yzp0LEIpO0YuX2F0dHI9e3Zpc2liaWxpdHk6QSxhbGlnbjp4WzZdfTtGLl9wb3M9e3g6ditlLngrKHtsZWZ0OmYscmlnaHQ6LWZ9W3hbNl1dfHwwKSx5OnQrZS55LTEwfTtGLmNvbm5YPXY7Ri5jb25uWT10O2lmKHRoaXMub3B0aW9ucy5zaXplPT09bnVsbCl1PUYud2lkdGgsdi11PGY/Q1szXT13KHkodS12K2YpLENbM10pOnYrdT5oLWYmJihDWzFdPXcoeSh2K3UtaCtmKSxDWzFdKSksdC1cbmIvMjwwP0NbMF09dyh5KC10K2IvMiksQ1swXSk6dCtiLzI+aSYmKENbMl09dyh5KHQrYi8yLWkpLENbMl0pKX19fWlmKERhKEMpPT09MHx8dGhpcy52ZXJpZnlEYXRhTGFiZWxPdmVyZmxvdyhDKSl0aGlzLnBsYWNlRGF0YUxhYmVscygpLHMmJmcmJm8odGhpcy5wb2ludHMsZnVuY3Rpb24oYil7aj1iLmNvbm5lY3Rvcjt4PWIubGFiZWxQb3M7aWYoKEY9Yi5kYXRhTGFiZWwpJiZGLl9wb3MmJmIudmlzaWJsZSlBPUYuX2F0dHIudmlzaWJpbGl0eSx2PUYuY29ublgsdD1GLmNvbm5ZLGs9bD9bXCJNXCIsdisoeFs2XT09PVwibGVmdFwiPzU6LTUpLHQsXCJDXCIsdix0LDIqeFsyXS14WzRdLDIqeFszXS14WzVdLHhbMl0seFszXSxcIkxcIix4WzRdLHhbNV1dOltcIk1cIix2Kyh4WzZdPT09XCJsZWZ0XCI/NTotNSksdCxcIkxcIix4WzJdLHhbM10sXCJMXCIseFs0XSx4WzVdXSxqPyhqLmFuaW1hdGUoe2Q6a30pLGouYXR0cihcInZpc2liaWxpdHlcIixBKSk6Yi5jb25uZWN0b3I9aj1hLmNoYXJ0LnJlbmRlcmVyLnBhdGgoaykuYXR0cih7XCJzdHJva2Utd2lkdGhcIjpnLFxuc3Ryb2tlOmUuY29ubmVjdG9yQ29sb3J8fGIuY29sb3J8fFwiIzYwNjA2MFwiLHZpc2liaWxpdHk6QX0pLmFkZChhLmRhdGFMYWJlbHNHcm91cCk7ZWxzZSBpZihqKWIuY29ubmVjdG9yPWouZGVzdHJveSgpfSl9fSxJLnBpZS5wcm90b3R5cGUucGxhY2VEYXRhTGFiZWxzPWZ1bmN0aW9uKCl7byh0aGlzLnBvaW50cyxmdW5jdGlvbihhKXt2YXIgYj1hLmRhdGFMYWJlbDtpZihiJiZhLnZpc2libGUpKGE9Yi5fcG9zKT8oYi5hdHRyKGIuX2F0dHIpLGJbYi5tb3ZlZD9cImFuaW1hdGVcIjpcImF0dHJcIl0oYSksYi5tb3ZlZD0hMCk6YiYmYi5hdHRyKHt5Oi05OTk5fSl9KX0sSS5waWUucHJvdG90eXBlLmFsaWduRGF0YUxhYmVsPXJhLEkucGllLnByb3RvdHlwZS52ZXJpZnlEYXRhTGFiZWxPdmVyZmxvdz1mdW5jdGlvbihhKXt2YXIgYj10aGlzLmNlbnRlcixjPXRoaXMub3B0aW9ucyxkPWMuY2VudGVyLGU9Yy5taW5TaXplfHw4MCxmPWUsZztkWzBdIT09bnVsbD9mPXcoYlsyXS13KGFbMV0sYVszXSksXG5lKTooZj13KGJbMl0tYVsxXS1hWzNdLGUpLGJbMF0rPShhWzNdLWFbMV0pLzIpO2RbMV0hPT1udWxsP2Y9dyhHKGYsYlsyXS13KGFbMF0sYVsyXSkpLGUpOihmPXcoRyhmLGJbMl0tYVswXS1hWzJdKSxlKSxiWzFdKz0oYVswXS1hWzJdKS8yKTtmPGJbMl0/KGJbMl09ZixiWzNdPU1hdGgubWluKC8lJC8udGVzdChjLmlubmVyU2l6ZXx8MCk/ZipwYXJzZUZsb2F0KGMuaW5uZXJTaXplfHwwKS8xMDA6cGFyc2VGbG9hdChjLmlubmVyU2l6ZXx8MCksZiksdGhpcy50cmFuc2xhdGUoYiksdGhpcy5kcmF3RGF0YUxhYmVscyYmdGhpcy5kcmF3RGF0YUxhYmVscygpKTpnPSEwO3JldHVybiBnfTtpZihJLmNvbHVtbilJLmNvbHVtbi5wcm90b3R5cGUuYWxpZ25EYXRhTGFiZWw9ZnVuY3Rpb24oYSxiLGMsZCxlKXt2YXIgZj10aGlzLmNoYXJ0LmludmVydGVkLGc9YS5zZXJpZXMsaD1hLmRsQm94fHxhLnNoYXBlQXJncyxpPXEoYS5iZWxvdyxhLnBsb3RZPnEodGhpcy50cmFuc2xhdGVkVGhyZXNob2xkLFxuZy55QXhpcy5sZW4pKSxqPXEoYy5pbnNpZGUsISF0aGlzLm9wdGlvbnMuc3RhY2tpbmcpO2lmKGgpe2Q9eihoKTtpZihkLnk8MClkLmhlaWdodCs9ZC55LGQueT0wO2g9ZC55K2QuaGVpZ2h0LWcueUF4aXMubGVuO2g+MCYmKGQuaGVpZ2h0LT1oKTtmJiYoZD17eDpnLnlBeGlzLmxlbi1kLnktZC5oZWlnaHQseTpnLnhBeGlzLmxlbi1kLngtZC53aWR0aCx3aWR0aDpkLmhlaWdodCxoZWlnaHQ6ZC53aWR0aH0pO2lmKCFqKWY/KGQueCs9aT8wOmQud2lkdGgsZC53aWR0aD0wKTooZC55Kz1pP2QuaGVpZ2h0OjAsZC5oZWlnaHQ9MCl9Yy5hbGlnbj1xKGMuYWxpZ24sIWZ8fGo/XCJjZW50ZXJcIjppP1wicmlnaHRcIjpcImxlZnRcIik7Yy52ZXJ0aWNhbEFsaWduPXEoYy52ZXJ0aWNhbEFsaWduLGZ8fGo/XCJtaWRkbGVcIjppP1widG9wXCI6XCJib3R0b21cIik7UC5wcm90b3R5cGUuYWxpZ25EYXRhTGFiZWwuY2FsbCh0aGlzLGEsYixjLGQsZSl9OyhmdW5jdGlvbihhKXt2YXIgYj1hLkNoYXJ0LGM9YS5lYWNoLFxuZD1hLnBpY2ssZT1hLmFkZEV2ZW50O2IucHJvdG90eXBlLmNhbGxiYWNrcy5wdXNoKGZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoKXt2YXIgZT1bXTtjKGEuc2VyaWVzLGZ1bmN0aW9uKGEpe3ZhciBiPWEub3B0aW9ucy5kYXRhTGFiZWxzLGY9YS5kYXRhTGFiZWxDb2xsZWN0aW9uc3x8W1wiZGF0YUxhYmVsXCJdOyhiLmVuYWJsZWR8fGEuX2hhc1BvaW50TGFiZWxzKSYmIWIuYWxsb3dPdmVybGFwJiZhLnZpc2libGUmJmMoZixmdW5jdGlvbihiKXtjKGEucG9pbnRzLGZ1bmN0aW9uKGEpe2lmKGFbYl0pYVtiXS5sYWJlbHJhbms9ZChhLmxhYmVscmFuayxhLnNoYXBlQXJncyYmYS5zaGFwZUFyZ3MuaGVpZ2h0KSxlLnB1c2goYVtiXSl9KX0pfSk7YS5oaWRlT3ZlcmxhcHBpbmdMYWJlbHMoZSl9YigpO2UoYSxcInJlZHJhd1wiLGIpfSk7Yi5wcm90b3R5cGUuaGlkZU92ZXJsYXBwaW5nTGFiZWxzPWZ1bmN0aW9uKGEpe3ZhciBiPWEubGVuZ3RoLGQsZSxqLGssbCxtLG4scCxyO2ZvcihlPTA7ZTxiO2UrKylpZihkPVxuYVtlXSlkLm9sZE9wYWNpdHk9ZC5vcGFjaXR5LGQubmV3T3BhY2l0eT0xO2Euc29ydChmdW5jdGlvbihhLGIpe3JldHVybihiLmxhYmVscmFua3x8MCktKGEubGFiZWxyYW5rfHwwKX0pO2ZvcihlPTA7ZTxiO2UrKyl7aj1hW2VdO2ZvcihkPWUrMTtkPGI7KytkKWlmKGs9YVtkXSxqJiZrJiZqLnBsYWNlZCYmay5wbGFjZWQmJmoubmV3T3BhY2l0eSE9PTAmJmsubmV3T3BhY2l0eSE9PTAmJihsPWouYWxpZ25BdHRyLG09ay5hbGlnbkF0dHIsbj1qLnBhcmVudEdyb3VwLHA9ay5wYXJlbnRHcm91cCxyPTIqKGouYm94PzA6ai5wYWRkaW5nKSxsPSEobS54K3AudHJhbnNsYXRlWD5sLngrbi50cmFuc2xhdGVYKyhqLndpZHRoLXIpfHxtLngrcC50cmFuc2xhdGVYKyhrLndpZHRoLXIpPGwueCtuLnRyYW5zbGF0ZVh8fG0ueStwLnRyYW5zbGF0ZVk+bC55K24udHJhbnNsYXRlWSsoai5oZWlnaHQtcil8fG0ueStwLnRyYW5zbGF0ZVkrKGsuaGVpZ2h0LXIpPGwueStuLnRyYW5zbGF0ZVkpKSkoai5sYWJlbHJhbms8XG5rLmxhYmVscmFuaz9qOmspLm5ld09wYWNpdHk9MH1jKGEsZnVuY3Rpb24oYSl7dmFyIGIsYztpZihhKXtjPWEubmV3T3BhY2l0eTtpZihhLm9sZE9wYWNpdHkhPT1jJiZhLnBsYWNlZCljP2Euc2hvdyghMCk6Yj1mdW5jdGlvbigpe2EuaGlkZSgpfSxhLmFsaWduQXR0ci5vcGFjaXR5PWMsYVthLmlzT2xkP1wiYW5pbWF0ZVwiOlwiYXR0clwiXShhLmFsaWduQXR0cixudWxsLGIpO2EuaXNPbGQ9ITB9fSl9fSkoQik7dmFyIG1iPUIuVHJhY2tlck1peGluPXtkcmF3VHJhY2tlclBvaW50OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEuY2hhcnQsYz1iLnBvaW50ZXIsZD1hLm9wdGlvbnMuY3Vyc29yLGU9ZCYme2N1cnNvcjpkfSxmPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYz1hLnRhcmdldCxkO2MmJiFkOylkPWMucG9pbnQsYz1jLnBhcmVudE5vZGU7aWYoZCE9PXQmJmQhPT1iLmhvdmVyUG9pbnQpZC5vbk1vdXNlT3ZlcihhKX07byhhLnBvaW50cyxmdW5jdGlvbihhKXtpZihhLmdyYXBoaWMpYS5ncmFwaGljLmVsZW1lbnQucG9pbnQ9XG5hO2lmKGEuZGF0YUxhYmVsKWEuZGF0YUxhYmVsLmVsZW1lbnQucG9pbnQ9YX0pO2lmKCFhLl9oYXNUcmFja2luZylvKGEudHJhY2tlckdyb3VwcyxmdW5jdGlvbihiKXtpZihhW2JdJiYoYVtiXS5hZGRDbGFzcyhcImhpZ2hjaGFydHMtdHJhY2tlclwiKS5vbihcIm1vdXNlb3ZlclwiLGYpLm9uKFwibW91c2VvdXRcIixmdW5jdGlvbihhKXtjLm9uVHJhY2tlck1vdXNlT3V0KGEpfSkuY3NzKGUpLGNiKSlhW2JdLm9uKFwidG91Y2hzdGFydFwiLGYpfSksYS5faGFzVHJhY2tpbmc9ITB9LGRyYXdUcmFja2VyR3JhcGg6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5vcHRpb25zLGM9Yi50cmFja0J5QXJlYSxkPVtdLmNvbmNhdChjP2EuYXJlYVBhdGg6YS5ncmFwaFBhdGgpLGU9ZC5sZW5ndGgsZj1hLmNoYXJ0LGc9Zi5wb2ludGVyLGg9Zi5yZW5kZXJlcixpPWYub3B0aW9ucy50b29sdGlwLnNuYXAsaj1hLnRyYWNrZXIsaz1iLmN1cnNvcixsPWsmJntjdXJzb3I6a30sbT1mdW5jdGlvbigpe2lmKGYuaG92ZXJTZXJpZXMhPT1cbmEpYS5vbk1vdXNlT3ZlcigpfSxuPVwicmdiYSgxOTIsMTkyLDE5MixcIisoamE/MS4wRS00OjAuMDAyKStcIilcIjtpZihlJiYhYylmb3Ioaz1lKzE7ay0tOylkW2tdPT09XCJNXCImJmQuc3BsaWNlKGsrMSwwLGRbaysxXS1pLGRbaysyXSxcIkxcIiksKGsmJmRba109PT1cIk1cInx8az09PWUpJiZkLnNwbGljZShrLDAsXCJMXCIsZFtrLTJdK2ksZFtrLTFdKTtqP2ouYXR0cih7ZDpkfSk6KGEudHJhY2tlcj1oLnBhdGgoZCkuYXR0cih7XCJzdHJva2UtbGluZWpvaW5cIjpcInJvdW5kXCIsdmlzaWJpbGl0eTphLnZpc2libGU/XCJ2aXNpYmxlXCI6XCJoaWRkZW5cIixzdHJva2U6bixmaWxsOmM/bjpcIm5vbmVcIixcInN0cm9rZS13aWR0aFwiOmIubGluZVdpZHRoKyhjPzA6MippKSx6SW5kZXg6Mn0pLmFkZChhLmdyb3VwKSxvKFthLnRyYWNrZXIsYS5tYXJrZXJHcm91cF0sZnVuY3Rpb24oYSl7YS5hZGRDbGFzcyhcImhpZ2hjaGFydHMtdHJhY2tlclwiKS5vbihcIm1vdXNlb3ZlclwiLG0pLm9uKFwibW91c2VvdXRcIixmdW5jdGlvbihhKXtnLm9uVHJhY2tlck1vdXNlT3V0KGEpfSkuY3NzKGwpO1xuaWYoY2IpYS5vbihcInRvdWNoc3RhcnRcIixtKX0pKX19O2lmKEkuY29sdW1uKUlhLnByb3RvdHlwZS5kcmF3VHJhY2tlcj1tYi5kcmF3VHJhY2tlclBvaW50O2lmKEkucGllKUkucGllLnByb3RvdHlwZS5kcmF3VHJhY2tlcj1tYi5kcmF3VHJhY2tlclBvaW50O2lmKEkuc2NhdHRlcil5YS5wcm90b3R5cGUuZHJhd1RyYWNrZXI9bWIuZHJhd1RyYWNrZXJQb2ludDtBKHViLnByb3RvdHlwZSx7c2V0SXRlbUV2ZW50czpmdW5jdGlvbihhLGIsYyxkLGUpe3ZhciBmPXRoaXM7KGM/YjphLmxlZ2VuZEdyb3VwKS5vbihcIm1vdXNlb3ZlclwiLGZ1bmN0aW9uKCl7YS5zZXRTdGF0ZShcImhvdmVyXCIpO2IuY3NzKGYub3B0aW9ucy5pdGVtSG92ZXJTdHlsZSl9KS5vbihcIm1vdXNlb3V0XCIsZnVuY3Rpb24oKXtiLmNzcyhhLnZpc2libGU/ZDplKTthLnNldFN0YXRlKCl9KS5vbihcImNsaWNrXCIsZnVuY3Rpb24oYil7dmFyIGM9ZnVuY3Rpb24oKXthLnNldFZpc2libGUmJmEuc2V0VmlzaWJsZSgpfSxiPXticm93c2VyRXZlbnQ6Yn07XG5hLmZpcmVQb2ludEV2ZW50P2EuZmlyZVBvaW50RXZlbnQoXCJsZWdlbmRJdGVtQ2xpY2tcIixiLGMpOk8oYSxcImxlZ2VuZEl0ZW1DbGlja1wiLGIsYyl9KX0sY3JlYXRlQ2hlY2tib3hGb3JJdGVtOmZ1bmN0aW9uKGEpe2EuY2hlY2tib3g9ZmEoXCJpbnB1dFwiLHt0eXBlOlwiY2hlY2tib3hcIixjaGVja2VkOmEuc2VsZWN0ZWQsZGVmYXVsdENoZWNrZWQ6YS5zZWxlY3RlZH0sdGhpcy5vcHRpb25zLml0ZW1DaGVja2JveFN0eWxlLHRoaXMuY2hhcnQuY29udGFpbmVyKTtFKGEuY2hlY2tib3gsXCJjbGlja1wiLGZ1bmN0aW9uKGIpe08oYS5zZXJpZXN8fGEsXCJjaGVja2JveENsaWNrXCIse2NoZWNrZWQ6Yi50YXJnZXQuY2hlY2tlZCxpdGVtOmF9LGZ1bmN0aW9uKCl7YS5zZWxlY3QoKX0pfSl9fSk7Ui5sZWdlbmQuaXRlbVN0eWxlLmN1cnNvcj1cInBvaW50ZXJcIjtBKEJhLnByb3RvdHlwZSx7c2hvd1Jlc2V0Wm9vbTpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1SLmxhbmcsYz1hLm9wdGlvbnMuY2hhcnQucmVzZXRab29tQnV0dG9uLFxuZD1jLnRoZW1lLGU9ZC5zdGF0ZXMsZj1jLnJlbGF0aXZlVG89PT1cImNoYXJ0XCI/bnVsbDpcInBsb3RCb3hcIjt0aGlzLnJlc2V0Wm9vbUJ1dHRvbj1hLnJlbmRlcmVyLmJ1dHRvbihiLnJlc2V0Wm9vbSxudWxsLG51bGwsZnVuY3Rpb24oKXthLnpvb21PdXQoKX0sZCxlJiZlLmhvdmVyKS5hdHRyKHthbGlnbjpjLnBvc2l0aW9uLmFsaWduLHRpdGxlOmIucmVzZXRab29tVGl0bGV9KS5hZGQoKS5hbGlnbihjLnBvc2l0aW9uLCExLGYpfSx6b29tT3V0OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcztPKGEsXCJzZWxlY3Rpb25cIix7cmVzZXRTZWxlY3Rpb246ITB9LGZ1bmN0aW9uKCl7YS56b29tKCl9KX0sem9vbTpmdW5jdGlvbihhKXt2YXIgYixjPXRoaXMucG9pbnRlcixkPSExLGU7IWF8fGEucmVzZXRTZWxlY3Rpb24/byh0aGlzLmF4ZXMsZnVuY3Rpb24oYSl7Yj1hLnpvb20oKX0pOm8oYS54QXhpcy5jb25jYXQoYS55QXhpcyksZnVuY3Rpb24oYSl7dmFyIGU9YS5heGlzLGg9ZS5pc1hBeGlzO2lmKGNbaD9cblwiem9vbVhcIjpcInpvb21ZXCJdfHxjW2g/XCJwaW5jaFhcIjpcInBpbmNoWVwiXSliPWUuem9vbShhLm1pbixhLm1heCksZS5kaXNwbGF5QnRuJiYoZD0hMCl9KTtlPXRoaXMucmVzZXRab29tQnV0dG9uO2lmKGQmJiFlKXRoaXMuc2hvd1Jlc2V0Wm9vbSgpO2Vsc2UgaWYoIWQmJmVhKGUpKXRoaXMucmVzZXRab29tQnV0dG9uPWUuZGVzdHJveSgpO2ImJnRoaXMucmVkcmF3KHEodGhpcy5vcHRpb25zLmNoYXJ0LmFuaW1hdGlvbixhJiZhLmFuaW1hdGlvbix0aGlzLnBvaW50Q291bnQ8MTAwKSl9LHBhbjpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMsZD1jLmhvdmVyUG9pbnRzLGU7ZCYmbyhkLGZ1bmN0aW9uKGEpe2Euc2V0U3RhdGUoKX0pO28oYj09PVwieHlcIj9bMSwwXTpbMV0sZnVuY3Rpb24oYil7dmFyIGI9Y1tiP1wieEF4aXNcIjpcInlBeGlzXCJdWzBdLGQ9Yi5ob3JpeixoPWFbZD9cImNoYXJ0WFwiOlwiY2hhcnRZXCJdLGQ9ZD9cIm1vdXNlRG93blhcIjpcIm1vdXNlRG93bllcIixpPWNbZF0saj0oYi5wb2ludFJhbmdlfHxcbjApLzIsaz1iLmdldEV4dHJlbWVzKCksbD1iLnRvVmFsdWUoaS1oLCEwKStqLGo9Yi50b1ZhbHVlKGkrYi5sZW4taCwhMCktaixpPWk+aDtpZihiLnNlcmllcy5sZW5ndGgmJihpfHxsPkcoay5kYXRhTWluLGsubWluKSkmJighaXx8ajx3KGsuZGF0YU1heCxrLm1heCkpKWIuc2V0RXh0cmVtZXMobCxqLCExLCExLHt0cmlnZ2VyOlwicGFuXCJ9KSxlPSEwO2NbZF09aH0pO2UmJmMucmVkcmF3KCExKTtOKGMuY29udGFpbmVyLHtjdXJzb3I6XCJtb3ZlXCJ9KX19KTtBKEhhLnByb3RvdHlwZSx7c2VsZWN0OmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcyxkPWMuc2VyaWVzLGU9ZC5jaGFydCxhPXEoYSwhYy5zZWxlY3RlZCk7Yy5maXJlUG9pbnRFdmVudChhP1wic2VsZWN0XCI6XCJ1bnNlbGVjdFwiLHthY2N1bXVsYXRlOmJ9LGZ1bmN0aW9uKCl7Yy5zZWxlY3RlZD1jLm9wdGlvbnMuc2VsZWN0ZWQ9YTtkLm9wdGlvbnMuZGF0YVtzYShjLGQuZGF0YSldPWMub3B0aW9ucztjLnNldFN0YXRlKGEmJlwic2VsZWN0XCIpO1xuYnx8byhlLmdldFNlbGVjdGVkUG9pbnRzKCksZnVuY3Rpb24oYSl7aWYoYS5zZWxlY3RlZCYmYSE9PWMpYS5zZWxlY3RlZD1hLm9wdGlvbnMuc2VsZWN0ZWQ9ITEsZC5vcHRpb25zLmRhdGFbc2EoYSxkLmRhdGEpXT1hLm9wdGlvbnMsYS5zZXRTdGF0ZShcIlwiKSxhLmZpcmVQb2ludEV2ZW50KFwidW5zZWxlY3RcIil9KX0pfSxvbk1vdXNlT3ZlcjpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuc2VyaWVzLGQ9Yy5jaGFydCxlPWQudG9vbHRpcCxmPWQuaG92ZXJQb2ludDtpZihkLmhvdmVyU2VyaWVzIT09YyljLm9uTW91c2VPdmVyKCk7aWYoZiYmZiE9PXRoaXMpZi5vbk1vdXNlT3V0KCk7aWYodGhpcy5zZXJpZXMmJih0aGlzLmZpcmVQb2ludEV2ZW50KFwibW91c2VPdmVyXCIpLGUmJighZS5zaGFyZWR8fGMubm9TaGFyZWRUb29sdGlwKSYmZS5yZWZyZXNoKHRoaXMsYSksdGhpcy5zZXRTdGF0ZShcImhvdmVyXCIpLCFiKSlkLmhvdmVyUG9pbnQ9dGhpc30sb25Nb3VzZU91dDpmdW5jdGlvbigpe3ZhciBhPVxudGhpcy5zZXJpZXMuY2hhcnQsYj1hLmhvdmVyUG9pbnRzO3RoaXMuZmlyZVBvaW50RXZlbnQoXCJtb3VzZU91dFwiKTtpZighYnx8c2EodGhpcyxiKT09PS0xKXRoaXMuc2V0U3RhdGUoKSxhLmhvdmVyUG9pbnQ9bnVsbH0saW1wb3J0RXZlbnRzOmZ1bmN0aW9uKCl7aWYoIXRoaXMuaGFzSW1wb3J0ZWRFdmVudHMpe3ZhciBhPXoodGhpcy5zZXJpZXMub3B0aW9ucy5wb2ludCx0aGlzLm9wdGlvbnMpLmV2ZW50cyxiO3RoaXMuZXZlbnRzPWE7Zm9yKGIgaW4gYSlFKHRoaXMsYixhW2JdKTt0aGlzLmhhc0ltcG9ydGVkRXZlbnRzPSEwfX0sc2V0U3RhdGU6ZnVuY3Rpb24oYSxiKXt2YXIgYz1WKHRoaXMucGxvdFgpLGQ9dGhpcy5wbG90WSxlPXRoaXMuc2VyaWVzLGY9ZS5vcHRpb25zLnN0YXRlcyxnPVdbZS50eXBlXS5tYXJrZXImJmUub3B0aW9ucy5tYXJrZXIsaD1nJiYhZy5lbmFibGVkLGk9ZyYmZy5zdGF0ZXNbYV0saj1pJiZpLmVuYWJsZWQ9PT0hMSxrPWUuc3RhdGVNYXJrZXJHcmFwaGljLFxubD10aGlzLm1hcmtlcnx8e30sbT1lLmNoYXJ0LG49ZS5oYWxvLHAsYT1hfHxcIlwiO3A9dGhpcy5wb2ludEF0dHJbYV18fGUucG9pbnRBdHRyW2FdO2lmKCEoYT09PXRoaXMuc3RhdGUmJiFifHx0aGlzLnNlbGVjdGVkJiZhIT09XCJzZWxlY3RcInx8ZlthXSYmZlthXS5lbmFibGVkPT09ITF8fGEmJihqfHxoJiZpLmVuYWJsZWQ9PT0hMSl8fGEmJmwuc3RhdGVzJiZsLnN0YXRlc1thXSYmbC5zdGF0ZXNbYV0uZW5hYmxlZD09PSExKSl7aWYodGhpcy5ncmFwaGljKWc9ZyYmdGhpcy5ncmFwaGljLnN5bWJvbE5hbWUmJnAucix0aGlzLmdyYXBoaWMuYXR0cih6KHAsZz97eDpjLWcseTpkLWcsd2lkdGg6MipnLGhlaWdodDoyKmd9Ont9KSksayYmay5oaWRlKCk7ZWxzZXtpZihhJiZpKWlmKGc9aS5yYWRpdXMsbD1sLnN5bWJvbHx8ZS5zeW1ib2wsayYmay5jdXJyZW50U3ltYm9sIT09bCYmKGs9ay5kZXN0cm95KCkpLGspa1tiP1wiYW5pbWF0ZVwiOlwiYXR0clwiXSh7eDpjLWcseTpkLWd9KTtlbHNlIGlmKGwpZS5zdGF0ZU1hcmtlckdyYXBoaWM9XG5rPW0ucmVuZGVyZXIuc3ltYm9sKGwsYy1nLGQtZywyKmcsMipnKS5hdHRyKHApLmFkZChlLm1hcmtlckdyb3VwKSxrLmN1cnJlbnRTeW1ib2w9bDtpZihrKWtbYSYmbS5pc0luc2lkZVBsb3QoYyxkLG0uaW52ZXJ0ZWQpP1wic2hvd1wiOlwiaGlkZVwiXSgpLGsuZWxlbWVudC5wb2ludD10aGlzfWlmKChjPWZbYV0mJmZbYV0uaGFsbykmJmMuc2l6ZSl7aWYoIW4pZS5oYWxvPW49bS5yZW5kZXJlci5wYXRoKCkuYWRkKG0uc2VyaWVzR3JvdXApO24uYXR0cihBKHtmaWxsOnRoaXMuY29sb3J8fGUuY29sb3IsXCJmaWxsLW9wYWNpdHlcIjpjLm9wYWNpdHksekluZGV4Oi0xfSxjLmF0dHJpYnV0ZXMpKVtiP1wiYW5pbWF0ZVwiOlwiYXR0clwiXSh7ZDp0aGlzLmhhbG9QYXRoKGMuc2l6ZSl9KX1lbHNlIG4mJm4uYXR0cih7ZDpbXX0pO3RoaXMuc3RhdGU9YX19LGhhbG9QYXRoOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuc2VyaWVzLGM9Yi5jaGFydCxkPWIuZ2V0UGxvdEJveCgpLGU9Yy5pbnZlcnRlZCxmPU1hdGguZmxvb3IodGhpcy5wbG90WCk7XG5yZXR1cm4gYy5yZW5kZXJlci5zeW1ib2xzLmNpcmNsZShkLnRyYW5zbGF0ZVgrKGU/Yi55QXhpcy5sZW4tdGhpcy5wbG90WTpmKS1hLGQudHJhbnNsYXRlWSsoZT9iLnhBeGlzLmxlbi1mOnRoaXMucGxvdFkpLWEsYSoyLGEqMil9fSk7QShQLnByb3RvdHlwZSx7b25Nb3VzZU92ZXI6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmNoYXJ0LGI9YS5ob3ZlclNlcmllcztpZihiJiZiIT09dGhpcyliLm9uTW91c2VPdXQoKTt0aGlzLm9wdGlvbnMuZXZlbnRzLm1vdXNlT3ZlciYmTyh0aGlzLFwibW91c2VPdmVyXCIpO3RoaXMuc2V0U3RhdGUoXCJob3ZlclwiKTthLmhvdmVyU2VyaWVzPXRoaXN9LG9uTW91c2VPdXQ6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9wdGlvbnMsYj10aGlzLmNoYXJ0LGM9Yi50b29sdGlwLGQ9Yi5ob3ZlclBvaW50O2IuaG92ZXJTZXJpZXM9bnVsbDtpZihkKWQub25Nb3VzZU91dCgpO3RoaXMmJmEuZXZlbnRzLm1vdXNlT3V0JiZPKHRoaXMsXCJtb3VzZU91dFwiKTtjJiYhYS5zdGlja3lUcmFja2luZyYmXG4oIWMuc2hhcmVkfHx0aGlzLm5vU2hhcmVkVG9vbHRpcCkmJmMuaGlkZSgpO3RoaXMuc2V0U3RhdGUoKX0sc2V0U3RhdGU6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5vcHRpb25zLGM9dGhpcy5ncmFwaCxkPWIuc3RhdGVzLGU9Yi5saW5lV2lkdGgsYj0wLGE9YXx8XCJcIjtpZih0aGlzLnN0YXRlIT09YSYmKHRoaXMuc3RhdGU9YSwhKGRbYV0mJmRbYV0uZW5hYmxlZD09PSExKSYmKGEmJihlPWRbYV0ubGluZVdpZHRofHxlKyhkW2FdLmxpbmVXaWR0aFBsdXN8fDApKSxjJiYhYy5kYXNoc3R5bGUpKSl7YT17XCJzdHJva2Utd2lkdGhcIjplfTtmb3IoYy5hdHRyKGEpO3RoaXNbXCJ6b25lR3JhcGhcIitiXTspdGhpc1tcInpvbmVHcmFwaFwiK2JdLmF0dHIoYSksYis9MX19LHNldFZpc2libGU6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLGQ9Yy5jaGFydCxlPWMubGVnZW5kSXRlbSxmLGc9ZC5vcHRpb25zLmNoYXJ0Lmlnbm9yZUhpZGRlblNlcmllcyxoPWMudmlzaWJsZTtmPShjLnZpc2libGU9YT1jLnVzZXJPcHRpb25zLnZpc2libGU9XG5hPT09dD8haDphKT9cInNob3dcIjpcImhpZGVcIjtvKFtcImdyb3VwXCIsXCJkYXRhTGFiZWxzR3JvdXBcIixcIm1hcmtlckdyb3VwXCIsXCJ0cmFja2VyXCJdLGZ1bmN0aW9uKGEpe2lmKGNbYV0pY1thXVtmXSgpfSk7aWYoZC5ob3ZlclNlcmllcz09PWN8fChkLmhvdmVyUG9pbnQmJmQuaG92ZXJQb2ludC5zZXJpZXMpPT09YyljLm9uTW91c2VPdXQoKTtlJiZkLmxlZ2VuZC5jb2xvcml6ZUl0ZW0oYyxhKTtjLmlzRGlydHk9ITA7Yy5vcHRpb25zLnN0YWNraW5nJiZvKGQuc2VyaWVzLGZ1bmN0aW9uKGEpe2lmKGEub3B0aW9ucy5zdGFja2luZyYmYS52aXNpYmxlKWEuaXNEaXJ0eT0hMH0pO28oYy5saW5rZWRTZXJpZXMsZnVuY3Rpb24oYil7Yi5zZXRWaXNpYmxlKGEsITEpfSk7aWYoZylkLmlzRGlydHlCb3g9ITA7YiE9PSExJiZkLnJlZHJhdygpO08oYyxmKX0sc2hvdzpmdW5jdGlvbigpe3RoaXMuc2V0VmlzaWJsZSghMCl9LGhpZGU6ZnVuY3Rpb24oKXt0aGlzLnNldFZpc2libGUoITEpfSxzZWxlY3Q6ZnVuY3Rpb24oYSl7dGhpcy5zZWxlY3RlZD1cbmE9YT09PXQ/IXRoaXMuc2VsZWN0ZWQ6YTtpZih0aGlzLmNoZWNrYm94KXRoaXMuY2hlY2tib3guY2hlY2tlZD1hO08odGhpcyxhP1wic2VsZWN0XCI6XCJ1bnNlbGVjdFwiKX0sZHJhd1RyYWNrZXI6bWIuZHJhd1RyYWNrZXJHcmFwaH0pO1UoUC5wcm90b3R5cGUsXCJpbml0XCIsZnVuY3Rpb24oYSl7dmFyIGI7YS5hcHBseSh0aGlzLEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSk7KGI9dGhpcy54QXhpcykmJmIub3B0aW9ucy5vcmRpbmFsJiZFKHRoaXMsXCJ1cGRhdGVkRGF0YVwiLGZ1bmN0aW9uKCl7ZGVsZXRlIGIub3JkaW5hbEluZGV4fSl9KTtVKEoucHJvdG90eXBlLFwiZ2V0VGltZVRpY2tzXCIsZnVuY3Rpb24oYSxiLGMsZCxlLGYsZyxoKXt2YXIgaT0wLGosayxsPXt9LG0sbixwLG89W10scT0tTnVtYmVyLk1BWF9WQUxVRSxGPXRoaXMub3B0aW9ucy50aWNrUGl4ZWxJbnRlcnZhbDtpZighdGhpcy5vcHRpb25zLm9yZGluYWwmJiF0aGlzLm9wdGlvbnMuYnJlYWtzfHxcbiFmfHxmLmxlbmd0aDwzfHxjPT09dClyZXR1cm4gYS5jYWxsKHRoaXMsYixjLGQsZSk7bj1mLmxlbmd0aDtmb3Ioaj0wO2o8bjtqKyspe3A9aiYmZltqLTFdPmQ7ZltqXTxjJiYoaT1qKTtpZihqPT09bi0xfHxmW2orMV0tZltqXT5nKjV8fHApe2lmKGZbal0+cSl7Zm9yKGs9YS5jYWxsKHRoaXMsYixmW2ldLGZbal0sZSk7ay5sZW5ndGgmJmtbMF08PXE7KWsuc2hpZnQoKTtrLmxlbmd0aCYmKHE9a1trLmxlbmd0aC0xXSk7bz1vLmNvbmNhdChrKX1pPWorMX1pZihwKWJyZWFrfWE9ay5pbmZvO2lmKGgmJmEudW5pdFJhbmdlPD1NLmhvdXIpe2o9by5sZW5ndGgtMTtmb3IoaT0xO2k8ajtpKyspbmEoXCIlZFwiLG9baV0pIT09bmEoXCIlZFwiLG9baS0xXSkmJihsW29baV1dPVwiZGF5XCIsbT0hMCk7bSYmKGxbb1swXV09XCJkYXlcIik7YS5oaWdoZXJSYW5rcz1sfW8uaW5mbz1hO2lmKGgmJnYoRikpe2g9YT1vLmxlbmd0aDtqPVtdO3ZhciB1O2ZvcihtPVtdO2gtLTspaT10aGlzLnRyYW5zbGF0ZShvW2hdKSxcbnUmJihtW2hdPXUtaSksaltoXT11PWk7bS5zb3J0KCk7bT1tW1YobS5sZW5ndGgvMildO208RiowLjYmJihtPW51bGwpO2g9b1thLTFdPmQ/YS0xOmE7Zm9yKHU9dm9pZCAwO2gtLTspaT1qW2hdLGQ9dS1pLHUmJmQ8RiowLjgmJihtPT09bnVsbHx8ZDxtKjAuOCk/KGxbb1toXV0mJiFsW29baCsxXV0/KGQ9aCsxLHU9aSk6ZD1oLG8uc3BsaWNlKGQsMSkpOnU9aX1yZXR1cm4gb30pO0EoSi5wcm90b3R5cGUse2JlZm9yZVNldFRpY2tQb3NpdGlvbnM6ZnVuY3Rpb24oKXt2YXIgYSxiPVtdLGM9ITEsZCxlPXRoaXMuZ2V0RXh0cmVtZXMoKSxmPWUubWluLGc9ZS5tYXgsaCxpPXRoaXMuaXNYQXhpcyYmISF0aGlzLm9wdGlvbnMuYnJlYWtzO2lmKChlPXRoaXMub3B0aW9ucy5vcmRpbmFsKXx8aSl7byh0aGlzLnNlcmllcyxmdW5jdGlvbihjLGQpe2lmKGMudmlzaWJsZSE9PSExJiYoYy50YWtlT3JkaW5hbFBvc2l0aW9uIT09ITF8fGkpKWlmKGI9Yi5jb25jYXQoYy5wcm9jZXNzZWRYRGF0YSksXG5hPWIubGVuZ3RoLGIuc29ydChmdW5jdGlvbihhLGIpe3JldHVybiBhLWJ9KSxhKWZvcihkPWEtMTtkLS07KWJbZF09PT1iW2QrMV0mJmIuc3BsaWNlKGQsMSl9KTthPWIubGVuZ3RoO2lmKGE+Mil7ZD1iWzFdLWJbMF07Zm9yKGg9YS0xO2gtLSYmIWM7KWJbaCsxXS1iW2hdIT09ZCYmKGM9ITApO2lmKCF0aGlzLm9wdGlvbnMua2VlcE9yZGluYWxQYWRkaW5nJiYoYlswXS1mPmR8fGctYltiLmxlbmd0aC0xXT5kKSljPSEwfWM/KHRoaXMub3JkaW5hbFBvc2l0aW9ucz1iLGQ9dGhpcy52YWwybGluKHcoZixiWzBdKSwhMCksaD13KHRoaXMudmFsMmxpbihHKGcsYltiLmxlbmd0aC0xXSksITApLDEpLHRoaXMub3JkaW5hbFNsb3BlPWc9KGctZikvKGgtZCksdGhpcy5vcmRpbmFsT2Zmc2V0PWYtZCpnKTp0aGlzLm9yZGluYWxQb3NpdGlvbnM9dGhpcy5vcmRpbmFsU2xvcGU9dGhpcy5vcmRpbmFsT2Zmc2V0PXR9dGhpcy5pc09yZGluYWw9ZSYmYzt0aGlzLmdyb3VwSW50ZXJ2YWxGYWN0b3I9XG5udWxsfSx2YWwybGluOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5vcmRpbmFsUG9zaXRpb25zLGQ7aWYoYyl7dmFyIGU9Yy5sZW5ndGgsZjtmb3IoZD1lO2QtLTspaWYoY1tkXT09PWEpe2Y9ZDticmVha31mb3IoZD1lLTE7ZC0tOylpZihhPmNbZF18fGQ9PT0wKXtjPShhLWNbZF0pLyhjW2QrMV0tY1tkXSk7Zj1kK2M7YnJlYWt9ZD1iP2Y6dGhpcy5vcmRpbmFsU2xvcGUqKGZ8fDApK3RoaXMub3JkaW5hbE9mZnNldH1lbHNlIGQ9YTtyZXR1cm4gZH0sbGluMnZhbDpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMub3JkaW5hbFBvc2l0aW9ucztpZihjKXt2YXIgZD10aGlzLm9yZGluYWxTbG9wZSxlPXRoaXMub3JkaW5hbE9mZnNldCxmPWMubGVuZ3RoLTEsZyxoO2lmKGIpYTwwP2E9Y1swXTphPmY/YT1jW2ZdOihmPVYoYSksaD1hLWYpO2Vsc2UgZm9yKDtmLS07KWlmKGc9ZCpmK2UsYT49Zyl7ZD1kKihmKzEpK2U7aD0oYS1nKS8oZC1nKTticmVha31jPWghPT10JiZjW2ZdIT09dD9jW2ZdK1xuKGg/aCooY1tmKzFdLWNbZl0pOjApOmF9ZWxzZSBjPWE7cmV0dXJuIGN9LGdldEV4dGVuZGVkUG9zaXRpb25zOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5jaGFydCxiPXRoaXMuc2VyaWVzWzBdLmN1cnJlbnREYXRhR3JvdXBpbmcsYz10aGlzLm9yZGluYWxJbmRleCxkPWI/Yi5jb3VudCtiLnVuaXROYW1lOlwicmF3XCIsZT10aGlzLmdldEV4dHJlbWVzKCksZixnO2lmKCFjKWM9dGhpcy5vcmRpbmFsSW5kZXg9e307aWYoIWNbZF0pZj17c2VyaWVzOltdLGdldEV4dHJlbWVzOmZ1bmN0aW9uKCl7cmV0dXJue21pbjplLmRhdGFNaW4sbWF4OmUuZGF0YU1heH19LG9wdGlvbnM6e29yZGluYWw6ITB9LHZhbDJsaW46Si5wcm90b3R5cGUudmFsMmxpbn0sbyh0aGlzLnNlcmllcyxmdW5jdGlvbihjKXtnPXt4QXhpczpmLHhEYXRhOmMueERhdGEsY2hhcnQ6YSxkZXN0cm95R3JvdXBlZERhdGE6cmF9O2cub3B0aW9ucz17ZGF0YUdyb3VwaW5nOmI/e2VuYWJsZWQ6ITAsZm9yY2VkOiEwLGFwcHJveGltYXRpb246XCJvcGVuXCIsXG51bml0czpbW2IudW5pdE5hbWUsW2IuY291bnRdXV19OntlbmFibGVkOiExfX07Yy5wcm9jZXNzRGF0YS5hcHBseShnKTtmLnNlcmllcy5wdXNoKGcpfSksdGhpcy5iZWZvcmVTZXRUaWNrUG9zaXRpb25zLmFwcGx5KGYpLGNbZF09Zi5vcmRpbmFsUG9zaXRpb25zO3JldHVybiBjW2RdfSxnZXRHcm91cEludGVydmFsRmFjdG9yOmZ1bmN0aW9uKGEsYixjKXt2YXIgZCxjPWMucHJvY2Vzc2VkWERhdGEsZT1jLmxlbmd0aCxmPVtdO2Q9dGhpcy5ncm91cEludGVydmFsRmFjdG9yO2lmKCFkKXtmb3IoZD0wO2Q8ZS0xO2QrKylmW2RdPWNbZCsxXS1jW2RdO2Yuc29ydChmdW5jdGlvbihhLGIpe3JldHVybiBhLWJ9KTtmPWZbVihlLzIpXTthPXcoYSxjWzBdKTtiPUcoYixjW2UtMV0pO3RoaXMuZ3JvdXBJbnRlcnZhbEZhY3Rvcj1kPWUqZi8oYi1hKX1yZXR1cm4gZH0scG9zdFByb2Nlc3NUaWNrSW50ZXJ2YWw6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5vcmRpbmFsU2xvcGU7cmV0dXJuIGI/dGhpcy5vcHRpb25zLmJyZWFrcz9cbnRoaXMuY2xvc2VzdFBvaW50UmFuZ2U6YS8oYi90aGlzLmNsb3Nlc3RQb2ludFJhbmdlKTphfX0pO1UoQmEucHJvdG90eXBlLFwicGFuXCIsZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLnhBeGlzWzBdLGQ9Yi5jaGFydFgsZT0hMTtpZihjLm9wdGlvbnMub3JkaW5hbCYmYy5zZXJpZXMubGVuZ3RoKXt2YXIgZj10aGlzLm1vdXNlRG93blgsZz1jLmdldEV4dHJlbWVzKCksaD1nLmRhdGFNYXgsaT1nLm1pbixqPWcubWF4LGs9dGhpcy5ob3ZlclBvaW50cyxsPWMuY2xvc2VzdFBvaW50UmFuZ2UsZj0oZi1kKS8oYy50cmFuc2xhdGlvblNsb3BlKihjLm9yZGluYWxTbG9wZXx8bCkpLG09e29yZGluYWxQb3NpdGlvbnM6Yy5nZXRFeHRlbmRlZFBvc2l0aW9ucygpfSxsPWMubGluMnZhbCxuPWMudmFsMmxpbixwO2lmKG0ub3JkaW5hbFBvc2l0aW9ucyl7aWYoUyhmKT4xKWsmJm8oayxmdW5jdGlvbihhKXthLnNldFN0YXRlKCl9KSxmPDA/KGs9bSxwPWMub3JkaW5hbFBvc2l0aW9ucz9jOm0pOihrPVxuYy5vcmRpbmFsUG9zaXRpb25zP2M6bSxwPW0pLG09cC5vcmRpbmFsUG9zaXRpb25zLGg+bVttLmxlbmd0aC0xXSYmbS5wdXNoKGgpLHRoaXMuZml4ZWRSYW5nZT1qLWksZj1jLnRvRml4ZWRSYW5nZShudWxsLG51bGwsbC5hcHBseShrLFtuLmFwcGx5KGssW2ksITBdKStmLCEwXSksbC5hcHBseShwLFtuLmFwcGx5KHAsW2osITBdKStmLCEwXSkpLGYubWluPj1HKGcuZGF0YU1pbixpKSYmZi5tYXg8PXcoaCxqKSYmYy5zZXRFeHRyZW1lcyhmLm1pbixmLm1heCwhMCwhMSx7dHJpZ2dlcjpcInBhblwifSksdGhpcy5tb3VzZURvd25YPWQsTih0aGlzLmNvbnRhaW5lcix7Y3Vyc29yOlwibW92ZVwifSl9ZWxzZSBlPSEwfWVsc2UgZT0hMDtlJiZhLmFwcGx5KHRoaXMsQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpKX0pO1AucHJvdG90eXBlLmdhcHBlZFBhdGg9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9wdGlvbnMuZ2FwU2l6ZSxiPXRoaXMucG9pbnRzLnNsaWNlKCksYz1iLmxlbmd0aC1cbjE7aWYoYSYmYz4wKWZvcig7Yy0tOyliW2MrMV0ueC1iW2NdLng+dGhpcy5jbG9zZXN0UG9pbnRSYW5nZSphJiZiLnNwbGljZShjKzEsMCx7aXNOdWxsOiEwfSk7cmV0dXJuIHRoaXMuZ2V0R3JhcGhQYXRoKGIpfTsoZnVuY3Rpb24oYSl7YShCKX0pKGZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoKXtyZXR1cm4gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpfWZ1bmN0aW9uIGMoYSl7YS5hcHBseSh0aGlzKTt0aGlzLmRyYXdCcmVha3ModGhpcy54QXhpcyxbXCJ4XCJdKTt0aGlzLmRyYXdCcmVha3ModGhpcy55QXhpcyxkKHRoaXMucG9pbnRBcnJheU1hcCxbXCJ5XCJdKSl9dmFyIGQ9YS5waWNrLGU9YS53cmFwLGY9YS5lYWNoLGc9YS5leHRlbmQsaD1hLmZpcmVFdmVudCxpPWEuQXhpcyxqPWEuU2VyaWVzO2coaS5wcm90b3R5cGUse2lzSW5CcmVhazpmdW5jdGlvbihhLGIpe3ZhciBjPWEucmVwZWF0fHxJbmZpbml0eSxkPWEuZnJvbSxlPWEudG8tYS5mcm9tLGM9Yj49ZD9cbihiLWQpJWM6Yy0oZC1iKSVjO3JldHVybiBhLmluY2x1c2l2ZT9jPD1lOmM8ZSYmYyE9PTB9LGlzSW5BbnlCcmVhazpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMub3B0aW9ucy5icmVha3MsZT1jJiZjLmxlbmd0aCxmLGcsaDtpZihlKXtmb3IoO2UtLTspdGhpcy5pc0luQnJlYWsoY1tlXSxhKSYmKGY9ITAsZ3x8KGc9ZChjW2VdLnNob3dQb2ludHMsdGhpcy5pc1hBeGlzPyExOiEwKSkpO2g9ZiYmYj9mJiYhZzpmfXJldHVybiBofX0pO2UoaS5wcm90b3R5cGUsXCJzZXRUaWNrUG9zaXRpb25zXCIsZnVuY3Rpb24oYSl7YS5hcHBseSh0aGlzLEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSk7aWYodGhpcy5vcHRpb25zLmJyZWFrcyl7dmFyIGI9dGhpcy50aWNrUG9zaXRpb25zLGM9dGhpcy50aWNrUG9zaXRpb25zLmluZm8sZD1bXSxlO2ZvcihlPTA7ZTxiLmxlbmd0aDtlKyspdGhpcy5pc0luQW55QnJlYWsoYltlXSl8fGQucHVzaChiW2VdKTt0aGlzLnRpY2tQb3NpdGlvbnM9XG5kO3RoaXMudGlja1Bvc2l0aW9ucy5pbmZvPWN9fSk7ZShpLnByb3RvdHlwZSxcImluaXRcIixmdW5jdGlvbihhLGIsYyl7aWYoYy5icmVha3MmJmMuYnJlYWtzLmxlbmd0aCljLm9yZGluYWw9ITE7YS5jYWxsKHRoaXMsYixjKTtpZih0aGlzLm9wdGlvbnMuYnJlYWtzKXt2YXIgZD10aGlzO2QuaXNCcm9rZW49ITA7dGhpcy52YWwybGluPWZ1bmN0aW9uKGEpe3ZhciBiPWEsYyxlO2ZvcihlPTA7ZTxkLmJyZWFrQXJyYXkubGVuZ3RoO2UrKylpZihjPWQuYnJlYWtBcnJheVtlXSxjLnRvPD1hKWItPWMubGVuO2Vsc2UgaWYoYy5mcm9tPj1hKWJyZWFrO2Vsc2UgaWYoZC5pc0luQnJlYWsoYyxhKSl7Yi09YS1jLmZyb207YnJlYWt9cmV0dXJuIGJ9O3RoaXMubGluMnZhbD1mdW5jdGlvbihhKXt2YXIgYixjO2ZvcihjPTA7YzxkLmJyZWFrQXJyYXkubGVuZ3RoO2MrKylpZihiPWQuYnJlYWtBcnJheVtjXSxiLmZyb20+PWEpYnJlYWs7ZWxzZSBiLnRvPGE/YSs9Yi5sZW46ZC5pc0luQnJlYWsoYixcbmEpJiYoYSs9Yi5sZW4pO3JldHVybiBhfTt0aGlzLnNldEV4dHJlbWVzPWZ1bmN0aW9uKGEsYixjLGQsZSl7Zm9yKDt0aGlzLmlzSW5BbnlCcmVhayhhKTspYS09dGhpcy5jbG9zZXN0UG9pbnRSYW5nZTtmb3IoO3RoaXMuaXNJbkFueUJyZWFrKGIpOyliLT10aGlzLmNsb3Nlc3RQb2ludFJhbmdlO2kucHJvdG90eXBlLnNldEV4dHJlbWVzLmNhbGwodGhpcyxhLGIsYyxkLGUpfTt0aGlzLnNldEF4aXNUcmFuc2xhdGlvbj1mdW5jdGlvbihhKXtpLnByb3RvdHlwZS5zZXRBeGlzVHJhbnNsYXRpb24uY2FsbCh0aGlzLGEpO3ZhciBiPWQub3B0aW9ucy5icmVha3MsYT1bXSxjPVtdLGU9MCxmLGcsaz1kLnVzZXJNaW58fGQubWluLGo9ZC51c2VyTWF4fHxkLm1heCxsLG07Zm9yKG0gaW4gYilnPWJbbV0sZj1nLnJlcGVhdHx8SW5maW5pdHksZC5pc0luQnJlYWsoZyxrKSYmKGsrPWcudG8lZi1rJWYpLGQuaXNJbkJyZWFrKGcsaikmJihqLT1qJWYtZy5mcm9tJWYpO2ZvcihtIGluIGIpe2c9YlttXTtcbmw9Zy5mcm9tO2ZvcihmPWcucmVwZWF0fHxJbmZpbml0eTtsLWY+azspbC09Zjtmb3IoO2w8azspbCs9Zjtmb3IoO2w8ajtsKz1mKWEucHVzaCh7dmFsdWU6bCxtb3ZlOlwiaW5cIn0pLGEucHVzaCh7dmFsdWU6bCsoZy50by1nLmZyb20pLG1vdmU6XCJvdXRcIixzaXplOmcuYnJlYWtTaXplfSl9YS5zb3J0KGZ1bmN0aW9uKGEsYil7cmV0dXJuIGEudmFsdWU9PT1iLnZhbHVlPyhhLm1vdmU9PT1cImluXCI/MDoxKS0oYi5tb3ZlPT09XCJpblwiPzA6MSk6YS52YWx1ZS1iLnZhbHVlfSk7Yj0wO2w9aztmb3IobSBpbiBhKXtnPWFbbV07Yis9Zy5tb3ZlPT09XCJpblwiPzE6LTE7aWYoYj09PTEmJmcubW92ZT09PVwiaW5cIilsPWcudmFsdWU7Yj09PTAmJihjLnB1c2goe2Zyb206bCx0bzpnLnZhbHVlLGxlbjpnLnZhbHVlLWwtKGcuc2l6ZXx8MCl9KSxlKz1nLnZhbHVlLWwtKGcuc2l6ZXx8MCkpfWQuYnJlYWtBcnJheT1jO2goZCxcImFmdGVyQnJlYWtzXCIpO2QudHJhbnNBKj0oai1kLm1pbikvKGotay1lKTtkLm1pbj1cbms7ZC5tYXg9an19fSk7ZShqLnByb3RvdHlwZSxcImdlbmVyYXRlUG9pbnRzXCIsZnVuY3Rpb24oYSl7YS5hcHBseSh0aGlzLGIoYXJndW1lbnRzKSk7dmFyIGM9dGhpcy54QXhpcyxkPXRoaXMueUF4aXMsZT10aGlzLnBvaW50cyxmLGc9ZS5sZW5ndGgsaD10aGlzLm9wdGlvbnMuY29ubmVjdE51bGxzLGk7aWYoYyYmZCYmKGMub3B0aW9ucy5icmVha3N8fGQub3B0aW9ucy5icmVha3MpKWZvcig7Zy0tOylpZihmPWVbZ10saT1mLnk9PT1udWxsJiZoPT09ITEsIWkmJihjLmlzSW5BbnlCcmVhayhmLngsITApfHxkLmlzSW5BbnlCcmVhayhmLnksITApKSllLnNwbGljZShnLDEpLHRoaXMuZGF0YVtnXSYmdGhpcy5kYXRhW2ddLmRlc3Ryb3lFbGVtZW50cygpfSk7YS5TZXJpZXMucHJvdG90eXBlLmRyYXdCcmVha3M9ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLGU9Yy5wb2ludHMsZyxpLGosbztmKGIsZnVuY3Rpb24oYil7Zz1hLmJyZWFrQXJyYXl8fFtdO2k9YS5pc1hBeGlzP2EubWluOmQoYy5vcHRpb25zLnRocmVzaG9sZCxcbmEubWluKTtmKGUsZnVuY3Rpb24oYyl7bz1kKGNbXCJzdGFja1wiK2IudG9VcHBlckNhc2UoKV0sY1tiXSk7ZihnLGZ1bmN0aW9uKGIpe2o9ITE7aWYoaTxiLmZyb20mJm8+Yi50b3x8aT5iLmZyb20mJm88Yi5mcm9tKWo9XCJwb2ludEJyZWFrXCI7ZWxzZSBpZihpPGIuZnJvbSYmbz5iLmZyb20mJm88Yi50b3x8aT5iLmZyb20mJm8+Yi50byYmbzxiLmZyb20paj1cInBvaW50SW5CcmVha1wiO2omJmgoYSxqLHtwb2ludDpjLGJyazpifSl9KX0pfSl9O2UoYS5zZXJpZXNUeXBlcy5jb2x1bW4ucHJvdG90eXBlLFwiZHJhd1BvaW50c1wiLGMpO2UoYS5TZXJpZXMucHJvdG90eXBlLFwiZHJhd1BvaW50c1wiLGMpfSk7dmFyIGlhPVAucHJvdG90eXBlLGNjPWlhLnByb2Nlc3NEYXRhLGRjPWlhLmdlbmVyYXRlUG9pbnRzLGVjPWlhLmRlc3Ryb3ksZmM9e2FwcHJveGltYXRpb246XCJhdmVyYWdlXCIsZ3JvdXBQaXhlbFdpZHRoOjIsZGF0ZVRpbWVMYWJlbEZvcm1hdHM6e21pbGxpc2Vjb25kOltcIiVBLCAlYiAlZSwgJUg6JU06JVMuJUxcIixcblwiJUEsICViICVlLCAlSDolTTolUy4lTFwiLFwiLSVIOiVNOiVTLiVMXCJdLHNlY29uZDpbXCIlQSwgJWIgJWUsICVIOiVNOiVTXCIsXCIlQSwgJWIgJWUsICVIOiVNOiVTXCIsXCItJUg6JU06JVNcIl0sbWludXRlOltcIiVBLCAlYiAlZSwgJUg6JU1cIixcIiVBLCAlYiAlZSwgJUg6JU1cIixcIi0lSDolTVwiXSxob3VyOltcIiVBLCAlYiAlZSwgJUg6JU1cIixcIiVBLCAlYiAlZSwgJUg6JU1cIixcIi0lSDolTVwiXSxkYXk6W1wiJUEsICViICVlLCAlWVwiLFwiJUEsICViICVlXCIsXCItJUEsICViICVlLCAlWVwiXSx3ZWVrOltcIldlZWsgZnJvbSAlQSwgJWIgJWUsICVZXCIsXCIlQSwgJWIgJWVcIixcIi0lQSwgJWIgJWUsICVZXCJdLG1vbnRoOltcIiVCICVZXCIsXCIlQlwiLFwiLSVCICVZXCJdLHllYXI6W1wiJVlcIixcIiVZXCIsXCItJVlcIl19fSxYYj17bGluZTp7fSxzcGxpbmU6e30sYXJlYTp7fSxhcmVhc3BsaW5lOnt9LGNvbHVtbjp7YXBwcm94aW1hdGlvbjpcInN1bVwiLGdyb3VwUGl4ZWxXaWR0aDoxMH0sYXJlYXJhbmdlOnthcHByb3hpbWF0aW9uOlwicmFuZ2VcIn0sXG5hcmVhc3BsaW5lcmFuZ2U6e2FwcHJveGltYXRpb246XCJyYW5nZVwifSxjb2x1bW5yYW5nZTp7YXBwcm94aW1hdGlvbjpcInJhbmdlXCIsZ3JvdXBQaXhlbFdpZHRoOjEwfSxjYW5kbGVzdGljazp7YXBwcm94aW1hdGlvbjpcIm9obGNcIixncm91cFBpeGVsV2lkdGg6MTB9LG9obGM6e2FwcHJveGltYXRpb246XCJvaGxjXCIsZ3JvdXBQaXhlbFdpZHRoOjV9fSxZYj1bW1wibWlsbGlzZWNvbmRcIixbMSwyLDUsMTAsMjAsMjUsNTAsMTAwLDIwMCw1MDBdXSxbXCJzZWNvbmRcIixbMSwyLDUsMTAsMTUsMzBdXSxbXCJtaW51dGVcIixbMSwyLDUsMTAsMTUsMzBdXSxbXCJob3VyXCIsWzEsMiwzLDQsNiw4LDEyXV0sW1wiZGF5XCIsWzFdXSxbXCJ3ZWVrXCIsWzFdXSxbXCJtb250aFwiLFsxLDMsNl1dLFtcInllYXJcIixudWxsXV0sVGE9e3N1bTpmdW5jdGlvbihhKXt2YXIgYj1hLmxlbmd0aCxjO2lmKCFiJiZhLmhhc051bGxzKWM9bnVsbDtlbHNlIGlmKGIpZm9yKGM9MDtiLS07KWMrPWFbYl07cmV0dXJuIGN9LGF2ZXJhZ2U6ZnVuY3Rpb24oYSl7dmFyIGI9XG5hLmxlbmd0aCxhPVRhLnN1bShhKTtDKGEpJiZiJiYoYS89Yik7cmV0dXJuIGF9LG9wZW46ZnVuY3Rpb24oYSl7cmV0dXJuIGEubGVuZ3RoP2FbMF06YS5oYXNOdWxscz9udWxsOnR9LGhpZ2g6ZnVuY3Rpb24oYSl7cmV0dXJuIGEubGVuZ3RoP0RhKGEpOmEuaGFzTnVsbHM/bnVsbDp0fSxsb3c6ZnVuY3Rpb24oYSl7cmV0dXJuIGEubGVuZ3RoP01hKGEpOmEuaGFzTnVsbHM/bnVsbDp0fSxjbG9zZTpmdW5jdGlvbihhKXtyZXR1cm4gYS5sZW5ndGg/YVthLmxlbmd0aC0xXTphLmhhc051bGxzP251bGw6dH0sb2hsYzpmdW5jdGlvbihhLGIsYyxkKXthPVRhLm9wZW4oYSk7Yj1UYS5oaWdoKGIpO2M9VGEubG93KGMpO2Q9VGEuY2xvc2UoZCk7aWYoQyhhKXx8QyhiKXx8QyhjKXx8QyhkKSlyZXR1cm5bYSxiLGMsZF19LHJhbmdlOmZ1bmN0aW9uKGEsYil7YT1UYS5sb3coYSk7Yj1UYS5oaWdoKGIpO2lmKEMoYSl8fEMoYikpcmV0dXJuW2EsYl19fTtpYS5ncm91cERhdGE9ZnVuY3Rpb24oYSxcbmIsYyxkKXt2YXIgZT10aGlzLmRhdGEsZj10aGlzLm9wdGlvbnMuZGF0YSxnPVtdLGg9W10saT1bXSxqPWEubGVuZ3RoLGssbCxtPSEhYixuPVtbXSxbXSxbXSxbXV0sZD10eXBlb2YgZD09PVwiZnVuY3Rpb25cIj9kOlRhW2RdLHA9dGhpcy5wb2ludEFycmF5TWFwLG89cCYmcC5sZW5ndGgscSx2PTA7Zm9yKHE9MDtxPD1qO3ErKylpZihhW3FdPj1jWzBdKWJyZWFrO2Zvcig7cTw9ajtxKyspe2Zvcig7Y1sxXSE9PXQmJmFbcV0+PWNbMV18fHE9PT1qOylpZihrPWMuc2hpZnQoKSxsPWQuYXBwbHkoMCxuKSxsIT09dCYmKGcucHVzaChrKSxoLnB1c2gobCksaS5wdXNoKHtzdGFydDp2LGxlbmd0aDpuWzBdLmxlbmd0aH0pKSx2PXEsblswXT1bXSxuWzFdPVtdLG5bMl09W10sblszXT1bXSxxPT09ailicmVhaztpZihxPT09ailicmVhaztpZihwKXtrPXRoaXMuY3JvcFN0YXJ0K3E7az1lJiZlW2tdfHx0aGlzLnBvaW50Q2xhc3MucHJvdG90eXBlLmFwcGx5T3B0aW9ucy5hcHBseSh7c2VyaWVzOnRoaXN9LFxuW2Zba11dKTt2YXIgdTtmb3IobD0wO2w8bztsKyspaWYodT1rW3BbbF1dLEModSkpbltsXS5wdXNoKHUpO2Vsc2UgaWYodT09PW51bGwpbltsXS5oYXNOdWxscz0hMH1lbHNlIGlmKGs9bT9iW3FdOm51bGwsQyhrKSluWzBdLnB1c2goayk7ZWxzZSBpZihrPT09bnVsbCluWzBdLmhhc051bGxzPSEwfXJldHVybltnLGgsaV19O2lhLnByb2Nlc3NEYXRhPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5jaGFydCxiPXRoaXMub3B0aW9ucy5kYXRhR3JvdXBpbmcsYz10aGlzLmFsbG93REchPT0hMSYmYiYmcShiLmVuYWJsZWQsYS5vcHRpb25zLl9zdG9jayksZDt0aGlzLmZvcmNlQ3JvcD1jO3RoaXMuZ3JvdXBQaXhlbFdpZHRoPW51bGw7dGhpcy5oYXNQcm9jZXNzZWQ9ITA7aWYoY2MuYXBwbHkodGhpcyxhcmd1bWVudHMpIT09ITEmJmMpe3RoaXMuZGVzdHJveUdyb3VwZWREYXRhKCk7dmFyIGU9dGhpcy5wcm9jZXNzZWRYRGF0YSxmPXRoaXMucHJvY2Vzc2VkWURhdGEsZz1hLnBsb3RTaXplWCxhPVxudGhpcy54QXhpcyxoPWEub3B0aW9ucy5vcmRpbmFsLGk9dGhpcy5ncm91cFBpeGVsV2lkdGg9YS5nZXRHcm91cFBpeGVsV2lkdGgmJmEuZ2V0R3JvdXBQaXhlbFdpZHRoKCk7aWYoaSl7ZD0hMDt0aGlzLnBvaW50cz1udWxsO3ZhciBqPWEuZ2V0RXh0cmVtZXMoKSxjPWoubWluLGo9ai5tYXgsaD1oJiZhLmdldEdyb3VwSW50ZXJ2YWxGYWN0b3IoYyxqLHRoaXMpfHwxLGc9aSooai1jKS9nKmgsaT1hLmdldFRpbWVUaWNrcyhhLm5vcm1hbGl6ZVRpbWVUaWNrSW50ZXJ2YWwoZyxiLnVuaXRzfHxZYiksTWF0aC5taW4oYyxlWzBdKSxNYXRoLm1heChqLGVbZS5sZW5ndGgtMV0pLGEub3B0aW9ucy5zdGFydE9mV2VlayxlLHRoaXMuY2xvc2VzdFBvaW50UmFuZ2UpLGU9aWEuZ3JvdXBEYXRhLmFwcGx5KHRoaXMsW2UsZixpLGIuYXBwcm94aW1hdGlvbl0pLGY9ZVswXSxoPWVbMV07aWYoYi5zbW9vdGhlZCl7Yj1mLmxlbmd0aC0xO2ZvcihmW2JdPU1hdGgubWluKGZbYl0saik7Yi0tJiZiPjA7KWZbYl0rPVxuZy8yO2ZbMF09TWF0aC5tYXgoZlswXSxjKX10aGlzLmN1cnJlbnREYXRhR3JvdXBpbmc9aS5pbmZvO3RoaXMuY2xvc2VzdFBvaW50UmFuZ2U9aS5pbmZvLnRvdGFsUmFuZ2U7dGhpcy5ncm91cE1hcD1lWzJdO2lmKHYoZlswXSkmJmZbMF08YS5kYXRhTWluKXtpZihhLm1pbj09PWEuZGF0YU1pbilhLm1pbj1mWzBdO2EuZGF0YU1pbj1mWzBdfXRoaXMucHJvY2Vzc2VkWERhdGE9Zjt0aGlzLnByb2Nlc3NlZFlEYXRhPWh9ZWxzZSB0aGlzLmN1cnJlbnREYXRhR3JvdXBpbmc9dGhpcy5ncm91cE1hcD1udWxsO3RoaXMuaGFzR3JvdXBlZERhdGE9ZH19O2lhLmRlc3Ryb3lHcm91cGVkRGF0YT1mdW5jdGlvbigpe3ZhciBhPXRoaXMuZ3JvdXBlZERhdGE7byhhfHxbXSxmdW5jdGlvbihiLGMpe2ImJihhW2NdPWIuZGVzdHJveT9iLmRlc3Ryb3koKTpudWxsKX0pO3RoaXMuZ3JvdXBlZERhdGE9bnVsbH07aWEuZ2VuZXJhdGVQb2ludHM9ZnVuY3Rpb24oKXtkYy5hcHBseSh0aGlzKTt0aGlzLmRlc3Ryb3lHcm91cGVkRGF0YSgpO1xudGhpcy5ncm91cGVkRGF0YT10aGlzLmhhc0dyb3VwZWREYXRhP3RoaXMucG9pbnRzOm51bGx9O1UoTGIucHJvdG90eXBlLFwidG9vbHRpcEZvb3RlckhlYWRlckZvcm1hdHRlclwiLGZ1bmN0aW9uKGEsYixjKXt2YXIgZD1iLnNlcmllcyxlPWQudG9vbHRpcE9wdGlvbnMsZj1kLm9wdGlvbnMuZGF0YUdyb3VwaW5nLGc9ZS54RGF0ZUZvcm1hdCxoLGk9ZC54QXhpcztyZXR1cm4gaSYmaS5vcHRpb25zLnR5cGU9PT1cImRhdGV0aW1lXCImJmYmJkMoYi5rZXkpPyhhPWQuY3VycmVudERhdGFHcm91cGluZyxmPWYuZGF0ZVRpbWVMYWJlbEZvcm1hdHMsYT8oaT1mW2EudW5pdE5hbWVdLGEuY291bnQ9PT0xP2c9aVswXTooZz1pWzFdLGg9aVsyXSkpOiFnJiZmJiYoZz10aGlzLmdldFhEYXRlRm9ybWF0KGIsZSxpKSksZz1uYShnLGIua2V5KSxoJiYoZys9bmEoaCxiLmtleSthLnRvdGFsUmFuZ2UtMSkpLExhKGVbKGM/XCJmb290ZXJcIjpcImhlYWRlclwiKStcIkZvcm1hdFwiXSx7cG9pbnQ6QShiLHtrZXk6Z30pLFxuc2VyaWVzOmR9KSk6YS5jYWxsKHRoaXMsYixjKX0pO2lhLmRlc3Ryb3k9ZnVuY3Rpb24oKXtmb3IodmFyIGE9dGhpcy5ncm91cGVkRGF0YXx8W10sYj1hLmxlbmd0aDtiLS07KWFbYl0mJmFbYl0uZGVzdHJveSgpO2VjLmFwcGx5KHRoaXMpfTtVKGlhLFwic2V0T3B0aW9uc1wiLGZ1bmN0aW9uKGEsYil7dmFyIGM9YS5jYWxsKHRoaXMsYiksZD10aGlzLnR5cGUsZT10aGlzLmNoYXJ0Lm9wdGlvbnMucGxvdE9wdGlvbnMsZj1XW2RdLmRhdGFHcm91cGluZztpZihYYltkXSlmfHwoZj16KGZjLFhiW2RdKSksYy5kYXRhR3JvdXBpbmc9eihmLGUuc2VyaWVzJiZlLnNlcmllcy5kYXRhR3JvdXBpbmcsZVtkXS5kYXRhR3JvdXBpbmcsYi5kYXRhR3JvdXBpbmcpO2lmKHRoaXMuY2hhcnQub3B0aW9ucy5fc3RvY2spdGhpcy5yZXF1aXJlU29ydGluZz0hMDtyZXR1cm4gY30pO1UoSi5wcm90b3R5cGUsXCJzZXRTY2FsZVwiLGZ1bmN0aW9uKGEpe2EuY2FsbCh0aGlzKTtvKHRoaXMuc2VyaWVzLGZ1bmN0aW9uKGEpe2EuaGFzUHJvY2Vzc2VkPVxuITF9KX0pO0oucHJvdG90eXBlLmdldEdyb3VwUGl4ZWxXaWR0aD1mdW5jdGlvbigpe3ZhciBhPXRoaXMuc2VyaWVzLGI9YS5sZW5ndGgsYyxkPTAsZT0hMSxmO2ZvcihjPWI7Yy0tOykoZj1hW2NdLm9wdGlvbnMuZGF0YUdyb3VwaW5nKSYmKGQ9dyhkLGYuZ3JvdXBQaXhlbFdpZHRoKSk7Zm9yKGM9YjtjLS07KWlmKChmPWFbY10ub3B0aW9ucy5kYXRhR3JvdXBpbmcpJiZhW2NdLmhhc1Byb2Nlc3NlZClpZihiPShhW2NdLnByb2Nlc3NlZFhEYXRhfHxhW2NdLmRhdGEpLmxlbmd0aCxhW2NdLmdyb3VwUGl4ZWxXaWR0aHx8Yj50aGlzLmNoYXJ0LnBsb3RTaXplWC9kfHxiJiZmLmZvcmNlZCllPSEwO3JldHVybiBlP2Q6MH07Si5wcm90b3R5cGUuc2V0RGF0YUdyb3VwaW5nPWZ1bmN0aW9uKGEsYil7dmFyIGMsYj1xKGIsITApO2F8fChhPXtmb3JjZWQ6ITEsdW5pdHM6bnVsbH0pO2lmKHRoaXMgaW5zdGFuY2VvZiBKKWZvcihjPXRoaXMuc2VyaWVzLmxlbmd0aDtjLS07KXRoaXMuc2VyaWVzW2NdLnVwZGF0ZSh7ZGF0YUdyb3VwaW5nOmF9LFxuITEpO2Vsc2Ugbyh0aGlzLmNoYXJ0Lm9wdGlvbnMuc2VyaWVzLGZ1bmN0aW9uKGIpe2IuZGF0YUdyb3VwaW5nPWF9LCExKTtiJiZ0aGlzLmNoYXJ0LnJlZHJhdygpfTtXLm9obGM9eihXLmNvbHVtbix7bGluZVdpZHRoOjEsdG9vbHRpcDp7cG9pbnRGb3JtYXQ6JzxzcGFuIHN0eWxlPVwiY29sb3I6e3BvaW50LmNvbG9yfVwiPlxcdTI1Y2Y8L3NwYW4+IDxiPiB7c2VyaWVzLm5hbWV9PC9iPjxici8+T3Blbjoge3BvaW50Lm9wZW59PGJyLz5IaWdoOiB7cG9pbnQuaGlnaH08YnIvPkxvdzoge3BvaW50Lmxvd308YnIvPkNsb3NlOiB7cG9pbnQuY2xvc2V9PGJyLz4nfSxzdGF0ZXM6e2hvdmVyOntsaW5lV2lkdGg6M319LHRocmVzaG9sZDpudWxsfSk7ZGE9bWEoSS5jb2x1bW4se3R5cGU6XCJvaGxjXCIscG9pbnRBcnJheU1hcDpbXCJvcGVuXCIsXCJoaWdoXCIsXCJsb3dcIixcImNsb3NlXCJdLHRvWURhdGE6ZnVuY3Rpb24oYSl7cmV0dXJuW2Eub3BlbixhLmhpZ2gsYS5sb3csYS5jbG9zZV19LHBvaW50VmFsS2V5OlwiaGlnaFwiLFxucG9pbnRBdHRyVG9PcHRpb25zOntzdHJva2U6XCJjb2xvclwiLFwic3Ryb2tlLXdpZHRoXCI6XCJsaW5lV2lkdGhcIn0sdXBDb2xvclByb3A6XCJzdHJva2VcIixnZXRBdHRyaWJzOmZ1bmN0aW9uKCl7SS5jb2x1bW4ucHJvdG90eXBlLmdldEF0dHJpYnMuYXBwbHkodGhpcyxhcmd1bWVudHMpO3ZhciBhPXRoaXMub3B0aW9ucyxiPWEuc3RhdGVzLGE9YS51cENvbG9yfHx0aGlzLmNvbG9yLGM9eih0aGlzLnBvaW50QXR0ciksZD10aGlzLnVwQ29sb3JQcm9wO2NbXCJcIl1bZF09YTtjLmhvdmVyW2RdPWIuaG92ZXIudXBDb2xvcnx8YTtjLnNlbGVjdFtkXT1iLnNlbGVjdC51cENvbG9yfHxhO28odGhpcy5wb2ludHMsZnVuY3Rpb24oYSl7aWYoYS5vcGVuPGEuY2xvc2UmJiFhLm9wdGlvbnMuY29sb3IpYS5wb2ludEF0dHI9Y30pfSx0cmFuc2xhdGU6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLnlBeGlzO0kuY29sdW1uLnByb3RvdHlwZS50cmFuc2xhdGUuYXBwbHkodGhpcyk7byh0aGlzLnBvaW50cyxmdW5jdGlvbihiKXtpZihiLm9wZW4hPT1cbm51bGwpYi5wbG90T3Blbj1hLnRyYW5zbGF0ZShiLm9wZW4sMCwxLDAsMSk7aWYoYi5jbG9zZSE9PW51bGwpYi5wbG90Q2xvc2U9YS50cmFuc2xhdGUoYi5jbG9zZSwwLDEsMCwxKX0pfSxkcmF3UG9pbnRzOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEuY2hhcnQsYyxkLGUsZixnLGgsaSxqO28oYS5wb2ludHMsZnVuY3Rpb24oayl7aWYoay5wbG90WSE9PXQpaT1rLmdyYXBoaWMsYz1rLnBvaW50QXR0cltrLnNlbGVjdGVkP1wic2VsZWN0ZWRcIjpcIlwiXXx8YS5wb2ludEF0dHJbXCJcIl0sZj1jW1wic3Ryb2tlLXdpZHRoXCJdJTIvMixqPXkoay5wbG90WCktZixnPXkoay5zaGFwZUFyZ3Mud2lkdGgvMiksaD1bXCJNXCIsaix5KGsueUJvdHRvbSksXCJMXCIsaix5KGsucGxvdFkpXSxrLm9wZW4hPT1udWxsJiYoZD15KGsucGxvdE9wZW4pK2YsaC5wdXNoKFwiTVwiLGosZCxcIkxcIixqLWcsZCkpLGsuY2xvc2UhPT1udWxsJiYoZT15KGsucGxvdENsb3NlKStmLGgucHVzaChcIk1cIixqLGUsXCJMXCIsaitnLGUpKSxpP1xuaS5hdHRyKGMpLmFuaW1hdGUoe2Q6aH0pOmsuZ3JhcGhpYz1iLnJlbmRlcmVyLnBhdGgoaCkuYXR0cihjKS5hZGQoYS5ncm91cCl9KX0sYW5pbWF0ZTpudWxsfSk7SS5vaGxjPWRhO1cuY2FuZGxlc3RpY2s9eihXLmNvbHVtbix7bGluZUNvbG9yOlwiYmxhY2tcIixsaW5lV2lkdGg6MSxzdGF0ZXM6e2hvdmVyOntsaW5lV2lkdGg6Mn19LHRvb2x0aXA6Vy5vaGxjLnRvb2x0aXAsdGhyZXNob2xkOm51bGwsdXBDb2xvcjpcIndoaXRlXCJ9KTtkYT1tYShkYSx7dHlwZTpcImNhbmRsZXN0aWNrXCIscG9pbnRBdHRyVG9PcHRpb25zOntmaWxsOlwiY29sb3JcIixzdHJva2U6XCJsaW5lQ29sb3JcIixcInN0cm9rZS13aWR0aFwiOlwibGluZVdpZHRoXCJ9LHVwQ29sb3JQcm9wOlwiZmlsbFwiLGdldEF0dHJpYnM6ZnVuY3Rpb24oKXtJLm9obGMucHJvdG90eXBlLmdldEF0dHJpYnMuYXBwbHkodGhpcyxhcmd1bWVudHMpO3ZhciBhPXRoaXMub3B0aW9ucyxiPWEuc3RhdGVzLGM9YS51cExpbmVDb2xvcnx8YS5saW5lQ29sb3IsXG5kPWIuaG92ZXIudXBMaW5lQ29sb3J8fGMsZT1iLnNlbGVjdC51cExpbmVDb2xvcnx8YztvKHRoaXMucG9pbnRzLGZ1bmN0aW9uKGEpe2lmKGEub3BlbjxhLmNsb3NlKXtpZihhLmxpbmVDb2xvcilhLnBvaW50QXR0cj16KGEucG9pbnRBdHRyKSxjPWEubGluZUNvbG9yO2EucG9pbnRBdHRyW1wiXCJdLnN0cm9rZT1jO2EucG9pbnRBdHRyLmhvdmVyLnN0cm9rZT1kO2EucG9pbnRBdHRyLnNlbGVjdC5zdHJva2U9ZX19KX0sZHJhd1BvaW50czpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLmNoYXJ0LGMsZD1hLnBvaW50QXR0cltcIlwiXSxlLGYsZyxoLGksaixrLGwsbSxuLHA7byhhLnBvaW50cyxmdW5jdGlvbihvKXttPW8uZ3JhcGhpYztpZihvLnBsb3RZIT09dCljPW8ucG9pbnRBdHRyW28uc2VsZWN0ZWQ/XCJzZWxlY3RlZFwiOlwiXCJdfHxkLGs9Y1tcInN0cm9rZS13aWR0aFwiXSUyLzIsbD15KG8ucGxvdFgpLWssZT1vLnBsb3RPcGVuLGY9by5wbG90Q2xvc2UsZz1ZLm1pbihlLGYpLGg9WS5tYXgoZSxcbmYpLHA9eShvLnNoYXBlQXJncy53aWR0aC8yKSxpPXkoZykhPT15KG8ucGxvdFkpLGo9aCE9PW8ueUJvdHRvbSxnPXkoZykrayxoPXkoaCkrayxuPVtdLG4ucHVzaChcIk1cIixsLXAsaCxcIkxcIixsLXAsZyxcIkxcIixsK3AsZyxcIkxcIixsK3AsaCxcIlpcIixcIk1cIixsLGcsXCJMXCIsbCxpP3koby5wbG90WSk6ZyxcIk1cIixsLGgsXCJMXCIsbCxqP3koby55Qm90dG9tKTpoKSxtP20uYXR0cihjKS5hbmltYXRlKHtkOm59KTpvLmdyYXBoaWM9Yi5yZW5kZXJlci5wYXRoKG4pLmF0dHIoYykuYWRkKGEuZ3JvdXApLnNoYWRvdyhhLm9wdGlvbnMuc2hhZG93KX0pfX0pO0kuY2FuZGxlc3RpY2s9ZGE7dmFyIHZiPXhhLnByb3RvdHlwZS5zeW1ib2xzO1cuZmxhZ3M9eihXLmNvbHVtbix7ZmlsbENvbG9yOlwid2hpdGVcIixsaW5lV2lkdGg6MSxwb2ludFJhbmdlOjAsc2hhcGU6XCJmbGFnXCIsc3RhY2tEaXN0YW5jZToxMixzdGF0ZXM6e2hvdmVyOntsaW5lQ29sb3I6XCJibGFja1wiLGZpbGxDb2xvcjpcIiNGQ0ZGQzVcIn19LHN0eWxlOntmb250U2l6ZTpcIjExcHhcIixcbmZvbnRXZWlnaHQ6XCJib2xkXCIsdGV4dEFsaWduOlwiY2VudGVyXCJ9LHRvb2x0aXA6e3BvaW50Rm9ybWF0Olwie3BvaW50LnRleHR9PGJyLz5cIn0sdGhyZXNob2xkOm51bGwseTotMzB9KTtJLmZsYWdzPW1hKEkuY29sdW1uLHt0eXBlOlwiZmxhZ3NcIixzb3J0ZWQ6ITEsbm9TaGFyZWRUb29sdGlwOiEwLGFsbG93REc6ITEsdGFrZU9yZGluYWxQb3NpdGlvbjohMSx0cmFja2VyR3JvdXBzOltcIm1hcmtlckdyb3VwXCJdLGZvcmNlQ3JvcDohMCxpbml0OlAucHJvdG90eXBlLmluaXQscG9pbnRBdHRyVG9PcHRpb25zOntmaWxsOlwiZmlsbENvbG9yXCIsc3Ryb2tlOlwiY29sb3JcIixcInN0cm9rZS13aWR0aFwiOlwibGluZVdpZHRoXCIscjpcInJhZGl1c1wifSx0cmFuc2xhdGU6ZnVuY3Rpb24oKXtJLmNvbHVtbi5wcm90b3R5cGUudHJhbnNsYXRlLmFwcGx5KHRoaXMpO3ZhciBhPXRoaXMub3B0aW9ucyxiPXRoaXMuY2hhcnQsYz10aGlzLnBvaW50cyxkPWMubGVuZ3RoLTEsZSxmLGc9YS5vblNlcmllcztlPWcmJmIuZ2V0KGcpO1xudmFyIGE9YS5vbktleXx8XCJ5XCIsZz1lJiZlLm9wdGlvbnMuc3RlcCxoPWUmJmUucG9pbnRzLGk9aCYmaC5sZW5ndGgsaj10aGlzLnhBeGlzLGs9ai5nZXRFeHRyZW1lcygpLGwsbSxuO2lmKGUmJmUudmlzaWJsZSYmaSl7ZT1lLmN1cnJlbnREYXRhR3JvdXBpbmc7bT1oW2ktMV0ueCsoZT9lLnRvdGFsUmFuZ2U6MCk7Yy5zb3J0KGZ1bmN0aW9uKGEsYil7cmV0dXJuIGEueC1iLnh9KTtmb3IoYT1cInBsb3RcIithWzBdLnRvVXBwZXJDYXNlKCkrYS5zdWJzdHIoMSk7aS0tJiZjW2RdOylpZihlPWNbZF0sbD1oW2ldLGwueDw9ZS54JiZsW2FdIT09dm9pZCAwKXtpZihlLng8PW0pZS5wbG90WT1sW2FdLGwueDxlLngmJiFnJiYobj1oW2krMV0pJiZuW2FdIT09dCYmKGUucGxvdFkrPShlLngtbC54KS8obi54LWwueCkqKG5bYV0tbFthXSkpO2QtLTtpKys7aWYoZDwwKWJyZWFrfX1vKGMsZnVuY3Rpb24oYSxkKXt2YXIgZTtpZihhLnBsb3RZPT09dClhLng+PWsubWluJiZhLng8PWsubWF4P2EucGxvdFk9XG5iLmNoYXJ0SGVpZ2h0LWouYm90dG9tLShqLm9wcG9zaXRlP2ouaGVpZ2h0OjApK2oub2Zmc2V0LWIucGxvdFRvcDphLnNoYXBlQXJncz17fTtpZigoZj1jW2QtMV0pJiZmLnBsb3RYPT09YS5wbG90WCl7aWYoZi5zdGFja0luZGV4PT09dClmLnN0YWNrSW5kZXg9MDtlPWYuc3RhY2tJbmRleCsxfWEuc3RhY2tJbmRleD1lfSl9LGRyYXdQb2ludHM6ZnVuY3Rpb24oKXt2YXIgYSxiPXRoaXMucG9pbnRBdHRyW1wiXCJdLGM9dGhpcy5wb2ludHMsZD10aGlzLmNoYXJ0LGU9ZC5yZW5kZXJlcixmLGcsaD10aGlzLm9wdGlvbnMsaT1oLnksaixrLGwsbSxuLHAsbz10aGlzLnlBeGlzO2ZvcihrPWMubGVuZ3RoO2stLTspaWYobD1jW2tdLGE9bC5wbG90WD50aGlzLnhBeGlzLmxlbixmPWwucGxvdFgsZj4wJiYoZi09cShsLmxpbmVXaWR0aCxoLmxpbmVXaWR0aCklMiksbT1sLnN0YWNrSW5kZXgsaj1sLm9wdGlvbnMuc2hhcGV8fGguc2hhcGUsZz1sLnBsb3RZLGchPT10JiYoZz1sLnBsb3RZK2ktKG0hPT1cbnQmJm0qaC5zdGFja0Rpc3RhbmNlKSksbj1tP3Q6bC5wbG90WCxwPW0/dDpsLnBsb3RZLG09bC5ncmFwaGljLGchPT10JiZmPj0wJiYhYSlhPWwucG9pbnRBdHRyW2wuc2VsZWN0ZWQ/XCJzZWxlY3RcIjpcIlwiXXx8YixtP20uYXR0cih7eDpmLHk6ZyxyOmEucixhbmNob3JYOm4sYW5jaG9yWTpwfSk6bC5ncmFwaGljPWUubGFiZWwobC5vcHRpb25zLnRpdGxlfHxoLnRpdGxlfHxcIkFcIixmLGcsaixuLHAsaC51c2VIVE1MKS5jc3MoeihoLnN0eWxlLGwuc3R5bGUpKS5hdHRyKGEpLmF0dHIoe2FsaWduOmo9PT1cImZsYWdcIj9cImxlZnRcIjpcImNlbnRlclwiLHdpZHRoOmgud2lkdGgsaGVpZ2h0OmguaGVpZ2h0fSkuYWRkKHRoaXMubWFya2VyR3JvdXApLnNoYWRvdyhoLnNoYWRvdyksbC50b29sdGlwUG9zPWQuaW52ZXJ0ZWQ/W28ubGVuK28ucG9zLWQucGxvdExlZnQtZyx0aGlzLnhBeGlzLmxlbi1mXTpbZixnXTtlbHNlIGlmKG0pbC5ncmFwaGljPW0uZGVzdHJveSgpfSxkcmF3VHJhY2tlcjpmdW5jdGlvbigpe3ZhciBhPVxudGhpcy5wb2ludHM7bWIuZHJhd1RyYWNrZXJQb2ludC5hcHBseSh0aGlzKTtvKGEsZnVuY3Rpb24oYil7dmFyIGM9Yi5ncmFwaGljO2MmJkUoYy5lbGVtZW50LFwibW91c2VvdmVyXCIsZnVuY3Rpb24oKXtpZihiLnN0YWNrSW5kZXg+MCYmIWIucmFpc2VkKWIuX3k9Yy55LGMuYXR0cih7eTpiLl95LTh9KSxiLnJhaXNlZD0hMDtvKGEsZnVuY3Rpb24oYSl7aWYoYSE9PWImJmEucmFpc2VkJiZhLmdyYXBoaWMpYS5ncmFwaGljLmF0dHIoe3k6YS5feX0pLGEucmFpc2VkPSExfSl9KX0pfSxhbmltYXRlOnJhLGJ1aWxkS0RUcmVlOnJhLHNldENsaXA6cmF9KTt2Yi5mbGFnPWZ1bmN0aW9uKGEsYixjLGQsZSl7cmV0dXJuW1wiTVwiLGUmJmUuYW5jaG9yWHx8YSxlJiZlLmFuY2hvcll8fGIsXCJMXCIsYSxiK2QsYSxiLGErYyxiLGErYyxiK2QsYSxiK2QsXCJaXCJdfTtvKFtcImNpcmNsZVwiLFwic3F1YXJlXCJdLGZ1bmN0aW9uKGEpe3ZiW2ErXCJwaW5cIl09ZnVuY3Rpb24oYixjLGQsZSxmKXt2YXIgZz1mJiZmLmFuY2hvclgsXG5mPWYmJmYuYW5jaG9yWTthPT09XCJjaXJjbGVcIiYmZT5kJiYoYi09eSgoZS1kKS8yKSxkPWUpO2I9dmJbYV0oYixjLGQsZSk7ZyYmZiYmYi5wdXNoKFwiTVwiLGcsYz5mP2M6YytlLFwiTFwiLGcsZik7cmV0dXJuIGJ9fSk7WGE9PT1CLlZNTFJlbmRlcmVyJiZvKFtcImZsYWdcIixcImNpcmNsZXBpblwiLFwic3F1YXJlcGluXCJdLGZ1bmN0aW9uKGEpe2xiLnByb3RvdHlwZS5zeW1ib2xzW2FdPXZiW2FdfSk7dmFyIGRhPVtdLmNvbmNhdChZYiksd2I9ZnVuY3Rpb24oYSl7dmFyIGI9RmEoYXJndW1lbnRzLGZ1bmN0aW9uKGEpe3JldHVybiBDKGEpfSk7aWYoYi5sZW5ndGgpcmV0dXJuIE1hdGhbYV0uYXBwbHkoMCxiKX07ZGFbNF09W1wiZGF5XCIsWzEsMiwzLDRdXTtkYVs1XT1bXCJ3ZWVrXCIsWzEsMiwzXV07QShSLHtuYXZpZ2F0b3I6e2hhbmRsZXM6e2JhY2tncm91bmRDb2xvcjpcIiNlYmU3ZThcIixib3JkZXJDb2xvcjpcIiNiMmIxYjZcIn0saGVpZ2h0OjQwLG1hcmdpbjoyNSxtYXNrRmlsbDpcInJnYmEoMTI4LDE3OSwyMzYsMC4zKVwiLFxubWFza0luc2lkZTohMCxvdXRsaW5lQ29sb3I6XCIjYjJiMWI2XCIsb3V0bGluZVdpZHRoOjEsc2VyaWVzOnt0eXBlOkkuYXJlYXNwbGluZT09PXQ/XCJsaW5lXCI6XCJhcmVhc3BsaW5lXCIsY29sb3I6XCIjNDU3MkE3XCIsY29tcGFyZTpudWxsLGZpbGxPcGFjaXR5OjAuMDUsZGF0YUdyb3VwaW5nOnthcHByb3hpbWF0aW9uOlwiYXZlcmFnZVwiLGVuYWJsZWQ6ITAsZ3JvdXBQaXhlbFdpZHRoOjIsc21vb3RoZWQ6ITAsdW5pdHM6ZGF9LGRhdGFMYWJlbHM6e2VuYWJsZWQ6ITEsekluZGV4OjJ9LGlkOlwiaGlnaGNoYXJ0cy1uYXZpZ2F0b3Itc2VyaWVzXCIsbGluZUNvbG9yOm51bGwsbGluZVdpZHRoOjEsbWFya2VyOntlbmFibGVkOiExfSxwb2ludFJhbmdlOjAsc2hhZG93OiExLHRocmVzaG9sZDpudWxsfSx4QXhpczp7dGlja1dpZHRoOjAsbGluZVdpZHRoOjAsZ3JpZExpbmVDb2xvcjpcIiNFRUVcIixncmlkTGluZVdpZHRoOjEsdGlja1BpeGVsSW50ZXJ2YWw6MjAwLGxhYmVsczp7YWxpZ246XCJsZWZ0XCIsc3R5bGU6e2NvbG9yOlwiIzg4OFwifSxcbng6Myx5Oi00fSxjcm9zc2hhaXI6ITF9LHlBeGlzOntncmlkTGluZVdpZHRoOjAsc3RhcnRPblRpY2s6ITEsZW5kT25UaWNrOiExLG1pblBhZGRpbmc6MC4xLG1heFBhZGRpbmc6MC4xLGxhYmVsczp7ZW5hYmxlZDohMX0sY3Jvc3NoYWlyOiExLHRpdGxlOnt0ZXh0Om51bGx9LHRpY2tXaWR0aDowfX0sc2Nyb2xsYmFyOntoZWlnaHQ6amI/MjA6MTQsYmFyQmFja2dyb3VuZENvbG9yOlwiI2JmYzhkMVwiLGJhckJvcmRlclJhZGl1czowLGJhckJvcmRlcldpZHRoOjEsYmFyQm9yZGVyQ29sb3I6XCIjYmZjOGQxXCIsYnV0dG9uQXJyb3dDb2xvcjpcIiM2NjZcIixidXR0b25CYWNrZ3JvdW5kQ29sb3I6XCIjZWJlN2U4XCIsYnV0dG9uQm9yZGVyQ29sb3I6XCIjYmJiXCIsYnV0dG9uQm9yZGVyUmFkaXVzOjAsYnV0dG9uQm9yZGVyV2lkdGg6MSxtaW5XaWR0aDo2LHJpZmxlQ29sb3I6XCIjNjY2XCIsdHJhY2tCYWNrZ3JvdW5kQ29sb3I6XCIjZWVlZWVlXCIsdHJhY2tCb3JkZXJDb2xvcjpcIiNlZWVlZWVcIix0cmFja0JvcmRlcldpZHRoOjEsXG5saXZlUmVkcmF3OmphJiYhamJ9fSk7R2IucHJvdG90eXBlPXtkcmF3SGFuZGxlOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5jaGFydC5yZW5kZXJlcixkPXRoaXMuZWxlbWVudHNUb0Rlc3Ryb3ksZT10aGlzLmhhbmRsZXMsZj10aGlzLm5hdmlnYXRvck9wdGlvbnMuaGFuZGxlcyxmPXtmaWxsOmYuYmFja2dyb3VuZENvbG9yLHN0cm9rZTpmLmJvcmRlckNvbG9yLFwic3Ryb2tlLXdpZHRoXCI6MX0sZzt0aGlzLnJlbmRlcmVkfHwoZVtiXT1jLmcoXCJuYXZpZ2F0b3ItaGFuZGxlLVwiK1tcImxlZnRcIixcInJpZ2h0XCJdW2JdKS5jc3Moe2N1cnNvcjpcImV3LXJlc2l6ZVwifSkuYXR0cih7ekluZGV4OjEwLWJ9KS5hZGQoKSxnPWMucmVjdCgtNC41LDAsOSwxNiwwLDEpLmF0dHIoZikuYWRkKGVbYl0pLGQucHVzaChnKSxnPWMucGF0aChbXCJNXCIsLTEuNSw0LFwiTFwiLC0xLjUsMTIsXCJNXCIsMC41LDQsXCJMXCIsMC41LDEyXSkuYXR0cihmKS5hZGQoZVtiXSksZC5wdXNoKGcpKTtlW2JdW3RoaXMucmVuZGVyZWQ/XG5cImFuaW1hdGVcIjpcImF0dHJcIl0oe3RyYW5zbGF0ZVg6dGhpcy5zY3JvbGxlckxlZnQrdGhpcy5zY3JvbGxiYXJIZWlnaHQrcGFyc2VJbnQoYSwxMCksdHJhbnNsYXRlWTp0aGlzLnRvcCt0aGlzLmhlaWdodC8yLTh9KX0sZHJhd1Njcm9sbGJhckJ1dHRvbjpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNoYXJ0LnJlbmRlcmVyLGM9dGhpcy5lbGVtZW50c1RvRGVzdHJveSxkPXRoaXMuc2Nyb2xsYmFyQnV0dG9ucyxlPXRoaXMuc2Nyb2xsYmFySGVpZ2h0LGY9dGhpcy5zY3JvbGxiYXJPcHRpb25zLGc7dGhpcy5yZW5kZXJlZHx8KGRbYV09Yi5nKCkuYWRkKHRoaXMuc2Nyb2xsYmFyR3JvdXApLGc9Yi5yZWN0KC0wLjUsLTAuNSxlKzEsZSsxLGYuYnV0dG9uQm9yZGVyUmFkaXVzLGYuYnV0dG9uQm9yZGVyV2lkdGgpLmF0dHIoe3N0cm9rZTpmLmJ1dHRvbkJvcmRlckNvbG9yLFwic3Ryb2tlLXdpZHRoXCI6Zi5idXR0b25Cb3JkZXJXaWR0aCxmaWxsOmYuYnV0dG9uQmFja2dyb3VuZENvbG9yfSkuYWRkKGRbYV0pLFxuYy5wdXNoKGcpLGc9Yi5wYXRoKFtcIk1cIixlLzIrKGE/LTE6MSksZS8yLTMsXCJMXCIsZS8yKyhhPy0xOjEpLGUvMiszLGUvMisoYT8yOi0yKSxlLzJdKS5hdHRyKHtmaWxsOmYuYnV0dG9uQXJyb3dDb2xvcn0pLmFkZChkW2FdKSxjLnB1c2goZykpO2EmJmRbYV0uYXR0cih7dHJhbnNsYXRlWDp0aGlzLnNjcm9sbGVyV2lkdGgtZX0pfSxyZW5kZXI6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9dGhpcy5jaGFydCxmPWUucmVuZGVyZXIsZyxoLGksaixrPXRoaXMuc2Nyb2xsYmFyR3JvdXAsbD10aGlzLm5hdmlnYXRvckdyb3VwLG09dGhpcy5zY3JvbGxiYXIsbD10aGlzLnhBeGlzLG49dGhpcy5zY3JvbGxiYXJUcmFjayxwPXRoaXMuc2Nyb2xsYmFySGVpZ2h0LG89dGhpcy5zY3JvbGxiYXJFbmFibGVkLHM9dGhpcy5uYXZpZ2F0b3JPcHRpb25zLHQ9dGhpcy5zY3JvbGxiYXJPcHRpb25zLHU9dC5taW5XaWR0aCx4PXRoaXMuaGVpZ2h0LEQ9dGhpcy50b3Asej10aGlzLm5hdmlnYXRvckVuYWJsZWQsXG5BPXMub3V0bGluZVdpZHRoLEI9QS8yLEU9MCxIPXRoaXMub3V0bGluZUhlaWdodCxLPXQuYmFyQm9yZGVyUmFkaXVzLEo9dC5iYXJCb3JkZXJXaWR0aCxJPUQrQixMPXRoaXMucmVuZGVyZWQ7aWYoQyhhKSYmQyhiKSYmKCF0aGlzLmhhc0RyYWdnZWR8fHYoYykpKXt0aGlzLm5hdmlnYXRvckxlZnQ9Zz1xKGwubGVmdCxlLnBsb3RMZWZ0K3ApO3RoaXMubmF2aWdhdG9yV2lkdGg9aD1xKGwubGVuLGUucGxvdFdpZHRoLTIqcCk7dGhpcy5zY3JvbGxlckxlZnQ9aT1nLXA7dGhpcy5zY3JvbGxlcldpZHRoPWo9aj1oKzIqcDtjPXEoYyxsLnRyYW5zbGF0ZShhKSk7ZD1xKGQsbC50cmFuc2xhdGUoYikpO2lmKCFDKGMpfHxTKGMpPT09SW5maW5pdHkpYz0wLGQ9ajtpZighKGwudHJhbnNsYXRlKGQsITApLWwudHJhbnNsYXRlKGMsITApPGUueEF4aXNbMF0ubWluUmFuZ2UpKXt0aGlzLnpvb21lZE1heD1HKHcoYyxkLDApLGgpO3RoaXMuem9vbWVkTWluPUcodyh0aGlzLmZpeGVkV2lkdGg/dGhpcy56b29tZWRNYXgtXG50aGlzLmZpeGVkV2lkdGg6RyhjLGQpLDApLGgpO3RoaXMucmFuZ2U9dGhpcy56b29tZWRNYXgtdGhpcy56b29tZWRNaW47Yz15KHRoaXMuem9vbWVkTWF4KTtiPXkodGhpcy56b29tZWRNaW4pO2E9Yy1iO2lmKCFMKXtpZih6KXRoaXMubmF2aWdhdG9yR3JvdXA9bD1mLmcoXCJuYXZpZ2F0b3JcIikuYXR0cih7ekluZGV4OjN9KS5hZGQoKSx0aGlzLmxlZnRTaGFkZT1mLnJlY3QoKS5hdHRyKHtmaWxsOnMubWFza0ZpbGx9KS5hZGQobCkscy5tYXNrSW5zaWRlP3RoaXMubGVmdFNoYWRlLmNzcyh7Y3Vyc29yOlwiZXctcmVzaXplXCJ9KTp0aGlzLnJpZ2h0U2hhZGU9Zi5yZWN0KCkuYXR0cih7ZmlsbDpzLm1hc2tGaWxsfSkuYWRkKGwpLHRoaXMub3V0bGluZT1mLnBhdGgoKS5hdHRyKHtcInN0cm9rZS13aWR0aFwiOkEsc3Ryb2tlOnMub3V0bGluZUNvbG9yfSkuYWRkKGwpO2lmKG8pdGhpcy5zY3JvbGxiYXJHcm91cD1rPWYuZyhcInNjcm9sbGJhclwiKS5hZGQoKSxtPXQudHJhY2tCb3JkZXJXaWR0aCxcbnRoaXMuc2Nyb2xsYmFyVHJhY2s9bj1mLnJlY3QoKS5hdHRyKHt4OjAseTotbSUyLzIsZmlsbDp0LnRyYWNrQmFja2dyb3VuZENvbG9yLHN0cm9rZTp0LnRyYWNrQm9yZGVyQ29sb3IsXCJzdHJva2Utd2lkdGhcIjptLHI6dC50cmFja0JvcmRlclJhZGl1c3x8MCxoZWlnaHQ6cH0pLmFkZChrKSx0aGlzLnNjcm9sbGJhcj1tPWYucmVjdCgpLmF0dHIoe3k6LUolMi8yLGhlaWdodDpwLGZpbGw6dC5iYXJCYWNrZ3JvdW5kQ29sb3Isc3Ryb2tlOnQuYmFyQm9yZGVyQ29sb3IsXCJzdHJva2Utd2lkdGhcIjpKLHI6S30pLmFkZChrKSx0aGlzLnNjcm9sbGJhclJpZmxlcz1mLnBhdGgoKS5hdHRyKHtzdHJva2U6dC5yaWZsZUNvbG9yLFwic3Ryb2tlLXdpZHRoXCI6MX0pLmFkZChrKX1mPUw/XCJhbmltYXRlXCI6XCJhdHRyXCI7aWYoeil7dGhpcy5sZWZ0U2hhZGVbZl0ocy5tYXNrSW5zaWRlP3t4OmcrYix5OkQsd2lkdGg6Yy1iLGhlaWdodDp4fTp7eDpnLHk6RCx3aWR0aDpiLGhlaWdodDp4fSk7aWYodGhpcy5yaWdodFNoYWRlKXRoaXMucmlnaHRTaGFkZVtmXSh7eDpnK1xuYyx5OkQsd2lkdGg6aC1jLGhlaWdodDp4fSk7dGhpcy5vdXRsaW5lW2ZdKHtkOltcIk1cIixpLEksXCJMXCIsZytiLUIsSSxnK2ItQixJK0gsXCJMXCIsZytjLUIsSStILFwiTFwiLGcrYy1CLEksaStqLEldLmNvbmNhdChzLm1hc2tJbnNpZGU/W1wiTVwiLGcrYitCLEksXCJMXCIsZytjLUIsSV06W10pfSk7dGhpcy5kcmF3SGFuZGxlKGIrQiwwKTt0aGlzLmRyYXdIYW5kbGUoYytCLDEpfWlmKG8mJmspdGhpcy5kcmF3U2Nyb2xsYmFyQnV0dG9uKDApLHRoaXMuZHJhd1Njcm9sbGJhckJ1dHRvbigxKSxrW2ZdKHt0cmFuc2xhdGVYOmksdHJhbnNsYXRlWTp5KEkreCl9KSxuW2ZdKHt3aWR0aDpqfSksZz1wK2IsaD1hLUosaDx1JiYoRT0odS1oKS8yLGg9dSxnLT1FKSx0aGlzLnNjcm9sbGJhclBhZD1FLG1bZl0oe3g6VihnKStKJTIvMix3aWR0aDpofSksdT1wK2IrYS8yLTAuNSx0aGlzLnNjcm9sbGJhclJpZmxlcy5hdHRyKHt2aXNpYmlsaXR5OmE+MTI/XCJ2aXNpYmxlXCI6XCJoaWRkZW5cIn0pW2ZdKHtkOltcIk1cIixcbnUtMyxwLzQsXCJMXCIsdS0zLDIqcC8zLFwiTVwiLHUscC80LFwiTFwiLHUsMipwLzMsXCJNXCIsdSszLHAvNCxcIkxcIix1KzMsMipwLzNdfSk7dGhpcy5zY3JvbGxiYXJQYWQ9RTt0aGlzLnJlbmRlcmVkPSEwfX19LGFkZEV2ZW50czpmdW5jdGlvbigpe3ZhciBhPXRoaXMuY2hhcnQsYj1hLmNvbnRhaW5lcixjPXRoaXMubW91c2VEb3duSGFuZGxlcixkPXRoaXMubW91c2VNb3ZlSGFuZGxlcixlPXRoaXMubW91c2VVcEhhbmRsZXIsZjtmPVtbYixcIm1vdXNlZG93blwiLGNdLFtiLFwibW91c2Vtb3ZlXCIsZF0sW0gsXCJtb3VzZXVwXCIsZV1dO2NiJiZmLnB1c2goW2IsXCJ0b3VjaHN0YXJ0XCIsY10sW2IsXCJ0b3VjaG1vdmVcIixkXSxbSCxcInRvdWNoZW5kXCIsZV0pO28oZixmdW5jdGlvbihhKXtFLmFwcGx5KG51bGwsYSl9KTt0aGlzLl9ldmVudHM9Zjt0aGlzLnNlcmllcyYmRSh0aGlzLnNlcmllcy54QXhpcyxcImZvdW5kRXh0cmVtZXNcIixmdW5jdGlvbigpe2Euc2Nyb2xsZXIubW9kaWZ5TmF2aWdhdG9yQXhpc0V4dHJlbWVzKCl9KTtcbkUoYSxcInJlZHJhd1wiLGZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5zY3JvbGxlcixiO2lmKGEpKGI9YS5iYXNlU2VyaWVzLnhBeGlzKSYmYS5yZW5kZXIoYi5taW4sYi5tYXgpfSl9LHJlbW92ZUV2ZW50czpmdW5jdGlvbigpe28odGhpcy5fZXZlbnRzLGZ1bmN0aW9uKGEpe1QuYXBwbHkobnVsbCxhKX0pO3RoaXMuX2V2ZW50cz10O3RoaXMubmF2aWdhdG9yRW5hYmxlZCYmdGhpcy5iYXNlU2VyaWVzJiZUKHRoaXMuYmFzZVNlcmllcyxcInVwZGF0ZWREYXRhXCIsdGhpcy51cGRhdGVkRGF0YUhhbmRsZXIpfSxpbml0OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEuY2hhcnQsYyxkLGU9YS5zY3JvbGxiYXJIZWlnaHQsZj1hLm5hdmlnYXRvck9wdGlvbnMsZz1hLmhlaWdodCxoPWEudG9wLGksaj1hLmJhc2VTZXJpZXM7YS5tb3VzZURvd25IYW5kbGVyPWZ1bmN0aW9uKGQpe3ZhciBkPWIucG9pbnRlci5ub3JtYWxpemUoZCksZT1hLnpvb21lZE1pbixmPWEuem9vbWVkTWF4LGg9YS50b3Asaj1hLnNjcm9sbGJhckhlaWdodCxcbms9YS5zY3JvbGxlckxlZnQsbD1hLnNjcm9sbGVyV2lkdGgsbz1hLm5hdmlnYXRvckxlZnQscT1hLm5hdmlnYXRvcldpZHRoLHY9YS5zY3JvbGxiYXJQYWQsdD1hLnJhbmdlLHc9ZC5jaGFydFgseT1kLmNoYXJ0WSxkPWIueEF4aXNbMF0seixBPWpiPzEwOjc7aWYoeT5oJiZ5PGgrZytqKWlmKChoPSFhLnNjcm9sbGJhckVuYWJsZWR8fHk8aCtnKSYmWS5hYnMody1lLW8pPEEpYS5ncmFiYmVkTGVmdD0hMCxhLm90aGVySGFuZGxlUG9zPWYsYS5maXhlZEV4dHJlbWU9ZC5tYXgsYi5maXhlZFJhbmdlPW51bGw7ZWxzZSBpZihoJiZZLmFicyh3LWYtbyk8QSlhLmdyYWJiZWRSaWdodD0hMCxhLm90aGVySGFuZGxlUG9zPWUsYS5maXhlZEV4dHJlbWU9ZC5taW4sYi5maXhlZFJhbmdlPW51bGw7ZWxzZSBpZih3Pm8rZS12JiZ3PG8rZit2KWEuZ3JhYmJlZENlbnRlcj13LGEuZml4ZWRXaWR0aD10LGk9dy1lO2Vsc2UgaWYodz5rJiZ3PGsrbCl7Zj1oP3ctby10LzI6dzxvP2UtdCowLjI6dz5rK1xubC1qP2UrdCowLjI6dzxvK2U/ZS10OmY7aWYoZjwwKWY9MDtlbHNlIGlmKGYrdD49cSlmPXEtdCx6PWEuZ2V0VW5pb25FeHRyZW1lcygpLmRhdGFNYXg7aWYoZiE9PWUpYS5maXhlZFdpZHRoPXQsZT1jLnRvRml4ZWRSYW5nZShmLGYrdCxudWxsLHopLGQuc2V0RXh0cmVtZXMoZS5taW4sZS5tYXgsITAsITEse3RyaWdnZXI6XCJuYXZpZ2F0b3JcIn0pfX07YS5tb3VzZU1vdmVIYW5kbGVyPWZ1bmN0aW9uKGMpe3ZhciBkPWEuc2Nyb2xsYmFySGVpZ2h0LGU9YS5uYXZpZ2F0b3JMZWZ0LGY9YS5uYXZpZ2F0b3JXaWR0aCxnPWEuc2Nyb2xsZXJMZWZ0LGg9YS5zY3JvbGxlcldpZHRoLGo9YS5yYW5nZSxrLGw7aWYoIWMudG91Y2hlc3x8Yy50b3VjaGVzWzBdLnBhZ2VYIT09MCljPWIucG9pbnRlci5ub3JtYWxpemUoYyksaz1jLmNoYXJ0WCxrPGU/az1lOms+ZytoLWQmJihrPWcraC1kKSxhLmdyYWJiZWRMZWZ0PyhsPSEwLGEucmVuZGVyKDAsMCxrLWUsYS5vdGhlckhhbmRsZVBvcykpOmEuZ3JhYmJlZFJpZ2h0P1xuKGw9ITAsYS5yZW5kZXIoMCwwLGEub3RoZXJIYW5kbGVQb3Msay1lKSk6YS5ncmFiYmVkQ2VudGVyJiYobD0hMCxrPGk/az1pOms+ZitpLWomJihrPWYraS1qKSxhLnJlbmRlcigwLDAsay1pLGstaStqKSksbCYmYS5zY3JvbGxiYXJPcHRpb25zLmxpdmVSZWRyYXcmJnNldFRpbWVvdXQoZnVuY3Rpb24oKXthLm1vdXNlVXBIYW5kbGVyKGMpfSwwKSxhLmhhc0RyYWdnZWQ9bH07YS5tb3VzZVVwSGFuZGxlcj1mdW5jdGlvbihkKXt2YXIgZSxmO2lmKGEuaGFzRHJhZ2dlZCl7aWYoYS56b29tZWRNaW49PT1hLm90aGVySGFuZGxlUG9zKWU9YS5maXhlZEV4dHJlbWU7ZWxzZSBpZihhLnpvb21lZE1heD09PWEub3RoZXJIYW5kbGVQb3MpZj1hLmZpeGVkRXh0cmVtZTtpZihhLnpvb21lZE1heD09PWEubmF2aWdhdG9yV2lkdGgpZj1hLmdldFVuaW9uRXh0cmVtZXMoKS5kYXRhTWF4O2U9Yy50b0ZpeGVkUmFuZ2UoYS56b29tZWRNaW4sYS56b29tZWRNYXgsZSxmKTt2KGUubWluKSYmYi54QXhpc1swXS5zZXRFeHRyZW1lcyhlLm1pbixcbmUubWF4LCEwLCExLHt0cmlnZ2VyOlwibmF2aWdhdG9yXCIsdHJpZ2dlck9wOlwibmF2aWdhdG9yLWRyYWdcIixET01FdmVudDpkfSl9aWYoZC50eXBlIT09XCJtb3VzZW1vdmVcIilhLmdyYWJiZWRMZWZ0PWEuZ3JhYmJlZFJpZ2h0PWEuZ3JhYmJlZENlbnRlcj1hLmZpeGVkV2lkdGg9YS5maXhlZEV4dHJlbWU9YS5vdGhlckhhbmRsZVBvcz1hLmhhc0RyYWdnZWQ9aT1udWxsfTt2YXIgaz1iLnhBeGlzLmxlbmd0aCxsPWIueUF4aXMubGVuZ3RoO2IuZXh0cmFCb3R0b21NYXJnaW49YS5vdXRsaW5lSGVpZ2h0K2YubWFyZ2luO2EubmF2aWdhdG9yRW5hYmxlZD8oYS54QXhpcz1jPW5ldyBKKGIseih7YnJlYWtzOmomJmoueEF4aXMub3B0aW9ucy5icmVha3Msb3JkaW5hbDpqJiZqLnhBeGlzLm9wdGlvbnMub3JkaW5hbH0sZi54QXhpcyx7aWQ6XCJuYXZpZ2F0b3IteC1heGlzXCIsaXNYOiEwLHR5cGU6XCJkYXRldGltZVwiLGluZGV4OmssaGVpZ2h0Omcsb2Zmc2V0OjAsb2Zmc2V0TGVmdDplLG9mZnNldFJpZ2h0Oi1lLFxua2VlcE9yZGluYWxQYWRkaW5nOiEwLHN0YXJ0T25UaWNrOiExLGVuZE9uVGljazohMSxtaW5QYWRkaW5nOjAsbWF4UGFkZGluZzowLHpvb21FbmFibGVkOiExfSkpLGEueUF4aXM9ZD1uZXcgSihiLHooZi55QXhpcyx7aWQ6XCJuYXZpZ2F0b3IteS1heGlzXCIsYWxpZ25UaWNrczohMSxoZWlnaHQ6ZyxvZmZzZXQ6MCxpbmRleDpsLHpvb21FbmFibGVkOiExfSkpLGp8fGYuc2VyaWVzLmRhdGE/YS5hZGRCYXNlU2VyaWVzKCk6Yi5zZXJpZXMubGVuZ3RoPT09MCYmVShiLFwicmVkcmF3XCIsZnVuY3Rpb24oYyxkKXtpZihiLnNlcmllcy5sZW5ndGg+MCYmIWEuc2VyaWVzKWEuc2V0QmFzZVNlcmllcygpLGIucmVkcmF3PWM7Yy5jYWxsKGIsZCl9KSk6YS54QXhpcz1jPXt0cmFuc2xhdGU6ZnVuY3Rpb24oYSxjKXt2YXIgZD1iLnhBeGlzWzBdLGY9ZC5nZXRFeHRyZW1lcygpLGc9Yi5wbG90V2lkdGgtMiplLGg9d2IoXCJtaW5cIixkLm9wdGlvbnMubWluLGYuZGF0YU1pbiksZD13YihcIm1heFwiLGQub3B0aW9ucy5tYXgsXG5mLmRhdGFNYXgpLWg7cmV0dXJuIGM/YSpkL2craDpnKihhLWgpL2R9LHRvRml4ZWRSYW5nZTpKLnByb3RvdHlwZS50b0ZpeGVkUmFuZ2V9O2lmKGomJmoueEF4aXMmJnRoaXMubmF2aWdhdG9yT3B0aW9ucy5hZGFwdFRvVXBkYXRlZERhdGEhPT0hMSlFKGosXCJ1cGRhdGVkRGF0YVwiLHRoaXMudXBkYXRlZERhdGFIYW5kbGVyKSxFKGoueEF4aXMsXCJmb3VuZEV4dHJlbWVzXCIsZnVuY3Rpb24oKXtqLnhBeGlzJiZ0aGlzLmNoYXJ0LnNjcm9sbGVyLm1vZGlmeUJhc2VBeGlzRXh0cmVtZXMoKX0pLGoudXNlck9wdGlvbnMuZXZlbnRzPUEoai51c2VyT3B0aW9ucy5ldmVudCx7dXBkYXRlZERhdGE6dGhpcy51cGRhdGVkRGF0YUhhbmRsZXJ9KTtVKGIsXCJnZXRNYXJnaW5zXCIsZnVuY3Rpb24oYil7dmFyIGU9dGhpcy5sZWdlbmQsZj1lLm9wdGlvbnM7Yi5hcHBseSh0aGlzLFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpKTthLnRvcD1oPWEubmF2aWdhdG9yT3B0aW9ucy50b3B8fHRoaXMuY2hhcnRIZWlnaHQtXG5hLmhlaWdodC1hLnNjcm9sbGJhckhlaWdodC10aGlzLnNwYWNpbmdbMl0tKGYudmVydGljYWxBbGlnbj09PVwiYm90dG9tXCImJmYuZW5hYmxlZCYmIWYuZmxvYXRpbmc/ZS5sZWdlbmRIZWlnaHQrcShmLm1hcmdpbiwxMCk6MCk7aWYoYyYmZCljLm9wdGlvbnMudG9wPWQub3B0aW9ucy50b3A9aCxjLnNldEF4aXNTaXplKCksZC5zZXRBeGlzU2l6ZSgpfSk7YS5hZGRFdmVudHMoKX0sZ2V0VW5pb25FeHRyZW1lczpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNoYXJ0LnhBeGlzWzBdLGM9dGhpcy54QXhpcyxkPWMub3B0aW9ucyxlPWIub3B0aW9ucyxmO2lmKCFhfHxiLmRhdGFNaW4hPT1udWxsKWY9e2RhdGFNaW46cShkJiZkLm1pbix3YihcIm1pblwiLGUubWluLGIuZGF0YU1pbixjLmRhdGFNaW4sYy5taW4pKSxkYXRhTWF4OnEoZCYmZC5tYXgsd2IoXCJtYXhcIixlLm1heCxiLmRhdGFNYXgsYy5kYXRhTWF4LGMubWF4KSl9O3JldHVybiBmfSxzZXRCYXNlU2VyaWVzOmZ1bmN0aW9uKGEpe3ZhciBiPVxudGhpcy5jaGFydCxhPWF8fGIub3B0aW9ucy5uYXZpZ2F0b3IuYmFzZVNlcmllczt0aGlzLnNlcmllcyYmdGhpcy5zZXJpZXMucmVtb3ZlKCk7dGhpcy5iYXNlU2VyaWVzPWIuc2VyaWVzW2FdfHx0eXBlb2YgYT09PVwic3RyaW5nXCImJmIuZ2V0KGEpfHxiLnNlcmllc1swXTt0aGlzLnhBeGlzJiZ0aGlzLmFkZEJhc2VTZXJpZXMoKX0sYWRkQmFzZVNlcmllczpmdW5jdGlvbigpe3ZhciBhPXRoaXMuYmFzZVNlcmllcyxiPWE/YS5vcHRpb25zOnt9LGE9Yi5kYXRhLGM9dGhpcy5uYXZpZ2F0b3JPcHRpb25zLnNlcmllcyxkO2Q9Yy5kYXRhO3RoaXMuaGFzTmF2aWdhdG9yRGF0YT0hIWQ7Yj16KGIsYyx7ZW5hYmxlTW91c2VUcmFja2luZzohMSxncm91cDpcIm5hdlwiLHBhZFhBeGlzOiExLHhBeGlzOlwibmF2aWdhdG9yLXgtYXhpc1wiLHlBeGlzOlwibmF2aWdhdG9yLXktYXhpc1wiLG5hbWU6XCJOYXZpZ2F0b3JcIixzaG93SW5MZWdlbmQ6ITEsc3RhY2tpbmc6ITEsaXNJbnRlcm5hbDohMCx2aXNpYmxlOiEwfSk7XG5iLmRhdGE9ZHx8YS5zbGljZSgwKTt0aGlzLnNlcmllcz10aGlzLmNoYXJ0LmluaXRTZXJpZXMoYil9LG1vZGlmeU5hdmlnYXRvckF4aXNFeHRyZW1lczpmdW5jdGlvbigpe3ZhciBhPXRoaXMueEF4aXMsYjtpZihhLmdldEV4dHJlbWVzJiYoYj10aGlzLmdldFVuaW9uRXh0cmVtZXMoITApKSYmKGIuZGF0YU1pbiE9PWEubWlufHxiLmRhdGFNYXghPT1hLm1heCkpYS5taW49Yi5kYXRhTWluLGEubWF4PWIuZGF0YU1heH0sbW9kaWZ5QmFzZUF4aXNFeHRyZW1lczpmdW5jdGlvbigpe3ZhciBhPXRoaXMuYmFzZVNlcmllcy54QXhpcyxiPWEuZ2V0RXh0cmVtZXMoKSxjPWIuZGF0YU1pbixkPWIuZGF0YU1heCxiPWIubWF4LWIubWluLGU9dGhpcy5zdGlja1RvTWluLGY9dGhpcy5zdGlja1RvTWF4LGcsaCxpPXRoaXMuc2VyaWVzLGo9ISFhLnNldEV4dHJlbWVzO2UmJihoPWMsZz1oK2IpO2YmJihnPWQsZXx8KGg9dyhnLWIsaT9pLnhEYXRhWzBdOi1OdW1iZXIuTUFYX1ZBTFVFKSkpO2lmKGomJlxuKGV8fGYpJiZDKGgpKWEubWluPWEudXNlck1pbj1oLGEubWF4PWEudXNlck1heD1nO3RoaXMuc3RpY2tUb01pbj10aGlzLnN0aWNrVG9NYXg9bnVsbH0sdXBkYXRlZERhdGFIYW5kbGVyOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5jaGFydC5zY3JvbGxlcixiPWEuYmFzZVNlcmllcyxjPWEuc2VyaWVzO2Euc3RpY2tUb01pbj1iLnhBeGlzLm1pbjw9Yi54RGF0YVswXTthLnN0aWNrVG9NYXg9YS56b29tZWRNYXg+PWEubmF2aWdhdG9yV2lkdGg7aWYoYyYmIWEuaGFzTmF2aWdhdG9yRGF0YSYmKGMub3B0aW9ucy5wb2ludFN0YXJ0PWIueERhdGFbMF0sYy5zZXREYXRhKGIub3B0aW9ucy5kYXRhLCExKSxjLmdyYXBoJiZiLmdyYXBoKSljLmdyYXBoLnNoaWZ0PWIuZ3JhcGguc2hpZnR9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLnJlbW92ZUV2ZW50cygpO28oW3RoaXMueEF4aXMsdGhpcy55QXhpcyx0aGlzLmxlZnRTaGFkZSx0aGlzLnJpZ2h0U2hhZGUsdGhpcy5vdXRsaW5lLHRoaXMuc2Nyb2xsYmFyVHJhY2ssXG50aGlzLnNjcm9sbGJhclJpZmxlcyx0aGlzLnNjcm9sbGJhckdyb3VwLHRoaXMuc2Nyb2xsYmFyXSxmdW5jdGlvbihhKXthJiZhLmRlc3Ryb3kmJmEuZGVzdHJveSgpfSk7dGhpcy54QXhpcz10aGlzLnlBeGlzPXRoaXMubGVmdFNoYWRlPXRoaXMucmlnaHRTaGFkZT10aGlzLm91dGxpbmU9dGhpcy5zY3JvbGxiYXJUcmFjaz10aGlzLnNjcm9sbGJhclJpZmxlcz10aGlzLnNjcm9sbGJhckdyb3VwPXRoaXMuc2Nyb2xsYmFyPW51bGw7byhbdGhpcy5zY3JvbGxiYXJCdXR0b25zLHRoaXMuaGFuZGxlcyx0aGlzLmVsZW1lbnRzVG9EZXN0cm95XSxmdW5jdGlvbihhKXtQYShhKX0pfX07Qi5TY3JvbGxlcj1HYjtVKEoucHJvdG90eXBlLFwiem9vbVwiLGZ1bmN0aW9uKGEsYixjKXt2YXIgZD10aGlzLmNoYXJ0LGU9ZC5vcHRpb25zLGY9ZS5jaGFydC56b29tVHlwZSxnPWUubmF2aWdhdG9yLGU9ZS5yYW5nZVNlbGVjdG9yLGg7aWYodGhpcy5pc1hBeGlzJiYoZyYmZy5lbmFibGVkfHxlJiZlLmVuYWJsZWQpKWlmKGY9PT1cblwieFwiKWQucmVzZXRab29tQnV0dG9uPVwiYmxvY2tlZFwiO2Vsc2UgaWYoZj09PVwieVwiKWg9ITE7ZWxzZSBpZihmPT09XCJ4eVwiKWQ9dGhpcy5wcmV2aW91c1pvb20sdihiKT90aGlzLnByZXZpb3VzWm9vbT1bdGhpcy5taW4sdGhpcy5tYXhdOmQmJihiPWRbMF0sYz1kWzFdLGRlbGV0ZSB0aGlzLnByZXZpb3VzWm9vbSk7cmV0dXJuIGghPT10P2g6YS5jYWxsKHRoaXMsYixjKX0pO1UoQmEucHJvdG90eXBlLFwiaW5pdFwiLGZ1bmN0aW9uKGEsYixjKXtFKHRoaXMsXCJiZWZvcmVSZW5kZXJcIixmdW5jdGlvbigpe3ZhciBhPXRoaXMub3B0aW9ucztpZihhLm5hdmlnYXRvci5lbmFibGVkfHxhLnNjcm9sbGJhci5lbmFibGVkKXRoaXMuc2Nyb2xsZXI9bmV3IEdiKHRoaXMpfSk7YS5jYWxsKHRoaXMsYixjKX0pO1UoUC5wcm90b3R5cGUsXCJhZGRQb2ludFwiLGZ1bmN0aW9uKGEsYixjLGQsZSl7dmFyIGY9dGhpcy5vcHRpb25zLnR1cmJvVGhyZXNob2xkO2YmJnRoaXMueERhdGEubGVuZ3RoPmYmJmVhKGIpJiZcbiFKYShiKSYmdGhpcy5jaGFydC5zY3JvbGxlciYmZ2EoMjAsITApO2EuY2FsbCh0aGlzLGIsYyxkLGUpfSk7QShSLHtyYW5nZVNlbGVjdG9yOntidXR0b25UaGVtZTp7d2lkdGg6MjgsaGVpZ2h0OjE4LGZpbGw6XCIjZjdmN2Y3XCIscGFkZGluZzoyLHI6MCxcInN0cm9rZS13aWR0aFwiOjAsc3R5bGU6e2NvbG9yOlwiIzQ0NFwiLGN1cnNvcjpcInBvaW50ZXJcIixmb250V2VpZ2h0Olwibm9ybWFsXCJ9LHpJbmRleDo3LHN0YXRlczp7aG92ZXI6e2ZpbGw6XCIjZTdlN2U3XCJ9LHNlbGVjdDp7ZmlsbDpcIiNlN2YwZjlcIixzdHlsZTp7Y29sb3I6XCJibGFja1wiLGZvbnRXZWlnaHQ6XCJib2xkXCJ9fX19LGhlaWdodDozNSxpbnB1dFBvc2l0aW9uOnthbGlnbjpcInJpZ2h0XCJ9LGxhYmVsU3R5bGU6e2NvbG9yOlwiIzY2NlwifX19KTtSLmxhbmc9eihSLmxhbmcse3JhbmdlU2VsZWN0b3Jab29tOlwiWm9vbVwiLHJhbmdlU2VsZWN0b3JGcm9tOlwiRnJvbVwiLHJhbmdlU2VsZWN0b3JUbzpcIlRvXCJ9KTtIYi5wcm90b3R5cGU9e2NsaWNrQnV0dG9uOmZ1bmN0aW9uKGEsXG5iKXt2YXIgYz10aGlzLGQ9Yy5zZWxlY3RlZCxlPWMuY2hhcnQsZj1jLmJ1dHRvbnMsZz1jLmJ1dHRvbk9wdGlvbnNbYV0saD1lLnhBeGlzWzBdLGk9ZS5zY3JvbGxlciYmZS5zY3JvbGxlci5nZXRVbmlvbkV4dHJlbWVzKCl8fGh8fHt9LGo9aS5kYXRhTWluLGs9aS5kYXRhTWF4LGwsbT1oJiZ5KEcoaC5tYXgscShrLGgubWF4KSkpLG49Zy50eXBlLHAsaT1nLl9yYW5nZSxyLHMsdix1PWcuZGF0YUdyb3VwaW5nO2lmKCEoaj09PW51bGx8fGs9PT1udWxsfHxhPT09Yy5zZWxlY3RlZCkpe2UuZml4ZWRSYW5nZT1pO2lmKHUpdGhpcy5mb3JjZWREYXRhR3JvdXBpbmc9ITAsSi5wcm90b3R5cGUuc2V0RGF0YUdyb3VwaW5nLmNhbGwoaHx8e2NoYXJ0OnRoaXMuY2hhcnR9LHUsITEpO2lmKG49PT1cIm1vbnRoXCJ8fG49PT1cInllYXJcIilpZihoKXtpZihuPXtyYW5nZTpnLG1heDptLGRhdGFNaW46aixkYXRhTWF4Omt9LGw9aC5taW5Gcm9tUmFuZ2UuY2FsbChuKSxDKG4ubmV3TWF4KSltPW4ubmV3TWF4fWVsc2UgaT1cbmc7ZWxzZSBpZihpKWw9dyhtLWksaiksbT1HKGwraSxrKTtlbHNlIGlmKG49PT1cInl0ZFwiKWlmKGgpe2lmKGs9PT10KWo9TnVtYmVyLk1BWF9WQUxVRSxrPU51bWJlci5NSU5fVkFMVUUsbyhlLnNlcmllcyxmdW5jdGlvbihhKXthPWEueERhdGE7aj1HKGFbMF0saik7az13KGFbYS5sZW5ndGgtMV0sayl9KSxiPSExO209bmV3IGJhKGspO2w9bS5nZXRGdWxsWWVhcigpO2w9cj13KGp8fDAsYmEuVVRDKGwsMCwxKSk7bT1tLmdldFRpbWUoKTttPUcoa3x8bSxtKX1lbHNle0UoZSxcImJlZm9yZVJlbmRlclwiLGZ1bmN0aW9uKCl7Yy5jbGlja0J1dHRvbihhKX0pO3JldHVybn1lbHNlIG49PT1cImFsbFwiJiZoJiYobD1qLG09ayk7ZltkXSYmZltkXS5zZXRTdGF0ZSgwKTtpZihmW2FdKWZbYV0uc2V0U3RhdGUoMiksYy5sYXN0U2VsZWN0ZWQ9YTtoPyhoLnNldEV4dHJlbWVzKGwsbSxxKGIsMSksMCx7dHJpZ2dlcjpcInJhbmdlU2VsZWN0b3JCdXR0b25cIixyYW5nZVNlbGVjdG9yQnV0dG9uOmd9KSxjLnNldFNlbGVjdGVkKGEpKTpcbihwPWUub3B0aW9ucy54QXhpc1swXSx2PXAucmFuZ2UscC5yYW5nZT1pLHM9cC5taW4scC5taW49cixjLnNldFNlbGVjdGVkKGEpLEUoZSxcImxvYWRcIixmdW5jdGlvbigpe3AucmFuZ2U9djtwLm1pbj1zfSkpfX0sc2V0U2VsZWN0ZWQ6ZnVuY3Rpb24oYSl7dGhpcy5zZWxlY3RlZD10aGlzLm9wdGlvbnMuc2VsZWN0ZWQ9YX0sZGVmYXVsdEJ1dHRvbnM6W3t0eXBlOlwibW9udGhcIixjb3VudDoxLHRleHQ6XCIxbVwifSx7dHlwZTpcIm1vbnRoXCIsY291bnQ6Myx0ZXh0OlwiM21cIn0se3R5cGU6XCJtb250aFwiLGNvdW50OjYsdGV4dDpcIjZtXCJ9LHt0eXBlOlwieXRkXCIsdGV4dDpcIllURFwifSx7dHlwZTpcInllYXJcIixjb3VudDoxLHRleHQ6XCIxeVwifSx7dHlwZTpcImFsbFwiLHRleHQ6XCJBbGxcIn1dLGluaXQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcyxjPWEub3B0aW9ucy5yYW5nZVNlbGVjdG9yLGQ9Yy5idXR0b25zfHxbXS5jb25jYXQoYi5kZWZhdWx0QnV0dG9ucyksZT1jLnNlbGVjdGVkLGY9Yi5ibHVySW5wdXRzPVxuZnVuY3Rpb24oKXt2YXIgYT1iLm1pbklucHV0LGM9Yi5tYXhJbnB1dDthJiZhLmJsdXImJk8oYSxcImJsdXJcIik7YyYmYy5ibHVyJiZPKGMsXCJibHVyXCIpfTtiLmNoYXJ0PWE7Yi5vcHRpb25zPWM7Yi5idXR0b25zPVtdO2EuZXh0cmFUb3BNYXJnaW49Yy5oZWlnaHQ7Yi5idXR0b25PcHRpb25zPWQ7RShhLmNvbnRhaW5lcixcIm1vdXNlZG93blwiLGYpO0UoYSxcInJlc2l6ZVwiLGYpO28oZCxiLmNvbXB1dGVCdXR0b25SYW5nZSk7ZSE9PXQmJmRbZV0mJnRoaXMuY2xpY2tCdXR0b24oZSwhMSk7RShhLFwibG9hZFwiLGZ1bmN0aW9uKCl7RShhLnhBeGlzWzBdLFwic2V0RXh0cmVtZXNcIixmdW5jdGlvbihjKXt0aGlzLm1heC10aGlzLm1pbiE9PWEuZml4ZWRSYW5nZSYmYy50cmlnZ2VyIT09XCJyYW5nZVNlbGVjdG9yQnV0dG9uXCImJmMudHJpZ2dlciE9PVwidXBkYXRlZERhdGFcIiYmYi5mb3JjZWREYXRhR3JvdXBpbmcmJnRoaXMuc2V0RGF0YUdyb3VwaW5nKCExLCExKX0pO0UoYS54QXhpc1swXSxcImFmdGVyU2V0RXh0cmVtZXNcIixcbmZ1bmN0aW9uKCl7Yi51cGRhdGVCdXR0b25TdGF0ZXMoITApfSl9KX0sdXBkYXRlQnV0dG9uU3RhdGVzOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMsYz10aGlzLmNoYXJ0LGQ9Yy54QXhpc1swXSxlPWMuc2Nyb2xsZXImJmMuc2Nyb2xsZXIuZ2V0VW5pb25FeHRyZW1lcygpfHxkLGY9ZS5kYXRhTWluLGc9ZS5kYXRhTWF4LGg9Yi5zZWxlY3RlZCxpPWIub3B0aW9ucy5hbGxCdXR0b25zRW5hYmxlZCxqPWIuYnV0dG9uczthJiZjLmZpeGVkUmFuZ2UhPT15KGQubWF4LWQubWluKSYmKGpbaF0mJmpbaF0uc2V0U3RhdGUoMCksYi5zZXRTZWxlY3RlZChudWxsKSk7byhiLmJ1dHRvbk9wdGlvbnMsZnVuY3Rpb24oYSxlKXt2YXIgbT15KGQubWF4LWQubWluKSxuPWEuX3JhbmdlLG89YS50eXBlLHE9YS5jb3VudHx8MSxzPW4+Zy1mLHQ9bjxkLm1pblJhbmdlLHU9YS50eXBlPT09XCJhbGxcIiYmZC5tYXgtZC5taW4+PWctZiYmaltlXS5zdGF0ZSE9PTIsdj1hLnR5cGU9PT1cInl0ZFwiJiZuYShcIiVZXCIsZik9PT1cbm5hKFwiJVlcIixnKSx3PWMucmVuZGVyZXIuZm9yRXhwb3J0JiZlPT09aCxuPW49PT1tLHo9IWQuaGFzVmlzaWJsZVNlcmllcztpZigobz09PVwibW9udGhcInx8bz09PVwieWVhclwiKSYmbT49e21vbnRoOjI4LHllYXI6MzY1fVtvXSo4NjRFNSpxJiZtPD17bW9udGg6MzEseWVhcjozNjZ9W29dKjg2NEU1KnEpbj0hMDt3fHxuJiZlIT09aCYmZT09PWIubGFzdFNlbGVjdGVkPyhiLnNldFNlbGVjdGVkKGUpLGpbZV0uc2V0U3RhdGUoMikpOiFpJiYoc3x8dHx8dXx8dnx8eik/altlXS5zZXRTdGF0ZSgzKTpqW2VdLnN0YXRlPT09MyYmaltlXS5zZXRTdGF0ZSgwKX0pfSxjb21wdXRlQnV0dG9uUmFuZ2U6ZnVuY3Rpb24oYSl7dmFyIGI9YS50eXBlLGM9YS5jb3VudHx8MSxkPXttaWxsaXNlY29uZDoxLHNlY29uZDoxRTMsbWludXRlOjZFNCxob3VyOjM2RTUsZGF5Ojg2NEU1LHdlZWs6NjA0OEU1fTtpZihkW2JdKWEuX3JhbmdlPWRbYl0qYztlbHNlIGlmKGI9PT1cIm1vbnRoXCJ8fGI9PT1cInllYXJcIilhLl9yYW5nZT1cbnttb250aDozMCx5ZWFyOjM2NX1bYl0qODY0RTUqY30sc2V0SW5wdXRWYWx1ZTpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuY2hhcnQub3B0aW9ucy5yYW5nZVNlbGVjdG9yO2lmKHYoYikpdGhpc1thK1wiSW5wdXRcIl0uSENUaW1lPWI7dGhpc1thK1wiSW5wdXRcIl0udmFsdWU9bmEoYy5pbnB1dEVkaXREYXRlRm9ybWF0fHxcIiVZLSVtLSVkXCIsdGhpc1thK1wiSW5wdXRcIl0uSENUaW1lKTt0aGlzW2ErXCJEYXRlQm94XCJdLmF0dHIoe3RleHQ6bmEoYy5pbnB1dERhdGVGb3JtYXR8fFwiJWIgJWUsICVZXCIsdGhpc1thK1wiSW5wdXRcIl0uSENUaW1lKX0pfSxzaG93SW5wdXQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5pbnB1dEdyb3VwLGM9dGhpc1thK1wiRGF0ZUJveFwiXTtOKHRoaXNbYStcIklucHV0XCJdLHtsZWZ0OmIudHJhbnNsYXRlWCtjLngrXCJweFwiLHRvcDpiLnRyYW5zbGF0ZVkrXCJweFwiLHdpZHRoOmMud2lkdGgtMitcInB4XCIsaGVpZ2h0OmMuaGVpZ2h0LTIrXCJweFwiLGJvcmRlcjpcIjJweCBzb2xpZCBzaWx2ZXJcIn0pfSxcbmhpZGVJbnB1dDpmdW5jdGlvbihhKXtOKHRoaXNbYStcIklucHV0XCJdLHtib3JkZXI6MCx3aWR0aDpcIjFweFwiLGhlaWdodDpcIjFweFwifSk7dGhpcy5zZXRJbnB1dFZhbHVlKGEpfSxkcmF3SW5wdXQ6ZnVuY3Rpb24oYSl7ZnVuY3Rpb24gYigpe3ZhciBhPWoudmFsdWUsYj0oZy5pbnB1dERhdGVQYXJzZXJ8fGJhLnBhcnNlKShhKSxlPWQueEF4aXNbMF0sZj1lLmRhdGFNaW4saD1lLmRhdGFNYXg7aWYoYiE9PWoucHJldmlvdXNWYWx1ZSlqLnByZXZpb3VzVmFsdWU9YixDKGIpfHwoYj1hLnNwbGl0KFwiLVwiKSxiPWJhLlVUQyhLKGJbMF0pLEsoYlsxXSktMSxLKGJbMl0pKSksQyhiKSYmKFIuZ2xvYmFsLnVzZVVUQ3x8KGIrPShuZXcgYmEpLmdldFRpbWV6b25lT2Zmc2V0KCkqNkU0KSxpP2I+Yy5tYXhJbnB1dC5IQ1RpbWU/Yj10OmI8ZiYmKGI9Zik6YjxjLm1pbklucHV0LkhDVGltZT9iPXQ6Yj5oJiYoYj1oKSxiIT09dCYmZC54QXhpc1swXS5zZXRFeHRyZW1lcyhpP2I6ZS5taW4saT9lLm1heDpcbmIsdCx0LHt0cmlnZ2VyOlwicmFuZ2VTZWxlY3RvcklucHV0XCJ9KSl9dmFyIGM9dGhpcyxkPWMuY2hhcnQsZT1kLnJlbmRlcmVyLnN0eWxlLGY9ZC5yZW5kZXJlcixnPWQub3B0aW9ucy5yYW5nZVNlbGVjdG9yLGg9Yy5kaXYsaT1hPT09XCJtaW5cIixqLGssbD10aGlzLmlucHV0R3JvdXA7dGhpc1thK1wiTGFiZWxcIl09az1mLmxhYmVsKFIubGFuZ1tpP1wicmFuZ2VTZWxlY3RvckZyb21cIjpcInJhbmdlU2VsZWN0b3JUb1wiXSx0aGlzLmlucHV0R3JvdXAub2Zmc2V0KS5hdHRyKHtwYWRkaW5nOjJ9KS5jc3MoeihlLGcubGFiZWxTdHlsZSkpLmFkZChsKTtsLm9mZnNldCs9ay53aWR0aCs1O3RoaXNbYStcIkRhdGVCb3hcIl09Zj1mLmxhYmVsKFwiXCIsbC5vZmZzZXQpLmF0dHIoe3BhZGRpbmc6Mix3aWR0aDpnLmlucHV0Qm94V2lkdGh8fDkwLGhlaWdodDpnLmlucHV0Qm94SGVpZ2h0fHwxNyxzdHJva2U6Zy5pbnB1dEJveEJvcmRlckNvbG9yfHxcInNpbHZlclwiLFwic3Ryb2tlLXdpZHRoXCI6MX0pLmNzcyh6KHt0ZXh0QWxpZ246XCJjZW50ZXJcIixcbmNvbG9yOlwiIzQ0NFwifSxlLGcuaW5wdXRTdHlsZSkpLm9uKFwiY2xpY2tcIixmdW5jdGlvbigpe2Muc2hvd0lucHV0KGEpO2NbYStcIklucHV0XCJdLmZvY3VzKCl9KS5hZGQobCk7bC5vZmZzZXQrPWYud2lkdGgrKGk/MTA6MCk7dGhpc1thK1wiSW5wdXRcIl09aj1mYShcImlucHV0XCIse25hbWU6YSxjbGFzc05hbWU6XCJoaWdoY2hhcnRzLXJhbmdlLXNlbGVjdG9yXCIsdHlwZTpcInRleHRcIn0sQSh7cG9zaXRpb246XCJhYnNvbHV0ZVwiLGJvcmRlcjowLHdpZHRoOlwiMXB4XCIsaGVpZ2h0OlwiMXB4XCIscGFkZGluZzowLHRleHRBbGlnbjpcImNlbnRlclwiLGZvbnRTaXplOmUuZm9udFNpemUsZm9udEZhbWlseTplLmZvbnRGYW1pbHksbGVmdDpcIi05ZW1cIix0b3A6ZC5wbG90VG9wK1wicHhcIn0sZy5pbnB1dFN0eWxlKSxoKTtqLm9uZm9jdXM9ZnVuY3Rpb24oKXtjLnNob3dJbnB1dChhKX07ai5vbmJsdXI9ZnVuY3Rpb24oKXtjLmhpZGVJbnB1dChhKX07ai5vbmNoYW5nZT1iO2oub25rZXlwcmVzcz1mdW5jdGlvbihhKXthLmtleUNvZGU9PT1cbjEzJiZiKCl9fSxnZXRQb3NpdGlvbjpmdW5jdGlvbigpe3ZhciBhPXRoaXMuY2hhcnQsYj1hLm9wdGlvbnMucmFuZ2VTZWxlY3RvcixhPXEoKGIuYnV0dG9uUG9zaXRpb258fHt9KS55LGEucGxvdFRvcC1hLmF4aXNPZmZzZXRbMF0tYi5oZWlnaHQpO3JldHVybntidXR0b25Ub3A6YSxpbnB1dFRvcDphLTEwfX0scmVuZGVyOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcyxkPWMuY2hhcnQsZT1kLnJlbmRlcmVyLGY9ZC5jb250YWluZXIsZz1kLm9wdGlvbnMsaD1nLmV4cG9ydGluZyYmZy5leHBvcnRpbmcuZW5hYmxlZCE9PSExJiZnLm5hdmlnYXRpb24mJmcubmF2aWdhdGlvbi5idXR0b25PcHRpb25zLGk9Zy5yYW5nZVNlbGVjdG9yLGo9Yy5idXR0b25zLGc9Ui5sYW5nLGs9Yy5kaXYsaz1jLmlucHV0R3JvdXAsbD1pLmJ1dHRvblRoZW1lLG09aS5idXR0b25Qb3NpdGlvbnx8e30sbj1pLmlucHV0RW5hYmxlZCxwPWwmJmwuc3RhdGVzLHI9ZC5wbG90TGVmdCxzLHQ9dGhpcy5nZXRQb3NpdGlvbigpLFxudT1jLmdyb3VwLHc9Yy5yZW5kZXJlZDtpZighdyYmKGMuZ3JvdXA9dT1lLmcoXCJyYW5nZS1zZWxlY3Rvci1idXR0b25zXCIpLmFkZCgpLGMuem9vbVRleHQ9ZS50ZXh0KGcucmFuZ2VTZWxlY3Rvclpvb20scShtLngsciksMTUpLmNzcyhpLmxhYmVsU3R5bGUpLmFkZCh1KSxzPXEobS54LHIpK2Muem9vbVRleHQuZ2V0QkJveCgpLndpZHRoKzUsbyhjLmJ1dHRvbk9wdGlvbnMsZnVuY3Rpb24oYSxiKXtqW2JdPWUuYnV0dG9uKGEudGV4dCxzLDAsZnVuY3Rpb24oKXtjLmNsaWNrQnV0dG9uKGIpO2MuaXNBY3RpdmU9ITB9LGwscCYmcC5ob3ZlcixwJiZwLnNlbGVjdCxwJiZwLmRpc2FibGVkKS5jc3Moe3RleHRBbGlnbjpcImNlbnRlclwifSkuYWRkKHUpO3MrPWpbYl0ud2lkdGgrcShpLmJ1dHRvblNwYWNpbmcsNSk7Yy5zZWxlY3RlZD09PWImJmpbYl0uc2V0U3RhdGUoMil9KSxjLnVwZGF0ZUJ1dHRvblN0YXRlcygpLG4hPT0hMSkpYy5kaXY9az1mYShcImRpdlwiLG51bGwse3Bvc2l0aW9uOlwicmVsYXRpdmVcIixcbmhlaWdodDowLHpJbmRleDoxfSksZi5wYXJlbnROb2RlLmluc2VydEJlZm9yZShrLGYpLGMuaW5wdXRHcm91cD1rPWUuZyhcImlucHV0LWdyb3VwXCIpLmFkZCgpLGsub2Zmc2V0PTAsYy5kcmF3SW5wdXQoXCJtaW5cIiksYy5kcmF3SW5wdXQoXCJtYXhcIik7dVt3P1wiYW5pbWF0ZVwiOlwiYXR0clwiXSh7dHJhbnNsYXRlWTp0LmJ1dHRvblRvcH0pO24hPT0hMSYmKGsuYWxpZ24oQSh7eTp0LmlucHV0VG9wLHdpZHRoOmsub2Zmc2V0LHg6aCYmdC5pbnB1dFRvcDwoaC55fHwwKStoLmhlaWdodC1kLnNwYWNpbmdbMF0/LTQwOjB9LGkuaW5wdXRQb3NpdGlvbiksITAsZC5zcGFjaW5nQm94KSx2KG4pfHwoZD11LmdldEJCb3goKSxrW2sudHJhbnNsYXRlWDxkLngrZC53aWR0aCsxMD9cImhpZGVcIjpcInNob3dcIl0oKSksYy5zZXRJbnB1dFZhbHVlKFwibWluXCIsYSksYy5zZXRJbnB1dFZhbHVlKFwibWF4XCIsYikpO2MucmVuZGVyZWQ9ITB9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm1pbklucHV0LGI9dGhpcy5tYXhJbnB1dCxcbmM9dGhpcy5jaGFydCxkPXRoaXMuYmx1cklucHV0cyxlO1QoYy5jb250YWluZXIsXCJtb3VzZWRvd25cIixkKTtUKGMsXCJyZXNpemVcIixkKTtQYSh0aGlzLmJ1dHRvbnMpO2lmKGEpYS5vbmZvY3VzPWEub25ibHVyPWEub25jaGFuZ2U9bnVsbDtpZihiKWIub25mb2N1cz1iLm9uYmx1cj1iLm9uY2hhbmdlPW51bGw7Zm9yKGUgaW4gdGhpcyl0aGlzW2VdJiZlIT09XCJjaGFydFwiJiYodGhpc1tlXS5kZXN0cm95P3RoaXNbZV0uZGVzdHJveSgpOnRoaXNbZV0ubm9kZVR5cGUmJlVhKHRoaXNbZV0pKSx0aGlzW2VdPW51bGx9fTtKLnByb3RvdHlwZS50b0ZpeGVkUmFuZ2U9ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9dGhpcy5jaGFydCYmdGhpcy5jaGFydC5maXhlZFJhbmdlLGE9cShjLHRoaXMudHJhbnNsYXRlKGEsITApKSxiPXEoZCx0aGlzLnRyYW5zbGF0ZShiLCEwKSksYz1lJiYoYi1hKS9lO2M+MC43JiZjPDEuMyYmKGQ/YT1iLWU6Yj1hK2UpO0MoYSl8fChhPWI9dm9pZCAwKTtyZXR1cm57bWluOmEsXG5tYXg6Yn19O0oucHJvdG90eXBlLm1pbkZyb21SYW5nZT1mdW5jdGlvbigpe3ZhciBhPXRoaXMucmFuZ2UsYj17bW9udGg6XCJNb250aFwiLHllYXI6XCJGdWxsWWVhclwifVthLnR5cGVdLGMsZD10aGlzLm1heCxlLGYsZz1mdW5jdGlvbihhLGMpe3ZhciBkPW5ldyBiYShhKTtkW1wic2V0XCIrYl0oZFtcImdldFwiK2JdKCkrYyk7cmV0dXJuIGQuZ2V0VGltZSgpLWF9O0MoYSk/KGM9dGhpcy5tYXgtYSxmPWEpOmM9ZCtnKGQsLWEuY291bnQpO2U9cSh0aGlzLmRhdGFNaW4sTnVtYmVyLk1JTl9WQUxVRSk7QyhjKXx8KGM9ZSk7aWYoYzw9ZSljPWUsZj09PXZvaWQgMCYmKGY9ZyhjLGEuY291bnQpKSx0aGlzLm5ld01heD1HKGMrZix0aGlzLmRhdGFNYXgpO0MoZCl8fChjPXZvaWQgMCk7cmV0dXJuIGN9O1UoQmEucHJvdG90eXBlLFwiaW5pdFwiLGZ1bmN0aW9uKGEsYixjKXtFKHRoaXMsXCJpbml0XCIsZnVuY3Rpb24oKXtpZih0aGlzLm9wdGlvbnMucmFuZ2VTZWxlY3Rvci5lbmFibGVkKXRoaXMucmFuZ2VTZWxlY3Rvcj1cbm5ldyBIYih0aGlzKX0pO2EuY2FsbCh0aGlzLGIsYyl9KTtCLlJhbmdlU2VsZWN0b3I9SGI7QmEucHJvdG90eXBlLmNhbGxiYWNrcy5wdXNoKGZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoKXtkPWEueEF4aXNbMF0uZ2V0RXh0cmVtZXMoKTtDKGQubWluKSYmZi5yZW5kZXIoZC5taW4sZC5tYXgpfWZ1bmN0aW9uIGMoYSl7Zi5yZW5kZXIoYS5taW4sYS5tYXgpfXZhciBkLGU9YS5zY3JvbGxlcixmPWEucmFuZ2VTZWxlY3RvcjtlJiYoZD1hLnhBeGlzWzBdLmdldEV4dHJlbWVzKCksZS5yZW5kZXIoZC5taW4sZC5tYXgpKTtmJiYoRShhLnhBeGlzWzBdLFwiYWZ0ZXJTZXRFeHRyZW1lc1wiLGMpLEUoYSxcInJlc2l6ZVwiLGIpLGIoKSk7RShhLFwiZGVzdHJveVwiLGZ1bmN0aW9uKCl7ZiYmKFQoYSxcInJlc2l6ZVwiLGIpLFQoYS54QXhpc1swXSxcImFmdGVyU2V0RXh0cmVtZXNcIixjKSl9KX0pO0IuU3RvY2tDaGFydD1CLnN0b2NrQ2hhcnQ9ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPUNhKGEpfHxhLm5vZGVOYW1lLFxuZT1hcmd1bWVudHNbZD8xOjBdLGY9ZS5zZXJpZXMsZyxoPXEoZS5uYXZpZ2F0b3ImJmUubmF2aWdhdG9yLmVuYWJsZWQsITApP3tzdGFydE9uVGljazohMSxlbmRPblRpY2s6ITF9Om51bGwsaT17bWFya2VyOntlbmFibGVkOiExLHJhZGl1czoyfX0saj17c2hhZG93OiExLGJvcmRlcldpZHRoOjB9O2UueEF4aXM9dGEodWEoZS54QXhpc3x8e30pLGZ1bmN0aW9uKGEpe3JldHVybiB6KHttaW5QYWRkaW5nOjAsbWF4UGFkZGluZzowLG9yZGluYWw6ITAsdGl0bGU6e3RleHQ6bnVsbH0sbGFiZWxzOntvdmVyZmxvdzpcImp1c3RpZnlcIn0sc2hvd0xhc3RMYWJlbDohMH0sYSx7dHlwZTpcImRhdGV0aW1lXCIsY2F0ZWdvcmllczpudWxsfSxoKX0pO2UueUF4aXM9dGEodWEoZS55QXhpc3x8e30pLGZ1bmN0aW9uKGEpe2c9cShhLm9wcG9zaXRlLCEwKTtyZXR1cm4geih7bGFiZWxzOnt5Oi0yfSxvcHBvc2l0ZTpnLHNob3dMYXN0TGFiZWw6ITEsdGl0bGU6e3RleHQ6bnVsbH19LGEpfSk7ZS5zZXJpZXM9XG5udWxsO2U9eih7Y2hhcnQ6e3Bhbm5pbmc6ITAscGluY2hUeXBlOlwieFwifSxuYXZpZ2F0b3I6e2VuYWJsZWQ6ITB9LHNjcm9sbGJhcjp7ZW5hYmxlZDohMH0scmFuZ2VTZWxlY3Rvcjp7ZW5hYmxlZDohMH0sdGl0bGU6e3RleHQ6bnVsbCxzdHlsZTp7Zm9udFNpemU6XCIxNnB4XCJ9fSx0b29sdGlwOntzaGFyZWQ6ITAsY3Jvc3NoYWlyczohMH0sbGVnZW5kOntlbmFibGVkOiExfSxwbG90T3B0aW9uczp7bGluZTppLHNwbGluZTppLGFyZWE6aSxhcmVhc3BsaW5lOmksYXJlYXJhbmdlOmksYXJlYXNwbGluZXJhbmdlOmksY29sdW1uOmosY29sdW1ucmFuZ2U6aixjYW5kbGVzdGljazpqLG9obGM6an19LGUse19zdG9jazohMCxjaGFydDp7aW52ZXJ0ZWQ6ITF9fSk7ZS5zZXJpZXM9ZjtyZXR1cm4gZD9uZXcgQmEoYSxlLGMpOm5ldyBCYShlLGIpfTtVKFlhLnByb3RvdHlwZSxcImluaXRcIixmdW5jdGlvbihhLGIsYyl7dmFyIGQ9Yy5jaGFydC5waW5jaFR5cGV8fFwiXCI7YS5jYWxsKHRoaXMsYixjKTtcbnRoaXMucGluY2hYPXRoaXMucGluY2hIb3I9ZC5pbmRleE9mKFwieFwiKSE9PS0xO3RoaXMucGluY2hZPXRoaXMucGluY2hWZXJ0PWQuaW5kZXhPZihcInlcIikhPT0tMTt0aGlzLmhhc1pvb209dGhpcy5oYXNab29tfHx0aGlzLnBpbmNoSG9yfHx0aGlzLnBpbmNoVmVydH0pO1UoSi5wcm90b3R5cGUsXCJhdXRvTGFiZWxBbGlnblwiLGZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY2hhcnQsYz10aGlzLm9wdGlvbnMsYj1iLl9sYWJlbFBhbmVzPWIuX2xhYmVsUGFuZXN8fHt9LGQ9dGhpcy5vcHRpb25zLmxhYmVscztpZih0aGlzLmNoYXJ0Lm9wdGlvbnMuX3N0b2NrJiZ0aGlzLmNvbGw9PT1cInlBeGlzXCImJihjPWMudG9wK1wiLFwiK2MuaGVpZ2h0LCFiW2NdJiZkLmVuYWJsZWQpKXtpZihkLng9PT0xNSlkLng9MDtpZihkLmFsaWduPT09dm9pZCAwKWQuYWxpZ249XCJyaWdodFwiO2JbY109MTtyZXR1cm5cInJpZ2h0XCJ9cmV0dXJuIGEuY2FsbCh0aGlzLFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpKX0pO1UoSi5wcm90b3R5cGUsXG5cImdldFBsb3RMaW5lUGF0aFwiLGZ1bmN0aW9uKGEsYixjLGQsZSxmKXt2YXIgZz10aGlzLGg9dGhpcy5pc0xpbmtlZCYmIXRoaXMuc2VyaWVzP3RoaXMubGlua2VkUGFyZW50LnNlcmllczp0aGlzLnNlcmllcyxpPWcuY2hhcnQsaj1pLnJlbmRlcmVyLGs9Zy5sZWZ0LGw9Zy50b3AsbSxuLHAscixzPVtdLHQ9W10sdSx4O2lmKGcuY29sbD09PVwiY29sb3JBeGlzXCIpcmV0dXJuIGEuYXBwbHkodGhpcyxbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSk7dD1nLmlzWEF4aXM/dihnLm9wdGlvbnMueUF4aXMpP1tpLnlBeGlzW2cub3B0aW9ucy55QXhpc11dOnRhKGgsZnVuY3Rpb24oYSl7cmV0dXJuIGEueUF4aXN9KTp2KGcub3B0aW9ucy54QXhpcyk/W2kueEF4aXNbZy5vcHRpb25zLnhBeGlzXV06dGEoaCxmdW5jdGlvbihhKXtyZXR1cm4gYS54QXhpc30pO28oZy5pc1hBeGlzP2kueUF4aXM6aS54QXhpcyxmdW5jdGlvbihhKXtpZih2KGEub3B0aW9ucy5pZCk/YS5vcHRpb25zLmlkLmluZGV4T2YoXCJuYXZpZ2F0b3JcIik9PT1cbi0xOjEpe3ZhciBiPWEuaXNYQXhpcz9cInlBeGlzXCI6XCJ4QXhpc1wiLGI9dihhLm9wdGlvbnNbYl0pP2lbYl1bYS5vcHRpb25zW2JdXTppW2JdWzBdO2c9PT1iJiZ0LnB1c2goYSl9fSk7dT10Lmxlbmd0aD9bXTpbZy5pc1hBeGlzP2kueUF4aXNbMF06aS54QXhpc1swXV07byh0LGZ1bmN0aW9uKGEpe3NhKGEsdSk9PT0tMSYmdS5wdXNoKGEpfSk7eD1xKGYsZy50cmFuc2xhdGUoYixudWxsLG51bGwsZCkpO0MoeCkmJihnLmhvcml6P28odSxmdW5jdGlvbihhKXt2YXIgYjtuPWEucG9zO3I9bithLmxlbjttPXA9eSh4K2cudHJhbnNCKTtpZihtPGt8fG0+aytnLndpZHRoKWU/bT1wPUcodyhrLG0pLGsrZy53aWR0aCk6Yj0hMDtifHxzLnB1c2goXCJNXCIsbSxuLFwiTFwiLHAscil9KTpvKHUsZnVuY3Rpb24oYSl7dmFyIGI7bT1hLnBvcztwPW0rYS5sZW47bj1yPXkobCtnLmhlaWdodC14KTtpZihuPGx8fG4+bCtnLmhlaWdodCllP249cj1HKHcobCxuKSxnLnRvcCtnLmhlaWdodCk6Yj0hMDtifHxzLnB1c2goXCJNXCIsXG5tLG4sXCJMXCIscCxyKX0pKTtyZXR1cm4gcy5sZW5ndGg+MD9qLmNyaXNwUG9seUxpbmUocyxjfHwxKTpudWxsfSk7Si5wcm90b3R5cGUuZ2V0UGxvdEJhbmRQYXRoPWZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5nZXRQbG90TGluZVBhdGgoYixudWxsLG51bGwsITApLGQ9dGhpcy5nZXRQbG90TGluZVBhdGgoYSxudWxsLG51bGwsITApLGU9W10sZjtpZihkJiZjJiZkLnRvU3RyaW5nKCkhPT1jLnRvU3RyaW5nKCkpZm9yKGY9MDtmPGQubGVuZ3RoO2YrPTYpZS5wdXNoKFwiTVwiLGRbZisxXSxkW2YrMl0sXCJMXCIsZFtmKzRdLGRbZis1XSxjW2YrNF0sY1tmKzVdLGNbZisxXSxjW2YrMl0pO2Vsc2UgZT1udWxsO3JldHVybiBlfTt4YS5wcm90b3R5cGUuY3Jpc3BQb2x5TGluZT1mdW5jdGlvbihhLGIpe3ZhciBjO2ZvcihjPTA7YzxhLmxlbmd0aDtjKz02KWFbYysxXT09PWFbYys0XSYmKGFbYysxXT1hW2MrNF09eShhW2MrMV0pLWIlMi8yKSxhW2MrMl09PT1hW2MrNV0mJihhW2MrMl09YVtjKzVdPVxueShhW2MrMl0pK2IlMi8yKTtyZXR1cm4gYX07aWYoWGE9PT1CLlZNTFJlbmRlcmVyKWxiLnByb3RvdHlwZS5jcmlzcFBvbHlMaW5lPXhhLnByb3RvdHlwZS5jcmlzcFBvbHlMaW5lO1UoSi5wcm90b3R5cGUsXCJoaWRlQ3Jvc3NoYWlyXCIsZnVuY3Rpb24oYSxiKXthLmNhbGwodGhpcyxiKTtpZih0aGlzLmNyb3NzTGFiZWwpdGhpcy5jcm9zc0xhYmVsPXRoaXMuY3Jvc3NMYWJlbC5oaWRlKCl9KTtVKEoucHJvdG90eXBlLFwiZHJhd0Nyb3NzaGFpclwiLGZ1bmN0aW9uKGEsYixjKXt2YXIgZCxlO2EuY2FsbCh0aGlzLGIsYyk7aWYodih0aGlzLmNyb3NzaGFpci5sYWJlbCkmJnRoaXMuY3Jvc3NoYWlyLmxhYmVsLmVuYWJsZWQpe3ZhciBhPXRoaXMuY2hhcnQsZj10aGlzLm9wdGlvbnMuY3Jvc3NoYWlyLmxhYmVsLGc9dGhpcy5ob3JpeixoPXRoaXMub3Bwb3NpdGUsaT10aGlzLmxlZnQsaj10aGlzLnRvcCxrPXRoaXMuY3Jvc3NMYWJlbCxsLG09Zi5mb3JtYXQsbj1cIlwiLG89dGhpcy5vcHRpb25zLnRpY2tQb3NpdGlvbj09PVxuXCJpbnNpZGVcIixyPXRoaXMuY3Jvc3NoYWlyLnNuYXAhPT0hMTtsPWc/XCJjZW50ZXJcIjpoP3RoaXMubGFiZWxBbGlnbj09PVwicmlnaHRcIj9cInJpZ2h0XCI6XCJsZWZ0XCI6dGhpcy5sYWJlbEFsaWduPT09XCJsZWZ0XCI/XCJsZWZ0XCI6XCJjZW50ZXJcIjtpZighaylrPXRoaXMuY3Jvc3NMYWJlbD1hLnJlbmRlcmVyLmxhYmVsKG51bGwsbnVsbCxudWxsLGYuc2hhcGV8fFwiY2FsbG91dFwiKS5hdHRyKHthbGlnbjpmLmFsaWdufHxsLHpJbmRleDoxMixmaWxsOmYuYmFja2dyb3VuZENvbG9yfHx0aGlzLnNlcmllc1swXSYmdGhpcy5zZXJpZXNbMF0uY29sb3J8fFwiZ3JheVwiLHBhZGRpbmc6cShmLnBhZGRpbmcsOCksc3Ryb2tlOmYuYm9yZGVyQ29sb3J8fFwiXCIsXCJzdHJva2Utd2lkdGhcIjpmLmJvcmRlcldpZHRofHwwLHI6cShmLmJvcmRlclJhZGl1cywzKX0pLmNzcyhBKHtjb2xvcjpcIndoaXRlXCIsZm9udFdlaWdodDpcIm5vcm1hbFwiLGZvbnRTaXplOlwiMTFweFwiLHRleHRBbGlnbjpcImNlbnRlclwifSxmLnN0eWxlKSkuYWRkKCk7XG5nPyhsPXI/Yy5wbG90WCtpOmIuY2hhcnRYLGorPWg/MDp0aGlzLmhlaWdodCk6KGw9aD90aGlzLndpZHRoK2k6MCxqPXI/Yy5wbG90WStqOmIuY2hhcnRZKTshbSYmIWYuZm9ybWF0dGVyJiYodGhpcy5pc0RhdGV0aW1lQXhpcyYmKG49XCIlYiAlZCwgJVlcIiksbT1cInt2YWx1ZVwiKyhuP1wiOlwiK246XCJcIikrXCJ9XCIpO2I9cj9jW3RoaXMuaXNYQXhpcz9cInhcIjpcInlcIl06dGhpcy50b1ZhbHVlKGc/Yi5jaGFydFg6Yi5jaGFydFkpO2suYXR0cih7dGV4dDptP0xhKG0se3ZhbHVlOmJ9KTpmLmZvcm1hdHRlci5jYWxsKHRoaXMsYiksYW5jaG9yWDpnP2w6dGhpcy5vcHBvc2l0ZT8wOmEuY2hhcnRXaWR0aCxhbmNob3JZOmc/dGhpcy5vcHBvc2l0ZT9hLmNoYXJ0SGVpZ2h0OjA6aix4OmwseTpqLHZpc2liaWxpdHk6XCJ2aXNpYmxlXCJ9KTtiPWsuZ2V0QkJveCgpO2lmKGcpe2lmKG8mJiFofHwhbyYmaClqPWsueS1iLmhlaWdodH1lbHNlIGo9ay55LWIuaGVpZ2h0LzI7Zz8oZD1pLWIueCxlPWkrdGhpcy53aWR0aC1cbmIueCk6KGQ9dGhpcy5sYWJlbEFsaWduPT09XCJsZWZ0XCI/aTowLGU9dGhpcy5sYWJlbEFsaWduPT09XCJyaWdodFwiP2krdGhpcy53aWR0aDphLmNoYXJ0V2lkdGgpO2sudHJhbnNsYXRlWDxkJiYobCs9ZC1rLnRyYW5zbGF0ZVgpO2sudHJhbnNsYXRlWCtiLndpZHRoPj1lJiYobC09ay50cmFuc2xhdGVYK2Iud2lkdGgtZSk7ay5hdHRyKHt4OmwseTpqLHZpc2liaWxpdHk6XCJ2aXNpYmxlXCJ9KX19KTt2YXIgZ2M9aWEuaW5pdCxoYz1pYS5wcm9jZXNzRGF0YSxpYz1IYS5wcm90b3R5cGUudG9vbHRpcEZvcm1hdHRlcjtpYS5pbml0PWZ1bmN0aW9uKCl7Z2MuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuc2V0Q29tcGFyZSh0aGlzLm9wdGlvbnMuY29tcGFyZSl9O2lhLnNldENvbXBhcmU9ZnVuY3Rpb24oYSl7dGhpcy5tb2RpZnlWYWx1ZT1hPT09XCJ2YWx1ZVwifHxhPT09XCJwZXJjZW50XCI/ZnVuY3Rpb24oYixjKXt2YXIgZD10aGlzLmNvbXBhcmVWYWx1ZTtpZihiIT09dCYmKGI9YT09PVwidmFsdWVcIj9cbmItZDpiPTEwMCooYi9kKS0xMDAsYykpYy5jaGFuZ2U9YjtyZXR1cm4gYn06bnVsbDtpZih0aGlzLmNoYXJ0Lmhhc1JlbmRlcmVkKXRoaXMuaXNEaXJ0eT0hMH07aWEucHJvY2Vzc0RhdGE9ZnVuY3Rpb24oKXt2YXIgYSxiPS0xLGMsZCxlLGY7aGMuYXBwbHkodGhpcyxhcmd1bWVudHMpO2lmKHRoaXMueEF4aXMmJnRoaXMucHJvY2Vzc2VkWURhdGEpe2M9dGhpcy5wcm9jZXNzZWRYRGF0YTtkPXRoaXMucHJvY2Vzc2VkWURhdGE7ZT1kLmxlbmd0aDt0aGlzLnBvaW50QXJyYXlNYXAmJihiPXNhKHRoaXMucG9pbnRWYWxLZXl8fFwieVwiLHRoaXMucG9pbnRBcnJheU1hcCkpO2ZvcihhPTA7YTxlO2ErKylpZihmPWI+LTE/ZFthXVtiXTpkW2FdLEMoZikmJmNbYV0+PXRoaXMueEF4aXMubWluJiZmIT09MCl7dGhpcy5jb21wYXJlVmFsdWU9ZjticmVha319fTtVKGlhLFwiZ2V0RXh0cmVtZXNcIixmdW5jdGlvbihhKXt2YXIgYjthLmFwcGx5KHRoaXMsW10uc2xpY2UuY2FsbChhcmd1bWVudHMsMSkpO1xuaWYodGhpcy5tb2RpZnlWYWx1ZSliPVt0aGlzLm1vZGlmeVZhbHVlKHRoaXMuZGF0YU1pbiksdGhpcy5tb2RpZnlWYWx1ZSh0aGlzLmRhdGFNYXgpXSx0aGlzLmRhdGFNaW49TWEoYiksdGhpcy5kYXRhTWF4PURhKGIpfSk7Si5wcm90b3R5cGUuc2V0Q29tcGFyZT1mdW5jdGlvbihhLGIpe3RoaXMuaXNYQXhpc3x8KG8odGhpcy5zZXJpZXMsZnVuY3Rpb24oYil7Yi5zZXRDb21wYXJlKGEpfSkscShiLCEwKSYmdGhpcy5jaGFydC5yZWRyYXcoKSl9O0hhLnByb3RvdHlwZS50b29sdGlwRm9ybWF0dGVyPWZ1bmN0aW9uKGEpe2E9YS5yZXBsYWNlKFwie3BvaW50LmNoYW5nZX1cIiwodGhpcy5jaGFuZ2U+MD9cIitcIjpcIlwiKStCLm51bWJlckZvcm1hdCh0aGlzLmNoYW5nZSxxKHRoaXMuc2VyaWVzLnRvb2x0aXBPcHRpb25zLmNoYW5nZURlY2ltYWxzLDIpKSk7cmV0dXJuIGljLmFwcGx5KHRoaXMsW2FdKX07VShQLnByb3RvdHlwZSxcInJlbmRlclwiLGZ1bmN0aW9uKGEpe2lmKHRoaXMuY2hhcnQub3B0aW9ucy5fc3RvY2smJlxudGhpcy54QXhpcykhdGhpcy5jbGlwQm94JiZ0aGlzLmFuaW1hdGU/KHRoaXMuY2xpcEJveD16KHRoaXMuY2hhcnQuY2xpcEJveCksdGhpcy5jbGlwQm94LndpZHRoPXRoaXMueEF4aXMubGVuLHRoaXMuY2xpcEJveC5oZWlnaHQ9dGhpcy55QXhpcy5sZW4pOnRoaXMuY2hhcnRbdGhpcy5zaGFyZWRDbGlwS2V5XSYmKFNhKHRoaXMuY2hhcnRbdGhpcy5zaGFyZWRDbGlwS2V5XSksdGhpcy5jaGFydFt0aGlzLnNoYXJlZENsaXBLZXldLmF0dHIoe3dpZHRoOnRoaXMueEF4aXMubGVuLGhlaWdodDp0aGlzLnlBeGlzLmxlbn0pKTthLmNhbGwodGhpcyl9KTtBKEIse0NvbG9yOnZhLFBvaW50OkhhLFRpY2s6YmIsUmVuZGVyZXI6WGEsU1ZHRWxlbWVudDpaLFNWR1JlbmRlcmVyOnhhLGFycmF5TWluOk1hLGFycmF5TWF4OkRhLGNoYXJ0czokLGNvcnJlY3RGbG9hdDprYSxkYXRlRm9ybWF0Om5hLGVycm9yOmdhLGZvcm1hdDpMYSxwYXRoQW5pbTp2b2lkIDAsZ2V0T3B0aW9uczpmdW5jdGlvbigpe3JldHVybiBSfSxcbmhhc0JpZGlCdWc6WmIsaXNUb3VjaERldmljZTpqYixzZXRPcHRpb25zOmZ1bmN0aW9uKGEpe1I9eighMCxSLGEpO09iKCk7cmV0dXJuIFJ9LGFkZEV2ZW50OkUscmVtb3ZlRXZlbnQ6VCxjcmVhdGVFbGVtZW50OmZhLGRpc2NhcmRFbGVtZW50OlVhLGNzczpOLGVhY2g6byxtYXA6dGEsbWVyZ2U6eixzcGxhdDp1YSxzdGFibGVTb3J0Om5iLGV4dGVuZENsYXNzOm1hLHBJbnQ6Syxzdmc6amEsY2FudmFzOnFhLHZtbDohamEmJiFxYSxwcm9kdWN0OlwiSGlnaHN0b2NrXCIsdmVyc2lvbjpcIjQuMi41XCJ9KTtyZXR1cm4gQn0pO1xuIiwiLyoqXG4qXG4qIGpxdWVyeS5zcGFya2xpbmUuanNcbipcbiogdjIuMy4yXG4qIChjKSBTcGx1bmssIEluY1xuKiBDb250YWN0OiBHYXJldGggV2F0dHMgKGdhcmV0aEBzcGx1bmsuY29tKVxuKiBodHRwOi8vb21uaXBvdGVudC5uZXQvanF1ZXJ5LnNwYXJrbGluZS9cbipcbiogR2VuZXJhdGVzIGlubGluZSBzcGFya2xpbmUgY2hhcnRzIGZyb20gZGF0YSBzdXBwbGllZCBlaXRoZXIgdG8gdGhlIG1ldGhvZFxuKiBvciBpbmxpbmUgaW4gSFRNTFxuKlxuKiBDb21wYXRpYmxlIHdpdGggSW50ZXJuZXQgRXhwbG9yZXIgNi4wKyBhbmQgbW9kZXJuIGJyb3dzZXJzIGVxdWlwcGVkIHdpdGggdGhlIGNhbnZhcyB0YWdcbiogKEZpcmVmb3ggMi4wKywgU2FmYXJpLCBPcGVyYSwgZXRjKVxuKlxuKiBMaWNlbnNlOiBOZXcgQlNEIExpY2Vuc2VcbipcbiogQ29weXJpZ2h0IChjKSAyMDEyLCBTcGx1bmsgSW5jLlxuKiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuKlxuKiBSZWRpc3RyaWJ1dGlvbiBhbmQgdXNlIGluIHNvdXJjZSBhbmQgYmluYXJ5IGZvcm1zLCB3aXRoIG9yIHdpdGhvdXQgbW9kaWZpY2F0aW9uLFxuKiBhcmUgcGVybWl0dGVkIHByb3ZpZGVkIHRoYXQgdGhlIGZvbGxvd2luZyBjb25kaXRpb25zIGFyZSBtZXQ6XG4qXG4qICAgICAqIFJlZGlzdHJpYnV0aW9ucyBvZiBzb3VyY2UgY29kZSBtdXN0IHJldGFpbiB0aGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSxcbiogICAgICAgdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lci5cbiogICAgICogUmVkaXN0cmlidXRpb25zIGluIGJpbmFyeSBmb3JtIG11c3QgcmVwcm9kdWNlIHRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlLFxuKiAgICAgICB0aGlzIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQgdGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyIGluIHRoZSBkb2N1bWVudGF0aW9uXG4qICAgICAgIGFuZC9vciBvdGhlciBtYXRlcmlhbHMgcHJvdmlkZWQgd2l0aCB0aGUgZGlzdHJpYnV0aW9uLlxuKiAgICAgKiBOZWl0aGVyIHRoZSBuYW1lIG9mIFNwbHVuayBJbmMgbm9yIHRoZSBuYW1lcyBvZiBpdHMgY29udHJpYnV0b3JzIG1heVxuKiAgICAgICBiZSB1c2VkIHRvIGVuZG9yc2Ugb3IgcHJvbW90ZSBwcm9kdWN0cyBkZXJpdmVkIGZyb20gdGhpcyBzb2Z0d2FyZSB3aXRob3V0XG4qICAgICAgIHNwZWNpZmljIHByaW9yIHdyaXR0ZW4gcGVybWlzc2lvbi5cbipcbiogVEhJUyBTT0ZUV0FSRSBJUyBQUk9WSURFRCBCWSBUSEUgQ09QWVJJR0hUIEhPTERFUlMgQU5EIENPTlRSSUJVVE9SUyBcIkFTIElTXCIgQU5EIEFOWVxuKiBFWFBSRVNTIE9SIElNUExJRUQgV0FSUkFOVElFUywgSU5DTFVESU5HLCBCVVQgTk9UIExJTUlURUQgVE8sIFRIRSBJTVBMSUVEIFdBUlJBTlRJRVNcbiogT0YgTUVSQ0hBTlRBQklMSVRZIEFORCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBUkUgRElTQ0xBSU1FRC4gSU4gTk8gRVZFTlRcbiogU0hBTEwgVEhFIENPUFlSSUdIVCBPV05FUiBPUiBDT05UUklCVVRPUlMgQkUgTElBQkxFIEZPUiBBTlkgRElSRUNULCBJTkRJUkVDVCwgSU5DSURFTlRBTCxcbiogU1BFQ0lBTCwgRVhFTVBMQVJZLCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVMgKElOQ0xVRElORywgQlVUIE5PVCBMSU1JVEVEIFRPLCBQUk9DVVJFTUVOVFxuKiBPRiBTVUJTVElUVVRFIEdPT0RTIE9SIFNFUlZJQ0VTOyBMT1NTIE9GIFVTRSwgREFUQSwgT1IgUFJPRklUUzsgT1IgQlVTSU5FU1MgSU5URVJSVVBUSU9OKVxuKiBIT1dFVkVSIENBVVNFRCBBTkQgT04gQU5ZIFRIRU9SWSBPRiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQ09OVFJBQ1QsIFNUUklDVCBMSUFCSUxJVFksXG4qIE9SIFRPUlQgKElOQ0xVRElORyBORUdMSUdFTkNFIE9SIE9USEVSV0lTRSkgQVJJU0lORyBJTiBBTlkgV0FZIE9VVCBPRiBUSEUgVVNFIE9GIFRISVNcbiogU09GVFdBUkUsIEVWRU4gSUYgQURWSVNFRCBPRiBUSEUgUE9TU0lCSUxJVFkgT0YgU1VDSCBEQU1BR0UuXG4qXG4qXG4qIFVzYWdlOlxuKiAgJChzZWxlY3Rvcikuc3BhcmtsaW5lKHZhbHVlcywgb3B0aW9ucylcbipcbiogSWYgdmFsdWVzIGlzIHVuZGVmaW5lZCBvciBzZXQgdG8gJ2h0bWwnIHRoZW4gdGhlIGRhdGEgdmFsdWVzIGFyZSByZWFkIGZyb20gdGhlIHNwZWNpZmllZCB0YWc6XG4qICAgPHA+U3BhcmtsaW5lOiA8c3BhbiBjbGFzcz1cInNwYXJrbGluZVwiPjEsNCw2LDYsOCw1LDMsNTwvc3Bhbj48L3A+XG4qICAgJCgnLnNwYXJrbGluZScpLnNwYXJrbGluZSgpO1xuKiBUaGVyZSBtdXN0IGJlIG5vIHNwYWNlcyBpbiB0aGUgZW5jbG9zZWQgZGF0YSBzZXRcbipcbiogT3RoZXJ3aXNlIHZhbHVlcyBtdXN0IGJlIGFuIGFycmF5IG9mIG51bWJlcnMgb3IgbnVsbCB2YWx1ZXNcbiogICAgPHA+U3BhcmtsaW5lOiA8c3BhbiBpZD1cInNwYXJrbGluZTFcIj5UaGlzIHRleHQgcmVwbGFjZWQgaWYgdGhlIGJyb3dzZXIgaXMgY29tcGF0aWJsZTwvc3Bhbj48L3A+XG4qICAgICQoJyNzcGFya2xpbmUxJykuc3BhcmtsaW5lKFsxLDQsNiw2LDgsNSwzLDVdKVxuKiAgICAkKCcjc3BhcmtsaW5lMicpLnNwYXJrbGluZShbMSw0LDYsbnVsbCxudWxsLDUsMyw1XSlcbipcbiogVmFsdWVzIGNhbiBhbHNvIGJlIHNwZWNpZmllZCBpbiBhbiBIVE1MIGNvbW1lbnQsIG9yIGFzIGEgdmFsdWVzIGF0dHJpYnV0ZTpcbiogICAgPHA+U3BhcmtsaW5lOiA8c3BhbiBjbGFzcz1cInNwYXJrbGluZVwiPjwhLS0xLDQsNiw2LDgsNSwzLDUgLS0+PC9zcGFuPjwvcD5cbiogICAgPHA+U3BhcmtsaW5lOiA8c3BhbiBjbGFzcz1cInNwYXJrbGluZVwiIHZhbHVlcz1cIjEsNCw2LDYsOCw1LDMsNVwiPjwvc3Bhbj48L3A+XG4qICAgICQoJy5zcGFya2xpbmUnKS5zcGFya2xpbmUoKTtcbipcbiogRm9yIGxpbmUgY2hhcnRzLCB4IHZhbHVlcyBjYW4gYWxzbyBiZSBzcGVjaWZpZWQ6XG4qICAgPHA+U3BhcmtsaW5lOiA8c3BhbiBjbGFzcz1cInNwYXJrbGluZVwiPjE6MSwyLjc6NCwzLjQ6Niw1OjYsNjo4LDguNzo1LDk6MywxMDo1PC9zcGFuPjwvcD5cbiogICAgJCgnI3NwYXJrbGluZTEnKS5zcGFya2xpbmUoWyBbMSwxXSwgWzIuNyw0XSwgWzMuNCw2XSwgWzUsNl0sIFs2LDhdLCBbOC43LDVdLCBbOSwzXSwgWzEwLDVdIF0pXG4qXG4qIEJ5IGRlZmF1bHQsIG9wdGlvbnMgc2hvdWxkIGJlIHBhc3NlZCBpbiBhcyB0aGUgc2Vjb25kIGFyZ3VtZW50IHRvIHRoZSBzcGFya2xpbmUgZnVuY3Rpb246XG4qICAgJCgnLnNwYXJrbGluZScpLnNwYXJrbGluZShbMSwyLDMsNF0sIHt0eXBlOiAnYmFyJ30pXG4qXG4qIE9wdGlvbnMgY2FuIGFsc28gYmUgc2V0IGJ5IHBhc3NpbmcgdGhlbSBvbiB0aGUgdGFnIGl0c2VsZi4gIFRoaXMgZmVhdHVyZSBpcyBkaXNhYmxlZCBieSBkZWZhdWx0IHRob3VnaFxuKiBhcyB0aGVyZSdzIGEgc2xpZ2h0IHBlcmZvcm1hbmNlIG92ZXJoZWFkOlxuKiAgICQoJy5zcGFya2xpbmUnKS5zcGFya2xpbmUoWzEsMiwzLDRdLCB7ZW5hYmxlVGFnT3B0aW9uczogdHJ1ZX0pXG4qICAgPHA+U3BhcmtsaW5lOiA8c3BhbiBjbGFzcz1cInNwYXJrbGluZVwiIHNwYXJrVHlwZT1cImJhclwiIHNwYXJrQmFyQ29sb3I9XCJyZWRcIj5sb2FkaW5nPC9zcGFuPjwvcD5cbiogUHJlZml4IGFsbCBvcHRpb25zIHN1cHBsaWVkIGFzIHRhZyBhdHRyaWJ1dGUgd2l0aCBcInNwYXJrXCIgKGNvbmZpZ3VyYWJsZSBieSBzZXR0aW5nIHRhZ09wdGlvbnNQcmVmaXgpXG4qXG4qIFN1cHBvcnRlZCBvcHRpb25zOlxuKiAgIGxpbmVDb2xvciAtIENvbG9yIG9mIHRoZSBsaW5lIHVzZWQgZm9yIHRoZSBjaGFydFxuKiAgIGZpbGxDb2xvciAtIENvbG9yIHVzZWQgdG8gZmlsbCBpbiB0aGUgY2hhcnQgLSBTZXQgdG8gJycgb3IgZmFsc2UgZm9yIGEgdHJhbnNwYXJlbnQgY2hhcnRcbiogICB3aWR0aCAtIFdpZHRoIG9mIHRoZSBjaGFydCAtIERlZmF1bHRzIHRvIDMgdGltZXMgdGhlIG51bWJlciBvZiB2YWx1ZXMgaW4gcGl4ZWxzXG4qICAgaGVpZ2h0IC0gSGVpZ2h0IG9mIHRoZSBjaGFydCAtIERlZmF1bHRzIHRvIHRoZSBoZWlnaHQgb2YgdGhlIGNvbnRhaW5pbmcgZWxlbWVudFxuKiAgIGNoYXJ0UmFuZ2VNaW4gLSBTcGVjaWZ5IHRoZSBtaW5pbXVtIHZhbHVlIHRvIHVzZSBmb3IgdGhlIFkgcmFuZ2Ugb2YgdGhlIGNoYXJ0IC0gRGVmYXVsdHMgdG8gdGhlIG1pbmltdW0gdmFsdWUgc3VwcGxpZWRcbiogICBjaGFydFJhbmdlTWF4IC0gU3BlY2lmeSB0aGUgbWF4aW11bSB2YWx1ZSB0byB1c2UgZm9yIHRoZSBZIHJhbmdlIG9mIHRoZSBjaGFydCAtIERlZmF1bHRzIHRvIHRoZSBtYXhpbXVtIHZhbHVlIHN1cHBsaWVkXG4qICAgY2hhcnRSYW5nZUNsaXAgLSBDbGlwIG91dCBvZiByYW5nZSB2YWx1ZXMgdG8gdGhlIG1heC9taW4gc3BlY2lmaWVkIGJ5IGNoYXJ0UmFuZ2VNaW4gYW5kIGNoYXJ0UmFuZ2VNYXhcbiogICBjaGFydFJhbmdlTWluWCAtIFNwZWNpZnkgdGhlIG1pbmltdW0gdmFsdWUgdG8gdXNlIGZvciB0aGUgWCByYW5nZSBvZiB0aGUgY2hhcnQgLSBEZWZhdWx0cyB0byB0aGUgbWluaW11bSB2YWx1ZSBzdXBwbGllZFxuKiAgIGNoYXJ0UmFuZ2VNYXhYIC0gU3BlY2lmeSB0aGUgbWF4aW11bSB2YWx1ZSB0byB1c2UgZm9yIHRoZSBYIHJhbmdlIG9mIHRoZSBjaGFydCAtIERlZmF1bHRzIHRvIHRoZSBtYXhpbXVtIHZhbHVlIHN1cHBsaWVkXG4qICAgY29tcG9zaXRlIC0gSWYgdHJ1ZSB0aGVuIGRvbid0IGVyYXNlIGFueSBleGlzdGluZyBjaGFydCBhdHRhY2hlZCB0byB0aGUgdGFnLCBidXQgZHJhd1xuKiAgICAgICAgICAgYW5vdGhlciBjaGFydCBvdmVyIHRoZSB0b3AgLSBOb3RlIHRoYXQgd2lkdGggYW5kIGhlaWdodCBhcmUgaWdub3JlZCBpZiBhblxuKiAgICAgICAgICAgZXhpc3RpbmcgY2hhcnQgaXMgZGV0ZWN0ZWQuXG4qICAgdGFnVmFsdWVzQXR0cmlidXRlIC0gTmFtZSBvZiB0YWcgYXR0cmlidXRlIHRvIGNoZWNrIGZvciBkYXRhIHZhbHVlcyAtIERlZmF1bHRzIHRvICd2YWx1ZXMnXG4qICAgZW5hYmxlVGFnT3B0aW9ucyAtIFdoZXRoZXIgdG8gY2hlY2sgdGFncyBmb3Igc3BhcmtsaW5lIG9wdGlvbnNcbiogICB0YWdPcHRpb25zUHJlZml4IC0gUHJlZml4IHVzZWQgZm9yIG9wdGlvbnMgc3VwcGxpZWQgYXMgdGFnIGF0dHJpYnV0ZXMgLSBEZWZhdWx0cyB0byAnc3BhcmsnXG4qICAgZGlzYWJsZUhpZGRlbkNoZWNrIC0gSWYgc2V0IHRvIHRydWUsIHRoZW4gdGhlIHBsdWdpbiB3aWxsIGFzc3VtZSB0aGF0IGNoYXJ0cyB3aWxsIG5ldmVyIGJlIGRyYXduIGludG8gYVxuKiAgICAgICAgICAgaGlkZGVuIGRvbSBlbGVtZW50LCBhdm9kaW5nIGEgYnJvd3NlciByZWZsb3dcbiogICBkaXNhYmxlSW50ZXJhY3Rpb24gLSBJZiBzZXQgdG8gdHJ1ZSB0aGVuIGFsbCBtb3VzZW92ZXIvY2xpY2sgaW50ZXJhY3Rpb24gYmVoYXZpb3VyIHdpbGwgYmUgZGlzYWJsZWQsXG4qICAgICAgIG1ha2luZyB0aGUgcGx1Z2luIHBlcmZvcm0gbXVjaCBsaWtlIGl0IGRpZCBpbiAxLnhcbiogICBkaXNhYmxlVG9vbHRpcHMgLSBJZiBzZXQgdG8gdHJ1ZSB0aGVuIHRvb2x0aXBzIHdpbGwgYmUgZGlzYWJsZWQgLSBEZWZhdWx0cyB0byBmYWxzZSAodG9vbHRpcHMgZW5hYmxlZClcbiogICBkaXNhYmxlSGlnaGxpZ2h0IC0gSWYgc2V0IHRvIHRydWUgdGhlbiBoaWdobGlnaHRpbmcgb2Ygc2VsZWN0ZWQgY2hhcnQgZWxlbWVudHMgb24gbW91c2VvdmVyIHdpbGwgYmUgZGlzYWJsZWRcbiogICAgICAgZGVmYXVsdHMgdG8gZmFsc2UgKGhpZ2hsaWdodHMgZW5hYmxlZClcbiogICBoaWdobGlnaHRMaWdodGVuIC0gRmFjdG9yIHRvIGxpZ2h0ZW4vZGFya2VuIGhpZ2hsaWdodGVkIGNoYXJ0IHZhbHVlcyBieSAtIERlZmF1bHRzIHRvIDEuNCBmb3IgYSA0MCUgaW5jcmVhc2VcbiogICB0b29sdGlwQ29udGFpbmVyIC0gU3BlY2lmeSB3aGljaCBET00gZWxlbWVudCB0aGUgdG9vbHRpcCBzaG91bGQgYmUgcmVuZGVyZWQgaW50byAtIGRlZmF1bHRzIHRvIGRvY3VtZW50LmJvZHlcbiogICB0b29sdGlwQ2xhc3NuYW1lIC0gT3B0aW9uYWwgQ1NTIGNsYXNzbmFtZSB0byBhcHBseSB0byB0b29sdGlwcyAtIElmIG5vdCBzcGVjaWZpZWQgdGhlbiBhIGRlZmF1bHQgc3R5bGUgd2lsbCBiZSBhcHBsaWVkXG4qICAgdG9vbHRpcE9mZnNldFggLSBIb3cgbWFueSBwaXhlbHMgYXdheSBmcm9tIHRoZSBtb3VzZSBwb2ludGVyIHRvIHJlbmRlciB0aGUgdG9vbHRpcCBvbiB0aGUgWCBheGlzXG4qICAgdG9vbHRpcE9mZnNldFkgLSBIb3cgbWFueSBwaXhlbHMgYXdheSBmcm9tIHRoZSBtb3VzZSBwb2ludGVyIHRvIHJlbmRlciB0aGUgdG9vbHRpcCBvbiB0aGUgciBheGlzXG4qICAgdG9vbHRpcEZvcm1hdHRlciAgLSBPcHRpb25hbCBjYWxsYmFjayB0aGF0IGFsbG93cyB5b3UgdG8gb3ZlcnJpZGUgdGhlIEhUTUwgZGlzcGxheWVkIGluIHRoZSB0b29sdGlwXG4qICAgICAgIGNhbGxiYWNrIGlzIGdpdmVuIGFyZ3VtZW50cyBvZiAoc3BhcmtsaW5lLCBvcHRpb25zLCBmaWVsZHMpXG4qICAgdG9vbHRpcENoYXJ0VGl0bGUgLSBJZiBzcGVjaWZpZWQgdGhlbiB0aGUgdG9vbHRpcCB1c2VzIHRoZSBzdHJpbmcgc3BlY2lmaWVkIGJ5IHRoaXMgc2V0dGluZyBhcyBhIHRpdGxlXG4qICAgdG9vbHRpcEZvcm1hdCAtIEEgZm9ybWF0IHN0cmluZyBvciBTUEZvcm1hdCBvYmplY3QgIChvciBhbiBhcnJheSB0aGVyZW9mIGZvciBtdWx0aXBsZSBlbnRyaWVzKVxuKiAgICAgICB0byBjb250cm9sIHRoZSBmb3JtYXQgb2YgdGhlIHRvb2x0aXBcbiogICB0b29sdGlwUHJlZml4IC0gQSBzdHJpbmcgdG8gcHJlcGVuZCB0byBlYWNoIGZpZWxkIGRpc3BsYXllZCBpbiBhIHRvb2x0aXBcbiogICB0b29sdGlwU3VmZml4IC0gQSBzdHJpbmcgdG8gYXBwZW5kIHRvIGVhY2ggZmllbGQgZGlzcGxheWVkIGluIGEgdG9vbHRpcFxuKiAgIHRvb2x0aXBTa2lwTnVsbCAtIElmIHRydWUgdGhlbiBudWxsIHZhbHVlcyB3aWxsIG5vdCBoYXZlIGEgdG9vbHRpcCBkaXNwbGF5ZWQgKGRlZmF1bHRzIHRvIHRydWUpXG4qICAgdG9vbHRpcFZhbHVlTG9va3VwcyAtIEFuIG9iamVjdCBvciByYW5nZSBtYXAgdG8gbWFwIGZpZWxkIHZhbHVlcyB0byB0b29sdGlwIHN0cmluZ3NcbiogICAgICAgKGVnLiB0byBtYXAgLTEgdG8gXCJMb3N0XCIsIDAgdG8gXCJEcmF3XCIsIGFuZCAxIHRvIFwiV2luXCIpXG4qICAgbnVtYmVyRm9ybWF0dGVyIC0gT3B0aW9uYWwgY2FsbGJhY2sgZm9yIGZvcm1hdHRpbmcgbnVtYmVycyBpbiB0b29sdGlwc1xuKiAgIG51bWJlckRpZ2l0R3JvdXBTZXAgLSBDaGFyYWN0ZXIgdG8gdXNlIGZvciBncm91cCBzZXBhcmF0b3IgaW4gbnVtYmVycyBcIjEsMjM0XCIgLSBEZWZhdWx0cyB0byBcIixcIlxuKiAgIG51bWJlckRlY2ltYWxNYXJrIC0gQ2hhcmFjdGVyIHRvIHVzZSBmb3IgdGhlIGRlY2ltYWwgcG9pbnQgd2hlbiBmb3JtYXR0aW5nIG51bWJlcnMgLSBEZWZhdWx0cyB0byBcIi5cIlxuKiAgIG51bWJlckRpZ2l0R3JvdXBDb3VudCAtIE51bWJlciBvZiBkaWdpdHMgYmV0d2VlbiBncm91cCBzZXBhcmF0b3IgLSBEZWZhdWx0cyB0byAzXG4qXG4qIFRoZXJlIGFyZSA3IHR5cGVzIG9mIHNwYXJrbGluZSwgc2VsZWN0ZWQgYnkgc3VwcGx5aW5nIGEgXCJ0eXBlXCIgb3B0aW9uIG9mICdsaW5lJyAoZGVmYXVsdCksXG4qICdiYXInLCAndHJpc3RhdGUnLCAnYnVsbGV0JywgJ2Rpc2NyZXRlJywgJ3BpZScgb3IgJ2JveCdcbiogICAgbGluZSAtIExpbmUgY2hhcnQuICBPcHRpb25zOlxuKiAgICAgICBzcG90Q29sb3IgLSBTZXQgdG8gJycgdG8gbm90IGVuZCBlYWNoIGxpbmUgaW4gYSBjaXJjdWxhciBzcG90XG4qICAgICAgIG1pblNwb3RDb2xvciAtIElmIHNldCwgY29sb3Igb2Ygc3BvdCBhdCBtaW5pbXVtIHZhbHVlXG4qICAgICAgIG1heFNwb3RDb2xvciAtIElmIHNldCwgY29sb3Igb2Ygc3BvdCBhdCBtYXhpbXVtIHZhbHVlXG4qICAgICAgIHNwb3RSYWRpdXMgLSBSYWRpdXMgaW4gcGl4ZWxzXG4qICAgICAgIGxpbmVXaWR0aCAtIFdpZHRoIG9mIGxpbmUgaW4gcGl4ZWxzXG4qICAgICAgIG5vcm1hbFJhbmdlTWluXG4qICAgICAgIG5vcm1hbFJhbmdlTWF4IC0gSWYgc2V0IGRyYXdzIGEgZmlsbGVkIGhvcml6b250YWwgYmFyIGJldHdlZW4gdGhlc2UgdHdvIHZhbHVlcyBtYXJraW5nIHRoZSBcIm5vcm1hbFwiXG4qICAgICAgICAgICAgICAgICAgICAgIG9yIGV4cGVjdGVkIHJhbmdlIG9mIHZhbHVlc1xuKiAgICAgICBub3JtYWxSYW5nZUNvbG9yIC0gQ29sb3IgdG8gdXNlIGZvciB0aGUgYWJvdmUgYmFyXG4qICAgICAgIGRyYXdOb3JtYWxPblRvcCAtIERyYXcgdGhlIG5vcm1hbCByYW5nZSBhYm92ZSB0aGUgY2hhcnQgZmlsbCBjb2xvciBpZiB0cnVlXG4qICAgICAgIGRlZmF1bHRQaXhlbHNQZXJWYWx1ZSAtIERlZmF1bHRzIHRvIDMgcGl4ZWxzIG9mIHdpZHRoIGZvciBlYWNoIHZhbHVlIGluIHRoZSBjaGFydFxuKiAgICAgICBoaWdobGlnaHRTcG90Q29sb3IgLSBUaGUgY29sb3IgdG8gdXNlIGZvciBkcmF3aW5nIGEgaGlnaGxpZ2h0IHNwb3Qgb24gbW91c2VvdmVyIC0gU2V0IHRvIG51bGwgdG8gZGlzYWJsZVxuKiAgICAgICBoaWdobGlnaHRMaW5lQ29sb3IgLSBUaGUgY29sb3IgdG8gdXNlIGZvciBkcmF3aW5nIGEgaGlnaGxpZ2h0IGxpbmUgb24gbW91c2VvdmVyIC0gU2V0IHRvIG51bGwgdG8gZGlzYWJsZVxuKiAgICAgICB2YWx1ZVNwb3RzIC0gU3BlY2lmeSB3aGljaCBwb2ludHMgdG8gZHJhdyBzcG90cyBvbiwgYW5kIGluIHdoaWNoIGNvbG9yLiAgQWNjZXB0cyBhIHJhbmdlIG1hcFxuKlxuKiAgIGJhciAtIEJhciBjaGFydC4gIE9wdGlvbnM6XG4qICAgICAgIGJhckNvbG9yIC0gQ29sb3Igb2YgYmFycyBmb3IgcG9zdGl2ZSB2YWx1ZXNcbiogICAgICAgbmVnQmFyQ29sb3IgLSBDb2xvciBvZiBiYXJzIGZvciBuZWdhdGl2ZSB2YWx1ZXNcbiogICAgICAgemVyb0NvbG9yIC0gQ29sb3Igb2YgYmFycyB3aXRoIHplcm8gdmFsdWVzXG4qICAgICAgIG51bGxDb2xvciAtIENvbG9yIG9mIGJhcnMgd2l0aCBudWxsIHZhbHVlcyAtIERlZmF1bHRzIHRvIG9taXR0aW5nIHRoZSBiYXIgZW50aXJlbHlcbiogICAgICAgYmFyV2lkdGggLSBXaWR0aCBvZiBiYXJzIGluIHBpeGVsc1xuKiAgICAgICBjb2xvck1hcCAtIE9wdGlvbmFsIG1hcHBuaWcgb2YgdmFsdWVzIHRvIGNvbG9ycyB0byBvdmVycmlkZSB0aGUgKkJhckNvbG9yIHZhbHVlcyBhYm92ZVxuKiAgICAgICAgICAgICAgICAgIGNhbiBiZSBhbiBBcnJheSBvZiB2YWx1ZXMgdG8gY29udHJvbCB0aGUgY29sb3Igb2YgaW5kaXZpZHVhbCBiYXJzIG9yIGEgcmFuZ2UgbWFwXG4qICAgICAgICAgICAgICAgICAgdG8gc3BlY2lmeSBjb2xvcnMgZm9yIGluZGl2aWR1YWwgcmFuZ2VzIG9mIHZhbHVlc1xuKiAgICAgICBiYXJTcGFjaW5nIC0gR2FwIGJldHdlZW4gYmFycyBpbiBwaXhlbHNcbiogICAgICAgemVyb0F4aXMgLSBDZW50ZXJzIHRoZSB5LWF4aXMgYXJvdW5kIHplcm8gaWYgdHJ1ZVxuKlxuKiAgIHRyaXN0YXRlIC0gQ2hhcnRzIHZhbHVlcyBvZiB3aW4gKD4wKSwgbG9zZSAoPDApIG9yIGRyYXcgKD0wKVxuKiAgICAgICBwb3NCYXJDb2xvciAtIENvbG9yIG9mIHdpbiB2YWx1ZXNcbiogICAgICAgbmVnQmFyQ29sb3IgLSBDb2xvciBvZiBsb3NlIHZhbHVlc1xuKiAgICAgICB6ZXJvQmFyQ29sb3IgLSBDb2xvciBvZiBkcmF3IHZhbHVlc1xuKiAgICAgICBiYXJXaWR0aCAtIFdpZHRoIG9mIGJhcnMgaW4gcGl4ZWxzXG4qICAgICAgIGJhclNwYWNpbmcgLSBHYXAgYmV0d2VlbiBiYXJzIGluIHBpeGVsc1xuKiAgICAgICBjb2xvck1hcCAtIE9wdGlvbmFsIG1hcHBuaWcgb2YgdmFsdWVzIHRvIGNvbG9ycyB0byBvdmVycmlkZSB0aGUgKkJhckNvbG9yIHZhbHVlcyBhYm92ZVxuKiAgICAgICAgICAgICAgICAgIGNhbiBiZSBhbiBBcnJheSBvZiB2YWx1ZXMgdG8gY29udHJvbCB0aGUgY29sb3Igb2YgaW5kaXZpZHVhbCBiYXJzIG9yIGEgcmFuZ2UgbWFwXG4qICAgICAgICAgICAgICAgICAgdG8gc3BlY2lmeSBjb2xvcnMgZm9yIGluZGl2aWR1YWwgcmFuZ2VzIG9mIHZhbHVlc1xuKlxuKiAgIGRpc2NyZXRlIC0gT3B0aW9uczpcbiogICAgICAgbGluZUhlaWdodCAtIEhlaWdodCBvZiBlYWNoIGxpbmUgaW4gcGl4ZWxzIC0gRGVmYXVsdHMgdG8gMzAlIG9mIHRoZSBncmFwaCBoZWlnaHRcbiogICAgICAgdGhlc2hvbGRWYWx1ZSAtIFZhbHVlcyBsZXNzIHRoYW4gdGhpcyB2YWx1ZSB3aWxsIGJlIGRyYXduIHVzaW5nIHRocmVzaG9sZENvbG9yIGluc3RlYWQgb2YgbGluZUNvbG9yXG4qICAgICAgIHRocmVzaG9sZENvbG9yXG4qXG4qICAgYnVsbGV0IC0gVmFsdWVzIGZvciBidWxsZXQgZ3JhcGhzIG1zdXQgYmUgaW4gdGhlIG9yZGVyOiB0YXJnZXQsIHBlcmZvcm1hbmNlLCByYW5nZTEsIHJhbmdlMiwgcmFuZ2UzLCAuLi5cbiogICAgICAgb3B0aW9uczpcbiogICAgICAgdGFyZ2V0Q29sb3IgLSBUaGUgY29sb3Igb2YgdGhlIHZlcnRpY2FsIHRhcmdldCBtYXJrZXJcbiogICAgICAgdGFyZ2V0V2lkdGggLSBUaGUgd2lkdGggb2YgdGhlIHRhcmdldCBtYXJrZXIgaW4gcGl4ZWxzXG4qICAgICAgIHBlcmZvcm1hbmNlQ29sb3IgLSBUaGUgY29sb3Igb2YgdGhlIHBlcmZvcm1hbmNlIG1lYXN1cmUgaG9yaXpvbnRhbCBiYXJcbiogICAgICAgcmFuZ2VDb2xvcnMgLSBDb2xvcnMgdG8gdXNlIGZvciBlYWNoIHF1YWxpdGF0aXZlIHJhbmdlIGJhY2tncm91bmQgY29sb3JcbipcbiogICBwaWUgLSBQaWUgY2hhcnQuIE9wdGlvbnM6XG4qICAgICAgIHNsaWNlQ29sb3JzIC0gQW4gYXJyYXkgb2YgY29sb3JzIHRvIHVzZSBmb3IgcGllIHNsaWNlc1xuKiAgICAgICBvZmZzZXQgLSBBbmdsZSBpbiBkZWdyZWVzIHRvIG9mZnNldCB0aGUgZmlyc3Qgc2xpY2UgLSBUcnkgLTkwIG9yICs5MFxuKiAgICAgICBib3JkZXJXaWR0aCAtIFdpZHRoIG9mIGJvcmRlciB0byBkcmF3IGFyb3VuZCB0aGUgcGllIGNoYXJ0LCBpbiBwaXhlbHMgLSBEZWZhdWx0cyB0byAwIChubyBib3JkZXIpXG4qICAgICAgIGJvcmRlckNvbG9yIC0gQ29sb3IgdG8gdXNlIGZvciB0aGUgcGllIGNoYXJ0IGJvcmRlciAtIERlZmF1bHRzIHRvICMwMDBcbipcbiogICBib3ggLSBCb3ggcGxvdC4gT3B0aW9uczpcbiogICAgICAgcmF3IC0gU2V0IHRvIHRydWUgdG8gc3VwcGx5IHByZS1jb21wdXRlZCBwbG90IHBvaW50cyBhcyB2YWx1ZXNcbiogICAgICAgICAgICAgdmFsdWVzIHNob3VsZCBiZTogbG93X291dGxpZXIsIGxvd193aGlza2VyLCBxMSwgbWVkaWFuLCBxMywgaGlnaF93aGlza2VyLCBoaWdoX291dGxpZXJcbiogICAgICAgICAgICAgV2hlbiBzZXQgdG8gZmFsc2UgeW91IGNhbiBzdXBwbHkgYW55IG51bWJlciBvZiB2YWx1ZXMgYW5kIHRoZSBib3ggcGxvdCB3aWxsXG4qICAgICAgICAgICAgIGJlIGNvbXB1dGVkIGZvciB5b3UuICBEZWZhdWx0IGlzIGZhbHNlLlxuKiAgICAgICBzaG93T3V0bGllcnMgLSBTZXQgdG8gdHJ1ZSAoZGVmYXVsdCkgdG8gZGlzcGxheSBvdXRsaWVycyBhcyBjaXJjbGVzXG4qICAgICAgIG91dGxpZXJJUVIgLSBJbnRlcnF1YXJ0aWxlIHJhbmdlIHVzZWQgdG8gZGV0ZXJtaW5lIG91dGxpZXJzLiAgRGVmYXVsdCAxLjVcbiogICAgICAgYm94TGluZUNvbG9yIC0gT3V0bGluZSBjb2xvciBvZiB0aGUgYm94XG4qICAgICAgIGJveEZpbGxDb2xvciAtIEZpbGwgY29sb3IgZm9yIHRoZSBib3hcbiogICAgICAgd2hpc2tlckNvbG9yIC0gTGluZSBjb2xvciB1c2VkIGZvciB3aGlza2Vyc1xuKiAgICAgICBvdXRsaWVyTGluZUNvbG9yIC0gT3V0bGluZSBjb2xvciBvZiBvdXRsaWVyIGNpcmNsZXNcbiogICAgICAgb3V0bGllckZpbGxDb2xvciAtIEZpbGwgY29sb3Igb2YgdGhlIG91dGxpZXIgY2lyY2xlc1xuKiAgICAgICBzcG90UmFkaXVzIC0gUmFkaXVzIG9mIG91dGxpZXIgY2lyY2xlc1xuKiAgICAgICBtZWRpYW5Db2xvciAtIExpbmUgY29sb3Igb2YgdGhlIG1lZGlhbiBsaW5lXG4qICAgICAgIHRhcmdldCAtIERyYXcgYSB0YXJnZXQgY3Jvc3MgaGFpciBhdCB0aGUgc3VwcGxpZWQgdmFsdWUgKGRlZmF1bHQgdW5kZWZpbmVkKVxuKlxuKlxuKlxuKiAgIEV4YW1wbGVzOlxuKiAgICQoJyNzcGFya2xpbmUxJykuc3BhcmtsaW5lKG15dmFsdWVzLCB7IGxpbmVDb2xvcjogJyNmMDAnLCBmaWxsQ29sb3I6IGZhbHNlIH0pO1xuKiAgICQoJy5iYXJzcGFya3MnKS5zcGFya2xpbmUoJ2h0bWwnLCB7IHR5cGU6J2JhcicsIGhlaWdodDonNDBweCcsIGJhcldpZHRoOjUgfSk7XG4qICAgJCgnI3RyaXN0YXRlJykuc3BhcmtsaW5lKFsxLDEsLTEsMSwwLDAsLTFdLCB7IHR5cGU6J3RyaXN0YXRlJyB9KTpcbiogICAkKCcjZGlzY3JldGUnKS5zcGFya2xpbmUoWzEsMyw0LDUsNSwzLDQsNV0sIHsgdHlwZTonZGlzY3JldGUnIH0pO1xuKiAgICQoJyNidWxsZXQnKS5zcGFya2xpbmUoWzEwLDEyLDEyLDksN10sIHsgdHlwZTonYnVsbGV0JyB9KTtcbiogICAkKCcjcGllJykuc3BhcmtsaW5lKFsxLDEsMl0sIHsgdHlwZToncGllJyB9KTtcbiovXG5cbi8qanNsaW50IHJlZ2V4cDogdHJ1ZSwgYnJvd3NlcjogdHJ1ZSwganF1ZXJ5OiB0cnVlLCB3aGl0ZTogdHJ1ZSwgbm9tZW46IGZhbHNlLCBwbHVzcGx1czogZmFsc2UsIG1heGVycjogNTAwLCBpbmRlbnQ6IDQgKi9cblxuKGZ1bmN0aW9uKGRvY3VtZW50LCBNYXRoLCB1bmRlZmluZWQpIHsgLy8gcGVyZm9ybWFuY2UvbWluaWZpZWQtc2l6ZSBvcHRpbWl6YXRpb25cbihmdW5jdGlvbihmYWN0b3J5KSB7XG4gICAgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG4gICAgICAgIGRlZmluZShbJ2pxdWVyeSddLCBmYWN0b3J5KTtcbiAgICB9IGVsc2UgaWYgKGpRdWVyeSAmJiAhalF1ZXJ5LmZuLnNwYXJrbGluZSkge1xuICAgICAgICBmYWN0b3J5KGpRdWVyeSk7XG4gICAgfVxufVxuKGZ1bmN0aW9uKCQpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICB2YXIgVU5TRVRfT1BUSU9OID0ge30sXG4gICAgICAgIGdldERlZmF1bHRzLCBjcmVhdGVDbGFzcywgU1BGb3JtYXQsIGNsaXB2YWwsIHF1YXJ0aWxlLCBub3JtYWxpemVWYWx1ZSwgbm9ybWFsaXplVmFsdWVzLFxuICAgICAgICByZW1vdmUsIGlzTnVtYmVyLCBhbGwsIHN1bSwgYWRkQ1NTLCBlbnN1cmVBcnJheSwgZm9ybWF0TnVtYmVyLCBSYW5nZU1hcCxcbiAgICAgICAgTW91c2VIYW5kbGVyLCBUb29sdGlwLCBiYXJIaWdobGlnaHRNaXhpbixcbiAgICAgICAgbGluZSwgYmFyLCB0cmlzdGF0ZSwgZGlzY3JldGUsIGJ1bGxldCwgcGllLCBib3gsIGRlZmF1bHRTdHlsZXMsIGluaXRTdHlsZXMsXG4gICAgICAgIFZTaGFwZSwgVkNhbnZhc19iYXNlLCBWQ2FudmFzX2NhbnZhcywgVkNhbnZhc192bWwsIHBlbmRpbmcsIHNoYXBlQ291bnQgPSAwO1xuXG4gICAgLyoqXG4gICAgICogRGVmYXVsdCBjb25maWd1cmF0aW9uIHNldHRpbmdzXG4gICAgICovXG4gICAgZ2V0RGVmYXVsdHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAvLyBTZXR0aW5ncyBjb21tb24gdG8gbW9zdC9hbGwgY2hhcnQgdHlwZXNcbiAgICAgICAgICAgIGNvbW1vbjoge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdsaW5lJyxcbiAgICAgICAgICAgICAgICBsaW5lQ29sb3I6ICcjMDBmJyxcbiAgICAgICAgICAgICAgICBmaWxsQ29sb3I6ICcjY2RmJyxcbiAgICAgICAgICAgICAgICBkZWZhdWx0UGl4ZWxzUGVyVmFsdWU6IDMsXG4gICAgICAgICAgICAgICAgd2lkdGg6ICdhdXRvJyxcbiAgICAgICAgICAgICAgICBoZWlnaHQ6ICdhdXRvJyxcbiAgICAgICAgICAgICAgICBjb21wb3NpdGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHRhZ1ZhbHVlc0F0dHJpYnV0ZTogJ3ZhbHVlcycsXG4gICAgICAgICAgICAgICAgdGFnT3B0aW9uc1ByZWZpeDogJ3NwYXJrJyxcbiAgICAgICAgICAgICAgICBlbmFibGVUYWdPcHRpb25zOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlbmFibGVIaWdobGlnaHQ6IHRydWUsXG4gICAgICAgICAgICAgICAgaGlnaGxpZ2h0TGlnaHRlbjogMS40LFxuICAgICAgICAgICAgICAgIHRvb2x0aXBTa2lwTnVsbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICB0b29sdGlwUHJlZml4OiAnJyxcbiAgICAgICAgICAgICAgICB0b29sdGlwU3VmZml4OiAnJyxcbiAgICAgICAgICAgICAgICBkaXNhYmxlSGlkZGVuQ2hlY2s6IGZhbHNlLFxuICAgICAgICAgICAgICAgIG51bWJlckZvcm1hdHRlcjogZmFsc2UsXG4gICAgICAgICAgICAgICAgbnVtYmVyRGlnaXRHcm91cENvdW50OiAzLFxuICAgICAgICAgICAgICAgIG51bWJlckRpZ2l0R3JvdXBTZXA6ICcsJyxcbiAgICAgICAgICAgICAgICBudW1iZXJEZWNpbWFsTWFyazogJy4nLFxuICAgICAgICAgICAgICAgIGRpc2FibGVUb29sdGlwczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZGlzYWJsZUludGVyYWN0aW9uOiBmYWxzZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIC8vIERlZmF1bHRzIGZvciBsaW5lIGNoYXJ0c1xuICAgICAgICAgICAgbGluZToge1xuICAgICAgICAgICAgICAgIHNwb3RDb2xvcjogJyNmODAnLFxuICAgICAgICAgICAgICAgIGhpZ2hsaWdodFNwb3RDb2xvcjogJyM1ZjUnLFxuICAgICAgICAgICAgICAgIGhpZ2hsaWdodExpbmVDb2xvcjogJyNmMjInLFxuICAgICAgICAgICAgICAgIHNwb3RSYWRpdXM6IDEuNSxcbiAgICAgICAgICAgICAgICBtaW5TcG90Q29sb3I6ICcjZjgwJyxcbiAgICAgICAgICAgICAgICBtYXhTcG90Q29sb3I6ICcjZjgwJyxcbiAgICAgICAgICAgICAgICBsaW5lV2lkdGg6IDEsXG4gICAgICAgICAgICAgICAgbm9ybWFsUmFuZ2VNaW46IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICBub3JtYWxSYW5nZU1heDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIG5vcm1hbFJhbmdlQ29sb3I6ICcjY2NjJyxcbiAgICAgICAgICAgICAgICBkcmF3Tm9ybWFsT25Ub3A6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGNoYXJ0UmFuZ2VNaW46IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICBjaGFydFJhbmdlTWF4OiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgY2hhcnRSYW5nZU1pblg6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICBjaGFydFJhbmdlTWF4WDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIHRvb2x0aXBGb3JtYXQ6IG5ldyBTUEZvcm1hdCgnPHNwYW4gc3R5bGU9XCJjb2xvcjoge3tjb2xvcn19XCI+JiM5Njc5Ozwvc3Bhbj4ge3twcmVmaXh9fXt7eX19e3tzdWZmaXh9fScpXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgLy8gRGVmYXVsdHMgZm9yIGJhciBjaGFydHNcbiAgICAgICAgICAgIGJhcjoge1xuICAgICAgICAgICAgICAgIGJhckNvbG9yOiAnIzMzNjZjYycsXG4gICAgICAgICAgICAgICAgbmVnQmFyQ29sb3I6ICcjZjQ0JyxcbiAgICAgICAgICAgICAgICBzdGFja2VkQmFyQ29sb3I6IFsnIzMzNjZjYycsICcjZGMzOTEyJywgJyNmZjk5MDAnLCAnIzEwOTYxOCcsICcjNjZhYTAwJyxcbiAgICAgICAgICAgICAgICAgICAgJyNkZDQ0NzcnLCAnIzAwOTljNicsICcjOTkwMDk5J10sXG4gICAgICAgICAgICAgICAgemVyb0NvbG9yOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgbnVsbENvbG9yOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgemVyb0F4aXM6IHRydWUsXG4gICAgICAgICAgICAgICAgYmFyV2lkdGg6IDQsXG4gICAgICAgICAgICAgICAgYmFyU3BhY2luZzogMSxcbiAgICAgICAgICAgICAgICBjaGFydFJhbmdlTWF4OiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgY2hhcnRSYW5nZU1pbjogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIGNoYXJ0UmFuZ2VDbGlwOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBjb2xvck1hcDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIHRvb2x0aXBGb3JtYXQ6IG5ldyBTUEZvcm1hdCgnPHNwYW4gc3R5bGU9XCJjb2xvcjoge3tjb2xvcn19XCI+JiM5Njc5Ozwvc3Bhbj4ge3twcmVmaXh9fXt7dmFsdWV9fXt7c3VmZml4fX0nKVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIC8vIERlZmF1bHRzIGZvciB0cmlzdGF0ZSBjaGFydHNcbiAgICAgICAgICAgIHRyaXN0YXRlOiB7XG4gICAgICAgICAgICAgICAgYmFyV2lkdGg6IDQsXG4gICAgICAgICAgICAgICAgYmFyU3BhY2luZzogMSxcbiAgICAgICAgICAgICAgICBwb3NCYXJDb2xvcjogJyM2ZjYnLFxuICAgICAgICAgICAgICAgIG5lZ0JhckNvbG9yOiAnI2Y0NCcsXG4gICAgICAgICAgICAgICAgemVyb0JhckNvbG9yOiAnIzk5OScsXG4gICAgICAgICAgICAgICAgY29sb3JNYXA6IHt9LFxuICAgICAgICAgICAgICAgIHRvb2x0aXBGb3JtYXQ6IG5ldyBTUEZvcm1hdCgnPHNwYW4gc3R5bGU9XCJjb2xvcjoge3tjb2xvcn19XCI+JiM5Njc5Ozwvc3Bhbj4ge3t2YWx1ZTptYXB9fScpLFxuICAgICAgICAgICAgICAgIHRvb2x0aXBWYWx1ZUxvb2t1cHM6IHsgbWFwOiB7ICctMSc6ICdMb3NzJywgJzAnOiAnRHJhdycsICcxJzogJ1dpbicgfSB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgLy8gRGVmYXVsdHMgZm9yIGRpc2NyZXRlIGNoYXJ0c1xuICAgICAgICAgICAgZGlzY3JldGU6IHtcbiAgICAgICAgICAgICAgICBsaW5lSGVpZ2h0OiAnYXV0bycsXG4gICAgICAgICAgICAgICAgdGhyZXNob2xkQ29sb3I6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICB0aHJlc2hvbGRWYWx1ZTogMCxcbiAgICAgICAgICAgICAgICBjaGFydFJhbmdlTWF4OiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgY2hhcnRSYW5nZU1pbjogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIGNoYXJ0UmFuZ2VDbGlwOiBmYWxzZSxcbiAgICAgICAgICAgICAgICB0b29sdGlwRm9ybWF0OiBuZXcgU1BGb3JtYXQoJ3t7cHJlZml4fX17e3ZhbHVlfX17e3N1ZmZpeH19JylcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvLyBEZWZhdWx0cyBmb3IgYnVsbGV0IGNoYXJ0c1xuICAgICAgICAgICAgYnVsbGV0OiB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0Q29sb3I6ICcjZjMzJyxcbiAgICAgICAgICAgICAgICB0YXJnZXRXaWR0aDogMywgLy8gd2lkdGggb2YgdGhlIHRhcmdldCBiYXIgaW4gcGl4ZWxzXG4gICAgICAgICAgICAgICAgcGVyZm9ybWFuY2VDb2xvcjogJyMzM2YnLFxuICAgICAgICAgICAgICAgIHJhbmdlQ29sb3JzOiBbJyNkM2RhZmUnLCAnI2E4YjZmZicsICcjN2Y5NGZmJ10sXG4gICAgICAgICAgICAgICAgYmFzZTogdW5kZWZpbmVkLCAvLyBzZXQgdGhpcyB0byBhIG51bWJlciB0byBjaGFuZ2UgdGhlIGJhc2Ugc3RhcnQgbnVtYmVyXG4gICAgICAgICAgICAgICAgdG9vbHRpcEZvcm1hdDogbmV3IFNQRm9ybWF0KCd7e2ZpZWxka2V5OmZpZWxkc319IC0ge3t2YWx1ZX19JyksXG4gICAgICAgICAgICAgICAgdG9vbHRpcFZhbHVlTG9va3VwczogeyBmaWVsZHM6IHtyOiAnUmFuZ2UnLCBwOiAnUGVyZm9ybWFuY2UnLCB0OiAnVGFyZ2V0J30gfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIC8vIERlZmF1bHRzIGZvciBwaWUgY2hhcnRzXG4gICAgICAgICAgICBwaWU6IHtcbiAgICAgICAgICAgICAgICBvZmZzZXQ6IDAsXG4gICAgICAgICAgICAgICAgc2xpY2VDb2xvcnM6IFsnIzMzNjZjYycsICcjZGMzOTEyJywgJyNmZjk5MDAnLCAnIzEwOTYxOCcsICcjNjZhYTAwJyxcbiAgICAgICAgICAgICAgICAgICAgJyNkZDQ0NzcnLCAnIzAwOTljNicsICcjOTkwMDk5J10sXG4gICAgICAgICAgICAgICAgYm9yZGVyV2lkdGg6IDAsXG4gICAgICAgICAgICAgICAgYm9yZGVyQ29sb3I6ICcjMDAwJyxcbiAgICAgICAgICAgICAgICB0b29sdGlwRm9ybWF0OiBuZXcgU1BGb3JtYXQoJzxzcGFuIHN0eWxlPVwiY29sb3I6IHt7Y29sb3J9fVwiPiYjOTY3OTs8L3NwYW4+IHt7dmFsdWV9fSAoe3twZXJjZW50LjF9fSUpJylcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvLyBEZWZhdWx0cyBmb3IgYm94IHBsb3RzXG4gICAgICAgICAgICBib3g6IHtcbiAgICAgICAgICAgICAgICByYXc6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGJveExpbmVDb2xvcjogJyMwMDAnLFxuICAgICAgICAgICAgICAgIGJveEZpbGxDb2xvcjogJyNjZGYnLFxuICAgICAgICAgICAgICAgIHdoaXNrZXJDb2xvcjogJyMwMDAnLFxuICAgICAgICAgICAgICAgIG91dGxpZXJMaW5lQ29sb3I6ICcjMzMzJyxcbiAgICAgICAgICAgICAgICBvdXRsaWVyRmlsbENvbG9yOiAnI2ZmZicsXG4gICAgICAgICAgICAgICAgbWVkaWFuQ29sb3I6ICcjZjAwJyxcbiAgICAgICAgICAgICAgICBzaG93T3V0bGllcnM6IHRydWUsXG4gICAgICAgICAgICAgICAgb3V0bGllcklRUjogMS41LFxuICAgICAgICAgICAgICAgIHNwb3RSYWRpdXM6IDEuNSxcbiAgICAgICAgICAgICAgICB0YXJnZXQ6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICB0YXJnZXRDb2xvcjogJyM0YTInLFxuICAgICAgICAgICAgICAgIGNoYXJ0UmFuZ2VNYXg6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICBjaGFydFJhbmdlTWluOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgdG9vbHRpcEZvcm1hdDogbmV3IFNQRm9ybWF0KCd7e2ZpZWxkOmZpZWxkc319OiB7e3ZhbHVlfX0nKSxcbiAgICAgICAgICAgICAgICB0b29sdGlwRm9ybWF0RmllbGRsaXN0S2V5OiAnZmllbGQnLFxuICAgICAgICAgICAgICAgIHRvb2x0aXBWYWx1ZUxvb2t1cHM6IHsgZmllbGRzOiB7IGxxOiAnTG93ZXIgUXVhcnRpbGUnLCBtZWQ6ICdNZWRpYW4nLFxuICAgICAgICAgICAgICAgICAgICB1cTogJ1VwcGVyIFF1YXJ0aWxlJywgbG86ICdMZWZ0IE91dGxpZXInLCBybzogJ1JpZ2h0IE91dGxpZXInLFxuICAgICAgICAgICAgICAgICAgICBsdzogJ0xlZnQgV2hpc2tlcicsIHJ3OiAnUmlnaHQgV2hpc2tlcid9IH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgLy8gWW91IGNhbiBoYXZlIHRvb2x0aXBzIHVzZSBhIGNzcyBjbGFzcyBvdGhlciB0aGFuIGpxc3Rvb2x0aXAgYnkgc3BlY2lmeWluZyB0b29sdGlwQ2xhc3NuYW1lXG4gICAgZGVmYXVsdFN0eWxlcyA9ICcuanFzdG9vbHRpcCB7ICcgK1xuICAgICAgICAgICAgJ3Bvc2l0aW9uOiBhYnNvbHV0ZTsnICtcbiAgICAgICAgICAgICdsZWZ0OiAwcHg7JyArXG4gICAgICAgICAgICAndG9wOiAwcHg7JyArXG4gICAgICAgICAgICAndmlzaWJpbGl0eTogaGlkZGVuOycgK1xuICAgICAgICAgICAgJ2JhY2tncm91bmQ6IHJnYigwLCAwLCAwKSB0cmFuc3BhcmVudDsnICtcbiAgICAgICAgICAgICdiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDAsMCwwLDAuNik7JyArXG4gICAgICAgICAgICAnZmlsdGVyOnByb2dpZDpEWEltYWdlVHJhbnNmb3JtLk1pY3Jvc29mdC5ncmFkaWVudChzdGFydENvbG9yc3RyPSM5OTAwMDAwMCwgZW5kQ29sb3JzdHI9Izk5MDAwMDAwKTsnICtcbiAgICAgICAgICAgICctbXMtZmlsdGVyOiBcInByb2dpZDpEWEltYWdlVHJhbnNmb3JtLk1pY3Jvc29mdC5ncmFkaWVudChzdGFydENvbG9yc3RyPSM5OTAwMDAwMCwgZW5kQ29sb3JzdHI9Izk5MDAwMDAwKVwiOycgK1xuICAgICAgICAgICAgJ2NvbG9yOiB3aGl0ZTsnICtcbiAgICAgICAgICAgICdmb250OiAxMHB4IGFyaWFsLCBzYW4gc2VyaWY7JyArXG4gICAgICAgICAgICAndGV4dC1hbGlnbjogbGVmdDsnICtcbiAgICAgICAgICAgICd3aGl0ZS1zcGFjZTogbm93cmFwOycgK1xuICAgICAgICAgICAgJ3BhZGRpbmc6IDVweDsnICtcbiAgICAgICAgICAgICdib3JkZXI6IDFweCBzb2xpZCB3aGl0ZTsnICtcbiAgICAgICAgICAgICdib3gtc2l6aW5nOiBjb250ZW50LWJveDsnICtcbiAgICAgICAgICAgICd6LWluZGV4OiAxMDAwMDsnICtcbiAgICAgICAgICAgICd9JyArXG4gICAgICAgICAgICAnLmpxc2ZpZWxkIHsgJyArXG4gICAgICAgICAgICAnY29sb3I6IHdoaXRlOycgK1xuICAgICAgICAgICAgJ2ZvbnQ6IDEwcHggYXJpYWwsIHNhbiBzZXJpZjsnICtcbiAgICAgICAgICAgICd0ZXh0LWFsaWduOiBsZWZ0OycgK1xuICAgICAgICAgICAgJ30nO1xuXG4gICAgLyoqXG4gICAgICogVXRpbGl0aWVzXG4gICAgICovXG5cbiAgICBjcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgvKiBbYmFzZWNsYXNzLCBbbWl4aW4sIC4uLl1dLCBkZWZpbml0aW9uICovKSB7XG4gICAgICAgIHZhciBDbGFzcywgYXJncztcbiAgICAgICAgQ2xhc3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLmluaXQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICBpZiAoYXJndW1lbnRzWzBdKSB7XG4gICAgICAgICAgICAgICAgQ2xhc3MucHJvdG90eXBlID0gJC5leHRlbmQobmV3IGFyZ3VtZW50c1swXSgpLCBhcmd1bWVudHNbYXJndW1lbnRzLmxlbmd0aCAtIDFdKTtcbiAgICAgICAgICAgICAgICBDbGFzcy5fc3VwZXIgPSBhcmd1bWVudHNbMF0ucHJvdG90eXBlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBDbGFzcy5wcm90b3R5cGUgPSBhcmd1bWVudHNbYXJndW1lbnRzLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAyKSB7XG4gICAgICAgICAgICAgICAgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSwgLTEpO1xuICAgICAgICAgICAgICAgIGFyZ3MudW5zaGlmdChDbGFzcy5wcm90b3R5cGUpO1xuICAgICAgICAgICAgICAgICQuZXh0ZW5kLmFwcGx5KCQsIGFyZ3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgQ2xhc3MucHJvdG90eXBlID0gYXJndW1lbnRzWzBdO1xuICAgICAgICB9XG4gICAgICAgIENsYXNzLnByb3RvdHlwZS5jbHMgPSBDbGFzcztcbiAgICAgICAgcmV0dXJuIENsYXNzO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBXcmFwcyBhIGZvcm1hdCBzdHJpbmcgZm9yIHRvb2x0aXBzXG4gICAgICoge3t4fX1cbiAgICAgKiB7e3guMn1cbiAgICAgKiB7e3g6bW9udGhzfX1cbiAgICAgKi9cbiAgICAkLlNQRm9ybWF0Q2xhc3MgPSBTUEZvcm1hdCA9IGNyZWF0ZUNsYXNzKHtcbiAgICAgICAgZnJlOiAvXFx7XFx7KFtcXHcuXSs/KSg6KC4rPykpP1xcfVxcfS9nLFxuICAgICAgICBwcmVjcmU6IC8oXFx3KylcXC4oXFxkKykvLFxuXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uIChmb3JtYXQsIGZjbGFzcykge1xuICAgICAgICAgICAgdGhpcy5mb3JtYXQgPSBmb3JtYXQ7XG4gICAgICAgICAgICB0aGlzLmZjbGFzcyA9IGZjbGFzcztcbiAgICAgICAgfSxcblxuICAgICAgICByZW5kZXI6IGZ1bmN0aW9uIChmaWVsZHNldCwgbG9va3Vwcywgb3B0aW9ucykge1xuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzLFxuICAgICAgICAgICAgICAgIGZpZWxkcyA9IGZpZWxkc2V0LFxuICAgICAgICAgICAgICAgIG1hdGNoLCB0b2tlbiwgbG9va3Vwa2V5LCBmaWVsZHZhbHVlLCBwcmVjO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZm9ybWF0LnJlcGxhY2UodGhpcy5mcmUsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgbG9va3VwO1xuICAgICAgICAgICAgICAgIHRva2VuID0gYXJndW1lbnRzWzFdO1xuICAgICAgICAgICAgICAgIGxvb2t1cGtleSA9IGFyZ3VtZW50c1szXTtcbiAgICAgICAgICAgICAgICBtYXRjaCA9IHNlbGYucHJlY3JlLmV4ZWModG9rZW4pO1xuICAgICAgICAgICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgICAgICAgICAgICBwcmVjID0gbWF0Y2hbMl07XG4gICAgICAgICAgICAgICAgICAgIHRva2VuID0gbWF0Y2hbMV07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcHJlYyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmaWVsZHZhbHVlID0gZmllbGRzW3Rva2VuXTtcbiAgICAgICAgICAgICAgICBpZiAoZmllbGR2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGxvb2t1cGtleSAmJiBsb29rdXBzICYmIGxvb2t1cHNbbG9va3Vwa2V5XSkge1xuICAgICAgICAgICAgICAgICAgICBsb29rdXAgPSBsb29rdXBzW2xvb2t1cGtleV07XG4gICAgICAgICAgICAgICAgICAgIGlmIChsb29rdXAuZ2V0KSB7IC8vIFJhbmdlTWFwXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbG9va3Vwc1tsb29rdXBrZXldLmdldChmaWVsZHZhbHVlKSB8fCBmaWVsZHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxvb2t1cHNbbG9va3Vwa2V5XVtmaWVsZHZhbHVlXSB8fCBmaWVsZHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChpc051bWJlcihmaWVsZHZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5nZXQoJ251bWJlckZvcm1hdHRlcicpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaWVsZHZhbHVlID0gb3B0aW9ucy5nZXQoJ251bWJlckZvcm1hdHRlcicpKGZpZWxkdmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZmllbGR2YWx1ZSA9IGZvcm1hdE51bWJlcihmaWVsZHZhbHVlLCBwcmVjLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZ2V0KCdudW1iZXJEaWdpdEdyb3VwQ291bnQnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmdldCgnbnVtYmVyRGlnaXRHcm91cFNlcCcpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZ2V0KCdudW1iZXJEZWNpbWFsTWFyaycpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gZmllbGR2YWx1ZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBjb252aWVuY2UgbWV0aG9kIHRvIGF2b2lkIG5lZWRpbmcgdGhlIG5ldyBvcGVyYXRvclxuICAgICQuc3Bmb3JtYXQgPSBmdW5jdGlvbihmb3JtYXQsIGZjbGFzcykge1xuICAgICAgICByZXR1cm4gbmV3IFNQRm9ybWF0KGZvcm1hdCwgZmNsYXNzKTtcbiAgICB9O1xuXG4gICAgY2xpcHZhbCA9IGZ1bmN0aW9uICh2YWwsIG1pbiwgbWF4KSB7XG4gICAgICAgIGlmICh2YWwgPCBtaW4pIHtcbiAgICAgICAgICAgIHJldHVybiBtaW47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZhbCA+IG1heCkge1xuICAgICAgICAgICAgcmV0dXJuIG1heDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsO1xuICAgIH07XG5cbiAgICBxdWFydGlsZSA9IGZ1bmN0aW9uICh2YWx1ZXMsIHEpIHtcbiAgICAgICAgdmFyIHZsO1xuICAgICAgICBpZiAocSA9PT0gMikge1xuICAgICAgICAgICAgdmwgPSBNYXRoLmZsb29yKHZhbHVlcy5sZW5ndGggLyAyKTtcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZXMubGVuZ3RoICUgMiA/IHZhbHVlc1t2bF0gOiAodmFsdWVzW3ZsLTFdICsgdmFsdWVzW3ZsXSkgLyAyO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKHZhbHVlcy5sZW5ndGggJSAyICkgeyAvLyBvZGRcbiAgICAgICAgICAgICAgICB2bCA9ICh2YWx1ZXMubGVuZ3RoICogcSArIHEpIC8gNDtcbiAgICAgICAgICAgICAgICByZXR1cm4gdmwgJSAxID8gKHZhbHVlc1tNYXRoLmZsb29yKHZsKV0gKyB2YWx1ZXNbTWF0aC5mbG9vcih2bCkgLSAxXSkgLyAyIDogdmFsdWVzW3ZsLTFdO1xuICAgICAgICAgICAgfSBlbHNlIHsgLy9ldmVuXG4gICAgICAgICAgICAgICAgdmwgPSAodmFsdWVzLmxlbmd0aCAqIHEgKyAyKSAvIDQ7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZsICUgMSA/ICh2YWx1ZXNbTWF0aC5mbG9vcih2bCldICsgdmFsdWVzW01hdGguZmxvb3IodmwpIC0gMV0pIC8gMiA6ICB2YWx1ZXNbdmwtMV07XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBub3JtYWxpemVWYWx1ZSA9IGZ1bmN0aW9uICh2YWwpIHtcbiAgICAgICAgdmFyIG5mO1xuICAgICAgICBzd2l0Y2ggKHZhbCkge1xuICAgICAgICAgICAgY2FzZSAndW5kZWZpbmVkJzpcbiAgICAgICAgICAgICAgICB2YWwgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdudWxsJzpcbiAgICAgICAgICAgICAgICB2YWwgPSBudWxsO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAndHJ1ZSc6XG4gICAgICAgICAgICAgICAgdmFsID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2ZhbHNlJzpcbiAgICAgICAgICAgICAgICB2YWwgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgbmYgPSBwYXJzZUZsb2F0KHZhbCk7XG4gICAgICAgICAgICAgICAgaWYgKHZhbCA9PSBuZikge1xuICAgICAgICAgICAgICAgICAgICB2YWwgPSBuZjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbDtcbiAgICB9O1xuXG4gICAgbm9ybWFsaXplVmFsdWVzID0gZnVuY3Rpb24gKHZhbHMpIHtcbiAgICAgICAgdmFyIGksIHJlc3VsdCA9IFtdO1xuICAgICAgICBmb3IgKGkgPSB2YWxzLmxlbmd0aDsgaS0tOykge1xuICAgICAgICAgICAgcmVzdWx0W2ldID0gbm9ybWFsaXplVmFsdWUodmFsc1tpXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuXG4gICAgcmVtb3ZlID0gZnVuY3Rpb24gKHZhbHMsIGZpbHRlcikge1xuICAgICAgICB2YXIgaSwgdmwsIHJlc3VsdCA9IFtdO1xuICAgICAgICBmb3IgKGkgPSAwLCB2bCA9IHZhbHMubGVuZ3RoOyBpIDwgdmw7IGkrKykge1xuICAgICAgICAgICAgaWYgKHZhbHNbaV0gIT09IGZpbHRlcikge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHZhbHNbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcblxuICAgIGlzTnVtYmVyID0gZnVuY3Rpb24gKG51bSkge1xuICAgICAgICByZXR1cm4gIWlzTmFOKHBhcnNlRmxvYXQobnVtKSkgJiYgaXNGaW5pdGUobnVtKTtcbiAgICB9O1xuXG4gICAgZm9ybWF0TnVtYmVyID0gZnVuY3Rpb24gKG51bSwgcHJlYywgZ3JvdXBzaXplLCBncm91cHNlcCwgZGVjc2VwKSB7XG4gICAgICAgIHZhciBwLCBpO1xuICAgICAgICBudW0gPSAocHJlYyA9PT0gZmFsc2UgPyBwYXJzZUZsb2F0KG51bSkudG9TdHJpbmcoKSA6IG51bS50b0ZpeGVkKHByZWMpKS5zcGxpdCgnJyk7XG4gICAgICAgIHAgPSAocCA9ICQuaW5BcnJheSgnLicsIG51bSkpIDwgMCA/IG51bS5sZW5ndGggOiBwO1xuICAgICAgICBpZiAocCA8IG51bS5sZW5ndGgpIHtcbiAgICAgICAgICAgIG51bVtwXSA9IGRlY3NlcDtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGkgPSBwIC0gZ3JvdXBzaXplOyBpID4gMDsgaSAtPSBncm91cHNpemUpIHtcbiAgICAgICAgICAgIG51bS5zcGxpY2UoaSwgMCwgZ3JvdXBzZXApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudW0uam9pbignJyk7XG4gICAgfTtcblxuICAgIC8vIGRldGVybWluZSBpZiBhbGwgdmFsdWVzIG9mIGFuIGFycmF5IG1hdGNoIGEgdmFsdWVcbiAgICAvLyByZXR1cm5zIHRydWUgaWYgdGhlIGFycmF5IGlzIGVtcHR5XG4gICAgYWxsID0gZnVuY3Rpb24gKHZhbCwgYXJyLCBpZ25vcmVOdWxsKSB7XG4gICAgICAgIHZhciBpO1xuICAgICAgICBmb3IgKGkgPSBhcnIubGVuZ3RoOyBpLS07ICkge1xuICAgICAgICAgICAgaWYgKGlnbm9yZU51bGwgJiYgYXJyW2ldID09PSBudWxsKSBjb250aW51ZTtcbiAgICAgICAgICAgIGlmIChhcnJbaV0gIT09IHZhbCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuXG4gICAgLy8gc3VtcyB0aGUgbnVtZXJpYyB2YWx1ZXMgaW4gYW4gYXJyYXksIGlnbm9yaW5nIG90aGVyIHZhbHVlc1xuICAgIHN1bSA9IGZ1bmN0aW9uICh2YWxzKSB7XG4gICAgICAgIHZhciB0b3RhbCA9IDAsIGk7XG4gICAgICAgIGZvciAoaSA9IHZhbHMubGVuZ3RoOyBpLS07KSB7XG4gICAgICAgICAgICB0b3RhbCArPSB0eXBlb2YgdmFsc1tpXSA9PT0gJ251bWJlcicgPyB2YWxzW2ldIDogMDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWw7XG4gICAgfTtcblxuICAgIGVuc3VyZUFycmF5ID0gZnVuY3Rpb24gKHZhbCkge1xuICAgICAgICByZXR1cm4gJC5pc0FycmF5KHZhbCkgPyB2YWwgOiBbdmFsXTtcbiAgICB9O1xuXG4gICAgLy8gaHR0cDovL3BhdWxpcmlzaC5jb20vMjAwOC9ib29rbWFya2xldC1pbmplY3QtbmV3LWNzcy1ydWxlcy9cbiAgICBhZGRDU1MgPSBmdW5jdGlvbihjc3MpIHtcbiAgICAgICAgdmFyIHRhZywgaWVmYWlsO1xuICAgICAgICBpZiAoZG9jdW1lbnQuY3JlYXRlU3R5bGVTaGVldCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5jcmVhdGVTdHlsZVNoZWV0KCkuY3NzVGV4dCA9IGNzcztcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgLy8gSUUgPD0gOSBtYXhlcyBvdXQgYXQgMzEgc3R5bGVzaGVldHM7IGluamVjdCBpbnRvIHBhZ2UgaW5zdGVhZC5cbiAgICAgICAgICAgICAgICBpZWZhaWwgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRhZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7XG4gICAgICAgIHRhZy50eXBlID0gJ3RleHQvY3NzJztcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2hlYWQnKVswXS5hcHBlbmRDaGlsZCh0YWcpO1xuICAgICAgICBpZiAoaWVmYWlsKSB7XG4gICAgICAgICAgICBkb2N1bWVudC5zdHlsZVNoZWV0c1tkb2N1bWVudC5zdHlsZVNoZWV0cy5sZW5ndGggLSAxXS5jc3NUZXh0ID0gY3NzO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGFnWyh0eXBlb2YgZG9jdW1lbnQuYm9keS5zdHlsZS5XZWJraXRBcHBlYXJhbmNlID09ICdzdHJpbmcnKSAvKiB3ZWJraXQgb25seSAqLyA/ICdpbm5lclRleHQnIDogJ2lubmVySFRNTCddID0gY3NzO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIC8vIFByb3ZpZGUgYSBjcm9zcy1icm93c2VyIGludGVyZmFjZSB0byBhIGZldyBzaW1wbGUgZHJhd2luZyBwcmltaXRpdmVzXG4gICAgJC5mbi5zaW1wbGVkcmF3ID0gZnVuY3Rpb24gKHdpZHRoLCBoZWlnaHQsIHVzZUV4aXN0aW5nLCBpbnRlcmFjdCkge1xuICAgICAgICB2YXIgdGFyZ2V0LCBtaGFuZGxlcjtcbiAgICAgICAgaWYgKHVzZUV4aXN0aW5nICYmICh0YXJnZXQgPSB0aGlzLmRhdGEoJ19qcXNfdmNhbnZhcycpKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRhcmdldDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICgkLmZuLnNwYXJrbGluZS5jYW52YXMgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAvLyBXZSd2ZSBhbHJlYWR5IGRldGVybWluZWQgdGhhdCBuZWl0aGVyIENhbnZhcyBub3IgVk1MIGFyZSBhdmFpbGFibGVcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcblxuICAgICAgICB9IGVsc2UgaWYgKCQuZm4uc3BhcmtsaW5lLmNhbnZhcyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAvLyBObyBmdW5jdGlvbiBkZWZpbmVkIHlldCAtLSBuZWVkIHRvIHNlZSBpZiB3ZSBzdXBwb3J0IENhbnZhcyBvciBWTUxcbiAgICAgICAgICAgIHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuICAgICAgICAgICAgaWYgKCEhKGVsLmdldENvbnRleHQgJiYgZWwuZ2V0Q29udGV4dCgnMmQnKSkpIHtcbiAgICAgICAgICAgICAgICAvLyBDYW52YXMgaXMgYXZhaWxhYmxlXG4gICAgICAgICAgICAgICAgJC5mbi5zcGFya2xpbmUuY2FudmFzID0gZnVuY3Rpb24od2lkdGgsIGhlaWdodCwgdGFyZ2V0LCBpbnRlcmFjdCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFZDYW52YXNfY2FudmFzKHdpZHRoLCBoZWlnaHQsIHRhcmdldCwgaW50ZXJhY3QpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGRvY3VtZW50Lm5hbWVzcGFjZXMgJiYgIWRvY3VtZW50Lm5hbWVzcGFjZXMudikge1xuICAgICAgICAgICAgICAgIC8vIFZNTCBpcyBhdmFpbGFibGVcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5uYW1lc3BhY2VzLmFkZCgndicsICd1cm46c2NoZW1hcy1taWNyb3NvZnQtY29tOnZtbCcsICcjZGVmYXVsdCNWTUwnKTtcbiAgICAgICAgICAgICAgICAkLmZuLnNwYXJrbGluZS5jYW52YXMgPSBmdW5jdGlvbih3aWR0aCwgaGVpZ2h0LCB0YXJnZXQsIGludGVyYWN0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVkNhbnZhc192bWwod2lkdGgsIGhlaWdodCwgdGFyZ2V0KTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBOZWl0aGVyIENhbnZhcyBub3IgVk1MIGFyZSBhdmFpbGFibGVcbiAgICAgICAgICAgICAgICAkLmZuLnNwYXJrbGluZS5jYW52YXMgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAod2lkdGggPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgd2lkdGggPSAkKHRoaXMpLmlubmVyV2lkdGgoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaGVpZ2h0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGhlaWdodCA9ICQodGhpcykuaW5uZXJIZWlnaHQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRhcmdldCA9ICQuZm4uc3BhcmtsaW5lLmNhbnZhcyh3aWR0aCwgaGVpZ2h0LCB0aGlzLCBpbnRlcmFjdCk7XG5cbiAgICAgICAgbWhhbmRsZXIgPSAkKHRoaXMpLmRhdGEoJ19qcXNfbWhhbmRsZXInKTtcbiAgICAgICAgaWYgKG1oYW5kbGVyKSB7XG4gICAgICAgICAgICBtaGFuZGxlci5yZWdpc3RlckNhbnZhcyh0YXJnZXQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0YXJnZXQ7XG4gICAgfTtcblxuICAgICQuZm4uY2xlYXJkcmF3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdGFyZ2V0ID0gdGhpcy5kYXRhKCdfanFzX3ZjYW52YXMnKTtcbiAgICAgICAgaWYgKHRhcmdldCkge1xuICAgICAgICAgICAgdGFyZ2V0LnJlc2V0KCk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgJC5SYW5nZU1hcENsYXNzID0gUmFuZ2VNYXAgPSBjcmVhdGVDbGFzcyh7XG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uIChtYXApIHtcbiAgICAgICAgICAgIHZhciBrZXksIHJhbmdlLCByYW5nZWxpc3QgPSBbXTtcbiAgICAgICAgICAgIGZvciAoa2V5IGluIG1hcCkge1xuICAgICAgICAgICAgICAgIGlmIChtYXAuaGFzT3duUHJvcGVydHkoa2V5KSAmJiB0eXBlb2Yga2V5ID09PSAnc3RyaW5nJyAmJiBrZXkuaW5kZXhPZignOicpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmFuZ2UgPSBrZXkuc3BsaXQoJzonKTtcbiAgICAgICAgICAgICAgICAgICAgcmFuZ2VbMF0gPSByYW5nZVswXS5sZW5ndGggPT09IDAgPyAtSW5maW5pdHkgOiBwYXJzZUZsb2F0KHJhbmdlWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgcmFuZ2VbMV0gPSByYW5nZVsxXS5sZW5ndGggPT09IDAgPyBJbmZpbml0eSA6IHBhcnNlRmxvYXQocmFuZ2VbMV0pO1xuICAgICAgICAgICAgICAgICAgICByYW5nZVsyXSA9IG1hcFtrZXldO1xuICAgICAgICAgICAgICAgICAgICByYW5nZWxpc3QucHVzaChyYW5nZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5tYXAgPSBtYXA7XG4gICAgICAgICAgICB0aGlzLnJhbmdlbGlzdCA9IHJhbmdlbGlzdCB8fCBmYWxzZTtcbiAgICAgICAgfSxcblxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdmFyIHJhbmdlbGlzdCA9IHRoaXMucmFuZ2VsaXN0LFxuICAgICAgICAgICAgICAgIGksIHJhbmdlLCByZXN1bHQ7XG4gICAgICAgICAgICBpZiAoKHJlc3VsdCA9IHRoaXMubWFwW3ZhbHVlXSkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocmFuZ2VsaXN0KSB7XG4gICAgICAgICAgICAgICAgZm9yIChpID0gcmFuZ2VsaXN0Lmxlbmd0aDsgaS0tOykge1xuICAgICAgICAgICAgICAgICAgICByYW5nZSA9IHJhbmdlbGlzdFtpXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJhbmdlWzBdIDw9IHZhbHVlICYmIHJhbmdlWzFdID49IHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmFuZ2VbMl07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBDb252ZW5pZW5jZSBmdW5jdGlvblxuICAgICQucmFuZ2VfbWFwID0gZnVuY3Rpb24obWFwKSB7XG4gICAgICAgIHJldHVybiBuZXcgUmFuZ2VNYXAobWFwKTtcbiAgICB9O1xuXG4gICAgTW91c2VIYW5kbGVyID0gY3JlYXRlQ2xhc3Moe1xuICAgICAgICBpbml0OiBmdW5jdGlvbiAoZWwsIG9wdGlvbnMpIHtcbiAgICAgICAgICAgIHZhciAkZWwgPSAkKGVsKTtcbiAgICAgICAgICAgIHRoaXMuJGVsID0gJGVsO1xuICAgICAgICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFBhZ2VYID0gMDtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFBhZ2VZID0gMDtcbiAgICAgICAgICAgIHRoaXMuZWwgPSBlbDtcbiAgICAgICAgICAgIHRoaXMuc3BsaXN0ID0gW107XG4gICAgICAgICAgICB0aGlzLnRvb2x0aXAgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5vdmVyID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmRpc3BsYXlUb29sdGlwcyA9ICFvcHRpb25zLmdldCgnZGlzYWJsZVRvb2x0aXBzJyk7XG4gICAgICAgICAgICB0aGlzLmhpZ2hsaWdodEVuYWJsZWQgPSAhb3B0aW9ucy5nZXQoJ2Rpc2FibGVIaWdobGlnaHQnKTtcbiAgICAgICAgfSxcblxuICAgICAgICByZWdpc3RlclNwYXJrbGluZTogZnVuY3Rpb24gKHNwKSB7XG4gICAgICAgICAgICB0aGlzLnNwbGlzdC5wdXNoKHNwKTtcbiAgICAgICAgICAgIGlmICh0aGlzLm92ZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZURpc3BsYXkoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICByZWdpc3RlckNhbnZhczogZnVuY3Rpb24gKGNhbnZhcykge1xuICAgICAgICAgICAgdmFyICRjYW52YXMgPSAkKGNhbnZhcy5jYW52YXMpO1xuICAgICAgICAgICAgdGhpcy5jYW52YXMgPSBjYW52YXM7XG4gICAgICAgICAgICB0aGlzLiRjYW52YXMgPSAkY2FudmFzO1xuICAgICAgICAgICAgJGNhbnZhcy5tb3VzZWVudGVyKCQucHJveHkodGhpcy5tb3VzZWVudGVyLCB0aGlzKSk7XG4gICAgICAgICAgICAkY2FudmFzLm1vdXNlbGVhdmUoJC5wcm94eSh0aGlzLm1vdXNlbGVhdmUsIHRoaXMpKTtcbiAgICAgICAgICAgICRjYW52YXMuY2xpY2soJC5wcm94eSh0aGlzLm1vdXNlY2xpY2ssIHRoaXMpKTtcbiAgICAgICAgfSxcblxuICAgICAgICByZXNldDogZnVuY3Rpb24gKHJlbW92ZVRvb2x0aXApIHtcbiAgICAgICAgICAgIHRoaXMuc3BsaXN0ID0gW107XG4gICAgICAgICAgICBpZiAodGhpcy50b29sdGlwICYmIHJlbW92ZVRvb2x0aXApIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRvb2x0aXAucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgdGhpcy50b29sdGlwID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIG1vdXNlY2xpY2s6IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICB2YXIgY2xpY2tFdmVudCA9ICQuRXZlbnQoJ3NwYXJrbGluZUNsaWNrJyk7XG4gICAgICAgICAgICBjbGlja0V2ZW50Lm9yaWdpbmFsRXZlbnQgPSBlO1xuICAgICAgICAgICAgY2xpY2tFdmVudC5zcGFya2xpbmVzID0gdGhpcy5zcGxpc3Q7XG4gICAgICAgICAgICB0aGlzLiRlbC50cmlnZ2VyKGNsaWNrRXZlbnQpO1xuICAgICAgICB9LFxuXG4gICAgICAgIG1vdXNlZW50ZXI6IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAkKGRvY3VtZW50LmJvZHkpLnVuYmluZCgnbW91c2Vtb3ZlLmpxcycpO1xuICAgICAgICAgICAgJChkb2N1bWVudC5ib2R5KS5iaW5kKCdtb3VzZW1vdmUuanFzJywgJC5wcm94eSh0aGlzLm1vdXNlbW92ZSwgdGhpcykpO1xuICAgICAgICAgICAgdGhpcy5vdmVyID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFBhZ2VYID0gZS5wYWdlWDtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFBhZ2VZID0gZS5wYWdlWTtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudEVsID0gZS50YXJnZXQ7XG4gICAgICAgICAgICBpZiAoIXRoaXMudG9vbHRpcCAmJiB0aGlzLmRpc3BsYXlUb29sdGlwcykge1xuICAgICAgICAgICAgICAgIHRoaXMudG9vbHRpcCA9IG5ldyBUb29sdGlwKHRoaXMub3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgdGhpcy50b29sdGlwLnVwZGF0ZVBvc2l0aW9uKGUucGFnZVgsIGUucGFnZVkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy51cGRhdGVEaXNwbGF5KCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgbW91c2VsZWF2ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJChkb2N1bWVudC5ib2R5KS51bmJpbmQoJ21vdXNlbW92ZS5qcXMnKTtcbiAgICAgICAgICAgIHZhciBzcGxpc3QgPSB0aGlzLnNwbGlzdCxcbiAgICAgICAgICAgICAgICAgc3Bjb3VudCA9IHNwbGlzdC5sZW5ndGgsXG4gICAgICAgICAgICAgICAgIG5lZWRzUmVmcmVzaCA9IGZhbHNlLFxuICAgICAgICAgICAgICAgICBzcCwgaTtcbiAgICAgICAgICAgIHRoaXMub3ZlciA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50RWwgPSBudWxsO1xuXG4gICAgICAgICAgICBpZiAodGhpcy50b29sdGlwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy50b29sdGlwLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIHRoaXMudG9vbHRpcCA9IG51bGw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBzcGNvdW50OyBpKyspIHtcbiAgICAgICAgICAgICAgICBzcCA9IHNwbGlzdFtpXTtcbiAgICAgICAgICAgICAgICBpZiAoc3AuY2xlYXJSZWdpb25IaWdobGlnaHQoKSkge1xuICAgICAgICAgICAgICAgICAgICBuZWVkc1JlZnJlc2ggPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKG5lZWRzUmVmcmVzaCkge1xuICAgICAgICAgICAgICAgIHRoaXMuY2FudmFzLnJlbmRlcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIG1vdXNlbW92ZTogZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFBhZ2VYID0gZS5wYWdlWDtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFBhZ2VZID0gZS5wYWdlWTtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudEVsID0gZS50YXJnZXQ7XG4gICAgICAgICAgICBpZiAodGhpcy50b29sdGlwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy50b29sdGlwLnVwZGF0ZVBvc2l0aW9uKGUucGFnZVgsIGUucGFnZVkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy51cGRhdGVEaXNwbGF5KCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgdXBkYXRlRGlzcGxheTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHNwbGlzdCA9IHRoaXMuc3BsaXN0LFxuICAgICAgICAgICAgICAgICBzcGNvdW50ID0gc3BsaXN0Lmxlbmd0aCxcbiAgICAgICAgICAgICAgICAgbmVlZHNSZWZyZXNoID0gZmFsc2UsXG4gICAgICAgICAgICAgICAgIG9mZnNldCA9IHRoaXMuJGNhbnZhcy5vZmZzZXQoKSxcbiAgICAgICAgICAgICAgICAgbG9jYWxYID0gdGhpcy5jdXJyZW50UGFnZVggLSBvZmZzZXQubGVmdCxcbiAgICAgICAgICAgICAgICAgbG9jYWxZID0gdGhpcy5jdXJyZW50UGFnZVkgLSBvZmZzZXQudG9wLFxuICAgICAgICAgICAgICAgICB0b29sdGlwaHRtbCwgc3AsIGksIHJlc3VsdCwgY2hhbmdlRXZlbnQ7XG4gICAgICAgICAgICBpZiAoIXRoaXMub3Zlcikge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBzcGNvdW50OyBpKyspIHtcbiAgICAgICAgICAgICAgICBzcCA9IHNwbGlzdFtpXTtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBzcC5zZXRSZWdpb25IaWdobGlnaHQodGhpcy5jdXJyZW50RWwsIGxvY2FsWCwgbG9jYWxZKTtcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIG5lZWRzUmVmcmVzaCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG5lZWRzUmVmcmVzaCkge1xuICAgICAgICAgICAgICAgIGNoYW5nZUV2ZW50ID0gJC5FdmVudCgnc3BhcmtsaW5lUmVnaW9uQ2hhbmdlJyk7XG4gICAgICAgICAgICAgICAgY2hhbmdlRXZlbnQuc3BhcmtsaW5lcyA9IHRoaXMuc3BsaXN0O1xuICAgICAgICAgICAgICAgIHRoaXMuJGVsLnRyaWdnZXIoY2hhbmdlRXZlbnQpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnRvb2x0aXApIHtcbiAgICAgICAgICAgICAgICAgICAgdG9vbHRpcGh0bWwgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHNwY291bnQ7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3AgPSBzcGxpc3RbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICB0b29sdGlwaHRtbCArPSBzcC5nZXRDdXJyZW50UmVnaW9uVG9vbHRpcCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudG9vbHRpcC5zZXRDb250ZW50KHRvb2x0aXBodG1sKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmRpc2FibGVIaWdobGlnaHQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jYW52YXMucmVuZGVyKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHJlc3VsdCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRoaXMubW91c2VsZWF2ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG5cblxuICAgIFRvb2x0aXAgPSBjcmVhdGVDbGFzcyh7XG4gICAgICAgIHNpemVTdHlsZTogJ3Bvc2l0aW9uOiBzdGF0aWMgIWltcG9ydGFudDsnICtcbiAgICAgICAgICAgICdkaXNwbGF5OiBibG9jayAhaW1wb3J0YW50OycgK1xuICAgICAgICAgICAgJ3Zpc2liaWxpdHk6IGhpZGRlbiAhaW1wb3J0YW50OycgK1xuICAgICAgICAgICAgJ2Zsb2F0OiBsZWZ0ICFpbXBvcnRhbnQ7JyxcblxuICAgICAgICBpbml0OiBmdW5jdGlvbiAob3B0aW9ucykge1xuICAgICAgICAgICAgdmFyIHRvb2x0aXBDbGFzc25hbWUgPSBvcHRpb25zLmdldCgndG9vbHRpcENsYXNzbmFtZScsICdqcXN0b29sdGlwJyksXG4gICAgICAgICAgICAgICAgc2l6ZXRpcFN0eWxlID0gdGhpcy5zaXplU3R5bGUsXG4gICAgICAgICAgICAgICAgb2Zmc2V0O1xuICAgICAgICAgICAgdGhpcy5jb250YWluZXIgPSBvcHRpb25zLmdldCgndG9vbHRpcENvbnRhaW5lcicpIHx8IGRvY3VtZW50LmJvZHk7XG4gICAgICAgICAgICB0aGlzLnRvb2x0aXBPZmZzZXRYID0gb3B0aW9ucy5nZXQoJ3Rvb2x0aXBPZmZzZXRYJywgMTApO1xuICAgICAgICAgICAgdGhpcy50b29sdGlwT2Zmc2V0WSA9IG9wdGlvbnMuZ2V0KCd0b29sdGlwT2Zmc2V0WScsIDEyKTtcbiAgICAgICAgICAgIC8vIHJlbW92ZSBhbnkgcHJldmlvdXMgbGluZ2VyaW5nIHRvb2x0aXBcbiAgICAgICAgICAgICQoJyNqcXNzaXpldGlwJykucmVtb3ZlKCk7XG4gICAgICAgICAgICAkKCcjanFzdG9vbHRpcCcpLnJlbW92ZSgpO1xuICAgICAgICAgICAgdGhpcy5zaXpldGlwID0gJCgnPGRpdi8+Jywge1xuICAgICAgICAgICAgICAgIGlkOiAnanFzc2l6ZXRpcCcsXG4gICAgICAgICAgICAgICAgc3R5bGU6IHNpemV0aXBTdHlsZSxcbiAgICAgICAgICAgICAgICAnY2xhc3MnOiB0b29sdGlwQ2xhc3NuYW1lXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMudG9vbHRpcCA9ICQoJzxkaXYvPicsIHtcbiAgICAgICAgICAgICAgICBpZDogJ2pxc3Rvb2x0aXAnLFxuICAgICAgICAgICAgICAgICdjbGFzcyc6IHRvb2x0aXBDbGFzc25hbWVcbiAgICAgICAgICAgIH0pLmFwcGVuZFRvKHRoaXMuY29udGFpbmVyKTtcbiAgICAgICAgICAgIC8vIGFjY291bnQgZm9yIHRoZSBjb250YWluZXIncyBsb2NhdGlvblxuICAgICAgICAgICAgb2Zmc2V0ID0gdGhpcy50b29sdGlwLm9mZnNldCgpO1xuICAgICAgICAgICAgdGhpcy5vZmZzZXRMZWZ0ID0gb2Zmc2V0LmxlZnQ7XG4gICAgICAgICAgICB0aGlzLm9mZnNldFRvcCA9IG9mZnNldC50b3A7XG4gICAgICAgICAgICB0aGlzLmhpZGRlbiA9IHRydWU7XG4gICAgICAgICAgICAkKHdpbmRvdykudW5iaW5kKCdyZXNpemUuanFzIHNjcm9sbC5qcXMnKTtcbiAgICAgICAgICAgICQod2luZG93KS5iaW5kKCdyZXNpemUuanFzIHNjcm9sbC5qcXMnLCAkLnByb3h5KHRoaXMudXBkYXRlV2luZG93RGltcywgdGhpcykpO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVXaW5kb3dEaW1zKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgdXBkYXRlV2luZG93RGltczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5zY3JvbGxUb3AgPSAkKHdpbmRvdykuc2Nyb2xsVG9wKCk7XG4gICAgICAgICAgICB0aGlzLnNjcm9sbExlZnQgPSAkKHdpbmRvdykuc2Nyb2xsTGVmdCgpO1xuICAgICAgICAgICAgdGhpcy5zY3JvbGxSaWdodCA9IHRoaXMuc2Nyb2xsTGVmdCArICQod2luZG93KS53aWR0aCgpO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVQb3NpdGlvbigpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGdldFNpemU6IGZ1bmN0aW9uIChjb250ZW50KSB7XG4gICAgICAgICAgICB0aGlzLnNpemV0aXAuaHRtbChjb250ZW50KS5hcHBlbmRUbyh0aGlzLmNvbnRhaW5lcik7XG4gICAgICAgICAgICB0aGlzLndpZHRoID0gdGhpcy5zaXpldGlwLndpZHRoKCkgKyAxO1xuICAgICAgICAgICAgdGhpcy5oZWlnaHQgPSB0aGlzLnNpemV0aXAuaGVpZ2h0KCk7XG4gICAgICAgICAgICB0aGlzLnNpemV0aXAucmVtb3ZlKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2V0Q29udGVudDogZnVuY3Rpb24gKGNvbnRlbnQpIHtcbiAgICAgICAgICAgIGlmICghY29udGVudCkge1xuICAgICAgICAgICAgICAgIHRoaXMudG9vbHRpcC5jc3MoJ3Zpc2liaWxpdHknLCAnaGlkZGVuJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5oaWRkZW4gPSB0cnVlO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZ2V0U2l6ZShjb250ZW50KTtcbiAgICAgICAgICAgIHRoaXMudG9vbHRpcC5odG1sKGNvbnRlbnQpXG4gICAgICAgICAgICAgICAgLmNzcyh7XG4gICAgICAgICAgICAgICAgICAgICd3aWR0aCc6IHRoaXMud2lkdGgsXG4gICAgICAgICAgICAgICAgICAgICdoZWlnaHQnOiB0aGlzLmhlaWdodCxcbiAgICAgICAgICAgICAgICAgICAgJ3Zpc2liaWxpdHknOiAndmlzaWJsZSdcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmICh0aGlzLmhpZGRlbikge1xuICAgICAgICAgICAgICAgIHRoaXMuaGlkZGVuID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVQb3NpdGlvbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIHVwZGF0ZVBvc2l0aW9uOiBmdW5jdGlvbiAoeCwgeSkge1xuICAgICAgICAgICAgaWYgKHggPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLm1vdXNleCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgeCA9IHRoaXMubW91c2V4IC0gdGhpcy5vZmZzZXRMZWZ0O1xuICAgICAgICAgICAgICAgIHkgPSB0aGlzLm1vdXNleSAtIHRoaXMub2Zmc2V0VG9wO1xuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMubW91c2V4ID0geCA9IHggLSB0aGlzLm9mZnNldExlZnQ7XG4gICAgICAgICAgICAgICAgdGhpcy5tb3VzZXkgPSB5ID0geSAtIHRoaXMub2Zmc2V0VG9wO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCF0aGlzLmhlaWdodCB8fCAhdGhpcy53aWR0aCB8fCB0aGlzLmhpZGRlbikge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgeSAtPSB0aGlzLmhlaWdodCArIHRoaXMudG9vbHRpcE9mZnNldFk7XG4gICAgICAgICAgICB4ICs9IHRoaXMudG9vbHRpcE9mZnNldFg7XG5cbiAgICAgICAgICAgIGlmICh5IDwgdGhpcy5zY3JvbGxUb3ApIHtcbiAgICAgICAgICAgICAgICB5ID0gdGhpcy5zY3JvbGxUb3A7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoeCA8IHRoaXMuc2Nyb2xsTGVmdCkge1xuICAgICAgICAgICAgICAgIHggPSB0aGlzLnNjcm9sbExlZnQ7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHggKyB0aGlzLndpZHRoID4gdGhpcy5zY3JvbGxSaWdodCkge1xuICAgICAgICAgICAgICAgIHggPSB0aGlzLnNjcm9sbFJpZ2h0IC0gdGhpcy53aWR0aDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy50b29sdGlwLmNzcyh7XG4gICAgICAgICAgICAgICAgJ2xlZnQnOiB4LFxuICAgICAgICAgICAgICAgICd0b3AnOiB5XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICByZW1vdmU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMudG9vbHRpcC5yZW1vdmUoKTtcbiAgICAgICAgICAgIHRoaXMuc2l6ZXRpcC5yZW1vdmUoKTtcbiAgICAgICAgICAgIHRoaXMuc2l6ZXRpcCA9IHRoaXMudG9vbHRpcCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICQod2luZG93KS51bmJpbmQoJ3Jlc2l6ZS5qcXMgc2Nyb2xsLmpxcycpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICBpbml0U3R5bGVzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGFkZENTUyhkZWZhdWx0U3R5bGVzKTtcbiAgICB9O1xuXG4gICAgJChpbml0U3R5bGVzKTtcblxuICAgIHBlbmRpbmcgPSBbXTtcbiAgICAkLmZuLnNwYXJrbGluZSA9IGZ1bmN0aW9uICh1c2VyVmFsdWVzLCB1c2VyT3B0aW9ucykge1xuICAgICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBvcHRpb25zID0gbmV3ICQuZm4uc3BhcmtsaW5lLm9wdGlvbnModGhpcywgdXNlck9wdGlvbnMpLFxuICAgICAgICAgICAgICAgICAkdGhpcyA9ICQodGhpcyksXG4gICAgICAgICAgICAgICAgIHJlbmRlciwgaTtcbiAgICAgICAgICAgIHJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWVzLCB3aWR0aCwgaGVpZ2h0LCB0bXAsIG1oYW5kbGVyLCBzcCwgdmFscztcbiAgICAgICAgICAgICAgICBpZiAodXNlclZhbHVlcyA9PT0gJ2h0bWwnIHx8IHVzZXJWYWx1ZXMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICB2YWxzID0gdGhpcy5nZXRBdHRyaWJ1dGUob3B0aW9ucy5nZXQoJ3RhZ1ZhbHVlc0F0dHJpYnV0ZScpKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHMgPT09IHVuZGVmaW5lZCB8fCB2YWxzID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWxzID0gJHRoaXMuaHRtbCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlcyA9IHZhbHMucmVwbGFjZSgvKF5cXHMqPCEtLSl8KC0tPlxccyokKXxcXHMrL2csICcnKS5zcGxpdCgnLCcpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlcyA9IHVzZXJWYWx1ZXM7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd2lkdGggPSBvcHRpb25zLmdldCgnd2lkdGgnKSA9PT0gJ2F1dG8nID8gdmFsdWVzLmxlbmd0aCAqIG9wdGlvbnMuZ2V0KCdkZWZhdWx0UGl4ZWxzUGVyVmFsdWUnKSA6IG9wdGlvbnMuZ2V0KCd3aWR0aCcpO1xuICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLmdldCgnaGVpZ2h0JykgPT09ICdhdXRvJykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIW9wdGlvbnMuZ2V0KCdjb21wb3NpdGUnKSB8fCAhJC5kYXRhKHRoaXMsICdfanFzX3ZjYW52YXMnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbXVzdCBiZSBhIGJldHRlciB3YXkgdG8gZ2V0IHRoZSBsaW5lIGhlaWdodFxuICAgICAgICAgICAgICAgICAgICAgICAgdG1wID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdG1wLmlubmVySFRNTCA9ICdhJztcbiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLmh0bWwodG1wKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodCA9ICQodG1wKS5pbm5lckhlaWdodCgpIHx8ICQodG1wKS5oZWlnaHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICQodG1wKS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRtcCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBoZWlnaHQgPSBvcHRpb25zLmdldCgnaGVpZ2h0Jyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKCFvcHRpb25zLmdldCgnZGlzYWJsZUludGVyYWN0aW9uJykpIHtcbiAgICAgICAgICAgICAgICAgICAgbWhhbmRsZXIgPSAkLmRhdGEodGhpcywgJ19qcXNfbWhhbmRsZXInKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFtaGFuZGxlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWhhbmRsZXIgPSBuZXcgTW91c2VIYW5kbGVyKHRoaXMsIG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJC5kYXRhKHRoaXMsICdfanFzX21oYW5kbGVyJywgbWhhbmRsZXIpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCFvcHRpb25zLmdldCgnY29tcG9zaXRlJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1oYW5kbGVyLnJlc2V0KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBtaGFuZGxlciA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLmdldCgnY29tcG9zaXRlJykgJiYgISQuZGF0YSh0aGlzLCAnX2pxc192Y2FudmFzJykpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEkLmRhdGEodGhpcywgJ19qcXNfZXJybm90aWZ5JykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KCdBdHRlbXB0ZWQgdG8gYXR0YWNoIGEgY29tcG9zaXRlIHNwYXJrbGluZSB0byBhbiBlbGVtZW50IHdpdGggbm8gZXhpc3Rpbmcgc3BhcmtsaW5lJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkLmRhdGEodGhpcywgJ19qcXNfZXJybm90aWZ5JywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHNwID0gbmV3ICQuZm4uc3BhcmtsaW5lW29wdGlvbnMuZ2V0KCd0eXBlJyldKHRoaXMsIHZhbHVlcywgb3B0aW9ucywgd2lkdGgsIGhlaWdodCk7XG5cbiAgICAgICAgICAgICAgICBzcC5yZW5kZXIoKTtcblxuICAgICAgICAgICAgICAgIGlmIChtaGFuZGxlcikge1xuICAgICAgICAgICAgICAgICAgICBtaGFuZGxlci5yZWdpc3RlclNwYXJrbGluZShzcCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGlmICgoJCh0aGlzKS5odG1sKCkgJiYgIW9wdGlvbnMuZ2V0KCdkaXNhYmxlSGlkZGVuQ2hlY2snKSAmJiAkKHRoaXMpLmlzKCc6aGlkZGVuJykpIHx8ICEkKHRoaXMpLnBhcmVudHMoJ2JvZHknKS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBpZiAoIW9wdGlvbnMuZ2V0KCdjb21wb3NpdGUnKSAmJiAkLmRhdGEodGhpcywgJ19qcXNfcGVuZGluZycpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBhbnkgZXhpc3RpbmcgcmVmZXJlbmNlcyB0byB0aGUgZWxlbWVudFxuICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSBwZW5kaW5nLmxlbmd0aDsgaTsgaS0tKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocGVuZGluZ1tpIC0gMV1bMF0gPT0gdGhpcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlbmRpbmcuc3BsaWNlKGkgLSAxLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBwZW5kaW5nLnB1c2goW3RoaXMsIHJlbmRlcl0pO1xuICAgICAgICAgICAgICAgICQuZGF0YSh0aGlzLCAnX2pxc19wZW5kaW5nJywgdHJ1ZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlbmRlci5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgJC5mbi5zcGFya2xpbmUuZGVmYXVsdHMgPSBnZXREZWZhdWx0cygpO1xuXG5cbiAgICAkLnNwYXJrbGluZV9kaXNwbGF5X3Zpc2libGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBlbCwgaSwgcGw7XG4gICAgICAgIHZhciBkb25lID0gW107XG4gICAgICAgIGZvciAoaSA9IDAsIHBsID0gcGVuZGluZy5sZW5ndGg7IGkgPCBwbDsgaSsrKSB7XG4gICAgICAgICAgICBlbCA9IHBlbmRpbmdbaV1bMF07XG4gICAgICAgICAgICBpZiAoJChlbCkuaXMoJzp2aXNpYmxlJykgJiYgISQoZWwpLnBhcmVudHMoKS5pcygnOmhpZGRlbicpKSB7XG4gICAgICAgICAgICAgICAgcGVuZGluZ1tpXVsxXS5jYWxsKGVsKTtcbiAgICAgICAgICAgICAgICAkLmRhdGEocGVuZGluZ1tpXVswXSwgJ19qcXNfcGVuZGluZycsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICBkb25lLnB1c2goaSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKCEkKGVsKS5jbG9zZXN0KCdodG1sJykubGVuZ3RoICYmICEkLmRhdGEoZWwsICdfanFzX3BlbmRpbmcnKSkge1xuICAgICAgICAgICAgICAgIC8vIGVsZW1lbnQgaGFzIGJlZW4gaW5zZXJ0ZWQgYW5kIHJlbW92ZWQgZnJvbSB0aGUgRE9NXG4gICAgICAgICAgICAgICAgLy8gSWYgaXQgd2FzIG5vdCB5ZXQgaW5zZXJ0ZWQgaW50byB0aGUgZG9tIHRoZW4gdGhlIC5kYXRhIHJlcXVlc3RcbiAgICAgICAgICAgICAgICAvLyB3aWxsIHJldHVybiB0cnVlLlxuICAgICAgICAgICAgICAgIC8vIHJlbW92aW5nIGZyb20gdGhlIGRvbSBjYXVzZXMgdGhlIGRhdGEgdG8gYmUgcmVtb3ZlZC5cbiAgICAgICAgICAgICAgICAkLmRhdGEocGVuZGluZ1tpXVswXSwgJ19qcXNfcGVuZGluZycsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICBkb25lLnB1c2goaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChpID0gZG9uZS5sZW5ndGg7IGk7IGktLSkge1xuICAgICAgICAgICAgcGVuZGluZy5zcGxpY2UoZG9uZVtpIC0gMV0sIDEpO1xuICAgICAgICB9XG4gICAgfTtcblxuXG4gICAgLyoqXG4gICAgICogVXNlciBvcHRpb24gaGFuZGxlclxuICAgICAqL1xuICAgICQuZm4uc3BhcmtsaW5lLm9wdGlvbnMgPSBjcmVhdGVDbGFzcyh7XG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uICh0YWcsIHVzZXJPcHRpb25zKSB7XG4gICAgICAgICAgICB2YXIgZXh0ZW5kZWRPcHRpb25zLCBkZWZhdWx0cywgYmFzZSwgdGFnT3B0aW9uVHlwZTtcbiAgICAgICAgICAgIHRoaXMudXNlck9wdGlvbnMgPSB1c2VyT3B0aW9ucyA9IHVzZXJPcHRpb25zIHx8IHt9O1xuICAgICAgICAgICAgdGhpcy50YWcgPSB0YWc7XG4gICAgICAgICAgICB0aGlzLnRhZ1ZhbENhY2hlID0ge307XG4gICAgICAgICAgICBkZWZhdWx0cyA9ICQuZm4uc3BhcmtsaW5lLmRlZmF1bHRzO1xuICAgICAgICAgICAgYmFzZSA9IGRlZmF1bHRzLmNvbW1vbjtcbiAgICAgICAgICAgIHRoaXMudGFnT3B0aW9uc1ByZWZpeCA9IHVzZXJPcHRpb25zLmVuYWJsZVRhZ09wdGlvbnMgJiYgKHVzZXJPcHRpb25zLnRhZ09wdGlvbnNQcmVmaXggfHwgYmFzZS50YWdPcHRpb25zUHJlZml4KTtcblxuICAgICAgICAgICAgdGFnT3B0aW9uVHlwZSA9IHRoaXMuZ2V0VGFnU2V0dGluZygndHlwZScpO1xuICAgICAgICAgICAgaWYgKHRhZ09wdGlvblR5cGUgPT09IFVOU0VUX09QVElPTikge1xuICAgICAgICAgICAgICAgIGV4dGVuZGVkT3B0aW9ucyA9IGRlZmF1bHRzW3VzZXJPcHRpb25zLnR5cGUgfHwgYmFzZS50eXBlXTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZXh0ZW5kZWRPcHRpb25zID0gZGVmYXVsdHNbdGFnT3B0aW9uVHlwZV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm1lcmdlZE9wdGlvbnMgPSAkLmV4dGVuZCh7fSwgYmFzZSwgZXh0ZW5kZWRPcHRpb25zLCB1c2VyT3B0aW9ucyk7XG4gICAgICAgIH0sXG5cblxuICAgICAgICBnZXRUYWdTZXR0aW5nOiBmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgICB2YXIgcHJlZml4ID0gdGhpcy50YWdPcHRpb25zUHJlZml4LFxuICAgICAgICAgICAgICAgIHZhbCwgaSwgcGFpcnMsIGtleXZhbDtcbiAgICAgICAgICAgIGlmIChwcmVmaXggPT09IGZhbHNlIHx8IHByZWZpeCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFVOU0VUX09QVElPTjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnRhZ1ZhbENhY2hlLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgICAgICB2YWwgPSB0aGlzLnRhZ1ZhbENhY2hlLmtleTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFsID0gdGhpcy50YWcuZ2V0QXR0cmlidXRlKHByZWZpeCArIGtleSk7XG4gICAgICAgICAgICAgICAgaWYgKHZhbCA9PT0gdW5kZWZpbmVkIHx8IHZhbCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB2YWwgPSBVTlNFVF9PUFRJT047XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh2YWwuc3Vic3RyKDAsIDEpID09PSAnWycpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsID0gdmFsLnN1YnN0cigxLCB2YWwubGVuZ3RoIC0gMikuc3BsaXQoJywnKTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChpID0gdmFsLmxlbmd0aDsgaS0tOykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsW2ldID0gbm9ybWFsaXplVmFsdWUodmFsW2ldLnJlcGxhY2UoLyheXFxzKil8KFxccyokKS9nLCAnJykpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh2YWwuc3Vic3RyKDAsIDEpID09PSAneycpIHtcbiAgICAgICAgICAgICAgICAgICAgcGFpcnMgPSB2YWwuc3Vic3RyKDEsIHZhbC5sZW5ndGggLSAyKS5zcGxpdCgnLCcpO1xuICAgICAgICAgICAgICAgICAgICB2YWwgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChpID0gcGFpcnMubGVuZ3RoOyBpLS07KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBrZXl2YWwgPSBwYWlyc1tpXS5zcGxpdCgnOicsIDIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsW2tleXZhbFswXS5yZXBsYWNlKC8oXlxccyopfChcXHMqJCkvZywgJycpXSA9IG5vcm1hbGl6ZVZhbHVlKGtleXZhbFsxXS5yZXBsYWNlKC8oXlxccyopfChcXHMqJCkvZywgJycpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbCA9IG5vcm1hbGl6ZVZhbHVlKHZhbCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMudGFnVmFsQ2FjaGUua2V5ID0gdmFsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHZhbDtcbiAgICAgICAgfSxcblxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIChrZXksIGRlZmF1bHR2YWwpIHtcbiAgICAgICAgICAgIHZhciB0YWdPcHRpb24gPSB0aGlzLmdldFRhZ1NldHRpbmcoa2V5KSxcbiAgICAgICAgICAgICAgICByZXN1bHQ7XG4gICAgICAgICAgICBpZiAodGFnT3B0aW9uICE9PSBVTlNFVF9PUFRJT04pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGFnT3B0aW9uO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIChyZXN1bHQgPSB0aGlzLm1lcmdlZE9wdGlvbnNba2V5XSkgPT09IHVuZGVmaW5lZCA/IGRlZmF1bHR2YWwgOiByZXN1bHQ7XG4gICAgICAgIH1cbiAgICB9KTtcblxuXG4gICAgJC5mbi5zcGFya2xpbmUuX2Jhc2UgPSBjcmVhdGVDbGFzcyh7XG4gICAgICAgIGRpc2FibGVkOiBmYWxzZSxcblxuICAgICAgICBpbml0OiBmdW5jdGlvbiAoZWwsIHZhbHVlcywgb3B0aW9ucywgd2lkdGgsIGhlaWdodCkge1xuICAgICAgICAgICAgdGhpcy5lbCA9IGVsO1xuICAgICAgICAgICAgdGhpcy4kZWwgPSAkKGVsKTtcbiAgICAgICAgICAgIHRoaXMudmFsdWVzID0gdmFsdWVzO1xuICAgICAgICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbiAgICAgICAgICAgIHRoaXMud2lkdGggPSB3aWR0aDtcbiAgICAgICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50UmVnaW9uID0gdW5kZWZpbmVkO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTZXR1cCB0aGUgY2FudmFzXG4gICAgICAgICAqL1xuICAgICAgICBpbml0VGFyZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgaW50ZXJhY3RpdmUgPSAhdGhpcy5vcHRpb25zLmdldCgnZGlzYWJsZUludGVyYWN0aW9uJyk7XG4gICAgICAgICAgICBpZiAoISh0aGlzLnRhcmdldCA9IHRoaXMuJGVsLnNpbXBsZWRyYXcodGhpcy53aWR0aCwgdGhpcy5oZWlnaHQsIHRoaXMub3B0aW9ucy5nZXQoJ2NvbXBvc2l0ZScpLCBpbnRlcmFjdGl2ZSkpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kaXNhYmxlZCA9IHRydWU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuY2FudmFzV2lkdGggPSB0aGlzLnRhcmdldC5waXhlbFdpZHRoO1xuICAgICAgICAgICAgICAgIHRoaXMuY2FudmFzSGVpZ2h0ID0gdGhpcy50YXJnZXQucGl4ZWxIZWlnaHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEFjdHVhbGx5IHJlbmRlciB0aGUgY2hhcnQgdG8gdGhlIGNhbnZhc1xuICAgICAgICAgKi9cbiAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5kaXNhYmxlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZWwuaW5uZXJIVE1MID0gJyc7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJldHVybiBhIHJlZ2lvbiBpZCBmb3IgYSBnaXZlbiB4L3kgY28tb3JkaW5hdGVcbiAgICAgICAgICovXG4gICAgICAgIGdldFJlZ2lvbjogZnVuY3Rpb24gKHgsIHkpIHtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogSGlnaGxpZ2h0IGFuIGl0ZW0gYmFzZWQgb24gdGhlIG1vdXNlZC1vdmVyIHgseSBjby1vcmRpbmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgc2V0UmVnaW9uSGlnaGxpZ2h0OiBmdW5jdGlvbiAoZWwsIHgsIHkpIHtcbiAgICAgICAgICAgIHZhciBjdXJyZW50UmVnaW9uID0gdGhpcy5jdXJyZW50UmVnaW9uLFxuICAgICAgICAgICAgICAgIGhpZ2hsaWdodEVuYWJsZWQgPSAhdGhpcy5vcHRpb25zLmdldCgnZGlzYWJsZUhpZ2hsaWdodCcpLFxuICAgICAgICAgICAgICAgIG5ld1JlZ2lvbjtcbiAgICAgICAgICAgIGlmICh4ID4gdGhpcy5jYW52YXNXaWR0aCB8fCB5ID4gdGhpcy5jYW52YXNIZWlnaHQgfHwgeCA8IDAgfHwgeSA8IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5ld1JlZ2lvbiA9IHRoaXMuZ2V0UmVnaW9uKGVsLCB4LCB5KTtcbiAgICAgICAgICAgIGlmIChjdXJyZW50UmVnaW9uICE9PSBuZXdSZWdpb24pIHtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudFJlZ2lvbiAhPT0gdW5kZWZpbmVkICYmIGhpZ2hsaWdodEVuYWJsZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVIaWdobGlnaHQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50UmVnaW9uID0gbmV3UmVnaW9uO1xuICAgICAgICAgICAgICAgIGlmIChuZXdSZWdpb24gIT09IHVuZGVmaW5lZCAmJiBoaWdobGlnaHRFbmFibGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVySGlnaGxpZ2h0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSZXNldCBhbnkgY3VycmVudGx5IGhpZ2hsaWdodGVkIGl0ZW1cbiAgICAgICAgICovXG4gICAgICAgIGNsZWFyUmVnaW9uSGlnaGxpZ2h0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50UmVnaW9uICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUhpZ2hsaWdodCgpO1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFJlZ2lvbiA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSxcblxuICAgICAgICByZW5kZXJIaWdobGlnaHQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlSGlnaGxpZ2h0KHRydWUpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlbW92ZUhpZ2hsaWdodDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5jaGFuZ2VIaWdobGlnaHQoZmFsc2UpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGNoYW5nZUhpZ2hsaWdodDogZnVuY3Rpb24gKGhpZ2hsaWdodCkgIHt9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGZXRjaCB0aGUgSFRNTCB0byBkaXNwbGF5IGFzIGEgdG9vbHRpcFxuICAgICAgICAgKi9cbiAgICAgICAgZ2V0Q3VycmVudFJlZ2lvblRvb2x0aXA6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBvcHRpb25zID0gdGhpcy5vcHRpb25zLFxuICAgICAgICAgICAgICAgIGhlYWRlciA9ICcnLFxuICAgICAgICAgICAgICAgIGVudHJpZXMgPSBbXSxcbiAgICAgICAgICAgICAgICBmaWVsZHMsIGZvcm1hdHMsIGZvcm1hdGxlbiwgZmNsYXNzLCB0ZXh0LCBpLFxuICAgICAgICAgICAgICAgIHNob3dGaWVsZHMsIHNob3dGaWVsZHNLZXksIG5ld0ZpZWxkcywgZnYsXG4gICAgICAgICAgICAgICAgZm9ybWF0dGVyLCBmb3JtYXQsIGZpZWxkbGVuLCBqO1xuICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudFJlZ2lvbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZmllbGRzID0gdGhpcy5nZXRDdXJyZW50UmVnaW9uRmllbGRzKCk7XG4gICAgICAgICAgICBmb3JtYXR0ZXIgPSBvcHRpb25zLmdldCgndG9vbHRpcEZvcm1hdHRlcicpO1xuICAgICAgICAgICAgaWYgKGZvcm1hdHRlcikge1xuICAgICAgICAgICAgICAgIHJldHVybiBmb3JtYXR0ZXIodGhpcywgb3B0aW9ucywgZmllbGRzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChvcHRpb25zLmdldCgndG9vbHRpcENoYXJ0VGl0bGUnKSkge1xuICAgICAgICAgICAgICAgIGhlYWRlciArPSAnPGRpdiBjbGFzcz1cImpxcyBqcXN0aXRsZVwiPicgKyBvcHRpb25zLmdldCgndG9vbHRpcENoYXJ0VGl0bGUnKSArICc8L2Rpdj5cXG4nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9ybWF0cyA9IHRoaXMub3B0aW9ucy5nZXQoJ3Rvb2x0aXBGb3JtYXQnKTtcbiAgICAgICAgICAgIGlmICghZm9ybWF0cykge1xuICAgICAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghJC5pc0FycmF5KGZvcm1hdHMpKSB7XG4gICAgICAgICAgICAgICAgZm9ybWF0cyA9IFtmb3JtYXRzXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghJC5pc0FycmF5KGZpZWxkcykpIHtcbiAgICAgICAgICAgICAgICBmaWVsZHMgPSBbZmllbGRzXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNob3dGaWVsZHMgPSB0aGlzLm9wdGlvbnMuZ2V0KCd0b29sdGlwRm9ybWF0RmllbGRsaXN0Jyk7XG4gICAgICAgICAgICBzaG93RmllbGRzS2V5ID0gdGhpcy5vcHRpb25zLmdldCgndG9vbHRpcEZvcm1hdEZpZWxkbGlzdEtleScpO1xuICAgICAgICAgICAgaWYgKHNob3dGaWVsZHMgJiYgc2hvd0ZpZWxkc0tleSkge1xuICAgICAgICAgICAgICAgIC8vIHVzZXItc2VsZWN0ZWQgb3JkZXJpbmcgb2YgZmllbGRzXG4gICAgICAgICAgICAgICAgbmV3RmllbGRzID0gW107XG4gICAgICAgICAgICAgICAgZm9yIChpID0gZmllbGRzLmxlbmd0aDsgaS0tOykge1xuICAgICAgICAgICAgICAgICAgICBmdiA9IGZpZWxkc1tpXVtzaG93RmllbGRzS2V5XTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKChqID0gJC5pbkFycmF5KGZ2LCBzaG93RmllbGRzKSkgIT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0ZpZWxkc1tqXSA9IGZpZWxkc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmaWVsZHMgPSBuZXdGaWVsZHM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3JtYXRsZW4gPSBmb3JtYXRzLmxlbmd0aDtcbiAgICAgICAgICAgIGZpZWxkbGVuID0gZmllbGRzLmxlbmd0aDtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBmb3JtYXRsZW47IGkrKykge1xuICAgICAgICAgICAgICAgIGZvcm1hdCA9IGZvcm1hdHNbaV07XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBmb3JtYXQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvcm1hdCA9IG5ldyBTUEZvcm1hdChmb3JtYXQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmY2xhc3MgPSBmb3JtYXQuZmNsYXNzIHx8ICdqcXNmaWVsZCc7XG4gICAgICAgICAgICAgICAgZm9yIChqID0gMDsgaiA8IGZpZWxkbGVuOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFmaWVsZHNbal0uaXNOdWxsIHx8ICFvcHRpb25zLmdldCgndG9vbHRpcFNraXBOdWxsJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICQuZXh0ZW5kKGZpZWxkc1tqXSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZWZpeDogb3B0aW9ucy5nZXQoJ3Rvb2x0aXBQcmVmaXgnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWZmaXg6IG9wdGlvbnMuZ2V0KCd0b29sdGlwU3VmZml4JylcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCA9IGZvcm1hdC5yZW5kZXIoZmllbGRzW2pdLCBvcHRpb25zLmdldCgndG9vbHRpcFZhbHVlTG9va3VwcycpLCBvcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVudHJpZXMucHVzaCgnPGRpdiBjbGFzcz1cIicgKyBmY2xhc3MgKyAnXCI+JyArIHRleHQgKyAnPC9kaXY+Jyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZW50cmllcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaGVhZGVyICsgZW50cmllcy5qb2luKCdcXG4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgfSxcblxuICAgICAgICBnZXRDdXJyZW50UmVnaW9uRmllbGRzOiBmdW5jdGlvbiAoKSB7fSxcblxuICAgICAgICBjYWxjSGlnaGxpZ2h0Q29sb3I6IGZ1bmN0aW9uIChjb2xvciwgb3B0aW9ucykge1xuICAgICAgICAgICAgdmFyIGhpZ2hsaWdodENvbG9yID0gb3B0aW9ucy5nZXQoJ2hpZ2hsaWdodENvbG9yJyksXG4gICAgICAgICAgICAgICAgbGlnaHRlbiA9IG9wdGlvbnMuZ2V0KCdoaWdobGlnaHRMaWdodGVuJyksXG4gICAgICAgICAgICAgICAgcGFyc2UsIG11bHQsIHJnYm5ldywgaTtcbiAgICAgICAgICAgIGlmIChoaWdobGlnaHRDb2xvcikge1xuICAgICAgICAgICAgICAgIHJldHVybiBoaWdobGlnaHRDb2xvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChsaWdodGVuKSB7XG4gICAgICAgICAgICAgICAgLy8gZXh0cmFjdCBSR0IgdmFsdWVzXG4gICAgICAgICAgICAgICAgcGFyc2UgPSAvXiMoWzAtOWEtZl0pKFswLTlhLWZdKShbMC05YS1mXSkkL2kuZXhlYyhjb2xvcikgfHwgL14jKFswLTlhLWZdezJ9KShbMC05YS1mXXsyfSkoWzAtOWEtZl17Mn0pJC9pLmV4ZWMoY29sb3IpO1xuICAgICAgICAgICAgICAgIGlmIChwYXJzZSkge1xuICAgICAgICAgICAgICAgICAgICByZ2JuZXcgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgbXVsdCA9IGNvbG9yLmxlbmd0aCA9PT0gNCA/IDE2IDogMTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IDM7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmdibmV3W2ldID0gY2xpcHZhbChNYXRoLnJvdW5kKHBhcnNlSW50KHBhcnNlW2kgKyAxXSwgMTYpICogbXVsdCAqIGxpZ2h0ZW4pLCAwLCAyNTUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAncmdiKCcgKyByZ2JuZXcuam9pbignLCcpICsgJyknO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGNvbG9yO1xuICAgICAgICB9XG5cbiAgICB9KTtcblxuICAgIGJhckhpZ2hsaWdodE1peGluID0ge1xuICAgICAgICBjaGFuZ2VIaWdobGlnaHQ6IGZ1bmN0aW9uIChoaWdobGlnaHQpIHtcbiAgICAgICAgICAgIHZhciBjdXJyZW50UmVnaW9uID0gdGhpcy5jdXJyZW50UmVnaW9uLFxuICAgICAgICAgICAgICAgIHRhcmdldCA9IHRoaXMudGFyZ2V0LFxuICAgICAgICAgICAgICAgIHNoYXBlaWRzID0gdGhpcy5yZWdpb25TaGFwZXNbY3VycmVudFJlZ2lvbl0sXG4gICAgICAgICAgICAgICAgbmV3U2hhcGVzO1xuICAgICAgICAgICAgLy8gd2lsbCBiZSBudWxsIGlmIHRoZSByZWdpb24gdmFsdWUgd2FzIG51bGxcbiAgICAgICAgICAgIGlmIChzaGFwZWlkcykge1xuICAgICAgICAgICAgICAgIG5ld1NoYXBlcyA9IHRoaXMucmVuZGVyUmVnaW9uKGN1cnJlbnRSZWdpb24sIGhpZ2hsaWdodCk7XG4gICAgICAgICAgICAgICAgaWYgKCQuaXNBcnJheShuZXdTaGFwZXMpIHx8ICQuaXNBcnJheShzaGFwZWlkcykpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LnJlcGxhY2VXaXRoU2hhcGVzKHNoYXBlaWRzLCBuZXdTaGFwZXMpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlZ2lvblNoYXBlc1tjdXJyZW50UmVnaW9uXSA9ICQubWFwKG5ld1NoYXBlcywgZnVuY3Rpb24gKG5ld1NoYXBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3U2hhcGUuaWQ7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldC5yZXBsYWNlV2l0aFNoYXBlKHNoYXBlaWRzLCBuZXdTaGFwZXMpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlZ2lvblNoYXBlc1tjdXJyZW50UmVnaW9uXSA9IG5ld1NoYXBlcy5pZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdmFsdWVzID0gdGhpcy52YWx1ZXMsXG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0gdGhpcy50YXJnZXQsXG4gICAgICAgICAgICAgICAgcmVnaW9uU2hhcGVzID0gdGhpcy5yZWdpb25TaGFwZXMsXG4gICAgICAgICAgICAgICAgc2hhcGVzLCBpZHMsIGksIGo7XG5cbiAgICAgICAgICAgIGlmICghdGhpcy5jbHMuX3N1cGVyLnJlbmRlci5jYWxsKHRoaXMpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChpID0gdmFsdWVzLmxlbmd0aDsgaS0tOykge1xuICAgICAgICAgICAgICAgIHNoYXBlcyA9IHRoaXMucmVuZGVyUmVnaW9uKGkpO1xuICAgICAgICAgICAgICAgIGlmIChzaGFwZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCQuaXNBcnJheShzaGFwZXMpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZHMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaiA9IHNoYXBlcy5sZW5ndGg7IGotLTspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGFwZXNbal0uYXBwZW5kKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRzLnB1c2goc2hhcGVzW2pdLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZ2lvblNoYXBlc1tpXSA9IGlkcztcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoYXBlcy5hcHBlbmQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZ2lvblNoYXBlc1tpXSA9IHNoYXBlcy5pZDsgLy8gc3RvcmUganVzdCB0aGUgc2hhcGVpZFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gbnVsbCB2YWx1ZVxuICAgICAgICAgICAgICAgICAgICByZWdpb25TaGFwZXNbaV0gPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRhcmdldC5yZW5kZXIoKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBMaW5lIGNoYXJ0c1xuICAgICAqL1xuICAgICQuZm4uc3BhcmtsaW5lLmxpbmUgPSBsaW5lID0gY3JlYXRlQ2xhc3MoJC5mbi5zcGFya2xpbmUuX2Jhc2UsIHtcbiAgICAgICAgdHlwZTogJ2xpbmUnLFxuXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uIChlbCwgdmFsdWVzLCBvcHRpb25zLCB3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICAgICAgICBsaW5lLl9zdXBlci5pbml0LmNhbGwodGhpcywgZWwsIHZhbHVlcywgb3B0aW9ucywgd2lkdGgsIGhlaWdodCk7XG4gICAgICAgICAgICB0aGlzLnZlcnRpY2VzID0gW107XG4gICAgICAgICAgICB0aGlzLnJlZ2lvbk1hcCA9IFtdO1xuICAgICAgICAgICAgdGhpcy54dmFsdWVzID0gW107XG4gICAgICAgICAgICB0aGlzLnl2YWx1ZXMgPSBbXTtcbiAgICAgICAgICAgIHRoaXMueW1pbm1heCA9IFtdO1xuICAgICAgICAgICAgdGhpcy5oaWdodGxpZ2h0U3BvdElkID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMubGFzdFNoYXBlSWQgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5pbml0VGFyZ2V0KCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2V0UmVnaW9uOiBmdW5jdGlvbiAoZWwsIHgsIHkpIHtcbiAgICAgICAgICAgIHZhciBpLFxuICAgICAgICAgICAgICAgIHJlZ2lvbk1hcCA9IHRoaXMucmVnaW9uTWFwOyAvLyBtYXBzIHJlZ2lvbnMgdG8gdmFsdWUgcG9zaXRpb25zXG4gICAgICAgICAgICBmb3IgKGkgPSByZWdpb25NYXAubGVuZ3RoOyBpLS07KSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlZ2lvbk1hcFtpXSAhPT0gbnVsbCAmJiB4ID49IHJlZ2lvbk1hcFtpXVswXSAmJiB4IDw9IHJlZ2lvbk1hcFtpXVsxXSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnaW9uTWFwW2ldWzJdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2V0Q3VycmVudFJlZ2lvbkZpZWxkczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRSZWdpb24gPSB0aGlzLmN1cnJlbnRSZWdpb247XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGlzTnVsbDogdGhpcy55dmFsdWVzW2N1cnJlbnRSZWdpb25dID09PSBudWxsLFxuICAgICAgICAgICAgICAgIHg6IHRoaXMueHZhbHVlc1tjdXJyZW50UmVnaW9uXSxcbiAgICAgICAgICAgICAgICB5OiB0aGlzLnl2YWx1ZXNbY3VycmVudFJlZ2lvbl0sXG4gICAgICAgICAgICAgICAgY29sb3I6IHRoaXMub3B0aW9ucy5nZXQoJ2xpbmVDb2xvcicpLFxuICAgICAgICAgICAgICAgIGZpbGxDb2xvcjogdGhpcy5vcHRpb25zLmdldCgnZmlsbENvbG9yJyksXG4gICAgICAgICAgICAgICAgb2Zmc2V0OiBjdXJyZW50UmVnaW9uXG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlbmRlckhpZ2hsaWdodDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRSZWdpb24gPSB0aGlzLmN1cnJlbnRSZWdpb24sXG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0gdGhpcy50YXJnZXQsXG4gICAgICAgICAgICAgICAgdmVydGV4ID0gdGhpcy52ZXJ0aWNlc1tjdXJyZW50UmVnaW9uXSxcbiAgICAgICAgICAgICAgICBvcHRpb25zID0gdGhpcy5vcHRpb25zLFxuICAgICAgICAgICAgICAgIHNwb3RSYWRpdXMgPSBvcHRpb25zLmdldCgnc3BvdFJhZGl1cycpLFxuICAgICAgICAgICAgICAgIGhpZ2hsaWdodFNwb3RDb2xvciA9IG9wdGlvbnMuZ2V0KCdoaWdobGlnaHRTcG90Q29sb3InKSxcbiAgICAgICAgICAgICAgICBoaWdobGlnaHRMaW5lQ29sb3IgPSBvcHRpb25zLmdldCgnaGlnaGxpZ2h0TGluZUNvbG9yJyksXG4gICAgICAgICAgICAgICAgaGlnaGxpZ2h0U3BvdCwgaGlnaGxpZ2h0TGluZTtcblxuICAgICAgICAgICAgaWYgKCF2ZXJ0ZXgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc3BvdFJhZGl1cyAmJiBoaWdobGlnaHRTcG90Q29sb3IpIHtcbiAgICAgICAgICAgICAgICBoaWdobGlnaHRTcG90ID0gdGFyZ2V0LmRyYXdDaXJjbGUodmVydGV4WzBdLCB2ZXJ0ZXhbMV0sXG4gICAgICAgICAgICAgICAgICAgIHNwb3RSYWRpdXMsIHVuZGVmaW5lZCwgaGlnaGxpZ2h0U3BvdENvbG9yKTtcbiAgICAgICAgICAgICAgICB0aGlzLmhpZ2hsaWdodFNwb3RJZCA9IGhpZ2hsaWdodFNwb3QuaWQ7XG4gICAgICAgICAgICAgICAgdGFyZ2V0Lmluc2VydEFmdGVyU2hhcGUodGhpcy5sYXN0U2hhcGVJZCwgaGlnaGxpZ2h0U3BvdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaGlnaGxpZ2h0TGluZUNvbG9yKSB7XG4gICAgICAgICAgICAgICAgaGlnaGxpZ2h0TGluZSA9IHRhcmdldC5kcmF3TGluZSh2ZXJ0ZXhbMF0sIHRoaXMuY2FudmFzVG9wLCB2ZXJ0ZXhbMF0sXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2FudmFzVG9wICsgdGhpcy5jYW52YXNIZWlnaHQsIGhpZ2hsaWdodExpbmVDb2xvcik7XG4gICAgICAgICAgICAgICAgdGhpcy5oaWdobGlnaHRMaW5lSWQgPSBoaWdobGlnaHRMaW5lLmlkO1xuICAgICAgICAgICAgICAgIHRhcmdldC5pbnNlcnRBZnRlclNoYXBlKHRoaXMubGFzdFNoYXBlSWQsIGhpZ2hsaWdodExpbmUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIHJlbW92ZUhpZ2hsaWdodDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHRhcmdldCA9IHRoaXMudGFyZ2V0O1xuICAgICAgICAgICAgaWYgKHRoaXMuaGlnaGxpZ2h0U3BvdElkKSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0LnJlbW92ZVNoYXBlSWQodGhpcy5oaWdobGlnaHRTcG90SWQpO1xuICAgICAgICAgICAgICAgIHRoaXMuaGlnaGxpZ2h0U3BvdElkID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmhpZ2hsaWdodExpbmVJZCkge1xuICAgICAgICAgICAgICAgIHRhcmdldC5yZW1vdmVTaGFwZUlkKHRoaXMuaGlnaGxpZ2h0TGluZUlkKTtcbiAgICAgICAgICAgICAgICB0aGlzLmhpZ2hsaWdodExpbmVJZCA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2NhblZhbHVlczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHZhbHVlcyA9IHRoaXMudmFsdWVzLFxuICAgICAgICAgICAgICAgIHZhbGNvdW50ID0gdmFsdWVzLmxlbmd0aCxcbiAgICAgICAgICAgICAgICB4dmFsdWVzID0gdGhpcy54dmFsdWVzLFxuICAgICAgICAgICAgICAgIHl2YWx1ZXMgPSB0aGlzLnl2YWx1ZXMsXG4gICAgICAgICAgICAgICAgeW1pbm1heCA9IHRoaXMueW1pbm1heCxcbiAgICAgICAgICAgICAgICBpLCB2YWwsIGlzU3RyLCBpc0FycmF5LCBzcDtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCB2YWxjb3VudDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFsID0gdmFsdWVzW2ldO1xuICAgICAgICAgICAgICAgIGlzU3RyID0gdHlwZW9mKHZhbHVlc1tpXSkgPT09ICdzdHJpbmcnO1xuICAgICAgICAgICAgICAgIGlzQXJyYXkgPSB0eXBlb2YodmFsdWVzW2ldKSA9PT0gJ29iamVjdCcgJiYgdmFsdWVzW2ldIGluc3RhbmNlb2YgQXJyYXk7XG4gICAgICAgICAgICAgICAgc3AgPSBpc1N0ciAmJiB2YWx1ZXNbaV0uc3BsaXQoJzonKTtcbiAgICAgICAgICAgICAgICBpZiAoaXNTdHIgJiYgc3AubGVuZ3RoID09PSAyKSB7IC8vIHg6eVxuICAgICAgICAgICAgICAgICAgICB4dmFsdWVzLnB1c2goTnVtYmVyKHNwWzBdKSk7XG4gICAgICAgICAgICAgICAgICAgIHl2YWx1ZXMucHVzaChOdW1iZXIoc3BbMV0pKTtcbiAgICAgICAgICAgICAgICAgICAgeW1pbm1heC5wdXNoKE51bWJlcihzcFsxXSkpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNBcnJheSkge1xuICAgICAgICAgICAgICAgICAgICB4dmFsdWVzLnB1c2godmFsWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgeXZhbHVlcy5wdXNoKHZhbFsxXSk7XG4gICAgICAgICAgICAgICAgICAgIHltaW5tYXgucHVzaCh2YWxbMV0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHh2YWx1ZXMucHVzaChpKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlc1tpXSA9PT0gbnVsbCB8fCB2YWx1ZXNbaV0gPT09ICdudWxsJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgeXZhbHVlcy5wdXNoKG51bGwpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgeXZhbHVlcy5wdXNoKE51bWJlcih2YWwpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHltaW5tYXgucHVzaChOdW1iZXIodmFsKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmdldCgneHZhbHVlcycpKSB7XG4gICAgICAgICAgICAgICAgeHZhbHVlcyA9IHRoaXMub3B0aW9ucy5nZXQoJ3h2YWx1ZXMnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5tYXh5ID0gdGhpcy5tYXh5b3JnID0gTWF0aC5tYXguYXBwbHkoTWF0aCwgeW1pbm1heCk7XG4gICAgICAgICAgICB0aGlzLm1pbnkgPSB0aGlzLm1pbnlvcmcgPSBNYXRoLm1pbi5hcHBseShNYXRoLCB5bWlubWF4KTtcblxuICAgICAgICAgICAgdGhpcy5tYXh4ID0gTWF0aC5tYXguYXBwbHkoTWF0aCwgeHZhbHVlcyk7XG4gICAgICAgICAgICB0aGlzLm1pbnggPSBNYXRoLm1pbi5hcHBseShNYXRoLCB4dmFsdWVzKTtcblxuICAgICAgICAgICAgdGhpcy54dmFsdWVzID0geHZhbHVlcztcbiAgICAgICAgICAgIHRoaXMueXZhbHVlcyA9IHl2YWx1ZXM7XG4gICAgICAgICAgICB0aGlzLnltaW5tYXggPSB5bWlubWF4O1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgcHJvY2Vzc1JhbmdlT3B0aW9uczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnMsXG4gICAgICAgICAgICAgICAgbm9ybWFsUmFuZ2VNaW4gPSBvcHRpb25zLmdldCgnbm9ybWFsUmFuZ2VNaW4nKSxcbiAgICAgICAgICAgICAgICBub3JtYWxSYW5nZU1heCA9IG9wdGlvbnMuZ2V0KCdub3JtYWxSYW5nZU1heCcpO1xuXG4gICAgICAgICAgICBpZiAobm9ybWFsUmFuZ2VNaW4gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGlmIChub3JtYWxSYW5nZU1pbiA8IHRoaXMubWlueSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm1pbnkgPSBub3JtYWxSYW5nZU1pbjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG5vcm1hbFJhbmdlTWF4ID4gdGhpcy5tYXh5KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWF4eSA9IG5vcm1hbFJhbmdlTWF4O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChvcHRpb25zLmdldCgnY2hhcnRSYW5nZU1pbicpICE9PSB1bmRlZmluZWQgJiYgKG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlQ2xpcCcpIHx8IG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlTWluJykgPCB0aGlzLm1pbnkpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5taW55ID0gb3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNaW4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChvcHRpb25zLmdldCgnY2hhcnRSYW5nZU1heCcpICE9PSB1bmRlZmluZWQgJiYgKG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlQ2xpcCcpIHx8IG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlTWF4JykgPiB0aGlzLm1heHkpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5tYXh5ID0gb3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNYXgnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChvcHRpb25zLmdldCgnY2hhcnRSYW5nZU1pblgnKSAhPT0gdW5kZWZpbmVkICYmIChvcHRpb25zLmdldCgnY2hhcnRSYW5nZUNsaXBYJykgfHwgb3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNaW5YJykgPCB0aGlzLm1pbngpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5taW54ID0gb3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNaW5YJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAob3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNYXhYJykgIT09IHVuZGVmaW5lZCAmJiAob3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VDbGlwWCcpIHx8IG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlTWF4WCcpID4gdGhpcy5tYXh4KSkge1xuICAgICAgICAgICAgICAgIHRoaXMubWF4eCA9IG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlTWF4WCcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0sXG5cbiAgICAgICAgZHJhd05vcm1hbFJhbmdlOiBmdW5jdGlvbiAoY2FudmFzTGVmdCwgY2FudmFzVG9wLCBjYW52YXNIZWlnaHQsIGNhbnZhc1dpZHRoLCByYW5nZXkpIHtcbiAgICAgICAgICAgIHZhciBub3JtYWxSYW5nZU1pbiA9IHRoaXMub3B0aW9ucy5nZXQoJ25vcm1hbFJhbmdlTWluJyksXG4gICAgICAgICAgICAgICAgbm9ybWFsUmFuZ2VNYXggPSB0aGlzLm9wdGlvbnMuZ2V0KCdub3JtYWxSYW5nZU1heCcpLFxuICAgICAgICAgICAgICAgIHl0b3AgPSBjYW52YXNUb3AgKyBNYXRoLnJvdW5kKGNhbnZhc0hlaWdodCAtIChjYW52YXNIZWlnaHQgKiAoKG5vcm1hbFJhbmdlTWF4IC0gdGhpcy5taW55KSAvIHJhbmdleSkpKSxcbiAgICAgICAgICAgICAgICBoZWlnaHQgPSBNYXRoLnJvdW5kKChjYW52YXNIZWlnaHQgKiAobm9ybWFsUmFuZ2VNYXggLSBub3JtYWxSYW5nZU1pbikpIC8gcmFuZ2V5KTtcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0LmRyYXdSZWN0KGNhbnZhc0xlZnQsIHl0b3AsIGNhbnZhc1dpZHRoLCBoZWlnaHQsIHVuZGVmaW5lZCwgdGhpcy5vcHRpb25zLmdldCgnbm9ybWFsUmFuZ2VDb2xvcicpKS5hcHBlbmQoKTtcbiAgICAgICAgfSxcblxuICAgICAgICByZW5kZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBvcHRpb25zID0gdGhpcy5vcHRpb25zLFxuICAgICAgICAgICAgICAgIHRhcmdldCA9IHRoaXMudGFyZ2V0LFxuICAgICAgICAgICAgICAgIGNhbnZhc1dpZHRoID0gdGhpcy5jYW52YXNXaWR0aCxcbiAgICAgICAgICAgICAgICBjYW52YXNIZWlnaHQgPSB0aGlzLmNhbnZhc0hlaWdodCxcbiAgICAgICAgICAgICAgICB2ZXJ0aWNlcyA9IHRoaXMudmVydGljZXMsXG4gICAgICAgICAgICAgICAgc3BvdFJhZGl1cyA9IG9wdGlvbnMuZ2V0KCdzcG90UmFkaXVzJyksXG4gICAgICAgICAgICAgICAgcmVnaW9uTWFwID0gdGhpcy5yZWdpb25NYXAsXG4gICAgICAgICAgICAgICAgcmFuZ2V4LCByYW5nZXksIHl2YWxsYXN0LFxuICAgICAgICAgICAgICAgIGNhbnZhc1RvcCwgY2FudmFzTGVmdCxcbiAgICAgICAgICAgICAgICB2ZXJ0ZXgsIHBhdGgsIHBhdGhzLCB4LCB5LCB4bmV4dCwgeHBvcywgeHBvc25leHQsXG4gICAgICAgICAgICAgICAgbGFzdCwgbmV4dCwgeXZhbGNvdW50LCBsaW5lU2hhcGVzLCBmaWxsU2hhcGVzLCBwbGVuLFxuICAgICAgICAgICAgICAgIHZhbHVlU3BvdHMsIGhsU3BvdHNFbmFibGVkLCBjb2xvciwgeHZhbHVlcywgeXZhbHVlcywgaTtcblxuICAgICAgICAgICAgaWYgKCFsaW5lLl9zdXBlci5yZW5kZXIuY2FsbCh0aGlzKSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5zY2FuVmFsdWVzKCk7XG4gICAgICAgICAgICB0aGlzLnByb2Nlc3NSYW5nZU9wdGlvbnMoKTtcblxuICAgICAgICAgICAgeHZhbHVlcyA9IHRoaXMueHZhbHVlcztcbiAgICAgICAgICAgIHl2YWx1ZXMgPSB0aGlzLnl2YWx1ZXM7XG5cbiAgICAgICAgICAgIGlmICghdGhpcy55bWlubWF4Lmxlbmd0aCB8fCB0aGlzLnl2YWx1ZXMubGVuZ3RoIDwgMikge1xuICAgICAgICAgICAgICAgIC8vIGVtcHR5IG9yIGFsbCBudWxsIHZhbHVlc3NcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhbnZhc1RvcCA9IGNhbnZhc0xlZnQgPSAwO1xuXG4gICAgICAgICAgICByYW5nZXggPSB0aGlzLm1heHggLSB0aGlzLm1pbnggPT09IDAgPyAxIDogdGhpcy5tYXh4IC0gdGhpcy5taW54O1xuICAgICAgICAgICAgcmFuZ2V5ID0gdGhpcy5tYXh5IC0gdGhpcy5taW55ID09PSAwID8gMSA6IHRoaXMubWF4eSAtIHRoaXMubWlueTtcbiAgICAgICAgICAgIHl2YWxsYXN0ID0gdGhpcy55dmFsdWVzLmxlbmd0aCAtIDE7XG5cbiAgICAgICAgICAgIGlmIChzcG90UmFkaXVzICYmIChjYW52YXNXaWR0aCA8IChzcG90UmFkaXVzICogNCkgfHwgY2FudmFzSGVpZ2h0IDwgKHNwb3RSYWRpdXMgKiA0KSkpIHtcbiAgICAgICAgICAgICAgICBzcG90UmFkaXVzID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzcG90UmFkaXVzKSB7XG4gICAgICAgICAgICAgICAgLy8gYWRqdXN0IHRoZSBjYW52YXMgc2l6ZSBhcyByZXF1aXJlZCBzbyB0aGF0IHNwb3RzIHdpbGwgZml0XG4gICAgICAgICAgICAgICAgaGxTcG90c0VuYWJsZWQgPSBvcHRpb25zLmdldCgnaGlnaGxpZ2h0U3BvdENvbG9yJykgJiYgICFvcHRpb25zLmdldCgnZGlzYWJsZUludGVyYWN0aW9uJyk7XG4gICAgICAgICAgICAgICAgaWYgKGhsU3BvdHNFbmFibGVkIHx8IG9wdGlvbnMuZ2V0KCdtaW5TcG90Q29sb3InKSB8fCAob3B0aW9ucy5nZXQoJ3Nwb3RDb2xvcicpICYmIHl2YWx1ZXNbeXZhbGxhc3RdID09PSB0aGlzLm1pbnkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhbnZhc0hlaWdodCAtPSBNYXRoLmNlaWwoc3BvdFJhZGl1cyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChobFNwb3RzRW5hYmxlZCB8fCBvcHRpb25zLmdldCgnbWF4U3BvdENvbG9yJykgfHwgKG9wdGlvbnMuZ2V0KCdzcG90Q29sb3InKSAmJiB5dmFsdWVzW3l2YWxsYXN0XSA9PT0gdGhpcy5tYXh5KSkge1xuICAgICAgICAgICAgICAgICAgICBjYW52YXNIZWlnaHQgLT0gTWF0aC5jZWlsKHNwb3RSYWRpdXMpO1xuICAgICAgICAgICAgICAgICAgICBjYW52YXNUb3AgKz0gTWF0aC5jZWlsKHNwb3RSYWRpdXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoaGxTcG90c0VuYWJsZWQgfHxcbiAgICAgICAgICAgICAgICAgICAgICgob3B0aW9ucy5nZXQoJ21pblNwb3RDb2xvcicpIHx8IG9wdGlvbnMuZ2V0KCdtYXhTcG90Q29sb3InKSkgJiYgKHl2YWx1ZXNbMF0gPT09IHRoaXMubWlueSB8fCB5dmFsdWVzWzBdID09PSB0aGlzLm1heHkpKSkge1xuICAgICAgICAgICAgICAgICAgICBjYW52YXNMZWZ0ICs9IE1hdGguY2VpbChzcG90UmFkaXVzKTtcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzV2lkdGggLT0gTWF0aC5jZWlsKHNwb3RSYWRpdXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoaGxTcG90c0VuYWJsZWQgfHwgb3B0aW9ucy5nZXQoJ3Nwb3RDb2xvcicpIHx8XG4gICAgICAgICAgICAgICAgICAgIChvcHRpb25zLmdldCgnbWluU3BvdENvbG9yJykgfHwgb3B0aW9ucy5nZXQoJ21heFNwb3RDb2xvcicpICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAoeXZhbHVlc1t5dmFsbGFzdF0gPT09IHRoaXMubWlueSB8fCB5dmFsdWVzW3l2YWxsYXN0XSA9PT0gdGhpcy5tYXh5KSkpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzV2lkdGggLT0gTWF0aC5jZWlsKHNwb3RSYWRpdXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICBjYW52YXNIZWlnaHQtLTtcblxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuZ2V0KCdub3JtYWxSYW5nZU1pbicpICE9PSB1bmRlZmluZWQgJiYgIW9wdGlvbnMuZ2V0KCdkcmF3Tm9ybWFsT25Ub3AnKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZHJhd05vcm1hbFJhbmdlKGNhbnZhc0xlZnQsIGNhbnZhc1RvcCwgY2FudmFzSGVpZ2h0LCBjYW52YXNXaWR0aCwgcmFuZ2V5KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcGF0aCA9IFtdO1xuICAgICAgICAgICAgcGF0aHMgPSBbcGF0aF07XG4gICAgICAgICAgICBsYXN0ID0gbmV4dCA9IG51bGw7XG4gICAgICAgICAgICB5dmFsY291bnQgPSB5dmFsdWVzLmxlbmd0aDtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCB5dmFsY291bnQ7IGkrKykge1xuICAgICAgICAgICAgICAgIHggPSB4dmFsdWVzW2ldO1xuICAgICAgICAgICAgICAgIHhuZXh0ID0geHZhbHVlc1tpICsgMV07XG4gICAgICAgICAgICAgICAgeSA9IHl2YWx1ZXNbaV07XG4gICAgICAgICAgICAgICAgeHBvcyA9IGNhbnZhc0xlZnQgKyBNYXRoLnJvdW5kKCh4IC0gdGhpcy5taW54KSAqIChjYW52YXNXaWR0aCAvIHJhbmdleCkpO1xuICAgICAgICAgICAgICAgIHhwb3NuZXh0ID0gaSA8IHl2YWxjb3VudCAtIDEgPyBjYW52YXNMZWZ0ICsgTWF0aC5yb3VuZCgoeG5leHQgLSB0aGlzLm1pbngpICogKGNhbnZhc1dpZHRoIC8gcmFuZ2V4KSkgOiBjYW52YXNXaWR0aDtcbiAgICAgICAgICAgICAgICBuZXh0ID0geHBvcyArICgoeHBvc25leHQgLSB4cG9zKSAvIDIpO1xuICAgICAgICAgICAgICAgIHJlZ2lvbk1hcFtpXSA9IFtsYXN0IHx8IDAsIG5leHQsIGldO1xuICAgICAgICAgICAgICAgIGxhc3QgPSBuZXh0O1xuICAgICAgICAgICAgICAgIGlmICh5ID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoeXZhbHVlc1tpIC0gMV0gIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aHMucHVzaChwYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHZlcnRpY2VzLnB1c2gobnVsbCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoeSA8IHRoaXMubWlueSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgeSA9IHRoaXMubWlueTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoeSA+IHRoaXMubWF4eSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgeSA9IHRoaXMubWF4eTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoIXBhdGgubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBwcmV2aW91cyB2YWx1ZSB3YXMgbnVsbFxuICAgICAgICAgICAgICAgICAgICAgICAgcGF0aC5wdXNoKFt4cG9zLCBjYW52YXNUb3AgKyBjYW52YXNIZWlnaHRdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2ZXJ0ZXggPSBbeHBvcywgY2FudmFzVG9wICsgTWF0aC5yb3VuZChjYW52YXNIZWlnaHQgLSAoY2FudmFzSGVpZ2h0ICogKCh5IC0gdGhpcy5taW55KSAvIHJhbmdleSkpKV07XG4gICAgICAgICAgICAgICAgICAgIHBhdGgucHVzaCh2ZXJ0ZXgpO1xuICAgICAgICAgICAgICAgICAgICB2ZXJ0aWNlcy5wdXNoKHZlcnRleCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsaW5lU2hhcGVzID0gW107XG4gICAgICAgICAgICBmaWxsU2hhcGVzID0gW107XG4gICAgICAgICAgICBwbGVuID0gcGF0aHMubGVuZ3RoO1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHBsZW47IGkrKykge1xuICAgICAgICAgICAgICAgIHBhdGggPSBwYXRoc1tpXTtcbiAgICAgICAgICAgICAgICBpZiAocGF0aC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuZ2V0KCdmaWxsQ29sb3InKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGF0aC5wdXNoKFtwYXRoW3BhdGgubGVuZ3RoIC0gMV1bMF0sIChjYW52YXNUb3AgKyBjYW52YXNIZWlnaHQpXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaWxsU2hhcGVzLnB1c2gocGF0aC5zbGljZSgwKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXRoLnBvcCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIGlmIHRoZXJlJ3Mgb25seSBhIHNpbmdsZSBwb2ludCBpbiB0aGlzIHBhdGgsIHRoZW4gd2Ugd2FudCB0byBkaXNwbGF5IGl0XG4gICAgICAgICAgICAgICAgICAgIC8vIGFzIGEgdmVydGljYWwgbGluZSB3aGljaCBtZWFucyB3ZSBrZWVwIHBhdGhbMF0gIGFzIGlzXG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXRoLmxlbmd0aCA+IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVsc2Ugd2Ugd2FudCB0aGUgZmlyc3QgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhdGhbMF0gPSBbcGF0aFswXVswXSwgcGF0aFsxXVsxXV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbGluZVNoYXBlcy5wdXNoKHBhdGgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gZHJhdyB0aGUgZmlsbCBmaXJzdCwgdGhlbiBvcHRpb25hbGx5IHRoZSBub3JtYWwgcmFuZ2UsIHRoZW4gdGhlIGxpbmUgb24gdG9wIG9mIHRoYXRcbiAgICAgICAgICAgIHBsZW4gPSBmaWxsU2hhcGVzLmxlbmd0aDtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBwbGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgICB0YXJnZXQuZHJhd1NoYXBlKGZpbGxTaGFwZXNbaV0sXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZ2V0KCdmaWxsQ29sb3InKSwgb3B0aW9ucy5nZXQoJ2ZpbGxDb2xvcicpKS5hcHBlbmQoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuZ2V0KCdub3JtYWxSYW5nZU1pbicpICE9PSB1bmRlZmluZWQgJiYgb3B0aW9ucy5nZXQoJ2RyYXdOb3JtYWxPblRvcCcpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kcmF3Tm9ybWFsUmFuZ2UoY2FudmFzTGVmdCwgY2FudmFzVG9wLCBjYW52YXNIZWlnaHQsIGNhbnZhc1dpZHRoLCByYW5nZXkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBwbGVuID0gbGluZVNoYXBlcy5sZW5ndGg7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgcGxlbjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0LmRyYXdTaGFwZShsaW5lU2hhcGVzW2ldLCBvcHRpb25zLmdldCgnbGluZUNvbG9yJyksIHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5nZXQoJ2xpbmVXaWR0aCcpKS5hcHBlbmQoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHNwb3RSYWRpdXMgJiYgb3B0aW9ucy5nZXQoJ3ZhbHVlU3BvdHMnKSkge1xuICAgICAgICAgICAgICAgIHZhbHVlU3BvdHMgPSBvcHRpb25zLmdldCgndmFsdWVTcG90cycpO1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZVNwb3RzLmdldCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlU3BvdHMgPSBuZXcgUmFuZ2VNYXAodmFsdWVTcG90cyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCB5dmFsY291bnQ7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBjb2xvciA9IHZhbHVlU3BvdHMuZ2V0KHl2YWx1ZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY29sb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldC5kcmF3Q2lyY2xlKGNhbnZhc0xlZnQgKyBNYXRoLnJvdW5kKCh4dmFsdWVzW2ldIC0gdGhpcy5taW54KSAqIChjYW52YXNXaWR0aCAvIHJhbmdleCkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbnZhc1RvcCArIE1hdGgucm91bmQoY2FudmFzSGVpZ2h0IC0gKGNhbnZhc0hlaWdodCAqICgoeXZhbHVlc1tpXSAtIHRoaXMubWlueSkgLyByYW5nZXkpKSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BvdFJhZGl1cywgdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yKS5hcHBlbmQoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNwb3RSYWRpdXMgJiYgb3B0aW9ucy5nZXQoJ3Nwb3RDb2xvcicpICYmIHl2YWx1ZXNbeXZhbGxhc3RdICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0LmRyYXdDaXJjbGUoY2FudmFzTGVmdCArIE1hdGgucm91bmQoKHh2YWx1ZXNbeHZhbHVlcy5sZW5ndGggLSAxXSAtIHRoaXMubWlueCkgKiAoY2FudmFzV2lkdGggLyByYW5nZXgpKSxcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzVG9wICsgTWF0aC5yb3VuZChjYW52YXNIZWlnaHQgLSAoY2FudmFzSGVpZ2h0ICogKCh5dmFsdWVzW3l2YWxsYXN0XSAtIHRoaXMubWlueSkgLyByYW5nZXkpKSksXG4gICAgICAgICAgICAgICAgICAgIHNwb3RSYWRpdXMsIHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5nZXQoJ3Nwb3RDb2xvcicpKS5hcHBlbmQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLm1heHkgIT09IHRoaXMubWlueW9yZykge1xuICAgICAgICAgICAgICAgIGlmIChzcG90UmFkaXVzICYmIG9wdGlvbnMuZ2V0KCdtaW5TcG90Q29sb3InKSkge1xuICAgICAgICAgICAgICAgICAgICB4ID0geHZhbHVlc1skLmluQXJyYXkodGhpcy5taW55b3JnLCB5dmFsdWVzKV07XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldC5kcmF3Q2lyY2xlKGNhbnZhc0xlZnQgKyBNYXRoLnJvdW5kKCh4IC0gdGhpcy5taW54KSAqIChjYW52YXNXaWR0aCAvIHJhbmdleCkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzVG9wICsgTWF0aC5yb3VuZChjYW52YXNIZWlnaHQgLSAoY2FudmFzSGVpZ2h0ICogKCh0aGlzLm1pbnlvcmcgLSB0aGlzLm1pbnkpIC8gcmFuZ2V5KSkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3BvdFJhZGl1cywgdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5nZXQoJ21pblNwb3RDb2xvcicpKS5hcHBlbmQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHNwb3RSYWRpdXMgJiYgb3B0aW9ucy5nZXQoJ21heFNwb3RDb2xvcicpKSB7XG4gICAgICAgICAgICAgICAgICAgIHggPSB4dmFsdWVzWyQuaW5BcnJheSh0aGlzLm1heHlvcmcsIHl2YWx1ZXMpXTtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LmRyYXdDaXJjbGUoY2FudmFzTGVmdCArIE1hdGgucm91bmQoKHggLSB0aGlzLm1pbngpICogKGNhbnZhc1dpZHRoIC8gcmFuZ2V4KSksXG4gICAgICAgICAgICAgICAgICAgICAgICBjYW52YXNUb3AgKyBNYXRoLnJvdW5kKGNhbnZhc0hlaWdodCAtIChjYW52YXNIZWlnaHQgKiAoKHRoaXMubWF4eW9yZyAtIHRoaXMubWlueSkgLyByYW5nZXkpKSksXG4gICAgICAgICAgICAgICAgICAgICAgICBzcG90UmFkaXVzLCB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmdldCgnbWF4U3BvdENvbG9yJykpLmFwcGVuZCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5sYXN0U2hhcGVJZCA9IHRhcmdldC5nZXRMYXN0U2hhcGVJZCgpO1xuICAgICAgICAgICAgdGhpcy5jYW52YXNUb3AgPSBjYW52YXNUb3A7XG4gICAgICAgICAgICB0YXJnZXQucmVuZGVyKCk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIEJhciBjaGFydHNcbiAgICAgKi9cbiAgICAkLmZuLnNwYXJrbGluZS5iYXIgPSBiYXIgPSBjcmVhdGVDbGFzcygkLmZuLnNwYXJrbGluZS5fYmFzZSwgYmFySGlnaGxpZ2h0TWl4aW4sIHtcbiAgICAgICAgdHlwZTogJ2JhcicsXG5cbiAgICAgICAgaW5pdDogZnVuY3Rpb24gKGVsLCB2YWx1ZXMsIG9wdGlvbnMsIHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgICAgIHZhciBiYXJXaWR0aCA9IHBhcnNlSW50KG9wdGlvbnMuZ2V0KCdiYXJXaWR0aCcpLCAxMCksXG4gICAgICAgICAgICAgICAgYmFyU3BhY2luZyA9IHBhcnNlSW50KG9wdGlvbnMuZ2V0KCdiYXJTcGFjaW5nJyksIDEwKSxcbiAgICAgICAgICAgICAgICBjaGFydFJhbmdlTWluID0gb3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNaW4nKSxcbiAgICAgICAgICAgICAgICBjaGFydFJhbmdlTWF4ID0gb3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNYXgnKSxcbiAgICAgICAgICAgICAgICBjaGFydFJhbmdlQ2xpcCA9IG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlQ2xpcCcpLFxuICAgICAgICAgICAgICAgIHN0YWNrTWluID0gSW5maW5pdHksXG4gICAgICAgICAgICAgICAgc3RhY2tNYXggPSAtSW5maW5pdHksXG4gICAgICAgICAgICAgICAgaXNTdGFja1N0cmluZywgZ3JvdXBNaW4sIGdyb3VwTWF4LCBzdGFja1JhbmdlcyxcbiAgICAgICAgICAgICAgICBudW1WYWx1ZXMsIGksIHZsZW4sIHJhbmdlLCB6ZXJvQXhpcywgeGF4aXNPZmZzZXQsIG1pbiwgbWF4LCBjbGlwTWluLCBjbGlwTWF4LFxuICAgICAgICAgICAgICAgIHN0YWNrZWQsIHZsaXN0LCBqLCBzbGVuLCBzdmFscywgdmFsLCB5b2Zmc2V0LCB5TWF4Q2FsYywgY2FudmFzSGVpZ2h0RWY7XG4gICAgICAgICAgICBiYXIuX3N1cGVyLmluaXQuY2FsbCh0aGlzLCBlbCwgdmFsdWVzLCBvcHRpb25zLCB3aWR0aCwgaGVpZ2h0KTtcblxuICAgICAgICAgICAgLy8gc2NhbiB2YWx1ZXMgdG8gZGV0ZXJtaW5lIHdoZXRoZXIgdG8gc3RhY2sgYmFyc1xuICAgICAgICAgICAgZm9yIChpID0gMCwgdmxlbiA9IHZhbHVlcy5sZW5ndGg7IGkgPCB2bGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YWwgPSB2YWx1ZXNbaV07XG4gICAgICAgICAgICAgICAgaXNTdGFja1N0cmluZyA9IHR5cGVvZih2YWwpID09PSAnc3RyaW5nJyAmJiB2YWwuaW5kZXhPZignOicpID4gLTE7XG4gICAgICAgICAgICAgICAgaWYgKGlzU3RhY2tTdHJpbmcgfHwgJC5pc0FycmF5KHZhbCkpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhY2tlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpc1N0YWNrU3RyaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWwgPSB2YWx1ZXNbaV0gPSBub3JtYWxpemVWYWx1ZXModmFsLnNwbGl0KCc6JykpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhbCA9IHJlbW92ZSh2YWwsIG51bGwpOyAvLyBtaW4vbWF4IHdpbGwgdHJlYXQgbnVsbCBhcyB6ZXJvXG4gICAgICAgICAgICAgICAgICAgIGdyb3VwTWluID0gTWF0aC5taW4uYXBwbHkoTWF0aCwgdmFsKTtcbiAgICAgICAgICAgICAgICAgICAgZ3JvdXBNYXggPSBNYXRoLm1heC5hcHBseShNYXRoLCB2YWwpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZ3JvdXBNaW4gPCBzdGFja01pbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RhY2tNaW4gPSBncm91cE1pbjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoZ3JvdXBNYXggPiBzdGFja01heCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RhY2tNYXggPSBncm91cE1heDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5zdGFja2VkID0gc3RhY2tlZDtcbiAgICAgICAgICAgIHRoaXMucmVnaW9uU2hhcGVzID0ge307XG4gICAgICAgICAgICB0aGlzLmJhcldpZHRoID0gYmFyV2lkdGg7XG4gICAgICAgICAgICB0aGlzLmJhclNwYWNpbmcgPSBiYXJTcGFjaW5nO1xuICAgICAgICAgICAgdGhpcy50b3RhbEJhcldpZHRoID0gYmFyV2lkdGggKyBiYXJTcGFjaW5nO1xuICAgICAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoID0gKHZhbHVlcy5sZW5ndGggKiBiYXJXaWR0aCkgKyAoKHZhbHVlcy5sZW5ndGggLSAxKSAqIGJhclNwYWNpbmcpO1xuXG4gICAgICAgICAgICB0aGlzLmluaXRUYXJnZXQoKTtcblxuICAgICAgICAgICAgaWYgKGNoYXJ0UmFuZ2VDbGlwKSB7XG4gICAgICAgICAgICAgICAgY2xpcE1pbiA9IGNoYXJ0UmFuZ2VNaW4gPT09IHVuZGVmaW5lZCA/IC1JbmZpbml0eSA6IGNoYXJ0UmFuZ2VNaW47XG4gICAgICAgICAgICAgICAgY2xpcE1heCA9IGNoYXJ0UmFuZ2VNYXggPT09IHVuZGVmaW5lZCA/IEluZmluaXR5IDogY2hhcnRSYW5nZU1heDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbnVtVmFsdWVzID0gW107XG4gICAgICAgICAgICBzdGFja1JhbmdlcyA9IHN0YWNrZWQgPyBbXSA6IG51bVZhbHVlcztcbiAgICAgICAgICAgIHZhciBzdGFja1RvdGFscyA9IFtdO1xuICAgICAgICAgICAgdmFyIHN0YWNrUmFuZ2VzTmVnID0gW107XG4gICAgICAgICAgICBmb3IgKGkgPSAwLCB2bGVuID0gdmFsdWVzLmxlbmd0aDsgaSA8IHZsZW47IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChzdGFja2VkKSB7XG4gICAgICAgICAgICAgICAgICAgIHZsaXN0ID0gdmFsdWVzW2ldO1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZXNbaV0gPSBzdmFscyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBzdGFja1RvdGFsc1tpXSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIHN0YWNrUmFuZ2VzW2ldID0gc3RhY2tSYW5nZXNOZWdbaV0gPSAwO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGogPSAwLCBzbGVuID0gdmxpc3QubGVuZ3RoOyBqIDwgc2xlbjsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWwgPSBzdmFsc1tqXSA9IGNoYXJ0UmFuZ2VDbGlwID8gY2xpcHZhbCh2bGlzdFtqXSwgY2xpcE1pbiwgY2xpcE1heCkgOiB2bGlzdFtqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWwgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFja1RvdGFsc1tpXSArPSB2YWw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGFja01pbiA8IDAgJiYgc3RhY2tNYXggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWwgPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFja1Jhbmdlc05lZ1tpXSArPSBNYXRoLmFicyh2YWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhY2tSYW5nZXNbaV0gKz0gdmFsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhY2tSYW5nZXNbaV0gKz0gTWF0aC5hYnModmFsIC0gKHZhbCA8IDAgPyBzdGFja01heCA6IHN0YWNrTWluKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bVZhbHVlcy5wdXNoKHZhbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YWwgPSBjaGFydFJhbmdlQ2xpcCA/IGNsaXB2YWwodmFsdWVzW2ldLCBjbGlwTWluLCBjbGlwTWF4KSA6IHZhbHVlc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgdmFsID0gdmFsdWVzW2ldID0gbm9ybWFsaXplVmFsdWUodmFsKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbnVtVmFsdWVzLnB1c2godmFsKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubWF4ID0gbWF4ID0gTWF0aC5tYXguYXBwbHkoTWF0aCwgbnVtVmFsdWVzKTtcbiAgICAgICAgICAgIHRoaXMubWluID0gbWluID0gTWF0aC5taW4uYXBwbHkoTWF0aCwgbnVtVmFsdWVzKTtcbiAgICAgICAgICAgIHRoaXMuc3RhY2tNYXggPSBzdGFja01heCA9IHN0YWNrZWQgPyBNYXRoLm1heC5hcHBseShNYXRoLCBzdGFja1RvdGFscykgOiBtYXg7XG4gICAgICAgICAgICB0aGlzLnN0YWNrTWluID0gc3RhY2tNaW4gPSBzdGFja2VkID8gTWF0aC5taW4uYXBwbHkoTWF0aCwgbnVtVmFsdWVzKSA6IG1pbjtcblxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlTWluJykgIT09IHVuZGVmaW5lZCAmJiAob3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VDbGlwJykgfHwgb3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNaW4nKSA8IG1pbikpIHtcbiAgICAgICAgICAgICAgICBtaW4gPSBvcHRpb25zLmdldCgnY2hhcnRSYW5nZU1pbicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlTWF4JykgIT09IHVuZGVmaW5lZCAmJiAob3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VDbGlwJykgfHwgb3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNYXgnKSA+IG1heCkpIHtcbiAgICAgICAgICAgICAgICBtYXggPSBvcHRpb25zLmdldCgnY2hhcnRSYW5nZU1heCcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLnplcm9BeGlzID0gemVyb0F4aXMgPSBvcHRpb25zLmdldCgnemVyb0F4aXMnLCB0cnVlKTtcbiAgICAgICAgICAgIGlmIChtaW4gPD0gMCAmJiBtYXggPj0gMCAmJiB6ZXJvQXhpcykge1xuICAgICAgICAgICAgICAgIHhheGlzT2Zmc2V0ID0gMDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoemVyb0F4aXMgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICB4YXhpc09mZnNldCA9IG1pbjtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobWluID4gMCkge1xuICAgICAgICAgICAgICAgIHhheGlzT2Zmc2V0ID0gbWluO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB4YXhpc09mZnNldCA9IG1heDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMueGF4aXNPZmZzZXQgPSB4YXhpc09mZnNldDtcblxuICAgICAgICAgICAgcmFuZ2UgPSBzdGFja2VkID8gKE1hdGgubWF4LmFwcGx5KE1hdGgsIHN0YWNrUmFuZ2VzKSArIE1hdGgubWF4LmFwcGx5KE1hdGgsIHN0YWNrUmFuZ2VzTmVnKSkgOiBtYXggLSBtaW47XG5cbiAgICAgICAgICAgIC8vIGFzIHdlIHBsb3QgemVyby9taW4gdmFsdWVzIGEgc2luZ2xlIHBpeGVsIGxpbmUsIHdlIGFkZCBhIHBpeGVsIHRvIGFsbCBvdGhlclxuICAgICAgICAgICAgLy8gdmFsdWVzIC0gUmVkdWNlIHRoZSBlZmZlY3RpdmUgY2FudmFzIHNpemUgdG8gc3VpdFxuICAgICAgICAgICAgdGhpcy5jYW52YXNIZWlnaHRFZiA9ICh6ZXJvQXhpcyAmJiBtaW4gPCAwKSA/IHRoaXMuY2FudmFzSGVpZ2h0IC0gMiA6IHRoaXMuY2FudmFzSGVpZ2h0IC0gMTtcblxuICAgICAgICAgICAgaWYgKG1pbiA8IHhheGlzT2Zmc2V0KSB7XG4gICAgICAgICAgICAgICAgeU1heENhbGMgPSAoc3RhY2tlZCAmJiBtYXggPj0gMCkgPyBzdGFja01heCA6IG1heDtcbiAgICAgICAgICAgICAgICB5b2Zmc2V0ID0gKHlNYXhDYWxjIC0geGF4aXNPZmZzZXQpIC8gcmFuZ2UgKiB0aGlzLmNhbnZhc0hlaWdodDtcbiAgICAgICAgICAgICAgICBpZiAoeW9mZnNldCAhPT0gTWF0aC5jZWlsKHlvZmZzZXQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2FudmFzSGVpZ2h0RWYgLT0gMjtcbiAgICAgICAgICAgICAgICAgICAgeW9mZnNldCA9IE1hdGguY2VpbCh5b2Zmc2V0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHlvZmZzZXQgPSB0aGlzLmNhbnZhc0hlaWdodDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMueW9mZnNldCA9IHlvZmZzZXQ7XG5cbiAgICAgICAgICAgIGlmICgkLmlzQXJyYXkob3B0aW9ucy5nZXQoJ2NvbG9yTWFwJykpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jb2xvck1hcEJ5SW5kZXggPSBvcHRpb25zLmdldCgnY29sb3JNYXAnKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbG9yTWFwQnlWYWx1ZSA9IG51bGw7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuY29sb3JNYXBCeUluZGV4ID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbG9yTWFwQnlWYWx1ZSA9IG9wdGlvbnMuZ2V0KCdjb2xvck1hcCcpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbG9yTWFwQnlWYWx1ZSAmJiB0aGlzLmNvbG9yTWFwQnlWYWx1ZS5nZXQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbG9yTWFwQnlWYWx1ZSA9IG5ldyBSYW5nZU1hcCh0aGlzLmNvbG9yTWFwQnlWYWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLnJhbmdlID0gcmFuZ2U7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2V0UmVnaW9uOiBmdW5jdGlvbiAoZWwsIHgsIHkpIHtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBNYXRoLmZsb29yKHggLyB0aGlzLnRvdGFsQmFyV2lkdGgpO1xuICAgICAgICAgICAgcmV0dXJuIChyZXN1bHQgPCAwIHx8IHJlc3VsdCA+PSB0aGlzLnZhbHVlcy5sZW5ndGgpID8gdW5kZWZpbmVkIDogcmVzdWx0O1xuICAgICAgICB9LFxuXG4gICAgICAgIGdldEN1cnJlbnRSZWdpb25GaWVsZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBjdXJyZW50UmVnaW9uID0gdGhpcy5jdXJyZW50UmVnaW9uLFxuICAgICAgICAgICAgICAgIHZhbHVlcyA9IGVuc3VyZUFycmF5KHRoaXMudmFsdWVzW2N1cnJlbnRSZWdpb25dKSxcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBbXSxcbiAgICAgICAgICAgICAgICB2YWx1ZSwgaTtcbiAgICAgICAgICAgIGZvciAoaSA9IHZhbHVlcy5sZW5ndGg7IGktLTspIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlc1tpXTtcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIGlzTnVsbDogdmFsdWUgPT09IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiB2YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6IHRoaXMuY2FsY0NvbG9yKGksIHZhbHVlLCBjdXJyZW50UmVnaW9uKSxcbiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0OiBjdXJyZW50UmVnaW9uXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9LFxuXG4gICAgICAgIGNhbGNDb2xvcjogZnVuY3Rpb24gKHN0YWNrbnVtLCB2YWx1ZSwgdmFsdWVudW0pIHtcbiAgICAgICAgICAgIHZhciBjb2xvck1hcEJ5SW5kZXggPSB0aGlzLmNvbG9yTWFwQnlJbmRleCxcbiAgICAgICAgICAgICAgICBjb2xvck1hcEJ5VmFsdWUgPSB0aGlzLmNvbG9yTWFwQnlWYWx1ZSxcbiAgICAgICAgICAgICAgICBvcHRpb25zID0gdGhpcy5vcHRpb25zLFxuICAgICAgICAgICAgICAgIGNvbG9yLCBuZXdDb2xvcjtcbiAgICAgICAgICAgIGlmICh0aGlzLnN0YWNrZWQpIHtcbiAgICAgICAgICAgICAgICBjb2xvciA9IG9wdGlvbnMuZ2V0KCdzdGFja2VkQmFyQ29sb3InKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29sb3IgPSAodmFsdWUgPCAwKSA/IG9wdGlvbnMuZ2V0KCduZWdCYXJDb2xvcicpIDogb3B0aW9ucy5nZXQoJ2JhckNvbG9yJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodmFsdWUgPT09IDAgJiYgb3B0aW9ucy5nZXQoJ3plcm9Db2xvcicpICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBjb2xvciA9IG9wdGlvbnMuZ2V0KCd6ZXJvQ29sb3InKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjb2xvck1hcEJ5VmFsdWUgJiYgKG5ld0NvbG9yID0gY29sb3JNYXBCeVZhbHVlLmdldCh2YWx1ZSkpKSB7XG4gICAgICAgICAgICAgICAgY29sb3IgPSBuZXdDb2xvcjtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoY29sb3JNYXBCeUluZGV4ICYmIGNvbG9yTWFwQnlJbmRleC5sZW5ndGggPiB2YWx1ZW51bSkge1xuICAgICAgICAgICAgICAgIGNvbG9yID0gY29sb3JNYXBCeUluZGV4W3ZhbHVlbnVtXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAkLmlzQXJyYXkoY29sb3IpID8gY29sb3Jbc3RhY2tudW0gJSBjb2xvci5sZW5ndGhdIDogY29sb3I7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJlbmRlciBiYXIocykgZm9yIGEgcmVnaW9uXG4gICAgICAgICAqL1xuICAgICAgICByZW5kZXJSZWdpb246IGZ1bmN0aW9uICh2YWx1ZW51bSwgaGlnaGxpZ2h0KSB7XG4gICAgICAgICAgICB2YXIgdmFscyA9IHRoaXMudmFsdWVzW3ZhbHVlbnVtXSxcbiAgICAgICAgICAgICAgICBvcHRpb25zID0gdGhpcy5vcHRpb25zLFxuICAgICAgICAgICAgICAgIHhheGlzT2Zmc2V0ID0gdGhpcy54YXhpc09mZnNldCxcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBbXSxcbiAgICAgICAgICAgICAgICByYW5nZSA9IHRoaXMucmFuZ2UsXG4gICAgICAgICAgICAgICAgc3RhY2tlZCA9IHRoaXMuc3RhY2tlZCxcbiAgICAgICAgICAgICAgICB0YXJnZXQgPSB0aGlzLnRhcmdldCxcbiAgICAgICAgICAgICAgICB4ID0gdmFsdWVudW0gKiB0aGlzLnRvdGFsQmFyV2lkdGgsXG4gICAgICAgICAgICAgICAgY2FudmFzSGVpZ2h0RWYgPSB0aGlzLmNhbnZhc0hlaWdodEVmLFxuICAgICAgICAgICAgICAgIHlvZmZzZXQgPSB0aGlzLnlvZmZzZXQsXG4gICAgICAgICAgICAgICAgeSwgaGVpZ2h0LCBjb2xvciwgaXNOdWxsLCB5b2Zmc2V0TmVnLCBpLCB2YWxjb3VudCwgdmFsLCBtaW5QbG90dGVkLCBhbGxNaW47XG5cbiAgICAgICAgICAgIHZhbHMgPSAkLmlzQXJyYXkodmFscykgPyB2YWxzIDogW3ZhbHNdO1xuICAgICAgICAgICAgdmFsY291bnQgPSB2YWxzLmxlbmd0aDtcbiAgICAgICAgICAgIHZhbCA9IHZhbHNbMF07XG4gICAgICAgICAgICBpc051bGwgPSBhbGwobnVsbCwgdmFscyk7XG4gICAgICAgICAgICBhbGxNaW4gPSBhbGwoeGF4aXNPZmZzZXQsIHZhbHMsIHRydWUpO1xuXG4gICAgICAgICAgICBpZiAoaXNOdWxsKSB7XG4gICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuZ2V0KCdudWxsQ29sb3InKSkge1xuICAgICAgICAgICAgICAgICAgICBjb2xvciA9IGhpZ2hsaWdodCA/IG9wdGlvbnMuZ2V0KCdudWxsQ29sb3InKSA6IHRoaXMuY2FsY0hpZ2hsaWdodENvbG9yKG9wdGlvbnMuZ2V0KCdudWxsQ29sb3InKSwgb3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgIHkgPSAoeW9mZnNldCA+IDApID8geW9mZnNldCAtIDEgOiB5b2Zmc2V0O1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGFyZ2V0LmRyYXdSZWN0KHgsIHksIHRoaXMuYmFyV2lkdGggLSAxLCAwLCBjb2xvciwgY29sb3IpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgeW9mZnNldE5lZyA9IHlvZmZzZXQ7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgdmFsY291bnQ7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhbCA9IHZhbHNbaV07XG5cbiAgICAgICAgICAgICAgICBpZiAoc3RhY2tlZCAmJiB2YWwgPT09IHhheGlzT2Zmc2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghYWxsTWluIHx8IG1pblBsb3R0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIG1pblBsb3R0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChyYW5nZSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0ID0gTWF0aC5mbG9vcihjYW52YXNIZWlnaHRFZiAqICgoTWF0aC5hYnModmFsIC0geGF4aXNPZmZzZXQpIC8gcmFuZ2UpKSkgKyAxO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGhlaWdodCA9IDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh2YWwgPCB4YXhpc09mZnNldCB8fCAodmFsID09PSB4YXhpc09mZnNldCAmJiB5b2Zmc2V0ID09PSAwKSkge1xuICAgICAgICAgICAgICAgICAgICB5ID0geW9mZnNldE5lZztcbiAgICAgICAgICAgICAgICAgICAgeW9mZnNldE5lZyArPSBoZWlnaHQ7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgeSA9IHlvZmZzZXQgLSBoZWlnaHQ7XG4gICAgICAgICAgICAgICAgICAgIHlvZmZzZXQgLT0gaGVpZ2h0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb2xvciA9IHRoaXMuY2FsY0NvbG9yKGksIHZhbCwgdmFsdWVudW0pO1xuICAgICAgICAgICAgICAgIGlmIChoaWdobGlnaHQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29sb3IgPSB0aGlzLmNhbGNIaWdobGlnaHRDb2xvcihjb2xvciwgb3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHRhcmdldC5kcmF3UmVjdCh4LCB5LCB0aGlzLmJhcldpZHRoIC0gMSwgaGVpZ2h0IC0gMSwgY29sb3IsIGNvbG9yKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocmVzdWx0Lmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHRbMF07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBUcmlzdGF0ZSBjaGFydHNcbiAgICAgKi9cbiAgICAkLmZuLnNwYXJrbGluZS50cmlzdGF0ZSA9IHRyaXN0YXRlID0gY3JlYXRlQ2xhc3MoJC5mbi5zcGFya2xpbmUuX2Jhc2UsIGJhckhpZ2hsaWdodE1peGluLCB7XG4gICAgICAgIHR5cGU6ICd0cmlzdGF0ZScsXG5cbiAgICAgICAgaW5pdDogZnVuY3Rpb24gKGVsLCB2YWx1ZXMsIG9wdGlvbnMsIHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgICAgIHZhciBiYXJXaWR0aCA9IHBhcnNlSW50KG9wdGlvbnMuZ2V0KCdiYXJXaWR0aCcpLCAxMCksXG4gICAgICAgICAgICAgICAgYmFyU3BhY2luZyA9IHBhcnNlSW50KG9wdGlvbnMuZ2V0KCdiYXJTcGFjaW5nJyksIDEwKTtcbiAgICAgICAgICAgIHRyaXN0YXRlLl9zdXBlci5pbml0LmNhbGwodGhpcywgZWwsIHZhbHVlcywgb3B0aW9ucywgd2lkdGgsIGhlaWdodCk7XG5cbiAgICAgICAgICAgIHRoaXMucmVnaW9uU2hhcGVzID0ge307XG4gICAgICAgICAgICB0aGlzLmJhcldpZHRoID0gYmFyV2lkdGg7XG4gICAgICAgICAgICB0aGlzLmJhclNwYWNpbmcgPSBiYXJTcGFjaW5nO1xuICAgICAgICAgICAgdGhpcy50b3RhbEJhcldpZHRoID0gYmFyV2lkdGggKyBiYXJTcGFjaW5nO1xuICAgICAgICAgICAgdGhpcy52YWx1ZXMgPSAkLm1hcCh2YWx1ZXMsIE51bWJlcik7XG4gICAgICAgICAgICB0aGlzLndpZHRoID0gd2lkdGggPSAodmFsdWVzLmxlbmd0aCAqIGJhcldpZHRoKSArICgodmFsdWVzLmxlbmd0aCAtIDEpICogYmFyU3BhY2luZyk7XG5cbiAgICAgICAgICAgIGlmICgkLmlzQXJyYXkob3B0aW9ucy5nZXQoJ2NvbG9yTWFwJykpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jb2xvck1hcEJ5SW5kZXggPSBvcHRpb25zLmdldCgnY29sb3JNYXAnKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbG9yTWFwQnlWYWx1ZSA9IG51bGw7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuY29sb3JNYXBCeUluZGV4ID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbG9yTWFwQnlWYWx1ZSA9IG9wdGlvbnMuZ2V0KCdjb2xvck1hcCcpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbG9yTWFwQnlWYWx1ZSAmJiB0aGlzLmNvbG9yTWFwQnlWYWx1ZS5nZXQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbG9yTWFwQnlWYWx1ZSA9IG5ldyBSYW5nZU1hcCh0aGlzLmNvbG9yTWFwQnlWYWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5pbml0VGFyZ2V0KCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2V0UmVnaW9uOiBmdW5jdGlvbiAoZWwsIHgsIHkpIHtcbiAgICAgICAgICAgIHJldHVybiBNYXRoLmZsb29yKHggLyB0aGlzLnRvdGFsQmFyV2lkdGgpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGdldEN1cnJlbnRSZWdpb25GaWVsZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBjdXJyZW50UmVnaW9uID0gdGhpcy5jdXJyZW50UmVnaW9uO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBpc051bGw6IHRoaXMudmFsdWVzW2N1cnJlbnRSZWdpb25dID09PSB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMudmFsdWVzW2N1cnJlbnRSZWdpb25dLFxuICAgICAgICAgICAgICAgIGNvbG9yOiB0aGlzLmNhbGNDb2xvcih0aGlzLnZhbHVlc1tjdXJyZW50UmVnaW9uXSwgY3VycmVudFJlZ2lvbiksXG4gICAgICAgICAgICAgICAgb2Zmc2V0OiBjdXJyZW50UmVnaW9uXG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuXG4gICAgICAgIGNhbGNDb2xvcjogZnVuY3Rpb24gKHZhbHVlLCB2YWx1ZW51bSkge1xuICAgICAgICAgICAgdmFyIHZhbHVlcyA9IHRoaXMudmFsdWVzLFxuICAgICAgICAgICAgICAgIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnMsXG4gICAgICAgICAgICAgICAgY29sb3JNYXBCeUluZGV4ID0gdGhpcy5jb2xvck1hcEJ5SW5kZXgsXG4gICAgICAgICAgICAgICAgY29sb3JNYXBCeVZhbHVlID0gdGhpcy5jb2xvck1hcEJ5VmFsdWUsXG4gICAgICAgICAgICAgICAgY29sb3IsIG5ld0NvbG9yO1xuXG4gICAgICAgICAgICBpZiAoY29sb3JNYXBCeVZhbHVlICYmIChuZXdDb2xvciA9IGNvbG9yTWFwQnlWYWx1ZS5nZXQodmFsdWUpKSkge1xuICAgICAgICAgICAgICAgIGNvbG9yID0gbmV3Q29sb3I7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGNvbG9yTWFwQnlJbmRleCAmJiBjb2xvck1hcEJ5SW5kZXgubGVuZ3RoID4gdmFsdWVudW0pIHtcbiAgICAgICAgICAgICAgICBjb2xvciA9IGNvbG9yTWFwQnlJbmRleFt2YWx1ZW51bV07XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlc1t2YWx1ZW51bV0gPCAwKSB7XG4gICAgICAgICAgICAgICAgY29sb3IgPSBvcHRpb25zLmdldCgnbmVnQmFyQ29sb3InKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodmFsdWVzW3ZhbHVlbnVtXSA+IDApIHtcbiAgICAgICAgICAgICAgICBjb2xvciA9IG9wdGlvbnMuZ2V0KCdwb3NCYXJDb2xvcicpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb2xvciA9IG9wdGlvbnMuZ2V0KCd6ZXJvQmFyQ29sb3InKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjb2xvcjtcbiAgICAgICAgfSxcblxuICAgICAgICByZW5kZXJSZWdpb246IGZ1bmN0aW9uICh2YWx1ZW51bSwgaGlnaGxpZ2h0KSB7XG4gICAgICAgICAgICB2YXIgdmFsdWVzID0gdGhpcy52YWx1ZXMsXG4gICAgICAgICAgICAgICAgb3B0aW9ucyA9IHRoaXMub3B0aW9ucyxcbiAgICAgICAgICAgICAgICB0YXJnZXQgPSB0aGlzLnRhcmdldCxcbiAgICAgICAgICAgICAgICBjYW52YXNIZWlnaHQsIGhlaWdodCwgaGFsZkhlaWdodCxcbiAgICAgICAgICAgICAgICB4LCB5LCBjb2xvcjtcblxuICAgICAgICAgICAgY2FudmFzSGVpZ2h0ID0gdGFyZ2V0LnBpeGVsSGVpZ2h0O1xuICAgICAgICAgICAgaGFsZkhlaWdodCA9IE1hdGgucm91bmQoY2FudmFzSGVpZ2h0IC8gMik7XG5cbiAgICAgICAgICAgIHggPSB2YWx1ZW51bSAqIHRoaXMudG90YWxCYXJXaWR0aDtcbiAgICAgICAgICAgIGlmICh2YWx1ZXNbdmFsdWVudW1dIDwgMCkge1xuICAgICAgICAgICAgICAgIHkgPSBoYWxmSGVpZ2h0O1xuICAgICAgICAgICAgICAgIGhlaWdodCA9IGhhbGZIZWlnaHQgLSAxO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZXNbdmFsdWVudW1dID4gMCkge1xuICAgICAgICAgICAgICAgIHkgPSAwO1xuICAgICAgICAgICAgICAgIGhlaWdodCA9IGhhbGZIZWlnaHQgLSAxO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB5ID0gaGFsZkhlaWdodCAtIDE7XG4gICAgICAgICAgICAgICAgaGVpZ2h0ID0gMjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbG9yID0gdGhpcy5jYWxjQ29sb3IodmFsdWVzW3ZhbHVlbnVtXSwgdmFsdWVudW0pO1xuICAgICAgICAgICAgaWYgKGNvbG9yID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGhpZ2hsaWdodCkge1xuICAgICAgICAgICAgICAgIGNvbG9yID0gdGhpcy5jYWxjSGlnaGxpZ2h0Q29sb3IoY29sb3IsIG9wdGlvbnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRhcmdldC5kcmF3UmVjdCh4LCB5LCB0aGlzLmJhcldpZHRoIC0gMSwgaGVpZ2h0IC0gMSwgY29sb3IsIGNvbG9yKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogRGlzY3JldGUgY2hhcnRzXG4gICAgICovXG4gICAgJC5mbi5zcGFya2xpbmUuZGlzY3JldGUgPSBkaXNjcmV0ZSA9IGNyZWF0ZUNsYXNzKCQuZm4uc3BhcmtsaW5lLl9iYXNlLCBiYXJIaWdobGlnaHRNaXhpbiwge1xuICAgICAgICB0eXBlOiAnZGlzY3JldGUnLFxuXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uIChlbCwgdmFsdWVzLCBvcHRpb25zLCB3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICAgICAgICBkaXNjcmV0ZS5fc3VwZXIuaW5pdC5jYWxsKHRoaXMsIGVsLCB2YWx1ZXMsIG9wdGlvbnMsIHdpZHRoLCBoZWlnaHQpO1xuXG4gICAgICAgICAgICB0aGlzLnJlZ2lvblNoYXBlcyA9IHt9O1xuICAgICAgICAgICAgdGhpcy52YWx1ZXMgPSB2YWx1ZXMgPSAkLm1hcCh2YWx1ZXMsIE51bWJlcik7XG4gICAgICAgICAgICB0aGlzLm1pbiA9IE1hdGgubWluLmFwcGx5KE1hdGgsIHZhbHVlcyk7XG4gICAgICAgICAgICB0aGlzLm1heCA9IE1hdGgubWF4LmFwcGx5KE1hdGgsIHZhbHVlcyk7XG4gICAgICAgICAgICB0aGlzLnJhbmdlID0gdGhpcy5tYXggLSB0aGlzLm1pbjtcbiAgICAgICAgICAgIHRoaXMud2lkdGggPSB3aWR0aCA9IG9wdGlvbnMuZ2V0KCd3aWR0aCcpID09PSAnYXV0bycgPyB2YWx1ZXMubGVuZ3RoICogMiA6IHRoaXMud2lkdGg7XG4gICAgICAgICAgICB0aGlzLmludGVydmFsID0gTWF0aC5mbG9vcih3aWR0aCAvIHZhbHVlcy5sZW5ndGgpO1xuICAgICAgICAgICAgdGhpcy5pdGVtV2lkdGggPSB3aWR0aCAvIHZhbHVlcy5sZW5ndGg7XG4gICAgICAgICAgICBpZiAob3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNaW4nKSAhPT0gdW5kZWZpbmVkICYmIChvcHRpb25zLmdldCgnY2hhcnRSYW5nZUNsaXAnKSB8fCBvcHRpb25zLmdldCgnY2hhcnRSYW5nZU1pbicpIDwgdGhpcy5taW4pKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5taW4gPSBvcHRpb25zLmdldCgnY2hhcnRSYW5nZU1pbicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlTWF4JykgIT09IHVuZGVmaW5lZCAmJiAob3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VDbGlwJykgfHwgb3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNYXgnKSA+IHRoaXMubWF4KSkge1xuICAgICAgICAgICAgICAgIHRoaXMubWF4ID0gb3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNYXgnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuaW5pdFRhcmdldCgpO1xuICAgICAgICAgICAgaWYgKHRoaXMudGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5saW5lSGVpZ2h0ID0gb3B0aW9ucy5nZXQoJ2xpbmVIZWlnaHQnKSA9PT0gJ2F1dG8nID8gTWF0aC5yb3VuZCh0aGlzLmNhbnZhc0hlaWdodCAqIDAuMykgOiBvcHRpb25zLmdldCgnbGluZUhlaWdodCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIGdldFJlZ2lvbjogZnVuY3Rpb24gKGVsLCB4LCB5KSB7XG4gICAgICAgICAgICByZXR1cm4gTWF0aC5mbG9vcih4IC8gdGhpcy5pdGVtV2lkdGgpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGdldEN1cnJlbnRSZWdpb25GaWVsZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBjdXJyZW50UmVnaW9uID0gdGhpcy5jdXJyZW50UmVnaW9uO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBpc051bGw6IHRoaXMudmFsdWVzW2N1cnJlbnRSZWdpb25dID09PSB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMudmFsdWVzW2N1cnJlbnRSZWdpb25dLFxuICAgICAgICAgICAgICAgIG9mZnNldDogY3VycmVudFJlZ2lvblxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSxcblxuICAgICAgICByZW5kZXJSZWdpb246IGZ1bmN0aW9uICh2YWx1ZW51bSwgaGlnaGxpZ2h0KSB7XG4gICAgICAgICAgICB2YXIgdmFsdWVzID0gdGhpcy52YWx1ZXMsXG4gICAgICAgICAgICAgICAgb3B0aW9ucyA9IHRoaXMub3B0aW9ucyxcbiAgICAgICAgICAgICAgICBtaW4gPSB0aGlzLm1pbixcbiAgICAgICAgICAgICAgICBtYXggPSB0aGlzLm1heCxcbiAgICAgICAgICAgICAgICByYW5nZSA9IHRoaXMucmFuZ2UsXG4gICAgICAgICAgICAgICAgaW50ZXJ2YWwgPSB0aGlzLmludGVydmFsLFxuICAgICAgICAgICAgICAgIHRhcmdldCA9IHRoaXMudGFyZ2V0LFxuICAgICAgICAgICAgICAgIGNhbnZhc0hlaWdodCA9IHRoaXMuY2FudmFzSGVpZ2h0LFxuICAgICAgICAgICAgICAgIGxpbmVIZWlnaHQgPSB0aGlzLmxpbmVIZWlnaHQsXG4gICAgICAgICAgICAgICAgcGhlaWdodCA9IGNhbnZhc0hlaWdodCAtIGxpbmVIZWlnaHQsXG4gICAgICAgICAgICAgICAgeXRvcCwgdmFsLCBjb2xvciwgeDtcblxuICAgICAgICAgICAgdmFsID0gY2xpcHZhbCh2YWx1ZXNbdmFsdWVudW1dLCBtaW4sIG1heCk7XG4gICAgICAgICAgICB4ID0gdmFsdWVudW0gKiBpbnRlcnZhbDtcbiAgICAgICAgICAgIHl0b3AgPSBNYXRoLnJvdW5kKHBoZWlnaHQgLSBwaGVpZ2h0ICogKCh2YWwgLSBtaW4pIC8gcmFuZ2UpKTtcbiAgICAgICAgICAgIGNvbG9yID0gKG9wdGlvbnMuZ2V0KCd0aHJlc2hvbGRDb2xvcicpICYmIHZhbCA8IG9wdGlvbnMuZ2V0KCd0aHJlc2hvbGRWYWx1ZScpKSA/IG9wdGlvbnMuZ2V0KCd0aHJlc2hvbGRDb2xvcicpIDogb3B0aW9ucy5nZXQoJ2xpbmVDb2xvcicpO1xuICAgICAgICAgICAgaWYgKGhpZ2hsaWdodCkge1xuICAgICAgICAgICAgICAgIGNvbG9yID0gdGhpcy5jYWxjSGlnaGxpZ2h0Q29sb3IoY29sb3IsIG9wdGlvbnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRhcmdldC5kcmF3TGluZSh4LCB5dG9wLCB4LCB5dG9wICsgbGluZUhlaWdodCwgY29sb3IpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBCdWxsZXQgY2hhcnRzXG4gICAgICovXG4gICAgJC5mbi5zcGFya2xpbmUuYnVsbGV0ID0gYnVsbGV0ID0gY3JlYXRlQ2xhc3MoJC5mbi5zcGFya2xpbmUuX2Jhc2UsIHtcbiAgICAgICAgdHlwZTogJ2J1bGxldCcsXG5cbiAgICAgICAgaW5pdDogZnVuY3Rpb24gKGVsLCB2YWx1ZXMsIG9wdGlvbnMsIHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgICAgIHZhciBtaW4sIG1heCwgdmFscztcbiAgICAgICAgICAgIGJ1bGxldC5fc3VwZXIuaW5pdC5jYWxsKHRoaXMsIGVsLCB2YWx1ZXMsIG9wdGlvbnMsIHdpZHRoLCBoZWlnaHQpO1xuXG4gICAgICAgICAgICAvLyB2YWx1ZXM6IHRhcmdldCwgcGVyZm9ybWFuY2UsIHJhbmdlMSwgcmFuZ2UyLCByYW5nZTNcbiAgICAgICAgICAgIHRoaXMudmFsdWVzID0gdmFsdWVzID0gbm9ybWFsaXplVmFsdWVzKHZhbHVlcyk7XG4gICAgICAgICAgICAvLyB0YXJnZXQgb3IgcGVyZm9ybWFuY2UgY291bGQgYmUgbnVsbFxuICAgICAgICAgICAgdmFscyA9IHZhbHVlcy5zbGljZSgpO1xuICAgICAgICAgICAgdmFsc1swXSA9IHZhbHNbMF0gPT09IG51bGwgPyB2YWxzWzJdIDogdmFsc1swXTtcbiAgICAgICAgICAgIHZhbHNbMV0gPSB2YWx1ZXNbMV0gPT09IG51bGwgPyB2YWxzWzJdIDogdmFsc1sxXTtcbiAgICAgICAgICAgIG1pbiA9IE1hdGgubWluLmFwcGx5KE1hdGgsIHZhbHVlcyk7XG4gICAgICAgICAgICBtYXggPSBNYXRoLm1heC5hcHBseShNYXRoLCB2YWx1ZXMpO1xuICAgICAgICAgICAgaWYgKG9wdGlvbnMuZ2V0KCdiYXNlJykgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIG1pbiA9IG1pbiA8IDAgPyBtaW4gOiAwO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBtaW4gPSBvcHRpb25zLmdldCgnYmFzZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5taW4gPSBtaW47XG4gICAgICAgICAgICB0aGlzLm1heCA9IG1heDtcbiAgICAgICAgICAgIHRoaXMucmFuZ2UgPSBtYXggLSBtaW47XG4gICAgICAgICAgICB0aGlzLnNoYXBlcyA9IHt9O1xuICAgICAgICAgICAgdGhpcy52YWx1ZVNoYXBlcyA9IHt9O1xuICAgICAgICAgICAgdGhpcy5yZWdpb25kYXRhID0ge307XG4gICAgICAgICAgICB0aGlzLndpZHRoID0gd2lkdGggPSBvcHRpb25zLmdldCgnd2lkdGgnKSA9PT0gJ2F1dG8nID8gJzQuMGVtJyA6IHdpZHRoO1xuICAgICAgICAgICAgdGhpcy50YXJnZXQgPSB0aGlzLiRlbC5zaW1wbGVkcmF3KHdpZHRoLCBoZWlnaHQsIG9wdGlvbnMuZ2V0KCdjb21wb3NpdGUnKSk7XG4gICAgICAgICAgICBpZiAoIXZhbHVlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuaW5pdFRhcmdldCgpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGdldFJlZ2lvbjogZnVuY3Rpb24gKGVsLCB4LCB5KSB7XG4gICAgICAgICAgICB2YXIgc2hhcGVpZCA9IHRoaXMudGFyZ2V0LmdldFNoYXBlQXQoZWwsIHgsIHkpO1xuICAgICAgICAgICAgcmV0dXJuIChzaGFwZWlkICE9PSB1bmRlZmluZWQgJiYgdGhpcy5zaGFwZXNbc2hhcGVpZF0gIT09IHVuZGVmaW5lZCkgPyB0aGlzLnNoYXBlc1tzaGFwZWlkXSA6IHVuZGVmaW5lZDtcbiAgICAgICAgfSxcblxuICAgICAgICBnZXRDdXJyZW50UmVnaW9uRmllbGRzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgY3VycmVudFJlZ2lvbiA9IHRoaXMuY3VycmVudFJlZ2lvbjtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZmllbGRrZXk6IGN1cnJlbnRSZWdpb24uc3Vic3RyKDAsIDEpLFxuICAgICAgICAgICAgICAgIHZhbHVlOiB0aGlzLnZhbHVlc1tjdXJyZW50UmVnaW9uLnN1YnN0cigxKV0sXG4gICAgICAgICAgICAgICAgcmVnaW9uOiBjdXJyZW50UmVnaW9uXG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuXG4gICAgICAgIGNoYW5nZUhpZ2hsaWdodDogZnVuY3Rpb24gKGhpZ2hsaWdodCkge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRSZWdpb24gPSB0aGlzLmN1cnJlbnRSZWdpb24sXG4gICAgICAgICAgICAgICAgc2hhcGVpZCA9IHRoaXMudmFsdWVTaGFwZXNbY3VycmVudFJlZ2lvbl0sXG4gICAgICAgICAgICAgICAgc2hhcGU7XG4gICAgICAgICAgICBkZWxldGUgdGhpcy5zaGFwZXNbc2hhcGVpZF07XG4gICAgICAgICAgICBzd2l0Y2ggKGN1cnJlbnRSZWdpb24uc3Vic3RyKDAsIDEpKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAncic6XG4gICAgICAgICAgICAgICAgICAgIHNoYXBlID0gdGhpcy5yZW5kZXJSYW5nZShjdXJyZW50UmVnaW9uLnN1YnN0cigxKSwgaGlnaGxpZ2h0KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAncCc6XG4gICAgICAgICAgICAgICAgICAgIHNoYXBlID0gdGhpcy5yZW5kZXJQZXJmb3JtYW5jZShoaWdobGlnaHQpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICd0JzpcbiAgICAgICAgICAgICAgICAgICAgc2hhcGUgPSB0aGlzLnJlbmRlclRhcmdldChoaWdobGlnaHQpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMudmFsdWVTaGFwZXNbY3VycmVudFJlZ2lvbl0gPSBzaGFwZS5pZDtcbiAgICAgICAgICAgIHRoaXMuc2hhcGVzW3NoYXBlLmlkXSA9IGN1cnJlbnRSZWdpb247XG4gICAgICAgICAgICB0aGlzLnRhcmdldC5yZXBsYWNlV2l0aFNoYXBlKHNoYXBlaWQsIHNoYXBlKTtcbiAgICAgICAgfSxcblxuICAgICAgICByZW5kZXJSYW5nZTogZnVuY3Rpb24gKHJuLCBoaWdobGlnaHQpIHtcbiAgICAgICAgICAgIHZhciByYW5nZXZhbCA9IHRoaXMudmFsdWVzW3JuXSxcbiAgICAgICAgICAgICAgICByYW5nZXdpZHRoID0gTWF0aC5yb3VuZCh0aGlzLmNhbnZhc1dpZHRoICogKChyYW5nZXZhbCAtIHRoaXMubWluKSAvIHRoaXMucmFuZ2UpKSxcbiAgICAgICAgICAgICAgICBjb2xvciA9IHRoaXMub3B0aW9ucy5nZXQoJ3JhbmdlQ29sb3JzJylbcm4gLSAyXTtcbiAgICAgICAgICAgIGlmIChoaWdobGlnaHQpIHtcbiAgICAgICAgICAgICAgICBjb2xvciA9IHRoaXMuY2FsY0hpZ2hsaWdodENvbG9yKGNvbG9yLCB0aGlzLm9wdGlvbnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMudGFyZ2V0LmRyYXdSZWN0KDAsIDAsIHJhbmdld2lkdGggLSAxLCB0aGlzLmNhbnZhc0hlaWdodCAtIDEsIGNvbG9yLCBjb2xvcik7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVuZGVyUGVyZm9ybWFuY2U6IGZ1bmN0aW9uIChoaWdobGlnaHQpIHtcbiAgICAgICAgICAgIHZhciBwZXJmdmFsID0gdGhpcy52YWx1ZXNbMV0sXG4gICAgICAgICAgICAgICAgcGVyZndpZHRoID0gTWF0aC5yb3VuZCh0aGlzLmNhbnZhc1dpZHRoICogKChwZXJmdmFsIC0gdGhpcy5taW4pIC8gdGhpcy5yYW5nZSkpLFxuICAgICAgICAgICAgICAgIGNvbG9yID0gdGhpcy5vcHRpb25zLmdldCgncGVyZm9ybWFuY2VDb2xvcicpO1xuICAgICAgICAgICAgaWYgKGhpZ2hsaWdodCkge1xuICAgICAgICAgICAgICAgIGNvbG9yID0gdGhpcy5jYWxjSGlnaGxpZ2h0Q29sb3IoY29sb3IsIHRoaXMub3B0aW9ucyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy50YXJnZXQuZHJhd1JlY3QoMCwgTWF0aC5yb3VuZCh0aGlzLmNhbnZhc0hlaWdodCAqIDAuMyksIHBlcmZ3aWR0aCAtIDEsXG4gICAgICAgICAgICAgICAgTWF0aC5yb3VuZCh0aGlzLmNhbnZhc0hlaWdodCAqIDAuNCkgLSAxLCBjb2xvciwgY29sb3IpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlbmRlclRhcmdldDogZnVuY3Rpb24gKGhpZ2hsaWdodCkge1xuICAgICAgICAgICAgdmFyIHRhcmdldHZhbCA9IHRoaXMudmFsdWVzWzBdLFxuICAgICAgICAgICAgICAgIHggPSBNYXRoLnJvdW5kKHRoaXMuY2FudmFzV2lkdGggKiAoKHRhcmdldHZhbCAtIHRoaXMubWluKSAvIHRoaXMucmFuZ2UpIC0gKHRoaXMub3B0aW9ucy5nZXQoJ3RhcmdldFdpZHRoJykgLyAyKSksXG4gICAgICAgICAgICAgICAgdGFyZ2V0dG9wID0gTWF0aC5yb3VuZCh0aGlzLmNhbnZhc0hlaWdodCAqIDAuMTApLFxuICAgICAgICAgICAgICAgIHRhcmdldGhlaWdodCA9IHRoaXMuY2FudmFzSGVpZ2h0IC0gKHRhcmdldHRvcCAqIDIpLFxuICAgICAgICAgICAgICAgIGNvbG9yID0gdGhpcy5vcHRpb25zLmdldCgndGFyZ2V0Q29sb3InKTtcbiAgICAgICAgICAgIGlmIChoaWdobGlnaHQpIHtcbiAgICAgICAgICAgICAgICBjb2xvciA9IHRoaXMuY2FsY0hpZ2hsaWdodENvbG9yKGNvbG9yLCB0aGlzLm9wdGlvbnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMudGFyZ2V0LmRyYXdSZWN0KHgsIHRhcmdldHRvcCwgdGhpcy5vcHRpb25zLmdldCgndGFyZ2V0V2lkdGgnKSAtIDEsIHRhcmdldGhlaWdodCAtIDEsIGNvbG9yLCBjb2xvcik7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdmxlbiA9IHRoaXMudmFsdWVzLmxlbmd0aCxcbiAgICAgICAgICAgICAgICB0YXJnZXQgPSB0aGlzLnRhcmdldCxcbiAgICAgICAgICAgICAgICBpLCBzaGFwZTtcbiAgICAgICAgICAgIGlmICghYnVsbGV0Ll9zdXBlci5yZW5kZXIuY2FsbCh0aGlzKSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAoaSA9IDI7IGkgPCB2bGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgICBzaGFwZSA9IHRoaXMucmVuZGVyUmFuZ2UoaSkuYXBwZW5kKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zaGFwZXNbc2hhcGUuaWRdID0gJ3InICsgaTtcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlU2hhcGVzWydyJyArIGldID0gc2hhcGUuaWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy52YWx1ZXNbMV0gIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBzaGFwZSA9IHRoaXMucmVuZGVyUGVyZm9ybWFuY2UoKS5hcHBlbmQoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNoYXBlc1tzaGFwZS5pZF0gPSAncDEnO1xuICAgICAgICAgICAgICAgIHRoaXMudmFsdWVTaGFwZXMucDEgPSBzaGFwZS5pZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnZhbHVlc1swXSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHNoYXBlID0gdGhpcy5yZW5kZXJUYXJnZXQoKS5hcHBlbmQoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNoYXBlc1tzaGFwZS5pZF0gPSAndDAnO1xuICAgICAgICAgICAgICAgIHRoaXMudmFsdWVTaGFwZXMudDAgPSBzaGFwZS5pZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRhcmdldC5yZW5kZXIoKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUGllIGNoYXJ0c1xuICAgICAqL1xuICAgICQuZm4uc3BhcmtsaW5lLnBpZSA9IHBpZSA9IGNyZWF0ZUNsYXNzKCQuZm4uc3BhcmtsaW5lLl9iYXNlLCB7XG4gICAgICAgIHR5cGU6ICdwaWUnLFxuXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uIChlbCwgdmFsdWVzLCBvcHRpb25zLCB3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICAgICAgICB2YXIgdG90YWwgPSAwLCBpO1xuXG4gICAgICAgICAgICBwaWUuX3N1cGVyLmluaXQuY2FsbCh0aGlzLCBlbCwgdmFsdWVzLCBvcHRpb25zLCB3aWR0aCwgaGVpZ2h0KTtcblxuICAgICAgICAgICAgdGhpcy5zaGFwZXMgPSB7fTsgLy8gbWFwIHNoYXBlIGlkcyB0byB2YWx1ZSBvZmZzZXRzXG4gICAgICAgICAgICB0aGlzLnZhbHVlU2hhcGVzID0ge307IC8vIG1hcHMgdmFsdWUgb2Zmc2V0cyB0byBzaGFwZSBpZHNcbiAgICAgICAgICAgIHRoaXMudmFsdWVzID0gdmFsdWVzID0gJC5tYXAodmFsdWVzLCBOdW1iZXIpO1xuXG4gICAgICAgICAgICBpZiAob3B0aW9ucy5nZXQoJ3dpZHRoJykgPT09ICdhdXRvJykge1xuICAgICAgICAgICAgICAgIHRoaXMud2lkdGggPSB0aGlzLmhlaWdodDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHZhbHVlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgZm9yIChpID0gdmFsdWVzLmxlbmd0aDsgaS0tOykge1xuICAgICAgICAgICAgICAgICAgICB0b3RhbCArPSB2YWx1ZXNbaV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy50b3RhbCA9IHRvdGFsO1xuICAgICAgICAgICAgdGhpcy5pbml0VGFyZ2V0KCk7XG4gICAgICAgICAgICB0aGlzLnJhZGl1cyA9IE1hdGguZmxvb3IoTWF0aC5taW4odGhpcy5jYW52YXNXaWR0aCwgdGhpcy5jYW52YXNIZWlnaHQpIC8gMik7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2V0UmVnaW9uOiBmdW5jdGlvbiAoZWwsIHgsIHkpIHtcbiAgICAgICAgICAgIHZhciBzaGFwZWlkID0gdGhpcy50YXJnZXQuZ2V0U2hhcGVBdChlbCwgeCwgeSk7XG4gICAgICAgICAgICByZXR1cm4gKHNoYXBlaWQgIT09IHVuZGVmaW5lZCAmJiB0aGlzLnNoYXBlc1tzaGFwZWlkXSAhPT0gdW5kZWZpbmVkKSA/IHRoaXMuc2hhcGVzW3NoYXBlaWRdIDogdW5kZWZpbmVkO1xuICAgICAgICB9LFxuXG4gICAgICAgIGdldEN1cnJlbnRSZWdpb25GaWVsZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBjdXJyZW50UmVnaW9uID0gdGhpcy5jdXJyZW50UmVnaW9uO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBpc051bGw6IHRoaXMudmFsdWVzW2N1cnJlbnRSZWdpb25dID09PSB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMudmFsdWVzW2N1cnJlbnRSZWdpb25dLFxuICAgICAgICAgICAgICAgIHBlcmNlbnQ6IHRoaXMudmFsdWVzW2N1cnJlbnRSZWdpb25dIC8gdGhpcy50b3RhbCAqIDEwMCxcbiAgICAgICAgICAgICAgICBjb2xvcjogdGhpcy5vcHRpb25zLmdldCgnc2xpY2VDb2xvcnMnKVtjdXJyZW50UmVnaW9uICUgdGhpcy5vcHRpb25zLmdldCgnc2xpY2VDb2xvcnMnKS5sZW5ndGhdLFxuICAgICAgICAgICAgICAgIG9mZnNldDogY3VycmVudFJlZ2lvblxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSxcblxuICAgICAgICBjaGFuZ2VIaWdobGlnaHQ6IGZ1bmN0aW9uIChoaWdobGlnaHQpIHtcbiAgICAgICAgICAgIHZhciBjdXJyZW50UmVnaW9uID0gdGhpcy5jdXJyZW50UmVnaW9uLFxuICAgICAgICAgICAgICAgICBuZXdzbGljZSA9IHRoaXMucmVuZGVyU2xpY2UoY3VycmVudFJlZ2lvbiwgaGlnaGxpZ2h0KSxcbiAgICAgICAgICAgICAgICAgc2hhcGVpZCA9IHRoaXMudmFsdWVTaGFwZXNbY3VycmVudFJlZ2lvbl07XG4gICAgICAgICAgICBkZWxldGUgdGhpcy5zaGFwZXNbc2hhcGVpZF07XG4gICAgICAgICAgICB0aGlzLnRhcmdldC5yZXBsYWNlV2l0aFNoYXBlKHNoYXBlaWQsIG5ld3NsaWNlKTtcbiAgICAgICAgICAgIHRoaXMudmFsdWVTaGFwZXNbY3VycmVudFJlZ2lvbl0gPSBuZXdzbGljZS5pZDtcbiAgICAgICAgICAgIHRoaXMuc2hhcGVzW25ld3NsaWNlLmlkXSA9IGN1cnJlbnRSZWdpb247XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVuZGVyU2xpY2U6IGZ1bmN0aW9uICh2YWx1ZW51bSwgaGlnaGxpZ2h0KSB7XG4gICAgICAgICAgICB2YXIgdGFyZ2V0ID0gdGhpcy50YXJnZXQsXG4gICAgICAgICAgICAgICAgb3B0aW9ucyA9IHRoaXMub3B0aW9ucyxcbiAgICAgICAgICAgICAgICByYWRpdXMgPSB0aGlzLnJhZGl1cyxcbiAgICAgICAgICAgICAgICBib3JkZXJXaWR0aCA9IG9wdGlvbnMuZ2V0KCdib3JkZXJXaWR0aCcpLFxuICAgICAgICAgICAgICAgIG9mZnNldCA9IG9wdGlvbnMuZ2V0KCdvZmZzZXQnKSxcbiAgICAgICAgICAgICAgICBjaXJjbGUgPSAyICogTWF0aC5QSSxcbiAgICAgICAgICAgICAgICB2YWx1ZXMgPSB0aGlzLnZhbHVlcyxcbiAgICAgICAgICAgICAgICB0b3RhbCA9IHRoaXMudG90YWwsXG4gICAgICAgICAgICAgICAgbmV4dCA9IG9mZnNldCA/ICgyKk1hdGguUEkpKihvZmZzZXQvMzYwKSA6IDAsXG4gICAgICAgICAgICAgICAgc3RhcnQsIGVuZCwgaSwgdmxlbiwgY29sb3I7XG5cbiAgICAgICAgICAgIHZsZW4gPSB2YWx1ZXMubGVuZ3RoO1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHZsZW47IGkrKykge1xuICAgICAgICAgICAgICAgIHN0YXJ0ID0gbmV4dDtcbiAgICAgICAgICAgICAgICBlbmQgPSBuZXh0O1xuICAgICAgICAgICAgICAgIGlmICh0b3RhbCA+IDApIHsgIC8vIGF2b2lkIGRpdmlkZSBieSB6ZXJvXG4gICAgICAgICAgICAgICAgICAgIGVuZCA9IG5leHQgKyAoY2lyY2xlICogKHZhbHVlc1tpXSAvIHRvdGFsKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZW51bSA9PT0gaSkge1xuICAgICAgICAgICAgICAgICAgICBjb2xvciA9IG9wdGlvbnMuZ2V0KCdzbGljZUNvbG9ycycpW2kgJSBvcHRpb25zLmdldCgnc2xpY2VDb2xvcnMnKS5sZW5ndGhdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaGlnaGxpZ2h0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xvciA9IHRoaXMuY2FsY0hpZ2hsaWdodENvbG9yKGNvbG9yLCBvcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXQuZHJhd1BpZVNsaWNlKHJhZGl1cywgcmFkaXVzLCByYWRpdXMgLSBib3JkZXJXaWR0aCwgc3RhcnQsIGVuZCwgdW5kZWZpbmVkLCBjb2xvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG5leHQgPSBlbmQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdGFyZ2V0ID0gdGhpcy50YXJnZXQsXG4gICAgICAgICAgICAgICAgdmFsdWVzID0gdGhpcy52YWx1ZXMsXG4gICAgICAgICAgICAgICAgb3B0aW9ucyA9IHRoaXMub3B0aW9ucyxcbiAgICAgICAgICAgICAgICByYWRpdXMgPSB0aGlzLnJhZGl1cyxcbiAgICAgICAgICAgICAgICBib3JkZXJXaWR0aCA9IG9wdGlvbnMuZ2V0KCdib3JkZXJXaWR0aCcpLFxuICAgICAgICAgICAgICAgIHNoYXBlLCBpO1xuXG4gICAgICAgICAgICBpZiAoIXBpZS5fc3VwZXIucmVuZGVyLmNhbGwodGhpcykpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYm9yZGVyV2lkdGgpIHtcbiAgICAgICAgICAgICAgICB0YXJnZXQuZHJhd0NpcmNsZShyYWRpdXMsIHJhZGl1cywgTWF0aC5mbG9vcihyYWRpdXMgLSAoYm9yZGVyV2lkdGggLyAyKSksXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZ2V0KCdib3JkZXJDb2xvcicpLCB1bmRlZmluZWQsIGJvcmRlcldpZHRoKS5hcHBlbmQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAoaSA9IHZhbHVlcy5sZW5ndGg7IGktLTspIHtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWVzW2ldKSB7IC8vIGRvbid0IHJlbmRlciB6ZXJvIHZhbHVlc1xuICAgICAgICAgICAgICAgICAgICBzaGFwZSA9IHRoaXMucmVuZGVyU2xpY2UoaSkuYXBwZW5kKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmFsdWVTaGFwZXNbaV0gPSBzaGFwZS5pZDsgLy8gc3RvcmUganVzdCB0aGUgc2hhcGVpZFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNoYXBlc1tzaGFwZS5pZF0gPSBpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRhcmdldC5yZW5kZXIoKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQm94IHBsb3RzXG4gICAgICovXG4gICAgJC5mbi5zcGFya2xpbmUuYm94ID0gYm94ID0gY3JlYXRlQ2xhc3MoJC5mbi5zcGFya2xpbmUuX2Jhc2UsIHtcbiAgICAgICAgdHlwZTogJ2JveCcsXG5cbiAgICAgICAgaW5pdDogZnVuY3Rpb24gKGVsLCB2YWx1ZXMsIG9wdGlvbnMsIHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgICAgIGJveC5fc3VwZXIuaW5pdC5jYWxsKHRoaXMsIGVsLCB2YWx1ZXMsIG9wdGlvbnMsIHdpZHRoLCBoZWlnaHQpO1xuICAgICAgICAgICAgdGhpcy52YWx1ZXMgPSAkLm1hcCh2YWx1ZXMsIE51bWJlcik7XG4gICAgICAgICAgICB0aGlzLndpZHRoID0gb3B0aW9ucy5nZXQoJ3dpZHRoJykgPT09ICdhdXRvJyA/ICc0LjBlbScgOiB3aWR0aDtcbiAgICAgICAgICAgIHRoaXMuaW5pdFRhcmdldCgpO1xuICAgICAgICAgICAgaWYgKCF0aGlzLnZhbHVlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRpc2FibGVkID0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogU2ltdWxhdGUgYSBzaW5nbGUgcmVnaW9uXG4gICAgICAgICAqL1xuICAgICAgICBnZXRSZWdpb246IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICB9LFxuXG4gICAgICAgIGdldEN1cnJlbnRSZWdpb25GaWVsZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBbXG4gICAgICAgICAgICAgICAgeyBmaWVsZDogJ2xxJywgdmFsdWU6IHRoaXMucXVhcnRpbGVzWzBdIH0sXG4gICAgICAgICAgICAgICAgeyBmaWVsZDogJ21lZCcsIHZhbHVlOiB0aGlzLnF1YXJ0aWxlc1sxXSB9LFxuICAgICAgICAgICAgICAgIHsgZmllbGQ6ICd1cScsIHZhbHVlOiB0aGlzLnF1YXJ0aWxlc1syXSB9XG4gICAgICAgICAgICBdO1xuICAgICAgICAgICAgaWYgKHRoaXMubG91dGxpZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHsgZmllbGQ6ICdsbycsIHZhbHVlOiB0aGlzLmxvdXRsaWVyfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5yb3V0bGllciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goeyBmaWVsZDogJ3JvJywgdmFsdWU6IHRoaXMucm91dGxpZXJ9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmx3aGlza2VyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaCh7IGZpZWxkOiAnbHcnLCB2YWx1ZTogdGhpcy5sd2hpc2tlcn0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMucndoaXNrZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHsgZmllbGQ6ICdydycsIHZhbHVlOiB0aGlzLnJ3aGlza2VyfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlbmRlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHRhcmdldCA9IHRoaXMudGFyZ2V0LFxuICAgICAgICAgICAgICAgIHZhbHVlcyA9IHRoaXMudmFsdWVzLFxuICAgICAgICAgICAgICAgIHZsZW4gPSB2YWx1ZXMubGVuZ3RoLFxuICAgICAgICAgICAgICAgIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnMsXG4gICAgICAgICAgICAgICAgY2FudmFzV2lkdGggPSB0aGlzLmNhbnZhc1dpZHRoLFxuICAgICAgICAgICAgICAgIGNhbnZhc0hlaWdodCA9IHRoaXMuY2FudmFzSGVpZ2h0LFxuICAgICAgICAgICAgICAgIG1pblZhbHVlID0gb3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNaW4nKSA9PT0gdW5kZWZpbmVkID8gTWF0aC5taW4uYXBwbHkoTWF0aCwgdmFsdWVzKSA6IG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlTWluJyksXG4gICAgICAgICAgICAgICAgbWF4VmFsdWUgPSBvcHRpb25zLmdldCgnY2hhcnRSYW5nZU1heCcpID09PSB1bmRlZmluZWQgPyBNYXRoLm1heC5hcHBseShNYXRoLCB2YWx1ZXMpIDogb3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNYXgnKSxcbiAgICAgICAgICAgICAgICBjYW52YXNMZWZ0ID0gMCxcbiAgICAgICAgICAgICAgICBsd2hpc2tlciwgbG91dGxpZXIsIGlxciwgcTEsIHEyLCBxMywgcndoaXNrZXIsIHJvdXRsaWVyLCBpLFxuICAgICAgICAgICAgICAgIHNpemUsIHVuaXRTaXplO1xuXG4gICAgICAgICAgICBpZiAoIWJveC5fc3VwZXIucmVuZGVyLmNhbGwodGhpcykpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChvcHRpb25zLmdldCgncmF3JykpIHtcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5nZXQoJ3Nob3dPdXRsaWVycycpICYmIHZhbHVlcy5sZW5ndGggPiA1KSB7XG4gICAgICAgICAgICAgICAgICAgIGxvdXRsaWVyID0gdmFsdWVzWzBdO1xuICAgICAgICAgICAgICAgICAgICBsd2hpc2tlciA9IHZhbHVlc1sxXTtcbiAgICAgICAgICAgICAgICAgICAgcTEgPSB2YWx1ZXNbMl07XG4gICAgICAgICAgICAgICAgICAgIHEyID0gdmFsdWVzWzNdO1xuICAgICAgICAgICAgICAgICAgICBxMyA9IHZhbHVlc1s0XTtcbiAgICAgICAgICAgICAgICAgICAgcndoaXNrZXIgPSB2YWx1ZXNbNV07XG4gICAgICAgICAgICAgICAgICAgIHJvdXRsaWVyID0gdmFsdWVzWzZdO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGx3aGlza2VyID0gdmFsdWVzWzBdO1xuICAgICAgICAgICAgICAgICAgICBxMSA9IHZhbHVlc1sxXTtcbiAgICAgICAgICAgICAgICAgICAgcTIgPSB2YWx1ZXNbMl07XG4gICAgICAgICAgICAgICAgICAgIHEzID0gdmFsdWVzWzNdO1xuICAgICAgICAgICAgICAgICAgICByd2hpc2tlciA9IHZhbHVlc1s0XTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhbHVlcy5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBhIC0gYjsgfSk7XG4gICAgICAgICAgICAgICAgcTEgPSBxdWFydGlsZSh2YWx1ZXMsIDEpO1xuICAgICAgICAgICAgICAgIHEyID0gcXVhcnRpbGUodmFsdWVzLCAyKTtcbiAgICAgICAgICAgICAgICBxMyA9IHF1YXJ0aWxlKHZhbHVlcywgMyk7XG4gICAgICAgICAgICAgICAgaXFyID0gcTMgLSBxMTtcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5nZXQoJ3Nob3dPdXRsaWVycycpKSB7XG4gICAgICAgICAgICAgICAgICAgIGx3aGlza2VyID0gcndoaXNrZXIgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCB2bGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsd2hpc2tlciA9PT0gdW5kZWZpbmVkICYmIHZhbHVlc1tpXSA+IHExIC0gKGlxciAqIG9wdGlvbnMuZ2V0KCdvdXRsaWVySVFSJykpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbHdoaXNrZXIgPSB2YWx1ZXNbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWVzW2ldIDwgcTMgKyAoaXFyICogb3B0aW9ucy5nZXQoJ291dGxpZXJJUVInKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByd2hpc2tlciA9IHZhbHVlc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBsb3V0bGllciA9IHZhbHVlc1swXTtcbiAgICAgICAgICAgICAgICAgICAgcm91dGxpZXIgPSB2YWx1ZXNbdmxlbiAtIDFdO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGx3aGlza2VyID0gdmFsdWVzWzBdO1xuICAgICAgICAgICAgICAgICAgICByd2hpc2tlciA9IHZhbHVlc1t2bGVuIC0gMV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5xdWFydGlsZXMgPSBbcTEsIHEyLCBxM107XG4gICAgICAgICAgICB0aGlzLmx3aGlza2VyID0gbHdoaXNrZXI7XG4gICAgICAgICAgICB0aGlzLnJ3aGlza2VyID0gcndoaXNrZXI7XG4gICAgICAgICAgICB0aGlzLmxvdXRsaWVyID0gbG91dGxpZXI7XG4gICAgICAgICAgICB0aGlzLnJvdXRsaWVyID0gcm91dGxpZXI7XG5cbiAgICAgICAgICAgIHVuaXRTaXplID0gY2FudmFzV2lkdGggLyAobWF4VmFsdWUgLSBtaW5WYWx1ZSArIDEpO1xuICAgICAgICAgICAgaWYgKG9wdGlvbnMuZ2V0KCdzaG93T3V0bGllcnMnKSkge1xuICAgICAgICAgICAgICAgIGNhbnZhc0xlZnQgPSBNYXRoLmNlaWwob3B0aW9ucy5nZXQoJ3Nwb3RSYWRpdXMnKSk7XG4gICAgICAgICAgICAgICAgY2FudmFzV2lkdGggLT0gMiAqIE1hdGguY2VpbChvcHRpb25zLmdldCgnc3BvdFJhZGl1cycpKTtcbiAgICAgICAgICAgICAgICB1bml0U2l6ZSA9IGNhbnZhc1dpZHRoIC8gKG1heFZhbHVlIC0gbWluVmFsdWUgKyAxKTtcbiAgICAgICAgICAgICAgICBpZiAobG91dGxpZXIgPCBsd2hpc2tlcikge1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXQuZHJhd0NpcmNsZSgobG91dGxpZXIgLSBtaW5WYWx1ZSkgKiB1bml0U2l6ZSArIGNhbnZhc0xlZnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBjYW52YXNIZWlnaHQgLyAyLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5nZXQoJ3Nwb3RSYWRpdXMnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZ2V0KCdvdXRsaWVyTGluZUNvbG9yJyksXG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmdldCgnb3V0bGllckZpbGxDb2xvcicpKS5hcHBlbmQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHJvdXRsaWVyID4gcndoaXNrZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LmRyYXdDaXJjbGUoKHJvdXRsaWVyIC0gbWluVmFsdWUpICogdW5pdFNpemUgKyBjYW52YXNMZWZ0LFxuICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzSGVpZ2h0IC8gMixcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZ2V0KCdzcG90UmFkaXVzJyksXG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmdldCgnb3V0bGllckxpbmVDb2xvcicpLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5nZXQoJ291dGxpZXJGaWxsQ29sb3InKSkuYXBwZW5kKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBib3hcbiAgICAgICAgICAgIHRhcmdldC5kcmF3UmVjdChcbiAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKChxMSAtIG1pblZhbHVlKSAqIHVuaXRTaXplICsgY2FudmFzTGVmdCksXG4gICAgICAgICAgICAgICAgTWF0aC5yb3VuZChjYW52YXNIZWlnaHQgKiAwLjEpLFxuICAgICAgICAgICAgICAgIE1hdGgucm91bmQoKHEzIC0gcTEpICogdW5pdFNpemUpLFxuICAgICAgICAgICAgICAgIE1hdGgucm91bmQoY2FudmFzSGVpZ2h0ICogMC44KSxcbiAgICAgICAgICAgICAgICBvcHRpb25zLmdldCgnYm94TGluZUNvbG9yJyksXG4gICAgICAgICAgICAgICAgb3B0aW9ucy5nZXQoJ2JveEZpbGxDb2xvcicpKS5hcHBlbmQoKTtcbiAgICAgICAgICAgIC8vIGxlZnQgd2hpc2tlclxuICAgICAgICAgICAgdGFyZ2V0LmRyYXdMaW5lKFxuICAgICAgICAgICAgICAgIE1hdGgucm91bmQoKGx3aGlza2VyIC0gbWluVmFsdWUpICogdW5pdFNpemUgKyBjYW52YXNMZWZ0KSxcbiAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKGNhbnZhc0hlaWdodCAvIDIpLFxuICAgICAgICAgICAgICAgIE1hdGgucm91bmQoKHExIC0gbWluVmFsdWUpICogdW5pdFNpemUgKyBjYW52YXNMZWZ0KSxcbiAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKGNhbnZhc0hlaWdodCAvIDIpLFxuICAgICAgICAgICAgICAgIG9wdGlvbnMuZ2V0KCdsaW5lQ29sb3InKSkuYXBwZW5kKCk7XG4gICAgICAgICAgICB0YXJnZXQuZHJhd0xpbmUoXG4gICAgICAgICAgICAgICAgTWF0aC5yb3VuZCgobHdoaXNrZXIgLSBtaW5WYWx1ZSkgKiB1bml0U2l6ZSArIGNhbnZhc0xlZnQpLFxuICAgICAgICAgICAgICAgIE1hdGgucm91bmQoY2FudmFzSGVpZ2h0IC8gNCksXG4gICAgICAgICAgICAgICAgTWF0aC5yb3VuZCgobHdoaXNrZXIgLSBtaW5WYWx1ZSkgKiB1bml0U2l6ZSArIGNhbnZhc0xlZnQpLFxuICAgICAgICAgICAgICAgIE1hdGgucm91bmQoY2FudmFzSGVpZ2h0IC0gY2FudmFzSGVpZ2h0IC8gNCksXG4gICAgICAgICAgICAgICAgb3B0aW9ucy5nZXQoJ3doaXNrZXJDb2xvcicpKS5hcHBlbmQoKTtcbiAgICAgICAgICAgIC8vIHJpZ2h0IHdoaXNrZXJcbiAgICAgICAgICAgIHRhcmdldC5kcmF3TGluZShNYXRoLnJvdW5kKChyd2hpc2tlciAtIG1pblZhbHVlKSAqIHVuaXRTaXplICsgY2FudmFzTGVmdCksXG4gICAgICAgICAgICAgICAgTWF0aC5yb3VuZChjYW52YXNIZWlnaHQgLyAyKSxcbiAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKChxMyAtIG1pblZhbHVlKSAqIHVuaXRTaXplICsgY2FudmFzTGVmdCksXG4gICAgICAgICAgICAgICAgTWF0aC5yb3VuZChjYW52YXNIZWlnaHQgLyAyKSxcbiAgICAgICAgICAgICAgICBvcHRpb25zLmdldCgnbGluZUNvbG9yJykpLmFwcGVuZCgpO1xuICAgICAgICAgICAgdGFyZ2V0LmRyYXdMaW5lKFxuICAgICAgICAgICAgICAgIE1hdGgucm91bmQoKHJ3aGlza2VyIC0gbWluVmFsdWUpICogdW5pdFNpemUgKyBjYW52YXNMZWZ0KSxcbiAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKGNhbnZhc0hlaWdodCAvIDQpLFxuICAgICAgICAgICAgICAgIE1hdGgucm91bmQoKHJ3aGlza2VyIC0gbWluVmFsdWUpICogdW5pdFNpemUgKyBjYW52YXNMZWZ0KSxcbiAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKGNhbnZhc0hlaWdodCAtIGNhbnZhc0hlaWdodCAvIDQpLFxuICAgICAgICAgICAgICAgIG9wdGlvbnMuZ2V0KCd3aGlza2VyQ29sb3InKSkuYXBwZW5kKCk7XG4gICAgICAgICAgICAvLyBtZWRpYW4gbGluZVxuICAgICAgICAgICAgdGFyZ2V0LmRyYXdMaW5lKFxuICAgICAgICAgICAgICAgIE1hdGgucm91bmQoKHEyIC0gbWluVmFsdWUpICogdW5pdFNpemUgKyBjYW52YXNMZWZ0KSxcbiAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKGNhbnZhc0hlaWdodCAqIDAuMSksXG4gICAgICAgICAgICAgICAgTWF0aC5yb3VuZCgocTIgLSBtaW5WYWx1ZSkgKiB1bml0U2l6ZSArIGNhbnZhc0xlZnQpLFxuICAgICAgICAgICAgICAgIE1hdGgucm91bmQoY2FudmFzSGVpZ2h0ICogMC45KSxcbiAgICAgICAgICAgICAgICBvcHRpb25zLmdldCgnbWVkaWFuQ29sb3InKSkuYXBwZW5kKCk7XG4gICAgICAgICAgICBpZiAob3B0aW9ucy5nZXQoJ3RhcmdldCcpKSB7XG4gICAgICAgICAgICAgICAgc2l6ZSA9IE1hdGguY2VpbChvcHRpb25zLmdldCgnc3BvdFJhZGl1cycpKTtcbiAgICAgICAgICAgICAgICB0YXJnZXQuZHJhd0xpbmUoXG4gICAgICAgICAgICAgICAgICAgIE1hdGgucm91bmQoKG9wdGlvbnMuZ2V0KCd0YXJnZXQnKSAtIG1pblZhbHVlKSAqIHVuaXRTaXplICsgY2FudmFzTGVmdCksXG4gICAgICAgICAgICAgICAgICAgIE1hdGgucm91bmQoKGNhbnZhc0hlaWdodCAvIDIpIC0gc2l6ZSksXG4gICAgICAgICAgICAgICAgICAgIE1hdGgucm91bmQoKG9wdGlvbnMuZ2V0KCd0YXJnZXQnKSAtIG1pblZhbHVlKSAqIHVuaXRTaXplICsgY2FudmFzTGVmdCksXG4gICAgICAgICAgICAgICAgICAgIE1hdGgucm91bmQoKGNhbnZhc0hlaWdodCAvIDIpICsgc2l6ZSksXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZ2V0KCd0YXJnZXRDb2xvcicpKS5hcHBlbmQoKTtcbiAgICAgICAgICAgICAgICB0YXJnZXQuZHJhd0xpbmUoXG4gICAgICAgICAgICAgICAgICAgIE1hdGgucm91bmQoKG9wdGlvbnMuZ2V0KCd0YXJnZXQnKSAtIG1pblZhbHVlKSAqIHVuaXRTaXplICsgY2FudmFzTGVmdCAtIHNpemUpLFxuICAgICAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKGNhbnZhc0hlaWdodCAvIDIpLFxuICAgICAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKChvcHRpb25zLmdldCgndGFyZ2V0JykgLSBtaW5WYWx1ZSkgKiB1bml0U2l6ZSArIGNhbnZhc0xlZnQgKyBzaXplKSxcbiAgICAgICAgICAgICAgICAgICAgTWF0aC5yb3VuZChjYW52YXNIZWlnaHQgLyAyKSxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5nZXQoJ3RhcmdldENvbG9yJykpLmFwcGVuZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGFyZ2V0LnJlbmRlcigpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBTZXR1cCBhIHZlcnkgc2ltcGxlIFwidmlydHVhbCBjYW52YXNcIiB0byBtYWtlIGRyYXdpbmcgdGhlIGZldyBzaGFwZXMgd2UgbmVlZCBlYXNpZXJcbiAgICAvLyBUaGlzIGlzIGFjY2Vzc2libGUgYXMgJChmb28pLnNpbXBsZWRyYXcoKVxuXG4gICAgVlNoYXBlID0gY3JlYXRlQ2xhc3Moe1xuICAgICAgICBpbml0OiBmdW5jdGlvbiAodGFyZ2V0LCBpZCwgdHlwZSwgYXJncykge1xuICAgICAgICAgICAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7XG4gICAgICAgICAgICB0aGlzLmlkID0gaWQ7XG4gICAgICAgICAgICB0aGlzLnR5cGUgPSB0eXBlO1xuICAgICAgICAgICAgdGhpcy5hcmdzID0gYXJncztcbiAgICAgICAgfSxcbiAgICAgICAgYXBwZW5kOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLnRhcmdldC5hcHBlbmRTaGFwZSh0aGlzKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICBWQ2FudmFzX2Jhc2UgPSBjcmVhdGVDbGFzcyh7XG4gICAgICAgIF9weHJlZ2V4OiAvKFxcZCspKHB4KT9cXHMqJC9pLFxuXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uICh3aWR0aCwgaGVpZ2h0LCB0YXJnZXQpIHtcbiAgICAgICAgICAgIGlmICghd2lkdGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLndpZHRoID0gd2lkdGg7XG4gICAgICAgICAgICB0aGlzLmhlaWdodCA9IGhlaWdodDtcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0ID0gdGFyZ2V0O1xuICAgICAgICAgICAgdGhpcy5sYXN0U2hhcGVJZCA9IG51bGw7XG4gICAgICAgICAgICBpZiAodGFyZ2V0WzBdKSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0gdGFyZ2V0WzBdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJC5kYXRhKHRhcmdldCwgJ19qcXNfdmNhbnZhcycsIHRoaXMpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGRyYXdMaW5lOiBmdW5jdGlvbiAoeDEsIHkxLCB4MiwgeTIsIGxpbmVDb2xvciwgbGluZVdpZHRoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5kcmF3U2hhcGUoW1t4MSwgeTFdLCBbeDIsIHkyXV0sIGxpbmVDb2xvciwgbGluZVdpZHRoKTtcbiAgICAgICAgfSxcblxuICAgICAgICBkcmF3U2hhcGU6IGZ1bmN0aW9uIChwYXRoLCBsaW5lQ29sb3IsIGZpbGxDb2xvciwgbGluZVdpZHRoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZ2VuU2hhcGUoJ1NoYXBlJywgW3BhdGgsIGxpbmVDb2xvciwgZmlsbENvbG9yLCBsaW5lV2lkdGhdKTtcbiAgICAgICAgfSxcblxuICAgICAgICBkcmF3Q2lyY2xlOiBmdW5jdGlvbiAoeCwgeSwgcmFkaXVzLCBsaW5lQ29sb3IsIGZpbGxDb2xvciwgbGluZVdpZHRoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZ2VuU2hhcGUoJ0NpcmNsZScsIFt4LCB5LCByYWRpdXMsIGxpbmVDb2xvciwgZmlsbENvbG9yLCBsaW5lV2lkdGhdKTtcbiAgICAgICAgfSxcblxuICAgICAgICBkcmF3UGllU2xpY2U6IGZ1bmN0aW9uICh4LCB5LCByYWRpdXMsIHN0YXJ0QW5nbGUsIGVuZEFuZ2xlLCBsaW5lQ29sb3IsIGZpbGxDb2xvcikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dlblNoYXBlKCdQaWVTbGljZScsIFt4LCB5LCByYWRpdXMsIHN0YXJ0QW5nbGUsIGVuZEFuZ2xlLCBsaW5lQ29sb3IsIGZpbGxDb2xvcl0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIGRyYXdSZWN0OiBmdW5jdGlvbiAoeCwgeSwgd2lkdGgsIGhlaWdodCwgbGluZUNvbG9yLCBmaWxsQ29sb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9nZW5TaGFwZSgnUmVjdCcsIFt4LCB5LCB3aWR0aCwgaGVpZ2h0LCBsaW5lQ29sb3IsIGZpbGxDb2xvcl0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIGdldEVsZW1lbnQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNhbnZhcztcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogUmV0dXJuIHRoZSBtb3N0IHJlY2VudGx5IGluc2VydGVkIHNoYXBlIGlkXG4gICAgICAgICAqL1xuICAgICAgICBnZXRMYXN0U2hhcGVJZDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubGFzdFNoYXBlSWQ7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENsZWFyIGFuZCByZXNldCB0aGUgY2FudmFzXG4gICAgICAgICAqL1xuICAgICAgICByZXNldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgYWxlcnQoJ3Jlc2V0IG5vdCBpbXBsZW1lbnRlZCcpO1xuICAgICAgICB9LFxuXG4gICAgICAgIF9pbnNlcnQ6IGZ1bmN0aW9uIChlbCwgdGFyZ2V0KSB7XG4gICAgICAgICAgICAkKHRhcmdldCkuaHRtbChlbCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENhbGN1bGF0ZSB0aGUgcGl4ZWwgZGltZW5zaW9ucyBvZiB0aGUgY2FudmFzXG4gICAgICAgICAqL1xuICAgICAgICBfY2FsY3VsYXRlUGl4ZWxEaW1zOiBmdW5jdGlvbiAod2lkdGgsIGhlaWdodCwgY2FudmFzKSB7XG4gICAgICAgICAgICAvLyBYWFggVGhpcyBzaG91bGQgcHJvYmFibHkgYmUgYSBjb25maWd1cmFibGUgb3B0aW9uXG4gICAgICAgICAgICB2YXIgbWF0Y2g7XG4gICAgICAgICAgICBtYXRjaCA9IHRoaXMuX3B4cmVnZXguZXhlYyhoZWlnaHQpO1xuICAgICAgICAgICAgaWYgKG1hdGNoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5waXhlbEhlaWdodCA9IG1hdGNoWzFdO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBpeGVsSGVpZ2h0ID0gJChjYW52YXMpLmhlaWdodCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbWF0Y2ggPSB0aGlzLl9weHJlZ2V4LmV4ZWMod2lkdGgpO1xuICAgICAgICAgICAgaWYgKG1hdGNoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5waXhlbFdpZHRoID0gbWF0Y2hbMV07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMucGl4ZWxXaWR0aCA9ICQoY2FudmFzKS53aWR0aCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBHZW5lcmF0ZSBhIHNoYXBlIG9iamVjdCBhbmQgaWQgZm9yIGxhdGVyIHJlbmRlcmluZ1xuICAgICAgICAgKi9cbiAgICAgICAgX2dlblNoYXBlOiBmdW5jdGlvbiAoc2hhcGV0eXBlLCBzaGFwZWFyZ3MpIHtcbiAgICAgICAgICAgIHZhciBpZCA9IHNoYXBlQ291bnQrKztcbiAgICAgICAgICAgIHNoYXBlYXJncy51bnNoaWZ0KGlkKTtcbiAgICAgICAgICAgIHJldHVybiBuZXcgVlNoYXBlKHRoaXMsIGlkLCBzaGFwZXR5cGUsIHNoYXBlYXJncyk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEFkZCBhIHNoYXBlIHRvIHRoZSBlbmQgb2YgdGhlIHJlbmRlciBxdWV1ZVxuICAgICAgICAgKi9cbiAgICAgICAgYXBwZW5kU2hhcGU6IGZ1bmN0aW9uIChzaGFwZSkge1xuICAgICAgICAgICAgYWxlcnQoJ2FwcGVuZFNoYXBlIG5vdCBpbXBsZW1lbnRlZCcpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSZXBsYWNlIG9uZSBzaGFwZSB3aXRoIGFub3RoZXJcbiAgICAgICAgICovXG4gICAgICAgIHJlcGxhY2VXaXRoU2hhcGU6IGZ1bmN0aW9uIChzaGFwZWlkLCBzaGFwZSkge1xuICAgICAgICAgICAgYWxlcnQoJ3JlcGxhY2VXaXRoU2hhcGUgbm90IGltcGxlbWVudGVkJyk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEluc2VydCBvbmUgc2hhcGUgYWZ0ZXIgYW5vdGhlciBpbiB0aGUgcmVuZGVyIHF1ZXVlXG4gICAgICAgICAqL1xuICAgICAgICBpbnNlcnRBZnRlclNoYXBlOiBmdW5jdGlvbiAoc2hhcGVpZCwgc2hhcGUpIHtcbiAgICAgICAgICAgIGFsZXJ0KCdpbnNlcnRBZnRlclNoYXBlIG5vdCBpbXBsZW1lbnRlZCcpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSZW1vdmUgYSBzaGFwZSBmcm9tIHRoZSBxdWV1ZVxuICAgICAgICAgKi9cbiAgICAgICAgcmVtb3ZlU2hhcGVJZDogZnVuY3Rpb24gKHNoYXBlaWQpIHtcbiAgICAgICAgICAgIGFsZXJ0KCdyZW1vdmVTaGFwZUlkIG5vdCBpbXBsZW1lbnRlZCcpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaW5kIGEgc2hhcGUgYXQgdGhlIHNwZWNpZmllZCB4L3kgY28tb3JkaW5hdGVzXG4gICAgICAgICAqL1xuICAgICAgICBnZXRTaGFwZUF0OiBmdW5jdGlvbiAoZWwsIHgsIHkpIHtcbiAgICAgICAgICAgIGFsZXJ0KCdnZXRTaGFwZUF0IG5vdCBpbXBsZW1lbnRlZCcpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSZW5kZXIgYWxsIHF1ZXVlZCBzaGFwZXMgb250byB0aGUgY2FudmFzXG4gICAgICAgICAqL1xuICAgICAgICByZW5kZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGFsZXJ0KCdyZW5kZXIgbm90IGltcGxlbWVudGVkJyk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIFZDYW52YXNfY2FudmFzID0gY3JlYXRlQ2xhc3MoVkNhbnZhc19iYXNlLCB7XG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uICh3aWR0aCwgaGVpZ2h0LCB0YXJnZXQsIGludGVyYWN0KSB7XG4gICAgICAgICAgICBWQ2FudmFzX2NhbnZhcy5fc3VwZXIuaW5pdC5jYWxsKHRoaXMsIHdpZHRoLCBoZWlnaHQsIHRhcmdldCk7XG4gICAgICAgICAgICB0aGlzLmNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuICAgICAgICAgICAgaWYgKHRhcmdldFswXSkge1xuICAgICAgICAgICAgICAgIHRhcmdldCA9IHRhcmdldFswXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICQuZGF0YSh0YXJnZXQsICdfanFzX3ZjYW52YXMnLCB0aGlzKTtcbiAgICAgICAgICAgICQodGhpcy5jYW52YXMpLmNzcyh7IGRpc3BsYXk6ICdpbmxpbmUtYmxvY2snLCB3aWR0aDogd2lkdGgsIGhlaWdodDogaGVpZ2h0LCB2ZXJ0aWNhbEFsaWduOiAndG9wJyB9KTtcbiAgICAgICAgICAgIHRoaXMuX2luc2VydCh0aGlzLmNhbnZhcywgdGFyZ2V0KTtcbiAgICAgICAgICAgIHRoaXMuX2NhbGN1bGF0ZVBpeGVsRGltcyh3aWR0aCwgaGVpZ2h0LCB0aGlzLmNhbnZhcyk7XG4gICAgICAgICAgICB0aGlzLmNhbnZhcy53aWR0aCA9IHRoaXMucGl4ZWxXaWR0aDtcbiAgICAgICAgICAgIHRoaXMuY2FudmFzLmhlaWdodCA9IHRoaXMucGl4ZWxIZWlnaHQ7XG4gICAgICAgICAgICB0aGlzLmludGVyYWN0ID0gaW50ZXJhY3Q7XG4gICAgICAgICAgICB0aGlzLnNoYXBlcyA9IHt9O1xuICAgICAgICAgICAgdGhpcy5zaGFwZXNlcSA9IFtdO1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50VGFyZ2V0U2hhcGVJZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICQodGhpcy5jYW52YXMpLmNzcyh7d2lkdGg6IHRoaXMucGl4ZWxXaWR0aCwgaGVpZ2h0OiB0aGlzLnBpeGVsSGVpZ2h0fSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgX2dldENvbnRleHQ6IGZ1bmN0aW9uIChsaW5lQ29sb3IsIGZpbGxDb2xvciwgbGluZVdpZHRoKSB7XG4gICAgICAgICAgICB2YXIgY29udGV4dCA9IHRoaXMuY2FudmFzLmdldENvbnRleHQoJzJkJyk7XG4gICAgICAgICAgICBpZiAobGluZUNvbG9yICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0LnN0cm9rZVN0eWxlID0gbGluZUNvbG9yO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29udGV4dC5saW5lV2lkdGggPSBsaW5lV2lkdGggPT09IHVuZGVmaW5lZCA/IDEgOiBsaW5lV2lkdGg7XG4gICAgICAgICAgICBpZiAoZmlsbENvbG9yICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0LmZpbGxTdHlsZSA9IGZpbGxDb2xvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjb250ZXh0O1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlc2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgY29udGV4dCA9IHRoaXMuX2dldENvbnRleHQoKTtcbiAgICAgICAgICAgIGNvbnRleHQuY2xlYXJSZWN0KDAsIDAsIHRoaXMucGl4ZWxXaWR0aCwgdGhpcy5waXhlbEhlaWdodCk7XG4gICAgICAgICAgICB0aGlzLnNoYXBlcyA9IHt9O1xuICAgICAgICAgICAgdGhpcy5zaGFwZXNlcSA9IFtdO1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50VGFyZ2V0U2hhcGVJZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgfSxcblxuICAgICAgICBfZHJhd1NoYXBlOiBmdW5jdGlvbiAoc2hhcGVpZCwgcGF0aCwgbGluZUNvbG9yLCBmaWxsQ29sb3IsIGxpbmVXaWR0aCkge1xuICAgICAgICAgICAgdmFyIGNvbnRleHQgPSB0aGlzLl9nZXRDb250ZXh0KGxpbmVDb2xvciwgZmlsbENvbG9yLCBsaW5lV2lkdGgpLFxuICAgICAgICAgICAgICAgIGksIHBsZW47XG4gICAgICAgICAgICBjb250ZXh0LmJlZ2luUGF0aCgpO1xuICAgICAgICAgICAgY29udGV4dC5tb3ZlVG8ocGF0aFswXVswXSArIDAuNSwgcGF0aFswXVsxXSArIDAuNSk7XG4gICAgICAgICAgICBmb3IgKGkgPSAxLCBwbGVuID0gcGF0aC5sZW5ndGg7IGkgPCBwbGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0LmxpbmVUbyhwYXRoW2ldWzBdICsgMC41LCBwYXRoW2ldWzFdICsgMC41KTsgLy8gdGhlIDAuNSBvZmZzZXQgZ2l2ZXMgdXMgY3Jpc3AgcGl4ZWwtd2lkdGggbGluZXNcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChsaW5lQ29sb3IgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGNvbnRleHQuc3Ryb2tlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZmlsbENvbG9yICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0LmZpbGwoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnRhcmdldFggIT09IHVuZGVmaW5lZCAmJiB0aGlzLnRhcmdldFkgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgIGNvbnRleHQuaXNQb2ludEluUGF0aCh0aGlzLnRhcmdldFgsIHRoaXMudGFyZ2V0WSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRUYXJnZXRTaGFwZUlkID0gc2hhcGVpZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBfZHJhd0NpcmNsZTogZnVuY3Rpb24gKHNoYXBlaWQsIHgsIHksIHJhZGl1cywgbGluZUNvbG9yLCBmaWxsQ29sb3IsIGxpbmVXaWR0aCkge1xuICAgICAgICAgICAgdmFyIGNvbnRleHQgPSB0aGlzLl9nZXRDb250ZXh0KGxpbmVDb2xvciwgZmlsbENvbG9yLCBsaW5lV2lkdGgpO1xuICAgICAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKTtcbiAgICAgICAgICAgIGNvbnRleHQuYXJjKHgsIHksIHJhZGl1cywgMCwgMiAqIE1hdGguUEksIGZhbHNlKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnRhcmdldFggIT09IHVuZGVmaW5lZCAmJiB0aGlzLnRhcmdldFkgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgIGNvbnRleHQuaXNQb2ludEluUGF0aCh0aGlzLnRhcmdldFgsIHRoaXMudGFyZ2V0WSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRUYXJnZXRTaGFwZUlkID0gc2hhcGVpZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChsaW5lQ29sb3IgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGNvbnRleHQuc3Ryb2tlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZmlsbENvbG9yICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0LmZpbGwoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBfZHJhd1BpZVNsaWNlOiBmdW5jdGlvbiAoc2hhcGVpZCwgeCwgeSwgcmFkaXVzLCBzdGFydEFuZ2xlLCBlbmRBbmdsZSwgbGluZUNvbG9yLCBmaWxsQ29sb3IpIHtcbiAgICAgICAgICAgIHZhciBjb250ZXh0ID0gdGhpcy5fZ2V0Q29udGV4dChsaW5lQ29sb3IsIGZpbGxDb2xvcik7XG4gICAgICAgICAgICBjb250ZXh0LmJlZ2luUGF0aCgpO1xuICAgICAgICAgICAgY29udGV4dC5tb3ZlVG8oeCwgeSk7XG4gICAgICAgICAgICBjb250ZXh0LmFyYyh4LCB5LCByYWRpdXMsIHN0YXJ0QW5nbGUsIGVuZEFuZ2xlLCBmYWxzZSk7XG4gICAgICAgICAgICBjb250ZXh0LmxpbmVUbyh4LCB5KTtcbiAgICAgICAgICAgIGNvbnRleHQuY2xvc2VQYXRoKCk7XG4gICAgICAgICAgICBpZiAobGluZUNvbG9yICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0LnN0cm9rZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGZpbGxDb2xvcikge1xuICAgICAgICAgICAgICAgIGNvbnRleHQuZmlsbCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMudGFyZ2V0WCAhPT0gdW5kZWZpbmVkICYmIHRoaXMudGFyZ2V0WSAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICAgICAgY29udGV4dC5pc1BvaW50SW5QYXRoKHRoaXMudGFyZ2V0WCwgdGhpcy50YXJnZXRZKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFRhcmdldFNoYXBlSWQgPSBzaGFwZWlkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIF9kcmF3UmVjdDogZnVuY3Rpb24gKHNoYXBlaWQsIHgsIHksIHdpZHRoLCBoZWlnaHQsIGxpbmVDb2xvciwgZmlsbENvbG9yKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZHJhd1NoYXBlKHNoYXBlaWQsIFtbeCwgeV0sIFt4ICsgd2lkdGgsIHldLCBbeCArIHdpZHRoLCB5ICsgaGVpZ2h0XSwgW3gsIHkgKyBoZWlnaHRdLCBbeCwgeV1dLCBsaW5lQ29sb3IsIGZpbGxDb2xvcik7XG4gICAgICAgIH0sXG5cbiAgICAgICAgYXBwZW5kU2hhcGU6IGZ1bmN0aW9uIChzaGFwZSkge1xuICAgICAgICAgICAgdGhpcy5zaGFwZXNbc2hhcGUuaWRdID0gc2hhcGU7XG4gICAgICAgICAgICB0aGlzLnNoYXBlc2VxLnB1c2goc2hhcGUuaWQpO1xuICAgICAgICAgICAgdGhpcy5sYXN0U2hhcGVJZCA9IHNoYXBlLmlkO1xuICAgICAgICAgICAgcmV0dXJuIHNoYXBlLmlkO1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlcGxhY2VXaXRoU2hhcGU6IGZ1bmN0aW9uIChzaGFwZWlkLCBzaGFwZSkge1xuICAgICAgICAgICAgdmFyIHNoYXBlc2VxID0gdGhpcy5zaGFwZXNlcSxcbiAgICAgICAgICAgICAgICBpO1xuICAgICAgICAgICAgdGhpcy5zaGFwZXNbc2hhcGUuaWRdID0gc2hhcGU7XG4gICAgICAgICAgICBmb3IgKGkgPSBzaGFwZXNlcS5sZW5ndGg7IGktLTspIHtcbiAgICAgICAgICAgICAgICBpZiAoc2hhcGVzZXFbaV0gPT0gc2hhcGVpZCkge1xuICAgICAgICAgICAgICAgICAgICBzaGFwZXNlcVtpXSA9IHNoYXBlLmlkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRlbGV0ZSB0aGlzLnNoYXBlc1tzaGFwZWlkXTtcbiAgICAgICAgfSxcblxuICAgICAgICByZXBsYWNlV2l0aFNoYXBlczogZnVuY3Rpb24gKHNoYXBlaWRzLCBzaGFwZXMpIHtcbiAgICAgICAgICAgIHZhciBzaGFwZXNlcSA9IHRoaXMuc2hhcGVzZXEsXG4gICAgICAgICAgICAgICAgc2hhcGVtYXAgPSB7fSxcbiAgICAgICAgICAgICAgICBzaWQsIGksIGZpcnN0O1xuXG4gICAgICAgICAgICBmb3IgKGkgPSBzaGFwZWlkcy5sZW5ndGg7IGktLTspIHtcbiAgICAgICAgICAgICAgICBzaGFwZW1hcFtzaGFwZWlkc1tpXV0gPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChpID0gc2hhcGVzZXEubGVuZ3RoOyBpLS07KSB7XG4gICAgICAgICAgICAgICAgc2lkID0gc2hhcGVzZXFbaV07XG4gICAgICAgICAgICAgICAgaWYgKHNoYXBlbWFwW3NpZF0pIHtcbiAgICAgICAgICAgICAgICAgICAgc2hhcGVzZXEuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5zaGFwZXNbc2lkXTtcbiAgICAgICAgICAgICAgICAgICAgZmlyc3QgPSBpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAoaSA9IHNoYXBlcy5sZW5ndGg7IGktLTspIHtcbiAgICAgICAgICAgICAgICBzaGFwZXNlcS5zcGxpY2UoZmlyc3QsIDAsIHNoYXBlc1tpXS5pZCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zaGFwZXNbc2hhcGVzW2ldLmlkXSA9IHNoYXBlc1tpXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9LFxuXG4gICAgICAgIGluc2VydEFmdGVyU2hhcGU6IGZ1bmN0aW9uIChzaGFwZWlkLCBzaGFwZSkge1xuICAgICAgICAgICAgdmFyIHNoYXBlc2VxID0gdGhpcy5zaGFwZXNlcSxcbiAgICAgICAgICAgICAgICBpO1xuICAgICAgICAgICAgZm9yIChpID0gc2hhcGVzZXEubGVuZ3RoOyBpLS07KSB7XG4gICAgICAgICAgICAgICAgaWYgKHNoYXBlc2VxW2ldID09PSBzaGFwZWlkKSB7XG4gICAgICAgICAgICAgICAgICAgIHNoYXBlc2VxLnNwbGljZShpICsgMSwgMCwgc2hhcGUuaWQpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNoYXBlc1tzaGFwZS5pZF0gPSBzaGFwZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICByZW1vdmVTaGFwZUlkOiBmdW5jdGlvbiAoc2hhcGVpZCkge1xuICAgICAgICAgICAgdmFyIHNoYXBlc2VxID0gdGhpcy5zaGFwZXNlcSxcbiAgICAgICAgICAgICAgICBpO1xuICAgICAgICAgICAgZm9yIChpID0gc2hhcGVzZXEubGVuZ3RoOyBpLS07KSB7XG4gICAgICAgICAgICAgICAgaWYgKHNoYXBlc2VxW2ldID09PSBzaGFwZWlkKSB7XG4gICAgICAgICAgICAgICAgICAgIHNoYXBlc2VxLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVsZXRlIHRoaXMuc2hhcGVzW3NoYXBlaWRdO1xuICAgICAgICB9LFxuXG4gICAgICAgIGdldFNoYXBlQXQ6IGZ1bmN0aW9uIChlbCwgeCwgeSkge1xuICAgICAgICAgICAgdGhpcy50YXJnZXRYID0geDtcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0WSA9IHk7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY3VycmVudFRhcmdldFNoYXBlSWQ7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgc2hhcGVzZXEgPSB0aGlzLnNoYXBlc2VxLFxuICAgICAgICAgICAgICAgIHNoYXBlcyA9IHRoaXMuc2hhcGVzLFxuICAgICAgICAgICAgICAgIHNoYXBlQ291bnQgPSBzaGFwZXNlcS5sZW5ndGgsXG4gICAgICAgICAgICAgICAgY29udGV4dCA9IHRoaXMuX2dldENvbnRleHQoKSxcbiAgICAgICAgICAgICAgICBzaGFwZWlkLCBzaGFwZSwgaTtcbiAgICAgICAgICAgIGNvbnRleHQuY2xlYXJSZWN0KDAsIDAsIHRoaXMucGl4ZWxXaWR0aCwgdGhpcy5waXhlbEhlaWdodCk7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgc2hhcGVDb3VudDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgc2hhcGVpZCA9IHNoYXBlc2VxW2ldO1xuICAgICAgICAgICAgICAgIHNoYXBlID0gc2hhcGVzW3NoYXBlaWRdO1xuICAgICAgICAgICAgICAgIHRoaXNbJ19kcmF3JyArIHNoYXBlLnR5cGVdLmFwcGx5KHRoaXMsIHNoYXBlLmFyZ3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCF0aGlzLmludGVyYWN0KSB7XG4gICAgICAgICAgICAgICAgLy8gbm90IGludGVyYWN0aXZlIHNvIG5vIG5lZWQgdG8ga2VlcCB0aGUgc2hhcGVzIGFycmF5XG4gICAgICAgICAgICAgICAgdGhpcy5zaGFwZXMgPSB7fTtcbiAgICAgICAgICAgICAgICB0aGlzLnNoYXBlc2VxID0gW107XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgIH0pO1xuXG4gICAgVkNhbnZhc192bWwgPSBjcmVhdGVDbGFzcyhWQ2FudmFzX2Jhc2UsIHtcbiAgICAgICAgaW5pdDogZnVuY3Rpb24gKHdpZHRoLCBoZWlnaHQsIHRhcmdldCkge1xuICAgICAgICAgICAgdmFyIGdyb3VwZWw7XG4gICAgICAgICAgICBWQ2FudmFzX3ZtbC5fc3VwZXIuaW5pdC5jYWxsKHRoaXMsIHdpZHRoLCBoZWlnaHQsIHRhcmdldCk7XG4gICAgICAgICAgICBpZiAodGFyZ2V0WzBdKSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0gdGFyZ2V0WzBdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJC5kYXRhKHRhcmdldCwgJ19qcXNfdmNhbnZhcycsIHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5jYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICAgICAgICAkKHRoaXMuY2FudmFzKS5jc3MoeyBkaXNwbGF5OiAnaW5saW5lLWJsb2NrJywgcG9zaXRpb246ICdyZWxhdGl2ZScsIG92ZXJmbG93OiAnaGlkZGVuJywgd2lkdGg6IHdpZHRoLCBoZWlnaHQ6IGhlaWdodCwgbWFyZ2luOiAnMHB4JywgcGFkZGluZzogJzBweCcsIHZlcnRpY2FsQWxpZ246ICd0b3AnfSk7XG4gICAgICAgICAgICB0aGlzLl9pbnNlcnQodGhpcy5jYW52YXMsIHRhcmdldCk7XG4gICAgICAgICAgICB0aGlzLl9jYWxjdWxhdGVQaXhlbERpbXMod2lkdGgsIGhlaWdodCwgdGhpcy5jYW52YXMpO1xuICAgICAgICAgICAgdGhpcy5jYW52YXMud2lkdGggPSB0aGlzLnBpeGVsV2lkdGg7XG4gICAgICAgICAgICB0aGlzLmNhbnZhcy5oZWlnaHQgPSB0aGlzLnBpeGVsSGVpZ2h0O1xuICAgICAgICAgICAgZ3JvdXBlbCA9ICc8djpncm91cCBjb29yZG9yaWdpbj1cIjAgMFwiIGNvb3Jkc2l6ZT1cIicgKyB0aGlzLnBpeGVsV2lkdGggKyAnICcgKyB0aGlzLnBpeGVsSGVpZ2h0ICsgJ1wiJyArXG4gICAgICAgICAgICAgICAgICAgICcgc3R5bGU9XCJwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MDtsZWZ0OjA7d2lkdGg6JyArIHRoaXMucGl4ZWxXaWR0aCArICdweDtoZWlnaHQ9JyArIHRoaXMucGl4ZWxIZWlnaHQgKyAncHg7XCI+PC92Omdyb3VwPic7XG4gICAgICAgICAgICB0aGlzLmNhbnZhcy5pbnNlcnRBZGphY2VudEhUTUwoJ2JlZm9yZUVuZCcsIGdyb3VwZWwpO1xuICAgICAgICAgICAgdGhpcy5ncm91cCA9ICQodGhpcy5jYW52YXMpLmNoaWxkcmVuKClbMF07XG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVkID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLnByZXJlbmRlciA9ICcnO1xuICAgICAgICB9LFxuXG4gICAgICAgIF9kcmF3U2hhcGU6IGZ1bmN0aW9uIChzaGFwZWlkLCBwYXRoLCBsaW5lQ29sb3IsIGZpbGxDb2xvciwgbGluZVdpZHRoKSB7XG4gICAgICAgICAgICB2YXIgdnBhdGggPSBbXSxcbiAgICAgICAgICAgICAgICBpbml0aWFsLCBzdHJva2UsIGZpbGwsIGNsb3NlZCwgdmVsLCBwbGVuLCBpO1xuICAgICAgICAgICAgZm9yIChpID0gMCwgcGxlbiA9IHBhdGgubGVuZ3RoOyBpIDwgcGxlbjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdnBhdGhbaV0gPSAnJyArIChwYXRoW2ldWzBdKSArICcsJyArIChwYXRoW2ldWzFdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGluaXRpYWwgPSB2cGF0aC5zcGxpY2UoMCwgMSk7XG4gICAgICAgICAgICBsaW5lV2lkdGggPSBsaW5lV2lkdGggPT09IHVuZGVmaW5lZCA/IDEgOiBsaW5lV2lkdGg7XG4gICAgICAgICAgICBzdHJva2UgPSBsaW5lQ29sb3IgPT09IHVuZGVmaW5lZCA/ICcgc3Ryb2tlZD1cImZhbHNlXCIgJyA6ICcgc3Ryb2tlV2VpZ2h0PVwiJyArIGxpbmVXaWR0aCArICdweFwiIHN0cm9rZUNvbG9yPVwiJyArIGxpbmVDb2xvciArICdcIiAnO1xuICAgICAgICAgICAgZmlsbCA9IGZpbGxDb2xvciA9PT0gdW5kZWZpbmVkID8gJyBmaWxsZWQ9XCJmYWxzZVwiJyA6ICcgZmlsbENvbG9yPVwiJyArIGZpbGxDb2xvciArICdcIiBmaWxsZWQ9XCJ0cnVlXCIgJztcbiAgICAgICAgICAgIGNsb3NlZCA9IHZwYXRoWzBdID09PSB2cGF0aFt2cGF0aC5sZW5ndGggLSAxXSA/ICd4ICcgOiAnJztcbiAgICAgICAgICAgIHZlbCA9ICc8djpzaGFwZSBjb29yZG9yaWdpbj1cIjAgMFwiIGNvb3Jkc2l6ZT1cIicgKyB0aGlzLnBpeGVsV2lkdGggKyAnICcgKyB0aGlzLnBpeGVsSGVpZ2h0ICsgJ1wiICcgK1xuICAgICAgICAgICAgICAgICAnIGlkPVwianFzc2hhcGUnICsgc2hhcGVpZCArICdcIiAnICtcbiAgICAgICAgICAgICAgICAgc3Ryb2tlICtcbiAgICAgICAgICAgICAgICAgZmlsbCArXG4gICAgICAgICAgICAgICAgJyBzdHlsZT1cInBvc2l0aW9uOmFic29sdXRlO2xlZnQ6MHB4O3RvcDowcHg7aGVpZ2h0OicgKyB0aGlzLnBpeGVsSGVpZ2h0ICsgJ3B4O3dpZHRoOicgKyB0aGlzLnBpeGVsV2lkdGggKyAncHg7cGFkZGluZzowcHg7bWFyZ2luOjBweDtcIiAnICtcbiAgICAgICAgICAgICAgICAnIHBhdGg9XCJtICcgKyBpbml0aWFsICsgJyBsICcgKyB2cGF0aC5qb2luKCcsICcpICsgJyAnICsgY2xvc2VkICsgJ2VcIj4nICtcbiAgICAgICAgICAgICAgICAnIDwvdjpzaGFwZT4nO1xuICAgICAgICAgICAgcmV0dXJuIHZlbDtcbiAgICAgICAgfSxcblxuICAgICAgICBfZHJhd0NpcmNsZTogZnVuY3Rpb24gKHNoYXBlaWQsIHgsIHksIHJhZGl1cywgbGluZUNvbG9yLCBmaWxsQ29sb3IsIGxpbmVXaWR0aCkge1xuICAgICAgICAgICAgdmFyIHN0cm9rZSwgZmlsbCwgdmVsO1xuICAgICAgICAgICAgeCAtPSByYWRpdXM7XG4gICAgICAgICAgICB5IC09IHJhZGl1cztcbiAgICAgICAgICAgIHN0cm9rZSA9IGxpbmVDb2xvciA9PT0gdW5kZWZpbmVkID8gJyBzdHJva2VkPVwiZmFsc2VcIiAnIDogJyBzdHJva2VXZWlnaHQ9XCInICsgbGluZVdpZHRoICsgJ3B4XCIgc3Ryb2tlQ29sb3I9XCInICsgbGluZUNvbG9yICsgJ1wiICc7XG4gICAgICAgICAgICBmaWxsID0gZmlsbENvbG9yID09PSB1bmRlZmluZWQgPyAnIGZpbGxlZD1cImZhbHNlXCInIDogJyBmaWxsQ29sb3I9XCInICsgZmlsbENvbG9yICsgJ1wiIGZpbGxlZD1cInRydWVcIiAnO1xuICAgICAgICAgICAgdmVsID0gJzx2Om92YWwgJyArXG4gICAgICAgICAgICAgICAgICcgaWQ9XCJqcXNzaGFwZScgKyBzaGFwZWlkICsgJ1wiICcgK1xuICAgICAgICAgICAgICAgIHN0cm9rZSArXG4gICAgICAgICAgICAgICAgZmlsbCArXG4gICAgICAgICAgICAgICAgJyBzdHlsZT1cInBvc2l0aW9uOmFic29sdXRlO3RvcDonICsgeSArICdweDsgbGVmdDonICsgeCArICdweDsgd2lkdGg6JyArIChyYWRpdXMgKiAyKSArICdweDsgaGVpZ2h0OicgKyAocmFkaXVzICogMikgKyAncHhcIj48L3Y6b3ZhbD4nO1xuICAgICAgICAgICAgcmV0dXJuIHZlbDtcblxuICAgICAgICB9LFxuXG4gICAgICAgIF9kcmF3UGllU2xpY2U6IGZ1bmN0aW9uIChzaGFwZWlkLCB4LCB5LCByYWRpdXMsIHN0YXJ0QW5nbGUsIGVuZEFuZ2xlLCBsaW5lQ29sb3IsIGZpbGxDb2xvcikge1xuICAgICAgICAgICAgdmFyIHZwYXRoLCBzdGFydHgsIHN0YXJ0eSwgZW5keCwgZW5keSwgc3Ryb2tlLCBmaWxsLCB2ZWw7XG4gICAgICAgICAgICBpZiAoc3RhcnRBbmdsZSA9PT0gZW5kQW5nbGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJyc7ICAvLyBWTUwgc2VlbXMgdG8gaGF2ZSBwcm9ibGVtIHdoZW4gc3RhcnQgYW5nbGUgZXF1YWxzIGVuZCBhbmdsZS5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICgoZW5kQW5nbGUgLSBzdGFydEFuZ2xlKSA9PT0gKDIgKiBNYXRoLlBJKSkge1xuICAgICAgICAgICAgICAgIHN0YXJ0QW5nbGUgPSAwLjA7ICAvLyBWTUwgc2VlbXMgdG8gaGF2ZSBhIHByb2JsZW0gd2hlbiBkcmF3aW5nIGEgZnVsbCBjaXJjbGUgdGhhdCBkb2Vzbid0IHN0YXJ0IDBcbiAgICAgICAgICAgICAgICBlbmRBbmdsZSA9ICgyICogTWF0aC5QSSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHN0YXJ0eCA9IHggKyBNYXRoLnJvdW5kKE1hdGguY29zKHN0YXJ0QW5nbGUpICogcmFkaXVzKTtcbiAgICAgICAgICAgIHN0YXJ0eSA9IHkgKyBNYXRoLnJvdW5kKE1hdGguc2luKHN0YXJ0QW5nbGUpICogcmFkaXVzKTtcbiAgICAgICAgICAgIGVuZHggPSB4ICsgTWF0aC5yb3VuZChNYXRoLmNvcyhlbmRBbmdsZSkgKiByYWRpdXMpO1xuICAgICAgICAgICAgZW5keSA9IHkgKyBNYXRoLnJvdW5kKE1hdGguc2luKGVuZEFuZ2xlKSAqIHJhZGl1cyk7XG5cbiAgICAgICAgICAgIGlmIChzdGFydHggPT09IGVuZHggJiYgc3RhcnR5ID09PSBlbmR5KSB7XG4gICAgICAgICAgICAgICAgaWYgKChlbmRBbmdsZSAtIHN0YXJ0QW5nbGUpIDwgTWF0aC5QSSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBQcmV2ZW50IHZlcnkgc21hbGwgc2xpY2VzIGZyb20gYmVpbmcgbWlzdGFrZW4gYXMgYSB3aG9sZSBwaWVcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBlc3NlbnRpYWxseSBnb2luZyB0byBiZSB0aGUgZW50aXJlIGNpcmNsZSwgc28gaWdub3JlIHN0YXJ0QW5nbGVcbiAgICAgICAgICAgICAgICBzdGFydHggPSBlbmR4ID0geCArIHJhZGl1cztcbiAgICAgICAgICAgICAgICBzdGFydHkgPSBlbmR5ID0geTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHN0YXJ0eCA9PT0gZW5keCAmJiBzdGFydHkgPT09IGVuZHkgJiYgKGVuZEFuZ2xlIC0gc3RhcnRBbmdsZSkgPCBNYXRoLlBJKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2cGF0aCA9IFt4IC0gcmFkaXVzLCB5IC0gcmFkaXVzLCB4ICsgcmFkaXVzLCB5ICsgcmFkaXVzLCBzdGFydHgsIHN0YXJ0eSwgZW5keCwgZW5keV07XG4gICAgICAgICAgICBzdHJva2UgPSBsaW5lQ29sb3IgPT09IHVuZGVmaW5lZCA/ICcgc3Ryb2tlZD1cImZhbHNlXCIgJyA6ICcgc3Ryb2tlV2VpZ2h0PVwiMXB4XCIgc3Ryb2tlQ29sb3I9XCInICsgbGluZUNvbG9yICsgJ1wiICc7XG4gICAgICAgICAgICBmaWxsID0gZmlsbENvbG9yID09PSB1bmRlZmluZWQgPyAnIGZpbGxlZD1cImZhbHNlXCInIDogJyBmaWxsQ29sb3I9XCInICsgZmlsbENvbG9yICsgJ1wiIGZpbGxlZD1cInRydWVcIiAnO1xuICAgICAgICAgICAgdmVsID0gJzx2OnNoYXBlIGNvb3Jkb3JpZ2luPVwiMCAwXCIgY29vcmRzaXplPVwiJyArIHRoaXMucGl4ZWxXaWR0aCArICcgJyArIHRoaXMucGl4ZWxIZWlnaHQgKyAnXCIgJyArXG4gICAgICAgICAgICAgICAgICcgaWQ9XCJqcXNzaGFwZScgKyBzaGFwZWlkICsgJ1wiICcgK1xuICAgICAgICAgICAgICAgICBzdHJva2UgK1xuICAgICAgICAgICAgICAgICBmaWxsICtcbiAgICAgICAgICAgICAgICAnIHN0eWxlPVwicG9zaXRpb246YWJzb2x1dGU7bGVmdDowcHg7dG9wOjBweDtoZWlnaHQ6JyArIHRoaXMucGl4ZWxIZWlnaHQgKyAncHg7d2lkdGg6JyArIHRoaXMucGl4ZWxXaWR0aCArICdweDtwYWRkaW5nOjBweDttYXJnaW46MHB4O1wiICcgK1xuICAgICAgICAgICAgICAgICcgcGF0aD1cIm0gJyArIHggKyAnLCcgKyB5ICsgJyB3YSAnICsgdnBhdGguam9pbignLCAnKSArICcgeCBlXCI+JyArXG4gICAgICAgICAgICAgICAgJyA8L3Y6c2hhcGU+JztcbiAgICAgICAgICAgIHJldHVybiB2ZWw7XG4gICAgICAgIH0sXG5cbiAgICAgICAgX2RyYXdSZWN0OiBmdW5jdGlvbiAoc2hhcGVpZCwgeCwgeSwgd2lkdGgsIGhlaWdodCwgbGluZUNvbG9yLCBmaWxsQ29sb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9kcmF3U2hhcGUoc2hhcGVpZCwgW1t4LCB5XSwgW3gsIHkgKyBoZWlnaHRdLCBbeCArIHdpZHRoLCB5ICsgaGVpZ2h0XSwgW3ggKyB3aWR0aCwgeV0sIFt4LCB5XV0sIGxpbmVDb2xvciwgZmlsbENvbG9yKTtcbiAgICAgICAgfSxcblxuICAgICAgICByZXNldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5ncm91cC5pbm5lckhUTUwgPSAnJztcbiAgICAgICAgfSxcblxuICAgICAgICBhcHBlbmRTaGFwZTogZnVuY3Rpb24gKHNoYXBlKSB7XG4gICAgICAgICAgICB2YXIgdmVsID0gdGhpc1snX2RyYXcnICsgc2hhcGUudHlwZV0uYXBwbHkodGhpcywgc2hhcGUuYXJncyk7XG4gICAgICAgICAgICBpZiAodGhpcy5yZW5kZXJlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZ3JvdXAuaW5zZXJ0QWRqYWNlbnRIVE1MKCdiZWZvcmVFbmQnLCB2ZWwpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByZXJlbmRlciArPSB2ZWw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmxhc3RTaGFwZUlkID0gc2hhcGUuaWQ7XG4gICAgICAgICAgICByZXR1cm4gc2hhcGUuaWQ7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVwbGFjZVdpdGhTaGFwZTogZnVuY3Rpb24gKHNoYXBlaWQsIHNoYXBlKSB7XG4gICAgICAgICAgICB2YXIgZXhpc3RpbmcgPSAkKCcjanFzc2hhcGUnICsgc2hhcGVpZCksXG4gICAgICAgICAgICAgICAgdmVsID0gdGhpc1snX2RyYXcnICsgc2hhcGUudHlwZV0uYXBwbHkodGhpcywgc2hhcGUuYXJncyk7XG4gICAgICAgICAgICBleGlzdGluZ1swXS5vdXRlckhUTUwgPSB2ZWw7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVwbGFjZVdpdGhTaGFwZXM6IGZ1bmN0aW9uIChzaGFwZWlkcywgc2hhcGVzKSB7XG4gICAgICAgICAgICAvLyByZXBsYWNlIHRoZSBmaXJzdCBzaGFwZWlkIHdpdGggYWxsIHRoZSBuZXcgc2hhcGVzIHRoZW4gdG9hc3QgdGhlIHJlbWFpbmluZyBvbGQgc2hhcGVzXG4gICAgICAgICAgICB2YXIgZXhpc3RpbmcgPSAkKCcjanFzc2hhcGUnICsgc2hhcGVpZHNbMF0pLFxuICAgICAgICAgICAgICAgIHJlcGxhY2UgPSAnJyxcbiAgICAgICAgICAgICAgICBzbGVuID0gc2hhcGVzLmxlbmd0aCxcbiAgICAgICAgICAgICAgICBpO1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHNsZW47IGkrKykge1xuICAgICAgICAgICAgICAgIHJlcGxhY2UgKz0gdGhpc1snX2RyYXcnICsgc2hhcGVzW2ldLnR5cGVdLmFwcGx5KHRoaXMsIHNoYXBlc1tpXS5hcmdzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGV4aXN0aW5nWzBdLm91dGVySFRNTCA9IHJlcGxhY2U7XG4gICAgICAgICAgICBmb3IgKGkgPSAxOyBpIDwgc2hhcGVpZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAkKCcjanFzc2hhcGUnICsgc2hhcGVpZHNbaV0pLnJlbW92ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIGluc2VydEFmdGVyU2hhcGU6IGZ1bmN0aW9uIChzaGFwZWlkLCBzaGFwZSkge1xuICAgICAgICAgICAgdmFyIGV4aXN0aW5nID0gJCgnI2pxc3NoYXBlJyArIHNoYXBlaWQpLFxuICAgICAgICAgICAgICAgICB2ZWwgPSB0aGlzWydfZHJhdycgKyBzaGFwZS50eXBlXS5hcHBseSh0aGlzLCBzaGFwZS5hcmdzKTtcbiAgICAgICAgICAgIGV4aXN0aW5nWzBdLmluc2VydEFkamFjZW50SFRNTCgnYWZ0ZXJFbmQnLCB2ZWwpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlbW92ZVNoYXBlSWQ6IGZ1bmN0aW9uIChzaGFwZWlkKSB7XG4gICAgICAgICAgICB2YXIgZXhpc3RpbmcgPSAkKCcjanFzc2hhcGUnICsgc2hhcGVpZCk7XG4gICAgICAgICAgICB0aGlzLmdyb3VwLnJlbW92ZUNoaWxkKGV4aXN0aW5nWzBdKTtcbiAgICAgICAgfSxcblxuICAgICAgICBnZXRTaGFwZUF0OiBmdW5jdGlvbiAoZWwsIHgsIHkpIHtcbiAgICAgICAgICAgIHZhciBzaGFwZWlkID0gZWwuaWQuc3Vic3RyKDgpO1xuICAgICAgICAgICAgcmV0dXJuIHNoYXBlaWQ7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMucmVuZGVyZWQpIHtcbiAgICAgICAgICAgICAgICAvLyBiYXRjaCB0aGUgaW50aWFsIHJlbmRlciBpbnRvIGEgc2luZ2xlIHJlcGFpbnRcbiAgICAgICAgICAgICAgICB0aGlzLmdyb3VwLmlubmVySFRNTCA9IHRoaXMucHJlcmVuZGVyO1xuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyZWQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG5cbn0pKX0oZG9jdW1lbnQsIE1hdGgpKTtcbiIsIi8qIVxuICogbXVzdGFjaGUuanMgLSBMb2dpYy1sZXNzIHt7bXVzdGFjaGV9fSB0ZW1wbGF0ZXMgd2l0aCBKYXZhU2NyaXB0XG4gKiBodHRwOi8vZ2l0aHViLmNvbS9qYW5sL211c3RhY2hlLmpzXG4gKi9cblxuLypnbG9iYWwgZGVmaW5lOiBmYWxzZSBNdXN0YWNoZTogdHJ1ZSovXG5cbihmdW5jdGlvbiBkZWZpbmVNdXN0YWNoZSAoZ2xvYmFsLCBmYWN0b3J5KSB7XG4gIGlmICh0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgZXhwb3J0cyAmJiB0eXBlb2YgZXhwb3J0cy5ub2RlTmFtZSAhPT0gJ3N0cmluZycpIHtcbiAgICBmYWN0b3J5KGV4cG9ydHMpOyAvLyBDb21tb25KU1xuICB9IGVsc2UgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuICAgIGRlZmluZShbJ2V4cG9ydHMnXSwgZmFjdG9yeSk7IC8vIEFNRFxuICB9IGVsc2Uge1xuICAgIGdsb2JhbC5NdXN0YWNoZSA9IHt9O1xuICAgIGZhY3RvcnkoZ2xvYmFsLk11c3RhY2hlKTsgLy8gc2NyaXB0LCB3c2gsIGFzcFxuICB9XG59KHRoaXMsIGZ1bmN0aW9uIG11c3RhY2hlRmFjdG9yeSAobXVzdGFjaGUpIHtcblxuICB2YXIgb2JqZWN0VG9TdHJpbmcgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO1xuICB2YXIgaXNBcnJheSA9IEFycmF5LmlzQXJyYXkgfHwgZnVuY3Rpb24gaXNBcnJheVBvbHlmaWxsIChvYmplY3QpIHtcbiAgICByZXR1cm4gb2JqZWN0VG9TdHJpbmcuY2FsbChvYmplY3QpID09PSAnW29iamVjdCBBcnJheV0nO1xuICB9O1xuXG4gIGZ1bmN0aW9uIGlzRnVuY3Rpb24gKG9iamVjdCkge1xuICAgIHJldHVybiB0eXBlb2Ygb2JqZWN0ID09PSAnZnVuY3Rpb24nO1xuICB9XG5cbiAgLyoqXG4gICAqIE1vcmUgY29ycmVjdCB0eXBlb2Ygc3RyaW5nIGhhbmRsaW5nIGFycmF5XG4gICAqIHdoaWNoIG5vcm1hbGx5IHJldHVybnMgdHlwZW9mICdvYmplY3QnXG4gICAqL1xuICBmdW5jdGlvbiB0eXBlU3RyIChvYmopIHtcbiAgICByZXR1cm4gaXNBcnJheShvYmopID8gJ2FycmF5JyA6IHR5cGVvZiBvYmo7XG4gIH1cblxuICBmdW5jdGlvbiBlc2NhcGVSZWdFeHAgKHN0cmluZykge1xuICAgIHJldHVybiBzdHJpbmcucmVwbGFjZSgvW1xcLVxcW1xcXXt9KCkqKz8uLFxcXFxcXF4kfCNcXHNdL2csICdcXFxcJCYnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBOdWxsIHNhZmUgd2F5IG9mIGNoZWNraW5nIHdoZXRoZXIgb3Igbm90IGFuIG9iamVjdCxcbiAgICogaW5jbHVkaW5nIGl0cyBwcm90b3R5cGUsIGhhcyBhIGdpdmVuIHByb3BlcnR5XG4gICAqL1xuICBmdW5jdGlvbiBoYXNQcm9wZXJ0eSAob2JqLCBwcm9wTmFtZSkge1xuICAgIHJldHVybiBvYmogIT0gbnVsbCAmJiB0eXBlb2Ygb2JqID09PSAnb2JqZWN0JyAmJiAocHJvcE5hbWUgaW4gb2JqKTtcbiAgfVxuXG4gIC8vIFdvcmthcm91bmQgZm9yIGh0dHBzOi8vaXNzdWVzLmFwYWNoZS5vcmcvamlyYS9icm93c2UvQ09VQ0hEQi01NzdcbiAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9qYW5sL211c3RhY2hlLmpzL2lzc3Vlcy8xODlcbiAgdmFyIHJlZ0V4cFRlc3QgPSBSZWdFeHAucHJvdG90eXBlLnRlc3Q7XG4gIGZ1bmN0aW9uIHRlc3RSZWdFeHAgKHJlLCBzdHJpbmcpIHtcbiAgICByZXR1cm4gcmVnRXhwVGVzdC5jYWxsKHJlLCBzdHJpbmcpO1xuICB9XG5cbiAgdmFyIG5vblNwYWNlUmUgPSAvXFxTLztcbiAgZnVuY3Rpb24gaXNXaGl0ZXNwYWNlIChzdHJpbmcpIHtcbiAgICByZXR1cm4gIXRlc3RSZWdFeHAobm9uU3BhY2VSZSwgc3RyaW5nKTtcbiAgfVxuXG4gIHZhciBlbnRpdHlNYXAgPSB7XG4gICAgJyYnOiAnJmFtcDsnLFxuICAgICc8JzogJyZsdDsnLFxuICAgICc+JzogJyZndDsnLFxuICAgICdcIic6ICcmcXVvdDsnLFxuICAgIFwiJ1wiOiAnJiMzOTsnLFxuICAgICcvJzogJyYjeDJGOycsXG4gICAgJ2AnOiAnJiN4NjA7JyxcbiAgICAnPSc6ICcmI3gzRDsnXG4gIH07XG5cbiAgZnVuY3Rpb24gZXNjYXBlSHRtbCAoc3RyaW5nKSB7XG4gICAgcmV0dXJuIFN0cmluZyhzdHJpbmcpLnJlcGxhY2UoL1smPD5cIidgPVxcL10vZywgZnVuY3Rpb24gZnJvbUVudGl0eU1hcCAocykge1xuICAgICAgcmV0dXJuIGVudGl0eU1hcFtzXTtcbiAgICB9KTtcbiAgfVxuXG4gIHZhciB3aGl0ZVJlID0gL1xccyovO1xuICB2YXIgc3BhY2VSZSA9IC9cXHMrLztcbiAgdmFyIGVxdWFsc1JlID0gL1xccyo9LztcbiAgdmFyIGN1cmx5UmUgPSAvXFxzKlxcfS87XG4gIHZhciB0YWdSZSA9IC8jfFxcXnxcXC98PnxcXHt8Jnw9fCEvO1xuXG4gIC8qKlxuICAgKiBCcmVha3MgdXAgdGhlIGdpdmVuIGB0ZW1wbGF0ZWAgc3RyaW5nIGludG8gYSB0cmVlIG9mIHRva2Vucy4gSWYgdGhlIGB0YWdzYFxuICAgKiBhcmd1bWVudCBpcyBnaXZlbiBoZXJlIGl0IG11c3QgYmUgYW4gYXJyYXkgd2l0aCB0d28gc3RyaW5nIHZhbHVlczogdGhlXG4gICAqIG9wZW5pbmcgYW5kIGNsb3NpbmcgdGFncyB1c2VkIGluIHRoZSB0ZW1wbGF0ZSAoZS5nLiBbIFwiPCVcIiwgXCIlPlwiIF0pLiBPZlxuICAgKiBjb3Vyc2UsIHRoZSBkZWZhdWx0IGlzIHRvIHVzZSBtdXN0YWNoZXMgKGkuZS4gbXVzdGFjaGUudGFncykuXG4gICAqXG4gICAqIEEgdG9rZW4gaXMgYW4gYXJyYXkgd2l0aCBhdCBsZWFzdCA0IGVsZW1lbnRzLiBUaGUgZmlyc3QgZWxlbWVudCBpcyB0aGVcbiAgICogbXVzdGFjaGUgc3ltYm9sIHRoYXQgd2FzIHVzZWQgaW5zaWRlIHRoZSB0YWcsIGUuZy4gXCIjXCIgb3IgXCImXCIuIElmIHRoZSB0YWdcbiAgICogZGlkIG5vdCBjb250YWluIGEgc3ltYm9sIChpLmUuIHt7bXlWYWx1ZX19KSB0aGlzIGVsZW1lbnQgaXMgXCJuYW1lXCIuIEZvclxuICAgKiBhbGwgdGV4dCB0aGF0IGFwcGVhcnMgb3V0c2lkZSBhIHN5bWJvbCB0aGlzIGVsZW1lbnQgaXMgXCJ0ZXh0XCIuXG4gICAqXG4gICAqIFRoZSBzZWNvbmQgZWxlbWVudCBvZiBhIHRva2VuIGlzIGl0cyBcInZhbHVlXCIuIEZvciBtdXN0YWNoZSB0YWdzIHRoaXMgaXNcbiAgICogd2hhdGV2ZXIgZWxzZSB3YXMgaW5zaWRlIHRoZSB0YWcgYmVzaWRlcyB0aGUgb3BlbmluZyBzeW1ib2wuIEZvciB0ZXh0IHRva2Vuc1xuICAgKiB0aGlzIGlzIHRoZSB0ZXh0IGl0c2VsZi5cbiAgICpcbiAgICogVGhlIHRoaXJkIGFuZCBmb3VydGggZWxlbWVudHMgb2YgdGhlIHRva2VuIGFyZSB0aGUgc3RhcnQgYW5kIGVuZCBpbmRpY2VzLFxuICAgKiByZXNwZWN0aXZlbHksIG9mIHRoZSB0b2tlbiBpbiB0aGUgb3JpZ2luYWwgdGVtcGxhdGUuXG4gICAqXG4gICAqIFRva2VucyB0aGF0IGFyZSB0aGUgcm9vdCBub2RlIG9mIGEgc3VidHJlZSBjb250YWluIHR3byBtb3JlIGVsZW1lbnRzOiAxKSBhblxuICAgKiBhcnJheSBvZiB0b2tlbnMgaW4gdGhlIHN1YnRyZWUgYW5kIDIpIHRoZSBpbmRleCBpbiB0aGUgb3JpZ2luYWwgdGVtcGxhdGUgYXRcbiAgICogd2hpY2ggdGhlIGNsb3NpbmcgdGFnIGZvciB0aGF0IHNlY3Rpb24gYmVnaW5zLlxuICAgKi9cbiAgZnVuY3Rpb24gcGFyc2VUZW1wbGF0ZSAodGVtcGxhdGUsIHRhZ3MpIHtcbiAgICBpZiAoIXRlbXBsYXRlKVxuICAgICAgcmV0dXJuIFtdO1xuXG4gICAgdmFyIHNlY3Rpb25zID0gW107ICAgICAvLyBTdGFjayB0byBob2xkIHNlY3Rpb24gdG9rZW5zXG4gICAgdmFyIHRva2VucyA9IFtdOyAgICAgICAvLyBCdWZmZXIgdG8gaG9sZCB0aGUgdG9rZW5zXG4gICAgdmFyIHNwYWNlcyA9IFtdOyAgICAgICAvLyBJbmRpY2VzIG9mIHdoaXRlc3BhY2UgdG9rZW5zIG9uIHRoZSBjdXJyZW50IGxpbmVcbiAgICB2YXIgaGFzVGFnID0gZmFsc2U7ICAgIC8vIElzIHRoZXJlIGEge3t0YWd9fSBvbiB0aGUgY3VycmVudCBsaW5lP1xuICAgIHZhciBub25TcGFjZSA9IGZhbHNlOyAgLy8gSXMgdGhlcmUgYSBub24tc3BhY2UgY2hhciBvbiB0aGUgY3VycmVudCBsaW5lP1xuXG4gICAgLy8gU3RyaXBzIGFsbCB3aGl0ZXNwYWNlIHRva2VucyBhcnJheSBmb3IgdGhlIGN1cnJlbnQgbGluZVxuICAgIC8vIGlmIHRoZXJlIHdhcyBhIHt7I3RhZ319IG9uIGl0IGFuZCBvdGhlcndpc2Ugb25seSBzcGFjZS5cbiAgICBmdW5jdGlvbiBzdHJpcFNwYWNlICgpIHtcbiAgICAgIGlmIChoYXNUYWcgJiYgIW5vblNwYWNlKSB7XG4gICAgICAgIHdoaWxlIChzcGFjZXMubGVuZ3RoKVxuICAgICAgICAgIGRlbGV0ZSB0b2tlbnNbc3BhY2VzLnBvcCgpXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNwYWNlcyA9IFtdO1xuICAgICAgfVxuXG4gICAgICBoYXNUYWcgPSBmYWxzZTtcbiAgICAgIG5vblNwYWNlID0gZmFsc2U7XG4gICAgfVxuXG4gICAgdmFyIG9wZW5pbmdUYWdSZSwgY2xvc2luZ1RhZ1JlLCBjbG9zaW5nQ3VybHlSZTtcbiAgICBmdW5jdGlvbiBjb21waWxlVGFncyAodGFnc1RvQ29tcGlsZSkge1xuICAgICAgaWYgKHR5cGVvZiB0YWdzVG9Db21waWxlID09PSAnc3RyaW5nJylcbiAgICAgICAgdGFnc1RvQ29tcGlsZSA9IHRhZ3NUb0NvbXBpbGUuc3BsaXQoc3BhY2VSZSwgMik7XG5cbiAgICAgIGlmICghaXNBcnJheSh0YWdzVG9Db21waWxlKSB8fCB0YWdzVG9Db21waWxlLmxlbmd0aCAhPT0gMilcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHRhZ3M6ICcgKyB0YWdzVG9Db21waWxlKTtcblxuICAgICAgb3BlbmluZ1RhZ1JlID0gbmV3IFJlZ0V4cChlc2NhcGVSZWdFeHAodGFnc1RvQ29tcGlsZVswXSkgKyAnXFxcXHMqJyk7XG4gICAgICBjbG9zaW5nVGFnUmUgPSBuZXcgUmVnRXhwKCdcXFxccyonICsgZXNjYXBlUmVnRXhwKHRhZ3NUb0NvbXBpbGVbMV0pKTtcbiAgICAgIGNsb3NpbmdDdXJseVJlID0gbmV3IFJlZ0V4cCgnXFxcXHMqJyArIGVzY2FwZVJlZ0V4cCgnfScgKyB0YWdzVG9Db21waWxlWzFdKSk7XG4gICAgfVxuXG4gICAgY29tcGlsZVRhZ3ModGFncyB8fCBtdXN0YWNoZS50YWdzKTtcblxuICAgIHZhciBzY2FubmVyID0gbmV3IFNjYW5uZXIodGVtcGxhdGUpO1xuXG4gICAgdmFyIHN0YXJ0LCB0eXBlLCB2YWx1ZSwgY2hyLCB0b2tlbiwgb3BlblNlY3Rpb247XG4gICAgd2hpbGUgKCFzY2FubmVyLmVvcygpKSB7XG4gICAgICBzdGFydCA9IHNjYW5uZXIucG9zO1xuXG4gICAgICAvLyBNYXRjaCBhbnkgdGV4dCBiZXR3ZWVuIHRhZ3MuXG4gICAgICB2YWx1ZSA9IHNjYW5uZXIuc2NhblVudGlsKG9wZW5pbmdUYWdSZSk7XG5cbiAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgdmFsdWVMZW5ndGggPSB2YWx1ZS5sZW5ndGg7IGkgPCB2YWx1ZUxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgY2hyID0gdmFsdWUuY2hhckF0KGkpO1xuXG4gICAgICAgICAgaWYgKGlzV2hpdGVzcGFjZShjaHIpKSB7XG4gICAgICAgICAgICBzcGFjZXMucHVzaCh0b2tlbnMubGVuZ3RoKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbm9uU3BhY2UgPSB0cnVlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHRva2Vucy5wdXNoKFsgJ3RleHQnLCBjaHIsIHN0YXJ0LCBzdGFydCArIDEgXSk7XG4gICAgICAgICAgc3RhcnQgKz0gMTtcblxuICAgICAgICAgIC8vIENoZWNrIGZvciB3aGl0ZXNwYWNlIG9uIHRoZSBjdXJyZW50IGxpbmUuXG4gICAgICAgICAgaWYgKGNociA9PT0gJ1xcbicpXG4gICAgICAgICAgICBzdHJpcFNwYWNlKCk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gTWF0Y2ggdGhlIG9wZW5pbmcgdGFnLlxuICAgICAgaWYgKCFzY2FubmVyLnNjYW4ob3BlbmluZ1RhZ1JlKSlcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGhhc1RhZyA9IHRydWU7XG5cbiAgICAgIC8vIEdldCB0aGUgdGFnIHR5cGUuXG4gICAgICB0eXBlID0gc2Nhbm5lci5zY2FuKHRhZ1JlKSB8fCAnbmFtZSc7XG4gICAgICBzY2FubmVyLnNjYW4od2hpdGVSZSk7XG5cbiAgICAgIC8vIEdldCB0aGUgdGFnIHZhbHVlLlxuICAgICAgaWYgKHR5cGUgPT09ICc9Jykge1xuICAgICAgICB2YWx1ZSA9IHNjYW5uZXIuc2NhblVudGlsKGVxdWFsc1JlKTtcbiAgICAgICAgc2Nhbm5lci5zY2FuKGVxdWFsc1JlKTtcbiAgICAgICAgc2Nhbm5lci5zY2FuVW50aWwoY2xvc2luZ1RhZ1JlKTtcbiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ3snKSB7XG4gICAgICAgIHZhbHVlID0gc2Nhbm5lci5zY2FuVW50aWwoY2xvc2luZ0N1cmx5UmUpO1xuICAgICAgICBzY2FubmVyLnNjYW4oY3VybHlSZSk7XG4gICAgICAgIHNjYW5uZXIuc2NhblVudGlsKGNsb3NpbmdUYWdSZSk7XG4gICAgICAgIHR5cGUgPSAnJic7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YWx1ZSA9IHNjYW5uZXIuc2NhblVudGlsKGNsb3NpbmdUYWdSZSk7XG4gICAgICB9XG5cbiAgICAgIC8vIE1hdGNoIHRoZSBjbG9zaW5nIHRhZy5cbiAgICAgIGlmICghc2Nhbm5lci5zY2FuKGNsb3NpbmdUYWdSZSkpXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignVW5jbG9zZWQgdGFnIGF0ICcgKyBzY2FubmVyLnBvcyk7XG5cbiAgICAgIHRva2VuID0gWyB0eXBlLCB2YWx1ZSwgc3RhcnQsIHNjYW5uZXIucG9zIF07XG4gICAgICB0b2tlbnMucHVzaCh0b2tlbik7XG5cbiAgICAgIGlmICh0eXBlID09PSAnIycgfHwgdHlwZSA9PT0gJ14nKSB7XG4gICAgICAgIHNlY3Rpb25zLnB1c2godG9rZW4pO1xuICAgICAgfSBlbHNlIGlmICh0eXBlID09PSAnLycpIHtcbiAgICAgICAgLy8gQ2hlY2sgc2VjdGlvbiBuZXN0aW5nLlxuICAgICAgICBvcGVuU2VjdGlvbiA9IHNlY3Rpb25zLnBvcCgpO1xuXG4gICAgICAgIGlmICghb3BlblNlY3Rpb24pXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdVbm9wZW5lZCBzZWN0aW9uIFwiJyArIHZhbHVlICsgJ1wiIGF0ICcgKyBzdGFydCk7XG5cbiAgICAgICAgaWYgKG9wZW5TZWN0aW9uWzFdICE9PSB2YWx1ZSlcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VuY2xvc2VkIHNlY3Rpb24gXCInICsgb3BlblNlY3Rpb25bMV0gKyAnXCIgYXQgJyArIHN0YXJ0KTtcbiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ25hbWUnIHx8IHR5cGUgPT09ICd7JyB8fCB0eXBlID09PSAnJicpIHtcbiAgICAgICAgbm9uU3BhY2UgPSB0cnVlO1xuICAgICAgfSBlbHNlIGlmICh0eXBlID09PSAnPScpIHtcbiAgICAgICAgLy8gU2V0IHRoZSB0YWdzIGZvciB0aGUgbmV4dCB0aW1lIGFyb3VuZC5cbiAgICAgICAgY29tcGlsZVRhZ3ModmFsdWUpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIE1ha2Ugc3VyZSB0aGVyZSBhcmUgbm8gb3BlbiBzZWN0aW9ucyB3aGVuIHdlJ3JlIGRvbmUuXG4gICAgb3BlblNlY3Rpb24gPSBzZWN0aW9ucy5wb3AoKTtcblxuICAgIGlmIChvcGVuU2VjdGlvbilcbiAgICAgIHRocm93IG5ldyBFcnJvcignVW5jbG9zZWQgc2VjdGlvbiBcIicgKyBvcGVuU2VjdGlvblsxXSArICdcIiBhdCAnICsgc2Nhbm5lci5wb3MpO1xuXG4gICAgcmV0dXJuIG5lc3RUb2tlbnMoc3F1YXNoVG9rZW5zKHRva2VucykpO1xuICB9XG5cbiAgLyoqXG4gICAqIENvbWJpbmVzIHRoZSB2YWx1ZXMgb2YgY29uc2VjdXRpdmUgdGV4dCB0b2tlbnMgaW4gdGhlIGdpdmVuIGB0b2tlbnNgIGFycmF5XG4gICAqIHRvIGEgc2luZ2xlIHRva2VuLlxuICAgKi9cbiAgZnVuY3Rpb24gc3F1YXNoVG9rZW5zICh0b2tlbnMpIHtcbiAgICB2YXIgc3F1YXNoZWRUb2tlbnMgPSBbXTtcblxuICAgIHZhciB0b2tlbiwgbGFzdFRva2VuO1xuICAgIGZvciAodmFyIGkgPSAwLCBudW1Ub2tlbnMgPSB0b2tlbnMubGVuZ3RoOyBpIDwgbnVtVG9rZW5zOyArK2kpIHtcbiAgICAgIHRva2VuID0gdG9rZW5zW2ldO1xuXG4gICAgICBpZiAodG9rZW4pIHtcbiAgICAgICAgaWYgKHRva2VuWzBdID09PSAndGV4dCcgJiYgbGFzdFRva2VuICYmIGxhc3RUb2tlblswXSA9PT0gJ3RleHQnKSB7XG4gICAgICAgICAgbGFzdFRva2VuWzFdICs9IHRva2VuWzFdO1xuICAgICAgICAgIGxhc3RUb2tlblszXSA9IHRva2VuWzNdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHNxdWFzaGVkVG9rZW5zLnB1c2godG9rZW4pO1xuICAgICAgICAgIGxhc3RUb2tlbiA9IHRva2VuO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHNxdWFzaGVkVG9rZW5zO1xuICB9XG5cbiAgLyoqXG4gICAqIEZvcm1zIHRoZSBnaXZlbiBhcnJheSBvZiBgdG9rZW5zYCBpbnRvIGEgbmVzdGVkIHRyZWUgc3RydWN0dXJlIHdoZXJlXG4gICAqIHRva2VucyB0aGF0IHJlcHJlc2VudCBhIHNlY3Rpb24gaGF2ZSB0d28gYWRkaXRpb25hbCBpdGVtczogMSkgYW4gYXJyYXkgb2ZcbiAgICogYWxsIHRva2VucyB0aGF0IGFwcGVhciBpbiB0aGF0IHNlY3Rpb24gYW5kIDIpIHRoZSBpbmRleCBpbiB0aGUgb3JpZ2luYWxcbiAgICogdGVtcGxhdGUgdGhhdCByZXByZXNlbnRzIHRoZSBlbmQgb2YgdGhhdCBzZWN0aW9uLlxuICAgKi9cbiAgZnVuY3Rpb24gbmVzdFRva2VucyAodG9rZW5zKSB7XG4gICAgdmFyIG5lc3RlZFRva2VucyA9IFtdO1xuICAgIHZhciBjb2xsZWN0b3IgPSBuZXN0ZWRUb2tlbnM7XG4gICAgdmFyIHNlY3Rpb25zID0gW107XG5cbiAgICB2YXIgdG9rZW4sIHNlY3Rpb247XG4gICAgZm9yICh2YXIgaSA9IDAsIG51bVRva2VucyA9IHRva2Vucy5sZW5ndGg7IGkgPCBudW1Ub2tlbnM7ICsraSkge1xuICAgICAgdG9rZW4gPSB0b2tlbnNbaV07XG5cbiAgICAgIHN3aXRjaCAodG9rZW5bMF0pIHtcbiAgICAgICAgY2FzZSAnIyc6XG4gICAgICAgIGNhc2UgJ14nOlxuICAgICAgICAgIGNvbGxlY3Rvci5wdXNoKHRva2VuKTtcbiAgICAgICAgICBzZWN0aW9ucy5wdXNoKHRva2VuKTtcbiAgICAgICAgICBjb2xsZWN0b3IgPSB0b2tlbls0XSA9IFtdO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICcvJzpcbiAgICAgICAgICBzZWN0aW9uID0gc2VjdGlvbnMucG9wKCk7XG4gICAgICAgICAgc2VjdGlvbls1XSA9IHRva2VuWzJdO1xuICAgICAgICAgIGNvbGxlY3RvciA9IHNlY3Rpb25zLmxlbmd0aCA+IDAgPyBzZWN0aW9uc1tzZWN0aW9ucy5sZW5ndGggLSAxXVs0XSA6IG5lc3RlZFRva2VucztcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICBjb2xsZWN0b3IucHVzaCh0b2tlbik7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIG5lc3RlZFRva2VucztcbiAgfVxuXG4gIC8qKlxuICAgKiBBIHNpbXBsZSBzdHJpbmcgc2Nhbm5lciB0aGF0IGlzIHVzZWQgYnkgdGhlIHRlbXBsYXRlIHBhcnNlciB0byBmaW5kXG4gICAqIHRva2VucyBpbiB0ZW1wbGF0ZSBzdHJpbmdzLlxuICAgKi9cbiAgZnVuY3Rpb24gU2Nhbm5lciAoc3RyaW5nKSB7XG4gICAgdGhpcy5zdHJpbmcgPSBzdHJpbmc7XG4gICAgdGhpcy50YWlsID0gc3RyaW5nO1xuICAgIHRoaXMucG9zID0gMDtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgdGFpbCBpcyBlbXB0eSAoZW5kIG9mIHN0cmluZykuXG4gICAqL1xuICBTY2FubmVyLnByb3RvdHlwZS5lb3MgPSBmdW5jdGlvbiBlb3MgKCkge1xuICAgIHJldHVybiB0aGlzLnRhaWwgPT09ICcnO1xuICB9O1xuXG4gIC8qKlxuICAgKiBUcmllcyB0byBtYXRjaCB0aGUgZ2l2ZW4gcmVndWxhciBleHByZXNzaW9uIGF0IHRoZSBjdXJyZW50IHBvc2l0aW9uLlxuICAgKiBSZXR1cm5zIHRoZSBtYXRjaGVkIHRleHQgaWYgaXQgY2FuIG1hdGNoLCB0aGUgZW1wdHkgc3RyaW5nIG90aGVyd2lzZS5cbiAgICovXG4gIFNjYW5uZXIucHJvdG90eXBlLnNjYW4gPSBmdW5jdGlvbiBzY2FuIChyZSkge1xuICAgIHZhciBtYXRjaCA9IHRoaXMudGFpbC5tYXRjaChyZSk7XG5cbiAgICBpZiAoIW1hdGNoIHx8IG1hdGNoLmluZGV4ICE9PSAwKVxuICAgICAgcmV0dXJuICcnO1xuXG4gICAgdmFyIHN0cmluZyA9IG1hdGNoWzBdO1xuXG4gICAgdGhpcy50YWlsID0gdGhpcy50YWlsLnN1YnN0cmluZyhzdHJpbmcubGVuZ3RoKTtcbiAgICB0aGlzLnBvcyArPSBzdHJpbmcubGVuZ3RoO1xuXG4gICAgcmV0dXJuIHN0cmluZztcbiAgfTtcblxuICAvKipcbiAgICogU2tpcHMgYWxsIHRleHQgdW50aWwgdGhlIGdpdmVuIHJlZ3VsYXIgZXhwcmVzc2lvbiBjYW4gYmUgbWF0Y2hlZC4gUmV0dXJuc1xuICAgKiB0aGUgc2tpcHBlZCBzdHJpbmcsIHdoaWNoIGlzIHRoZSBlbnRpcmUgdGFpbCBpZiBubyBtYXRjaCBjYW4gYmUgbWFkZS5cbiAgICovXG4gIFNjYW5uZXIucHJvdG90eXBlLnNjYW5VbnRpbCA9IGZ1bmN0aW9uIHNjYW5VbnRpbCAocmUpIHtcbiAgICB2YXIgaW5kZXggPSB0aGlzLnRhaWwuc2VhcmNoKHJlKSwgbWF0Y2g7XG5cbiAgICBzd2l0Y2ggKGluZGV4KSB7XG4gICAgICBjYXNlIC0xOlxuICAgICAgICBtYXRjaCA9IHRoaXMudGFpbDtcbiAgICAgICAgdGhpcy50YWlsID0gJyc7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAwOlxuICAgICAgICBtYXRjaCA9ICcnO1xuICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIG1hdGNoID0gdGhpcy50YWlsLnN1YnN0cmluZygwLCBpbmRleCk7XG4gICAgICAgIHRoaXMudGFpbCA9IHRoaXMudGFpbC5zdWJzdHJpbmcoaW5kZXgpO1xuICAgIH1cblxuICAgIHRoaXMucG9zICs9IG1hdGNoLmxlbmd0aDtcblxuICAgIHJldHVybiBtYXRjaDtcbiAgfTtcblxuICAvKipcbiAgICogUmVwcmVzZW50cyBhIHJlbmRlcmluZyBjb250ZXh0IGJ5IHdyYXBwaW5nIGEgdmlldyBvYmplY3QgYW5kXG4gICAqIG1haW50YWluaW5nIGEgcmVmZXJlbmNlIHRvIHRoZSBwYXJlbnQgY29udGV4dC5cbiAgICovXG4gIGZ1bmN0aW9uIENvbnRleHQgKHZpZXcsIHBhcmVudENvbnRleHQpIHtcbiAgICB0aGlzLnZpZXcgPSB2aWV3O1xuICAgIHRoaXMuY2FjaGUgPSB7ICcuJzogdGhpcy52aWV3IH07XG4gICAgdGhpcy5wYXJlbnQgPSBwYXJlbnRDb250ZXh0O1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYSBuZXcgY29udGV4dCB1c2luZyB0aGUgZ2l2ZW4gdmlldyB3aXRoIHRoaXMgY29udGV4dFxuICAgKiBhcyB0aGUgcGFyZW50LlxuICAgKi9cbiAgQ29udGV4dC5wcm90b3R5cGUucHVzaCA9IGZ1bmN0aW9uIHB1c2ggKHZpZXcpIHtcbiAgICByZXR1cm4gbmV3IENvbnRleHQodmlldywgdGhpcyk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIHZhbHVlIG9mIHRoZSBnaXZlbiBuYW1lIGluIHRoaXMgY29udGV4dCwgdHJhdmVyc2luZ1xuICAgKiB1cCB0aGUgY29udGV4dCBoaWVyYXJjaHkgaWYgdGhlIHZhbHVlIGlzIGFic2VudCBpbiB0aGlzIGNvbnRleHQncyB2aWV3LlxuICAgKi9cbiAgQ29udGV4dC5wcm90b3R5cGUubG9va3VwID0gZnVuY3Rpb24gbG9va3VwIChuYW1lKSB7XG4gICAgdmFyIGNhY2hlID0gdGhpcy5jYWNoZTtcblxuICAgIHZhciB2YWx1ZTtcbiAgICBpZiAoY2FjaGUuaGFzT3duUHJvcGVydHkobmFtZSkpIHtcbiAgICAgIHZhbHVlID0gY2FjaGVbbmFtZV07XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciBjb250ZXh0ID0gdGhpcywgbmFtZXMsIGluZGV4LCBsb29rdXBIaXQgPSBmYWxzZTtcblxuICAgICAgd2hpbGUgKGNvbnRleHQpIHtcbiAgICAgICAgaWYgKG5hbWUuaW5kZXhPZignLicpID4gMCkge1xuICAgICAgICAgIHZhbHVlID0gY29udGV4dC52aWV3O1xuICAgICAgICAgIG5hbWVzID0gbmFtZS5zcGxpdCgnLicpO1xuICAgICAgICAgIGluZGV4ID0gMDtcblxuICAgICAgICAgIC8qKlxuICAgICAgICAgICAqIFVzaW5nIHRoZSBkb3Qgbm90aW9uIHBhdGggaW4gYG5hbWVgLCB3ZSBkZXNjZW5kIHRocm91Z2ggdGhlXG4gICAgICAgICAgICogbmVzdGVkIG9iamVjdHMuXG4gICAgICAgICAgICpcbiAgICAgICAgICAgKiBUbyBiZSBjZXJ0YWluIHRoYXQgdGhlIGxvb2t1cCBoYXMgYmVlbiBzdWNjZXNzZnVsLCB3ZSBoYXZlIHRvXG4gICAgICAgICAgICogY2hlY2sgaWYgdGhlIGxhc3Qgb2JqZWN0IGluIHRoZSBwYXRoIGFjdHVhbGx5IGhhcyB0aGUgcHJvcGVydHlcbiAgICAgICAgICAgKiB3ZSBhcmUgbG9va2luZyBmb3IuIFdlIHN0b3JlIHRoZSByZXN1bHQgaW4gYGxvb2t1cEhpdGAuXG4gICAgICAgICAgICpcbiAgICAgICAgICAgKiBUaGlzIGlzIHNwZWNpYWxseSBuZWNlc3NhcnkgZm9yIHdoZW4gdGhlIHZhbHVlIGhhcyBiZWVuIHNldCB0b1xuICAgICAgICAgICAqIGB1bmRlZmluZWRgIGFuZCB3ZSB3YW50IHRvIGF2b2lkIGxvb2tpbmcgdXAgcGFyZW50IGNvbnRleHRzLlxuICAgICAgICAgICAqKi9cbiAgICAgICAgICB3aGlsZSAodmFsdWUgIT0gbnVsbCAmJiBpbmRleCA8IG5hbWVzLmxlbmd0aCkge1xuICAgICAgICAgICAgaWYgKGluZGV4ID09PSBuYW1lcy5sZW5ndGggLSAxKVxuICAgICAgICAgICAgICBsb29rdXBIaXQgPSBoYXNQcm9wZXJ0eSh2YWx1ZSwgbmFtZXNbaW5kZXhdKTtcblxuICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZVtuYW1lc1tpbmRleCsrXV07XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhbHVlID0gY29udGV4dC52aWV3W25hbWVdO1xuICAgICAgICAgIGxvb2t1cEhpdCA9IGhhc1Byb3BlcnR5KGNvbnRleHQudmlldywgbmFtZSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobG9va3VwSGl0KVxuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNvbnRleHQgPSBjb250ZXh0LnBhcmVudDtcbiAgICAgIH1cblxuICAgICAgY2FjaGVbbmFtZV0gPSB2YWx1ZTtcbiAgICB9XG5cbiAgICBpZiAoaXNGdW5jdGlvbih2YWx1ZSkpXG4gICAgICB2YWx1ZSA9IHZhbHVlLmNhbGwodGhpcy52aWV3KTtcblxuICAgIHJldHVybiB2YWx1ZTtcbiAgfTtcblxuICAvKipcbiAgICogQSBXcml0ZXIga25vd3MgaG93IHRvIHRha2UgYSBzdHJlYW0gb2YgdG9rZW5zIGFuZCByZW5kZXIgdGhlbSB0byBhXG4gICAqIHN0cmluZywgZ2l2ZW4gYSBjb250ZXh0LiBJdCBhbHNvIG1haW50YWlucyBhIGNhY2hlIG9mIHRlbXBsYXRlcyB0b1xuICAgKiBhdm9pZCB0aGUgbmVlZCB0byBwYXJzZSB0aGUgc2FtZSB0ZW1wbGF0ZSB0d2ljZS5cbiAgICovXG4gIGZ1bmN0aW9uIFdyaXRlciAoKSB7XG4gICAgdGhpcy5jYWNoZSA9IHt9O1xuICB9XG5cbiAgLyoqXG4gICAqIENsZWFycyBhbGwgY2FjaGVkIHRlbXBsYXRlcyBpbiB0aGlzIHdyaXRlci5cbiAgICovXG4gIFdyaXRlci5wcm90b3R5cGUuY2xlYXJDYWNoZSA9IGZ1bmN0aW9uIGNsZWFyQ2FjaGUgKCkge1xuICAgIHRoaXMuY2FjaGUgPSB7fTtcbiAgfTtcblxuICAvKipcbiAgICogUGFyc2VzIGFuZCBjYWNoZXMgdGhlIGdpdmVuIGB0ZW1wbGF0ZWAgYW5kIHJldHVybnMgdGhlIGFycmF5IG9mIHRva2Vuc1xuICAgKiB0aGF0IGlzIGdlbmVyYXRlZCBmcm9tIHRoZSBwYXJzZS5cbiAgICovXG4gIFdyaXRlci5wcm90b3R5cGUucGFyc2UgPSBmdW5jdGlvbiBwYXJzZSAodGVtcGxhdGUsIHRhZ3MpIHtcbiAgICB2YXIgY2FjaGUgPSB0aGlzLmNhY2hlO1xuICAgIHZhciB0b2tlbnMgPSBjYWNoZVt0ZW1wbGF0ZV07XG5cbiAgICBpZiAodG9rZW5zID09IG51bGwpXG4gICAgICB0b2tlbnMgPSBjYWNoZVt0ZW1wbGF0ZV0gPSBwYXJzZVRlbXBsYXRlKHRlbXBsYXRlLCB0YWdzKTtcblxuICAgIHJldHVybiB0b2tlbnM7XG4gIH07XG5cbiAgLyoqXG4gICAqIEhpZ2gtbGV2ZWwgbWV0aG9kIHRoYXQgaXMgdXNlZCB0byByZW5kZXIgdGhlIGdpdmVuIGB0ZW1wbGF0ZWAgd2l0aFxuICAgKiB0aGUgZ2l2ZW4gYHZpZXdgLlxuICAgKlxuICAgKiBUaGUgb3B0aW9uYWwgYHBhcnRpYWxzYCBhcmd1bWVudCBtYXkgYmUgYW4gb2JqZWN0IHRoYXQgY29udGFpbnMgdGhlXG4gICAqIG5hbWVzIGFuZCB0ZW1wbGF0ZXMgb2YgcGFydGlhbHMgdGhhdCBhcmUgdXNlZCBpbiB0aGUgdGVtcGxhdGUuIEl0IG1heVxuICAgKiBhbHNvIGJlIGEgZnVuY3Rpb24gdGhhdCBpcyB1c2VkIHRvIGxvYWQgcGFydGlhbCB0ZW1wbGF0ZXMgb24gdGhlIGZseVxuICAgKiB0aGF0IHRha2VzIGEgc2luZ2xlIGFyZ3VtZW50OiB0aGUgbmFtZSBvZiB0aGUgcGFydGlhbC5cbiAgICovXG4gIFdyaXRlci5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gcmVuZGVyICh0ZW1wbGF0ZSwgdmlldywgcGFydGlhbHMpIHtcbiAgICB2YXIgdG9rZW5zID0gdGhpcy5wYXJzZSh0ZW1wbGF0ZSk7XG4gICAgdmFyIGNvbnRleHQgPSAodmlldyBpbnN0YW5jZW9mIENvbnRleHQpID8gdmlldyA6IG5ldyBDb250ZXh0KHZpZXcpO1xuICAgIHJldHVybiB0aGlzLnJlbmRlclRva2Vucyh0b2tlbnMsIGNvbnRleHQsIHBhcnRpYWxzLCB0ZW1wbGF0ZSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIExvdy1sZXZlbCBtZXRob2QgdGhhdCByZW5kZXJzIHRoZSBnaXZlbiBhcnJheSBvZiBgdG9rZW5zYCB1c2luZ1xuICAgKiB0aGUgZ2l2ZW4gYGNvbnRleHRgIGFuZCBgcGFydGlhbHNgLlxuICAgKlxuICAgKiBOb3RlOiBUaGUgYG9yaWdpbmFsVGVtcGxhdGVgIGlzIG9ubHkgZXZlciB1c2VkIHRvIGV4dHJhY3QgdGhlIHBvcnRpb25cbiAgICogb2YgdGhlIG9yaWdpbmFsIHRlbXBsYXRlIHRoYXQgd2FzIGNvbnRhaW5lZCBpbiBhIGhpZ2hlci1vcmRlciBzZWN0aW9uLlxuICAgKiBJZiB0aGUgdGVtcGxhdGUgZG9lc24ndCB1c2UgaGlnaGVyLW9yZGVyIHNlY3Rpb25zLCB0aGlzIGFyZ3VtZW50IG1heVxuICAgKiBiZSBvbWl0dGVkLlxuICAgKi9cbiAgV3JpdGVyLnByb3RvdHlwZS5yZW5kZXJUb2tlbnMgPSBmdW5jdGlvbiByZW5kZXJUb2tlbnMgKHRva2VucywgY29udGV4dCwgcGFydGlhbHMsIG9yaWdpbmFsVGVtcGxhdGUpIHtcbiAgICB2YXIgYnVmZmVyID0gJyc7XG5cbiAgICB2YXIgdG9rZW4sIHN5bWJvbCwgdmFsdWU7XG4gICAgZm9yICh2YXIgaSA9IDAsIG51bVRva2VucyA9IHRva2Vucy5sZW5ndGg7IGkgPCBudW1Ub2tlbnM7ICsraSkge1xuICAgICAgdmFsdWUgPSB1bmRlZmluZWQ7XG4gICAgICB0b2tlbiA9IHRva2Vuc1tpXTtcbiAgICAgIHN5bWJvbCA9IHRva2VuWzBdO1xuXG4gICAgICBpZiAoc3ltYm9sID09PSAnIycpIHZhbHVlID0gdGhpcy5yZW5kZXJTZWN0aW9uKHRva2VuLCBjb250ZXh0LCBwYXJ0aWFscywgb3JpZ2luYWxUZW1wbGF0ZSk7XG4gICAgICBlbHNlIGlmIChzeW1ib2wgPT09ICdeJykgdmFsdWUgPSB0aGlzLnJlbmRlckludmVydGVkKHRva2VuLCBjb250ZXh0LCBwYXJ0aWFscywgb3JpZ2luYWxUZW1wbGF0ZSk7XG4gICAgICBlbHNlIGlmIChzeW1ib2wgPT09ICc+JykgdmFsdWUgPSB0aGlzLnJlbmRlclBhcnRpYWwodG9rZW4sIGNvbnRleHQsIHBhcnRpYWxzLCBvcmlnaW5hbFRlbXBsYXRlKTtcbiAgICAgIGVsc2UgaWYgKHN5bWJvbCA9PT0gJyYnKSB2YWx1ZSA9IHRoaXMudW5lc2NhcGVkVmFsdWUodG9rZW4sIGNvbnRleHQpO1xuICAgICAgZWxzZSBpZiAoc3ltYm9sID09PSAnbmFtZScpIHZhbHVlID0gdGhpcy5lc2NhcGVkVmFsdWUodG9rZW4sIGNvbnRleHQpO1xuICAgICAgZWxzZSBpZiAoc3ltYm9sID09PSAndGV4dCcpIHZhbHVlID0gdGhpcy5yYXdWYWx1ZSh0b2tlbik7XG5cbiAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKVxuICAgICAgICBidWZmZXIgKz0gdmFsdWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIGJ1ZmZlcjtcbiAgfTtcblxuICBXcml0ZXIucHJvdG90eXBlLnJlbmRlclNlY3Rpb24gPSBmdW5jdGlvbiByZW5kZXJTZWN0aW9uICh0b2tlbiwgY29udGV4dCwgcGFydGlhbHMsIG9yaWdpbmFsVGVtcGxhdGUpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdmFyIGJ1ZmZlciA9ICcnO1xuICAgIHZhciB2YWx1ZSA9IGNvbnRleHQubG9va3VwKHRva2VuWzFdKTtcblxuICAgIC8vIFRoaXMgZnVuY3Rpb24gaXMgdXNlZCB0byByZW5kZXIgYW4gYXJiaXRyYXJ5IHRlbXBsYXRlXG4gICAgLy8gaW4gdGhlIGN1cnJlbnQgY29udGV4dCBieSBoaWdoZXItb3JkZXIgc2VjdGlvbnMuXG4gICAgZnVuY3Rpb24gc3ViUmVuZGVyICh0ZW1wbGF0ZSkge1xuICAgICAgcmV0dXJuIHNlbGYucmVuZGVyKHRlbXBsYXRlLCBjb250ZXh0LCBwYXJ0aWFscyk7XG4gICAgfVxuXG4gICAgaWYgKCF2YWx1ZSkgcmV0dXJuO1xuXG4gICAgaWYgKGlzQXJyYXkodmFsdWUpKSB7XG4gICAgICBmb3IgKHZhciBqID0gMCwgdmFsdWVMZW5ndGggPSB2YWx1ZS5sZW5ndGg7IGogPCB2YWx1ZUxlbmd0aDsgKytqKSB7XG4gICAgICAgIGJ1ZmZlciArPSB0aGlzLnJlbmRlclRva2Vucyh0b2tlbls0XSwgY29udGV4dC5wdXNoKHZhbHVlW2pdKSwgcGFydGlhbHMsIG9yaWdpbmFsVGVtcGxhdGUpO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyB8fCB0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnIHx8IHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicpIHtcbiAgICAgIGJ1ZmZlciArPSB0aGlzLnJlbmRlclRva2Vucyh0b2tlbls0XSwgY29udGV4dC5wdXNoKHZhbHVlKSwgcGFydGlhbHMsIG9yaWdpbmFsVGVtcGxhdGUpO1xuICAgIH0gZWxzZSBpZiAoaXNGdW5jdGlvbih2YWx1ZSkpIHtcbiAgICAgIGlmICh0eXBlb2Ygb3JpZ2luYWxUZW1wbGF0ZSAhPT0gJ3N0cmluZycpXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IHVzZSBoaWdoZXItb3JkZXIgc2VjdGlvbnMgd2l0aG91dCB0aGUgb3JpZ2luYWwgdGVtcGxhdGUnKTtcblxuICAgICAgLy8gRXh0cmFjdCB0aGUgcG9ydGlvbiBvZiB0aGUgb3JpZ2luYWwgdGVtcGxhdGUgdGhhdCB0aGUgc2VjdGlvbiBjb250YWlucy5cbiAgICAgIHZhbHVlID0gdmFsdWUuY2FsbChjb250ZXh0LnZpZXcsIG9yaWdpbmFsVGVtcGxhdGUuc2xpY2UodG9rZW5bM10sIHRva2VuWzVdKSwgc3ViUmVuZGVyKTtcblxuICAgICAgaWYgKHZhbHVlICE9IG51bGwpXG4gICAgICAgIGJ1ZmZlciArPSB2YWx1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgYnVmZmVyICs9IHRoaXMucmVuZGVyVG9rZW5zKHRva2VuWzRdLCBjb250ZXh0LCBwYXJ0aWFscywgb3JpZ2luYWxUZW1wbGF0ZSk7XG4gICAgfVxuICAgIHJldHVybiBidWZmZXI7XG4gIH07XG5cbiAgV3JpdGVyLnByb3RvdHlwZS5yZW5kZXJJbnZlcnRlZCA9IGZ1bmN0aW9uIHJlbmRlckludmVydGVkICh0b2tlbiwgY29udGV4dCwgcGFydGlhbHMsIG9yaWdpbmFsVGVtcGxhdGUpIHtcbiAgICB2YXIgdmFsdWUgPSBjb250ZXh0Lmxvb2t1cCh0b2tlblsxXSk7XG5cbiAgICAvLyBVc2UgSmF2YVNjcmlwdCdzIGRlZmluaXRpb24gb2YgZmFsc3kuIEluY2x1ZGUgZW1wdHkgYXJyYXlzLlxuICAgIC8vIFNlZSBodHRwczovL2dpdGh1Yi5jb20vamFubC9tdXN0YWNoZS5qcy9pc3N1ZXMvMTg2XG4gICAgaWYgKCF2YWx1ZSB8fCAoaXNBcnJheSh2YWx1ZSkgJiYgdmFsdWUubGVuZ3RoID09PSAwKSlcbiAgICAgIHJldHVybiB0aGlzLnJlbmRlclRva2Vucyh0b2tlbls0XSwgY29udGV4dCwgcGFydGlhbHMsIG9yaWdpbmFsVGVtcGxhdGUpO1xuICB9O1xuXG4gIFdyaXRlci5wcm90b3R5cGUucmVuZGVyUGFydGlhbCA9IGZ1bmN0aW9uIHJlbmRlclBhcnRpYWwgKHRva2VuLCBjb250ZXh0LCBwYXJ0aWFscykge1xuICAgIGlmICghcGFydGlhbHMpIHJldHVybjtcblxuICAgIHZhciB2YWx1ZSA9IGlzRnVuY3Rpb24ocGFydGlhbHMpID8gcGFydGlhbHModG9rZW5bMV0pIDogcGFydGlhbHNbdG9rZW5bMV1dO1xuICAgIGlmICh2YWx1ZSAhPSBudWxsKVxuICAgICAgcmV0dXJuIHRoaXMucmVuZGVyVG9rZW5zKHRoaXMucGFyc2UodmFsdWUpLCBjb250ZXh0LCBwYXJ0aWFscywgdmFsdWUpO1xuICB9O1xuXG4gIFdyaXRlci5wcm90b3R5cGUudW5lc2NhcGVkVmFsdWUgPSBmdW5jdGlvbiB1bmVzY2FwZWRWYWx1ZSAodG9rZW4sIGNvbnRleHQpIHtcbiAgICB2YXIgdmFsdWUgPSBjb250ZXh0Lmxvb2t1cCh0b2tlblsxXSk7XG4gICAgaWYgKHZhbHVlICE9IG51bGwpXG4gICAgICByZXR1cm4gdmFsdWU7XG4gIH07XG5cbiAgV3JpdGVyLnByb3RvdHlwZS5lc2NhcGVkVmFsdWUgPSBmdW5jdGlvbiBlc2NhcGVkVmFsdWUgKHRva2VuLCBjb250ZXh0KSB7XG4gICAgdmFyIHZhbHVlID0gY29udGV4dC5sb29rdXAodG9rZW5bMV0pO1xuICAgIGlmICh2YWx1ZSAhPSBudWxsKVxuICAgICAgcmV0dXJuIG11c3RhY2hlLmVzY2FwZSh2YWx1ZSk7XG4gIH07XG5cbiAgV3JpdGVyLnByb3RvdHlwZS5yYXdWYWx1ZSA9IGZ1bmN0aW9uIHJhd1ZhbHVlICh0b2tlbikge1xuICAgIHJldHVybiB0b2tlblsxXTtcbiAgfTtcblxuICBtdXN0YWNoZS5uYW1lID0gJ211c3RhY2hlLmpzJztcbiAgbXVzdGFjaGUudmVyc2lvbiA9ICcyLjIuMSc7XG4gIG11c3RhY2hlLnRhZ3MgPSBbICd7eycsICd9fScgXTtcblxuICAvLyBBbGwgaGlnaC1sZXZlbCBtdXN0YWNoZS4qIGZ1bmN0aW9ucyB1c2UgdGhpcyB3cml0ZXIuXG4gIHZhciBkZWZhdWx0V3JpdGVyID0gbmV3IFdyaXRlcigpO1xuXG4gIC8qKlxuICAgKiBDbGVhcnMgYWxsIGNhY2hlZCB0ZW1wbGF0ZXMgaW4gdGhlIGRlZmF1bHQgd3JpdGVyLlxuICAgKi9cbiAgbXVzdGFjaGUuY2xlYXJDYWNoZSA9IGZ1bmN0aW9uIGNsZWFyQ2FjaGUgKCkge1xuICAgIHJldHVybiBkZWZhdWx0V3JpdGVyLmNsZWFyQ2FjaGUoKTtcbiAgfTtcblxuICAvKipcbiAgICogUGFyc2VzIGFuZCBjYWNoZXMgdGhlIGdpdmVuIHRlbXBsYXRlIGluIHRoZSBkZWZhdWx0IHdyaXRlciBhbmQgcmV0dXJucyB0aGVcbiAgICogYXJyYXkgb2YgdG9rZW5zIGl0IGNvbnRhaW5zLiBEb2luZyB0aGlzIGFoZWFkIG9mIHRpbWUgYXZvaWRzIHRoZSBuZWVkIHRvXG4gICAqIHBhcnNlIHRlbXBsYXRlcyBvbiB0aGUgZmx5IGFzIHRoZXkgYXJlIHJlbmRlcmVkLlxuICAgKi9cbiAgbXVzdGFjaGUucGFyc2UgPSBmdW5jdGlvbiBwYXJzZSAodGVtcGxhdGUsIHRhZ3MpIHtcbiAgICByZXR1cm4gZGVmYXVsdFdyaXRlci5wYXJzZSh0ZW1wbGF0ZSwgdGFncyk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFJlbmRlcnMgdGhlIGB0ZW1wbGF0ZWAgd2l0aCB0aGUgZ2l2ZW4gYHZpZXdgIGFuZCBgcGFydGlhbHNgIHVzaW5nIHRoZVxuICAgKiBkZWZhdWx0IHdyaXRlci5cbiAgICovXG4gIG11c3RhY2hlLnJlbmRlciA9IGZ1bmN0aW9uIHJlbmRlciAodGVtcGxhdGUsIHZpZXcsIHBhcnRpYWxzKSB7XG4gICAgaWYgKHR5cGVvZiB0ZW1wbGF0ZSAhPT0gJ3N0cmluZycpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgdGVtcGxhdGUhIFRlbXBsYXRlIHNob3VsZCBiZSBhIFwic3RyaW5nXCIgJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICdidXQgXCInICsgdHlwZVN0cih0ZW1wbGF0ZSkgKyAnXCIgd2FzIGdpdmVuIGFzIHRoZSBmaXJzdCAnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgJ2FyZ3VtZW50IGZvciBtdXN0YWNoZSNyZW5kZXIodGVtcGxhdGUsIHZpZXcsIHBhcnRpYWxzKScpO1xuICAgIH1cblxuICAgIHJldHVybiBkZWZhdWx0V3JpdGVyLnJlbmRlcih0ZW1wbGF0ZSwgdmlldywgcGFydGlhbHMpO1xuICB9O1xuXG4gIC8vIFRoaXMgaXMgaGVyZSBmb3IgYmFja3dhcmRzIGNvbXBhdGliaWxpdHkgd2l0aCAwLjQueC4sXG4gIC8qZXNsaW50LWRpc2FibGUgKi8gLy8gZXNsaW50IHdhbnRzIGNhbWVsIGNhc2VkIGZ1bmN0aW9uIG5hbWVcbiAgbXVzdGFjaGUudG9faHRtbCA9IGZ1bmN0aW9uIHRvX2h0bWwgKHRlbXBsYXRlLCB2aWV3LCBwYXJ0aWFscywgc2VuZCkge1xuICAgIC8qZXNsaW50LWVuYWJsZSovXG5cbiAgICB2YXIgcmVzdWx0ID0gbXVzdGFjaGUucmVuZGVyKHRlbXBsYXRlLCB2aWV3LCBwYXJ0aWFscyk7XG5cbiAgICBpZiAoaXNGdW5jdGlvbihzZW5kKSkge1xuICAgICAgc2VuZChyZXN1bHQpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgfTtcblxuICAvLyBFeHBvcnQgdGhlIGVzY2FwaW5nIGZ1bmN0aW9uIHNvIHRoYXQgdGhlIHVzZXIgbWF5IG92ZXJyaWRlIGl0LlxuICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2phbmwvbXVzdGFjaGUuanMvaXNzdWVzLzI0NFxuICBtdXN0YWNoZS5lc2NhcGUgPSBlc2NhcGVIdG1sO1xuXG4gIC8vIEV4cG9ydCB0aGVzZSBtYWlubHkgZm9yIHRlc3RpbmcsIGJ1dCBhbHNvIGZvciBhZHZhbmNlZCB1c2FnZS5cbiAgbXVzdGFjaGUuU2Nhbm5lciA9IFNjYW5uZXI7XG4gIG11c3RhY2hlLkNvbnRleHQgPSBDb250ZXh0O1xuICBtdXN0YWNoZS5Xcml0ZXIgPSBXcml0ZXI7XG5cbn0pKTtcbiIsIi8qIVxuICogWmVyb0NsaXBib2FyZFxuICogVGhlIFplcm9DbGlwYm9hcmQgbGlicmFyeSBwcm92aWRlcyBhbiBlYXN5IHdheSB0byBjb3B5IHRleHQgdG8gdGhlIGNsaXBib2FyZCB1c2luZyBhbiBpbnZpc2libGUgQWRvYmUgRmxhc2ggbW92aWUgYW5kIGEgSmF2YVNjcmlwdCBpbnRlcmZhY2UuXG4gKiBDb3B5cmlnaHQgKGMpIDIwMDktMjAxNCBKb24gUm9oYW4sIEphbWVzIE0uIEdyZWVuZVxuICogTGljZW5zZWQgTUlUXG4gKiBodHRwOi8vemVyb2NsaXBib2FyZC5vcmcvXG4gKiB2Mi4yLjBcbiAqL1xuKGZ1bmN0aW9uKHdpbmRvdywgdW5kZWZpbmVkKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuICAvKipcbiAqIFN0b3JlIHJlZmVyZW5jZXMgdG8gY3JpdGljYWxseSBpbXBvcnRhbnQgZ2xvYmFsIGZ1bmN0aW9ucyB0aGF0IG1heSBiZVxuICogb3ZlcnJpZGRlbiBvbiBjZXJ0YWluIHdlYiBwYWdlcy5cbiAqL1xuICB2YXIgX3dpbmRvdyA9IHdpbmRvdywgX2RvY3VtZW50ID0gX3dpbmRvdy5kb2N1bWVudCwgX25hdmlnYXRvciA9IF93aW5kb3cubmF2aWdhdG9yLCBfc2V0VGltZW91dCA9IF93aW5kb3cuc2V0VGltZW91dCwgX2NsZWFyVGltZW91dCA9IF93aW5kb3cuY2xlYXJUaW1lb3V0LCBfc2V0SW50ZXJ2YWwgPSBfd2luZG93LnNldEludGVydmFsLCBfY2xlYXJJbnRlcnZhbCA9IF93aW5kb3cuY2xlYXJJbnRlcnZhbCwgX2dldENvbXB1dGVkU3R5bGUgPSBfd2luZG93LmdldENvbXB1dGVkU3R5bGUsIF9lbmNvZGVVUklDb21wb25lbnQgPSBfd2luZG93LmVuY29kZVVSSUNvbXBvbmVudCwgX0FjdGl2ZVhPYmplY3QgPSBfd2luZG93LkFjdGl2ZVhPYmplY3QsIF9FcnJvciA9IF93aW5kb3cuRXJyb3IsIF9wYXJzZUludCA9IF93aW5kb3cuTnVtYmVyLnBhcnNlSW50IHx8IF93aW5kb3cucGFyc2VJbnQsIF9wYXJzZUZsb2F0ID0gX3dpbmRvdy5OdW1iZXIucGFyc2VGbG9hdCB8fCBfd2luZG93LnBhcnNlRmxvYXQsIF9pc05hTiA9IF93aW5kb3cuTnVtYmVyLmlzTmFOIHx8IF93aW5kb3cuaXNOYU4sIF9ub3cgPSBfd2luZG93LkRhdGUubm93LCBfa2V5cyA9IF93aW5kb3cuT2JqZWN0LmtleXMsIF9kZWZpbmVQcm9wZXJ0eSA9IF93aW5kb3cuT2JqZWN0LmRlZmluZVByb3BlcnR5LCBfaGFzT3duID0gX3dpbmRvdy5PYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LCBfc2xpY2UgPSBfd2luZG93LkFycmF5LnByb3RvdHlwZS5zbGljZSwgX3Vud3JhcCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciB1bndyYXBwZXIgPSBmdW5jdGlvbihlbCkge1xuICAgICAgcmV0dXJuIGVsO1xuICAgIH07XG4gICAgaWYgKHR5cGVvZiBfd2luZG93LndyYXAgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgX3dpbmRvdy51bndyYXAgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgdHJ5IHtcbiAgICAgICAgdmFyIGRpdiA9IF9kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICB2YXIgdW53cmFwcGVkRGl2ID0gX3dpbmRvdy51bndyYXAoZGl2KTtcbiAgICAgICAgaWYgKGRpdi5ub2RlVHlwZSA9PT0gMSAmJiB1bndyYXBwZWREaXYgJiYgdW53cmFwcGVkRGl2Lm5vZGVUeXBlID09PSAxKSB7XG4gICAgICAgICAgdW53cmFwcGVyID0gX3dpbmRvdy51bndyYXA7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGUpIHt9XG4gICAgfVxuICAgIHJldHVybiB1bndyYXBwZXI7XG4gIH0oKTtcbiAgLyoqXG4gKiBDb252ZXJ0IGFuIGBhcmd1bWVudHNgIG9iamVjdCBpbnRvIGFuIEFycmF5LlxuICpcbiAqIEByZXR1cm5zIFRoZSBhcmd1bWVudHMgYXMgYW4gQXJyYXlcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9hcmdzID0gZnVuY3Rpb24oYXJndW1lbnRzT2JqKSB7XG4gICAgcmV0dXJuIF9zbGljZS5jYWxsKGFyZ3VtZW50c09iaiwgMCk7XG4gIH07XG4gIC8qKlxuICogU2hhbGxvdy1jb3B5IHRoZSBvd25lZCwgZW51bWVyYWJsZSBwcm9wZXJ0aWVzIG9mIG9uZSBvYmplY3Qgb3ZlciB0byBhbm90aGVyLCBzaW1pbGFyIHRvIGpRdWVyeSdzIGAkLmV4dGVuZGAuXG4gKlxuICogQHJldHVybnMgVGhlIHRhcmdldCBvYmplY3QsIGF1Z21lbnRlZFxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2V4dGVuZCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBpLCBsZW4sIGFyZywgcHJvcCwgc3JjLCBjb3B5LCBhcmdzID0gX2FyZ3MoYXJndW1lbnRzKSwgdGFyZ2V0ID0gYXJnc1swXSB8fCB7fTtcbiAgICBmb3IgKGkgPSAxLCBsZW4gPSBhcmdzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICBpZiAoKGFyZyA9IGFyZ3NbaV0pICE9IG51bGwpIHtcbiAgICAgICAgZm9yIChwcm9wIGluIGFyZykge1xuICAgICAgICAgIGlmIChfaGFzT3duLmNhbGwoYXJnLCBwcm9wKSkge1xuICAgICAgICAgICAgc3JjID0gdGFyZ2V0W3Byb3BdO1xuICAgICAgICAgICAgY29weSA9IGFyZ1twcm9wXTtcbiAgICAgICAgICAgIGlmICh0YXJnZXQgIT09IGNvcHkgJiYgY29weSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgIHRhcmdldFtwcm9wXSA9IGNvcHk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0YXJnZXQ7XG4gIH07XG4gIC8qKlxuICogUmV0dXJuIGEgZGVlcCBjb3B5IG9mIHRoZSBzb3VyY2Ugb2JqZWN0IG9yIGFycmF5LlxuICpcbiAqIEByZXR1cm5zIE9iamVjdCBvciBBcnJheVxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2RlZXBDb3B5ID0gZnVuY3Rpb24oc291cmNlKSB7XG4gICAgdmFyIGNvcHksIGksIGxlbiwgcHJvcDtcbiAgICBpZiAodHlwZW9mIHNvdXJjZSAhPT0gXCJvYmplY3RcIiB8fCBzb3VyY2UgPT0gbnVsbCB8fCB0eXBlb2Ygc291cmNlLm5vZGVUeXBlID09PSBcIm51bWJlclwiKSB7XG4gICAgICBjb3B5ID0gc291cmNlO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIHNvdXJjZS5sZW5ndGggPT09IFwibnVtYmVyXCIpIHtcbiAgICAgIGNvcHkgPSBbXTtcbiAgICAgIGZvciAoaSA9IDAsIGxlbiA9IHNvdXJjZS5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBpZiAoX2hhc093bi5jYWxsKHNvdXJjZSwgaSkpIHtcbiAgICAgICAgICBjb3B5W2ldID0gX2RlZXBDb3B5KHNvdXJjZVtpXSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgY29weSA9IHt9O1xuICAgICAgZm9yIChwcm9wIGluIHNvdXJjZSkge1xuICAgICAgICBpZiAoX2hhc093bi5jYWxsKHNvdXJjZSwgcHJvcCkpIHtcbiAgICAgICAgICBjb3B5W3Byb3BdID0gX2RlZXBDb3B5KHNvdXJjZVtwcm9wXSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGNvcHk7XG4gIH07XG4gIC8qKlxuICogTWFrZXMgYSBzaGFsbG93IGNvcHkgb2YgYG9iamAgKGxpa2UgYF9leHRlbmRgKSBidXQgZmlsdGVycyBpdHMgcHJvcGVydGllcyBiYXNlZCBvbiBhIGxpc3Qgb2YgYGtleXNgIHRvIGtlZXAuXG4gKiBUaGUgaW52ZXJzZSBvZiBgX29taXRgLCBtb3N0bHkuIFRoZSBiaWcgZGlmZmVyZW5jZSBpcyB0aGF0IHRoZXNlIHByb3BlcnRpZXMgZG8gTk9UIG5lZWQgdG8gYmUgZW51bWVyYWJsZSB0b1xuICogYmUga2VwdC5cbiAqXG4gKiBAcmV0dXJucyBBIG5ldyBmaWx0ZXJlZCBvYmplY3QuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfcGljayA9IGZ1bmN0aW9uKG9iaiwga2V5cykge1xuICAgIHZhciBuZXdPYmogPSB7fTtcbiAgICBmb3IgKHZhciBpID0gMCwgbGVuID0ga2V5cy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgaWYgKGtleXNbaV0gaW4gb2JqKSB7XG4gICAgICAgIG5ld09ialtrZXlzW2ldXSA9IG9ialtrZXlzW2ldXTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG5ld09iajtcbiAgfTtcbiAgLyoqXG4gKiBNYWtlcyBhIHNoYWxsb3cgY29weSBvZiBgb2JqYCAobGlrZSBgX2V4dGVuZGApIGJ1dCBmaWx0ZXJzIGl0cyBwcm9wZXJ0aWVzIGJhc2VkIG9uIGEgbGlzdCBvZiBga2V5c2AgdG8gb21pdC5cbiAqIFRoZSBpbnZlcnNlIG9mIGBfcGlja2AuXG4gKlxuICogQHJldHVybnMgQSBuZXcgZmlsdGVyZWQgb2JqZWN0LlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX29taXQgPSBmdW5jdGlvbihvYmosIGtleXMpIHtcbiAgICB2YXIgbmV3T2JqID0ge307XG4gICAgZm9yICh2YXIgcHJvcCBpbiBvYmopIHtcbiAgICAgIGlmIChrZXlzLmluZGV4T2YocHJvcCkgPT09IC0xKSB7XG4gICAgICAgIG5ld09ialtwcm9wXSA9IG9ialtwcm9wXTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG5ld09iajtcbiAgfTtcbiAgLyoqXG4gKiBSZW1vdmUgYWxsIG93bmVkLCBlbnVtZXJhYmxlIHByb3BlcnRpZXMgZnJvbSBhbiBvYmplY3QuXG4gKlxuICogQHJldHVybnMgVGhlIG9yaWdpbmFsIG9iamVjdCB3aXRob3V0IGl0cyBvd25lZCwgZW51bWVyYWJsZSBwcm9wZXJ0aWVzLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2RlbGV0ZU93blByb3BlcnRpZXMgPSBmdW5jdGlvbihvYmopIHtcbiAgICBpZiAob2JqKSB7XG4gICAgICBmb3IgKHZhciBwcm9wIGluIG9iaikge1xuICAgICAgICBpZiAoX2hhc093bi5jYWxsKG9iaiwgcHJvcCkpIHtcbiAgICAgICAgICBkZWxldGUgb2JqW3Byb3BdO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBvYmo7XG4gIH07XG4gIC8qKlxuICogRGV0ZXJtaW5lIGlmIGFuIGVsZW1lbnQgaXMgY29udGFpbmVkIHdpdGhpbiBhbm90aGVyIGVsZW1lbnQuXG4gKlxuICogQHJldHVybnMgQm9vbGVhblxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2NvbnRhaW5lZEJ5ID0gZnVuY3Rpb24oZWwsIGFuY2VzdG9yRWwpIHtcbiAgICBpZiAoZWwgJiYgZWwubm9kZVR5cGUgPT09IDEgJiYgZWwub3duZXJEb2N1bWVudCAmJiBhbmNlc3RvckVsICYmIChhbmNlc3RvckVsLm5vZGVUeXBlID09PSAxICYmIGFuY2VzdG9yRWwub3duZXJEb2N1bWVudCAmJiBhbmNlc3RvckVsLm93bmVyRG9jdW1lbnQgPT09IGVsLm93bmVyRG9jdW1lbnQgfHwgYW5jZXN0b3JFbC5ub2RlVHlwZSA9PT0gOSAmJiAhYW5jZXN0b3JFbC5vd25lckRvY3VtZW50ICYmIGFuY2VzdG9yRWwgPT09IGVsLm93bmVyRG9jdW1lbnQpKSB7XG4gICAgICBkbyB7XG4gICAgICAgIGlmIChlbCA9PT0gYW5jZXN0b3JFbCkge1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsID0gZWwucGFyZW50Tm9kZTtcbiAgICAgIH0gd2hpbGUgKGVsKTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuICAvKipcbiAqIEdldCB0aGUgVVJMIHBhdGgncyBwYXJlbnQgZGlyZWN0b3J5LlxuICpcbiAqIEByZXR1cm5zIFN0cmluZyBvciBgdW5kZWZpbmVkYFxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2dldERpclBhdGhPZlVybCA9IGZ1bmN0aW9uKHVybCkge1xuICAgIHZhciBkaXI7XG4gICAgaWYgKHR5cGVvZiB1cmwgPT09IFwic3RyaW5nXCIgJiYgdXJsKSB7XG4gICAgICBkaXIgPSB1cmwuc3BsaXQoXCIjXCIpWzBdLnNwbGl0KFwiP1wiKVswXTtcbiAgICAgIGRpciA9IHVybC5zbGljZSgwLCB1cmwubGFzdEluZGV4T2YoXCIvXCIpICsgMSk7XG4gICAgfVxuICAgIHJldHVybiBkaXI7XG4gIH07XG4gIC8qKlxuICogR2V0IHRoZSBjdXJyZW50IHNjcmlwdCdzIFVSTCBieSB0aHJvd2luZyBhbiBgRXJyb3JgIGFuZCBhbmFseXppbmcgaXQuXG4gKlxuICogQHJldHVybnMgU3RyaW5nIG9yIGB1bmRlZmluZWRgXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZ2V0Q3VycmVudFNjcmlwdFVybEZyb21FcnJvclN0YWNrID0gZnVuY3Rpb24oc3RhY2spIHtcbiAgICB2YXIgdXJsLCBtYXRjaGVzO1xuICAgIGlmICh0eXBlb2Ygc3RhY2sgPT09IFwic3RyaW5nXCIgJiYgc3RhY2spIHtcbiAgICAgIG1hdGNoZXMgPSBzdGFjay5tYXRjaCgvXig/OnxbXjpAXSpAfC4rXFwpQCg/PWh0dHBbc10/fGZpbGUpfC4rP1xccysoPzogYXQgfEApKD86W146XFwoXSsgKSpbXFwoXT8pKCg/Omh0dHBbc10/fGZpbGUpOlxcL1xcL1tcXC9dPy4rP1xcL1teOlxcKV0qPykoPzo6XFxkKykoPzo6XFxkKyk/Lyk7XG4gICAgICBpZiAobWF0Y2hlcyAmJiBtYXRjaGVzWzFdKSB7XG4gICAgICAgIHVybCA9IG1hdGNoZXNbMV07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBtYXRjaGVzID0gc3RhY2subWF0Y2goL1xcKUAoKD86aHR0cFtzXT98ZmlsZSk6XFwvXFwvW1xcL10/Lis/XFwvW146XFwpXSo/KSg/OjpcXGQrKSg/OjpcXGQrKT8vKTtcbiAgICAgICAgaWYgKG1hdGNoZXMgJiYgbWF0Y2hlc1sxXSkge1xuICAgICAgICAgIHVybCA9IG1hdGNoZXNbMV07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHVybDtcbiAgfTtcbiAgLyoqXG4gKiBHZXQgdGhlIGN1cnJlbnQgc2NyaXB0J3MgVVJMIGJ5IHRocm93aW5nIGFuIGBFcnJvcmAgYW5kIGFuYWx5emluZyBpdC5cbiAqXG4gKiBAcmV0dXJucyBTdHJpbmcgb3IgYHVuZGVmaW5lZGBcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9nZXRDdXJyZW50U2NyaXB0VXJsRnJvbUVycm9yID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHVybCwgZXJyO1xuICAgIHRyeSB7XG4gICAgICB0aHJvdyBuZXcgX0Vycm9yKCk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgZXJyID0gZTtcbiAgICB9XG4gICAgaWYgKGVycikge1xuICAgICAgdXJsID0gZXJyLnNvdXJjZVVSTCB8fCBlcnIuZmlsZU5hbWUgfHwgX2dldEN1cnJlbnRTY3JpcHRVcmxGcm9tRXJyb3JTdGFjayhlcnIuc3RhY2spO1xuICAgIH1cbiAgICByZXR1cm4gdXJsO1xuICB9O1xuICAvKipcbiAqIEdldCB0aGUgY3VycmVudCBzY3JpcHQncyBVUkwuXG4gKlxuICogQHJldHVybnMgU3RyaW5nIG9yIGB1bmRlZmluZWRgXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZ2V0Q3VycmVudFNjcmlwdFVybCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBqc1BhdGgsIHNjcmlwdHMsIGk7XG4gICAgaWYgKF9kb2N1bWVudC5jdXJyZW50U2NyaXB0ICYmIChqc1BhdGggPSBfZG9jdW1lbnQuY3VycmVudFNjcmlwdC5zcmMpKSB7XG4gICAgICByZXR1cm4ganNQYXRoO1xuICAgIH1cbiAgICBzY3JpcHRzID0gX2RvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwic2NyaXB0XCIpO1xuICAgIGlmIChzY3JpcHRzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgcmV0dXJuIHNjcmlwdHNbMF0uc3JjIHx8IHVuZGVmaW5lZDtcbiAgICB9XG4gICAgaWYgKFwicmVhZHlTdGF0ZVwiIGluIHNjcmlwdHNbMF0pIHtcbiAgICAgIGZvciAoaSA9IHNjcmlwdHMubGVuZ3RoOyBpLS07ICkge1xuICAgICAgICBpZiAoc2NyaXB0c1tpXS5yZWFkeVN0YXRlID09PSBcImludGVyYWN0aXZlXCIgJiYgKGpzUGF0aCA9IHNjcmlwdHNbaV0uc3JjKSkge1xuICAgICAgICAgIHJldHVybiBqc1BhdGg7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKF9kb2N1bWVudC5yZWFkeVN0YXRlID09PSBcImxvYWRpbmdcIiAmJiAoanNQYXRoID0gc2NyaXB0c1tzY3JpcHRzLmxlbmd0aCAtIDFdLnNyYykpIHtcbiAgICAgIHJldHVybiBqc1BhdGg7XG4gICAgfVxuICAgIGlmIChqc1BhdGggPSBfZ2V0Q3VycmVudFNjcmlwdFVybEZyb21FcnJvcigpKSB7XG4gICAgICByZXR1cm4ganNQYXRoO1xuICAgIH1cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9O1xuICAvKipcbiAqIEdldCB0aGUgdW5hbmltb3VzIHBhcmVudCBkaXJlY3Rvcnkgb2YgQUxMIHNjcmlwdCB0YWdzLlxuICogSWYgYW55IHNjcmlwdCB0YWdzIGFyZSBlaXRoZXIgKGEpIGlubGluZSBvciAoYikgZnJvbSBkaWZmZXJpbmcgcGFyZW50XG4gKiBkaXJlY3RvcmllcywgdGhpcyBtZXRob2QgbXVzdCByZXR1cm4gYHVuZGVmaW5lZGAuXG4gKlxuICogQHJldHVybnMgU3RyaW5nIG9yIGB1bmRlZmluZWRgXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZ2V0VW5hbmltb3VzU2NyaXB0UGFyZW50RGlyID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGksIGpzRGlyLCBqc1BhdGgsIHNjcmlwdHMgPSBfZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzY3JpcHRcIik7XG4gICAgZm9yIChpID0gc2NyaXB0cy5sZW5ndGg7IGktLTsgKSB7XG4gICAgICBpZiAoIShqc1BhdGggPSBzY3JpcHRzW2ldLnNyYykpIHtcbiAgICAgICAganNEaXIgPSBudWxsO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGpzUGF0aCA9IF9nZXREaXJQYXRoT2ZVcmwoanNQYXRoKTtcbiAgICAgIGlmIChqc0RpciA9PSBudWxsKSB7XG4gICAgICAgIGpzRGlyID0ganNQYXRoO1xuICAgICAgfSBlbHNlIGlmIChqc0RpciAhPT0ganNQYXRoKSB7XG4gICAgICAgIGpzRGlyID0gbnVsbDtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBqc0RpciB8fCB1bmRlZmluZWQ7XG4gIH07XG4gIC8qKlxuICogR2V0IHRoZSBwcmVzdW1lZCBsb2NhdGlvbiBvZiB0aGUgXCJaZXJvQ2xpcGJvYXJkLnN3ZlwiIGZpbGUsIGJhc2VkIG9uIHRoZSBsb2NhdGlvblxuICogb2YgdGhlIGV4ZWN1dGluZyBKYXZhU2NyaXB0IGZpbGUgKGUuZy4gXCJaZXJvQ2xpcGJvYXJkLmpzXCIsIGV0Yy4pLlxuICpcbiAqIEByZXR1cm5zIFN0cmluZ1xuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2dldERlZmF1bHRTd2ZQYXRoID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGpzRGlyID0gX2dldERpclBhdGhPZlVybChfZ2V0Q3VycmVudFNjcmlwdFVybCgpKSB8fCBfZ2V0VW5hbmltb3VzU2NyaXB0UGFyZW50RGlyKCkgfHwgXCJcIjtcbiAgICByZXR1cm4ganNEaXIgKyBcIlplcm9DbGlwYm9hcmQuc3dmXCI7XG4gIH07XG4gIC8qKlxuICogS2VlcCB0cmFjayBvZiBpZiB0aGUgcGFnZSBpcyBmcmFtZWQgKGluIGFuIGBpZnJhbWVgKS4gVGhpcyBjYW4gbmV2ZXIgY2hhbmdlLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX3BhZ2VJc0ZyYW1lZCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB3aW5kb3cub3BlbmVyID09IG51bGwgJiYgKCEhd2luZG93LnRvcCAmJiB3aW5kb3cgIT0gd2luZG93LnRvcCB8fCAhIXdpbmRvdy5wYXJlbnQgJiYgd2luZG93ICE9IHdpbmRvdy5wYXJlbnQpO1xuICB9KCk7XG4gIC8qKlxuICogS2VlcCB0cmFjayBvZiB0aGUgc3RhdGUgb2YgdGhlIEZsYXNoIG9iamVjdC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9mbGFzaFN0YXRlID0ge1xuICAgIGJyaWRnZTogbnVsbCxcbiAgICB2ZXJzaW9uOiBcIjAuMC4wXCIsXG4gICAgcGx1Z2luVHlwZTogXCJ1bmtub3duXCIsXG4gICAgZGlzYWJsZWQ6IG51bGwsXG4gICAgb3V0ZGF0ZWQ6IG51bGwsXG4gICAgc2FuZGJveGVkOiBudWxsLFxuICAgIHVuYXZhaWxhYmxlOiBudWxsLFxuICAgIGRlZ3JhZGVkOiBudWxsLFxuICAgIGRlYWN0aXZhdGVkOiBudWxsLFxuICAgIG92ZXJkdWU6IG51bGwsXG4gICAgcmVhZHk6IG51bGxcbiAgfTtcbiAgLyoqXG4gKiBUaGUgbWluaW11bSBGbGFzaCBQbGF5ZXIgdmVyc2lvbiByZXF1aXJlZCB0byB1c2UgWmVyb0NsaXBib2FyZCBjb21wbGV0ZWx5LlxuICogQHJlYWRvbmx5XG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfbWluaW11bUZsYXNoVmVyc2lvbiA9IFwiMTEuMC4wXCI7XG4gIC8qKlxuICogVGhlIFplcm9DbGlwYm9hcmQgbGlicmFyeSB2ZXJzaW9uIG51bWJlciwgYXMgcmVwb3J0ZWQgYnkgRmxhc2gsIGF0IHRoZSB0aW1lIHRoZSBTV0Ygd2FzIGNvbXBpbGVkLlxuICovXG4gIHZhciBfemNTd2ZWZXJzaW9uO1xuICAvKipcbiAqIEtlZXAgdHJhY2sgb2YgYWxsIGV2ZW50IGxpc3RlbmVyIHJlZ2lzdHJhdGlvbnMuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfaGFuZGxlcnMgPSB7fTtcbiAgLyoqXG4gKiBLZWVwIHRyYWNrIG9mIHRoZSBjdXJyZW50bHkgYWN0aXZhdGVkIGVsZW1lbnQuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY3VycmVudEVsZW1lbnQ7XG4gIC8qKlxuICogS2VlcCB0cmFjayBvZiB0aGUgZWxlbWVudCB0aGF0IHdhcyBhY3RpdmF0ZWQgd2hlbiBhIGBjb3B5YCBwcm9jZXNzIHN0YXJ0ZWQuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY29weVRhcmdldDtcbiAgLyoqXG4gKiBLZWVwIHRyYWNrIG9mIGRhdGEgZm9yIHRoZSBwZW5kaW5nIGNsaXBib2FyZCB0cmFuc2FjdGlvbi5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9jbGlwRGF0YSA9IHt9O1xuICAvKipcbiAqIEtlZXAgdHJhY2sgb2YgZGF0YSBmb3JtYXRzIGZvciB0aGUgcGVuZGluZyBjbGlwYm9hcmQgdHJhbnNhY3Rpb24uXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY2xpcERhdGFGb3JtYXRNYXAgPSBudWxsO1xuICAvKipcbiAqIEtlZXAgdHJhY2sgb2YgdGhlIEZsYXNoIGF2YWlsYWJpbGl0eSBjaGVjayB0aW1lb3V0LlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2ZsYXNoQ2hlY2tUaW1lb3V0ID0gMDtcbiAgLyoqXG4gKiBLZWVwIHRyYWNrIG9mIFNXRiBuZXR3b3JrIGVycm9ycyBpbnRlcnZhbCBwb2xsaW5nLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX3N3ZkZhbGxiYWNrQ2hlY2tJbnRlcnZhbCA9IDA7XG4gIC8qKlxuICogVGhlIGBtZXNzYWdlYCBzdG9yZSBmb3IgZXZlbnRzXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZXZlbnRNZXNzYWdlcyA9IHtcbiAgICByZWFkeTogXCJGbGFzaCBjb21tdW5pY2F0aW9uIGlzIGVzdGFibGlzaGVkXCIsXG4gICAgZXJyb3I6IHtcbiAgICAgIFwiZmxhc2gtZGlzYWJsZWRcIjogXCJGbGFzaCBpcyBkaXNhYmxlZCBvciBub3QgaW5zdGFsbGVkLiBNYXkgYWxzbyBiZSBhdHRlbXB0aW5nIHRvIHJ1biBGbGFzaCBpbiBhIHNhbmRib3hlZCBpZnJhbWUsIHdoaWNoIGlzIGltcG9zc2libGUuXCIsXG4gICAgICBcImZsYXNoLW91dGRhdGVkXCI6IFwiRmxhc2ggaXMgdG9vIG91dGRhdGVkIHRvIHN1cHBvcnQgWmVyb0NsaXBib2FyZFwiLFxuICAgICAgXCJmbGFzaC1zYW5kYm94ZWRcIjogXCJBdHRlbXB0aW5nIHRvIHJ1biBGbGFzaCBpbiBhIHNhbmRib3hlZCBpZnJhbWUsIHdoaWNoIGlzIGltcG9zc2libGVcIixcbiAgICAgIFwiZmxhc2gtdW5hdmFpbGFibGVcIjogXCJGbGFzaCBpcyB1bmFibGUgdG8gY29tbXVuaWNhdGUgYmlkaXJlY3Rpb25hbGx5IHdpdGggSmF2YVNjcmlwdFwiLFxuICAgICAgXCJmbGFzaC1kZWdyYWRlZFwiOiBcIkZsYXNoIGlzIHVuYWJsZSB0byBwcmVzZXJ2ZSBkYXRhIGZpZGVsaXR5IHdoZW4gY29tbXVuaWNhdGluZyB3aXRoIEphdmFTY3JpcHRcIixcbiAgICAgIFwiZmxhc2gtZGVhY3RpdmF0ZWRcIjogXCJGbGFzaCBpcyB0b28gb3V0ZGF0ZWQgZm9yIHlvdXIgYnJvd3NlciBhbmQvb3IgaXMgY29uZmlndXJlZCBhcyBjbGljay10by1hY3RpdmF0ZS5cXG5UaGlzIG1heSBhbHNvIG1lYW4gdGhhdCB0aGUgWmVyb0NsaXBib2FyZCBTV0Ygb2JqZWN0IGNvdWxkIG5vdCBiZSBsb2FkZWQsIHNvIHBsZWFzZSBjaGVjayB5b3VyIGBzd2ZQYXRoYCBjb25maWd1cmF0aW9uIGFuZC9vciBuZXR3b3JrIGNvbm5lY3Rpdml0eS5cXG5NYXkgYWxzbyBiZSBhdHRlbXB0aW5nIHRvIHJ1biBGbGFzaCBpbiBhIHNhbmRib3hlZCBpZnJhbWUsIHdoaWNoIGlzIGltcG9zc2libGUuXCIsXG4gICAgICBcImZsYXNoLW92ZXJkdWVcIjogXCJGbGFzaCBjb21tdW5pY2F0aW9uIHdhcyBlc3RhYmxpc2hlZCBidXQgTk9UIHdpdGhpbiB0aGUgYWNjZXB0YWJsZSB0aW1lIGxpbWl0XCIsXG4gICAgICBcInZlcnNpb24tbWlzbWF0Y2hcIjogXCJaZXJvQ2xpcGJvYXJkIEpTIHZlcnNpb24gbnVtYmVyIGRvZXMgbm90IG1hdGNoIFplcm9DbGlwYm9hcmQgU1dGIHZlcnNpb24gbnVtYmVyXCIsXG4gICAgICBcImNsaXBib2FyZC1lcnJvclwiOiBcIkF0IGxlYXN0IG9uZSBlcnJvciB3YXMgdGhyb3duIHdoaWxlIFplcm9DbGlwYm9hcmQgd2FzIGF0dGVtcHRpbmcgdG8gaW5qZWN0IHlvdXIgZGF0YSBpbnRvIHRoZSBjbGlwYm9hcmRcIixcbiAgICAgIFwiY29uZmlnLW1pc21hdGNoXCI6IFwiWmVyb0NsaXBib2FyZCBjb25maWd1cmF0aW9uIGRvZXMgbm90IG1hdGNoIEZsYXNoJ3MgcmVhbGl0eVwiLFxuICAgICAgXCJzd2Ytbm90LWZvdW5kXCI6IFwiVGhlIFplcm9DbGlwYm9hcmQgU1dGIG9iamVjdCBjb3VsZCBub3QgYmUgbG9hZGVkLCBzbyBwbGVhc2UgY2hlY2sgeW91ciBgc3dmUGF0aGAgY29uZmlndXJhdGlvbiBhbmQvb3IgbmV0d29yayBjb25uZWN0aXZpdHlcIlxuICAgIH1cbiAgfTtcbiAgLyoqXG4gKiBUaGUgYG5hbWVgcyBvZiBgZXJyb3JgIGV2ZW50cyB0aGF0IGNhbiBvbmx5IG9jY3VyIGlzIEZsYXNoIGhhcyBhdCBsZWFzdFxuICogYmVlbiBhYmxlIHRvIGxvYWQgdGhlIFNXRiBzdWNjZXNzZnVsbHkuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZXJyb3JzVGhhdE9ubHlPY2N1ckFmdGVyRmxhc2hMb2FkcyA9IFsgXCJmbGFzaC11bmF2YWlsYWJsZVwiLCBcImZsYXNoLWRlZ3JhZGVkXCIsIFwiZmxhc2gtb3ZlcmR1ZVwiLCBcInZlcnNpb24tbWlzbWF0Y2hcIiwgXCJjb25maWctbWlzbWF0Y2hcIiwgXCJjbGlwYm9hcmQtZXJyb3JcIiBdO1xuICAvKipcbiAqIFRoZSBgbmFtZWBzIG9mIGBlcnJvcmAgZXZlbnRzIHRoYXQgc2hvdWxkIGxpa2VseSByZXN1bHQgaW4gdGhlIGBfZmxhc2hTdGF0ZWBcbiAqIHZhcmlhYmxlJ3MgcHJvcGVydHkgdmFsdWVzIGJlaW5nIHVwZGF0ZWQuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZmxhc2hTdGF0ZUVycm9yTmFtZXMgPSBbIFwiZmxhc2gtZGlzYWJsZWRcIiwgXCJmbGFzaC1vdXRkYXRlZFwiLCBcImZsYXNoLXNhbmRib3hlZFwiLCBcImZsYXNoLXVuYXZhaWxhYmxlXCIsIFwiZmxhc2gtZGVncmFkZWRcIiwgXCJmbGFzaC1kZWFjdGl2YXRlZFwiLCBcImZsYXNoLW92ZXJkdWVcIiBdO1xuICAvKipcbiAqIEEgUmVnRXhwIHRvIG1hdGNoIHRoZSBgbmFtZWAgcHJvcGVydHkgb2YgYGVycm9yYCBldmVudHMgcmVsYXRlZCB0byBGbGFzaC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9mbGFzaFN0YXRlRXJyb3JOYW1lTWF0Y2hpbmdSZWdleCA9IG5ldyBSZWdFeHAoXCJeZmxhc2gtKFwiICsgX2ZsYXNoU3RhdGVFcnJvck5hbWVzLm1hcChmdW5jdGlvbihlcnJvck5hbWUpIHtcbiAgICByZXR1cm4gZXJyb3JOYW1lLnJlcGxhY2UoL15mbGFzaC0vLCBcIlwiKTtcbiAgfSkuam9pbihcInxcIikgKyBcIikkXCIpO1xuICAvKipcbiAqIEEgUmVnRXhwIHRvIG1hdGNoIHRoZSBgbmFtZWAgcHJvcGVydHkgb2YgYGVycm9yYCBldmVudHMgcmVsYXRlZCB0byBGbGFzaCxcbiAqIHdoaWNoIGlzIGVuYWJsZWQuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZmxhc2hTdGF0ZUVuYWJsZWRFcnJvck5hbWVNYXRjaGluZ1JlZ2V4ID0gbmV3IFJlZ0V4cChcIl5mbGFzaC0oXCIgKyBfZmxhc2hTdGF0ZUVycm9yTmFtZXMuc2xpY2UoMSkubWFwKGZ1bmN0aW9uKGVycm9yTmFtZSkge1xuICAgIHJldHVybiBlcnJvck5hbWUucmVwbGFjZSgvXmZsYXNoLS8sIFwiXCIpO1xuICB9KS5qb2luKFwifFwiKSArIFwiKSRcIik7XG4gIC8qKlxuICogWmVyb0NsaXBib2FyZCBjb25maWd1cmF0aW9uIGRlZmF1bHRzIGZvciB0aGUgQ29yZSBtb2R1bGUuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZ2xvYmFsQ29uZmlnID0ge1xuICAgIHN3ZlBhdGg6IF9nZXREZWZhdWx0U3dmUGF0aCgpLFxuICAgIHRydXN0ZWREb21haW5zOiB3aW5kb3cubG9jYXRpb24uaG9zdCA/IFsgd2luZG93LmxvY2F0aW9uLmhvc3QgXSA6IFtdLFxuICAgIGNhY2hlQnVzdDogdHJ1ZSxcbiAgICBmb3JjZUVuaGFuY2VkQ2xpcGJvYXJkOiBmYWxzZSxcbiAgICBmbGFzaExvYWRUaW1lb3V0OiAzZTQsXG4gICAgYXV0b0FjdGl2YXRlOiB0cnVlLFxuICAgIGJ1YmJsZUV2ZW50czogdHJ1ZSxcbiAgICBjb250YWluZXJJZDogXCJnbG9iYWwtemVyb2NsaXBib2FyZC1odG1sLWJyaWRnZVwiLFxuICAgIGNvbnRhaW5lckNsYXNzOiBcImdsb2JhbC16ZXJvY2xpcGJvYXJkLWNvbnRhaW5lclwiLFxuICAgIHN3Zk9iamVjdElkOiBcImdsb2JhbC16ZXJvY2xpcGJvYXJkLWZsYXNoLWJyaWRnZVwiLFxuICAgIGhvdmVyQ2xhc3M6IFwiemVyb2NsaXBib2FyZC1pcy1ob3ZlclwiLFxuICAgIGFjdGl2ZUNsYXNzOiBcInplcm9jbGlwYm9hcmQtaXMtYWN0aXZlXCIsXG4gICAgZm9yY2VIYW5kQ3Vyc29yOiBmYWxzZSxcbiAgICB0aXRsZTogbnVsbCxcbiAgICB6SW5kZXg6IDk5OTk5OTk5OVxuICB9O1xuICAvKipcbiAqIFRoZSB1bmRlcmx5aW5nIGltcGxlbWVudGF0aW9uIG9mIGBaZXJvQ2xpcGJvYXJkLmNvbmZpZ2AuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY29uZmlnID0gZnVuY3Rpb24ob3B0aW9ucykge1xuICAgIGlmICh0eXBlb2Ygb3B0aW9ucyA9PT0gXCJvYmplY3RcIiAmJiBvcHRpb25zICE9PSBudWxsKSB7XG4gICAgICBmb3IgKHZhciBwcm9wIGluIG9wdGlvbnMpIHtcbiAgICAgICAgaWYgKF9oYXNPd24uY2FsbChvcHRpb25zLCBwcm9wKSkge1xuICAgICAgICAgIGlmICgvXig/OmZvcmNlSGFuZEN1cnNvcnx0aXRsZXx6SW5kZXh8YnViYmxlRXZlbnRzKSQvLnRlc3QocHJvcCkpIHtcbiAgICAgICAgICAgIF9nbG9iYWxDb25maWdbcHJvcF0gPSBvcHRpb25zW3Byb3BdO1xuICAgICAgICAgIH0gZWxzZSBpZiAoX2ZsYXNoU3RhdGUuYnJpZGdlID09IG51bGwpIHtcbiAgICAgICAgICAgIGlmIChwcm9wID09PSBcImNvbnRhaW5lcklkXCIgfHwgcHJvcCA9PT0gXCJzd2ZPYmplY3RJZFwiKSB7XG4gICAgICAgICAgICAgIGlmIChfaXNWYWxpZEh0bWw0SWQob3B0aW9uc1twcm9wXSkpIHtcbiAgICAgICAgICAgICAgICBfZ2xvYmFsQ29uZmlnW3Byb3BdID0gb3B0aW9uc1twcm9wXTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUaGUgc3BlY2lmaWVkIGBcIiArIHByb3AgKyBcImAgdmFsdWUgaXMgbm90IHZhbGlkIGFzIGFuIEhUTUw0IEVsZW1lbnQgSURcIik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIF9nbG9iYWxDb25maWdbcHJvcF0gPSBvcHRpb25zW3Byb3BdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBpZiAodHlwZW9mIG9wdGlvbnMgPT09IFwic3RyaW5nXCIgJiYgb3B0aW9ucykge1xuICAgICAgaWYgKF9oYXNPd24uY2FsbChfZ2xvYmFsQ29uZmlnLCBvcHRpb25zKSkge1xuICAgICAgICByZXR1cm4gX2dsb2JhbENvbmZpZ1tvcHRpb25zXTtcbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgcmV0dXJuIF9kZWVwQ29weShfZ2xvYmFsQ29uZmlnKTtcbiAgfTtcbiAgLyoqXG4gKiBUaGUgdW5kZXJseWluZyBpbXBsZW1lbnRhdGlvbiBvZiBgWmVyb0NsaXBib2FyZC5zdGF0ZWAuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfc3RhdGUgPSBmdW5jdGlvbigpIHtcbiAgICBfZGV0ZWN0U2FuZGJveCgpO1xuICAgIHJldHVybiB7XG4gICAgICBicm93c2VyOiBfcGljayhfbmF2aWdhdG9yLCBbIFwidXNlckFnZW50XCIsIFwicGxhdGZvcm1cIiwgXCJhcHBOYW1lXCIgXSksXG4gICAgICBmbGFzaDogX29taXQoX2ZsYXNoU3RhdGUsIFsgXCJicmlkZ2VcIiBdKSxcbiAgICAgIHplcm9jbGlwYm9hcmQ6IHtcbiAgICAgICAgdmVyc2lvbjogWmVyb0NsaXBib2FyZC52ZXJzaW9uLFxuICAgICAgICBjb25maWc6IFplcm9DbGlwYm9hcmQuY29uZmlnKClcbiAgICAgIH1cbiAgICB9O1xuICB9O1xuICAvKipcbiAqIFRoZSB1bmRlcmx5aW5nIGltcGxlbWVudGF0aW9uIG9mIGBaZXJvQ2xpcGJvYXJkLmlzRmxhc2hVbnVzYWJsZWAuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfaXNGbGFzaFVudXNhYmxlID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuICEhKF9mbGFzaFN0YXRlLmRpc2FibGVkIHx8IF9mbGFzaFN0YXRlLm91dGRhdGVkIHx8IF9mbGFzaFN0YXRlLnNhbmRib3hlZCB8fCBfZmxhc2hTdGF0ZS51bmF2YWlsYWJsZSB8fCBfZmxhc2hTdGF0ZS5kZWdyYWRlZCB8fCBfZmxhc2hTdGF0ZS5kZWFjdGl2YXRlZCk7XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQub25gLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX29uID0gZnVuY3Rpb24oZXZlbnRUeXBlLCBsaXN0ZW5lcikge1xuICAgIHZhciBpLCBsZW4sIGV2ZW50cywgYWRkZWQgPSB7fTtcbiAgICBpZiAodHlwZW9mIGV2ZW50VHlwZSA9PT0gXCJzdHJpbmdcIiAmJiBldmVudFR5cGUpIHtcbiAgICAgIGV2ZW50cyA9IGV2ZW50VHlwZS50b0xvd2VyQ2FzZSgpLnNwbGl0KC9cXHMrLyk7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgZXZlbnRUeXBlID09PSBcIm9iamVjdFwiICYmIGV2ZW50VHlwZSAmJiB0eXBlb2YgbGlzdGVuZXIgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIGZvciAoaSBpbiBldmVudFR5cGUpIHtcbiAgICAgICAgaWYgKF9oYXNPd24uY2FsbChldmVudFR5cGUsIGkpICYmIHR5cGVvZiBpID09PSBcInN0cmluZ1wiICYmIGkgJiYgdHlwZW9mIGV2ZW50VHlwZVtpXSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgWmVyb0NsaXBib2FyZC5vbihpLCBldmVudFR5cGVbaV0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChldmVudHMgJiYgZXZlbnRzLmxlbmd0aCkge1xuICAgICAgZm9yIChpID0gMCwgbGVuID0gZXZlbnRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGV2ZW50VHlwZSA9IGV2ZW50c1tpXS5yZXBsYWNlKC9eb24vLCBcIlwiKTtcbiAgICAgICAgYWRkZWRbZXZlbnRUeXBlXSA9IHRydWU7XG4gICAgICAgIGlmICghX2hhbmRsZXJzW2V2ZW50VHlwZV0pIHtcbiAgICAgICAgICBfaGFuZGxlcnNbZXZlbnRUeXBlXSA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIF9oYW5kbGVyc1tldmVudFR5cGVdLnB1c2gobGlzdGVuZXIpO1xuICAgICAgfVxuICAgICAgaWYgKGFkZGVkLnJlYWR5ICYmIF9mbGFzaFN0YXRlLnJlYWR5KSB7XG4gICAgICAgIFplcm9DbGlwYm9hcmQuZW1pdCh7XG4gICAgICAgICAgdHlwZTogXCJyZWFkeVwiXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgaWYgKGFkZGVkLmVycm9yKSB7XG4gICAgICAgIGZvciAoaSA9IDAsIGxlbiA9IF9mbGFzaFN0YXRlRXJyb3JOYW1lcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgIGlmIChfZmxhc2hTdGF0ZVtfZmxhc2hTdGF0ZUVycm9yTmFtZXNbaV0ucmVwbGFjZSgvXmZsYXNoLS8sIFwiXCIpXSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgWmVyb0NsaXBib2FyZC5lbWl0KHtcbiAgICAgICAgICAgICAgdHlwZTogXCJlcnJvclwiLFxuICAgICAgICAgICAgICBuYW1lOiBfZmxhc2hTdGF0ZUVycm9yTmFtZXNbaV1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChfemNTd2ZWZXJzaW9uICE9PSB1bmRlZmluZWQgJiYgWmVyb0NsaXBib2FyZC52ZXJzaW9uICE9PSBfemNTd2ZWZXJzaW9uKSB7XG4gICAgICAgICAgWmVyb0NsaXBib2FyZC5lbWl0KHtcbiAgICAgICAgICAgIHR5cGU6IFwiZXJyb3JcIixcbiAgICAgICAgICAgIG5hbWU6IFwidmVyc2lvbi1taXNtYXRjaFwiLFxuICAgICAgICAgICAganNWZXJzaW9uOiBaZXJvQ2xpcGJvYXJkLnZlcnNpb24sXG4gICAgICAgICAgICBzd2ZWZXJzaW9uOiBfemNTd2ZWZXJzaW9uXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIFplcm9DbGlwYm9hcmQ7XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQub2ZmYC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9vZmYgPSBmdW5jdGlvbihldmVudFR5cGUsIGxpc3RlbmVyKSB7XG4gICAgdmFyIGksIGxlbiwgZm91bmRJbmRleCwgZXZlbnRzLCBwZXJFdmVudEhhbmRsZXJzO1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSB7XG4gICAgICBldmVudHMgPSBfa2V5cyhfaGFuZGxlcnMpO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGV2ZW50VHlwZSA9PT0gXCJzdHJpbmdcIiAmJiBldmVudFR5cGUpIHtcbiAgICAgIGV2ZW50cyA9IGV2ZW50VHlwZS5zcGxpdCgvXFxzKy8pO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGV2ZW50VHlwZSA9PT0gXCJvYmplY3RcIiAmJiBldmVudFR5cGUgJiYgdHlwZW9mIGxpc3RlbmVyID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICBmb3IgKGkgaW4gZXZlbnRUeXBlKSB7XG4gICAgICAgIGlmIChfaGFzT3duLmNhbGwoZXZlbnRUeXBlLCBpKSAmJiB0eXBlb2YgaSA9PT0gXCJzdHJpbmdcIiAmJiBpICYmIHR5cGVvZiBldmVudFR5cGVbaV0gPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgIFplcm9DbGlwYm9hcmQub2ZmKGksIGV2ZW50VHlwZVtpXSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGV2ZW50cyAmJiBldmVudHMubGVuZ3RoKSB7XG4gICAgICBmb3IgKGkgPSAwLCBsZW4gPSBldmVudHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgZXZlbnRUeXBlID0gZXZlbnRzW2ldLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvXm9uLywgXCJcIik7XG4gICAgICAgIHBlckV2ZW50SGFuZGxlcnMgPSBfaGFuZGxlcnNbZXZlbnRUeXBlXTtcbiAgICAgICAgaWYgKHBlckV2ZW50SGFuZGxlcnMgJiYgcGVyRXZlbnRIYW5kbGVycy5sZW5ndGgpIHtcbiAgICAgICAgICBpZiAobGlzdGVuZXIpIHtcbiAgICAgICAgICAgIGZvdW5kSW5kZXggPSBwZXJFdmVudEhhbmRsZXJzLmluZGV4T2YobGlzdGVuZXIpO1xuICAgICAgICAgICAgd2hpbGUgKGZvdW5kSW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgICAgIHBlckV2ZW50SGFuZGxlcnMuc3BsaWNlKGZvdW5kSW5kZXgsIDEpO1xuICAgICAgICAgICAgICBmb3VuZEluZGV4ID0gcGVyRXZlbnRIYW5kbGVycy5pbmRleE9mKGxpc3RlbmVyLCBmb3VuZEluZGV4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcGVyRXZlbnRIYW5kbGVycy5sZW5ndGggPSAwO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gWmVyb0NsaXBib2FyZDtcbiAgfTtcbiAgLyoqXG4gKiBUaGUgdW5kZXJseWluZyBpbXBsZW1lbnRhdGlvbiBvZiBgWmVyb0NsaXBib2FyZC5oYW5kbGVyc2AuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfbGlzdGVuZXJzID0gZnVuY3Rpb24oZXZlbnRUeXBlKSB7XG4gICAgdmFyIGNvcHk7XG4gICAgaWYgKHR5cGVvZiBldmVudFR5cGUgPT09IFwic3RyaW5nXCIgJiYgZXZlbnRUeXBlKSB7XG4gICAgICBjb3B5ID0gX2RlZXBDb3B5KF9oYW5kbGVyc1tldmVudFR5cGVdKSB8fCBudWxsO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb3B5ID0gX2RlZXBDb3B5KF9oYW5kbGVycyk7XG4gICAgfVxuICAgIHJldHVybiBjb3B5O1xuICB9O1xuICAvKipcbiAqIFRoZSB1bmRlcmx5aW5nIGltcGxlbWVudGF0aW9uIG9mIGBaZXJvQ2xpcGJvYXJkLmVtaXRgLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2VtaXQgPSBmdW5jdGlvbihldmVudCkge1xuICAgIHZhciBldmVudENvcHksIHJldHVyblZhbCwgdG1wO1xuICAgIGV2ZW50ID0gX2NyZWF0ZUV2ZW50KGV2ZW50KTtcbiAgICBpZiAoIWV2ZW50KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChfcHJlcHJvY2Vzc0V2ZW50KGV2ZW50KSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoZXZlbnQudHlwZSA9PT0gXCJyZWFkeVwiICYmIF9mbGFzaFN0YXRlLm92ZXJkdWUgPT09IHRydWUpIHtcbiAgICAgIHJldHVybiBaZXJvQ2xpcGJvYXJkLmVtaXQoe1xuICAgICAgICB0eXBlOiBcImVycm9yXCIsXG4gICAgICAgIG5hbWU6IFwiZmxhc2gtb3ZlcmR1ZVwiXG4gICAgICB9KTtcbiAgICB9XG4gICAgZXZlbnRDb3B5ID0gX2V4dGVuZCh7fSwgZXZlbnQpO1xuICAgIF9kaXNwYXRjaENhbGxiYWNrcy5jYWxsKHRoaXMsIGV2ZW50Q29weSk7XG4gICAgaWYgKGV2ZW50LnR5cGUgPT09IFwiY29weVwiKSB7XG4gICAgICB0bXAgPSBfbWFwQ2xpcERhdGFUb0ZsYXNoKF9jbGlwRGF0YSk7XG4gICAgICByZXR1cm5WYWwgPSB0bXAuZGF0YTtcbiAgICAgIF9jbGlwRGF0YUZvcm1hdE1hcCA9IHRtcC5mb3JtYXRNYXA7XG4gICAgfVxuICAgIHJldHVybiByZXR1cm5WYWw7XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuY3JlYXRlYC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9jcmVhdGUgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgcHJldmlvdXNTdGF0ZSA9IF9mbGFzaFN0YXRlLnNhbmRib3hlZDtcbiAgICBfZGV0ZWN0U2FuZGJveCgpO1xuICAgIGlmICh0eXBlb2YgX2ZsYXNoU3RhdGUucmVhZHkgIT09IFwiYm9vbGVhblwiKSB7XG4gICAgICBfZmxhc2hTdGF0ZS5yZWFkeSA9IGZhbHNlO1xuICAgIH1cbiAgICBpZiAoX2ZsYXNoU3RhdGUuc2FuZGJveGVkICE9PSBwcmV2aW91c1N0YXRlICYmIF9mbGFzaFN0YXRlLnNhbmRib3hlZCA9PT0gdHJ1ZSkge1xuICAgICAgX2ZsYXNoU3RhdGUucmVhZHkgPSBmYWxzZTtcbiAgICAgIFplcm9DbGlwYm9hcmQuZW1pdCh7XG4gICAgICAgIHR5cGU6IFwiZXJyb3JcIixcbiAgICAgICAgbmFtZTogXCJmbGFzaC1zYW5kYm94ZWRcIlxuICAgICAgfSk7XG4gICAgfSBlbHNlIGlmICghWmVyb0NsaXBib2FyZC5pc0ZsYXNoVW51c2FibGUoKSAmJiBfZmxhc2hTdGF0ZS5icmlkZ2UgPT09IG51bGwpIHtcbiAgICAgIHZhciBtYXhXYWl0ID0gX2dsb2JhbENvbmZpZy5mbGFzaExvYWRUaW1lb3V0O1xuICAgICAgaWYgKHR5cGVvZiBtYXhXYWl0ID09PSBcIm51bWJlclwiICYmIG1heFdhaXQgPj0gMCkge1xuICAgICAgICBfZmxhc2hDaGVja1RpbWVvdXQgPSBfc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICBpZiAodHlwZW9mIF9mbGFzaFN0YXRlLmRlYWN0aXZhdGVkICE9PSBcImJvb2xlYW5cIikge1xuICAgICAgICAgICAgX2ZsYXNoU3RhdGUuZGVhY3RpdmF0ZWQgPSB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoX2ZsYXNoU3RhdGUuZGVhY3RpdmF0ZWQgPT09IHRydWUpIHtcbiAgICAgICAgICAgIFplcm9DbGlwYm9hcmQuZW1pdCh7XG4gICAgICAgICAgICAgIHR5cGU6IFwiZXJyb3JcIixcbiAgICAgICAgICAgICAgbmFtZTogXCJmbGFzaC1kZWFjdGl2YXRlZFwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sIG1heFdhaXQpO1xuICAgICAgfVxuICAgICAgX2ZsYXNoU3RhdGUub3ZlcmR1ZSA9IGZhbHNlO1xuICAgICAgX2VtYmVkU3dmKCk7XG4gICAgfVxuICB9O1xuICAvKipcbiAqIFRoZSB1bmRlcmx5aW5nIGltcGxlbWVudGF0aW9uIG9mIGBaZXJvQ2xpcGJvYXJkLmRlc3Ryb3lgLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2Rlc3Ryb3kgPSBmdW5jdGlvbigpIHtcbiAgICBaZXJvQ2xpcGJvYXJkLmNsZWFyRGF0YSgpO1xuICAgIFplcm9DbGlwYm9hcmQuYmx1cigpO1xuICAgIFplcm9DbGlwYm9hcmQuZW1pdChcImRlc3Ryb3lcIik7XG4gICAgX3VuZW1iZWRTd2YoKTtcbiAgICBaZXJvQ2xpcGJvYXJkLm9mZigpO1xuICB9O1xuICAvKipcbiAqIFRoZSB1bmRlcmx5aW5nIGltcGxlbWVudGF0aW9uIG9mIGBaZXJvQ2xpcGJvYXJkLnNldERhdGFgLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX3NldERhdGEgPSBmdW5jdGlvbihmb3JtYXQsIGRhdGEpIHtcbiAgICB2YXIgZGF0YU9iajtcbiAgICBpZiAodHlwZW9mIGZvcm1hdCA9PT0gXCJvYmplY3RcIiAmJiBmb3JtYXQgJiYgdHlwZW9mIGRhdGEgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIGRhdGFPYmogPSBmb3JtYXQ7XG4gICAgICBaZXJvQ2xpcGJvYXJkLmNsZWFyRGF0YSgpO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGZvcm1hdCA9PT0gXCJzdHJpbmdcIiAmJiBmb3JtYXQpIHtcbiAgICAgIGRhdGFPYmogPSB7fTtcbiAgICAgIGRhdGFPYmpbZm9ybWF0XSA9IGRhdGE7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZm9yICh2YXIgZGF0YUZvcm1hdCBpbiBkYXRhT2JqKSB7XG4gICAgICBpZiAodHlwZW9mIGRhdGFGb3JtYXQgPT09IFwic3RyaW5nXCIgJiYgZGF0YUZvcm1hdCAmJiBfaGFzT3duLmNhbGwoZGF0YU9iaiwgZGF0YUZvcm1hdCkgJiYgdHlwZW9mIGRhdGFPYmpbZGF0YUZvcm1hdF0gPT09IFwic3RyaW5nXCIgJiYgZGF0YU9ialtkYXRhRm9ybWF0XSkge1xuICAgICAgICBfY2xpcERhdGFbZGF0YUZvcm1hdF0gPSBkYXRhT2JqW2RhdGFGb3JtYXRdO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbiAgLyoqXG4gKiBUaGUgdW5kZXJseWluZyBpbXBsZW1lbnRhdGlvbiBvZiBgWmVyb0NsaXBib2FyZC5jbGVhckRhdGFgLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2NsZWFyRGF0YSA9IGZ1bmN0aW9uKGZvcm1hdCkge1xuICAgIGlmICh0eXBlb2YgZm9ybWF0ID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICBfZGVsZXRlT3duUHJvcGVydGllcyhfY2xpcERhdGEpO1xuICAgICAgX2NsaXBEYXRhRm9ybWF0TWFwID0gbnVsbDtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBmb3JtYXQgPT09IFwic3RyaW5nXCIgJiYgX2hhc093bi5jYWxsKF9jbGlwRGF0YSwgZm9ybWF0KSkge1xuICAgICAgZGVsZXRlIF9jbGlwRGF0YVtmb3JtYXRdO1xuICAgIH1cbiAgfTtcbiAgLyoqXG4gKiBUaGUgdW5kZXJseWluZyBpbXBsZW1lbnRhdGlvbiBvZiBgWmVyb0NsaXBib2FyZC5nZXREYXRhYC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9nZXREYXRhID0gZnVuY3Rpb24oZm9ybWF0KSB7XG4gICAgaWYgKHR5cGVvZiBmb3JtYXQgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIHJldHVybiBfZGVlcENvcHkoX2NsaXBEYXRhKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBmb3JtYXQgPT09IFwic3RyaW5nXCIgJiYgX2hhc093bi5jYWxsKF9jbGlwRGF0YSwgZm9ybWF0KSkge1xuICAgICAgcmV0dXJuIF9jbGlwRGF0YVtmb3JtYXRdO1xuICAgIH1cbiAgfTtcbiAgLyoqXG4gKiBUaGUgdW5kZXJseWluZyBpbXBsZW1lbnRhdGlvbiBvZiBgWmVyb0NsaXBib2FyZC5mb2N1c2AvYFplcm9DbGlwYm9hcmQuYWN0aXZhdGVgLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2ZvY3VzID0gZnVuY3Rpb24oZWxlbWVudCkge1xuICAgIGlmICghKGVsZW1lbnQgJiYgZWxlbWVudC5ub2RlVHlwZSA9PT0gMSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKF9jdXJyZW50RWxlbWVudCkge1xuICAgICAgX3JlbW92ZUNsYXNzKF9jdXJyZW50RWxlbWVudCwgX2dsb2JhbENvbmZpZy5hY3RpdmVDbGFzcyk7XG4gICAgICBpZiAoX2N1cnJlbnRFbGVtZW50ICE9PSBlbGVtZW50KSB7XG4gICAgICAgIF9yZW1vdmVDbGFzcyhfY3VycmVudEVsZW1lbnQsIF9nbG9iYWxDb25maWcuaG92ZXJDbGFzcyk7XG4gICAgICB9XG4gICAgfVxuICAgIF9jdXJyZW50RWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgX2FkZENsYXNzKGVsZW1lbnQsIF9nbG9iYWxDb25maWcuaG92ZXJDbGFzcyk7XG4gICAgdmFyIG5ld1RpdGxlID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJ0aXRsZVwiKSB8fCBfZ2xvYmFsQ29uZmlnLnRpdGxlO1xuICAgIGlmICh0eXBlb2YgbmV3VGl0bGUgPT09IFwic3RyaW5nXCIgJiYgbmV3VGl0bGUpIHtcbiAgICAgIHZhciBodG1sQnJpZGdlID0gX2dldEh0bWxCcmlkZ2UoX2ZsYXNoU3RhdGUuYnJpZGdlKTtcbiAgICAgIGlmIChodG1sQnJpZGdlKSB7XG4gICAgICAgIGh0bWxCcmlkZ2Uuc2V0QXR0cmlidXRlKFwidGl0bGVcIiwgbmV3VGl0bGUpO1xuICAgICAgfVxuICAgIH1cbiAgICB2YXIgdXNlSGFuZEN1cnNvciA9IF9nbG9iYWxDb25maWcuZm9yY2VIYW5kQ3Vyc29yID09PSB0cnVlIHx8IF9nZXRTdHlsZShlbGVtZW50LCBcImN1cnNvclwiKSA9PT0gXCJwb2ludGVyXCI7XG4gICAgX3NldEhhbmRDdXJzb3IodXNlSGFuZEN1cnNvcik7XG4gICAgX3JlcG9zaXRpb24oKTtcbiAgfTtcbiAgLyoqXG4gKiBUaGUgdW5kZXJseWluZyBpbXBsZW1lbnRhdGlvbiBvZiBgWmVyb0NsaXBib2FyZC5ibHVyYC9gWmVyb0NsaXBib2FyZC5kZWFjdGl2YXRlYC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9ibHVyID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGh0bWxCcmlkZ2UgPSBfZ2V0SHRtbEJyaWRnZShfZmxhc2hTdGF0ZS5icmlkZ2UpO1xuICAgIGlmIChodG1sQnJpZGdlKSB7XG4gICAgICBodG1sQnJpZGdlLnJlbW92ZUF0dHJpYnV0ZShcInRpdGxlXCIpO1xuICAgICAgaHRtbEJyaWRnZS5zdHlsZS5sZWZ0ID0gXCIwcHhcIjtcbiAgICAgIGh0bWxCcmlkZ2Uuc3R5bGUudG9wID0gXCItOTk5OXB4XCI7XG4gICAgICBodG1sQnJpZGdlLnN0eWxlLndpZHRoID0gXCIxcHhcIjtcbiAgICAgIGh0bWxCcmlkZ2Uuc3R5bGUuaGVpZ2h0ID0gXCIxcHhcIjtcbiAgICB9XG4gICAgaWYgKF9jdXJyZW50RWxlbWVudCkge1xuICAgICAgX3JlbW92ZUNsYXNzKF9jdXJyZW50RWxlbWVudCwgX2dsb2JhbENvbmZpZy5ob3ZlckNsYXNzKTtcbiAgICAgIF9yZW1vdmVDbGFzcyhfY3VycmVudEVsZW1lbnQsIF9nbG9iYWxDb25maWcuYWN0aXZlQ2xhc3MpO1xuICAgICAgX2N1cnJlbnRFbGVtZW50ID0gbnVsbDtcbiAgICB9XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuYWN0aXZlRWxlbWVudGAuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfYWN0aXZlRWxlbWVudCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfY3VycmVudEVsZW1lbnQgfHwgbnVsbDtcbiAgfTtcbiAgLyoqXG4gKiBDaGVjayBpZiBhIHZhbHVlIGlzIGEgdmFsaWQgSFRNTDQgYElEYCBvciBgTmFtZWAgdG9rZW4uXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfaXNWYWxpZEh0bWw0SWQgPSBmdW5jdGlvbihpZCkge1xuICAgIHJldHVybiB0eXBlb2YgaWQgPT09IFwic3RyaW5nXCIgJiYgaWQgJiYgL15bQS1aYS16XVtBLVphLXowLTlfOlxcLVxcLl0qJC8udGVzdChpZCk7XG4gIH07XG4gIC8qKlxuICogQ3JlYXRlIG9yIHVwZGF0ZSBhbiBgZXZlbnRgIG9iamVjdCwgYmFzZWQgb24gdGhlIGBldmVudFR5cGVgLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2NyZWF0ZUV2ZW50ID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICB2YXIgZXZlbnRUeXBlO1xuICAgIGlmICh0eXBlb2YgZXZlbnQgPT09IFwic3RyaW5nXCIgJiYgZXZlbnQpIHtcbiAgICAgIGV2ZW50VHlwZSA9IGV2ZW50O1xuICAgICAgZXZlbnQgPSB7fTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBldmVudCA9PT0gXCJvYmplY3RcIiAmJiBldmVudCAmJiB0eXBlb2YgZXZlbnQudHlwZSA9PT0gXCJzdHJpbmdcIiAmJiBldmVudC50eXBlKSB7XG4gICAgICBldmVudFR5cGUgPSBldmVudC50eXBlO1xuICAgIH1cbiAgICBpZiAoIWV2ZW50VHlwZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBldmVudFR5cGUgPSBldmVudFR5cGUudG9Mb3dlckNhc2UoKTtcbiAgICBpZiAoIWV2ZW50LnRhcmdldCAmJiAoL14oY29weXxhZnRlcmNvcHl8X2NsaWNrKSQvLnRlc3QoZXZlbnRUeXBlKSB8fCBldmVudFR5cGUgPT09IFwiZXJyb3JcIiAmJiBldmVudC5uYW1lID09PSBcImNsaXBib2FyZC1lcnJvclwiKSkge1xuICAgICAgZXZlbnQudGFyZ2V0ID0gX2NvcHlUYXJnZXQ7XG4gICAgfVxuICAgIF9leHRlbmQoZXZlbnQsIHtcbiAgICAgIHR5cGU6IGV2ZW50VHlwZSxcbiAgICAgIHRhcmdldDogZXZlbnQudGFyZ2V0IHx8IF9jdXJyZW50RWxlbWVudCB8fCBudWxsLFxuICAgICAgcmVsYXRlZFRhcmdldDogZXZlbnQucmVsYXRlZFRhcmdldCB8fCBudWxsLFxuICAgICAgY3VycmVudFRhcmdldDogX2ZsYXNoU3RhdGUgJiYgX2ZsYXNoU3RhdGUuYnJpZGdlIHx8IG51bGwsXG4gICAgICB0aW1lU3RhbXA6IGV2ZW50LnRpbWVTdGFtcCB8fCBfbm93KCkgfHwgbnVsbFxuICAgIH0pO1xuICAgIHZhciBtc2cgPSBfZXZlbnRNZXNzYWdlc1tldmVudC50eXBlXTtcbiAgICBpZiAoZXZlbnQudHlwZSA9PT0gXCJlcnJvclwiICYmIGV2ZW50Lm5hbWUgJiYgbXNnKSB7XG4gICAgICBtc2cgPSBtc2dbZXZlbnQubmFtZV07XG4gICAgfVxuICAgIGlmIChtc2cpIHtcbiAgICAgIGV2ZW50Lm1lc3NhZ2UgPSBtc2c7XG4gICAgfVxuICAgIGlmIChldmVudC50eXBlID09PSBcInJlYWR5XCIpIHtcbiAgICAgIF9leHRlbmQoZXZlbnQsIHtcbiAgICAgICAgdGFyZ2V0OiBudWxsLFxuICAgICAgICB2ZXJzaW9uOiBfZmxhc2hTdGF0ZS52ZXJzaW9uXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKGV2ZW50LnR5cGUgPT09IFwiZXJyb3JcIikge1xuICAgICAgaWYgKF9mbGFzaFN0YXRlRXJyb3JOYW1lTWF0Y2hpbmdSZWdleC50ZXN0KGV2ZW50Lm5hbWUpKSB7XG4gICAgICAgIF9leHRlbmQoZXZlbnQsIHtcbiAgICAgICAgICB0YXJnZXQ6IG51bGwsXG4gICAgICAgICAgbWluaW11bVZlcnNpb246IF9taW5pbXVtRmxhc2hWZXJzaW9uXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgaWYgKF9mbGFzaFN0YXRlRW5hYmxlZEVycm9yTmFtZU1hdGNoaW5nUmVnZXgudGVzdChldmVudC5uYW1lKSkge1xuICAgICAgICBfZXh0ZW5kKGV2ZW50LCB7XG4gICAgICAgICAgdmVyc2lvbjogX2ZsYXNoU3RhdGUudmVyc2lvblxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGV2ZW50LnR5cGUgPT09IFwiY29weVwiKSB7XG4gICAgICBldmVudC5jbGlwYm9hcmREYXRhID0ge1xuICAgICAgICBzZXREYXRhOiBaZXJvQ2xpcGJvYXJkLnNldERhdGEsXG4gICAgICAgIGNsZWFyRGF0YTogWmVyb0NsaXBib2FyZC5jbGVhckRhdGFcbiAgICAgIH07XG4gICAgfVxuICAgIGlmIChldmVudC50eXBlID09PSBcImFmdGVyY29weVwiKSB7XG4gICAgICBldmVudCA9IF9tYXBDbGlwUmVzdWx0c0Zyb21GbGFzaChldmVudCwgX2NsaXBEYXRhRm9ybWF0TWFwKTtcbiAgICB9XG4gICAgaWYgKGV2ZW50LnRhcmdldCAmJiAhZXZlbnQucmVsYXRlZFRhcmdldCkge1xuICAgICAgZXZlbnQucmVsYXRlZFRhcmdldCA9IF9nZXRSZWxhdGVkVGFyZ2V0KGV2ZW50LnRhcmdldCk7XG4gICAgfVxuICAgIHJldHVybiBfYWRkTW91c2VEYXRhKGV2ZW50KTtcbiAgfTtcbiAgLyoqXG4gKiBHZXQgYSByZWxhdGVkVGFyZ2V0IGZyb20gdGhlIHRhcmdldCdzIGBkYXRhLWNsaXBib2FyZC10YXJnZXRgIGF0dHJpYnV0ZVxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2dldFJlbGF0ZWRUYXJnZXQgPSBmdW5jdGlvbih0YXJnZXRFbCkge1xuICAgIHZhciByZWxhdGVkVGFyZ2V0SWQgPSB0YXJnZXRFbCAmJiB0YXJnZXRFbC5nZXRBdHRyaWJ1dGUgJiYgdGFyZ2V0RWwuZ2V0QXR0cmlidXRlKFwiZGF0YS1jbGlwYm9hcmQtdGFyZ2V0XCIpO1xuICAgIHJldHVybiByZWxhdGVkVGFyZ2V0SWQgPyBfZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVsYXRlZFRhcmdldElkKSA6IG51bGw7XG4gIH07XG4gIC8qKlxuICogQWRkIGVsZW1lbnQgYW5kIHBvc2l0aW9uIGRhdGEgdG8gYE1vdXNlRXZlbnRgIGluc3RhbmNlc1xuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2FkZE1vdXNlRGF0YSA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgaWYgKGV2ZW50ICYmIC9eXyg/OmNsaWNrfG1vdXNlKD86b3ZlcnxvdXR8ZG93bnx1cHxtb3ZlKSkkLy50ZXN0KGV2ZW50LnR5cGUpKSB7XG4gICAgICB2YXIgc3JjRWxlbWVudCA9IGV2ZW50LnRhcmdldDtcbiAgICAgIHZhciBmcm9tRWxlbWVudCA9IGV2ZW50LnR5cGUgPT09IFwiX21vdXNlb3ZlclwiICYmIGV2ZW50LnJlbGF0ZWRUYXJnZXQgPyBldmVudC5yZWxhdGVkVGFyZ2V0IDogdW5kZWZpbmVkO1xuICAgICAgdmFyIHRvRWxlbWVudCA9IGV2ZW50LnR5cGUgPT09IFwiX21vdXNlb3V0XCIgJiYgZXZlbnQucmVsYXRlZFRhcmdldCA/IGV2ZW50LnJlbGF0ZWRUYXJnZXQgOiB1bmRlZmluZWQ7XG4gICAgICB2YXIgcG9zID0gX2dldEVsZW1lbnRQb3NpdGlvbihzcmNFbGVtZW50KTtcbiAgICAgIHZhciBzY3JlZW5MZWZ0ID0gX3dpbmRvdy5zY3JlZW5MZWZ0IHx8IF93aW5kb3cuc2NyZWVuWCB8fCAwO1xuICAgICAgdmFyIHNjcmVlblRvcCA9IF93aW5kb3cuc2NyZWVuVG9wIHx8IF93aW5kb3cuc2NyZWVuWSB8fCAwO1xuICAgICAgdmFyIHNjcm9sbExlZnQgPSBfZG9jdW1lbnQuYm9keS5zY3JvbGxMZWZ0ICsgX2RvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxMZWZ0O1xuICAgICAgdmFyIHNjcm9sbFRvcCA9IF9kb2N1bWVudC5ib2R5LnNjcm9sbFRvcCArIF9kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wO1xuICAgICAgdmFyIHBhZ2VYID0gcG9zLmxlZnQgKyAodHlwZW9mIGV2ZW50Ll9zdGFnZVggPT09IFwibnVtYmVyXCIgPyBldmVudC5fc3RhZ2VYIDogMCk7XG4gICAgICB2YXIgcGFnZVkgPSBwb3MudG9wICsgKHR5cGVvZiBldmVudC5fc3RhZ2VZID09PSBcIm51bWJlclwiID8gZXZlbnQuX3N0YWdlWSA6IDApO1xuICAgICAgdmFyIGNsaWVudFggPSBwYWdlWCAtIHNjcm9sbExlZnQ7XG4gICAgICB2YXIgY2xpZW50WSA9IHBhZ2VZIC0gc2Nyb2xsVG9wO1xuICAgICAgdmFyIHNjcmVlblggPSBzY3JlZW5MZWZ0ICsgY2xpZW50WDtcbiAgICAgIHZhciBzY3JlZW5ZID0gc2NyZWVuVG9wICsgY2xpZW50WTtcbiAgICAgIHZhciBtb3ZlWCA9IHR5cGVvZiBldmVudC5tb3ZlbWVudFggPT09IFwibnVtYmVyXCIgPyBldmVudC5tb3ZlbWVudFggOiAwO1xuICAgICAgdmFyIG1vdmVZID0gdHlwZW9mIGV2ZW50Lm1vdmVtZW50WSA9PT0gXCJudW1iZXJcIiA/IGV2ZW50Lm1vdmVtZW50WSA6IDA7XG4gICAgICBkZWxldGUgZXZlbnQuX3N0YWdlWDtcbiAgICAgIGRlbGV0ZSBldmVudC5fc3RhZ2VZO1xuICAgICAgX2V4dGVuZChldmVudCwge1xuICAgICAgICBzcmNFbGVtZW50OiBzcmNFbGVtZW50LFxuICAgICAgICBmcm9tRWxlbWVudDogZnJvbUVsZW1lbnQsXG4gICAgICAgIHRvRWxlbWVudDogdG9FbGVtZW50LFxuICAgICAgICBzY3JlZW5YOiBzY3JlZW5YLFxuICAgICAgICBzY3JlZW5ZOiBzY3JlZW5ZLFxuICAgICAgICBwYWdlWDogcGFnZVgsXG4gICAgICAgIHBhZ2VZOiBwYWdlWSxcbiAgICAgICAgY2xpZW50WDogY2xpZW50WCxcbiAgICAgICAgY2xpZW50WTogY2xpZW50WSxcbiAgICAgICAgeDogY2xpZW50WCxcbiAgICAgICAgeTogY2xpZW50WSxcbiAgICAgICAgbW92ZW1lbnRYOiBtb3ZlWCxcbiAgICAgICAgbW92ZW1lbnRZOiBtb3ZlWSxcbiAgICAgICAgb2Zmc2V0WDogMCxcbiAgICAgICAgb2Zmc2V0WTogMCxcbiAgICAgICAgbGF5ZXJYOiAwLFxuICAgICAgICBsYXllclk6IDBcbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gZXZlbnQ7XG4gIH07XG4gIC8qKlxuICogRGV0ZXJtaW5lIGlmIGFuIGV2ZW50J3MgcmVnaXN0ZXJlZCBoYW5kbGVycyBzaG91bGQgYmUgZXhlY3V0ZSBzeW5jaHJvbm91c2x5IG9yIGFzeW5jaHJvbm91c2x5LlxuICpcbiAqIEByZXR1cm5zIHtib29sZWFufVxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX3Nob3VsZFBlcmZvcm1Bc3luYyA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgdmFyIGV2ZW50VHlwZSA9IGV2ZW50ICYmIHR5cGVvZiBldmVudC50eXBlID09PSBcInN0cmluZ1wiICYmIGV2ZW50LnR5cGUgfHwgXCJcIjtcbiAgICByZXR1cm4gIS9eKD86KD86YmVmb3JlKT9jb3B5fGRlc3Ryb3kpJC8udGVzdChldmVudFR5cGUpO1xuICB9O1xuICAvKipcbiAqIENvbnRyb2wgaWYgYSBjYWxsYmFjayBzaG91bGQgYmUgZXhlY3V0ZWQgYXN5bmNocm9ub3VzbHkgb3Igbm90LlxuICpcbiAqIEByZXR1cm5zIGB1bmRlZmluZWRgXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZGlzcGF0Y2hDYWxsYmFjayA9IGZ1bmN0aW9uKGZ1bmMsIGNvbnRleHQsIGFyZ3MsIGFzeW5jKSB7XG4gICAgaWYgKGFzeW5jKSB7XG4gICAgICBfc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcbiAgICAgIH0sIDApO1xuICAgIH0gZWxzZSB7XG4gICAgICBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xuICAgIH1cbiAgfTtcbiAgLyoqXG4gKiBIYW5kbGUgdGhlIGFjdHVhbCBkaXNwYXRjaGluZyBvZiBldmVudHMgdG8gY2xpZW50IGluc3RhbmNlcy5cbiAqXG4gKiBAcmV0dXJucyBgdW5kZWZpbmVkYFxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2Rpc3BhdGNoQ2FsbGJhY2tzID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICBpZiAoISh0eXBlb2YgZXZlbnQgPT09IFwib2JqZWN0XCIgJiYgZXZlbnQgJiYgZXZlbnQudHlwZSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIGFzeW5jID0gX3Nob3VsZFBlcmZvcm1Bc3luYyhldmVudCk7XG4gICAgdmFyIHdpbGRjYXJkVHlwZUhhbmRsZXJzID0gX2hhbmRsZXJzW1wiKlwiXSB8fCBbXTtcbiAgICB2YXIgc3BlY2lmaWNUeXBlSGFuZGxlcnMgPSBfaGFuZGxlcnNbZXZlbnQudHlwZV0gfHwgW107XG4gICAgdmFyIGhhbmRsZXJzID0gd2lsZGNhcmRUeXBlSGFuZGxlcnMuY29uY2F0KHNwZWNpZmljVHlwZUhhbmRsZXJzKTtcbiAgICBpZiAoaGFuZGxlcnMgJiYgaGFuZGxlcnMubGVuZ3RoKSB7XG4gICAgICB2YXIgaSwgbGVuLCBmdW5jLCBjb250ZXh0LCBldmVudENvcHksIG9yaWdpbmFsQ29udGV4dCA9IHRoaXM7XG4gICAgICBmb3IgKGkgPSAwLCBsZW4gPSBoYW5kbGVycy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBmdW5jID0gaGFuZGxlcnNbaV07XG4gICAgICAgIGNvbnRleHQgPSBvcmlnaW5hbENvbnRleHQ7XG4gICAgICAgIGlmICh0eXBlb2YgZnVuYyA9PT0gXCJzdHJpbmdcIiAmJiB0eXBlb2YgX3dpbmRvd1tmdW5jXSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgZnVuYyA9IF93aW5kb3dbZnVuY107XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBmdW5jID09PSBcIm9iamVjdFwiICYmIGZ1bmMgJiYgdHlwZW9mIGZ1bmMuaGFuZGxlRXZlbnQgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgIGNvbnRleHQgPSBmdW5jO1xuICAgICAgICAgIGZ1bmMgPSBmdW5jLmhhbmRsZUV2ZW50O1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgZnVuYyA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgZXZlbnRDb3B5ID0gX2V4dGVuZCh7fSwgZXZlbnQpO1xuICAgICAgICAgIF9kaXNwYXRjaENhbGxiYWNrKGZ1bmMsIGNvbnRleHQsIFsgZXZlbnRDb3B5IF0sIGFzeW5jKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcbiAgLyoqXG4gKiBDaGVjayBhbiBgZXJyb3JgIGV2ZW50J3MgYG5hbWVgIHByb3BlcnR5IHRvIHNlZSBpZiBGbGFzaCBoYXNcbiAqIGFscmVhZHkgbG9hZGVkLCB3aGljaCBydWxlcyBvdXQgcG9zc2libGUgYGlmcmFtZWAgc2FuZGJveGluZy5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9nZXRTYW5kYm94U3RhdHVzRnJvbUVycm9yRXZlbnQgPSBmdW5jdGlvbihldmVudCkge1xuICAgIHZhciBpc1NhbmRib3hlZCA9IG51bGw7XG4gICAgaWYgKF9wYWdlSXNGcmFtZWQgPT09IGZhbHNlIHx8IGV2ZW50ICYmIGV2ZW50LnR5cGUgPT09IFwiZXJyb3JcIiAmJiBldmVudC5uYW1lICYmIF9lcnJvcnNUaGF0T25seU9jY3VyQWZ0ZXJGbGFzaExvYWRzLmluZGV4T2YoZXZlbnQubmFtZSkgIT09IC0xKSB7XG4gICAgICBpc1NhbmRib3hlZCA9IGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gaXNTYW5kYm94ZWQ7XG4gIH07XG4gIC8qKlxuICogUHJlcHJvY2VzcyBhbnkgc3BlY2lhbCBiZWhhdmlvcnMsIHJlYWN0aW9ucywgb3Igc3RhdGUgY2hhbmdlcyBhZnRlciByZWNlaXZpbmcgdGhpcyBldmVudC5cbiAqIEV4ZWN1dGVzIG9ubHkgb25jZSBwZXIgZXZlbnQgZW1pdHRlZCwgTk9UIG9uY2UgcGVyIGNsaWVudC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9wcmVwcm9jZXNzRXZlbnQgPSBmdW5jdGlvbihldmVudCkge1xuICAgIHZhciBlbGVtZW50ID0gZXZlbnQudGFyZ2V0IHx8IF9jdXJyZW50RWxlbWVudCB8fCBudWxsO1xuICAgIHZhciBzb3VyY2VJc1N3ZiA9IGV2ZW50Ll9zb3VyY2UgPT09IFwic3dmXCI7XG4gICAgZGVsZXRlIGV2ZW50Ll9zb3VyY2U7XG4gICAgc3dpdGNoIChldmVudC50eXBlKSB7XG4gICAgIGNhc2UgXCJlcnJvclwiOlxuICAgICAgdmFyIGlzU2FuZGJveGVkID0gZXZlbnQubmFtZSA9PT0gXCJmbGFzaC1zYW5kYm94ZWRcIiB8fCBfZ2V0U2FuZGJveFN0YXR1c0Zyb21FcnJvckV2ZW50KGV2ZW50KTtcbiAgICAgIGlmICh0eXBlb2YgaXNTYW5kYm94ZWQgPT09IFwiYm9vbGVhblwiKSB7XG4gICAgICAgIF9mbGFzaFN0YXRlLnNhbmRib3hlZCA9IGlzU2FuZGJveGVkO1xuICAgICAgfVxuICAgICAgaWYgKF9mbGFzaFN0YXRlRXJyb3JOYW1lcy5pbmRleE9mKGV2ZW50Lm5hbWUpICE9PSAtMSkge1xuICAgICAgICBfZXh0ZW5kKF9mbGFzaFN0YXRlLCB7XG4gICAgICAgICAgZGlzYWJsZWQ6IGV2ZW50Lm5hbWUgPT09IFwiZmxhc2gtZGlzYWJsZWRcIixcbiAgICAgICAgICBvdXRkYXRlZDogZXZlbnQubmFtZSA9PT0gXCJmbGFzaC1vdXRkYXRlZFwiLFxuICAgICAgICAgIHVuYXZhaWxhYmxlOiBldmVudC5uYW1lID09PSBcImZsYXNoLXVuYXZhaWxhYmxlXCIsXG4gICAgICAgICAgZGVncmFkZWQ6IGV2ZW50Lm5hbWUgPT09IFwiZmxhc2gtZGVncmFkZWRcIixcbiAgICAgICAgICBkZWFjdGl2YXRlZDogZXZlbnQubmFtZSA9PT0gXCJmbGFzaC1kZWFjdGl2YXRlZFwiLFxuICAgICAgICAgIG92ZXJkdWU6IGV2ZW50Lm5hbWUgPT09IFwiZmxhc2gtb3ZlcmR1ZVwiLFxuICAgICAgICAgIHJlYWR5OiBmYWxzZVxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSBpZiAoZXZlbnQubmFtZSA9PT0gXCJ2ZXJzaW9uLW1pc21hdGNoXCIpIHtcbiAgICAgICAgX3pjU3dmVmVyc2lvbiA9IGV2ZW50LnN3ZlZlcnNpb247XG4gICAgICAgIF9leHRlbmQoX2ZsYXNoU3RhdGUsIHtcbiAgICAgICAgICBkaXNhYmxlZDogZmFsc2UsXG4gICAgICAgICAgb3V0ZGF0ZWQ6IGZhbHNlLFxuICAgICAgICAgIHVuYXZhaWxhYmxlOiBmYWxzZSxcbiAgICAgICAgICBkZWdyYWRlZDogZmFsc2UsXG4gICAgICAgICAgZGVhY3RpdmF0ZWQ6IGZhbHNlLFxuICAgICAgICAgIG92ZXJkdWU6IGZhbHNlLFxuICAgICAgICAgIHJlYWR5OiBmYWxzZVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIF9jbGVhclRpbWVvdXRzQW5kUG9sbGluZygpO1xuICAgICAgYnJlYWs7XG5cbiAgICAgY2FzZSBcInJlYWR5XCI6XG4gICAgICBfemNTd2ZWZXJzaW9uID0gZXZlbnQuc3dmVmVyc2lvbjtcbiAgICAgIHZhciB3YXNEZWFjdGl2YXRlZCA9IF9mbGFzaFN0YXRlLmRlYWN0aXZhdGVkID09PSB0cnVlO1xuICAgICAgX2V4dGVuZChfZmxhc2hTdGF0ZSwge1xuICAgICAgICBkaXNhYmxlZDogZmFsc2UsXG4gICAgICAgIG91dGRhdGVkOiBmYWxzZSxcbiAgICAgICAgc2FuZGJveGVkOiBmYWxzZSxcbiAgICAgICAgdW5hdmFpbGFibGU6IGZhbHNlLFxuICAgICAgICBkZWdyYWRlZDogZmFsc2UsXG4gICAgICAgIGRlYWN0aXZhdGVkOiBmYWxzZSxcbiAgICAgICAgb3ZlcmR1ZTogd2FzRGVhY3RpdmF0ZWQsXG4gICAgICAgIHJlYWR5OiAhd2FzRGVhY3RpdmF0ZWRcbiAgICAgIH0pO1xuICAgICAgX2NsZWFyVGltZW91dHNBbmRQb2xsaW5nKCk7XG4gICAgICBicmVhaztcblxuICAgICBjYXNlIFwiYmVmb3JlY29weVwiOlxuICAgICAgX2NvcHlUYXJnZXQgPSBlbGVtZW50O1xuICAgICAgYnJlYWs7XG5cbiAgICAgY2FzZSBcImNvcHlcIjpcbiAgICAgIHZhciB0ZXh0Q29udGVudCwgaHRtbENvbnRlbnQsIHRhcmdldEVsID0gZXZlbnQucmVsYXRlZFRhcmdldDtcbiAgICAgIGlmICghKF9jbGlwRGF0YVtcInRleHQvaHRtbFwiXSB8fCBfY2xpcERhdGFbXCJ0ZXh0L3BsYWluXCJdKSAmJiB0YXJnZXRFbCAmJiAoaHRtbENvbnRlbnQgPSB0YXJnZXRFbC52YWx1ZSB8fCB0YXJnZXRFbC5vdXRlckhUTUwgfHwgdGFyZ2V0RWwuaW5uZXJIVE1MKSAmJiAodGV4dENvbnRlbnQgPSB0YXJnZXRFbC52YWx1ZSB8fCB0YXJnZXRFbC50ZXh0Q29udGVudCB8fCB0YXJnZXRFbC5pbm5lclRleHQpKSB7XG4gICAgICAgIGV2ZW50LmNsaXBib2FyZERhdGEuY2xlYXJEYXRhKCk7XG4gICAgICAgIGV2ZW50LmNsaXBib2FyZERhdGEuc2V0RGF0YShcInRleHQvcGxhaW5cIiwgdGV4dENvbnRlbnQpO1xuICAgICAgICBpZiAoaHRtbENvbnRlbnQgIT09IHRleHRDb250ZW50KSB7XG4gICAgICAgICAgZXZlbnQuY2xpcGJvYXJkRGF0YS5zZXREYXRhKFwidGV4dC9odG1sXCIsIGh0bWxDb250ZW50KTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmICghX2NsaXBEYXRhW1widGV4dC9wbGFpblwiXSAmJiBldmVudC50YXJnZXQgJiYgKHRleHRDb250ZW50ID0gZXZlbnQudGFyZ2V0LmdldEF0dHJpYnV0ZShcImRhdGEtY2xpcGJvYXJkLXRleHRcIikpKSB7XG4gICAgICAgIGV2ZW50LmNsaXBib2FyZERhdGEuY2xlYXJEYXRhKCk7XG4gICAgICAgIGV2ZW50LmNsaXBib2FyZERhdGEuc2V0RGF0YShcInRleHQvcGxhaW5cIiwgdGV4dENvbnRlbnQpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG5cbiAgICAgY2FzZSBcImFmdGVyY29weVwiOlxuICAgICAgX3F1ZXVlRW1pdENsaXBib2FyZEVycm9ycyhldmVudCk7XG4gICAgICBaZXJvQ2xpcGJvYXJkLmNsZWFyRGF0YSgpO1xuICAgICAgaWYgKGVsZW1lbnQgJiYgZWxlbWVudCAhPT0gX3NhZmVBY3RpdmVFbGVtZW50KCkgJiYgZWxlbWVudC5mb2N1cykge1xuICAgICAgICBlbGVtZW50LmZvY3VzKCk7XG4gICAgICB9XG4gICAgICBicmVhaztcblxuICAgICBjYXNlIFwiX21vdXNlb3ZlclwiOlxuICAgICAgWmVyb0NsaXBib2FyZC5mb2N1cyhlbGVtZW50KTtcbiAgICAgIGlmIChfZ2xvYmFsQ29uZmlnLmJ1YmJsZUV2ZW50cyA9PT0gdHJ1ZSAmJiBzb3VyY2VJc1N3Zikge1xuICAgICAgICBpZiAoZWxlbWVudCAmJiBlbGVtZW50ICE9PSBldmVudC5yZWxhdGVkVGFyZ2V0ICYmICFfY29udGFpbmVkQnkoZXZlbnQucmVsYXRlZFRhcmdldCwgZWxlbWVudCkpIHtcbiAgICAgICAgICBfZmlyZU1vdXNlRXZlbnQoX2V4dGVuZCh7fSwgZXZlbnQsIHtcbiAgICAgICAgICAgIHR5cGU6IFwibW91c2VlbnRlclwiLFxuICAgICAgICAgICAgYnViYmxlczogZmFsc2UsXG4gICAgICAgICAgICBjYW5jZWxhYmxlOiBmYWxzZVxuICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBfZmlyZU1vdXNlRXZlbnQoX2V4dGVuZCh7fSwgZXZlbnQsIHtcbiAgICAgICAgICB0eXBlOiBcIm1vdXNlb3ZlclwiXG4gICAgICAgIH0pKTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuXG4gICAgIGNhc2UgXCJfbW91c2VvdXRcIjpcbiAgICAgIFplcm9DbGlwYm9hcmQuYmx1cigpO1xuICAgICAgaWYgKF9nbG9iYWxDb25maWcuYnViYmxlRXZlbnRzID09PSB0cnVlICYmIHNvdXJjZUlzU3dmKSB7XG4gICAgICAgIGlmIChlbGVtZW50ICYmIGVsZW1lbnQgIT09IGV2ZW50LnJlbGF0ZWRUYXJnZXQgJiYgIV9jb250YWluZWRCeShldmVudC5yZWxhdGVkVGFyZ2V0LCBlbGVtZW50KSkge1xuICAgICAgICAgIF9maXJlTW91c2VFdmVudChfZXh0ZW5kKHt9LCBldmVudCwge1xuICAgICAgICAgICAgdHlwZTogXCJtb3VzZWxlYXZlXCIsXG4gICAgICAgICAgICBidWJibGVzOiBmYWxzZSxcbiAgICAgICAgICAgIGNhbmNlbGFibGU6IGZhbHNlXG4gICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIF9maXJlTW91c2VFdmVudChfZXh0ZW5kKHt9LCBldmVudCwge1xuICAgICAgICAgIHR5cGU6IFwibW91c2VvdXRcIlxuICAgICAgICB9KSk7XG4gICAgICB9XG4gICAgICBicmVhaztcblxuICAgICBjYXNlIFwiX21vdXNlZG93blwiOlxuICAgICAgX2FkZENsYXNzKGVsZW1lbnQsIF9nbG9iYWxDb25maWcuYWN0aXZlQ2xhc3MpO1xuICAgICAgaWYgKF9nbG9iYWxDb25maWcuYnViYmxlRXZlbnRzID09PSB0cnVlICYmIHNvdXJjZUlzU3dmKSB7XG4gICAgICAgIF9maXJlTW91c2VFdmVudChfZXh0ZW5kKHt9LCBldmVudCwge1xuICAgICAgICAgIHR5cGU6IGV2ZW50LnR5cGUuc2xpY2UoMSlcbiAgICAgICAgfSkpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG5cbiAgICAgY2FzZSBcIl9tb3VzZXVwXCI6XG4gICAgICBfcmVtb3ZlQ2xhc3MoZWxlbWVudCwgX2dsb2JhbENvbmZpZy5hY3RpdmVDbGFzcyk7XG4gICAgICBpZiAoX2dsb2JhbENvbmZpZy5idWJibGVFdmVudHMgPT09IHRydWUgJiYgc291cmNlSXNTd2YpIHtcbiAgICAgICAgX2ZpcmVNb3VzZUV2ZW50KF9leHRlbmQoe30sIGV2ZW50LCB7XG4gICAgICAgICAgdHlwZTogZXZlbnQudHlwZS5zbGljZSgxKVxuICAgICAgICB9KSk7XG4gICAgICB9XG4gICAgICBicmVhaztcblxuICAgICBjYXNlIFwiX2NsaWNrXCI6XG4gICAgICBfY29weVRhcmdldCA9IG51bGw7XG4gICAgICBpZiAoX2dsb2JhbENvbmZpZy5idWJibGVFdmVudHMgPT09IHRydWUgJiYgc291cmNlSXNTd2YpIHtcbiAgICAgICAgX2ZpcmVNb3VzZUV2ZW50KF9leHRlbmQoe30sIGV2ZW50LCB7XG4gICAgICAgICAgdHlwZTogZXZlbnQudHlwZS5zbGljZSgxKVxuICAgICAgICB9KSk7XG4gICAgICB9XG4gICAgICBicmVhaztcblxuICAgICBjYXNlIFwiX21vdXNlbW92ZVwiOlxuICAgICAgaWYgKF9nbG9iYWxDb25maWcuYnViYmxlRXZlbnRzID09PSB0cnVlICYmIHNvdXJjZUlzU3dmKSB7XG4gICAgICAgIF9maXJlTW91c2VFdmVudChfZXh0ZW5kKHt9LCBldmVudCwge1xuICAgICAgICAgIHR5cGU6IGV2ZW50LnR5cGUuc2xpY2UoMSlcbiAgICAgICAgfSkpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gICAgfVxuICAgIGlmICgvXl8oPzpjbGlja3xtb3VzZSg/Om92ZXJ8b3V0fGRvd258dXB8bW92ZSkpJC8udGVzdChldmVudC50eXBlKSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9O1xuICAvKipcbiAqIENoZWNrIGFuIFwiYWZ0ZXJjb3B5XCIgZXZlbnQgZm9yIGNsaXBib2FyZCBlcnJvcnMgYW5kIGVtaXQgYSBjb3JyZXNwb25kaW5nIFwiZXJyb3JcIiBldmVudC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9xdWV1ZUVtaXRDbGlwYm9hcmRFcnJvcnMgPSBmdW5jdGlvbihhZnRlcmNvcHlFdmVudCkge1xuICAgIGlmIChhZnRlcmNvcHlFdmVudC5lcnJvcnMgJiYgYWZ0ZXJjb3B5RXZlbnQuZXJyb3JzLmxlbmd0aCA+IDApIHtcbiAgICAgIHZhciBlcnJvckV2ZW50ID0gX2RlZXBDb3B5KGFmdGVyY29weUV2ZW50KTtcbiAgICAgIF9leHRlbmQoZXJyb3JFdmVudCwge1xuICAgICAgICB0eXBlOiBcImVycm9yXCIsXG4gICAgICAgIG5hbWU6IFwiY2xpcGJvYXJkLWVycm9yXCJcbiAgICAgIH0pO1xuICAgICAgZGVsZXRlIGVycm9yRXZlbnQuc3VjY2VzcztcbiAgICAgIF9zZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICBaZXJvQ2xpcGJvYXJkLmVtaXQoZXJyb3JFdmVudCk7XG4gICAgICB9LCAwKTtcbiAgICB9XG4gIH07XG4gIC8qKlxuICogRGlzcGF0Y2ggYSBzeW50aGV0aWMgTW91c2VFdmVudC5cbiAqXG4gKiBAcmV0dXJucyBgdW5kZWZpbmVkYFxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2ZpcmVNb3VzZUV2ZW50ID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICBpZiAoIShldmVudCAmJiB0eXBlb2YgZXZlbnQudHlwZSA9PT0gXCJzdHJpbmdcIiAmJiBldmVudCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIGUsIHRhcmdldCA9IGV2ZW50LnRhcmdldCB8fCBudWxsLCBkb2MgPSB0YXJnZXQgJiYgdGFyZ2V0Lm93bmVyRG9jdW1lbnQgfHwgX2RvY3VtZW50LCBkZWZhdWx0cyA9IHtcbiAgICAgIHZpZXc6IGRvYy5kZWZhdWx0VmlldyB8fCBfd2luZG93LFxuICAgICAgY2FuQnViYmxlOiB0cnVlLFxuICAgICAgY2FuY2VsYWJsZTogdHJ1ZSxcbiAgICAgIGRldGFpbDogZXZlbnQudHlwZSA9PT0gXCJjbGlja1wiID8gMSA6IDAsXG4gICAgICBidXR0b246IHR5cGVvZiBldmVudC53aGljaCA9PT0gXCJudW1iZXJcIiA/IGV2ZW50LndoaWNoIC0gMSA6IHR5cGVvZiBldmVudC5idXR0b24gPT09IFwibnVtYmVyXCIgPyBldmVudC5idXR0b24gOiBkb2MuY3JlYXRlRXZlbnQgPyAwIDogMVxuICAgIH0sIGFyZ3MgPSBfZXh0ZW5kKGRlZmF1bHRzLCBldmVudCk7XG4gICAgaWYgKCF0YXJnZXQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGRvYy5jcmVhdGVFdmVudCAmJiB0YXJnZXQuZGlzcGF0Y2hFdmVudCkge1xuICAgICAgYXJncyA9IFsgYXJncy50eXBlLCBhcmdzLmNhbkJ1YmJsZSwgYXJncy5jYW5jZWxhYmxlLCBhcmdzLnZpZXcsIGFyZ3MuZGV0YWlsLCBhcmdzLnNjcmVlblgsIGFyZ3Muc2NyZWVuWSwgYXJncy5jbGllbnRYLCBhcmdzLmNsaWVudFksIGFyZ3MuY3RybEtleSwgYXJncy5hbHRLZXksIGFyZ3Muc2hpZnRLZXksIGFyZ3MubWV0YUtleSwgYXJncy5idXR0b24sIGFyZ3MucmVsYXRlZFRhcmdldCBdO1xuICAgICAgZSA9IGRvYy5jcmVhdGVFdmVudChcIk1vdXNlRXZlbnRzXCIpO1xuICAgICAgaWYgKGUuaW5pdE1vdXNlRXZlbnQpIHtcbiAgICAgICAgZS5pbml0TW91c2VFdmVudC5hcHBseShlLCBhcmdzKTtcbiAgICAgICAgZS5fc291cmNlID0gXCJqc1wiO1xuICAgICAgICB0YXJnZXQuZGlzcGF0Y2hFdmVudChlKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG4gIC8qKlxuICogQ29udGludW91c2x5IHBvbGwgdGhlIERPTSB1bnRpbCBlaXRoZXI6XG4gKiAgKGEpIHRoZSBmYWxsYmFjayBjb250ZW50IGJlY29tZXMgdmlzaWJsZSwgb3JcbiAqICAoYikgd2UgcmVjZWl2ZSBhbiBldmVudCBmcm9tIFNXRiAoaGFuZGxlZCBlbHNld2hlcmUpXG4gKlxuICogSU1QT1JUQU5UOlxuICogVGhpcyBpcyBOT1QgYSBuZWNlc3NhcnkgY2hlY2sgYnV0IGl0IGNhbiByZXN1bHQgaW4gc2lnbmlmaWNhbnRseSBmYXN0ZXJcbiAqIGRldGVjdGlvbiBvZiBiYWQgYHN3ZlBhdGhgIGNvbmZpZ3VyYXRpb24gYW5kL29yIG5ldHdvcmsvc2VydmVyIGlzc3VlcyBbaW5cbiAqIHN1cHBvcnRlZCBicm93c2Vyc10gdGhhbiB3YWl0aW5nIGZvciB0aGUgZW50aXJlIGBmbGFzaExvYWRUaW1lb3V0YCBkdXJhdGlvblxuICogdG8gZWxhcHNlIGJlZm9yZSBkZXRlY3RpbmcgdGhhdCB0aGUgU1dGIGNhbm5vdCBiZSBsb2FkZWQuIFRoZSBkZXRlY3Rpb25cbiAqIGR1cmF0aW9uIGNhbiBiZSBhbnl3aGVyZSBmcm9tIDEwLTMwIHRpbWVzIGZhc3RlciBbaW4gc3VwcG9ydGVkIGJyb3dzZXJzXSBieVxuICogdXNpbmcgdGhpcyBhcHByb2FjaC5cbiAqXG4gKiBAcmV0dXJucyBgdW5kZWZpbmVkYFxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX3dhdGNoRm9yU3dmRmFsbGJhY2tDb250ZW50ID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIG1heFdhaXQgPSBfZ2xvYmFsQ29uZmlnLmZsYXNoTG9hZFRpbWVvdXQ7XG4gICAgaWYgKHR5cGVvZiBtYXhXYWl0ID09PSBcIm51bWJlclwiICYmIG1heFdhaXQgPj0gMCkge1xuICAgICAgdmFyIHBvbGxXYWl0ID0gTWF0aC5taW4oMWUzLCBtYXhXYWl0IC8gMTApO1xuICAgICAgdmFyIGZhbGxiYWNrQ29udGVudElkID0gX2dsb2JhbENvbmZpZy5zd2ZPYmplY3RJZCArIFwiX2ZhbGxiYWNrQ29udGVudFwiO1xuICAgICAgX3N3ZkZhbGxiYWNrQ2hlY2tJbnRlcnZhbCA9IF9zZXRJbnRlcnZhbChmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGVsID0gX2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKGZhbGxiYWNrQ29udGVudElkKTtcbiAgICAgICAgaWYgKF9pc0VsZW1lbnRWaXNpYmxlKGVsKSkge1xuICAgICAgICAgIF9jbGVhclRpbWVvdXRzQW5kUG9sbGluZygpO1xuICAgICAgICAgIF9mbGFzaFN0YXRlLmRlYWN0aXZhdGVkID0gbnVsbDtcbiAgICAgICAgICBaZXJvQ2xpcGJvYXJkLmVtaXQoe1xuICAgICAgICAgICAgdHlwZTogXCJlcnJvclwiLFxuICAgICAgICAgICAgbmFtZTogXCJzd2Ytbm90LWZvdW5kXCJcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSwgcG9sbFdhaXQpO1xuICAgIH1cbiAgfTtcbiAgLyoqXG4gKiBDcmVhdGUgdGhlIEhUTUwgYnJpZGdlIGVsZW1lbnQgdG8gZW1iZWQgdGhlIEZsYXNoIG9iamVjdCBpbnRvLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2NyZWF0ZUh0bWxCcmlkZ2UgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgY29udGFpbmVyID0gX2RvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgY29udGFpbmVyLmlkID0gX2dsb2JhbENvbmZpZy5jb250YWluZXJJZDtcbiAgICBjb250YWluZXIuY2xhc3NOYW1lID0gX2dsb2JhbENvbmZpZy5jb250YWluZXJDbGFzcztcbiAgICBjb250YWluZXIuc3R5bGUucG9zaXRpb24gPSBcImFic29sdXRlXCI7XG4gICAgY29udGFpbmVyLnN0eWxlLmxlZnQgPSBcIjBweFwiO1xuICAgIGNvbnRhaW5lci5zdHlsZS50b3AgPSBcIi05OTk5cHhcIjtcbiAgICBjb250YWluZXIuc3R5bGUud2lkdGggPSBcIjFweFwiO1xuICAgIGNvbnRhaW5lci5zdHlsZS5oZWlnaHQgPSBcIjFweFwiO1xuICAgIGNvbnRhaW5lci5zdHlsZS56SW5kZXggPSBcIlwiICsgX2dldFNhZmVaSW5kZXgoX2dsb2JhbENvbmZpZy56SW5kZXgpO1xuICAgIHJldHVybiBjb250YWluZXI7XG4gIH07XG4gIC8qKlxuICogR2V0IHRoZSBIVE1MIGVsZW1lbnQgY29udGFpbmVyIHRoYXQgd3JhcHMgdGhlIEZsYXNoIGJyaWRnZSBvYmplY3QvZWxlbWVudC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9nZXRIdG1sQnJpZGdlID0gZnVuY3Rpb24oZmxhc2hCcmlkZ2UpIHtcbiAgICB2YXIgaHRtbEJyaWRnZSA9IGZsYXNoQnJpZGdlICYmIGZsYXNoQnJpZGdlLnBhcmVudE5vZGU7XG4gICAgd2hpbGUgKGh0bWxCcmlkZ2UgJiYgaHRtbEJyaWRnZS5ub2RlTmFtZSA9PT0gXCJPQkpFQ1RcIiAmJiBodG1sQnJpZGdlLnBhcmVudE5vZGUpIHtcbiAgICAgIGh0bWxCcmlkZ2UgPSBodG1sQnJpZGdlLnBhcmVudE5vZGU7XG4gICAgfVxuICAgIHJldHVybiBodG1sQnJpZGdlIHx8IG51bGw7XG4gIH07XG4gIC8qKlxuICogQ3JlYXRlIHRoZSBTV0Ygb2JqZWN0LlxuICpcbiAqIEByZXR1cm5zIFRoZSBTV0Ygb2JqZWN0IHJlZmVyZW5jZS5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9lbWJlZFN3ZiA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBsZW4sIGZsYXNoQnJpZGdlID0gX2ZsYXNoU3RhdGUuYnJpZGdlLCBjb250YWluZXIgPSBfZ2V0SHRtbEJyaWRnZShmbGFzaEJyaWRnZSk7XG4gICAgaWYgKCFmbGFzaEJyaWRnZSkge1xuICAgICAgdmFyIGFsbG93U2NyaXB0QWNjZXNzID0gX2RldGVybWluZVNjcmlwdEFjY2Vzcyhfd2luZG93LmxvY2F0aW9uLmhvc3QsIF9nbG9iYWxDb25maWcpO1xuICAgICAgdmFyIGFsbG93TmV0d29ya2luZyA9IGFsbG93U2NyaXB0QWNjZXNzID09PSBcIm5ldmVyXCIgPyBcIm5vbmVcIiA6IFwiYWxsXCI7XG4gICAgICB2YXIgZmxhc2h2YXJzID0gX3ZhcnMoX2V4dGVuZCh7XG4gICAgICAgIGpzVmVyc2lvbjogWmVyb0NsaXBib2FyZC52ZXJzaW9uXG4gICAgICB9LCBfZ2xvYmFsQ29uZmlnKSk7XG4gICAgICB2YXIgc3dmVXJsID0gX2dsb2JhbENvbmZpZy5zd2ZQYXRoICsgX2NhY2hlQnVzdChfZ2xvYmFsQ29uZmlnLnN3ZlBhdGgsIF9nbG9iYWxDb25maWcpO1xuICAgICAgY29udGFpbmVyID0gX2NyZWF0ZUh0bWxCcmlkZ2UoKTtcbiAgICAgIHZhciBkaXZUb0JlUmVwbGFjZWQgPSBfZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChkaXZUb0JlUmVwbGFjZWQpO1xuICAgICAgX2RvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoY29udGFpbmVyKTtcbiAgICAgIHZhciB0bXBEaXYgPSBfZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgIHZhciB1c2luZ0FjdGl2ZVggPSBfZmxhc2hTdGF0ZS5wbHVnaW5UeXBlID09PSBcImFjdGl2ZXhcIjtcbiAgICAgIHRtcERpdi5pbm5lckhUTUwgPSAnPG9iamVjdCBpZD1cIicgKyBfZ2xvYmFsQ29uZmlnLnN3Zk9iamVjdElkICsgJ1wiIG5hbWU9XCInICsgX2dsb2JhbENvbmZpZy5zd2ZPYmplY3RJZCArICdcIiAnICsgJ3dpZHRoPVwiMTAwJVwiIGhlaWdodD1cIjEwMCVcIiAnICsgKHVzaW5nQWN0aXZlWCA/ICdjbGFzc2lkPVwiY2xzaWQ6ZDI3Y2RiNmUtYWU2ZC0xMWNmLTk2YjgtNDQ0NTUzNTQwMDAwXCInIDogJ3R5cGU9XCJhcHBsaWNhdGlvbi94LXNob2Nrd2F2ZS1mbGFzaFwiIGRhdGE9XCInICsgc3dmVXJsICsgJ1wiJykgKyBcIj5cIiArICh1c2luZ0FjdGl2ZVggPyAnPHBhcmFtIG5hbWU9XCJtb3ZpZVwiIHZhbHVlPVwiJyArIHN3ZlVybCArICdcIi8+JyA6IFwiXCIpICsgJzxwYXJhbSBuYW1lPVwiYWxsb3dTY3JpcHRBY2Nlc3NcIiB2YWx1ZT1cIicgKyBhbGxvd1NjcmlwdEFjY2VzcyArICdcIi8+JyArICc8cGFyYW0gbmFtZT1cImFsbG93TmV0d29ya2luZ1wiIHZhbHVlPVwiJyArIGFsbG93TmV0d29ya2luZyArICdcIi8+JyArICc8cGFyYW0gbmFtZT1cIm1lbnVcIiB2YWx1ZT1cImZhbHNlXCIvPicgKyAnPHBhcmFtIG5hbWU9XCJ3bW9kZVwiIHZhbHVlPVwidHJhbnNwYXJlbnRcIi8+JyArICc8cGFyYW0gbmFtZT1cImZsYXNodmFyc1wiIHZhbHVlPVwiJyArIGZsYXNodmFycyArICdcIi8+JyArICc8ZGl2IGlkPVwiJyArIF9nbG9iYWxDb25maWcuc3dmT2JqZWN0SWQgKyAnX2ZhbGxiYWNrQ29udGVudFwiPiZuYnNwOzwvZGl2PicgKyBcIjwvb2JqZWN0PlwiO1xuICAgICAgZmxhc2hCcmlkZ2UgPSB0bXBEaXYuZmlyc3RDaGlsZDtcbiAgICAgIHRtcERpdiA9IG51bGw7XG4gICAgICBfdW53cmFwKGZsYXNoQnJpZGdlKS5aZXJvQ2xpcGJvYXJkID0gWmVyb0NsaXBib2FyZDtcbiAgICAgIGNvbnRhaW5lci5yZXBsYWNlQ2hpbGQoZmxhc2hCcmlkZ2UsIGRpdlRvQmVSZXBsYWNlZCk7XG4gICAgICBfd2F0Y2hGb3JTd2ZGYWxsYmFja0NvbnRlbnQoKTtcbiAgICB9XG4gICAgaWYgKCFmbGFzaEJyaWRnZSkge1xuICAgICAgZmxhc2hCcmlkZ2UgPSBfZG9jdW1lbnRbX2dsb2JhbENvbmZpZy5zd2ZPYmplY3RJZF07XG4gICAgICBpZiAoZmxhc2hCcmlkZ2UgJiYgKGxlbiA9IGZsYXNoQnJpZGdlLmxlbmd0aCkpIHtcbiAgICAgICAgZmxhc2hCcmlkZ2UgPSBmbGFzaEJyaWRnZVtsZW4gLSAxXTtcbiAgICAgIH1cbiAgICAgIGlmICghZmxhc2hCcmlkZ2UgJiYgY29udGFpbmVyKSB7XG4gICAgICAgIGZsYXNoQnJpZGdlID0gY29udGFpbmVyLmZpcnN0Q2hpbGQ7XG4gICAgICB9XG4gICAgfVxuICAgIF9mbGFzaFN0YXRlLmJyaWRnZSA9IGZsYXNoQnJpZGdlIHx8IG51bGw7XG4gICAgcmV0dXJuIGZsYXNoQnJpZGdlO1xuICB9O1xuICAvKipcbiAqIERlc3Ryb3kgdGhlIFNXRiBvYmplY3QuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfdW5lbWJlZFN3ZiA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBmbGFzaEJyaWRnZSA9IF9mbGFzaFN0YXRlLmJyaWRnZTtcbiAgICBpZiAoZmxhc2hCcmlkZ2UpIHtcbiAgICAgIHZhciBodG1sQnJpZGdlID0gX2dldEh0bWxCcmlkZ2UoZmxhc2hCcmlkZ2UpO1xuICAgICAgaWYgKGh0bWxCcmlkZ2UpIHtcbiAgICAgICAgaWYgKF9mbGFzaFN0YXRlLnBsdWdpblR5cGUgPT09IFwiYWN0aXZleFwiICYmIFwicmVhZHlTdGF0ZVwiIGluIGZsYXNoQnJpZGdlKSB7XG4gICAgICAgICAgZmxhc2hCcmlkZ2Uuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgICAgICAgIChmdW5jdGlvbiByZW1vdmVTd2ZGcm9tSUUoKSB7XG4gICAgICAgICAgICBpZiAoZmxhc2hCcmlkZ2UucmVhZHlTdGF0ZSA9PT0gNCkge1xuICAgICAgICAgICAgICBmb3IgKHZhciBwcm9wIGluIGZsYXNoQnJpZGdlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBmbGFzaEJyaWRnZVtwcm9wXSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgICBmbGFzaEJyaWRnZVtwcm9wXSA9IG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGlmIChmbGFzaEJyaWRnZS5wYXJlbnROb2RlKSB7XG4gICAgICAgICAgICAgICAgZmxhc2hCcmlkZ2UucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChmbGFzaEJyaWRnZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgaWYgKGh0bWxCcmlkZ2UucGFyZW50Tm9kZSkge1xuICAgICAgICAgICAgICAgIGh0bWxCcmlkZ2UucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChodG1sQnJpZGdlKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgX3NldFRpbWVvdXQocmVtb3ZlU3dmRnJvbUlFLCAxMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSkoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAoZmxhc2hCcmlkZ2UucGFyZW50Tm9kZSkge1xuICAgICAgICAgICAgZmxhc2hCcmlkZ2UucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChmbGFzaEJyaWRnZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChodG1sQnJpZGdlLnBhcmVudE5vZGUpIHtcbiAgICAgICAgICAgIGh0bWxCcmlkZ2UucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChodG1sQnJpZGdlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIF9jbGVhclRpbWVvdXRzQW5kUG9sbGluZygpO1xuICAgICAgX2ZsYXNoU3RhdGUucmVhZHkgPSBudWxsO1xuICAgICAgX2ZsYXNoU3RhdGUuYnJpZGdlID0gbnVsbDtcbiAgICAgIF9mbGFzaFN0YXRlLmRlYWN0aXZhdGVkID0gbnVsbDtcbiAgICAgIF96Y1N3ZlZlcnNpb24gPSB1bmRlZmluZWQ7XG4gICAgfVxuICB9O1xuICAvKipcbiAqIE1hcCB0aGUgZGF0YSBmb3JtYXQgbmFtZXMgb2YgdGhlIFwiY2xpcERhdGFcIiB0byBGbGFzaC1mcmllbmRseSBuYW1lcy5cbiAqXG4gKiBAcmV0dXJucyBBIG5ldyB0cmFuc2Zvcm1lZCBvYmplY3QuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfbWFwQ2xpcERhdGFUb0ZsYXNoID0gZnVuY3Rpb24oY2xpcERhdGEpIHtcbiAgICB2YXIgbmV3Q2xpcERhdGEgPSB7fSwgZm9ybWF0TWFwID0ge307XG4gICAgaWYgKCEodHlwZW9mIGNsaXBEYXRhID09PSBcIm9iamVjdFwiICYmIGNsaXBEYXRhKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBmb3IgKHZhciBkYXRhRm9ybWF0IGluIGNsaXBEYXRhKSB7XG4gICAgICBpZiAoZGF0YUZvcm1hdCAmJiBfaGFzT3duLmNhbGwoY2xpcERhdGEsIGRhdGFGb3JtYXQpICYmIHR5cGVvZiBjbGlwRGF0YVtkYXRhRm9ybWF0XSA9PT0gXCJzdHJpbmdcIiAmJiBjbGlwRGF0YVtkYXRhRm9ybWF0XSkge1xuICAgICAgICBzd2l0Y2ggKGRhdGFGb3JtYXQudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgY2FzZSBcInRleHQvcGxhaW5cIjpcbiAgICAgICAgIGNhc2UgXCJ0ZXh0XCI6XG4gICAgICAgICBjYXNlIFwiYWlyOnRleHRcIjpcbiAgICAgICAgIGNhc2UgXCJmbGFzaDp0ZXh0XCI6XG4gICAgICAgICAgbmV3Q2xpcERhdGEudGV4dCA9IGNsaXBEYXRhW2RhdGFGb3JtYXRdO1xuICAgICAgICAgIGZvcm1hdE1hcC50ZXh0ID0gZGF0YUZvcm1hdDtcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICAgY2FzZSBcInRleHQvaHRtbFwiOlxuICAgICAgICAgY2FzZSBcImh0bWxcIjpcbiAgICAgICAgIGNhc2UgXCJhaXI6aHRtbFwiOlxuICAgICAgICAgY2FzZSBcImZsYXNoOmh0bWxcIjpcbiAgICAgICAgICBuZXdDbGlwRGF0YS5odG1sID0gY2xpcERhdGFbZGF0YUZvcm1hdF07XG4gICAgICAgICAgZm9ybWF0TWFwLmh0bWwgPSBkYXRhRm9ybWF0O1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICBjYXNlIFwiYXBwbGljYXRpb24vcnRmXCI6XG4gICAgICAgICBjYXNlIFwidGV4dC9ydGZcIjpcbiAgICAgICAgIGNhc2UgXCJydGZcIjpcbiAgICAgICAgIGNhc2UgXCJyaWNodGV4dFwiOlxuICAgICAgICAgY2FzZSBcImFpcjpydGZcIjpcbiAgICAgICAgIGNhc2UgXCJmbGFzaDpydGZcIjpcbiAgICAgICAgICBuZXdDbGlwRGF0YS5ydGYgPSBjbGlwRGF0YVtkYXRhRm9ybWF0XTtcbiAgICAgICAgICBmb3JtYXRNYXAucnRmID0gZGF0YUZvcm1hdDtcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgZGF0YTogbmV3Q2xpcERhdGEsXG4gICAgICBmb3JtYXRNYXA6IGZvcm1hdE1hcFxuICAgIH07XG4gIH07XG4gIC8qKlxuICogTWFwIHRoZSBkYXRhIGZvcm1hdCBuYW1lcyBmcm9tIEZsYXNoLWZyaWVuZGx5IG5hbWVzIGJhY2sgdG8gdGhlaXIgb3JpZ2luYWwgXCJjbGlwRGF0YVwiIG5hbWVzICh2aWEgYSBmb3JtYXQgbWFwcGluZykuXG4gKlxuICogQHJldHVybnMgQSBuZXcgdHJhbnNmb3JtZWQgb2JqZWN0LlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX21hcENsaXBSZXN1bHRzRnJvbUZsYXNoID0gZnVuY3Rpb24oY2xpcFJlc3VsdHMsIGZvcm1hdE1hcCkge1xuICAgIGlmICghKHR5cGVvZiBjbGlwUmVzdWx0cyA9PT0gXCJvYmplY3RcIiAmJiBjbGlwUmVzdWx0cyAmJiB0eXBlb2YgZm9ybWF0TWFwID09PSBcIm9iamVjdFwiICYmIGZvcm1hdE1hcCkpIHtcbiAgICAgIHJldHVybiBjbGlwUmVzdWx0cztcbiAgICB9XG4gICAgdmFyIG5ld1Jlc3VsdHMgPSB7fTtcbiAgICBmb3IgKHZhciBwcm9wIGluIGNsaXBSZXN1bHRzKSB7XG4gICAgICBpZiAoX2hhc093bi5jYWxsKGNsaXBSZXN1bHRzLCBwcm9wKSkge1xuICAgICAgICBpZiAocHJvcCA9PT0gXCJlcnJvcnNcIikge1xuICAgICAgICAgIG5ld1Jlc3VsdHNbcHJvcF0gPSBjbGlwUmVzdWx0c1twcm9wXSA/IGNsaXBSZXN1bHRzW3Byb3BdLnNsaWNlKCkgOiBbXTtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gbmV3UmVzdWx0c1twcm9wXS5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgbmV3UmVzdWx0c1twcm9wXVtpXS5mb3JtYXQgPSBmb3JtYXRNYXBbbmV3UmVzdWx0c1twcm9wXVtpXS5mb3JtYXRdO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChwcm9wICE9PSBcInN1Y2Nlc3NcIiAmJiBwcm9wICE9PSBcImRhdGFcIikge1xuICAgICAgICAgIG5ld1Jlc3VsdHNbcHJvcF0gPSBjbGlwUmVzdWx0c1twcm9wXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBuZXdSZXN1bHRzW3Byb3BdID0ge307XG4gICAgICAgICAgdmFyIHRtcEhhc2ggPSBjbGlwUmVzdWx0c1twcm9wXTtcbiAgICAgICAgICBmb3IgKHZhciBkYXRhRm9ybWF0IGluIHRtcEhhc2gpIHtcbiAgICAgICAgICAgIGlmIChkYXRhRm9ybWF0ICYmIF9oYXNPd24uY2FsbCh0bXBIYXNoLCBkYXRhRm9ybWF0KSAmJiBfaGFzT3duLmNhbGwoZm9ybWF0TWFwLCBkYXRhRm9ybWF0KSkge1xuICAgICAgICAgICAgICBuZXdSZXN1bHRzW3Byb3BdW2Zvcm1hdE1hcFtkYXRhRm9ybWF0XV0gPSB0bXBIYXNoW2RhdGFGb3JtYXRdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbmV3UmVzdWx0cztcbiAgfTtcbiAgLyoqXG4gKiBXaWxsIGxvb2sgYXQgYSBwYXRoLCBhbmQgd2lsbCBjcmVhdGUgYSBcIj9ub0NhY2hlPXt0aW1lfVwiIG9yIFwiJm5vQ2FjaGU9e3RpbWV9XCJcbiAqIHF1ZXJ5IHBhcmFtIHN0cmluZyB0byByZXR1cm4uIERvZXMgTk9UIGFwcGVuZCB0aGF0IHN0cmluZyB0byB0aGUgb3JpZ2luYWwgcGF0aC5cbiAqIFRoaXMgaXMgdXNlZnVsIGJlY2F1c2UgRXh0ZXJuYWxJbnRlcmZhY2Ugb2Z0ZW4gYnJlYWtzIHdoZW4gYSBGbGFzaCBTV0YgaXMgY2FjaGVkLlxuICpcbiAqIEByZXR1cm5zIFRoZSBgbm9DYWNoZWAgcXVlcnkgcGFyYW0gd2l0aCBuZWNlc3NhcnkgXCI/XCIvXCImXCIgcHJlZml4LlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2NhY2hlQnVzdCA9IGZ1bmN0aW9uKHBhdGgsIG9wdGlvbnMpIHtcbiAgICB2YXIgY2FjaGVCdXN0ID0gb3B0aW9ucyA9PSBudWxsIHx8IG9wdGlvbnMgJiYgb3B0aW9ucy5jYWNoZUJ1c3QgPT09IHRydWU7XG4gICAgaWYgKGNhY2hlQnVzdCkge1xuICAgICAgcmV0dXJuIChwYXRoLmluZGV4T2YoXCI/XCIpID09PSAtMSA/IFwiP1wiIDogXCImXCIpICsgXCJub0NhY2hlPVwiICsgX25vdygpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gXCJcIjtcbiAgICB9XG4gIH07XG4gIC8qKlxuICogQ3JlYXRlcyBhIHF1ZXJ5IHN0cmluZyBmb3IgdGhlIEZsYXNoVmFycyBwYXJhbS5cbiAqIERvZXMgTk9UIGluY2x1ZGUgdGhlIGNhY2hlLWJ1c3RpbmcgcXVlcnkgcGFyYW0uXG4gKlxuICogQHJldHVybnMgRmxhc2hWYXJzIHF1ZXJ5IHN0cmluZ1xuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX3ZhcnMgPSBmdW5jdGlvbihvcHRpb25zKSB7XG4gICAgdmFyIGksIGxlbiwgZG9tYWluLCBkb21haW5zLCBzdHIgPSBcIlwiLCB0cnVzdGVkT3JpZ2luc0V4cGFuZGVkID0gW107XG4gICAgaWYgKG9wdGlvbnMudHJ1c3RlZERvbWFpbnMpIHtcbiAgICAgIGlmICh0eXBlb2Ygb3B0aW9ucy50cnVzdGVkRG9tYWlucyA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICBkb21haW5zID0gWyBvcHRpb25zLnRydXN0ZWREb21haW5zIF07XG4gICAgICB9IGVsc2UgaWYgKHR5cGVvZiBvcHRpb25zLnRydXN0ZWREb21haW5zID09PSBcIm9iamVjdFwiICYmIFwibGVuZ3RoXCIgaW4gb3B0aW9ucy50cnVzdGVkRG9tYWlucykge1xuICAgICAgICBkb21haW5zID0gb3B0aW9ucy50cnVzdGVkRG9tYWlucztcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGRvbWFpbnMgJiYgZG9tYWlucy5sZW5ndGgpIHtcbiAgICAgIGZvciAoaSA9IDAsIGxlbiA9IGRvbWFpbnMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgaWYgKF9oYXNPd24uY2FsbChkb21haW5zLCBpKSAmJiBkb21haW5zW2ldICYmIHR5cGVvZiBkb21haW5zW2ldID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgZG9tYWluID0gX2V4dHJhY3REb21haW4oZG9tYWluc1tpXSk7XG4gICAgICAgICAgaWYgKCFkb21haW4pIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoZG9tYWluID09PSBcIipcIikge1xuICAgICAgICAgICAgdHJ1c3RlZE9yaWdpbnNFeHBhbmRlZC5sZW5ndGggPSAwO1xuICAgICAgICAgICAgdHJ1c3RlZE9yaWdpbnNFeHBhbmRlZC5wdXNoKGRvbWFpbik7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgdHJ1c3RlZE9yaWdpbnNFeHBhbmRlZC5wdXNoLmFwcGx5KHRydXN0ZWRPcmlnaW5zRXhwYW5kZWQsIFsgZG9tYWluLCBcIi8vXCIgKyBkb21haW4sIF93aW5kb3cubG9jYXRpb24ucHJvdG9jb2wgKyBcIi8vXCIgKyBkb21haW4gXSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKHRydXN0ZWRPcmlnaW5zRXhwYW5kZWQubGVuZ3RoKSB7XG4gICAgICBzdHIgKz0gXCJ0cnVzdGVkT3JpZ2lucz1cIiArIF9lbmNvZGVVUklDb21wb25lbnQodHJ1c3RlZE9yaWdpbnNFeHBhbmRlZC5qb2luKFwiLFwiKSk7XG4gICAgfVxuICAgIGlmIChvcHRpb25zLmZvcmNlRW5oYW5jZWRDbGlwYm9hcmQgPT09IHRydWUpIHtcbiAgICAgIHN0ciArPSAoc3RyID8gXCImXCIgOiBcIlwiKSArIFwiZm9yY2VFbmhhbmNlZENsaXBib2FyZD10cnVlXCI7XG4gICAgfVxuICAgIGlmICh0eXBlb2Ygb3B0aW9ucy5zd2ZPYmplY3RJZCA9PT0gXCJzdHJpbmdcIiAmJiBvcHRpb25zLnN3Zk9iamVjdElkKSB7XG4gICAgICBzdHIgKz0gKHN0ciA/IFwiJlwiIDogXCJcIikgKyBcInN3Zk9iamVjdElkPVwiICsgX2VuY29kZVVSSUNvbXBvbmVudChvcHRpb25zLnN3Zk9iamVjdElkKTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBvcHRpb25zLmpzVmVyc2lvbiA9PT0gXCJzdHJpbmdcIiAmJiBvcHRpb25zLmpzVmVyc2lvbikge1xuICAgICAgc3RyICs9IChzdHIgPyBcIiZcIiA6IFwiXCIpICsgXCJqc1ZlcnNpb249XCIgKyBfZW5jb2RlVVJJQ29tcG9uZW50KG9wdGlvbnMuanNWZXJzaW9uKTtcbiAgICB9XG4gICAgcmV0dXJuIHN0cjtcbiAgfTtcbiAgLyoqXG4gKiBFeHRyYWN0IHRoZSBkb21haW4gKGUuZy4gXCJnaXRodWIuY29tXCIpIGZyb20gYW4gb3JpZ2luIChlLmcuIFwiaHR0cHM6Ly9naXRodWIuY29tXCIpIG9yXG4gKiBVUkwgKGUuZy4gXCJodHRwczovL2dpdGh1Yi5jb20vemVyb2NsaXBib2FyZC96ZXJvY2xpcGJvYXJkL1wiKS5cbiAqXG4gKiBAcmV0dXJucyB0aGUgZG9tYWluXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZXh0cmFjdERvbWFpbiA9IGZ1bmN0aW9uKG9yaWdpbk9yVXJsKSB7XG4gICAgaWYgKG9yaWdpbk9yVXJsID09IG51bGwgfHwgb3JpZ2luT3JVcmwgPT09IFwiXCIpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBvcmlnaW5PclVybCA9IG9yaWdpbk9yVXJsLnJlcGxhY2UoL15cXHMrfFxccyskL2csIFwiXCIpO1xuICAgIGlmIChvcmlnaW5PclVybCA9PT0gXCJcIikge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciBwcm90b2NvbEluZGV4ID0gb3JpZ2luT3JVcmwuaW5kZXhPZihcIi8vXCIpO1xuICAgIG9yaWdpbk9yVXJsID0gcHJvdG9jb2xJbmRleCA9PT0gLTEgPyBvcmlnaW5PclVybCA6IG9yaWdpbk9yVXJsLnNsaWNlKHByb3RvY29sSW5kZXggKyAyKTtcbiAgICB2YXIgcGF0aEluZGV4ID0gb3JpZ2luT3JVcmwuaW5kZXhPZihcIi9cIik7XG4gICAgb3JpZ2luT3JVcmwgPSBwYXRoSW5kZXggPT09IC0xID8gb3JpZ2luT3JVcmwgOiBwcm90b2NvbEluZGV4ID09PSAtMSB8fCBwYXRoSW5kZXggPT09IDAgPyBudWxsIDogb3JpZ2luT3JVcmwuc2xpY2UoMCwgcGF0aEluZGV4KTtcbiAgICBpZiAob3JpZ2luT3JVcmwgJiYgb3JpZ2luT3JVcmwuc2xpY2UoLTQpLnRvTG93ZXJDYXNlKCkgPT09IFwiLnN3ZlwiKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgcmV0dXJuIG9yaWdpbk9yVXJsIHx8IG51bGw7XG4gIH07XG4gIC8qKlxuICogU2V0IGBhbGxvd1NjcmlwdEFjY2Vzc2AgYmFzZWQgb24gYHRydXN0ZWREb21haW5zYCBhbmQgYHdpbmRvdy5sb2NhdGlvbi5ob3N0YCB2cy4gYHN3ZlBhdGhgLlxuICpcbiAqIEByZXR1cm5zIFRoZSBhcHByb3ByaWF0ZSBzY3JpcHQgYWNjZXNzIGxldmVsLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2RldGVybWluZVNjcmlwdEFjY2VzcyA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBfZXh0cmFjdEFsbERvbWFpbnMgPSBmdW5jdGlvbihvcmlnaW5zKSB7XG4gICAgICB2YXIgaSwgbGVuLCB0bXAsIHJlc3VsdHNBcnJheSA9IFtdO1xuICAgICAgaWYgKHR5cGVvZiBvcmlnaW5zID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIG9yaWdpbnMgPSBbIG9yaWdpbnMgXTtcbiAgICAgIH1cbiAgICAgIGlmICghKHR5cGVvZiBvcmlnaW5zID09PSBcIm9iamVjdFwiICYmIG9yaWdpbnMgJiYgdHlwZW9mIG9yaWdpbnMubGVuZ3RoID09PSBcIm51bWJlclwiKSkge1xuICAgICAgICByZXR1cm4gcmVzdWx0c0FycmF5O1xuICAgICAgfVxuICAgICAgZm9yIChpID0gMCwgbGVuID0gb3JpZ2lucy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBpZiAoX2hhc093bi5jYWxsKG9yaWdpbnMsIGkpICYmICh0bXAgPSBfZXh0cmFjdERvbWFpbihvcmlnaW5zW2ldKSkpIHtcbiAgICAgICAgICBpZiAodG1wID09PSBcIipcIikge1xuICAgICAgICAgICAgcmVzdWx0c0FycmF5Lmxlbmd0aCA9IDA7XG4gICAgICAgICAgICByZXN1bHRzQXJyYXkucHVzaChcIipcIik7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHJlc3VsdHNBcnJheS5pbmRleE9mKHRtcCkgPT09IC0xKSB7XG4gICAgICAgICAgICByZXN1bHRzQXJyYXkucHVzaCh0bXApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3VsdHNBcnJheTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbihjdXJyZW50RG9tYWluLCBjb25maWdPcHRpb25zKSB7XG4gICAgICB2YXIgc3dmRG9tYWluID0gX2V4dHJhY3REb21haW4oY29uZmlnT3B0aW9ucy5zd2ZQYXRoKTtcbiAgICAgIGlmIChzd2ZEb21haW4gPT09IG51bGwpIHtcbiAgICAgICAgc3dmRG9tYWluID0gY3VycmVudERvbWFpbjtcbiAgICAgIH1cbiAgICAgIHZhciB0cnVzdGVkRG9tYWlucyA9IF9leHRyYWN0QWxsRG9tYWlucyhjb25maWdPcHRpb25zLnRydXN0ZWREb21haW5zKTtcbiAgICAgIHZhciBsZW4gPSB0cnVzdGVkRG9tYWlucy5sZW5ndGg7XG4gICAgICBpZiAobGVuID4gMCkge1xuICAgICAgICBpZiAobGVuID09PSAxICYmIHRydXN0ZWREb21haW5zWzBdID09PSBcIipcIikge1xuICAgICAgICAgIHJldHVybiBcImFsd2F5c1wiO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0cnVzdGVkRG9tYWlucy5pbmRleE9mKGN1cnJlbnREb21haW4pICE9PSAtMSkge1xuICAgICAgICAgIGlmIChsZW4gPT09IDEgJiYgY3VycmVudERvbWFpbiA9PT0gc3dmRG9tYWluKSB7XG4gICAgICAgICAgICByZXR1cm4gXCJzYW1lRG9tYWluXCI7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBcImFsd2F5c1wiO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gXCJuZXZlclwiO1xuICAgIH07XG4gIH0oKTtcbiAgLyoqXG4gKiBHZXQgdGhlIGN1cnJlbnRseSBhY3RpdmUvZm9jdXNlZCBET00gZWxlbWVudC5cbiAqXG4gKiBAcmV0dXJucyB0aGUgY3VycmVudGx5IGFjdGl2ZS9mb2N1c2VkIGVsZW1lbnQsIG9yIGBudWxsYFxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX3NhZmVBY3RpdmVFbGVtZW50ID0gZnVuY3Rpb24oKSB7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBfZG9jdW1lbnQuYWN0aXZlRWxlbWVudDtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfTtcbiAgLyoqXG4gKiBBZGQgYSBjbGFzcyB0byBhbiBlbGVtZW50LCBpZiBpdCBkb2Vzbid0IGFscmVhZHkgaGF2ZSBpdC5cbiAqXG4gKiBAcmV0dXJucyBUaGUgZWxlbWVudCwgd2l0aCBpdHMgbmV3IGNsYXNzIGFkZGVkLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2FkZENsYXNzID0gZnVuY3Rpb24oZWxlbWVudCwgdmFsdWUpIHtcbiAgICB2YXIgYywgY2wsIGNsYXNzTmFtZSwgY2xhc3NOYW1lcyA9IFtdO1xuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIgJiYgdmFsdWUpIHtcbiAgICAgIGNsYXNzTmFtZXMgPSB2YWx1ZS5zcGxpdCgvXFxzKy8pO1xuICAgIH1cbiAgICBpZiAoZWxlbWVudCAmJiBlbGVtZW50Lm5vZGVUeXBlID09PSAxICYmIGNsYXNzTmFtZXMubGVuZ3RoID4gMCkge1xuICAgICAgaWYgKGVsZW1lbnQuY2xhc3NMaXN0KSB7XG4gICAgICAgIGZvciAoYyA9IDAsIGNsID0gY2xhc3NOYW1lcy5sZW5ndGg7IGMgPCBjbDsgYysrKSB7XG4gICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKGNsYXNzTmFtZXNbY10pO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGVsZW1lbnQuaGFzT3duUHJvcGVydHkoXCJjbGFzc05hbWVcIikpIHtcbiAgICAgICAgY2xhc3NOYW1lID0gXCIgXCIgKyBlbGVtZW50LmNsYXNzTmFtZSArIFwiIFwiO1xuICAgICAgICBmb3IgKGMgPSAwLCBjbCA9IGNsYXNzTmFtZXMubGVuZ3RoOyBjIDwgY2w7IGMrKykge1xuICAgICAgICAgIGlmIChjbGFzc05hbWUuaW5kZXhPZihcIiBcIiArIGNsYXNzTmFtZXNbY10gKyBcIiBcIikgPT09IC0xKSB7XG4gICAgICAgICAgICBjbGFzc05hbWUgKz0gY2xhc3NOYW1lc1tjXSArIFwiIFwiO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbGVtZW50LmNsYXNzTmFtZSA9IGNsYXNzTmFtZS5yZXBsYWNlKC9eXFxzK3xcXHMrJC9nLCBcIlwiKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGVsZW1lbnQ7XG4gIH07XG4gIC8qKlxuICogUmVtb3ZlIGEgY2xhc3MgZnJvbSBhbiBlbGVtZW50LCBpZiBpdCBoYXMgaXQuXG4gKlxuICogQHJldHVybnMgVGhlIGVsZW1lbnQsIHdpdGggaXRzIGNsYXNzIHJlbW92ZWQuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfcmVtb3ZlQ2xhc3MgPSBmdW5jdGlvbihlbGVtZW50LCB2YWx1ZSkge1xuICAgIHZhciBjLCBjbCwgY2xhc3NOYW1lLCBjbGFzc05hbWVzID0gW107XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIiAmJiB2YWx1ZSkge1xuICAgICAgY2xhc3NOYW1lcyA9IHZhbHVlLnNwbGl0KC9cXHMrLyk7XG4gICAgfVxuICAgIGlmIChlbGVtZW50ICYmIGVsZW1lbnQubm9kZVR5cGUgPT09IDEgJiYgY2xhc3NOYW1lcy5sZW5ndGggPiAwKSB7XG4gICAgICBpZiAoZWxlbWVudC5jbGFzc0xpc3QgJiYgZWxlbWVudC5jbGFzc0xpc3QubGVuZ3RoID4gMCkge1xuICAgICAgICBmb3IgKGMgPSAwLCBjbCA9IGNsYXNzTmFtZXMubGVuZ3RoOyBjIDwgY2w7IGMrKykge1xuICAgICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjbGFzc05hbWVzW2NdKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChlbGVtZW50LmNsYXNzTmFtZSkge1xuICAgICAgICBjbGFzc05hbWUgPSAoXCIgXCIgKyBlbGVtZW50LmNsYXNzTmFtZSArIFwiIFwiKS5yZXBsYWNlKC9bXFxyXFxuXFx0XS9nLCBcIiBcIik7XG4gICAgICAgIGZvciAoYyA9IDAsIGNsID0gY2xhc3NOYW1lcy5sZW5ndGg7IGMgPCBjbDsgYysrKSB7XG4gICAgICAgICAgY2xhc3NOYW1lID0gY2xhc3NOYW1lLnJlcGxhY2UoXCIgXCIgKyBjbGFzc05hbWVzW2NdICsgXCIgXCIsIFwiIFwiKTtcbiAgICAgICAgfVxuICAgICAgICBlbGVtZW50LmNsYXNzTmFtZSA9IGNsYXNzTmFtZS5yZXBsYWNlKC9eXFxzK3xcXHMrJC9nLCBcIlwiKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGVsZW1lbnQ7XG4gIH07XG4gIC8qKlxuICogQXR0ZW1wdCB0byBpbnRlcnByZXQgdGhlIGVsZW1lbnQncyBDU1Mgc3R5bGluZy4gSWYgYHByb3BgIGlzIGBcImN1cnNvclwiYCxcbiAqIHRoZW4gd2UgYXNzdW1lIHRoYXQgaXQgc2hvdWxkIGJlIGEgaGFuZCAoXCJwb2ludGVyXCIpIGN1cnNvciBpZiB0aGUgZWxlbWVudFxuICogaXMgYW4gYW5jaG9yIGVsZW1lbnQgKFwiYVwiIHRhZykuXG4gKlxuICogQHJldHVybnMgVGhlIGNvbXB1dGVkIHN0eWxlIHByb3BlcnR5LlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2dldFN0eWxlID0gZnVuY3Rpb24oZWwsIHByb3ApIHtcbiAgICB2YXIgdmFsdWUgPSBfZ2V0Q29tcHV0ZWRTdHlsZShlbCwgbnVsbCkuZ2V0UHJvcGVydHlWYWx1ZShwcm9wKTtcbiAgICBpZiAocHJvcCA9PT0gXCJjdXJzb3JcIikge1xuICAgICAgaWYgKCF2YWx1ZSB8fCB2YWx1ZSA9PT0gXCJhdXRvXCIpIHtcbiAgICAgICAgaWYgKGVsLm5vZGVOYW1lID09PSBcIkFcIikge1xuICAgICAgICAgIHJldHVybiBcInBvaW50ZXJcIjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdmFsdWU7XG4gIH07XG4gIC8qKlxuICogR2V0IHRoZSBhYnNvbHV0ZWx5IHBvc2l0aW9uZWQgY29vcmRpbmF0ZXMgb2YgYSBET00gZWxlbWVudC5cbiAqXG4gKiBAcmV0dXJucyBPYmplY3QgY29udGFpbmluZyB0aGUgZWxlbWVudCdzIHBvc2l0aW9uLCB3aWR0aCwgYW5kIGhlaWdodC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9nZXRFbGVtZW50UG9zaXRpb24gPSBmdW5jdGlvbihlbCkge1xuICAgIHZhciBwb3MgPSB7XG4gICAgICBsZWZ0OiAwLFxuICAgICAgdG9wOiAwLFxuICAgICAgd2lkdGg6IDAsXG4gICAgICBoZWlnaHQ6IDBcbiAgICB9O1xuICAgIGlmIChlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QpIHtcbiAgICAgIHZhciBlbFJlY3QgPSBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgIHZhciBwYWdlWE9mZnNldCA9IF93aW5kb3cucGFnZVhPZmZzZXQ7XG4gICAgICB2YXIgcGFnZVlPZmZzZXQgPSBfd2luZG93LnBhZ2VZT2Zmc2V0O1xuICAgICAgdmFyIGxlZnRCb3JkZXJXaWR0aCA9IF9kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50TGVmdCB8fCAwO1xuICAgICAgdmFyIHRvcEJvcmRlcldpZHRoID0gX2RvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRUb3AgfHwgMDtcbiAgICAgIHZhciBsZWZ0Qm9keU9mZnNldCA9IDA7XG4gICAgICB2YXIgdG9wQm9keU9mZnNldCA9IDA7XG4gICAgICBpZiAoX2dldFN0eWxlKF9kb2N1bWVudC5ib2R5LCBcInBvc2l0aW9uXCIpID09PSBcInJlbGF0aXZlXCIpIHtcbiAgICAgICAgdmFyIGJvZHlSZWN0ID0gX2RvY3VtZW50LmJvZHkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgIHZhciBodG1sUmVjdCA9IF9kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgIGxlZnRCb2R5T2Zmc2V0ID0gYm9keVJlY3QubGVmdCAtIGh0bWxSZWN0LmxlZnQgfHwgMDtcbiAgICAgICAgdG9wQm9keU9mZnNldCA9IGJvZHlSZWN0LnRvcCAtIGh0bWxSZWN0LnRvcCB8fCAwO1xuICAgICAgfVxuICAgICAgcG9zLmxlZnQgPSBlbFJlY3QubGVmdCArIHBhZ2VYT2Zmc2V0IC0gbGVmdEJvcmRlcldpZHRoIC0gbGVmdEJvZHlPZmZzZXQ7XG4gICAgICBwb3MudG9wID0gZWxSZWN0LnRvcCArIHBhZ2VZT2Zmc2V0IC0gdG9wQm9yZGVyV2lkdGggLSB0b3BCb2R5T2Zmc2V0O1xuICAgICAgcG9zLndpZHRoID0gXCJ3aWR0aFwiIGluIGVsUmVjdCA/IGVsUmVjdC53aWR0aCA6IGVsUmVjdC5yaWdodCAtIGVsUmVjdC5sZWZ0O1xuICAgICAgcG9zLmhlaWdodCA9IFwiaGVpZ2h0XCIgaW4gZWxSZWN0ID8gZWxSZWN0LmhlaWdodCA6IGVsUmVjdC5ib3R0b20gLSBlbFJlY3QudG9wO1xuICAgIH1cbiAgICByZXR1cm4gcG9zO1xuICB9O1xuICAvKipcbiAqIERldGVybWluZSBpcyBhbiBlbGVtZW50IGlzIHZpc2libGUgc29tZXdoZXJlIHdpdGhpbiB0aGUgZG9jdW1lbnQgKHBhZ2UpLlxuICpcbiAqIEByZXR1cm5zIEJvb2xlYW5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9pc0VsZW1lbnRWaXNpYmxlID0gZnVuY3Rpb24oZWwpIHtcbiAgICBpZiAoIWVsKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBzdHlsZXMgPSBfZ2V0Q29tcHV0ZWRTdHlsZShlbCwgbnVsbCk7XG4gICAgdmFyIGhhc0Nzc0hlaWdodCA9IF9wYXJzZUZsb2F0KHN0eWxlcy5oZWlnaHQpID4gMDtcbiAgICB2YXIgaGFzQ3NzV2lkdGggPSBfcGFyc2VGbG9hdChzdHlsZXMud2lkdGgpID4gMDtcbiAgICB2YXIgaGFzQ3NzVG9wID0gX3BhcnNlRmxvYXQoc3R5bGVzLnRvcCkgPj0gMDtcbiAgICB2YXIgaGFzQ3NzTGVmdCA9IF9wYXJzZUZsb2F0KHN0eWxlcy5sZWZ0KSA+PSAwO1xuICAgIHZhciBjc3NLbm93cyA9IGhhc0Nzc0hlaWdodCAmJiBoYXNDc3NXaWR0aCAmJiBoYXNDc3NUb3AgJiYgaGFzQ3NzTGVmdDtcbiAgICB2YXIgcmVjdCA9IGNzc0tub3dzID8gbnVsbCA6IF9nZXRFbGVtZW50UG9zaXRpb24oZWwpO1xuICAgIHZhciBpc1Zpc2libGUgPSBzdHlsZXMuZGlzcGxheSAhPT0gXCJub25lXCIgJiYgc3R5bGVzLnZpc2liaWxpdHkgIT09IFwiY29sbGFwc2VcIiAmJiAoY3NzS25vd3MgfHwgISFyZWN0ICYmIChoYXNDc3NIZWlnaHQgfHwgcmVjdC5oZWlnaHQgPiAwKSAmJiAoaGFzQ3NzV2lkdGggfHwgcmVjdC53aWR0aCA+IDApICYmIChoYXNDc3NUb3AgfHwgcmVjdC50b3AgPj0gMCkgJiYgKGhhc0Nzc0xlZnQgfHwgcmVjdC5sZWZ0ID49IDApKTtcbiAgICByZXR1cm4gaXNWaXNpYmxlO1xuICB9O1xuICAvKipcbiAqIENsZWFyIGFsbCBleGlzdGluZyB0aW1lb3V0cyBhbmQgaW50ZXJ2YWwgcG9sbGluZyBkZWxlZ2F0ZXMuXG4gKlxuICogQHJldHVybnMgYHVuZGVmaW5lZGBcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9jbGVhclRpbWVvdXRzQW5kUG9sbGluZyA9IGZ1bmN0aW9uKCkge1xuICAgIF9jbGVhclRpbWVvdXQoX2ZsYXNoQ2hlY2tUaW1lb3V0KTtcbiAgICBfZmxhc2hDaGVja1RpbWVvdXQgPSAwO1xuICAgIF9jbGVhckludGVydmFsKF9zd2ZGYWxsYmFja0NoZWNrSW50ZXJ2YWwpO1xuICAgIF9zd2ZGYWxsYmFja0NoZWNrSW50ZXJ2YWwgPSAwO1xuICB9O1xuICAvKipcbiAqIFJlcG9zaXRpb24gdGhlIEZsYXNoIG9iamVjdCB0byBjb3ZlciB0aGUgY3VycmVudGx5IGFjdGl2YXRlZCBlbGVtZW50LlxuICpcbiAqIEByZXR1cm5zIGB1bmRlZmluZWRgXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfcmVwb3NpdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBodG1sQnJpZGdlO1xuICAgIGlmIChfY3VycmVudEVsZW1lbnQgJiYgKGh0bWxCcmlkZ2UgPSBfZ2V0SHRtbEJyaWRnZShfZmxhc2hTdGF0ZS5icmlkZ2UpKSkge1xuICAgICAgdmFyIHBvcyA9IF9nZXRFbGVtZW50UG9zaXRpb24oX2N1cnJlbnRFbGVtZW50KTtcbiAgICAgIF9leHRlbmQoaHRtbEJyaWRnZS5zdHlsZSwge1xuICAgICAgICB3aWR0aDogcG9zLndpZHRoICsgXCJweFwiLFxuICAgICAgICBoZWlnaHQ6IHBvcy5oZWlnaHQgKyBcInB4XCIsXG4gICAgICAgIHRvcDogcG9zLnRvcCArIFwicHhcIixcbiAgICAgICAgbGVmdDogcG9zLmxlZnQgKyBcInB4XCIsXG4gICAgICAgIHpJbmRleDogXCJcIiArIF9nZXRTYWZlWkluZGV4KF9nbG9iYWxDb25maWcuekluZGV4KVxuICAgICAgfSk7XG4gICAgfVxuICB9O1xuICAvKipcbiAqIFNlbmRzIGEgc2lnbmFsIHRvIHRoZSBGbGFzaCBvYmplY3QgdG8gZGlzcGxheSB0aGUgaGFuZCBjdXJzb3IgaWYgYHRydWVgLlxuICpcbiAqIEByZXR1cm5zIGB1bmRlZmluZWRgXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfc2V0SGFuZEN1cnNvciA9IGZ1bmN0aW9uKGVuYWJsZWQpIHtcbiAgICBpZiAoX2ZsYXNoU3RhdGUucmVhZHkgPT09IHRydWUpIHtcbiAgICAgIGlmIChfZmxhc2hTdGF0ZS5icmlkZ2UgJiYgdHlwZW9mIF9mbGFzaFN0YXRlLmJyaWRnZS5zZXRIYW5kQ3Vyc29yID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgX2ZsYXNoU3RhdGUuYnJpZGdlLnNldEhhbmRDdXJzb3IoZW5hYmxlZCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBfZmxhc2hTdGF0ZS5yZWFkeSA9IGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbiAgLyoqXG4gKiBHZXQgYSBzYWZlIHZhbHVlIGZvciBgekluZGV4YFxuICpcbiAqIEByZXR1cm5zIGFuIGludGVnZXIsIG9yIFwiYXV0b1wiXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZ2V0U2FmZVpJbmRleCA9IGZ1bmN0aW9uKHZhbCkge1xuICAgIGlmICgvXig/OmF1dG98aW5oZXJpdCkkLy50ZXN0KHZhbCkpIHtcbiAgICAgIHJldHVybiB2YWw7XG4gICAgfVxuICAgIHZhciB6SW5kZXg7XG4gICAgaWYgKHR5cGVvZiB2YWwgPT09IFwibnVtYmVyXCIgJiYgIV9pc05hTih2YWwpKSB7XG4gICAgICB6SW5kZXggPSB2YWw7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsID09PSBcInN0cmluZ1wiKSB7XG4gICAgICB6SW5kZXggPSBfZ2V0U2FmZVpJbmRleChfcGFyc2VJbnQodmFsLCAxMCkpO1xuICAgIH1cbiAgICByZXR1cm4gdHlwZW9mIHpJbmRleCA9PT0gXCJudW1iZXJcIiA/IHpJbmRleCA6IFwiYXV0b1wiO1xuICB9O1xuICAvKipcbiAqIEF0dGVtcHQgdG8gZGV0ZWN0IGlmIFplcm9DbGlwYm9hcmQgaXMgZXhlY3V0aW5nIGluc2lkZSBvZiBhIHNhbmRib3hlZCBpZnJhbWUuXG4gKiBJZiBpdCBpcywgRmxhc2ggUGxheWVyIGNhbm5vdCBiZSB1c2VkLCBzbyBaZXJvQ2xpcGJvYXJkIGlzIGRlYWQgaW4gdGhlIHdhdGVyLlxuICpcbiAqIEBzZWUge0BsaW5rIGh0dHA6Ly9saXN0cy53My5vcmcvQXJjaGl2ZXMvUHVibGljL3B1YmxpYy13aGF0d2ctYXJjaGl2ZS8yMDE0RGVjLzAwMDIuaHRtbH1cbiAqIEBzZWUge0BsaW5rIGh0dHBzOi8vZ2l0aHViLmNvbS96ZXJvY2xpcGJvYXJkL3plcm9jbGlwYm9hcmQvaXNzdWVzLzUxMX1cbiAqIEBzZWUge0BsaW5rIGh0dHA6Ly96ZXJvY2xpcGJvYXJkLm9yZy90ZXN0LWlmcmFtZXMuaHRtbH1cbiAqXG4gKiBAcmV0dXJucyBgdHJ1ZWAgKGlzIHNhbmRib3hlZCksIGBmYWxzZWAgKGlzIG5vdCBzYW5kYm94ZWQpLCBvciBgbnVsbGAgKHVuY2VydGFpbikgXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZGV0ZWN0U2FuZGJveCA9IGZ1bmN0aW9uKGRvTm90UmVhc3Nlc3NGbGFzaFN1cHBvcnQpIHtcbiAgICB2YXIgZWZmZWN0aXZlU2NyaXB0T3JpZ2luLCBmcmFtZSwgZnJhbWVFcnJvciwgcHJldmlvdXNTdGF0ZSA9IF9mbGFzaFN0YXRlLnNhbmRib3hlZCwgaXNTYW5kYm94ZWQgPSBudWxsO1xuICAgIGRvTm90UmVhc3Nlc3NGbGFzaFN1cHBvcnQgPSBkb05vdFJlYXNzZXNzRmxhc2hTdXBwb3J0ID09PSB0cnVlO1xuICAgIGlmIChfcGFnZUlzRnJhbWVkID09PSBmYWxzZSkge1xuICAgICAgaXNTYW5kYm94ZWQgPSBmYWxzZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdHJ5IHtcbiAgICAgICAgZnJhbWUgPSB3aW5kb3cuZnJhbWVFbGVtZW50IHx8IG51bGw7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGZyYW1lRXJyb3IgPSB7XG4gICAgICAgICAgbmFtZTogZS5uYW1lLFxuICAgICAgICAgIG1lc3NhZ2U6IGUubWVzc2FnZVxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgaWYgKGZyYW1lICYmIGZyYW1lLm5vZGVUeXBlID09PSAxICYmIGZyYW1lLm5vZGVOYW1lID09PSBcIklGUkFNRVwiKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgaXNTYW5kYm94ZWQgPSBmcmFtZS5oYXNBdHRyaWJ1dGUoXCJzYW5kYm94XCIpO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgaXNTYW5kYm94ZWQgPSBudWxsO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGVmZmVjdGl2ZVNjcmlwdE9yaWdpbiA9IGRvY3VtZW50LmRvbWFpbiB8fCBudWxsO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgZWZmZWN0aXZlU2NyaXB0T3JpZ2luID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZWZmZWN0aXZlU2NyaXB0T3JpZ2luID09PSBudWxsIHx8IGZyYW1lRXJyb3IgJiYgZnJhbWVFcnJvci5uYW1lID09PSBcIlNlY3VyaXR5RXJyb3JcIiAmJiAvKF58W1xcc1xcKFxcW0BdKXNhbmRib3goZXN8ZWR8aW5nfFtcXHNcXC4sIVxcKVxcXUBdfCQpLy50ZXN0KGZyYW1lRXJyb3IubWVzc2FnZS50b0xvd2VyQ2FzZSgpKSkge1xuICAgICAgICAgIGlzU2FuZGJveGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBfZmxhc2hTdGF0ZS5zYW5kYm94ZWQgPSBpc1NhbmRib3hlZDtcbiAgICBpZiAocHJldmlvdXNTdGF0ZSAhPT0gaXNTYW5kYm94ZWQgJiYgIWRvTm90UmVhc3Nlc3NGbGFzaFN1cHBvcnQpIHtcbiAgICAgIF9kZXRlY3RGbGFzaFN1cHBvcnQoX0FjdGl2ZVhPYmplY3QpO1xuICAgIH1cbiAgICByZXR1cm4gaXNTYW5kYm94ZWQ7XG4gIH07XG4gIC8qKlxuICogRGV0ZWN0IHRoZSBGbGFzaCBQbGF5ZXIgc3RhdHVzLCB2ZXJzaW9uLCBhbmQgcGx1Z2luIHR5cGUuXG4gKlxuICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC9kb2N0eXBlLW1pcnJvci93aWtpL0FydGljbGVEZXRlY3RGbGFzaCNUaGVfY29kZX1cbiAqIEBzZWUge0BsaW5rIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTI4NjYwNjAvZGV0ZWN0aW5nLXBlcHBlci1wcGFwaS1mbGFzaC13aXRoLWphdmFzY3JpcHR9XG4gKlxuICogQHJldHVybnMgYHVuZGVmaW5lZGBcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9kZXRlY3RGbGFzaFN1cHBvcnQgPSBmdW5jdGlvbihBY3RpdmVYT2JqZWN0KSB7XG4gICAgdmFyIHBsdWdpbiwgYXgsIG1pbWVUeXBlLCBoYXNGbGFzaCA9IGZhbHNlLCBpc0FjdGl2ZVggPSBmYWxzZSwgaXNQUEFQSSA9IGZhbHNlLCBmbGFzaFZlcnNpb24gPSBcIlwiO1xuICAgIC8qKlxuICAgKiBEZXJpdmVkIGZyb20gQXBwbGUncyBzdWdnZXN0ZWQgc25pZmZlci5cbiAgICogQHBhcmFtIHtTdHJpbmd9IGRlc2MgZS5nLiBcIlNob2Nrd2F2ZSBGbGFzaCA3LjAgcjYxXCJcbiAgICogQHJldHVybnMge1N0cmluZ30gXCI3LjAuNjFcIlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgICBmdW5jdGlvbiBwYXJzZUZsYXNoVmVyc2lvbihkZXNjKSB7XG4gICAgICB2YXIgbWF0Y2hlcyA9IGRlc2MubWF0Y2goL1tcXGRdKy9nKTtcbiAgICAgIG1hdGNoZXMubGVuZ3RoID0gMztcbiAgICAgIHJldHVybiBtYXRjaGVzLmpvaW4oXCIuXCIpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBpc1BlcHBlckZsYXNoKGZsYXNoUGxheWVyRmlsZU5hbWUpIHtcbiAgICAgIHJldHVybiAhIWZsYXNoUGxheWVyRmlsZU5hbWUgJiYgKGZsYXNoUGxheWVyRmlsZU5hbWUgPSBmbGFzaFBsYXllckZpbGVOYW1lLnRvTG93ZXJDYXNlKCkpICYmICgvXihwZXBmbGFzaHBsYXllclxcLmRsbHxsaWJwZXBmbGFzaHBsYXllclxcLnNvfHBlcHBlcmZsYXNocGxheWVyXFwucGx1Z2luKSQvLnRlc3QoZmxhc2hQbGF5ZXJGaWxlTmFtZSkgfHwgZmxhc2hQbGF5ZXJGaWxlTmFtZS5zbGljZSgtMTMpID09PSBcImNocm9tZS5wbHVnaW5cIik7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGluc3BlY3RQbHVnaW4ocGx1Z2luKSB7XG4gICAgICBpZiAocGx1Z2luKSB7XG4gICAgICAgIGhhc0ZsYXNoID0gdHJ1ZTtcbiAgICAgICAgaWYgKHBsdWdpbi52ZXJzaW9uKSB7XG4gICAgICAgICAgZmxhc2hWZXJzaW9uID0gcGFyc2VGbGFzaFZlcnNpb24ocGx1Z2luLnZlcnNpb24pO1xuICAgICAgICB9XG4gICAgICAgIGlmICghZmxhc2hWZXJzaW9uICYmIHBsdWdpbi5kZXNjcmlwdGlvbikge1xuICAgICAgICAgIGZsYXNoVmVyc2lvbiA9IHBhcnNlRmxhc2hWZXJzaW9uKHBsdWdpbi5kZXNjcmlwdGlvbik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBsdWdpbi5maWxlbmFtZSkge1xuICAgICAgICAgIGlzUFBBUEkgPSBpc1BlcHBlckZsYXNoKHBsdWdpbi5maWxlbmFtZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKF9uYXZpZ2F0b3IucGx1Z2lucyAmJiBfbmF2aWdhdG9yLnBsdWdpbnMubGVuZ3RoKSB7XG4gICAgICBwbHVnaW4gPSBfbmF2aWdhdG9yLnBsdWdpbnNbXCJTaG9ja3dhdmUgRmxhc2hcIl07XG4gICAgICBpbnNwZWN0UGx1Z2luKHBsdWdpbik7XG4gICAgICBpZiAoX25hdmlnYXRvci5wbHVnaW5zW1wiU2hvY2t3YXZlIEZsYXNoIDIuMFwiXSkge1xuICAgICAgICBoYXNGbGFzaCA9IHRydWU7XG4gICAgICAgIGZsYXNoVmVyc2lvbiA9IFwiMi4wLjAuMTFcIjtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKF9uYXZpZ2F0b3IubWltZVR5cGVzICYmIF9uYXZpZ2F0b3IubWltZVR5cGVzLmxlbmd0aCkge1xuICAgICAgbWltZVR5cGUgPSBfbmF2aWdhdG9yLm1pbWVUeXBlc1tcImFwcGxpY2F0aW9uL3gtc2hvY2t3YXZlLWZsYXNoXCJdO1xuICAgICAgcGx1Z2luID0gbWltZVR5cGUgJiYgbWltZVR5cGUuZW5hYmxlZFBsdWdpbjtcbiAgICAgIGluc3BlY3RQbHVnaW4ocGx1Z2luKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBBY3RpdmVYT2JqZWN0ICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICBpc0FjdGl2ZVggPSB0cnVlO1xuICAgICAgdHJ5IHtcbiAgICAgICAgYXggPSBuZXcgQWN0aXZlWE9iamVjdChcIlNob2Nrd2F2ZUZsYXNoLlNob2Nrd2F2ZUZsYXNoLjdcIik7XG4gICAgICAgIGhhc0ZsYXNoID0gdHJ1ZTtcbiAgICAgICAgZmxhc2hWZXJzaW9uID0gcGFyc2VGbGFzaFZlcnNpb24oYXguR2V0VmFyaWFibGUoXCIkdmVyc2lvblwiKSk7XG4gICAgICB9IGNhdGNoIChlMSkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGF4ID0gbmV3IEFjdGl2ZVhPYmplY3QoXCJTaG9ja3dhdmVGbGFzaC5TaG9ja3dhdmVGbGFzaC42XCIpO1xuICAgICAgICAgIGhhc0ZsYXNoID0gdHJ1ZTtcbiAgICAgICAgICBmbGFzaFZlcnNpb24gPSBcIjYuMC4yMVwiO1xuICAgICAgICB9IGNhdGNoIChlMikge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBheCA9IG5ldyBBY3RpdmVYT2JqZWN0KFwiU2hvY2t3YXZlRmxhc2guU2hvY2t3YXZlRmxhc2hcIik7XG4gICAgICAgICAgICBoYXNGbGFzaCA9IHRydWU7XG4gICAgICAgICAgICBmbGFzaFZlcnNpb24gPSBwYXJzZUZsYXNoVmVyc2lvbihheC5HZXRWYXJpYWJsZShcIiR2ZXJzaW9uXCIpKTtcbiAgICAgICAgICB9IGNhdGNoIChlMykge1xuICAgICAgICAgICAgaXNBY3RpdmVYID0gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIF9mbGFzaFN0YXRlLmRpc2FibGVkID0gaGFzRmxhc2ggIT09IHRydWU7XG4gICAgX2ZsYXNoU3RhdGUub3V0ZGF0ZWQgPSBmbGFzaFZlcnNpb24gJiYgX3BhcnNlRmxvYXQoZmxhc2hWZXJzaW9uKSA8IF9wYXJzZUZsb2F0KF9taW5pbXVtRmxhc2hWZXJzaW9uKTtcbiAgICBfZmxhc2hTdGF0ZS52ZXJzaW9uID0gZmxhc2hWZXJzaW9uIHx8IFwiMC4wLjBcIjtcbiAgICBfZmxhc2hTdGF0ZS5wbHVnaW5UeXBlID0gaXNQUEFQSSA/IFwicGVwcGVyXCIgOiBpc0FjdGl2ZVggPyBcImFjdGl2ZXhcIiA6IGhhc0ZsYXNoID8gXCJuZXRzY2FwZVwiIDogXCJ1bmtub3duXCI7XG4gIH07XG4gIC8qKlxuICogSW52b2tlIHRoZSBGbGFzaCBkZXRlY3Rpb24gYWxnb3JpdGhtcyBpbW1lZGlhdGVseSB1cG9uIGluY2x1c2lvbiBzbyB3ZSdyZSBub3Qgd2FpdGluZyBsYXRlci5cbiAqL1xuICBfZGV0ZWN0Rmxhc2hTdXBwb3J0KF9BY3RpdmVYT2JqZWN0KTtcbiAgLyoqXG4gKiBBbHdheXMgYXNzZXNzIHRoZSBgc2FuZGJveGVkYCBzdGF0ZSBvZiB0aGUgcGFnZSBhdCBpbXBvcnRhbnQgRmxhc2gtcmVsYXRlZCBtb21lbnRzLlxuICovXG4gIF9kZXRlY3RTYW5kYm94KHRydWUpO1xuICAvKipcbiAqIEEgc2hlbGwgY29uc3RydWN0b3IgZm9yIGBaZXJvQ2xpcGJvYXJkYCBjbGllbnQgaW5zdGFuY2VzLlxuICpcbiAqIEBjb25zdHJ1Y3RvclxuICovXG4gIHZhciBaZXJvQ2xpcGJvYXJkID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFplcm9DbGlwYm9hcmQpKSB7XG4gICAgICByZXR1cm4gbmV3IFplcm9DbGlwYm9hcmQoKTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBaZXJvQ2xpcGJvYXJkLl9jcmVhdGVDbGllbnQgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgWmVyb0NsaXBib2FyZC5fY3JlYXRlQ2xpZW50LmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICAgIH1cbiAgfTtcbiAgLyoqXG4gKiBUaGUgWmVyb0NsaXBib2FyZCBsaWJyYXJ5J3MgdmVyc2lvbiBudW1iZXIuXG4gKlxuICogQHN0YXRpY1xuICogQHJlYWRvbmx5XG4gKiBAcHJvcGVydHkge3N0cmluZ31cbiAqL1xuICBfZGVmaW5lUHJvcGVydHkoWmVyb0NsaXBib2FyZCwgXCJ2ZXJzaW9uXCIsIHtcbiAgICB2YWx1ZTogXCIyLjIuMFwiLFxuICAgIHdyaXRhYmxlOiBmYWxzZSxcbiAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgZW51bWVyYWJsZTogdHJ1ZVxuICB9KTtcbiAgLyoqXG4gKiBVcGRhdGUgb3IgZ2V0IGEgY29weSBvZiB0aGUgWmVyb0NsaXBib2FyZCBnbG9iYWwgY29uZmlndXJhdGlvbi5cbiAqIFJldHVybnMgYSBjb3B5IG9mIHRoZSBjdXJyZW50L3VwZGF0ZWQgY29uZmlndXJhdGlvbi5cbiAqXG4gKiBAcmV0dXJucyBPYmplY3RcbiAqIEBzdGF0aWNcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLmNvbmZpZyA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfY29uZmlnLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIERpYWdub3N0aWMgbWV0aG9kIHRoYXQgZGVzY3JpYmVzIHRoZSBzdGF0ZSBvZiB0aGUgYnJvd3NlciwgRmxhc2ggUGxheWVyLCBhbmQgWmVyb0NsaXBib2FyZC5cbiAqXG4gKiBAcmV0dXJucyBPYmplY3RcbiAqIEBzdGF0aWNcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLnN0YXRlID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIF9zdGF0ZS5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBDaGVjayBpZiBGbGFzaCBpcyB1bnVzYWJsZSBmb3IgYW55IHJlYXNvbjogZGlzYWJsZWQsIG91dGRhdGVkLCBkZWFjdGl2YXRlZCwgZXRjLlxuICpcbiAqIEByZXR1cm5zIEJvb2xlYW5cbiAqIEBzdGF0aWNcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLmlzRmxhc2hVbnVzYWJsZSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfaXNGbGFzaFVudXNhYmxlLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIFJlZ2lzdGVyIGFuIGV2ZW50IGxpc3RlbmVyLlxuICpcbiAqIEByZXR1cm5zIGBaZXJvQ2xpcGJvYXJkYFxuICogQHN0YXRpY1xuICovXG4gIFplcm9DbGlwYm9hcmQub24gPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX29uLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIFVucmVnaXN0ZXIgYW4gZXZlbnQgbGlzdGVuZXIuXG4gKiBJZiBubyBgbGlzdGVuZXJgIGZ1bmN0aW9uL29iamVjdCBpcyBwcm92aWRlZCwgaXQgd2lsbCB1bnJlZ2lzdGVyIGFsbCBsaXN0ZW5lcnMgZm9yIHRoZSBwcm92aWRlZCBgZXZlbnRUeXBlYC5cbiAqIElmIG5vIGBldmVudFR5cGVgIGlzIHByb3ZpZGVkLCBpdCB3aWxsIHVucmVnaXN0ZXIgYWxsIGxpc3RlbmVycyBmb3IgZXZlcnkgZXZlbnQgdHlwZS5cbiAqXG4gKiBAcmV0dXJucyBgWmVyb0NsaXBib2FyZGBcbiAqIEBzdGF0aWNcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLm9mZiA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfb2ZmLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIFJldHJpZXZlIGV2ZW50IGxpc3RlbmVycyBmb3IgYW4gYGV2ZW50VHlwZWAuXG4gKiBJZiBubyBgZXZlbnRUeXBlYCBpcyBwcm92aWRlZCwgaXQgd2lsbCByZXRyaWV2ZSBhbGwgbGlzdGVuZXJzIGZvciBldmVyeSBldmVudCB0eXBlLlxuICpcbiAqIEByZXR1cm5zIGFycmF5IG9mIGxpc3RlbmVycyBmb3IgdGhlIGBldmVudFR5cGVgOyBpZiBubyBgZXZlbnRUeXBlYCwgdGhlbiBhIG1hcC9oYXNoIG9iamVjdCBvZiBsaXN0ZW5lcnMgZm9yIGFsbCBldmVudCB0eXBlczsgb3IgYG51bGxgXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5oYW5kbGVycyA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfbGlzdGVuZXJzLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIEV2ZW50IGVtaXNzaW9uIHJlY2VpdmVyIGZyb20gdGhlIEZsYXNoIG9iamVjdCwgZm9yd2FyZGluZyB0byBhbnkgcmVnaXN0ZXJlZCBKYXZhU2NyaXB0IGV2ZW50IGxpc3RlbmVycy5cbiAqXG4gKiBAcmV0dXJucyBGb3IgdGhlIFwiY29weVwiIGV2ZW50LCByZXR1cm5zIHRoZSBGbGFzaC1mcmllbmRseSBcImNsaXBEYXRhXCIgb2JqZWN0OyBvdGhlcndpc2UgYHVuZGVmaW5lZGAuXG4gKiBAc3RhdGljXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5lbWl0ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIF9lbWl0LmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIENyZWF0ZSBhbmQgZW1iZWQgdGhlIEZsYXNoIG9iamVjdC5cbiAqXG4gKiBAcmV0dXJucyBUaGUgRmxhc2ggb2JqZWN0XG4gKiBAc3RhdGljXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5jcmVhdGUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX2NyZWF0ZS5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBTZWxmLWRlc3RydWN0IGFuZCBjbGVhbiB1cCBldmVyeXRoaW5nLCBpbmNsdWRpbmcgdGhlIGVtYmVkZGVkIEZsYXNoIG9iamVjdC5cbiAqXG4gKiBAcmV0dXJucyBgdW5kZWZpbmVkYFxuICogQHN0YXRpY1xuICovXG4gIFplcm9DbGlwYm9hcmQuZGVzdHJveSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfZGVzdHJveS5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBTZXQgdGhlIHBlbmRpbmcgZGF0YSBmb3IgY2xpcGJvYXJkIGluamVjdGlvbi5cbiAqXG4gKiBAcmV0dXJucyBgdW5kZWZpbmVkYFxuICogQHN0YXRpY1xuICovXG4gIFplcm9DbGlwYm9hcmQuc2V0RGF0YSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfc2V0RGF0YS5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBDbGVhciB0aGUgcGVuZGluZyBkYXRhIGZvciBjbGlwYm9hcmQgaW5qZWN0aW9uLlxuICogSWYgbm8gYGZvcm1hdGAgaXMgcHJvdmlkZWQsIGFsbCBwZW5kaW5nIGRhdGEgZm9ybWF0cyB3aWxsIGJlIGNsZWFyZWQuXG4gKlxuICogQHJldHVybnMgYHVuZGVmaW5lZGBcbiAqIEBzdGF0aWNcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLmNsZWFyRGF0YSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfY2xlYXJEYXRhLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIEdldCBhIGNvcHkgb2YgdGhlIHBlbmRpbmcgZGF0YSBmb3IgY2xpcGJvYXJkIGluamVjdGlvbi5cbiAqIElmIG5vIGBmb3JtYXRgIGlzIHByb3ZpZGVkLCBhIGNvcHkgb2YgQUxMIHBlbmRpbmcgZGF0YSBmb3JtYXRzIHdpbGwgYmUgcmV0dXJuZWQuXG4gKlxuICogQHJldHVybnMgYFN0cmluZ2Agb3IgYE9iamVjdGBcbiAqIEBzdGF0aWNcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLmdldERhdGEgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX2dldERhdGEuYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gIH07XG4gIC8qKlxuICogU2V0cyB0aGUgY3VycmVudCBIVE1MIG9iamVjdCB0aGF0IHRoZSBGbGFzaCBvYmplY3Qgc2hvdWxkIG92ZXJsYXkuIFRoaXMgd2lsbCBwdXQgdGhlIGdsb2JhbFxuICogRmxhc2ggb2JqZWN0IG9uIHRvcCBvZiB0aGUgY3VycmVudCBlbGVtZW50OyBkZXBlbmRpbmcgb24gdGhlIHNldHVwLCB0aGlzIG1heSBhbHNvIHNldCB0aGVcbiAqIHBlbmRpbmcgY2xpcGJvYXJkIHRleHQgZGF0YSBhcyB3ZWxsIGFzIHRoZSBGbGFzaCBvYmplY3QncyB3cmFwcGluZyBlbGVtZW50J3MgdGl0bGUgYXR0cmlidXRlXG4gKiBiYXNlZCBvbiB0aGUgdW5kZXJseWluZyBIVE1MIGVsZW1lbnQgYW5kIFplcm9DbGlwYm9hcmQgY29uZmlndXJhdGlvbi5cbiAqXG4gKiBAcmV0dXJucyBgdW5kZWZpbmVkYFxuICogQHN0YXRpY1xuICovXG4gIFplcm9DbGlwYm9hcmQuZm9jdXMgPSBaZXJvQ2xpcGJvYXJkLmFjdGl2YXRlID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIF9mb2N1cy5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBVbi1vdmVybGF5cyB0aGUgRmxhc2ggb2JqZWN0LiBUaGlzIHdpbGwgcHV0IHRoZSBnbG9iYWwgRmxhc2ggb2JqZWN0IG9mZi1zY3JlZW47IGRlcGVuZGluZyBvblxuICogdGhlIHNldHVwLCB0aGlzIG1heSBhbHNvIHVuc2V0IHRoZSBGbGFzaCBvYmplY3QncyB3cmFwcGluZyBlbGVtZW50J3MgdGl0bGUgYXR0cmlidXRlIGJhc2VkIG9uXG4gKiB0aGUgdW5kZXJseWluZyBIVE1MIGVsZW1lbnQgYW5kIFplcm9DbGlwYm9hcmQgY29uZmlndXJhdGlvbi5cbiAqXG4gKiBAcmV0dXJucyBgdW5kZWZpbmVkYFxuICogQHN0YXRpY1xuICovXG4gIFplcm9DbGlwYm9hcmQuYmx1ciA9IFplcm9DbGlwYm9hcmQuZGVhY3RpdmF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfYmx1ci5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBSZXR1cm5zIHRoZSBjdXJyZW50bHkgZm9jdXNlZC9cImFjdGl2YXRlZFwiIEhUTUwgZWxlbWVudCB0aGF0IHRoZSBGbGFzaCBvYmplY3QgaXMgd3JhcHBpbmcuXG4gKlxuICogQHJldHVybnMgYEhUTUxFbGVtZW50YCBvciBgbnVsbGBcbiAqIEBzdGF0aWNcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLmFjdGl2ZUVsZW1lbnQgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX2FjdGl2ZUVsZW1lbnQuYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gIH07XG4gIC8qKlxuICogS2VlcCB0cmFjayBvZiB0aGUgWmVyb0NsaXBib2FyZCBjbGllbnQgaW5zdGFuY2UgY291bnRlci5cbiAqL1xuICB2YXIgX2NsaWVudElkQ291bnRlciA9IDA7XG4gIC8qKlxuICogS2VlcCB0cmFjayBvZiB0aGUgc3RhdGUgb2YgdGhlIGNsaWVudCBpbnN0YW5jZXMuXG4gKlxuICogRW50cnkgc3RydWN0dXJlOlxuICogICBfY2xpZW50TWV0YVtjbGllbnQuaWRdID0ge1xuICogICAgIGluc3RhbmNlOiBjbGllbnQsXG4gKiAgICAgZWxlbWVudHM6IFtdLFxuICogICAgIGhhbmRsZXJzOiB7fVxuICogICB9O1xuICovXG4gIHZhciBfY2xpZW50TWV0YSA9IHt9O1xuICAvKipcbiAqIEtlZXAgdHJhY2sgb2YgdGhlIFplcm9DbGlwYm9hcmQgY2xpcHBlZCBlbGVtZW50cyBjb3VudGVyLlxuICovXG4gIHZhciBfZWxlbWVudElkQ291bnRlciA9IDA7XG4gIC8qKlxuICogS2VlcCB0cmFjayBvZiB0aGUgc3RhdGUgb2YgdGhlIGNsaXBwZWQgZWxlbWVudCByZWxhdGlvbnNoaXBzIHRvIGNsaWVudHMuXG4gKlxuICogRW50cnkgc3RydWN0dXJlOlxuICogICBfZWxlbWVudE1ldGFbZWxlbWVudC56Y0NsaXBwaW5nSWRdID0gW2NsaWVudDEuaWQsIGNsaWVudDIuaWRdO1xuICovXG4gIHZhciBfZWxlbWVudE1ldGEgPSB7fTtcbiAgLyoqXG4gKiBLZWVwIHRyYWNrIG9mIHRoZSBzdGF0ZSBvZiB0aGUgbW91c2UgZXZlbnQgaGFuZGxlcnMgZm9yIGNsaXBwZWQgZWxlbWVudHMuXG4gKlxuICogRW50cnkgc3RydWN0dXJlOlxuICogICBfbW91c2VIYW5kbGVyc1tlbGVtZW50LnpjQ2xpcHBpbmdJZF0gPSB7XG4gKiAgICAgbW91c2VvdmVyOiAgZnVuY3Rpb24oZXZlbnQpIHt9LFxuICogICAgIG1vdXNlb3V0OiAgIGZ1bmN0aW9uKGV2ZW50KSB7fSxcbiAqICAgICBtb3VzZWVudGVyOiBmdW5jdGlvbihldmVudCkge30sXG4gKiAgICAgbW91c2VsZWF2ZTogZnVuY3Rpb24oZXZlbnQpIHt9LFxuICogICAgIG1vdXNlbW92ZTogIGZ1bmN0aW9uKGV2ZW50KSB7fVxuICogICB9O1xuICovXG4gIHZhciBfbW91c2VIYW5kbGVycyA9IHt9O1xuICAvKipcbiAqIEV4dGVuZGluZyB0aGUgWmVyb0NsaXBib2FyZCBjb25maWd1cmF0aW9uIGRlZmF1bHRzIGZvciB0aGUgQ2xpZW50IG1vZHVsZS5cbiAqL1xuICBfZXh0ZW5kKF9nbG9iYWxDb25maWcsIHtcbiAgICBhdXRvQWN0aXZhdGU6IHRydWVcbiAgfSk7XG4gIC8qKlxuICogVGhlIHJlYWwgY29uc3RydWN0b3IgZm9yIGBaZXJvQ2xpcGJvYXJkYCBjbGllbnQgaW5zdGFuY2VzLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2NsaWVudENvbnN0cnVjdG9yID0gZnVuY3Rpb24oZWxlbWVudHMpIHtcbiAgICB2YXIgY2xpZW50ID0gdGhpcztcbiAgICBjbGllbnQuaWQgPSBcIlwiICsgX2NsaWVudElkQ291bnRlcisrO1xuICAgIF9jbGllbnRNZXRhW2NsaWVudC5pZF0gPSB7XG4gICAgICBpbnN0YW5jZTogY2xpZW50LFxuICAgICAgZWxlbWVudHM6IFtdLFxuICAgICAgaGFuZGxlcnM6IHt9XG4gICAgfTtcbiAgICBpZiAoZWxlbWVudHMpIHtcbiAgICAgIGNsaWVudC5jbGlwKGVsZW1lbnRzKTtcbiAgICB9XG4gICAgWmVyb0NsaXBib2FyZC5vbihcIipcIiwgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIHJldHVybiBjbGllbnQuZW1pdChldmVudCk7XG4gICAgfSk7XG4gICAgWmVyb0NsaXBib2FyZC5vbihcImRlc3Ryb3lcIiwgZnVuY3Rpb24oKSB7XG4gICAgICBjbGllbnQuZGVzdHJveSgpO1xuICAgIH0pO1xuICAgIFplcm9DbGlwYm9hcmQuY3JlYXRlKCk7XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuQ2xpZW50LnByb3RvdHlwZS5vbmAuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY2xpZW50T24gPSBmdW5jdGlvbihldmVudFR5cGUsIGxpc3RlbmVyKSB7XG4gICAgdmFyIGksIGxlbiwgZXZlbnRzLCBhZGRlZCA9IHt9LCBtZXRhID0gX2NsaWVudE1ldGFbdGhpcy5pZF0sIGhhbmRsZXJzID0gbWV0YSAmJiBtZXRhLmhhbmRsZXJzO1xuICAgIGlmICghbWV0YSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQXR0ZW1wdGVkIHRvIGFkZCBuZXcgbGlzdGVuZXIocykgdG8gYSBkZXN0cm95ZWQgWmVyb0NsaXBib2FyZCBjbGllbnQgaW5zdGFuY2VcIik7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgZXZlbnRUeXBlID09PSBcInN0cmluZ1wiICYmIGV2ZW50VHlwZSkge1xuICAgICAgZXZlbnRzID0gZXZlbnRUeXBlLnRvTG93ZXJDYXNlKCkuc3BsaXQoL1xccysvKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBldmVudFR5cGUgPT09IFwib2JqZWN0XCIgJiYgZXZlbnRUeXBlICYmIHR5cGVvZiBsaXN0ZW5lciA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgZm9yIChpIGluIGV2ZW50VHlwZSkge1xuICAgICAgICBpZiAoX2hhc093bi5jYWxsKGV2ZW50VHlwZSwgaSkgJiYgdHlwZW9mIGkgPT09IFwic3RyaW5nXCIgJiYgaSAmJiB0eXBlb2YgZXZlbnRUeXBlW2ldID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICB0aGlzLm9uKGksIGV2ZW50VHlwZVtpXSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGV2ZW50cyAmJiBldmVudHMubGVuZ3RoKSB7XG4gICAgICBmb3IgKGkgPSAwLCBsZW4gPSBldmVudHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgZXZlbnRUeXBlID0gZXZlbnRzW2ldLnJlcGxhY2UoL15vbi8sIFwiXCIpO1xuICAgICAgICBhZGRlZFtldmVudFR5cGVdID0gdHJ1ZTtcbiAgICAgICAgaWYgKCFoYW5kbGVyc1tldmVudFR5cGVdKSB7XG4gICAgICAgICAgaGFuZGxlcnNbZXZlbnRUeXBlXSA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIGhhbmRsZXJzW2V2ZW50VHlwZV0ucHVzaChsaXN0ZW5lcik7XG4gICAgICB9XG4gICAgICBpZiAoYWRkZWQucmVhZHkgJiYgX2ZsYXNoU3RhdGUucmVhZHkpIHtcbiAgICAgICAgdGhpcy5lbWl0KHtcbiAgICAgICAgICB0eXBlOiBcInJlYWR5XCIsXG4gICAgICAgICAgY2xpZW50OiB0aGlzXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgaWYgKGFkZGVkLmVycm9yKSB7XG4gICAgICAgIGZvciAoaSA9IDAsIGxlbiA9IF9mbGFzaFN0YXRlRXJyb3JOYW1lcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgIGlmIChfZmxhc2hTdGF0ZVtfZmxhc2hTdGF0ZUVycm9yTmFtZXNbaV0ucmVwbGFjZSgvXmZsYXNoLS8sIFwiXCIpXSkge1xuICAgICAgICAgICAgdGhpcy5lbWl0KHtcbiAgICAgICAgICAgICAgdHlwZTogXCJlcnJvclwiLFxuICAgICAgICAgICAgICBuYW1lOiBfZmxhc2hTdGF0ZUVycm9yTmFtZXNbaV0sXG4gICAgICAgICAgICAgIGNsaWVudDogdGhpc1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKF96Y1N3ZlZlcnNpb24gIT09IHVuZGVmaW5lZCAmJiBaZXJvQ2xpcGJvYXJkLnZlcnNpb24gIT09IF96Y1N3ZlZlcnNpb24pIHtcbiAgICAgICAgICB0aGlzLmVtaXQoe1xuICAgICAgICAgICAgdHlwZTogXCJlcnJvclwiLFxuICAgICAgICAgICAgbmFtZTogXCJ2ZXJzaW9uLW1pc21hdGNoXCIsXG4gICAgICAgICAgICBqc1ZlcnNpb246IFplcm9DbGlwYm9hcmQudmVyc2lvbixcbiAgICAgICAgICAgIHN3ZlZlcnNpb246IF96Y1N3ZlZlcnNpb25cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcbiAgLyoqXG4gKiBUaGUgdW5kZXJseWluZyBpbXBsZW1lbnRhdGlvbiBvZiBgWmVyb0NsaXBib2FyZC5DbGllbnQucHJvdG90eXBlLm9mZmAuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY2xpZW50T2ZmID0gZnVuY3Rpb24oZXZlbnRUeXBlLCBsaXN0ZW5lcikge1xuICAgIHZhciBpLCBsZW4sIGZvdW5kSW5kZXgsIGV2ZW50cywgcGVyRXZlbnRIYW5kbGVycywgbWV0YSA9IF9jbGllbnRNZXRhW3RoaXMuaWRdLCBoYW5kbGVycyA9IG1ldGEgJiYgbWV0YS5oYW5kbGVycztcbiAgICBpZiAoIWhhbmRsZXJzKSB7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApIHtcbiAgICAgIGV2ZW50cyA9IF9rZXlzKGhhbmRsZXJzKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBldmVudFR5cGUgPT09IFwic3RyaW5nXCIgJiYgZXZlbnRUeXBlKSB7XG4gICAgICBldmVudHMgPSBldmVudFR5cGUuc3BsaXQoL1xccysvKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBldmVudFR5cGUgPT09IFwib2JqZWN0XCIgJiYgZXZlbnRUeXBlICYmIHR5cGVvZiBsaXN0ZW5lciA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgZm9yIChpIGluIGV2ZW50VHlwZSkge1xuICAgICAgICBpZiAoX2hhc093bi5jYWxsKGV2ZW50VHlwZSwgaSkgJiYgdHlwZW9mIGkgPT09IFwic3RyaW5nXCIgJiYgaSAmJiB0eXBlb2YgZXZlbnRUeXBlW2ldID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICB0aGlzLm9mZihpLCBldmVudFR5cGVbaV0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChldmVudHMgJiYgZXZlbnRzLmxlbmd0aCkge1xuICAgICAgZm9yIChpID0gMCwgbGVuID0gZXZlbnRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGV2ZW50VHlwZSA9IGV2ZW50c1tpXS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL15vbi8sIFwiXCIpO1xuICAgICAgICBwZXJFdmVudEhhbmRsZXJzID0gaGFuZGxlcnNbZXZlbnRUeXBlXTtcbiAgICAgICAgaWYgKHBlckV2ZW50SGFuZGxlcnMgJiYgcGVyRXZlbnRIYW5kbGVycy5sZW5ndGgpIHtcbiAgICAgICAgICBpZiAobGlzdGVuZXIpIHtcbiAgICAgICAgICAgIGZvdW5kSW5kZXggPSBwZXJFdmVudEhhbmRsZXJzLmluZGV4T2YobGlzdGVuZXIpO1xuICAgICAgICAgICAgd2hpbGUgKGZvdW5kSW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgICAgIHBlckV2ZW50SGFuZGxlcnMuc3BsaWNlKGZvdW5kSW5kZXgsIDEpO1xuICAgICAgICAgICAgICBmb3VuZEluZGV4ID0gcGVyRXZlbnRIYW5kbGVycy5pbmRleE9mKGxpc3RlbmVyLCBmb3VuZEluZGV4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcGVyRXZlbnRIYW5kbGVycy5sZW5ndGggPSAwO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcbiAgLyoqXG4gKiBUaGUgdW5kZXJseWluZyBpbXBsZW1lbnRhdGlvbiBvZiBgWmVyb0NsaXBib2FyZC5DbGllbnQucHJvdG90eXBlLmhhbmRsZXJzYC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9jbGllbnRMaXN0ZW5lcnMgPSBmdW5jdGlvbihldmVudFR5cGUpIHtcbiAgICB2YXIgY29weSA9IG51bGwsIGhhbmRsZXJzID0gX2NsaWVudE1ldGFbdGhpcy5pZF0gJiYgX2NsaWVudE1ldGFbdGhpcy5pZF0uaGFuZGxlcnM7XG4gICAgaWYgKGhhbmRsZXJzKSB7XG4gICAgICBpZiAodHlwZW9mIGV2ZW50VHlwZSA9PT0gXCJzdHJpbmdcIiAmJiBldmVudFR5cGUpIHtcbiAgICAgICAgY29weSA9IGhhbmRsZXJzW2V2ZW50VHlwZV0gPyBoYW5kbGVyc1tldmVudFR5cGVdLnNsaWNlKDApIDogW107XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb3B5ID0gX2RlZXBDb3B5KGhhbmRsZXJzKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGNvcHk7XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuQ2xpZW50LnByb3RvdHlwZS5lbWl0YC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9jbGllbnRFbWl0ID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICBpZiAoX2NsaWVudFNob3VsZEVtaXQuY2FsbCh0aGlzLCBldmVudCkpIHtcbiAgICAgIGlmICh0eXBlb2YgZXZlbnQgPT09IFwib2JqZWN0XCIgJiYgZXZlbnQgJiYgdHlwZW9mIGV2ZW50LnR5cGUgPT09IFwic3RyaW5nXCIgJiYgZXZlbnQudHlwZSkge1xuICAgICAgICBldmVudCA9IF9leHRlbmQoe30sIGV2ZW50KTtcbiAgICAgIH1cbiAgICAgIHZhciBldmVudENvcHkgPSBfZXh0ZW5kKHt9LCBfY3JlYXRlRXZlbnQoZXZlbnQpLCB7XG4gICAgICAgIGNsaWVudDogdGhpc1xuICAgICAgfSk7XG4gICAgICBfY2xpZW50RGlzcGF0Y2hDYWxsYmFja3MuY2FsbCh0aGlzLCBldmVudENvcHkpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcbiAgLyoqXG4gKiBUaGUgdW5kZXJseWluZyBpbXBsZW1lbnRhdGlvbiBvZiBgWmVyb0NsaXBib2FyZC5DbGllbnQucHJvdG90eXBlLmNsaXBgLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2NsaWVudENsaXAgPSBmdW5jdGlvbihlbGVtZW50cykge1xuICAgIGlmICghX2NsaWVudE1ldGFbdGhpcy5pZF0pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkF0dGVtcHRlZCB0byBjbGlwIGVsZW1lbnQocykgdG8gYSBkZXN0cm95ZWQgWmVyb0NsaXBib2FyZCBjbGllbnQgaW5zdGFuY2VcIik7XG4gICAgfVxuICAgIGVsZW1lbnRzID0gX3ByZXBDbGlwKGVsZW1lbnRzKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoX2hhc093bi5jYWxsKGVsZW1lbnRzLCBpKSAmJiBlbGVtZW50c1tpXSAmJiBlbGVtZW50c1tpXS5ub2RlVHlwZSA9PT0gMSkge1xuICAgICAgICBpZiAoIWVsZW1lbnRzW2ldLnpjQ2xpcHBpbmdJZCkge1xuICAgICAgICAgIGVsZW1lbnRzW2ldLnpjQ2xpcHBpbmdJZCA9IFwiemNDbGlwcGluZ0lkX1wiICsgX2VsZW1lbnRJZENvdW50ZXIrKztcbiAgICAgICAgICBfZWxlbWVudE1ldGFbZWxlbWVudHNbaV0uemNDbGlwcGluZ0lkXSA9IFsgdGhpcy5pZCBdO1xuICAgICAgICAgIGlmIChfZ2xvYmFsQ29uZmlnLmF1dG9BY3RpdmF0ZSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgX2FkZE1vdXNlSGFuZGxlcnMoZWxlbWVudHNbaV0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChfZWxlbWVudE1ldGFbZWxlbWVudHNbaV0uemNDbGlwcGluZ0lkXS5pbmRleE9mKHRoaXMuaWQpID09PSAtMSkge1xuICAgICAgICAgIF9lbGVtZW50TWV0YVtlbGVtZW50c1tpXS56Y0NsaXBwaW5nSWRdLnB1c2godGhpcy5pZCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNsaXBwZWRFbGVtZW50cyA9IF9jbGllbnRNZXRhW3RoaXMuaWRdICYmIF9jbGllbnRNZXRhW3RoaXMuaWRdLmVsZW1lbnRzO1xuICAgICAgICBpZiAoY2xpcHBlZEVsZW1lbnRzLmluZGV4T2YoZWxlbWVudHNbaV0pID09PSAtMSkge1xuICAgICAgICAgIGNsaXBwZWRFbGVtZW50cy5wdXNoKGVsZW1lbnRzW2ldKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcbiAgLyoqXG4gKiBUaGUgdW5kZXJseWluZyBpbXBsZW1lbnRhdGlvbiBvZiBgWmVyb0NsaXBib2FyZC5DbGllbnQucHJvdG90eXBlLnVuY2xpcGAuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY2xpZW50VW5jbGlwID0gZnVuY3Rpb24oZWxlbWVudHMpIHtcbiAgICB2YXIgbWV0YSA9IF9jbGllbnRNZXRhW3RoaXMuaWRdO1xuICAgIGlmICghbWV0YSkge1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHZhciBjbGlwcGVkRWxlbWVudHMgPSBtZXRhLmVsZW1lbnRzO1xuICAgIHZhciBhcnJheUluZGV4O1xuICAgIGlmICh0eXBlb2YgZWxlbWVudHMgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIGVsZW1lbnRzID0gY2xpcHBlZEVsZW1lbnRzLnNsaWNlKDApO1xuICAgIH0gZWxzZSB7XG4gICAgICBlbGVtZW50cyA9IF9wcmVwQ2xpcChlbGVtZW50cyk7XG4gICAgfVxuICAgIGZvciAodmFyIGkgPSBlbGVtZW50cy5sZW5ndGg7IGktLTsgKSB7XG4gICAgICBpZiAoX2hhc093bi5jYWxsKGVsZW1lbnRzLCBpKSAmJiBlbGVtZW50c1tpXSAmJiBlbGVtZW50c1tpXS5ub2RlVHlwZSA9PT0gMSkge1xuICAgICAgICBhcnJheUluZGV4ID0gMDtcbiAgICAgICAgd2hpbGUgKChhcnJheUluZGV4ID0gY2xpcHBlZEVsZW1lbnRzLmluZGV4T2YoZWxlbWVudHNbaV0sIGFycmF5SW5kZXgpKSAhPT0gLTEpIHtcbiAgICAgICAgICBjbGlwcGVkRWxlbWVudHMuc3BsaWNlKGFycmF5SW5kZXgsIDEpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjbGllbnRJZHMgPSBfZWxlbWVudE1ldGFbZWxlbWVudHNbaV0uemNDbGlwcGluZ0lkXTtcbiAgICAgICAgaWYgKGNsaWVudElkcykge1xuICAgICAgICAgIGFycmF5SW5kZXggPSAwO1xuICAgICAgICAgIHdoaWxlICgoYXJyYXlJbmRleCA9IGNsaWVudElkcy5pbmRleE9mKHRoaXMuaWQsIGFycmF5SW5kZXgpKSAhPT0gLTEpIHtcbiAgICAgICAgICAgIGNsaWVudElkcy5zcGxpY2UoYXJyYXlJbmRleCwgMSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChjbGllbnRJZHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBpZiAoX2dsb2JhbENvbmZpZy5hdXRvQWN0aXZhdGUgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgX3JlbW92ZU1vdXNlSGFuZGxlcnMoZWxlbWVudHNbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVsZXRlIGVsZW1lbnRzW2ldLnpjQ2xpcHBpbmdJZDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuQ2xpZW50LnByb3RvdHlwZS5lbGVtZW50c2AuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY2xpZW50RWxlbWVudHMgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgbWV0YSA9IF9jbGllbnRNZXRhW3RoaXMuaWRdO1xuICAgIHJldHVybiBtZXRhICYmIG1ldGEuZWxlbWVudHMgPyBtZXRhLmVsZW1lbnRzLnNsaWNlKDApIDogW107XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuQ2xpZW50LnByb3RvdHlwZS5kZXN0cm95YC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9jbGllbnREZXN0cm95ID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKCFfY2xpZW50TWV0YVt0aGlzLmlkXSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLnVuY2xpcCgpO1xuICAgIHRoaXMub2ZmKCk7XG4gICAgZGVsZXRlIF9jbGllbnRNZXRhW3RoaXMuaWRdO1xuICB9O1xuICAvKipcbiAqIEluc3BlY3QgYW4gRXZlbnQgdG8gc2VlIGlmIHRoZSBDbGllbnQgKGB0aGlzYCkgc2hvdWxkIGhvbm9yIGl0IGZvciBlbWlzc2lvbi5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9jbGllbnRTaG91bGRFbWl0ID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICBpZiAoIShldmVudCAmJiBldmVudC50eXBlKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAoZXZlbnQuY2xpZW50ICYmIGV2ZW50LmNsaWVudCAhPT0gdGhpcykge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2YXIgbWV0YSA9IF9jbGllbnRNZXRhW3RoaXMuaWRdO1xuICAgIHZhciBjbGlwcGVkRWxzID0gbWV0YSAmJiBtZXRhLmVsZW1lbnRzO1xuICAgIHZhciBoYXNDbGlwcGVkRWxzID0gISFjbGlwcGVkRWxzICYmIGNsaXBwZWRFbHMubGVuZ3RoID4gMDtcbiAgICB2YXIgZ29vZFRhcmdldCA9ICFldmVudC50YXJnZXQgfHwgaGFzQ2xpcHBlZEVscyAmJiBjbGlwcGVkRWxzLmluZGV4T2YoZXZlbnQudGFyZ2V0KSAhPT0gLTE7XG4gICAgdmFyIGdvb2RSZWxUYXJnZXQgPSBldmVudC5yZWxhdGVkVGFyZ2V0ICYmIGhhc0NsaXBwZWRFbHMgJiYgY2xpcHBlZEVscy5pbmRleE9mKGV2ZW50LnJlbGF0ZWRUYXJnZXQpICE9PSAtMTtcbiAgICB2YXIgZ29vZENsaWVudCA9IGV2ZW50LmNsaWVudCAmJiBldmVudC5jbGllbnQgPT09IHRoaXM7XG4gICAgaWYgKCFtZXRhIHx8ICEoZ29vZFRhcmdldCB8fCBnb29kUmVsVGFyZ2V0IHx8IGdvb2RDbGllbnQpKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xuICB9O1xuICAvKipcbiAqIEhhbmRsZSB0aGUgYWN0dWFsIGRpc3BhdGNoaW5nIG9mIGV2ZW50cyB0byBhIGNsaWVudCBpbnN0YW5jZS5cbiAqXG4gKiBAcmV0dXJucyBgdW5kZWZpbmVkYFxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2NsaWVudERpc3BhdGNoQ2FsbGJhY2tzID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICB2YXIgbWV0YSA9IF9jbGllbnRNZXRhW3RoaXMuaWRdO1xuICAgIGlmICghKHR5cGVvZiBldmVudCA9PT0gXCJvYmplY3RcIiAmJiBldmVudCAmJiBldmVudC50eXBlICYmIG1ldGEpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBhc3luYyA9IF9zaG91bGRQZXJmb3JtQXN5bmMoZXZlbnQpO1xuICAgIHZhciB3aWxkY2FyZFR5cGVIYW5kbGVycyA9IG1ldGEgJiYgbWV0YS5oYW5kbGVyc1tcIipcIl0gfHwgW107XG4gICAgdmFyIHNwZWNpZmljVHlwZUhhbmRsZXJzID0gbWV0YSAmJiBtZXRhLmhhbmRsZXJzW2V2ZW50LnR5cGVdIHx8IFtdO1xuICAgIHZhciBoYW5kbGVycyA9IHdpbGRjYXJkVHlwZUhhbmRsZXJzLmNvbmNhdChzcGVjaWZpY1R5cGVIYW5kbGVycyk7XG4gICAgaWYgKGhhbmRsZXJzICYmIGhhbmRsZXJzLmxlbmd0aCkge1xuICAgICAgdmFyIGksIGxlbiwgZnVuYywgY29udGV4dCwgZXZlbnRDb3B5LCBvcmlnaW5hbENvbnRleHQgPSB0aGlzO1xuICAgICAgZm9yIChpID0gMCwgbGVuID0gaGFuZGxlcnMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgZnVuYyA9IGhhbmRsZXJzW2ldO1xuICAgICAgICBjb250ZXh0ID0gb3JpZ2luYWxDb250ZXh0O1xuICAgICAgICBpZiAodHlwZW9mIGZ1bmMgPT09IFwic3RyaW5nXCIgJiYgdHlwZW9mIF93aW5kb3dbZnVuY10gPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgIGZ1bmMgPSBfd2luZG93W2Z1bmNdO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgZnVuYyA9PT0gXCJvYmplY3RcIiAmJiBmdW5jICYmIHR5cGVvZiBmdW5jLmhhbmRsZUV2ZW50ID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICBjb250ZXh0ID0gZnVuYztcbiAgICAgICAgICBmdW5jID0gZnVuYy5oYW5kbGVFdmVudDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGZ1bmMgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgIGV2ZW50Q29weSA9IF9leHRlbmQoe30sIGV2ZW50KTtcbiAgICAgICAgICBfZGlzcGF0Y2hDYWxsYmFjayhmdW5jLCBjb250ZXh0LCBbIGV2ZW50Q29weSBdLCBhc3luYyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH07XG4gIC8qKlxuICogUHJlcGFyZXMgdGhlIGVsZW1lbnRzIGZvciBjbGlwcGluZy91bmNsaXBwaW5nLlxuICpcbiAqIEByZXR1cm5zIEFuIEFycmF5IG9mIGVsZW1lbnRzLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX3ByZXBDbGlwID0gZnVuY3Rpb24oZWxlbWVudHMpIHtcbiAgICBpZiAodHlwZW9mIGVsZW1lbnRzID09PSBcInN0cmluZ1wiKSB7XG4gICAgICBlbGVtZW50cyA9IFtdO1xuICAgIH1cbiAgICByZXR1cm4gdHlwZW9mIGVsZW1lbnRzLmxlbmd0aCAhPT0gXCJudW1iZXJcIiA/IFsgZWxlbWVudHMgXSA6IGVsZW1lbnRzO1xuICB9O1xuICAvKipcbiAqIEFkZCBhIGBtb3VzZW92ZXJgIGhhbmRsZXIgZnVuY3Rpb24gZm9yIGEgY2xpcHBlZCBlbGVtZW50LlxuICpcbiAqIEByZXR1cm5zIGB1bmRlZmluZWRgXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfYWRkTW91c2VIYW5kbGVycyA9IGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICBpZiAoIShlbGVtZW50ICYmIGVsZW1lbnQubm9kZVR5cGUgPT09IDEpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBfc3VwcHJlc3NNb3VzZUV2ZW50cyA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICBpZiAoIShldmVudCB8fCAoZXZlbnQgPSBfd2luZG93LmV2ZW50KSkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKGV2ZW50Ll9zb3VyY2UgIT09IFwianNcIikge1xuICAgICAgICBldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIH1cbiAgICAgIGRlbGV0ZSBldmVudC5fc291cmNlO1xuICAgIH07XG4gICAgdmFyIF9lbGVtZW50TW91c2VPdmVyID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIGlmICghKGV2ZW50IHx8IChldmVudCA9IF93aW5kb3cuZXZlbnQpKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBfc3VwcHJlc3NNb3VzZUV2ZW50cyhldmVudCk7XG4gICAgICBaZXJvQ2xpcGJvYXJkLmZvY3VzKGVsZW1lbnQpO1xuICAgIH07XG4gICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2VvdmVyXCIsIF9lbGVtZW50TW91c2VPdmVyLCBmYWxzZSk7XG4gICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2VvdXRcIiwgX3N1cHByZXNzTW91c2VFdmVudHMsIGZhbHNlKTtcbiAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWVudGVyXCIsIF9zdXBwcmVzc01vdXNlRXZlbnRzLCBmYWxzZSk7XG4gICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2VsZWF2ZVwiLCBfc3VwcHJlc3NNb3VzZUV2ZW50cywgZmFsc2UpO1xuICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCBfc3VwcHJlc3NNb3VzZUV2ZW50cywgZmFsc2UpO1xuICAgIF9tb3VzZUhhbmRsZXJzW2VsZW1lbnQuemNDbGlwcGluZ0lkXSA9IHtcbiAgICAgIG1vdXNlb3ZlcjogX2VsZW1lbnRNb3VzZU92ZXIsXG4gICAgICBtb3VzZW91dDogX3N1cHByZXNzTW91c2VFdmVudHMsXG4gICAgICBtb3VzZWVudGVyOiBfc3VwcHJlc3NNb3VzZUV2ZW50cyxcbiAgICAgIG1vdXNlbGVhdmU6IF9zdXBwcmVzc01vdXNlRXZlbnRzLFxuICAgICAgbW91c2Vtb3ZlOiBfc3VwcHJlc3NNb3VzZUV2ZW50c1xuICAgIH07XG4gIH07XG4gIC8qKlxuICogUmVtb3ZlIGEgYG1vdXNlb3ZlcmAgaGFuZGxlciBmdW5jdGlvbiBmb3IgYSBjbGlwcGVkIGVsZW1lbnQuXG4gKlxuICogQHJldHVybnMgYHVuZGVmaW5lZGBcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9yZW1vdmVNb3VzZUhhbmRsZXJzID0gZnVuY3Rpb24oZWxlbWVudCkge1xuICAgIGlmICghKGVsZW1lbnQgJiYgZWxlbWVudC5ub2RlVHlwZSA9PT0gMSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIG1vdXNlSGFuZGxlcnMgPSBfbW91c2VIYW5kbGVyc1tlbGVtZW50LnpjQ2xpcHBpbmdJZF07XG4gICAgaWYgKCEodHlwZW9mIG1vdXNlSGFuZGxlcnMgPT09IFwib2JqZWN0XCIgJiYgbW91c2VIYW5kbGVycykpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIGtleSwgdmFsLCBtb3VzZUV2ZW50cyA9IFsgXCJtb3ZlXCIsIFwibGVhdmVcIiwgXCJlbnRlclwiLCBcIm91dFwiLCBcIm92ZXJcIiBdO1xuICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBtb3VzZUV2ZW50cy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAga2V5ID0gXCJtb3VzZVwiICsgbW91c2VFdmVudHNbaV07XG4gICAgICB2YWwgPSBtb3VzZUhhbmRsZXJzW2tleV07XG4gICAgICBpZiAodHlwZW9mIHZhbCA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIGVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihrZXksIHZhbCwgZmFsc2UpO1xuICAgICAgfVxuICAgIH1cbiAgICBkZWxldGUgX21vdXNlSGFuZGxlcnNbZWxlbWVudC56Y0NsaXBwaW5nSWRdO1xuICB9O1xuICAvKipcbiAqIENyZWF0ZXMgYSBuZXcgWmVyb0NsaXBib2FyZCBjbGllbnQgaW5zdGFuY2UuXG4gKiBPcHRpb25hbGx5LCBhdXRvLWBjbGlwYCBhbiBlbGVtZW50IG9yIGNvbGxlY3Rpb24gb2YgZWxlbWVudHMuXG4gKlxuICogQGNvbnN0cnVjdG9yXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5fY3JlYXRlQ2xpZW50ID0gZnVuY3Rpb24oKSB7XG4gICAgX2NsaWVudENvbnN0cnVjdG9yLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIFJlZ2lzdGVyIGFuIGV2ZW50IGxpc3RlbmVyIHRvIHRoZSBjbGllbnQuXG4gKlxuICogQHJldHVybnMgYHRoaXNgXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5wcm90b3R5cGUub24gPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX2NsaWVudE9uLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIFVucmVnaXN0ZXIgYW4gZXZlbnQgaGFuZGxlciBmcm9tIHRoZSBjbGllbnQuXG4gKiBJZiBubyBgbGlzdGVuZXJgIGZ1bmN0aW9uL29iamVjdCBpcyBwcm92aWRlZCwgaXQgd2lsbCB1bnJlZ2lzdGVyIGFsbCBoYW5kbGVycyBmb3IgdGhlIHByb3ZpZGVkIGBldmVudFR5cGVgLlxuICogSWYgbm8gYGV2ZW50VHlwZWAgaXMgcHJvdmlkZWQsIGl0IHdpbGwgdW5yZWdpc3RlciBhbGwgaGFuZGxlcnMgZm9yIGV2ZXJ5IGV2ZW50IHR5cGUuXG4gKlxuICogQHJldHVybnMgYHRoaXNgXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5wcm90b3R5cGUub2ZmID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIF9jbGllbnRPZmYuYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gIH07XG4gIC8qKlxuICogUmV0cmlldmUgZXZlbnQgbGlzdGVuZXJzIGZvciBhbiBgZXZlbnRUeXBlYCBmcm9tIHRoZSBjbGllbnQuXG4gKiBJZiBubyBgZXZlbnRUeXBlYCBpcyBwcm92aWRlZCwgaXQgd2lsbCByZXRyaWV2ZSBhbGwgbGlzdGVuZXJzIGZvciBldmVyeSBldmVudCB0eXBlLlxuICpcbiAqIEByZXR1cm5zIGFycmF5IG9mIGxpc3RlbmVycyBmb3IgdGhlIGBldmVudFR5cGVgOyBpZiBubyBgZXZlbnRUeXBlYCwgdGhlbiBhIG1hcC9oYXNoIG9iamVjdCBvZiBsaXN0ZW5lcnMgZm9yIGFsbCBldmVudCB0eXBlczsgb3IgYG51bGxgXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5wcm90b3R5cGUuaGFuZGxlcnMgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX2NsaWVudExpc3RlbmVycy5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBFdmVudCBlbWlzc2lvbiByZWNlaXZlciBmcm9tIHRoZSBGbGFzaCBvYmplY3QgZm9yIHRoaXMgY2xpZW50J3MgcmVnaXN0ZXJlZCBKYXZhU2NyaXB0IGV2ZW50IGxpc3RlbmVycy5cbiAqXG4gKiBAcmV0dXJucyBGb3IgdGhlIFwiY29weVwiIGV2ZW50LCByZXR1cm5zIHRoZSBGbGFzaC1mcmllbmRseSBcImNsaXBEYXRhXCIgb2JqZWN0OyBvdGhlcndpc2UgYHVuZGVmaW5lZGAuXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5wcm90b3R5cGUuZW1pdCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfY2xpZW50RW1pdC5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBSZWdpc3RlciBjbGlwYm9hcmQgYWN0aW9ucyBmb3IgbmV3IGVsZW1lbnQocykgdG8gdGhlIGNsaWVudC5cbiAqXG4gKiBAcmV0dXJucyBgdGhpc2BcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLnByb3RvdHlwZS5jbGlwID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIF9jbGllbnRDbGlwLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIFVucmVnaXN0ZXIgdGhlIGNsaXBib2FyZCBhY3Rpb25zIG9mIHByZXZpb3VzbHkgcmVnaXN0ZXJlZCBlbGVtZW50KHMpIG9uIHRoZSBwYWdlLlxuICogSWYgbm8gZWxlbWVudHMgYXJlIHByb3ZpZGVkLCBBTEwgcmVnaXN0ZXJlZCBlbGVtZW50cyB3aWxsIGJlIHVucmVnaXN0ZXJlZC5cbiAqXG4gKiBAcmV0dXJucyBgdGhpc2BcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLnByb3RvdHlwZS51bmNsaXAgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX2NsaWVudFVuY2xpcC5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBHZXQgYWxsIG9mIHRoZSBlbGVtZW50cyB0byB3aGljaCB0aGlzIGNsaWVudCBpcyBjbGlwcGVkLlxuICpcbiAqIEByZXR1cm5zIGFycmF5IG9mIGNsaXBwZWQgZWxlbWVudHNcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLnByb3RvdHlwZS5lbGVtZW50cyA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfY2xpZW50RWxlbWVudHMuYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gIH07XG4gIC8qKlxuICogU2VsZi1kZXN0cnVjdCBhbmQgY2xlYW4gdXAgZXZlcnl0aGluZyBmb3IgYSBzaW5nbGUgY2xpZW50LlxuICogVGhpcyB3aWxsIE5PVCBkZXN0cm95IHRoZSBlbWJlZGRlZCBGbGFzaCBvYmplY3QuXG4gKlxuICogQHJldHVybnMgYHVuZGVmaW5lZGBcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIF9jbGllbnREZXN0cm95LmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIFN0b3JlcyB0aGUgcGVuZGluZyBwbGFpbiB0ZXh0IHRvIGluamVjdCBpbnRvIHRoZSBjbGlwYm9hcmQuXG4gKlxuICogQHJldHVybnMgYHRoaXNgXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5wcm90b3R5cGUuc2V0VGV4dCA9IGZ1bmN0aW9uKHRleHQpIHtcbiAgICBpZiAoIV9jbGllbnRNZXRhW3RoaXMuaWRdKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBdHRlbXB0ZWQgdG8gc2V0IHBlbmRpbmcgY2xpcGJvYXJkIGRhdGEgZnJvbSBhIGRlc3Ryb3llZCBaZXJvQ2xpcGJvYXJkIGNsaWVudCBpbnN0YW5jZVwiKTtcbiAgICB9XG4gICAgWmVyb0NsaXBib2FyZC5zZXREYXRhKFwidGV4dC9wbGFpblwiLCB0ZXh0KTtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcbiAgLyoqXG4gKiBTdG9yZXMgdGhlIHBlbmRpbmcgSFRNTCB0ZXh0IHRvIGluamVjdCBpbnRvIHRoZSBjbGlwYm9hcmQuXG4gKlxuICogQHJldHVybnMgYHRoaXNgXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5wcm90b3R5cGUuc2V0SHRtbCA9IGZ1bmN0aW9uKGh0bWwpIHtcbiAgICBpZiAoIV9jbGllbnRNZXRhW3RoaXMuaWRdKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBdHRlbXB0ZWQgdG8gc2V0IHBlbmRpbmcgY2xpcGJvYXJkIGRhdGEgZnJvbSBhIGRlc3Ryb3llZCBaZXJvQ2xpcGJvYXJkIGNsaWVudCBpbnN0YW5jZVwiKTtcbiAgICB9XG4gICAgWmVyb0NsaXBib2FyZC5zZXREYXRhKFwidGV4dC9odG1sXCIsIGh0bWwpO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuICAvKipcbiAqIFN0b3JlcyB0aGUgcGVuZGluZyByaWNoIHRleHQgKFJURikgdG8gaW5qZWN0IGludG8gdGhlIGNsaXBib2FyZC5cbiAqXG4gKiBAcmV0dXJucyBgdGhpc2BcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLnByb3RvdHlwZS5zZXRSaWNoVGV4dCA9IGZ1bmN0aW9uKHJpY2hUZXh0KSB7XG4gICAgaWYgKCFfY2xpZW50TWV0YVt0aGlzLmlkXSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQXR0ZW1wdGVkIHRvIHNldCBwZW5kaW5nIGNsaXBib2FyZCBkYXRhIGZyb20gYSBkZXN0cm95ZWQgWmVyb0NsaXBib2FyZCBjbGllbnQgaW5zdGFuY2VcIik7XG4gICAgfVxuICAgIFplcm9DbGlwYm9hcmQuc2V0RGF0YShcImFwcGxpY2F0aW9uL3J0ZlwiLCByaWNoVGV4dCk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG4gIC8qKlxuICogU3RvcmVzIHRoZSBwZW5kaW5nIGRhdGEgdG8gaW5qZWN0IGludG8gdGhlIGNsaXBib2FyZC5cbiAqXG4gKiBAcmV0dXJucyBgdGhpc2BcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLnByb3RvdHlwZS5zZXREYXRhID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKCFfY2xpZW50TWV0YVt0aGlzLmlkXSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQXR0ZW1wdGVkIHRvIHNldCBwZW5kaW5nIGNsaXBib2FyZCBkYXRhIGZyb20gYSBkZXN0cm95ZWQgWmVyb0NsaXBib2FyZCBjbGllbnQgaW5zdGFuY2VcIik7XG4gICAgfVxuICAgIFplcm9DbGlwYm9hcmQuc2V0RGF0YS5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcbiAgLyoqXG4gKiBDbGVhcnMgdGhlIHBlbmRpbmcgZGF0YSB0byBpbmplY3QgaW50byB0aGUgY2xpcGJvYXJkLlxuICogSWYgbm8gYGZvcm1hdGAgaXMgcHJvdmlkZWQsIGFsbCBwZW5kaW5nIGRhdGEgZm9ybWF0cyB3aWxsIGJlIGNsZWFyZWQuXG4gKlxuICogQHJldHVybnMgYHRoaXNgXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5wcm90b3R5cGUuY2xlYXJEYXRhID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKCFfY2xpZW50TWV0YVt0aGlzLmlkXSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQXR0ZW1wdGVkIHRvIGNsZWFyIHBlbmRpbmcgY2xpcGJvYXJkIGRhdGEgZnJvbSBhIGRlc3Ryb3llZCBaZXJvQ2xpcGJvYXJkIGNsaWVudCBpbnN0YW5jZVwiKTtcbiAgICB9XG4gICAgWmVyb0NsaXBib2FyZC5jbGVhckRhdGEuYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG4gIC8qKlxuICogR2V0cyBhIGNvcHkgb2YgdGhlIHBlbmRpbmcgZGF0YSB0byBpbmplY3QgaW50byB0aGUgY2xpcGJvYXJkLlxuICogSWYgbm8gYGZvcm1hdGAgaXMgcHJvdmlkZWQsIGEgY29weSBvZiBBTEwgcGVuZGluZyBkYXRhIGZvcm1hdHMgd2lsbCBiZSByZXR1cm5lZC5cbiAqXG4gKiBAcmV0dXJucyBgU3RyaW5nYCBvciBgT2JqZWN0YFxuICovXG4gIFplcm9DbGlwYm9hcmQucHJvdG90eXBlLmdldERhdGEgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAoIV9jbGllbnRNZXRhW3RoaXMuaWRdKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBdHRlbXB0ZWQgdG8gZ2V0IHBlbmRpbmcgY2xpcGJvYXJkIGRhdGEgZnJvbSBhIGRlc3Ryb3llZCBaZXJvQ2xpcGJvYXJkIGNsaWVudCBpbnN0YW5jZVwiKTtcbiAgICB9XG4gICAgcmV0dXJuIFplcm9DbGlwYm9hcmQuZ2V0RGF0YS5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgaWYgKHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kKSB7XG4gICAgZGVmaW5lKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIFplcm9DbGlwYm9hcmQ7XG4gICAgfSk7XG4gIH0gZWxzZSBpZiAodHlwZW9mIG1vZHVsZSA9PT0gXCJvYmplY3RcIiAmJiBtb2R1bGUgJiYgdHlwZW9mIG1vZHVsZS5leHBvcnRzID09PSBcIm9iamVjdFwiICYmIG1vZHVsZS5leHBvcnRzKSB7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSBaZXJvQ2xpcGJvYXJkO1xuICB9IGVsc2Uge1xuICAgIHdpbmRvdy5aZXJvQ2xpcGJvYXJkID0gWmVyb0NsaXBib2FyZDtcbiAgfVxufSkoZnVuY3Rpb24oKSB7XG4gIHJldHVybiB0aGlzIHx8IHdpbmRvdztcbn0oKSk7IiwiLypqc2xpbnQgYnJvd3NlcjogdHJ1ZSovXHJcbi8qanNoaW50IC1XMDU1ICovXHJcbi8qZ2xvYmFsIGNvbnNvbGUsIGFsZXJ0Ki9cclxuXHJcbi8qXHJcbiAqIEZvciBlYWNoIGRpc2Vhc2UgYXJlYSB0aGVyZSB3aWxsIGJlIDQgc3RhZ2VzOiBEaWFnbm9zaXMsIE1vbml0b3JpbmcsIFRyZWF0bWVudCBhbmQgRXhjbHVzaW9ucy5cclxuICogRWFjaCBzdGFnZSBnZXRzIGEgc2luZ2xlIHBhbmVsIG9uIHRoZSBmcm9udCBzY3JlZW4uXHJcbiAqIENsaWNraW5nIG9uIGEgcGFuZWwgdGFrZXMgeW91IHRvIGEgc2NyZWVuIHNwZWNpZmljIHRvIHRoYXQgc3RhZ2UsIGJ1dCBzaW1pbGFyIGluIGxheW91dCBhbmQgY29udGVudFxyXG4gKiAgdG8gYWxsIHRoZSBvdGhlcnMuXHJcbiAqL1xyXG5cclxudmFyIHRlbXBsYXRlID0gcmVxdWlyZSgnLi9zcmMvdGVtcGxhdGUuanMnKSxcclxuICBtYWluID0gcmVxdWlyZSgnLi9zcmMvbWFpbi5qcycpO1xyXG5cclxuLy9UT0RPIG5vdCBzdXJlIHdoeSBpIGRpZCB0aGlzIC0gd2FzIGluIGxvY2FsIHZhcmlhYmxlXHJcbi8vbWF5YmUgYSBzZXBhcmF0ZSBtb2R1bGVcclxuLy93aW5kb3cubG9jYXRpb24gPSB3aW5kb3cuaGlzdG9yeS5sb2NhdGlvbiB8fCB3aW5kb3cubG9jYXRpb247XHJcbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG4gKioqIFNob3dzIHRoZSBwcmUtbG9hZCBpbWFnZSBhbmQgc2xvd2x5IGZhZGVzIGl0IG91dC4gKioqXHJcbiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cclxuJCh3aW5kb3cpLmxvYWQoZnVuY3Rpb24oKSB7XHJcbiAgJCgnLmxvYWRpbmctY29udGFpbmVyJykuZmFkZU91dCgxMDAwLCBmdW5jdGlvbigpIHtcclxuICAgIC8vJCh0aGlzKS5yZW1vdmUoKTtcclxuICB9KTtcclxufSk7XHJcblxyXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbiAqKiogVGhpcyBoYXBwZW5zIHdoZW4gdGhlIHBhZ2UgaXMgcmVhZHkgKioqXHJcbiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXHJcbiQoZG9jdW1lbnQpLm9uKCdyZWFkeScsIGZ1bmN0aW9uKCkge1xyXG4gIC8vR3JhYiB0aGUgaGFzaCBpZiBleGlzdHMgLSBJRSBzZWVtcyB0byBmb3JnZXQgaXRcclxuICBtYWluLmhhc2ggPSBsb2NhdGlvbi5oYXNoO1xyXG5cclxuICAvL0NIQU5HRSBUSElTIC0gYWRkZWQgdG8gc3Bvb2YgbG9naW5cclxuICBsb2NhdGlvbi5oYXNoPVwiXCI7XHJcbiAgbWFpbi5oYXNoPVwiXCI7XHJcbiAgJCgnI3NpZ25pbicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCl7XHJcbiAgICBpZigkKCcjaW5wRW1haWwnKS52YWwoKS5sZW5ndGg8OCkgYWxlcnQoXCJQbGVhc2UgZW50ZXIgeW91ciBlbWFpbCBhZGRyZXNzLlwiKTtcclxuICAgIGVsc2Uge1xyXG4gICAgICBjb25zb2xlLmxvZygne1wiZXZlbnRcIjp7XCJ3aGF0XCI6XCJsb2dpblwiLFwid2hlblwiOicgKyBuZXcgRGF0ZSgpLmdldFRpbWUoKSArICcsXCJ3aG9cIjpcIicgKyAkKFwiI2lucEVtYWlsXCIpLnZhbCgpICsgJ1wifX0nKTtcclxuICAgICAgJC5hamF4KHtcclxuICAgICAgICB0eXBlOiBcIlBPU1RcIixcclxuICAgICAgICB1cmw6IFwiaHR0cDovLzEzMC44OC4yNTAuMjA2OjkxMDAvcGluZ3JcIixcclxuICAgICAgICBkYXRhOiAne1wiZXZlbnRcIjp7XCJ3aGF0XCI6XCJsb2dpblwiLFwid2hlblwiOicgKyBuZXcgRGF0ZSgpLmdldFRpbWUoKSArICcsXCJ3aG9cIjpcIicgKyAkKFwiI2lucEVtYWlsXCIpLnZhbCgpICsgJ1wifX0nLFxyXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKGQpe2NvbnNvbGUubG9nKGQpO30sXHJcbiAgICAgICAgZGF0YVR5cGU6IFwianNvblwiLFxyXG4gICAgICAgIGNvbnRlbnRUeXBlOlwiYXBwbGljYXRpb24vanNvblwiXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgdmFyIG9iaiA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmJiKTtcclxuICAgICAgb2JqLmVtYWlsPSQoJyNpbnBFbWFpbCcpLnZhbCgpO1xyXG4gICAgICBsb2NhbFN0b3JhZ2UuYmIgPSBKU09OLnN0cmluZ2lmeShvYmopO1xyXG5cclxuXHJcbiAgICAgIGhpc3RvcnkucHVzaFN0YXRlKG51bGwsIG51bGwsICcjb3ZlcnZpZXcnKTtcclxuICAgICAgdGVtcGxhdGUubG9hZENvbnRlbnQoJyNvdmVydmlldycpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG4gICQoJyNpbnBFbWFpbCcpLm9uKCdrZXl1cCcsIGZ1bmN0aW9uKCl7XHJcbiAgICB2YXIgY29kZSA9IGUud2hpY2g7XHJcbiAgICBpZihjb2RlPT0xMyl7XHJcbiAgICAgICQoJyNzaWduaW4nKS5jbGljaygpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICAvL0xvYWQgdGhlIGRhdGEgdGhlbiB3aXJlIHVwIHRoZSBldmVudHMgb24gdGhlIHBhZ2VcclxuICBtYWluLmluaXQoKTtcclxuXHJcbiAgLy9Tb3J0cyBvdXQgdGhlIGRhdGEgaGVsZCBsb2NhbGx5IGluIHRoZSB1c2VyJ3MgYnJvd3NlclxyXG4gIGlmICghbG9jYWxTdG9yYWdlLmJiKSBsb2NhbFN0b3JhZ2UuYmIgPSBKU09OLnN0cmluZ2lmeSh7fSk7XHJcbiAgdmFyIG9iaiA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmJiKTtcclxuICBpZiAoIW9iai52ZXJzaW9uIHx8IG9iai52ZXJzaW9uICE9PSBtYWluLnZlcnNpb24pIHtcclxuICAgIGxvY2FsU3RvcmFnZS5iYiA9IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgXCJ2ZXJzaW9uXCI6IG1haW4udmVyc2lvblxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBpZihKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5iYikuZW1haWwpIHtcclxuICAgICQoJyNpbnBFbWFpbCcpLnZhbChKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5iYikuZW1haWwpO1xyXG4gIH1cclxuXHJcbiAgJCgnW2RhdGEtdG9nZ2xlPVwidG9vbHRpcFwiXScpLnRvb2x0aXAoe1xyXG4gICAgY29udGFpbmVyOiAnYm9keScsXHJcbiAgICBkZWxheToge1xyXG4gICAgICBcInNob3dcIjogNTAwLFxyXG4gICAgICBcImhpZGVcIjogMTAwXHJcbiAgICB9LFxyXG4gICAgaHRtbDogdHJ1ZVxyXG4gIH0pO1xyXG4gICQoJ1tkYXRhLXRvZ2dsZT1cImxvbmUtdG9vbHRpcFwiXScpLnRvb2x0aXAoe1xyXG4gICAgY29udGFpbmVyOiAnYm9keScsXHJcbiAgICBkZWxheToge1xyXG4gICAgICBcInNob3dcIjogMzAwLFxyXG4gICAgICBcImhpZGVcIjogMTAwXHJcbiAgICB9XHJcbiAgfSk7XHJcbiAgJCgnW2RhdGEtdG9nZ2xlPVwibG9uZS10b29sdGlwXCJdJykub24oJ3Nob3duLmJzLnRvb2x0aXAnLCBmdW5jdGlvbihlKSB7XHJcbiAgICAkKCdbZGF0YS10b2dnbGU9XCJ0b29sdGlwXCJdJykubm90KHRoaXMpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICB9KTtcclxuXHJcbiAgLy9lbnN1cmUgb24gZmlyc3QgbG9hZCB0aGUgbG9naW4gc2NyZWVuIGlzIGNhY2hlZCB0byB0aGUgaGlzdG9yeVxyXG4gIGhpc3RvcnkucHVzaFN0YXRlKG51bGwsIG51bGwsICcnKTtcclxufSk7XHJcbiIsInZhciBkYXRhID0gcmVxdWlyZSgnLi9kYXRhLmpzJyksXHJcbiAgbG9va3VwID0gcmVxdWlyZSgnLi9sb29rdXAuanMnKSxcclxuICBjaGFydCA9IHJlcXVpcmUoJy4vY2hhcnQuanMnKSxcclxuICBsb2cgPSByZXF1aXJlKCcuL2xvZy5qcycpLFxyXG4gIE11c3RhY2hlID0gcmVxdWlyZSgnbXVzdGFjaGUnKSxcclxuICBaZXJvQ2xpcGJvYXJkID0gcmVxdWlyZSgnemVyb2NsaXBib2FyZCcpO1xyXG5cclxudmFyIGJhc2UgPSB7XHJcblxyXG4gIC8vb2JqZWN0IGZvciBrZWVwaW5nIHRyYWNrIHdoYXQgaXMgaW4gZWFjaCBwYW5lbCB0byBwcmV2ZW50IHVubmVjZXNzYXJ5IHJlZHJhd3NcclxuICBwYW5lbHM6IHt9LFxyXG5cclxuICBzZWxlY3RUYWI6IGZ1bmN0aW9uKGlkKSB7XHJcbiAgICB2YXIgaHJlZiA9ICQoJyNtYWluVGFiIGxpLmFjdGl2ZSBhJykuZGF0YShcImhyZWZcIik7XHJcbiAgICAkKCcjbWFpblRhYiBsaS5hY3RpdmUnKS5yZW1vdmVDbGFzcygnYWN0aXZlJykuZmluZCgnYScpLmF0dHIoXCJocmVmXCIsIGhyZWYpO1xyXG4gICAgJCgnI21haW5UYWIgbGlbZGF0YS1pZD1cIicgKyBpZCArICdcIl0nKS5hZGRDbGFzcygnYWN0aXZlJykuZmluZCgnYScpLnJlbW92ZUF0dHIoXCJocmVmXCIpO1xyXG4gIH0sXHJcblxyXG4gIGNyZWF0ZVBhbmVsOiBmdW5jdGlvbih0ZW1wbGF0ZVNlbGVjdG9yLCBkYXRhLCB0ZW1wbGF0ZXMpIHtcclxuICAgIHZhciB0ZW1wTXVzdCA9IHRlbXBsYXRlU2VsZWN0b3IuaHRtbCgpO1xyXG4gICAgTXVzdGFjaGUucGFyc2UodGVtcE11c3QpOyAvLyBvcHRpb25hbCwgc3BlZWRzIHVwIGZ1dHVyZSB1c2VzXHJcbiAgICBpZiAodGVtcGxhdGVzKSB7XHJcbiAgICAgIGZvciAodmFyIG8gaW4gdGVtcGxhdGVzKSB7XHJcbiAgICAgICAgaWYgKHRlbXBsYXRlcy5oYXNPd25Qcm9wZXJ0eShvKSkge1xyXG4gICAgICAgICAgTXVzdGFjaGUucGFyc2UodGVtcGxhdGVzW29dKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHZhciByZW5kZXJlZCA9IE11c3RhY2hlLnJlbmRlcih0ZW1wTXVzdCwgZGF0YSwgdGVtcGxhdGVzKTtcclxuICAgIHJldHVybiByZW5kZXJlZDtcclxuICB9LFxyXG5cclxuICBjcmVhdGVQYW5lbFNob3c6IGZ1bmN0aW9uKHRlbXBsYXRlU2VsZWN0b3IsIHBhbmVsU2VsZWN0b3IsIGRhdGEsIHRlbXBsYXRlcykge1xyXG4gICAgdmFyIHJlbmRlcmVkID0gYmFzZS5jcmVhdGVQYW5lbCh0ZW1wbGF0ZVNlbGVjdG9yLCBkYXRhLCB0ZW1wbGF0ZXMpO1xyXG4gICAgcGFuZWxTZWxlY3Rvci5odG1sKHJlbmRlcmVkKS5zaG93KCk7XHJcbiAgfSxcclxuXHJcbiAgc2hvd1BhdGh3YXlTdGFnZU92ZXJ2aWV3UGFuZWw6IGZ1bmN0aW9uKGxvY2F0aW9uLCBlbmFibGVIb3ZlciwgcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UpIHtcclxuICAgIHZhciBzdGFuZGFyZHMgPSBbXTtcclxuICAgIGZvciAodmFyIHN0YW5kYXJkIGluIGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkcykge1xyXG4gICAgICB2YXIgZGVub20gPSBkYXRhLmdldERlbm9taW5hdG9yRm9yU3RhbmRhcmQocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UpO1xyXG4gICAgICB2YXIgbnVtID0gZGVub20gLSBkYXRhLmdldE51bWVyYXRvckZvclN0YW5kYXJkKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCk7XHJcbiAgICAgIHN0YW5kYXJkcy5wdXNoKHtcclxuICAgICAgICBcInN0YW5kYXJkXCI6IGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0udGFiLnRpdGxlLFxyXG4gICAgICAgIFwic3RhbmRhcmRLZXlcIjogc3RhbmRhcmQsXHJcbiAgICAgICAgXCJ0b29sdGlwXCI6IGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF1bXCJzdGFuZGFyZC1tZXQtdG9vbHRpcFwiXSxcclxuICAgICAgICBcIm51bWVyYXRvclwiOiBudW0sXHJcbiAgICAgICAgXCJkZW5vbWluYXRvclwiOiBkZW5vbSxcclxuICAgICAgICBcInBlcmNlbnRhZ2VcIjogKG51bSAqIDEwMCAvIGRlbm9tKS50b0ZpeGVkKDApXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGJhc2UuY3JlYXRlUGFuZWxTaG93KCQoJyNwYXRod2F5LXN0YWdlLW92ZXJ2aWV3LXBhbmVsJyksIGxvY2F0aW9uLCB7XHJcbiAgICAgIHBhdGh3YXk6IGRhdGEucGF0aHdheU5hbWVzW3BhdGh3YXlJZF0sXHJcbiAgICAgIHBhdGh3YXlTdGFnZTogcGF0aHdheVN0YWdlLFxyXG4gICAgICBwYXRod2F5U3RhZ2VOYW1lOiBsb29rdXAuY2F0ZWdvcmllc1twYXRod2F5U3RhZ2VdLmRpc3BsYXksXHJcbiAgICAgIHBhdGh3YXlOYW1lU2hvcnQ6IHBhdGh3YXlJZCxcclxuICAgICAgdGl0bGU6IGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnRleHQucGFuZWwudGV4dCxcclxuICAgICAgc3RhbmRhcmRzOiBzdGFuZGFyZHNcclxuICAgIH0sIHtcclxuICAgICAgXCJyb3dcIjogJCgnI292ZXJ2aWV3LXBhbmVsLXRhYmxlLXJvdycpLmh0bWwoKVxyXG4gICAgfSk7XHJcblxyXG4gICAgJCgnIycgKyBwYXRod2F5U3RhZ2UgKyAnLXRyZW5kLXRvZ2dsZScpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgaWYgKCQodGhpcykudGV4dCgpID09PSBcIlRyZW5kXCIpIHtcclxuICAgICAgICAkKHRoaXMpLnRleHQoXCJUYWJsZVwiKTtcclxuICAgICAgICAkKCcjJyArIHBhdGh3YXlTdGFnZSArICctY2hhcnQtdGFibGUnKS5oaWRlKCk7XHJcbiAgICAgICAgJCgnIycgKyBwYXRod2F5U3RhZ2UgKyAnLWNoYXJ0LXdyYXBwZXInKS5zaG93KCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgJCh0aGlzKS50ZXh0KFwiVHJlbmRcIik7XHJcbiAgICAgICAgJCgnIycgKyBwYXRod2F5U3RhZ2UgKyAnLWNoYXJ0LXRhYmxlJykuc2hvdygpO1xyXG4gICAgICAgICQoJyMnICsgcGF0aHdheVN0YWdlICsgJy1jaGFydC13cmFwcGVyJykuaGlkZSgpO1xyXG4gICAgICB9XHJcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBjaGFydC5kcmF3T3ZlcnZpZXdDaGFydChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgZW5hYmxlSG92ZXIpO1xyXG5cclxuICB9LFxyXG5cclxuICBoaWRlRm9vdGVyOiBmdW5jdGlvbigpIHtcclxuICAgICQoJ2Zvb3RlcicpLmhpZGUoKTtcclxuICB9LFxyXG5cclxuICBzaG93Rm9vdGVyOiBmdW5jdGlvbigpIHtcclxuICAgICQoJ2Zvb3RlcicpLnNob3coKTtcclxuICB9LFxyXG5cclxuICBoaWRlVG9vbHRpcHM6IGZ1bmN0aW9uKCkge1xyXG4gICAgJCgnW2RhdGEtdG9nZ2xlPVwidG9vbHRpcFwiXScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICB9LFxyXG5cclxuICB3aXJlVXBUb29sdGlwczogZnVuY3Rpb24oKSB7XHJcbiAgICAkKCdbZGF0YS10b2dnbGU9XCJ0b29sdGlwXCJdJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgJCgnLnRvb2x0aXAnKS5yZW1vdmUoKTtcclxuXHJcbiAgICAkKCdbZGF0YS10b2dnbGU9XCJ0b29sdGlwXCJdJykudG9vbHRpcCh7XHJcbiAgICAgIGNvbnRhaW5lcjogJ2JvZHknLFxyXG4gICAgICBkZWxheToge1xyXG4gICAgICAgIFwic2hvd1wiOiA1MDAsXHJcbiAgICAgICAgXCJoaWRlXCI6IDEwMFxyXG4gICAgICB9LFxyXG4gICAgICBodG1sOiB0cnVlXHJcbiAgICB9KTtcclxuICAgICQoJ1tkYXRhLXRvZ2dsZT1cImxvbmUtdG9vbHRpcFwiXScpLnRvb2x0aXAoe1xyXG4gICAgICBjb250YWluZXI6ICdib2R5JyxcclxuICAgICAgZGVsYXk6IHtcclxuICAgICAgICBcInNob3dcIjogMzAwLFxyXG4gICAgICAgIFwiaGlkZVwiOiAxMDBcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICAkKCdbZGF0YS10b2dnbGU9XCJsb25lLXRvb2x0aXBcIl0nKS5vbignc2hvd24uYnMudG9vbHRpcCcsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgJCgnW2RhdGEtdG9nZ2xlPVwidG9vbHRpcFwiXScpLm5vdCh0aGlzKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICB9KTtcclxuICAgICQoJy5wYXRpZW50LXJvdy10b29sdGlwJykub24oJ3Nob3cuYnMudG9vbHRpcCcsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgaWYgKCQodGhpcykuaGFzQ2xhc3MoJ2hpZ2hsaWdodGVkJykpIHtcclxuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfSxcclxuXHJcbiAgc2V0dXBDbGlwYm9hcmQ6IGZ1bmN0aW9uKHNlbGVjdG9yLCBkZXN0cm95KSB7XHJcbiAgICBpZiAoZGVzdHJveSkgWmVyb0NsaXBib2FyZC5kZXN0cm95KCk7IC8vdGlkeSB1cFxyXG5cclxuICAgIHZhciBjbGllbnQgPSBuZXcgWmVyb0NsaXBib2FyZChzZWxlY3Rvcik7XHJcblxyXG4gICAgY2xpZW50Lm9uKCdyZWFkeScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICBjbGllbnQub24oJ2FmdGVyY29weScsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ0NvcGllZCB0ZXh0IHRvIGNsaXBib2FyZDogJyArIGV2ZW50LmRhdGFbJ3RleHQvcGxhaW4nXSk7XHJcbiAgICAgICAgJChldmVudC50YXJnZXQpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgICAkKGV2ZW50LnRhcmdldCkucG9wb3Zlcih7XHJcbiAgICAgICAgICB0cmlnZ2VyOiAnbWFudWFsJyxcclxuICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiBjbGFzcz1cInBvcG92ZXJcIiByb2xlPVwidG9vbHRpcFwiPjxkaXYgY2xhc3M9XCJhcnJvd1wiPjwvZGl2PjxkaXYgY2xhc3M9XCJwb3BvdmVyLWNvbnRlbnRcIj48L2Rpdj48L2Rpdj4nLFxyXG4gICAgICAgICAgZGVsYXk6IHtcclxuICAgICAgICAgICAgc2hvdzogNTAwLFxyXG4gICAgICAgICAgICBoaWRlOiA1MDBcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBjbGVhclRpbWVvdXQobG9va3VwLnRtcCk7XHJcbiAgICAgICAgJChldmVudC50YXJnZXQpLnBvcG92ZXIoJ3Nob3cnKTtcclxuICAgICAgICBsb29rdXAudG1wID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICQoZXZlbnQudGFyZ2V0KS5wb3BvdmVyKCdoaWRlJyk7XHJcbiAgICAgICAgfSwgNjAwKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICBjbGVhckJveDogZnVuY3Rpb24oKSB7XHJcbiAgICAvL0NsZWFyIHRoZSBwYXRpZW50IHNlYXJjaCBib3hcclxuICAgICQoJy50eXBlYWhlYWQnKS50eXBlYWhlYWQoJ3ZhbCcsICcnKTtcclxuICB9LFxyXG5cclxuICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuICAgKiBNb2RhbHNcclxuICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXHJcblxyXG4gIGxhdW5jaE1vZGFsOiBmdW5jdGlvbihkYXRhLCBsYWJlbCwgdmFsdWUsIHJlYXNvblRleHQsIGNhbGxiYWNrT25TYXZlLCBjYWxsYmFja09uQ2FuY2VsLCBjYWxsYmFja09uVW5kbykge1xyXG4gICAgdmFyIHRlbXBsYXRlID0gJCgnI21vZGFsLXdoeScpLmh0bWwoKTtcclxuICAgIE11c3RhY2hlLnBhcnNlKHRlbXBsYXRlKTsgLy8gb3B0aW9uYWwsIHNwZWVkcyB1cCBmdXR1cmUgdXNlc1xyXG5cclxuICAgIHZhciByZWFzb25UZW1wbGF0ZSA9ICQoJyNtb2RhbC13aHktaXRlbScpLmh0bWwoKTtcclxuICAgIE11c3RhY2hlLnBhcnNlKHJlYXNvblRlbXBsYXRlKTtcclxuXHJcbiAgICBpZiAoZGF0YS5yZWFzb25zICYmIGRhdGEucmVhc29ucy5sZW5ndGggPiAwKSBkYXRhLmhhc1JlYXNvbnMgPSB0cnVlO1xyXG5cclxuICAgIHZhciByZW5kZXJlZCA9IE11c3RhY2hlLnJlbmRlcih0ZW1wbGF0ZSwgZGF0YSwge1xyXG4gICAgICBcIml0ZW1cIjogcmVhc29uVGVtcGxhdGVcclxuICAgIH0pO1xyXG4gICAgJCgnI21vZGFsJykuaHRtbChyZW5kZXJlZCk7XHJcblxyXG4gICAgaWYgKHJlYXNvblRleHQpIHtcclxuICAgICAgJCgnI21vZGFsIHRleHRhcmVhJykudmFsKHJlYXNvblRleHQpO1xyXG4gICAgfVxyXG4gICAgbG9va3VwLm1vZGFsU2F2ZWQgPSBmYWxzZTtcclxuICAgIGxvb2t1cC5tb2RhbFVuZG8gPSBmYWxzZTtcclxuXHJcbiAgICAkKCcjbW9kYWwgLm1vZGFsJykub2ZmKCdjbGljaycsICcudW5kby1wbGFuJykub24oJ2NsaWNrJywgJy51bmRvLXBsYW4nLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIGxvb2t1cC5tb2RhbFVuZG8gPSB0cnVlO1xyXG4gICAgfSkub2ZmKCdzdWJtaXQnLCAnZm9ybScpLm9uKCdzdWJtaXQnLCAnZm9ybScsIHtcclxuICAgICAgXCJsYWJlbFwiOiBsYWJlbFxyXG4gICAgfSwgZnVuY3Rpb24oZSkge1xyXG4gICAgICBpZiAoIWUuZGF0YS5sYWJlbCkgZS5kYXRhLmxhYmVsID0gXCJ0ZWFtXCI7XHJcbiAgICAgIHZhciByZWFzb24gPSAkKCdpbnB1dDpyYWRpb1tuYW1lPXJlYXNvbl06Y2hlY2tlZCcpLnZhbCgpO1xyXG4gICAgICB2YXIgcmVhc29uVGV4dCA9ICQoJyNtb2RhbCB0ZXh0YXJlYScpLnZhbCgpO1xyXG5cclxuICAgICAgbG9nLnJlY29yZEZlZWRiYWNrKGRhdGEucGF0aHdheUlkLCBlLmRhdGEubGFiZWwsIHZhbHVlLCByZWFzb24sIHJlYXNvblRleHQpO1xyXG5cclxuICAgICAgbG9va3VwLm1vZGFsU2F2ZWQgPSB0cnVlO1xyXG5cclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAkKCcjbW9kYWwgLm1vZGFsJykubW9kYWwoJ2hpZGUnKTtcclxuICAgIH0pLm1vZGFsKCk7XHJcblxyXG4gICAgJCgnI21vZGFsJykub2ZmKCdoaWRkZW4uYnMubW9kYWwnKS5vbignaGlkZGVuLmJzLm1vZGFsJywge1xyXG4gICAgICBcImxhYmVsXCI6IGxhYmVsXHJcbiAgICB9LCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIGlmIChsb29rdXAubW9kYWxTYXZlZCkge1xyXG4gICAgICAgIGxvb2t1cC5tb2RhbFNhdmVkID0gZmFsc2U7XHJcbiAgICAgICAgaWYgKGNhbGxiYWNrT25TYXZlKSBjYWxsYmFja09uU2F2ZSgpO1xyXG4gICAgICB9IGVsc2UgaWYgKGxvb2t1cC5tb2RhbFVuZG8pIHtcclxuICAgICAgICBsb29rdXAubW9kYWxVbmRvID0gZmFsc2U7XHJcbiAgICAgICAgaWYgKGNhbGxiYWNrT25VbmRvKSBjYWxsYmFja09uVW5kbygpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vdW5jaGVjayBhcyBjYW5jZWxsZWQuIC0gYnV0IG5vdCBpZiB2YWx1ZSBpcyBlbXB0eSBhcyB0aGlzIHVuY2hlY2tzIGV2ZXJ5dGhpbmcgLSBvciBpZiBhbHJlYWR5IGNoZWNrZWRcclxuICAgICAgICBpZiAoY2FsbGJhY2tPbkNhbmNlbCkgY2FsbGJhY2tPbkNhbmNlbCgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICBzb3J0U3VnZ2VzdGlvbnM6IGZ1bmN0aW9uKHN1Z2dlc3Rpb25zKSB7XHJcbiAgICBzdWdnZXN0aW9ucy5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcclxuICAgICAgaWYgKGEuYWdyZWUgJiYgIWEuZG9uZSkge1xyXG4gICAgICAgIGlmIChiLmFncmVlICYmICFiLmRvbmUpIHJldHVybiAwO1xyXG4gICAgICAgIHJldHVybiAtMTtcclxuICAgICAgfSBlbHNlIGlmICghYS5hZ3JlZSAmJiAhYS5kaXNhZ3JlZSkge1xyXG4gICAgICAgIGlmICghYi5hZ3JlZSAmJiAhYi5kaXNhZ3JlZSkgcmV0dXJuIDA7XHJcbiAgICAgICAgaWYgKGIuYWdyZWUgJiYgIWIuZG9uZSkgcmV0dXJuIDE7XHJcbiAgICAgICAgcmV0dXJuIC0xO1xyXG4gICAgICB9IGVsc2UgaWYgKGEuYWdyZWUgJiYgYS5kb25lKSB7XHJcbiAgICAgICAgaWYgKGIuYWdyZWUgJiYgYi5kb25lKSByZXR1cm4gMDtcclxuICAgICAgICBpZiAoYi5kaXNhZ3JlZSkgcmV0dXJuIC0xO1xyXG4gICAgICAgIHJldHVybiAxO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGlmIChiLmRpc2FncmVlKSByZXR1cm4gMDtcclxuICAgICAgICByZXR1cm4gMTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIHN1Z2dlc3Rpb25zO1xyXG4gIH0sXHJcblxyXG4gIGFkZERpc2FncmVlUGVyc29uYWxUZWFtOiBmdW5jdGlvbihwbGFucykge1xyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwbGFucy5sZW5ndGg7IGkrKykge1xyXG4gICAgICBpZiAocGxhbnNbaV0uYWdyZWUpIHtcclxuICAgICAgICBwbGFuc1tpXS5kaXNhZ3JlZSA9IGZhbHNlO1xyXG4gICAgICB9IGVsc2UgaWYgKHBsYW5zW2ldLmFncmVlID09PSBmYWxzZSkge1xyXG4gICAgICAgIHBsYW5zW2ldLmRpc2FncmVlID0gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHBsYW5zO1xyXG4gIH0sXHJcblxyXG4gIHN1Z2dlc3Rpb25MaXN0OiBmdW5jdGlvbihpZHMpIHtcclxuICAgIHJldHVybiBpZHMubWFwKGZ1bmN0aW9uKHZhbCkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIFwiaWRcIjogdmFsLmlkIHx8IHZhbCxcclxuICAgICAgICBcInRleHRcIjogbG9nLnRleHRbdmFsLmlkIHx8IHZhbF0udGV4dCxcclxuICAgICAgICBcInN1YnNlY3Rpb25cIjogdmFsLnN1YnNlY3Rpb25cclxuICAgICAgfTtcclxuICAgIH0pLmZpbHRlcihmdW5jdGlvbih2LCBpKSB7IC8vUlcgdG8gYWx3YXlzIGxpbWl0IHRvIDNcclxuICAgICAgcmV0dXJuIGkgPCAzO1xyXG4gICAgfSk7XHJcbiAgfSxcclxuXHJcbiAgbWVyZ2VJbmRpdmlkdWFsU3R1ZmY6IGZ1bmN0aW9uKHN1Z2dlc3Rpb25zLCBwYXRpZW50SWQpIHtcclxuICAgIHZhciBsb2NhbEFjdGlvbnMgPSBsb2cubGlzdEFjdGlvbnMoKTtcclxuICAgIGlmICghbG9jYWxBY3Rpb25zW3BhdGllbnRJZF0pIHJldHVybiBzdWdnZXN0aW9ucztcclxuXHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN1Z2dlc3Rpb25zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIGlmIChsb2NhbEFjdGlvbnNbcGF0aWVudElkXVtzdWdnZXN0aW9uc1tpXS5pZF0pIHtcclxuICAgICAgICBpZiAobG9jYWxBY3Rpb25zW3BhdGllbnRJZF1bc3VnZ2VzdGlvbnNbaV0uaWRdLmFncmVlKSB7XHJcbiAgICAgICAgICBzdWdnZXN0aW9uc1tpXS5hZ3JlZSA9IHRydWU7XHJcbiAgICAgICAgfSBlbHNlIGlmIChsb2NhbEFjdGlvbnNbcGF0aWVudElkXVtzdWdnZXN0aW9uc1tpXS5pZF0uYWdyZWUgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgICBzdWdnZXN0aW9uc1tpXS5kaXNhZ3JlZSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChsb2NhbEFjdGlvbnNbcGF0aWVudElkXVtzdWdnZXN0aW9uc1tpXS5pZF0uZG9uZSkgc3VnZ2VzdGlvbnNbaV0uZG9uZSA9IGxvY2FsQWN0aW9uc1twYXRpZW50SWRdW3N1Z2dlc3Rpb25zW2ldLmlkXS5kb25lO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gc3VnZ2VzdGlvbnM7XHJcbiAgfSxcclxuXHJcbiAgc3dpdGNoVG8xMTBMYXlvdXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgaWYgKGJhc2UubGF5b3V0ID09PSBcIjExMFwiKSByZXR1cm47XHJcbiAgICBiYXNlLmxheW91dCA9IFwiMTEwXCI7XHJcbiAgICBmYXJMZWZ0UGFuZWwucmVtb3ZlQ2xhc3MoJ2NvbC1sZy0zIGNvbC1sZy04JykuYWRkQ2xhc3MoJ2NvbC1sZy02Jykuc2hvdygpO1xyXG4gICAgdG9wUGFuZWwuaGlkZSgpO1xyXG4gICAgdG9wTGVmdFBhbmVsLmhpZGUoKTtcclxuICAgIGJvdHRvbUxlZnRQYW5lbC5oaWRlKCk7XHJcbiAgICB0b3BSaWdodFBhbmVsLmhpZGUoKTtcclxuICAgIGJvdHRvbVJpZ2h0UGFuZWwuaGlkZSgpO1xyXG4gICAgbWlkUGFuZWwuaGlkZSgpO1xyXG4gICAgZmFyUmlnaHRQYW5lbC5yZW1vdmVDbGFzcygnY29sLXhsLTQnKS5hZGRDbGFzcygnY29sLXhsLTgnKS5zaG93KCk7XHJcbiAgfSxcclxuXHJcbiAgc3dpdGNoVG8xMDFMYXlvdXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgaWYgKGJhc2UubGF5b3V0ID09PSBcIjEwMVwiKSByZXR1cm47XHJcbiAgICBiYXNlLmxheW91dCA9IFwiMTAxXCI7XHJcbiAgICBmYXJMZWZ0UGFuZWwucmVtb3ZlQ2xhc3MoJ2NvbC1sZy0zIGNvbC1sZy02IGNvbC14bC00JykuYWRkQ2xhc3MoJ2NvbC1sZy04Jykuc2hvdygpO1xyXG4gICAgdG9wUGFuZWwuaGlkZSgpO1xyXG4gICAgdG9wTGVmdFBhbmVsLmhpZGUoKTtcclxuICAgIGJvdHRvbUxlZnRQYW5lbC5oaWRlKCk7XHJcbiAgICB0b3BSaWdodFBhbmVsLmhpZGUoKTtcclxuICAgIGJvdHRvbVJpZ2h0UGFuZWwuaGlkZSgpO1xyXG4gICAgbWlkUGFuZWwuaGlkZSgpO1xyXG4gICAgZmFyUmlnaHRQYW5lbC5yZW1vdmVDbGFzcygnY29sLXhsLTgnKS5hZGRDbGFzcygnY29sLXhsLTQnKS5zaG93KCk7XHJcbiAgfSxcclxuXHJcblxyXG5cclxuICBzd2l0Y2hUbzIyMUxheW91dDogZnVuY3Rpb24oKSB7XHJcbiAgICBpZiAoYmFzZS5sYXlvdXQgPT09IFwiMjIxXCIpIHJldHVybjtcclxuICAgIGJhc2UubGF5b3V0ID0gXCIyMjFcIjtcclxuICAgIGZhckxlZnRQYW5lbC5oaWRlKCk7XHJcbiAgICB0b3BQYW5lbC5oaWRlKCk7XHJcbiAgICB0b3BMZWZ0UGFuZWwuYWRkQ2xhc3MoJ2NvbC14bC02Jykuc2hvdygpO1xyXG4gICAgYm90dG9tTGVmdFBhbmVsLmFkZENsYXNzKCdjb2wteGwtNicpLnNob3coKTtcclxuICAgIHRvcFJpZ2h0UGFuZWwucmVtb3ZlQ2xhc3MoJ2NvbC14bC0xMicpLmFkZENsYXNzKCdjb2wteGwtNicpLnNob3coKTtcclxuICAgIGJvdHRvbVJpZ2h0UGFuZWwucmVtb3ZlQ2xhc3MoJ2NvbC14bC0xMicpLmFkZENsYXNzKCdjb2wteGwtNicpLnNob3coKTtcclxuICAgIG1pZFBhbmVsLnJlbW92ZUNsYXNzKCdjb2wteGwtNCcpLmFkZENsYXNzKCdjb2wteGwtOCcpLnNob3coKTtcclxuICAgIGZhclJpZ2h0UGFuZWwucmVtb3ZlQ2xhc3MoJ2NvbC14bC04JykuYWRkQ2xhc3MoJ2NvbC14bC00Jykuc2hvdygpO1xyXG4gIH0sXHJcblxyXG4gIHN3aXRjaFRvMjFMYXlvdXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgaWYgKGJhc2UubGF5b3V0ID09PSBcIjIxXCIpIHJldHVybjtcclxuICAgIGJhc2UubGF5b3V0ID0gXCIyMVwiO1xyXG4gICAgZmFyTGVmdFBhbmVsLmhpZGUoKTtcclxuICAgIHRvcFBhbmVsLmhpZGUoKTtcclxuICAgIHRvcExlZnRQYW5lbC5oaWRlKCk7XHJcbiAgICBib3R0b21MZWZ0UGFuZWwuaGlkZSgpO1xyXG4gICAgdG9wUmlnaHRQYW5lbC5yZW1vdmVDbGFzcygnY29sLXhsLTYnKS5hZGRDbGFzcygnY29sLXhsLTEyJykuc2hvdygpO1xyXG4gICAgYm90dG9tUmlnaHRQYW5lbC5yZW1vdmVDbGFzcygnY29sLXhsLTYnKS5hZGRDbGFzcygnY29sLXhsLTEyJykuc2hvdygpO1xyXG4gICAgbWlkUGFuZWwucmVtb3ZlQ2xhc3MoJ2NvbC14bC00JykuYWRkQ2xhc3MoJ2NvbC14bC04Jykuc2hvdygpO1xyXG4gICAgZmFyUmlnaHRQYW5lbC5yZW1vdmVDbGFzcygnY29sLXhsLTgnKS5hZGRDbGFzcygnY29sLXhsLTQnKS5zaG93KCk7XHJcbiAgfSxcclxuXHJcbiAgd2lyZVVwU3RhbmRhcmREcm9wRG93bjogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBjYWxsYmFjaykge1xyXG4gICAgdmFyIGJyZWFjaGVzID0gZGF0YS5vcHRpb25zLmZpbHRlcihmdW5jdGlvbih2YWwpIHtcclxuICAgICAgcmV0dXJuIHZhbC5wYXRod2F5SWQgPT09IHBhdGh3YXlJZCAmJiB2YWwucGF0aHdheVN0YWdlID09PSBwYXRod2F5U3RhZ2UgJiYgdmFsLnN0YW5kYXJkID09PSBzdGFuZGFyZDtcclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChicmVhY2hlcy5sZW5ndGggPiAwKSAkKCdzZWxlY3QnKS52YWwoYnJlYWNoZXNbMF0udmFsdWUpO1xyXG5cclxuICAgICQoJ3NlbGVjdCcpLnNlbGVjdDIoe1xyXG4gICAgICB0ZW1wbGF0ZVJlc3VsdDogYmFzZS5mb3JtYXRTdGFuZGFyZCxcclxuICAgICAgbWluaW11bVJlc3VsdHNGb3JTZWFyY2g6IEluZmluaXR5XHJcbiAgICB9KTtcclxuICAgICQoJ3NwYW4uc2VsZWN0Mi1zZWxlY3Rpb25fX3JlbmRlcmVkJykuYXR0cihcInRpdGxlXCIsIFwiXCIpO1xyXG4gICAgJCgnc2VsZWN0Jykub24oJ2NoYW5nZScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgbG9jYWxEYXRhID0gJCh0aGlzKS5maW5kKCc6c2VsZWN0ZWQnKS5kYXRhKCk7XHJcbiAgICAgIGNhbGxiYWNrKGxvY2FsRGF0YS5wYXRod2F5SWQsIGxvY2FsRGF0YS5wYXRod2F5U3RhZ2UsIGxvY2FsRGF0YS5zdGFuZGFyZCwgZGF0YS5wYXRpZW50SWQpO1xyXG4gICAgfSkub24oXCJzZWxlY3QyOm9wZW5cIiwgZnVuY3Rpb24oZSkge1xyXG4gICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICBmb3JtYXRTdGFuZGFyZDogZnVuY3Rpb24oc3RhbmRhcmQpIHtcclxuICAgIGlmICghc3RhbmRhcmQuaWQpIHtcclxuICAgICAgcmV0dXJuIHN0YW5kYXJkLnRleHQ7XHJcbiAgICB9XHJcbiAgICB2YXIgbG9jYWxEYXRhID0gJChzdGFuZGFyZC5lbGVtZW50KS5kYXRhKCk7XHJcbiAgICAvLyBOb3QgcmVsZXZhbnRcclxuICAgIHZhciBzdGFuZGFyZEh0bWwgPSAnJztcclxuICAgIC8vaWYgZGlhZ25vc2lzIG9wcG9ydHVuaXR5IHRoZW4gbm90IHJlbGV2YW50IGZvciBvdGhlciBzdGFnZXNcclxuICAgIC8vaWYgbm8gbWVudGlvbiBhbnl3aGVyZSB0aGVuIG5vdCByZWxldmFudCBmb3IgdGhhdCBkaXNlYXNlXHJcbiAgICBzd2l0Y2ggKGRhdGEuZ2V0UGF0aWVudFN0YXR1cyhkYXRhLnBhdGllbnRJZCwgbG9jYWxEYXRhLnBhdGh3YXlJZCwgbG9jYWxEYXRhLnBhdGh3YXlTdGFnZSwgbG9jYWxEYXRhLnN0YW5kYXJkKSkge1xyXG4gICAgICBjYXNlIFwib2tcIjpcclxuICAgICAgICBzdGFuZGFyZEh0bWwgPSAnPHNwYW4gY2xhc3M9XCJzdGFuZGFyZC1hY2hpZXZlZFwiIGRhdGEtdG9nZ2xlPVwidG9vbHRpcFwiIGRhdGEtcGxhY2VtZW50PVwibGVmdFwiIHRpdGxlPVwiJyArIGRhdGFbbG9jYWxEYXRhLnBhdGh3YXlJZF1bbG9jYWxEYXRhLnBhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW2xvY2FsRGF0YS5zdGFuZGFyZF1bXCJkcm9wZG93bi10b29sdGlwXCJdICsgJyAtIFFVQUxJVFkgSU5ESUNBVE9SIEFDSElFVkVEXCI+JyArIHN0YW5kYXJkLnRleHQgKyAnIDxpIGNsYXNzPVwiZmEgZmEtc21pbGUtb1wiIHN0eWxlPVwiY29sb3I6Z3JlZW5cIj48L2k+PC9zcGFuPic7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgXCJtaXNzZWRcIjpcclxuICAgICAgICBzdGFuZGFyZEh0bWwgPSAnPHNwYW4gY2xhc3M9XCJzdGFuZGFyZC1taXNzZWRcIiBkYXRhLXRvZ2dsZT1cInRvb2x0aXBcIiBkYXRhLXBsYWNlbWVudD1cImxlZnRcIiB0aXRsZT1cIicgKyBkYXRhW2xvY2FsRGF0YS5wYXRod2F5SWRdW2xvY2FsRGF0YS5wYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tsb2NhbERhdGEuc3RhbmRhcmRdW1wiZHJvcGRvd24tdG9vbHRpcFwiXSArICcgLSBJTVBST1ZFTUVOVCBPUFBPUlRVTklUWSBFWElTVFMgRk9SIFRISVMgUEFUSUVOVFwiPicgKyBzdGFuZGFyZC50ZXh0ICsgJyA8aSBjbGFzcz1cImZhIGZhLWZsYWdcIiBzdHlsZT1cImNvbG9yOnJlZFwiPjwvaT48L3NwYW4+JztcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBcIm5vdFwiOlxyXG4gICAgICAgIHN0YW5kYXJkSHRtbCA9ICc8c3BhbiBjbGFzcz1cInN0YW5kYXJkLW5vdC1yZWxldmFudFwiIGRhdGEtdG9nZ2xlPVwidG9vbHRpcFwiIGRhdGEtcGxhY2VtZW50PVwibGVmdFwiIHRpdGxlPVwiJyArIGRhdGFbbG9jYWxEYXRhLnBhdGh3YXlJZF1bbG9jYWxEYXRhLnBhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW2xvY2FsRGF0YS5zdGFuZGFyZF1bXCJkcm9wZG93bi10b29sdGlwXCJdICsgJyAtIFNUQU5EQVJEIE5PVCBSRUxFVkFOVCBUTyBUSElTIFBBVElFTlRcIj4nICsgc3RhbmRhcmQudGV4dCArICcgPGkgY2xhc3M9XCJmYSBmYS1tZWgtb1wiIHN0eWxlPVwiY29sb3I6Z3JheVwiPjwvaT48L3NwYW4+JztcclxuICAgICAgICBicmVhaztcclxuICAgIH1cclxuICAgIHZhciAkc3RhbmRhcmQgPSAkKHN0YW5kYXJkSHRtbCk7XHJcbiAgICByZXR1cm4gJHN0YW5kYXJkO1xyXG4gIH0sXHJcblxyXG4gIHVwZGF0ZVRpdGxlOiBmdW5jdGlvbih0aXRsZSl7XHJcbiAgICAkKCcjdGl0bGUtbGVmdCcpLmh0bWwodGl0bGUpO1xyXG4gICAgJCgnI3RpdGxlLXJpZ2h0JykuaHRtbChcIlwiKTtcclxuICB9LFxyXG4gIC8qdXBkYXRlVGl0bGU6IGZ1bmN0aW9uKHRpdGxlLCB0b29sdGlwKSB7XHJcbiAgICB2YXIgdGl0bGVzID0gdGl0bGU7XHJcbiAgICBpZiAodHlwZW9mIHRpdGxlID09PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgIHRpdGxlcyA9IFt7XHJcbiAgICAgICAgdGl0bGU6IHRpdGxlLFxyXG4gICAgICAgIHRvb2x0aXA6IHRvb2x0aXBcclxuICAgICAgfV07XHJcbiAgICB9XHJcbiAgICB2YXIgY29udGVudCA9IHRpdGxlcy5tYXAoZnVuY3Rpb24odCwgaWR4KSB7XHJcbiAgICAgIHJldHVybiBpZHggPT09IHRpdGxlcy5sZW5ndGggLSAxID8gJzxzcGFuIHRpdGxlPVwiJyArIHQudG9vbHRpcCArICdcIj4nICsgdC50aXRsZSArICc8L3NwYW4+JyA6ICc8YSBocmVmPVwiJyArIHQudXJsICsgJ1wiIHRpdGxlPVwiJyArIHQudG9vbHRpcCArICdcIj4nICsgdC50aXRsZSArICc8L2E+JztcclxuICAgIH0pLmpvaW4oXCIgPiBcIik7XHJcblxyXG4gICAgJCgnLnBhZ2V0aXRsZScpLmh0bWwoY29udGVudCk7XHJcbiAgfSwqL1xyXG5cclxuICBoaWRlQWxsUGFuZWxzOiBmdW5jdGlvbigpIHtcclxuICAgIHRvcExlZnRQYW5lbC5oaWRlKCk7XHJcbiAgICBib3R0b21MZWZ0UGFuZWwuaGlkZSgpO1xyXG4gICAgdG9wUmlnaHRQYW5lbC5oaWRlKCk7XHJcbiAgICBib3R0b21SaWdodFBhbmVsLmhpZGUoKTtcclxuICAgIGZhckxlZnRQYW5lbC5oaWRlKCk7XHJcbiAgICBmYXJSaWdodFBhbmVsLmhpZGUoKTtcclxuICAgIHRvcFBhbmVsLmhpZGUoKTtcclxuICB9LFxyXG5cclxuICBoaWRlUGFuZWxzOiBmdW5jdGlvbihwYW5lbCkge1xyXG4gICAgcGFuZWwuY2hpbGRyZW4oKS5oaWRlKCk7XHJcbiAgfSxcclxuXHJcbiAgdXBkYXRlVGFiOiBmdW5jdGlvbih0YWIsIHZhbHVlLCB1cmwpIHtcclxuICAgIHZhciB0YWJFbGVtZW50ID0gJCgnI21haW5UYWIgYVtkYXRhLWhyZWY9XCIjJyArIHRhYiArICdcIl0nKTtcclxuICAgIHRhYkVsZW1lbnQuaHRtbCh0YWJFbGVtZW50LnRleHQoKS5zcGxpdChcIjpcIilbMF0gKyBcIjo8YnI+PHNwYW4+PHN0cm9uZz5cIiArIHZhbHVlICsgXCI8L3N0cm9uZz48L3NwYW4+XCIpO1xyXG4gICAgdGFiRWxlbWVudC5kYXRhKFwiaHJlZlwiLCBcIiNcIiArIHRhYiArIFwiL1wiICsgdXJsKTtcclxuICB9LFxyXG5cclxuICBhZGRGdWxsUGFnZTogZnVuY3Rpb24ocGFuZWwpIHtcclxuICAgIHBhbmVsLmZ1bGxwYWdlKHsgdmVydGljYWxDZW50ZXJlZDogZmFsc2UsIHBhZGRpbmdCb3R0b206ICc4MHB4Jywgc2Nyb2xsQmFyOiB0cnVlIH0pO1xyXG5cclxuICAgICQoJy5mcC1kb3duJykub2ZmKCdjbGljaycpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAkLmZuLmZ1bGxwYWdlLm1vdmVTZWN0aW9uRG93bigpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgJCgnLmZwLXVwJykub2ZmKCdjbGljaycpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAkLmZuLmZ1bGxwYWdlLm1vdmVTZWN0aW9uVXAoKTtcclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIHJlbW92ZUZ1bGxQYWdlOiBmdW5jdGlvbihwYW5lbCkge1xyXG4gICAgaWYgKHBhbmVsLmNoaWxkcmVuKCcuc2VjdGlvbicpLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xyXG4gICAgaWYgKCQuZm4uZnVsbHBhZ2UgJiYgJC5mbi5mdWxscGFnZS5kZXN0cm95KSAkLmZuLmZ1bGxwYWdlLmRlc3Ryb3koJ2FsbCcpOyAvL3RpZHkgdXAgYmVmb3JlIGRvaW5nIGl0IGFnYWluXHJcbiAgfSxcclxuXHJcbiAgc2hvd0xvYWRpbmc6IGZ1bmN0aW9uKCl7XHJcbiAgICAkKCcubG9hZGluZy1jb250YWluZXInKS5zaG93KCk7XHJcbiAgICAkKCcjdGl0bGUtcm93JykuaGlkZSgpO1xyXG4gIH0sXHJcblxyXG4gIGhpZGVMb2FkaW5nOiBmdW5jdGlvbigpe1xyXG4gICAgJCgnLmxvYWRpbmctY29udGFpbmVyJykuZmFkZU91dCgxMDAwKTtcclxuICAgICQoJyN0aXRsZS1yb3cnKS5mYWRlSW4oMTAwMCk7XHJcbiAgfSxcclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGJhc2U7XHJcbiIsInZhciBIaWdoY2hhcnRzID0gcmVxdWlyZSgnaGlnaGNoYXJ0cy9oaWdoc3RvY2snKSxcclxuICBkYXRhID0gcmVxdWlyZSgnLi9kYXRhLmpzJyksXHJcbiAgbG9va3VwID0gcmVxdWlyZSgnLi9sb29rdXAuanMnKSxcclxuICBsb2cgPSByZXF1aXJlKCcuL2xvZy5qcycpLFxyXG4gIE11c3RhY2hlID0gcmVxdWlyZSgnbXVzdGFjaGUnKTtcclxuXHJcbmNvbnNvbGUubG9nKFwiY2hhcnQuanM6IGRhdGEubGFzdGxvYWRlcj0gXCIgKyBkYXRhLmxhc3Rsb2FkZXIpO1xyXG5kYXRhLmxhc3Rsb2FkZXIgPSBcImNoYXJ0LmpzXCI7XHJcblxyXG52YXIgY2h0ID0ge1xyXG5cclxuICBkZXN0cm95Q2hhcnRzOiBmdW5jdGlvbihjaGFydHMpIHtcclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hhcnRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIGlmIChsb29rdXAuY2hhcnRzW2NoYXJ0c1tpXV0pIHtcclxuICAgICAgICBsb29rdXAuY2hhcnRzW2NoYXJ0c1tpXV0uZGVzdHJveSgpO1xyXG4gICAgICAgIGRlbGV0ZSBsb29rdXAuY2hhcnRzW2NoYXJ0c1tpXV07XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9LFxyXG5cclxuICBkcmF3VHJlbmRDaGFydDogZnVuY3Rpb24ocGF0aWVudElkLCBwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQpIHtcclxuICAgIHZhciBpLCBqO1xyXG4gICAgY2h0LmRlc3Ryb3lDaGFydHMoWydjaGFydC1kZW1vLXRyZW5kJ10pO1xyXG4gICAgaWYgKCFkYXRhLnBhdGllbnRzW3BhdGllbnRJZF1bZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS5jaGFydFswXV0pIHtcclxuICAgICAgJCgnI2NoYXJ0LWRlbW8tdHJlbmQnKS5odG1sKCdObyBkYXRhIGZvciB0aGlzIHBhdGllbnRzJyk7XHJcbiAgICAgICQoJyNjaGFydC1kZW1vLXRyZW5kJykucGFyZW50KCkuZmluZCgnLnRhYmxlLWNoYXJ0LXRvZ2dsZScpLmhpZGUoKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIHZhciBjaGFydERhdGEgPSBkYXRhLnBhdGllbnRzW3BhdGllbnRJZF1bZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS5jaGFydFswXV07XHJcbiAgICB2YXIgdGFibGVEYXRhID0gW107XHJcbiAgICBmb3IgKGkgPSAxOyBpIDwgZGF0YS5wYXRpZW50c1twYXRpZW50SWRdW2RhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0uY2hhcnRbMF1dWzBdLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIHRhYmxlRGF0YS5wdXNoKHtcclxuICAgICAgICBcIml0ZW1cIjogZGF0YS5wYXRpZW50c1twYXRpZW50SWRdW2RhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0uY2hhcnRbMF1dWzFdWzBdLFxyXG4gICAgICAgIFwidmFsdWVcIjogZGF0YS5wYXRpZW50c1twYXRpZW50SWRdW2RhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0uY2hhcnRbMF1dWzFdW2ldLFxyXG4gICAgICAgIFwiZGF0ZVwiOiBkYXRhLnBhdGllbnRzW3BhdGllbnRJZF1bZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS5jaGFydFswXV1bMF1baV1cclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBmb3IgKGkgPSAxOyBpIDwgZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS5jaGFydC5sZW5ndGg7IGkrKykge1xyXG4gICAgICBjaGFydERhdGEucHVzaChkYXRhLnBhdGllbnRzW3BhdGllbnRJZF1bZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS5jaGFydFtpXV1bMV0pOyAvL1JXIFRPRE8gYXNzdW1wdGlvbiBoZXJlIHRoYXQgYWxsIGRhdGVzIGFyZSB0aGUgc2FtZVxyXG4gICAgICBmb3IgKGogPSAxOyBqIDwgZGF0YS5wYXRpZW50c1twYXRpZW50SWRdW2RhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0uY2hhcnRbMF1dWzBdLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgdGFibGVEYXRhLnB1c2goe1xyXG4gICAgICAgICAgXCJpdGVtXCI6IGRhdGEucGF0aWVudHNbcGF0aWVudElkXVtkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLmNoYXJ0W2ldXVsxXVswXSxcclxuICAgICAgICAgIFwidmFsdWVcIjogZGF0YS5wYXRpZW50c1twYXRpZW50SWRdW2RhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0uY2hhcnRbaV1dWzFdW2pdLFxyXG4gICAgICAgICAgXCJkYXRlXCI6IGRhdGEucGF0aWVudHNbcGF0aWVudElkXVtkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLmNoYXJ0WzBdXVswXVtqXVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICB2YXIgY2hhcnRPcHRpb25zID0ge1xyXG4gICAgICBiaW5kdG86ICcjY2hhcnQtZGVtby10cmVuZCcsXHJcbiAgICAgIGRhdGE6IHtcclxuICAgICAgICB4czoge30sXHJcbiAgICAgICAgY2xhc3Nlczoge30sXHJcbiAgICAgICAgY29sdW1uczogY2hhcnREYXRhLnNsaWNlKClcclxuICAgICAgfSxcclxuICAgICAgem9vbToge1xyXG4gICAgICAgIGVuYWJsZWQ6IHRydWVcclxuICAgICAgfSxcclxuICAgICAgbGluZToge1xyXG4gICAgICAgIGNvbm5lY3ROdWxsOiBmYWxzZVxyXG4gICAgICB9LFxyXG4gICAgICBheGlzOiB7XHJcbiAgICAgICAgeDoge1xyXG4gICAgICAgICAgdHlwZTogJ3RpbWVzZXJpZXMnLFxyXG4gICAgICAgICAgdGljazoge1xyXG4gICAgICAgICAgICBmaXQ6IGZhbHNlLFxyXG4gICAgICAgICAgICBmb3JtYXQ6ICclZC0lbS0lWScsXHJcbiAgICAgICAgICAgIGNvdW50OiA1XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgbWF4OiBuZXcgRGF0ZSgpXHJcbiAgICAgICAgfSxcclxuICAgICAgICB5OiB7XHJcbiAgICAgICAgICBsYWJlbDoge1xyXG4gICAgICAgICAgICB0ZXh0OiBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLmNoYXJ0VW5pdHMsXHJcbiAgICAgICAgICAgIHBvc2l0aW9uOiAnb3V0ZXItbWlkZGxlJ1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgbWF4VmFsdWUgPSAwO1xyXG4gICAgdmFyIHN0YW5kYXJkSXRlbXMgPSBbXTtcclxuXHJcbiAgICBmb3IgKGkgPSAxOyBpIDwgY2hhcnRPcHRpb25zLmRhdGEuY29sdW1ucy5sZW5ndGg7IGkrKykge1xyXG4gICAgICBjaGFydE9wdGlvbnMuZGF0YS54c1tjaGFydE9wdGlvbnMuZGF0YS5jb2x1bW5zW2ldWzBdXSA9IFwieFwiO1xyXG4gICAgICBzdGFuZGFyZEl0ZW1zLnB1c2goY2hhcnRPcHRpb25zLmRhdGEuY29sdW1uc1tpXVswXSk7XHJcblxyXG4gICAgICBmb3IgKGogPSAxOyBqIDwgY2hhcnRPcHRpb25zLmRhdGEuY29sdW1uc1tpXS5sZW5ndGg7IGorKykge1xyXG4gICAgICAgIGlmIChwYXJzZUZsb2F0KGNoYXJ0T3B0aW9ucy5kYXRhLmNvbHVtbnNbaV1bal0pID4gbWF4VmFsdWUpIG1heFZhbHVlID0gcGFyc2VGbG9hdChjaGFydE9wdGlvbnMuZGF0YS5jb2x1bW5zW2ldW2pdKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNoYXJ0T3B0aW9ucy50b29sdGlwID0ge1xyXG4gICAgICBmb3JtYXQ6IHtcclxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24odmFsdWUsIHJhdGlvLCBpZCkge1xyXG4gICAgICAgICAgdmFyIHRleHQgPSBzdGFuZGFyZEl0ZW1zLmluZGV4T2YoaWQpID4gLTEgPyB2YWx1ZSA6IFwiXCI7XHJcbiAgICAgICAgICByZXR1cm4gdGV4dDtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgdmFyIGxpbmVzID0gbnVsbDtcclxuICAgIHZhciBheGlzbnVtID0gMTtcclxuICAgIGlmIChkYXRhLnBhdGllbnRzW3BhdGllbnRJZF0uY29udGFjdHMpIHtcclxuICAgICAgZm9yIChpID0gMDsgaSA8IGRhdGEucGF0aWVudHNbcGF0aWVudElkXS5jb250YWN0cy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGNoYXJ0T3B0aW9ucy5kYXRhLmNsYXNzZXNbZGF0YS5wYXRpZW50c1twYXRpZW50SWRdLmNvbnRhY3RzW2ldLnRleHRdID0gJ2xhcmdlcic7XHJcbiAgICAgICAgaWYgKCFjaGFydE9wdGlvbnMuZGF0YS54c1tkYXRhLnBhdGllbnRzW3BhdGllbnRJZF0uY29udGFjdHNbaV0udGV4dF0pIHtcclxuICAgICAgICAgIGNoYXJ0T3B0aW9ucy5kYXRhLnhzW2RhdGEucGF0aWVudHNbcGF0aWVudElkXS5jb250YWN0c1tpXS50ZXh0XSA9IFwieFwiICsgYXhpc251bTtcclxuICAgICAgICAgIGNoYXJ0T3B0aW9ucy5kYXRhLmNvbHVtbnMucHVzaChbXCJ4XCIgKyBheGlzbnVtLCBkYXRhLnBhdGllbnRzW3BhdGllbnRJZF0uY29udGFjdHNbaV0udmFsdWVdKTtcclxuICAgICAgICAgIGNoYXJ0T3B0aW9ucy5kYXRhLmNvbHVtbnMucHVzaChbZGF0YS5wYXRpZW50c1twYXRpZW50SWRdLmNvbnRhY3RzW2ldLnRleHQsIChtYXhWYWx1ZSAqIDEuMSkudG9TdHJpbmcoKV0pO1xyXG4gICAgICAgICAgYXhpc251bSsrO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB2YXIgYXhpcyA9IGNoYXJ0T3B0aW9ucy5kYXRhLnhzW2RhdGEucGF0aWVudHNbcGF0aWVudElkXS5jb250YWN0c1tpXS50ZXh0XTtcclxuICAgICAgICAgIGZvciAoaiA9IDE7IGogPCBjaGFydE9wdGlvbnMuZGF0YS5jb2x1bW5zLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICAgIGlmIChjaGFydE9wdGlvbnMuZGF0YS5jb2x1bW5zW2pdWzBdID09PSBheGlzKSB7XHJcbiAgICAgICAgICAgICAgY2hhcnRPcHRpb25zLmRhdGEuY29sdW1uc1tqXS5wdXNoKGRhdGEucGF0aWVudHNbcGF0aWVudElkXS5jb250YWN0c1tpXS52YWx1ZSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoY2hhcnRPcHRpb25zLmRhdGEuY29sdW1uc1tqXVswXSA9PT0gZGF0YS5wYXRpZW50c1twYXRpZW50SWRdLmNvbnRhY3RzW2ldLnRleHQpIHtcclxuICAgICAgICAgICAgICBjaGFydE9wdGlvbnMuZGF0YS5jb2x1bW5zW2pdLnB1c2goKG1heFZhbHVlICogMS4xKS50b1N0cmluZygpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0YWJsZURhdGEucHVzaCh7XHJcbiAgICAgICAgICBcIml0ZW1cIjogXCJFdmVudFwiLFxyXG4gICAgICAgICAgXCJ2YWx1ZVwiOiBkYXRhLnBhdGllbnRzW3BhdGllbnRJZF0uY29udGFjdHNbaV0udGV4dCxcclxuICAgICAgICAgIFwiZGF0ZVwiOiBkYXRhLnBhdGllbnRzW3BhdGllbnRJZF0uY29udGFjdHNbaV0udmFsdWVcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHZhciBwYXRpZW50RXZlbnRzID0gbG9nLmdldEV2ZW50cygpLmZpbHRlcihmdW5jdGlvbih2YWwpIHtcclxuICAgICAgcmV0dXJuIHZhbC5pZCA9PT0gcGF0aWVudElkO1xyXG4gICAgfSk7XHJcbiAgICBpZiAocGF0aWVudEV2ZW50cy5sZW5ndGggPiAwKSB7XHJcblxyXG4gICAgICBmb3IgKGkgPSAwOyBpIDwgcGF0aWVudEV2ZW50cy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGNoYXJ0T3B0aW9ucy5kYXRhLmNsYXNzZXNbcGF0aWVudEV2ZW50c1tpXS5uYW1lXSA9ICdsYXJnZXInO1xyXG4gICAgICAgIGlmICghY2hhcnRPcHRpb25zLmRhdGEueHNbcGF0aWVudEV2ZW50c1tpXS5uYW1lXSkge1xyXG4gICAgICAgICAgY2hhcnRPcHRpb25zLmRhdGEueHNbcGF0aWVudEV2ZW50c1tpXS5uYW1lXSA9IFwieFwiICsgYXhpc251bTtcclxuICAgICAgICAgIGNoYXJ0T3B0aW9ucy5kYXRhLmNvbHVtbnMucHVzaChbXCJ4XCIgKyBheGlzbnVtLCBwYXRpZW50RXZlbnRzW2ldLmRhdGUuc3Vic3RyKDAsIDEwKV0pO1xyXG4gICAgICAgICAgY2hhcnRPcHRpb25zLmRhdGEuY29sdW1ucy5wdXNoKFtwYXRpZW50RXZlbnRzW2ldLm5hbWUsIChtYXhWYWx1ZSAqIDEuMSkudG9TdHJpbmcoKV0pO1xyXG4gICAgICAgICAgYXhpc251bSsrO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB2YXIgYXhpczIgPSBjaGFydE9wdGlvbnMuZGF0YS54c1twYXRpZW50RXZlbnRzW2ldLm5hbWVdO1xyXG4gICAgICAgICAgZm9yIChqID0gMTsgaiA8IGNoYXJ0T3B0aW9ucy5kYXRhLmNvbHVtbnMubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgICAgaWYgKGNoYXJ0T3B0aW9ucy5kYXRhLmNvbHVtbnNbal1bMF0gPT09IGF4aXMyKSB7XHJcbiAgICAgICAgICAgICAgY2hhcnRPcHRpb25zLmRhdGEuY29sdW1uc1tqXS5wdXNoKHBhdGllbnRFdmVudHNbaV0uZGF0ZS5zdWJzdHIoMCwgMTApKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChjaGFydE9wdGlvbnMuZGF0YS5jb2x1bW5zW2pdWzBdID09PSBwYXRpZW50RXZlbnRzW2ldLm5hbWUpIHtcclxuICAgICAgICAgICAgICBjaGFydE9wdGlvbnMuZGF0YS5jb2x1bW5zW2pdLnB1c2goKG1heFZhbHVlICogMS4xKS50b1N0cmluZygpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0YWJsZURhdGEucHVzaCh7XHJcbiAgICAgICAgICBcIml0ZW1cIjogXCJFdmVudFwiLFxyXG4gICAgICAgICAgXCJ2YWx1ZVwiOiBwYXRpZW50RXZlbnRzW2ldLm5hbWUsXHJcbiAgICAgICAgICBcImRhdGVcIjogcGF0aWVudEV2ZW50c1tpXS5kYXRlLnN1YnN0cigwLCAxMClcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHRhYmxlRGF0YS5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcclxuICAgICAgaWYgKGEuZGF0ZSA9PT0gYi5kYXRlKSByZXR1cm4gMDtcclxuICAgICAgZWxzZSByZXR1cm4gYS5kYXRlIDwgYi5kYXRlID8gMSA6IC0xO1xyXG4gICAgfSk7XHJcbiAgICAvL2RyYXcgVGFibGVcclxuICAgICQoJyN0YWJsZS1kZW1vLXRyZW5kJykuaHRtbChNdXN0YWNoZS5yZW5kZXIoJCgnI3ZhbHVlLXRyZW5kLXBhbmVsLXRhYmxlJykuaHRtbCgpLCB7XHJcbiAgICAgIFwiaXRlbXNcIjogdGFibGVEYXRhXHJcbiAgICB9LCB7XHJcbiAgICAgIFwiaXRlbS1yb3dcIjogJCgnI3ZhbHVlLXRyZW5kLXBhbmVsLXRhYmxlLXJvdycpLmh0bWwoKVxyXG4gICAgfSkpO1xyXG5cclxuICAgIC8vZHJhdyBjaGFydHMgaW4gc2VwYXJhdGUgdGhyZWFkIGFuZCB3aXRoIGRlbGF5IHRvIHN0b3Agc2x1Z2dpc2ggYXBwZWFyYW5jZVxyXG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgbG9va3VwLmNoYXJ0c1snY2hhcnQtZGVtby10cmVuZCddID0gYzMuZ2VuZXJhdGUoY2hhcnRPcHRpb25zKTtcclxuICAgIH0sIDEpO1xyXG4gIH0sXHJcblxyXG4gIHNlbGVjdFBpZVNsaWNlOiBmdW5jdGlvbihjaGFydCwgZCkge1xyXG4gICAgbG9va3VwLmNoYXJ0Q2xpY2tlZCA9IHRydWU7XHJcbiAgICAkKCcjJyArIGNoYXJ0ICsgJyBwYXRoLmMzLWJhcicpLmF0dHIoJ2NsYXNzJywgZnVuY3Rpb24oaW5kZXgsIGNsYXNzTmFtZXMpIHtcclxuICAgICAgcmV0dXJuIGNsYXNzTmFtZXMgKyAnIF91bnNlbGVjdGVkXyc7XHJcbiAgICB9KTtcclxuICAgIGxvb2t1cC5jaGFydHNbY2hhcnRdLnNlbGVjdChbZC5pZF0sIFtkLmluZGV4XSwgdHJ1ZSk7XHJcblxyXG4gICAgZmFyUmlnaHRQYW5lbC5mYWRlT3V0KDIwMCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciB0ZW1wbGF0ZSA9ICQoJyNwYXRpZW50LXBhbmVsLXBsYWNlaG9sZGVyJykuaHRtbCgpO1xyXG4gICAgICBmYXJSaWdodFBhbmVsLmh0bWwoTXVzdGFjaGUucmVuZGVyKHRlbXBsYXRlKSkuc2hvdygpO1xyXG4gICAgfSk7XHJcbiAgfSxcclxuXHJcbiAgZHJhd092ZXJ2aWV3Q2hhcnQ6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBlbmFibGVIb3Zlcikge1xyXG4gICAgY2h0LmRlc3Ryb3lDaGFydHMoW3BhdGh3YXlTdGFnZSArICctY2hhcnQnXSk7XHJcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICBsb29rdXAuY2hhcnRzW3BhdGh3YXlTdGFnZSArICctY2hhcnQnXSA9IGMzLmdlbmVyYXRlKHtcclxuICAgICAgICBiaW5kdG86ICcjJyArIHBhdGh3YXlTdGFnZSArICctY2hhcnQnLFxyXG4gICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgIHg6ICd4JyxcclxuICAgICAgICAgIGNvbHVtbnM6IGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnRyZW5kXHJcbiAgICAgICAgfSxcclxuICAgICAgICB6b29tOiB7XHJcbiAgICAgICAgICBlbmFibGVkOiB0cnVlXHJcbiAgICAgICAgfSxcclxuICAgICAgICB0b29sdGlwOiB7XHJcbiAgICAgICAgICBmb3JtYXQ6IHtcclxuICAgICAgICAgICAgdGl0bGU6IGZ1bmN0aW9uKHgpIHtcclxuICAgICAgICAgICAgICByZXR1cm4geC50b0RhdGVTdHJpbmcoKSArIChlbmFibGVIb3ZlciA/ICc8YnI+Q2xpY2sgZm9yIG1vcmUgZGV0YWlsJyA6ICcnKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIGVuYWJsZUhvdmVyID8gdmFsdWUgKyAnJScgOiB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIGF4aXM6IHtcclxuICAgICAgICAgIHg6IHtcclxuICAgICAgICAgICAgdHlwZTogJ3RpbWVzZXJpZXMnLFxyXG4gICAgICAgICAgICB0aWNrOiB7XHJcbiAgICAgICAgICAgICAgZm9ybWF0OiAnJWQtJW0tJVknLFxyXG4gICAgICAgICAgICAgIGNvdW50OiA3LFxyXG4gICAgICAgICAgICAgIGN1bGxpbmc6IHtcclxuICAgICAgICAgICAgICAgIG1heDogNFxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbGFiZWw6IHtcclxuICAgICAgICAgICAgICB0ZXh0OiAnRGF0ZScsXHJcbiAgICAgICAgICAgICAgcG9zaXRpb246ICdvdXRlci1jZW50ZXInXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICB5OiB7XHJcbiAgICAgICAgICAgIG1pbjogMCxcclxuICAgICAgICAgICAgbGFiZWw6IHtcclxuICAgICAgICAgICAgICB0ZXh0OiAnUHJvcG9ydGlvbiAoJSknLFxyXG4gICAgICAgICAgICAgIHBvc2l0aW9uOiAnb3V0ZXItbWlkZGxlJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBwb2ludDoge1xyXG4gICAgICAgICAgc2hvdzogZmFsc2VcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNpemU6IHtcclxuICAgICAgICAgIGhlaWdodDogbnVsbFxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9LCAxKTtcclxuICB9LFxyXG5cclxuICBkcmF3QmVuY2htYXJrQ2hhcnQ6IGZ1bmN0aW9uKGVsZW1lbnQsIGRhdGEpIHtcclxuICAgIGNodC5kZXN0cm95Q2hhcnRzKFtlbGVtZW50ICsgJy1jaGFydCddKTtcclxuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgIGxvb2t1cC5jaGFydHNbZWxlbWVudCArICctY2hhcnQnXSA9IGMzLmdlbmVyYXRlKHtcclxuICAgICAgICBiaW5kdG86ICcjJyArIGVsZW1lbnQsXHJcbiAgICAgICAgc2l6ZToge1xyXG4gICAgICAgICAgaGVpZ2h0OiAyMDBcclxuICAgICAgICB9LFxyXG4gICAgICAgIGRhdGE6IGRhdGEsXHJcbiAgICAgICAgYXhpczoge1xyXG4gICAgICAgICAgeDoge1xyXG4gICAgICAgICAgICB0eXBlOiAnY2F0ZWdvcnknLFxyXG4gICAgICAgICAgICB0aWNrOiB7XHJcbiAgICAgICAgICAgICAgcm90YXRlOiA2MCxcclxuICAgICAgICAgICAgICBtdWx0aWxpbmU6IGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICB5OiB7XHJcbiAgICAgICAgICAgIGxhYmVsOiB7XHJcbiAgICAgICAgICAgICAgdGV4dDogJyUgb2YgcGF0aWVudHMgbWVldGluZyB0aGUgdGFyZ2V0JyxcclxuICAgICAgICAgICAgICBwb3NpdGlvbjogJ291dGVyLW1pZGRsZSdcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZ3JpZDoge1xyXG4gICAgICAgICAgeToge1xyXG4gICAgICAgICAgICBzaG93OiB0cnVlXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0sIDEpO1xyXG4gIH0sXHJcblxyXG4gIGRyYXdQZXJmb3JtYW5jZVRyZW5kQ2hhcnQ6IGZ1bmN0aW9uKGVsZW1lbnQsIGRhdGEpIHtcclxuICAgIGNodC5kZXN0cm95Q2hhcnRzKFtlbGVtZW50ICsgJy1jaGFydCddKTtcclxuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgIGxvb2t1cC5jaGFydHNbZWxlbWVudCArICctY2hhcnQnXSA9IGMzLmdlbmVyYXRlKHtcclxuICAgICAgICBiaW5kdG86ICcjJyArIGVsZW1lbnQsXHJcbiAgICAgICAgc2l6ZToge1xyXG4gICAgICAgICAgaGVpZ2h0OiAyMDBcclxuICAgICAgICB9LFxyXG4gICAgICAgIGRhdGE6IGRhdGEsXHJcbiAgICAgICAgYXhpczoge1xyXG4gICAgICAgICAgeDoge1xyXG4gICAgICAgICAgICB0eXBlOiAndGltZXNlcmllcycsXHJcbiAgICAgICAgICAgIHRpY2s6IHtcclxuICAgICAgICAgICAgICBmb3JtYXQ6ICclWS0lbS0lZCcsXHJcbiAgICAgICAgICAgICAgcm90YXRlOiA2MCxcclxuICAgICAgICAgICAgICBtdWx0aWxpbmU6IGZhbHNlXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGhlaWdodDogNjBcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICB5OiB7XHJcbiAgICAgICAgICAgIGxhYmVsOiB7XHJcbiAgICAgICAgICAgICAgdGV4dDogXCJQZXJmb3JtYW5jZVwiLFxyXG4gICAgICAgICAgICAgIHBvc2l0aW9uOiAnb3V0ZXItbWlkZGxlJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBncmlkOiB7XHJcbiAgICAgICAgICB4OiB7XHJcbiAgICAgICAgICAgIHNob3c6IHRydWVcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICB5OiB7XHJcbiAgICAgICAgICAgIHNob3c6IHRydWVcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSwgMSk7XHJcbiAgfSxcclxuXHJcbiAgZHJhd0JlbmNobWFya0NoYXJ0SEM6IGZ1bmN0aW9uKGVsZW1lbnQsIGRhdGEpIHtcclxuXHJcbiAgICBkYXRhID0gW1xyXG4gICAgICB7IHg6IDQ5LjksIHA6ICdQMScsIGxvY2FsOiB0cnVlIH0sXHJcbiAgICAgIHsgeDogNzEuNSwgcDogJ1AyJywgbG9jYWw6IHRydWUgfSxcclxuICAgICAgeyB4OiAxNi40LCBwOiAnUDMnLCBsb2NhbDogdHJ1ZSB9LFxyXG4gICAgICB7IHg6IDI5LjIsIHA6ICdQNCcsIGxvY2FsOiB0cnVlIH0sXHJcbiAgICAgIHsgeDogNDQuMCwgcDogJ1A1JywgbG9jYWw6IHRydWUgfSxcclxuICAgICAgeyB4OiA3Ni4wLCBwOiAnUDYnLCBsb2NhbDogdHJ1ZSB9LFxyXG4gICAgICB7IHg6IDM1LjYsIHA6ICdZT1UnLCBsb2NhbDogdHJ1ZSB9LFxyXG4gICAgICB7IHg6IDQ4LjUsIHA6ICdQNycsIGxvY2FsOiB0cnVlIH0sXHJcbiAgICAgIHsgeDogMjYuNCwgcDogJ1A4JywgbG9jYWw6IHRydWUgfSxcclxuICAgICAgeyB4OiA5NC4xLCBwOiAnUDknLCBsb2NhbDogdHJ1ZSB9LFxyXG4gICAgICB7IHg6IDk1LjYsIHA6ICdQMTAnIH0sXHJcbiAgICAgIHsgeDogNTQuMCwgcDogJ1AxMScgfSxcclxuICAgICAgeyB4OiAzOS45LCBwOiAnUDEyJyB9LFxyXG4gICAgICB7IHg6IDYxLjUsIHA6ICdQMTMnIH0sXHJcbiAgICAgIHsgeDogNi40LCBwOiAnUDE0JyB9LFxyXG4gICAgICB7IHg6IDE5LjIsIHA6ICdQMTUnIH0sXHJcbiAgICAgIHsgeDogMzQuMCwgcDogJ1AxNicgfSxcclxuICAgICAgeyB4OiA2Ni4wLCBwOiAnUDE3JyB9LFxyXG4gICAgICB7IHg6IDI1LjYsIHA6ICdQMTgnIH0sXHJcbiAgICAgIHsgeDogMzguNSwgcDogJ1AxOScgfSxcclxuICAgICAgeyB4OiAzNi40LCBwOiAnUDIwJyB9LFxyXG4gICAgICB7IHg6IDg0LjEsIHA6ICdQMjEnIH0sXHJcbiAgICAgIHsgeDogODUuNiwgcDogJ1AyMicgfSxcclxuICAgICAgeyB4OiA2NC4wLCBwOiAnUDIzJyB9XHJcbiAgICBdO1xyXG4gICAgZGF0YS5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcclxuICAgICAgcmV0dXJuIGEueCAtIGIueDtcclxuICAgIH0pO1xyXG5cclxuICAgIHZhciBsb2NhbCA9IHRydWU7XHJcbiAgICB2YXIgYkNoYXJ0ID0gJCgnIycgKyBlbGVtZW50KS5oaWdoY2hhcnRzKHtcclxuICAgICAgICBjaGFydDoge1xyXG4gICAgICAgICAgdHlwZTogJ2NvbHVtbicsXHJcbiAgICAgICAgICBldmVudHM6IHtcclxuICAgICAgICAgICAgbG9hZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgdmFyIHRoaXNDaGFydCA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgdGhpc0NoYXJ0LnJlbmRlcmVyLmJ1dHRvbignVG9nZ2xlIG5laWdoYm91cmhvb2QgLyBDQ0cnLCB0aGlzQ2hhcnQucGxvdFdpZHRoIC0gMTAwLCAwLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGxvY2FsID0gIWxvY2FsO1xyXG4gICAgICAgICAgICAgICAgdGhpc0NoYXJ0LnhBeGlzWzBdLmNhdGVnb3JpZXMgPSBkYXRhLmZpbHRlcihmdW5jdGlvbih2KSB7XHJcbiAgICAgICAgICAgICAgICAgIGlmIChsb2NhbCkgcmV0dXJuIHYubG9jYWw7XHJcbiAgICAgICAgICAgICAgICAgIGVsc2UgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICB9KS5tYXAoZnVuY3Rpb24odikge1xyXG4gICAgICAgICAgICAgICAgICByZXR1cm4gdi5wO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzQ2hhcnQuc2VyaWVzWzBdLnNldERhdGEoZGF0YS5maWx0ZXIoZnVuY3Rpb24odikge1xyXG4gICAgICAgICAgICAgICAgICBpZiAobG9jYWwpIHJldHVybiB2LmxvY2FsO1xyXG4gICAgICAgICAgICAgICAgICBlbHNlIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfSkubWFwKGZ1bmN0aW9uKHYpIHtcclxuICAgICAgICAgICAgICAgICAgaWYgKHYucCA9PT0gXCJZT1VcIikgcmV0dXJuIHsgeTogdi54LCBjb2xvcjogXCJyZWRcIiB9O1xyXG4gICAgICAgICAgICAgICAgICBlbHNlIHJldHVybiB2Lng7XHJcbiAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgfSkuYWRkKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIHRpdGxlOiB7IHRleHQ6ICdCZW5jaG1hcmsnIH0sXHJcbiAgICAgICAgeEF4aXM6IHtcclxuICAgICAgICAgIGNhdGVnb3JpZXM6IGRhdGEuZmlsdGVyKGZ1bmN0aW9uKHYpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHYubG9jYWwgPT09IGxvY2FsO1xyXG4gICAgICAgICAgfSkubWFwKGZ1bmN0aW9uKHYpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHYucDtcclxuICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgY3Jvc3NoYWlyOiB0cnVlXHJcbiAgICAgICAgfSxcclxuICAgICAgICB5QXhpczoge1xyXG4gICAgICAgICAgbWluOiAwLFxyXG4gICAgICAgICAgbWF4OiAxMDAsXHJcbiAgICAgICAgICB0aXRsZTogeyB0ZXh0OiAnJSBwYXRpZW50cyBtZWV0aW5nIHRhcmdldCcgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdG9vbHRpcDoge1xyXG4gICAgICAgICAgaGVhZGVyRm9ybWF0OiAnPHNwYW4gc3R5bGU9XCJmb250LXNpemU6MTBweFwiPlByYWN0aWNlOiA8Yj57cG9pbnQua2V5fTwvYj48L3NwYW4+PHRhYmxlPicsXHJcbiAgICAgICAgICBwb2ludEZvcm1hdDogJzx0cj48dGQgc3R5bGU9XCJjb2xvcjp7c2VyaWVzLmNvbG9yfTtwYWRkaW5nOjBcIj57c2VyaWVzLm5hbWV9OiA8L3RkPicgK1xyXG4gICAgICAgICAgICAnPHRkIHN0eWxlPVwicGFkZGluZzowXCI+PGI+e3BvaW50Lnk6LjFmfSU8L2I+PC90ZD48L3RyPicsXHJcbiAgICAgICAgICBmb290ZXJGb3JtYXQ6ICc8L3RhYmxlPicsXHJcbiAgICAgICAgICBzaGFyZWQ6IHRydWUsXHJcbiAgICAgICAgICB1c2VIVE1MOiB0cnVlXHJcbiAgICAgICAgfSxcclxuICAgICAgICBwbG90T3B0aW9uczoge1xyXG4gICAgICAgICAgY29sdW1uOiB7XHJcbiAgICAgICAgICAgIHBvaW50UGFkZGluZzogMC4yLFxyXG4gICAgICAgICAgICBib3JkZXJXaWR0aDogMFxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgbGVnZW5kOiB7XHJcbiAgICAgICAgICBlbmFibGVkOiBmYWxzZVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2VyaWVzOiBbe1xyXG4gICAgICAgICAgbmFtZTogJ1BlcmZvcm1hbmNlJyxcclxuICAgICAgICAgIGRhdGE6IGRhdGEuZmlsdGVyKGZ1bmN0aW9uKHYpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHYubG9jYWwgPT09IGxvY2FsO1xyXG4gICAgICAgICAgfSkubWFwKGZ1bmN0aW9uKHYpIHtcclxuICAgICAgICAgICAgaWYgKHYucCA9PT0gXCJZT1VcIikgcmV0dXJuIHsgeTogdi54LCBjb2xvcjogXCJyZWRcIiB9O1xyXG4gICAgICAgICAgICBlbHNlIHJldHVybiB2Lng7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICB9XVxyXG4gICAgICB9LFxyXG4gICAgICBmdW5jdGlvbihjaGFydCkgeyAvLyBvbiBjb21wbGV0ZVxyXG4gICAgICAgIHZhciB0ZXh0WCA9IGNoYXJ0LnBsb3RMZWZ0ICsgKGNoYXJ0LnBsb3RXaWR0aCAqIDAuNSk7XHJcbiAgICAgICAgdmFyIHRleHRZID0gY2hhcnQucGxvdFRvcCArIChjaGFydC5wbG90SGVpZ2h0ICogMC41KTtcclxuXHJcbiAgICAgICAgdmFyIHNwYW4gPSAnPHNwYW4gaWQ9XCJwaWVDaGFydEluZm9UZXh0XCIgc3R5bGU9XCJwb3NpdGlvbjphYnNvbHV0ZTsgdGV4dC1hbGlnbjpjZW50ZXI7LW1zLXRyYW5zZm9ybTogcm90YXRlKDMzNWRlZyk7LXdlYmtpdC10cmFuc2Zvcm06IHJvdGF0ZSgzMzVkZWcpO3RyYW5zZm9ybTogcm90YXRlKDMzNWRlZyk7XCI+JztcclxuICAgICAgICBzcGFuICs9ICc8c3BhbiBzdHlsZT1cImZvbnQtc2l6ZTogNjRweFwiPkNvbWluZyBTb29uITwvc3Bhbj4nO1xyXG4gICAgICAgIHNwYW4gKz0gJzwvc3Bhbj4nO1xyXG5cclxuICAgICAgICAkKFwiI2JlbmNobWFyay1jaGFydFwiKS5hcHBlbmQoc3Bhbik7XHJcbiAgICAgICAgc3BhbiA9ICQoJyNwaWVDaGFydEluZm9UZXh0Jyk7XHJcbiAgICAgICAgc3Bhbi5jc3MoJ2xlZnQnLCB0ZXh0WCArIChzcGFuLndpZHRoKCkgKiAtMC41KSk7XHJcbiAgICAgICAgc3Bhbi5jc3MoJ3RvcCcsIHRleHRZICsgKHNwYW4uaGVpZ2h0KCkgKiAtMC41KSk7XHJcbiAgICAgIH0pO1xyXG5cclxuICB9LFxyXG5cclxuICBkcmF3UGVyZm9ybWFuY2VUcmVuZENoYXJ0SEM6IGZ1bmN0aW9uKGVsZW1lbnQsIGRhdGEpIHtcclxuXHJcbiAgICAvLy8gZGF0YSBpc1xyXG4gICAgLy8ge1xyXG4gICAgLy8gIFwidmFsdWVzXCI6XHJcbiAgICAvLyAgICBbXCJ4XCIsIFwiMjAxNS0wOC0yNFwiLCBcIjIwMTUtMDgtMjNcIiwuLi5cclxuICAgIC8vICAgIFtcIm51bWVyYXRvclwiLCAzNSwgMzcsIDMzLCAzMiwgMzEsLi4uXHJcbiAgICAvLyAgICBbXCJkZW5vbWluYXRvclwiLCAxMzUsIDEzMywgMTMzLCAxMywuLi5cclxuICAgIC8vICAgIFtcInRhcmdldFwiLCAwLjMsIDAuMywgMC4uLlxyXG4gICAgLy8gfVxyXG5cclxuICAgIHZhciB0YXJnZXQgPSA3NSxcclxuICAgICAgbWF4VmFsdWUgPSB0YXJnZXQsXHJcbiAgICAgIG1heFh2YWx1ZSA9IDA7XHJcblxyXG4gICAgdmFyIHNlcmllcyA9IFtcclxuICAgICAgeyB0eXBlOiAnbGluZScsIG5hbWU6ICdUcmVuZCcsIGRhdGE6IFtdIH0sXHJcbiAgICAgIHsgdHlwZTogJ2xpbmUnLCBuYW1lOiAnUHJlZGljdGlvbicsIGRhdGE6IFtdLCBkYXNoU3R5bGU6ICdkb3QnIH1cclxuICAgIF07XHJcblxyXG4gICAgdmFyIHRvZGF5ID0gbmV3IERhdGUoKTtcclxuICAgIHZhciBsYXN0QXByaWwgPSBuZXcgRGF0ZSgpO1xyXG4gICAgdmFyIGFwcmlsQmVmb3JlVGhhdCA9IG5ldyBEYXRlKCk7XHJcbiAgICB2YXIgbmV4dEFwcmlsID0gbmV3IERhdGUoKTtcclxuICAgIGlmICh0b2RheS5nZXRNb250aCgpIDwgMykge1xyXG4gICAgICAvL2FmdGVyIGFwcmlsXHJcbiAgICAgIGxhc3RBcHJpbC5zZXRZZWFyKHRvZGF5LmdldEZ1bGxZZWFyKCkgLSAxKTtcclxuICAgICAgYXByaWxCZWZvcmVUaGF0LnNldFllYXIodG9kYXkuZ2V0RnVsbFllYXIoKSAtIDEpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgbmV4dEFwcmlsLnNldFllYXIodG9kYXkuZ2V0RnVsbFllYXIoKSArIDEpO1xyXG4gICAgfVxyXG4gICAgYXByaWxCZWZvcmVUaGF0LnNldFllYXIoYXByaWxCZWZvcmVUaGF0LmdldEZ1bGxZZWFyKCkgLSAxKTtcclxuICAgIGxhc3RBcHJpbC5zZXRNb250aCgzKTtcclxuICAgIGFwcmlsQmVmb3JlVGhhdC5zZXRNb250aCgzKTtcclxuICAgIG5leHRBcHJpbC5zZXRNb250aCgzKTtcclxuICAgIGxhc3RBcHJpbC5zZXREYXRlKDEpO1xyXG4gICAgYXByaWxCZWZvcmVUaGF0LnNldERhdGUoMSk7XHJcbiAgICBuZXh0QXByaWwuc2V0RGF0ZSgxKTtcclxuXHJcbiAgICB2YXIgbiA9IDAsXHJcbiAgICAgIHN1bVggPSAwLFxyXG4gICAgICBzdW1ZID0gMCxcclxuICAgICAgc3VtWFkgPSAwLFxyXG4gICAgICBzdW1YWCA9IDAsXHJcbiAgICAgIHN1bVlZID0gMCxcclxuICAgICAgaW50ZXJjZXB0LCBncmFkaWVudCwgY29tcERhdGU7XHJcblxyXG4gICAgaWYgKGRhdGEudmFsdWVzWzBdLmZpbHRlcihmdW5jdGlvbih2KSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBEYXRlKHYpLmdldFRpbWUoKSA+IGxhc3RBcHJpbC5nZXRUaW1lKCk7XHJcbiAgICAgIH0pLmxlbmd0aCA+IDIpIGNvbXBEYXRlID0gbmV3IERhdGUobGFzdEFwcmlsLmdldFRpbWUoKSk7XHJcbiAgICBlbHNlIGNvbXBEYXRlID0gbmV3IERhdGUoYXByaWxCZWZvcmVUaGF0LmdldFRpbWUoKSk7XHJcblxyXG4gICAgZGF0YS52YWx1ZXNbMF0uZm9yRWFjaChmdW5jdGlvbih2LCBpKSB7XHJcbiAgICAgIGlmIChpID09PSAwKSByZXR1cm47XHJcbiAgICAgIHZhciB0aW1lID0gbmV3IERhdGUodikuZ2V0VGltZSgpO1xyXG4gICAgICB2YXIgeSA9ICtkYXRhLnZhbHVlc1sxXVtpXSAqIDEwMCAvICtkYXRhLnZhbHVlc1syXVtpXTtcclxuICAgICAgaWYgKHRpbWUgPj0gY29tcERhdGUuZ2V0VGltZSgpKSB7XHJcbiAgICAgICAgbisrO1xyXG4gICAgICAgIHN1bVggKz0gdGltZTtcclxuICAgICAgICBzdW1ZICs9IHk7XHJcbiAgICAgICAgc3VtWFkgKz0gdGltZSAqIHk7XHJcbiAgICAgICAgc3VtWFggKz0gdGltZSAqIHRpbWU7XHJcbiAgICAgICAgc3VtWVkgKz0geSAqIHk7XHJcbiAgICAgIH1cclxuICAgICAgc2VyaWVzWzBdLmRhdGEucHVzaChbdGltZSwgeV0pO1xyXG4gICAgICBtYXhWYWx1ZSA9IE1hdGgubWF4KG1heFZhbHVlLCB5KTtcclxuICAgICAgbWF4WHZhbHVlID0gTWF0aC5tYXgobWF4WHZhbHVlLCB0aW1lKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGludGVyY2VwdCA9IChzdW1ZICogc3VtWFggLSBzdW1YICogc3VtWFkpIC8gKG4gKiBzdW1YWCAtIHN1bVggKiBzdW1YKTtcclxuICAgIGdyYWRpZW50ID0gKG4gKiBzdW1YWSAtIHN1bVggKiBzdW1ZKSAvIChuICogc3VtWFggLSBzdW1YICogc3VtWCk7XHJcblxyXG4gICAgdmFyIG5ld0NvbXBEYXRlID0gbmV3IERhdGUobGFzdEFwcmlsLmdldFRpbWUoKSk7XHJcbiAgICBzZXJpZXNbMV0uZGF0YS5wdXNoKFttYXhYdmFsdWUsIG1heFh2YWx1ZSAqIGdyYWRpZW50ICsgaW50ZXJjZXB0XSk7XHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IDEzOyBpKyspIHtcclxuICAgICAgdmFyIHggPSBuZXdDb21wRGF0ZS5nZXRUaW1lKCk7XHJcbiAgICAgIGlmICh4IDwgbWF4WHZhbHVlKSB7XHJcbiAgICAgICAgbmV3Q29tcERhdGUuc2V0TW9udGgobmV3Q29tcERhdGUuZ2V0TW9udGgoKSArIDEpO1xyXG4gICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICB9XHJcbiAgICAgIHNlcmllc1sxXS5kYXRhLnB1c2goW3gsIHggKiBncmFkaWVudCArIGludGVyY2VwdF0pO1xyXG4gICAgICB2YXIgbSA9IG5ld0NvbXBEYXRlLmdldE1vbnRoKCk7XHJcbiAgICAgIG5ld0NvbXBEYXRlLnNldE1vbnRoKG5ld0NvbXBEYXRlLmdldE1vbnRoKCkgKyAxKTtcclxuICAgIH1cclxuXHJcbiAgICAvL0FkZCBsaW5lIG9mIGJlc3QgZml0IGZvciBsYXRlc3QgZGF0YSBzaW5jZSBhcHJpbCB0byBuZXh0IGFwcmlsXHJcblxyXG5cclxuICAgIC8vRGVmYXVsdCB0byBsYXN0IGFwcmlsIC0gYXByaWxcclxuXHJcblxyXG4gICAgdmFyIGMgPSAkKCcjJyArIGVsZW1lbnQpLmhpZ2hjaGFydHMoe1xyXG4gICAgICB0aXRsZTogeyB0ZXh0OiAnJyB9LFxyXG4gICAgICB4QXhpczoge1xyXG4gICAgICAgIG1heDogbmV4dEFwcmlsLmdldFRpbWUoKSxcclxuICAgICAgICB0eXBlOiAnZGF0ZXRpbWUnXHJcbiAgICAgIH0sXHJcbiAgICAgIHlBeGlzOiB7XHJcbiAgICAgICAgdGl0bGU6IHsgdGV4dDogJ1F1YWxpdHkgc3RhbmRhcmQgcGVyZm9ybWFuY2UnIH0sXHJcbiAgICAgICAgbWF4OiBtYXhWYWx1ZSArIDUsXHJcbiAgICAgICAgbWluOiAwLFxyXG4gICAgICAgIHBsb3RMaW5lczogW3tcclxuICAgICAgICAgIHZhbHVlOiB0YXJnZXQsXHJcbiAgICAgICAgICBjb2xvcjogJ2dyZWVuJyxcclxuICAgICAgICAgIGRhc2hTdHlsZTogJ3Nob3J0ZGFzaCcsXHJcbiAgICAgICAgICB3aWR0aDogMixcclxuICAgICAgICAgIGxhYmVsOiB7XHJcbiAgICAgICAgICAgIHRleHQ6ICdUYXJnZXQgLSAnICsgKHRhcmdldCkgKyAnJSdcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgfV1cclxuICAgICAgfSxcclxuICAgICAgbGVnZW5kOiB7IGVuYWJsZWQ6IHRydWUgfSxcclxuICAgICAgdG9vbHRpcDoge1xyXG4gICAgICAgIHBvaW50Rm9ybWF0OiAnPHNwYW4gc3R5bGU9XCJjb2xvcjp7cG9pbnQuY29sb3J9XCI+XFx1MjVDRjwvc3Bhbj4ge3Nlcmllcy5uYW1lfTogPGI+e3BvaW50Lnk6LjJmfSU8L2I+PGJyLz4nXHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBuYXZpZ2F0b3I6IHtcclxuICAgICAgICBlbmFibGVkOiB0cnVlXHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBzZXJpZXM6IHNlcmllc1xyXG4gICAgfSk7XHJcblxyXG4gICAgYy5oaWdoY2hhcnRzKCkuYXhlc1swXS5zZXRFeHRyZW1lcyhhcHJpbEJlZm9yZVRoYXQuZ2V0VGltZSgpLCBsYXN0QXByaWwuZ2V0VGltZSgpLCB1bmRlZmluZWQsIGZhbHNlKTtcclxuXHJcbiAgfSxcclxuXHJcbiAgZHJhd0FuYWx5dGljczogZnVuY3Rpb24oZWxlbWVudCwgZGF0YSwgc2VsZWN0U2VyaWVzRm4pIHtcclxuXHJcbiAgICBjaHQuY2xvbmVUb29sVGlwID0gbnVsbDtcclxuICAgIGNodC5jbG9uZVRvb2xUaXAyID0gbnVsbDtcclxuXHJcbiAgICAkKCcjJyArIGVsZW1lbnQpLmhpZ2hjaGFydHMoe1xyXG4gICAgICBjaGFydDoge1xyXG4gICAgICAgIHR5cGU6IFwiY29sdW1uXCIsXHJcbiAgICAgICAgYmFja2dyb3VuZENvbG9yOiBcIiNGM0Y5RjlcIixcclxuICAgICAgICBoZWlnaHQ6IDIwMCxcclxuICAgICAgICBldmVudHM6IHtcclxuICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBzZWxlY3RTZXJpZXNGbigpO1xyXG5cclxuICAgICAgICAgICAgaWYgKGNodC5jbG9uZVRvb2xUaXApIHtcclxuICAgICAgICAgICAgICB0aGlzLmNvbnRhaW5lci5maXJzdENoaWxkLnJlbW92ZUNoaWxkKGNodC5jbG9uZVRvb2xUaXApO1xyXG4gICAgICAgICAgICAgIGNodC5jbG9uZVRvb2xUaXAgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChjaHQuY2xvbmVUb29sVGlwMikge1xyXG4gICAgICAgICAgICAgIGNodC5jbG9uZVRvb2xUaXAyLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgIGNodC5jbG9uZVRvb2xUaXAyID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuICAgICAgdGl0bGU6IHtcclxuICAgICAgICB0ZXh0OiAnUGF0aWVudHMgbm90IG1lZXRpbmcgdGhlIHN0YW5kYXJkJ1xyXG4gICAgICB9LFxyXG4gICAgICBzdWJ0aXRsZToge1xyXG4gICAgICAgIHRleHQ6IGRvY3VtZW50Lm9udG91Y2hzdGFydCA9PT0gdW5kZWZpbmVkID9cclxuICAgICAgICAgICdDbGljayBhIGNvbHVtbiB0byBmaWx0ZXIgdGhlIHBhdGllbnQgbGlzdCcgOiAnVGFwIGEgY29sdW1uIHRvIGZpbHRlciB0aGUgcGF0aWVudCBsaXN0J1xyXG4gICAgICB9LFxyXG4gICAgICB4QXhpczoge1xyXG4gICAgICAgIGNhdGVnb3JpZXM6IGRhdGEubWFwKGZ1bmN0aW9uKHYsIGkpIHtcclxuICAgICAgICAgIHJldHVybiB2WzBdO1xyXG4gICAgICAgIH0pXHJcbiAgICAgIH0sXHJcbiAgICAgIHlBeGlzOiB7XHJcbiAgICAgICAgdGl0bGU6IHtcclxuICAgICAgICAgIHRleHQ6ICdOdW1iZXIgb2YgcGF0aWVudHMnXHJcbiAgICAgICAgfSxcclxuICAgICAgICBzdGFja0xhYmVsczoge1xyXG4gICAgICAgICAgZW5hYmxlZDogdHJ1ZSxcclxuICAgICAgICAgIHN0eWxlOiB7XHJcbiAgICAgICAgICAgIGZvbnRXZWlnaHQ6ICdib2xkJyxcclxuICAgICAgICAgICAgY29sb3I6IChIaWdoY2hhcnRzLnRoZW1lICYmIEhpZ2hjaGFydHMudGhlbWUudGV4dENvbG9yKSB8fCAnZ3JheSdcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0sXHJcbiAgICAgIGxlZ2VuZDoge1xyXG4gICAgICAgIGVuYWJsZWQ6IGZhbHNlXHJcbiAgICAgIH0sXHJcblxyXG4gICAgICB0b29sdGlwOiB7XHJcbiAgICAgICAgYW5pbWF0aW9uOiBmYWxzZSxcclxuXHJcbiAgICAgICAgZm9ybWF0dGVyOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgIHJldHVybiB0aGlzLnBvaW50LmRlc2MubWF0Y2goLy57MSw0MH1bXiBdKiA/L2cpLmpvaW4oXCI8YnI+XCIpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHN0eWxlOiB7XHJcbiAgICAgICAgICBcIndoaXRlU3BhY2VcIjogXCJub3JtYWxcIlxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHVzZUhUTUw6IHRydWVcclxuICAgICAgfSxcclxuXHJcbiAgICAgIHBsb3RPcHRpb25zOiB7XHJcblxyXG4gICAgICAgIGNvbHVtbjoge1xyXG4gICAgICAgICAgZGF0YUxhYmVsczoge1xyXG4gICAgICAgICAgICBlbmFibGVkOiB0cnVlLFxyXG4gICAgICAgICAgICBjb2xvcjogJ2JsYWNrJ1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHNlcmllczoge1xyXG4gICAgICAgICAgY3Vyc29yOiAncG9pbnRlcicsXHJcbiAgICAgICAgICBwb2ludDoge1xyXG4gICAgICAgICAgICBldmVudHM6IHtcclxuICAgICAgICAgICAgICBjbGljazogZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgIHZhciBudW1Qb2ludHMgPSB0aGlzLnNlcmllcy5wb2ludHMubGVuZ3RoO1xyXG5cclxuICAgICAgICAgICAgICAgIHNlbGVjdFNlcmllc0ZuKHRoaXMuY2F0ZWdvcnkpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChjaHQuY2xvbmVUb29sVGlwKSB7XHJcbiAgICAgICAgICAgICAgICAgIHRoaXMuc2VyaWVzLmNoYXJ0LmNvbnRhaW5lci5maXJzdENoaWxkLnJlbW92ZUNoaWxkKGNodC5jbG9uZVRvb2xUaXApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGNodC5jbG9uZVRvb2xUaXAyKSB7XHJcbiAgICAgICAgICAgICAgICAgIGNodC5jbG9uZVRvb2xUaXAyLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY2h0LmNsb25lVG9vbFRpcCA9IHRoaXMuc2VyaWVzLmNoYXJ0LnRvb2x0aXAubGFiZWwuZWxlbWVudC5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlcmllcy5jaGFydC5jb250YWluZXIuZmlyc3RDaGlsZC5hcHBlbmRDaGlsZChjaHQuY2xvbmVUb29sVGlwKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjaHQuY2xvbmVUb29sVGlwMiA9ICQoJy5oaWdoY2hhcnRzLXRvb2x0aXAnKS5jbG9uZSgpO1xyXG4gICAgICAgICAgICAgICAgJCh0aGlzLnNlcmllcy5jaGFydC5jb250YWluZXIpLmFwcGVuZChjaHQuY2xvbmVUb29sVGlwMik7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuXHJcbiAgICAgIHNlcmllczogW3tcclxuICAgICAgICBkYXRhOiBkYXRhLm1hcChmdW5jdGlvbih2LCBpKSB7XHJcbiAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICB5OiB2WzJdLFxyXG4gICAgICAgICAgICBkZXNjOiB2WzFdLFxyXG4gICAgICAgICAgICBjb2xvcjogSGlnaGNoYXJ0cy5nZXRPcHRpb25zKCkuY29sb3JzW2ldXHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgIH0pXHJcbiAgICAgIH1dXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBjaHQ7XHJcbiIsInZhciBsb2cgPSByZXF1aXJlKCcuL2xvZy5qcycpLFxyXG4gIGxvb2t1cCA9IHJlcXVpcmUoJy4vbG9va3VwLmpzJyk7XHJcblxyXG5cclxudmFyIF9nZXRBbGxJbmRpY2F0b3JEYXRhID0gZnVuY3Rpb24oY2FsbGJhY2spIHtcclxuICB2YXIgciA9IE1hdGgucmFuZG9tKCk7XHJcbiAgJC5nZXRKU09OKFwiZGF0YS9pbmRpY2F0b3JzLmpzb24/dj1cIiArIHIsIGZ1bmN0aW9uKGZpbGUpIHtcclxuICAgIGR0LmluZGljYXRvcnMgPSBmaWxlO1xyXG5cclxuICAgIGR0LmluZGljYXRvcnMuZm9yRWFjaChmdW5jdGlvbihpbmRpY2F0b3IpIHtcclxuICAgICAgdmFyIHBlcmNlbnRhZ2UgPSBNYXRoLnJvdW5kKDEwMCAqIGluZGljYXRvci52YWx1ZXNbMV1bMV0gKiAxMDAgLyBpbmRpY2F0b3IudmFsdWVzWzJdWzFdKSAvIDEwMDtcclxuICAgICAgaW5kaWNhdG9yLnBlcmZvcm1hbmNlID0gaW5kaWNhdG9yLnZhbHVlc1sxXVsxXSArIFwiIC8gXCIgKyBpbmRpY2F0b3IudmFsdWVzWzJdWzFdICsgXCIgKFwiICsgcGVyY2VudGFnZSArIFwiJSlcIjtcclxuICAgICAgaW5kaWNhdG9yLnRhcmdldCA9IGluZGljYXRvci52YWx1ZXNbM11bMV0gKiAxMDAgKyBcIiVcIjtcclxuICAgICAgaW5kaWNhdG9yLnVwID0gcGVyY2VudGFnZSA+IE1hdGgucm91bmQoMTAwICogaW5kaWNhdG9yLnZhbHVlc1sxXVsyXSAqIDEwMCAvIGluZGljYXRvci52YWx1ZXNbMl1bMl0pIC8gMTAwO1xyXG4gICAgICB2YXIgdHJlbmQgPSBpbmRpY2F0b3IudmFsdWVzWzFdLm1hcChmdW5jdGlvbih2YWwsIGlkeCkge1xyXG4gICAgICAgIHJldHVybiBNYXRoLnJvdW5kKDEwMCAqIHZhbCAqIDEwMCAvIGluZGljYXRvci52YWx1ZXNbMl1baWR4XSkgLyAxMDA7XHJcbiAgICAgIH0pLnNsaWNlKDEsIDEwKTtcclxuICAgICAgdHJlbmQucmV2ZXJzZSgpO1xyXG4gICAgICBpbmRpY2F0b3IudHJlbmQgPSB0cmVuZC5qb2luKFwiLFwiKTtcclxuICAgICAgdmFyIGRhdGVzID0gaW5kaWNhdG9yLnZhbHVlc1swXS5zbGljZSgxLCAxMCk7XHJcbiAgICAgIGRhdGVzLnJldmVyc2UoKTtcclxuICAgICAgaW5kaWNhdG9yLmRhdGVzID0gZGF0ZXM7XHJcbiAgICB9KTtcclxuXHJcblxyXG4gICAgY2FsbGJhY2soZHQuaW5kaWNhdG9ycyk7XHJcbiAgfSk7XHJcbn07XHJcblxyXG52YXIgX2dldEFsbEluZGljYXRvckRhdGFTeW5jID0gZnVuY3Rpb24oY2FsbGJhY2spIHtcclxuICB2YXIgciA9IE1hdGgucmFuZG9tKCk7XHJcbiAgJC5hamF4KHtcclxuICAgIHVybDogXCJkYXRhL2luZGljYXRvcnMuanNvbj92PVwiICsgcixcclxuICAgIGFzeW5jOiBmYWxzZSxcclxuICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKGZpbGUpIHtcclxuICAgICAgZHQuaW5kaWNhdG9ycyA9IGZpbGU7XHJcblxyXG4gICAgICBkdC5pbmRpY2F0b3JzLmZvckVhY2goZnVuY3Rpb24oaW5kaWNhdG9yKSB7XHJcbiAgICAgICAgdmFyIHBlcmNlbnRhZ2UgPSBNYXRoLnJvdW5kKDEwMCAqIGluZGljYXRvci52YWx1ZXNbMV1bMV0gKiAxMDAgLyBpbmRpY2F0b3IudmFsdWVzWzJdWzFdKSAvIDEwMDtcclxuICAgICAgICBpbmRpY2F0b3IucGVyZm9ybWFuY2UgPSBpbmRpY2F0b3IudmFsdWVzWzFdWzFdICsgXCIgLyBcIiArIGluZGljYXRvci52YWx1ZXNbMl1bMV0gKyBcIiAoXCIgKyBwZXJjZW50YWdlICsgXCIlKVwiO1xyXG4gICAgICAgIGluZGljYXRvci50YXJnZXQgPSBpbmRpY2F0b3IudmFsdWVzWzNdWzFdICogMTAwICsgXCIlXCI7XHJcbiAgICAgICAgaW5kaWNhdG9yLnVwID0gcGVyY2VudGFnZSA+IE1hdGgucm91bmQoMTAwICogaW5kaWNhdG9yLnZhbHVlc1sxXVsyXSAqIDEwMCAvIGluZGljYXRvci52YWx1ZXNbMl1bMl0pIC8gMTAwO1xyXG4gICAgICAgIHZhciB0cmVuZCA9IGluZGljYXRvci52YWx1ZXNbMV0ubWFwKGZ1bmN0aW9uKHZhbCwgaWR4KSB7XHJcbiAgICAgICAgICByZXR1cm4gTWF0aC5yb3VuZCgxMDAgKiB2YWwgKiAxMDAgLyBpbmRpY2F0b3IudmFsdWVzWzJdW2lkeF0pIC8gMTAwO1xyXG4gICAgICAgIH0pLnNsaWNlKDEsIDEwKTtcclxuICAgICAgICB0cmVuZC5yZXZlcnNlKCk7XHJcbiAgICAgICAgaW5kaWNhdG9yLnRyZW5kID0gdHJlbmQuam9pbihcIixcIik7XHJcbiAgICAgICAgdmFyIGRhdGVzID0gaW5kaWNhdG9yLnZhbHVlc1swXS5zbGljZSgxLCAxMCk7XHJcbiAgICAgICAgZGF0ZXMucmV2ZXJzZSgpO1xyXG4gICAgICAgIGluZGljYXRvci5kYXRlcyA9IGRhdGVzO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIHJldHVybiBkdC5pbmRpY2F0b3JzO1xyXG59O1xyXG5cclxudmFyIF9nZXRJbmRpY2F0b3JEYXRhID0gZnVuY3Rpb24oaW5kaWNhdG9yLCBjYWxsYmFjaykge1xyXG4gIHZhciByID0gTWF0aC5yYW5kb20oKTtcclxuICAkLmdldEpTT04oXCJkYXRhL2lkYXRhLlwiICsgaW5kaWNhdG9yICsgXCIuanNvbj92PVwiICsgciwgZnVuY3Rpb24oZmlsZSkge1xyXG4gICAgZHQuaW5kaWNhdG9yc1tpbmRpY2F0b3JdID0gZmlsZTtcclxuXHJcbiAgICAvL2FwcGx5IHdoaWNoIGNhdGVnb3JpZXMgcGVvcGxlIGJlbG9uZyB0b1xyXG4gICAgT2JqZWN0LmtleXMoZHQuaW5kaWNhdG9yc1tpbmRpY2F0b3JdLnBhdGllbnRzKS5mb3JFYWNoKGZ1bmN0aW9uKHBhdGllbnQpIHtcclxuICAgICAgZHQuaW5kaWNhdG9yc1tpbmRpY2F0b3JdLnBhdGllbnRzW3BhdGllbnRdLm9wcG9ydHVuaXRpZXMgPSBbXTtcclxuICAgICAgZHQuaW5kaWNhdG9yc1tpbmRpY2F0b3JdLm9wcG9ydHVuaXRpZXMuZm9yRWFjaChmdW5jdGlvbihvcHAsIGlkeCkge1xyXG4gICAgICAgIGlmIChvcHAucGF0aWVudHMuaW5kZXhPZigrcGF0aWVudCkgPiAtMSkge1xyXG4gICAgICAgICAgZHQuaW5kaWNhdG9yc1tpbmRpY2F0b3JdLnBhdGllbnRzW3BhdGllbnRdLm9wcG9ydHVuaXRpZXMucHVzaChpZHgpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBjYWxsYmFjayhkdC5pbmRpY2F0b3JzW2luZGljYXRvcl0pO1xyXG4gIH0pO1xyXG59O1xyXG5cclxudmFyIF9nZXRJbmRpY2F0b3JEYXRhU3luYyA9IGZ1bmN0aW9uKGluZGljYXRvcikge1xyXG4gIHZhciByID0gTWF0aC5yYW5kb20oKTtcclxuICAkLmFqYXgoe1xyXG4gICAgdXJsOiBcImRhdGEvaWRhdGEuXCIgKyBpbmRpY2F0b3IgKyBcIi5qc29uP3Y9XCIgKyByLFxyXG4gICAgYXN5bmM6IGZhbHNlLFxyXG4gICAgc3VjY2VzczogZnVuY3Rpb24oZmlsZSkge1xyXG4gICAgICBkdC5pbmRpY2F0b3JzW2luZGljYXRvcl0gPSBmaWxlO1xyXG5cclxuICAgICAgLy9hcHBseSB3aGljaCBjYXRlZ29yaWVzIHBlb3BsZSBiZWxvbmcgdG9cclxuICAgICAgT2JqZWN0LmtleXMoZHQuaW5kaWNhdG9yc1tpbmRpY2F0b3JdLnBhdGllbnRzKS5mb3JFYWNoKGZ1bmN0aW9uKHBhdGllbnQpIHtcclxuICAgICAgICBkdC5pbmRpY2F0b3JzW2luZGljYXRvcl0ucGF0aWVudHNbcGF0aWVudF0ub3Bwb3J0dW5pdGllcyA9IFtdO1xyXG4gICAgICAgIGR0LmluZGljYXRvcnNbaW5kaWNhdG9yXS5vcHBvcnR1bml0aWVzLmZvckVhY2goZnVuY3Rpb24ob3BwLCBpZHgpIHtcclxuICAgICAgICAgIGlmIChvcHAucGF0aWVudHMuaW5kZXhPZigrcGF0aWVudCkgPiAtMSkge1xyXG4gICAgICAgICAgICBkdC5pbmRpY2F0b3JzW2luZGljYXRvcl0ucGF0aWVudHNbcGF0aWVudF0ub3Bwb3J0dW5pdGllcy5wdXNoKGlkeCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIH1cclxuICB9KTtcclxuICByZXR1cm4gZHQuaW5kaWNhdG9yc1tpbmRpY2F0b3JdO1xyXG59O1xyXG5cclxudmFyIF9nZXRGYWtlUGF0aWVudERhdGEgPSBmdW5jdGlvbihwYXRpZW50LCBjYWxsYmFjaykge1xyXG4gIHZhciByID0gTWF0aC5yYW5kb20oKSxcclxuICAgIGlzQXN5bmMgPSB0eXBlb2YoY2FsbGJhY2spID09PSBcImZ1bmN0aW9uXCI7XHJcbiAgaWYgKGR0LnBhdGllbnRzICYmIGR0LnBhdGllbnRzLnBhdGllbnQpIHtcclxuICAgIGlmIChpc0FzeW5jKSByZXR1cm4gY2FsbGJhY2soZHQucGF0aWVudHMucGF0aWVudCk7XHJcbiAgICBlbHNlIHJldHVybiBkdC5wYXRpZW50cy5wYXRpZW50O1xyXG4gIH1cclxuICAkLmFqYXgoe1xyXG4gICAgdXJsOiBcImRhdGEvcGF0aWVudC5qc29uP3Y9XCIgKyByLFxyXG4gICAgYXN5bmM6IGlzQXN5bmMsXHJcbiAgICBzdWNjZXNzOiBmdW5jdGlvbihmaWxlKSB7XHJcbiAgICAgIGlmICghZHQucGF0aWVudHMpIGR0LnBhdGllbnRzID0ge307XHJcbiAgICAgIGR0LnBhdGllbnRzLnBhdGllbnQgPSBmaWxlO1xyXG4gICAgICBkdC5wYXRpZW50c1twYXRpZW50XSA9IGZpbGU7XHJcblxyXG4gICAgICBpZiAoaXNBc3luYykgY2FsbGJhY2soZHQucGF0aWVudHMucGF0aWVudCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcbiAgaWYgKCFpc0FzeW5jKSByZXR1cm4gZHQucGF0aWVudHMucGF0aWVudDtcclxufTtcclxuXHJcbnZhciBfZ2V0UGF0aWVudERhdGEgPSBmdW5jdGlvbihwYXRpZW50LCBjYWxsYmFjaykge1xyXG4gIC8vaWYgY2FsbGJhY2sgcHJvdmlkZWQgZG8gYXN5bmMgLSBlbHNlIGRvIHN5bmNcclxuICB2YXIgciA9IE1hdGgucmFuZG9tKCksXHJcbiAgICBpc0FzeW5jID0gdHlwZW9mKGNhbGxiYWNrKSA9PT0gXCJmdW5jdGlvblwiO1xyXG5cclxuICBpZiAoZHQucGF0aWVudHMgJiYgZHQucGF0aWVudHNbcGF0aWVudF0pIHtcclxuICAgIGlmIChpc0FzeW5jKSByZXR1cm4gY2FsbGJhY2soZHQucGF0aWVudHNbcGF0aWVudF0pO1xyXG4gICAgZWxzZSByZXR1cm4gZHQucGF0aWVudHNbcGF0aWVudF07XHJcbiAgfVxyXG5cclxuICAkLmFqYXgoe1xyXG4gICAgdXJsOiBcImRhdGEvXCIgKyBwYXRpZW50ICsgXCIuanNvbj92PVwiICsgcixcclxuICAgIGFzeW5jOiBpc0FzeW5jLFxyXG4gICAgc3VjY2VzczogZnVuY3Rpb24oZmlsZSkge1xyXG4gICAgICBpZiAoIWR0LnBhdGllbnRzKSBkdC5wYXRpZW50cyA9IHt9O1xyXG4gICAgICBkdC5wYXRpZW50c1twYXRpZW50XSA9IGZpbGU7XHJcblxyXG4gICAgICBpZiAoaXNBc3luYykgY2FsbGJhY2soZHQucGF0aWVudHNbcGF0aWVudF0pO1xyXG4gICAgfSxcclxuICAgIGVycm9yOiBmdW5jdGlvbigpIHtcclxuICAgICAgaWYgKGR0LnBhdGllbnRzLnBhdGllbnQgJiYgaXNBc3luYykge1xyXG4gICAgICAgIGR0LnBhdGllbnRzW3BhdGllbnRdID0gZHQucGF0aWVudHMucGF0aWVudDtcclxuICAgICAgICByZXR1cm4gY2FsbGJhY2soZHQucGF0aWVudHMucGF0aWVudCk7XHJcbiAgICAgIH0gZWxzZSBpZiAoIWR0LnBhdGllbnRzLnBhdGllbnQpIHtcclxuICAgICAgICBfZ2V0RmFrZVBhdGllbnREYXRhKHBhdGllbnQsIGNhbGxiYWNrKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICBpZiAoIWlzQXN5bmMpIHJldHVybiBkdC5wYXRpZW50cy5wYXRpZW50O1xyXG59O1xyXG5cclxudmFyIGR0ID0ge1xyXG5cclxuICBwYXRod2F5TmFtZXM6IHt9LFxyXG4gIGRpc2Vhc2VzOiBbXSxcclxuICBvcHRpb25zOiBbXSxcclxuICBwYXRMb29rdXA6IHt9LFxyXG5cclxuICBnZXRQYXRpZXRMaXN0Rm9yU3RhbmRhcmQ6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCkge1xyXG4gICAgdmFyIHBhdGllbnRzID0gZHQucmVtb3ZlRHVwbGljYXRlcyhkdFtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS5vcHBvcnR1bml0aWVzLnJlZHVjZShmdW5jdGlvbihhLCBiKSB7XHJcbiAgICAgIHJldHVybiBhLnBhdGllbnRzID8gYS5wYXRpZW50cy5jb25jYXQoYi5wYXRpZW50cykgOiBhLmNvbmNhdChiLnBhdGllbnRzKTtcclxuICAgIH0pKTtcclxuICAgIHJldHVybiBwYXRpZW50cztcclxuICB9LFxyXG5cclxuICBnZXRQYXRpZW50U3RhdHVzOiBmdW5jdGlvbihwYXRpZW50SWQsIHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCkge1xyXG4gICAgaWYgKGR0LnBhdGllbnRzW3BhdGllbnRJZF0uYnJlYWNoKSB7XHJcbiAgICAgIGlmIChkdC5wYXRpZW50c1twYXRpZW50SWRdLmJyZWFjaC5maWx0ZXIoZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgICAgICByZXR1cm4gdmFsLnBhdGh3YXlJZCA9PT0gcGF0aHdheUlkICYmIHZhbC5wYXRod2F5U3RhZ2UgPT09IHBhdGh3YXlTdGFnZSAmJiB2YWwuc3RhbmRhcmQgPT09IHN0YW5kYXJkO1xyXG4gICAgICAgIH0pLmxlbmd0aCA+IDApIHtcclxuICAgICAgICByZXR1cm4gXCJtaXNzZWRcIjtcclxuICAgICAgfSBlbHNlIGlmIChkdC5wYXRpZW50c1twYXRpZW50SWRdLmJyZWFjaC5maWx0ZXIoZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgICAgICByZXR1cm4gdmFsLnBhdGh3YXlJZCA9PT0gcGF0aHdheUlkICYmIHZhbC5wYXRod2F5U3RhZ2UgPT09IFwiZGlhZ25vc2lzXCI7XHJcbiAgICAgICAgfSkubGVuZ3RoID4gMCAmJiBwYXRod2F5U3RhZ2UgIT09IFwiZGlhZ25vc2lzXCIpIHtcclxuICAgICAgICByZXR1cm4gXCJub3RcIjtcclxuICAgICAgfSBlbHNlIGlmIChkdC5wYXRpZW50c1twYXRpZW50SWRdLmJyZWFjaC5maWx0ZXIoZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgICAgICByZXR1cm4gdmFsLnBhdGh3YXlJZCA9PT0gcGF0aHdheUlkO1xyXG4gICAgICAgIH0pLmxlbmd0aCA+IDApIHtcclxuICAgICAgICByZXR1cm4gXCJva1wiO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBcIm5vdFwiO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gXCJub3RcIjtcclxuICAgIH1cclxuICB9LFxyXG5cclxuICBnZXROdW1lcmF0b3JGb3JTdGFuZGFyZDogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkKSB7XHJcbiAgICB2YXIgcGF0aWVudHMgPSBkdC5nZXRQYXRpZXRMaXN0Rm9yU3RhbmRhcmQocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkKTtcclxuICAgIHJldHVybiBwYXRpZW50cy5sZW5ndGg7XHJcbiAgfSxcclxuXHJcbiAgZ2V0RGVub21pbmF0b3JGb3JTdGFuZGFyZDogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UpIHtcclxuICAgIHZhciBwYXRpZW50cyA9IGR0W3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5wYXRpZW50c09rO1xyXG4gICAgZm9yICh2YXIgc3RhbmRhcmQgaW4gZHRbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkcykge1xyXG4gICAgICB2YXIgbmV3UGF0aWVudHMgPSBkdC5nZXRQYXRpZXRMaXN0Rm9yU3RhbmRhcmQocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkKTtcclxuICAgICAgcGF0aWVudHMgPSBwYXRpZW50cy5jb25jYXQobmV3UGF0aWVudHMpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGR0LnJlbW92ZUR1cGxpY2F0ZXMocGF0aWVudHMpLmxlbmd0aDtcclxuICB9LFxyXG5cclxuICByZW1vdmVEdXBsaWNhdGVzOiBmdW5jdGlvbihhcnJheSkge1xyXG4gICAgdmFyIGFyclJlc3VsdCA9IHt9O1xyXG4gICAgdmFyIHJ0biA9IFtdO1xyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykge1xyXG4gICAgICBhcnJSZXN1bHRbYXJyYXlbaV1dID0gYXJyYXlbaV07XHJcbiAgICB9XHJcbiAgICBmb3IgKHZhciBpdGVtIGluIGFyclJlc3VsdCkge1xyXG4gICAgICBydG4ucHVzaChhcnJSZXN1bHRbaXRlbV0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJ0bjtcclxuICB9LFxyXG5cclxuICBudW1iZXJPZlN0YW5kYXJkc01pc3NlZDogZnVuY3Rpb24ocGF0aWVudElkKSB7XHJcbiAgICBpZiAoIWR0LnBhdGllbnRzW3BhdGllbnRJZF0uYnJlYWNoKSByZXR1cm4gMDtcclxuICAgIHZhciBhID0gZHQucGF0aWVudHNbcGF0aWVudElkXS5icmVhY2gubWFwKGZ1bmN0aW9uKHZhbCkge1xyXG4gICAgICByZXR1cm4gdmFsLnBhdGh3YXlJZCArIHZhbC5wYXRod2F5U3RhZ2UgKyB2YWwuc3RhbmRhcmQ7XHJcbiAgICB9KTtcclxuICAgIHZhciBvYmogPSB7fTtcclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYS5sZW5ndGg7IGkrKykge1xyXG4gICAgICBvYmpbYVtpXV0gPSBcIlwiO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKG9iaikubGVuZ3RoO1xyXG4gIH0sXHJcblxyXG4gIGdldEFsbFBhdGllbnRzOiBmdW5jdGlvbigpIHtcclxuICAgIHZhciBwTGlzdCA9IFtdLFxyXG4gICAgICBpLCBrLCBwcm9wO1xyXG4gICAgZm9yIChrID0gMDsgayA8IGR0LmRpc2Vhc2VzLmxlbmd0aDsgaysrKSB7XHJcbiAgICAgIGZvciAoaSBpbiBsb29rdXAuY2F0ZWdvcmllcykge1xyXG4gICAgICAgIGZvciAocHJvcCBpbiBkdFtkdC5kaXNlYXNlc1trXS5pZF1baV0uYmRvd24pIHtcclxuICAgICAgICAgIGlmIChkdFtkdC5kaXNlYXNlc1trXS5pZF1baV0uYmRvd24uaGFzT3duUHJvcGVydHkocHJvcCkpIHtcclxuICAgICAgICAgICAgcExpc3QgPSBwTGlzdC5jb25jYXQoZHRbZHQuZGlzZWFzZXNba10uaWRdW2ldLmJkb3duW3Byb3BdLnBhdGllbnRzKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcExpc3QgPSBwTGlzdC5jb25jYXQoZHRbZHQuZGlzZWFzZXNba10uaWRdW2ldLnBhdGllbnRzT2spO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBwTGlzdCA9IGR0LnJlbW92ZUR1cGxpY2F0ZXMocExpc3QpO1xyXG4gICAgdmFyIHBhdGllbnRzID0gcExpc3QubWFwKGZ1bmN0aW9uKHBhdGllbnRJZCkge1xyXG4gICAgICB2YXIgcmV0ID0gZHQucGF0aWVudHNbcGF0aWVudElkXTtcclxuICAgICAgcmV0Lm5oc051bWJlciA9IGR0LnBhdExvb2t1cCA/IGR0LnBhdExvb2t1cFtwYXRpZW50SWRdIDogcGF0aWVudElkO1xyXG4gICAgICByZXQucGF0aWVudElkID0gcGF0aWVudElkO1xyXG4gICAgICByZXQuaXRlbXMgPSBbXTsgLy9UaGUgZmllbGRzIGluIHRoZSBwYXRpZW50IGxpc3QgdGFibGVcclxuICAgICAgcmV0Lml0ZW1zLnB1c2goZHQubnVtYmVyT2ZTdGFuZGFyZHNNaXNzZWQocGF0aWVudElkKSk7XHJcbiAgICAgIHJldHVybiByZXQ7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gcGF0aWVudHM7XHJcbiAgfSxcclxuXHJcbiAgZ2V0OiBmdW5jdGlvbihjYWxsYmFjaywganNvbikge1xyXG4gICAgLy9nZXQgdGV4dFxyXG4gICAgJC5nZXRKU09OKFwiZGF0YS90ZXh0Lmpzb24/dj1cIiArIE1hdGgucmFuZG9tKCksIGZ1bmN0aW9uKHRleHRmaWxlKSB7XHJcbiAgICAgIGR0LnRleHQgPSB0ZXh0ZmlsZS5wYXRod2F5cztcclxuXHJcbiAgICAgIGlmIChqc29uKSB7XHJcbiAgICAgICAgZHQubmV3bG9hZChqc29uKTtcclxuICAgICAgICBpZiAodHlwZW9mIGNhbGxiYWNrID09PSAnZnVuY3Rpb24nKSBjYWxsYmFjaygpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgICQuZ2V0SlNPTihcImRhdGEvZGF0YS5qc29uP3Y9XCIgKyBNYXRoLnJhbmRvbSgpLCBmdW5jdGlvbihmaWxlKSB7XHJcbiAgICAgICAgICBkdC5uZXdsb2FkKGZpbGUpO1xyXG4gICAgICAgICAgaWYgKHR5cGVvZiBjYWxsYmFjayA9PT0gJ2Z1bmN0aW9uJykgY2FsbGJhY2soKTtcclxuICAgICAgICB9KS5mYWlsKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgYWxlcnQoXCJkYXRhL2RhdGEuanNvbiBmYWlsZWQgdG8gbG9hZCEhIC0gaWYgeW91J3ZlIGNoYW5nZWQgaXQgcmVjZW50bHkgY2hlY2sgaXQncyB2YWxpZCBqc29uIGF0IGpzb25saW50LmNvbVwiKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxuICAgIH0pLmZhaWwoZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgIGFsZXJ0KFwiZGF0YS90ZXh0Lmpzb24gZmFpbGVkIHRvIGxvYWQhISAtIGlmIHlvdSd2ZSBjaGFuZ2VkIGl0IHJlY2VudGx5IGNoZWNrIGl0J3MgdmFsaWQganNvbiBhdCBqc29ubGludC5jb21cIik7XHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICBuZXdsb2FkOiBmdW5jdGlvbihmaWxlKSB7XHJcbiAgICBkdC5pbmRpY2F0b3JzID0gZmlsZS5pbmRpY2F0b3JzO1xyXG4gICAgZHQucGF0aHdheU5hbWVzID0ge307XHJcblxyXG4gICAgZHQuaW5kaWNhdG9ycy5mb3JFYWNoKGZ1bmN0aW9uKGluZGljYXRvcikge1xyXG4gICAgICB2YXIgbGFzdCA9IGluZGljYXRvci52YWx1ZXNbMF0ubGVuZ3RoLTE7XHJcbiAgICAgIHZhciBwYXRod2F5SWQgPSBpbmRpY2F0b3IuaWQuc3BsaXQoXCIuXCIpWzBdO1xyXG4gICAgICB2YXIgcGF0aHdheVN0YWdlID0gaW5kaWNhdG9yLmlkLnNwbGl0KFwiLlwiKVsxXTtcclxuICAgICAgdmFyIHN0YW5kYXJkID0gaW5kaWNhdG9yLmlkLnNwbGl0KFwiLlwiKVsyXTtcclxuICAgICAgaWYgKCFkdC5wYXRod2F5TmFtZXNbcGF0aHdheUlkXSkgZHQucGF0aHdheU5hbWVzW3BhdGh3YXlJZF0gPSBcIlwiO1xyXG4gICAgICB2YXIgcGVyY2VudGFnZSA9IE1hdGgucm91bmQoMTAwICogaW5kaWNhdG9yLnZhbHVlc1sxXVtsYXN0XSAqIDEwMCAvIGluZGljYXRvci52YWx1ZXNbMl1bbGFzdF0pIC8gMTAwO1xyXG4gICAgICBpbmRpY2F0b3IucGVyZm9ybWFuY2UgPSB7XHJcbiAgICAgICAgZnJhY3Rpb246IGluZGljYXRvci52YWx1ZXNbMV1bbGFzdF0gKyBcIi9cIiArIGluZGljYXRvci52YWx1ZXNbMl1bbGFzdF0sXHJcbiAgICAgICAgcGVyY2VudGFnZTogcGVyY2VudGFnZVxyXG4gICAgICB9O1xyXG4gICAgICBpbmRpY2F0b3IuYmVuY2htYXJrID0gXCI5MCVcIjsgLy9UT0RPIG1hZ2ljIG51bWJlclxyXG4gICAgICBpbmRpY2F0b3IudGFyZ2V0ID0gaW5kaWNhdG9yLnZhbHVlc1szXVtsYXN0XSAqIDEwMCArIFwiJVwiO1xyXG4gICAgICBpbmRpY2F0b3IudXAgPSBwZXJjZW50YWdlID4gTWF0aC5yb3VuZCgxMDAgKiBpbmRpY2F0b3IudmFsdWVzWzFdW2xhc3QtMV0gKiAxMDAgLyBpbmRpY2F0b3IudmFsdWVzWzJdW2xhc3QtMV0pIC8gMTAwO1xyXG4gICAgICB2YXIgdHJlbmQgPSBpbmRpY2F0b3IudmFsdWVzWzFdLm1hcChmdW5jdGlvbih2YWwsIGlkeCkge1xyXG4gICAgICAgIHJldHVybiBNYXRoLnJvdW5kKDEwMCAqIHZhbCAqIDEwMCAvIGluZGljYXRvci52YWx1ZXNbMl1baWR4XSkgLyAxMDA7XHJcbiAgICAgIH0pLnNsaWNlKDEsIDEwKTtcclxuICAgICAgLy90cmVuZC5yZXZlcnNlKCk7XHJcbiAgICAgIGluZGljYXRvci50cmVuZCA9IHRyZW5kLmpvaW4oXCIsXCIpO1xyXG4gICAgICB2YXIgZGF0ZXMgPSBpbmRpY2F0b3IudmFsdWVzWzBdLnNsaWNlKE1hdGgubWF4KDEsbGFzdC0xMCksIDEwKTtcclxuICAgICAgLy9kYXRlcy5yZXZlcnNlKCk7XHJcbiAgICAgIGluZGljYXRvci5kYXRlcyA9IGRhdGVzO1xyXG4gICAgICBpZiAoZHQudGV4dFtwYXRod2F5SWRdICYmIGR0LnRleHRbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdICYmIGR0LnRleHRbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0pIHtcclxuICAgICAgICBpbmRpY2F0b3IuZGVzY3JpcHRpb24gPSBkdC50ZXh0W3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLmRlc2NyaXB0aW9uO1xyXG4gICAgICAgIGluZGljYXRvci50YWdsaW5lID0gZHQudGV4dFtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS50YWdsaW5lO1xyXG4gICAgICAgIGluZGljYXRvci5wb3NpdGl2ZU1lc3NhZ2UgPSBkdC50ZXh0W3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLnBvc2l0aXZlTWVzc2FnZTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBpbmRpY2F0b3IuZGVzY3JpcHRpb24gPSBcIk5vIGRlc2NyaXB0aW9uIHNwZWNpZmllZFwiO1xyXG4gICAgICAgIGluZGljYXRvci50YWdsaW5lID0gXCJcIjtcclxuICAgICAgfVxyXG4gICAgICBpbmRpY2F0b3IuYWJvdmVUYXJnZXQgPSBpbmRpY2F0b3IucGVyZm9ybWFuY2UucGVyY2VudGFnZSA+ICtpbmRpY2F0b3IudmFsdWVzWzNdW2xhc3RdKjEwMDtcclxuXHJcbiAgICAgIGR0LmluZGljYXRvcnNbaW5kaWNhdG9yLmlkXSA9IHsgcGVyZm9ybWFuY2U6IGluZGljYXRvci5wZXJmb3JtYW5jZSwgdGFnbGluZTogaW5kaWNhdG9yLnRhZ2xpbmUsIHBvc2l0aXZlTWVzc2FnZTogaW5kaWNhdG9yLnBvc2l0aXZlTWVzc2FnZSwgdGFyZ2V0OiBpbmRpY2F0b3IudGFyZ2V0LCBcIm9wcG9ydHVuaXRpZXNcIjogaW5kaWNhdG9yLm9wcG9ydHVuaXRpZXMgfHwgW10sIFwicGF0aWVudHNcIjoge30gfTtcclxuXHJcbiAgICAgIC8vYXBwbHkgd2hpY2ggY2F0ZWdvcmllcyBwZW9wbGUgYmVsb25nIHRvXHJcbiAgICAgIGR0LnBhdGllbnRzID0ge307XHJcbiAgICAgIGR0LnBhdGllbnRBcnJheSA9IFtdO1xyXG5cclxuICAgICAgT2JqZWN0LmtleXMoZmlsZS5wYXRpZW50cykuZm9yRWFjaChmdW5jdGlvbihwYXRpZW50KSB7XHJcbiAgICAgICAgZHQucGF0aWVudEFycmF5LnB1c2gocGF0aWVudCk7XHJcbiAgICAgICAgZHQucGF0aWVudHNbcGF0aWVudF0gPSBmaWxlLnBhdGllbnRzW3BhdGllbnRdO1xyXG4gICAgICAgIGR0LmluZGljYXRvcnNbaW5kaWNhdG9yLmlkXS5wYXRpZW50c1twYXRpZW50XSA9IHt9O1xyXG4gICAgICAgIGR0LmluZGljYXRvcnNbaW5kaWNhdG9yLmlkXS5wYXRpZW50c1twYXRpZW50XS5vcHBvcnR1bml0aWVzID0gW107XHJcbiAgICAgICAgZHQuaW5kaWNhdG9yc1tpbmRpY2F0b3IuaWRdLm9wcG9ydHVuaXRpZXMuZm9yRWFjaChmdW5jdGlvbihvcHAsIGlkeCkge1xyXG4gICAgICAgICAgaWYgKG9wcC5wYXRpZW50cy5pbmRleE9mKCtwYXRpZW50KSA+IC0xKSB7XHJcbiAgICAgICAgICAgIGR0LmluZGljYXRvcnNbaW5kaWNhdG9yLmlkXS5wYXRpZW50c1twYXRpZW50XS5vcHBvcnR1bml0aWVzLnB1c2goaWR4KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcblxyXG4gIH0sXHJcblxyXG4gIGxvYWQ6IGZ1bmN0aW9uKGZpbGUpIHtcclxuICAgIHZhciBkID0gXCJcIixcclxuICAgICAgaiwgaywga2V5LCBkYXRhID0gZmlsZS5kaXNlYXNlcztcclxuXHJcbiAgICBkdCA9IGpRdWVyeS5leHRlbmQoZHQsIGRhdGEpOyAvL2NvcHlcclxuXHJcbiAgICBkdC5wYXRpZW50cyA9IGZpbGUucGF0aWVudHM7XHJcbiAgICBkdC5jb2RlcyA9IGZpbGUuY29kZXM7XHJcbiAgICBkdC5wYXRpZW50QXJyYXkgPSBbXTtcclxuICAgIGZvciAodmFyIG8gaW4gZmlsZS5wYXRpZW50cykge1xyXG4gICAgICBpZiAoZmlsZS5wYXRpZW50cy5oYXNPd25Qcm9wZXJ0eShvKSkge1xyXG4gICAgICAgIGR0LnBhdGllbnRBcnJheS5wdXNoKG8pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZm9yIChkIGluIGRhdGEpIHtcclxuICAgICAgZHQucGF0aHdheU5hbWVzW2RdID0gZGF0YVtkXVtcImRpc3BsYXktbmFtZVwiXTtcclxuICAgICAgdmFyIGRpc2Vhc2VPYmplY3QgPSB7XHJcbiAgICAgICAgXCJpZFwiOiBkLFxyXG4gICAgICAgIFwibGlua1wiOiBkYXRhW2RdLmxpbmsgPyBkYXRhW2RdLmxpbmsgOiBcImR0L1wiICsgZCxcclxuICAgICAgICBcImZhSWNvblwiOiBkYXRhW2RdLmljb24sXHJcbiAgICAgICAgXCJuYW1lXCI6IGRhdGFbZF1bXCJkaXNwbGF5LW5hbWVcIl0sXHJcbiAgICAgICAgXCJ0ZXh0XCI6IHtcclxuICAgICAgICAgIFwiZHRcIjoge1xyXG4gICAgICAgICAgICBcInRvb2x0aXBcIjogZGF0YVtkXVtcInNpZGUtcGFuZWwtdG9vbHRpcFwiXVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfTtcclxuICAgICAgaWYgKGRhdGFbZF0ubW9uaXRvcmluZy50ZXh0KSB7XHJcbiAgICAgICAgZGlzZWFzZU9iamVjdC50ZXh0Lm1vbml0b3JpbmcgPSBkYXRhW2RdLm1vbml0b3JpbmcudGV4dC5zaWRlUGFuZWw7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGRhdGFbZF0udHJlYXRtZW50LnRleHQpIHtcclxuICAgICAgICBkaXNlYXNlT2JqZWN0LnRleHQudHJlYXRtZW50ID0gZGF0YVtkXS50cmVhdG1lbnQudGV4dC5zaWRlUGFuZWw7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGRhdGFbZF0uZGlhZ25vc2lzLnRleHQpIHtcclxuICAgICAgICBkaXNlYXNlT2JqZWN0LnRleHQuZGlhZ25vc2lzID0gZGF0YVtkXS5kaWFnbm9zaXMudGV4dC5zaWRlUGFuZWw7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGRhdGFbZF0uZXhjbHVzaW9ucy50ZXh0KSB7XHJcbiAgICAgICAgZGlzZWFzZU9iamVjdC50ZXh0LmV4Y2x1c2lvbnMgPSBkYXRhW2RdLmV4Y2x1c2lvbnMudGV4dC5zaWRlUGFuZWw7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5kaXNlYXNlcy5wdXNoKGRpc2Vhc2VPYmplY3QpO1xyXG4gICAgICBkdFtkXS5zdWdnZXN0aW9ucyA9IGxvZy5wbGFuW2RdLnRlYW07XHJcbiAgICAgICQuZXh0ZW5kKGR0W2RdLm1vbml0b3JpbmcsIHtcclxuICAgICAgICBcImJyZWFrZG93blwiOiBbXSxcclxuICAgICAgICBcImJkb3duXCI6IHt9XHJcbiAgICAgIH0pO1xyXG4gICAgICAkLmV4dGVuZChkdFtkXS50cmVhdG1lbnQsIHtcclxuICAgICAgICBcImJyZWFrZG93blwiOiBbXSxcclxuICAgICAgICBcImJkb3duXCI6IHt9XHJcbiAgICAgIH0pO1xyXG4gICAgICAkLmV4dGVuZChkdFtkXS5kaWFnbm9zaXMsIHtcclxuICAgICAgICBcImJyZWFrZG93blwiOiBbXSxcclxuICAgICAgICBcImJkb3duXCI6IHt9XHJcbiAgICAgIH0pO1xyXG4gICAgICAkLmV4dGVuZChkdFtkXS5leGNsdXNpb25zLCB7XHJcbiAgICAgICAgXCJicmVha2Rvd25cIjogW10sXHJcbiAgICAgICAgXCJiZG93blwiOiB7fVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGlmICghZHRbZF0ubW9uaXRvcmluZy5oZWFkZXIpIGNvbnRpbnVlO1xyXG4gICAgICBmb3IgKGtleSBpbiBkdFtkXS5tb25pdG9yaW5nLnN0YW5kYXJkcykge1xyXG4gICAgICAgIHRoaXMub3B0aW9ucy5wdXNoKHtcclxuICAgICAgICAgIFwidmFsdWVcIjogdGhpcy5vcHRpb25zLmxlbmd0aCxcclxuICAgICAgICAgIFwicGF0aHdheUlkXCI6IGQsXHJcbiAgICAgICAgICBcInBhdGh3YXlTdGFnZVwiOiBcIm1vbml0b3JpbmdcIixcclxuICAgICAgICAgIFwic3RhbmRhcmRcIjoga2V5LFxyXG4gICAgICAgICAgXCJ0ZXh0XCI6IHRoaXMucGF0aHdheU5hbWVzW2RdICsgJyAtICcgKyBcIk1vbml0b3JpbmdcIiArICcgLSAnICsgZHRbZF0ubW9uaXRvcmluZy5zdGFuZGFyZHNba2V5XS50YWIudGl0bGVcclxuICAgICAgICB9KTtcclxuICAgICAgICBmb3IgKGogPSAwOyBqIDwgZHRbZF0ubW9uaXRvcmluZy5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICBkdFtkXS5tb25pdG9yaW5nLmJkb3duW2R0W2RdLm1vbml0b3Jpbmcuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5uYW1lXSA9IGR0W2RdLm1vbml0b3Jpbmcuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXTtcclxuICAgICAgICAgIGR0W2RdLm1vbml0b3JpbmcuYmRvd25bZHRbZF0ubW9uaXRvcmluZy5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLm5hbWVdLnN1Z2dlc3Rpb25zID0gbG9nLnBsYW5bZF0ubW9uaXRvcmluZy5pbmRpdmlkdWFsW2R0W2RdLm1vbml0b3Jpbmcuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5uYW1lXTtcclxuICAgICAgICAgIGZvciAoayA9IDA7IGsgPCBkdFtkXS5tb25pdG9yaW5nLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ucGF0aWVudHMubGVuZ3RoOyBrKyspIHtcclxuICAgICAgICAgICAgaWYgKCFkdC5wYXRpZW50c1tkdFtkXS5tb25pdG9yaW5nLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ucGF0aWVudHNba11dLmJyZWFjaCkgZHQucGF0aWVudHNbZHRbZF0ubW9uaXRvcmluZy5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLnBhdGllbnRzW2tdXS5icmVhY2ggPSBbXTtcclxuICAgICAgICAgICAgZHQucGF0aWVudHNbZHRbZF0ubW9uaXRvcmluZy5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLnBhdGllbnRzW2tdXS5icmVhY2gucHVzaCh7XHJcbiAgICAgICAgICAgICAgXCJwYXRod2F5SWRcIjogZCxcclxuICAgICAgICAgICAgICBcInBhdGh3YXlTdGFnZVwiOiBcIm1vbml0b3JpbmdcIixcclxuICAgICAgICAgICAgICBcInN0YW5kYXJkXCI6IGtleSxcclxuICAgICAgICAgICAgICBcInN1YnNlY3Rpb25cIjogZHRbZF0ubW9uaXRvcmluZy5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLm5hbWVcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGZvciAoa2V5IGluIGR0W2RdLmRpYWdub3Npcy5zdGFuZGFyZHMpIHtcclxuICAgICAgICB0aGlzLm9wdGlvbnMucHVzaCh7XHJcbiAgICAgICAgICBcInZhbHVlXCI6IHRoaXMub3B0aW9ucy5sZW5ndGgsXHJcbiAgICAgICAgICBcInBhdGh3YXlJZFwiOiBkLFxyXG4gICAgICAgICAgXCJwYXRod2F5U3RhZ2VcIjogXCJkaWFnbm9zaXNcIixcclxuICAgICAgICAgIFwic3RhbmRhcmRcIjoga2V5LFxyXG4gICAgICAgICAgXCJ0ZXh0XCI6IHRoaXMucGF0aHdheU5hbWVzW2RdICsgJyAtICcgKyBcIkRpYWdub3Npc1wiICsgJyAtICcgKyBkdFtkXS5kaWFnbm9zaXMuc3RhbmRhcmRzW2tleV0udGFiLnRpdGxlXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgZm9yIChqID0gMDsgaiA8IGR0W2RdLmRpYWdub3Npcy5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICBkdFtkXS5kaWFnbm9zaXMuYmRvd25bZHRbZF0uZGlhZ25vc2lzLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ubmFtZV0gPSBkdFtkXS5kaWFnbm9zaXMuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXTtcclxuICAgICAgICAgIGR0W2RdLmRpYWdub3Npcy5iZG93bltkdFtkXS5kaWFnbm9zaXMuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5uYW1lXS5zdWdnZXN0aW9ucyA9IGxvZy5wbGFuW2RdLmRpYWdub3Npcy5pbmRpdmlkdWFsW2R0W2RdLmRpYWdub3Npcy5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLm5hbWVdO1xyXG4gICAgICAgICAgZm9yIChrID0gMDsgayA8IGR0W2RdLmRpYWdub3Npcy5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLnBhdGllbnRzLmxlbmd0aDsgaysrKSB7XHJcbiAgICAgICAgICAgIGlmICghZHQucGF0aWVudHNbZHRbZF0uZGlhZ25vc2lzLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ucGF0aWVudHNba11dLmJyZWFjaCkgZHQucGF0aWVudHNbZHRbZF0uZGlhZ25vc2lzLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ucGF0aWVudHNba11dLmJyZWFjaCA9IFtdO1xyXG4gICAgICAgICAgICBkdC5wYXRpZW50c1tkdFtkXS5kaWFnbm9zaXMuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5wYXRpZW50c1trXV0uYnJlYWNoLnB1c2goe1xyXG4gICAgICAgICAgICAgIFwicGF0aHdheUlkXCI6IGQsXHJcbiAgICAgICAgICAgICAgXCJwYXRod2F5U3RhZ2VcIjogXCJkaWFnbm9zaXNcIixcclxuICAgICAgICAgICAgICBcInN0YW5kYXJkXCI6IGtleSxcclxuICAgICAgICAgICAgICBcInN1YnNlY3Rpb25cIjogZHRbZF0uZGlhZ25vc2lzLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ubmFtZVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgZm9yIChrZXkgaW4gZHRbZF0udHJlYXRtZW50LnN0YW5kYXJkcykge1xyXG4gICAgICAgIHRoaXMub3B0aW9ucy5wdXNoKHtcclxuICAgICAgICAgIFwidmFsdWVcIjogdGhpcy5vcHRpb25zLmxlbmd0aCxcclxuICAgICAgICAgIFwicGF0aHdheUlkXCI6IGQsXHJcbiAgICAgICAgICBcInBhdGh3YXlTdGFnZVwiOiBcInRyZWF0bWVudFwiLFxyXG4gICAgICAgICAgXCJzdGFuZGFyZFwiOiBrZXksXHJcbiAgICAgICAgICBcInRleHRcIjogdGhpcy5wYXRod2F5TmFtZXNbZF0gKyAnIC0gJyArIFwiVHJlYXRtZW50XCIgKyAnIC0gJyArIGR0W2RdLnRyZWF0bWVudC5zdGFuZGFyZHNba2V5XS50YWIudGl0bGVcclxuICAgICAgICB9KTtcclxuICAgICAgICBmb3IgKGogPSAwOyBqIDwgZHRbZF0udHJlYXRtZW50LnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXMubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgIGR0W2RdLnRyZWF0bWVudC5iZG93bltkdFtkXS50cmVhdG1lbnQuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5uYW1lXSA9IGR0W2RdLnRyZWF0bWVudC5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdO1xyXG4gICAgICAgICAgZHRbZF0udHJlYXRtZW50LmJkb3duW2R0W2RdLnRyZWF0bWVudC5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLm5hbWVdLnN1Z2dlc3Rpb25zID0gbG9nLnBsYW5bZF0udHJlYXRtZW50LmluZGl2aWR1YWxbZHRbZF0udHJlYXRtZW50LnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ubmFtZV07XHJcbiAgICAgICAgICBmb3IgKGsgPSAwOyBrIDwgZHRbZF0udHJlYXRtZW50LnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ucGF0aWVudHMubGVuZ3RoOyBrKyspIHtcclxuICAgICAgICAgICAgaWYgKCFkdC5wYXRpZW50c1tkdFtkXS50cmVhdG1lbnQuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5wYXRpZW50c1trXV0uYnJlYWNoKSBkdC5wYXRpZW50c1tkdFtkXS50cmVhdG1lbnQuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5wYXRpZW50c1trXV0uYnJlYWNoID0gW107XHJcbiAgICAgICAgICAgIGR0LnBhdGllbnRzW2R0W2RdLnRyZWF0bWVudC5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLnBhdGllbnRzW2tdXS5icmVhY2gucHVzaCh7XHJcbiAgICAgICAgICAgICAgXCJwYXRod2F5SWRcIjogZCxcclxuICAgICAgICAgICAgICBcInBhdGh3YXlTdGFnZVwiOiBcInRyZWF0bWVudFwiLFxyXG4gICAgICAgICAgICAgIFwic3RhbmRhcmRcIjoga2V5LFxyXG4gICAgICAgICAgICAgIFwic3Vic2VjdGlvblwiOiBkdFtkXS50cmVhdG1lbnQuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5uYW1lXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBmb3IgKGtleSBpbiBkdFtkXS5leGNsdXNpb25zLnN0YW5kYXJkcykge1xyXG4gICAgICAgIHRoaXMub3B0aW9ucy5wdXNoKHtcclxuICAgICAgICAgIFwidmFsdWVcIjogdGhpcy5vcHRpb25zLmxlbmd0aCxcclxuICAgICAgICAgIFwicGF0aHdheUlkXCI6IGQsXHJcbiAgICAgICAgICBcInBhdGh3YXlTdGFnZVwiOiBcImV4Y2x1c2lvbnNcIixcclxuICAgICAgICAgIFwic3RhbmRhcmRcIjoga2V5LFxyXG4gICAgICAgICAgXCJ0ZXh0XCI6IHRoaXMucGF0aHdheU5hbWVzW2RdICsgJyAtICcgKyBcIkV4Y2x1c2lvbnNcIiArICcgLSAnICsgZHRbZF0uZXhjbHVzaW9ucy5zdGFuZGFyZHNba2V5XS50YWIudGl0bGVcclxuICAgICAgICB9KTtcclxuICAgICAgICBmb3IgKGogPSAwOyBqIDwgZHRbZF0uZXhjbHVzaW9ucy5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICBkdFtkXS5leGNsdXNpb25zLmJkb3duW2R0W2RdLmV4Y2x1c2lvbnMuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5uYW1lXSA9IGR0W2RdLmV4Y2x1c2lvbnMuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXTtcclxuICAgICAgICAgIGR0W2RdLmV4Y2x1c2lvbnMuYmRvd25bZHRbZF0uZXhjbHVzaW9ucy5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLm5hbWVdLnN1Z2dlc3Rpb25zID0gbG9nLnBsYW5bZF0uZXhjbHVzaW9ucy5pbmRpdmlkdWFsW2R0W2RdLmV4Y2x1c2lvbnMuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5uYW1lXTtcclxuICAgICAgICAgIGZvciAoayA9IDA7IGsgPCBkdFtkXS5leGNsdXNpb25zLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ucGF0aWVudHMubGVuZ3RoOyBrKyspIHtcclxuICAgICAgICAgICAgaWYgKCFkdC5wYXRpZW50c1tkdFtkXS5leGNsdXNpb25zLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ucGF0aWVudHNba11dLmJyZWFjaCkgZHQucGF0aWVudHNbZHRbZF0uZXhjbHVzaW9ucy5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLnBhdGllbnRzW2tdXS5icmVhY2ggPSBbXTtcclxuICAgICAgICAgICAgZHQucGF0aWVudHNbZHRbZF0uZXhjbHVzaW9ucy5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLnBhdGllbnRzW2tdXS5icmVhY2gucHVzaCh7XHJcbiAgICAgICAgICAgICAgXCJwYXRod2F5SWRcIjogZCxcclxuICAgICAgICAgICAgICBcInBhdGh3YXlTdGFnZVwiOiBcImV4Y2x1c2lvbnNcIixcclxuICAgICAgICAgICAgICBcInN0YW5kYXJkXCI6IGtleSxcclxuICAgICAgICAgICAgICBcInN1YnNlY3Rpb25cIjogZHRbZF0uZXhjbHVzaW9ucy5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLm5hbWVcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSxcclxuXHJcbiAgZ2V0QWxsSW5kaWNhdG9yRGF0YTogZnVuY3Rpb24oY2FsbGJhY2spIHtcclxuICAgIGlmIChkdC5pbmRpY2F0b3JzKSB7XHJcbiAgICAgIHJldHVybiBjYWxsYmFjayhkdC5pbmRpY2F0b3JzKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIF9nZXRBbGxJbmRpY2F0b3JEYXRhKGNhbGxiYWNrKTtcclxuICAgIH1cclxuICB9LFxyXG5cclxuICBnZXRBbGxJbmRpY2F0b3JEYXRhU3luYzogZnVuY3Rpb24oKSB7XHJcbiAgICBpZiAoZHQuaW5kaWNhdG9ycykge1xyXG4gICAgICByZXR1cm4gZHQuaW5kaWNhdG9ycztcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiBfZ2V0QWxsSW5kaWNhdG9yRGF0YVN5bmMoKTtcclxuICAgIH1cclxuICB9LFxyXG5cclxuICBnZXRJbmRpY2F0b3JEYXRhOiBmdW5jdGlvbihpbmRpY2F0b3IsIGNhbGxiYWNrKSB7XHJcbiAgICBpZiAoIWR0LmluZGljYXRvcnMpIHtcclxuICAgICAgX2dldEFsbEluZGljYXRvckRhdGEoZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgIF9nZXRJbmRpY2F0b3JEYXRhKGluZGljYXRvciwgY2FsbGJhY2spO1xyXG4gICAgICB9KTtcclxuICAgIH0gZWxzZSBpZiAoZHQuaW5kaWNhdG9ycyAmJiBkdC5pbmRpY2F0b3JzW2luZGljYXRvcl0pIHtcclxuICAgICAgcmV0dXJuIGNhbGxiYWNrKGR0LmluZGljYXRvcnNbaW5kaWNhdG9yXSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBfZ2V0SW5kaWNhdG9yRGF0YShpbmRpY2F0b3IsIGNhbGxiYWNrKTtcclxuICAgIH1cclxuICB9LFxyXG5cclxuICBnZXRJbmRpY2F0b3JEYXRhU3luYzogZnVuY3Rpb24oaW5kaWNhdG9yKSB7XHJcbiAgICBkdC5nZXRBbGxJbmRpY2F0b3JEYXRhU3luYygpO1xyXG4gICAgaWYgKGR0LmluZGljYXRvcnNbaW5kaWNhdG9yXSkge1xyXG4gICAgICByZXR1cm4gZHQuaW5kaWNhdG9yc1tpbmRpY2F0b3JdO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIF9nZXRJbmRpY2F0b3JEYXRhU3luYyhpbmRpY2F0b3IpO1xyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIGdldFBhdGllbnREYXRhOiBmdW5jdGlvbihwYXRpZW50SWQsIGNhbGxiYWNrKSB7XHJcbiAgICByZXR1cm4gX2dldFBhdGllbnREYXRhKHBhdGllbnRJZCwgY2FsbGJhY2spO1xyXG4gIH1cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGR0O1xyXG4iLCJ2YXIgZGF0YSA9IHJlcXVpcmUoJy4vZGF0YS5qcycpLFxyXG5NdXN0YWNoZSA9IHJlcXVpcmUoJ211c3RhY2hlJyk7XHJcblxyXG52YXIgbGF5b3V0ID0ge1xyXG5cclxuICBlbGVtZW50czoge30sXHJcblxyXG4gIC8vU2lkZSBwYW5lbCwgbmF2aWdhdGlvbiwgaGVhZGVyIGJhciBhbmQgbWFpbiBwYWdlXHJcbiAgc2hvd01haW5WaWV3OiBmdW5jdGlvbigpIHtcclxuICAgIC8vU2V0IHVwIG5hdmlnYXRpb24gcGFuZWxcclxuICAgIC8vLy9sYXlvdXQuc2hvd1NpZGVQYW5lbCgpO1xyXG4gICAgLy8vL2xheW91dC5zaG93TmF2aWdhdGlvbihkYXRhLmRpc2Vhc2VzLCBpZHgsICQoJyNtYWluLWRhc2hib2FyZCcpKTtcclxuXHJcbiAgICAkKCcjYm90dG9tbmF2YmFyJykuaGlkZSgpO1xyXG4gICAgbGF5b3V0LnNob3dIZWFkZXJCYXJJdGVtcygpO1xyXG5cclxuICAgIC8vU2hvdyBtYWluIGRhc2hib2FyZCBwYWdlXHJcbiAgICBsYXlvdXQuc2hvd1BhZ2UoJ21haW4tZGFzaGJvYXJkJyk7XHJcbiAgfSxcclxuXHJcbiAgY2xlYXJOYXZpZ2F0aW9uOiBmdW5jdGlvbigpIHtcclxuICAgICQoXCJhc2lkZS5sZWZ0LXBhbmVsIG5hdi5uYXZpZ2F0aW9uID4gdWwgPiBsaSA+IHVsXCIpLnNsaWRlVXAoMzAwKTtcclxuICAgICQoXCJhc2lkZS5sZWZ0LXBhbmVsIG5hdi5uYXZpZ2F0aW9uID4gdWwgPiBsaVwiKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgfSxcclxuXHJcbiAgc2hvd05hdmlnYXRpb246IGZ1bmN0aW9uKGxpc3QsIGlkeCwgcGFyZW50KSB7XHJcbiAgICBpZiAobGF5b3V0LmVsZW1lbnRzLm5hdmlnYXRpb24pIHtcclxuXHJcbiAgICAgIGlmIChpZHggPT09IC0xKSB7XHJcbiAgICAgICAgbGF5b3V0LmNsZWFyTmF2aWdhdGlvbigpO1xyXG4gICAgICAgICQoJ2FzaWRlIGFbaHJlZj1cIiN3ZWxjb21lXCJdOmZpcnN0JykuY2xvc2VzdCgnbGknKS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgIH0gZWxzZSBpZiAoaWR4ID49IGxpc3QubGVuZ3RoKSB7XHJcbiAgICAgICAgbGF5b3V0LmNsZWFyTmF2aWdhdGlvbigpO1xyXG4gICAgICAgICQoJ2FzaWRlIGFbaHJlZj1cIiNwYXRpZW50c1wiXScpLmNsb3Nlc3QoJ2xpJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICB9IGVsc2UgaWYgKCEkKCdhc2lkZSBhW2hyZWY9XCIjJyArIGxpc3RbaWR4XS5saW5rICsgJ1wiXTpmaXJzdCcpLmNsb3Nlc3QoJ2xpJykuaGFzQ2xhc3MoJ2FjdGl2ZScpKSB7XHJcbiAgICAgICAgbGF5b3V0LmNsZWFyTmF2aWdhdGlvbigpO1xyXG4gICAgICAgIC8vc2V0IGFjdGl2ZVxyXG4gICAgICAgICQoJ2FzaWRlIGFbaHJlZj1cIiMnICsgbGlzdFtpZHhdLmxpbmsgKyAnXCJdJykubmV4dCgpLnNsaWRlVG9nZ2xlKDMwMCk7XHJcbiAgICAgICAgJCgnYXNpZGUgYVtocmVmPVwiIycgKyBsaXN0W2lkeF0ubGluayArICdcIl0nKS5jbG9zZXN0KCdsaScpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIHZhciB0ZW1wTXVzdCA9ICQoJyNwYXRod2F5LXBpY2tlcicpLmh0bWwoKTtcclxuICAgIHZhciBpdGVtVGVtcGxhdGUgPSAkKCcjcGF0aHdheS1waWNrZXItaXRlbScpLmh0bWwoKTtcclxuICAgIE11c3RhY2hlLnBhcnNlKHRlbXBNdXN0KTtcclxuICAgIE11c3RhY2hlLnBhcnNlKGl0ZW1UZW1wbGF0ZSk7XHJcblxyXG4gICAgbGlzdCA9IGxpc3Quc2xpY2UoKTtcclxuICAgIGxpc3RbMF0uaXNCcmVha0Fib3ZlUHJhY3RpY2UgPSB0cnVlO1xyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIGxpc3RbaV0uaGFzU3ViSXRlbXMgPSB0cnVlO1xyXG4gICAgfVxyXG4gICAgbGlzdC51bnNoaWZ0KHtcclxuICAgICAgXCJsaW5rXCI6IFwid2VsY29tZVwiLFxyXG4gICAgICBcImZhSWNvblwiOiBcImZhLWhvbWVcIixcclxuICAgICAgXCJuYW1lXCI6IFwiQWdyZWVkIGFjdGlvbnNcIixcclxuICAgICAgXCJpc0JyZWFrQWJvdmVIb21lXCI6IHRydWUsXHJcbiAgICAgIFwidGV4dFwiOiB7XHJcbiAgICAgICAgXCJtYWluXCI6IHtcclxuICAgICAgICAgIFwidG9vbHRpcFwiOiBcIkFncmVlZCB0b29sdGlwIC0gZWRpdCBpbiBzY3JpcHQuanNcIlxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBsaXN0LnB1c2goe1xyXG4gICAgICBcImxpbmtcIjogXCJwYXRpZW50c1wiLFxyXG4gICAgICBcImZhSWNvblwiOiBcImZhLXVzZXJzXCIsXHJcbiAgICAgIFwibmFtZVwiOiBcIkFsbCBQYXRpZW50c1wiLFxyXG4gICAgICBcImlzQnJlYWtBYm92ZVBhdGllbnRcIjogdHJ1ZSxcclxuICAgICAgXCJ0ZXh0XCI6IHtcclxuICAgICAgICBcIm1haW5cIjoge1xyXG4gICAgICAgICAgXCJ0b29sdGlwXCI6IFwiQWxsIHBhdGllbnRzIHRvb2x0aXAgLSBlZGl0IGluIHNjcmlwdC5qc1wiXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBsaXN0Lm1hcChmdW5jdGlvbih2LCBpLCBhcnIpIHtcclxuICAgICAgdi5pc1NlbGVjdGVkID0gaSA9PT0gaWR4ICsgMTtcclxuICAgICAgcmV0dXJuIHY7XHJcbiAgICB9KTtcclxuXHJcbiAgICB2YXIgcmVuZGVyZWRCZWZvcmUgPSBNdXN0YWNoZS5yZW5kZXIodGVtcE11c3QsIHtcclxuICAgICAgXCJpdGVtc1wiOiBsaXN0XHJcbiAgICB9LCB7XHJcbiAgICAgIFwiaXRlbVwiOiBpdGVtVGVtcGxhdGUsXHJcbiAgICAgIFwic3ViSXRlbVwiOiAkKCcjcGF0aHdheS1waWNrZXItc3ViLWl0ZW0nKS5odG1sKClcclxuICAgIH0pO1xyXG4gICAgJCgnI2FzaWRlLXRvZ2dsZSBuYXY6Zmlyc3QnKS5odG1sKHJlbmRlcmVkQmVmb3JlKTtcclxuXHJcbiAgICAkKCcudXNlcicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICB0ZW1wbGF0ZS5sb2FkQ29udGVudCgnI2FncmVlZGFjdGlvbnMnKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGxheW91dC5lbGVtZW50cy5uYXZpZ2F0aW9uID0gdHJ1ZTtcclxuICB9LFxyXG5cclxuICBzaG93UGFnZTogZnVuY3Rpb24ocGFnZSkge1xyXG4gICAgaWYgKGxheW91dC5wYWdlID09PSBwYWdlKSByZXR1cm47XHJcbiAgICBsYXlvdXQucGFnZSA9IHBhZ2U7XHJcbiAgICAkKCcucGFnZScpLmhpZGUoKTtcclxuICAgICQoJyMnICsgcGFnZSkuc2hvdygpO1xyXG5cclxuICAgIGlmIChwYWdlICE9PSAnbWFpbi1kYXNoYm9hcmQnKSB7XHJcbiAgICAgIC8vLy9sYXlvdXQuaGlkZVNpZGVQYW5lbCgpO1xyXG4gICAgICAkKCcjYm90dG9tbmF2YmFyJykuc2hvdygpO1xyXG4gICAgICBsYXlvdXQuaGlkZUhlYWRlckJhckl0ZW1zKCk7XHJcbiAgICB9XHJcbiAgfSxcclxuXHJcbiAgc2hvd1NpZGVQYW5lbDogZnVuY3Rpb24oKSB7XHJcbiAgICBpZiAobGF5b3V0LmVsZW1lbnRzLm5hdmlndGlvbikgcmV0dXJuO1xyXG4gICAgbGF5b3V0LmVsZW1lbnRzLm5hdmlndGlvbiA9IHRydWU7XHJcbiAgICAkKCcjbWFpbicpLmFkZENsYXNzKCdjb250ZW50Jyk7XHJcbiAgICAkKCcjdG9wbmF2YmFyJykuYWRkQ2xhc3MoJ2Z1bGwnKTtcclxuICAgICQoJyNhc2lkZS10b2dnbGUnKS5zaG93KCk7XHJcbiAgICAkKCcjYm90dG9tbmF2YmFyJykuaGlkZSgpO1xyXG4gIH0sXHJcblxyXG4gIGhpZGVTaWRlUGFuZWw6IGZ1bmN0aW9uKCkge1xyXG4gICAgaWYgKGxheW91dC5lbGVtZW50cy5uYXZpZ3Rpb24gPT09IGZhbHNlKSByZXR1cm47XHJcbiAgICBsYXlvdXQuZWxlbWVudHMubmF2aWd0aW9uID0gZmFsc2U7XHJcbiAgICAkKCcjbWFpbicpLnJlbW92ZUNsYXNzKCdjb250ZW50Jyk7XHJcbiAgICAkKCcjdG9wbmF2YmFyJykucmVtb3ZlQ2xhc3MoJ2Z1bGwnKTtcclxuICAgICQoJyNhc2lkZS10b2dnbGUnKS5oaWRlKCk7XHJcbiAgICAkKCcjYm90dG9tbmF2YmFyJykuc2hvdygpO1xyXG4gIH0sXHJcblxyXG4gIHNob3dIZWFkZXJCYXJJdGVtczogZnVuY3Rpb24oKSB7XHJcbiAgICBpZiAobGF5b3V0LmVsZW1lbnRzLmhlYWRlcmJhcikgcmV0dXJuO1xyXG4gICAgbGF5b3V0LmVsZW1lbnRzLmhlYWRlcmJhciA9IHRydWU7XHJcbiAgICAkKCcuaGlkZS1pZi1sb2dnZWQtb3V0Jykuc2hvdygpO1xyXG4gIH0sXHJcblxyXG4gIGhpZGVIZWFkZXJCYXJJdGVtczogZnVuY3Rpb24oKSB7XHJcbiAgICBpZiAobGF5b3V0LmVsZW1lbnRzLmhlYWRlcmJhciA9PT0gZmFsc2UpIHJldHVybjtcclxuICAgIGxheW91dC5lbGVtZW50cy5oZWFkZXJiYXIgPSBmYWxzZTtcclxuICAgICQoJy5oaWRlLWlmLWxvZ2dlZC1vdXQnKS5oaWRlKCk7XHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gbGF5b3V0O1xyXG4iLCJ2YXIgbm90aWZ5ID0gcmVxdWlyZSgnLi9ub3RpZnkuanMnKTtcclxuXHJcbnZhciBsb2cgPSB7XHJcbiAgcmVhc29uOiB7fSxcclxuXHJcbiAgZ2V0T2JqOiBmdW5jdGlvbihvcHRpb25zKSB7XHJcbiAgICB2YXIgb2JqID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuYmIpO1xyXG5cclxuICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnMubGVuZ3RoID4gMCkge1xyXG4gICAgICBvcHRpb25zLmZvckVhY2goZnVuY3Rpb24ob3B0KSB7XHJcbiAgICAgICAgaWYgKCFvYmpbb3B0Lm5hbWVdKSB7XHJcbiAgICAgICAgICBvYmpbb3B0Lm5hbWVdID0gb3B0LnZhbHVlO1xyXG4gICAgICAgICAgbG9nLnNldE9iaihvYmopO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIG9iajtcclxuICB9LFxyXG5cclxuICBzZXRPYmo6IGZ1bmN0aW9uKG9iaikge1xyXG4gICAgbG9jYWxTdG9yYWdlLmJiID0gSlNPTi5zdHJpbmdpZnkob2JqKTtcclxuICB9LFxyXG5cclxuICBsb2FkQWN0aW9uczogZnVuY3Rpb24oY2FsbGJhY2spIHtcclxuICAgIHZhciByID0gTWF0aC5yYW5kb20oKTtcclxuICAgICQuZ2V0SlNPTihcImFjdGlvbi1wbGFuLmpzb24/dj1cIiArIHIsIGZ1bmN0aW9uKGZpbGUpIHtcclxuICAgICAgbG9nLnBsYW4gPSBmaWxlLmRpc2Vhc2VzO1xyXG4gICAgICBsb2cudGV4dCA9IGZpbGUucGxhbnM7XHJcbiAgICAgIGNhbGxiYWNrKCk7XHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICBlZGl0QWN0aW9uOiBmdW5jdGlvbihpZCwgYWN0aW9uSWQsIGFncmVlLCBkb25lLCByZWFzb24pIHtcclxuICAgIHZhciBsb2dUZXh0LCBvYmogPSBsb2cuZ2V0T2JqKFt7XHJcbiAgICAgIG5hbWU6IFwiYWN0aW9uc1wiLFxyXG4gICAgICB2YWx1ZToge31cclxuICAgIH1dKTtcclxuICAgIGlmICghaWQpIGFsZXJ0KFwiQUNUSU9OIFRFQU0vSU5EIElEXCIpO1xyXG4gICAgaWYgKCFhY3Rpb25JZCkgYWxlcnQoXCJBQ1RJT04gSURcIik7XHJcblxyXG4gICAgaWYgKCFvYmouYWN0aW9uc1tpZF0pIHtcclxuICAgICAgb2JqLmFjdGlvbnNbaWRdID0ge307XHJcbiAgICB9XHJcblxyXG5cclxuICAgIGlmIChhZ3JlZSkge1xyXG4gICAgICBsb2dUZXh0ID0gXCJZb3UgYWdyZWVkIHdpdGggdGhpcyBzdWdnZXN0ZWQgYWN0aW9uIG9uIFwiICsgKG5ldyBEYXRlKCkpLnRvRGF0ZVN0cmluZygpO1xyXG4gICAgfSBlbHNlIGlmIChhZ3JlZSA9PT0gZmFsc2UpIHtcclxuICAgICAgdmFyIHJlYXNvblRleHQgPSBsb2cucmVhc29uLnJlYXNvbiA9PT0gXCJcIiAmJiBsb2cucmVhc29uLnJlYXNvblRleHQgPT09IFwiXCIgPyBcIiAtIG5vIHJlYXNvbiBnaXZlblwiIDogXCIgLiBZb3UgZGlzYWdyZWVkIGJlY2F1c2UgeW91IHNhaWQ6ICdcIiArIGxvZy5yZWFzb24ucmVhc29uICsgXCI7IFwiICsgbG9nLnJlYXNvbi5yZWFzb25UZXh0ICsgXCIuJ1wiO1xyXG4gICAgICBsb2dUZXh0ID0gXCJZb3UgZGlzYWdyZWVkIHdpdGggdGhpcyBhY3Rpb24gb24gXCIgKyAobmV3IERhdGUoKSkudG9EYXRlU3RyaW5nKCkgKyByZWFzb25UZXh0O1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChkb25lKSB7XHJcbiAgICAgIGxvZ1RleHQgPSBcIllvdSBhZ3JlZWQgd2l0aCB0aGlzIHN1Z2dlc3RlZCBhY3Rpb24gb24gXCIgKyAobmV3IERhdGUoKSkudG9EYXRlU3RyaW5nKCk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCFvYmouYWN0aW9uc1tpZF1bYWN0aW9uSWRdKSB7XHJcbiAgICAgIG9iai5hY3Rpb25zW2lkXVthY3Rpb25JZF0gPSB7XHJcbiAgICAgICAgXCJhZ3JlZVwiOiBhZ3JlZSA/IGFncmVlIDogZmFsc2UsXHJcbiAgICAgICAgXCJkb25lXCI6IGRvbmUgPyBkb25lIDogZmFsc2UsXHJcbiAgICAgICAgXCJoaXN0b3J5XCI6IFtsb2dUZXh0XVxyXG4gICAgICB9O1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaWYgKGFncmVlID09PSB0cnVlIHx8IGFncmVlID09PSBmYWxzZSkgb2JqLmFjdGlvbnNbaWRdW2FjdGlvbklkXS5hZ3JlZSA9IGFncmVlO1xyXG4gICAgICBpZiAoZG9uZSA9PT0gdHJ1ZSB8fCBkb25lID09PSBmYWxzZSkgb2JqLmFjdGlvbnNbaWRdW2FjdGlvbklkXS5kb25lID0gZG9uZTtcclxuICAgICAgaWYgKGxvZ1RleHQpIHtcclxuICAgICAgICBpZiAob2JqLmFjdGlvbnNbaWRdW2FjdGlvbklkXS5oaXN0b3J5KSBvYmouYWN0aW9uc1tpZF1bYWN0aW9uSWRdLmhpc3RvcnkudW5zaGlmdChsb2dUZXh0KTtcclxuICAgICAgICBlbHNlIG9iai5hY3Rpb25zW2lkXVthY3Rpb25JZF0uZG9uZS5oaXN0b3J5ID0gW2xvZ1RleHRdO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHJlYXNvbiAmJiBvYmouYWN0aW9uc1tpZF1bYWN0aW9uSWRdLmFncmVlID09PSBmYWxzZSkge1xyXG4gICAgICBvYmouYWN0aW9uc1tpZF1bYWN0aW9uSWRdLnJlYXNvbiA9IHJlYXNvbjtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGRlbGV0ZSBvYmouYWN0aW9uc1tpZF1bYWN0aW9uSWRdLnJlYXNvbjtcclxuICAgIH1cclxuXHJcbiAgICBsb2cuc2V0T2JqKG9iaik7XHJcbiAgICBub3RpZnkuc2hvd1NhdmVkKCk7XHJcbiAgfSxcclxuXHJcbiAgaWdub3JlQWN0aW9uOiBmdW5jdGlvbihpZCwgYWN0aW9uSWQpIHtcclxuICAgIHZhciBvYmogPSBsb2cuZ2V0T2JqKFt7XHJcbiAgICAgIG5hbWU6IFwiYWN0aW9uc1wiLFxyXG4gICAgICB2YWx1ZToge31cclxuICAgIH1dKTtcclxuICAgIG9iai5hY3Rpb25zW2lkXVthY3Rpb25JZF0uYWdyZWUgPSBudWxsO1xyXG4gICAgZGVsZXRlIG9iai5hY3Rpb25zW2lkXVthY3Rpb25JZF0ucmVhc29uO1xyXG4gICAgbG9nLnNldE9iaihvYmopO1xyXG4gIH0sXHJcblxyXG4gIGdldEFjdGlvbnM6IGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIGxvZy5nZXRPYmooW3tcclxuICAgICAgbmFtZTogXCJhY3Rpb25zXCIsXHJcbiAgICAgIHZhbHVlOiB7fVxyXG4gICAgfV0pLmFjdGlvbnM7XHJcbiAgfSxcclxuXHJcbiAgbGlzdEFjdGlvbnM6IGZ1bmN0aW9uKGlkLCBwYXRod2F5SWQpIHtcclxuICAgIHZhciBvYmogPSBsb2cuZ2V0T2JqKFt7XHJcbiAgICAgIG5hbWU6IFwiYWN0aW9uc1wiLFxyXG4gICAgICB2YWx1ZToge31cclxuICAgIH1dKTtcclxuICAgIGFyciA9IFtdO1xyXG4gICAgaWYgKCFpZCkgcmV0dXJuIG9iai5hY3Rpb25zO1xyXG4gICAgaWYgKCFvYmouYWN0aW9uc1tpZF0pIHJldHVybiBhcnI7XHJcbiAgICBmb3IgKHZhciBwcm9wIGluIG9iai5hY3Rpb25zW2lkXSkge1xyXG4gICAgICBvYmouYWN0aW9uc1tpZF1bcHJvcF0uaWQgPSBwcm9wO1xyXG4gICAgICBpZiAoIW9iai5hY3Rpb25zW2lkXVtwcm9wXS50ZXh0KVxyXG4gICAgICAgIGFyci5wdXNoKG9iai5hY3Rpb25zW2lkXVtwcm9wXSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYXJyO1xyXG4gIH0sXHJcblxyXG4gIC8vaWQgaXMgZWl0aGVyIFwidGVhbVwiIG9yIHRoZSBwYXRpZW50SWRcclxuICByZWNvcmRGZWVkYmFjazogZnVuY3Rpb24ocGF0aHdheUlkLCBpZCwgc3VnZ2VzdGlvbiwgcmVhc29uLCByZWFzb25UZXh0KSB7XHJcbiAgICBsb2cucmVhc29uID0ge1xyXG4gICAgICBcInJlYXNvblwiOiByZWFzb24sXHJcbiAgICAgIFwicmVhc29uVGV4dFwiOiByZWFzb25UZXh0XHJcbiAgICB9O1xyXG4gICAgdmFyIG9iaiA9IGxvZy5nZXRPYmooW3tcclxuICAgICAgbmFtZTogXCJmZWVkYmFja1wiLFxyXG4gICAgICB2YWx1ZTogW11cclxuICAgIH1dKTtcclxuXHJcbiAgICB2YXIgaXRlbSA9IHtcclxuICAgICAgXCJwYXRod2F5SWRcIjogcGF0aHdheUlkLFxyXG4gICAgICBcImlkXCI6IGlkLFxyXG4gICAgICBcInZhbFwiOiBzdWdnZXN0aW9uXHJcbiAgICB9O1xyXG4gICAgaWYgKHJlYXNvblRleHQgIT09IFwiXCIpIGl0ZW0ucmVhc29uVGV4dCA9IHJlYXNvblRleHQ7XHJcbiAgICBpZiAocmVhc29uICE9PSBcIlwiKSBpdGVtLnJlYXNvbiA9IHJlYXNvbjtcclxuICAgIG9iai5mZWVkYmFjay5wdXNoKGl0ZW0pO1xyXG4gICAgbG9nLnNldE9iaihvYmopO1xyXG4gIH0sXHJcblxyXG4gIGdldEV2ZW50czogZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4gbG9nLmdldE9iaihbe1xyXG4gICAgICBuYW1lOiBcImV2ZW50c1wiLFxyXG4gICAgICB2YWx1ZTogW11cclxuICAgIH1dKS5ldmVudHM7XHJcbiAgfSxcclxuXHJcbiAgcmVjb3JkRXZlbnQ6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgaWQsIG5hbWUpIHtcclxuICAgIHZhciBvYmogPSBsb2cuZ2V0T2JqKFt7XHJcbiAgICAgIG5hbWU6IFwiZXZlbnRzXCIsXHJcbiAgICAgIHZhbHVlOiBbXVxyXG4gICAgfV0pO1xyXG4gICAgb2JqLmV2ZW50cy5wdXNoKHtcclxuICAgICAgXCJwYXRod2F5SWRcIjogcGF0aHdheUlkLFxyXG4gICAgICBcImlkXCI6IGlkLFxyXG4gICAgICBcIm5hbWVcIjogbmFtZSxcclxuICAgICAgXCJkYXRlXCI6IG5ldyBEYXRlKClcclxuICAgIH0pO1xyXG4gICAgbG9nLnNldE9iaihvYmopO1xyXG4gIH0sXHJcblxyXG4gIHJlY29yZFBsYW46IGZ1bmN0aW9uKGlkLCB0ZXh0LCBwYXRod2F5SWQpIHtcclxuICAgIGlmICghaWQpIGFsZXJ0KFwiUExBTlwiKTtcclxuICAgIHZhciBvYmogPSBsb2cuZ2V0T2JqKFt7XHJcbiAgICAgIG5hbWU6IFwiYWN0aW9uc1wiLFxyXG4gICAgICB2YWx1ZToge31cclxuICAgIH1dKTtcclxuXHJcbiAgICBpZiAoIW9iai5hY3Rpb25zW2lkXSkgb2JqLmFjdGlvbnNbaWRdID0ge307XHJcbiAgICB2YXIgcGxhbklkID0gRGF0ZS5ub3coKSArIFwiXCI7XHJcbiAgICBvYmouYWN0aW9uc1tpZF1bcGxhbklkXSA9IHtcclxuICAgICAgXCJ0ZXh0XCI6IHRleHQsXHJcbiAgICAgIFwiYWdyZWVcIjogbnVsbCxcclxuICAgICAgXCJkb25lXCI6IGZhbHNlLFxyXG4gICAgICBcInBhdGh3YXlJZFwiOiBwYXRod2F5SWQsXHJcbiAgICAgIFwiaGlzdG9yeVwiOiBbXCJZb3UgYWRkZWQgdGhpcyBvbiBcIiArIChuZXcgRGF0ZSgpKS50b0RhdGVTdHJpbmcoKV1cclxuICAgIH07XHJcblxyXG4gICAgbG9nLnNldE9iaihvYmopO1xyXG4gICAgcmV0dXJuIHBsYW5JZDtcclxuICB9LFxyXG5cclxuICBmaW5kUGxhbjogZnVuY3Rpb24ob2JqLCBwbGFuSWQpIHtcclxuICAgIGZvciAodmFyIGsgaW4gb2JqLmFjdGlvbnMpIHtcclxuICAgICAgaWYgKG9iai5hY3Rpb25zW2tdW3BsYW5JZF0gJiYgb2JqLmFjdGlvbnNba11bcGxhbklkXS50ZXh0KSByZXR1cm4gaztcclxuICAgIH1cclxuICAgIHJldHVybiAtMTtcclxuICB9LFxyXG5cclxuICBlZGl0UGxhbjogZnVuY3Rpb24ocGxhbklkLCB0ZXh0LCBkb25lKSB7XHJcbiAgICB2YXIgb2JqID0gbG9nLmdldE9iaihbe1xyXG4gICAgICBuYW1lOiBcImFjdGlvbnNcIixcclxuICAgICAgdmFsdWU6IHt9XHJcbiAgICB9XSk7XHJcbiAgICB2YXIgaWQgPSBsb2cuZmluZFBsYW4ob2JqLCBwbGFuSWQpO1xyXG4gICAgaWYgKHRleHQpIG9iai5hY3Rpb25zW2lkXVtwbGFuSWRdLnRleHQgPSB0ZXh0O1xyXG4gICAgaWYgKGRvbmUgPT09IHRydWUgfHwgZG9uZSA9PT0gZmFsc2UpIG9iai5hY3Rpb25zW2lkXVtwbGFuSWRdLmRvbmUgPSBkb25lO1xyXG4gICAgbG9nLnNldE9iaihvYmopO1xyXG4gIH0sXHJcblxyXG4gIGRlbGV0ZVBsYW46IGZ1bmN0aW9uKHBsYW5JZCkge1xyXG4gICAgdmFyIG9iaiA9IGxvZy5nZXRPYmooW3tcclxuICAgICAgbmFtZTogXCJhY3Rpb25zXCIsXHJcbiAgICAgIHZhbHVlOiB7fVxyXG4gICAgfV0pO1xyXG4gICAgdmFyIGlkID0gbG9nLmZpbmRQbGFuKG9iaiwgcGxhbklkKTtcclxuICAgIGRlbGV0ZSBvYmouYWN0aW9uc1tpZF1bcGxhbklkXTtcclxuICAgIGxvZy5zZXRPYmoob2JqKTtcclxuICB9LFxyXG5cclxuICBsaXN0UGxhbnM6IGZ1bmN0aW9uKGlkLCBwYXRod2F5SWQpIHtcclxuICAgIHZhciBvYmogPSBsb2cuZ2V0T2JqKFt7XHJcbiAgICAgICAgbmFtZTogXCJhY3Rpb25zXCIsXHJcbiAgICAgICAgdmFsdWU6IHt9XHJcbiAgICAgIH1dKSxcclxuICAgICAgYXJyID0gW107XHJcbiAgICBpZiAoIWlkKSByZXR1cm4gb2JqLmFjdGlvbnM7XHJcbiAgICBmb3IgKHZhciBwcm9wIGluIG9iai5hY3Rpb25zW2lkXSkge1xyXG4gICAgICBvYmouYWN0aW9uc1tpZF1bcHJvcF0uaWQgPSBwcm9wO1xyXG4gICAgICBpZiAoKCFwYXRod2F5SWQgfHwgcGF0aHdheUlkID09PSBvYmouYWN0aW9uc1tpZF1bcHJvcF0ucGF0aHdheUlkKSAmJiBvYmouYWN0aW9uc1tpZF1bcHJvcF0udGV4dCkgYXJyLnB1c2gob2JqLmFjdGlvbnNbaWRdW3Byb3BdKTtcclxuICAgIH1cclxuICAgIHJldHVybiBhcnI7XHJcbiAgfSxcclxuXHJcbiAgZ2V0UmVhc29uOiBmdW5jdGlvbihpZCwgYWN0aW9uSWQpIHtcclxuICAgIHZhciBvYmogPSBsb2cuZ2V0T2JqKFt7XHJcbiAgICAgIG5hbWU6IFwiYWN0aW9uc1wiLFxyXG4gICAgICB2YWx1ZToge31cclxuICAgIH1dKTtcclxuXHJcbiAgICBpZiAob2JqLmFjdGlvbnNbaWRdICYmIG9iai5hY3Rpb25zW2lkXVthY3Rpb25JZF0pIHJldHVybiBvYmouYWN0aW9uc1tpZF1bYWN0aW9uSWRdLnJlYXNvbjtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH0sXHJcblxyXG4gIGdldEFncmVlUmVhc29uOiBmdW5jdGlvbihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCwgaXRlbSkge1xyXG4gICAgdmFyIG9iaiA9IGxvZy5nZXRPYmooW3tcclxuICAgICAgbmFtZTogXCJhZ3JlZXNcIixcclxuICAgICAgdmFsdWU6IHt9XHJcbiAgICB9XSk7XHJcbiAgICBpZiAoIXBhdGh3YXlJZCB8fCAhcGF0aHdheVN0YWdlKSBhbGVydChcIkVESVRQQVRJRU5UQUdSRUVcIik7XHJcblxyXG4gICAgaWYgKCFvYmouYWdyZWVzW3BhdGllbnRJZF0pIG9iai5hZ3JlZXNbcGF0aWVudElkXSA9IFtdO1xyXG4gICAgdmFyIGl0ZW1zID0gb2JqLmFncmVlc1twYXRpZW50SWRdLmZpbHRlcihmdW5jdGlvbih2YWwpIHtcclxuICAgICAgcmV0dXJuIHZhbC5wYXRod2F5SWQgPT09IHBhdGh3YXlJZCAmJiB2YWwucGF0aHdheVN0YWdlID09PSBwYXRod2F5U3RhZ2UgJiYgdmFsLnN0YW5kYXJkID09PSBzdGFuZGFyZCAmJiB2YWwuaXRlbSA9PT0gaXRlbTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBpdGVtcy5sZW5ndGggPT09IDEgPyBpdGVtc1swXS5yZWFzb24gfHwge30gOiB7fTtcclxuICB9LFxyXG5cclxuICBlZGl0UGF0aWVudEFncmVlOiBmdW5jdGlvbihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCwgaXRlbSwgYWdyZWUsIHJlYXNvbikge1xyXG4gICAgdmFyIG9iaiA9IGxvZy5nZXRPYmooKTtcclxuICAgIGlmICghcGF0aHdheUlkIHx8ICFwYXRod2F5U3RhZ2UpIGFsZXJ0KFwiRURJVFBBVElFTlRBR1JFRVwiKTtcclxuXHJcbiAgICBpZiAoIW9iai5hZ3JlZXNbcGF0aWVudElkXSkgb2JqLmFncmVlc1twYXRpZW50SWRdID0gW107XHJcbiAgICB2YXIgaXRlbXMgPSBvYmouYWdyZWVzW3BhdGllbnRJZF0uZmlsdGVyKGZ1bmN0aW9uKHZhbCkge1xyXG4gICAgICByZXR1cm4gdmFsLnBhdGh3YXlJZCA9PT0gcGF0aHdheUlkICYmIHZhbC5wYXRod2F5U3RhZ2UgPT09IHBhdGh3YXlTdGFnZSAmJiB2YWwuc3RhbmRhcmQgPT09IHN0YW5kYXJkICYmIHZhbC5pdGVtID09PSBpdGVtO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdmFyIGxvZ1RleHQgPSBcIllvdSBcIiArIChhZ3JlZSA/IFwiXCIgOiBcImRpc1wiKSArIFwiYWdyZWVkIHdpdGggdGhpcyBvbiBcIiArIChuZXcgRGF0ZSgpKS50b0RhdGVTdHJpbmcoKTtcclxuXHJcbiAgICBpZiAoaXRlbXMubGVuZ3RoID09PSAxKSB7XHJcbiAgICAgIGl0ZW1zWzBdLmFncmVlID0gYWdyZWU7XHJcbiAgICAgIGl0ZW1zWzBdLmhpc3RvcnkucHVzaChsb2dUZXh0KTtcclxuICAgICAgaXRlbXNbMF0ucmVhc29uID0gcmVhc29uO1xyXG4gICAgfSBlbHNlIGlmIChpdGVtcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgb2JqLmFncmVlc1twYXRpZW50SWRdLnB1c2goe1xyXG4gICAgICAgIFwicGF0aHdheUlkXCI6IHBhdGh3YXlJZCxcclxuICAgICAgICBcInBhdGh3YXlTdGFnZVwiOiBwYXRod2F5U3RhZ2UsXHJcbiAgICAgICAgXCJzdGFuZGFyZFwiOiBzdGFuZGFyZCxcclxuICAgICAgICBcIml0ZW1cIjogaXRlbSxcclxuICAgICAgICBcImFncmVlXCI6IGFncmVlLFxyXG4gICAgICAgIFwicmVhc29uXCI6IHJlYXNvbixcclxuICAgICAgICBcImhpc3RvcnlcIjogW2xvZ1RleHRdXHJcbiAgICAgIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY29uc29sZS5sb2coXCJFUlJPUlJSISEhISEhIVwiKTtcclxuICAgIH1cclxuXHJcbiAgICBsb2cuc2V0T2JqKG9iaik7XHJcbiAgICBub3RpZnkuc2hvd1NhdmVkKCk7XHJcbiAgfSxcclxuXHJcbiAgZ2V0QWdyZWVzOiBmdW5jdGlvbigpe1xyXG4gICAgcmV0dXJuIGxvZy5nZXRPYmooW3tcclxuICAgICAgbmFtZTogXCJhZ3JlZXNcIixcclxuICAgICAgdmFsdWU6IHt9XHJcbiAgICB9XSkuYWdyZWVzO1xyXG4gIH0sXHJcblxyXG4gIGdldFBhdGllbnRBZ3JlZU9iamVjdDogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQsIGl0ZW0pIHtcclxuICAgIHZhciBvYmogPSBsb2cuZ2V0T2JqKFt7XHJcbiAgICAgIG5hbWU6IFwiYWdyZWVzXCIsXHJcbiAgICAgIHZhbHVlOiB7fVxyXG4gICAgfV0pO1xyXG4gICAgaWYgKCFwYXRod2F5SWQgfHwgIXBhdGh3YXlTdGFnZSkgYWxlcnQoXCJFRElUUEFUSUVOVEFHUkVFXCIpO1xyXG5cclxuICAgIGlmICghb2JqLmFncmVlc1twYXRpZW50SWRdKSBvYmouYWdyZWVzW3BhdGllbnRJZF0gPSBbXTtcclxuICAgIHZhciBpdGVtcyA9IG9iai5hZ3JlZXNbcGF0aWVudElkXS5maWx0ZXIoZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgIHJldHVybiB2YWwucGF0aHdheUlkID09PSBwYXRod2F5SWQgJiYgdmFsLnBhdGh3YXlTdGFnZSA9PT0gcGF0aHdheVN0YWdlICYmIHZhbC5zdGFuZGFyZCA9PT0gc3RhbmRhcmQgJiYgdmFsLml0ZW0gPT09IGl0ZW07XHJcbiAgICB9KTtcclxuICAgIGlmIChpdGVtcy5sZW5ndGggPT09IDEpIHJldHVybiBpdGVtc1swXTtcclxuICAgIHJldHVybiB7fTtcclxuICB9LFxyXG5cclxuICBnZXRQYXRpZW50QWdyZWU6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkLCBpdGVtKSB7XHJcbiAgICB2YXIgb2JqID0gbG9nLmdldE9iaihbe1xyXG4gICAgICBuYW1lOiBcImFncmVlc1wiLFxyXG4gICAgICB2YWx1ZToge31cclxuICAgIH1dKTtcclxuXHJcbiAgICBpZiAoIW9iai5hZ3JlZXNbcGF0aWVudElkXSkgcmV0dXJuIG51bGw7XHJcbiAgICB2YXIgaXRlbTIgPSBvYmouYWdyZWVzW3BhdGllbnRJZF0uZmlsdGVyKGZ1bmN0aW9uKHZhbCkge1xyXG4gICAgICByZXR1cm4gdmFsLnBhdGh3YXlJZCA9PT0gcGF0aHdheUlkICYmIHZhbC5wYXRod2F5U3RhZ2UgPT09IHBhdGh3YXlTdGFnZSAmJiB2YWwuc3RhbmRhcmQgPT09IHN0YW5kYXJkICYmIHZhbC5pdGVtID09PSBpdGVtO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKGl0ZW0ubGVuZ3RoID09PSAxKSB7XHJcbiAgICAgIHJldHVybiBpdGVtWzBdLmFncmVlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gbG9nO1xyXG4iLCJtb2R1bGUuZXhwb3J0cyA9IHtcclxuICBcImN1cnJlbnRVcmxcIjogXCJcIixcclxuICBcIm9wdGlvbnNcIjogW10sXHJcbiAgXCJjYXRlZ29yaWVzXCI6IHtcclxuICAgIFwiZGlhZ25vc2lzXCI6IHtcclxuICAgICAgXCJuYW1lXCI6IFwiZGlhZ25vc2lzXCIsXHJcbiAgICAgIFwiZGlzcGxheVwiOiBcIkRpYWdub3Npc1wiXHJcbiAgICB9LFxyXG4gICAgXCJtb25pdG9yaW5nXCI6IHtcclxuICAgICAgXCJuYW1lXCI6IFwibW9uaXRvcmluZ1wiLFxyXG4gICAgICBcImRpc3BsYXlcIjogXCJNb25pdG9yaW5nXCJcclxuICAgIH0sXHJcbiAgICBcInRyZWF0bWVudFwiOiB7XHJcbiAgICAgIFwibmFtZVwiOiBcInRyZWF0bWVudFwiLFxyXG4gICAgICBcImRpc3BsYXlcIjogXCJDb250cm9sXCJcclxuICAgIH0sXHJcbiAgICBcImV4Y2x1c2lvbnNcIjoge1xyXG4gICAgICBcIm5hbWVcIjogXCJleGNsdXNpb25zXCIsXHJcbiAgICAgIFwiZGlzcGxheVwiOiBcIkV4Y2x1c2lvbnNcIlxyXG4gICAgfVxyXG4gIH0sXHJcbiAgXCJjaGFydHNcIjoge30sXHJcbiAgXCJwYXRod2F5SWRcIjogXCJodG5cIixcclxuICBcImNvbG9yc1wiOiBbJyMxZjc3YjQnLCAnI2ZmN2YwZScsICcjMmNhMDJjJywgJyNkNjI3MjgnLCAnIzk0NjdiZCcsICcjOGM1NjRiJywgJyNlMzc3YzInLCAnIzdmN2Y3ZicsICcjYmNiZDIyJywgJyMxN2JlY2YnXSxcclxuICBcIm1vbml0b3JlZFwiOiB7XHJcbiAgICBcImJwXCI6IFwiQmxvb2QgUHJlc3N1cmVcIixcclxuICAgIFwiYXN0aG1hXCI6IFwiUGVhayBFeHBpcmF0b3J5IEZsb3dcIlxyXG4gIH1cclxufTtcclxuIiwidmFyIHRlbXBsYXRlID0gcmVxdWlyZSgnLi90ZW1wbGF0ZS5qcycpLFxyXG4gIGRhdGEgPSByZXF1aXJlKCcuL2RhdGEuanMnKSxcclxuICBiYXNlID0gcmVxdWlyZSgnLi9iYXNlLmpzJyksXHJcbiAgbGF5b3V0ID0gcmVxdWlyZSgnLi9sYXlvdXQuanMnKSxcclxuICB3ZWxjb21lID0gcmVxdWlyZSgnLi9wYW5lbHMvd2VsY29tZS5qcycpLFxyXG4gIGxvZyA9IHJlcXVpcmUoJy4vbG9nLmpzJyksXHJcbiAgcGF0aWVudFZpZXcgPSByZXF1aXJlKCcuL3ZpZXdzL3BhdGllbnQuanMnKSxcclxuICBNdXN0YWNoZSA9IHJlcXVpcmUoJ211c3RhY2hlJyk7XHJcblxyXG52YXIgc3RhdGVzLCBwYXRMb29rdXAsIHBhZ2UsIGhhc2g7XHJcblxyXG5jb25zb2xlLmxvZyhcIm1haW4uanM6IGRhdGEubGFzdGxvYWRlcj0gXCIgKyBkYXRhLmxhc3Rsb2FkZXIpO1xyXG5kYXRhLmxhc3Rsb2FkZXIgPSBcIm1haW4uanNcIjtcclxuXHJcbnZhciBtYWluID0ge1xyXG4gIFwidmVyc2lvblwiOiBcIjIuMC4wXCIsXHJcblxyXG4gIGhhc2g6IGhhc2gsXHJcbiAgaW5pdDogZnVuY3Rpb24oKSB7XHJcbiAgICBtYWluLnByZVdpcmVVcFBhZ2VzKCk7XHJcblxyXG4gICAgbG9nLmxvYWRBY3Rpb25zKGZ1bmN0aW9uKCkge1xyXG4gICAgICBkYXRhLmdldChtYWluLndpcmVVcFBhZ2VzKTtcclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIG9uU2VsZWN0ZWQ6IGZ1bmN0aW9uKCRlLCBuaHNOdW1iZXJPYmplY3QpIHtcclxuICAgIC8vSGlkZSB0aGUgc3VnZ2VzdGlvbnMgcGFuZWxcclxuICAgICQoJyNzZWFyY2gtYm94JykuZmluZCgnLnR0LWRyb3Bkb3duLW1lbnUnKS5jc3MoJ2Rpc3BsYXknLCAnbm9uZScpO1xyXG5cclxuICAgIGhpc3RvcnkucHVzaFN0YXRlKG51bGwsIG51bGwsICcjcGF0aWVudHMvJyArIG5oc051bWJlck9iamVjdC5pZCk7XHJcbiAgICB0ZW1wbGF0ZS5sb2FkQ29udGVudCgnI3BhdGllbnRzLycgKyBuaHNOdW1iZXJPYmplY3QuaWQsIHRydWUpO1xyXG5cclxuXHJcbiAgICAvL3RlbXBsYXRlLmRpc3BsYXlTZWxlY3RlZFBhdGllbnQobmhzTnVtYmVyT2JqZWN0LmlkKTtcclxuICB9LFxyXG5cclxuICB3aXJlVXBTZWFyY2hCb3g6IGZ1bmN0aW9uKCkge1xyXG4gICAgaWYgKHN0YXRlcykge1xyXG4gICAgICBzdGF0ZXMuY2xlYXJQcmVmZXRjaENhY2hlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGVzID0gbmV3IEJsb29kaG91bmQoe1xyXG4gICAgICBkYXR1bVRva2VuaXplcjogQmxvb2Rob3VuZC50b2tlbml6ZXJzLm9iai53aGl0ZXNwYWNlKCd2YWx1ZScpLFxyXG4gICAgICBxdWVyeVRva2VuaXplcjogQmxvb2Rob3VuZC50b2tlbml6ZXJzLndoaXRlc3BhY2UsXHJcbiAgICAgIGxvY2FsOiAkLm1hcChkYXRhLnBhdGllbnRBcnJheSwgZnVuY3Rpb24oc3RhdGUpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgaWQ6IHN0YXRlLFxyXG4gICAgICAgICAgdmFsdWU6IGRhdGEucGF0TG9va3VwICYmIGRhdGEucGF0TG9va3VwW3N0YXRlXSA/IGRhdGEucGF0TG9va3VwW3N0YXRlXSA6IHN0YXRlXHJcbiAgICAgICAgfTtcclxuICAgICAgfSlcclxuICAgIH0pO1xyXG5cclxuICAgIHN0YXRlcy5pbml0aWFsaXplKHRydWUpO1xyXG5cclxuICAgICQoJyNzZWFyY2gtYm94JykuZmluZCgnLnR5cGVhaGVhZCcpLnR5cGVhaGVhZCgnZGVzdHJveScpO1xyXG4gICAgJCgnI3NlYXJjaC1ib3gnKS5maW5kKCcudHlwZWFoZWFkJykudHlwZWFoZWFkKHtcclxuICAgICAgICBoaW50OiB0cnVlLFxyXG4gICAgICAgIGhpZ2hsaWdodDogdHJ1ZSxcclxuICAgICAgICBtaW5MZW5ndGg6IDEsXHJcbiAgICAgICAgYXV0b3NlbGVjdDogdHJ1ZVxyXG4gICAgICB9LCB7XHJcbiAgICAgICAgbmFtZTogJ3BhdGllbnRzJyxcclxuICAgICAgICBkaXNwbGF5S2V5OiAndmFsdWUnLFxyXG4gICAgICAgIHNvdXJjZTogc3RhdGVzLnR0QWRhcHRlcigpLFxyXG4gICAgICAgIHRlbXBsYXRlczoge1xyXG4gICAgICAgICAgZW1wdHk6IFtcclxuICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImVtcHR5LW1lc3NhZ2VcIj4nLFxyXG4gICAgICAgICAgICAgICAgJyZuYnNwOyAmbmJzcDsgTm8gbWF0Y2hlcycsXHJcbiAgICAgICAgICAgICAgJzwvZGl2PidcclxuICAgICAgICAgICAgXS5qb2luKCdcXG4nKVxyXG4gICAgICAgIH1cclxuICAgICAgfSkub24oJ3R5cGVhaGVhZDpzZWxlY3RlZCcsIG1haW4ub25TZWxlY3RlZClcclxuICAgICAgLm9uKCd0eXBlYWhlYWQ6YXV0b2NvbXBsZXRlZCcsIG1haW4ub25TZWxlY3RlZCk7XHJcblxyXG4gICAgJCgnI3NlYXJjaGJ0bicpLm9uKCdtb3VzZWRvd24nLCBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIHZhbCA9ICQoJy50eXBlYWhlYWQnKS5lcSgwKS52YWwoKTtcclxuICAgICAgaWYgKCF2YWwgfHwgdmFsID09PSBcIlwiKSB2YWwgPSAkKCcudHlwZWFoZWFkJykuZXEoMSkudmFsKCk7XHJcbiAgICAgIG1haW4ub25TZWxlY3RlZChudWxsLCB7XHJcbiAgICAgICAgXCJpZFwiOiB2YWxcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICB3aXJlVXBQYWdlczogZnVuY3Rpb24oKSB7XHJcbiAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICBtYWluLndpcmVVcFNlYXJjaEJveCgpO1xyXG5cclxuICAgICQoJyNkYXRhLWZpbGUnKS5vbignY2hhbmdlJywgZnVuY3Rpb24oZXZ0KSB7XHJcbiAgICAgICQoJyNkYXRhLWZpbGUtd3JhcHBlcicpLmFkZENsYXNzKCdkaXNhYmxlZCcpLnRleHQoXCJMb2FkaW5nLi4uXCIpO1xyXG4gICAgICB2YXIgZmlsZSA9IGV2dC50YXJnZXQuZmlsZXNbMF07IC8vIEZpbGVMaXN0IG9iamVjdFxyXG4gICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcclxuXHJcbiAgICAgIHJlYWRlci5vbmxvYWQgPSAoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgIHZhciBKc29uT2JqID0gSlNPTi5wYXJzZShlLnRhcmdldC5yZXN1bHQpO1xyXG4gICAgICAgICAgZGF0YS5nZXQobnVsbCwgSnNvbk9iaik7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhKc29uT2JqKTtcclxuXHJcbiAgICAgICAgICBtYWluLndpcmVVcFNlYXJjaEJveCgpO1xyXG5cclxuICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmICghJCgnI3BhdGllbnQtZmlsZS13cmFwcGVyJykuaXMoJzp2aXNpYmxlJykpIHtcclxuICAgICAgICAgICAgICAkKCcjZmlsZS1sb2FkZXInKS5oaWRlKDUwMCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgJCgnI2RhdGEtZmlsZS13cmFwcGVyJykuaGlkZSg1MDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRlbXBsYXRlLmxvYWRDb250ZW50KCcjb3ZlcnZpZXcnKTtcclxuICAgICAgICAgIH0sIDEwMDApO1xyXG4gICAgICAgIH07XHJcbiAgICAgIH0pKGZpbGUpO1xyXG5cclxuICAgICAgcmVhZGVyLnJlYWRBc1RleHQoZmlsZSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAkKCcjcGF0aWVudC1maWxlJykub24oJ2NoYW5nZScsIGZ1bmN0aW9uKGV2dCkge1xyXG4gICAgICAkKCcjcGF0aWVudC1maWxlLXdyYXBwZXInKS5hZGRDbGFzcygnZGlzYWJsZWQnKS50ZXh0KFwiTG9hZGluZy4uLlwiKTtcclxuICAgICAgdmFyIGZpbGUgPSBldnQudGFyZ2V0LmZpbGVzWzBdOyAvLyBGaWxlTGlzdCBvYmplY3RcclxuICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XHJcblxyXG4gICAgICByZWFkZXIub25sb2FkID0gKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICB2YXIgbGluZXMgPSBlLnRhcmdldC5yZXN1bHQuc3BsaXQoXCJcXG5cIik7XHJcbiAgICAgICAgICBkYXRhLnBhdExvb2t1cCA9IHt9O1xyXG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaW5lcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgZmllbGRzID0gbGluZXNbaV0uc3BsaXQoXCJcXHRcIik7XHJcbiAgICAgICAgICAgIGlmIChmaWVsZHMubGVuZ3RoICE9PSAyKSBjb250aW51ZTtcclxuICAgICAgICAgICAgZGF0YS5wYXRMb29rdXBbZmllbGRzWzBdLnRyaW0oKV0gPSBmaWVsZHNbMV0udHJpbSgpO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIG1haW4ud2lyZVVwU2VhcmNoQm94KCk7XHJcblxyXG4gICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKCEkKCcjZGF0YS1maWxlLXdyYXBwZXInKS5pcygnOnZpc2libGUnKSkge1xyXG4gICAgICAgICAgICAgICQoJyNmaWxlLWxvYWRlcicpLmhpZGUoNTAwKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAkKCcjcGF0aWVudC1maWxlLXdyYXBwZXInKS5oaWRlKDUwMCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGVtcGxhdGUubG9hZENvbnRlbnQoJyNvdmVydmlldycpO1xyXG4gICAgICAgICAgfSwgMTAwMCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgfSkoZmlsZSk7XHJcblxyXG4gICAgICByZWFkZXIucmVhZEFzVGV4dChmaWxlKTtcclxuICAgIH0pO1xyXG5cclxuICAgICQoJyNvdXRzdGFuZGluZ1Rhc2tzJykub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgICAkKCcjd2VsY29tZS10YWJzIGxpJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAkKHRoaXMpLmNsb3Nlc3QoJ2xpJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICB2YXIgdGVtcE11c3QgPSAkKCcjd2VsY29tZS10YXNrLWxpc3QnKS5odG1sKCk7XHJcbiAgICAgIHZhciByZW5kZXJlZCA9IE11c3RhY2hlLnJlbmRlcih0ZW1wTXVzdCk7XHJcbiAgICAgICQoJyN3ZWxjb21lLXRhYi1jb250ZW50JykuZmFkZU91dCgxMDAsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICQodGhpcykuaHRtbChyZW5kZXJlZCk7XHJcbiAgICAgICAgd2VsY29tZS5wb3B1bGF0ZSgpO1xyXG4gICAgICAgICQodGhpcykuZmFkZUluKDEwMCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgJCgnI2NvbXBsZXRlZFRhc2tzJykub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgICAkKCcjd2VsY29tZS10YWJzIGxpJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAkKHRoaXMpLmNsb3Nlc3QoJ2xpJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICB2YXIgdGVtcE11c3QgPSAkKCcjd2VsY29tZS10YXNrLWxpc3QnKS5odG1sKCk7XHJcbiAgICAgIHZhciByZW5kZXJlZCA9IE11c3RhY2hlLnJlbmRlcih0ZW1wTXVzdCk7XHJcbiAgICAgICQoJyN3ZWxjb21lLXRhYi1jb250ZW50JykuZmFkZU91dCgxMDAsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICQodGhpcykuaHRtbChyZW5kZXJlZCk7XHJcbiAgICAgICAgd2VsY29tZS5wb3B1bGF0ZSh0cnVlKTtcclxuICAgICAgICAkKHRoaXMpLmZhZGVJbigxMDApO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChtYWluLmhhc2ggIT09IGxvY2F0aW9uLmhhc2gpIGxvY2F0aW9uLmhhc2ggPSBtYWluLmhhc2g7XHJcbiAgICB0ZW1wbGF0ZS5sb2FkQ29udGVudChsb2NhdGlvbi5oYXNoLCB0cnVlKTtcclxuICB9LFxyXG5cclxuICBwcmVXaXJlVXBQYWdlczogZnVuY3Rpb24oKSB7XHJcbiAgICAgIGxheW91dC5zaG93UGFnZSgnbG9naW4nKTtcclxuXHJcbiAgICAgIC8vRXZlcnkgbGluayBlbGVtZW50IHN0b3JlcyBocmVmIGluIGhpc3RvcnlcclxuICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJ2EuaGlzdG9yeScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIC8vIGtlZXAgdGhlIGxpbmsgaW4gdGhlIGJyb3dzZXIgaGlzdG9yeVxyXG4gICAgICAgIGhpc3RvcnkucHVzaFN0YXRlKG51bGwsIG51bGwsIHRoaXMuaHJlZik7XHJcbiAgICAgICAgdGVtcGxhdGUubG9hZENvbnRlbnQobG9jYXRpb24uaGFzaCwgdHJ1ZSk7XHJcbiAgICAgICAgLy8gZG8gbm90IGdpdmUgYSBkZWZhdWx0IGFjdGlvblxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICAvL0NhbGxlZCB3aGVuIHRoZSBiYWNrIGJ1dHRvbiBpcyBoaXRcclxuICAgICAgJCh3aW5kb3cpLm9uKCdwb3BzdGF0ZScsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICB0ZW1wbGF0ZS5sb2FkQ29udGVudChsb2NhdGlvbi5oYXNoLCB0cnVlKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICAvL1RlbXBsYXRlc1xyXG4gICAgICBwYXRpZW50c1BhbmVsVGVtcGxhdGUgPSAkKCcjcGF0aWVudHMtcGFuZWwnKTtcclxuICAgICAgYWN0aW9uUGxhblBhbmVsID0gJCgnI2FjdGlvbi1wbGFuLXBhbmVsJyk7XHJcbiAgICAgIHBhdGllbnRMaXN0ID0gJCgnI3BhdGllbnQtbGlzdCcpO1xyXG4gICAgICBzdWdnZXN0ZWRQbGFuVGVtcGxhdGUgPSAkKCcjc3VnZ2VzdGVkLXBsYW4tdGVtcGxhdGUnKTtcclxuICAgICAgaW5kaXZpZHVhbFBhbmVsID0gJCgnI2luZGl2aWR1YWwtcGFuZWwnKTtcclxuICAgICAgdmFsdWVUcmVuZFBhbmVsID0gJCgnI3ZhbHVlLXRyZW5kLXBhbmVsJyk7XHJcbiAgICAgIG1lZGljYXRpb25QYW5lbCA9ICQoJyNtZWRpY2F0aW9ucy1wYW5lbCcpO1xyXG4gICAgICBhY3Rpb25QbGFuTGlzdCA9ICQoJyNhY3Rpb24tcGxhbi1saXN0Jyk7XHJcblxyXG4gICAgICAvL1NlbGVjdG9yc1xyXG4gICAgICBib3R0b21MZWZ0UGFuZWwgPSAkKCcjYm90dG9tLWxlZnQtcGFuZWwnKTtcclxuICAgICAgYm90dG9tUmlnaHRQYW5lbCA9ICQoJyNib3R0b20tcmlnaHQtcGFuZWwnKTtcclxuICAgICAgdG9wUGFuZWwgPSAkKCcjdG9wLXBhbmVsJyk7XHJcbiAgICAgIHRvcExlZnRQYW5lbCA9ICQoJyN0b3AtbGVmdC1wYW5lbCcpO1xyXG4gICAgICB0b3BSaWdodFBhbmVsID0gJCgnI3RvcC1yaWdodC1wYW5lbCcpO1xyXG4gICAgICBtaWRQYW5lbCA9ICQoJyNtaWQtcGFuZWwnKTtcclxuICAgICAgZmFyTGVmdFBhbmVsID0gJCgnI2xlZnQtcGFuZWwnKTtcclxuICAgICAgZmFyUmlnaHRQYW5lbCA9ICQoJyNyaWdodC1wYW5lbCcpO1xyXG4gICAgfVxyXG4gICAgLyosXHJcbiAgICAgIFwiX2xvY2FsXCI6IGxvY2FsKi9cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gbWFpbjtcclxuIiwibW9kdWxlLmV4cG9ydHMgPSB7XHJcblxyXG4gIHNob3dTYXZlZDogZnVuY3Rpb24oKSB7XHJcbiAgICAkKFwiI3NhdmVkLW1lc3NhZ2VcIikuaGlkZSgpLnRvZ2dsZUNsYXNzKFwiaW5cIikuZmFkZUluKDMwMCk7XHJcbiAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgJChcIiNzYXZlZC1tZXNzYWdlXCIpLmZhZGVPdXQoMzAwLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAkKHRoaXMpLnRvZ2dsZUNsYXNzKFwiaW5cIik7XHJcbiAgICAgIH0pO1xyXG4gICAgfSwgMjAwMCk7XHJcbiAgfVxyXG5cclxufTtcclxuIiwidmFyIGJhc2UgPSByZXF1aXJlKCcuLi9iYXNlLmpzJyksXHJcbiAgZGF0YSA9IHJlcXVpcmUoJy4uL2RhdGEuanMnKSxcclxuICBxdWFsaXR5U3RhbmRhcmQgPSByZXF1aXJlKCcuL3F1YWxpdHlTdGFuZGFyZC5qcycpLFxyXG4gIG90aGVyQ29kZXMgPSByZXF1aXJlKCcuL290aGVyQ29kZXMuanMnKSxcclxuICBtZWRpY2F0aW9uID0gcmVxdWlyZSgnLi9tZWRpY2F0aW9uLmpzJyksXHJcbiAgdHJlbmQgPSByZXF1aXJlKCcuL3RyZW5kLmpzJyksXHJcbiAgaW5kaXZpZHVhbEFjdGlvblBsYW4gPSByZXF1aXJlKCcuL2luZGl2aWR1YWxBY3Rpb25QbGFuLmpzJyksXHJcbiAgbGF5b3V0ID0gcmVxdWlyZSgnLi4vbGF5b3V0LmpzJyksXHJcbiAgY2hhcnQgPSByZXF1aXJlKCcuLi9jaGFydC5qcycpLFxyXG4gIE11c3RhY2hlID0gcmVxdWlyZSgnbXVzdGFjaGUnKTtcclxuXHJcbnZhciBhbGwgPSB7XHJcblxyXG4gIHBvcHVsYXRlOiBmdW5jdGlvbigpIHtcclxuICAgIHZhciBwYXRpZW50cyA9IGRhdGEuZ2V0QWxsUGF0aWVudHMoKTtcclxuXHJcbiAgICB2YXIgbG9jYWxEYXRhID0ge1xyXG4gICAgICBcInBhdGllbnRzXCI6IHBhdGllbnRzLFxyXG4gICAgICBcIm5cIjogcGF0aWVudHMubGVuZ3RoLFxyXG4gICAgICBcImhlYWRlci1pdGVtc1wiOiBbe1xyXG4gICAgICAgIFwidGl0bGVcIjogXCJOSFMgbm8uXCIsXHJcbiAgICAgICAgXCJpc1VuU29ydGFibGVcIjogdHJ1ZVxyXG4gICAgICB9LCB7XHJcbiAgICAgICAgXCJ0aXRsZVwiOiBcIkFsbCBPcHBvcnR1bml0aWVzXCIsXHJcbiAgICAgICAgXCJ0aXRsZUhUTUxcIjogJyMgb2YgPGkgY2xhc3M9XCJmYSBmYS1mbGFnXCIgc3R5bGU9XCJjb2xvcjpyZWRcIj48L2k+JyxcclxuICAgICAgICBcImlzVW5Tb3J0YWJsZVwiOiB0cnVlLFxyXG4gICAgICAgIFwidG9vbHRpcFwiOiBcIlRvdGFsIG51bWJlciBvZiBpbXByb3ZlbWVudCBvcHBvcnR1bml0aWVzIGF2YWlsYWJsZSBhY3Jvc3MgYWxsIGNvbmRpdGlvbnNcIlxyXG4gICAgICB9XVxyXG4gICAgfTtcclxuXHJcbiAgICBsb2NhbERhdGEucGF0aWVudHMuc29ydChmdW5jdGlvbihhLCBiKSB7XHJcbiAgICAgIGlmIChhLml0ZW1zWzBdID09PSBiLml0ZW1zWzBdKSB7XHJcbiAgICAgICAgcmV0dXJuIDA7XHJcbiAgICAgIH1cclxuICAgICAgdmFyIEEgPSBOdW1iZXIoYS5pdGVtc1swXSk7XHJcbiAgICAgIHZhciBCID0gTnVtYmVyKGIuaXRlbXNbMF0pO1xyXG4gICAgICBpZiAoaXNOYU4oQSkgfHwgaXNOYU4oQikpIHtcclxuICAgICAgICBBID0gYS5pdGVtc1swXTtcclxuICAgICAgICBCID0gYi5pdGVtc1swXTtcclxuICAgICAgfVxyXG4gICAgICBpZiAoQSA+IEIpIHtcclxuICAgICAgICByZXR1cm4gLTE7XHJcbiAgICAgIH0gZWxzZSBpZiAoQSA8IEIpIHtcclxuICAgICAgICByZXR1cm4gMTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgYmFzZS5jcmVhdGVQYW5lbFNob3cocGF0aWVudExpc3QsIHBhdGllbnRzUGFuZWwsIGxvY2FsRGF0YSwge1xyXG4gICAgICBcImhlYWRlci1pdGVtXCI6ICQoXCIjcGF0aWVudC1saXN0LWhlYWRlci1pdGVtXCIpLmh0bWwoKSxcclxuICAgICAgXCJpdGVtXCI6ICQoJyNwYXRpZW50LWxpc3QtaXRlbScpLmh0bWwoKVxyXG4gICAgfSk7XHJcblxyXG4gICAgJCgnI3BhdGllbnRzLXBsYWNlaG9sZGVyJykuaGlkZSgpO1xyXG5cclxuICAgIGJhc2Uuc2V0dXBDbGlwYm9hcmQoJCgnLmJ0bi1jb3B5JyksIHRydWUpO1xyXG5cclxuICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuXHJcbiAgICB2YXIgYyA9IHBhdGllbnRzUGFuZWwuZmluZCgnZGl2LnRhYmxlLXNjcm9sbCcpLmdldE5pY2VTY3JvbGwoKTtcclxuICAgIGlmIChjICYmIGMubGVuZ3RoID4gMCkge1xyXG4gICAgICBjLnJlc2l6ZSgpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcGF0aWVudHNQYW5lbC5maW5kKCdkaXYudGFibGUtc2Nyb2xsJykubmljZVNjcm9sbCh7XHJcbiAgICAgICAgY3Vyc29yb3BhY2l0eW1pbjogMC4zLFxyXG4gICAgICAgIGN1cnNvcndpZHRoOiBcIjdweFwiLFxyXG4gICAgICAgIGhvcml6cmFpbGVuYWJsZWQ6IGZhbHNlXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIC8vU2hvdyBwYXRpZW50IHZpZXcgZnJvbSB0aGUgYWxsIHBhdGllbnQgc2NyZWVuXHJcbiAgc2hvd0luZGl2aWR1YWxQYXRpZW50VmlldzogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpIHtcclxuICAgIGRhdGEucGF0aWVudElkID0gcGF0aWVudElkO1xyXG5cclxuICAgIGRhdGEub3B0aW9ucy5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcclxuICAgICAgYSA9IGRhdGEuZ2V0UGF0aWVudFN0YXR1cyhwYXRpZW50SWQsIGEucGF0aHdheUlkLCBhLnBhdGh3YXlTdGFnZSwgYS5zdGFuZGFyZCk7XHJcbiAgICAgIGIgPSBkYXRhLmdldFBhdGllbnRTdGF0dXMocGF0aWVudElkLCBiLnBhdGh3YXlJZCwgYi5wYXRod2F5U3RhZ2UsIGIuc3RhbmRhcmQpO1xyXG5cclxuICAgICAgaWYgKGEgPT09IGIpIHJldHVybiAwO1xyXG4gICAgICBpZiAoYSA9PT0gXCJub3RcIikgcmV0dXJuIDE7XHJcbiAgICAgIGlmIChiID09PSBcIm5vdFwiKSByZXR1cm4gLTE7XHJcbiAgICAgIGlmIChhID09PSBcIm9rXCIpIHJldHVybiAxO1xyXG4gICAgICBpZiAoYiA9PT0gXCJva1wiKSByZXR1cm4gLTE7XHJcbiAgICAgIGFsZXJ0KFwiISEhISEhIVwiKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChwYXRod2F5SWQgPT09IG51bGwpIHtcclxuICAgICAgLy9TaG93IHBhdGllbnQgYnV0IGRvbid0IHNlbGVjdFxyXG4gICAgICB2YXIgcCA9IGJhc2UuY3JlYXRlUGFuZWwoJCgnI3BhdGllbnQtcGFuZWwnKSwge1xyXG4gICAgICAgIFwib3B0aW9uc1wiOiBkYXRhLm9wdGlvbnMsXHJcbiAgICAgICAgXCJudW1iZXJPZlN0YW5kYXJkc01pc3NlZFwiOiBkYXRhLm51bWJlck9mU3RhbmRhcmRzTWlzc2VkKHBhdGllbnRJZCksXHJcbiAgICAgICAgXCJuaHNOdW1iZXJcIjogZGF0YS5wYXRMb29rdXAgPyBkYXRhLnBhdExvb2t1cFtwYXRpZW50SWRdIDogcGF0aWVudElkLFxyXG4gICAgICAgIFwicGF0aWVudElkXCI6IHBhdGllbnRJZFxyXG4gICAgICB9LCB7XHJcbiAgICAgICAgXCJvcHRpb25cIjogJCgnI3BhdGllbnQtcGFuZWwtZHJvcC1kb3duLW9wdGlvbnMnKS5odG1sKClcclxuICAgICAgfSk7XHJcbiAgICAgIGZhclJpZ2h0UGFuZWwuaHRtbChwKS5zaG93KCk7XHJcbiAgICAgIGZhclJpZ2h0UGFuZWwucmVtb3ZlQ2xhc3MoJ3N0YW5kYXJkLW1pc3NlZC1wYWdlJykucmVtb3ZlQ2xhc3MoJ3N0YW5kYXJkLWFjaGlldmVkLXBhZ2UnKS5yZW1vdmVDbGFzcygnc3RhbmRhcmQtbm90LXJlbGV2YW50LXBhZ2UnKTtcclxuXHJcbiAgICAgICQoJ3NlbGVjdCcpLnNlbGVjdDIoe1xyXG4gICAgICAgIHRlbXBsYXRlUmVzdWx0OiBiYXNlLmZvcm1hdFN0YW5kYXJkLFxyXG4gICAgICAgIG1pbmltdW1SZXN1bHRzRm9yU2VhcmNoOiBJbmZpbml0eSxcclxuICAgICAgICBwbGFjZWhvbGRlcjogXCJQbGVhc2Ugc2VsZWN0IGFuIGltcHJvdmVtZW50IG9wcG9ydHVuaXR5IGFyZWEuLi5cIlxyXG4gICAgICB9KTtcclxuICAgICAgJCgnc3Bhbi5zZWxlY3QyLXNlbGVjdGlvbl9fcmVuZGVyZWQnKS5hdHRyKFwidGl0bGVcIiwgXCJcIik7XHJcbiAgICAgICQoJ3NlbGVjdCcpLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgbG9jYWxEYXRhID0gJCh0aGlzKS5maW5kKCc6c2VsZWN0ZWQnKS5kYXRhKCk7XHJcbiAgICAgICAgYWxsLnNob3dJbmRpdmlkdWFsUGF0aWVudFZpZXcobG9jYWxEYXRhLnBhdGh3YXlJZCwgbG9jYWxEYXRhLnBhdGh3YXlTdGFnZSwgbG9jYWxEYXRhLnN0YW5kYXJkLCBkYXRhLnBhdGllbnRJZCk7XHJcbiAgICAgIH0pLm9uKFwic2VsZWN0MjpvcGVuXCIsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIHBhbmVsID0gYmFzZS5jcmVhdGVQYW5lbCgkKCcjcGF0aWVudC1wYW5lbCcpLCB7XHJcbiAgICAgIFwib3B0aW9uc1wiOiBkYXRhLm9wdGlvbnMsXHJcbiAgICAgIFwibnVtYmVyT2ZTdGFuZGFyZHNNaXNzZWRcIjogZGF0YS5udW1iZXJPZlN0YW5kYXJkc01pc3NlZChwYXRpZW50SWQpLFxyXG4gICAgICBcInN0YW5kYXJkXCI6IGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0udGFiLnRpdGxlLFxyXG4gICAgICBcInBhdGh3YXlTdGFnZVwiOiBwYXRod2F5U3RhZ2UsXHJcbiAgICAgIFwibmhzTnVtYmVyXCI6IGRhdGEucGF0TG9va3VwID8gZGF0YS5wYXRMb29rdXBbcGF0aWVudElkXSA6IHBhdGllbnRJZCxcclxuICAgICAgXCJwYXRpZW50SWRcIjogcGF0aWVudElkXHJcbiAgICB9LCB7XHJcbiAgICAgIFwib3B0aW9uXCI6ICQoJyNwYXRpZW50LXBhbmVsLWRyb3AtZG93bi1vcHRpb25zJykuaHRtbCgpXHJcbiAgICB9KTtcclxuXHJcbiAgICBmYXJSaWdodFBhbmVsLmh0bWwoXCJcIik7XHJcbiAgICAkKCcjdGVtcC1oaWRkZW4nKS5odG1sKHBhbmVsKTtcclxuXHJcbiAgICB2YXIgYWN0aW9uUGxhbiA9IGluZGl2aWR1YWxBY3Rpb25QbGFuLmNyZWF0ZShwYXRod2F5U3RhZ2UpO1xyXG4gICAgJCgnI3RlbXAtaGlkZGVuICNwYXRpZW50LXBhbmVsLXJpZ2h0JykuaHRtbChhY3Rpb25QbGFuKTtcclxuXHJcbiAgICB2YXIgcXVhbFBhbmVsID0gcXVhbGl0eVN0YW5kYXJkLmNyZWF0ZShwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcbiAgICB2YXIgdHJlbmRQYW5lbCA9IHRyZW5kLmNyZWF0ZShwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcbiAgICB2YXIgbWVkUGFuZWwgPSBtZWRpY2F0aW9uLmNyZWF0ZShwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcbiAgICB2YXIgY29kZXNQYW5lbCA9IG90aGVyQ29kZXMuY3JlYXRlKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgIHZhciBtZWRDb2RlV3JhcHBlclBhbmVsID0gYmFzZS5jcmVhdGVQYW5lbCgkKCcjb3RoZXItY29kZXMtYW5kLW1lZHMtd3JhcHBlci1wYW5lbCcpKTtcclxuICAgICQoJyN0ZW1wLWhpZGRlbiAjcGF0aWVudC1wYW5lbC10b3AnKS5odG1sKHF1YWxQYW5lbCk7XHJcbiAgICAkKCcjdGVtcC1oaWRkZW4gI3BhdGllbnQtcGFuZWwtbGVmdCcpLmh0bWwoXCJcIikuYXBwZW5kKHRyZW5kUGFuZWwpLmFwcGVuZChtZWRDb2RlV3JhcHBlclBhbmVsKTtcclxuICAgICQoJyN0ZW1wLWhpZGRlbiAjbWVkQ29kZVdyYXBwZXJQYW5lbCcpLmFwcGVuZChtZWRQYW5lbCkuYXBwZW5kKGNvZGVzUGFuZWwpO1xyXG5cclxuICAgIGlmIChmYXJSaWdodFBhbmVsLmlzKCc6dmlzaWJsZScpKSB7XHJcbiAgICAgIGZhclJpZ2h0UGFuZWwuZmFkZU91dCgxMDAsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICQodGhpcykuaHRtbCgkKCcjdGVtcC1oaWRkZW4nKS5odG1sKCkpO1xyXG4gICAgICAgICQoJyN0ZW1wLWhpZGRlbicpLmh0bWwoXCJcIik7XHJcbiAgICAgICAgaW5kaXZpZHVhbEFjdGlvblBsYW4ud2lyZVVwKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgICAgICBxdWFsaXR5U3RhbmRhcmQud2lyZVVwKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgICAgICBiYXNlLndpcmVVcFN0YW5kYXJkRHJvcERvd24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBhbGwuc2hvd0luZGl2aWR1YWxQYXRpZW50Vmlldyk7XHJcbiAgICAgICAgdHJlbmQud2lyZVVwKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgICAgICBtZWRpY2F0aW9uLndpcmVVcChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcbiAgICAgICAgb3RoZXJDb2Rlcy53aXJlVXAocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gICAgICAgIGNoYXJ0LmRyYXdUcmVuZENoYXJ0KHBhdGllbnRJZCwgcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkKTtcclxuICAgICAgICAkKHRoaXMpLmZhZGVJbigxMDAsIGZ1bmN0aW9uKCkge30pO1xyXG4gICAgICB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGZhclJpZ2h0UGFuZWwuaHRtbCgkKCcjdGVtcC1oaWRkZW4nKS5odG1sKCkpO1xyXG4gICAgICAkKCcjdGVtcC1oaWRkZW4nKS5odG1sKFwiXCIpO1xyXG4gICAgICBpbmRpdmlkdWFsQWN0aW9uUGxhbi53aXJlVXAocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gICAgICBxdWFsaXR5U3RhbmRhcmQud2lyZVVwKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgICAgYmFzZS53aXJlVXBTdGFuZGFyZERyb3BEb3duKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgYWxsLnNob3dJbmRpdmlkdWFsUGF0aWVudFZpZXcpO1xyXG4gICAgICB0cmVuZC53aXJlVXAocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gICAgICBtZWRpY2F0aW9uLndpcmVVcChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcbiAgICAgIG90aGVyQ29kZXMud2lyZVVwKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgICAgY2hhcnQuZHJhd1RyZW5kQ2hhcnQocGF0aWVudElkLCBwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQpO1xyXG4gICAgICBmYXJSaWdodFBhbmVsLmZhZGVJbigxMDAsIGZ1bmN0aW9uKCkge30pO1xyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIHNob3c6IGZ1bmN0aW9uKGxvY2F0aW9uKSB7XHJcbiAgICBiYXNlLmNyZWF0ZVBhbmVsU2hvdygkKCcjYWxsLXBhdGllbnRzLXBhbmVsJyksIGxvY2F0aW9uLCB7XHJcbiAgICAgIFwiblwiOiBkYXRhLmdldEFsbFBhdGllbnRzKCkubGVuZ3RoXHJcbiAgICB9KTtcclxuXHJcbiAgICBwYXRpZW50c1BhbmVsID0gJCgnI3BhdGllbnRzJyk7XHJcblxyXG4gICAgcGF0aWVudHNQYW5lbC5vbignY2xpY2snLCAndGJvZHkgdHInLCBmdW5jdGlvbihlKSB7IC8vU2VsZWN0IGluZGl2aWR1YWwgcGF0aWVudCB3aGVuIHJvdyBjbGlja2VkXHJcbiAgICAgICQoJ1tkYXRhLXRvZ2dsZT1cInRvb2x0aXBcIl0nKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgICQodGhpcykudG9vbHRpcCgnZGVzdHJveScpO1xyXG4gICAgICBiYXNlLmNsZWFyQm94KCk7XHJcbiAgICAgICQoJy5saXN0LWl0ZW0nKS5yZW1vdmVDbGFzcygnaGlnaGxpZ2h0ZWQnKTtcclxuICAgICAgJCh0aGlzKS5hZGRDbGFzcygnaGlnaGxpZ2h0ZWQnKS5yZW1vdmVBdHRyKCd0aXRsZScpO1xyXG5cclxuICAgICAgdmFyIHBhdGllbnRJZCA9ICQodGhpcykuZmluZCgndGQgYnV0dG9uJykuYXR0cignZGF0YS1wYXRpZW50LWlkJyk7XHJcblxyXG4gICAgICBhbGwuc2hvd0luZGl2aWR1YWxQYXRpZW50VmlldyhudWxsLCBudWxsLCBudWxsLCBwYXRpZW50SWQpO1xyXG5cclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgfSkub24oJ2NsaWNrJywgJ3Rib2R5IHRyIGJ1dHRvbicsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgLy9kb24ndCB3YW50IHJvdyBzZWxlY3RlZCBpZiBqdXN0IGJ1dHRvbiBwcmVzc2VkP1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICBzaG93VmlldzogZnVuY3Rpb24ocGF0aWVudElkLCByZWxvYWQpIHtcclxuICAgICQoJyNtYWluVGl0bGUnKS5oaWRlKCk7XHJcbiAgICBiYXNlLnVwZGF0ZVRpdGxlKFwiTGlzdCBvZiBhbGwgcGF0aWVudHMgYXQgeW91ciBwcmFjdGljZVwiKTtcclxuXHJcbiAgICBpZiAoIXBhdGllbnRJZCkgZGF0YS5wYXRod2F5SWQgPSBcIlwiO1xyXG4gICAgaWYgKCFwYXRpZW50SWQgfHwgcmVsb2FkKSB7XHJcblxyXG4gICAgICBsYXlvdXQuc2hvd01haW5WaWV3KGRhdGEuZGlzZWFzZXMubGVuZ3RoKTtcclxuXHJcbiAgICAgIGJhc2Uuc3dpdGNoVG8xMTBMYXlvdXQoKTtcclxuICAgICAgYmFzZS5oaWRlQWxsUGFuZWxzKCk7XHJcblxyXG4gICAgICBhbGwuc2hvdyhmYXJMZWZ0UGFuZWwpO1xyXG4gICAgICBhbGwucG9wdWxhdGUoKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAocGF0aWVudElkKSB7XHJcbiAgICAgIGFsbC5zaG93SW5kaXZpZHVhbFBhdGllbnRWaWV3KG51bGwsIG51bGwsIG51bGwsIHBhdGllbnRJZCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB2YXIgdGVtcE11c3QgPSAkKCcjcGF0aWVudC1wYW5lbC1wbGFjZWhvbGRlcicpLmh0bWwoKTtcclxuICAgICAgZmFyUmlnaHRQYW5lbC5odG1sKE11c3RhY2hlLnJlbmRlcih0ZW1wTXVzdCkpLnNob3coKTtcclxuICAgIH1cclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBhbGw7XHJcbiIsInZhciBiYXNlID0gcmVxdWlyZSgnLi4vYmFzZS5qcycpLFxyXG5sb2cgPSByZXF1aXJlKCcuLi9sb2cuanMnKTtcclxuXHJcbnZhciBjb25maXJtID0ge1xyXG5cclxuICB3aXJlVXA6IGZ1bmN0aW9uKGFncmVlRGl2U2VsZWN0b3IsIHBhbmVsU2VsZWN0b3IsIHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkLCBpdGVtLCBkaXNhZ3JlZVRleHQpIHtcclxuICAgIGNvbmZpcm0ud2lyZVVwQWdyZWVEaXNhZ3JlZShhZ3JlZURpdlNlbGVjdG9yLCBsb2cuZ2V0UGF0aWVudEFncmVlT2JqZWN0KHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkLCBpdGVtKSk7XHJcblxyXG4gICAgcGFuZWxTZWxlY3Rvci5vbignY2hhbmdlJywgJy5idG4tdG9nZ2xlIGlucHV0W3R5cGU9Y2hlY2tib3hdJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIGNvbmZpcm0ud2lyZVVwQWdyZWVEaXNhZ3JlZShhZ3JlZURpdlNlbGVjdG9yLCBsb2cuZ2V0UGF0aWVudEFncmVlT2JqZWN0KHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkLCBpdGVtKSk7XHJcbiAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgIH0pLm9uKCdjbGljaycsICcuYnRuLXRvZ2dsZScsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgdmFyIGNoZWNrYm94ID0gJCh0aGlzKS5maW5kKFwiaW5wdXRbdHlwZT1jaGVja2JveF1cIik7XHJcbiAgICAgIHZhciBvdGhlciA9ICQodGhpcykucGFyZW50KCkuZmluZCgkKHRoaXMpLmhhc0NsYXNzKFwiYnRuLXllc1wiKSA/IFwiLmJ0bi1ub1wiIDogXCIuYnRuLXllc1wiKTtcclxuICAgICAgdmFyIEFDVElPTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoJ2lkJyk7XHJcbiAgICAgIGlmICgkKHRoaXMpLmhhc0NsYXNzKFwiYWN0aXZlXCIpICYmIG90aGVyLmhhc0NsYXNzKFwiaW5hY3RpdmVcIikpIHtcclxuICAgICAgICAvL3Vuc2VsZWN0aW5nXHJcbiAgICAgICAgaWYgKGNoZWNrYm94LnZhbCgpID09PSBcIm5vXCIpIHtcclxuICAgICAgICAgIGNvbmZpcm0ubGF1bmNoU3RhbmRhcmRNb2RhbChcIkRpc2FncmVlIHdpdGggXCIgKyBkaXNhZ3JlZVRleHQsIFwiP1wiLCBsb2cuZ2V0QWdyZWVSZWFzb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQsIGl0ZW0pLCB0cnVlLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgbG9nLmVkaXRQYXRpZW50QWdyZWUocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQsIGl0ZW0sIGZhbHNlLCBsb2cucmVhc29uLnJlYXNvblRleHQpO1xyXG4gICAgICAgICAgICBjb25maXJtLndpcmVVcEFncmVlRGlzYWdyZWUoYWdyZWVEaXZTZWxlY3RvciwgbG9nLmdldFBhdGllbnRBZ3JlZU9iamVjdChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCwgaXRlbSkpO1xyXG4gICAgICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICAgICAgICB9LCBudWxsLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgbG9nLmVkaXRQYXRpZW50QWdyZWUocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQsIGl0ZW0sIG51bGwsIFwiXCIpO1xyXG4gICAgICAgICAgICBvdGhlci5yZW1vdmVDbGFzcyhcImluYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICBjaGVja2JveC5yZW1vdmVBdHRyKFwiY2hlY2tlZFwiKTtcclxuICAgICAgICAgICAgY2hlY2tib3gucGFyZW50KCkucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XHJcbiAgICAgICAgICAgIGNvbmZpcm0ud2lyZVVwQWdyZWVEaXNhZ3JlZShhZ3JlZURpdlNlbGVjdG9yLCBsb2cuZ2V0UGF0aWVudEFncmVlT2JqZWN0KHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkLCBpdGVtKSk7XHJcbiAgICAgICAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgbG9nLmVkaXRQYXRpZW50QWdyZWUocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQsIGl0ZW0sIG51bGwpO1xyXG4gICAgICAgICAgb3RoZXIucmVtb3ZlQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSBpZiAoISQodGhpcykuaGFzQ2xhc3MoXCJhY3RpdmVcIikgJiYgb3RoZXIuaGFzQ2xhc3MoXCJhY3RpdmVcIikpIHtcclxuICAgICAgICAvL3ByZXZlbnQgY2xpY2tpbmcgb24gdW5zZWxlY3RlZCBvcHRpb24gb3IgaWYgdGhlIHJvdyBpcyBjb21wbGV0ZVxyXG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvL3NlbGVjdGluZ1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBpZiAoY2hlY2tib3gudmFsKCkgPT09IFwibm9cIikge1xyXG4gICAgICAgICAgY29uZmlybS5sYXVuY2hTdGFuZGFyZE1vZGFsKFwiRGlzYWdyZWUgd2l0aCBcIiArIGRpc2FncmVlVGV4dCwgXCJcIiwgXCJcIiwgZmFsc2UsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBsb2cuZWRpdFBhdGllbnRBZ3JlZShwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCwgaXRlbSwgZmFsc2UsIGxvZy5yZWFzb24ucmVhc29uVGV4dCk7XHJcbiAgICAgICAgICAgICQoc2VsZikucmVtb3ZlQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgY2hlY2tib3guYXR0cihcImNoZWNrZWRcIiwgXCJjaGVja2VkXCIpO1xyXG4gICAgICAgICAgICBjaGVja2JveC5wYXJlbnQoKS5hZGRDbGFzcyhcImFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgLy91bnNlbGVjdCBvdGhlclxyXG4gICAgICAgICAgICBvdGhlci5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKS5hZGRDbGFzcyhcImluYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICBvdGhlci5maW5kKFwiaW5wdXRbdHlwZT1jaGVja2JveF1cIikucHJvcChcImNoZWNrZWRcIiwgZmFsc2UpO1xyXG4gICAgICAgICAgICBjb25maXJtLndpcmVVcEFncmVlRGlzYWdyZWUoYWdyZWVEaXZTZWxlY3RvciwgbG9nLmdldFBhdGllbnRBZ3JlZU9iamVjdChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCwgaXRlbSkpO1xyXG4gICAgICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGxvZy5lZGl0UGF0aWVudEFncmVlKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkLCBpdGVtLCB0cnVlKTtcclxuICAgICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuXHJcbiAgICAgICAgICAvL3Vuc2VsZWN0IG90aGVyXHJcbiAgICAgICAgICBvdGhlci5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKS5hZGRDbGFzcyhcImluYWN0aXZlXCIpO1xyXG4gICAgICAgICAgb3RoZXIuZmluZChcImlucHV0W3R5cGU9Y2hlY2tib3hdXCIpLnByb3AoXCJjaGVja2VkXCIsIGZhbHNlKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIHdpcmVVcEFncmVlRGlzYWdyZWU6IGZ1bmN0aW9uKHNlbGVjdG9yLCBhZ3JlZU9iamVjdCkge1xyXG4gICAgaWYgKGFncmVlT2JqZWN0LmFncmVlID09PSB0cnVlKSB7XHJcbiAgICAgIHNlbGVjdG9yLmNoaWxkcmVuKCc6bnRoKDApJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICBzZWxlY3Rvci5jaGlsZHJlbignOm50aCgxKScpLmFkZENsYXNzKCdpbmFjdGl2ZScpO1xyXG4gICAgICBzZWxlY3Rvci5jaGlsZHJlbignOm50aCgwKScpLmF0dHIoXCJ0aXRsZVwiLCBjb25maXJtLmdldEFncmVlVG9vbHRpcChhZ3JlZU9iamVjdCkpLmF0dHIoXCJkYXRhLW9yaWdpbmFsLXRpdGxlXCIsIGNvbmZpcm0uZ2V0QWdyZWVUb29sdGlwKGFncmVlT2JqZWN0KSkudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgIHNlbGVjdG9yLmNoaWxkcmVuKCc6bnRoKDEpJykuYXR0cihcInRpdGxlXCIsIFwiXCIpLmF0dHIoXCJkYXRhLW9yaWdpbmFsLXRpdGxlXCIsIFwiXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICBzZWxlY3Rvci5wYXJlbnQoKS5hZGRDbGFzcygnc3VjY2VzcycpLnJlbW92ZUNsYXNzKCdkYW5nZXInKTtcclxuICAgIH0gZWxzZSBpZiAoYWdyZWVPYmplY3QuYWdyZWUgPT09IGZhbHNlKSB7XHJcbiAgICAgIHNlbGVjdG9yLmNoaWxkcmVuKCc6bnRoKDApJykuYWRkQ2xhc3MoJ2luYWN0aXZlJyk7XHJcbiAgICAgIHNlbGVjdG9yLmNoaWxkcmVuKCc6bnRoKDEpJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICBzZWxlY3Rvci5jaGlsZHJlbignOm50aCgwKScpLmF0dHIoXCJ0aXRsZVwiLCBcIlwiKS5hdHRyKFwiZGF0YS1vcmlnaW5hbC10aXRsZVwiLCBcIlwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgc2VsZWN0b3IuY2hpbGRyZW4oJzpudGgoMSknKS5hdHRyKFwidGl0bGVcIiwgY29uZmlybS5nZXREaXNncmVlVG9vbHRpcChhZ3JlZU9iamVjdCkpLmF0dHIoXCJkYXRhLW9yaWdpbmFsLXRpdGxlXCIsIGNvbmZpcm0uZ2V0RGlzZ3JlZVRvb2x0aXAoYWdyZWVPYmplY3QpKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgc2VsZWN0b3IucGFyZW50KCkuYWRkQ2xhc3MoJ2RhbmdlcicpLnJlbW92ZUNsYXNzKCdzdWNjZXNzJyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBzZWxlY3Rvci5jaGlsZHJlbignOm50aCgwKScpLmF0dHIoXCJ0aXRsZVwiLCBcIkNsaWNrIHRvIGFncmVlXCIpLmF0dHIoXCJkYXRhLW9yaWdpbmFsLXRpdGxlXCIsIFwiQ2xpY2sgdG8gYWdyZWVcIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgIHNlbGVjdG9yLmNoaWxkcmVuKCc6bnRoKDEpJykuYXR0cihcInRpdGxlXCIsIFwiQ2xpY2sgdG8gZGlzYWdyZWVcIikuYXR0cihcImRhdGEtb3JpZ2luYWwtdGl0bGVcIiwgXCJDbGljayB0byBkaXNhZ3JlZVwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgc2VsZWN0b3IucGFyZW50KCkucmVtb3ZlQ2xhc3MoJ3N1Y2Nlc3MnKS5yZW1vdmVDbGFzcygnZGFuZ2VyJyk7XHJcbiAgICB9XHJcbiAgfSxcclxuXHJcbiAgZ2V0QWdyZWVUb29sdGlwOiBmdW5jdGlvbihhZ3JlZU9iamVjdCkge1xyXG4gICAgcmV0dXJuIGFncmVlT2JqZWN0Lmhpc3RvcnlbYWdyZWVPYmplY3QuaGlzdG9yeS5sZW5ndGggLSAxXTtcclxuICB9LFxyXG5cclxuICBnZXREaXNncmVlVG9vbHRpcDogZnVuY3Rpb24oYWdyZWVPYmplY3QpIHtcclxuICAgIHJldHVybiBhZ3JlZU9iamVjdC5oaXN0b3J5W2FncmVlT2JqZWN0Lmhpc3RvcnkubGVuZ3RoIC0gMV0gKyBcIiBZb3Ugc2FpZDogXCIgKyBhZ3JlZU9iamVjdC5yZWFzb247XHJcbiAgfSxcclxuXHJcbiAgbGF1bmNoU3RhbmRhcmRNb2RhbDogZnVuY3Rpb24oaGVhZGVyLCB2YWx1ZSwgcmVhc29uLCBpc1VuZG8sIGNhbGxiYWNrT25TYXZlLCBjYWxsYmFja09uQ2FuY2VsLCBjYWxsYmFja09uVW5kbykge1xyXG4gICAgYmFzZS5sYXVuY2hNb2RhbCh7XHJcbiAgICAgIFwiaGVhZGVyXCI6IGhlYWRlcixcclxuICAgICAgXCJpc1VuZG9cIjogaXNVbmRvLFxyXG4gICAgICBcIml0ZW1cIjogdmFsdWUsXHJcbiAgICAgIFwicGxhY2Vob2xkZXJcIjogXCJQcm92aWRlIG1vcmUgaW5mb3JtYXRpb24gaGVyZS4uLlwiXHJcbiAgICB9LCBudWxsLCB2YWx1ZSwgcmVhc29uLCBjYWxsYmFja09uU2F2ZSwgY2FsbGJhY2tPbkNhbmNlbCwgY2FsbGJhY2tPblVuZG8pO1xyXG4gIH1cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGNvbmZpcm07XHJcbiIsInZhciBiYXNlID0gcmVxdWlyZSgnLi4vYmFzZS5qcycpLFxyXG4gIGRhdGEgPSByZXF1aXJlKCcuLi9kYXRhLmpzJyksXHJcbiAgY2hhcnQgPSByZXF1aXJlKCcuLi9jaGFydC5qcycpLFxyXG4gIHBhdGllbnRMaXN0ID0gcmVxdWlyZSgnLi9wYXRpZW50TGlzdC5qcycpO1xyXG5cclxudmFyIElEID0gXCJJTkRJQ0FUT1JfQkVOQ0hNQVJLXCI7XHJcblxyXG52YXIgaVRyZW5kID0ge1xyXG5cclxuICBzaG93OiBmdW5jdGlvbihwYW5lbCwgaXNBcHBlbmQsIHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCkge1xyXG5cclxuICAgIHZhciBlbGVtID0gJChcIjxkaXYgaWQ9J2JlbmNobWFyay1jaGFydCcgY2xhc3M9J2ZpdC10by1zY3JvbGxpbmctc2VjdGlvbi1oZWlnaHQnPjwvZGl2PlwiKTtcclxuXHJcbiAgICBpZiAoaXNBcHBlbmQpIHBhbmVsLmFwcGVuZChlbGVtKTtcclxuICAgIGVsc2UgcGFuZWwuaHRtbChlbGVtKTtcclxuXHJcbiAgICBjaGFydC5kcmF3QmVuY2htYXJrQ2hhcnRIQyhcImJlbmNobWFyay1jaGFydFwiLCBudWxsKTtcclxuXHJcbiAgfSxcclxuXHJcbiAgd2lyZVVwOiBmdW5jdGlvbigpIHtcclxuXHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gaVRyZW5kO1xyXG4iLCJ2YXIgZGF0YSA9IHJlcXVpcmUoJy4uL2RhdGEuanMnKSxcclxuICBjaGFydCA9IHJlcXVpcmUoJy4uL2NoYXJ0LmpzJyk7XHJcblxyXG52YXIgYmQgPSB7XHJcblxyXG4gIHdpcmVVcDogZnVuY3Rpb24oKSB7XHJcblxyXG4gIH0sXHJcblxyXG4gIHNob3c6IGZ1bmN0aW9uKHBhbmVsLCBpc0FwcGVuZCwgcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBzZWxlY3RTZXJpZXNGbikge1xyXG5cclxuICAgIHZhciBpbmRpY2F0b3JzID0gZGF0YS5nZXRJbmRpY2F0b3JEYXRhU3luYyhbcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkXS5qb2luKFwiLlwiKSk7XHJcblxyXG4gICAgdmFyIGRhdGFPYmogPSBpbmRpY2F0b3JzLm9wcG9ydHVuaXRpZXMubWFwKGZ1bmN0aW9uKG9wcCkge1xyXG4gICAgICByZXR1cm4gW29wcC5uYW1lLCBvcHAuZGVzY3JpcHRpb24sIG9wcC5wYXRpZW50cy5sZW5ndGhdO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdmFyIGVsZW0gPSAkKFwiPGRpdiBpZD0nYnJlYWtkb3duLWNoYXJ0Jz48L2Rpdj5cIik7XHJcblxyXG4gICAgaWYgKGlzQXBwZW5kKSBwYW5lbC5hcHBlbmQoZWxlbSk7XHJcbiAgICBlbHNlIHBhbmVsLmh0bWwoZWxlbSk7XHJcblxyXG4gICAgY2hhcnQuZHJhd0FuYWx5dGljcyhcImJyZWFrZG93bi1jaGFydFwiLCBkYXRhT2JqLCBzZWxlY3RTZXJpZXNGbik7XHJcblxyXG4gICAgYmQud2lyZVVwKCk7XHJcblxyXG4gIH1cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGJkO1xyXG4iLCJ2YXIgZGF0YSA9IHJlcXVpcmUoJy4uL2RhdGEuanMnKSxcclxuICBjaGFydCA9IHJlcXVpcmUoJy4uL2NoYXJ0LmpzJyksXHJcbiAgTXVzdGFjaGUgPSByZXF1aXJlKCdtdXN0YWNoZScpO1xyXG5cclxudmFyIGhsID0ge1xyXG5cclxuICB3aXJlVXA6IGZ1bmN0aW9uKCkge1xyXG5cclxuICB9LFxyXG5cclxuICBzaG93OiBmdW5jdGlvbihwYW5lbCwgaXNBcHBlbmQsIHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCkge1xyXG5cclxuICAgIHZhciBpbmRpY2F0b3JzID0gZGF0YS5nZXRJbmRpY2F0b3JEYXRhU3luYyhbcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkXS5qb2luKFwiLlwiKSk7XHJcblxyXG4gICAgdmFyIHRlbXBNdXN0ID0gJCgnI2luZGljYXRvci1oZWFkbGluZS1wYW5lbCcpLmh0bWwoKTtcclxuICAgIHZhciBodG1sID0gTXVzdGFjaGUucmVuZGVyKHRlbXBNdXN0LCBpbmRpY2F0b3JzKTtcclxuXHJcbiAgICBpZihpc0FwcGVuZCkgcGFuZWwuYXBwZW5kKGh0bWwpO1xyXG4gICAgZWxzZSBwYW5lbC5odG1sKGh0bWwpO1xyXG5cclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBobDtcclxuIiwidmFyIGJhc2UgPSByZXF1aXJlKCcuLi9iYXNlLmpzJyksXHJcbiAgbG9nID0gcmVxdWlyZSgnLi4vbG9nLmpzJyksXHJcbiAgZGF0YSA9IHJlcXVpcmUoJy4uL2RhdGEuanMnKSxcclxuICBzcGFya2xpbmUgPSByZXF1aXJlKCdqcXVlcnktc3BhcmtsaW5lJyksXHJcbiAgTXVzdGFjaGUgPSByZXF1aXJlKCdtdXN0YWNoZScpO1xyXG5cclxudmFyIGluZGljYXRvckxpc3QgPSB7XHJcblxyXG4gIHNob3c6IGZ1bmN0aW9uKHBhbmVsLCBpc0FwcGVuZCwgbG9hZENvbnRlbnRGbikge1xyXG4gICAgZGF0YS5nZXRBbGxJbmRpY2F0b3JEYXRhKGZ1bmN0aW9uKGluZGljYXRvcnMpIHtcclxuICAgICAgaW5kaWNhdG9ycy5zb3J0KGZ1bmN0aW9uKGEsYil7XHJcbiAgICAgICAgcmV0dXJuIGEucGVyZm9ybWFuY2UgLSBiLnBlcmZvcm1hbmNlO1xyXG4gICAgICB9KTtcclxuICAgICAgdmFyIHRlbXBNdXN0ID0gJCgnI292ZXJ2aWV3LXBhbmVsLXRhYmxlJykuaHRtbCgpO1xyXG4gICAgICB2YXIgaHRtbCA9IE11c3RhY2hlLnJlbmRlcih0ZW1wTXVzdCwge1xyXG4gICAgICAgIFwiaW5kaWNhdG9yc1wiOiBpbmRpY2F0b3JzXHJcbiAgICAgIH0pO1xyXG4gICAgICBpZiAoaXNBcHBlbmQpIHtcclxuICAgICAgICBwYW5lbC5hcHBlbmQoaHRtbCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcGFuZWwuaHRtbChodG1sKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgJCgnLmlubGluZXNwYXJrbGluZScpLnNwYXJrbGluZSgnaHRtbCcsIHtcclxuICAgICAgICB0b29sdGlwRm9ybWF0dGVyOiBmdW5jdGlvbihzcGFya2xpbmUsIG9wdGlvbnMsIGZpZWxkcykge1xyXG4gICAgICAgICAgdmFyIGR0cyA9IGluZGljYXRvcnNbJCgnLmlubGluZXNwYXJrbGluZScpLmluZGV4KHNwYXJrbGluZS5lbCldLmRhdGVzO1xyXG4gICAgICAgICAgcmV0dXJuIGR0c1tkdHMubGVuZ3RoIC0gMSAtIGZpZWxkcy54XSArIFwiOiBcIiArIGZpZWxkcy55ICsgXCIlXCI7XHJcbiAgICAgICAgfSxcclxuICAgICAgICB3aWR0aDogXCIxMDBweFwiXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgaW5kaWNhdG9yTGlzdC53aXJlVXAocGFuZWwsIGxvYWRDb250ZW50Rm4pO1xyXG5cclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIHBvcHVsYXRlOiBmdW5jdGlvbigpIHtcclxuXHJcbiAgfSxcclxuXHJcbiAgd2lyZVVwOiBmdW5jdGlvbihwYW5lbCwgbG9hZENvbnRlbnRGbikge1xyXG4gICAgcGFuZWwub2ZmKCdjbGljaycsICd0ci5zaG93LW1vcmUtcm93IGEnKTtcclxuICAgIHBhbmVsLm9uKCdjbGljaycsICd0ci5zaG93LW1vcmUtcm93IGEnLCBmdW5jdGlvbihlKSB7XHJcblxyXG4gICAgICAvLyBkbyBub3QgZ2l2ZSBhIGRlZmF1bHQgYWN0aW9uXHJcbiAgICAgIC8vZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAvL3JldHVybiBmYWxzZTtcclxuICAgIH0pO1xyXG5cclxuICAgIHBhbmVsLm9mZignY2xpY2snLCAndHIuc3RhbmRhcmQtcm93LHRyLnNob3ctbW9yZS1yb3cnKTtcclxuICAgIHBhbmVsLm9uKCdjbGljaycsICd0ci5zdGFuZGFyZC1yb3csdHIuc2hvdy1tb3JlLXJvdycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgdmFyIHVybCA9ICQodGhpcykuZGF0YShcImlkXCIpLnJlcGxhY2UoL1xcLi9nLCBcIi9cIik7XHJcbiAgICAgIGhpc3RvcnkucHVzaFN0YXRlKG51bGwsIG51bGwsICcjaW5kaWNhdG9ycy8nICsgdXJsKTtcclxuICAgICAgbG9hZENvbnRlbnRGbignI2luZGljYXRvcnMvJyArIHVybCk7XHJcbiAgICAgIC8vIGRvIG5vdCBnaXZlIGEgZGVmYXVsdCBhY3Rpb25cclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9KTtcclxuXHJcbiAgICBwYW5lbC5vZmYoJ21vdXNlZW50ZXInLCAnLnNob3ctbW9yZS1yb3csLnN0YW5kYXJkLXJvdycpO1xyXG4gICAgcGFuZWwub2ZmKCdtb3VzZWxlYXZlJywgJy5zaG93LW1vcmUtcm93LC5zdGFuZGFyZC1yb3cnKTtcclxuICAgIHBhbmVsLm9uKCdtb3VzZWVudGVyJywgJy5zaG93LW1vcmUtcm93LC5zdGFuZGFyZC1yb3cnLCBmdW5jdGlvbihlKXtcclxuICAgICAgdmFyIGlkID0gJCh0aGlzKS5kYXRhKFwiaWRcIik7XHJcbiAgICAgICQoJy5zaG93LW1vcmUtcm93W2RhdGEtaWQ9XCInICsgaWQgKyAnXCJdLC5zdGFuZGFyZC1yb3dbZGF0YS1pZD1cIicgKyBpZCArICdcIl0nKS5hZGRDbGFzcygnaG92ZXInKTtcclxuICAgIH0pO1xyXG4gICAgcGFuZWwub24oJ21vdXNlbGVhdmUnLCAnLnNob3ctbW9yZS1yb3csLnN0YW5kYXJkLXJvdycsIGZ1bmN0aW9uKGUpe1xyXG4gICAgICB2YXIgaWQgPSAkKHRoaXMpLmRhdGEoXCJpZFwiKTtcclxuICAgICAgJCgnLnNob3ctbW9yZS1yb3dbZGF0YS1pZD1cIicgKyBpZCArICdcIl0sLnN0YW5kYXJkLXJvd1tkYXRhLWlkPVwiJyArIGlkICsgJ1wiXScpLnJlbW92ZUNsYXNzKCdob3ZlcicpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcGFuZWwub2ZmKCdjbGljaycsICcuc2hvdy1tb3JlJyk7XHJcbiAgICBwYW5lbC5vbignY2xpY2snLCAnLnNob3ctbW9yZScsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgdmFyIGlkID0gJCh0aGlzKS5kYXRhKFwiaWRcIik7XHJcbiAgICAgIHZhciBlbGVtID0gJCgnLnNob3ctbW9yZS1yb3dbZGF0YS1pZD1cIicgKyBpZCArICdcIl0nKTtcclxuICAgICAgaWYoZWxlbS5pcygnOnZpc2libGUnKSl7XHJcbiAgICAgICAgJCgnLnNob3ctbW9yZVtkYXRhLWlkPVwiJyArIGlkICsgJ1wiXTpmaXJzdCcpLnNob3coKTtcclxuICAgICAgICBlbGVtLmhpZGUoKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAkKHRoaXMpLmhpZGUoKTtcclxuICAgICAgICBlbGVtLnNob3coJ2Zhc3QnKTtcclxuICAgICAgfVxyXG4gICAgICAvLyBkbyBub3QgZ2l2ZSBhIGRlZmF1bHQgYWN0aW9uXHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gaW5kaWNhdG9yTGlzdDtcclxuIiwidmFyIGJhc2UgPSByZXF1aXJlKCcuLi9iYXNlLmpzJyksXHJcbiAgZGF0YSA9IHJlcXVpcmUoJy4uL2RhdGEuanMnKSxcclxuICBjaGFydCA9IHJlcXVpcmUoJy4uL2NoYXJ0LmpzJyksXHJcbiAgcGF0aWVudExpc3QgPSByZXF1aXJlKCcuL3BhdGllbnRMaXN0LmpzJyk7XHJcblxyXG52YXIgSUQgPSBcIklORElDQVRPUl9UUkVORFwiO1xyXG5cclxudmFyIGlUcmVuZCA9IHtcclxuXHJcbiAgc2hvdzogZnVuY3Rpb24ocGFuZWwsIGlzQXBwZW5kLCBwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQpIHtcclxuXHJcbiAgICB2YXIgaW5kaWNhdG9ycyA9IGRhdGEuZ2V0QWxsSW5kaWNhdG9yRGF0YVN5bmMoKTtcclxuXHJcbiAgICB2YXIgZWxlbSA9ICQoXCI8ZGl2IGlkPSd0cmVuZC1jaGFydCcgY2xhc3M9J2ZpdC10by1zY3JvbGxpbmctc2VjdGlvbi1oZWlnaHQnPjwvZGl2PlwiKTtcclxuXHJcbiAgICBpZiAoaXNBcHBlbmQpIHBhbmVsLmFwcGVuZChlbGVtKTtcclxuICAgIGVsc2UgcGFuZWwuaHRtbChlbGVtKTtcclxuXHJcbiAgICBjaGFydC5kcmF3UGVyZm9ybWFuY2VUcmVuZENoYXJ0SEMoXCJ0cmVuZC1jaGFydFwiLCBpbmRpY2F0b3JzLmZpbHRlcihmdW5jdGlvbih2KXtcclxuICAgICAgcmV0dXJuIHYuaWQ9PT1bcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkXS5qb2luKFwiLlwiKTtcclxuICAgIH0pWzBdKTtcclxuXHJcbiAgfSxcclxuXHJcbiAgd2lyZVVwOiBmdW5jdGlvbigpIHtcclxuXHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gaVRyZW5kO1xyXG4iLCJ2YXIgYmFzZSA9IHJlcXVpcmUoJy4uL2Jhc2UuanMnKSxcclxuICBjb25maXJtID0gcmVxdWlyZSgnLi9jb25maXJtLmpzJyksXHJcbiAgZGF0YSA9IHJlcXVpcmUoJy4uL2RhdGEuanMnKSxcclxuICBsb2cgPSByZXF1aXJlKCcuLi9sb2cuanMnKTtcclxuXHJcbnZhciBpYXAgPSB7XHJcblxyXG4gIGNyZWF0ZTogZnVuY3Rpb24ocGF0aHdheVN0YWdlKSB7XHJcbiAgICByZXR1cm4gYmFzZS5jcmVhdGVQYW5lbCgkKCcjaW5kaXZpZHVhbC1hY3Rpb24tcGxhbi1wYW5lbCcpLCB7XHJcbiAgICAgIFwicGF0aHdheVN0YWdlXCI6IHBhdGh3YXlTdGFnZSB8fCBcImRlZmF1bHRcIixcclxuICAgICAgXCJub0hlYWRlclwiOiB0cnVlXHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICBzaG93OiBmdW5jdGlvbihwYW5lbCwgcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpIHtcclxuICAgIHBhbmVsLmh0bWwoaWFwLmNyZWF0ZShwYXRod2F5U3RhZ2UpKTtcclxuICAgIGlhcC53aXJlVXAocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG5cclxuICAgIHBhbmVsLmZpbmQoJ2Rpdi5maXQtdG8tc2NyZWVuLWhlaWdodCcpLm5pY2VTY3JvbGwoe1xyXG4gICAgICBjdXJzb3JvcGFjaXR5bWluOiAwLjMsXHJcbiAgICAgIGN1cnNvcndpZHRoOiBcIjdweFwiLFxyXG4gICAgICBob3JpenJhaWxlbmFibGVkOiBmYWxzZVxyXG4gICAgfSk7XHJcbiAgfSxcclxuXHJcbiAgd2lyZVVwOiBmdW5jdGlvbihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCkge1xyXG4gICAgaW5kaXZpZHVhbFRhYiA9ICQoJyN0YWItcGxhbi1pbmRpdmlkdWFsJyk7XHJcblxyXG4gICAgLy9maW5kIFtdIGFuZCByZXBsYWNlIHdpdGggY29weSBidXR0b25cclxuXHJcbiAgICAkKCcjYWR2aWNlLWxpc3QnKS5vbignY2xpY2snLCAnLmNyLXN0eWxlZCBpbnB1dFt0eXBlPWNoZWNrYm94XScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgQUNUSU9OSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YSgnaWQnKTtcclxuICAgICAgbG9nLmVkaXRBY3Rpb24oZGF0YS5wYXRpZW50SWQsIEFDVElPTklELCBudWxsLCB0aGlzLmNoZWNrZWQpO1xyXG5cclxuICAgICAgaWYgKHRoaXMuY2hlY2tlZCkge1xyXG4gICAgICAgIGxvZy5yZWNvcmRFdmVudChwYXRod2F5SWQsIGRhdGEucGF0aWVudElkLCBcIkl0ZW0gY29tcGxldGVkXCIpO1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAkKHNlbGYpLnBhcmVudCgpLmF0dHIoXCJ0aXRsZVwiLCBcIlwiKS5hdHRyKFwiZGF0YS1vcmlnaW5hbC10aXRsZVwiLCBcIlwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICQoc2VsZikucGFyZW50KCkuZmFkZU91dCgzMDAsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgcGFyZW50ID0gJCh0aGlzKS5wYXJlbnQoKTtcclxuICAgICAgICAgICAgJCh0aGlzKS5yZXBsYWNlV2l0aChiYXNlLmNyZWF0ZVBhbmVsKCQoJyNjaGVja2JveC10ZW1wbGF0ZScpLCB7XHJcbiAgICAgICAgICAgICAgXCJkb25lXCI6IHRydWVcclxuICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICAgICAgICAgIHBhcmVudC5maW5kKCdidXR0b24nKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICBBQ1RJT05JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKCdpZCcpO1xyXG4gICAgICAgICAgICAgIGxvZy5lZGl0QWN0aW9uKGRhdGEucGF0aWVudElkLCBBQ1RJT05JRCwgbnVsbCwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICQodGhpcykucmVwbGFjZVdpdGgoYmFzZS5jcmVhdGVQYW5lbCgkKCcjY2hlY2tib3gtdGVtcGxhdGUnKSwge1xyXG4gICAgICAgICAgICAgICAgXCJkb25lXCI6IGZhbHNlXHJcbiAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgIGlhcC51cGRhdGVJbmRpdmlkdWFsU2FwUm93cygpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sIDEwMDApO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpYXAudXBkYXRlSW5kaXZpZHVhbFNhcFJvd3MoKTtcclxuICAgIH0pO1xyXG5cclxuICAgICQoJyNwZXJzb25hbFBsYW5JbmRpdmlkdWFsJykub24oJ2NsaWNrJywgJ2lucHV0W3R5cGU9Y2hlY2tib3hdJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBQTEFOSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YShcImlkXCIpO1xyXG4gICAgICBsb2cuZWRpdFBsYW4oUExBTklELCBudWxsLCB0aGlzLmNoZWNrZWQpO1xyXG5cclxuICAgICAgaWYgKHRoaXMuY2hlY2tlZCkge1xyXG4gICAgICAgICQodGhpcykucGFyZW50KCkucGFyZW50KCkucGFyZW50KCkuYWRkQ2xhc3MoJ3N1Y2Nlc3MnKTtcclxuICAgICAgICBsb2cucmVjb3JkRXZlbnQocGF0aHdheUlkLCBkYXRhLnBhdGllbnRJZCwgXCJQZXJzb25hbCBwbGFuIGl0ZW1cIik7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgICQoc2VsZikucGFyZW50KCkuYXR0cihcInRpdGxlXCIsIFwiXCIpLmF0dHIoXCJkYXRhLW9yaWdpbmFsLXRpdGxlXCIsIFwiXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgJChzZWxmKS5wYXJlbnQoKS5mYWRlT3V0KDMwMCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBwYXJlbnQgPSAkKHRoaXMpLnBhcmVudCgpO1xyXG4gICAgICAgICAgICAkKHRoaXMpLnJlcGxhY2VXaXRoKGJhc2UuY3JlYXRlUGFuZWwoJCgnI2NoZWNrYm94LXRlbXBsYXRlJyksIHtcclxuICAgICAgICAgICAgICBcImRvbmVcIjogdHJ1ZVxyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgICAgICAgICAgcGFyZW50LmZpbmQoJ2J1dHRvbicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgIFBMQU5JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKCdpZCcpO1xyXG4gICAgICAgICAgICAgIGxvZy5lZGl0UGxhbihkYXRhLnBhdGllbnRJZCwgUExBTklELCBudWxsLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgJCh0aGlzKS5yZXBsYWNlV2l0aChiYXNlLmNyZWF0ZVBhbmVsKCQoJyNjaGVja2JveC10ZW1wbGF0ZScpLCB7XHJcbiAgICAgICAgICAgICAgICBcImRvbmVcIjogZmFsc2VcclxuICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgaWFwLnVwZGF0ZUluZGl2aWR1YWxTYXBSb3dzKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSwgMTAwMCk7XHJcbiAgICAgIH1cclxuICAgIH0pLm9uKCdjbGljaycsICcuYnRuLXVuZG8nLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIHZhciBQTEFOSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YSgnaWQnKTtcclxuICAgICAgbG9nLmVkaXRQbGFuKFBMQU5JRCwgbnVsbCwgZmFsc2UpO1xyXG4gICAgICAkKHRoaXMpLnJlcGxhY2VXaXRoKGJhc2UuY3JlYXRlUGFuZWwoJCgnI2NoZWNrYm94LXRlbXBsYXRlJyksIHtcclxuICAgICAgICBcImRvbmVcIjogZmFsc2VcclxuICAgICAgfSkpO1xyXG4gICAgICBpYXAudXBkYXRlSW5kaXZpZHVhbFNhcFJvd3MoKTtcclxuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGluZGl2aWR1YWxUYWIub24oJ2NsaWNrJywgJy5lZGl0LXBsYW4nLCBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIFBMQU5JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKFwiaWRcIik7XHJcblxyXG4gICAgICAkKCcjZWRpdEFjdGlvblBsYW5JdGVtJykudmFsKCQoJCh0aGlzKS5jbG9zZXN0KCd0cicpLmNoaWxkcmVuKCd0ZCcpWzBdKS5maW5kKCdzcGFuJykudGV4dCgpKTtcclxuXHJcbiAgICAgICQoJyNlZGl0UGxhbicpLm9mZignaGlkZGVuLmJzLm1vZGFsJykub24oJ2hpZGRlbi5icy5tb2RhbCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlhcC5kaXNwbGF5UGVyc29uYWxpc2VkSW5kaXZpZHVhbEFjdGlvblBsYW4oZGF0YS5wYXRpZW50SWQsICQoJyNwZXJzb25hbFBsYW5JbmRpdmlkdWFsJykpO1xyXG4gICAgICB9KS5vZmYoJ3Nob3duLmJzLm1vZGFsJykub24oJ3Nob3duLmJzLm1vZGFsJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgJCgnI2VkaXRBY3Rpb25QbGFuSXRlbScpLmZvY3VzKCk7XHJcbiAgICAgIH0pLm9mZignY2xpY2snLCAnLnNhdmUtcGxhbicpLm9uKCdjbGljaycsICcuc2F2ZS1wbGFuJywgZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgIGxvZy5lZGl0UGxhbihQTEFOSUQsICQoJyNlZGl0QWN0aW9uUGxhbkl0ZW0nKS52YWwoKSk7XHJcblxyXG4gICAgICAgICQoJyNlZGl0UGxhbicpLm1vZGFsKCdoaWRlJyk7XHJcbiAgICAgIH0pLm9mZigna2V5dXAnLCAnI2VkaXRBY3Rpb25QbGFuSXRlbScpLm9uKCdrZXl1cCcsICcjZWRpdEFjdGlvblBsYW5JdGVtJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgIGlmIChlLndoaWNoID09PSAxMykgJCgnI2VkaXRQbGFuIC5zYXZlLXBsYW4nKS5jbGljaygpO1xyXG4gICAgICB9KS5tb2RhbCgpO1xyXG4gICAgfSkub24oJ2NsaWNrJywgJy5kZWxldGUtcGxhbicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgUExBTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoXCJpZFwiKTtcclxuXHJcbiAgICAgICQoJyNpbmRpdmlkdWFsLWRlbGV0ZS1pdGVtJykuaHRtbCgkKCQodGhpcykuY2xvc2VzdCgndHInKS5jaGlsZHJlbigndGQnKVswXSkuZmluZCgnc3BhbicpLnRleHQoKSk7XHJcblxyXG4gICAgICAkKCcjZGVsZXRlUGxhbicpLm9mZignaGlkZGVuLmJzLm1vZGFsJykub24oJ2hpZGRlbi5icy5tb2RhbCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlhcC5kaXNwbGF5UGVyc29uYWxpc2VkSW5kaXZpZHVhbEFjdGlvblBsYW4oZGF0YS5wYXRpZW50SWQsICQoJyNwZXJzb25hbFBsYW5JbmRpdmlkdWFsJykpO1xyXG4gICAgICB9KS5vZmYoJ2NsaWNrJywgJy5kZWxldGUtcGxhbicpLm9uKCdjbGljaycsICcuZGVsZXRlLXBsYW4nLCBmdW5jdGlvbigpIHtcclxuICAgICAgICBsb2cuZGVsZXRlUGxhbihQTEFOSUQpO1xyXG5cclxuICAgICAgICAkKCcjZGVsZXRlUGxhbicpLm1vZGFsKCdoaWRlJyk7XHJcbiAgICAgIH0pLm1vZGFsKCk7XHJcbiAgICB9KS5vbignY2xpY2snLCAnLmFkZC1wbGFuJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIGxvZy5yZWNvcmRQbGFuKGRhdGEucGF0aWVudElkLCAkKHRoaXMpLnBhcmVudCgpLnBhcmVudCgpLmZpbmQoJ3RleHRhcmVhJykudmFsKCksIHBhdGh3YXlJZCk7XHJcblxyXG4gICAgICBpYXAuZGlzcGxheVBlcnNvbmFsaXNlZEluZGl2aWR1YWxBY3Rpb25QbGFuKGRhdGEucGF0aWVudElkLCAkKCcjcGVyc29uYWxQbGFuSW5kaXZpZHVhbCcpKTtcclxuICAgIH0pLm9uKCdjaGFuZ2UnLCAnLmJ0bi10b2dnbGUgaW5wdXRbdHlwZT1jaGVja2JveF0nLCBmdW5jdGlvbigpIHtcclxuICAgICAgaWFwLnVwZGF0ZUluZGl2aWR1YWxTYXBSb3dzKCk7XHJcbiAgICB9KS5vbignY2xpY2snLCAnLmJ0bi11bmRvJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICB2YXIgQUNUSU9OSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YSgnaWQnKTtcclxuICAgICAgbG9nLmVkaXRBY3Rpb24oZGF0YS5wYXRpZW50SWQsIEFDVElPTklELCBudWxsLCBmYWxzZSk7XHJcbiAgICAgICQodGhpcykucmVwbGFjZVdpdGgoYmFzZS5jcmVhdGVQYW5lbCgkKCcjY2hlY2tib3gtdGVtcGxhdGUnKSwge1xyXG4gICAgICAgIFwiZG9uZVwiOiBmYWxzZVxyXG4gICAgICB9KSk7XHJcbiAgICAgIGlhcC51cGRhdGVJbmRpdmlkdWFsU2FwUm93cygpO1xyXG4gICAgfSkub24oJ2NsaWNrJywgJy5idG4teWVzLC5idG4tbm8nLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIHZhciBjaGVja2JveCA9ICQodGhpcykuZmluZChcImlucHV0W3R5cGU9Y2hlY2tib3hdXCIpO1xyXG4gICAgICB2YXIgb3RoZXIgPSAkKHRoaXMpLnBhcmVudCgpLmZpbmQoJCh0aGlzKS5oYXNDbGFzcyhcImJ0bi15ZXNcIikgPyBcIi5idG4tbm9cIiA6IFwiLmJ0bi15ZXNcIik7XHJcbiAgICAgIHZhciBBQ1RJT05JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKCdpZCcpO1xyXG4gICAgICBpZiAoJCh0aGlzKS5oYXNDbGFzcyhcImFjdGl2ZVwiKSAmJiBvdGhlci5oYXNDbGFzcyhcImluYWN0aXZlXCIpICYmICEkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuaGFzQ2xhc3MoJ3N1Y2Nlc3MnKSkge1xyXG4gICAgICAgIC8vdW5zZWxlY3RpbmdcclxuICAgICAgICBpZiAoY2hlY2tib3gudmFsKCkgPT09IFwibm9cIikge1xyXG4gICAgICAgICAgaWFwLmxhdW5jaE1vZGFsKGRhdGEuc2VsZWN0ZWQsIGNoZWNrYm94LmNsb3Nlc3QoJ3RyJykuY2hpbGRyZW4oKS5maXJzdCgpLmNoaWxkcmVuKCkuZmlyc3QoKS50ZXh0KCksIGxvZy5nZXRSZWFzb24oZGF0YS5wYXRpZW50SWQsIEFDVElPTklEKSwgdHJ1ZSwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGxvZy5lZGl0QWN0aW9uKGRhdGEucGF0aWVudElkLCBBQ1RJT05JRCwgZmFsc2UsIG51bGwsIGxvZy5yZWFzb24pO1xyXG4gICAgICAgICAgICBpYXAudXBkYXRlSW5kaXZpZHVhbFNhcFJvd3MoKTtcclxuICAgICAgICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgICAgICAgfSwgbnVsbCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGxvZy5pZ25vcmVBY3Rpb24oZGF0YS5wYXRpZW50SWQsIEFDVElPTklEKTtcclxuICAgICAgICAgICAgb3RoZXIucmVtb3ZlQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgY2hlY2tib3gucmVtb3ZlQXR0cihcImNoZWNrZWRcIik7XHJcbiAgICAgICAgICAgIGNoZWNrYm94LnBhcmVudCgpLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICBpYXAudXBkYXRlSW5kaXZpZHVhbFNhcFJvd3MoKTtcclxuICAgICAgICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBsb2cuaWdub3JlQWN0aW9uKGRhdGEucGF0aWVudElkLCBBQ1RJT05JRCk7XHJcbiAgICAgICAgICBvdGhlci5yZW1vdmVDbGFzcyhcImluYWN0aXZlXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIGlmICgoISQodGhpcykuaGFzQ2xhc3MoXCJhY3RpdmVcIikgJiYgb3RoZXIuaGFzQ2xhc3MoXCJhY3RpdmVcIikpIHx8ICQodGhpcykuY2xvc2VzdCgndHInKS5oYXNDbGFzcygnc3VjY2VzcycpKSB7XHJcbiAgICAgICAgLy9wcmV2ZW50IGNsaWNraW5nIG9uIHVuc2VsZWN0ZWQgb3B0aW9uIG9yIGlmIHRoZSByb3cgaXMgY29tcGxldGVcclxuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy9zZWxlY3RpbmdcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgaWYgKGNoZWNrYm94LnZhbCgpID09PSBcIm5vXCIpIHtcclxuICAgICAgICAgIGlhcC5sYXVuY2hNb2RhbChkYXRhLnNlbGVjdGVkLCBjaGVja2JveC5jbG9zZXN0KCd0cicpLmNoaWxkcmVuKCkuZmlyc3QoKS5jaGlsZHJlbigpLmZpcnN0KCkudGV4dCgpLCBsb2cuZ2V0UmVhc29uKGRhdGEucGF0aWVudElkLCBBQ1RJT05JRCksIGZhbHNlLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgbG9nLmVkaXRBY3Rpb24oZGF0YS5wYXRpZW50SWQsIEFDVElPTklELCBmYWxzZSwgbnVsbCwgbG9nLnJlYXNvbik7XHJcbiAgICAgICAgICAgICQoc2VsZikucmVtb3ZlQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuXHJcbiAgICAgICAgICAgIGNoZWNrYm94LmF0dHIoXCJjaGVja2VkXCIsIFwiY2hlY2tlZFwiKTtcclxuICAgICAgICAgICAgY2hlY2tib3gucGFyZW50KCkuYWRkQ2xhc3MoXCJhY3RpdmVcIik7XHJcbiAgICAgICAgICAgIC8vdW5zZWxlY3Qgb3RoZXJcclxuICAgICAgICAgICAgb3RoZXIucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIikuYWRkQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgb3RoZXIuZmluZChcImlucHV0W3R5cGU9Y2hlY2tib3hdXCIpLnByb3AoXCJjaGVja2VkXCIsIGZhbHNlKTtcclxuICAgICAgICAgICAgaWFwLnVwZGF0ZUluZGl2aWR1YWxTYXBSb3dzKCk7XHJcbiAgICAgICAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgbG9nLmVkaXRBY3Rpb24oZGF0YS5wYXRpZW50SWQsIEFDVElPTklELCB0cnVlKTtcclxuICAgICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuXHJcbiAgICAgICAgICAvL3Vuc2VsZWN0IG90aGVyXHJcbiAgICAgICAgICBvdGhlci5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKS5hZGRDbGFzcyhcImluYWN0aXZlXCIpO1xyXG4gICAgICAgICAgb3RoZXIuZmluZChcImlucHV0W3R5cGU9Y2hlY2tib3hdXCIpLnByb3AoXCJjaGVja2VkXCIsIGZhbHNlKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pLm9uKCdrZXl1cCcsICdpbnB1dFt0eXBlPXRleHRdJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICBpZiAoZS53aGljaCA9PT0gMTMpIHtcclxuICAgICAgICBpbmRpdmlkdWFsVGFiLmZpbmQoJy5hZGQtcGxhbicpLmNsaWNrKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgICQoJyNhZHZpY2UtbGlzdCcpLm9mZignY2xpY2snLCAnLnNob3ctbW9yZScpO1xyXG4gICAgJCgnI2FkdmljZS1saXN0Jykub24oJ2NsaWNrJywgJy5zaG93LW1vcmUnLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIHZhciBpZCA9ICQodGhpcykuZGF0YShcImlkXCIpO1xyXG4gICAgICB2YXIgZWxlbSA9ICQoJy5zaG93LW1vcmUtcm93W2RhdGEtaWQ9XCInICsgaWQgKyAnXCJdJyk7XHJcbiAgICAgIGlmKGVsZW0uaXMoJzp2aXNpYmxlJykpe1xyXG4gICAgICAgICQoJy5zaG93LW1vcmVbZGF0YS1pZD1cIicgKyBpZCArICdcIl06Zmlyc3QnKS5zaG93KCk7XHJcbiAgICAgICAgZWxlbS5oaWRlKCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgJCh0aGlzKS5oaWRlKCk7XHJcbiAgICAgICAgZWxlbS5zaG93KCdmYXN0Jyk7XHJcbiAgICAgIH1cclxuICAgICAgLy8gZG8gbm90IGdpdmUgYSBkZWZhdWx0IGFjdGlvblxyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0pO1xyXG5cclxuICAgIGlhcC5wb3B1bGF0ZUluZGl2aWR1YWxTdWdnZXN0ZWRBY3Rpb25zKHBhdGllbnRJZCwgcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkKTtcclxuICB9LFxyXG5cclxuICB1cGRhdGVJbmRpdmlkdWFsU2FwUm93czogZnVuY3Rpb24oKSB7XHJcbiAgICAvKiQoJyNhZHZpY2UtbGlzdCcpLmFkZCgnI3BlcnNvbmFsUGxhbkluZGl2aWR1YWwnKS5maW5kKCcuc3VnZ2VzdGlvbicpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgICQodGhpcykuZmluZCgndGQnKS5sYXN0KCkuY2hpbGRyZW4oKS5oaWRlKCk7XHJcbiAgICB9KTsqL1xyXG5cclxuICAgIC8qJCgnI2FkdmljZS1saXN0JykuYWRkKCcjcGVyc29uYWxQbGFuSW5kaXZpZHVhbCcpLmZpbmQoJy5jci1zdHlsZWQgaW5wdXRbdHlwZT1jaGVja2JveF0nKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICBpZiAodGhpcy5jaGVja2VkKSB7XHJcbiAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5wYXJlbnQoKS5wYXJlbnQoKS5hZGRDbGFzcygnc3VjY2VzcycpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgICQodGhpcykucGFyZW50KCkucGFyZW50KCkucGFyZW50KCkucmVtb3ZlQ2xhc3MoJ3N1Y2Nlc3MnKTtcclxuICAgICAgfVxyXG4gICAgfSk7Ki9cclxuXHJcbiAgICAvKiQoJyNhZHZpY2UtbGlzdCcpLmFkZCgnI3BlcnNvbmFsUGxhbkluZGl2aWR1YWwnKS5maW5kKCcuYnRuLXVuZG8nKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICAkKHRoaXMpLnBhcmVudCgpLnBhcmVudCgpLmFkZENsYXNzKCdzdWNjZXNzJyk7XHJcbiAgICB9KTsqL1xyXG5cclxuICAgIC8vbm8gY2xhc3MgLSB1c2VyIG5vdCB5ZXQgYWdyZWVkL2Rpc2FncmVlZCAtIG5vIGJhY2tncm91bmQgLyBtdXRlZCB0ZXh0XHJcbiAgICAvL2FjdGl2ZSAtIHVzZXIgYWdyZWVzIC0gZ3JlZW4gYmFja2dyb3VuZCAvIG5vcm1hbCB0ZXh0XHJcbiAgICAvL3N1Y2Nlc3MgLSB1c2VyIGNvbXBsZXRlZCAtIGdyZWVuIGJhY2tncm91bmQgLyBzdHJpa2V0aHJvdWdoIHRleHRcclxuICAgIC8vZGFuZ2VyIC0gdXNlciBkaXNhZ3JlZXMgLSByZWQgYmFja2dyb3VuZCAvIHN0cmlrZXRocm91Z2ggdGV4dFxyXG5cclxuICAgICQoJyNhZHZpY2UtbGlzdCcpLmFkZCgnI3BlcnNvbmFsUGxhbkluZGl2aWR1YWwnKS5maW5kKCd0ci5zdWdnZXN0aW9uJykuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIHNlbGYgPSAkKHRoaXMpO1xyXG4gICAgICB2YXIgaWQgPSBzZWxmLmRhdGEoXCJpZFwiKTtcclxuICAgICAgdmFyIGFsbCA9ICQoJy5zaG93LW1vcmUtcm93W2RhdGEtaWQ9XCInICsgaWQgKyAnXCJdLC5zdWdnZXN0aW9uW2RhdGEtaWQ9XCInICsgaWQgKyAnXCJdJyk7XHJcbiAgICAgIHZhciBhbnkgPSBmYWxzZTtcclxuICAgICAgc2VsZi5maW5kKCcuYnRuLXRvZ2dsZSBpbnB1dFt0eXBlPWNoZWNrYm94XTpjaGVja2VkJykuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgICBhbnkgPSB0cnVlO1xyXG4gICAgICAgIGlmICh0aGlzLnZhbHVlID09PSBcInllc1wiKSB7XHJcbiAgICAgICAgICBhbGwucmVtb3ZlQ2xhc3MoJ2RhbmdlcicpO1xyXG4gICAgICAgICAgYWxsLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgIC8vc2VsZi5maW5kKCd0ZCcpLmxhc3QoKS5jaGlsZHJlbigpLnNob3coKTtcclxuICAgICAgICAgIGlmIChsb2cuZ2V0QWN0aW9ucygpW2RhdGEucGF0aWVudElkXVtzZWxmLmRhdGEoXCJpZFwiKV0uaGlzdG9yeSkge1xyXG4gICAgICAgICAgICB2YXIgdG9vbCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5oYXNDbGFzcygnc3VjY2VzcycpID8gXCJcIiA6IFwiPHA+XCIgKyBsb2cuZ2V0QWN0aW9ucygpW2RhdGEucGF0aWVudElkXVtzZWxmLmRhdGEoXCJpZFwiKV0uaGlzdG9yeVswXSArIFwiPC9wPjxwPkNsaWNrIGFnYWluIHRvIGNhbmNlbDwvcD5cIjtcclxuICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5hdHRyKFwidGl0bGVcIiwgdG9vbCkuYXR0cihcImRhdGEtb3JpZ2luYWwtdGl0bGVcIiwgdG9vbCkudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAkKHRoaXMpLnBhcmVudCgpLmF0dHIoXCJ0aXRsZVwiLCBcIllvdSBhZ3JlZWQgLSBjbGljayBhZ2FpbiB0byBjYW5jZWxcIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGFsbC5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgICBhbGwuYWRkQ2xhc3MoJ2RhbmdlcicpO1xyXG4gICAgICAgICAgYWxsLnJlbW92ZUNsYXNzKCdzdWNjZXNzJyk7XHJcbiAgICAgICAgICBpZiAobG9nLmdldEFjdGlvbnMoKVtkYXRhLnBhdGllbnRJZF1bc2VsZi5kYXRhKFwiaWRcIildICYmIGxvZy5nZXRBY3Rpb25zKClbZGF0YS5wYXRpZW50SWRdW3NlbGYuZGF0YShcImlkXCIpXS5oaXN0b3J5KSB7XHJcbiAgICAgICAgICAgICQodGhpcykucGFyZW50KCkuYXR0cihcInRpdGxlXCIsIFwiPHA+XCIgKyBsb2cuZ2V0QWN0aW9ucygpW2RhdGEucGF0aWVudElkXVtzZWxmLmRhdGEoXCJpZFwiKV0uaGlzdG9yeVswXSArIFwiPC9wPjxwPkNsaWNrIGFnYWluIHRvIGVkaXQvY2FuY2VsPC9wPlwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICQodGhpcykucGFyZW50KCkuYXR0cihcInRpdGxlXCIsIFwiWW91IGRpc2FncmVlZCAtIGNsaWNrIGFnYWluIHRvIGVkaXQvY2FuY2VsXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICAgIGlmIChzZWxmLmZpbmQoJy5idG4tdG9nZ2xlIGlucHV0W3R5cGU9Y2hlY2tib3hdOm5vdCg6Y2hlY2tlZCknKS5sZW5ndGggPT0gMSkge1xyXG4gICAgICAgIHNlbGYuZmluZCgnLmJ0bi10b2dnbGUgaW5wdXRbdHlwZT1jaGVja2JveF06bm90KDpjaGVja2VkKScpLnBhcmVudCgpLmFkZENsYXNzKFwiaW5hY3RpdmVcIikuYXR0cihcInRpdGxlXCIsIFwiXCIpLmF0dHIoXCJkYXRhLW9yaWdpbmFsLXRpdGxlXCIsIFwiXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICghYW55KSB7XHJcbiAgICAgICAgYWxsLnJlbW92ZUNsYXNzKCdkYW5nZXInKTtcclxuICAgICAgICBhbGwucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgIGFsbC5yZW1vdmVDbGFzcygnc3VjY2VzcycpO1xyXG5cclxuICAgICAgICBzZWxmLmZpbmQoJy5idG4tdG9nZ2xlLmJ0bi15ZXMnKS5hdHRyKFwidGl0bGVcIiwgXCJDbGljayB0byBhZ3JlZSB3aXRoIHRoaXMgYWN0aW9uIGFuZCBzYXZlIGl0IGluIHlvdXIgYWdyZWVkIGFjdGlvbnMgbGlzdCAgXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgIHNlbGYuZmluZCgnLmJ0bi10b2dnbGUuYnRuLW5vJykuYXR0cihcInRpdGxlXCIsIFwiQ2xpY2sgdG8gZGlzYWdyZWUgd2l0aCB0aGlzIGFjdGlvbiBhbmQgcmVtb3ZlIGl0IGZyb20geW91ciBzdWdnZXN0ZWQgYWN0aW9ucyBsaXN0IFwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgfSk7XHJcbiAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgfSxcclxuXHJcbiAgZGlzcGxheVBlcnNvbmFsaXNlZEluZGl2aWR1YWxBY3Rpb25QbGFuOiBmdW5jdGlvbihpZCwgcGFyZW50RWxlbSkge1xyXG4gICAgdmFyIHBsYW5zID0gYmFzZS5zb3J0U3VnZ2VzdGlvbnMoYmFzZS5hZGREaXNhZ3JlZVBlcnNvbmFsVGVhbShsb2cubGlzdFBsYW5zKGlkKSkpO1xyXG5cclxuICAgIGJhc2UuY3JlYXRlUGFuZWxTaG93KGFjdGlvblBsYW5MaXN0LCBwYXJlbnRFbGVtLCB7XHJcbiAgICAgIFwiaGFzU3VnZ2VzdGlvbnNcIjogcGxhbnMgJiYgcGxhbnMubGVuZ3RoID4gMCxcclxuICAgICAgXCJzdWdnZXN0aW9uc1wiOiBwbGFuc1xyXG4gICAgfSwge1xyXG4gICAgICBcImFjdGlvbi1wbGFuXCI6ICQoJyNhY3Rpb24tcGxhbicpLmh0bWwoKSxcclxuICAgICAgXCJhY3Rpb24tcGxhbi1pdGVtXCI6ICQoJyNhY3Rpb24tcGxhbi1pdGVtJykuaHRtbCgpLFxyXG4gICAgICBcImNoa1wiOiAkKCcjY2hlY2tib3gtdGVtcGxhdGUnKS5odG1sKClcclxuICAgIH0pO1xyXG5cclxuICAgIGlhcC51cGRhdGVJbmRpdmlkdWFsU2FwUm93cygpO1xyXG4gIH0sXHJcblxyXG4gIHBvcHVsYXRlSW5kaXZpZHVhbFN1Z2dlc3RlZEFjdGlvbnM6IGZ1bmN0aW9uKHBhdGllbnRJZCwgcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkKSB7XHJcbiAgICB2YXIgbG9jYWxEYXRhID0ge1xyXG4gICAgICBcIm5oc051bWJlclwiOiBkYXRhLnBhdExvb2t1cCA/IGRhdGEucGF0TG9va3VwW3BhdGllbnRJZF0gOiBwYXRpZW50SWQsXHJcbiAgICAgIFwicGF0aWVudElkXCI6IHBhdGllbnRJZFxyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgcGF0aWVudERhdGEgPSBkYXRhLmdldFBhdGllbnREYXRhKHBhdGllbnRJZCk7XHJcblxyXG4gICAgdmFyIGJyZWFjaGVzID0gZGF0YS5wYXRpZW50c1twYXRpZW50SWRdLmJyZWFjaCA/IGRhdGEucGF0aWVudHNbcGF0aWVudElkXS5icmVhY2guZmlsdGVyKGZ1bmN0aW9uKHYpIHtcclxuICAgICAgcmV0dXJuIHYucGF0aHdheUlkID09PSBwYXRod2F5SWQgJiYgdi5wYXRod2F5U3RhZ2UgPT09IHBhdGh3YXlTdGFnZSAmJiB2LnN0YW5kYXJkID09PSBzdGFuZGFyZDtcclxuICAgIH0pIDogW107XHJcblxyXG4gICAgdmFyIGZuID0gZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgXCJpZFwiOiB2YWwsXHJcbiAgICAgICAgXCJzdWJzZWN0aW9uXCI6IHN1YnNlY3Rpb25cclxuICAgICAgfTtcclxuICAgIH07XHJcblxyXG4gICAgaWYgKHBhdGllbnREYXRhLmFjdGlvbnMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIGxvY2FsRGF0YS5ub1N1Z2dlc3Rpb25zID0gdHJ1ZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8qdmFyIHN1Z2dlc3Rpb25zID0gW10sXHJcbiAgICAgICAgc3Vic2VjdGlvbiA9IFwiXCI7XHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYnJlYWNoZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBzdWJzZWN0aW9uID0gYnJlYWNoZXNbaV0uc3Vic2VjdGlvbjtcclxuICAgICAgICBzdWdnZXN0aW9ucyA9IHN1Z2dlc3Rpb25zLmNvbmNhdChkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5iZG93bltzdWJzZWN0aW9uXS5zdWdnZXN0aW9ucyA/XHJcbiAgICAgICAgICBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5iZG93bltzdWJzZWN0aW9uXS5zdWdnZXN0aW9ucy5tYXAoZm4pIDogW10pO1xyXG4gICAgICB9Ki9cclxuXHJcbiAgICAgIGxvY2FsRGF0YS5zdWdnZXN0aW9ucyA9IGJhc2Uuc29ydFN1Z2dlc3Rpb25zKGJhc2UubWVyZ2VJbmRpdmlkdWFsU3R1ZmYocGF0aWVudERhdGEuYWN0aW9ucywgcGF0aWVudElkKSk7XHJcbiAgICAgIC8qbG9jYWxEYXRhLnNlY3Rpb24gPSB7XHJcbiAgICAgICAgXCJuYW1lXCI6IGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLmJkb3duW3N1YnNlY3Rpb25dLm5hbWUsXHJcbiAgICAgICAgXCJhZ3JlZVwiOiBsb2cuZ2V0UGF0aWVudEFncmVlKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBwYXRpZW50SWQsIFwic2VjdGlvblwiKSA9PT0gdHJ1ZSxcclxuICAgICAgICBcImRpc2FncmVlXCI6IGxvZy5nZXRQYXRpZW50QWdyZWUocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHBhdGllbnRJZCwgXCJzZWN0aW9uXCIpID09PSBmYWxzZSxcclxuICAgICAgfTtcclxuICAgICAgbG9jYWxEYXRhLmNhdGVnb3J5ID0ge1xyXG4gICAgICAgIFwibmFtZVwiOiBkYXRhLnBhdGllbnRzW3BhdGllbnRJZF0uY2F0ZWdvcnksXHJcbiAgICAgICAgXCJhZ3JlZVwiOiBsb2cuZ2V0UGF0aWVudEFncmVlKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBwYXRpZW50SWQsIFwiY2F0ZWdvcnlcIikgPT09IHRydWUsXHJcbiAgICAgICAgXCJkaXNhZ3JlZVwiOiBsb2cuZ2V0UGF0aWVudEFncmVlKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBwYXRpZW50SWQsIFwiY2F0ZWdvcnlcIikgPT09IGZhbHNlLFxyXG4gICAgICB9OyovXHJcbiAgICB9XHJcblxyXG4gICAgJCgnI2FkdmljZS1wbGFjZWhvbGRlcicpLmhpZGUoKTtcclxuICAgICQoJyNhZHZpY2UnKS5zaG93KCk7XHJcblxyXG4gICAgYmFzZS5jcmVhdGVQYW5lbFNob3coaW5kaXZpZHVhbFBhbmVsLCAkKCcjYWR2aWNlLWxpc3QnKSwgbG9jYWxEYXRhKTtcclxuXHJcbiAgICAvL1dpcmUgdXAgYW55IGNsaXBib2FyZCBzdHVmZiBpbiB0aGUgc3VnZ2VzdGlvbnNcclxuICAgICQoJyNhZHZpY2UtbGlzdCcpLmZpbmQoJ3NwYW46Y29udGFpbnMoXCJbQ09QWVwiKScpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBodG1sID0gJCh0aGlzKS5odG1sKCk7XHJcbiAgICAgICQodGhpcykuaHRtbChodG1sLnJlcGxhY2UoL1xcW0NPUFk6KFteXFxdXSopXFxdL2csICckMSA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBkYXRhLWNsaXBib2FyZC10ZXh0PVwiJDFcIiBkYXRhLWNvbnRlbnQ9XCJDb3BpZWRcIiBkYXRhLXRvZ2dsZT1cInRvb2x0aXBcIiBkYXRhLXBsYWNlbWVudD1cInRvcFwiIHRpdGxlPVwiQ29weSAkMSB0byBjbGlwYm9hcmQuXCIgY2xhc3M9XCJidG4gYnRuLXhzIGJ0bi1kZWZhdWx0IGJ0bi1jb3B5XCI+PHNwYW4gY2xhc3M9XCJmYSBmYS1jbGlwYm9hcmRcIj48L3NwYW4+PC9idXR0b24+JykpO1xyXG4gICAgfSk7XHJcbiAgICAkKCcjYWR2aWNlLWxpc3QnKS5maW5kKCdzcGFuOmNvbnRhaW5zKFwiW1wiKScpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBodG1sID0gJCh0aGlzKS5odG1sKCk7XHJcbiAgICAgICQodGhpcykuaHRtbChodG1sLnJlcGxhY2UoL1xcWyhbXlxcXV0qKVxcXS9nLCAnIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIGRhdGEtY2xpcGJvYXJkLXRleHQ9XCIkMVwiIGRhdGEtY29udGVudD1cIkNvcGllZFwiIGRhdGEtdG9nZ2xlPVwidG9vbHRpcFwiIGRhdGEtcGxhY2VtZW50PVwidG9wXCIgdGl0bGU9XCJDb3B5ICQxIHRvIGNsaXBib2FyZC5cIiBjbGFzcz1cImJ0biBidG4teHMgYnRuLWRlZmF1bHQgYnRuLWNvcHlcIj48c3BhbiBjbGFzcz1cImZhIGZhLWNsaXBib2FyZFwiPjwvc3Bhbj48L2J1dHRvbj4nKSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAkKCcjYWR2aWNlLWxpc3QnKS5maW5kKCdzcGFuOmNvbnRhaW5zKFwiW0lORk9cIiknKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgaHRtbCA9ICQodGhpcykuaHRtbCgpO1xyXG4gICAgICB2YXIgc3Vic2VjdGlvbiA9ICQodGhpcykuZGF0YSgpLnN1YnNlY3Rpb247XHJcbiAgICAgIHZhciBkZXNjID0gZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS5vcHBvcnR1bml0aWVzLmZpbHRlcihmdW5jdGlvbih2YWwpIHtcclxuICAgICAgICAgIHJldHVybiB2YWwubmFtZSA9PT0gc3Vic2VjdGlvbjtcclxuICAgICAgICB9KS5sZW5ndGggPiAwID9cclxuICAgICAgICBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLm9wcG9ydHVuaXRpZXMuZmlsdGVyKGZ1bmN0aW9uKHZhbCkge1xyXG4gICAgICAgICAgcmV0dXJuIHZhbC5uYW1lID09PSBzdWJzZWN0aW9uO1xyXG4gICAgICAgIH0pWzBdLmRlc2MgOiBzdWJzZWN0aW9uO1xyXG4gICAgICB2YXIgdG9vbHRpcCA9IHN1YnNlY3Rpb24gPyBcIlRoaXMgYWN0aW9uIGlzIHN1Z2dlc3RlZCBiZWNhdXNlIFBJTkdSIGNsYXNzaWZpZWQgdGhpcyBwYXRpZW50IGFzOidcIiArIGRlc2MgKyBcIidcIiA6ICcnO1xyXG4gICAgICB2YXIgbmV3SHRtbCA9ICcgPGkgY2xhc3M9XCJmYSBmYS1pbmZvLWNpcmNsZSBmYS1sZyBpbmZvLWJ1dHRvbiBjbGlja2FibGVcIiBkYXRhLXRvZ2dsZT1cInRvb2x0aXBcIiBkYXRhLXBsYWNlbWVudD1cInJpZ2h0XCIgdGl0bGU9XCInICsgdG9vbHRpcCArICdcIj48L2k+JztcclxuICAgICAgJCh0aGlzKS5odG1sKGh0bWwucmVwbGFjZSgvXFxbSU5GT1xcXS9nLCBuZXdIdG1sKSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAkKCcjYWR2aWNlLWxpc3QnKS5maW5kKCdzcGFuOmNvbnRhaW5zKFwiW01FRC1TVUdHRVNUSU9OXCIpJykuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIGh0bWwgPSAkKHRoaXMpLmh0bWwoKTtcclxuICAgICAgdmFyIHN1Z2dlc3Rpb24gPSBNYXRoLnJhbmRvbSgpIDwgMC4zMyA/IFwiSW5jcmVhc2UgUmFtaXByaWwgdG8gMTBtZyBwZXIgZGF5XCIgOiAoTWF0aC5yYW5kb20oKSA8IDAuNSA/IFwiQ29uc2lkZXIgYWRkaW5nIGFuIEFDRSBpbmhpYmlvclwiIDogXCJDb25zaWRlciBhZGRpbmcgYSB0aGlhemlkZS1saWtlIGRpdXJldGljXCIpO1xyXG4gICAgICAkKHRoaXMpLmh0bWwoaHRtbC5yZXBsYWNlKC9cXFtNRURcXC1TVUdHRVNUSU9OXFxdL2csIHN1Z2dlc3Rpb24pKTtcclxuICAgIH0pO1xyXG5cclxuXHJcbiAgICBiYXNlLnNldHVwQ2xpcGJvYXJkKCQoJy5idG4tY29weScpLCB0cnVlKTtcclxuXHJcbiAgICBpYXAuZGlzcGxheVBlcnNvbmFsaXNlZEluZGl2aWR1YWxBY3Rpb25QbGFuKHBhdGllbnRJZCwgJCgnI3BlcnNvbmFsUGxhbkluZGl2aWR1YWwnKSk7XHJcbiAgfSxcclxuXHJcbiAgbGF1bmNoTW9kYWw6IGZ1bmN0aW9uKGxhYmVsLCB2YWx1ZSwgcmVhc29uLCBpc1VuZG8sIGNhbGxiYWNrT25TYXZlLCBjYWxsYmFja09uQ2FuY2VsLCBjYWxsYmFja09uVW5kbykge1xyXG4gICAgdmFyIHJlYXNvbnMgPSBbe1xyXG4gICAgICBcInJlYXNvblwiOiBcIkFscmVhZHkgZG9uZSB0aGlzXCIsXHJcbiAgICAgIFwidmFsdWVcIjogXCJkb25lXCJcclxuICAgIH0sIHtcclxuICAgICAgXCJyZWFzb25cIjogXCJXb3VsZG4ndCB3b3JrXCIsXHJcbiAgICAgIFwidmFsdWVcIjogXCJub3dvcmtcIlxyXG4gICAgfSwge1xyXG4gICAgICBcInJlYXNvblwiOiBcIlNvbWV0aGluZyBlbHNlXCIsXHJcbiAgICAgIFwidmFsdWVcIjogXCJlbHNlXCJcclxuICAgIH1dO1xyXG4gICAgaWYgKHJlYXNvbiAmJiByZWFzb24ucmVhc29uKSB7XHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVhc29ucy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGlmIChyZWFzb25zW2ldLnJlYXNvbiA9PT0gcmVhc29uLnJlYXNvbikge1xyXG4gICAgICAgICAgcmVhc29uc1tpXS5jaGVja2VkID0gdHJ1ZTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgYmFzZS5sYXVuY2hNb2RhbCh7XHJcbiAgICAgIFwiaGVhZGVyXCI6IFwiRGlzYWdyZWUgd2l0aCBhIHN1Z2dlc3RlZCBhY3Rpb25cIixcclxuICAgICAgXCJpc1VuZG9cIjogaXNVbmRvLFxyXG4gICAgICBcIml0ZW1cIjogdmFsdWUsXHJcbiAgICAgIFwicGxhY2Vob2xkZXJcIjogXCJQcm92aWRlIG1vcmUgaW5mb3JtYXRpb24gaGVyZS4uLlwiLFxyXG4gICAgICBcInJlYXNvbnNcIjogcmVhc29uc1xyXG4gICAgfSwgbGFiZWwsIHZhbHVlLCByZWFzb24gPyByZWFzb24ucmVhc29uVGV4dCA6IG51bGwsIGNhbGxiYWNrT25TYXZlLCBjYWxsYmFja09uQ2FuY2VsLCBjYWxsYmFja09uVW5kbyk7XHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gaWFwO1xyXG4iLCJ2YXIgSGlnaGNoYXJ0cyA9IHJlcXVpcmUoJ2hpZ2hjaGFydHMvaGlnaHN0b2NrJyksXHJcbiAgYmFzZSA9IHJlcXVpcmUoJy4uL2Jhc2UuanMnKTtcclxucmVxdWlyZSgnaGlnaGNoYXJ0cy9oaWdoY2hhcnRzLW1vcmUnKShIaWdoY2hhcnRzKTtcclxuXHJcbnZhciBJRCA9IFwiTElGRUxJTkVcIjtcclxuXHJcbnZhciBjb2xvdXIgPSB7XHJcbiAgaW5kZXg6IDAsXHJcbiAgbmV4dDogZnVuY3Rpb24oKSB7XHJcbiAgICBpZiAodGhpcy5pbmRleCA+PSBIaWdoY2hhcnRzLmdldE9wdGlvbnMoKS5jb2xvcnMubGVuZ3RoKSB0aGlzLmluZGV4ID0gMDtcclxuICAgIHJldHVybiBIaWdoY2hhcnRzLmdldE9wdGlvbnMoKS5jb2xvcnNbdGhpcy5pbmRleCsrXTtcclxuICB9LFxyXG4gIHJlc2V0OiBmdW5jdGlvbigpIHtcclxuICAgIHRoaXMuaW5kZXggPSAwO1xyXG4gIH1cclxufTtcclxuXHJcbnZhciBsbCA9IHtcclxuICBjaGFydEFycmF5OiBbXSxcclxuXHJcbiAgZGVzdHJveTogZnVuY3Rpb24oZWxlbWVudElkKSB7XHJcbiAgICAkKGVsZW1lbnRJZCkuaHRtbCgnJyk7XHJcbiAgICAkKGVsZW1lbnRJZCkub2ZmKCdtb3VzZW1vdmUgdG91Y2htb3ZlIHRvdWNoc3RhcnQnLCAnLnN5bmMtY2hhcnQnKTtcclxuXHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IEhpZ2hjaGFydHMuY2hhcnRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIGlmIChIaWdoY2hhcnRzLmNoYXJ0c1tpXSAmJiBIaWdoY2hhcnRzLmNoYXJ0c1tpXS5yZW5kZXJUby5jbGFzc05hbWUuaW5kZXhPZihcImgtY2hhcnRcIikgPiAtMSkgSGlnaGNoYXJ0cy5jaGFydHNbaV0uZGVzdHJveSgpO1xyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIHNob3c6IGZ1bmN0aW9uKHBhbmVsLCBpc0FwcGVuZCwgcGF0aWVudElkLCBkYXRhKSB7XHJcblxyXG4gICAgdmFyIGVsZW1lbnQgPSAnbGlmZWxpbmUtY2hhcnQnO1xyXG4gICAgdmFyIGVsZW1lbnRJZCA9ICcjJyArIGVsZW1lbnQ7XHJcblxyXG4gICAgbGwuZGVzdHJveShlbGVtZW50SWQpO1xyXG5cclxuICAgIHZhciBodG1sRWxlbWVudCA9ICQoJzxkaXYgY2xhc3M9XCJwYW5lbCBwYW5lbC1kZWZhdWx0XCI+PGRpdiBjbGFzcz1cInBhbmVsLWJvZHlcIj48ZGl2IGlkPVwiJyArIGVsZW1lbnQgKyAnXCI+PC9kaXY+PC9kaXY+PC9kaXY+Jyk7XHJcblxyXG4gICAgaWYgKGlzQXBwZW5kKSBwYW5lbC5hcHBlbmQoaHRtbEVsZW1lbnQpO1xyXG4gICAgZWxzZSBwYW5lbC5odG1sKGh0bWxFbGVtZW50KTtcclxuXHJcbiAgICBjb2xvdXIucmVzZXQoKTtcclxuICAgIC8qKlxyXG4gICAgICogSW4gb3JkZXIgdG8gc3luY2hyb25pemUgdG9vbHRpcHMgYW5kIGNyb3NzaGFpcnMsIG92ZXJyaWRlIHRoZVxyXG4gICAgICogYnVpbHQtaW4gZXZlbnRzIHdpdGggaGFuZGxlcnMgZGVmaW5lZCBvbiB0aGUgcGFyZW50IGVsZW1lbnQuXHJcbiAgICAgKi9cclxuXHJcbiAgICAkKGVsZW1lbnRJZCkub24oJ21vdXNlbW92ZSB0b3VjaG1vdmUgdG91Y2hzdGFydCcsICcuc3luYy1jaGFydCcsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgdmFyIGNoYXJ0LCBwb2ludCwgaSwgZXZlbnQsIHNlcmllcztcclxuXHJcbiAgICAgIGZvciAoaSA9IDE7IGkgPCBsbC5jaGFydEFycmF5Lmxlbmd0aCAtIDI7IGkgPSBpICsgMSkge1xyXG4gICAgICAgIGNoYXJ0ID0gbGwuY2hhcnRBcnJheVtpXTtcclxuICAgICAgICBldmVudCA9IGNoYXJ0LnBvaW50ZXIubm9ybWFsaXplKGUub3JpZ2luYWxFdmVudCk7IC8vIEZpbmQgY29vcmRpbmF0ZXMgd2l0aGluIHRoZSBjaGFydFxyXG4gICAgICAgIC8vaWYgKGkgPT09IDApIGNvbnNvbGUubG9nKGV2ZW50LmNoYXJ0WCArIFwiIC0tLSBcIiArIGV2ZW50LmNoYXJ0WSk7XHJcbiAgICAgICAgc2VyaWVzID0gaSA9PT0gMCA/IE1hdGgubWF4KE1hdGgubWluKE1hdGguZmxvb3IoKDEzMCAtIGV2ZW50LmNoYXJ0WSkgLyAzNCksIGNoYXJ0LnNlcmllcy5sZW5ndGggLSAxKSwgMCkgOiAwO1xyXG4gICAgICAgIHBvaW50ID0gY2hhcnQuc2VyaWVzW3Nlcmllc10uc2VhcmNoUG9pbnQoZXZlbnQsIHRydWUpOyAvLyBHZXQgdGhlIGhvdmVyZWQgcG9pbnRcclxuXHJcbiAgICAgICAgaWYgKHBvaW50KSB7XHJcbiAgICAgICAgICBwb2ludC5vbk1vdXNlT3ZlcigpOyAvLyBTaG93IHRoZSBob3ZlciBtYXJrZXJcclxuICAgICAgICAgIGNoYXJ0LnRvb2x0aXAucmVmcmVzaChwb2ludCk7IC8vIFNob3cgdGhlIHRvb2x0aXBcclxuICAgICAgICAgIGNoYXJ0LnhBeGlzWzBdLmRyYXdDcm9zc2hhaXIoZXZlbnQsIHBvaW50KTsgLy8gU2hvdyB0aGUgY3Jvc3NoYWlyXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFN5bmNocm9uaXplIHpvb21pbmcgdGhyb3VnaCB0aGUgc2V0RXh0cmVtZXMgZXZlbnQgaGFuZGxlci5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gc3luY0V4dHJlbWVzKGUpIHtcclxuICAgICAgdmFyIHRoaXNDaGFydCA9IHRoaXMuY2hhcnQ7XHJcblxyXG4gICAgICBpZiAoZS50cmlnZ2VyICE9PSAnc3luY0V4dHJlbWVzJykgeyAvLyBQcmV2ZW50IGZlZWRiYWNrIGxvb3BcclxuICAgICAgICBIaWdoY2hhcnRzLmVhY2gobGwuY2hhcnRBcnJheSwgZnVuY3Rpb24oY2hhcnQpIHtcclxuICAgICAgICAgIGlmIChjaGFydCAhPT0gdGhpc0NoYXJ0KSB7XHJcbiAgICAgICAgICAgIGlmIChjaGFydC5pbnZlcnRlZCkge1xyXG4gICAgICAgICAgICAgIGlmIChjaGFydC55QXhpc1swXS5zZXRFeHRyZW1lcykgeyAvLyBJdCBpcyBudWxsIHdoaWxlIHVwZGF0aW5nXHJcbiAgICAgICAgICAgICAgICBjaGFydC55QXhpc1swXS5zZXRFeHRyZW1lcyhlLm1pbiwgZS5tYXgsIHVuZGVmaW5lZCwgZmFsc2UsIHtcclxuICAgICAgICAgICAgICAgICAgdHJpZ2dlcjogJ3N5bmNFeHRyZW1lcydcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICBpZiAoY2hhcnQueEF4aXNbMF0uc2V0RXh0cmVtZXMpIHsgLy8gSXQgaXMgbnVsbCB3aGlsZSB1cGRhdGluZ1xyXG4gICAgICAgICAgICAgICAgY2hhcnQueEF4aXNbMF0uc2V0RXh0cmVtZXMoZS5taW4sIGUubWF4LCB1bmRlZmluZWQsIGZhbHNlLCB7XHJcbiAgICAgICAgICAgICAgICAgIHRyaWdnZXI6ICdzeW5jRXh0cmVtZXMnXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICB2YXIgcGxvdENvbmRpdGlvbnMgPSBmdW5jdGlvbihjb25kaXRpb25zLCBpbXBvcnRhbnRDb2RlcywgY29udGFjdHMpIHtcclxuICAgICAgbGwuY2hhcnRzID0gMTtcclxuICAgICAgdmFyIHNlcmllcyA9IFtdO1xyXG4gICAgICAkLmVhY2goY29uZGl0aW9ucy5yZXZlcnNlKCksIGZ1bmN0aW9uKGksIHRhc2spIHtcclxuICAgICAgICB2YXIgaXRlbSA9IHtcclxuICAgICAgICAgIG5hbWU6IHRhc2submFtZSxcclxuICAgICAgICAgIGRhdGE6IFtdLFxyXG4gICAgICAgICAgY29sb3I6IGNvbG91ci5uZXh0KClcclxuICAgICAgICB9O1xyXG4gICAgICAgICQuZWFjaCh0YXNrLmludGVydmFscywgZnVuY3Rpb24oaiwgaW50ZXJ2YWwpIHtcclxuICAgICAgICAgIGl0ZW0uZGF0YS5wdXNoKFtpICsgMC40OSwgaW50ZXJ2YWwuZnJvbSwgaW50ZXJ2YWwudG9dKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgc2VyaWVzLnB1c2goaXRlbSk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgdmFyIG1hcmtlclRlbXBsYXRlID0geyBcImxpbmVXaWR0aFwiOiAxLCBcImxpbmVDb2xvclwiOiBcImJsYWNrXCIsIFwicmFkaXVzXCI6IDggfTtcclxuICAgICAgdmFyIG1hcmtlcnMgPSB7XHJcbiAgICAgICAgXCJkZWZhdWx0XCI6ICQuZXh0ZW5kKHsgXCJzeW1ib2xcIjogXCJ0cmlhbmdsZVwiIH0sIG1hcmtlclRlbXBsYXRlKSxcclxuICAgICAgICBcIkZhY2UgdG8gZmFjZVwiOiAkLmV4dGVuZCh7IFwic3ltYm9sXCI6IFwic3F1YXJlXCIgfSwgbWFya2VyVGVtcGxhdGUpLFxyXG4gICAgICAgIFwiVGVsZXBob25lXCI6ICQuZXh0ZW5kKHsgXCJzeW1ib2xcIjogXCJjaXJjbGVcIiB9LCBtYXJrZXJUZW1wbGF0ZSksXHJcbiAgICAgICAgXCJIb3NwaXRhbCBhZG1pc3Npb25cIjogJC5leHRlbmQoeyBcInN5bWJvbFwiOiBcInRyaWFuZ2xlXCIgfSwgbWFya2VyVGVtcGxhdGUpXHJcbiAgICAgIH07XHJcbiAgICAgIHZhciBjb250YWN0U2VyaWVzID0ge307XHJcbiAgICAgIHZhciBldmVudFNlcmllcyA9IHt9O1xyXG4gICAgICAkLmVhY2goY29udGFjdHMsIGZ1bmN0aW9uKGksIGNvbnRhY3QpIHtcclxuICAgICAgICBpZiAoIWNvbnRhY3RTZXJpZXNbY29udGFjdC5uYW1lXSkge1xyXG4gICAgICAgICAgY29udGFjdFNlcmllc1tjb250YWN0Lm5hbWVdID0gSGlnaGNoYXJ0cy5leHRlbmQoY29udGFjdCwge1xyXG4gICAgICAgICAgICBkYXRhOiBbXSxcclxuICAgICAgICAgICAgdHlwZTogJ3NjYXR0ZXInLFxyXG4gICAgICAgICAgICBtYXJrZXI6IG1hcmtlcnNbY29udGFjdC5uYW1lXSB8fCBtYXJrZXJzLmRlZmF1bHQsXHJcbiAgICAgICAgICAgIGNvbG9yOiBjb2xvdXIubmV4dCgpXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29udGFjdFNlcmllc1tjb250YWN0Lm5hbWVdLmRhdGEucHVzaChbXHJcbiAgICAgICAgICAgICAgY29udGFjdC50YXNrLFxyXG4gICAgICAgICAgICAgIGNvbnRhY3QudGltZVxyXG4gICAgICAgICAgXSk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgJC5lYWNoKGltcG9ydGFudENvZGVzLCBmdW5jdGlvbihpLCBldmVudCkge1xyXG4gICAgICAgIGlmICghZXZlbnRTZXJpZXNbZXZlbnQubmFtZV0pIHtcclxuICAgICAgICAgIGV2ZW50U2VyaWVzW2V2ZW50Lm5hbWVdID0gSGlnaGNoYXJ0cy5leHRlbmQoZXZlbnQsIHtcclxuICAgICAgICAgICAgZGF0YTogW10sXHJcbiAgICAgICAgICAgIHR5cGU6ICdzY2F0dGVyJyxcclxuICAgICAgICAgICAgbWFya2VyOiBtYXJrZXJzW2V2ZW50Lm5hbWVdIHx8IG1hcmtlcnMuZGVmYXVsdCxcclxuICAgICAgICAgICAgY29sb3I6IGNvbG91ci5uZXh0KClcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBldmVudFNlcmllc1tldmVudC5uYW1lXS5kYXRhLnB1c2goW1xyXG4gICAgICAgICAgICAgIGV2ZW50LnRhc2ssXHJcbiAgICAgICAgICAgICAgZXZlbnQudGltZVxyXG4gICAgICAgICAgXSk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgc2VyaWVzID0gc2VyaWVzLmNvbmNhdChPYmplY3Qua2V5cyhjb250YWN0U2VyaWVzKS5tYXAoZnVuY3Rpb24oa2V5KSB7XHJcbiAgICAgICAgcmV0dXJuIGNvbnRhY3RTZXJpZXNba2V5XTtcclxuICAgICAgfSkpO1xyXG5cclxuICAgICAgc2VyaWVzID0gc2VyaWVzLmNvbmNhdChPYmplY3Qua2V5cyhldmVudFNlcmllcykubWFwKGZ1bmN0aW9uKGtleSkge1xyXG4gICAgICAgIHJldHVybiBldmVudFNlcmllc1trZXldO1xyXG4gICAgICB9KSk7XHJcblxyXG4gICAgICAkKGVsZW1lbnRJZCkuYXBwZW5kKCQoJzxkaXYgY2xhc3M9XCJjaGFydC10aXRsZVwiPlBhdGllbnQgY29uZGl0aW9ucyBhbmQgY29udGFjdHM8L2Rpdj4nKSk7XHJcbiAgICAgIC8vIGNyZWF0ZSB0aGUgY2hhcnRcclxuICAgICAgJCgnPGRpdiBjbGFzcz1cImgtY2hhcnQgaC1jb25kaXRpb24tY2hhcnRcIj4nKVxyXG4gICAgICAgIC5hcHBlbmRUbyhlbGVtZW50SWQpXHJcbiAgICAgICAgLmhpZ2hjaGFydHMoe1xyXG5cclxuICAgICAgICAgIGNoYXJ0OiB7XHJcbiAgICAgICAgICAgIHJlbmRlclRvOiBlbGVtZW50LFxyXG4gICAgICAgICAgICBtYXJnaW5MZWZ0OiAxMjAsIC8vIEtlZXAgYWxsIGNoYXJ0cyBsZWZ0IGFsaWduZWRcclxuICAgICAgICAgICAgc3BhY2luZ1RvcDogMjAsXHJcbiAgICAgICAgICAgIHNwYWNpbmdCb3R0b206IDIwLFxyXG4gICAgICAgICAgICB0eXBlOiAnY29sdW1ucmFuZ2UnLFxyXG4gICAgICAgICAgICBpbnZlcnRlZDogdHJ1ZSxcclxuICAgICAgICAgICAgYmFja2dyb3VuZENvbG9yOiAnI0Y5RjNGOScsXHJcbiAgICAgICAgICAgIGJvcmRlcldpZHRoOiAyLFxyXG4gICAgICAgICAgICBib3JkZXJDb2xvcjogJyNkZGQnXHJcbiAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgIHRpdGxlOiAnJyxcclxuXHJcbiAgICAgICAgICB5QXhpczoge1xyXG4gICAgICAgICAgICB0eXBlOiAnZGF0ZXRpbWUnLFxyXG4gICAgICAgICAgICBtaW46IERhdGUuVVRDKDIwMDUsIDYsIDEyKSxcclxuICAgICAgICAgICAgbWF4OiBuZXcgRGF0ZSgpLmdldFRpbWUoKSxcclxuICAgICAgICAgICAgY3Jvc3NoYWlyOiB0cnVlLFxyXG4gICAgICAgICAgICBldmVudHM6IHtcclxuICAgICAgICAgICAgICBzZXRFeHRyZW1lczogc3luY0V4dHJlbWVzXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGxhYmVsczoge1xyXG4gICAgICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlXHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICAvL3RoaW5ncyB0aGF0IGFyZSBub3JtYWxseSB4QXhpcyBkZWZhdWx0c1xyXG4gICAgICAgICAgICBlbmRPblRpY2s6IGZhbHNlLFxyXG4gICAgICAgICAgICBncmlkTGluZVdpZHRoOiAwLFxyXG4gICAgICAgICAgICBsaW5lV2lkdGg6IDEsXHJcbiAgICAgICAgICAgIG1heFBhZGRpbmc6IDAuMDEsXHJcbiAgICAgICAgICAgIG1pblBhZGRpbmc6IDAuMDEsXHJcbiAgICAgICAgICAgIHN0YXJ0T25UaWNrOiBmYWxzZSxcclxuICAgICAgICAgICAgdGlja1dpZHRoOiAwLFxyXG4gICAgICAgICAgICB0aXRsZToge1xyXG4gICAgICAgICAgICAgIHRleHQ6ICcnXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHRpY2tQaXhlbEludGVydmFsOiAxMDBcclxuICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgeEF4aXM6IHtcclxuICAgICAgICAgICAgbGFiZWxzOiB7XHJcbiAgICAgICAgICAgICAgZW5hYmxlZDogZmFsc2VcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc3RhcnRPblRpY2s6IGZhbHNlLFxyXG4gICAgICAgICAgICBlbmRPblRpY2s6IGZhbHNlLFxyXG4gICAgICAgICAgICB0aXRsZToge1xyXG4gICAgICAgICAgICAgIHRleHQ6ICcnXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHRpY2tXaWR0aDogMCxcclxuICAgICAgICAgICAgbWluUGFkZGluZzogMC4yLFxyXG4gICAgICAgICAgICBtYXhQYWRkaW5nOiAwLjIsXHJcblxyXG4gICAgICAgICAgICAvL3RoaW5ncyB0aGF0IGFyZSBub3JtYWxseSB5QXhpcyBkZWZhdWx0c1xyXG4gICAgICAgICAgICBncmlkTGluZVdpZHRoOiAwLFxyXG4gICAgICAgICAgICBsaW5lV2lkdGg6IDBcclxuXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgY3JlZGl0czoge1xyXG4gICAgICAgICAgICBlbmFibGVkOiBmYWxzZVxyXG4gICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICBsZWdlbmQ6IHtcclxuICAgICAgICAgICAgZW5hYmxlZDogZmFsc2VcclxuICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgdG9vbHRpcDoge1xyXG4gICAgICAgICAgICBmb3JtYXR0ZXI6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgIGlmICh0aGlzLnNlcmllcy5kYXRhWzBdLnggIT09IDEgJiYgdGhpcy5zZXJpZXMuZGF0YVswXS54ICE9PSAyKSB7XHJcbiAgICAgICAgICAgICAgICAvL1JhbmdlIGVyZ28gY29uZGl0aW9uXHJcbiAgICAgICAgICAgICAgICB2YXIgeUNvb3JkID0gdGhpcy55O1xyXG4gICAgICAgICAgICAgICAgdmFyIGxhYmVsVG1wID0gY29uZGl0aW9uc1tNYXRoLmZsb29yKHRoaXMueCldLmludGVydmFscy5maWx0ZXIoZnVuY3Rpb24odikge1xyXG4gICAgICAgICAgICAgICAgICByZXR1cm4geUNvb3JkID49IHYuZnJvbSAmJiB5Q29vcmQgPD0gdi50bztcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdmFyIGxhYmVsID0gbGFiZWxUbXAubGVuZ3RoID4gMCA/IGxhYmVsVG1wWzBdLmxhYmVsIDogXCJObyBsYWJlbCBBXCI7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJzxiPicgKyBjb25kaXRpb25zW01hdGguZmxvb3IodGhpcy54KV0ubmFtZSArIChsYWJlbCA/ICc6ICcgKyBsYWJlbCA6ICcnKSArICc8L2I+PGJyLz4nICtcclxuICAgICAgICAgICAgICAgICAgSGlnaGNoYXJ0cy5kYXRlRm9ybWF0KCclZC8lbS8lWScsIHRoaXMucG9pbnQub3B0aW9ucy5sb3cpICtcclxuICAgICAgICAgICAgICAgICAgJyAtICcgKyBIaWdoY2hhcnRzLmRhdGVGb3JtYXQoJyVkLyVtLyVZJywgdGhpcy5wb2ludC5vcHRpb25zLmhpZ2gpO1xyXG4gICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvL1NpbmdsZSB2YWx1ZSBoZW5jZSBjb250YWN0XHJcbiAgICAgICAgICAgICAgICB2YXIgdGltZSA9IHRoaXMueTtcclxuICAgICAgICAgICAgICAgIHJldHVybiAodGhpcy5zZXJpZXMuZGF0YVswXS54ID09PSAxID8gaW1wb3J0YW50Q29kZXMgOiBjb250YWN0cykuZmlsdGVyKGZ1bmN0aW9uKHZhbCkge1xyXG4gICAgICAgICAgICAgICAgICByZXR1cm4gdmFsLmRhdGEgJiYgdmFsLmRhdGEuZmlsdGVyKGZ1bmN0aW9uKHYpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdlsxXSA9PT0gdGltZTtcclxuICAgICAgICAgICAgICAgICAgfSkubGVuZ3RoID4gMDtcclxuICAgICAgICAgICAgICAgIH0pLm1hcChmdW5jdGlvbih2YWwpIHtcclxuICAgICAgICAgICAgICAgICAgcmV0dXJuICc8Yj4nICsgdmFsLm5hbWUgKyAnPC9iPjxici8+JyArIEhpZ2hjaGFydHMuZGF0ZUZvcm1hdCgnJWQvJW0vJVknLCB0aW1lKTtcclxuICAgICAgICAgICAgICAgIH0pLmpvaW4oJzxici8+Jyk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBmb2xsb3dQb2ludGVyOiB0cnVlXHJcbiAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgIHBsb3RPcHRpb25zOiB7XHJcbiAgICAgICAgICAgIGNvbHVtbnJhbmdlOiB7XHJcbiAgICAgICAgICAgICAgZ3JvdXBpbmc6IGZhbHNlLFxyXG4gICAgICAgICAgICAgIC8qZ3JvdXBQYWRkaW5nOiAwLjMsKi9cclxuICAgICAgICAgICAgICBkYXRhTGFiZWxzOiB7XHJcbiAgICAgICAgICAgICAgICBhbGxvd092ZXJsYXA6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBlbmFibGVkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgZm9ybWF0dGVyOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgdmFyIHlDb29yZCA9IHRoaXMueTtcclxuICAgICAgICAgICAgICAgICAgdmFyIGlkeCA9IC0xO1xyXG4gICAgICAgICAgICAgICAgICB2YXIgbGFiZWxUbXAgPSBjb25kaXRpb25zW01hdGguZmxvb3IodGhpcy54KV0uaW50ZXJ2YWxzLmZpbHRlcihmdW5jdGlvbih2LCBpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHlDb29yZCA+PSB2LmZyb20gJiYgeUNvb3JkIDw9IHYudG8pIHtcclxuICAgICAgICAgICAgICAgICAgICAgIGlkeCA9IGk7XHJcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgdmFyIGxhYmVsID0gbGFiZWxUbXAubGVuZ3RoID4gMCA/IGxhYmVsVG1wWzBdLmxhYmVsIDogXCJObyBsYWJlbCBCXCI7XHJcbiAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnkgPT09IHRoaXMucG9pbnQubG93ICYmXHJcbiAgICAgICAgICAgICAgICAgICAgKGNvbmRpdGlvbnNbTWF0aC5mbG9vcih0aGlzLngpXS5pbnRlcnZhbHMubGVuZ3RoIC0gMSA9PT0gaWR4IHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAodGhpcy5zZXJpZXMuY2hhcnQueUF4aXNbMF0ubWluIDw9IHlDb29yZCAmJiB0aGlzLnNlcmllcy5jaGFydC55QXhpc1swXS5tYXggPj0geUNvb3JkKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgKHRoaXMuc2VyaWVzLmNoYXJ0LnlBeGlzWzBdLm1pbiA+PSB0aGlzLnBvaW50LmxvdyAmJiB0aGlzLnNlcmllcy5jaGFydC55QXhpc1swXS5tYXggPD0gdGhpcy5wb2ludC5oaWdoKSkgPyBjb25kaXRpb25zW01hdGguZmxvb3IodGhpcy54KV0ubmFtZSArIChsYWJlbCA/ICc6ICcgKyBsYWJlbCA6ICcnKSA6ICcnO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICBzZXJpZXM6IHNlcmllc1xyXG5cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIHBsb3RNZWFzdXJlbWVudHMgPSBmdW5jdGlvbihtZWFzdXJlbWVudHMpIHtcclxuICAgICAgJChlbGVtZW50SWQpLmFwcGVuZCgkKCc8ZGl2IGNsYXNzPVwiY2hhcnQtdGl0bGVcIj5QYXRpZW50IG1lYXN1cmVtZW50czwvZGl2PicpKTtcclxuICAgICAgJC5lYWNoKG1lYXN1cmVtZW50cywgZnVuY3Rpb24oaSwgZGF0YXNldCkge1xyXG4gICAgICAgIGxsLmNoYXJ0cysrO1xyXG4gICAgICAgIC8vIEFkZCBYIHZhbHVlc1xyXG4gICAgICAgIC8qaWYgKGRhdGFzZXQuZGF0YSAmJiB0eXBlb2YgZGF0YXNldC5kYXRhWzBdICE9PSBcIm9iamVjdFwiKSB7XHJcbiAgICAgICAgICBkYXRhc2V0LmRhdGEgPSBIaWdoY2hhcnRzLm1hcChkYXRhc2V0LmRhdGEsIGZ1bmN0aW9uKHZhbCwgaikge1xyXG4gICAgICAgICAgICByZXR1cm4gW21lYXN1cmVtZW50cy54RGF0YVtqXSwgdmFsXTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0qL1xyXG5cclxuICAgICAgICB2YXIgY2hhcnRPcHRpb25zID0ge1xyXG4gICAgICAgICAgY2hhcnQ6IHtcclxuICAgICAgICAgICAgbWFyZ2luTGVmdDogMTIwLCAvLyBLZWVwIGFsbCBjaGFydHMgbGVmdCBhbGlnbmVkXHJcbiAgICAgICAgICAgIHNwYWNpbmdUb3A6IDAsXHJcbiAgICAgICAgICAgIHNwYWNpbmdCb3R0b206IDgsXHJcbiAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogJyNGOUY5RjMnLFxyXG4gICAgICAgICAgICBib3JkZXJXaWR0aDogMixcclxuICAgICAgICAgICAgYm9yZGVyQ29sb3I6ICcjZGRkJ1xyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHRpdGxlOiB7XHJcbiAgICAgICAgICAgIHRleHQ6ICcnLFxyXG4gICAgICAgICAgICBhbGlnbjogJ2xlZnQnLFxyXG4gICAgICAgICAgICBtYXJnaW46IDAsXHJcbiAgICAgICAgICAgIHg6IDMwXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgbWFya2VyOiB7XHJcbiAgICAgICAgICAgIGVuYWJsZWQ6IHRydWVcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBjcmVkaXRzOiB7XHJcbiAgICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgbGVnZW5kOiB7XHJcbiAgICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgeEF4aXM6IHtcclxuICAgICAgICAgICAgdHlwZTogJ2RhdGV0aW1lJyxcclxuICAgICAgICAgICAgbWluOiBEYXRlLlVUQygyMDA1LCA2LCAxMiksXHJcbiAgICAgICAgICAgIG1heDogbmV3IERhdGUoKS5nZXRUaW1lKCksXHJcbiAgICAgICAgICAgIGNyb3NzaGFpcjoge1xyXG4gICAgICAgICAgICAgIHNuYXA6IGZhbHNlXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGV2ZW50czoge1xyXG4gICAgICAgICAgICAgIHNldEV4dHJlbWVzOiBzeW5jRXh0cmVtZXNcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbGFiZWxzOiB7XHJcbiAgICAgICAgICAgICAgZW5hYmxlZDogZmFsc2VcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbGluZVdpZHRoOiAwLFxyXG4gICAgICAgICAgICBtaW5vckdyaWRMaW5lV2lkdGg6IDAsXHJcbiAgICAgICAgICAgIGxpbmVDb2xvcjogJ3RyYW5zcGFyZW50JyxcclxuICAgICAgICAgICAgbWlub3JUaWNrTGVuZ3RoOiAwLFxyXG4gICAgICAgICAgICB0aWNrTGVuZ3RoOiAwXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgeUF4aXM6IHtcclxuICAgICAgICAgICAgdGl0bGU6IHtcclxuICAgICAgICAgICAgICB0ZXh0OiBkYXRhc2V0Lm5hbWUgKyBcIjxicj5cIiArIGRhdGFzZXQudW5pdC5yZXBsYWNlKC9cXF4oWzAtOV0rKS8sIFwiPHN1cD4kMTwvc3VwPlwiKSArIFwiXCIsXHJcbiAgICAgICAgICAgICAgbWFyZ2luOiA2MCxcclxuICAgICAgICAgICAgICByb3RhdGlvbjogMFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBzdGFydE9uVGljazogZmFsc2UsXHJcbiAgICAgICAgICAgIGVuZE9uVGljazogZmFsc2UsXHJcbiAgICAgICAgICAgIGxhYmVsczoge1xyXG4gICAgICAgICAgICAgIHN0eWxlOiB7XHJcbiAgICAgICAgICAgICAgICBcInRleHRPdmVyZmxvd1wiOiBcIm5vbmVcIlxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdGlja1BpeGVsSW50ZXJ2YWw6IDI1LFxyXG4gICAgICAgICAgICBtYXhQYWRkaW5nOiAwLjEsXHJcbiAgICAgICAgICAgIG1pblBhZGRpbmc6IDAuMVxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHRvb2x0aXA6IHtcclxuICAgICAgICAgICAgcG9zaXRpb25lcjogZnVuY3Rpb24obGFiZWxXaWR0aCwgbGFiZWxIZWlnaHQsIHBvaW50KSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIHg6IE1hdGgubWF4KDUwLCBwb2ludC5wbG90WCAtIGxhYmVsV2lkdGgpLCAvLyBsZWZ0IGFsaWduZWRcclxuICAgICAgICAgICAgICAgIHk6IC0xIC8vIGFsaWduIHRvIHRpdGxlXHJcbiAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdXNlSFRNTDogdHJ1ZSxcclxuICAgICAgICAgICAgcG9pbnRGb3JtYXQ6ICc8Yj4nICsgZGF0YXNldC5uYW1lICsgJzo8L2I+IHtwb2ludC55fSAnICsgZGF0YXNldC51bml0LnJlcGxhY2UoL1xcXihbMC05XSspLywgXCI8c3VwPiQxPC9zdXA+XCIpLFxyXG4gICAgICAgICAgICB2YWx1ZURlY2ltYWxzOiBkYXRhc2V0LnZhbHVlRGVjaW1hbHNcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBwbG90T3B0aW9uczoge1xyXG4gICAgICAgICAgICBzZXJpZXM6IHtcclxuICAgICAgICAgICAgICBldmVudHM6IHtcclxuICAgICAgICAgICAgICAgIG1vdXNlT3V0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgdmFyIGNoYXJ0LCBpO1xyXG4gICAgICAgICAgICAgICAgICBmb3IgKGkgPSAxOyBpIDwgbGwuY2hhcnRBcnJheS5sZW5ndGggLSAyOyBpID0gaSArIDEpIHtcclxuICAgICAgICAgICAgICAgICAgICBjaGFydCA9IGxsLmNoYXJ0QXJyYXlbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhcnQudG9vbHRpcC5oaWRlKCk7XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBzZXJpZXM6IFt7XHJcbiAgICAgICAgICAgIGRhdGE6IGRhdGFzZXQuZGF0YSxcclxuICAgICAgICAgICAgbmFtZTogZGF0YXNldC5uYW1lLFxyXG4gICAgICAgICAgICB0eXBlOiBkYXRhc2V0LnR5cGUsXHJcbiAgICAgICAgICAgIGNvbG9yOiBjb2xvdXIubmV4dCgpLFxyXG4gICAgICAgICAgICBmaWxsT3BhY2l0eTogMC4zXHJcbiAgICAgICAgICAgIH1dXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgaWYgKGRhdGFzZXQubmFtZSA9PT0gXCJCUFwiKSB7XHJcbiAgICAgICAgICBjaGFydE9wdGlvbnMudG9vbHRpcC5wb2ludEZvcm1hdCA9IFwiPGI+QlA6PC9iPiB7cG9pbnQubG93fS97cG9pbnQuaGlnaH0gbW1IZzxici8+XCI7XHJcbiAgICAgICAgICAvL2NoYXJ0T3B0aW9ucy5zZXJpZXNbMF0udG9vbHRpcCA9IHt9O1xyXG4gICAgICAgICAgY2hhcnRPcHRpb25zLnNlcmllc1swXS5zdGVtV2lkdGggPSAzO1xyXG4gICAgICAgICAgY2hhcnRPcHRpb25zLnNlcmllc1swXS53aGlza2VyV2lkdGggPSA1O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyppZiAoaSA9PT0gMCkge1xyXG4gICAgICAgICAgY2hhcnRPcHRpb25zLnRpdGxlID0ge1xyXG4gICAgICAgICAgICB0ZXh0OiAnUGF0aWVudCBtZWFzdXJlbWVudHMnLFxyXG4gICAgICAgICAgICBhbGlnbjogJ2xlZnQnLFxyXG4gICAgICAgICAgICBtYXJnaW46IDEsXHJcbiAgICAgICAgICAgIHN0eWxlOiB7XHJcbiAgICAgICAgICAgICAgY29sb3I6IFwiIzMzMzMzM1wiLFxyXG4gICAgICAgICAgICAgIGZvbnRTaXplOiBcIjEycHhcIixcclxuICAgICAgICAgICAgICBmb250V2VpZ2h0OiBcImJvbGRcIlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgIH0qL1xyXG5cclxuICAgICAgICAvKmlmIChpID09PSBtZWFzdXJlbWVudHMuZGF0YXNldHMubGVuZ3RoIC0gMSkge1xyXG4gICAgICAgICAgY2hhcnRPcHRpb25zLnhBeGlzID0ge1xyXG4gICAgICAgICAgICBjcm9zc2hhaXI6IHRydWUsXHJcbiAgICAgICAgICAgIGV2ZW50czoge1xyXG4gICAgICAgICAgICAgIHNldEV4dHJlbWVzOiBzeW5jRXh0cmVtZXNcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdHlwZTogJ2RhdGV0aW1lJ1xyXG4gICAgICAgICAgfTtcclxuICAgICAgICB9Ki9cclxuICAgICAgICAkKCc8ZGl2IGNsYXNzPVwic3luYy1jaGFydCBoLWNoYXJ0JyArIChpID09PSBtZWFzdXJlbWVudHMubGVuZ3RoIC0gMSA/IFwiIGgtbGFzdC1tZWFzdXJlbWVudC1jaGFydFwiIDogXCJcIikgKyAnXCI+JylcclxuICAgICAgICAgIC5hcHBlbmRUbyhlbGVtZW50SWQpXHJcbiAgICAgICAgICAuaGlnaGNoYXJ0cyhjaGFydE9wdGlvbnMpO1xyXG5cclxuICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBwbG90TmF2aWdhdG9yID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgIGxsLmNoYXJ0cysrO1xyXG4gICAgICB2YXIgY2hhcnQgPSAkKCc8ZGl2IGNsYXNzPVwiaC1jaGFydCBoLW5hdmlnYXRvci1jaGFydFwiPicpXHJcbiAgICAgICAgLmFwcGVuZFRvKGVsZW1lbnRJZClcclxuICAgICAgICAuaGlnaGNoYXJ0cyh7XHJcblxyXG4gICAgICAgICAgY2hhcnQ6IHtcclxuICAgICAgICAgICAgcmVuZGVyVG86IGVsZW1lbnQsXHJcbiAgICAgICAgICAgIG1hcmdpbkxlZnQ6IDEyMCwgLy8gS2VlcCBhbGwgY2hhcnRzIGxlZnQgYWxpZ25lZFxyXG4gICAgICAgICAgICBzcGFjaW5nVG9wOiAyMCxcclxuICAgICAgICAgICAgc3BhY2luZ0JvdHRvbTogMjAsXHJcbiAgICAgICAgICAgIGlnbm9yZUhpZGRlblNlcmllczogZmFsc2UsXHJcbiAgICAgICAgICAgIGJvcmRlcldpZHRoOiAyLFxyXG4gICAgICAgICAgICBib3JkZXJDb2xvcjogJyNkZGQnXHJcbiAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgIHRpdGxlOiB7XHJcbiAgICAgICAgICAgIHRleHQ6ICcnXHJcbiAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgIHhBeGlzOiB7XHJcbiAgICAgICAgICAgIHR5cGU6ICdkYXRldGltZScsXHJcbiAgICAgICAgICAgIG1pbjogRGF0ZS5VVEMoMjAwNSwgNiwgMTIpLFxyXG4gICAgICAgICAgICBtYXg6IG5ldyBEYXRlKCkuZ2V0VGltZSgpLFxyXG4gICAgICAgICAgICBjcm9zc2hhaXI6IGZhbHNlLFxyXG4gICAgICAgICAgICBldmVudHM6IHtcclxuICAgICAgICAgICAgICBzZXRFeHRyZW1lczogc3luY0V4dHJlbWVzXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGxhYmVsczoge1xyXG4gICAgICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGxpbmVXaWR0aDogMCxcclxuICAgICAgICAgICAgbWlub3JHcmlkTGluZVdpZHRoOiAwLFxyXG4gICAgICAgICAgICBsaW5lQ29sb3I6ICd0cmFuc3BhcmVudCcsXHJcbiAgICAgICAgICAgIG1pbm9yVGlja0xlbmd0aDogMCxcclxuICAgICAgICAgICAgdGlja0xlbmd0aDogMFxyXG4gICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICB5QXhpczoge1xyXG4gICAgICAgICAgICBtaW46IDAsXHJcbiAgICAgICAgICAgIG1heDogMSxcclxuICAgICAgICAgICAgdGlja0ludGVydmFsOiAxLFxyXG4gICAgICAgICAgICBzdGFydE9uVGljazogZmFsc2UsXHJcbiAgICAgICAgICAgIGVuZE9uVGljazogZmFsc2UsXHJcbiAgICAgICAgICAgIHRpdGxlOiB7XHJcbiAgICAgICAgICAgICAgdGV4dDogJydcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbWluUGFkZGluZzogMC4yLFxyXG4gICAgICAgICAgICBtYXhQYWRkaW5nOiAwLjIsXHJcbiAgICAgICAgICAgIGxhYmVsczoge1xyXG4gICAgICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgbGVnZW5kOiB7XHJcbiAgICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlXHJcbiAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgIG5hdmlnYXRvcjoge1xyXG4gICAgICAgICAgICBlbmFibGVkOiB0cnVlXHJcbiAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgIHBsb3RPcHRpb25zOiB7XHJcbiAgICAgICAgICAgIGxpbmU6IHtcclxuICAgICAgICAgICAgICBsaW5lV2lkdGg6IDAsXHJcbiAgICAgICAgICAgICAgbWFya2VyOiB7XHJcbiAgICAgICAgICAgICAgICBlbmFibGVkOiBmYWxzZVxyXG4gICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgZGF0YUxhYmVsczoge1xyXG4gICAgICAgICAgICAgICAgZW5hYmxlZDogZmFsc2VcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgc2VyaWVzOiBbe1xyXG4gICAgICAgICAgICBcIm5hbWVcIjogXCJIVE5cIixcclxuICAgICAgICAgICAgXCJkYXRhXCI6IFt7XHJcbiAgICAgICAgICAgICAgXCJ4XCI6IDEzNzM1ODcyMDAwMDAsXHJcbiAgICAgICAgICAgICAgXCJ5XCI6IDAsXHJcbiAgICAgICAgICAgICAgXCJmcm9tXCI6IDEzNzM1ODcyMDAwMDAsXHJcbiAgICAgICAgICAgICAgXCJ0b1wiOiAxNDU5ODE0NDAwMDAwXHJcbiAgICAgICAgICAgICAgfV1cclxuICAgICAgICAgICAgfV1cclxuXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIGNoYXJ0LmhpZ2hjaGFydHMoKS5zZXJpZXNbMF0uaGlkZSgpO1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgcGxvdE1lZGljYXRpb25zID0gZnVuY3Rpb24obWVkaWNhdGlvbnMpIHtcclxuICAgICAgbGwuY2hhcnRzKys7XHJcbiAgICAgIHZhciBzZXJpZXMgPSBbXTtcclxuICAgICAgJC5lYWNoKG1lZGljYXRpb25zLnJldmVyc2UoKSwgZnVuY3Rpb24oaSwgdGFzaykge1xyXG4gICAgICAgIHZhciBpdGVtID0ge1xyXG4gICAgICAgICAgbmFtZTogdGFzay5uYW1lLFxyXG4gICAgICAgICAgZGF0YTogW10sXHJcbiAgICAgICAgICBjb2xvcjogY29sb3VyLm5leHQoKVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgJC5lYWNoKHRhc2suaW50ZXJ2YWxzLCBmdW5jdGlvbihqLCBpbnRlcnZhbCkge1xyXG4gICAgICAgICAgaXRlbS5kYXRhLnB1c2goW2kgKyAwLjQ5LCBpbnRlcnZhbC5mcm9tLCBpbnRlcnZhbC50b10pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBzZXJpZXMucHVzaChpdGVtKTtcclxuICAgICAgfSk7XHJcbiAgICAgIHZhciBub0RhdGEgPSBmYWxzZTtcclxuICAgICAgaWYgKHNlcmllcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICBzZXJpZXMucHVzaCh7XHJcbiAgICAgICAgICB0eXBlOiAnbGluZScsXHJcbiAgICAgICAgICBuYW1lOiAnUmFuZG9tIGRhdGEnLFxyXG4gICAgICAgICAgZGF0YTogW11cclxuICAgICAgICB9KTtcclxuICAgICAgICBub0RhdGEgPSB0cnVlO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyQoZWxlbWVudElkKS5hcHBlbmQoJCgnPGRpdiBjbGFzcz1cImNoYXJ0LXRpdGxlXCInICsgKG5vRGF0YSA/ICdzdHlsZT1cImRpc3BsYXk6bm9uZVwiJyA6ICcnKSArICc+UGF0aWVudCBtZWRpY2F0aW9uczwvZGl2PicpKTtcclxuICAgICAgJChlbGVtZW50SWQpLmFwcGVuZCgkKCc8ZGl2IGNsYXNzPVwiY2hhcnQtdGl0bGVcIj5QYXRpZW50IG1lZGljYXRpb25zPC9kaXY+JykpO1xyXG4gICAgICAvLyBjcmVhdGUgdGhlIGNoYXJ0XHJcbiAgICAgIC8vcmV0dXJuICQoJzxkaXYgY2xhc3M9XCJoLWNoYXJ0IGgtbWVkaWNhdGlvbi1jaGFydFwiJyArIChub0RhdGEgPyAnc3R5bGU9XCJkaXNwbGF5Om5vbmVcIicgOiAnJykgKyAnPicpXHJcbiAgICAgIHJldHVybiAkKCc8ZGl2IGNsYXNzPVwiaC1jaGFydCBoLW1lZGljYXRpb24tY2hhcnRcIj4nKVxyXG4gICAgICAgIC5hcHBlbmRUbyhlbGVtZW50SWQpXHJcbiAgICAgICAgLmhpZ2hjaGFydHMoe1xyXG5cclxuICAgICAgICAgIGNoYXJ0OiB7XHJcbiAgICAgICAgICAgIHJlbmRlclRvOiBlbGVtZW50LFxyXG4gICAgICAgICAgICBtYXJnaW5MZWZ0OiAxMjAsIC8vIEtlZXAgYWxsIGNoYXJ0cyBsZWZ0IGFsaWduZWRcclxuICAgICAgICAgICAgc3BhY2luZ1RvcDogMjAsXHJcbiAgICAgICAgICAgIHNwYWNpbmdCb3R0b206IDIwLFxyXG4gICAgICAgICAgICB0eXBlOiAnY29sdW1ucmFuZ2UnLFxyXG4gICAgICAgICAgICBpbnZlcnRlZDogdHJ1ZSxcclxuICAgICAgICAgICAgYmFja2dyb3VuZENvbG9yOiAnI0YzRjlGOSdcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBsYW5nOiB7XHJcbiAgICAgICAgICAgIG5vRGF0YTogXCJObyByZWxldmFudCBtZWRpY2F0aW9uc1wiXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgbm9EYXRhOiB7XHJcbiAgICAgICAgICAgIHN0eWxlOiB7XHJcbiAgICAgICAgICAgICAgZm9udFdlaWdodDogJ2JvbGQnLFxyXG4gICAgICAgICAgICAgIGZvbnRTaXplOiAnMTVweCcsXHJcbiAgICAgICAgICAgICAgY29sb3I6ICcjMzAzMDMwJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgIHRpdGxlOiAnJyxcclxuICAgICAgICAgIC8qe1xyXG4gICAgICAgICAgICAgICAgICAgICAgdGV4dDogJ1BhdGllbnQgbWVkaWNhdGlvbnMnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgYWxpZ246ICdsZWZ0JyxcclxuICAgICAgICAgICAgICAgICAgICAgIG1hcmdpbjogMSxcclxuICAgICAgICAgICAgICAgICAgICAgIHN0eWxlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiBcIiMzMzMzMzNcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9udFNpemU6IFwiMTJweFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb250V2VpZ2h0OiBcImJvbGRcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sKi9cclxuXHJcblxyXG4gICAgICAgICAgeUF4aXM6IHtcclxuICAgICAgICAgICAgdHlwZTogJ2RhdGV0aW1lJyxcclxuICAgICAgICAgICAgbWluOiBEYXRlLlVUQygyMDA1LCA2LCAxMiksXHJcbiAgICAgICAgICAgIG1heDogbmV3IERhdGUoKS5nZXRUaW1lKCksXHJcbiAgICAgICAgICAgIGNyb3NzaGFpcjoge1xyXG4gICAgICAgICAgICAgIHNuYXA6IGZhbHNlXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGV2ZW50czoge1xyXG4gICAgICAgICAgICAgIHNldEV4dHJlbWVzOiBzeW5jRXh0cmVtZXNcclxuICAgICAgICAgICAgfSxcclxuXHJcblxyXG5cclxuICAgICAgICAgICAgLy90aGluZ3MgdGhhdCBhcmUgbm9ybWFsbHkgeEF4aXMgZGVmYXVsdHNcclxuICAgICAgICAgICAgZW5kT25UaWNrOiBmYWxzZSxcclxuICAgICAgICAgICAgZ3JpZExpbmVXaWR0aDogMCxcclxuICAgICAgICAgICAgbGluZVdpZHRoOiAxLFxyXG4gICAgICAgICAgICBtYXhQYWRkaW5nOiAwLjAxLFxyXG4gICAgICAgICAgICBtaW5QYWRkaW5nOiAwLjAxLFxyXG4gICAgICAgICAgICBzdGFydE9uVGljazogZmFsc2UsXHJcbiAgICAgICAgICAgIHRpY2tXaWR0aDogMSxcclxuICAgICAgICAgICAgdGl0bGU6IHtcclxuICAgICAgICAgICAgICB0ZXh0OiAnJ1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB0aWNrUGl4ZWxJbnRlcnZhbDogMTAwXHJcbiAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgIHhBeGlzOiB7XHJcbiAgICAgICAgICAgIGxhYmVsczoge1xyXG4gICAgICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHN0YXJ0T25UaWNrOiBmYWxzZSxcclxuICAgICAgICAgICAgZW5kT25UaWNrOiBmYWxzZSxcclxuICAgICAgICAgICAgdGl0bGU6IHtcclxuICAgICAgICAgICAgICB0ZXh0OiAnJ1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB0aWNrV2lkdGg6IDAsXHJcbiAgICAgICAgICAgIG1pblBhZGRpbmc6IDAuMixcclxuICAgICAgICAgICAgbWF4UGFkZGluZzogMC4yLFxyXG5cclxuICAgICAgICAgICAgLy90aGluZ3MgdGhhdCBhcmUgbm9ybWFsbHkgeUF4aXMgZGVmYXVsdHNcclxuICAgICAgICAgICAgZ3JpZExpbmVXaWR0aDogMCxcclxuICAgICAgICAgICAgbGluZVdpZHRoOiAwXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgY3JlZGl0czoge1xyXG4gICAgICAgICAgICBlbmFibGVkOiBmYWxzZVxyXG4gICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICBsZWdlbmQ6IHtcclxuICAgICAgICAgICAgZW5hYmxlZDogZmFsc2VcclxuICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgdG9vbHRpcDoge1xyXG4gICAgICAgICAgICBmb3JtYXR0ZXI6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgIHZhciB5Q29vcmQgPSB0aGlzLnk7XHJcbiAgICAgICAgICAgICAgdmFyIGxhYmVsVG1wID0gbWVkaWNhdGlvbnNbTWF0aC5mbG9vcih0aGlzLngpXS5pbnRlcnZhbHMuZmlsdGVyKGZ1bmN0aW9uKHYpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB5Q29vcmQgPj0gdi5mcm9tICYmIHlDb29yZCA8PSB2LnRvO1xyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIHZhciBsYWJlbCA9IGxhYmVsVG1wLmxlbmd0aCA+IDAgPyBsYWJlbFRtcFswXS5sYWJlbCA6IFwiTm8gbGFiZWwgQ1wiO1xyXG4gICAgICAgICAgICAgIHJldHVybiAnPGI+JyArIG1lZGljYXRpb25zW01hdGguZmxvb3IodGhpcy54KV0ubmFtZSArIChsYWJlbCA/ICc6ICcgKyBsYWJlbCA6ICcnKSArICc8L2I+PGJyLz4nICtcclxuICAgICAgICAgICAgICAgIEhpZ2hjaGFydHMuZGF0ZUZvcm1hdCgnJWQvJW0vJVknLCB0aGlzLnBvaW50Lm9wdGlvbnMubG93KSArXHJcbiAgICAgICAgICAgICAgICAnIC0gJyArIEhpZ2hjaGFydHMuZGF0ZUZvcm1hdCgnJWQvJW0vJVknLCB0aGlzLnBvaW50Lm9wdGlvbnMuaGlnaCk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGZvbGxvd1BvaW50ZXI6IHRydWVcclxuICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgcGxvdE9wdGlvbnM6IHtcclxuICAgICAgICAgICAgY29sdW1ucmFuZ2U6IHtcclxuICAgICAgICAgICAgICBncm91cGluZzogZmFsc2UsXHJcbiAgICAgICAgICAgICAgZGF0YUxhYmVsczoge1xyXG4gICAgICAgICAgICAgICAgYWxsb3dPdmVybGFwOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgZW5hYmxlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGZvcm1hdHRlcjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgIHZhciB5Q29vcmQgPSB0aGlzLnk7XHJcbiAgICAgICAgICAgICAgICAgIHZhciBpZHggPSAtMTtcclxuICAgICAgICAgICAgICAgICAgdmFyIGxhYmVsVG1wID0gbWVkaWNhdGlvbnNbTWF0aC5mbG9vcih0aGlzLngpXS5pbnRlcnZhbHMuZmlsdGVyKGZ1bmN0aW9uKHYsIGkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoeUNvb3JkID49IHYuZnJvbSAmJiB5Q29vcmQgPD0gdi50bykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgaWR4ID0gaTtcclxuICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICB2YXIgbGFiZWwgPSBsYWJlbFRtcC5sZW5ndGggPiAwID8gbGFiZWxUbXBbMF0ubGFiZWwgOiBcIk5vIGxhYmVsIERcIjtcclxuICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMueSA9PT0gdGhpcy5wb2ludC5sb3cgJiZcclxuICAgICAgICAgICAgICAgICAgICAobWVkaWNhdGlvbnNbTWF0aC5mbG9vcih0aGlzLngpXS5pbnRlcnZhbHMubGVuZ3RoIC0gMSA9PT0gaWR4IHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAodGhpcy5zZXJpZXMuY2hhcnQueUF4aXNbMF0ubWluIDw9IHlDb29yZCAmJiB0aGlzLnNlcmllcy5jaGFydC55QXhpc1swXS5tYXggPj0geUNvb3JkKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgKHRoaXMuc2VyaWVzLmNoYXJ0LnlBeGlzWzBdLm1pbiA+PSB0aGlzLnBvaW50LmxvdyAmJiB0aGlzLnNlcmllcy5jaGFydC55QXhpc1swXS5tYXggPD0gdGhpcy5wb2ludC5oaWdoKSkgPyBtZWRpY2F0aW9uc1tNYXRoLmZsb29yKHRoaXMueCldLm5hbWUgKyAobGFiZWwgPyAnOiAnICsgbGFiZWwgOiAnJykgOiAnJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgc2VyaWVzOiBzZXJpZXNcclxuXHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIHBsb3RDb25kaXRpb25zKGRhdGEuY29uZGl0aW9ucywgZGF0YS5ldmVudHMsIGRhdGEuY29udGFjdHMpO1xyXG4gICAgcGxvdE1lYXN1cmVtZW50cyhkYXRhLm1lYXN1cmVtZW50cyk7XHJcbiAgICB2YXIgYyA9IHBsb3RNZWRpY2F0aW9ucyhkYXRhLm1lZGljYXRpb25zKTtcclxuICAgIHBsb3ROYXZpZ2F0b3IoKTtcclxuICAgIGMuaGlnaGNoYXJ0cygpLmF4ZXNbMV0uc2V0RXh0cmVtZXMoMTQzNDg2NDAwMDAwMCwgMTQ1OTgxNDQwMDAwMCwgdW5kZWZpbmVkLCBmYWxzZSwge1xyXG4gICAgICB0cmlnZ2VyOiAnc3luY0V4dHJlbWVzJ1xyXG4gICAgfSk7XHJcblxyXG4gICAgbGwuY2hhcnRBcnJheSA9IEhpZ2hjaGFydHMuY2hhcnRzLnNsaWNlKEhpZ2hjaGFydHMuY2hhcnRzLmxlbmd0aCAtIGxsLmNoYXJ0cywgSGlnaGNoYXJ0cy5jaGFydHMubGVuZ3RoKTtcclxuXHJcbiAgICB2YXIgcyA9IHN5bmNFeHRyZW1lcy5iaW5kKGMuaGlnaGNoYXJ0cygpLnNlcmllc1swXSk7XHJcbiAgICBzKHtcclxuICAgICAgdHJpZ2dlcjogJ25hdmlnYXRvcicsXHJcbiAgICAgIG1pbjogMTQzNDg2NDAwMDAwMCxcclxuICAgICAgbWF4OiAxNDU5ODE0NDAwMDAwXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBsbDtcclxuIiwidmFyIGJhc2UgPSByZXF1aXJlKCcuLi9iYXNlLmpzJyksXHJcbiAgY29uZmlybSA9IHJlcXVpcmUoJy4vY29uZmlybS5qcycpLFxyXG4gIGRhdGEgPSByZXF1aXJlKCcuLi9kYXRhLmpzJyksXHJcbiAgbG9nID0gcmVxdWlyZSgnLi4vbG9nLmpzJyk7XHJcblxyXG52YXIgbWVkID0ge1xyXG5cclxuICBjcmVhdGU6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKSB7XHJcbiAgICB2YXIgbWVkaWNhdGlvbnMgPSBkYXRhLnBhdGllbnRzW3BhdGllbnRJZF0ubWVkaWNhdGlvbnMgfHwgW107XHJcbiAgICB2YXIgYWdyZWUgPSBsb2cuZ2V0UGF0aWVudEFncmVlT2JqZWN0KHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkLCBcIm1lZGljYXRpb25cIik7XHJcbiAgICByZXR1cm4gYmFzZS5jcmVhdGVQYW5lbChtZWRpY2F0aW9uUGFuZWwsIHtcclxuICAgICAgXCJhcmVNZWRpY2F0aW9uc1wiOiBtZWRpY2F0aW9ucy5sZW5ndGggPiAwLFxyXG4gICAgICBcImFncmVlXCI6IGFncmVlICYmIGFncmVlLmFncmVlLFxyXG4gICAgICBcImRpc2FncmVlXCI6IGFncmVlICYmIGFncmVlLmFncmVlID09PSBmYWxzZSxcclxuICAgICAgXCJwYXRod2F5XCI6IGRhdGEucGF0aHdheU5hbWVzW3BhdGh3YXlJZF0sXHJcbiAgICAgIFwibWVkaWNhdGlvbnNcIjogbWVkaWNhdGlvbnMsXHJcbiAgICAgIFwicGF0aHdheVN0YWdlXCI6IHBhdGh3YXlTdGFnZVxyXG4gICAgfSwge1xyXG4gICAgICBcIm1lZGljYXRpb25Sb3dcIjogJCgnI21lZGljYXRpb24tcm93JykuaHRtbCgpXHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICB3aXJlVXA6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKSB7XHJcbiAgICBjb25maXJtLndpcmVVcCgkKCcjbWVkaWNhdGlvbi1hZ3JlZS1kaXNhZ3JlZScpLCAkKCcjbWVkaWNhdGlvbi1wYW5lbCcpLCBwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCwgXCJtZWRpY2F0aW9uXCIsIFwibWVkaWNhdGlvbiBkYXRhXCIpO1xyXG4gIH1cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IG1lZDtcclxuIiwidmFyIGJhc2UgPSByZXF1aXJlKCcuLi9iYXNlLmpzJyksXHJcbiAgY29uZmlybSA9IHJlcXVpcmUoJy4vY29uZmlybS5qcycpLFxyXG4gIGRhdGEgPSByZXF1aXJlKCcuLi9kYXRhLmpzJyksXHJcbiAgbG9nID0gcmVxdWlyZSgnLi4vbG9nLmpzJyk7XHJcblxyXG52YXIgb3RoZXIgPSB7XHJcblxyXG4gIGNyZWF0ZTogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpIHtcclxuICAgIHZhciBjb2RlcyA9IChkYXRhLnBhdGllbnRzW3BhdGllbnRJZF0uY29kZXMgfHwgW10pLm1hcChmdW5jdGlvbih2YWwpIHtcclxuICAgICAgdmFsLmRlc2NyaXB0aW9uID0gZGF0YS5jb2Rlc1t2YWwuY29kZV07XHJcbiAgICAgIHJldHVybiB2YWw7XHJcbiAgICB9KTtcclxuICAgIHZhciBhZ3JlZSA9IGxvZy5nZXRQYXRpZW50QWdyZWVPYmplY3QocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQsIFwiY29kZXNcIik7XHJcbiAgICByZXR1cm4gYmFzZS5jcmVhdGVQYW5lbCgkKCcjb3RoZXItY29kZXMtcGFuZWwnKSwge1xyXG4gICAgICBcImFyZUNvZGVzXCI6IGNvZGVzLmxlbmd0aCA+IDAsXHJcbiAgICAgIFwiYWdyZWVcIjogYWdyZWUgJiYgYWdyZWUuYWdyZWUsXHJcbiAgICAgIFwiZGlzYWdyZWVcIjogYWdyZWUgJiYgYWdyZWUuYWdyZWUgPT09IGZhbHNlLFxyXG4gICAgICBcInBhdGh3YXlcIjogZGF0YS5wYXRod2F5TmFtZXNbcGF0aHdheUlkXSxcclxuICAgICAgXCJzdGFuZGFyZFwiOiBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLnRhYi50aXRsZSxcclxuICAgICAgXCJjb2Rlc1wiOiBjb2RlcyxcclxuICAgICAgXCJwYXRod2F5U3RhZ2VcIjogcGF0aHdheVN0YWdlXHJcbiAgICB9LCB7XHJcbiAgICAgIFwiY29kZVJvd1wiOiAkKCcjb3RoZXItY29kZXMtcm93JykuaHRtbCgpXHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICB3aXJlVXA6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKSB7XHJcbiAgICBjb25maXJtLndpcmVVcCgkKCcjb3RoZXItY29kZXMtYWdyZWUtZGlzYWdyZWUnKSwgJCgnI290aGVyLWNvZGVzLXBhbmVsJyksIHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkLCBcImNvZGVzXCIsIFwib3RoZXIgY29kZXNcIik7XHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gb3RoZXI7XHJcbiIsInZhciBkYXRhID0gcmVxdWlyZSgnLi4vZGF0YS5qcycpLFxyXG4gIE11c3RhY2hlID0gcmVxdWlyZSgnbXVzdGFjaGUnKTtcclxuXHJcbnZhciBwYyA9IHtcclxuXHJcbiAgc2hvdzogZnVuY3Rpb24ocGFuZWwsIGlzQXBwZW5kLCBwYXRpZW50SWQpIHtcclxuXHJcbiAgICB2YXIgcGF0aWVudERhdGEgPSBkYXRhLmdldFBhdGllbnREYXRhKHBhdGllbnRJZCk7XHJcblxyXG4gICAgdmFyIHRlbXBNdXN0ID0gJCgnI3BhdGllbnQtY2hhcmFjdGVyaXN0aWNzLXBhbmVsJykuaHRtbCgpO1xyXG4gICAgdmFyIGh0bWwgPSBNdXN0YWNoZS5yZW5kZXIodGVtcE11c3QsIHBhdGllbnREYXRhLmNoYXJhY3RlcmlzdGljcyk7XHJcblxyXG4gICAgaWYgKGlzQXBwZW5kKSBwYW5lbC5hcHBlbmQoaHRtbCk7XHJcbiAgICBlbHNlIHBhbmVsLmh0bWwoaHRtbCk7XHJcblxyXG4gIH1cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHBjO1xyXG4iLCJ2YXIgSGlnaGNoYXJ0cyA9IHJlcXVpcmUoJ2hpZ2hjaGFydHMvaGlnaHN0b2NrJyksXHJcbiAgYmFzZSA9IHJlcXVpcmUoJy4uL2Jhc2UuanMnKSxcclxuICBkYXRhID0gcmVxdWlyZSgnLi4vZGF0YS5qcycpLFxyXG4gIGxvb2t1cCA9IHJlcXVpcmUoJy4uL2xvb2t1cC5qcycpLFxyXG4gIE11c3RhY2hlID0gcmVxdWlyZSgnbXVzdGFjaGUnKTtcclxuXHJcbnZhciBJRCA9IFwiUEFUSUVOVF9MSVNUXCI7XHJcblxyXG52YXIgcGwgPSB7XHJcblxyXG4gIHdpcmVVcDogZnVuY3Rpb24ob25QYXRpZW50U2VsZWN0ZWQpIHtcclxuICAgIHBhdGllbnRzUGFuZWwgPSAkKCcjcGF0aWVudHMnKTtcclxuXHJcbiAgICBwYXRpZW50c1BhbmVsLm9uKCdjbGljaycsICd0aGVhZCB0ciB0aC5zb3J0YWJsZScsIGZ1bmN0aW9uKCkgeyAvL1NvcnQgY29sdW1ucyB3aGVuIGNvbHVtbiBoZWFkZXIgY2xpY2tlZFxyXG4gICAgICB2YXIgc29ydEFzYyA9ICEkKHRoaXMpLmhhc0NsYXNzKCdzb3J0LWFzYycpO1xyXG4gICAgICBpZiAoc29ydEFzYykge1xyXG4gICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoJ3NvcnQtZGVzYycpLmFkZENsYXNzKCdzb3J0LWFzYycpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoJ3NvcnQtYXNjJykuYWRkQ2xhc3MoJ3NvcnQtZGVzYycpO1xyXG4gICAgICB9XHJcbiAgICAgIHBsLnBvcHVsYXRlKHBsLnN0YXRlWzBdLCBwbC5zdGF0ZVsxXSwgcGwuc3RhdGVbMl0sIHBsLnN0YXRlWzNdLCAkKHRoaXMpLmluZGV4KCksIHNvcnRBc2MpO1xyXG4gICAgfSkub24oJ2NsaWNrJywgJ3Rib2R5IHRyJywgZnVuY3Rpb24oZSkgeyAvL1NlbGVjdCBpbmRpdmlkdWFsIHBhdGllbnQgd2hlbiByb3cgY2xpY2tlZCNcclxuICAgICAgdmFyIGNhbGxiYWNrID0gb25QYXRpZW50U2VsZWN0ZWQuYmluZCh0aGlzKTtcclxuICAgICAgdmFyIHBhdGllbnRJZCA9ICQodGhpcykuZmluZCgndGQgYnV0dG9uJykuYXR0cignZGF0YS1wYXRpZW50LWlkJyk7XHJcbiAgICAgIGNhbGxiYWNrKHBhdGllbnRJZCk7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgIH0pLm9uKCdjbGljaycsICd0Ym9keSB0ciBidXR0b24nLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIC8vZG9uJ3Qgd2FudCByb3cgc2VsZWN0ZWQgaWYganVzdCBidXR0b24gcHJlc3NlZD9cclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgfSk7XHJcbiAgfSxcclxuXHJcbiAgc2VsZWN0U3Vic2VjdGlvbjogZnVuY3Rpb24oc2VjdGlvbikge1xyXG4gICAgcGwucG9wdWxhdGUocGwuc3RhdGVbMF0sIHBsLnN0YXRlWzFdLCBwbC5zdGF0ZVsyXSwgc2VjdGlvbiwgcGwuc3RhdGVbNF0sIHBsLnN0YXRlWzVdKTtcclxuICB9LFxyXG5cclxuICBwb3B1bGF0ZTogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBzdWJzZWN0aW9uLCBzb3J0RmllbGQsIHNvcnRBc2MpIHtcclxuICAgIHBsLnN0YXRlID0gW3BhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgc3Vic2VjdGlvbiwgc29ydEZpZWxkLCBzb3J0QXNjXTtcclxuICAgIHBhdGllbnRzUGFuZWwgPSAkKCcjcGF0aWVudHMnKTtcclxuICAgIC8vUmVtb3ZlIHNjcm9sbCBpZiBleGlzdHNcclxuICAgIHBhdGllbnRzUGFuZWwuZmluZCgnZGl2LnRhYmxlLXNjcm9sbCcpLmdldE5pY2VTY3JvbGwoKS5yZW1vdmUoKTtcclxuXHJcbiAgICB2YXIgaSwgaywgcHJvcCwgaGVhZGVyLCBwTGlzdCA9IFtdO1xyXG5cclxuICAgIGRhdGEuZ2V0SW5kaWNhdG9yRGF0YShbcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkXS5qb2luKFwiLlwiKSwgZnVuY3Rpb24oaW5kaWNhdG9ycykge1xyXG5cclxuICAgICAgaWYgKHBhdGh3YXlJZCAmJiBwYXRod2F5U3RhZ2UgJiYgc3RhbmRhcmQgJiYgc3Vic2VjdGlvbikge1xyXG4gICAgICAgIHBMaXN0ID0gaW5kaWNhdG9ycy5vcHBvcnR1bml0aWVzLmZpbHRlcihmdW5jdGlvbih2YWwpIHtcclxuICAgICAgICAgIHJldHVybiB2YWwubmFtZSA9PT0gc3Vic2VjdGlvbjtcclxuICAgICAgICB9KVswXS5wYXRpZW50cztcclxuICAgICAgICBoZWFkZXIgPSBpbmRpY2F0b3JzLm9wcG9ydHVuaXRpZXMuZmlsdGVyKGZ1bmN0aW9uKHZhbCkge1xyXG4gICAgICAgICAgcmV0dXJuIHZhbC5uYW1lID09PSBzdWJzZWN0aW9uO1xyXG4gICAgICAgIH0pWzBdLmRlc2NyaXB0aW9uO1xyXG4gICAgICB9IGVsc2UgaWYgKHBhdGh3YXlJZCAmJiBwYXRod2F5U3RhZ2UgJiYgc3RhbmRhcmQpIHtcclxuICAgICAgICBwTGlzdCA9IGluZGljYXRvcnMub3Bwb3J0dW5pdGllcy5yZWR1Y2UoZnVuY3Rpb24oYSwgYikge1xyXG4gICAgICAgICAgcmV0dXJuIGEucGF0aWVudHMgPyBhLnBhdGllbnRzLmNvbmNhdChiLnBhdGllbnRzKSA6IGEuY29uY2F0KGIucGF0aWVudHMpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGhlYWRlciA9IGRhdGEudGV4dFtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS50YWJsZVRpdGxlO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBwTGlzdCA9IGRhdGEucmVtb3ZlRHVwbGljYXRlcyhwTGlzdCk7XHJcbiAgICAgIHZhciB2SWQgPSBkYXRhLnRleHRbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0udmFsdWVJZDtcclxuICAgICAgdmFyIGRPdiA9IGRhdGEudGV4dFtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS5kYXRlT1J2YWx1ZTtcclxuICAgICAgdmFyIHBhdGllbnRzID0gcExpc3QubWFwKGZ1bmN0aW9uKHBhdGllbnRJZCkge1xyXG4gICAgICAgIHZhciByZXQgPSBpbmRpY2F0b3JzLnBhdGllbnRzW3BhdGllbnRJZF07XHJcbiAgICAgICAgcmV0Lm5oc051bWJlciA9IGRhdGEucGF0TG9va3VwW3BhdGllbnRJZF0gfHwgcGF0aWVudElkO1xyXG4gICAgICAgIHJldC5wYXRpZW50SWQgPSBwYXRpZW50SWQ7XHJcbiAgICAgICAgcmV0Lml0ZW1zID0gW2RhdGEucGF0aWVudHNbcGF0aWVudElkXS5jaGFyYWN0ZXJpc3RpY3MuYWdlXTsgLy9UaGUgZmllbGRzIGluIHRoZSBwYXRpZW50IGxpc3QgdGFibGVcclxuXHJcbiAgICAgICAgdmFyIG1lYXN1cmVzID0gZGF0YS5wYXRpZW50c1twYXRpZW50SWRdLm1lYXN1cmVtZW50cy5maWx0ZXIoZnVuY3Rpb24odil7cmV0dXJuIHYuaWQ9PT12SWQ7fSk7XHJcblxyXG4gICAgICAgIGlmICggbWVhc3VyZXNbMF0gJiYgbWVhc3VyZXNbMF0uZGF0YSkge1xyXG4gICAgICAgICAgaWYgKGRPdiA9PT0gXCJkYXRlXCIpIHtcclxuICAgICAgICAgICAgcmV0Lml0ZW1zLnB1c2gobmV3IERhdGUobWVhc3VyZXNbMF0uZGF0YVttZWFzdXJlc1swXS5kYXRhLmxlbmd0aC0xXVswXSkpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0Lml0ZW1zLnB1c2gobWVhc3VyZXNbMF0uZGF0YVttZWFzdXJlc1swXS5kYXRhLmxlbmd0aC0xXVsxXSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJldC5pdGVtcy5wdXNoKFwiP1wiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0Lml0ZW1zLnB1c2goaW5kaWNhdG9ycy5wYXRpZW50c1twYXRpZW50SWRdLm9wcG9ydHVuaXRpZXMubWFwKGZ1bmN0aW9uKHYpe3JldHVybiAnPHNwYW4gc3R5bGU9XCJ3aWR0aDoxM3B4O2hlaWdodDoxM3B4O2Zsb2F0OmxlZnQ7YmFja2dyb3VuZC1jb2xvcjonICsgSGlnaGNoYXJ0cy5nZXRPcHRpb25zKCkuY29sb3JzW3ZdICsgJ1wiPjwvc3Bhbj4nO30pLmpvaW4oXCJcIikpO1xyXG4gICAgICAgIC8vcmV0Lml0ZW1zLnB1c2goZGF0YS5udW1iZXJPZlN0YW5kYXJkc01pc3NlZChwYXRpZW50SWQpKTtcclxuICAgICAgICByZXR1cm4gcmV0O1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHZhciBsb2NhbERhdGEgPSB7XHJcbiAgICAgICAgXCJwYXRpZW50c1wiOiBwYXRpZW50cyxcclxuICAgICAgICBcIm5cIjogcGF0aWVudHMubGVuZ3RoLFxyXG4gICAgICAgIFwiaGVhZGVyXCI6IGhlYWRlcixcclxuICAgICAgICBcImhlYWRlci1pdGVtc1wiOiBbe1xyXG4gICAgICAgICAgXCJ0aXRsZVwiOiBcIk5IUyBuby5cIixcclxuICAgICAgICAgIFwiaXNTb3J0ZWRcIjogZmFsc2UsXHJcbiAgICAgICAgICBcImRpcmVjdGlvblwiOiBcInNvcnQtYXNjXCIsXHJcbiAgICAgICAgICBcInRvb2x0aXBcIjogXCJOSFMgbnVtYmVyIG9mIGVhY2ggcGF0aWVudFwiXHJcbiAgICAgICAgfSx7XHJcbiAgICAgICAgICBcInRpdGxlXCI6IFwiQWdlXCIsXHJcbiAgICAgICAgICBcImlzU29ydGVkXCI6IGZhbHNlLFxyXG4gICAgICAgICAgXCJkaXJlY3Rpb25cIjogXCJzb3J0LWFzY1wiLFxyXG4gICAgICAgICAgXCJ0b29sdGlwXCI6IFwiVGhlIGFnZSBvZiB0aGUgcGF0aWVudFwiXHJcbiAgICAgICAgfV1cclxuICAgICAgfTtcclxuXHJcbiAgICAgIC8vbWlkZGxlIGNvbHVtbiBpcyBlaXRoZXIgdmFsdWUgb3IgZGF0ZVxyXG4gICAgICBpZiAoZE92KSB7XHJcbiAgICAgICAgbG9jYWxEYXRhW1wiaGVhZGVyLWl0ZW1zXCJdLnB1c2goe1xyXG4gICAgICAgICAgXCJ0aXRsZVwiOiBkYXRhLnRleHRbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0udmFsdWVOYW1lLFxyXG4gICAgICAgICAgXCJ0b29sdGlwXCI6IGRPdiA9PT0gXCJkYXRlXCIgPyBcIkxhc3QgZGF0ZSBcIiArIHZJZCArIFwiIHdhcyBtZWFzdXJlZFwiIDogXCJMYXN0IFwiICsgdklkICsgXCIgcmVhZGluZ1wiLFxyXG4gICAgICAgICAgXCJpc1NvcnRlZFwiOiBmYWxzZSxcclxuICAgICAgICAgIFwiZGlyZWN0aW9uXCI6IFwic29ydC1hc2NcIlxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGlmIChwYXRod2F5U3RhZ2UgPT09IGxvb2t1cC5jYXRlZ29yaWVzLm1vbml0b3JpbmcubmFtZSkge1xyXG4gICAgICAgICAgbG9jYWxEYXRhW1wiaGVhZGVyLWl0ZW1zXCJdLnB1c2goe1xyXG4gICAgICAgICAgICBcInRpdGxlXCI6IFwiTGFzdCBCUCBEYXRlXCIsXHJcbiAgICAgICAgICAgIFwiaXNTb3J0ZWRcIjogZmFsc2UsXHJcbiAgICAgICAgICAgIFwiZGlyZWN0aW9uXCI6IFwic29ydC1hc2NcIixcclxuICAgICAgICAgICAgXCJ0b29sdGlwXCI6IFwiTGFzdCBkYXRlIEJQIHdhcyBtZWFzdXJlZFwiXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgbG9jYWxEYXRhW1wiaGVhZGVyLWl0ZW1zXCJdLnB1c2goe1xyXG4gICAgICAgICAgICBcInRpdGxlXCI6IFwiTGFzdCBTQlBcIixcclxuICAgICAgICAgICAgXCJ0b29sdGlwXCI6IFwiTGFzdCBzeXN0b2xpYyBCUCByZWFkaW5nXCIsXHJcbiAgICAgICAgICAgIFwiaXNTb3J0ZWRcIjogZmFsc2UsXHJcbiAgICAgICAgICAgIFwiZGlyZWN0aW9uXCI6IFwic29ydC1hc2NcIlxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICAvL2FkZCBxdWFsIHN0YW5kYXJkIGNvbHVtblxyXG4gICAgICBsb2NhbERhdGFbXCJoZWFkZXItaXRlbXNcIl0ucHVzaCh7XHJcbiAgICAgICAgXCJ0aXRsZVwiOiBcIkNhdGVnb3JpZXNcIixcclxuICAgICAgICBcInRpdGxlSFRNTFwiOiAnQ2F0ZWdvcmllcycsXHJcbiAgICAgICAgXCJpc1NvcnRlZFwiOiB0cnVlLFxyXG4gICAgICAgIFwidG9vbHRpcFwiOiBcIkNhdGVnb3JpZXMgZnJvbSBhYm92ZSBjaGFydFwiXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgaWYgKHNvcnRGaWVsZCA9PT0gdW5kZWZpbmVkKSBzb3J0RmllbGQgPSAyO1xyXG4gICAgICBpZiAoc29ydEZpZWxkICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICBsb2NhbERhdGEucGF0aWVudHMuc29ydChmdW5jdGlvbihhLCBiKSB7XHJcbiAgICAgICAgICBpZiAoc29ydEZpZWxkID09PSAwKSB7IC8vTkhTIG51bWJlclxyXG4gICAgICAgICAgICBpZiAoYS5uaHNOdW1iZXIgPT09IGIubmhzTnVtYmVyKSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIDA7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChhLm5oc051bWJlciA+IGIubmhzTnVtYmVyKSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIHNvcnRBc2MgPyAxIDogLTE7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoYS5uaHNOdW1iZXIgPCBiLm5oc051bWJlcikge1xyXG4gICAgICAgICAgICAgIHJldHVybiBzb3J0QXNjID8gLTEgOiAxO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAoYS5pdGVtc1tzb3J0RmllbGQgLSAxXSA9PT0gYi5pdGVtc1tzb3J0RmllbGQgLSAxXSkge1xyXG4gICAgICAgICAgICAgIHJldHVybiAwO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoYS5pdGVtc1tzb3J0RmllbGQgLSAxXSA9PSBcIj9cIikgcmV0dXJuIDE7XHJcbiAgICAgICAgICAgIGlmIChiLml0ZW1zW3NvcnRGaWVsZCAtIDFdID09IFwiP1wiKSByZXR1cm4gLTE7XHJcblxyXG4gICAgICAgICAgICB2YXIgQSA9IE51bWJlcihhLml0ZW1zW3NvcnRGaWVsZCAtIDFdKTtcclxuICAgICAgICAgICAgdmFyIEIgPSBOdW1iZXIoYi5pdGVtc1tzb3J0RmllbGQgLSAxXSk7XHJcbiAgICAgICAgICAgIGlmIChpc05hTihBKSB8fCBpc05hTihCKSkge1xyXG4gICAgICAgICAgICAgIEEgPSBhLml0ZW1zW3NvcnRGaWVsZCAtIDFdO1xyXG4gICAgICAgICAgICAgIEIgPSBiLml0ZW1zW3NvcnRGaWVsZCAtIDFdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChBID4gQikge1xyXG4gICAgICAgICAgICAgIHJldHVybiBzb3J0QXNjID8gMSA6IC0xO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKEEgPCBCKSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIHNvcnRBc2MgPyAtMSA6IDE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGxvY2FsRGF0YVtcImhlYWRlci1pdGVtc1wiXS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgaWYgKGkgPT09IHNvcnRGaWVsZCkge1xyXG4gICAgICAgICAgICBsb2NhbERhdGFbXCJoZWFkZXItaXRlbXNcIl1baV0uZGlyZWN0aW9uID0gc29ydEFzYyA/IFwic29ydC1hc2NcIiA6IFwic29ydC1kZXNjXCI7XHJcbiAgICAgICAgICAgIGxvY2FsRGF0YVtcImhlYWRlci1pdGVtc1wiXVtpXS5pc0FzYyA9IHNvcnRBc2M7XHJcbiAgICAgICAgICAgIGxvY2FsRGF0YVtcImhlYWRlci1pdGVtc1wiXVtpXS5pc1NvcnRlZCA9IHRydWU7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBsb2NhbERhdGFbXCJoZWFkZXItaXRlbXNcIl1baV0uaXNTb3J0ZWQgPSBmYWxzZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGJhc2UuY3JlYXRlUGFuZWxTaG93KHBhdGllbnRMaXN0LCBwYXRpZW50c1BhbmVsLCBsb2NhbERhdGEsIHtcclxuICAgICAgICBcImhlYWRlci1pdGVtXCI6ICQoXCIjcGF0aWVudC1saXN0LWhlYWRlci1pdGVtXCIpLmh0bWwoKSxcclxuICAgICAgICBcIml0ZW1cIjogJCgnI3BhdGllbnQtbGlzdC1pdGVtJykuaHRtbCgpXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgJCgnI3BhdGllbnRzLXBsYWNlaG9sZGVyJykuaGlkZSgpO1xyXG5cclxuICAgICAgYmFzZS5zZXR1cENsaXBib2FyZCgkKCcuYnRuLWNvcHknKSwgdHJ1ZSk7XHJcblxyXG4gICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcblxyXG4gICAgICBwYXRpZW50c1BhbmVsLmZpbmQoJ2Rpdi50YWJsZS1zY3JvbGwnKS5uaWNlU2Nyb2xsKHtcclxuICAgICAgICBjdXJzb3JvcGFjaXR5bWluOiAwLjMsXHJcbiAgICAgICAgY3Vyc29yd2lkdGg6IFwiN3B4XCIsXHJcbiAgICAgICAgaG9yaXpyYWlsZW5hYmxlZDogZmFsc2VcclxuICAgICAgfSk7XHJcblxyXG4gICAgfSk7XHJcblxyXG4gIH0sXHJcblxyXG4gIHNob3c6IGZ1bmN0aW9uKHBhbmVsLCBpc0FwcGVuZCwgcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBsb2FkQ29udGVudEZuKSB7XHJcblxyXG4gICAgdmFyIHRlbXBNdXN0ID0gJCgnI3BhdGllbnRzLXBhbmVsLXllcycpLmh0bWwoKTtcclxuXHJcbiAgICBpZihpc0FwcGVuZCkgcGFuZWwuYXBwZW5kKE11c3RhY2hlLnJlbmRlcih0ZW1wTXVzdCkpO1xyXG4gICAgZWxzZSBwYW5lbC5odG1sKE11c3RhY2hlLnJlbmRlcih0ZW1wTXVzdCkpO1xyXG5cclxuICAgIHBsLndpcmVVcChmdW5jdGlvbihwYXRpZW50SWQpIHtcclxuICAgICAgaGlzdG9yeS5wdXNoU3RhdGUobnVsbCwgbnVsbCwgJyNwYXRpZW50LycgKyBwYXRpZW50SWQpO1xyXG4gICAgICBsb2FkQ29udGVudEZuKCcjcGF0aWVudC8nICsgcGF0aWVudElkKTtcclxuICAgIH0pO1xyXG4gICAgcGwucG9wdWxhdGUocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBudWxsKTtcclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBwbDtcclxuIiwidmFyIGJhc2UgPSByZXF1aXJlKCcuLi9iYXNlLmpzJyksXHJcbiAgZGF0YSA9IHJlcXVpcmUoJy4uL2RhdGEuanMnKSxcclxuICBsb29rdXAgPSByZXF1aXJlKCcuLi9sb29rdXAuanMnKSxcclxuICBNdXN0YWNoZSA9IHJlcXVpcmUoJ211c3RhY2hlJyk7XHJcbnZhciBzdGF0ZXMsIGxvYWRDb250Rm4sIElEID0gXCJQQVRJRU5UX1NFQVJDSFwiO1xyXG5cclxudmFyIHBzID0ge1xyXG5cclxuICB3aXJlVXA6IGZ1bmN0aW9uKCkge1xyXG4gICAgaWYgKHN0YXRlcykge1xyXG4gICAgICBzdGF0ZXMuY2xlYXJQcmVmZXRjaENhY2hlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGVzID0gbmV3IEJsb29kaG91bmQoe1xyXG4gICAgICBkYXR1bVRva2VuaXplcjogQmxvb2Rob3VuZC50b2tlbml6ZXJzLm9iai53aGl0ZXNwYWNlKCd2YWx1ZScpLFxyXG4gICAgICBxdWVyeVRva2VuaXplcjogQmxvb2Rob3VuZC50b2tlbml6ZXJzLndoaXRlc3BhY2UsXHJcbiAgICAgIGxvY2FsOiAkLm1hcChkYXRhLnBhdGllbnRBcnJheSwgZnVuY3Rpb24oc3RhdGUpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgaWQ6IHN0YXRlLFxyXG4gICAgICAgICAgdmFsdWU6IGRhdGEucGF0TG9va3VwICYmIGRhdGEucGF0TG9va3VwW3N0YXRlXSA/IGRhdGEucGF0TG9va3VwW3N0YXRlXSA6IHN0YXRlXHJcbiAgICAgICAgfTtcclxuICAgICAgfSlcclxuICAgIH0pO1xyXG5cclxuICAgIHN0YXRlcy5pbml0aWFsaXplKHRydWUpO1xyXG5cclxuICAgICQoJyNzZWFyY2gtYm94JykuZmluZCgnLnR5cGVhaGVhZCcpLnR5cGVhaGVhZCgnZGVzdHJveScpO1xyXG4gICAgJCgnI3NlYXJjaC1ib3gnKS5maW5kKCcudHlwZWFoZWFkJykudHlwZWFoZWFkKHtcclxuICAgICAgICBoaW50OiB0cnVlLFxyXG4gICAgICAgIGhpZ2hsaWdodDogdHJ1ZSxcclxuICAgICAgICBtaW5MZW5ndGg6IDEsXHJcbiAgICAgICAgYXV0b3NlbGVjdDogdHJ1ZVxyXG4gICAgICB9LCB7XHJcbiAgICAgICAgbmFtZTogJ3BhdGllbnRzJyxcclxuICAgICAgICBkaXNwbGF5S2V5OiAndmFsdWUnLFxyXG4gICAgICAgIHNvdXJjZTogc3RhdGVzLnR0QWRhcHRlcigpLFxyXG4gICAgICAgIHRlbXBsYXRlczoge1xyXG4gICAgICAgICAgZW1wdHk6IFtcclxuICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImVtcHR5LW1lc3NhZ2VcIj4nLFxyXG4gICAgICAgICAgICAgICAgJyZuYnNwOyAmbmJzcDsgTm8gbWF0Y2hlcycsXHJcbiAgICAgICAgICAgICAgJzwvZGl2PidcclxuICAgICAgICAgICAgXS5qb2luKCdcXG4nKVxyXG4gICAgICAgIH1cclxuICAgICAgfSkub24oJ3R5cGVhaGVhZDpzZWxlY3RlZCcsIHBzLm9uU2VsZWN0ZWQpXHJcbiAgICAgIC5vbigndHlwZWFoZWFkOmF1dG9jb21wbGV0ZWQnLCBwcy5vblNlbGVjdGVkKTtcclxuXHJcbiAgICAkKCcjc2VhcmNoYnRuJykub24oJ21vdXNlZG93bicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgdmFsID0gJCgnLnR5cGVhaGVhZCcpLmVxKDApLnZhbCgpO1xyXG4gICAgICBpZiAoIXZhbCB8fCB2YWwgPT09IFwiXCIpIHZhbCA9ICQoJy50eXBlYWhlYWQnKS5lcSgxKS52YWwoKTtcclxuICAgICAgcHMub25TZWxlY3RlZChudWxsLCB7XHJcbiAgICAgICAgXCJpZFwiOiB2YWxcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICBvblNlbGVjdGVkOiBmdW5jdGlvbigkZSwgbmhzTnVtYmVyT2JqZWN0KSB7XHJcbiAgICAvL0hpZGUgdGhlIHN1Z2dlc3Rpb25zIHBhbmVsXHJcbiAgICAkKCcjc2VhcmNoLWJveCcpLmZpbmQoJy50dC1kcm9wZG93bi1tZW51JykuY3NzKCdkaXNwbGF5JywgJ25vbmUnKTtcclxuXHJcbiAgICBoaXN0b3J5LnB1c2hTdGF0ZShudWxsLCBudWxsLCAnI3BhdGllbnRzLycgKyBuaHNOdW1iZXJPYmplY3QuaWQpO1xyXG4gICAgbG9hZENvbnRGbignI3BhdGllbnRzLycgKyBuaHNOdW1iZXJPYmplY3QuaWQsIHRydWUpO1xyXG5cclxuICB9LFxyXG5cclxuICBzaG93OiBmdW5jdGlvbihwYW5lbCwgaXNBcHBlbmQsIGxvYWRDb250ZW50Rm4pIHtcclxuXHJcbiAgICBsb2FkQ29udEZuID0gbG9hZENvbnRlbnRGbjtcclxuICAgIHZhciB0ZW1wTXVzdCA9ICQoJyNwYXRpZW50LXNlYXJjaCcpLmh0bWwoKTtcclxuXHJcbiAgICBpZihpc0FwcGVuZCkgcGFuZWwuYXBwZW5kKE11c3RhY2hlLnJlbmRlcih0ZW1wTXVzdCkpO1xyXG4gICAgZWxzZSBwYW5lbC5odG1sKE11c3RhY2hlLnJlbmRlcih0ZW1wTXVzdCkpO1xyXG5cclxuICAgIHBzLndpcmVVcCgpO1xyXG4gIH1cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHBzO1xyXG4iLCJ2YXIgYmFzZSA9IHJlcXVpcmUoJy4uL2Jhc2UuanMnKSxcclxuICBkYXRhID0gcmVxdWlyZSgnLi4vZGF0YS5qcycpLFxyXG4gIGxvb2t1cCA9IHJlcXVpcmUoJy4uL2xvb2t1cC5qcycpLFxyXG4gIGNoYXJ0ID0gcmVxdWlyZSgnLi4vY2hhcnQuanMnKSxcclxuICBxdWFsaXR5U3RhbmRhcmQgPSByZXF1aXJlKCcuL3F1YWxpdHlTdGFuZGFyZC5qcycpLFxyXG4gIG90aGVyQ29kZXMgPSByZXF1aXJlKCcuL290aGVyQ29kZXMuanMnKSxcclxuICBtZWRpY2F0aW9uID0gcmVxdWlyZSgnLi9tZWRpY2F0aW9uLmpzJyksXHJcbiAgdHJlbmQgPSByZXF1aXJlKCcuL3RyZW5kLmpzJyksXHJcbiAgaW5kaXZpZHVhbEFjdGlvblBsYW4gPSByZXF1aXJlKCcuL2luZGl2aWR1YWxBY3Rpb25QbGFuLmpzJyksXHJcbiAgcGF0aWVudExpc3QgPSByZXF1aXJlKCcuL3BhdGllbnRMaXN0LmpzJyk7XHJcblxyXG52YXIgcHQgPSB7XHJcblxyXG4gIGNyZWF0ZTogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkKSB7XHJcbiAgICB2YXIgdGFiRGF0YSA9IFtdO1xyXG4gICAgZm9yICh2YXIga2V5IGluIGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkcykge1xyXG4gICAgICB0YWJEYXRhLnB1c2goe1xyXG4gICAgICAgIFwiaGVhZGVyXCI6IGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1trZXldLnRhYixcclxuICAgICAgICBcImFjdGl2ZVwiOiBrZXkgPT09IHN0YW5kYXJkLFxyXG4gICAgICAgIFwidXJsXCI6IHdpbmRvdy5sb2NhdGlvbi5oYXNoLnJlcGxhY2UoL1xcL25vLiovZywgJ1xcL25vLycgKyBrZXkpXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGJhc2UuY3JlYXRlUGFuZWwocGF0aWVudHNQYW5lbFRlbXBsYXRlLCB7XHJcbiAgICAgIFwicGF0aHdheVN0YWdlXCI6IHBhdGh3YXlTdGFnZSxcclxuICAgICAgXCJoZWFkZXJcIjogZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS5jaGFydFRpdGxlLFxyXG4gICAgICBcInRvb2x0aXBcIjogZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS50b29sdGlwLFxyXG4gICAgICBcInVybFwiOiB3aW5kb3cubG9jYXRpb24uaGFzaC5yZXBsYWNlKC9cXC95ZXMuKi9nLCAnJykucmVwbGFjZSgvXFwvbm8uKi9nLCAnJyksXHJcbiAgICAgIFwidGFic1wiOiB0YWJEYXRhLFxyXG4gICAgICBcInRleHRcIjogZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0udGV4dFxyXG4gICAgfSwge1xyXG4gICAgICBcImNvbnRlbnRcIjogJCgnI3BhdGllbnRzLXBhbmVsLW5vJykuaHRtbCgpLFxyXG4gICAgICBcInRhYi1oZWFkZXJcIjogJCgnI3BhdGllbnRzLXBhbmVsLW5vLXRhYnMnKS5odG1sKCksXHJcbiAgICAgIFwidGFiLWNvbnRlbnRcIjogJCgnI3BhdGllbnRzLXBhbmVsLW5vLXBhZ2UnKS5odG1sKClcclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIGNyZWF0ZU9rOiBmdW5jdGlvbihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSkge1xyXG4gICAgcmV0dXJuIGJhc2UuY3JlYXRlUGFuZWwocGF0aWVudHNQYW5lbFRlbXBsYXRlLCB7XHJcbiAgICAgIFwib2tcIjogdHJ1ZSxcclxuICAgICAgXCJwYXRod2F5U3RhZ2VcIjogcGF0aHdheVN0YWdlLFxyXG4gICAgICBcInVybFwiOiB3aW5kb3cubG9jYXRpb24uaGFzaC5yZXBsYWNlKC9cXC95ZXMvZywgJycpLnJlcGxhY2UoL1xcL25vL2csICcnKSxcclxuICAgICAgXCJ0ZXh0XCI6IGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnRleHRcclxuICAgIH0sIHtcclxuICAgICAgXCJjb250ZW50XCI6ICQoJyNwYXRpZW50cy1wYW5lbC15ZXMnKS5odG1sKClcclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIHdpcmVVcDogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIGxvY2F0aW9uLCBzdGFuZGFyZCkge1xyXG5cclxuICAgIHBhdGllbnRMaXN0LndpcmVVcChmdW5jdGlvbihwYXRpZW50SWQpe1xyXG4gICAgICAkKCdbZGF0YS10b2dnbGU9XCJ0b29sdGlwXCJdJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAkKHRoaXMpLnRvb2x0aXAoJ2Rlc3Ryb3knKTtcclxuICAgICAgYmFzZS5jbGVhckJveCgpO1xyXG4gICAgICAkKCcubGlzdC1pdGVtJykucmVtb3ZlQ2xhc3MoJ2hpZ2hsaWdodGVkJyk7XHJcbiAgICAgICQodGhpcykuYWRkQ2xhc3MoJ2hpZ2hsaWdodGVkJykucmVtb3ZlQXR0cihcInRpdGxlXCIpO1xyXG5cclxuICAgICAgcHQuc2hvd1BhdGh3YXlTdGFnZVBhdGllbnRWaWV3KHBhdGllbnRJZCwgcGF0aHdheUlkLCBzZWxlY3RlZCwgc3RhbmRhcmQpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcGF0aWVudHNQYW5lbCA9ICQoJyNwYXRpZW50cycpO1xyXG5cclxuICAgIGxvY2F0aW9uLm9mZignY2xpY2snLCAnI2JyZWFrZG93bi1jaGFydCcpO1xyXG4gICAgbG9jYXRpb24ub24oJ2NsaWNrJywgJyNicmVha2Rvd24tY2hhcnQnLCBmdW5jdGlvbigpIHtcclxuICAgICAgaWYgKCFsb29rdXAuY2hhcnRDbGlja2VkKSB7XHJcbiAgICAgICAgLypqc2hpbnQgdW51c2VkOiB0cnVlKi9cclxuICAgICAgICAkKCdwYXRoLmMzLWJhcicpLmF0dHIoJ2NsYXNzJywgZnVuY3Rpb24oaW5kZXgsIGNsYXNzTmFtZXMpIHtcclxuICAgICAgICAgIHJldHVybiBjbGFzc05hbWVzLnJlcGxhY2UoL191bnNlbGVjdGVkXy9nLCAnJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLypqc2hpbnQgdW51c2VkOiBmYWxzZSovXHJcblxyXG4gICAgICAgIGlmIChsb29rdXAuY2hhcnRzWydicmVha2Rvd24tY2hhcnQnXSkgbG9va3VwLmNoYXJ0c1snYnJlYWtkb3duLWNoYXJ0J10udW5zZWxlY3QoKTtcclxuXHJcbiAgICAgICAgcGF0aWVudExpc3QucG9wdWxhdGUocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBudWxsKTtcclxuICAgICAgICBkYXRhLnN1YnNlbGVjdGVkID0gbnVsbDtcclxuXHJcbiAgICAgICAgZmFyUmlnaHRQYW5lbC5mYWRlT3V0KDIwMCk7XHJcbiAgICAgIH1cclxuICAgICAgbG9va3VwLmNoYXJ0Q2xpY2tlZCA9IGZhbHNlO1xyXG4gICAgfSk7XHJcblxyXG4gICAgY2hhcnQuZGVzdHJveUNoYXJ0cyhbJ2JyZWFrZG93bi1jaGFydCddKTtcclxuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgIGxvb2t1cC5jaGFydHNbJ2JyZWFrZG93bi1jaGFydCddID0gYzMuZ2VuZXJhdGUoe1xyXG4gICAgICAgIGJpbmR0bzogJyNicmVha2Rvd24tY2hhcnQnLFxyXG4gICAgICAgIHRvb2x0aXA6IHtcclxuICAgICAgICAgIGZvcm1hdDoge1xyXG4gICAgICAgICAgICBuYW1lOiBmdW5jdGlvbihuYW1lLCBhLCBiKSB7XHJcbiAgICAgICAgICAgICAgdmFyIHRleHQgPSBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLm9wcG9ydHVuaXRpZXNbbG9va3VwLmluZGV4XS5kZXNjO1xyXG4gICAgICAgICAgICAgIHZhciBodG1sID0gXCJcIjtcclxuICAgICAgICAgICAgICB3aGlsZSAodGV4dC5sZW5ndGggPiA0MCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRleHQuaW5kZXhPZignICcsIDQwKSA8IDApIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgaHRtbCArPSB0ZXh0LnN1YnN0cigwLCB0ZXh0LmluZGV4T2YoJyAnLCA0MCkpICsgJzxicj4nO1xyXG4gICAgICAgICAgICAgICAgdGV4dCA9IHRleHQuc3Vic3RyKHRleHQuaW5kZXhPZignICcsIDQwKSArIDEpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICBodG1sICs9IHRleHQ7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIGh0bWw7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbih2YWx1ZSwgcmF0aW8sIGlkLCBpbmRleCkge1xyXG4gICAgICAgICAgICAgIGxvb2t1cC5pbmRleCA9IGluZGV4O1xyXG4gICAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgY29sdW1uczogW1xyXG4gICAgICAgICAgICBbXCJQYXRpZW50c1wiXS5jb25jYXQoZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS5vcHBvcnR1bml0aWVzLm1hcChmdW5jdGlvbih2YWwpIHtcclxuICAgICAgICAgICAgICByZXR1cm4gdmFsLnBhdGllbnRzLmxlbmd0aDtcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgICBdLFxyXG4gICAgICAgICAgdHlwZTogJ2JhcicsXHJcbiAgICAgICAgICBsYWJlbHM6IHRydWUsXHJcbiAgICAgICAgICBjb2xvcjogZnVuY3Rpb24oY29sb3IsIGQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGxvb2t1cC5jb2xvcnNbZC5pbmRleF07XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgc2VsZWN0aW9uOiB7XHJcbiAgICAgICAgICAgIGVuYWJsZWQ6IHRydWVcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBvbmNsaWNrOiBmdW5jdGlvbihkKSB7XHJcbiAgICAgICAgICAgIGNoYXJ0LnNlbGVjdFBpZVNsaWNlKCdicmVha2Rvd24tY2hhcnQnLCBkKTtcclxuICAgICAgICAgICAgcGF0aWVudExpc3QucG9wdWxhdGUocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLm9wcG9ydHVuaXRpZXNbZC5pbmRleF0ubmFtZSk7XHJcbiAgICAgICAgICAgIGRhdGEuc3Vic2VsZWN0ZWQgPSBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLm9wcG9ydHVuaXRpZXNbZC5pbmRleF0ubmFtZTtcclxuXHJcbiAgICAgICAgICAgIC8vY29sb3VyIHRhYmxlIGFwcHJvcHJpYXRlbHkgLSBuZWVkIHRvIGFkZCBvcGFjaXR5XHJcbiAgICAgICAgICAgIHZhciBzbGljZUNvbG91ckhleCA9IGxvb2t1cC5jb2xvcnNbZC5pbmRleF07XHJcbiAgICAgICAgICAgIHZhciBzaG9ydGhhbmRSZWdleCA9IC9eIz8oW2EtZlxcZF0pKFthLWZcXGRdKShbYS1mXFxkXSkkL2k7XHJcbiAgICAgICAgICAgIHNsaWNlQ29sb3VySGV4ID0gc2xpY2VDb2xvdXJIZXgucmVwbGFjZShzaG9ydGhhbmRSZWdleCwgZnVuY3Rpb24obSwgciwgZywgYikge1xyXG4gICAgICAgICAgICAgIHJldHVybiByICsgciArIGcgKyBnICsgYiArIGI7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gL14jPyhbYS1mXFxkXXsyfSkoW2EtZlxcZF17Mn0pKFthLWZcXGRdezJ9KSQvaS5leGVjKHNsaWNlQ29sb3VySGV4KTtcclxuICAgICAgICAgICAgdmFyIG9wYWNpdHkgPSAwLjI7XHJcbiAgICAgICAgICAgIHZhciBzbGljZUNvbG91ciA9ICdyZ2JhKCcgKyBwYXJzZUludChyZXN1bHRbMV0sIDE2KSArICcsJyArIHBhcnNlSW50KHJlc3VsdFsyXSwgMTYpICsgJywnICsgcGFyc2VJbnQocmVzdWx0WzNdLCAxNikgKyAnLCcgKyBvcGFjaXR5ICsgJyknO1xyXG5cclxuICAgICAgICAgICAgJCgnLnRhYmxlLnBhdGllbnQtbGlzdC50YWJsZS1oZWFkLWhpZGRlbicpLmNzcyh7XHJcbiAgICAgICAgICAgICAgXCJiYWNrZ3JvdW5kQ29sb3JcIjogc2xpY2VDb2xvdXJcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBiYXI6IHtcclxuICAgICAgICAgIHdpZHRoOiB7XHJcbiAgICAgICAgICAgIHJhdGlvOiAwLjVcclxuICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIGxlZ2VuZDoge1xyXG4gICAgICAgICAgc2hvdzogZmFsc2VcclxuICAgICAgICB9LFxyXG4gICAgICAgIGdyaWQ6IHtcclxuICAgICAgICAgIGZvY3VzOiB7XHJcbiAgICAgICAgICAgIHNob3c6IGZhbHNlXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBheGlzOiB7XHJcbiAgICAgICAgICB4OiB7XHJcbiAgICAgICAgICAgIHR5cGU6ICdjYXRlZ29yeScsXHJcbiAgICAgICAgICAgIGNhdGVnb3JpZXM6IGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0ub3Bwb3J0dW5pdGllcy5tYXAoZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIHZhbC5uYW1lO1xyXG4gICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgbGFiZWw6IGZhbHNlXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgeToge1xyXG4gICAgICAgICAgICBsYWJlbDoge1xyXG4gICAgICAgICAgICAgIHRleHQ6ICdQYXRpZW50IGNvdW50IChuKScsXHJcbiAgICAgICAgICAgICAgcG9zaXRpb246ICdvdXRlci1taWRkbGUnXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSwgMSk7XHJcbiAgfSxcclxuXHJcbiAgd2lyZVVwT2s6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBsb2NhdGlvbikge1xyXG4gICAgcGF0aWVudHNQYW5lbCA9ICQoJyNwYXRpZW50cycpO1xyXG5cclxuICAgIHBhdGllbnRzUGFuZWwub24oJ2NsaWNrJywgJ3RoZWFkIHRyIHRoLnNvcnRhYmxlJywgZnVuY3Rpb24oKSB7IC8vU29ydCBjb2x1bW5zIHdoZW4gY29sdW1uIGhlYWRlciBjbGlja2VkXHJcbiAgICAgIHZhciBzb3J0QXNjID0gISQodGhpcykuaGFzQ2xhc3MoJ3NvcnQtYXNjJyk7XHJcbiAgICAgIGlmIChzb3J0QXNjKSB7XHJcbiAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcygnc29ydC1kZXNjJykuYWRkQ2xhc3MoJ3NvcnQtYXNjJyk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcygnc29ydC1hc2MnKS5hZGRDbGFzcygnc29ydC1kZXNjJyk7XHJcbiAgICAgIH1cclxuICAgICAgcHQucG9wdWxhdGVPayhwYXRod2F5SWQsIGRhdGEuc2VsZWN0ZWQsIGRhdGEuc3Vic2VsZWN0ZWQsICQodGhpcykuaW5kZXgoKSwgc29ydEFzYyk7XHJcbiAgICB9KS5vbignY2xpY2snLCAndGJvZHkgdHInLCBmdW5jdGlvbihlKSB7IC8vU2VsZWN0IGluZGl2aWR1YWwgcGF0aWVudCB3aGVuIHJvdyBjbGlja2VkXHJcbiAgICAgICQoJ1tkYXRhLXRvZ2dsZT1cInRvb2x0aXBcIl0nKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgICQodGhpcykudG9vbHRpcCgnZGVzdHJveScpO1xyXG4gICAgICBiYXNlLmNsZWFyQm94KCk7XHJcbiAgICAgICQoJy5saXN0LWl0ZW0nKS5yZW1vdmVDbGFzcygnaGlnaGxpZ2h0ZWQnKTtcclxuICAgICAgJCh0aGlzKS5hZGRDbGFzcygnaGlnaGxpZ2h0ZWQnKS5yZW1vdmVBdHRyKCd0aXRsZScpO1xyXG5cclxuICAgICAgdmFyIHBhdGllbnRJZCA9ICQodGhpcykuZmluZCgndGQgYnV0dG9uJykuYXR0cignZGF0YS1wYXRpZW50LWlkJyk7XHJcblxyXG4gICAgICBwdC5zaG93UGF0aHdheVN0YWdlUGF0aWVudFZpZXcocGF0aWVudElkLCBwYXRod2F5SWQsIGRhdGEuc2VsZWN0ZWQsIG51bGwpO1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICB9KS5vbignY2xpY2snLCAndGJvZHkgdHIgYnV0dG9uJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAvL2Rvbid0IHdhbnQgcm93IHNlbGVjdGVkIGlmIGp1c3QgYnV0dG9uIHByZXNzZWQ/XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRhdGEuc2VsZWN0ZWQgPSBwYXRod2F5U3RhZ2U7XHJcbiAgICBkYXRhLnN1YnNlbGVjdGVkID0gbnVsbDtcclxuICB9LFxyXG5cclxuICBwb3B1bGF0ZU9rOiBmdW5jdGlvbihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3Vic2VjdGlvbiwgc29ydEZpZWxkLCBzb3J0QXNjKSB7XHJcbiAgICB2YXIgcExpc3QgPSBbXSxcclxuICAgICAgaSwgaywgcHJvcCwgaGVhZGVyLCB0b29sdGlwO1xyXG4gICAgcGF0aWVudHNQYW5lbC5mYWRlT3V0KDIwMCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICQodGhpcykuZmFkZUluKDIwMCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBwTGlzdCA9IGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnBhdGllbnRzT2s7XHJcbiAgICBoZWFkZXIgPSBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS50ZXh0LnBhbmVsT2tIZWFkZXIudGV4dDtcclxuICAgIHRvb2x0aXAgPSBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS50ZXh0LnBhbmVsT2tIZWFkZXIudG9vbHRpcDtcclxuXHJcbiAgICBwTGlzdCA9IGRhdGEucmVtb3ZlRHVwbGljYXRlcyhwTGlzdCk7XHJcbiAgICB2YXIgcGF0aWVudHMgPSBwTGlzdC5tYXAoZnVuY3Rpb24ocGF0aWVudElkKSB7XHJcbiAgICAgIHZhciByZXQgPSBkYXRhLnBhdGllbnRzW3BhdGllbnRJZF07XHJcbiAgICAgIHJldC5uaHNOdW1iZXIgPSBkYXRhLnBhdExvb2t1cCA/IGRhdGEucGF0TG9va3VwW3BhdGllbnRJZF0gOiBwYXRpZW50SWQ7XHJcbiAgICAgIHJldC5wYXRpZW50SWQgPSBwYXRpZW50SWQ7XHJcbiAgICAgIHJldC5pdGVtcyA9IFtdOyAvL1RoZSBmaWVsZHMgaW4gdGhlIHBhdGllbnQgbGlzdCB0YWJsZVxyXG4gICAgICByZXQuaXRlbXMucHVzaChkYXRhLnBhdGllbnRzW3BhdGllbnRJZF0uYnJlYWNoID8gZGF0YS5udW1iZXJPZlN0YW5kYXJkc01pc3NlZChwYXRpZW50SWQpIDogMCk7XHJcbiAgICAgIHJldHVybiByZXQ7XHJcbiAgICB9KTtcclxuICAgIHZhciBsb2NhbERhdGEgPSB7XHJcbiAgICAgIFwicGF0aWVudHNcIjogcGF0aWVudHMsXHJcbiAgICAgIFwiblwiOiBwYXRpZW50cy5sZW5ndGgsXHJcbiAgICAgIFwiaGVhZGVyXCI6IGhlYWRlcixcclxuICAgICAgXCJ0b29sdGlwXCI6IHRvb2x0aXAsXHJcbiAgICAgIFwiaGVhZGVyLWl0ZW1zXCI6IFt7XHJcbiAgICAgICAgXCJ0aXRsZVwiOiBcIk5IUyBuby5cIixcclxuICAgICAgICBcImlzU29ydGVkXCI6IGZhbHNlLFxyXG4gICAgICAgIFwiZGlyZWN0aW9uXCI6IFwic29ydC1hc2NcIlxyXG4gICAgICB9LCB7XHJcbiAgICAgICAgXCJ0aXRsZVwiOiBcIkFsbCBPcHBvcnR1bml0aWVzXCIsXHJcbiAgICAgICAgXCJ0aXRsZUhUTUxcIjogJyMgb2YgPGkgY2xhc3M9XCJmYSBmYS1mbGFnXCIgc3R5bGU9XCJjb2xvcjpyZWRcIj48L2k+JyxcclxuICAgICAgICBcImlzU29ydGVkXCI6IHRydWUsXHJcbiAgICAgICAgXCJkaXJlY3Rpb25cIjogXCJzb3J0LWRlc2NcIixcclxuICAgICAgICBcInRvb2x0aXBcIjogXCJUb3RhbCBudW1iZXIgb2YgaW1wcm92ZW1lbnQgb3Bwb3J0dW5pdGllcyBhdmFpbGFibGUgYWNyb3NzIGFsbCBjb25kaXRpb25zXCJcclxuICAgICAgfV1cclxuICAgIH07XHJcblxyXG4gICAgaWYgKHNvcnRGaWVsZCA9PT0gdW5kZWZpbmVkKSBzb3J0RmllbGQgPSAxO1xyXG5cclxuICAgIGxvY2FsRGF0YS5wYXRpZW50cy5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcclxuICAgICAgaWYgKHNvcnRGaWVsZCA9PT0gMCkgeyAvL05IUyBudW1iZXJcclxuICAgICAgICBpZiAoYS5uaHNOdW1iZXIgPT09IGIubmhzTnVtYmVyKSB7XHJcbiAgICAgICAgICByZXR1cm4gMDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChhLm5oc051bWJlciA+IGIubmhzTnVtYmVyKSB7XHJcbiAgICAgICAgICByZXR1cm4gc29ydEFzYyA/IDEgOiAtMTtcclxuICAgICAgICB9IGVsc2UgaWYgKGEubmhzTnVtYmVyIDwgYi5uaHNOdW1iZXIpIHtcclxuICAgICAgICAgIHJldHVybiBzb3J0QXNjID8gLTEgOiAxO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBpZiAoYS5pdGVtc1tzb3J0RmllbGQgLSAxXSA9PT0gYi5pdGVtc1tzb3J0RmllbGQgLSAxXSkge1xyXG4gICAgICAgICAgcmV0dXJuIDA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgQSA9IE51bWJlcihhLml0ZW1zW3NvcnRGaWVsZCAtIDFdKTtcclxuICAgICAgICB2YXIgQiA9IE51bWJlcihiLml0ZW1zW3NvcnRGaWVsZCAtIDFdKTtcclxuICAgICAgICBpZiAoaXNOYU4oQSkgfHwgaXNOYU4oQikpIHtcclxuICAgICAgICAgIEEgPSBhLml0ZW1zW3NvcnRGaWVsZCAtIDFdO1xyXG4gICAgICAgICAgQiA9IGIuaXRlbXNbc29ydEZpZWxkIC0gMV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChBID4gQikge1xyXG4gICAgICAgICAgcmV0dXJuIHNvcnRBc2MgPyAxIDogLTE7XHJcbiAgICAgICAgfSBlbHNlIGlmIChBIDwgQikge1xyXG4gICAgICAgICAgcmV0dXJuIHNvcnRBc2MgPyAtMSA6IDE7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBmb3IgKGkgPSAwOyBpIDwgbG9jYWxEYXRhW1wiaGVhZGVyLWl0ZW1zXCJdLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIGlmIChpID09PSBzb3J0RmllbGQpIHtcclxuICAgICAgICBsb2NhbERhdGFbXCJoZWFkZXItaXRlbXNcIl1baV0uZGlyZWN0aW9uID0gc29ydEFzYyA/IFwic29ydC1hc2NcIiA6IFwic29ydC1kZXNjXCI7XHJcbiAgICAgICAgbG9jYWxEYXRhW1wiaGVhZGVyLWl0ZW1zXCJdW2ldLmlzQXNjID0gc29ydEFzYztcclxuICAgICAgICBsb2NhbERhdGFbXCJoZWFkZXItaXRlbXNcIl1baV0uaXNTb3J0ZWQgPSB0cnVlO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGxvY2FsRGF0YVtcImhlYWRlci1pdGVtc1wiXVtpXS5pc1NvcnRlZCA9IGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuICAgIGJhc2UuY3JlYXRlUGFuZWxTaG93KHBhdGllbnRMaXN0LCBwYXRpZW50c1BhbmVsLCBsb2NhbERhdGEsIHtcclxuICAgICAgXCJoZWFkZXItaXRlbVwiOiAkKFwiI3BhdGllbnQtbGlzdC1oZWFkZXItaXRlbVwiKS5odG1sKCksXHJcbiAgICAgIFwiaXRlbVwiOiAkKCcjcGF0aWVudC1saXN0LWl0ZW0nKS5odG1sKClcclxuICAgIH0pO1xyXG5cclxuICAgICQoJyNwYXRpZW50cy1wbGFjZWhvbGRlcicpLmhpZGUoKTtcclxuXHJcbiAgICBiYXNlLnNldHVwQ2xpcGJvYXJkKCQoJy5idG4tY29weScpLCB0cnVlKTtcclxuXHJcbiAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcblxyXG4gICAgdmFyIGMgPSBwYXRpZW50c1BhbmVsLmZpbmQoJ2Rpdi50YWJsZS1zY3JvbGwnKS5nZXROaWNlU2Nyb2xsKCk7XHJcbiAgICBpZiAoYyAmJiBjLmxlbmd0aCA+IDApIHtcclxuICAgICAgYy5yZXNpemUoKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHBhdGllbnRzUGFuZWwuZmluZCgnZGl2LnRhYmxlLXNjcm9sbCcpLm5pY2VTY3JvbGwoe1xyXG4gICAgICAgIGN1cnNvcm9wYWNpdHltaW46IDAuMyxcclxuICAgICAgICBjdXJzb3J3aWR0aDogXCI3cHhcIixcclxuICAgICAgICBob3JpenJhaWxlbmFibGVkOiBmYWxzZVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9LFxyXG5cclxuICAvL1Nob3cgcGF0aWVudCB2aWV3IHdpdGhpbiB0aGUgcGF0aHdheSBzdGFnZSB2aWV3XHJcbiAgc2hvd1BhdGh3YXlTdGFnZVBhdGllbnRWaWV3OiBmdW5jdGlvbihwYXRpZW50SWQsIHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCkge1xyXG4gICAgZGF0YS5wYXRpZW50SWQgPSBwYXRpZW50SWQ7XHJcblxyXG4gICAgYmFzZS5zd2l0Y2hUbzExMExheW91dCgpO1xyXG5cclxuICAgIHB0LnNob3dJbmRpdmlkdWFsUGF0aWVudFBhbmVsKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICB9LFxyXG5cclxuICBzaG93SW5kaXZpZHVhbFBhdGllbnRQYW5lbDogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpIHtcclxuICAgIHZhciBzdGFuID0gZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXSA/IGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0udGFiLnRpdGxlIDogXCJVTlNQRUNJRklFRFwiO1xyXG5cclxuICAgIGRhdGEub3B0aW9ucy5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcclxuICAgICAgYSA9IGRhdGEuZ2V0UGF0aWVudFN0YXR1cyhwYXRpZW50SWQsIGEucGF0aHdheUlkLCBhLnBhdGh3YXlTdGFnZSwgYS5zdGFuZGFyZCk7XHJcbiAgICAgIGIgPSBkYXRhLmdldFBhdGllbnRTdGF0dXMocGF0aWVudElkLCBiLnBhdGh3YXlJZCwgYi5wYXRod2F5U3RhZ2UsIGIuc3RhbmRhcmQpO1xyXG5cclxuICAgICAgaWYgKGEgPT09IGIpIHJldHVybiAwO1xyXG4gICAgICBpZiAoYSA9PT0gXCJub3RcIikgcmV0dXJuIDE7XHJcbiAgICAgIGlmIChiID09PSBcIm5vdFwiKSByZXR1cm4gLTE7XHJcbiAgICAgIGlmIChhID09PSBcIm9rXCIpIHJldHVybiAxO1xyXG4gICAgICBpZiAoYiA9PT0gXCJva1wiKSByZXR1cm4gLTE7XHJcbiAgICAgIGFsZXJ0KFwiISEhISEhIVwiKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHZhciBwYW5lbCA9IGJhc2UuY3JlYXRlUGFuZWwoJCgnI3BhdGllbnQtcGFuZWwnKSwge1xyXG4gICAgICBcIm9wdGlvbnNcIjogZGF0YS5vcHRpb25zLFxyXG4gICAgICBcIm51bWJlck9mU3RhbmRhcmRzTWlzc2VkXCI6IGRhdGEubnVtYmVyT2ZTdGFuZGFyZHNNaXNzZWQocGF0aWVudElkKSxcclxuICAgICAgXCJzdGFuZGFyZFwiOiBzdGFuLFxyXG4gICAgICBcInBhdGh3YXlTdGFnZVwiOiBwYXRod2F5U3RhZ2UsXHJcbiAgICAgIFwibmhzTnVtYmVyXCI6IGRhdGEucGF0TG9va3VwID8gZGF0YS5wYXRMb29rdXBbcGF0aWVudElkXSA6IHBhdGllbnRJZCxcclxuICAgICAgXCJwYXRpZW50SWRcIjogcGF0aWVudElkXHJcbiAgICB9LCB7XHJcbiAgICAgIFwib3B0aW9uXCI6ICQoJyNwYXRpZW50LXBhbmVsLWRyb3AtZG93bi1vcHRpb25zJykuaHRtbCgpXHJcbiAgICB9KTtcclxuXHJcbiAgICBpZiAoc3RhbmRhcmQgPT09IG51bGwpIHtcclxuICAgICAgLy9NdXN0IGJlIGEgcGF0aWVudCBmcm9tIHRoZSAqKiogT0sgZ3JvdXBcclxuICAgICAgc3RhbmRhcmQgPSBkYXRhLm9wdGlvbnMuZmlsdGVyKGZ1bmN0aW9uKHZhbCkge1xyXG4gICAgICAgIHJldHVybiB2YWwucGF0aHdheUlkID09PSBwYXRod2F5SWQgJiYgdmFsLnBhdGh3YXlTdGFnZSA9PT0gcGF0aHdheVN0YWdlO1xyXG4gICAgICB9KVswXS5zdGFuZGFyZDtcclxuICAgIH1cclxuXHJcbiAgICBmYXJSaWdodFBhbmVsLmh0bWwoXCJcIik7XHJcbiAgICAkKCcjdGVtcC1oaWRkZW4nKS5odG1sKHBhbmVsKTtcclxuXHJcbiAgICB2YXIgYWN0aW9uUGxhbiA9IGluZGl2aWR1YWxBY3Rpb25QbGFuLmNyZWF0ZShwYXRod2F5U3RhZ2UpO1xyXG4gICAgJCgnI3RlbXAtaGlkZGVuICNwYXRpZW50LXBhbmVsLXJpZ2h0JykuaHRtbChhY3Rpb25QbGFuKTtcclxuXHJcbiAgICB2YXIgcXVhbFBhbmVsID0gcXVhbGl0eVN0YW5kYXJkLmNyZWF0ZShwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcbiAgICB2YXIgdHJlbmRQYW5lbCA9IHRyZW5kLmNyZWF0ZShwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcbiAgICB2YXIgbWVkUGFuZWwgPSBtZWRpY2F0aW9uLmNyZWF0ZShwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcbiAgICB2YXIgY29kZXNQYW5lbCA9IG90aGVyQ29kZXMuY3JlYXRlKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgIHZhciBtZWRDb2RlV3JhcHBlclBhbmVsID0gYmFzZS5jcmVhdGVQYW5lbCgkKCcjb3RoZXItY29kZXMtYW5kLW1lZHMtd3JhcHBlci1wYW5lbCcpKTtcclxuICAgICQoJyN0ZW1wLWhpZGRlbiAjcGF0aWVudC1wYW5lbC10b3AnKS5odG1sKHF1YWxQYW5lbCk7XHJcbiAgICAkKCcjdGVtcC1oaWRkZW4gI3BhdGllbnQtcGFuZWwtbGVmdCcpLmh0bWwoXCJcIikuYXBwZW5kKHRyZW5kUGFuZWwpLmFwcGVuZChtZWRDb2RlV3JhcHBlclBhbmVsKTtcclxuICAgICQoJyN0ZW1wLWhpZGRlbiAjbWVkQ29kZVdyYXBwZXJQYW5lbCcpLmFwcGVuZChtZWRQYW5lbCkuYXBwZW5kKGNvZGVzUGFuZWwpO1xyXG5cclxuICAgIGlmIChmYXJSaWdodFBhbmVsLmlzKCc6dmlzaWJsZScpKSB7XHJcbiAgICAgIGZhclJpZ2h0UGFuZWwuZmFkZU91dCg1MDAsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICQodGhpcykuaHRtbCgkKCcjdGVtcC1oaWRkZW4nKS5odG1sKCkpO1xyXG4gICAgICAgICQoJyN0ZW1wLWhpZGRlbicpLmh0bWwoXCJcIik7XHJcbiAgICAgICAgaW5kaXZpZHVhbEFjdGlvblBsYW4ud2lyZVVwKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgICAgICBxdWFsaXR5U3RhbmRhcmQud2lyZVVwKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgICAgICBiYXNlLndpcmVVcFN0YW5kYXJkRHJvcERvd24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwdC5zaG93SW5kaXZpZHVhbFBhdGllbnRQYW5lbCk7XHJcbiAgICAgICAgdHJlbmQud2lyZVVwKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgICAgICBtZWRpY2F0aW9uLndpcmVVcChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcbiAgICAgICAgb3RoZXJDb2Rlcy53aXJlVXAocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gICAgICAgIGNoYXJ0LmRyYXdUcmVuZENoYXJ0KHBhdGllbnRJZCwgcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkKTtcclxuICAgICAgICAkKHRoaXMpLmZhZGVJbig1MDAsIGZ1bmN0aW9uKCkge30pO1xyXG4gICAgICB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGZhclJpZ2h0UGFuZWwuaHRtbCgkKCcjdGVtcC1oaWRkZW4nKS5odG1sKCkpO1xyXG4gICAgICAkKCcjdGVtcC1oaWRkZW4nKS5odG1sKFwiXCIpO1xyXG4gICAgICBpbmRpdmlkdWFsQWN0aW9uUGxhbi53aXJlVXAocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gICAgICBxdWFsaXR5U3RhbmRhcmQud2lyZVVwKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgICAgYmFzZS53aXJlVXBTdGFuZGFyZERyb3BEb3duKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcHQuc2hvd0luZGl2aWR1YWxQYXRpZW50UGFuZWwpO1xyXG4gICAgICB0cmVuZC53aXJlVXAocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gICAgICBtZWRpY2F0aW9uLndpcmVVcChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcbiAgICAgIG90aGVyQ29kZXMud2lyZVVwKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgICAgY2hhcnQuZHJhd1RyZW5kQ2hhcnQocGF0aWVudElkLCBwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQpO1xyXG4gICAgICBmYXJSaWdodFBhbmVsLmZhZGVJbig1MDAsIGZ1bmN0aW9uKCkge30pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHB0O1xyXG4iLCJ2YXIgYmFzZSA9IHJlcXVpcmUoJy4uL2Jhc2UuanMnKSxcclxuICBkYXRhID0gcmVxdWlyZSgnLi4vZGF0YS5qcycpLFxyXG4gIGxvZyA9IHJlcXVpcmUoJy4uL2xvZy5qcycpLFxyXG4gIGNvbmZpcm0gPSByZXF1aXJlKCcuL2NvbmZpcm0uanMnKTtcclxuXHJcbnZhciBJRCA9IFwiUVVBTElUWVNUQU5EQVJEXCI7XHJcblxyXG52YXIgcXMgPSB7XHJcblxyXG4gIGNyZWF0ZTogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpIHtcclxuXHJcbiAgICB2YXIgbG9jYWxEYXRhID0ge1xyXG4gICAgICBcIm5oc051bWJlclwiOiBkYXRhLnBhdExvb2t1cCA/IGRhdGEucGF0TG9va3VwW3BhdGllbnRJZF0gOiBwYXRpZW50SWQsXHJcbiAgICAgIFwicGF0aWVudElkXCI6IHBhdGllbnRJZFxyXG4gICAgfTtcclxuICAgIGxvY2FsRGF0YS5zdGFuZGFyZCA9IGRhdGEucGF0aHdheU5hbWVzW3BhdGh3YXlJZF0gKyAnIC0gJyArIHBhdGh3YXlTdGFnZTtcclxuICAgIGlmIChkYXRhLnBhdGllbnRzW3BhdGllbnRJZF0uc3RhbmRhcmRzICYmIGRhdGEucGF0aWVudHNbcGF0aWVudElkXS5zdGFuZGFyZHNbcGF0aHdheUlkXSAmJlxyXG4gICAgICBkYXRhLnBhdGllbnRzW3BhdGllbnRJZF0uc3RhbmRhcmRzW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXSAmJlxyXG4gICAgICBkYXRhLnBhdGllbnRzW3BhdGllbnRJZF0uc3RhbmRhcmRzW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXVtzdGFuZGFyZF0pIHtcclxuICAgICAgbG9jYWxEYXRhLnN0YW5kYXJkID0gZGF0YS5wYXRpZW50c1twYXRpZW50SWRdLnN0YW5kYXJkc1twYXRod2F5SWRdW3BhdGh3YXlTdGFnZV1bc3RhbmRhcmRdO1xyXG4gICAgfVxyXG5cclxuICAgIGxvY2FsRGF0YS50b29sdGlwID0gZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXVtcInN0YW5kYXJkLW1ldC10b29sdGlwXCJdO1xyXG5cclxuICAgIHN3aXRjaCAoZGF0YS5nZXRQYXRpZW50U3RhdHVzKHBhdGllbnRJZCwgcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkKSkge1xyXG4gICAgICBjYXNlIFwib2tcIjpcclxuICAgICAgICAvLy8vZmFyUmlnaHRQYW5lbC5yZW1vdmVDbGFzcygnc3RhbmRhcmQtbWlzc2VkLXBhZ2UnKS5hZGRDbGFzcygnc3RhbmRhcmQtYWNoaWV2ZWQtcGFnZScpLnJlbW92ZUNsYXNzKCdzdGFuZGFyZC1ub3QtcmVsZXZhbnQtcGFnZScpO1xyXG4gICAgICAgIGxvY2FsRGF0YS5hY2hpZXZlZCA9IHRydWU7XHJcbiAgICAgICAgbG9jYWxEYXRhLnJlbGV2YW50ID0gdHJ1ZTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBcIm1pc3NlZFwiOlxyXG4gICAgICAgIC8vLy9mYXJSaWdodFBhbmVsLmFkZENsYXNzKCdzdGFuZGFyZC1taXNzZWQtcGFnZScpLnJlbW92ZUNsYXNzKCdzdGFuZGFyZC1hY2hpZXZlZC1wYWdlJykucmVtb3ZlQ2xhc3MoJ3N0YW5kYXJkLW5vdC1yZWxldmFudC1wYWdlJyk7XHJcbiAgICAgICAgbG9jYWxEYXRhLnJlbGV2YW50ID0gdHJ1ZTtcclxuICAgICAgICBsb2NhbERhdGEuYWNoaWV2ZWQgPSBmYWxzZTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBcIm5vdFwiOlxyXG4gICAgICAgIC8vLy9mYXJSaWdodFBhbmVsLnJlbW92ZUNsYXNzKCdzdGFuZGFyZC1taXNzZWQtcGFnZScpLnJlbW92ZUNsYXNzKCdzdGFuZGFyZC1hY2hpZXZlZC1wYWdlJykuYWRkQ2xhc3MoJ3N0YW5kYXJkLW5vdC1yZWxldmFudC1wYWdlJyk7XHJcbiAgICAgICAgbG9jYWxEYXRhLnJlbGV2YW50ID0gZmFsc2U7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIGFnT2JqID0gbG9nLmdldFBhdGllbnRBZ3JlZU9iamVjdChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCwgXCJzdGFuZGFyZFwiKTtcclxuICAgIGlmIChhZ09iaiAmJiBhZ09iai5hZ3JlZSkgbG9jYWxEYXRhLmFncmVlID0gdHJ1ZTtcclxuICAgIGVsc2UgaWYgKGFnT2JqICYmIGFnT2JqLmFncmVlID09PSBmYWxzZSkgbG9jYWxEYXRhLmRpc2FncmVlID0gdHJ1ZTtcclxuXHJcbiAgICByZXR1cm4gYmFzZS5jcmVhdGVQYW5lbCgkKCcjcXVhbC1zdGFuZGFyZCcpLCBsb2NhbERhdGEpO1xyXG4gIH0sXHJcblxyXG4gIHNob3c6IGZ1bmN0aW9uKHBhbmVsLCBwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCl7XHJcblxyXG4gICAgdmFyIHBhbmVsSWQgPSBwYW5lbC5hdHRyKFwiaWRcIik7XHJcblxyXG4gICAgaWYgKGJhc2UucGFuZWxzW3BhbmVsSWRdICYmXHJcbiAgICAgIGJhc2UucGFuZWxzW3BhbmVsSWRdLmlkID09PSBJRCAmJlxyXG4gICAgICBiYXNlLnBhbmVsc1twYW5lbElkXS5wYXRpZW50SWQgPT09IHBhdGllbnRJZCkge1xyXG4gICAgICAgIC8vQWxyZWFkeSBzaG93aW5nIHRoZSByaWdodCB0aGluZ1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBiYXNlLnBhbmVsc1twYW5lbElkXSA9IHtcclxuICAgICAgaWQ6IElELFxyXG4gICAgICBwYXRpZW50SWQ6IHBhdGllbnRJZFxyXG4gICAgfTtcclxuXHJcbiAgICBwYW5lbC5odG1sKHFzLmNyZWF0ZShwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCkpO1xyXG4gICAgcXMud2lyZVVwKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICB9LFxyXG5cclxuICB3aXJlVXA6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKSB7XHJcbiAgICBjb25maXJtLndpcmVVcCgkKCcjcXVhbC1hZ3JlZS1kaXNhZ3JlZScpLCAkKCcjaW5kaXZpZHVhbC1wYW5lbC1jbGFzc2lmaWNhdGlvbicpLCBwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCwgXCJzdGFuZGFyZFwiLCBcInF1YWxpdHkgc3RhbmRhcmRcIik7XHJcbiAgfSxcclxuXHJcbiAgdXBkYXRlOiBmdW5jdGlvbigpIHtcclxuICAgICQoJyNpbmRpdmlkdWFsLXBhbmVsLWNsYXNzaWZpY2F0aW9uJykuZmluZCgnZGl2JykuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIHNlbGYgPSAkKHRoaXMpO1xyXG4gICAgICB2YXIgYW55ID0gZmFsc2U7XHJcbiAgICAgIHNlbGYuZmluZCgnLmJ0bi10b2dnbGUgaW5wdXRbdHlwZT1jaGVja2JveF06Y2hlY2tlZCcpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIGlzQ2xhc3NpZmljYXRpb24gPSAkKHRoaXMpLmNsb3Nlc3QoXCJkaXZcIikuZGF0YShcImlzQ2xhc3NpZmljYXRpb25cIikgIT09IHVuZGVmaW5lZDtcclxuICAgICAgICBhbnkgPSB0cnVlO1xyXG4gICAgICAgIHZhciBpdGVtID0gbG9nLmdldEFncmVlcygpW2RhdGEucGF0aWVudElkXS5maWx0ZXIoZnVuY3Rpb24oaSkge1xyXG4gICAgICAgICAgcmV0dXJuIGlzQ2xhc3NpZmljYXRpb24gPyBpLml0ZW0gPT09IFwic2VjdGlvblwiIDogaS5pdGVtICE9PSBcInNlY3Rpb25cIjtcclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgdG9vbDtcclxuICAgICAgICBpZiAodGhpcy52YWx1ZSA9PT0gXCJ5ZXNcIikge1xyXG4gICAgICAgICAgaWYgKGl0ZW0gJiYgaXRlbVswXS5oaXN0b3J5KSB7XHJcbiAgICAgICAgICAgIHRvb2wgPSBcIjxwPlwiICsgaXRlbVswXS5oaXN0b3J5WzBdICsgXCI8L3A+PHA+Q2xpY2sgYWdhaW4gdG8gY2FuY2VsPC9wPlwiO1xyXG4gICAgICAgICAgICAkKHRoaXMpLnBhcmVudCgpLmF0dHIoXCJ0aXRsZVwiLCB0b29sKS5hdHRyKFwiZGF0YS1vcmlnaW5hbC10aXRsZVwiLCB0b29sKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICQodGhpcykucGFyZW50KCkuYXR0cihcInRpdGxlXCIsIFwiWW91IGFncmVlZCAtIGNsaWNrIGFnYWluIHRvIGNhbmNlbFwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgaWYgKGl0ZW0gJiYgaXRlbVswXS5oaXN0b3J5KSB7XHJcbiAgICAgICAgICAgIHRvb2wgPSBcIjxwPlwiICsgaXRlbVswXS5oaXN0b3J5WzBdICsgXCI8L3A+PHA+Q2xpY2sgYWdhaW4gdG8gZWRpdC9jYW5jZWw8L3A+XCI7XHJcbiAgICAgICAgICAgICQodGhpcykucGFyZW50KCkuYXR0cihcInRpdGxlXCIsIHRvb2wpLmF0dHIoXCJkYXRhLW9yaWdpbmFsLXRpdGxlXCIsIHRvb2wpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5hdHRyKFwidGl0bGVcIiwgXCJZb3UgZGlzYWdyZWVkIC0gY2xpY2sgYWdhaW4gdG8gZWRpdC9jYW5jZWxcIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGlmIChzZWxmLmZpbmQoJy5idG4tdG9nZ2xlIGlucHV0W3R5cGU9Y2hlY2tib3hdOm5vdCg6Y2hlY2tlZCknKS5sZW5ndGggPT0gMSkge1xyXG4gICAgICAgIHNlbGYuZmluZCgnLmJ0bi10b2dnbGUgaW5wdXRbdHlwZT1jaGVja2JveF06bm90KDpjaGVja2VkKScpLnBhcmVudCgpLmFkZENsYXNzKFwiaW5hY3RpdmVcIikuYXR0cihcInRpdGxlXCIsIFwiXCIpLmF0dHIoXCJkYXRhLW9yaWdpbmFsLXRpdGxlXCIsIFwiXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoIWFueSkge1xyXG4gICAgICAgIHNlbGYuZmluZCgnLmJ0bi10b2dnbGUuYnRuLXllcycpLmF0dHIoXCJ0aXRsZVwiLCBcIkNsaWNrIHRvIGFncmVlIHdpdGggdGhpcyBhY3Rpb24gYW5kIHNhdmUgaXQgaW4geW91ciBhZ3JlZWQgYWN0aW9ucyBsaXN0ICBcIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgICAgc2VsZi5maW5kKCcuYnRuLXRvZ2dsZS5idG4tbm8nKS5hdHRyKFwidGl0bGVcIiwgXCJDbGljayB0byBkaXNhZ3JlZSB3aXRoIHRoaXMgYWN0aW9uIGFuZCByZW1vdmUgaXQgZnJvbSB5b3VyIHN1Z2dlc3RlZCBhY3Rpb25zIGxpc3QgXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gcXM7XHJcbiIsInZhciBkYXRhID0gcmVxdWlyZSgnLi4vZGF0YS5qcycpLFxyXG4gIE11c3RhY2hlID0gcmVxdWlyZSgnbXVzdGFjaGUnKTtcclxuXHJcbnZhciBxcyA9IHtcclxuXHJcbiAgc2hvdzogZnVuY3Rpb24ocGFuZWwsIGlzQXBwZW5kLCBwYXRpZW50SWQpIHtcclxuXHJcbiAgICB2YXIgcGF0aWVudERhdGEgPSBkYXRhLmdldFBhdGllbnREYXRhKHBhdGllbnRJZCk7XHJcblxyXG4gICAgdmFyIHRlbXBNdXN0ID0gJCgnI3F1YWxpdHktc3RhbmRhcmQtcGFuZWwnKS5odG1sKCk7XHJcbiAgICB2YXIgaHRtbCA9IE11c3RhY2hlLnJlbmRlcih0ZW1wTXVzdCwge1xyXG4gICAgICBcInN0YW5kYXJkc1wiOiBwYXRpZW50RGF0YS5zdGFuZGFyZHNcclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChpc0FwcGVuZCkgcGFuZWwuYXBwZW5kKGh0bWwpO1xyXG4gICAgZWxzZSBwYW5lbC5odG1sKGh0bWwpO1xyXG5cclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBxcztcclxuIiwidmFyIGJhc2UgPSByZXF1aXJlKCcuLi9iYXNlLmpzJyksXHJcbiAgY29uZmlybSA9IHJlcXVpcmUoJy4vY29uZmlybS5qcycpLFxyXG4gIGRhdGEgPSByZXF1aXJlKCcuLi9kYXRhLmpzJyksXHJcbiAgbG9nID0gcmVxdWlyZSgnLi4vbG9nLmpzJyk7XHJcblxyXG52YXIgdGFwID0ge1xyXG5cclxuICBzaG93OiBmdW5jdGlvbihsb2NhdGlvbikge1xyXG4gICAgbG9jYXRpb24ucmVtb3ZlQ2xhc3MoJ3N0YW5kYXJkLW1pc3NlZC1wYWdlJykucmVtb3ZlQ2xhc3MoJ3N0YW5kYXJkLWFjaGlldmVkLXBhZ2UnKS5yZW1vdmVDbGFzcygnc3RhbmRhcmQtbm90LXJlbGV2YW50LXBhZ2UnKTtcclxuICAgIGJhc2UuY3JlYXRlUGFuZWxTaG93KCQoJyN0ZWFtLWFjdGlvbi1wbGFuLXBhbmVsJyksIGxvY2F0aW9uKTtcclxuXHJcbiAgICBzdWdnZXN0ZWRQbGFuVGVhbSA9ICQoJyNzdWdnZXN0ZWRQbGFuVGVhbScpO1xyXG5cclxuICAgIHN1Z2dlc3RlZFBsYW5UZWFtLm9uKCdjbGljaycsICcuY3Itc3R5bGVkIGlucHV0W3R5cGU9Y2hlY2tib3hdJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBBQ1RJT05JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKCdpZCcpO1xyXG4gICAgICBsb2cuZWRpdEFjdGlvbihcInRlYW1cIiwgQUNUSU9OSUQsIG51bGwsIHRoaXMuY2hlY2tlZCk7XHJcblxyXG4gICAgICBpZiAodGhpcy5jaGVja2VkKSB7XHJcbiAgICAgICAgbG9nLnJlY29yZEV2ZW50KGRhdGEucGF0aHdheUlkLCBcInRlYW1cIiwgXCJJdGVtIGNvbXBsZXRlZFwiKTtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgJChzZWxmKS5wYXJlbnQoKS5hdHRyKFwidGl0bGVcIiwgXCJcIikuYXR0cihcImRhdGEtb3JpZ2luYWwtdGl0bGVcIiwgXCJcIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgJChzZWxmKS5wYXJlbnQoKS5mYWRlT3V0KDMwMCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBwYXJlbnQgPSAkKHRoaXMpLnBhcmVudCgpO1xyXG4gICAgICAgICAgICAkKHRoaXMpLnJlcGxhY2VXaXRoKGJhc2UuY3JlYXRlUGFuZWwoJCgnI2NoZWNrYm94LXRlbXBsYXRlJyksIHtcclxuICAgICAgICAgICAgICBcImRvbmVcIjogdHJ1ZVxyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgIHBhcmVudC5maW5kKCdidXR0b24nKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICBBQ1RJT05JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKCdpZCcpO1xyXG4gICAgICAgICAgICAgIGxvZy5lZGl0QWN0aW9uKFwidGVhbVwiLCBBQ1RJT05JRCwgbnVsbCwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICQodGhpcykucmVwbGFjZVdpdGgoYmFzZS5jcmVhdGVQYW5lbCgkKCcjY2hlY2tib3gtdGVtcGxhdGUnKSwge1xyXG4gICAgICAgICAgICAgICAgXCJkb25lXCI6IGZhbHNlXHJcbiAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgIHRhcC51cGRhdGVUZWFtU2FwUm93cygpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sIDEwMDApO1xyXG4gICAgICB9XHJcblxyXG4gICAgICB0YXAudXBkYXRlVGVhbVNhcFJvd3MoKTtcclxuICAgIH0pO1xyXG5cclxuICAgICQoJyNwZXJzb25hbFBsYW5UZWFtJykub24oJ2NsaWNrJywgJ2lucHV0W3R5cGU9Y2hlY2tib3hdJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBQTEFOSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YShcImlkXCIpO1xyXG4gICAgICBlZGl0UGxhbihQTEFOSUQsIG51bGwsIHRoaXMuY2hlY2tlZCk7XHJcblxyXG4gICAgICBpZiAodGhpcy5jaGVja2VkKSB7XHJcbiAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5wYXJlbnQoKS5wYXJlbnQoKS5hZGRDbGFzcygnc3VjY2VzcycpO1xyXG4gICAgICAgIHJlY29yZEV2ZW50KGRhdGEucGF0aHdheUlkLCBcInRlYW1cIiwgXCJQZXJzb25hbCBwbGFuIGl0ZW1cIik7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgICQoc2VsZikucGFyZW50KCkuYXR0cihcInRpdGxlXCIsIFwiXCIpLmF0dHIoXCJkYXRhLW9yaWdpbmFsLXRpdGxlXCIsIFwiXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgJChzZWxmKS5wYXJlbnQoKS5mYWRlT3V0KDMwMCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBwYXJlbnQgPSAkKHRoaXMpLnBhcmVudCgpO1xyXG4gICAgICAgICAgICAkKHRoaXMpLnJlcGxhY2VXaXRoKGJhc2UuY3JlYXRlUGFuZWwoJCgnI2NoZWNrYm94LXRlbXBsYXRlJyksIHtcclxuICAgICAgICAgICAgICBcImRvbmVcIjogdHJ1ZVxyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgICAgICAgICAgcGFyZW50LmZpbmQoJ2J1dHRvbicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgIFBMQU5JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKCdpZCcpO1xyXG4gICAgICAgICAgICAgIGVkaXRQbGFuKFwidGVhbVwiLCBQTEFOSUQsIG51bGwsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAkKHRoaXMpLnJlcGxhY2VXaXRoKGJhc2UuY3JlYXRlUGFuZWwoJCgnI2NoZWNrYm94LXRlbXBsYXRlJyksIHtcclxuICAgICAgICAgICAgICAgIFwiZG9uZVwiOiBmYWxzZVxyXG4gICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgICB0YXAudXBkYXRlVGVhbVNhcFJvd3MoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9LCAxMDAwKTtcclxuICAgICAgfVxyXG5cclxuICAgIH0pLm9uKCdjbGljaycsICcuYnRuLXVuZG8nLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIHZhciBQTEFOSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YSgnaWQnKTtcclxuICAgICAgbG9nLmVkaXRQbGFuKFBMQU5JRCwgbnVsbCwgZmFsc2UpO1xyXG4gICAgICAkKHRoaXMpLnJlcGxhY2VXaXRoKGJhc2UuY3JlYXRlUGFuZWwoJCgnI2NoZWNrYm94LXRlbXBsYXRlJyksIHtcclxuICAgICAgICBcImRvbmVcIjogZmFsc2VcclxuICAgICAgfSkpO1xyXG4gICAgICB0YXAudXBkYXRlVGVhbVNhcFJvd3MoKTtcclxuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHZhciB0ZWFtVGFiID0gJCgnI3RhYi1wbGFuLXRlYW0nKSxcclxuICAgICAgY3VycmVudDtcclxuICAgIHRlYW1UYWIub24oJ2NsaWNrJywgJy5lZGl0LXBsYW4nLCBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIFBMQU5JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKFwiaWRcIik7XHJcblxyXG4gICAgICAkKCcjZWRpdEFjdGlvblBsYW5JdGVtJykudmFsKCQoJCh0aGlzKS5jbG9zZXN0KCd0cicpLmNoaWxkcmVuKCd0ZCcpWzBdKS5maW5kKCdzcGFuJykudGV4dCgpKTtcclxuXHJcbiAgICAgICQoJyNlZGl0UGxhbicpLm9mZignaGlkZGVuLmJzLm1vZGFsJykub24oJ2hpZGRlbi5icy5tb2RhbCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRhcC5kaXNwbGF5UGVyc29uYWxpc2VkVGVhbUFjdGlvblBsYW4oJCgnI3BlcnNvbmFsUGxhblRlYW0nKSk7XHJcbiAgICAgIH0pLm9mZignc2hvd24uYnMubW9kYWwnKS5vbignc2hvd24uYnMubW9kYWwnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAkKCcjZWRpdEFjdGlvblBsYW5JdGVtJykuZm9jdXMoKTtcclxuICAgICAgfSkub2ZmKCdjbGljaycsICcuc2F2ZS1wbGFuJykub24oJ2NsaWNrJywgJy5zYXZlLXBsYW4nLCBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgbG9nLmVkaXRQbGFuKFBMQU5JRCwgJCgnI2VkaXRBY3Rpb25QbGFuSXRlbScpLnZhbCgpKTtcclxuXHJcbiAgICAgICAgJCgnI2VkaXRQbGFuJykubW9kYWwoJ2hpZGUnKTtcclxuICAgICAgfSkub2ZmKCdrZXl1cCcsICcjZWRpdEFjdGlvblBsYW5JdGVtJykub24oJ2tleXVwJywgJyNlZGl0QWN0aW9uUGxhbkl0ZW0nLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgaWYgKGUud2hpY2ggPT09IDEzKSAkKCcjZWRpdFBsYW4gLnNhdmUtcGxhbicpLmNsaWNrKCk7XHJcbiAgICAgIH0pLm1vZGFsKCk7XHJcbiAgICB9KS5vbignY2xpY2snLCAnLmRlbGV0ZS1wbGFuJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBQTEFOSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YShcImlkXCIpO1xyXG5cclxuICAgICAgJCgnI3RlYW0tZGVsZXRlLWl0ZW0nKS5odG1sKCQoJCh0aGlzKS5jbG9zZXN0KCd0cicpLmNoaWxkcmVuKCd0ZCcpWzBdKS5maW5kKCdzcGFuJykudGV4dCgpKTtcclxuXHJcbiAgICAgICQoJyNkZWxldGVQbGFuJykub2ZmKCdoaWRkZW4uYnMubW9kYWwnKS5vbignaGlkZGVuLmJzLm1vZGFsJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGFwLmRpc3BsYXlQZXJzb25hbGlzZWRUZWFtQWN0aW9uUGxhbigkKCcjcGVyc29uYWxQbGFuVGVhbScpKTtcclxuICAgICAgfSkub2ZmKCdjbGljaycsICcuZGVsZXRlLXBsYW4nKS5vbignY2xpY2snLCAnLmRlbGV0ZS1wbGFuJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgbG9nLmRlbGV0ZVBsYW4oUExBTklEKTtcclxuXHJcbiAgICAgICAgJCgnI2RlbGV0ZVBsYW4nKS5tb2RhbCgnaGlkZScpO1xyXG4gICAgICB9KS5tb2RhbCgpO1xyXG4gICAgfSkub24oJ2NsaWNrJywgJy5hZGQtcGxhbicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICBsb2cucmVjb3JkUGxhbihcInRlYW1cIiwgJCh0aGlzKS5wYXJlbnQoKS5wYXJlbnQoKS5maW5kKCd0ZXh0YXJlYScpLnZhbCgpLCBkYXRhLnBhdGh3YXlJZCk7XHJcblxyXG4gICAgICB0YXAuZGlzcGxheVBlcnNvbmFsaXNlZFRlYW1BY3Rpb25QbGFuKCQoJyNwZXJzb25hbFBsYW5UZWFtJykpO1xyXG4gICAgfSkub24oJ2NoYW5nZScsICcuYnRuLXRvZ2dsZSBpbnB1dFt0eXBlPWNoZWNrYm94XScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICB0YXAudXBkYXRlVGVhbVNhcFJvd3MoKTtcclxuICAgIH0pLm9uKCdjbGljaycsICcuYnRuLXVuZG8nLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIHZhciBBQ1RJT05JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKCdpZCcpO1xyXG4gICAgICBsb2cuZWRpdEFjdGlvbihcInRlYW1cIiwgQUNUSU9OSUQsIG51bGwsIGZhbHNlKTtcclxuICAgICAgJCh0aGlzKS5yZXBsYWNlV2l0aChiYXNlLmNyZWF0ZVBhbmVsKCQoJyNjaGVja2JveC10ZW1wbGF0ZScpLCB7XHJcbiAgICAgICAgXCJkb25lXCI6IGZhbHNlXHJcbiAgICAgIH0pKTtcclxuICAgICAgdGFwLnVwZGF0ZVRlYW1TYXBSb3dzKCk7XHJcbiAgICB9KS5vbignY2xpY2snLCAnLmJ0bi15ZXMsLmJ0bi1ubycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgdmFyIGNoZWNrYm94ID0gJCh0aGlzKS5maW5kKFwiaW5wdXRbdHlwZT1jaGVja2JveF1cIik7XHJcbiAgICAgIHZhciBvdGhlciA9ICQodGhpcykucGFyZW50KCkuZmluZCgkKHRoaXMpLmhhc0NsYXNzKFwiYnRuLXllc1wiKSA/IFwiLmJ0bi1ub1wiIDogXCIuYnRuLXllc1wiKTtcclxuICAgICAgdmFyIEFDVElPTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoJ2lkJyk7XHJcbiAgICAgIGlmICgkKHRoaXMpLmhhc0NsYXNzKFwiYWN0aXZlXCIpICYmIG90aGVyLmhhc0NsYXNzKFwiaW5hY3RpdmVcIikgJiYgISQodGhpcykuY2xvc2VzdCgndHInKS5oYXNDbGFzcygnc3VjY2VzcycpKSB7XHJcbiAgICAgICAgLy91bnNlbGVjdGluZ1xyXG4gICAgICAgIGlmIChjaGVja2JveC52YWwoKSA9PT0gXCJub1wiKSB7XHJcbiAgICAgICAgICB0YXAubGF1bmNoTW9kYWwoZGF0YS5zZWxlY3RlZCwgY2hlY2tib3guY2xvc2VzdCgndHInKS5jaGlsZHJlbigpLmZpcnN0KCkuY2hpbGRyZW4oKS5maXJzdCgpLnRleHQoKSwgbG9nLmdldFJlYXNvbihcInRlYW1cIiwgQUNUSU9OSUQpLCB0cnVlLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgbG9nLmVkaXRBY3Rpb24oXCJ0ZWFtXCIsIEFDVElPTklELCBmYWxzZSwgbnVsbCwgbG9nLnJlYXNvbik7XHJcbiAgICAgICAgICAgIHRhcC51cGRhdGVUZWFtU2FwUm93cygpO1xyXG4gICAgICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICAgICAgICB9LCBudWxsLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgbG9nLmlnbm9yZUFjdGlvbihcInRlYW1cIiwgQUNUSU9OSUQpO1xyXG4gICAgICAgICAgICBvdGhlci5yZW1vdmVDbGFzcyhcImluYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICBjaGVja2JveC5yZW1vdmVBdHRyKFwiY2hlY2tlZFwiKTtcclxuICAgICAgICAgICAgY2hlY2tib3gucGFyZW50KCkucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XHJcbiAgICAgICAgICAgIHRhcC51cGRhdGVUZWFtU2FwUm93cygpO1xyXG4gICAgICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGxvZy5pZ25vcmVBY3Rpb24oXCJ0ZWFtXCIsIEFDVElPTklEKTtcclxuICAgICAgICAgIG90aGVyLnJlbW92ZUNsYXNzKFwiaW5hY3RpdmVcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2UgaWYgKCghJCh0aGlzKS5oYXNDbGFzcyhcImFjdGl2ZVwiKSAmJiBvdGhlci5oYXNDbGFzcyhcImFjdGl2ZVwiKSkgfHwgJCh0aGlzKS5jbG9zZXN0KCd0cicpLmhhc0NsYXNzKCdzdWNjZXNzJykpIHtcclxuICAgICAgICAvL3ByZXZlbnQgY2xpY2tpbmcgb24gdW5zZWxlY3RlZCBvcHRpb24gb3IgaWYgdGhlIHJvdyBpcyBjb21wbGV0ZVxyXG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvL3NlbGVjdGluZ1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBpZiAoY2hlY2tib3gudmFsKCkgPT09IFwibm9cIikge1xyXG4gICAgICAgICAgdGFwLmxhdW5jaE1vZGFsKGRhdGEuc2VsZWN0ZWQsIGNoZWNrYm94LmNsb3Nlc3QoJ3RyJykuY2hpbGRyZW4oKS5maXJzdCgpLmNoaWxkcmVuKCkuZmlyc3QoKS50ZXh0KCksIGxvZy5nZXRSZWFzb24oXCJ0ZWFtXCIsIEFDVElPTklEKSwgZmFsc2UsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBsb2cuZWRpdEFjdGlvbihcInRlYW1cIiwgQUNUSU9OSUQsIGZhbHNlLCBudWxsLCBsb2cucmVhc29uKTtcclxuICAgICAgICAgICAgJChzZWxmKS5yZW1vdmVDbGFzcyhcImluYWN0aXZlXCIpO1xyXG5cclxuICAgICAgICAgICAgY2hlY2tib3guYXR0cihcImNoZWNrZWRcIiwgXCJjaGVja2VkXCIpO1xyXG4gICAgICAgICAgICBjaGVja2JveC5wYXJlbnQoKS5hZGRDbGFzcyhcImFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgLy91bnNlbGVjdCBvdGhlclxyXG4gICAgICAgICAgICBvdGhlci5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKS5hZGRDbGFzcyhcImluYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICBvdGhlci5maW5kKFwiaW5wdXRbdHlwZT1jaGVja2JveF1cIikucHJvcChcImNoZWNrZWRcIiwgZmFsc2UpO1xyXG4gICAgICAgICAgICB0YXAudXBkYXRlVGVhbVNhcFJvd3MoKTtcclxuICAgICAgICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBsb2cuZWRpdEFjdGlvbihcInRlYW1cIiwgQUNUSU9OSUQsIHRydWUpO1xyXG4gICAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcyhcImluYWN0aXZlXCIpO1xyXG5cclxuICAgICAgICAgIC8vdW5zZWxlY3Qgb3RoZXJcclxuICAgICAgICAgIG90aGVyLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpLmFkZENsYXNzKFwiaW5hY3RpdmVcIik7XHJcbiAgICAgICAgICBvdGhlci5maW5kKFwiaW5wdXRbdHlwZT1jaGVja2JveF1cIikucHJvcChcImNoZWNrZWRcIiwgZmFsc2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSkub24oJ2tleXVwJywgJ2lucHV0W3R5cGU9dGV4dF0nLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIGlmIChlLndoaWNoID09PSAxMykge1xyXG4gICAgICAgIHRlYW1UYWIuZmluZCgnLmFkZC1wbGFuJykuY2xpY2soKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgdGFwLnBvcHVsYXRlVGVhbVN1Z2dlc3RlZEFjdGlvbnNQYW5lbCgpO1xyXG5cclxuICAgIGxvY2F0aW9uLmZpbmQoJ2Rpdi5maXQtdG8tc2NyZWVuLWhlaWdodCcpLm5pY2VTY3JvbGwoe1xyXG4gICAgICBjdXJzb3JvcGFjaXR5bWluOiAwLjMsXHJcbiAgICAgIGN1cnNvcndpZHRoOiBcIjdweFwiLFxyXG4gICAgICBob3JpenJhaWxlbmFibGVkOiBmYWxzZVxyXG4gICAgfSk7XHJcbiAgfSxcclxuXHJcbiAgcG9wdWxhdGVUZWFtU3VnZ2VzdGVkQWN0aW9uc1BhbmVsOiBmdW5jdGlvbigpIHtcclxuICAgIHZhciBzdWdnZXN0aW9ucyA9IGJhc2Uuc3VnZ2VzdGlvbkxpc3QobG9nLnBsYW5bZGF0YS5wYXRod2F5SWRdLnRlYW0pO1xyXG4gICAgc3VnZ2VzdGlvbnMgPSBiYXNlLnNvcnRTdWdnZXN0aW9ucyh0YXAubWVyZ2VUZWFtU3R1ZmYoc3VnZ2VzdGlvbnMpKTtcclxuXHJcbiAgICBiYXNlLmNyZWF0ZVBhbmVsU2hvdyhzdWdnZXN0ZWRQbGFuVGVtcGxhdGUsIHN1Z2dlc3RlZFBsYW5UZWFtLCB7XHJcbiAgICAgIFwic3VnZ2VzdGlvbnNcIjogc3VnZ2VzdGlvbnNcclxuICAgIH0sIHtcclxuICAgICAgXCJpdGVtXCI6ICQoJyNzdWdnZXN0ZWQtcGxhbi1pdGVtJykuaHRtbCgpLFxyXG4gICAgICBcImNoa1wiOiAkKCcjY2hlY2tib3gtdGVtcGxhdGUnKS5odG1sKClcclxuICAgIH0pO1xyXG5cclxuICAgIHRhcC5kaXNwbGF5UGVyc29uYWxpc2VkVGVhbUFjdGlvblBsYW4oJCgnI3BlcnNvbmFsUGxhblRlYW0nKSk7XHJcbiAgfSxcclxuXHJcbiAgdXBkYXRlVGVhbVNhcFJvd3M6IGZ1bmN0aW9uKCkge1xyXG4gICAgc3VnZ2VzdGVkUGxhblRlYW0uYWRkKCcjcGVyc29uYWxQbGFuVGVhbScpLmZpbmQoJy5zdWdnZXN0aW9uJykuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgJCh0aGlzKS5maW5kKCd0ZCcpLmxhc3QoKS5jaGlsZHJlbigpLmhpZGUoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHN1Z2dlc3RlZFBsYW5UZWFtLmFkZCgnI3BlcnNvbmFsUGxhblRlYW0nKS5maW5kKCcuY3Itc3R5bGVkIGlucHV0W3R5cGU9Y2hlY2tib3hdJykuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgaWYgKHRoaXMuY2hlY2tlZCkge1xyXG4gICAgICAgICQodGhpcykucGFyZW50KCkucGFyZW50KCkucGFyZW50KCkuYWRkQ2xhc3MoJ3N1Y2Nlc3MnKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAkKHRoaXMpLnBhcmVudCgpLnBhcmVudCgpLnBhcmVudCgpLnJlbW92ZUNsYXNzKCdzdWNjZXNzJyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHN1Z2dlc3RlZFBsYW5UZWFtLmFkZCgnI3BlcnNvbmFsUGxhblRlYW0nKS5maW5kKCcuYnRuLXVuZG8nKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICAkKHRoaXMpLnBhcmVudCgpLnBhcmVudCgpLmFkZENsYXNzKCdzdWNjZXNzJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvL25vIGNsYXNzIC0gdXNlciBub3QgeWV0IGFncmVlZC9kaXNhZ3JlZWQgLSBubyBiYWNrZ3JvdW5kIC8gbXV0ZWQgdGV4dFxyXG4gICAgLy9hY3RpdmUgLSB1c2VyIGFncmVlcyAtIGdyZWVuIGJhY2tncm91bmQgLyBub3JtYWwgdGV4dFxyXG4gICAgLy9zdWNjZXNzIC0gdXNlciBjb21wbGV0ZWQgLSBncmVlbiBiYWNrZ3JvdW5kIC8gc3RyaWtldGhyb3VnaCB0ZXh0XHJcbiAgICAvL2RhbmdlciAtIHVzZXIgZGlzYWdyZWVzIC0gcmVkIGJhY2tncm91bmQgLyBzdHJpa2V0aHJvdWdoIHRleHRcclxuICAgIHN1Z2dlc3RlZFBsYW5UZWFtLmFkZCgnI3BlcnNvbmFsUGxhblRlYW0nKS5maW5kKCd0cicpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBzZWxmID0gJCh0aGlzKTtcclxuICAgICAgdmFyIGFueSA9IGZhbHNlO1xyXG4gICAgICBzZWxmLmZpbmQoJy5idG4tdG9nZ2xlIGlucHV0W3R5cGU9Y2hlY2tib3hdOmNoZWNrZWQnKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGFueSA9IHRydWU7XHJcbiAgICAgICAgaWYgKHRoaXMudmFsdWUgPT09IFwieWVzXCIpIHtcclxuICAgICAgICAgIHNlbGYucmVtb3ZlQ2xhc3MoJ2RhbmdlcicpO1xyXG4gICAgICAgICAgc2VsZi5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgICBzZWxmLmZpbmQoJ3RkJykubGFzdCgpLmNoaWxkcmVuKCkuc2hvdygpO1xyXG4gICAgICAgICAgaWYgKGxvZy5nZXRBY3Rpb25zKCkudGVhbVtzZWxmLmRhdGEoXCJpZFwiKV0uaGlzdG9yeSkge1xyXG4gICAgICAgICAgICB2YXIgdG9vbCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5oYXNDbGFzcygnc3VjY2VzcycpID8gXCJcIiA6IFwiPHA+XCIgKyBsb2cuZ2V0QWN0aW9ucygpLnRlYW1bc2VsZi5kYXRhKFwiaWRcIildLmhpc3RvcnlbMF0gKyBcIjwvcD48cD5DbGljayBhZ2FpbiB0byBjYW5jZWw8L3A+XCI7XHJcbiAgICAgICAgICAgICQodGhpcykucGFyZW50KCkuYXR0cihcInRpdGxlXCIsIHRvb2wpLmF0dHIoXCJkYXRhLW9yaWdpbmFsLXRpdGxlXCIsIHRvb2wpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5hdHRyKFwidGl0bGVcIiwgXCJZb3UgYWdyZWVkIC0gY2xpY2sgYWdhaW4gdG8gY2FuY2VsXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBzZWxmLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgIHNlbGYuYWRkQ2xhc3MoJ2RhbmdlcicpO1xyXG4gICAgICAgICAgc2VsZi5yZW1vdmVDbGFzcygnc3VjY2VzcycpO1xyXG4gICAgICAgICAgaWYgKGxvZy5nZXRBY3Rpb25zKCkudGVhbVtzZWxmLmRhdGEoXCJpZFwiKV0gJiYgbG9nLmdldEFjdGlvbnMoKS50ZWFtW3NlbGYuZGF0YShcImlkXCIpXS5oaXN0b3J5KSB7XHJcbiAgICAgICAgICAgICQodGhpcykucGFyZW50KCkuYXR0cihcInRpdGxlXCIsIFwiPHA+XCIgKyBsb2cuZ2V0QWN0aW9ucygpLnRlYW1bc2VsZi5kYXRhKFwiaWRcIildLmhpc3RvcnlbMF0gKyBcIjwvcD48cD5DbGljayBhZ2FpbiB0byBlZGl0L2NhbmNlbDwvcD5cIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAkKHRoaXMpLnBhcmVudCgpLmF0dHIoXCJ0aXRsZVwiLCBcIllvdSBkaXNhZ3JlZWQgLSBjbGljayBhZ2FpbiB0byBlZGl0L2NhbmNlbFwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgICBpZiAoc2VsZi5maW5kKCcuYnRuLXRvZ2dsZSBpbnB1dFt0eXBlPWNoZWNrYm94XTpub3QoOmNoZWNrZWQpJykubGVuZ3RoID09IDEpIHtcclxuICAgICAgICBzZWxmLmZpbmQoJy5idG4tdG9nZ2xlIGlucHV0W3R5cGU9Y2hlY2tib3hdOm5vdCg6Y2hlY2tlZCknKS5wYXJlbnQoKS5hZGRDbGFzcyhcImluYWN0aXZlXCIpLmF0dHIoXCJ0aXRsZVwiLCBcIlwiKS5hdHRyKFwiZGF0YS1vcmlnaW5hbC10aXRsZVwiLCBcIlwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAoIWFueSkge1xyXG4gICAgICAgIHNlbGYucmVtb3ZlQ2xhc3MoJ2RhbmdlcicpO1xyXG4gICAgICAgIHNlbGYucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgIHNlbGYucmVtb3ZlQ2xhc3MoJ3N1Y2Nlc3MnKTtcclxuXHJcbiAgICAgICAgc2VsZi5maW5kKCcuYnRuLXRvZ2dsZS5idG4teWVzJykuYXR0cihcInRpdGxlXCIsIFwiQ2xpY2sgdG8gYWdyZWUgd2l0aCB0aGlzIGFjdGlvbiBhbmQgc2F2ZSBpdCBpbiB5b3VyIGFncmVlZCBhY3Rpb25zIGxpc3QgIFwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgICBzZWxmLmZpbmQoJy5idG4tdG9nZ2xlLmJ0bi1ubycpLmF0dHIoXCJ0aXRsZVwiLCBcIkNsaWNrIHRvIGRpc2FncmVlIHdpdGggdGhpcyBhY3Rpb24gYW5kIHJlbW92ZSBpdCBmcm9tIHlvdXIgc3VnZ2VzdGVkIGFjdGlvbnMgbGlzdCBcIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICB9LFxyXG5cclxuICBkaXNwbGF5UGVyc29uYWxpc2VkVGVhbUFjdGlvblBsYW46IGZ1bmN0aW9uKHBhcmVudEVsZW0pIHtcclxuICAgIHZhciBwbGFucyA9IGJhc2Uuc29ydFN1Z2dlc3Rpb25zKGJhc2UuYWRkRGlzYWdyZWVQZXJzb25hbFRlYW0obG9nLmxpc3RQbGFucyhcInRlYW1cIiwgZGF0YS5wYXRod2F5SWQpKSk7XHJcblxyXG4gICAgYmFzZS5jcmVhdGVQYW5lbFNob3coYWN0aW9uUGxhbkxpc3QsIHBhcmVudEVsZW0sIHtcclxuICAgICAgXCJoYXNTdWdnZXN0aW9uc1wiOiBwbGFucyAmJiBwbGFucy5sZW5ndGggPiAwLFxyXG4gICAgICBcInN1Z2dlc3Rpb25zXCI6IHBsYW5zXHJcbiAgICB9LCB7XHJcbiAgICAgIFwiYWN0aW9uLXBsYW5cIjogJCgnI2FjdGlvbi1wbGFuJykuaHRtbCgpLFxyXG4gICAgICBcImFjdGlvbi1wbGFuLWl0ZW1cIjogJCgnI2FjdGlvbi1wbGFuLWl0ZW0nKS5odG1sKCksXHJcbiAgICAgIFwiY2hrXCI6ICQoJyNjaGVja2JveC10ZW1wbGF0ZScpLmh0bWwoKVxyXG4gICAgfSk7XHJcblxyXG4gICAgdGFwLnVwZGF0ZVRlYW1TYXBSb3dzKCk7XHJcbiAgfSxcclxuXHJcbiAgbWVyZ2VUZWFtU3R1ZmY6IGZ1bmN0aW9uKHN1Z2dlc3Rpb25zKSB7XHJcbiAgICB2YXIgdGVhbUFjdGlvbnMgPSBsb2cubGlzdEFjdGlvbnMoKTtcclxuICAgIGlmICghdGVhbUFjdGlvbnMudGVhbSkgcmV0dXJuIHN1Z2dlc3Rpb25zO1xyXG5cclxuICAgIHN1Z2dlc3Rpb25zID0gdGFwLmFkZERpc2FncmVlKHN1Z2dlc3Rpb25zLCB0ZWFtQWN0aW9ucywgXCJ0ZWFtXCIpO1xyXG4gICAgcmV0dXJuIHN1Z2dlc3Rpb25zO1xyXG4gIH0sXHJcblxyXG4gIGxhdW5jaE1vZGFsOiBmdW5jdGlvbihsYWJlbCwgdmFsdWUsIHJlYXNvbiwgaXNVbmRvLCBjYWxsYmFja09uU2F2ZSwgY2FsbGJhY2tPbkNhbmNlbCwgY2FsbGJhY2tPblVuZG8pIHtcclxuICAgIHZhciByZWFzb25zID0gW3tcclxuICAgICAgXCJyZWFzb25cIjogXCJXZSd2ZSBhbHJlYWR5IGRvbmUgdGhpc1wiLFxyXG4gICAgICBcInZhbHVlXCI6IFwiZG9uZVwiXHJcbiAgICB9LCB7XHJcbiAgICAgIFwicmVhc29uXCI6IFwiSXQgd291bGRuJ3Qgd29ya1wiLFxyXG4gICAgICBcInZhbHVlXCI6IFwibm93b3JrXCJcclxuICAgIH0sIHtcclxuICAgICAgXCJyZWFzb25cIjogXCJPdGhlclwiLFxyXG4gICAgICBcInZhbHVlXCI6IFwiZWxzZVwiXHJcbiAgICB9XTtcclxuICAgIGlmIChyZWFzb24gJiYgcmVhc29uLnJlYXNvbikge1xyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlYXNvbnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBpZiAocmVhc29uc1tpXS5yZWFzb24gPT09IHJlYXNvbi5yZWFzb24pIHtcclxuICAgICAgICAgIHJlYXNvbnNbaV0uY2hlY2tlZCA9IHRydWU7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGJhc2UubGF1bmNoTW9kYWwoe1xyXG4gICAgICBcImhlYWRlclwiOiBcIkRpc2FncmVlIHdpdGggYSBzdWdnZXN0ZWQgYWN0aW9uXCIsXHJcbiAgICAgIFwiaXNVbmRvXCI6IGlzVW5kbyxcclxuICAgICAgXCJpdGVtXCI6IHZhbHVlLFxyXG4gICAgICBcInBsYWNlaG9sZGVyXCI6IFwiRW50ZXIgZnJlZS10ZXh0IGhlcmUuLi5cIixcclxuICAgICAgXCJyZWFzb25zXCI6IHJlYXNvbnNcclxuICAgIH0sIGxhYmVsLCB2YWx1ZSwgcmVhc29uID8gcmVhc29uLnJlYXNvblRleHQgOiBudWxsLCBjYWxsYmFja09uU2F2ZSwgY2FsbGJhY2tPbkNhbmNlbCwgY2FsbGJhY2tPblVuZG8pO1xyXG4gIH0sXHJcblxyXG4gIGFkZERpc2FncmVlOiBmdW5jdGlvbihzdWdnZXN0aW9ucywgYWN0aW9ucywgaWQpIHtcclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3VnZ2VzdGlvbnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgaWYgKGFjdGlvbnNbaWRdW3N1Z2dlc3Rpb25zW2ldLmlkXSkge1xyXG4gICAgICAgIGlmIChhY3Rpb25zW2lkXVtzdWdnZXN0aW9uc1tpXS5pZF0uYWdyZWUpIHtcclxuICAgICAgICAgIHN1Z2dlc3Rpb25zW2ldLmFncmVlID0gdHJ1ZTtcclxuICAgICAgICAgIHN1Z2dlc3Rpb25zW2ldLmRpc2FncmVlID0gZmFsc2U7XHJcbiAgICAgICAgfSBlbHNlIGlmIChhY3Rpb25zW2lkXVtzdWdnZXN0aW9uc1tpXS5pZF0uYWdyZWUgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgICBzdWdnZXN0aW9uc1tpXS5hZ3JlZSA9IGZhbHNlO1xyXG4gICAgICAgICAgc3VnZ2VzdGlvbnNbaV0uZGlzYWdyZWUgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoYWN0aW9uc1tpZF1bc3VnZ2VzdGlvbnNbaV0uaWRdLmRvbmUpIHN1Z2dlc3Rpb25zW2ldLmRvbmUgPSBhY3Rpb25zW2lkXVtzdWdnZXN0aW9uc1tpXS5pZF0uZG9uZTtcclxuICAgICAgICBlbHNlIHN1Z2dlc3Rpb25zW2ldLmRvbmUgPSBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHN1Z2dlc3Rpb25zO1xyXG4gIH1cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHRhcDtcclxuIiwidmFyIGJhc2UgPSByZXF1aXJlKCcuLi9iYXNlLmpzJyksXHJcbiAgY29uZmlybSA9IHJlcXVpcmUoJy4vY29uZmlybS5qcycpLFxyXG4gIGRhdGEgPSByZXF1aXJlKCcuLi9kYXRhLmpzJyksXHJcbiAgbG9nID0gcmVxdWlyZSgnLi4vbG9nLmpzJyksXHJcbiAgbG9va3VwID0gcmVxdWlyZSgnLi4vbG9va3VwLmpzJyk7XHJcblxyXG52YXIgdHJuZCA9IHtcclxuXHJcbiAgY3JlYXRlOiBmdW5jdGlvbihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCkge1xyXG4gICAgdmFyIGFncmVlID0gbG9nLmdldFBhdGllbnRBZ3JlZU9iamVjdChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCwgXCJ0cmVuZFwiKTtcclxuICAgIHJldHVybiBiYXNlLmNyZWF0ZVBhbmVsKHZhbHVlVHJlbmRQYW5lbCwge1xyXG4gICAgICBcInBhdGh3YXlcIjogbG9va3VwLm1vbml0b3JlZFtwYXRod2F5SWRdLFxyXG4gICAgICBcImFncmVlXCI6IGFncmVlICYmIGFncmVlLmFncmVlLFxyXG4gICAgICBcImRpc2FncmVlXCI6IGFncmVlICYmIGFncmVlLmFncmVlID09PSBmYWxzZSxcclxuICAgICAgXCJzdGFuZGFyZFwiOiBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLnRhYi50aXRsZSxcclxuICAgICAgXCJwYXRod2F5U3RhZ2VcIjogcGF0aHdheVN0YWdlXHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICB3aXJlVXA6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKSB7XHJcbiAgICBjb25maXJtLndpcmVVcCgkKCcjdHJlbmQtYWdyZWUtZGlzYWdyZWUnKSwgJCgnI3RyZW5kLXBhbmVsJyksIHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkLCBcInRyZW5kXCIsIFwidHJlbmQgZGF0YVwiKTtcclxuXHJcbiAgICAkKCcjdHJlbmQtcGFuZWwnKS5vbignY2xpY2snLCAnLnRhYmxlLWNoYXJ0LXRvZ2dsZScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICBpZiAoJCh0aGlzKS50ZXh0KCkgPT09IFwiVGFibGVcIikge1xyXG4gICAgICAgICQodGhpcykudGV4dChcIkNoYXJ0XCIpO1xyXG4gICAgICAgICQoJyNjaGFydC1kZW1vLXRyZW5kJykuaGlkZSgpO1xyXG4gICAgICAgICQoJyN0YWJsZS1kZW1vLXRyZW5kJykuc2hvdygpO1xyXG5cclxuICAgICAgICB2YXIgYyA9ICQoJyN0YWJsZS1kZW1vLXRyZW5kIC50YWJsZVNjcm9sbCcpLmdldE5pY2VTY3JvbGwoKTtcclxuICAgICAgICBpZiAoYyAmJiBjLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgIGMucmVzaXplKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICQoJyN0YWJsZS1kZW1vLXRyZW5kIC50YWJsZVNjcm9sbCcpLm5pY2VTY3JvbGwoe1xyXG4gICAgICAgICAgICBjdXJzb3JvcGFjaXR5bWluOiAwLjMsXHJcbiAgICAgICAgICAgIGN1cnNvcndpZHRoOiBcIjdweFwiLFxyXG4gICAgICAgICAgICBob3JpenJhaWxlbmFibGVkOiBmYWxzZVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgICQodGhpcykudGV4dChcIlRhYmxlXCIpO1xyXG4gICAgICAgICQoJyNjaGFydC1kZW1vLXRyZW5kJykuc2hvdygpO1xyXG4gICAgICAgICQoJyN0YWJsZS1kZW1vLXRyZW5kJykuaGlkZSgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSB0cm5kO1xyXG4iLCJ2YXIgYmFzZSA9IHJlcXVpcmUoJy4uL2Jhc2UuanMnKSxcclxuICBkYXRhID0gcmVxdWlyZSgnLi4vZGF0YS5qcycpLFxyXG4gIGxvZyA9IHJlcXVpcmUoJy4uL2xvZy5qcycpLFxyXG4gIGluZGl2aWR1YWxBY3Rpb25QbGFuID0gcmVxdWlyZSgnLi9pbmRpdmlkdWFsQWN0aW9uUGxhbi5qcycpLFxyXG4gIHRlYW1BY3Rpb25QbGFuID0gcmVxdWlyZSgnLi90ZWFtQWN0aW9uUGxhbi5qcycpLFxyXG4gIE11c3RhY2hlID0gcmVxdWlyZSgnbXVzdGFjaGUnKTtcclxuXHJcbnZhciB3ZWxjb21lID0ge1xyXG5cclxuICB3aXJlVXBXZWxjb21lUGFnZTogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UpIHtcclxuICAgICQoJyN0ZWFtLXRhc2stcGFuZWwnKS5vbignY2xpY2snLCAnLmNyLXN0eWxlZCBpbnB1dFt0eXBlPWNoZWNrYm94XScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgQUNUSU9OSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YSgnaWQnKTtcclxuICAgICAgbG9nLmVkaXRBY3Rpb24oXCJ0ZWFtXCIsIEFDVElPTklELCBudWxsLCB0aGlzLmNoZWNrZWQpO1xyXG5cclxuICAgICAgaWYgKHRoaXMuY2hlY2tlZCkge1xyXG4gICAgICAgIGxvZy5yZWNvcmRFdmVudChwYXRod2F5SWQsIFwidGVhbVwiLCBcIkl0ZW0gY29tcGxldGVkXCIpO1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAkKHNlbGYpLnBhcmVudCgpLmF0dHIoXCJ0aXRsZVwiLCBcIlwiKS5hdHRyKFwiZGF0YS1vcmlnaW5hbC10aXRsZVwiLCBcIlwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAkKHNlbGYpLnBhcmVudCgpLmZhZGVPdXQoMzAwLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIHBhcmVudCA9ICQodGhpcykucGFyZW50KCk7XHJcbiAgICAgICAgICAgICQodGhpcykucmVwbGFjZVdpdGgoYmFzZS5jcmVhdGVQYW5lbCgkKCcjY2hlY2tib3gtdGVtcGxhdGUnKSwge1xyXG4gICAgICAgICAgICAgIFwiZG9uZVwiOiB0cnVlXHJcbiAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgcGFyZW50LmZpbmQoJ2J1dHRvbicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgIEFDVElPTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoJ2lkJyk7XHJcbiAgICAgICAgICAgICAgbG9nLmVkaXRBY3Rpb24oXCJ0ZWFtXCIsIEFDVElPTklELCBudWxsLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgJCh0aGlzKS5yZXBsYWNlV2l0aChiYXNlLmNyZWF0ZVBhbmVsKCQoJyNjaGVja2JveC10ZW1wbGF0ZScpLCB7XHJcbiAgICAgICAgICAgICAgICBcImRvbmVcIjogZmFsc2VcclxuICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgd2VsY29tZS51cGRhdGVXZWxjb21lUGFnZSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sIDEwMDApO1xyXG4gICAgICB9XHJcbiAgICAgIHdlbGNvbWUudXBkYXRlV2VsY29tZVBhZ2UoKTtcclxuICAgIH0pLm9uKCdjaGFuZ2UnLCAnLmJ0bi10b2dnbGUgaW5wdXRbdHlwZT1jaGVja2JveF0nLCBmdW5jdGlvbigpIHtcclxuICAgICAgd2VsY29tZS51cGRhdGVXZWxjb21lUGFnZSgpO1xyXG4gICAgfSkub24oJ2NsaWNrJywgJy5lZGl0LXBsYW4nLCBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIFBMQU5JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKFwiaWRcIik7XHJcblxyXG4gICAgICAkKCcjZWRpdEFjdGlvblBsYW5JdGVtJykudmFsKCQoJCh0aGlzKS5jbG9zZXN0KCd0cicpLmNoaWxkcmVuKCd0ZCcpWzFdKS5maW5kKCdzcGFuJykudGV4dCgpKTtcclxuXHJcbiAgICAgICQoJyNlZGl0UGxhbicpLm9mZignaGlkZGVuLmJzLm1vZGFsJykub24oJ2hpZGRlbi5icy5tb2RhbCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHdlbGNvbWUucG9wdWxhdGUoISQoJyNvdXRzdGFuZGluZ1Rhc2tzJykucGFyZW50KCkuaGFzQ2xhc3MoXCJhY3RpdmVcIikpO1xyXG4gICAgICB9KS5vZmYoJ3Nob3duLmJzLm1vZGFsJykub24oJ3Nob3duLmJzLm1vZGFsJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgJCgnI2VkaXRBY3Rpb25QbGFuSXRlbScpLmZvY3VzKCk7XHJcbiAgICAgIH0pLm9mZignY2xpY2snLCAnLnNhdmUtcGxhbicpLm9uKCdjbGljaycsICcuc2F2ZS1wbGFuJywgZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgIGxvZy5lZGl0UGxhbihQTEFOSUQsICQoJyNlZGl0QWN0aW9uUGxhbkl0ZW0nKS52YWwoKSk7XHJcblxyXG4gICAgICAgICQoJyNlZGl0UGxhbicpLm1vZGFsKCdoaWRlJyk7XHJcbiAgICAgIH0pLm9mZigna2V5dXAnLCAnI2VkaXRBY3Rpb25QbGFuSXRlbScpLm9uKCdrZXl1cCcsICcjZWRpdEFjdGlvblBsYW5JdGVtJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgIGlmIChlLndoaWNoID09PSAxMykgJCgnI2VkaXRQbGFuIC5zYXZlLXBsYW4nKS5jbGljaygpO1xyXG4gICAgICB9KS5tb2RhbCgpO1xyXG4gICAgfSkub24oJ2NsaWNrJywgJy5kZWxldGUtcGxhbicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgUExBTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoXCJpZFwiKTtcclxuXHJcbiAgICAgICQoJyN0ZWFtLWRlbGV0ZS1pdGVtJykuaHRtbCgkKCQodGhpcykuY2xvc2VzdCgndHInKS5jaGlsZHJlbigndGQnKVsxXSkuZmluZCgnc3BhbicpLnRleHQoKSk7XHJcblxyXG4gICAgICAkKCcjZGVsZXRlUGxhbicpLm9mZignaGlkZGVuLmJzLm1vZGFsJykub24oJ2hpZGRlbi5icy5tb2RhbCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHdlbGNvbWUucG9wdWxhdGUoISQoJyNvdXRzdGFuZGluZ1Rhc2tzJykucGFyZW50KCkuaGFzQ2xhc3MoXCJhY3RpdmVcIikpO1xyXG4gICAgICB9KS5vZmYoJ2NsaWNrJywgJy5kZWxldGUtcGxhbicpLm9uKCdjbGljaycsICcuZGVsZXRlLXBsYW4nLCBmdW5jdGlvbigpIHtcclxuICAgICAgICBsb2cuZGVsZXRlUGxhbihQTEFOSUQpO1xyXG5cclxuICAgICAgICAkKCcjZGVsZXRlUGxhbicpLm1vZGFsKCdoaWRlJyk7XHJcbiAgICAgIH0pLm1vZGFsKCk7XHJcbiAgICB9KS5vbignY2xpY2snLCAnLmJ0bi11bmRvJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICB2YXIgQUNUSU9OSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YSgnaWQnKTtcclxuICAgICAgbG9nLmVkaXRBY3Rpb24oXCJ0ZWFtXCIsIEFDVElPTklELCBudWxsLCBmYWxzZSk7XHJcbiAgICAgICQodGhpcykucmVwbGFjZVdpdGgoYmFzZS5jcmVhdGVQYW5lbCgkKCcjY2hlY2tib3gtdGVtcGxhdGUnKSwge1xyXG4gICAgICAgIFwiZG9uZVwiOiBmYWxzZVxyXG4gICAgICB9KSk7XHJcbiAgICAgIHdlbGNvbWUudXBkYXRlV2VsY29tZVBhZ2UoKTtcclxuICAgIH0pLm9uKCdjbGljaycsICcuYnRuLXllcywuYnRuLW5vJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICB2YXIgY2hlY2tib3ggPSAkKHRoaXMpLmZpbmQoXCJpbnB1dFt0eXBlPWNoZWNrYm94XVwiKTtcclxuICAgICAgdmFyIG90aGVyID0gJCh0aGlzKS5wYXJlbnQoKS5maW5kKCQodGhpcykuaGFzQ2xhc3MoXCJidG4teWVzXCIpID8gXCIuYnRuLW5vXCIgOiBcIi5idG4teWVzXCIpO1xyXG4gICAgICB2YXIgQUNUSU9OSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YSgnaWQnKTtcclxuICAgICAgaWYgKCQodGhpcykuaGFzQ2xhc3MoXCJhY3RpdmVcIikgJiYgb3RoZXIuaGFzQ2xhc3MoXCJpbmFjdGl2ZVwiKSAmJiAhJCh0aGlzKS5jbG9zZXN0KCd0cicpLmhhc0NsYXNzKCdzdWNjZXNzJykpIHtcclxuICAgICAgICAvL3Vuc2VsZWN0aW5nXHJcbiAgICAgICAgaWYgKGNoZWNrYm94LnZhbCgpID09PSBcIm5vXCIpIHtcclxuICAgICAgICAgIHRlYW1BY3Rpb25QbGFuLmxhdW5jaE1vZGFsKGRhdGEuc2VsZWN0ZWQsIGNoZWNrYm94LmNsb3Nlc3QoJ3RyJykuY2hpbGRyZW4oJzpudGgoMSknKS5maW5kKCdzcGFuJykudGV4dCgpLCBsb2cuZ2V0UmVhc29uKFwidGVhbVwiLCBBQ1RJT05JRCksIHRydWUsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBsb2cuZWRpdEFjdGlvbihcInRlYW1cIiwgQUNUSU9OSUQsIGZhbHNlLCBudWxsLCBsb2cucmVhc29uKTtcclxuICAgICAgICAgICAgd2VsY29tZS51cGRhdGVXZWxjb21lUGFnZSgpO1xyXG4gICAgICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICAgICAgICB9LCBudWxsLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgbG9nLmlnbm9yZUFjdGlvbihcInRlYW1cIiwgQUNUSU9OSUQpO1xyXG4gICAgICAgICAgICBvdGhlci5yZW1vdmVDbGFzcyhcImluYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICBjaGVja2JveC5yZW1vdmVBdHRyKFwiY2hlY2tlZFwiKTtcclxuICAgICAgICAgICAgY2hlY2tib3gucGFyZW50KCkucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XHJcbiAgICAgICAgICAgIHdlbGNvbWUudXBkYXRlV2VsY29tZVBhZ2UoKTtcclxuICAgICAgICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBsb2cuaWdub3JlQWN0aW9uKFwidGVhbVwiLCBBQ1RJT05JRCk7XHJcbiAgICAgICAgICBvdGhlci5yZW1vdmVDbGFzcyhcImluYWN0aXZlXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIGlmICgoISQodGhpcykuaGFzQ2xhc3MoXCJhY3RpdmVcIikgJiYgb3RoZXIuaGFzQ2xhc3MoXCJhY3RpdmVcIikpIHx8ICQodGhpcykuY2xvc2VzdCgndHInKS5oYXNDbGFzcygnc3VjY2VzcycpKSB7XHJcbiAgICAgICAgLy9wcmV2ZW50IGNsaWNraW5nIG9uIHVuc2VsZWN0ZWQgb3B0aW9uIG9yIGlmIHRoZSByb3cgaXMgY29tcGxldGVcclxuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy9zZWxlY3RpbmdcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgaWYgKGNoZWNrYm94LnZhbCgpID09PSBcIm5vXCIpIHtcclxuICAgICAgICAgIHRlYW1BY3Rpb25QbGFuLmxhdW5jaE1vZGFsKGRhdGEuc2VsZWN0ZWQsIGNoZWNrYm94LmNsb3Nlc3QoJ3RyJykuY2hpbGRyZW4oJzpudGgoMSknKS5maW5kKCdzcGFuJykudGV4dCgpLCBsb2cuZ2V0UmVhc29uKFwidGVhbVwiLCBBQ1RJT05JRCksIGZhbHNlLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgbG9nLmVkaXRBY3Rpb24oXCJ0ZWFtXCIsIEFDVElPTklELCBmYWxzZSwgbnVsbCwgbG9nLnJlYXNvbik7XHJcbiAgICAgICAgICAgICQoc2VsZikucmVtb3ZlQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuXHJcbiAgICAgICAgICAgIGNoZWNrYm94LmF0dHIoXCJjaGVja2VkXCIsIFwiY2hlY2tlZFwiKTtcclxuICAgICAgICAgICAgY2hlY2tib3gucGFyZW50KCkuYWRkQ2xhc3MoXCJhY3RpdmVcIik7XHJcbiAgICAgICAgICAgIC8vdW5zZWxlY3Qgb3RoZXJcclxuICAgICAgICAgICAgb3RoZXIucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIikuYWRkQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgb3RoZXIuZmluZChcImlucHV0W3R5cGU9Y2hlY2tib3hdXCIpLnByb3AoXCJjaGVja2VkXCIsIGZhbHNlKTtcclxuICAgICAgICAgICAgd2VsY29tZS51cGRhdGVXZWxjb21lUGFnZSgpO1xyXG4gICAgICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGxvZy5lZGl0QWN0aW9uKFwidGVhbVwiLCBBQ1RJT05JRCwgdHJ1ZSk7XHJcbiAgICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKFwiaW5hY3RpdmVcIik7XHJcblxyXG4gICAgICAgICAgLy91bnNlbGVjdCBvdGhlclxyXG4gICAgICAgICAgb3RoZXIucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIikuYWRkQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuICAgICAgICAgIG90aGVyLmZpbmQoXCJpbnB1dFt0eXBlPWNoZWNrYm94XVwiKS5wcm9wKFwiY2hlY2tlZFwiLCBmYWxzZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAkKCcjaW5kaXZpZHVhbC10YXNrLXBhbmVsJykub24oJ2NsaWNrJywgJy5jci1zdHlsZWQgaW5wdXRbdHlwZT1jaGVja2JveF0nLCBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIEFDVElPTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoJ2lkJyk7XHJcbiAgICAgIHZhciBwYXRpZW50SWQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YSgndGVhbS1vci1wYXRpZW50LWlkJyk7XHJcbiAgICAgIGxvZy5lZGl0QWN0aW9uKHBhdGllbnRJZCwgQUNUSU9OSUQsIG51bGwsIHRoaXMuY2hlY2tlZCk7XHJcblxyXG4gICAgICBpZiAodGhpcy5jaGVja2VkKSB7XHJcbiAgICAgICAgbG9nLnJlY29yZEV2ZW50KHBhdGh3YXlJZCwgcGF0aWVudElkLCBcIkl0ZW0gY29tcGxldGVkXCIpO1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAkKHNlbGYpLnBhcmVudCgpLmF0dHIoXCJ0aXRsZVwiLCBcIlwiKS5hdHRyKFwiZGF0YS1vcmlnaW5hbC10aXRsZVwiLCBcIlwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAkKHNlbGYpLnBhcmVudCgpLmZhZGVPdXQoMzAwLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIHBhcmVudCA9ICQodGhpcykucGFyZW50KCk7XHJcbiAgICAgICAgICAgICQodGhpcykucmVwbGFjZVdpdGgoYmFzZS5jcmVhdGVQYW5lbCgkKCcjY2hlY2tib3gtdGVtcGxhdGUnKSwge1xyXG4gICAgICAgICAgICAgIFwiZG9uZVwiOiB0cnVlXHJcbiAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgcGFyZW50LmZpbmQoJ2J1dHRvbicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgIEFDVElPTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoJ2lkJyk7XHJcbiAgICAgICAgICAgICAgbG9nLmVkaXRBY3Rpb24ocGF0aWVudElkLCBBQ1RJT05JRCwgbnVsbCwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICQodGhpcykucmVwbGFjZVdpdGgoYmFzZS5jcmVhdGVQYW5lbCgkKCcjY2hlY2tib3gtdGVtcGxhdGUnKSwge1xyXG4gICAgICAgICAgICAgICAgXCJkb25lXCI6IGZhbHNlXHJcbiAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgIHdlbGNvbWUudXBkYXRlV2VsY29tZVBhZ2UoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9LCAxMDAwKTtcclxuICAgICAgfVxyXG4gICAgICB3ZWxjb21lLnVwZGF0ZVdlbGNvbWVQYWdlKCk7XHJcbiAgICB9KS5vbignY2hhbmdlJywgJy5idG4tdG9nZ2xlIGlucHV0W3R5cGU9Y2hlY2tib3hdJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIHdlbGNvbWUudXBkYXRlV2VsY29tZVBhZ2UoKTtcclxuICAgIH0pLm9uKCdjbGljaycsICcuZWRpdC1wbGFuJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBQTEFOSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YShcImlkXCIpO1xyXG5cclxuICAgICAgJCgnI2VkaXRBY3Rpb25QbGFuSXRlbScpLnZhbCgkKCQodGhpcykuY2xvc2VzdCgndHInKS5jaGlsZHJlbigndGQnKVsyXSkuZmluZCgnc3BhbicpLnRleHQoKSk7XHJcblxyXG4gICAgICAkKCcjZWRpdFBsYW4nKS5vZmYoJ2hpZGRlbi5icy5tb2RhbCcpLm9uKCdoaWRkZW4uYnMubW9kYWwnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICB3ZWxjb21lLnBvcHVsYXRlKCEkKCcjb3V0c3RhbmRpbmdUYXNrcycpLnBhcmVudCgpLmhhc0NsYXNzKFwiYWN0aXZlXCIpKTtcclxuICAgICAgfSkub2ZmKCdzaG93bi5icy5tb2RhbCcpLm9uKCdzaG93bi5icy5tb2RhbCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICQoJyNlZGl0QWN0aW9uUGxhbkl0ZW0nKS5mb2N1cygpO1xyXG4gICAgICB9KS5vZmYoJ2NsaWNrJywgJy5zYXZlLXBsYW4nKS5vbignY2xpY2snLCAnLnNhdmUtcGxhbicsIGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICBsb2cuZWRpdFBsYW4oUExBTklELCAkKCcjZWRpdEFjdGlvblBsYW5JdGVtJykudmFsKCkpO1xyXG5cclxuICAgICAgICAkKCcjZWRpdFBsYW4nKS5tb2RhbCgnaGlkZScpO1xyXG4gICAgICB9KS5vZmYoJ2tleXVwJywgJyNlZGl0QWN0aW9uUGxhbkl0ZW0nKS5vbigna2V5dXAnLCAnI2VkaXRBY3Rpb25QbGFuSXRlbScsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICBpZiAoZS53aGljaCA9PT0gMTMpICQoJyNlZGl0UGxhbiAuc2F2ZS1wbGFuJykuY2xpY2soKTtcclxuICAgICAgfSkubW9kYWwoKTtcclxuICAgIH0pLm9uKCdjbGljaycsICcuZGVsZXRlLXBsYW4nLCBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIFBMQU5JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKFwiaWRcIik7XHJcblxyXG4gICAgICAkKCcjdGVhbS1kZWxldGUtaXRlbScpLmh0bWwoJCgkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuY2hpbGRyZW4oJ3RkJylbMl0pLmZpbmQoJ3NwYW4nKS50ZXh0KCkpO1xyXG5cclxuICAgICAgJCgnI2RlbGV0ZVBsYW4nKS5vZmYoJ2hpZGRlbi5icy5tb2RhbCcpLm9uKCdoaWRkZW4uYnMubW9kYWwnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICB3ZWxjb21lLnBvcHVsYXRlKCEkKCcjb3V0c3RhbmRpbmdUYXNrcycpLnBhcmVudCgpLmhhc0NsYXNzKFwiYWN0aXZlXCIpKTtcclxuICAgICAgfSkub2ZmKCdjbGljaycsICcuZGVsZXRlLXBsYW4nKS5vbignY2xpY2snLCAnLmRlbGV0ZS1wbGFuJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgbG9nLmRlbGV0ZVBsYW4oUExBTklEKTtcclxuXHJcbiAgICAgICAgJCgnI2RlbGV0ZVBsYW4nKS5tb2RhbCgnaGlkZScpO1xyXG4gICAgICB9KS5tb2RhbCgpO1xyXG4gICAgfSkub24oJ2NsaWNrJywgJy5idG4tdW5kbycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgdmFyIEFDVElPTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoJ2lkJyk7XHJcbiAgICAgIHZhciBwYXRpZW50SWQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YSgndGVhbS1vci1wYXRpZW50LWlkJyk7XHJcbiAgICAgIGxvZy5lZGl0QWN0aW9uKHBhdGllbnRJZCwgQUNUSU9OSUQsIG51bGwsIGZhbHNlKTtcclxuICAgICAgJCh0aGlzKS5yZXBsYWNlV2l0aChiYXNlLmNyZWF0ZVBhbmVsKCQoJyNjaGVja2JveC10ZW1wbGF0ZScpLCB7XHJcbiAgICAgICAgXCJkb25lXCI6IGZhbHNlXHJcbiAgICAgIH0pKTtcclxuICAgICAgd2VsY29tZS51cGRhdGVXZWxjb21lUGFnZSgpO1xyXG4gICAgfSkub24oJ2NsaWNrJywgJy5idG4teWVzLC5idG4tbm8nLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIHZhciBjaGVja2JveCA9ICQodGhpcykuZmluZChcImlucHV0W3R5cGU9Y2hlY2tib3hdXCIpO1xyXG4gICAgICB2YXIgb3RoZXIgPSAkKHRoaXMpLnBhcmVudCgpLmZpbmQoJCh0aGlzKS5oYXNDbGFzcyhcImJ0bi15ZXNcIikgPyBcIi5idG4tbm9cIiA6IFwiLmJ0bi15ZXNcIik7XHJcbiAgICAgIHZhciBBQ1RJT05JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKCdpZCcpO1xyXG4gICAgICB2YXIgcGF0aWVudElkID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoJ3RlYW0tb3ItcGF0aWVudC1pZCcpO1xyXG4gICAgICBpZiAoJCh0aGlzKS5oYXNDbGFzcyhcImFjdGl2ZVwiKSAmJiBvdGhlci5oYXNDbGFzcyhcImluYWN0aXZlXCIpICYmICEkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuaGFzQ2xhc3MoJ3N1Y2Nlc3MnKSkge1xyXG4gICAgICAgIC8vdW5zZWxlY3RpbmdcclxuICAgICAgICBpZiAoY2hlY2tib3gudmFsKCkgPT09IFwibm9cIikge1xyXG4gICAgICAgICAgaW5kaXZpZHVhbEFjdGlvblBsYW4ubGF1bmNoTW9kYWwoZGF0YS5zZWxlY3RlZCwgY2hlY2tib3guY2xvc2VzdCgndHInKS5jaGlsZHJlbignOm50aCgyKScpLmZpbmQoJ3NwYW4nKS50ZXh0KCksIGxvZy5nZXRSZWFzb24ocGF0aWVudElkLCBBQ1RJT05JRCksIHRydWUsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBsb2cuZWRpdEFjdGlvbihwYXRpZW50SWQsIEFDVElPTklELCBmYWxzZSwgbnVsbCwgbG9nLnJlYXNvbik7XHJcbiAgICAgICAgICAgIHdlbGNvbWUudXBkYXRlV2VsY29tZVBhZ2UoKTtcclxuICAgICAgICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgICAgICAgfSwgbnVsbCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGxvZy5pZ25vcmVBY3Rpb24ocGF0aWVudElkLCBBQ1RJT05JRCk7XHJcbiAgICAgICAgICAgIG90aGVyLnJlbW92ZUNsYXNzKFwiaW5hY3RpdmVcIik7XHJcbiAgICAgICAgICAgIGNoZWNrYm94LnJlbW92ZUF0dHIoXCJjaGVja2VkXCIpO1xyXG4gICAgICAgICAgICBjaGVja2JveC5wYXJlbnQoKS5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgd2VsY29tZS51cGRhdGVXZWxjb21lUGFnZSgpO1xyXG4gICAgICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGxvZy5pZ25vcmVBY3Rpb24ocGF0aWVudElkLCBBQ1RJT05JRCk7XHJcbiAgICAgICAgICBvdGhlci5yZW1vdmVDbGFzcyhcImluYWN0aXZlXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIGlmICgoISQodGhpcykuaGFzQ2xhc3MoXCJhY3RpdmVcIikgJiYgb3RoZXIuaGFzQ2xhc3MoXCJhY3RpdmVcIikpIHx8ICQodGhpcykuY2xvc2VzdCgndHInKS5oYXNDbGFzcygnc3VjY2VzcycpKSB7XHJcbiAgICAgICAgLy9wcmV2ZW50IGNsaWNraW5nIG9uIHVuc2VsZWN0ZWQgb3B0aW9uIG9yIGlmIHRoZSByb3cgaXMgY29tcGxldGVcclxuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy9zZWxlY3RpbmdcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgaWYgKGNoZWNrYm94LnZhbCgpID09PSBcIm5vXCIpIHtcclxuICAgICAgICAgIGluZGl2aWR1YWxBY3Rpb25QbGFuLmxhdW5jaE1vZGFsKGRhdGEuc2VsZWN0ZWQsIGNoZWNrYm94LmNsb3Nlc3QoJ3RyJykuY2hpbGRyZW4oJzpudGgoMiknKS5maW5kKCdzcGFuJykudGV4dCgpLCBsb2cuZ2V0UmVhc29uKHBhdGllbnRJZCwgQUNUSU9OSUQpLCBmYWxzZSwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGxvZy5lZGl0QWN0aW9uKHBhdGllbnRJZCwgQUNUSU9OSUQsIGZhbHNlLCBudWxsLCBsb2cucmVhc29uKTtcclxuICAgICAgICAgICAgJChzZWxmKS5yZW1vdmVDbGFzcyhcImluYWN0aXZlXCIpO1xyXG5cclxuICAgICAgICAgICAgY2hlY2tib3guYXR0cihcImNoZWNrZWRcIiwgXCJjaGVja2VkXCIpO1xyXG4gICAgICAgICAgICBjaGVja2JveC5wYXJlbnQoKS5hZGRDbGFzcyhcImFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgLy91bnNlbGVjdCBvdGhlclxyXG4gICAgICAgICAgICBvdGhlci5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKS5hZGRDbGFzcyhcImluYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICBvdGhlci5maW5kKFwiaW5wdXRbdHlwZT1jaGVja2JveF1cIikucHJvcChcImNoZWNrZWRcIiwgZmFsc2UpO1xyXG4gICAgICAgICAgICB3ZWxjb21lLnVwZGF0ZVdlbGNvbWVQYWdlKCk7XHJcbiAgICAgICAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgbG9nLmVkaXRBY3Rpb24ocGF0aWVudElkLCBBQ1RJT05JRCwgdHJ1ZSk7XHJcbiAgICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKFwiaW5hY3RpdmVcIik7XHJcblxyXG4gICAgICAgICAgLy91bnNlbGVjdCBvdGhlclxyXG4gICAgICAgICAgb3RoZXIucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIikuYWRkQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuICAgICAgICAgIG90aGVyLmZpbmQoXCJpbnB1dFt0eXBlPWNoZWNrYm94XVwiKS5wcm9wKFwiY2hlY2tlZFwiLCBmYWxzZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICB3ZWxjb21lLnVwZGF0ZVdlbGNvbWVQYWdlKCk7XHJcbiAgfSxcclxuXHJcbiAgdXBkYXRlV2VsY29tZVBhZ2U6IGZ1bmN0aW9uKCkge1xyXG4gICAgJCgnI3RlYW0tdGFzay1wYW5lbCcpLmFkZCgnI2luZGl2aWR1YWwtdGFzay1wYW5lbCcpLmZpbmQoJy5zdWdnZXN0aW9uJykuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgJCh0aGlzKS5maW5kKCd0ZCcpLmxhc3QoKS5jaGlsZHJlbigpLmhpZGUoKTtcclxuICAgIH0pO1xyXG5cclxuICAgICQoJyN0ZWFtLXRhc2stcGFuZWwnKS5hZGQoJyNpbmRpdmlkdWFsLXRhc2stcGFuZWwnKS5maW5kKCcuY3Itc3R5bGVkIGlucHV0W3R5cGU9Y2hlY2tib3hdJykuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgaWYgKHRoaXMuY2hlY2tlZCkge1xyXG4gICAgICAgICQodGhpcykucGFyZW50KCkucGFyZW50KCkucGFyZW50KCkuYWRkQ2xhc3MoJ3N1Y2Nlc3MnKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAkKHRoaXMpLnBhcmVudCgpLnBhcmVudCgpLnBhcmVudCgpLnJlbW92ZUNsYXNzKCdzdWNjZXNzJyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgICQoJyN0ZWFtLXRhc2stcGFuZWwnKS5hZGQoJyNpbmRpdmlkdWFsLXRhc2stcGFuZWwnKS5maW5kKCcuYnRuLXVuZG8nKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICAkKHRoaXMpLnBhcmVudCgpLnBhcmVudCgpLmFkZENsYXNzKCdzdWNjZXNzJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvL25vIGNsYXNzIC0gdXNlciBub3QgeWV0IGFncmVlZC9kaXNhZ3JlZWQgLSBubyBiYWNrZ3JvdW5kIC8gbXV0ZWQgdGV4dFxyXG4gICAgLy9hY3RpdmUgLSB1c2VyIGFncmVlcyAtIGdyZWVuIGJhY2tncm91bmQgLyBub3JtYWwgdGV4dFxyXG4gICAgLy9zdWNjZXNzIC0gdXNlciBjb21wbGV0ZWQgLSBncmVlbiBiYWNrZ3JvdW5kIC8gc3RyaWtldGhyb3VnaCB0ZXh0XHJcbiAgICAvL2RhbmdlciAtIHVzZXIgZGlzYWdyZWVzIC0gcmVkIGJhY2tncm91bmQgLyBzdHJpa2V0aHJvdWdoIHRleHRcclxuICAgICQoJyN0ZWFtLXRhc2stcGFuZWwnKS5hZGQoJyNpbmRpdmlkdWFsLXRhc2stcGFuZWwnKS5maW5kKCd0cicpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBzZWxmID0gJCh0aGlzKTtcclxuICAgICAgdmFyIGFueSA9IGZhbHNlO1xyXG4gICAgICBzZWxmLmZpbmQoJy5idG4tdG9nZ2xlIGlucHV0W3R5cGU9Y2hlY2tib3hdOmNoZWNrZWQnKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGFueSA9IHRydWU7XHJcbiAgICAgICAgaWYgKHRoaXMudmFsdWUgPT09IFwieWVzXCIpIHtcclxuICAgICAgICAgIHNlbGYucmVtb3ZlQ2xhc3MoJ2RhbmdlcicpO1xyXG4gICAgICAgICAgc2VsZi5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgICBzZWxmLmZpbmQoJ3RkJykubGFzdCgpLmNoaWxkcmVuKCkuc2hvdygpO1xyXG4gICAgICAgICAgaWYgKGxvZy5nZXRBY3Rpb25zKCkudGVhbVtzZWxmLmRhdGEoXCJpZFwiKV0gJiYgbG9nLmdldEFjdGlvbnMoKS50ZWFtW3NlbGYuZGF0YShcImlkXCIpXS5oaXN0b3J5KSB7XHJcbiAgICAgICAgICAgIHZhciB0b29sID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmhhc0NsYXNzKCdzdWNjZXNzJykgPyBcIlwiIDogXCI8cD5cIiArIGxvZy5nZXRBY3Rpb25zKCkudGVhbVtzZWxmLmRhdGEoXCJpZFwiKV0uaGlzdG9yeVswXSArIFwiPC9wPjxwPkNsaWNrIGFnYWluIHRvIGNhbmNlbDwvcD5cIjtcclxuICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5hdHRyKFwidGl0bGVcIiwgdG9vbCkuYXR0cihcImRhdGEtb3JpZ2luYWwtdGl0bGVcIiwgdG9vbCkudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAkKHRoaXMpLnBhcmVudCgpLmF0dHIoXCJ0aXRsZVwiLCBcIllvdSBhZ3JlZWQgLSBjbGljayBhZ2FpbiB0byBjYW5jZWxcIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHNlbGYucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgc2VsZi5hZGRDbGFzcygnZGFuZ2VyJyk7XHJcbiAgICAgICAgICBzZWxmLnJlbW92ZUNsYXNzKCdzdWNjZXNzJyk7XHJcbiAgICAgICAgICBpZiAobG9nLmdldEFjdGlvbnMoKS50ZWFtW3NlbGYuZGF0YShcImlkXCIpXSAmJiBsb2cuZ2V0QWN0aW9ucygpLnRlYW1bc2VsZi5kYXRhKFwiaWRcIildLmhpc3RvcnkpIHtcclxuICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5hdHRyKFwidGl0bGVcIiwgXCI8cD5cIiArIGxvZy5nZXRBY3Rpb25zKCkudGVhbVtzZWxmLmRhdGEoXCJpZFwiKV0uaGlzdG9yeVswXSArIFwiPC9wPjxwPkNsaWNrIGFnYWluIHRvIGVkaXQvY2FuY2VsPC9wPlwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICQodGhpcykucGFyZW50KCkuYXR0cihcInRpdGxlXCIsIFwiWW91IGRpc2FncmVlZCAtIGNsaWNrIGFnYWluIHRvIGVkaXQvY2FuY2VsXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICAgIGlmIChzZWxmLmZpbmQoJy5idG4tdG9nZ2xlIGlucHV0W3R5cGU9Y2hlY2tib3hdOm5vdCg6Y2hlY2tlZCknKS5sZW5ndGggPT0gMSkge1xyXG4gICAgICAgIHNlbGYuZmluZCgnLmJ0bi10b2dnbGUgaW5wdXRbdHlwZT1jaGVja2JveF06bm90KDpjaGVja2VkKScpLnBhcmVudCgpLmFkZENsYXNzKFwiaW5hY3RpdmVcIikuYXR0cihcInRpdGxlXCIsIFwiXCIpLmF0dHIoXCJkYXRhLW9yaWdpbmFsLXRpdGxlXCIsIFwiXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICghYW55KSB7XHJcbiAgICAgICAgc2VsZi5yZW1vdmVDbGFzcygnZGFuZ2VyJyk7XHJcbiAgICAgICAgc2VsZi5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgc2VsZi5yZW1vdmVDbGFzcygnc3VjY2VzcycpO1xyXG5cclxuICAgICAgICBzZWxmLmZpbmQoJy5idG4tdG9nZ2xlLmJ0bi15ZXMnKS5hdHRyKFwidGl0bGVcIiwgXCJDbGljayB0byBhZ3JlZSB3aXRoIHRoaXMgYWN0aW9uIGFuZCBzYXZlIGl0IGluIHlvdXIgYWdyZWVkIGFjdGlvbnMgbGlzdCAgXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgIHNlbGYuZmluZCgnLmJ0bi10b2dnbGUuYnRuLW5vJykuYXR0cihcInRpdGxlXCIsIFwiQ2xpY2sgdG8gZGlzYWdyZWUgd2l0aCB0aGlzIGFjdGlvbiBhbmQgcmVtb3ZlIGl0IGZyb20geW91ciBzdWdnZXN0ZWQgYWN0aW9ucyBsaXN0IFwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gIH0sXHJcblxyXG4gIHBvcHVsYXRlOiBmdW5jdGlvbihjb21wbGV0ZSkge1xyXG5cclxuICAgIHZhciBrLGw7XHJcbiAgICAvL2FkZCB0YXNrc1xyXG4gICAgdmFyIHRlYW1UYXNrcyA9IFtdO1xyXG4gICAgdmFyIGluZGl2aWR1YWxUYXNrcyA9IFtdO1xyXG5cclxuICAgIC8vQWRkIHRoZSB0ZWFtIHRhc2tzXHJcbiAgICBmb3IgKGsgaW4gbG9nLmxpc3RBY3Rpb25zKFwidGVhbVwiKSkge1xyXG4gICAgICBpZiAobG9nLmxpc3RBY3Rpb25zKFwidGVhbVwiKVtrXS5hZ3JlZSAmJiAoKCFsb2cubGlzdEFjdGlvbnMoXCJ0ZWFtXCIpW2tdLmRvbmUgJiYgIWNvbXBsZXRlKSB8fCAobG9nLmxpc3RBY3Rpb25zKFwidGVhbVwiKVtrXS5kb25lICYmIGNvbXBsZXRlKSkpIHtcclxuICAgICAgICB0ZWFtVGFza3MucHVzaCh7XHJcbiAgICAgICAgICBcInBhdGh3YXlcIjogXCJOL0FcIixcclxuICAgICAgICAgIFwidGFza1wiOiBsb2cudGV4dFtsb2cubGlzdEFjdGlvbnMoXCJ0ZWFtXCIpW2tdLmlkXS50ZXh0LFxyXG4gICAgICAgICAgXCJkYXRhXCI6IGxvZy5saXN0QWN0aW9ucyhcInRlYW1cIilba10uaWQsXHJcbiAgICAgICAgICBcInRwSWRcIjogXCJ0ZWFtXCIsXHJcbiAgICAgICAgICBcImFncmVlXCI6IHRydWUsXHJcbiAgICAgICAgICBcImRvbmVcIjogY29tcGxldGVcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vQWRkIHRoZSB1c2VyIGFkZGVkIHRlYW0gdGFza3NcclxuICAgIGZvciAoayBpbiBsb2cubGlzdFBsYW5zKFwidGVhbVwiKSkge1xyXG4gICAgICBpZiAoKCFsb2cubGlzdFBsYW5zKFwidGVhbVwiKVtrXS5kb25lICYmICFjb21wbGV0ZSkgfHwgKGxvZy5saXN0UGxhbnMoXCJ0ZWFtXCIpW2tdLmRvbmUgJiYgY29tcGxldGUpKSB7XHJcbiAgICAgICAgdGVhbVRhc2tzLnB1c2goe1xyXG4gICAgICAgICAgXCJjYW5FZGl0XCI6IHRydWUsXHJcbiAgICAgICAgICBcInBhdGh3YXlcIjogZGF0YS5wYXRod2F5TmFtZXNbbG9nLmxpc3RQbGFucyhcInRlYW1cIilba10ucGF0aHdheUlkXSxcclxuICAgICAgICAgIFwicGF0aHdheUlkXCI6IGxvZy5saXN0UGxhbnMoXCJ0ZWFtXCIpW2tdLnBhdGh3YXlJZCxcclxuICAgICAgICAgIFwidGFza1wiOiBsb2cubGlzdFBsYW5zKFwidGVhbVwiKVtrXS50ZXh0LFxyXG4gICAgICAgICAgXCJkYXRhXCI6IGxvZy5saXN0UGxhbnMoXCJ0ZWFtXCIpW2tdLmlkLFxyXG4gICAgICAgICAgXCJhZ3JlZVwiOiBsb2cubGlzdFBsYW5zKFwidGVhbVwiKVtrXS5hZ3JlZSxcclxuICAgICAgICAgIFwiZGlzYWdyZWVcIjogbG9nLmxpc3RQbGFucyhcInRlYW1cIilba10uYWdyZWUgPT09IGZhbHNlLFxyXG4gICAgICAgICAgXCJkb25lXCI6IGNvbXBsZXRlXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvL0FkZCBpbmRpdmlkdWFsXHJcbiAgICBmb3IgKGsgaW4gbG9nLmxpc3RBY3Rpb25zKCkpIHtcclxuICAgICAgaWYgKGsgPT09IFwidGVhbVwiKSBjb250aW51ZTtcclxuICAgICAgZm9yIChsIGluIGxvZy5saXN0QWN0aW9ucygpW2tdKSB7XHJcbiAgICAgICAgaWYgKGxvZy50ZXh0W2xdICYmIGxvZy5saXN0QWN0aW9ucygpW2tdW2xdLmFncmVlICYmICgoIWxvZy5saXN0QWN0aW9ucygpW2tdW2xdLmRvbmUgJiYgIWNvbXBsZXRlKSB8fCAobG9nLmxpc3RBY3Rpb25zKClba11bbF0uZG9uZSAmJiBjb21wbGV0ZSkpKSB7XHJcbiAgICAgICAgICBpbmRpdmlkdWFsVGFza3MucHVzaCh7XHJcbiAgICAgICAgICAgIFwicGF0aHdheVwiOiBcIk4vQVwiLFxyXG4gICAgICAgICAgICBcInBhdGllbnRJZFwiOiBrLFxyXG4gICAgICAgICAgICBcInRhc2tcIjogbG9nLnRleHRbbF0udGV4dCxcclxuICAgICAgICAgICAgXCJwYXRod2F5SWRcIjogbG9nLmxpc3RQbGFucygpW2tdW2xdLnBhdGh3YXlJZCxcclxuICAgICAgICAgICAgXCJkYXRhXCI6IGwsXHJcbiAgICAgICAgICAgIFwidHBJZFwiOiBrLFxyXG4gICAgICAgICAgICBcImFncmVlXCI6IHRydWUsXHJcbiAgICAgICAgICAgIFwiZG9uZVwiOiBjb21wbGV0ZVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy9BZGQgY3VzdG9tIGluZGl2aWR1YWxcclxuICAgIGZvciAoayBpbiBsb2cubGlzdFBsYW5zKCkpIHtcclxuICAgICAgaWYgKGsgPT09IFwidGVhbVwiKSBjb250aW51ZTtcclxuICAgICAgZm9yIChsIGluIGxvZy5saXN0UGxhbnMoKVtrXSkge1xyXG4gICAgICAgIGlmIChsb2cubGlzdFBsYW5zKClba11bbF0udGV4dCAmJiAoIWxvZy5saXN0UGxhbnMoKVtrXVtsXS5kb25lICYmICFjb21wbGV0ZSkgfHwgKGxvZy5saXN0UGxhbnMoKVtrXVtsXS5kb25lICYmIGNvbXBsZXRlKSkge1xyXG4gICAgICAgICAgaW5kaXZpZHVhbFRhc2tzLnB1c2goe1xyXG4gICAgICAgICAgICBcImNhbkVkaXRcIjogdHJ1ZSxcclxuICAgICAgICAgICAgXCJwYXRod2F5XCI6IGRhdGEucGF0aHdheU5hbWVzW2xvZy5saXN0UGxhbnMoKVtrXVtsXS5wYXRod2F5SWRdLFxyXG4gICAgICAgICAgICBcInBhdGh3YXlJZFwiOiBsb2cubGlzdFBsYW5zKClba11bbF0ucGF0aHdheUlkLFxyXG4gICAgICAgICAgICBcInBhdGllbnRJZFwiOiBrLFxyXG4gICAgICAgICAgICBcInRwSWRcIjogayxcclxuICAgICAgICAgICAgXCJ0YXNrXCI6IGxvZy5saXN0UGxhbnMoKVtrXVtsXS50ZXh0LFxyXG4gICAgICAgICAgICBcImRhdGFcIjogbCxcclxuICAgICAgICAgICAgXCJhZ3JlZVwiOiB0cnVlLFxyXG4gICAgICAgICAgICBcImRvbmVcIjogY29tcGxldGVcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHZhciBsaXN0VGVtcGxhdGUgPSAkKCcjd2VsY29tZS10YXNrLWxpc3QnKS5odG1sKCk7XHJcbiAgICBNdXN0YWNoZS5wYXJzZShsaXN0VGVtcGxhdGUpO1xyXG4gICAgJCgnI3dlbGNvbWUtdGFiLWNvbnRlbnQnKS5odG1sKE11c3RhY2hlLnJlbmRlcihsaXN0VGVtcGxhdGUpKTtcclxuXHJcbiAgICB2YXIgYWRkVGVtcGxhdGUgPSAkKCcjYWN0aW9uLXBsYW4nKS5odG1sKCk7XHJcbiAgICBNdXN0YWNoZS5wYXJzZShhZGRUZW1wbGF0ZSk7XHJcbiAgICB2YXIgcmVuZGVyZWQgPSBNdXN0YWNoZS5yZW5kZXIoYWRkVGVtcGxhdGUpO1xyXG4gICAgJCgnI3RlYW0tYWRkLXBsYW4nKS5odG1sKHJlbmRlcmVkKTtcclxuXHJcbiAgICB2YXIgdGVtcE11c3QgPSAkKCcjd2VsY29tZS10YXNrLWl0ZW1zJykuaHRtbCgpO1xyXG4gICAgdmFyIGl0ZW1UZW1wbGF0ZSA9ICQoJyN3ZWxjb21lLXRhc2staXRlbScpLmh0bWwoKTtcclxuICAgIE11c3RhY2hlLnBhcnNlKHRlbXBNdXN0KTtcclxuICAgIE11c3RhY2hlLnBhcnNlKGl0ZW1UZW1wbGF0ZSk7XHJcblxyXG4gICAgJCgnI3RlYW0tYWRkLXBsYW4nKS5vZmYoJ2NsaWNrJykub24oJ2NsaWNrJywgJy5hZGQtcGxhbicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgcGxhbiA9ICQodGhpcykucGFyZW50KCkucGFyZW50KCkuZmluZCgndGV4dGFyZWEnKS52YWwoKTtcclxuICAgICAgdmFyIHBsYW5JZCA9IHJlY29yZFBsYW4oXCJ0ZWFtXCIsIHBsYW4sIFwiY3VzdG9tXCIpO1xyXG4gICAgICAkKCcjdGVhbS10YXNrLXBhbmVsJykuZmluZCgndGFibGUgdGJvZHknKS5hcHBlbmQoTXVzdGFjaGUucmVuZGVyKGl0ZW1UZW1wbGF0ZSwge1xyXG4gICAgICAgIFwicGF0aHdheVwiOiBcIlwiLFxyXG4gICAgICAgIFwicGF0aHdheUlkXCI6IFwiY3VzdG9tXCIsXHJcbiAgICAgICAgXCJjYW5FZGl0XCI6IHRydWUsXHJcbiAgICAgICAgXCJ0YXNrXCI6IHBsYW4sXHJcbiAgICAgICAgXCJkYXRhXCI6IHBsYW5JZCxcclxuICAgICAgICBcImFncmVlXCI6IG51bGwsXHJcbiAgICAgICAgXCJkb25lXCI6IG51bGxcclxuICAgICAgfSwge1xyXG4gICAgICAgIFwiY2hrXCI6ICQoJyNjaGVja2JveC10ZW1wbGF0ZScpLmh0bWwoKVxyXG4gICAgICB9KSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZW5kZXJlZCA9IE11c3RhY2hlLnJlbmRlcih0ZW1wTXVzdCwge1xyXG4gICAgICBcInRhc2tzXCI6IHRlYW1UYXNrcyxcclxuICAgICAgXCJoYXNUYXNrc1wiOiB0ZWFtVGFza3MubGVuZ3RoID4gMFxyXG4gICAgfSwge1xyXG4gICAgICBcInRhc2staXRlbVwiOiBpdGVtVGVtcGxhdGUsXHJcbiAgICAgIFwiY2hrXCI6ICQoJyNjaGVja2JveC10ZW1wbGF0ZScpLmh0bWwoKVxyXG4gICAgfSk7XHJcbiAgICAkKCcjdGVhbS10YXNrLXBhbmVsJykuY2hpbGRyZW4oKS5ub3QoXCI6Zmlyc3RcIikucmVtb3ZlKCk7XHJcbiAgICAkKCcjdGVhbS10YXNrLXBhbmVsJykuYXBwZW5kKHJlbmRlcmVkKTtcclxuXHJcbiAgICByZW5kZXJlZCA9IE11c3RhY2hlLnJlbmRlcih0ZW1wTXVzdCwge1xyXG4gICAgICBcInRhc2tzXCI6IGluZGl2aWR1YWxUYXNrcyxcclxuICAgICAgXCJpc1BhdGllbnRUYWJsZVwiOiB0cnVlLFxyXG4gICAgICBcImhhc1Rhc2tzXCI6IGluZGl2aWR1YWxUYXNrcy5sZW5ndGggPiAwXHJcbiAgICB9LCB7XHJcbiAgICAgIFwidGFzay1pdGVtXCI6IGl0ZW1UZW1wbGF0ZSxcclxuICAgICAgXCJjaGtcIjogJCgnI2NoZWNrYm94LXRlbXBsYXRlJykuaHRtbCgpXHJcbiAgICB9KTtcclxuICAgICQoJyNpbmRpdmlkdWFsLXRhc2stcGFuZWwnKS5jaGlsZHJlbigpLm5vdChcIjpmaXJzdFwiKS5yZW1vdmUoKTtcclxuICAgICQoJyNpbmRpdmlkdWFsLXRhc2stcGFuZWwnKS5hcHBlbmQocmVuZGVyZWQpO1xyXG5cclxuICAgIHdlbGNvbWUud2lyZVVwV2VsY29tZVBhZ2UoKTtcclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSB3ZWxjb21lO1xyXG4iLCJ2YXIgZGF0YSA9IHJlcXVpcmUoJy4uL2RhdGEuanMnKSxcclxuICBjaGFydCA9IHJlcXVpcmUoJy4uL2NoYXJ0LmpzJyk7XHJcblxyXG52YXIgYmQgPSB7XHJcblxyXG4gIHdpcmVVcDogZnVuY3Rpb24oKSB7XHJcblxyXG4gIH0sXHJcblxyXG4gIHNob3c6IGZ1bmN0aW9uKHBhbmVsLCBpc0FwcGVuZCwgc3ViUGFuZWxzLCBpc0Rvd25UZXh0LCBpc1VwVGV4dCkge1xyXG5cclxuICAgIHZhciBzZWN0aW9uRWxlbWVudCA9ICQoJzxkaXYgY2xhc3M9XCJzZWN0aW9uXCI+PC9kaXY+Jyk7XHJcblxyXG4gICAgaWYgKGlzQXBwZW5kKSBwYW5lbC5hcHBlbmQoc2VjdGlvbkVsZW1lbnQpO1xyXG4gICAgZWxzZSBwYW5lbC5odG1sKHNlY3Rpb25FbGVtZW50KTtcclxuXHJcbiAgICBzdWJQYW5lbHMuZm9yRWFjaChmdW5jdGlvbih2KSB7XHJcbiAgICAgIHZhciBhcmdzID0gdi5hcmdzO1xyXG4gICAgICBhcmdzLnVuc2hpZnQodHJ1ZSk7XHJcbiAgICAgIGFyZ3MudW5zaGlmdChzZWN0aW9uRWxlbWVudCk7XHJcbiAgICAgIHYuc2hvdy5hcHBseShudWxsLCBhcmdzKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChpc1VwVGV4dCkgc2VjdGlvbkVsZW1lbnQucHJlcGVuZCgkKCc8ZGl2IGNsYXNzPVwiZnAtY29udHJvbEFycm93IGZwLXVwXCI+PGRpdj4nICsgaXNVcFRleHQgKyAnPC9kaXY+PC9kaXY+JykpO1xyXG4gICAgaWYgKGlzRG93blRleHQpIHNlY3Rpb25FbGVtZW50LmFwcGVuZCgkKCc8ZGl2IGNsYXNzPVwiZnAtY29udHJvbEFycm93IGZwLWRvd25cIj48ZGl2PicgKyBpc0Rvd25UZXh0ICsgJzwvZGl2PjwvZGl2PicpKTtcclxuXHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gYmQ7XHJcbiIsInZhciBkYXRhID0gcmVxdWlyZSgnLi9kYXRhLmpzJyksXHJcbiAgbG9va3VwID0gcmVxdWlyZSgnLi9sb29rdXAuanMnKSxcclxuICBiYXNlID0gcmVxdWlyZSgnLi9iYXNlLmpzJyksXHJcbiAgcGF0aWVudHMgPSByZXF1aXJlKCcuL3BhbmVscy9wYXRpZW50cy5qcycpLFxyXG4gIHBhdGllbnRMaXN0ID0gcmVxdWlyZSgnLi9wYW5lbHMvcGF0aWVudExpc3QuanMnKSxcclxuICB0ZWFtQWN0aW9uUGxhbiA9IHJlcXVpcmUoJy4vcGFuZWxzL3RlYW1BY3Rpb25QbGFuLmpzJyksXHJcbiAgYWxsUGF0aWVudHMgPSByZXF1aXJlKCcuL3BhbmVscy9hbGxQYXRpZW50cy5qcycpLFxyXG4gIHdlbGNvbWUgPSByZXF1aXJlKCcuL3BhbmVscy93ZWxjb21lLmpzJyksXHJcbiAgbGF5b3V0ID0gcmVxdWlyZSgnLi9sYXlvdXQuanMnKSxcclxuICBvdmVydmlldyA9IHJlcXVpcmUoJy4vdmlld3Mvb3ZlcnZpZXcuanMnKSxcclxuICBpbmRpY2F0b3JWaWV3ID0gcmVxdWlyZSgnLi92aWV3cy9pbmRpY2F0b3IuanMnKSxcclxuICBwYXRpZW50VmlldyA9IHJlcXVpcmUoJy4vdmlld3MvcGF0aWVudC5qcycpLFxyXG4gIGFjdGlvblBsYW4gPSByZXF1aXJlKCcuL3ZpZXdzL2FjdGlvbnMuanMnKSxcclxuICBNdXN0YWNoZSA9IHJlcXVpcmUoJ211c3RhY2hlJyk7XHJcblxyXG52YXIgdGVtcGxhdGUgPSB7XHJcblxyXG4gIGxvYWRDb250ZW50OiBmdW5jdGlvbihoYXNoLCBpc1BvcHBpbmdTdGF0ZSkge1xyXG4gICAgYmFzZS5oaWRlVG9vbHRpcHMoKTtcclxuXHJcbiAgICB2YXIgaSwgcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBpbmRpY2F0b3IsIHBhdGllbnRJZDtcclxuICAgIGlmICghaXNQb3BwaW5nU3RhdGUpIHtcclxuICAgICAgd2luZG93LmxvY2F0aW9uLmhhc2ggPSBoYXNoO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChoYXNoID09PSAnJykge1xyXG4gICAgICBiYXNlLmNsZWFyQm94KCk7XHJcbiAgICAgIGJhc2Uuc2hvd0Zvb3RlcigpO1xyXG4gICAgICBsYXlvdXQuc2hvd1BhZ2UoJ2xvZ2luJyk7XHJcbiAgICAgICQoJ2h0bWwnKS5yZW1vdmVDbGFzcygnc2Nyb2xsLWJhcicpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgYmFzZS5oaWRlRm9vdGVyKCk7XHJcbiAgICAgICQoJ2h0bWwnKS5hZGRDbGFzcygnc2Nyb2xsLWJhcicpO1xyXG4gICAgICB2YXIgcGFyYW1zID0ge307XHJcbiAgICAgIHZhciB1cmxCaXRzID0gaGFzaC5zcGxpdCgnLycpO1xyXG5cclxuICAgICAgaWYgKGhhc2guaW5kZXhPZignPycpID4gLTEpIHtcclxuICAgICAgICBoYXNoLnNwbGl0KCc/JylbMV0uc3BsaXQoJyYnKS5mb3JFYWNoKGZ1bmN0aW9uKHBhcmFtKSB7XHJcbiAgICAgICAgICB2YXIgZWxlbXMgPSBwYXJhbS5zcGxpdChcIj1cIik7XHJcbiAgICAgICAgICBwYXJhbXNbZWxlbXNbMF1dID0gZWxlbXNbMV07XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdXJsQml0cyA9IGhhc2guc3BsaXQoJz8nKVswXS5zcGxpdCgnLycpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAodXJsQml0c1swXSA9PT0gXCIjb3ZlcnZpZXdcIiAmJiAhdXJsQml0c1sxXSkge1xyXG5cclxuICAgICAgICBvdmVydmlldy5jcmVhdGUodGVtcGxhdGUubG9hZENvbnRlbnQpO1xyXG5cclxuICAgICAgfSBlbHNlIGlmICh1cmxCaXRzWzBdID09PSBcIiNpbmRpY2F0b3JzXCIpIHtcclxuXHJcbiAgICAgICAgaW5kaWNhdG9yVmlldy5jcmVhdGUodXJsQml0c1sxXSwgdXJsQml0c1syXSwgdXJsQml0c1szXSwgcGFyYW1zLnRhYiB8fCBcInRyZW5kXCIsIHRlbXBsYXRlLmxvYWRDb250ZW50KTtcclxuXHJcbiAgICAgIH0gZWxzZSBpZiAodXJsQml0c1swXSA9PT0gXCIjbWFpblwiKSB7XHJcbiAgICAgICAgYmFzZS5jbGVhckJveCgpO1xyXG4gICAgICAgIHBhdGh3YXlJZCA9IHVybEJpdHNbMV07XHJcbiAgICAgICAgZGF0YS5wYXRod2F5SWQgPSBwYXRod2F5SWQ7XHJcbiAgICAgICAgcGF0aHdheVN0YWdlID0gdXJsQml0c1syXTtcclxuICAgICAgICB2YXIgeWVzUGVvcGxlID0gdXJsQml0c1szXSAhPT0gXCJub1wiO1xyXG4gICAgICAgIHN0YW5kYXJkID0gdXJsQml0c1s0XTtcclxuXHJcbiAgICAgICAgaWYgKHBhdGh3YXlTdGFnZSAmJiBsYXlvdXQucGFnZSAhPT0gJ21haW4tZGFzaGJvYXJkJykge1xyXG4gICAgICAgICAgJCgnLnBhZ2UnKS5oaWRlKCk7XHJcbiAgICAgICAgICAkKCcjbWFpbi1kYXNoYm9hcmQnKS5zaG93KCk7XHJcblxyXG4gICAgICAgICAgLy8vL2xheW91dC5zaG93U2lkZVBhbmVsKCk7XHJcbiAgICAgICAgICBsYXlvdXQuc2hvd092ZXJ2aWV3UGFuZWxzKCk7XHJcbiAgICAgICAgICBsYXlvdXQuc2hvd0hlYWRlckJhckl0ZW1zKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAocGF0aHdheVN0YWdlKSB7XHJcbiAgICAgICAgICBpZiAoeWVzUGVvcGxlKSB7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlLnNob3dQYXRod2F5U3RhZ2VWaWV3T2socGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHRlbXBsYXRlLnNob3VsZFdlRmFkZShsb29rdXAuY3VycmVudFVybCwgaGFzaCkpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGVtcGxhdGUuc2hvd1BhdGh3YXlTdGFnZVZpZXcocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCB0ZW1wbGF0ZS5zaG91bGRXZUZhZGUobG9va3VwLmN1cnJlbnRVcmwsIGhhc2gpKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgdGVtcGxhdGUuc2hvd092ZXJ2aWV3KHBhdGh3YXlJZCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcblxyXG4gICAgICB9IGVsc2UgaWYgKHVybEJpdHNbMF0gPT09IFwiI2hlbHBcIikge1xyXG4gICAgICAgIGJhc2UuY2xlYXJCb3goKTtcclxuICAgICAgICBiYXNlLnNlbGVjdFRhYihcIlwiKTtcclxuICAgICAgICBsYXlvdXQuc2hvd1BhZ2UoJ2hlbHAtcGFnZScpO1xyXG5cclxuICAgICAgICBsYXlvdXQuc2hvd0hlYWRlckJhckl0ZW1zKCk7XHJcblxyXG4gICAgICB9IGVsc2UgaWYgKHVybEJpdHNbMF0gPT09IFwiI3BhdGllbnRcIikge1xyXG5cclxuICAgICAgICAvL2NyZWF0ZShwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZClcclxuICAgICAgICBwYXRpZW50Vmlldy5jcmVhdGUodXJsQml0c1syXSwgdXJsQml0c1szXSwgdXJsQml0c1s0XSwgdXJsQml0c1sxXSwgdGVtcGxhdGUubG9hZENvbnRlbnQpO1xyXG5cclxuICAgICAgfSBlbHNlIGlmICh1cmxCaXRzWzBdID09PSBcIiNwYXRpZW50c1wiKSB7XHJcblxyXG4gICAgICAgIHBhdGllbnRJZCA9IHVybEJpdHNbMV07XHJcblxyXG4gICAgICAgIHBhdGllbnRWaWV3LmNyZWF0ZShudWxsLCBudWxsLCBudWxsLCBwYXRpZW50SWQsIHRlbXBsYXRlLmxvYWRDb250ZW50KTtcclxuICAgICAgICAvKnBhdGh3YXlJZCA9IHVybEJpdHNbMl07XHJcblxyXG4gICAgICAgIGFsbFBhdGllbnRzLnNob3dWaWV3KHBhdGllbnRJZCwgdHJ1ZSk7XHJcblxyXG4gICAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuXHJcbiAgICAgICAgaWYgKHBhdGllbnRJZCkge1xyXG4gICAgICAgICAgdmFyIG5ocyA9IGRhdGEucGF0TG9va3VwID8gZGF0YS5wYXRMb29rdXBbcGF0aWVudElkXSA6IHBhdGllbnRJZDtcclxuICAgICAgICAgICQoJyNwYXRpZW50cycpLmZpbmQoJ2Rpdi50YWJsZS1zY3JvbGwnKS5nZXROaWNlU2Nyb2xsKCkuZG9TY3JvbGxQb3MoMCwgJCgnI3BhdGllbnRzIHRkJykuZmlsdGVyKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJCh0aGlzKS50ZXh0KCkudHJpbSgpID09PSBuaHM7XHJcbiAgICAgICAgICB9KS5wb3NpdGlvbigpLnRvcCAtIDE0MCk7XHJcbiAgICAgICAgICAkKCcjcGF0aWVudHMnKS5maW5kKCd0cjpjb250YWlucygnICsgbmhzICsgJyknKS5hZGRDbGFzcyhcImhpZ2hsaWdodGVkXCIpO1xyXG4gICAgICAgIH0qL1xyXG4gICAgICB9IGVsc2UgaWYgKHVybEJpdHNbMF0gPT09IFwiI2FncmVlZGFjdGlvbnNcIikge1xyXG5cclxuICAgICAgICBhY3Rpb25QbGFuLmNyZWF0ZSgpO1xyXG5cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvL2lmIHNjcmVlbiBub3QgaW4gY29ycmVjdCBzZWdtZW50IHRoZW4gc2VsZWN0IGl0XHJcbiAgICAgICAgYWxlcnQoXCJzaG91bGRuJ3QgZ2V0IGhlcmVcIik7XHJcbiAgICAgICAgcGF0aHdheVN0YWdlID0gaGFzaC5zdWJzdHIoMSk7XHJcblxyXG4gICAgICAgIHRlbXBsYXRlLnNob3dQYXRod2F5U3RhZ2VWaWV3KHBhdGh3YXlTdGFnZSk7XHJcblxyXG4gICAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGxvb2t1cC5jdXJyZW50VXJsID0gaGFzaDtcclxuICB9LFxyXG5cclxuICAvL1Nob3cgdGhlIG92ZXJ2aWV3IHBhZ2UgZm9yIGEgZGlzZWFzZVxyXG4gIHNob3dPdmVydmlldzogZnVuY3Rpb24oZGlzZWFzZSkge1xyXG4gICAgZGF0YS5wYXRod2F5SWQgPSBkaXNlYXNlO1xyXG5cclxuICAgIGxheW91dC5zaG93TWFpblZpZXcoZGF0YS5kaXNlYXNlcy5tYXAoZnVuY3Rpb24odikge1xyXG4gICAgICByZXR1cm4gdi5pZDtcclxuICAgIH0pLmluZGV4T2YoZGlzZWFzZSkpO1xyXG5cclxuICAgICQoJ2FzaWRlIGxpIHVsIGxpJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgJCgnYXNpZGUgYVtocmVmPVwiI21haW4vJyArIGRpc2Vhc2UgKyAnXCJdOmNvbnRhaW5zKFwiT3ZlcnZpZXdcIiknKS5wYXJlbnQoKS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcblxyXG4gICAgJCgnI21haW5UaXRsZScpLnNob3coKTtcclxuICAgIGJhc2UudXBkYXRlVGl0bGUoZGF0YS50ZXh0W2RhdGEucGF0aHdheUlkXVtcImRpc3BsYXktbmFtZVwiXSArIFwiOiBPdmVydmlldyAocHJhY3RpY2UtbGV2ZWwgZGF0YSlcIik7XHJcblxyXG4gICAgLy9TaG93IG92ZXJ2aWV3IHBhbmVsc1xyXG4gICAgdGVtcGxhdGUuc2hvd092ZXJ2aWV3UGFuZWxzKCk7XHJcbiAgICB0ZWFtQWN0aW9uUGxhbi5zaG93KGZhclJpZ2h0UGFuZWwpO1xyXG4gIH0sXHJcblxyXG4gIHNob3dPdmVydmlld1BhbmVsczogZnVuY3Rpb24oKSB7XHJcbiAgICBiYXNlLnN3aXRjaFRvMjIxTGF5b3V0KCk7XHJcblxyXG4gICAgdGVtcGxhdGUuc2hvd1BhbmVsKGxvb2t1cC5jYXRlZ29yaWVzLmRpYWdub3Npcy5uYW1lLCB0b3BMZWZ0UGFuZWwsIHRydWUpO1xyXG4gICAgdGVtcGxhdGUuc2hvd1BhbmVsKGxvb2t1cC5jYXRlZ29yaWVzLm1vbml0b3JpbmcubmFtZSwgdG9wUmlnaHRQYW5lbCwgdHJ1ZSk7XHJcbiAgICB0ZW1wbGF0ZS5zaG93UGFuZWwobG9va3VwLmNhdGVnb3JpZXMudHJlYXRtZW50Lm5hbWUsIGJvdHRvbUxlZnRQYW5lbCwgdHJ1ZSk7XHJcbiAgICB0ZW1wbGF0ZS5zaG93UGFuZWwobG9va3VwLmNhdGVnb3JpZXMuZXhjbHVzaW9ucy5uYW1lLCBib3R0b21SaWdodFBhbmVsLCB0cnVlKTtcclxuXHJcbiAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgfSxcclxuXHJcbiAgc2hvd1BhbmVsOiBmdW5jdGlvbihwYXRod2F5U3RhZ2UsIGxvY2F0aW9uLCBlbmFibGVIb3Zlcikge1xyXG4gICAgYmFzZS5zaG93UGF0aHdheVN0YWdlT3ZlcnZpZXdQYW5lbChsb2NhdGlvbiwgZW5hYmxlSG92ZXIsIGRhdGEucGF0aHdheUlkLCBwYXRod2F5U3RhZ2UpO1xyXG5cclxuICAgIGlmIChlbmFibGVIb3ZlcikgdGVtcGxhdGUuaGlnaGxpZ2h0T25Ib3ZlckFuZEVuYWJsZVNlbGVjdEJ5Q2xpY2sobG9jYXRpb24pO1xyXG4gICAgZWxzZSBsb2NhdGlvbi5jaGlsZHJlbignZGl2JykuYWRkQ2xhc3MoJ3VuY2xpY2thYmxlJyk7XHJcbiAgfSxcclxuXHJcbiAgLy9TaG93IHRoZSBwYXRod2F5IHN0YWdlIGZvciBhIGRpc2Vhc2VcclxuICBzaG93UGF0aHdheVN0YWdlVmlldzogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBzaG91bGRGYWRlKSB7XHJcbiAgICBmYXJSaWdodFBhbmVsLnJlbW92ZUNsYXNzKCdzdGFuZGFyZC1taXNzZWQtcGFnZScpLnJlbW92ZUNsYXNzKCdzdGFuZGFyZC1hY2hpZXZlZC1wYWdlJykucmVtb3ZlQ2xhc3MoJ3N0YW5kYXJkLW5vdC1yZWxldmFudC1wYWdlJyk7XHJcbiAgICBkYXRhLnBhdGh3YXlJZCA9IHBhdGh3YXlJZDtcclxuICAgIGxheW91dC5zaG93TWFpblZpZXcoZGF0YS5kaXNlYXNlcy5tYXAoZnVuY3Rpb24odikge1xyXG4gICAgICByZXR1cm4gdi5pZDtcclxuICAgIH0pLmluZGV4T2YocGF0aHdheUlkKSk7XHJcblxyXG4gICAgJCgnYXNpZGUgbGkgdWwgbGknKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICB2YXIgcmUgPSBuZXcgUmVnRXhwKHBhdGh3YXlTdGFnZSwgXCJnXCIpO1xyXG4gICAgJCgnYXNpZGUgYScpLmZpbHRlcihmdW5jdGlvbigpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuaHJlZi5tYXRjaChyZSk7XHJcbiAgICB9KS5wYXJlbnQoKS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcblxyXG4gICAgYmFzZS5zd2l0Y2hUbzExMExheW91dCgpO1xyXG5cclxuICAgIGlmICghc3RhbmRhcmQpIHtcclxuICAgICAgc3RhbmRhcmQgPSBPYmplY3Qua2V5cyhkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHMpWzBdO1xyXG4gICAgfVxyXG5cclxuICAgIHZhciBwYW5lbCA9IHBhdGllbnRzLmNyZWF0ZShwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQpO1xyXG5cclxuICAgIGlmIChzaG91bGRGYWRlKSB7XHJcbiAgICAgIGZhckxlZnRQYW5lbC5mYWRlT3V0KDEwMCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgJCh0aGlzKS5odG1sKHBhbmVsKTtcclxuICAgICAgICBwYXRpZW50cy53aXJlVXAocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIGZhckxlZnRQYW5lbCwgc3RhbmRhcmQpO1xyXG4gICAgICAgIHBhdGllbnRMaXN0LnBvcHVsYXRlKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgbnVsbCk7XHJcbiAgICAgICAgJCgnI21haW5UaXRsZScpLmhpZGUoKTtcclxuICAgICAgICBiYXNlLnVwZGF0ZVRpdGxlKGRhdGEudGV4dFtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0udGV4dC5wYWdlLnRleHQsIGRhdGEudGV4dFtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0udGV4dC5wYWdlLnRvb2x0aXApO1xyXG4gICAgICAgICQodGhpcykuZmFkZUluKDEwMCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgZmFyTGVmdFBhbmVsLmh0bWwocGFuZWwpO1xyXG4gICAgICBwYXRpZW50cy53aXJlVXAocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIGZhckxlZnRQYW5lbCwgc3RhbmRhcmQpO1xyXG4gICAgICBwYXRpZW50TGlzdC5wb3B1bGF0ZShwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIG51bGwpO1xyXG4gICAgICAkKCcjbWFpblRpdGxlJykuaGlkZSgpO1xyXG4gICAgICBiYXNlLnVwZGF0ZVRpdGxlKGRhdGEudGV4dFtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0udGV4dC5wYWdlLnRleHQsIGRhdGEudGV4dFtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0udGV4dC5wYWdlLnRvb2x0aXApO1xyXG4gICAgfVxyXG5cclxuICAgIHZhciB0ZW1wTXVzdCA9ICQoJyNwYXRpZW50LXBhbmVsLXBsYWNlaG9sZGVyJykuaHRtbCgpO1xyXG4gICAgZmFyUmlnaHRQYW5lbC5odG1sKE11c3RhY2hlLnJlbmRlcih0ZW1wTXVzdCkpO1xyXG4gIH0sXHJcblxyXG4gIHNob3dQYXRod2F5U3RhZ2VWaWV3T2s6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzaG91bGRGYWRlKSB7XHJcbiAgICBmYXJSaWdodFBhbmVsLnJlbW92ZUNsYXNzKCdzdGFuZGFyZC1taXNzZWQtcGFnZScpLnJlbW92ZUNsYXNzKCdzdGFuZGFyZC1hY2hpZXZlZC1wYWdlJykucmVtb3ZlQ2xhc3MoJ3N0YW5kYXJkLW5vdC1yZWxldmFudC1wYWdlJyk7XHJcbiAgICBsYXlvdXQuc2hvd01haW5WaWV3KGRhdGEuZGlzZWFzZXMubWFwKGZ1bmN0aW9uKHYpIHtcclxuICAgICAgcmV0dXJuIHYuaWQ7XHJcbiAgICB9KS5pbmRleE9mKHBhdGh3YXlJZCkpO1xyXG5cclxuICAgICQoJ2FzaWRlIGxpIHVsIGxpJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgdmFyIHJlID0gbmV3IFJlZ0V4cChwYXRod2F5U3RhZ2UsIFwiZ1wiKTtcclxuICAgICQoJ2FzaWRlIGEnKS5maWx0ZXIoZnVuY3Rpb24oKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLmhyZWYubWF0Y2gocmUpO1xyXG4gICAgfSkucGFyZW50KCkuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG5cclxuICAgIGJhc2Uuc3dpdGNoVG8xMTBMYXlvdXQoKTtcclxuXHJcbiAgICB2YXIgcGFuZWwgPSBwYXRpZW50cy5jcmVhdGVPayhwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSk7XHJcblxyXG4gICAgaWYgKHNob3VsZEZhZGUpIHtcclxuICAgICAgZmFyTGVmdFBhbmVsLmZhZGVPdXQoMjAwLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAkKHRoaXMpLmh0bWwocGFuZWwpO1xyXG4gICAgICAgIHBhdGllbnRzLndpcmVVcE9rKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBmYXJMZWZ0UGFuZWwpO1xyXG4gICAgICAgIHBhdGllbnRzLnBvcHVsYXRlT2socGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIG51bGwpO1xyXG4gICAgICAgICQoJyNtYWluVGl0bGUnKS5oaWRlKCk7XHJcbiAgICAgICAgYmFzZS51cGRhdGVUaXRsZShkYXRhLnRleHRbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnRleHQucGFnZS50ZXh0LCBkYXRhLnRleHRbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnRleHQucGFnZS50b29sdGlwKTtcclxuICAgICAgICAkKHRoaXMpLmZhZGVJbigzMDApO1xyXG4gICAgICB9KTtcclxuICAgICAgdmFyIHRlbXBNdXN0ID0gJCgnI3BhdGllbnQtcGFuZWwtcGxhY2Vob2xkZXInKS5odG1sKCk7XHJcbiAgICAgIGZhclJpZ2h0UGFuZWwuaHRtbChNdXN0YWNoZS5yZW5kZXIodGVtcE11c3QpKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGZhckxlZnRQYW5lbC5odG1sKHBhbmVsKTtcclxuICAgICAgcGF0aWVudHMud2lyZVVwT2socGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIGZhckxlZnRQYW5lbCk7XHJcbiAgICAgIHBhdGllbnRzLnBvcHVsYXRlT2socGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIG51bGwpO1xyXG4gICAgICAkKCcjbWFpblRpdGxlJykuaGlkZSgpO1xyXG4gICAgICBiYXNlLnVwZGF0ZVRpdGxlKGRhdGEudGV4dFtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0udGV4dC5wYWdlLnRleHQsIGRhdGEudGV4dFtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0udGV4dC5wYWdlLnRvb2x0aXApO1xyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIGhpZ2hsaWdodE9uSG92ZXJBbmRFbmFibGVTZWxlY3RCeUNsaWNrOiBmdW5jdGlvbihwYW5lbFNlbGVjdG9yKSB7XHJcbiAgICBwYW5lbFNlbGVjdG9yLmNoaWxkcmVuKCdkaXYnKS5yZW1vdmVDbGFzcygndW5jbGlja2FibGUnKS5vbignbW91c2VvdmVyJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoJ3BhbmVsLWRlZmF1bHQnKTtcclxuICAgIH0pLm9uKCdtb3VzZW91dCcsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgJCh0aGlzKS5hZGRDbGFzcygncGFuZWwtZGVmYXVsdCcpO1xyXG4gICAgfSkub24oJ2NsaWNrJywgJ3RyLnN0YW5kYXJkLXJvdycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgaGlzdG9yeS5wdXNoU3RhdGUobnVsbCwgbnVsbCwgJyNtYWluLycgKyBkYXRhLnBhdGh3YXlJZCArICcvJyArICQodGhpcykuY2xvc2VzdCgnLnBhbmVsJykuZGF0YSgnc3RhZ2UnKSArICcvbm8vJyArICQodGhpcykuZGF0YSgnc3RhbmRhcmQnKSk7XHJcbiAgICAgIHRlbXBsYXRlLmxvYWRDb250ZW50KCcjbWFpbi8nICsgZGF0YS5wYXRod2F5SWQgKyAnLycgKyAkKHRoaXMpLmNsb3Nlc3QoJy5wYW5lbCcpLmRhdGEoJ3N0YWdlJykgKyAnL25vLycgKyAkKHRoaXMpLmRhdGEoJ3N0YW5kYXJkJyksIHRydWUpO1xyXG4gICAgICAvLyBkbyBub3QgZ2l2ZSBhIGRlZmF1bHQgYWN0aW9uXHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfSkub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAvLyBrZWVwIHRoZSBsaW5rIGluIHRoZSBicm93c2VyIGhpc3RvcnlcclxuICAgICAgaGlzdG9yeS5wdXNoU3RhdGUobnVsbCwgbnVsbCwgJyNtYWluLycgKyBkYXRhLnBhdGh3YXlJZCArICcvJyArICQodGhpcykuZGF0YSgnc3RhZ2UnKSArICcvbm8nKTtcclxuICAgICAgdGVtcGxhdGUubG9hZENvbnRlbnQoJyNtYWluLycgKyBkYXRhLnBhdGh3YXlJZCArICcvJyArICQodGhpcykuZGF0YSgnc3RhZ2UnKSArICcvbm8nLCB0cnVlKTtcclxuICAgICAgLy8gZG8gbm90IGdpdmUgYSBkZWZhdWx0IGFjdGlvblxyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9KTtcclxuXHJcbiAgfSxcclxuXHJcbiAgZGlzcGxheVNlbGVjdGVkUGF0aWVudDogZnVuY3Rpb24oaWQpIHtcclxuICAgIHZhciBuaHMgPSBkYXRhLnBhdExvb2t1cCA/IGRhdGEucGF0TG9va3VwW2lkXSA6IGlkO1xyXG5cclxuICAgIGhpc3RvcnkucHVzaFN0YXRlKG51bGwsIG51bGwsICcjcGF0aWVudHMvJyArIGlkKTtcclxuICAgIHRlbXBsYXRlLmxvYWRDb250ZW50KCcjcGF0aWVudHMvJyArIGlkLCB0cnVlKTtcclxuXHJcbiAgICAkKCcubGlzdC1pdGVtJykucmVtb3ZlQ2xhc3MoJ2hpZ2hsaWdodGVkJyk7XHJcbiAgICAkKCcubGlzdC1pdGVtOmhhcyhidXR0b25bZGF0YS1jbGlwYm9hcmQtdGV4dD0nICsgbmhzICsgJ10pJykuYWRkQ2xhc3MoJ2hpZ2hsaWdodGVkJyk7XHJcblxyXG4gICAgLy9zY3JvbGwgdG8gcGF0aWVudHNcclxuICAgICQoJyNwYXRpZW50cycpLmZpbmQoJ2Rpdi50YWJsZS1zY3JvbGwnKS5nZXROaWNlU2Nyb2xsKCkuZG9TY3JvbGxQb3MoMCwgJCgnI3BhdGllbnRzIHRkJykuZmlsdGVyKGZ1bmN0aW9uKCkge1xyXG4gICAgICByZXR1cm4gJCh0aGlzKS50ZXh0KCkudHJpbSgpID09PSBuaHM7XHJcbiAgICB9KS5wb3NpdGlvbigpLnRvcCAtIDE0MCk7XHJcbiAgfSxcclxuXHJcbiAgc2hvdWxkV2VGYWRlOiBmdW5jdGlvbihvbGRIYXNoLCBuZXdIYXNoKSB7XHJcbiAgICBvbGRIYXNoID0gb2xkSGFzaC5zcGxpdCgnLycpO1xyXG4gICAgbmV3SGFzaCA9IG5ld0hhc2guc3BsaXQoJy8nKTtcclxuXHJcbiAgICBpZiAob2xkSGFzaFswXSA9PT0gbmV3SGFzaFswXSAmJiBvbGRIYXNoWzFdID09PSBuZXdIYXNoWzFdICYmIG9sZEhhc2hbMl0gPT09IG5ld0hhc2hbMl0gJiYgb2xkSGFzaFswXSAmJiBuZXdIYXNoWzBdKSByZXR1cm4gZmFsc2U7XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSB0ZW1wbGF0ZTtcclxuIiwidmFyIGJhc2UgPSByZXF1aXJlKCcuLi9iYXNlLmpzJyksXHJcbiAgbGF5b3V0ID0gcmVxdWlyZSgnLi4vbGF5b3V0LmpzJyksXHJcbiAgd2VsY29tZSA9IHJlcXVpcmUoJy4uL3BhbmVscy93ZWxjb21lLmpzJyk7XHJcblxyXG52YXIgSUQgPSBcIkFDVElPTl9QTEFOX1ZJRVdcIjtcclxuXHJcbnZhciBhcCA9IHtcclxuXHJcbiAgY3JlYXRlOiBmdW5jdGlvbigpIHtcclxuXHJcbiAgICBiYXNlLnNlbGVjdFRhYihcImFjdGlvbnNcIik7XHJcblxyXG4gICAgaWYobGF5b3V0LnZpZXcgIT09IElEKSB7XHJcbiAgICAgIC8vTm90IGFscmVhZHkgaW4gdGhpcyB2aWV3IHNvIHdlIG5lZWQgdG8gcmVqaWcgYSBmZXcgdGhpbmdzXHJcbiAgICAgIGJhc2UuY2xlYXJCb3goKTtcclxuICAgICAgbGF5b3V0LnNob3dQYWdlKCd3ZWxjb21lJyk7XHJcbiAgICAgIGxheW91dC5zaG93SGVhZGVyQmFySXRlbXMoKTtcclxuXHJcbiAgICAgICQoJyN3ZWxjb21lLXRhYnMgbGknKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICQoJyNvdXRzdGFuZGluZ1Rhc2tzJykuY2xvc2VzdCgnbGknKS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcblxyXG4gICAgICBsYXlvdXQudmlldyA9IElEO1xyXG4gICAgfVxyXG5cclxuICAgIHdlbGNvbWUucG9wdWxhdGUoKTtcclxuXHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gYXA7XHJcbiIsInZhciBiYXNlID0gcmVxdWlyZSgnLi4vYmFzZS5qcycpLFxyXG4gIGRhdGEgPSByZXF1aXJlKCcuLi9kYXRhLmpzJyksXHJcbiAgcGF0aWVudExpc3QgPSByZXF1aXJlKCcuLi9wYW5lbHMvcGF0aWVudExpc3QuanMnKSxcclxuICBpbmRpY2F0b3JCcmVha2Rvd24gPSByZXF1aXJlKCcuLi9wYW5lbHMvaW5kaWNhdG9yQnJlYWtkb3duLmpzJyksXHJcbiAgaW5kaWNhdG9yQmVuY2htYXJrID0gcmVxdWlyZSgnLi4vcGFuZWxzL2luZGljYXRvckJlbmNobWFyay5qcycpLFxyXG4gIGluZGljYXRvclRyZW5kID0gcmVxdWlyZSgnLi4vcGFuZWxzL2luZGljYXRvclRyZW5kLmpzJyksXHJcbiAgaW5kaWNhdG9ySGVhZGxpbmVzID0gcmVxdWlyZSgnLi4vcGFuZWxzL2luZGljYXRvckhlYWRsaW5lcy5qcycpLFxyXG4gIHRlYW1BY3Rpb25QbGFuID0gcmVxdWlyZSgnLi4vcGFuZWxzL3RlYW1BY3Rpb25QbGFuLmpzJyksXHJcbiAgd3JhcHBlciA9IHJlcXVpcmUoJy4uL3BhbmVscy93cmFwcGVyLmpzJyksXHJcbiAgbGF5b3V0ID0gcmVxdWlyZSgnLi4vbGF5b3V0LmpzJyk7XHJcblxyXG52YXIgSUQgPSBcIklORElDQVRPUlwiO1xyXG4vKlxyXG4gKiBUaGUgaW5kaWNhdG9yIHBhZ2UgY29uc2lzdHMgb2YgdGhlIHBhbmVsczpcclxuICogICBUYWJiZWQgcGFuZWxcclxuICogICAgIC0gcGVyZm9ybWFuY2UgdHJlbmRcclxuICogICAgIC0gcGVyZm9ybWFuY2UgYmVuY2htYXJrXHJcbiAqICAgUGF0aWVudCBncm91cHNcclxuICogICBQYXRpZW50IGxpc3RcclxuICogICBUZWFtIGFjdGlvbiBwbGFuXHJcbiAqL1xyXG5cclxudmFyIGluZCA9IHtcclxuXHJcbiAgY3JlYXRlOiBmdW5jdGlvbihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHRhYiwgbG9hZENvbnRlbnRGbikge1xyXG5cclxuICAgIGJhc2Uuc2VsZWN0VGFiKFwiaW5kaWNhdG9yXCIpO1xyXG4gICAgYmFzZS5zaG93TG9hZGluZygpO1xyXG5cclxuICAgIC8vdXNlIGEgc2V0VGltZW91dCB0byBmb3JjZSB0aGUgVUkgdG8gY2hhbmdlIGUuZy4gc2hvdyB0aGUgbG9hZGluZy1jb250YWluZXJcclxuICAgIC8vYmVmb3JlIGZ1cnRoZXIgZXhlY3V0aW9uXHJcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICBpZiAobGF5b3V0LnZpZXcgIT09IElEKSB7XHJcbiAgICAgICAgLy9Ob3QgYWxyZWFkeSBpbiB0aGlzIHZpZXcgc28gd2UgbmVlZCB0byByZWppZyBhIGZldyB0aGluZ3NcclxuICAgICAgICBiYXNlLmNsZWFyQm94KCk7XHJcbiAgICAgICAgLy9iYXNlLnN3aXRjaFRvMjFMYXlvdXQoKTtcclxuICAgICAgICBsYXlvdXQuc2hvd01haW5WaWV3KCk7XHJcblxyXG4gICAgICAgIGJhc2UucmVtb3ZlRnVsbFBhZ2UoZmFyUmlnaHRQYW5lbCk7XHJcbiAgICAgICAgYmFzZS5oaWRlUGFuZWxzKGZhclJpZ2h0UGFuZWwpO1xyXG5cclxuICAgICAgICBsYXlvdXQudmlldyA9IElEO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoIXBhdGh3YXlJZCkge1xyXG4gICAgICAgIGlmIChsYXlvdXQucGF0aHdheUlkKSBwYXRod2F5SWQgPSBsYXlvdXQucGF0aHdheUlkO1xyXG4gICAgICAgIGVsc2UgcGF0aHdheUlkID0gT2JqZWN0LmtleXMoZGF0YS5wYXRod2F5TmFtZXMpWzBdO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoIXBhdGh3YXlTdGFnZSkge1xyXG4gICAgICAgIGlmIChsYXlvdXQucGF0aHdheVN0YWdlKSBwYXRod2F5U3RhZ2UgPSBsYXlvdXQucGF0aHdheVN0YWdlO1xyXG4gICAgICAgIGVsc2UgcGF0aHdheVN0YWdlID0gT2JqZWN0LmtleXMoZGF0YS50ZXh0W3BhdGh3YXlJZF0pWzBdO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoIXN0YW5kYXJkKSB7XHJcbiAgICAgICAgaWYgKGxheW91dC5zdGFuZGFyZCkgc3RhbmRhcmQgPSBsYXlvdXQuc3RhbmRhcmQ7XHJcbiAgICAgICAgZWxzZSBzdGFuZGFyZCA9IE9iamVjdC5rZXlzKGRhdGEudGV4dFtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzKVswXTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy9pZiAobGF5b3V0LnBhdGh3YXlJZCAhPT0gcGF0aHdheUlkIHx8IGxheW91dC5wYXRod2F5U3RhZ2UgIT09IHBhdGh3YXlTdGFnZSkge1xyXG4gICAgICAgIC8vZGlmZmVyZW50IHBhdGh3YXkgb3Igc3RhZ2Ugc28gdGl0bGUgbmVlZHMgdXBkYXRpbmdcclxuICAgICAgICBiYXNlLnVwZGF0ZVRpdGxlKGRhdGEudGV4dFtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS5uYW1lKTtcclxuICAgICAgICAvKmJhc2UudXBkYXRlVGl0bGUoW3tcclxuICAgICAgICAgIHRpdGxlOiBcIk92ZXJ2aWV3XCIsXHJcbiAgICAgICAgICB1cmw6IFwiI292ZXJ2aWV3XCJcclxuICAgICAgICB9LCB7XHJcbiAgICAgICAgICB0aXRsZTogZGF0YS50ZXh0W3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS50ZXh0LnBhZ2UudGV4dCxcclxuICAgICAgICAgIHRvb2x0aXA6IGRhdGEudGV4dFtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0udGV4dC5wYWdlLnRvb2x0aXBcclxuICAgICAgICB9XSk7XHJcbiAgICAgICAgJCgnI21haW5UaXRsZScpLnNob3coKTsqL1xyXG4gICAgICAvL31cclxuXHJcbiAgICAgIGxheW91dC5wYXRod2F5SWQgPSBwYXRod2F5SWQ7XHJcbiAgICAgIGxheW91dC5wYXRod2F5U3RhZ2UgPSBwYXRod2F5U3RhZ2U7XHJcbiAgICAgIGxheW91dC5zdGFuZGFyZCA9IHN0YW5kYXJkO1xyXG5cclxuICAgICAgLy9UT0RPIG5vdCBzdXJlIGlmIHRoaXMgbmVlZHMgbW92aW5nLi4/XHJcbiAgICAgIGRhdGEucGF0aHdheUlkID0gcGF0aHdheUlkO1xyXG5cclxuICAgICAgLy9UaGUgdGhyZWUgcGFuZWxzIHdlIG5lZWQgdG8gc2hvd1xyXG4gICAgICAvL1BhbmVscyBkZWNpZGUgd2hldGhlciB0aGV5IG5lZWQgdG8gcmVkcmF3IHRoZW1zZWx2ZXNcclxuICAgICAgdGVhbUFjdGlvblBsYW4uc2hvdyhmYXJMZWZ0UGFuZWwpO1xyXG5cclxuICAgICAgYmFzZS51cGRhdGVUYWIoXCJpbmRpY2F0b3JzXCIsIGRhdGEudGV4dFtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS50YWJUZXh0LCBbcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkXS5qb2luKFwiL1wiKSk7XHJcblxyXG4gICAgICB3cmFwcGVyLnNob3coZmFyUmlnaHRQYW5lbCwgZmFsc2UsIFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICBzaG93OiBpbmRpY2F0b3JIZWFkbGluZXMuc2hvdyxcclxuICAgICAgICAgIGFyZ3M6IFtwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmRdXHJcbiAgICAgICAgfSwge1xyXG4gICAgICAgICAgc2hvdzogaW5kaWNhdG9yQnJlYWtkb3duLnNob3csXHJcbiAgICAgICAgICBhcmdzOiBbcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50TGlzdC5zZWxlY3RTdWJzZWN0aW9uXVxyXG4gICAgICAgIH0sIHtcclxuICAgICAgICAgIHNob3c6IHBhdGllbnRMaXN0LnNob3csXHJcbiAgICAgICAgICBhcmdzOiBbcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBsb2FkQ29udGVudEZuXVxyXG4gICAgICAgIH1cclxuICAgICAgXSwgXCJQZXJmb3JtYW5jZSBvdmVyIHRpbWVcIiwgZmFsc2UpO1xyXG4gICAgICB3cmFwcGVyLnNob3coZmFyUmlnaHRQYW5lbCwgdHJ1ZSwgW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgIHNob3c6IGluZGljYXRvclRyZW5kLnNob3csXHJcbiAgICAgICAgICBhcmdzOiBbcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkXVxyXG4gICAgICAgIH1cclxuICAgICAgXSwgXCJCZW5jaG1hcmtpbmdcIiwgXCJQYXRpZW50cyBhdCByaXNrXCIpO1xyXG4gICAgICB3cmFwcGVyLnNob3coZmFyUmlnaHRQYW5lbCwgdHJ1ZSwgW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgIHNob3c6IGluZGljYXRvckJlbmNobWFyay5zaG93LFxyXG4gICAgICAgICAgYXJnczogW3BhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZF1cclxuICAgICAgICB9XHJcbiAgICAgIF0sIGZhbHNlLCBcIlBlcmZvcm1hbmNlIG92ZXIgdGltZVwiKTtcclxuXHJcbiAgICAgIGJhc2UuYWRkRnVsbFBhZ2UoZmFyUmlnaHRQYW5lbCk7XHJcblxyXG4gICAgICAkKCcjaW5kaWNhdG9yLXBhbmUnKS5zaG93KCk7XHJcblxyXG4gICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcblxyXG4gICAgICAvKnNldFRpbWVvdXQoJCgnLmZwLWNvbnRyb2xBcnJvdycpLmVhY2goZnVuY3Rpb24oaWR4LCBlbCkge1xyXG4gICAgICAgIGlmKGVsLmlzKFwiOnZpc2libGVcIikpXHJcbiAgICAgIH0pLCAyMDAwKTsqL1xyXG5cclxuICAgICAgYmFzZS5oaWRlTG9hZGluZygpO1xyXG4gICAgfSwgMCk7XHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gaW5kO1xyXG4iLCJ2YXIgYmFzZSA9IHJlcXVpcmUoJy4uL2Jhc2UuanMnKSxcclxuICBkYXRhID0gcmVxdWlyZSgnLi4vZGF0YS5qcycpLFxyXG4gIGxheW91dCA9IHJlcXVpcmUoJy4uL2xheW91dC5qcycpLFxyXG4gIGluZGljYXRvckxpc3QgPSByZXF1aXJlKCcuLi9wYW5lbHMvaW5kaWNhdG9yTGlzdC5qcycpLFxyXG4gIHRlYW1BY3Rpb25QbGFuID0gcmVxdWlyZSgnLi4vcGFuZWxzL3RlYW1BY3Rpb25QbGFuLmpzJyk7XHJcblxyXG52YXIgSUQgPSBcIk9WRVJWSUVXXCI7XHJcbi8qXHJcbiAqIFRoZSBvdmVydmlldyBwYWdlIGNvbnNpc3RzIG9mIHRoZSBwYW5lbHM6XHJcbiAqICAgSW5kaWNhdG9yIGxpc3RcclxuICogICBUZWFtIGFjdGlvbiBwbGFuXHJcbiAqL1xyXG52YXIgb3ZlcnZpZXcgPSB7XHJcblxyXG4gIGNyZWF0ZTogZnVuY3Rpb24obG9hZENvbnRlbnRGbikge1xyXG5cclxuICAgIGJhc2Uuc2VsZWN0VGFiKFwib3ZlcnZpZXdcIik7XHJcbiAgICBiYXNlLnNob3dMb2FkaW5nKCk7XHJcblxyXG4gICAgLy91c2UgYSBzZXRUaW1lb3V0IHRvIGZvcmNlIHRoZSBVSSB0byBjaGFuZ2UgZS5nLiBzaG93IHRoZSBsb2FkaW5nLWNvbnRhaW5lclxyXG4gICAgLy9iZWZvcmUgZnVydGhlciBleGVjdXRpb25cclxuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICBpZiAobGF5b3V0LnZpZXcgIT09IElEKSB7XHJcbiAgICAgICAgLy9Ob3QgYWxyZWFkeSBpbiB0aGlzIHZpZXcgc28gd2UgbmVlZCB0byByZWppZyBhIGZldyB0aGluZ3NcclxuICAgICAgICBiYXNlLmNsZWFyQm94KCk7XHJcbiAgICAgICAgLy9iYXNlLnN3aXRjaFRvMTAxTGF5b3V0KCk7XHJcbiAgICAgICAgbGF5b3V0LnNob3dNYWluVmlldygpO1xyXG5cclxuICAgICAgICAkKCcjbWFpblRpdGxlJykuc2hvdygpO1xyXG4gICAgICAgIGJhc2UudXBkYXRlVGl0bGUoXCJPdmVydmlldyBvZiB5b3VyIHByYWN0aWNlIHBlcmZvcm1hbmNlXCIpO1xyXG5cclxuICAgICAgICBiYXNlLnJlbW92ZUZ1bGxQYWdlKGZhclJpZ2h0UGFuZWwpO1xyXG4gICAgICAgIGJhc2UuaGlkZVBhbmVscyhmYXJSaWdodFBhbmVsKTtcclxuXHJcbiAgICAgICAgbGF5b3V0LnZpZXcgPSBJRDtcclxuICAgICAgfVxyXG5cclxuICAgICAgZGF0YS5wYXRod2F5SWQgPSBcImh0blwiOyAvL1RPRE8gZnVkZ2VcclxuXHJcbiAgICAgIC8vVGhlIHR3byBwYW5lbHMgd2UgbmVlZCB0byBzaG93XHJcbiAgICAgIC8vUGFuZWxzIGRlY2lkZSB3aGV0aGVyIHRoZXkgbmVlZCB0byByZWRyYXcgdGhlbXNlbHZlc1xyXG4gICAgICB0ZWFtQWN0aW9uUGxhbi5zaG93KGZhckxlZnRQYW5lbCk7XHJcbiAgICAgIGluZGljYXRvckxpc3Quc2hvdyhmYXJSaWdodFBhbmVsLCBmYWxzZSwgbG9hZENvbnRlbnRGbik7XHJcblxyXG4gICAgICAkKCcjb3ZlcnZpZXctcGFuZScpLnNob3coKTtcclxuXHJcbiAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgICAgYmFzZS5oaWRlTG9hZGluZygpO1xyXG4gICAgfSwgMCk7XHJcblxyXG4gIH1cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IG92ZXJ2aWV3O1xyXG4iLCJ2YXIgbGlmZWxpbmUgPSByZXF1aXJlKCcuLi9wYW5lbHMvbGlmZWxpbmUuanMnKSxcclxuICBkYXRhID0gcmVxdWlyZSgnLi4vZGF0YS5qcycpLFxyXG4gIGJhc2UgPSByZXF1aXJlKCcuLi9iYXNlLmpzJyksXHJcbiAgbGF5b3V0ID0gcmVxdWlyZSgnLi4vbGF5b3V0LmpzJyksXHJcbiAgaW5kaXZpZHVhbEFjdGlvblBsYW4gPSByZXF1aXJlKCcuLi9wYW5lbHMvaW5kaXZpZHVhbEFjdGlvblBsYW4uanMnKSxcclxuICBxdWFsaXR5U3RhbmRhcmRzID0gcmVxdWlyZSgnLi4vcGFuZWxzL3F1YWxpdHlTdGFuZGFyZHMuanMnKSxcclxuICBwYXRpZW50Q2hhcmFjdGVyaXN0aWNzID0gcmVxdWlyZSgnLi4vcGFuZWxzL3BhdGllbnRDaGFyYWN0ZXJpc3RpY3MuanMnKSxcclxuICBwYXRpZW50U2VhcmNoID0gcmVxdWlyZSgnLi4vcGFuZWxzL3BhdGllbnRTZWFyY2guanMnKTtcclxuXHJcbnZhciBJRCA9IFwiUEFUSUVOVF9WSUVXXCI7XHJcbi8qXHJcbiAqIFRoZSBwYXRpZW50IHBhZ2UgY29uc2lzdHMgb2YgdGhlIHBhbmVsczpcclxuICogICBMaWZlbGluZSBjaGFydFxyXG4gKiAgIEluZGl2aWR1YWwgYWN0aW9uIHBsYW5cclxuICovXHJcblxyXG52YXIgcHYgPSB7XHJcblxyXG4gIHdpcmVVcDogZnVuY3Rpb24oKSB7XHJcblxyXG4gIH0sXHJcblxyXG4gIGNyZWF0ZTogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQsIGxvYWRDb250ZW50Rm4pIHtcclxuXHJcbiAgICBiYXNlLnNlbGVjdFRhYihcInBhdGllbnRcIik7XHJcbiAgICBiYXNlLnNob3dMb2FkaW5nKCk7XHJcblxyXG4gICAgLy91c2UgYSBzZXRUaW1lb3V0IHRvIGZvcmNlIHRoZSBVSSB0byBjaGFuZ2UgZS5nLiBzaG93IHRoZSBsb2FkaW5nLWNvbnRhaW5lclxyXG4gICAgLy9iZWZvcmUgZnVydGhlciBleGVjdXRpb25cclxuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICBpZiAobGF5b3V0LnZpZXcgIT09IElEKSB7XHJcbiAgICAgICAgLy9Ob3QgYWxyZWFkeSBpbiB0aGlzIHZpZXcgc28gd2UgbmVlZCB0byByZWppZyBhIGZldyB0aGluZ3NcclxuICAgICAgICBiYXNlLmNsZWFyQm94KCk7XHJcbiAgICAgICAgLy9iYXNlLnN3aXRjaFRvMjFMYXlvdXQoKTtcclxuICAgICAgICBsYXlvdXQuc2hvd01haW5WaWV3KCk7XHJcblxyXG4gICAgICAgIGJhc2UucmVtb3ZlRnVsbFBhZ2UoZmFyUmlnaHRQYW5lbCk7XHJcbiAgICAgICAgYmFzZS5oaWRlUGFuZWxzKGZhclJpZ2h0UGFuZWwpO1xyXG5cclxuICAgICAgICBsYXlvdXQudmlldyA9IElEO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBiYXNlLmhpZGVQYW5lbHMoZmFyTGVmdFBhbmVsKTtcclxuXHJcbiAgICAgIGlmIChwYXRpZW50SWQpIHtcclxuICAgICAgICBkYXRhLmdldFBhdGllbnREYXRhKHBhdGllbnRJZCwgZnVuY3Rpb24ocGF0aWVudERhdGEpIHtcclxuXHJcblxyXG4gICAgICAgICAgaWYgKGxheW91dC5wYXRod2F5SWQgIT09IHBhdGh3YXlJZCB8fCBsYXlvdXQucGF0aHdheVN0YWdlICE9PSBwYXRod2F5U3RhZ2UgfHxcclxuICAgICAgICAgICAgbGF5b3V0LnN0YW5kYXJkICE9PSBzdGFuZGFyZCB8fCBsYXlvdXQucGF0aWVudElkICE9PSBwYXRpZW50SWQpIHtcclxuICAgICAgICAgICAgLy9kaWZmZXJlbnQgcGF0aHdheSBvciBzdGFnZSBvciBwYXRpZW50SWQgc28gdGl0bGUgbmVlZHMgdXBkYXRpbmdcclxuICAgICAgICAgICAgJCgnI21haW5UaXRsZScpLnNob3coKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBwYXRpZCA9IChkYXRhLnBhdExvb2t1cCAmJiBkYXRhLnBhdExvb2t1cFtwYXRpZW50SWRdID8gZGF0YS5wYXRMb29rdXBbcGF0aWVudElkXSA6IHBhdGllbnRJZCk7XHJcbiAgICAgICAgICAgIHZhciBzZXggPSBwYXRpZW50RGF0YS5jaGFyYWN0ZXJpc3RpY3Muc2V4LnRvTG93ZXJDYXNlKCkgPT09IFwibVwiID9cclxuICAgICAgICAgICAgICBcIm1hbGVcIiA6IChwYXRpZW50RGF0YS5jaGFyYWN0ZXJpc3RpY3Muc2V4LnRvTG93ZXJDYXNlKCkgPT09IFwiZlwiID8gXCJmZW1hbGVcIiA6IHBhdGllbnREYXRhLmNoYXJhY3RlcmlzdGljcy5zZXgudG9Mb3dlckNhc2UoKSk7XHJcbiAgICAgICAgICAgIGJhc2UudXBkYXRlVGl0bGUoXCJQYXRpZW50IFwiICsgcGF0aWQgK1xyXG4gICAgICAgICAgICAgIFwiIC0gXCIgKyBwYXRpZW50RGF0YS5jaGFyYWN0ZXJpc3RpY3MuYWdlICsgXCIgeWVhciBvbGQgXCIgKyBzZXgpO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIGJhc2UudXBkYXRlVGFiKFwicGF0aWVudHNcIiwgZGF0YS5wYXRMb29rdXBbcGF0aWVudElkXSB8fCBwYXRpZW50SWQsIHBhdGllbnRJZCk7XHJcblxyXG4gICAgICAgICAgbGF5b3V0LnBhdGllbnRJZCA9IHBhdGllbnRJZDtcclxuICAgICAgICAgIGRhdGEucGF0aWVudElkID0gcGF0aWVudElkO1xyXG4gICAgICAgICAgZGF0YS5wYXRod2F5SWQgPSBwYXRod2F5SWQ7XHJcblxyXG4gICAgICAgICAgcGF0aWVudFNlYXJjaC5zaG93KCQoJyN0aXRsZS1yaWdodCcpLCB0cnVlLCBsb2FkQ29udGVudEZuKTtcclxuICAgICAgICAgIHF1YWxpdHlTdGFuZGFyZHMuc2hvdyhmYXJSaWdodFBhbmVsLCBmYWxzZSwgcGF0aWVudElkKTtcclxuXHJcbiAgICAgICAgICBsaWZlbGluZS5zaG93KGZhclJpZ2h0UGFuZWwsIHRydWUsIHBhdGllbnRJZCwgcGF0aWVudERhdGEpO1xyXG4gICAgICAgICAgaW5kaXZpZHVhbEFjdGlvblBsYW4uc2hvdyhmYXJMZWZ0UGFuZWwsIHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuXHJcbiAgICAgICAgICBwYXRpZW50U2VhcmNoLndpcmVVcCgpO1xyXG4gICAgICAgICAgJCgnI3BhdGllbnQtcGFuZScpLnNob3coKTtcclxuXHJcbiAgICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICAgICAgICBiYXNlLmhpZGVMb2FkaW5nKCk7XHJcblxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGJhc2UudXBkYXRlVGl0bGUoXCJObyBwYXRpZW50IGN1cnJlbnRseSBzZWxlY3RlZFwiKTtcclxuXHJcbiAgICAgICAgcGF0aWVudFNlYXJjaC5zaG93KGZhclJpZ2h0UGFuZWwsIHRydWUsIGxvYWRDb250ZW50Rm4pO1xyXG5cclxuICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICAgICAgYmFzZS5oaWRlTG9hZGluZygpO1xyXG4gICAgICB9XHJcblxyXG4gICAgfSwgMCk7XHJcblxyXG4gIH0sXHJcblxyXG4gIHBvcHVsYXRlOiBmdW5jdGlvbigpIHtcclxuXHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gcHY7XHJcbiJdfQ==
