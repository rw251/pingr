(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/*
 Highcharts JS v4.2.4 (2016-04-14)

 (c) 2009-2016 Torstein Honsi

 License: www.highcharts.com/license
*/
(function(m){typeof module==="object"&&module.exports?module.exports=m:m(Highcharts)})(function(m){function L(a,b,c){this.init(a,b,c)}var Q=m.arrayMin,R=m.arrayMax,t=m.each,H=m.extend,u=m.merge,S=m.map,o=m.pick,B=m.pInt,G=m.correctFloat,p=m.getOptions().plotOptions,i=m.seriesTypes,v=m.extendClass,M=m.splat,w=m.wrap,N=m.Axis,z=m.Tick,I=m.Point,T=m.Pointer,U=m.CenteredSeriesMixin,C=m.TrackerMixin,x=m.Series,y=Math,F=y.round,D=y.floor,O=y.max,V=m.Color,r=function(){};H(L.prototype,{init:function(a,b,
c){var d=this,g=d.defaultOptions;d.chart=b;d.options=a=u(g,b.angular?{background:{}}:void 0,a);(a=a.background)&&t([].concat(M(a)).reverse(),function(a){var b=a.backgroundColor,g=c.userOptions,a=u(d.defaultBackgroundOptions,a);if(b)a.backgroundColor=b;a.color=a.backgroundColor;c.options.plotBands.unshift(a);g.plotBands=g.plotBands||[];g.plotBands!==c.options.plotBands&&g.plotBands.unshift(a)})},defaultOptions:{center:["50%","50%"],size:"85%",startAngle:0},defaultBackgroundOptions:{shape:"circle",
borderWidth:1,borderColor:"silver",backgroundColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,"#FFF"],[1,"#DDD"]]},from:-Number.MAX_VALUE,innerRadius:0,to:Number.MAX_VALUE,outerRadius:"105%"}});var A=N.prototype,z=z.prototype,W={getOffset:r,redraw:function(){this.isDirty=!1},render:function(){this.isDirty=!1},setScale:r,setCategories:r,setTitle:r},P={isRadial:!0,defaultRadialGaugeOptions:{labels:{align:"center",x:0,y:null},minorGridLineWidth:0,minorTickInterval:"auto",minorTickLength:10,minorTickPosition:"inside",
minorTickWidth:1,tickLength:10,tickPosition:"inside",tickWidth:2,title:{rotation:0},zIndex:2},defaultRadialXOptions:{gridLineWidth:1,labels:{align:null,distance:15,x:0,y:null},maxPadding:0,minPadding:0,showLastLabel:!1,tickLength:0},defaultRadialYOptions:{gridLineInterpolation:"circle",labels:{align:"right",x:-3,y:-2},showLastLabel:!1,title:{x:4,text:null,rotation:90}},setOptions:function(a){a=this.options=u(this.defaultOptions,this.defaultRadialOptions,a);if(!a.plotBands)a.plotBands=[]},getOffset:function(){A.getOffset.call(this);
this.chart.axisOffset[this.side]=0;this.center=this.pane.center=U.getCenter.call(this.pane)},getLinePath:function(a,b){var c=this.center,b=o(b,c[2]/2-this.offset);return this.chart.renderer.symbols.arc(this.left+c[0],this.top+c[1],b,b,{start:this.startAngleRad,end:this.endAngleRad,open:!0,innerR:0})},setAxisTranslation:function(){A.setAxisTranslation.call(this);if(this.center)this.transA=this.isCircular?(this.endAngleRad-this.startAngleRad)/(this.max-this.min||1):this.center[2]/2/(this.max-this.min||
1),this.minPixelPadding=this.isXAxis?this.transA*this.minPointOffset:0},beforeSetTickPositions:function(){this.autoConnect&&(this.max+=this.categories&&1||this.pointRange||this.closestPointRange||0)},setAxisSize:function(){A.setAxisSize.call(this);if(this.isRadial){this.center=this.pane.center=m.CenteredSeriesMixin.getCenter.call(this.pane);if(this.isCircular)this.sector=this.endAngleRad-this.startAngleRad;this.len=this.width=this.height=this.center[2]*o(this.sector,1)/2}},getPosition:function(a,
b){return this.postTranslate(this.isCircular?this.translate(a):0,o(this.isCircular?b:this.translate(a),this.center[2]/2)-this.offset)},postTranslate:function(a,b){var c=this.chart,d=this.center,a=this.startAngleRad+a;return{x:c.plotLeft+d[0]+Math.cos(a)*b,y:c.plotTop+d[1]+Math.sin(a)*b}},getPlotBandPath:function(a,b,c){var d=this.center,g=this.startAngleRad,e=d[2]/2,j=[o(c.outerRadius,"100%"),c.innerRadius,o(c.thickness,10)],l=/%$/,h,f=this.isCircular;this.options.gridLineInterpolation==="polygon"?
d=this.getPlotLinePath(a).concat(this.getPlotLinePath(b,!0)):(a=Math.max(a,this.min),b=Math.min(b,this.max),f||(j[0]=this.translate(a),j[1]=this.translate(b)),j=S(j,function(a){l.test(a)&&(a=B(a,10)*e/100);return a}),c.shape==="circle"||!f?(a=-Math.PI/2,b=Math.PI*1.5,h=!0):(a=g+this.translate(a),b=g+this.translate(b)),d=this.chart.renderer.symbols.arc(this.left+d[0],this.top+d[1],j[0],j[0],{start:Math.min(a,b),end:Math.max(a,b),innerR:o(j[1],j[0]-j[2]),open:h}));return d},getPlotLinePath:function(a,
b){var c=this,d=c.center,g=c.chart,e=c.getPosition(a),j,l,h;c.isCircular?h=["M",d[0]+g.plotLeft,d[1]+g.plotTop,"L",e.x,e.y]:c.options.gridLineInterpolation==="circle"?(a=c.translate(a))&&(h=c.getLinePath(0,a)):(t(g.xAxis,function(a){a.pane===c.pane&&(j=a)}),h=[],a=c.translate(a),d=j.tickPositions,j.autoConnect&&(d=d.concat([d[0]])),b&&(d=[].concat(d).reverse()),t(d,function(e,b){l=j.getPosition(e,a);h.push(b?"L":"M",l.x,l.y)}));return h},getTitlePosition:function(){var a=this.center,b=this.chart,
c=this.options.title;return{x:b.plotLeft+a[0]+(c.x||0),y:b.plotTop+a[1]-{high:0.5,middle:0.25,low:0}[c.align]*a[2]+(c.y||0)}}};w(A,"init",function(a,b,c){var k;var d=b.angular,g=b.polar,e=c.isX,j=d&&e,l,h;h=b.options;var f=c.pane||0;if(d){if(H(this,j?W:P),l=!e)this.defaultRadialOptions=this.defaultRadialGaugeOptions}else if(g)H(this,P),this.defaultRadialOptions=(l=e)?this.defaultRadialXOptions:u(this.defaultYAxisOptions,this.defaultRadialYOptions);a.call(this,b,c);if(!j&&(d||g)){a=this.options;if(!b.panes)b.panes=
[];this.pane=(k=b.panes[f]=b.panes[f]||new L(M(h.pane)[f],b,this),f=k);f=f.options;b.inverted=!1;h.chart.zoomType=null;this.startAngleRad=b=(f.startAngle-90)*Math.PI/180;this.endAngleRad=h=(o(f.endAngle,f.startAngle+360)-90)*Math.PI/180;this.offset=a.offset||0;if((this.isCircular=l)&&c.max===void 0&&h-b===2*Math.PI)this.autoConnect=!0}});w(A,"autoLabelAlign",function(a){if(!this.isRadial)return a.apply(this,[].slice.call(arguments,1))});w(z,"getPosition",function(a,b,c,d,g){var e=this.axis;return e.getPosition?
e.getPosition(c):a.call(this,b,c,d,g)});w(z,"getLabelPosition",function(a,b,c,d,g,e,j,l,h){var f=this.axis,k=e.y,n=20,s=e.align,i=(f.translate(this.pos)+f.startAngleRad+Math.PI/2)/Math.PI*180%360;f.isRadial?(a=f.getPosition(this.pos,f.center[2]/2+o(e.distance,-25)),e.rotation==="auto"?d.attr({rotation:i}):k===null&&(k=f.chart.renderer.fontMetrics(d.styles.fontSize).b-d.getBBox().height/2),s===null&&(f.isCircular?(this.label.getBBox().width>f.len*f.tickInterval/(f.max-f.min)&&(n=0),s=i>n&&i<180-n?
"left":i>180+n&&i<360-n?"right":"center"):s="center",d.attr({align:s})),a.x+=e.x,a.y+=k):a=a.call(this,b,c,d,g,e,j,l,h);return a});w(z,"getMarkPath",function(a,b,c,d,g,e,j){var l=this.axis;l.isRadial?(a=l.getPosition(this.pos,l.center[2]/2+d),b=["M",b,c,"L",a.x,a.y]):b=a.call(this,b,c,d,g,e,j);return b});p.arearange=u(p.area,{lineWidth:1,marker:null,threshold:null,tooltip:{pointFormat:'<span style="color:{series.color}">\u25cf</span> {series.name}: <b>{point.low}</b> - <b>{point.high}</b><br/>'},
trackByArea:!0,dataLabels:{align:null,verticalAlign:null,xLow:0,xHigh:0,yLow:0,yHigh:0},states:{hover:{halo:!1}}});i.arearange=v(i.area,{type:"arearange",pointArrayMap:["low","high"],dataLabelCollections:["dataLabel","dataLabelUpper"],toYData:function(a){return[a.low,a.high]},pointValKey:"low",deferTranslatePolar:!0,highToXY:function(a){var b=this.chart,c=this.xAxis.postTranslate(a.rectPlotX,this.yAxis.len-a.plotHigh);a.plotHighX=c.x-b.plotLeft;a.plotHigh=c.y-b.plotTop},translate:function(){var a=
this,b=a.yAxis;i.area.prototype.translate.apply(a);t(a.points,function(a){var d=a.low,g=a.high,e=a.plotY;g===null||d===null?a.isNull=!0:(a.plotLow=e,a.plotHigh=b.translate(g,0,1,0,1))});this.chart.polar&&t(this.points,function(b){a.highToXY(b)})},getGraphPath:function(){var a=this.points,b=[],c=[],d=a.length,g=x.prototype.getGraphPath,e,j,l;l=this.options;for(var h=l.step,d=a.length;d--;)e=a[d],!e.isNull&&(!a[d+1]||a[d+1].isNull)&&c.push({plotX:e.plotX,plotY:e.plotLow}),j={plotX:e.plotX,plotY:e.plotHigh,
isNull:e.isNull},c.push(j),b.push(j),!e.isNull&&(!a[d-1]||a[d-1].isNull)&&c.push({plotX:e.plotX,plotY:e.plotLow});a=g.call(this,a);if(h)h===!0&&(h="left"),l.step={left:"right",center:"center",right:"left"}[h];b=g.call(this,b);c=g.call(this,c);l.step=h;l=[].concat(a,b);!this.chart.polar&&c[0]==="M"&&(c[0]="L");this.areaPath=this.areaPath.concat(a,c);return l},drawDataLabels:function(){var a=this.data,b=a.length,c,d=[],g=x.prototype,e=this.options.dataLabels,j=e.align,l=e.verticalAlign,h=e.inside,f,
k,n=this.chart.inverted;if(e.enabled||this._hasPointLabels){for(c=b;c--;)if(f=a[c]){k=h?f.plotHigh<f.plotLow:f.plotHigh>f.plotLow;f.y=f.high;f._plotY=f.plotY;f.plotY=f.plotHigh;d[c]=f.dataLabel;f.dataLabel=f.dataLabelUpper;f.below=k;if(n){if(!j)e.align=k?"right":"left"}else if(!l)e.verticalAlign=k?"top":"bottom";e.x=e.xHigh;e.y=e.yHigh}g.drawDataLabels&&g.drawDataLabels.apply(this,arguments);for(c=b;c--;)if(f=a[c]){k=h?f.plotHigh<f.plotLow:f.plotHigh>f.plotLow;f.dataLabelUpper=f.dataLabel;f.dataLabel=
d[c];f.y=f.low;f.plotY=f._plotY;f.below=!k;if(n){if(!j)e.align=k?"left":"right"}else if(!l)e.verticalAlign=k?"bottom":"top";e.x=e.xLow;e.y=e.yLow}g.drawDataLabels&&g.drawDataLabels.apply(this,arguments)}e.align=j;e.verticalAlign=l},alignDataLabel:function(){i.column.prototype.alignDataLabel.apply(this,arguments)},setStackedPoints:r,getSymbol:r,drawPoints:r});p.areasplinerange=u(p.arearange);i.areasplinerange=v(i.arearange,{type:"areasplinerange",getPointSpline:i.spline.prototype.getPointSpline});
(function(){var a=i.column.prototype;p.columnrange=u(p.column,p.arearange,{lineWidth:1,pointRange:null});i.columnrange=v(i.arearange,{type:"columnrange",translate:function(){var b=this,c=b.yAxis,d=b.xAxis,g=d.startAngleRad,e,j=b.chart,l=b.xAxis.isRadial,h;a.translate.apply(b);t(b.points,function(a){var k=a.shapeArgs,n=b.options.minPointLength,s,i;a.plotHigh=h=c.translate(a.high,0,1,0,1);a.plotLow=a.plotY;i=h;s=o(a.rectPlotY,a.plotY)-h;Math.abs(s)<n?(n-=s,s+=n,i-=n/2):s<0&&(s*=-1,i-=s);l?(e=a.barX+
g,a.shapeType="path",a.shapeArgs={d:b.polarArc(i+s,i,e,e+a.pointWidth)}):(k.height=s,k.y=i,a.tooltipPos=j.inverted?[c.len+c.pos-j.plotLeft-i-s/2,d.len+d.pos-j.plotTop-k.x-k.width/2,s]:[d.left-j.plotLeft+k.x+k.width/2,c.pos-j.plotTop+i+s/2,s])})},directTouch:!0,trackerGroups:["group","dataLabelsGroup"],drawGraph:r,crispCol:a.crispCol,pointAttrToOptions:a.pointAttrToOptions,drawPoints:a.drawPoints,drawTracker:a.drawTracker,getColumnMetrics:a.getColumnMetrics,animate:function(){return a.animate.apply(this,
arguments)},polarArc:function(){return a.polarArc.apply(this,arguments)}})})();p.gauge=u(p.line,{dataLabels:{enabled:!0,defer:!1,y:15,borderWidth:1,borderColor:"silver",borderRadius:3,crop:!1,verticalAlign:"top",zIndex:2},dial:{},pivot:{},tooltip:{headerFormat:""},showInLegend:!1});C={type:"gauge",pointClass:v(I,{setState:function(a){this.state=a}}),angular:!0,directTouch:!0,drawGraph:r,fixedBox:!0,forceDL:!0,trackerGroups:["group","dataLabelsGroup"],translate:function(){var a=this.yAxis,b=this.options,
c=a.center;this.generatePoints();t(this.points,function(d){var g=u(b.dial,d.dial),e=B(o(g.radius,80))*c[2]/200,j=B(o(g.baseLength,70))*e/100,l=B(o(g.rearLength,10))*e/100,h=g.baseWidth||3,f=g.topWidth||1,k=b.overshoot,n=a.startAngleRad+a.translate(d.y,null,null,null,!0);k&&typeof k==="number"?(k=k/180*Math.PI,n=Math.max(a.startAngleRad-k,Math.min(a.endAngleRad+k,n))):b.wrap===!1&&(n=Math.max(a.startAngleRad,Math.min(a.endAngleRad,n)));n=n*180/Math.PI;d.shapeType="path";d.shapeArgs={d:g.path||["M",
-l,-h/2,"L",j,-h/2,e,-f/2,e,f/2,j,h/2,-l,h/2,"z"],translateX:c[0],translateY:c[1],rotation:n};d.plotX=c[0];d.plotY=c[1]})},drawPoints:function(){var a=this,b=a.yAxis.center,c=a.pivot,d=a.options,g=d.pivot,e=a.chart.renderer;t(a.points,function(b){var g=b.graphic,c=b.shapeArgs,f=c.d,k=u(d.dial,b.dial);g?(g.animate(c),c.d=f):b.graphic=e[b.shapeType](c).attr({stroke:k.borderColor||"none","stroke-width":k.borderWidth||0,fill:k.backgroundColor||"black",rotation:c.rotation,zIndex:1}).add(a.group)});c?c.animate({translateX:b[0],
translateY:b[1]}):a.pivot=e.circle(0,0,o(g.radius,5)).attr({"stroke-width":g.borderWidth||0,stroke:g.borderColor||"silver",fill:g.backgroundColor||"black",zIndex:2}).translate(b[0],b[1]).add(a.group)},animate:function(a){var b=this;if(!a)t(b.points,function(a){var d=a.graphic;d&&(d.attr({rotation:b.yAxis.startAngleRad*180/Math.PI}),d.animate({rotation:a.shapeArgs.rotation},b.options.animation))}),b.animate=null},render:function(){this.group=this.plotGroup("group","series",this.visible?"visible":"hidden",
this.options.zIndex,this.chart.seriesGroup);x.prototype.render.call(this);this.group.clip(this.chart.clipRect)},setData:function(a,b){x.prototype.setData.call(this,a,!1);this.processData();this.generatePoints();o(b,!0)&&this.chart.redraw()},drawTracker:C&&C.drawTrackerPoint};i.gauge=v(i.line,C);p.boxplot=u(p.column,{fillColor:"#FFFFFF",lineWidth:1,medianWidth:2,states:{hover:{brightness:-0.3}},threshold:null,tooltip:{pointFormat:'<span style="color:{point.color}">\u25cf</span> <b> {series.name}</b><br/>Maximum: {point.high}<br/>Upper quartile: {point.q3}<br/>Median: {point.median}<br/>Lower quartile: {point.q1}<br/>Minimum: {point.low}<br/>'},
whiskerLength:"50%",whiskerWidth:2});i.boxplot=v(i.column,{type:"boxplot",pointArrayMap:["low","q1","median","q3","high"],toYData:function(a){return[a.low,a.q1,a.median,a.q3,a.high]},pointValKey:"high",pointAttrToOptions:{fill:"fillColor",stroke:"color","stroke-width":"lineWidth"},drawDataLabels:r,translate:function(){var a=this.yAxis,b=this.pointArrayMap;i.column.prototype.translate.apply(this);t(this.points,function(c){t(b,function(b){c[b]!==null&&(c[b+"Plot"]=a.translate(c[b],0,1,0,1))})})},drawPoints:function(){var a=
this,b=a.options,c=a.chart.renderer,d,g,e,j,l,h,f,k,n,i,m,J,K,p,u,r,w,v,x,y,C,B,z=a.doQuartiles!==!1,A,E=a.options.whiskerLength;t(a.points,function(q){n=q.graphic;C=q.shapeArgs;m={};p={};r={};B=q.color||a.color;if(q.plotY!==void 0)if(d=q.pointAttr[q.selected?"selected":""],w=C.width,v=D(C.x),x=v+w,y=F(w/2),g=D(z?q.q1Plot:q.lowPlot),e=D(z?q.q3Plot:q.lowPlot),j=D(q.highPlot),l=D(q.lowPlot),m.stroke=q.stemColor||b.stemColor||B,m["stroke-width"]=o(q.stemWidth,b.stemWidth,b.lineWidth),m.dashstyle=q.stemDashStyle||
b.stemDashStyle,p.stroke=q.whiskerColor||b.whiskerColor||B,p["stroke-width"]=o(q.whiskerWidth,b.whiskerWidth,b.lineWidth),r.stroke=q.medianColor||b.medianColor||B,r["stroke-width"]=o(q.medianWidth,b.medianWidth,b.lineWidth),f=m["stroke-width"]%2/2,k=v+y+f,i=["M",k,e,"L",k,j,"M",k,g,"L",k,l],z&&(f=d["stroke-width"]%2/2,k=D(k)+f,g=D(g)+f,e=D(e)+f,v+=f,x+=f,J=["M",v,e,"L",v,g,"L",x,g,"L",x,e,"L",v,e,"z"]),E&&(f=p["stroke-width"]%2/2,j+=f,l+=f,A=/%$/.test(E)?y*parseFloat(E)/100:E/2,K=["M",k-A,j,"L",k+
A,j,"M",k-A,l,"L",k+A,l]),f=r["stroke-width"]%2/2,h=F(q.medianPlot)+f,u=["M",v,h,"L",x,h],n)q.stem.animate({d:i}),E&&q.whiskers.animate({d:K}),z&&q.box.animate({d:J}),q.medianShape.animate({d:u});else{q.graphic=n=c.g().add(a.group);q.stem=c.path(i).attr(m).add(n);if(E)q.whiskers=c.path(K).attr(p).add(n);if(z)q.box=c.path(J).attr(d).add(n);q.medianShape=c.path(u).attr(r).add(n)}})},setStackedPoints:r});p.errorbar=u(p.boxplot,{color:"#000000",grouping:!1,linkedTo:":previous",tooltip:{pointFormat:'<span style="color:{point.color}">\u25cf</span> {series.name}: <b>{point.low}</b> - <b>{point.high}</b><br/>'},
whiskerWidth:null});i.errorbar=v(i.boxplot,{type:"errorbar",pointArrayMap:["low","high"],toYData:function(a){return[a.low,a.high]},pointValKey:"high",doQuartiles:!1,drawDataLabels:i.arearange?i.arearange.prototype.drawDataLabels:r,getColumnMetrics:function(){return this.linkedParent&&this.linkedParent.columnMetrics||i.column.prototype.getColumnMetrics.call(this)}});p.waterfall=u(p.column,{lineWidth:1,lineColor:"#333",dashStyle:"dot",borderColor:"#333",dataLabels:{inside:!0},states:{hover:{lineWidthPlus:0}}});
i.waterfall=v(i.column,{type:"waterfall",upColorProp:"fill",pointValKey:"y",translate:function(){var a=this.options,b=this.yAxis,c,d,g,e,j,l,h,f,k,n=o(a.minPointLength,5),s=a.threshold,m=a.stacking;i.column.prototype.translate.apply(this);this.minPointLengthOffset=0;h=f=s;d=this.points;for(c=0,a=d.length;c<a;c++){g=d[c];l=this.processedYData[c];e=g.shapeArgs;k=(j=m&&b.stacks[(this.negStacks&&l<s?"-":"")+this.stackKey])?j[g.x].points[this.index+","+c]:[0,l];if(g.isSum)g.y=G(l);else if(g.isIntermediateSum)g.y=
G(l-f);j=O(h,h+g.y)+k[0];e.y=b.translate(j,0,1);if(g.isSum)e.y=b.translate(k[1],0,1),e.height=Math.min(b.translate(k[0],0,1),b.len)-e.y+this.minPointLengthOffset;else if(g.isIntermediateSum)e.y=b.translate(k[1],0,1),e.height=Math.min(b.translate(f,0,1),b.len)-e.y+this.minPointLengthOffset,f=k[1];else{if(h!==0)e.height=l>0?b.translate(h,0,1)-e.y:b.translate(h,0,1)-b.translate(h-l,0,1);h+=l}e.height<0&&(e.y+=e.height,e.height*=-1);g.plotY=e.y=F(e.y)-this.borderWidth%2/2;e.height=O(F(e.height),0.001);
g.yBottom=e.y+e.height;if(e.height<=n)e.height=n,this.minPointLengthOffset+=n;e.y-=this.minPointLengthOffset;e=g.plotY+(g.negative?e.height:0)-this.minPointLengthOffset;this.chart.inverted?g.tooltipPos[0]=b.len-e:g.tooltipPos[1]=e}},processData:function(a){var b=this.yData,c=this.options.data,d,g=b.length,e,j,l,h,f,k;j=e=l=h=this.options.threshold||0;for(k=0;k<g;k++)f=b[k],d=c&&c[k]?c[k]:{},f==="sum"||d.isSum?b[k]=G(j):f==="intermediateSum"||d.isIntermediateSum?b[k]=G(e):(j+=f,e+=f),l=Math.min(j,
l),h=Math.max(j,h);x.prototype.processData.call(this,a);this.dataMin=l;this.dataMax=h},toYData:function(a){return a.isSum?a.x===0?null:"sum":a.isIntermediateSum?a.x===0?null:"intermediateSum":a.y},getAttribs:function(){i.column.prototype.getAttribs.apply(this,arguments);var a=this,b=a.options,c=b.states,d=b.upColor||a.color,b=m.Color(d).brighten(0.1).get(),g=u(a.pointAttr),e=a.upColorProp;g[""][e]=d;g.hover[e]=c.hover.upColor||b;g.select[e]=c.select.upColor||d;t(a.points,function(e){if(!e.options.color)e.y>
0?(e.pointAttr=g,e.color=d):e.pointAttr=a.pointAttr})},getGraphPath:function(){var a=this.data,b=a.length,c=F(this.options.lineWidth+this.borderWidth)%2/2,d=[],g,e,j;for(j=1;j<b;j++)e=a[j].shapeArgs,g=a[j-1].shapeArgs,e=["M",g.x+g.width,g.y+c,"L",e.x,g.y+c],a[j-1].y<0&&(e[2]+=g.height,e[5]+=g.height),d=d.concat(e);return d},getExtremes:r,drawGraph:x.prototype.drawGraph});p.polygon=u(p.scatter,{marker:{enabled:!1}});i.polygon=v(i.scatter,{type:"polygon",fillGraph:!0,getSegmentPath:function(a){return x.prototype.getSegmentPath.call(this,
a).concat("z")},drawGraph:x.prototype.drawGraph,drawLegendSymbol:m.LegendSymbolMixin.drawRectangle});p.bubble=u(p.scatter,{dataLabels:{formatter:function(){return this.point.z},inside:!0,verticalAlign:"middle"},marker:{lineColor:null,lineWidth:1},minSize:8,maxSize:"20%",softThreshold:!1,states:{hover:{halo:{size:5}}},tooltip:{pointFormat:"({point.x}, {point.y}), Size: {point.z}"},turboThreshold:0,zThreshold:0,zoneAxis:"z"});C=v(I,{haloPath:function(){return I.prototype.haloPath.call(this,this.shapeArgs.r+
this.series.options.states.hover.halo.size)},ttBelow:!1});i.bubble=v(i.scatter,{type:"bubble",pointClass:C,pointArrayMap:["y","z"],parallelArrays:["x","y","z"],trackerGroups:["group","dataLabelsGroup"],bubblePadding:!0,zoneAxis:"z",pointAttrToOptions:{stroke:"lineColor","stroke-width":"lineWidth",fill:"fillColor"},applyOpacity:function(a){var b=this.options.marker,c=o(b.fillOpacity,0.5),a=a||b.fillColor||this.color;c!==1&&(a=V(a).setOpacity(c).get("rgba"));return a},convertAttribs:function(){var a=
x.prototype.convertAttribs.apply(this,arguments);a.fill=this.applyOpacity(a.fill);return a},getRadii:function(a,b,c,d){var g,e,j,l=this.zData,h=[],f=this.options,k=f.sizeBy!=="width",n=f.zThreshold,i=b-a;for(e=0,g=l.length;e<g;e++)j=l[e],f.sizeByAbsoluteValue&&j!==null&&(j=Math.abs(j-n),b=Math.max(b-n,Math.abs(a-n)),a=0),j===null?j=null:j<a?j=c/2-1:(j=i>0?(j-a)/i:0.5,k&&j>=0&&(j=Math.sqrt(j)),j=y.ceil(c+j*(d-c))/2),h.push(j);this.radii=h},animate:function(a){var b=this.options.animation;if(!a)t(this.points,
function(a){var d=a.graphic,a=a.shapeArgs;d&&a&&(d.attr("r",1),d.animate({r:a.r},b))}),this.animate=null},translate:function(){var a,b=this.data,c,d,g=this.radii;i.scatter.prototype.translate.call(this);for(a=b.length;a--;)c=b[a],d=g?g[a]:0,typeof d==="number"&&d>=this.minPxSize/2?(c.shapeType="circle",c.shapeArgs={x:c.plotX,y:c.plotY,r:d},c.dlBox={x:c.plotX-d,y:c.plotY-d,width:2*d,height:2*d}):c.shapeArgs=c.plotY=c.dlBox=void 0},drawLegendSymbol:function(a,b){var c=this.chart.renderer,d=c.fontMetrics(a.itemStyle.fontSize).f/
2;b.legendSymbol=c.circle(d,a.baseline-d,d).attr({zIndex:3}).add(b.legendGroup);b.legendSymbol.isMarker=!0},drawPoints:i.column.prototype.drawPoints,alignDataLabel:i.column.prototype.alignDataLabel,buildKDTree:r,applyZones:r});N.prototype.beforePadding=function(){var a=this,b=this.len,c=this.chart,d=0,g=b,e=this.isXAxis,j=e?"xData":"yData",l=this.min,h={},f=y.min(c.plotWidth,c.plotHeight),k=Number.MAX_VALUE,n=-Number.MAX_VALUE,i=this.max-l,m=b/i,p=[];t(this.series,function(b){var g=b.options;if(b.bubblePadding&&
(b.visible||!c.options.chart.ignoreHiddenSeries))if(a.allowZoomOutside=!0,p.push(b),e)t(["minSize","maxSize"],function(a){var b=g[a],e=/%$/.test(b),b=B(b);h[a]=e?f*b/100:b}),b.minPxSize=h.minSize,b.maxPxSize=h.maxSize,b=b.zData,b.length&&(k=o(g.zMin,y.min(k,y.max(Q(b),g.displayNegative===!1?g.zThreshold:-Number.MAX_VALUE))),n=o(g.zMax,y.max(n,R(b))))});t(p,function(b){var c=b[j],f=c.length,h;e&&b.getRadii(k,n,b.minPxSize,b.maxPxSize);if(i>0)for(;f--;)typeof c[f]==="number"&&a.dataMin<=c[f]&&c[f]<=
a.dataMax&&(h=b.radii[f],d=Math.min((c[f]-l)*m-h,d),g=Math.max((c[f]-l)*m+h,g))});p.length&&i>0&&!this.isLog&&(g-=b,m*=(b+d-g)/b,t([["min","userMin",d],["max","userMax",g]],function(b){o(a.options[b[0]],a[b[1]])===void 0&&(a[b[0]]+=b[2]/m)}))};(function(){function a(a,b){var c=this.chart,d=this.options.animation,h=this.group,f=this.markerGroup,k=this.xAxis.center,i=c.plotLeft,m=c.plotTop;if(c.polar){if(c.renderer.isSVG)d===!0&&(d={}),b?(c={translateX:k[0]+i,translateY:k[1]+m,scaleX:0.001,scaleY:0.001},
h.attr(c),f&&f.attr(c)):(c={translateX:i,translateY:m,scaleX:1,scaleY:1},h.animate(c,d),f&&f.animate(c,d),this.animate=null)}else a.call(this,b)}var b=x.prototype,c=T.prototype,d;b.searchPointByAngle=function(a){var b=this.chart,c=this.xAxis.pane.center;return this.searchKDTree({clientX:180+Math.atan2(a.chartX-c[0]-b.plotLeft,a.chartY-c[1]-b.plotTop)*(-180/Math.PI)})};w(b,"buildKDTree",function(a){if(this.chart.polar)this.kdByAngle?this.searchPoint=this.searchPointByAngle:this.kdDimensions=2;a.apply(this)});
b.toXY=function(a){var b,c=this.chart,d=a.plotX;b=a.plotY;a.rectPlotX=d;a.rectPlotY=b;b=this.xAxis.postTranslate(a.plotX,this.yAxis.len-b);a.plotX=a.polarPlotX=b.x-c.plotLeft;a.plotY=a.polarPlotY=b.y-c.plotTop;this.kdByAngle?(c=(d/Math.PI*180+this.xAxis.pane.options.startAngle)%360,c<0&&(c+=360),a.clientX=c):a.clientX=a.plotX};i.spline&&w(i.spline.prototype,"getPointSpline",function(a,b,c,d){var h,f,k,i,m,p,o;if(this.chart.polar){h=c.plotX;f=c.plotY;a=b[d-1];k=b[d+1];this.connectEnds&&(a||(a=b[b.length-
2]),k||(k=b[1]));if(a&&k)i=a.plotX,m=a.plotY,b=k.plotX,p=k.plotY,i=(1.5*h+i)/2.5,m=(1.5*f+m)/2.5,k=(1.5*h+b)/2.5,o=(1.5*f+p)/2.5,b=Math.sqrt(Math.pow(i-h,2)+Math.pow(m-f,2)),p=Math.sqrt(Math.pow(k-h,2)+Math.pow(o-f,2)),i=Math.atan2(m-f,i-h),m=Math.atan2(o-f,k-h),o=Math.PI/2+(i+m)/2,Math.abs(i-o)>Math.PI/2&&(o-=Math.PI),i=h+Math.cos(o)*b,m=f+Math.sin(o)*b,k=h+Math.cos(Math.PI+o)*p,o=f+Math.sin(Math.PI+o)*p,c.rightContX=k,c.rightContY=o;d?(c=["C",a.rightContX||a.plotX,a.rightContY||a.plotY,i||h,m||
f,h,f],a.rightContX=a.rightContY=null):c=["M",h,f]}else c=a.call(this,b,c,d);return c});w(b,"translate",function(a){var b=this.chart;a.call(this);if(b.polar&&(this.kdByAngle=b.tooltip&&b.tooltip.shared,!this.preventPostTranslate)){a=this.points;for(b=a.length;b--;)this.toXY(a[b])}});w(b,"getGraphPath",function(a,b){var c=this;if(this.chart.polar){b=b||this.points;if(this.options.connectEnds!==!1&&b[0].y!==null)this.connectEnds=!0,b.splice(b.length,0,b[0]);t(b,function(a){a.polarPlotY===void 0&&c.toXY(a)})}return a.apply(this,
[].slice.call(arguments,1))});w(b,"animate",a);if(i.column)d=i.column.prototype,d.polarArc=function(a,b,c,d){var h=this.xAxis.center,f=this.yAxis.len;return this.chart.renderer.symbols.arc(h[0],h[1],f-b,null,{start:c,end:d,innerR:f-o(a,f)})},w(d,"animate",a),w(d,"translate",function(a){var b=this.xAxis,c=b.startAngleRad,d,h,f;this.preventPostTranslate=!0;a.call(this);if(b.isRadial){d=this.points;for(f=d.length;f--;)h=d[f],a=h.barX+c,h.shapeType="path",h.shapeArgs=this.polarArc(h.yBottom,h.plotY,a,
a+h.pointWidth),this.toXY(h),h.tooltipPos=[h.plotX,h.plotY],h.ttBelow=h.plotY>b.center[1]}}),w(d,"alignDataLabel",function(a,c,d,i,h,f){if(this.chart.polar){a=c.rectPlotX/Math.PI*180;if(i.align===null)i.align=a>20&&a<160?"left":a>200&&a<340?"right":"center";if(i.verticalAlign===null)i.verticalAlign=a<45||a>315?"bottom":a>135&&a<225?"top":"middle";b.alignDataLabel.call(this,c,d,i,h,f)}else a.call(this,c,d,i,h,f)});w(c,"getCoordinates",function(a,b){var c=this.chart,d={xAxis:[],yAxis:[]};c.polar?t(c.axes,
function(a){var f=a.isXAxis,g=a.center,i=b.chartX-g[0]-c.plotLeft,g=b.chartY-g[1]-c.plotTop;d[f?"xAxis":"yAxis"].push({axis:a,value:a.translate(f?Math.PI-Math.atan2(i,g):Math.sqrt(Math.pow(i,2)+Math.pow(g,2)),!0)})}):d=a.call(this,b);return d})})()});

},{}],2:[function(require,module,exports){
/*
 Highstock JS v4.2.4 (2016-04-14)

 (c) 2009-2016 Torstein Honsi

 License: www.highcharts.com/license
*/
(function(J,ga){typeof module==="object"&&module.exports?module.exports=J.document?ga(J):ga:J.Highcharts=ga(J)})(typeof window!=="undefined"?window:this,function(J){function ga(a,b){var c="Highcharts error #"+a+": www.highcharts.com/errors/"+a;if(b)throw Error(c);J.console&&console.log(c)}function yb(a,b,c){this.options=b;this.elem=a;this.prop=c}function C(){var a,b=arguments,c,d={},e=function(a,b){var c,d;typeof a!=="object"&&(a={});for(d in b)b.hasOwnProperty(d)&&(c=b[d],a[d]=c&&typeof c==="object"&&
Object.prototype.toString.call(c)!=="[object Array]"&&d!=="renderTo"&&typeof c.nodeType!=="number"?e(a[d]||{},c):b[d]);return a};b[0]===!0&&(d=b[1],b=Array.prototype.slice.call(b,2));c=b.length;for(a=0;a<c;a++)d=e(d,b[a]);return d}function G(a,b){return parseInt(a,b||10)}function Da(a){return typeof a==="string"}function da(a){return a&&typeof a==="object"}function Ja(a){return Object.prototype.toString.call(a)==="[object Array]"}function ua(a){return typeof a==="number"}function Aa(a,b){for(var c=
a.length;c--;)if(a[c]===b){a.splice(c,1);break}}function s(a){return a!==t&&a!==null}function X(a,b,c){var d,e;if(Da(b))s(c)?a.setAttribute(b,c):a&&a.getAttribute&&(e=a.getAttribute(b));else if(s(b)&&da(b))for(d in b)a.setAttribute(d,b[d]);return e}function va(a){return Ja(a)?a:[a]}function $a(a,b,c){if(b)return setTimeout(a,b,c);a.call(0,c)}function F(a,b){if(Ka&&!ja&&b&&b.opacity!==t)b.filter="alpha(opacity="+b.opacity*100+")";x(a.style,b)}function ea(a,b,c,d,e){a=B.createElement(a);b&&x(a,b);e&&
F(a,{padding:0,border:"none",margin:0});c&&F(a,c);d&&d.appendChild(a);return a}function la(a,b){var c=function(){};c.prototype=new a;x(c.prototype,b);return c}function Na(a,b,c){return Array((b||2)+1-String(a).length).join(c||0)+a}function fb(a){return(gb&&gb(a)||zb||0)*6E4}function La(a,b){for(var c="{",d=!1,e,f,g,h,i,j=[];(c=a.indexOf(c))!==-1;){e=a.slice(0,c);if(d){f=e.split(":");g=f.shift().split(".");i=g.length;e=b;for(h=0;h<i;h++)e=e[g[h]];if(f.length)f=f.join(":"),g=/\.([0-9])/,h=N.lang,i=
void 0,/f$/.test(f)?(i=(i=f.match(g))?i[1]:-1,e!==null&&(e=z.numberFormat(e,i,h.decimalPoint,f.indexOf(",")>-1?h.thousandsSep:""))):e=ma(f,e)}j.push(e);a=a.slice(c+1);c=(d=!d)?"}":"{"}j.push(a);return j.join("")}function Ab(a){return Y.pow(10,V(Y.log(a)/Y.LN10))}function Bb(a,b,c,d,e){var f,g=a,c=q(c,1);f=a/c;b||(b=[1,2,2.5,5,10],d===!1&&(c===1?b=[1,2,5,10]:c<=0.1&&(b=[1/c])));for(d=0;d<b.length;d++)if(g=b[d],e&&g*c>=a||!e&&f<=(b[d]+(b[d+1]||b[d]))/2)break;g*=c;return g}function ob(a,b){var c=a.length,
d,e;for(e=0;e<c;e++)a[e].safeI=e;a.sort(function(a,c){d=b(a,c);return d===0?a.safeI-c.safeI:d});for(e=0;e<c;e++)delete a[e].safeI}function Oa(a){for(var b=a.length,c=a[0];b--;)a[b]<c&&(c=a[b]);return c}function Ea(a){for(var b=a.length,c=a[0];b--;)a[b]>c&&(c=a[b]);return c}function Pa(a,b){for(var c in a)a[c]&&a[c]!==b&&a[c].destroy&&a[c].destroy(),delete a[c]}function Va(a){pb||(pb=ea(Wa));a&&pb.appendChild(a);pb.innerHTML=""}function na(a,b){return parseFloat(a.toPrecision(b||14))}function ab(a,
b){b.renderer.globalAnimation=q(a,b.animation)}function hb(a){return da(a)?C(a):{duration:a?500:0}}function Ob(){var a=N.global,b=a.useUTC,c=b?"getUTC":"get",d=b?"setUTC":"set";fa=a.Date||J.Date;zb=b&&a.timezoneOffset;gb=b&&a.getTimezoneOffset;qb=function(a,c,d,h,i,j){var k;b?(k=fa.UTC.apply(0,arguments),k+=fb(k)):k=(new fa(a,c,q(d,1),q(h,0),q(i,0),q(j,0))).getTime();return k};Cb=c+"Minutes";Db=c+"Hours";Eb=c+"Day";bb=c+"Date";ib=c+"Month";jb=c+"FullYear";Pb=d+"Milliseconds";Qb=d+"Seconds";Rb=d+"Minutes";
Sb=d+"Hours";rb=d+"Date";Fb=d+"Month";Gb=d+"FullYear"}function wa(a){if(!(this instanceof wa))return new wa(a);this.init(a)}function Z(){}function cb(a,b,c,d){this.axis=a;this.pos=b;this.type=c||"";this.isNew=!0;!c&&!d&&this.addLabel()}function Tb(a,b,c,d,e){var f=a.chart.inverted;this.axis=a;this.isNegative=c;this.options=b;this.x=d;this.total=null;this.points={};this.stack=e;this.rightCliff=this.leftCliff=0;this.alignOptions={align:b.align||(f?c?"left":"right":"center"),verticalAlign:b.verticalAlign||
(f?"middle":c?"bottom":"top"),y:q(b.y,f?4:c?14:-6),x:q(b.x,f?c?-6:6:0)};this.textAlign=b.textAlign||(f?c?"right":"left":"center")}function Hb(a){var b=a.options,c=b.navigator,d=c.enabled,b=b.scrollbar,e=b.enabled,f=d?c.height:0,g=e?b.height:0;this.handles=[];this.scrollbarButtons=[];this.elementsToDestroy=[];this.chart=a;this.setBaseSeries();this.height=f;this.scrollbarHeight=g;this.scrollbarEnabled=e;this.navigatorEnabled=d;this.navigatorOptions=c;this.scrollbarOptions=b;this.outlineHeight=f+g;this.init()}
function Ib(a){this.init(a)}var t,B=J.document,Y=Math,y=Y.round,V=Y.floor,Fa=Y.ceil,v=Y.max,E=Y.min,S=Y.abs,ba=Y.cos,ka=Y.sin,Ba=Y.PI,pa=Ba*2/360,Ma=J.navigator&&J.navigator.userAgent||"",Ub=J.opera,Ka=/(msie|trident|edge)/i.test(Ma)&&!Ub,sb=B&&B.documentMode===8,tb=!Ka&&/AppleWebKit/.test(Ma),Xa=/Firefox/.test(Ma),kb=/(Mobile|Android|Windows Phone)/.test(Ma),Qa="http://www.w3.org/2000/svg",ja=B&&B.createElementNS&&!!B.createElementNS(Qa,"svg").createSVGRect,Zb=Xa&&parseInt(Ma.split("Firefox/")[1],
10)<4,qa=B&&!ja&&!Ka&&!!B.createElement("canvas").getContext,Ya,db,Vb={},Jb=0,pb,N,ma,H,ra=function(){},$=[],lb=0,Wa="div",$b=/^[0-9]+$/,ub=["plotTop","marginRight","marginBottom","plotLeft"],fa,qb,zb,gb,Cb,Db,Eb,bb,ib,jb,Pb,Qb,Rb,Sb,rb,Fb,Gb,K={},z;z=J.Highcharts?ga(16,!0):{win:J};z.seriesTypes=K;var Ra=[],xa,sa,n,Sa,Kb,ta,D,T,M,eb,Ta;yb.prototype={dSetter:function(){var a=this.paths[0],b=this.paths[1],c=[],d=this.now,e=a.length,f;if(d===1)c=this.toD;else if(e===b.length&&d<1)for(;e--;)f=parseFloat(a[e]),
c[e]=isNaN(f)?a[e]:d*parseFloat(b[e]-f)+f;else c=b;this.elem.attr("d",c)},update:function(){var a=this.elem,b=this.prop,c=this.now,d=this.options.step;if(this[b+"Setter"])this[b+"Setter"]();else a.attr?a.element&&a.attr(b,c):a.style[b]=c+this.unit;d&&d.call(a,c,this)},run:function(a,b,c){var d=this,e=function(a){return e.stopped?!1:d.step(a)},f;this.startTime=+new fa;this.start=a;this.end=b;this.unit=c;this.now=this.start;this.pos=0;e.elem=this.elem;if(e()&&Ra.push(e)===1)e.timerId=setInterval(function(){for(f=
0;f<Ra.length;f++)Ra[f]()||Ra.splice(f--,1);Ra.length||clearInterval(e.timerId)},13)},step:function(a){var b=+new fa,c,d=this.options;c=this.elem;var e=d.complete,f=d.duration,g=d.curAnim,h;if(c.attr&&!c.element)c=!1;else if(a||b>=f+this.startTime){this.now=this.end;this.pos=1;this.update();a=g[this.prop]=!0;for(h in g)g[h]!==!0&&(a=!1);a&&e&&e.call(c);c=!1}else this.pos=d.easing((b-this.startTime)/f),this.now=this.start+(this.end-this.start)*this.pos,this.update(),c=!0;return c},initPath:function(a,
b,c){var b=b||"",d=a.shift,e=b.indexOf("C")>-1,f=e?7:3,g,b=b.split(" "),c=[].concat(c),h=a.isArea,i=h?2:1,j=function(a){for(g=a.length;g--;)(a[g]==="M"||a[g]==="L")&&a.splice(g+1,0,a[g+1],a[g+2],a[g+1],a[g+2])};e&&(j(b),j(c));if(d<=c.length/f&&b.length===c.length)for(;d--;)c=c.slice(0,f).concat(c),h&&(c=c.concat(c.slice(c.length-f)));a.shift=0;if(b.length)for(a=c.length;b.length<a;)d=b.slice().splice(b.length/i-f,f*i),e&&(d[f-6]=d[f-2],d[f-5]=d[f-1]),[].splice.apply(b,[b.length/i,0].concat(d));return[b,
c]}};var x=z.extend=function(a,b){var c;a||(a={});for(c in b)a[c]=b[c];return a},q=z.pick=function(){var a=arguments,b,c,d=a.length;for(b=0;b<d;b++)if(c=a[b],c!==t&&c!==null)return c},U=z.wrap=function(a,b,c){var d=a[b];a[b]=function(){var a=Array.prototype.slice.call(arguments);a.unshift(d);return c.apply(this,a)}};ma=function(a,b,c){if(!s(b)||isNaN(b))return N.lang.invalidDate||"";var a=q(a,"%Y-%m-%d %H:%M:%S"),d=new fa(b-fb(b)),e,f=d[Db](),g=d[Eb](),h=d[bb](),i=d[ib](),j=d[jb](),k=N.lang,l=k.weekdays,
m=k.shortWeekdays,d=x({a:m?m[g]:l[g].substr(0,3),A:l[g],d:Na(h),e:Na(h,2," "),w:g,b:k.shortMonths[i],B:k.months[i],m:Na(i+1),y:j.toString().substr(2,2),Y:j,H:Na(f),k:f,I:Na(f%12||12),l:f%12||12,M:Na(d[Cb]()),p:f<12?"AM":"PM",P:f<12?"am":"pm",S:Na(d.getSeconds()),L:Na(y(b%1E3),3)},z.dateFormats);for(e in d)for(;a.indexOf("%"+e)!==-1;)a=a.replace("%"+e,typeof d[e]==="function"?d[e](b):d[e]);return c?a.substr(0,1).toUpperCase()+a.substr(1):a};H={millisecond:1,second:1E3,minute:6E4,hour:36E5,day:864E5,
week:6048E5,month:24192E5,year:314496E5};z.numberFormat=function(a,b,c,d){var a=+a||0,e=N.lang,f=(a.toString().split(".")[1]||"").length,g,h,i=Math.abs(a);b===-1?b=Math.min(f,20):isNaN(b)&&(b=2);g=String(G(i.toFixed(b)));h=g.length>3?g.length%3:0;c=q(c,e.decimalPoint);d=q(d,e.thousandsSep);a=a<0?"-":"";a+=h?g.substr(0,h)+d:"";a+=g.substr(h).replace(/(\d{3})(?=\d)/g,"$1"+d);+b&&(d=Math.abs(i-g+Math.pow(10,-Math.max(b,f)-1)),a+=c+d.toFixed(b).slice(2));return a};Math.easeInOutSine=function(a){return-0.5*
(Math.cos(Math.PI*a)-1)};xa=function(a,b){var c;if(b==="width")return Math.min(a.offsetWidth,a.scrollWidth)-xa(a,"padding-left")-xa(a,"padding-right");else if(b==="height")return Math.min(a.offsetHeight,a.scrollHeight)-xa(a,"padding-top")-xa(a,"padding-bottom");return(c=J.getComputedStyle(a,void 0))&&G(c.getPropertyValue(b))};sa=function(a,b){return b.indexOf?b.indexOf(a):[].indexOf.call(b,a)};Sa=function(a,b){return[].filter.call(a,b)};ta=function(a,b){for(var c=[],d=0,e=a.length;d<e;d++)c[d]=b.call(a[d],
a[d],d,a);return c};Kb=function(a){var b=B.documentElement,a=a.getBoundingClientRect();return{top:a.top+(J.pageYOffset||b.scrollTop)-(b.clientTop||0),left:a.left+(J.pageXOffset||b.scrollLeft)-(b.clientLeft||0)}};Ta=function(a){for(var b=Ra.length;b--;)if(Ra[b].elem===a)Ra[b].stopped=!0};n=function(a,b){return Array.prototype.forEach.call(a,b)};D=function(a,b,c){function d(b){b.target=b.srcElement||J;c.call(a,b)}var e=a.hcEvents=a.hcEvents||{};if(a.addEventListener)a.addEventListener(b,c,!1);else if(a.attachEvent){if(!a.hcEventsIE)a.hcEventsIE=
{};a.hcEventsIE[c.toString()]=d;a.attachEvent("on"+b,d)}e[b]||(e[b]=[]);e[b].push(c)};T=function(a,b,c){function d(b,c){a.removeEventListener?a.removeEventListener(b,c,!1):a.attachEvent&&(c=a.hcEventsIE[c.toString()],a.detachEvent("on"+b,c))}function e(){var c,e,f;if(a.nodeName)for(f in b?(c={},c[b]=!0):c=g,c)if(g[f])for(e=g[f].length;e--;)d(f,g[f][e])}var f,g=a.hcEvents,h;if(g)b?(f=g[b]||[],c?(h=sa(c,f),h>-1&&(f.splice(h,1),g[b]=f),d(b,c)):(e(),g[b]=[])):(e(),a.hcEvents={})};M=function(a,b,c,d){var e;
e=a.hcEvents;var f,g,c=c||{};if(B.createEvent&&(a.dispatchEvent||a.fireEvent))e=B.createEvent("Events"),e.initEvent(b,!0,!0),e.target=a,x(e,c),a.dispatchEvent?a.dispatchEvent(e):a.fireEvent(b,e);else if(e){e=e[b]||[];f=e.length;if(!c.preventDefault)c.preventDefault=function(){c.defaultPrevented=!0};c.target=a;if(!c.type)c.type=b;for(b=0;b<f;b++)g=e[b],g.call(a,c)===!1&&c.preventDefault()}d&&!c.defaultPrevented&&d(c)};eb=function(a,b,c){var d,e="",f,g,h;da(c)||(d=arguments,c={duration:d[2],easing:d[3],
complete:d[4]});if(!ua(c.duration))c.duration=400;c.easing=typeof c.easing==="function"?c.easing:Math[c.easing]||Math.easeInOutSine;c.curAnim=C(b);for(h in b)g=new yb(a,c,h),f=null,h==="d"?(g.paths=g.initPath(a,a.d,b.d),g.toD=b.d,d=0,f=1):a.attr?d=a.attr(h):(d=parseFloat(xa(a,h))||0,h!=="opacity"&&(e="px")),f||(f=b[h]),f.match&&f.match("px")&&(f=f.replace(/px/g,"")),g.run(d,f,e)};if(J.jQuery)J.jQuery.fn.highcharts=function(){var a=[].slice.call(arguments);if(this[0])return a[0]?(new (z[Da(a[0])?a.shift():
"Chart"])(this[0],a[0],a[1]),this):$[X(this[0],"data-highcharts-chart")]};B&&!B.defaultView&&(xa=function(a,b){var c;c={width:"clientWidth",height:"clientHeight"}[b];if(a.style[b])return G(a.style[b]);b==="opacity"&&(b="filter");if(c)return a.style.zoom=1,Math.max(a[c]-2*xa(a,"padding"),0);c=a.currentStyle[b.replace(/\-(\w)/g,function(a,b){return b.toUpperCase()})];b==="filter"&&(c=c.replace(/alpha\(opacity=([0-9]+)\)/,function(a,b){return b/100}));return c===""?1:G(c)});Array.prototype.forEach||
(n=function(a,b){for(var c=0,d=a.length;c<d;c++)if(b.call(a[c],a[c],c,a)===!1)return c});Array.prototype.indexOf||(sa=function(a,b){var c,d=0;if(b)for(c=b.length;d<c;d++)if(b[d]===a)return d;return-1});Array.prototype.filter||(Sa=function(a,b){for(var c=[],d=0,e=a.length;d<e;d++)b(a[d],d)&&c.push(a[d]);return c});z.Fx=yb;z.inArray=sa;z.each=n;z.grep=Sa;z.offset=Kb;z.map=ta;z.addEvent=D;z.removeEvent=T;z.fireEvent=M;z.animate=eb;z.animObject=hb;z.stop=Ta;N={colors:"#7cb5ec,#434348,#90ed7d,#f7a35c,#8085e9,#f15c80,#e4d354,#2b908f,#f45b5b,#91e8e1".split(","),
symbols:["circle","diamond","square","triangle","triangle-down"],lang:{loading:"Loading...",months:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),shortMonths:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),weekdays:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),decimalPoint:".",numericSymbols:"k,M,G,T,P,E".split(","),resetZoom:"Reset zoom",resetZoomTitle:"Reset zoom level 1:1",thousandsSep:" "},global:{useUTC:!0,
canvasToolsURL:"http://code.highcharts.com/modules/canvas-tools.js",VMLRadialGradientURL:"http://code.highcharts.com/stock/4.2.4/gfx/vml-radial-gradient.png"},chart:{borderColor:"#4572A7",borderRadius:0,defaultSeriesType:"line",ignoreHiddenSeries:!0,spacing:[10,10,15,10],backgroundColor:"#FFFFFF",plotBorderColor:"#C0C0C0",resetZoomButton:{theme:{zIndex:20},position:{align:"right",x:-10,y:10}}},title:{text:"Chart title",align:"center",margin:15,style:{color:"#333333",fontSize:"18px"}},subtitle:{text:"",
align:"center",style:{color:"#555555"}},plotOptions:{line:{allowPointSelect:!1,showCheckbox:!1,animation:{duration:1E3},events:{},lineWidth:2,marker:{lineWidth:0,radius:4,lineColor:"#FFFFFF",states:{hover:{enabled:!0,lineWidthPlus:1,radiusPlus:2},select:{fillColor:"#FFFFFF",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:{align:"center",formatter:function(){return this.y===null?"":z.numberFormat(this.y,-1)},style:{color:"contrast",fontSize:"11px",fontWeight:"bold",textShadow:"0 0 6px contrast, 0 0 3px contrast"},
verticalAlign:"bottom",x:0,y:0,padding:5},cropThreshold:300,pointRange:0,softThreshold:!0,states:{hover:{lineWidthPlus:1,marker:{},halo:{size:10,opacity:0.25}},select:{marker:{}}},stickyTracking:!0,turboThreshold:1E3}},labels:{style:{position:"absolute",color:"#3E576F"}},legend:{enabled:!0,align:"center",layout:"horizontal",labelFormatter:function(){return this.name},borderColor:"#909090",borderRadius:0,navigation:{activeColor:"#274b6d",inactiveColor:"#CCC"},shadow:!1,itemStyle:{color:"#333333",fontSize:"12px",
fontWeight:"bold"},itemHoverStyle:{color:"#000"},itemHiddenStyle:{color:"#CCC"},itemCheckboxStyle:{position:"absolute",width:"13px",height:"13px"},symbolPadding:5,verticalAlign:"bottom",x:0,y:0,title:{style:{fontWeight:"bold"}}},loading:{labelStyle:{fontWeight:"bold",position:"relative",top:"45%"},style:{position:"absolute",backgroundColor:"white",opacity:0.5,textAlign:"center"}},tooltip:{enabled:!0,animation:ja,backgroundColor:"rgba(249, 249, 249, .85)",borderWidth:1,borderRadius:3,dateTimeLabelFormats:{millisecond:"%A, %b %e, %H:%M:%S.%L",
second:"%A, %b %e, %H:%M:%S",minute:"%A, %b %e, %H:%M",hour:"%A, %b %e, %H:%M",day:"%A, %b %e, %Y",week:"Week from %A, %b %e, %Y",month:"%B %Y",year:"%Y"},footerFormat:"",headerFormat:'<span style="font-size: 10px">{point.key}</span><br/>',pointFormat:'<span style="color:{point.color}">\u25cf</span> {series.name}: <b>{point.y}</b><br/>',shadow:!0,snap:kb?25:10,style:{color:"#333333",cursor:"default",fontSize:"12px",padding:"8px",pointerEvents:"none",whiteSpace:"nowrap"}},credits:{enabled:!0,text:"Highcharts.com",
href:"http://www.highcharts.com",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#909090",fontSize:"9px"}}};var W=N.plotOptions,ca=W.line;Ob();wa.prototype={parsers:[{regex:/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]?(?:\.[0-9]+)?)\s*\)/,parse:function(a){return[G(a[1]),G(a[2]),G(a[3]),parseFloat(a[4],10)]}},{regex:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,parse:function(a){return[G(a[1],16),G(a[2],16),G(a[3],16),1]}},
{regex:/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/,parse:function(a){return[G(a[1]),G(a[2]),G(a[3]),1]}}],init:function(a){var b,c,d,e;if((this.input=a)&&a.stops)this.stops=ta(a.stops,function(a){return new wa(a[1])});else for(d=this.parsers.length;d--&&!c;)e=this.parsers[d],(b=e.regex.exec(a))&&(c=e.parse(b));this.rgba=c||[]},get:function(a){var b=this.input,c=this.rgba,d;this.stops?(d=C(b),d.stops=[].concat(d.stops),n(this.stops,function(b,c){d.stops[c]=[d.stops[c][0],b.get(a)]})):
d=c&&!isNaN(c[0])?a==="rgb"||!a&&c[3]===1?"rgb("+c[0]+","+c[1]+","+c[2]+")":a==="a"?c[3]:"rgba("+c.join(",")+")":b;return d},brighten:function(a){var b,c=this.rgba;if(this.stops)n(this.stops,function(b){b.brighten(a)});else if(ua(a)&&a!==0)for(b=0;b<3;b++)c[b]+=G(a*255),c[b]<0&&(c[b]=0),c[b]>255&&(c[b]=255);return this},setOpacity:function(a){this.rgba[3]=a;return this}};Z.prototype={opacity:1,textProps:"direction,fontSize,fontWeight,fontFamily,fontStyle,color,lineHeight,width,textDecoration,textOverflow,textShadow".split(","),
init:function(a,b){this.element=b==="span"?ea(b):B.createElementNS(Qa,b);this.renderer=a},animate:function(a,b,c){b=q(b,this.renderer.globalAnimation,!0);Ta(this);if(b){if(c)b.complete=c;eb(this,a,b)}else this.attr(a,null,c);return this},colorGradient:function(a,b,c){var d=this.renderer,e,f,g,h,i,j,k,l,m,o,p,r=[],A;a.linearGradient?f="linearGradient":a.radialGradient&&(f="radialGradient");if(f){g=a[f];i=d.gradients;k=a.stops;o=c.radialReference;Ja(g)&&(a[f]=g={x1:g[0],y1:g[1],x2:g[2],y2:g[3],gradientUnits:"userSpaceOnUse"});
f==="radialGradient"&&o&&!s(g.gradientUnits)&&(h=g,g=C(g,d.getRadialAttr(o,h),{gradientUnits:"userSpaceOnUse"}));for(p in g)p!=="id"&&r.push(p,g[p]);for(p in k)r.push(k[p]);r=r.join(",");i[r]?o=i[r].attr("id"):(g.id=o="highcharts-"+Jb++,i[r]=j=d.createElement(f).attr(g).add(d.defs),j.radAttr=h,j.stops=[],n(k,function(a){a[1].indexOf("rgba")===0?(e=wa(a[1]),l=e.get("rgb"),m=e.get("a")):(l=a[1],m=1);a=d.createElement("stop").attr({offset:a[0],"stop-color":l,"stop-opacity":m}).add(j);j.stops.push(a)}));
A="url("+d.url+"#"+o+")";c.setAttribute(b,A);c.gradient=r;a.toString=function(){return A}}},applyTextShadow:function(a){var b=this.element,c,d=a.indexOf("contrast")!==-1,e={},f=this.renderer.forExport,g=f||b.style.textShadow!==t&&!Ka;if(d)e.textShadow=a=a.replace(/contrast/g,this.renderer.getContrast(b.style.fill));if(tb||f)e.textRendering="geometricPrecision";g?this.css(e):(this.fakeTS=!0,this.ySetter=this.xSetter,c=[].slice.call(b.getElementsByTagName("tspan")),n(a.split(/\s?,\s?/g),function(a){var d=
b.firstChild,e,f,a=a.split(" ");e=a[a.length-1];(f=a[a.length-2])&&n(c,function(a,c){var g;c===0&&(a.setAttribute("x",b.getAttribute("x")),c=b.getAttribute("y"),a.setAttribute("y",c||0),c===null&&b.setAttribute("y",0));g=a.cloneNode(1);X(g,{"class":"highcharts-text-shadow",fill:e,stroke:e,"stroke-opacity":1/v(G(f),3),"stroke-width":f,"stroke-linejoin":"round"});b.insertBefore(g,d)})}))},attr:function(a,b,c){var d,e=this.element,f,g=this,h;typeof a==="string"&&b!==t&&(d=a,a={},a[d]=b);if(typeof a===
"string")g=(this[a+"Getter"]||this._defaultGetter).call(this,a,e);else{for(d in a){b=a[d];h=!1;this.symbolName&&/^(x|y|width|height|r|start|end|innerR|anchorX|anchorY)/.test(d)&&(f||(this.symbolAttr(a),f=!0),h=!0);if(this.rotation&&(d==="x"||d==="y"))this.doTransform=!0;h||(h=this[d+"Setter"]||this._defaultSetter,h.call(this,b,d,e),this.shadows&&/^(width|height|visibility|x|y|d|transform|cx|cy|r)$/.test(d)&&this.updateShadows(d,b,h))}if(this.doTransform)this.updateTransform(),this.doTransform=!1}c&&
c();return g},updateShadows:function(a,b,c){for(var d=this.shadows,e=d.length;e--;)c.call(d[e],a==="height"?Math.max(b-(d[e].cutHeight||0),0):a==="d"?this.d:b,a,d[e])},addClass:function(a){var b=this.element,c=X(b,"class")||"";c.indexOf(a)===-1&&X(b,"class",c+" "+a);return this},symbolAttr:function(a){var b=this;n("x,y,r,start,end,width,height,innerR,anchorX,anchorY".split(","),function(c){b[c]=q(a[c],b[c])});b.attr({d:b.renderer.symbols[b.symbolName](b.x,b.y,b.width,b.height,b)})},clip:function(a){return this.attr("clip-path",
a?"url("+this.renderer.url+"#"+a.id+")":"none")},crisp:function(a){var b,c={},d,e=this.strokeWidth||0;d=y(e)%2/2;a.x=V(a.x||this.x||0)+d;a.y=V(a.y||this.y||0)+d;a.width=V((a.width||this.width||0)-2*d);a.height=V((a.height||this.height||0)-2*d);a.strokeWidth=e;for(b in a)this[b]!==a[b]&&(this[b]=c[b]=a[b]);return c},css:function(a){var b=this.styles,c={},d=this.element,e,f,g="";e=!b;if(a&&a.color)a.fill=a.color;if(b)for(f in a)a[f]!==b[f]&&(c[f]=a[f],e=!0);if(e){e=this.textWidth=a&&a.width&&d.nodeName.toLowerCase()===
"text"&&G(a.width)||this.textWidth;b&&(a=x(b,c));this.styles=a;e&&(qa||!ja&&this.renderer.forExport)&&delete a.width;if(Ka&&!ja)F(this.element,a);else{b=function(a,b){return"-"+b.toLowerCase()};for(f in a)g+=f.replace(/([A-Z])/g,b)+":"+a[f]+";";X(d,"style",g)}e&&this.added&&this.renderer.buildText(this)}return this},on:function(a,b){var c=this,d=c.element;db&&a==="click"?(d.ontouchstart=function(a){c.touchEventFired=fa.now();a.preventDefault();b.call(d,a)},d.onclick=function(a){(Ma.indexOf("Android")===
-1||fa.now()-(c.touchEventFired||0)>1100)&&b.call(d,a)}):d["on"+a]=b;return this},setRadialReference:function(a){var b=this.renderer.gradients[this.element.gradient];this.element.radialReference=a;b&&b.radAttr&&b.animate(this.renderer.getRadialAttr(a,b.radAttr));return this},translate:function(a,b){return this.attr({translateX:a,translateY:b})},invert:function(){this.inverted=!0;this.updateTransform();return this},updateTransform:function(){var a=this.translateX||0,b=this.translateY||0,c=this.scaleX,
d=this.scaleY,e=this.inverted,f=this.rotation,g=this.element;e&&(a+=this.attr("width"),b+=this.attr("height"));a=["translate("+a+","+b+")"];e?a.push("rotate(90) scale(-1,1)"):f&&a.push("rotate("+f+" "+(g.getAttribute("x")||0)+" "+(g.getAttribute("y")||0)+")");(s(c)||s(d))&&a.push("scale("+q(c,1)+" "+q(d,1)+")");a.length&&g.setAttribute("transform",a.join(" "))},toFront:function(){var a=this.element;a.parentNode.appendChild(a);return this},align:function(a,b,c){var d,e,f,g,h={};e=this.renderer;f=e.alignedObjects;
if(a){if(this.alignOptions=a,this.alignByTranslate=b,!c||Da(c))this.alignTo=d=c||"renderer",Aa(f,this),f.push(this),c=null}else a=this.alignOptions,b=this.alignByTranslate,d=this.alignTo;c=q(c,e[d],e);d=a.align;e=a.verticalAlign;f=(c.x||0)+(a.x||0);g=(c.y||0)+(a.y||0);if(d==="right"||d==="center")f+=(c.width-(a.width||0))/{right:1,center:2}[d];h[b?"translateX":"x"]=y(f);if(e==="bottom"||e==="middle")g+=(c.height-(a.height||0))/({bottom:1,middle:2}[e]||1);h[b?"translateY":"y"]=y(g);this[this.placed?
"animate":"attr"](h);this.placed=!0;this.alignAttr=h;return this},getBBox:function(a,b){var c,d=this.renderer,e,f,g,h=this.element,i=this.styles;e=this.textStr;var j,k=h.style,l,m=d.cache,o=d.cacheKeys,p;f=q(b,this.rotation);g=f*pa;e!==t&&(p=["",f||0,i&&i.fontSize,h.style.width].join(","),p=e===""||$b.test(e)?"num:"+e.toString().length+p:e+p);p&&!a&&(c=m[p]);if(!c){if(h.namespaceURI===Qa||d.forExport){try{l=this.fakeTS&&function(a){n(h.querySelectorAll(".highcharts-text-shadow"),function(b){b.style.display=
a})},Xa&&k.textShadow?(j=k.textShadow,k.textShadow=""):l&&l("none"),c=h.getBBox?x({},h.getBBox()):{width:h.offsetWidth,height:h.offsetHeight},j?k.textShadow=j:l&&l("")}catch(r){}if(!c||c.width<0)c={width:0,height:0}}else c=this.htmlGetBBox();if(d.isSVG){d=c.width;e=c.height;if(Ka&&i&&i.fontSize==="11px"&&e.toPrecision(3)==="16.9")c.height=e=14;if(f)c.width=S(e*ka(g))+S(d*ba(g)),c.height=S(e*ba(g))+S(d*ka(g))}if(p){for(;o.length>250;)delete m[o.shift()];m[p]||o.push(p);m[p]=c}}return c},show:function(a){return this.attr({visibility:a?
"inherit":"visible"})},hide:function(){return this.attr({visibility:"hidden"})},fadeOut:function(a){var b=this;b.animate({opacity:0},{duration:a||150,complete:function(){b.attr({y:-9999})}})},add:function(a){var b=this.renderer,c=this.element,d;if(a)this.parentGroup=a;this.parentInverted=a&&a.inverted;this.textStr!==void 0&&b.buildText(this);this.added=!0;if(!a||a.handleZ||this.zIndex)d=this.zIndexSetter();d||(a?a.element:b.box).appendChild(c);if(this.onAdd)this.onAdd();return this},safeRemoveChild:function(a){var b=
a.parentNode;b&&b.removeChild(a)},destroy:function(){var a=this,b=a.element||{},c=a.shadows,d=a.renderer.isSVG&&b.nodeName==="SPAN"&&a.parentGroup,e,f;b.onclick=b.onmouseout=b.onmouseover=b.onmousemove=b.point=null;Ta(a);if(a.clipPath)a.clipPath=a.clipPath.destroy();if(a.stops){for(f=0;f<a.stops.length;f++)a.stops[f]=a.stops[f].destroy();a.stops=null}a.safeRemoveChild(b);for(c&&n(c,function(b){a.safeRemoveChild(b)});d&&d.div&&d.div.childNodes.length===0;)b=d.parentGroup,a.safeRemoveChild(d.div),delete d.div,
d=b;a.alignTo&&Aa(a.renderer.alignedObjects,a);for(e in a)delete a[e];return null},shadow:function(a,b,c){var d=[],e,f,g=this.element,h,i,j,k;if(a){i=q(a.width,3);j=(a.opacity||0.15)/i;k=this.parentInverted?"(-1,-1)":"("+q(a.offsetX,1)+", "+q(a.offsetY,1)+")";for(e=1;e<=i;e++){f=g.cloneNode(0);h=i*2+1-2*e;X(f,{isShadow:"true",stroke:a.color||"black","stroke-opacity":j*e,"stroke-width":h,transform:"translate"+k,fill:"none"});if(c)X(f,"height",v(X(f,"height")-h,0)),f.cutHeight=h;b?b.element.appendChild(f):
g.parentNode.insertBefore(f,g);d.push(f)}this.shadows=d}return this},xGetter:function(a){this.element.nodeName==="circle"&&(a={x:"cx",y:"cy"}[a]||a);return this._defaultGetter(a)},_defaultGetter:function(a){a=q(this[a],this.element?this.element.getAttribute(a):null,0);/^[\-0-9\.]+$/.test(a)&&(a=parseFloat(a));return a},dSetter:function(a,b,c){a&&a.join&&(a=a.join(" "));/(NaN| {2}|^$)/.test(a)&&(a="M 0 0");c.setAttribute(b,a);this[b]=a},dashstyleSetter:function(a){var b,c=this["stroke-width"];c===
"inherit"&&(c=1);if(a=a&&a.toLowerCase()){a=a.replace("shortdashdotdot","3,1,1,1,1,1,").replace("shortdashdot","3,1,1,1").replace("shortdot","1,1,").replace("shortdash","3,1,").replace("longdash","8,3,").replace(/dot/g,"1,3,").replace("dash","4,3,").replace(/,$/,"").split(",");for(b=a.length;b--;)a[b]=G(a[b])*c;a=a.join(",").replace(/NaN/g,"none");this.element.setAttribute("stroke-dasharray",a)}},alignSetter:function(a){this.element.setAttribute("text-anchor",{left:"start",center:"middle",right:"end"}[a])},
opacitySetter:function(a,b,c){this[b]=a;c.setAttribute(b,a)},titleSetter:function(a){var b=this.element.getElementsByTagName("title")[0];b||(b=B.createElementNS(Qa,"title"),this.element.appendChild(b));b.appendChild(B.createTextNode(String(q(a),"").replace(/<[^>]*>/g,"")))},textSetter:function(a){if(a!==this.textStr)delete this.bBox,this.textStr=a,this.added&&this.renderer.buildText(this)},fillSetter:function(a,b,c){typeof a==="string"?c.setAttribute(b,a):a&&this.colorGradient(a,b,c)},visibilitySetter:function(a,
b,c){a==="inherit"?c.removeAttribute(b):c.setAttribute(b,a)},zIndexSetter:function(a,b){var c=this.renderer,d=this.parentGroup,c=(d||c).element||c.box,e,f,g=this.element,h;e=this.added;var i;if(s(a))g.zIndex=a,a=+a,this[b]===a&&(e=!1),this[b]=a;if(e){if((a=this.zIndex)&&d)d.handleZ=!0;d=c.childNodes;for(i=0;i<d.length&&!h;i++)if(e=d[i],f=e.zIndex,e!==g&&(G(f)>a||!s(a)&&s(f)))c.insertBefore(g,e),h=!0;h||c.appendChild(g)}return h},_defaultSetter:function(a,b,c){c.setAttribute(b,a)}};Z.prototype.yGetter=
Z.prototype.xGetter;Z.prototype.translateXSetter=Z.prototype.translateYSetter=Z.prototype.rotationSetter=Z.prototype.verticalAlignSetter=Z.prototype.scaleXSetter=Z.prototype.scaleYSetter=function(a,b){this[b]=a;this.doTransform=!0};Z.prototype["stroke-widthSetter"]=Z.prototype.strokeSetter=function(a,b,c){this[b]=a;if(this.stroke&&this["stroke-width"])this.strokeWidth=this["stroke-width"],Z.prototype.fillSetter.call(this,this.stroke,"stroke",c),c.setAttribute("stroke-width",this["stroke-width"]),
this.hasStroke=!0;else if(b==="stroke-width"&&a===0&&this.hasStroke)c.removeAttribute("stroke"),this.hasStroke=!1};var ya=function(){this.init.apply(this,arguments)};ya.prototype={Element:Z,init:function(a,b,c,d,e,f){var g,d=this.createElement("svg").attr({version:"1.1"}).css(this.getStyle(d));g=d.element;a.appendChild(g);a.innerHTML.indexOf("xmlns")===-1&&X(g,"xmlns",Qa);this.isSVG=!0;this.box=g;this.boxWrapper=d;this.alignedObjects=[];this.url=(Xa||tb)&&B.getElementsByTagName("base").length?J.location.href.replace(/#.*?$/,
"").replace(/([\('\)])/g,"\\$1").replace(/ /g,"%20"):"";this.createElement("desc").add().element.appendChild(B.createTextNode("Created with Highstock 4.2.4"));this.defs=this.createElement("defs").add();this.allowHTML=f;this.forExport=e;this.gradients={};this.cache={};this.cacheKeys=[];this.imgCount=0;this.setSize(b,c,!1);var h;if(Xa&&a.getBoundingClientRect)this.subPixelFix=b=function(){F(a,{left:0,top:0});h=a.getBoundingClientRect();F(a,{left:Fa(h.left)-h.left+"px",top:Fa(h.top)-h.top+"px"})},b(),
D(J,"resize",b)},getStyle:function(a){return this.style=x({fontFamily:'"Lucida Grande", "Lucida Sans Unicode", Arial, Helvetica, sans-serif',fontSize:"12px"},a)},isHidden:function(){return!this.boxWrapper.getBBox().width},destroy:function(){var a=this.defs;this.box=null;this.boxWrapper=this.boxWrapper.destroy();Pa(this.gradients||{});this.gradients=null;if(a)this.defs=a.destroy();this.subPixelFix&&T(J,"resize",this.subPixelFix);return this.alignedObjects=null},createElement:function(a){var b=new this.Element;
b.init(this,a);return b},draw:function(){},getRadialAttr:function(a,b){return{cx:a[0]-a[2]/2+b.cx*a[2],cy:a[1]-a[2]/2+b.cy*a[2],r:b.r*a[2]}},buildText:function(a){for(var b=a.element,c=this,d=c.forExport,e=q(a.textStr,"").toString(),f=e.indexOf("<")!==-1,g=b.childNodes,h,i,j=X(b,"x"),k=a.styles,l=a.textWidth,m=k&&k.lineHeight,o=k&&k.textShadow,p=k&&k.textOverflow==="ellipsis",r=g.length,A=l&&!a.added&&this.box,P=function(a){return m?G(m):c.fontMetrics(/(px|em)$/.test(a&&a.style.fontSize)?a.style.fontSize:
k&&k.fontSize||c.style.fontSize||12,a).h},u=function(a){return a.replace(/&lt;/g,"<").replace(/&gt;/g,">")};r--;)b.removeChild(g[r]);!f&&!o&&!p&&e.indexOf(" ")===-1?b.appendChild(B.createTextNode(u(e))):(h=/<.*style="([^"]+)".*>/,i=/<.*href="(http[^"]+)".*>/,A&&A.appendChild(b),e=f?e.replace(/<(b|strong)>/g,'<span style="font-weight:bold">').replace(/<(i|em)>/g,'<span style="font-style:italic">').replace(/<a/g,"<span").replace(/<\/(b|strong|i|em|a)>/g,"</span>").split(/<br.*?>/g):[e],e[e.length-1]===
""&&e.pop(),n(e,function(e,f){var g,m=0,e=e.replace(/<span/g,"|||<span").replace(/<\/span>/g,"</span>|||");g=e.split("|||");n(g,function(e){if(e!==""||g.length===1){var o={},r=B.createElementNS(Qa,"tspan"),A;h.test(e)&&(A=e.match(h)[1].replace(/(;| |^)color([ :])/,"$1fill$2"),X(r,"style",A));i.test(e)&&!d&&(X(r,"onclick",'location.href="'+e.match(i)[1]+'"'),F(r,{cursor:"pointer"}));e=u(e.replace(/<(.|\n)*?>/g,"")||" ");if(e!==" "){r.appendChild(B.createTextNode(e));if(m)o.dx=0;else if(f&&j!==null)o.x=
j;X(r,o);b.appendChild(r);!m&&f&&(!ja&&d&&F(r,{display:"block"}),X(r,"dy",P(r)));if(l){for(var o=e.replace(/([^\^])-/g,"$1- ").split(" "),q=g.length>1||f||o.length>1&&k.whiteSpace!=="nowrap",w,n,s,t=[],v=P(r),y=1,x=a.rotation,C=e,z=C.length;(q||p)&&(o.length||t.length);)a.rotation=0,w=a.getBBox(!0),s=w.width,!ja&&c.forExport&&(s=c.measureSpanWidth(r.firstChild.data,a.styles)),w=s>l,n===void 0&&(n=w),p&&n?(z/=2,C===""||!w&&z<0.5?o=[]:(w&&(n=!0),C=e.substring(0,C.length+(w?-1:1)*Fa(z)),o=[C+(l>3?"\u2026":
"")],r.removeChild(r.firstChild))):!w||o.length===1?(o=t,t=[],o.length&&(y++,r=B.createElementNS(Qa,"tspan"),X(r,{dy:v,x:j}),A&&X(r,"style",A),b.appendChild(r)),s>l&&(l=s)):(r.removeChild(r.firstChild),t.unshift(o.pop())),o.length&&r.appendChild(B.createTextNode(o.join(" ").replace(/- /g,"-")));n&&a.attr("title",a.textStr);a.rotation=x}m++}}})}),A&&A.removeChild(b),o&&a.applyTextShadow&&a.applyTextShadow(o))},getContrast:function(a){a=wa(a).rgba;return a[0]+a[1]+a[2]>384?"#000000":"#FFFFFF"},button:function(a,
b,c,d,e,f,g,h,i){var j=this.label(a,b,c,i,null,null,null,null,"button"),k=0,l,m,o,p,r,A,a={x1:0,y1:0,x2:0,y2:1},e=C({"stroke-width":1,stroke:"#CCCCCC",fill:{linearGradient:a,stops:[[0,"#FEFEFE"],[1,"#F6F6F6"]]},r:2,padding:5,style:{color:"black"}},e);o=e.style;delete e.style;f=C(e,{stroke:"#68A",fill:{linearGradient:a,stops:[[0,"#FFF"],[1,"#ACF"]]}},f);p=f.style;delete f.style;g=C(e,{stroke:"#68A",fill:{linearGradient:a,stops:[[0,"#9BD"],[1,"#CDF"]]}},g);r=g.style;delete g.style;h=C(e,{style:{color:"#CCC"}},
h);A=h.style;delete h.style;D(j.element,Ka?"mouseover":"mouseenter",function(){k!==3&&j.attr(f).css(p)});D(j.element,Ka?"mouseout":"mouseleave",function(){k!==3&&(l=[e,f,g][k],m=[o,p,r][k],j.attr(l).css(m))});j.setState=function(a){(j.state=k=a)?a===2?j.attr(g).css(r):a===3&&j.attr(h).css(A):j.attr(e).css(o)};return j.on("click",function(a){k!==3&&d.call(j,a)}).attr(e).css(x({cursor:"default"},o))},crispLine:function(a,b){a[1]===a[4]&&(a[1]=a[4]=y(a[1])-b%2/2);a[2]===a[5]&&(a[2]=a[5]=y(a[2])+b%2/
2);return a},path:function(a){var b={fill:"none"};Ja(a)?b.d=a:da(a)&&x(b,a);return this.createElement("path").attr(b)},circle:function(a,b,c){a=da(a)?a:{x:a,y:b,r:c};b=this.createElement("circle");b.xSetter=b.ySetter=function(a,b,c){c.setAttribute("c"+b,a)};return b.attr(a)},arc:function(a,b,c,d,e,f){if(da(a))b=a.y,c=a.r,d=a.innerR,e=a.start,f=a.end,a=a.x;a=this.symbol("arc",a||0,b||0,c||0,c||0,{innerR:d||0,start:e||0,end:f||0});a.r=c;return a},rect:function(a,b,c,d,e,f){var e=da(a)?a.r:e,g=this.createElement("rect"),
a=da(a)?a:a===t?{}:{x:a,y:b,width:v(c,0),height:v(d,0)};if(f!==t)g.strokeWidth=f,a=g.crisp(a);if(e)a.r=e;g.rSetter=function(a,b,c){X(c,{rx:a,ry:a})};return g.attr(a)},setSize:function(a,b,c){var d=this.alignedObjects,e=d.length;this.width=a;this.height=b;for(this.boxWrapper[q(c,!0)?"animate":"attr"]({width:a,height:b});e--;)d[e].align()},g:function(a){var b=this.createElement("g");return s(a)?b.attr({"class":"highcharts-"+a}):b},image:function(a,b,c,d,e){var f={preserveAspectRatio:"none"};arguments.length>
1&&x(f,{x:b,y:c,width:d,height:e});f=this.createElement("image").attr(f);f.element.setAttributeNS?f.element.setAttributeNS("http://www.w3.org/1999/xlink","href",a):f.element.setAttribute("hc-svg-href",a);return f},symbol:function(a,b,c,d,e,f){var g=this,h,i=this.symbols[a],i=i&&i(y(b),y(c),d,e,f),j=/^url\((.*?)\)$/,k,l;if(i)h=this.path(i),x(h,{symbolName:a,x:b,y:c,width:d,height:e}),f&&x(h,f);else if(j.test(a))l=function(a,b){a.element&&(a.attr({width:b[0],height:b[1]}),a.alignByTranslate||a.translate(y((d-
b[0])/2),y((e-b[1])/2)))},k=a.match(j)[1],a=Vb[k]||f&&f.width&&f.height&&[f.width,f.height],h=this.image(k).attr({x:b,y:c}),h.isImg=!0,a?l(h,a):(h.attr({width:0,height:0}),ea("img",{onload:function(){this.width===0&&(F(this,{position:"absolute",top:"-999em"}),B.body.appendChild(this));l(h,Vb[k]=[this.width,this.height]);this.parentNode&&this.parentNode.removeChild(this);g.imgCount--;if(!g.imgCount&&$[g.chartIndex].onload)$[g.chartIndex].onload()},src:k}),this.imgCount++);return h},symbols:{circle:function(a,
b,c,d){var e=0.166*c;return["M",a+c/2,b,"C",a+c+e,b,a+c+e,b+d,a+c/2,b+d,"C",a-e,b+d,a-e,b,a+c/2,b,"Z"]},square:function(a,b,c,d){return["M",a,b,"L",a+c,b,a+c,b+d,a,b+d,"Z"]},triangle:function(a,b,c,d){return["M",a+c/2,b,"L",a+c,b+d,a,b+d,"Z"]},"triangle-down":function(a,b,c,d){return["M",a,b,"L",a+c,b,a+c/2,b+d,"Z"]},diamond:function(a,b,c,d){return["M",a+c/2,b,"L",a+c,b+d/2,a+c/2,b+d,a,b+d/2,"Z"]},arc:function(a,b,c,d,e){var f=e.start,c=e.r||c||d,g=e.end-0.001,d=e.innerR,h=e.open,i=ba(f),j=ka(f),
k=ba(g),g=ka(g),e=e.end-f<Ba?0:1;return["M",a+c*i,b+c*j,"A",c,c,0,e,1,a+c*k,b+c*g,h?"M":"L",a+d*k,b+d*g,"A",d,d,0,e,0,a+d*i,b+d*j,h?"":"Z"]},callout:function(a,b,c,d,e){var f=E(e&&e.r||0,c,d),g=f+6,h=e&&e.anchorX,e=e&&e.anchorY,i;i=["M",a+f,b,"L",a+c-f,b,"C",a+c,b,a+c,b,a+c,b+f,"L",a+c,b+d-f,"C",a+c,b+d,a+c,b+d,a+c-f,b+d,"L",a+f,b+d,"C",a,b+d,a,b+d,a,b+d-f,"L",a,b+f,"C",a,b,a,b,a+f,b];h&&h>c&&e>b+g&&e<b+d-g?i.splice(13,3,"L",a+c,e-6,a+c+6,e,a+c,e+6,a+c,b+d-f):h&&h<0&&e>b+g&&e<b+d-g?i.splice(33,3,
"L",a,e+6,a-6,e,a,e-6,a,b+f):e&&e>d&&h>a+g&&h<a+c-g?i.splice(23,3,"L",h+6,b+d,h,b+d+6,h-6,b+d,a+f,b+d):e&&e<0&&h>a+g&&h<a+c-g&&i.splice(3,3,"L",h-6,b,h,b-6,h+6,b,c-f,b);return i}},clipRect:function(a,b,c,d){var e="highcharts-"+Jb++,f=this.createElement("clipPath").attr({id:e}).add(this.defs),a=this.rect(a,b,c,d,0).add(f);a.id=e;a.clipPath=f;a.count=0;return a},text:function(a,b,c,d){var e=qa||!ja&&this.forExport,f={};if(d&&(this.allowHTML||!this.forExport))return this.html(a,b,c);f.x=Math.round(b||
0);if(c)f.y=Math.round(c);if(a||a===0)f.text=a;a=this.createElement("text").attr(f);e&&a.css({position:"absolute"});if(!d)a.xSetter=function(a,b,c){var d=c.getElementsByTagName("tspan"),e,f=c.getAttribute(b),m;for(m=0;m<d.length;m++)e=d[m],e.getAttribute(b)===f&&e.setAttribute(b,a);c.setAttribute(b,a)};return a},fontMetrics:function(a,b){var c,d,a=a||this.style.fontSize;!a&&b&&J.getComputedStyle&&(b=b.element||b,a=(c=J.getComputedStyle(b,""))&&c.fontSize);a=/px/.test(a)?G(a):/em/.test(a)?parseFloat(a)*
12:12;c=a<24?a+3:y(a*1.2);d=y(c*0.8);return{h:c,b:d,f:a}},rotCorr:function(a,b,c){var d=a;b&&c&&(d=v(d*ba(b*pa),4));return{x:-a/3*ka(b*pa),y:d}},label:function(a,b,c,d,e,f,g,h,i){var j=this,k=j.g(i),l=j.text("",0,0,g).attr({zIndex:1}),m,o,p=0,r=3,A=0,q,u,w,O,R=0,ha={},v,z,L,E,B;L=function(){var a,b;a=l.element.style;o=(q===void 0||u===void 0||k.styles.textAlign)&&s(l.textStr)&&l.getBBox();k.width=(q||o.width||0)+2*r+A;k.height=(u||o.height||0)+2*r;v=r+j.fontMetrics(a&&a.fontSize,l).b;if(z){if(!m)a=
R,b=(h?-v:0)+R,k.box=m=d?j.symbol(d,a,b,k.width,k.height,ha):j.rect(a,b,k.width,k.height,0,ha["stroke-width"]),m.isImg||m.attr("fill","none"),m.add(k);m.isImg||m.attr(x({width:y(k.width),height:y(k.height)},ha));ha=null}};E=function(){var a=k.styles,a=a&&a.textAlign,b=A+r,c;c=h?0:v;if(s(q)&&o&&(a==="center"||a==="right"))b+={center:0.5,right:1}[a]*(q-o.width);if(b!==l.x||c!==l.y)l.attr("x",b),c!==t&&l.attr("y",c);l.x=b;l.y=c};B=function(a,b){m?m.attr(a,b):ha[a]=b};k.onAdd=function(){l.add(k);k.attr({text:a||
a===0?a:"",x:b,y:c});m&&s(e)&&k.attr({anchorX:e,anchorY:f})};k.widthSetter=function(a){q=a};k.heightSetter=function(a){u=a};k.paddingSetter=function(a){if(s(a)&&a!==r)r=k.padding=a,E()};k.paddingLeftSetter=function(a){s(a)&&a!==A&&(A=a,E())};k.alignSetter=function(a){a={left:0,center:0.5,right:1}[a];a!==p&&(p=a,o&&k.attr({x:w}))};k.textSetter=function(a){a!==t&&l.textSetter(a);L();E()};k["stroke-widthSetter"]=function(a,b){a&&(z=!0);R=a%2/2;B(b,a)};k.strokeSetter=k.fillSetter=k.rSetter=function(a,
b){b==="fill"&&a&&(z=!0);B(b,a)};k.anchorXSetter=function(a,b){e=a;B(b,y(a)-R-w)};k.anchorYSetter=function(a,b){f=a;B(b,a-O)};k.xSetter=function(a){k.x=a;p&&(a-=p*((q||o.width)+2*r));w=y(a);k.attr("translateX",w)};k.ySetter=function(a){O=k.y=y(a);k.attr("translateY",O)};var D=k.css;return x(k,{css:function(a){if(a){var b={},a=C(a);n(k.textProps,function(c){a[c]!==t&&(b[c]=a[c],delete a[c])});l.css(b)}return D.call(k,a)},getBBox:function(){return{width:o.width+2*r,height:o.height+2*r,x:o.x-r,y:o.y-
r}},shadow:function(a){m&&m.shadow(a);return k},destroy:function(){T(k.element,"mouseenter");T(k.element,"mouseleave");l&&(l=l.destroy());m&&(m=m.destroy());Z.prototype.destroy.call(k);k=j=L=E=B=null}})}};Ya=ya;x(Z.prototype,{htmlCss:function(a){var b=this.element;if(b=a&&b.tagName==="SPAN"&&a.width)delete a.width,this.textWidth=b,this.updateTransform();if(a&&a.textOverflow==="ellipsis")a.whiteSpace="nowrap",a.overflow="hidden";this.styles=x(this.styles,a);F(this.element,a);return this},htmlGetBBox:function(){var a=
this.element;if(a.nodeName==="text")a.style.position="absolute";return{x:a.offsetLeft,y:a.offsetTop,width:a.offsetWidth,height:a.offsetHeight}},htmlUpdateTransform:function(){if(this.added){var a=this.renderer,b=this.element,c=this.translateX||0,d=this.translateY||0,e=this.x||0,f=this.y||0,g=this.textAlign||"left",h={left:0,center:0.5,right:1}[g],i=this.shadows,j=this.styles;F(b,{marginLeft:c,marginTop:d});i&&n(i,function(a){F(a,{marginLeft:c+1,marginTop:d+1})});this.inverted&&n(b.childNodes,function(c){a.invertChild(c,
b)});if(b.tagName==="SPAN"){var i=this.rotation,k=G(this.textWidth),l=j&&j.whiteSpace,m=[i,g,b.innerHTML,this.textWidth,this.textAlign].join(",");if(m!==this.cTT){j=a.fontMetrics(b.style.fontSize).b;s(i)&&this.setSpanRotation(i,h,j);if(b.offsetWidth>k&&/[ \-]/.test(b.textContent||b.innerText))F(b,{width:k+"px",display:"block",whiteSpace:l||"normal"}),this.hasTextWidth=!0;else if(this.hasTextWidth)F(b,{width:"",display:"",whiteSpace:l||"nowrap"}),this.hasTextWidth=!1;this.getSpanCorrection(this.hasTextWidth?
k:b.offsetWidth,j,h,i,g)}F(b,{left:e+(this.xCorr||0)+"px",top:f+(this.yCorr||0)+"px"});if(tb)j=b.offsetHeight;this.cTT=m}}else this.alignOnAdd=!0},setSpanRotation:function(a,b,c){var d={},e=Ka?"-ms-transform":tb?"-webkit-transform":Xa?"MozTransform":Ub?"-o-transform":"";d[e]=d.transform="rotate("+a+"deg)";d[e+(Xa?"Origin":"-origin")]=d.transformOrigin=b*100+"% "+c+"px";F(this.element,d)},getSpanCorrection:function(a,b,c){this.xCorr=-a*c;this.yCorr=-b}});x(ya.prototype,{html:function(a,b,c){var d=
this.createElement("span"),e=d.element,f=d.renderer,g=f.isSVG,h=function(a,b){n(["opacity","visibility"],function(c){U(a,c+"Setter",function(a,c,d,e){a.call(this,c,d,e);b[d]=c})})};d.textSetter=function(a){a!==e.innerHTML&&delete this.bBox;e.innerHTML=this.textStr=a;d.htmlUpdateTransform()};g&&h(d,d.element.style);d.xSetter=d.ySetter=d.alignSetter=d.rotationSetter=function(a,b){b==="align"&&(b="textAlign");d[b]=a;d.htmlUpdateTransform()};d.attr({text:a,x:y(b),y:y(c)}).css({position:"absolute",fontFamily:this.style.fontFamily,
fontSize:this.style.fontSize});e.style.whiteSpace="nowrap";d.css=d.htmlCss;if(g)d.add=function(a){var b,c=f.box.parentNode,g=[];if(this.parentGroup=a){if(b=a.div,!b){for(;a;)g.push(a),a=a.parentGroup;n(g.reverse(),function(a){var d,e=X(a.element,"class");e&&(e={className:e});b=a.div=a.div||ea(Wa,e,{position:"absolute",left:(a.translateX||0)+"px",top:(a.translateY||0)+"px",opacity:a.opacity},b||c);d=b.style;x(a,{translateXSetter:function(b,c){d.left=b+"px";a[c]=b;a.doTransform=!0},translateYSetter:function(b,
c){d.top=b+"px";a[c]=b;a.doTransform=!0}});h(a,d)})}}else b=c;b.appendChild(e);d.added=!0;d.alignOnAdd&&d.htmlUpdateTransform();return d};return d}});var mb,aa;if(!ja&&!qa)aa={init:function(a,b){var c=["<",b,' filled="f" stroked="f"'],d=["position: ","absolute",";"],e=b===Wa;(b==="shape"||e)&&d.push("left:0;top:0;width:1px;height:1px;");d.push("visibility: ",e?"hidden":"visible");c.push(' style="',d.join(""),'"/>');if(b)c=e||b==="span"||b==="img"?c.join(""):a.prepVML(c),this.element=ea(c);this.renderer=
a},add:function(a){var b=this.renderer,c=this.element,d=b.box,e=a&&a.inverted,d=a?a.element||a:d;if(a)this.parentGroup=a;e&&b.invertChild(c,d);d.appendChild(c);this.added=!0;this.alignOnAdd&&!this.deferUpdateTransform&&this.updateTransform();if(this.onAdd)this.onAdd();return this},updateTransform:Z.prototype.htmlUpdateTransform,setSpanRotation:function(){var a=this.rotation,b=ba(a*pa),c=ka(a*pa);F(this.element,{filter:a?["progid:DXImageTransform.Microsoft.Matrix(M11=",b,", M12=",-c,", M21=",c,", M22=",
b,", sizingMethod='auto expand')"].join(""):"none"})},getSpanCorrection:function(a,b,c,d,e){var f=d?ba(d*pa):1,g=d?ka(d*pa):0,h=q(this.elemHeight,this.element.offsetHeight),i;this.xCorr=f<0&&-a;this.yCorr=g<0&&-h;i=f*g<0;this.xCorr+=g*b*(i?1-c:c);this.yCorr-=f*b*(d?i?c:1-c:1);e&&e!=="left"&&(this.xCorr-=a*c*(f<0?-1:1),d&&(this.yCorr-=h*c*(g<0?-1:1)),F(this.element,{textAlign:e}))},pathToVML:function(a){for(var b=a.length,c=[];b--;)if(ua(a[b]))c[b]=y(a[b]*10)-5;else if(a[b]==="Z")c[b]="x";else if(c[b]=
a[b],a.isArc&&(a[b]==="wa"||a[b]==="at"))c[b+5]===c[b+7]&&(c[b+7]+=a[b+7]>a[b+5]?1:-1),c[b+6]===c[b+8]&&(c[b+8]+=a[b+8]>a[b+6]?1:-1);return c.join(" ")||"x"},clip:function(a){var b=this,c;a?(c=a.members,Aa(c,b),c.push(b),b.destroyClip=function(){Aa(c,b)},a=a.getCSS(b)):(b.destroyClip&&b.destroyClip(),a={clip:sb?"inherit":"rect(auto)"});return b.css(a)},css:Z.prototype.htmlCss,safeRemoveChild:function(a){a.parentNode&&Va(a)},destroy:function(){this.destroyClip&&this.destroyClip();return Z.prototype.destroy.apply(this)},
on:function(a,b){this.element["on"+a]=function(){var a=J.event;a.target=a.srcElement;b(a)};return this},cutOffPath:function(a,b){var c,a=a.split(/[ ,]/);c=a.length;if(c===9||c===11)a[c-4]=a[c-2]=G(a[c-2])-10*b;return a.join(" ")},shadow:function(a,b,c){var d=[],e,f=this.element,g=this.renderer,h,i=f.style,j,k=f.path,l,m,o,p;k&&typeof k.value!=="string"&&(k="x");m=k;if(a){o=q(a.width,3);p=(a.opacity||0.15)/o;for(e=1;e<=3;e++){l=o*2+1-2*e;c&&(m=this.cutOffPath(k.value,l+0.5));j=['<shape isShadow="true" strokeweight="',
l,'" filled="false" path="',m,'" coordsize="10 10" style="',f.style.cssText,'" />'];h=ea(g.prepVML(j),null,{left:G(i.left)+q(a.offsetX,1),top:G(i.top)+q(a.offsetY,1)});if(c)h.cutOff=l+1;j=['<stroke color="',a.color||"black",'" opacity="',p*e,'"/>'];ea(g.prepVML(j),null,null,h);b?b.element.appendChild(h):f.parentNode.insertBefore(h,f);d.push(h)}this.shadows=d}return this},updateShadows:ra,setAttr:function(a,b){sb?this.element[a]=b:this.element.setAttribute(a,b)},classSetter:function(a){this.element.className=
a},dashstyleSetter:function(a,b,c){(c.getElementsByTagName("stroke")[0]||ea(this.renderer.prepVML(["<stroke/>"]),null,null,c))[b]=a||"solid";this[b]=a},dSetter:function(a,b,c){var d=this.shadows,a=a||[];this.d=a.join&&a.join(" ");c.path=a=this.pathToVML(a);if(d)for(c=d.length;c--;)d[c].path=d[c].cutOff?this.cutOffPath(a,d[c].cutOff):a;this.setAttr(b,a)},fillSetter:function(a,b,c){var d=c.nodeName;if(d==="SPAN")c.style.color=a;else if(d!=="IMG")c.filled=a!=="none",this.setAttr("fillcolor",this.renderer.color(a,
c,b,this))},"fill-opacitySetter":function(a,b,c){ea(this.renderer.prepVML(["<",b.split("-")[0],' opacity="',a,'"/>']),null,null,c)},opacitySetter:ra,rotationSetter:function(a,b,c){c=c.style;this[b]=c[b]=a;c.left=-y(ka(a*pa)+1)+"px";c.top=y(ba(a*pa))+"px"},strokeSetter:function(a,b,c){this.setAttr("strokecolor",this.renderer.color(a,c,b,this))},"stroke-widthSetter":function(a,b,c){c.stroked=!!a;this[b]=a;ua(a)&&(a+="px");this.setAttr("strokeweight",a)},titleSetter:function(a,b){this.setAttr(b,a)},
visibilitySetter:function(a,b,c){a==="inherit"&&(a="visible");this.shadows&&n(this.shadows,function(c){c.style[b]=a});c.nodeName==="DIV"&&(a=a==="hidden"?"-999em":0,sb||(c.style[b]=a?"visible":"hidden"),b="top");c.style[b]=a},xSetter:function(a,b,c){this[b]=a;b==="x"?b="left":b==="y"&&(b="top");this.updateClipping?(this[b]=a,this.updateClipping()):c.style[b]=a},zIndexSetter:function(a,b,c){c.style[b]=a}},aa["stroke-opacitySetter"]=aa["fill-opacitySetter"],z.VMLElement=aa=la(Z,aa),aa.prototype.ySetter=
aa.prototype.widthSetter=aa.prototype.heightSetter=aa.prototype.xSetter,aa={Element:aa,isIE8:Ma.indexOf("MSIE 8.0")>-1,init:function(a,b,c,d){var e;this.alignedObjects=[];d=this.createElement(Wa).css(x(this.getStyle(d),{position:"relative"}));e=d.element;a.appendChild(d.element);this.isVML=!0;this.box=e;this.boxWrapper=d;this.gradients={};this.cache={};this.cacheKeys=[];this.imgCount=0;this.setSize(b,c,!1);if(!B.namespaces.hcv){B.namespaces.add("hcv","urn:schemas-microsoft-com:vml");try{B.createStyleSheet().cssText=
"hcv\\:fill, hcv\\:path, hcv\\:shape, hcv\\:stroke{ behavior:url(#default#VML); display: inline-block; } "}catch(f){B.styleSheets[0].cssText+="hcv\\:fill, hcv\\:path, hcv\\:shape, hcv\\:stroke{ behavior:url(#default#VML); display: inline-block; } "}}},isHidden:function(){return!this.box.offsetWidth},clipRect:function(a,b,c,d){var e=this.createElement(),f=da(a);return x(e,{members:[],count:0,left:(f?a.x:a)+1,top:(f?a.y:b)+1,width:(f?a.width:c)-1,height:(f?a.height:d)-1,getCSS:function(a){var b=a.element,
c=b.nodeName,a=a.inverted,d=this.top-(c==="shape"?b.offsetTop:0),e=this.left,b=e+this.width,f=d+this.height,d={clip:"rect("+y(a?e:d)+"px,"+y(a?f:b)+"px,"+y(a?b:f)+"px,"+y(a?d:e)+"px)"};!a&&sb&&c==="DIV"&&x(d,{width:b+"px",height:f+"px"});return d},updateClipping:function(){n(e.members,function(a){a.element&&a.css(e.getCSS(a))})}})},color:function(a,b,c,d){var e=this,f,g=/^rgba/,h,i,j="none";a&&a.linearGradient?i="gradient":a&&a.radialGradient&&(i="pattern");if(i){var k,l,m=a.linearGradient||a.radialGradient,
o,p,r,A,q,u="",a=a.stops,w,O=[],R=function(){h=['<fill colors="'+O.join(",")+'" opacity="',r,'" o:opacity2="',p,'" type="',i,'" ',u,'focus="100%" method="any" />'];ea(e.prepVML(h),null,null,b)};o=a[0];w=a[a.length-1];o[0]>0&&a.unshift([0,o[1]]);w[0]<1&&a.push([1,w[1]]);n(a,function(a,b){g.test(a[1])?(f=wa(a[1]),k=f.get("rgb"),l=f.get("a")):(k=a[1],l=1);O.push(a[0]*100+"% "+k);b?(r=l,A=k):(p=l,q=k)});if(c==="fill")if(i==="gradient")c=m.x1||m[0]||0,a=m.y1||m[1]||0,o=m.x2||m[2]||0,m=m.y2||m[3]||0,u=
'angle="'+(90-Y.atan((m-a)/(o-c))*180/Ba)+'"',R();else{var j=m.r,ha=j*2,s=j*2,v=m.cx,t=m.cy,y=b.radialReference,x,j=function(){y&&(x=d.getBBox(),v+=(y[0]-x.x)/x.width-0.5,t+=(y[1]-x.y)/x.height-0.5,ha*=y[2]/x.width,s*=y[2]/x.height);u='src="'+N.global.VMLRadialGradientURL+'" size="'+ha+","+s+'" origin="0.5,0.5" position="'+v+","+t+'" color2="'+q+'" ';R()};d.added?j():d.onAdd=j;j=A}else j=k}else if(g.test(a)&&b.tagName!=="IMG")f=wa(a),d[c+"-opacitySetter"](f.get("a"),c,b),j=f.get("rgb");else{j=b.getElementsByTagName(c);
if(j.length)j[0].opacity=1,j[0].type="solid";j=a}return j},prepVML:function(a){var b=this.isIE8,a=a.join("");b?(a=a.replace("/>",' xmlns="urn:schemas-microsoft-com:vml" />'),a=a.indexOf('style="')===-1?a.replace("/>",' style="display:inline-block;behavior:url(#default#VML);" />'):a.replace('style="','style="display:inline-block;behavior:url(#default#VML);')):a=a.replace("<","<hcv:");return a},text:ya.prototype.html,path:function(a){var b={coordsize:"10 10"};Ja(a)?b.d=a:da(a)&&x(b,a);return this.createElement("shape").attr(b)},
circle:function(a,b,c){var d=this.symbol("circle");if(da(a))c=a.r,b=a.y,a=a.x;d.isCircle=!0;d.r=c;return d.attr({x:a,y:b})},g:function(a){var b;a&&(b={className:"highcharts-"+a,"class":"highcharts-"+a});return this.createElement(Wa).attr(b)},image:function(a,b,c,d,e){var f=this.createElement("img").attr({src:a});arguments.length>1&&f.attr({x:b,y:c,width:d,height:e});return f},createElement:function(a){return a==="rect"?this.symbol(a):ya.prototype.createElement.call(this,a)},invertChild:function(a,
b){var c=this,d=b.style,e=a.tagName==="IMG"&&a.style;F(a,{flip:"x",left:G(d.width)-(e?G(e.top):1),top:G(d.height)-(e?G(e.left):1),rotation:-90});n(a.childNodes,function(b){c.invertChild(b,a)})},symbols:{arc:function(a,b,c,d,e){var f=e.start,g=e.end,h=e.r||c||d,c=e.innerR,d=ba(f),i=ka(f),j=ba(g),k=ka(g);if(g-f===0)return["x"];f=["wa",a-h,b-h,a+h,b+h,a+h*d,b+h*i,a+h*j,b+h*k];e.open&&!c&&f.push("e","M",a,b);f.push("at",a-c,b-c,a+c,b+c,a+c*j,b+c*k,a+c*d,b+c*i,"x","e");f.isArc=!0;return f},circle:function(a,
b,c,d,e){e&&(c=d=2*e.r);e&&e.isCircle&&(a-=c/2,b-=d/2);return["wa",a,b,a+c,b+d,a+c,b+d/2,a+c,b+d/2,"e"]},rect:function(a,b,c,d,e){return ya.prototype.symbols[!s(e)||!e.r?"square":"callout"].call(0,a,b,c,d,e)}}},z.VMLRenderer=mb=function(){this.init.apply(this,arguments)},mb.prototype=C(ya.prototype,aa),Ya=mb;ya.prototype.measureSpanWidth=function(a,b){var c=B.createElement("span"),d;d=B.createTextNode(a);c.appendChild(d);F(c,b);this.box.appendChild(c);d=c.offsetWidth;Va(c);return d};var Wb;if(qa)z.CanVGRenderer=
aa=function(){Qa="http://www.w3.org/1999/xhtml"},aa.prototype.symbols={},Wb=function(){function a(){var a=b.length,d;for(d=0;d<a;d++)b[d]();b=[]}var b=[];return{push:function(c,d){if(b.length===0){var e=B.getElementsByTagName("head")[0],f=B.createElement("script");f.type="text/javascript";f.src=d;f.onload=a;e.appendChild(f)}b.push(c)}}}(),Ya=aa;cb.prototype={addLabel:function(){var a=this.axis,b=a.options,c=a.chart,d=a.categories,e=a.names,f=this.pos,g=b.labels,h=a.tickPositions,i=f===h[0],j=f===
h[h.length-1],e=d?q(d[f],e[f],f):f,d=this.label,h=h.info,k;a.isDatetimeAxis&&h&&(k=b.dateTimeLabelFormats[h.higherRanks[f]||h.unitName]);this.isFirst=i;this.isLast=j;b=a.labelFormatter.call({axis:a,chart:c,isFirst:i,isLast:j,dateTimeLabelFormat:k,value:a.isLog?na(a.lin2log(e)):e});s(d)?d&&d.attr({text:b}):(this.labelLength=(this.label=d=s(b)&&g.enabled?c.renderer.text(b,0,0,g.useHTML).css(C(g.style)).add(a.labelGroup):null)&&d.getBBox().width,this.rotation=0)},getLabelSize:function(){return this.label?
this.label.getBBox()[this.axis.horiz?"height":"width"]:0},handleOverflow:function(a){var b=this.axis,c=a.x,d=b.chart.chartWidth,e=b.chart.spacing,f=q(b.labelLeft,E(b.pos,e[3])),e=q(b.labelRight,v(b.pos+b.len,d-e[1])),g=this.label,h=this.rotation,i={left:0,center:0.5,right:1}[b.labelAlign],j=g.getBBox().width,k=b.getSlotWidth(),l=k,m=1,o,p={};if(h)h<0&&c-i*j<f?o=y(c/ba(h*pa)-f):h>0&&c+i*j>e&&(o=y((d-c)/ba(h*pa)));else if(d=c+(1-i)*j,c-i*j<f?l=a.x+l*(1-i)-f:d>e&&(l=e-a.x+l*i,m=-1),l=E(k,l),l<k&&b.labelAlign===
"center"&&(a.x+=m*(k-l-i*(k-E(j,l)))),j>l||b.autoRotation&&g.styles.width)o=l;if(o){p.width=o;if(!b.options.labels.style.textOverflow)p.textOverflow="ellipsis";g.css(p)}},getPosition:function(a,b,c,d){var e=this.axis,f=e.chart,g=d&&f.oldChartHeight||f.chartHeight;return{x:a?e.translate(b+c,null,null,d)+e.transB:e.left+e.offset+(e.opposite?(d&&f.oldChartWidth||f.chartWidth)-e.right-e.left:0),y:a?g-e.bottom+e.offset-(e.opposite?e.height:0):g-e.translate(b+c,null,null,d)-e.transB}},getLabelPosition:function(a,
b,c,d,e,f,g,h){var i=this.axis,j=i.transA,k=i.reversed,l=i.staggerLines,m=i.tickRotCorr||{x:0,y:0},o=e.y;s(o)||(o=i.side===0?c.rotation?-8:-c.getBBox().height:i.side===2?m.y+8:ba(c.rotation*pa)*(m.y-c.getBBox(!1,0).height/2));a=a+e.x+m.x-(f&&d?f*j*(k?-1:1):0);b=b+o-(f&&!d?f*j*(k?1:-1):0);l&&(c=g/(h||1)%l,i.opposite&&(c=l-c-1),b+=c*(i.labelOffset/l));return{x:a,y:y(b)}},getMarkPath:function(a,b,c,d,e,f){return f.crispLine(["M",a,b,"L",a+(e?0:-c),b+(e?c:0)],d)},render:function(a,b,c){var d=this.axis,
e=d.options,f=d.chart.renderer,g=d.horiz,h=this.type,i=this.label,j=this.pos,k=e.labels,l=this.gridLine,m=h?h+"Grid":"grid",o=h?h+"Tick":"tick",p=e[m+"LineWidth"],r=e[m+"LineColor"],A=e[m+"LineDashStyle"],m=d.tickSize(o),o=e[o+"Color"],P=this.mark,u=k.step,w=!0,n=d.tickmarkOffset,R=this.getPosition(g,j,n,b),ha=R.x,R=R.y,s=g&&ha===d.pos+d.len||!g&&R===d.pos?-1:1,c=q(c,1);this.isActive=!0;if(p){j=d.getPlotLinePath(j+n,p*s,b,!0);if(l===t){l={stroke:r,"stroke-width":p};if(A)l.dashstyle=A;if(!h)l.zIndex=
1;if(b)l.opacity=0;this.gridLine=l=p?f.path(j).attr(l).add(d.gridGroup):null}if(!b&&l&&j)l[this.isNew?"attr":"animate"]({d:j,opacity:c})}if(m)d.opposite&&(m[0]=-m[0]),h=this.getMarkPath(ha,R,m[0],m[1]*s,g,f),P?P.animate({d:h,opacity:c}):this.mark=f.path(h).attr({stroke:o,"stroke-width":m[1],opacity:c}).add(d.axisGroup);if(i&&!isNaN(ha))i.xy=R=this.getLabelPosition(ha,R,i,g,k,n,a,u),this.isFirst&&!this.isLast&&!q(e.showFirstLabel,1)||this.isLast&&!this.isFirst&&!q(e.showLastLabel,1)?w=!1:g&&!d.isRadial&&
!k.step&&!k.rotation&&!b&&c!==0&&this.handleOverflow(R),u&&a%u&&(w=!1),w&&!isNaN(R.y)?(R.opacity=c,i[this.isNew?"attr":"animate"](R),this.isNew=!1):i.attr("y",-9999)},destroy:function(){Pa(this,this.axis)}};z.PlotLineOrBand=function(a,b){this.axis=a;if(b)this.options=b,this.id=b.id};z.PlotLineOrBand.prototype={render:function(){var a=this,b=a.axis,c=b.horiz,d=a.options,e=d.label,f=a.label,g=d.width,h=d.to,i=d.from,j=s(i)&&s(h),k=d.value,l=d.dashStyle,m=a.svgElem,o=[],p,r=d.color,A=q(d.zIndex,0),n=
d.events,u={},w=b.chart.renderer,o=b.log2lin;b.isLog&&(i=o(i),h=o(h),k=o(k));if(g){if(o=b.getPlotLinePath(k,g),u={stroke:r,"stroke-width":g},l)u.dashstyle=l}else if(j){o=b.getPlotBandPath(i,h,d);if(r)u.fill=r;if(d.borderWidth)u.stroke=d.borderColor,u["stroke-width"]=d.borderWidth}else return;u.zIndex=A;if(m)if(o)m.show(),m.animate({d:o});else{if(m.hide(),f)a.label=f=f.destroy()}else if(o&&o.length&&(a.svgElem=m=w.path(o).attr(u).add(),n))for(p in d=function(b){m.on(b,function(c){n[b].apply(a,[c])})},
n)d(p);e&&s(e.text)&&o&&o.length&&b.width>0&&b.height>0&&!o.flat?(e=C({align:c&&j&&"center",x:c?!j&&4:10,verticalAlign:!c&&j&&"middle",y:c?j?16:10:j?6:-4,rotation:c&&!j&&90},e),this.renderLabel(e,o,j,A)):f&&f.hide();return a},renderLabel:function(a,b,c,d){var e=this.label,f=this.axis.chart.renderer;if(!e)e={align:a.textAlign||a.align,rotation:a.rotation},e.zIndex=d,this.label=e=f.text(a.text,0,0,a.useHTML).attr(e).css(a.style).add();d=[b[1],b[4],c?b[6]:b[1]];b=[b[2],b[5],c?b[7]:b[2]];c=Oa(d);f=Oa(b);
e.align(a,!1,{x:c,y:f,width:Ea(d)-c,height:Ea(b)-f});e.show()},destroy:function(){Aa(this.axis.plotLinesAndBands,this);delete this.axis;Pa(this)}};var I=z.Axis=function(){this.init.apply(this,arguments)};I.prototype={defaultOptions:{dateTimeLabelFormats:{millisecond:"%H:%M:%S.%L",second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%e. %b",week:"%e. %b",month:"%b '%y",year:"%Y"},endOnTick:!1,gridLineColor:"#D8D8D8",labels:{enabled:!0,style:{color:"#606060",cursor:"default",fontSize:"11px"},x:0},lineColor:"#C0D0E0",
lineWidth:1,minPadding:0.01,maxPadding:0.01,minorGridLineColor:"#E0E0E0",minorGridLineWidth:1,minorTickColor:"#A0A0A0",minorTickLength:2,minorTickPosition:"outside",startOfWeek:1,startOnTick:!1,tickColor:"#C0D0E0",tickLength:10,tickmarkPlacement:"between",tickPixelInterval:100,tickPosition:"outside",title:{align:"middle",style:{color:"#707070"}},type:"linear"},defaultYAxisOptions:{endOnTick:!0,gridLineWidth:1,tickPixelInterval:72,showLastLabel:!0,labels:{x:-8},lineWidth:0,maxPadding:0.05,minPadding:0.05,
startOnTick:!0,title:{rotation:270,text:"Values"},stackLabels:{enabled:!1,formatter:function(){return z.numberFormat(this.total,-1)},style:C(W.line.dataLabels.style,{color:"#000000"})}},defaultLeftAxisOptions:{labels:{x:-15},title:{rotation:270}},defaultRightAxisOptions:{labels:{x:15},title:{rotation:90}},defaultBottomAxisOptions:{labels:{autoRotation:[-45],x:0},title:{rotation:0}},defaultTopAxisOptions:{labels:{autoRotation:[-45],x:0},title:{rotation:0}},init:function(a,b){var c=b.isX;this.chart=
a;this.horiz=a.inverted?!c:c;this.coll=(this.isXAxis=c)?"xAxis":"yAxis";this.opposite=b.opposite;this.side=b.side||(this.horiz?this.opposite?0:2:this.opposite?1:3);this.setOptions(b);var d=this.options,e=d.type;this.labelFormatter=d.labels.formatter||this.defaultLabelFormatter;this.userOptions=b;this.minPixelPadding=0;this.reversed=d.reversed;this.visible=d.visible!==!1;this.zoomEnabled=d.zoomEnabled!==!1;this.categories=d.categories||e==="category";this.names=this.names||[];this.isLog=e==="logarithmic";
this.isDatetimeAxis=e==="datetime";this.isLinked=s(d.linkedTo);this.ticks={};this.labelEdge=[];this.minorTicks={};this.plotLinesAndBands=[];this.alternateBands={};this.len=0;this.minRange=this.userMinRange=d.minRange||d.maxZoom;this.range=d.range;this.offset=d.offset||0;this.stacks={};this.oldStacks={};this.stacksTouched=0;this.min=this.max=null;this.crosshair=q(d.crosshair,va(a.options.tooltip.crosshairs)[c?0:1],!1);var f,d=this.options.events;sa(this,a.axes)===-1&&(c&&!this.isColorAxis?a.axes.splice(a.xAxis.length,
0,this):a.axes.push(this),a[this.coll].push(this));this.series=this.series||[];if(a.inverted&&c&&this.reversed===t)this.reversed=!0;this.removePlotLine=this.removePlotBand=this.removePlotBandOrLine;for(f in d)D(this,f,d[f]);if(this.isLog)this.val2lin=this.log2lin,this.lin2val=this.lin2log},setOptions:function(a){this.options=C(this.defaultOptions,this.isXAxis?{}:this.defaultYAxisOptions,[this.defaultTopAxisOptions,this.defaultRightAxisOptions,this.defaultBottomAxisOptions,this.defaultLeftAxisOptions][this.side],
C(N[this.coll],a))},defaultLabelFormatter:function(){var a=this.axis,b=this.value,c=a.categories,d=this.dateTimeLabelFormat,e=N.lang.numericSymbols,f=e&&e.length,g,h=a.options.labels.format,a=a.isLog?b:a.tickInterval;if(h)g=La(h,this);else if(c)g=b;else if(d)g=ma(d,b);else if(f&&a>=1E3)for(;f--&&g===t;)c=Math.pow(1E3,f+1),a>=c&&b*10%c===0&&e[f]!==null&&(g=z.numberFormat(b/c,-1)+e[f]);g===t&&(g=S(b)>=1E4?z.numberFormat(b,-1):z.numberFormat(b,-1,t,""));return g},getSeriesExtremes:function(){var a=this,
b=a.chart;a.hasVisibleSeries=!1;a.dataMin=a.dataMax=a.threshold=null;a.softThreshold=!a.isXAxis;a.buildStacks&&a.buildStacks();n(a.series,function(c){if(c.visible||!b.options.chart.ignoreHiddenSeries){var d=c.options,e=d.threshold,f;a.hasVisibleSeries=!0;a.isLog&&e<=0&&(e=null);if(a.isXAxis){if(d=c.xData,d.length)a.dataMin=E(q(a.dataMin,d[0]),Oa(d)),a.dataMax=v(q(a.dataMax,d[0]),Ea(d))}else{c.getExtremes();f=c.dataMax;c=c.dataMin;if(s(c)&&s(f))a.dataMin=E(q(a.dataMin,c),c),a.dataMax=v(q(a.dataMax,
f),f);if(s(e))a.threshold=e;if(!d.softThreshold||a.isLog)a.softThreshold=!1}}})},translate:function(a,b,c,d,e,f){var g=this.linkedParent||this,h=1,i=0,j=d?g.oldTransA:g.transA,d=d?g.oldMin:g.min,k=g.minPixelPadding,e=(g.isOrdinal||g.isBroken||g.isLog&&e)&&g.lin2val;if(!j)j=g.transA;if(c)h*=-1,i=g.len;g.reversed&&(h*=-1,i-=h*(g.sector||g.len));b?(a=a*h+i,a-=k,a=a/j+d,e&&(a=g.lin2val(a))):(e&&(a=g.val2lin(a)),f==="between"&&(f=0.5),a=h*(a-d)*j+i+h*k+(ua(f)?j*f*g.pointRange:0));return a},toPixels:function(a,
b){return this.translate(a,!1,!this.horiz,null,!0)+(b?0:this.pos)},toValue:function(a,b){return this.translate(a-(b?0:this.pos),!0,!this.horiz,null,!0)},getPlotLinePath:function(a,b,c,d,e){var f=this.chart,g=this.left,h=this.top,i,j,k=c&&f.oldChartHeight||f.chartHeight,l=c&&f.oldChartWidth||f.chartWidth,m;i=this.transB;var o=function(a,b,c){if(a<b||a>c)d?a=E(v(b,a),c):m=!0;return a},e=q(e,this.translate(a,null,null,c)),a=c=y(e+i);i=j=y(k-e-i);isNaN(e)?m=!0:this.horiz?(i=h,j=k-this.bottom,a=c=o(a,
g,g+this.width)):(a=g,c=l-this.right,i=j=o(i,h,h+this.height));return m&&!d?null:f.renderer.crispLine(["M",a,i,"L",c,j],b||1)},getLinearTickPositions:function(a,b,c){var d,e=na(V(b/a)*a),f=na(Fa(c/a)*a),g=[];if(b===c&&ua(b))return[b];for(b=e;b<=f;){g.push(b);b=na(b+a);if(b===d)break;d=b}return g},getMinorTickPositions:function(){var a=this.options,b=this.tickPositions,c=this.minorTickInterval,d=[],e,f=this.pointRangePadding||0;e=this.min-f;var f=this.max+f,g=f-e;if(g&&g/c<this.len/3)if(this.isLog){f=
b.length;for(e=1;e<f;e++)d=d.concat(this.getLogTickPositions(c,b[e-1],b[e],!0))}else if(this.isDatetimeAxis&&a.minorTickInterval==="auto")d=d.concat(this.getTimeTicks(this.normalizeTimeTickInterval(c),e,f,a.startOfWeek));else for(b=e+(b[0]-e)%c;b<=f;b+=c)d.push(b);d.length!==0&&this.trimTicks(d,a.startOnTick,a.endOnTick);return d},adjustForMinRange:function(){var a=this.options,b=this.min,c=this.max,d,e=this.dataMax-this.dataMin>=this.minRange,f,g,h,i,j,k;if(this.isXAxis&&this.minRange===t&&!this.isLog)s(a.min)||
s(a.max)?this.minRange=null:(n(this.series,function(a){i=a.xData;for(g=j=a.xIncrement?1:i.length-1;g>0;g--)if(h=i[g]-i[g-1],f===t||h<f)f=h}),this.minRange=E(f*5,this.dataMax-this.dataMin));if(c-b<this.minRange){k=this.minRange;d=(k-c+b)/2;d=[b-d,q(a.min,b-d)];if(e)d[2]=this.dataMin;b=Ea(d);c=[b+k,q(a.max,b+k)];if(e)c[2]=this.dataMax;c=Oa(c);c-b<k&&(d[0]=c-k,d[1]=q(a.min,c-k),b=Ea(d))}this.min=b;this.max=c},getClosest:function(){var a;n(this.series,function(b){var c=b.closestPointRange;!b.noSharedTooltip&&
s(c)&&(a=s(a)?E(a,c):c)});return a},setAxisTranslation:function(a){var b=this,c=b.max-b.min,d=b.axisPointRange||0,e,f=0,g=0,h=b.linkedParent,i=!!b.categories,j=b.transA,k=b.isXAxis;if(k||i||d)if(h?(f=h.minPointOffset,g=h.pointRangePadding):(e=b.getClosest(),n(b.series,function(a){var c=i?1:k?q(a.options.pointRange,e,0):b.axisPointRange||0,a=a.options.pointPlacement;d=v(d,c);b.single||(f=v(f,Da(a)?0:c/2),g=v(g,a==="on"?0:c))})),h=b.ordinalSlope&&e?b.ordinalSlope/e:1,b.minPointOffset=f*=h,b.pointRangePadding=
g*=h,b.pointRange=E(d,c),k)b.closestPointRange=e;if(a)b.oldTransA=j;b.translationSlope=b.transA=j=b.len/(c+g||1);b.transB=b.horiz?b.left:b.bottom;b.minPixelPadding=j*f},minFromRange:function(){return this.max-this.range},setTickInterval:function(a){var b=this,c=b.chart,d=b.options,e=b.isLog,f=b.log2lin,g=b.isDatetimeAxis,h=b.isXAxis,i=b.isLinked,j=d.maxPadding,k=d.minPadding,l=d.tickInterval,m=d.tickPixelInterval,o=b.categories,p=b.threshold,r=b.softThreshold,A,P,u,w;!g&&!o&&!i&&this.getTickAmount();
u=q(b.userMin,d.min);w=q(b.userMax,d.max);i?(b.linkedParent=c[b.coll][d.linkedTo],c=b.linkedParent.getExtremes(),b.min=q(c.min,c.dataMin),b.max=q(c.max,c.dataMax),d.type!==b.linkedParent.options.type&&ga(11,1)):(!r&&s(p)&&(b.dataMin>=p?(A=p,k=0):b.dataMax<=p&&(P=p,j=0)),b.min=q(u,A,b.dataMin),b.max=q(w,P,b.dataMax));if(e)!a&&E(b.min,q(b.dataMin,b.min))<=0&&ga(10,1),b.min=na(f(b.min),15),b.max=na(f(b.max),15);if(b.range&&s(b.max))b.userMin=b.min=u=v(b.min,b.minFromRange()),b.userMax=w=b.max,b.range=
null;b.beforePadding&&b.beforePadding();b.adjustForMinRange();if(!o&&!b.axisPointRange&&!b.usePercentage&&!i&&s(b.min)&&s(b.max)&&(f=b.max-b.min))!s(u)&&k&&(b.min-=f*k),!s(w)&&j&&(b.max+=f*j);if(ua(d.floor))b.min=v(b.min,d.floor);if(ua(d.ceiling))b.max=E(b.max,d.ceiling);if(r&&s(b.dataMin))if(p=p||0,!s(u)&&b.min<p&&b.dataMin>=p)b.min=p;else if(!s(w)&&b.max>p&&b.dataMax<=p)b.max=p;b.tickInterval=b.min===b.max||b.min===void 0||b.max===void 0?1:i&&!l&&m===b.linkedParent.options.tickPixelInterval?l=b.linkedParent.tickInterval:
q(l,this.tickAmount?(b.max-b.min)/v(this.tickAmount-1,1):void 0,o?1:(b.max-b.min)*m/v(b.len,m));h&&!a&&n(b.series,function(a){a.processData(b.min!==b.oldMin||b.max!==b.oldMax)});b.setAxisTranslation(!0);b.beforeSetTickPositions&&b.beforeSetTickPositions();if(b.postProcessTickInterval)b.tickInterval=b.postProcessTickInterval(b.tickInterval);if(b.pointRange&&!l)b.tickInterval=v(b.pointRange,b.tickInterval);a=q(d.minTickInterval,b.isDatetimeAxis&&b.closestPointRange);if(!l&&b.tickInterval<a)b.tickInterval=
a;if(!g&&!e&&!l)b.tickInterval=Bb(b.tickInterval,null,Ab(b.tickInterval),q(d.allowDecimals,!(b.tickInterval>0.5&&b.tickInterval<5&&b.max>1E3&&b.max<9999)),!!this.tickAmount);if(!this.tickAmount&&this.len)b.tickInterval=b.unsquish();this.setTickPositions()},setTickPositions:function(){var a=this.options,b,c=a.tickPositions,d=a.tickPositioner,e=a.startOnTick,f=a.endOnTick,g;this.tickmarkOffset=this.categories&&a.tickmarkPlacement==="between"&&this.tickInterval===1?0.5:0;this.minorTickInterval=a.minorTickInterval===
"auto"&&this.tickInterval?this.tickInterval/5:a.minorTickInterval;this.tickPositions=b=c&&c.slice();if(!b&&(b=this.isDatetimeAxis?this.getTimeTicks(this.normalizeTimeTickInterval(this.tickInterval,a.units),this.min,this.max,a.startOfWeek,this.ordinalPositions,this.closestPointRange,!0):this.isLog?this.getLogTickPositions(this.tickInterval,this.min,this.max):this.getLinearTickPositions(this.tickInterval,this.min,this.max),b.length>this.len&&(b=[b[0],b.pop()]),this.tickPositions=b,d&&(d=d.apply(this,
[this.min,this.max]))))this.tickPositions=b=d;if(!this.isLinked)this.trimTicks(b,e,f),this.min===this.max&&s(this.min)&&!this.tickAmount&&(g=!0,this.min-=0.5,this.max+=0.5),this.single=g,!c&&!d&&this.adjustTickAmount()},trimTicks:function(a,b,c){var d=a[0],e=a[a.length-1],f=this.minPointOffset||0;if(b)this.min=d;else for(;this.min-f>a[0];)a.shift();if(c)this.max=e;else for(;this.max+f<a[a.length-1];)a.pop();a.length===0&&s(d)&&a.push((e+d)/2)},alignToOthers:function(){var a={},b,c=this.options;this.chart.options.chart.alignTicks!==
!1&&c.alignTicks!==!1&&n(this.chart[this.coll],function(c){var e=c.options,e=[c.horiz?e.left:e.top,e.width,e.height,e.pane].join(",");c.series.length&&(a[e]?b=!0:a[e]=1)});return b},getTickAmount:function(){var a=this.options,b=a.tickAmount,c=a.tickPixelInterval;!s(a.tickInterval)&&this.len<c&&!this.isRadial&&!this.isLog&&a.startOnTick&&a.endOnTick&&(b=2);!b&&this.alignToOthers()&&(b=Fa(this.len/c)+1);if(b<4)this.finalTickAmt=b,b=5;this.tickAmount=b},adjustTickAmount:function(){var a=this.tickInterval,
b=this.tickPositions,c=this.tickAmount,d=this.finalTickAmt,e=b&&b.length;if(e<c){for(;b.length<c;)b.push(na(b[b.length-1]+a));this.transA*=(e-1)/(c-1);this.max=b[b.length-1]}else e>c&&(this.tickInterval*=2,this.setTickPositions());if(s(d)){for(a=c=b.length;a--;)(d===3&&a%2===1||d<=2&&a>0&&a<c-1)&&b.splice(a,1);this.finalTickAmt=t}},setScale:function(){var a,b;this.oldMin=this.min;this.oldMax=this.max;this.oldAxisLength=this.len;this.setAxisSize();b=this.len!==this.oldAxisLength;n(this.series,function(b){if(b.isDirtyData||
b.isDirty||b.xAxis.isDirty)a=!0});if(b||a||this.isLinked||this.forceRedraw||this.userMin!==this.oldUserMin||this.userMax!==this.oldUserMax||this.alignToOthers()){if(this.resetStacks&&this.resetStacks(),this.forceRedraw=!1,this.getSeriesExtremes(),this.setTickInterval(),this.oldUserMin=this.userMin,this.oldUserMax=this.userMax,!this.isDirty)this.isDirty=b||this.min!==this.oldMin||this.max!==this.oldMax}else this.cleanStacks&&this.cleanStacks()},setExtremes:function(a,b,c,d,e){var f=this,g=f.chart,
c=q(c,!0);n(f.series,function(a){delete a.kdTree});e=x(e,{min:a,max:b});M(f,"setExtremes",e,function(){f.userMin=a;f.userMax=b;f.eventArgs=e;c&&g.redraw(d)})},zoom:function(a,b){var c=this.dataMin,d=this.dataMax,e=this.options,f=E(c,q(e.min,c)),e=v(d,q(e.max,d));this.allowZoomOutside||(s(c)&&a<=f&&(a=f),s(d)&&b>=e&&(b=e));this.displayBtn=a!==t||b!==t;this.setExtremes(a,b,!1,t,{trigger:"zoom"});return!0},setAxisSize:function(){var a=this.chart,b=this.options,c=b.offsetLeft||0,d=this.horiz,e=q(b.width,
a.plotWidth-c+(b.offsetRight||0)),f=q(b.height,a.plotHeight),g=q(b.top,a.plotTop),b=q(b.left,a.plotLeft+c),c=/%$/;c.test(f)&&(f=Math.round(parseFloat(f)/100*a.plotHeight));c.test(g)&&(g=Math.round(parseFloat(g)/100*a.plotHeight+a.plotTop));this.left=b;this.top=g;this.width=e;this.height=f;this.bottom=a.chartHeight-f-g;this.right=a.chartWidth-e-b;this.len=v(d?e:f,0);this.pos=d?b:g},getExtremes:function(){var a=this.isLog,b=this.lin2log;return{min:a?na(b(this.min)):this.min,max:a?na(b(this.max)):this.max,
dataMin:this.dataMin,dataMax:this.dataMax,userMin:this.userMin,userMax:this.userMax}},getThreshold:function(a){var b=this.isLog,c=this.lin2log,d=b?c(this.min):this.min,b=b?c(this.max):this.max;a===null?a=b<0?b:d:d>a?a=d:b<a&&(a=b);return this.translate(a,0,1,0,1)},autoLabelAlign:function(a){a=(q(a,0)-this.side*90+720)%360;return a>15&&a<165?"right":a>195&&a<345?"left":"center"},tickSize:function(a){var b=this.options,c=b[a+"Length"],d=q(b[a+"Width"],a==="tick"&&this.isXAxis?1:0);if(d&&c)return b[a+
"Position"]==="inside"&&(c=-c),[c,d]},labelMetrics:function(){return this.chart.renderer.fontMetrics(this.options.labels.style.fontSize,this.ticks[0]&&this.ticks[0].label)},unsquish:function(){var a=this.options.labels,b=this.horiz,c=this.tickInterval,d=c,e=this.len/(((this.categories?1:0)+this.max-this.min)/c),f,g=a.rotation,h=this.labelMetrics(),i,j=Number.MAX_VALUE,k,l=function(a){a/=e||1;a=a>1?Fa(a):1;return a*c};b?(k=!a.staggerLines&&!a.step&&(s(g)?[g]:e<q(a.autoRotationLimit,80)&&a.autoRotation))&&
n(k,function(a){var b;if(a===g||a&&a>=-90&&a<=90)i=l(S(h.h/ka(pa*a))),b=i+S(a/360),b<j&&(j=b,f=a,d=i)}):a.step||(d=l(h.h));this.autoRotation=k;this.labelRotation=q(f,g);return d},getSlotWidth:function(){var a=this.chart,b=this.horiz,c=this.options.labels,d=Math.max(this.tickPositions.length-(this.categories?0:1),1),e=a.margin[3];return b&&(c.step||0)<2&&!c.rotation&&(this.staggerLines||1)*a.plotWidth/d||!b&&(e&&e-a.spacing[3]||a.chartWidth*0.33)},renderUnsquish:function(){var a=this.chart,b=a.renderer,
c=this.tickPositions,d=this.ticks,e=this.options.labels,f=this.horiz,g=this.getSlotWidth(),h=v(1,y(g-2*(e.padding||5))),i={},j=this.labelMetrics(),k=e.style.textOverflow,l,m=0,o,p;if(!Da(e.rotation))i.rotation=e.rotation||0;if(this.autoRotation)n(c,function(a){if((a=d[a])&&a.labelLength>m)m=a.labelLength}),m>h&&m>j.h?i.rotation=this.labelRotation:this.labelRotation=0;else if(g&&(l={width:h+"px"},!k)){l.textOverflow="clip";for(o=c.length;!f&&o--;)if(p=c[o],h=d[p].label)if(h.styles.textOverflow==="ellipsis"?
h.css({textOverflow:"clip"}):d[p].labelLength>g&&h.css({width:g+"px"}),h.getBBox().height>this.len/c.length-(j.h-j.f))h.specCss={textOverflow:"ellipsis"}}if(i.rotation&&(l={width:(m>a.chartHeight*0.5?a.chartHeight*0.33:a.chartHeight)+"px"},!k))l.textOverflow="ellipsis";if(this.labelAlign=e.align||this.autoLabelAlign(this.labelRotation))i.align=this.labelAlign;n(c,function(a){var b=(a=d[a])&&a.label;if(b)b.attr(i),l&&b.css(C(l,b.specCss)),delete b.specCss,a.rotation=i.rotation});this.tickRotCorr=b.rotCorr(j.b,
this.labelRotation||0,this.side!==0)},hasData:function(){return this.hasVisibleSeries||s(this.min)&&s(this.max)&&!!this.tickPositions},getOffset:function(){var a=this,b=a.chart,c=b.renderer,d=a.options,e=a.tickPositions,f=a.ticks,g=a.horiz,h=a.side,i=b.inverted?[1,0,3,2][h]:h,j,k,l=0,m,o=0,p=d.title,r=d.labels,A=0,P=a.opposite,u=b.axisOffset,b=b.clipOffset,w=[-1,1,1,-1][h],O,R=a.axisParent,ha=this.tickSize("tick");j=a.hasData();a.showAxis=k=j||q(d.showEmpty,!0);a.staggerLines=a.horiz&&r.staggerLines;
if(!a.axisGroup)a.gridGroup=c.g("grid").attr({zIndex:d.gridZIndex||1}).add(R),a.axisGroup=c.g("axis").attr({zIndex:d.zIndex||2}).add(R),a.labelGroup=c.g("axis-labels").attr({zIndex:r.zIndex||7}).addClass("highcharts-"+a.coll.toLowerCase()+"-labels").add(R);if(j||a.isLinked){if(n(e,function(b){f[b]?f[b].addLabel():f[b]=new cb(a,b)}),a.renderUnsquish(),r.reserveSpace!==!1&&(h===0||h===2||{1:"left",3:"right"}[h]===a.labelAlign||a.labelAlign==="center")&&n(e,function(a){A=v(f[a].getLabelSize(),A)}),a.staggerLines)A*=
a.staggerLines,a.labelOffset=A*(a.opposite?-1:1)}else for(O in f)f[O].destroy(),delete f[O];if(p&&p.text&&p.enabled!==!1){if(!a.axisTitle)a.axisTitle=c.text(p.text,0,0,p.useHTML).attr({zIndex:7,rotation:p.rotation||0,align:p.textAlign||{low:P?"right":"left",middle:"center",high:P?"left":"right"}[p.align]}).addClass("highcharts-"+this.coll.toLowerCase()+"-title").css(p.style).add(a.axisGroup),a.axisTitle.isNew=!0;if(k)l=a.axisTitle.getBBox()[g?"height":"width"],m=p.offset,o=s(m)?0:q(p.margin,g?5:10);
a.axisTitle[k?"show":"hide"](!0)}a.offset=w*q(d.offset,u[h]);a.tickRotCorr=a.tickRotCorr||{x:0,y:0};c=h===0?-a.labelMetrics().h:h===2?a.tickRotCorr.y:0;o=Math.abs(A)+o;A&&(o-=c,o+=w*(g?q(r.y,a.tickRotCorr.y+w*8):r.x));a.axisTitleMargin=q(m,o);u[h]=v(u[h],a.axisTitleMargin+l+w*a.offset,o,j&&e.length&&ha?ha[0]:0);d=d.offset?0:V(d.lineWidth/2)*2;b[i]=v(b[i],d)},getLinePath:function(a){var b=this.chart,c=this.opposite,d=this.offset,e=this.horiz,f=this.left+(c?this.width:0)+d,d=b.chartHeight-this.bottom-
(c?this.height:0)+d;c&&(a*=-1);return b.renderer.crispLine(["M",e?this.left:f,e?d:this.top,"L",e?b.chartWidth-this.right:f,e?d:b.chartHeight-this.bottom],a)},getTitlePosition:function(){var a=this.horiz,b=this.left,c=this.top,d=this.len,e=this.options.title,f=a?b:c,g=this.opposite,h=this.offset,i=e.x||0,j=e.y||0,k=G(e.style.fontSize||12),d={low:f+(a?0:d),middle:f+d/2,high:f+(a?d:0)}[e.align],b=(a?c+this.height:b)+(a?1:-1)*(g?-1:1)*this.axisTitleMargin+(this.side===2?k:0);return{x:a?d+i:b+(g?this.width:
0)+h+i,y:a?b+j-(g?this.height:0)+h:d+j}},render:function(){var a=this,b=a.chart,c=b.renderer,d=a.options,e=a.isLog,f=a.lin2log,g=a.isLinked,h=a.tickPositions,i=a.axisTitle,j=a.ticks,k=a.minorTicks,l=a.alternateBands,m=d.stackLabels,o=d.alternateGridColor,p=a.tickmarkOffset,r=d.lineWidth,A,q=b.hasRendered&&s(a.oldMin)&&!isNaN(a.oldMin),u=a.showAxis,w=hb(c.globalAnimation),O,R;a.labelEdge.length=0;a.overlap=!1;n([j,k,l],function(a){for(var b in a)a[b].isActive=!1});if(a.hasData()||g){a.minorTickInterval&&
!a.categories&&n(a.getMinorTickPositions(),function(b){k[b]||(k[b]=new cb(a,b,"minor"));q&&k[b].isNew&&k[b].render(null,!0);k[b].render(null,!1,1)});if(h.length&&(n(h,function(b,c){if(!g||b>=a.min&&b<=a.max)j[b]||(j[b]=new cb(a,b)),q&&j[b].isNew&&j[b].render(c,!0,0.1),j[b].render(c)}),p&&(a.min===0||a.single)))j[-1]||(j[-1]=new cb(a,-1,null,!0)),j[-1].render(-1);o&&n(h,function(c,d){R=h[d+1]!==t?h[d+1]+p:a.max-p;if(d%2===0&&c<a.max&&R<=a.max+(b.polar?-p:p))l[c]||(l[c]=new z.PlotLineOrBand(a)),O=c+
p,l[c].options={from:e?f(O):O,to:e?f(R):R,color:o},l[c].render(),l[c].isActive=!0});if(!a._addedPlotLB)n((d.plotLines||[]).concat(d.plotBands||[]),function(b){a.addPlotBandOrLine(b)}),a._addedPlotLB=!0}n([j,k,l],function(a){var c,d,e=[],f=w.duration;for(c in a)if(!a[c].isActive)a[c].render(c,!1,0),a[c].isActive=!1,e.push(c);$a(function(){for(d=e.length;d--;)a[e[d]]&&!a[e[d]].isActive&&(a[e[d]].destroy(),delete a[e[d]])},a===l||!b.hasRendered||!f?0:f)});if(r)A=a.getLinePath(r),a.axisLine?a.axisLine.animate({d:A}):
a.axisLine=c.path(A).attr({stroke:d.lineColor,"stroke-width":r,zIndex:7}).add(a.axisGroup),a.axisLine[u?"show":"hide"](!0);if(i&&u)i[i.isNew?"attr":"animate"](a.getTitlePosition()),i.isNew=!1;m&&m.enabled&&a.renderStackTotals();a.isDirty=!1},redraw:function(){this.visible&&(this.render(),n(this.plotLinesAndBands,function(a){a.render()}));n(this.series,function(a){a.isDirty=!0})},destroy:function(a){var b=this,c=b.stacks,d,e=b.plotLinesAndBands;a||T(b);for(d in c)Pa(c[d]),c[d]=null;n([b.ticks,b.minorTicks,
b.alternateBands],function(a){Pa(a)});for(a=e.length;a--;)e[a].destroy();n("stackTotalGroup,axisLine,axisTitle,axisGroup,cross,gridGroup,labelGroup".split(","),function(a){b[a]&&(b[a]=b[a].destroy())});this.cross&&this.cross.destroy()},drawCrosshair:function(a,b){var c,d=this.crosshair,e,f;if(!this.crosshair||(s(b)||!q(d.snap,!0))===!1)this.hideCrosshair();else if(q(d.snap,!0)?s(b)&&(c=this.isXAxis?b.plotX:this.len-b.plotY):c=this.horiz?a.chartX-this.pos:this.len-a.chartY+this.pos,c=this.isRadial?
this.getPlotLinePath(this.isXAxis?b.x:q(b.stackY,b.y))||null:this.getPlotLinePath(null,null,null,null,c)||null,c===null)this.hideCrosshair();else if(e=this.categories&&!this.isRadial,f=q(d.width,e?this.transA:1),this.cross)this.cross.attr({d:c,visibility:"visible","stroke-width":f});else{e={"stroke-width":f,stroke:d.color||(e?"rgba(155,200,255,0.2)":"#C0C0C0"),zIndex:q(d.zIndex,2)};if(d.dashStyle)e.dashstyle=d.dashStyle;this.cross=this.chart.renderer.path(c).attr(e).add()}},hideCrosshair:function(){this.cross&&
this.cross.hide()}};x(I.prototype,{getPlotBandPath:function(a,b){var c=this.getPlotLinePath(b,null,null,!0),d=this.getPlotLinePath(a,null,null,!0);d&&c?(d.flat=d.toString()===c.toString(),d.push(c[4],c[5],c[1],c[2])):d=null;return d},addPlotBand:function(a){return this.addPlotBandOrLine(a,"plotBands")},addPlotLine:function(a){return this.addPlotBandOrLine(a,"plotLines")},addPlotBandOrLine:function(a,b){var c=(new z.PlotLineOrBand(this,a)).render(),d=this.userOptions;c&&(b&&(d[b]=d[b]||[],d[b].push(a)),
this.plotLinesAndBands.push(c));return c},removePlotBandOrLine:function(a){for(var b=this.plotLinesAndBands,c=this.options,d=this.userOptions,e=b.length;e--;)b[e].id===a&&b[e].destroy();n([c.plotLines||[],d.plotLines||[],c.plotBands||[],d.plotBands||[]],function(b){for(e=b.length;e--;)b[e].id===a&&Aa(b,b[e])})}});I.prototype.getTimeTicks=function(a,b,c,d){var e=[],f={},g=N.global.useUTC,h,i=new fa(b-fb(b)),j=a.unitRange,k=a.count;if(s(b)){i[Pb](j>=H.second?0:k*V(i.getMilliseconds()/k));if(j>=H.second)i[Qb](j>=
H.minute?0:k*V(i.getSeconds()/k));if(j>=H.minute)i[Rb](j>=H.hour?0:k*V(i[Cb]()/k));if(j>=H.hour)i[Sb](j>=H.day?0:k*V(i[Db]()/k));if(j>=H.day)i[rb](j>=H.month?1:k*V(i[bb]()/k));j>=H.month&&(i[Fb](j>=H.year?0:k*V(i[ib]()/k)),h=i[jb]());j>=H.year&&(h-=h%k,i[Gb](h));if(j===H.week)i[rb](i[bb]()-i[Eb]()+q(d,1));b=1;if(zb||gb)i=i.getTime(),i=new fa(i+fb(i));h=i[jb]();for(var d=i.getTime(),l=i[ib](),m=i[bb](),o=!g||!!gb,p=(H.day+(g?fb(i):i.getTimezoneOffset()*6E4))%H.day;d<c;)e.push(d),j===H.year?d=qb(h+
b*k,0):j===H.month?d=qb(h,l+b*k):o&&(j===H.day||j===H.week)?d=qb(h,l,m+b*k*(j===H.day?1:7)):d+=j*k,b++;e.push(d);n(Sa(e,function(a){return j<=H.hour&&a%H.day===p}),function(a){f[a]="day"})}e.info=x(a,{higherRanks:f,totalRange:j*k});return e};I.prototype.normalizeTimeTickInterval=function(a,b){var c=b||[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1,2]],["week",[1,2]],["month",[1,2,3,4,6]],["year",null]],d=
c[c.length-1],e=H[d[0]],f=d[1],g;for(g=0;g<c.length;g++)if(d=c[g],e=H[d[0]],f=d[1],c[g+1]&&a<=(e*f[f.length-1]+H[c[g+1][0]])/2)break;e===H.year&&a<5*e&&(f=[1,2,5]);c=Bb(a/e,f,d[0]==="year"?v(Ab(a/e),1):1);return{unitRange:e,count:c,unitName:d[0]}};I.prototype.getLogTickPositions=function(a,b,c,d){var e=this.options,f=this.len,g=this.lin2log,h=this.log2lin,i=[];if(!d)this._minorAutoInterval=null;if(a>=0.5)a=y(a),i=this.getLinearTickPositions(a,b,c);else if(a>=0.08)for(var f=V(b),j,k,l,m,o,e=a>0.3?
[1,2,4]:a>0.15?[1,2,4,6,8]:[1,2,3,4,5,6,7,8,9];f<c+1&&!o;f++){k=e.length;for(j=0;j<k&&!o;j++)l=h(g(f)*e[j]),l>b&&(!d||m<=c)&&m!==t&&i.push(m),m>c&&(o=!0),m=l}else if(b=g(b),c=g(c),a=e[d?"minorTickInterval":"tickInterval"],a=q(a==="auto"?null:a,this._minorAutoInterval,(c-b)*(e.tickPixelInterval/(d?5:1))/((d?f/this.tickPositions.length:f)||1)),a=Bb(a,null,Ab(a)),i=ta(this.getLinearTickPositions(a,b,c),h),!d)this._minorAutoInterval=a/5;if(!d)this.tickInterval=a;return i};I.prototype.log2lin=function(a){return Y.log(a)/
Y.LN10};I.prototype.lin2log=function(a){return Y.pow(10,a)};var Lb=z.Tooltip=function(){this.init.apply(this,arguments)};Lb.prototype={init:function(a,b){var c=b.borderWidth,d=b.style,e=G(d.padding);this.chart=a;this.options=b;this.crosshairs=[];this.now={x:0,y:0};this.isHidden=!0;this.label=a.renderer.label("",0,0,b.shape||"callout",null,null,b.useHTML,null,"tooltip").attr({padding:e,fill:b.backgroundColor,"stroke-width":c,r:b.borderRadius,zIndex:8}).css(d).css({padding:0}).add().attr({y:-9999});
qa||this.label.shadow(b.shadow);this.shared=b.shared},destroy:function(){if(this.label)this.label=this.label.destroy();clearTimeout(this.hideTimer);clearTimeout(this.tooltipTimeout)},move:function(a,b,c,d){var e=this,f=e.now,g=e.options.animation!==!1&&!e.isHidden&&(S(a-f.x)>1||S(b-f.y)>1),h=e.followPointer||e.len>1;x(f,{x:g?(2*f.x+a)/3:a,y:g?(f.y+b)/2:b,anchorX:h?t:g?(2*f.anchorX+c)/3:c,anchorY:h?t:g?(f.anchorY+d)/2:d});e.label.attr(f);if(g)clearTimeout(this.tooltipTimeout),this.tooltipTimeout=setTimeout(function(){e&&
e.move(a,b,c,d)},32)},hide:function(a){var b=this;clearTimeout(this.hideTimer);a=q(a,this.options.hideDelay,500);if(!this.isHidden)this.hideTimer=$a(function(){b.label[a?"fadeOut":"hide"]();b.isHidden=!0},a)},getAnchor:function(a,b){var c,d=this.chart,e=d.inverted,f=d.plotTop,g=d.plotLeft,h=0,i=0,j,k,a=va(a);c=a[0].tooltipPos;this.followPointer&&b&&(b.chartX===t&&(b=d.pointer.normalize(b)),c=[b.chartX-d.plotLeft,b.chartY-f]);c||(n(a,function(a){j=a.series.yAxis;k=a.series.xAxis;h+=a.plotX+(!e&&k?
k.left-g:0);i+=(a.plotLow?(a.plotLow+a.plotHigh)/2:a.plotY)+(!e&&j?j.top-f:0)}),h/=a.length,i/=a.length,c=[e?d.plotWidth-i:h,this.shared&&!e&&a.length>1&&b?b.chartY-f:e?d.plotHeight-h:i]);return ta(c,y)},getPosition:function(a,b,c){var d=this.chart,e=this.distance,f={},g=c.h||0,h,i=["y",d.chartHeight,b,c.plotY+d.plotTop,d.plotTop,d.plotTop+d.plotHeight],j=["x",d.chartWidth,a,c.plotX+d.plotLeft,d.plotLeft,d.plotLeft+d.plotWidth],k=!this.followPointer&&q(c.ttBelow,!d.inverted===!!c.negative),l=function(a,
b,c,d,h,i){var j=c<d-e,m=d+e+c<b,l=d-e-c;d+=e;if(k&&m)f[a]=d;else if(!k&&j)f[a]=l;else if(j)f[a]=E(i-c,l-g<0?l:l-g);else if(m)f[a]=v(h,d+g+c>b?d:d+g);else return!1},m=function(a,b,c,d){var g;d<e||d>b-e?g=!1:f[a]=d<c/2?1:d>b-c/2?b-c-2:d-c/2;return g},o=function(a){var b=i;i=j;j=b;h=a},p=function(){l.apply(0,i)!==!1?m.apply(0,j)===!1&&!h&&(o(!0),p()):h?f.x=f.y=0:(o(!0),p())};(d.inverted||this.len>1)&&o();p();return f},defaultFormatter:function(a){var b=this.points||va(this),c;c=[a.tooltipFooterHeaderFormatter(b[0])];
c=c.concat(a.bodyFormatter(b));c.push(a.tooltipFooterHeaderFormatter(b[0],!0));return c.join("")},refresh:function(a,b){var c=this.chart,d=this.label,e=this.options,f,g,h,i={},j,k=[];j=e.formatter||this.defaultFormatter;var i=c.hoverPoints,l,m=this.shared;clearTimeout(this.hideTimer);this.followPointer=va(a)[0].series.tooltipOptions.followPointer;h=this.getAnchor(a,b);f=h[0];g=h[1];m&&(!a.series||!a.series.noSharedTooltip)?(c.hoverPoints=a,i&&n(i,function(a){a.setState()}),n(a,function(a){a.setState("hover");
k.push(a.getLabelConfig())}),i={x:a[0].category,y:a[0].y},i.points=k,this.len=k.length,a=a[0]):i=a.getLabelConfig();j=j.call(i,this);i=a.series;this.distance=q(i.tooltipOptions.distance,16);j===!1?this.hide():(this.isHidden&&(Ta(d),d.attr("opacity",1).show()),d.attr({text:j}),l=e.borderColor||a.color||i.color||"#606060",d.attr({stroke:l}),this.updatePosition({plotX:f,plotY:g,negative:a.negative,ttBelow:a.ttBelow,h:h[2]||0}),this.isHidden=!1);M(c,"tooltipRefresh",{text:j,x:f+c.plotLeft,y:g+c.plotTop,
borderColor:l})},updatePosition:function(a){var b=this.chart,c=this.label,c=(this.options.positioner||this.getPosition).call(this,c.width,c.height,a);this.move(y(c.x),y(c.y||0),a.plotX+b.plotLeft,a.plotY+b.plotTop)},getXDateFormat:function(a,b,c){var d,b=b.dateTimeLabelFormats,e=c&&c.closestPointRange,f,g={millisecond:15,second:12,minute:9,hour:6,day:3},h,i="millisecond";if(e){h=ma("%m-%d %H:%M:%S.%L",a.x);for(f in H){if(e===H.week&&+ma("%w",a.x)===c.options.startOfWeek&&h.substr(6)==="00:00:00.000"){f=
"week";break}if(H[f]>e){f=i;break}if(g[f]&&h.substr(g[f])!=="01-01 00:00:00.000".substr(g[f]))break;f!=="week"&&(i=f)}f&&(d=b[f])}else d=b.day;return d||b.year},tooltipFooterHeaderFormatter:function(a,b){var c=b?"footer":"header",d=a.series,e=d.tooltipOptions,f=e.xDateFormat,g=d.xAxis,h=g&&g.options.type==="datetime"&&ua(a.key),c=e[c+"Format"];h&&!f&&(f=this.getXDateFormat(a,e,g));h&&f&&(c=c.replace("{point.key}","{point.key:"+f+"}"));return La(c,{point:a,series:d})},bodyFormatter:function(a){return ta(a,
function(a){var c=a.series.tooltipOptions;return(c.pointFormatter||a.point.tooltipFormatter).call(a.point,c.pointFormat)})}};var oa;db=B&&B.documentElement.ontouchstart!==t;var Za=z.Pointer=function(a,b){this.init(a,b)};Za.prototype={init:function(a,b){var c=b.chart,d=c.events,e=qa?"":c.zoomType,c=a.inverted,f;this.options=b;this.chart=a;this.zoomX=f=/x/.test(e);this.zoomY=e=/y/.test(e);this.zoomHor=f&&!c||e&&c;this.zoomVert=e&&!c||f&&c;this.hasZoom=f||e;this.runChartClick=d&&!!d.click;this.pinchDown=
[];this.lastValidTouch={};if(z.Tooltip&&b.tooltip.enabled)a.tooltip=new Lb(a,b.tooltip),this.followTouchMove=q(b.tooltip.followTouchMove,!0);this.setDOMEvents()},normalize:function(a,b){var c,d,a=a||J.event;if(!a.target)a.target=a.srcElement;d=a.touches?a.touches.length?a.touches.item(0):a.changedTouches[0]:a;if(!b)this.chartPosition=b=Kb(this.chart.container);d.pageX===t?(c=v(a.x,a.clientX-b.left),d=a.y):(c=d.pageX-b.left,d=d.pageY-b.top);return x(a,{chartX:y(c),chartY:y(d)})},getCoordinates:function(a){var b=
{xAxis:[],yAxis:[]};n(this.chart.axes,function(c){b[c.isXAxis?"xAxis":"yAxis"].push({axis:c,value:c.toValue(a[c.horiz?"chartX":"chartY"])})});return b},runPointActions:function(a){var b=this.chart,c=b.series,d=b.tooltip,e=d?d.shared:!1,f=b.hoverPoint,g=b.hoverSeries,h,i=[Number.MAX_VALUE,Number.MAX_VALUE],j,k,l=[],m=[],o;if(!e&&!g)for(h=0;h<c.length;h++)if(c[h].directTouch||!c[h].options.stickyTracking)c=[];g&&(e?g.noSharedTooltip:g.directTouch)&&f?m=[f]:(n(c,function(b){j=b.noSharedTooltip&&e;k=
!e&&b.directTouch;b.visible&&!j&&!k&&q(b.options.enableMouseTracking,!0)&&(o=b.searchPoint(a,!j&&b.kdDimensions===1))&&l.push(o)}),n(l,function(a){a&&n(["dist","distX"],function(b,c){if(typeof a[b]==="number"){var d=a[b]===i[c]&&a.series.group.zIndex>=m[c].series.group.zIndex;if(a[b]<i[c]||d)i[c]=a[b],m[c]=a}})}));if(e)for(h=l.length;h--;)(l[h].clientX!==m[1].clientX||l[h].series.noSharedTooltip)&&l.splice(h,1);if(m[0]&&(m[0]!==this.prevKDPoint||d&&d.isHidden))if(e&&!m[0].series.noSharedTooltip)l.length&&
d&&d.refresh(l,a),n(l,function(b){b.onMouseOver(a,b!==(g&&g.directTouch&&f||m[0]))}),this.prevKDPoint=m[1];else{d&&d.refresh(m[0],a);if(!g||!g.directTouch)m[0].onMouseOver(a);this.prevKDPoint=m[0]}else c=g&&g.tooltipOptions.followPointer,d&&c&&!d.isHidden&&(c=d.getAnchor([{}],a),d.updatePosition({plotX:c[0],plotY:c[1]}));if(!this._onDocumentMouseMove)this._onDocumentMouseMove=function(a){if($[oa])$[oa].pointer.onDocumentMouseMove(a)},D(B,"mousemove",this._onDocumentMouseMove);n(e?l:[q(m[1],f)],function(c){n(b.axes,
function(b){(!c||c.series[b.coll]===b)&&b.drawCrosshair(a,c)})})},reset:function(a,b){var c=this.chart,d=c.hoverSeries,e=c.hoverPoint,f=c.hoverPoints,g=c.tooltip,h=g&&g.shared?f:e;a&&h&&n(va(h),function(b){b.series.isCartesian&&b.plotX===void 0&&(a=!1)});if(a)g&&h&&(g.refresh(h),e&&(e.setState(e.state,!0),n(c.axes,function(a){q(a.crosshair&&a.crosshair.snap,!0)?a.drawCrosshair(null,e):a.hideCrosshair()})));else{if(e)e.onMouseOut();f&&n(f,function(a){a.setState()});if(d)d.onMouseOut();g&&g.hide(b);
if(this._onDocumentMouseMove)T(B,"mousemove",this._onDocumentMouseMove),this._onDocumentMouseMove=null;n(c.axes,function(a){a.hideCrosshair()});this.hoverX=c.hoverPoints=c.hoverPoint=null}},scaleGroups:function(a,b){var c=this.chart,d;n(c.series,function(e){d=a||e.getPlotBox();e.xAxis&&e.xAxis.zoomEnabled&&(e.group.attr(d),e.markerGroup&&(e.markerGroup.attr(d),e.markerGroup.clip(b?c.clipRect:null)),e.dataLabelsGroup&&e.dataLabelsGroup.attr(d))});c.clipRect.attr(b||c.clipBox)},dragStart:function(a){var b=
this.chart;b.mouseIsDown=a.type;b.cancelClick=!1;b.mouseDownX=this.mouseDownX=a.chartX;b.mouseDownY=this.mouseDownY=a.chartY},drag:function(a){var b=this.chart,c=b.options.chart,d=a.chartX,e=a.chartY,f=this.zoomHor,g=this.zoomVert,h=b.plotLeft,i=b.plotTop,j=b.plotWidth,k=b.plotHeight,l,m=this.selectionMarker,o=this.mouseDownX,p=this.mouseDownY,r=c.panKey&&a[c.panKey+"Key"];if(!m||!m.touch)if(d<h?d=h:d>h+j&&(d=h+j),e<i?e=i:e>i+k&&(e=i+k),this.hasDragged=Math.sqrt(Math.pow(o-d,2)+Math.pow(p-e,2)),this.hasDragged>
10){l=b.isInsidePlot(o-h,p-i);if(b.hasCartesianSeries&&(this.zoomX||this.zoomY)&&l&&!r&&!m)this.selectionMarker=m=b.renderer.rect(h,i,f?1:j,g?1:k,0).attr({fill:c.selectionMarkerFill||"rgba(69,114,167,0.25)",zIndex:7}).add();m&&f&&(d-=o,m.attr({width:S(d),x:(d>0?0:d)+o}));m&&g&&(d=e-p,m.attr({height:S(d),y:(d>0?0:d)+p}));l&&!m&&c.panning&&b.pan(a,c.panning)}},drop:function(a){var b=this,c=this.chart,d=this.hasPinched;if(this.selectionMarker){var e={originalEvent:a,xAxis:[],yAxis:[]},f=this.selectionMarker,
g=f.attr?f.attr("x"):f.x,h=f.attr?f.attr("y"):f.y,i=f.attr?f.attr("width"):f.width,j=f.attr?f.attr("height"):f.height,k;if(this.hasDragged||d)n(c.axes,function(c){if(c.zoomEnabled&&s(c.min)&&(d||b[{xAxis:"zoomX",yAxis:"zoomY"}[c.coll]])){var f=c.horiz,o=a.type==="touchend"?c.minPixelPadding:0,p=c.toValue((f?g:h)+o),f=c.toValue((f?g+i:h+j)-o);e[c.coll].push({axis:c,min:E(p,f),max:v(p,f)});k=!0}}),k&&M(c,"selection",e,function(a){c.zoom(x(a,d?{animation:!1}:null))});this.selectionMarker=this.selectionMarker.destroy();
d&&this.scaleGroups()}if(c)F(c.container,{cursor:c._cursor}),c.cancelClick=this.hasDragged>10,c.mouseIsDown=this.hasDragged=this.hasPinched=!1,this.pinchDown=[]},onContainerMouseDown:function(a){a=this.normalize(a);a.preventDefault&&a.preventDefault();this.dragStart(a)},onDocumentMouseUp:function(a){$[oa]&&$[oa].pointer.drop(a)},onDocumentMouseMove:function(a){var b=this.chart,c=this.chartPosition,a=this.normalize(a,c);c&&!this.inClass(a.target,"highcharts-tracker")&&!b.isInsidePlot(a.chartX-b.plotLeft,
a.chartY-b.plotTop)&&this.reset()},onContainerMouseLeave:function(a){var b=$[oa];if(b&&(a.relatedTarget||a.toElement))b.pointer.reset(),b.pointer.chartPosition=null},onContainerMouseMove:function(a){var b=this.chart;if(!s(oa)||!$[oa]||!$[oa].mouseIsDown)oa=b.index;a=this.normalize(a);a.returnValue=!1;b.mouseIsDown==="mousedown"&&this.drag(a);(this.inClass(a.target,"highcharts-tracker")||b.isInsidePlot(a.chartX-b.plotLeft,a.chartY-b.plotTop))&&!b.openMenu&&this.runPointActions(a)},inClass:function(a,
b){for(var c;a;){if(c=X(a,"class")){if(c.indexOf(b)!==-1)return!0;if(c.indexOf("highcharts-container")!==-1)return!1}a=a.parentNode}},onTrackerMouseOut:function(a){var b=this.chart.hoverSeries,a=a.relatedTarget||a.toElement;if(b&&a&&!b.options.stickyTracking&&!this.inClass(a,"highcharts-tooltip")&&!this.inClass(a,"highcharts-series-"+b.index))b.onMouseOut()},onContainerClick:function(a){var b=this.chart,c=b.hoverPoint,d=b.plotLeft,e=b.plotTop,a=this.normalize(a);b.cancelClick||(c&&this.inClass(a.target,
"highcharts-tracker")?(M(c.series,"click",x(a,{point:c})),b.hoverPoint&&c.firePointEvent("click",a)):(x(a,this.getCoordinates(a)),b.isInsidePlot(a.chartX-d,a.chartY-e)&&M(b,"click",a)))},setDOMEvents:function(){var a=this,b=a.chart.container;b.onmousedown=function(b){a.onContainerMouseDown(b)};b.onmousemove=function(b){a.onContainerMouseMove(b)};b.onclick=function(b){a.onContainerClick(b)};D(b,"mouseleave",a.onContainerMouseLeave);lb===1&&D(B,"mouseup",a.onDocumentMouseUp);if(db)b.ontouchstart=function(b){a.onContainerTouchStart(b)},
b.ontouchmove=function(b){a.onContainerTouchMove(b)},lb===1&&D(B,"touchend",a.onDocumentTouchEnd)},destroy:function(){var a;T(this.chart.container,"mouseleave",this.onContainerMouseLeave);lb||(T(B,"mouseup",this.onDocumentMouseUp),T(B,"touchend",this.onDocumentTouchEnd));clearInterval(this.tooltipTimeout);for(a in this)this[a]=null}};x(z.Pointer.prototype,{pinchTranslate:function(a,b,c,d,e,f){(this.zoomHor||this.pinchHor)&&this.pinchTranslateDirection(!0,a,b,c,d,e,f);(this.zoomVert||this.pinchVert)&&
this.pinchTranslateDirection(!1,a,b,c,d,e,f)},pinchTranslateDirection:function(a,b,c,d,e,f,g,h){var i=this.chart,j=a?"x":"y",k=a?"X":"Y",l="chart"+k,m=a?"width":"height",o=i["plot"+(a?"Left":"Top")],p,r,A=h||1,q=i.inverted,n=i.bounds[a?"h":"v"],w=b.length===1,O=b[0][l],s=c[0][l],v=!w&&b[1][l],t=!w&&c[1][l],y,c=function(){!w&&S(O-v)>20&&(A=h||S(s-t)/S(O-v));r=(o-s)/A+O;p=i["plot"+(a?"Width":"Height")]/A};c();b=r;b<n.min?(b=n.min,y=!0):b+p>n.max&&(b=n.max-p,y=!0);y?(s-=0.8*(s-g[j][0]),w||(t-=0.8*(t-
g[j][1])),c()):g[j]=[s,t];q||(f[j]=r-o,f[m]=p);f=q?1/A:A;e[m]=p;e[j]=b;d[q?a?"scaleY":"scaleX":"scale"+k]=A;d["translate"+k]=f*o+(s-f*O)},pinch:function(a){var b=this,c=b.chart,d=b.pinchDown,e=a.touches,f=e.length,g=b.lastValidTouch,h=b.hasZoom,i=b.selectionMarker,j={},k=f===1&&(b.inClass(a.target,"highcharts-tracker")&&c.runTrackerClick||b.runChartClick),l={};if(f>1)b.initiated=!0;h&&b.initiated&&!k&&a.preventDefault();ta(e,function(a){return b.normalize(a)});if(a.type==="touchstart")n(e,function(a,
b){d[b]={chartX:a.chartX,chartY:a.chartY}}),g.x=[d[0].chartX,d[1]&&d[1].chartX],g.y=[d[0].chartY,d[1]&&d[1].chartY],n(c.axes,function(a){if(a.zoomEnabled){var b=c.bounds[a.horiz?"h":"v"],d=a.minPixelPadding,e=a.toPixels(q(a.options.min,a.dataMin)),f=a.toPixels(q(a.options.max,a.dataMax)),g=E(e,f),e=v(e,f);b.min=E(a.pos,g-d);b.max=v(a.pos+a.len,e+d)}}),b.res=!0;else if(d.length){if(!i)b.selectionMarker=i=x({destroy:ra,touch:!0},c.plotBox);b.pinchTranslate(d,e,j,i,l,g);b.hasPinched=h;b.scaleGroups(j,
l);if(!h&&b.followTouchMove&&f===1)this.runPointActions(b.normalize(a));else if(b.res)b.res=!1,this.reset(!1,0)}},touch:function(a,b){var c=this.chart,d;oa=c.index;if(a.touches.length===1)if(a=this.normalize(a),c.isInsidePlot(a.chartX-c.plotLeft,a.chartY-c.plotTop)&&!c.openMenu){b&&this.runPointActions(a);if(a.type==="touchmove")c=this.pinchDown,d=Math.sqrt(Math.pow(c[0].chartX-a.chartX,2)+Math.pow(c[0].chartY-a.chartY,2))>=4;q(d,!0)&&this.pinch(a)}else b&&this.reset();else a.touches.length===2&&
this.pinch(a)},onContainerTouchStart:function(a){this.touch(a,!0)},onContainerTouchMove:function(a){this.touch(a)},onDocumentTouchEnd:function(a){$[oa]&&$[oa].pointer.drop(a)}});if(J.PointerEvent||J.MSPointerEvent){var Ga={},Mb=!!J.PointerEvent,ac=function(){var a,b=[];b.item=function(a){return this[a]};for(a in Ga)Ga.hasOwnProperty(a)&&b.push({pageX:Ga[a].pageX,pageY:Ga[a].pageY,target:Ga[a].target});return b},Nb=function(a,b,c,d){if((a.pointerType==="touch"||a.pointerType===a.MSPOINTER_TYPE_TOUCH)&&
$[oa])d(a),d=$[oa].pointer,d[b]({type:c,target:a.currentTarget,preventDefault:ra,touches:ac()})};x(Za.prototype,{onContainerPointerDown:function(a){Nb(a,"onContainerTouchStart","touchstart",function(a){Ga[a.pointerId]={pageX:a.pageX,pageY:a.pageY,target:a.currentTarget}})},onContainerPointerMove:function(a){Nb(a,"onContainerTouchMove","touchmove",function(a){Ga[a.pointerId]={pageX:a.pageX,pageY:a.pageY};if(!Ga[a.pointerId].target)Ga[a.pointerId].target=a.currentTarget})},onDocumentPointerUp:function(a){Nb(a,
"onDocumentTouchEnd","touchend",function(a){delete Ga[a.pointerId]})},batchMSEvents:function(a){a(this.chart.container,Mb?"pointerdown":"MSPointerDown",this.onContainerPointerDown);a(this.chart.container,Mb?"pointermove":"MSPointerMove",this.onContainerPointerMove);a(B,Mb?"pointerup":"MSPointerUp",this.onDocumentPointerUp)}});U(Za.prototype,"init",function(a,b,c){a.call(this,b,c);this.hasZoom&&F(b.container,{"-ms-touch-action":"none","touch-action":"none"})});U(Za.prototype,"setDOMEvents",function(a){a.apply(this);
(this.hasZoom||this.followTouchMove)&&this.batchMSEvents(D)});U(Za.prototype,"destroy",function(a){this.batchMSEvents(T);a.call(this)})}var vb=z.Legend=function(a,b){this.init(a,b)};vb.prototype={init:function(a,b){var c=this,d=b.itemStyle,e=b.itemMarginTop||0;this.options=b;if(b.enabled)c.itemStyle=d,c.itemHiddenStyle=C(d,b.itemHiddenStyle),c.itemMarginTop=e,c.padding=d=q(b.padding,8),c.initialItemX=d,c.initialItemY=d-5,c.maxItemWidth=0,c.chart=a,c.itemHeight=0,c.symbolWidth=q(b.symbolWidth,16),
c.pages=[],c.render(),D(c.chart,"endResize",function(){c.positionCheckboxes()})},colorizeItem:function(a,b){var c=this.options,d=a.legendItem,e=a.legendLine,f=a.legendSymbol,g=this.itemHiddenStyle.color,c=b?c.itemStyle.color:g,h=b?a.legendColor||a.color||"#CCC":g,g=a.options&&a.options.marker,i={fill:h},j;d&&d.css({fill:c,color:c});e&&e.attr({stroke:h});if(f){if(g&&f.isMarker)for(j in i.stroke=h,g=a.convertAttribs(g),g)d=g[j],d!==t&&(i[j]=d);f.attr(i)}},positionItem:function(a){var b=this.options,
c=b.symbolPadding,b=!b.rtl,d=a._legendItemPos,e=d[0],d=d[1],f=a.checkbox;(a=a.legendGroup)&&a.element&&a.translate(b?e:this.legendWidth-e-2*c-4,d);if(f)f.x=e,f.y=d},destroyItem:function(a){var b=a.checkbox;n(["legendItem","legendLine","legendSymbol","legendGroup"],function(b){a[b]&&(a[b]=a[b].destroy())});b&&Va(a.checkbox)},destroy:function(){var a=this.group,b=this.box;if(b)this.box=b.destroy();if(a)this.group=a.destroy()},positionCheckboxes:function(a){var b=this.group.alignAttr,c,d=this.clipHeight||
this.legendHeight,e=this.titleHeight;if(b)c=b.translateY,n(this.allItems,function(f){var g=f.checkbox,h;g&&(h=c+e+g.y+(a||0)+3,F(g,{left:b.translateX+f.checkboxOffset+g.x-20+"px",top:h+"px",display:h>c-6&&h<c+d-6?"":"none"}))})},renderTitle:function(){var a=this.padding,b=this.options.title,c=0;if(b.text){if(!this.title)this.title=this.chart.renderer.label(b.text,a-3,a-4,null,null,null,null,null,"legend-title").attr({zIndex:1}).css(b.style).add(this.group);a=this.title.getBBox();c=a.height;this.offsetWidth=
a.width;this.contentGroup.attr({translateY:c})}this.titleHeight=c},setText:function(a){var b=this.options;a.legendItem.attr({text:b.labelFormat?La(b.labelFormat,a):b.labelFormatter.call(a)})},renderItem:function(a){var b=this.chart,c=b.renderer,d=this.options,e=d.layout==="horizontal",f=this.symbolWidth,g=d.symbolPadding,h=this.itemStyle,i=this.itemHiddenStyle,j=this.padding,k=e?q(d.itemDistance,20):0,l=!d.rtl,m=d.width,o=d.itemMarginBottom||0,p=this.itemMarginTop,r=this.initialItemX,A=a.legendItem,
n=a.series&&a.series.drawLegendSymbol?a.series:a,u=n.options,u=this.createCheckboxForItem&&u&&u.showCheckbox,w=d.useHTML;if(!A){a.legendGroup=c.g("legend-item").attr({zIndex:1}).add(this.scrollGroup);a.legendItem=A=c.text("",l?f+g:-g,this.baseline||0,w).css(C(a.visible?h:i)).attr({align:l?"left":"right",zIndex:2}).add(a.legendGroup);if(!this.baseline)this.fontMetrics=c.fontMetrics(h.fontSize,A),this.baseline=this.fontMetrics.f+3+p,A.attr("y",this.baseline);n.drawLegendSymbol(this,a);this.setItemEvents&&
this.setItemEvents(a,A,w,h,i);u&&this.createCheckboxForItem(a)}this.colorizeItem(a,a.visible);this.setText(a);c=A.getBBox();f=a.checkboxOffset=d.itemWidth||a.legendItemWidth||f+g+c.width+k+(u?20:0);this.itemHeight=g=y(a.legendItemHeight||c.height);if(e&&this.itemX-r+f>(m||b.chartWidth-2*j-r-d.x))this.itemX=r,this.itemY+=p+this.lastLineHeight+o,this.lastLineHeight=0;this.maxItemWidth=v(this.maxItemWidth,f);this.lastItemY=p+this.itemY+o;this.lastLineHeight=v(g,this.lastLineHeight);a._legendItemPos=
[this.itemX,this.itemY];e?this.itemX+=f:(this.itemY+=p+g+o,this.lastLineHeight=g);this.offsetWidth=m||v((e?this.itemX-r-k:f)+j,this.offsetWidth)},getAllItems:function(){var a=[];n(this.chart.series,function(b){var c=b.options;if(q(c.showInLegend,!s(c.linkedTo)?t:!1,!0))a=a.concat(b.legendItems||(c.legendType==="point"?b.data:b))});return a},adjustMargins:function(a,b){var c=this.chart,d=this.options,e=d.align.charAt(0)+d.verticalAlign.charAt(0)+d.layout.charAt(0);this.display&&!d.floating&&n([/(lth|ct|rth)/,
/(rtv|rm|rbv)/,/(rbh|cb|lbh)/,/(lbv|lm|ltv)/],function(f,g){f.test(e)&&!s(a[g])&&(c[ub[g]]=v(c[ub[g]],c.legend[(g+1)%2?"legendHeight":"legendWidth"]+[1,-1,-1,1][g]*d[g%2?"x":"y"]+q(d.margin,12)+b[g]))})},render:function(){var a=this,b=a.chart,c=b.renderer,d=a.group,e,f,g,h,i=a.box,j=a.options,k=a.padding,l=j.borderWidth,m=j.backgroundColor;a.itemX=a.initialItemX;a.itemY=a.initialItemY;a.offsetWidth=0;a.lastItemY=0;if(!d)a.group=d=c.g("legend").attr({zIndex:7}).add(),a.contentGroup=c.g().attr({zIndex:1}).add(d),
a.scrollGroup=c.g().add(a.contentGroup);a.renderTitle();e=a.getAllItems();ob(e,function(a,b){return(a.options&&a.options.legendIndex||0)-(b.options&&b.options.legendIndex||0)});j.reversed&&e.reverse();a.allItems=e;a.display=f=!!e.length;a.lastLineHeight=0;n(e,function(b){a.renderItem(b)});g=(j.width||a.offsetWidth)+k;h=a.lastItemY+a.lastLineHeight+a.titleHeight;h=a.handleOverflow(h);h+=k;if(l||m){if(i){if(g>0&&h>0)i[i.isNew?"attr":"animate"](i.crisp({width:g,height:h})),i.isNew=!1}else a.box=i=c.rect(0,
0,g,h,j.borderRadius,l||0).attr({stroke:j.borderColor,"stroke-width":l||0,fill:m||"none"}).add(d).shadow(j.shadow),i.isNew=!0;i[f?"show":"hide"]()}a.legendWidth=g;a.legendHeight=h;n(e,function(b){a.positionItem(b)});f&&d.align(x({width:g,height:h},j),!0,"spacingBox");b.isResizing||this.positionCheckboxes()},handleOverflow:function(a){var b=this,c=this.chart,d=c.renderer,e=this.options,f=e.y,f=c.spacingBox.height+(e.verticalAlign==="top"?-f:f)-this.padding,g=e.maxHeight,h,i=this.clipRect,j=e.navigation,
k=q(j.animation,!0),l=j.arrowSize||12,m=this.nav,o=this.pages,p=this.padding,r,A=this.allItems,P=function(a){i.attr({height:a});if(b.contentGroup.div)b.contentGroup.div.style.clip="rect("+p+"px,9999px,"+(p+a)+"px,0)"};e.layout==="horizontal"&&(f/=2);g&&(f=E(f,g));o.length=0;if(a>f&&j.enabled!==!1){this.clipHeight=h=v(f-20-this.titleHeight-p,0);this.currentPage=q(this.currentPage,1);this.fullHeight=a;n(A,function(a,b){var c=a._legendItemPos[1],d=y(a.legendItem.getBBox().height),e=o.length;if(!e||c-
o[e-1]>h&&(r||c)!==o[e-1])o.push(r||c),e++;b===A.length-1&&c+d-o[e-1]>h&&o.push(c);c!==r&&(r=c)});if(!i)i=b.clipRect=d.clipRect(0,p,9999,0),b.contentGroup.clip(i);P(h);if(!m)this.nav=m=d.g().attr({zIndex:1}).add(this.group),this.up=d.symbol("triangle",0,0,l,l).on("click",function(){b.scroll(-1,k)}).add(m),this.pager=d.text("",15,10).css(j.style).add(m),this.down=d.symbol("triangle-down",0,0,l,l).on("click",function(){b.scroll(1,k)}).add(m);b.scroll(0);a=f}else if(m)P(c.chartHeight),m.hide(),this.scrollGroup.attr({translateY:1}),
this.clipHeight=0;return a},scroll:function(a,b){var c=this.pages,d=c.length,e=this.currentPage+a,f=this.clipHeight,g=this.options.navigation,h=g.activeColor,g=g.inactiveColor,i=this.pager,j=this.padding;e>d&&(e=d);if(e>0)b!==t&&ab(b,this.chart),this.nav.attr({translateX:j,translateY:f+this.padding+7+this.titleHeight,visibility:"visible"}),this.up.attr({fill:e===1?g:h}).css({cursor:e===1?"default":"pointer"}),i.attr({text:e+"/"+d}),this.down.attr({x:18+this.pager.getBBox().width,fill:e===d?g:h}).css({cursor:e===
d?"default":"pointer"}),c=-c[e-1]+this.initialItemY,this.scrollGroup.animate({translateY:c}),this.currentPage=e,this.positionCheckboxes(c)}};aa=z.LegendSymbolMixin={drawRectangle:function(a,b){var c=a.options.symbolHeight||a.fontMetrics.f;b.legendSymbol=this.chart.renderer.rect(0,a.baseline-c+1,a.symbolWidth,c,a.options.symbolRadius||0).attr({zIndex:3}).add(b.legendGroup)},drawLineMarker:function(a){var b=this.options,c=b.marker,d=a.symbolWidth,e=this.chart.renderer,f=this.legendGroup,a=a.baseline-
y(a.fontMetrics.b*0.3),g;if(b.lineWidth){g={"stroke-width":b.lineWidth};if(b.dashStyle)g.dashstyle=b.dashStyle;this.legendLine=e.path(["M",0,a,"L",d,a]).attr(g).add(f)}if(c&&c.enabled!==!1)b=c.radius,this.legendSymbol=c=e.symbol(this.symbol,d/2-b,a-b,2*b,2*b,c).add(f),c.isMarker=!0}};(/Trident\/7\.0/.test(Ma)||Xa)&&U(vb.prototype,"positionItem",function(a,b){var c=this,d=function(){b._legendItemPos&&a.call(c,b)};d();setTimeout(d)});var Ca=z.Chart=function(){this.getArgs.apply(this,arguments)};z.chart=
function(a,b,c){return new Ca(a,b,c)};Ca.prototype={callbacks:[],getArgs:function(){var a=[].slice.call(arguments);if(Da(a[0])||a[0].nodeName)this.renderTo=a.shift();this.init(a[0],a[1])},init:function(a,b){var c,d=a.series;a.series=null;c=C(N,a);c.series=a.series=d;this.userOptions=a;d=c.chart;this.margin=this.splashArray("margin",d);this.spacing=this.splashArray("spacing",d);var e=d.events;this.bounds={h:{},v:{}};this.callback=b;this.isResizing=0;this.options=c;this.axes=[];this.series=[];this.hasCartesianSeries=
d.showAxes;var f=this,g;f.index=$.length;$.push(f);lb++;d.reflow!==!1&&D(f,"load",function(){f.initReflow()});if(e)for(g in e)D(f,g,e[g]);f.xAxis=[];f.yAxis=[];f.animation=qa?!1:q(d.animation,!0);f.pointCount=f.colorCounter=f.symbolCounter=0;f.firstRender()},initSeries:function(a){var b=this.options.chart;(b=K[a.type||b.type||b.defaultSeriesType])||ga(17,!0);b=new b;b.init(this,a);return b},isInsidePlot:function(a,b,c){var d=c?b:a,a=c?a:b;return d>=0&&d<=this.plotWidth&&a>=0&&a<=this.plotHeight},
redraw:function(a){var b=this.axes,c=this.series,d=this.pointer,e=this.legend,f=this.isDirtyLegend,g,h,i=this.hasCartesianSeries,j=this.isDirtyBox,k=c.length,l=k,m=this.renderer,o=m.isHidden(),p=[];ab(a,this);o&&this.cloneRenderTo();for(this.layOutTitles();l--;)if(a=c[l],a.options.stacking&&(g=!0,a.isDirty)){h=!0;break}if(h)for(l=k;l--;)if(a=c[l],a.options.stacking)a.isDirty=!0;n(c,function(a){a.isDirty&&a.options.legendType==="point"&&(a.updateTotals&&a.updateTotals(),f=!0)});if(f&&e.options.enabled)e.render(),
this.isDirtyLegend=!1;g&&this.getStacks();if(i&&!this.isResizing)this.maxTicks=null,n(b,function(a){a.setScale()});this.getMargins();i&&(n(b,function(a){a.isDirty&&(j=!0)}),n(b,function(a){var b=a.min+","+a.max;if(a.extKey!==b)a.extKey=b,p.push(function(){M(a,"afterSetExtremes",x(a.eventArgs,a.getExtremes()));delete a.eventArgs});(j||g)&&a.redraw()}));j&&this.drawChartBox();n(c,function(a){a.isDirty&&a.visible&&(!a.isCartesian||a.xAxis)&&a.redraw()});d&&d.reset(!0);m.draw();M(this,"redraw");o&&this.cloneRenderTo(!0);
n(p,function(a){a.call()})},get:function(a){var b=this.axes,c=this.series,d,e;for(d=0;d<b.length;d++)if(b[d].options.id===a)return b[d];for(d=0;d<c.length;d++)if(c[d].options.id===a)return c[d];for(d=0;d<c.length;d++){e=c[d].points||[];for(b=0;b<e.length;b++)if(e[b].id===a)return e[b]}return null},getAxes:function(){var a=this,b=this.options,c=b.xAxis=va(b.xAxis||{}),b=b.yAxis=va(b.yAxis||{});n(c,function(a,b){a.index=b;a.isX=!0});n(b,function(a,b){a.index=b});c=c.concat(b);n(c,function(b){new I(a,
b)})},getSelectedPoints:function(){var a=[];n(this.series,function(b){a=a.concat(Sa(b.points||[],function(a){return a.selected}))});return a},getSelectedSeries:function(){return Sa(this.series,function(a){return a.selected})},setTitle:function(a,b,c){var g;var d=this,e=d.options,f;f=e.title=C(e.title,a);g=e.subtitle=C(e.subtitle,b),e=g;n([["title",a,f],["subtitle",b,e]],function(a){var b=a[0],c=d[b],e=a[1],a=a[2];c&&e&&(d[b]=c=c.destroy());a&&a.text&&!c&&(d[b]=d.renderer.text(a.text,0,0,a.useHTML).attr({align:a.align,
"class":"highcharts-"+b,zIndex:a.zIndex||4}).css(a.style).add())});d.layOutTitles(c)},layOutTitles:function(a){var b=0,c=this.title,d=this.subtitle,e=this.options,f=e.title,e=e.subtitle,g=this.renderer,h=this.spacingBox.width-44;if(c&&(c.css({width:(f.width||h)+"px"}).align(x({y:g.fontMetrics(f.style.fontSize,c).b-3},f),!1,"spacingBox"),!f.floating&&!f.verticalAlign))b=c.getBBox().height;d&&(d.css({width:(e.width||h)+"px"}).align(x({y:b+(f.margin-13)+g.fontMetrics(e.style.fontSize,c).b},e),!1,"spacingBox"),
!e.floating&&!e.verticalAlign&&(b=Fa(b+d.getBBox().height)));c=this.titleOffset!==b;this.titleOffset=b;if(!this.isDirtyBox&&c)this.isDirtyBox=c,this.hasRendered&&q(a,!0)&&this.isDirtyBox&&this.redraw()},getChartSize:function(){var a=this.options.chart,b=a.width,a=a.height,c=this.renderToClone||this.renderTo;if(!s(b))this.containerWidth=xa(c,"width");if(!s(a))this.containerHeight=xa(c,"height");this.chartWidth=v(0,b||this.containerWidth||600);this.chartHeight=v(0,q(a,this.containerHeight>19?this.containerHeight:
400))},cloneRenderTo:function(a){var b=this.renderToClone,c=this.container;a?b&&(this.renderTo.appendChild(c),Va(b),delete this.renderToClone):(c&&c.parentNode===this.renderTo&&this.renderTo.removeChild(c),this.renderToClone=b=this.renderTo.cloneNode(0),F(b,{position:"absolute",top:"-9999px",display:"block"}),b.style.setProperty&&b.style.setProperty("display","block","important"),B.body.appendChild(b),c&&b.appendChild(c))},getContainer:function(){var a,b=this.options,c=b.chart,d,e;a=this.renderTo;
var f="highcharts-"+Jb++;if(!a)this.renderTo=a=c.renderTo;if(Da(a))this.renderTo=a=B.getElementById(a);a||ga(13,!0);d=G(X(a,"data-highcharts-chart"));!isNaN(d)&&$[d]&&$[d].hasRendered&&$[d].destroy();X(a,"data-highcharts-chart",this.index);a.innerHTML="";!c.skipClone&&!a.offsetWidth&&this.cloneRenderTo();this.getChartSize();d=this.chartWidth;e=this.chartHeight;this.container=a=ea(Wa,{className:"highcharts-container"+(c.className?" "+c.className:""),id:f},x({position:"relative",overflow:"hidden",width:d+
"px",height:e+"px",textAlign:"left",lineHeight:"normal",zIndex:0,"-webkit-tap-highlight-color":"rgba(0,0,0,0)"},c.style),this.renderToClone||a);this._cursor=a.style.cursor;this.renderer=new (z[c.renderer]||Ya)(a,d,e,c.style,c.forExport,b.exporting&&b.exporting.allowHTML);qa&&this.renderer.create(this,a,d,e);this.renderer.chartIndex=this.index},getMargins:function(a){var b=this.spacing,c=this.margin,d=this.titleOffset;this.resetMargins();if(d&&!s(c[0]))this.plotTop=v(this.plotTop,d+this.options.title.margin+
b[0]);this.legend.adjustMargins(c,b);this.extraBottomMargin&&(this.marginBottom+=this.extraBottomMargin);this.extraTopMargin&&(this.plotTop+=this.extraTopMargin);a||this.getAxisMargins()},getAxisMargins:function(){var a=this,b=a.axisOffset=[0,0,0,0],c=a.margin;a.hasCartesianSeries&&n(a.axes,function(a){a.visible&&a.getOffset()});n(ub,function(d,e){s(c[e])||(a[d]+=b[e])});a.setChartSize()},reflow:function(a){var b=this,c=b.options.chart,d=b.renderTo,e=c.width||xa(d,"width"),f=c.height||xa(d,"height"),
c=a?a.target:J;if(!b.hasUserSize&&!b.isPrinting&&e&&f&&(c===J||c===B)){if(e!==b.containerWidth||f!==b.containerHeight)clearTimeout(b.reflowTimeout),b.reflowTimeout=$a(function(){if(b.container)b.setSize(e,f,!1),b.hasUserSize=null},a?100:0);b.containerWidth=e;b.containerHeight=f}},initReflow:function(){var a=this,b=function(b){a.reflow(b)};D(J,"resize",b);D(a,"destroy",function(){T(J,"resize",b)})},setSize:function(a,b,c){var d=this,e,f,g=d.renderer;d.isResizing+=1;ab(c,d);d.oldChartHeight=d.chartHeight;
d.oldChartWidth=d.chartWidth;if(s(a))d.chartWidth=e=v(0,y(a)),d.hasUserSize=!!e;if(s(b))d.chartHeight=f=v(0,y(b));a=g.globalAnimation;(a?eb:F)(d.container,{width:e+"px",height:f+"px"},a);d.setChartSize(!0);g.setSize(e,f,c);d.maxTicks=null;n(d.axes,function(a){a.isDirty=!0;a.setScale()});n(d.series,function(a){a.isDirty=!0});d.isDirtyLegend=!0;d.isDirtyBox=!0;d.layOutTitles();d.getMargins();d.redraw(c);d.oldChartHeight=null;M(d,"resize");$a(function(){d&&M(d,"endResize",null,function(){d.isResizing-=
1})},hb(a).duration)},setChartSize:function(a){var b=this.inverted,c=this.renderer,d=this.chartWidth,e=this.chartHeight,f=this.options.chart,g=this.spacing,h=this.clipOffset,i,j,k,l;this.plotLeft=i=y(this.plotLeft);this.plotTop=j=y(this.plotTop);this.plotWidth=k=v(0,y(d-i-this.marginRight));this.plotHeight=l=v(0,y(e-j-this.marginBottom));this.plotSizeX=b?l:k;this.plotSizeY=b?k:l;this.plotBorderWidth=f.plotBorderWidth||0;this.spacingBox=c.spacingBox={x:g[3],y:g[0],width:d-g[3]-g[1],height:e-g[0]-g[2]};
this.plotBox=c.plotBox={x:i,y:j,width:k,height:l};d=2*V(this.plotBorderWidth/2);b=Fa(v(d,h[3])/2);c=Fa(v(d,h[0])/2);this.clipBox={x:b,y:c,width:V(this.plotSizeX-v(d,h[1])/2-b),height:v(0,V(this.plotSizeY-v(d,h[2])/2-c))};a||n(this.axes,function(a){a.setAxisSize();a.setAxisTranslation()})},resetMargins:function(){var a=this;n(ub,function(b,c){a[b]=q(a.margin[c],a.spacing[c])});a.axisOffset=[0,0,0,0];a.clipOffset=[0,0,0,0]},drawChartBox:function(){var a=this.options.chart,b=this.renderer,c=this.chartWidth,
d=this.chartHeight,e=this.chartBackground,f=this.plotBackground,g=this.plotBorder,h=this.plotBGImage,i=a.borderWidth||0,j=a.backgroundColor,k=a.plotBackgroundColor,l=a.plotBackgroundImage,m=a.plotBorderWidth||0,o,p=this.plotLeft,r=this.plotTop,A=this.plotWidth,q=this.plotHeight,n=this.plotBox,w=this.clipRect,O=this.clipBox;o=i+(a.shadow?8:0);if(i||j)if(e)e.animate(e.crisp({width:c-o,height:d-o}));else{e={fill:j||"none"};if(i)e.stroke=a.borderColor,e["stroke-width"]=i;this.chartBackground=b.rect(o/
2,o/2,c-o,d-o,a.borderRadius,i).attr(e).addClass("highcharts-background").add().shadow(a.shadow)}if(k)f?f.animate(n):this.plotBackground=b.rect(p,r,A,q,0).attr({fill:k}).add().shadow(a.plotShadow);if(l)h?h.animate(n):this.plotBGImage=b.image(l,p,r,A,q).add();w?w.animate({width:O.width,height:O.height}):this.clipRect=b.clipRect(O);if(m)g?(g.strokeWidth=-m,g.animate(g.crisp({x:p,y:r,width:A,height:q}))):this.plotBorder=b.rect(p,r,A,q,0,-m).attr({stroke:a.plotBorderColor,"stroke-width":m,fill:"none",
zIndex:1}).add();this.isDirtyBox=!1},propFromSeries:function(){var a=this,b=a.options.chart,c,d=a.options.series,e,f;n(["inverted","angular","polar"],function(g){c=K[b.type||b.defaultSeriesType];f=a[g]||b[g]||c&&c.prototype[g];for(e=d&&d.length;!f&&e--;)(c=K[d[e].type])&&c.prototype[g]&&(f=!0);a[g]=f})},linkSeries:function(){var a=this,b=a.series;n(b,function(a){a.linkedSeries.length=0});n(b,function(b){var d=b.options.linkedTo;if(Da(d)&&(d=d===":previous"?a.series[b.index-1]:a.get(d)))d.linkedSeries.push(b),
b.linkedParent=d,b.visible=q(b.options.visible,d.options.visible,b.visible)})},renderSeries:function(){n(this.series,function(a){a.translate();a.render()})},renderLabels:function(){var a=this,b=a.options.labels;b.items&&n(b.items,function(c){var d=x(b.style,c.style),e=G(d.left)+a.plotLeft,f=G(d.top)+a.plotTop+12;delete d.left;delete d.top;a.renderer.text(c.html,e,f).attr({zIndex:2}).css(d).add()})},render:function(){var a=this.axes,b=this.renderer,c=this.options,d,e,f,g;this.setTitle();this.legend=
new vb(this,c.legend);this.getStacks&&this.getStacks();this.getMargins(!0);this.setChartSize();d=this.plotWidth;e=this.plotHeight-=21;n(a,function(a){a.setScale()});this.getAxisMargins();f=d/this.plotWidth>1.1;g=e/this.plotHeight>1.05;if(f||g)this.maxTicks=null,n(a,function(a){(a.horiz&&f||!a.horiz&&g)&&a.setTickInterval(!0)}),this.getMargins();this.drawChartBox();this.hasCartesianSeries&&n(a,function(a){a.visible&&a.render()});if(!this.seriesGroup)this.seriesGroup=b.g("series-group").attr({zIndex:3}).add();
this.renderSeries();this.renderLabels();this.showCredits(c.credits);this.hasRendered=!0},showCredits:function(a){if(a.enabled&&!this.credits)this.credits=this.renderer.text(a.text,0,0).on("click",function(){if(a.href)J.location.href=a.href}).attr({align:a.position.align,zIndex:8}).css(a.style).add().align(a.position)},destroy:function(){var a=this,b=a.axes,c=a.series,d=a.container,e,f=d&&d.parentNode;M(a,"destroy");$[a.index]=t;lb--;a.renderTo.removeAttribute("data-highcharts-chart");T(a);for(e=b.length;e--;)b[e]=
b[e].destroy();for(e=c.length;e--;)c[e]=c[e].destroy();n("title,subtitle,chartBackground,plotBackground,plotBGImage,plotBorder,seriesGroup,clipRect,credits,pointer,scroller,rangeSelector,legend,resetZoomButton,tooltip,renderer".split(","),function(b){var c=a[b];c&&c.destroy&&(a[b]=c.destroy())});if(d)d.innerHTML="",T(d),f&&Va(d);for(e in a)delete a[e]},isReadyToRender:function(){var a=this;return!ja&&J==J.top&&B.readyState!=="complete"||qa&&!J.canvg?(qa?Wb.push(function(){a.firstRender()},a.options.global.canvasToolsURL):
B.attachEvent("onreadystatechange",function(){B.detachEvent("onreadystatechange",a.firstRender);B.readyState==="complete"&&a.firstRender()}),!1):!0},firstRender:function(){var a=this,b=a.options;if(a.isReadyToRender()){a.getContainer();M(a,"init");a.resetMargins();a.setChartSize();a.propFromSeries();a.getAxes();n(b.series||[],function(b){a.initSeries(b)});a.linkSeries();M(a,"beforeRender");if(z.Pointer)a.pointer=new Za(a,b);a.render();a.renderer.draw();if(!a.renderer.imgCount&&a.onload)a.onload();
a.cloneRenderTo(!0)}},onload:function(){var a=this;n([this.callback].concat(this.callbacks),function(b){b&&a.index!==void 0&&b.apply(a,[a])});M(a,"load");this.onload=null},splashArray:function(a,b){var c=b[a],c=da(c)?c:[c,c,c,c];return[q(b[a+"Top"],c[0]),q(b[a+"Right"],c[1]),q(b[a+"Bottom"],c[2]),q(b[a+"Left"],c[3])]}};var bc=z.CenteredSeriesMixin={getCenter:function(){var a=this.options,b=this.chart,c=2*(a.slicedOffset||0),d=b.plotWidth-2*c,b=b.plotHeight-2*c,e=a.center,e=[q(e[0],"50%"),q(e[1],"50%"),
a.size||"100%",a.innerSize||0],f=E(d,b),g,h;for(g=0;g<4;++g)h=e[g],a=g<2||g===2&&/%$/.test(h),e[g]=(/%$/.test(h)?[d,b,f,e[2]][g]*parseFloat(h)/100:parseFloat(h))+(a?c:0);e[3]>e[2]&&(e[3]=e[2]);return e}},Ha=function(){};Ha.prototype={init:function(a,b,c){this.series=a;this.color=a.color;this.applyOptions(b,c);this.pointAttr={};if(a.options.colorByPoint&&(b=a.options.colors||a.chart.options.colors,this.color=this.color||b[a.colorCounter++],a.colorCounter===b.length))a.colorCounter=0;a.chart.pointCount++;
return this},applyOptions:function(a,b){var c=this.series,d=c.options.pointValKey||c.pointValKey,a=Ha.prototype.optionsToObject.call(this,a);x(this,a);this.options=this.options?x(this.options,a):a;if(d)this.y=this[d];this.isNull=this.y===null;if(this.x===void 0&&c)this.x=b===void 0?c.autoIncrement():b;return this},optionsToObject:function(a){var b={},c=this.series,d=c.options.keys,e=d||c.pointArrayMap||["y"],f=e.length,g=0,h=0;if(typeof a==="number"||a===null)b[e[0]]=a;else if(Ja(a)){if(!d&&a.length>
f){c=typeof a[0];if(c==="string")b.name=a[0];else if(c==="number")b.x=a[0];g++}for(;h<f;){if(!d||a[g]!==void 0)b[e[h]]=a[g];g++;h++}}else if(typeof a==="object"){b=a;if(a.dataLabels)c._hasPointLabels=!0;if(a.marker)c._hasPointMarkers=!0}return b},destroy:function(){var a=this.series.chart,b=a.hoverPoints,c;a.pointCount--;if(b&&(this.setState(),Aa(b,this),!b.length))a.hoverPoints=null;if(this===a.hoverPoint)this.onMouseOut();if(this.graphic||this.dataLabel)T(this),this.destroyElements();this.legendItem&&
a.legend.destroyItem(this);for(c in this)this[c]=null},destroyElements:function(){for(var a=["graphic","dataLabel","dataLabelUpper","connector","shadowGroup"],b,c=6;c--;)b=a[c],this[b]&&(this[b]=this[b].destroy())},getLabelConfig:function(){return{x:this.category,y:this.y,color:this.color,key:this.name||this.category,series:this.series,point:this,percentage:this.percentage,total:this.total||this.stackTotal}},tooltipFormatter:function(a){var b=this.series,c=b.tooltipOptions,d=q(c.valueDecimals,""),
e=c.valuePrefix||"",f=c.valueSuffix||"";n(b.pointArrayMap||["y"],function(b){b="{point."+b;if(e||f)a=a.replace(b+"}",e+b+"}"+f);a=a.replace(b+"}",b+":,."+d+"f}")});return La(a,{point:this,series:this.series})},firePointEvent:function(a,b,c){var d=this,e=this.series.options;(e.point.events[a]||d.options&&d.options.events&&d.options.events[a])&&this.importEvents();a==="click"&&e.allowPointSelect&&(c=function(a){d.select&&d.select(null,a.ctrlKey||a.metaKey||a.shiftKey)});M(this,a,b,c)},visible:!0};var Q=
z.Series=function(){};Q.prototype={isCartesian:!0,type:"line",pointClass:Ha,sorted:!0,requireSorting:!0,pointAttrToOptions:{stroke:"lineColor","stroke-width":"lineWidth",fill:"fillColor",r:"radius"},directTouch:!1,axisTypes:["xAxis","yAxis"],colorCounter:0,parallelArrays:["x","y"],init:function(a,b){var c=this,d,e,f=a.series,g=function(a,b){return q(a.options.index,a._i)-q(b.options.index,b._i)};c.chart=a;c.options=b=c.setOptions(b);c.linkedSeries=[];c.bindAxes();x(c,{name:b.name,state:"",pointAttr:{},
visible:b.visible!==!1,selected:b.selected===!0});if(qa)b.animation=!1;e=b.events;for(d in e)D(c,d,e[d]);if(e&&e.click||b.point&&b.point.events&&b.point.events.click||b.allowPointSelect)a.runTrackerClick=!0;c.getColor();c.getSymbol();n(c.parallelArrays,function(a){c[a+"Data"]=[]});c.setData(b.data,!1);if(c.isCartesian)a.hasCartesianSeries=!0;f.push(c);c._i=f.length-1;ob(f,g);this.yAxis&&ob(this.yAxis.series,g);n(f,function(a,b){a.index=b;a.name=a.name||"Series "+(b+1)})},bindAxes:function(){var a=
this,b=a.options,c=a.chart,d;n(a.axisTypes||[],function(e){n(c[e],function(c){d=c.options;if(b[e]===d.index||b[e]!==t&&b[e]===d.id||b[e]===t&&d.index===0)c.series.push(a),a[e]=c,c.isDirty=!0});!a[e]&&a.optionalAxis!==e&&ga(18,!0)})},updateParallelArrays:function(a,b){var c=a.series,d=arguments;n(c.parallelArrays,typeof b==="number"?function(d){var f=d==="y"&&c.toYData?c.toYData(a):a[d];c[d+"Data"][b]=f}:function(a){Array.prototype[b].apply(c[a+"Data"],Array.prototype.slice.call(d,2))})},autoIncrement:function(){var a=
this.options,b=this.xIncrement,c,d=a.pointIntervalUnit,b=q(b,a.pointStart,0);this.pointInterval=c=q(this.pointInterval,a.pointInterval,1);d&&(a=new fa(b),d==="day"?a=+a[rb](a[bb]()+c):d==="month"?a=+a[Fb](a[ib]()+c):d==="year"&&(a=+a[Gb](a[jb]()+c)),c=a-b);this.xIncrement=b+c;return b},setOptions:function(a){var b=this.chart,c=b.options.plotOptions,b=b.userOptions||{},d=b.plotOptions||{},e=c[this.type];this.userOptions=a;c=C(e,c.series,a);this.tooltipOptions=C(N.tooltip,N.plotOptions[this.type].tooltip,
b.tooltip,d.series&&d.series.tooltip,d[this.type]&&d[this.type].tooltip,a.tooltip);e.marker===null&&delete c.marker;this.zoneAxis=c.zoneAxis;a=this.zones=(c.zones||[]).slice();if((c.negativeColor||c.negativeFillColor)&&!c.zones)a.push({value:c[this.zoneAxis+"Threshold"]||c.threshold||0,color:c.negativeColor,fillColor:c.negativeFillColor});a.length&&s(a[a.length-1].value)&&a.push({color:this.color,fillColor:this.fillColor});return c},getCyclic:function(a,b,c){var d=this.userOptions,e="_"+a+"Index",
f=a+"Counter";b||(s(d[e])?b=d[e]:(d[e]=b=this.chart[f]%c.length,this.chart[f]+=1),b=c[b]);this[a]=b},getColor:function(){this.options.colorByPoint?this.options.color=null:this.getCyclic("color",this.options.color||W[this.type].color,this.chart.options.colors)},getSymbol:function(){var a=this.options.marker;this.getCyclic("symbol",a.symbol,this.chart.options.symbols);if(/^url/.test(this.symbol))a.radius=0},drawLegendSymbol:aa.drawLineMarker,setData:function(a,b,c,d){var e=this,f=e.points,g=f&&f.length||
0,h,i=e.options,j=e.chart,k=null,l=e.xAxis,m=l&&!!l.categories,o=i.turboThreshold,p=this.xData,r=this.yData,A=(h=e.pointArrayMap)&&h.length,a=a||[];h=a.length;b=q(b,!0);if(d!==!1&&h&&g===h&&!e.cropped&&!e.hasGroupedData&&e.visible)n(a,function(a,b){f[b].update&&a!==i.data[b]&&f[b].update(a,!1,null,!1)});else{e.xIncrement=null;e.colorCounter=0;n(this.parallelArrays,function(a){e[a+"Data"].length=0});if(o&&h>o){for(c=0;k===null&&c<h;)k=a[c],c++;if(ua(k)){m=q(i.pointStart,0);k=q(i.pointInterval,1);for(c=
0;c<h;c++)p[c]=m,r[c]=a[c],m+=k;e.xIncrement=m}else if(Ja(k))if(A)for(c=0;c<h;c++)k=a[c],p[c]=k[0],r[c]=k.slice(1,A+1);else for(c=0;c<h;c++)k=a[c],p[c]=k[0],r[c]=k[1];else ga(12)}else for(c=0;c<h;c++)if(a[c]!==t&&(k={series:e},e.pointClass.prototype.applyOptions.apply(k,[a[c]]),e.updateParallelArrays(k,c),m&&s(k.name)))l.names[k.x]=k.name;Da(r[0])&&ga(14,!0);e.data=[];e.options.data=e.userOptions.data=a;for(c=g;c--;)f[c]&&f[c].destroy&&f[c].destroy();if(l)l.minRange=l.userMinRange;e.isDirty=e.isDirtyData=
j.isDirtyBox=!0;c=!1}i.legendType==="point"&&(this.processData(),this.generatePoints());b&&j.redraw(c)},processData:function(a){var b=this.xData,c=this.yData,d=b.length,e;e=0;var f,g,h=this.xAxis,i,j=this.options;i=j.cropThreshold;var k=this.getExtremesFromAll||j.getExtremesFromAll,l=this.isCartesian,j=h&&h.val2lin,m=h&&h.isLog,o,p;if(l&&!this.isDirty&&!h.isDirty&&!this.yAxis.isDirty&&!a)return!1;if(h)a=h.getExtremes(),o=a.min,p=a.max;if(l&&this.sorted&&!k&&(!i||d>i||this.forceCrop))if(b[d-1]<o||
b[0]>p)b=[],c=[];else if(b[0]<o||b[d-1]>p)e=this.cropData(this.xData,this.yData,o,p),b=e.xData,c=e.yData,e=e.start,f=!0;for(i=b.length||1;--i;)d=m?j(b[i])-j(b[i-1]):b[i]-b[i-1],d>0&&(g===t||d<g)?g=d:d<0&&this.requireSorting&&ga(15);this.cropped=f;this.cropStart=e;this.processedXData=b;this.processedYData=c;this.closestPointRange=g},cropData:function(a,b,c,d){var e=a.length,f=0,g=e,h=q(this.cropShoulder,1),i;for(i=0;i<e;i++)if(a[i]>=c){f=v(0,i-h);break}for(c=i;c<e;c++)if(a[c]>d){g=c+h;break}return{xData:a.slice(f,
g),yData:b.slice(f,g),start:f,end:g}},generatePoints:function(){var a=this.options.data,b=this.data,c,d=this.processedXData,e=this.processedYData,f=this.pointClass,g=d.length,h=this.cropStart||0,i,j=this.hasGroupedData,k,l=[],m;if(!b&&!j)b=[],b.length=a.length,b=this.data=b;for(m=0;m<g;m++)i=h+m,j?(l[m]=(new f).init(this,[d[m]].concat(va(e[m]))),l[m].dataGroup=this.groupMap[m]):(b[i]?k=b[i]:a[i]!==t&&(b[i]=k=(new f).init(this,a[i],d[m])),l[m]=k),l[m].index=i;if(b&&(g!==(c=b.length)||j))for(m=0;m<
c;m++)if(m===h&&!j&&(m+=g),b[m])b[m].destroyElements(),b[m].plotX=t;this.data=b;this.points=l},getExtremes:function(a){var b=this.yAxis,c=this.processedXData,d,e=[],f=0;d=this.xAxis.getExtremes();var g=d.min,h=d.max,i,j,k,l,a=a||this.stackedYData||this.processedYData;d=a.length;for(l=0;l<d;l++)if(j=c[l],k=a[l],i=k!==null&&k!==t&&(!b.isLog||k.length||k>0),j=this.getExtremesFromAll||this.options.getExtremesFromAll||this.cropped||(c[l+1]||j)>=g&&(c[l-1]||j)<=h,i&&j)if(i=k.length)for(;i--;)k[i]!==null&&
(e[f++]=k[i]);else e[f++]=k;this.dataMin=Oa(e);this.dataMax=Ea(e)},translate:function(){this.processedXData||this.processData();this.generatePoints();for(var a=this.options,b=a.stacking,c=this.xAxis,d=c.categories,e=this.yAxis,f=this.points,g=f.length,h=!!this.modifyValue,i=a.pointPlacement,j=i==="between"||ua(i),k=a.threshold,l=a.startFromThreshold?k:0,m,o,p,r,A=Number.MAX_VALUE,a=0;a<g;a++){var n=f[a],u=n.x,w=n.y;o=n.low;var O=b&&e.stacks[(this.negStacks&&w<(l?0:k)?"-":"")+this.stackKey];if(e.isLog&&
w!==null&&w<=0)n.y=w=null,ga(10);n.plotX=m=E(v(-1E5,c.translate(u,0,0,0,1,i,this.type==="flags")),1E5);if(b&&this.visible&&!n.isNull&&O&&O[u])r=this.getStackIndicator(r,u,this.index),O=O[u],w=O.points[r.key],o=w[0],w=w[1],o===l&&(o=q(k,e.min)),e.isLog&&o<=0&&(o=null),n.total=n.stackTotal=O.total,n.percentage=O.total&&n.y/O.total*100,n.stackY=w,O.setOffset(this.pointXOffset||0,this.barW||0);n.yBottom=s(o)?e.translate(o,0,1,0,1):null;h&&(w=this.modifyValue(w,n));n.plotY=o=typeof w==="number"&&w!==Infinity?
E(v(-1E5,e.translate(w,0,1,0,1)),1E5):t;n.isInside=o!==t&&o>=0&&o<=e.len&&m>=0&&m<=c.len;n.clientX=j?c.translate(u,0,0,0,1):m;n.negative=n.y<(k||0);n.category=d&&d[n.x]!==t?d[n.x]:n.x;n.isNull||(p!==void 0&&(A=E(A,S(m-p))),p=m)}this.closestPointRangePx=A},getValidPoints:function(a,b){var c=this.chart;return Sa(a||this.points||[],function(a){return b&&!c.isInsidePlot(a.plotX,a.plotY,c.inverted)?!1:!a.isNull})},setClip:function(a){var b=this.chart,c=this.options,d=b.renderer,e=b.inverted,f=this.clipBox,
g=f||b.clipBox,h=this.sharedClipKey||["_sharedClip",a&&a.duration,a&&a.easing,g.height,c.xAxis,c.yAxis].join(","),i=b[h],j=b[h+"m"];if(!i){if(a)g.width=0,b[h+"m"]=j=d.clipRect(-99,e?-b.plotLeft:-b.plotTop,99,e?b.chartWidth:b.chartHeight);b[h]=i=d.clipRect(g)}a&&(i.count+=1);if(c.clip!==!1)this.group.clip(a||f?i:b.clipRect),this.markerGroup.clip(j),this.sharedClipKey=h;a||(i.count-=1,i.count<=0&&h&&b[h]&&(f||(b[h]=b[h].destroy()),b[h+"m"]&&(b[h+"m"]=b[h+"m"].destroy())))},animate:function(a){var b=
this.chart,c=this.options.animation,d;if(c&&!da(c))c=W[this.type].animation;a?this.setClip(c):(d=this.sharedClipKey,(a=b[d])&&a.animate({width:b.plotSizeX},c),b[d+"m"]&&b[d+"m"].animate({width:b.plotSizeX+99},c),this.animate=null)},afterAnimate:function(){this.setClip();M(this,"afterAnimate")},drawPoints:function(){var a,b=this.points,c=this.chart,d,e,f,g,h,i,j,k,l=this.options.marker,m=this.pointAttr[""],o,p,r,A=this.markerGroup,n=q(l.enabled,this.xAxis.isRadial,this.closestPointRangePx>2*l.radius);
if(l.enabled!==!1||this._hasPointMarkers)for(f=b.length;f--;)if(g=b[f],d=V(g.plotX),e=g.plotY,k=g.graphic,o=g.marker||{},p=!!g.marker,a=n&&o.enabled===t||o.enabled,r=g.isInside,a&&e!==t&&!isNaN(e)&&g.y!==null)if(a=g.pointAttr[g.selected?"select":""]||m,h=a.r,i=q(o.symbol,this.symbol),j=i.indexOf("url")===0,k)k[r?"show":"hide"](!0).attr(a).animate(x({x:d-h,y:e-h},k.symbolName?{width:2*h,height:2*h}:{}));else{if(r&&(h>0||j))g.graphic=c.renderer.symbol(i,d-h,e-h,2*h,2*h,p?o:l).attr(a).add(A)}else if(k)g.graphic=
k.destroy()},convertAttribs:function(a,b,c,d){var e=this.pointAttrToOptions,f,g,h={},a=a||{},b=b||{},c=c||{},d=d||{};for(f in e)g=e[f],h[f]=q(a[g],b[f],c[f],d[f]);return h},getAttribs:function(){var a=this,b=a.options,c=W[a.type].marker?b.marker:b,d=c.states,e=d.hover,f,g=a.color,h=a.options.negativeColor;f={stroke:g,fill:g};var i=a.points||[],j,k,l=[],m=a.pointAttrToOptions;j=a.hasPointSpecificOptions;var o=c.lineColor,p=c.fillColor;k=b.turboThreshold;var r=a.zones,A=a.zoneAxis||"y",P;b.marker?(e.radius=
e.radius||c.radius+e.radiusPlus,e.lineWidth=e.lineWidth||c.lineWidth+e.lineWidthPlus):(e.color=e.color||wa(e.color||g).brighten(e.brightness).get(),e.negativeColor=e.negativeColor||wa(e.negativeColor||h).brighten(e.brightness).get());l[""]=a.convertAttribs(c,f);n(["hover","select"],function(b){l[b]=a.convertAttribs(d[b],l[""])});a.pointAttr=l;g=i.length;if(!k||g<k||j)for(;g--;){k=i[g];if((c=k.options&&k.options.marker||k.options)&&c.enabled===!1)c.radius=0;if(r.length){j=0;for(f=r[j];k[A]>=f.value;)f=
r[++j];k.color=k.fillColor=q(f.color,a.color)}j=b.colorByPoint||k.color;if(k.options)for(P in m)s(c[m[P]])&&(j=!0);if(j){c=c||{};j=[];d=c.states||{};f=d.hover=d.hover||{};if(!b.marker||k.negative&&!f.fillColor&&!e.fillColor)f[a.pointAttrToOptions.fill]=f.color||!k.options.color&&e[k.negative&&h?"negativeColor":"color"]||wa(k.color).brighten(f.brightness||e.brightness).get();f={color:k.color};if(!p)f.fillColor=k.color;if(!o)f.lineColor=k.color;c.hasOwnProperty("color")&&!c.color&&delete c.color;j[""]=
a.convertAttribs(x(f,c),l[""]);j.hover=a.convertAttribs(d.hover,l.hover,j[""]);j.select=a.convertAttribs(d.select,l.select,j[""])}else j=l;k.pointAttr=j}},destroy:function(){var a=this,b=a.chart,c=/AppleWebKit\/533/.test(Ma),d,e=a.data||[],f,g,h;M(a,"destroy");T(a);n(a.axisTypes||[],function(b){if(h=a[b])Aa(h.series,a),h.isDirty=h.forceRedraw=!0});a.legendItem&&a.chart.legend.destroyItem(a);for(d=e.length;d--;)(f=e[d])&&f.destroy&&f.destroy();a.points=null;clearTimeout(a.animationTimeout);for(g in a)a[g]instanceof
Z&&!a[g].survive&&(d=c&&g==="group"?"hide":"destroy",a[g][d]());if(b.hoverSeries===a)b.hoverSeries=null;Aa(b.series,a);for(g in a)delete a[g]},getGraphPath:function(a,b,c){var d=this,e=d.options,f=e.step,g,h=[],i,a=a||d.points;(g=a.reversed)&&a.reverse();(f={right:1,center:2}[f]||f&&3)&&g&&(f=4-f);e.connectNulls&&!b&&!c&&(a=this.getValidPoints(a));n(a,function(g,k){var l=g.plotX,m=g.plotY,o=a[k-1];if((g.leftCliff||o&&o.rightCliff)&&!c)i=!0;g.isNull&&!s(b)&&k>0?i=!e.connectNulls:g.isNull&&!b?i=!0:
(k===0||i?o=["M",g.plotX,g.plotY]:d.getPointSpline?o=d.getPointSpline(a,g,k):f?(o=f===1?["L",o.plotX,m]:f===2?["L",(o.plotX+l)/2,o.plotY,"L",(o.plotX+l)/2,m]:["L",l,o.plotY],o.push("L",l,m)):o=["L",l,m],h.push.apply(h,o),i=!1)});return d.graphPath=h},drawGraph:function(){var a=this,b=this.options,c=[["graph",b.lineColor||this.color,b.dashStyle]],d=b.lineWidth,e=b.linecap!=="square",f=(this.gappedPath||this.getGraphPath).call(this),g=this.fillGraph&&this.color||"none";n(this.zones,function(d,e){c.push(["zoneGraph"+
e,d.color||a.color,d.dashStyle||b.dashStyle])});n(c,function(c,i){var j=c[0],k=a[j];if(k)k.animate({d:f});else if((d||g)&&f.length)k={stroke:c[1],"stroke-width":d,fill:g,zIndex:1},c[2]?k.dashstyle=c[2]:e&&(k["stroke-linecap"]=k["stroke-linejoin"]="round"),a[j]=a.chart.renderer.path(f).attr(k).add(a.group).shadow(i<2&&b.shadow)})},applyZones:function(){var a=this,b=this.chart,c=b.renderer,d=this.zones,e,f,g=this.clips||[],h,i=this.graph,j=this.area,k=v(b.chartWidth,b.chartHeight),l=this[(this.zoneAxis||
"y")+"Axis"],m,o=l.reversed,p=b.inverted,r=l.horiz,A,P,u,w=!1;if(d.length&&(i||j)&&l.min!==t)i&&i.hide(),j&&j.hide(),m=l.getExtremes(),n(d,function(d,n){e=o?r?b.plotWidth:0:r?0:l.toPixels(m.min);e=E(v(q(f,e),0),k);f=E(v(y(l.toPixels(q(d.value,m.max),!0)),0),k);w&&(e=f=l.toPixels(m.max));A=Math.abs(e-f);P=E(e,f);u=v(e,f);if(l.isXAxis){if(h={x:p?u:P,y:0,width:A,height:k},!r)h.x=b.plotHeight-h.x}else if(h={x:0,y:p?u:P,width:k,height:A},r)h.y=b.plotWidth-h.y;b.inverted&&c.isVML&&(h=l.isXAxis?{x:0,y:o?
P:u,height:h.width,width:b.chartWidth}:{x:h.y-b.plotLeft-b.spacingBox.x,y:0,width:h.height,height:b.chartHeight});g[n]?g[n].animate(h):(g[n]=c.clipRect(h),i&&a["zoneGraph"+n].clip(g[n]),j&&a["zoneArea"+n].clip(g[n]));w=d.value>m.max}),this.clips=g},invertGroups:function(){function a(){var a={width:b.yAxis.len,height:b.xAxis.len};n(["group","markerGroup"],function(c){b[c]&&b[c].attr(a).invert()})}var b=this,c=b.chart;if(b.xAxis)D(c,"resize",a),D(b,"destroy",function(){T(c,"resize",a)}),a(),b.invertGroups=
a},plotGroup:function(a,b,c,d,e){var f=this[a],g=!f;g&&(this[a]=f=this.chart.renderer.g(b).attr({zIndex:d||0.1}).add(e),f.addClass("highcharts-series-"+this.index));f.attr({visibility:c})[g?"attr":"animate"](this.getPlotBox());return f},getPlotBox:function(){var a=this.chart,b=this.xAxis,c=this.yAxis;if(a.inverted)b=c,c=this.xAxis;return{translateX:b?b.left:a.plotLeft,translateY:c?c.top:a.plotTop,scaleX:1,scaleY:1}},render:function(){var a=this,b=a.chart,c,d=a.options,e=!!a.animate&&b.renderer.isSVG&&
hb(d.animation).duration,f=a.visible?"inherit":"hidden",g=d.zIndex,h=a.hasRendered,i=b.seriesGroup;c=a.plotGroup("group","series",f,g,i);a.markerGroup=a.plotGroup("markerGroup","markers",f,g,i);e&&a.animate(!0);a.getAttribs();c.inverted=a.isCartesian?b.inverted:!1;a.drawGraph&&(a.drawGraph(),a.applyZones());n(a.points,function(a){a.redraw&&a.redraw()});a.drawDataLabels&&a.drawDataLabels();a.visible&&a.drawPoints();a.drawTracker&&a.options.enableMouseTracking!==!1&&a.drawTracker();b.inverted&&a.invertGroups();
d.clip!==!1&&!a.sharedClipKey&&!h&&c.clip(b.clipRect);e&&a.animate();if(!h)a.animationTimeout=$a(function(){a.afterAnimate()},e);a.isDirty=a.isDirtyData=!1;a.hasRendered=!0},redraw:function(){var a=this.chart,b=this.isDirtyData,c=this.isDirty,d=this.group,e=this.xAxis,f=this.yAxis;d&&(a.inverted&&d.attr({width:a.plotWidth,height:a.plotHeight}),d.animate({translateX:q(e&&e.left,a.plotLeft),translateY:q(f&&f.top,a.plotTop)}));this.translate();this.render();b&&M(this,"updatedData");(c||b)&&delete this.kdTree},
kdDimensions:1,kdAxisArray:["clientX","plotY"],searchPoint:function(a,b){var c=this.xAxis,d=this.yAxis,e=this.chart.inverted;return this.searchKDTree({clientX:e?c.len-a.chartY+c.pos:a.chartX-c.pos,plotY:e?d.len-a.chartX+d.pos:a.chartY-d.pos},b)},buildKDTree:function(){function a(c,e,f){var g,h;if(h=c&&c.length)return g=b.kdAxisArray[e%f],c.sort(function(a,b){return a[g]-b[g]}),h=Math.floor(h/2),{point:c[h],left:a(c.slice(0,h),e+1,f),right:a(c.slice(h+1),e+1,f)}}var b=this,c=b.kdDimensions;delete b.kdTree;
$a(function(){b.kdTree=a(b.getValidPoints(null,!b.directTouch),c,c)},b.options.kdNow?0:1)},searchKDTree:function(a,b){function c(a,b,j,k){var l=b.point,m=d.kdAxisArray[j%k],o,p,r=l;p=s(a[e])&&s(l[e])?Math.pow(a[e]-l[e],2):null;o=s(a[f])&&s(l[f])?Math.pow(a[f]-l[f],2):null;o=(p||0)+(o||0);l.dist=s(o)?Math.sqrt(o):Number.MAX_VALUE;l.distX=s(p)?Math.sqrt(p):Number.MAX_VALUE;m=a[m]-l[m];o=m<0?"left":"right";p=m<0?"right":"left";b[o]&&(o=c(a,b[o],j+1,k),r=o[g]<r[g]?o:l);b[p]&&Math.sqrt(m*m)<r[g]&&(a=c(a,
b[p],j+1,k),r=a[g]<r[g]?a:r);return r}var d=this,e=this.kdAxisArray[0],f=this.kdAxisArray[1],g=b?"distX":"dist";this.kdTree||this.buildKDTree();if(this.kdTree)return c(a,this.kdTree,this.kdDimensions,this.kdDimensions)}};Tb.prototype={destroy:function(){Pa(this,this.axis)},render:function(a){var b=this.options,c=b.format,c=c?La(c,this):b.formatter.call(this);this.label?this.label.attr({text:c,visibility:"hidden"}):this.label=this.axis.chart.renderer.text(c,null,null,b.useHTML).css(b.style).attr({align:this.textAlign,
rotation:b.rotation,visibility:"hidden"}).add(a)},setOffset:function(a,b){var c=this.axis,d=c.chart,e=d.inverted,f=c.reversed,f=this.isNegative&&!f||!this.isNegative&&f,g=c.translate(c.usePercentage?100:this.total,0,0,0,1),c=c.translate(0),c=S(g-c),h=d.xAxis[0].translate(this.x)+a,i=d.plotHeight,f={x:e?f?g:g-c:h,y:e?i-h-b:f?i-g-c:i-g,width:e?c:b,height:e?b:c};if(e=this.label)e.align(this.alignOptions,null,f),f=e.alignAttr,e[this.options.crop===!1||d.isInsidePlot(f.x,f.y)?"show":"hide"](!0)}};Ca.prototype.getStacks=
function(){var a=this;n(a.yAxis,function(a){if(a.stacks&&a.hasVisibleSeries)a.oldStacks=a.stacks});n(a.series,function(b){if(b.options.stacking&&(b.visible===!0||a.options.chart.ignoreHiddenSeries===!1))b.stackKey=b.type+q(b.options.stack,"")})};I.prototype.buildStacks=function(){var a=this.series,b,c=q(this.options.reversedStacks,!0),d=a.length,e;if(!this.isXAxis){this.usePercentage=!1;for(e=d;e--;)a[c?e:d-e-1].setStackedPoints();for(e=d;e--;)b=a[c?e:d-e-1],b.setStackCliffs&&b.setStackCliffs();if(this.usePercentage)for(e=
0;e<d;e++)a[e].setPercentStacks()}};I.prototype.renderStackTotals=function(){var a=this.chart,b=a.renderer,c=this.stacks,d,e,f=this.stackTotalGroup;if(!f)this.stackTotalGroup=f=b.g("stack-labels").attr({visibility:"visible",zIndex:6}).add();f.translate(a.plotLeft,a.plotTop);for(d in c)for(e in a=c[d],a)a[e].render(f)};I.prototype.resetStacks=function(){var a=this.stacks,b,c;if(!this.isXAxis)for(b in a)for(c in a[b])a[b][c].touched<this.stacksTouched?(a[b][c].destroy(),delete a[b][c]):(a[b][c].total=
null,a[b][c].cum=0)};I.prototype.cleanStacks=function(){var a,b,c;if(!this.isXAxis){if(this.oldStacks)a=this.stacks=this.oldStacks;for(b in a)for(c in a[b])a[b][c].cum=a[b][c].total}};Q.prototype.setStackedPoints=function(){if(this.options.stacking&&!(this.visible!==!0&&this.chart.options.chart.ignoreHiddenSeries!==!1)){var a=this.processedXData,b=this.processedYData,c=[],d=b.length,e=this.options,f=e.threshold,g=e.startFromThreshold?f:0,h=e.stack,e=e.stacking,i=this.stackKey,j="-"+i,k=this.negStacks,
l=this.yAxis,m=l.stacks,o=l.oldStacks,p,r,n,P,u,w,s;l.stacksTouched+=1;for(u=0;u<d;u++){w=a[u];s=b[u];p=this.getStackIndicator(p,w,this.index);P=p.key;n=(r=k&&s<(g?0:f))?j:i;m[n]||(m[n]={});if(!m[n][w])o[n]&&o[n][w]?(m[n][w]=o[n][w],m[n][w].total=null):m[n][w]=new Tb(l,l.options.stackLabels,r,w,h);n=m[n][w];if(s!==null)n.points[P]=n.points[this.index]=[q(n.cum,g)],n.touched=l.stacksTouched,p.index>0&&this.singleStacks===!1&&(n.points[P][0]=n.points[this.index+","+w+",0"][0]);e==="percent"?(r=r?i:
j,k&&m[r]&&m[r][w]?(r=m[r][w],n.total=r.total=v(r.total,n.total)+S(s)||0):n.total=na(n.total+(S(s)||0))):n.total=na(n.total+(s||0));n.cum=q(n.cum,g)+(s||0);if(s!==null)n.points[P].push(n.cum),c[u]=n.cum}if(e==="percent")l.usePercentage=!0;this.stackedYData=c;l.oldStacks={}}};Q.prototype.setPercentStacks=function(){var a=this,b=a.stackKey,c=a.yAxis.stacks,d=a.processedXData,e;n([b,"-"+b],function(b){var f;for(var g=d.length,h,i;g--;)if(h=d[g],e=a.getStackIndicator(e,h,a.index),f=(i=c[b]&&c[b][h])&&
i.points[e.key],h=f)i=i.total?100/i.total:0,h[0]=na(h[0]*i),h[1]=na(h[1]*i),a.stackedYData[g]=h[1]})};Q.prototype.getStackIndicator=function(a,b,c){!s(a)||a.x!==b?a={x:b,index:0}:a.index++;a.key=[c,b,a.index].join(",");return a};x(Ca.prototype,{addSeries:function(a,b,c){var d,e=this;a&&(b=q(b,!0),M(e,"addSeries",{options:a},function(){d=e.initSeries(a);e.isDirtyLegend=!0;e.linkSeries();b&&e.redraw(c)}));return d},addAxis:function(a,b,c,d){var e=b?"xAxis":"yAxis",f=this.options,a=C(a,{index:this[e].length,
isX:b});new I(this,a);f[e]=va(f[e]||{});f[e].push(a);q(c,!0)&&this.redraw(d)},showLoading:function(a){var b=this,c=b.options,d=b.loadingDiv,e=c.loading,f=function(){d&&F(d,{left:b.plotLeft+"px",top:b.plotTop+"px",width:b.plotWidth+"px",height:b.plotHeight+"px"})};if(!d)b.loadingDiv=d=ea(Wa,{className:"highcharts-loading"},x(e.style,{zIndex:10,display:"none"}),b.container),b.loadingSpan=ea("span",null,e.labelStyle,d),D(b,"redraw",f);b.loadingSpan.innerHTML=a||c.lang.loading;if(!b.loadingShown)F(d,
{opacity:0,display:""}),eb(d,{opacity:e.style.opacity},{duration:e.showDuration||0}),b.loadingShown=!0;f()},hideLoading:function(){var a=this.options,b=this.loadingDiv;b&&eb(b,{opacity:0},{duration:a.loading.hideDuration||100,complete:function(){F(b,{display:"none"})}});this.loadingShown=!1}});x(Ha.prototype,{update:function(a,b,c,d){function e(){f.applyOptions(a);if(f.y===null&&h)f.graphic=h.destroy();if(da(a)&&!Ja(a))f.redraw=function(){if(h&&h.element&&a&&a.marker&&a.marker.symbol)f.graphic=h.destroy();
if(a&&a.dataLabels&&f.dataLabel)f.dataLabel=f.dataLabel.destroy();f.redraw=null};i=f.index;g.updateParallelArrays(f,i);if(l&&f.name)l[f.x]=f.name;k.data[i]=da(k.data[i])&&!Ja(k.data[i])?f.options:a;g.isDirty=g.isDirtyData=!0;if(!g.fixedBox&&g.hasCartesianSeries)j.isDirtyBox=!0;if(k.legendType==="point")j.isDirtyLegend=!0;b&&j.redraw(c)}var f=this,g=f.series,h=f.graphic,i,j=g.chart,k=g.options,l=g.xAxis&&g.xAxis.names,b=q(b,!0);d===!1?e():f.firePointEvent("update",{options:a},e)},remove:function(a,
b){this.series.removePoint(sa(this,this.series.data),a,b)}});x(Q.prototype,{addPoint:function(a,b,c,d){var e=this,f=e.options,g=e.data,h=e.graph,i=e.area,j=e.chart,k=e.xAxis&&e.xAxis.names,l=h&&h.shift||0,m=["graph","area"],h=f.data,o,p=e.xData;ab(d,j);if(c){for(d=e.zones.length;d--;)m.push("zoneGraph"+d,"zoneArea"+d);n(m,function(a){if(e[a])e[a].shift=l+(f.step?2:1)})}if(i)i.isArea=!0;b=q(b,!0);i={series:e};e.pointClass.prototype.applyOptions.apply(i,[a]);m=i.x;d=p.length;if(e.requireSorting&&m<
p[d-1])for(o=!0;d&&p[d-1]>m;)d--;e.updateParallelArrays(i,"splice",d,0,0);e.updateParallelArrays(i,d);if(k&&i.name)k[m]=i.name;h.splice(d,0,a);o&&(e.data.splice(d,0,null),e.processData());f.legendType==="point"&&e.generatePoints();c&&(g[0]&&g[0].remove?g[0].remove(!1):(g.shift(),e.updateParallelArrays(i,"shift"),h.shift()));e.isDirty=!0;e.isDirtyData=!0;b&&(e.getAttribs(),j.redraw())},removePoint:function(a,b,c){var d=this,e=d.data,f=e[a],g=d.points,h=d.chart,i=function(){g&&g.length===e.length&&
g.splice(a,1);e.splice(a,1);d.options.data.splice(a,1);d.updateParallelArrays(f||{series:d},"splice",a,1);f&&f.destroy();d.isDirty=!0;d.isDirtyData=!0;b&&h.redraw()};ab(c,h);b=q(b,!0);f?f.firePointEvent("remove",null,i):i()},remove:function(a,b){var c=this,d=c.chart;M(c,"remove",null,function(){c.destroy();d.isDirtyLegend=d.isDirtyBox=!0;d.linkSeries();q(a,!0)&&d.redraw(b)})},update:function(a,b){var c=this,d=this.chart,e=this.userOptions,f=this.type,g=K[f].prototype,h=["group","markerGroup","dataLabelsGroup"],
i;if(a.type&&a.type!==f||a.zIndex!==void 0)h.length=0;n(h,function(a){h[a]=c[a];delete c[a]});a=C(e,{animation:!1,index:this.index,pointStart:this.xData[0]},{data:this.options.data},a);this.remove(!1);for(i in g)this[i]=t;x(this,K[a.type||f].prototype);n(h,function(a){c[a]=h[a]});this.init(d,a);d.linkSeries();q(b,!0)&&d.redraw(!1)}});x(I.prototype,{update:function(a,b){var c=this.chart,a=c.options[this.coll][this.options.index]=C(this.userOptions,a);this.destroy(!0);this._addedPlotLB=this.chart._labelPanes=
t;this.init(c,x(a,{events:t}));c.isDirtyBox=!0;q(b,!0)&&c.redraw()},remove:function(a){for(var b=this.chart,c=this.coll,d=this.series,e=d.length;e--;)d[e]&&d[e].remove(!1);Aa(b.axes,this);Aa(b[c],this);b.options[c].splice(this.options.index,1);n(b[c],function(a,b){a.options.index=b});this.destroy();b.isDirtyBox=!0;q(a,!0)&&b.redraw()},setTitle:function(a,b){this.update({title:a},b)},setCategories:function(a,b){this.update({categories:a},b)}});var Ia=la(Q);K.line=Ia;W.area=C(ca,{softThreshold:!1,threshold:0});
var za=la(Q,{type:"area",singleStacks:!1,getStackPoints:function(){var a=[],b=[],c=this.xAxis,d=this.yAxis,e=d.stacks[this.stackKey],f={},g=this.points,h=this.index,i=d.series,j=i.length,k,l=q(d.options.reversedStacks,!0)?1:-1,m,o;if(this.options.stacking){for(m=0;m<g.length;m++)f[g[m].x]=g[m];for(o in e)e[o].total!==null&&b.push(o);b.sort(function(a,b){return a-b});k=ta(i,function(){return this.visible});n(b,function(g,i){var o=0,q,u;if(f[g]&&!f[g].isNull)a.push(f[g]),n([-1,1],function(a){var c=
a===1?"rightNull":"leftNull",d=0,o=e[b[i+a]];if(o)for(m=h;m>=0&&m<j;)q=o.points[m],q||(m===h?f[g][c]=!0:k[m]&&(u=e[g].points[m])&&(d-=u[1]-u[0])),m+=l;f[g][a===1?"rightCliff":"leftCliff"]=d});else{for(m=h;m>=0&&m<j;){if(q=e[g].points[m]){o=q[1];break}m+=l}o=d.toPixels(o,!0);a.push({isNull:!0,plotX:c.toPixels(g,!0),plotY:o,yBottom:o})}})}return a},getGraphPath:function(a){var b=Q.prototype.getGraphPath,c=this.options,d=c.stacking,e=this.yAxis,f,g,h=[],i=[],j=this.index,k,l=e.stacks[this.stackKey],
m=c.threshold,o=e.getThreshold(c.threshold),p,c=c.connectNulls||d==="percent",r=function(b,c,f){var g=a[b],b=d&&l[g.x].points[j],p=g[f+"Null"]||0,f=g[f+"Cliff"]||0,r,n,g=!0;f||p?(r=(p?b[0]:b[1])+f,n=b[0]+f,g=!!p):!d&&a[c]&&a[c].isNull&&(r=n=m);r!==void 0&&(i.push({plotX:k,plotY:r===null?o:e.getThreshold(r),isNull:g}),h.push({plotX:k,plotY:n===null?o:e.getThreshold(n)}))},a=a||this.points;d&&(a=this.getStackPoints());for(f=0;f<a.length;f++)if(g=a[f].isNull,k=q(a[f].rectPlotX,a[f].plotX),p=q(a[f].yBottom,
o),!g||c){c||r(f,f-1,"left");if(!g||d||!c)i.push(a[f]),h.push({x:f,plotX:k,plotY:p});c||r(f,f+1,"right")}f=b.call(this,i,!0,!0);h.reversed=!0;g=b.call(this,h,!0,!0);g.length&&(g[0]="L");f=f.concat(g);b=b.call(this,i,!1,c);this.areaPath=f;return b},drawGraph:function(){this.areaPath=[];Q.prototype.drawGraph.apply(this);var a=this,b=this.areaPath,c=this.options,d=[["area",this.color,c.fillColor]];n(this.zones,function(b,f){d.push(["zoneArea"+f,b.color||a.color,b.fillColor||c.fillColor])});n(d,function(d){var f=
d[0],g=a[f];g?g.animate({d:b}):(g={fill:d[2]||d[1],zIndex:0},d[2]||(g["fill-opacity"]=q(c.fillOpacity,0.75)),a[f]=a.chart.renderer.path(b).attr(g).add(a.group))})},drawLegendSymbol:aa.drawRectangle});K.area=za;W.spline=C(ca);Ia=la(Q,{type:"spline",getPointSpline:function(a,b,c){var d=b.plotX,e=b.plotY,f=a[c-1],c=a[c+1],g,h,i,j;if(f&&!f.isNull&&c&&!c.isNull){a=f.plotY;i=c.plotX;var c=c.plotY,k=0;g=(1.5*d+f.plotX)/2.5;h=(1.5*e+a)/2.5;i=(1.5*d+i)/2.5;j=(1.5*e+c)/2.5;i!==g&&(k=(j-h)*(i-d)/(i-g)+e-j);
h+=k;j+=k;h>a&&h>e?(h=v(a,e),j=2*e-h):h<a&&h<e&&(h=E(a,e),j=2*e-h);j>c&&j>e?(j=v(c,e),h=2*e-j):j<c&&j<e&&(j=E(c,e),h=2*e-j);b.rightContX=i;b.rightContY=j}b=["C",q(f.rightContX,f.plotX),q(f.rightContY,f.plotY),q(g,d),q(h,e),d,e];f.rightContX=f.rightContY=null;return b}});K.spline=Ia;W.areaspline=C(W.area);za=za.prototype;Ia=la(Ia,{type:"areaspline",getStackPoints:za.getStackPoints,getGraphPath:za.getGraphPath,setStackCliffs:za.setStackCliffs,drawGraph:za.drawGraph,drawLegendSymbol:aa.drawRectangle});
K.areaspline=Ia;W.column=C(ca,{borderColor:"#FFFFFF",borderRadius:0,groupPadding:0.2,marker:null,pointPadding:0.1,minPointLength:0,cropThreshold:50,pointRange:null,states:{hover:{brightness:0.1,shadow:!1,halo:!1},select:{color:"#C0C0C0",borderColor:"#000000",shadow:!1}},dataLabels:{align:null,verticalAlign:null,y:null},softThreshold:!1,startFromThreshold:!0,stickyTracking:!1,tooltip:{distance:6},threshold:0});Ia=la(Q,{type:"column",pointAttrToOptions:{stroke:"borderColor",fill:"color",r:"borderRadius"},
cropShoulder:0,directTouch:!0,trackerGroups:["group","dataLabelsGroup"],negStacks:!0,init:function(){Q.prototype.init.apply(this,arguments);var a=this,b=a.chart;b.hasRendered&&n(b.series,function(b){if(b.type===a.type)b.isDirty=!0})},getColumnMetrics:function(){var a=this,b=a.options,c=a.xAxis,d=a.yAxis,e=c.reversed,f,g={},h=0;b.grouping===!1?h=1:n(a.chart.series,function(b){var c=b.options,e=b.yAxis,i;if(b.type===a.type&&b.visible&&d.len===e.len&&d.pos===e.pos)c.stacking?(f=b.stackKey,g[f]===t&&
(g[f]=h++),i=g[f]):c.grouping!==!1&&(i=h++),b.columnIndex=i});var i=E(S(c.transA)*(c.ordinalSlope||b.pointRange||c.closestPointRange||c.tickInterval||1),c.len),j=i*b.groupPadding,k=(i-2*j)/h,b=E(b.maxPointWidth||c.len,q(b.pointWidth,k*(1-2*b.pointPadding)));a.columnMetrics={width:b,offset:(k-b)/2+(j+((a.columnIndex||0)+(e?1:0))*k-i/2)*(e?-1:1)};return a.columnMetrics},crispCol:function(a,b,c,d){var e=this.chart,f=this.borderWidth,g=-(f%2?0.5:0),f=f%2?0.5:1;e.inverted&&e.renderer.isVML&&(f+=1);c=Math.round(a+
c)+g;a=Math.round(a)+g;c-=a;d=Math.round(b+d)+f;g=S(b)<=0.5&&d>0.5;b=Math.round(b)+f;d-=b;g&&d&&(b-=1,d+=1);return{x:a,y:b,width:c,height:d}},translate:function(){var a=this,b=a.chart,c=a.options,d=a.borderWidth=q(c.borderWidth,a.closestPointRange*a.xAxis.transA<2?0:1),e=a.yAxis,f=a.translatedThreshold=e.getThreshold(c.threshold),g=q(c.minPointLength,5),h=a.getColumnMetrics(),i=h.width,j=a.barW=v(i,1+2*d),k=a.pointXOffset=h.offset;b.inverted&&(f-=0.5);c.pointPadding&&(j=Fa(j));Q.prototype.translate.apply(a);
n(a.points,function(c){var d=E(q(c.yBottom,f),9E4),h=999+S(d),h=E(v(-h,c.plotY),e.len+h),p=c.plotX+k,r=j,n=E(h,d),s,u=v(h,d)-n;S(u)<g&&g&&(u=g,s=!e.reversed&&!c.negative||e.reversed&&c.negative,n=S(n-f)>g?d-g:f-(s?g:0));c.barX=p;c.pointWidth=i;c.tooltipPos=b.inverted?[e.len+e.pos-b.plotLeft-h,a.xAxis.len-p-r/2,u]:[p+r/2,h+e.pos-b.plotTop,u];c.shapeType="rect";c.shapeArgs=a.crispCol(p,n,r,u)})},getSymbol:ra,drawLegendSymbol:aa.drawRectangle,drawGraph:ra,drawPoints:function(){var a=this,b=this.chart,
c=a.options,d=b.renderer,e=c.animationLimit||250,f,g;n(a.points,function(h){var i=h.plotY,j=h.graphic;if(i!==t&&!isNaN(i)&&h.y!==null)f=h.shapeArgs,i=s(a.borderWidth)?{"stroke-width":a.borderWidth}:{},g=h.pointAttr[h.selected?"select":""]||a.pointAttr[""],j?(Ta(j),j.attr(i).attr(g)[b.pointCount<e?"animate":"attr"](C(f))):h.graphic=d[h.shapeType](f).attr(i).attr(g).add(h.group||a.group).shadow(c.shadow,null,c.stacking&&!c.borderRadius);else if(j)h.graphic=j.destroy()})},animate:function(a){var b=this,
c=this.yAxis,d=b.options,e=this.chart.inverted,f={};if(ja)a?(f.scaleY=0.001,a=E(c.pos+c.len,v(c.pos,c.toPixels(d.threshold))),e?f.translateX=a-c.len:f.translateY=a,b.group.attr(f)):(f[e?"translateX":"translateY"]=c.pos,b.group.animate(f,x(hb(b.options.animation),{step:function(a,c){b.group.attr({scaleY:c.pos})}})),b.animate=null)},remove:function(){var a=this,b=a.chart;b.hasRendered&&n(b.series,function(b){if(b.type===a.type)b.isDirty=!0});Q.prototype.remove.apply(a,arguments)}});K.column=Ia;W.bar=
C(W.column);za=la(Ia,{type:"bar",inverted:!0});K.bar=za;W.scatter=C(ca,{lineWidth:0,marker:{enabled:!0},tooltip:{headerFormat:'<span style="color:{point.color}">\u25cf</span> <span style="font-size: 10px;"> {series.name}</span><br/>',pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>"}});za=la(Q,{type:"scatter",sorted:!1,requireSorting:!1,noSharedTooltip:!0,trackerGroups:["group","markerGroup","dataLabelsGroup"],takeOrdinalPosition:!1,kdDimensions:2,drawGraph:function(){this.options.lineWidth&&
Q.prototype.drawGraph.call(this)}});K.scatter=za;W.pie=C(ca,{borderColor:"#FFFFFF",borderWidth:1,center:[null,null],clip:!1,colorByPoint:!0,dataLabels:{distance:30,enabled:!0,formatter:function(){return this.y===null?void 0:this.point.name},x:0},ignoreHiddenPoint:!0,legendType:"point",marker:null,size:null,showInLegend:!1,slicedOffset:10,states:{hover:{brightness:0.1,shadow:!1}},stickyTracking:!1,tooltip:{followPointer:!0}});ca={type:"pie",isCartesian:!1,pointClass:la(Ha,{init:function(){Ha.prototype.init.apply(this,
arguments);var a=this,b;a.name=q(a.name,"Slice");b=function(b){a.slice(b.type==="select")};D(a,"select",b);D(a,"unselect",b);return a},setVisible:function(a,b){var c=this,d=c.series,e=d.chart,f=d.options.ignoreHiddenPoint,b=q(b,f);if(a!==c.visible){c.visible=c.options.visible=a=a===t?!c.visible:a;d.options.data[sa(c,d.data)]=c.options;n(["graphic","dataLabel","connector","shadowGroup"],function(b){if(c[b])c[b][a?"show":"hide"](!0)});c.legendItem&&e.legend.colorizeItem(c,a);!a&&c.state==="hover"&&
c.setState("");if(f)d.isDirty=!0;b&&e.redraw()}},slice:function(a,b,c){var d=this.series;ab(c,d.chart);q(b,!0);this.sliced=this.options.sliced=a=s(a)?a:!this.sliced;d.options.data[sa(this,d.data)]=this.options;a=a?this.slicedTranslation:{translateX:0,translateY:0};this.graphic.animate(a);this.shadowGroup&&this.shadowGroup.animate(a)},haloPath:function(a){var b=this.shapeArgs,c=this.series.chart;return this.sliced||!this.visible?[]:this.series.chart.renderer.symbols.arc(c.plotLeft+b.x,c.plotTop+b.y,
b.r+a,b.r+a,{innerR:this.shapeArgs.r,start:b.start,end:b.end})}}),requireSorting:!1,directTouch:!0,noSharedTooltip:!0,trackerGroups:["group","dataLabelsGroup"],axisTypes:[],pointAttrToOptions:{stroke:"borderColor","stroke-width":"borderWidth",fill:"color"},animate:function(a){var b=this,c=b.points,d=b.startAngleRad;if(!a)n(c,function(a){var c=a.graphic,g=a.shapeArgs;c&&(c.attr({r:a.startR||b.center[3]/2,start:d,end:d}),c.animate({r:g.r,start:g.start,end:g.end},b.options.animation))}),b.animate=null},
updateTotals:function(){var a,b=0,c=this.points,d=c.length,e,f=this.options.ignoreHiddenPoint;for(a=0;a<d;a++)e=c[a],b+=f&&!e.visible?0:e.y;this.total=b;for(a=0;a<d;a++)e=c[a],e.percentage=b>0&&(e.visible||!f)?e.y/b*100:0,e.total=b},generatePoints:function(){Q.prototype.generatePoints.call(this);this.updateTotals()},translate:function(a){this.generatePoints();var b=0,c=this.options,d=c.slicedOffset,e=d+c.borderWidth,f,g,h,i=c.startAngle||0,j=this.startAngleRad=Ba/180*(i-90),i=(this.endAngleRad=Ba/
180*(q(c.endAngle,i+360)-90))-j,k=this.points,l=c.dataLabels.distance,c=c.ignoreHiddenPoint,m,o=k.length,p;if(!a)this.center=a=this.getCenter();this.getX=function(b,c){h=Y.asin(E((b-a[1])/(a[2]/2+l),1));return a[0]+(c?-1:1)*ba(h)*(a[2]/2+l)};for(m=0;m<o;m++){p=k[m];f=j+b*i;if(!c||p.visible)b+=p.percentage/100;g=j+b*i;p.shapeType="arc";p.shapeArgs={x:a[0],y:a[1],r:a[2]/2,innerR:a[3]/2,start:y(f*1E3)/1E3,end:y(g*1E3)/1E3};h=(g+f)/2;h>1.5*Ba?h-=2*Ba:h<-Ba/2&&(h+=2*Ba);p.slicedTranslation={translateX:y(ba(h)*
d),translateY:y(ka(h)*d)};f=ba(h)*a[2]/2;g=ka(h)*a[2]/2;p.tooltipPos=[a[0]+f*0.7,a[1]+g*0.7];p.half=h<-Ba/2||h>Ba/2?1:0;p.angle=h;e=E(e,l/2);p.labelPos=[a[0]+f+ba(h)*l,a[1]+g+ka(h)*l,a[0]+f+ba(h)*e,a[1]+g+ka(h)*e,a[0]+f,a[1]+g,l<0?"center":p.half?"right":"left",h]}},drawGraph:null,drawPoints:function(){var a=this,b=a.chart.renderer,c,d,e=a.options.shadow,f,g,h,i;if(e&&!a.shadowGroup)a.shadowGroup=b.g("shadow").add(a.group);n(a.points,function(j){if(j.y!==null){d=j.graphic;h=j.shapeArgs;f=j.shadowGroup;
g=j.pointAttr[j.selected?"select":""];if(!g.stroke)g.stroke=g.fill;if(e&&!f)f=j.shadowGroup=b.g("shadow").add(a.shadowGroup);c=j.sliced?j.slicedTranslation:{translateX:0,translateY:0};f&&f.attr(c);if(d)d.setRadialReference(a.center).attr(g).animate(x(h,c));else{i={"stroke-linejoin":"round"};if(!j.visible)i.visibility="hidden";j.graphic=d=b[j.shapeType](h).setRadialReference(a.center).attr(g).attr(i).attr(c).add(a.group).shadow(e,f)}}})},searchPoint:ra,sortByAngle:function(a,b){a.sort(function(a,d){return a.angle!==
void 0&&(d.angle-a.angle)*b})},drawLegendSymbol:aa.drawRectangle,getCenter:bc.getCenter,getSymbol:ra};ca=la(Q,ca);K.pie=ca;Q.prototype.drawDataLabels=function(){var a=this,b=a.options,c=b.cursor,d=b.dataLabels,e=a.points,f,g,h=a.hasRendered||0,i,j,k=q(d.defer,!0),l=a.chart.renderer;if(d.enabled||a._hasPointLabels)a.dlProcessOptions&&a.dlProcessOptions(d),j=a.plotGroup("dataLabelsGroup","data-labels",k&&!h?"hidden":"visible",d.zIndex||6),k&&(j.attr({opacity:+h}),h||D(a,"afterAnimate",function(){a.visible&&
j.show();j[b.animation?"animate":"attr"]({opacity:1},{duration:200})})),g=d,n(e,function(e){var h,k=e.dataLabel,r,n,P=e.connector,u=!0,w,v={};f=e.dlOptions||e.options&&e.options.dataLabels;h=q(f&&f.enabled,g.enabled)&&e.y!==null;if(k&&!h)e.dataLabel=k.destroy();else if(h){d=C(g,f);w=d.style;h=d.rotation;r=e.getLabelConfig();i=d.format?La(d.format,r):d.formatter.call(r,d);w.color=q(d.color,w.color,a.color,"black");if(k)if(s(i))k.attr({text:i}),u=!1;else{if(e.dataLabel=k=k.destroy(),P)e.connector=P.destroy()}else if(s(i)){k=
{fill:d.backgroundColor,stroke:d.borderColor,"stroke-width":d.borderWidth,r:d.borderRadius||0,rotation:h,padding:d.padding,zIndex:1};if(w.color==="contrast")v.color=d.inside||d.distance<0||b.stacking?l.getContrast(e.color||a.color):"#000000";if(c)v.cursor=c;for(n in k)k[n]===t&&delete k[n];k=e.dataLabel=l[h?"text":"label"](i,0,-9999,d.shape,null,null,d.useHTML).attr(k).css(x(w,v)).add(j).shadow(d.shadow)}k&&a.alignDataLabel(e,k,d,null,u)}})};Q.prototype.alignDataLabel=function(a,b,c,d,e){var f=this.chart,
g=f.inverted,h=q(a.plotX,-9999),i=q(a.plotY,-9999),j=b.getBBox(),k=f.renderer.fontMetrics(c.style.fontSize).b,l=c.rotation,m=c.align,o=this.visible&&(a.series.forceDL||f.isInsidePlot(h,y(i),g)||d&&f.isInsidePlot(h,g?d.x+1:d.y+d.height-1,g)),p=q(c.overflow,"justify")==="justify";if(o)d=x({x:g?f.plotWidth-i:h,y:y(g?f.plotHeight-h:i),width:0,height:0},d),x(c,{width:j.width,height:j.height}),l?(p=!1,g=f.renderer.rotCorr(k,l),g={x:d.x+c.x+d.width/2+g.x,y:d.y+c.y+d.height/2},b[e?"attr":"animate"](g).attr({align:c.align}),
h=(l+720)%360,h=h>180&&h<360,m==="left"?g.y-=h?j.height:0:m==="center"?(g.x-=j.width/2,g.y-=j.height/2):m==="right"&&(g.x-=j.width,g.y-=h?0:j.height)):(b.align(c,null,d),g=b.alignAttr),p?this.justifyDataLabel(b,c,g,j,d,e):q(c.crop,!0)&&(o=f.isInsidePlot(g.x,g.y)&&f.isInsidePlot(g.x+j.width,g.y+j.height)),c.shape&&!l&&b.attr({anchorX:a.plotX,anchorY:a.plotY});if(!o)Ta(b),b.attr({y:-9999}),b.placed=!1};Q.prototype.justifyDataLabel=function(a,b,c,d,e,f){var g=this.chart,h=b.align,i=b.verticalAlign,j,
k,l=a.box?0:a.padding||0;j=c.x+l;if(j<0)h==="right"?b.align="left":b.x=-j,k=!0;j=c.x+d.width-l;if(j>g.plotWidth)h==="left"?b.align="right":b.x=g.plotWidth-j,k=!0;j=c.y+l;if(j<0)i==="bottom"?b.verticalAlign="top":b.y=-j,k=!0;j=c.y+d.height-l;if(j>g.plotHeight)i==="top"?b.verticalAlign="bottom":b.y=g.plotHeight-j,k=!0;if(k)a.placed=!f,a.align(b,null,e)};if(K.pie)K.pie.prototype.drawDataLabels=function(){var a=this,b=a.data,c,d=a.chart,e=a.options.dataLabels,f=q(e.connectorPadding,10),g=q(e.connectorWidth,
1),h=d.plotWidth,i=d.plotHeight,j,k,l=q(e.softConnector,!0),m=e.distance,o=a.center,p=o[2]/2,r=o[1],A=m>0,s,u,w,t=[[],[]],x,z,C,B,L,D=[0,0,0,0],J=function(a,b){return b.y-a.y};if(a.visible&&(e.enabled||a._hasPointLabels)){Q.prototype.drawDataLabels.apply(a);n(b,function(a){if(a.dataLabel&&a.visible)t[a.half].push(a),a.dataLabel._pos=null});for(B=2;B--;){var G=[],K=[],I=t[B],F=I.length,H;if(F){a.sortByAngle(I,B-0.5);for(L=b=0;!b&&I[L];)b=I[L]&&I[L].dataLabel&&(I[L].dataLabel.getBBox().height||21),
L++;if(m>0){u=E(r+p+m,d.plotHeight);for(L=v(0,r-p-m);L<=u;L+=b)G.push(L);u=G.length;if(F>u){c=[].concat(I);c.sort(J);for(L=F;L--;)c[L].rank=L;for(L=F;L--;)I[L].rank>=u&&I.splice(L,1);F=I.length}for(L=0;L<F;L++){c=I[L];w=c.labelPos;c=9999;var M,N;for(N=0;N<u;N++)M=S(G[N]-w[1]),M<c&&(c=M,H=N);if(H<L&&G[L]!==null)H=L;else for(u<F-L+H&&G[L]!==null&&(H=u-F+L);G[H]===null;)H++;K.push({i:H,y:G[H]});G[H]=null}K.sort(J)}for(L=0;L<F;L++){c=I[L];w=c.labelPos;s=c.dataLabel;C=c.visible===!1?"hidden":"inherit";
c=w[1];if(m>0){if(u=K.pop(),H=u.i,z=u.y,c>z&&G[H+1]!==null||c<z&&G[H-1]!==null)z=E(v(0,c),d.plotHeight)}else z=c;x=e.justify?o[0]+(B?-1:1)*(p+m):a.getX(z===r-p-m||z===r+p+m?c:z,B);s._attr={visibility:C,align:w[6]};s._pos={x:x+e.x+({left:f,right:-f}[w[6]]||0),y:z+e.y-10};s.connX=x;s.connY=z;if(this.options.size===null)u=s.width,x-u<f?D[3]=v(y(u-x+f),D[3]):x+u>h-f&&(D[1]=v(y(x+u-h+f),D[1])),z-b/2<0?D[0]=v(y(-z+b/2),D[0]):z+b/2>i&&(D[2]=v(y(z+b/2-i),D[2]))}}}if(Ea(D)===0||this.verifyDataLabelOverflow(D))this.placeDataLabels(),
A&&g&&n(this.points,function(b){j=b.connector;w=b.labelPos;if((s=b.dataLabel)&&s._pos&&b.visible)C=s._attr.visibility,x=s.connX,z=s.connY,k=l?["M",x+(w[6]==="left"?5:-5),z,"C",x,z,2*w[2]-w[4],2*w[3]-w[5],w[2],w[3],"L",w[4],w[5]]:["M",x+(w[6]==="left"?5:-5),z,"L",w[2],w[3],"L",w[4],w[5]],j?(j.animate({d:k}),j.attr("visibility",C)):b.connector=j=a.chart.renderer.path(k).attr({"stroke-width":g,stroke:e.connectorColor||b.color||"#606060",visibility:C}).add(a.dataLabelsGroup);else if(j)b.connector=j.destroy()})}},
K.pie.prototype.placeDataLabels=function(){n(this.points,function(a){var b=a.dataLabel;if(b&&a.visible)(a=b._pos)?(b.attr(b._attr),b[b.moved?"animate":"attr"](a),b.moved=!0):b&&b.attr({y:-9999})})},K.pie.prototype.alignDataLabel=ra,K.pie.prototype.verifyDataLabelOverflow=function(a){var b=this.center,c=this.options,d=c.center,e=c.minSize||80,f=e,g;d[0]!==null?f=v(b[2]-v(a[1],a[3]),e):(f=v(b[2]-a[1]-a[3],e),b[0]+=(a[3]-a[1])/2);d[1]!==null?f=v(E(f,b[2]-v(a[0],a[2])),e):(f=v(E(f,b[2]-a[0]-a[2]),e),
b[1]+=(a[0]-a[2])/2);f<b[2]?(b[2]=f,b[3]=Math.min(/%$/.test(c.innerSize||0)?f*parseFloat(c.innerSize||0)/100:parseFloat(c.innerSize||0),f),this.translate(b),this.drawDataLabels&&this.drawDataLabels()):g=!0;return g};if(K.column)K.column.prototype.alignDataLabel=function(a,b,c,d,e){var f=this.chart.inverted,g=a.series,h=a.dlBox||a.shapeArgs,i=q(a.below,a.plotY>q(this.translatedThreshold,g.yAxis.len)),j=q(c.inside,!!this.options.stacking);if(h){d=C(h);if(d.y<0)d.height+=d.y,d.y=0;h=d.y+d.height-g.yAxis.len;
h>0&&(d.height-=h);f&&(d={x:g.yAxis.len-d.y-d.height,y:g.xAxis.len-d.x-d.width,width:d.height,height:d.width});if(!j)f?(d.x+=i?0:d.width,d.width=0):(d.y+=i?d.height:0,d.height=0)}c.align=q(c.align,!f||j?"center":i?"right":"left");c.verticalAlign=q(c.verticalAlign,f||j?"middle":i?"top":"bottom");Q.prototype.alignDataLabel.call(this,a,b,c,d,e)};(function(a){var b=a.Chart,c=a.each,d=a.pick,e=a.addEvent;b.prototype.callbacks.push(function(a){function b(){var e=[];c(a.series,function(a){var b=a.options.dataLabels,
f=a.dataLabelCollections||["dataLabel"];(b.enabled||a._hasPointLabels)&&!b.allowOverlap&&a.visible&&c(f,function(b){c(a.points,function(a){if(a[b])a[b].labelrank=d(a.labelrank,a.shapeArgs&&a.shapeArgs.height),e.push(a[b])})})});a.hideOverlappingLabels(e)}b();e(a,"redraw",b)});b.prototype.hideOverlappingLabels=function(a){var b=a.length,d,e,j,k,l,m,o,p,n;for(e=0;e<b;e++)if(d=a[e])d.oldOpacity=d.opacity,d.newOpacity=1;a.sort(function(a,b){return(b.labelrank||0)-(a.labelrank||0)});for(e=0;e<b;e++){j=
a[e];for(d=e+1;d<b;++d)if(k=a[d],j&&k&&j.placed&&k.placed&&j.newOpacity!==0&&k.newOpacity!==0&&(l=j.alignAttr,m=k.alignAttr,o=j.parentGroup,p=k.parentGroup,n=2*(j.box?0:j.padding),l=!(m.x+p.translateX>l.x+o.translateX+(j.width-n)||m.x+p.translateX+(k.width-n)<l.x+o.translateX||m.y+p.translateY>l.y+o.translateY+(j.height-n)||m.y+p.translateY+(k.height-n)<l.y+o.translateY)))(j.labelrank<k.labelrank?j:k).newOpacity=0}c(a,function(a){var b,c;if(a){c=a.newOpacity;if(a.oldOpacity!==c&&a.placed)c?a.show(!0):
b=function(){a.hide()},a.alignAttr.opacity=c,a[a.isOld?"animate":"attr"](a.alignAttr,null,b);a.isOld=!0}})}})(z);var nb=z.TrackerMixin={drawTrackerPoint:function(){var a=this,b=a.chart,c=b.pointer,d=a.options.cursor,e=d&&{cursor:d},f=function(a){for(var c=a.target,d;c&&!d;)d=c.point,c=c.parentNode;if(d!==t&&d!==b.hoverPoint)d.onMouseOver(a)};n(a.points,function(a){if(a.graphic)a.graphic.element.point=a;if(a.dataLabel)a.dataLabel.element.point=a});if(!a._hasTracking)n(a.trackerGroups,function(b){if(a[b]&&
(a[b].addClass("highcharts-tracker").on("mouseover",f).on("mouseout",function(a){c.onTrackerMouseOut(a)}).css(e),db))a[b].on("touchstart",f)}),a._hasTracking=!0},drawTrackerGraph:function(){var a=this,b=a.options,c=b.trackByArea,d=[].concat(c?a.areaPath:a.graphPath),e=d.length,f=a.chart,g=f.pointer,h=f.renderer,i=f.options.tooltip.snap,j=a.tracker,k=b.cursor,l=k&&{cursor:k},m=function(){if(f.hoverSeries!==a)a.onMouseOver()},o="rgba(192,192,192,"+(ja?1.0E-4:0.002)+")";if(e&&!c)for(k=e+1;k--;)d[k]===
"M"&&d.splice(k+1,0,d[k+1]-i,d[k+2],"L"),(k&&d[k]==="M"||k===e)&&d.splice(k,0,"L",d[k-2]+i,d[k-1]);j?j.attr({d:d}):(a.tracker=h.path(d).attr({"stroke-linejoin":"round",visibility:a.visible?"visible":"hidden",stroke:o,fill:c?o:"none","stroke-width":b.lineWidth+(c?0:2*i),zIndex:2}).add(a.group),n([a.tracker,a.markerGroup],function(a){a.addClass("highcharts-tracker").on("mouseover",m).on("mouseout",function(a){g.onTrackerMouseOut(a)}).css(l);if(db)a.on("touchstart",m)}))}};if(K.column)Ia.prototype.drawTracker=
nb.drawTrackerPoint;if(K.pie)K.pie.prototype.drawTracker=nb.drawTrackerPoint;if(K.scatter)za.prototype.drawTracker=nb.drawTrackerPoint;x(vb.prototype,{setItemEvents:function(a,b,c,d,e){var f=this;(c?b:a.legendGroup).on("mouseover",function(){a.setState("hover");b.css(f.options.itemHoverStyle)}).on("mouseout",function(){b.css(a.visible?d:e);a.setState()}).on("click",function(b){var c=function(){a.setVisible&&a.setVisible()},b={browserEvent:b};a.firePointEvent?a.firePointEvent("legendItemClick",b,c):
M(a,"legendItemClick",b,c)})},createCheckboxForItem:function(a){a.checkbox=ea("input",{type:"checkbox",checked:a.selected,defaultChecked:a.selected},this.options.itemCheckboxStyle,this.chart.container);D(a.checkbox,"click",function(b){M(a.series||a,"checkboxClick",{checked:b.target.checked,item:a},function(){a.select()})})}});N.legend.itemStyle.cursor="pointer";x(Ca.prototype,{showResetZoom:function(){var a=this,b=N.lang,c=a.options.chart.resetZoomButton,d=c.theme,e=d.states,f=c.relativeTo==="chart"?
null:"plotBox";this.resetZoomButton=a.renderer.button(b.resetZoom,null,null,function(){a.zoomOut()},d,e&&e.hover).attr({align:c.position.align,title:b.resetZoomTitle}).add().align(c.position,!1,f)},zoomOut:function(){var a=this;M(a,"selection",{resetSelection:!0},function(){a.zoom()})},zoom:function(a){var b,c=this.pointer,d=!1,e;!a||a.resetSelection?n(this.axes,function(a){b=a.zoom()}):n(a.xAxis.concat(a.yAxis),function(a){var e=a.axis,h=e.isXAxis;if(c[h?"zoomX":"zoomY"]||c[h?"pinchX":"pinchY"])b=
e.zoom(a.min,a.max),e.displayBtn&&(d=!0)});e=this.resetZoomButton;if(d&&!e)this.showResetZoom();else if(!d&&da(e))this.resetZoomButton=e.destroy();b&&this.redraw(q(this.options.chart.animation,a&&a.animation,this.pointCount<100))},pan:function(a,b){var c=this,d=c.hoverPoints,e;d&&n(d,function(a){a.setState()});n(b==="xy"?[1,0]:[1],function(b){var b=c[b?"xAxis":"yAxis"][0],d=b.horiz,h=a[d?"chartX":"chartY"],d=d?"mouseDownX":"mouseDownY",i=c[d],j=(b.pointRange||0)/2,k=b.getExtremes(),l=b.toValue(i-
h,!0)+j,j=b.toValue(i+b.len-h,!0)-j,i=i>h;if(b.series.length&&(i||l>E(k.dataMin,k.min))&&(!i||j<v(k.dataMax,k.max)))b.setExtremes(l,j,!1,!1,{trigger:"pan"}),e=!0;c[d]=h});e&&c.redraw(!1);F(c.container,{cursor:"move"})}});x(Ha.prototype,{select:function(a,b){var c=this,d=c.series,e=d.chart,a=q(a,!c.selected);c.firePointEvent(a?"select":"unselect",{accumulate:b},function(){c.selected=c.options.selected=a;d.options.data[sa(c,d.data)]=c.options;c.setState(a&&"select");b||n(e.getSelectedPoints(),function(a){if(a.selected&&
a!==c)a.selected=a.options.selected=!1,d.options.data[sa(a,d.data)]=a.options,a.setState(""),a.firePointEvent("unselect")})})},onMouseOver:function(a,b){var c=this.series,d=c.chart,e=d.tooltip,f=d.hoverPoint;if(d.hoverSeries!==c)c.onMouseOver();if(f&&f!==this)f.onMouseOut();if(this.series&&(this.firePointEvent("mouseOver"),e&&(!e.shared||c.noSharedTooltip)&&e.refresh(this,a),this.setState("hover"),!b))d.hoverPoint=this},onMouseOut:function(){var a=this.series.chart,b=a.hoverPoints;this.firePointEvent("mouseOut");
if(!b||sa(this,b)===-1)this.setState(),a.hoverPoint=null},importEvents:function(){if(!this.hasImportedEvents){var a=C(this.series.options.point,this.options).events,b;this.events=a;for(b in a)D(this,b,a[b]);this.hasImportedEvents=!0}},setState:function(a,b){var c=V(this.plotX),d=this.plotY,e=this.series,f=e.options.states,g=W[e.type].marker&&e.options.marker,h=g&&!g.enabled,i=g&&g.states[a],j=i&&i.enabled===!1,k=e.stateMarkerGraphic,l=this.marker||{},m=e.chart,o=e.halo,p,a=a||"";p=this.pointAttr[a]||
e.pointAttr[a];if(!(a===this.state&&!b||this.selected&&a!=="select"||f[a]&&f[a].enabled===!1||a&&(j||h&&i.enabled===!1)||a&&l.states&&l.states[a]&&l.states[a].enabled===!1)){if(this.graphic)g=g&&this.graphic.symbolName&&p.r,this.graphic.attr(C(p,g?{x:c-g,y:d-g,width:2*g,height:2*g}:{})),k&&k.hide();else{if(a&&i)if(g=i.radius,l=l.symbol||e.symbol,k&&k.currentSymbol!==l&&(k=k.destroy()),k)k[b?"animate":"attr"]({x:c-g,y:d-g});else if(l)e.stateMarkerGraphic=k=m.renderer.symbol(l,c-g,d-g,2*g,2*g).attr(p).add(e.markerGroup),
k.currentSymbol=l;if(k)k[a&&m.isInsidePlot(c,d,m.inverted)?"show":"hide"](),k.element.point=this}if((c=f[a]&&f[a].halo)&&c.size){if(!o)e.halo=o=m.renderer.path().add(m.seriesGroup);o.attr(x({fill:this.color||e.color,"fill-opacity":c.opacity,zIndex:-1},c.attributes))[b?"animate":"attr"]({d:this.haloPath(c.size)})}else o&&o.attr({d:[]});this.state=a}},haloPath:function(a){var b=this.series,c=b.chart,d=b.getPlotBox(),e=c.inverted,f=Math.floor(this.plotX);return c.renderer.symbols.circle(d.translateX+
(e?b.yAxis.len-this.plotY:f)-a,d.translateY+(e?b.xAxis.len-f:this.plotY)-a,a*2,a*2)}});x(Q.prototype,{onMouseOver:function(){var a=this.chart,b=a.hoverSeries;if(b&&b!==this)b.onMouseOut();this.options.events.mouseOver&&M(this,"mouseOver");this.setState("hover");a.hoverSeries=this},onMouseOut:function(){var a=this.options,b=this.chart,c=b.tooltip,d=b.hoverPoint;b.hoverSeries=null;if(d)d.onMouseOut();this&&a.events.mouseOut&&M(this,"mouseOut");c&&!a.stickyTracking&&(!c.shared||this.noSharedTooltip)&&
c.hide();this.setState()},setState:function(a){var b=this.options,c=this.graph,d=b.states,e=b.lineWidth,b=0,a=a||"";if(this.state!==a&&(this.state=a,!(d[a]&&d[a].enabled===!1)&&(a&&(e=d[a].lineWidth||e+(d[a].lineWidthPlus||0)),c&&!c.dashstyle))){a={"stroke-width":e};for(c.attr(a);this["zoneGraph"+b];)this["zoneGraph"+b].attr(a),b+=1}},setVisible:function(a,b){var c=this,d=c.chart,e=c.legendItem,f,g=d.options.chart.ignoreHiddenSeries,h=c.visible;f=(c.visible=a=c.userOptions.visible=a===t?!h:a)?"show":
"hide";n(["group","dataLabelsGroup","markerGroup","tracker"],function(a){if(c[a])c[a][f]()});if(d.hoverSeries===c||(d.hoverPoint&&d.hoverPoint.series)===c)c.onMouseOut();e&&d.legend.colorizeItem(c,a);c.isDirty=!0;c.options.stacking&&n(d.series,function(a){if(a.options.stacking&&a.visible)a.isDirty=!0});n(c.linkedSeries,function(b){b.setVisible(a,!1)});if(g)d.isDirtyBox=!0;b!==!1&&d.redraw();M(c,f)},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)},select:function(a){this.selected=
a=a===t?!this.selected:a;if(this.checkbox)this.checkbox.checked=a;M(this,a?"select":"unselect")},drawTracker:nb.drawTrackerGraph});U(Q.prototype,"init",function(a){var b;a.apply(this,Array.prototype.slice.call(arguments,1));(b=this.xAxis)&&b.options.ordinal&&D(this,"updatedData",function(){delete b.ordinalIndex})});U(I.prototype,"getTimeTicks",function(a,b,c,d,e,f,g,h){var i=0,j,k,l={},m,o,p,n=[],q=-Number.MAX_VALUE,v=this.options.tickPixelInterval;if(!this.options.ordinal&&!this.options.breaks||
!f||f.length<3||c===t)return a.call(this,b,c,d,e);o=f.length;for(j=0;j<o;j++){p=j&&f[j-1]>d;f[j]<c&&(i=j);if(j===o-1||f[j+1]-f[j]>g*5||p){if(f[j]>q){for(k=a.call(this,b,f[i],f[j],e);k.length&&k[0]<=q;)k.shift();k.length&&(q=k[k.length-1]);n=n.concat(k)}i=j+1}if(p)break}a=k.info;if(h&&a.unitRange<=H.hour){j=n.length-1;for(i=1;i<j;i++)ma("%d",n[i])!==ma("%d",n[i-1])&&(l[n[i]]="day",m=!0);m&&(l[n[0]]="day");a.higherRanks=l}n.info=a;if(h&&s(v)){h=a=n.length;j=[];var u;for(m=[];h--;)i=this.translate(n[h]),
u&&(m[h]=u-i),j[h]=u=i;m.sort();m=m[V(m.length/2)];m<v*0.6&&(m=null);h=n[a-1]>d?a-1:a;for(u=void 0;h--;)i=j[h],d=u-i,u&&d<v*0.8&&(m===null||d<m*0.8)?(l[n[h]]&&!l[n[h+1]]?(d=h+1,u=i):d=h,n.splice(d,1)):u=i}return n});x(I.prototype,{beforeSetTickPositions:function(){var a,b=[],c=!1,d,e=this.getExtremes(),f=e.min,g=e.max,h,i=this.isXAxis&&!!this.options.breaks;if((e=this.options.ordinal)||i){n(this.series,function(c,d){if(c.visible!==!1&&(c.takeOrdinalPosition!==!1||i))if(b=b.concat(c.processedXData),
a=b.length,b.sort(function(a,b){return a-b}),a)for(d=a-1;d--;)b[d]===b[d+1]&&b.splice(d,1)});a=b.length;if(a>2){d=b[1]-b[0];for(h=a-1;h--&&!c;)b[h+1]-b[h]!==d&&(c=!0);if(!this.options.keepOrdinalPadding&&(b[0]-f>d||g-b[b.length-1]>d))c=!0}c?(this.ordinalPositions=b,d=this.val2lin(v(f,b[0]),!0),h=v(this.val2lin(E(g,b[b.length-1]),!0),1),this.ordinalSlope=g=(g-f)/(h-d),this.ordinalOffset=f-d*g):this.ordinalPositions=this.ordinalSlope=this.ordinalOffset=t}this.isOrdinal=e&&c;this.groupIntervalFactor=
null},val2lin:function(a,b){var c=this.ordinalPositions,d;if(c){var e=c.length,f;for(d=e;d--;)if(c[d]===a){f=d;break}for(d=e-1;d--;)if(a>c[d]||d===0){c=(a-c[d])/(c[d+1]-c[d]);f=d+c;break}d=b?f:this.ordinalSlope*(f||0)+this.ordinalOffset}else d=a;return d},lin2val:function(a,b){var c=this.ordinalPositions;if(c){var d=this.ordinalSlope,e=this.ordinalOffset,f=c.length-1,g,h;if(b)a<0?a=c[0]:a>f?a=c[f]:(f=V(a),h=a-f);else for(;f--;)if(g=d*f+e,a>=g){d=d*(f+1)+e;h=(a-g)/(d-g);break}c=h!==t&&c[f]!==t?c[f]+
(h?h*(c[f+1]-c[f]):0):a}else c=a;return c},getExtendedPositions:function(){var a=this.chart,b=this.series[0].currentDataGrouping,c=this.ordinalIndex,d=b?b.count+b.unitName:"raw",e=this.getExtremes(),f,g;if(!c)c=this.ordinalIndex={};if(!c[d])f={series:[],getExtremes:function(){return{min:e.dataMin,max:e.dataMax}},options:{ordinal:!0},val2lin:I.prototype.val2lin},n(this.series,function(c){g={xAxis:f,xData:c.xData,chart:a,destroyGroupedData:ra};g.options={dataGrouping:b?{enabled:!0,forced:!0,approximation:"open",
units:[[b.unitName,[b.count]]]}:{enabled:!1}};c.processData.apply(g);f.series.push(g)}),this.beforeSetTickPositions.apply(f),c[d]=f.ordinalPositions;return c[d]},getGroupIntervalFactor:function(a,b,c){var d,c=c.processedXData,e=c.length,f=[];d=this.groupIntervalFactor;if(!d){for(d=0;d<e-1;d++)f[d]=c[d+1]-c[d];f.sort(function(a,b){return a-b});f=f[V(e/2)];a=v(a,c[0]);b=E(b,c[e-1]);this.groupIntervalFactor=d=e*f/(b-a)}return d},postProcessTickInterval:function(a){var b=this.ordinalSlope;return b?this.options.breaks?
this.closestPointRange:a/(b/this.closestPointRange):a}});U(Ca.prototype,"pan",function(a,b){var c=this.xAxis[0],d=b.chartX,e=!1;if(c.options.ordinal&&c.series.length){var f=this.mouseDownX,g=c.getExtremes(),h=g.dataMax,i=g.min,j=g.max,k=this.hoverPoints,l=c.closestPointRange,f=(f-d)/(c.translationSlope*(c.ordinalSlope||l)),m={ordinalPositions:c.getExtendedPositions()},l=c.lin2val,o=c.val2lin,p;if(m.ordinalPositions){if(S(f)>1)k&&n(k,function(a){a.setState()}),f<0?(k=m,p=c.ordinalPositions?c:m):(k=
c.ordinalPositions?c:m,p=m),m=p.ordinalPositions,h>m[m.length-1]&&m.push(h),this.fixedRange=j-i,f=c.toFixedRange(null,null,l.apply(k,[o.apply(k,[i,!0])+f,!0]),l.apply(p,[o.apply(p,[j,!0])+f,!0])),f.min>=E(g.dataMin,i)&&f.max<=v(h,j)&&c.setExtremes(f.min,f.max,!0,!1,{trigger:"pan"}),this.mouseDownX=d,F(this.container,{cursor:"move"})}else e=!0}else e=!0;e&&a.apply(this,Array.prototype.slice.call(arguments,1))});Q.prototype.gappedPath=function(){var a=this.options.gapSize,b=this.points.slice(),c=b.length-
1;if(a&&c>0)for(;c--;)b[c+1].x-b[c].x>this.closestPointRange*a&&b.splice(c+1,0,{isNull:!0});return this.getGraphPath(b)};(function(a){a(z)})(function(a){function b(){return Array.prototype.slice.call(arguments,1)}function c(a){a.apply(this);this.drawBreaks(this.xAxis,["x"]);this.drawBreaks(this.yAxis,d(this.pointArrayMap,["y"]))}var d=a.pick,e=a.wrap,f=a.each,g=a.extend,h=a.fireEvent,i=a.Axis,j=a.Series;g(i.prototype,{isInBreak:function(a,b){var c=a.repeat||Infinity,d=a.from,e=a.to-a.from,c=b>=d?
(b-d)%c:c-(d-b)%c;return a.inclusive?c<=e:c<e&&c!==0},isInAnyBreak:function(a,b){var c=this.options.breaks,e=c&&c.length,f,g,h;if(e){for(;e--;)this.isInBreak(c[e],a)&&(f=!0,g||(g=d(c[e].showPoints,this.isXAxis?!1:!0)));h=f&&b?f&&!g:f}return h}});e(i.prototype,"setTickPositions",function(a){a.apply(this,Array.prototype.slice.call(arguments,1));if(this.options.breaks){var b=this.tickPositions,c=this.tickPositions.info,d=[],e;for(e=0;e<b.length;e++)this.isInAnyBreak(b[e])||d.push(b[e]);this.tickPositions=
d;this.tickPositions.info=c}});e(i.prototype,"init",function(a,b,c){if(c.breaks&&c.breaks.length)c.ordinal=!1;a.call(this,b,c);if(this.options.breaks){var d=this;d.isBroken=!0;this.val2lin=function(a){var b=a,c,e;for(e=0;e<d.breakArray.length;e++)if(c=d.breakArray[e],c.to<=a)b-=c.len;else if(c.from>=a)break;else if(d.isInBreak(c,a)){b-=a-c.from;break}return b};this.lin2val=function(a){var b,c;for(c=0;c<d.breakArray.length;c++)if(b=d.breakArray[c],b.from>=a)break;else b.to<a?a+=b.len:d.isInBreak(b,
a)&&(a+=b.len);return a};this.setExtremes=function(a,b,c,d,e){for(;this.isInAnyBreak(a);)a-=this.closestPointRange;for(;this.isInAnyBreak(b);)b-=this.closestPointRange;i.prototype.setExtremes.call(this,a,b,c,d,e)};this.setAxisTranslation=function(a){i.prototype.setAxisTranslation.call(this,a);var b=d.options.breaks,a=[],c=[],e=0,f,g,k=d.userMin||d.min,j=d.userMax||d.max,l,m;for(m in b)g=b[m],f=g.repeat||Infinity,d.isInBreak(g,k)&&(k+=g.to%f-k%f),d.isInBreak(g,j)&&(j-=j%f-g.from%f);for(m in b){g=b[m];
l=g.from;for(f=g.repeat||Infinity;l-f>k;)l-=f;for(;l<k;)l+=f;for(;l<j;l+=f)a.push({value:l,move:"in"}),a.push({value:l+(g.to-g.from),move:"out",size:g.breakSize})}a.sort(function(a,b){return a.value===b.value?(a.move==="in"?0:1)-(b.move==="in"?0:1):a.value-b.value});b=0;l=k;for(m in a){g=a[m];b+=g.move==="in"?1:-1;if(b===1&&g.move==="in")l=g.value;b===0&&(c.push({from:l,to:g.value,len:g.value-l-(g.size||0)}),e+=g.value-l-(g.size||0))}d.breakArray=c;h(d,"afterBreaks");d.transA*=(j-d.min)/(j-k-e);d.min=
k;d.max=j}}});e(j.prototype,"generatePoints",function(a){a.apply(this,b(arguments));var c=this.xAxis,d=this.yAxis,e=this.points,f,g=e.length,h=this.options.connectNulls,i;if(c&&d&&(c.options.breaks||d.options.breaks))for(;g--;)if(f=e[g],i=f.y===null&&h===!1,!i&&(c.isInAnyBreak(f.x,!0)||d.isInAnyBreak(f.y,!0)))e.splice(g,1),this.data[g]&&this.data[g].destroyElements()});a.Series.prototype.drawBreaks=function(a,b){var c=this,e=c.points,g,i,j,n;f(b,function(b){g=a.breakArray||[];i=a.isXAxis?a.min:d(c.options.threshold,
a.min);f(e,function(c){n=d(c["stack"+b.toUpperCase()],c[b]);f(g,function(b){j=!1;if(i<b.from&&n>b.to||i>b.from&&n<b.from)j="pointBreak";else if(i<b.from&&n>b.from&&n<b.to||i>b.from&&n>b.to&&n<b.from)j="pointInBreak";j&&h(a,j,{point:c,brk:b})})})})};e(a.seriesTypes.column.prototype,"drawPoints",c);e(a.Series.prototype,"drawPoints",c)});var ia=Q.prototype,cc=ia.processData,dc=ia.generatePoints,ec=ia.destroy,fc={approximation:"average",groupPixelWidth:2,dateTimeLabelFormats:{millisecond:["%A, %b %e, %H:%M:%S.%L",
"%A, %b %e, %H:%M:%S.%L","-%H:%M:%S.%L"],second:["%A, %b %e, %H:%M:%S","%A, %b %e, %H:%M:%S","-%H:%M:%S"],minute:["%A, %b %e, %H:%M","%A, %b %e, %H:%M","-%H:%M"],hour:["%A, %b %e, %H:%M","%A, %b %e, %H:%M","-%H:%M"],day:["%A, %b %e, %Y","%A, %b %e","-%A, %b %e, %Y"],week:["Week from %A, %b %e, %Y","%A, %b %e","-%A, %b %e, %Y"],month:["%B %Y","%B","-%B %Y"],year:["%Y","%Y","-%Y"]}},Xb={line:{},spline:{},area:{},areaspline:{},column:{approximation:"sum",groupPixelWidth:10},arearange:{approximation:"range"},
areasplinerange:{approximation:"range"},columnrange:{approximation:"range",groupPixelWidth:10},candlestick:{approximation:"ohlc",groupPixelWidth:10},ohlc:{approximation:"ohlc",groupPixelWidth:5}},Yb=[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1]],["week",[1]],["month",[1,3,6]],["year",null]],Ua={sum:function(a){var b=a.length,c;if(!b&&a.hasNulls)c=null;else if(b)for(c=0;b--;)c+=a[b];return c},average:function(a){var b=
a.length,a=Ua.sum(a);typeof a==="number"&&b&&(a/=b);return a},open:function(a){return a.length?a[0]:a.hasNulls?null:t},high:function(a){return a.length?Ea(a):a.hasNulls?null:t},low:function(a){return a.length?Oa(a):a.hasNulls?null:t},close:function(a){return a.length?a[a.length-1]:a.hasNulls?null:t},ohlc:function(a,b,c,d){a=Ua.open(a);b=Ua.high(b);c=Ua.low(c);d=Ua.close(d);if(typeof a==="number"||typeof b==="number"||typeof c==="number"||typeof d==="number")return[a,b,c,d]},range:function(a,b){a=
Ua.low(a);b=Ua.high(b);if(typeof a==="number"||typeof b==="number")return[a,b]}};ia.groupData=function(a,b,c,d){var e=this.data,f=this.options.data,g=[],h=[],i=[],j=a.length,k,l,m=!!b,o=[[],[],[],[]],d=typeof d==="function"?d:Ua[d],p=this.pointArrayMap,n=p&&p.length,q,s=0;for(q=0;q<=j;q++)if(a[q]>=c[0])break;for(;q<=j;q++){for(;c[1]!==t&&a[q]>=c[1]||q===j;)if(k=c.shift(),l=d.apply(0,o),l!==t&&(g.push(k),h.push(l),i.push({start:s,length:o[0].length})),s=q,o[0]=[],o[1]=[],o[2]=[],o[3]=[],q===j)break;
if(q===j)break;if(p){k=this.cropStart+q;k=e&&e[k]||this.pointClass.prototype.applyOptions.apply({series:this},[f[k]]);var u;for(l=0;l<n;l++)if(u=k[p[l]],typeof u==="number")o[l].push(u);else if(u===null)o[l].hasNulls=!0}else if(k=m?b[q]:null,typeof k==="number")o[0].push(k);else if(k===null)o[0].hasNulls=!0}return[g,h,i]};ia.processData=function(){var a=this.chart,b=this.options.dataGrouping,c=this.allowDG!==!1&&b&&q(b.enabled,a.options._stock),d;this.forceCrop=c;this.groupPixelWidth=null;this.hasProcessed=
!0;if(cc.apply(this,arguments)!==!1&&c){this.destroyGroupedData();var e=this.processedXData,f=this.processedYData,g=a.plotSizeX,a=this.xAxis,h=a.options.ordinal,i=this.groupPixelWidth=a.getGroupPixelWidth&&a.getGroupPixelWidth();if(i){d=!0;this.points=null;var j=a.getExtremes(),c=j.min,j=j.max,h=h&&a.getGroupIntervalFactor(c,j,this)||1,g=i*(j-c)/g*h,i=a.getTimeTicks(a.normalizeTimeTickInterval(g,b.units||Yb),Math.min(c,e[0]),Math.max(j,e[e.length-1]),a.options.startOfWeek,e,this.closestPointRange),
e=ia.groupData.apply(this,[e,f,i,b.approximation]),f=e[0],h=e[1];if(b.smoothed){b=f.length-1;for(f[b]=Math.min(f[b],j);b--&&b>0;)f[b]+=g/2;f[0]=Math.max(f[0],c)}this.currentDataGrouping=i.info;this.closestPointRange=i.info.totalRange;this.groupMap=e[2];if(s(f[0])&&f[0]<a.dataMin){if(a.min===a.dataMin)a.min=f[0];a.dataMin=f[0]}this.processedXData=f;this.processedYData=h}else this.currentDataGrouping=this.groupMap=null;this.hasGroupedData=d}};ia.destroyGroupedData=function(){var a=this.groupedData;
n(a||[],function(b,c){b&&(a[c]=b.destroy?b.destroy():null)});this.groupedData=null};ia.generatePoints=function(){dc.apply(this);this.destroyGroupedData();this.groupedData=this.hasGroupedData?this.points:null};U(Lb.prototype,"tooltipFooterHeaderFormatter",function(a,b,c){var d=b.series,e=d.tooltipOptions,f=d.options.dataGrouping,g=e.xDateFormat,h,i=d.xAxis;return i&&i.options.type==="datetime"&&f&&ua(b.key)?(a=d.currentDataGrouping,f=f.dateTimeLabelFormats,a?(i=f[a.unitName],a.count===1?g=i[0]:(g=
i[1],h=i[2])):!g&&f&&(g=this.getXDateFormat(b,e,i)),g=ma(g,b.key),h&&(g+=ma(h,b.key+a.totalRange-1)),La(e[(c?"footer":"header")+"Format"],{point:x(b,{key:g}),series:d})):a.call(this,b,c)});ia.destroy=function(){for(var a=this.groupedData||[],b=a.length;b--;)a[b]&&a[b].destroy();ec.apply(this)};U(ia,"setOptions",function(a,b){var c=a.call(this,b),d=this.type,e=this.chart.options.plotOptions,f=W[d].dataGrouping;if(Xb[d])f||(f=C(fc,Xb[d])),c.dataGrouping=C(f,e.series&&e.series.dataGrouping,e[d].dataGrouping,
b.dataGrouping);if(this.chart.options._stock)this.requireSorting=!0;return c});U(I.prototype,"setScale",function(a){a.call(this);n(this.series,function(a){a.hasProcessed=!1})});I.prototype.getGroupPixelWidth=function(){var a=this.series,b=a.length,c,d=0,e=!1,f;for(c=b;c--;)(f=a[c].options.dataGrouping)&&(d=v(d,f.groupPixelWidth));for(c=b;c--;)if((f=a[c].options.dataGrouping)&&a[c].hasProcessed)if(b=(a[c].processedXData||a[c].data).length,a[c].groupPixelWidth||b>this.chart.plotSizeX/d||b&&f.forced)e=
!0;return e?d:0};I.prototype.setDataGrouping=function(a,b){var c,b=q(b,!0);a||(a={forced:!1,units:null});if(this instanceof I)for(c=this.series.length;c--;)this.series[c].update({dataGrouping:a},!1);else n(this.chart.options.series,function(b){b.dataGrouping=a},!1);b&&this.chart.redraw()};W.ohlc=C(W.column,{lineWidth:1,tooltip:{pointFormat:'<span style="color:{point.color}">\u25cf</span> <b> {series.name}</b><br/>Open: {point.open}<br/>High: {point.high}<br/>Low: {point.low}<br/>Close: {point.close}<br/>'},
states:{hover:{lineWidth:3}},threshold:null});ca=la(K.column,{type:"ohlc",pointArrayMap:["open","high","low","close"],toYData:function(a){return[a.open,a.high,a.low,a.close]},pointValKey:"high",pointAttrToOptions:{stroke:"color","stroke-width":"lineWidth"},upColorProp:"stroke",getAttribs:function(){K.column.prototype.getAttribs.apply(this,arguments);var a=this.options,b=a.states,a=a.upColor||this.color,c=C(this.pointAttr),d=this.upColorProp;c[""][d]=a;c.hover[d]=b.hover.upColor||a;c.select[d]=b.select.upColor||
a;n(this.points,function(a){if(a.open<a.close&&!a.options.color)a.pointAttr=c})},translate:function(){var a=this.yAxis;K.column.prototype.translate.apply(this);n(this.points,function(b){if(b.open!==null)b.plotOpen=a.translate(b.open,0,1,0,1);if(b.close!==null)b.plotClose=a.translate(b.close,0,1,0,1)})},drawPoints:function(){var a=this,b=a.chart,c,d,e,f,g,h,i,j;n(a.points,function(k){if(k.plotY!==t)i=k.graphic,c=k.pointAttr[k.selected?"selected":""]||a.pointAttr[""],f=c["stroke-width"]%2/2,j=y(k.plotX)-
f,g=y(k.shapeArgs.width/2),h=["M",j,y(k.yBottom),"L",j,y(k.plotY)],k.open!==null&&(d=y(k.plotOpen)+f,h.push("M",j,d,"L",j-g,d)),k.close!==null&&(e=y(k.plotClose)+f,h.push("M",j,e,"L",j+g,e)),i?i.attr(c).animate({d:h}):k.graphic=b.renderer.path(h).attr(c).add(a.group)})},animate:null});K.ohlc=ca;W.candlestick=C(W.column,{lineColor:"black",lineWidth:1,states:{hover:{lineWidth:2}},tooltip:W.ohlc.tooltip,threshold:null,upColor:"white"});ca=la(ca,{type:"candlestick",pointAttrToOptions:{fill:"color",stroke:"lineColor",
"stroke-width":"lineWidth"},upColorProp:"fill",getAttribs:function(){K.ohlc.prototype.getAttribs.apply(this,arguments);var a=this.options,b=a.states,c=a.upLineColor||a.lineColor,d=b.hover.upLineColor||c,e=b.select.upLineColor||c;n(this.points,function(a){if(a.open<a.close){if(a.lineColor)a.pointAttr=C(a.pointAttr),c=a.lineColor;a.pointAttr[""].stroke=c;a.pointAttr.hover.stroke=d;a.pointAttr.select.stroke=e}})},drawPoints:function(){var a=this,b=a.chart,c,d=a.pointAttr[""],e,f,g,h,i,j,k,l,m,o,p;n(a.points,
function(n){m=n.graphic;if(n.plotY!==t)c=n.pointAttr[n.selected?"selected":""]||d,k=c["stroke-width"]%2/2,l=y(n.plotX)-k,e=n.plotOpen,f=n.plotClose,g=Y.min(e,f),h=Y.max(e,f),p=y(n.shapeArgs.width/2),i=y(g)!==y(n.plotY),j=h!==n.yBottom,g=y(g)+k,h=y(h)+k,o=["M",l-p,h,"L",l-p,g,"L",l+p,g,"L",l+p,h,"Z","M",l,g,"L",l,i?y(n.plotY):g,"M",l,h,"L",l,j?y(n.yBottom):h],m?m.attr(c).animate({d:o}):n.graphic=b.renderer.path(o).attr(c).add(a.group).shadow(a.options.shadow)})}});K.candlestick=ca;var wb=ya.prototype.symbols;
W.flags=C(W.column,{fillColor:"white",lineWidth:1,pointRange:0,shape:"flag",stackDistance:12,states:{hover:{lineColor:"black",fillColor:"#FCFFC5"}},style:{fontSize:"11px",fontWeight:"bold",textAlign:"center"},tooltip:{pointFormat:"{point.text}<br/>"},threshold:null,y:-30});K.flags=la(K.column,{type:"flags",sorted:!1,noSharedTooltip:!0,allowDG:!1,takeOrdinalPosition:!1,trackerGroups:["markerGroup"],forceCrop:!0,init:Q.prototype.init,pointAttrToOptions:{fill:"fillColor",stroke:"color","stroke-width":"lineWidth",
r:"radius"},translate:function(){K.column.prototype.translate.apply(this);var a=this.options,b=this.chart,c=this.points,d=c.length-1,e,f,g=a.onSeries;e=g&&b.get(g);var a=a.onKey||"y",g=e&&e.options.step,h=e&&e.points,i=h&&h.length,j=this.xAxis,k=j.getExtremes(),l,m,o;if(e&&e.visible&&i){e=e.currentDataGrouping;m=h[i-1].x+(e?e.totalRange:0);c.sort(function(a,b){return a.x-b.x});for(a="plot"+a[0].toUpperCase()+a.substr(1);i--&&c[d];)if(e=c[d],l=h[i],l.x<=e.x&&l[a]!==void 0){if(e.x<=m)e.plotY=l[a],l.x<
e.x&&!g&&(o=h[i+1])&&o[a]!==t&&(e.plotY+=(e.x-l.x)/(o.x-l.x)*(o[a]-l[a]));d--;i++;if(d<0)break}}n(c,function(a,d){var e;if(a.plotY===t)a.x>=k.min&&a.x<=k.max?a.plotY=b.chartHeight-j.bottom-(j.opposite?j.height:0)+j.offset-b.plotTop:a.shapeArgs={};if((f=c[d-1])&&f.plotX===a.plotX){if(f.stackIndex===t)f.stackIndex=0;e=f.stackIndex+1}a.stackIndex=e})},drawPoints:function(){var a,b=this.pointAttr[""],c=this.points,d=this.chart,e=d.renderer,f,g,h=this.options,i=h.y,j,k,l,m,o,n,r=this.yAxis;for(k=c.length;k--;)if(l=
c[k],a=l.plotX>this.xAxis.len,f=l.plotX,f>0&&(f-=q(l.lineWidth,h.lineWidth)%2),m=l.stackIndex,j=l.options.shape||h.shape,g=l.plotY,g!==t&&(g=l.plotY+i-(m!==t&&m*h.stackDistance)),o=m?t:l.plotX,n=m?t:l.plotY,m=l.graphic,g!==t&&f>=0&&!a)a=l.pointAttr[l.selected?"select":""]||b,m?m.attr({x:f,y:g,r:a.r,anchorX:o,anchorY:n}):l.graphic=e.label(l.options.title||h.title||"A",f,g,j,o,n,h.useHTML).css(C(h.style,l.style)).attr(a).attr({align:j==="flag"?"left":"center",width:h.width,height:h.height}).add(this.markerGroup).shadow(h.shadow),
l.tooltipPos=d.inverted?[r.len+r.pos-d.plotLeft-g,this.xAxis.len-f]:[f,g];else if(m)l.graphic=m.destroy()},drawTracker:function(){var a=this.points;nb.drawTrackerPoint.apply(this);n(a,function(b){var c=b.graphic;c&&D(c.element,"mouseover",function(){if(b.stackIndex>0&&!b.raised)b._y=c.y,c.attr({y:b._y-8}),b.raised=!0;n(a,function(a){if(a!==b&&a.raised&&a.graphic)a.graphic.attr({y:a._y}),a.raised=!1})})})},animate:ra,buildKDTree:ra,setClip:ra});wb.flag=function(a,b,c,d,e){return["M",e&&e.anchorX||
a,e&&e.anchorY||b,"L",a,b+d,a,b,a+c,b,a+c,b+d,a,b+d,"Z"]};n(["circle","square"],function(a){wb[a+"pin"]=function(b,c,d,e,f){var g=f&&f.anchorX,f=f&&f.anchorY;a==="circle"&&e>d&&(b-=y((e-d)/2),d=e);b=wb[a](b,c,d,e);g&&f&&b.push("M",g,c>f?c:c+e,"L",g,f);return b}});Ya===z.VMLRenderer&&n(["flag","circlepin","squarepin"],function(a){mb.prototype.symbols[a]=wb[a]});var ca=[].concat(Yb),xb=function(a){var b=Sa(arguments,function(a){return typeof a==="number"});if(b.length)return Math[a].apply(0,b)};ca[4]=
["day",[1,2,3,4]];ca[5]=["week",[1,2,3]];x(N,{navigator:{handles:{backgroundColor:"#ebe7e8",borderColor:"#b2b1b6"},height:40,margin:25,maskFill:"rgba(128,179,236,0.3)",maskInside:!0,outlineColor:"#b2b1b6",outlineWidth:1,series:{type:K.areaspline===t?"line":"areaspline",color:"#4572A7",compare:null,fillOpacity:0.05,dataGrouping:{approximation:"average",enabled:!0,groupPixelWidth:2,smoothed:!0,units:ca},dataLabels:{enabled:!1,zIndex:2},id:"highcharts-navigator-series",lineColor:null,lineWidth:1,marker:{enabled:!1},
pointRange:0,shadow:!1,threshold:null},xAxis:{tickWidth:0,lineWidth:0,gridLineColor:"#EEE",gridLineWidth:1,tickPixelInterval:200,labels:{align:"left",style:{color:"#888"},x:3,y:-4},crosshair:!1},yAxis:{gridLineWidth:0,startOnTick:!1,endOnTick:!1,minPadding:0.1,maxPadding:0.1,labels:{enabled:!1},crosshair:!1,title:{text:null},tickWidth:0}},scrollbar:{height:kb?20:14,barBackgroundColor:"#bfc8d1",barBorderRadius:0,barBorderWidth:1,barBorderColor:"#bfc8d1",buttonArrowColor:"#666",buttonBackgroundColor:"#ebe7e8",
buttonBorderColor:"#bbb",buttonBorderRadius:0,buttonBorderWidth:1,minWidth:6,rifleColor:"#666",trackBackgroundColor:"#eeeeee",trackBorderColor:"#eeeeee",trackBorderWidth:1,liveRedraw:ja&&!kb}});Hb.prototype={drawHandle:function(a,b){var c=this.chart,d=c.renderer,e=this.elementsToDestroy,f=this.handles,g=this.navigatorOptions.handles,g={fill:g.backgroundColor,stroke:g.borderColor,"stroke-width":1},h;this.rendered||(f[b]=d.g("navigator-handle-"+["left","right"][b]).css({cursor:"ew-resize"}).attr({zIndex:10-
b}).add(),h=d.rect(-4.5,0,9,16,0,1).attr(g).add(f[b]),e.push(h),h=d.path(["M",-1.5,4,"L",-1.5,12,"M",0.5,4,"L",0.5,12]).attr(g).add(f[b]),e.push(h));f[b][c.isResizing?"animate":"attr"]({translateX:this.scrollerLeft+this.scrollbarHeight+parseInt(a,10),translateY:this.top+this.height/2-8})},drawScrollbarButton:function(a){var b=this.chart.renderer,c=this.elementsToDestroy,d=this.scrollbarButtons,e=this.scrollbarHeight,f=this.scrollbarOptions,g;this.rendered||(d[a]=b.g().add(this.scrollbarGroup),g=b.rect(-0.5,
-0.5,e+1,e+1,f.buttonBorderRadius,f.buttonBorderWidth).attr({stroke:f.buttonBorderColor,"stroke-width":f.buttonBorderWidth,fill:f.buttonBackgroundColor}).add(d[a]),c.push(g),g=b.path(["M",e/2+(a?-1:1),e/2-3,"L",e/2+(a?-1:1),e/2+3,e/2+(a?2:-2),e/2]).attr({fill:f.buttonArrowColor}).add(d[a]),c.push(g));a&&d[a].attr({translateX:this.scrollerWidth-e})},render:function(a,b,c,d){var e=this.chart,f=e.renderer,g,h,i,j,k=this.scrollbarGroup,l=this.navigatorGroup,m=this.scrollbar,l=this.xAxis,o=this.scrollbarTrack,
n=this.scrollbarHeight,r=this.scrollbarEnabled,A=this.navigatorOptions,t=this.scrollbarOptions,u=t.minWidth,w=this.height,x=this.top,z=this.navigatorEnabled,C=A.outlineWidth,B=C/2,D=0,G=this.outlineHeight,I=t.barBorderRadius,H=t.barBorderWidth,F=x+B,J;if(s(a)&&!isNaN(a)&&s(b)&&!(isNaN(b)||this.hasDragged&&!s(c))){this.navigatorLeft=g=q(l.left,e.plotLeft+n);this.navigatorWidth=h=q(l.len,e.plotWidth-2*n);this.scrollerLeft=i=g-n;this.scrollerWidth=j=j=h+2*n;l.getExtremes&&(J=this.getUnionExtremes(!0))&&
(J.dataMin!==l.min||J.dataMax!==l.max)&&l.setExtremes(J.dataMin,J.dataMax,!0,!1);c=q(c,l.translate(a));d=q(d,l.translate(b));if(isNaN(c)||S(c)===Infinity)c=0,d=j;if(!(l.translate(d,!0)-l.translate(c,!0)<e.xAxis[0].minRange)){this.zoomedMax=E(v(c,d,0),h);this.zoomedMin=E(v(this.fixedWidth?this.zoomedMax-this.fixedWidth:E(c,d),0),h);this.range=this.zoomedMax-this.zoomedMin;c=y(this.zoomedMax);b=y(this.zoomedMin);a=c-b;if(!this.rendered){if(z)this.navigatorGroup=l=f.g("navigator").attr({zIndex:3}).add(),
this.leftShade=f.rect().attr({fill:A.maskFill}).add(l),A.maskInside?this.leftShade.css({cursor:"ew-resize"}):this.rightShade=f.rect().attr({fill:A.maskFill}).add(l),this.outline=f.path().attr({"stroke-width":C,stroke:A.outlineColor}).add(l);if(r)this.scrollbarGroup=k=f.g("scrollbar").add(),m=t.trackBorderWidth,this.scrollbarTrack=o=f.rect().attr({x:0,y:-m%2/2,fill:t.trackBackgroundColor,stroke:t.trackBorderColor,"stroke-width":m,r:t.trackBorderRadius||0,height:n}).add(k),this.scrollbar=m=f.rect().attr({y:-H%
2/2,height:n,fill:t.barBackgroundColor,stroke:t.barBorderColor,"stroke-width":H,r:I}).add(k),this.scrollbarRifles=f.path().attr({stroke:t.rifleColor,"stroke-width":1}).add(k)}e=e.isResizing?"animate":"attr";if(z){this.leftShade[e](A.maskInside?{x:g+b,y:x,width:c-b,height:w}:{x:g,y:x,width:b,height:w});if(this.rightShade)this.rightShade[e]({x:g+c,y:x,width:h-c,height:w});this.outline[e]({d:["M",i,F,"L",g+b-B,F,g+b-B,F+G,"L",g+c-B,F+G,"L",g+c-B,F,i+j,F].concat(A.maskInside?["M",g+b+B,F,"L",g+c-B,F]:
[])});this.drawHandle(b+B,0);this.drawHandle(c+B,1)}if(r&&k)this.drawScrollbarButton(0),this.drawScrollbarButton(1),k[e]({translateX:i,translateY:y(F+w)}),o[e]({width:j}),g=n+b,h=a-H,h<u&&(D=(u-h)/2,h=u,g-=D),this.scrollbarPad=D,m[e]({x:V(g)+H%2/2,width:h}),u=n+b+a/2-0.5,this.scrollbarRifles.attr({visibility:a>12?"visible":"hidden"})[e]({d:["M",u-3,n/4,"L",u-3,2*n/3,"M",u,n/4,"L",u,2*n/3,"M",u+3,n/4,"L",u+3,2*n/3]});this.scrollbarPad=D;this.rendered=!0}}},addEvents:function(){var a=this.chart.container,
b=this.mouseDownHandler,c=this.mouseMoveHandler,d=this.mouseUpHandler,e;e=[[a,"mousedown",b],[a,"mousemove",c],[B,"mouseup",d]];db&&e.push([a,"touchstart",b],[a,"touchmove",c],[B,"touchend",d]);n(e,function(a){D.apply(null,a)});this._events=e},removeEvents:function(){n(this._events,function(a){T.apply(null,a)});this._events=t;this.navigatorEnabled&&this.baseSeries&&T(this.baseSeries,"updatedData",this.updatedDataHandler)},init:function(){var a=this,b=a.chart,c,d,e=a.scrollbarHeight,f=a.navigatorOptions,
g=a.height,h=a.top,i,j=a.baseSeries;a.mouseDownHandler=function(d){var d=b.pointer.normalize(d),e=a.zoomedMin,f=a.zoomedMax,h=a.top,j=a.scrollbarHeight,k=a.scrollerLeft,l=a.scrollerWidth,n=a.navigatorLeft,q=a.navigatorWidth,s=a.scrollbarPad,t=a.range,v=d.chartX,x=d.chartY,d=b.xAxis[0],y,z=kb?10:7;if(x>h&&x<h+g+j)if((h=!a.scrollbarEnabled||x<h+g)&&Y.abs(v-e-n)<z)a.grabbedLeft=!0,a.otherHandlePos=f,a.fixedExtreme=d.max,b.fixedRange=null;else if(h&&Y.abs(v-f-n)<z)a.grabbedRight=!0,a.otherHandlePos=e,
a.fixedExtreme=d.min,b.fixedRange=null;else if(v>n+e-s&&v<n+f+s)a.grabbedCenter=v,a.fixedWidth=t,i=v-e;else if(v>k&&v<k+l){f=h?v-n-t/2:v<n?e-t*0.2:v>k+l-j?e+t*0.2:v<n+e?e-t:f;if(f<0)f=0;else if(f+t>=q)f=q-t,y=a.getUnionExtremes().dataMax;if(f!==e)a.fixedWidth=t,e=c.toFixedRange(f,f+t,null,y),d.setExtremes(e.min,e.max,!0,!1,{trigger:"navigator"})}};a.mouseMoveHandler=function(c){var d=a.scrollbarHeight,e=a.navigatorLeft,f=a.navigatorWidth,g=a.scrollerLeft,h=a.scrollerWidth,j=a.range,k,l;if(!c.touches||
c.touches[0].pageX!==0)c=b.pointer.normalize(c),k=c.chartX,k<e?k=e:k>g+h-d&&(k=g+h-d),a.grabbedLeft?(l=!0,a.render(0,0,k-e,a.otherHandlePos)):a.grabbedRight?(l=!0,a.render(0,0,a.otherHandlePos,k-e)):a.grabbedCenter&&(l=!0,k<i?k=i:k>f+i-j&&(k=f+i-j),a.render(0,0,k-i,k-i+j)),l&&a.scrollbarOptions.liveRedraw&&setTimeout(function(){a.mouseUpHandler(c)},0),a.hasDragged=l};a.mouseUpHandler=function(d){var e,f;if(a.hasDragged){if(a.zoomedMin===a.otherHandlePos)e=a.fixedExtreme;else if(a.zoomedMax===a.otherHandlePos)f=
a.fixedExtreme;if(a.zoomedMax===a.navigatorWidth)f=a.getUnionExtremes().dataMax;e=c.toFixedRange(a.zoomedMin,a.zoomedMax,e,f);s(e.min)&&b.xAxis[0].setExtremes(e.min,e.max,!0,!1,{trigger:"navigator",triggerOp:"navigator-drag",DOMEvent:d})}if(d.type!=="mousemove")a.grabbedLeft=a.grabbedRight=a.grabbedCenter=a.fixedWidth=a.fixedExtreme=a.otherHandlePos=a.hasDragged=i=null};var k=b.xAxis.length,l=b.yAxis.length;b.extraBottomMargin=a.outlineHeight+f.margin;a.navigatorEnabled?(a.xAxis=c=new I(b,C({breaks:j&&
j.xAxis.options.breaks,ordinal:j&&j.xAxis.options.ordinal},f.xAxis,{id:"navigator-x-axis",isX:!0,type:"datetime",index:k,height:g,offset:0,offsetLeft:e,offsetRight:-e,keepOrdinalPadding:!0,startOnTick:!1,endOnTick:!1,minPadding:0,maxPadding:0,zoomEnabled:!1})),a.yAxis=d=new I(b,C(f.yAxis,{id:"navigator-y-axis",alignTicks:!1,height:g,offset:0,index:l,zoomEnabled:!1})),j||f.series.data?a.addBaseSeries():b.series.length===0&&U(b,"redraw",function(c,d){if(b.series.length>0&&!a.series)a.setBaseSeries(),
b.redraw=c;c.call(b,d)})):a.xAxis=c={translate:function(a,c){var d=b.xAxis[0],f=d.getExtremes(),g=b.plotWidth-2*e,h=xb("min",d.options.min,f.dataMin),d=xb("max",d.options.max,f.dataMax)-h;return c?a*d/g+h:g*(a-h)/d},toFixedRange:I.prototype.toFixedRange};U(b,"getMargins",function(b){var e=this.legend,f=e.options;b.apply(this,[].slice.call(arguments,1));a.top=h=a.navigatorOptions.top||this.chartHeight-a.height-a.scrollbarHeight-this.spacing[2]-(f.verticalAlign==="bottom"&&f.enabled&&!f.floating?e.legendHeight+
q(f.margin,10):0);if(c&&d)c.options.top=d.options.top=h,c.setAxisSize(),d.setAxisSize()});a.addEvents()},getUnionExtremes:function(a){var b=this.chart.xAxis[0],c=this.xAxis,d=c.options,e=b.options,f;if(!a||b.dataMin!==null)f={dataMin:q(d&&d.min,xb("min",e.min,b.dataMin,c.dataMin)),dataMax:q(d&&d.max,xb("max",e.max,b.dataMax,c.dataMax))};return f},setBaseSeries:function(a){var b=this.chart,a=a||b.options.navigator.baseSeries;this.series&&this.series.remove();this.baseSeries=b.series[a]||typeof a===
"string"&&b.get(a)||b.series[0];this.xAxis&&this.addBaseSeries()},addBaseSeries:function(){var a=this.baseSeries,b=a?a.options:{},c=b.data,d=this.navigatorOptions.series,e;e=d.data;this.hasNavigatorData=!!e;b=C(b,d,{enableMouseTracking:!1,group:"nav",padXAxis:!1,xAxis:"navigator-x-axis",yAxis:"navigator-y-axis",name:"Navigator",showInLegend:!1,stacking:!1,isInternal:!0,visible:!0});b.data=e||c.slice(0);this.series=this.chart.initSeries(b);if(a&&this.navigatorOptions.adaptToUpdatedData!==!1)D(a,"updatedData",
this.updatedDataHandler),a.userOptions.events=x(a.userOptions.event,{updatedData:this.updatedDataHandler})},updatedDataHandler:function(){var a=this.chart.scroller,b=a.baseSeries,c=b.xAxis,d=c.getExtremes(),e=d.min,f=d.max,g=d.dataMin,d=d.dataMax,h=f-e,i,j,k,l,m,o=a.series;i=o.xData;var n=!!c.setExtremes;j=f>=i[i.length-1]-(this.closestPointRange||0);i=e<=g;if(!a.hasNavigatorData)o.options.pointStart=b.xData[0],o.setData(b.options.data,!1),m=!0;i&&(l=g,k=l+h);j&&(k=d,i||(l=v(k-h,o.xData[0])));n&&
(i||j)?isNaN(l)||c.setExtremes(l,k,!0,!1,{trigger:"updatedData"}):(m&&this.chart.redraw(!1),a.render(v(e,g),E(f,d)))},destroy:function(){this.removeEvents();n([this.xAxis,this.yAxis,this.leftShade,this.rightShade,this.outline,this.scrollbarTrack,this.scrollbarRifles,this.scrollbarGroup,this.scrollbar],function(a){a&&a.destroy&&a.destroy()});this.xAxis=this.yAxis=this.leftShade=this.rightShade=this.outline=this.scrollbarTrack=this.scrollbarRifles=this.scrollbarGroup=this.scrollbar=null;n([this.scrollbarButtons,
this.handles,this.elementsToDestroy],function(a){Pa(a)})}};z.Scroller=Hb;U(I.prototype,"zoom",function(a,b,c){var d=this.chart,e=d.options,f=e.chart.zoomType,g=e.navigator,e=e.rangeSelector,h;if(this.isXAxis&&(g&&g.enabled||e&&e.enabled))if(f==="x")d.resetZoomButton="blocked";else if(f==="y")h=!1;else if(f==="xy")d=this.previousZoom,s(b)?this.previousZoom=[this.min,this.max]:d&&(b=d[0],c=d[1],delete this.previousZoom);return h!==t?h:a.call(this,b,c)});U(Ca.prototype,"init",function(a,b,c){D(this,
"beforeRender",function(){var a=this.options;if(a.navigator.enabled||a.scrollbar.enabled)this.scroller=new Hb(this)});a.call(this,b,c)});U(Q.prototype,"addPoint",function(a,b,c,d,e){var f=this.options.turboThreshold;f&&this.xData.length>f&&da(b)&&!Ja(b)&&this.chart.scroller&&ga(20,!0);a.call(this,b,c,d,e)});x(N,{rangeSelector:{buttonTheme:{width:28,height:18,fill:"#f7f7f7",padding:2,r:0,"stroke-width":0,style:{color:"#444",cursor:"pointer",fontWeight:"normal"},zIndex:7,states:{hover:{fill:"#e7e7e7"},
select:{fill:"#e7f0f9",style:{color:"black",fontWeight:"bold"}}}},height:35,inputPosition:{align:"right"},labelStyle:{color:"#666"}}});N.lang=C(N.lang,{rangeSelectorZoom:"Zoom",rangeSelectorFrom:"From",rangeSelectorTo:"To"});Ib.prototype={clickButton:function(a,b){var c=this,d=c.selected,e=c.chart,f=c.buttons,g=c.buttonOptions[a],h=e.xAxis[0],i=e.scroller&&e.scroller.getUnionExtremes()||h||{},j=i.dataMin,k=i.dataMax,l,m=h&&y(E(h.max,q(k,h.max))),o=g.type,p,i=g._range,r,s,x,u=g.dataGrouping;if(!(j===
null||k===null||a===c.selected)){e.fixedRange=i;if(u)this.forcedDataGrouping=!0,I.prototype.setDataGrouping.call(h||{chart:this.chart},u,!1);if(o==="month"||o==="year")if(h){if(o={range:g,max:m,dataMin:j,dataMax:k},l=h.minFromRange.call(o),typeof o.newMax==="number")m=o.newMax}else i=g;else if(i)l=v(m-i,j),m=E(l+i,k);else if(o==="ytd")if(h){if(k===t)j=Number.MAX_VALUE,k=Number.MIN_VALUE,n(e.series,function(a){a=a.xData;j=E(a[0],j);k=v(a[a.length-1],k)}),b=!1;m=new fa(k);l=m.getFullYear();l=r=v(j||
0,fa.UTC(l,0,1));m=m.getTime();m=E(k||m,m)}else{D(e,"beforeRender",function(){c.clickButton(a)});return}else o==="all"&&h&&(l=j,m=k);f[d]&&f[d].setState(0);if(f[a])f[a].setState(2),c.lastSelected=a;h?(h.setExtremes(l,m,q(b,1),0,{trigger:"rangeSelectorButton",rangeSelectorButton:g}),c.setSelected(a)):(p=e.options.xAxis[0],x=p.range,p.range=i,s=p.min,p.min=r,c.setSelected(a),D(e,"load",function(){p.range=x;p.min=s}))}},setSelected:function(a){this.selected=this.options.selected=a},defaultButtons:[{type:"month",
count:1,text:"1m"},{type:"month",count:3,text:"3m"},{type:"month",count:6,text:"6m"},{type:"ytd",text:"YTD"},{type:"year",count:1,text:"1y"},{type:"all",text:"All"}],init:function(a){var b=this,c=a.options.rangeSelector,d=c.buttons||[].concat(b.defaultButtons),e=c.selected,f=b.blurInputs=function(){var a=b.minInput,c=b.maxInput;a&&a.blur&&M(a,"blur");c&&c.blur&&M(c,"blur")};b.chart=a;b.options=c;b.buttons=[];a.extraTopMargin=c.height;b.buttonOptions=d;D(a.container,"mousedown",f);D(a,"resize",f);
n(d,b.computeButtonRange);e!==t&&d[e]&&this.clickButton(e,!1);D(a,"load",function(){D(a.xAxis[0],"setExtremes",function(c){this.max-this.min!==a.fixedRange&&c.trigger!=="rangeSelectorButton"&&c.trigger!=="updatedData"&&b.forcedDataGrouping&&this.setDataGrouping(!1,!1)});D(a.xAxis[0],"afterSetExtremes",function(){b.updateButtonStates(!0)})})},updateButtonStates:function(a){var b=this,c=this.chart,d=c.xAxis[0],e=c.scroller&&c.scroller.getUnionExtremes()||d,f=e.dataMin,g=e.dataMax,h=b.selected,i=b.options.allButtonsEnabled,
j=b.buttons;a&&c.fixedRange!==y(d.max-d.min)&&(j[h]&&j[h].setState(0),b.setSelected(null));n(b.buttonOptions,function(a,e){var m=y(d.max-d.min),o=a._range,n=a.type,q=a.count||1,s=o>g-f,t=o<d.minRange,u=a.type==="all"&&d.max-d.min>=g-f&&j[e].state!==2,w=a.type==="ytd"&&ma("%Y",f)===ma("%Y",g),v=c.renderer.forExport&&e===h,o=o===m,x=!d.hasVisibleSeries;if((n==="month"||n==="year")&&m>={month:28,year:365}[n]*864E5*q&&m<={month:31,year:366}[n]*864E5*q)o=!0;v||o&&e!==h&&e===b.lastSelected?(b.setSelected(e),
j[e].setState(2)):!i&&(s||t||u||w||x)?j[e].setState(3):j[e].state===3&&j[e].setState(0)})},computeButtonRange:function(a){var b=a.type,c=a.count||1,d={millisecond:1,second:1E3,minute:6E4,hour:36E5,day:864E5,week:6048E5};if(d[b])a._range=d[b]*c;else if(b==="month"||b==="year")a._range={month:30,year:365}[b]*864E5*c},setInputValue:function(a,b){var c=this.chart.options.rangeSelector;if(s(b))this[a+"Input"].HCTime=b;this[a+"Input"].value=ma(c.inputEditDateFormat||"%Y-%m-%d",this[a+"Input"].HCTime);this[a+
"DateBox"].attr({text:ma(c.inputDateFormat||"%b %e, %Y",this[a+"Input"].HCTime)})},showInput:function(a){var b=this.inputGroup,c=this[a+"DateBox"];F(this[a+"Input"],{left:b.translateX+c.x+"px",top:b.translateY+"px",width:c.width-2+"px",height:c.height-2+"px",border:"2px solid silver"})},hideInput:function(a){F(this[a+"Input"],{border:0,width:"1px",height:"1px"});this.setInputValue(a)},drawInput:function(a){function b(){var a=j.value,b=(g.inputDateParser||fa.parse)(a),e=d.xAxis[0],f=e.dataMin,h=e.dataMax;
if(b!==j.previousValue)j.previousValue=b,isNaN(b)&&(b=a.split("-"),b=fa.UTC(G(b[0]),G(b[1])-1,G(b[2]))),isNaN(b)||(N.global.useUTC||(b+=(new fa).getTimezoneOffset()*6E4),i?b>c.maxInput.HCTime?b=t:b<f&&(b=f):b<c.minInput.HCTime?b=t:b>h&&(b=h),b!==t&&d.xAxis[0].setExtremes(i?b:e.min,i?e.max:b,t,t,{trigger:"rangeSelectorInput"}))}var c=this,d=c.chart,e=d.renderer.style,f=d.renderer,g=d.options.rangeSelector,h=c.div,i=a==="min",j,k,l=this.inputGroup;this[a+"Label"]=k=f.label(N.lang[i?"rangeSelectorFrom":
"rangeSelectorTo"],this.inputGroup.offset).attr({padding:2}).css(C(e,g.labelStyle)).add(l);l.offset+=k.width+5;this[a+"DateBox"]=f=f.label("",l.offset).attr({padding:2,width:g.inputBoxWidth||90,height:g.inputBoxHeight||17,stroke:g.inputBoxBorderColor||"silver","stroke-width":1}).css(C({textAlign:"center",color:"#444"},e,g.inputStyle)).on("click",function(){c.showInput(a);c[a+"Input"].focus()}).add(l);l.offset+=f.width+(i?10:0);this[a+"Input"]=j=ea("input",{name:a,className:"highcharts-range-selector",
type:"text"},x({position:"absolute",border:0,width:"1px",height:"1px",padding:0,textAlign:"center",fontSize:e.fontSize,fontFamily:e.fontFamily,left:"-9em",top:d.plotTop+"px"},g.inputStyle),h);j.onfocus=function(){c.showInput(a)};j.onblur=function(){c.hideInput(a)};j.onchange=b;j.onkeypress=function(a){a.keyCode===13&&b()}},getPosition:function(){var a=this.chart,b=a.options.rangeSelector,a=q((b.buttonPosition||{}).y,a.plotTop-a.axisOffset[0]-b.height);return{buttonTop:a,inputTop:a-10}},render:function(a,
b){var c=this,d=c.chart,e=d.renderer,f=d.container,g=d.options,h=g.exporting&&g.exporting.enabled!==!1&&g.navigation&&g.navigation.buttonOptions,i=g.rangeSelector,j=c.buttons,g=N.lang,k=c.div,k=c.inputGroup,l=i.buttonTheme,m=i.buttonPosition||{},o=i.inputEnabled,p=l&&l.states,r=d.plotLeft,t,v=this.getPosition(),u=c.group,w=c.rendered;if(!w&&(c.group=u=e.g("range-selector-buttons").add(),c.zoomText=e.text(g.rangeSelectorZoom,q(m.x,r),15).css(i.labelStyle).add(u),t=q(m.x,r)+c.zoomText.getBBox().width+
5,n(c.buttonOptions,function(a,b){j[b]=e.button(a.text,t,0,function(){c.clickButton(b);c.isActive=!0},l,p&&p.hover,p&&p.select,p&&p.disabled).css({textAlign:"center"}).add(u);t+=j[b].width+q(i.buttonSpacing,5);c.selected===b&&j[b].setState(2)}),c.updateButtonStates(),o!==!1))c.div=k=ea("div",null,{position:"relative",height:0,zIndex:1}),f.parentNode.insertBefore(k,f),c.inputGroup=k=e.g("input-group").add(),k.offset=0,c.drawInput("min"),c.drawInput("max");u[w?"animate":"attr"]({translateY:v.buttonTop});
o!==!1&&(k.align(x({y:v.inputTop,width:k.offset,x:h&&v.inputTop<(h.y||0)+h.height-d.spacing[0]?-40:0},i.inputPosition),!0,d.spacingBox),s(o)||(d=u.getBBox(),k[k.translateX<d.x+d.width+10?"hide":"show"]()),c.setInputValue("min",a),c.setInputValue("max",b));c.rendered=!0},destroy:function(){var a=this.minInput,b=this.maxInput,c=this.chart,d=this.blurInputs,e;T(c.container,"mousedown",d);T(c,"resize",d);Pa(this.buttons);if(a)a.onfocus=a.onblur=a.onchange=null;if(b)b.onfocus=b.onblur=b.onchange=null;
for(e in this)this[e]&&e!=="chart"&&(this[e].destroy?this[e].destroy():this[e].nodeType&&Va(this[e])),this[e]=null}};I.prototype.toFixedRange=function(a,b,c,d){var e=this.chart&&this.chart.fixedRange,a=q(c,this.translate(a,!0)),b=q(d,this.translate(b,!0)),c=e&&(b-a)/e;c>0.7&&c<1.3&&(d?a=b-e:b=a+e);isNaN(a)&&(a=b=void 0);return{min:a,max:b}};I.prototype.minFromRange=function(){var a=this.range,b={month:"Month",year:"FullYear"}[a.type],c,d=this.max,e,f,g=function(a,c){var d=new fa(a);d["set"+b](d["get"+
b]()+c);return d.getTime()-a};typeof a==="number"?(c=this.max-a,f=a):c=d+g(d,-a.count);e=q(this.dataMin,Number.MIN_VALUE);isNaN(c)&&(c=e);if(c<=e)c=e,f===void 0&&(f=g(c,a.count)),this.newMax=E(c+f,this.dataMax);isNaN(d)&&(c=void 0);return c};U(Ca.prototype,"init",function(a,b,c){D(this,"init",function(){if(this.options.rangeSelector.enabled)this.rangeSelector=new Ib(this)});a.call(this,b,c)});z.RangeSelector=Ib;Ca.prototype.callbacks.push(function(a){function b(){f=a.xAxis[0].getExtremes();g.render(f.min,
f.max)}function c(){f=a.xAxis[0].getExtremes();isNaN(f.min)||h.render(f.min,f.max)}function d(a){a.triggerOp!=="navigator-drag"&&g.render(a.min,a.max)}function e(a){h.render(a.min,a.max)}var f,g=a.scroller,h=a.rangeSelector;g&&(D(a.xAxis[0],"afterSetExtremes",d),U(a,"drawChartBox",function(a){var c=this.isDirtyBox;a.call(this);c&&b()}),b());h&&(D(a.xAxis[0],"afterSetExtremes",e),D(a,"resize",c),c());D(a,"destroy",function(){g&&T(a.xAxis[0],"afterSetExtremes",d);h&&(T(a,"resize",c),T(a.xAxis[0],"afterSetExtremes",
e))})});z.StockChart=z.stockChart=function(a,b,c){var d=Da(a)||a.nodeName,e=arguments[d?1:0],f=e.series,g,h=q(e.navigator&&e.navigator.enabled,!0)?{startOnTick:!1,endOnTick:!1}:null,i={marker:{enabled:!1,radius:2}},j={shadow:!1,borderWidth:0};e.xAxis=ta(va(e.xAxis||{}),function(a){return C({minPadding:0,maxPadding:0,ordinal:!0,title:{text:null},labels:{overflow:"justify"},showLastLabel:!0},a,{type:"datetime",categories:null},h)});e.yAxis=ta(va(e.yAxis||{}),function(a){g=q(a.opposite,!0);return C({labels:{y:-2},
opposite:g,showLastLabel:!1,title:{text:null}},a)});e.series=null;e=C({chart:{panning:!0,pinchType:"x"},navigator:{enabled:!0},scrollbar:{enabled:!0},rangeSelector:{enabled:!0},title:{text:null,style:{fontSize:"16px"}},tooltip:{shared:!0,crosshairs:!0},legend:{enabled:!1},plotOptions:{line:i,spline:i,area:i,areaspline:i,arearange:i,areasplinerange:i,column:j,columnrange:j,candlestick:j,ohlc:j}},e,{_stock:!0,chart:{inverted:!1}});e.series=f;return d?new Ca(a,e,c):new Ca(e,b)};U(Za.prototype,"init",
function(a,b,c){var d=c.chart.pinchType||"";a.call(this,b,c);this.pinchX=this.pinchHor=d.indexOf("x")!==-1;this.pinchY=this.pinchVert=d.indexOf("y")!==-1;this.hasZoom=this.hasZoom||this.pinchHor||this.pinchVert});U(I.prototype,"autoLabelAlign",function(a){var b=this.chart,c=this.options,b=b._labelPanes=b._labelPanes||{},d=this.options.labels;if(this.chart.options._stock&&this.coll==="yAxis"&&(c=c.top+","+c.height,!b[c]&&d.enabled)){if(d.x===15)d.x=0;if(d.align===void 0)d.align="right";b[c]=1;return"right"}return a.call(this,
[].slice.call(arguments,1))});U(I.prototype,"getPlotLinePath",function(a,b,c,d,e,f){var g=this,h=this.isLinked&&!this.series?this.linkedParent.series:this.series,i=g.chart,j=i.renderer,k=g.left,l=g.top,m,o,p,r,t=[],x=[],u,w;if(g.coll==="colorAxis")return a.apply(this,[].slice.call(arguments,1));x=g.isXAxis?s(g.options.yAxis)?[i.yAxis[g.options.yAxis]]:ta(h,function(a){return a.yAxis}):s(g.options.xAxis)?[i.xAxis[g.options.xAxis]]:ta(h,function(a){return a.xAxis});n(g.isXAxis?i.yAxis:i.xAxis,function(a){if(s(a.options.id)?
a.options.id.indexOf("navigator")===-1:1){var b=a.isXAxis?"yAxis":"xAxis",b=s(a.options[b])?i[b][a.options[b]]:i[b][0];g===b&&x.push(a)}});u=x.length?[]:[g.isXAxis?i.yAxis[0]:i.xAxis[0]];n(x,function(a){sa(a,u)===-1&&u.push(a)});w=q(f,g.translate(b,null,null,d));isNaN(w)||(g.horiz?n(u,function(a){var b;o=a.pos;r=o+a.len;m=p=y(w+g.transB);if(m<k||m>k+g.width)e?m=p=E(v(k,m),k+g.width):b=!0;b||t.push("M",m,o,"L",p,r)}):n(u,function(a){var b;m=a.pos;p=m+a.len;o=r=y(l+g.height-w);if(o<l||o>l+g.height)e?
o=r=E(v(l,o),g.top+g.height):b=!0;b||t.push("M",m,o,"L",p,r)}));return t.length>0?j.crispPolyLine(t,c||1):null});I.prototype.getPlotBandPath=function(a,b){var c=this.getPlotLinePath(b,null,null,!0),d=this.getPlotLinePath(a,null,null,!0),e=[],f;if(d&&c&&d.toString()!==c.toString())for(f=0;f<d.length;f+=6)e.push("M",d[f+1],d[f+2],"L",d[f+4],d[f+5],c[f+4],c[f+5],c[f+1],c[f+2]);else e=null;return e};ya.prototype.crispPolyLine=function(a,b){var c;for(c=0;c<a.length;c+=6)a[c+1]===a[c+4]&&(a[c+1]=a[c+4]=
y(a[c+1])-b%2/2),a[c+2]===a[c+5]&&(a[c+2]=a[c+5]=y(a[c+2])+b%2/2);return a};if(Ya===z.VMLRenderer)mb.prototype.crispPolyLine=ya.prototype.crispPolyLine;U(I.prototype,"hideCrosshair",function(a,b){a.call(this,b);if(this.crossLabel)this.crossLabel=this.crossLabel.hide()});U(I.prototype,"drawCrosshair",function(a,b,c){var d,e;a.call(this,b,c);if(s(this.crosshair.label)&&this.crosshair.label.enabled){var a=this.chart,f=this.options.crosshair.label,g=this.horiz,h=this.opposite,i=this.left,j=this.top,k=
this.crossLabel,l,m=f.format,n="",p=this.options.tickPosition==="inside",r=this.crosshair.snap!==!1;l=g?"center":h?this.labelAlign==="right"?"right":"left":this.labelAlign==="left"?"left":"center";if(!k)k=this.crossLabel=a.renderer.label(null,null,null,f.shape||"callout").attr({align:f.align||l,zIndex:12,fill:f.backgroundColor||this.series[0]&&this.series[0].color||"gray",padding:q(f.padding,8),stroke:f.borderColor||"","stroke-width":f.borderWidth||0,r:q(f.borderRadius,3)}).css(x({color:"white",fontWeight:"normal",
fontSize:"11px",textAlign:"center"},f.style)).add();g?(l=r?c.plotX+i:b.chartX,j+=h?0:this.height):(l=h?this.width+i:0,j=r?c.plotY+j:b.chartY);!m&&!f.formatter&&(this.isDatetimeAxis&&(n="%b %d, %Y"),m="{value"+(n?":"+n:"")+"}");b=r?c[this.isXAxis?"x":"y"]:this.toValue(g?b.chartX:b.chartY);k.attr({text:m?La(m,{value:b}):f.formatter.call(this,b),anchorX:g?l:this.opposite?0:a.chartWidth,anchorY:g?this.opposite?a.chartHeight:0:j,x:l,y:j,visibility:"visible"});b=k.getBBox();if(g){if(p&&!h||!p&&h)j=k.y-
b.height}else j=k.y-b.height/2;g?(d=i-b.x,e=i+this.width-b.x):(d=this.labelAlign==="left"?i:0,e=this.labelAlign==="right"?i+this.width:a.chartWidth);k.translateX<d&&(l+=d-k.translateX);k.translateX+b.width>=e&&(l-=k.translateX+b.width-e);k.attr({x:l,y:j,visibility:"visible"})}});var gc=ia.init,hc=ia.processData,ic=Ha.prototype.tooltipFormatter;ia.init=function(){gc.apply(this,arguments);this.setCompare(this.options.compare)};ia.setCompare=function(a){this.modifyValue=a==="value"||a==="percent"?function(b,
c){var d=this.compareValue;if(b!==t&&(b=a==="value"?b-d:b=100*(b/d)-100,c))c.change=b;return b}:null;if(this.chart.hasRendered)this.isDirty=!0};ia.processData=function(){var a,b=-1,c,d,e,f;hc.apply(this,arguments);if(this.xAxis&&this.processedYData){c=this.processedXData;d=this.processedYData;e=d.length;this.pointArrayMap&&(b=sa(this.pointValKey||"y",this.pointArrayMap));for(a=0;a<e;a++)if(f=b>-1?d[a][b]:d[a],typeof f==="number"&&c[a]>=this.xAxis.min&&f!==0){this.compareValue=f;break}}};U(ia,"getExtremes",
function(a){var b;a.apply(this,[].slice.call(arguments,1));if(this.modifyValue)b=[this.modifyValue(this.dataMin),this.modifyValue(this.dataMax)],this.dataMin=Oa(b),this.dataMax=Ea(b)});I.prototype.setCompare=function(a,b){this.isXAxis||(n(this.series,function(b){b.setCompare(a)}),q(b,!0)&&this.chart.redraw())};Ha.prototype.tooltipFormatter=function(a){a=a.replace("{point.change}",(this.change>0?"+":"")+z.numberFormat(this.change,q(this.series.tooltipOptions.changeDecimals,2)));return ic.apply(this,
[a])};U(Q.prototype,"render",function(a){if(this.chart.options._stock&&this.xAxis)!this.clipBox&&this.animate?(this.clipBox=C(this.chart.clipBox),this.clipBox.width=this.xAxis.len,this.clipBox.height=this.yAxis.len):this.chart[this.sharedClipKey]&&(Ta(this.chart[this.sharedClipKey]),this.chart[this.sharedClipKey].attr({width:this.xAxis.len,height:this.yAxis.len}));a.call(this)});x(z,{Color:wa,Point:Ha,Tick:cb,Renderer:Ya,SVGElement:Z,SVGRenderer:ya,arrayMin:Oa,arrayMax:Ea,charts:$,correctFloat:na,
dateFormat:ma,error:ga,format:La,pathAnim:void 0,getOptions:function(){return N},hasBidiBug:Zb,isTouchDevice:kb,setOptions:function(a){N=C(!0,N,a);Ob();return N},addEvent:D,removeEvent:T,createElement:ea,discardElement:Va,css:F,each:n,map:ta,merge:C,splat:va,stableSort:ob,extendClass:la,pInt:G,svg:ja,canvas:qa,vml:!ja&&!qa,product:"Highstock",version:"4.2.4"});return z});

},{}],3:[function(require,module,exports){
/**
*
* jquery.sparkline.js
*
* v2.3.2
* (c) Splunk, Inc
* Contact: Gareth Watts (gareth@splunk.com)
* http://omnipotent.net/jquery.sparkline/
*
* Generates inline sparkline charts from data supplied either to the method
* or inline in HTML
*
* Compatible with Internet Explorer 6.0+ and modern browsers equipped with the canvas tag
* (Firefox 2.0+, Safari, Opera, etc)
*
* License: New BSD License
*
* Copyright (c) 2012, Splunk Inc.
* All rights reserved.
*
* Redistribution and use in source and binary forms, with or without modification,
* are permitted provided that the following conditions are met:
*
*     * Redistributions of source code must retain the above copyright notice,
*       this list of conditions and the following disclaimer.
*     * Redistributions in binary form must reproduce the above copyright notice,
*       this list of conditions and the following disclaimer in the documentation
*       and/or other materials provided with the distribution.
*     * Neither the name of Splunk Inc nor the names of its contributors may
*       be used to endorse or promote products derived from this software without
*       specific prior written permission.
*
* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY
* EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
* OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT
* SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
* SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT
* OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
* HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
* OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
* SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*
*
* Usage:
*  $(selector).sparkline(values, options)
*
* If values is undefined or set to 'html' then the data values are read from the specified tag:
*   <p>Sparkline: <span class="sparkline">1,4,6,6,8,5,3,5</span></p>
*   $('.sparkline').sparkline();
* There must be no spaces in the enclosed data set
*
* Otherwise values must be an array of numbers or null values
*    <p>Sparkline: <span id="sparkline1">This text replaced if the browser is compatible</span></p>
*    $('#sparkline1').sparkline([1,4,6,6,8,5,3,5])
*    $('#sparkline2').sparkline([1,4,6,null,null,5,3,5])
*
* Values can also be specified in an HTML comment, or as a values attribute:
*    <p>Sparkline: <span class="sparkline"><!--1,4,6,6,8,5,3,5 --></span></p>
*    <p>Sparkline: <span class="sparkline" values="1,4,6,6,8,5,3,5"></span></p>
*    $('.sparkline').sparkline();
*
* For line charts, x values can also be specified:
*   <p>Sparkline: <span class="sparkline">1:1,2.7:4,3.4:6,5:6,6:8,8.7:5,9:3,10:5</span></p>
*    $('#sparkline1').sparkline([ [1,1], [2.7,4], [3.4,6], [5,6], [6,8], [8.7,5], [9,3], [10,5] ])
*
* By default, options should be passed in as the second argument to the sparkline function:
*   $('.sparkline').sparkline([1,2,3,4], {type: 'bar'})
*
* Options can also be set by passing them on the tag itself.  This feature is disabled by default though
* as there's a slight performance overhead:
*   $('.sparkline').sparkline([1,2,3,4], {enableTagOptions: true})
*   <p>Sparkline: <span class="sparkline" sparkType="bar" sparkBarColor="red">loading</span></p>
* Prefix all options supplied as tag attribute with "spark" (configurable by setting tagOptionsPrefix)
*
* Supported options:
*   lineColor - Color of the line used for the chart
*   fillColor - Color used to fill in the chart - Set to '' or false for a transparent chart
*   width - Width of the chart - Defaults to 3 times the number of values in pixels
*   height - Height of the chart - Defaults to the height of the containing element
*   chartRangeMin - Specify the minimum value to use for the Y range of the chart - Defaults to the minimum value supplied
*   chartRangeMax - Specify the maximum value to use for the Y range of the chart - Defaults to the maximum value supplied
*   chartRangeClip - Clip out of range values to the max/min specified by chartRangeMin and chartRangeMax
*   chartRangeMinX - Specify the minimum value to use for the X range of the chart - Defaults to the minimum value supplied
*   chartRangeMaxX - Specify the maximum value to use for the X range of the chart - Defaults to the maximum value supplied
*   composite - If true then don't erase any existing chart attached to the tag, but draw
*           another chart over the top - Note that width and height are ignored if an
*           existing chart is detected.
*   tagValuesAttribute - Name of tag attribute to check for data values - Defaults to 'values'
*   enableTagOptions - Whether to check tags for sparkline options
*   tagOptionsPrefix - Prefix used for options supplied as tag attributes - Defaults to 'spark'
*   disableHiddenCheck - If set to true, then the plugin will assume that charts will never be drawn into a
*           hidden dom element, avoding a browser reflow
*   disableInteraction - If set to true then all mouseover/click interaction behaviour will be disabled,
*       making the plugin perform much like it did in 1.x
*   disableTooltips - If set to true then tooltips will be disabled - Defaults to false (tooltips enabled)
*   disableHighlight - If set to true then highlighting of selected chart elements on mouseover will be disabled
*       defaults to false (highlights enabled)
*   highlightLighten - Factor to lighten/darken highlighted chart values by - Defaults to 1.4 for a 40% increase
*   tooltipContainer - Specify which DOM element the tooltip should be rendered into - defaults to document.body
*   tooltipClassname - Optional CSS classname to apply to tooltips - If not specified then a default style will be applied
*   tooltipOffsetX - How many pixels away from the mouse pointer to render the tooltip on the X axis
*   tooltipOffsetY - How many pixels away from the mouse pointer to render the tooltip on the r axis
*   tooltipFormatter  - Optional callback that allows you to override the HTML displayed in the tooltip
*       callback is given arguments of (sparkline, options, fields)
*   tooltipChartTitle - If specified then the tooltip uses the string specified by this setting as a title
*   tooltipFormat - A format string or SPFormat object  (or an array thereof for multiple entries)
*       to control the format of the tooltip
*   tooltipPrefix - A string to prepend to each field displayed in a tooltip
*   tooltipSuffix - A string to append to each field displayed in a tooltip
*   tooltipSkipNull - If true then null values will not have a tooltip displayed (defaults to true)
*   tooltipValueLookups - An object or range map to map field values to tooltip strings
*       (eg. to map -1 to "Lost", 0 to "Draw", and 1 to "Win")
*   numberFormatter - Optional callback for formatting numbers in tooltips
*   numberDigitGroupSep - Character to use for group separator in numbers "1,234" - Defaults to ","
*   numberDecimalMark - Character to use for the decimal point when formatting numbers - Defaults to "."
*   numberDigitGroupCount - Number of digits between group separator - Defaults to 3
*
* There are 7 types of sparkline, selected by supplying a "type" option of 'line' (default),
* 'bar', 'tristate', 'bullet', 'discrete', 'pie' or 'box'
*    line - Line chart.  Options:
*       spotColor - Set to '' to not end each line in a circular spot
*       minSpotColor - If set, color of spot at minimum value
*       maxSpotColor - If set, color of spot at maximum value
*       spotRadius - Radius in pixels
*       lineWidth - Width of line in pixels
*       normalRangeMin
*       normalRangeMax - If set draws a filled horizontal bar between these two values marking the "normal"
*                      or expected range of values
*       normalRangeColor - Color to use for the above bar
*       drawNormalOnTop - Draw the normal range above the chart fill color if true
*       defaultPixelsPerValue - Defaults to 3 pixels of width for each value in the chart
*       highlightSpotColor - The color to use for drawing a highlight spot on mouseover - Set to null to disable
*       highlightLineColor - The color to use for drawing a highlight line on mouseover - Set to null to disable
*       valueSpots - Specify which points to draw spots on, and in which color.  Accepts a range map
*
*   bar - Bar chart.  Options:
*       barColor - Color of bars for postive values
*       negBarColor - Color of bars for negative values
*       zeroColor - Color of bars with zero values
*       nullColor - Color of bars with null values - Defaults to omitting the bar entirely
*       barWidth - Width of bars in pixels
*       colorMap - Optional mappnig of values to colors to override the *BarColor values above
*                  can be an Array of values to control the color of individual bars or a range map
*                  to specify colors for individual ranges of values
*       barSpacing - Gap between bars in pixels
*       zeroAxis - Centers the y-axis around zero if true
*
*   tristate - Charts values of win (>0), lose (<0) or draw (=0)
*       posBarColor - Color of win values
*       negBarColor - Color of lose values
*       zeroBarColor - Color of draw values
*       barWidth - Width of bars in pixels
*       barSpacing - Gap between bars in pixels
*       colorMap - Optional mappnig of values to colors to override the *BarColor values above
*                  can be an Array of values to control the color of individual bars or a range map
*                  to specify colors for individual ranges of values
*
*   discrete - Options:
*       lineHeight - Height of each line in pixels - Defaults to 30% of the graph height
*       thesholdValue - Values less than this value will be drawn using thresholdColor instead of lineColor
*       thresholdColor
*
*   bullet - Values for bullet graphs msut be in the order: target, performance, range1, range2, range3, ...
*       options:
*       targetColor - The color of the vertical target marker
*       targetWidth - The width of the target marker in pixels
*       performanceColor - The color of the performance measure horizontal bar
*       rangeColors - Colors to use for each qualitative range background color
*
*   pie - Pie chart. Options:
*       sliceColors - An array of colors to use for pie slices
*       offset - Angle in degrees to offset the first slice - Try -90 or +90
*       borderWidth - Width of border to draw around the pie chart, in pixels - Defaults to 0 (no border)
*       borderColor - Color to use for the pie chart border - Defaults to #000
*
*   box - Box plot. Options:
*       raw - Set to true to supply pre-computed plot points as values
*             values should be: low_outlier, low_whisker, q1, median, q3, high_whisker, high_outlier
*             When set to false you can supply any number of values and the box plot will
*             be computed for you.  Default is false.
*       showOutliers - Set to true (default) to display outliers as circles
*       outlierIQR - Interquartile range used to determine outliers.  Default 1.5
*       boxLineColor - Outline color of the box
*       boxFillColor - Fill color for the box
*       whiskerColor - Line color used for whiskers
*       outlierLineColor - Outline color of outlier circles
*       outlierFillColor - Fill color of the outlier circles
*       spotRadius - Radius of outlier circles
*       medianColor - Line color of the median line
*       target - Draw a target cross hair at the supplied value (default undefined)
*
*
*
*   Examples:
*   $('#sparkline1').sparkline(myvalues, { lineColor: '#f00', fillColor: false });
*   $('.barsparks').sparkline('html', { type:'bar', height:'40px', barWidth:5 });
*   $('#tristate').sparkline([1,1,-1,1,0,0,-1], { type:'tristate' }):
*   $('#discrete').sparkline([1,3,4,5,5,3,4,5], { type:'discrete' });
*   $('#bullet').sparkline([10,12,12,9,7], { type:'bullet' });
*   $('#pie').sparkline([1,1,2], { type:'pie' });
*/

/*jslint regexp: true, browser: true, jquery: true, white: true, nomen: false, plusplus: false, maxerr: 500, indent: 4 */

(function(document, Math, undefined) { // performance/minified-size optimization
(function(factory) {
    if(typeof define === 'function' && define.amd) {
        define(['jquery'], factory);
    } else if (jQuery && !jQuery.fn.sparkline) {
        factory(jQuery);
    }
}
(function($) {
    'use strict';

    var UNSET_OPTION = {},
        getDefaults, createClass, SPFormat, clipval, quartile, normalizeValue, normalizeValues,
        remove, isNumber, all, sum, addCSS, ensureArray, formatNumber, RangeMap,
        MouseHandler, Tooltip, barHighlightMixin,
        line, bar, tristate, discrete, bullet, pie, box, defaultStyles, initStyles,
        VShape, VCanvas_base, VCanvas_canvas, VCanvas_vml, pending, shapeCount = 0;

    /**
     * Default configuration settings
     */
    getDefaults = function () {
        return {
            // Settings common to most/all chart types
            common: {
                type: 'line',
                lineColor: '#00f',
                fillColor: '#cdf',
                defaultPixelsPerValue: 3,
                width: 'auto',
                height: 'auto',
                composite: false,
                tagValuesAttribute: 'values',
                tagOptionsPrefix: 'spark',
                enableTagOptions: false,
                enableHighlight: true,
                highlightLighten: 1.4,
                tooltipSkipNull: true,
                tooltipPrefix: '',
                tooltipSuffix: '',
                disableHiddenCheck: false,
                numberFormatter: false,
                numberDigitGroupCount: 3,
                numberDigitGroupSep: ',',
                numberDecimalMark: '.',
                disableTooltips: false,
                disableInteraction: false
            },
            // Defaults for line charts
            line: {
                spotColor: '#f80',
                highlightSpotColor: '#5f5',
                highlightLineColor: '#f22',
                spotRadius: 1.5,
                minSpotColor: '#f80',
                maxSpotColor: '#f80',
                lineWidth: 1,
                normalRangeMin: undefined,
                normalRangeMax: undefined,
                normalRangeColor: '#ccc',
                drawNormalOnTop: false,
                chartRangeMin: undefined,
                chartRangeMax: undefined,
                chartRangeMinX: undefined,
                chartRangeMaxX: undefined,
                tooltipFormat: new SPFormat('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{y}}{{suffix}}')
            },
            // Defaults for bar charts
            bar: {
                barColor: '#3366cc',
                negBarColor: '#f44',
                stackedBarColor: ['#3366cc', '#dc3912', '#ff9900', '#109618', '#66aa00',
                    '#dd4477', '#0099c6', '#990099'],
                zeroColor: undefined,
                nullColor: undefined,
                zeroAxis: true,
                barWidth: 4,
                barSpacing: 1,
                chartRangeMax: undefined,
                chartRangeMin: undefined,
                chartRangeClip: false,
                colorMap: undefined,
                tooltipFormat: new SPFormat('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{value}}{{suffix}}')
            },
            // Defaults for tristate charts
            tristate: {
                barWidth: 4,
                barSpacing: 1,
                posBarColor: '#6f6',
                negBarColor: '#f44',
                zeroBarColor: '#999',
                colorMap: {},
                tooltipFormat: new SPFormat('<span style="color: {{color}}">&#9679;</span> {{value:map}}'),
                tooltipValueLookups: { map: { '-1': 'Loss', '0': 'Draw', '1': 'Win' } }
            },
            // Defaults for discrete charts
            discrete: {
                lineHeight: 'auto',
                thresholdColor: undefined,
                thresholdValue: 0,
                chartRangeMax: undefined,
                chartRangeMin: undefined,
                chartRangeClip: false,
                tooltipFormat: new SPFormat('{{prefix}}{{value}}{{suffix}}')
            },
            // Defaults for bullet charts
            bullet: {
                targetColor: '#f33',
                targetWidth: 3, // width of the target bar in pixels
                performanceColor: '#33f',
                rangeColors: ['#d3dafe', '#a8b6ff', '#7f94ff'],
                base: undefined, // set this to a number to change the base start number
                tooltipFormat: new SPFormat('{{fieldkey:fields}} - {{value}}'),
                tooltipValueLookups: { fields: {r: 'Range', p: 'Performance', t: 'Target'} }
            },
            // Defaults for pie charts
            pie: {
                offset: 0,
                sliceColors: ['#3366cc', '#dc3912', '#ff9900', '#109618', '#66aa00',
                    '#dd4477', '#0099c6', '#990099'],
                borderWidth: 0,
                borderColor: '#000',
                tooltipFormat: new SPFormat('<span style="color: {{color}}">&#9679;</span> {{value}} ({{percent.1}}%)')
            },
            // Defaults for box plots
            box: {
                raw: false,
                boxLineColor: '#000',
                boxFillColor: '#cdf',
                whiskerColor: '#000',
                outlierLineColor: '#333',
                outlierFillColor: '#fff',
                medianColor: '#f00',
                showOutliers: true,
                outlierIQR: 1.5,
                spotRadius: 1.5,
                target: undefined,
                targetColor: '#4a2',
                chartRangeMax: undefined,
                chartRangeMin: undefined,
                tooltipFormat: new SPFormat('{{field:fields}}: {{value}}'),
                tooltipFormatFieldlistKey: 'field',
                tooltipValueLookups: { fields: { lq: 'Lower Quartile', med: 'Median',
                    uq: 'Upper Quartile', lo: 'Left Outlier', ro: 'Right Outlier',
                    lw: 'Left Whisker', rw: 'Right Whisker'} }
            }
        };
    };

    // You can have tooltips use a css class other than jqstooltip by specifying tooltipClassname
    defaultStyles = '.jqstooltip { ' +
            'position: absolute;' +
            'left: 0px;' +
            'top: 0px;' +
            'visibility: hidden;' +
            'background: rgb(0, 0, 0) transparent;' +
            'background-color: rgba(0,0,0,0.6);' +
            'filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000);' +
            '-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000)";' +
            'color: white;' +
            'font: 10px arial, san serif;' +
            'text-align: left;' +
            'white-space: nowrap;' +
            'padding: 5px;' +
            'border: 1px solid white;' +
            'box-sizing: content-box;' +
            'z-index: 10000;' +
            '}' +
            '.jqsfield { ' +
            'color: white;' +
            'font: 10px arial, san serif;' +
            'text-align: left;' +
            '}';

    /**
     * Utilities
     */

    createClass = function (/* [baseclass, [mixin, ...]], definition */) {
        var Class, args;
        Class = function () {
            this.init.apply(this, arguments);
        };
        if (arguments.length > 1) {
            if (arguments[0]) {
                Class.prototype = $.extend(new arguments[0](), arguments[arguments.length - 1]);
                Class._super = arguments[0].prototype;
            } else {
                Class.prototype = arguments[arguments.length - 1];
            }
            if (arguments.length > 2) {
                args = Array.prototype.slice.call(arguments, 1, -1);
                args.unshift(Class.prototype);
                $.extend.apply($, args);
            }
        } else {
            Class.prototype = arguments[0];
        }
        Class.prototype.cls = Class;
        return Class;
    };

    /**
     * Wraps a format string for tooltips
     * {{x}}
     * {{x.2}
     * {{x:months}}
     */
    $.SPFormatClass = SPFormat = createClass({
        fre: /\{\{([\w.]+?)(:(.+?))?\}\}/g,
        precre: /(\w+)\.(\d+)/,

        init: function (format, fclass) {
            this.format = format;
            this.fclass = fclass;
        },

        render: function (fieldset, lookups, options) {
            var self = this,
                fields = fieldset,
                match, token, lookupkey, fieldvalue, prec;
            return this.format.replace(this.fre, function () {
                var lookup;
                token = arguments[1];
                lookupkey = arguments[3];
                match = self.precre.exec(token);
                if (match) {
                    prec = match[2];
                    token = match[1];
                } else {
                    prec = false;
                }
                fieldvalue = fields[token];
                if (fieldvalue === undefined) {
                    return '';
                }
                if (lookupkey && lookups && lookups[lookupkey]) {
                    lookup = lookups[lookupkey];
                    if (lookup.get) { // RangeMap
                        return lookups[lookupkey].get(fieldvalue) || fieldvalue;
                    } else {
                        return lookups[lookupkey][fieldvalue] || fieldvalue;
                    }
                }
                if (isNumber(fieldvalue)) {
                    if (options.get('numberFormatter')) {
                        fieldvalue = options.get('numberFormatter')(fieldvalue);
                    } else {
                        fieldvalue = formatNumber(fieldvalue, prec,
                            options.get('numberDigitGroupCount'),
                            options.get('numberDigitGroupSep'),
                            options.get('numberDecimalMark'));
                    }
                }
                return fieldvalue;
            });
        }
    });

    // convience method to avoid needing the new operator
    $.spformat = function(format, fclass) {
        return new SPFormat(format, fclass);
    };

    clipval = function (val, min, max) {
        if (val < min) {
            return min;
        }
        if (val > max) {
            return max;
        }
        return val;
    };

    quartile = function (values, q) {
        var vl;
        if (q === 2) {
            vl = Math.floor(values.length / 2);
            return values.length % 2 ? values[vl] : (values[vl-1] + values[vl]) / 2;
        } else {
            if (values.length % 2 ) { // odd
                vl = (values.length * q + q) / 4;
                return vl % 1 ? (values[Math.floor(vl)] + values[Math.floor(vl) - 1]) / 2 : values[vl-1];
            } else { //even
                vl = (values.length * q + 2) / 4;
                return vl % 1 ? (values[Math.floor(vl)] + values[Math.floor(vl) - 1]) / 2 :  values[vl-1];

            }
        }
    };

    normalizeValue = function (val) {
        var nf;
        switch (val) {
            case 'undefined':
                val = undefined;
                break;
            case 'null':
                val = null;
                break;
            case 'true':
                val = true;
                break;
            case 'false':
                val = false;
                break;
            default:
                nf = parseFloat(val);
                if (val == nf) {
                    val = nf;
                }
        }
        return val;
    };

    normalizeValues = function (vals) {
        var i, result = [];
        for (i = vals.length; i--;) {
            result[i] = normalizeValue(vals[i]);
        }
        return result;
    };

    remove = function (vals, filter) {
        var i, vl, result = [];
        for (i = 0, vl = vals.length; i < vl; i++) {
            if (vals[i] !== filter) {
                result.push(vals[i]);
            }
        }
        return result;
    };

    isNumber = function (num) {
        return !isNaN(parseFloat(num)) && isFinite(num);
    };

    formatNumber = function (num, prec, groupsize, groupsep, decsep) {
        var p, i;
        num = (prec === false ? parseFloat(num).toString() : num.toFixed(prec)).split('');
        p = (p = $.inArray('.', num)) < 0 ? num.length : p;
        if (p < num.length) {
            num[p] = decsep;
        }
        for (i = p - groupsize; i > 0; i -= groupsize) {
            num.splice(i, 0, groupsep);
        }
        return num.join('');
    };

    // determine if all values of an array match a value
    // returns true if the array is empty
    all = function (val, arr, ignoreNull) {
        var i;
        for (i = arr.length; i--; ) {
            if (ignoreNull && arr[i] === null) continue;
            if (arr[i] !== val) {
                return false;
            }
        }
        return true;
    };

    // sums the numeric values in an array, ignoring other values
    sum = function (vals) {
        var total = 0, i;
        for (i = vals.length; i--;) {
            total += typeof vals[i] === 'number' ? vals[i] : 0;
        }
        return total;
    };

    ensureArray = function (val) {
        return $.isArray(val) ? val : [val];
    };

    // http://paulirish.com/2008/bookmarklet-inject-new-css-rules/
    addCSS = function(css) {
        var tag, iefail;
        if (document.createStyleSheet) {
            try {
                document.createStyleSheet().cssText = css;
                return;
            } catch (e) {
                // IE <= 9 maxes out at 31 stylesheets; inject into page instead.
                iefail = true;
            }
        }
        tag = document.createElement('style');
        tag.type = 'text/css';
        document.getElementsByTagName('head')[0].appendChild(tag);
        if (iefail) {
            document.styleSheets[document.styleSheets.length - 1].cssText = css;
        } else {
            tag[(typeof document.body.style.WebkitAppearance == 'string') /* webkit only */ ? 'innerText' : 'innerHTML'] = css;
        }
    };

    // Provide a cross-browser interface to a few simple drawing primitives
    $.fn.simpledraw = function (width, height, useExisting, interact) {
        var target, mhandler;
        if (useExisting && (target = this.data('_jqs_vcanvas'))) {
            return target;
        }

        if ($.fn.sparkline.canvas === false) {
            // We've already determined that neither Canvas nor VML are available
            return false;

        } else if ($.fn.sparkline.canvas === undefined) {
            // No function defined yet -- need to see if we support Canvas or VML
            var el = document.createElement('canvas');
            if (!!(el.getContext && el.getContext('2d'))) {
                // Canvas is available
                $.fn.sparkline.canvas = function(width, height, target, interact) {
                    return new VCanvas_canvas(width, height, target, interact);
                };
            } else if (document.namespaces && !document.namespaces.v) {
                // VML is available
                document.namespaces.add('v', 'urn:schemas-microsoft-com:vml', '#default#VML');
                $.fn.sparkline.canvas = function(width, height, target, interact) {
                    return new VCanvas_vml(width, height, target);
                };
            } else {
                // Neither Canvas nor VML are available
                $.fn.sparkline.canvas = false;
                return false;
            }
        }

        if (width === undefined) {
            width = $(this).innerWidth();
        }
        if (height === undefined) {
            height = $(this).innerHeight();
        }

        target = $.fn.sparkline.canvas(width, height, this, interact);

        mhandler = $(this).data('_jqs_mhandler');
        if (mhandler) {
            mhandler.registerCanvas(target);
        }
        return target;
    };

    $.fn.cleardraw = function () {
        var target = this.data('_jqs_vcanvas');
        if (target) {
            target.reset();
        }
    };

    $.RangeMapClass = RangeMap = createClass({
        init: function (map) {
            var key, range, rangelist = [];
            for (key in map) {
                if (map.hasOwnProperty(key) && typeof key === 'string' && key.indexOf(':') > -1) {
                    range = key.split(':');
                    range[0] = range[0].length === 0 ? -Infinity : parseFloat(range[0]);
                    range[1] = range[1].length === 0 ? Infinity : parseFloat(range[1]);
                    range[2] = map[key];
                    rangelist.push(range);
                }
            }
            this.map = map;
            this.rangelist = rangelist || false;
        },

        get: function (value) {
            var rangelist = this.rangelist,
                i, range, result;
            if ((result = this.map[value]) !== undefined) {
                return result;
            }
            if (rangelist) {
                for (i = rangelist.length; i--;) {
                    range = rangelist[i];
                    if (range[0] <= value && range[1] >= value) {
                        return range[2];
                    }
                }
            }
            return undefined;
        }
    });

    // Convenience function
    $.range_map = function(map) {
        return new RangeMap(map);
    };

    MouseHandler = createClass({
        init: function (el, options) {
            var $el = $(el);
            this.$el = $el;
            this.options = options;
            this.currentPageX = 0;
            this.currentPageY = 0;
            this.el = el;
            this.splist = [];
            this.tooltip = null;
            this.over = false;
            this.displayTooltips = !options.get('disableTooltips');
            this.highlightEnabled = !options.get('disableHighlight');
        },

        registerSparkline: function (sp) {
            this.splist.push(sp);
            if (this.over) {
                this.updateDisplay();
            }
        },

        registerCanvas: function (canvas) {
            var $canvas = $(canvas.canvas);
            this.canvas = canvas;
            this.$canvas = $canvas;
            $canvas.mouseenter($.proxy(this.mouseenter, this));
            $canvas.mouseleave($.proxy(this.mouseleave, this));
            $canvas.click($.proxy(this.mouseclick, this));
        },

        reset: function (removeTooltip) {
            this.splist = [];
            if (this.tooltip && removeTooltip) {
                this.tooltip.remove();
                this.tooltip = undefined;
            }
        },

        mouseclick: function (e) {
            var clickEvent = $.Event('sparklineClick');
            clickEvent.originalEvent = e;
            clickEvent.sparklines = this.splist;
            this.$el.trigger(clickEvent);
        },

        mouseenter: function (e) {
            $(document.body).unbind('mousemove.jqs');
            $(document.body).bind('mousemove.jqs', $.proxy(this.mousemove, this));
            this.over = true;
            this.currentPageX = e.pageX;
            this.currentPageY = e.pageY;
            this.currentEl = e.target;
            if (!this.tooltip && this.displayTooltips) {
                this.tooltip = new Tooltip(this.options);
                this.tooltip.updatePosition(e.pageX, e.pageY);
            }
            this.updateDisplay();
        },

        mouseleave: function () {
            $(document.body).unbind('mousemove.jqs');
            var splist = this.splist,
                 spcount = splist.length,
                 needsRefresh = false,
                 sp, i;
            this.over = false;
            this.currentEl = null;

            if (this.tooltip) {
                this.tooltip.remove();
                this.tooltip = null;
            }

            for (i = 0; i < spcount; i++) {
                sp = splist[i];
                if (sp.clearRegionHighlight()) {
                    needsRefresh = true;
                }
            }

            if (needsRefresh) {
                this.canvas.render();
            }
        },

        mousemove: function (e) {
            this.currentPageX = e.pageX;
            this.currentPageY = e.pageY;
            this.currentEl = e.target;
            if (this.tooltip) {
                this.tooltip.updatePosition(e.pageX, e.pageY);
            }
            this.updateDisplay();
        },

        updateDisplay: function () {
            var splist = this.splist,
                 spcount = splist.length,
                 needsRefresh = false,
                 offset = this.$canvas.offset(),
                 localX = this.currentPageX - offset.left,
                 localY = this.currentPageY - offset.top,
                 tooltiphtml, sp, i, result, changeEvent;
            if (!this.over) {
                return;
            }
            for (i = 0; i < spcount; i++) {
                sp = splist[i];
                result = sp.setRegionHighlight(this.currentEl, localX, localY);
                if (result) {
                    needsRefresh = true;
                }
            }
            if (needsRefresh) {
                changeEvent = $.Event('sparklineRegionChange');
                changeEvent.sparklines = this.splist;
                this.$el.trigger(changeEvent);
                if (this.tooltip) {
                    tooltiphtml = '';
                    for (i = 0; i < spcount; i++) {
                        sp = splist[i];
                        tooltiphtml += sp.getCurrentRegionTooltip();
                    }
                    this.tooltip.setContent(tooltiphtml);
                }
                if (!this.disableHighlight) {
                    this.canvas.render();
                }
            }
            if (result === null) {
                this.mouseleave();
            }
        }
    });


    Tooltip = createClass({
        sizeStyle: 'position: static !important;' +
            'display: block !important;' +
            'visibility: hidden !important;' +
            'float: left !important;',

        init: function (options) {
            var tooltipClassname = options.get('tooltipClassname', 'jqstooltip'),
                sizetipStyle = this.sizeStyle,
                offset;
            this.container = options.get('tooltipContainer') || document.body;
            this.tooltipOffsetX = options.get('tooltipOffsetX', 10);
            this.tooltipOffsetY = options.get('tooltipOffsetY', 12);
            // remove any previous lingering tooltip
            $('#jqssizetip').remove();
            $('#jqstooltip').remove();
            this.sizetip = $('<div/>', {
                id: 'jqssizetip',
                style: sizetipStyle,
                'class': tooltipClassname
            });
            this.tooltip = $('<div/>', {
                id: 'jqstooltip',
                'class': tooltipClassname
            }).appendTo(this.container);
            // account for the container's location
            offset = this.tooltip.offset();
            this.offsetLeft = offset.left;
            this.offsetTop = offset.top;
            this.hidden = true;
            $(window).unbind('resize.jqs scroll.jqs');
            $(window).bind('resize.jqs scroll.jqs', $.proxy(this.updateWindowDims, this));
            this.updateWindowDims();
        },

        updateWindowDims: function () {
            this.scrollTop = $(window).scrollTop();
            this.scrollLeft = $(window).scrollLeft();
            this.scrollRight = this.scrollLeft + $(window).width();
            this.updatePosition();
        },

        getSize: function (content) {
            this.sizetip.html(content).appendTo(this.container);
            this.width = this.sizetip.width() + 1;
            this.height = this.sizetip.height();
            this.sizetip.remove();
        },

        setContent: function (content) {
            if (!content) {
                this.tooltip.css('visibility', 'hidden');
                this.hidden = true;
                return;
            }
            this.getSize(content);
            this.tooltip.html(content)
                .css({
                    'width': this.width,
                    'height': this.height,
                    'visibility': 'visible'
                });
            if (this.hidden) {
                this.hidden = false;
                this.updatePosition();
            }
        },

        updatePosition: function (x, y) {
            if (x === undefined) {
                if (this.mousex === undefined) {
                    return;
                }
                x = this.mousex - this.offsetLeft;
                y = this.mousey - this.offsetTop;

            } else {
                this.mousex = x = x - this.offsetLeft;
                this.mousey = y = y - this.offsetTop;
            }
            if (!this.height || !this.width || this.hidden) {
                return;
            }

            y -= this.height + this.tooltipOffsetY;
            x += this.tooltipOffsetX;

            if (y < this.scrollTop) {
                y = this.scrollTop;
            }
            if (x < this.scrollLeft) {
                x = this.scrollLeft;
            } else if (x + this.width > this.scrollRight) {
                x = this.scrollRight - this.width;
            }

            this.tooltip.css({
                'left': x,
                'top': y
            });
        },

        remove: function () {
            this.tooltip.remove();
            this.sizetip.remove();
            this.sizetip = this.tooltip = undefined;
            $(window).unbind('resize.jqs scroll.jqs');
        }
    });

    initStyles = function() {
        addCSS(defaultStyles);
    };

    $(initStyles);

    pending = [];
    $.fn.sparkline = function (userValues, userOptions) {
        return this.each(function () {
            var options = new $.fn.sparkline.options(this, userOptions),
                 $this = $(this),
                 render, i;
            render = function () {
                var values, width, height, tmp, mhandler, sp, vals;
                if (userValues === 'html' || userValues === undefined) {
                    vals = this.getAttribute(options.get('tagValuesAttribute'));
                    if (vals === undefined || vals === null) {
                        vals = $this.html();
                    }
                    values = vals.replace(/(^\s*<!--)|(-->\s*$)|\s+/g, '').split(',');
                } else {
                    values = userValues;
                }

                width = options.get('width') === 'auto' ? values.length * options.get('defaultPixelsPerValue') : options.get('width');
                if (options.get('height') === 'auto') {
                    if (!options.get('composite') || !$.data(this, '_jqs_vcanvas')) {
                        // must be a better way to get the line height
                        tmp = document.createElement('span');
                        tmp.innerHTML = 'a';
                        $this.html(tmp);
                        height = $(tmp).innerHeight() || $(tmp).height();
                        $(tmp).remove();
                        tmp = null;
                    }
                } else {
                    height = options.get('height');
                }

                if (!options.get('disableInteraction')) {
                    mhandler = $.data(this, '_jqs_mhandler');
                    if (!mhandler) {
                        mhandler = new MouseHandler(this, options);
                        $.data(this, '_jqs_mhandler', mhandler);
                    } else if (!options.get('composite')) {
                        mhandler.reset();
                    }
                } else {
                    mhandler = false;
                }

                if (options.get('composite') && !$.data(this, '_jqs_vcanvas')) {
                    if (!$.data(this, '_jqs_errnotify')) {
                        alert('Attempted to attach a composite sparkline to an element with no existing sparkline');
                        $.data(this, '_jqs_errnotify', true);
                    }
                    return;
                }

                sp = new $.fn.sparkline[options.get('type')](this, values, options, width, height);

                sp.render();

                if (mhandler) {
                    mhandler.registerSparkline(sp);
                }
            };
            if (($(this).html() && !options.get('disableHiddenCheck') && $(this).is(':hidden')) || !$(this).parents('body').length) {
                if (!options.get('composite') && $.data(this, '_jqs_pending')) {
                    // remove any existing references to the element
                    for (i = pending.length; i; i--) {
                        if (pending[i - 1][0] == this) {
                            pending.splice(i - 1, 1);
                        }
                    }
                }
                pending.push([this, render]);
                $.data(this, '_jqs_pending', true);
            } else {
                render.call(this);
            }
        });
    };

    $.fn.sparkline.defaults = getDefaults();


    $.sparkline_display_visible = function () {
        var el, i, pl;
        var done = [];
        for (i = 0, pl = pending.length; i < pl; i++) {
            el = pending[i][0];
            if ($(el).is(':visible') && !$(el).parents().is(':hidden')) {
                pending[i][1].call(el);
                $.data(pending[i][0], '_jqs_pending', false);
                done.push(i);
            } else if (!$(el).closest('html').length && !$.data(el, '_jqs_pending')) {
                // element has been inserted and removed from the DOM
                // If it was not yet inserted into the dom then the .data request
                // will return true.
                // removing from the dom causes the data to be removed.
                $.data(pending[i][0], '_jqs_pending', false);
                done.push(i);
            }
        }
        for (i = done.length; i; i--) {
            pending.splice(done[i - 1], 1);
        }
    };


    /**
     * User option handler
     */
    $.fn.sparkline.options = createClass({
        init: function (tag, userOptions) {
            var extendedOptions, defaults, base, tagOptionType;
            this.userOptions = userOptions = userOptions || {};
            this.tag = tag;
            this.tagValCache = {};
            defaults = $.fn.sparkline.defaults;
            base = defaults.common;
            this.tagOptionsPrefix = userOptions.enableTagOptions && (userOptions.tagOptionsPrefix || base.tagOptionsPrefix);

            tagOptionType = this.getTagSetting('type');
            if (tagOptionType === UNSET_OPTION) {
                extendedOptions = defaults[userOptions.type || base.type];
            } else {
                extendedOptions = defaults[tagOptionType];
            }
            this.mergedOptions = $.extend({}, base, extendedOptions, userOptions);
        },


        getTagSetting: function (key) {
            var prefix = this.tagOptionsPrefix,
                val, i, pairs, keyval;
            if (prefix === false || prefix === undefined) {
                return UNSET_OPTION;
            }
            if (this.tagValCache.hasOwnProperty(key)) {
                val = this.tagValCache.key;
            } else {
                val = this.tag.getAttribute(prefix + key);
                if (val === undefined || val === null) {
                    val = UNSET_OPTION;
                } else if (val.substr(0, 1) === '[') {
                    val = val.substr(1, val.length - 2).split(',');
                    for (i = val.length; i--;) {
                        val[i] = normalizeValue(val[i].replace(/(^\s*)|(\s*$)/g, ''));
                    }
                } else if (val.substr(0, 1) === '{') {
                    pairs = val.substr(1, val.length - 2).split(',');
                    val = {};
                    for (i = pairs.length; i--;) {
                        keyval = pairs[i].split(':', 2);
                        val[keyval[0].replace(/(^\s*)|(\s*$)/g, '')] = normalizeValue(keyval[1].replace(/(^\s*)|(\s*$)/g, ''));
                    }
                } else {
                    val = normalizeValue(val);
                }
                this.tagValCache.key = val;
            }
            return val;
        },

        get: function (key, defaultval) {
            var tagOption = this.getTagSetting(key),
                result;
            if (tagOption !== UNSET_OPTION) {
                return tagOption;
            }
            return (result = this.mergedOptions[key]) === undefined ? defaultval : result;
        }
    });


    $.fn.sparkline._base = createClass({
        disabled: false,

        init: function (el, values, options, width, height) {
            this.el = el;
            this.$el = $(el);
            this.values = values;
            this.options = options;
            this.width = width;
            this.height = height;
            this.currentRegion = undefined;
        },

        /**
         * Setup the canvas
         */
        initTarget: function () {
            var interactive = !this.options.get('disableInteraction');
            if (!(this.target = this.$el.simpledraw(this.width, this.height, this.options.get('composite'), interactive))) {
                this.disabled = true;
            } else {
                this.canvasWidth = this.target.pixelWidth;
                this.canvasHeight = this.target.pixelHeight;
            }
        },

        /**
         * Actually render the chart to the canvas
         */
        render: function () {
            if (this.disabled) {
                this.el.innerHTML = '';
                return false;
            }
            return true;
        },

        /**
         * Return a region id for a given x/y co-ordinate
         */
        getRegion: function (x, y) {
        },

        /**
         * Highlight an item based on the moused-over x,y co-ordinate
         */
        setRegionHighlight: function (el, x, y) {
            var currentRegion = this.currentRegion,
                highlightEnabled = !this.options.get('disableHighlight'),
                newRegion;
            if (x > this.canvasWidth || y > this.canvasHeight || x < 0 || y < 0) {
                return null;
            }
            newRegion = this.getRegion(el, x, y);
            if (currentRegion !== newRegion) {
                if (currentRegion !== undefined && highlightEnabled) {
                    this.removeHighlight();
                }
                this.currentRegion = newRegion;
                if (newRegion !== undefined && highlightEnabled) {
                    this.renderHighlight();
                }
                return true;
            }
            return false;
        },

        /**
         * Reset any currently highlighted item
         */
        clearRegionHighlight: function () {
            if (this.currentRegion !== undefined) {
                this.removeHighlight();
                this.currentRegion = undefined;
                return true;
            }
            return false;
        },

        renderHighlight: function () {
            this.changeHighlight(true);
        },

        removeHighlight: function () {
            this.changeHighlight(false);
        },

        changeHighlight: function (highlight)  {},

        /**
         * Fetch the HTML to display as a tooltip
         */
        getCurrentRegionTooltip: function () {
            var options = this.options,
                header = '',
                entries = [],
                fields, formats, formatlen, fclass, text, i,
                showFields, showFieldsKey, newFields, fv,
                formatter, format, fieldlen, j;
            if (this.currentRegion === undefined) {
                return '';
            }
            fields = this.getCurrentRegionFields();
            formatter = options.get('tooltipFormatter');
            if (formatter) {
                return formatter(this, options, fields);
            }
            if (options.get('tooltipChartTitle')) {
                header += '<div class="jqs jqstitle">' + options.get('tooltipChartTitle') + '</div>\n';
            }
            formats = this.options.get('tooltipFormat');
            if (!formats) {
                return '';
            }
            if (!$.isArray(formats)) {
                formats = [formats];
            }
            if (!$.isArray(fields)) {
                fields = [fields];
            }
            showFields = this.options.get('tooltipFormatFieldlist');
            showFieldsKey = this.options.get('tooltipFormatFieldlistKey');
            if (showFields && showFieldsKey) {
                // user-selected ordering of fields
                newFields = [];
                for (i = fields.length; i--;) {
                    fv = fields[i][showFieldsKey];
                    if ((j = $.inArray(fv, showFields)) != -1) {
                        newFields[j] = fields[i];
                    }
                }
                fields = newFields;
            }
            formatlen = formats.length;
            fieldlen = fields.length;
            for (i = 0; i < formatlen; i++) {
                format = formats[i];
                if (typeof format === 'string') {
                    format = new SPFormat(format);
                }
                fclass = format.fclass || 'jqsfield';
                for (j = 0; j < fieldlen; j++) {
                    if (!fields[j].isNull || !options.get('tooltipSkipNull')) {
                        $.extend(fields[j], {
                            prefix: options.get('tooltipPrefix'),
                            suffix: options.get('tooltipSuffix')
                        });
                        text = format.render(fields[j], options.get('tooltipValueLookups'), options);
                        entries.push('<div class="' + fclass + '">' + text + '</div>');
                    }
                }
            }
            if (entries.length) {
                return header + entries.join('\n');
            }
            return '';
        },

        getCurrentRegionFields: function () {},

        calcHighlightColor: function (color, options) {
            var highlightColor = options.get('highlightColor'),
                lighten = options.get('highlightLighten'),
                parse, mult, rgbnew, i;
            if (highlightColor) {
                return highlightColor;
            }
            if (lighten) {
                // extract RGB values
                parse = /^#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(color) || /^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(color);
                if (parse) {
                    rgbnew = [];
                    mult = color.length === 4 ? 16 : 1;
                    for (i = 0; i < 3; i++) {
                        rgbnew[i] = clipval(Math.round(parseInt(parse[i + 1], 16) * mult * lighten), 0, 255);
                    }
                    return 'rgb(' + rgbnew.join(',') + ')';
                }

            }
            return color;
        }

    });

    barHighlightMixin = {
        changeHighlight: function (highlight) {
            var currentRegion = this.currentRegion,
                target = this.target,
                shapeids = this.regionShapes[currentRegion],
                newShapes;
            // will be null if the region value was null
            if (shapeids) {
                newShapes = this.renderRegion(currentRegion, highlight);
                if ($.isArray(newShapes) || $.isArray(shapeids)) {
                    target.replaceWithShapes(shapeids, newShapes);
                    this.regionShapes[currentRegion] = $.map(newShapes, function (newShape) {
                        return newShape.id;
                    });
                } else {
                    target.replaceWithShape(shapeids, newShapes);
                    this.regionShapes[currentRegion] = newShapes.id;
                }
            }
        },

        render: function () {
            var values = this.values,
                target = this.target,
                regionShapes = this.regionShapes,
                shapes, ids, i, j;

            if (!this.cls._super.render.call(this)) {
                return;
            }
            for (i = values.length; i--;) {
                shapes = this.renderRegion(i);
                if (shapes) {
                    if ($.isArray(shapes)) {
                        ids = [];
                        for (j = shapes.length; j--;) {
                            shapes[j].append();
                            ids.push(shapes[j].id);
                        }
                        regionShapes[i] = ids;
                    } else {
                        shapes.append();
                        regionShapes[i] = shapes.id; // store just the shapeid
                    }
                } else {
                    // null value
                    regionShapes[i] = null;
                }
            }
            target.render();
        }
    };

    /**
     * Line charts
     */
    $.fn.sparkline.line = line = createClass($.fn.sparkline._base, {
        type: 'line',

        init: function (el, values, options, width, height) {
            line._super.init.call(this, el, values, options, width, height);
            this.vertices = [];
            this.regionMap = [];
            this.xvalues = [];
            this.yvalues = [];
            this.yminmax = [];
            this.hightlightSpotId = null;
            this.lastShapeId = null;
            this.initTarget();
        },

        getRegion: function (el, x, y) {
            var i,
                regionMap = this.regionMap; // maps regions to value positions
            for (i = regionMap.length; i--;) {
                if (regionMap[i] !== null && x >= regionMap[i][0] && x <= regionMap[i][1]) {
                    return regionMap[i][2];
                }
            }
            return undefined;
        },

        getCurrentRegionFields: function () {
            var currentRegion = this.currentRegion;
            return {
                isNull: this.yvalues[currentRegion] === null,
                x: this.xvalues[currentRegion],
                y: this.yvalues[currentRegion],
                color: this.options.get('lineColor'),
                fillColor: this.options.get('fillColor'),
                offset: currentRegion
            };
        },

        renderHighlight: function () {
            var currentRegion = this.currentRegion,
                target = this.target,
                vertex = this.vertices[currentRegion],
                options = this.options,
                spotRadius = options.get('spotRadius'),
                highlightSpotColor = options.get('highlightSpotColor'),
                highlightLineColor = options.get('highlightLineColor'),
                highlightSpot, highlightLine;

            if (!vertex) {
                return;
            }
            if (spotRadius && highlightSpotColor) {
                highlightSpot = target.drawCircle(vertex[0], vertex[1],
                    spotRadius, undefined, highlightSpotColor);
                this.highlightSpotId = highlightSpot.id;
                target.insertAfterShape(this.lastShapeId, highlightSpot);
            }
            if (highlightLineColor) {
                highlightLine = target.drawLine(vertex[0], this.canvasTop, vertex[0],
                    this.canvasTop + this.canvasHeight, highlightLineColor);
                this.highlightLineId = highlightLine.id;
                target.insertAfterShape(this.lastShapeId, highlightLine);
            }
        },

        removeHighlight: function () {
            var target = this.target;
            if (this.highlightSpotId) {
                target.removeShapeId(this.highlightSpotId);
                this.highlightSpotId = null;
            }
            if (this.highlightLineId) {
                target.removeShapeId(this.highlightLineId);
                this.highlightLineId = null;
            }
        },

        scanValues: function () {
            var values = this.values,
                valcount = values.length,
                xvalues = this.xvalues,
                yvalues = this.yvalues,
                yminmax = this.yminmax,
                i, val, isStr, isArray, sp;
            for (i = 0; i < valcount; i++) {
                val = values[i];
                isStr = typeof(values[i]) === 'string';
                isArray = typeof(values[i]) === 'object' && values[i] instanceof Array;
                sp = isStr && values[i].split(':');
                if (isStr && sp.length === 2) { // x:y
                    xvalues.push(Number(sp[0]));
                    yvalues.push(Number(sp[1]));
                    yminmax.push(Number(sp[1]));
                } else if (isArray) {
                    xvalues.push(val[0]);
                    yvalues.push(val[1]);
                    yminmax.push(val[1]);
                } else {
                    xvalues.push(i);
                    if (values[i] === null || values[i] === 'null') {
                        yvalues.push(null);
                    } else {
                        yvalues.push(Number(val));
                        yminmax.push(Number(val));
                    }
                }
            }
            if (this.options.get('xvalues')) {
                xvalues = this.options.get('xvalues');
            }

            this.maxy = this.maxyorg = Math.max.apply(Math, yminmax);
            this.miny = this.minyorg = Math.min.apply(Math, yminmax);

            this.maxx = Math.max.apply(Math, xvalues);
            this.minx = Math.min.apply(Math, xvalues);

            this.xvalues = xvalues;
            this.yvalues = yvalues;
            this.yminmax = yminmax;

        },

        processRangeOptions: function () {
            var options = this.options,
                normalRangeMin = options.get('normalRangeMin'),
                normalRangeMax = options.get('normalRangeMax');

            if (normalRangeMin !== undefined) {
                if (normalRangeMin < this.miny) {
                    this.miny = normalRangeMin;
                }
                if (normalRangeMax > this.maxy) {
                    this.maxy = normalRangeMax;
                }
            }
            if (options.get('chartRangeMin') !== undefined && (options.get('chartRangeClip') || options.get('chartRangeMin') < this.miny)) {
                this.miny = options.get('chartRangeMin');
            }
            if (options.get('chartRangeMax') !== undefined && (options.get('chartRangeClip') || options.get('chartRangeMax') > this.maxy)) {
                this.maxy = options.get('chartRangeMax');
            }
            if (options.get('chartRangeMinX') !== undefined && (options.get('chartRangeClipX') || options.get('chartRangeMinX') < this.minx)) {
                this.minx = options.get('chartRangeMinX');
            }
            if (options.get('chartRangeMaxX') !== undefined && (options.get('chartRangeClipX') || options.get('chartRangeMaxX') > this.maxx)) {
                this.maxx = options.get('chartRangeMaxX');
            }

        },

        drawNormalRange: function (canvasLeft, canvasTop, canvasHeight, canvasWidth, rangey) {
            var normalRangeMin = this.options.get('normalRangeMin'),
                normalRangeMax = this.options.get('normalRangeMax'),
                ytop = canvasTop + Math.round(canvasHeight - (canvasHeight * ((normalRangeMax - this.miny) / rangey))),
                height = Math.round((canvasHeight * (normalRangeMax - normalRangeMin)) / rangey);
            this.target.drawRect(canvasLeft, ytop, canvasWidth, height, undefined, this.options.get('normalRangeColor')).append();
        },

        render: function () {
            var options = this.options,
                target = this.target,
                canvasWidth = this.canvasWidth,
                canvasHeight = this.canvasHeight,
                vertices = this.vertices,
                spotRadius = options.get('spotRadius'),
                regionMap = this.regionMap,
                rangex, rangey, yvallast,
                canvasTop, canvasLeft,
                vertex, path, paths, x, y, xnext, xpos, xposnext,
                last, next, yvalcount, lineShapes, fillShapes, plen,
                valueSpots, hlSpotsEnabled, color, xvalues, yvalues, i;

            if (!line._super.render.call(this)) {
                return;
            }

            this.scanValues();
            this.processRangeOptions();

            xvalues = this.xvalues;
            yvalues = this.yvalues;

            if (!this.yminmax.length || this.yvalues.length < 2) {
                // empty or all null valuess
                return;
            }

            canvasTop = canvasLeft = 0;

            rangex = this.maxx - this.minx === 0 ? 1 : this.maxx - this.minx;
            rangey = this.maxy - this.miny === 0 ? 1 : this.maxy - this.miny;
            yvallast = this.yvalues.length - 1;

            if (spotRadius && (canvasWidth < (spotRadius * 4) || canvasHeight < (spotRadius * 4))) {
                spotRadius = 0;
            }
            if (spotRadius) {
                // adjust the canvas size as required so that spots will fit
                hlSpotsEnabled = options.get('highlightSpotColor') &&  !options.get('disableInteraction');
                if (hlSpotsEnabled || options.get('minSpotColor') || (options.get('spotColor') && yvalues[yvallast] === this.miny)) {
                    canvasHeight -= Math.ceil(spotRadius);
                }
                if (hlSpotsEnabled || options.get('maxSpotColor') || (options.get('spotColor') && yvalues[yvallast] === this.maxy)) {
                    canvasHeight -= Math.ceil(spotRadius);
                    canvasTop += Math.ceil(spotRadius);
                }
                if (hlSpotsEnabled ||
                     ((options.get('minSpotColor') || options.get('maxSpotColor')) && (yvalues[0] === this.miny || yvalues[0] === this.maxy))) {
                    canvasLeft += Math.ceil(spotRadius);
                    canvasWidth -= Math.ceil(spotRadius);
                }
                if (hlSpotsEnabled || options.get('spotColor') ||
                    (options.get('minSpotColor') || options.get('maxSpotColor') &&
                        (yvalues[yvallast] === this.miny || yvalues[yvallast] === this.maxy))) {
                    canvasWidth -= Math.ceil(spotRadius);
                }
            }


            canvasHeight--;

            if (options.get('normalRangeMin') !== undefined && !options.get('drawNormalOnTop')) {
                this.drawNormalRange(canvasLeft, canvasTop, canvasHeight, canvasWidth, rangey);
            }

            path = [];
            paths = [path];
            last = next = null;
            yvalcount = yvalues.length;
            for (i = 0; i < yvalcount; i++) {
                x = xvalues[i];
                xnext = xvalues[i + 1];
                y = yvalues[i];
                xpos = canvasLeft + Math.round((x - this.minx) * (canvasWidth / rangex));
                xposnext = i < yvalcount - 1 ? canvasLeft + Math.round((xnext - this.minx) * (canvasWidth / rangex)) : canvasWidth;
                next = xpos + ((xposnext - xpos) / 2);
                regionMap[i] = [last || 0, next, i];
                last = next;
                if (y === null) {
                    if (i) {
                        if (yvalues[i - 1] !== null) {
                            path = [];
                            paths.push(path);
                        }
                        vertices.push(null);
                    }
                } else {
                    if (y < this.miny) {
                        y = this.miny;
                    }
                    if (y > this.maxy) {
                        y = this.maxy;
                    }
                    if (!path.length) {
                        // previous value was null
                        path.push([xpos, canvasTop + canvasHeight]);
                    }
                    vertex = [xpos, canvasTop + Math.round(canvasHeight - (canvasHeight * ((y - this.miny) / rangey)))];
                    path.push(vertex);
                    vertices.push(vertex);
                }
            }

            lineShapes = [];
            fillShapes = [];
            plen = paths.length;
            for (i = 0; i < plen; i++) {
                path = paths[i];
                if (path.length) {
                    if (options.get('fillColor')) {
                        path.push([path[path.length - 1][0], (canvasTop + canvasHeight)]);
                        fillShapes.push(path.slice(0));
                        path.pop();
                    }
                    // if there's only a single point in this path, then we want to display it
                    // as a vertical line which means we keep path[0]  as is
                    if (path.length > 2) {
                        // else we want the first value
                        path[0] = [path[0][0], path[1][1]];
                    }
                    lineShapes.push(path);
                }
            }

            // draw the fill first, then optionally the normal range, then the line on top of that
            plen = fillShapes.length;
            for (i = 0; i < plen; i++) {
                target.drawShape(fillShapes[i],
                    options.get('fillColor'), options.get('fillColor')).append();
            }

            if (options.get('normalRangeMin') !== undefined && options.get('drawNormalOnTop')) {
                this.drawNormalRange(canvasLeft, canvasTop, canvasHeight, canvasWidth, rangey);
            }

            plen = lineShapes.length;
            for (i = 0; i < plen; i++) {
                target.drawShape(lineShapes[i], options.get('lineColor'), undefined,
                    options.get('lineWidth')).append();
            }

            if (spotRadius && options.get('valueSpots')) {
                valueSpots = options.get('valueSpots');
                if (valueSpots.get === undefined) {
                    valueSpots = new RangeMap(valueSpots);
                }
                for (i = 0; i < yvalcount; i++) {
                    color = valueSpots.get(yvalues[i]);
                    if (color) {
                        target.drawCircle(canvasLeft + Math.round((xvalues[i] - this.minx) * (canvasWidth / rangex)),
                            canvasTop + Math.round(canvasHeight - (canvasHeight * ((yvalues[i] - this.miny) / rangey))),
                            spotRadius, undefined,
                            color).append();
                    }
                }

            }
            if (spotRadius && options.get('spotColor') && yvalues[yvallast] !== null) {
                target.drawCircle(canvasLeft + Math.round((xvalues[xvalues.length - 1] - this.minx) * (canvasWidth / rangex)),
                    canvasTop + Math.round(canvasHeight - (canvasHeight * ((yvalues[yvallast] - this.miny) / rangey))),
                    spotRadius, undefined,
                    options.get('spotColor')).append();
            }
            if (this.maxy !== this.minyorg) {
                if (spotRadius && options.get('minSpotColor')) {
                    x = xvalues[$.inArray(this.minyorg, yvalues)];
                    target.drawCircle(canvasLeft + Math.round((x - this.minx) * (canvasWidth / rangex)),
                        canvasTop + Math.round(canvasHeight - (canvasHeight * ((this.minyorg - this.miny) / rangey))),
                        spotRadius, undefined,
                        options.get('minSpotColor')).append();
                }
                if (spotRadius && options.get('maxSpotColor')) {
                    x = xvalues[$.inArray(this.maxyorg, yvalues)];
                    target.drawCircle(canvasLeft + Math.round((x - this.minx) * (canvasWidth / rangex)),
                        canvasTop + Math.round(canvasHeight - (canvasHeight * ((this.maxyorg - this.miny) / rangey))),
                        spotRadius, undefined,
                        options.get('maxSpotColor')).append();
                }
            }

            this.lastShapeId = target.getLastShapeId();
            this.canvasTop = canvasTop;
            target.render();
        }
    });

    /**
     * Bar charts
     */
    $.fn.sparkline.bar = bar = createClass($.fn.sparkline._base, barHighlightMixin, {
        type: 'bar',

        init: function (el, values, options, width, height) {
            var barWidth = parseInt(options.get('barWidth'), 10),
                barSpacing = parseInt(options.get('barSpacing'), 10),
                chartRangeMin = options.get('chartRangeMin'),
                chartRangeMax = options.get('chartRangeMax'),
                chartRangeClip = options.get('chartRangeClip'),
                stackMin = Infinity,
                stackMax = -Infinity,
                isStackString, groupMin, groupMax, stackRanges,
                numValues, i, vlen, range, zeroAxis, xaxisOffset, min, max, clipMin, clipMax,
                stacked, vlist, j, slen, svals, val, yoffset, yMaxCalc, canvasHeightEf;
            bar._super.init.call(this, el, values, options, width, height);

            // scan values to determine whether to stack bars
            for (i = 0, vlen = values.length; i < vlen; i++) {
                val = values[i];
                isStackString = typeof(val) === 'string' && val.indexOf(':') > -1;
                if (isStackString || $.isArray(val)) {
                    stacked = true;
                    if (isStackString) {
                        val = values[i] = normalizeValues(val.split(':'));
                    }
                    val = remove(val, null); // min/max will treat null as zero
                    groupMin = Math.min.apply(Math, val);
                    groupMax = Math.max.apply(Math, val);
                    if (groupMin < stackMin) {
                        stackMin = groupMin;
                    }
                    if (groupMax > stackMax) {
                        stackMax = groupMax;
                    }
                }
            }

            this.stacked = stacked;
            this.regionShapes = {};
            this.barWidth = barWidth;
            this.barSpacing = barSpacing;
            this.totalBarWidth = barWidth + barSpacing;
            this.width = width = (values.length * barWidth) + ((values.length - 1) * barSpacing);

            this.initTarget();

            if (chartRangeClip) {
                clipMin = chartRangeMin === undefined ? -Infinity : chartRangeMin;
                clipMax = chartRangeMax === undefined ? Infinity : chartRangeMax;
            }

            numValues = [];
            stackRanges = stacked ? [] : numValues;
            var stackTotals = [];
            var stackRangesNeg = [];
            for (i = 0, vlen = values.length; i < vlen; i++) {
                if (stacked) {
                    vlist = values[i];
                    values[i] = svals = [];
                    stackTotals[i] = 0;
                    stackRanges[i] = stackRangesNeg[i] = 0;
                    for (j = 0, slen = vlist.length; j < slen; j++) {
                        val = svals[j] = chartRangeClip ? clipval(vlist[j], clipMin, clipMax) : vlist[j];
                        if (val !== null) {
                            if (val > 0) {
                                stackTotals[i] += val;
                            }
                            if (stackMin < 0 && stackMax > 0) {
                                if (val < 0) {
                                    stackRangesNeg[i] += Math.abs(val);
                                } else {
                                    stackRanges[i] += val;
                                }
                            } else {
                                stackRanges[i] += Math.abs(val - (val < 0 ? stackMax : stackMin));
                            }
                            numValues.push(val);
                        }
                    }
                } else {
                    val = chartRangeClip ? clipval(values[i], clipMin, clipMax) : values[i];
                    val = values[i] = normalizeValue(val);
                    if (val !== null) {
                        numValues.push(val);
                    }
                }
            }
            this.max = max = Math.max.apply(Math, numValues);
            this.min = min = Math.min.apply(Math, numValues);
            this.stackMax = stackMax = stacked ? Math.max.apply(Math, stackTotals) : max;
            this.stackMin = stackMin = stacked ? Math.min.apply(Math, numValues) : min;

            if (options.get('chartRangeMin') !== undefined && (options.get('chartRangeClip') || options.get('chartRangeMin') < min)) {
                min = options.get('chartRangeMin');
            }
            if (options.get('chartRangeMax') !== undefined && (options.get('chartRangeClip') || options.get('chartRangeMax') > max)) {
                max = options.get('chartRangeMax');
            }

            this.zeroAxis = zeroAxis = options.get('zeroAxis', true);
            if (min <= 0 && max >= 0 && zeroAxis) {
                xaxisOffset = 0;
            } else if (zeroAxis == false) {
                xaxisOffset = min;
            } else if (min > 0) {
                xaxisOffset = min;
            } else {
                xaxisOffset = max;
            }
            this.xaxisOffset = xaxisOffset;

            range = stacked ? (Math.max.apply(Math, stackRanges) + Math.max.apply(Math, stackRangesNeg)) : max - min;

            // as we plot zero/min values a single pixel line, we add a pixel to all other
            // values - Reduce the effective canvas size to suit
            this.canvasHeightEf = (zeroAxis && min < 0) ? this.canvasHeight - 2 : this.canvasHeight - 1;

            if (min < xaxisOffset) {
                yMaxCalc = (stacked && max >= 0) ? stackMax : max;
                yoffset = (yMaxCalc - xaxisOffset) / range * this.canvasHeight;
                if (yoffset !== Math.ceil(yoffset)) {
                    this.canvasHeightEf -= 2;
                    yoffset = Math.ceil(yoffset);
                }
            } else {
                yoffset = this.canvasHeight;
            }
            this.yoffset = yoffset;

            if ($.isArray(options.get('colorMap'))) {
                this.colorMapByIndex = options.get('colorMap');
                this.colorMapByValue = null;
            } else {
                this.colorMapByIndex = null;
                this.colorMapByValue = options.get('colorMap');
                if (this.colorMapByValue && this.colorMapByValue.get === undefined) {
                    this.colorMapByValue = new RangeMap(this.colorMapByValue);
                }
            }

            this.range = range;
        },

        getRegion: function (el, x, y) {
            var result = Math.floor(x / this.totalBarWidth);
            return (result < 0 || result >= this.values.length) ? undefined : result;
        },

        getCurrentRegionFields: function () {
            var currentRegion = this.currentRegion,
                values = ensureArray(this.values[currentRegion]),
                result = [],
                value, i;
            for (i = values.length; i--;) {
                value = values[i];
                result.push({
                    isNull: value === null,
                    value: value,
                    color: this.calcColor(i, value, currentRegion),
                    offset: currentRegion
                });
            }
            return result;
        },

        calcColor: function (stacknum, value, valuenum) {
            var colorMapByIndex = this.colorMapByIndex,
                colorMapByValue = this.colorMapByValue,
                options = this.options,
                color, newColor;
            if (this.stacked) {
                color = options.get('stackedBarColor');
            } else {
                color = (value < 0) ? options.get('negBarColor') : options.get('barColor');
            }
            if (value === 0 && options.get('zeroColor') !== undefined) {
                color = options.get('zeroColor');
            }
            if (colorMapByValue && (newColor = colorMapByValue.get(value))) {
                color = newColor;
            } else if (colorMapByIndex && colorMapByIndex.length > valuenum) {
                color = colorMapByIndex[valuenum];
            }
            return $.isArray(color) ? color[stacknum % color.length] : color;
        },

        /**
         * Render bar(s) for a region
         */
        renderRegion: function (valuenum, highlight) {
            var vals = this.values[valuenum],
                options = this.options,
                xaxisOffset = this.xaxisOffset,
                result = [],
                range = this.range,
                stacked = this.stacked,
                target = this.target,
                x = valuenum * this.totalBarWidth,
                canvasHeightEf = this.canvasHeightEf,
                yoffset = this.yoffset,
                y, height, color, isNull, yoffsetNeg, i, valcount, val, minPlotted, allMin;

            vals = $.isArray(vals) ? vals : [vals];
            valcount = vals.length;
            val = vals[0];
            isNull = all(null, vals);
            allMin = all(xaxisOffset, vals, true);

            if (isNull) {
                if (options.get('nullColor')) {
                    color = highlight ? options.get('nullColor') : this.calcHighlightColor(options.get('nullColor'), options);
                    y = (yoffset > 0) ? yoffset - 1 : yoffset;
                    return target.drawRect(x, y, this.barWidth - 1, 0, color, color);
                } else {
                    return undefined;
                }
            }
            yoffsetNeg = yoffset;
            for (i = 0; i < valcount; i++) {
                val = vals[i];

                if (stacked && val === xaxisOffset) {
                    if (!allMin || minPlotted) {
                        continue;
                    }
                    minPlotted = true;
                }

                if (range > 0) {
                    height = Math.floor(canvasHeightEf * ((Math.abs(val - xaxisOffset) / range))) + 1;
                } else {
                    height = 1;
                }
                if (val < xaxisOffset || (val === xaxisOffset && yoffset === 0)) {
                    y = yoffsetNeg;
                    yoffsetNeg += height;
                } else {
                    y = yoffset - height;
                    yoffset -= height;
                }
                color = this.calcColor(i, val, valuenum);
                if (highlight) {
                    color = this.calcHighlightColor(color, options);
                }
                result.push(target.drawRect(x, y, this.barWidth - 1, height - 1, color, color));
            }
            if (result.length === 1) {
                return result[0];
            }
            return result;
        }
    });

    /**
     * Tristate charts
     */
    $.fn.sparkline.tristate = tristate = createClass($.fn.sparkline._base, barHighlightMixin, {
        type: 'tristate',

        init: function (el, values, options, width, height) {
            var barWidth = parseInt(options.get('barWidth'), 10),
                barSpacing = parseInt(options.get('barSpacing'), 10);
            tristate._super.init.call(this, el, values, options, width, height);

            this.regionShapes = {};
            this.barWidth = barWidth;
            this.barSpacing = barSpacing;
            this.totalBarWidth = barWidth + barSpacing;
            this.values = $.map(values, Number);
            this.width = width = (values.length * barWidth) + ((values.length - 1) * barSpacing);

            if ($.isArray(options.get('colorMap'))) {
                this.colorMapByIndex = options.get('colorMap');
                this.colorMapByValue = null;
            } else {
                this.colorMapByIndex = null;
                this.colorMapByValue = options.get('colorMap');
                if (this.colorMapByValue && this.colorMapByValue.get === undefined) {
                    this.colorMapByValue = new RangeMap(this.colorMapByValue);
                }
            }
            this.initTarget();
        },

        getRegion: function (el, x, y) {
            return Math.floor(x / this.totalBarWidth);
        },

        getCurrentRegionFields: function () {
            var currentRegion = this.currentRegion;
            return {
                isNull: this.values[currentRegion] === undefined,
                value: this.values[currentRegion],
                color: this.calcColor(this.values[currentRegion], currentRegion),
                offset: currentRegion
            };
        },

        calcColor: function (value, valuenum) {
            var values = this.values,
                options = this.options,
                colorMapByIndex = this.colorMapByIndex,
                colorMapByValue = this.colorMapByValue,
                color, newColor;

            if (colorMapByValue && (newColor = colorMapByValue.get(value))) {
                color = newColor;
            } else if (colorMapByIndex && colorMapByIndex.length > valuenum) {
                color = colorMapByIndex[valuenum];
            } else if (values[valuenum] < 0) {
                color = options.get('negBarColor');
            } else if (values[valuenum] > 0) {
                color = options.get('posBarColor');
            } else {
                color = options.get('zeroBarColor');
            }
            return color;
        },

        renderRegion: function (valuenum, highlight) {
            var values = this.values,
                options = this.options,
                target = this.target,
                canvasHeight, height, halfHeight,
                x, y, color;

            canvasHeight = target.pixelHeight;
            halfHeight = Math.round(canvasHeight / 2);

            x = valuenum * this.totalBarWidth;
            if (values[valuenum] < 0) {
                y = halfHeight;
                height = halfHeight - 1;
            } else if (values[valuenum] > 0) {
                y = 0;
                height = halfHeight - 1;
            } else {
                y = halfHeight - 1;
                height = 2;
            }
            color = this.calcColor(values[valuenum], valuenum);
            if (color === null) {
                return;
            }
            if (highlight) {
                color = this.calcHighlightColor(color, options);
            }
            return target.drawRect(x, y, this.barWidth - 1, height - 1, color, color);
        }
    });

    /**
     * Discrete charts
     */
    $.fn.sparkline.discrete = discrete = createClass($.fn.sparkline._base, barHighlightMixin, {
        type: 'discrete',

        init: function (el, values, options, width, height) {
            discrete._super.init.call(this, el, values, options, width, height);

            this.regionShapes = {};
            this.values = values = $.map(values, Number);
            this.min = Math.min.apply(Math, values);
            this.max = Math.max.apply(Math, values);
            this.range = this.max - this.min;
            this.width = width = options.get('width') === 'auto' ? values.length * 2 : this.width;
            this.interval = Math.floor(width / values.length);
            this.itemWidth = width / values.length;
            if (options.get('chartRangeMin') !== undefined && (options.get('chartRangeClip') || options.get('chartRangeMin') < this.min)) {
                this.min = options.get('chartRangeMin');
            }
            if (options.get('chartRangeMax') !== undefined && (options.get('chartRangeClip') || options.get('chartRangeMax') > this.max)) {
                this.max = options.get('chartRangeMax');
            }
            this.initTarget();
            if (this.target) {
                this.lineHeight = options.get('lineHeight') === 'auto' ? Math.round(this.canvasHeight * 0.3) : options.get('lineHeight');
            }
        },

        getRegion: function (el, x, y) {
            return Math.floor(x / this.itemWidth);
        },

        getCurrentRegionFields: function () {
            var currentRegion = this.currentRegion;
            return {
                isNull: this.values[currentRegion] === undefined,
                value: this.values[currentRegion],
                offset: currentRegion
            };
        },

        renderRegion: function (valuenum, highlight) {
            var values = this.values,
                options = this.options,
                min = this.min,
                max = this.max,
                range = this.range,
                interval = this.interval,
                target = this.target,
                canvasHeight = this.canvasHeight,
                lineHeight = this.lineHeight,
                pheight = canvasHeight - lineHeight,
                ytop, val, color, x;

            val = clipval(values[valuenum], min, max);
            x = valuenum * interval;
            ytop = Math.round(pheight - pheight * ((val - min) / range));
            color = (options.get('thresholdColor') && val < options.get('thresholdValue')) ? options.get('thresholdColor') : options.get('lineColor');
            if (highlight) {
                color = this.calcHighlightColor(color, options);
            }
            return target.drawLine(x, ytop, x, ytop + lineHeight, color);
        }
    });

    /**
     * Bullet charts
     */
    $.fn.sparkline.bullet = bullet = createClass($.fn.sparkline._base, {
        type: 'bullet',

        init: function (el, values, options, width, height) {
            var min, max, vals;
            bullet._super.init.call(this, el, values, options, width, height);

            // values: target, performance, range1, range2, range3
            this.values = values = normalizeValues(values);
            // target or performance could be null
            vals = values.slice();
            vals[0] = vals[0] === null ? vals[2] : vals[0];
            vals[1] = values[1] === null ? vals[2] : vals[1];
            min = Math.min.apply(Math, values);
            max = Math.max.apply(Math, values);
            if (options.get('base') === undefined) {
                min = min < 0 ? min : 0;
            } else {
                min = options.get('base');
            }
            this.min = min;
            this.max = max;
            this.range = max - min;
            this.shapes = {};
            this.valueShapes = {};
            this.regiondata = {};
            this.width = width = options.get('width') === 'auto' ? '4.0em' : width;
            this.target = this.$el.simpledraw(width, height, options.get('composite'));
            if (!values.length) {
                this.disabled = true;
            }
            this.initTarget();
        },

        getRegion: function (el, x, y) {
            var shapeid = this.target.getShapeAt(el, x, y);
            return (shapeid !== undefined && this.shapes[shapeid] !== undefined) ? this.shapes[shapeid] : undefined;
        },

        getCurrentRegionFields: function () {
            var currentRegion = this.currentRegion;
            return {
                fieldkey: currentRegion.substr(0, 1),
                value: this.values[currentRegion.substr(1)],
                region: currentRegion
            };
        },

        changeHighlight: function (highlight) {
            var currentRegion = this.currentRegion,
                shapeid = this.valueShapes[currentRegion],
                shape;
            delete this.shapes[shapeid];
            switch (currentRegion.substr(0, 1)) {
                case 'r':
                    shape = this.renderRange(currentRegion.substr(1), highlight);
                    break;
                case 'p':
                    shape = this.renderPerformance(highlight);
                    break;
                case 't':
                    shape = this.renderTarget(highlight);
                    break;
            }
            this.valueShapes[currentRegion] = shape.id;
            this.shapes[shape.id] = currentRegion;
            this.target.replaceWithShape(shapeid, shape);
        },

        renderRange: function (rn, highlight) {
            var rangeval = this.values[rn],
                rangewidth = Math.round(this.canvasWidth * ((rangeval - this.min) / this.range)),
                color = this.options.get('rangeColors')[rn - 2];
            if (highlight) {
                color = this.calcHighlightColor(color, this.options);
            }
            return this.target.drawRect(0, 0, rangewidth - 1, this.canvasHeight - 1, color, color);
        },

        renderPerformance: function (highlight) {
            var perfval = this.values[1],
                perfwidth = Math.round(this.canvasWidth * ((perfval - this.min) / this.range)),
                color = this.options.get('performanceColor');
            if (highlight) {
                color = this.calcHighlightColor(color, this.options);
            }
            return this.target.drawRect(0, Math.round(this.canvasHeight * 0.3), perfwidth - 1,
                Math.round(this.canvasHeight * 0.4) - 1, color, color);
        },

        renderTarget: function (highlight) {
            var targetval = this.values[0],
                x = Math.round(this.canvasWidth * ((targetval - this.min) / this.range) - (this.options.get('targetWidth') / 2)),
                targettop = Math.round(this.canvasHeight * 0.10),
                targetheight = this.canvasHeight - (targettop * 2),
                color = this.options.get('targetColor');
            if (highlight) {
                color = this.calcHighlightColor(color, this.options);
            }
            return this.target.drawRect(x, targettop, this.options.get('targetWidth') - 1, targetheight - 1, color, color);
        },

        render: function () {
            var vlen = this.values.length,
                target = this.target,
                i, shape;
            if (!bullet._super.render.call(this)) {
                return;
            }
            for (i = 2; i < vlen; i++) {
                shape = this.renderRange(i).append();
                this.shapes[shape.id] = 'r' + i;
                this.valueShapes['r' + i] = shape.id;
            }
            if (this.values[1] !== null) {
                shape = this.renderPerformance().append();
                this.shapes[shape.id] = 'p1';
                this.valueShapes.p1 = shape.id;
            }
            if (this.values[0] !== null) {
                shape = this.renderTarget().append();
                this.shapes[shape.id] = 't0';
                this.valueShapes.t0 = shape.id;
            }
            target.render();
        }
    });

    /**
     * Pie charts
     */
    $.fn.sparkline.pie = pie = createClass($.fn.sparkline._base, {
        type: 'pie',

        init: function (el, values, options, width, height) {
            var total = 0, i;

            pie._super.init.call(this, el, values, options, width, height);

            this.shapes = {}; // map shape ids to value offsets
            this.valueShapes = {}; // maps value offsets to shape ids
            this.values = values = $.map(values, Number);

            if (options.get('width') === 'auto') {
                this.width = this.height;
            }

            if (values.length > 0) {
                for (i = values.length; i--;) {
                    total += values[i];
                }
            }
            this.total = total;
            this.initTarget();
            this.radius = Math.floor(Math.min(this.canvasWidth, this.canvasHeight) / 2);
        },

        getRegion: function (el, x, y) {
            var shapeid = this.target.getShapeAt(el, x, y);
            return (shapeid !== undefined && this.shapes[shapeid] !== undefined) ? this.shapes[shapeid] : undefined;
        },

        getCurrentRegionFields: function () {
            var currentRegion = this.currentRegion;
            return {
                isNull: this.values[currentRegion] === undefined,
                value: this.values[currentRegion],
                percent: this.values[currentRegion] / this.total * 100,
                color: this.options.get('sliceColors')[currentRegion % this.options.get('sliceColors').length],
                offset: currentRegion
            };
        },

        changeHighlight: function (highlight) {
            var currentRegion = this.currentRegion,
                 newslice = this.renderSlice(currentRegion, highlight),
                 shapeid = this.valueShapes[currentRegion];
            delete this.shapes[shapeid];
            this.target.replaceWithShape(shapeid, newslice);
            this.valueShapes[currentRegion] = newslice.id;
            this.shapes[newslice.id] = currentRegion;
        },

        renderSlice: function (valuenum, highlight) {
            var target = this.target,
                options = this.options,
                radius = this.radius,
                borderWidth = options.get('borderWidth'),
                offset = options.get('offset'),
                circle = 2 * Math.PI,
                values = this.values,
                total = this.total,
                next = offset ? (2*Math.PI)*(offset/360) : 0,
                start, end, i, vlen, color;

            vlen = values.length;
            for (i = 0; i < vlen; i++) {
                start = next;
                end = next;
                if (total > 0) {  // avoid divide by zero
                    end = next + (circle * (values[i] / total));
                }
                if (valuenum === i) {
                    color = options.get('sliceColors')[i % options.get('sliceColors').length];
                    if (highlight) {
                        color = this.calcHighlightColor(color, options);
                    }

                    return target.drawPieSlice(radius, radius, radius - borderWidth, start, end, undefined, color);
                }
                next = end;
            }
        },

        render: function () {
            var target = this.target,
                values = this.values,
                options = this.options,
                radius = this.radius,
                borderWidth = options.get('borderWidth'),
                shape, i;

            if (!pie._super.render.call(this)) {
                return;
            }
            if (borderWidth) {
                target.drawCircle(radius, radius, Math.floor(radius - (borderWidth / 2)),
                    options.get('borderColor'), undefined, borderWidth).append();
            }
            for (i = values.length; i--;) {
                if (values[i]) { // don't render zero values
                    shape = this.renderSlice(i).append();
                    this.valueShapes[i] = shape.id; // store just the shapeid
                    this.shapes[shape.id] = i;
                }
            }
            target.render();
        }
    });

    /**
     * Box plots
     */
    $.fn.sparkline.box = box = createClass($.fn.sparkline._base, {
        type: 'box',

        init: function (el, values, options, width, height) {
            box._super.init.call(this, el, values, options, width, height);
            this.values = $.map(values, Number);
            this.width = options.get('width') === 'auto' ? '4.0em' : width;
            this.initTarget();
            if (!this.values.length) {
                this.disabled = 1;
            }
        },

        /**
         * Simulate a single region
         */
        getRegion: function () {
            return 1;
        },

        getCurrentRegionFields: function () {
            var result = [
                { field: 'lq', value: this.quartiles[0] },
                { field: 'med', value: this.quartiles[1] },
                { field: 'uq', value: this.quartiles[2] }
            ];
            if (this.loutlier !== undefined) {
                result.push({ field: 'lo', value: this.loutlier});
            }
            if (this.routlier !== undefined) {
                result.push({ field: 'ro', value: this.routlier});
            }
            if (this.lwhisker !== undefined) {
                result.push({ field: 'lw', value: this.lwhisker});
            }
            if (this.rwhisker !== undefined) {
                result.push({ field: 'rw', value: this.rwhisker});
            }
            return result;
        },

        render: function () {
            var target = this.target,
                values = this.values,
                vlen = values.length,
                options = this.options,
                canvasWidth = this.canvasWidth,
                canvasHeight = this.canvasHeight,
                minValue = options.get('chartRangeMin') === undefined ? Math.min.apply(Math, values) : options.get('chartRangeMin'),
                maxValue = options.get('chartRangeMax') === undefined ? Math.max.apply(Math, values) : options.get('chartRangeMax'),
                canvasLeft = 0,
                lwhisker, loutlier, iqr, q1, q2, q3, rwhisker, routlier, i,
                size, unitSize;

            if (!box._super.render.call(this)) {
                return;
            }

            if (options.get('raw')) {
                if (options.get('showOutliers') && values.length > 5) {
                    loutlier = values[0];
                    lwhisker = values[1];
                    q1 = values[2];
                    q2 = values[3];
                    q3 = values[4];
                    rwhisker = values[5];
                    routlier = values[6];
                } else {
                    lwhisker = values[0];
                    q1 = values[1];
                    q2 = values[2];
                    q3 = values[3];
                    rwhisker = values[4];
                }
            } else {
                values.sort(function (a, b) { return a - b; });
                q1 = quartile(values, 1);
                q2 = quartile(values, 2);
                q3 = quartile(values, 3);
                iqr = q3 - q1;
                if (options.get('showOutliers')) {
                    lwhisker = rwhisker = undefined;
                    for (i = 0; i < vlen; i++) {
                        if (lwhisker === undefined && values[i] > q1 - (iqr * options.get('outlierIQR'))) {
                            lwhisker = values[i];
                        }
                        if (values[i] < q3 + (iqr * options.get('outlierIQR'))) {
                            rwhisker = values[i];
                        }
                    }
                    loutlier = values[0];
                    routlier = values[vlen - 1];
                } else {
                    lwhisker = values[0];
                    rwhisker = values[vlen - 1];
                }
            }
            this.quartiles = [q1, q2, q3];
            this.lwhisker = lwhisker;
            this.rwhisker = rwhisker;
            this.loutlier = loutlier;
            this.routlier = routlier;

            unitSize = canvasWidth / (maxValue - minValue + 1);
            if (options.get('showOutliers')) {
                canvasLeft = Math.ceil(options.get('spotRadius'));
                canvasWidth -= 2 * Math.ceil(options.get('spotRadius'));
                unitSize = canvasWidth / (maxValue - minValue + 1);
                if (loutlier < lwhisker) {
                    target.drawCircle((loutlier - minValue) * unitSize + canvasLeft,
                        canvasHeight / 2,
                        options.get('spotRadius'),
                        options.get('outlierLineColor'),
                        options.get('outlierFillColor')).append();
                }
                if (routlier > rwhisker) {
                    target.drawCircle((routlier - minValue) * unitSize + canvasLeft,
                        canvasHeight / 2,
                        options.get('spotRadius'),
                        options.get('outlierLineColor'),
                        options.get('outlierFillColor')).append();
                }
            }

            // box
            target.drawRect(
                Math.round((q1 - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight * 0.1),
                Math.round((q3 - q1) * unitSize),
                Math.round(canvasHeight * 0.8),
                options.get('boxLineColor'),
                options.get('boxFillColor')).append();
            // left whisker
            target.drawLine(
                Math.round((lwhisker - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight / 2),
                Math.round((q1 - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight / 2),
                options.get('lineColor')).append();
            target.drawLine(
                Math.round((lwhisker - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight / 4),
                Math.round((lwhisker - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight - canvasHeight / 4),
                options.get('whiskerColor')).append();
            // right whisker
            target.drawLine(Math.round((rwhisker - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight / 2),
                Math.round((q3 - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight / 2),
                options.get('lineColor')).append();
            target.drawLine(
                Math.round((rwhisker - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight / 4),
                Math.round((rwhisker - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight - canvasHeight / 4),
                options.get('whiskerColor')).append();
            // median line
            target.drawLine(
                Math.round((q2 - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight * 0.1),
                Math.round((q2 - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight * 0.9),
                options.get('medianColor')).append();
            if (options.get('target')) {
                size = Math.ceil(options.get('spotRadius'));
                target.drawLine(
                    Math.round((options.get('target') - minValue) * unitSize + canvasLeft),
                    Math.round((canvasHeight / 2) - size),
                    Math.round((options.get('target') - minValue) * unitSize + canvasLeft),
                    Math.round((canvasHeight / 2) + size),
                    options.get('targetColor')).append();
                target.drawLine(
                    Math.round((options.get('target') - minValue) * unitSize + canvasLeft - size),
                    Math.round(canvasHeight / 2),
                    Math.round((options.get('target') - minValue) * unitSize + canvasLeft + size),
                    Math.round(canvasHeight / 2),
                    options.get('targetColor')).append();
            }
            target.render();
        }
    });

    // Setup a very simple "virtual canvas" to make drawing the few shapes we need easier
    // This is accessible as $(foo).simpledraw()

    VShape = createClass({
        init: function (target, id, type, args) {
            this.target = target;
            this.id = id;
            this.type = type;
            this.args = args;
        },
        append: function () {
            this.target.appendShape(this);
            return this;
        }
    });

    VCanvas_base = createClass({
        _pxregex: /(\d+)(px)?\s*$/i,

        init: function (width, height, target) {
            if (!width) {
                return;
            }
            this.width = width;
            this.height = height;
            this.target = target;
            this.lastShapeId = null;
            if (target[0]) {
                target = target[0];
            }
            $.data(target, '_jqs_vcanvas', this);
        },

        drawLine: function (x1, y1, x2, y2, lineColor, lineWidth) {
            return this.drawShape([[x1, y1], [x2, y2]], lineColor, lineWidth);
        },

        drawShape: function (path, lineColor, fillColor, lineWidth) {
            return this._genShape('Shape', [path, lineColor, fillColor, lineWidth]);
        },

        drawCircle: function (x, y, radius, lineColor, fillColor, lineWidth) {
            return this._genShape('Circle', [x, y, radius, lineColor, fillColor, lineWidth]);
        },

        drawPieSlice: function (x, y, radius, startAngle, endAngle, lineColor, fillColor) {
            return this._genShape('PieSlice', [x, y, radius, startAngle, endAngle, lineColor, fillColor]);
        },

        drawRect: function (x, y, width, height, lineColor, fillColor) {
            return this._genShape('Rect', [x, y, width, height, lineColor, fillColor]);
        },

        getElement: function () {
            return this.canvas;
        },

        /**
         * Return the most recently inserted shape id
         */
        getLastShapeId: function () {
            return this.lastShapeId;
        },

        /**
         * Clear and reset the canvas
         */
        reset: function () {
            alert('reset not implemented');
        },

        _insert: function (el, target) {
            $(target).html(el);
        },

        /**
         * Calculate the pixel dimensions of the canvas
         */
        _calculatePixelDims: function (width, height, canvas) {
            // XXX This should probably be a configurable option
            var match;
            match = this._pxregex.exec(height);
            if (match) {
                this.pixelHeight = match[1];
            } else {
                this.pixelHeight = $(canvas).height();
            }
            match = this._pxregex.exec(width);
            if (match) {
                this.pixelWidth = match[1];
            } else {
                this.pixelWidth = $(canvas).width();
            }
        },

        /**
         * Generate a shape object and id for later rendering
         */
        _genShape: function (shapetype, shapeargs) {
            var id = shapeCount++;
            shapeargs.unshift(id);
            return new VShape(this, id, shapetype, shapeargs);
        },

        /**
         * Add a shape to the end of the render queue
         */
        appendShape: function (shape) {
            alert('appendShape not implemented');
        },

        /**
         * Replace one shape with another
         */
        replaceWithShape: function (shapeid, shape) {
            alert('replaceWithShape not implemented');
        },

        /**
         * Insert one shape after another in the render queue
         */
        insertAfterShape: function (shapeid, shape) {
            alert('insertAfterShape not implemented');
        },

        /**
         * Remove a shape from the queue
         */
        removeShapeId: function (shapeid) {
            alert('removeShapeId not implemented');
        },

        /**
         * Find a shape at the specified x/y co-ordinates
         */
        getShapeAt: function (el, x, y) {
            alert('getShapeAt not implemented');
        },

        /**
         * Render all queued shapes onto the canvas
         */
        render: function () {
            alert('render not implemented');
        }
    });

    VCanvas_canvas = createClass(VCanvas_base, {
        init: function (width, height, target, interact) {
            VCanvas_canvas._super.init.call(this, width, height, target);
            this.canvas = document.createElement('canvas');
            if (target[0]) {
                target = target[0];
            }
            $.data(target, '_jqs_vcanvas', this);
            $(this.canvas).css({ display: 'inline-block', width: width, height: height, verticalAlign: 'top' });
            this._insert(this.canvas, target);
            this._calculatePixelDims(width, height, this.canvas);
            this.canvas.width = this.pixelWidth;
            this.canvas.height = this.pixelHeight;
            this.interact = interact;
            this.shapes = {};
            this.shapeseq = [];
            this.currentTargetShapeId = undefined;
            $(this.canvas).css({width: this.pixelWidth, height: this.pixelHeight});
        },

        _getContext: function (lineColor, fillColor, lineWidth) {
            var context = this.canvas.getContext('2d');
            if (lineColor !== undefined) {
                context.strokeStyle = lineColor;
            }
            context.lineWidth = lineWidth === undefined ? 1 : lineWidth;
            if (fillColor !== undefined) {
                context.fillStyle = fillColor;
            }
            return context;
        },

        reset: function () {
            var context = this._getContext();
            context.clearRect(0, 0, this.pixelWidth, this.pixelHeight);
            this.shapes = {};
            this.shapeseq = [];
            this.currentTargetShapeId = undefined;
        },

        _drawShape: function (shapeid, path, lineColor, fillColor, lineWidth) {
            var context = this._getContext(lineColor, fillColor, lineWidth),
                i, plen;
            context.beginPath();
            context.moveTo(path[0][0] + 0.5, path[0][1] + 0.5);
            for (i = 1, plen = path.length; i < plen; i++) {
                context.lineTo(path[i][0] + 0.5, path[i][1] + 0.5); // the 0.5 offset gives us crisp pixel-width lines
            }
            if (lineColor !== undefined) {
                context.stroke();
            }
            if (fillColor !== undefined) {
                context.fill();
            }
            if (this.targetX !== undefined && this.targetY !== undefined &&
                context.isPointInPath(this.targetX, this.targetY)) {
                this.currentTargetShapeId = shapeid;
            }
        },

        _drawCircle: function (shapeid, x, y, radius, lineColor, fillColor, lineWidth) {
            var context = this._getContext(lineColor, fillColor, lineWidth);
            context.beginPath();
            context.arc(x, y, radius, 0, 2 * Math.PI, false);
            if (this.targetX !== undefined && this.targetY !== undefined &&
                context.isPointInPath(this.targetX, this.targetY)) {
                this.currentTargetShapeId = shapeid;
            }
            if (lineColor !== undefined) {
                context.stroke();
            }
            if (fillColor !== undefined) {
                context.fill();
            }
        },

        _drawPieSlice: function (shapeid, x, y, radius, startAngle, endAngle, lineColor, fillColor) {
            var context = this._getContext(lineColor, fillColor);
            context.beginPath();
            context.moveTo(x, y);
            context.arc(x, y, radius, startAngle, endAngle, false);
            context.lineTo(x, y);
            context.closePath();
            if (lineColor !== undefined) {
                context.stroke();
            }
            if (fillColor) {
                context.fill();
            }
            if (this.targetX !== undefined && this.targetY !== undefined &&
                context.isPointInPath(this.targetX, this.targetY)) {
                this.currentTargetShapeId = shapeid;
            }
        },

        _drawRect: function (shapeid, x, y, width, height, lineColor, fillColor) {
            return this._drawShape(shapeid, [[x, y], [x + width, y], [x + width, y + height], [x, y + height], [x, y]], lineColor, fillColor);
        },

        appendShape: function (shape) {
            this.shapes[shape.id] = shape;
            this.shapeseq.push(shape.id);
            this.lastShapeId = shape.id;
            return shape.id;
        },

        replaceWithShape: function (shapeid, shape) {
            var shapeseq = this.shapeseq,
                i;
            this.shapes[shape.id] = shape;
            for (i = shapeseq.length; i--;) {
                if (shapeseq[i] == shapeid) {
                    shapeseq[i] = shape.id;
                }
            }
            delete this.shapes[shapeid];
        },

        replaceWithShapes: function (shapeids, shapes) {
            var shapeseq = this.shapeseq,
                shapemap = {},
                sid, i, first;

            for (i = shapeids.length; i--;) {
                shapemap[shapeids[i]] = true;
            }
            for (i = shapeseq.length; i--;) {
                sid = shapeseq[i];
                if (shapemap[sid]) {
                    shapeseq.splice(i, 1);
                    delete this.shapes[sid];
                    first = i;
                }
            }
            for (i = shapes.length; i--;) {
                shapeseq.splice(first, 0, shapes[i].id);
                this.shapes[shapes[i].id] = shapes[i];
            }

        },

        insertAfterShape: function (shapeid, shape) {
            var shapeseq = this.shapeseq,
                i;
            for (i = shapeseq.length; i--;) {
                if (shapeseq[i] === shapeid) {
                    shapeseq.splice(i + 1, 0, shape.id);
                    this.shapes[shape.id] = shape;
                    return;
                }
            }
        },

        removeShapeId: function (shapeid) {
            var shapeseq = this.shapeseq,
                i;
            for (i = shapeseq.length; i--;) {
                if (shapeseq[i] === shapeid) {
                    shapeseq.splice(i, 1);
                    break;
                }
            }
            delete this.shapes[shapeid];
        },

        getShapeAt: function (el, x, y) {
            this.targetX = x;
            this.targetY = y;
            this.render();
            return this.currentTargetShapeId;
        },

        render: function () {
            var shapeseq = this.shapeseq,
                shapes = this.shapes,
                shapeCount = shapeseq.length,
                context = this._getContext(),
                shapeid, shape, i;
            context.clearRect(0, 0, this.pixelWidth, this.pixelHeight);
            for (i = 0; i < shapeCount; i++) {
                shapeid = shapeseq[i];
                shape = shapes[shapeid];
                this['_draw' + shape.type].apply(this, shape.args);
            }
            if (!this.interact) {
                // not interactive so no need to keep the shapes array
                this.shapes = {};
                this.shapeseq = [];
            }
        }

    });

    VCanvas_vml = createClass(VCanvas_base, {
        init: function (width, height, target) {
            var groupel;
            VCanvas_vml._super.init.call(this, width, height, target);
            if (target[0]) {
                target = target[0];
            }
            $.data(target, '_jqs_vcanvas', this);
            this.canvas = document.createElement('span');
            $(this.canvas).css({ display: 'inline-block', position: 'relative', overflow: 'hidden', width: width, height: height, margin: '0px', padding: '0px', verticalAlign: 'top'});
            this._insert(this.canvas, target);
            this._calculatePixelDims(width, height, this.canvas);
            this.canvas.width = this.pixelWidth;
            this.canvas.height = this.pixelHeight;
            groupel = '<v:group coordorigin="0 0" coordsize="' + this.pixelWidth + ' ' + this.pixelHeight + '"' +
                    ' style="position:absolute;top:0;left:0;width:' + this.pixelWidth + 'px;height=' + this.pixelHeight + 'px;"></v:group>';
            this.canvas.insertAdjacentHTML('beforeEnd', groupel);
            this.group = $(this.canvas).children()[0];
            this.rendered = false;
            this.prerender = '';
        },

        _drawShape: function (shapeid, path, lineColor, fillColor, lineWidth) {
            var vpath = [],
                initial, stroke, fill, closed, vel, plen, i;
            for (i = 0, plen = path.length; i < plen; i++) {
                vpath[i] = '' + (path[i][0]) + ',' + (path[i][1]);
            }
            initial = vpath.splice(0, 1);
            lineWidth = lineWidth === undefined ? 1 : lineWidth;
            stroke = lineColor === undefined ? ' stroked="false" ' : ' strokeWeight="' + lineWidth + 'px" strokeColor="' + lineColor + '" ';
            fill = fillColor === undefined ? ' filled="false"' : ' fillColor="' + fillColor + '" filled="true" ';
            closed = vpath[0] === vpath[vpath.length - 1] ? 'x ' : '';
            vel = '<v:shape coordorigin="0 0" coordsize="' + this.pixelWidth + ' ' + this.pixelHeight + '" ' +
                 ' id="jqsshape' + shapeid + '" ' +
                 stroke +
                 fill +
                ' style="position:absolute;left:0px;top:0px;height:' + this.pixelHeight + 'px;width:' + this.pixelWidth + 'px;padding:0px;margin:0px;" ' +
                ' path="m ' + initial + ' l ' + vpath.join(', ') + ' ' + closed + 'e">' +
                ' </v:shape>';
            return vel;
        },

        _drawCircle: function (shapeid, x, y, radius, lineColor, fillColor, lineWidth) {
            var stroke, fill, vel;
            x -= radius;
            y -= radius;
            stroke = lineColor === undefined ? ' stroked="false" ' : ' strokeWeight="' + lineWidth + 'px" strokeColor="' + lineColor + '" ';
            fill = fillColor === undefined ? ' filled="false"' : ' fillColor="' + fillColor + '" filled="true" ';
            vel = '<v:oval ' +
                 ' id="jqsshape' + shapeid + '" ' +
                stroke +
                fill +
                ' style="position:absolute;top:' + y + 'px; left:' + x + 'px; width:' + (radius * 2) + 'px; height:' + (radius * 2) + 'px"></v:oval>';
            return vel;

        },

        _drawPieSlice: function (shapeid, x, y, radius, startAngle, endAngle, lineColor, fillColor) {
            var vpath, startx, starty, endx, endy, stroke, fill, vel;
            if (startAngle === endAngle) {
                return '';  // VML seems to have problem when start angle equals end angle.
            }
            if ((endAngle - startAngle) === (2 * Math.PI)) {
                startAngle = 0.0;  // VML seems to have a problem when drawing a full circle that doesn't start 0
                endAngle = (2 * Math.PI);
            }

            startx = x + Math.round(Math.cos(startAngle) * radius);
            starty = y + Math.round(Math.sin(startAngle) * radius);
            endx = x + Math.round(Math.cos(endAngle) * radius);
            endy = y + Math.round(Math.sin(endAngle) * radius);

            if (startx === endx && starty === endy) {
                if ((endAngle - startAngle) < Math.PI) {
                    // Prevent very small slices from being mistaken as a whole pie
                    return '';
                }
                // essentially going to be the entire circle, so ignore startAngle
                startx = endx = x + radius;
                starty = endy = y;
            }

            if (startx === endx && starty === endy && (endAngle - startAngle) < Math.PI) {
                return '';
            }

            vpath = [x - radius, y - radius, x + radius, y + radius, startx, starty, endx, endy];
            stroke = lineColor === undefined ? ' stroked="false" ' : ' strokeWeight="1px" strokeColor="' + lineColor + '" ';
            fill = fillColor === undefined ? ' filled="false"' : ' fillColor="' + fillColor + '" filled="true" ';
            vel = '<v:shape coordorigin="0 0" coordsize="' + this.pixelWidth + ' ' + this.pixelHeight + '" ' +
                 ' id="jqsshape' + shapeid + '" ' +
                 stroke +
                 fill +
                ' style="position:absolute;left:0px;top:0px;height:' + this.pixelHeight + 'px;width:' + this.pixelWidth + 'px;padding:0px;margin:0px;" ' +
                ' path="m ' + x + ',' + y + ' wa ' + vpath.join(', ') + ' x e">' +
                ' </v:shape>';
            return vel;
        },

        _drawRect: function (shapeid, x, y, width, height, lineColor, fillColor) {
            return this._drawShape(shapeid, [[x, y], [x, y + height], [x + width, y + height], [x + width, y], [x, y]], lineColor, fillColor);
        },

        reset: function () {
            this.group.innerHTML = '';
        },

        appendShape: function (shape) {
            var vel = this['_draw' + shape.type].apply(this, shape.args);
            if (this.rendered) {
                this.group.insertAdjacentHTML('beforeEnd', vel);
            } else {
                this.prerender += vel;
            }
            this.lastShapeId = shape.id;
            return shape.id;
        },

        replaceWithShape: function (shapeid, shape) {
            var existing = $('#jqsshape' + shapeid),
                vel = this['_draw' + shape.type].apply(this, shape.args);
            existing[0].outerHTML = vel;
        },

        replaceWithShapes: function (shapeids, shapes) {
            // replace the first shapeid with all the new shapes then toast the remaining old shapes
            var existing = $('#jqsshape' + shapeids[0]),
                replace = '',
                slen = shapes.length,
                i;
            for (i = 0; i < slen; i++) {
                replace += this['_draw' + shapes[i].type].apply(this, shapes[i].args);
            }
            existing[0].outerHTML = replace;
            for (i = 1; i < shapeids.length; i++) {
                $('#jqsshape' + shapeids[i]).remove();
            }
        },

        insertAfterShape: function (shapeid, shape) {
            var existing = $('#jqsshape' + shapeid),
                 vel = this['_draw' + shape.type].apply(this, shape.args);
            existing[0].insertAdjacentHTML('afterEnd', vel);
        },

        removeShapeId: function (shapeid) {
            var existing = $('#jqsshape' + shapeid);
            this.group.removeChild(existing[0]);
        },

        getShapeAt: function (el, x, y) {
            var shapeid = el.id.substr(8);
            return shapeid;
        },

        render: function () {
            if (!this.rendered) {
                // batch the intial render into a single repaint
                this.group.innerHTML = this.prerender;
                this.rendered = true;
            }
        }
    });

}))}(document, Math));

},{}],4:[function(require,module,exports){
/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */

/*global define: false Mustache: true*/

(function defineMustache (global, factory) {
  if (typeof exports === 'object' && exports && typeof exports.nodeName !== 'string') {
    factory(exports); // CommonJS
  } else if (typeof define === 'function' && define.amd) {
    define(['exports'], factory); // AMD
  } else {
    global.Mustache = {};
    factory(global.Mustache); // script, wsh, asp
  }
}(this, function mustacheFactory (mustache) {

  var objectToString = Object.prototype.toString;
  var isArray = Array.isArray || function isArrayPolyfill (object) {
    return objectToString.call(object) === '[object Array]';
  };

  function isFunction (object) {
    return typeof object === 'function';
  }

  /**
   * More correct typeof string handling array
   * which normally returns typeof 'object'
   */
  function typeStr (obj) {
    return isArray(obj) ? 'array' : typeof obj;
  }

  function escapeRegExp (string) {
    return string.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g, '\\$&');
  }

  /**
   * Null safe way of checking whether or not an object,
   * including its prototype, has a given property
   */
  function hasProperty (obj, propName) {
    return obj != null && typeof obj === 'object' && (propName in obj);
  }

  // Workaround for https://issues.apache.org/jira/browse/COUCHDB-577
  // See https://github.com/janl/mustache.js/issues/189
  var regExpTest = RegExp.prototype.test;
  function testRegExp (re, string) {
    return regExpTest.call(re, string);
  }

  var nonSpaceRe = /\S/;
  function isWhitespace (string) {
    return !testRegExp(nonSpaceRe, string);
  }

  var entityMap = {
    '&': '&amp;',
    '<': '&lt;',
    '>': '&gt;',
    '"': '&quot;',
    "'": '&#39;',
    '/': '&#x2F;',
    '`': '&#x60;',
    '=': '&#x3D;'
  };

  function escapeHtml (string) {
    return String(string).replace(/[&<>"'`=\/]/g, function fromEntityMap (s) {
      return entityMap[s];
    });
  }

  var whiteRe = /\s*/;
  var spaceRe = /\s+/;
  var equalsRe = /\s*=/;
  var curlyRe = /\s*\}/;
  var tagRe = /#|\^|\/|>|\{|&|=|!/;

  /**
   * Breaks up the given `template` string into a tree of tokens. If the `tags`
   * argument is given here it must be an array with two string values: the
   * opening and closing tags used in the template (e.g. [ "<%", "%>" ]). Of
   * course, the default is to use mustaches (i.e. mustache.tags).
   *
   * A token is an array with at least 4 elements. The first element is the
   * mustache symbol that was used inside the tag, e.g. "#" or "&". If the tag
   * did not contain a symbol (i.e. {{myValue}}) this element is "name". For
   * all text that appears outside a symbol this element is "text".
   *
   * The second element of a token is its "value". For mustache tags this is
   * whatever else was inside the tag besides the opening symbol. For text tokens
   * this is the text itself.
   *
   * The third and fourth elements of the token are the start and end indices,
   * respectively, of the token in the original template.
   *
   * Tokens that are the root node of a subtree contain two more elements: 1) an
   * array of tokens in the subtree and 2) the index in the original template at
   * which the closing tag for that section begins.
   */
  function parseTemplate (template, tags) {
    if (!template)
      return [];

    var sections = [];     // Stack to hold section tokens
    var tokens = [];       // Buffer to hold the tokens
    var spaces = [];       // Indices of whitespace tokens on the current line
    var hasTag = false;    // Is there a {{tag}} on the current line?
    var nonSpace = false;  // Is there a non-space char on the current line?

    // Strips all whitespace tokens array for the current line
    // if there was a {{#tag}} on it and otherwise only space.
    function stripSpace () {
      if (hasTag && !nonSpace) {
        while (spaces.length)
          delete tokens[spaces.pop()];
      } else {
        spaces = [];
      }

      hasTag = false;
      nonSpace = false;
    }

    var openingTagRe, closingTagRe, closingCurlyRe;
    function compileTags (tagsToCompile) {
      if (typeof tagsToCompile === 'string')
        tagsToCompile = tagsToCompile.split(spaceRe, 2);

      if (!isArray(tagsToCompile) || tagsToCompile.length !== 2)
        throw new Error('Invalid tags: ' + tagsToCompile);

      openingTagRe = new RegExp(escapeRegExp(tagsToCompile[0]) + '\\s*');
      closingTagRe = new RegExp('\\s*' + escapeRegExp(tagsToCompile[1]));
      closingCurlyRe = new RegExp('\\s*' + escapeRegExp('}' + tagsToCompile[1]));
    }

    compileTags(tags || mustache.tags);

    var scanner = new Scanner(template);

    var start, type, value, chr, token, openSection;
    while (!scanner.eos()) {
      start = scanner.pos;

      // Match any text between tags.
      value = scanner.scanUntil(openingTagRe);

      if (value) {
        for (var i = 0, valueLength = value.length; i < valueLength; ++i) {
          chr = value.charAt(i);

          if (isWhitespace(chr)) {
            spaces.push(tokens.length);
          } else {
            nonSpace = true;
          }

          tokens.push([ 'text', chr, start, start + 1 ]);
          start += 1;

          // Check for whitespace on the current line.
          if (chr === '\n')
            stripSpace();
        }
      }

      // Match the opening tag.
      if (!scanner.scan(openingTagRe))
        break;

      hasTag = true;

      // Get the tag type.
      type = scanner.scan(tagRe) || 'name';
      scanner.scan(whiteRe);

      // Get the tag value.
      if (type === '=') {
        value = scanner.scanUntil(equalsRe);
        scanner.scan(equalsRe);
        scanner.scanUntil(closingTagRe);
      } else if (type === '{') {
        value = scanner.scanUntil(closingCurlyRe);
        scanner.scan(curlyRe);
        scanner.scanUntil(closingTagRe);
        type = '&';
      } else {
        value = scanner.scanUntil(closingTagRe);
      }

      // Match the closing tag.
      if (!scanner.scan(closingTagRe))
        throw new Error('Unclosed tag at ' + scanner.pos);

      token = [ type, value, start, scanner.pos ];
      tokens.push(token);

      if (type === '#' || type === '^') {
        sections.push(token);
      } else if (type === '/') {
        // Check section nesting.
        openSection = sections.pop();

        if (!openSection)
          throw new Error('Unopened section "' + value + '" at ' + start);

        if (openSection[1] !== value)
          throw new Error('Unclosed section "' + openSection[1] + '" at ' + start);
      } else if (type === 'name' || type === '{' || type === '&') {
        nonSpace = true;
      } else if (type === '=') {
        // Set the tags for the next time around.
        compileTags(value);
      }
    }

    // Make sure there are no open sections when we're done.
    openSection = sections.pop();

    if (openSection)
      throw new Error('Unclosed section "' + openSection[1] + '" at ' + scanner.pos);

    return nestTokens(squashTokens(tokens));
  }

  /**
   * Combines the values of consecutive text tokens in the given `tokens` array
   * to a single token.
   */
  function squashTokens (tokens) {
    var squashedTokens = [];

    var token, lastToken;
    for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {
      token = tokens[i];

      if (token) {
        if (token[0] === 'text' && lastToken && lastToken[0] === 'text') {
          lastToken[1] += token[1];
          lastToken[3] = token[3];
        } else {
          squashedTokens.push(token);
          lastToken = token;
        }
      }
    }

    return squashedTokens;
  }

  /**
   * Forms the given array of `tokens` into a nested tree structure where
   * tokens that represent a section have two additional items: 1) an array of
   * all tokens that appear in that section and 2) the index in the original
   * template that represents the end of that section.
   */
  function nestTokens (tokens) {
    var nestedTokens = [];
    var collector = nestedTokens;
    var sections = [];

    var token, section;
    for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {
      token = tokens[i];

      switch (token[0]) {
        case '#':
        case '^':
          collector.push(token);
          sections.push(token);
          collector = token[4] = [];
          break;
        case '/':
          section = sections.pop();
          section[5] = token[2];
          collector = sections.length > 0 ? sections[sections.length - 1][4] : nestedTokens;
          break;
        default:
          collector.push(token);
      }
    }

    return nestedTokens;
  }

  /**
   * A simple string scanner that is used by the template parser to find
   * tokens in template strings.
   */
  function Scanner (string) {
    this.string = string;
    this.tail = string;
    this.pos = 0;
  }

  /**
   * Returns `true` if the tail is empty (end of string).
   */
  Scanner.prototype.eos = function eos () {
    return this.tail === '';
  };

  /**
   * Tries to match the given regular expression at the current position.
   * Returns the matched text if it can match, the empty string otherwise.
   */
  Scanner.prototype.scan = function scan (re) {
    var match = this.tail.match(re);

    if (!match || match.index !== 0)
      return '';

    var string = match[0];

    this.tail = this.tail.substring(string.length);
    this.pos += string.length;

    return string;
  };

  /**
   * Skips all text until the given regular expression can be matched. Returns
   * the skipped string, which is the entire tail if no match can be made.
   */
  Scanner.prototype.scanUntil = function scanUntil (re) {
    var index = this.tail.search(re), match;

    switch (index) {
      case -1:
        match = this.tail;
        this.tail = '';
        break;
      case 0:
        match = '';
        break;
      default:
        match = this.tail.substring(0, index);
        this.tail = this.tail.substring(index);
    }

    this.pos += match.length;

    return match;
  };

  /**
   * Represents a rendering context by wrapping a view object and
   * maintaining a reference to the parent context.
   */
  function Context (view, parentContext) {
    this.view = view;
    this.cache = { '.': this.view };
    this.parent = parentContext;
  }

  /**
   * Creates a new context using the given view with this context
   * as the parent.
   */
  Context.prototype.push = function push (view) {
    return new Context(view, this);
  };

  /**
   * Returns the value of the given name in this context, traversing
   * up the context hierarchy if the value is absent in this context's view.
   */
  Context.prototype.lookup = function lookup (name) {
    var cache = this.cache;

    var value;
    if (cache.hasOwnProperty(name)) {
      value = cache[name];
    } else {
      var context = this, names, index, lookupHit = false;

      while (context) {
        if (name.indexOf('.') > 0) {
          value = context.view;
          names = name.split('.');
          index = 0;

          /**
           * Using the dot notion path in `name`, we descend through the
           * nested objects.
           *
           * To be certain that the lookup has been successful, we have to
           * check if the last object in the path actually has the property
           * we are looking for. We store the result in `lookupHit`.
           *
           * This is specially necessary for when the value has been set to
           * `undefined` and we want to avoid looking up parent contexts.
           **/
          while (value != null && index < names.length) {
            if (index === names.length - 1)
              lookupHit = hasProperty(value, names[index]);

            value = value[names[index++]];
          }
        } else {
          value = context.view[name];
          lookupHit = hasProperty(context.view, name);
        }

        if (lookupHit)
          break;

        context = context.parent;
      }

      cache[name] = value;
    }

    if (isFunction(value))
      value = value.call(this.view);

    return value;
  };

  /**
   * A Writer knows how to take a stream of tokens and render them to a
   * string, given a context. It also maintains a cache of templates to
   * avoid the need to parse the same template twice.
   */
  function Writer () {
    this.cache = {};
  }

  /**
   * Clears all cached templates in this writer.
   */
  Writer.prototype.clearCache = function clearCache () {
    this.cache = {};
  };

  /**
   * Parses and caches the given `template` and returns the array of tokens
   * that is generated from the parse.
   */
  Writer.prototype.parse = function parse (template, tags) {
    var cache = this.cache;
    var tokens = cache[template];

    if (tokens == null)
      tokens = cache[template] = parseTemplate(template, tags);

    return tokens;
  };

  /**
   * High-level method that is used to render the given `template` with
   * the given `view`.
   *
   * The optional `partials` argument may be an object that contains the
   * names and templates of partials that are used in the template. It may
   * also be a function that is used to load partial templates on the fly
   * that takes a single argument: the name of the partial.
   */
  Writer.prototype.render = function render (template, view, partials) {
    var tokens = this.parse(template);
    var context = (view instanceof Context) ? view : new Context(view);
    return this.renderTokens(tokens, context, partials, template);
  };

  /**
   * Low-level method that renders the given array of `tokens` using
   * the given `context` and `partials`.
   *
   * Note: The `originalTemplate` is only ever used to extract the portion
   * of the original template that was contained in a higher-order section.
   * If the template doesn't use higher-order sections, this argument may
   * be omitted.
   */
  Writer.prototype.renderTokens = function renderTokens (tokens, context, partials, originalTemplate) {
    var buffer = '';

    var token, symbol, value;
    for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {
      value = undefined;
      token = tokens[i];
      symbol = token[0];

      if (symbol === '#') value = this.renderSection(token, context, partials, originalTemplate);
      else if (symbol === '^') value = this.renderInverted(token, context, partials, originalTemplate);
      else if (symbol === '>') value = this.renderPartial(token, context, partials, originalTemplate);
      else if (symbol === '&') value = this.unescapedValue(token, context);
      else if (symbol === 'name') value = this.escapedValue(token, context);
      else if (symbol === 'text') value = this.rawValue(token);

      if (value !== undefined)
        buffer += value;
    }

    return buffer;
  };

  Writer.prototype.renderSection = function renderSection (token, context, partials, originalTemplate) {
    var self = this;
    var buffer = '';
    var value = context.lookup(token[1]);

    // This function is used to render an arbitrary template
    // in the current context by higher-order sections.
    function subRender (template) {
      return self.render(template, context, partials);
    }

    if (!value) return;

    if (isArray(value)) {
      for (var j = 0, valueLength = value.length; j < valueLength; ++j) {
        buffer += this.renderTokens(token[4], context.push(value[j]), partials, originalTemplate);
      }
    } else if (typeof value === 'object' || typeof value === 'string' || typeof value === 'number') {
      buffer += this.renderTokens(token[4], context.push(value), partials, originalTemplate);
    } else if (isFunction(value)) {
      if (typeof originalTemplate !== 'string')
        throw new Error('Cannot use higher-order sections without the original template');

      // Extract the portion of the original template that the section contains.
      value = value.call(context.view, originalTemplate.slice(token[3], token[5]), subRender);

      if (value != null)
        buffer += value;
    } else {
      buffer += this.renderTokens(token[4], context, partials, originalTemplate);
    }
    return buffer;
  };

  Writer.prototype.renderInverted = function renderInverted (token, context, partials, originalTemplate) {
    var value = context.lookup(token[1]);

    // Use JavaScript's definition of falsy. Include empty arrays.
    // See https://github.com/janl/mustache.js/issues/186
    if (!value || (isArray(value) && value.length === 0))
      return this.renderTokens(token[4], context, partials, originalTemplate);
  };

  Writer.prototype.renderPartial = function renderPartial (token, context, partials) {
    if (!partials) return;

    var value = isFunction(partials) ? partials(token[1]) : partials[token[1]];
    if (value != null)
      return this.renderTokens(this.parse(value), context, partials, value);
  };

  Writer.prototype.unescapedValue = function unescapedValue (token, context) {
    var value = context.lookup(token[1]);
    if (value != null)
      return value;
  };

  Writer.prototype.escapedValue = function escapedValue (token, context) {
    var value = context.lookup(token[1]);
    if (value != null)
      return mustache.escape(value);
  };

  Writer.prototype.rawValue = function rawValue (token) {
    return token[1];
  };

  mustache.name = 'mustache.js';
  mustache.version = '2.2.1';
  mustache.tags = [ '{{', '}}' ];

  // All high-level mustache.* functions use this writer.
  var defaultWriter = new Writer();

  /**
   * Clears all cached templates in the default writer.
   */
  mustache.clearCache = function clearCache () {
    return defaultWriter.clearCache();
  };

  /**
   * Parses and caches the given template in the default writer and returns the
   * array of tokens it contains. Doing this ahead of time avoids the need to
   * parse templates on the fly as they are rendered.
   */
  mustache.parse = function parse (template, tags) {
    return defaultWriter.parse(template, tags);
  };

  /**
   * Renders the `template` with the given `view` and `partials` using the
   * default writer.
   */
  mustache.render = function render (template, view, partials) {
    if (typeof template !== 'string') {
      throw new TypeError('Invalid template! Template should be a "string" ' +
                          'but "' + typeStr(template) + '" was given as the first ' +
                          'argument for mustache#render(template, view, partials)');
    }

    return defaultWriter.render(template, view, partials);
  };

  // This is here for backwards compatibility with 0.4.x.,
  /*eslint-disable */ // eslint wants camel cased function name
  mustache.to_html = function to_html (template, view, partials, send) {
    /*eslint-enable*/

    var result = mustache.render(template, view, partials);

    if (isFunction(send)) {
      send(result);
    } else {
      return result;
    }
  };

  // Export the escaping function so that the user may override it.
  // See https://github.com/janl/mustache.js/issues/244
  mustache.escape = escapeHtml;

  // Export these mainly for testing, but also for advanced usage.
  mustache.Scanner = Scanner;
  mustache.Context = Context;
  mustache.Writer = Writer;

}));

},{}],5:[function(require,module,exports){
/*!
 * ZeroClipboard
 * The ZeroClipboard library provides an easy way to copy text to the clipboard using an invisible Adobe Flash movie and a JavaScript interface.
 * Copyright (c) 2009-2014 Jon Rohan, James M. Greene
 * Licensed MIT
 * http://zeroclipboard.org/
 * v2.2.0
 */
(function(window, undefined) {
  "use strict";
  /**
 * Store references to critically important global functions that may be
 * overridden on certain web pages.
 */
  var _window = window, _document = _window.document, _navigator = _window.navigator, _setTimeout = _window.setTimeout, _clearTimeout = _window.clearTimeout, _setInterval = _window.setInterval, _clearInterval = _window.clearInterval, _getComputedStyle = _window.getComputedStyle, _encodeURIComponent = _window.encodeURIComponent, _ActiveXObject = _window.ActiveXObject, _Error = _window.Error, _parseInt = _window.Number.parseInt || _window.parseInt, _parseFloat = _window.Number.parseFloat || _window.parseFloat, _isNaN = _window.Number.isNaN || _window.isNaN, _now = _window.Date.now, _keys = _window.Object.keys, _defineProperty = _window.Object.defineProperty, _hasOwn = _window.Object.prototype.hasOwnProperty, _slice = _window.Array.prototype.slice, _unwrap = function() {
    var unwrapper = function(el) {
      return el;
    };
    if (typeof _window.wrap === "function" && typeof _window.unwrap === "function") {
      try {
        var div = _document.createElement("div");
        var unwrappedDiv = _window.unwrap(div);
        if (div.nodeType === 1 && unwrappedDiv && unwrappedDiv.nodeType === 1) {
          unwrapper = _window.unwrap;
        }
      } catch (e) {}
    }
    return unwrapper;
  }();
  /**
 * Convert an `arguments` object into an Array.
 *
 * @returns The arguments as an Array
 * @private
 */
  var _args = function(argumentsObj) {
    return _slice.call(argumentsObj, 0);
  };
  /**
 * Shallow-copy the owned, enumerable properties of one object over to another, similar to jQuery's `$.extend`.
 *
 * @returns The target object, augmented
 * @private
 */
  var _extend = function() {
    var i, len, arg, prop, src, copy, args = _args(arguments), target = args[0] || {};
    for (i = 1, len = args.length; i < len; i++) {
      if ((arg = args[i]) != null) {
        for (prop in arg) {
          if (_hasOwn.call(arg, prop)) {
            src = target[prop];
            copy = arg[prop];
            if (target !== copy && copy !== undefined) {
              target[prop] = copy;
            }
          }
        }
      }
    }
    return target;
  };
  /**
 * Return a deep copy of the source object or array.
 *
 * @returns Object or Array
 * @private
 */
  var _deepCopy = function(source) {
    var copy, i, len, prop;
    if (typeof source !== "object" || source == null || typeof source.nodeType === "number") {
      copy = source;
    } else if (typeof source.length === "number") {
      copy = [];
      for (i = 0, len = source.length; i < len; i++) {
        if (_hasOwn.call(source, i)) {
          copy[i] = _deepCopy(source[i]);
        }
      }
    } else {
      copy = {};
      for (prop in source) {
        if (_hasOwn.call(source, prop)) {
          copy[prop] = _deepCopy(source[prop]);
        }
      }
    }
    return copy;
  };
  /**
 * Makes a shallow copy of `obj` (like `_extend`) but filters its properties based on a list of `keys` to keep.
 * The inverse of `_omit`, mostly. The big difference is that these properties do NOT need to be enumerable to
 * be kept.
 *
 * @returns A new filtered object.
 * @private
 */
  var _pick = function(obj, keys) {
    var newObj = {};
    for (var i = 0, len = keys.length; i < len; i++) {
      if (keys[i] in obj) {
        newObj[keys[i]] = obj[keys[i]];
      }
    }
    return newObj;
  };
  /**
 * Makes a shallow copy of `obj` (like `_extend`) but filters its properties based on a list of `keys` to omit.
 * The inverse of `_pick`.
 *
 * @returns A new filtered object.
 * @private
 */
  var _omit = function(obj, keys) {
    var newObj = {};
    for (var prop in obj) {
      if (keys.indexOf(prop) === -1) {
        newObj[prop] = obj[prop];
      }
    }
    return newObj;
  };
  /**
 * Remove all owned, enumerable properties from an object.
 *
 * @returns The original object without its owned, enumerable properties.
 * @private
 */
  var _deleteOwnProperties = function(obj) {
    if (obj) {
      for (var prop in obj) {
        if (_hasOwn.call(obj, prop)) {
          delete obj[prop];
        }
      }
    }
    return obj;
  };
  /**
 * Determine if an element is contained within another element.
 *
 * @returns Boolean
 * @private
 */
  var _containedBy = function(el, ancestorEl) {
    if (el && el.nodeType === 1 && el.ownerDocument && ancestorEl && (ancestorEl.nodeType === 1 && ancestorEl.ownerDocument && ancestorEl.ownerDocument === el.ownerDocument || ancestorEl.nodeType === 9 && !ancestorEl.ownerDocument && ancestorEl === el.ownerDocument)) {
      do {
        if (el === ancestorEl) {
          return true;
        }
        el = el.parentNode;
      } while (el);
    }
    return false;
  };
  /**
 * Get the URL path's parent directory.
 *
 * @returns String or `undefined`
 * @private
 */
  var _getDirPathOfUrl = function(url) {
    var dir;
    if (typeof url === "string" && url) {
      dir = url.split("#")[0].split("?")[0];
      dir = url.slice(0, url.lastIndexOf("/") + 1);
    }
    return dir;
  };
  /**
 * Get the current script's URL by throwing an `Error` and analyzing it.
 *
 * @returns String or `undefined`
 * @private
 */
  var _getCurrentScriptUrlFromErrorStack = function(stack) {
    var url, matches;
    if (typeof stack === "string" && stack) {
      matches = stack.match(/^(?:|[^:@]*@|.+\)@(?=http[s]?|file)|.+?\s+(?: at |@)(?:[^:\(]+ )*[\(]?)((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/);
      if (matches && matches[1]) {
        url = matches[1];
      } else {
        matches = stack.match(/\)@((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/);
        if (matches && matches[1]) {
          url = matches[1];
        }
      }
    }
    return url;
  };
  /**
 * Get the current script's URL by throwing an `Error` and analyzing it.
 *
 * @returns String or `undefined`
 * @private
 */
  var _getCurrentScriptUrlFromError = function() {
    var url, err;
    try {
      throw new _Error();
    } catch (e) {
      err = e;
    }
    if (err) {
      url = err.sourceURL || err.fileName || _getCurrentScriptUrlFromErrorStack(err.stack);
    }
    return url;
  };
  /**
 * Get the current script's URL.
 *
 * @returns String or `undefined`
 * @private
 */
  var _getCurrentScriptUrl = function() {
    var jsPath, scripts, i;
    if (_document.currentScript && (jsPath = _document.currentScript.src)) {
      return jsPath;
    }
    scripts = _document.getElementsByTagName("script");
    if (scripts.length === 1) {
      return scripts[0].src || undefined;
    }
    if ("readyState" in scripts[0]) {
      for (i = scripts.length; i--; ) {
        if (scripts[i].readyState === "interactive" && (jsPath = scripts[i].src)) {
          return jsPath;
        }
      }
    }
    if (_document.readyState === "loading" && (jsPath = scripts[scripts.length - 1].src)) {
      return jsPath;
    }
    if (jsPath = _getCurrentScriptUrlFromError()) {
      return jsPath;
    }
    return undefined;
  };
  /**
 * Get the unanimous parent directory of ALL script tags.
 * If any script tags are either (a) inline or (b) from differing parent
 * directories, this method must return `undefined`.
 *
 * @returns String or `undefined`
 * @private
 */
  var _getUnanimousScriptParentDir = function() {
    var i, jsDir, jsPath, scripts = _document.getElementsByTagName("script");
    for (i = scripts.length; i--; ) {
      if (!(jsPath = scripts[i].src)) {
        jsDir = null;
        break;
      }
      jsPath = _getDirPathOfUrl(jsPath);
      if (jsDir == null) {
        jsDir = jsPath;
      } else if (jsDir !== jsPath) {
        jsDir = null;
        break;
      }
    }
    return jsDir || undefined;
  };
  /**
 * Get the presumed location of the "ZeroClipboard.swf" file, based on the location
 * of the executing JavaScript file (e.g. "ZeroClipboard.js", etc.).
 *
 * @returns String
 * @private
 */
  var _getDefaultSwfPath = function() {
    var jsDir = _getDirPathOfUrl(_getCurrentScriptUrl()) || _getUnanimousScriptParentDir() || "";
    return jsDir + "ZeroClipboard.swf";
  };
  /**
 * Keep track of if the page is framed (in an `iframe`). This can never change.
 * @private
 */
  var _pageIsFramed = function() {
    return window.opener == null && (!!window.top && window != window.top || !!window.parent && window != window.parent);
  }();
  /**
 * Keep track of the state of the Flash object.
 * @private
 */
  var _flashState = {
    bridge: null,
    version: "0.0.0",
    pluginType: "unknown",
    disabled: null,
    outdated: null,
    sandboxed: null,
    unavailable: null,
    degraded: null,
    deactivated: null,
    overdue: null,
    ready: null
  };
  /**
 * The minimum Flash Player version required to use ZeroClipboard completely.
 * @readonly
 * @private
 */
  var _minimumFlashVersion = "11.0.0";
  /**
 * The ZeroClipboard library version number, as reported by Flash, at the time the SWF was compiled.
 */
  var _zcSwfVersion;
  /**
 * Keep track of all event listener registrations.
 * @private
 */
  var _handlers = {};
  /**
 * Keep track of the currently activated element.
 * @private
 */
  var _currentElement;
  /**
 * Keep track of the element that was activated when a `copy` process started.
 * @private
 */
  var _copyTarget;
  /**
 * Keep track of data for the pending clipboard transaction.
 * @private
 */
  var _clipData = {};
  /**
 * Keep track of data formats for the pending clipboard transaction.
 * @private
 */
  var _clipDataFormatMap = null;
  /**
 * Keep track of the Flash availability check timeout.
 * @private
 */
  var _flashCheckTimeout = 0;
  /**
 * Keep track of SWF network errors interval polling.
 * @private
 */
  var _swfFallbackCheckInterval = 0;
  /**
 * The `message` store for events
 * @private
 */
  var _eventMessages = {
    ready: "Flash communication is established",
    error: {
      "flash-disabled": "Flash is disabled or not installed. May also be attempting to run Flash in a sandboxed iframe, which is impossible.",
      "flash-outdated": "Flash is too outdated to support ZeroClipboard",
      "flash-sandboxed": "Attempting to run Flash in a sandboxed iframe, which is impossible",
      "flash-unavailable": "Flash is unable to communicate bidirectionally with JavaScript",
      "flash-degraded": "Flash is unable to preserve data fidelity when communicating with JavaScript",
      "flash-deactivated": "Flash is too outdated for your browser and/or is configured as click-to-activate.\nThis may also mean that the ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity.\nMay also be attempting to run Flash in a sandboxed iframe, which is impossible.",
      "flash-overdue": "Flash communication was established but NOT within the acceptable time limit",
      "version-mismatch": "ZeroClipboard JS version number does not match ZeroClipboard SWF version number",
      "clipboard-error": "At least one error was thrown while ZeroClipboard was attempting to inject your data into the clipboard",
      "config-mismatch": "ZeroClipboard configuration does not match Flash's reality",
      "swf-not-found": "The ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity"
    }
  };
  /**
 * The `name`s of `error` events that can only occur is Flash has at least
 * been able to load the SWF successfully.
 * @private
 */
  var _errorsThatOnlyOccurAfterFlashLoads = [ "flash-unavailable", "flash-degraded", "flash-overdue", "version-mismatch", "config-mismatch", "clipboard-error" ];
  /**
 * The `name`s of `error` events that should likely result in the `_flashState`
 * variable's property values being updated.
 * @private
 */
  var _flashStateErrorNames = [ "flash-disabled", "flash-outdated", "flash-sandboxed", "flash-unavailable", "flash-degraded", "flash-deactivated", "flash-overdue" ];
  /**
 * A RegExp to match the `name` property of `error` events related to Flash.
 * @private
 */
  var _flashStateErrorNameMatchingRegex = new RegExp("^flash-(" + _flashStateErrorNames.map(function(errorName) {
    return errorName.replace(/^flash-/, "");
  }).join("|") + ")$");
  /**
 * A RegExp to match the `name` property of `error` events related to Flash,
 * which is enabled.
 * @private
 */
  var _flashStateEnabledErrorNameMatchingRegex = new RegExp("^flash-(" + _flashStateErrorNames.slice(1).map(function(errorName) {
    return errorName.replace(/^flash-/, "");
  }).join("|") + ")$");
  /**
 * ZeroClipboard configuration defaults for the Core module.
 * @private
 */
  var _globalConfig = {
    swfPath: _getDefaultSwfPath(),
    trustedDomains: window.location.host ? [ window.location.host ] : [],
    cacheBust: true,
    forceEnhancedClipboard: false,
    flashLoadTimeout: 3e4,
    autoActivate: true,
    bubbleEvents: true,
    containerId: "global-zeroclipboard-html-bridge",
    containerClass: "global-zeroclipboard-container",
    swfObjectId: "global-zeroclipboard-flash-bridge",
    hoverClass: "zeroclipboard-is-hover",
    activeClass: "zeroclipboard-is-active",
    forceHandCursor: false,
    title: null,
    zIndex: 999999999
  };
  /**
 * The underlying implementation of `ZeroClipboard.config`.
 * @private
 */
  var _config = function(options) {
    if (typeof options === "object" && options !== null) {
      for (var prop in options) {
        if (_hasOwn.call(options, prop)) {
          if (/^(?:forceHandCursor|title|zIndex|bubbleEvents)$/.test(prop)) {
            _globalConfig[prop] = options[prop];
          } else if (_flashState.bridge == null) {
            if (prop === "containerId" || prop === "swfObjectId") {
              if (_isValidHtml4Id(options[prop])) {
                _globalConfig[prop] = options[prop];
              } else {
                throw new Error("The specified `" + prop + "` value is not valid as an HTML4 Element ID");
              }
            } else {
              _globalConfig[prop] = options[prop];
            }
          }
        }
      }
    }
    if (typeof options === "string" && options) {
      if (_hasOwn.call(_globalConfig, options)) {
        return _globalConfig[options];
      }
      return;
    }
    return _deepCopy(_globalConfig);
  };
  /**
 * The underlying implementation of `ZeroClipboard.state`.
 * @private
 */
  var _state = function() {
    _detectSandbox();
    return {
      browser: _pick(_navigator, [ "userAgent", "platform", "appName" ]),
      flash: _omit(_flashState, [ "bridge" ]),
      zeroclipboard: {
        version: ZeroClipboard.version,
        config: ZeroClipboard.config()
      }
    };
  };
  /**
 * The underlying implementation of `ZeroClipboard.isFlashUnusable`.
 * @private
 */
  var _isFlashUnusable = function() {
    return !!(_flashState.disabled || _flashState.outdated || _flashState.sandboxed || _flashState.unavailable || _flashState.degraded || _flashState.deactivated);
  };
  /**
 * The underlying implementation of `ZeroClipboard.on`.
 * @private
 */
  var _on = function(eventType, listener) {
    var i, len, events, added = {};
    if (typeof eventType === "string" && eventType) {
      events = eventType.toLowerCase().split(/\s+/);
    } else if (typeof eventType === "object" && eventType && typeof listener === "undefined") {
      for (i in eventType) {
        if (_hasOwn.call(eventType, i) && typeof i === "string" && i && typeof eventType[i] === "function") {
          ZeroClipboard.on(i, eventType[i]);
        }
      }
    }
    if (events && events.length) {
      for (i = 0, len = events.length; i < len; i++) {
        eventType = events[i].replace(/^on/, "");
        added[eventType] = true;
        if (!_handlers[eventType]) {
          _handlers[eventType] = [];
        }
        _handlers[eventType].push(listener);
      }
      if (added.ready && _flashState.ready) {
        ZeroClipboard.emit({
          type: "ready"
        });
      }
      if (added.error) {
        for (i = 0, len = _flashStateErrorNames.length; i < len; i++) {
          if (_flashState[_flashStateErrorNames[i].replace(/^flash-/, "")] === true) {
            ZeroClipboard.emit({
              type: "error",
              name: _flashStateErrorNames[i]
            });
            break;
          }
        }
        if (_zcSwfVersion !== undefined && ZeroClipboard.version !== _zcSwfVersion) {
          ZeroClipboard.emit({
            type: "error",
            name: "version-mismatch",
            jsVersion: ZeroClipboard.version,
            swfVersion: _zcSwfVersion
          });
        }
      }
    }
    return ZeroClipboard;
  };
  /**
 * The underlying implementation of `ZeroClipboard.off`.
 * @private
 */
  var _off = function(eventType, listener) {
    var i, len, foundIndex, events, perEventHandlers;
    if (arguments.length === 0) {
      events = _keys(_handlers);
    } else if (typeof eventType === "string" && eventType) {
      events = eventType.split(/\s+/);
    } else if (typeof eventType === "object" && eventType && typeof listener === "undefined") {
      for (i in eventType) {
        if (_hasOwn.call(eventType, i) && typeof i === "string" && i && typeof eventType[i] === "function") {
          ZeroClipboard.off(i, eventType[i]);
        }
      }
    }
    if (events && events.length) {
      for (i = 0, len = events.length; i < len; i++) {
        eventType = events[i].toLowerCase().replace(/^on/, "");
        perEventHandlers = _handlers[eventType];
        if (perEventHandlers && perEventHandlers.length) {
          if (listener) {
            foundIndex = perEventHandlers.indexOf(listener);
            while (foundIndex !== -1) {
              perEventHandlers.splice(foundIndex, 1);
              foundIndex = perEventHandlers.indexOf(listener, foundIndex);
            }
          } else {
            perEventHandlers.length = 0;
          }
        }
      }
    }
    return ZeroClipboard;
  };
  /**
 * The underlying implementation of `ZeroClipboard.handlers`.
 * @private
 */
  var _listeners = function(eventType) {
    var copy;
    if (typeof eventType === "string" && eventType) {
      copy = _deepCopy(_handlers[eventType]) || null;
    } else {
      copy = _deepCopy(_handlers);
    }
    return copy;
  };
  /**
 * The underlying implementation of `ZeroClipboard.emit`.
 * @private
 */
  var _emit = function(event) {
    var eventCopy, returnVal, tmp;
    event = _createEvent(event);
    if (!event) {
      return;
    }
    if (_preprocessEvent(event)) {
      return;
    }
    if (event.type === "ready" && _flashState.overdue === true) {
      return ZeroClipboard.emit({
        type: "error",
        name: "flash-overdue"
      });
    }
    eventCopy = _extend({}, event);
    _dispatchCallbacks.call(this, eventCopy);
    if (event.type === "copy") {
      tmp = _mapClipDataToFlash(_clipData);
      returnVal = tmp.data;
      _clipDataFormatMap = tmp.formatMap;
    }
    return returnVal;
  };
  /**
 * The underlying implementation of `ZeroClipboard.create`.
 * @private
 */
  var _create = function() {
    var previousState = _flashState.sandboxed;
    _detectSandbox();
    if (typeof _flashState.ready !== "boolean") {
      _flashState.ready = false;
    }
    if (_flashState.sandboxed !== previousState && _flashState.sandboxed === true) {
      _flashState.ready = false;
      ZeroClipboard.emit({
        type: "error",
        name: "flash-sandboxed"
      });
    } else if (!ZeroClipboard.isFlashUnusable() && _flashState.bridge === null) {
      var maxWait = _globalConfig.flashLoadTimeout;
      if (typeof maxWait === "number" && maxWait >= 0) {
        _flashCheckTimeout = _setTimeout(function() {
          if (typeof _flashState.deactivated !== "boolean") {
            _flashState.deactivated = true;
          }
          if (_flashState.deactivated === true) {
            ZeroClipboard.emit({
              type: "error",
              name: "flash-deactivated"
            });
          }
        }, maxWait);
      }
      _flashState.overdue = false;
      _embedSwf();
    }
  };
  /**
 * The underlying implementation of `ZeroClipboard.destroy`.
 * @private
 */
  var _destroy = function() {
    ZeroClipboard.clearData();
    ZeroClipboard.blur();
    ZeroClipboard.emit("destroy");
    _unembedSwf();
    ZeroClipboard.off();
  };
  /**
 * The underlying implementation of `ZeroClipboard.setData`.
 * @private
 */
  var _setData = function(format, data) {
    var dataObj;
    if (typeof format === "object" && format && typeof data === "undefined") {
      dataObj = format;
      ZeroClipboard.clearData();
    } else if (typeof format === "string" && format) {
      dataObj = {};
      dataObj[format] = data;
    } else {
      return;
    }
    for (var dataFormat in dataObj) {
      if (typeof dataFormat === "string" && dataFormat && _hasOwn.call(dataObj, dataFormat) && typeof dataObj[dataFormat] === "string" && dataObj[dataFormat]) {
        _clipData[dataFormat] = dataObj[dataFormat];
      }
    }
  };
  /**
 * The underlying implementation of `ZeroClipboard.clearData`.
 * @private
 */
  var _clearData = function(format) {
    if (typeof format === "undefined") {
      _deleteOwnProperties(_clipData);
      _clipDataFormatMap = null;
    } else if (typeof format === "string" && _hasOwn.call(_clipData, format)) {
      delete _clipData[format];
    }
  };
  /**
 * The underlying implementation of `ZeroClipboard.getData`.
 * @private
 */
  var _getData = function(format) {
    if (typeof format === "undefined") {
      return _deepCopy(_clipData);
    } else if (typeof format === "string" && _hasOwn.call(_clipData, format)) {
      return _clipData[format];
    }
  };
  /**
 * The underlying implementation of `ZeroClipboard.focus`/`ZeroClipboard.activate`.
 * @private
 */
  var _focus = function(element) {
    if (!(element && element.nodeType === 1)) {
      return;
    }
    if (_currentElement) {
      _removeClass(_currentElement, _globalConfig.activeClass);
      if (_currentElement !== element) {
        _removeClass(_currentElement, _globalConfig.hoverClass);
      }
    }
    _currentElement = element;
    _addClass(element, _globalConfig.hoverClass);
    var newTitle = element.getAttribute("title") || _globalConfig.title;
    if (typeof newTitle === "string" && newTitle) {
      var htmlBridge = _getHtmlBridge(_flashState.bridge);
      if (htmlBridge) {
        htmlBridge.setAttribute("title", newTitle);
      }
    }
    var useHandCursor = _globalConfig.forceHandCursor === true || _getStyle(element, "cursor") === "pointer";
    _setHandCursor(useHandCursor);
    _reposition();
  };
  /**
 * The underlying implementation of `ZeroClipboard.blur`/`ZeroClipboard.deactivate`.
 * @private
 */
  var _blur = function() {
    var htmlBridge = _getHtmlBridge(_flashState.bridge);
    if (htmlBridge) {
      htmlBridge.removeAttribute("title");
      htmlBridge.style.left = "0px";
      htmlBridge.style.top = "-9999px";
      htmlBridge.style.width = "1px";
      htmlBridge.style.height = "1px";
    }
    if (_currentElement) {
      _removeClass(_currentElement, _globalConfig.hoverClass);
      _removeClass(_currentElement, _globalConfig.activeClass);
      _currentElement = null;
    }
  };
  /**
 * The underlying implementation of `ZeroClipboard.activeElement`.
 * @private
 */
  var _activeElement = function() {
    return _currentElement || null;
  };
  /**
 * Check if a value is a valid HTML4 `ID` or `Name` token.
 * @private
 */
  var _isValidHtml4Id = function(id) {
    return typeof id === "string" && id && /^[A-Za-z][A-Za-z0-9_:\-\.]*$/.test(id);
  };
  /**
 * Create or update an `event` object, based on the `eventType`.
 * @private
 */
  var _createEvent = function(event) {
    var eventType;
    if (typeof event === "string" && event) {
      eventType = event;
      event = {};
    } else if (typeof event === "object" && event && typeof event.type === "string" && event.type) {
      eventType = event.type;
    }
    if (!eventType) {
      return;
    }
    eventType = eventType.toLowerCase();
    if (!event.target && (/^(copy|aftercopy|_click)$/.test(eventType) || eventType === "error" && event.name === "clipboard-error")) {
      event.target = _copyTarget;
    }
    _extend(event, {
      type: eventType,
      target: event.target || _currentElement || null,
      relatedTarget: event.relatedTarget || null,
      currentTarget: _flashState && _flashState.bridge || null,
      timeStamp: event.timeStamp || _now() || null
    });
    var msg = _eventMessages[event.type];
    if (event.type === "error" && event.name && msg) {
      msg = msg[event.name];
    }
    if (msg) {
      event.message = msg;
    }
    if (event.type === "ready") {
      _extend(event, {
        target: null,
        version: _flashState.version
      });
    }
    if (event.type === "error") {
      if (_flashStateErrorNameMatchingRegex.test(event.name)) {
        _extend(event, {
          target: null,
          minimumVersion: _minimumFlashVersion
        });
      }
      if (_flashStateEnabledErrorNameMatchingRegex.test(event.name)) {
        _extend(event, {
          version: _flashState.version
        });
      }
    }
    if (event.type === "copy") {
      event.clipboardData = {
        setData: ZeroClipboard.setData,
        clearData: ZeroClipboard.clearData
      };
    }
    if (event.type === "aftercopy") {
      event = _mapClipResultsFromFlash(event, _clipDataFormatMap);
    }
    if (event.target && !event.relatedTarget) {
      event.relatedTarget = _getRelatedTarget(event.target);
    }
    return _addMouseData(event);
  };
  /**
 * Get a relatedTarget from the target's `data-clipboard-target` attribute
 * @private
 */
  var _getRelatedTarget = function(targetEl) {
    var relatedTargetId = targetEl && targetEl.getAttribute && targetEl.getAttribute("data-clipboard-target");
    return relatedTargetId ? _document.getElementById(relatedTargetId) : null;
  };
  /**
 * Add element and position data to `MouseEvent` instances
 * @private
 */
  var _addMouseData = function(event) {
    if (event && /^_(?:click|mouse(?:over|out|down|up|move))$/.test(event.type)) {
      var srcElement = event.target;
      var fromElement = event.type === "_mouseover" && event.relatedTarget ? event.relatedTarget : undefined;
      var toElement = event.type === "_mouseout" && event.relatedTarget ? event.relatedTarget : undefined;
      var pos = _getElementPosition(srcElement);
      var screenLeft = _window.screenLeft || _window.screenX || 0;
      var screenTop = _window.screenTop || _window.screenY || 0;
      var scrollLeft = _document.body.scrollLeft + _document.documentElement.scrollLeft;
      var scrollTop = _document.body.scrollTop + _document.documentElement.scrollTop;
      var pageX = pos.left + (typeof event._stageX === "number" ? event._stageX : 0);
      var pageY = pos.top + (typeof event._stageY === "number" ? event._stageY : 0);
      var clientX = pageX - scrollLeft;
      var clientY = pageY - scrollTop;
      var screenX = screenLeft + clientX;
      var screenY = screenTop + clientY;
      var moveX = typeof event.movementX === "number" ? event.movementX : 0;
      var moveY = typeof event.movementY === "number" ? event.movementY : 0;
      delete event._stageX;
      delete event._stageY;
      _extend(event, {
        srcElement: srcElement,
        fromElement: fromElement,
        toElement: toElement,
        screenX: screenX,
        screenY: screenY,
        pageX: pageX,
        pageY: pageY,
        clientX: clientX,
        clientY: clientY,
        x: clientX,
        y: clientY,
        movementX: moveX,
        movementY: moveY,
        offsetX: 0,
        offsetY: 0,
        layerX: 0,
        layerY: 0
      });
    }
    return event;
  };
  /**
 * Determine if an event's registered handlers should be execute synchronously or asynchronously.
 *
 * @returns {boolean}
 * @private
 */
  var _shouldPerformAsync = function(event) {
    var eventType = event && typeof event.type === "string" && event.type || "";
    return !/^(?:(?:before)?copy|destroy)$/.test(eventType);
  };
  /**
 * Control if a callback should be executed asynchronously or not.
 *
 * @returns `undefined`
 * @private
 */
  var _dispatchCallback = function(func, context, args, async) {
    if (async) {
      _setTimeout(function() {
        func.apply(context, args);
      }, 0);
    } else {
      func.apply(context, args);
    }
  };
  /**
 * Handle the actual dispatching of events to client instances.
 *
 * @returns `undefined`
 * @private
 */
  var _dispatchCallbacks = function(event) {
    if (!(typeof event === "object" && event && event.type)) {
      return;
    }
    var async = _shouldPerformAsync(event);
    var wildcardTypeHandlers = _handlers["*"] || [];
    var specificTypeHandlers = _handlers[event.type] || [];
    var handlers = wildcardTypeHandlers.concat(specificTypeHandlers);
    if (handlers && handlers.length) {
      var i, len, func, context, eventCopy, originalContext = this;
      for (i = 0, len = handlers.length; i < len; i++) {
        func = handlers[i];
        context = originalContext;
        if (typeof func === "string" && typeof _window[func] === "function") {
          func = _window[func];
        }
        if (typeof func === "object" && func && typeof func.handleEvent === "function") {
          context = func;
          func = func.handleEvent;
        }
        if (typeof func === "function") {
          eventCopy = _extend({}, event);
          _dispatchCallback(func, context, [ eventCopy ], async);
        }
      }
    }
    return this;
  };
  /**
 * Check an `error` event's `name` property to see if Flash has
 * already loaded, which rules out possible `iframe` sandboxing.
 * @private
 */
  var _getSandboxStatusFromErrorEvent = function(event) {
    var isSandboxed = null;
    if (_pageIsFramed === false || event && event.type === "error" && event.name && _errorsThatOnlyOccurAfterFlashLoads.indexOf(event.name) !== -1) {
      isSandboxed = false;
    }
    return isSandboxed;
  };
  /**
 * Preprocess any special behaviors, reactions, or state changes after receiving this event.
 * Executes only once per event emitted, NOT once per client.
 * @private
 */
  var _preprocessEvent = function(event) {
    var element = event.target || _currentElement || null;
    var sourceIsSwf = event._source === "swf";
    delete event._source;
    switch (event.type) {
     case "error":
      var isSandboxed = event.name === "flash-sandboxed" || _getSandboxStatusFromErrorEvent(event);
      if (typeof isSandboxed === "boolean") {
        _flashState.sandboxed = isSandboxed;
      }
      if (_flashStateErrorNames.indexOf(event.name) !== -1) {
        _extend(_flashState, {
          disabled: event.name === "flash-disabled",
          outdated: event.name === "flash-outdated",
          unavailable: event.name === "flash-unavailable",
          degraded: event.name === "flash-degraded",
          deactivated: event.name === "flash-deactivated",
          overdue: event.name === "flash-overdue",
          ready: false
        });
      } else if (event.name === "version-mismatch") {
        _zcSwfVersion = event.swfVersion;
        _extend(_flashState, {
          disabled: false,
          outdated: false,
          unavailable: false,
          degraded: false,
          deactivated: false,
          overdue: false,
          ready: false
        });
      }
      _clearTimeoutsAndPolling();
      break;

     case "ready":
      _zcSwfVersion = event.swfVersion;
      var wasDeactivated = _flashState.deactivated === true;
      _extend(_flashState, {
        disabled: false,
        outdated: false,
        sandboxed: false,
        unavailable: false,
        degraded: false,
        deactivated: false,
        overdue: wasDeactivated,
        ready: !wasDeactivated
      });
      _clearTimeoutsAndPolling();
      break;

     case "beforecopy":
      _copyTarget = element;
      break;

     case "copy":
      var textContent, htmlContent, targetEl = event.relatedTarget;
      if (!(_clipData["text/html"] || _clipData["text/plain"]) && targetEl && (htmlContent = targetEl.value || targetEl.outerHTML || targetEl.innerHTML) && (textContent = targetEl.value || targetEl.textContent || targetEl.innerText)) {
        event.clipboardData.clearData();
        event.clipboardData.setData("text/plain", textContent);
        if (htmlContent !== textContent) {
          event.clipboardData.setData("text/html", htmlContent);
        }
      } else if (!_clipData["text/plain"] && event.target && (textContent = event.target.getAttribute("data-clipboard-text"))) {
        event.clipboardData.clearData();
        event.clipboardData.setData("text/plain", textContent);
      }
      break;

     case "aftercopy":
      _queueEmitClipboardErrors(event);
      ZeroClipboard.clearData();
      if (element && element !== _safeActiveElement() && element.focus) {
        element.focus();
      }
      break;

     case "_mouseover":
      ZeroClipboard.focus(element);
      if (_globalConfig.bubbleEvents === true && sourceIsSwf) {
        if (element && element !== event.relatedTarget && !_containedBy(event.relatedTarget, element)) {
          _fireMouseEvent(_extend({}, event, {
            type: "mouseenter",
            bubbles: false,
            cancelable: false
          }));
        }
        _fireMouseEvent(_extend({}, event, {
          type: "mouseover"
        }));
      }
      break;

     case "_mouseout":
      ZeroClipboard.blur();
      if (_globalConfig.bubbleEvents === true && sourceIsSwf) {
        if (element && element !== event.relatedTarget && !_containedBy(event.relatedTarget, element)) {
          _fireMouseEvent(_extend({}, event, {
            type: "mouseleave",
            bubbles: false,
            cancelable: false
          }));
        }
        _fireMouseEvent(_extend({}, event, {
          type: "mouseout"
        }));
      }
      break;

     case "_mousedown":
      _addClass(element, _globalConfig.activeClass);
      if (_globalConfig.bubbleEvents === true && sourceIsSwf) {
        _fireMouseEvent(_extend({}, event, {
          type: event.type.slice(1)
        }));
      }
      break;

     case "_mouseup":
      _removeClass(element, _globalConfig.activeClass);
      if (_globalConfig.bubbleEvents === true && sourceIsSwf) {
        _fireMouseEvent(_extend({}, event, {
          type: event.type.slice(1)
        }));
      }
      break;

     case "_click":
      _copyTarget = null;
      if (_globalConfig.bubbleEvents === true && sourceIsSwf) {
        _fireMouseEvent(_extend({}, event, {
          type: event.type.slice(1)
        }));
      }
      break;

     case "_mousemove":
      if (_globalConfig.bubbleEvents === true && sourceIsSwf) {
        _fireMouseEvent(_extend({}, event, {
          type: event.type.slice(1)
        }));
      }
      break;
    }
    if (/^_(?:click|mouse(?:over|out|down|up|move))$/.test(event.type)) {
      return true;
    }
  };
  /**
 * Check an "aftercopy" event for clipboard errors and emit a corresponding "error" event.
 * @private
 */
  var _queueEmitClipboardErrors = function(aftercopyEvent) {
    if (aftercopyEvent.errors && aftercopyEvent.errors.length > 0) {
      var errorEvent = _deepCopy(aftercopyEvent);
      _extend(errorEvent, {
        type: "error",
        name: "clipboard-error"
      });
      delete errorEvent.success;
      _setTimeout(function() {
        ZeroClipboard.emit(errorEvent);
      }, 0);
    }
  };
  /**
 * Dispatch a synthetic MouseEvent.
 *
 * @returns `undefined`
 * @private
 */
  var _fireMouseEvent = function(event) {
    if (!(event && typeof event.type === "string" && event)) {
      return;
    }
    var e, target = event.target || null, doc = target && target.ownerDocument || _document, defaults = {
      view: doc.defaultView || _window,
      canBubble: true,
      cancelable: true,
      detail: event.type === "click" ? 1 : 0,
      button: typeof event.which === "number" ? event.which - 1 : typeof event.button === "number" ? event.button : doc.createEvent ? 0 : 1
    }, args = _extend(defaults, event);
    if (!target) {
      return;
    }
    if (doc.createEvent && target.dispatchEvent) {
      args = [ args.type, args.canBubble, args.cancelable, args.view, args.detail, args.screenX, args.screenY, args.clientX, args.clientY, args.ctrlKey, args.altKey, args.shiftKey, args.metaKey, args.button, args.relatedTarget ];
      e = doc.createEvent("MouseEvents");
      if (e.initMouseEvent) {
        e.initMouseEvent.apply(e, args);
        e._source = "js";
        target.dispatchEvent(e);
      }
    }
  };
  /**
 * Continuously poll the DOM until either:
 *  (a) the fallback content becomes visible, or
 *  (b) we receive an event from SWF (handled elsewhere)
 *
 * IMPORTANT:
 * This is NOT a necessary check but it can result in significantly faster
 * detection of bad `swfPath` configuration and/or network/server issues [in
 * supported browsers] than waiting for the entire `flashLoadTimeout` duration
 * to elapse before detecting that the SWF cannot be loaded. The detection
 * duration can be anywhere from 10-30 times faster [in supported browsers] by
 * using this approach.
 *
 * @returns `undefined`
 * @private
 */
  var _watchForSwfFallbackContent = function() {
    var maxWait = _globalConfig.flashLoadTimeout;
    if (typeof maxWait === "number" && maxWait >= 0) {
      var pollWait = Math.min(1e3, maxWait / 10);
      var fallbackContentId = _globalConfig.swfObjectId + "_fallbackContent";
      _swfFallbackCheckInterval = _setInterval(function() {
        var el = _document.getElementById(fallbackContentId);
        if (_isElementVisible(el)) {
          _clearTimeoutsAndPolling();
          _flashState.deactivated = null;
          ZeroClipboard.emit({
            type: "error",
            name: "swf-not-found"
          });
        }
      }, pollWait);
    }
  };
  /**
 * Create the HTML bridge element to embed the Flash object into.
 * @private
 */
  var _createHtmlBridge = function() {
    var container = _document.createElement("div");
    container.id = _globalConfig.containerId;
    container.className = _globalConfig.containerClass;
    container.style.position = "absolute";
    container.style.left = "0px";
    container.style.top = "-9999px";
    container.style.width = "1px";
    container.style.height = "1px";
    container.style.zIndex = "" + _getSafeZIndex(_globalConfig.zIndex);
    return container;
  };
  /**
 * Get the HTML element container that wraps the Flash bridge object/element.
 * @private
 */
  var _getHtmlBridge = function(flashBridge) {
    var htmlBridge = flashBridge && flashBridge.parentNode;
    while (htmlBridge && htmlBridge.nodeName === "OBJECT" && htmlBridge.parentNode) {
      htmlBridge = htmlBridge.parentNode;
    }
    return htmlBridge || null;
  };
  /**
 * Create the SWF object.
 *
 * @returns The SWF object reference.
 * @private
 */
  var _embedSwf = function() {
    var len, flashBridge = _flashState.bridge, container = _getHtmlBridge(flashBridge);
    if (!flashBridge) {
      var allowScriptAccess = _determineScriptAccess(_window.location.host, _globalConfig);
      var allowNetworking = allowScriptAccess === "never" ? "none" : "all";
      var flashvars = _vars(_extend({
        jsVersion: ZeroClipboard.version
      }, _globalConfig));
      var swfUrl = _globalConfig.swfPath + _cacheBust(_globalConfig.swfPath, _globalConfig);
      container = _createHtmlBridge();
      var divToBeReplaced = _document.createElement("div");
      container.appendChild(divToBeReplaced);
      _document.body.appendChild(container);
      var tmpDiv = _document.createElement("div");
      var usingActiveX = _flashState.pluginType === "activex";
      tmpDiv.innerHTML = '<object id="' + _globalConfig.swfObjectId + '" name="' + _globalConfig.swfObjectId + '" ' + 'width="100%" height="100%" ' + (usingActiveX ? 'classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"' : 'type="application/x-shockwave-flash" data="' + swfUrl + '"') + ">" + (usingActiveX ? '<param name="movie" value="' + swfUrl + '"/>' : "") + '<param name="allowScriptAccess" value="' + allowScriptAccess + '"/>' + '<param name="allowNetworking" value="' + allowNetworking + '"/>' + '<param name="menu" value="false"/>' + '<param name="wmode" value="transparent"/>' + '<param name="flashvars" value="' + flashvars + '"/>' + '<div id="' + _globalConfig.swfObjectId + '_fallbackContent">&nbsp;</div>' + "</object>";
      flashBridge = tmpDiv.firstChild;
      tmpDiv = null;
      _unwrap(flashBridge).ZeroClipboard = ZeroClipboard;
      container.replaceChild(flashBridge, divToBeReplaced);
      _watchForSwfFallbackContent();
    }
    if (!flashBridge) {
      flashBridge = _document[_globalConfig.swfObjectId];
      if (flashBridge && (len = flashBridge.length)) {
        flashBridge = flashBridge[len - 1];
      }
      if (!flashBridge && container) {
        flashBridge = container.firstChild;
      }
    }
    _flashState.bridge = flashBridge || null;
    return flashBridge;
  };
  /**
 * Destroy the SWF object.
 * @private
 */
  var _unembedSwf = function() {
    var flashBridge = _flashState.bridge;
    if (flashBridge) {
      var htmlBridge = _getHtmlBridge(flashBridge);
      if (htmlBridge) {
        if (_flashState.pluginType === "activex" && "readyState" in flashBridge) {
          flashBridge.style.display = "none";
          (function removeSwfFromIE() {
            if (flashBridge.readyState === 4) {
              for (var prop in flashBridge) {
                if (typeof flashBridge[prop] === "function") {
                  flashBridge[prop] = null;
                }
              }
              if (flashBridge.parentNode) {
                flashBridge.parentNode.removeChild(flashBridge);
              }
              if (htmlBridge.parentNode) {
                htmlBridge.parentNode.removeChild(htmlBridge);
              }
            } else {
              _setTimeout(removeSwfFromIE, 10);
            }
          })();
        } else {
          if (flashBridge.parentNode) {
            flashBridge.parentNode.removeChild(flashBridge);
          }
          if (htmlBridge.parentNode) {
            htmlBridge.parentNode.removeChild(htmlBridge);
          }
        }
      }
      _clearTimeoutsAndPolling();
      _flashState.ready = null;
      _flashState.bridge = null;
      _flashState.deactivated = null;
      _zcSwfVersion = undefined;
    }
  };
  /**
 * Map the data format names of the "clipData" to Flash-friendly names.
 *
 * @returns A new transformed object.
 * @private
 */
  var _mapClipDataToFlash = function(clipData) {
    var newClipData = {}, formatMap = {};
    if (!(typeof clipData === "object" && clipData)) {
      return;
    }
    for (var dataFormat in clipData) {
      if (dataFormat && _hasOwn.call(clipData, dataFormat) && typeof clipData[dataFormat] === "string" && clipData[dataFormat]) {
        switch (dataFormat.toLowerCase()) {
         case "text/plain":
         case "text":
         case "air:text":
         case "flash:text":
          newClipData.text = clipData[dataFormat];
          formatMap.text = dataFormat;
          break;

         case "text/html":
         case "html":
         case "air:html":
         case "flash:html":
          newClipData.html = clipData[dataFormat];
          formatMap.html = dataFormat;
          break;

         case "application/rtf":
         case "text/rtf":
         case "rtf":
         case "richtext":
         case "air:rtf":
         case "flash:rtf":
          newClipData.rtf = clipData[dataFormat];
          formatMap.rtf = dataFormat;
          break;

         default:
          break;
        }
      }
    }
    return {
      data: newClipData,
      formatMap: formatMap
    };
  };
  /**
 * Map the data format names from Flash-friendly names back to their original "clipData" names (via a format mapping).
 *
 * @returns A new transformed object.
 * @private
 */
  var _mapClipResultsFromFlash = function(clipResults, formatMap) {
    if (!(typeof clipResults === "object" && clipResults && typeof formatMap === "object" && formatMap)) {
      return clipResults;
    }
    var newResults = {};
    for (var prop in clipResults) {
      if (_hasOwn.call(clipResults, prop)) {
        if (prop === "errors") {
          newResults[prop] = clipResults[prop] ? clipResults[prop].slice() : [];
          for (var i = 0, len = newResults[prop].length; i < len; i++) {
            newResults[prop][i].format = formatMap[newResults[prop][i].format];
          }
        } else if (prop !== "success" && prop !== "data") {
          newResults[prop] = clipResults[prop];
        } else {
          newResults[prop] = {};
          var tmpHash = clipResults[prop];
          for (var dataFormat in tmpHash) {
            if (dataFormat && _hasOwn.call(tmpHash, dataFormat) && _hasOwn.call(formatMap, dataFormat)) {
              newResults[prop][formatMap[dataFormat]] = tmpHash[dataFormat];
            }
          }
        }
      }
    }
    return newResults;
  };
  /**
 * Will look at a path, and will create a "?noCache={time}" or "&noCache={time}"
 * query param string to return. Does NOT append that string to the original path.
 * This is useful because ExternalInterface often breaks when a Flash SWF is cached.
 *
 * @returns The `noCache` query param with necessary "?"/"&" prefix.
 * @private
 */
  var _cacheBust = function(path, options) {
    var cacheBust = options == null || options && options.cacheBust === true;
    if (cacheBust) {
      return (path.indexOf("?") === -1 ? "?" : "&") + "noCache=" + _now();
    } else {
      return "";
    }
  };
  /**
 * Creates a query string for the FlashVars param.
 * Does NOT include the cache-busting query param.
 *
 * @returns FlashVars query string
 * @private
 */
  var _vars = function(options) {
    var i, len, domain, domains, str = "", trustedOriginsExpanded = [];
    if (options.trustedDomains) {
      if (typeof options.trustedDomains === "string") {
        domains = [ options.trustedDomains ];
      } else if (typeof options.trustedDomains === "object" && "length" in options.trustedDomains) {
        domains = options.trustedDomains;
      }
    }
    if (domains && domains.length) {
      for (i = 0, len = domains.length; i < len; i++) {
        if (_hasOwn.call(domains, i) && domains[i] && typeof domains[i] === "string") {
          domain = _extractDomain(domains[i]);
          if (!domain) {
            continue;
          }
          if (domain === "*") {
            trustedOriginsExpanded.length = 0;
            trustedOriginsExpanded.push(domain);
            break;
          }
          trustedOriginsExpanded.push.apply(trustedOriginsExpanded, [ domain, "//" + domain, _window.location.protocol + "//" + domain ]);
        }
      }
    }
    if (trustedOriginsExpanded.length) {
      str += "trustedOrigins=" + _encodeURIComponent(trustedOriginsExpanded.join(","));
    }
    if (options.forceEnhancedClipboard === true) {
      str += (str ? "&" : "") + "forceEnhancedClipboard=true";
    }
    if (typeof options.swfObjectId === "string" && options.swfObjectId) {
      str += (str ? "&" : "") + "swfObjectId=" + _encodeURIComponent(options.swfObjectId);
    }
    if (typeof options.jsVersion === "string" && options.jsVersion) {
      str += (str ? "&" : "") + "jsVersion=" + _encodeURIComponent(options.jsVersion);
    }
    return str;
  };
  /**
 * Extract the domain (e.g. "github.com") from an origin (e.g. "https://github.com") or
 * URL (e.g. "https://github.com/zeroclipboard/zeroclipboard/").
 *
 * @returns the domain
 * @private
 */
  var _extractDomain = function(originOrUrl) {
    if (originOrUrl == null || originOrUrl === "") {
      return null;
    }
    originOrUrl = originOrUrl.replace(/^\s+|\s+$/g, "");
    if (originOrUrl === "") {
      return null;
    }
    var protocolIndex = originOrUrl.indexOf("//");
    originOrUrl = protocolIndex === -1 ? originOrUrl : originOrUrl.slice(protocolIndex + 2);
    var pathIndex = originOrUrl.indexOf("/");
    originOrUrl = pathIndex === -1 ? originOrUrl : protocolIndex === -1 || pathIndex === 0 ? null : originOrUrl.slice(0, pathIndex);
    if (originOrUrl && originOrUrl.slice(-4).toLowerCase() === ".swf") {
      return null;
    }
    return originOrUrl || null;
  };
  /**
 * Set `allowScriptAccess` based on `trustedDomains` and `window.location.host` vs. `swfPath`.
 *
 * @returns The appropriate script access level.
 * @private
 */
  var _determineScriptAccess = function() {
    var _extractAllDomains = function(origins) {
      var i, len, tmp, resultsArray = [];
      if (typeof origins === "string") {
        origins = [ origins ];
      }
      if (!(typeof origins === "object" && origins && typeof origins.length === "number")) {
        return resultsArray;
      }
      for (i = 0, len = origins.length; i < len; i++) {
        if (_hasOwn.call(origins, i) && (tmp = _extractDomain(origins[i]))) {
          if (tmp === "*") {
            resultsArray.length = 0;
            resultsArray.push("*");
            break;
          }
          if (resultsArray.indexOf(tmp) === -1) {
            resultsArray.push(tmp);
          }
        }
      }
      return resultsArray;
    };
    return function(currentDomain, configOptions) {
      var swfDomain = _extractDomain(configOptions.swfPath);
      if (swfDomain === null) {
        swfDomain = currentDomain;
      }
      var trustedDomains = _extractAllDomains(configOptions.trustedDomains);
      var len = trustedDomains.length;
      if (len > 0) {
        if (len === 1 && trustedDomains[0] === "*") {
          return "always";
        }
        if (trustedDomains.indexOf(currentDomain) !== -1) {
          if (len === 1 && currentDomain === swfDomain) {
            return "sameDomain";
          }
          return "always";
        }
      }
      return "never";
    };
  }();
  /**
 * Get the currently active/focused DOM element.
 *
 * @returns the currently active/focused element, or `null`
 * @private
 */
  var _safeActiveElement = function() {
    try {
      return _document.activeElement;
    } catch (err) {
      return null;
    }
  };
  /**
 * Add a class to an element, if it doesn't already have it.
 *
 * @returns The element, with its new class added.
 * @private
 */
  var _addClass = function(element, value) {
    var c, cl, className, classNames = [];
    if (typeof value === "string" && value) {
      classNames = value.split(/\s+/);
    }
    if (element && element.nodeType === 1 && classNames.length > 0) {
      if (element.classList) {
        for (c = 0, cl = classNames.length; c < cl; c++) {
          element.classList.add(classNames[c]);
        }
      } else if (element.hasOwnProperty("className")) {
        className = " " + element.className + " ";
        for (c = 0, cl = classNames.length; c < cl; c++) {
          if (className.indexOf(" " + classNames[c] + " ") === -1) {
            className += classNames[c] + " ";
          }
        }
        element.className = className.replace(/^\s+|\s+$/g, "");
      }
    }
    return element;
  };
  /**
 * Remove a class from an element, if it has it.
 *
 * @returns The element, with its class removed.
 * @private
 */
  var _removeClass = function(element, value) {
    var c, cl, className, classNames = [];
    if (typeof value === "string" && value) {
      classNames = value.split(/\s+/);
    }
    if (element && element.nodeType === 1 && classNames.length > 0) {
      if (element.classList && element.classList.length > 0) {
        for (c = 0, cl = classNames.length; c < cl; c++) {
          element.classList.remove(classNames[c]);
        }
      } else if (element.className) {
        className = (" " + element.className + " ").replace(/[\r\n\t]/g, " ");
        for (c = 0, cl = classNames.length; c < cl; c++) {
          className = className.replace(" " + classNames[c] + " ", " ");
        }
        element.className = className.replace(/^\s+|\s+$/g, "");
      }
    }
    return element;
  };
  /**
 * Attempt to interpret the element's CSS styling. If `prop` is `"cursor"`,
 * then we assume that it should be a hand ("pointer") cursor if the element
 * is an anchor element ("a" tag).
 *
 * @returns The computed style property.
 * @private
 */
  var _getStyle = function(el, prop) {
    var value = _getComputedStyle(el, null).getPropertyValue(prop);
    if (prop === "cursor") {
      if (!value || value === "auto") {
        if (el.nodeName === "A") {
          return "pointer";
        }
      }
    }
    return value;
  };
  /**
 * Get the absolutely positioned coordinates of a DOM element.
 *
 * @returns Object containing the element's position, width, and height.
 * @private
 */
  var _getElementPosition = function(el) {
    var pos = {
      left: 0,
      top: 0,
      width: 0,
      height: 0
    };
    if (el.getBoundingClientRect) {
      var elRect = el.getBoundingClientRect();
      var pageXOffset = _window.pageXOffset;
      var pageYOffset = _window.pageYOffset;
      var leftBorderWidth = _document.documentElement.clientLeft || 0;
      var topBorderWidth = _document.documentElement.clientTop || 0;
      var leftBodyOffset = 0;
      var topBodyOffset = 0;
      if (_getStyle(_document.body, "position") === "relative") {
        var bodyRect = _document.body.getBoundingClientRect();
        var htmlRect = _document.documentElement.getBoundingClientRect();
        leftBodyOffset = bodyRect.left - htmlRect.left || 0;
        topBodyOffset = bodyRect.top - htmlRect.top || 0;
      }
      pos.left = elRect.left + pageXOffset - leftBorderWidth - leftBodyOffset;
      pos.top = elRect.top + pageYOffset - topBorderWidth - topBodyOffset;
      pos.width = "width" in elRect ? elRect.width : elRect.right - elRect.left;
      pos.height = "height" in elRect ? elRect.height : elRect.bottom - elRect.top;
    }
    return pos;
  };
  /**
 * Determine is an element is visible somewhere within the document (page).
 *
 * @returns Boolean
 * @private
 */
  var _isElementVisible = function(el) {
    if (!el) {
      return false;
    }
    var styles = _getComputedStyle(el, null);
    var hasCssHeight = _parseFloat(styles.height) > 0;
    var hasCssWidth = _parseFloat(styles.width) > 0;
    var hasCssTop = _parseFloat(styles.top) >= 0;
    var hasCssLeft = _parseFloat(styles.left) >= 0;
    var cssKnows = hasCssHeight && hasCssWidth && hasCssTop && hasCssLeft;
    var rect = cssKnows ? null : _getElementPosition(el);
    var isVisible = styles.display !== "none" && styles.visibility !== "collapse" && (cssKnows || !!rect && (hasCssHeight || rect.height > 0) && (hasCssWidth || rect.width > 0) && (hasCssTop || rect.top >= 0) && (hasCssLeft || rect.left >= 0));
    return isVisible;
  };
  /**
 * Clear all existing timeouts and interval polling delegates.
 *
 * @returns `undefined`
 * @private
 */
  var _clearTimeoutsAndPolling = function() {
    _clearTimeout(_flashCheckTimeout);
    _flashCheckTimeout = 0;
    _clearInterval(_swfFallbackCheckInterval);
    _swfFallbackCheckInterval = 0;
  };
  /**
 * Reposition the Flash object to cover the currently activated element.
 *
 * @returns `undefined`
 * @private
 */
  var _reposition = function() {
    var htmlBridge;
    if (_currentElement && (htmlBridge = _getHtmlBridge(_flashState.bridge))) {
      var pos = _getElementPosition(_currentElement);
      _extend(htmlBridge.style, {
        width: pos.width + "px",
        height: pos.height + "px",
        top: pos.top + "px",
        left: pos.left + "px",
        zIndex: "" + _getSafeZIndex(_globalConfig.zIndex)
      });
    }
  };
  /**
 * Sends a signal to the Flash object to display the hand cursor if `true`.
 *
 * @returns `undefined`
 * @private
 */
  var _setHandCursor = function(enabled) {
    if (_flashState.ready === true) {
      if (_flashState.bridge && typeof _flashState.bridge.setHandCursor === "function") {
        _flashState.bridge.setHandCursor(enabled);
      } else {
        _flashState.ready = false;
      }
    }
  };
  /**
 * Get a safe value for `zIndex`
 *
 * @returns an integer, or "auto"
 * @private
 */
  var _getSafeZIndex = function(val) {
    if (/^(?:auto|inherit)$/.test(val)) {
      return val;
    }
    var zIndex;
    if (typeof val === "number" && !_isNaN(val)) {
      zIndex = val;
    } else if (typeof val === "string") {
      zIndex = _getSafeZIndex(_parseInt(val, 10));
    }
    return typeof zIndex === "number" ? zIndex : "auto";
  };
  /**
 * Attempt to detect if ZeroClipboard is executing inside of a sandboxed iframe.
 * If it is, Flash Player cannot be used, so ZeroClipboard is dead in the water.
 *
 * @see {@link http://lists.w3.org/Archives/Public/public-whatwg-archive/2014Dec/0002.html}
 * @see {@link https://github.com/zeroclipboard/zeroclipboard/issues/511}
 * @see {@link http://zeroclipboard.org/test-iframes.html}
 *
 * @returns `true` (is sandboxed), `false` (is not sandboxed), or `null` (uncertain) 
 * @private
 */
  var _detectSandbox = function(doNotReassessFlashSupport) {
    var effectiveScriptOrigin, frame, frameError, previousState = _flashState.sandboxed, isSandboxed = null;
    doNotReassessFlashSupport = doNotReassessFlashSupport === true;
    if (_pageIsFramed === false) {
      isSandboxed = false;
    } else {
      try {
        frame = window.frameElement || null;
      } catch (e) {
        frameError = {
          name: e.name,
          message: e.message
        };
      }
      if (frame && frame.nodeType === 1 && frame.nodeName === "IFRAME") {
        try {
          isSandboxed = frame.hasAttribute("sandbox");
        } catch (e) {
          isSandboxed = null;
        }
      } else {
        try {
          effectiveScriptOrigin = document.domain || null;
        } catch (e) {
          effectiveScriptOrigin = null;
        }
        if (effectiveScriptOrigin === null || frameError && frameError.name === "SecurityError" && /(^|[\s\(\[@])sandbox(es|ed|ing|[\s\.,!\)\]@]|$)/.test(frameError.message.toLowerCase())) {
          isSandboxed = true;
        }
      }
    }
    _flashState.sandboxed = isSandboxed;
    if (previousState !== isSandboxed && !doNotReassessFlashSupport) {
      _detectFlashSupport(_ActiveXObject);
    }
    return isSandboxed;
  };
  /**
 * Detect the Flash Player status, version, and plugin type.
 *
 * @see {@link https://code.google.com/p/doctype-mirror/wiki/ArticleDetectFlash#The_code}
 * @see {@link http://stackoverflow.com/questions/12866060/detecting-pepper-ppapi-flash-with-javascript}
 *
 * @returns `undefined`
 * @private
 */
  var _detectFlashSupport = function(ActiveXObject) {
    var plugin, ax, mimeType, hasFlash = false, isActiveX = false, isPPAPI = false, flashVersion = "";
    /**
   * Derived from Apple's suggested sniffer.
   * @param {String} desc e.g. "Shockwave Flash 7.0 r61"
   * @returns {String} "7.0.61"
   * @private
   */
    function parseFlashVersion(desc) {
      var matches = desc.match(/[\d]+/g);
      matches.length = 3;
      return matches.join(".");
    }
    function isPepperFlash(flashPlayerFileName) {
      return !!flashPlayerFileName && (flashPlayerFileName = flashPlayerFileName.toLowerCase()) && (/^(pepflashplayer\.dll|libpepflashplayer\.so|pepperflashplayer\.plugin)$/.test(flashPlayerFileName) || flashPlayerFileName.slice(-13) === "chrome.plugin");
    }
    function inspectPlugin(plugin) {
      if (plugin) {
        hasFlash = true;
        if (plugin.version) {
          flashVersion = parseFlashVersion(plugin.version);
        }
        if (!flashVersion && plugin.description) {
          flashVersion = parseFlashVersion(plugin.description);
        }
        if (plugin.filename) {
          isPPAPI = isPepperFlash(plugin.filename);
        }
      }
    }
    if (_navigator.plugins && _navigator.plugins.length) {
      plugin = _navigator.plugins["Shockwave Flash"];
      inspectPlugin(plugin);
      if (_navigator.plugins["Shockwave Flash 2.0"]) {
        hasFlash = true;
        flashVersion = "2.0.0.11";
      }
    } else if (_navigator.mimeTypes && _navigator.mimeTypes.length) {
      mimeType = _navigator.mimeTypes["application/x-shockwave-flash"];
      plugin = mimeType && mimeType.enabledPlugin;
      inspectPlugin(plugin);
    } else if (typeof ActiveXObject !== "undefined") {
      isActiveX = true;
      try {
        ax = new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");
        hasFlash = true;
        flashVersion = parseFlashVersion(ax.GetVariable("$version"));
      } catch (e1) {
        try {
          ax = new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");
          hasFlash = true;
          flashVersion = "6.0.21";
        } catch (e2) {
          try {
            ax = new ActiveXObject("ShockwaveFlash.ShockwaveFlash");
            hasFlash = true;
            flashVersion = parseFlashVersion(ax.GetVariable("$version"));
          } catch (e3) {
            isActiveX = false;
          }
        }
      }
    }
    _flashState.disabled = hasFlash !== true;
    _flashState.outdated = flashVersion && _parseFloat(flashVersion) < _parseFloat(_minimumFlashVersion);
    _flashState.version = flashVersion || "0.0.0";
    _flashState.pluginType = isPPAPI ? "pepper" : isActiveX ? "activex" : hasFlash ? "netscape" : "unknown";
  };
  /**
 * Invoke the Flash detection algorithms immediately upon inclusion so we're not waiting later.
 */
  _detectFlashSupport(_ActiveXObject);
  /**
 * Always assess the `sandboxed` state of the page at important Flash-related moments.
 */
  _detectSandbox(true);
  /**
 * A shell constructor for `ZeroClipboard` client instances.
 *
 * @constructor
 */
  var ZeroClipboard = function() {
    if (!(this instanceof ZeroClipboard)) {
      return new ZeroClipboard();
    }
    if (typeof ZeroClipboard._createClient === "function") {
      ZeroClipboard._createClient.apply(this, _args(arguments));
    }
  };
  /**
 * The ZeroClipboard library's version number.
 *
 * @static
 * @readonly
 * @property {string}
 */
  _defineProperty(ZeroClipboard, "version", {
    value: "2.2.0",
    writable: false,
    configurable: true,
    enumerable: true
  });
  /**
 * Update or get a copy of the ZeroClipboard global configuration.
 * Returns a copy of the current/updated configuration.
 *
 * @returns Object
 * @static
 */
  ZeroClipboard.config = function() {
    return _config.apply(this, _args(arguments));
  };
  /**
 * Diagnostic method that describes the state of the browser, Flash Player, and ZeroClipboard.
 *
 * @returns Object
 * @static
 */
  ZeroClipboard.state = function() {
    return _state.apply(this, _args(arguments));
  };
  /**
 * Check if Flash is unusable for any reason: disabled, outdated, deactivated, etc.
 *
 * @returns Boolean
 * @static
 */
  ZeroClipboard.isFlashUnusable = function() {
    return _isFlashUnusable.apply(this, _args(arguments));
  };
  /**
 * Register an event listener.
 *
 * @returns `ZeroClipboard`
 * @static
 */
  ZeroClipboard.on = function() {
    return _on.apply(this, _args(arguments));
  };
  /**
 * Unregister an event listener.
 * If no `listener` function/object is provided, it will unregister all listeners for the provided `eventType`.
 * If no `eventType` is provided, it will unregister all listeners for every event type.
 *
 * @returns `ZeroClipboard`
 * @static
 */
  ZeroClipboard.off = function() {
    return _off.apply(this, _args(arguments));
  };
  /**
 * Retrieve event listeners for an `eventType`.
 * If no `eventType` is provided, it will retrieve all listeners for every event type.
 *
 * @returns array of listeners for the `eventType`; if no `eventType`, then a map/hash object of listeners for all event types; or `null`
 */
  ZeroClipboard.handlers = function() {
    return _listeners.apply(this, _args(arguments));
  };
  /**
 * Event emission receiver from the Flash object, forwarding to any registered JavaScript event listeners.
 *
 * @returns For the "copy" event, returns the Flash-friendly "clipData" object; otherwise `undefined`.
 * @static
 */
  ZeroClipboard.emit = function() {
    return _emit.apply(this, _args(arguments));
  };
  /**
 * Create and embed the Flash object.
 *
 * @returns The Flash object
 * @static
 */
  ZeroClipboard.create = function() {
    return _create.apply(this, _args(arguments));
  };
  /**
 * Self-destruct and clean up everything, including the embedded Flash object.
 *
 * @returns `undefined`
 * @static
 */
  ZeroClipboard.destroy = function() {
    return _destroy.apply(this, _args(arguments));
  };
  /**
 * Set the pending data for clipboard injection.
 *
 * @returns `undefined`
 * @static
 */
  ZeroClipboard.setData = function() {
    return _setData.apply(this, _args(arguments));
  };
  /**
 * Clear the pending data for clipboard injection.
 * If no `format` is provided, all pending data formats will be cleared.
 *
 * @returns `undefined`
 * @static
 */
  ZeroClipboard.clearData = function() {
    return _clearData.apply(this, _args(arguments));
  };
  /**
 * Get a copy of the pending data for clipboard injection.
 * If no `format` is provided, a copy of ALL pending data formats will be returned.
 *
 * @returns `String` or `Object`
 * @static
 */
  ZeroClipboard.getData = function() {
    return _getData.apply(this, _args(arguments));
  };
  /**
 * Sets the current HTML object that the Flash object should overlay. This will put the global
 * Flash object on top of the current element; depending on the setup, this may also set the
 * pending clipboard text data as well as the Flash object's wrapping element's title attribute
 * based on the underlying HTML element and ZeroClipboard configuration.
 *
 * @returns `undefined`
 * @static
 */
  ZeroClipboard.focus = ZeroClipboard.activate = function() {
    return _focus.apply(this, _args(arguments));
  };
  /**
 * Un-overlays the Flash object. This will put the global Flash object off-screen; depending on
 * the setup, this may also unset the Flash object's wrapping element's title attribute based on
 * the underlying HTML element and ZeroClipboard configuration.
 *
 * @returns `undefined`
 * @static
 */
  ZeroClipboard.blur = ZeroClipboard.deactivate = function() {
    return _blur.apply(this, _args(arguments));
  };
  /**
 * Returns the currently focused/"activated" HTML element that the Flash object is wrapping.
 *
 * @returns `HTMLElement` or `null`
 * @static
 */
  ZeroClipboard.activeElement = function() {
    return _activeElement.apply(this, _args(arguments));
  };
  /**
 * Keep track of the ZeroClipboard client instance counter.
 */
  var _clientIdCounter = 0;
  /**
 * Keep track of the state of the client instances.
 *
 * Entry structure:
 *   _clientMeta[client.id] = {
 *     instance: client,
 *     elements: [],
 *     handlers: {}
 *   };
 */
  var _clientMeta = {};
  /**
 * Keep track of the ZeroClipboard clipped elements counter.
 */
  var _elementIdCounter = 0;
  /**
 * Keep track of the state of the clipped element relationships to clients.
 *
 * Entry structure:
 *   _elementMeta[element.zcClippingId] = [client1.id, client2.id];
 */
  var _elementMeta = {};
  /**
 * Keep track of the state of the mouse event handlers for clipped elements.
 *
 * Entry structure:
 *   _mouseHandlers[element.zcClippingId] = {
 *     mouseover:  function(event) {},
 *     mouseout:   function(event) {},
 *     mouseenter: function(event) {},
 *     mouseleave: function(event) {},
 *     mousemove:  function(event) {}
 *   };
 */
  var _mouseHandlers = {};
  /**
 * Extending the ZeroClipboard configuration defaults for the Client module.
 */
  _extend(_globalConfig, {
    autoActivate: true
  });
  /**
 * The real constructor for `ZeroClipboard` client instances.
 * @private
 */
  var _clientConstructor = function(elements) {
    var client = this;
    client.id = "" + _clientIdCounter++;
    _clientMeta[client.id] = {
      instance: client,
      elements: [],
      handlers: {}
    };
    if (elements) {
      client.clip(elements);
    }
    ZeroClipboard.on("*", function(event) {
      return client.emit(event);
    });
    ZeroClipboard.on("destroy", function() {
      client.destroy();
    });
    ZeroClipboard.create();
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.on`.
 * @private
 */
  var _clientOn = function(eventType, listener) {
    var i, len, events, added = {}, meta = _clientMeta[this.id], handlers = meta && meta.handlers;
    if (!meta) {
      throw new Error("Attempted to add new listener(s) to a destroyed ZeroClipboard client instance");
    }
    if (typeof eventType === "string" && eventType) {
      events = eventType.toLowerCase().split(/\s+/);
    } else if (typeof eventType === "object" && eventType && typeof listener === "undefined") {
      for (i in eventType) {
        if (_hasOwn.call(eventType, i) && typeof i === "string" && i && typeof eventType[i] === "function") {
          this.on(i, eventType[i]);
        }
      }
    }
    if (events && events.length) {
      for (i = 0, len = events.length; i < len; i++) {
        eventType = events[i].replace(/^on/, "");
        added[eventType] = true;
        if (!handlers[eventType]) {
          handlers[eventType] = [];
        }
        handlers[eventType].push(listener);
      }
      if (added.ready && _flashState.ready) {
        this.emit({
          type: "ready",
          client: this
        });
      }
      if (added.error) {
        for (i = 0, len = _flashStateErrorNames.length; i < len; i++) {
          if (_flashState[_flashStateErrorNames[i].replace(/^flash-/, "")]) {
            this.emit({
              type: "error",
              name: _flashStateErrorNames[i],
              client: this
            });
            break;
          }
        }
        if (_zcSwfVersion !== undefined && ZeroClipboard.version !== _zcSwfVersion) {
          this.emit({
            type: "error",
            name: "version-mismatch",
            jsVersion: ZeroClipboard.version,
            swfVersion: _zcSwfVersion
          });
        }
      }
    }
    return this;
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.off`.
 * @private
 */
  var _clientOff = function(eventType, listener) {
    var i, len, foundIndex, events, perEventHandlers, meta = _clientMeta[this.id], handlers = meta && meta.handlers;
    if (!handlers) {
      return this;
    }
    if (arguments.length === 0) {
      events = _keys(handlers);
    } else if (typeof eventType === "string" && eventType) {
      events = eventType.split(/\s+/);
    } else if (typeof eventType === "object" && eventType && typeof listener === "undefined") {
      for (i in eventType) {
        if (_hasOwn.call(eventType, i) && typeof i === "string" && i && typeof eventType[i] === "function") {
          this.off(i, eventType[i]);
        }
      }
    }
    if (events && events.length) {
      for (i = 0, len = events.length; i < len; i++) {
        eventType = events[i].toLowerCase().replace(/^on/, "");
        perEventHandlers = handlers[eventType];
        if (perEventHandlers && perEventHandlers.length) {
          if (listener) {
            foundIndex = perEventHandlers.indexOf(listener);
            while (foundIndex !== -1) {
              perEventHandlers.splice(foundIndex, 1);
              foundIndex = perEventHandlers.indexOf(listener, foundIndex);
            }
          } else {
            perEventHandlers.length = 0;
          }
        }
      }
    }
    return this;
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.handlers`.
 * @private
 */
  var _clientListeners = function(eventType) {
    var copy = null, handlers = _clientMeta[this.id] && _clientMeta[this.id].handlers;
    if (handlers) {
      if (typeof eventType === "string" && eventType) {
        copy = handlers[eventType] ? handlers[eventType].slice(0) : [];
      } else {
        copy = _deepCopy(handlers);
      }
    }
    return copy;
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.emit`.
 * @private
 */
  var _clientEmit = function(event) {
    if (_clientShouldEmit.call(this, event)) {
      if (typeof event === "object" && event && typeof event.type === "string" && event.type) {
        event = _extend({}, event);
      }
      var eventCopy = _extend({}, _createEvent(event), {
        client: this
      });
      _clientDispatchCallbacks.call(this, eventCopy);
    }
    return this;
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.clip`.
 * @private
 */
  var _clientClip = function(elements) {
    if (!_clientMeta[this.id]) {
      throw new Error("Attempted to clip element(s) to a destroyed ZeroClipboard client instance");
    }
    elements = _prepClip(elements);
    for (var i = 0; i < elements.length; i++) {
      if (_hasOwn.call(elements, i) && elements[i] && elements[i].nodeType === 1) {
        if (!elements[i].zcClippingId) {
          elements[i].zcClippingId = "zcClippingId_" + _elementIdCounter++;
          _elementMeta[elements[i].zcClippingId] = [ this.id ];
          if (_globalConfig.autoActivate === true) {
            _addMouseHandlers(elements[i]);
          }
        } else if (_elementMeta[elements[i].zcClippingId].indexOf(this.id) === -1) {
          _elementMeta[elements[i].zcClippingId].push(this.id);
        }
        var clippedElements = _clientMeta[this.id] && _clientMeta[this.id].elements;
        if (clippedElements.indexOf(elements[i]) === -1) {
          clippedElements.push(elements[i]);
        }
      }
    }
    return this;
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.unclip`.
 * @private
 */
  var _clientUnclip = function(elements) {
    var meta = _clientMeta[this.id];
    if (!meta) {
      return this;
    }
    var clippedElements = meta.elements;
    var arrayIndex;
    if (typeof elements === "undefined") {
      elements = clippedElements.slice(0);
    } else {
      elements = _prepClip(elements);
    }
    for (var i = elements.length; i--; ) {
      if (_hasOwn.call(elements, i) && elements[i] && elements[i].nodeType === 1) {
        arrayIndex = 0;
        while ((arrayIndex = clippedElements.indexOf(elements[i], arrayIndex)) !== -1) {
          clippedElements.splice(arrayIndex, 1);
        }
        var clientIds = _elementMeta[elements[i].zcClippingId];
        if (clientIds) {
          arrayIndex = 0;
          while ((arrayIndex = clientIds.indexOf(this.id, arrayIndex)) !== -1) {
            clientIds.splice(arrayIndex, 1);
          }
          if (clientIds.length === 0) {
            if (_globalConfig.autoActivate === true) {
              _removeMouseHandlers(elements[i]);
            }
            delete elements[i].zcClippingId;
          }
        }
      }
    }
    return this;
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.elements`.
 * @private
 */
  var _clientElements = function() {
    var meta = _clientMeta[this.id];
    return meta && meta.elements ? meta.elements.slice(0) : [];
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.destroy`.
 * @private
 */
  var _clientDestroy = function() {
    if (!_clientMeta[this.id]) {
      return;
    }
    this.unclip();
    this.off();
    delete _clientMeta[this.id];
  };
  /**
 * Inspect an Event to see if the Client (`this`) should honor it for emission.
 * @private
 */
  var _clientShouldEmit = function(event) {
    if (!(event && event.type)) {
      return false;
    }
    if (event.client && event.client !== this) {
      return false;
    }
    var meta = _clientMeta[this.id];
    var clippedEls = meta && meta.elements;
    var hasClippedEls = !!clippedEls && clippedEls.length > 0;
    var goodTarget = !event.target || hasClippedEls && clippedEls.indexOf(event.target) !== -1;
    var goodRelTarget = event.relatedTarget && hasClippedEls && clippedEls.indexOf(event.relatedTarget) !== -1;
    var goodClient = event.client && event.client === this;
    if (!meta || !(goodTarget || goodRelTarget || goodClient)) {
      return false;
    }
    return true;
  };
  /**
 * Handle the actual dispatching of events to a client instance.
 *
 * @returns `undefined`
 * @private
 */
  var _clientDispatchCallbacks = function(event) {
    var meta = _clientMeta[this.id];
    if (!(typeof event === "object" && event && event.type && meta)) {
      return;
    }
    var async = _shouldPerformAsync(event);
    var wildcardTypeHandlers = meta && meta.handlers["*"] || [];
    var specificTypeHandlers = meta && meta.handlers[event.type] || [];
    var handlers = wildcardTypeHandlers.concat(specificTypeHandlers);
    if (handlers && handlers.length) {
      var i, len, func, context, eventCopy, originalContext = this;
      for (i = 0, len = handlers.length; i < len; i++) {
        func = handlers[i];
        context = originalContext;
        if (typeof func === "string" && typeof _window[func] === "function") {
          func = _window[func];
        }
        if (typeof func === "object" && func && typeof func.handleEvent === "function") {
          context = func;
          func = func.handleEvent;
        }
        if (typeof func === "function") {
          eventCopy = _extend({}, event);
          _dispatchCallback(func, context, [ eventCopy ], async);
        }
      }
    }
  };
  /**
 * Prepares the elements for clipping/unclipping.
 *
 * @returns An Array of elements.
 * @private
 */
  var _prepClip = function(elements) {
    if (typeof elements === "string") {
      elements = [];
    }
    return typeof elements.length !== "number" ? [ elements ] : elements;
  };
  /**
 * Add a `mouseover` handler function for a clipped element.
 *
 * @returns `undefined`
 * @private
 */
  var _addMouseHandlers = function(element) {
    if (!(element && element.nodeType === 1)) {
      return;
    }
    var _suppressMouseEvents = function(event) {
      if (!(event || (event = _window.event))) {
        return;
      }
      if (event._source !== "js") {
        event.stopImmediatePropagation();
        event.preventDefault();
      }
      delete event._source;
    };
    var _elementMouseOver = function(event) {
      if (!(event || (event = _window.event))) {
        return;
      }
      _suppressMouseEvents(event);
      ZeroClipboard.focus(element);
    };
    element.addEventListener("mouseover", _elementMouseOver, false);
    element.addEventListener("mouseout", _suppressMouseEvents, false);
    element.addEventListener("mouseenter", _suppressMouseEvents, false);
    element.addEventListener("mouseleave", _suppressMouseEvents, false);
    element.addEventListener("mousemove", _suppressMouseEvents, false);
    _mouseHandlers[element.zcClippingId] = {
      mouseover: _elementMouseOver,
      mouseout: _suppressMouseEvents,
      mouseenter: _suppressMouseEvents,
      mouseleave: _suppressMouseEvents,
      mousemove: _suppressMouseEvents
    };
  };
  /**
 * Remove a `mouseover` handler function for a clipped element.
 *
 * @returns `undefined`
 * @private
 */
  var _removeMouseHandlers = function(element) {
    if (!(element && element.nodeType === 1)) {
      return;
    }
    var mouseHandlers = _mouseHandlers[element.zcClippingId];
    if (!(typeof mouseHandlers === "object" && mouseHandlers)) {
      return;
    }
    var key, val, mouseEvents = [ "move", "leave", "enter", "out", "over" ];
    for (var i = 0, len = mouseEvents.length; i < len; i++) {
      key = "mouse" + mouseEvents[i];
      val = mouseHandlers[key];
      if (typeof val === "function") {
        element.removeEventListener(key, val, false);
      }
    }
    delete _mouseHandlers[element.zcClippingId];
  };
  /**
 * Creates a new ZeroClipboard client instance.
 * Optionally, auto-`clip` an element or collection of elements.
 *
 * @constructor
 */
  ZeroClipboard._createClient = function() {
    _clientConstructor.apply(this, _args(arguments));
  };
  /**
 * Register an event listener to the client.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.on = function() {
    return _clientOn.apply(this, _args(arguments));
  };
  /**
 * Unregister an event handler from the client.
 * If no `listener` function/object is provided, it will unregister all handlers for the provided `eventType`.
 * If no `eventType` is provided, it will unregister all handlers for every event type.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.off = function() {
    return _clientOff.apply(this, _args(arguments));
  };
  /**
 * Retrieve event listeners for an `eventType` from the client.
 * If no `eventType` is provided, it will retrieve all listeners for every event type.
 *
 * @returns array of listeners for the `eventType`; if no `eventType`, then a map/hash object of listeners for all event types; or `null`
 */
  ZeroClipboard.prototype.handlers = function() {
    return _clientListeners.apply(this, _args(arguments));
  };
  /**
 * Event emission receiver from the Flash object for this client's registered JavaScript event listeners.
 *
 * @returns For the "copy" event, returns the Flash-friendly "clipData" object; otherwise `undefined`.
 */
  ZeroClipboard.prototype.emit = function() {
    return _clientEmit.apply(this, _args(arguments));
  };
  /**
 * Register clipboard actions for new element(s) to the client.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.clip = function() {
    return _clientClip.apply(this, _args(arguments));
  };
  /**
 * Unregister the clipboard actions of previously registered element(s) on the page.
 * If no elements are provided, ALL registered elements will be unregistered.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.unclip = function() {
    return _clientUnclip.apply(this, _args(arguments));
  };
  /**
 * Get all of the elements to which this client is clipped.
 *
 * @returns array of clipped elements
 */
  ZeroClipboard.prototype.elements = function() {
    return _clientElements.apply(this, _args(arguments));
  };
  /**
 * Self-destruct and clean up everything for a single client.
 * This will NOT destroy the embedded Flash object.
 *
 * @returns `undefined`
 */
  ZeroClipboard.prototype.destroy = function() {
    return _clientDestroy.apply(this, _args(arguments));
  };
  /**
 * Stores the pending plain text to inject into the clipboard.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.setText = function(text) {
    if (!_clientMeta[this.id]) {
      throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");
    }
    ZeroClipboard.setData("text/plain", text);
    return this;
  };
  /**
 * Stores the pending HTML text to inject into the clipboard.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.setHtml = function(html) {
    if (!_clientMeta[this.id]) {
      throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");
    }
    ZeroClipboard.setData("text/html", html);
    return this;
  };
  /**
 * Stores the pending rich text (RTF) to inject into the clipboard.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.setRichText = function(richText) {
    if (!_clientMeta[this.id]) {
      throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");
    }
    ZeroClipboard.setData("application/rtf", richText);
    return this;
  };
  /**
 * Stores the pending data to inject into the clipboard.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.setData = function() {
    if (!_clientMeta[this.id]) {
      throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");
    }
    ZeroClipboard.setData.apply(this, _args(arguments));
    return this;
  };
  /**
 * Clears the pending data to inject into the clipboard.
 * If no `format` is provided, all pending data formats will be cleared.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.clearData = function() {
    if (!_clientMeta[this.id]) {
      throw new Error("Attempted to clear pending clipboard data from a destroyed ZeroClipboard client instance");
    }
    ZeroClipboard.clearData.apply(this, _args(arguments));
    return this;
  };
  /**
 * Gets a copy of the pending data to inject into the clipboard.
 * If no `format` is provided, a copy of ALL pending data formats will be returned.
 *
 * @returns `String` or `Object`
 */
  ZeroClipboard.prototype.getData = function() {
    if (!_clientMeta[this.id]) {
      throw new Error("Attempted to get pending clipboard data from a destroyed ZeroClipboard client instance");
    }
    return ZeroClipboard.getData.apply(this, _args(arguments));
  };
  if (typeof define === "function" && define.amd) {
    define(function() {
      return ZeroClipboard;
    });
  } else if (typeof module === "object" && module && typeof module.exports === "object" && module.exports) {
    module.exports = ZeroClipboard;
  } else {
    window.ZeroClipboard = ZeroClipboard;
  }
})(function() {
  return this || window;
}());
},{}],6:[function(require,module,exports){
/*jslint browser: true*/
/*jshint -W055 */
/*global console, alert*/

/*
 * For each disease area there will be 4 stages: Diagnosis, Monitoring, Treatment and Exclusions.
 * Each stage gets a single panel on the front screen.
 * Clicking on a panel takes you to a screen specific to that stage, but similar in layout and content
 *  to all the others.
 */

var template = require('./src/template.js'),
  main = require('./src/main.js');

//TODO not sure why i did this - was in local variable
//maybe a separate module
//window.location = window.history.location || window.location;
/********************************************************
 *** Shows the pre-load image and slowly fades it out. ***
 ********************************************************/
$(window).load(function() {
  $('.loading-container').fadeOut(1000, function() {
    //$(this).remove();
  });
});

/******************************************
 *** This happens when the page is ready ***
 ******************************************/
$(document).on('ready', function() {
  //Grab the hash if exists - IE seems to forget it
  main.hash = location.hash;

  //CHANGE THIS - added to spoof login
  location.hash="";
  main.hash="";
  $('#signin').on('click', function(){
    if($('#inpEmail').val().length<8) alert("Please enter your email address.");
    else {
      console.log('{"event":{"what":"login","when":' + new Date().getTime() + ',"who":"' + $("#inpEmail").val() + '"}}');
      $.ajax({
        type: "POST",
        url: "http://130.88.250.206:9100/pingr",
        data: '{"event":{"what":"login","when":' + new Date().getTime() + ',"who":"' + $("#inpEmail").val() + '"}}',
        success: function(d){console.log(d);},
        dataType: "json",
        contentType:"application/json"
      });

      var obj = JSON.parse(localStorage.bb);
      obj.email=$('#inpEmail').val();
      localStorage.bb = JSON.stringify(obj);


      history.pushState(null, null, '#overview');
      template.loadContent('#overview');
    }
  });
  $('#inpEmail').on('keyup', function(){
    var code = e.which;
    if(code==13){
      $('#signin').click();
    }
  });

  //Load the data then wire up the events on the page
  main.init();

  //Sorts out the data held locally in the user's browser
  if (!localStorage.bb) localStorage.bb = JSON.stringify({});
  var obj = JSON.parse(localStorage.bb);
  if (!obj.version || obj.version !== main.version) {
    localStorage.bb = JSON.stringify({
      "version": main.version
    });
  }

  if(JSON.parse(localStorage.bb).email) {
    $('#inpEmail').val(JSON.parse(localStorage.bb).email);
  }

  $('[data-toggle="tooltip"]').tooltip({
    container: 'body',
    delay: {
      "show": 500,
      "hide": 100
    },
    html: true
  });
  $('[data-toggle="lone-tooltip"]').tooltip({
    container: 'body',
    delay: {
      "show": 300,
      "hide": 100
    }
  });
  $('[data-toggle="lone-tooltip"]').on('shown.bs.tooltip', function(e) {
    $('[data-toggle="tooltip"]').not(this).tooltip('hide');
  });

  //ensure on first load the login screen is cached to the history
  history.pushState(null, null, '');
});

},{"./src/main.js":13,"./src/template.js":36}],7:[function(require,module,exports){
var data = require('./data.js'),
  lookup = require('./lookup.js'),
  chart = require('./chart.js'),
  log = require('./log.js'),
  Mustache = require('mustache'),
  ZeroClipboard = require('zeroclipboard');

var base = {

  //object for keeping track what is in each panel to prevent unnecessary redraws
  panels: {},

  selectTab: function(id) {
    var href = $('#mainTab li.active a').data("href");
    $('#mainTab li.active').removeClass('active').find('a').attr("href", href);
    $('#mainTab li[data-id="' + id + '"]').addClass('active').find('a').removeAttr("href");
  },

  createPanel: function(templateSelector, data, templates) {
    var tempMust = templateSelector.html();
    Mustache.parse(tempMust); // optional, speeds up future uses
    if (templates) {
      for (var o in templates) {
        if (templates.hasOwnProperty(o)) {
          Mustache.parse(templates[o]);
        }
      }
    }
    var rendered = Mustache.render(tempMust, data, templates);
    return rendered;
  },

  createPanelShow: function(templateSelector, panelSelector, data, templates) {
    var rendered = base.createPanel(templateSelector, data, templates);
    panelSelector.html(rendered).show();
  },

  showPathwayStageOverviewPanel: function(location, enableHover, pathwayId, pathwayStage) {
    var standards = [];
    for (var standard in data[pathwayId][pathwayStage].standards) {
      var denom = data.getDenominatorForStandard(pathwayId, pathwayStage);
      var num = denom - data.getNumeratorForStandard(pathwayId, pathwayStage, standard);
      standards.push({
        "standard": data[pathwayId][pathwayStage].standards[standard].tab.title,
        "standardKey": standard,
        "tooltip": data[pathwayId][pathwayStage].standards[standard]["standard-met-tooltip"],
        "numerator": num,
        "denominator": denom,
        "percentage": (num * 100 / denom).toFixed(0)
      });
    }

    base.createPanelShow($('#pathway-stage-overview-panel'), location, {
      pathway: data.pathwayNames[pathwayId],
      pathwayStage: pathwayStage,
      pathwayStageName: lookup.categories[pathwayStage].display,
      pathwayNameShort: pathwayId,
      title: data[pathwayId][pathwayStage].text.panel.text,
      standards: standards
    }, {
      "row": $('#overview-panel-table-row').html()
    });

    $('#' + pathwayStage + '-trend-toggle').on('click', function(e) {
      if ($(this).text() === "Trend") {
        $(this).text("Table");
        $('#' + pathwayStage + '-chart-table').hide();
        $('#' + pathwayStage + '-chart-wrapper').show();
      } else {
        $(this).text("Trend");
        $('#' + pathwayStage + '-chart-table').show();
        $('#' + pathwayStage + '-chart-wrapper').hide();
      }
      e.stopPropagation();
    });

    chart.drawOverviewChart(pathwayId, pathwayStage, enableHover);

  },

  hideFooter: function() {
    $('footer').hide();
  },

  showFooter: function() {
    $('footer').show();
  },

  hideTooltips: function() {
    $('[data-toggle="tooltip"]').tooltip('hide');
  },

  wireUpTooltips: function() {
    $('[data-toggle="tooltip"]').tooltip('hide');
    $('.tooltip').remove();

    $('[data-toggle="tooltip"]').tooltip({
      container: 'body',
      delay: {
        "show": 500,
        "hide": 100
      },
      html: true
    });
    $('[data-toggle="lone-tooltip"]').tooltip({
      container: 'body',
      delay: {
        "show": 300,
        "hide": 100
      }
    });
    $('[data-toggle="lone-tooltip"]').on('shown.bs.tooltip', function(e) {
      $('[data-toggle="tooltip"]').not(this).tooltip('hide');
    });
    $('.patient-row-tooltip').on('show.bs.tooltip', function(e) {
      if ($(this).hasClass('highlighted')) {
        e.stopPropagation();
        e.preventDefault();
      }
    });
  },

  setupClipboard: function(selector, destroy) {
    if (destroy) ZeroClipboard.destroy(); //tidy up

    var client = new ZeroClipboard(selector);

    client.on('ready', function() {
      client.on('aftercopy', function(event) {
        console.log('Copied text to clipboard: ' + event.data['text/plain']);
        $(event.target).tooltip('hide');
        $(event.target).popover({
          trigger: 'manual',
          template: '<div class="popover" role="tooltip"><div class="arrow"></div><div class="popover-content"></div></div>',
          delay: {
            show: 500,
            hide: 500
          }
        });
        clearTimeout(lookup.tmp);
        $(event.target).popover('show');
        lookup.tmp = setTimeout(function() {
          $(event.target).popover('hide');
        }, 600);
      });
    });
  },

  clearBox: function() {
    //Clear the patient search box
    $('.typeahead').typeahead('val', '');
  },

  /********************************
   * Modals
   ********************************/

  launchModal: function(data, label, value, reasonText, callbackOnSave, callbackOnCancel, callbackOnUndo) {
    var template = $('#modal-why').html();
    Mustache.parse(template); // optional, speeds up future uses

    var reasonTemplate = $('#modal-why-item').html();
    Mustache.parse(reasonTemplate);

    if (data.reasons && data.reasons.length > 0) data.hasReasons = true;

    var rendered = Mustache.render(template, data, {
      "item": reasonTemplate
    });
    $('#modal').html(rendered);

    if (reasonText) {
      $('#modal textarea').val(reasonText);
    }
    lookup.modalSaved = false;
    lookup.modalUndo = false;

    $('#modal .modal').off('click', '.undo-plan').on('click', '.undo-plan', function(e) {
      lookup.modalUndo = true;
    }).off('submit', 'form').on('submit', 'form', {
      "label": label
    }, function(e) {
      if (!e.data.label) e.data.label = "team";
      var reason = $('input:radio[name=reason]:checked').val();
      var reasonText = $('#modal textarea').val();

      log.recordFeedback(data.pathwayId, e.data.label, value, reason, reasonText);

      lookup.modalSaved = true;

      e.preventDefault();
      $('#modal .modal').modal('hide');
    }).modal();

    $('#modal').off('hidden.bs.modal').on('hidden.bs.modal', {
      "label": label
    }, function(e) {
      if (lookup.modalSaved) {
        lookup.modalSaved = false;
        if (callbackOnSave) callbackOnSave();
      } else if (lookup.modalUndo) {
        lookup.modalUndo = false;
        if (callbackOnUndo) callbackOnUndo();
      } else {
        //uncheck as cancelled. - but not if value is empty as this unchecks everything - or if already checked
        if (callbackOnCancel) callbackOnCancel();
      }
    });
  },

  sortSuggestions: function(suggestions) {
    suggestions.sort(function(a, b) {
      if (a.agree && !a.done) {
        if (b.agree && !b.done) return 0;
        return -1;
      } else if (!a.agree && !a.disagree) {
        if (!b.agree && !b.disagree) return 0;
        if (b.agree && !b.done) return 1;
        return -1;
      } else if (a.agree && a.done) {
        if (b.agree && b.done) return 0;
        if (b.disagree) return -1;
        return 1;
      } else {
        if (b.disagree) return 0;
        return 1;
      }
    });

    return suggestions;
  },

  addDisagreePersonalTeam: function(plans) {
    for (var i = 0; i < plans.length; i++) {
      if (plans[i].agree) {
        plans[i].disagree = false;
      } else if (plans[i].agree === false) {
        plans[i].disagree = true;
      }
    }
    return plans;
  },

  suggestionList: function(ids) {
    return ids.map(function(val) {
      return {
        "id": val.id || val,
        "text": log.text[val.id || val].text,
        "subsection": val.subsection
      };
    }).filter(function(v, i) { //RW to always limit to 3
      return i < 3;
    });
  },

  mergeIndividualStuff: function(suggestions, patientId) {
    var localActions = log.listActions();
    if (!localActions[patientId]) return suggestions;

    for (var i = 0; i < suggestions.length; i++) {
      if (localActions[patientId][suggestions[i].id]) {
        if (localActions[patientId][suggestions[i].id].agree) {
          suggestions[i].agree = true;
        } else if (localActions[patientId][suggestions[i].id].agree === false) {
          suggestions[i].disagree = true;
        }
        if (localActions[patientId][suggestions[i].id].done) suggestions[i].done = localActions[patientId][suggestions[i].id].done;
      }
    }
    return suggestions;
  },

  switchTo110Layout: function() {
    if (base.layout === "110") return;
    base.layout = "110";
    farLeftPanel.removeClass('col-lg-3 col-lg-8').addClass('col-lg-6').show();
    topPanel.hide();
    topLeftPanel.hide();
    bottomLeftPanel.hide();
    topRightPanel.hide();
    bottomRightPanel.hide();
    midPanel.hide();
    farRightPanel.removeClass('col-xl-4').addClass('col-xl-8').show();
  },

  switchTo101Layout: function() {
    if (base.layout === "101") return;
    base.layout = "101";
    farLeftPanel.removeClass('col-lg-3 col-lg-6 col-xl-4').addClass('col-lg-8').show();
    topPanel.hide();
    topLeftPanel.hide();
    bottomLeftPanel.hide();
    topRightPanel.hide();
    bottomRightPanel.hide();
    midPanel.hide();
    farRightPanel.removeClass('col-xl-8').addClass('col-xl-4').show();
  },



  switchTo221Layout: function() {
    if (base.layout === "221") return;
    base.layout = "221";
    farLeftPanel.hide();
    topPanel.hide();
    topLeftPanel.addClass('col-xl-6').show();
    bottomLeftPanel.addClass('col-xl-6').show();
    topRightPanel.removeClass('col-xl-12').addClass('col-xl-6').show();
    bottomRightPanel.removeClass('col-xl-12').addClass('col-xl-6').show();
    midPanel.removeClass('col-xl-4').addClass('col-xl-8').show();
    farRightPanel.removeClass('col-xl-8').addClass('col-xl-4').show();
  },

  switchTo21Layout: function() {
    if (base.layout === "21") return;
    base.layout = "21";
    farLeftPanel.hide();
    topPanel.hide();
    topLeftPanel.hide();
    bottomLeftPanel.hide();
    topRightPanel.removeClass('col-xl-6').addClass('col-xl-12').show();
    bottomRightPanel.removeClass('col-xl-6').addClass('col-xl-12').show();
    midPanel.removeClass('col-xl-4').addClass('col-xl-8').show();
    farRightPanel.removeClass('col-xl-8').addClass('col-xl-4').show();
  },

  wireUpStandardDropDown: function(pathwayId, pathwayStage, standard, callback) {
    var breaches = data.options.filter(function(val) {
      return val.pathwayId === pathwayId && val.pathwayStage === pathwayStage && val.standard === standard;
    });

    if (breaches.length > 0) $('select').val(breaches[0].value);

    $('select').select2({
      templateResult: base.formatStandard,
      minimumResultsForSearch: Infinity
    });
    $('span.select2-selection__rendered').attr("title", "");
    $('select').on('change', function() {
      var localData = $(this).find(':selected').data();
      callback(localData.pathwayId, localData.pathwayStage, localData.standard, data.patientId);
    }).on("select2:open", function(e) {
      base.wireUpTooltips();
    });
  },

  formatStandard: function(standard) {
    if (!standard.id) {
      return standard.text;
    }
    var localData = $(standard.element).data();
    // Not relevant
    var standardHtml = '';
    //if diagnosis opportunity then not relevant for other stages
    //if no mention anywhere then not relevant for that disease
    switch (data.getPatientStatus(data.patientId, localData.pathwayId, localData.pathwayStage, localData.standard)) {
      case "ok":
        standardHtml = '<span class="standard-achieved" data-toggle="tooltip" data-placement="left" title="' + data[localData.pathwayId][localData.pathwayStage].standards[localData.standard]["dropdown-tooltip"] + ' - QUALITY INDICATOR ACHIEVED">' + standard.text + ' <i class="fa fa-smile-o" style="color:green"></i></span>';
        break;
      case "missed":
        standardHtml = '<span class="standard-missed" data-toggle="tooltip" data-placement="left" title="' + data[localData.pathwayId][localData.pathwayStage].standards[localData.standard]["dropdown-tooltip"] + ' - IMPROVEMENT OPPORTUNITY EXISTS FOR THIS PATIENT">' + standard.text + ' <i class="fa fa-flag" style="color:red"></i></span>';
        break;
      case "not":
        standardHtml = '<span class="standard-not-relevant" data-toggle="tooltip" data-placement="left" title="' + data[localData.pathwayId][localData.pathwayStage].standards[localData.standard]["dropdown-tooltip"] + ' - STANDARD NOT RELEVANT TO THIS PATIENT">' + standard.text + ' <i class="fa fa-meh-o" style="color:gray"></i></span>';
        break;
    }
    var $standard = $(standardHtml);
    return $standard;
  },

  updateTitle: function(title){
    $('#title-left').html(title);
    $('#title-right').html("");
  },
  /*updateTitle: function(title, tooltip) {
    var titles = title;
    if (typeof title === "string") {
      titles = [{
        title: title,
        tooltip: tooltip
      }];
    }
    var content = titles.map(function(t, idx) {
      return idx === titles.length - 1 ? '<span title="' + t.tooltip + '">' + t.title + '</span>' : '<a href="' + t.url + '" title="' + t.tooltip + '">' + t.title + '</a>';
    }).join(" > ");

    $('.pagetitle').html(content);
  },*/

  hideAllPanels: function() {
    topLeftPanel.hide();
    bottomLeftPanel.hide();
    topRightPanel.hide();
    bottomRightPanel.hide();
    farLeftPanel.hide();
    farRightPanel.hide();
    topPanel.hide();
  },

  hidePanels: function(panel) {
    panel.children().hide();
  },

  updateTab: function(tab, value, url) {
    var tabElement = $('#mainTab a[data-href="#' + tab + '"]');
    tabElement.html(tabElement.text().split(":")[0] + ":<br><span><strong>" + value + "</strong></span>");
    tabElement.data("href", "#" + tab + "/" + url);
  },

  addFullPage: function(panel) {
    panel.fullpage({ verticalCentered: false, paddingBottom: '80px', scrollBar: true });

    $('.fp-down').off('click').on('click', function() {
      $.fn.fullpage.moveSectionDown();
    });

    $('.fp-up').off('click').on('click', function() {
      $.fn.fullpage.moveSectionUp();
    });
  },

  removeFullPage: function(panel) {
    if (panel.children('.section').length === 0) return;
    if ($.fn.fullpage && $.fn.fullpage.destroy) $.fn.fullpage.destroy('all'); //tidy up before doing it again
  },

  showLoading: function(){
    $('.loading-container').show();
    $('#title-row').hide();
  },

  hideLoading: function(){
    $('.loading-container').fadeOut(1000);
    $('#title-row').fadeIn(1000);
  },

};

module.exports = base;

},{"./chart.js":8,"./data.js":9,"./log.js":11,"./lookup.js":12,"mustache":4,"zeroclipboard":5}],8:[function(require,module,exports){
var Highcharts = require('highcharts/highstock'),
  data = require('./data.js'),
  lookup = require('./lookup.js'),
  log = require('./log.js'),
  Mustache = require('mustache');

console.log("chart.js: data.lastloader= " + data.lastloader);
data.lastloader = "chart.js";

var cht = {

  destroyCharts: function(charts) {
    for (var i = 0; i < charts.length; i++) {
      if (lookup.charts[charts[i]]) {
        lookup.charts[charts[i]].destroy();
        delete lookup.charts[charts[i]];
      }
    }
  },

  drawTrendChart: function(patientId, pathwayId, pathwayStage, standard) {
    var i, j;
    cht.destroyCharts(['chart-demo-trend']);
    if (!data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[0]]) {
      $('#chart-demo-trend').html('No data for this patients');
      $('#chart-demo-trend').parent().find('.table-chart-toggle').hide();
      return;
    }

    var chartData = data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[0]];
    var tableData = [];
    for (i = 1; i < data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[0]][0].length; i++) {
      tableData.push({
        "item": data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[0]][1][0],
        "value": data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[0]][1][i],
        "date": data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[0]][0][i]
      });
    }
    for (i = 1; i < data[pathwayId][pathwayStage].standards[standard].chart.length; i++) {
      chartData.push(data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[i]][1]); //RW TODO assumption here that all dates are the same
      for (j = 1; j < data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[0]][0].length; j++) {
        tableData.push({
          "item": data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[i]][1][0],
          "value": data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[i]][1][j],
          "date": data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[0]][0][j]
        });
      }
    }
    var chartOptions = {
      bindto: '#chart-demo-trend',
      data: {
        xs: {},
        classes: {},
        columns: chartData.slice()
      },
      zoom: {
        enabled: true
      },
      line: {
        connectNull: false
      },
      axis: {
        x: {
          type: 'timeseries',
          tick: {
            fit: false,
            format: '%d-%m-%Y',
            count: 5
          },
          max: new Date()
        },
        y: {
          label: {
            text: data[pathwayId][pathwayStage].standards[standard].chartUnits,
            position: 'outer-middle'
          }
        }
      }
    };

    var maxValue = 0;
    var standardItems = [];

    for (i = 1; i < chartOptions.data.columns.length; i++) {
      chartOptions.data.xs[chartOptions.data.columns[i][0]] = "x";
      standardItems.push(chartOptions.data.columns[i][0]);

      for (j = 1; j < chartOptions.data.columns[i].length; j++) {
        if (parseFloat(chartOptions.data.columns[i][j]) > maxValue) maxValue = parseFloat(chartOptions.data.columns[i][j]);
      }
    }

    chartOptions.tooltip = {
      format: {
        value: function(value, ratio, id) {
          var text = standardItems.indexOf(id) > -1 ? value : "";
          return text;
        }
      }
    };

    var lines = null;
    var axisnum = 1;
    if (data.patients[patientId].contacts) {
      for (i = 0; i < data.patients[patientId].contacts.length; i++) {
        chartOptions.data.classes[data.patients[patientId].contacts[i].text] = 'larger';
        if (!chartOptions.data.xs[data.patients[patientId].contacts[i].text]) {
          chartOptions.data.xs[data.patients[patientId].contacts[i].text] = "x" + axisnum;
          chartOptions.data.columns.push(["x" + axisnum, data.patients[patientId].contacts[i].value]);
          chartOptions.data.columns.push([data.patients[patientId].contacts[i].text, (maxValue * 1.1).toString()]);
          axisnum++;
        } else {
          var axis = chartOptions.data.xs[data.patients[patientId].contacts[i].text];
          for (j = 1; j < chartOptions.data.columns.length; j++) {
            if (chartOptions.data.columns[j][0] === axis) {
              chartOptions.data.columns[j].push(data.patients[patientId].contacts[i].value);
            } else if (chartOptions.data.columns[j][0] === data.patients[patientId].contacts[i].text) {
              chartOptions.data.columns[j].push((maxValue * 1.1).toString());
            }
          }
        }
        tableData.push({
          "item": "Event",
          "value": data.patients[patientId].contacts[i].text,
          "date": data.patients[patientId].contacts[i].value
        });
      }
    }

    var patientEvents = log.getEvents().filter(function(val) {
      return val.id === patientId;
    });
    if (patientEvents.length > 0) {

      for (i = 0; i < patientEvents.length; i++) {
        chartOptions.data.classes[patientEvents[i].name] = 'larger';
        if (!chartOptions.data.xs[patientEvents[i].name]) {
          chartOptions.data.xs[patientEvents[i].name] = "x" + axisnum;
          chartOptions.data.columns.push(["x" + axisnum, patientEvents[i].date.substr(0, 10)]);
          chartOptions.data.columns.push([patientEvents[i].name, (maxValue * 1.1).toString()]);
          axisnum++;
        } else {
          var axis2 = chartOptions.data.xs[patientEvents[i].name];
          for (j = 1; j < chartOptions.data.columns.length; j++) {
            if (chartOptions.data.columns[j][0] === axis2) {
              chartOptions.data.columns[j].push(patientEvents[i].date.substr(0, 10));
            } else if (chartOptions.data.columns[j][0] === patientEvents[i].name) {
              chartOptions.data.columns[j].push((maxValue * 1.1).toString());
            }
          }
        }
        tableData.push({
          "item": "Event",
          "value": patientEvents[i].name,
          "date": patientEvents[i].date.substr(0, 10)
        });
      }
    }

    tableData.sort(function(a, b) {
      if (a.date === b.date) return 0;
      else return a.date < b.date ? 1 : -1;
    });
    //draw Table
    $('#table-demo-trend').html(Mustache.render($('#value-trend-panel-table').html(), {
      "items": tableData
    }, {
      "item-row": $('#value-trend-panel-table-row').html()
    }));

    //draw charts in separate thread and with delay to stop sluggish appearance
    setTimeout(function() {
      lookup.charts['chart-demo-trend'] = c3.generate(chartOptions);
    }, 1);
  },

  selectPieSlice: function(chart, d) {
    lookup.chartClicked = true;
    $('#' + chart + ' path.c3-bar').attr('class', function(index, classNames) {
      return classNames + ' _unselected_';
    });
    lookup.charts[chart].select([d.id], [d.index], true);

    farRightPanel.fadeOut(200, function() {
      var template = $('#patient-panel-placeholder').html();
      farRightPanel.html(Mustache.render(template)).show();
    });
  },

  drawOverviewChart: function(pathwayId, pathwayStage, enableHover) {
    cht.destroyCharts([pathwayStage + '-chart']);
    setTimeout(function() {
      lookup.charts[pathwayStage + '-chart'] = c3.generate({
        bindto: '#' + pathwayStage + '-chart',
        data: {
          x: 'x',
          columns: data[pathwayId][pathwayStage].trend
        },
        zoom: {
          enabled: true
        },
        tooltip: {
          format: {
            title: function(x) {
              return x.toDateString() + (enableHover ? '<br>Click for more detail' : '');
            },
            value: function(value) {
              return enableHover ? value + '%' : undefined;
            }
          }
        },
        axis: {
          x: {
            type: 'timeseries',
            tick: {
              format: '%d-%m-%Y',
              count: 7,
              culling: {
                max: 4
              }
            },
            label: {
              text: 'Date',
              position: 'outer-center'
            }
          },
          y: {
            min: 0,
            label: {
              text: 'Proportion (%)',
              position: 'outer-middle'
            }
          }
        },
        point: {
          show: false
        },
        size: {
          height: null
        }
      });
    }, 1);
  },

  drawBenchmarkChart: function(element, data) {
    cht.destroyCharts([element + '-chart']);
    setTimeout(function() {
      lookup.charts[element + '-chart'] = c3.generate({
        bindto: '#' + element,
        size: {
          height: 200
        },
        data: data,
        axis: {
          x: {
            type: 'category',
            tick: {
              rotate: 60,
              multiline: false
            }
          },
          y: {
            label: {
              text: '% of patients meeting the target',
              position: 'outer-middle'
            }
          }
        },
        grid: {
          y: {
            show: true
          }
        }
      });
    }, 1);
  },

  drawPerformanceTrendChart: function(element, data) {
    cht.destroyCharts([element + '-chart']);
    setTimeout(function() {
      lookup.charts[element + '-chart'] = c3.generate({
        bindto: '#' + element,
        size: {
          height: 200
        },
        data: data,
        axis: {
          x: {
            type: 'timeseries',
            tick: {
              format: '%Y-%m-%d',
              rotate: 60,
              multiline: false
            },
            height: 60
          },
          y: {
            label: {
              text: "Performance",
              position: 'outer-middle'
            }
          }
        },
        grid: {
          x: {
            show: true
          },
          y: {
            show: true
          }
        }
      });
    }, 1);
  },

  drawBenchmarkChartHC: function(element, data) {

    data = [
      { x: 49.9, p: 'P1', local: true },
      { x: 71.5, p: 'P2', local: true },
      { x: 16.4, p: 'P3', local: true },
      { x: 29.2, p: 'P4', local: true },
      { x: 44.0, p: 'P5', local: true },
      { x: 76.0, p: 'P6', local: true },
      { x: 35.6, p: 'YOU', local: true },
      { x: 48.5, p: 'P7', local: true },
      { x: 26.4, p: 'P8', local: true },
      { x: 94.1, p: 'P9', local: true },
      { x: 95.6, p: 'P10' },
      { x: 54.0, p: 'P11' },
      { x: 39.9, p: 'P12' },
      { x: 61.5, p: 'P13' },
      { x: 6.4, p: 'P14' },
      { x: 19.2, p: 'P15' },
      { x: 34.0, p: 'P16' },
      { x: 66.0, p: 'P17' },
      { x: 25.6, p: 'P18' },
      { x: 38.5, p: 'P19' },
      { x: 36.4, p: 'P20' },
      { x: 84.1, p: 'P21' },
      { x: 85.6, p: 'P22' },
      { x: 64.0, p: 'P23' }
    ];
    data.sort(function(a, b) {
      return a.x - b.x;
    });

    var local = true;
    var bChart = $('#' + element).highcharts({
      chart: {
        type: 'column',
        events: {
          load: function() {
            var thisChart = this;
            thisChart.renderer.button('Toggle neighbourhood / CCG', thisChart.plotWidth - 100, 0, function() {
              local = !local;
              thisChart.xAxis[0].categories = data.filter(function(v) {
                if (local) return v.local;
                else return true;
              }).map(function(v) {
                return v.p;
              });
              thisChart.series[0].setData(data.filter(function(v) {
                if (local) return v.local;
                else return true;
              }).map(function(v) {
                if (v.p === "YOU") return { y: v.x, color: "red" };
                else return v.x;
              }));
            }).add();
          }
        }
      },
      title: { text: 'Benchmark' },
      xAxis: {
        categories: data.filter(function(v) {
          return v.local === local;
        }).map(function(v) {
          return v.p;
        }),
        crosshair: true
      },
      yAxis: {
        min: 0,
        max: 100,
        title: { text: '% patients meeting target' }
      },
      tooltip: {
        headerFormat: '<span style="font-size:10px">Practice: <b>{point.key}</b></span><table>',
        pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
          '<td style="padding:0"><b>{point.y:.1f}%</b></td></tr>',
        footerFormat: '</table>',
        shared: true,
        useHTML: true
      },
      plotOptions: {
        column: {
          pointPadding: 0.2,
          borderWidth: 0
        }
      },
      legend: {
        enabled: false
      },
      series: [{
        name: 'Performance',
        data: data.filter(function(v) {
          return v.local === local;
        }).map(function(v) {
          if (v.p === "YOU") return { y: v.x, color: "red" };
          else return v.x;
        })
      }]
    });
  },

  drawPerformanceTrendChartHC: function(element, data) {

    /// data is
    // {
    //  "values":
    //    ["x", "2015-08-24", "2015-08-23",...
    //    ["numerator", 35, 37, 33, 32, 31,...
    //    ["denominator", 135, 133, 133, 13,...
    //    ["target", 0.3, 0.3, 0...
    // }

    var target = 0.75,
      maxValue = target,
      maxXvalue = 0;

    var series = [
      { type: 'line', name: 'Trend', data: [] },
      { type: 'line', name: 'Prediction', data: [], dashStyle: 'dot' }
    ];

    var today = new Date();
    var lastApril = new Date();
    var aprilBeforeThat = new Date();
    var nextApril = new Date();
    if (today.getMonth() < 3) {
      //after april
      lastApril.setYear(today.getFullYear() - 1);
      aprilBeforeThat.setYear(today.getFullYear() - 1);
    } else {
      nextApril.setYear(today.getFullYear() + 1);
    }
    aprilBeforeThat.setYear(aprilBeforeThat.getFullYear() - 1);
    lastApril.setMonth(3);
    aprilBeforeThat.setMonth(3);
    nextApril.setMonth(3);
    lastApril.setDate(1);
    aprilBeforeThat.setDate(1);
    nextApril.setDate(1);

    var n = 0,
      sumX = 0,
      sumY = 0,
      sumXY = 0,
      sumXX = 0,
      sumYY = 0,
      intercept, gradient, compDate;

    if (data.values[0].filter(function(v) {
        return new Date(v).getTime() > lastApril.getTime();
      }).length > 2) compDate = new Date(lastApril.getTime());
    else compDate = new Date(aprilBeforeThat.getTime());

    data.values[0].forEach(function(v, i) {
      if (i === 0) return;
      var time = new Date(v).getTime();
      var y = +data.values[1][i] / +data.values[2][i];
      if (time >= compDate.getTime()) {
        n++;
        sumX += time;
        sumY += y;
        sumXY += time * y;
        sumXX += time * time;
        sumYY += y * y;
      }
      series[0].data.push([time, y]);
      maxValue = Math.max(maxValue, y);
      maxXvalue = Math.max(maxXvalue, time);
    });

    intercept = (sumY * sumXX - sumX * sumXY) / (n * sumXX - sumX * sumX);
    gradient = (n * sumXY - sumX * sumY) / (n * sumXX - sumX * sumX);

    series[1].data.push([maxXvalue, maxXvalue * gradient + intercept]);
    for (var i = 0; i < 13; i++) {
      var x = compDate.getTime();
      if (x < maxXvalue) {
        compDate.setMonth(compDate.getMonth() + 1);
        continue;
      }
      series[1].data.push([x, x * gradient + intercept]);
      var m = compDate.getMonth();
      compDate.setMonth(compDate.getMonth() + 1);
    }

    //Add line of best fit for latest data since april to next april


    //Default to last april - april


    var c = $('#' + element).highcharts({
      title: { text: '' },
      xAxis: {
        max: nextApril.getTime(),
        type: 'datetime'
      },
      yAxis: {
        title: { text: 'Quality standard performance' },
        max: maxValue + 0.05,
        min: 0,
        plotLines: [{
          value: target,
          color: 'green',
          dashStyle: 'shortdash',
          width: 2,
          label: {
            text: 'Target - ' + (target * 100) + '%'
          },
        }]
      },
      legend: { enabled: true },

      navigator: {
        enabled: true
      },

      series: series
    });

    c.highcharts().axes[0].setExtremes(aprilBeforeThat.getTime(), lastApril.getTime(), undefined, false);

  },

  drawAnalytics: function(element, data, selectSeriesFn) {

    cht.cloneToolTip = null;
    cht.cloneToolTip2 = null;

    $('#' + element).highcharts({
      chart: {
        type: "column",
        backgroundColor: "#F3F9F9",
        height: 200,
        events: {
          click: function(event) {
            selectSeriesFn();

            if (cht.cloneToolTip) {
              this.container.firstChild.removeChild(cht.cloneToolTip);
              cht.cloneToolTip = null;
            }
            if (cht.cloneToolTip2) {
              cht.cloneToolTip2.remove();
              cht.cloneToolTip2 = null;
            }

            return false;
          }
        }
      },
      title: {
        text: 'Patients not meeting the standard'
      },
      subtitle: {
        text: document.ontouchstart === undefined ?
          'Click a column to filter the patient list' : 'Tap a column to filter the patient list'
      },
      xAxis: {
        categories: data.map(function(v, i) {
          return v[0];
        })
      },
      yAxis: {
        title: {
          text: 'Number of patients'
        },
        stackLabels: {
          enabled: true,
          style: {
            fontWeight: 'bold',
            color: (Highcharts.theme && Highcharts.theme.textColor) || 'gray'
          }
        }
      },
      legend: {
        enabled: false
      },

      plotOptions: {

        column: {
          dataLabels: {
            enabled: true,
            color: 'black'
          }
        },

        series: {
          cursor: 'pointer',
          point: {
            events: {
              click: function(event) {
                var numPoints = this.series.points.length;

                selectSeriesFn(this.category);

                if (cht.cloneToolTip) {
                  this.series.chart.container.firstChild.removeChild(cht.cloneToolTip);
                }
                if (cht.cloneToolTip2) {
                  cht.cloneToolTip2.remove();
                }
                cht.cloneToolTip = this.series.chart.tooltip.label.element.cloneNode(true);
                this.series.chart.container.firstChild.appendChild(cht.cloneToolTip);

                cht.cloneToolTip2 = $('.highcharts-tooltip').clone();
                $(this.series.chart.container).append(cht.cloneToolTip2);

                return false;
              }
            }
          }
        }
      },

      series: [{
        data: data.map(function(v, i) {
          return {
            y: v[v.length - 1],
            color: Highcharts.getOptions().colors[i]
          };
        })
      }]
    });
  }

};

module.exports = cht;

},{"./data.js":9,"./log.js":11,"./lookup.js":12,"highcharts/highstock":2,"mustache":4}],9:[function(require,module,exports){
var log = require('./log.js'),
  lookup = require('./lookup.js');


var _getAllIndicatorData = function(callback) {
  var r = Math.random();
  $.getJSON("data/indicators.json?v=" + r, function(file) {
    dt.indicators = file;

    dt.indicators.forEach(function(indicator) {
      var percentage = Math.round(100 * indicator.values[1][1] * 100 / indicator.values[2][1]) / 100;
      indicator.performance = indicator.values[1][1] + " / " + indicator.values[2][1] + " (" + percentage + "%)";
      indicator.target = indicator.values[3][1] * 100 + "%";
      indicator.up = percentage > Math.round(100 * indicator.values[1][2] * 100 / indicator.values[2][2]) / 100;
      var trend = indicator.values[1].map(function(val, idx) {
        return Math.round(100 * val * 100 / indicator.values[2][idx]) / 100;
      }).slice(1, 10);
      trend.reverse();
      indicator.trend = trend.join(",");
      var dates = indicator.values[0].slice(1, 10);
      dates.reverse();
      indicator.dates = dates;
    });


    callback(dt.indicators);
  });
};

var _getAllIndicatorDataSync = function(callback) {
  var r = Math.random();
  $.ajax({
    url: "data/indicators.json?v=" + r,
    async: false,
    success: function(file) {
      dt.indicators = file;

      dt.indicators.forEach(function(indicator) {
        var percentage = Math.round(100 * indicator.values[1][1] * 100 / indicator.values[2][1]) / 100;
        indicator.performance = indicator.values[1][1] + " / " + indicator.values[2][1] + " (" + percentage + "%)";
        indicator.target = indicator.values[3][1] * 100 + "%";
        indicator.up = percentage > Math.round(100 * indicator.values[1][2] * 100 / indicator.values[2][2]) / 100;
        var trend = indicator.values[1].map(function(val, idx) {
          return Math.round(100 * val * 100 / indicator.values[2][idx]) / 100;
        }).slice(1, 10);
        trend.reverse();
        indicator.trend = trend.join(",");
        var dates = indicator.values[0].slice(1, 10);
        dates.reverse();
        indicator.dates = dates;
      });

    }
  });

  return dt.indicators;
};

var _getIndicatorData = function(indicator, callback) {
  var r = Math.random();
  $.getJSON("data/idata." + indicator + ".json?v=" + r, function(file) {
    dt.indicators[indicator] = file;

    //apply which categories people belong to
    Object.keys(dt.indicators[indicator].patients).forEach(function(patient) {
      dt.indicators[indicator].patients[patient].opportunities = [];
      dt.indicators[indicator].opportunities.forEach(function(opp, idx) {
        if (opp.patients.indexOf(+patient) > -1) {
          dt.indicators[indicator].patients[patient].opportunities.push(idx);
        }
      });
    });

    callback(dt.indicators[indicator]);
  });
};

var _getIndicatorDataSync = function(indicator) {
  var r = Math.random();
  $.ajax({
    url: "data/idata." + indicator + ".json?v=" + r,
    async: false,
    success: function(file) {
      dt.indicators[indicator] = file;

      //apply which categories people belong to
      Object.keys(dt.indicators[indicator].patients).forEach(function(patient) {
        dt.indicators[indicator].patients[patient].opportunities = [];
        dt.indicators[indicator].opportunities.forEach(function(opp, idx) {
          if (opp.patients.indexOf(+patient) > -1) {
            dt.indicators[indicator].patients[patient].opportunities.push(idx);
          }
        });
      });

    }
  });
  return dt.indicators[indicator];
};

var _getFakePatientData = function(patient, callback) {
  var r = Math.random(),
    isAsync = typeof(callback) === "function";
  if (dt.patients && dt.patients.patient) {
    if (isAsync) return callback(dt.patients.patient);
    else return dt.patients.patient;
  }
  $.ajax({
    url: "data/patient.json?v=" + r,
    async: isAsync,
    success: function(file) {
      if (!dt.patients) dt.patients = {};
      dt.patients.patient = file;
      dt.patients[patient] = file;

      if (isAsync) callback(dt.patients.patient);
    }
  });
  if (!isAsync) return dt.patients.patient;
};

var _getPatientData = function(patient, callback) {
  //if callback provided do async - else do sync
  var r = Math.random(),
    isAsync = typeof(callback) === "function";

  if (dt.patients && dt.patients[patient]) {
    if (isAsync) return callback(dt.patients[patient]);
    else return dt.patients[patient];
  }

  $.ajax({
    url: "data/" + patient + ".json?v=" + r,
    async: isAsync,
    success: function(file) {
      if (!dt.patients) dt.patients = {};
      dt.patients[patient] = file;

      if (isAsync) callback(dt.patients[patient]);
    },
    error: function() {
      if (dt.patients.patient && isAsync) {
        dt.patients[patient] = dt.patients.patient;
        return callback(dt.patients.patient);
      } else if (!dt.patients.patient) {
        _getFakePatientData(patient, callback);
      }
    }
  });

  if (!isAsync) return dt.patients.patient;
};

var dt = {

  pathwayNames: {},
  diseases: [],
  options: [],
  patLookup: {},

  getPatietListForStandard: function(pathwayId, pathwayStage, standard) {
    var patients = dt.removeDuplicates(dt[pathwayId][pathwayStage].standards[standard].opportunities.reduce(function(a, b) {
      return a.patients ? a.patients.concat(b.patients) : a.concat(b.patients);
    }));
    return patients;
  },

  getPatientStatus: function(patientId, pathwayId, pathwayStage, standard) {
    if (dt.patients[patientId].breach) {
      if (dt.patients[patientId].breach.filter(function(val) {
          return val.pathwayId === pathwayId && val.pathwayStage === pathwayStage && val.standard === standard;
        }).length > 0) {
        return "missed";
      } else if (dt.patients[patientId].breach.filter(function(val) {
          return val.pathwayId === pathwayId && val.pathwayStage === "diagnosis";
        }).length > 0 && pathwayStage !== "diagnosis") {
        return "not";
      } else if (dt.patients[patientId].breach.filter(function(val) {
          return val.pathwayId === pathwayId;
        }).length > 0) {
        return "ok";
      } else {
        return "not";
      }
    } else {
      return "not";
    }
  },

  getNumeratorForStandard: function(pathwayId, pathwayStage, standard) {
    var patients = dt.getPatietListForStandard(pathwayId, pathwayStage, standard);
    return patients.length;
  },

  getDenominatorForStandard: function(pathwayId, pathwayStage) {
    var patients = dt[pathwayId][pathwayStage].patientsOk;
    for (var standard in dt[pathwayId][pathwayStage].standards) {
      var newPatients = dt.getPatietListForStandard(pathwayId, pathwayStage, standard);
      patients = patients.concat(newPatients);
    }
    return dt.removeDuplicates(patients).length;
  },

  removeDuplicates: function(array) {
    var arrResult = {};
    var rtn = [];
    for (var i = 0; i < array.length; i++) {
      arrResult[array[i]] = array[i];
    }
    for (var item in arrResult) {
      rtn.push(arrResult[item]);
    }
    return rtn;
  },

  numberOfStandardsMissed: function(patientId) {
    if (!dt.patients[patientId].breach) return 0;
    var a = dt.patients[patientId].breach.map(function(val) {
      return val.pathwayId + val.pathwayStage + val.standard;
    });
    var obj = {};
    for (var i = 0; i < a.length; i++) {
      obj[a[i]] = "";
    }
    return Object.keys(obj).length;
  },

  getAllPatients: function() {
    var pList = [],
      i, k, prop;
    for (k = 0; k < dt.diseases.length; k++) {
      for (i in lookup.categories) {
        for (prop in dt[dt.diseases[k].id][i].bdown) {
          if (dt[dt.diseases[k].id][i].bdown.hasOwnProperty(prop)) {
            pList = pList.concat(dt[dt.diseases[k].id][i].bdown[prop].patients);
          }
        }
        pList = pList.concat(dt[dt.diseases[k].id][i].patientsOk);
      }
    }
    pList = dt.removeDuplicates(pList);
    var patients = pList.map(function(patientId) {
      var ret = dt.patients[patientId];
      ret.nhsNumber = dt.patLookup ? dt.patLookup[patientId] : patientId;
      ret.patientId = patientId;
      ret.items = []; //The fields in the patient list table
      ret.items.push(dt.numberOfStandardsMissed(patientId));
      return ret;
    });

    return patients;
  },

  get: function(callback, json) {
    //get text
    $.getJSON("data/text.json?v=" + Math.random(), function(textfile) {
      dt.text = textfile.pathways;

      if (json) {
        dt.newload(json);
        if (typeof callback === 'function') callback();
      } else {
        $.getJSON("data/data.json?v=" + Math.random(), function(file) {
          dt.newload(file);
          if (typeof callback === 'function') callback();
        }).fail(function(err) {
          alert("data/data.json failed to load!! - if you've changed it recently check it's valid json at jsonlint.com");
        });
      }

    }).fail(function(err) {
      alert("data/text.json failed to load!! - if you've changed it recently check it's valid json at jsonlint.com");
    });
  },

  newload: function(file) {
    dt.indicators = file.indicators;
    dt.pathwayNames = {};

    dt.indicators.forEach(function(indicator) {
      var pathwayId = indicator.id.split(".")[0];
      var pathwayStage = indicator.id.split(".")[1];
      var standard = indicator.id.split(".")[2];
      if (!dt.pathwayNames[pathwayId]) dt.pathwayNames[pathwayId] = "";
      var percentage = Math.round(100 * indicator.values[1][1] * 100 / indicator.values[2][1]) / 100;
      indicator.performance = {
        fraction: indicator.values[1][1] + "/" + indicator.values[2][1],
        percentage: percentage
      };
      indicator.benchmark = "90%"; //TODO magic number
      indicator.target = indicator.values[3][1] * 100 + "%";
      indicator.up = percentage > Math.round(100 * indicator.values[1][2] * 100 / indicator.values[2][2]) / 100;
      var trend = indicator.values[1].map(function(val, idx) {
        return Math.round(100 * val * 100 / indicator.values[2][idx]) / 100;
      }).slice(1, 10);
      trend.reverse();
      indicator.trend = trend.join(",");
      var dates = indicator.values[0].slice(1, 10);
      dates.reverse();
      indicator.dates = dates;
      if (dt.text[pathwayId] && dt.text[pathwayId][pathwayStage] && dt.text[pathwayId][pathwayStage].standards[standard]) {
        indicator.description = dt.text[pathwayId][pathwayStage].standards[standard].description;
        indicator.tagline = dt.text[pathwayId][pathwayStage].standards[standard].tagline;
        indicator.positiveMessage = dt.text[pathwayId][pathwayStage].standards[standard].positiveMessage;
      } else {
        indicator.description = "No description specified";
        indicator.tagline = "";
      }

      dt.indicators[indicator.id] = { performance: indicator.performance, tagline: indicator.tagline, positiveMessage: indicator.positiveMessage, target: indicator.target, "opportunities": indicator.opportunities || [], "patients": {} };

      //apply which categories people belong to
      dt.patients = {};
      dt.patientArray = [];

      Object.keys(file.patients).forEach(function(patient) {
        dt.patientArray.push(patient);
        dt.patients[patient] = file.patients[patient];
        dt.indicators[indicator.id].patients[patient] = {};
        dt.indicators[indicator.id].patients[patient].opportunities = [];
        dt.indicators[indicator.id].opportunities.forEach(function(opp, idx) {
          if (opp.patients.indexOf(+patient) > -1) {
            dt.indicators[indicator.id].patients[patient].opportunities.push(idx);
          }
        });
      });
    });


  },

  load: function(file) {
    var d = "",
      j, k, key, data = file.diseases;

    dt = jQuery.extend(dt, data); //copy

    dt.patients = file.patients;
    dt.codes = file.codes;
    dt.patientArray = [];
    for (var o in file.patients) {
      if (file.patients.hasOwnProperty(o)) {
        dt.patientArray.push(o);
      }
    }

    for (d in data) {
      dt.pathwayNames[d] = data[d]["display-name"];
      var diseaseObject = {
        "id": d,
        "link": data[d].link ? data[d].link : "dt/" + d,
        "faIcon": data[d].icon,
        "name": data[d]["display-name"],
        "text": {
          "dt": {
            "tooltip": data[d]["side-panel-tooltip"]
          }
        }
      };
      if (data[d].monitoring.text) {
        diseaseObject.text.monitoring = data[d].monitoring.text.sidePanel;
      }
      if (data[d].treatment.text) {
        diseaseObject.text.treatment = data[d].treatment.text.sidePanel;
      }
      if (data[d].diagnosis.text) {
        diseaseObject.text.diagnosis = data[d].diagnosis.text.sidePanel;
      }
      if (data[d].exclusions.text) {
        diseaseObject.text.exclusions = data[d].exclusions.text.sidePanel;
      }
      this.diseases.push(diseaseObject);
      dt[d].suggestions = log.plan[d].team;
      $.extend(dt[d].monitoring, {
        "breakdown": [],
        "bdown": {}
      });
      $.extend(dt[d].treatment, {
        "breakdown": [],
        "bdown": {}
      });
      $.extend(dt[d].diagnosis, {
        "breakdown": [],
        "bdown": {}
      });
      $.extend(dt[d].exclusions, {
        "breakdown": [],
        "bdown": {}
      });

      if (!dt[d].monitoring.header) continue;
      for (key in dt[d].monitoring.standards) {
        this.options.push({
          "value": this.options.length,
          "pathwayId": d,
          "pathwayStage": "monitoring",
          "standard": key,
          "text": this.pathwayNames[d] + ' - ' + "Monitoring" + ' - ' + dt[d].monitoring.standards[key].tab.title
        });
        for (j = 0; j < dt[d].monitoring.standards[key].opportunities.length; j++) {
          dt[d].monitoring.bdown[dt[d].monitoring.standards[key].opportunities[j].name] = dt[d].monitoring.standards[key].opportunities[j];
          dt[d].monitoring.bdown[dt[d].monitoring.standards[key].opportunities[j].name].suggestions = log.plan[d].monitoring.individual[dt[d].monitoring.standards[key].opportunities[j].name];
          for (k = 0; k < dt[d].monitoring.standards[key].opportunities[j].patients.length; k++) {
            if (!dt.patients[dt[d].monitoring.standards[key].opportunities[j].patients[k]].breach) dt.patients[dt[d].monitoring.standards[key].opportunities[j].patients[k]].breach = [];
            dt.patients[dt[d].monitoring.standards[key].opportunities[j].patients[k]].breach.push({
              "pathwayId": d,
              "pathwayStage": "monitoring",
              "standard": key,
              "subsection": dt[d].monitoring.standards[key].opportunities[j].name
            });
          }
        }
      }
      for (key in dt[d].diagnosis.standards) {
        this.options.push({
          "value": this.options.length,
          "pathwayId": d,
          "pathwayStage": "diagnosis",
          "standard": key,
          "text": this.pathwayNames[d] + ' - ' + "Diagnosis" + ' - ' + dt[d].diagnosis.standards[key].tab.title
        });
        for (j = 0; j < dt[d].diagnosis.standards[key].opportunities.length; j++) {
          dt[d].diagnosis.bdown[dt[d].diagnosis.standards[key].opportunities[j].name] = dt[d].diagnosis.standards[key].opportunities[j];
          dt[d].diagnosis.bdown[dt[d].diagnosis.standards[key].opportunities[j].name].suggestions = log.plan[d].diagnosis.individual[dt[d].diagnosis.standards[key].opportunities[j].name];
          for (k = 0; k < dt[d].diagnosis.standards[key].opportunities[j].patients.length; k++) {
            if (!dt.patients[dt[d].diagnosis.standards[key].opportunities[j].patients[k]].breach) dt.patients[dt[d].diagnosis.standards[key].opportunities[j].patients[k]].breach = [];
            dt.patients[dt[d].diagnosis.standards[key].opportunities[j].patients[k]].breach.push({
              "pathwayId": d,
              "pathwayStage": "diagnosis",
              "standard": key,
              "subsection": dt[d].diagnosis.standards[key].opportunities[j].name
            });
          }
        }
      }
      for (key in dt[d].treatment.standards) {
        this.options.push({
          "value": this.options.length,
          "pathwayId": d,
          "pathwayStage": "treatment",
          "standard": key,
          "text": this.pathwayNames[d] + ' - ' + "Treatment" + ' - ' + dt[d].treatment.standards[key].tab.title
        });
        for (j = 0; j < dt[d].treatment.standards[key].opportunities.length; j++) {
          dt[d].treatment.bdown[dt[d].treatment.standards[key].opportunities[j].name] = dt[d].treatment.standards[key].opportunities[j];
          dt[d].treatment.bdown[dt[d].treatment.standards[key].opportunities[j].name].suggestions = log.plan[d].treatment.individual[dt[d].treatment.standards[key].opportunities[j].name];
          for (k = 0; k < dt[d].treatment.standards[key].opportunities[j].patients.length; k++) {
            if (!dt.patients[dt[d].treatment.standards[key].opportunities[j].patients[k]].breach) dt.patients[dt[d].treatment.standards[key].opportunities[j].patients[k]].breach = [];
            dt.patients[dt[d].treatment.standards[key].opportunities[j].patients[k]].breach.push({
              "pathwayId": d,
              "pathwayStage": "treatment",
              "standard": key,
              "subsection": dt[d].treatment.standards[key].opportunities[j].name
            });
          }
        }
      }
      for (key in dt[d].exclusions.standards) {
        this.options.push({
          "value": this.options.length,
          "pathwayId": d,
          "pathwayStage": "exclusions",
          "standard": key,
          "text": this.pathwayNames[d] + ' - ' + "Exclusions" + ' - ' + dt[d].exclusions.standards[key].tab.title
        });
        for (j = 0; j < dt[d].exclusions.standards[key].opportunities.length; j++) {
          dt[d].exclusions.bdown[dt[d].exclusions.standards[key].opportunities[j].name] = dt[d].exclusions.standards[key].opportunities[j];
          dt[d].exclusions.bdown[dt[d].exclusions.standards[key].opportunities[j].name].suggestions = log.plan[d].exclusions.individual[dt[d].exclusions.standards[key].opportunities[j].name];
          for (k = 0; k < dt[d].exclusions.standards[key].opportunities[j].patients.length; k++) {
            if (!dt.patients[dt[d].exclusions.standards[key].opportunities[j].patients[k]].breach) dt.patients[dt[d].exclusions.standards[key].opportunities[j].patients[k]].breach = [];
            dt.patients[dt[d].exclusions.standards[key].opportunities[j].patients[k]].breach.push({
              "pathwayId": d,
              "pathwayStage": "exclusions",
              "standard": key,
              "subsection": dt[d].exclusions.standards[key].opportunities[j].name
            });
          }
        }
      }
    }
  },

  getAllIndicatorData: function(callback) {
    if (dt.indicators) {
      return callback(dt.indicators);
    } else {
      _getAllIndicatorData(callback);
    }
  },

  getAllIndicatorDataSync: function() {
    if (dt.indicators) {
      return dt.indicators;
    } else {
      return _getAllIndicatorDataSync();
    }
  },

  getIndicatorData: function(indicator, callback) {
    if (!dt.indicators) {
      _getAllIndicatorData(function(data) {
        _getIndicatorData(indicator, callback);
      });
    } else if (dt.indicators && dt.indicators[indicator]) {
      return callback(dt.indicators[indicator]);
    } else {
      _getIndicatorData(indicator, callback);
    }
  },

  getIndicatorDataSync: function(indicator) {
    dt.getAllIndicatorDataSync();
    if (dt.indicators[indicator]) {
      return dt.indicators[indicator];
    } else {
      return _getIndicatorDataSync(indicator);
    }
  },

  getPatientData: function(patientId, callback) {
    return _getPatientData(patientId, callback);
  }

};

module.exports = dt;

},{"./log.js":11,"./lookup.js":12}],10:[function(require,module,exports){
var data = require('./data.js'),
Mustache = require('mustache');

var layout = {

  elements: {},

  //Side panel, navigation, header bar and main page
  showMainView: function() {
    //Set up navigation panel
    ////layout.showSidePanel();
    ////layout.showNavigation(data.diseases, idx, $('#main-dashboard'));

    $('#bottomnavbar').hide();
    layout.showHeaderBarItems();

    //Show main dashboard page
    layout.showPage('main-dashboard');
  },

  clearNavigation: function() {
    $("aside.left-panel nav.navigation > ul > li > ul").slideUp(300);
    $("aside.left-panel nav.navigation > ul > li").removeClass('active');
  },

  showNavigation: function(list, idx, parent) {
    if (layout.elements.navigation) {

      if (idx === -1) {
        layout.clearNavigation();
        $('aside a[href="#welcome"]:first').closest('li').addClass('active');
      } else if (idx >= list.length) {
        layout.clearNavigation();
        $('aside a[href="#patients"]').closest('li').addClass('active');
      } else if (!$('aside a[href="#' + list[idx].link + '"]:first').closest('li').hasClass('active')) {
        layout.clearNavigation();
        //set active
        $('aside a[href="#' + list[idx].link + '"]').next().slideToggle(300);
        $('aside a[href="#' + list[idx].link + '"]').closest('li').addClass('active');
      }

      return;
    }

    var tempMust = $('#pathway-picker').html();
    var itemTemplate = $('#pathway-picker-item').html();
    Mustache.parse(tempMust);
    Mustache.parse(itemTemplate);

    list = list.slice();
    list[0].isBreakAbovePractice = true;
    for (var i = 0; i < list.length; i++) {
      list[i].hasSubItems = true;
    }
    list.unshift({
      "link": "welcome",
      "faIcon": "fa-home",
      "name": "Agreed actions",
      "isBreakAboveHome": true,
      "text": {
        "main": {
          "tooltip": "Agreed tooltip - edit in script.js"
        }
      }
    });
    list.push({
      "link": "patients",
      "faIcon": "fa-users",
      "name": "All Patients",
      "isBreakAbovePatient": true,
      "text": {
        "main": {
          "tooltip": "All patients tooltip - edit in script.js"
        }
      }
    });

    list.map(function(v, i, arr) {
      v.isSelected = i === idx + 1;
      return v;
    });

    var renderedBefore = Mustache.render(tempMust, {
      "items": list
    }, {
      "item": itemTemplate,
      "subItem": $('#pathway-picker-sub-item').html()
    });
    $('#aside-toggle nav:first').html(renderedBefore);

    $('.user').on('click', function() {
      template.loadContent('#agreedactions');
    });

    layout.elements.navigation = true;
  },

  showPage: function(page) {
    if (layout.page === page) return;
    layout.page = page;
    $('.page').hide();
    $('#' + page).show();

    if (page !== 'main-dashboard') {
      ////layout.hideSidePanel();
      $('#bottomnavbar').show();
      layout.hideHeaderBarItems();
    }
  },

  showSidePanel: function() {
    if (layout.elements.navigtion) return;
    layout.elements.navigtion = true;
    $('#main').addClass('content');
    $('#topnavbar').addClass('full');
    $('#aside-toggle').show();
    $('#bottomnavbar').hide();
  },

  hideSidePanel: function() {
    if (layout.elements.navigtion === false) return;
    layout.elements.navigtion = false;
    $('#main').removeClass('content');
    $('#topnavbar').removeClass('full');
    $('#aside-toggle').hide();
    $('#bottomnavbar').show();
  },

  showHeaderBarItems: function() {
    if (layout.elements.headerbar) return;
    layout.elements.headerbar = true;
    $('.hide-if-logged-out').show();
  },

  hideHeaderBarItems: function() {
    if (layout.elements.headerbar === false) return;
    layout.elements.headerbar = false;
    $('.hide-if-logged-out').hide();
  }

};

module.exports = layout;

},{"./data.js":9,"mustache":4}],11:[function(require,module,exports){
var notify = require('./notify.js');

var log = {
  reason: {},

  getObj: function(options) {
    var obj = JSON.parse(localStorage.bb);

    if (options && options.length > 0) {
      options.forEach(function(opt) {
        if (!obj[opt.name]) {
          obj[opt.name] = opt.value;
          log.setObj(obj);
        }
      });
    }

    return obj;
  },

  setObj: function(obj) {
    localStorage.bb = JSON.stringify(obj);
  },

  loadActions: function(callback) {
    var r = Math.random();
    $.getJSON("action-plan.json?v=" + r, function(file) {
      log.plan = file.diseases;
      log.text = file.plans;
      callback();
    });
  },

  editAction: function(id, actionId, agree, done, reason) {
    var logText, obj = log.getObj([{
      name: "actions",
      value: {}
    }]);
    if (!id) alert("ACTION TEAM/IND ID");
    if (!actionId) alert("ACTION ID");

    if (!obj.actions[id]) {
      obj.actions[id] = {};
    }


    if (agree) {
      logText = "You agreed with this suggested action on " + (new Date()).toDateString();
    } else if (agree === false) {
      var reasonText = log.reason.reason === "" && log.reason.reasonText === "" ? " - no reason given" : " . You disagreed because you said: '" + log.reason.reason + "; " + log.reason.reasonText + ".'";
      logText = "You disagreed with this action on " + (new Date()).toDateString() + reasonText;
    }

    if (done) {
      logText = "You agreed with this suggested action on " + (new Date()).toDateString();
    }

    if (!obj.actions[id][actionId]) {
      obj.actions[id][actionId] = {
        "agree": agree ? agree : false,
        "done": done ? done : false,
        "history": [logText]
      };
    } else {
      if (agree === true || agree === false) obj.actions[id][actionId].agree = agree;
      if (done === true || done === false) obj.actions[id][actionId].done = done;
      if (logText) {
        if (obj.actions[id][actionId].history) obj.actions[id][actionId].history.unshift(logText);
        else obj.actions[id][actionId].done.history = [logText];
      }
    }

    if (reason && obj.actions[id][actionId].agree === false) {
      obj.actions[id][actionId].reason = reason;
    } else {
      delete obj.actions[id][actionId].reason;
    }

    log.setObj(obj);
    notify.showSaved();
  },

  ignoreAction: function(id, actionId) {
    var obj = log.getObj([{
      name: "actions",
      value: {}
    }]);
    obj.actions[id][actionId].agree = null;
    delete obj.actions[id][actionId].reason;
    log.setObj(obj);
  },

  getActions: function() {
    return log.getObj([{
      name: "actions",
      value: {}
    }]).actions;
  },

  listActions: function(id, pathwayId) {
    var obj = log.getObj([{
      name: "actions",
      value: {}
    }]);
    arr = [];
    if (!id) return obj.actions;
    if (!obj.actions[id]) return arr;
    for (var prop in obj.actions[id]) {
      obj.actions[id][prop].id = prop;
      if (!obj.actions[id][prop].text)
        arr.push(obj.actions[id][prop]);
    }
    return arr;
  },

  //id is either "team" or the patientId
  recordFeedback: function(pathwayId, id, suggestion, reason, reasonText) {
    log.reason = {
      "reason": reason,
      "reasonText": reasonText
    };
    var obj = log.getObj([{
      name: "feedback",
      value: []
    }]);

    var item = {
      "pathwayId": pathwayId,
      "id": id,
      "val": suggestion
    };
    if (reasonText !== "") item.reasonText = reasonText;
    if (reason !== "") item.reason = reason;
    obj.feedback.push(item);
    log.setObj(obj);
  },

  getEvents: function() {
    return log.getObj([{
      name: "events",
      value: []
    }]).events;
  },

  recordEvent: function(pathwayId, id, name) {
    var obj = log.getObj([{
      name: "events",
      value: []
    }]);
    obj.events.push({
      "pathwayId": pathwayId,
      "id": id,
      "name": name,
      "date": new Date()
    });
    log.setObj(obj);
  },

  recordPlan: function(id, text, pathwayId) {
    if (!id) alert("PLAN");
    var obj = log.getObj([{
      name: "actions",
      value: {}
    }]);

    if (!obj.actions[id]) obj.actions[id] = {};
    var planId = Date.now() + "";
    obj.actions[id][planId] = {
      "text": text,
      "agree": null,
      "done": false,
      "pathwayId": pathwayId,
      "history": ["You added this on " + (new Date()).toDateString()]
    };

    log.setObj(obj);
    return planId;
  },

  findPlan: function(obj, planId) {
    for (var k in obj.actions) {
      if (obj.actions[k][planId] && obj.actions[k][planId].text) return k;
    }
    return -1;
  },

  editPlan: function(planId, text, done) {
    var obj = log.getObj([{
      name: "actions",
      value: {}
    }]);
    var id = log.findPlan(obj, planId);
    if (text) obj.actions[id][planId].text = text;
    if (done === true || done === false) obj.actions[id][planId].done = done;
    log.setObj(obj);
  },

  deletePlan: function(planId) {
    var obj = log.getObj([{
      name: "actions",
      value: {}
    }]);
    var id = log.findPlan(obj, planId);
    delete obj.actions[id][planId];
    log.setObj(obj);
  },

  listPlans: function(id, pathwayId) {
    var obj = log.getObj([{
        name: "actions",
        value: {}
      }]),
      arr = [];
    if (!id) return obj.actions;
    for (var prop in obj.actions[id]) {
      obj.actions[id][prop].id = prop;
      if ((!pathwayId || pathwayId === obj.actions[id][prop].pathwayId) && obj.actions[id][prop].text) arr.push(obj.actions[id][prop]);
    }
    return arr;
  },

  getReason: function(id, actionId) {
    var obj = log.getObj([{
      name: "actions",
      value: {}
    }]);

    if (obj.actions[id] && obj.actions[id][actionId]) return obj.actions[id][actionId].reason;
    return null;
  },

  getAgreeReason: function(pathwayId, pathwayStage, standard, patientId, item) {
    var obj = log.getObj([{
      name: "agrees",
      value: {}
    }]);
    if (!pathwayId || !pathwayStage) alert("EDITPATIENTAGREE");

    if (!obj.agrees[patientId]) obj.agrees[patientId] = [];
    var items = obj.agrees[patientId].filter(function(val) {
      return val.pathwayId === pathwayId && val.pathwayStage === pathwayStage && val.standard === standard && val.item === item;
    });

    return items.length === 1 ? items[0].reason || {} : {};
  },

  editPatientAgree: function(pathwayId, pathwayStage, standard, patientId, item, agree, reason) {
    var obj = log.getObj();
    if (!pathwayId || !pathwayStage) alert("EDITPATIENTAGREE");

    if (!obj.agrees[patientId]) obj.agrees[patientId] = [];
    var items = obj.agrees[patientId].filter(function(val) {
      return val.pathwayId === pathwayId && val.pathwayStage === pathwayStage && val.standard === standard && val.item === item;
    });

    var logText = "You " + (agree ? "" : "dis") + "agreed with this on " + (new Date()).toDateString();

    if (items.length === 1) {
      items[0].agree = agree;
      items[0].history.push(logText);
      items[0].reason = reason;
    } else if (items.length === 0) {
      obj.agrees[patientId].push({
        "pathwayId": pathwayId,
        "pathwayStage": pathwayStage,
        "standard": standard,
        "item": item,
        "agree": agree,
        "reason": reason,
        "history": [logText]
      });
    } else {
      console.log("ERRORRR!!!!!!!");
    }

    log.setObj(obj);
    notify.showSaved();
  },

  getAgrees: function(){
    return log.getObj([{
      name: "agrees",
      value: {}
    }]).agrees;
  },

  getPatientAgreeObject: function(pathwayId, pathwayStage, standard, patientId, item) {
    var obj = log.getObj([{
      name: "agrees",
      value: {}
    }]);
    if (!pathwayId || !pathwayStage) alert("EDITPATIENTAGREE");

    if (!obj.agrees[patientId]) obj.agrees[patientId] = [];
    var items = obj.agrees[patientId].filter(function(val) {
      return val.pathwayId === pathwayId && val.pathwayStage === pathwayStage && val.standard === standard && val.item === item;
    });
    if (items.length === 1) return items[0];
    return {};
  },

  getPatientAgree: function(pathwayId, pathwayStage, standard, patientId, item) {
    var obj = log.getObj([{
      name: "agrees",
      value: {}
    }]);

    if (!obj.agrees[patientId]) return null;
    var item2 = obj.agrees[patientId].filter(function(val) {
      return val.pathwayId === pathwayId && val.pathwayStage === pathwayStage && val.standard === standard && val.item === item;
    });

    if (item.length === 1) {
      return item[0].agree;
    }
    return null;
  }

};

module.exports = log;

},{"./notify.js":14}],12:[function(require,module,exports){
module.exports = {
  "currentUrl": "",
  "options": [],
  "categories": {
    "diagnosis": {
      "name": "diagnosis",
      "display": "Diagnosis"
    },
    "monitoring": {
      "name": "monitoring",
      "display": "Monitoring"
    },
    "treatment": {
      "name": "treatment",
      "display": "Control"
    },
    "exclusions": {
      "name": "exclusions",
      "display": "Exclusions"
    }
  },
  "charts": {},
  "pathwayId": "htn",
  "colors": ['#1f77b4', '#ff7f0e', '#2ca02c', '#d62728', '#9467bd', '#8c564b', '#e377c2', '#7f7f7f', '#bcbd22', '#17becf'],
  "monitored": {
    "bp": "Blood Pressure",
    "asthma": "Peak Expiratory Flow"
  }
};

},{}],13:[function(require,module,exports){
var template = require('./template.js'),
  data = require('./data.js'),
  base = require('./base.js'),
  layout = require('./layout.js'),
  welcome = require('./panels/welcome.js'),
  log = require('./log.js'),
  patientView = require('./views/patient.js'),
  Mustache = require('mustache');

var states, patLookup, page, hash;

console.log("main.js: data.lastloader= " + data.lastloader);
data.lastloader = "main.js";

var main = {
  "version": "2.0.0",

  hash: hash,
  init: function() {
    main.preWireUpPages();

    log.loadActions(function() {
      data.get(main.wireUpPages);
    });
  },

  onSelected: function($e, nhsNumberObject) {
    //Hide the suggestions panel
    $('#search-box').find('.tt-dropdown-menu').css('display', 'none');

    history.pushState(null, null, '#patients/' + nhsNumberObject.id);
    template.loadContent('#patients/' + nhsNumberObject.id, true);


    //template.displaySelectedPatient(nhsNumberObject.id);
  },

  wireUpSearchBox: function() {
    if (states) {
      states.clearPrefetchCache();
    }

    states = new Bloodhound({
      datumTokenizer: Bloodhound.tokenizers.obj.whitespace('value'),
      queryTokenizer: Bloodhound.tokenizers.whitespace,
      local: $.map(data.patientArray, function(state) {
        return {
          id: state,
          value: data.patLookup && data.patLookup[state] ? data.patLookup[state] : state
        };
      })
    });

    states.initialize(true);

    $('#search-box').find('.typeahead').typeahead('destroy');
    $('#search-box').find('.typeahead').typeahead({
        hint: true,
        highlight: true,
        minLength: 1,
        autoselect: true
      }, {
        name: 'patients',
        displayKey: 'value',
        source: states.ttAdapter(),
        templates: {
          empty: [
              '<div class="empty-message">',
                '&nbsp; &nbsp; No matches',
              '</div>'
            ].join('\n')
        }
      }).on('typeahead:selected', main.onSelected)
      .on('typeahead:autocompleted', main.onSelected);

    $('#searchbtn').on('mousedown', function() {
      var val = $('.typeahead').eq(0).val();
      if (!val || val === "") val = $('.typeahead').eq(1).val();
      main.onSelected(null, {
        "id": val
      });
    });
  },

  wireUpPages: function() {
    base.wireUpTooltips();
    main.wireUpSearchBox();

    $('#data-file').on('change', function(evt) {
      $('#data-file-wrapper').addClass('disabled').text("Loading...");
      var file = evt.target.files[0]; // FileList object
      var reader = new FileReader();

      reader.onload = (function() {
        return function(e) {
          var JsonObj = JSON.parse(e.target.result);
          data.get(null, JsonObj);
          console.log(JsonObj);

          main.wireUpSearchBox();

          setTimeout(function() {
            if (!$('#patient-file-wrapper').is(':visible')) {
              $('#file-loader').hide(500);
            } else {
              $('#data-file-wrapper').hide(500);
            }
            template.loadContent('#overview');
          }, 1000);
        };
      })(file);

      reader.readAsText(file);
    });

    $('#patient-file').on('change', function(evt) {
      $('#patient-file-wrapper').addClass('disabled').text("Loading...");
      var file = evt.target.files[0]; // FileList object
      var reader = new FileReader();

      reader.onload = (function() {
        return function(e) {
          var lines = e.target.result.split("\n");
          data.patLookup = {};
          for (var i = 0; i < lines.length; i++) {
            var fields = lines[i].split("\t");
            if (fields.length !== 2) continue;
            data.patLookup[fields[0].trim()] = fields[1].trim();
          }

          main.wireUpSearchBox();

          setTimeout(function() {
            if (!$('#data-file-wrapper').is(':visible')) {
              $('#file-loader').hide(500);
            } else {
              $('#patient-file-wrapper').hide(500);
            }
            template.loadContent('#overview');
          }, 1000);
        };
      })(file);

      reader.readAsText(file);
    });

    $('#outstandingTasks').on('click', function(e) {
      e.preventDefault();

      $('#welcome-tabs li').removeClass('active');
      $(this).closest('li').addClass('active');
      var tempMust = $('#welcome-task-list').html();
      var rendered = Mustache.render(tempMust);
      $('#welcome-tab-content').fadeOut(100, function() {
        $(this).html(rendered);
        welcome.populate();
        $(this).fadeIn(100);
      });
    });

    $('#completedTasks').on('click', function(e) {
      e.preventDefault();

      $('#welcome-tabs li').removeClass('active');
      $(this).closest('li').addClass('active');
      var tempMust = $('#welcome-task-list').html();
      var rendered = Mustache.render(tempMust);
      $('#welcome-tab-content').fadeOut(100, function() {
        $(this).html(rendered);
        welcome.populate(true);
        $(this).fadeIn(100);
      });
    });

    if (main.hash !== location.hash) location.hash = main.hash;
    template.loadContent(location.hash, true);
  },

  preWireUpPages: function() {
      layout.showPage('login');

      //Every link element stores href in history
      $(document).on('click', 'a.history', function() {
        // keep the link in the browser history
        history.pushState(null, null, this.href);
        template.loadContent(location.hash, true);
        // do not give a default action
        return false;
      });

      //Called when the back button is hit
      $(window).on('popstate', function(e) {
        template.loadContent(location.hash, true);
      });

      //Templates
      patientsPanelTemplate = $('#patients-panel');
      actionPlanPanel = $('#action-plan-panel');
      patientList = $('#patient-list');
      suggestedPlanTemplate = $('#suggested-plan-template');
      individualPanel = $('#individual-panel');
      valueTrendPanel = $('#value-trend-panel');
      medicationPanel = $('#medications-panel');
      actionPlanList = $('#action-plan-list');

      //Selectors
      bottomLeftPanel = $('#bottom-left-panel');
      bottomRightPanel = $('#bottom-right-panel');
      topPanel = $('#top-panel');
      topLeftPanel = $('#top-left-panel');
      topRightPanel = $('#top-right-panel');
      midPanel = $('#mid-panel');
      farLeftPanel = $('#left-panel');
      farRightPanel = $('#right-panel');
    }
    /*,
      "_local": local*/
};

module.exports = main;

},{"./base.js":7,"./data.js":9,"./layout.js":10,"./log.js":11,"./panels/welcome.js":34,"./template.js":36,"./views/patient.js":40,"mustache":4}],14:[function(require,module,exports){
module.exports = {

  showSaved: function() {
    $("#saved-message").hide().toggleClass("in").fadeIn(300);
    window.setTimeout(function() {
      $("#saved-message").fadeOut(300, function() {
        $(this).toggleClass("in");
      });
    }, 2000);
  }

};

},{}],15:[function(require,module,exports){
var base = require('../base.js'),
  data = require('../data.js'),
  qualityStandard = require('./qualityStandard.js'),
  otherCodes = require('./otherCodes.js'),
  medication = require('./medication.js'),
  trend = require('./trend.js'),
  individualActionPlan = require('./individualActionPlan.js'),
  layout = require('../layout.js'),
  chart = require('../chart.js'),
  Mustache = require('mustache');

var all = {

  populate: function() {
    var patients = data.getAllPatients();

    var localData = {
      "patients": patients,
      "n": patients.length,
      "header-items": [{
        "title": "NHS no.",
        "isUnSortable": true
      }, {
        "title": "All Opportunities",
        "titleHTML": '# of <i class="fa fa-flag" style="color:red"></i>',
        "isUnSortable": true,
        "tooltip": "Total number of improvement opportunities available across all conditions"
      }]
    };

    localData.patients.sort(function(a, b) {
      if (a.items[0] === b.items[0]) {
        return 0;
      }
      var A = Number(a.items[0]);
      var B = Number(b.items[0]);
      if (isNaN(A) || isNaN(B)) {
        A = a.items[0];
        B = b.items[0];
      }
      if (A > B) {
        return -1;
      } else if (A < B) {
        return 1;
      }
    });

    base.createPanelShow(patientList, patientsPanel, localData, {
      "header-item": $("#patient-list-header-item").html(),
      "item": $('#patient-list-item').html()
    });

    $('#patients-placeholder').hide();

    base.setupClipboard($('.btn-copy'), true);

    base.wireUpTooltips();

    var c = patientsPanel.find('div.table-scroll').getNiceScroll();
    if (c && c.length > 0) {
      c.resize();
    } else {
      patientsPanel.find('div.table-scroll').niceScroll({
        cursoropacitymin: 0.3,
        cursorwidth: "7px",
        horizrailenabled: false
      });
    }
  },

  //Show patient view from the all patient screen
  showIndividualPatientView: function(pathwayId, pathwayStage, standard, patientId) {
    data.patientId = patientId;

    data.options.sort(function(a, b) {
      a = data.getPatientStatus(patientId, a.pathwayId, a.pathwayStage, a.standard);
      b = data.getPatientStatus(patientId, b.pathwayId, b.pathwayStage, b.standard);

      if (a === b) return 0;
      if (a === "not") return 1;
      if (b === "not") return -1;
      if (a === "ok") return 1;
      if (b === "ok") return -1;
      alert("!!!!!!!");
    });

    if (pathwayId === null) {
      //Show patient but don't select
      var p = base.createPanel($('#patient-panel'), {
        "options": data.options,
        "numberOfStandardsMissed": data.numberOfStandardsMissed(patientId),
        "nhsNumber": data.patLookup ? data.patLookup[patientId] : patientId,
        "patientId": patientId
      }, {
        "option": $('#patient-panel-drop-down-options').html()
      });
      farRightPanel.html(p).show();
      farRightPanel.removeClass('standard-missed-page').removeClass('standard-achieved-page').removeClass('standard-not-relevant-page');

      $('select').select2({
        templateResult: base.formatStandard,
        minimumResultsForSearch: Infinity,
        placeholder: "Please select an improvement opportunity area..."
      });
      $('span.select2-selection__rendered').attr("title", "");
      $('select').on('change', function() {
        var localData = $(this).find(':selected').data();
        all.showIndividualPatientView(localData.pathwayId, localData.pathwayStage, localData.standard, data.patientId);
      }).on("select2:open", function(e) {
        base.wireUpTooltips();
      });
      return;
    }

    var panel = base.createPanel($('#patient-panel'), {
      "options": data.options,
      "numberOfStandardsMissed": data.numberOfStandardsMissed(patientId),
      "standard": data[pathwayId][pathwayStage].standards[standard].tab.title,
      "pathwayStage": pathwayStage,
      "nhsNumber": data.patLookup ? data.patLookup[patientId] : patientId,
      "patientId": patientId
    }, {
      "option": $('#patient-panel-drop-down-options').html()
    });

    farRightPanel.html("");
    $('#temp-hidden').html(panel);

    var actionPlan = individualActionPlan.create(pathwayStage);
    $('#temp-hidden #patient-panel-right').html(actionPlan);

    var qualPanel = qualityStandard.create(pathwayId, pathwayStage, standard, patientId);
    var trendPanel = trend.create(pathwayId, pathwayStage, standard, patientId);
    var medPanel = medication.create(pathwayId, pathwayStage, standard, patientId);
    var codesPanel = otherCodes.create(pathwayId, pathwayStage, standard, patientId);
    var medCodeWrapperPanel = base.createPanel($('#other-codes-and-meds-wrapper-panel'));
    $('#temp-hidden #patient-panel-top').html(qualPanel);
    $('#temp-hidden #patient-panel-left').html("").append(trendPanel).append(medCodeWrapperPanel);
    $('#temp-hidden #medCodeWrapperPanel').append(medPanel).append(codesPanel);

    if (farRightPanel.is(':visible')) {
      farRightPanel.fadeOut(100, function() {
        $(this).html($('#temp-hidden').html());
        $('#temp-hidden').html("");
        individualActionPlan.wireUp(pathwayId, pathwayStage, standard, patientId);
        qualityStandard.wireUp(pathwayId, pathwayStage, standard, patientId);
        base.wireUpStandardDropDown(pathwayId, pathwayStage, standard, all.showIndividualPatientView);
        trend.wireUp(pathwayId, pathwayStage, standard, patientId);
        medication.wireUp(pathwayId, pathwayStage, standard, patientId);
        otherCodes.wireUp(pathwayId, pathwayStage, standard, patientId);
        chart.drawTrendChart(patientId, pathwayId, pathwayStage, standard);
        $(this).fadeIn(100, function() {});
      });
    } else {
      farRightPanel.html($('#temp-hidden').html());
      $('#temp-hidden').html("");
      individualActionPlan.wireUp(pathwayId, pathwayStage, standard, patientId);
      qualityStandard.wireUp(pathwayId, pathwayStage, standard, patientId);
      base.wireUpStandardDropDown(pathwayId, pathwayStage, standard, all.showIndividualPatientView);
      trend.wireUp(pathwayId, pathwayStage, standard, patientId);
      medication.wireUp(pathwayId, pathwayStage, standard, patientId);
      otherCodes.wireUp(pathwayId, pathwayStage, standard, patientId);
      chart.drawTrendChart(patientId, pathwayId, pathwayStage, standard);
      farRightPanel.fadeIn(100, function() {});
    }
  },

  show: function(location) {
    base.createPanelShow($('#all-patients-panel'), location, {
      "n": data.getAllPatients().length
    });

    patientsPanel = $('#patients');

    patientsPanel.on('click', 'tbody tr', function(e) { //Select individual patient when row clicked
      $('[data-toggle="tooltip"]').tooltip('hide');
      $(this).tooltip('destroy');
      base.clearBox();
      $('.list-item').removeClass('highlighted');
      $(this).addClass('highlighted').removeAttr('title');

      var patientId = $(this).find('td button').attr('data-patient-id');

      all.showIndividualPatientView(null, null, null, patientId);

      e.preventDefault();
      e.stopPropagation();
    }).on('click', 'tbody tr button', function(e) {
      //don't want row selected if just button pressed?
      e.preventDefault();
      e.stopPropagation();
    });
  },

  showView: function(patientId, reload) {
    $('#mainTitle').hide();
    base.updateTitle("List of all patients at your practice");

    if (!patientId) data.pathwayId = "";
    if (!patientId || reload) {

      layout.showMainView(data.diseases.length);

      base.switchTo110Layout();
      base.hideAllPanels();

      all.show(farLeftPanel);
      all.populate();
    }

    if (patientId) {
      all.showIndividualPatientView(null, null, null, patientId);
    } else {
      var tempMust = $('#patient-panel-placeholder').html();
      farRightPanel.html(Mustache.render(tempMust)).show();
    }
  }

};

module.exports = all;

},{"../base.js":7,"../chart.js":8,"../data.js":9,"../layout.js":10,"./individualActionPlan.js":22,"./medication.js":24,"./otherCodes.js":25,"./qualityStandard.js":30,"./trend.js":33,"mustache":4}],16:[function(require,module,exports){
var base = require('../base.js'),
log = require('../log.js');

var confirm = {

  wireUp: function(agreeDivSelector, panelSelector, pathwayId, pathwayStage, standard, patientId, item, disagreeText) {
    confirm.wireUpAgreeDisagree(agreeDivSelector, log.getPatientAgreeObject(pathwayId, pathwayStage, standard, patientId, item));

    panelSelector.on('change', '.btn-toggle input[type=checkbox]', function() {
      confirm.wireUpAgreeDisagree(agreeDivSelector, log.getPatientAgreeObject(pathwayId, pathwayStage, standard, patientId, item));
      base.wireUpTooltips();
    }).on('click', '.btn-toggle', function(e) {
      var checkbox = $(this).find("input[type=checkbox]");
      var other = $(this).parent().find($(this).hasClass("btn-yes") ? ".btn-no" : ".btn-yes");
      var ACTIONID = $(this).closest('tr').data('id');
      if ($(this).hasClass("active") && other.hasClass("inactive")) {
        //unselecting
        if (checkbox.val() === "no") {
          confirm.launchStandardModal("Disagree with " + disagreeText, "?", log.getAgreeReason(pathwayId, pathwayStage, standard, patientId, item), true, function() {
            log.editPatientAgree(pathwayId, pathwayStage, standard, patientId, item, false, log.reason.reasonText);
            confirm.wireUpAgreeDisagree(agreeDivSelector, log.getPatientAgreeObject(pathwayId, pathwayStage, standard, patientId, item));
            base.wireUpTooltips();
          }, null, function() {
            log.editPatientAgree(pathwayId, pathwayStage, standard, patientId, item, null, "");
            other.removeClass("inactive");
            checkbox.removeAttr("checked");
            checkbox.parent().removeClass("active");
            confirm.wireUpAgreeDisagree(agreeDivSelector, log.getPatientAgreeObject(pathwayId, pathwayStage, standard, patientId, item));
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.editPatientAgree(pathwayId, pathwayStage, standard, patientId, item, null);
          other.removeClass("inactive");
        }
      } else if (!$(this).hasClass("active") && other.hasClass("active")) {
        //prevent clicking on unselected option or if the row is complete
        e.stopPropagation();
        e.preventDefault();
        return;
      } else {
        //selecting
        var self = this;
        if (checkbox.val() === "no") {
          confirm.launchStandardModal("Disagree with " + disagreeText, "", "", false, function() {
            log.editPatientAgree(pathwayId, pathwayStage, standard, patientId, item, false, log.reason.reasonText);
            $(self).removeClass("inactive");
            checkbox.attr("checked", "checked");
            checkbox.parent().addClass("active");
            //unselect other
            other.removeClass("active").addClass("inactive");
            other.find("input[type=checkbox]").prop("checked", false);
            confirm.wireUpAgreeDisagree(agreeDivSelector, log.getPatientAgreeObject(pathwayId, pathwayStage, standard, patientId, item));
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.editPatientAgree(pathwayId, pathwayStage, standard, patientId, item, true);
          $(this).removeClass("inactive");

          //unselect other
          other.removeClass("active").addClass("inactive");
          other.find("input[type=checkbox]").prop("checked", false);
        }
      }
    });
  },

  wireUpAgreeDisagree: function(selector, agreeObject) {
    if (agreeObject.agree === true) {
      selector.children(':nth(0)').addClass('active');
      selector.children(':nth(1)').addClass('inactive');
      selector.children(':nth(0)').attr("title", confirm.getAgreeTooltip(agreeObject)).attr("data-original-title", confirm.getAgreeTooltip(agreeObject)).tooltip('fixTitle').tooltip('hide');
      selector.children(':nth(1)').attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
      selector.parent().addClass('success').removeClass('danger');
    } else if (agreeObject.agree === false) {
      selector.children(':nth(0)').addClass('inactive');
      selector.children(':nth(1)').addClass('active');
      selector.children(':nth(0)').attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
      selector.children(':nth(1)').attr("title", confirm.getDisgreeTooltip(agreeObject)).attr("data-original-title", confirm.getDisgreeTooltip(agreeObject)).tooltip('fixTitle').tooltip('hide');
      selector.parent().addClass('danger').removeClass('success');
    } else {
      selector.children(':nth(0)').attr("title", "Click to agree").attr("data-original-title", "Click to agree").tooltip('fixTitle').tooltip('hide');
      selector.children(':nth(1)').attr("title", "Click to disagree").attr("data-original-title", "Click to disagree").tooltip('fixTitle').tooltip('hide');
      selector.parent().removeClass('success').removeClass('danger');
    }
  },

  getAgreeTooltip: function(agreeObject) {
    return agreeObject.history[agreeObject.history.length - 1];
  },

  getDisgreeTooltip: function(agreeObject) {
    return agreeObject.history[agreeObject.history.length - 1] + " You said: " + agreeObject.reason;
  },

  launchStandardModal: function(header, value, reason, isUndo, callbackOnSave, callbackOnCancel, callbackOnUndo) {
    base.launchModal({
      "header": header,
      "isUndo": isUndo,
      "item": value,
      "placeholder": "Provide more information here..."
    }, null, value, reason, callbackOnSave, callbackOnCancel, callbackOnUndo);
  }

};

module.exports = confirm;

},{"../base.js":7,"../log.js":11}],17:[function(require,module,exports){
var base = require('../base.js'),
  data = require('../data.js'),
  chart = require('../chart.js'),
  patientList = require('./patientList.js');

var ID = "INDICATOR_BENCHMARK";

var iTrend = {

  show: function(panel, isAppend, pathwayId, pathwayStage, standard) {

    var elem = $("<div id='benchmark-chart' class='fit-to-scrolling-section-height'></div>");

    if (isAppend) panel.append(elem);
    else panel.html(elem);

    chart.drawBenchmarkChartHC("benchmark-chart", null);

  },

  wireUp: function() {

  }

};

module.exports = iTrend;

},{"../base.js":7,"../chart.js":8,"../data.js":9,"./patientList.js":27}],18:[function(require,module,exports){
var data = require('../data.js'),
  chart = require('../chart.js');

var bd = {

  wireUp: function() {

  },

  show: function(panel, isAppend, pathwayId, pathwayStage, standard, selectSeriesFn) {

    var indicators = data.getIndicatorDataSync([pathwayId, pathwayStage, standard].join("."));

    var dataObj = indicators.opportunities.map(function(opp) {
      return [opp.name, opp.patients.length];
    });

    var elem = $("<div id='breakdown-chart'></div>");

    if (isAppend) panel.append(elem);
    else panel.html(elem);

    chart.drawAnalytics("breakdown-chart", dataObj, selectSeriesFn);

    bd.wireUp();

  }

};

module.exports = bd;

},{"../chart.js":8,"../data.js":9}],19:[function(require,module,exports){
var data = require('../data.js'),
  chart = require('../chart.js'),
  Mustache = require('mustache');

var hl = {

  wireUp: function() {

  },

  show: function(panel, isAppend, pathwayId, pathwayStage, standard) {

    var indicators = data.getIndicatorDataSync([pathwayId, pathwayStage, standard].join("."));

    var tempMust = $('#indicator-headline-panel').html();
    var html = Mustache.render(tempMust, indicators);

    if(isAppend) panel.append(html);
    else panel.html(html);

  }

};

module.exports = hl;

},{"../chart.js":8,"../data.js":9,"mustache":4}],20:[function(require,module,exports){
var base = require('../base.js'),
  log = require('../log.js'),
  data = require('../data.js'),
  sparkline = require('jquery-sparkline'),
  Mustache = require('mustache');

var indicatorList = {

  show: function(panel, isAppend, loadContentFn) {
    data.getAllIndicatorData(function(indicators) {

      var tempMust = $('#overview-panel-table').html();
      var html = Mustache.render(tempMust, {
        "indicators": indicators
      });
      if (isAppend) {
        panel.append(html);
      } else {
        panel.html(html);
      }

      $('.inlinesparkline').sparkline('html', {
        tooltipFormatter: function(sparkline, options, fields) {
          var dts = indicators[$('.inlinesparkline').index(sparkline.el)].dates;
          return dts[dts.length - 1 - fields.x] + ": " + fields.y + "%";
        },
        width: "100px"
      });

      indicatorList.wireUp(panel, loadContentFn);

    });
  },

  populate: function() {

  },

  wireUp: function(panel, loadContentFn) {
    panel.off('click', 'tr.standard-row,tr.show-more-row');
    panel.on('click', 'tr.standard-row,tr.show-more-row', function(e) {
      var url = $(this).data("id").replace(/\./g, "/");
      history.pushState(null, null, '#indicators/' + url);
      loadContentFn('#indicators/' + url);
      // do not give a default action
      e.preventDefault();
      e.stopPropagation();
      return false;
    });

    panel.off('mouseenter', '.show-more-row,.standard-row');
    panel.off('mouseleave', '.show-more-row,.standard-row');
    panel.on('mouseenter', '.show-more-row,.standard-row', function(e){
      var id = $(this).data("id");
      $('.show-more-row[data-id="' + id + '"],.standard-row[data-id="' + id + '"]').addClass('hover');
    });
    panel.on('mouseleave', '.show-more-row,.standard-row', function(e){
      var id = $(this).data("id");
      $('.show-more-row[data-id="' + id + '"],.standard-row[data-id="' + id + '"]').removeClass('hover');
    });

    panel.off('click', '.show-more');
    panel.on('click', '.show-more', function(e) {
      var id = $(this).data("id");
      var elem = $('.show-more-row[data-id="' + id + '"]');
      if(elem.is(':visible')){
        $('.show-more[data-id="' + id + '"]:first').show();
        elem.hide();
      } else {
        $(this).hide();
        elem.show('fast');
      }
      // do not give a default action
      e.preventDefault();
      e.stopPropagation();
      return false;
    });
  }

};

module.exports = indicatorList;

},{"../base.js":7,"../data.js":9,"../log.js":11,"jquery-sparkline":3,"mustache":4}],21:[function(require,module,exports){
var base = require('../base.js'),
  data = require('../data.js'),
  chart = require('../chart.js'),
  patientList = require('./patientList.js');

var ID = "INDICATOR_TREND";

var iTrend = {

  show: function(panel, isAppend, pathwayId, pathwayStage, standard) {

    var indicators = data.getAllIndicatorDataSync();

    var elem = $("<div id='trend-chart' class='fit-to-scrolling-section-height'></div>");

    if (isAppend) panel.append(elem);
    else panel.html(elem);

    chart.drawPerformanceTrendChartHC("trend-chart", indicators.filter(function(v){
      return v.id===[pathwayId, pathwayStage, standard].join(".");
    })[0]);

  },

  wireUp: function() {

  }

};

module.exports = iTrend;

},{"../base.js":7,"../chart.js":8,"../data.js":9,"./patientList.js":27}],22:[function(require,module,exports){
var base = require('../base.js'),
  confirm = require('./confirm.js'),
  data = require('../data.js'),
  log = require('../log.js');

var iap = {

  create: function(pathwayStage) {
    return base.createPanel($('#individual-action-plan-panel'), {
      "pathwayStage": pathwayStage || "default",
      "noHeader": true
    });
  },

  show: function(panel, pathwayId, pathwayStage, standard, patientId) {
    panel.html(iap.create(pathwayStage));
    iap.wireUp(pathwayId, pathwayStage, standard, patientId);

    panel.find('div.fit-to-screen-height').niceScroll({
      cursoropacitymin: 0.3,
      cursorwidth: "7px",
      horizrailenabled: false
    });
  },

  wireUp: function(pathwayId, pathwayStage, standard, patientId) {
    individualTab = $('#tab-plan-individual');

    $('#advice-list').on('click', '.cr-styled input[type=checkbox]', function() {
      var ACTIONID = $(this).closest('tr').data('id');
      log.editAction(data.patientId, ACTIONID, null, this.checked);

      if (this.checked) {
        log.recordEvent(pathwayId, data.patientId, "Item completed");
        var self = this;
        $(self).parent().attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
        setTimeout(function(e) {
          $(self).parent().fadeOut(300, function() {
            var parent = $(this).parent();
            $(this).replaceWith(base.createPanel($('#checkbox-template'), {
              "done": true
            }));
            base.wireUpTooltips();
            parent.find('button').on('click', function() {
              ACTIONID = $(this).closest('tr').data('id');
              log.editAction(data.patientId, ACTIONID, null, false);
              $(this).replaceWith(base.createPanel($('#checkbox-template'), {
                "done": false
              }));
              iap.updateIndividualSapRows();
            });
          });
        }, 1000);
      }

      iap.updateIndividualSapRows();
    });

    $('#personalPlanIndividual').on('click', 'input[type=checkbox]', function() {
      var PLANID = $(this).closest('tr').data("id");
      log.editPlan(PLANID, null, this.checked);

      if (this.checked) {
        $(this).parent().parent().parent().addClass('success');
        log.recordEvent(pathwayId, data.patientId, "Personal plan item");
        var self = this;
        $(self).parent().attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
        setTimeout(function(e) {
          $(self).parent().fadeOut(300, function() {
            var parent = $(this).parent();
            $(this).replaceWith(base.createPanel($('#checkbox-template'), {
              "done": true
            }));
            base.wireUpTooltips();
            parent.find('button').on('click', function() {
              PLANID = $(this).closest('tr').data('id');
              log.editPlan(data.patientId, PLANID, null, false);
              $(this).replaceWith(base.createPanel($('#checkbox-template'), {
                "done": false
              }));
              iap.updateIndividualSapRows();
            });
          });
        }, 1000);
      }
    }).on('click', '.btn-undo', function(e) {
      var PLANID = $(this).closest('tr').data('id');
      log.editPlan(PLANID, null, false);
      $(this).replaceWith(base.createPanel($('#checkbox-template'), {
        "done": false
      }));
      iap.updateIndividualSapRows();
      e.stopPropagation();
    });

    individualTab.on('click', '.edit-plan', function() {
      var PLANID = $(this).closest('tr').data("id");

      $('#editActionPlanItem').val($($(this).closest('tr').children('td')[0]).find('span').text());

      $('#editPlan').off('hidden.bs.modal').on('hidden.bs.modal', function() {
        iap.displayPersonalisedIndividualActionPlan(data.patientId, $('#personalPlanIndividual'));
      }).off('shown.bs.modal').on('shown.bs.modal', function() {
        $('#editActionPlanItem').focus();
      }).off('click', '.save-plan').on('click', '.save-plan', function() {

        log.editPlan(PLANID, $('#editActionPlanItem').val());

        $('#editPlan').modal('hide');
      }).off('keyup', '#editActionPlanItem').on('keyup', '#editActionPlanItem', function(e) {
        if (e.which === 13) $('#editPlan .save-plan').click();
      }).modal();
    }).on('click', '.delete-plan', function() {
      var PLANID = $(this).closest('tr').data("id");

      $('#individual-delete-item').html($($(this).closest('tr').children('td')[0]).find('span').text());

      $('#deletePlan').off('hidden.bs.modal').on('hidden.bs.modal', function() {
        iap.displayPersonalisedIndividualActionPlan(data.patientId, $('#personalPlanIndividual'));
      }).off('click', '.delete-plan').on('click', '.delete-plan', function() {
        log.deletePlan(PLANID);

        $('#deletePlan').modal('hide');
      }).modal();
    }).on('click', '.add-plan', function() {
      log.recordPlan(data.patientId, $(this).parent().parent().find('textarea').val(), pathwayId);

      iap.displayPersonalisedIndividualActionPlan(data.patientId, $('#personalPlanIndividual'));
    }).on('change', '.btn-toggle input[type=checkbox]', function() {
      iap.updateIndividualSapRows();
    }).on('click', '.btn-undo', function(e) {
      var ACTIONID = $(this).closest('tr').data('id');
      log.editAction(data.patientId, ACTIONID, null, false);
      $(this).replaceWith(base.createPanel($('#checkbox-template'), {
        "done": false
      }));
      iap.updateIndividualSapRows();
    }).on('click', '.btn-yes,.btn-no', function(e) {
      var checkbox = $(this).find("input[type=checkbox]");
      var other = $(this).parent().find($(this).hasClass("btn-yes") ? ".btn-no" : ".btn-yes");
      var ACTIONID = $(this).closest('tr').data('id');
      if ($(this).hasClass("active") && other.hasClass("inactive") && !$(this).closest('tr').hasClass('success')) {
        //unselecting
        if (checkbox.val() === "no") {
          iap.launchModal(data.selected, checkbox.closest('tr').children().first().children().first().text(), log.getReason(data.patientId, ACTIONID), true, function() {
            log.editAction(data.patientId, ACTIONID, false, null, log.reason);
            iap.updateIndividualSapRows();
            base.wireUpTooltips();
          }, null, function() {
            log.ignoreAction(data.patientId, ACTIONID);
            other.removeClass("inactive");
            checkbox.removeAttr("checked");
            checkbox.parent().removeClass("active");
            iap.updateIndividualSapRows();
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.ignoreAction(data.patientId, ACTIONID);
          other.removeClass("inactive");
        }
      } else if ((!$(this).hasClass("active") && other.hasClass("active")) || $(this).closest('tr').hasClass('success')) {
        //prevent clicking on unselected option or if the row is complete
        e.stopPropagation();
        e.preventDefault();
        return;
      } else {
        //selecting
        var self = this;
        if (checkbox.val() === "no") {
          iap.launchModal(data.selected, checkbox.closest('tr').children().first().children().first().text(), log.getReason(data.patientId, ACTIONID), false, function() {
            log.editAction(data.patientId, ACTIONID, false, null, log.reason);
            $(self).removeClass("inactive");

            checkbox.attr("checked", "checked");
            checkbox.parent().addClass("active");
            //unselect other
            other.removeClass("active").addClass("inactive");
            other.find("input[type=checkbox]").prop("checked", false);
            iap.updateIndividualSapRows();
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.editAction(data.patientId, ACTIONID, true);
          $(this).removeClass("inactive");

          //unselect other
          other.removeClass("active").addClass("inactive");
          other.find("input[type=checkbox]").prop("checked", false);
        }
      }
    }).on('keyup', 'input[type=text]', function(e) {
      if (e.which === 13) {
        individualTab.find('.add-plan').click();
      }
    });

    $('#advice-list').off('click', '.show-more');
    $('#advice-list').on('click', '.show-more', function(e) {
      var id = $(this).data("id");
      var elem = $('.show-more-row[data-id="' + id + '"]');
      if(elem.is(':visible')){
        $('.show-more[data-id="' + id + '"]:first').show();
        elem.hide();
      } else {
        $(this).hide();
        elem.show('fast');
      }
      // do not give a default action
      e.preventDefault();
      e.stopPropagation();
      return false;
    });

    iap.populateIndividualSuggestedActions(patientId, pathwayId, pathwayStage, standard);
  },

  updateIndividualSapRows: function() {
    /*$('#advice-list').add('#personalPlanIndividual').find('.suggestion').each(function() {
      $(this).find('td').last().children().hide();
    });*/

    /*$('#advice-list').add('#personalPlanIndividual').find('.cr-styled input[type=checkbox]').each(function() {
      if (this.checked) {
        $(this).parent().parent().parent().addClass('success');
      } else {
        $(this).parent().parent().parent().removeClass('success');
      }
    });*/

    /*$('#advice-list').add('#personalPlanIndividual').find('.btn-undo').each(function() {
      $(this).parent().parent().addClass('success');
    });*/

    //no class - user not yet agreed/disagreed - no background / muted text
    //active - user agrees - green background / normal text
    //success - user completed - green background / strikethrough text
    //danger - user disagrees - red background / strikethrough text

    $('#advice-list').add('#personalPlanIndividual').find('tr.suggestion').each(function() {
      var self = $(this);
      var id = self.data("id");
      var all = $('.show-more-row[data-id="' + id + '"],.suggestion[data-id="' + id + '"]');
      var any = false;
      self.find('.btn-toggle input[type=checkbox]:checked').each(function() {
        any = true;
        if (this.value === "yes") {
          all.removeClass('danger');
          all.addClass('active');
          //self.find('td').last().children().show();
          if (log.getActions()[data.patientId][self.data("id")].history) {
            var tool = $(this).closest('tr').hasClass('success') ? "" : "<p>" + log.getActions()[data.patientId][self.data("id")].history[0] + "</p><p>Click again to cancel</p>";
            $(this).parent().attr("title", tool).attr("data-original-title", tool).tooltip('fixTitle').tooltip('hide');
          } else {
            $(this).parent().attr("title", "You agreed - click again to cancel").tooltip('fixTitle').tooltip('hide');
          }
        } else {
          all.removeClass('active');
          all.addClass('danger');
          all.removeClass('success');
          if (log.getActions()[data.patientId][self.data("id")] && log.getActions()[data.patientId][self.data("id")].history) {
            $(this).parent().attr("title", "<p>" + log.getActions()[data.patientId][self.data("id")].history[0] + "</p><p>Click again to edit/cancel</p>").tooltip('fixTitle').tooltip('hide');
          } else {
            $(this).parent().attr("title", "You disagreed - click again to edit/cancel").tooltip('fixTitle').tooltip('hide');
          }
        }
      });
      if (self.find('.btn-toggle input[type=checkbox]:not(:checked)').length == 1) {
        self.find('.btn-toggle input[type=checkbox]:not(:checked)').parent().addClass("inactive").attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
      }
      if (!any) {
        all.removeClass('danger');
        all.removeClass('active');
        all.removeClass('success');

        self.find('.btn-toggle.btn-yes').attr("title", "Click to agree with this action and save it in your agreed actions list  ").tooltip('fixTitle').tooltip('hide');
        self.find('.btn-toggle.btn-no').attr("title", "Click to disagree with this action and remove it from your suggested actions list ").tooltip('fixTitle').tooltip('hide');
      }

      base.wireUpTooltips();
    });
    base.wireUpTooltips();
  },

  displayPersonalisedIndividualActionPlan: function(id, parentElem) {
    var plans = base.sortSuggestions(base.addDisagreePersonalTeam(log.listPlans(id)));

    base.createPanelShow(actionPlanList, parentElem, {
      "hasSuggestions": plans && plans.length > 0,
      "suggestions": plans
    }, {
      "action-plan": $('#action-plan').html(),
      "action-plan-item": $('#action-plan-item').html(),
      "chk": $('#checkbox-template').html()
    });

    iap.updateIndividualSapRows();
  },

  populateIndividualSuggestedActions: function(patientId, pathwayId, pathwayStage, standard) {
    var localData = {
      "nhsNumber": data.patLookup ? data.patLookup[patientId] : patientId,
      "patientId": patientId
    };

    var patientData = data.getPatientData(patientId);

    var breaches = data.patients[patientId].breach ? data.patients[patientId].breach.filter(function(v) {
      return v.pathwayId === pathwayId && v.pathwayStage === pathwayStage && v.standard === standard;
    }) : [];

    var fn = function(val) {
      return {
        "id": val,
        "subsection": subsection
      };
    };

    if (patientData.actions.length === 0) {
      localData.noSuggestions = true;
    } else {
      /*var suggestions = [],
        subsection = "";
      for (var i = 0; i < breaches.length; i++) {
        subsection = breaches[i].subsection;
        suggestions = suggestions.concat(data[pathwayId][pathwayStage].bdown[subsection].suggestions ?
          data[pathwayId][pathwayStage].bdown[subsection].suggestions.map(fn) : []);
      }*/

      localData.suggestions = base.sortSuggestions(base.mergeIndividualStuff(patientData.actions, patientId));
      /*localData.section = {
        "name": data[pathwayId][pathwayStage].bdown[subsection].name,
        "agree": log.getPatientAgree(pathwayId, pathwayStage, patientId, "section") === true,
        "disagree": log.getPatientAgree(pathwayId, pathwayStage, patientId, "section") === false,
      };
      localData.category = {
        "name": data.patients[patientId].category,
        "agree": log.getPatientAgree(pathwayId, pathwayStage, patientId, "category") === true,
        "disagree": log.getPatientAgree(pathwayId, pathwayStage, patientId, "category") === false,
      };*/
    }

    $('#advice-placeholder').hide();
    $('#advice').show();

    base.createPanelShow(individualPanel, $('#advice-list'), localData);

    //Wire up any clipboard stuff in the suggestions
    $('#advice-list').find('span:contains("[COPY")').each(function() {
      var html = $(this).html();
      $(this).html(html.replace(/\[COPY:([^\]]*)\]/g, '$1 <button type="button" data-clipboard-text="$1" data-content="Copied" data-toggle="tooltip" data-placement="top" title="Copy $1 to clipboard." class="btn btn-xs btn-default btn-copy"><span class="fa fa-clipboard"></span></button>'));
    });

    $('#advice-list').find('span:contains("[INFO")').each(function() {
      var html = $(this).html();
      var subsection = $(this).data().subsection;
      var desc = data[pathwayId][pathwayStage].standards[standard].opportunities.filter(function(val) {
          return val.name === subsection;
        }).length > 0 ?
        data[pathwayId][pathwayStage].standards[standard].opportunities.filter(function(val) {
          return val.name === subsection;
        })[0].desc : subsection;
      var tooltip = subsection ? "This action is suggested because PINGR classified this patient as:'" + desc + "'" : '';
      var newHtml = ' <i class="fa fa-info-circle fa-lg info-button clickable" data-toggle="tooltip" data-placement="right" title="' + tooltip + '"></i>';
      $(this).html(html.replace(/\[INFO\]/g, newHtml));
    });

    $('#advice-list').find('span:contains("[MED-SUGGESTION")').each(function() {
      var html = $(this).html();
      var suggestion = Math.random() < 0.33 ? "Increase Ramipril to 10mg per day" : (Math.random() < 0.5 ? "Consider adding an ACE inhibior" : "Consider adding a thiazide-like diuretic");
      $(this).html(html.replace(/\[MED\-SUGGESTION\]/g, suggestion));
    });


    base.setupClipboard($('.btn-copy'), true);

    iap.displayPersonalisedIndividualActionPlan(patientId, $('#personalPlanIndividual'));
  },

  launchModal: function(label, value, reason, isUndo, callbackOnSave, callbackOnCancel, callbackOnUndo) {
    var reasons = [{
      "reason": "Already done this",
      "value": "done"
    }, {
      "reason": "Wouldn't work",
      "value": "nowork"
    }, {
      "reason": "Something else",
      "value": "else"
    }];
    if (reason && reason.reason) {
      for (var i = 0; i < reasons.length; i++) {
        if (reasons[i].reason === reason.reason) {
          reasons[i].checked = true;
          break;
        }
      }
    }
    base.launchModal({
      "header": "Disagree with a suggested action",
      "isUndo": isUndo,
      "item": value,
      "placeholder": "Provide more information here...",
      "reasons": reasons
    }, label, value, reason ? reason.reasonText : null, callbackOnSave, callbackOnCancel, callbackOnUndo);
  }

};

module.exports = iap;

},{"../base.js":7,"../data.js":9,"../log.js":11,"./confirm.js":16}],23:[function(require,module,exports){
var Highcharts = require('highcharts/highstock'),
  base = require('../base.js');
require('highcharts/highcharts-more')(Highcharts);

var ID = "LIFELINE";

var colour = {
  index: 0,
  next: function() {
    if (this.index >= Highcharts.getOptions().colors.length) this.index = 0;
    return Highcharts.getOptions().colors[this.index++];
  },
  reset: function() {
    this.index = 0;
  }
};

var ll = {
  chartArray: [],

  destroy: function(elementId) {
    $(elementId).html('');
    $(elementId).off('mousemove touchmove touchstart', '.sync-chart');

    for (var i = 0; i < Highcharts.charts.length; i++) {
      if (Highcharts.charts[i] && Highcharts.charts[i].renderTo.className.indexOf("h-chart") > -1) Highcharts.charts[i].destroy();
    }
  },

  show: function(panel, isAppend, patientId, data) {

    var element = 'lifeline-chart';
    var elementId = '#' + element;

    ll.destroy(elementId);

    var htmlElement = $('<div class="panel panel-default"><div class="panel-body"><div id="' + element + '"></div></div></div>');

    if (isAppend) panel.append(htmlElement);
    else panel.html(htmlElement);

    colour.reset();
    /**
     * In order to synchronize tooltips and crosshairs, override the
     * built-in events with handlers defined on the parent element.
     */

    $(elementId).on('mousemove touchmove touchstart', '.sync-chart', function(e) {
      var chart, point, i, event, series;

      for (i = 1; i < ll.chartArray.length - 2; i = i + 1) {
        chart = ll.chartArray[i];
        event = chart.pointer.normalize(e.originalEvent); // Find coordinates within the chart
        //if (i === 0) console.log(event.chartX + " --- " + event.chartY);
        series = i === 0 ? Math.max(Math.min(Math.floor((130 - event.chartY) / 34), chart.series.length - 1), 0) : 0;
        point = chart.series[series].searchPoint(event, true); // Get the hovered point

        if (point) {
          point.onMouseOver(); // Show the hover marker
          chart.tooltip.refresh(point); // Show the tooltip
          chart.xAxis[0].drawCrosshair(event, point); // Show the crosshair
        }
      }
    });

    /**
     * Synchronize zooming through the setExtremes event handler.
     */
    function syncExtremes(e) {
      var thisChart = this.chart;

      if (e.trigger !== 'syncExtremes') { // Prevent feedback loop
        Highcharts.each(ll.chartArray, function(chart) {
          if (chart !== thisChart) {
            if (chart.inverted) {
              if (chart.yAxis[0].setExtremes) { // It is null while updating
                chart.yAxis[0].setExtremes(e.min, e.max, undefined, false, {
                  trigger: 'syncExtremes'
                });
              }
            } else {
              if (chart.xAxis[0].setExtremes) { // It is null while updating
                chart.xAxis[0].setExtremes(e.min, e.max, undefined, false, {
                  trigger: 'syncExtremes'
                });
              }
            }
          }
        });
      }
    }


    var plotConditions = function(conditions, importantCodes, contacts) {
      ll.charts = 1;
      var series = [];
      $.each(conditions.reverse(), function(i, task) {
        var item = {
          name: task.name,
          data: [],
          color: colour.next()
        };
        $.each(task.intervals, function(j, interval) {
          item.data.push([i + 0.49, interval.from, interval.to]);
        });

        series.push(item);
      });

      var markerTemplate = { "lineWidth": 1, "lineColor": "black", "radius": 8 };
      var markers = {
        "default": $.extend({ "symbol": "triangle" }, markerTemplate),
        "Face to face": $.extend({ "symbol": "square" }, markerTemplate),
        "Telephone": $.extend({ "symbol": "circle" }, markerTemplate),
        "Hospital admission": $.extend({ "symbol": "triangle" }, markerTemplate)
      };
      var contactSeries = {};
      var eventSeries = {};
      $.each(contacts, function(i, contact) {
        if (!contactSeries[contact.name]) {
          contactSeries[contact.name] = Highcharts.extend(contact, {
            data: [],
            type: 'scatter',
            marker: markers[contact.name] || markers.default,
            color: colour.next()
          });
        }
        contactSeries[contact.name].data.push([
              contact.task,
              contact.time
          ]);
      });

      $.each(importantCodes, function(i, event) {
        if (!eventSeries[event.name]) {
          eventSeries[event.name] = Highcharts.extend(event, {
            data: [],
            type: 'scatter',
            marker: markers[event.name] || markers.default,
            color: colour.next()
          });
        }
        eventSeries[event.name].data.push([
              event.task,
              event.time
          ]);
      });

      series = series.concat(Object.keys(contactSeries).map(function(key) {
        return contactSeries[key];
      }));

      series = series.concat(Object.keys(eventSeries).map(function(key) {
        return eventSeries[key];
      }));

      $(elementId).append($('<div class="chart-title">Patient conditions and contacts</div>'));
      // create the chart
      $('<div class="h-chart h-condition-chart">')
        .appendTo(elementId)
        .highcharts({

          chart: {
            renderTo: element,
            marginLeft: 120, // Keep all charts left aligned
            spacingTop: 20,
            spacingBottom: 20,
            type: 'columnrange',
            inverted: true,
            backgroundColor: '#F9F3F9',
            borderWidth: 2,
            borderColor: '#ddd'
          },

          title: '',

          yAxis: {
            type: 'datetime',
            min: Date.UTC(2005, 6, 12),
            max: new Date().getTime(),
            crosshair: true,
            events: {
              setExtremes: syncExtremes
            },
            labels: {
              enabled: false
            },

            //things that are normally xAxis defaults
            endOnTick: false,
            gridLineWidth: 0,
            lineWidth: 1,
            maxPadding: 0.01,
            minPadding: 0.01,
            startOnTick: false,
            tickWidth: 0,
            title: {
              text: ''
            },
            tickPixelInterval: 100
          },

          xAxis: {
            labels: {
              enabled: false
            },
            startOnTick: false,
            endOnTick: false,
            title: {
              text: ''
            },
            tickWidth: 0,
            minPadding: 0.2,
            maxPadding: 0.2,

            //things that are normally yAxis defaults
            gridLineWidth: 0,
            lineWidth: 0

          },
          credits: {
            enabled: false
          },

          legend: {
            enabled: false
          },

          tooltip: {
            formatter: function() {
              if (this.series.data[0].x !== 1 && this.series.data[0].x !== 2) {
                //Range ergo condition
                var yCoord = this.y;
                var labelTmp = conditions[Math.floor(this.x)].intervals.filter(function(v) {
                  return yCoord >= v.from && yCoord <= v.to;
                });
                var label = labelTmp.length > 0 ? labelTmp[0].label : "No label A";
                return '<b>' + conditions[Math.floor(this.x)].name + (label ? ': ' + label : '') + '</b><br/>' +
                  Highcharts.dateFormat('%Y:%m:%d', this.point.options.low) +
                  ' - ' + Highcharts.dateFormat('%Y:%m:%d', this.point.options.high);
              } else {
                //Single value hence contact
                var time = this.y;
                return (this.series.data[0].x === 1 ? importantCodes : contacts).filter(function(val) {
                  return val.data && val.data.filter(function(v) {
                    return v[1] === time;
                  }).length > 0;
                }).map(function(val) {
                  return '<b>' + val.name + '</b><br/>' + Highcharts.dateFormat('%Y:%m:%d', time);
                }).join('<br/>');
              }
            },
            followPointer: true
          },

          plotOptions: {
            columnrange: {
              grouping: false,
              /*groupPadding: 0.3,*/
              dataLabels: {
                allowOverlap: true,
                enabled: true,
                formatter: function() {
                  var yCoord = this.y;
                  var idx = -1;
                  var labelTmp = conditions[Math.floor(this.x)].intervals.filter(function(v, i) {
                    if (yCoord >= v.from && yCoord <= v.to) {
                      idx = i;
                      return true;
                    }
                    return false;
                  });
                  var label = labelTmp.length > 0 ? labelTmp[0].label : "No label B";
                  return this.y === this.point.low &&
                    (conditions[Math.floor(this.x)].intervals.length - 1 === idx ||
                      (this.series.chart.yAxis[0].min <= yCoord && this.series.chart.yAxis[0].max >= yCoord) ||
                      (this.series.chart.yAxis[0].min >= this.point.low && this.series.chart.yAxis[0].max <= this.point.high)) ? conditions[Math.floor(this.x)].name + (label ? ': ' + label : '') : '';
                }
              }
            }
          },

          series: series

        });
    };

    var plotMeasurements = function(measurements) {
      $(elementId).append($('<div class="chart-title">Patient measurements</div>'));
      $.each(measurements, function(i, dataset) {
        ll.charts++;
        // Add X values
        /*if (dataset.data && typeof dataset.data[0] !== "object") {
          dataset.data = Highcharts.map(dataset.data, function(val, j) {
            return [measurements.xData[j], val];
          });
        }*/

        var chartOptions = {
          chart: {
            marginLeft: 120, // Keep all charts left aligned
            spacingTop: 0,
            spacingBottom: 8,
            backgroundColor: '#F9F9F3',
            borderWidth: 2,
            borderColor: '#ddd'
          },
          title: {
            text: '',
            align: 'left',
            margin: 0,
            x: 30
          },
          marker: {
            enabled: true
          },
          credits: {
            enabled: false
          },
          legend: {
            enabled: false
          },
          xAxis: {
            type: 'datetime',
            min: Date.UTC(2005, 6, 12),
            max: new Date().getTime(),
            crosshair: {
              snap: false
            },
            events: {
              setExtremes: syncExtremes
            },
            labels: {
              enabled: false
            },
            lineWidth: 0,
            minorGridLineWidth: 0,
            lineColor: 'transparent',
            minorTickLength: 0,
            tickLength: 0
          },
          yAxis: {
            title: {
              text: dataset.name + "<br>" + dataset.unit.replace(/\^([0-9]+)/, "<sup>$1</sup>") + "",
              margin: 60,
              rotation: 0
            },
            startOnTick: false,
            endOnTick: false,
            labels: {
              style: {
                "textOverflow": "none"
              }
            },
            tickPixelInterval: 25,
            maxPadding: 0.1,
            minPadding: 0.1
          },
          tooltip: {
            positioner: function(labelWidth, labelHeight, point) {
              return {
                x: Math.max(50, point.plotX - labelWidth), // left aligned
                y: -1 // align to title
              };
            },
            useHTML: true,
            pointFormat: '<b>' + dataset.name + ':</b> {point.y} ' + dataset.unit.replace(/\^([0-9]+)/, "<sup>$1</sup>"),
            valueDecimals: dataset.valueDecimals
          },
          plotOptions: {
            series: {
              events: {
                mouseOut: function() {
                  var chart, i;
                  for (i = 1; i < ll.chartArray.length - 2; i = i + 1) {
                    chart = ll.chartArray[i];
                    chart.tooltip.hide();
                  }
                }
              }
            }
          },
          series: [{
            data: dataset.data,
            name: dataset.name,
            type: dataset.type,
            color: colour.next(),
            fillOpacity: 0.3
            }]
        };

        if (dataset.name === "BP") {
          chartOptions.tooltip.pointFormat = "<b>BP:</b> {point.low}/{point.high} mmHg<br/>";
          //chartOptions.series[0].tooltip = {};
          chartOptions.series[0].stemWidth = 3;
          chartOptions.series[0].whiskerWidth = 5;
        }

        /*if (i === 0) {
          chartOptions.title = {
            text: 'Patient measurements',
            align: 'left',
            margin: 1,
            style: {
              color: "#333333",
              fontSize: "12px",
              fontWeight: "bold"
            }
          };
        }*/

        /*if (i === measurements.datasets.length - 1) {
          chartOptions.xAxis = {
            crosshair: true,
            events: {
              setExtremes: syncExtremes
            },
            type: 'datetime'
          };
        }*/
        $('<div class="sync-chart h-chart' + (i === measurements.length - 1 ? " h-last-measurement-chart" : "") + '">')
          .appendTo(elementId)
          .highcharts(chartOptions);

      });
    };

    var plotNavigator = function() {
      ll.charts++;
      var chart = $('<div class="h-chart h-navigator-chart">')
        .appendTo(elementId)
        .highcharts({

          chart: {
            renderTo: element,
            marginLeft: 120, // Keep all charts left aligned
            spacingTop: 20,
            spacingBottom: 20,
            ignoreHiddenSeries: false,
            borderWidth: 2,
            borderColor: '#ddd'
          },

          title: {
            text: ''
          },

          xAxis: {
            type: 'datetime',
            min: Date.UTC(2005, 6, 12),
            max: new Date().getTime(),
            crosshair: false,
            events: {
              setExtremes: syncExtremes
            },
            labels: {
              enabled: false
            },
            lineWidth: 0,
            minorGridLineWidth: 0,
            lineColor: 'transparent',
            minorTickLength: 0,
            tickLength: 0
          },

          yAxis: {
            min: 0,
            max: 1,
            tickInterval: 1,
            startOnTick: false,
            endOnTick: false,
            title: {
              text: ''
            },
            minPadding: 0.2,
            maxPadding: 0.2,
            labels: {
              enabled: false
            }
          },

          legend: {
            enabled: false
          },

          navigator: {
            enabled: true
          },

          plotOptions: {
            line: {
              lineWidth: 0,
              marker: {
                enabled: false
              },
              dataLabels: {
                enabled: false
              }
            }
          },

          series: [{
            "name": "HTN",
            "data": [{
              "x": 1373587200000,
              "y": 0,
              "from": 1373587200000,
              "to": 1459814400000
              }]
            }]

        });
      chart.highcharts().series[0].hide();
    };

    var plotMedications = function(medications) {
      ll.charts++;
      var series = [];
      $.each(medications.reverse(), function(i, task) {
        var item = {
          name: task.name,
          data: [],
          color: colour.next()
        };
        $.each(task.intervals, function(j, interval) {
          item.data.push([i + 0.49, interval.from, interval.to]);
        });

        series.push(item);
      });
      var noData = false;
      if (series.length === 0) {
        series.push({
          type: 'line',
          name: 'Random data',
          data: []
        });
        noData = true;
      }

      //$(elementId).append($('<div class="chart-title"' + (noData ? 'style="display:none"' : '') + '>Patient medications</div>'));
      $(elementId).append($('<div class="chart-title">Patient medications</div>'));
      // create the chart
      //return $('<div class="h-chart h-medication-chart"' + (noData ? 'style="display:none"' : '') + '>')
      return $('<div class="h-chart h-medication-chart">')
        .appendTo(elementId)
        .highcharts({

          chart: {
            renderTo: element,
            marginLeft: 120, // Keep all charts left aligned
            spacingTop: 20,
            spacingBottom: 20,
            type: 'columnrange',
            inverted: true,
            backgroundColor: '#F3F9F9'
          },
          lang: {
            noData: "No relevant medications"
          },
          noData: {
            style: {
              fontWeight: 'bold',
              fontSize: '15px',
              color: '#303030'
            }
          },

          title: '',
          /*{
                      text: 'Patient medications',
                      align: 'left',
                      margin: 1,
                      style: {
                        color: "#333333",
                        fontSize: "12px",
                        fontWeight: "bold"
                      }
                    },*/


          yAxis: {
            type: 'datetime',
            min: Date.UTC(2005, 6, 12),
            max: new Date().getTime(),
            crosshair: {
              snap: false
            },
            events: {
              setExtremes: syncExtremes
            },



            //things that are normally xAxis defaults
            endOnTick: false,
            gridLineWidth: 0,
            lineWidth: 1,
            maxPadding: 0.01,
            minPadding: 0.01,
            startOnTick: false,
            tickWidth: 1,
            title: {
              text: ''
            },
            tickPixelInterval: 100
          },

          xAxis: {
            labels: {
              enabled: false
            },
            startOnTick: false,
            endOnTick: false,
            title: {
              text: ''
            },
            tickWidth: 0,
            minPadding: 0.2,
            maxPadding: 0.2,

            //things that are normally yAxis defaults
            gridLineWidth: 0,
            lineWidth: 0
          },
          credits: {
            enabled: false
          },

          legend: {
            enabled: false
          },

          tooltip: {
            formatter: function() {
              var yCoord = this.y;
              var labelTmp = medications[Math.floor(this.x)].intervals.filter(function(v) {
                return yCoord >= v.from && yCoord <= v.to;
              });
              var label = labelTmp.length > 0 ? labelTmp[0].label : "No label C";
              return '<b>' + medications[Math.floor(this.x)].name + (label ? ': ' + label : '') + '</b><br/>' +
                Highcharts.dateFormat('%Y:%m:%d', this.point.options.low) +
                ' - ' + Highcharts.dateFormat('%Y:%m:%d', this.point.options.high);
            },
            followPointer: true
          },

          plotOptions: {
            columnrange: {
              grouping: false,
              dataLabels: {
                allowOverlap: true,
                enabled: true,
                formatter: function() {
                  var yCoord = this.y;
                  var idx = -1;
                  var labelTmp = medications[Math.floor(this.x)].intervals.filter(function(v, i) {
                    if (yCoord >= v.from && yCoord <= v.to) {
                      idx = i;
                      return true;
                    }
                    return false;
                  });
                  var label = labelTmp.length > 0 ? labelTmp[0].label : "No label D";
                  return this.y === this.point.low &&
                    (medications[Math.floor(this.x)].intervals.length - 1 === idx ||
                      (this.series.chart.yAxis[0].min <= yCoord && this.series.chart.yAxis[0].max >= yCoord) ||
                      (this.series.chart.yAxis[0].min >= this.point.low && this.series.chart.yAxis[0].max <= this.point.high)) ? medications[Math.floor(this.x)].name + (label ? ': ' + label : '') : '';
                }
              }
            }
          },

          series: series

        });
    };

    plotConditions(data.conditions, data.events, data.contacts);
    plotMeasurements(data.measurements);
    var c = plotMedications(data.medications);
    plotNavigator();
    c.highcharts().axes[1].setExtremes(1434864000000, 1459814400000, undefined, false, {
      trigger: 'syncExtremes'
    });

    ll.chartArray = Highcharts.charts.slice(Highcharts.charts.length - ll.charts, Highcharts.charts.length);

    var s = syncExtremes.bind(c.highcharts().series[0]);
    s({
      trigger: 'navigator',
      min: 1434864000000,
      max: 1459814400000
    });
  }

};

module.exports = ll;

},{"../base.js":7,"highcharts/highcharts-more":1,"highcharts/highstock":2}],24:[function(require,module,exports){
var base = require('../base.js'),
  confirm = require('./confirm.js'),
  data = require('../data.js'),
  log = require('../log.js');

var med = {

  create: function(pathwayId, pathwayStage, standard, patientId) {
    var medications = data.patients[patientId].medications || [];
    var agree = log.getPatientAgreeObject(pathwayId, pathwayStage, standard, patientId, "medication");
    return base.createPanel(medicationPanel, {
      "areMedications": medications.length > 0,
      "agree": agree && agree.agree,
      "disagree": agree && agree.agree === false,
      "pathway": data.pathwayNames[pathwayId],
      "medications": medications,
      "pathwayStage": pathwayStage
    }, {
      "medicationRow": $('#medication-row').html()
    });
  },

  wireUp: function(pathwayId, pathwayStage, standard, patientId) {
    confirm.wireUp($('#medication-agree-disagree'), $('#medication-panel'), pathwayId, pathwayStage, standard, patientId, "medication", "medication data");
  }

};

module.exports = med;

},{"../base.js":7,"../data.js":9,"../log.js":11,"./confirm.js":16}],25:[function(require,module,exports){
var base = require('../base.js'),
  confirm = require('./confirm.js'),
  data = require('../data.js'),
  log = require('../log.js');

var other = {

  create: function(pathwayId, pathwayStage, standard, patientId) {
    var codes = (data.patients[patientId].codes || []).map(function(val) {
      val.description = data.codes[val.code];
      return val;
    });
    var agree = log.getPatientAgreeObject(pathwayId, pathwayStage, standard, patientId, "codes");
    return base.createPanel($('#other-codes-panel'), {
      "areCodes": codes.length > 0,
      "agree": agree && agree.agree,
      "disagree": agree && agree.agree === false,
      "pathway": data.pathwayNames[pathwayId],
      "standard": data[pathwayId][pathwayStage].standards[standard].tab.title,
      "codes": codes,
      "pathwayStage": pathwayStage
    }, {
      "codeRow": $('#other-codes-row').html()
    });
  },

  wireUp: function(pathwayId, pathwayStage, standard, patientId) {
    confirm.wireUp($('#other-codes-agree-disagree'), $('#other-codes-panel'), pathwayId, pathwayStage, standard, patientId, "codes", "other codes");
  }

};

module.exports = other;

},{"../base.js":7,"../data.js":9,"../log.js":11,"./confirm.js":16}],26:[function(require,module,exports){
var data = require('../data.js'),
  Mustache = require('mustache');

var pc = {

  show: function(panel, isAppend, patientId) {

    var patientData = data.getPatientData(patientId);

    var tempMust = $('#patient-characteristics-panel').html();
    var html = Mustache.render(tempMust, patientData.characteristics);

    if (isAppend) panel.append(html);
    else panel.html(html);

  }

};

module.exports = pc;

},{"../data.js":9,"mustache":4}],27:[function(require,module,exports){
var Highcharts = require('highcharts/highstock'),
  base = require('../base.js'),
  data = require('../data.js'),
  lookup = require('../lookup.js'),
  Mustache = require('mustache');

var ID = "PATIENT_LIST";

var pl = {

  wireUp: function(onPatientSelected) {
    patientsPanel = $('#patients');

    patientsPanel.on('click', 'thead tr th.sortable', function() { //Sort columns when column header clicked
      var sortAsc = !$(this).hasClass('sort-asc');
      if (sortAsc) {
        $(this).removeClass('sort-desc').addClass('sort-asc');
      } else {
        $(this).removeClass('sort-asc').addClass('sort-desc');
      }
      pl.populate(pl.state[0], pl.state[1], pl.state[2], pl.state[3], $(this).index(), sortAsc);
    }).on('click', 'tbody tr', function(e) { //Select individual patient when row clicked#
      var callback = onPatientSelected.bind(this);
      var patientId = $(this).find('td button').attr('data-patient-id');
      callback(patientId);
      e.preventDefault();
      e.stopPropagation();
    }).on('click', 'tbody tr button', function(e) {
      //don't want row selected if just button pressed?
      e.preventDefault();
      e.stopPropagation();
    });
  },

  selectSubsection: function(section) {
    pl.populate(pl.state[0], pl.state[1], pl.state[2], section, pl.state[4], pl.state[5]);
  },

  populate: function(pathwayId, pathwayStage, standard, subsection, sortField, sortAsc) {
    pl.state = [pathwayId, pathwayStage, standard, subsection, sortField, sortAsc];
    patientsPanel = $('#patients');
    //Remove scroll if exists
    patientsPanel.find('div.table-scroll').getNiceScroll().remove();

    var i, k, prop, header, pList = [];

    data.getIndicatorData([pathwayId, pathwayStage, standard].join("."), function(indicators) {

      if (pathwayId && pathwayStage && standard && subsection) {
        pList = indicators.opportunities.filter(function(val) {
          return val.name === subsection;
        })[0].patients;
        header = indicators.opportunities.filter(function(val) {
          return val.name === subsection;
        })[0].description;
      } else if (pathwayId && pathwayStage && standard) {
        pList = indicators.opportunities.reduce(function(a, b) {
          return a.patients ? a.patients.concat(b.patients) : a.concat(b.patients);
        });
        header = data.text[pathwayId][pathwayStage].standards[standard].tableTitle;
      }

      pList = data.removeDuplicates(pList);
      var vId = data.text[pathwayId][pathwayStage].standards[standard].valueId;
      var dOv = data.text[pathwayId][pathwayStage].standards[standard].dateORvalue;
      var patients = pList.map(function(patientId) {
        var ret = indicators.patients[patientId];
        ret.nhsNumber = data.patLookup[patientId] || patientId;
        ret.patientId = patientId;
        ret.items = [data.patients[patientId].characteristics.age]; //The fields in the patient list table

        var measures = data.patients[patientId].measurements.filter(function(v){return v.id===vId;});

        if ( measures[0] && measures[0].data) {
          if (dOv === "date") {
            ret.items.push(new Date(measures[0].data[measures[0].data.length-1][0]));
          } else {
            ret.items.push(measures[0].data[measures[0].data.length-1][1]);
          }
        } else {
          ret.items.push("?");
        }
        ret.items.push(indicators.patients[patientId].opportunities.map(function(v){return '<span style="width:13px;height:13px;float:left;background-color:' + Highcharts.getOptions().colors[v] + '"></span>';}).join(""));
        //ret.items.push(data.numberOfStandardsMissed(patientId));
        return ret;
      });

      var localData = {
        "patients": patients,
        "n": patients.length,
        "header": header,
        "header-items": [{
          "title": "NHS no.",
          "isSorted": false,
          "direction": "sort-asc",
          "tooltip": "NHS number of each patient"
        },{
          "title": "Age",
          "isSorted": false,
          "direction": "sort-asc",
          "tooltip": "The age of the patient"
        }]
      };

      //middle column is either value or date
      if (dOv) {
        localData["header-items"].push({
          "title": data.text[pathwayId][pathwayStage].standards[standard].valueName,
          "tooltip": dOv === "date" ? "Last date " + vId + " was measured" : "Last " + vId + " reading",
          "isSorted": false,
          "direction": "sort-asc"
        });
      } else {
        if (pathwayStage === lookup.categories.monitoring.name) {
          localData["header-items"].push({
            "title": "Last BP Date",
            "isSorted": false,
            "direction": "sort-asc",
            "tooltip": "Last date BP was measured"
          });
        } else {
          localData["header-items"].push({
            "title": "Last SBP",
            "tooltip": "Last systolic BP reading",
            "isSorted": false,
            "direction": "sort-asc"
          });
        }
      }

      //add qual standard column
      localData["header-items"].push({
        "title": "Categories",
        "titleHTML": 'Categories',
        "isSorted": true,
        "tooltip": "Categories from above chart"
      });

      if (sortField === undefined) sortField = 2;
      if (sortField !== undefined) {
        localData.patients.sort(function(a, b) {
          if (sortField === 0) { //NHS number
            if (a.nhsNumber === b.nhsNumber) {
              return 0;
            }

            if (a.nhsNumber > b.nhsNumber) {
              return sortAsc ? 1 : -1;
            } else if (a.nhsNumber < b.nhsNumber) {
              return sortAsc ? -1 : 1;
            }
          } else {
            if (a.items[sortField - 1] === b.items[sortField - 1]) {
              return 0;
            }

            if (a.items[sortField - 1] == "?") return 1;
            if (b.items[sortField - 1] == "?") return -1;

            var A = Number(a.items[sortField - 1]);
            var B = Number(b.items[sortField - 1]);
            if (isNaN(A) || isNaN(B)) {
              A = a.items[sortField - 1];
              B = b.items[sortField - 1];
            }
            if (A > B) {
              return sortAsc ? 1 : -1;
            } else if (A < B) {
              return sortAsc ? -1 : 1;
            }
          }
        });

        for (i = 0; i < localData["header-items"].length; i++) {
          if (i === sortField) {
            localData["header-items"][i].direction = sortAsc ? "sort-asc" : "sort-desc";
            localData["header-items"][i].isAsc = sortAsc;
            localData["header-items"][i].isSorted = true;
          } else {
            localData["header-items"][i].isSorted = false;
          }
        }
      }

      base.createPanelShow(patientList, patientsPanel, localData, {
        "header-item": $("#patient-list-header-item").html(),
        "item": $('#patient-list-item').html()
      });

      $('#patients-placeholder').hide();

      base.setupClipboard($('.btn-copy'), true);

      base.wireUpTooltips();

      patientsPanel.find('div.table-scroll').niceScroll({
        cursoropacitymin: 0.3,
        cursorwidth: "7px",
        horizrailenabled: false
      });

    });

  },

  show: function(panel, isAppend, pathwayId, pathwayStage, standard, loadContentFn) {

    var tempMust = $('#patients-panel-yes').html();

    if(isAppend) panel.append(Mustache.render(tempMust));
    else panel.html(Mustache.render(tempMust));

    pl.wireUp(function(patientId) {
      history.pushState(null, null, '#patient/' + patientId);
      loadContentFn('#patient/' + patientId);
    });
    pl.populate(pathwayId, pathwayStage, standard, null);
  }

};

module.exports = pl;

},{"../base.js":7,"../data.js":9,"../lookup.js":12,"highcharts/highstock":2,"mustache":4}],28:[function(require,module,exports){
var base = require('../base.js'),
  data = require('../data.js'),
  lookup = require('../lookup.js'),
  Mustache = require('mustache');
var states, loadContFn, ID = "PATIENT_SEARCH";

var ps = {

  wireUp: function() {
    if (states) {
      states.clearPrefetchCache();
    }

    states = new Bloodhound({
      datumTokenizer: Bloodhound.tokenizers.obj.whitespace('value'),
      queryTokenizer: Bloodhound.tokenizers.whitespace,
      local: $.map(data.patientArray, function(state) {
        return {
          id: state,
          value: data.patLookup && data.patLookup[state] ? data.patLookup[state] : state
        };
      })
    });

    states.initialize(true);

    $('#search-box').find('.typeahead').typeahead('destroy');
    $('#search-box').find('.typeahead').typeahead({
        hint: true,
        highlight: true,
        minLength: 1,
        autoselect: true
      }, {
        name: 'patients',
        displayKey: 'value',
        source: states.ttAdapter(),
        templates: {
          empty: [
              '<div class="empty-message">',
                '&nbsp; &nbsp; No matches',
              '</div>'
            ].join('\n')
        }
      }).on('typeahead:selected', ps.onSelected)
      .on('typeahead:autocompleted', ps.onSelected);

    $('#searchbtn').on('mousedown', function() {
      var val = $('.typeahead').eq(0).val();
      if (!val || val === "") val = $('.typeahead').eq(1).val();
      ps.onSelected(null, {
        "id": val
      });
    });
  },

  onSelected: function($e, nhsNumberObject) {
    //Hide the suggestions panel
    $('#search-box').find('.tt-dropdown-menu').css('display', 'none');

    history.pushState(null, null, '#patients/' + nhsNumberObject.id);
    loadContFn('#patients/' + nhsNumberObject.id, true);

  },

  show: function(panel, isAppend, loadContentFn) {

    loadContFn = loadContentFn;
    var tempMust = $('#patient-search').html();

    if(isAppend) panel.append(Mustache.render(tempMust));
    else panel.html(Mustache.render(tempMust));

    ps.wireUp();
  }

};

module.exports = ps;

},{"../base.js":7,"../data.js":9,"../lookup.js":12,"mustache":4}],29:[function(require,module,exports){
var base = require('../base.js'),
  data = require('../data.js'),
  lookup = require('../lookup.js'),
  chart = require('../chart.js'),
  qualityStandard = require('./qualityStandard.js'),
  otherCodes = require('./otherCodes.js'),
  medication = require('./medication.js'),
  trend = require('./trend.js'),
  individualActionPlan = require('./individualActionPlan.js'),
  patientList = require('./patientList.js');

var pt = {

  create: function(pathwayId, pathwayStage, standard) {
    var tabData = [];
    for (var key in data[pathwayId][pathwayStage].standards) {
      tabData.push({
        "header": data[pathwayId][pathwayStage].standards[key].tab,
        "active": key === standard,
        "url": window.location.hash.replace(/\/no.*/g, '\/no/' + key)
      });
    }
    return base.createPanel(patientsPanelTemplate, {
      "pathwayStage": pathwayStage,
      "header": data[pathwayId][pathwayStage].standards[standard].chartTitle,
      "tooltip": data[pathwayId][pathwayStage].standards[standard].tooltip,
      "url": window.location.hash.replace(/\/yes.*/g, '').replace(/\/no.*/g, ''),
      "tabs": tabData,
      "text": data[pathwayId][pathwayStage].text
    }, {
      "content": $('#patients-panel-no').html(),
      "tab-header": $('#patients-panel-no-tabs').html(),
      "tab-content": $('#patients-panel-no-page').html()
    });
  },

  createOk: function(pathwayId, pathwayStage) {
    return base.createPanel(patientsPanelTemplate, {
      "ok": true,
      "pathwayStage": pathwayStage,
      "url": window.location.hash.replace(/\/yes/g, '').replace(/\/no/g, ''),
      "text": data[pathwayId][pathwayStage].text
    }, {
      "content": $('#patients-panel-yes').html()
    });
  },

  wireUp: function(pathwayId, pathwayStage, location, standard) {

    patientList.wireUp(function(patientId){
      $('[data-toggle="tooltip"]').tooltip('hide');
      $(this).tooltip('destroy');
      base.clearBox();
      $('.list-item').removeClass('highlighted');
      $(this).addClass('highlighted').removeAttr("title");

      pt.showPathwayStagePatientView(patientId, pathwayId, selected, standard);
    });

    patientsPanel = $('#patients');

    location.off('click', '#breakdown-chart');
    location.on('click', '#breakdown-chart', function() {
      if (!lookup.chartClicked) {
        /*jshint unused: true*/
        $('path.c3-bar').attr('class', function(index, classNames) {
          return classNames.replace(/_unselected_/g, '');
        });
        /*jshint unused: false*/

        if (lookup.charts['breakdown-chart']) lookup.charts['breakdown-chart'].unselect();

        patientList.populate(pathwayId, pathwayStage, standard, null);
        data.subselected = null;

        farRightPanel.fadeOut(200);
      }
      lookup.chartClicked = false;
    });

    chart.destroyCharts(['breakdown-chart']);
    setTimeout(function() {
      lookup.charts['breakdown-chart'] = c3.generate({
        bindto: '#breakdown-chart',
        tooltip: {
          format: {
            name: function(name, a, b) {
              var text = data[pathwayId][pathwayStage].standards[standard].opportunities[lookup.index].desc;
              var html = "";
              while (text.length > 40) {
                if (text.indexOf(' ', 40) < 0) break;
                html += text.substr(0, text.indexOf(' ', 40)) + '<br>';
                text = text.substr(text.indexOf(' ', 40) + 1);
              }
              html += text;
              return html;
            },
            value: function(value, ratio, id, index) {
              lookup.index = index;
              return value;
            }
          }
        },
        data: {
          columns: [
            ["Patients"].concat(data[pathwayId][pathwayStage].standards[standard].opportunities.map(function(val) {
              return val.patients.length;
            }))
          ],
          type: 'bar',
          labels: true,
          color: function(color, d) {
            return lookup.colors[d.index];
          },
          selection: {
            enabled: true
          },
          onclick: function(d) {
            chart.selectPieSlice('breakdown-chart', d);
            patientList.populate(pathwayId, pathwayStage, standard, data[pathwayId][pathwayStage].standards[standard].opportunities[d.index].name);
            data.subselected = data[pathwayId][pathwayStage].standards[standard].opportunities[d.index].name;

            //colour table appropriately - need to add opacity
            var sliceColourHex = lookup.colors[d.index];
            var shorthandRegex = /^#?([a-f\d])([a-f\d])([a-f\d])$/i;
            sliceColourHex = sliceColourHex.replace(shorthandRegex, function(m, r, g, b) {
              return r + r + g + g + b + b;
            });
            var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(sliceColourHex);
            var opacity = 0.2;
            var sliceColour = 'rgba(' + parseInt(result[1], 16) + ',' + parseInt(result[2], 16) + ',' + parseInt(result[3], 16) + ',' + opacity + ')';

            $('.table.patient-list.table-head-hidden').css({
              "backgroundColor": sliceColour
            });
          }
        },
        bar: {
          width: {
            ratio: 0.5
          }
        },
        legend: {
          show: false
        },
        grid: {
          focus: {
            show: false
          }
        },
        axis: {
          x: {
            type: 'category',
            categories: data[pathwayId][pathwayStage].standards[standard].opportunities.map(function(val) {
              return val.name;
            }),
            label: false
          },
          y: {
            label: {
              text: 'Patient count (n)',
              position: 'outer-middle'
            }
          }
        }
      });
    }, 1);
  },

  wireUpOk: function(pathwayId, pathwayStage, location) {
    patientsPanel = $('#patients');

    patientsPanel.on('click', 'thead tr th.sortable', function() { //Sort columns when column header clicked
      var sortAsc = !$(this).hasClass('sort-asc');
      if (sortAsc) {
        $(this).removeClass('sort-desc').addClass('sort-asc');
      } else {
        $(this).removeClass('sort-asc').addClass('sort-desc');
      }
      pt.populateOk(pathwayId, data.selected, data.subselected, $(this).index(), sortAsc);
    }).on('click', 'tbody tr', function(e) { //Select individual patient when row clicked
      $('[data-toggle="tooltip"]').tooltip('hide');
      $(this).tooltip('destroy');
      base.clearBox();
      $('.list-item').removeClass('highlighted');
      $(this).addClass('highlighted').removeAttr('title');

      var patientId = $(this).find('td button').attr('data-patient-id');

      pt.showPathwayStagePatientView(patientId, pathwayId, data.selected, null);
      e.preventDefault();
      e.stopPropagation();
    }).on('click', 'tbody tr button', function(e) {
      //don't want row selected if just button pressed?
      e.preventDefault();
      e.stopPropagation();
    });

    data.selected = pathwayStage;
    data.subselected = null;
  },

  populateOk: function(pathwayId, pathwayStage, subsection, sortField, sortAsc) {
    var pList = [],
      i, k, prop, header, tooltip;
    patientsPanel.fadeOut(200, function() {
      $(this).fadeIn(200);
    });

    pList = data[pathwayId][pathwayStage].patientsOk;
    header = data[pathwayId][pathwayStage].text.panelOkHeader.text;
    tooltip = data[pathwayId][pathwayStage].text.panelOkHeader.tooltip;

    pList = data.removeDuplicates(pList);
    var patients = pList.map(function(patientId) {
      var ret = data.patients[patientId];
      ret.nhsNumber = data.patLookup ? data.patLookup[patientId] : patientId;
      ret.patientId = patientId;
      ret.items = []; //The fields in the patient list table
      ret.items.push(data.patients[patientId].breach ? data.numberOfStandardsMissed(patientId) : 0);
      return ret;
    });
    var localData = {
      "patients": patients,
      "n": patients.length,
      "header": header,
      "tooltip": tooltip,
      "header-items": [{
        "title": "NHS no.",
        "isSorted": false,
        "direction": "sort-asc"
      }, {
        "title": "All Opportunities",
        "titleHTML": '# of <i class="fa fa-flag" style="color:red"></i>',
        "isSorted": true,
        "direction": "sort-desc",
        "tooltip": "Total number of improvement opportunities available across all conditions"
      }]
    };

    if (sortField === undefined) sortField = 1;

    localData.patients.sort(function(a, b) {
      if (sortField === 0) { //NHS number
        if (a.nhsNumber === b.nhsNumber) {
          return 0;
        }

        if (a.nhsNumber > b.nhsNumber) {
          return sortAsc ? 1 : -1;
        } else if (a.nhsNumber < b.nhsNumber) {
          return sortAsc ? -1 : 1;
        }
      } else {
        if (a.items[sortField - 1] === b.items[sortField - 1]) {
          return 0;
        }

        var A = Number(a.items[sortField - 1]);
        var B = Number(b.items[sortField - 1]);
        if (isNaN(A) || isNaN(B)) {
          A = a.items[sortField - 1];
          B = b.items[sortField - 1];
        }
        if (A > B) {
          return sortAsc ? 1 : -1;
        } else if (A < B) {
          return sortAsc ? -1 : 1;
        }
      }
    });

    for (i = 0; i < localData["header-items"].length; i++) {
      if (i === sortField) {
        localData["header-items"][i].direction = sortAsc ? "sort-asc" : "sort-desc";
        localData["header-items"][i].isAsc = sortAsc;
        localData["header-items"][i].isSorted = true;
      } else {
        localData["header-items"][i].isSorted = false;
      }
    }


    base.createPanelShow(patientList, patientsPanel, localData, {
      "header-item": $("#patient-list-header-item").html(),
      "item": $('#patient-list-item').html()
    });

    $('#patients-placeholder').hide();

    base.setupClipboard($('.btn-copy'), true);

    base.wireUpTooltips();

    var c = patientsPanel.find('div.table-scroll').getNiceScroll();
    if (c && c.length > 0) {
      c.resize();
    } else {
      patientsPanel.find('div.table-scroll').niceScroll({
        cursoropacitymin: 0.3,
        cursorwidth: "7px",
        horizrailenabled: false
      });
    }
  },

  //Show patient view within the pathway stage view
  showPathwayStagePatientView: function(patientId, pathwayId, pathwayStage, standard) {
    data.patientId = patientId;

    base.switchTo110Layout();

    pt.showIndividualPatientPanel(pathwayId, pathwayStage, standard, patientId);
  },

  showIndividualPatientPanel: function(pathwayId, pathwayStage, standard, patientId) {
    var stan = data[pathwayId][pathwayStage].standards[standard] ? data[pathwayId][pathwayStage].standards[standard].tab.title : "UNSPECIFIED";

    data.options.sort(function(a, b) {
      a = data.getPatientStatus(patientId, a.pathwayId, a.pathwayStage, a.standard);
      b = data.getPatientStatus(patientId, b.pathwayId, b.pathwayStage, b.standard);

      if (a === b) return 0;
      if (a === "not") return 1;
      if (b === "not") return -1;
      if (a === "ok") return 1;
      if (b === "ok") return -1;
      alert("!!!!!!!");
    });

    var panel = base.createPanel($('#patient-panel'), {
      "options": data.options,
      "numberOfStandardsMissed": data.numberOfStandardsMissed(patientId),
      "standard": stan,
      "pathwayStage": pathwayStage,
      "nhsNumber": data.patLookup ? data.patLookup[patientId] : patientId,
      "patientId": patientId
    }, {
      "option": $('#patient-panel-drop-down-options').html()
    });

    if (standard === null) {
      //Must be a patient from the *** OK group
      standard = data.options.filter(function(val) {
        return val.pathwayId === pathwayId && val.pathwayStage === pathwayStage;
      })[0].standard;
    }

    farRightPanel.html("");
    $('#temp-hidden').html(panel);

    var actionPlan = individualActionPlan.create(pathwayStage);
    $('#temp-hidden #patient-panel-right').html(actionPlan);

    var qualPanel = qualityStandard.create(pathwayId, pathwayStage, standard, patientId);
    var trendPanel = trend.create(pathwayId, pathwayStage, standard, patientId);
    var medPanel = medication.create(pathwayId, pathwayStage, standard, patientId);
    var codesPanel = otherCodes.create(pathwayId, pathwayStage, standard, patientId);
    var medCodeWrapperPanel = base.createPanel($('#other-codes-and-meds-wrapper-panel'));
    $('#temp-hidden #patient-panel-top').html(qualPanel);
    $('#temp-hidden #patient-panel-left').html("").append(trendPanel).append(medCodeWrapperPanel);
    $('#temp-hidden #medCodeWrapperPanel').append(medPanel).append(codesPanel);

    if (farRightPanel.is(':visible')) {
      farRightPanel.fadeOut(500, function() {
        $(this).html($('#temp-hidden').html());
        $('#temp-hidden').html("");
        individualActionPlan.wireUp(pathwayId, pathwayStage, standard, patientId);
        qualityStandard.wireUp(pathwayId, pathwayStage, standard, patientId);
        base.wireUpStandardDropDown(pathwayId, pathwayStage, standard, pt.showIndividualPatientPanel);
        trend.wireUp(pathwayId, pathwayStage, standard, patientId);
        medication.wireUp(pathwayId, pathwayStage, standard, patientId);
        otherCodes.wireUp(pathwayId, pathwayStage, standard, patientId);
        chart.drawTrendChart(patientId, pathwayId, pathwayStage, standard);
        $(this).fadeIn(500, function() {});
      });
    } else {
      farRightPanel.html($('#temp-hidden').html());
      $('#temp-hidden').html("");
      individualActionPlan.wireUp(pathwayId, pathwayStage, standard, patientId);
      qualityStandard.wireUp(pathwayId, pathwayStage, standard, patientId);
      base.wireUpStandardDropDown(pathwayId, pathwayStage, standard, pt.showIndividualPatientPanel);
      trend.wireUp(pathwayId, pathwayStage, standard, patientId);
      medication.wireUp(pathwayId, pathwayStage, standard, patientId);
      otherCodes.wireUp(pathwayId, pathwayStage, standard, patientId);
      chart.drawTrendChart(patientId, pathwayId, pathwayStage, standard);
      farRightPanel.fadeIn(500, function() {});
    }
  }

};

module.exports = pt;

},{"../base.js":7,"../chart.js":8,"../data.js":9,"../lookup.js":12,"./individualActionPlan.js":22,"./medication.js":24,"./otherCodes.js":25,"./patientList.js":27,"./qualityStandard.js":30,"./trend.js":33}],30:[function(require,module,exports){
var base = require('../base.js'),
  data = require('../data.js'),
  log = require('../log.js'),
  confirm = require('./confirm.js');

var ID = "QUALITYSTANDARD";

var qs = {

  create: function(pathwayId, pathwayStage, standard, patientId) {

    var localData = {
      "nhsNumber": data.patLookup ? data.patLookup[patientId] : patientId,
      "patientId": patientId
    };
    localData.standard = data.pathwayNames[pathwayId] + ' - ' + pathwayStage;
    if (data.patients[patientId].standards && data.patients[patientId].standards[pathwayId] &&
      data.patients[patientId].standards[pathwayId][pathwayStage] &&
      data.patients[patientId].standards[pathwayId][pathwayStage][standard]) {
      localData.standard = data.patients[patientId].standards[pathwayId][pathwayStage][standard];
    }

    localData.tooltip = data[pathwayId][pathwayStage].standards[standard]["standard-met-tooltip"];

    switch (data.getPatientStatus(patientId, pathwayId, pathwayStage, standard)) {
      case "ok":
        ////farRightPanel.removeClass('standard-missed-page').addClass('standard-achieved-page').removeClass('standard-not-relevant-page');
        localData.achieved = true;
        localData.relevant = true;
        break;
      case "missed":
        ////farRightPanel.addClass('standard-missed-page').removeClass('standard-achieved-page').removeClass('standard-not-relevant-page');
        localData.relevant = true;
        localData.achieved = false;
        break;
      case "not":
        ////farRightPanel.removeClass('standard-missed-page').removeClass('standard-achieved-page').addClass('standard-not-relevant-page');
        localData.relevant = false;
        break;
    }

    var agObj = log.getPatientAgreeObject(pathwayId, pathwayStage, standard, patientId, "standard");
    if (agObj && agObj.agree) localData.agree = true;
    else if (agObj && agObj.agree === false) localData.disagree = true;

    return base.createPanel($('#qual-standard'), localData);
  },

  show: function(panel, pathwayId, pathwayStage, standard, patientId){

    var panelId = panel.attr("id");

    if (base.panels[panelId] &&
      base.panels[panelId].id === ID &&
      base.panels[panelId].patientId === patientId) {
        //Already showing the right thing
        return;
    }

    base.panels[panelId] = {
      id: ID,
      patientId: patientId
    };

    panel.html(qs.create(pathwayId, pathwayStage, standard, patientId));
    qs.wireUp(pathwayId, pathwayStage, standard, patientId);
  },

  wireUp: function(pathwayId, pathwayStage, standard, patientId) {
    confirm.wireUp($('#qual-agree-disagree'), $('#individual-panel-classification'), pathwayId, pathwayStage, standard, patientId, "standard", "quality standard");
  },

  update: function() {
    $('#individual-panel-classification').find('div').each(function() {
      var self = $(this);
      var any = false;
      self.find('.btn-toggle input[type=checkbox]:checked').each(function() {
        var isClassification = $(this).closest("div").data("isClassification") !== undefined;
        any = true;
        var item = log.getAgrees()[data.patientId].filter(function(i) {
          return isClassification ? i.item === "section" : i.item !== "section";
        });
        var tool;
        if (this.value === "yes") {
          if (item && item[0].history) {
            tool = "<p>" + item[0].history[0] + "</p><p>Click again to cancel</p>";
            $(this).parent().attr("title", tool).attr("data-original-title", tool).tooltip('fixTitle').tooltip('hide');
          } else {
            $(this).parent().attr("title", "You agreed - click again to cancel").tooltip('fixTitle').tooltip('hide');
          }
        } else {
          if (item && item[0].history) {
            tool = "<p>" + item[0].history[0] + "</p><p>Click again to edit/cancel</p>";
            $(this).parent().attr("title", tool).attr("data-original-title", tool).tooltip('fixTitle').tooltip('hide');
          } else {
            $(this).parent().attr("title", "You disagreed - click again to edit/cancel").tooltip('fixTitle').tooltip('hide');
          }
        }
      });

      if (self.find('.btn-toggle input[type=checkbox]:not(:checked)').length == 1) {
        self.find('.btn-toggle input[type=checkbox]:not(:checked)').parent().addClass("inactive").attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
      }

      if (!any) {
        self.find('.btn-toggle.btn-yes').attr("title", "Click to agree with this action and save it in your agreed actions list  ").tooltip('fixTitle').tooltip('hide');
        self.find('.btn-toggle.btn-no').attr("title", "Click to disagree with this action and remove it from your suggested actions list ").tooltip('fixTitle').tooltip('hide');
      }

      base.wireUpTooltips();
    });

    base.wireUpTooltips();
  }

};

module.exports = qs;

},{"../base.js":7,"../data.js":9,"../log.js":11,"./confirm.js":16}],31:[function(require,module,exports){
var data = require('../data.js'),
  Mustache = require('mustache');

var qs = {

  show: function(panel, isAppend, patientId) {

    var patientData = data.getPatientData(patientId);

    var tempMust = $('#quality-standard-panel').html();
    var html = Mustache.render(tempMust, {
      "standards": patientData.standards
    });

    if (isAppend) panel.append(html);
    else panel.html(html);

  }

};

module.exports = qs;

},{"../data.js":9,"mustache":4}],32:[function(require,module,exports){
var base = require('../base.js'),
  confirm = require('./confirm.js'),
  data = require('../data.js'),
  log = require('../log.js');

var tap = {

  show: function(location) {
    location.removeClass('standard-missed-page').removeClass('standard-achieved-page').removeClass('standard-not-relevant-page');
    base.createPanelShow($('#team-action-plan-panel'), location);

    suggestedPlanTeam = $('#suggestedPlanTeam');

    suggestedPlanTeam.on('click', '.cr-styled input[type=checkbox]', function() {
      var ACTIONID = $(this).closest('tr').data('id');
      log.editAction("team", ACTIONID, null, this.checked);

      if (this.checked) {
        log.recordEvent(data.pathwayId, "team", "Item completed");
        var self = this;
        $(self).parent().attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
        base.wireUpTooltips();
        setTimeout(function(e) {
          $(self).parent().fadeOut(300, function() {
            var parent = $(this).parent();
            $(this).replaceWith(base.createPanel($('#checkbox-template'), {
              "done": true
            }));
            parent.find('button').on('click', function() {
              ACTIONID = $(this).closest('tr').data('id');
              log.editAction("team", ACTIONID, null, false);
              $(this).replaceWith(base.createPanel($('#checkbox-template'), {
                "done": false
              }));
              tap.updateTeamSapRows();
            });
          });
        }, 1000);
      }

      tap.updateTeamSapRows();
    });

    $('#personalPlanTeam').on('click', 'input[type=checkbox]', function() {
      var PLANID = $(this).closest('tr').data("id");
      editPlan(PLANID, null, this.checked);

      if (this.checked) {
        $(this).parent().parent().parent().addClass('success');
        recordEvent(data.pathwayId, "team", "Personal plan item");
        var self = this;
        $(self).parent().attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
        setTimeout(function(e) {
          $(self).parent().fadeOut(300, function() {
            var parent = $(this).parent();
            $(this).replaceWith(base.createPanel($('#checkbox-template'), {
              "done": true
            }));
            base.wireUpTooltips();
            parent.find('button').on('click', function() {
              PLANID = $(this).closest('tr').data('id');
              editPlan("team", PLANID, null, false);
              $(this).replaceWith(base.createPanel($('#checkbox-template'), {
                "done": false
              }));
              tap.updateTeamSapRows();
            });
          });
        }, 1000);
      }

    }).on('click', '.btn-undo', function(e) {
      var PLANID = $(this).closest('tr').data('id');
      log.editPlan(PLANID, null, false);
      $(this).replaceWith(base.createPanel($('#checkbox-template'), {
        "done": false
      }));
      tap.updateTeamSapRows();
      e.stopPropagation();
    });

    var teamTab = $('#tab-plan-team'),
      current;
    teamTab.on('click', '.edit-plan', function() {
      var PLANID = $(this).closest('tr').data("id");

      $('#editActionPlanItem').val($($(this).closest('tr').children('td')[0]).find('span').text());

      $('#editPlan').off('hidden.bs.modal').on('hidden.bs.modal', function() {
        tap.displayPersonalisedTeamActionPlan($('#personalPlanTeam'));
      }).off('shown.bs.modal').on('shown.bs.modal', function() {
        $('#editActionPlanItem').focus();
      }).off('click', '.save-plan').on('click', '.save-plan', function() {

        log.editPlan(PLANID, $('#editActionPlanItem').val());

        $('#editPlan').modal('hide');
      }).off('keyup', '#editActionPlanItem').on('keyup', '#editActionPlanItem', function(e) {
        if (e.which === 13) $('#editPlan .save-plan').click();
      }).modal();
    }).on('click', '.delete-plan', function() {
      var PLANID = $(this).closest('tr').data("id");

      $('#team-delete-item').html($($(this).closest('tr').children('td')[0]).find('span').text());

      $('#deletePlan').off('hidden.bs.modal').on('hidden.bs.modal', function() {
        tap.displayPersonalisedTeamActionPlan($('#personalPlanTeam'));
      }).off('click', '.delete-plan').on('click', '.delete-plan', function() {
        log.deletePlan(PLANID);

        $('#deletePlan').modal('hide');
      }).modal();
    }).on('click', '.add-plan', function() {
      log.recordPlan("team", $(this).parent().parent().find('textarea').val(), data.pathwayId);

      tap.displayPersonalisedTeamActionPlan($('#personalPlanTeam'));
    }).on('change', '.btn-toggle input[type=checkbox]', function() {
      tap.updateTeamSapRows();
    }).on('click', '.btn-undo', function(e) {
      var ACTIONID = $(this).closest('tr').data('id');
      log.editAction("team", ACTIONID, null, false);
      $(this).replaceWith(base.createPanel($('#checkbox-template'), {
        "done": false
      }));
      tap.updateTeamSapRows();
    }).on('click', '.btn-yes,.btn-no', function(e) {
      var checkbox = $(this).find("input[type=checkbox]");
      var other = $(this).parent().find($(this).hasClass("btn-yes") ? ".btn-no" : ".btn-yes");
      var ACTIONID = $(this).closest('tr').data('id');
      if ($(this).hasClass("active") && other.hasClass("inactive") && !$(this).closest('tr').hasClass('success')) {
        //unselecting
        if (checkbox.val() === "no") {
          tap.launchModal(data.selected, checkbox.closest('tr').children().first().children().first().text(), log.getReason("team", ACTIONID), true, function() {
            log.editAction("team", ACTIONID, false, null, log.reason);
            tap.updateTeamSapRows();
            base.wireUpTooltips();
          }, null, function() {
            log.ignoreAction("team", ACTIONID);
            other.removeClass("inactive");
            checkbox.removeAttr("checked");
            checkbox.parent().removeClass("active");
            tap.updateTeamSapRows();
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.ignoreAction("team", ACTIONID);
          other.removeClass("inactive");
        }
      } else if ((!$(this).hasClass("active") && other.hasClass("active")) || $(this).closest('tr').hasClass('success')) {
        //prevent clicking on unselected option or if the row is complete
        e.stopPropagation();
        e.preventDefault();
        return;
      } else {
        //selecting
        var self = this;
        if (checkbox.val() === "no") {
          tap.launchModal(data.selected, checkbox.closest('tr').children().first().children().first().text(), log.getReason("team", ACTIONID), false, function() {
            log.editAction("team", ACTIONID, false, null, log.reason);
            $(self).removeClass("inactive");

            checkbox.attr("checked", "checked");
            checkbox.parent().addClass("active");
            //unselect other
            other.removeClass("active").addClass("inactive");
            other.find("input[type=checkbox]").prop("checked", false);
            tap.updateTeamSapRows();
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.editAction("team", ACTIONID, true);
          $(this).removeClass("inactive");

          //unselect other
          other.removeClass("active").addClass("inactive");
          other.find("input[type=checkbox]").prop("checked", false);
        }
      }
    }).on('keyup', 'input[type=text]', function(e) {
      if (e.which === 13) {
        teamTab.find('.add-plan').click();
      }
    });

    tap.populateTeamSuggestedActionsPanel();

    location.find('div.fit-to-screen-height').niceScroll({
      cursoropacitymin: 0.3,
      cursorwidth: "7px",
      horizrailenabled: false
    });
  },

  populateTeamSuggestedActionsPanel: function() {
    var suggestions = base.suggestionList(log.plan[data.pathwayId].team);
    suggestions = base.sortSuggestions(tap.mergeTeamStuff(suggestions));

    base.createPanelShow(suggestedPlanTemplate, suggestedPlanTeam, {
      "suggestions": suggestions
    }, {
      "item": $('#suggested-plan-item').html(),
      "chk": $('#checkbox-template').html()
    });

    tap.displayPersonalisedTeamActionPlan($('#personalPlanTeam'));
  },

  updateTeamSapRows: function() {
    suggestedPlanTeam.add('#personalPlanTeam').find('.suggestion').each(function() {
      $(this).find('td').last().children().hide();
    });

    suggestedPlanTeam.add('#personalPlanTeam').find('.cr-styled input[type=checkbox]').each(function() {
      if (this.checked) {
        $(this).parent().parent().parent().addClass('success');
      } else {
        $(this).parent().parent().parent().removeClass('success');
      }
    });

    suggestedPlanTeam.add('#personalPlanTeam').find('.btn-undo').each(function() {
      $(this).parent().parent().addClass('success');
    });

    //no class - user not yet agreed/disagreed - no background / muted text
    //active - user agrees - green background / normal text
    //success - user completed - green background / strikethrough text
    //danger - user disagrees - red background / strikethrough text
    suggestedPlanTeam.add('#personalPlanTeam').find('tr').each(function() {
      var self = $(this);
      var any = false;
      self.find('.btn-toggle input[type=checkbox]:checked').each(function() {
        any = true;
        if (this.value === "yes") {
          self.removeClass('danger');
          self.addClass('active');
          self.find('td').last().children().show();
          if (log.getActions().team[self.data("id")].history) {
            var tool = $(this).closest('tr').hasClass('success') ? "" : "<p>" + log.getActions().team[self.data("id")].history[0] + "</p><p>Click again to cancel</p>";
            $(this).parent().attr("title", tool).attr("data-original-title", tool).tooltip('fixTitle').tooltip('hide');
          } else {
            $(this).parent().attr("title", "You agreed - click again to cancel").tooltip('fixTitle').tooltip('hide');
          }
        } else {
          self.removeClass('active');
          self.addClass('danger');
          self.removeClass('success');
          if (log.getActions().team[self.data("id")] && log.getActions().team[self.data("id")].history) {
            $(this).parent().attr("title", "<p>" + log.getActions().team[self.data("id")].history[0] + "</p><p>Click again to edit/cancel</p>").tooltip('fixTitle').tooltip('hide');
          } else {
            $(this).parent().attr("title", "You disagreed - click again to edit/cancel").tooltip('fixTitle').tooltip('hide');
          }
        }
      });
      if (self.find('.btn-toggle input[type=checkbox]:not(:checked)').length == 1) {
        self.find('.btn-toggle input[type=checkbox]:not(:checked)').parent().addClass("inactive").attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
      }
      if (!any) {
        self.removeClass('danger');
        self.removeClass('active');
        self.removeClass('success');

        self.find('.btn-toggle.btn-yes').attr("title", "Click to agree with this action and save it in your agreed actions list  ").tooltip('fixTitle').tooltip('hide');
        self.find('.btn-toggle.btn-no').attr("title", "Click to disagree with this action and remove it from your suggested actions list ").tooltip('fixTitle').tooltip('hide');
      }

      base.wireUpTooltips();
    });

    base.wireUpTooltips();
  },

  displayPersonalisedTeamActionPlan: function(parentElem) {
    var plans = base.sortSuggestions(base.addDisagreePersonalTeam(log.listPlans("team", data.pathwayId)));

    base.createPanelShow(actionPlanList, parentElem, {
      "hasSuggestions": plans && plans.length > 0,
      "suggestions": plans
    }, {
      "action-plan": $('#action-plan').html(),
      "action-plan-item": $('#action-plan-item').html(),
      "chk": $('#checkbox-template').html()
    });

    tap.updateTeamSapRows();
  },

  mergeTeamStuff: function(suggestions) {
    var teamActions = log.listActions();
    if (!teamActions.team) return suggestions;

    suggestions = tap.addDisagree(suggestions, teamActions, "team");
    return suggestions;
  },

  launchModal: function(label, value, reason, isUndo, callbackOnSave, callbackOnCancel, callbackOnUndo) {
    var reasons = [{
      "reason": "We've already done this",
      "value": "done"
    }, {
      "reason": "It wouldn't work",
      "value": "nowork"
    }, {
      "reason": "Other",
      "value": "else"
    }];
    if (reason && reason.reason) {
      for (var i = 0; i < reasons.length; i++) {
        if (reasons[i].reason === reason.reason) {
          reasons[i].checked = true;
          break;
        }
      }
    }
    base.launchModal({
      "header": "Disagree with a suggested action",
      "isUndo": isUndo,
      "item": value,
      "placeholder": "Enter free-text here...",
      "reasons": reasons
    }, label, value, reason ? reason.reasonText : null, callbackOnSave, callbackOnCancel, callbackOnUndo);
  },

  addDisagree: function(suggestions, actions, id) {
    for (var i = 0; i < suggestions.length; i++) {
      if (actions[id][suggestions[i].id]) {
        if (actions[id][suggestions[i].id].agree) {
          suggestions[i].agree = true;
          suggestions[i].disagree = false;
        } else if (actions[id][suggestions[i].id].agree === false) {
          suggestions[i].agree = false;
          suggestions[i].disagree = true;
        }
        if (actions[id][suggestions[i].id].done) suggestions[i].done = actions[id][suggestions[i].id].done;
        else suggestions[i].done = false;
      }
    }
    return suggestions;
  }

};

module.exports = tap;

},{"../base.js":7,"../data.js":9,"../log.js":11,"./confirm.js":16}],33:[function(require,module,exports){
var base = require('../base.js'),
  confirm = require('./confirm.js'),
  data = require('../data.js'),
  log = require('../log.js'),
  lookup = require('../lookup.js');

var trnd = {

  create: function(pathwayId, pathwayStage, standard, patientId) {
    var agree = log.getPatientAgreeObject(pathwayId, pathwayStage, standard, patientId, "trend");
    return base.createPanel(valueTrendPanel, {
      "pathway": lookup.monitored[pathwayId],
      "agree": agree && agree.agree,
      "disagree": agree && agree.agree === false,
      "standard": data[pathwayId][pathwayStage].standards[standard].tab.title,
      "pathwayStage": pathwayStage
    });
  },

  wireUp: function(pathwayId, pathwayStage, standard, patientId) {
    confirm.wireUp($('#trend-agree-disagree'), $('#trend-panel'), pathwayId, pathwayStage, standard, patientId, "trend", "trend data");

    $('#trend-panel').on('click', '.table-chart-toggle', function() {
      if ($(this).text() === "Table") {
        $(this).text("Chart");
        $('#chart-demo-trend').hide();
        $('#table-demo-trend').show();

        var c = $('#table-demo-trend .tableScroll').getNiceScroll();
        if (c && c.length > 0) {
          c.resize();
        } else {
          $('#table-demo-trend .tableScroll').niceScroll({
            cursoropacitymin: 0.3,
            cursorwidth: "7px",
            horizrailenabled: false
          });
        }
      } else {
        $(this).text("Table");
        $('#chart-demo-trend').show();
        $('#table-demo-trend').hide();
      }
    });
  }

};

module.exports = trnd;

},{"../base.js":7,"../data.js":9,"../log.js":11,"../lookup.js":12,"./confirm.js":16}],34:[function(require,module,exports){
var base = require('../base.js'),
  data = require('../data.js'),
  log = require('../log.js'),
  individualActionPlan = require('./individualActionPlan.js'),
  teamActionPlan = require('./teamActionPlan.js'),
  Mustache = require('mustache');

var welcome = {

  wireUpWelcomePage: function(pathwayId, pathwayStage) {
    $('#team-task-panel').on('click', '.cr-styled input[type=checkbox]', function() {
      var ACTIONID = $(this).closest('tr').data('id');
      log.editAction("team", ACTIONID, null, this.checked);

      if (this.checked) {
        log.recordEvent(pathwayId, "team", "Item completed");
        var self = this;
        $(self).parent().attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
        base.wireUpTooltips();
        setTimeout(function(e) {
          $(self).parent().fadeOut(300, function() {
            var parent = $(this).parent();
            $(this).replaceWith(base.createPanel($('#checkbox-template'), {
              "done": true
            }));
            parent.find('button').on('click', function() {
              ACTIONID = $(this).closest('tr').data('id');
              log.editAction("team", ACTIONID, null, false);
              $(this).replaceWith(base.createPanel($('#checkbox-template'), {
                "done": false
              }));
              welcome.updateWelcomePage();
            });
          });
        }, 1000);
      }
      welcome.updateWelcomePage();
    }).on('change', '.btn-toggle input[type=checkbox]', function() {
      welcome.updateWelcomePage();
    }).on('click', '.edit-plan', function() {
      var PLANID = $(this).closest('tr').data("id");

      $('#editActionPlanItem').val($($(this).closest('tr').children('td')[1]).find('span').text());

      $('#editPlan').off('hidden.bs.modal').on('hidden.bs.modal', function() {
        welcome.populate(!$('#outstandingTasks').parent().hasClass("active"));
      }).off('shown.bs.modal').on('shown.bs.modal', function() {
        $('#editActionPlanItem').focus();
      }).off('click', '.save-plan').on('click', '.save-plan', function() {

        log.editPlan(PLANID, $('#editActionPlanItem').val());

        $('#editPlan').modal('hide');
      }).off('keyup', '#editActionPlanItem').on('keyup', '#editActionPlanItem', function(e) {
        if (e.which === 13) $('#editPlan .save-plan').click();
      }).modal();
    }).on('click', '.delete-plan', function() {
      var PLANID = $(this).closest('tr').data("id");

      $('#team-delete-item').html($($(this).closest('tr').children('td')[1]).find('span').text());

      $('#deletePlan').off('hidden.bs.modal').on('hidden.bs.modal', function() {
        welcome.populate(!$('#outstandingTasks').parent().hasClass("active"));
      }).off('click', '.delete-plan').on('click', '.delete-plan', function() {
        log.deletePlan(PLANID);

        $('#deletePlan').modal('hide');
      }).modal();
    }).on('click', '.btn-undo', function(e) {
      var ACTIONID = $(this).closest('tr').data('id');
      log.editAction("team", ACTIONID, null, false);
      $(this).replaceWith(base.createPanel($('#checkbox-template'), {
        "done": false
      }));
      welcome.updateWelcomePage();
    }).on('click', '.btn-yes,.btn-no', function(e) {
      var checkbox = $(this).find("input[type=checkbox]");
      var other = $(this).parent().find($(this).hasClass("btn-yes") ? ".btn-no" : ".btn-yes");
      var ACTIONID = $(this).closest('tr').data('id');
      if ($(this).hasClass("active") && other.hasClass("inactive") && !$(this).closest('tr').hasClass('success')) {
        //unselecting
        if (checkbox.val() === "no") {
          teamActionPlan.launchModal(data.selected, checkbox.closest('tr').children(':nth(1)').find('span').text(), log.getReason("team", ACTIONID), true, function() {
            log.editAction("team", ACTIONID, false, null, log.reason);
            welcome.updateWelcomePage();
            base.wireUpTooltips();
          }, null, function() {
            log.ignoreAction("team", ACTIONID);
            other.removeClass("inactive");
            checkbox.removeAttr("checked");
            checkbox.parent().removeClass("active");
            welcome.updateWelcomePage();
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.ignoreAction("team", ACTIONID);
          other.removeClass("inactive");
        }
      } else if ((!$(this).hasClass("active") && other.hasClass("active")) || $(this).closest('tr').hasClass('success')) {
        //prevent clicking on unselected option or if the row is complete
        e.stopPropagation();
        e.preventDefault();
        return;
      } else {
        //selecting
        var self = this;
        if (checkbox.val() === "no") {
          teamActionPlan.launchModal(data.selected, checkbox.closest('tr').children(':nth(1)').find('span').text(), log.getReason("team", ACTIONID), false, function() {
            log.editAction("team", ACTIONID, false, null, log.reason);
            $(self).removeClass("inactive");

            checkbox.attr("checked", "checked");
            checkbox.parent().addClass("active");
            //unselect other
            other.removeClass("active").addClass("inactive");
            other.find("input[type=checkbox]").prop("checked", false);
            welcome.updateWelcomePage();
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.editAction("team", ACTIONID, true);
          $(this).removeClass("inactive");

          //unselect other
          other.removeClass("active").addClass("inactive");
          other.find("input[type=checkbox]").prop("checked", false);
        }
      }
    });

    $('#individual-task-panel').on('click', '.cr-styled input[type=checkbox]', function() {
      var ACTIONID = $(this).closest('tr').data('id');
      var patientId = $(this).closest('tr').data('team-or-patient-id');
      log.editAction(patientId, ACTIONID, null, this.checked);

      if (this.checked) {
        log.recordEvent(pathwayId, patientId, "Item completed");
        var self = this;
        $(self).parent().attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
        base.wireUpTooltips();
        setTimeout(function(e) {
          $(self).parent().fadeOut(300, function() {
            var parent = $(this).parent();
            $(this).replaceWith(base.createPanel($('#checkbox-template'), {
              "done": true
            }));
            parent.find('button').on('click', function() {
              ACTIONID = $(this).closest('tr').data('id');
              log.editAction(patientId, ACTIONID, null, false);
              $(this).replaceWith(base.createPanel($('#checkbox-template'), {
                "done": false
              }));
              welcome.updateWelcomePage();
            });
          });
        }, 1000);
      }
      welcome.updateWelcomePage();
    }).on('change', '.btn-toggle input[type=checkbox]', function() {
      welcome.updateWelcomePage();
    }).on('click', '.edit-plan', function() {
      var PLANID = $(this).closest('tr').data("id");

      $('#editActionPlanItem').val($($(this).closest('tr').children('td')[2]).find('span').text());

      $('#editPlan').off('hidden.bs.modal').on('hidden.bs.modal', function() {
        welcome.populate(!$('#outstandingTasks').parent().hasClass("active"));
      }).off('shown.bs.modal').on('shown.bs.modal', function() {
        $('#editActionPlanItem').focus();
      }).off('click', '.save-plan').on('click', '.save-plan', function() {

        log.editPlan(PLANID, $('#editActionPlanItem').val());

        $('#editPlan').modal('hide');
      }).off('keyup', '#editActionPlanItem').on('keyup', '#editActionPlanItem', function(e) {
        if (e.which === 13) $('#editPlan .save-plan').click();
      }).modal();
    }).on('click', '.delete-plan', function() {
      var PLANID = $(this).closest('tr').data("id");

      $('#team-delete-item').html($($(this).closest('tr').children('td')[2]).find('span').text());

      $('#deletePlan').off('hidden.bs.modal').on('hidden.bs.modal', function() {
        welcome.populate(!$('#outstandingTasks').parent().hasClass("active"));
      }).off('click', '.delete-plan').on('click', '.delete-plan', function() {
        log.deletePlan(PLANID);

        $('#deletePlan').modal('hide');
      }).modal();
    }).on('click', '.btn-undo', function(e) {
      var ACTIONID = $(this).closest('tr').data('id');
      var patientId = $(this).closest('tr').data('team-or-patient-id');
      log.editAction(patientId, ACTIONID, null, false);
      $(this).replaceWith(base.createPanel($('#checkbox-template'), {
        "done": false
      }));
      welcome.updateWelcomePage();
    }).on('click', '.btn-yes,.btn-no', function(e) {
      var checkbox = $(this).find("input[type=checkbox]");
      var other = $(this).parent().find($(this).hasClass("btn-yes") ? ".btn-no" : ".btn-yes");
      var ACTIONID = $(this).closest('tr').data('id');
      var patientId = $(this).closest('tr').data('team-or-patient-id');
      if ($(this).hasClass("active") && other.hasClass("inactive") && !$(this).closest('tr').hasClass('success')) {
        //unselecting
        if (checkbox.val() === "no") {
          individualActionPlan.launchModal(data.selected, checkbox.closest('tr').children(':nth(2)').find('span').text(), log.getReason(patientId, ACTIONID), true, function() {
            log.editAction(patientId, ACTIONID, false, null, log.reason);
            welcome.updateWelcomePage();
            base.wireUpTooltips();
          }, null, function() {
            log.ignoreAction(patientId, ACTIONID);
            other.removeClass("inactive");
            checkbox.removeAttr("checked");
            checkbox.parent().removeClass("active");
            welcome.updateWelcomePage();
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.ignoreAction(patientId, ACTIONID);
          other.removeClass("inactive");
        }
      } else if ((!$(this).hasClass("active") && other.hasClass("active")) || $(this).closest('tr').hasClass('success')) {
        //prevent clicking on unselected option or if the row is complete
        e.stopPropagation();
        e.preventDefault();
        return;
      } else {
        //selecting
        var self = this;
        if (checkbox.val() === "no") {
          individualActionPlan.launchModal(data.selected, checkbox.closest('tr').children(':nth(2)').find('span').text(), log.getReason(patientId, ACTIONID), false, function() {
            log.editAction(patientId, ACTIONID, false, null, log.reason);
            $(self).removeClass("inactive");

            checkbox.attr("checked", "checked");
            checkbox.parent().addClass("active");
            //unselect other
            other.removeClass("active").addClass("inactive");
            other.find("input[type=checkbox]").prop("checked", false);
            welcome.updateWelcomePage();
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.editAction(patientId, ACTIONID, true);
          $(this).removeClass("inactive");

          //unselect other
          other.removeClass("active").addClass("inactive");
          other.find("input[type=checkbox]").prop("checked", false);
        }
      }
    });

    welcome.updateWelcomePage();
  },

  updateWelcomePage: function() {
    $('#team-task-panel').add('#individual-task-panel').find('.suggestion').each(function() {
      $(this).find('td').last().children().hide();
    });

    $('#team-task-panel').add('#individual-task-panel').find('.cr-styled input[type=checkbox]').each(function() {
      if (this.checked) {
        $(this).parent().parent().parent().addClass('success');
      } else {
        $(this).parent().parent().parent().removeClass('success');
      }
    });

    $('#team-task-panel').add('#individual-task-panel').find('.btn-undo').each(function() {
      $(this).parent().parent().addClass('success');
    });

    //no class - user not yet agreed/disagreed - no background / muted text
    //active - user agrees - green background / normal text
    //success - user completed - green background / strikethrough text
    //danger - user disagrees - red background / strikethrough text
    $('#team-task-panel').add('#individual-task-panel').find('tr').each(function() {
      var self = $(this);
      var any = false;
      self.find('.btn-toggle input[type=checkbox]:checked').each(function() {
        any = true;
        if (this.value === "yes") {
          self.removeClass('danger');
          self.addClass('active');
          self.find('td').last().children().show();
          if (log.getActions().team[self.data("id")] && log.getActions().team[self.data("id")].history) {
            var tool = $(this).closest('tr').hasClass('success') ? "" : "<p>" + log.getActions().team[self.data("id")].history[0] + "</p><p>Click again to cancel</p>";
            $(this).parent().attr("title", tool).attr("data-original-title", tool).tooltip('fixTitle').tooltip('hide');
          } else {
            $(this).parent().attr("title", "You agreed - click again to cancel").tooltip('fixTitle').tooltip('hide');
          }
        } else {
          self.removeClass('active');
          self.addClass('danger');
          self.removeClass('success');
          if (log.getActions().team[self.data("id")] && log.getActions().team[self.data("id")].history) {
            $(this).parent().attr("title", "<p>" + log.getActions().team[self.data("id")].history[0] + "</p><p>Click again to edit/cancel</p>").tooltip('fixTitle').tooltip('hide');
          } else {
            $(this).parent().attr("title", "You disagreed - click again to edit/cancel").tooltip('fixTitle').tooltip('hide');
          }
        }
      });
      if (self.find('.btn-toggle input[type=checkbox]:not(:checked)').length == 1) {
        self.find('.btn-toggle input[type=checkbox]:not(:checked)').parent().addClass("inactive").attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
      }
      if (!any) {
        self.removeClass('danger');
        self.removeClass('active');
        self.removeClass('success');

        self.find('.btn-toggle.btn-yes').attr("title", "Click to agree with this action and save it in your agreed actions list  ").tooltip('fixTitle').tooltip('hide');
        self.find('.btn-toggle.btn-no').attr("title", "Click to disagree with this action and remove it from your suggested actions list ").tooltip('fixTitle').tooltip('hide');
      }

      base.wireUpTooltips();
    });

    base.wireUpTooltips();
  },

  populate: function(complete) {

    var k,l;
    //add tasks
    var teamTasks = [];
    var individualTasks = [];

    //Add the team tasks
    for (k in log.listActions("team")) {
      if (log.listActions("team")[k].agree && ((!log.listActions("team")[k].done && !complete) || (log.listActions("team")[k].done && complete))) {
        teamTasks.push({
          "pathway": "N/A",
          "task": log.text[log.listActions("team")[k].id].text,
          "data": log.listActions("team")[k].id,
          "tpId": "team",
          "agree": true,
          "done": complete
        });
      }
    }

    //Add the user added team tasks
    for (k in log.listPlans("team")) {
      if ((!log.listPlans("team")[k].done && !complete) || (log.listPlans("team")[k].done && complete)) {
        teamTasks.push({
          "canEdit": true,
          "pathway": data.pathwayNames[log.listPlans("team")[k].pathwayId],
          "pathwayId": log.listPlans("team")[k].pathwayId,
          "task": log.listPlans("team")[k].text,
          "data": log.listPlans("team")[k].id,
          "agree": log.listPlans("team")[k].agree,
          "disagree": log.listPlans("team")[k].agree === false,
          "done": complete
        });
      }
    }

    //Add individual
    for (k in log.listActions()) {
      if (k === "team") continue;
      for (l in log.listActions()[k]) {
        if (log.text[l] && log.listActions()[k][l].agree && ((!log.listActions()[k][l].done && !complete) || (log.listActions()[k][l].done && complete))) {
          individualTasks.push({
            "pathway": "N/A",
            "patientId": k,
            "task": log.text[l].text,
            "pathwayId": log.listPlans()[k][l].pathwayId,
            "data": l,
            "tpId": k,
            "agree": true,
            "done": complete
          });
        }
      }
    }

    //Add custom individual
    for (k in log.listPlans()) {
      if (k === "team") continue;
      for (l in log.listPlans()[k]) {
        if (log.listPlans()[k][l].text && (!log.listPlans()[k][l].done && !complete) || (log.listPlans()[k][l].done && complete)) {
          individualTasks.push({
            "canEdit": true,
            "pathway": data.pathwayNames[log.listPlans()[k][l].pathwayId],
            "pathwayId": log.listPlans()[k][l].pathwayId,
            "patientId": k,
            "tpId": k,
            "task": log.listPlans()[k][l].text,
            "data": l,
            "agree": true,
            "done": complete
          });
        }
      }
    }

    var listTemplate = $('#welcome-task-list').html();
    Mustache.parse(listTemplate);
    $('#welcome-tab-content').html(Mustache.render(listTemplate));

    var addTemplate = $('#action-plan').html();
    Mustache.parse(addTemplate);
    var rendered = Mustache.render(addTemplate);
    $('#team-add-plan').html(rendered);

    var tempMust = $('#welcome-task-items').html();
    var itemTemplate = $('#welcome-task-item').html();
    Mustache.parse(tempMust);
    Mustache.parse(itemTemplate);

    $('#team-add-plan').off('click').on('click', '.add-plan', function() {
      var plan = $(this).parent().parent().find('textarea').val();
      var planId = recordPlan("team", plan, "custom");
      $('#team-task-panel').find('table tbody').append(Mustache.render(itemTemplate, {
        "pathway": "",
        "pathwayId": "custom",
        "canEdit": true,
        "task": plan,
        "data": planId,
        "agree": null,
        "done": null
      }, {
        "chk": $('#checkbox-template').html()
      }));
    });

    rendered = Mustache.render(tempMust, {
      "tasks": teamTasks,
      "hasTasks": teamTasks.length > 0
    }, {
      "task-item": itemTemplate,
      "chk": $('#checkbox-template').html()
    });
    $('#team-task-panel').children().not(":first").remove();
    $('#team-task-panel').append(rendered);

    rendered = Mustache.render(tempMust, {
      "tasks": individualTasks,
      "isPatientTable": true,
      "hasTasks": individualTasks.length > 0
    }, {
      "task-item": itemTemplate,
      "chk": $('#checkbox-template').html()
    });
    $('#individual-task-panel').children().not(":first").remove();
    $('#individual-task-panel').append(rendered);

    welcome.wireUpWelcomePage();
  }

};

module.exports = welcome;

},{"../base.js":7,"../data.js":9,"../log.js":11,"./individualActionPlan.js":22,"./teamActionPlan.js":32,"mustache":4}],35:[function(require,module,exports){
var data = require('../data.js'),
  chart = require('../chart.js');

var bd = {

  wireUp: function() {

  },

  show: function(panel, isAppend, subPanels, isDownText, isUpText) {

    var sectionElement = $('<div class="section"></div>');

    if (isAppend) panel.append(sectionElement);
    else panel.html(sectionElement);

    subPanels.forEach(function(v) {
      var args = v.args;
      args.unshift(true);
      args.unshift(sectionElement);
      v.show.apply(null, args);
    });

    if (isUpText) sectionElement.prepend($('<div class="fp-controlArrow fp-up"><div>' + isUpText + '</div></div>'));
    if (isDownText) sectionElement.append($('<div class="fp-controlArrow fp-down"><div>' + isDownText + '</div></div>'));

  }

};

module.exports = bd;

},{"../chart.js":8,"../data.js":9}],36:[function(require,module,exports){
var data = require('./data.js'),
  lookup = require('./lookup.js'),
  base = require('./base.js'),
  patients = require('./panels/patients.js'),
  patientList = require('./panels/patientList.js'),
  teamActionPlan = require('./panels/teamActionPlan.js'),
  allPatients = require('./panels/allPatients.js'),
  welcome = require('./panels/welcome.js'),
  layout = require('./layout.js'),
  overview = require('./views/overview.js'),
  indicatorView = require('./views/indicator.js'),
  patientView = require('./views/patient.js'),
  actionPlan = require('./views/actions.js'),
  Mustache = require('mustache');

var template = {

  loadContent: function(hash, isPoppingState) {
    base.hideTooltips();

    var i, pathwayId, pathwayStage, standard, indicator, patientId;
    if (!isPoppingState) {
      window.location.hash = hash;
    }

    if (hash === '') {
      base.clearBox();
      base.showFooter();
      layout.showPage('login');
      $('html').removeClass('scroll-bar');
    } else {
      base.hideFooter();
      $('html').addClass('scroll-bar');
      var params = {};
      var urlBits = hash.split('/');

      if (hash.indexOf('?') > -1) {
        hash.split('?')[1].split('&').forEach(function(param) {
          var elems = param.split("=");
          params[elems[0]] = elems[1];
        });
        urlBits = hash.split('?')[0].split('/');
      }

      if (urlBits[0] === "#overview" && !urlBits[1]) {

        overview.create(template.loadContent);

      } else if (urlBits[0] === "#indicators") {

        indicatorView.create(urlBits[1], urlBits[2], urlBits[3], params.tab || "trend", template.loadContent);

      } else if (urlBits[0] === "#main") {
        base.clearBox();
        pathwayId = urlBits[1];
        data.pathwayId = pathwayId;
        pathwayStage = urlBits[2];
        var yesPeople = urlBits[3] !== "no";
        standard = urlBits[4];

        if (pathwayStage && layout.page !== 'main-dashboard') {
          $('.page').hide();
          $('#main-dashboard').show();

          ////layout.showSidePanel();
          layout.showOverviewPanels();
          layout.showHeaderBarItems();
        }

        if (pathwayStage) {
          if (yesPeople) {
            template.showPathwayStageViewOk(pathwayId, pathwayStage, template.shouldWeFade(lookup.currentUrl, hash));
          } else {
            template.showPathwayStageView(pathwayId, pathwayStage, standard, template.shouldWeFade(lookup.currentUrl, hash));
          }
        } else {
          template.showOverview(pathwayId);
        }

        base.wireUpTooltips();

      } else if (urlBits[0] === "#help") {
        base.clearBox();
        base.selectTab("");
        layout.showPage('help-page');

        layout.showHeaderBarItems();

      } else if (urlBits[0] === "#patient") {

        //create(pathwayId, pathwayStage, standard, patientId)
        patientView.create(urlBits[2], urlBits[3], urlBits[4], urlBits[1], template.loadContent);

      } else if (urlBits[0] === "#patients") {

        patientId = urlBits[1];

        patientView.create(null, null, null, patientId, template.loadContent);
        /*pathwayId = urlBits[2];

        allPatients.showView(patientId, true);

        base.wireUpTooltips();

        if (patientId) {
          var nhs = data.patLookup ? data.patLookup[patientId] : patientId;
          $('#patients').find('div.table-scroll').getNiceScroll().doScrollPos(0, $('#patients td').filter(function() {
            return $(this).text().trim() === nhs;
          }).position().top - 140);
          $('#patients').find('tr:contains(' + nhs + ')').addClass("highlighted");
        }*/
      } else if (urlBits[0] === "#agreedactions") {

        actionPlan.create();

      } else {
        //if screen not in correct segment then select it
        alert("shouldn't get here");
        pathwayStage = hash.substr(1);

        template.showPathwayStageView(pathwayStage);

        base.wireUpTooltips();
      }
    }

    lookup.currentUrl = hash;
  },

  //Show the overview page for a disease
  showOverview: function(disease) {
    data.pathwayId = disease;

    layout.showMainView(data.diseases.map(function(v) {
      return v.id;
    }).indexOf(disease));

    $('aside li ul li').removeClass('active');
    $('aside a[href="#main/' + disease + '"]:contains("Overview")').parent().addClass('active');

    $('#mainTitle').show();
    base.updateTitle(data.text[data.pathwayId]["display-name"] + ": Overview (practice-level data)");

    //Show overview panels
    template.showOverviewPanels();
    teamActionPlan.show(farRightPanel);
  },

  showOverviewPanels: function() {
    base.switchTo221Layout();

    template.showPanel(lookup.categories.diagnosis.name, topLeftPanel, true);
    template.showPanel(lookup.categories.monitoring.name, topRightPanel, true);
    template.showPanel(lookup.categories.treatment.name, bottomLeftPanel, true);
    template.showPanel(lookup.categories.exclusions.name, bottomRightPanel, true);

    base.wireUpTooltips();
  },

  showPanel: function(pathwayStage, location, enableHover) {
    base.showPathwayStageOverviewPanel(location, enableHover, data.pathwayId, pathwayStage);

    if (enableHover) template.highlightOnHoverAndEnableSelectByClick(location);
    else location.children('div').addClass('unclickable');
  },

  //Show the pathway stage for a disease
  showPathwayStageView: function(pathwayId, pathwayStage, standard, shouldFade) {
    farRightPanel.removeClass('standard-missed-page').removeClass('standard-achieved-page').removeClass('standard-not-relevant-page');
    data.pathwayId = pathwayId;
    layout.showMainView(data.diseases.map(function(v) {
      return v.id;
    }).indexOf(pathwayId));

    $('aside li ul li').removeClass('active');
    var re = new RegExp(pathwayStage, "g");
    $('aside a').filter(function() {
      return this.href.match(re);
    }).parent().addClass('active');

    base.switchTo110Layout();

    if (!standard) {
      standard = Object.keys(data[pathwayId][pathwayStage].standards)[0];
    }

    var panel = patients.create(pathwayId, pathwayStage, standard);

    if (shouldFade) {
      farLeftPanel.fadeOut(100, function() {
        $(this).html(panel);
        patients.wireUp(pathwayId, pathwayStage, farLeftPanel, standard);
        patientList.populate(pathwayId, pathwayStage, standard, null);
        $('#mainTitle').hide();
        base.updateTitle(data.text[pathwayId][pathwayStage].text.page.text, data.text[pathwayId][pathwayStage].text.page.tooltip);
        $(this).fadeIn(100);
      });
    } else {
      farLeftPanel.html(panel);
      patients.wireUp(pathwayId, pathwayStage, farLeftPanel, standard);
      patientList.populate(pathwayId, pathwayStage, standard, null);
      $('#mainTitle').hide();
      base.updateTitle(data.text[pathwayId][pathwayStage].text.page.text, data.text[pathwayId][pathwayStage].text.page.tooltip);
    }

    var tempMust = $('#patient-panel-placeholder').html();
    farRightPanel.html(Mustache.render(tempMust));
  },

  showPathwayStageViewOk: function(pathwayId, pathwayStage, shouldFade) {
    farRightPanel.removeClass('standard-missed-page').removeClass('standard-achieved-page').removeClass('standard-not-relevant-page');
    layout.showMainView(data.diseases.map(function(v) {
      return v.id;
    }).indexOf(pathwayId));

    $('aside li ul li').removeClass('active');
    var re = new RegExp(pathwayStage, "g");
    $('aside a').filter(function() {
      return this.href.match(re);
    }).parent().addClass('active');

    base.switchTo110Layout();

    var panel = patients.createOk(pathwayId, pathwayStage);

    if (shouldFade) {
      farLeftPanel.fadeOut(200, function() {
        $(this).html(panel);
        patients.wireUpOk(pathwayId, pathwayStage, farLeftPanel);
        patients.populateOk(pathwayId, pathwayStage, null);
        $('#mainTitle').hide();
        base.updateTitle(data.text[pathwayId][pathwayStage].text.page.text, data.text[pathwayId][pathwayStage].text.page.tooltip);
        $(this).fadeIn(300);
      });
      var tempMust = $('#patient-panel-placeholder').html();
      farRightPanel.html(Mustache.render(tempMust));
    } else {
      farLeftPanel.html(panel);
      patients.wireUpOk(pathwayId, pathwayStage, farLeftPanel);
      patients.populateOk(pathwayId, pathwayStage, null);
      $('#mainTitle').hide();
      base.updateTitle(data.text[pathwayId][pathwayStage].text.page.text, data.text[pathwayId][pathwayStage].text.page.tooltip);
    }
  },

  highlightOnHoverAndEnableSelectByClick: function(panelSelector) {
    panelSelector.children('div').removeClass('unclickable').on('mouseover', function() {
      $(this).removeClass('panel-default');
    }).on('mouseout', function(e) {
      $(this).addClass('panel-default');
    }).on('click', 'tr.standard-row', function(e) {
      history.pushState(null, null, '#main/' + data.pathwayId + '/' + $(this).closest('.panel').data('stage') + '/no/' + $(this).data('standard'));
      template.loadContent('#main/' + data.pathwayId + '/' + $(this).closest('.panel').data('stage') + '/no/' + $(this).data('standard'), true);
      // do not give a default action
      e.preventDefault();
      e.stopPropagation();
      return false;
    }).on('click', function(e) {
      // keep the link in the browser history
      history.pushState(null, null, '#main/' + data.pathwayId + '/' + $(this).data('stage') + '/no');
      template.loadContent('#main/' + data.pathwayId + '/' + $(this).data('stage') + '/no', true);
      // do not give a default action
      return false;
    });

  },

  displaySelectedPatient: function(id) {
    var nhs = data.patLookup ? data.patLookup[id] : id;

    history.pushState(null, null, '#patients/' + id);
    template.loadContent('#patients/' + id, true);

    $('.list-item').removeClass('highlighted');
    $('.list-item:has(button[data-clipboard-text=' + nhs + '])').addClass('highlighted');

    //scroll to patients
    $('#patients').find('div.table-scroll').getNiceScroll().doScrollPos(0, $('#patients td').filter(function() {
      return $(this).text().trim() === nhs;
    }).position().top - 140);
  },

  shouldWeFade: function(oldHash, newHash) {
    oldHash = oldHash.split('/');
    newHash = newHash.split('/');

    if (oldHash[0] === newHash[0] && oldHash[1] === newHash[1] && oldHash[2] === newHash[2] && oldHash[0] && newHash[0]) return false;
    return true;
  }

};

module.exports = template;

},{"./base.js":7,"./data.js":9,"./layout.js":10,"./lookup.js":12,"./panels/allPatients.js":15,"./panels/patientList.js":27,"./panels/patients.js":29,"./panels/teamActionPlan.js":32,"./panels/welcome.js":34,"./views/actions.js":37,"./views/indicator.js":38,"./views/overview.js":39,"./views/patient.js":40,"mustache":4}],37:[function(require,module,exports){
var base = require('../base.js'),
  layout = require('../layout.js'),
  welcome = require('../panels/welcome.js');

var ID = "ACTION_PLAN_VIEW";

var ap = {

  create: function() {

    base.selectTab("actions");

    if(layout.view !== ID) {
      //Not already in this view so we need to rejig a few things
      base.clearBox();
      layout.showPage('welcome');
      layout.showHeaderBarItems();

      $('#welcome-tabs li').removeClass('active');
      $('#outstandingTasks').closest('li').addClass('active');

      layout.view = ID;
    }

    welcome.populate();

  }

};

module.exports = ap;

},{"../base.js":7,"../layout.js":10,"../panels/welcome.js":34}],38:[function(require,module,exports){
var base = require('../base.js'),
  data = require('../data.js'),
  patientList = require('../panels/patientList.js'),
  indicatorBreakdown = require('../panels/indicatorBreakdown.js'),
  indicatorBenchmark = require('../panels/indicatorBenchmark.js'),
  indicatorTrend = require('../panels/indicatorTrend.js'),
  indicatorHeadlines = require('../panels/indicatorHeadlines.js'),
  teamActionPlan = require('../panels/teamActionPlan.js'),
  wrapper = require('../panels/wrapper.js'),
  layout = require('../layout.js');

var ID = "INDICATOR";
/*
 * The indicator page consists of the panels:
 *   Tabbed panel
 *     - performance trend
 *     - performance benchmark
 *   Patient groups
 *   Patient list
 *   Team action plan
 */

var ind = {

  create: function(pathwayId, pathwayStage, standard, tab, loadContentFn) {

    base.selectTab("indicator");
    base.showLoading();

    //use a setTimeout to force the UI to change e.g. show the loading-container
    //before further execution
    setTimeout(function() {
      if (layout.view !== ID) {
        //Not already in this view so we need to rejig a few things
        base.clearBox();
        //base.switchTo21Layout();
        layout.showMainView();

        base.removeFullPage(farRightPanel);
        base.hidePanels(farRightPanel);

        layout.view = ID;
      }

      if (!pathwayId) {
        if (layout.pathwayId) pathwayId = layout.pathwayId;
        else pathwayId = Object.keys(data.pathwayNames)[0];
      }

      if (!pathwayStage) {
        if (layout.pathwayStage) pathwayStage = layout.pathwayStage;
        else pathwayStage = Object.keys(data.text[pathwayId])[0];
      }

      if (!standard) {
        if (layout.standard) standard = layout.standard;
        else standard = Object.keys(data.text[pathwayId][pathwayStage].standards)[0];
      }

      //if (layout.pathwayId !== pathwayId || layout.pathwayStage !== pathwayStage) {
        //different pathway or stage so title needs updating
        base.updateTitle(data.text[pathwayId][pathwayStage].standards[standard].name);
        /*base.updateTitle([{
          title: "Overview",
          url: "#overview"
        }, {
          title: data.text[pathwayId][pathwayStage].text.page.text,
          tooltip: data.text[pathwayId][pathwayStage].text.page.tooltip
        }]);
        $('#mainTitle').show();*/
      //}

      layout.pathwayId = pathwayId;
      layout.pathwayStage = pathwayStage;
      layout.standard = standard;

      //TODO not sure if this needs moving..?
      data.pathwayId = pathwayId;

      //The three panels we need to show
      //Panels decide whether they need to redraw themselves
      teamActionPlan.show(farLeftPanel);

      base.updateTab("indicators", [pathwayId.toUpperCase(), standard.toUpperCase()].join(" "), [pathwayId, pathwayStage, standard].join("/"));

      wrapper.show(farRightPanel, false, [
        {
          show: indicatorHeadlines.show,
          args: [pathwayId, pathwayStage, standard]
        }, {
          show: indicatorBreakdown.show,
          args: [pathwayId, pathwayStage, standard, patientList.selectSubsection]
        }, {
          show: patientList.show,
          args: [pathwayId, pathwayStage, standard, loadContentFn]
        }
      ], "Performance over time", false);
      wrapper.show(farRightPanel, true, [
        {
          show: indicatorTrend.show,
          args: [pathwayId, pathwayStage, standard]
        }
      ], "Benchmarking", "Patients at risk");
      wrapper.show(farRightPanel, true, [
        {
          show: indicatorBenchmark.show,
          args: [pathwayId, pathwayStage, standard]
        }
      ], false, "Performance over time");

      base.addFullPage(farRightPanel);

      $('#indicator-pane').show();

      base.wireUpTooltips();

      /*setTimeout($('.fp-controlArrow').each(function(idx, el) {
        if(el.is(":visible"))
      }), 2000);*/

      base.hideLoading();
    }, 0);
  }

};

module.exports = ind;

},{"../base.js":7,"../data.js":9,"../layout.js":10,"../panels/indicatorBenchmark.js":17,"../panels/indicatorBreakdown.js":18,"../panels/indicatorHeadlines.js":19,"../panels/indicatorTrend.js":21,"../panels/patientList.js":27,"../panels/teamActionPlan.js":32,"../panels/wrapper.js":35}],39:[function(require,module,exports){
var base = require('../base.js'),
  data = require('../data.js'),
  layout = require('../layout.js'),
  indicatorList = require('../panels/indicatorList.js'),
  teamActionPlan = require('../panels/teamActionPlan.js');

var ID = "OVERVIEW";
/*
 * The overview page consists of the panels:
 *   Indicator list
 *   Team action plan
 */
var overview = {

  create: function(loadContentFn) {

    base.selectTab("overview");
    base.showLoading();

    //use a setTimeout to force the UI to change e.g. show the loading-container
    //before further execution
    setTimeout(function() {

      if (layout.view !== ID) {
        //Not already in this view so we need to rejig a few things
        base.clearBox();
        //base.switchTo101Layout();
        layout.showMainView();

        $('#mainTitle').show();
        base.updateTitle("Overview of your practice performance");

        base.removeFullPage(farRightPanel);
        base.hidePanels(farRightPanel);

        layout.view = ID;
      }

      data.pathwayId = "htn"; //TODO fudge

      //The two panels we need to show
      //Panels decide whether they need to redraw themselves
      teamActionPlan.show(farLeftPanel);
      indicatorList.show(farRightPanel, false, loadContentFn);

      $('#overview-pane').show();

      base.wireUpTooltips();
      base.hideLoading();
    }, 0);

  }

};

module.exports = overview;

},{"../base.js":7,"../data.js":9,"../layout.js":10,"../panels/indicatorList.js":20,"../panels/teamActionPlan.js":32}],40:[function(require,module,exports){
var lifeline = require('../panels/lifeline.js'),
  data = require('../data.js'),
  base = require('../base.js'),
  layout = require('../layout.js'),
  individualActionPlan = require('../panels/individualActionPlan.js'),
  qualityStandards = require('../panels/qualityStandards.js'),
  patientCharacteristics = require('../panels/patientCharacteristics.js'),
  patientSearch = require('../panels/patientSearch.js');

var ID = "PATIENT_VIEW";
/*
 * The patient page consists of the panels:
 *   Lifeline chart
 *   Individual action plan
 */

var pv = {

  wireUp: function() {

  },

  create: function(pathwayId, pathwayStage, standard, patientId, loadContentFn) {

    base.selectTab("patient");
    base.showLoading();

    //use a setTimeout to force the UI to change e.g. show the loading-container
    //before further execution
    setTimeout(function() {

      data.getPatientData(patientId, function(patientData) {
        if (layout.view !== ID) {
          //Not already in this view so we need to rejig a few things
          base.clearBox();
          //base.switchTo21Layout();
          layout.showMainView();

          base.removeFullPage(farRightPanel);
          base.hidePanels(farRightPanel);

          layout.view = ID;
        }

        if (layout.pathwayId !== pathwayId || layout.pathwayStage !== pathwayStage ||
          layout.standard !== standard || layout.patientId !== patientId) {
          //different pathway or stage or patientId so title needs updating
          $('#mainTitle').show();

          var patid = (data.patLookup && data.patLookup[patientId] ? data.patLookup[patientId] : patientId);
          var sex = patientData.characteristics.sex.toLowerCase()==="m" ?
            "male" : (patientData.characteristics.sex.toLowerCase()==="f" ? "female" : patientData.characteristics.sex.toLowerCase())
          ;
          base.updateTitle("Patient " + patid +
            " - " + patientData.characteristics.age + " year old " + sex);
        }


        base.hidePanels(farLeftPanel);


        if (patientId) {
          base.updateTab("patients", data.patLookup[patientId] || patientId, patientId);

          layout.patientId = patientId;
          data.patientId = patientId;
          data.pathwayId = pathwayId;

          patientSearch.show($('#title-right'), true, loadContentFn);
          qualityStandards.show(farRightPanel, false, patientId);

          lifeline.show(farRightPanel, true, patientId, patientData);
          individualActionPlan.show(farLeftPanel, pathwayId, pathwayStage, standard, patientId);

          patientSearch.wireUp();
          $('#patient-pane').show();
        } else {
          base.updateTitle("No patient currently selected");

          patientSearch.show(farRightPanel, true, loadContentFn);
        }

        base.wireUpTooltips();
        base.hideLoading();

      });
    }, 0);

  },

  populate: function() {

  }

};

module.exports = pv;

},{"../base.js":7,"../data.js":9,"../layout.js":10,"../panels/individualActionPlan.js":22,"../panels/lifeline.js":23,"../panels/patientCharacteristics.js":26,"../panels/patientSearch.js":28,"../panels/qualityStandards.js":31}]},{},[6])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvaGlnaGNoYXJ0cy9oaWdoY2hhcnRzLW1vcmUuanMiLCJub2RlX21vZHVsZXMvaGlnaGNoYXJ0cy9oaWdoc3RvY2suanMiLCJub2RlX21vZHVsZXMvanF1ZXJ5LXNwYXJrbGluZS9qcXVlcnkuc3BhcmtsaW5lLmpzIiwibm9kZV9tb2R1bGVzL211c3RhY2hlL211c3RhY2hlLmpzIiwibm9kZV9tb2R1bGVzL3plcm9jbGlwYm9hcmQvZGlzdC9aZXJvQ2xpcGJvYXJkLmpzIiwic2NyaXB0LmpzIiwic3JjL2Jhc2UuanMiLCJzcmMvY2hhcnQuanMiLCJzcmMvZGF0YS5qcyIsInNyYy9sYXlvdXQuanMiLCJzcmMvbG9nLmpzIiwic3JjL2xvb2t1cC5qcyIsInNyYy9tYWluLmpzIiwic3JjL25vdGlmeS5qcyIsInNyYy9wYW5lbHMvYWxsUGF0aWVudHMuanMiLCJzcmMvcGFuZWxzL2NvbmZpcm0uanMiLCJzcmMvcGFuZWxzL2luZGljYXRvckJlbmNobWFyay5qcyIsInNyYy9wYW5lbHMvaW5kaWNhdG9yQnJlYWtkb3duLmpzIiwic3JjL3BhbmVscy9pbmRpY2F0b3JIZWFkbGluZXMuanMiLCJzcmMvcGFuZWxzL2luZGljYXRvckxpc3QuanMiLCJzcmMvcGFuZWxzL2luZGljYXRvclRyZW5kLmpzIiwic3JjL3BhbmVscy9pbmRpdmlkdWFsQWN0aW9uUGxhbi5qcyIsInNyYy9wYW5lbHMvbGlmZWxpbmUuanMiLCJzcmMvcGFuZWxzL21lZGljYXRpb24uanMiLCJzcmMvcGFuZWxzL290aGVyQ29kZXMuanMiLCJzcmMvcGFuZWxzL3BhdGllbnRDaGFyYWN0ZXJpc3RpY3MuanMiLCJzcmMvcGFuZWxzL3BhdGllbnRMaXN0LmpzIiwic3JjL3BhbmVscy9wYXRpZW50U2VhcmNoLmpzIiwic3JjL3BhbmVscy9wYXRpZW50cy5qcyIsInNyYy9wYW5lbHMvcXVhbGl0eVN0YW5kYXJkLmpzIiwic3JjL3BhbmVscy9xdWFsaXR5U3RhbmRhcmRzLmpzIiwic3JjL3BhbmVscy90ZWFtQWN0aW9uUGxhbi5qcyIsInNyYy9wYW5lbHMvdHJlbmQuanMiLCJzcmMvcGFuZWxzL3dlbGNvbWUuanMiLCJzcmMvcGFuZWxzL3dyYXBwZXIuanMiLCJzcmMvdGVtcGxhdGUuanMiLCJzcmMvdmlld3MvYWN0aW9ucy5qcyIsInNyYy92aWV3cy9pbmRpY2F0b3IuanMiLCJzcmMvdmlld3Mvb3ZlcnZpZXcuanMiLCJzcmMvdmlld3MvcGF0aWVudC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xiQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2L0ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNybkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BoRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2YkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcm9CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlnQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9JQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqVUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNaQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN05BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3WkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM3JCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDellBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzVkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOWNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyU0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIi8qXG4gSGlnaGNoYXJ0cyBKUyB2NC4yLjQgKDIwMTYtMDQtMTQpXG5cbiAoYykgMjAwOS0yMDE2IFRvcnN0ZWluIEhvbnNpXG5cbiBMaWNlbnNlOiB3d3cuaGlnaGNoYXJ0cy5jb20vbGljZW5zZVxuKi9cbihmdW5jdGlvbihtKXt0eXBlb2YgbW9kdWxlPT09XCJvYmplY3RcIiYmbW9kdWxlLmV4cG9ydHM/bW9kdWxlLmV4cG9ydHM9bTptKEhpZ2hjaGFydHMpfSkoZnVuY3Rpb24obSl7ZnVuY3Rpb24gTChhLGIsYyl7dGhpcy5pbml0KGEsYixjKX12YXIgUT1tLmFycmF5TWluLFI9bS5hcnJheU1heCx0PW0uZWFjaCxIPW0uZXh0ZW5kLHU9bS5tZXJnZSxTPW0ubWFwLG89bS5waWNrLEI9bS5wSW50LEc9bS5jb3JyZWN0RmxvYXQscD1tLmdldE9wdGlvbnMoKS5wbG90T3B0aW9ucyxpPW0uc2VyaWVzVHlwZXMsdj1tLmV4dGVuZENsYXNzLE09bS5zcGxhdCx3PW0ud3JhcCxOPW0uQXhpcyx6PW0uVGljayxJPW0uUG9pbnQsVD1tLlBvaW50ZXIsVT1tLkNlbnRlcmVkU2VyaWVzTWl4aW4sQz1tLlRyYWNrZXJNaXhpbix4PW0uU2VyaWVzLHk9TWF0aCxGPXkucm91bmQsRD15LmZsb29yLE89eS5tYXgsVj1tLkNvbG9yLHI9ZnVuY3Rpb24oKXt9O0goTC5wcm90b3R5cGUse2luaXQ6ZnVuY3Rpb24oYSxiLFxuYyl7dmFyIGQ9dGhpcyxnPWQuZGVmYXVsdE9wdGlvbnM7ZC5jaGFydD1iO2Qub3B0aW9ucz1hPXUoZyxiLmFuZ3VsYXI/e2JhY2tncm91bmQ6e319OnZvaWQgMCxhKTsoYT1hLmJhY2tncm91bmQpJiZ0KFtdLmNvbmNhdChNKGEpKS5yZXZlcnNlKCksZnVuY3Rpb24oYSl7dmFyIGI9YS5iYWNrZ3JvdW5kQ29sb3IsZz1jLnVzZXJPcHRpb25zLGE9dShkLmRlZmF1bHRCYWNrZ3JvdW5kT3B0aW9ucyxhKTtpZihiKWEuYmFja2dyb3VuZENvbG9yPWI7YS5jb2xvcj1hLmJhY2tncm91bmRDb2xvcjtjLm9wdGlvbnMucGxvdEJhbmRzLnVuc2hpZnQoYSk7Zy5wbG90QmFuZHM9Zy5wbG90QmFuZHN8fFtdO2cucGxvdEJhbmRzIT09Yy5vcHRpb25zLnBsb3RCYW5kcyYmZy5wbG90QmFuZHMudW5zaGlmdChhKX0pfSxkZWZhdWx0T3B0aW9uczp7Y2VudGVyOltcIjUwJVwiLFwiNTAlXCJdLHNpemU6XCI4NSVcIixzdGFydEFuZ2xlOjB9LGRlZmF1bHRCYWNrZ3JvdW5kT3B0aW9uczp7c2hhcGU6XCJjaXJjbGVcIixcbmJvcmRlcldpZHRoOjEsYm9yZGVyQ29sb3I6XCJzaWx2ZXJcIixiYWNrZ3JvdW5kQ29sb3I6e2xpbmVhckdyYWRpZW50Ont4MTowLHkxOjAseDI6MCx5MjoxfSxzdG9wczpbWzAsXCIjRkZGXCJdLFsxLFwiI0RERFwiXV19LGZyb206LU51bWJlci5NQVhfVkFMVUUsaW5uZXJSYWRpdXM6MCx0bzpOdW1iZXIuTUFYX1ZBTFVFLG91dGVyUmFkaXVzOlwiMTA1JVwifX0pO3ZhciBBPU4ucHJvdG90eXBlLHo9ei5wcm90b3R5cGUsVz17Z2V0T2Zmc2V0OnIscmVkcmF3OmZ1bmN0aW9uKCl7dGhpcy5pc0RpcnR5PSExfSxyZW5kZXI6ZnVuY3Rpb24oKXt0aGlzLmlzRGlydHk9ITF9LHNldFNjYWxlOnIsc2V0Q2F0ZWdvcmllczpyLHNldFRpdGxlOnJ9LFA9e2lzUmFkaWFsOiEwLGRlZmF1bHRSYWRpYWxHYXVnZU9wdGlvbnM6e2xhYmVsczp7YWxpZ246XCJjZW50ZXJcIix4OjAseTpudWxsfSxtaW5vckdyaWRMaW5lV2lkdGg6MCxtaW5vclRpY2tJbnRlcnZhbDpcImF1dG9cIixtaW5vclRpY2tMZW5ndGg6MTAsbWlub3JUaWNrUG9zaXRpb246XCJpbnNpZGVcIixcbm1pbm9yVGlja1dpZHRoOjEsdGlja0xlbmd0aDoxMCx0aWNrUG9zaXRpb246XCJpbnNpZGVcIix0aWNrV2lkdGg6Mix0aXRsZTp7cm90YXRpb246MH0sekluZGV4OjJ9LGRlZmF1bHRSYWRpYWxYT3B0aW9uczp7Z3JpZExpbmVXaWR0aDoxLGxhYmVsczp7YWxpZ246bnVsbCxkaXN0YW5jZToxNSx4OjAseTpudWxsfSxtYXhQYWRkaW5nOjAsbWluUGFkZGluZzowLHNob3dMYXN0TGFiZWw6ITEsdGlja0xlbmd0aDowfSxkZWZhdWx0UmFkaWFsWU9wdGlvbnM6e2dyaWRMaW5lSW50ZXJwb2xhdGlvbjpcImNpcmNsZVwiLGxhYmVsczp7YWxpZ246XCJyaWdodFwiLHg6LTMseTotMn0sc2hvd0xhc3RMYWJlbDohMSx0aXRsZTp7eDo0LHRleHQ6bnVsbCxyb3RhdGlvbjo5MH19LHNldE9wdGlvbnM6ZnVuY3Rpb24oYSl7YT10aGlzLm9wdGlvbnM9dSh0aGlzLmRlZmF1bHRPcHRpb25zLHRoaXMuZGVmYXVsdFJhZGlhbE9wdGlvbnMsYSk7aWYoIWEucGxvdEJhbmRzKWEucGxvdEJhbmRzPVtdfSxnZXRPZmZzZXQ6ZnVuY3Rpb24oKXtBLmdldE9mZnNldC5jYWxsKHRoaXMpO1xudGhpcy5jaGFydC5heGlzT2Zmc2V0W3RoaXMuc2lkZV09MDt0aGlzLmNlbnRlcj10aGlzLnBhbmUuY2VudGVyPVUuZ2V0Q2VudGVyLmNhbGwodGhpcy5wYW5lKX0sZ2V0TGluZVBhdGg6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmNlbnRlcixiPW8oYixjWzJdLzItdGhpcy5vZmZzZXQpO3JldHVybiB0aGlzLmNoYXJ0LnJlbmRlcmVyLnN5bWJvbHMuYXJjKHRoaXMubGVmdCtjWzBdLHRoaXMudG9wK2NbMV0sYixiLHtzdGFydDp0aGlzLnN0YXJ0QW5nbGVSYWQsZW5kOnRoaXMuZW5kQW5nbGVSYWQsb3BlbjohMCxpbm5lclI6MH0pfSxzZXRBeGlzVHJhbnNsYXRpb246ZnVuY3Rpb24oKXtBLnNldEF4aXNUcmFuc2xhdGlvbi5jYWxsKHRoaXMpO2lmKHRoaXMuY2VudGVyKXRoaXMudHJhbnNBPXRoaXMuaXNDaXJjdWxhcj8odGhpcy5lbmRBbmdsZVJhZC10aGlzLnN0YXJ0QW5nbGVSYWQpLyh0aGlzLm1heC10aGlzLm1pbnx8MSk6dGhpcy5jZW50ZXJbMl0vMi8odGhpcy5tYXgtdGhpcy5taW58fFxuMSksdGhpcy5taW5QaXhlbFBhZGRpbmc9dGhpcy5pc1hBeGlzP3RoaXMudHJhbnNBKnRoaXMubWluUG9pbnRPZmZzZXQ6MH0sYmVmb3JlU2V0VGlja1Bvc2l0aW9uczpmdW5jdGlvbigpe3RoaXMuYXV0b0Nvbm5lY3QmJih0aGlzLm1heCs9dGhpcy5jYXRlZ29yaWVzJiYxfHx0aGlzLnBvaW50UmFuZ2V8fHRoaXMuY2xvc2VzdFBvaW50UmFuZ2V8fDApfSxzZXRBeGlzU2l6ZTpmdW5jdGlvbigpe0Euc2V0QXhpc1NpemUuY2FsbCh0aGlzKTtpZih0aGlzLmlzUmFkaWFsKXt0aGlzLmNlbnRlcj10aGlzLnBhbmUuY2VudGVyPW0uQ2VudGVyZWRTZXJpZXNNaXhpbi5nZXRDZW50ZXIuY2FsbCh0aGlzLnBhbmUpO2lmKHRoaXMuaXNDaXJjdWxhcil0aGlzLnNlY3Rvcj10aGlzLmVuZEFuZ2xlUmFkLXRoaXMuc3RhcnRBbmdsZVJhZDt0aGlzLmxlbj10aGlzLndpZHRoPXRoaXMuaGVpZ2h0PXRoaXMuY2VudGVyWzJdKm8odGhpcy5zZWN0b3IsMSkvMn19LGdldFBvc2l0aW9uOmZ1bmN0aW9uKGEsXG5iKXtyZXR1cm4gdGhpcy5wb3N0VHJhbnNsYXRlKHRoaXMuaXNDaXJjdWxhcj90aGlzLnRyYW5zbGF0ZShhKTowLG8odGhpcy5pc0NpcmN1bGFyP2I6dGhpcy50cmFuc2xhdGUoYSksdGhpcy5jZW50ZXJbMl0vMiktdGhpcy5vZmZzZXQpfSxwb3N0VHJhbnNsYXRlOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5jaGFydCxkPXRoaXMuY2VudGVyLGE9dGhpcy5zdGFydEFuZ2xlUmFkK2E7cmV0dXJue3g6Yy5wbG90TGVmdCtkWzBdK01hdGguY29zKGEpKmIseTpjLnBsb3RUb3ArZFsxXStNYXRoLnNpbihhKSpifX0sZ2V0UGxvdEJhbmRQYXRoOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD10aGlzLmNlbnRlcixnPXRoaXMuc3RhcnRBbmdsZVJhZCxlPWRbMl0vMixqPVtvKGMub3V0ZXJSYWRpdXMsXCIxMDAlXCIpLGMuaW5uZXJSYWRpdXMsbyhjLnRoaWNrbmVzcywxMCldLGw9LyUkLyxoLGY9dGhpcy5pc0NpcmN1bGFyO3RoaXMub3B0aW9ucy5ncmlkTGluZUludGVycG9sYXRpb249PT1cInBvbHlnb25cIj9cbmQ9dGhpcy5nZXRQbG90TGluZVBhdGgoYSkuY29uY2F0KHRoaXMuZ2V0UGxvdExpbmVQYXRoKGIsITApKTooYT1NYXRoLm1heChhLHRoaXMubWluKSxiPU1hdGgubWluKGIsdGhpcy5tYXgpLGZ8fChqWzBdPXRoaXMudHJhbnNsYXRlKGEpLGpbMV09dGhpcy50cmFuc2xhdGUoYikpLGo9UyhqLGZ1bmN0aW9uKGEpe2wudGVzdChhKSYmKGE9QihhLDEwKSplLzEwMCk7cmV0dXJuIGF9KSxjLnNoYXBlPT09XCJjaXJjbGVcInx8IWY/KGE9LU1hdGguUEkvMixiPU1hdGguUEkqMS41LGg9ITApOihhPWcrdGhpcy50cmFuc2xhdGUoYSksYj1nK3RoaXMudHJhbnNsYXRlKGIpKSxkPXRoaXMuY2hhcnQucmVuZGVyZXIuc3ltYm9scy5hcmModGhpcy5sZWZ0K2RbMF0sdGhpcy50b3ArZFsxXSxqWzBdLGpbMF0se3N0YXJ0Ok1hdGgubWluKGEsYiksZW5kOk1hdGgubWF4KGEsYiksaW5uZXJSOm8oalsxXSxqWzBdLWpbMl0pLG9wZW46aH0pKTtyZXR1cm4gZH0sZ2V0UGxvdExpbmVQYXRoOmZ1bmN0aW9uKGEsXG5iKXt2YXIgYz10aGlzLGQ9Yy5jZW50ZXIsZz1jLmNoYXJ0LGU9Yy5nZXRQb3NpdGlvbihhKSxqLGwsaDtjLmlzQ2lyY3VsYXI/aD1bXCJNXCIsZFswXStnLnBsb3RMZWZ0LGRbMV0rZy5wbG90VG9wLFwiTFwiLGUueCxlLnldOmMub3B0aW9ucy5ncmlkTGluZUludGVycG9sYXRpb249PT1cImNpcmNsZVwiPyhhPWMudHJhbnNsYXRlKGEpKSYmKGg9Yy5nZXRMaW5lUGF0aCgwLGEpKToodChnLnhBeGlzLGZ1bmN0aW9uKGEpe2EucGFuZT09PWMucGFuZSYmKGo9YSl9KSxoPVtdLGE9Yy50cmFuc2xhdGUoYSksZD1qLnRpY2tQb3NpdGlvbnMsai5hdXRvQ29ubmVjdCYmKGQ9ZC5jb25jYXQoW2RbMF1dKSksYiYmKGQ9W10uY29uY2F0KGQpLnJldmVyc2UoKSksdChkLGZ1bmN0aW9uKGUsYil7bD1qLmdldFBvc2l0aW9uKGUsYSk7aC5wdXNoKGI/XCJMXCI6XCJNXCIsbC54LGwueSl9KSk7cmV0dXJuIGh9LGdldFRpdGxlUG9zaXRpb246ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmNlbnRlcixiPXRoaXMuY2hhcnQsXG5jPXRoaXMub3B0aW9ucy50aXRsZTtyZXR1cm57eDpiLnBsb3RMZWZ0K2FbMF0rKGMueHx8MCkseTpiLnBsb3RUb3ArYVsxXS17aGlnaDowLjUsbWlkZGxlOjAuMjUsbG93OjB9W2MuYWxpZ25dKmFbMl0rKGMueXx8MCl9fX07dyhBLFwiaW5pdFwiLGZ1bmN0aW9uKGEsYixjKXt2YXIgazt2YXIgZD1iLmFuZ3VsYXIsZz1iLnBvbGFyLGU9Yy5pc1gsaj1kJiZlLGwsaDtoPWIub3B0aW9uczt2YXIgZj1jLnBhbmV8fDA7aWYoZCl7aWYoSCh0aGlzLGo/VzpQKSxsPSFlKXRoaXMuZGVmYXVsdFJhZGlhbE9wdGlvbnM9dGhpcy5kZWZhdWx0UmFkaWFsR2F1Z2VPcHRpb25zfWVsc2UgaWYoZylIKHRoaXMsUCksdGhpcy5kZWZhdWx0UmFkaWFsT3B0aW9ucz0obD1lKT90aGlzLmRlZmF1bHRSYWRpYWxYT3B0aW9uczp1KHRoaXMuZGVmYXVsdFlBeGlzT3B0aW9ucyx0aGlzLmRlZmF1bHRSYWRpYWxZT3B0aW9ucyk7YS5jYWxsKHRoaXMsYixjKTtpZighaiYmKGR8fGcpKXthPXRoaXMub3B0aW9ucztpZighYi5wYW5lcyliLnBhbmVzPVxuW107dGhpcy5wYW5lPShrPWIucGFuZXNbZl09Yi5wYW5lc1tmXXx8bmV3IEwoTShoLnBhbmUpW2ZdLGIsdGhpcyksZj1rKTtmPWYub3B0aW9ucztiLmludmVydGVkPSExO2guY2hhcnQuem9vbVR5cGU9bnVsbDt0aGlzLnN0YXJ0QW5nbGVSYWQ9Yj0oZi5zdGFydEFuZ2xlLTkwKSpNYXRoLlBJLzE4MDt0aGlzLmVuZEFuZ2xlUmFkPWg9KG8oZi5lbmRBbmdsZSxmLnN0YXJ0QW5nbGUrMzYwKS05MCkqTWF0aC5QSS8xODA7dGhpcy5vZmZzZXQ9YS5vZmZzZXR8fDA7aWYoKHRoaXMuaXNDaXJjdWxhcj1sKSYmYy5tYXg9PT12b2lkIDAmJmgtYj09PTIqTWF0aC5QSSl0aGlzLmF1dG9Db25uZWN0PSEwfX0pO3coQSxcImF1dG9MYWJlbEFsaWduXCIsZnVuY3Rpb24oYSl7aWYoIXRoaXMuaXNSYWRpYWwpcmV0dXJuIGEuYXBwbHkodGhpcyxbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSl9KTt3KHosXCJnZXRQb3NpdGlvblwiLGZ1bmN0aW9uKGEsYixjLGQsZyl7dmFyIGU9dGhpcy5heGlzO3JldHVybiBlLmdldFBvc2l0aW9uP1xuZS5nZXRQb3NpdGlvbihjKTphLmNhbGwodGhpcyxiLGMsZCxnKX0pO3coeixcImdldExhYmVsUG9zaXRpb25cIixmdW5jdGlvbihhLGIsYyxkLGcsZSxqLGwsaCl7dmFyIGY9dGhpcy5heGlzLGs9ZS55LG49MjAscz1lLmFsaWduLGk9KGYudHJhbnNsYXRlKHRoaXMucG9zKStmLnN0YXJ0QW5nbGVSYWQrTWF0aC5QSS8yKS9NYXRoLlBJKjE4MCUzNjA7Zi5pc1JhZGlhbD8oYT1mLmdldFBvc2l0aW9uKHRoaXMucG9zLGYuY2VudGVyWzJdLzIrbyhlLmRpc3RhbmNlLC0yNSkpLGUucm90YXRpb249PT1cImF1dG9cIj9kLmF0dHIoe3JvdGF0aW9uOml9KTprPT09bnVsbCYmKGs9Zi5jaGFydC5yZW5kZXJlci5mb250TWV0cmljcyhkLnN0eWxlcy5mb250U2l6ZSkuYi1kLmdldEJCb3goKS5oZWlnaHQvMikscz09PW51bGwmJihmLmlzQ2lyY3VsYXI/KHRoaXMubGFiZWwuZ2V0QkJveCgpLndpZHRoPmYubGVuKmYudGlja0ludGVydmFsLyhmLm1heC1mLm1pbikmJihuPTApLHM9aT5uJiZpPDE4MC1uP1xuXCJsZWZ0XCI6aT4xODArbiYmaTwzNjAtbj9cInJpZ2h0XCI6XCJjZW50ZXJcIik6cz1cImNlbnRlclwiLGQuYXR0cih7YWxpZ246c30pKSxhLngrPWUueCxhLnkrPWspOmE9YS5jYWxsKHRoaXMsYixjLGQsZyxlLGosbCxoKTtyZXR1cm4gYX0pO3coeixcImdldE1hcmtQYXRoXCIsZnVuY3Rpb24oYSxiLGMsZCxnLGUsail7dmFyIGw9dGhpcy5heGlzO2wuaXNSYWRpYWw/KGE9bC5nZXRQb3NpdGlvbih0aGlzLnBvcyxsLmNlbnRlclsyXS8yK2QpLGI9W1wiTVwiLGIsYyxcIkxcIixhLngsYS55XSk6Yj1hLmNhbGwodGhpcyxiLGMsZCxnLGUsaik7cmV0dXJuIGJ9KTtwLmFyZWFyYW5nZT11KHAuYXJlYSx7bGluZVdpZHRoOjEsbWFya2VyOm51bGwsdGhyZXNob2xkOm51bGwsdG9vbHRpcDp7cG9pbnRGb3JtYXQ6JzxzcGFuIHN0eWxlPVwiY29sb3I6e3Nlcmllcy5jb2xvcn1cIj5cXHUyNWNmPC9zcGFuPiB7c2VyaWVzLm5hbWV9OiA8Yj57cG9pbnQubG93fTwvYj4gLSA8Yj57cG9pbnQuaGlnaH08L2I+PGJyLz4nfSxcbnRyYWNrQnlBcmVhOiEwLGRhdGFMYWJlbHM6e2FsaWduOm51bGwsdmVydGljYWxBbGlnbjpudWxsLHhMb3c6MCx4SGlnaDowLHlMb3c6MCx5SGlnaDowfSxzdGF0ZXM6e2hvdmVyOntoYWxvOiExfX19KTtpLmFyZWFyYW5nZT12KGkuYXJlYSx7dHlwZTpcImFyZWFyYW5nZVwiLHBvaW50QXJyYXlNYXA6W1wibG93XCIsXCJoaWdoXCJdLGRhdGFMYWJlbENvbGxlY3Rpb25zOltcImRhdGFMYWJlbFwiLFwiZGF0YUxhYmVsVXBwZXJcIl0sdG9ZRGF0YTpmdW5jdGlvbihhKXtyZXR1cm5bYS5sb3csYS5oaWdoXX0scG9pbnRWYWxLZXk6XCJsb3dcIixkZWZlclRyYW5zbGF0ZVBvbGFyOiEwLGhpZ2hUb1hZOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY2hhcnQsYz10aGlzLnhBeGlzLnBvc3RUcmFuc2xhdGUoYS5yZWN0UGxvdFgsdGhpcy55QXhpcy5sZW4tYS5wbG90SGlnaCk7YS5wbG90SGlnaFg9Yy54LWIucGxvdExlZnQ7YS5wbG90SGlnaD1jLnktYi5wbG90VG9wfSx0cmFuc2xhdGU6ZnVuY3Rpb24oKXt2YXIgYT1cbnRoaXMsYj1hLnlBeGlzO2kuYXJlYS5wcm90b3R5cGUudHJhbnNsYXRlLmFwcGx5KGEpO3QoYS5wb2ludHMsZnVuY3Rpb24oYSl7dmFyIGQ9YS5sb3csZz1hLmhpZ2gsZT1hLnBsb3RZO2c9PT1udWxsfHxkPT09bnVsbD9hLmlzTnVsbD0hMDooYS5wbG90TG93PWUsYS5wbG90SGlnaD1iLnRyYW5zbGF0ZShnLDAsMSwwLDEpKX0pO3RoaXMuY2hhcnQucG9sYXImJnQodGhpcy5wb2ludHMsZnVuY3Rpb24oYil7YS5oaWdoVG9YWShiKX0pfSxnZXRHcmFwaFBhdGg6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLnBvaW50cyxiPVtdLGM9W10sZD1hLmxlbmd0aCxnPXgucHJvdG90eXBlLmdldEdyYXBoUGF0aCxlLGosbDtsPXRoaXMub3B0aW9ucztmb3IodmFyIGg9bC5zdGVwLGQ9YS5sZW5ndGg7ZC0tOyllPWFbZF0sIWUuaXNOdWxsJiYoIWFbZCsxXXx8YVtkKzFdLmlzTnVsbCkmJmMucHVzaCh7cGxvdFg6ZS5wbG90WCxwbG90WTplLnBsb3RMb3d9KSxqPXtwbG90WDplLnBsb3RYLHBsb3RZOmUucGxvdEhpZ2gsXG5pc051bGw6ZS5pc051bGx9LGMucHVzaChqKSxiLnB1c2goaiksIWUuaXNOdWxsJiYoIWFbZC0xXXx8YVtkLTFdLmlzTnVsbCkmJmMucHVzaCh7cGxvdFg6ZS5wbG90WCxwbG90WTplLnBsb3RMb3d9KTthPWcuY2FsbCh0aGlzLGEpO2lmKGgpaD09PSEwJiYoaD1cImxlZnRcIiksbC5zdGVwPXtsZWZ0OlwicmlnaHRcIixjZW50ZXI6XCJjZW50ZXJcIixyaWdodDpcImxlZnRcIn1baF07Yj1nLmNhbGwodGhpcyxiKTtjPWcuY2FsbCh0aGlzLGMpO2wuc3RlcD1oO2w9W10uY29uY2F0KGEsYik7IXRoaXMuY2hhcnQucG9sYXImJmNbMF09PT1cIk1cIiYmKGNbMF09XCJMXCIpO3RoaXMuYXJlYVBhdGg9dGhpcy5hcmVhUGF0aC5jb25jYXQoYSxjKTtyZXR1cm4gbH0sZHJhd0RhdGFMYWJlbHM6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmRhdGEsYj1hLmxlbmd0aCxjLGQ9W10sZz14LnByb3RvdHlwZSxlPXRoaXMub3B0aW9ucy5kYXRhTGFiZWxzLGo9ZS5hbGlnbixsPWUudmVydGljYWxBbGlnbixoPWUuaW5zaWRlLGYsXG5rLG49dGhpcy5jaGFydC5pbnZlcnRlZDtpZihlLmVuYWJsZWR8fHRoaXMuX2hhc1BvaW50TGFiZWxzKXtmb3IoYz1iO2MtLTspaWYoZj1hW2NdKXtrPWg/Zi5wbG90SGlnaDxmLnBsb3RMb3c6Zi5wbG90SGlnaD5mLnBsb3RMb3c7Zi55PWYuaGlnaDtmLl9wbG90WT1mLnBsb3RZO2YucGxvdFk9Zi5wbG90SGlnaDtkW2NdPWYuZGF0YUxhYmVsO2YuZGF0YUxhYmVsPWYuZGF0YUxhYmVsVXBwZXI7Zi5iZWxvdz1rO2lmKG4pe2lmKCFqKWUuYWxpZ249az9cInJpZ2h0XCI6XCJsZWZ0XCJ9ZWxzZSBpZighbCllLnZlcnRpY2FsQWxpZ249az9cInRvcFwiOlwiYm90dG9tXCI7ZS54PWUueEhpZ2g7ZS55PWUueUhpZ2h9Zy5kcmF3RGF0YUxhYmVscyYmZy5kcmF3RGF0YUxhYmVscy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7Zm9yKGM9YjtjLS07KWlmKGY9YVtjXSl7az1oP2YucGxvdEhpZ2g8Zi5wbG90TG93OmYucGxvdEhpZ2g+Zi5wbG90TG93O2YuZGF0YUxhYmVsVXBwZXI9Zi5kYXRhTGFiZWw7Zi5kYXRhTGFiZWw9XG5kW2NdO2YueT1mLmxvdztmLnBsb3RZPWYuX3Bsb3RZO2YuYmVsb3c9IWs7aWYobil7aWYoIWopZS5hbGlnbj1rP1wibGVmdFwiOlwicmlnaHRcIn1lbHNlIGlmKCFsKWUudmVydGljYWxBbGlnbj1rP1wiYm90dG9tXCI6XCJ0b3BcIjtlLng9ZS54TG93O2UueT1lLnlMb3d9Zy5kcmF3RGF0YUxhYmVscyYmZy5kcmF3RGF0YUxhYmVscy5hcHBseSh0aGlzLGFyZ3VtZW50cyl9ZS5hbGlnbj1qO2UudmVydGljYWxBbGlnbj1sfSxhbGlnbkRhdGFMYWJlbDpmdW5jdGlvbigpe2kuY29sdW1uLnByb3RvdHlwZS5hbGlnbkRhdGFMYWJlbC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LHNldFN0YWNrZWRQb2ludHM6cixnZXRTeW1ib2w6cixkcmF3UG9pbnRzOnJ9KTtwLmFyZWFzcGxpbmVyYW5nZT11KHAuYXJlYXJhbmdlKTtpLmFyZWFzcGxpbmVyYW5nZT12KGkuYXJlYXJhbmdlLHt0eXBlOlwiYXJlYXNwbGluZXJhbmdlXCIsZ2V0UG9pbnRTcGxpbmU6aS5zcGxpbmUucHJvdG90eXBlLmdldFBvaW50U3BsaW5lfSk7XG4oZnVuY3Rpb24oKXt2YXIgYT1pLmNvbHVtbi5wcm90b3R5cGU7cC5jb2x1bW5yYW5nZT11KHAuY29sdW1uLHAuYXJlYXJhbmdlLHtsaW5lV2lkdGg6MSxwb2ludFJhbmdlOm51bGx9KTtpLmNvbHVtbnJhbmdlPXYoaS5hcmVhcmFuZ2Use3R5cGU6XCJjb2x1bW5yYW5nZVwiLHRyYW5zbGF0ZTpmdW5jdGlvbigpe3ZhciBiPXRoaXMsYz1iLnlBeGlzLGQ9Yi54QXhpcyxnPWQuc3RhcnRBbmdsZVJhZCxlLGo9Yi5jaGFydCxsPWIueEF4aXMuaXNSYWRpYWwsaDthLnRyYW5zbGF0ZS5hcHBseShiKTt0KGIucG9pbnRzLGZ1bmN0aW9uKGEpe3ZhciBrPWEuc2hhcGVBcmdzLG49Yi5vcHRpb25zLm1pblBvaW50TGVuZ3RoLHMsaTthLnBsb3RIaWdoPWg9Yy50cmFuc2xhdGUoYS5oaWdoLDAsMSwwLDEpO2EucGxvdExvdz1hLnBsb3RZO2k9aDtzPW8oYS5yZWN0UGxvdFksYS5wbG90WSktaDtNYXRoLmFicyhzKTxuPyhuLT1zLHMrPW4saS09bi8yKTpzPDAmJihzKj0tMSxpLT1zKTtsPyhlPWEuYmFyWCtcbmcsYS5zaGFwZVR5cGU9XCJwYXRoXCIsYS5zaGFwZUFyZ3M9e2Q6Yi5wb2xhckFyYyhpK3MsaSxlLGUrYS5wb2ludFdpZHRoKX0pOihrLmhlaWdodD1zLGsueT1pLGEudG9vbHRpcFBvcz1qLmludmVydGVkP1tjLmxlbitjLnBvcy1qLnBsb3RMZWZ0LWktcy8yLGQubGVuK2QucG9zLWoucGxvdFRvcC1rLngtay53aWR0aC8yLHNdOltkLmxlZnQtai5wbG90TGVmdCtrLngray53aWR0aC8yLGMucG9zLWoucGxvdFRvcCtpK3MvMixzXSl9KX0sZGlyZWN0VG91Y2g6ITAsdHJhY2tlckdyb3VwczpbXCJncm91cFwiLFwiZGF0YUxhYmVsc0dyb3VwXCJdLGRyYXdHcmFwaDpyLGNyaXNwQ29sOmEuY3Jpc3BDb2wscG9pbnRBdHRyVG9PcHRpb25zOmEucG9pbnRBdHRyVG9PcHRpb25zLGRyYXdQb2ludHM6YS5kcmF3UG9pbnRzLGRyYXdUcmFja2VyOmEuZHJhd1RyYWNrZXIsZ2V0Q29sdW1uTWV0cmljczphLmdldENvbHVtbk1ldHJpY3MsYW5pbWF0ZTpmdW5jdGlvbigpe3JldHVybiBhLmFuaW1hdGUuYXBwbHkodGhpcyxcbmFyZ3VtZW50cyl9LHBvbGFyQXJjOmZ1bmN0aW9uKCl7cmV0dXJuIGEucG9sYXJBcmMuYXBwbHkodGhpcyxhcmd1bWVudHMpfX0pfSkoKTtwLmdhdWdlPXUocC5saW5lLHtkYXRhTGFiZWxzOntlbmFibGVkOiEwLGRlZmVyOiExLHk6MTUsYm9yZGVyV2lkdGg6MSxib3JkZXJDb2xvcjpcInNpbHZlclwiLGJvcmRlclJhZGl1czozLGNyb3A6ITEsdmVydGljYWxBbGlnbjpcInRvcFwiLHpJbmRleDoyfSxkaWFsOnt9LHBpdm90Ont9LHRvb2x0aXA6e2hlYWRlckZvcm1hdDpcIlwifSxzaG93SW5MZWdlbmQ6ITF9KTtDPXt0eXBlOlwiZ2F1Z2VcIixwb2ludENsYXNzOnYoSSx7c2V0U3RhdGU6ZnVuY3Rpb24oYSl7dGhpcy5zdGF0ZT1hfX0pLGFuZ3VsYXI6ITAsZGlyZWN0VG91Y2g6ITAsZHJhd0dyYXBoOnIsZml4ZWRCb3g6ITAsZm9yY2VETDohMCx0cmFja2VyR3JvdXBzOltcImdyb3VwXCIsXCJkYXRhTGFiZWxzR3JvdXBcIl0sdHJhbnNsYXRlOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy55QXhpcyxiPXRoaXMub3B0aW9ucyxcbmM9YS5jZW50ZXI7dGhpcy5nZW5lcmF0ZVBvaW50cygpO3QodGhpcy5wb2ludHMsZnVuY3Rpb24oZCl7dmFyIGc9dShiLmRpYWwsZC5kaWFsKSxlPUIobyhnLnJhZGl1cyw4MCkpKmNbMl0vMjAwLGo9QihvKGcuYmFzZUxlbmd0aCw3MCkpKmUvMTAwLGw9QihvKGcucmVhckxlbmd0aCwxMCkpKmUvMTAwLGg9Zy5iYXNlV2lkdGh8fDMsZj1nLnRvcFdpZHRofHwxLGs9Yi5vdmVyc2hvb3Qsbj1hLnN0YXJ0QW5nbGVSYWQrYS50cmFuc2xhdGUoZC55LG51bGwsbnVsbCxudWxsLCEwKTtrJiZ0eXBlb2Ygaz09PVwibnVtYmVyXCI/KGs9ay8xODAqTWF0aC5QSSxuPU1hdGgubWF4KGEuc3RhcnRBbmdsZVJhZC1rLE1hdGgubWluKGEuZW5kQW5nbGVSYWQrayxuKSkpOmIud3JhcD09PSExJiYobj1NYXRoLm1heChhLnN0YXJ0QW5nbGVSYWQsTWF0aC5taW4oYS5lbmRBbmdsZVJhZCxuKSkpO249bioxODAvTWF0aC5QSTtkLnNoYXBlVHlwZT1cInBhdGhcIjtkLnNoYXBlQXJncz17ZDpnLnBhdGh8fFtcIk1cIixcbi1sLC1oLzIsXCJMXCIsaiwtaC8yLGUsLWYvMixlLGYvMixqLGgvMiwtbCxoLzIsXCJ6XCJdLHRyYW5zbGF0ZVg6Y1swXSx0cmFuc2xhdGVZOmNbMV0scm90YXRpb246bn07ZC5wbG90WD1jWzBdO2QucGxvdFk9Y1sxXX0pfSxkcmF3UG9pbnRzOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEueUF4aXMuY2VudGVyLGM9YS5waXZvdCxkPWEub3B0aW9ucyxnPWQucGl2b3QsZT1hLmNoYXJ0LnJlbmRlcmVyO3QoYS5wb2ludHMsZnVuY3Rpb24oYil7dmFyIGc9Yi5ncmFwaGljLGM9Yi5zaGFwZUFyZ3MsZj1jLmQsaz11KGQuZGlhbCxiLmRpYWwpO2c/KGcuYW5pbWF0ZShjKSxjLmQ9Zik6Yi5ncmFwaGljPWVbYi5zaGFwZVR5cGVdKGMpLmF0dHIoe3N0cm9rZTprLmJvcmRlckNvbG9yfHxcIm5vbmVcIixcInN0cm9rZS13aWR0aFwiOmsuYm9yZGVyV2lkdGh8fDAsZmlsbDprLmJhY2tncm91bmRDb2xvcnx8XCJibGFja1wiLHJvdGF0aW9uOmMucm90YXRpb24sekluZGV4OjF9KS5hZGQoYS5ncm91cCl9KTtjP2MuYW5pbWF0ZSh7dHJhbnNsYXRlWDpiWzBdLFxudHJhbnNsYXRlWTpiWzFdfSk6YS5waXZvdD1lLmNpcmNsZSgwLDAsbyhnLnJhZGl1cyw1KSkuYXR0cih7XCJzdHJva2Utd2lkdGhcIjpnLmJvcmRlcldpZHRofHwwLHN0cm9rZTpnLmJvcmRlckNvbG9yfHxcInNpbHZlclwiLGZpbGw6Zy5iYWNrZ3JvdW5kQ29sb3J8fFwiYmxhY2tcIix6SW5kZXg6Mn0pLnRyYW5zbGF0ZShiWzBdLGJbMV0pLmFkZChhLmdyb3VwKX0sYW5pbWF0ZTpmdW5jdGlvbihhKXt2YXIgYj10aGlzO2lmKCFhKXQoYi5wb2ludHMsZnVuY3Rpb24oYSl7dmFyIGQ9YS5ncmFwaGljO2QmJihkLmF0dHIoe3JvdGF0aW9uOmIueUF4aXMuc3RhcnRBbmdsZVJhZCoxODAvTWF0aC5QSX0pLGQuYW5pbWF0ZSh7cm90YXRpb246YS5zaGFwZUFyZ3Mucm90YXRpb259LGIub3B0aW9ucy5hbmltYXRpb24pKX0pLGIuYW5pbWF0ZT1udWxsfSxyZW5kZXI6ZnVuY3Rpb24oKXt0aGlzLmdyb3VwPXRoaXMucGxvdEdyb3VwKFwiZ3JvdXBcIixcInNlcmllc1wiLHRoaXMudmlzaWJsZT9cInZpc2libGVcIjpcImhpZGRlblwiLFxudGhpcy5vcHRpb25zLnpJbmRleCx0aGlzLmNoYXJ0LnNlcmllc0dyb3VwKTt4LnByb3RvdHlwZS5yZW5kZXIuY2FsbCh0aGlzKTt0aGlzLmdyb3VwLmNsaXAodGhpcy5jaGFydC5jbGlwUmVjdCl9LHNldERhdGE6ZnVuY3Rpb24oYSxiKXt4LnByb3RvdHlwZS5zZXREYXRhLmNhbGwodGhpcyxhLCExKTt0aGlzLnByb2Nlc3NEYXRhKCk7dGhpcy5nZW5lcmF0ZVBvaW50cygpO28oYiwhMCkmJnRoaXMuY2hhcnQucmVkcmF3KCl9LGRyYXdUcmFja2VyOkMmJkMuZHJhd1RyYWNrZXJQb2ludH07aS5nYXVnZT12KGkubGluZSxDKTtwLmJveHBsb3Q9dShwLmNvbHVtbix7ZmlsbENvbG9yOlwiI0ZGRkZGRlwiLGxpbmVXaWR0aDoxLG1lZGlhbldpZHRoOjIsc3RhdGVzOntob3Zlcjp7YnJpZ2h0bmVzczotMC4zfX0sdGhyZXNob2xkOm51bGwsdG9vbHRpcDp7cG9pbnRGb3JtYXQ6JzxzcGFuIHN0eWxlPVwiY29sb3I6e3BvaW50LmNvbG9yfVwiPlxcdTI1Y2Y8L3NwYW4+IDxiPiB7c2VyaWVzLm5hbWV9PC9iPjxici8+TWF4aW11bToge3BvaW50LmhpZ2h9PGJyLz5VcHBlciBxdWFydGlsZToge3BvaW50LnEzfTxici8+TWVkaWFuOiB7cG9pbnQubWVkaWFufTxici8+TG93ZXIgcXVhcnRpbGU6IHtwb2ludC5xMX08YnIvPk1pbmltdW06IHtwb2ludC5sb3d9PGJyLz4nfSxcbndoaXNrZXJMZW5ndGg6XCI1MCVcIix3aGlza2VyV2lkdGg6Mn0pO2kuYm94cGxvdD12KGkuY29sdW1uLHt0eXBlOlwiYm94cGxvdFwiLHBvaW50QXJyYXlNYXA6W1wibG93XCIsXCJxMVwiLFwibWVkaWFuXCIsXCJxM1wiLFwiaGlnaFwiXSx0b1lEYXRhOmZ1bmN0aW9uKGEpe3JldHVyblthLmxvdyxhLnExLGEubWVkaWFuLGEucTMsYS5oaWdoXX0scG9pbnRWYWxLZXk6XCJoaWdoXCIscG9pbnRBdHRyVG9PcHRpb25zOntmaWxsOlwiZmlsbENvbG9yXCIsc3Ryb2tlOlwiY29sb3JcIixcInN0cm9rZS13aWR0aFwiOlwibGluZVdpZHRoXCJ9LGRyYXdEYXRhTGFiZWxzOnIsdHJhbnNsYXRlOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy55QXhpcyxiPXRoaXMucG9pbnRBcnJheU1hcDtpLmNvbHVtbi5wcm90b3R5cGUudHJhbnNsYXRlLmFwcGx5KHRoaXMpO3QodGhpcy5wb2ludHMsZnVuY3Rpb24oYyl7dChiLGZ1bmN0aW9uKGIpe2NbYl0hPT1udWxsJiYoY1tiK1wiUGxvdFwiXT1hLnRyYW5zbGF0ZShjW2JdLDAsMSwwLDEpKX0pfSl9LGRyYXdQb2ludHM6ZnVuY3Rpb24oKXt2YXIgYT1cbnRoaXMsYj1hLm9wdGlvbnMsYz1hLmNoYXJ0LnJlbmRlcmVyLGQsZyxlLGosbCxoLGYsayxuLGksbSxKLEsscCx1LHIsdyx2LHgseSxDLEIsej1hLmRvUXVhcnRpbGVzIT09ITEsQSxFPWEub3B0aW9ucy53aGlza2VyTGVuZ3RoO3QoYS5wb2ludHMsZnVuY3Rpb24ocSl7bj1xLmdyYXBoaWM7Qz1xLnNoYXBlQXJnczttPXt9O3A9e307cj17fTtCPXEuY29sb3J8fGEuY29sb3I7aWYocS5wbG90WSE9PXZvaWQgMClpZihkPXEucG9pbnRBdHRyW3Euc2VsZWN0ZWQ/XCJzZWxlY3RlZFwiOlwiXCJdLHc9Qy53aWR0aCx2PUQoQy54KSx4PXYrdyx5PUYody8yKSxnPUQoej9xLnExUGxvdDpxLmxvd1Bsb3QpLGU9RCh6P3EucTNQbG90OnEubG93UGxvdCksaj1EKHEuaGlnaFBsb3QpLGw9RChxLmxvd1Bsb3QpLG0uc3Ryb2tlPXEuc3RlbUNvbG9yfHxiLnN0ZW1Db2xvcnx8QixtW1wic3Ryb2tlLXdpZHRoXCJdPW8ocS5zdGVtV2lkdGgsYi5zdGVtV2lkdGgsYi5saW5lV2lkdGgpLG0uZGFzaHN0eWxlPXEuc3RlbURhc2hTdHlsZXx8XG5iLnN0ZW1EYXNoU3R5bGUscC5zdHJva2U9cS53aGlza2VyQ29sb3J8fGIud2hpc2tlckNvbG9yfHxCLHBbXCJzdHJva2Utd2lkdGhcIl09byhxLndoaXNrZXJXaWR0aCxiLndoaXNrZXJXaWR0aCxiLmxpbmVXaWR0aCksci5zdHJva2U9cS5tZWRpYW5Db2xvcnx8Yi5tZWRpYW5Db2xvcnx8QixyW1wic3Ryb2tlLXdpZHRoXCJdPW8ocS5tZWRpYW5XaWR0aCxiLm1lZGlhbldpZHRoLGIubGluZVdpZHRoKSxmPW1bXCJzdHJva2Utd2lkdGhcIl0lMi8yLGs9dit5K2YsaT1bXCJNXCIsayxlLFwiTFwiLGssaixcIk1cIixrLGcsXCJMXCIsayxsXSx6JiYoZj1kW1wic3Ryb2tlLXdpZHRoXCJdJTIvMixrPUQoaykrZixnPUQoZykrZixlPUQoZSkrZix2Kz1mLHgrPWYsSj1bXCJNXCIsdixlLFwiTFwiLHYsZyxcIkxcIix4LGcsXCJMXCIseCxlLFwiTFwiLHYsZSxcInpcIl0pLEUmJihmPXBbXCJzdHJva2Utd2lkdGhcIl0lMi8yLGorPWYsbCs9ZixBPS8lJC8udGVzdChFKT95KnBhcnNlRmxvYXQoRSkvMTAwOkUvMixLPVtcIk1cIixrLUEsaixcIkxcIixrK1xuQSxqLFwiTVwiLGstQSxsLFwiTFwiLGsrQSxsXSksZj1yW1wic3Ryb2tlLXdpZHRoXCJdJTIvMixoPUYocS5tZWRpYW5QbG90KStmLHU9W1wiTVwiLHYsaCxcIkxcIix4LGhdLG4pcS5zdGVtLmFuaW1hdGUoe2Q6aX0pLEUmJnEud2hpc2tlcnMuYW5pbWF0ZSh7ZDpLfSkseiYmcS5ib3guYW5pbWF0ZSh7ZDpKfSkscS5tZWRpYW5TaGFwZS5hbmltYXRlKHtkOnV9KTtlbHNle3EuZ3JhcGhpYz1uPWMuZygpLmFkZChhLmdyb3VwKTtxLnN0ZW09Yy5wYXRoKGkpLmF0dHIobSkuYWRkKG4pO2lmKEUpcS53aGlza2Vycz1jLnBhdGgoSykuYXR0cihwKS5hZGQobik7aWYoeilxLmJveD1jLnBhdGgoSikuYXR0cihkKS5hZGQobik7cS5tZWRpYW5TaGFwZT1jLnBhdGgodSkuYXR0cihyKS5hZGQobil9fSl9LHNldFN0YWNrZWRQb2ludHM6cn0pO3AuZXJyb3JiYXI9dShwLmJveHBsb3Qse2NvbG9yOlwiIzAwMDAwMFwiLGdyb3VwaW5nOiExLGxpbmtlZFRvOlwiOnByZXZpb3VzXCIsdG9vbHRpcDp7cG9pbnRGb3JtYXQ6JzxzcGFuIHN0eWxlPVwiY29sb3I6e3BvaW50LmNvbG9yfVwiPlxcdTI1Y2Y8L3NwYW4+IHtzZXJpZXMubmFtZX06IDxiPntwb2ludC5sb3d9PC9iPiAtIDxiPntwb2ludC5oaWdofTwvYj48YnIvPid9LFxud2hpc2tlcldpZHRoOm51bGx9KTtpLmVycm9yYmFyPXYoaS5ib3hwbG90LHt0eXBlOlwiZXJyb3JiYXJcIixwb2ludEFycmF5TWFwOltcImxvd1wiLFwiaGlnaFwiXSx0b1lEYXRhOmZ1bmN0aW9uKGEpe3JldHVyblthLmxvdyxhLmhpZ2hdfSxwb2ludFZhbEtleTpcImhpZ2hcIixkb1F1YXJ0aWxlczohMSxkcmF3RGF0YUxhYmVsczppLmFyZWFyYW5nZT9pLmFyZWFyYW5nZS5wcm90b3R5cGUuZHJhd0RhdGFMYWJlbHM6cixnZXRDb2x1bW5NZXRyaWNzOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubGlua2VkUGFyZW50JiZ0aGlzLmxpbmtlZFBhcmVudC5jb2x1bW5NZXRyaWNzfHxpLmNvbHVtbi5wcm90b3R5cGUuZ2V0Q29sdW1uTWV0cmljcy5jYWxsKHRoaXMpfX0pO3Aud2F0ZXJmYWxsPXUocC5jb2x1bW4se2xpbmVXaWR0aDoxLGxpbmVDb2xvcjpcIiMzMzNcIixkYXNoU3R5bGU6XCJkb3RcIixib3JkZXJDb2xvcjpcIiMzMzNcIixkYXRhTGFiZWxzOntpbnNpZGU6ITB9LHN0YXRlczp7aG92ZXI6e2xpbmVXaWR0aFBsdXM6MH19fSk7XG5pLndhdGVyZmFsbD12KGkuY29sdW1uLHt0eXBlOlwid2F0ZXJmYWxsXCIsdXBDb2xvclByb3A6XCJmaWxsXCIscG9pbnRWYWxLZXk6XCJ5XCIsdHJhbnNsYXRlOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcHRpb25zLGI9dGhpcy55QXhpcyxjLGQsZyxlLGosbCxoLGYsayxuPW8oYS5taW5Qb2ludExlbmd0aCw1KSxzPWEudGhyZXNob2xkLG09YS5zdGFja2luZztpLmNvbHVtbi5wcm90b3R5cGUudHJhbnNsYXRlLmFwcGx5KHRoaXMpO3RoaXMubWluUG9pbnRMZW5ndGhPZmZzZXQ9MDtoPWY9cztkPXRoaXMucG9pbnRzO2ZvcihjPTAsYT1kLmxlbmd0aDtjPGE7YysrKXtnPWRbY107bD10aGlzLnByb2Nlc3NlZFlEYXRhW2NdO2U9Zy5zaGFwZUFyZ3M7az0oaj1tJiZiLnN0YWNrc1sodGhpcy5uZWdTdGFja3MmJmw8cz9cIi1cIjpcIlwiKSt0aGlzLnN0YWNrS2V5XSk/altnLnhdLnBvaW50c1t0aGlzLmluZGV4K1wiLFwiK2NdOlswLGxdO2lmKGcuaXNTdW0pZy55PUcobCk7ZWxzZSBpZihnLmlzSW50ZXJtZWRpYXRlU3VtKWcueT1cbkcobC1mKTtqPU8oaCxoK2cueSkra1swXTtlLnk9Yi50cmFuc2xhdGUoaiwwLDEpO2lmKGcuaXNTdW0pZS55PWIudHJhbnNsYXRlKGtbMV0sMCwxKSxlLmhlaWdodD1NYXRoLm1pbihiLnRyYW5zbGF0ZShrWzBdLDAsMSksYi5sZW4pLWUueSt0aGlzLm1pblBvaW50TGVuZ3RoT2Zmc2V0O2Vsc2UgaWYoZy5pc0ludGVybWVkaWF0ZVN1bSllLnk9Yi50cmFuc2xhdGUoa1sxXSwwLDEpLGUuaGVpZ2h0PU1hdGgubWluKGIudHJhbnNsYXRlKGYsMCwxKSxiLmxlbiktZS55K3RoaXMubWluUG9pbnRMZW5ndGhPZmZzZXQsZj1rWzFdO2Vsc2V7aWYoaCE9PTApZS5oZWlnaHQ9bD4wP2IudHJhbnNsYXRlKGgsMCwxKS1lLnk6Yi50cmFuc2xhdGUoaCwwLDEpLWIudHJhbnNsYXRlKGgtbCwwLDEpO2grPWx9ZS5oZWlnaHQ8MCYmKGUueSs9ZS5oZWlnaHQsZS5oZWlnaHQqPS0xKTtnLnBsb3RZPWUueT1GKGUueSktdGhpcy5ib3JkZXJXaWR0aCUyLzI7ZS5oZWlnaHQ9TyhGKGUuaGVpZ2h0KSwwLjAwMSk7XG5nLnlCb3R0b209ZS55K2UuaGVpZ2h0O2lmKGUuaGVpZ2h0PD1uKWUuaGVpZ2h0PW4sdGhpcy5taW5Qb2ludExlbmd0aE9mZnNldCs9bjtlLnktPXRoaXMubWluUG9pbnRMZW5ndGhPZmZzZXQ7ZT1nLnBsb3RZKyhnLm5lZ2F0aXZlP2UuaGVpZ2h0OjApLXRoaXMubWluUG9pbnRMZW5ndGhPZmZzZXQ7dGhpcy5jaGFydC5pbnZlcnRlZD9nLnRvb2x0aXBQb3NbMF09Yi5sZW4tZTpnLnRvb2x0aXBQb3NbMV09ZX19LHByb2Nlc3NEYXRhOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMueURhdGEsYz10aGlzLm9wdGlvbnMuZGF0YSxkLGc9Yi5sZW5ndGgsZSxqLGwsaCxmLGs7aj1lPWw9aD10aGlzLm9wdGlvbnMudGhyZXNob2xkfHwwO2ZvcihrPTA7azxnO2srKylmPWJba10sZD1jJiZjW2tdP2Nba106e30sZj09PVwic3VtXCJ8fGQuaXNTdW0/YltrXT1HKGopOmY9PT1cImludGVybWVkaWF0ZVN1bVwifHxkLmlzSW50ZXJtZWRpYXRlU3VtP2Jba109RyhlKTooais9ZixlKz1mKSxsPU1hdGgubWluKGosXG5sKSxoPU1hdGgubWF4KGosaCk7eC5wcm90b3R5cGUucHJvY2Vzc0RhdGEuY2FsbCh0aGlzLGEpO3RoaXMuZGF0YU1pbj1sO3RoaXMuZGF0YU1heD1ofSx0b1lEYXRhOmZ1bmN0aW9uKGEpe3JldHVybiBhLmlzU3VtP2EueD09PTA/bnVsbDpcInN1bVwiOmEuaXNJbnRlcm1lZGlhdGVTdW0/YS54PT09MD9udWxsOlwiaW50ZXJtZWRpYXRlU3VtXCI6YS55fSxnZXRBdHRyaWJzOmZ1bmN0aW9uKCl7aS5jb2x1bW4ucHJvdG90eXBlLmdldEF0dHJpYnMuYXBwbHkodGhpcyxhcmd1bWVudHMpO3ZhciBhPXRoaXMsYj1hLm9wdGlvbnMsYz1iLnN0YXRlcyxkPWIudXBDb2xvcnx8YS5jb2xvcixiPW0uQ29sb3IoZCkuYnJpZ2h0ZW4oMC4xKS5nZXQoKSxnPXUoYS5wb2ludEF0dHIpLGU9YS51cENvbG9yUHJvcDtnW1wiXCJdW2VdPWQ7Zy5ob3ZlcltlXT1jLmhvdmVyLnVwQ29sb3J8fGI7Zy5zZWxlY3RbZV09Yy5zZWxlY3QudXBDb2xvcnx8ZDt0KGEucG9pbnRzLGZ1bmN0aW9uKGUpe2lmKCFlLm9wdGlvbnMuY29sb3IpZS55PlxuMD8oZS5wb2ludEF0dHI9ZyxlLmNvbG9yPWQpOmUucG9pbnRBdHRyPWEucG9pbnRBdHRyfSl9LGdldEdyYXBoUGF0aDpmdW5jdGlvbigpe3ZhciBhPXRoaXMuZGF0YSxiPWEubGVuZ3RoLGM9Rih0aGlzLm9wdGlvbnMubGluZVdpZHRoK3RoaXMuYm9yZGVyV2lkdGgpJTIvMixkPVtdLGcsZSxqO2ZvcihqPTE7ajxiO2orKyllPWFbal0uc2hhcGVBcmdzLGc9YVtqLTFdLnNoYXBlQXJncyxlPVtcIk1cIixnLngrZy53aWR0aCxnLnkrYyxcIkxcIixlLngsZy55K2NdLGFbai0xXS55PDAmJihlWzJdKz1nLmhlaWdodCxlWzVdKz1nLmhlaWdodCksZD1kLmNvbmNhdChlKTtyZXR1cm4gZH0sZ2V0RXh0cmVtZXM6cixkcmF3R3JhcGg6eC5wcm90b3R5cGUuZHJhd0dyYXBofSk7cC5wb2x5Z29uPXUocC5zY2F0dGVyLHttYXJrZXI6e2VuYWJsZWQ6ITF9fSk7aS5wb2x5Z29uPXYoaS5zY2F0dGVyLHt0eXBlOlwicG9seWdvblwiLGZpbGxHcmFwaDohMCxnZXRTZWdtZW50UGF0aDpmdW5jdGlvbihhKXtyZXR1cm4geC5wcm90b3R5cGUuZ2V0U2VnbWVudFBhdGguY2FsbCh0aGlzLFxuYSkuY29uY2F0KFwielwiKX0sZHJhd0dyYXBoOngucHJvdG90eXBlLmRyYXdHcmFwaCxkcmF3TGVnZW5kU3ltYm9sOm0uTGVnZW5kU3ltYm9sTWl4aW4uZHJhd1JlY3RhbmdsZX0pO3AuYnViYmxlPXUocC5zY2F0dGVyLHtkYXRhTGFiZWxzOntmb3JtYXR0ZXI6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wb2ludC56fSxpbnNpZGU6ITAsdmVydGljYWxBbGlnbjpcIm1pZGRsZVwifSxtYXJrZXI6e2xpbmVDb2xvcjpudWxsLGxpbmVXaWR0aDoxfSxtaW5TaXplOjgsbWF4U2l6ZTpcIjIwJVwiLHNvZnRUaHJlc2hvbGQ6ITEsc3RhdGVzOntob3Zlcjp7aGFsbzp7c2l6ZTo1fX19LHRvb2x0aXA6e3BvaW50Rm9ybWF0OlwiKHtwb2ludC54fSwge3BvaW50Lnl9KSwgU2l6ZToge3BvaW50Lnp9XCJ9LHR1cmJvVGhyZXNob2xkOjAselRocmVzaG9sZDowLHpvbmVBeGlzOlwielwifSk7Qz12KEkse2hhbG9QYXRoOmZ1bmN0aW9uKCl7cmV0dXJuIEkucHJvdG90eXBlLmhhbG9QYXRoLmNhbGwodGhpcyx0aGlzLnNoYXBlQXJncy5yK1xudGhpcy5zZXJpZXMub3B0aW9ucy5zdGF0ZXMuaG92ZXIuaGFsby5zaXplKX0sdHRCZWxvdzohMX0pO2kuYnViYmxlPXYoaS5zY2F0dGVyLHt0eXBlOlwiYnViYmxlXCIscG9pbnRDbGFzczpDLHBvaW50QXJyYXlNYXA6W1wieVwiLFwielwiXSxwYXJhbGxlbEFycmF5czpbXCJ4XCIsXCJ5XCIsXCJ6XCJdLHRyYWNrZXJHcm91cHM6W1wiZ3JvdXBcIixcImRhdGFMYWJlbHNHcm91cFwiXSxidWJibGVQYWRkaW5nOiEwLHpvbmVBeGlzOlwielwiLHBvaW50QXR0clRvT3B0aW9uczp7c3Ryb2tlOlwibGluZUNvbG9yXCIsXCJzdHJva2Utd2lkdGhcIjpcImxpbmVXaWR0aFwiLGZpbGw6XCJmaWxsQ29sb3JcIn0sYXBwbHlPcGFjaXR5OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMub3B0aW9ucy5tYXJrZXIsYz1vKGIuZmlsbE9wYWNpdHksMC41KSxhPWF8fGIuZmlsbENvbG9yfHx0aGlzLmNvbG9yO2MhPT0xJiYoYT1WKGEpLnNldE9wYWNpdHkoYykuZ2V0KFwicmdiYVwiKSk7cmV0dXJuIGF9LGNvbnZlcnRBdHRyaWJzOmZ1bmN0aW9uKCl7dmFyIGE9XG54LnByb3RvdHlwZS5jb252ZXJ0QXR0cmlicy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7YS5maWxsPXRoaXMuYXBwbHlPcGFjaXR5KGEuZmlsbCk7cmV0dXJuIGF9LGdldFJhZGlpOmZ1bmN0aW9uKGEsYixjLGQpe3ZhciBnLGUsaixsPXRoaXMuekRhdGEsaD1bXSxmPXRoaXMub3B0aW9ucyxrPWYuc2l6ZUJ5IT09XCJ3aWR0aFwiLG49Zi56VGhyZXNob2xkLGk9Yi1hO2ZvcihlPTAsZz1sLmxlbmd0aDtlPGc7ZSsrKWo9bFtlXSxmLnNpemVCeUFic29sdXRlVmFsdWUmJmohPT1udWxsJiYoaj1NYXRoLmFicyhqLW4pLGI9TWF0aC5tYXgoYi1uLE1hdGguYWJzKGEtbikpLGE9MCksaj09PW51bGw/aj1udWxsOmo8YT9qPWMvMi0xOihqPWk+MD8oai1hKS9pOjAuNSxrJiZqPj0wJiYoaj1NYXRoLnNxcnQoaikpLGo9eS5jZWlsKGMraiooZC1jKSkvMiksaC5wdXNoKGopO3RoaXMucmFkaWk9aH0sYW5pbWF0ZTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLm9wdGlvbnMuYW5pbWF0aW9uO2lmKCFhKXQodGhpcy5wb2ludHMsXG5mdW5jdGlvbihhKXt2YXIgZD1hLmdyYXBoaWMsYT1hLnNoYXBlQXJncztkJiZhJiYoZC5hdHRyKFwiclwiLDEpLGQuYW5pbWF0ZSh7cjphLnJ9LGIpKX0pLHRoaXMuYW5pbWF0ZT1udWxsfSx0cmFuc2xhdGU6ZnVuY3Rpb24oKXt2YXIgYSxiPXRoaXMuZGF0YSxjLGQsZz10aGlzLnJhZGlpO2kuc2NhdHRlci5wcm90b3R5cGUudHJhbnNsYXRlLmNhbGwodGhpcyk7Zm9yKGE9Yi5sZW5ndGg7YS0tOyljPWJbYV0sZD1nP2dbYV06MCx0eXBlb2YgZD09PVwibnVtYmVyXCImJmQ+PXRoaXMubWluUHhTaXplLzI/KGMuc2hhcGVUeXBlPVwiY2lyY2xlXCIsYy5zaGFwZUFyZ3M9e3g6Yy5wbG90WCx5OmMucGxvdFkscjpkfSxjLmRsQm94PXt4OmMucGxvdFgtZCx5OmMucGxvdFktZCx3aWR0aDoyKmQsaGVpZ2h0OjIqZH0pOmMuc2hhcGVBcmdzPWMucGxvdFk9Yy5kbEJveD12b2lkIDB9LGRyYXdMZWdlbmRTeW1ib2w6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmNoYXJ0LnJlbmRlcmVyLGQ9Yy5mb250TWV0cmljcyhhLml0ZW1TdHlsZS5mb250U2l6ZSkuZi9cbjI7Yi5sZWdlbmRTeW1ib2w9Yy5jaXJjbGUoZCxhLmJhc2VsaW5lLWQsZCkuYXR0cih7ekluZGV4OjN9KS5hZGQoYi5sZWdlbmRHcm91cCk7Yi5sZWdlbmRTeW1ib2wuaXNNYXJrZXI9ITB9LGRyYXdQb2ludHM6aS5jb2x1bW4ucHJvdG90eXBlLmRyYXdQb2ludHMsYWxpZ25EYXRhTGFiZWw6aS5jb2x1bW4ucHJvdG90eXBlLmFsaWduRGF0YUxhYmVsLGJ1aWxkS0RUcmVlOnIsYXBwbHlab25lczpyfSk7Ti5wcm90b3R5cGUuYmVmb3JlUGFkZGluZz1mdW5jdGlvbigpe3ZhciBhPXRoaXMsYj10aGlzLmxlbixjPXRoaXMuY2hhcnQsZD0wLGc9YixlPXRoaXMuaXNYQXhpcyxqPWU/XCJ4RGF0YVwiOlwieURhdGFcIixsPXRoaXMubWluLGg9e30sZj15Lm1pbihjLnBsb3RXaWR0aCxjLnBsb3RIZWlnaHQpLGs9TnVtYmVyLk1BWF9WQUxVRSxuPS1OdW1iZXIuTUFYX1ZBTFVFLGk9dGhpcy5tYXgtbCxtPWIvaSxwPVtdO3QodGhpcy5zZXJpZXMsZnVuY3Rpb24oYil7dmFyIGc9Yi5vcHRpb25zO2lmKGIuYnViYmxlUGFkZGluZyYmXG4oYi52aXNpYmxlfHwhYy5vcHRpb25zLmNoYXJ0Lmlnbm9yZUhpZGRlblNlcmllcykpaWYoYS5hbGxvd1pvb21PdXRzaWRlPSEwLHAucHVzaChiKSxlKXQoW1wibWluU2l6ZVwiLFwibWF4U2l6ZVwiXSxmdW5jdGlvbihhKXt2YXIgYj1nW2FdLGU9LyUkLy50ZXN0KGIpLGI9QihiKTtoW2FdPWU/ZipiLzEwMDpifSksYi5taW5QeFNpemU9aC5taW5TaXplLGIubWF4UHhTaXplPWgubWF4U2l6ZSxiPWIuekRhdGEsYi5sZW5ndGgmJihrPW8oZy56TWluLHkubWluKGsseS5tYXgoUShiKSxnLmRpc3BsYXlOZWdhdGl2ZT09PSExP2cuelRocmVzaG9sZDotTnVtYmVyLk1BWF9WQUxVRSkpKSxuPW8oZy56TWF4LHkubWF4KG4sUihiKSkpKX0pO3QocCxmdW5jdGlvbihiKXt2YXIgYz1iW2pdLGY9Yy5sZW5ndGgsaDtlJiZiLmdldFJhZGlpKGssbixiLm1pblB4U2l6ZSxiLm1heFB4U2l6ZSk7aWYoaT4wKWZvcig7Zi0tOyl0eXBlb2YgY1tmXT09PVwibnVtYmVyXCImJmEuZGF0YU1pbjw9Y1tmXSYmY1tmXTw9XG5hLmRhdGFNYXgmJihoPWIucmFkaWlbZl0sZD1NYXRoLm1pbigoY1tmXS1sKSptLWgsZCksZz1NYXRoLm1heCgoY1tmXS1sKSptK2gsZykpfSk7cC5sZW5ndGgmJmk+MCYmIXRoaXMuaXNMb2cmJihnLT1iLG0qPShiK2QtZykvYix0KFtbXCJtaW5cIixcInVzZXJNaW5cIixkXSxbXCJtYXhcIixcInVzZXJNYXhcIixnXV0sZnVuY3Rpb24oYil7byhhLm9wdGlvbnNbYlswXV0sYVtiWzFdXSk9PT12b2lkIDAmJihhW2JbMF1dKz1iWzJdL20pfSkpfTsoZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYil7dmFyIGM9dGhpcy5jaGFydCxkPXRoaXMub3B0aW9ucy5hbmltYXRpb24saD10aGlzLmdyb3VwLGY9dGhpcy5tYXJrZXJHcm91cCxrPXRoaXMueEF4aXMuY2VudGVyLGk9Yy5wbG90TGVmdCxtPWMucGxvdFRvcDtpZihjLnBvbGFyKXtpZihjLnJlbmRlcmVyLmlzU1ZHKWQ9PT0hMCYmKGQ9e30pLGI/KGM9e3RyYW5zbGF0ZVg6a1swXStpLHRyYW5zbGF0ZVk6a1sxXSttLHNjYWxlWDowLjAwMSxzY2FsZVk6MC4wMDF9LFxuaC5hdHRyKGMpLGYmJmYuYXR0cihjKSk6KGM9e3RyYW5zbGF0ZVg6aSx0cmFuc2xhdGVZOm0sc2NhbGVYOjEsc2NhbGVZOjF9LGguYW5pbWF0ZShjLGQpLGYmJmYuYW5pbWF0ZShjLGQpLHRoaXMuYW5pbWF0ZT1udWxsKX1lbHNlIGEuY2FsbCh0aGlzLGIpfXZhciBiPXgucHJvdG90eXBlLGM9VC5wcm90b3R5cGUsZDtiLnNlYXJjaFBvaW50QnlBbmdsZT1mdW5jdGlvbihhKXt2YXIgYj10aGlzLmNoYXJ0LGM9dGhpcy54QXhpcy5wYW5lLmNlbnRlcjtyZXR1cm4gdGhpcy5zZWFyY2hLRFRyZWUoe2NsaWVudFg6MTgwK01hdGguYXRhbjIoYS5jaGFydFgtY1swXS1iLnBsb3RMZWZ0LGEuY2hhcnRZLWNbMV0tYi5wbG90VG9wKSooLTE4MC9NYXRoLlBJKX0pfTt3KGIsXCJidWlsZEtEVHJlZVwiLGZ1bmN0aW9uKGEpe2lmKHRoaXMuY2hhcnQucG9sYXIpdGhpcy5rZEJ5QW5nbGU/dGhpcy5zZWFyY2hQb2ludD10aGlzLnNlYXJjaFBvaW50QnlBbmdsZTp0aGlzLmtkRGltZW5zaW9ucz0yO2EuYXBwbHkodGhpcyl9KTtcbmIudG9YWT1mdW5jdGlvbihhKXt2YXIgYixjPXRoaXMuY2hhcnQsZD1hLnBsb3RYO2I9YS5wbG90WTthLnJlY3RQbG90WD1kO2EucmVjdFBsb3RZPWI7Yj10aGlzLnhBeGlzLnBvc3RUcmFuc2xhdGUoYS5wbG90WCx0aGlzLnlBeGlzLmxlbi1iKTthLnBsb3RYPWEucG9sYXJQbG90WD1iLngtYy5wbG90TGVmdDthLnBsb3RZPWEucG9sYXJQbG90WT1iLnktYy5wbG90VG9wO3RoaXMua2RCeUFuZ2xlPyhjPShkL01hdGguUEkqMTgwK3RoaXMueEF4aXMucGFuZS5vcHRpb25zLnN0YXJ0QW5nbGUpJTM2MCxjPDAmJihjKz0zNjApLGEuY2xpZW50WD1jKTphLmNsaWVudFg9YS5wbG90WH07aS5zcGxpbmUmJncoaS5zcGxpbmUucHJvdG90eXBlLFwiZ2V0UG9pbnRTcGxpbmVcIixmdW5jdGlvbihhLGIsYyxkKXt2YXIgaCxmLGssaSxtLHAsbztpZih0aGlzLmNoYXJ0LnBvbGFyKXtoPWMucGxvdFg7Zj1jLnBsb3RZO2E9YltkLTFdO2s9YltkKzFdO3RoaXMuY29ubmVjdEVuZHMmJihhfHwoYT1iW2IubGVuZ3RoLVxuMl0pLGt8fChrPWJbMV0pKTtpZihhJiZrKWk9YS5wbG90WCxtPWEucGxvdFksYj1rLnBsb3RYLHA9ay5wbG90WSxpPSgxLjUqaCtpKS8yLjUsbT0oMS41KmYrbSkvMi41LGs9KDEuNSpoK2IpLzIuNSxvPSgxLjUqZitwKS8yLjUsYj1NYXRoLnNxcnQoTWF0aC5wb3coaS1oLDIpK01hdGgucG93KG0tZiwyKSkscD1NYXRoLnNxcnQoTWF0aC5wb3coay1oLDIpK01hdGgucG93KG8tZiwyKSksaT1NYXRoLmF0YW4yKG0tZixpLWgpLG09TWF0aC5hdGFuMihvLWYsay1oKSxvPU1hdGguUEkvMisoaSttKS8yLE1hdGguYWJzKGktbyk+TWF0aC5QSS8yJiYoby09TWF0aC5QSSksaT1oK01hdGguY29zKG8pKmIsbT1mK01hdGguc2luKG8pKmIsaz1oK01hdGguY29zKE1hdGguUEkrbykqcCxvPWYrTWF0aC5zaW4oTWF0aC5QSStvKSpwLGMucmlnaHRDb250WD1rLGMucmlnaHRDb250WT1vO2Q/KGM9W1wiQ1wiLGEucmlnaHRDb250WHx8YS5wbG90WCxhLnJpZ2h0Q29udFl8fGEucGxvdFksaXx8aCxtfHxcbmYsaCxmXSxhLnJpZ2h0Q29udFg9YS5yaWdodENvbnRZPW51bGwpOmM9W1wiTVwiLGgsZl19ZWxzZSBjPWEuY2FsbCh0aGlzLGIsYyxkKTtyZXR1cm4gY30pO3coYixcInRyYW5zbGF0ZVwiLGZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY2hhcnQ7YS5jYWxsKHRoaXMpO2lmKGIucG9sYXImJih0aGlzLmtkQnlBbmdsZT1iLnRvb2x0aXAmJmIudG9vbHRpcC5zaGFyZWQsIXRoaXMucHJldmVudFBvc3RUcmFuc2xhdGUpKXthPXRoaXMucG9pbnRzO2ZvcihiPWEubGVuZ3RoO2ItLTspdGhpcy50b1hZKGFbYl0pfX0pO3coYixcImdldEdyYXBoUGF0aFwiLGZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcztpZih0aGlzLmNoYXJ0LnBvbGFyKXtiPWJ8fHRoaXMucG9pbnRzO2lmKHRoaXMub3B0aW9ucy5jb25uZWN0RW5kcyE9PSExJiZiWzBdLnkhPT1udWxsKXRoaXMuY29ubmVjdEVuZHM9ITAsYi5zcGxpY2UoYi5sZW5ndGgsMCxiWzBdKTt0KGIsZnVuY3Rpb24oYSl7YS5wb2xhclBsb3RZPT09dm9pZCAwJiZjLnRvWFkoYSl9KX1yZXR1cm4gYS5hcHBseSh0aGlzLFxuW10uc2xpY2UuY2FsbChhcmd1bWVudHMsMSkpfSk7dyhiLFwiYW5pbWF0ZVwiLGEpO2lmKGkuY29sdW1uKWQ9aS5jb2x1bW4ucHJvdG90eXBlLGQucG9sYXJBcmM9ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGg9dGhpcy54QXhpcy5jZW50ZXIsZj10aGlzLnlBeGlzLmxlbjtyZXR1cm4gdGhpcy5jaGFydC5yZW5kZXJlci5zeW1ib2xzLmFyYyhoWzBdLGhbMV0sZi1iLG51bGwse3N0YXJ0OmMsZW5kOmQsaW5uZXJSOmYtbyhhLGYpfSl9LHcoZCxcImFuaW1hdGVcIixhKSx3KGQsXCJ0cmFuc2xhdGVcIixmdW5jdGlvbihhKXt2YXIgYj10aGlzLnhBeGlzLGM9Yi5zdGFydEFuZ2xlUmFkLGQsaCxmO3RoaXMucHJldmVudFBvc3RUcmFuc2xhdGU9ITA7YS5jYWxsKHRoaXMpO2lmKGIuaXNSYWRpYWwpe2Q9dGhpcy5wb2ludHM7Zm9yKGY9ZC5sZW5ndGg7Zi0tOyloPWRbZl0sYT1oLmJhclgrYyxoLnNoYXBlVHlwZT1cInBhdGhcIixoLnNoYXBlQXJncz10aGlzLnBvbGFyQXJjKGgueUJvdHRvbSxoLnBsb3RZLGEsXG5hK2gucG9pbnRXaWR0aCksdGhpcy50b1hZKGgpLGgudG9vbHRpcFBvcz1baC5wbG90WCxoLnBsb3RZXSxoLnR0QmVsb3c9aC5wbG90WT5iLmNlbnRlclsxXX19KSx3KGQsXCJhbGlnbkRhdGFMYWJlbFwiLGZ1bmN0aW9uKGEsYyxkLGksaCxmKXtpZih0aGlzLmNoYXJ0LnBvbGFyKXthPWMucmVjdFBsb3RYL01hdGguUEkqMTgwO2lmKGkuYWxpZ249PT1udWxsKWkuYWxpZ249YT4yMCYmYTwxNjA/XCJsZWZ0XCI6YT4yMDAmJmE8MzQwP1wicmlnaHRcIjpcImNlbnRlclwiO2lmKGkudmVydGljYWxBbGlnbj09PW51bGwpaS52ZXJ0aWNhbEFsaWduPWE8NDV8fGE+MzE1P1wiYm90dG9tXCI6YT4xMzUmJmE8MjI1P1widG9wXCI6XCJtaWRkbGVcIjtiLmFsaWduRGF0YUxhYmVsLmNhbGwodGhpcyxjLGQsaSxoLGYpfWVsc2UgYS5jYWxsKHRoaXMsYyxkLGksaCxmKX0pO3coYyxcImdldENvb3JkaW5hdGVzXCIsZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmNoYXJ0LGQ9e3hBeGlzOltdLHlBeGlzOltdfTtjLnBvbGFyP3QoYy5heGVzLFxuZnVuY3Rpb24oYSl7dmFyIGY9YS5pc1hBeGlzLGc9YS5jZW50ZXIsaT1iLmNoYXJ0WC1nWzBdLWMucGxvdExlZnQsZz1iLmNoYXJ0WS1nWzFdLWMucGxvdFRvcDtkW2Y/XCJ4QXhpc1wiOlwieUF4aXNcIl0ucHVzaCh7YXhpczphLHZhbHVlOmEudHJhbnNsYXRlKGY/TWF0aC5QSS1NYXRoLmF0YW4yKGksZyk6TWF0aC5zcXJ0KE1hdGgucG93KGksMikrTWF0aC5wb3coZywyKSksITApfSl9KTpkPWEuY2FsbCh0aGlzLGIpO3JldHVybiBkfSl9KSgpfSk7XG4iLCIvKlxuIEhpZ2hzdG9jayBKUyB2NC4yLjQgKDIwMTYtMDQtMTQpXG5cbiAoYykgMjAwOS0yMDE2IFRvcnN0ZWluIEhvbnNpXG5cbiBMaWNlbnNlOiB3d3cuaGlnaGNoYXJ0cy5jb20vbGljZW5zZVxuKi9cbihmdW5jdGlvbihKLGdhKXt0eXBlb2YgbW9kdWxlPT09XCJvYmplY3RcIiYmbW9kdWxlLmV4cG9ydHM/bW9kdWxlLmV4cG9ydHM9Si5kb2N1bWVudD9nYShKKTpnYTpKLkhpZ2hjaGFydHM9Z2EoSil9KSh0eXBlb2Ygd2luZG93IT09XCJ1bmRlZmluZWRcIj93aW5kb3c6dGhpcyxmdW5jdGlvbihKKXtmdW5jdGlvbiBnYShhLGIpe3ZhciBjPVwiSGlnaGNoYXJ0cyBlcnJvciAjXCIrYStcIjogd3d3LmhpZ2hjaGFydHMuY29tL2Vycm9ycy9cIithO2lmKGIpdGhyb3cgRXJyb3IoYyk7Si5jb25zb2xlJiZjb25zb2xlLmxvZyhjKX1mdW5jdGlvbiB5YihhLGIsYyl7dGhpcy5vcHRpb25zPWI7dGhpcy5lbGVtPWE7dGhpcy5wcm9wPWN9ZnVuY3Rpb24gQygpe3ZhciBhLGI9YXJndW1lbnRzLGMsZD17fSxlPWZ1bmN0aW9uKGEsYil7dmFyIGMsZDt0eXBlb2YgYSE9PVwib2JqZWN0XCImJihhPXt9KTtmb3IoZCBpbiBiKWIuaGFzT3duUHJvcGVydHkoZCkmJihjPWJbZF0sYVtkXT1jJiZ0eXBlb2YgYz09PVwib2JqZWN0XCImJlxuT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGMpIT09XCJbb2JqZWN0IEFycmF5XVwiJiZkIT09XCJyZW5kZXJUb1wiJiZ0eXBlb2YgYy5ub2RlVHlwZSE9PVwibnVtYmVyXCI/ZShhW2RdfHx7fSxjKTpiW2RdKTtyZXR1cm4gYX07YlswXT09PSEwJiYoZD1iWzFdLGI9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYiwyKSk7Yz1iLmxlbmd0aDtmb3IoYT0wO2E8YzthKyspZD1lKGQsYlthXSk7cmV0dXJuIGR9ZnVuY3Rpb24gRyhhLGIpe3JldHVybiBwYXJzZUludChhLGJ8fDEwKX1mdW5jdGlvbiBEYShhKXtyZXR1cm4gdHlwZW9mIGE9PT1cInN0cmluZ1wifWZ1bmN0aW9uIGRhKGEpe3JldHVybiBhJiZ0eXBlb2YgYT09PVwib2JqZWN0XCJ9ZnVuY3Rpb24gSmEoYSl7cmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChhKT09PVwiW29iamVjdCBBcnJheV1cIn1mdW5jdGlvbiB1YShhKXtyZXR1cm4gdHlwZW9mIGE9PT1cIm51bWJlclwifWZ1bmN0aW9uIEFhKGEsYil7Zm9yKHZhciBjPVxuYS5sZW5ndGg7Yy0tOylpZihhW2NdPT09Yil7YS5zcGxpY2UoYywxKTticmVha319ZnVuY3Rpb24gcyhhKXtyZXR1cm4gYSE9PXQmJmEhPT1udWxsfWZ1bmN0aW9uIFgoYSxiLGMpe3ZhciBkLGU7aWYoRGEoYikpcyhjKT9hLnNldEF0dHJpYnV0ZShiLGMpOmEmJmEuZ2V0QXR0cmlidXRlJiYoZT1hLmdldEF0dHJpYnV0ZShiKSk7ZWxzZSBpZihzKGIpJiZkYShiKSlmb3IoZCBpbiBiKWEuc2V0QXR0cmlidXRlKGQsYltkXSk7cmV0dXJuIGV9ZnVuY3Rpb24gdmEoYSl7cmV0dXJuIEphKGEpP2E6W2FdfWZ1bmN0aW9uICRhKGEsYixjKXtpZihiKXJldHVybiBzZXRUaW1lb3V0KGEsYixjKTthLmNhbGwoMCxjKX1mdW5jdGlvbiBGKGEsYil7aWYoS2EmJiFqYSYmYiYmYi5vcGFjaXR5IT09dCliLmZpbHRlcj1cImFscGhhKG9wYWNpdHk9XCIrYi5vcGFjaXR5KjEwMCtcIilcIjt4KGEuc3R5bGUsYil9ZnVuY3Rpb24gZWEoYSxiLGMsZCxlKXthPUIuY3JlYXRlRWxlbWVudChhKTtiJiZ4KGEsYik7ZSYmXG5GKGEse3BhZGRpbmc6MCxib3JkZXI6XCJub25lXCIsbWFyZ2luOjB9KTtjJiZGKGEsYyk7ZCYmZC5hcHBlbmRDaGlsZChhKTtyZXR1cm4gYX1mdW5jdGlvbiBsYShhLGIpe3ZhciBjPWZ1bmN0aW9uKCl7fTtjLnByb3RvdHlwZT1uZXcgYTt4KGMucHJvdG90eXBlLGIpO3JldHVybiBjfWZ1bmN0aW9uIE5hKGEsYixjKXtyZXR1cm4gQXJyYXkoKGJ8fDIpKzEtU3RyaW5nKGEpLmxlbmd0aCkuam9pbihjfHwwKSthfWZ1bmN0aW9uIGZiKGEpe3JldHVybihnYiYmZ2IoYSl8fHpifHwwKSo2RTR9ZnVuY3Rpb24gTGEoYSxiKXtmb3IodmFyIGM9XCJ7XCIsZD0hMSxlLGYsZyxoLGksaj1bXTsoYz1hLmluZGV4T2YoYykpIT09LTE7KXtlPWEuc2xpY2UoMCxjKTtpZihkKXtmPWUuc3BsaXQoXCI6XCIpO2c9Zi5zaGlmdCgpLnNwbGl0KFwiLlwiKTtpPWcubGVuZ3RoO2U9Yjtmb3IoaD0wO2g8aTtoKyspZT1lW2dbaF1dO2lmKGYubGVuZ3RoKWY9Zi5qb2luKFwiOlwiKSxnPS9cXC4oWzAtOV0pLyxoPU4ubGFuZyxpPVxudm9pZCAwLC9mJC8udGVzdChmKT8oaT0oaT1mLm1hdGNoKGcpKT9pWzFdOi0xLGUhPT1udWxsJiYoZT16Lm51bWJlckZvcm1hdChlLGksaC5kZWNpbWFsUG9pbnQsZi5pbmRleE9mKFwiLFwiKT4tMT9oLnRob3VzYW5kc1NlcDpcIlwiKSkpOmU9bWEoZixlKX1qLnB1c2goZSk7YT1hLnNsaWNlKGMrMSk7Yz0oZD0hZCk/XCJ9XCI6XCJ7XCJ9ai5wdXNoKGEpO3JldHVybiBqLmpvaW4oXCJcIil9ZnVuY3Rpb24gQWIoYSl7cmV0dXJuIFkucG93KDEwLFYoWS5sb2coYSkvWS5MTjEwKSl9ZnVuY3Rpb24gQmIoYSxiLGMsZCxlKXt2YXIgZixnPWEsYz1xKGMsMSk7Zj1hL2M7Ynx8KGI9WzEsMiwyLjUsNSwxMF0sZD09PSExJiYoYz09PTE/Yj1bMSwyLDUsMTBdOmM8PTAuMSYmKGI9WzEvY10pKSk7Zm9yKGQ9MDtkPGIubGVuZ3RoO2QrKylpZihnPWJbZF0sZSYmZypjPj1hfHwhZSYmZjw9KGJbZF0rKGJbZCsxXXx8YltkXSkpLzIpYnJlYWs7Zyo9YztyZXR1cm4gZ31mdW5jdGlvbiBvYihhLGIpe3ZhciBjPWEubGVuZ3RoLFxuZCxlO2ZvcihlPTA7ZTxjO2UrKylhW2VdLnNhZmVJPWU7YS5zb3J0KGZ1bmN0aW9uKGEsYyl7ZD1iKGEsYyk7cmV0dXJuIGQ9PT0wP2Euc2FmZUktYy5zYWZlSTpkfSk7Zm9yKGU9MDtlPGM7ZSsrKWRlbGV0ZSBhW2VdLnNhZmVJfWZ1bmN0aW9uIE9hKGEpe2Zvcih2YXIgYj1hLmxlbmd0aCxjPWFbMF07Yi0tOylhW2JdPGMmJihjPWFbYl0pO3JldHVybiBjfWZ1bmN0aW9uIEVhKGEpe2Zvcih2YXIgYj1hLmxlbmd0aCxjPWFbMF07Yi0tOylhW2JdPmMmJihjPWFbYl0pO3JldHVybiBjfWZ1bmN0aW9uIFBhKGEsYil7Zm9yKHZhciBjIGluIGEpYVtjXSYmYVtjXSE9PWImJmFbY10uZGVzdHJveSYmYVtjXS5kZXN0cm95KCksZGVsZXRlIGFbY119ZnVuY3Rpb24gVmEoYSl7cGJ8fChwYj1lYShXYSkpO2EmJnBiLmFwcGVuZENoaWxkKGEpO3BiLmlubmVySFRNTD1cIlwifWZ1bmN0aW9uIG5hKGEsYil7cmV0dXJuIHBhcnNlRmxvYXQoYS50b1ByZWNpc2lvbihifHwxNCkpfWZ1bmN0aW9uIGFiKGEsXG5iKXtiLnJlbmRlcmVyLmdsb2JhbEFuaW1hdGlvbj1xKGEsYi5hbmltYXRpb24pfWZ1bmN0aW9uIGhiKGEpe3JldHVybiBkYShhKT9DKGEpOntkdXJhdGlvbjphPzUwMDowfX1mdW5jdGlvbiBPYigpe3ZhciBhPU4uZ2xvYmFsLGI9YS51c2VVVEMsYz1iP1wiZ2V0VVRDXCI6XCJnZXRcIixkPWI/XCJzZXRVVENcIjpcInNldFwiO2ZhPWEuRGF0ZXx8Si5EYXRlO3piPWImJmEudGltZXpvbmVPZmZzZXQ7Z2I9YiYmYS5nZXRUaW1lem9uZU9mZnNldDtxYj1mdW5jdGlvbihhLGMsZCxoLGksail7dmFyIGs7Yj8oaz1mYS5VVEMuYXBwbHkoMCxhcmd1bWVudHMpLGsrPWZiKGspKTprPShuZXcgZmEoYSxjLHEoZCwxKSxxKGgsMCkscShpLDApLHEoaiwwKSkpLmdldFRpbWUoKTtyZXR1cm4ga307Q2I9YytcIk1pbnV0ZXNcIjtEYj1jK1wiSG91cnNcIjtFYj1jK1wiRGF5XCI7YmI9YytcIkRhdGVcIjtpYj1jK1wiTW9udGhcIjtqYj1jK1wiRnVsbFllYXJcIjtQYj1kK1wiTWlsbGlzZWNvbmRzXCI7UWI9ZCtcIlNlY29uZHNcIjtSYj1kK1wiTWludXRlc1wiO1xuU2I9ZCtcIkhvdXJzXCI7cmI9ZCtcIkRhdGVcIjtGYj1kK1wiTW9udGhcIjtHYj1kK1wiRnVsbFllYXJcIn1mdW5jdGlvbiB3YShhKXtpZighKHRoaXMgaW5zdGFuY2VvZiB3YSkpcmV0dXJuIG5ldyB3YShhKTt0aGlzLmluaXQoYSl9ZnVuY3Rpb24gWigpe31mdW5jdGlvbiBjYihhLGIsYyxkKXt0aGlzLmF4aXM9YTt0aGlzLnBvcz1iO3RoaXMudHlwZT1jfHxcIlwiO3RoaXMuaXNOZXc9ITA7IWMmJiFkJiZ0aGlzLmFkZExhYmVsKCl9ZnVuY3Rpb24gVGIoYSxiLGMsZCxlKXt2YXIgZj1hLmNoYXJ0LmludmVydGVkO3RoaXMuYXhpcz1hO3RoaXMuaXNOZWdhdGl2ZT1jO3RoaXMub3B0aW9ucz1iO3RoaXMueD1kO3RoaXMudG90YWw9bnVsbDt0aGlzLnBvaW50cz17fTt0aGlzLnN0YWNrPWU7dGhpcy5yaWdodENsaWZmPXRoaXMubGVmdENsaWZmPTA7dGhpcy5hbGlnbk9wdGlvbnM9e2FsaWduOmIuYWxpZ258fChmP2M/XCJsZWZ0XCI6XCJyaWdodFwiOlwiY2VudGVyXCIpLHZlcnRpY2FsQWxpZ246Yi52ZXJ0aWNhbEFsaWdufHxcbihmP1wibWlkZGxlXCI6Yz9cImJvdHRvbVwiOlwidG9wXCIpLHk6cShiLnksZj80OmM/MTQ6LTYpLHg6cShiLngsZj9jPy02OjY6MCl9O3RoaXMudGV4dEFsaWduPWIudGV4dEFsaWdufHwoZj9jP1wicmlnaHRcIjpcImxlZnRcIjpcImNlbnRlclwiKX1mdW5jdGlvbiBIYihhKXt2YXIgYj1hLm9wdGlvbnMsYz1iLm5hdmlnYXRvcixkPWMuZW5hYmxlZCxiPWIuc2Nyb2xsYmFyLGU9Yi5lbmFibGVkLGY9ZD9jLmhlaWdodDowLGc9ZT9iLmhlaWdodDowO3RoaXMuaGFuZGxlcz1bXTt0aGlzLnNjcm9sbGJhckJ1dHRvbnM9W107dGhpcy5lbGVtZW50c1RvRGVzdHJveT1bXTt0aGlzLmNoYXJ0PWE7dGhpcy5zZXRCYXNlU2VyaWVzKCk7dGhpcy5oZWlnaHQ9Zjt0aGlzLnNjcm9sbGJhckhlaWdodD1nO3RoaXMuc2Nyb2xsYmFyRW5hYmxlZD1lO3RoaXMubmF2aWdhdG9yRW5hYmxlZD1kO3RoaXMubmF2aWdhdG9yT3B0aW9ucz1jO3RoaXMuc2Nyb2xsYmFyT3B0aW9ucz1iO3RoaXMub3V0bGluZUhlaWdodD1mK2c7dGhpcy5pbml0KCl9XG5mdW5jdGlvbiBJYihhKXt0aGlzLmluaXQoYSl9dmFyIHQsQj1KLmRvY3VtZW50LFk9TWF0aCx5PVkucm91bmQsVj1ZLmZsb29yLEZhPVkuY2VpbCx2PVkubWF4LEU9WS5taW4sUz1ZLmFicyxiYT1ZLmNvcyxrYT1ZLnNpbixCYT1ZLlBJLHBhPUJhKjIvMzYwLE1hPUoubmF2aWdhdG9yJiZKLm5hdmlnYXRvci51c2VyQWdlbnR8fFwiXCIsVWI9Si5vcGVyYSxLYT0vKG1zaWV8dHJpZGVudHxlZGdlKS9pLnRlc3QoTWEpJiYhVWIsc2I9QiYmQi5kb2N1bWVudE1vZGU9PT04LHRiPSFLYSYmL0FwcGxlV2ViS2l0Ly50ZXN0KE1hKSxYYT0vRmlyZWZveC8udGVzdChNYSksa2I9LyhNb2JpbGV8QW5kcm9pZHxXaW5kb3dzIFBob25lKS8udGVzdChNYSksUWE9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiLGphPUImJkIuY3JlYXRlRWxlbWVudE5TJiYhIUIuY3JlYXRlRWxlbWVudE5TKFFhLFwic3ZnXCIpLmNyZWF0ZVNWR1JlY3QsWmI9WGEmJnBhcnNlSW50KE1hLnNwbGl0KFwiRmlyZWZveC9cIilbMV0sXG4xMCk8NCxxYT1CJiYhamEmJiFLYSYmISFCLmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIikuZ2V0Q29udGV4dCxZYSxkYixWYj17fSxKYj0wLHBiLE4sbWEsSCxyYT1mdW5jdGlvbigpe30sJD1bXSxsYj0wLFdhPVwiZGl2XCIsJGI9L15bMC05XSskLyx1Yj1bXCJwbG90VG9wXCIsXCJtYXJnaW5SaWdodFwiLFwibWFyZ2luQm90dG9tXCIsXCJwbG90TGVmdFwiXSxmYSxxYix6YixnYixDYixEYixFYixiYixpYixqYixQYixRYixSYixTYixyYixGYixHYixLPXt9LHo7ej1KLkhpZ2hjaGFydHM/Z2EoMTYsITApOnt3aW46Sn07ei5zZXJpZXNUeXBlcz1LO3ZhciBSYT1bXSx4YSxzYSxuLFNhLEtiLHRhLEQsVCxNLGViLFRhO3liLnByb3RvdHlwZT17ZFNldHRlcjpmdW5jdGlvbigpe3ZhciBhPXRoaXMucGF0aHNbMF0sYj10aGlzLnBhdGhzWzFdLGM9W10sZD10aGlzLm5vdyxlPWEubGVuZ3RoLGY7aWYoZD09PTEpYz10aGlzLnRvRDtlbHNlIGlmKGU9PT1iLmxlbmd0aCYmZDwxKWZvcig7ZS0tOylmPXBhcnNlRmxvYXQoYVtlXSksXG5jW2VdPWlzTmFOKGYpP2FbZV06ZCpwYXJzZUZsb2F0KGJbZV0tZikrZjtlbHNlIGM9Yjt0aGlzLmVsZW0uYXR0cihcImRcIixjKX0sdXBkYXRlOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5lbGVtLGI9dGhpcy5wcm9wLGM9dGhpcy5ub3csZD10aGlzLm9wdGlvbnMuc3RlcDtpZih0aGlzW2IrXCJTZXR0ZXJcIl0pdGhpc1tiK1wiU2V0dGVyXCJdKCk7ZWxzZSBhLmF0dHI/YS5lbGVtZW50JiZhLmF0dHIoYixjKTphLnN0eWxlW2JdPWMrdGhpcy51bml0O2QmJmQuY2FsbChhLGMsdGhpcyl9LHJ1bjpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9dGhpcyxlPWZ1bmN0aW9uKGEpe3JldHVybiBlLnN0b3BwZWQ/ITE6ZC5zdGVwKGEpfSxmO3RoaXMuc3RhcnRUaW1lPStuZXcgZmE7dGhpcy5zdGFydD1hO3RoaXMuZW5kPWI7dGhpcy51bml0PWM7dGhpcy5ub3c9dGhpcy5zdGFydDt0aGlzLnBvcz0wO2UuZWxlbT10aGlzLmVsZW07aWYoZSgpJiZSYS5wdXNoKGUpPT09MSllLnRpbWVySWQ9c2V0SW50ZXJ2YWwoZnVuY3Rpb24oKXtmb3IoZj1cbjA7ZjxSYS5sZW5ndGg7ZisrKVJhW2ZdKCl8fFJhLnNwbGljZShmLS0sMSk7UmEubGVuZ3RofHxjbGVhckludGVydmFsKGUudGltZXJJZCl9LDEzKX0sc3RlcDpmdW5jdGlvbihhKXt2YXIgYj0rbmV3IGZhLGMsZD10aGlzLm9wdGlvbnM7Yz10aGlzLmVsZW07dmFyIGU9ZC5jb21wbGV0ZSxmPWQuZHVyYXRpb24sZz1kLmN1ckFuaW0saDtpZihjLmF0dHImJiFjLmVsZW1lbnQpYz0hMTtlbHNlIGlmKGF8fGI+PWYrdGhpcy5zdGFydFRpbWUpe3RoaXMubm93PXRoaXMuZW5kO3RoaXMucG9zPTE7dGhpcy51cGRhdGUoKTthPWdbdGhpcy5wcm9wXT0hMDtmb3IoaCBpbiBnKWdbaF0hPT0hMCYmKGE9ITEpO2EmJmUmJmUuY2FsbChjKTtjPSExfWVsc2UgdGhpcy5wb3M9ZC5lYXNpbmcoKGItdGhpcy5zdGFydFRpbWUpL2YpLHRoaXMubm93PXRoaXMuc3RhcnQrKHRoaXMuZW5kLXRoaXMuc3RhcnQpKnRoaXMucG9zLHRoaXMudXBkYXRlKCksYz0hMDtyZXR1cm4gY30saW5pdFBhdGg6ZnVuY3Rpb24oYSxcbmIsYyl7dmFyIGI9Ynx8XCJcIixkPWEuc2hpZnQsZT1iLmluZGV4T2YoXCJDXCIpPi0xLGY9ZT83OjMsZyxiPWIuc3BsaXQoXCIgXCIpLGM9W10uY29uY2F0KGMpLGg9YS5pc0FyZWEsaT1oPzI6MSxqPWZ1bmN0aW9uKGEpe2ZvcihnPWEubGVuZ3RoO2ctLTspKGFbZ109PT1cIk1cInx8YVtnXT09PVwiTFwiKSYmYS5zcGxpY2UoZysxLDAsYVtnKzFdLGFbZysyXSxhW2crMV0sYVtnKzJdKX07ZSYmKGooYiksaihjKSk7aWYoZDw9Yy5sZW5ndGgvZiYmYi5sZW5ndGg9PT1jLmxlbmd0aClmb3IoO2QtLTspYz1jLnNsaWNlKDAsZikuY29uY2F0KGMpLGgmJihjPWMuY29uY2F0KGMuc2xpY2UoYy5sZW5ndGgtZikpKTthLnNoaWZ0PTA7aWYoYi5sZW5ndGgpZm9yKGE9Yy5sZW5ndGg7Yi5sZW5ndGg8YTspZD1iLnNsaWNlKCkuc3BsaWNlKGIubGVuZ3RoL2ktZixmKmkpLGUmJihkW2YtNl09ZFtmLTJdLGRbZi01XT1kW2YtMV0pLFtdLnNwbGljZS5hcHBseShiLFtiLmxlbmd0aC9pLDBdLmNvbmNhdChkKSk7cmV0dXJuW2IsXG5jXX19O3ZhciB4PXouZXh0ZW5kPWZ1bmN0aW9uKGEsYil7dmFyIGM7YXx8KGE9e30pO2ZvcihjIGluIGIpYVtjXT1iW2NdO3JldHVybiBhfSxxPXoucGljaz1mdW5jdGlvbigpe3ZhciBhPWFyZ3VtZW50cyxiLGMsZD1hLmxlbmd0aDtmb3IoYj0wO2I8ZDtiKyspaWYoYz1hW2JdLGMhPT10JiZjIT09bnVsbClyZXR1cm4gY30sVT16LndyYXA9ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPWFbYl07YVtiXT1mdW5jdGlvbigpe3ZhciBhPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7YS51bnNoaWZ0KGQpO3JldHVybiBjLmFwcGx5KHRoaXMsYSl9fTttYT1mdW5jdGlvbihhLGIsYyl7aWYoIXMoYil8fGlzTmFOKGIpKXJldHVybiBOLmxhbmcuaW52YWxpZERhdGV8fFwiXCI7dmFyIGE9cShhLFwiJVktJW0tJWQgJUg6JU06JVNcIiksZD1uZXcgZmEoYi1mYihiKSksZSxmPWRbRGJdKCksZz1kW0ViXSgpLGg9ZFtiYl0oKSxpPWRbaWJdKCksaj1kW2piXSgpLGs9Ti5sYW5nLGw9ay53ZWVrZGF5cyxcbm09ay5zaG9ydFdlZWtkYXlzLGQ9eCh7YTptP21bZ106bFtnXS5zdWJzdHIoMCwzKSxBOmxbZ10sZDpOYShoKSxlOk5hKGgsMixcIiBcIiksdzpnLGI6ay5zaG9ydE1vbnRoc1tpXSxCOmsubW9udGhzW2ldLG06TmEoaSsxKSx5OmoudG9TdHJpbmcoKS5zdWJzdHIoMiwyKSxZOmosSDpOYShmKSxrOmYsSTpOYShmJTEyfHwxMiksbDpmJTEyfHwxMixNOk5hKGRbQ2JdKCkpLHA6ZjwxMj9cIkFNXCI6XCJQTVwiLFA6ZjwxMj9cImFtXCI6XCJwbVwiLFM6TmEoZC5nZXRTZWNvbmRzKCkpLEw6TmEoeShiJTFFMyksMyl9LHouZGF0ZUZvcm1hdHMpO2ZvcihlIGluIGQpZm9yKDthLmluZGV4T2YoXCIlXCIrZSkhPT0tMTspYT1hLnJlcGxhY2UoXCIlXCIrZSx0eXBlb2YgZFtlXT09PVwiZnVuY3Rpb25cIj9kW2VdKGIpOmRbZV0pO3JldHVybiBjP2Euc3Vic3RyKDAsMSkudG9VcHBlckNhc2UoKSthLnN1YnN0cigxKTphfTtIPXttaWxsaXNlY29uZDoxLHNlY29uZDoxRTMsbWludXRlOjZFNCxob3VyOjM2RTUsZGF5Ojg2NEU1LFxud2Vlazo2MDQ4RTUsbW9udGg6MjQxOTJFNSx5ZWFyOjMxNDQ5NkU1fTt6Lm51bWJlckZvcm1hdD1mdW5jdGlvbihhLGIsYyxkKXt2YXIgYT0rYXx8MCxlPU4ubGFuZyxmPShhLnRvU3RyaW5nKCkuc3BsaXQoXCIuXCIpWzFdfHxcIlwiKS5sZW5ndGgsZyxoLGk9TWF0aC5hYnMoYSk7Yj09PS0xP2I9TWF0aC5taW4oZiwyMCk6aXNOYU4oYikmJihiPTIpO2c9U3RyaW5nKEcoaS50b0ZpeGVkKGIpKSk7aD1nLmxlbmd0aD4zP2cubGVuZ3RoJTM6MDtjPXEoYyxlLmRlY2ltYWxQb2ludCk7ZD1xKGQsZS50aG91c2FuZHNTZXApO2E9YTwwP1wiLVwiOlwiXCI7YSs9aD9nLnN1YnN0cigwLGgpK2Q6XCJcIjthKz1nLnN1YnN0cihoKS5yZXBsYWNlKC8oXFxkezN9KSg/PVxcZCkvZyxcIiQxXCIrZCk7K2ImJihkPU1hdGguYWJzKGktZytNYXRoLnBvdygxMCwtTWF0aC5tYXgoYixmKS0xKSksYSs9YytkLnRvRml4ZWQoYikuc2xpY2UoMikpO3JldHVybiBhfTtNYXRoLmVhc2VJbk91dFNpbmU9ZnVuY3Rpb24oYSl7cmV0dXJuLTAuNSpcbihNYXRoLmNvcyhNYXRoLlBJKmEpLTEpfTt4YT1mdW5jdGlvbihhLGIpe3ZhciBjO2lmKGI9PT1cIndpZHRoXCIpcmV0dXJuIE1hdGgubWluKGEub2Zmc2V0V2lkdGgsYS5zY3JvbGxXaWR0aCkteGEoYSxcInBhZGRpbmctbGVmdFwiKS14YShhLFwicGFkZGluZy1yaWdodFwiKTtlbHNlIGlmKGI9PT1cImhlaWdodFwiKXJldHVybiBNYXRoLm1pbihhLm9mZnNldEhlaWdodCxhLnNjcm9sbEhlaWdodCkteGEoYSxcInBhZGRpbmctdG9wXCIpLXhhKGEsXCJwYWRkaW5nLWJvdHRvbVwiKTtyZXR1cm4oYz1KLmdldENvbXB1dGVkU3R5bGUoYSx2b2lkIDApKSYmRyhjLmdldFByb3BlcnR5VmFsdWUoYikpfTtzYT1mdW5jdGlvbihhLGIpe3JldHVybiBiLmluZGV4T2Y/Yi5pbmRleE9mKGEpOltdLmluZGV4T2YuY2FsbChiLGEpfTtTYT1mdW5jdGlvbihhLGIpe3JldHVybltdLmZpbHRlci5jYWxsKGEsYil9O3RhPWZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPVtdLGQ9MCxlPWEubGVuZ3RoO2Q8ZTtkKyspY1tkXT1iLmNhbGwoYVtkXSxcbmFbZF0sZCxhKTtyZXR1cm4gY307S2I9ZnVuY3Rpb24oYSl7dmFyIGI9Qi5kb2N1bWVudEVsZW1lbnQsYT1hLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO3JldHVybnt0b3A6YS50b3ArKEoucGFnZVlPZmZzZXR8fGIuc2Nyb2xsVG9wKS0oYi5jbGllbnRUb3B8fDApLGxlZnQ6YS5sZWZ0KyhKLnBhZ2VYT2Zmc2V0fHxiLnNjcm9sbExlZnQpLShiLmNsaWVudExlZnR8fDApfX07VGE9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPVJhLmxlbmd0aDtiLS07KWlmKFJhW2JdLmVsZW09PT1hKVJhW2JdLnN0b3BwZWQ9ITB9O249ZnVuY3Rpb24oYSxiKXtyZXR1cm4gQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChhLGIpfTtEPWZ1bmN0aW9uKGEsYixjKXtmdW5jdGlvbiBkKGIpe2IudGFyZ2V0PWIuc3JjRWxlbWVudHx8SjtjLmNhbGwoYSxiKX12YXIgZT1hLmhjRXZlbnRzPWEuaGNFdmVudHN8fHt9O2lmKGEuYWRkRXZlbnRMaXN0ZW5lcilhLmFkZEV2ZW50TGlzdGVuZXIoYixjLCExKTtlbHNlIGlmKGEuYXR0YWNoRXZlbnQpe2lmKCFhLmhjRXZlbnRzSUUpYS5oY0V2ZW50c0lFPVxue307YS5oY0V2ZW50c0lFW2MudG9TdHJpbmcoKV09ZDthLmF0dGFjaEV2ZW50KFwib25cIitiLGQpfWVbYl18fChlW2JdPVtdKTtlW2JdLnB1c2goYyl9O1Q9ZnVuY3Rpb24oYSxiLGMpe2Z1bmN0aW9uIGQoYixjKXthLnJlbW92ZUV2ZW50TGlzdGVuZXI/YS5yZW1vdmVFdmVudExpc3RlbmVyKGIsYywhMSk6YS5hdHRhY2hFdmVudCYmKGM9YS5oY0V2ZW50c0lFW2MudG9TdHJpbmcoKV0sYS5kZXRhY2hFdmVudChcIm9uXCIrYixjKSl9ZnVuY3Rpb24gZSgpe3ZhciBjLGUsZjtpZihhLm5vZGVOYW1lKWZvcihmIGluIGI/KGM9e30sY1tiXT0hMCk6Yz1nLGMpaWYoZ1tmXSlmb3IoZT1nW2ZdLmxlbmd0aDtlLS07KWQoZixnW2ZdW2VdKX12YXIgZixnPWEuaGNFdmVudHMsaDtpZihnKWI/KGY9Z1tiXXx8W10sYz8oaD1zYShjLGYpLGg+LTEmJihmLnNwbGljZShoLDEpLGdbYl09ZiksZChiLGMpKTooZSgpLGdbYl09W10pKTooZSgpLGEuaGNFdmVudHM9e30pfTtNPWZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlO1xuZT1hLmhjRXZlbnRzO3ZhciBmLGcsYz1jfHx7fTtpZihCLmNyZWF0ZUV2ZW50JiYoYS5kaXNwYXRjaEV2ZW50fHxhLmZpcmVFdmVudCkpZT1CLmNyZWF0ZUV2ZW50KFwiRXZlbnRzXCIpLGUuaW5pdEV2ZW50KGIsITAsITApLGUudGFyZ2V0PWEseChlLGMpLGEuZGlzcGF0Y2hFdmVudD9hLmRpc3BhdGNoRXZlbnQoZSk6YS5maXJlRXZlbnQoYixlKTtlbHNlIGlmKGUpe2U9ZVtiXXx8W107Zj1lLmxlbmd0aDtpZighYy5wcmV2ZW50RGVmYXVsdCljLnByZXZlbnREZWZhdWx0PWZ1bmN0aW9uKCl7Yy5kZWZhdWx0UHJldmVudGVkPSEwfTtjLnRhcmdldD1hO2lmKCFjLnR5cGUpYy50eXBlPWI7Zm9yKGI9MDtiPGY7YisrKWc9ZVtiXSxnLmNhbGwoYSxjKT09PSExJiZjLnByZXZlbnREZWZhdWx0KCl9ZCYmIWMuZGVmYXVsdFByZXZlbnRlZCYmZChjKX07ZWI9ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGU9XCJcIixmLGcsaDtkYShjKXx8KGQ9YXJndW1lbnRzLGM9e2R1cmF0aW9uOmRbMl0sZWFzaW5nOmRbM10sXG5jb21wbGV0ZTpkWzRdfSk7aWYoIXVhKGMuZHVyYXRpb24pKWMuZHVyYXRpb249NDAwO2MuZWFzaW5nPXR5cGVvZiBjLmVhc2luZz09PVwiZnVuY3Rpb25cIj9jLmVhc2luZzpNYXRoW2MuZWFzaW5nXXx8TWF0aC5lYXNlSW5PdXRTaW5lO2MuY3VyQW5pbT1DKGIpO2ZvcihoIGluIGIpZz1uZXcgeWIoYSxjLGgpLGY9bnVsbCxoPT09XCJkXCI/KGcucGF0aHM9Zy5pbml0UGF0aChhLGEuZCxiLmQpLGcudG9EPWIuZCxkPTAsZj0xKTphLmF0dHI/ZD1hLmF0dHIoaCk6KGQ9cGFyc2VGbG9hdCh4YShhLGgpKXx8MCxoIT09XCJvcGFjaXR5XCImJihlPVwicHhcIikpLGZ8fChmPWJbaF0pLGYubWF0Y2gmJmYubWF0Y2goXCJweFwiKSYmKGY9Zi5yZXBsYWNlKC9weC9nLFwiXCIpKSxnLnJ1bihkLGYsZSl9O2lmKEoualF1ZXJ5KUoualF1ZXJ5LmZuLmhpZ2hjaGFydHM9ZnVuY3Rpb24oKXt2YXIgYT1bXS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7aWYodGhpc1swXSlyZXR1cm4gYVswXT8obmV3ICh6W0RhKGFbMF0pP2Euc2hpZnQoKTpcblwiQ2hhcnRcIl0pKHRoaXNbMF0sYVswXSxhWzFdKSx0aGlzKTokW1godGhpc1swXSxcImRhdGEtaGlnaGNoYXJ0cy1jaGFydFwiKV19O0ImJiFCLmRlZmF1bHRWaWV3JiYoeGE9ZnVuY3Rpb24oYSxiKXt2YXIgYztjPXt3aWR0aDpcImNsaWVudFdpZHRoXCIsaGVpZ2h0OlwiY2xpZW50SGVpZ2h0XCJ9W2JdO2lmKGEuc3R5bGVbYl0pcmV0dXJuIEcoYS5zdHlsZVtiXSk7Yj09PVwib3BhY2l0eVwiJiYoYj1cImZpbHRlclwiKTtpZihjKXJldHVybiBhLnN0eWxlLnpvb209MSxNYXRoLm1heChhW2NdLTIqeGEoYSxcInBhZGRpbmdcIiksMCk7Yz1hLmN1cnJlbnRTdHlsZVtiLnJlcGxhY2UoL1xcLShcXHcpL2csZnVuY3Rpb24oYSxiKXtyZXR1cm4gYi50b1VwcGVyQ2FzZSgpfSldO2I9PT1cImZpbHRlclwiJiYoYz1jLnJlcGxhY2UoL2FscGhhXFwob3BhY2l0eT0oWzAtOV0rKVxcKS8sZnVuY3Rpb24oYSxiKXtyZXR1cm4gYi8xMDB9KSk7cmV0dXJuIGM9PT1cIlwiPzE6RyhjKX0pO0FycmF5LnByb3RvdHlwZS5mb3JFYWNofHxcbihuPWZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPTAsZD1hLmxlbmd0aDtjPGQ7YysrKWlmKGIuY2FsbChhW2NdLGFbY10sYyxhKT09PSExKXJldHVybiBjfSk7QXJyYXkucHJvdG90eXBlLmluZGV4T2Z8fChzYT1mdW5jdGlvbihhLGIpe3ZhciBjLGQ9MDtpZihiKWZvcihjPWIubGVuZ3RoO2Q8YztkKyspaWYoYltkXT09PWEpcmV0dXJuIGQ7cmV0dXJuLTF9KTtBcnJheS5wcm90b3R5cGUuZmlsdGVyfHwoU2E9ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9W10sZD0wLGU9YS5sZW5ndGg7ZDxlO2QrKyliKGFbZF0sZCkmJmMucHVzaChhW2RdKTtyZXR1cm4gY30pO3ouRng9eWI7ei5pbkFycmF5PXNhO3ouZWFjaD1uO3ouZ3JlcD1TYTt6Lm9mZnNldD1LYjt6Lm1hcD10YTt6LmFkZEV2ZW50PUQ7ei5yZW1vdmVFdmVudD1UO3ouZmlyZUV2ZW50PU07ei5hbmltYXRlPWViO3ouYW5pbU9iamVjdD1oYjt6LnN0b3A9VGE7Tj17Y29sb3JzOlwiIzdjYjVlYywjNDM0MzQ4LCM5MGVkN2QsI2Y3YTM1YywjODA4NWU5LCNmMTVjODAsI2U0ZDM1NCwjMmI5MDhmLCNmNDViNWIsIzkxZThlMVwiLnNwbGl0KFwiLFwiKSxcbnN5bWJvbHM6W1wiY2lyY2xlXCIsXCJkaWFtb25kXCIsXCJzcXVhcmVcIixcInRyaWFuZ2xlXCIsXCJ0cmlhbmdsZS1kb3duXCJdLGxhbmc6e2xvYWRpbmc6XCJMb2FkaW5nLi4uXCIsbW9udGhzOlwiSmFudWFyeSxGZWJydWFyeSxNYXJjaCxBcHJpbCxNYXksSnVuZSxKdWx5LEF1Z3VzdCxTZXB0ZW1iZXIsT2N0b2JlcixOb3ZlbWJlcixEZWNlbWJlclwiLnNwbGl0KFwiLFwiKSxzaG9ydE1vbnRoczpcIkphbixGZWIsTWFyLEFwcixNYXksSnVuLEp1bCxBdWcsU2VwLE9jdCxOb3YsRGVjXCIuc3BsaXQoXCIsXCIpLHdlZWtkYXlzOlwiU3VuZGF5LE1vbmRheSxUdWVzZGF5LFdlZG5lc2RheSxUaHVyc2RheSxGcmlkYXksU2F0dXJkYXlcIi5zcGxpdChcIixcIiksZGVjaW1hbFBvaW50OlwiLlwiLG51bWVyaWNTeW1ib2xzOlwiayxNLEcsVCxQLEVcIi5zcGxpdChcIixcIikscmVzZXRab29tOlwiUmVzZXQgem9vbVwiLHJlc2V0Wm9vbVRpdGxlOlwiUmVzZXQgem9vbSBsZXZlbCAxOjFcIix0aG91c2FuZHNTZXA6XCIgXCJ9LGdsb2JhbDp7dXNlVVRDOiEwLFxuY2FudmFzVG9vbHNVUkw6XCJodHRwOi8vY29kZS5oaWdoY2hhcnRzLmNvbS9tb2R1bGVzL2NhbnZhcy10b29scy5qc1wiLFZNTFJhZGlhbEdyYWRpZW50VVJMOlwiaHR0cDovL2NvZGUuaGlnaGNoYXJ0cy5jb20vc3RvY2svNC4yLjQvZ2Z4L3ZtbC1yYWRpYWwtZ3JhZGllbnQucG5nXCJ9LGNoYXJ0Ontib3JkZXJDb2xvcjpcIiM0NTcyQTdcIixib3JkZXJSYWRpdXM6MCxkZWZhdWx0U2VyaWVzVHlwZTpcImxpbmVcIixpZ25vcmVIaWRkZW5TZXJpZXM6ITAsc3BhY2luZzpbMTAsMTAsMTUsMTBdLGJhY2tncm91bmRDb2xvcjpcIiNGRkZGRkZcIixwbG90Qm9yZGVyQ29sb3I6XCIjQzBDMEMwXCIscmVzZXRab29tQnV0dG9uOnt0aGVtZTp7ekluZGV4OjIwfSxwb3NpdGlvbjp7YWxpZ246XCJyaWdodFwiLHg6LTEwLHk6MTB9fX0sdGl0bGU6e3RleHQ6XCJDaGFydCB0aXRsZVwiLGFsaWduOlwiY2VudGVyXCIsbWFyZ2luOjE1LHN0eWxlOntjb2xvcjpcIiMzMzMzMzNcIixmb250U2l6ZTpcIjE4cHhcIn19LHN1YnRpdGxlOnt0ZXh0OlwiXCIsXG5hbGlnbjpcImNlbnRlclwiLHN0eWxlOntjb2xvcjpcIiM1NTU1NTVcIn19LHBsb3RPcHRpb25zOntsaW5lOnthbGxvd1BvaW50U2VsZWN0OiExLHNob3dDaGVja2JveDohMSxhbmltYXRpb246e2R1cmF0aW9uOjFFM30sZXZlbnRzOnt9LGxpbmVXaWR0aDoyLG1hcmtlcjp7bGluZVdpZHRoOjAscmFkaXVzOjQsbGluZUNvbG9yOlwiI0ZGRkZGRlwiLHN0YXRlczp7aG92ZXI6e2VuYWJsZWQ6ITAsbGluZVdpZHRoUGx1czoxLHJhZGl1c1BsdXM6Mn0sc2VsZWN0OntmaWxsQ29sb3I6XCIjRkZGRkZGXCIsbGluZUNvbG9yOlwiIzAwMDAwMFwiLGxpbmVXaWR0aDoyfX19LHBvaW50OntldmVudHM6e319LGRhdGFMYWJlbHM6e2FsaWduOlwiY2VudGVyXCIsZm9ybWF0dGVyOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMueT09PW51bGw/XCJcIjp6Lm51bWJlckZvcm1hdCh0aGlzLnksLTEpfSxzdHlsZTp7Y29sb3I6XCJjb250cmFzdFwiLGZvbnRTaXplOlwiMTFweFwiLGZvbnRXZWlnaHQ6XCJib2xkXCIsdGV4dFNoYWRvdzpcIjAgMCA2cHggY29udHJhc3QsIDAgMCAzcHggY29udHJhc3RcIn0sXG52ZXJ0aWNhbEFsaWduOlwiYm90dG9tXCIseDowLHk6MCxwYWRkaW5nOjV9LGNyb3BUaHJlc2hvbGQ6MzAwLHBvaW50UmFuZ2U6MCxzb2Z0VGhyZXNob2xkOiEwLHN0YXRlczp7aG92ZXI6e2xpbmVXaWR0aFBsdXM6MSxtYXJrZXI6e30saGFsbzp7c2l6ZToxMCxvcGFjaXR5OjAuMjV9fSxzZWxlY3Q6e21hcmtlcjp7fX19LHN0aWNreVRyYWNraW5nOiEwLHR1cmJvVGhyZXNob2xkOjFFM319LGxhYmVsczp7c3R5bGU6e3Bvc2l0aW9uOlwiYWJzb2x1dGVcIixjb2xvcjpcIiMzRTU3NkZcIn19LGxlZ2VuZDp7ZW5hYmxlZDohMCxhbGlnbjpcImNlbnRlclwiLGxheW91dDpcImhvcml6b250YWxcIixsYWJlbEZvcm1hdHRlcjpmdW5jdGlvbigpe3JldHVybiB0aGlzLm5hbWV9LGJvcmRlckNvbG9yOlwiIzkwOTA5MFwiLGJvcmRlclJhZGl1czowLG5hdmlnYXRpb246e2FjdGl2ZUNvbG9yOlwiIzI3NGI2ZFwiLGluYWN0aXZlQ29sb3I6XCIjQ0NDXCJ9LHNoYWRvdzohMSxpdGVtU3R5bGU6e2NvbG9yOlwiIzMzMzMzM1wiLGZvbnRTaXplOlwiMTJweFwiLFxuZm9udFdlaWdodDpcImJvbGRcIn0saXRlbUhvdmVyU3R5bGU6e2NvbG9yOlwiIzAwMFwifSxpdGVtSGlkZGVuU3R5bGU6e2NvbG9yOlwiI0NDQ1wifSxpdGVtQ2hlY2tib3hTdHlsZTp7cG9zaXRpb246XCJhYnNvbHV0ZVwiLHdpZHRoOlwiMTNweFwiLGhlaWdodDpcIjEzcHhcIn0sc3ltYm9sUGFkZGluZzo1LHZlcnRpY2FsQWxpZ246XCJib3R0b21cIix4OjAseTowLHRpdGxlOntzdHlsZTp7Zm9udFdlaWdodDpcImJvbGRcIn19fSxsb2FkaW5nOntsYWJlbFN0eWxlOntmb250V2VpZ2h0OlwiYm9sZFwiLHBvc2l0aW9uOlwicmVsYXRpdmVcIix0b3A6XCI0NSVcIn0sc3R5bGU6e3Bvc2l0aW9uOlwiYWJzb2x1dGVcIixiYWNrZ3JvdW5kQ29sb3I6XCJ3aGl0ZVwiLG9wYWNpdHk6MC41LHRleHRBbGlnbjpcImNlbnRlclwifX0sdG9vbHRpcDp7ZW5hYmxlZDohMCxhbmltYXRpb246amEsYmFja2dyb3VuZENvbG9yOlwicmdiYSgyNDksIDI0OSwgMjQ5LCAuODUpXCIsYm9yZGVyV2lkdGg6MSxib3JkZXJSYWRpdXM6MyxkYXRlVGltZUxhYmVsRm9ybWF0czp7bWlsbGlzZWNvbmQ6XCIlQSwgJWIgJWUsICVIOiVNOiVTLiVMXCIsXG5zZWNvbmQ6XCIlQSwgJWIgJWUsICVIOiVNOiVTXCIsbWludXRlOlwiJUEsICViICVlLCAlSDolTVwiLGhvdXI6XCIlQSwgJWIgJWUsICVIOiVNXCIsZGF5OlwiJUEsICViICVlLCAlWVwiLHdlZWs6XCJXZWVrIGZyb20gJUEsICViICVlLCAlWVwiLG1vbnRoOlwiJUIgJVlcIix5ZWFyOlwiJVlcIn0sZm9vdGVyRm9ybWF0OlwiXCIsaGVhZGVyRm9ybWF0Oic8c3BhbiBzdHlsZT1cImZvbnQtc2l6ZTogMTBweFwiPntwb2ludC5rZXl9PC9zcGFuPjxici8+Jyxwb2ludEZvcm1hdDonPHNwYW4gc3R5bGU9XCJjb2xvcjp7cG9pbnQuY29sb3J9XCI+XFx1MjVjZjwvc3Bhbj4ge3Nlcmllcy5uYW1lfTogPGI+e3BvaW50Lnl9PC9iPjxici8+JyxzaGFkb3c6ITAsc25hcDprYj8yNToxMCxzdHlsZTp7Y29sb3I6XCIjMzMzMzMzXCIsY3Vyc29yOlwiZGVmYXVsdFwiLGZvbnRTaXplOlwiMTJweFwiLHBhZGRpbmc6XCI4cHhcIixwb2ludGVyRXZlbnRzOlwibm9uZVwiLHdoaXRlU3BhY2U6XCJub3dyYXBcIn19LGNyZWRpdHM6e2VuYWJsZWQ6ITAsdGV4dDpcIkhpZ2hjaGFydHMuY29tXCIsXG5ocmVmOlwiaHR0cDovL3d3dy5oaWdoY2hhcnRzLmNvbVwiLHBvc2l0aW9uOnthbGlnbjpcInJpZ2h0XCIseDotMTAsdmVydGljYWxBbGlnbjpcImJvdHRvbVwiLHk6LTV9LHN0eWxlOntjdXJzb3I6XCJwb2ludGVyXCIsY29sb3I6XCIjOTA5MDkwXCIsZm9udFNpemU6XCI5cHhcIn19fTt2YXIgVz1OLnBsb3RPcHRpb25zLGNhPVcubGluZTtPYigpO3dhLnByb3RvdHlwZT17cGFyc2Vyczpbe3JlZ2V4Oi9yZ2JhXFwoXFxzKihbMC05XXsxLDN9KVxccyosXFxzKihbMC05XXsxLDN9KVxccyosXFxzKihbMC05XXsxLDN9KVxccyosXFxzKihbMC05XT8oPzpcXC5bMC05XSspPylcXHMqXFwpLyxwYXJzZTpmdW5jdGlvbihhKXtyZXR1cm5bRyhhWzFdKSxHKGFbMl0pLEcoYVszXSkscGFyc2VGbG9hdChhWzRdLDEwKV19fSx7cmVnZXg6LyMoW2EtZkEtRjAtOV17Mn0pKFthLWZBLUYwLTldezJ9KShbYS1mQS1GMC05XXsyfSkvLHBhcnNlOmZ1bmN0aW9uKGEpe3JldHVybltHKGFbMV0sMTYpLEcoYVsyXSwxNiksRyhhWzNdLDE2KSwxXX19LFxue3JlZ2V4Oi9yZ2JcXChcXHMqKFswLTldezEsM30pXFxzKixcXHMqKFswLTldezEsM30pXFxzKixcXHMqKFswLTldezEsM30pXFxzKlxcKS8scGFyc2U6ZnVuY3Rpb24oYSl7cmV0dXJuW0coYVsxXSksRyhhWzJdKSxHKGFbM10pLDFdfX1dLGluaXQ6ZnVuY3Rpb24oYSl7dmFyIGIsYyxkLGU7aWYoKHRoaXMuaW5wdXQ9YSkmJmEuc3RvcHMpdGhpcy5zdG9wcz10YShhLnN0b3BzLGZ1bmN0aW9uKGEpe3JldHVybiBuZXcgd2EoYVsxXSl9KTtlbHNlIGZvcihkPXRoaXMucGFyc2Vycy5sZW5ndGg7ZC0tJiYhYzspZT10aGlzLnBhcnNlcnNbZF0sKGI9ZS5yZWdleC5leGVjKGEpKSYmKGM9ZS5wYXJzZShiKSk7dGhpcy5yZ2JhPWN8fFtdfSxnZXQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5pbnB1dCxjPXRoaXMucmdiYSxkO3RoaXMuc3RvcHM/KGQ9QyhiKSxkLnN0b3BzPVtdLmNvbmNhdChkLnN0b3BzKSxuKHRoaXMuc3RvcHMsZnVuY3Rpb24oYixjKXtkLnN0b3BzW2NdPVtkLnN0b3BzW2NdWzBdLGIuZ2V0KGEpXX0pKTpcbmQ9YyYmIWlzTmFOKGNbMF0pP2E9PT1cInJnYlwifHwhYSYmY1szXT09PTE/XCJyZ2IoXCIrY1swXStcIixcIitjWzFdK1wiLFwiK2NbMl0rXCIpXCI6YT09PVwiYVwiP2NbM106XCJyZ2JhKFwiK2Muam9pbihcIixcIikrXCIpXCI6YjtyZXR1cm4gZH0sYnJpZ2h0ZW46ZnVuY3Rpb24oYSl7dmFyIGIsYz10aGlzLnJnYmE7aWYodGhpcy5zdG9wcyluKHRoaXMuc3RvcHMsZnVuY3Rpb24oYil7Yi5icmlnaHRlbihhKX0pO2Vsc2UgaWYodWEoYSkmJmEhPT0wKWZvcihiPTA7YjwzO2IrKyljW2JdKz1HKGEqMjU1KSxjW2JdPDAmJihjW2JdPTApLGNbYl0+MjU1JiYoY1tiXT0yNTUpO3JldHVybiB0aGlzfSxzZXRPcGFjaXR5OmZ1bmN0aW9uKGEpe3RoaXMucmdiYVszXT1hO3JldHVybiB0aGlzfX07Wi5wcm90b3R5cGU9e29wYWNpdHk6MSx0ZXh0UHJvcHM6XCJkaXJlY3Rpb24sZm9udFNpemUsZm9udFdlaWdodCxmb250RmFtaWx5LGZvbnRTdHlsZSxjb2xvcixsaW5lSGVpZ2h0LHdpZHRoLHRleHREZWNvcmF0aW9uLHRleHRPdmVyZmxvdyx0ZXh0U2hhZG93XCIuc3BsaXQoXCIsXCIpLFxuaW5pdDpmdW5jdGlvbihhLGIpe3RoaXMuZWxlbWVudD1iPT09XCJzcGFuXCI/ZWEoYik6Qi5jcmVhdGVFbGVtZW50TlMoUWEsYik7dGhpcy5yZW5kZXJlcj1hfSxhbmltYXRlOmZ1bmN0aW9uKGEsYixjKXtiPXEoYix0aGlzLnJlbmRlcmVyLmdsb2JhbEFuaW1hdGlvbiwhMCk7VGEodGhpcyk7aWYoYil7aWYoYyliLmNvbXBsZXRlPWM7ZWIodGhpcyxhLGIpfWVsc2UgdGhpcy5hdHRyKGEsbnVsbCxjKTtyZXR1cm4gdGhpc30sY29sb3JHcmFkaWVudDpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9dGhpcy5yZW5kZXJlcixlLGYsZyxoLGksaixrLGwsbSxvLHAscj1bXSxBO2EubGluZWFyR3JhZGllbnQ/Zj1cImxpbmVhckdyYWRpZW50XCI6YS5yYWRpYWxHcmFkaWVudCYmKGY9XCJyYWRpYWxHcmFkaWVudFwiKTtpZihmKXtnPWFbZl07aT1kLmdyYWRpZW50cztrPWEuc3RvcHM7bz1jLnJhZGlhbFJlZmVyZW5jZTtKYShnKSYmKGFbZl09Zz17eDE6Z1swXSx5MTpnWzFdLHgyOmdbMl0seTI6Z1szXSxncmFkaWVudFVuaXRzOlwidXNlclNwYWNlT25Vc2VcIn0pO1xuZj09PVwicmFkaWFsR3JhZGllbnRcIiYmbyYmIXMoZy5ncmFkaWVudFVuaXRzKSYmKGg9ZyxnPUMoZyxkLmdldFJhZGlhbEF0dHIobyxoKSx7Z3JhZGllbnRVbml0czpcInVzZXJTcGFjZU9uVXNlXCJ9KSk7Zm9yKHAgaW4gZylwIT09XCJpZFwiJiZyLnB1c2gocCxnW3BdKTtmb3IocCBpbiBrKXIucHVzaChrW3BdKTtyPXIuam9pbihcIixcIik7aVtyXT9vPWlbcl0uYXR0cihcImlkXCIpOihnLmlkPW89XCJoaWdoY2hhcnRzLVwiK0piKyssaVtyXT1qPWQuY3JlYXRlRWxlbWVudChmKS5hdHRyKGcpLmFkZChkLmRlZnMpLGoucmFkQXR0cj1oLGouc3RvcHM9W10sbihrLGZ1bmN0aW9uKGEpe2FbMV0uaW5kZXhPZihcInJnYmFcIik9PT0wPyhlPXdhKGFbMV0pLGw9ZS5nZXQoXCJyZ2JcIiksbT1lLmdldChcImFcIikpOihsPWFbMV0sbT0xKTthPWQuY3JlYXRlRWxlbWVudChcInN0b3BcIikuYXR0cih7b2Zmc2V0OmFbMF0sXCJzdG9wLWNvbG9yXCI6bCxcInN0b3Atb3BhY2l0eVwiOm19KS5hZGQoaik7ai5zdG9wcy5wdXNoKGEpfSkpO1xuQT1cInVybChcIitkLnVybCtcIiNcIitvK1wiKVwiO2Muc2V0QXR0cmlidXRlKGIsQSk7Yy5ncmFkaWVudD1yO2EudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gQX19fSxhcHBseVRleHRTaGFkb3c6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5lbGVtZW50LGMsZD1hLmluZGV4T2YoXCJjb250cmFzdFwiKSE9PS0xLGU9e30sZj10aGlzLnJlbmRlcmVyLmZvckV4cG9ydCxnPWZ8fGIuc3R5bGUudGV4dFNoYWRvdyE9PXQmJiFLYTtpZihkKWUudGV4dFNoYWRvdz1hPWEucmVwbGFjZSgvY29udHJhc3QvZyx0aGlzLnJlbmRlcmVyLmdldENvbnRyYXN0KGIuc3R5bGUuZmlsbCkpO2lmKHRifHxmKWUudGV4dFJlbmRlcmluZz1cImdlb21ldHJpY1ByZWNpc2lvblwiO2c/dGhpcy5jc3MoZSk6KHRoaXMuZmFrZVRTPSEwLHRoaXMueVNldHRlcj10aGlzLnhTZXR0ZXIsYz1bXS5zbGljZS5jYWxsKGIuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJ0c3BhblwiKSksbihhLnNwbGl0KC9cXHM/LFxccz8vZyksZnVuY3Rpb24oYSl7dmFyIGQ9XG5iLmZpcnN0Q2hpbGQsZSxmLGE9YS5zcGxpdChcIiBcIik7ZT1hW2EubGVuZ3RoLTFdOyhmPWFbYS5sZW5ndGgtMl0pJiZuKGMsZnVuY3Rpb24oYSxjKXt2YXIgZztjPT09MCYmKGEuc2V0QXR0cmlidXRlKFwieFwiLGIuZ2V0QXR0cmlidXRlKFwieFwiKSksYz1iLmdldEF0dHJpYnV0ZShcInlcIiksYS5zZXRBdHRyaWJ1dGUoXCJ5XCIsY3x8MCksYz09PW51bGwmJmIuc2V0QXR0cmlidXRlKFwieVwiLDApKTtnPWEuY2xvbmVOb2RlKDEpO1goZyx7XCJjbGFzc1wiOlwiaGlnaGNoYXJ0cy10ZXh0LXNoYWRvd1wiLGZpbGw6ZSxzdHJva2U6ZSxcInN0cm9rZS1vcGFjaXR5XCI6MS92KEcoZiksMyksXCJzdHJva2Utd2lkdGhcIjpmLFwic3Ryb2tlLWxpbmVqb2luXCI6XCJyb3VuZFwifSk7Yi5pbnNlcnRCZWZvcmUoZyxkKX0pfSkpfSxhdHRyOmZ1bmN0aW9uKGEsYixjKXt2YXIgZCxlPXRoaXMuZWxlbWVudCxmLGc9dGhpcyxoO3R5cGVvZiBhPT09XCJzdHJpbmdcIiYmYiE9PXQmJihkPWEsYT17fSxhW2RdPWIpO2lmKHR5cGVvZiBhPT09XG5cInN0cmluZ1wiKWc9KHRoaXNbYStcIkdldHRlclwiXXx8dGhpcy5fZGVmYXVsdEdldHRlcikuY2FsbCh0aGlzLGEsZSk7ZWxzZXtmb3IoZCBpbiBhKXtiPWFbZF07aD0hMTt0aGlzLnN5bWJvbE5hbWUmJi9eKHh8eXx3aWR0aHxoZWlnaHR8cnxzdGFydHxlbmR8aW5uZXJSfGFuY2hvclh8YW5jaG9yWSkvLnRlc3QoZCkmJihmfHwodGhpcy5zeW1ib2xBdHRyKGEpLGY9ITApLGg9ITApO2lmKHRoaXMucm90YXRpb24mJihkPT09XCJ4XCJ8fGQ9PT1cInlcIikpdGhpcy5kb1RyYW5zZm9ybT0hMDtofHwoaD10aGlzW2QrXCJTZXR0ZXJcIl18fHRoaXMuX2RlZmF1bHRTZXR0ZXIsaC5jYWxsKHRoaXMsYixkLGUpLHRoaXMuc2hhZG93cyYmL14od2lkdGh8aGVpZ2h0fHZpc2liaWxpdHl8eHx5fGR8dHJhbnNmb3JtfGN4fGN5fHIpJC8udGVzdChkKSYmdGhpcy51cGRhdGVTaGFkb3dzKGQsYixoKSl9aWYodGhpcy5kb1RyYW5zZm9ybSl0aGlzLnVwZGF0ZVRyYW5zZm9ybSgpLHRoaXMuZG9UcmFuc2Zvcm09ITF9YyYmXG5jKCk7cmV0dXJuIGd9LHVwZGF0ZVNoYWRvd3M6ZnVuY3Rpb24oYSxiLGMpe2Zvcih2YXIgZD10aGlzLnNoYWRvd3MsZT1kLmxlbmd0aDtlLS07KWMuY2FsbChkW2VdLGE9PT1cImhlaWdodFwiP01hdGgubWF4KGItKGRbZV0uY3V0SGVpZ2h0fHwwKSwwKTphPT09XCJkXCI/dGhpcy5kOmIsYSxkW2VdKX0sYWRkQ2xhc3M6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5lbGVtZW50LGM9WChiLFwiY2xhc3NcIil8fFwiXCI7Yy5pbmRleE9mKGEpPT09LTEmJlgoYixcImNsYXNzXCIsYytcIiBcIithKTtyZXR1cm4gdGhpc30sc3ltYm9sQXR0cjpmdW5jdGlvbihhKXt2YXIgYj10aGlzO24oXCJ4LHkscixzdGFydCxlbmQsd2lkdGgsaGVpZ2h0LGlubmVyUixhbmNob3JYLGFuY2hvcllcIi5zcGxpdChcIixcIiksZnVuY3Rpb24oYyl7YltjXT1xKGFbY10sYltjXSl9KTtiLmF0dHIoe2Q6Yi5yZW5kZXJlci5zeW1ib2xzW2Iuc3ltYm9sTmFtZV0oYi54LGIueSxiLndpZHRoLGIuaGVpZ2h0LGIpfSl9LGNsaXA6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuYXR0cihcImNsaXAtcGF0aFwiLFxuYT9cInVybChcIit0aGlzLnJlbmRlcmVyLnVybCtcIiNcIithLmlkK1wiKVwiOlwibm9uZVwiKX0sY3Jpc3A6ZnVuY3Rpb24oYSl7dmFyIGIsYz17fSxkLGU9dGhpcy5zdHJva2VXaWR0aHx8MDtkPXkoZSklMi8yO2EueD1WKGEueHx8dGhpcy54fHwwKStkO2EueT1WKGEueXx8dGhpcy55fHwwKStkO2Eud2lkdGg9VigoYS53aWR0aHx8dGhpcy53aWR0aHx8MCktMipkKTthLmhlaWdodD1WKChhLmhlaWdodHx8dGhpcy5oZWlnaHR8fDApLTIqZCk7YS5zdHJva2VXaWR0aD1lO2ZvcihiIGluIGEpdGhpc1tiXSE9PWFbYl0mJih0aGlzW2JdPWNbYl09YVtiXSk7cmV0dXJuIGN9LGNzczpmdW5jdGlvbihhKXt2YXIgYj10aGlzLnN0eWxlcyxjPXt9LGQ9dGhpcy5lbGVtZW50LGUsZixnPVwiXCI7ZT0hYjtpZihhJiZhLmNvbG9yKWEuZmlsbD1hLmNvbG9yO2lmKGIpZm9yKGYgaW4gYSlhW2ZdIT09YltmXSYmKGNbZl09YVtmXSxlPSEwKTtpZihlKXtlPXRoaXMudGV4dFdpZHRoPWEmJmEud2lkdGgmJmQubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PVxuXCJ0ZXh0XCImJkcoYS53aWR0aCl8fHRoaXMudGV4dFdpZHRoO2ImJihhPXgoYixjKSk7dGhpcy5zdHlsZXM9YTtlJiYocWF8fCFqYSYmdGhpcy5yZW5kZXJlci5mb3JFeHBvcnQpJiZkZWxldGUgYS53aWR0aDtpZihLYSYmIWphKUYodGhpcy5lbGVtZW50LGEpO2Vsc2V7Yj1mdW5jdGlvbihhLGIpe3JldHVyblwiLVwiK2IudG9Mb3dlckNhc2UoKX07Zm9yKGYgaW4gYSlnKz1mLnJlcGxhY2UoLyhbQS1aXSkvZyxiKStcIjpcIithW2ZdK1wiO1wiO1goZCxcInN0eWxlXCIsZyl9ZSYmdGhpcy5hZGRlZCYmdGhpcy5yZW5kZXJlci5idWlsZFRleHQodGhpcyl9cmV0dXJuIHRoaXN9LG9uOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcyxkPWMuZWxlbWVudDtkYiYmYT09PVwiY2xpY2tcIj8oZC5vbnRvdWNoc3RhcnQ9ZnVuY3Rpb24oYSl7Yy50b3VjaEV2ZW50RmlyZWQ9ZmEubm93KCk7YS5wcmV2ZW50RGVmYXVsdCgpO2IuY2FsbChkLGEpfSxkLm9uY2xpY2s9ZnVuY3Rpb24oYSl7KE1hLmluZGV4T2YoXCJBbmRyb2lkXCIpPT09XG4tMXx8ZmEubm93KCktKGMudG91Y2hFdmVudEZpcmVkfHwwKT4xMTAwKSYmYi5jYWxsKGQsYSl9KTpkW1wib25cIithXT1iO3JldHVybiB0aGlzfSxzZXRSYWRpYWxSZWZlcmVuY2U6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5yZW5kZXJlci5ncmFkaWVudHNbdGhpcy5lbGVtZW50LmdyYWRpZW50XTt0aGlzLmVsZW1lbnQucmFkaWFsUmVmZXJlbmNlPWE7YiYmYi5yYWRBdHRyJiZiLmFuaW1hdGUodGhpcy5yZW5kZXJlci5nZXRSYWRpYWxBdHRyKGEsYi5yYWRBdHRyKSk7cmV0dXJuIHRoaXN9LHRyYW5zbGF0ZTpmdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmF0dHIoe3RyYW5zbGF0ZVg6YSx0cmFuc2xhdGVZOmJ9KX0saW52ZXJ0OmZ1bmN0aW9uKCl7dGhpcy5pbnZlcnRlZD0hMDt0aGlzLnVwZGF0ZVRyYW5zZm9ybSgpO3JldHVybiB0aGlzfSx1cGRhdGVUcmFuc2Zvcm06ZnVuY3Rpb24oKXt2YXIgYT10aGlzLnRyYW5zbGF0ZVh8fDAsYj10aGlzLnRyYW5zbGF0ZVl8fDAsYz10aGlzLnNjYWxlWCxcbmQ9dGhpcy5zY2FsZVksZT10aGlzLmludmVydGVkLGY9dGhpcy5yb3RhdGlvbixnPXRoaXMuZWxlbWVudDtlJiYoYSs9dGhpcy5hdHRyKFwid2lkdGhcIiksYis9dGhpcy5hdHRyKFwiaGVpZ2h0XCIpKTthPVtcInRyYW5zbGF0ZShcIithK1wiLFwiK2IrXCIpXCJdO2U/YS5wdXNoKFwicm90YXRlKDkwKSBzY2FsZSgtMSwxKVwiKTpmJiZhLnB1c2goXCJyb3RhdGUoXCIrZitcIiBcIisoZy5nZXRBdHRyaWJ1dGUoXCJ4XCIpfHwwKStcIiBcIisoZy5nZXRBdHRyaWJ1dGUoXCJ5XCIpfHwwKStcIilcIik7KHMoYyl8fHMoZCkpJiZhLnB1c2goXCJzY2FsZShcIitxKGMsMSkrXCIgXCIrcShkLDEpK1wiKVwiKTthLmxlbmd0aCYmZy5zZXRBdHRyaWJ1dGUoXCJ0cmFuc2Zvcm1cIixhLmpvaW4oXCIgXCIpKX0sdG9Gcm9udDpmdW5jdGlvbigpe3ZhciBhPXRoaXMuZWxlbWVudDthLnBhcmVudE5vZGUuYXBwZW5kQ2hpbGQoYSk7cmV0dXJuIHRoaXN9LGFsaWduOmZ1bmN0aW9uKGEsYixjKXt2YXIgZCxlLGYsZyxoPXt9O2U9dGhpcy5yZW5kZXJlcjtmPWUuYWxpZ25lZE9iamVjdHM7XG5pZihhKXtpZih0aGlzLmFsaWduT3B0aW9ucz1hLHRoaXMuYWxpZ25CeVRyYW5zbGF0ZT1iLCFjfHxEYShjKSl0aGlzLmFsaWduVG89ZD1jfHxcInJlbmRlcmVyXCIsQWEoZix0aGlzKSxmLnB1c2godGhpcyksYz1udWxsfWVsc2UgYT10aGlzLmFsaWduT3B0aW9ucyxiPXRoaXMuYWxpZ25CeVRyYW5zbGF0ZSxkPXRoaXMuYWxpZ25UbztjPXEoYyxlW2RdLGUpO2Q9YS5hbGlnbjtlPWEudmVydGljYWxBbGlnbjtmPShjLnh8fDApKyhhLnh8fDApO2c9KGMueXx8MCkrKGEueXx8MCk7aWYoZD09PVwicmlnaHRcInx8ZD09PVwiY2VudGVyXCIpZis9KGMud2lkdGgtKGEud2lkdGh8fDApKS97cmlnaHQ6MSxjZW50ZXI6Mn1bZF07aFtiP1widHJhbnNsYXRlWFwiOlwieFwiXT15KGYpO2lmKGU9PT1cImJvdHRvbVwifHxlPT09XCJtaWRkbGVcIilnKz0oYy5oZWlnaHQtKGEuaGVpZ2h0fHwwKSkvKHtib3R0b206MSxtaWRkbGU6Mn1bZV18fDEpO2hbYj9cInRyYW5zbGF0ZVlcIjpcInlcIl09eShnKTt0aGlzW3RoaXMucGxhY2VkP1xuXCJhbmltYXRlXCI6XCJhdHRyXCJdKGgpO3RoaXMucGxhY2VkPSEwO3RoaXMuYWxpZ25BdHRyPWg7cmV0dXJuIHRoaXN9LGdldEJCb3g6ZnVuY3Rpb24oYSxiKXt2YXIgYyxkPXRoaXMucmVuZGVyZXIsZSxmLGcsaD10aGlzLmVsZW1lbnQsaT10aGlzLnN0eWxlcztlPXRoaXMudGV4dFN0cjt2YXIgaixrPWguc3R5bGUsbCxtPWQuY2FjaGUsbz1kLmNhY2hlS2V5cyxwO2Y9cShiLHRoaXMucm90YXRpb24pO2c9ZipwYTtlIT09dCYmKHA9W1wiXCIsZnx8MCxpJiZpLmZvbnRTaXplLGguc3R5bGUud2lkdGhdLmpvaW4oXCIsXCIpLHA9ZT09PVwiXCJ8fCRiLnRlc3QoZSk/XCJudW06XCIrZS50b1N0cmluZygpLmxlbmd0aCtwOmUrcCk7cCYmIWEmJihjPW1bcF0pO2lmKCFjKXtpZihoLm5hbWVzcGFjZVVSST09PVFhfHxkLmZvckV4cG9ydCl7dHJ5e2w9dGhpcy5mYWtlVFMmJmZ1bmN0aW9uKGEpe24oaC5xdWVyeVNlbGVjdG9yQWxsKFwiLmhpZ2hjaGFydHMtdGV4dC1zaGFkb3dcIiksZnVuY3Rpb24oYil7Yi5zdHlsZS5kaXNwbGF5PVxuYX0pfSxYYSYmay50ZXh0U2hhZG93PyhqPWsudGV4dFNoYWRvdyxrLnRleHRTaGFkb3c9XCJcIik6bCYmbChcIm5vbmVcIiksYz1oLmdldEJCb3g/eCh7fSxoLmdldEJCb3goKSk6e3dpZHRoOmgub2Zmc2V0V2lkdGgsaGVpZ2h0Omgub2Zmc2V0SGVpZ2h0fSxqP2sudGV4dFNoYWRvdz1qOmwmJmwoXCJcIil9Y2F0Y2gocil7fWlmKCFjfHxjLndpZHRoPDApYz17d2lkdGg6MCxoZWlnaHQ6MH19ZWxzZSBjPXRoaXMuaHRtbEdldEJCb3goKTtpZihkLmlzU1ZHKXtkPWMud2lkdGg7ZT1jLmhlaWdodDtpZihLYSYmaSYmaS5mb250U2l6ZT09PVwiMTFweFwiJiZlLnRvUHJlY2lzaW9uKDMpPT09XCIxNi45XCIpYy5oZWlnaHQ9ZT0xNDtpZihmKWMud2lkdGg9UyhlKmthKGcpKStTKGQqYmEoZykpLGMuaGVpZ2h0PVMoZSpiYShnKSkrUyhkKmthKGcpKX1pZihwKXtmb3IoO28ubGVuZ3RoPjI1MDspZGVsZXRlIG1bby5zaGlmdCgpXTttW3BdfHxvLnB1c2gocCk7bVtwXT1jfX1yZXR1cm4gY30sc2hvdzpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5hdHRyKHt2aXNpYmlsaXR5OmE/XG5cImluaGVyaXRcIjpcInZpc2libGVcIn0pfSxoaWRlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYXR0cih7dmlzaWJpbGl0eTpcImhpZGRlblwifSl9LGZhZGVPdXQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztiLmFuaW1hdGUoe29wYWNpdHk6MH0se2R1cmF0aW9uOmF8fDE1MCxjb21wbGV0ZTpmdW5jdGlvbigpe2IuYXR0cih7eTotOTk5OX0pfX0pfSxhZGQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5yZW5kZXJlcixjPXRoaXMuZWxlbWVudCxkO2lmKGEpdGhpcy5wYXJlbnRHcm91cD1hO3RoaXMucGFyZW50SW52ZXJ0ZWQ9YSYmYS5pbnZlcnRlZDt0aGlzLnRleHRTdHIhPT12b2lkIDAmJmIuYnVpbGRUZXh0KHRoaXMpO3RoaXMuYWRkZWQ9ITA7aWYoIWF8fGEuaGFuZGxlWnx8dGhpcy56SW5kZXgpZD10aGlzLnpJbmRleFNldHRlcigpO2R8fChhP2EuZWxlbWVudDpiLmJveCkuYXBwZW5kQ2hpbGQoYyk7aWYodGhpcy5vbkFkZCl0aGlzLm9uQWRkKCk7cmV0dXJuIHRoaXN9LHNhZmVSZW1vdmVDaGlsZDpmdW5jdGlvbihhKXt2YXIgYj1cbmEucGFyZW50Tm9kZTtiJiZiLnJlbW92ZUNoaWxkKGEpfSxkZXN0cm95OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEuZWxlbWVudHx8e30sYz1hLnNoYWRvd3MsZD1hLnJlbmRlcmVyLmlzU1ZHJiZiLm5vZGVOYW1lPT09XCJTUEFOXCImJmEucGFyZW50R3JvdXAsZSxmO2Iub25jbGljaz1iLm9ubW91c2VvdXQ9Yi5vbm1vdXNlb3Zlcj1iLm9ubW91c2Vtb3ZlPWIucG9pbnQ9bnVsbDtUYShhKTtpZihhLmNsaXBQYXRoKWEuY2xpcFBhdGg9YS5jbGlwUGF0aC5kZXN0cm95KCk7aWYoYS5zdG9wcyl7Zm9yKGY9MDtmPGEuc3RvcHMubGVuZ3RoO2YrKylhLnN0b3BzW2ZdPWEuc3RvcHNbZl0uZGVzdHJveSgpO2Euc3RvcHM9bnVsbH1hLnNhZmVSZW1vdmVDaGlsZChiKTtmb3IoYyYmbihjLGZ1bmN0aW9uKGIpe2Euc2FmZVJlbW92ZUNoaWxkKGIpfSk7ZCYmZC5kaXYmJmQuZGl2LmNoaWxkTm9kZXMubGVuZ3RoPT09MDspYj1kLnBhcmVudEdyb3VwLGEuc2FmZVJlbW92ZUNoaWxkKGQuZGl2KSxkZWxldGUgZC5kaXYsXG5kPWI7YS5hbGlnblRvJiZBYShhLnJlbmRlcmVyLmFsaWduZWRPYmplY3RzLGEpO2ZvcihlIGluIGEpZGVsZXRlIGFbZV07cmV0dXJuIG51bGx9LHNoYWRvdzpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9W10sZSxmLGc9dGhpcy5lbGVtZW50LGgsaSxqLGs7aWYoYSl7aT1xKGEud2lkdGgsMyk7aj0oYS5vcGFjaXR5fHwwLjE1KS9pO2s9dGhpcy5wYXJlbnRJbnZlcnRlZD9cIigtMSwtMSlcIjpcIihcIitxKGEub2Zmc2V0WCwxKStcIiwgXCIrcShhLm9mZnNldFksMSkrXCIpXCI7Zm9yKGU9MTtlPD1pO2UrKyl7Zj1nLmNsb25lTm9kZSgwKTtoPWkqMisxLTIqZTtYKGYse2lzU2hhZG93OlwidHJ1ZVwiLHN0cm9rZTphLmNvbG9yfHxcImJsYWNrXCIsXCJzdHJva2Utb3BhY2l0eVwiOmoqZSxcInN0cm9rZS13aWR0aFwiOmgsdHJhbnNmb3JtOlwidHJhbnNsYXRlXCIrayxmaWxsOlwibm9uZVwifSk7aWYoYylYKGYsXCJoZWlnaHRcIix2KFgoZixcImhlaWdodFwiKS1oLDApKSxmLmN1dEhlaWdodD1oO2I/Yi5lbGVtZW50LmFwcGVuZENoaWxkKGYpOlxuZy5wYXJlbnROb2RlLmluc2VydEJlZm9yZShmLGcpO2QucHVzaChmKX10aGlzLnNoYWRvd3M9ZH1yZXR1cm4gdGhpc30seEdldHRlcjpmdW5jdGlvbihhKXt0aGlzLmVsZW1lbnQubm9kZU5hbWU9PT1cImNpcmNsZVwiJiYoYT17eDpcImN4XCIseTpcImN5XCJ9W2FdfHxhKTtyZXR1cm4gdGhpcy5fZGVmYXVsdEdldHRlcihhKX0sX2RlZmF1bHRHZXR0ZXI6ZnVuY3Rpb24oYSl7YT1xKHRoaXNbYV0sdGhpcy5lbGVtZW50P3RoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoYSk6bnVsbCwwKTsvXltcXC0wLTlcXC5dKyQvLnRlc3QoYSkmJihhPXBhcnNlRmxvYXQoYSkpO3JldHVybiBhfSxkU2V0dGVyOmZ1bmN0aW9uKGEsYixjKXthJiZhLmpvaW4mJihhPWEuam9pbihcIiBcIikpOy8oTmFOfCB7Mn18XiQpLy50ZXN0KGEpJiYoYT1cIk0gMCAwXCIpO2Muc2V0QXR0cmlidXRlKGIsYSk7dGhpc1tiXT1hfSxkYXNoc3R5bGVTZXR0ZXI6ZnVuY3Rpb24oYSl7dmFyIGIsYz10aGlzW1wic3Ryb2tlLXdpZHRoXCJdO2M9PT1cblwiaW5oZXJpdFwiJiYoYz0xKTtpZihhPWEmJmEudG9Mb3dlckNhc2UoKSl7YT1hLnJlcGxhY2UoXCJzaG9ydGRhc2hkb3Rkb3RcIixcIjMsMSwxLDEsMSwxLFwiKS5yZXBsYWNlKFwic2hvcnRkYXNoZG90XCIsXCIzLDEsMSwxXCIpLnJlcGxhY2UoXCJzaG9ydGRvdFwiLFwiMSwxLFwiKS5yZXBsYWNlKFwic2hvcnRkYXNoXCIsXCIzLDEsXCIpLnJlcGxhY2UoXCJsb25nZGFzaFwiLFwiOCwzLFwiKS5yZXBsYWNlKC9kb3QvZyxcIjEsMyxcIikucmVwbGFjZShcImRhc2hcIixcIjQsMyxcIikucmVwbGFjZSgvLCQvLFwiXCIpLnNwbGl0KFwiLFwiKTtmb3IoYj1hLmxlbmd0aDtiLS07KWFbYl09RyhhW2JdKSpjO2E9YS5qb2luKFwiLFwiKS5yZXBsYWNlKC9OYU4vZyxcIm5vbmVcIik7dGhpcy5lbGVtZW50LnNldEF0dHJpYnV0ZShcInN0cm9rZS1kYXNoYXJyYXlcIixhKX19LGFsaWduU2V0dGVyOmZ1bmN0aW9uKGEpe3RoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJ0ZXh0LWFuY2hvclwiLHtsZWZ0Olwic3RhcnRcIixjZW50ZXI6XCJtaWRkbGVcIixyaWdodDpcImVuZFwifVthXSl9LFxub3BhY2l0eVNldHRlcjpmdW5jdGlvbihhLGIsYyl7dGhpc1tiXT1hO2Muc2V0QXR0cmlidXRlKGIsYSl9LHRpdGxlU2V0dGVyOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuZWxlbWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcInRpdGxlXCIpWzBdO2J8fChiPUIuY3JlYXRlRWxlbWVudE5TKFFhLFwidGl0bGVcIiksdGhpcy5lbGVtZW50LmFwcGVuZENoaWxkKGIpKTtiLmFwcGVuZENoaWxkKEIuY3JlYXRlVGV4dE5vZGUoU3RyaW5nKHEoYSksXCJcIikucmVwbGFjZSgvPFtePl0qPi9nLFwiXCIpKSl9LHRleHRTZXR0ZXI6ZnVuY3Rpb24oYSl7aWYoYSE9PXRoaXMudGV4dFN0cilkZWxldGUgdGhpcy5iQm94LHRoaXMudGV4dFN0cj1hLHRoaXMuYWRkZWQmJnRoaXMucmVuZGVyZXIuYnVpbGRUZXh0KHRoaXMpfSxmaWxsU2V0dGVyOmZ1bmN0aW9uKGEsYixjKXt0eXBlb2YgYT09PVwic3RyaW5nXCI/Yy5zZXRBdHRyaWJ1dGUoYixhKTphJiZ0aGlzLmNvbG9yR3JhZGllbnQoYSxiLGMpfSx2aXNpYmlsaXR5U2V0dGVyOmZ1bmN0aW9uKGEsXG5iLGMpe2E9PT1cImluaGVyaXRcIj9jLnJlbW92ZUF0dHJpYnV0ZShiKTpjLnNldEF0dHJpYnV0ZShiLGEpfSx6SW5kZXhTZXR0ZXI6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLnJlbmRlcmVyLGQ9dGhpcy5wYXJlbnRHcm91cCxjPShkfHxjKS5lbGVtZW50fHxjLmJveCxlLGYsZz10aGlzLmVsZW1lbnQsaDtlPXRoaXMuYWRkZWQ7dmFyIGk7aWYocyhhKSlnLnpJbmRleD1hLGE9K2EsdGhpc1tiXT09PWEmJihlPSExKSx0aGlzW2JdPWE7aWYoZSl7aWYoKGE9dGhpcy56SW5kZXgpJiZkKWQuaGFuZGxlWj0hMDtkPWMuY2hpbGROb2Rlcztmb3IoaT0wO2k8ZC5sZW5ndGgmJiFoO2krKylpZihlPWRbaV0sZj1lLnpJbmRleCxlIT09ZyYmKEcoZik+YXx8IXMoYSkmJnMoZikpKWMuaW5zZXJ0QmVmb3JlKGcsZSksaD0hMDtofHxjLmFwcGVuZENoaWxkKGcpfXJldHVybiBofSxfZGVmYXVsdFNldHRlcjpmdW5jdGlvbihhLGIsYyl7Yy5zZXRBdHRyaWJ1dGUoYixhKX19O1oucHJvdG90eXBlLnlHZXR0ZXI9XG5aLnByb3RvdHlwZS54R2V0dGVyO1oucHJvdG90eXBlLnRyYW5zbGF0ZVhTZXR0ZXI9Wi5wcm90b3R5cGUudHJhbnNsYXRlWVNldHRlcj1aLnByb3RvdHlwZS5yb3RhdGlvblNldHRlcj1aLnByb3RvdHlwZS52ZXJ0aWNhbEFsaWduU2V0dGVyPVoucHJvdG90eXBlLnNjYWxlWFNldHRlcj1aLnByb3RvdHlwZS5zY2FsZVlTZXR0ZXI9ZnVuY3Rpb24oYSxiKXt0aGlzW2JdPWE7dGhpcy5kb1RyYW5zZm9ybT0hMH07Wi5wcm90b3R5cGVbXCJzdHJva2Utd2lkdGhTZXR0ZXJcIl09Wi5wcm90b3R5cGUuc3Ryb2tlU2V0dGVyPWZ1bmN0aW9uKGEsYixjKXt0aGlzW2JdPWE7aWYodGhpcy5zdHJva2UmJnRoaXNbXCJzdHJva2Utd2lkdGhcIl0pdGhpcy5zdHJva2VXaWR0aD10aGlzW1wic3Ryb2tlLXdpZHRoXCJdLFoucHJvdG90eXBlLmZpbGxTZXR0ZXIuY2FsbCh0aGlzLHRoaXMuc3Ryb2tlLFwic3Ryb2tlXCIsYyksYy5zZXRBdHRyaWJ1dGUoXCJzdHJva2Utd2lkdGhcIix0aGlzW1wic3Ryb2tlLXdpZHRoXCJdKSxcbnRoaXMuaGFzU3Ryb2tlPSEwO2Vsc2UgaWYoYj09PVwic3Ryb2tlLXdpZHRoXCImJmE9PT0wJiZ0aGlzLmhhc1N0cm9rZSljLnJlbW92ZUF0dHJpYnV0ZShcInN0cm9rZVwiKSx0aGlzLmhhc1N0cm9rZT0hMX07dmFyIHlhPWZ1bmN0aW9uKCl7dGhpcy5pbml0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX07eWEucHJvdG90eXBlPXtFbGVtZW50OlosaW5pdDpmdW5jdGlvbihhLGIsYyxkLGUsZil7dmFyIGcsZD10aGlzLmNyZWF0ZUVsZW1lbnQoXCJzdmdcIikuYXR0cih7dmVyc2lvbjpcIjEuMVwifSkuY3NzKHRoaXMuZ2V0U3R5bGUoZCkpO2c9ZC5lbGVtZW50O2EuYXBwZW5kQ2hpbGQoZyk7YS5pbm5lckhUTUwuaW5kZXhPZihcInhtbG5zXCIpPT09LTEmJlgoZyxcInhtbG5zXCIsUWEpO3RoaXMuaXNTVkc9ITA7dGhpcy5ib3g9Zzt0aGlzLmJveFdyYXBwZXI9ZDt0aGlzLmFsaWduZWRPYmplY3RzPVtdO3RoaXMudXJsPShYYXx8dGIpJiZCLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiYmFzZVwiKS5sZW5ndGg/Si5sb2NhdGlvbi5ocmVmLnJlcGxhY2UoLyMuKj8kLyxcblwiXCIpLnJlcGxhY2UoLyhbXFwoJ1xcKV0pL2csXCJcXFxcJDFcIikucmVwbGFjZSgvIC9nLFwiJTIwXCIpOlwiXCI7dGhpcy5jcmVhdGVFbGVtZW50KFwiZGVzY1wiKS5hZGQoKS5lbGVtZW50LmFwcGVuZENoaWxkKEIuY3JlYXRlVGV4dE5vZGUoXCJDcmVhdGVkIHdpdGggSGlnaHN0b2NrIDQuMi40XCIpKTt0aGlzLmRlZnM9dGhpcy5jcmVhdGVFbGVtZW50KFwiZGVmc1wiKS5hZGQoKTt0aGlzLmFsbG93SFRNTD1mO3RoaXMuZm9yRXhwb3J0PWU7dGhpcy5ncmFkaWVudHM9e307dGhpcy5jYWNoZT17fTt0aGlzLmNhY2hlS2V5cz1bXTt0aGlzLmltZ0NvdW50PTA7dGhpcy5zZXRTaXplKGIsYywhMSk7dmFyIGg7aWYoWGEmJmEuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KXRoaXMuc3ViUGl4ZWxGaXg9Yj1mdW5jdGlvbigpe0YoYSx7bGVmdDowLHRvcDowfSk7aD1hLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO0YoYSx7bGVmdDpGYShoLmxlZnQpLWgubGVmdCtcInB4XCIsdG9wOkZhKGgudG9wKS1oLnRvcCtcInB4XCJ9KX0sYigpLFxuRChKLFwicmVzaXplXCIsYil9LGdldFN0eWxlOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnN0eWxlPXgoe2ZvbnRGYW1pbHk6J1wiTHVjaWRhIEdyYW5kZVwiLCBcIkx1Y2lkYSBTYW5zIFVuaWNvZGVcIiwgQXJpYWwsIEhlbHZldGljYSwgc2Fucy1zZXJpZicsZm9udFNpemU6XCIxMnB4XCJ9LGEpfSxpc0hpZGRlbjpmdW5jdGlvbigpe3JldHVybiF0aGlzLmJveFdyYXBwZXIuZ2V0QkJveCgpLndpZHRofSxkZXN0cm95OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5kZWZzO3RoaXMuYm94PW51bGw7dGhpcy5ib3hXcmFwcGVyPXRoaXMuYm94V3JhcHBlci5kZXN0cm95KCk7UGEodGhpcy5ncmFkaWVudHN8fHt9KTt0aGlzLmdyYWRpZW50cz1udWxsO2lmKGEpdGhpcy5kZWZzPWEuZGVzdHJveSgpO3RoaXMuc3ViUGl4ZWxGaXgmJlQoSixcInJlc2l6ZVwiLHRoaXMuc3ViUGl4ZWxGaXgpO3JldHVybiB0aGlzLmFsaWduZWRPYmplY3RzPW51bGx9LGNyZWF0ZUVsZW1lbnQ6ZnVuY3Rpb24oYSl7dmFyIGI9bmV3IHRoaXMuRWxlbWVudDtcbmIuaW5pdCh0aGlzLGEpO3JldHVybiBifSxkcmF3OmZ1bmN0aW9uKCl7fSxnZXRSYWRpYWxBdHRyOmZ1bmN0aW9uKGEsYil7cmV0dXJue2N4OmFbMF0tYVsyXS8yK2IuY3gqYVsyXSxjeTphWzFdLWFbMl0vMitiLmN5KmFbMl0scjpiLnIqYVsyXX19LGJ1aWxkVGV4dDpmdW5jdGlvbihhKXtmb3IodmFyIGI9YS5lbGVtZW50LGM9dGhpcyxkPWMuZm9yRXhwb3J0LGU9cShhLnRleHRTdHIsXCJcIikudG9TdHJpbmcoKSxmPWUuaW5kZXhPZihcIjxcIikhPT0tMSxnPWIuY2hpbGROb2RlcyxoLGksaj1YKGIsXCJ4XCIpLGs9YS5zdHlsZXMsbD1hLnRleHRXaWR0aCxtPWsmJmsubGluZUhlaWdodCxvPWsmJmsudGV4dFNoYWRvdyxwPWsmJmsudGV4dE92ZXJmbG93PT09XCJlbGxpcHNpc1wiLHI9Zy5sZW5ndGgsQT1sJiYhYS5hZGRlZCYmdGhpcy5ib3gsUD1mdW5jdGlvbihhKXtyZXR1cm4gbT9HKG0pOmMuZm9udE1ldHJpY3MoLyhweHxlbSkkLy50ZXN0KGEmJmEuc3R5bGUuZm9udFNpemUpP2Euc3R5bGUuZm9udFNpemU6XG5rJiZrLmZvbnRTaXplfHxjLnN0eWxlLmZvbnRTaXplfHwxMixhKS5ofSx1PWZ1bmN0aW9uKGEpe3JldHVybiBhLnJlcGxhY2UoLyZsdDsvZyxcIjxcIikucmVwbGFjZSgvJmd0Oy9nLFwiPlwiKX07ci0tOyliLnJlbW92ZUNoaWxkKGdbcl0pOyFmJiYhbyYmIXAmJmUuaW5kZXhPZihcIiBcIik9PT0tMT9iLmFwcGVuZENoaWxkKEIuY3JlYXRlVGV4dE5vZGUodShlKSkpOihoPS88LipzdHlsZT1cIihbXlwiXSspXCIuKj4vLGk9LzwuKmhyZWY9XCIoaHR0cFteXCJdKylcIi4qPi8sQSYmQS5hcHBlbmRDaGlsZChiKSxlPWY/ZS5yZXBsYWNlKC88KGJ8c3Ryb25nKT4vZywnPHNwYW4gc3R5bGU9XCJmb250LXdlaWdodDpib2xkXCI+JykucmVwbGFjZSgvPChpfGVtKT4vZywnPHNwYW4gc3R5bGU9XCJmb250LXN0eWxlOml0YWxpY1wiPicpLnJlcGxhY2UoLzxhL2csXCI8c3BhblwiKS5yZXBsYWNlKC88XFwvKGJ8c3Ryb25nfGl8ZW18YSk+L2csXCI8L3NwYW4+XCIpLnNwbGl0KC88YnIuKj8+L2cpOltlXSxlW2UubGVuZ3RoLTFdPT09XG5cIlwiJiZlLnBvcCgpLG4oZSxmdW5jdGlvbihlLGYpe3ZhciBnLG09MCxlPWUucmVwbGFjZSgvPHNwYW4vZyxcInx8fDxzcGFuXCIpLnJlcGxhY2UoLzxcXC9zcGFuPi9nLFwiPC9zcGFuPnx8fFwiKTtnPWUuc3BsaXQoXCJ8fHxcIik7bihnLGZ1bmN0aW9uKGUpe2lmKGUhPT1cIlwifHxnLmxlbmd0aD09PTEpe3ZhciBvPXt9LHI9Qi5jcmVhdGVFbGVtZW50TlMoUWEsXCJ0c3BhblwiKSxBO2gudGVzdChlKSYmKEE9ZS5tYXRjaChoKVsxXS5yZXBsYWNlKC8oO3wgfF4pY29sb3IoWyA6XSkvLFwiJDFmaWxsJDJcIiksWChyLFwic3R5bGVcIixBKSk7aS50ZXN0KGUpJiYhZCYmKFgocixcIm9uY2xpY2tcIiwnbG9jYXRpb24uaHJlZj1cIicrZS5tYXRjaChpKVsxXSsnXCInKSxGKHIse2N1cnNvcjpcInBvaW50ZXJcIn0pKTtlPXUoZS5yZXBsYWNlKC88KC58XFxuKSo/Pi9nLFwiXCIpfHxcIiBcIik7aWYoZSE9PVwiIFwiKXtyLmFwcGVuZENoaWxkKEIuY3JlYXRlVGV4dE5vZGUoZSkpO2lmKG0pby5keD0wO2Vsc2UgaWYoZiYmaiE9PW51bGwpby54PVxuajtYKHIsbyk7Yi5hcHBlbmRDaGlsZChyKTshbSYmZiYmKCFqYSYmZCYmRihyLHtkaXNwbGF5OlwiYmxvY2tcIn0pLFgocixcImR5XCIsUChyKSkpO2lmKGwpe2Zvcih2YXIgbz1lLnJlcGxhY2UoLyhbXlxcXl0pLS9nLFwiJDEtIFwiKS5zcGxpdChcIiBcIikscT1nLmxlbmd0aD4xfHxmfHxvLmxlbmd0aD4xJiZrLndoaXRlU3BhY2UhPT1cIm5vd3JhcFwiLHcsbixzLHQ9W10sdj1QKHIpLHk9MSx4PWEucm90YXRpb24sQz1lLHo9Qy5sZW5ndGg7KHF8fHApJiYoby5sZW5ndGh8fHQubGVuZ3RoKTspYS5yb3RhdGlvbj0wLHc9YS5nZXRCQm94KCEwKSxzPXcud2lkdGgsIWphJiZjLmZvckV4cG9ydCYmKHM9Yy5tZWFzdXJlU3BhbldpZHRoKHIuZmlyc3RDaGlsZC5kYXRhLGEuc3R5bGVzKSksdz1zPmwsbj09PXZvaWQgMCYmKG49dykscCYmbj8oei89MixDPT09XCJcInx8IXcmJno8MC41P289W106KHcmJihuPSEwKSxDPWUuc3Vic3RyaW5nKDAsQy5sZW5ndGgrKHc/LTE6MSkqRmEoeikpLG89W0MrKGw+Mz9cIlxcdTIwMjZcIjpcblwiXCIpXSxyLnJlbW92ZUNoaWxkKHIuZmlyc3RDaGlsZCkpKTohd3x8by5sZW5ndGg9PT0xPyhvPXQsdD1bXSxvLmxlbmd0aCYmKHkrKyxyPUIuY3JlYXRlRWxlbWVudE5TKFFhLFwidHNwYW5cIiksWChyLHtkeTp2LHg6an0pLEEmJlgocixcInN0eWxlXCIsQSksYi5hcHBlbmRDaGlsZChyKSkscz5sJiYobD1zKSk6KHIucmVtb3ZlQ2hpbGQoci5maXJzdENoaWxkKSx0LnVuc2hpZnQoby5wb3AoKSkpLG8ubGVuZ3RoJiZyLmFwcGVuZENoaWxkKEIuY3JlYXRlVGV4dE5vZGUoby5qb2luKFwiIFwiKS5yZXBsYWNlKC8tIC9nLFwiLVwiKSkpO24mJmEuYXR0cihcInRpdGxlXCIsYS50ZXh0U3RyKTthLnJvdGF0aW9uPXh9bSsrfX19KX0pLEEmJkEucmVtb3ZlQ2hpbGQoYiksbyYmYS5hcHBseVRleHRTaGFkb3cmJmEuYXBwbHlUZXh0U2hhZG93KG8pKX0sZ2V0Q29udHJhc3Q6ZnVuY3Rpb24oYSl7YT13YShhKS5yZ2JhO3JldHVybiBhWzBdK2FbMV0rYVsyXT4zODQ/XCIjMDAwMDAwXCI6XCIjRkZGRkZGXCJ9LGJ1dHRvbjpmdW5jdGlvbihhLFxuYixjLGQsZSxmLGcsaCxpKXt2YXIgaj10aGlzLmxhYmVsKGEsYixjLGksbnVsbCxudWxsLG51bGwsbnVsbCxcImJ1dHRvblwiKSxrPTAsbCxtLG8scCxyLEEsYT17eDE6MCx5MTowLHgyOjAseTI6MX0sZT1DKHtcInN0cm9rZS13aWR0aFwiOjEsc3Ryb2tlOlwiI0NDQ0NDQ1wiLGZpbGw6e2xpbmVhckdyYWRpZW50OmEsc3RvcHM6W1swLFwiI0ZFRkVGRVwiXSxbMSxcIiNGNkY2RjZcIl1dfSxyOjIscGFkZGluZzo1LHN0eWxlOntjb2xvcjpcImJsYWNrXCJ9fSxlKTtvPWUuc3R5bGU7ZGVsZXRlIGUuc3R5bGU7Zj1DKGUse3N0cm9rZTpcIiM2OEFcIixmaWxsOntsaW5lYXJHcmFkaWVudDphLHN0b3BzOltbMCxcIiNGRkZcIl0sWzEsXCIjQUNGXCJdXX19LGYpO3A9Zi5zdHlsZTtkZWxldGUgZi5zdHlsZTtnPUMoZSx7c3Ryb2tlOlwiIzY4QVwiLGZpbGw6e2xpbmVhckdyYWRpZW50OmEsc3RvcHM6W1swLFwiIzlCRFwiXSxbMSxcIiNDREZcIl1dfX0sZyk7cj1nLnN0eWxlO2RlbGV0ZSBnLnN0eWxlO2g9QyhlLHtzdHlsZTp7Y29sb3I6XCIjQ0NDXCJ9fSxcbmgpO0E9aC5zdHlsZTtkZWxldGUgaC5zdHlsZTtEKGouZWxlbWVudCxLYT9cIm1vdXNlb3ZlclwiOlwibW91c2VlbnRlclwiLGZ1bmN0aW9uKCl7ayE9PTMmJmouYXR0cihmKS5jc3MocCl9KTtEKGouZWxlbWVudCxLYT9cIm1vdXNlb3V0XCI6XCJtb3VzZWxlYXZlXCIsZnVuY3Rpb24oKXtrIT09MyYmKGw9W2UsZixnXVtrXSxtPVtvLHAscl1ba10sai5hdHRyKGwpLmNzcyhtKSl9KTtqLnNldFN0YXRlPWZ1bmN0aW9uKGEpeyhqLnN0YXRlPWs9YSk/YT09PTI/ai5hdHRyKGcpLmNzcyhyKTphPT09MyYmai5hdHRyKGgpLmNzcyhBKTpqLmF0dHIoZSkuY3NzKG8pfTtyZXR1cm4gai5vbihcImNsaWNrXCIsZnVuY3Rpb24oYSl7ayE9PTMmJmQuY2FsbChqLGEpfSkuYXR0cihlKS5jc3MoeCh7Y3Vyc29yOlwiZGVmYXVsdFwifSxvKSl9LGNyaXNwTGluZTpmdW5jdGlvbihhLGIpe2FbMV09PT1hWzRdJiYoYVsxXT1hWzRdPXkoYVsxXSktYiUyLzIpO2FbMl09PT1hWzVdJiYoYVsyXT1hWzVdPXkoYVsyXSkrYiUyL1xuMik7cmV0dXJuIGF9LHBhdGg6ZnVuY3Rpb24oYSl7dmFyIGI9e2ZpbGw6XCJub25lXCJ9O0phKGEpP2IuZD1hOmRhKGEpJiZ4KGIsYSk7cmV0dXJuIHRoaXMuY3JlYXRlRWxlbWVudChcInBhdGhcIikuYXR0cihiKX0sY2lyY2xlOmZ1bmN0aW9uKGEsYixjKXthPWRhKGEpP2E6e3g6YSx5OmIscjpjfTtiPXRoaXMuY3JlYXRlRWxlbWVudChcImNpcmNsZVwiKTtiLnhTZXR0ZXI9Yi55U2V0dGVyPWZ1bmN0aW9uKGEsYixjKXtjLnNldEF0dHJpYnV0ZShcImNcIitiLGEpfTtyZXR1cm4gYi5hdHRyKGEpfSxhcmM6ZnVuY3Rpb24oYSxiLGMsZCxlLGYpe2lmKGRhKGEpKWI9YS55LGM9YS5yLGQ9YS5pbm5lclIsZT1hLnN0YXJ0LGY9YS5lbmQsYT1hLng7YT10aGlzLnN5bWJvbChcImFyY1wiLGF8fDAsYnx8MCxjfHwwLGN8fDAse2lubmVyUjpkfHwwLHN0YXJ0OmV8fDAsZW5kOmZ8fDB9KTthLnI9YztyZXR1cm4gYX0scmVjdDpmdW5jdGlvbihhLGIsYyxkLGUsZil7dmFyIGU9ZGEoYSk/YS5yOmUsZz10aGlzLmNyZWF0ZUVsZW1lbnQoXCJyZWN0XCIpLFxuYT1kYShhKT9hOmE9PT10P3t9Ont4OmEseTpiLHdpZHRoOnYoYywwKSxoZWlnaHQ6dihkLDApfTtpZihmIT09dClnLnN0cm9rZVdpZHRoPWYsYT1nLmNyaXNwKGEpO2lmKGUpYS5yPWU7Zy5yU2V0dGVyPWZ1bmN0aW9uKGEsYixjKXtYKGMse3J4OmEscnk6YX0pfTtyZXR1cm4gZy5hdHRyKGEpfSxzZXRTaXplOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD10aGlzLmFsaWduZWRPYmplY3RzLGU9ZC5sZW5ndGg7dGhpcy53aWR0aD1hO3RoaXMuaGVpZ2h0PWI7Zm9yKHRoaXMuYm94V3JhcHBlcltxKGMsITApP1wiYW5pbWF0ZVwiOlwiYXR0clwiXSh7d2lkdGg6YSxoZWlnaHQ6Yn0pO2UtLTspZFtlXS5hbGlnbigpfSxnOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudChcImdcIik7cmV0dXJuIHMoYSk/Yi5hdHRyKHtcImNsYXNzXCI6XCJoaWdoY2hhcnRzLVwiK2F9KTpifSxpbWFnZTpmdW5jdGlvbihhLGIsYyxkLGUpe3ZhciBmPXtwcmVzZXJ2ZUFzcGVjdFJhdGlvOlwibm9uZVwifTthcmd1bWVudHMubGVuZ3RoPlxuMSYmeChmLHt4OmIseTpjLHdpZHRoOmQsaGVpZ2h0OmV9KTtmPXRoaXMuY3JlYXRlRWxlbWVudChcImltYWdlXCIpLmF0dHIoZik7Zi5lbGVtZW50LnNldEF0dHJpYnV0ZU5TP2YuZWxlbWVudC5zZXRBdHRyaWJ1dGVOUyhcImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmtcIixcImhyZWZcIixhKTpmLmVsZW1lbnQuc2V0QXR0cmlidXRlKFwiaGMtc3ZnLWhyZWZcIixhKTtyZXR1cm4gZn0sc3ltYm9sOmZ1bmN0aW9uKGEsYixjLGQsZSxmKXt2YXIgZz10aGlzLGgsaT10aGlzLnN5bWJvbHNbYV0saT1pJiZpKHkoYikseShjKSxkLGUsZiksaj0vXnVybFxcKCguKj8pXFwpJC8sayxsO2lmKGkpaD10aGlzLnBhdGgoaSkseChoLHtzeW1ib2xOYW1lOmEseDpiLHk6Yyx3aWR0aDpkLGhlaWdodDplfSksZiYmeChoLGYpO2Vsc2UgaWYoai50ZXN0KGEpKWw9ZnVuY3Rpb24oYSxiKXthLmVsZW1lbnQmJihhLmF0dHIoe3dpZHRoOmJbMF0saGVpZ2h0OmJbMV19KSxhLmFsaWduQnlUcmFuc2xhdGV8fGEudHJhbnNsYXRlKHkoKGQtXG5iWzBdKS8yKSx5KChlLWJbMV0pLzIpKSl9LGs9YS5tYXRjaChqKVsxXSxhPVZiW2tdfHxmJiZmLndpZHRoJiZmLmhlaWdodCYmW2Yud2lkdGgsZi5oZWlnaHRdLGg9dGhpcy5pbWFnZShrKS5hdHRyKHt4OmIseTpjfSksaC5pc0ltZz0hMCxhP2woaCxhKTooaC5hdHRyKHt3aWR0aDowLGhlaWdodDowfSksZWEoXCJpbWdcIix7b25sb2FkOmZ1bmN0aW9uKCl7dGhpcy53aWR0aD09PTAmJihGKHRoaXMse3Bvc2l0aW9uOlwiYWJzb2x1dGVcIix0b3A6XCItOTk5ZW1cIn0pLEIuYm9keS5hcHBlbmRDaGlsZCh0aGlzKSk7bChoLFZiW2tdPVt0aGlzLndpZHRoLHRoaXMuaGVpZ2h0XSk7dGhpcy5wYXJlbnROb2RlJiZ0aGlzLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcyk7Zy5pbWdDb3VudC0tO2lmKCFnLmltZ0NvdW50JiYkW2cuY2hhcnRJbmRleF0ub25sb2FkKSRbZy5jaGFydEluZGV4XS5vbmxvYWQoKX0sc3JjOmt9KSx0aGlzLmltZ0NvdW50KyspO3JldHVybiBofSxzeW1ib2xzOntjaXJjbGU6ZnVuY3Rpb24oYSxcbmIsYyxkKXt2YXIgZT0wLjE2NipjO3JldHVybltcIk1cIixhK2MvMixiLFwiQ1wiLGErYytlLGIsYStjK2UsYitkLGErYy8yLGIrZCxcIkNcIixhLWUsYitkLGEtZSxiLGErYy8yLGIsXCJaXCJdfSxzcXVhcmU6ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuW1wiTVwiLGEsYixcIkxcIixhK2MsYixhK2MsYitkLGEsYitkLFwiWlwiXX0sdHJpYW5nbGU6ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuW1wiTVwiLGErYy8yLGIsXCJMXCIsYStjLGIrZCxhLGIrZCxcIlpcIl19LFwidHJpYW5nbGUtZG93blwiOmZ1bmN0aW9uKGEsYixjLGQpe3JldHVybltcIk1cIixhLGIsXCJMXCIsYStjLGIsYStjLzIsYitkLFwiWlwiXX0sZGlhbW9uZDpmdW5jdGlvbihhLGIsYyxkKXtyZXR1cm5bXCJNXCIsYStjLzIsYixcIkxcIixhK2MsYitkLzIsYStjLzIsYitkLGEsYitkLzIsXCJaXCJdfSxhcmM6ZnVuY3Rpb24oYSxiLGMsZCxlKXt2YXIgZj1lLnN0YXJ0LGM9ZS5yfHxjfHxkLGc9ZS5lbmQtMC4wMDEsZD1lLmlubmVyUixoPWUub3BlbixpPWJhKGYpLGo9a2EoZiksXG5rPWJhKGcpLGc9a2EoZyksZT1lLmVuZC1mPEJhPzA6MTtyZXR1cm5bXCJNXCIsYStjKmksYitjKmosXCJBXCIsYyxjLDAsZSwxLGErYyprLGIrYypnLGg/XCJNXCI6XCJMXCIsYStkKmssYitkKmcsXCJBXCIsZCxkLDAsZSwwLGErZCppLGIrZCpqLGg/XCJcIjpcIlpcIl19LGNhbGxvdXQ6ZnVuY3Rpb24oYSxiLGMsZCxlKXt2YXIgZj1FKGUmJmUucnx8MCxjLGQpLGc9Zis2LGg9ZSYmZS5hbmNob3JYLGU9ZSYmZS5hbmNob3JZLGk7aT1bXCJNXCIsYStmLGIsXCJMXCIsYStjLWYsYixcIkNcIixhK2MsYixhK2MsYixhK2MsYitmLFwiTFwiLGErYyxiK2QtZixcIkNcIixhK2MsYitkLGErYyxiK2QsYStjLWYsYitkLFwiTFwiLGErZixiK2QsXCJDXCIsYSxiK2QsYSxiK2QsYSxiK2QtZixcIkxcIixhLGIrZixcIkNcIixhLGIsYSxiLGErZixiXTtoJiZoPmMmJmU+YitnJiZlPGIrZC1nP2kuc3BsaWNlKDEzLDMsXCJMXCIsYStjLGUtNixhK2MrNixlLGErYyxlKzYsYStjLGIrZC1mKTpoJiZoPDAmJmU+YitnJiZlPGIrZC1nP2kuc3BsaWNlKDMzLDMsXG5cIkxcIixhLGUrNixhLTYsZSxhLGUtNixhLGIrZik6ZSYmZT5kJiZoPmErZyYmaDxhK2MtZz9pLnNwbGljZSgyMywzLFwiTFwiLGgrNixiK2QsaCxiK2QrNixoLTYsYitkLGErZixiK2QpOmUmJmU8MCYmaD5hK2cmJmg8YStjLWcmJmkuc3BsaWNlKDMsMyxcIkxcIixoLTYsYixoLGItNixoKzYsYixjLWYsYik7cmV0dXJuIGl9fSxjbGlwUmVjdDpmdW5jdGlvbihhLGIsYyxkKXt2YXIgZT1cImhpZ2hjaGFydHMtXCIrSmIrKyxmPXRoaXMuY3JlYXRlRWxlbWVudChcImNsaXBQYXRoXCIpLmF0dHIoe2lkOmV9KS5hZGQodGhpcy5kZWZzKSxhPXRoaXMucmVjdChhLGIsYyxkLDApLmFkZChmKTthLmlkPWU7YS5jbGlwUGF0aD1mO2EuY291bnQ9MDtyZXR1cm4gYX0sdGV4dDpmdW5jdGlvbihhLGIsYyxkKXt2YXIgZT1xYXx8IWphJiZ0aGlzLmZvckV4cG9ydCxmPXt9O2lmKGQmJih0aGlzLmFsbG93SFRNTHx8IXRoaXMuZm9yRXhwb3J0KSlyZXR1cm4gdGhpcy5odG1sKGEsYixjKTtmLng9TWF0aC5yb3VuZChifHxcbjApO2lmKGMpZi55PU1hdGgucm91bmQoYyk7aWYoYXx8YT09PTApZi50ZXh0PWE7YT10aGlzLmNyZWF0ZUVsZW1lbnQoXCJ0ZXh0XCIpLmF0dHIoZik7ZSYmYS5jc3Moe3Bvc2l0aW9uOlwiYWJzb2x1dGVcIn0pO2lmKCFkKWEueFNldHRlcj1mdW5jdGlvbihhLGIsYyl7dmFyIGQ9Yy5nZXRFbGVtZW50c0J5VGFnTmFtZShcInRzcGFuXCIpLGUsZj1jLmdldEF0dHJpYnV0ZShiKSxtO2ZvcihtPTA7bTxkLmxlbmd0aDttKyspZT1kW21dLGUuZ2V0QXR0cmlidXRlKGIpPT09ZiYmZS5zZXRBdHRyaWJ1dGUoYixhKTtjLnNldEF0dHJpYnV0ZShiLGEpfTtyZXR1cm4gYX0sZm9udE1ldHJpY3M6ZnVuY3Rpb24oYSxiKXt2YXIgYyxkLGE9YXx8dGhpcy5zdHlsZS5mb250U2l6ZTshYSYmYiYmSi5nZXRDb21wdXRlZFN0eWxlJiYoYj1iLmVsZW1lbnR8fGIsYT0oYz1KLmdldENvbXB1dGVkU3R5bGUoYixcIlwiKSkmJmMuZm9udFNpemUpO2E9L3B4Ly50ZXN0KGEpP0coYSk6L2VtLy50ZXN0KGEpP3BhcnNlRmxvYXQoYSkqXG4xMjoxMjtjPWE8MjQ/YSszOnkoYSoxLjIpO2Q9eShjKjAuOCk7cmV0dXJue2g6YyxiOmQsZjphfX0scm90Q29ycjpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9YTtiJiZjJiYoZD12KGQqYmEoYipwYSksNCkpO3JldHVybnt4Oi1hLzMqa2EoYipwYSkseTpkfX0sbGFiZWw6ZnVuY3Rpb24oYSxiLGMsZCxlLGYsZyxoLGkpe3ZhciBqPXRoaXMsaz1qLmcoaSksbD1qLnRleHQoXCJcIiwwLDAsZykuYXR0cih7ekluZGV4OjF9KSxtLG8scD0wLHI9MyxBPTAscSx1LHcsTyxSPTAsaGE9e30sdix6LEwsRSxCO0w9ZnVuY3Rpb24oKXt2YXIgYSxiO2E9bC5lbGVtZW50LnN0eWxlO289KHE9PT12b2lkIDB8fHU9PT12b2lkIDB8fGsuc3R5bGVzLnRleHRBbGlnbikmJnMobC50ZXh0U3RyKSYmbC5nZXRCQm94KCk7ay53aWR0aD0ocXx8by53aWR0aHx8MCkrMipyK0E7ay5oZWlnaHQ9KHV8fG8uaGVpZ2h0fHwwKSsyKnI7dj1yK2ouZm9udE1ldHJpY3MoYSYmYS5mb250U2l6ZSxsKS5iO2lmKHope2lmKCFtKWE9XG5SLGI9KGg/LXY6MCkrUixrLmJveD1tPWQ/ai5zeW1ib2woZCxhLGIsay53aWR0aCxrLmhlaWdodCxoYSk6ai5yZWN0KGEsYixrLndpZHRoLGsuaGVpZ2h0LDAsaGFbXCJzdHJva2Utd2lkdGhcIl0pLG0uaXNJbWd8fG0uYXR0cihcImZpbGxcIixcIm5vbmVcIiksbS5hZGQoayk7bS5pc0ltZ3x8bS5hdHRyKHgoe3dpZHRoOnkoay53aWR0aCksaGVpZ2h0Onkoay5oZWlnaHQpfSxoYSkpO2hhPW51bGx9fTtFPWZ1bmN0aW9uKCl7dmFyIGE9ay5zdHlsZXMsYT1hJiZhLnRleHRBbGlnbixiPUErcixjO2M9aD8wOnY7aWYocyhxKSYmbyYmKGE9PT1cImNlbnRlclwifHxhPT09XCJyaWdodFwiKSliKz17Y2VudGVyOjAuNSxyaWdodDoxfVthXSoocS1vLndpZHRoKTtpZihiIT09bC54fHxjIT09bC55KWwuYXR0cihcInhcIixiKSxjIT09dCYmbC5hdHRyKFwieVwiLGMpO2wueD1iO2wueT1jfTtCPWZ1bmN0aW9uKGEsYil7bT9tLmF0dHIoYSxiKTpoYVthXT1ifTtrLm9uQWRkPWZ1bmN0aW9uKCl7bC5hZGQoayk7ay5hdHRyKHt0ZXh0OmF8fFxuYT09PTA/YTpcIlwiLHg6Yix5OmN9KTttJiZzKGUpJiZrLmF0dHIoe2FuY2hvclg6ZSxhbmNob3JZOmZ9KX07ay53aWR0aFNldHRlcj1mdW5jdGlvbihhKXtxPWF9O2suaGVpZ2h0U2V0dGVyPWZ1bmN0aW9uKGEpe3U9YX07ay5wYWRkaW5nU2V0dGVyPWZ1bmN0aW9uKGEpe2lmKHMoYSkmJmEhPT1yKXI9ay5wYWRkaW5nPWEsRSgpfTtrLnBhZGRpbmdMZWZ0U2V0dGVyPWZ1bmN0aW9uKGEpe3MoYSkmJmEhPT1BJiYoQT1hLEUoKSl9O2suYWxpZ25TZXR0ZXI9ZnVuY3Rpb24oYSl7YT17bGVmdDowLGNlbnRlcjowLjUscmlnaHQ6MX1bYV07YSE9PXAmJihwPWEsbyYmay5hdHRyKHt4Ond9KSl9O2sudGV4dFNldHRlcj1mdW5jdGlvbihhKXthIT09dCYmbC50ZXh0U2V0dGVyKGEpO0woKTtFKCl9O2tbXCJzdHJva2Utd2lkdGhTZXR0ZXJcIl09ZnVuY3Rpb24oYSxiKXthJiYoej0hMCk7Uj1hJTIvMjtCKGIsYSl9O2suc3Ryb2tlU2V0dGVyPWsuZmlsbFNldHRlcj1rLnJTZXR0ZXI9ZnVuY3Rpb24oYSxcbmIpe2I9PT1cImZpbGxcIiYmYSYmKHo9ITApO0IoYixhKX07ay5hbmNob3JYU2V0dGVyPWZ1bmN0aW9uKGEsYil7ZT1hO0IoYix5KGEpLVItdyl9O2suYW5jaG9yWVNldHRlcj1mdW5jdGlvbihhLGIpe2Y9YTtCKGIsYS1PKX07ay54U2V0dGVyPWZ1bmN0aW9uKGEpe2sueD1hO3AmJihhLT1wKigocXx8by53aWR0aCkrMipyKSk7dz15KGEpO2suYXR0cihcInRyYW5zbGF0ZVhcIix3KX07ay55U2V0dGVyPWZ1bmN0aW9uKGEpe089ay55PXkoYSk7ay5hdHRyKFwidHJhbnNsYXRlWVwiLE8pfTt2YXIgRD1rLmNzcztyZXR1cm4geChrLHtjc3M6ZnVuY3Rpb24oYSl7aWYoYSl7dmFyIGI9e30sYT1DKGEpO24oay50ZXh0UHJvcHMsZnVuY3Rpb24oYyl7YVtjXSE9PXQmJihiW2NdPWFbY10sZGVsZXRlIGFbY10pfSk7bC5jc3MoYil9cmV0dXJuIEQuY2FsbChrLGEpfSxnZXRCQm94OmZ1bmN0aW9uKCl7cmV0dXJue3dpZHRoOm8ud2lkdGgrMipyLGhlaWdodDpvLmhlaWdodCsyKnIseDpvLngtcix5Om8ueS1cbnJ9fSxzaGFkb3c6ZnVuY3Rpb24oYSl7bSYmbS5zaGFkb3coYSk7cmV0dXJuIGt9LGRlc3Ryb3k6ZnVuY3Rpb24oKXtUKGsuZWxlbWVudCxcIm1vdXNlZW50ZXJcIik7VChrLmVsZW1lbnQsXCJtb3VzZWxlYXZlXCIpO2wmJihsPWwuZGVzdHJveSgpKTttJiYobT1tLmRlc3Ryb3koKSk7Wi5wcm90b3R5cGUuZGVzdHJveS5jYWxsKGspO2s9aj1MPUU9Qj1udWxsfX0pfX07WWE9eWE7eChaLnByb3RvdHlwZSx7aHRtbENzczpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmVsZW1lbnQ7aWYoYj1hJiZiLnRhZ05hbWU9PT1cIlNQQU5cIiYmYS53aWR0aClkZWxldGUgYS53aWR0aCx0aGlzLnRleHRXaWR0aD1iLHRoaXMudXBkYXRlVHJhbnNmb3JtKCk7aWYoYSYmYS50ZXh0T3ZlcmZsb3c9PT1cImVsbGlwc2lzXCIpYS53aGl0ZVNwYWNlPVwibm93cmFwXCIsYS5vdmVyZmxvdz1cImhpZGRlblwiO3RoaXMuc3R5bGVzPXgodGhpcy5zdHlsZXMsYSk7Rih0aGlzLmVsZW1lbnQsYSk7cmV0dXJuIHRoaXN9LGh0bWxHZXRCQm94OmZ1bmN0aW9uKCl7dmFyIGE9XG50aGlzLmVsZW1lbnQ7aWYoYS5ub2RlTmFtZT09PVwidGV4dFwiKWEuc3R5bGUucG9zaXRpb249XCJhYnNvbHV0ZVwiO3JldHVybnt4OmEub2Zmc2V0TGVmdCx5OmEub2Zmc2V0VG9wLHdpZHRoOmEub2Zmc2V0V2lkdGgsaGVpZ2h0OmEub2Zmc2V0SGVpZ2h0fX0saHRtbFVwZGF0ZVRyYW5zZm9ybTpmdW5jdGlvbigpe2lmKHRoaXMuYWRkZWQpe3ZhciBhPXRoaXMucmVuZGVyZXIsYj10aGlzLmVsZW1lbnQsYz10aGlzLnRyYW5zbGF0ZVh8fDAsZD10aGlzLnRyYW5zbGF0ZVl8fDAsZT10aGlzLnh8fDAsZj10aGlzLnl8fDAsZz10aGlzLnRleHRBbGlnbnx8XCJsZWZ0XCIsaD17bGVmdDowLGNlbnRlcjowLjUscmlnaHQ6MX1bZ10saT10aGlzLnNoYWRvd3Msaj10aGlzLnN0eWxlcztGKGIse21hcmdpbkxlZnQ6YyxtYXJnaW5Ub3A6ZH0pO2kmJm4oaSxmdW5jdGlvbihhKXtGKGEse21hcmdpbkxlZnQ6YysxLG1hcmdpblRvcDpkKzF9KX0pO3RoaXMuaW52ZXJ0ZWQmJm4oYi5jaGlsZE5vZGVzLGZ1bmN0aW9uKGMpe2EuaW52ZXJ0Q2hpbGQoYyxcbmIpfSk7aWYoYi50YWdOYW1lPT09XCJTUEFOXCIpe3ZhciBpPXRoaXMucm90YXRpb24saz1HKHRoaXMudGV4dFdpZHRoKSxsPWomJmoud2hpdGVTcGFjZSxtPVtpLGcsYi5pbm5lckhUTUwsdGhpcy50ZXh0V2lkdGgsdGhpcy50ZXh0QWxpZ25dLmpvaW4oXCIsXCIpO2lmKG0hPT10aGlzLmNUVCl7aj1hLmZvbnRNZXRyaWNzKGIuc3R5bGUuZm9udFNpemUpLmI7cyhpKSYmdGhpcy5zZXRTcGFuUm90YXRpb24oaSxoLGopO2lmKGIub2Zmc2V0V2lkdGg+ayYmL1sgXFwtXS8udGVzdChiLnRleHRDb250ZW50fHxiLmlubmVyVGV4dCkpRihiLHt3aWR0aDprK1wicHhcIixkaXNwbGF5OlwiYmxvY2tcIix3aGl0ZVNwYWNlOmx8fFwibm9ybWFsXCJ9KSx0aGlzLmhhc1RleHRXaWR0aD0hMDtlbHNlIGlmKHRoaXMuaGFzVGV4dFdpZHRoKUYoYix7d2lkdGg6XCJcIixkaXNwbGF5OlwiXCIsd2hpdGVTcGFjZTpsfHxcIm5vd3JhcFwifSksdGhpcy5oYXNUZXh0V2lkdGg9ITE7dGhpcy5nZXRTcGFuQ29ycmVjdGlvbih0aGlzLmhhc1RleHRXaWR0aD9cbms6Yi5vZmZzZXRXaWR0aCxqLGgsaSxnKX1GKGIse2xlZnQ6ZSsodGhpcy54Q29ycnx8MCkrXCJweFwiLHRvcDpmKyh0aGlzLnlDb3JyfHwwKStcInB4XCJ9KTtpZih0YilqPWIub2Zmc2V0SGVpZ2h0O3RoaXMuY1RUPW19fWVsc2UgdGhpcy5hbGlnbk9uQWRkPSEwfSxzZXRTcGFuUm90YXRpb246ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXt9LGU9S2E/XCItbXMtdHJhbnNmb3JtXCI6dGI/XCItd2Via2l0LXRyYW5zZm9ybVwiOlhhP1wiTW96VHJhbnNmb3JtXCI6VWI/XCItby10cmFuc2Zvcm1cIjpcIlwiO2RbZV09ZC50cmFuc2Zvcm09XCJyb3RhdGUoXCIrYStcImRlZylcIjtkW2UrKFhhP1wiT3JpZ2luXCI6XCItb3JpZ2luXCIpXT1kLnRyYW5zZm9ybU9yaWdpbj1iKjEwMCtcIiUgXCIrYytcInB4XCI7Rih0aGlzLmVsZW1lbnQsZCl9LGdldFNwYW5Db3JyZWN0aW9uOmZ1bmN0aW9uKGEsYixjKXt0aGlzLnhDb3JyPS1hKmM7dGhpcy55Q29ycj0tYn19KTt4KHlhLnByb3RvdHlwZSx7aHRtbDpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9XG50aGlzLmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpLGU9ZC5lbGVtZW50LGY9ZC5yZW5kZXJlcixnPWYuaXNTVkcsaD1mdW5jdGlvbihhLGIpe24oW1wib3BhY2l0eVwiLFwidmlzaWJpbGl0eVwiXSxmdW5jdGlvbihjKXtVKGEsYytcIlNldHRlclwiLGZ1bmN0aW9uKGEsYyxkLGUpe2EuY2FsbCh0aGlzLGMsZCxlKTtiW2RdPWN9KX0pfTtkLnRleHRTZXR0ZXI9ZnVuY3Rpb24oYSl7YSE9PWUuaW5uZXJIVE1MJiZkZWxldGUgdGhpcy5iQm94O2UuaW5uZXJIVE1MPXRoaXMudGV4dFN0cj1hO2QuaHRtbFVwZGF0ZVRyYW5zZm9ybSgpfTtnJiZoKGQsZC5lbGVtZW50LnN0eWxlKTtkLnhTZXR0ZXI9ZC55U2V0dGVyPWQuYWxpZ25TZXR0ZXI9ZC5yb3RhdGlvblNldHRlcj1mdW5jdGlvbihhLGIpe2I9PT1cImFsaWduXCImJihiPVwidGV4dEFsaWduXCIpO2RbYl09YTtkLmh0bWxVcGRhdGVUcmFuc2Zvcm0oKX07ZC5hdHRyKHt0ZXh0OmEseDp5KGIpLHk6eShjKX0pLmNzcyh7cG9zaXRpb246XCJhYnNvbHV0ZVwiLGZvbnRGYW1pbHk6dGhpcy5zdHlsZS5mb250RmFtaWx5LFxuZm9udFNpemU6dGhpcy5zdHlsZS5mb250U2l6ZX0pO2Uuc3R5bGUud2hpdGVTcGFjZT1cIm5vd3JhcFwiO2QuY3NzPWQuaHRtbENzcztpZihnKWQuYWRkPWZ1bmN0aW9uKGEpe3ZhciBiLGM9Zi5ib3gucGFyZW50Tm9kZSxnPVtdO2lmKHRoaXMucGFyZW50R3JvdXA9YSl7aWYoYj1hLmRpdiwhYil7Zm9yKDthOylnLnB1c2goYSksYT1hLnBhcmVudEdyb3VwO24oZy5yZXZlcnNlKCksZnVuY3Rpb24oYSl7dmFyIGQsZT1YKGEuZWxlbWVudCxcImNsYXNzXCIpO2UmJihlPXtjbGFzc05hbWU6ZX0pO2I9YS5kaXY9YS5kaXZ8fGVhKFdhLGUse3Bvc2l0aW9uOlwiYWJzb2x1dGVcIixsZWZ0OihhLnRyYW5zbGF0ZVh8fDApK1wicHhcIix0b3A6KGEudHJhbnNsYXRlWXx8MCkrXCJweFwiLG9wYWNpdHk6YS5vcGFjaXR5fSxifHxjKTtkPWIuc3R5bGU7eChhLHt0cmFuc2xhdGVYU2V0dGVyOmZ1bmN0aW9uKGIsYyl7ZC5sZWZ0PWIrXCJweFwiO2FbY109YjthLmRvVHJhbnNmb3JtPSEwfSx0cmFuc2xhdGVZU2V0dGVyOmZ1bmN0aW9uKGIsXG5jKXtkLnRvcD1iK1wicHhcIjthW2NdPWI7YS5kb1RyYW5zZm9ybT0hMH19KTtoKGEsZCl9KX19ZWxzZSBiPWM7Yi5hcHBlbmRDaGlsZChlKTtkLmFkZGVkPSEwO2QuYWxpZ25PbkFkZCYmZC5odG1sVXBkYXRlVHJhbnNmb3JtKCk7cmV0dXJuIGR9O3JldHVybiBkfX0pO3ZhciBtYixhYTtpZighamEmJiFxYSlhYT17aW5pdDpmdW5jdGlvbihhLGIpe3ZhciBjPVtcIjxcIixiLCcgZmlsbGVkPVwiZlwiIHN0cm9rZWQ9XCJmXCInXSxkPVtcInBvc2l0aW9uOiBcIixcImFic29sdXRlXCIsXCI7XCJdLGU9Yj09PVdhOyhiPT09XCJzaGFwZVwifHxlKSYmZC5wdXNoKFwibGVmdDowO3RvcDowO3dpZHRoOjFweDtoZWlnaHQ6MXB4O1wiKTtkLnB1c2goXCJ2aXNpYmlsaXR5OiBcIixlP1wiaGlkZGVuXCI6XCJ2aXNpYmxlXCIpO2MucHVzaCgnIHN0eWxlPVwiJyxkLmpvaW4oXCJcIiksJ1wiLz4nKTtpZihiKWM9ZXx8Yj09PVwic3BhblwifHxiPT09XCJpbWdcIj9jLmpvaW4oXCJcIik6YS5wcmVwVk1MKGMpLHRoaXMuZWxlbWVudD1lYShjKTt0aGlzLnJlbmRlcmVyPVxuYX0sYWRkOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMucmVuZGVyZXIsYz10aGlzLmVsZW1lbnQsZD1iLmJveCxlPWEmJmEuaW52ZXJ0ZWQsZD1hP2EuZWxlbWVudHx8YTpkO2lmKGEpdGhpcy5wYXJlbnRHcm91cD1hO2UmJmIuaW52ZXJ0Q2hpbGQoYyxkKTtkLmFwcGVuZENoaWxkKGMpO3RoaXMuYWRkZWQ9ITA7dGhpcy5hbGlnbk9uQWRkJiYhdGhpcy5kZWZlclVwZGF0ZVRyYW5zZm9ybSYmdGhpcy51cGRhdGVUcmFuc2Zvcm0oKTtpZih0aGlzLm9uQWRkKXRoaXMub25BZGQoKTtyZXR1cm4gdGhpc30sdXBkYXRlVHJhbnNmb3JtOloucHJvdG90eXBlLmh0bWxVcGRhdGVUcmFuc2Zvcm0sc2V0U3BhblJvdGF0aW9uOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5yb3RhdGlvbixiPWJhKGEqcGEpLGM9a2EoYSpwYSk7Rih0aGlzLmVsZW1lbnQse2ZpbHRlcjphP1tcInByb2dpZDpEWEltYWdlVHJhbnNmb3JtLk1pY3Jvc29mdC5NYXRyaXgoTTExPVwiLGIsXCIsIE0xMj1cIiwtYyxcIiwgTTIxPVwiLGMsXCIsIE0yMj1cIixcbmIsXCIsIHNpemluZ01ldGhvZD0nYXV0byBleHBhbmQnKVwiXS5qb2luKFwiXCIpOlwibm9uZVwifSl9LGdldFNwYW5Db3JyZWN0aW9uOmZ1bmN0aW9uKGEsYixjLGQsZSl7dmFyIGY9ZD9iYShkKnBhKToxLGc9ZD9rYShkKnBhKTowLGg9cSh0aGlzLmVsZW1IZWlnaHQsdGhpcy5lbGVtZW50Lm9mZnNldEhlaWdodCksaTt0aGlzLnhDb3JyPWY8MCYmLWE7dGhpcy55Q29ycj1nPDAmJi1oO2k9ZipnPDA7dGhpcy54Q29ycis9ZypiKihpPzEtYzpjKTt0aGlzLnlDb3JyLT1mKmIqKGQ/aT9jOjEtYzoxKTtlJiZlIT09XCJsZWZ0XCImJih0aGlzLnhDb3JyLT1hKmMqKGY8MD8tMToxKSxkJiYodGhpcy55Q29yci09aCpjKihnPDA/LTE6MSkpLEYodGhpcy5lbGVtZW50LHt0ZXh0QWxpZ246ZX0pKX0scGF0aFRvVk1MOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1hLmxlbmd0aCxjPVtdO2ItLTspaWYodWEoYVtiXSkpY1tiXT15KGFbYl0qMTApLTU7ZWxzZSBpZihhW2JdPT09XCJaXCIpY1tiXT1cInhcIjtlbHNlIGlmKGNbYl09XG5hW2JdLGEuaXNBcmMmJihhW2JdPT09XCJ3YVwifHxhW2JdPT09XCJhdFwiKSljW2IrNV09PT1jW2IrN10mJihjW2IrN10rPWFbYis3XT5hW2IrNV0/MTotMSksY1tiKzZdPT09Y1tiKzhdJiYoY1tiKzhdKz1hW2IrOF0+YVtiKzZdPzE6LTEpO3JldHVybiBjLmpvaW4oXCIgXCIpfHxcInhcIn0sY2xpcDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLGM7YT8oYz1hLm1lbWJlcnMsQWEoYyxiKSxjLnB1c2goYiksYi5kZXN0cm95Q2xpcD1mdW5jdGlvbigpe0FhKGMsYil9LGE9YS5nZXRDU1MoYikpOihiLmRlc3Ryb3lDbGlwJiZiLmRlc3Ryb3lDbGlwKCksYT17Y2xpcDpzYj9cImluaGVyaXRcIjpcInJlY3QoYXV0bylcIn0pO3JldHVybiBiLmNzcyhhKX0sY3NzOloucHJvdG90eXBlLmh0bWxDc3Msc2FmZVJlbW92ZUNoaWxkOmZ1bmN0aW9uKGEpe2EucGFyZW50Tm9kZSYmVmEoYSl9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLmRlc3Ryb3lDbGlwJiZ0aGlzLmRlc3Ryb3lDbGlwKCk7cmV0dXJuIFoucHJvdG90eXBlLmRlc3Ryb3kuYXBwbHkodGhpcyl9LFxub246ZnVuY3Rpb24oYSxiKXt0aGlzLmVsZW1lbnRbXCJvblwiK2FdPWZ1bmN0aW9uKCl7dmFyIGE9Si5ldmVudDthLnRhcmdldD1hLnNyY0VsZW1lbnQ7YihhKX07cmV0dXJuIHRoaXN9LGN1dE9mZlBhdGg6ZnVuY3Rpb24oYSxiKXt2YXIgYyxhPWEuc3BsaXQoL1sgLF0vKTtjPWEubGVuZ3RoO2lmKGM9PT05fHxjPT09MTEpYVtjLTRdPWFbYy0yXT1HKGFbYy0yXSktMTAqYjtyZXR1cm4gYS5qb2luKFwiIFwiKX0sc2hhZG93OmZ1bmN0aW9uKGEsYixjKXt2YXIgZD1bXSxlLGY9dGhpcy5lbGVtZW50LGc9dGhpcy5yZW5kZXJlcixoLGk9Zi5zdHlsZSxqLGs9Zi5wYXRoLGwsbSxvLHA7ayYmdHlwZW9mIGsudmFsdWUhPT1cInN0cmluZ1wiJiYoaz1cInhcIik7bT1rO2lmKGEpe289cShhLndpZHRoLDMpO3A9KGEub3BhY2l0eXx8MC4xNSkvbztmb3IoZT0xO2U8PTM7ZSsrKXtsPW8qMisxLTIqZTtjJiYobT10aGlzLmN1dE9mZlBhdGgoay52YWx1ZSxsKzAuNSkpO2o9Wyc8c2hhcGUgaXNTaGFkb3c9XCJ0cnVlXCIgc3Ryb2tld2VpZ2h0PVwiJyxcbmwsJ1wiIGZpbGxlZD1cImZhbHNlXCIgcGF0aD1cIicsbSwnXCIgY29vcmRzaXplPVwiMTAgMTBcIiBzdHlsZT1cIicsZi5zdHlsZS5jc3NUZXh0LCdcIiAvPiddO2g9ZWEoZy5wcmVwVk1MKGopLG51bGwse2xlZnQ6RyhpLmxlZnQpK3EoYS5vZmZzZXRYLDEpLHRvcDpHKGkudG9wKStxKGEub2Zmc2V0WSwxKX0pO2lmKGMpaC5jdXRPZmY9bCsxO2o9Wyc8c3Ryb2tlIGNvbG9yPVwiJyxhLmNvbG9yfHxcImJsYWNrXCIsJ1wiIG9wYWNpdHk9XCInLHAqZSwnXCIvPiddO2VhKGcucHJlcFZNTChqKSxudWxsLG51bGwsaCk7Yj9iLmVsZW1lbnQuYXBwZW5kQ2hpbGQoaCk6Zi5wYXJlbnROb2RlLmluc2VydEJlZm9yZShoLGYpO2QucHVzaChoKX10aGlzLnNoYWRvd3M9ZH1yZXR1cm4gdGhpc30sdXBkYXRlU2hhZG93czpyYSxzZXRBdHRyOmZ1bmN0aW9uKGEsYil7c2I/dGhpcy5lbGVtZW50W2FdPWI6dGhpcy5lbGVtZW50LnNldEF0dHJpYnV0ZShhLGIpfSxjbGFzc1NldHRlcjpmdW5jdGlvbihhKXt0aGlzLmVsZW1lbnQuY2xhc3NOYW1lPVxuYX0sZGFzaHN0eWxlU2V0dGVyOmZ1bmN0aW9uKGEsYixjKXsoYy5nZXRFbGVtZW50c0J5VGFnTmFtZShcInN0cm9rZVwiKVswXXx8ZWEodGhpcy5yZW5kZXJlci5wcmVwVk1MKFtcIjxzdHJva2UvPlwiXSksbnVsbCxudWxsLGMpKVtiXT1hfHxcInNvbGlkXCI7dGhpc1tiXT1hfSxkU2V0dGVyOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD10aGlzLnNoYWRvd3MsYT1hfHxbXTt0aGlzLmQ9YS5qb2luJiZhLmpvaW4oXCIgXCIpO2MucGF0aD1hPXRoaXMucGF0aFRvVk1MKGEpO2lmKGQpZm9yKGM9ZC5sZW5ndGg7Yy0tOylkW2NdLnBhdGg9ZFtjXS5jdXRPZmY/dGhpcy5jdXRPZmZQYXRoKGEsZFtjXS5jdXRPZmYpOmE7dGhpcy5zZXRBdHRyKGIsYSl9LGZpbGxTZXR0ZXI6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPWMubm9kZU5hbWU7aWYoZD09PVwiU1BBTlwiKWMuc3R5bGUuY29sb3I9YTtlbHNlIGlmKGQhPT1cIklNR1wiKWMuZmlsbGVkPWEhPT1cIm5vbmVcIix0aGlzLnNldEF0dHIoXCJmaWxsY29sb3JcIix0aGlzLnJlbmRlcmVyLmNvbG9yKGEsXG5jLGIsdGhpcykpfSxcImZpbGwtb3BhY2l0eVNldHRlclwiOmZ1bmN0aW9uKGEsYixjKXtlYSh0aGlzLnJlbmRlcmVyLnByZXBWTUwoW1wiPFwiLGIuc3BsaXQoXCItXCIpWzBdLCcgb3BhY2l0eT1cIicsYSwnXCIvPiddKSxudWxsLG51bGwsYyl9LG9wYWNpdHlTZXR0ZXI6cmEscm90YXRpb25TZXR0ZXI6ZnVuY3Rpb24oYSxiLGMpe2M9Yy5zdHlsZTt0aGlzW2JdPWNbYl09YTtjLmxlZnQ9LXkoa2EoYSpwYSkrMSkrXCJweFwiO2MudG9wPXkoYmEoYSpwYSkpK1wicHhcIn0sc3Ryb2tlU2V0dGVyOmZ1bmN0aW9uKGEsYixjKXt0aGlzLnNldEF0dHIoXCJzdHJva2Vjb2xvclwiLHRoaXMucmVuZGVyZXIuY29sb3IoYSxjLGIsdGhpcykpfSxcInN0cm9rZS13aWR0aFNldHRlclwiOmZ1bmN0aW9uKGEsYixjKXtjLnN0cm9rZWQ9ISFhO3RoaXNbYl09YTt1YShhKSYmKGErPVwicHhcIik7dGhpcy5zZXRBdHRyKFwic3Ryb2tld2VpZ2h0XCIsYSl9LHRpdGxlU2V0dGVyOmZ1bmN0aW9uKGEsYil7dGhpcy5zZXRBdHRyKGIsYSl9LFxudmlzaWJpbGl0eVNldHRlcjpmdW5jdGlvbihhLGIsYyl7YT09PVwiaW5oZXJpdFwiJiYoYT1cInZpc2libGVcIik7dGhpcy5zaGFkb3dzJiZuKHRoaXMuc2hhZG93cyxmdW5jdGlvbihjKXtjLnN0eWxlW2JdPWF9KTtjLm5vZGVOYW1lPT09XCJESVZcIiYmKGE9YT09PVwiaGlkZGVuXCI/XCItOTk5ZW1cIjowLHNifHwoYy5zdHlsZVtiXT1hP1widmlzaWJsZVwiOlwiaGlkZGVuXCIpLGI9XCJ0b3BcIik7Yy5zdHlsZVtiXT1hfSx4U2V0dGVyOmZ1bmN0aW9uKGEsYixjKXt0aGlzW2JdPWE7Yj09PVwieFwiP2I9XCJsZWZ0XCI6Yj09PVwieVwiJiYoYj1cInRvcFwiKTt0aGlzLnVwZGF0ZUNsaXBwaW5nPyh0aGlzW2JdPWEsdGhpcy51cGRhdGVDbGlwcGluZygpKTpjLnN0eWxlW2JdPWF9LHpJbmRleFNldHRlcjpmdW5jdGlvbihhLGIsYyl7Yy5zdHlsZVtiXT1hfX0sYWFbXCJzdHJva2Utb3BhY2l0eVNldHRlclwiXT1hYVtcImZpbGwtb3BhY2l0eVNldHRlclwiXSx6LlZNTEVsZW1lbnQ9YWE9bGEoWixhYSksYWEucHJvdG90eXBlLnlTZXR0ZXI9XG5hYS5wcm90b3R5cGUud2lkdGhTZXR0ZXI9YWEucHJvdG90eXBlLmhlaWdodFNldHRlcj1hYS5wcm90b3R5cGUueFNldHRlcixhYT17RWxlbWVudDphYSxpc0lFODpNYS5pbmRleE9mKFwiTVNJRSA4LjBcIik+LTEsaW5pdDpmdW5jdGlvbihhLGIsYyxkKXt2YXIgZTt0aGlzLmFsaWduZWRPYmplY3RzPVtdO2Q9dGhpcy5jcmVhdGVFbGVtZW50KFdhKS5jc3MoeCh0aGlzLmdldFN0eWxlKGQpLHtwb3NpdGlvbjpcInJlbGF0aXZlXCJ9KSk7ZT1kLmVsZW1lbnQ7YS5hcHBlbmRDaGlsZChkLmVsZW1lbnQpO3RoaXMuaXNWTUw9ITA7dGhpcy5ib3g9ZTt0aGlzLmJveFdyYXBwZXI9ZDt0aGlzLmdyYWRpZW50cz17fTt0aGlzLmNhY2hlPXt9O3RoaXMuY2FjaGVLZXlzPVtdO3RoaXMuaW1nQ291bnQ9MDt0aGlzLnNldFNpemUoYixjLCExKTtpZighQi5uYW1lc3BhY2VzLmhjdil7Qi5uYW1lc3BhY2VzLmFkZChcImhjdlwiLFwidXJuOnNjaGVtYXMtbWljcm9zb2Z0LWNvbTp2bWxcIik7dHJ5e0IuY3JlYXRlU3R5bGVTaGVldCgpLmNzc1RleHQ9XG5cImhjdlxcXFw6ZmlsbCwgaGN2XFxcXDpwYXRoLCBoY3ZcXFxcOnNoYXBlLCBoY3ZcXFxcOnN0cm9rZXsgYmVoYXZpb3I6dXJsKCNkZWZhdWx0I1ZNTCk7IGRpc3BsYXk6IGlubGluZS1ibG9jazsgfSBcIn1jYXRjaChmKXtCLnN0eWxlU2hlZXRzWzBdLmNzc1RleHQrPVwiaGN2XFxcXDpmaWxsLCBoY3ZcXFxcOnBhdGgsIGhjdlxcXFw6c2hhcGUsIGhjdlxcXFw6c3Ryb2tleyBiZWhhdmlvcjp1cmwoI2RlZmF1bHQjVk1MKTsgZGlzcGxheTogaW5saW5lLWJsb2NrOyB9IFwifX19LGlzSGlkZGVuOmZ1bmN0aW9uKCl7cmV0dXJuIXRoaXMuYm94Lm9mZnNldFdpZHRofSxjbGlwUmVjdDpmdW5jdGlvbihhLGIsYyxkKXt2YXIgZT10aGlzLmNyZWF0ZUVsZW1lbnQoKSxmPWRhKGEpO3JldHVybiB4KGUse21lbWJlcnM6W10sY291bnQ6MCxsZWZ0OihmP2EueDphKSsxLHRvcDooZj9hLnk6YikrMSx3aWR0aDooZj9hLndpZHRoOmMpLTEsaGVpZ2h0OihmP2EuaGVpZ2h0OmQpLTEsZ2V0Q1NTOmZ1bmN0aW9uKGEpe3ZhciBiPWEuZWxlbWVudCxcbmM9Yi5ub2RlTmFtZSxhPWEuaW52ZXJ0ZWQsZD10aGlzLnRvcC0oYz09PVwic2hhcGVcIj9iLm9mZnNldFRvcDowKSxlPXRoaXMubGVmdCxiPWUrdGhpcy53aWR0aCxmPWQrdGhpcy5oZWlnaHQsZD17Y2xpcDpcInJlY3QoXCIreShhP2U6ZCkrXCJweCxcIit5KGE/ZjpiKStcInB4LFwiK3koYT9iOmYpK1wicHgsXCIreShhP2Q6ZSkrXCJweClcIn07IWEmJnNiJiZjPT09XCJESVZcIiYmeChkLHt3aWR0aDpiK1wicHhcIixoZWlnaHQ6ZitcInB4XCJ9KTtyZXR1cm4gZH0sdXBkYXRlQ2xpcHBpbmc6ZnVuY3Rpb24oKXtuKGUubWVtYmVycyxmdW5jdGlvbihhKXthLmVsZW1lbnQmJmEuY3NzKGUuZ2V0Q1NTKGEpKX0pfX0pfSxjb2xvcjpmdW5jdGlvbihhLGIsYyxkKXt2YXIgZT10aGlzLGYsZz0vXnJnYmEvLGgsaSxqPVwibm9uZVwiO2EmJmEubGluZWFyR3JhZGllbnQ/aT1cImdyYWRpZW50XCI6YSYmYS5yYWRpYWxHcmFkaWVudCYmKGk9XCJwYXR0ZXJuXCIpO2lmKGkpe3ZhciBrLGwsbT1hLmxpbmVhckdyYWRpZW50fHxhLnJhZGlhbEdyYWRpZW50LFxubyxwLHIsQSxxLHU9XCJcIixhPWEuc3RvcHMsdyxPPVtdLFI9ZnVuY3Rpb24oKXtoPVsnPGZpbGwgY29sb3JzPVwiJytPLmpvaW4oXCIsXCIpKydcIiBvcGFjaXR5PVwiJyxyLCdcIiBvOm9wYWNpdHkyPVwiJyxwLCdcIiB0eXBlPVwiJyxpLCdcIiAnLHUsJ2ZvY3VzPVwiMTAwJVwiIG1ldGhvZD1cImFueVwiIC8+J107ZWEoZS5wcmVwVk1MKGgpLG51bGwsbnVsbCxiKX07bz1hWzBdO3c9YVthLmxlbmd0aC0xXTtvWzBdPjAmJmEudW5zaGlmdChbMCxvWzFdXSk7d1swXTwxJiZhLnB1c2goWzEsd1sxXV0pO24oYSxmdW5jdGlvbihhLGIpe2cudGVzdChhWzFdKT8oZj13YShhWzFdKSxrPWYuZ2V0KFwicmdiXCIpLGw9Zi5nZXQoXCJhXCIpKTooaz1hWzFdLGw9MSk7Ty5wdXNoKGFbMF0qMTAwK1wiJSBcIitrKTtiPyhyPWwsQT1rKToocD1sLHE9ayl9KTtpZihjPT09XCJmaWxsXCIpaWYoaT09PVwiZ3JhZGllbnRcIiljPW0ueDF8fG1bMF18fDAsYT1tLnkxfHxtWzFdfHwwLG89bS54Mnx8bVsyXXx8MCxtPW0ueTJ8fG1bM118fDAsdT1cbidhbmdsZT1cIicrKDkwLVkuYXRhbigobS1hKS8oby1jKSkqMTgwL0JhKSsnXCInLFIoKTtlbHNle3ZhciBqPW0ucixoYT1qKjIscz1qKjIsdj1tLmN4LHQ9bS5jeSx5PWIucmFkaWFsUmVmZXJlbmNlLHgsaj1mdW5jdGlvbigpe3kmJih4PWQuZ2V0QkJveCgpLHYrPSh5WzBdLXgueCkveC53aWR0aC0wLjUsdCs9KHlbMV0teC55KS94LmhlaWdodC0wLjUsaGEqPXlbMl0veC53aWR0aCxzKj15WzJdL3guaGVpZ2h0KTt1PSdzcmM9XCInK04uZ2xvYmFsLlZNTFJhZGlhbEdyYWRpZW50VVJMKydcIiBzaXplPVwiJytoYStcIixcIitzKydcIiBvcmlnaW49XCIwLjUsMC41XCIgcG9zaXRpb249XCInK3YrXCIsXCIrdCsnXCIgY29sb3IyPVwiJytxKydcIiAnO1IoKX07ZC5hZGRlZD9qKCk6ZC5vbkFkZD1qO2o9QX1lbHNlIGo9a31lbHNlIGlmKGcudGVzdChhKSYmYi50YWdOYW1lIT09XCJJTUdcIilmPXdhKGEpLGRbYytcIi1vcGFjaXR5U2V0dGVyXCJdKGYuZ2V0KFwiYVwiKSxjLGIpLGo9Zi5nZXQoXCJyZ2JcIik7ZWxzZXtqPWIuZ2V0RWxlbWVudHNCeVRhZ05hbWUoYyk7XG5pZihqLmxlbmd0aClqWzBdLm9wYWNpdHk9MSxqWzBdLnR5cGU9XCJzb2xpZFwiO2o9YX1yZXR1cm4gan0scHJlcFZNTDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmlzSUU4LGE9YS5qb2luKFwiXCIpO2I/KGE9YS5yZXBsYWNlKFwiLz5cIiwnIHhtbG5zPVwidXJuOnNjaGVtYXMtbWljcm9zb2Z0LWNvbTp2bWxcIiAvPicpLGE9YS5pbmRleE9mKCdzdHlsZT1cIicpPT09LTE/YS5yZXBsYWNlKFwiLz5cIiwnIHN0eWxlPVwiZGlzcGxheTppbmxpbmUtYmxvY2s7YmVoYXZpb3I6dXJsKCNkZWZhdWx0I1ZNTCk7XCIgLz4nKTphLnJlcGxhY2UoJ3N0eWxlPVwiJywnc3R5bGU9XCJkaXNwbGF5OmlubGluZS1ibG9jaztiZWhhdmlvcjp1cmwoI2RlZmF1bHQjVk1MKTsnKSk6YT1hLnJlcGxhY2UoXCI8XCIsXCI8aGN2OlwiKTtyZXR1cm4gYX0sdGV4dDp5YS5wcm90b3R5cGUuaHRtbCxwYXRoOmZ1bmN0aW9uKGEpe3ZhciBiPXtjb29yZHNpemU6XCIxMCAxMFwifTtKYShhKT9iLmQ9YTpkYShhKSYmeChiLGEpO3JldHVybiB0aGlzLmNyZWF0ZUVsZW1lbnQoXCJzaGFwZVwiKS5hdHRyKGIpfSxcbmNpcmNsZTpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9dGhpcy5zeW1ib2woXCJjaXJjbGVcIik7aWYoZGEoYSkpYz1hLnIsYj1hLnksYT1hLng7ZC5pc0NpcmNsZT0hMDtkLnI9YztyZXR1cm4gZC5hdHRyKHt4OmEseTpifSl9LGc6ZnVuY3Rpb24oYSl7dmFyIGI7YSYmKGI9e2NsYXNzTmFtZTpcImhpZ2hjaGFydHMtXCIrYSxcImNsYXNzXCI6XCJoaWdoY2hhcnRzLVwiK2F9KTtyZXR1cm4gdGhpcy5jcmVhdGVFbGVtZW50KFdhKS5hdHRyKGIpfSxpbWFnZTpmdW5jdGlvbihhLGIsYyxkLGUpe3ZhciBmPXRoaXMuY3JlYXRlRWxlbWVudChcImltZ1wiKS5hdHRyKHtzcmM6YX0pO2FyZ3VtZW50cy5sZW5ndGg+MSYmZi5hdHRyKHt4OmIseTpjLHdpZHRoOmQsaGVpZ2h0OmV9KTtyZXR1cm4gZn0sY3JlYXRlRWxlbWVudDpmdW5jdGlvbihhKXtyZXR1cm4gYT09PVwicmVjdFwiP3RoaXMuc3ltYm9sKGEpOnlhLnByb3RvdHlwZS5jcmVhdGVFbGVtZW50LmNhbGwodGhpcyxhKX0saW52ZXJ0Q2hpbGQ6ZnVuY3Rpb24oYSxcbmIpe3ZhciBjPXRoaXMsZD1iLnN0eWxlLGU9YS50YWdOYW1lPT09XCJJTUdcIiYmYS5zdHlsZTtGKGEse2ZsaXA6XCJ4XCIsbGVmdDpHKGQud2lkdGgpLShlP0coZS50b3ApOjEpLHRvcDpHKGQuaGVpZ2h0KS0oZT9HKGUubGVmdCk6MSkscm90YXRpb246LTkwfSk7bihhLmNoaWxkTm9kZXMsZnVuY3Rpb24oYil7Yy5pbnZlcnRDaGlsZChiLGEpfSl9LHN5bWJvbHM6e2FyYzpmdW5jdGlvbihhLGIsYyxkLGUpe3ZhciBmPWUuc3RhcnQsZz1lLmVuZCxoPWUucnx8Y3x8ZCxjPWUuaW5uZXJSLGQ9YmEoZiksaT1rYShmKSxqPWJhKGcpLGs9a2EoZyk7aWYoZy1mPT09MClyZXR1cm5bXCJ4XCJdO2Y9W1wid2FcIixhLWgsYi1oLGEraCxiK2gsYStoKmQsYitoKmksYStoKmosYitoKmtdO2Uub3BlbiYmIWMmJmYucHVzaChcImVcIixcIk1cIixhLGIpO2YucHVzaChcImF0XCIsYS1jLGItYyxhK2MsYitjLGErYypqLGIrYyprLGErYypkLGIrYyppLFwieFwiLFwiZVwiKTtmLmlzQXJjPSEwO3JldHVybiBmfSxjaXJjbGU6ZnVuY3Rpb24oYSxcbmIsYyxkLGUpe2UmJihjPWQ9MiplLnIpO2UmJmUuaXNDaXJjbGUmJihhLT1jLzIsYi09ZC8yKTtyZXR1cm5bXCJ3YVwiLGEsYixhK2MsYitkLGErYyxiK2QvMixhK2MsYitkLzIsXCJlXCJdfSxyZWN0OmZ1bmN0aW9uKGEsYixjLGQsZSl7cmV0dXJuIHlhLnByb3RvdHlwZS5zeW1ib2xzWyFzKGUpfHwhZS5yP1wic3F1YXJlXCI6XCJjYWxsb3V0XCJdLmNhbGwoMCxhLGIsYyxkLGUpfX19LHouVk1MUmVuZGVyZXI9bWI9ZnVuY3Rpb24oKXt0aGlzLmluaXQuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxtYi5wcm90b3R5cGU9Qyh5YS5wcm90b3R5cGUsYWEpLFlhPW1iO3lhLnByb3RvdHlwZS5tZWFzdXJlU3BhbldpZHRoPWZ1bmN0aW9uKGEsYil7dmFyIGM9Qi5jcmVhdGVFbGVtZW50KFwic3BhblwiKSxkO2Q9Qi5jcmVhdGVUZXh0Tm9kZShhKTtjLmFwcGVuZENoaWxkKGQpO0YoYyxiKTt0aGlzLmJveC5hcHBlbmRDaGlsZChjKTtkPWMub2Zmc2V0V2lkdGg7VmEoYyk7cmV0dXJuIGR9O3ZhciBXYjtpZihxYSl6LkNhblZHUmVuZGVyZXI9XG5hYT1mdW5jdGlvbigpe1FhPVwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbFwifSxhYS5wcm90b3R5cGUuc3ltYm9scz17fSxXYj1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoKXt2YXIgYT1iLmxlbmd0aCxkO2ZvcihkPTA7ZDxhO2QrKyliW2RdKCk7Yj1bXX12YXIgYj1bXTtyZXR1cm57cHVzaDpmdW5jdGlvbihjLGQpe2lmKGIubGVuZ3RoPT09MCl7dmFyIGU9Qi5nZXRFbGVtZW50c0J5VGFnTmFtZShcImhlYWRcIilbMF0sZj1CLmNyZWF0ZUVsZW1lbnQoXCJzY3JpcHRcIik7Zi50eXBlPVwidGV4dC9qYXZhc2NyaXB0XCI7Zi5zcmM9ZDtmLm9ubG9hZD1hO2UuYXBwZW5kQ2hpbGQoZil9Yi5wdXNoKGMpfX19KCksWWE9YWE7Y2IucHJvdG90eXBlPXthZGRMYWJlbDpmdW5jdGlvbigpe3ZhciBhPXRoaXMuYXhpcyxiPWEub3B0aW9ucyxjPWEuY2hhcnQsZD1hLmNhdGVnb3JpZXMsZT1hLm5hbWVzLGY9dGhpcy5wb3MsZz1iLmxhYmVscyxoPWEudGlja1Bvc2l0aW9ucyxpPWY9PT1oWzBdLGo9Zj09PVxuaFtoLmxlbmd0aC0xXSxlPWQ/cShkW2ZdLGVbZl0sZik6ZixkPXRoaXMubGFiZWwsaD1oLmluZm8sazthLmlzRGF0ZXRpbWVBeGlzJiZoJiYoaz1iLmRhdGVUaW1lTGFiZWxGb3JtYXRzW2guaGlnaGVyUmFua3NbZl18fGgudW5pdE5hbWVdKTt0aGlzLmlzRmlyc3Q9aTt0aGlzLmlzTGFzdD1qO2I9YS5sYWJlbEZvcm1hdHRlci5jYWxsKHtheGlzOmEsY2hhcnQ6Yyxpc0ZpcnN0OmksaXNMYXN0OmosZGF0ZVRpbWVMYWJlbEZvcm1hdDprLHZhbHVlOmEuaXNMb2c/bmEoYS5saW4ybG9nKGUpKTplfSk7cyhkKT9kJiZkLmF0dHIoe3RleHQ6Yn0pOih0aGlzLmxhYmVsTGVuZ3RoPSh0aGlzLmxhYmVsPWQ9cyhiKSYmZy5lbmFibGVkP2MucmVuZGVyZXIudGV4dChiLDAsMCxnLnVzZUhUTUwpLmNzcyhDKGcuc3R5bGUpKS5hZGQoYS5sYWJlbEdyb3VwKTpudWxsKSYmZC5nZXRCQm94KCkud2lkdGgsdGhpcy5yb3RhdGlvbj0wKX0sZ2V0TGFiZWxTaXplOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubGFiZWw/XG50aGlzLmxhYmVsLmdldEJCb3goKVt0aGlzLmF4aXMuaG9yaXo/XCJoZWlnaHRcIjpcIndpZHRoXCJdOjB9LGhhbmRsZU92ZXJmbG93OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuYXhpcyxjPWEueCxkPWIuY2hhcnQuY2hhcnRXaWR0aCxlPWIuY2hhcnQuc3BhY2luZyxmPXEoYi5sYWJlbExlZnQsRShiLnBvcyxlWzNdKSksZT1xKGIubGFiZWxSaWdodCx2KGIucG9zK2IubGVuLGQtZVsxXSkpLGc9dGhpcy5sYWJlbCxoPXRoaXMucm90YXRpb24saT17bGVmdDowLGNlbnRlcjowLjUscmlnaHQ6MX1bYi5sYWJlbEFsaWduXSxqPWcuZ2V0QkJveCgpLndpZHRoLGs9Yi5nZXRTbG90V2lkdGgoKSxsPWssbT0xLG8scD17fTtpZihoKWg8MCYmYy1pKmo8Zj9vPXkoYy9iYShoKnBhKS1mKTpoPjAmJmMraSpqPmUmJihvPXkoKGQtYykvYmEoaCpwYSkpKTtlbHNlIGlmKGQ9YysoMS1pKSpqLGMtaSpqPGY/bD1hLngrbCooMS1pKS1mOmQ+ZSYmKGw9ZS1hLngrbCppLG09LTEpLGw9RShrLGwpLGw8ayYmYi5sYWJlbEFsaWduPT09XG5cImNlbnRlclwiJiYoYS54Kz1tKihrLWwtaSooay1FKGosbCkpKSksaj5sfHxiLmF1dG9Sb3RhdGlvbiYmZy5zdHlsZXMud2lkdGgpbz1sO2lmKG8pe3Aud2lkdGg9bztpZighYi5vcHRpb25zLmxhYmVscy5zdHlsZS50ZXh0T3ZlcmZsb3cpcC50ZXh0T3ZlcmZsb3c9XCJlbGxpcHNpc1wiO2cuY3NzKHApfX0sZ2V0UG9zaXRpb246ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9dGhpcy5heGlzLGY9ZS5jaGFydCxnPWQmJmYub2xkQ2hhcnRIZWlnaHR8fGYuY2hhcnRIZWlnaHQ7cmV0dXJue3g6YT9lLnRyYW5zbGF0ZShiK2MsbnVsbCxudWxsLGQpK2UudHJhbnNCOmUubGVmdCtlLm9mZnNldCsoZS5vcHBvc2l0ZT8oZCYmZi5vbGRDaGFydFdpZHRofHxmLmNoYXJ0V2lkdGgpLWUucmlnaHQtZS5sZWZ0OjApLHk6YT9nLWUuYm90dG9tK2Uub2Zmc2V0LShlLm9wcG9zaXRlP2UuaGVpZ2h0OjApOmctZS50cmFuc2xhdGUoYitjLG51bGwsbnVsbCxkKS1lLnRyYW5zQn19LGdldExhYmVsUG9zaXRpb246ZnVuY3Rpb24oYSxcbmIsYyxkLGUsZixnLGgpe3ZhciBpPXRoaXMuYXhpcyxqPWkudHJhbnNBLGs9aS5yZXZlcnNlZCxsPWkuc3RhZ2dlckxpbmVzLG09aS50aWNrUm90Q29ycnx8e3g6MCx5OjB9LG89ZS55O3Mobyl8fChvPWkuc2lkZT09PTA/Yy5yb3RhdGlvbj8tODotYy5nZXRCQm94KCkuaGVpZ2h0Omkuc2lkZT09PTI/bS55Kzg6YmEoYy5yb3RhdGlvbipwYSkqKG0ueS1jLmdldEJCb3goITEsMCkuaGVpZ2h0LzIpKTthPWErZS54K20ueC0oZiYmZD9mKmoqKGs/LTE6MSk6MCk7Yj1iK28tKGYmJiFkP2Yqaiooaz8xOi0xKTowKTtsJiYoYz1nLyhofHwxKSVsLGkub3Bwb3NpdGUmJihjPWwtYy0xKSxiKz1jKihpLmxhYmVsT2Zmc2V0L2wpKTtyZXR1cm57eDphLHk6eShiKX19LGdldE1hcmtQYXRoOmZ1bmN0aW9uKGEsYixjLGQsZSxmKXtyZXR1cm4gZi5jcmlzcExpbmUoW1wiTVwiLGEsYixcIkxcIixhKyhlPzA6LWMpLGIrKGU/YzowKV0sZCl9LHJlbmRlcjpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9dGhpcy5heGlzLFxuZT1kLm9wdGlvbnMsZj1kLmNoYXJ0LnJlbmRlcmVyLGc9ZC5ob3JpeixoPXRoaXMudHlwZSxpPXRoaXMubGFiZWwsaj10aGlzLnBvcyxrPWUubGFiZWxzLGw9dGhpcy5ncmlkTGluZSxtPWg/aCtcIkdyaWRcIjpcImdyaWRcIixvPWg/aCtcIlRpY2tcIjpcInRpY2tcIixwPWVbbStcIkxpbmVXaWR0aFwiXSxyPWVbbStcIkxpbmVDb2xvclwiXSxBPWVbbStcIkxpbmVEYXNoU3R5bGVcIl0sbT1kLnRpY2tTaXplKG8pLG89ZVtvK1wiQ29sb3JcIl0sUD10aGlzLm1hcmssdT1rLnN0ZXAsdz0hMCxuPWQudGlja21hcmtPZmZzZXQsUj10aGlzLmdldFBvc2l0aW9uKGcsaixuLGIpLGhhPVIueCxSPVIueSxzPWcmJmhhPT09ZC5wb3MrZC5sZW58fCFnJiZSPT09ZC5wb3M/LTE6MSxjPXEoYywxKTt0aGlzLmlzQWN0aXZlPSEwO2lmKHApe2o9ZC5nZXRQbG90TGluZVBhdGgoaituLHAqcyxiLCEwKTtpZihsPT09dCl7bD17c3Ryb2tlOnIsXCJzdHJva2Utd2lkdGhcIjpwfTtpZihBKWwuZGFzaHN0eWxlPUE7aWYoIWgpbC56SW5kZXg9XG4xO2lmKGIpbC5vcGFjaXR5PTA7dGhpcy5ncmlkTGluZT1sPXA/Zi5wYXRoKGopLmF0dHIobCkuYWRkKGQuZ3JpZEdyb3VwKTpudWxsfWlmKCFiJiZsJiZqKWxbdGhpcy5pc05ldz9cImF0dHJcIjpcImFuaW1hdGVcIl0oe2Q6aixvcGFjaXR5OmN9KX1pZihtKWQub3Bwb3NpdGUmJihtWzBdPS1tWzBdKSxoPXRoaXMuZ2V0TWFya1BhdGgoaGEsUixtWzBdLG1bMV0qcyxnLGYpLFA/UC5hbmltYXRlKHtkOmgsb3BhY2l0eTpjfSk6dGhpcy5tYXJrPWYucGF0aChoKS5hdHRyKHtzdHJva2U6byxcInN0cm9rZS13aWR0aFwiOm1bMV0sb3BhY2l0eTpjfSkuYWRkKGQuYXhpc0dyb3VwKTtpZihpJiYhaXNOYU4oaGEpKWkueHk9Uj10aGlzLmdldExhYmVsUG9zaXRpb24oaGEsUixpLGcsayxuLGEsdSksdGhpcy5pc0ZpcnN0JiYhdGhpcy5pc0xhc3QmJiFxKGUuc2hvd0ZpcnN0TGFiZWwsMSl8fHRoaXMuaXNMYXN0JiYhdGhpcy5pc0ZpcnN0JiYhcShlLnNob3dMYXN0TGFiZWwsMSk/dz0hMTpnJiYhZC5pc1JhZGlhbCYmXG4hay5zdGVwJiYhay5yb3RhdGlvbiYmIWImJmMhPT0wJiZ0aGlzLmhhbmRsZU92ZXJmbG93KFIpLHUmJmEldSYmKHc9ITEpLHcmJiFpc05hTihSLnkpPyhSLm9wYWNpdHk9YyxpW3RoaXMuaXNOZXc/XCJhdHRyXCI6XCJhbmltYXRlXCJdKFIpLHRoaXMuaXNOZXc9ITEpOmkuYXR0cihcInlcIiwtOTk5OSl9LGRlc3Ryb3k6ZnVuY3Rpb24oKXtQYSh0aGlzLHRoaXMuYXhpcyl9fTt6LlBsb3RMaW5lT3JCYW5kPWZ1bmN0aW9uKGEsYil7dGhpcy5heGlzPWE7aWYoYil0aGlzLm9wdGlvbnM9Yix0aGlzLmlkPWIuaWR9O3ouUGxvdExpbmVPckJhbmQucHJvdG90eXBlPXtyZW5kZXI6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5heGlzLGM9Yi5ob3JpeixkPWEub3B0aW9ucyxlPWQubGFiZWwsZj1hLmxhYmVsLGc9ZC53aWR0aCxoPWQudG8saT1kLmZyb20saj1zKGkpJiZzKGgpLGs9ZC52YWx1ZSxsPWQuZGFzaFN0eWxlLG09YS5zdmdFbGVtLG89W10scCxyPWQuY29sb3IsQT1xKGQuekluZGV4LDApLG49XG5kLmV2ZW50cyx1PXt9LHc9Yi5jaGFydC5yZW5kZXJlcixvPWIubG9nMmxpbjtiLmlzTG9nJiYoaT1vKGkpLGg9byhoKSxrPW8oaykpO2lmKGcpe2lmKG89Yi5nZXRQbG90TGluZVBhdGgoayxnKSx1PXtzdHJva2U6cixcInN0cm9rZS13aWR0aFwiOmd9LGwpdS5kYXNoc3R5bGU9bH1lbHNlIGlmKGope289Yi5nZXRQbG90QmFuZFBhdGgoaSxoLGQpO2lmKHIpdS5maWxsPXI7aWYoZC5ib3JkZXJXaWR0aCl1LnN0cm9rZT1kLmJvcmRlckNvbG9yLHVbXCJzdHJva2Utd2lkdGhcIl09ZC5ib3JkZXJXaWR0aH1lbHNlIHJldHVybjt1LnpJbmRleD1BO2lmKG0paWYobyltLnNob3coKSxtLmFuaW1hdGUoe2Q6b30pO2Vsc2V7aWYobS5oaWRlKCksZilhLmxhYmVsPWY9Zi5kZXN0cm95KCl9ZWxzZSBpZihvJiZvLmxlbmd0aCYmKGEuc3ZnRWxlbT1tPXcucGF0aChvKS5hdHRyKHUpLmFkZCgpLG4pKWZvcihwIGluIGQ9ZnVuY3Rpb24oYil7bS5vbihiLGZ1bmN0aW9uKGMpe25bYl0uYXBwbHkoYSxbY10pfSl9LFxubilkKHApO2UmJnMoZS50ZXh0KSYmbyYmby5sZW5ndGgmJmIud2lkdGg+MCYmYi5oZWlnaHQ+MCYmIW8uZmxhdD8oZT1DKHthbGlnbjpjJiZqJiZcImNlbnRlclwiLHg6Yz8haiYmNDoxMCx2ZXJ0aWNhbEFsaWduOiFjJiZqJiZcIm1pZGRsZVwiLHk6Yz9qPzE2OjEwOmo/NjotNCxyb3RhdGlvbjpjJiYhaiYmOTB9LGUpLHRoaXMucmVuZGVyTGFiZWwoZSxvLGosQSkpOmYmJmYuaGlkZSgpO3JldHVybiBhfSxyZW5kZXJMYWJlbDpmdW5jdGlvbihhLGIsYyxkKXt2YXIgZT10aGlzLmxhYmVsLGY9dGhpcy5heGlzLmNoYXJ0LnJlbmRlcmVyO2lmKCFlKWU9e2FsaWduOmEudGV4dEFsaWdufHxhLmFsaWduLHJvdGF0aW9uOmEucm90YXRpb259LGUuekluZGV4PWQsdGhpcy5sYWJlbD1lPWYudGV4dChhLnRleHQsMCwwLGEudXNlSFRNTCkuYXR0cihlKS5jc3MoYS5zdHlsZSkuYWRkKCk7ZD1bYlsxXSxiWzRdLGM/Yls2XTpiWzFdXTtiPVtiWzJdLGJbNV0sYz9iWzddOmJbMl1dO2M9T2EoZCk7Zj1PYShiKTtcbmUuYWxpZ24oYSwhMSx7eDpjLHk6Zix3aWR0aDpFYShkKS1jLGhlaWdodDpFYShiKS1mfSk7ZS5zaG93KCl9LGRlc3Ryb3k6ZnVuY3Rpb24oKXtBYSh0aGlzLmF4aXMucGxvdExpbmVzQW5kQmFuZHMsdGhpcyk7ZGVsZXRlIHRoaXMuYXhpcztQYSh0aGlzKX19O3ZhciBJPXouQXhpcz1mdW5jdGlvbigpe3RoaXMuaW5pdC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9O0kucHJvdG90eXBlPXtkZWZhdWx0T3B0aW9uczp7ZGF0ZVRpbWVMYWJlbEZvcm1hdHM6e21pbGxpc2Vjb25kOlwiJUg6JU06JVMuJUxcIixzZWNvbmQ6XCIlSDolTTolU1wiLG1pbnV0ZTpcIiVIOiVNXCIsaG91cjpcIiVIOiVNXCIsZGF5OlwiJWUuICViXCIsd2VlazpcIiVlLiAlYlwiLG1vbnRoOlwiJWIgJyV5XCIseWVhcjpcIiVZXCJ9LGVuZE9uVGljazohMSxncmlkTGluZUNvbG9yOlwiI0Q4RDhEOFwiLGxhYmVsczp7ZW5hYmxlZDohMCxzdHlsZTp7Y29sb3I6XCIjNjA2MDYwXCIsY3Vyc29yOlwiZGVmYXVsdFwiLGZvbnRTaXplOlwiMTFweFwifSx4OjB9LGxpbmVDb2xvcjpcIiNDMEQwRTBcIixcbmxpbmVXaWR0aDoxLG1pblBhZGRpbmc6MC4wMSxtYXhQYWRkaW5nOjAuMDEsbWlub3JHcmlkTGluZUNvbG9yOlwiI0UwRTBFMFwiLG1pbm9yR3JpZExpbmVXaWR0aDoxLG1pbm9yVGlja0NvbG9yOlwiI0EwQTBBMFwiLG1pbm9yVGlja0xlbmd0aDoyLG1pbm9yVGlja1Bvc2l0aW9uOlwib3V0c2lkZVwiLHN0YXJ0T2ZXZWVrOjEsc3RhcnRPblRpY2s6ITEsdGlja0NvbG9yOlwiI0MwRDBFMFwiLHRpY2tMZW5ndGg6MTAsdGlja21hcmtQbGFjZW1lbnQ6XCJiZXR3ZWVuXCIsdGlja1BpeGVsSW50ZXJ2YWw6MTAwLHRpY2tQb3NpdGlvbjpcIm91dHNpZGVcIix0aXRsZTp7YWxpZ246XCJtaWRkbGVcIixzdHlsZTp7Y29sb3I6XCIjNzA3MDcwXCJ9fSx0eXBlOlwibGluZWFyXCJ9LGRlZmF1bHRZQXhpc09wdGlvbnM6e2VuZE9uVGljazohMCxncmlkTGluZVdpZHRoOjEsdGlja1BpeGVsSW50ZXJ2YWw6NzIsc2hvd0xhc3RMYWJlbDohMCxsYWJlbHM6e3g6LTh9LGxpbmVXaWR0aDowLG1heFBhZGRpbmc6MC4wNSxtaW5QYWRkaW5nOjAuMDUsXG5zdGFydE9uVGljazohMCx0aXRsZTp7cm90YXRpb246MjcwLHRleHQ6XCJWYWx1ZXNcIn0sc3RhY2tMYWJlbHM6e2VuYWJsZWQ6ITEsZm9ybWF0dGVyOmZ1bmN0aW9uKCl7cmV0dXJuIHoubnVtYmVyRm9ybWF0KHRoaXMudG90YWwsLTEpfSxzdHlsZTpDKFcubGluZS5kYXRhTGFiZWxzLnN0eWxlLHtjb2xvcjpcIiMwMDAwMDBcIn0pfX0sZGVmYXVsdExlZnRBeGlzT3B0aW9uczp7bGFiZWxzOnt4Oi0xNX0sdGl0bGU6e3JvdGF0aW9uOjI3MH19LGRlZmF1bHRSaWdodEF4aXNPcHRpb25zOntsYWJlbHM6e3g6MTV9LHRpdGxlOntyb3RhdGlvbjo5MH19LGRlZmF1bHRCb3R0b21BeGlzT3B0aW9uczp7bGFiZWxzOnthdXRvUm90YXRpb246Wy00NV0seDowfSx0aXRsZTp7cm90YXRpb246MH19LGRlZmF1bHRUb3BBeGlzT3B0aW9uczp7bGFiZWxzOnthdXRvUm90YXRpb246Wy00NV0seDowfSx0aXRsZTp7cm90YXRpb246MH19LGluaXQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz1iLmlzWDt0aGlzLmNoYXJ0PVxuYTt0aGlzLmhvcml6PWEuaW52ZXJ0ZWQ/IWM6Yzt0aGlzLmNvbGw9KHRoaXMuaXNYQXhpcz1jKT9cInhBeGlzXCI6XCJ5QXhpc1wiO3RoaXMub3Bwb3NpdGU9Yi5vcHBvc2l0ZTt0aGlzLnNpZGU9Yi5zaWRlfHwodGhpcy5ob3Jpej90aGlzLm9wcG9zaXRlPzA6Mjp0aGlzLm9wcG9zaXRlPzE6Myk7dGhpcy5zZXRPcHRpb25zKGIpO3ZhciBkPXRoaXMub3B0aW9ucyxlPWQudHlwZTt0aGlzLmxhYmVsRm9ybWF0dGVyPWQubGFiZWxzLmZvcm1hdHRlcnx8dGhpcy5kZWZhdWx0TGFiZWxGb3JtYXR0ZXI7dGhpcy51c2VyT3B0aW9ucz1iO3RoaXMubWluUGl4ZWxQYWRkaW5nPTA7dGhpcy5yZXZlcnNlZD1kLnJldmVyc2VkO3RoaXMudmlzaWJsZT1kLnZpc2libGUhPT0hMTt0aGlzLnpvb21FbmFibGVkPWQuem9vbUVuYWJsZWQhPT0hMTt0aGlzLmNhdGVnb3JpZXM9ZC5jYXRlZ29yaWVzfHxlPT09XCJjYXRlZ29yeVwiO3RoaXMubmFtZXM9dGhpcy5uYW1lc3x8W107dGhpcy5pc0xvZz1lPT09XCJsb2dhcml0aG1pY1wiO1xudGhpcy5pc0RhdGV0aW1lQXhpcz1lPT09XCJkYXRldGltZVwiO3RoaXMuaXNMaW5rZWQ9cyhkLmxpbmtlZFRvKTt0aGlzLnRpY2tzPXt9O3RoaXMubGFiZWxFZGdlPVtdO3RoaXMubWlub3JUaWNrcz17fTt0aGlzLnBsb3RMaW5lc0FuZEJhbmRzPVtdO3RoaXMuYWx0ZXJuYXRlQmFuZHM9e307dGhpcy5sZW49MDt0aGlzLm1pblJhbmdlPXRoaXMudXNlck1pblJhbmdlPWQubWluUmFuZ2V8fGQubWF4Wm9vbTt0aGlzLnJhbmdlPWQucmFuZ2U7dGhpcy5vZmZzZXQ9ZC5vZmZzZXR8fDA7dGhpcy5zdGFja3M9e307dGhpcy5vbGRTdGFja3M9e307dGhpcy5zdGFja3NUb3VjaGVkPTA7dGhpcy5taW49dGhpcy5tYXg9bnVsbDt0aGlzLmNyb3NzaGFpcj1xKGQuY3Jvc3NoYWlyLHZhKGEub3B0aW9ucy50b29sdGlwLmNyb3NzaGFpcnMpW2M/MDoxXSwhMSk7dmFyIGYsZD10aGlzLm9wdGlvbnMuZXZlbnRzO3NhKHRoaXMsYS5heGVzKT09PS0xJiYoYyYmIXRoaXMuaXNDb2xvckF4aXM/YS5heGVzLnNwbGljZShhLnhBeGlzLmxlbmd0aCxcbjAsdGhpcyk6YS5heGVzLnB1c2godGhpcyksYVt0aGlzLmNvbGxdLnB1c2godGhpcykpO3RoaXMuc2VyaWVzPXRoaXMuc2VyaWVzfHxbXTtpZihhLmludmVydGVkJiZjJiZ0aGlzLnJldmVyc2VkPT09dCl0aGlzLnJldmVyc2VkPSEwO3RoaXMucmVtb3ZlUGxvdExpbmU9dGhpcy5yZW1vdmVQbG90QmFuZD10aGlzLnJlbW92ZVBsb3RCYW5kT3JMaW5lO2ZvcihmIGluIGQpRCh0aGlzLGYsZFtmXSk7aWYodGhpcy5pc0xvZyl0aGlzLnZhbDJsaW49dGhpcy5sb2cybGluLHRoaXMubGluMnZhbD10aGlzLmxpbjJsb2d9LHNldE9wdGlvbnM6ZnVuY3Rpb24oYSl7dGhpcy5vcHRpb25zPUModGhpcy5kZWZhdWx0T3B0aW9ucyx0aGlzLmlzWEF4aXM/e306dGhpcy5kZWZhdWx0WUF4aXNPcHRpb25zLFt0aGlzLmRlZmF1bHRUb3BBeGlzT3B0aW9ucyx0aGlzLmRlZmF1bHRSaWdodEF4aXNPcHRpb25zLHRoaXMuZGVmYXVsdEJvdHRvbUF4aXNPcHRpb25zLHRoaXMuZGVmYXVsdExlZnRBeGlzT3B0aW9uc11bdGhpcy5zaWRlXSxcbkMoTlt0aGlzLmNvbGxdLGEpKX0sZGVmYXVsdExhYmVsRm9ybWF0dGVyOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5heGlzLGI9dGhpcy52YWx1ZSxjPWEuY2F0ZWdvcmllcyxkPXRoaXMuZGF0ZVRpbWVMYWJlbEZvcm1hdCxlPU4ubGFuZy5udW1lcmljU3ltYm9scyxmPWUmJmUubGVuZ3RoLGcsaD1hLm9wdGlvbnMubGFiZWxzLmZvcm1hdCxhPWEuaXNMb2c/YjphLnRpY2tJbnRlcnZhbDtpZihoKWc9TGEoaCx0aGlzKTtlbHNlIGlmKGMpZz1iO2Vsc2UgaWYoZClnPW1hKGQsYik7ZWxzZSBpZihmJiZhPj0xRTMpZm9yKDtmLS0mJmc9PT10OyljPU1hdGgucG93KDFFMyxmKzEpLGE+PWMmJmIqMTAlYz09PTAmJmVbZl0hPT1udWxsJiYoZz16Lm51bWJlckZvcm1hdChiL2MsLTEpK2VbZl0pO2c9PT10JiYoZz1TKGIpPj0xRTQ/ei5udW1iZXJGb3JtYXQoYiwtMSk6ei5udW1iZXJGb3JtYXQoYiwtMSx0LFwiXCIpKTtyZXR1cm4gZ30sZ2V0U2VyaWVzRXh0cmVtZXM6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLFxuYj1hLmNoYXJ0O2EuaGFzVmlzaWJsZVNlcmllcz0hMTthLmRhdGFNaW49YS5kYXRhTWF4PWEudGhyZXNob2xkPW51bGw7YS5zb2Z0VGhyZXNob2xkPSFhLmlzWEF4aXM7YS5idWlsZFN0YWNrcyYmYS5idWlsZFN0YWNrcygpO24oYS5zZXJpZXMsZnVuY3Rpb24oYyl7aWYoYy52aXNpYmxlfHwhYi5vcHRpb25zLmNoYXJ0Lmlnbm9yZUhpZGRlblNlcmllcyl7dmFyIGQ9Yy5vcHRpb25zLGU9ZC50aHJlc2hvbGQsZjthLmhhc1Zpc2libGVTZXJpZXM9ITA7YS5pc0xvZyYmZTw9MCYmKGU9bnVsbCk7aWYoYS5pc1hBeGlzKXtpZihkPWMueERhdGEsZC5sZW5ndGgpYS5kYXRhTWluPUUocShhLmRhdGFNaW4sZFswXSksT2EoZCkpLGEuZGF0YU1heD12KHEoYS5kYXRhTWF4LGRbMF0pLEVhKGQpKX1lbHNle2MuZ2V0RXh0cmVtZXMoKTtmPWMuZGF0YU1heDtjPWMuZGF0YU1pbjtpZihzKGMpJiZzKGYpKWEuZGF0YU1pbj1FKHEoYS5kYXRhTWluLGMpLGMpLGEuZGF0YU1heD12KHEoYS5kYXRhTWF4LFxuZiksZik7aWYocyhlKSlhLnRocmVzaG9sZD1lO2lmKCFkLnNvZnRUaHJlc2hvbGR8fGEuaXNMb2cpYS5zb2Z0VGhyZXNob2xkPSExfX19KX0sdHJhbnNsYXRlOmZ1bmN0aW9uKGEsYixjLGQsZSxmKXt2YXIgZz10aGlzLmxpbmtlZFBhcmVudHx8dGhpcyxoPTEsaT0wLGo9ZD9nLm9sZFRyYW5zQTpnLnRyYW5zQSxkPWQ/Zy5vbGRNaW46Zy5taW4saz1nLm1pblBpeGVsUGFkZGluZyxlPShnLmlzT3JkaW5hbHx8Zy5pc0Jyb2tlbnx8Zy5pc0xvZyYmZSkmJmcubGluMnZhbDtpZighailqPWcudHJhbnNBO2lmKGMpaCo9LTEsaT1nLmxlbjtnLnJldmVyc2VkJiYoaCo9LTEsaS09aCooZy5zZWN0b3J8fGcubGVuKSk7Yj8oYT1hKmgraSxhLT1rLGE9YS9qK2QsZSYmKGE9Zy5saW4ydmFsKGEpKSk6KGUmJihhPWcudmFsMmxpbihhKSksZj09PVwiYmV0d2VlblwiJiYoZj0wLjUpLGE9aCooYS1kKSpqK2kraCprKyh1YShmKT9qKmYqZy5wb2ludFJhbmdlOjApKTtyZXR1cm4gYX0sdG9QaXhlbHM6ZnVuY3Rpb24oYSxcbmIpe3JldHVybiB0aGlzLnRyYW5zbGF0ZShhLCExLCF0aGlzLmhvcml6LG51bGwsITApKyhiPzA6dGhpcy5wb3MpfSx0b1ZhbHVlOmZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMudHJhbnNsYXRlKGEtKGI/MDp0aGlzLnBvcyksITAsIXRoaXMuaG9yaXosbnVsbCwhMCl9LGdldFBsb3RMaW5lUGF0aDpmdW5jdGlvbihhLGIsYyxkLGUpe3ZhciBmPXRoaXMuY2hhcnQsZz10aGlzLmxlZnQsaD10aGlzLnRvcCxpLGosaz1jJiZmLm9sZENoYXJ0SGVpZ2h0fHxmLmNoYXJ0SGVpZ2h0LGw9YyYmZi5vbGRDaGFydFdpZHRofHxmLmNoYXJ0V2lkdGgsbTtpPXRoaXMudHJhbnNCO3ZhciBvPWZ1bmN0aW9uKGEsYixjKXtpZihhPGJ8fGE+YylkP2E9RSh2KGIsYSksYyk6bT0hMDtyZXR1cm4gYX0sZT1xKGUsdGhpcy50cmFuc2xhdGUoYSxudWxsLG51bGwsYykpLGE9Yz15KGUraSk7aT1qPXkoay1lLWkpO2lzTmFOKGUpP209ITA6dGhpcy5ob3Jpej8oaT1oLGo9ay10aGlzLmJvdHRvbSxhPWM9byhhLFxuZyxnK3RoaXMud2lkdGgpKTooYT1nLGM9bC10aGlzLnJpZ2h0LGk9aj1vKGksaCxoK3RoaXMuaGVpZ2h0KSk7cmV0dXJuIG0mJiFkP251bGw6Zi5yZW5kZXJlci5jcmlzcExpbmUoW1wiTVwiLGEsaSxcIkxcIixjLGpdLGJ8fDEpfSxnZXRMaW5lYXJUaWNrUG9zaXRpb25zOmZ1bmN0aW9uKGEsYixjKXt2YXIgZCxlPW5hKFYoYi9hKSphKSxmPW5hKEZhKGMvYSkqYSksZz1bXTtpZihiPT09YyYmdWEoYikpcmV0dXJuW2JdO2ZvcihiPWU7Yjw9Zjspe2cucHVzaChiKTtiPW5hKGIrYSk7aWYoYj09PWQpYnJlYWs7ZD1ifXJldHVybiBnfSxnZXRNaW5vclRpY2tQb3NpdGlvbnM6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9wdGlvbnMsYj10aGlzLnRpY2tQb3NpdGlvbnMsYz10aGlzLm1pbm9yVGlja0ludGVydmFsLGQ9W10sZSxmPXRoaXMucG9pbnRSYW5nZVBhZGRpbmd8fDA7ZT10aGlzLm1pbi1mO3ZhciBmPXRoaXMubWF4K2YsZz1mLWU7aWYoZyYmZy9jPHRoaXMubGVuLzMpaWYodGhpcy5pc0xvZyl7Zj1cbmIubGVuZ3RoO2ZvcihlPTE7ZTxmO2UrKylkPWQuY29uY2F0KHRoaXMuZ2V0TG9nVGlja1Bvc2l0aW9ucyhjLGJbZS0xXSxiW2VdLCEwKSl9ZWxzZSBpZih0aGlzLmlzRGF0ZXRpbWVBeGlzJiZhLm1pbm9yVGlja0ludGVydmFsPT09XCJhdXRvXCIpZD1kLmNvbmNhdCh0aGlzLmdldFRpbWVUaWNrcyh0aGlzLm5vcm1hbGl6ZVRpbWVUaWNrSW50ZXJ2YWwoYyksZSxmLGEuc3RhcnRPZldlZWspKTtlbHNlIGZvcihiPWUrKGJbMF0tZSklYztiPD1mO2IrPWMpZC5wdXNoKGIpO2QubGVuZ3RoIT09MCYmdGhpcy50cmltVGlja3MoZCxhLnN0YXJ0T25UaWNrLGEuZW5kT25UaWNrKTtyZXR1cm4gZH0sYWRqdXN0Rm9yTWluUmFuZ2U6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9wdGlvbnMsYj10aGlzLm1pbixjPXRoaXMubWF4LGQsZT10aGlzLmRhdGFNYXgtdGhpcy5kYXRhTWluPj10aGlzLm1pblJhbmdlLGYsZyxoLGksaixrO2lmKHRoaXMuaXNYQXhpcyYmdGhpcy5taW5SYW5nZT09PXQmJiF0aGlzLmlzTG9nKXMoYS5taW4pfHxcbnMoYS5tYXgpP3RoaXMubWluUmFuZ2U9bnVsbDoobih0aGlzLnNlcmllcyxmdW5jdGlvbihhKXtpPWEueERhdGE7Zm9yKGc9aj1hLnhJbmNyZW1lbnQ/MTppLmxlbmd0aC0xO2c+MDtnLS0paWYoaD1pW2ddLWlbZy0xXSxmPT09dHx8aDxmKWY9aH0pLHRoaXMubWluUmFuZ2U9RShmKjUsdGhpcy5kYXRhTWF4LXRoaXMuZGF0YU1pbikpO2lmKGMtYjx0aGlzLm1pblJhbmdlKXtrPXRoaXMubWluUmFuZ2U7ZD0oay1jK2IpLzI7ZD1bYi1kLHEoYS5taW4sYi1kKV07aWYoZSlkWzJdPXRoaXMuZGF0YU1pbjtiPUVhKGQpO2M9W2IrayxxKGEubWF4LGIrayldO2lmKGUpY1syXT10aGlzLmRhdGFNYXg7Yz1PYShjKTtjLWI8ayYmKGRbMF09Yy1rLGRbMV09cShhLm1pbixjLWspLGI9RWEoZCkpfXRoaXMubWluPWI7dGhpcy5tYXg9Y30sZ2V0Q2xvc2VzdDpmdW5jdGlvbigpe3ZhciBhO24odGhpcy5zZXJpZXMsZnVuY3Rpb24oYil7dmFyIGM9Yi5jbG9zZXN0UG9pbnRSYW5nZTshYi5ub1NoYXJlZFRvb2x0aXAmJlxucyhjKSYmKGE9cyhhKT9FKGEsYyk6Yyl9KTtyZXR1cm4gYX0sc2V0QXhpc1RyYW5zbGF0aW9uOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMsYz1iLm1heC1iLm1pbixkPWIuYXhpc1BvaW50UmFuZ2V8fDAsZSxmPTAsZz0wLGg9Yi5saW5rZWRQYXJlbnQsaT0hIWIuY2F0ZWdvcmllcyxqPWIudHJhbnNBLGs9Yi5pc1hBeGlzO2lmKGt8fGl8fGQpaWYoaD8oZj1oLm1pblBvaW50T2Zmc2V0LGc9aC5wb2ludFJhbmdlUGFkZGluZyk6KGU9Yi5nZXRDbG9zZXN0KCksbihiLnNlcmllcyxmdW5jdGlvbihhKXt2YXIgYz1pPzE6az9xKGEub3B0aW9ucy5wb2ludFJhbmdlLGUsMCk6Yi5heGlzUG9pbnRSYW5nZXx8MCxhPWEub3B0aW9ucy5wb2ludFBsYWNlbWVudDtkPXYoZCxjKTtiLnNpbmdsZXx8KGY9dihmLERhKGEpPzA6Yy8yKSxnPXYoZyxhPT09XCJvblwiPzA6YykpfSkpLGg9Yi5vcmRpbmFsU2xvcGUmJmU/Yi5vcmRpbmFsU2xvcGUvZToxLGIubWluUG9pbnRPZmZzZXQ9Zio9aCxiLnBvaW50UmFuZ2VQYWRkaW5nPVxuZyo9aCxiLnBvaW50UmFuZ2U9RShkLGMpLGspYi5jbG9zZXN0UG9pbnRSYW5nZT1lO2lmKGEpYi5vbGRUcmFuc0E9ajtiLnRyYW5zbGF0aW9uU2xvcGU9Yi50cmFuc0E9aj1iLmxlbi8oYytnfHwxKTtiLnRyYW5zQj1iLmhvcml6P2IubGVmdDpiLmJvdHRvbTtiLm1pblBpeGVsUGFkZGluZz1qKmZ9LG1pbkZyb21SYW5nZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLm1heC10aGlzLnJhbmdlfSxzZXRUaWNrSW50ZXJ2YWw6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcyxjPWIuY2hhcnQsZD1iLm9wdGlvbnMsZT1iLmlzTG9nLGY9Yi5sb2cybGluLGc9Yi5pc0RhdGV0aW1lQXhpcyxoPWIuaXNYQXhpcyxpPWIuaXNMaW5rZWQsaj1kLm1heFBhZGRpbmcsaz1kLm1pblBhZGRpbmcsbD1kLnRpY2tJbnRlcnZhbCxtPWQudGlja1BpeGVsSW50ZXJ2YWwsbz1iLmNhdGVnb3JpZXMscD1iLnRocmVzaG9sZCxyPWIuc29mdFRocmVzaG9sZCxBLFAsdSx3OyFnJiYhbyYmIWkmJnRoaXMuZ2V0VGlja0Ftb3VudCgpO1xudT1xKGIudXNlck1pbixkLm1pbik7dz1xKGIudXNlck1heCxkLm1heCk7aT8oYi5saW5rZWRQYXJlbnQ9Y1tiLmNvbGxdW2QubGlua2VkVG9dLGM9Yi5saW5rZWRQYXJlbnQuZ2V0RXh0cmVtZXMoKSxiLm1pbj1xKGMubWluLGMuZGF0YU1pbiksYi5tYXg9cShjLm1heCxjLmRhdGFNYXgpLGQudHlwZSE9PWIubGlua2VkUGFyZW50Lm9wdGlvbnMudHlwZSYmZ2EoMTEsMSkpOighciYmcyhwKSYmKGIuZGF0YU1pbj49cD8oQT1wLGs9MCk6Yi5kYXRhTWF4PD1wJiYoUD1wLGo9MCkpLGIubWluPXEodSxBLGIuZGF0YU1pbiksYi5tYXg9cSh3LFAsYi5kYXRhTWF4KSk7aWYoZSkhYSYmRShiLm1pbixxKGIuZGF0YU1pbixiLm1pbikpPD0wJiZnYSgxMCwxKSxiLm1pbj1uYShmKGIubWluKSwxNSksYi5tYXg9bmEoZihiLm1heCksMTUpO2lmKGIucmFuZ2UmJnMoYi5tYXgpKWIudXNlck1pbj1iLm1pbj11PXYoYi5taW4sYi5taW5Gcm9tUmFuZ2UoKSksYi51c2VyTWF4PXc9Yi5tYXgsYi5yYW5nZT1cbm51bGw7Yi5iZWZvcmVQYWRkaW5nJiZiLmJlZm9yZVBhZGRpbmcoKTtiLmFkanVzdEZvck1pblJhbmdlKCk7aWYoIW8mJiFiLmF4aXNQb2ludFJhbmdlJiYhYi51c2VQZXJjZW50YWdlJiYhaSYmcyhiLm1pbikmJnMoYi5tYXgpJiYoZj1iLm1heC1iLm1pbikpIXModSkmJmsmJihiLm1pbi09ZiprKSwhcyh3KSYmaiYmKGIubWF4Kz1mKmopO2lmKHVhKGQuZmxvb3IpKWIubWluPXYoYi5taW4sZC5mbG9vcik7aWYodWEoZC5jZWlsaW5nKSliLm1heD1FKGIubWF4LGQuY2VpbGluZyk7aWYociYmcyhiLmRhdGFNaW4pKWlmKHA9cHx8MCwhcyh1KSYmYi5taW48cCYmYi5kYXRhTWluPj1wKWIubWluPXA7ZWxzZSBpZighcyh3KSYmYi5tYXg+cCYmYi5kYXRhTWF4PD1wKWIubWF4PXA7Yi50aWNrSW50ZXJ2YWw9Yi5taW49PT1iLm1heHx8Yi5taW49PT12b2lkIDB8fGIubWF4PT09dm9pZCAwPzE6aSYmIWwmJm09PT1iLmxpbmtlZFBhcmVudC5vcHRpb25zLnRpY2tQaXhlbEludGVydmFsP2w9Yi5saW5rZWRQYXJlbnQudGlja0ludGVydmFsOlxucShsLHRoaXMudGlja0Ftb3VudD8oYi5tYXgtYi5taW4pL3YodGhpcy50aWNrQW1vdW50LTEsMSk6dm9pZCAwLG8/MTooYi5tYXgtYi5taW4pKm0vdihiLmxlbixtKSk7aCYmIWEmJm4oYi5zZXJpZXMsZnVuY3Rpb24oYSl7YS5wcm9jZXNzRGF0YShiLm1pbiE9PWIub2xkTWlufHxiLm1heCE9PWIub2xkTWF4KX0pO2Iuc2V0QXhpc1RyYW5zbGF0aW9uKCEwKTtiLmJlZm9yZVNldFRpY2tQb3NpdGlvbnMmJmIuYmVmb3JlU2V0VGlja1Bvc2l0aW9ucygpO2lmKGIucG9zdFByb2Nlc3NUaWNrSW50ZXJ2YWwpYi50aWNrSW50ZXJ2YWw9Yi5wb3N0UHJvY2Vzc1RpY2tJbnRlcnZhbChiLnRpY2tJbnRlcnZhbCk7aWYoYi5wb2ludFJhbmdlJiYhbCliLnRpY2tJbnRlcnZhbD12KGIucG9pbnRSYW5nZSxiLnRpY2tJbnRlcnZhbCk7YT1xKGQubWluVGlja0ludGVydmFsLGIuaXNEYXRldGltZUF4aXMmJmIuY2xvc2VzdFBvaW50UmFuZ2UpO2lmKCFsJiZiLnRpY2tJbnRlcnZhbDxhKWIudGlja0ludGVydmFsPVxuYTtpZighZyYmIWUmJiFsKWIudGlja0ludGVydmFsPUJiKGIudGlja0ludGVydmFsLG51bGwsQWIoYi50aWNrSW50ZXJ2YWwpLHEoZC5hbGxvd0RlY2ltYWxzLCEoYi50aWNrSW50ZXJ2YWw+MC41JiZiLnRpY2tJbnRlcnZhbDw1JiZiLm1heD4xRTMmJmIubWF4PDk5OTkpKSwhIXRoaXMudGlja0Ftb3VudCk7aWYoIXRoaXMudGlja0Ftb3VudCYmdGhpcy5sZW4pYi50aWNrSW50ZXJ2YWw9Yi51bnNxdWlzaCgpO3RoaXMuc2V0VGlja1Bvc2l0aW9ucygpfSxzZXRUaWNrUG9zaXRpb25zOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcHRpb25zLGIsYz1hLnRpY2tQb3NpdGlvbnMsZD1hLnRpY2tQb3NpdGlvbmVyLGU9YS5zdGFydE9uVGljayxmPWEuZW5kT25UaWNrLGc7dGhpcy50aWNrbWFya09mZnNldD10aGlzLmNhdGVnb3JpZXMmJmEudGlja21hcmtQbGFjZW1lbnQ9PT1cImJldHdlZW5cIiYmdGhpcy50aWNrSW50ZXJ2YWw9PT0xPzAuNTowO3RoaXMubWlub3JUaWNrSW50ZXJ2YWw9YS5taW5vclRpY2tJbnRlcnZhbD09PVxuXCJhdXRvXCImJnRoaXMudGlja0ludGVydmFsP3RoaXMudGlja0ludGVydmFsLzU6YS5taW5vclRpY2tJbnRlcnZhbDt0aGlzLnRpY2tQb3NpdGlvbnM9Yj1jJiZjLnNsaWNlKCk7aWYoIWImJihiPXRoaXMuaXNEYXRldGltZUF4aXM/dGhpcy5nZXRUaW1lVGlja3ModGhpcy5ub3JtYWxpemVUaW1lVGlja0ludGVydmFsKHRoaXMudGlja0ludGVydmFsLGEudW5pdHMpLHRoaXMubWluLHRoaXMubWF4LGEuc3RhcnRPZldlZWssdGhpcy5vcmRpbmFsUG9zaXRpb25zLHRoaXMuY2xvc2VzdFBvaW50UmFuZ2UsITApOnRoaXMuaXNMb2c/dGhpcy5nZXRMb2dUaWNrUG9zaXRpb25zKHRoaXMudGlja0ludGVydmFsLHRoaXMubWluLHRoaXMubWF4KTp0aGlzLmdldExpbmVhclRpY2tQb3NpdGlvbnModGhpcy50aWNrSW50ZXJ2YWwsdGhpcy5taW4sdGhpcy5tYXgpLGIubGVuZ3RoPnRoaXMubGVuJiYoYj1bYlswXSxiLnBvcCgpXSksdGhpcy50aWNrUG9zaXRpb25zPWIsZCYmKGQ9ZC5hcHBseSh0aGlzLFxuW3RoaXMubWluLHRoaXMubWF4XSkpKSl0aGlzLnRpY2tQb3NpdGlvbnM9Yj1kO2lmKCF0aGlzLmlzTGlua2VkKXRoaXMudHJpbVRpY2tzKGIsZSxmKSx0aGlzLm1pbj09PXRoaXMubWF4JiZzKHRoaXMubWluKSYmIXRoaXMudGlja0Ftb3VudCYmKGc9ITAsdGhpcy5taW4tPTAuNSx0aGlzLm1heCs9MC41KSx0aGlzLnNpbmdsZT1nLCFjJiYhZCYmdGhpcy5hZGp1c3RUaWNrQW1vdW50KCl9LHRyaW1UaWNrczpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9YVswXSxlPWFbYS5sZW5ndGgtMV0sZj10aGlzLm1pblBvaW50T2Zmc2V0fHwwO2lmKGIpdGhpcy5taW49ZDtlbHNlIGZvcig7dGhpcy5taW4tZj5hWzBdOylhLnNoaWZ0KCk7aWYoYyl0aGlzLm1heD1lO2Vsc2UgZm9yKDt0aGlzLm1heCtmPGFbYS5sZW5ndGgtMV07KWEucG9wKCk7YS5sZW5ndGg9PT0wJiZzKGQpJiZhLnB1c2goKGUrZCkvMil9LGFsaWduVG9PdGhlcnM6ZnVuY3Rpb24oKXt2YXIgYT17fSxiLGM9dGhpcy5vcHRpb25zO3RoaXMuY2hhcnQub3B0aW9ucy5jaGFydC5hbGlnblRpY2tzIT09XG4hMSYmYy5hbGlnblRpY2tzIT09ITEmJm4odGhpcy5jaGFydFt0aGlzLmNvbGxdLGZ1bmN0aW9uKGMpe3ZhciBlPWMub3B0aW9ucyxlPVtjLmhvcml6P2UubGVmdDplLnRvcCxlLndpZHRoLGUuaGVpZ2h0LGUucGFuZV0uam9pbihcIixcIik7Yy5zZXJpZXMubGVuZ3RoJiYoYVtlXT9iPSEwOmFbZV09MSl9KTtyZXR1cm4gYn0sZ2V0VGlja0Ftb3VudDpmdW5jdGlvbigpe3ZhciBhPXRoaXMub3B0aW9ucyxiPWEudGlja0Ftb3VudCxjPWEudGlja1BpeGVsSW50ZXJ2YWw7IXMoYS50aWNrSW50ZXJ2YWwpJiZ0aGlzLmxlbjxjJiYhdGhpcy5pc1JhZGlhbCYmIXRoaXMuaXNMb2cmJmEuc3RhcnRPblRpY2smJmEuZW5kT25UaWNrJiYoYj0yKTshYiYmdGhpcy5hbGlnblRvT3RoZXJzKCkmJihiPUZhKHRoaXMubGVuL2MpKzEpO2lmKGI8NCl0aGlzLmZpbmFsVGlja0FtdD1iLGI9NTt0aGlzLnRpY2tBbW91bnQ9Yn0sYWRqdXN0VGlja0Ftb3VudDpmdW5jdGlvbigpe3ZhciBhPXRoaXMudGlja0ludGVydmFsLFxuYj10aGlzLnRpY2tQb3NpdGlvbnMsYz10aGlzLnRpY2tBbW91bnQsZD10aGlzLmZpbmFsVGlja0FtdCxlPWImJmIubGVuZ3RoO2lmKGU8Yyl7Zm9yKDtiLmxlbmd0aDxjOyliLnB1c2gobmEoYltiLmxlbmd0aC0xXSthKSk7dGhpcy50cmFuc0EqPShlLTEpLyhjLTEpO3RoaXMubWF4PWJbYi5sZW5ndGgtMV19ZWxzZSBlPmMmJih0aGlzLnRpY2tJbnRlcnZhbCo9Mix0aGlzLnNldFRpY2tQb3NpdGlvbnMoKSk7aWYocyhkKSl7Zm9yKGE9Yz1iLmxlbmd0aDthLS07KShkPT09MyYmYSUyPT09MXx8ZDw9MiYmYT4wJiZhPGMtMSkmJmIuc3BsaWNlKGEsMSk7dGhpcy5maW5hbFRpY2tBbXQ9dH19LHNldFNjYWxlOmZ1bmN0aW9uKCl7dmFyIGEsYjt0aGlzLm9sZE1pbj10aGlzLm1pbjt0aGlzLm9sZE1heD10aGlzLm1heDt0aGlzLm9sZEF4aXNMZW5ndGg9dGhpcy5sZW47dGhpcy5zZXRBeGlzU2l6ZSgpO2I9dGhpcy5sZW4hPT10aGlzLm9sZEF4aXNMZW5ndGg7bih0aGlzLnNlcmllcyxmdW5jdGlvbihiKXtpZihiLmlzRGlydHlEYXRhfHxcbmIuaXNEaXJ0eXx8Yi54QXhpcy5pc0RpcnR5KWE9ITB9KTtpZihifHxhfHx0aGlzLmlzTGlua2VkfHx0aGlzLmZvcmNlUmVkcmF3fHx0aGlzLnVzZXJNaW4hPT10aGlzLm9sZFVzZXJNaW58fHRoaXMudXNlck1heCE9PXRoaXMub2xkVXNlck1heHx8dGhpcy5hbGlnblRvT3RoZXJzKCkpe2lmKHRoaXMucmVzZXRTdGFja3MmJnRoaXMucmVzZXRTdGFja3MoKSx0aGlzLmZvcmNlUmVkcmF3PSExLHRoaXMuZ2V0U2VyaWVzRXh0cmVtZXMoKSx0aGlzLnNldFRpY2tJbnRlcnZhbCgpLHRoaXMub2xkVXNlck1pbj10aGlzLnVzZXJNaW4sdGhpcy5vbGRVc2VyTWF4PXRoaXMudXNlck1heCwhdGhpcy5pc0RpcnR5KXRoaXMuaXNEaXJ0eT1ifHx0aGlzLm1pbiE9PXRoaXMub2xkTWlufHx0aGlzLm1heCE9PXRoaXMub2xkTWF4fWVsc2UgdGhpcy5jbGVhblN0YWNrcyYmdGhpcy5jbGVhblN0YWNrcygpfSxzZXRFeHRyZW1lczpmdW5jdGlvbihhLGIsYyxkLGUpe3ZhciBmPXRoaXMsZz1mLmNoYXJ0LFxuYz1xKGMsITApO24oZi5zZXJpZXMsZnVuY3Rpb24oYSl7ZGVsZXRlIGEua2RUcmVlfSk7ZT14KGUse21pbjphLG1heDpifSk7TShmLFwic2V0RXh0cmVtZXNcIixlLGZ1bmN0aW9uKCl7Zi51c2VyTWluPWE7Zi51c2VyTWF4PWI7Zi5ldmVudEFyZ3M9ZTtjJiZnLnJlZHJhdyhkKX0pfSx6b29tOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5kYXRhTWluLGQ9dGhpcy5kYXRhTWF4LGU9dGhpcy5vcHRpb25zLGY9RShjLHEoZS5taW4sYykpLGU9dihkLHEoZS5tYXgsZCkpO3RoaXMuYWxsb3dab29tT3V0c2lkZXx8KHMoYykmJmE8PWYmJihhPWYpLHMoZCkmJmI+PWUmJihiPWUpKTt0aGlzLmRpc3BsYXlCdG49YSE9PXR8fGIhPT10O3RoaXMuc2V0RXh0cmVtZXMoYSxiLCExLHQse3RyaWdnZXI6XCJ6b29tXCJ9KTtyZXR1cm4hMH0sc2V0QXhpc1NpemU6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmNoYXJ0LGI9dGhpcy5vcHRpb25zLGM9Yi5vZmZzZXRMZWZ0fHwwLGQ9dGhpcy5ob3JpeixlPXEoYi53aWR0aCxcbmEucGxvdFdpZHRoLWMrKGIub2Zmc2V0UmlnaHR8fDApKSxmPXEoYi5oZWlnaHQsYS5wbG90SGVpZ2h0KSxnPXEoYi50b3AsYS5wbG90VG9wKSxiPXEoYi5sZWZ0LGEucGxvdExlZnQrYyksYz0vJSQvO2MudGVzdChmKSYmKGY9TWF0aC5yb3VuZChwYXJzZUZsb2F0KGYpLzEwMCphLnBsb3RIZWlnaHQpKTtjLnRlc3QoZykmJihnPU1hdGgucm91bmQocGFyc2VGbG9hdChnKS8xMDAqYS5wbG90SGVpZ2h0K2EucGxvdFRvcCkpO3RoaXMubGVmdD1iO3RoaXMudG9wPWc7dGhpcy53aWR0aD1lO3RoaXMuaGVpZ2h0PWY7dGhpcy5ib3R0b209YS5jaGFydEhlaWdodC1mLWc7dGhpcy5yaWdodD1hLmNoYXJ0V2lkdGgtZS1iO3RoaXMubGVuPXYoZD9lOmYsMCk7dGhpcy5wb3M9ZD9iOmd9LGdldEV4dHJlbWVzOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5pc0xvZyxiPXRoaXMubGluMmxvZztyZXR1cm57bWluOmE/bmEoYih0aGlzLm1pbikpOnRoaXMubWluLG1heDphP25hKGIodGhpcy5tYXgpKTp0aGlzLm1heCxcbmRhdGFNaW46dGhpcy5kYXRhTWluLGRhdGFNYXg6dGhpcy5kYXRhTWF4LHVzZXJNaW46dGhpcy51c2VyTWluLHVzZXJNYXg6dGhpcy51c2VyTWF4fX0sZ2V0VGhyZXNob2xkOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuaXNMb2csYz10aGlzLmxpbjJsb2csZD1iP2ModGhpcy5taW4pOnRoaXMubWluLGI9Yj9jKHRoaXMubWF4KTp0aGlzLm1heDthPT09bnVsbD9hPWI8MD9iOmQ6ZD5hP2E9ZDpiPGEmJihhPWIpO3JldHVybiB0aGlzLnRyYW5zbGF0ZShhLDAsMSwwLDEpfSxhdXRvTGFiZWxBbGlnbjpmdW5jdGlvbihhKXthPShxKGEsMCktdGhpcy5zaWRlKjkwKzcyMCklMzYwO3JldHVybiBhPjE1JiZhPDE2NT9cInJpZ2h0XCI6YT4xOTUmJmE8MzQ1P1wibGVmdFwiOlwiY2VudGVyXCJ9LHRpY2tTaXplOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMub3B0aW9ucyxjPWJbYStcIkxlbmd0aFwiXSxkPXEoYlthK1wiV2lkdGhcIl0sYT09PVwidGlja1wiJiZ0aGlzLmlzWEF4aXM/MTowKTtpZihkJiZjKXJldHVybiBiW2ErXG5cIlBvc2l0aW9uXCJdPT09XCJpbnNpZGVcIiYmKGM9LWMpLFtjLGRdfSxsYWJlbE1ldHJpY3M6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jaGFydC5yZW5kZXJlci5mb250TWV0cmljcyh0aGlzLm9wdGlvbnMubGFiZWxzLnN0eWxlLmZvbnRTaXplLHRoaXMudGlja3NbMF0mJnRoaXMudGlja3NbMF0ubGFiZWwpfSx1bnNxdWlzaDpmdW5jdGlvbigpe3ZhciBhPXRoaXMub3B0aW9ucy5sYWJlbHMsYj10aGlzLmhvcml6LGM9dGhpcy50aWNrSW50ZXJ2YWwsZD1jLGU9dGhpcy5sZW4vKCgodGhpcy5jYXRlZ29yaWVzPzE6MCkrdGhpcy5tYXgtdGhpcy5taW4pL2MpLGYsZz1hLnJvdGF0aW9uLGg9dGhpcy5sYWJlbE1ldHJpY3MoKSxpLGo9TnVtYmVyLk1BWF9WQUxVRSxrLGw9ZnVuY3Rpb24oYSl7YS89ZXx8MTthPWE+MT9GYShhKToxO3JldHVybiBhKmN9O2I/KGs9IWEuc3RhZ2dlckxpbmVzJiYhYS5zdGVwJiYocyhnKT9bZ106ZTxxKGEuYXV0b1JvdGF0aW9uTGltaXQsODApJiZhLmF1dG9Sb3RhdGlvbikpJiZcbm4oayxmdW5jdGlvbihhKXt2YXIgYjtpZihhPT09Z3x8YSYmYT49LTkwJiZhPD05MClpPWwoUyhoLmgva2EocGEqYSkpKSxiPWkrUyhhLzM2MCksYjxqJiYoaj1iLGY9YSxkPWkpfSk6YS5zdGVwfHwoZD1sKGguaCkpO3RoaXMuYXV0b1JvdGF0aW9uPWs7dGhpcy5sYWJlbFJvdGF0aW9uPXEoZixnKTtyZXR1cm4gZH0sZ2V0U2xvdFdpZHRoOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5jaGFydCxiPXRoaXMuaG9yaXosYz10aGlzLm9wdGlvbnMubGFiZWxzLGQ9TWF0aC5tYXgodGhpcy50aWNrUG9zaXRpb25zLmxlbmd0aC0odGhpcy5jYXRlZ29yaWVzPzA6MSksMSksZT1hLm1hcmdpblszXTtyZXR1cm4gYiYmKGMuc3RlcHx8MCk8MiYmIWMucm90YXRpb24mJih0aGlzLnN0YWdnZXJMaW5lc3x8MSkqYS5wbG90V2lkdGgvZHx8IWImJihlJiZlLWEuc3BhY2luZ1szXXx8YS5jaGFydFdpZHRoKjAuMzMpfSxyZW5kZXJVbnNxdWlzaDpmdW5jdGlvbigpe3ZhciBhPXRoaXMuY2hhcnQsYj1hLnJlbmRlcmVyLFxuYz10aGlzLnRpY2tQb3NpdGlvbnMsZD10aGlzLnRpY2tzLGU9dGhpcy5vcHRpb25zLmxhYmVscyxmPXRoaXMuaG9yaXosZz10aGlzLmdldFNsb3RXaWR0aCgpLGg9digxLHkoZy0yKihlLnBhZGRpbmd8fDUpKSksaT17fSxqPXRoaXMubGFiZWxNZXRyaWNzKCksaz1lLnN0eWxlLnRleHRPdmVyZmxvdyxsLG09MCxvLHA7aWYoIURhKGUucm90YXRpb24pKWkucm90YXRpb249ZS5yb3RhdGlvbnx8MDtpZih0aGlzLmF1dG9Sb3RhdGlvbiluKGMsZnVuY3Rpb24oYSl7aWYoKGE9ZFthXSkmJmEubGFiZWxMZW5ndGg+bSltPWEubGFiZWxMZW5ndGh9KSxtPmgmJm0+ai5oP2kucm90YXRpb249dGhpcy5sYWJlbFJvdGF0aW9uOnRoaXMubGFiZWxSb3RhdGlvbj0wO2Vsc2UgaWYoZyYmKGw9e3dpZHRoOmgrXCJweFwifSwhaykpe2wudGV4dE92ZXJmbG93PVwiY2xpcFwiO2ZvcihvPWMubGVuZ3RoOyFmJiZvLS07KWlmKHA9Y1tvXSxoPWRbcF0ubGFiZWwpaWYoaC5zdHlsZXMudGV4dE92ZXJmbG93PT09XCJlbGxpcHNpc1wiP1xuaC5jc3Moe3RleHRPdmVyZmxvdzpcImNsaXBcIn0pOmRbcF0ubGFiZWxMZW5ndGg+ZyYmaC5jc3Moe3dpZHRoOmcrXCJweFwifSksaC5nZXRCQm94KCkuaGVpZ2h0PnRoaXMubGVuL2MubGVuZ3RoLShqLmgtai5mKSloLnNwZWNDc3M9e3RleHRPdmVyZmxvdzpcImVsbGlwc2lzXCJ9fWlmKGkucm90YXRpb24mJihsPXt3aWR0aDoobT5hLmNoYXJ0SGVpZ2h0KjAuNT9hLmNoYXJ0SGVpZ2h0KjAuMzM6YS5jaGFydEhlaWdodCkrXCJweFwifSwhaykpbC50ZXh0T3ZlcmZsb3c9XCJlbGxpcHNpc1wiO2lmKHRoaXMubGFiZWxBbGlnbj1lLmFsaWdufHx0aGlzLmF1dG9MYWJlbEFsaWduKHRoaXMubGFiZWxSb3RhdGlvbikpaS5hbGlnbj10aGlzLmxhYmVsQWxpZ247bihjLGZ1bmN0aW9uKGEpe3ZhciBiPShhPWRbYV0pJiZhLmxhYmVsO2lmKGIpYi5hdHRyKGkpLGwmJmIuY3NzKEMobCxiLnNwZWNDc3MpKSxkZWxldGUgYi5zcGVjQ3NzLGEucm90YXRpb249aS5yb3RhdGlvbn0pO3RoaXMudGlja1JvdENvcnI9Yi5yb3RDb3JyKGouYixcbnRoaXMubGFiZWxSb3RhdGlvbnx8MCx0aGlzLnNpZGUhPT0wKX0saGFzRGF0YTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmhhc1Zpc2libGVTZXJpZXN8fHModGhpcy5taW4pJiZzKHRoaXMubWF4KSYmISF0aGlzLnRpY2tQb3NpdGlvbnN9LGdldE9mZnNldDpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLmNoYXJ0LGM9Yi5yZW5kZXJlcixkPWEub3B0aW9ucyxlPWEudGlja1Bvc2l0aW9ucyxmPWEudGlja3MsZz1hLmhvcml6LGg9YS5zaWRlLGk9Yi5pbnZlcnRlZD9bMSwwLDMsMl1baF06aCxqLGssbD0wLG0sbz0wLHA9ZC50aXRsZSxyPWQubGFiZWxzLEE9MCxQPWEub3Bwb3NpdGUsdT1iLmF4aXNPZmZzZXQsYj1iLmNsaXBPZmZzZXQsdz1bLTEsMSwxLC0xXVtoXSxPLFI9YS5heGlzUGFyZW50LGhhPXRoaXMudGlja1NpemUoXCJ0aWNrXCIpO2o9YS5oYXNEYXRhKCk7YS5zaG93QXhpcz1rPWp8fHEoZC5zaG93RW1wdHksITApO2Euc3RhZ2dlckxpbmVzPWEuaG9yaXomJnIuc3RhZ2dlckxpbmVzO1xuaWYoIWEuYXhpc0dyb3VwKWEuZ3JpZEdyb3VwPWMuZyhcImdyaWRcIikuYXR0cih7ekluZGV4OmQuZ3JpZFpJbmRleHx8MX0pLmFkZChSKSxhLmF4aXNHcm91cD1jLmcoXCJheGlzXCIpLmF0dHIoe3pJbmRleDpkLnpJbmRleHx8Mn0pLmFkZChSKSxhLmxhYmVsR3JvdXA9Yy5nKFwiYXhpcy1sYWJlbHNcIikuYXR0cih7ekluZGV4OnIuekluZGV4fHw3fSkuYWRkQ2xhc3MoXCJoaWdoY2hhcnRzLVwiK2EuY29sbC50b0xvd2VyQ2FzZSgpK1wiLWxhYmVsc1wiKS5hZGQoUik7aWYoanx8YS5pc0xpbmtlZCl7aWYobihlLGZ1bmN0aW9uKGIpe2ZbYl0/ZltiXS5hZGRMYWJlbCgpOmZbYl09bmV3IGNiKGEsYil9KSxhLnJlbmRlclVuc3F1aXNoKCksci5yZXNlcnZlU3BhY2UhPT0hMSYmKGg9PT0wfHxoPT09Mnx8ezE6XCJsZWZ0XCIsMzpcInJpZ2h0XCJ9W2hdPT09YS5sYWJlbEFsaWdufHxhLmxhYmVsQWxpZ249PT1cImNlbnRlclwiKSYmbihlLGZ1bmN0aW9uKGEpe0E9dihmW2FdLmdldExhYmVsU2l6ZSgpLEEpfSksYS5zdGFnZ2VyTGluZXMpQSo9XG5hLnN0YWdnZXJMaW5lcyxhLmxhYmVsT2Zmc2V0PUEqKGEub3Bwb3NpdGU/LTE6MSl9ZWxzZSBmb3IoTyBpbiBmKWZbT10uZGVzdHJveSgpLGRlbGV0ZSBmW09dO2lmKHAmJnAudGV4dCYmcC5lbmFibGVkIT09ITEpe2lmKCFhLmF4aXNUaXRsZSlhLmF4aXNUaXRsZT1jLnRleHQocC50ZXh0LDAsMCxwLnVzZUhUTUwpLmF0dHIoe3pJbmRleDo3LHJvdGF0aW9uOnAucm90YXRpb258fDAsYWxpZ246cC50ZXh0QWxpZ258fHtsb3c6UD9cInJpZ2h0XCI6XCJsZWZ0XCIsbWlkZGxlOlwiY2VudGVyXCIsaGlnaDpQP1wibGVmdFwiOlwicmlnaHRcIn1bcC5hbGlnbl19KS5hZGRDbGFzcyhcImhpZ2hjaGFydHMtXCIrdGhpcy5jb2xsLnRvTG93ZXJDYXNlKCkrXCItdGl0bGVcIikuY3NzKHAuc3R5bGUpLmFkZChhLmF4aXNHcm91cCksYS5heGlzVGl0bGUuaXNOZXc9ITA7aWYoaylsPWEuYXhpc1RpdGxlLmdldEJCb3goKVtnP1wiaGVpZ2h0XCI6XCJ3aWR0aFwiXSxtPXAub2Zmc2V0LG89cyhtKT8wOnEocC5tYXJnaW4sZz81OjEwKTtcbmEuYXhpc1RpdGxlW2s/XCJzaG93XCI6XCJoaWRlXCJdKCEwKX1hLm9mZnNldD13KnEoZC5vZmZzZXQsdVtoXSk7YS50aWNrUm90Q29ycj1hLnRpY2tSb3RDb3JyfHx7eDowLHk6MH07Yz1oPT09MD8tYS5sYWJlbE1ldHJpY3MoKS5oOmg9PT0yP2EudGlja1JvdENvcnIueTowO289TWF0aC5hYnMoQSkrbztBJiYoby09YyxvKz13KihnP3Eoci55LGEudGlja1JvdENvcnIueSt3KjgpOnIueCkpO2EuYXhpc1RpdGxlTWFyZ2luPXEobSxvKTt1W2hdPXYodVtoXSxhLmF4aXNUaXRsZU1hcmdpbitsK3cqYS5vZmZzZXQsbyxqJiZlLmxlbmd0aCYmaGE/aGFbMF06MCk7ZD1kLm9mZnNldD8wOlYoZC5saW5lV2lkdGgvMikqMjtiW2ldPXYoYltpXSxkKX0sZ2V0TGluZVBhdGg6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jaGFydCxjPXRoaXMub3Bwb3NpdGUsZD10aGlzLm9mZnNldCxlPXRoaXMuaG9yaXosZj10aGlzLmxlZnQrKGM/dGhpcy53aWR0aDowKStkLGQ9Yi5jaGFydEhlaWdodC10aGlzLmJvdHRvbS1cbihjP3RoaXMuaGVpZ2h0OjApK2Q7YyYmKGEqPS0xKTtyZXR1cm4gYi5yZW5kZXJlci5jcmlzcExpbmUoW1wiTVwiLGU/dGhpcy5sZWZ0OmYsZT9kOnRoaXMudG9wLFwiTFwiLGU/Yi5jaGFydFdpZHRoLXRoaXMucmlnaHQ6ZixlP2Q6Yi5jaGFydEhlaWdodC10aGlzLmJvdHRvbV0sYSl9LGdldFRpdGxlUG9zaXRpb246ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmhvcml6LGI9dGhpcy5sZWZ0LGM9dGhpcy50b3AsZD10aGlzLmxlbixlPXRoaXMub3B0aW9ucy50aXRsZSxmPWE/YjpjLGc9dGhpcy5vcHBvc2l0ZSxoPXRoaXMub2Zmc2V0LGk9ZS54fHwwLGo9ZS55fHwwLGs9RyhlLnN0eWxlLmZvbnRTaXplfHwxMiksZD17bG93OmYrKGE/MDpkKSxtaWRkbGU6ZitkLzIsaGlnaDpmKyhhP2Q6MCl9W2UuYWxpZ25dLGI9KGE/Yyt0aGlzLmhlaWdodDpiKSsoYT8xOi0xKSooZz8tMToxKSp0aGlzLmF4aXNUaXRsZU1hcmdpbisodGhpcy5zaWRlPT09Mj9rOjApO3JldHVybnt4OmE/ZCtpOmIrKGc/dGhpcy53aWR0aDpcbjApK2graSx5OmE/YitqLShnP3RoaXMuaGVpZ2h0OjApK2g6ZCtqfX0scmVuZGVyOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEuY2hhcnQsYz1iLnJlbmRlcmVyLGQ9YS5vcHRpb25zLGU9YS5pc0xvZyxmPWEubGluMmxvZyxnPWEuaXNMaW5rZWQsaD1hLnRpY2tQb3NpdGlvbnMsaT1hLmF4aXNUaXRsZSxqPWEudGlja3Msaz1hLm1pbm9yVGlja3MsbD1hLmFsdGVybmF0ZUJhbmRzLG09ZC5zdGFja0xhYmVscyxvPWQuYWx0ZXJuYXRlR3JpZENvbG9yLHA9YS50aWNrbWFya09mZnNldCxyPWQubGluZVdpZHRoLEEscT1iLmhhc1JlbmRlcmVkJiZzKGEub2xkTWluKSYmIWlzTmFOKGEub2xkTWluKSx1PWEuc2hvd0F4aXMsdz1oYihjLmdsb2JhbEFuaW1hdGlvbiksTyxSO2EubGFiZWxFZGdlLmxlbmd0aD0wO2Eub3ZlcmxhcD0hMTtuKFtqLGssbF0sZnVuY3Rpb24oYSl7Zm9yKHZhciBiIGluIGEpYVtiXS5pc0FjdGl2ZT0hMX0pO2lmKGEuaGFzRGF0YSgpfHxnKXthLm1pbm9yVGlja0ludGVydmFsJiZcbiFhLmNhdGVnb3JpZXMmJm4oYS5nZXRNaW5vclRpY2tQb3NpdGlvbnMoKSxmdW5jdGlvbihiKXtrW2JdfHwoa1tiXT1uZXcgY2IoYSxiLFwibWlub3JcIikpO3EmJmtbYl0uaXNOZXcmJmtbYl0ucmVuZGVyKG51bGwsITApO2tbYl0ucmVuZGVyKG51bGwsITEsMSl9KTtpZihoLmxlbmd0aCYmKG4oaCxmdW5jdGlvbihiLGMpe2lmKCFnfHxiPj1hLm1pbiYmYjw9YS5tYXgpaltiXXx8KGpbYl09bmV3IGNiKGEsYikpLHEmJmpbYl0uaXNOZXcmJmpbYl0ucmVuZGVyKGMsITAsMC4xKSxqW2JdLnJlbmRlcihjKX0pLHAmJihhLm1pbj09PTB8fGEuc2luZ2xlKSkpalstMV18fChqWy0xXT1uZXcgY2IoYSwtMSxudWxsLCEwKSksalstMV0ucmVuZGVyKC0xKTtvJiZuKGgsZnVuY3Rpb24oYyxkKXtSPWhbZCsxXSE9PXQ/aFtkKzFdK3A6YS5tYXgtcDtpZihkJTI9PT0wJiZjPGEubWF4JiZSPD1hLm1heCsoYi5wb2xhcj8tcDpwKSlsW2NdfHwobFtjXT1uZXcgei5QbG90TGluZU9yQmFuZChhKSksTz1jK1xucCxsW2NdLm9wdGlvbnM9e2Zyb206ZT9mKE8pOk8sdG86ZT9mKFIpOlIsY29sb3I6b30sbFtjXS5yZW5kZXIoKSxsW2NdLmlzQWN0aXZlPSEwfSk7aWYoIWEuX2FkZGVkUGxvdExCKW4oKGQucGxvdExpbmVzfHxbXSkuY29uY2F0KGQucGxvdEJhbmRzfHxbXSksZnVuY3Rpb24oYil7YS5hZGRQbG90QmFuZE9yTGluZShiKX0pLGEuX2FkZGVkUGxvdExCPSEwfW4oW2osayxsXSxmdW5jdGlvbihhKXt2YXIgYyxkLGU9W10sZj13LmR1cmF0aW9uO2ZvcihjIGluIGEpaWYoIWFbY10uaXNBY3RpdmUpYVtjXS5yZW5kZXIoYywhMSwwKSxhW2NdLmlzQWN0aXZlPSExLGUucHVzaChjKTskYShmdW5jdGlvbigpe2ZvcihkPWUubGVuZ3RoO2QtLTspYVtlW2RdXSYmIWFbZVtkXV0uaXNBY3RpdmUmJihhW2VbZF1dLmRlc3Ryb3koKSxkZWxldGUgYVtlW2RdXSl9LGE9PT1sfHwhYi5oYXNSZW5kZXJlZHx8IWY/MDpmKX0pO2lmKHIpQT1hLmdldExpbmVQYXRoKHIpLGEuYXhpc0xpbmU/YS5heGlzTGluZS5hbmltYXRlKHtkOkF9KTpcbmEuYXhpc0xpbmU9Yy5wYXRoKEEpLmF0dHIoe3N0cm9rZTpkLmxpbmVDb2xvcixcInN0cm9rZS13aWR0aFwiOnIsekluZGV4Ojd9KS5hZGQoYS5heGlzR3JvdXApLGEuYXhpc0xpbmVbdT9cInNob3dcIjpcImhpZGVcIl0oITApO2lmKGkmJnUpaVtpLmlzTmV3P1wiYXR0clwiOlwiYW5pbWF0ZVwiXShhLmdldFRpdGxlUG9zaXRpb24oKSksaS5pc05ldz0hMTttJiZtLmVuYWJsZWQmJmEucmVuZGVyU3RhY2tUb3RhbHMoKTthLmlzRGlydHk9ITF9LHJlZHJhdzpmdW5jdGlvbigpe3RoaXMudmlzaWJsZSYmKHRoaXMucmVuZGVyKCksbih0aGlzLnBsb3RMaW5lc0FuZEJhbmRzLGZ1bmN0aW9uKGEpe2EucmVuZGVyKCl9KSk7bih0aGlzLnNlcmllcyxmdW5jdGlvbihhKXthLmlzRGlydHk9ITB9KX0sZGVzdHJveTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLGM9Yi5zdGFja3MsZCxlPWIucGxvdExpbmVzQW5kQmFuZHM7YXx8VChiKTtmb3IoZCBpbiBjKVBhKGNbZF0pLGNbZF09bnVsbDtuKFtiLnRpY2tzLGIubWlub3JUaWNrcyxcbmIuYWx0ZXJuYXRlQmFuZHNdLGZ1bmN0aW9uKGEpe1BhKGEpfSk7Zm9yKGE9ZS5sZW5ndGg7YS0tOyllW2FdLmRlc3Ryb3koKTtuKFwic3RhY2tUb3RhbEdyb3VwLGF4aXNMaW5lLGF4aXNUaXRsZSxheGlzR3JvdXAsY3Jvc3MsZ3JpZEdyb3VwLGxhYmVsR3JvdXBcIi5zcGxpdChcIixcIiksZnVuY3Rpb24oYSl7YlthXSYmKGJbYV09YlthXS5kZXN0cm95KCkpfSk7dGhpcy5jcm9zcyYmdGhpcy5jcm9zcy5kZXN0cm95KCl9LGRyYXdDcm9zc2hhaXI6ZnVuY3Rpb24oYSxiKXt2YXIgYyxkPXRoaXMuY3Jvc3NoYWlyLGUsZjtpZighdGhpcy5jcm9zc2hhaXJ8fChzKGIpfHwhcShkLnNuYXAsITApKT09PSExKXRoaXMuaGlkZUNyb3NzaGFpcigpO2Vsc2UgaWYocShkLnNuYXAsITApP3MoYikmJihjPXRoaXMuaXNYQXhpcz9iLnBsb3RYOnRoaXMubGVuLWIucGxvdFkpOmM9dGhpcy5ob3Jpej9hLmNoYXJ0WC10aGlzLnBvczp0aGlzLmxlbi1hLmNoYXJ0WSt0aGlzLnBvcyxjPXRoaXMuaXNSYWRpYWw/XG50aGlzLmdldFBsb3RMaW5lUGF0aCh0aGlzLmlzWEF4aXM/Yi54OnEoYi5zdGFja1ksYi55KSl8fG51bGw6dGhpcy5nZXRQbG90TGluZVBhdGgobnVsbCxudWxsLG51bGwsbnVsbCxjKXx8bnVsbCxjPT09bnVsbCl0aGlzLmhpZGVDcm9zc2hhaXIoKTtlbHNlIGlmKGU9dGhpcy5jYXRlZ29yaWVzJiYhdGhpcy5pc1JhZGlhbCxmPXEoZC53aWR0aCxlP3RoaXMudHJhbnNBOjEpLHRoaXMuY3Jvc3MpdGhpcy5jcm9zcy5hdHRyKHtkOmMsdmlzaWJpbGl0eTpcInZpc2libGVcIixcInN0cm9rZS13aWR0aFwiOmZ9KTtlbHNle2U9e1wic3Ryb2tlLXdpZHRoXCI6ZixzdHJva2U6ZC5jb2xvcnx8KGU/XCJyZ2JhKDE1NSwyMDAsMjU1LDAuMilcIjpcIiNDMEMwQzBcIiksekluZGV4OnEoZC56SW5kZXgsMil9O2lmKGQuZGFzaFN0eWxlKWUuZGFzaHN0eWxlPWQuZGFzaFN0eWxlO3RoaXMuY3Jvc3M9dGhpcy5jaGFydC5yZW5kZXJlci5wYXRoKGMpLmF0dHIoZSkuYWRkKCl9fSxoaWRlQ3Jvc3NoYWlyOmZ1bmN0aW9uKCl7dGhpcy5jcm9zcyYmXG50aGlzLmNyb3NzLmhpZGUoKX19O3goSS5wcm90b3R5cGUse2dldFBsb3RCYW5kUGF0aDpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuZ2V0UGxvdExpbmVQYXRoKGIsbnVsbCxudWxsLCEwKSxkPXRoaXMuZ2V0UGxvdExpbmVQYXRoKGEsbnVsbCxudWxsLCEwKTtkJiZjPyhkLmZsYXQ9ZC50b1N0cmluZygpPT09Yy50b1N0cmluZygpLGQucHVzaChjWzRdLGNbNV0sY1sxXSxjWzJdKSk6ZD1udWxsO3JldHVybiBkfSxhZGRQbG90QmFuZDpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5hZGRQbG90QmFuZE9yTGluZShhLFwicGxvdEJhbmRzXCIpfSxhZGRQbG90TGluZTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5hZGRQbG90QmFuZE9yTGluZShhLFwicGxvdExpbmVzXCIpfSxhZGRQbG90QmFuZE9yTGluZTpmdW5jdGlvbihhLGIpe3ZhciBjPShuZXcgei5QbG90TGluZU9yQmFuZCh0aGlzLGEpKS5yZW5kZXIoKSxkPXRoaXMudXNlck9wdGlvbnM7YyYmKGImJihkW2JdPWRbYl18fFtdLGRbYl0ucHVzaChhKSksXG50aGlzLnBsb3RMaW5lc0FuZEJhbmRzLnB1c2goYykpO3JldHVybiBjfSxyZW1vdmVQbG90QmFuZE9yTGluZTpmdW5jdGlvbihhKXtmb3IodmFyIGI9dGhpcy5wbG90TGluZXNBbmRCYW5kcyxjPXRoaXMub3B0aW9ucyxkPXRoaXMudXNlck9wdGlvbnMsZT1iLmxlbmd0aDtlLS07KWJbZV0uaWQ9PT1hJiZiW2VdLmRlc3Ryb3koKTtuKFtjLnBsb3RMaW5lc3x8W10sZC5wbG90TGluZXN8fFtdLGMucGxvdEJhbmRzfHxbXSxkLnBsb3RCYW5kc3x8W11dLGZ1bmN0aW9uKGIpe2ZvcihlPWIubGVuZ3RoO2UtLTspYltlXS5pZD09PWEmJkFhKGIsYltlXSl9KX19KTtJLnByb3RvdHlwZS5nZXRUaW1lVGlja3M9ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9W10sZj17fSxnPU4uZ2xvYmFsLnVzZVVUQyxoLGk9bmV3IGZhKGItZmIoYikpLGo9YS51bml0UmFuZ2Usaz1hLmNvdW50O2lmKHMoYikpe2lbUGJdKGo+PUguc2Vjb25kPzA6aypWKGkuZ2V0TWlsbGlzZWNvbmRzKCkvaykpO2lmKGo+PUguc2Vjb25kKWlbUWJdKGo+PVxuSC5taW51dGU/MDprKlYoaS5nZXRTZWNvbmRzKCkvaykpO2lmKGo+PUgubWludXRlKWlbUmJdKGo+PUguaG91cj8wOmsqVihpW0NiXSgpL2spKTtpZihqPj1ILmhvdXIpaVtTYl0oaj49SC5kYXk/MDprKlYoaVtEYl0oKS9rKSk7aWYoaj49SC5kYXkpaVtyYl0oaj49SC5tb250aD8xOmsqVihpW2JiXSgpL2spKTtqPj1ILm1vbnRoJiYoaVtGYl0oaj49SC55ZWFyPzA6aypWKGlbaWJdKCkvaykpLGg9aVtqYl0oKSk7aj49SC55ZWFyJiYoaC09aCVrLGlbR2JdKGgpKTtpZihqPT09SC53ZWVrKWlbcmJdKGlbYmJdKCktaVtFYl0oKStxKGQsMSkpO2I9MTtpZih6Ynx8Z2IpaT1pLmdldFRpbWUoKSxpPW5ldyBmYShpK2ZiKGkpKTtoPWlbamJdKCk7Zm9yKHZhciBkPWkuZ2V0VGltZSgpLGw9aVtpYl0oKSxtPWlbYmJdKCksbz0hZ3x8ISFnYixwPShILmRheSsoZz9mYihpKTppLmdldFRpbWV6b25lT2Zmc2V0KCkqNkU0KSklSC5kYXk7ZDxjOyllLnB1c2goZCksaj09PUgueWVhcj9kPXFiKGgrXG5iKmssMCk6aj09PUgubW9udGg/ZD1xYihoLGwrYiprKTpvJiYoaj09PUguZGF5fHxqPT09SC53ZWVrKT9kPXFiKGgsbCxtK2Iqayooaj09PUguZGF5PzE6NykpOmQrPWoqayxiKys7ZS5wdXNoKGQpO24oU2EoZSxmdW5jdGlvbihhKXtyZXR1cm4gajw9SC5ob3VyJiZhJUguZGF5PT09cH0pLGZ1bmN0aW9uKGEpe2ZbYV09XCJkYXlcIn0pfWUuaW5mbz14KGEse2hpZ2hlclJhbmtzOmYsdG90YWxSYW5nZTpqKmt9KTtyZXR1cm4gZX07SS5wcm90b3R5cGUubm9ybWFsaXplVGltZVRpY2tJbnRlcnZhbD1mdW5jdGlvbihhLGIpe3ZhciBjPWJ8fFtbXCJtaWxsaXNlY29uZFwiLFsxLDIsNSwxMCwyMCwyNSw1MCwxMDAsMjAwLDUwMF1dLFtcInNlY29uZFwiLFsxLDIsNSwxMCwxNSwzMF1dLFtcIm1pbnV0ZVwiLFsxLDIsNSwxMCwxNSwzMF1dLFtcImhvdXJcIixbMSwyLDMsNCw2LDgsMTJdXSxbXCJkYXlcIixbMSwyXV0sW1wid2Vla1wiLFsxLDJdXSxbXCJtb250aFwiLFsxLDIsMyw0LDZdXSxbXCJ5ZWFyXCIsbnVsbF1dLGQ9XG5jW2MubGVuZ3RoLTFdLGU9SFtkWzBdXSxmPWRbMV0sZztmb3IoZz0wO2c8Yy5sZW5ndGg7ZysrKWlmKGQ9Y1tnXSxlPUhbZFswXV0sZj1kWzFdLGNbZysxXSYmYTw9KGUqZltmLmxlbmd0aC0xXStIW2NbZysxXVswXV0pLzIpYnJlYWs7ZT09PUgueWVhciYmYTw1KmUmJihmPVsxLDIsNV0pO2M9QmIoYS9lLGYsZFswXT09PVwieWVhclwiP3YoQWIoYS9lKSwxKToxKTtyZXR1cm57dW5pdFJhbmdlOmUsY291bnQ6Yyx1bml0TmFtZTpkWzBdfX07SS5wcm90b3R5cGUuZ2V0TG9nVGlja1Bvc2l0aW9ucz1mdW5jdGlvbihhLGIsYyxkKXt2YXIgZT10aGlzLm9wdGlvbnMsZj10aGlzLmxlbixnPXRoaXMubGluMmxvZyxoPXRoaXMubG9nMmxpbixpPVtdO2lmKCFkKXRoaXMuX21pbm9yQXV0b0ludGVydmFsPW51bGw7aWYoYT49MC41KWE9eShhKSxpPXRoaXMuZ2V0TGluZWFyVGlja1Bvc2l0aW9ucyhhLGIsYyk7ZWxzZSBpZihhPj0wLjA4KWZvcih2YXIgZj1WKGIpLGosayxsLG0sbyxlPWE+MC4zP1xuWzEsMiw0XTphPjAuMTU/WzEsMiw0LDYsOF06WzEsMiwzLDQsNSw2LDcsOCw5XTtmPGMrMSYmIW87ZisrKXtrPWUubGVuZ3RoO2ZvcihqPTA7ajxrJiYhbztqKyspbD1oKGcoZikqZVtqXSksbD5iJiYoIWR8fG08PWMpJiZtIT09dCYmaS5wdXNoKG0pLG0+YyYmKG89ITApLG09bH1lbHNlIGlmKGI9ZyhiKSxjPWcoYyksYT1lW2Q/XCJtaW5vclRpY2tJbnRlcnZhbFwiOlwidGlja0ludGVydmFsXCJdLGE9cShhPT09XCJhdXRvXCI/bnVsbDphLHRoaXMuX21pbm9yQXV0b0ludGVydmFsLChjLWIpKihlLnRpY2tQaXhlbEludGVydmFsLyhkPzU6MSkpLygoZD9mL3RoaXMudGlja1Bvc2l0aW9ucy5sZW5ndGg6Zil8fDEpKSxhPUJiKGEsbnVsbCxBYihhKSksaT10YSh0aGlzLmdldExpbmVhclRpY2tQb3NpdGlvbnMoYSxiLGMpLGgpLCFkKXRoaXMuX21pbm9yQXV0b0ludGVydmFsPWEvNTtpZighZCl0aGlzLnRpY2tJbnRlcnZhbD1hO3JldHVybiBpfTtJLnByb3RvdHlwZS5sb2cybGluPWZ1bmN0aW9uKGEpe3JldHVybiBZLmxvZyhhKS9cblkuTE4xMH07SS5wcm90b3R5cGUubGluMmxvZz1mdW5jdGlvbihhKXtyZXR1cm4gWS5wb3coMTAsYSl9O3ZhciBMYj16LlRvb2x0aXA9ZnVuY3Rpb24oKXt0aGlzLmluaXQuYXBwbHkodGhpcyxhcmd1bWVudHMpfTtMYi5wcm90b3R5cGU9e2luaXQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz1iLmJvcmRlcldpZHRoLGQ9Yi5zdHlsZSxlPUcoZC5wYWRkaW5nKTt0aGlzLmNoYXJ0PWE7dGhpcy5vcHRpb25zPWI7dGhpcy5jcm9zc2hhaXJzPVtdO3RoaXMubm93PXt4OjAseTowfTt0aGlzLmlzSGlkZGVuPSEwO3RoaXMubGFiZWw9YS5yZW5kZXJlci5sYWJlbChcIlwiLDAsMCxiLnNoYXBlfHxcImNhbGxvdXRcIixudWxsLG51bGwsYi51c2VIVE1MLG51bGwsXCJ0b29sdGlwXCIpLmF0dHIoe3BhZGRpbmc6ZSxmaWxsOmIuYmFja2dyb3VuZENvbG9yLFwic3Ryb2tlLXdpZHRoXCI6YyxyOmIuYm9yZGVyUmFkaXVzLHpJbmRleDo4fSkuY3NzKGQpLmNzcyh7cGFkZGluZzowfSkuYWRkKCkuYXR0cih7eTotOTk5OX0pO1xucWF8fHRoaXMubGFiZWwuc2hhZG93KGIuc2hhZG93KTt0aGlzLnNoYXJlZD1iLnNoYXJlZH0sZGVzdHJveTpmdW5jdGlvbigpe2lmKHRoaXMubGFiZWwpdGhpcy5sYWJlbD10aGlzLmxhYmVsLmRlc3Ryb3koKTtjbGVhclRpbWVvdXQodGhpcy5oaWRlVGltZXIpO2NsZWFyVGltZW91dCh0aGlzLnRvb2x0aXBUaW1lb3V0KX0sbW92ZTpmdW5jdGlvbihhLGIsYyxkKXt2YXIgZT10aGlzLGY9ZS5ub3csZz1lLm9wdGlvbnMuYW5pbWF0aW9uIT09ITEmJiFlLmlzSGlkZGVuJiYoUyhhLWYueCk+MXx8UyhiLWYueSk+MSksaD1lLmZvbGxvd1BvaW50ZXJ8fGUubGVuPjE7eChmLHt4Omc/KDIqZi54K2EpLzM6YSx5Omc/KGYueStiKS8yOmIsYW5jaG9yWDpoP3Q6Zz8oMipmLmFuY2hvclgrYykvMzpjLGFuY2hvclk6aD90Omc/KGYuYW5jaG9yWStkKS8yOmR9KTtlLmxhYmVsLmF0dHIoZik7aWYoZyljbGVhclRpbWVvdXQodGhpcy50b29sdGlwVGltZW91dCksdGhpcy50b29sdGlwVGltZW91dD1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7ZSYmXG5lLm1vdmUoYSxiLGMsZCl9LDMyKX0saGlkZTpmdW5jdGlvbihhKXt2YXIgYj10aGlzO2NsZWFyVGltZW91dCh0aGlzLmhpZGVUaW1lcik7YT1xKGEsdGhpcy5vcHRpb25zLmhpZGVEZWxheSw1MDApO2lmKCF0aGlzLmlzSGlkZGVuKXRoaXMuaGlkZVRpbWVyPSRhKGZ1bmN0aW9uKCl7Yi5sYWJlbFthP1wiZmFkZU91dFwiOlwiaGlkZVwiXSgpO2IuaXNIaWRkZW49ITB9LGEpfSxnZXRBbmNob3I6ZnVuY3Rpb24oYSxiKXt2YXIgYyxkPXRoaXMuY2hhcnQsZT1kLmludmVydGVkLGY9ZC5wbG90VG9wLGc9ZC5wbG90TGVmdCxoPTAsaT0wLGosayxhPXZhKGEpO2M9YVswXS50b29sdGlwUG9zO3RoaXMuZm9sbG93UG9pbnRlciYmYiYmKGIuY2hhcnRYPT09dCYmKGI9ZC5wb2ludGVyLm5vcm1hbGl6ZShiKSksYz1bYi5jaGFydFgtZC5wbG90TGVmdCxiLmNoYXJ0WS1mXSk7Y3x8KG4oYSxmdW5jdGlvbihhKXtqPWEuc2VyaWVzLnlBeGlzO2s9YS5zZXJpZXMueEF4aXM7aCs9YS5wbG90WCsoIWUmJms/XG5rLmxlZnQtZzowKTtpKz0oYS5wbG90TG93PyhhLnBsb3RMb3crYS5wbG90SGlnaCkvMjphLnBsb3RZKSsoIWUmJmo/ai50b3AtZjowKX0pLGgvPWEubGVuZ3RoLGkvPWEubGVuZ3RoLGM9W2U/ZC5wbG90V2lkdGgtaTpoLHRoaXMuc2hhcmVkJiYhZSYmYS5sZW5ndGg+MSYmYj9iLmNoYXJ0WS1mOmU/ZC5wbG90SGVpZ2h0LWg6aV0pO3JldHVybiB0YShjLHkpfSxnZXRQb3NpdGlvbjpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9dGhpcy5jaGFydCxlPXRoaXMuZGlzdGFuY2UsZj17fSxnPWMuaHx8MCxoLGk9W1wieVwiLGQuY2hhcnRIZWlnaHQsYixjLnBsb3RZK2QucGxvdFRvcCxkLnBsb3RUb3AsZC5wbG90VG9wK2QucGxvdEhlaWdodF0saj1bXCJ4XCIsZC5jaGFydFdpZHRoLGEsYy5wbG90WCtkLnBsb3RMZWZ0LGQucGxvdExlZnQsZC5wbG90TGVmdCtkLnBsb3RXaWR0aF0saz0hdGhpcy5mb2xsb3dQb2ludGVyJiZxKGMudHRCZWxvdywhZC5pbnZlcnRlZD09PSEhYy5uZWdhdGl2ZSksbD1mdW5jdGlvbihhLFxuYixjLGQsaCxpKXt2YXIgaj1jPGQtZSxtPWQrZStjPGIsbD1kLWUtYztkKz1lO2lmKGsmJm0pZlthXT1kO2Vsc2UgaWYoIWsmJmopZlthXT1sO2Vsc2UgaWYoailmW2FdPUUoaS1jLGwtZzwwP2w6bC1nKTtlbHNlIGlmKG0pZlthXT12KGgsZCtnK2M+Yj9kOmQrZyk7ZWxzZSByZXR1cm4hMX0sbT1mdW5jdGlvbihhLGIsYyxkKXt2YXIgZztkPGV8fGQ+Yi1lP2c9ITE6ZlthXT1kPGMvMj8xOmQ+Yi1jLzI/Yi1jLTI6ZC1jLzI7cmV0dXJuIGd9LG89ZnVuY3Rpb24oYSl7dmFyIGI9aTtpPWo7aj1iO2g9YX0scD1mdW5jdGlvbigpe2wuYXBwbHkoMCxpKSE9PSExP20uYXBwbHkoMCxqKT09PSExJiYhaCYmKG8oITApLHAoKSk6aD9mLng9Zi55PTA6KG8oITApLHAoKSl9OyhkLmludmVydGVkfHx0aGlzLmxlbj4xKSYmbygpO3AoKTtyZXR1cm4gZn0sZGVmYXVsdEZvcm1hdHRlcjpmdW5jdGlvbihhKXt2YXIgYj10aGlzLnBvaW50c3x8dmEodGhpcyksYztjPVthLnRvb2x0aXBGb290ZXJIZWFkZXJGb3JtYXR0ZXIoYlswXSldO1xuYz1jLmNvbmNhdChhLmJvZHlGb3JtYXR0ZXIoYikpO2MucHVzaChhLnRvb2x0aXBGb290ZXJIZWFkZXJGb3JtYXR0ZXIoYlswXSwhMCkpO3JldHVybiBjLmpvaW4oXCJcIil9LHJlZnJlc2g6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmNoYXJ0LGQ9dGhpcy5sYWJlbCxlPXRoaXMub3B0aW9ucyxmLGcsaCxpPXt9LGosaz1bXTtqPWUuZm9ybWF0dGVyfHx0aGlzLmRlZmF1bHRGb3JtYXR0ZXI7dmFyIGk9Yy5ob3ZlclBvaW50cyxsLG09dGhpcy5zaGFyZWQ7Y2xlYXJUaW1lb3V0KHRoaXMuaGlkZVRpbWVyKTt0aGlzLmZvbGxvd1BvaW50ZXI9dmEoYSlbMF0uc2VyaWVzLnRvb2x0aXBPcHRpb25zLmZvbGxvd1BvaW50ZXI7aD10aGlzLmdldEFuY2hvcihhLGIpO2Y9aFswXTtnPWhbMV07bSYmKCFhLnNlcmllc3x8IWEuc2VyaWVzLm5vU2hhcmVkVG9vbHRpcCk/KGMuaG92ZXJQb2ludHM9YSxpJiZuKGksZnVuY3Rpb24oYSl7YS5zZXRTdGF0ZSgpfSksbihhLGZ1bmN0aW9uKGEpe2Euc2V0U3RhdGUoXCJob3ZlclwiKTtcbmsucHVzaChhLmdldExhYmVsQ29uZmlnKCkpfSksaT17eDphWzBdLmNhdGVnb3J5LHk6YVswXS55fSxpLnBvaW50cz1rLHRoaXMubGVuPWsubGVuZ3RoLGE9YVswXSk6aT1hLmdldExhYmVsQ29uZmlnKCk7aj1qLmNhbGwoaSx0aGlzKTtpPWEuc2VyaWVzO3RoaXMuZGlzdGFuY2U9cShpLnRvb2x0aXBPcHRpb25zLmRpc3RhbmNlLDE2KTtqPT09ITE/dGhpcy5oaWRlKCk6KHRoaXMuaXNIaWRkZW4mJihUYShkKSxkLmF0dHIoXCJvcGFjaXR5XCIsMSkuc2hvdygpKSxkLmF0dHIoe3RleHQ6an0pLGw9ZS5ib3JkZXJDb2xvcnx8YS5jb2xvcnx8aS5jb2xvcnx8XCIjNjA2MDYwXCIsZC5hdHRyKHtzdHJva2U6bH0pLHRoaXMudXBkYXRlUG9zaXRpb24oe3Bsb3RYOmYscGxvdFk6ZyxuZWdhdGl2ZTphLm5lZ2F0aXZlLHR0QmVsb3c6YS50dEJlbG93LGg6aFsyXXx8MH0pLHRoaXMuaXNIaWRkZW49ITEpO00oYyxcInRvb2x0aXBSZWZyZXNoXCIse3RleHQ6aix4OmYrYy5wbG90TGVmdCx5OmcrYy5wbG90VG9wLFxuYm9yZGVyQ29sb3I6bH0pfSx1cGRhdGVQb3NpdGlvbjpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNoYXJ0LGM9dGhpcy5sYWJlbCxjPSh0aGlzLm9wdGlvbnMucG9zaXRpb25lcnx8dGhpcy5nZXRQb3NpdGlvbikuY2FsbCh0aGlzLGMud2lkdGgsYy5oZWlnaHQsYSk7dGhpcy5tb3ZlKHkoYy54KSx5KGMueXx8MCksYS5wbG90WCtiLnBsb3RMZWZ0LGEucGxvdFkrYi5wbG90VG9wKX0sZ2V0WERhdGVGb3JtYXQ6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGI9Yi5kYXRlVGltZUxhYmVsRm9ybWF0cyxlPWMmJmMuY2xvc2VzdFBvaW50UmFuZ2UsZixnPXttaWxsaXNlY29uZDoxNSxzZWNvbmQ6MTIsbWludXRlOjksaG91cjo2LGRheTozfSxoLGk9XCJtaWxsaXNlY29uZFwiO2lmKGUpe2g9bWEoXCIlbS0lZCAlSDolTTolUy4lTFwiLGEueCk7Zm9yKGYgaW4gSCl7aWYoZT09PUgud2VlayYmK21hKFwiJXdcIixhLngpPT09Yy5vcHRpb25zLnN0YXJ0T2ZXZWVrJiZoLnN1YnN0cig2KT09PVwiMDA6MDA6MDAuMDAwXCIpe2Y9XG5cIndlZWtcIjticmVha31pZihIW2ZdPmUpe2Y9aTticmVha31pZihnW2ZdJiZoLnN1YnN0cihnW2ZdKSE9PVwiMDEtMDEgMDA6MDA6MDAuMDAwXCIuc3Vic3RyKGdbZl0pKWJyZWFrO2YhPT1cIndlZWtcIiYmKGk9Zil9ZiYmKGQ9YltmXSl9ZWxzZSBkPWIuZGF5O3JldHVybiBkfHxiLnllYXJ9LHRvb2x0aXBGb290ZXJIZWFkZXJGb3JtYXR0ZXI6ZnVuY3Rpb24oYSxiKXt2YXIgYz1iP1wiZm9vdGVyXCI6XCJoZWFkZXJcIixkPWEuc2VyaWVzLGU9ZC50b29sdGlwT3B0aW9ucyxmPWUueERhdGVGb3JtYXQsZz1kLnhBeGlzLGg9ZyYmZy5vcHRpb25zLnR5cGU9PT1cImRhdGV0aW1lXCImJnVhKGEua2V5KSxjPWVbYytcIkZvcm1hdFwiXTtoJiYhZiYmKGY9dGhpcy5nZXRYRGF0ZUZvcm1hdChhLGUsZykpO2gmJmYmJihjPWMucmVwbGFjZShcIntwb2ludC5rZXl9XCIsXCJ7cG9pbnQua2V5OlwiK2YrXCJ9XCIpKTtyZXR1cm4gTGEoYyx7cG9pbnQ6YSxzZXJpZXM6ZH0pfSxib2R5Rm9ybWF0dGVyOmZ1bmN0aW9uKGEpe3JldHVybiB0YShhLFxuZnVuY3Rpb24oYSl7dmFyIGM9YS5zZXJpZXMudG9vbHRpcE9wdGlvbnM7cmV0dXJuKGMucG9pbnRGb3JtYXR0ZXJ8fGEucG9pbnQudG9vbHRpcEZvcm1hdHRlcikuY2FsbChhLnBvaW50LGMucG9pbnRGb3JtYXQpfSl9fTt2YXIgb2E7ZGI9QiYmQi5kb2N1bWVudEVsZW1lbnQub250b3VjaHN0YXJ0IT09dDt2YXIgWmE9ei5Qb2ludGVyPWZ1bmN0aW9uKGEsYil7dGhpcy5pbml0KGEsYil9O1phLnByb3RvdHlwZT17aW5pdDpmdW5jdGlvbihhLGIpe3ZhciBjPWIuY2hhcnQsZD1jLmV2ZW50cyxlPXFhP1wiXCI6Yy56b29tVHlwZSxjPWEuaW52ZXJ0ZWQsZjt0aGlzLm9wdGlvbnM9Yjt0aGlzLmNoYXJ0PWE7dGhpcy56b29tWD1mPS94Ly50ZXN0KGUpO3RoaXMuem9vbVk9ZT0veS8udGVzdChlKTt0aGlzLnpvb21Ib3I9ZiYmIWN8fGUmJmM7dGhpcy56b29tVmVydD1lJiYhY3x8ZiYmYzt0aGlzLmhhc1pvb209Znx8ZTt0aGlzLnJ1bkNoYXJ0Q2xpY2s9ZCYmISFkLmNsaWNrO3RoaXMucGluY2hEb3duPVxuW107dGhpcy5sYXN0VmFsaWRUb3VjaD17fTtpZih6LlRvb2x0aXAmJmIudG9vbHRpcC5lbmFibGVkKWEudG9vbHRpcD1uZXcgTGIoYSxiLnRvb2x0aXApLHRoaXMuZm9sbG93VG91Y2hNb3ZlPXEoYi50b29sdGlwLmZvbGxvd1RvdWNoTW92ZSwhMCk7dGhpcy5zZXRET01FdmVudHMoKX0sbm9ybWFsaXplOmZ1bmN0aW9uKGEsYil7dmFyIGMsZCxhPWF8fEouZXZlbnQ7aWYoIWEudGFyZ2V0KWEudGFyZ2V0PWEuc3JjRWxlbWVudDtkPWEudG91Y2hlcz9hLnRvdWNoZXMubGVuZ3RoP2EudG91Y2hlcy5pdGVtKDApOmEuY2hhbmdlZFRvdWNoZXNbMF06YTtpZighYil0aGlzLmNoYXJ0UG9zaXRpb249Yj1LYih0aGlzLmNoYXJ0LmNvbnRhaW5lcik7ZC5wYWdlWD09PXQ/KGM9dihhLngsYS5jbGllbnRYLWIubGVmdCksZD1hLnkpOihjPWQucGFnZVgtYi5sZWZ0LGQ9ZC5wYWdlWS1iLnRvcCk7cmV0dXJuIHgoYSx7Y2hhcnRYOnkoYyksY2hhcnRZOnkoZCl9KX0sZ2V0Q29vcmRpbmF0ZXM6ZnVuY3Rpb24oYSl7dmFyIGI9XG57eEF4aXM6W10seUF4aXM6W119O24odGhpcy5jaGFydC5heGVzLGZ1bmN0aW9uKGMpe2JbYy5pc1hBeGlzP1wieEF4aXNcIjpcInlBeGlzXCJdLnB1c2goe2F4aXM6Yyx2YWx1ZTpjLnRvVmFsdWUoYVtjLmhvcml6P1wiY2hhcnRYXCI6XCJjaGFydFlcIl0pfSl9KTtyZXR1cm4gYn0scnVuUG9pbnRBY3Rpb25zOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY2hhcnQsYz1iLnNlcmllcyxkPWIudG9vbHRpcCxlPWQ/ZC5zaGFyZWQ6ITEsZj1iLmhvdmVyUG9pbnQsZz1iLmhvdmVyU2VyaWVzLGgsaT1bTnVtYmVyLk1BWF9WQUxVRSxOdW1iZXIuTUFYX1ZBTFVFXSxqLGssbD1bXSxtPVtdLG87aWYoIWUmJiFnKWZvcihoPTA7aDxjLmxlbmd0aDtoKyspaWYoY1toXS5kaXJlY3RUb3VjaHx8IWNbaF0ub3B0aW9ucy5zdGlja3lUcmFja2luZyljPVtdO2cmJihlP2cubm9TaGFyZWRUb29sdGlwOmcuZGlyZWN0VG91Y2gpJiZmP209W2ZdOihuKGMsZnVuY3Rpb24oYil7aj1iLm5vU2hhcmVkVG9vbHRpcCYmZTtrPVxuIWUmJmIuZGlyZWN0VG91Y2g7Yi52aXNpYmxlJiYhaiYmIWsmJnEoYi5vcHRpb25zLmVuYWJsZU1vdXNlVHJhY2tpbmcsITApJiYobz1iLnNlYXJjaFBvaW50KGEsIWomJmIua2REaW1lbnNpb25zPT09MSkpJiZsLnB1c2gobyl9KSxuKGwsZnVuY3Rpb24oYSl7YSYmbihbXCJkaXN0XCIsXCJkaXN0WFwiXSxmdW5jdGlvbihiLGMpe2lmKHR5cGVvZiBhW2JdPT09XCJudW1iZXJcIil7dmFyIGQ9YVtiXT09PWlbY10mJmEuc2VyaWVzLmdyb3VwLnpJbmRleD49bVtjXS5zZXJpZXMuZ3JvdXAuekluZGV4O2lmKGFbYl08aVtjXXx8ZClpW2NdPWFbYl0sbVtjXT1hfX0pfSkpO2lmKGUpZm9yKGg9bC5sZW5ndGg7aC0tOykobFtoXS5jbGllbnRYIT09bVsxXS5jbGllbnRYfHxsW2hdLnNlcmllcy5ub1NoYXJlZFRvb2x0aXApJiZsLnNwbGljZShoLDEpO2lmKG1bMF0mJihtWzBdIT09dGhpcy5wcmV2S0RQb2ludHx8ZCYmZC5pc0hpZGRlbikpaWYoZSYmIW1bMF0uc2VyaWVzLm5vU2hhcmVkVG9vbHRpcClsLmxlbmd0aCYmXG5kJiZkLnJlZnJlc2gobCxhKSxuKGwsZnVuY3Rpb24oYil7Yi5vbk1vdXNlT3ZlcihhLGIhPT0oZyYmZy5kaXJlY3RUb3VjaCYmZnx8bVswXSkpfSksdGhpcy5wcmV2S0RQb2ludD1tWzFdO2Vsc2V7ZCYmZC5yZWZyZXNoKG1bMF0sYSk7aWYoIWd8fCFnLmRpcmVjdFRvdWNoKW1bMF0ub25Nb3VzZU92ZXIoYSk7dGhpcy5wcmV2S0RQb2ludD1tWzBdfWVsc2UgYz1nJiZnLnRvb2x0aXBPcHRpb25zLmZvbGxvd1BvaW50ZXIsZCYmYyYmIWQuaXNIaWRkZW4mJihjPWQuZ2V0QW5jaG9yKFt7fV0sYSksZC51cGRhdGVQb3NpdGlvbih7cGxvdFg6Y1swXSxwbG90WTpjWzFdfSkpO2lmKCF0aGlzLl9vbkRvY3VtZW50TW91c2VNb3ZlKXRoaXMuX29uRG9jdW1lbnRNb3VzZU1vdmU9ZnVuY3Rpb24oYSl7aWYoJFtvYV0pJFtvYV0ucG9pbnRlci5vbkRvY3VtZW50TW91c2VNb3ZlKGEpfSxEKEIsXCJtb3VzZW1vdmVcIix0aGlzLl9vbkRvY3VtZW50TW91c2VNb3ZlKTtuKGU/bDpbcShtWzFdLGYpXSxmdW5jdGlvbihjKXtuKGIuYXhlcyxcbmZ1bmN0aW9uKGIpeyghY3x8Yy5zZXJpZXNbYi5jb2xsXT09PWIpJiZiLmRyYXdDcm9zc2hhaXIoYSxjKX0pfSl9LHJlc2V0OmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5jaGFydCxkPWMuaG92ZXJTZXJpZXMsZT1jLmhvdmVyUG9pbnQsZj1jLmhvdmVyUG9pbnRzLGc9Yy50b29sdGlwLGg9ZyYmZy5zaGFyZWQ/ZjplO2EmJmgmJm4odmEoaCksZnVuY3Rpb24oYil7Yi5zZXJpZXMuaXNDYXJ0ZXNpYW4mJmIucGxvdFg9PT12b2lkIDAmJihhPSExKX0pO2lmKGEpZyYmaCYmKGcucmVmcmVzaChoKSxlJiYoZS5zZXRTdGF0ZShlLnN0YXRlLCEwKSxuKGMuYXhlcyxmdW5jdGlvbihhKXtxKGEuY3Jvc3NoYWlyJiZhLmNyb3NzaGFpci5zbmFwLCEwKT9hLmRyYXdDcm9zc2hhaXIobnVsbCxlKTphLmhpZGVDcm9zc2hhaXIoKX0pKSk7ZWxzZXtpZihlKWUub25Nb3VzZU91dCgpO2YmJm4oZixmdW5jdGlvbihhKXthLnNldFN0YXRlKCl9KTtpZihkKWQub25Nb3VzZU91dCgpO2cmJmcuaGlkZShiKTtcbmlmKHRoaXMuX29uRG9jdW1lbnRNb3VzZU1vdmUpVChCLFwibW91c2Vtb3ZlXCIsdGhpcy5fb25Eb2N1bWVudE1vdXNlTW92ZSksdGhpcy5fb25Eb2N1bWVudE1vdXNlTW92ZT1udWxsO24oYy5heGVzLGZ1bmN0aW9uKGEpe2EuaGlkZUNyb3NzaGFpcigpfSk7dGhpcy5ob3Zlclg9Yy5ob3ZlclBvaW50cz1jLmhvdmVyUG9pbnQ9bnVsbH19LHNjYWxlR3JvdXBzOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5jaGFydCxkO24oYy5zZXJpZXMsZnVuY3Rpb24oZSl7ZD1hfHxlLmdldFBsb3RCb3goKTtlLnhBeGlzJiZlLnhBeGlzLnpvb21FbmFibGVkJiYoZS5ncm91cC5hdHRyKGQpLGUubWFya2VyR3JvdXAmJihlLm1hcmtlckdyb3VwLmF0dHIoZCksZS5tYXJrZXJHcm91cC5jbGlwKGI/Yy5jbGlwUmVjdDpudWxsKSksZS5kYXRhTGFiZWxzR3JvdXAmJmUuZGF0YUxhYmVsc0dyb3VwLmF0dHIoZCkpfSk7Yy5jbGlwUmVjdC5hdHRyKGJ8fGMuY2xpcEJveCl9LGRyYWdTdGFydDpmdW5jdGlvbihhKXt2YXIgYj1cbnRoaXMuY2hhcnQ7Yi5tb3VzZUlzRG93bj1hLnR5cGU7Yi5jYW5jZWxDbGljaz0hMTtiLm1vdXNlRG93blg9dGhpcy5tb3VzZURvd25YPWEuY2hhcnRYO2IubW91c2VEb3duWT10aGlzLm1vdXNlRG93blk9YS5jaGFydFl9LGRyYWc6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jaGFydCxjPWIub3B0aW9ucy5jaGFydCxkPWEuY2hhcnRYLGU9YS5jaGFydFksZj10aGlzLnpvb21Ib3IsZz10aGlzLnpvb21WZXJ0LGg9Yi5wbG90TGVmdCxpPWIucGxvdFRvcCxqPWIucGxvdFdpZHRoLGs9Yi5wbG90SGVpZ2h0LGwsbT10aGlzLnNlbGVjdGlvbk1hcmtlcixvPXRoaXMubW91c2VEb3duWCxwPXRoaXMubW91c2VEb3duWSxyPWMucGFuS2V5JiZhW2MucGFuS2V5K1wiS2V5XCJdO2lmKCFtfHwhbS50b3VjaClpZihkPGg/ZD1oOmQ+aCtqJiYoZD1oK2opLGU8aT9lPWk6ZT5pK2smJihlPWkrayksdGhpcy5oYXNEcmFnZ2VkPU1hdGguc3FydChNYXRoLnBvdyhvLWQsMikrTWF0aC5wb3cocC1lLDIpKSx0aGlzLmhhc0RyYWdnZWQ+XG4xMCl7bD1iLmlzSW5zaWRlUGxvdChvLWgscC1pKTtpZihiLmhhc0NhcnRlc2lhblNlcmllcyYmKHRoaXMuem9vbVh8fHRoaXMuem9vbVkpJiZsJiYhciYmIW0pdGhpcy5zZWxlY3Rpb25NYXJrZXI9bT1iLnJlbmRlcmVyLnJlY3QoaCxpLGY/MTpqLGc/MTprLDApLmF0dHIoe2ZpbGw6Yy5zZWxlY3Rpb25NYXJrZXJGaWxsfHxcInJnYmEoNjksMTE0LDE2NywwLjI1KVwiLHpJbmRleDo3fSkuYWRkKCk7bSYmZiYmKGQtPW8sbS5hdHRyKHt3aWR0aDpTKGQpLHg6KGQ+MD8wOmQpK299KSk7bSYmZyYmKGQ9ZS1wLG0uYXR0cih7aGVpZ2h0OlMoZCkseTooZD4wPzA6ZCkrcH0pKTtsJiYhbSYmYy5wYW5uaW5nJiZiLnBhbihhLGMucGFubmluZyl9fSxkcm9wOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMsYz10aGlzLmNoYXJ0LGQ9dGhpcy5oYXNQaW5jaGVkO2lmKHRoaXMuc2VsZWN0aW9uTWFya2VyKXt2YXIgZT17b3JpZ2luYWxFdmVudDphLHhBeGlzOltdLHlBeGlzOltdfSxmPXRoaXMuc2VsZWN0aW9uTWFya2VyLFxuZz1mLmF0dHI/Zi5hdHRyKFwieFwiKTpmLngsaD1mLmF0dHI/Zi5hdHRyKFwieVwiKTpmLnksaT1mLmF0dHI/Zi5hdHRyKFwid2lkdGhcIik6Zi53aWR0aCxqPWYuYXR0cj9mLmF0dHIoXCJoZWlnaHRcIik6Zi5oZWlnaHQsaztpZih0aGlzLmhhc0RyYWdnZWR8fGQpbihjLmF4ZXMsZnVuY3Rpb24oYyl7aWYoYy56b29tRW5hYmxlZCYmcyhjLm1pbikmJihkfHxiW3t4QXhpczpcInpvb21YXCIseUF4aXM6XCJ6b29tWVwifVtjLmNvbGxdXSkpe3ZhciBmPWMuaG9yaXosbz1hLnR5cGU9PT1cInRvdWNoZW5kXCI/Yy5taW5QaXhlbFBhZGRpbmc6MCxwPWMudG9WYWx1ZSgoZj9nOmgpK28pLGY9Yy50b1ZhbHVlKChmP2craTpoK2opLW8pO2VbYy5jb2xsXS5wdXNoKHtheGlzOmMsbWluOkUocCxmKSxtYXg6dihwLGYpfSk7az0hMH19KSxrJiZNKGMsXCJzZWxlY3Rpb25cIixlLGZ1bmN0aW9uKGEpe2Muem9vbSh4KGEsZD97YW5pbWF0aW9uOiExfTpudWxsKSl9KTt0aGlzLnNlbGVjdGlvbk1hcmtlcj10aGlzLnNlbGVjdGlvbk1hcmtlci5kZXN0cm95KCk7XG5kJiZ0aGlzLnNjYWxlR3JvdXBzKCl9aWYoYylGKGMuY29udGFpbmVyLHtjdXJzb3I6Yy5fY3Vyc29yfSksYy5jYW5jZWxDbGljaz10aGlzLmhhc0RyYWdnZWQ+MTAsYy5tb3VzZUlzRG93bj10aGlzLmhhc0RyYWdnZWQ9dGhpcy5oYXNQaW5jaGVkPSExLHRoaXMucGluY2hEb3duPVtdfSxvbkNvbnRhaW5lck1vdXNlRG93bjpmdW5jdGlvbihhKXthPXRoaXMubm9ybWFsaXplKGEpO2EucHJldmVudERlZmF1bHQmJmEucHJldmVudERlZmF1bHQoKTt0aGlzLmRyYWdTdGFydChhKX0sb25Eb2N1bWVudE1vdXNlVXA6ZnVuY3Rpb24oYSl7JFtvYV0mJiRbb2FdLnBvaW50ZXIuZHJvcChhKX0sb25Eb2N1bWVudE1vdXNlTW92ZTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNoYXJ0LGM9dGhpcy5jaGFydFBvc2l0aW9uLGE9dGhpcy5ub3JtYWxpemUoYSxjKTtjJiYhdGhpcy5pbkNsYXNzKGEudGFyZ2V0LFwiaGlnaGNoYXJ0cy10cmFja2VyXCIpJiYhYi5pc0luc2lkZVBsb3QoYS5jaGFydFgtYi5wbG90TGVmdCxcbmEuY2hhcnRZLWIucGxvdFRvcCkmJnRoaXMucmVzZXQoKX0sb25Db250YWluZXJNb3VzZUxlYXZlOmZ1bmN0aW9uKGEpe3ZhciBiPSRbb2FdO2lmKGImJihhLnJlbGF0ZWRUYXJnZXR8fGEudG9FbGVtZW50KSliLnBvaW50ZXIucmVzZXQoKSxiLnBvaW50ZXIuY2hhcnRQb3NpdGlvbj1udWxsfSxvbkNvbnRhaW5lck1vdXNlTW92ZTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNoYXJ0O2lmKCFzKG9hKXx8ISRbb2FdfHwhJFtvYV0ubW91c2VJc0Rvd24pb2E9Yi5pbmRleDthPXRoaXMubm9ybWFsaXplKGEpO2EucmV0dXJuVmFsdWU9ITE7Yi5tb3VzZUlzRG93bj09PVwibW91c2Vkb3duXCImJnRoaXMuZHJhZyhhKTsodGhpcy5pbkNsYXNzKGEudGFyZ2V0LFwiaGlnaGNoYXJ0cy10cmFja2VyXCIpfHxiLmlzSW5zaWRlUGxvdChhLmNoYXJ0WC1iLnBsb3RMZWZ0LGEuY2hhcnRZLWIucGxvdFRvcCkpJiYhYi5vcGVuTWVudSYmdGhpcy5ydW5Qb2ludEFjdGlvbnMoYSl9LGluQ2xhc3M6ZnVuY3Rpb24oYSxcbmIpe2Zvcih2YXIgYzthOyl7aWYoYz1YKGEsXCJjbGFzc1wiKSl7aWYoYy5pbmRleE9mKGIpIT09LTEpcmV0dXJuITA7aWYoYy5pbmRleE9mKFwiaGlnaGNoYXJ0cy1jb250YWluZXJcIikhPT0tMSlyZXR1cm4hMX1hPWEucGFyZW50Tm9kZX19LG9uVHJhY2tlck1vdXNlT3V0OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY2hhcnQuaG92ZXJTZXJpZXMsYT1hLnJlbGF0ZWRUYXJnZXR8fGEudG9FbGVtZW50O2lmKGImJmEmJiFiLm9wdGlvbnMuc3RpY2t5VHJhY2tpbmcmJiF0aGlzLmluQ2xhc3MoYSxcImhpZ2hjaGFydHMtdG9vbHRpcFwiKSYmIXRoaXMuaW5DbGFzcyhhLFwiaGlnaGNoYXJ0cy1zZXJpZXMtXCIrYi5pbmRleCkpYi5vbk1vdXNlT3V0KCl9LG9uQ29udGFpbmVyQ2xpY2s6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jaGFydCxjPWIuaG92ZXJQb2ludCxkPWIucGxvdExlZnQsZT1iLnBsb3RUb3AsYT10aGlzLm5vcm1hbGl6ZShhKTtiLmNhbmNlbENsaWNrfHwoYyYmdGhpcy5pbkNsYXNzKGEudGFyZ2V0LFxuXCJoaWdoY2hhcnRzLXRyYWNrZXJcIik/KE0oYy5zZXJpZXMsXCJjbGlja1wiLHgoYSx7cG9pbnQ6Y30pKSxiLmhvdmVyUG9pbnQmJmMuZmlyZVBvaW50RXZlbnQoXCJjbGlja1wiLGEpKTooeChhLHRoaXMuZ2V0Q29vcmRpbmF0ZXMoYSkpLGIuaXNJbnNpZGVQbG90KGEuY2hhcnRYLWQsYS5jaGFydFktZSkmJk0oYixcImNsaWNrXCIsYSkpKX0sc2V0RE9NRXZlbnRzOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEuY2hhcnQuY29udGFpbmVyO2Iub25tb3VzZWRvd249ZnVuY3Rpb24oYil7YS5vbkNvbnRhaW5lck1vdXNlRG93bihiKX07Yi5vbm1vdXNlbW92ZT1mdW5jdGlvbihiKXthLm9uQ29udGFpbmVyTW91c2VNb3ZlKGIpfTtiLm9uY2xpY2s9ZnVuY3Rpb24oYil7YS5vbkNvbnRhaW5lckNsaWNrKGIpfTtEKGIsXCJtb3VzZWxlYXZlXCIsYS5vbkNvbnRhaW5lck1vdXNlTGVhdmUpO2xiPT09MSYmRChCLFwibW91c2V1cFwiLGEub25Eb2N1bWVudE1vdXNlVXApO2lmKGRiKWIub250b3VjaHN0YXJ0PWZ1bmN0aW9uKGIpe2Eub25Db250YWluZXJUb3VjaFN0YXJ0KGIpfSxcbmIub250b3VjaG1vdmU9ZnVuY3Rpb24oYil7YS5vbkNvbnRhaW5lclRvdWNoTW92ZShiKX0sbGI9PT0xJiZEKEIsXCJ0b3VjaGVuZFwiLGEub25Eb2N1bWVudFRvdWNoRW5kKX0sZGVzdHJveTpmdW5jdGlvbigpe3ZhciBhO1QodGhpcy5jaGFydC5jb250YWluZXIsXCJtb3VzZWxlYXZlXCIsdGhpcy5vbkNvbnRhaW5lck1vdXNlTGVhdmUpO2xifHwoVChCLFwibW91c2V1cFwiLHRoaXMub25Eb2N1bWVudE1vdXNlVXApLFQoQixcInRvdWNoZW5kXCIsdGhpcy5vbkRvY3VtZW50VG91Y2hFbmQpKTtjbGVhckludGVydmFsKHRoaXMudG9vbHRpcFRpbWVvdXQpO2ZvcihhIGluIHRoaXMpdGhpc1thXT1udWxsfX07eCh6LlBvaW50ZXIucHJvdG90eXBlLHtwaW5jaFRyYW5zbGF0ZTpmdW5jdGlvbihhLGIsYyxkLGUsZil7KHRoaXMuem9vbUhvcnx8dGhpcy5waW5jaEhvcikmJnRoaXMucGluY2hUcmFuc2xhdGVEaXJlY3Rpb24oITAsYSxiLGMsZCxlLGYpOyh0aGlzLnpvb21WZXJ0fHx0aGlzLnBpbmNoVmVydCkmJlxudGhpcy5waW5jaFRyYW5zbGF0ZURpcmVjdGlvbighMSxhLGIsYyxkLGUsZil9LHBpbmNoVHJhbnNsYXRlRGlyZWN0aW9uOmZ1bmN0aW9uKGEsYixjLGQsZSxmLGcsaCl7dmFyIGk9dGhpcy5jaGFydCxqPWE/XCJ4XCI6XCJ5XCIsaz1hP1wiWFwiOlwiWVwiLGw9XCJjaGFydFwiK2ssbT1hP1wid2lkdGhcIjpcImhlaWdodFwiLG89aVtcInBsb3RcIisoYT9cIkxlZnRcIjpcIlRvcFwiKV0scCxyLEE9aHx8MSxxPWkuaW52ZXJ0ZWQsbj1pLmJvdW5kc1thP1wiaFwiOlwidlwiXSx3PWIubGVuZ3RoPT09MSxPPWJbMF1bbF0scz1jWzBdW2xdLHY9IXcmJmJbMV1bbF0sdD0hdyYmY1sxXVtsXSx5LGM9ZnVuY3Rpb24oKXshdyYmUyhPLXYpPjIwJiYoQT1ofHxTKHMtdCkvUyhPLXYpKTtyPShvLXMpL0ErTztwPWlbXCJwbG90XCIrKGE/XCJXaWR0aFwiOlwiSGVpZ2h0XCIpXS9BfTtjKCk7Yj1yO2I8bi5taW4/KGI9bi5taW4seT0hMCk6YitwPm4ubWF4JiYoYj1uLm1heC1wLHk9ITApO3k/KHMtPTAuOCoocy1nW2pdWzBdKSx3fHwodC09MC44Kih0LVxuZ1tqXVsxXSkpLGMoKSk6Z1tqXT1bcyx0XTtxfHwoZltqXT1yLW8sZlttXT1wKTtmPXE/MS9BOkE7ZVttXT1wO2Vbal09YjtkW3E/YT9cInNjYWxlWVwiOlwic2NhbGVYXCI6XCJzY2FsZVwiK2tdPUE7ZFtcInRyYW5zbGF0ZVwiK2tdPWYqbysocy1mKk8pfSxwaW5jaDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLGM9Yi5jaGFydCxkPWIucGluY2hEb3duLGU9YS50b3VjaGVzLGY9ZS5sZW5ndGgsZz1iLmxhc3RWYWxpZFRvdWNoLGg9Yi5oYXNab29tLGk9Yi5zZWxlY3Rpb25NYXJrZXIsaj17fSxrPWY9PT0xJiYoYi5pbkNsYXNzKGEudGFyZ2V0LFwiaGlnaGNoYXJ0cy10cmFja2VyXCIpJiZjLnJ1blRyYWNrZXJDbGlja3x8Yi5ydW5DaGFydENsaWNrKSxsPXt9O2lmKGY+MSliLmluaXRpYXRlZD0hMDtoJiZiLmluaXRpYXRlZCYmIWsmJmEucHJldmVudERlZmF1bHQoKTt0YShlLGZ1bmN0aW9uKGEpe3JldHVybiBiLm5vcm1hbGl6ZShhKX0pO2lmKGEudHlwZT09PVwidG91Y2hzdGFydFwiKW4oZSxmdW5jdGlvbihhLFxuYil7ZFtiXT17Y2hhcnRYOmEuY2hhcnRYLGNoYXJ0WTphLmNoYXJ0WX19KSxnLng9W2RbMF0uY2hhcnRYLGRbMV0mJmRbMV0uY2hhcnRYXSxnLnk9W2RbMF0uY2hhcnRZLGRbMV0mJmRbMV0uY2hhcnRZXSxuKGMuYXhlcyxmdW5jdGlvbihhKXtpZihhLnpvb21FbmFibGVkKXt2YXIgYj1jLmJvdW5kc1thLmhvcml6P1wiaFwiOlwidlwiXSxkPWEubWluUGl4ZWxQYWRkaW5nLGU9YS50b1BpeGVscyhxKGEub3B0aW9ucy5taW4sYS5kYXRhTWluKSksZj1hLnRvUGl4ZWxzKHEoYS5vcHRpb25zLm1heCxhLmRhdGFNYXgpKSxnPUUoZSxmKSxlPXYoZSxmKTtiLm1pbj1FKGEucG9zLGctZCk7Yi5tYXg9dihhLnBvcythLmxlbixlK2QpfX0pLGIucmVzPSEwO2Vsc2UgaWYoZC5sZW5ndGgpe2lmKCFpKWIuc2VsZWN0aW9uTWFya2VyPWk9eCh7ZGVzdHJveTpyYSx0b3VjaDohMH0sYy5wbG90Qm94KTtiLnBpbmNoVHJhbnNsYXRlKGQsZSxqLGksbCxnKTtiLmhhc1BpbmNoZWQ9aDtiLnNjYWxlR3JvdXBzKGosXG5sKTtpZighaCYmYi5mb2xsb3dUb3VjaE1vdmUmJmY9PT0xKXRoaXMucnVuUG9pbnRBY3Rpb25zKGIubm9ybWFsaXplKGEpKTtlbHNlIGlmKGIucmVzKWIucmVzPSExLHRoaXMucmVzZXQoITEsMCl9fSx0b3VjaDpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuY2hhcnQsZDtvYT1jLmluZGV4O2lmKGEudG91Y2hlcy5sZW5ndGg9PT0xKWlmKGE9dGhpcy5ub3JtYWxpemUoYSksYy5pc0luc2lkZVBsb3QoYS5jaGFydFgtYy5wbG90TGVmdCxhLmNoYXJ0WS1jLnBsb3RUb3ApJiYhYy5vcGVuTWVudSl7YiYmdGhpcy5ydW5Qb2ludEFjdGlvbnMoYSk7aWYoYS50eXBlPT09XCJ0b3VjaG1vdmVcIiljPXRoaXMucGluY2hEb3duLGQ9TWF0aC5zcXJ0KE1hdGgucG93KGNbMF0uY2hhcnRYLWEuY2hhcnRYLDIpK01hdGgucG93KGNbMF0uY2hhcnRZLWEuY2hhcnRZLDIpKT49NDtxKGQsITApJiZ0aGlzLnBpbmNoKGEpfWVsc2UgYiYmdGhpcy5yZXNldCgpO2Vsc2UgYS50b3VjaGVzLmxlbmd0aD09PTImJlxudGhpcy5waW5jaChhKX0sb25Db250YWluZXJUb3VjaFN0YXJ0OmZ1bmN0aW9uKGEpe3RoaXMudG91Y2goYSwhMCl9LG9uQ29udGFpbmVyVG91Y2hNb3ZlOmZ1bmN0aW9uKGEpe3RoaXMudG91Y2goYSl9LG9uRG9jdW1lbnRUb3VjaEVuZDpmdW5jdGlvbihhKXskW29hXSYmJFtvYV0ucG9pbnRlci5kcm9wKGEpfX0pO2lmKEouUG9pbnRlckV2ZW50fHxKLk1TUG9pbnRlckV2ZW50KXt2YXIgR2E9e30sTWI9ISFKLlBvaW50ZXJFdmVudCxhYz1mdW5jdGlvbigpe3ZhciBhLGI9W107Yi5pdGVtPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzW2FdfTtmb3IoYSBpbiBHYSlHYS5oYXNPd25Qcm9wZXJ0eShhKSYmYi5wdXNoKHtwYWdlWDpHYVthXS5wYWdlWCxwYWdlWTpHYVthXS5wYWdlWSx0YXJnZXQ6R2FbYV0udGFyZ2V0fSk7cmV0dXJuIGJ9LE5iPWZ1bmN0aW9uKGEsYixjLGQpe2lmKChhLnBvaW50ZXJUeXBlPT09XCJ0b3VjaFwifHxhLnBvaW50ZXJUeXBlPT09YS5NU1BPSU5URVJfVFlQRV9UT1VDSCkmJlxuJFtvYV0pZChhKSxkPSRbb2FdLnBvaW50ZXIsZFtiXSh7dHlwZTpjLHRhcmdldDphLmN1cnJlbnRUYXJnZXQscHJldmVudERlZmF1bHQ6cmEsdG91Y2hlczphYygpfSl9O3goWmEucHJvdG90eXBlLHtvbkNvbnRhaW5lclBvaW50ZXJEb3duOmZ1bmN0aW9uKGEpe05iKGEsXCJvbkNvbnRhaW5lclRvdWNoU3RhcnRcIixcInRvdWNoc3RhcnRcIixmdW5jdGlvbihhKXtHYVthLnBvaW50ZXJJZF09e3BhZ2VYOmEucGFnZVgscGFnZVk6YS5wYWdlWSx0YXJnZXQ6YS5jdXJyZW50VGFyZ2V0fX0pfSxvbkNvbnRhaW5lclBvaW50ZXJNb3ZlOmZ1bmN0aW9uKGEpe05iKGEsXCJvbkNvbnRhaW5lclRvdWNoTW92ZVwiLFwidG91Y2htb3ZlXCIsZnVuY3Rpb24oYSl7R2FbYS5wb2ludGVySWRdPXtwYWdlWDphLnBhZ2VYLHBhZ2VZOmEucGFnZVl9O2lmKCFHYVthLnBvaW50ZXJJZF0udGFyZ2V0KUdhW2EucG9pbnRlcklkXS50YXJnZXQ9YS5jdXJyZW50VGFyZ2V0fSl9LG9uRG9jdW1lbnRQb2ludGVyVXA6ZnVuY3Rpb24oYSl7TmIoYSxcblwib25Eb2N1bWVudFRvdWNoRW5kXCIsXCJ0b3VjaGVuZFwiLGZ1bmN0aW9uKGEpe2RlbGV0ZSBHYVthLnBvaW50ZXJJZF19KX0sYmF0Y2hNU0V2ZW50czpmdW5jdGlvbihhKXthKHRoaXMuY2hhcnQuY29udGFpbmVyLE1iP1wicG9pbnRlcmRvd25cIjpcIk1TUG9pbnRlckRvd25cIix0aGlzLm9uQ29udGFpbmVyUG9pbnRlckRvd24pO2EodGhpcy5jaGFydC5jb250YWluZXIsTWI/XCJwb2ludGVybW92ZVwiOlwiTVNQb2ludGVyTW92ZVwiLHRoaXMub25Db250YWluZXJQb2ludGVyTW92ZSk7YShCLE1iP1wicG9pbnRlcnVwXCI6XCJNU1BvaW50ZXJVcFwiLHRoaXMub25Eb2N1bWVudFBvaW50ZXJVcCl9fSk7VShaYS5wcm90b3R5cGUsXCJpbml0XCIsZnVuY3Rpb24oYSxiLGMpe2EuY2FsbCh0aGlzLGIsYyk7dGhpcy5oYXNab29tJiZGKGIuY29udGFpbmVyLHtcIi1tcy10b3VjaC1hY3Rpb25cIjpcIm5vbmVcIixcInRvdWNoLWFjdGlvblwiOlwibm9uZVwifSl9KTtVKFphLnByb3RvdHlwZSxcInNldERPTUV2ZW50c1wiLGZ1bmN0aW9uKGEpe2EuYXBwbHkodGhpcyk7XG4odGhpcy5oYXNab29tfHx0aGlzLmZvbGxvd1RvdWNoTW92ZSkmJnRoaXMuYmF0Y2hNU0V2ZW50cyhEKX0pO1UoWmEucHJvdG90eXBlLFwiZGVzdHJveVwiLGZ1bmN0aW9uKGEpe3RoaXMuYmF0Y2hNU0V2ZW50cyhUKTthLmNhbGwodGhpcyl9KX12YXIgdmI9ei5MZWdlbmQ9ZnVuY3Rpb24oYSxiKXt0aGlzLmluaXQoYSxiKX07dmIucHJvdG90eXBlPXtpbml0OmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcyxkPWIuaXRlbVN0eWxlLGU9Yi5pdGVtTWFyZ2luVG9wfHwwO3RoaXMub3B0aW9ucz1iO2lmKGIuZW5hYmxlZCljLml0ZW1TdHlsZT1kLGMuaXRlbUhpZGRlblN0eWxlPUMoZCxiLml0ZW1IaWRkZW5TdHlsZSksYy5pdGVtTWFyZ2luVG9wPWUsYy5wYWRkaW5nPWQ9cShiLnBhZGRpbmcsOCksYy5pbml0aWFsSXRlbVg9ZCxjLmluaXRpYWxJdGVtWT1kLTUsYy5tYXhJdGVtV2lkdGg9MCxjLmNoYXJ0PWEsYy5pdGVtSGVpZ2h0PTAsYy5zeW1ib2xXaWR0aD1xKGIuc3ltYm9sV2lkdGgsMTYpLFxuYy5wYWdlcz1bXSxjLnJlbmRlcigpLEQoYy5jaGFydCxcImVuZFJlc2l6ZVwiLGZ1bmN0aW9uKCl7Yy5wb3NpdGlvbkNoZWNrYm94ZXMoKX0pfSxjb2xvcml6ZUl0ZW06ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLm9wdGlvbnMsZD1hLmxlZ2VuZEl0ZW0sZT1hLmxlZ2VuZExpbmUsZj1hLmxlZ2VuZFN5bWJvbCxnPXRoaXMuaXRlbUhpZGRlblN0eWxlLmNvbG9yLGM9Yj9jLml0ZW1TdHlsZS5jb2xvcjpnLGg9Yj9hLmxlZ2VuZENvbG9yfHxhLmNvbG9yfHxcIiNDQ0NcIjpnLGc9YS5vcHRpb25zJiZhLm9wdGlvbnMubWFya2VyLGk9e2ZpbGw6aH0sajtkJiZkLmNzcyh7ZmlsbDpjLGNvbG9yOmN9KTtlJiZlLmF0dHIoe3N0cm9rZTpofSk7aWYoZil7aWYoZyYmZi5pc01hcmtlcilmb3IoaiBpbiBpLnN0cm9rZT1oLGc9YS5jb252ZXJ0QXR0cmlicyhnKSxnKWQ9Z1tqXSxkIT09dCYmKGlbal09ZCk7Zi5hdHRyKGkpfX0scG9zaXRpb25JdGVtOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMub3B0aW9ucyxcbmM9Yi5zeW1ib2xQYWRkaW5nLGI9IWIucnRsLGQ9YS5fbGVnZW5kSXRlbVBvcyxlPWRbMF0sZD1kWzFdLGY9YS5jaGVja2JveDsoYT1hLmxlZ2VuZEdyb3VwKSYmYS5lbGVtZW50JiZhLnRyYW5zbGF0ZShiP2U6dGhpcy5sZWdlbmRXaWR0aC1lLTIqYy00LGQpO2lmKGYpZi54PWUsZi55PWR9LGRlc3Ryb3lJdGVtOmZ1bmN0aW9uKGEpe3ZhciBiPWEuY2hlY2tib3g7bihbXCJsZWdlbmRJdGVtXCIsXCJsZWdlbmRMaW5lXCIsXCJsZWdlbmRTeW1ib2xcIixcImxlZ2VuZEdyb3VwXCJdLGZ1bmN0aW9uKGIpe2FbYl0mJihhW2JdPWFbYl0uZGVzdHJveSgpKX0pO2ImJlZhKGEuY2hlY2tib3gpfSxkZXN0cm95OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5ncm91cCxiPXRoaXMuYm94O2lmKGIpdGhpcy5ib3g9Yi5kZXN0cm95KCk7aWYoYSl0aGlzLmdyb3VwPWEuZGVzdHJveSgpfSxwb3NpdGlvbkNoZWNrYm94ZXM6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5ncm91cC5hbGlnbkF0dHIsYyxkPXRoaXMuY2xpcEhlaWdodHx8XG50aGlzLmxlZ2VuZEhlaWdodCxlPXRoaXMudGl0bGVIZWlnaHQ7aWYoYiljPWIudHJhbnNsYXRlWSxuKHRoaXMuYWxsSXRlbXMsZnVuY3Rpb24oZil7dmFyIGc9Zi5jaGVja2JveCxoO2cmJihoPWMrZStnLnkrKGF8fDApKzMsRihnLHtsZWZ0OmIudHJhbnNsYXRlWCtmLmNoZWNrYm94T2Zmc2V0K2cueC0yMCtcInB4XCIsdG9wOmgrXCJweFwiLGRpc3BsYXk6aD5jLTYmJmg8YytkLTY/XCJcIjpcIm5vbmVcIn0pKX0pfSxyZW5kZXJUaXRsZTpmdW5jdGlvbigpe3ZhciBhPXRoaXMucGFkZGluZyxiPXRoaXMub3B0aW9ucy50aXRsZSxjPTA7aWYoYi50ZXh0KXtpZighdGhpcy50aXRsZSl0aGlzLnRpdGxlPXRoaXMuY2hhcnQucmVuZGVyZXIubGFiZWwoYi50ZXh0LGEtMyxhLTQsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLFwibGVnZW5kLXRpdGxlXCIpLmF0dHIoe3pJbmRleDoxfSkuY3NzKGIuc3R5bGUpLmFkZCh0aGlzLmdyb3VwKTthPXRoaXMudGl0bGUuZ2V0QkJveCgpO2M9YS5oZWlnaHQ7dGhpcy5vZmZzZXRXaWR0aD1cbmEud2lkdGg7dGhpcy5jb250ZW50R3JvdXAuYXR0cih7dHJhbnNsYXRlWTpjfSl9dGhpcy50aXRsZUhlaWdodD1jfSxzZXRUZXh0OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMub3B0aW9uczthLmxlZ2VuZEl0ZW0uYXR0cih7dGV4dDpiLmxhYmVsRm9ybWF0P0xhKGIubGFiZWxGb3JtYXQsYSk6Yi5sYWJlbEZvcm1hdHRlci5jYWxsKGEpfSl9LHJlbmRlckl0ZW06ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jaGFydCxjPWIucmVuZGVyZXIsZD10aGlzLm9wdGlvbnMsZT1kLmxheW91dD09PVwiaG9yaXpvbnRhbFwiLGY9dGhpcy5zeW1ib2xXaWR0aCxnPWQuc3ltYm9sUGFkZGluZyxoPXRoaXMuaXRlbVN0eWxlLGk9dGhpcy5pdGVtSGlkZGVuU3R5bGUsaj10aGlzLnBhZGRpbmcsaz1lP3EoZC5pdGVtRGlzdGFuY2UsMjApOjAsbD0hZC5ydGwsbT1kLndpZHRoLG89ZC5pdGVtTWFyZ2luQm90dG9tfHwwLHA9dGhpcy5pdGVtTWFyZ2luVG9wLHI9dGhpcy5pbml0aWFsSXRlbVgsQT1hLmxlZ2VuZEl0ZW0sXG5uPWEuc2VyaWVzJiZhLnNlcmllcy5kcmF3TGVnZW5kU3ltYm9sP2Euc2VyaWVzOmEsdT1uLm9wdGlvbnMsdT10aGlzLmNyZWF0ZUNoZWNrYm94Rm9ySXRlbSYmdSYmdS5zaG93Q2hlY2tib3gsdz1kLnVzZUhUTUw7aWYoIUEpe2EubGVnZW5kR3JvdXA9Yy5nKFwibGVnZW5kLWl0ZW1cIikuYXR0cih7ekluZGV4OjF9KS5hZGQodGhpcy5zY3JvbGxHcm91cCk7YS5sZWdlbmRJdGVtPUE9Yy50ZXh0KFwiXCIsbD9mK2c6LWcsdGhpcy5iYXNlbGluZXx8MCx3KS5jc3MoQyhhLnZpc2libGU/aDppKSkuYXR0cih7YWxpZ246bD9cImxlZnRcIjpcInJpZ2h0XCIsekluZGV4OjJ9KS5hZGQoYS5sZWdlbmRHcm91cCk7aWYoIXRoaXMuYmFzZWxpbmUpdGhpcy5mb250TWV0cmljcz1jLmZvbnRNZXRyaWNzKGguZm9udFNpemUsQSksdGhpcy5iYXNlbGluZT10aGlzLmZvbnRNZXRyaWNzLmYrMytwLEEuYXR0cihcInlcIix0aGlzLmJhc2VsaW5lKTtuLmRyYXdMZWdlbmRTeW1ib2wodGhpcyxhKTt0aGlzLnNldEl0ZW1FdmVudHMmJlxudGhpcy5zZXRJdGVtRXZlbnRzKGEsQSx3LGgsaSk7dSYmdGhpcy5jcmVhdGVDaGVja2JveEZvckl0ZW0oYSl9dGhpcy5jb2xvcml6ZUl0ZW0oYSxhLnZpc2libGUpO3RoaXMuc2V0VGV4dChhKTtjPUEuZ2V0QkJveCgpO2Y9YS5jaGVja2JveE9mZnNldD1kLml0ZW1XaWR0aHx8YS5sZWdlbmRJdGVtV2lkdGh8fGYrZytjLndpZHRoK2srKHU/MjA6MCk7dGhpcy5pdGVtSGVpZ2h0PWc9eShhLmxlZ2VuZEl0ZW1IZWlnaHR8fGMuaGVpZ2h0KTtpZihlJiZ0aGlzLml0ZW1YLXIrZj4obXx8Yi5jaGFydFdpZHRoLTIqai1yLWQueCkpdGhpcy5pdGVtWD1yLHRoaXMuaXRlbVkrPXArdGhpcy5sYXN0TGluZUhlaWdodCtvLHRoaXMubGFzdExpbmVIZWlnaHQ9MDt0aGlzLm1heEl0ZW1XaWR0aD12KHRoaXMubWF4SXRlbVdpZHRoLGYpO3RoaXMubGFzdEl0ZW1ZPXArdGhpcy5pdGVtWStvO3RoaXMubGFzdExpbmVIZWlnaHQ9dihnLHRoaXMubGFzdExpbmVIZWlnaHQpO2EuX2xlZ2VuZEl0ZW1Qb3M9XG5bdGhpcy5pdGVtWCx0aGlzLml0ZW1ZXTtlP3RoaXMuaXRlbVgrPWY6KHRoaXMuaXRlbVkrPXArZytvLHRoaXMubGFzdExpbmVIZWlnaHQ9Zyk7dGhpcy5vZmZzZXRXaWR0aD1tfHx2KChlP3RoaXMuaXRlbVgtci1rOmYpK2osdGhpcy5vZmZzZXRXaWR0aCl9LGdldEFsbEl0ZW1zOmZ1bmN0aW9uKCl7dmFyIGE9W107bih0aGlzLmNoYXJ0LnNlcmllcyxmdW5jdGlvbihiKXt2YXIgYz1iLm9wdGlvbnM7aWYocShjLnNob3dJbkxlZ2VuZCwhcyhjLmxpbmtlZFRvKT90OiExLCEwKSlhPWEuY29uY2F0KGIubGVnZW5kSXRlbXN8fChjLmxlZ2VuZFR5cGU9PT1cInBvaW50XCI/Yi5kYXRhOmIpKX0pO3JldHVybiBhfSxhZGp1c3RNYXJnaW5zOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5jaGFydCxkPXRoaXMub3B0aW9ucyxlPWQuYWxpZ24uY2hhckF0KDApK2QudmVydGljYWxBbGlnbi5jaGFyQXQoMCkrZC5sYXlvdXQuY2hhckF0KDApO3RoaXMuZGlzcGxheSYmIWQuZmxvYXRpbmcmJm4oWy8obHRofGN0fHJ0aCkvLFxuLyhydHZ8cm18cmJ2KS8sLyhyYmh8Y2J8bGJoKS8sLyhsYnZ8bG18bHR2KS9dLGZ1bmN0aW9uKGYsZyl7Zi50ZXN0KGUpJiYhcyhhW2ddKSYmKGNbdWJbZ11dPXYoY1t1YltnXV0sYy5sZWdlbmRbKGcrMSklMj9cImxlZ2VuZEhlaWdodFwiOlwibGVnZW5kV2lkdGhcIl0rWzEsLTEsLTEsMV1bZ10qZFtnJTI/XCJ4XCI6XCJ5XCJdK3EoZC5tYXJnaW4sMTIpK2JbZ10pKX0pfSxyZW5kZXI6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5jaGFydCxjPWIucmVuZGVyZXIsZD1hLmdyb3VwLGUsZixnLGgsaT1hLmJveCxqPWEub3B0aW9ucyxrPWEucGFkZGluZyxsPWouYm9yZGVyV2lkdGgsbT1qLmJhY2tncm91bmRDb2xvcjthLml0ZW1YPWEuaW5pdGlhbEl0ZW1YO2EuaXRlbVk9YS5pbml0aWFsSXRlbVk7YS5vZmZzZXRXaWR0aD0wO2EubGFzdEl0ZW1ZPTA7aWYoIWQpYS5ncm91cD1kPWMuZyhcImxlZ2VuZFwiKS5hdHRyKHt6SW5kZXg6N30pLmFkZCgpLGEuY29udGVudEdyb3VwPWMuZygpLmF0dHIoe3pJbmRleDoxfSkuYWRkKGQpLFxuYS5zY3JvbGxHcm91cD1jLmcoKS5hZGQoYS5jb250ZW50R3JvdXApO2EucmVuZGVyVGl0bGUoKTtlPWEuZ2V0QWxsSXRlbXMoKTtvYihlLGZ1bmN0aW9uKGEsYil7cmV0dXJuKGEub3B0aW9ucyYmYS5vcHRpb25zLmxlZ2VuZEluZGV4fHwwKS0oYi5vcHRpb25zJiZiLm9wdGlvbnMubGVnZW5kSW5kZXh8fDApfSk7ai5yZXZlcnNlZCYmZS5yZXZlcnNlKCk7YS5hbGxJdGVtcz1lO2EuZGlzcGxheT1mPSEhZS5sZW5ndGg7YS5sYXN0TGluZUhlaWdodD0wO24oZSxmdW5jdGlvbihiKXthLnJlbmRlckl0ZW0oYil9KTtnPShqLndpZHRofHxhLm9mZnNldFdpZHRoKStrO2g9YS5sYXN0SXRlbVkrYS5sYXN0TGluZUhlaWdodCthLnRpdGxlSGVpZ2h0O2g9YS5oYW5kbGVPdmVyZmxvdyhoKTtoKz1rO2lmKGx8fG0pe2lmKGkpe2lmKGc+MCYmaD4wKWlbaS5pc05ldz9cImF0dHJcIjpcImFuaW1hdGVcIl0oaS5jcmlzcCh7d2lkdGg6ZyxoZWlnaHQ6aH0pKSxpLmlzTmV3PSExfWVsc2UgYS5ib3g9aT1jLnJlY3QoMCxcbjAsZyxoLGouYm9yZGVyUmFkaXVzLGx8fDApLmF0dHIoe3N0cm9rZTpqLmJvcmRlckNvbG9yLFwic3Ryb2tlLXdpZHRoXCI6bHx8MCxmaWxsOm18fFwibm9uZVwifSkuYWRkKGQpLnNoYWRvdyhqLnNoYWRvdyksaS5pc05ldz0hMDtpW2Y/XCJzaG93XCI6XCJoaWRlXCJdKCl9YS5sZWdlbmRXaWR0aD1nO2EubGVnZW5kSGVpZ2h0PWg7bihlLGZ1bmN0aW9uKGIpe2EucG9zaXRpb25JdGVtKGIpfSk7ZiYmZC5hbGlnbih4KHt3aWR0aDpnLGhlaWdodDpofSxqKSwhMCxcInNwYWNpbmdCb3hcIik7Yi5pc1Jlc2l6aW5nfHx0aGlzLnBvc2l0aW9uQ2hlY2tib3hlcygpfSxoYW5kbGVPdmVyZmxvdzpmdW5jdGlvbihhKXt2YXIgYj10aGlzLGM9dGhpcy5jaGFydCxkPWMucmVuZGVyZXIsZT10aGlzLm9wdGlvbnMsZj1lLnksZj1jLnNwYWNpbmdCb3guaGVpZ2h0KyhlLnZlcnRpY2FsQWxpZ249PT1cInRvcFwiPy1mOmYpLXRoaXMucGFkZGluZyxnPWUubWF4SGVpZ2h0LGgsaT10aGlzLmNsaXBSZWN0LGo9ZS5uYXZpZ2F0aW9uLFxuaz1xKGouYW5pbWF0aW9uLCEwKSxsPWouYXJyb3dTaXplfHwxMixtPXRoaXMubmF2LG89dGhpcy5wYWdlcyxwPXRoaXMucGFkZGluZyxyLEE9dGhpcy5hbGxJdGVtcyxQPWZ1bmN0aW9uKGEpe2kuYXR0cih7aGVpZ2h0OmF9KTtpZihiLmNvbnRlbnRHcm91cC5kaXYpYi5jb250ZW50R3JvdXAuZGl2LnN0eWxlLmNsaXA9XCJyZWN0KFwiK3ArXCJweCw5OTk5cHgsXCIrKHArYSkrXCJweCwwKVwifTtlLmxheW91dD09PVwiaG9yaXpvbnRhbFwiJiYoZi89Mik7ZyYmKGY9RShmLGcpKTtvLmxlbmd0aD0wO2lmKGE+ZiYmai5lbmFibGVkIT09ITEpe3RoaXMuY2xpcEhlaWdodD1oPXYoZi0yMC10aGlzLnRpdGxlSGVpZ2h0LXAsMCk7dGhpcy5jdXJyZW50UGFnZT1xKHRoaXMuY3VycmVudFBhZ2UsMSk7dGhpcy5mdWxsSGVpZ2h0PWE7bihBLGZ1bmN0aW9uKGEsYil7dmFyIGM9YS5fbGVnZW5kSXRlbVBvc1sxXSxkPXkoYS5sZWdlbmRJdGVtLmdldEJCb3goKS5oZWlnaHQpLGU9by5sZW5ndGg7aWYoIWV8fGMtXG5vW2UtMV0+aCYmKHJ8fGMpIT09b1tlLTFdKW8ucHVzaChyfHxjKSxlKys7Yj09PUEubGVuZ3RoLTEmJmMrZC1vW2UtMV0+aCYmby5wdXNoKGMpO2MhPT1yJiYocj1jKX0pO2lmKCFpKWk9Yi5jbGlwUmVjdD1kLmNsaXBSZWN0KDAscCw5OTk5LDApLGIuY29udGVudEdyb3VwLmNsaXAoaSk7UChoKTtpZighbSl0aGlzLm5hdj1tPWQuZygpLmF0dHIoe3pJbmRleDoxfSkuYWRkKHRoaXMuZ3JvdXApLHRoaXMudXA9ZC5zeW1ib2woXCJ0cmlhbmdsZVwiLDAsMCxsLGwpLm9uKFwiY2xpY2tcIixmdW5jdGlvbigpe2Iuc2Nyb2xsKC0xLGspfSkuYWRkKG0pLHRoaXMucGFnZXI9ZC50ZXh0KFwiXCIsMTUsMTApLmNzcyhqLnN0eWxlKS5hZGQobSksdGhpcy5kb3duPWQuc3ltYm9sKFwidHJpYW5nbGUtZG93blwiLDAsMCxsLGwpLm9uKFwiY2xpY2tcIixmdW5jdGlvbigpe2Iuc2Nyb2xsKDEsayl9KS5hZGQobSk7Yi5zY3JvbGwoMCk7YT1mfWVsc2UgaWYobSlQKGMuY2hhcnRIZWlnaHQpLG0uaGlkZSgpLHRoaXMuc2Nyb2xsR3JvdXAuYXR0cih7dHJhbnNsYXRlWToxfSksXG50aGlzLmNsaXBIZWlnaHQ9MDtyZXR1cm4gYX0sc2Nyb2xsOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5wYWdlcyxkPWMubGVuZ3RoLGU9dGhpcy5jdXJyZW50UGFnZSthLGY9dGhpcy5jbGlwSGVpZ2h0LGc9dGhpcy5vcHRpb25zLm5hdmlnYXRpb24saD1nLmFjdGl2ZUNvbG9yLGc9Zy5pbmFjdGl2ZUNvbG9yLGk9dGhpcy5wYWdlcixqPXRoaXMucGFkZGluZztlPmQmJihlPWQpO2lmKGU+MCliIT09dCYmYWIoYix0aGlzLmNoYXJ0KSx0aGlzLm5hdi5hdHRyKHt0cmFuc2xhdGVYOmosdHJhbnNsYXRlWTpmK3RoaXMucGFkZGluZys3K3RoaXMudGl0bGVIZWlnaHQsdmlzaWJpbGl0eTpcInZpc2libGVcIn0pLHRoaXMudXAuYXR0cih7ZmlsbDplPT09MT9nOmh9KS5jc3Moe2N1cnNvcjplPT09MT9cImRlZmF1bHRcIjpcInBvaW50ZXJcIn0pLGkuYXR0cih7dGV4dDplK1wiL1wiK2R9KSx0aGlzLmRvd24uYXR0cih7eDoxOCt0aGlzLnBhZ2VyLmdldEJCb3goKS53aWR0aCxmaWxsOmU9PT1kP2c6aH0pLmNzcyh7Y3Vyc29yOmU9PT1cbmQ/XCJkZWZhdWx0XCI6XCJwb2ludGVyXCJ9KSxjPS1jW2UtMV0rdGhpcy5pbml0aWFsSXRlbVksdGhpcy5zY3JvbGxHcm91cC5hbmltYXRlKHt0cmFuc2xhdGVZOmN9KSx0aGlzLmN1cnJlbnRQYWdlPWUsdGhpcy5wb3NpdGlvbkNoZWNrYm94ZXMoYyl9fTthYT16LkxlZ2VuZFN5bWJvbE1peGluPXtkcmF3UmVjdGFuZ2xlOmZ1bmN0aW9uKGEsYil7dmFyIGM9YS5vcHRpb25zLnN5bWJvbEhlaWdodHx8YS5mb250TWV0cmljcy5mO2IubGVnZW5kU3ltYm9sPXRoaXMuY2hhcnQucmVuZGVyZXIucmVjdCgwLGEuYmFzZWxpbmUtYysxLGEuc3ltYm9sV2lkdGgsYyxhLm9wdGlvbnMuc3ltYm9sUmFkaXVzfHwwKS5hdHRyKHt6SW5kZXg6M30pLmFkZChiLmxlZ2VuZEdyb3VwKX0sZHJhd0xpbmVNYXJrZXI6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5vcHRpb25zLGM9Yi5tYXJrZXIsZD1hLnN5bWJvbFdpZHRoLGU9dGhpcy5jaGFydC5yZW5kZXJlcixmPXRoaXMubGVnZW5kR3JvdXAsYT1hLmJhc2VsaW5lLVxueShhLmZvbnRNZXRyaWNzLmIqMC4zKSxnO2lmKGIubGluZVdpZHRoKXtnPXtcInN0cm9rZS13aWR0aFwiOmIubGluZVdpZHRofTtpZihiLmRhc2hTdHlsZSlnLmRhc2hzdHlsZT1iLmRhc2hTdHlsZTt0aGlzLmxlZ2VuZExpbmU9ZS5wYXRoKFtcIk1cIiwwLGEsXCJMXCIsZCxhXSkuYXR0cihnKS5hZGQoZil9aWYoYyYmYy5lbmFibGVkIT09ITEpYj1jLnJhZGl1cyx0aGlzLmxlZ2VuZFN5bWJvbD1jPWUuc3ltYm9sKHRoaXMuc3ltYm9sLGQvMi1iLGEtYiwyKmIsMipiLGMpLmFkZChmKSxjLmlzTWFya2VyPSEwfX07KC9UcmlkZW50XFwvN1xcLjAvLnRlc3QoTWEpfHxYYSkmJlUodmIucHJvdG90eXBlLFwicG9zaXRpb25JdGVtXCIsZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLGQ9ZnVuY3Rpb24oKXtiLl9sZWdlbmRJdGVtUG9zJiZhLmNhbGwoYyxiKX07ZCgpO3NldFRpbWVvdXQoZCl9KTt2YXIgQ2E9ei5DaGFydD1mdW5jdGlvbigpe3RoaXMuZ2V0QXJncy5hcHBseSh0aGlzLGFyZ3VtZW50cyl9O3ouY2hhcnQ9XG5mdW5jdGlvbihhLGIsYyl7cmV0dXJuIG5ldyBDYShhLGIsYyl9O0NhLnByb3RvdHlwZT17Y2FsbGJhY2tzOltdLGdldEFyZ3M6ZnVuY3Rpb24oKXt2YXIgYT1bXS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7aWYoRGEoYVswXSl8fGFbMF0ubm9kZU5hbWUpdGhpcy5yZW5kZXJUbz1hLnNoaWZ0KCk7dGhpcy5pbml0KGFbMF0sYVsxXSl9LGluaXQ6ZnVuY3Rpb24oYSxiKXt2YXIgYyxkPWEuc2VyaWVzO2Euc2VyaWVzPW51bGw7Yz1DKE4sYSk7Yy5zZXJpZXM9YS5zZXJpZXM9ZDt0aGlzLnVzZXJPcHRpb25zPWE7ZD1jLmNoYXJ0O3RoaXMubWFyZ2luPXRoaXMuc3BsYXNoQXJyYXkoXCJtYXJnaW5cIixkKTt0aGlzLnNwYWNpbmc9dGhpcy5zcGxhc2hBcnJheShcInNwYWNpbmdcIixkKTt2YXIgZT1kLmV2ZW50czt0aGlzLmJvdW5kcz17aDp7fSx2Ont9fTt0aGlzLmNhbGxiYWNrPWI7dGhpcy5pc1Jlc2l6aW5nPTA7dGhpcy5vcHRpb25zPWM7dGhpcy5heGVzPVtdO3RoaXMuc2VyaWVzPVtdO3RoaXMuaGFzQ2FydGVzaWFuU2VyaWVzPVxuZC5zaG93QXhlczt2YXIgZj10aGlzLGc7Zi5pbmRleD0kLmxlbmd0aDskLnB1c2goZik7bGIrKztkLnJlZmxvdyE9PSExJiZEKGYsXCJsb2FkXCIsZnVuY3Rpb24oKXtmLmluaXRSZWZsb3coKX0pO2lmKGUpZm9yKGcgaW4gZSlEKGYsZyxlW2ddKTtmLnhBeGlzPVtdO2YueUF4aXM9W107Zi5hbmltYXRpb249cWE/ITE6cShkLmFuaW1hdGlvbiwhMCk7Zi5wb2ludENvdW50PWYuY29sb3JDb3VudGVyPWYuc3ltYm9sQ291bnRlcj0wO2YuZmlyc3RSZW5kZXIoKX0saW5pdFNlcmllczpmdW5jdGlvbihhKXt2YXIgYj10aGlzLm9wdGlvbnMuY2hhcnQ7KGI9S1thLnR5cGV8fGIudHlwZXx8Yi5kZWZhdWx0U2VyaWVzVHlwZV0pfHxnYSgxNywhMCk7Yj1uZXcgYjtiLmluaXQodGhpcyxhKTtyZXR1cm4gYn0saXNJbnNpZGVQbG90OmZ1bmN0aW9uKGEsYixjKXt2YXIgZD1jP2I6YSxhPWM/YTpiO3JldHVybiBkPj0wJiZkPD10aGlzLnBsb3RXaWR0aCYmYT49MCYmYTw9dGhpcy5wbG90SGVpZ2h0fSxcbnJlZHJhdzpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmF4ZXMsYz10aGlzLnNlcmllcyxkPXRoaXMucG9pbnRlcixlPXRoaXMubGVnZW5kLGY9dGhpcy5pc0RpcnR5TGVnZW5kLGcsaCxpPXRoaXMuaGFzQ2FydGVzaWFuU2VyaWVzLGo9dGhpcy5pc0RpcnR5Qm94LGs9Yy5sZW5ndGgsbD1rLG09dGhpcy5yZW5kZXJlcixvPW0uaXNIaWRkZW4oKSxwPVtdO2FiKGEsdGhpcyk7byYmdGhpcy5jbG9uZVJlbmRlclRvKCk7Zm9yKHRoaXMubGF5T3V0VGl0bGVzKCk7bC0tOylpZihhPWNbbF0sYS5vcHRpb25zLnN0YWNraW5nJiYoZz0hMCxhLmlzRGlydHkpKXtoPSEwO2JyZWFrfWlmKGgpZm9yKGw9aztsLS07KWlmKGE9Y1tsXSxhLm9wdGlvbnMuc3RhY2tpbmcpYS5pc0RpcnR5PSEwO24oYyxmdW5jdGlvbihhKXthLmlzRGlydHkmJmEub3B0aW9ucy5sZWdlbmRUeXBlPT09XCJwb2ludFwiJiYoYS51cGRhdGVUb3RhbHMmJmEudXBkYXRlVG90YWxzKCksZj0hMCl9KTtpZihmJiZlLm9wdGlvbnMuZW5hYmxlZCllLnJlbmRlcigpLFxudGhpcy5pc0RpcnR5TGVnZW5kPSExO2cmJnRoaXMuZ2V0U3RhY2tzKCk7aWYoaSYmIXRoaXMuaXNSZXNpemluZyl0aGlzLm1heFRpY2tzPW51bGwsbihiLGZ1bmN0aW9uKGEpe2Euc2V0U2NhbGUoKX0pO3RoaXMuZ2V0TWFyZ2lucygpO2kmJihuKGIsZnVuY3Rpb24oYSl7YS5pc0RpcnR5JiYoaj0hMCl9KSxuKGIsZnVuY3Rpb24oYSl7dmFyIGI9YS5taW4rXCIsXCIrYS5tYXg7aWYoYS5leHRLZXkhPT1iKWEuZXh0S2V5PWIscC5wdXNoKGZ1bmN0aW9uKCl7TShhLFwiYWZ0ZXJTZXRFeHRyZW1lc1wiLHgoYS5ldmVudEFyZ3MsYS5nZXRFeHRyZW1lcygpKSk7ZGVsZXRlIGEuZXZlbnRBcmdzfSk7KGp8fGcpJiZhLnJlZHJhdygpfSkpO2omJnRoaXMuZHJhd0NoYXJ0Qm94KCk7bihjLGZ1bmN0aW9uKGEpe2EuaXNEaXJ0eSYmYS52aXNpYmxlJiYoIWEuaXNDYXJ0ZXNpYW58fGEueEF4aXMpJiZhLnJlZHJhdygpfSk7ZCYmZC5yZXNldCghMCk7bS5kcmF3KCk7TSh0aGlzLFwicmVkcmF3XCIpO28mJnRoaXMuY2xvbmVSZW5kZXJUbyghMCk7XG5uKHAsZnVuY3Rpb24oYSl7YS5jYWxsKCl9KX0sZ2V0OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuYXhlcyxjPXRoaXMuc2VyaWVzLGQsZTtmb3IoZD0wO2Q8Yi5sZW5ndGg7ZCsrKWlmKGJbZF0ub3B0aW9ucy5pZD09PWEpcmV0dXJuIGJbZF07Zm9yKGQ9MDtkPGMubGVuZ3RoO2QrKylpZihjW2RdLm9wdGlvbnMuaWQ9PT1hKXJldHVybiBjW2RdO2ZvcihkPTA7ZDxjLmxlbmd0aDtkKyspe2U9Y1tkXS5wb2ludHN8fFtdO2ZvcihiPTA7YjxlLmxlbmd0aDtiKyspaWYoZVtiXS5pZD09PWEpcmV0dXJuIGVbYl19cmV0dXJuIG51bGx9LGdldEF4ZXM6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9dGhpcy5vcHRpb25zLGM9Yi54QXhpcz12YShiLnhBeGlzfHx7fSksYj1iLnlBeGlzPXZhKGIueUF4aXN8fHt9KTtuKGMsZnVuY3Rpb24oYSxiKXthLmluZGV4PWI7YS5pc1g9ITB9KTtuKGIsZnVuY3Rpb24oYSxiKXthLmluZGV4PWJ9KTtjPWMuY29uY2F0KGIpO24oYyxmdW5jdGlvbihiKXtuZXcgSShhLFxuYil9KX0sZ2V0U2VsZWN0ZWRQb2ludHM6ZnVuY3Rpb24oKXt2YXIgYT1bXTtuKHRoaXMuc2VyaWVzLGZ1bmN0aW9uKGIpe2E9YS5jb25jYXQoU2EoYi5wb2ludHN8fFtdLGZ1bmN0aW9uKGEpe3JldHVybiBhLnNlbGVjdGVkfSkpfSk7cmV0dXJuIGF9LGdldFNlbGVjdGVkU2VyaWVzOmZ1bmN0aW9uKCl7cmV0dXJuIFNhKHRoaXMuc2VyaWVzLGZ1bmN0aW9uKGEpe3JldHVybiBhLnNlbGVjdGVkfSl9LHNldFRpdGxlOmZ1bmN0aW9uKGEsYixjKXt2YXIgZzt2YXIgZD10aGlzLGU9ZC5vcHRpb25zLGY7Zj1lLnRpdGxlPUMoZS50aXRsZSxhKTtnPWUuc3VidGl0bGU9QyhlLnN1YnRpdGxlLGIpLGU9ZztuKFtbXCJ0aXRsZVwiLGEsZl0sW1wic3VidGl0bGVcIixiLGVdXSxmdW5jdGlvbihhKXt2YXIgYj1hWzBdLGM9ZFtiXSxlPWFbMV0sYT1hWzJdO2MmJmUmJihkW2JdPWM9Yy5kZXN0cm95KCkpO2EmJmEudGV4dCYmIWMmJihkW2JdPWQucmVuZGVyZXIudGV4dChhLnRleHQsMCwwLGEudXNlSFRNTCkuYXR0cih7YWxpZ246YS5hbGlnbixcblwiY2xhc3NcIjpcImhpZ2hjaGFydHMtXCIrYix6SW5kZXg6YS56SW5kZXh8fDR9KS5jc3MoYS5zdHlsZSkuYWRkKCkpfSk7ZC5sYXlPdXRUaXRsZXMoYyl9LGxheU91dFRpdGxlczpmdW5jdGlvbihhKXt2YXIgYj0wLGM9dGhpcy50aXRsZSxkPXRoaXMuc3VidGl0bGUsZT10aGlzLm9wdGlvbnMsZj1lLnRpdGxlLGU9ZS5zdWJ0aXRsZSxnPXRoaXMucmVuZGVyZXIsaD10aGlzLnNwYWNpbmdCb3gud2lkdGgtNDQ7aWYoYyYmKGMuY3NzKHt3aWR0aDooZi53aWR0aHx8aCkrXCJweFwifSkuYWxpZ24oeCh7eTpnLmZvbnRNZXRyaWNzKGYuc3R5bGUuZm9udFNpemUsYykuYi0zfSxmKSwhMSxcInNwYWNpbmdCb3hcIiksIWYuZmxvYXRpbmcmJiFmLnZlcnRpY2FsQWxpZ24pKWI9Yy5nZXRCQm94KCkuaGVpZ2h0O2QmJihkLmNzcyh7d2lkdGg6KGUud2lkdGh8fGgpK1wicHhcIn0pLmFsaWduKHgoe3k6YisoZi5tYXJnaW4tMTMpK2cuZm9udE1ldHJpY3MoZS5zdHlsZS5mb250U2l6ZSxjKS5ifSxlKSwhMSxcInNwYWNpbmdCb3hcIiksXG4hZS5mbG9hdGluZyYmIWUudmVydGljYWxBbGlnbiYmKGI9RmEoYitkLmdldEJCb3goKS5oZWlnaHQpKSk7Yz10aGlzLnRpdGxlT2Zmc2V0IT09Yjt0aGlzLnRpdGxlT2Zmc2V0PWI7aWYoIXRoaXMuaXNEaXJ0eUJveCYmYyl0aGlzLmlzRGlydHlCb3g9Yyx0aGlzLmhhc1JlbmRlcmVkJiZxKGEsITApJiZ0aGlzLmlzRGlydHlCb3gmJnRoaXMucmVkcmF3KCl9LGdldENoYXJ0U2l6ZTpmdW5jdGlvbigpe3ZhciBhPXRoaXMub3B0aW9ucy5jaGFydCxiPWEud2lkdGgsYT1hLmhlaWdodCxjPXRoaXMucmVuZGVyVG9DbG9uZXx8dGhpcy5yZW5kZXJUbztpZighcyhiKSl0aGlzLmNvbnRhaW5lcldpZHRoPXhhKGMsXCJ3aWR0aFwiKTtpZighcyhhKSl0aGlzLmNvbnRhaW5lckhlaWdodD14YShjLFwiaGVpZ2h0XCIpO3RoaXMuY2hhcnRXaWR0aD12KDAsYnx8dGhpcy5jb250YWluZXJXaWR0aHx8NjAwKTt0aGlzLmNoYXJ0SGVpZ2h0PXYoMCxxKGEsdGhpcy5jb250YWluZXJIZWlnaHQ+MTk/dGhpcy5jb250YWluZXJIZWlnaHQ6XG40MDApKX0sY2xvbmVSZW5kZXJUbzpmdW5jdGlvbihhKXt2YXIgYj10aGlzLnJlbmRlclRvQ2xvbmUsYz10aGlzLmNvbnRhaW5lcjthP2ImJih0aGlzLnJlbmRlclRvLmFwcGVuZENoaWxkKGMpLFZhKGIpLGRlbGV0ZSB0aGlzLnJlbmRlclRvQ2xvbmUpOihjJiZjLnBhcmVudE5vZGU9PT10aGlzLnJlbmRlclRvJiZ0aGlzLnJlbmRlclRvLnJlbW92ZUNoaWxkKGMpLHRoaXMucmVuZGVyVG9DbG9uZT1iPXRoaXMucmVuZGVyVG8uY2xvbmVOb2RlKDApLEYoYix7cG9zaXRpb246XCJhYnNvbHV0ZVwiLHRvcDpcIi05OTk5cHhcIixkaXNwbGF5OlwiYmxvY2tcIn0pLGIuc3R5bGUuc2V0UHJvcGVydHkmJmIuc3R5bGUuc2V0UHJvcGVydHkoXCJkaXNwbGF5XCIsXCJibG9ja1wiLFwiaW1wb3J0YW50XCIpLEIuYm9keS5hcHBlbmRDaGlsZChiKSxjJiZiLmFwcGVuZENoaWxkKGMpKX0sZ2V0Q29udGFpbmVyOmZ1bmN0aW9uKCl7dmFyIGEsYj10aGlzLm9wdGlvbnMsYz1iLmNoYXJ0LGQsZTthPXRoaXMucmVuZGVyVG87XG52YXIgZj1cImhpZ2hjaGFydHMtXCIrSmIrKztpZighYSl0aGlzLnJlbmRlclRvPWE9Yy5yZW5kZXJUbztpZihEYShhKSl0aGlzLnJlbmRlclRvPWE9Qi5nZXRFbGVtZW50QnlJZChhKTthfHxnYSgxMywhMCk7ZD1HKFgoYSxcImRhdGEtaGlnaGNoYXJ0cy1jaGFydFwiKSk7IWlzTmFOKGQpJiYkW2RdJiYkW2RdLmhhc1JlbmRlcmVkJiYkW2RdLmRlc3Ryb3koKTtYKGEsXCJkYXRhLWhpZ2hjaGFydHMtY2hhcnRcIix0aGlzLmluZGV4KTthLmlubmVySFRNTD1cIlwiOyFjLnNraXBDbG9uZSYmIWEub2Zmc2V0V2lkdGgmJnRoaXMuY2xvbmVSZW5kZXJUbygpO3RoaXMuZ2V0Q2hhcnRTaXplKCk7ZD10aGlzLmNoYXJ0V2lkdGg7ZT10aGlzLmNoYXJ0SGVpZ2h0O3RoaXMuY29udGFpbmVyPWE9ZWEoV2Ese2NsYXNzTmFtZTpcImhpZ2hjaGFydHMtY29udGFpbmVyXCIrKGMuY2xhc3NOYW1lP1wiIFwiK2MuY2xhc3NOYW1lOlwiXCIpLGlkOmZ9LHgoe3Bvc2l0aW9uOlwicmVsYXRpdmVcIixvdmVyZmxvdzpcImhpZGRlblwiLHdpZHRoOmQrXG5cInB4XCIsaGVpZ2h0OmUrXCJweFwiLHRleHRBbGlnbjpcImxlZnRcIixsaW5lSGVpZ2h0Olwibm9ybWFsXCIsekluZGV4OjAsXCItd2Via2l0LXRhcC1oaWdobGlnaHQtY29sb3JcIjpcInJnYmEoMCwwLDAsMClcIn0sYy5zdHlsZSksdGhpcy5yZW5kZXJUb0Nsb25lfHxhKTt0aGlzLl9jdXJzb3I9YS5zdHlsZS5jdXJzb3I7dGhpcy5yZW5kZXJlcj1uZXcgKHpbYy5yZW5kZXJlcl18fFlhKShhLGQsZSxjLnN0eWxlLGMuZm9yRXhwb3J0LGIuZXhwb3J0aW5nJiZiLmV4cG9ydGluZy5hbGxvd0hUTUwpO3FhJiZ0aGlzLnJlbmRlcmVyLmNyZWF0ZSh0aGlzLGEsZCxlKTt0aGlzLnJlbmRlcmVyLmNoYXJ0SW5kZXg9dGhpcy5pbmRleH0sZ2V0TWFyZ2luczpmdW5jdGlvbihhKXt2YXIgYj10aGlzLnNwYWNpbmcsYz10aGlzLm1hcmdpbixkPXRoaXMudGl0bGVPZmZzZXQ7dGhpcy5yZXNldE1hcmdpbnMoKTtpZihkJiYhcyhjWzBdKSl0aGlzLnBsb3RUb3A9dih0aGlzLnBsb3RUb3AsZCt0aGlzLm9wdGlvbnMudGl0bGUubWFyZ2luK1xuYlswXSk7dGhpcy5sZWdlbmQuYWRqdXN0TWFyZ2lucyhjLGIpO3RoaXMuZXh0cmFCb3R0b21NYXJnaW4mJih0aGlzLm1hcmdpbkJvdHRvbSs9dGhpcy5leHRyYUJvdHRvbU1hcmdpbik7dGhpcy5leHRyYVRvcE1hcmdpbiYmKHRoaXMucGxvdFRvcCs9dGhpcy5leHRyYVRvcE1hcmdpbik7YXx8dGhpcy5nZXRBeGlzTWFyZ2lucygpfSxnZXRBeGlzTWFyZ2luczpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLmF4aXNPZmZzZXQ9WzAsMCwwLDBdLGM9YS5tYXJnaW47YS5oYXNDYXJ0ZXNpYW5TZXJpZXMmJm4oYS5heGVzLGZ1bmN0aW9uKGEpe2EudmlzaWJsZSYmYS5nZXRPZmZzZXQoKX0pO24odWIsZnVuY3Rpb24oZCxlKXtzKGNbZV0pfHwoYVtkXSs9YltlXSl9KTthLnNldENoYXJ0U2l6ZSgpfSxyZWZsb3c6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcyxjPWIub3B0aW9ucy5jaGFydCxkPWIucmVuZGVyVG8sZT1jLndpZHRofHx4YShkLFwid2lkdGhcIiksZj1jLmhlaWdodHx8eGEoZCxcImhlaWdodFwiKSxcbmM9YT9hLnRhcmdldDpKO2lmKCFiLmhhc1VzZXJTaXplJiYhYi5pc1ByaW50aW5nJiZlJiZmJiYoYz09PUp8fGM9PT1CKSl7aWYoZSE9PWIuY29udGFpbmVyV2lkdGh8fGYhPT1iLmNvbnRhaW5lckhlaWdodCljbGVhclRpbWVvdXQoYi5yZWZsb3dUaW1lb3V0KSxiLnJlZmxvd1RpbWVvdXQ9JGEoZnVuY3Rpb24oKXtpZihiLmNvbnRhaW5lciliLnNldFNpemUoZSxmLCExKSxiLmhhc1VzZXJTaXplPW51bGx9LGE/MTAwOjApO2IuY29udGFpbmVyV2lkdGg9ZTtiLmNvbnRhaW5lckhlaWdodD1mfX0saW5pdFJlZmxvdzpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1mdW5jdGlvbihiKXthLnJlZmxvdyhiKX07RChKLFwicmVzaXplXCIsYik7RChhLFwiZGVzdHJveVwiLGZ1bmN0aW9uKCl7VChKLFwicmVzaXplXCIsYil9KX0sc2V0U2l6ZTpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9dGhpcyxlLGYsZz1kLnJlbmRlcmVyO2QuaXNSZXNpemluZys9MTthYihjLGQpO2Qub2xkQ2hhcnRIZWlnaHQ9ZC5jaGFydEhlaWdodDtcbmQub2xkQ2hhcnRXaWR0aD1kLmNoYXJ0V2lkdGg7aWYocyhhKSlkLmNoYXJ0V2lkdGg9ZT12KDAseShhKSksZC5oYXNVc2VyU2l6ZT0hIWU7aWYocyhiKSlkLmNoYXJ0SGVpZ2h0PWY9digwLHkoYikpO2E9Zy5nbG9iYWxBbmltYXRpb247KGE/ZWI6RikoZC5jb250YWluZXIse3dpZHRoOmUrXCJweFwiLGhlaWdodDpmK1wicHhcIn0sYSk7ZC5zZXRDaGFydFNpemUoITApO2cuc2V0U2l6ZShlLGYsYyk7ZC5tYXhUaWNrcz1udWxsO24oZC5heGVzLGZ1bmN0aW9uKGEpe2EuaXNEaXJ0eT0hMDthLnNldFNjYWxlKCl9KTtuKGQuc2VyaWVzLGZ1bmN0aW9uKGEpe2EuaXNEaXJ0eT0hMH0pO2QuaXNEaXJ0eUxlZ2VuZD0hMDtkLmlzRGlydHlCb3g9ITA7ZC5sYXlPdXRUaXRsZXMoKTtkLmdldE1hcmdpbnMoKTtkLnJlZHJhdyhjKTtkLm9sZENoYXJ0SGVpZ2h0PW51bGw7TShkLFwicmVzaXplXCIpOyRhKGZ1bmN0aW9uKCl7ZCYmTShkLFwiZW5kUmVzaXplXCIsbnVsbCxmdW5jdGlvbigpe2QuaXNSZXNpemluZy09XG4xfSl9LGhiKGEpLmR1cmF0aW9uKX0sc2V0Q2hhcnRTaXplOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuaW52ZXJ0ZWQsYz10aGlzLnJlbmRlcmVyLGQ9dGhpcy5jaGFydFdpZHRoLGU9dGhpcy5jaGFydEhlaWdodCxmPXRoaXMub3B0aW9ucy5jaGFydCxnPXRoaXMuc3BhY2luZyxoPXRoaXMuY2xpcE9mZnNldCxpLGosayxsO3RoaXMucGxvdExlZnQ9aT15KHRoaXMucGxvdExlZnQpO3RoaXMucGxvdFRvcD1qPXkodGhpcy5wbG90VG9wKTt0aGlzLnBsb3RXaWR0aD1rPXYoMCx5KGQtaS10aGlzLm1hcmdpblJpZ2h0KSk7dGhpcy5wbG90SGVpZ2h0PWw9digwLHkoZS1qLXRoaXMubWFyZ2luQm90dG9tKSk7dGhpcy5wbG90U2l6ZVg9Yj9sOms7dGhpcy5wbG90U2l6ZVk9Yj9rOmw7dGhpcy5wbG90Qm9yZGVyV2lkdGg9Zi5wbG90Qm9yZGVyV2lkdGh8fDA7dGhpcy5zcGFjaW5nQm94PWMuc3BhY2luZ0JveD17eDpnWzNdLHk6Z1swXSx3aWR0aDpkLWdbM10tZ1sxXSxoZWlnaHQ6ZS1nWzBdLWdbMl19O1xudGhpcy5wbG90Qm94PWMucGxvdEJveD17eDppLHk6aix3aWR0aDprLGhlaWdodDpsfTtkPTIqVih0aGlzLnBsb3RCb3JkZXJXaWR0aC8yKTtiPUZhKHYoZCxoWzNdKS8yKTtjPUZhKHYoZCxoWzBdKS8yKTt0aGlzLmNsaXBCb3g9e3g6Yix5OmMsd2lkdGg6Vih0aGlzLnBsb3RTaXplWC12KGQsaFsxXSkvMi1iKSxoZWlnaHQ6digwLFYodGhpcy5wbG90U2l6ZVktdihkLGhbMl0pLzItYykpfTthfHxuKHRoaXMuYXhlcyxmdW5jdGlvbihhKXthLnNldEF4aXNTaXplKCk7YS5zZXRBeGlzVHJhbnNsYXRpb24oKX0pfSxyZXNldE1hcmdpbnM6ZnVuY3Rpb24oKXt2YXIgYT10aGlzO24odWIsZnVuY3Rpb24oYixjKXthW2JdPXEoYS5tYXJnaW5bY10sYS5zcGFjaW5nW2NdKX0pO2EuYXhpc09mZnNldD1bMCwwLDAsMF07YS5jbGlwT2Zmc2V0PVswLDAsMCwwXX0sZHJhd0NoYXJ0Qm94OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcHRpb25zLmNoYXJ0LGI9dGhpcy5yZW5kZXJlcixjPXRoaXMuY2hhcnRXaWR0aCxcbmQ9dGhpcy5jaGFydEhlaWdodCxlPXRoaXMuY2hhcnRCYWNrZ3JvdW5kLGY9dGhpcy5wbG90QmFja2dyb3VuZCxnPXRoaXMucGxvdEJvcmRlcixoPXRoaXMucGxvdEJHSW1hZ2UsaT1hLmJvcmRlcldpZHRofHwwLGo9YS5iYWNrZ3JvdW5kQ29sb3Isaz1hLnBsb3RCYWNrZ3JvdW5kQ29sb3IsbD1hLnBsb3RCYWNrZ3JvdW5kSW1hZ2UsbT1hLnBsb3RCb3JkZXJXaWR0aHx8MCxvLHA9dGhpcy5wbG90TGVmdCxyPXRoaXMucGxvdFRvcCxBPXRoaXMucGxvdFdpZHRoLHE9dGhpcy5wbG90SGVpZ2h0LG49dGhpcy5wbG90Qm94LHc9dGhpcy5jbGlwUmVjdCxPPXRoaXMuY2xpcEJveDtvPWkrKGEuc2hhZG93Pzg6MCk7aWYoaXx8ailpZihlKWUuYW5pbWF0ZShlLmNyaXNwKHt3aWR0aDpjLW8saGVpZ2h0OmQtb30pKTtlbHNle2U9e2ZpbGw6anx8XCJub25lXCJ9O2lmKGkpZS5zdHJva2U9YS5ib3JkZXJDb2xvcixlW1wic3Ryb2tlLXdpZHRoXCJdPWk7dGhpcy5jaGFydEJhY2tncm91bmQ9Yi5yZWN0KG8vXG4yLG8vMixjLW8sZC1vLGEuYm9yZGVyUmFkaXVzLGkpLmF0dHIoZSkuYWRkQ2xhc3MoXCJoaWdoY2hhcnRzLWJhY2tncm91bmRcIikuYWRkKCkuc2hhZG93KGEuc2hhZG93KX1pZihrKWY/Zi5hbmltYXRlKG4pOnRoaXMucGxvdEJhY2tncm91bmQ9Yi5yZWN0KHAscixBLHEsMCkuYXR0cih7ZmlsbDprfSkuYWRkKCkuc2hhZG93KGEucGxvdFNoYWRvdyk7aWYobCloP2guYW5pbWF0ZShuKTp0aGlzLnBsb3RCR0ltYWdlPWIuaW1hZ2UobCxwLHIsQSxxKS5hZGQoKTt3P3cuYW5pbWF0ZSh7d2lkdGg6Ty53aWR0aCxoZWlnaHQ6Ty5oZWlnaHR9KTp0aGlzLmNsaXBSZWN0PWIuY2xpcFJlY3QoTyk7aWYobSlnPyhnLnN0cm9rZVdpZHRoPS1tLGcuYW5pbWF0ZShnLmNyaXNwKHt4OnAseTpyLHdpZHRoOkEsaGVpZ2h0OnF9KSkpOnRoaXMucGxvdEJvcmRlcj1iLnJlY3QocCxyLEEscSwwLC1tKS5hdHRyKHtzdHJva2U6YS5wbG90Qm9yZGVyQ29sb3IsXCJzdHJva2Utd2lkdGhcIjptLGZpbGw6XCJub25lXCIsXG56SW5kZXg6MX0pLmFkZCgpO3RoaXMuaXNEaXJ0eUJveD0hMX0scHJvcEZyb21TZXJpZXM6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5vcHRpb25zLmNoYXJ0LGMsZD1hLm9wdGlvbnMuc2VyaWVzLGUsZjtuKFtcImludmVydGVkXCIsXCJhbmd1bGFyXCIsXCJwb2xhclwiXSxmdW5jdGlvbihnKXtjPUtbYi50eXBlfHxiLmRlZmF1bHRTZXJpZXNUeXBlXTtmPWFbZ118fGJbZ118fGMmJmMucHJvdG90eXBlW2ddO2ZvcihlPWQmJmQubGVuZ3RoOyFmJiZlLS07KShjPUtbZFtlXS50eXBlXSkmJmMucHJvdG90eXBlW2ddJiYoZj0hMCk7YVtnXT1mfSl9LGxpbmtTZXJpZXM6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5zZXJpZXM7bihiLGZ1bmN0aW9uKGEpe2EubGlua2VkU2VyaWVzLmxlbmd0aD0wfSk7bihiLGZ1bmN0aW9uKGIpe3ZhciBkPWIub3B0aW9ucy5saW5rZWRUbztpZihEYShkKSYmKGQ9ZD09PVwiOnByZXZpb3VzXCI/YS5zZXJpZXNbYi5pbmRleC0xXTphLmdldChkKSkpZC5saW5rZWRTZXJpZXMucHVzaChiKSxcbmIubGlua2VkUGFyZW50PWQsYi52aXNpYmxlPXEoYi5vcHRpb25zLnZpc2libGUsZC5vcHRpb25zLnZpc2libGUsYi52aXNpYmxlKX0pfSxyZW5kZXJTZXJpZXM6ZnVuY3Rpb24oKXtuKHRoaXMuc2VyaWVzLGZ1bmN0aW9uKGEpe2EudHJhbnNsYXRlKCk7YS5yZW5kZXIoKX0pfSxyZW5kZXJMYWJlbHM6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5vcHRpb25zLmxhYmVscztiLml0ZW1zJiZuKGIuaXRlbXMsZnVuY3Rpb24oYyl7dmFyIGQ9eChiLnN0eWxlLGMuc3R5bGUpLGU9RyhkLmxlZnQpK2EucGxvdExlZnQsZj1HKGQudG9wKSthLnBsb3RUb3ArMTI7ZGVsZXRlIGQubGVmdDtkZWxldGUgZC50b3A7YS5yZW5kZXJlci50ZXh0KGMuaHRtbCxlLGYpLmF0dHIoe3pJbmRleDoyfSkuY3NzKGQpLmFkZCgpfSl9LHJlbmRlcjpmdW5jdGlvbigpe3ZhciBhPXRoaXMuYXhlcyxiPXRoaXMucmVuZGVyZXIsYz10aGlzLm9wdGlvbnMsZCxlLGYsZzt0aGlzLnNldFRpdGxlKCk7dGhpcy5sZWdlbmQ9XG5uZXcgdmIodGhpcyxjLmxlZ2VuZCk7dGhpcy5nZXRTdGFja3MmJnRoaXMuZ2V0U3RhY2tzKCk7dGhpcy5nZXRNYXJnaW5zKCEwKTt0aGlzLnNldENoYXJ0U2l6ZSgpO2Q9dGhpcy5wbG90V2lkdGg7ZT10aGlzLnBsb3RIZWlnaHQtPTIxO24oYSxmdW5jdGlvbihhKXthLnNldFNjYWxlKCl9KTt0aGlzLmdldEF4aXNNYXJnaW5zKCk7Zj1kL3RoaXMucGxvdFdpZHRoPjEuMTtnPWUvdGhpcy5wbG90SGVpZ2h0PjEuMDU7aWYoZnx8Zyl0aGlzLm1heFRpY2tzPW51bGwsbihhLGZ1bmN0aW9uKGEpeyhhLmhvcml6JiZmfHwhYS5ob3JpeiYmZykmJmEuc2V0VGlja0ludGVydmFsKCEwKX0pLHRoaXMuZ2V0TWFyZ2lucygpO3RoaXMuZHJhd0NoYXJ0Qm94KCk7dGhpcy5oYXNDYXJ0ZXNpYW5TZXJpZXMmJm4oYSxmdW5jdGlvbihhKXthLnZpc2libGUmJmEucmVuZGVyKCl9KTtpZighdGhpcy5zZXJpZXNHcm91cCl0aGlzLnNlcmllc0dyb3VwPWIuZyhcInNlcmllcy1ncm91cFwiKS5hdHRyKHt6SW5kZXg6M30pLmFkZCgpO1xudGhpcy5yZW5kZXJTZXJpZXMoKTt0aGlzLnJlbmRlckxhYmVscygpO3RoaXMuc2hvd0NyZWRpdHMoYy5jcmVkaXRzKTt0aGlzLmhhc1JlbmRlcmVkPSEwfSxzaG93Q3JlZGl0czpmdW5jdGlvbihhKXtpZihhLmVuYWJsZWQmJiF0aGlzLmNyZWRpdHMpdGhpcy5jcmVkaXRzPXRoaXMucmVuZGVyZXIudGV4dChhLnRleHQsMCwwKS5vbihcImNsaWNrXCIsZnVuY3Rpb24oKXtpZihhLmhyZWYpSi5sb2NhdGlvbi5ocmVmPWEuaHJlZn0pLmF0dHIoe2FsaWduOmEucG9zaXRpb24uYWxpZ24sekluZGV4Ojh9KS5jc3MoYS5zdHlsZSkuYWRkKCkuYWxpZ24oYS5wb3NpdGlvbil9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5heGVzLGM9YS5zZXJpZXMsZD1hLmNvbnRhaW5lcixlLGY9ZCYmZC5wYXJlbnROb2RlO00oYSxcImRlc3Ryb3lcIik7JFthLmluZGV4XT10O2xiLS07YS5yZW5kZXJUby5yZW1vdmVBdHRyaWJ1dGUoXCJkYXRhLWhpZ2hjaGFydHMtY2hhcnRcIik7VChhKTtmb3IoZT1iLmxlbmd0aDtlLS07KWJbZV09XG5iW2VdLmRlc3Ryb3koKTtmb3IoZT1jLmxlbmd0aDtlLS07KWNbZV09Y1tlXS5kZXN0cm95KCk7bihcInRpdGxlLHN1YnRpdGxlLGNoYXJ0QmFja2dyb3VuZCxwbG90QmFja2dyb3VuZCxwbG90QkdJbWFnZSxwbG90Qm9yZGVyLHNlcmllc0dyb3VwLGNsaXBSZWN0LGNyZWRpdHMscG9pbnRlcixzY3JvbGxlcixyYW5nZVNlbGVjdG9yLGxlZ2VuZCxyZXNldFpvb21CdXR0b24sdG9vbHRpcCxyZW5kZXJlclwiLnNwbGl0KFwiLFwiKSxmdW5jdGlvbihiKXt2YXIgYz1hW2JdO2MmJmMuZGVzdHJveSYmKGFbYl09Yy5kZXN0cm95KCkpfSk7aWYoZClkLmlubmVySFRNTD1cIlwiLFQoZCksZiYmVmEoZCk7Zm9yKGUgaW4gYSlkZWxldGUgYVtlXX0saXNSZWFkeVRvUmVuZGVyOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcztyZXR1cm4hamEmJko9PUoudG9wJiZCLnJlYWR5U3RhdGUhPT1cImNvbXBsZXRlXCJ8fHFhJiYhSi5jYW52Zz8ocWE/V2IucHVzaChmdW5jdGlvbigpe2EuZmlyc3RSZW5kZXIoKX0sYS5vcHRpb25zLmdsb2JhbC5jYW52YXNUb29sc1VSTCk6XG5CLmF0dGFjaEV2ZW50KFwib25yZWFkeXN0YXRlY2hhbmdlXCIsZnVuY3Rpb24oKXtCLmRldGFjaEV2ZW50KFwib25yZWFkeXN0YXRlY2hhbmdlXCIsYS5maXJzdFJlbmRlcik7Qi5yZWFkeVN0YXRlPT09XCJjb21wbGV0ZVwiJiZhLmZpcnN0UmVuZGVyKCl9KSwhMSk6ITB9LGZpcnN0UmVuZGVyOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEub3B0aW9ucztpZihhLmlzUmVhZHlUb1JlbmRlcigpKXthLmdldENvbnRhaW5lcigpO00oYSxcImluaXRcIik7YS5yZXNldE1hcmdpbnMoKTthLnNldENoYXJ0U2l6ZSgpO2EucHJvcEZyb21TZXJpZXMoKTthLmdldEF4ZXMoKTtuKGIuc2VyaWVzfHxbXSxmdW5jdGlvbihiKXthLmluaXRTZXJpZXMoYil9KTthLmxpbmtTZXJpZXMoKTtNKGEsXCJiZWZvcmVSZW5kZXJcIik7aWYoei5Qb2ludGVyKWEucG9pbnRlcj1uZXcgWmEoYSxiKTthLnJlbmRlcigpO2EucmVuZGVyZXIuZHJhdygpO2lmKCFhLnJlbmRlcmVyLmltZ0NvdW50JiZhLm9ubG9hZClhLm9ubG9hZCgpO1xuYS5jbG9uZVJlbmRlclRvKCEwKX19LG9ubG9hZDpmdW5jdGlvbigpe3ZhciBhPXRoaXM7bihbdGhpcy5jYWxsYmFja10uY29uY2F0KHRoaXMuY2FsbGJhY2tzKSxmdW5jdGlvbihiKXtiJiZhLmluZGV4IT09dm9pZCAwJiZiLmFwcGx5KGEsW2FdKX0pO00oYSxcImxvYWRcIik7dGhpcy5vbmxvYWQ9bnVsbH0sc3BsYXNoQXJyYXk6ZnVuY3Rpb24oYSxiKXt2YXIgYz1iW2FdLGM9ZGEoYyk/YzpbYyxjLGMsY107cmV0dXJuW3EoYlthK1wiVG9wXCJdLGNbMF0pLHEoYlthK1wiUmlnaHRcIl0sY1sxXSkscShiW2ErXCJCb3R0b21cIl0sY1syXSkscShiW2ErXCJMZWZ0XCJdLGNbM10pXX19O3ZhciBiYz16LkNlbnRlcmVkU2VyaWVzTWl4aW49e2dldENlbnRlcjpmdW5jdGlvbigpe3ZhciBhPXRoaXMub3B0aW9ucyxiPXRoaXMuY2hhcnQsYz0yKihhLnNsaWNlZE9mZnNldHx8MCksZD1iLnBsb3RXaWR0aC0yKmMsYj1iLnBsb3RIZWlnaHQtMipjLGU9YS5jZW50ZXIsZT1bcShlWzBdLFwiNTAlXCIpLHEoZVsxXSxcIjUwJVwiKSxcbmEuc2l6ZXx8XCIxMDAlXCIsYS5pbm5lclNpemV8fDBdLGY9RShkLGIpLGcsaDtmb3IoZz0wO2c8NDsrK2cpaD1lW2ddLGE9ZzwyfHxnPT09MiYmLyUkLy50ZXN0KGgpLGVbZ109KC8lJC8udGVzdChoKT9bZCxiLGYsZVsyXV1bZ10qcGFyc2VGbG9hdChoKS8xMDA6cGFyc2VGbG9hdChoKSkrKGE/YzowKTtlWzNdPmVbMl0mJihlWzNdPWVbMl0pO3JldHVybiBlfX0sSGE9ZnVuY3Rpb24oKXt9O0hhLnByb3RvdHlwZT17aW5pdDpmdW5jdGlvbihhLGIsYyl7dGhpcy5zZXJpZXM9YTt0aGlzLmNvbG9yPWEuY29sb3I7dGhpcy5hcHBseU9wdGlvbnMoYixjKTt0aGlzLnBvaW50QXR0cj17fTtpZihhLm9wdGlvbnMuY29sb3JCeVBvaW50JiYoYj1hLm9wdGlvbnMuY29sb3JzfHxhLmNoYXJ0Lm9wdGlvbnMuY29sb3JzLHRoaXMuY29sb3I9dGhpcy5jb2xvcnx8YlthLmNvbG9yQ291bnRlcisrXSxhLmNvbG9yQ291bnRlcj09PWIubGVuZ3RoKSlhLmNvbG9yQ291bnRlcj0wO2EuY2hhcnQucG9pbnRDb3VudCsrO1xucmV0dXJuIHRoaXN9LGFwcGx5T3B0aW9uczpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuc2VyaWVzLGQ9Yy5vcHRpb25zLnBvaW50VmFsS2V5fHxjLnBvaW50VmFsS2V5LGE9SGEucHJvdG90eXBlLm9wdGlvbnNUb09iamVjdC5jYWxsKHRoaXMsYSk7eCh0aGlzLGEpO3RoaXMub3B0aW9ucz10aGlzLm9wdGlvbnM/eCh0aGlzLm9wdGlvbnMsYSk6YTtpZihkKXRoaXMueT10aGlzW2RdO3RoaXMuaXNOdWxsPXRoaXMueT09PW51bGw7aWYodGhpcy54PT09dm9pZCAwJiZjKXRoaXMueD1iPT09dm9pZCAwP2MuYXV0b0luY3JlbWVudCgpOmI7cmV0dXJuIHRoaXN9LG9wdGlvbnNUb09iamVjdDpmdW5jdGlvbihhKXt2YXIgYj17fSxjPXRoaXMuc2VyaWVzLGQ9Yy5vcHRpb25zLmtleXMsZT1kfHxjLnBvaW50QXJyYXlNYXB8fFtcInlcIl0sZj1lLmxlbmd0aCxnPTAsaD0wO2lmKHR5cGVvZiBhPT09XCJudW1iZXJcInx8YT09PW51bGwpYltlWzBdXT1hO2Vsc2UgaWYoSmEoYSkpe2lmKCFkJiZhLmxlbmd0aD5cbmYpe2M9dHlwZW9mIGFbMF07aWYoYz09PVwic3RyaW5nXCIpYi5uYW1lPWFbMF07ZWxzZSBpZihjPT09XCJudW1iZXJcIiliLng9YVswXTtnKyt9Zm9yKDtoPGY7KXtpZighZHx8YVtnXSE9PXZvaWQgMCliW2VbaF1dPWFbZ107ZysrO2grK319ZWxzZSBpZih0eXBlb2YgYT09PVwib2JqZWN0XCIpe2I9YTtpZihhLmRhdGFMYWJlbHMpYy5faGFzUG9pbnRMYWJlbHM9ITA7aWYoYS5tYXJrZXIpYy5faGFzUG9pbnRNYXJrZXJzPSEwfXJldHVybiBifSxkZXN0cm95OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5zZXJpZXMuY2hhcnQsYj1hLmhvdmVyUG9pbnRzLGM7YS5wb2ludENvdW50LS07aWYoYiYmKHRoaXMuc2V0U3RhdGUoKSxBYShiLHRoaXMpLCFiLmxlbmd0aCkpYS5ob3ZlclBvaW50cz1udWxsO2lmKHRoaXM9PT1hLmhvdmVyUG9pbnQpdGhpcy5vbk1vdXNlT3V0KCk7aWYodGhpcy5ncmFwaGljfHx0aGlzLmRhdGFMYWJlbClUKHRoaXMpLHRoaXMuZGVzdHJveUVsZW1lbnRzKCk7dGhpcy5sZWdlbmRJdGVtJiZcbmEubGVnZW5kLmRlc3Ryb3lJdGVtKHRoaXMpO2ZvcihjIGluIHRoaXMpdGhpc1tjXT1udWxsfSxkZXN0cm95RWxlbWVudHM6ZnVuY3Rpb24oKXtmb3IodmFyIGE9W1wiZ3JhcGhpY1wiLFwiZGF0YUxhYmVsXCIsXCJkYXRhTGFiZWxVcHBlclwiLFwiY29ubmVjdG9yXCIsXCJzaGFkb3dHcm91cFwiXSxiLGM9NjtjLS07KWI9YVtjXSx0aGlzW2JdJiYodGhpc1tiXT10aGlzW2JdLmRlc3Ryb3koKSl9LGdldExhYmVsQ29uZmlnOmZ1bmN0aW9uKCl7cmV0dXJue3g6dGhpcy5jYXRlZ29yeSx5OnRoaXMueSxjb2xvcjp0aGlzLmNvbG9yLGtleTp0aGlzLm5hbWV8fHRoaXMuY2F0ZWdvcnksc2VyaWVzOnRoaXMuc2VyaWVzLHBvaW50OnRoaXMscGVyY2VudGFnZTp0aGlzLnBlcmNlbnRhZ2UsdG90YWw6dGhpcy50b3RhbHx8dGhpcy5zdGFja1RvdGFsfX0sdG9vbHRpcEZvcm1hdHRlcjpmdW5jdGlvbihhKXt2YXIgYj10aGlzLnNlcmllcyxjPWIudG9vbHRpcE9wdGlvbnMsZD1xKGMudmFsdWVEZWNpbWFscyxcIlwiKSxcbmU9Yy52YWx1ZVByZWZpeHx8XCJcIixmPWMudmFsdWVTdWZmaXh8fFwiXCI7bihiLnBvaW50QXJyYXlNYXB8fFtcInlcIl0sZnVuY3Rpb24oYil7Yj1cIntwb2ludC5cIitiO2lmKGV8fGYpYT1hLnJlcGxhY2UoYitcIn1cIixlK2IrXCJ9XCIrZik7YT1hLnJlcGxhY2UoYitcIn1cIixiK1wiOiwuXCIrZCtcImZ9XCIpfSk7cmV0dXJuIExhKGEse3BvaW50OnRoaXMsc2VyaWVzOnRoaXMuc2VyaWVzfSl9LGZpcmVQb2ludEV2ZW50OmZ1bmN0aW9uKGEsYixjKXt2YXIgZD10aGlzLGU9dGhpcy5zZXJpZXMub3B0aW9uczsoZS5wb2ludC5ldmVudHNbYV18fGQub3B0aW9ucyYmZC5vcHRpb25zLmV2ZW50cyYmZC5vcHRpb25zLmV2ZW50c1thXSkmJnRoaXMuaW1wb3J0RXZlbnRzKCk7YT09PVwiY2xpY2tcIiYmZS5hbGxvd1BvaW50U2VsZWN0JiYoYz1mdW5jdGlvbihhKXtkLnNlbGVjdCYmZC5zZWxlY3QobnVsbCxhLmN0cmxLZXl8fGEubWV0YUtleXx8YS5zaGlmdEtleSl9KTtNKHRoaXMsYSxiLGMpfSx2aXNpYmxlOiEwfTt2YXIgUT1cbnouU2VyaWVzPWZ1bmN0aW9uKCl7fTtRLnByb3RvdHlwZT17aXNDYXJ0ZXNpYW46ITAsdHlwZTpcImxpbmVcIixwb2ludENsYXNzOkhhLHNvcnRlZDohMCxyZXF1aXJlU29ydGluZzohMCxwb2ludEF0dHJUb09wdGlvbnM6e3N0cm9rZTpcImxpbmVDb2xvclwiLFwic3Ryb2tlLXdpZHRoXCI6XCJsaW5lV2lkdGhcIixmaWxsOlwiZmlsbENvbG9yXCIscjpcInJhZGl1c1wifSxkaXJlY3RUb3VjaDohMSxheGlzVHlwZXM6W1wieEF4aXNcIixcInlBeGlzXCJdLGNvbG9yQ291bnRlcjowLHBhcmFsbGVsQXJyYXlzOltcInhcIixcInlcIl0saW5pdDpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMsZCxlLGY9YS5zZXJpZXMsZz1mdW5jdGlvbihhLGIpe3JldHVybiBxKGEub3B0aW9ucy5pbmRleCxhLl9pKS1xKGIub3B0aW9ucy5pbmRleCxiLl9pKX07Yy5jaGFydD1hO2Mub3B0aW9ucz1iPWMuc2V0T3B0aW9ucyhiKTtjLmxpbmtlZFNlcmllcz1bXTtjLmJpbmRBeGVzKCk7eChjLHtuYW1lOmIubmFtZSxzdGF0ZTpcIlwiLHBvaW50QXR0cjp7fSxcbnZpc2libGU6Yi52aXNpYmxlIT09ITEsc2VsZWN0ZWQ6Yi5zZWxlY3RlZD09PSEwfSk7aWYocWEpYi5hbmltYXRpb249ITE7ZT1iLmV2ZW50cztmb3IoZCBpbiBlKUQoYyxkLGVbZF0pO2lmKGUmJmUuY2xpY2t8fGIucG9pbnQmJmIucG9pbnQuZXZlbnRzJiZiLnBvaW50LmV2ZW50cy5jbGlja3x8Yi5hbGxvd1BvaW50U2VsZWN0KWEucnVuVHJhY2tlckNsaWNrPSEwO2MuZ2V0Q29sb3IoKTtjLmdldFN5bWJvbCgpO24oYy5wYXJhbGxlbEFycmF5cyxmdW5jdGlvbihhKXtjW2ErXCJEYXRhXCJdPVtdfSk7Yy5zZXREYXRhKGIuZGF0YSwhMSk7aWYoYy5pc0NhcnRlc2lhbilhLmhhc0NhcnRlc2lhblNlcmllcz0hMDtmLnB1c2goYyk7Yy5faT1mLmxlbmd0aC0xO29iKGYsZyk7dGhpcy55QXhpcyYmb2IodGhpcy55QXhpcy5zZXJpZXMsZyk7bihmLGZ1bmN0aW9uKGEsYil7YS5pbmRleD1iO2EubmFtZT1hLm5hbWV8fFwiU2VyaWVzIFwiKyhiKzEpfSl9LGJpbmRBeGVzOmZ1bmN0aW9uKCl7dmFyIGE9XG50aGlzLGI9YS5vcHRpb25zLGM9YS5jaGFydCxkO24oYS5heGlzVHlwZXN8fFtdLGZ1bmN0aW9uKGUpe24oY1tlXSxmdW5jdGlvbihjKXtkPWMub3B0aW9ucztpZihiW2VdPT09ZC5pbmRleHx8YltlXSE9PXQmJmJbZV09PT1kLmlkfHxiW2VdPT09dCYmZC5pbmRleD09PTApYy5zZXJpZXMucHVzaChhKSxhW2VdPWMsYy5pc0RpcnR5PSEwfSk7IWFbZV0mJmEub3B0aW9uYWxBeGlzIT09ZSYmZ2EoMTgsITApfSl9LHVwZGF0ZVBhcmFsbGVsQXJyYXlzOmZ1bmN0aW9uKGEsYil7dmFyIGM9YS5zZXJpZXMsZD1hcmd1bWVudHM7bihjLnBhcmFsbGVsQXJyYXlzLHR5cGVvZiBiPT09XCJudW1iZXJcIj9mdW5jdGlvbihkKXt2YXIgZj1kPT09XCJ5XCImJmMudG9ZRGF0YT9jLnRvWURhdGEoYSk6YVtkXTtjW2QrXCJEYXRhXCJdW2JdPWZ9OmZ1bmN0aW9uKGEpe0FycmF5LnByb3RvdHlwZVtiXS5hcHBseShjW2ErXCJEYXRhXCJdLEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGQsMikpfSl9LGF1dG9JbmNyZW1lbnQ6ZnVuY3Rpb24oKXt2YXIgYT1cbnRoaXMub3B0aW9ucyxiPXRoaXMueEluY3JlbWVudCxjLGQ9YS5wb2ludEludGVydmFsVW5pdCxiPXEoYixhLnBvaW50U3RhcnQsMCk7dGhpcy5wb2ludEludGVydmFsPWM9cSh0aGlzLnBvaW50SW50ZXJ2YWwsYS5wb2ludEludGVydmFsLDEpO2QmJihhPW5ldyBmYShiKSxkPT09XCJkYXlcIj9hPSthW3JiXShhW2JiXSgpK2MpOmQ9PT1cIm1vbnRoXCI/YT0rYVtGYl0oYVtpYl0oKStjKTpkPT09XCJ5ZWFyXCImJihhPSthW0diXShhW2piXSgpK2MpKSxjPWEtYik7dGhpcy54SW5jcmVtZW50PWIrYztyZXR1cm4gYn0sc2V0T3B0aW9uczpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNoYXJ0LGM9Yi5vcHRpb25zLnBsb3RPcHRpb25zLGI9Yi51c2VyT3B0aW9uc3x8e30sZD1iLnBsb3RPcHRpb25zfHx7fSxlPWNbdGhpcy50eXBlXTt0aGlzLnVzZXJPcHRpb25zPWE7Yz1DKGUsYy5zZXJpZXMsYSk7dGhpcy50b29sdGlwT3B0aW9ucz1DKE4udG9vbHRpcCxOLnBsb3RPcHRpb25zW3RoaXMudHlwZV0udG9vbHRpcCxcbmIudG9vbHRpcCxkLnNlcmllcyYmZC5zZXJpZXMudG9vbHRpcCxkW3RoaXMudHlwZV0mJmRbdGhpcy50eXBlXS50b29sdGlwLGEudG9vbHRpcCk7ZS5tYXJrZXI9PT1udWxsJiZkZWxldGUgYy5tYXJrZXI7dGhpcy56b25lQXhpcz1jLnpvbmVBeGlzO2E9dGhpcy56b25lcz0oYy56b25lc3x8W10pLnNsaWNlKCk7aWYoKGMubmVnYXRpdmVDb2xvcnx8Yy5uZWdhdGl2ZUZpbGxDb2xvcikmJiFjLnpvbmVzKWEucHVzaCh7dmFsdWU6Y1t0aGlzLnpvbmVBeGlzK1wiVGhyZXNob2xkXCJdfHxjLnRocmVzaG9sZHx8MCxjb2xvcjpjLm5lZ2F0aXZlQ29sb3IsZmlsbENvbG9yOmMubmVnYXRpdmVGaWxsQ29sb3J9KTthLmxlbmd0aCYmcyhhW2EubGVuZ3RoLTFdLnZhbHVlKSYmYS5wdXNoKHtjb2xvcjp0aGlzLmNvbG9yLGZpbGxDb2xvcjp0aGlzLmZpbGxDb2xvcn0pO3JldHVybiBjfSxnZXRDeWNsaWM6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXRoaXMudXNlck9wdGlvbnMsZT1cIl9cIithK1wiSW5kZXhcIixcbmY9YStcIkNvdW50ZXJcIjtifHwocyhkW2VdKT9iPWRbZV06KGRbZV09Yj10aGlzLmNoYXJ0W2ZdJWMubGVuZ3RoLHRoaXMuY2hhcnRbZl0rPTEpLGI9Y1tiXSk7dGhpc1thXT1ifSxnZXRDb2xvcjpmdW5jdGlvbigpe3RoaXMub3B0aW9ucy5jb2xvckJ5UG9pbnQ/dGhpcy5vcHRpb25zLmNvbG9yPW51bGw6dGhpcy5nZXRDeWNsaWMoXCJjb2xvclwiLHRoaXMub3B0aW9ucy5jb2xvcnx8V1t0aGlzLnR5cGVdLmNvbG9yLHRoaXMuY2hhcnQub3B0aW9ucy5jb2xvcnMpfSxnZXRTeW1ib2w6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9wdGlvbnMubWFya2VyO3RoaXMuZ2V0Q3ljbGljKFwic3ltYm9sXCIsYS5zeW1ib2wsdGhpcy5jaGFydC5vcHRpb25zLnN5bWJvbHMpO2lmKC9edXJsLy50ZXN0KHRoaXMuc3ltYm9sKSlhLnJhZGl1cz0wfSxkcmF3TGVnZW5kU3ltYm9sOmFhLmRyYXdMaW5lTWFya2VyLHNldERhdGE6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9dGhpcyxmPWUucG9pbnRzLGc9ZiYmZi5sZW5ndGh8fFxuMCxoLGk9ZS5vcHRpb25zLGo9ZS5jaGFydCxrPW51bGwsbD1lLnhBeGlzLG09bCYmISFsLmNhdGVnb3JpZXMsbz1pLnR1cmJvVGhyZXNob2xkLHA9dGhpcy54RGF0YSxyPXRoaXMueURhdGEsQT0oaD1lLnBvaW50QXJyYXlNYXApJiZoLmxlbmd0aCxhPWF8fFtdO2g9YS5sZW5ndGg7Yj1xKGIsITApO2lmKGQhPT0hMSYmaCYmZz09PWgmJiFlLmNyb3BwZWQmJiFlLmhhc0dyb3VwZWREYXRhJiZlLnZpc2libGUpbihhLGZ1bmN0aW9uKGEsYil7ZltiXS51cGRhdGUmJmEhPT1pLmRhdGFbYl0mJmZbYl0udXBkYXRlKGEsITEsbnVsbCwhMSl9KTtlbHNle2UueEluY3JlbWVudD1udWxsO2UuY29sb3JDb3VudGVyPTA7bih0aGlzLnBhcmFsbGVsQXJyYXlzLGZ1bmN0aW9uKGEpe2VbYStcIkRhdGFcIl0ubGVuZ3RoPTB9KTtpZihvJiZoPm8pe2ZvcihjPTA7az09PW51bGwmJmM8aDspaz1hW2NdLGMrKztpZih1YShrKSl7bT1xKGkucG9pbnRTdGFydCwwKTtrPXEoaS5wb2ludEludGVydmFsLDEpO2ZvcihjPVxuMDtjPGg7YysrKXBbY109bSxyW2NdPWFbY10sbSs9aztlLnhJbmNyZW1lbnQ9bX1lbHNlIGlmKEphKGspKWlmKEEpZm9yKGM9MDtjPGg7YysrKWs9YVtjXSxwW2NdPWtbMF0scltjXT1rLnNsaWNlKDEsQSsxKTtlbHNlIGZvcihjPTA7YzxoO2MrKylrPWFbY10scFtjXT1rWzBdLHJbY109a1sxXTtlbHNlIGdhKDEyKX1lbHNlIGZvcihjPTA7YzxoO2MrKylpZihhW2NdIT09dCYmKGs9e3NlcmllczplfSxlLnBvaW50Q2xhc3MucHJvdG90eXBlLmFwcGx5T3B0aW9ucy5hcHBseShrLFthW2NdXSksZS51cGRhdGVQYXJhbGxlbEFycmF5cyhrLGMpLG0mJnMoay5uYW1lKSkpbC5uYW1lc1trLnhdPWsubmFtZTtEYShyWzBdKSYmZ2EoMTQsITApO2UuZGF0YT1bXTtlLm9wdGlvbnMuZGF0YT1lLnVzZXJPcHRpb25zLmRhdGE9YTtmb3IoYz1nO2MtLTspZltjXSYmZltjXS5kZXN0cm95JiZmW2NdLmRlc3Ryb3koKTtpZihsKWwubWluUmFuZ2U9bC51c2VyTWluUmFuZ2U7ZS5pc0RpcnR5PWUuaXNEaXJ0eURhdGE9XG5qLmlzRGlydHlCb3g9ITA7Yz0hMX1pLmxlZ2VuZFR5cGU9PT1cInBvaW50XCImJih0aGlzLnByb2Nlc3NEYXRhKCksdGhpcy5nZW5lcmF0ZVBvaW50cygpKTtiJiZqLnJlZHJhdyhjKX0scHJvY2Vzc0RhdGE6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy54RGF0YSxjPXRoaXMueURhdGEsZD1iLmxlbmd0aCxlO2U9MDt2YXIgZixnLGg9dGhpcy54QXhpcyxpLGo9dGhpcy5vcHRpb25zO2k9ai5jcm9wVGhyZXNob2xkO3ZhciBrPXRoaXMuZ2V0RXh0cmVtZXNGcm9tQWxsfHxqLmdldEV4dHJlbWVzRnJvbUFsbCxsPXRoaXMuaXNDYXJ0ZXNpYW4saj1oJiZoLnZhbDJsaW4sbT1oJiZoLmlzTG9nLG8scDtpZihsJiYhdGhpcy5pc0RpcnR5JiYhaC5pc0RpcnR5JiYhdGhpcy55QXhpcy5pc0RpcnR5JiYhYSlyZXR1cm4hMTtpZihoKWE9aC5nZXRFeHRyZW1lcygpLG89YS5taW4scD1hLm1heDtpZihsJiZ0aGlzLnNvcnRlZCYmIWsmJighaXx8ZD5pfHx0aGlzLmZvcmNlQ3JvcCkpaWYoYltkLTFdPG98fFxuYlswXT5wKWI9W10sYz1bXTtlbHNlIGlmKGJbMF08b3x8YltkLTFdPnApZT10aGlzLmNyb3BEYXRhKHRoaXMueERhdGEsdGhpcy55RGF0YSxvLHApLGI9ZS54RGF0YSxjPWUueURhdGEsZT1lLnN0YXJ0LGY9ITA7Zm9yKGk9Yi5sZW5ndGh8fDE7LS1pOylkPW0/aihiW2ldKS1qKGJbaS0xXSk6YltpXS1iW2ktMV0sZD4wJiYoZz09PXR8fGQ8Zyk/Zz1kOmQ8MCYmdGhpcy5yZXF1aXJlU29ydGluZyYmZ2EoMTUpO3RoaXMuY3JvcHBlZD1mO3RoaXMuY3JvcFN0YXJ0PWU7dGhpcy5wcm9jZXNzZWRYRGF0YT1iO3RoaXMucHJvY2Vzc2VkWURhdGE9Yzt0aGlzLmNsb3Nlc3RQb2ludFJhbmdlPWd9LGNyb3BEYXRhOmZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPWEubGVuZ3RoLGY9MCxnPWUsaD1xKHRoaXMuY3JvcFNob3VsZGVyLDEpLGk7Zm9yKGk9MDtpPGU7aSsrKWlmKGFbaV0+PWMpe2Y9digwLGktaCk7YnJlYWt9Zm9yKGM9aTtjPGU7YysrKWlmKGFbY10+ZCl7Zz1jK2g7YnJlYWt9cmV0dXJue3hEYXRhOmEuc2xpY2UoZixcbmcpLHlEYXRhOmIuc2xpY2UoZixnKSxzdGFydDpmLGVuZDpnfX0sZ2VuZXJhdGVQb2ludHM6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9wdGlvbnMuZGF0YSxiPXRoaXMuZGF0YSxjLGQ9dGhpcy5wcm9jZXNzZWRYRGF0YSxlPXRoaXMucHJvY2Vzc2VkWURhdGEsZj10aGlzLnBvaW50Q2xhc3MsZz1kLmxlbmd0aCxoPXRoaXMuY3JvcFN0YXJ0fHwwLGksaj10aGlzLmhhc0dyb3VwZWREYXRhLGssbD1bXSxtO2lmKCFiJiYhailiPVtdLGIubGVuZ3RoPWEubGVuZ3RoLGI9dGhpcy5kYXRhPWI7Zm9yKG09MDttPGc7bSsrKWk9aCttLGo/KGxbbV09KG5ldyBmKS5pbml0KHRoaXMsW2RbbV1dLmNvbmNhdCh2YShlW21dKSkpLGxbbV0uZGF0YUdyb3VwPXRoaXMuZ3JvdXBNYXBbbV0pOihiW2ldP2s9YltpXTphW2ldIT09dCYmKGJbaV09az0obmV3IGYpLmluaXQodGhpcyxhW2ldLGRbbV0pKSxsW21dPWspLGxbbV0uaW5kZXg9aTtpZihiJiYoZyE9PShjPWIubGVuZ3RoKXx8aikpZm9yKG09MDttPFxuYzttKyspaWYobT09PWgmJiFqJiYobSs9ZyksYlttXSliW21dLmRlc3Ryb3lFbGVtZW50cygpLGJbbV0ucGxvdFg9dDt0aGlzLmRhdGE9Yjt0aGlzLnBvaW50cz1sfSxnZXRFeHRyZW1lczpmdW5jdGlvbihhKXt2YXIgYj10aGlzLnlBeGlzLGM9dGhpcy5wcm9jZXNzZWRYRGF0YSxkLGU9W10sZj0wO2Q9dGhpcy54QXhpcy5nZXRFeHRyZW1lcygpO3ZhciBnPWQubWluLGg9ZC5tYXgsaSxqLGssbCxhPWF8fHRoaXMuc3RhY2tlZFlEYXRhfHx0aGlzLnByb2Nlc3NlZFlEYXRhO2Q9YS5sZW5ndGg7Zm9yKGw9MDtsPGQ7bCsrKWlmKGo9Y1tsXSxrPWFbbF0saT1rIT09bnVsbCYmayE9PXQmJighYi5pc0xvZ3x8ay5sZW5ndGh8fGs+MCksaj10aGlzLmdldEV4dHJlbWVzRnJvbUFsbHx8dGhpcy5vcHRpb25zLmdldEV4dHJlbWVzRnJvbUFsbHx8dGhpcy5jcm9wcGVkfHwoY1tsKzFdfHxqKT49ZyYmKGNbbC0xXXx8aik8PWgsaSYmailpZihpPWsubGVuZ3RoKWZvcig7aS0tOylrW2ldIT09bnVsbCYmXG4oZVtmKytdPWtbaV0pO2Vsc2UgZVtmKytdPWs7dGhpcy5kYXRhTWluPU9hKGUpO3RoaXMuZGF0YU1heD1FYShlKX0sdHJhbnNsYXRlOmZ1bmN0aW9uKCl7dGhpcy5wcm9jZXNzZWRYRGF0YXx8dGhpcy5wcm9jZXNzRGF0YSgpO3RoaXMuZ2VuZXJhdGVQb2ludHMoKTtmb3IodmFyIGE9dGhpcy5vcHRpb25zLGI9YS5zdGFja2luZyxjPXRoaXMueEF4aXMsZD1jLmNhdGVnb3JpZXMsZT10aGlzLnlBeGlzLGY9dGhpcy5wb2ludHMsZz1mLmxlbmd0aCxoPSEhdGhpcy5tb2RpZnlWYWx1ZSxpPWEucG9pbnRQbGFjZW1lbnQsaj1pPT09XCJiZXR3ZWVuXCJ8fHVhKGkpLGs9YS50aHJlc2hvbGQsbD1hLnN0YXJ0RnJvbVRocmVzaG9sZD9rOjAsbSxvLHAscixBPU51bWJlci5NQVhfVkFMVUUsYT0wO2E8ZzthKyspe3ZhciBuPWZbYV0sdT1uLngsdz1uLnk7bz1uLmxvdzt2YXIgTz1iJiZlLnN0YWNrc1sodGhpcy5uZWdTdGFja3MmJnc8KGw/MDprKT9cIi1cIjpcIlwiKSt0aGlzLnN0YWNrS2V5XTtpZihlLmlzTG9nJiZcbnchPT1udWxsJiZ3PD0wKW4ueT13PW51bGwsZ2EoMTApO24ucGxvdFg9bT1FKHYoLTFFNSxjLnRyYW5zbGF0ZSh1LDAsMCwwLDEsaSx0aGlzLnR5cGU9PT1cImZsYWdzXCIpKSwxRTUpO2lmKGImJnRoaXMudmlzaWJsZSYmIW4uaXNOdWxsJiZPJiZPW3VdKXI9dGhpcy5nZXRTdGFja0luZGljYXRvcihyLHUsdGhpcy5pbmRleCksTz1PW3VdLHc9Ty5wb2ludHNbci5rZXldLG89d1swXSx3PXdbMV0sbz09PWwmJihvPXEoayxlLm1pbikpLGUuaXNMb2cmJm88PTAmJihvPW51bGwpLG4udG90YWw9bi5zdGFja1RvdGFsPU8udG90YWwsbi5wZXJjZW50YWdlPU8udG90YWwmJm4ueS9PLnRvdGFsKjEwMCxuLnN0YWNrWT13LE8uc2V0T2Zmc2V0KHRoaXMucG9pbnRYT2Zmc2V0fHwwLHRoaXMuYmFyV3x8MCk7bi55Qm90dG9tPXMobyk/ZS50cmFuc2xhdGUobywwLDEsMCwxKTpudWxsO2gmJih3PXRoaXMubW9kaWZ5VmFsdWUodyxuKSk7bi5wbG90WT1vPXR5cGVvZiB3PT09XCJudW1iZXJcIiYmdyE9PUluZmluaXR5P1xuRSh2KC0xRTUsZS50cmFuc2xhdGUodywwLDEsMCwxKSksMUU1KTp0O24uaXNJbnNpZGU9byE9PXQmJm8+PTAmJm88PWUubGVuJiZtPj0wJiZtPD1jLmxlbjtuLmNsaWVudFg9aj9jLnRyYW5zbGF0ZSh1LDAsMCwwLDEpOm07bi5uZWdhdGl2ZT1uLnk8KGt8fDApO24uY2F0ZWdvcnk9ZCYmZFtuLnhdIT09dD9kW24ueF06bi54O24uaXNOdWxsfHwocCE9PXZvaWQgMCYmKEE9RShBLFMobS1wKSkpLHA9bSl9dGhpcy5jbG9zZXN0UG9pbnRSYW5nZVB4PUF9LGdldFZhbGlkUG9pbnRzOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5jaGFydDtyZXR1cm4gU2EoYXx8dGhpcy5wb2ludHN8fFtdLGZ1bmN0aW9uKGEpe3JldHVybiBiJiYhYy5pc0luc2lkZVBsb3QoYS5wbG90WCxhLnBsb3RZLGMuaW52ZXJ0ZWQpPyExOiFhLmlzTnVsbH0pfSxzZXRDbGlwOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY2hhcnQsYz10aGlzLm9wdGlvbnMsZD1iLnJlbmRlcmVyLGU9Yi5pbnZlcnRlZCxmPXRoaXMuY2xpcEJveCxcbmc9Znx8Yi5jbGlwQm94LGg9dGhpcy5zaGFyZWRDbGlwS2V5fHxbXCJfc2hhcmVkQ2xpcFwiLGEmJmEuZHVyYXRpb24sYSYmYS5lYXNpbmcsZy5oZWlnaHQsYy54QXhpcyxjLnlBeGlzXS5qb2luKFwiLFwiKSxpPWJbaF0saj1iW2grXCJtXCJdO2lmKCFpKXtpZihhKWcud2lkdGg9MCxiW2grXCJtXCJdPWo9ZC5jbGlwUmVjdCgtOTksZT8tYi5wbG90TGVmdDotYi5wbG90VG9wLDk5LGU/Yi5jaGFydFdpZHRoOmIuY2hhcnRIZWlnaHQpO2JbaF09aT1kLmNsaXBSZWN0KGcpfWEmJihpLmNvdW50Kz0xKTtpZihjLmNsaXAhPT0hMSl0aGlzLmdyb3VwLmNsaXAoYXx8Zj9pOmIuY2xpcFJlY3QpLHRoaXMubWFya2VyR3JvdXAuY2xpcChqKSx0aGlzLnNoYXJlZENsaXBLZXk9aDthfHwoaS5jb3VudC09MSxpLmNvdW50PD0wJiZoJiZiW2hdJiYoZnx8KGJbaF09YltoXS5kZXN0cm95KCkpLGJbaCtcIm1cIl0mJihiW2grXCJtXCJdPWJbaCtcIm1cIl0uZGVzdHJveSgpKSkpfSxhbmltYXRlOmZ1bmN0aW9uKGEpe3ZhciBiPVxudGhpcy5jaGFydCxjPXRoaXMub3B0aW9ucy5hbmltYXRpb24sZDtpZihjJiYhZGEoYykpYz1XW3RoaXMudHlwZV0uYW5pbWF0aW9uO2E/dGhpcy5zZXRDbGlwKGMpOihkPXRoaXMuc2hhcmVkQ2xpcEtleSwoYT1iW2RdKSYmYS5hbmltYXRlKHt3aWR0aDpiLnBsb3RTaXplWH0sYyksYltkK1wibVwiXSYmYltkK1wibVwiXS5hbmltYXRlKHt3aWR0aDpiLnBsb3RTaXplWCs5OX0sYyksdGhpcy5hbmltYXRlPW51bGwpfSxhZnRlckFuaW1hdGU6ZnVuY3Rpb24oKXt0aGlzLnNldENsaXAoKTtNKHRoaXMsXCJhZnRlckFuaW1hdGVcIil9LGRyYXdQb2ludHM6ZnVuY3Rpb24oKXt2YXIgYSxiPXRoaXMucG9pbnRzLGM9dGhpcy5jaGFydCxkLGUsZixnLGgsaSxqLGssbD10aGlzLm9wdGlvbnMubWFya2VyLG09dGhpcy5wb2ludEF0dHJbXCJcIl0sbyxwLHIsQT10aGlzLm1hcmtlckdyb3VwLG49cShsLmVuYWJsZWQsdGhpcy54QXhpcy5pc1JhZGlhbCx0aGlzLmNsb3Nlc3RQb2ludFJhbmdlUHg+MipsLnJhZGl1cyk7XG5pZihsLmVuYWJsZWQhPT0hMXx8dGhpcy5faGFzUG9pbnRNYXJrZXJzKWZvcihmPWIubGVuZ3RoO2YtLTspaWYoZz1iW2ZdLGQ9VihnLnBsb3RYKSxlPWcucGxvdFksaz1nLmdyYXBoaWMsbz1nLm1hcmtlcnx8e30scD0hIWcubWFya2VyLGE9biYmby5lbmFibGVkPT09dHx8by5lbmFibGVkLHI9Zy5pc0luc2lkZSxhJiZlIT09dCYmIWlzTmFOKGUpJiZnLnkhPT1udWxsKWlmKGE9Zy5wb2ludEF0dHJbZy5zZWxlY3RlZD9cInNlbGVjdFwiOlwiXCJdfHxtLGg9YS5yLGk9cShvLnN5bWJvbCx0aGlzLnN5bWJvbCksaj1pLmluZGV4T2YoXCJ1cmxcIik9PT0wLGspa1tyP1wic2hvd1wiOlwiaGlkZVwiXSghMCkuYXR0cihhKS5hbmltYXRlKHgoe3g6ZC1oLHk6ZS1ofSxrLnN5bWJvbE5hbWU/e3dpZHRoOjIqaCxoZWlnaHQ6MipofTp7fSkpO2Vsc2V7aWYociYmKGg+MHx8aikpZy5ncmFwaGljPWMucmVuZGVyZXIuc3ltYm9sKGksZC1oLGUtaCwyKmgsMipoLHA/bzpsKS5hdHRyKGEpLmFkZChBKX1lbHNlIGlmKGspZy5ncmFwaGljPVxuay5kZXN0cm95KCl9LGNvbnZlcnRBdHRyaWJzOmZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPXRoaXMucG9pbnRBdHRyVG9PcHRpb25zLGYsZyxoPXt9LGE9YXx8e30sYj1ifHx7fSxjPWN8fHt9LGQ9ZHx8e307Zm9yKGYgaW4gZSlnPWVbZl0saFtmXT1xKGFbZ10sYltmXSxjW2ZdLGRbZl0pO3JldHVybiBofSxnZXRBdHRyaWJzOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEub3B0aW9ucyxjPVdbYS50eXBlXS5tYXJrZXI/Yi5tYXJrZXI6YixkPWMuc3RhdGVzLGU9ZC5ob3ZlcixmLGc9YS5jb2xvcixoPWEub3B0aW9ucy5uZWdhdGl2ZUNvbG9yO2Y9e3N0cm9rZTpnLGZpbGw6Z307dmFyIGk9YS5wb2ludHN8fFtdLGosayxsPVtdLG09YS5wb2ludEF0dHJUb09wdGlvbnM7aj1hLmhhc1BvaW50U3BlY2lmaWNPcHRpb25zO3ZhciBvPWMubGluZUNvbG9yLHA9Yy5maWxsQ29sb3I7az1iLnR1cmJvVGhyZXNob2xkO3ZhciByPWEuem9uZXMsQT1hLnpvbmVBeGlzfHxcInlcIixQO2IubWFya2VyPyhlLnJhZGl1cz1cbmUucmFkaXVzfHxjLnJhZGl1cytlLnJhZGl1c1BsdXMsZS5saW5lV2lkdGg9ZS5saW5lV2lkdGh8fGMubGluZVdpZHRoK2UubGluZVdpZHRoUGx1cyk6KGUuY29sb3I9ZS5jb2xvcnx8d2EoZS5jb2xvcnx8ZykuYnJpZ2h0ZW4oZS5icmlnaHRuZXNzKS5nZXQoKSxlLm5lZ2F0aXZlQ29sb3I9ZS5uZWdhdGl2ZUNvbG9yfHx3YShlLm5lZ2F0aXZlQ29sb3J8fGgpLmJyaWdodGVuKGUuYnJpZ2h0bmVzcykuZ2V0KCkpO2xbXCJcIl09YS5jb252ZXJ0QXR0cmlicyhjLGYpO24oW1wiaG92ZXJcIixcInNlbGVjdFwiXSxmdW5jdGlvbihiKXtsW2JdPWEuY29udmVydEF0dHJpYnMoZFtiXSxsW1wiXCJdKX0pO2EucG9pbnRBdHRyPWw7Zz1pLmxlbmd0aDtpZigha3x8ZzxrfHxqKWZvcig7Zy0tOyl7az1pW2ddO2lmKChjPWsub3B0aW9ucyYmay5vcHRpb25zLm1hcmtlcnx8ay5vcHRpb25zKSYmYy5lbmFibGVkPT09ITEpYy5yYWRpdXM9MDtpZihyLmxlbmd0aCl7aj0wO2ZvcihmPXJbal07a1tBXT49Zi52YWx1ZTspZj1cbnJbKytqXTtrLmNvbG9yPWsuZmlsbENvbG9yPXEoZi5jb2xvcixhLmNvbG9yKX1qPWIuY29sb3JCeVBvaW50fHxrLmNvbG9yO2lmKGsub3B0aW9ucylmb3IoUCBpbiBtKXMoY1ttW1BdXSkmJihqPSEwKTtpZihqKXtjPWN8fHt9O2o9W107ZD1jLnN0YXRlc3x8e307Zj1kLmhvdmVyPWQuaG92ZXJ8fHt9O2lmKCFiLm1hcmtlcnx8ay5uZWdhdGl2ZSYmIWYuZmlsbENvbG9yJiYhZS5maWxsQ29sb3IpZlthLnBvaW50QXR0clRvT3B0aW9ucy5maWxsXT1mLmNvbG9yfHwhay5vcHRpb25zLmNvbG9yJiZlW2submVnYXRpdmUmJmg/XCJuZWdhdGl2ZUNvbG9yXCI6XCJjb2xvclwiXXx8d2Eoay5jb2xvcikuYnJpZ2h0ZW4oZi5icmlnaHRuZXNzfHxlLmJyaWdodG5lc3MpLmdldCgpO2Y9e2NvbG9yOmsuY29sb3J9O2lmKCFwKWYuZmlsbENvbG9yPWsuY29sb3I7aWYoIW8pZi5saW5lQ29sb3I9ay5jb2xvcjtjLmhhc093blByb3BlcnR5KFwiY29sb3JcIikmJiFjLmNvbG9yJiZkZWxldGUgYy5jb2xvcjtqW1wiXCJdPVxuYS5jb252ZXJ0QXR0cmlicyh4KGYsYyksbFtcIlwiXSk7ai5ob3Zlcj1hLmNvbnZlcnRBdHRyaWJzKGQuaG92ZXIsbC5ob3ZlcixqW1wiXCJdKTtqLnNlbGVjdD1hLmNvbnZlcnRBdHRyaWJzKGQuc2VsZWN0LGwuc2VsZWN0LGpbXCJcIl0pfWVsc2Ugaj1sO2sucG9pbnRBdHRyPWp9fSxkZXN0cm95OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEuY2hhcnQsYz0vQXBwbGVXZWJLaXRcXC81MzMvLnRlc3QoTWEpLGQsZT1hLmRhdGF8fFtdLGYsZyxoO00oYSxcImRlc3Ryb3lcIik7VChhKTtuKGEuYXhpc1R5cGVzfHxbXSxmdW5jdGlvbihiKXtpZihoPWFbYl0pQWEoaC5zZXJpZXMsYSksaC5pc0RpcnR5PWguZm9yY2VSZWRyYXc9ITB9KTthLmxlZ2VuZEl0ZW0mJmEuY2hhcnQubGVnZW5kLmRlc3Ryb3lJdGVtKGEpO2ZvcihkPWUubGVuZ3RoO2QtLTspKGY9ZVtkXSkmJmYuZGVzdHJveSYmZi5kZXN0cm95KCk7YS5wb2ludHM9bnVsbDtjbGVhclRpbWVvdXQoYS5hbmltYXRpb25UaW1lb3V0KTtmb3IoZyBpbiBhKWFbZ11pbnN0YW5jZW9mXG5aJiYhYVtnXS5zdXJ2aXZlJiYoZD1jJiZnPT09XCJncm91cFwiP1wiaGlkZVwiOlwiZGVzdHJveVwiLGFbZ11bZF0oKSk7aWYoYi5ob3ZlclNlcmllcz09PWEpYi5ob3ZlclNlcmllcz1udWxsO0FhKGIuc2VyaWVzLGEpO2ZvcihnIGluIGEpZGVsZXRlIGFbZ119LGdldEdyYXBoUGF0aDpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9dGhpcyxlPWQub3B0aW9ucyxmPWUuc3RlcCxnLGg9W10saSxhPWF8fGQucG9pbnRzOyhnPWEucmV2ZXJzZWQpJiZhLnJldmVyc2UoKTsoZj17cmlnaHQ6MSxjZW50ZXI6Mn1bZl18fGYmJjMpJiZnJiYoZj00LWYpO2UuY29ubmVjdE51bGxzJiYhYiYmIWMmJihhPXRoaXMuZ2V0VmFsaWRQb2ludHMoYSkpO24oYSxmdW5jdGlvbihnLGspe3ZhciBsPWcucGxvdFgsbT1nLnBsb3RZLG89YVtrLTFdO2lmKChnLmxlZnRDbGlmZnx8byYmby5yaWdodENsaWZmKSYmIWMpaT0hMDtnLmlzTnVsbCYmIXMoYikmJms+MD9pPSFlLmNvbm5lY3ROdWxsczpnLmlzTnVsbCYmIWI/aT0hMDpcbihrPT09MHx8aT9vPVtcIk1cIixnLnBsb3RYLGcucGxvdFldOmQuZ2V0UG9pbnRTcGxpbmU/bz1kLmdldFBvaW50U3BsaW5lKGEsZyxrKTpmPyhvPWY9PT0xP1tcIkxcIixvLnBsb3RYLG1dOmY9PT0yP1tcIkxcIiwoby5wbG90WCtsKS8yLG8ucGxvdFksXCJMXCIsKG8ucGxvdFgrbCkvMixtXTpbXCJMXCIsbCxvLnBsb3RZXSxvLnB1c2goXCJMXCIsbCxtKSk6bz1bXCJMXCIsbCxtXSxoLnB1c2guYXBwbHkoaCxvKSxpPSExKX0pO3JldHVybiBkLmdyYXBoUGF0aD1ofSxkcmF3R3JhcGg6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9dGhpcy5vcHRpb25zLGM9W1tcImdyYXBoXCIsYi5saW5lQ29sb3J8fHRoaXMuY29sb3IsYi5kYXNoU3R5bGVdXSxkPWIubGluZVdpZHRoLGU9Yi5saW5lY2FwIT09XCJzcXVhcmVcIixmPSh0aGlzLmdhcHBlZFBhdGh8fHRoaXMuZ2V0R3JhcGhQYXRoKS5jYWxsKHRoaXMpLGc9dGhpcy5maWxsR3JhcGgmJnRoaXMuY29sb3J8fFwibm9uZVwiO24odGhpcy56b25lcyxmdW5jdGlvbihkLGUpe2MucHVzaChbXCJ6b25lR3JhcGhcIitcbmUsZC5jb2xvcnx8YS5jb2xvcixkLmRhc2hTdHlsZXx8Yi5kYXNoU3R5bGVdKX0pO24oYyxmdW5jdGlvbihjLGkpe3ZhciBqPWNbMF0saz1hW2pdO2lmKGspay5hbmltYXRlKHtkOmZ9KTtlbHNlIGlmKChkfHxnKSYmZi5sZW5ndGgpaz17c3Ryb2tlOmNbMV0sXCJzdHJva2Utd2lkdGhcIjpkLGZpbGw6Zyx6SW5kZXg6MX0sY1syXT9rLmRhc2hzdHlsZT1jWzJdOmUmJihrW1wic3Ryb2tlLWxpbmVjYXBcIl09a1tcInN0cm9rZS1saW5lam9pblwiXT1cInJvdW5kXCIpLGFbal09YS5jaGFydC5yZW5kZXJlci5wYXRoKGYpLmF0dHIoaykuYWRkKGEuZ3JvdXApLnNoYWRvdyhpPDImJmIuc2hhZG93KX0pfSxhcHBseVpvbmVzOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPXRoaXMuY2hhcnQsYz1iLnJlbmRlcmVyLGQ9dGhpcy56b25lcyxlLGYsZz10aGlzLmNsaXBzfHxbXSxoLGk9dGhpcy5ncmFwaCxqPXRoaXMuYXJlYSxrPXYoYi5jaGFydFdpZHRoLGIuY2hhcnRIZWlnaHQpLGw9dGhpc1sodGhpcy56b25lQXhpc3x8XG5cInlcIikrXCJBeGlzXCJdLG0sbz1sLnJldmVyc2VkLHA9Yi5pbnZlcnRlZCxyPWwuaG9yaXosQSxQLHUsdz0hMTtpZihkLmxlbmd0aCYmKGl8fGopJiZsLm1pbiE9PXQpaSYmaS5oaWRlKCksaiYmai5oaWRlKCksbT1sLmdldEV4dHJlbWVzKCksbihkLGZ1bmN0aW9uKGQsbil7ZT1vP3I/Yi5wbG90V2lkdGg6MDpyPzA6bC50b1BpeGVscyhtLm1pbik7ZT1FKHYocShmLGUpLDApLGspO2Y9RSh2KHkobC50b1BpeGVscyhxKGQudmFsdWUsbS5tYXgpLCEwKSksMCksayk7dyYmKGU9Zj1sLnRvUGl4ZWxzKG0ubWF4KSk7QT1NYXRoLmFicyhlLWYpO1A9RShlLGYpO3U9dihlLGYpO2lmKGwuaXNYQXhpcyl7aWYoaD17eDpwP3U6UCx5OjAsd2lkdGg6QSxoZWlnaHQ6a30sIXIpaC54PWIucGxvdEhlaWdodC1oLnh9ZWxzZSBpZihoPXt4OjAseTpwP3U6UCx3aWR0aDprLGhlaWdodDpBfSxyKWgueT1iLnBsb3RXaWR0aC1oLnk7Yi5pbnZlcnRlZCYmYy5pc1ZNTCYmKGg9bC5pc1hBeGlzP3t4OjAseTpvP1xuUDp1LGhlaWdodDpoLndpZHRoLHdpZHRoOmIuY2hhcnRXaWR0aH06e3g6aC55LWIucGxvdExlZnQtYi5zcGFjaW5nQm94LngseTowLHdpZHRoOmguaGVpZ2h0LGhlaWdodDpiLmNoYXJ0SGVpZ2h0fSk7Z1tuXT9nW25dLmFuaW1hdGUoaCk6KGdbbl09Yy5jbGlwUmVjdChoKSxpJiZhW1wiem9uZUdyYXBoXCIrbl0uY2xpcChnW25dKSxqJiZhW1wiem9uZUFyZWFcIituXS5jbGlwKGdbbl0pKTt3PWQudmFsdWU+bS5tYXh9KSx0aGlzLmNsaXBzPWd9LGludmVydEdyb3VwczpmdW5jdGlvbigpe2Z1bmN0aW9uIGEoKXt2YXIgYT17d2lkdGg6Yi55QXhpcy5sZW4saGVpZ2h0OmIueEF4aXMubGVufTtuKFtcImdyb3VwXCIsXCJtYXJrZXJHcm91cFwiXSxmdW5jdGlvbihjKXtiW2NdJiZiW2NdLmF0dHIoYSkuaW52ZXJ0KCl9KX12YXIgYj10aGlzLGM9Yi5jaGFydDtpZihiLnhBeGlzKUQoYyxcInJlc2l6ZVwiLGEpLEQoYixcImRlc3Ryb3lcIixmdW5jdGlvbigpe1QoYyxcInJlc2l6ZVwiLGEpfSksYSgpLGIuaW52ZXJ0R3JvdXBzPVxuYX0scGxvdEdyb3VwOmZ1bmN0aW9uKGEsYixjLGQsZSl7dmFyIGY9dGhpc1thXSxnPSFmO2cmJih0aGlzW2FdPWY9dGhpcy5jaGFydC5yZW5kZXJlci5nKGIpLmF0dHIoe3pJbmRleDpkfHwwLjF9KS5hZGQoZSksZi5hZGRDbGFzcyhcImhpZ2hjaGFydHMtc2VyaWVzLVwiK3RoaXMuaW5kZXgpKTtmLmF0dHIoe3Zpc2liaWxpdHk6Y30pW2c/XCJhdHRyXCI6XCJhbmltYXRlXCJdKHRoaXMuZ2V0UGxvdEJveCgpKTtyZXR1cm4gZn0sZ2V0UGxvdEJveDpmdW5jdGlvbigpe3ZhciBhPXRoaXMuY2hhcnQsYj10aGlzLnhBeGlzLGM9dGhpcy55QXhpcztpZihhLmludmVydGVkKWI9YyxjPXRoaXMueEF4aXM7cmV0dXJue3RyYW5zbGF0ZVg6Yj9iLmxlZnQ6YS5wbG90TGVmdCx0cmFuc2xhdGVZOmM/Yy50b3A6YS5wbG90VG9wLHNjYWxlWDoxLHNjYWxlWToxfX0scmVuZGVyOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEuY2hhcnQsYyxkPWEub3B0aW9ucyxlPSEhYS5hbmltYXRlJiZiLnJlbmRlcmVyLmlzU1ZHJiZcbmhiKGQuYW5pbWF0aW9uKS5kdXJhdGlvbixmPWEudmlzaWJsZT9cImluaGVyaXRcIjpcImhpZGRlblwiLGc9ZC56SW5kZXgsaD1hLmhhc1JlbmRlcmVkLGk9Yi5zZXJpZXNHcm91cDtjPWEucGxvdEdyb3VwKFwiZ3JvdXBcIixcInNlcmllc1wiLGYsZyxpKTthLm1hcmtlckdyb3VwPWEucGxvdEdyb3VwKFwibWFya2VyR3JvdXBcIixcIm1hcmtlcnNcIixmLGcsaSk7ZSYmYS5hbmltYXRlKCEwKTthLmdldEF0dHJpYnMoKTtjLmludmVydGVkPWEuaXNDYXJ0ZXNpYW4/Yi5pbnZlcnRlZDohMTthLmRyYXdHcmFwaCYmKGEuZHJhd0dyYXBoKCksYS5hcHBseVpvbmVzKCkpO24oYS5wb2ludHMsZnVuY3Rpb24oYSl7YS5yZWRyYXcmJmEucmVkcmF3KCl9KTthLmRyYXdEYXRhTGFiZWxzJiZhLmRyYXdEYXRhTGFiZWxzKCk7YS52aXNpYmxlJiZhLmRyYXdQb2ludHMoKTthLmRyYXdUcmFja2VyJiZhLm9wdGlvbnMuZW5hYmxlTW91c2VUcmFja2luZyE9PSExJiZhLmRyYXdUcmFja2VyKCk7Yi5pbnZlcnRlZCYmYS5pbnZlcnRHcm91cHMoKTtcbmQuY2xpcCE9PSExJiYhYS5zaGFyZWRDbGlwS2V5JiYhaCYmYy5jbGlwKGIuY2xpcFJlY3QpO2UmJmEuYW5pbWF0ZSgpO2lmKCFoKWEuYW5pbWF0aW9uVGltZW91dD0kYShmdW5jdGlvbigpe2EuYWZ0ZXJBbmltYXRlKCl9LGUpO2EuaXNEaXJ0eT1hLmlzRGlydHlEYXRhPSExO2EuaGFzUmVuZGVyZWQ9ITB9LHJlZHJhdzpmdW5jdGlvbigpe3ZhciBhPXRoaXMuY2hhcnQsYj10aGlzLmlzRGlydHlEYXRhLGM9dGhpcy5pc0RpcnR5LGQ9dGhpcy5ncm91cCxlPXRoaXMueEF4aXMsZj10aGlzLnlBeGlzO2QmJihhLmludmVydGVkJiZkLmF0dHIoe3dpZHRoOmEucGxvdFdpZHRoLGhlaWdodDphLnBsb3RIZWlnaHR9KSxkLmFuaW1hdGUoe3RyYW5zbGF0ZVg6cShlJiZlLmxlZnQsYS5wbG90TGVmdCksdHJhbnNsYXRlWTpxKGYmJmYudG9wLGEucGxvdFRvcCl9KSk7dGhpcy50cmFuc2xhdGUoKTt0aGlzLnJlbmRlcigpO2ImJk0odGhpcyxcInVwZGF0ZWREYXRhXCIpOyhjfHxiKSYmZGVsZXRlIHRoaXMua2RUcmVlfSxcbmtkRGltZW5zaW9uczoxLGtkQXhpc0FycmF5OltcImNsaWVudFhcIixcInBsb3RZXCJdLHNlYXJjaFBvaW50OmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy54QXhpcyxkPXRoaXMueUF4aXMsZT10aGlzLmNoYXJ0LmludmVydGVkO3JldHVybiB0aGlzLnNlYXJjaEtEVHJlZSh7Y2xpZW50WDplP2MubGVuLWEuY2hhcnRZK2MucG9zOmEuY2hhcnRYLWMucG9zLHBsb3RZOmU/ZC5sZW4tYS5jaGFydFgrZC5wb3M6YS5jaGFydFktZC5wb3N9LGIpfSxidWlsZEtEVHJlZTpmdW5jdGlvbigpe2Z1bmN0aW9uIGEoYyxlLGYpe3ZhciBnLGg7aWYoaD1jJiZjLmxlbmd0aClyZXR1cm4gZz1iLmtkQXhpc0FycmF5W2UlZl0sYy5zb3J0KGZ1bmN0aW9uKGEsYil7cmV0dXJuIGFbZ10tYltnXX0pLGg9TWF0aC5mbG9vcihoLzIpLHtwb2ludDpjW2hdLGxlZnQ6YShjLnNsaWNlKDAsaCksZSsxLGYpLHJpZ2h0OmEoYy5zbGljZShoKzEpLGUrMSxmKX19dmFyIGI9dGhpcyxjPWIua2REaW1lbnNpb25zO2RlbGV0ZSBiLmtkVHJlZTtcbiRhKGZ1bmN0aW9uKCl7Yi5rZFRyZWU9YShiLmdldFZhbGlkUG9pbnRzKG51bGwsIWIuZGlyZWN0VG91Y2gpLGMsYyl9LGIub3B0aW9ucy5rZE5vdz8wOjEpfSxzZWFyY2hLRFRyZWU6ZnVuY3Rpb24oYSxiKXtmdW5jdGlvbiBjKGEsYixqLGspe3ZhciBsPWIucG9pbnQsbT1kLmtkQXhpc0FycmF5W2ola10sbyxwLHI9bDtwPXMoYVtlXSkmJnMobFtlXSk/TWF0aC5wb3coYVtlXS1sW2VdLDIpOm51bGw7bz1zKGFbZl0pJiZzKGxbZl0pP01hdGgucG93KGFbZl0tbFtmXSwyKTpudWxsO289KHB8fDApKyhvfHwwKTtsLmRpc3Q9cyhvKT9NYXRoLnNxcnQobyk6TnVtYmVyLk1BWF9WQUxVRTtsLmRpc3RYPXMocCk/TWF0aC5zcXJ0KHApOk51bWJlci5NQVhfVkFMVUU7bT1hW21dLWxbbV07bz1tPDA/XCJsZWZ0XCI6XCJyaWdodFwiO3A9bTwwP1wicmlnaHRcIjpcImxlZnRcIjtiW29dJiYobz1jKGEsYltvXSxqKzEsaykscj1vW2ddPHJbZ10/bzpsKTtiW3BdJiZNYXRoLnNxcnQobSptKTxyW2ddJiYoYT1jKGEsXG5iW3BdLGorMSxrKSxyPWFbZ108cltnXT9hOnIpO3JldHVybiByfXZhciBkPXRoaXMsZT10aGlzLmtkQXhpc0FycmF5WzBdLGY9dGhpcy5rZEF4aXNBcnJheVsxXSxnPWI/XCJkaXN0WFwiOlwiZGlzdFwiO3RoaXMua2RUcmVlfHx0aGlzLmJ1aWxkS0RUcmVlKCk7aWYodGhpcy5rZFRyZWUpcmV0dXJuIGMoYSx0aGlzLmtkVHJlZSx0aGlzLmtkRGltZW5zaW9ucyx0aGlzLmtkRGltZW5zaW9ucyl9fTtUYi5wcm90b3R5cGU9e2Rlc3Ryb3k6ZnVuY3Rpb24oKXtQYSh0aGlzLHRoaXMuYXhpcyl9LHJlbmRlcjpmdW5jdGlvbihhKXt2YXIgYj10aGlzLm9wdGlvbnMsYz1iLmZvcm1hdCxjPWM/TGEoYyx0aGlzKTpiLmZvcm1hdHRlci5jYWxsKHRoaXMpO3RoaXMubGFiZWw/dGhpcy5sYWJlbC5hdHRyKHt0ZXh0OmMsdmlzaWJpbGl0eTpcImhpZGRlblwifSk6dGhpcy5sYWJlbD10aGlzLmF4aXMuY2hhcnQucmVuZGVyZXIudGV4dChjLG51bGwsbnVsbCxiLnVzZUhUTUwpLmNzcyhiLnN0eWxlKS5hdHRyKHthbGlnbjp0aGlzLnRleHRBbGlnbixcbnJvdGF0aW9uOmIucm90YXRpb24sdmlzaWJpbGl0eTpcImhpZGRlblwifSkuYWRkKGEpfSxzZXRPZmZzZXQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmF4aXMsZD1jLmNoYXJ0LGU9ZC5pbnZlcnRlZCxmPWMucmV2ZXJzZWQsZj10aGlzLmlzTmVnYXRpdmUmJiFmfHwhdGhpcy5pc05lZ2F0aXZlJiZmLGc9Yy50cmFuc2xhdGUoYy51c2VQZXJjZW50YWdlPzEwMDp0aGlzLnRvdGFsLDAsMCwwLDEpLGM9Yy50cmFuc2xhdGUoMCksYz1TKGctYyksaD1kLnhBeGlzWzBdLnRyYW5zbGF0ZSh0aGlzLngpK2EsaT1kLnBsb3RIZWlnaHQsZj17eDplP2Y/ZzpnLWM6aCx5OmU/aS1oLWI6Zj9pLWctYzppLWcsd2lkdGg6ZT9jOmIsaGVpZ2h0OmU/YjpjfTtpZihlPXRoaXMubGFiZWwpZS5hbGlnbih0aGlzLmFsaWduT3B0aW9ucyxudWxsLGYpLGY9ZS5hbGlnbkF0dHIsZVt0aGlzLm9wdGlvbnMuY3JvcD09PSExfHxkLmlzSW5zaWRlUGxvdChmLngsZi55KT9cInNob3dcIjpcImhpZGVcIl0oITApfX07Q2EucHJvdG90eXBlLmdldFN0YWNrcz1cbmZ1bmN0aW9uKCl7dmFyIGE9dGhpcztuKGEueUF4aXMsZnVuY3Rpb24oYSl7aWYoYS5zdGFja3MmJmEuaGFzVmlzaWJsZVNlcmllcylhLm9sZFN0YWNrcz1hLnN0YWNrc30pO24oYS5zZXJpZXMsZnVuY3Rpb24oYil7aWYoYi5vcHRpb25zLnN0YWNraW5nJiYoYi52aXNpYmxlPT09ITB8fGEub3B0aW9ucy5jaGFydC5pZ25vcmVIaWRkZW5TZXJpZXM9PT0hMSkpYi5zdGFja0tleT1iLnR5cGUrcShiLm9wdGlvbnMuc3RhY2ssXCJcIil9KX07SS5wcm90b3R5cGUuYnVpbGRTdGFja3M9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLnNlcmllcyxiLGM9cSh0aGlzLm9wdGlvbnMucmV2ZXJzZWRTdGFja3MsITApLGQ9YS5sZW5ndGgsZTtpZighdGhpcy5pc1hBeGlzKXt0aGlzLnVzZVBlcmNlbnRhZ2U9ITE7Zm9yKGU9ZDtlLS07KWFbYz9lOmQtZS0xXS5zZXRTdGFja2VkUG9pbnRzKCk7Zm9yKGU9ZDtlLS07KWI9YVtjP2U6ZC1lLTFdLGIuc2V0U3RhY2tDbGlmZnMmJmIuc2V0U3RhY2tDbGlmZnMoKTtpZih0aGlzLnVzZVBlcmNlbnRhZ2UpZm9yKGU9XG4wO2U8ZDtlKyspYVtlXS5zZXRQZXJjZW50U3RhY2tzKCl9fTtJLnByb3RvdHlwZS5yZW5kZXJTdGFja1RvdGFscz1mdW5jdGlvbigpe3ZhciBhPXRoaXMuY2hhcnQsYj1hLnJlbmRlcmVyLGM9dGhpcy5zdGFja3MsZCxlLGY9dGhpcy5zdGFja1RvdGFsR3JvdXA7aWYoIWYpdGhpcy5zdGFja1RvdGFsR3JvdXA9Zj1iLmcoXCJzdGFjay1sYWJlbHNcIikuYXR0cih7dmlzaWJpbGl0eTpcInZpc2libGVcIix6SW5kZXg6Nn0pLmFkZCgpO2YudHJhbnNsYXRlKGEucGxvdExlZnQsYS5wbG90VG9wKTtmb3IoZCBpbiBjKWZvcihlIGluIGE9Y1tkXSxhKWFbZV0ucmVuZGVyKGYpfTtJLnByb3RvdHlwZS5yZXNldFN0YWNrcz1mdW5jdGlvbigpe3ZhciBhPXRoaXMuc3RhY2tzLGIsYztpZighdGhpcy5pc1hBeGlzKWZvcihiIGluIGEpZm9yKGMgaW4gYVtiXSlhW2JdW2NdLnRvdWNoZWQ8dGhpcy5zdGFja3NUb3VjaGVkPyhhW2JdW2NdLmRlc3Ryb3koKSxkZWxldGUgYVtiXVtjXSk6KGFbYl1bY10udG90YWw9XG5udWxsLGFbYl1bY10uY3VtPTApfTtJLnByb3RvdHlwZS5jbGVhblN0YWNrcz1mdW5jdGlvbigpe3ZhciBhLGIsYztpZighdGhpcy5pc1hBeGlzKXtpZih0aGlzLm9sZFN0YWNrcylhPXRoaXMuc3RhY2tzPXRoaXMub2xkU3RhY2tzO2ZvcihiIGluIGEpZm9yKGMgaW4gYVtiXSlhW2JdW2NdLmN1bT1hW2JdW2NdLnRvdGFsfX07US5wcm90b3R5cGUuc2V0U3RhY2tlZFBvaW50cz1mdW5jdGlvbigpe2lmKHRoaXMub3B0aW9ucy5zdGFja2luZyYmISh0aGlzLnZpc2libGUhPT0hMCYmdGhpcy5jaGFydC5vcHRpb25zLmNoYXJ0Lmlnbm9yZUhpZGRlblNlcmllcyE9PSExKSl7dmFyIGE9dGhpcy5wcm9jZXNzZWRYRGF0YSxiPXRoaXMucHJvY2Vzc2VkWURhdGEsYz1bXSxkPWIubGVuZ3RoLGU9dGhpcy5vcHRpb25zLGY9ZS50aHJlc2hvbGQsZz1lLnN0YXJ0RnJvbVRocmVzaG9sZD9mOjAsaD1lLnN0YWNrLGU9ZS5zdGFja2luZyxpPXRoaXMuc3RhY2tLZXksaj1cIi1cIitpLGs9dGhpcy5uZWdTdGFja3MsXG5sPXRoaXMueUF4aXMsbT1sLnN0YWNrcyxvPWwub2xkU3RhY2tzLHAscixuLFAsdSx3LHM7bC5zdGFja3NUb3VjaGVkKz0xO2Zvcih1PTA7dTxkO3UrKyl7dz1hW3VdO3M9Ylt1XTtwPXRoaXMuZ2V0U3RhY2tJbmRpY2F0b3IocCx3LHRoaXMuaW5kZXgpO1A9cC5rZXk7bj0ocj1rJiZzPChnPzA6ZikpP2o6aTttW25dfHwobVtuXT17fSk7aWYoIW1bbl1bd10pb1tuXSYmb1tuXVt3XT8obVtuXVt3XT1vW25dW3ddLG1bbl1bd10udG90YWw9bnVsbCk6bVtuXVt3XT1uZXcgVGIobCxsLm9wdGlvbnMuc3RhY2tMYWJlbHMscix3LGgpO249bVtuXVt3XTtpZihzIT09bnVsbCluLnBvaW50c1tQXT1uLnBvaW50c1t0aGlzLmluZGV4XT1bcShuLmN1bSxnKV0sbi50b3VjaGVkPWwuc3RhY2tzVG91Y2hlZCxwLmluZGV4PjAmJnRoaXMuc2luZ2xlU3RhY2tzPT09ITEmJihuLnBvaW50c1tQXVswXT1uLnBvaW50c1t0aGlzLmluZGV4K1wiLFwiK3crXCIsMFwiXVswXSk7ZT09PVwicGVyY2VudFwiPyhyPXI/aTpcbmosayYmbVtyXSYmbVtyXVt3XT8ocj1tW3JdW3ddLG4udG90YWw9ci50b3RhbD12KHIudG90YWwsbi50b3RhbCkrUyhzKXx8MCk6bi50b3RhbD1uYShuLnRvdGFsKyhTKHMpfHwwKSkpOm4udG90YWw9bmEobi50b3RhbCsoc3x8MCkpO24uY3VtPXEobi5jdW0sZykrKHN8fDApO2lmKHMhPT1udWxsKW4ucG9pbnRzW1BdLnB1c2gobi5jdW0pLGNbdV09bi5jdW19aWYoZT09PVwicGVyY2VudFwiKWwudXNlUGVyY2VudGFnZT0hMDt0aGlzLnN0YWNrZWRZRGF0YT1jO2wub2xkU3RhY2tzPXt9fX07US5wcm90b3R5cGUuc2V0UGVyY2VudFN0YWNrcz1mdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLnN0YWNrS2V5LGM9YS55QXhpcy5zdGFja3MsZD1hLnByb2Nlc3NlZFhEYXRhLGU7bihbYixcIi1cIitiXSxmdW5jdGlvbihiKXt2YXIgZjtmb3IodmFyIGc9ZC5sZW5ndGgsaCxpO2ctLTspaWYoaD1kW2ddLGU9YS5nZXRTdGFja0luZGljYXRvcihlLGgsYS5pbmRleCksZj0oaT1jW2JdJiZjW2JdW2hdKSYmXG5pLnBvaW50c1tlLmtleV0saD1mKWk9aS50b3RhbD8xMDAvaS50b3RhbDowLGhbMF09bmEoaFswXSppKSxoWzFdPW5hKGhbMV0qaSksYS5zdGFja2VkWURhdGFbZ109aFsxXX0pfTtRLnByb3RvdHlwZS5nZXRTdGFja0luZGljYXRvcj1mdW5jdGlvbihhLGIsYyl7IXMoYSl8fGEueCE9PWI/YT17eDpiLGluZGV4OjB9OmEuaW5kZXgrKzthLmtleT1bYyxiLGEuaW5kZXhdLmpvaW4oXCIsXCIpO3JldHVybiBhfTt4KENhLnByb3RvdHlwZSx7YWRkU2VyaWVzOmZ1bmN0aW9uKGEsYixjKXt2YXIgZCxlPXRoaXM7YSYmKGI9cShiLCEwKSxNKGUsXCJhZGRTZXJpZXNcIix7b3B0aW9uczphfSxmdW5jdGlvbigpe2Q9ZS5pbml0U2VyaWVzKGEpO2UuaXNEaXJ0eUxlZ2VuZD0hMDtlLmxpbmtTZXJpZXMoKTtiJiZlLnJlZHJhdyhjKX0pKTtyZXR1cm4gZH0sYWRkQXhpczpmdW5jdGlvbihhLGIsYyxkKXt2YXIgZT1iP1wieEF4aXNcIjpcInlBeGlzXCIsZj10aGlzLm9wdGlvbnMsYT1DKGEse2luZGV4OnRoaXNbZV0ubGVuZ3RoLFxuaXNYOmJ9KTtuZXcgSSh0aGlzLGEpO2ZbZV09dmEoZltlXXx8e30pO2ZbZV0ucHVzaChhKTtxKGMsITApJiZ0aGlzLnJlZHJhdyhkKX0sc2hvd0xvYWRpbmc6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcyxjPWIub3B0aW9ucyxkPWIubG9hZGluZ0RpdixlPWMubG9hZGluZyxmPWZ1bmN0aW9uKCl7ZCYmRihkLHtsZWZ0OmIucGxvdExlZnQrXCJweFwiLHRvcDpiLnBsb3RUb3ArXCJweFwiLHdpZHRoOmIucGxvdFdpZHRoK1wicHhcIixoZWlnaHQ6Yi5wbG90SGVpZ2h0K1wicHhcIn0pfTtpZighZCliLmxvYWRpbmdEaXY9ZD1lYShXYSx7Y2xhc3NOYW1lOlwiaGlnaGNoYXJ0cy1sb2FkaW5nXCJ9LHgoZS5zdHlsZSx7ekluZGV4OjEwLGRpc3BsYXk6XCJub25lXCJ9KSxiLmNvbnRhaW5lciksYi5sb2FkaW5nU3Bhbj1lYShcInNwYW5cIixudWxsLGUubGFiZWxTdHlsZSxkKSxEKGIsXCJyZWRyYXdcIixmKTtiLmxvYWRpbmdTcGFuLmlubmVySFRNTD1hfHxjLmxhbmcubG9hZGluZztpZighYi5sb2FkaW5nU2hvd24pRihkLFxue29wYWNpdHk6MCxkaXNwbGF5OlwiXCJ9KSxlYihkLHtvcGFjaXR5OmUuc3R5bGUub3BhY2l0eX0se2R1cmF0aW9uOmUuc2hvd0R1cmF0aW9ufHwwfSksYi5sb2FkaW5nU2hvd249ITA7ZigpfSxoaWRlTG9hZGluZzpmdW5jdGlvbigpe3ZhciBhPXRoaXMub3B0aW9ucyxiPXRoaXMubG9hZGluZ0RpdjtiJiZlYihiLHtvcGFjaXR5OjB9LHtkdXJhdGlvbjphLmxvYWRpbmcuaGlkZUR1cmF0aW9ufHwxMDAsY29tcGxldGU6ZnVuY3Rpb24oKXtGKGIse2Rpc3BsYXk6XCJub25lXCJ9KX19KTt0aGlzLmxvYWRpbmdTaG93bj0hMX19KTt4KEhhLnByb3RvdHlwZSx7dXBkYXRlOmZ1bmN0aW9uKGEsYixjLGQpe2Z1bmN0aW9uIGUoKXtmLmFwcGx5T3B0aW9ucyhhKTtpZihmLnk9PT1udWxsJiZoKWYuZ3JhcGhpYz1oLmRlc3Ryb3koKTtpZihkYShhKSYmIUphKGEpKWYucmVkcmF3PWZ1bmN0aW9uKCl7aWYoaCYmaC5lbGVtZW50JiZhJiZhLm1hcmtlciYmYS5tYXJrZXIuc3ltYm9sKWYuZ3JhcGhpYz1oLmRlc3Ryb3koKTtcbmlmKGEmJmEuZGF0YUxhYmVscyYmZi5kYXRhTGFiZWwpZi5kYXRhTGFiZWw9Zi5kYXRhTGFiZWwuZGVzdHJveSgpO2YucmVkcmF3PW51bGx9O2k9Zi5pbmRleDtnLnVwZGF0ZVBhcmFsbGVsQXJyYXlzKGYsaSk7aWYobCYmZi5uYW1lKWxbZi54XT1mLm5hbWU7ay5kYXRhW2ldPWRhKGsuZGF0YVtpXSkmJiFKYShrLmRhdGFbaV0pP2Yub3B0aW9uczphO2cuaXNEaXJ0eT1nLmlzRGlydHlEYXRhPSEwO2lmKCFnLmZpeGVkQm94JiZnLmhhc0NhcnRlc2lhblNlcmllcylqLmlzRGlydHlCb3g9ITA7aWYoay5sZWdlbmRUeXBlPT09XCJwb2ludFwiKWouaXNEaXJ0eUxlZ2VuZD0hMDtiJiZqLnJlZHJhdyhjKX12YXIgZj10aGlzLGc9Zi5zZXJpZXMsaD1mLmdyYXBoaWMsaSxqPWcuY2hhcnQsaz1nLm9wdGlvbnMsbD1nLnhBeGlzJiZnLnhBeGlzLm5hbWVzLGI9cShiLCEwKTtkPT09ITE/ZSgpOmYuZmlyZVBvaW50RXZlbnQoXCJ1cGRhdGVcIix7b3B0aW9uczphfSxlKX0scmVtb3ZlOmZ1bmN0aW9uKGEsXG5iKXt0aGlzLnNlcmllcy5yZW1vdmVQb2ludChzYSh0aGlzLHRoaXMuc2VyaWVzLmRhdGEpLGEsYil9fSk7eChRLnByb3RvdHlwZSx7YWRkUG9pbnQ6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9dGhpcyxmPWUub3B0aW9ucyxnPWUuZGF0YSxoPWUuZ3JhcGgsaT1lLmFyZWEsaj1lLmNoYXJ0LGs9ZS54QXhpcyYmZS54QXhpcy5uYW1lcyxsPWgmJmguc2hpZnR8fDAsbT1bXCJncmFwaFwiLFwiYXJlYVwiXSxoPWYuZGF0YSxvLHA9ZS54RGF0YTthYihkLGopO2lmKGMpe2ZvcihkPWUuem9uZXMubGVuZ3RoO2QtLTspbS5wdXNoKFwiem9uZUdyYXBoXCIrZCxcInpvbmVBcmVhXCIrZCk7bihtLGZ1bmN0aW9uKGEpe2lmKGVbYV0pZVthXS5zaGlmdD1sKyhmLnN0ZXA/MjoxKX0pfWlmKGkpaS5pc0FyZWE9ITA7Yj1xKGIsITApO2k9e3NlcmllczplfTtlLnBvaW50Q2xhc3MucHJvdG90eXBlLmFwcGx5T3B0aW9ucy5hcHBseShpLFthXSk7bT1pLng7ZD1wLmxlbmd0aDtpZihlLnJlcXVpcmVTb3J0aW5nJiZtPFxucFtkLTFdKWZvcihvPSEwO2QmJnBbZC0xXT5tOylkLS07ZS51cGRhdGVQYXJhbGxlbEFycmF5cyhpLFwic3BsaWNlXCIsZCwwLDApO2UudXBkYXRlUGFyYWxsZWxBcnJheXMoaSxkKTtpZihrJiZpLm5hbWUpa1ttXT1pLm5hbWU7aC5zcGxpY2UoZCwwLGEpO28mJihlLmRhdGEuc3BsaWNlKGQsMCxudWxsKSxlLnByb2Nlc3NEYXRhKCkpO2YubGVnZW5kVHlwZT09PVwicG9pbnRcIiYmZS5nZW5lcmF0ZVBvaW50cygpO2MmJihnWzBdJiZnWzBdLnJlbW92ZT9nWzBdLnJlbW92ZSghMSk6KGcuc2hpZnQoKSxlLnVwZGF0ZVBhcmFsbGVsQXJyYXlzKGksXCJzaGlmdFwiKSxoLnNoaWZ0KCkpKTtlLmlzRGlydHk9ITA7ZS5pc0RpcnR5RGF0YT0hMDtiJiYoZS5nZXRBdHRyaWJzKCksai5yZWRyYXcoKSl9LHJlbW92ZVBvaW50OmZ1bmN0aW9uKGEsYixjKXt2YXIgZD10aGlzLGU9ZC5kYXRhLGY9ZVthXSxnPWQucG9pbnRzLGg9ZC5jaGFydCxpPWZ1bmN0aW9uKCl7ZyYmZy5sZW5ndGg9PT1lLmxlbmd0aCYmXG5nLnNwbGljZShhLDEpO2Uuc3BsaWNlKGEsMSk7ZC5vcHRpb25zLmRhdGEuc3BsaWNlKGEsMSk7ZC51cGRhdGVQYXJhbGxlbEFycmF5cyhmfHx7c2VyaWVzOmR9LFwic3BsaWNlXCIsYSwxKTtmJiZmLmRlc3Ryb3koKTtkLmlzRGlydHk9ITA7ZC5pc0RpcnR5RGF0YT0hMDtiJiZoLnJlZHJhdygpfTthYihjLGgpO2I9cShiLCEwKTtmP2YuZmlyZVBvaW50RXZlbnQoXCJyZW1vdmVcIixudWxsLGkpOmkoKX0scmVtb3ZlOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcyxkPWMuY2hhcnQ7TShjLFwicmVtb3ZlXCIsbnVsbCxmdW5jdGlvbigpe2MuZGVzdHJveSgpO2QuaXNEaXJ0eUxlZ2VuZD1kLmlzRGlydHlCb3g9ITA7ZC5saW5rU2VyaWVzKCk7cShhLCEwKSYmZC5yZWRyYXcoYil9KX0sdXBkYXRlOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcyxkPXRoaXMuY2hhcnQsZT10aGlzLnVzZXJPcHRpb25zLGY9dGhpcy50eXBlLGc9S1tmXS5wcm90b3R5cGUsaD1bXCJncm91cFwiLFwibWFya2VyR3JvdXBcIixcImRhdGFMYWJlbHNHcm91cFwiXSxcbmk7aWYoYS50eXBlJiZhLnR5cGUhPT1mfHxhLnpJbmRleCE9PXZvaWQgMCloLmxlbmd0aD0wO24oaCxmdW5jdGlvbihhKXtoW2FdPWNbYV07ZGVsZXRlIGNbYV19KTthPUMoZSx7YW5pbWF0aW9uOiExLGluZGV4OnRoaXMuaW5kZXgscG9pbnRTdGFydDp0aGlzLnhEYXRhWzBdfSx7ZGF0YTp0aGlzLm9wdGlvbnMuZGF0YX0sYSk7dGhpcy5yZW1vdmUoITEpO2ZvcihpIGluIGcpdGhpc1tpXT10O3godGhpcyxLW2EudHlwZXx8Zl0ucHJvdG90eXBlKTtuKGgsZnVuY3Rpb24oYSl7Y1thXT1oW2FdfSk7dGhpcy5pbml0KGQsYSk7ZC5saW5rU2VyaWVzKCk7cShiLCEwKSYmZC5yZWRyYXcoITEpfX0pO3goSS5wcm90b3R5cGUse3VwZGF0ZTpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuY2hhcnQsYT1jLm9wdGlvbnNbdGhpcy5jb2xsXVt0aGlzLm9wdGlvbnMuaW5kZXhdPUModGhpcy51c2VyT3B0aW9ucyxhKTt0aGlzLmRlc3Ryb3koITApO3RoaXMuX2FkZGVkUGxvdExCPXRoaXMuY2hhcnQuX2xhYmVsUGFuZXM9XG50O3RoaXMuaW5pdChjLHgoYSx7ZXZlbnRzOnR9KSk7Yy5pc0RpcnR5Qm94PSEwO3EoYiwhMCkmJmMucmVkcmF3KCl9LHJlbW92ZTpmdW5jdGlvbihhKXtmb3IodmFyIGI9dGhpcy5jaGFydCxjPXRoaXMuY29sbCxkPXRoaXMuc2VyaWVzLGU9ZC5sZW5ndGg7ZS0tOylkW2VdJiZkW2VdLnJlbW92ZSghMSk7QWEoYi5heGVzLHRoaXMpO0FhKGJbY10sdGhpcyk7Yi5vcHRpb25zW2NdLnNwbGljZSh0aGlzLm9wdGlvbnMuaW5kZXgsMSk7bihiW2NdLGZ1bmN0aW9uKGEsYil7YS5vcHRpb25zLmluZGV4PWJ9KTt0aGlzLmRlc3Ryb3koKTtiLmlzRGlydHlCb3g9ITA7cShhLCEwKSYmYi5yZWRyYXcoKX0sc2V0VGl0bGU6ZnVuY3Rpb24oYSxiKXt0aGlzLnVwZGF0ZSh7dGl0bGU6YX0sYil9LHNldENhdGVnb3JpZXM6ZnVuY3Rpb24oYSxiKXt0aGlzLnVwZGF0ZSh7Y2F0ZWdvcmllczphfSxiKX19KTt2YXIgSWE9bGEoUSk7Sy5saW5lPUlhO1cuYXJlYT1DKGNhLHtzb2Z0VGhyZXNob2xkOiExLHRocmVzaG9sZDowfSk7XG52YXIgemE9bGEoUSx7dHlwZTpcImFyZWFcIixzaW5nbGVTdGFja3M6ITEsZ2V0U3RhY2tQb2ludHM6ZnVuY3Rpb24oKXt2YXIgYT1bXSxiPVtdLGM9dGhpcy54QXhpcyxkPXRoaXMueUF4aXMsZT1kLnN0YWNrc1t0aGlzLnN0YWNrS2V5XSxmPXt9LGc9dGhpcy5wb2ludHMsaD10aGlzLmluZGV4LGk9ZC5zZXJpZXMsaj1pLmxlbmd0aCxrLGw9cShkLm9wdGlvbnMucmV2ZXJzZWRTdGFja3MsITApPzE6LTEsbSxvO2lmKHRoaXMub3B0aW9ucy5zdGFja2luZyl7Zm9yKG09MDttPGcubGVuZ3RoO20rKylmW2dbbV0ueF09Z1ttXTtmb3IobyBpbiBlKWVbb10udG90YWwhPT1udWxsJiZiLnB1c2gobyk7Yi5zb3J0KGZ1bmN0aW9uKGEsYil7cmV0dXJuIGEtYn0pO2s9dGEoaSxmdW5jdGlvbigpe3JldHVybiB0aGlzLnZpc2libGV9KTtuKGIsZnVuY3Rpb24oZyxpKXt2YXIgbz0wLHEsdTtpZihmW2ddJiYhZltnXS5pc051bGwpYS5wdXNoKGZbZ10pLG4oWy0xLDFdLGZ1bmN0aW9uKGEpe3ZhciBjPVxuYT09PTE/XCJyaWdodE51bGxcIjpcImxlZnROdWxsXCIsZD0wLG89ZVtiW2krYV1dO2lmKG8pZm9yKG09aDttPj0wJiZtPGo7KXE9by5wb2ludHNbbV0scXx8KG09PT1oP2ZbZ11bY109ITA6a1ttXSYmKHU9ZVtnXS5wb2ludHNbbV0pJiYoZC09dVsxXS11WzBdKSksbSs9bDtmW2ddW2E9PT0xP1wicmlnaHRDbGlmZlwiOlwibGVmdENsaWZmXCJdPWR9KTtlbHNle2ZvcihtPWg7bT49MCYmbTxqOyl7aWYocT1lW2ddLnBvaW50c1ttXSl7bz1xWzFdO2JyZWFrfW0rPWx9bz1kLnRvUGl4ZWxzKG8sITApO2EucHVzaCh7aXNOdWxsOiEwLHBsb3RYOmMudG9QaXhlbHMoZywhMCkscGxvdFk6byx5Qm90dG9tOm99KX19KX1yZXR1cm4gYX0sZ2V0R3JhcGhQYXRoOmZ1bmN0aW9uKGEpe3ZhciBiPVEucHJvdG90eXBlLmdldEdyYXBoUGF0aCxjPXRoaXMub3B0aW9ucyxkPWMuc3RhY2tpbmcsZT10aGlzLnlBeGlzLGYsZyxoPVtdLGk9W10saj10aGlzLmluZGV4LGssbD1lLnN0YWNrc1t0aGlzLnN0YWNrS2V5XSxcbm09Yy50aHJlc2hvbGQsbz1lLmdldFRocmVzaG9sZChjLnRocmVzaG9sZCkscCxjPWMuY29ubmVjdE51bGxzfHxkPT09XCJwZXJjZW50XCIscj1mdW5jdGlvbihiLGMsZil7dmFyIGc9YVtiXSxiPWQmJmxbZy54XS5wb2ludHNbal0scD1nW2YrXCJOdWxsXCJdfHwwLGY9Z1tmK1wiQ2xpZmZcIl18fDAscixuLGc9ITA7Znx8cD8ocj0ocD9iWzBdOmJbMV0pK2Ysbj1iWzBdK2YsZz0hIXApOiFkJiZhW2NdJiZhW2NdLmlzTnVsbCYmKHI9bj1tKTtyIT09dm9pZCAwJiYoaS5wdXNoKHtwbG90WDprLHBsb3RZOnI9PT1udWxsP286ZS5nZXRUaHJlc2hvbGQociksaXNOdWxsOmd9KSxoLnB1c2goe3Bsb3RYOmsscGxvdFk6bj09PW51bGw/bzplLmdldFRocmVzaG9sZChuKX0pKX0sYT1hfHx0aGlzLnBvaW50cztkJiYoYT10aGlzLmdldFN0YWNrUG9pbnRzKCkpO2ZvcihmPTA7ZjxhLmxlbmd0aDtmKyspaWYoZz1hW2ZdLmlzTnVsbCxrPXEoYVtmXS5yZWN0UGxvdFgsYVtmXS5wbG90WCkscD1xKGFbZl0ueUJvdHRvbSxcbm8pLCFnfHxjKXtjfHxyKGYsZi0xLFwibGVmdFwiKTtpZighZ3x8ZHx8IWMpaS5wdXNoKGFbZl0pLGgucHVzaCh7eDpmLHBsb3RYOmsscGxvdFk6cH0pO2N8fHIoZixmKzEsXCJyaWdodFwiKX1mPWIuY2FsbCh0aGlzLGksITAsITApO2gucmV2ZXJzZWQ9ITA7Zz1iLmNhbGwodGhpcyxoLCEwLCEwKTtnLmxlbmd0aCYmKGdbMF09XCJMXCIpO2Y9Zi5jb25jYXQoZyk7Yj1iLmNhbGwodGhpcyxpLCExLGMpO3RoaXMuYXJlYVBhdGg9ZjtyZXR1cm4gYn0sZHJhd0dyYXBoOmZ1bmN0aW9uKCl7dGhpcy5hcmVhUGF0aD1bXTtRLnByb3RvdHlwZS5kcmF3R3JhcGguYXBwbHkodGhpcyk7dmFyIGE9dGhpcyxiPXRoaXMuYXJlYVBhdGgsYz10aGlzLm9wdGlvbnMsZD1bW1wiYXJlYVwiLHRoaXMuY29sb3IsYy5maWxsQ29sb3JdXTtuKHRoaXMuem9uZXMsZnVuY3Rpb24oYixmKXtkLnB1c2goW1wiem9uZUFyZWFcIitmLGIuY29sb3J8fGEuY29sb3IsYi5maWxsQ29sb3J8fGMuZmlsbENvbG9yXSl9KTtuKGQsZnVuY3Rpb24oZCl7dmFyIGY9XG5kWzBdLGc9YVtmXTtnP2cuYW5pbWF0ZSh7ZDpifSk6KGc9e2ZpbGw6ZFsyXXx8ZFsxXSx6SW5kZXg6MH0sZFsyXXx8KGdbXCJmaWxsLW9wYWNpdHlcIl09cShjLmZpbGxPcGFjaXR5LDAuNzUpKSxhW2ZdPWEuY2hhcnQucmVuZGVyZXIucGF0aChiKS5hdHRyKGcpLmFkZChhLmdyb3VwKSl9KX0sZHJhd0xlZ2VuZFN5bWJvbDphYS5kcmF3UmVjdGFuZ2xlfSk7Sy5hcmVhPXphO1cuc3BsaW5lPUMoY2EpO0lhPWxhKFEse3R5cGU6XCJzcGxpbmVcIixnZXRQb2ludFNwbGluZTpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9Yi5wbG90WCxlPWIucGxvdFksZj1hW2MtMV0sYz1hW2MrMV0sZyxoLGksajtpZihmJiYhZi5pc051bGwmJmMmJiFjLmlzTnVsbCl7YT1mLnBsb3RZO2k9Yy5wbG90WDt2YXIgYz1jLnBsb3RZLGs9MDtnPSgxLjUqZCtmLnBsb3RYKS8yLjU7aD0oMS41KmUrYSkvMi41O2k9KDEuNSpkK2kpLzIuNTtqPSgxLjUqZStjKS8yLjU7aSE9PWcmJihrPShqLWgpKihpLWQpLyhpLWcpK2Utaik7XG5oKz1rO2orPWs7aD5hJiZoPmU/KGg9dihhLGUpLGo9MiplLWgpOmg8YSYmaDxlJiYoaD1FKGEsZSksaj0yKmUtaCk7aj5jJiZqPmU/KGo9dihjLGUpLGg9MiplLWopOmo8YyYmajxlJiYoaj1FKGMsZSksaD0yKmUtaik7Yi5yaWdodENvbnRYPWk7Yi5yaWdodENvbnRZPWp9Yj1bXCJDXCIscShmLnJpZ2h0Q29udFgsZi5wbG90WCkscShmLnJpZ2h0Q29udFksZi5wbG90WSkscShnLGQpLHEoaCxlKSxkLGVdO2YucmlnaHRDb250WD1mLnJpZ2h0Q29udFk9bnVsbDtyZXR1cm4gYn19KTtLLnNwbGluZT1JYTtXLmFyZWFzcGxpbmU9QyhXLmFyZWEpO3phPXphLnByb3RvdHlwZTtJYT1sYShJYSx7dHlwZTpcImFyZWFzcGxpbmVcIixnZXRTdGFja1BvaW50czp6YS5nZXRTdGFja1BvaW50cyxnZXRHcmFwaFBhdGg6emEuZ2V0R3JhcGhQYXRoLHNldFN0YWNrQ2xpZmZzOnphLnNldFN0YWNrQ2xpZmZzLGRyYXdHcmFwaDp6YS5kcmF3R3JhcGgsZHJhd0xlZ2VuZFN5bWJvbDphYS5kcmF3UmVjdGFuZ2xlfSk7XG5LLmFyZWFzcGxpbmU9SWE7Vy5jb2x1bW49QyhjYSx7Ym9yZGVyQ29sb3I6XCIjRkZGRkZGXCIsYm9yZGVyUmFkaXVzOjAsZ3JvdXBQYWRkaW5nOjAuMixtYXJrZXI6bnVsbCxwb2ludFBhZGRpbmc6MC4xLG1pblBvaW50TGVuZ3RoOjAsY3JvcFRocmVzaG9sZDo1MCxwb2ludFJhbmdlOm51bGwsc3RhdGVzOntob3Zlcjp7YnJpZ2h0bmVzczowLjEsc2hhZG93OiExLGhhbG86ITF9LHNlbGVjdDp7Y29sb3I6XCIjQzBDMEMwXCIsYm9yZGVyQ29sb3I6XCIjMDAwMDAwXCIsc2hhZG93OiExfX0sZGF0YUxhYmVsczp7YWxpZ246bnVsbCx2ZXJ0aWNhbEFsaWduOm51bGwseTpudWxsfSxzb2Z0VGhyZXNob2xkOiExLHN0YXJ0RnJvbVRocmVzaG9sZDohMCxzdGlja3lUcmFja2luZzohMSx0b29sdGlwOntkaXN0YW5jZTo2fSx0aHJlc2hvbGQ6MH0pO0lhPWxhKFEse3R5cGU6XCJjb2x1bW5cIixwb2ludEF0dHJUb09wdGlvbnM6e3N0cm9rZTpcImJvcmRlckNvbG9yXCIsZmlsbDpcImNvbG9yXCIscjpcImJvcmRlclJhZGl1c1wifSxcbmNyb3BTaG91bGRlcjowLGRpcmVjdFRvdWNoOiEwLHRyYWNrZXJHcm91cHM6W1wiZ3JvdXBcIixcImRhdGFMYWJlbHNHcm91cFwiXSxuZWdTdGFja3M6ITAsaW5pdDpmdW5jdGlvbigpe1EucHJvdG90eXBlLmluaXQuYXBwbHkodGhpcyxhcmd1bWVudHMpO3ZhciBhPXRoaXMsYj1hLmNoYXJ0O2IuaGFzUmVuZGVyZWQmJm4oYi5zZXJpZXMsZnVuY3Rpb24oYil7aWYoYi50eXBlPT09YS50eXBlKWIuaXNEaXJ0eT0hMH0pfSxnZXRDb2x1bW5NZXRyaWNzOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEub3B0aW9ucyxjPWEueEF4aXMsZD1hLnlBeGlzLGU9Yy5yZXZlcnNlZCxmLGc9e30saD0wO2IuZ3JvdXBpbmc9PT0hMT9oPTE6bihhLmNoYXJ0LnNlcmllcyxmdW5jdGlvbihiKXt2YXIgYz1iLm9wdGlvbnMsZT1iLnlBeGlzLGk7aWYoYi50eXBlPT09YS50eXBlJiZiLnZpc2libGUmJmQubGVuPT09ZS5sZW4mJmQucG9zPT09ZS5wb3MpYy5zdGFja2luZz8oZj1iLnN0YWNrS2V5LGdbZl09PT10JiZcbihnW2ZdPWgrKyksaT1nW2ZdKTpjLmdyb3VwaW5nIT09ITEmJihpPWgrKyksYi5jb2x1bW5JbmRleD1pfSk7dmFyIGk9RShTKGMudHJhbnNBKSooYy5vcmRpbmFsU2xvcGV8fGIucG9pbnRSYW5nZXx8Yy5jbG9zZXN0UG9pbnRSYW5nZXx8Yy50aWNrSW50ZXJ2YWx8fDEpLGMubGVuKSxqPWkqYi5ncm91cFBhZGRpbmcsaz0oaS0yKmopL2gsYj1FKGIubWF4UG9pbnRXaWR0aHx8Yy5sZW4scShiLnBvaW50V2lkdGgsayooMS0yKmIucG9pbnRQYWRkaW5nKSkpO2EuY29sdW1uTWV0cmljcz17d2lkdGg6YixvZmZzZXQ6KGstYikvMisoaisoKGEuY29sdW1uSW5kZXh8fDApKyhlPzE6MCkpKmstaS8yKSooZT8tMToxKX07cmV0dXJuIGEuY29sdW1uTWV0cmljc30sY3Jpc3BDb2w6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9dGhpcy5jaGFydCxmPXRoaXMuYm9yZGVyV2lkdGgsZz0tKGYlMj8wLjU6MCksZj1mJTI/MC41OjE7ZS5pbnZlcnRlZCYmZS5yZW5kZXJlci5pc1ZNTCYmKGYrPTEpO2M9TWF0aC5yb3VuZChhK1xuYykrZzthPU1hdGgucm91bmQoYSkrZztjLT1hO2Q9TWF0aC5yb3VuZChiK2QpK2Y7Zz1TKGIpPD0wLjUmJmQ+MC41O2I9TWF0aC5yb3VuZChiKStmO2QtPWI7ZyYmZCYmKGItPTEsZCs9MSk7cmV0dXJue3g6YSx5OmIsd2lkdGg6YyxoZWlnaHQ6ZH19LHRyYW5zbGF0ZTpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLmNoYXJ0LGM9YS5vcHRpb25zLGQ9YS5ib3JkZXJXaWR0aD1xKGMuYm9yZGVyV2lkdGgsYS5jbG9zZXN0UG9pbnRSYW5nZSphLnhBeGlzLnRyYW5zQTwyPzA6MSksZT1hLnlBeGlzLGY9YS50cmFuc2xhdGVkVGhyZXNob2xkPWUuZ2V0VGhyZXNob2xkKGMudGhyZXNob2xkKSxnPXEoYy5taW5Qb2ludExlbmd0aCw1KSxoPWEuZ2V0Q29sdW1uTWV0cmljcygpLGk9aC53aWR0aCxqPWEuYmFyVz12KGksMSsyKmQpLGs9YS5wb2ludFhPZmZzZXQ9aC5vZmZzZXQ7Yi5pbnZlcnRlZCYmKGYtPTAuNSk7Yy5wb2ludFBhZGRpbmcmJihqPUZhKGopKTtRLnByb3RvdHlwZS50cmFuc2xhdGUuYXBwbHkoYSk7XG5uKGEucG9pbnRzLGZ1bmN0aW9uKGMpe3ZhciBkPUUocShjLnlCb3R0b20sZiksOUU0KSxoPTk5OStTKGQpLGg9RSh2KC1oLGMucGxvdFkpLGUubGVuK2gpLHA9Yy5wbG90WCtrLHI9aixuPUUoaCxkKSxzLHU9dihoLGQpLW47Uyh1KTxnJiZnJiYodT1nLHM9IWUucmV2ZXJzZWQmJiFjLm5lZ2F0aXZlfHxlLnJldmVyc2VkJiZjLm5lZ2F0aXZlLG49UyhuLWYpPmc/ZC1nOmYtKHM/ZzowKSk7Yy5iYXJYPXA7Yy5wb2ludFdpZHRoPWk7Yy50b29sdGlwUG9zPWIuaW52ZXJ0ZWQ/W2UubGVuK2UucG9zLWIucGxvdExlZnQtaCxhLnhBeGlzLmxlbi1wLXIvMix1XTpbcCtyLzIsaCtlLnBvcy1iLnBsb3RUb3AsdV07Yy5zaGFwZVR5cGU9XCJyZWN0XCI7Yy5zaGFwZUFyZ3M9YS5jcmlzcENvbChwLG4scix1KX0pfSxnZXRTeW1ib2w6cmEsZHJhd0xlZ2VuZFN5bWJvbDphYS5kcmF3UmVjdGFuZ2xlLGRyYXdHcmFwaDpyYSxkcmF3UG9pbnRzOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPXRoaXMuY2hhcnQsXG5jPWEub3B0aW9ucyxkPWIucmVuZGVyZXIsZT1jLmFuaW1hdGlvbkxpbWl0fHwyNTAsZixnO24oYS5wb2ludHMsZnVuY3Rpb24oaCl7dmFyIGk9aC5wbG90WSxqPWguZ3JhcGhpYztpZihpIT09dCYmIWlzTmFOKGkpJiZoLnkhPT1udWxsKWY9aC5zaGFwZUFyZ3MsaT1zKGEuYm9yZGVyV2lkdGgpP3tcInN0cm9rZS13aWR0aFwiOmEuYm9yZGVyV2lkdGh9Ont9LGc9aC5wb2ludEF0dHJbaC5zZWxlY3RlZD9cInNlbGVjdFwiOlwiXCJdfHxhLnBvaW50QXR0cltcIlwiXSxqPyhUYShqKSxqLmF0dHIoaSkuYXR0cihnKVtiLnBvaW50Q291bnQ8ZT9cImFuaW1hdGVcIjpcImF0dHJcIl0oQyhmKSkpOmguZ3JhcGhpYz1kW2guc2hhcGVUeXBlXShmKS5hdHRyKGkpLmF0dHIoZykuYWRkKGguZ3JvdXB8fGEuZ3JvdXApLnNoYWRvdyhjLnNoYWRvdyxudWxsLGMuc3RhY2tpbmcmJiFjLmJvcmRlclJhZGl1cyk7ZWxzZSBpZihqKWguZ3JhcGhpYz1qLmRlc3Ryb3koKX0pfSxhbmltYXRlOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMsXG5jPXRoaXMueUF4aXMsZD1iLm9wdGlvbnMsZT10aGlzLmNoYXJ0LmludmVydGVkLGY9e307aWYoamEpYT8oZi5zY2FsZVk9MC4wMDEsYT1FKGMucG9zK2MubGVuLHYoYy5wb3MsYy50b1BpeGVscyhkLnRocmVzaG9sZCkpKSxlP2YudHJhbnNsYXRlWD1hLWMubGVuOmYudHJhbnNsYXRlWT1hLGIuZ3JvdXAuYXR0cihmKSk6KGZbZT9cInRyYW5zbGF0ZVhcIjpcInRyYW5zbGF0ZVlcIl09Yy5wb3MsYi5ncm91cC5hbmltYXRlKGYseChoYihiLm9wdGlvbnMuYW5pbWF0aW9uKSx7c3RlcDpmdW5jdGlvbihhLGMpe2IuZ3JvdXAuYXR0cih7c2NhbGVZOmMucG9zfSl9fSkpLGIuYW5pbWF0ZT1udWxsKX0scmVtb3ZlOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEuY2hhcnQ7Yi5oYXNSZW5kZXJlZCYmbihiLnNlcmllcyxmdW5jdGlvbihiKXtpZihiLnR5cGU9PT1hLnR5cGUpYi5pc0RpcnR5PSEwfSk7US5wcm90b3R5cGUucmVtb3ZlLmFwcGx5KGEsYXJndW1lbnRzKX19KTtLLmNvbHVtbj1JYTtXLmJhcj1cbkMoVy5jb2x1bW4pO3phPWxhKElhLHt0eXBlOlwiYmFyXCIsaW52ZXJ0ZWQ6ITB9KTtLLmJhcj16YTtXLnNjYXR0ZXI9QyhjYSx7bGluZVdpZHRoOjAsbWFya2VyOntlbmFibGVkOiEwfSx0b29sdGlwOntoZWFkZXJGb3JtYXQ6JzxzcGFuIHN0eWxlPVwiY29sb3I6e3BvaW50LmNvbG9yfVwiPlxcdTI1Y2Y8L3NwYW4+IDxzcGFuIHN0eWxlPVwiZm9udC1zaXplOiAxMHB4O1wiPiB7c2VyaWVzLm5hbWV9PC9zcGFuPjxici8+Jyxwb2ludEZvcm1hdDpcIng6IDxiPntwb2ludC54fTwvYj48YnIvPnk6IDxiPntwb2ludC55fTwvYj48YnIvPlwifX0pO3phPWxhKFEse3R5cGU6XCJzY2F0dGVyXCIsc29ydGVkOiExLHJlcXVpcmVTb3J0aW5nOiExLG5vU2hhcmVkVG9vbHRpcDohMCx0cmFja2VyR3JvdXBzOltcImdyb3VwXCIsXCJtYXJrZXJHcm91cFwiLFwiZGF0YUxhYmVsc0dyb3VwXCJdLHRha2VPcmRpbmFsUG9zaXRpb246ITEsa2REaW1lbnNpb25zOjIsZHJhd0dyYXBoOmZ1bmN0aW9uKCl7dGhpcy5vcHRpb25zLmxpbmVXaWR0aCYmXG5RLnByb3RvdHlwZS5kcmF3R3JhcGguY2FsbCh0aGlzKX19KTtLLnNjYXR0ZXI9emE7Vy5waWU9QyhjYSx7Ym9yZGVyQ29sb3I6XCIjRkZGRkZGXCIsYm9yZGVyV2lkdGg6MSxjZW50ZXI6W251bGwsbnVsbF0sY2xpcDohMSxjb2xvckJ5UG9pbnQ6ITAsZGF0YUxhYmVsczp7ZGlzdGFuY2U6MzAsZW5hYmxlZDohMCxmb3JtYXR0ZXI6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy55PT09bnVsbD92b2lkIDA6dGhpcy5wb2ludC5uYW1lfSx4OjB9LGlnbm9yZUhpZGRlblBvaW50OiEwLGxlZ2VuZFR5cGU6XCJwb2ludFwiLG1hcmtlcjpudWxsLHNpemU6bnVsbCxzaG93SW5MZWdlbmQ6ITEsc2xpY2VkT2Zmc2V0OjEwLHN0YXRlczp7aG92ZXI6e2JyaWdodG5lc3M6MC4xLHNoYWRvdzohMX19LHN0aWNreVRyYWNraW5nOiExLHRvb2x0aXA6e2ZvbGxvd1BvaW50ZXI6ITB9fSk7Y2E9e3R5cGU6XCJwaWVcIixpc0NhcnRlc2lhbjohMSxwb2ludENsYXNzOmxhKEhhLHtpbml0OmZ1bmN0aW9uKCl7SGEucHJvdG90eXBlLmluaXQuYXBwbHkodGhpcyxcbmFyZ3VtZW50cyk7dmFyIGE9dGhpcyxiO2EubmFtZT1xKGEubmFtZSxcIlNsaWNlXCIpO2I9ZnVuY3Rpb24oYil7YS5zbGljZShiLnR5cGU9PT1cInNlbGVjdFwiKX07RChhLFwic2VsZWN0XCIsYik7RChhLFwidW5zZWxlY3RcIixiKTtyZXR1cm4gYX0sc2V0VmlzaWJsZTpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMsZD1jLnNlcmllcyxlPWQuY2hhcnQsZj1kLm9wdGlvbnMuaWdub3JlSGlkZGVuUG9pbnQsYj1xKGIsZik7aWYoYSE9PWMudmlzaWJsZSl7Yy52aXNpYmxlPWMub3B0aW9ucy52aXNpYmxlPWE9YT09PXQ/IWMudmlzaWJsZTphO2Qub3B0aW9ucy5kYXRhW3NhKGMsZC5kYXRhKV09Yy5vcHRpb25zO24oW1wiZ3JhcGhpY1wiLFwiZGF0YUxhYmVsXCIsXCJjb25uZWN0b3JcIixcInNoYWRvd0dyb3VwXCJdLGZ1bmN0aW9uKGIpe2lmKGNbYl0pY1tiXVthP1wic2hvd1wiOlwiaGlkZVwiXSghMCl9KTtjLmxlZ2VuZEl0ZW0mJmUubGVnZW5kLmNvbG9yaXplSXRlbShjLGEpOyFhJiZjLnN0YXRlPT09XCJob3ZlclwiJiZcbmMuc2V0U3RhdGUoXCJcIik7aWYoZilkLmlzRGlydHk9ITA7YiYmZS5yZWRyYXcoKX19LHNsaWNlOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD10aGlzLnNlcmllczthYihjLGQuY2hhcnQpO3EoYiwhMCk7dGhpcy5zbGljZWQ9dGhpcy5vcHRpb25zLnNsaWNlZD1hPXMoYSk/YTohdGhpcy5zbGljZWQ7ZC5vcHRpb25zLmRhdGFbc2EodGhpcyxkLmRhdGEpXT10aGlzLm9wdGlvbnM7YT1hP3RoaXMuc2xpY2VkVHJhbnNsYXRpb246e3RyYW5zbGF0ZVg6MCx0cmFuc2xhdGVZOjB9O3RoaXMuZ3JhcGhpYy5hbmltYXRlKGEpO3RoaXMuc2hhZG93R3JvdXAmJnRoaXMuc2hhZG93R3JvdXAuYW5pbWF0ZShhKX0saGFsb1BhdGg6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5zaGFwZUFyZ3MsYz10aGlzLnNlcmllcy5jaGFydDtyZXR1cm4gdGhpcy5zbGljZWR8fCF0aGlzLnZpc2libGU/W106dGhpcy5zZXJpZXMuY2hhcnQucmVuZGVyZXIuc3ltYm9scy5hcmMoYy5wbG90TGVmdCtiLngsYy5wbG90VG9wK2IueSxcbmIucithLGIucithLHtpbm5lclI6dGhpcy5zaGFwZUFyZ3MucixzdGFydDpiLnN0YXJ0LGVuZDpiLmVuZH0pfX0pLHJlcXVpcmVTb3J0aW5nOiExLGRpcmVjdFRvdWNoOiEwLG5vU2hhcmVkVG9vbHRpcDohMCx0cmFja2VyR3JvdXBzOltcImdyb3VwXCIsXCJkYXRhTGFiZWxzR3JvdXBcIl0sYXhpc1R5cGVzOltdLHBvaW50QXR0clRvT3B0aW9uczp7c3Ryb2tlOlwiYm9yZGVyQ29sb3JcIixcInN0cm9rZS13aWR0aFwiOlwiYm9yZGVyV2lkdGhcIixmaWxsOlwiY29sb3JcIn0sYW5pbWF0ZTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLGM9Yi5wb2ludHMsZD1iLnN0YXJ0QW5nbGVSYWQ7aWYoIWEpbihjLGZ1bmN0aW9uKGEpe3ZhciBjPWEuZ3JhcGhpYyxnPWEuc2hhcGVBcmdzO2MmJihjLmF0dHIoe3I6YS5zdGFydFJ8fGIuY2VudGVyWzNdLzIsc3RhcnQ6ZCxlbmQ6ZH0pLGMuYW5pbWF0ZSh7cjpnLnIsc3RhcnQ6Zy5zdGFydCxlbmQ6Zy5lbmR9LGIub3B0aW9ucy5hbmltYXRpb24pKX0pLGIuYW5pbWF0ZT1udWxsfSxcbnVwZGF0ZVRvdGFsczpmdW5jdGlvbigpe3ZhciBhLGI9MCxjPXRoaXMucG9pbnRzLGQ9Yy5sZW5ndGgsZSxmPXRoaXMub3B0aW9ucy5pZ25vcmVIaWRkZW5Qb2ludDtmb3IoYT0wO2E8ZDthKyspZT1jW2FdLGIrPWYmJiFlLnZpc2libGU/MDplLnk7dGhpcy50b3RhbD1iO2ZvcihhPTA7YTxkO2ErKyllPWNbYV0sZS5wZXJjZW50YWdlPWI+MCYmKGUudmlzaWJsZXx8IWYpP2UueS9iKjEwMDowLGUudG90YWw9Yn0sZ2VuZXJhdGVQb2ludHM6ZnVuY3Rpb24oKXtRLnByb3RvdHlwZS5nZW5lcmF0ZVBvaW50cy5jYWxsKHRoaXMpO3RoaXMudXBkYXRlVG90YWxzKCl9LHRyYW5zbGF0ZTpmdW5jdGlvbihhKXt0aGlzLmdlbmVyYXRlUG9pbnRzKCk7dmFyIGI9MCxjPXRoaXMub3B0aW9ucyxkPWMuc2xpY2VkT2Zmc2V0LGU9ZCtjLmJvcmRlcldpZHRoLGYsZyxoLGk9Yy5zdGFydEFuZ2xlfHwwLGo9dGhpcy5zdGFydEFuZ2xlUmFkPUJhLzE4MCooaS05MCksaT0odGhpcy5lbmRBbmdsZVJhZD1CYS9cbjE4MCoocShjLmVuZEFuZ2xlLGkrMzYwKS05MCkpLWosaz10aGlzLnBvaW50cyxsPWMuZGF0YUxhYmVscy5kaXN0YW5jZSxjPWMuaWdub3JlSGlkZGVuUG9pbnQsbSxvPWsubGVuZ3RoLHA7aWYoIWEpdGhpcy5jZW50ZXI9YT10aGlzLmdldENlbnRlcigpO3RoaXMuZ2V0WD1mdW5jdGlvbihiLGMpe2g9WS5hc2luKEUoKGItYVsxXSkvKGFbMl0vMitsKSwxKSk7cmV0dXJuIGFbMF0rKGM/LTE6MSkqYmEoaCkqKGFbMl0vMitsKX07Zm9yKG09MDttPG87bSsrKXtwPWtbbV07Zj1qK2IqaTtpZighY3x8cC52aXNpYmxlKWIrPXAucGVyY2VudGFnZS8xMDA7Zz1qK2IqaTtwLnNoYXBlVHlwZT1cImFyY1wiO3Auc2hhcGVBcmdzPXt4OmFbMF0seTphWzFdLHI6YVsyXS8yLGlubmVyUjphWzNdLzIsc3RhcnQ6eShmKjFFMykvMUUzLGVuZDp5KGcqMUUzKS8xRTN9O2g9KGcrZikvMjtoPjEuNSpCYT9oLT0yKkJhOmg8LUJhLzImJihoKz0yKkJhKTtwLnNsaWNlZFRyYW5zbGF0aW9uPXt0cmFuc2xhdGVYOnkoYmEoaCkqXG5kKSx0cmFuc2xhdGVZOnkoa2EoaCkqZCl9O2Y9YmEoaCkqYVsyXS8yO2c9a2EoaCkqYVsyXS8yO3AudG9vbHRpcFBvcz1bYVswXStmKjAuNyxhWzFdK2cqMC43XTtwLmhhbGY9aDwtQmEvMnx8aD5CYS8yPzE6MDtwLmFuZ2xlPWg7ZT1FKGUsbC8yKTtwLmxhYmVsUG9zPVthWzBdK2YrYmEoaCkqbCxhWzFdK2cra2EoaCkqbCxhWzBdK2YrYmEoaCkqZSxhWzFdK2cra2EoaCkqZSxhWzBdK2YsYVsxXStnLGw8MD9cImNlbnRlclwiOnAuaGFsZj9cInJpZ2h0XCI6XCJsZWZ0XCIsaF19fSxkcmF3R3JhcGg6bnVsbCxkcmF3UG9pbnRzOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEuY2hhcnQucmVuZGVyZXIsYyxkLGU9YS5vcHRpb25zLnNoYWRvdyxmLGcsaCxpO2lmKGUmJiFhLnNoYWRvd0dyb3VwKWEuc2hhZG93R3JvdXA9Yi5nKFwic2hhZG93XCIpLmFkZChhLmdyb3VwKTtuKGEucG9pbnRzLGZ1bmN0aW9uKGope2lmKGoueSE9PW51bGwpe2Q9ai5ncmFwaGljO2g9ai5zaGFwZUFyZ3M7Zj1qLnNoYWRvd0dyb3VwO1xuZz1qLnBvaW50QXR0cltqLnNlbGVjdGVkP1wic2VsZWN0XCI6XCJcIl07aWYoIWcuc3Ryb2tlKWcuc3Ryb2tlPWcuZmlsbDtpZihlJiYhZilmPWouc2hhZG93R3JvdXA9Yi5nKFwic2hhZG93XCIpLmFkZChhLnNoYWRvd0dyb3VwKTtjPWouc2xpY2VkP2ouc2xpY2VkVHJhbnNsYXRpb246e3RyYW5zbGF0ZVg6MCx0cmFuc2xhdGVZOjB9O2YmJmYuYXR0cihjKTtpZihkKWQuc2V0UmFkaWFsUmVmZXJlbmNlKGEuY2VudGVyKS5hdHRyKGcpLmFuaW1hdGUoeChoLGMpKTtlbHNle2k9e1wic3Ryb2tlLWxpbmVqb2luXCI6XCJyb3VuZFwifTtpZighai52aXNpYmxlKWkudmlzaWJpbGl0eT1cImhpZGRlblwiO2ouZ3JhcGhpYz1kPWJbai5zaGFwZVR5cGVdKGgpLnNldFJhZGlhbFJlZmVyZW5jZShhLmNlbnRlcikuYXR0cihnKS5hdHRyKGkpLmF0dHIoYykuYWRkKGEuZ3JvdXApLnNoYWRvdyhlLGYpfX19KX0sc2VhcmNoUG9pbnQ6cmEsc29ydEJ5QW5nbGU6ZnVuY3Rpb24oYSxiKXthLnNvcnQoZnVuY3Rpb24oYSxkKXtyZXR1cm4gYS5hbmdsZSE9PVxudm9pZCAwJiYoZC5hbmdsZS1hLmFuZ2xlKSpifSl9LGRyYXdMZWdlbmRTeW1ib2w6YWEuZHJhd1JlY3RhbmdsZSxnZXRDZW50ZXI6YmMuZ2V0Q2VudGVyLGdldFN5bWJvbDpyYX07Y2E9bGEoUSxjYSk7Sy5waWU9Y2E7US5wcm90b3R5cGUuZHJhd0RhdGFMYWJlbHM9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5vcHRpb25zLGM9Yi5jdXJzb3IsZD1iLmRhdGFMYWJlbHMsZT1hLnBvaW50cyxmLGcsaD1hLmhhc1JlbmRlcmVkfHwwLGksaixrPXEoZC5kZWZlciwhMCksbD1hLmNoYXJ0LnJlbmRlcmVyO2lmKGQuZW5hYmxlZHx8YS5faGFzUG9pbnRMYWJlbHMpYS5kbFByb2Nlc3NPcHRpb25zJiZhLmRsUHJvY2Vzc09wdGlvbnMoZCksaj1hLnBsb3RHcm91cChcImRhdGFMYWJlbHNHcm91cFwiLFwiZGF0YS1sYWJlbHNcIixrJiYhaD9cImhpZGRlblwiOlwidmlzaWJsZVwiLGQuekluZGV4fHw2KSxrJiYoai5hdHRyKHtvcGFjaXR5OitofSksaHx8RChhLFwiYWZ0ZXJBbmltYXRlXCIsZnVuY3Rpb24oKXthLnZpc2libGUmJlxuai5zaG93KCk7altiLmFuaW1hdGlvbj9cImFuaW1hdGVcIjpcImF0dHJcIl0oe29wYWNpdHk6MX0se2R1cmF0aW9uOjIwMH0pfSkpLGc9ZCxuKGUsZnVuY3Rpb24oZSl7dmFyIGgsaz1lLmRhdGFMYWJlbCxyLG4sUD1lLmNvbm5lY3Rvcix1PSEwLHcsdj17fTtmPWUuZGxPcHRpb25zfHxlLm9wdGlvbnMmJmUub3B0aW9ucy5kYXRhTGFiZWxzO2g9cShmJiZmLmVuYWJsZWQsZy5lbmFibGVkKSYmZS55IT09bnVsbDtpZihrJiYhaCllLmRhdGFMYWJlbD1rLmRlc3Ryb3koKTtlbHNlIGlmKGgpe2Q9QyhnLGYpO3c9ZC5zdHlsZTtoPWQucm90YXRpb247cj1lLmdldExhYmVsQ29uZmlnKCk7aT1kLmZvcm1hdD9MYShkLmZvcm1hdCxyKTpkLmZvcm1hdHRlci5jYWxsKHIsZCk7dy5jb2xvcj1xKGQuY29sb3Isdy5jb2xvcixhLmNvbG9yLFwiYmxhY2tcIik7aWYoaylpZihzKGkpKWsuYXR0cih7dGV4dDppfSksdT0hMTtlbHNle2lmKGUuZGF0YUxhYmVsPWs9ay5kZXN0cm95KCksUCllLmNvbm5lY3Rvcj1QLmRlc3Ryb3koKX1lbHNlIGlmKHMoaSkpe2s9XG57ZmlsbDpkLmJhY2tncm91bmRDb2xvcixzdHJva2U6ZC5ib3JkZXJDb2xvcixcInN0cm9rZS13aWR0aFwiOmQuYm9yZGVyV2lkdGgscjpkLmJvcmRlclJhZGl1c3x8MCxyb3RhdGlvbjpoLHBhZGRpbmc6ZC5wYWRkaW5nLHpJbmRleDoxfTtpZih3LmNvbG9yPT09XCJjb250cmFzdFwiKXYuY29sb3I9ZC5pbnNpZGV8fGQuZGlzdGFuY2U8MHx8Yi5zdGFja2luZz9sLmdldENvbnRyYXN0KGUuY29sb3J8fGEuY29sb3IpOlwiIzAwMDAwMFwiO2lmKGMpdi5jdXJzb3I9Yztmb3IobiBpbiBrKWtbbl09PT10JiZkZWxldGUga1tuXTtrPWUuZGF0YUxhYmVsPWxbaD9cInRleHRcIjpcImxhYmVsXCJdKGksMCwtOTk5OSxkLnNoYXBlLG51bGwsbnVsbCxkLnVzZUhUTUwpLmF0dHIoaykuY3NzKHgodyx2KSkuYWRkKGopLnNoYWRvdyhkLnNoYWRvdyl9ayYmYS5hbGlnbkRhdGFMYWJlbChlLGssZCxudWxsLHUpfX0pfTtRLnByb3RvdHlwZS5hbGlnbkRhdGFMYWJlbD1mdW5jdGlvbihhLGIsYyxkLGUpe3ZhciBmPXRoaXMuY2hhcnQsXG5nPWYuaW52ZXJ0ZWQsaD1xKGEucGxvdFgsLTk5OTkpLGk9cShhLnBsb3RZLC05OTk5KSxqPWIuZ2V0QkJveCgpLGs9Zi5yZW5kZXJlci5mb250TWV0cmljcyhjLnN0eWxlLmZvbnRTaXplKS5iLGw9Yy5yb3RhdGlvbixtPWMuYWxpZ24sbz10aGlzLnZpc2libGUmJihhLnNlcmllcy5mb3JjZURMfHxmLmlzSW5zaWRlUGxvdChoLHkoaSksZyl8fGQmJmYuaXNJbnNpZGVQbG90KGgsZz9kLngrMTpkLnkrZC5oZWlnaHQtMSxnKSkscD1xKGMub3ZlcmZsb3csXCJqdXN0aWZ5XCIpPT09XCJqdXN0aWZ5XCI7aWYobylkPXgoe3g6Zz9mLnBsb3RXaWR0aC1pOmgseTp5KGc/Zi5wbG90SGVpZ2h0LWg6aSksd2lkdGg6MCxoZWlnaHQ6MH0sZCkseChjLHt3aWR0aDpqLndpZHRoLGhlaWdodDpqLmhlaWdodH0pLGw/KHA9ITEsZz1mLnJlbmRlcmVyLnJvdENvcnIoayxsKSxnPXt4OmQueCtjLngrZC53aWR0aC8yK2cueCx5OmQueStjLnkrZC5oZWlnaHQvMn0sYltlP1wiYXR0clwiOlwiYW5pbWF0ZVwiXShnKS5hdHRyKHthbGlnbjpjLmFsaWdufSksXG5oPShsKzcyMCklMzYwLGg9aD4xODAmJmg8MzYwLG09PT1cImxlZnRcIj9nLnktPWg/ai5oZWlnaHQ6MDptPT09XCJjZW50ZXJcIj8oZy54LT1qLndpZHRoLzIsZy55LT1qLmhlaWdodC8yKTptPT09XCJyaWdodFwiJiYoZy54LT1qLndpZHRoLGcueS09aD8wOmouaGVpZ2h0KSk6KGIuYWxpZ24oYyxudWxsLGQpLGc9Yi5hbGlnbkF0dHIpLHA/dGhpcy5qdXN0aWZ5RGF0YUxhYmVsKGIsYyxnLGosZCxlKTpxKGMuY3JvcCwhMCkmJihvPWYuaXNJbnNpZGVQbG90KGcueCxnLnkpJiZmLmlzSW5zaWRlUGxvdChnLngrai53aWR0aCxnLnkrai5oZWlnaHQpKSxjLnNoYXBlJiYhbCYmYi5hdHRyKHthbmNob3JYOmEucGxvdFgsYW5jaG9yWTphLnBsb3RZfSk7aWYoIW8pVGEoYiksYi5hdHRyKHt5Oi05OTk5fSksYi5wbGFjZWQ9ITF9O1EucHJvdG90eXBlLmp1c3RpZnlEYXRhTGFiZWw9ZnVuY3Rpb24oYSxiLGMsZCxlLGYpe3ZhciBnPXRoaXMuY2hhcnQsaD1iLmFsaWduLGk9Yi52ZXJ0aWNhbEFsaWduLGosXG5rLGw9YS5ib3g/MDphLnBhZGRpbmd8fDA7aj1jLngrbDtpZihqPDApaD09PVwicmlnaHRcIj9iLmFsaWduPVwibGVmdFwiOmIueD0taixrPSEwO2o9Yy54K2Qud2lkdGgtbDtpZihqPmcucGxvdFdpZHRoKWg9PT1cImxlZnRcIj9iLmFsaWduPVwicmlnaHRcIjpiLng9Zy5wbG90V2lkdGgtaixrPSEwO2o9Yy55K2w7aWYoajwwKWk9PT1cImJvdHRvbVwiP2IudmVydGljYWxBbGlnbj1cInRvcFwiOmIueT0taixrPSEwO2o9Yy55K2QuaGVpZ2h0LWw7aWYoaj5nLnBsb3RIZWlnaHQpaT09PVwidG9wXCI/Yi52ZXJ0aWNhbEFsaWduPVwiYm90dG9tXCI6Yi55PWcucGxvdEhlaWdodC1qLGs9ITA7aWYoaylhLnBsYWNlZD0hZixhLmFsaWduKGIsbnVsbCxlKX07aWYoSy5waWUpSy5waWUucHJvdG90eXBlLmRyYXdEYXRhTGFiZWxzPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEuZGF0YSxjLGQ9YS5jaGFydCxlPWEub3B0aW9ucy5kYXRhTGFiZWxzLGY9cShlLmNvbm5lY3RvclBhZGRpbmcsMTApLGc9cShlLmNvbm5lY3RvcldpZHRoLFxuMSksaD1kLnBsb3RXaWR0aCxpPWQucGxvdEhlaWdodCxqLGssbD1xKGUuc29mdENvbm5lY3RvciwhMCksbT1lLmRpc3RhbmNlLG89YS5jZW50ZXIscD1vWzJdLzIscj1vWzFdLEE9bT4wLHMsdSx3LHQ9W1tdLFtdXSx4LHosQyxCLEwsRD1bMCwwLDAsMF0sSj1mdW5jdGlvbihhLGIpe3JldHVybiBiLnktYS55fTtpZihhLnZpc2libGUmJihlLmVuYWJsZWR8fGEuX2hhc1BvaW50TGFiZWxzKSl7US5wcm90b3R5cGUuZHJhd0RhdGFMYWJlbHMuYXBwbHkoYSk7bihiLGZ1bmN0aW9uKGEpe2lmKGEuZGF0YUxhYmVsJiZhLnZpc2libGUpdFthLmhhbGZdLnB1c2goYSksYS5kYXRhTGFiZWwuX3Bvcz1udWxsfSk7Zm9yKEI9MjtCLS07KXt2YXIgRz1bXSxLPVtdLEk9dFtCXSxGPUkubGVuZ3RoLEg7aWYoRil7YS5zb3J0QnlBbmdsZShJLEItMC41KTtmb3IoTD1iPTA7IWImJklbTF07KWI9SVtMXSYmSVtMXS5kYXRhTGFiZWwmJihJW0xdLmRhdGFMYWJlbC5nZXRCQm94KCkuaGVpZ2h0fHwyMSksXG5MKys7aWYobT4wKXt1PUUocitwK20sZC5wbG90SGVpZ2h0KTtmb3IoTD12KDAsci1wLW0pO0w8PXU7TCs9YilHLnB1c2goTCk7dT1HLmxlbmd0aDtpZihGPnUpe2M9W10uY29uY2F0KEkpO2Muc29ydChKKTtmb3IoTD1GO0wtLTspY1tMXS5yYW5rPUw7Zm9yKEw9RjtMLS07KUlbTF0ucmFuaz49dSYmSS5zcGxpY2UoTCwxKTtGPUkubGVuZ3RofWZvcihMPTA7TDxGO0wrKyl7Yz1JW0xdO3c9Yy5sYWJlbFBvcztjPTk5OTk7dmFyIE0sTjtmb3IoTj0wO048dTtOKyspTT1TKEdbTl0td1sxXSksTTxjJiYoYz1NLEg9Tik7aWYoSDxMJiZHW0xdIT09bnVsbClIPUw7ZWxzZSBmb3IodTxGLUwrSCYmR1tMXSE9PW51bGwmJihIPXUtRitMKTtHW0hdPT09bnVsbDspSCsrO0sucHVzaCh7aTpILHk6R1tIXX0pO0dbSF09bnVsbH1LLnNvcnQoSil9Zm9yKEw9MDtMPEY7TCsrKXtjPUlbTF07dz1jLmxhYmVsUG9zO3M9Yy5kYXRhTGFiZWw7Qz1jLnZpc2libGU9PT0hMT9cImhpZGRlblwiOlwiaW5oZXJpdFwiO1xuYz13WzFdO2lmKG0+MCl7aWYodT1LLnBvcCgpLEg9dS5pLHo9dS55LGM+eiYmR1tIKzFdIT09bnVsbHx8Yzx6JiZHW0gtMV0hPT1udWxsKXo9RSh2KDAsYyksZC5wbG90SGVpZ2h0KX1lbHNlIHo9Yzt4PWUuanVzdGlmeT9vWzBdKyhCPy0xOjEpKihwK20pOmEuZ2V0WCh6PT09ci1wLW18fHo9PT1yK3ArbT9jOnosQik7cy5fYXR0cj17dmlzaWJpbGl0eTpDLGFsaWduOndbNl19O3MuX3Bvcz17eDp4K2UueCsoe2xlZnQ6ZixyaWdodDotZn1bd1s2XV18fDApLHk6eitlLnktMTB9O3MuY29ublg9eDtzLmNvbm5ZPXo7aWYodGhpcy5vcHRpb25zLnNpemU9PT1udWxsKXU9cy53aWR0aCx4LXU8Zj9EWzNdPXYoeSh1LXgrZiksRFszXSk6eCt1PmgtZiYmKERbMV09dih5KHgrdS1oK2YpLERbMV0pKSx6LWIvMjwwP0RbMF09dih5KC16K2IvMiksRFswXSk6eitiLzI+aSYmKERbMl09dih5KHorYi8yLWkpLERbMl0pKX19fWlmKEVhKEQpPT09MHx8dGhpcy52ZXJpZnlEYXRhTGFiZWxPdmVyZmxvdyhEKSl0aGlzLnBsYWNlRGF0YUxhYmVscygpLFxuQSYmZyYmbih0aGlzLnBvaW50cyxmdW5jdGlvbihiKXtqPWIuY29ubmVjdG9yO3c9Yi5sYWJlbFBvcztpZigocz1iLmRhdGFMYWJlbCkmJnMuX3BvcyYmYi52aXNpYmxlKUM9cy5fYXR0ci52aXNpYmlsaXR5LHg9cy5jb25uWCx6PXMuY29ublksaz1sP1tcIk1cIix4Kyh3WzZdPT09XCJsZWZ0XCI/NTotNSkseixcIkNcIix4LHosMip3WzJdLXdbNF0sMip3WzNdLXdbNV0sd1syXSx3WzNdLFwiTFwiLHdbNF0sd1s1XV06W1wiTVwiLHgrKHdbNl09PT1cImxlZnRcIj81Oi01KSx6LFwiTFwiLHdbMl0sd1szXSxcIkxcIix3WzRdLHdbNV1dLGo/KGouYW5pbWF0ZSh7ZDprfSksai5hdHRyKFwidmlzaWJpbGl0eVwiLEMpKTpiLmNvbm5lY3Rvcj1qPWEuY2hhcnQucmVuZGVyZXIucGF0aChrKS5hdHRyKHtcInN0cm9rZS13aWR0aFwiOmcsc3Ryb2tlOmUuY29ubmVjdG9yQ29sb3J8fGIuY29sb3J8fFwiIzYwNjA2MFwiLHZpc2liaWxpdHk6Q30pLmFkZChhLmRhdGFMYWJlbHNHcm91cCk7ZWxzZSBpZihqKWIuY29ubmVjdG9yPWouZGVzdHJveSgpfSl9fSxcbksucGllLnByb3RvdHlwZS5wbGFjZURhdGFMYWJlbHM9ZnVuY3Rpb24oKXtuKHRoaXMucG9pbnRzLGZ1bmN0aW9uKGEpe3ZhciBiPWEuZGF0YUxhYmVsO2lmKGImJmEudmlzaWJsZSkoYT1iLl9wb3MpPyhiLmF0dHIoYi5fYXR0ciksYltiLm1vdmVkP1wiYW5pbWF0ZVwiOlwiYXR0clwiXShhKSxiLm1vdmVkPSEwKTpiJiZiLmF0dHIoe3k6LTk5OTl9KX0pfSxLLnBpZS5wcm90b3R5cGUuYWxpZ25EYXRhTGFiZWw9cmEsSy5waWUucHJvdG90eXBlLnZlcmlmeURhdGFMYWJlbE92ZXJmbG93PWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY2VudGVyLGM9dGhpcy5vcHRpb25zLGQ9Yy5jZW50ZXIsZT1jLm1pblNpemV8fDgwLGY9ZSxnO2RbMF0hPT1udWxsP2Y9dihiWzJdLXYoYVsxXSxhWzNdKSxlKTooZj12KGJbMl0tYVsxXS1hWzNdLGUpLGJbMF0rPShhWzNdLWFbMV0pLzIpO2RbMV0hPT1udWxsP2Y9dihFKGYsYlsyXS12KGFbMF0sYVsyXSkpLGUpOihmPXYoRShmLGJbMl0tYVswXS1hWzJdKSxlKSxcbmJbMV0rPShhWzBdLWFbMl0pLzIpO2Y8YlsyXT8oYlsyXT1mLGJbM109TWF0aC5taW4oLyUkLy50ZXN0KGMuaW5uZXJTaXplfHwwKT9mKnBhcnNlRmxvYXQoYy5pbm5lclNpemV8fDApLzEwMDpwYXJzZUZsb2F0KGMuaW5uZXJTaXplfHwwKSxmKSx0aGlzLnRyYW5zbGF0ZShiKSx0aGlzLmRyYXdEYXRhTGFiZWxzJiZ0aGlzLmRyYXdEYXRhTGFiZWxzKCkpOmc9ITA7cmV0dXJuIGd9O2lmKEsuY29sdW1uKUsuY29sdW1uLnByb3RvdHlwZS5hbGlnbkRhdGFMYWJlbD1mdW5jdGlvbihhLGIsYyxkLGUpe3ZhciBmPXRoaXMuY2hhcnQuaW52ZXJ0ZWQsZz1hLnNlcmllcyxoPWEuZGxCb3h8fGEuc2hhcGVBcmdzLGk9cShhLmJlbG93LGEucGxvdFk+cSh0aGlzLnRyYW5zbGF0ZWRUaHJlc2hvbGQsZy55QXhpcy5sZW4pKSxqPXEoYy5pbnNpZGUsISF0aGlzLm9wdGlvbnMuc3RhY2tpbmcpO2lmKGgpe2Q9QyhoKTtpZihkLnk8MClkLmhlaWdodCs9ZC55LGQueT0wO2g9ZC55K2QuaGVpZ2h0LWcueUF4aXMubGVuO1xuaD4wJiYoZC5oZWlnaHQtPWgpO2YmJihkPXt4OmcueUF4aXMubGVuLWQueS1kLmhlaWdodCx5OmcueEF4aXMubGVuLWQueC1kLndpZHRoLHdpZHRoOmQuaGVpZ2h0LGhlaWdodDpkLndpZHRofSk7aWYoIWopZj8oZC54Kz1pPzA6ZC53aWR0aCxkLndpZHRoPTApOihkLnkrPWk/ZC5oZWlnaHQ6MCxkLmhlaWdodD0wKX1jLmFsaWduPXEoYy5hbGlnbiwhZnx8aj9cImNlbnRlclwiOmk/XCJyaWdodFwiOlwibGVmdFwiKTtjLnZlcnRpY2FsQWxpZ249cShjLnZlcnRpY2FsQWxpZ24sZnx8aj9cIm1pZGRsZVwiOmk/XCJ0b3BcIjpcImJvdHRvbVwiKTtRLnByb3RvdHlwZS5hbGlnbkRhdGFMYWJlbC5jYWxsKHRoaXMsYSxiLGMsZCxlKX07KGZ1bmN0aW9uKGEpe3ZhciBiPWEuQ2hhcnQsYz1hLmVhY2gsZD1hLnBpY2ssZT1hLmFkZEV2ZW50O2IucHJvdG90eXBlLmNhbGxiYWNrcy5wdXNoKGZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoKXt2YXIgZT1bXTtjKGEuc2VyaWVzLGZ1bmN0aW9uKGEpe3ZhciBiPWEub3B0aW9ucy5kYXRhTGFiZWxzLFxuZj1hLmRhdGFMYWJlbENvbGxlY3Rpb25zfHxbXCJkYXRhTGFiZWxcIl07KGIuZW5hYmxlZHx8YS5faGFzUG9pbnRMYWJlbHMpJiYhYi5hbGxvd092ZXJsYXAmJmEudmlzaWJsZSYmYyhmLGZ1bmN0aW9uKGIpe2MoYS5wb2ludHMsZnVuY3Rpb24oYSl7aWYoYVtiXSlhW2JdLmxhYmVscmFuaz1kKGEubGFiZWxyYW5rLGEuc2hhcGVBcmdzJiZhLnNoYXBlQXJncy5oZWlnaHQpLGUucHVzaChhW2JdKX0pfSl9KTthLmhpZGVPdmVybGFwcGluZ0xhYmVscyhlKX1iKCk7ZShhLFwicmVkcmF3XCIsYil9KTtiLnByb3RvdHlwZS5oaWRlT3ZlcmxhcHBpbmdMYWJlbHM9ZnVuY3Rpb24oYSl7dmFyIGI9YS5sZW5ndGgsZCxlLGosayxsLG0sbyxwLG47Zm9yKGU9MDtlPGI7ZSsrKWlmKGQ9YVtlXSlkLm9sZE9wYWNpdHk9ZC5vcGFjaXR5LGQubmV3T3BhY2l0eT0xO2Euc29ydChmdW5jdGlvbihhLGIpe3JldHVybihiLmxhYmVscmFua3x8MCktKGEubGFiZWxyYW5rfHwwKX0pO2ZvcihlPTA7ZTxiO2UrKyl7aj1cbmFbZV07Zm9yKGQ9ZSsxO2Q8YjsrK2QpaWYoaz1hW2RdLGomJmsmJmoucGxhY2VkJiZrLnBsYWNlZCYmai5uZXdPcGFjaXR5IT09MCYmay5uZXdPcGFjaXR5IT09MCYmKGw9ai5hbGlnbkF0dHIsbT1rLmFsaWduQXR0cixvPWoucGFyZW50R3JvdXAscD1rLnBhcmVudEdyb3VwLG49Miooai5ib3g/MDpqLnBhZGRpbmcpLGw9IShtLngrcC50cmFuc2xhdGVYPmwueCtvLnRyYW5zbGF0ZVgrKGoud2lkdGgtbil8fG0ueCtwLnRyYW5zbGF0ZVgrKGsud2lkdGgtbik8bC54K28udHJhbnNsYXRlWHx8bS55K3AudHJhbnNsYXRlWT5sLnkrby50cmFuc2xhdGVZKyhqLmhlaWdodC1uKXx8bS55K3AudHJhbnNsYXRlWSsoay5oZWlnaHQtbik8bC55K28udHJhbnNsYXRlWSkpKShqLmxhYmVscmFuazxrLmxhYmVscmFuaz9qOmspLm5ld09wYWNpdHk9MH1jKGEsZnVuY3Rpb24oYSl7dmFyIGIsYztpZihhKXtjPWEubmV3T3BhY2l0eTtpZihhLm9sZE9wYWNpdHkhPT1jJiZhLnBsYWNlZCljP2Euc2hvdyghMCk6XG5iPWZ1bmN0aW9uKCl7YS5oaWRlKCl9LGEuYWxpZ25BdHRyLm9wYWNpdHk9YyxhW2EuaXNPbGQ/XCJhbmltYXRlXCI6XCJhdHRyXCJdKGEuYWxpZ25BdHRyLG51bGwsYik7YS5pc09sZD0hMH19KX19KSh6KTt2YXIgbmI9ei5UcmFja2VyTWl4aW49e2RyYXdUcmFja2VyUG9pbnQ6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5jaGFydCxjPWIucG9pbnRlcixkPWEub3B0aW9ucy5jdXJzb3IsZT1kJiZ7Y3Vyc29yOmR9LGY9ZnVuY3Rpb24oYSl7Zm9yKHZhciBjPWEudGFyZ2V0LGQ7YyYmIWQ7KWQ9Yy5wb2ludCxjPWMucGFyZW50Tm9kZTtpZihkIT09dCYmZCE9PWIuaG92ZXJQb2ludClkLm9uTW91c2VPdmVyKGEpfTtuKGEucG9pbnRzLGZ1bmN0aW9uKGEpe2lmKGEuZ3JhcGhpYylhLmdyYXBoaWMuZWxlbWVudC5wb2ludD1hO2lmKGEuZGF0YUxhYmVsKWEuZGF0YUxhYmVsLmVsZW1lbnQucG9pbnQ9YX0pO2lmKCFhLl9oYXNUcmFja2luZyluKGEudHJhY2tlckdyb3VwcyxmdW5jdGlvbihiKXtpZihhW2JdJiZcbihhW2JdLmFkZENsYXNzKFwiaGlnaGNoYXJ0cy10cmFja2VyXCIpLm9uKFwibW91c2VvdmVyXCIsZikub24oXCJtb3VzZW91dFwiLGZ1bmN0aW9uKGEpe2Mub25UcmFja2VyTW91c2VPdXQoYSl9KS5jc3MoZSksZGIpKWFbYl0ub24oXCJ0b3VjaHN0YXJ0XCIsZil9KSxhLl9oYXNUcmFja2luZz0hMH0sZHJhd1RyYWNrZXJHcmFwaDpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLm9wdGlvbnMsYz1iLnRyYWNrQnlBcmVhLGQ9W10uY29uY2F0KGM/YS5hcmVhUGF0aDphLmdyYXBoUGF0aCksZT1kLmxlbmd0aCxmPWEuY2hhcnQsZz1mLnBvaW50ZXIsaD1mLnJlbmRlcmVyLGk9Zi5vcHRpb25zLnRvb2x0aXAuc25hcCxqPWEudHJhY2tlcixrPWIuY3Vyc29yLGw9ayYme2N1cnNvcjprfSxtPWZ1bmN0aW9uKCl7aWYoZi5ob3ZlclNlcmllcyE9PWEpYS5vbk1vdXNlT3ZlcigpfSxvPVwicmdiYSgxOTIsMTkyLDE5MixcIisoamE/MS4wRS00OjAuMDAyKStcIilcIjtpZihlJiYhYylmb3Ioaz1lKzE7ay0tOylkW2tdPT09XG5cIk1cIiYmZC5zcGxpY2UoaysxLDAsZFtrKzFdLWksZFtrKzJdLFwiTFwiKSwoayYmZFtrXT09PVwiTVwifHxrPT09ZSkmJmQuc3BsaWNlKGssMCxcIkxcIixkW2stMl0raSxkW2stMV0pO2o/ai5hdHRyKHtkOmR9KTooYS50cmFja2VyPWgucGF0aChkKS5hdHRyKHtcInN0cm9rZS1saW5lam9pblwiOlwicm91bmRcIix2aXNpYmlsaXR5OmEudmlzaWJsZT9cInZpc2libGVcIjpcImhpZGRlblwiLHN0cm9rZTpvLGZpbGw6Yz9vOlwibm9uZVwiLFwic3Ryb2tlLXdpZHRoXCI6Yi5saW5lV2lkdGgrKGM/MDoyKmkpLHpJbmRleDoyfSkuYWRkKGEuZ3JvdXApLG4oW2EudHJhY2tlcixhLm1hcmtlckdyb3VwXSxmdW5jdGlvbihhKXthLmFkZENsYXNzKFwiaGlnaGNoYXJ0cy10cmFja2VyXCIpLm9uKFwibW91c2VvdmVyXCIsbSkub24oXCJtb3VzZW91dFwiLGZ1bmN0aW9uKGEpe2cub25UcmFja2VyTW91c2VPdXQoYSl9KS5jc3MobCk7aWYoZGIpYS5vbihcInRvdWNoc3RhcnRcIixtKX0pKX19O2lmKEsuY29sdW1uKUlhLnByb3RvdHlwZS5kcmF3VHJhY2tlcj1cbm5iLmRyYXdUcmFja2VyUG9pbnQ7aWYoSy5waWUpSy5waWUucHJvdG90eXBlLmRyYXdUcmFja2VyPW5iLmRyYXdUcmFja2VyUG9pbnQ7aWYoSy5zY2F0dGVyKXphLnByb3RvdHlwZS5kcmF3VHJhY2tlcj1uYi5kcmF3VHJhY2tlclBvaW50O3godmIucHJvdG90eXBlLHtzZXRJdGVtRXZlbnRzOmZ1bmN0aW9uKGEsYixjLGQsZSl7dmFyIGY9dGhpczsoYz9iOmEubGVnZW5kR3JvdXApLm9uKFwibW91c2VvdmVyXCIsZnVuY3Rpb24oKXthLnNldFN0YXRlKFwiaG92ZXJcIik7Yi5jc3MoZi5vcHRpb25zLml0ZW1Ib3ZlclN0eWxlKX0pLm9uKFwibW91c2VvdXRcIixmdW5jdGlvbigpe2IuY3NzKGEudmlzaWJsZT9kOmUpO2Euc2V0U3RhdGUoKX0pLm9uKFwiY2xpY2tcIixmdW5jdGlvbihiKXt2YXIgYz1mdW5jdGlvbigpe2Euc2V0VmlzaWJsZSYmYS5zZXRWaXNpYmxlKCl9LGI9e2Jyb3dzZXJFdmVudDpifTthLmZpcmVQb2ludEV2ZW50P2EuZmlyZVBvaW50RXZlbnQoXCJsZWdlbmRJdGVtQ2xpY2tcIixiLGMpOlxuTShhLFwibGVnZW5kSXRlbUNsaWNrXCIsYixjKX0pfSxjcmVhdGVDaGVja2JveEZvckl0ZW06ZnVuY3Rpb24oYSl7YS5jaGVja2JveD1lYShcImlucHV0XCIse3R5cGU6XCJjaGVja2JveFwiLGNoZWNrZWQ6YS5zZWxlY3RlZCxkZWZhdWx0Q2hlY2tlZDphLnNlbGVjdGVkfSx0aGlzLm9wdGlvbnMuaXRlbUNoZWNrYm94U3R5bGUsdGhpcy5jaGFydC5jb250YWluZXIpO0QoYS5jaGVja2JveCxcImNsaWNrXCIsZnVuY3Rpb24oYil7TShhLnNlcmllc3x8YSxcImNoZWNrYm94Q2xpY2tcIix7Y2hlY2tlZDpiLnRhcmdldC5jaGVja2VkLGl0ZW06YX0sZnVuY3Rpb24oKXthLnNlbGVjdCgpfSl9KX19KTtOLmxlZ2VuZC5pdGVtU3R5bGUuY3Vyc29yPVwicG9pbnRlclwiO3goQ2EucHJvdG90eXBlLHtzaG93UmVzZXRab29tOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPU4ubGFuZyxjPWEub3B0aW9ucy5jaGFydC5yZXNldFpvb21CdXR0b24sZD1jLnRoZW1lLGU9ZC5zdGF0ZXMsZj1jLnJlbGF0aXZlVG89PT1cImNoYXJ0XCI/XG5udWxsOlwicGxvdEJveFwiO3RoaXMucmVzZXRab29tQnV0dG9uPWEucmVuZGVyZXIuYnV0dG9uKGIucmVzZXRab29tLG51bGwsbnVsbCxmdW5jdGlvbigpe2Euem9vbU91dCgpfSxkLGUmJmUuaG92ZXIpLmF0dHIoe2FsaWduOmMucG9zaXRpb24uYWxpZ24sdGl0bGU6Yi5yZXNldFpvb21UaXRsZX0pLmFkZCgpLmFsaWduKGMucG9zaXRpb24sITEsZil9LHpvb21PdXQ6ZnVuY3Rpb24oKXt2YXIgYT10aGlzO00oYSxcInNlbGVjdGlvblwiLHtyZXNldFNlbGVjdGlvbjohMH0sZnVuY3Rpb24oKXthLnpvb20oKX0pfSx6b29tOmZ1bmN0aW9uKGEpe3ZhciBiLGM9dGhpcy5wb2ludGVyLGQ9ITEsZTshYXx8YS5yZXNldFNlbGVjdGlvbj9uKHRoaXMuYXhlcyxmdW5jdGlvbihhKXtiPWEuem9vbSgpfSk6bihhLnhBeGlzLmNvbmNhdChhLnlBeGlzKSxmdW5jdGlvbihhKXt2YXIgZT1hLmF4aXMsaD1lLmlzWEF4aXM7aWYoY1toP1wiem9vbVhcIjpcInpvb21ZXCJdfHxjW2g/XCJwaW5jaFhcIjpcInBpbmNoWVwiXSliPVxuZS56b29tKGEubWluLGEubWF4KSxlLmRpc3BsYXlCdG4mJihkPSEwKX0pO2U9dGhpcy5yZXNldFpvb21CdXR0b247aWYoZCYmIWUpdGhpcy5zaG93UmVzZXRab29tKCk7ZWxzZSBpZighZCYmZGEoZSkpdGhpcy5yZXNldFpvb21CdXR0b249ZS5kZXN0cm95KCk7YiYmdGhpcy5yZWRyYXcocSh0aGlzLm9wdGlvbnMuY2hhcnQuYW5pbWF0aW9uLGEmJmEuYW5pbWF0aW9uLHRoaXMucG9pbnRDb3VudDwxMDApKX0scGFuOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcyxkPWMuaG92ZXJQb2ludHMsZTtkJiZuKGQsZnVuY3Rpb24oYSl7YS5zZXRTdGF0ZSgpfSk7bihiPT09XCJ4eVwiP1sxLDBdOlsxXSxmdW5jdGlvbihiKXt2YXIgYj1jW2I/XCJ4QXhpc1wiOlwieUF4aXNcIl1bMF0sZD1iLmhvcml6LGg9YVtkP1wiY2hhcnRYXCI6XCJjaGFydFlcIl0sZD1kP1wibW91c2VEb3duWFwiOlwibW91c2VEb3duWVwiLGk9Y1tkXSxqPShiLnBvaW50UmFuZ2V8fDApLzIsaz1iLmdldEV4dHJlbWVzKCksbD1iLnRvVmFsdWUoaS1cbmgsITApK2osaj1iLnRvVmFsdWUoaStiLmxlbi1oLCEwKS1qLGk9aT5oO2lmKGIuc2VyaWVzLmxlbmd0aCYmKGl8fGw+RShrLmRhdGFNaW4say5taW4pKSYmKCFpfHxqPHYoay5kYXRhTWF4LGsubWF4KSkpYi5zZXRFeHRyZW1lcyhsLGosITEsITEse3RyaWdnZXI6XCJwYW5cIn0pLGU9ITA7Y1tkXT1ofSk7ZSYmYy5yZWRyYXcoITEpO0YoYy5jb250YWluZXIse2N1cnNvcjpcIm1vdmVcIn0pfX0pO3goSGEucHJvdG90eXBlLHtzZWxlY3Q6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLGQ9Yy5zZXJpZXMsZT1kLmNoYXJ0LGE9cShhLCFjLnNlbGVjdGVkKTtjLmZpcmVQb2ludEV2ZW50KGE/XCJzZWxlY3RcIjpcInVuc2VsZWN0XCIse2FjY3VtdWxhdGU6Yn0sZnVuY3Rpb24oKXtjLnNlbGVjdGVkPWMub3B0aW9ucy5zZWxlY3RlZD1hO2Qub3B0aW9ucy5kYXRhW3NhKGMsZC5kYXRhKV09Yy5vcHRpb25zO2Muc2V0U3RhdGUoYSYmXCJzZWxlY3RcIik7Ynx8bihlLmdldFNlbGVjdGVkUG9pbnRzKCksZnVuY3Rpb24oYSl7aWYoYS5zZWxlY3RlZCYmXG5hIT09YylhLnNlbGVjdGVkPWEub3B0aW9ucy5zZWxlY3RlZD0hMSxkLm9wdGlvbnMuZGF0YVtzYShhLGQuZGF0YSldPWEub3B0aW9ucyxhLnNldFN0YXRlKFwiXCIpLGEuZmlyZVBvaW50RXZlbnQoXCJ1bnNlbGVjdFwiKX0pfSl9LG9uTW91c2VPdmVyOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5zZXJpZXMsZD1jLmNoYXJ0LGU9ZC50b29sdGlwLGY9ZC5ob3ZlclBvaW50O2lmKGQuaG92ZXJTZXJpZXMhPT1jKWMub25Nb3VzZU92ZXIoKTtpZihmJiZmIT09dGhpcylmLm9uTW91c2VPdXQoKTtpZih0aGlzLnNlcmllcyYmKHRoaXMuZmlyZVBvaW50RXZlbnQoXCJtb3VzZU92ZXJcIiksZSYmKCFlLnNoYXJlZHx8Yy5ub1NoYXJlZFRvb2x0aXApJiZlLnJlZnJlc2godGhpcyxhKSx0aGlzLnNldFN0YXRlKFwiaG92ZXJcIiksIWIpKWQuaG92ZXJQb2ludD10aGlzfSxvbk1vdXNlT3V0OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5zZXJpZXMuY2hhcnQsYj1hLmhvdmVyUG9pbnRzO3RoaXMuZmlyZVBvaW50RXZlbnQoXCJtb3VzZU91dFwiKTtcbmlmKCFifHxzYSh0aGlzLGIpPT09LTEpdGhpcy5zZXRTdGF0ZSgpLGEuaG92ZXJQb2ludD1udWxsfSxpbXBvcnRFdmVudHM6ZnVuY3Rpb24oKXtpZighdGhpcy5oYXNJbXBvcnRlZEV2ZW50cyl7dmFyIGE9Qyh0aGlzLnNlcmllcy5vcHRpb25zLnBvaW50LHRoaXMub3B0aW9ucykuZXZlbnRzLGI7dGhpcy5ldmVudHM9YTtmb3IoYiBpbiBhKUQodGhpcyxiLGFbYl0pO3RoaXMuaGFzSW1wb3J0ZWRFdmVudHM9ITB9fSxzZXRTdGF0ZTpmdW5jdGlvbihhLGIpe3ZhciBjPVYodGhpcy5wbG90WCksZD10aGlzLnBsb3RZLGU9dGhpcy5zZXJpZXMsZj1lLm9wdGlvbnMuc3RhdGVzLGc9V1tlLnR5cGVdLm1hcmtlciYmZS5vcHRpb25zLm1hcmtlcixoPWcmJiFnLmVuYWJsZWQsaT1nJiZnLnN0YXRlc1thXSxqPWkmJmkuZW5hYmxlZD09PSExLGs9ZS5zdGF0ZU1hcmtlckdyYXBoaWMsbD10aGlzLm1hcmtlcnx8e30sbT1lLmNoYXJ0LG89ZS5oYWxvLHAsYT1hfHxcIlwiO3A9dGhpcy5wb2ludEF0dHJbYV18fFxuZS5wb2ludEF0dHJbYV07aWYoIShhPT09dGhpcy5zdGF0ZSYmIWJ8fHRoaXMuc2VsZWN0ZWQmJmEhPT1cInNlbGVjdFwifHxmW2FdJiZmW2FdLmVuYWJsZWQ9PT0hMXx8YSYmKGp8fGgmJmkuZW5hYmxlZD09PSExKXx8YSYmbC5zdGF0ZXMmJmwuc3RhdGVzW2FdJiZsLnN0YXRlc1thXS5lbmFibGVkPT09ITEpKXtpZih0aGlzLmdyYXBoaWMpZz1nJiZ0aGlzLmdyYXBoaWMuc3ltYm9sTmFtZSYmcC5yLHRoaXMuZ3JhcGhpYy5hdHRyKEMocCxnP3t4OmMtZyx5OmQtZyx3aWR0aDoyKmcsaGVpZ2h0OjIqZ306e30pKSxrJiZrLmhpZGUoKTtlbHNle2lmKGEmJmkpaWYoZz1pLnJhZGl1cyxsPWwuc3ltYm9sfHxlLnN5bWJvbCxrJiZrLmN1cnJlbnRTeW1ib2whPT1sJiYoaz1rLmRlc3Ryb3koKSksaylrW2I/XCJhbmltYXRlXCI6XCJhdHRyXCJdKHt4OmMtZyx5OmQtZ30pO2Vsc2UgaWYobCllLnN0YXRlTWFya2VyR3JhcGhpYz1rPW0ucmVuZGVyZXIuc3ltYm9sKGwsYy1nLGQtZywyKmcsMipnKS5hdHRyKHApLmFkZChlLm1hcmtlckdyb3VwKSxcbmsuY3VycmVudFN5bWJvbD1sO2lmKGspa1thJiZtLmlzSW5zaWRlUGxvdChjLGQsbS5pbnZlcnRlZCk/XCJzaG93XCI6XCJoaWRlXCJdKCksay5lbGVtZW50LnBvaW50PXRoaXN9aWYoKGM9ZlthXSYmZlthXS5oYWxvKSYmYy5zaXplKXtpZighbyllLmhhbG89bz1tLnJlbmRlcmVyLnBhdGgoKS5hZGQobS5zZXJpZXNHcm91cCk7by5hdHRyKHgoe2ZpbGw6dGhpcy5jb2xvcnx8ZS5jb2xvcixcImZpbGwtb3BhY2l0eVwiOmMub3BhY2l0eSx6SW5kZXg6LTF9LGMuYXR0cmlidXRlcykpW2I/XCJhbmltYXRlXCI6XCJhdHRyXCJdKHtkOnRoaXMuaGFsb1BhdGgoYy5zaXplKX0pfWVsc2UgbyYmby5hdHRyKHtkOltdfSk7dGhpcy5zdGF0ZT1hfX0saGFsb1BhdGg6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5zZXJpZXMsYz1iLmNoYXJ0LGQ9Yi5nZXRQbG90Qm94KCksZT1jLmludmVydGVkLGY9TWF0aC5mbG9vcih0aGlzLnBsb3RYKTtyZXR1cm4gYy5yZW5kZXJlci5zeW1ib2xzLmNpcmNsZShkLnRyYW5zbGF0ZVgrXG4oZT9iLnlBeGlzLmxlbi10aGlzLnBsb3RZOmYpLWEsZC50cmFuc2xhdGVZKyhlP2IueEF4aXMubGVuLWY6dGhpcy5wbG90WSktYSxhKjIsYSoyKX19KTt4KFEucHJvdG90eXBlLHtvbk1vdXNlT3ZlcjpmdW5jdGlvbigpe3ZhciBhPXRoaXMuY2hhcnQsYj1hLmhvdmVyU2VyaWVzO2lmKGImJmIhPT10aGlzKWIub25Nb3VzZU91dCgpO3RoaXMub3B0aW9ucy5ldmVudHMubW91c2VPdmVyJiZNKHRoaXMsXCJtb3VzZU92ZXJcIik7dGhpcy5zZXRTdGF0ZShcImhvdmVyXCIpO2EuaG92ZXJTZXJpZXM9dGhpc30sb25Nb3VzZU91dDpmdW5jdGlvbigpe3ZhciBhPXRoaXMub3B0aW9ucyxiPXRoaXMuY2hhcnQsYz1iLnRvb2x0aXAsZD1iLmhvdmVyUG9pbnQ7Yi5ob3ZlclNlcmllcz1udWxsO2lmKGQpZC5vbk1vdXNlT3V0KCk7dGhpcyYmYS5ldmVudHMubW91c2VPdXQmJk0odGhpcyxcIm1vdXNlT3V0XCIpO2MmJiFhLnN0aWNreVRyYWNraW5nJiYoIWMuc2hhcmVkfHx0aGlzLm5vU2hhcmVkVG9vbHRpcCkmJlxuYy5oaWRlKCk7dGhpcy5zZXRTdGF0ZSgpfSxzZXRTdGF0ZTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLm9wdGlvbnMsYz10aGlzLmdyYXBoLGQ9Yi5zdGF0ZXMsZT1iLmxpbmVXaWR0aCxiPTAsYT1hfHxcIlwiO2lmKHRoaXMuc3RhdGUhPT1hJiYodGhpcy5zdGF0ZT1hLCEoZFthXSYmZFthXS5lbmFibGVkPT09ITEpJiYoYSYmKGU9ZFthXS5saW5lV2lkdGh8fGUrKGRbYV0ubGluZVdpZHRoUGx1c3x8MCkpLGMmJiFjLmRhc2hzdHlsZSkpKXthPXtcInN0cm9rZS13aWR0aFwiOmV9O2ZvcihjLmF0dHIoYSk7dGhpc1tcInpvbmVHcmFwaFwiK2JdOyl0aGlzW1wiem9uZUdyYXBoXCIrYl0uYXR0cihhKSxiKz0xfX0sc2V0VmlzaWJsZTpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMsZD1jLmNoYXJ0LGU9Yy5sZWdlbmRJdGVtLGYsZz1kLm9wdGlvbnMuY2hhcnQuaWdub3JlSGlkZGVuU2VyaWVzLGg9Yy52aXNpYmxlO2Y9KGMudmlzaWJsZT1hPWMudXNlck9wdGlvbnMudmlzaWJsZT1hPT09dD8haDphKT9cInNob3dcIjpcblwiaGlkZVwiO24oW1wiZ3JvdXBcIixcImRhdGFMYWJlbHNHcm91cFwiLFwibWFya2VyR3JvdXBcIixcInRyYWNrZXJcIl0sZnVuY3Rpb24oYSl7aWYoY1thXSljW2FdW2ZdKCl9KTtpZihkLmhvdmVyU2VyaWVzPT09Y3x8KGQuaG92ZXJQb2ludCYmZC5ob3ZlclBvaW50LnNlcmllcyk9PT1jKWMub25Nb3VzZU91dCgpO2UmJmQubGVnZW5kLmNvbG9yaXplSXRlbShjLGEpO2MuaXNEaXJ0eT0hMDtjLm9wdGlvbnMuc3RhY2tpbmcmJm4oZC5zZXJpZXMsZnVuY3Rpb24oYSl7aWYoYS5vcHRpb25zLnN0YWNraW5nJiZhLnZpc2libGUpYS5pc0RpcnR5PSEwfSk7bihjLmxpbmtlZFNlcmllcyxmdW5jdGlvbihiKXtiLnNldFZpc2libGUoYSwhMSl9KTtpZihnKWQuaXNEaXJ0eUJveD0hMDtiIT09ITEmJmQucmVkcmF3KCk7TShjLGYpfSxzaG93OmZ1bmN0aW9uKCl7dGhpcy5zZXRWaXNpYmxlKCEwKX0saGlkZTpmdW5jdGlvbigpe3RoaXMuc2V0VmlzaWJsZSghMSl9LHNlbGVjdDpmdW5jdGlvbihhKXt0aGlzLnNlbGVjdGVkPVxuYT1hPT09dD8hdGhpcy5zZWxlY3RlZDphO2lmKHRoaXMuY2hlY2tib3gpdGhpcy5jaGVja2JveC5jaGVja2VkPWE7TSh0aGlzLGE/XCJzZWxlY3RcIjpcInVuc2VsZWN0XCIpfSxkcmF3VHJhY2tlcjpuYi5kcmF3VHJhY2tlckdyYXBofSk7VShRLnByb3RvdHlwZSxcImluaXRcIixmdW5jdGlvbihhKXt2YXIgYjthLmFwcGx5KHRoaXMsQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpKTsoYj10aGlzLnhBeGlzKSYmYi5vcHRpb25zLm9yZGluYWwmJkQodGhpcyxcInVwZGF0ZWREYXRhXCIsZnVuY3Rpb24oKXtkZWxldGUgYi5vcmRpbmFsSW5kZXh9KX0pO1UoSS5wcm90b3R5cGUsXCJnZXRUaW1lVGlja3NcIixmdW5jdGlvbihhLGIsYyxkLGUsZixnLGgpe3ZhciBpPTAsaixrLGw9e30sbSxvLHAsbj1bXSxxPS1OdW1iZXIuTUFYX1ZBTFVFLHY9dGhpcy5vcHRpb25zLnRpY2tQaXhlbEludGVydmFsO2lmKCF0aGlzLm9wdGlvbnMub3JkaW5hbCYmIXRoaXMub3B0aW9ucy5icmVha3N8fFxuIWZ8fGYubGVuZ3RoPDN8fGM9PT10KXJldHVybiBhLmNhbGwodGhpcyxiLGMsZCxlKTtvPWYubGVuZ3RoO2ZvcihqPTA7ajxvO2orKyl7cD1qJiZmW2otMV0+ZDtmW2pdPGMmJihpPWopO2lmKGo9PT1vLTF8fGZbaisxXS1mW2pdPmcqNXx8cCl7aWYoZltqXT5xKXtmb3Ioaz1hLmNhbGwodGhpcyxiLGZbaV0sZltqXSxlKTtrLmxlbmd0aCYma1swXTw9cTspay5zaGlmdCgpO2subGVuZ3RoJiYocT1rW2subGVuZ3RoLTFdKTtuPW4uY29uY2F0KGspfWk9aisxfWlmKHApYnJlYWt9YT1rLmluZm87aWYoaCYmYS51bml0UmFuZ2U8PUguaG91cil7aj1uLmxlbmd0aC0xO2ZvcihpPTE7aTxqO2krKyltYShcIiVkXCIsbltpXSkhPT1tYShcIiVkXCIsbltpLTFdKSYmKGxbbltpXV09XCJkYXlcIixtPSEwKTttJiYobFtuWzBdXT1cImRheVwiKTthLmhpZ2hlclJhbmtzPWx9bi5pbmZvPWE7aWYoaCYmcyh2KSl7aD1hPW4ubGVuZ3RoO2o9W107dmFyIHU7Zm9yKG09W107aC0tOylpPXRoaXMudHJhbnNsYXRlKG5baF0pLFxudSYmKG1baF09dS1pKSxqW2hdPXU9aTttLnNvcnQoKTttPW1bVihtLmxlbmd0aC8yKV07bTx2KjAuNiYmKG09bnVsbCk7aD1uW2EtMV0+ZD9hLTE6YTtmb3IodT12b2lkIDA7aC0tOylpPWpbaF0sZD11LWksdSYmZDx2KjAuOCYmKG09PT1udWxsfHxkPG0qMC44KT8obFtuW2hdXSYmIWxbbltoKzFdXT8oZD1oKzEsdT1pKTpkPWgsbi5zcGxpY2UoZCwxKSk6dT1pfXJldHVybiBufSk7eChJLnByb3RvdHlwZSx7YmVmb3JlU2V0VGlja1Bvc2l0aW9uczpmdW5jdGlvbigpe3ZhciBhLGI9W10sYz0hMSxkLGU9dGhpcy5nZXRFeHRyZW1lcygpLGY9ZS5taW4sZz1lLm1heCxoLGk9dGhpcy5pc1hBeGlzJiYhIXRoaXMub3B0aW9ucy5icmVha3M7aWYoKGU9dGhpcy5vcHRpb25zLm9yZGluYWwpfHxpKXtuKHRoaXMuc2VyaWVzLGZ1bmN0aW9uKGMsZCl7aWYoYy52aXNpYmxlIT09ITEmJihjLnRha2VPcmRpbmFsUG9zaXRpb24hPT0hMXx8aSkpaWYoYj1iLmNvbmNhdChjLnByb2Nlc3NlZFhEYXRhKSxcbmE9Yi5sZW5ndGgsYi5zb3J0KGZ1bmN0aW9uKGEsYil7cmV0dXJuIGEtYn0pLGEpZm9yKGQ9YS0xO2QtLTspYltkXT09PWJbZCsxXSYmYi5zcGxpY2UoZCwxKX0pO2E9Yi5sZW5ndGg7aWYoYT4yKXtkPWJbMV0tYlswXTtmb3IoaD1hLTE7aC0tJiYhYzspYltoKzFdLWJbaF0hPT1kJiYoYz0hMCk7aWYoIXRoaXMub3B0aW9ucy5rZWVwT3JkaW5hbFBhZGRpbmcmJihiWzBdLWY+ZHx8Zy1iW2IubGVuZ3RoLTFdPmQpKWM9ITB9Yz8odGhpcy5vcmRpbmFsUG9zaXRpb25zPWIsZD10aGlzLnZhbDJsaW4odihmLGJbMF0pLCEwKSxoPXYodGhpcy52YWwybGluKEUoZyxiW2IubGVuZ3RoLTFdKSwhMCksMSksdGhpcy5vcmRpbmFsU2xvcGU9Zz0oZy1mKS8oaC1kKSx0aGlzLm9yZGluYWxPZmZzZXQ9Zi1kKmcpOnRoaXMub3JkaW5hbFBvc2l0aW9ucz10aGlzLm9yZGluYWxTbG9wZT10aGlzLm9yZGluYWxPZmZzZXQ9dH10aGlzLmlzT3JkaW5hbD1lJiZjO3RoaXMuZ3JvdXBJbnRlcnZhbEZhY3Rvcj1cbm51bGx9LHZhbDJsaW46ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLm9yZGluYWxQb3NpdGlvbnMsZDtpZihjKXt2YXIgZT1jLmxlbmd0aCxmO2ZvcihkPWU7ZC0tOylpZihjW2RdPT09YSl7Zj1kO2JyZWFrfWZvcihkPWUtMTtkLS07KWlmKGE+Y1tkXXx8ZD09PTApe2M9KGEtY1tkXSkvKGNbZCsxXS1jW2RdKTtmPWQrYzticmVha31kPWI/Zjp0aGlzLm9yZGluYWxTbG9wZSooZnx8MCkrdGhpcy5vcmRpbmFsT2Zmc2V0fWVsc2UgZD1hO3JldHVybiBkfSxsaW4ydmFsOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5vcmRpbmFsUG9zaXRpb25zO2lmKGMpe3ZhciBkPXRoaXMub3JkaW5hbFNsb3BlLGU9dGhpcy5vcmRpbmFsT2Zmc2V0LGY9Yy5sZW5ndGgtMSxnLGg7aWYoYilhPDA/YT1jWzBdOmE+Zj9hPWNbZl06KGY9VihhKSxoPWEtZik7ZWxzZSBmb3IoO2YtLTspaWYoZz1kKmYrZSxhPj1nKXtkPWQqKGYrMSkrZTtoPShhLWcpLyhkLWcpO2JyZWFrfWM9aCE9PXQmJmNbZl0hPT10P2NbZl0rXG4oaD9oKihjW2YrMV0tY1tmXSk6MCk6YX1lbHNlIGM9YTtyZXR1cm4gY30sZ2V0RXh0ZW5kZWRQb3NpdGlvbnM6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmNoYXJ0LGI9dGhpcy5zZXJpZXNbMF0uY3VycmVudERhdGFHcm91cGluZyxjPXRoaXMub3JkaW5hbEluZGV4LGQ9Yj9iLmNvdW50K2IudW5pdE5hbWU6XCJyYXdcIixlPXRoaXMuZ2V0RXh0cmVtZXMoKSxmLGc7aWYoIWMpYz10aGlzLm9yZGluYWxJbmRleD17fTtpZighY1tkXSlmPXtzZXJpZXM6W10sZ2V0RXh0cmVtZXM6ZnVuY3Rpb24oKXtyZXR1cm57bWluOmUuZGF0YU1pbixtYXg6ZS5kYXRhTWF4fX0sb3B0aW9uczp7b3JkaW5hbDohMH0sdmFsMmxpbjpJLnByb3RvdHlwZS52YWwybGlufSxuKHRoaXMuc2VyaWVzLGZ1bmN0aW9uKGMpe2c9e3hBeGlzOmYseERhdGE6Yy54RGF0YSxjaGFydDphLGRlc3Ryb3lHcm91cGVkRGF0YTpyYX07Zy5vcHRpb25zPXtkYXRhR3JvdXBpbmc6Yj97ZW5hYmxlZDohMCxmb3JjZWQ6ITAsYXBwcm94aW1hdGlvbjpcIm9wZW5cIixcbnVuaXRzOltbYi51bml0TmFtZSxbYi5jb3VudF1dXX06e2VuYWJsZWQ6ITF9fTtjLnByb2Nlc3NEYXRhLmFwcGx5KGcpO2Yuc2VyaWVzLnB1c2goZyl9KSx0aGlzLmJlZm9yZVNldFRpY2tQb3NpdGlvbnMuYXBwbHkoZiksY1tkXT1mLm9yZGluYWxQb3NpdGlvbnM7cmV0dXJuIGNbZF19LGdldEdyb3VwSW50ZXJ2YWxGYWN0b3I6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGM9Yy5wcm9jZXNzZWRYRGF0YSxlPWMubGVuZ3RoLGY9W107ZD10aGlzLmdyb3VwSW50ZXJ2YWxGYWN0b3I7aWYoIWQpe2ZvcihkPTA7ZDxlLTE7ZCsrKWZbZF09Y1tkKzFdLWNbZF07Zi5zb3J0KGZ1bmN0aW9uKGEsYil7cmV0dXJuIGEtYn0pO2Y9ZltWKGUvMildO2E9dihhLGNbMF0pO2I9RShiLGNbZS0xXSk7dGhpcy5ncm91cEludGVydmFsRmFjdG9yPWQ9ZSpmLyhiLWEpfXJldHVybiBkfSxwb3N0UHJvY2Vzc1RpY2tJbnRlcnZhbDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLm9yZGluYWxTbG9wZTtyZXR1cm4gYj90aGlzLm9wdGlvbnMuYnJlYWtzP1xudGhpcy5jbG9zZXN0UG9pbnRSYW5nZTphLyhiL3RoaXMuY2xvc2VzdFBvaW50UmFuZ2UpOmF9fSk7VShDYS5wcm90b3R5cGUsXCJwYW5cIixmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMueEF4aXNbMF0sZD1iLmNoYXJ0WCxlPSExO2lmKGMub3B0aW9ucy5vcmRpbmFsJiZjLnNlcmllcy5sZW5ndGgpe3ZhciBmPXRoaXMubW91c2VEb3duWCxnPWMuZ2V0RXh0cmVtZXMoKSxoPWcuZGF0YU1heCxpPWcubWluLGo9Zy5tYXgsaz10aGlzLmhvdmVyUG9pbnRzLGw9Yy5jbG9zZXN0UG9pbnRSYW5nZSxmPShmLWQpLyhjLnRyYW5zbGF0aW9uU2xvcGUqKGMub3JkaW5hbFNsb3BlfHxsKSksbT17b3JkaW5hbFBvc2l0aW9uczpjLmdldEV4dGVuZGVkUG9zaXRpb25zKCl9LGw9Yy5saW4ydmFsLG89Yy52YWwybGluLHA7aWYobS5vcmRpbmFsUG9zaXRpb25zKXtpZihTKGYpPjEpayYmbihrLGZ1bmN0aW9uKGEpe2Euc2V0U3RhdGUoKX0pLGY8MD8oaz1tLHA9Yy5vcmRpbmFsUG9zaXRpb25zP2M6bSk6KGs9XG5jLm9yZGluYWxQb3NpdGlvbnM/YzptLHA9bSksbT1wLm9yZGluYWxQb3NpdGlvbnMsaD5tW20ubGVuZ3RoLTFdJiZtLnB1c2goaCksdGhpcy5maXhlZFJhbmdlPWotaSxmPWMudG9GaXhlZFJhbmdlKG51bGwsbnVsbCxsLmFwcGx5KGssW28uYXBwbHkoayxbaSwhMF0pK2YsITBdKSxsLmFwcGx5KHAsW28uYXBwbHkocCxbaiwhMF0pK2YsITBdKSksZi5taW4+PUUoZy5kYXRhTWluLGkpJiZmLm1heDw9dihoLGopJiZjLnNldEV4dHJlbWVzKGYubWluLGYubWF4LCEwLCExLHt0cmlnZ2VyOlwicGFuXCJ9KSx0aGlzLm1vdXNlRG93blg9ZCxGKHRoaXMuY29udGFpbmVyLHtjdXJzb3I6XCJtb3ZlXCJ9KX1lbHNlIGU9ITB9ZWxzZSBlPSEwO2UmJmEuYXBwbHkodGhpcyxBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSkpfSk7US5wcm90b3R5cGUuZ2FwcGVkUGF0aD1mdW5jdGlvbigpe3ZhciBhPXRoaXMub3B0aW9ucy5nYXBTaXplLGI9dGhpcy5wb2ludHMuc2xpY2UoKSxjPWIubGVuZ3RoLVxuMTtpZihhJiZjPjApZm9yKDtjLS07KWJbYysxXS54LWJbY10ueD50aGlzLmNsb3Nlc3RQb2ludFJhbmdlKmEmJmIuc3BsaWNlKGMrMSwwLHtpc051bGw6ITB9KTtyZXR1cm4gdGhpcy5nZXRHcmFwaFBhdGgoYil9OyhmdW5jdGlvbihhKXthKHopfSkoZnVuY3Rpb24oYSl7ZnVuY3Rpb24gYigpe3JldHVybiBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSl9ZnVuY3Rpb24gYyhhKXthLmFwcGx5KHRoaXMpO3RoaXMuZHJhd0JyZWFrcyh0aGlzLnhBeGlzLFtcInhcIl0pO3RoaXMuZHJhd0JyZWFrcyh0aGlzLnlBeGlzLGQodGhpcy5wb2ludEFycmF5TWFwLFtcInlcIl0pKX12YXIgZD1hLnBpY2ssZT1hLndyYXAsZj1hLmVhY2gsZz1hLmV4dGVuZCxoPWEuZmlyZUV2ZW50LGk9YS5BeGlzLGo9YS5TZXJpZXM7ZyhpLnByb3RvdHlwZSx7aXNJbkJyZWFrOmZ1bmN0aW9uKGEsYil7dmFyIGM9YS5yZXBlYXR8fEluZmluaXR5LGQ9YS5mcm9tLGU9YS50by1hLmZyb20sYz1iPj1kP1xuKGItZCklYzpjLShkLWIpJWM7cmV0dXJuIGEuaW5jbHVzaXZlP2M8PWU6YzxlJiZjIT09MH0saXNJbkFueUJyZWFrOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5vcHRpb25zLmJyZWFrcyxlPWMmJmMubGVuZ3RoLGYsZyxoO2lmKGUpe2Zvcig7ZS0tOyl0aGlzLmlzSW5CcmVhayhjW2VdLGEpJiYoZj0hMCxnfHwoZz1kKGNbZV0uc2hvd1BvaW50cyx0aGlzLmlzWEF4aXM/ITE6ITApKSk7aD1mJiZiP2YmJiFnOmZ9cmV0dXJuIGh9fSk7ZShpLnByb3RvdHlwZSxcInNldFRpY2tQb3NpdGlvbnNcIixmdW5jdGlvbihhKXthLmFwcGx5KHRoaXMsQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpKTtpZih0aGlzLm9wdGlvbnMuYnJlYWtzKXt2YXIgYj10aGlzLnRpY2tQb3NpdGlvbnMsYz10aGlzLnRpY2tQb3NpdGlvbnMuaW5mbyxkPVtdLGU7Zm9yKGU9MDtlPGIubGVuZ3RoO2UrKyl0aGlzLmlzSW5BbnlCcmVhayhiW2VdKXx8ZC5wdXNoKGJbZV0pO3RoaXMudGlja1Bvc2l0aW9ucz1cbmQ7dGhpcy50aWNrUG9zaXRpb25zLmluZm89Y319KTtlKGkucHJvdG90eXBlLFwiaW5pdFwiLGZ1bmN0aW9uKGEsYixjKXtpZihjLmJyZWFrcyYmYy5icmVha3MubGVuZ3RoKWMub3JkaW5hbD0hMTthLmNhbGwodGhpcyxiLGMpO2lmKHRoaXMub3B0aW9ucy5icmVha3Mpe3ZhciBkPXRoaXM7ZC5pc0Jyb2tlbj0hMDt0aGlzLnZhbDJsaW49ZnVuY3Rpb24oYSl7dmFyIGI9YSxjLGU7Zm9yKGU9MDtlPGQuYnJlYWtBcnJheS5sZW5ndGg7ZSsrKWlmKGM9ZC5icmVha0FycmF5W2VdLGMudG88PWEpYi09Yy5sZW47ZWxzZSBpZihjLmZyb20+PWEpYnJlYWs7ZWxzZSBpZihkLmlzSW5CcmVhayhjLGEpKXtiLT1hLWMuZnJvbTticmVha31yZXR1cm4gYn07dGhpcy5saW4ydmFsPWZ1bmN0aW9uKGEpe3ZhciBiLGM7Zm9yKGM9MDtjPGQuYnJlYWtBcnJheS5sZW5ndGg7YysrKWlmKGI9ZC5icmVha0FycmF5W2NdLGIuZnJvbT49YSlicmVhaztlbHNlIGIudG88YT9hKz1iLmxlbjpkLmlzSW5CcmVhayhiLFxuYSkmJihhKz1iLmxlbik7cmV0dXJuIGF9O3RoaXMuc2V0RXh0cmVtZXM9ZnVuY3Rpb24oYSxiLGMsZCxlKXtmb3IoO3RoaXMuaXNJbkFueUJyZWFrKGEpOylhLT10aGlzLmNsb3Nlc3RQb2ludFJhbmdlO2Zvcig7dGhpcy5pc0luQW55QnJlYWsoYik7KWItPXRoaXMuY2xvc2VzdFBvaW50UmFuZ2U7aS5wcm90b3R5cGUuc2V0RXh0cmVtZXMuY2FsbCh0aGlzLGEsYixjLGQsZSl9O3RoaXMuc2V0QXhpc1RyYW5zbGF0aW9uPWZ1bmN0aW9uKGEpe2kucHJvdG90eXBlLnNldEF4aXNUcmFuc2xhdGlvbi5jYWxsKHRoaXMsYSk7dmFyIGI9ZC5vcHRpb25zLmJyZWFrcyxhPVtdLGM9W10sZT0wLGYsZyxrPWQudXNlck1pbnx8ZC5taW4saj1kLnVzZXJNYXh8fGQubWF4LGwsbTtmb3IobSBpbiBiKWc9YlttXSxmPWcucmVwZWF0fHxJbmZpbml0eSxkLmlzSW5CcmVhayhnLGspJiYoays9Zy50byVmLWslZiksZC5pc0luQnJlYWsoZyxqKSYmKGotPWolZi1nLmZyb20lZik7Zm9yKG0gaW4gYil7Zz1iW21dO1xubD1nLmZyb207Zm9yKGY9Zy5yZXBlYXR8fEluZmluaXR5O2wtZj5rOylsLT1mO2Zvcig7bDxrOylsKz1mO2Zvcig7bDxqO2wrPWYpYS5wdXNoKHt2YWx1ZTpsLG1vdmU6XCJpblwifSksYS5wdXNoKHt2YWx1ZTpsKyhnLnRvLWcuZnJvbSksbW92ZTpcIm91dFwiLHNpemU6Zy5icmVha1NpemV9KX1hLnNvcnQoZnVuY3Rpb24oYSxiKXtyZXR1cm4gYS52YWx1ZT09PWIudmFsdWU/KGEubW92ZT09PVwiaW5cIj8wOjEpLShiLm1vdmU9PT1cImluXCI/MDoxKTphLnZhbHVlLWIudmFsdWV9KTtiPTA7bD1rO2ZvcihtIGluIGEpe2c9YVttXTtiKz1nLm1vdmU9PT1cImluXCI/MTotMTtpZihiPT09MSYmZy5tb3ZlPT09XCJpblwiKWw9Zy52YWx1ZTtiPT09MCYmKGMucHVzaCh7ZnJvbTpsLHRvOmcudmFsdWUsbGVuOmcudmFsdWUtbC0oZy5zaXplfHwwKX0pLGUrPWcudmFsdWUtbC0oZy5zaXplfHwwKSl9ZC5icmVha0FycmF5PWM7aChkLFwiYWZ0ZXJCcmVha3NcIik7ZC50cmFuc0EqPShqLWQubWluKS8oai1rLWUpO2QubWluPVxuaztkLm1heD1qfX19KTtlKGoucHJvdG90eXBlLFwiZ2VuZXJhdGVQb2ludHNcIixmdW5jdGlvbihhKXthLmFwcGx5KHRoaXMsYihhcmd1bWVudHMpKTt2YXIgYz10aGlzLnhBeGlzLGQ9dGhpcy55QXhpcyxlPXRoaXMucG9pbnRzLGYsZz1lLmxlbmd0aCxoPXRoaXMub3B0aW9ucy5jb25uZWN0TnVsbHMsaTtpZihjJiZkJiYoYy5vcHRpb25zLmJyZWFrc3x8ZC5vcHRpb25zLmJyZWFrcykpZm9yKDtnLS07KWlmKGY9ZVtnXSxpPWYueT09PW51bGwmJmg9PT0hMSwhaSYmKGMuaXNJbkFueUJyZWFrKGYueCwhMCl8fGQuaXNJbkFueUJyZWFrKGYueSwhMCkpKWUuc3BsaWNlKGcsMSksdGhpcy5kYXRhW2ddJiZ0aGlzLmRhdGFbZ10uZGVzdHJveUVsZW1lbnRzKCl9KTthLlNlcmllcy5wcm90b3R5cGUuZHJhd0JyZWFrcz1mdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMsZT1jLnBvaW50cyxnLGksaixuO2YoYixmdW5jdGlvbihiKXtnPWEuYnJlYWtBcnJheXx8W107aT1hLmlzWEF4aXM/YS5taW46ZChjLm9wdGlvbnMudGhyZXNob2xkLFxuYS5taW4pO2YoZSxmdW5jdGlvbihjKXtuPWQoY1tcInN0YWNrXCIrYi50b1VwcGVyQ2FzZSgpXSxjW2JdKTtmKGcsZnVuY3Rpb24oYil7aj0hMTtpZihpPGIuZnJvbSYmbj5iLnRvfHxpPmIuZnJvbSYmbjxiLmZyb20paj1cInBvaW50QnJlYWtcIjtlbHNlIGlmKGk8Yi5mcm9tJiZuPmIuZnJvbSYmbjxiLnRvfHxpPmIuZnJvbSYmbj5iLnRvJiZuPGIuZnJvbSlqPVwicG9pbnRJbkJyZWFrXCI7aiYmaChhLGose3BvaW50OmMsYnJrOmJ9KX0pfSl9KX07ZShhLnNlcmllc1R5cGVzLmNvbHVtbi5wcm90b3R5cGUsXCJkcmF3UG9pbnRzXCIsYyk7ZShhLlNlcmllcy5wcm90b3R5cGUsXCJkcmF3UG9pbnRzXCIsYyl9KTt2YXIgaWE9US5wcm90b3R5cGUsY2M9aWEucHJvY2Vzc0RhdGEsZGM9aWEuZ2VuZXJhdGVQb2ludHMsZWM9aWEuZGVzdHJveSxmYz17YXBwcm94aW1hdGlvbjpcImF2ZXJhZ2VcIixncm91cFBpeGVsV2lkdGg6MixkYXRlVGltZUxhYmVsRm9ybWF0czp7bWlsbGlzZWNvbmQ6W1wiJUEsICViICVlLCAlSDolTTolUy4lTFwiLFxuXCIlQSwgJWIgJWUsICVIOiVNOiVTLiVMXCIsXCItJUg6JU06JVMuJUxcIl0sc2Vjb25kOltcIiVBLCAlYiAlZSwgJUg6JU06JVNcIixcIiVBLCAlYiAlZSwgJUg6JU06JVNcIixcIi0lSDolTTolU1wiXSxtaW51dGU6W1wiJUEsICViICVlLCAlSDolTVwiLFwiJUEsICViICVlLCAlSDolTVwiLFwiLSVIOiVNXCJdLGhvdXI6W1wiJUEsICViICVlLCAlSDolTVwiLFwiJUEsICViICVlLCAlSDolTVwiLFwiLSVIOiVNXCJdLGRheTpbXCIlQSwgJWIgJWUsICVZXCIsXCIlQSwgJWIgJWVcIixcIi0lQSwgJWIgJWUsICVZXCJdLHdlZWs6W1wiV2VlayBmcm9tICVBLCAlYiAlZSwgJVlcIixcIiVBLCAlYiAlZVwiLFwiLSVBLCAlYiAlZSwgJVlcIl0sbW9udGg6W1wiJUIgJVlcIixcIiVCXCIsXCItJUIgJVlcIl0seWVhcjpbXCIlWVwiLFwiJVlcIixcIi0lWVwiXX19LFhiPXtsaW5lOnt9LHNwbGluZTp7fSxhcmVhOnt9LGFyZWFzcGxpbmU6e30sY29sdW1uOnthcHByb3hpbWF0aW9uOlwic3VtXCIsZ3JvdXBQaXhlbFdpZHRoOjEwfSxhcmVhcmFuZ2U6e2FwcHJveGltYXRpb246XCJyYW5nZVwifSxcbmFyZWFzcGxpbmVyYW5nZTp7YXBwcm94aW1hdGlvbjpcInJhbmdlXCJ9LGNvbHVtbnJhbmdlOnthcHByb3hpbWF0aW9uOlwicmFuZ2VcIixncm91cFBpeGVsV2lkdGg6MTB9LGNhbmRsZXN0aWNrOnthcHByb3hpbWF0aW9uOlwib2hsY1wiLGdyb3VwUGl4ZWxXaWR0aDoxMH0sb2hsYzp7YXBwcm94aW1hdGlvbjpcIm9obGNcIixncm91cFBpeGVsV2lkdGg6NX19LFliPVtbXCJtaWxsaXNlY29uZFwiLFsxLDIsNSwxMCwyMCwyNSw1MCwxMDAsMjAwLDUwMF1dLFtcInNlY29uZFwiLFsxLDIsNSwxMCwxNSwzMF1dLFtcIm1pbnV0ZVwiLFsxLDIsNSwxMCwxNSwzMF1dLFtcImhvdXJcIixbMSwyLDMsNCw2LDgsMTJdXSxbXCJkYXlcIixbMV1dLFtcIndlZWtcIixbMV1dLFtcIm1vbnRoXCIsWzEsMyw2XV0sW1wieWVhclwiLG51bGxdXSxVYT17c3VtOmZ1bmN0aW9uKGEpe3ZhciBiPWEubGVuZ3RoLGM7aWYoIWImJmEuaGFzTnVsbHMpYz1udWxsO2Vsc2UgaWYoYilmb3IoYz0wO2ItLTspYys9YVtiXTtyZXR1cm4gY30sYXZlcmFnZTpmdW5jdGlvbihhKXt2YXIgYj1cbmEubGVuZ3RoLGE9VWEuc3VtKGEpO3R5cGVvZiBhPT09XCJudW1iZXJcIiYmYiYmKGEvPWIpO3JldHVybiBhfSxvcGVuOmZ1bmN0aW9uKGEpe3JldHVybiBhLmxlbmd0aD9hWzBdOmEuaGFzTnVsbHM/bnVsbDp0fSxoaWdoOmZ1bmN0aW9uKGEpe3JldHVybiBhLmxlbmd0aD9FYShhKTphLmhhc051bGxzP251bGw6dH0sbG93OmZ1bmN0aW9uKGEpe3JldHVybiBhLmxlbmd0aD9PYShhKTphLmhhc051bGxzP251bGw6dH0sY2xvc2U6ZnVuY3Rpb24oYSl7cmV0dXJuIGEubGVuZ3RoP2FbYS5sZW5ndGgtMV06YS5oYXNOdWxscz9udWxsOnR9LG9obGM6ZnVuY3Rpb24oYSxiLGMsZCl7YT1VYS5vcGVuKGEpO2I9VWEuaGlnaChiKTtjPVVhLmxvdyhjKTtkPVVhLmNsb3NlKGQpO2lmKHR5cGVvZiBhPT09XCJudW1iZXJcInx8dHlwZW9mIGI9PT1cIm51bWJlclwifHx0eXBlb2YgYz09PVwibnVtYmVyXCJ8fHR5cGVvZiBkPT09XCJudW1iZXJcIilyZXR1cm5bYSxiLGMsZF19LHJhbmdlOmZ1bmN0aW9uKGEsYil7YT1cblVhLmxvdyhhKTtiPVVhLmhpZ2goYik7aWYodHlwZW9mIGE9PT1cIm51bWJlclwifHx0eXBlb2YgYj09PVwibnVtYmVyXCIpcmV0dXJuW2EsYl19fTtpYS5ncm91cERhdGE9ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9dGhpcy5kYXRhLGY9dGhpcy5vcHRpb25zLmRhdGEsZz1bXSxoPVtdLGk9W10saj1hLmxlbmd0aCxrLGwsbT0hIWIsbz1bW10sW10sW10sW11dLGQ9dHlwZW9mIGQ9PT1cImZ1bmN0aW9uXCI/ZDpVYVtkXSxwPXRoaXMucG9pbnRBcnJheU1hcCxuPXAmJnAubGVuZ3RoLHEscz0wO2ZvcihxPTA7cTw9ajtxKyspaWYoYVtxXT49Y1swXSlicmVhaztmb3IoO3E8PWo7cSsrKXtmb3IoO2NbMV0hPT10JiZhW3FdPj1jWzFdfHxxPT09ajspaWYoaz1jLnNoaWZ0KCksbD1kLmFwcGx5KDAsbyksbCE9PXQmJihnLnB1c2goayksaC5wdXNoKGwpLGkucHVzaCh7c3RhcnQ6cyxsZW5ndGg6b1swXS5sZW5ndGh9KSkscz1xLG9bMF09W10sb1sxXT1bXSxvWzJdPVtdLG9bM109W10scT09PWopYnJlYWs7XG5pZihxPT09ailicmVhaztpZihwKXtrPXRoaXMuY3JvcFN0YXJ0K3E7az1lJiZlW2tdfHx0aGlzLnBvaW50Q2xhc3MucHJvdG90eXBlLmFwcGx5T3B0aW9ucy5hcHBseSh7c2VyaWVzOnRoaXN9LFtmW2tdXSk7dmFyIHU7Zm9yKGw9MDtsPG47bCsrKWlmKHU9a1twW2xdXSx0eXBlb2YgdT09PVwibnVtYmVyXCIpb1tsXS5wdXNoKHUpO2Vsc2UgaWYodT09PW51bGwpb1tsXS5oYXNOdWxscz0hMH1lbHNlIGlmKGs9bT9iW3FdOm51bGwsdHlwZW9mIGs9PT1cIm51bWJlclwiKW9bMF0ucHVzaChrKTtlbHNlIGlmKGs9PT1udWxsKW9bMF0uaGFzTnVsbHM9ITB9cmV0dXJuW2csaCxpXX07aWEucHJvY2Vzc0RhdGE9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmNoYXJ0LGI9dGhpcy5vcHRpb25zLmRhdGFHcm91cGluZyxjPXRoaXMuYWxsb3dERyE9PSExJiZiJiZxKGIuZW5hYmxlZCxhLm9wdGlvbnMuX3N0b2NrKSxkO3RoaXMuZm9yY2VDcm9wPWM7dGhpcy5ncm91cFBpeGVsV2lkdGg9bnVsbDt0aGlzLmhhc1Byb2Nlc3NlZD1cbiEwO2lmKGNjLmFwcGx5KHRoaXMsYXJndW1lbnRzKSE9PSExJiZjKXt0aGlzLmRlc3Ryb3lHcm91cGVkRGF0YSgpO3ZhciBlPXRoaXMucHJvY2Vzc2VkWERhdGEsZj10aGlzLnByb2Nlc3NlZFlEYXRhLGc9YS5wbG90U2l6ZVgsYT10aGlzLnhBeGlzLGg9YS5vcHRpb25zLm9yZGluYWwsaT10aGlzLmdyb3VwUGl4ZWxXaWR0aD1hLmdldEdyb3VwUGl4ZWxXaWR0aCYmYS5nZXRHcm91cFBpeGVsV2lkdGgoKTtpZihpKXtkPSEwO3RoaXMucG9pbnRzPW51bGw7dmFyIGo9YS5nZXRFeHRyZW1lcygpLGM9ai5taW4saj1qLm1heCxoPWgmJmEuZ2V0R3JvdXBJbnRlcnZhbEZhY3RvcihjLGosdGhpcyl8fDEsZz1pKihqLWMpL2cqaCxpPWEuZ2V0VGltZVRpY2tzKGEubm9ybWFsaXplVGltZVRpY2tJbnRlcnZhbChnLGIudW5pdHN8fFliKSxNYXRoLm1pbihjLGVbMF0pLE1hdGgubWF4KGosZVtlLmxlbmd0aC0xXSksYS5vcHRpb25zLnN0YXJ0T2ZXZWVrLGUsdGhpcy5jbG9zZXN0UG9pbnRSYW5nZSksXG5lPWlhLmdyb3VwRGF0YS5hcHBseSh0aGlzLFtlLGYsaSxiLmFwcHJveGltYXRpb25dKSxmPWVbMF0saD1lWzFdO2lmKGIuc21vb3RoZWQpe2I9Zi5sZW5ndGgtMTtmb3IoZltiXT1NYXRoLm1pbihmW2JdLGopO2ItLSYmYj4wOylmW2JdKz1nLzI7ZlswXT1NYXRoLm1heChmWzBdLGMpfXRoaXMuY3VycmVudERhdGFHcm91cGluZz1pLmluZm87dGhpcy5jbG9zZXN0UG9pbnRSYW5nZT1pLmluZm8udG90YWxSYW5nZTt0aGlzLmdyb3VwTWFwPWVbMl07aWYocyhmWzBdKSYmZlswXTxhLmRhdGFNaW4pe2lmKGEubWluPT09YS5kYXRhTWluKWEubWluPWZbMF07YS5kYXRhTWluPWZbMF19dGhpcy5wcm9jZXNzZWRYRGF0YT1mO3RoaXMucHJvY2Vzc2VkWURhdGE9aH1lbHNlIHRoaXMuY3VycmVudERhdGFHcm91cGluZz10aGlzLmdyb3VwTWFwPW51bGw7dGhpcy5oYXNHcm91cGVkRGF0YT1kfX07aWEuZGVzdHJveUdyb3VwZWREYXRhPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5ncm91cGVkRGF0YTtcbm4oYXx8W10sZnVuY3Rpb24oYixjKXtiJiYoYVtjXT1iLmRlc3Ryb3k/Yi5kZXN0cm95KCk6bnVsbCl9KTt0aGlzLmdyb3VwZWREYXRhPW51bGx9O2lhLmdlbmVyYXRlUG9pbnRzPWZ1bmN0aW9uKCl7ZGMuYXBwbHkodGhpcyk7dGhpcy5kZXN0cm95R3JvdXBlZERhdGEoKTt0aGlzLmdyb3VwZWREYXRhPXRoaXMuaGFzR3JvdXBlZERhdGE/dGhpcy5wb2ludHM6bnVsbH07VShMYi5wcm90b3R5cGUsXCJ0b29sdGlwRm9vdGVySGVhZGVyRm9ybWF0dGVyXCIsZnVuY3Rpb24oYSxiLGMpe3ZhciBkPWIuc2VyaWVzLGU9ZC50b29sdGlwT3B0aW9ucyxmPWQub3B0aW9ucy5kYXRhR3JvdXBpbmcsZz1lLnhEYXRlRm9ybWF0LGgsaT1kLnhBeGlzO3JldHVybiBpJiZpLm9wdGlvbnMudHlwZT09PVwiZGF0ZXRpbWVcIiYmZiYmdWEoYi5rZXkpPyhhPWQuY3VycmVudERhdGFHcm91cGluZyxmPWYuZGF0ZVRpbWVMYWJlbEZvcm1hdHMsYT8oaT1mW2EudW5pdE5hbWVdLGEuY291bnQ9PT0xP2c9aVswXTooZz1cbmlbMV0saD1pWzJdKSk6IWcmJmYmJihnPXRoaXMuZ2V0WERhdGVGb3JtYXQoYixlLGkpKSxnPW1hKGcsYi5rZXkpLGgmJihnKz1tYShoLGIua2V5K2EudG90YWxSYW5nZS0xKSksTGEoZVsoYz9cImZvb3RlclwiOlwiaGVhZGVyXCIpK1wiRm9ybWF0XCJdLHtwb2ludDp4KGIse2tleTpnfSksc2VyaWVzOmR9KSk6YS5jYWxsKHRoaXMsYixjKX0pO2lhLmRlc3Ryb3k9ZnVuY3Rpb24oKXtmb3IodmFyIGE9dGhpcy5ncm91cGVkRGF0YXx8W10sYj1hLmxlbmd0aDtiLS07KWFbYl0mJmFbYl0uZGVzdHJveSgpO2VjLmFwcGx5KHRoaXMpfTtVKGlhLFwic2V0T3B0aW9uc1wiLGZ1bmN0aW9uKGEsYil7dmFyIGM9YS5jYWxsKHRoaXMsYiksZD10aGlzLnR5cGUsZT10aGlzLmNoYXJ0Lm9wdGlvbnMucGxvdE9wdGlvbnMsZj1XW2RdLmRhdGFHcm91cGluZztpZihYYltkXSlmfHwoZj1DKGZjLFhiW2RdKSksYy5kYXRhR3JvdXBpbmc9QyhmLGUuc2VyaWVzJiZlLnNlcmllcy5kYXRhR3JvdXBpbmcsZVtkXS5kYXRhR3JvdXBpbmcsXG5iLmRhdGFHcm91cGluZyk7aWYodGhpcy5jaGFydC5vcHRpb25zLl9zdG9jayl0aGlzLnJlcXVpcmVTb3J0aW5nPSEwO3JldHVybiBjfSk7VShJLnByb3RvdHlwZSxcInNldFNjYWxlXCIsZnVuY3Rpb24oYSl7YS5jYWxsKHRoaXMpO24odGhpcy5zZXJpZXMsZnVuY3Rpb24oYSl7YS5oYXNQcm9jZXNzZWQ9ITF9KX0pO0kucHJvdG90eXBlLmdldEdyb3VwUGl4ZWxXaWR0aD1mdW5jdGlvbigpe3ZhciBhPXRoaXMuc2VyaWVzLGI9YS5sZW5ndGgsYyxkPTAsZT0hMSxmO2ZvcihjPWI7Yy0tOykoZj1hW2NdLm9wdGlvbnMuZGF0YUdyb3VwaW5nKSYmKGQ9dihkLGYuZ3JvdXBQaXhlbFdpZHRoKSk7Zm9yKGM9YjtjLS07KWlmKChmPWFbY10ub3B0aW9ucy5kYXRhR3JvdXBpbmcpJiZhW2NdLmhhc1Byb2Nlc3NlZClpZihiPShhW2NdLnByb2Nlc3NlZFhEYXRhfHxhW2NdLmRhdGEpLmxlbmd0aCxhW2NdLmdyb3VwUGl4ZWxXaWR0aHx8Yj50aGlzLmNoYXJ0LnBsb3RTaXplWC9kfHxiJiZmLmZvcmNlZCllPVxuITA7cmV0dXJuIGU/ZDowfTtJLnByb3RvdHlwZS5zZXREYXRhR3JvdXBpbmc9ZnVuY3Rpb24oYSxiKXt2YXIgYyxiPXEoYiwhMCk7YXx8KGE9e2ZvcmNlZDohMSx1bml0czpudWxsfSk7aWYodGhpcyBpbnN0YW5jZW9mIEkpZm9yKGM9dGhpcy5zZXJpZXMubGVuZ3RoO2MtLTspdGhpcy5zZXJpZXNbY10udXBkYXRlKHtkYXRhR3JvdXBpbmc6YX0sITEpO2Vsc2Ugbih0aGlzLmNoYXJ0Lm9wdGlvbnMuc2VyaWVzLGZ1bmN0aW9uKGIpe2IuZGF0YUdyb3VwaW5nPWF9LCExKTtiJiZ0aGlzLmNoYXJ0LnJlZHJhdygpfTtXLm9obGM9QyhXLmNvbHVtbix7bGluZVdpZHRoOjEsdG9vbHRpcDp7cG9pbnRGb3JtYXQ6JzxzcGFuIHN0eWxlPVwiY29sb3I6e3BvaW50LmNvbG9yfVwiPlxcdTI1Y2Y8L3NwYW4+IDxiPiB7c2VyaWVzLm5hbWV9PC9iPjxici8+T3Blbjoge3BvaW50Lm9wZW59PGJyLz5IaWdoOiB7cG9pbnQuaGlnaH08YnIvPkxvdzoge3BvaW50Lmxvd308YnIvPkNsb3NlOiB7cG9pbnQuY2xvc2V9PGJyLz4nfSxcbnN0YXRlczp7aG92ZXI6e2xpbmVXaWR0aDozfX0sdGhyZXNob2xkOm51bGx9KTtjYT1sYShLLmNvbHVtbix7dHlwZTpcIm9obGNcIixwb2ludEFycmF5TWFwOltcIm9wZW5cIixcImhpZ2hcIixcImxvd1wiLFwiY2xvc2VcIl0sdG9ZRGF0YTpmdW5jdGlvbihhKXtyZXR1cm5bYS5vcGVuLGEuaGlnaCxhLmxvdyxhLmNsb3NlXX0scG9pbnRWYWxLZXk6XCJoaWdoXCIscG9pbnRBdHRyVG9PcHRpb25zOntzdHJva2U6XCJjb2xvclwiLFwic3Ryb2tlLXdpZHRoXCI6XCJsaW5lV2lkdGhcIn0sdXBDb2xvclByb3A6XCJzdHJva2VcIixnZXRBdHRyaWJzOmZ1bmN0aW9uKCl7Sy5jb2x1bW4ucHJvdG90eXBlLmdldEF0dHJpYnMuYXBwbHkodGhpcyxhcmd1bWVudHMpO3ZhciBhPXRoaXMub3B0aW9ucyxiPWEuc3RhdGVzLGE9YS51cENvbG9yfHx0aGlzLmNvbG9yLGM9Qyh0aGlzLnBvaW50QXR0ciksZD10aGlzLnVwQ29sb3JQcm9wO2NbXCJcIl1bZF09YTtjLmhvdmVyW2RdPWIuaG92ZXIudXBDb2xvcnx8YTtjLnNlbGVjdFtkXT1iLnNlbGVjdC51cENvbG9yfHxcbmE7bih0aGlzLnBvaW50cyxmdW5jdGlvbihhKXtpZihhLm9wZW48YS5jbG9zZSYmIWEub3B0aW9ucy5jb2xvcilhLnBvaW50QXR0cj1jfSl9LHRyYW5zbGF0ZTpmdW5jdGlvbigpe3ZhciBhPXRoaXMueUF4aXM7Sy5jb2x1bW4ucHJvdG90eXBlLnRyYW5zbGF0ZS5hcHBseSh0aGlzKTtuKHRoaXMucG9pbnRzLGZ1bmN0aW9uKGIpe2lmKGIub3BlbiE9PW51bGwpYi5wbG90T3Blbj1hLnRyYW5zbGF0ZShiLm9wZW4sMCwxLDAsMSk7aWYoYi5jbG9zZSE9PW51bGwpYi5wbG90Q2xvc2U9YS50cmFuc2xhdGUoYi5jbG9zZSwwLDEsMCwxKX0pfSxkcmF3UG9pbnRzOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEuY2hhcnQsYyxkLGUsZixnLGgsaSxqO24oYS5wb2ludHMsZnVuY3Rpb24oayl7aWYoay5wbG90WSE9PXQpaT1rLmdyYXBoaWMsYz1rLnBvaW50QXR0cltrLnNlbGVjdGVkP1wic2VsZWN0ZWRcIjpcIlwiXXx8YS5wb2ludEF0dHJbXCJcIl0sZj1jW1wic3Ryb2tlLXdpZHRoXCJdJTIvMixqPXkoay5wbG90WCktXG5mLGc9eShrLnNoYXBlQXJncy53aWR0aC8yKSxoPVtcIk1cIixqLHkoay55Qm90dG9tKSxcIkxcIixqLHkoay5wbG90WSldLGsub3BlbiE9PW51bGwmJihkPXkoay5wbG90T3BlbikrZixoLnB1c2goXCJNXCIsaixkLFwiTFwiLGotZyxkKSksay5jbG9zZSE9PW51bGwmJihlPXkoay5wbG90Q2xvc2UpK2YsaC5wdXNoKFwiTVwiLGosZSxcIkxcIixqK2csZSkpLGk/aS5hdHRyKGMpLmFuaW1hdGUoe2Q6aH0pOmsuZ3JhcGhpYz1iLnJlbmRlcmVyLnBhdGgoaCkuYXR0cihjKS5hZGQoYS5ncm91cCl9KX0sYW5pbWF0ZTpudWxsfSk7Sy5vaGxjPWNhO1cuY2FuZGxlc3RpY2s9QyhXLmNvbHVtbix7bGluZUNvbG9yOlwiYmxhY2tcIixsaW5lV2lkdGg6MSxzdGF0ZXM6e2hvdmVyOntsaW5lV2lkdGg6Mn19LHRvb2x0aXA6Vy5vaGxjLnRvb2x0aXAsdGhyZXNob2xkOm51bGwsdXBDb2xvcjpcIndoaXRlXCJ9KTtjYT1sYShjYSx7dHlwZTpcImNhbmRsZXN0aWNrXCIscG9pbnRBdHRyVG9PcHRpb25zOntmaWxsOlwiY29sb3JcIixzdHJva2U6XCJsaW5lQ29sb3JcIixcblwic3Ryb2tlLXdpZHRoXCI6XCJsaW5lV2lkdGhcIn0sdXBDb2xvclByb3A6XCJmaWxsXCIsZ2V0QXR0cmliczpmdW5jdGlvbigpe0sub2hsYy5wcm90b3R5cGUuZ2V0QXR0cmlicy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dmFyIGE9dGhpcy5vcHRpb25zLGI9YS5zdGF0ZXMsYz1hLnVwTGluZUNvbG9yfHxhLmxpbmVDb2xvcixkPWIuaG92ZXIudXBMaW5lQ29sb3J8fGMsZT1iLnNlbGVjdC51cExpbmVDb2xvcnx8YztuKHRoaXMucG9pbnRzLGZ1bmN0aW9uKGEpe2lmKGEub3BlbjxhLmNsb3NlKXtpZihhLmxpbmVDb2xvcilhLnBvaW50QXR0cj1DKGEucG9pbnRBdHRyKSxjPWEubGluZUNvbG9yO2EucG9pbnRBdHRyW1wiXCJdLnN0cm9rZT1jO2EucG9pbnRBdHRyLmhvdmVyLnN0cm9rZT1kO2EucG9pbnRBdHRyLnNlbGVjdC5zdHJva2U9ZX19KX0sZHJhd1BvaW50czpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLmNoYXJ0LGMsZD1hLnBvaW50QXR0cltcIlwiXSxlLGYsZyxoLGksaixrLGwsbSxvLHA7bihhLnBvaW50cyxcbmZ1bmN0aW9uKG4pe209bi5ncmFwaGljO2lmKG4ucGxvdFkhPT10KWM9bi5wb2ludEF0dHJbbi5zZWxlY3RlZD9cInNlbGVjdGVkXCI6XCJcIl18fGQsaz1jW1wic3Ryb2tlLXdpZHRoXCJdJTIvMixsPXkobi5wbG90WCktayxlPW4ucGxvdE9wZW4sZj1uLnBsb3RDbG9zZSxnPVkubWluKGUsZiksaD1ZLm1heChlLGYpLHA9eShuLnNoYXBlQXJncy53aWR0aC8yKSxpPXkoZykhPT15KG4ucGxvdFkpLGo9aCE9PW4ueUJvdHRvbSxnPXkoZykrayxoPXkoaCkrayxvPVtcIk1cIixsLXAsaCxcIkxcIixsLXAsZyxcIkxcIixsK3AsZyxcIkxcIixsK3AsaCxcIlpcIixcIk1cIixsLGcsXCJMXCIsbCxpP3kobi5wbG90WSk6ZyxcIk1cIixsLGgsXCJMXCIsbCxqP3kobi55Qm90dG9tKTpoXSxtP20uYXR0cihjKS5hbmltYXRlKHtkOm99KTpuLmdyYXBoaWM9Yi5yZW5kZXJlci5wYXRoKG8pLmF0dHIoYykuYWRkKGEuZ3JvdXApLnNoYWRvdyhhLm9wdGlvbnMuc2hhZG93KX0pfX0pO0suY2FuZGxlc3RpY2s9Y2E7dmFyIHdiPXlhLnByb3RvdHlwZS5zeW1ib2xzO1xuVy5mbGFncz1DKFcuY29sdW1uLHtmaWxsQ29sb3I6XCJ3aGl0ZVwiLGxpbmVXaWR0aDoxLHBvaW50UmFuZ2U6MCxzaGFwZTpcImZsYWdcIixzdGFja0Rpc3RhbmNlOjEyLHN0YXRlczp7aG92ZXI6e2xpbmVDb2xvcjpcImJsYWNrXCIsZmlsbENvbG9yOlwiI0ZDRkZDNVwifX0sc3R5bGU6e2ZvbnRTaXplOlwiMTFweFwiLGZvbnRXZWlnaHQ6XCJib2xkXCIsdGV4dEFsaWduOlwiY2VudGVyXCJ9LHRvb2x0aXA6e3BvaW50Rm9ybWF0Olwie3BvaW50LnRleHR9PGJyLz5cIn0sdGhyZXNob2xkOm51bGwseTotMzB9KTtLLmZsYWdzPWxhKEsuY29sdW1uLHt0eXBlOlwiZmxhZ3NcIixzb3J0ZWQ6ITEsbm9TaGFyZWRUb29sdGlwOiEwLGFsbG93REc6ITEsdGFrZU9yZGluYWxQb3NpdGlvbjohMSx0cmFja2VyR3JvdXBzOltcIm1hcmtlckdyb3VwXCJdLGZvcmNlQ3JvcDohMCxpbml0OlEucHJvdG90eXBlLmluaXQscG9pbnRBdHRyVG9PcHRpb25zOntmaWxsOlwiZmlsbENvbG9yXCIsc3Ryb2tlOlwiY29sb3JcIixcInN0cm9rZS13aWR0aFwiOlwibGluZVdpZHRoXCIsXG5yOlwicmFkaXVzXCJ9LHRyYW5zbGF0ZTpmdW5jdGlvbigpe0suY29sdW1uLnByb3RvdHlwZS50cmFuc2xhdGUuYXBwbHkodGhpcyk7dmFyIGE9dGhpcy5vcHRpb25zLGI9dGhpcy5jaGFydCxjPXRoaXMucG9pbnRzLGQ9Yy5sZW5ndGgtMSxlLGYsZz1hLm9uU2VyaWVzO2U9ZyYmYi5nZXQoZyk7dmFyIGE9YS5vbktleXx8XCJ5XCIsZz1lJiZlLm9wdGlvbnMuc3RlcCxoPWUmJmUucG9pbnRzLGk9aCYmaC5sZW5ndGgsaj10aGlzLnhBeGlzLGs9ai5nZXRFeHRyZW1lcygpLGwsbSxvO2lmKGUmJmUudmlzaWJsZSYmaSl7ZT1lLmN1cnJlbnREYXRhR3JvdXBpbmc7bT1oW2ktMV0ueCsoZT9lLnRvdGFsUmFuZ2U6MCk7Yy5zb3J0KGZ1bmN0aW9uKGEsYil7cmV0dXJuIGEueC1iLnh9KTtmb3IoYT1cInBsb3RcIithWzBdLnRvVXBwZXJDYXNlKCkrYS5zdWJzdHIoMSk7aS0tJiZjW2RdOylpZihlPWNbZF0sbD1oW2ldLGwueDw9ZS54JiZsW2FdIT09dm9pZCAwKXtpZihlLng8PW0pZS5wbG90WT1sW2FdLGwueDxcbmUueCYmIWcmJihvPWhbaSsxXSkmJm9bYV0hPT10JiYoZS5wbG90WSs9KGUueC1sLngpLyhvLngtbC54KSoob1thXS1sW2FdKSk7ZC0tO2krKztpZihkPDApYnJlYWt9fW4oYyxmdW5jdGlvbihhLGQpe3ZhciBlO2lmKGEucGxvdFk9PT10KWEueD49ay5taW4mJmEueDw9ay5tYXg/YS5wbG90WT1iLmNoYXJ0SGVpZ2h0LWouYm90dG9tLShqLm9wcG9zaXRlP2ouaGVpZ2h0OjApK2oub2Zmc2V0LWIucGxvdFRvcDphLnNoYXBlQXJncz17fTtpZigoZj1jW2QtMV0pJiZmLnBsb3RYPT09YS5wbG90WCl7aWYoZi5zdGFja0luZGV4PT09dClmLnN0YWNrSW5kZXg9MDtlPWYuc3RhY2tJbmRleCsxfWEuc3RhY2tJbmRleD1lfSl9LGRyYXdQb2ludHM6ZnVuY3Rpb24oKXt2YXIgYSxiPXRoaXMucG9pbnRBdHRyW1wiXCJdLGM9dGhpcy5wb2ludHMsZD10aGlzLmNoYXJ0LGU9ZC5yZW5kZXJlcixmLGcsaD10aGlzLm9wdGlvbnMsaT1oLnksaixrLGwsbSxvLG4scj10aGlzLnlBeGlzO2ZvcihrPWMubGVuZ3RoO2stLTspaWYobD1cbmNba10sYT1sLnBsb3RYPnRoaXMueEF4aXMubGVuLGY9bC5wbG90WCxmPjAmJihmLT1xKGwubGluZVdpZHRoLGgubGluZVdpZHRoKSUyKSxtPWwuc3RhY2tJbmRleCxqPWwub3B0aW9ucy5zaGFwZXx8aC5zaGFwZSxnPWwucGxvdFksZyE9PXQmJihnPWwucGxvdFkraS0obSE9PXQmJm0qaC5zdGFja0Rpc3RhbmNlKSksbz1tP3Q6bC5wbG90WCxuPW0/dDpsLnBsb3RZLG09bC5ncmFwaGljLGchPT10JiZmPj0wJiYhYSlhPWwucG9pbnRBdHRyW2wuc2VsZWN0ZWQ/XCJzZWxlY3RcIjpcIlwiXXx8YixtP20uYXR0cih7eDpmLHk6ZyxyOmEucixhbmNob3JYOm8sYW5jaG9yWTpufSk6bC5ncmFwaGljPWUubGFiZWwobC5vcHRpb25zLnRpdGxlfHxoLnRpdGxlfHxcIkFcIixmLGcsaixvLG4saC51c2VIVE1MKS5jc3MoQyhoLnN0eWxlLGwuc3R5bGUpKS5hdHRyKGEpLmF0dHIoe2FsaWduOmo9PT1cImZsYWdcIj9cImxlZnRcIjpcImNlbnRlclwiLHdpZHRoOmgud2lkdGgsaGVpZ2h0OmguaGVpZ2h0fSkuYWRkKHRoaXMubWFya2VyR3JvdXApLnNoYWRvdyhoLnNoYWRvdyksXG5sLnRvb2x0aXBQb3M9ZC5pbnZlcnRlZD9bci5sZW4rci5wb3MtZC5wbG90TGVmdC1nLHRoaXMueEF4aXMubGVuLWZdOltmLGddO2Vsc2UgaWYobSlsLmdyYXBoaWM9bS5kZXN0cm95KCl9LGRyYXdUcmFja2VyOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5wb2ludHM7bmIuZHJhd1RyYWNrZXJQb2ludC5hcHBseSh0aGlzKTtuKGEsZnVuY3Rpb24oYil7dmFyIGM9Yi5ncmFwaGljO2MmJkQoYy5lbGVtZW50LFwibW91c2VvdmVyXCIsZnVuY3Rpb24oKXtpZihiLnN0YWNrSW5kZXg+MCYmIWIucmFpc2VkKWIuX3k9Yy55LGMuYXR0cih7eTpiLl95LTh9KSxiLnJhaXNlZD0hMDtuKGEsZnVuY3Rpb24oYSl7aWYoYSE9PWImJmEucmFpc2VkJiZhLmdyYXBoaWMpYS5ncmFwaGljLmF0dHIoe3k6YS5feX0pLGEucmFpc2VkPSExfSl9KX0pfSxhbmltYXRlOnJhLGJ1aWxkS0RUcmVlOnJhLHNldENsaXA6cmF9KTt3Yi5mbGFnPWZ1bmN0aW9uKGEsYixjLGQsZSl7cmV0dXJuW1wiTVwiLGUmJmUuYW5jaG9yWHx8XG5hLGUmJmUuYW5jaG9yWXx8YixcIkxcIixhLGIrZCxhLGIsYStjLGIsYStjLGIrZCxhLGIrZCxcIlpcIl19O24oW1wiY2lyY2xlXCIsXCJzcXVhcmVcIl0sZnVuY3Rpb24oYSl7d2JbYStcInBpblwiXT1mdW5jdGlvbihiLGMsZCxlLGYpe3ZhciBnPWYmJmYuYW5jaG9yWCxmPWYmJmYuYW5jaG9yWTthPT09XCJjaXJjbGVcIiYmZT5kJiYoYi09eSgoZS1kKS8yKSxkPWUpO2I9d2JbYV0oYixjLGQsZSk7ZyYmZiYmYi5wdXNoKFwiTVwiLGcsYz5mP2M6YytlLFwiTFwiLGcsZik7cmV0dXJuIGJ9fSk7WWE9PT16LlZNTFJlbmRlcmVyJiZuKFtcImZsYWdcIixcImNpcmNsZXBpblwiLFwic3F1YXJlcGluXCJdLGZ1bmN0aW9uKGEpe21iLnByb3RvdHlwZS5zeW1ib2xzW2FdPXdiW2FdfSk7dmFyIGNhPVtdLmNvbmNhdChZYikseGI9ZnVuY3Rpb24oYSl7dmFyIGI9U2EoYXJndW1lbnRzLGZ1bmN0aW9uKGEpe3JldHVybiB0eXBlb2YgYT09PVwibnVtYmVyXCJ9KTtpZihiLmxlbmd0aClyZXR1cm4gTWF0aFthXS5hcHBseSgwLGIpfTtjYVs0XT1cbltcImRheVwiLFsxLDIsMyw0XV07Y2FbNV09W1wid2Vla1wiLFsxLDIsM11dO3goTix7bmF2aWdhdG9yOntoYW5kbGVzOntiYWNrZ3JvdW5kQ29sb3I6XCIjZWJlN2U4XCIsYm9yZGVyQ29sb3I6XCIjYjJiMWI2XCJ9LGhlaWdodDo0MCxtYXJnaW46MjUsbWFza0ZpbGw6XCJyZ2JhKDEyOCwxNzksMjM2LDAuMylcIixtYXNrSW5zaWRlOiEwLG91dGxpbmVDb2xvcjpcIiNiMmIxYjZcIixvdXRsaW5lV2lkdGg6MSxzZXJpZXM6e3R5cGU6Sy5hcmVhc3BsaW5lPT09dD9cImxpbmVcIjpcImFyZWFzcGxpbmVcIixjb2xvcjpcIiM0NTcyQTdcIixjb21wYXJlOm51bGwsZmlsbE9wYWNpdHk6MC4wNSxkYXRhR3JvdXBpbmc6e2FwcHJveGltYXRpb246XCJhdmVyYWdlXCIsZW5hYmxlZDohMCxncm91cFBpeGVsV2lkdGg6MixzbW9vdGhlZDohMCx1bml0czpjYX0sZGF0YUxhYmVsczp7ZW5hYmxlZDohMSx6SW5kZXg6Mn0saWQ6XCJoaWdoY2hhcnRzLW5hdmlnYXRvci1zZXJpZXNcIixsaW5lQ29sb3I6bnVsbCxsaW5lV2lkdGg6MSxtYXJrZXI6e2VuYWJsZWQ6ITF9LFxucG9pbnRSYW5nZTowLHNoYWRvdzohMSx0aHJlc2hvbGQ6bnVsbH0seEF4aXM6e3RpY2tXaWR0aDowLGxpbmVXaWR0aDowLGdyaWRMaW5lQ29sb3I6XCIjRUVFXCIsZ3JpZExpbmVXaWR0aDoxLHRpY2tQaXhlbEludGVydmFsOjIwMCxsYWJlbHM6e2FsaWduOlwibGVmdFwiLHN0eWxlOntjb2xvcjpcIiM4ODhcIn0seDozLHk6LTR9LGNyb3NzaGFpcjohMX0seUF4aXM6e2dyaWRMaW5lV2lkdGg6MCxzdGFydE9uVGljazohMSxlbmRPblRpY2s6ITEsbWluUGFkZGluZzowLjEsbWF4UGFkZGluZzowLjEsbGFiZWxzOntlbmFibGVkOiExfSxjcm9zc2hhaXI6ITEsdGl0bGU6e3RleHQ6bnVsbH0sdGlja1dpZHRoOjB9fSxzY3JvbGxiYXI6e2hlaWdodDprYj8yMDoxNCxiYXJCYWNrZ3JvdW5kQ29sb3I6XCIjYmZjOGQxXCIsYmFyQm9yZGVyUmFkaXVzOjAsYmFyQm9yZGVyV2lkdGg6MSxiYXJCb3JkZXJDb2xvcjpcIiNiZmM4ZDFcIixidXR0b25BcnJvd0NvbG9yOlwiIzY2NlwiLGJ1dHRvbkJhY2tncm91bmRDb2xvcjpcIiNlYmU3ZThcIixcbmJ1dHRvbkJvcmRlckNvbG9yOlwiI2JiYlwiLGJ1dHRvbkJvcmRlclJhZGl1czowLGJ1dHRvbkJvcmRlcldpZHRoOjEsbWluV2lkdGg6NixyaWZsZUNvbG9yOlwiIzY2NlwiLHRyYWNrQmFja2dyb3VuZENvbG9yOlwiI2VlZWVlZVwiLHRyYWNrQm9yZGVyQ29sb3I6XCIjZWVlZWVlXCIsdHJhY2tCb3JkZXJXaWR0aDoxLGxpdmVSZWRyYXc6amEmJiFrYn19KTtIYi5wcm90b3R5cGU9e2RyYXdIYW5kbGU6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmNoYXJ0LGQ9Yy5yZW5kZXJlcixlPXRoaXMuZWxlbWVudHNUb0Rlc3Ryb3ksZj10aGlzLmhhbmRsZXMsZz10aGlzLm5hdmlnYXRvck9wdGlvbnMuaGFuZGxlcyxnPXtmaWxsOmcuYmFja2dyb3VuZENvbG9yLHN0cm9rZTpnLmJvcmRlckNvbG9yLFwic3Ryb2tlLXdpZHRoXCI6MX0saDt0aGlzLnJlbmRlcmVkfHwoZltiXT1kLmcoXCJuYXZpZ2F0b3ItaGFuZGxlLVwiK1tcImxlZnRcIixcInJpZ2h0XCJdW2JdKS5jc3Moe2N1cnNvcjpcImV3LXJlc2l6ZVwifSkuYXR0cih7ekluZGV4OjEwLVxuYn0pLmFkZCgpLGg9ZC5yZWN0KC00LjUsMCw5LDE2LDAsMSkuYXR0cihnKS5hZGQoZltiXSksZS5wdXNoKGgpLGg9ZC5wYXRoKFtcIk1cIiwtMS41LDQsXCJMXCIsLTEuNSwxMixcIk1cIiwwLjUsNCxcIkxcIiwwLjUsMTJdKS5hdHRyKGcpLmFkZChmW2JdKSxlLnB1c2goaCkpO2ZbYl1bYy5pc1Jlc2l6aW5nP1wiYW5pbWF0ZVwiOlwiYXR0clwiXSh7dHJhbnNsYXRlWDp0aGlzLnNjcm9sbGVyTGVmdCt0aGlzLnNjcm9sbGJhckhlaWdodCtwYXJzZUludChhLDEwKSx0cmFuc2xhdGVZOnRoaXMudG9wK3RoaXMuaGVpZ2h0LzItOH0pfSxkcmF3U2Nyb2xsYmFyQnV0dG9uOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY2hhcnQucmVuZGVyZXIsYz10aGlzLmVsZW1lbnRzVG9EZXN0cm95LGQ9dGhpcy5zY3JvbGxiYXJCdXR0b25zLGU9dGhpcy5zY3JvbGxiYXJIZWlnaHQsZj10aGlzLnNjcm9sbGJhck9wdGlvbnMsZzt0aGlzLnJlbmRlcmVkfHwoZFthXT1iLmcoKS5hZGQodGhpcy5zY3JvbGxiYXJHcm91cCksZz1iLnJlY3QoLTAuNSxcbi0wLjUsZSsxLGUrMSxmLmJ1dHRvbkJvcmRlclJhZGl1cyxmLmJ1dHRvbkJvcmRlcldpZHRoKS5hdHRyKHtzdHJva2U6Zi5idXR0b25Cb3JkZXJDb2xvcixcInN0cm9rZS13aWR0aFwiOmYuYnV0dG9uQm9yZGVyV2lkdGgsZmlsbDpmLmJ1dHRvbkJhY2tncm91bmRDb2xvcn0pLmFkZChkW2FdKSxjLnB1c2goZyksZz1iLnBhdGgoW1wiTVwiLGUvMisoYT8tMToxKSxlLzItMyxcIkxcIixlLzIrKGE/LTE6MSksZS8yKzMsZS8yKyhhPzI6LTIpLGUvMl0pLmF0dHIoe2ZpbGw6Zi5idXR0b25BcnJvd0NvbG9yfSkuYWRkKGRbYV0pLGMucHVzaChnKSk7YSYmZFthXS5hdHRyKHt0cmFuc2xhdGVYOnRoaXMuc2Nyb2xsZXJXaWR0aC1lfSl9LHJlbmRlcjpmdW5jdGlvbihhLGIsYyxkKXt2YXIgZT10aGlzLmNoYXJ0LGY9ZS5yZW5kZXJlcixnLGgsaSxqLGs9dGhpcy5zY3JvbGxiYXJHcm91cCxsPXRoaXMubmF2aWdhdG9yR3JvdXAsbT10aGlzLnNjcm9sbGJhcixsPXRoaXMueEF4aXMsbz10aGlzLnNjcm9sbGJhclRyYWNrLFxubj10aGlzLnNjcm9sbGJhckhlaWdodCxyPXRoaXMuc2Nyb2xsYmFyRW5hYmxlZCxBPXRoaXMubmF2aWdhdG9yT3B0aW9ucyx0PXRoaXMuc2Nyb2xsYmFyT3B0aW9ucyx1PXQubWluV2lkdGgsdz10aGlzLmhlaWdodCx4PXRoaXMudG9wLHo9dGhpcy5uYXZpZ2F0b3JFbmFibGVkLEM9QS5vdXRsaW5lV2lkdGgsQj1DLzIsRD0wLEc9dGhpcy5vdXRsaW5lSGVpZ2h0LEk9dC5iYXJCb3JkZXJSYWRpdXMsSD10LmJhckJvcmRlcldpZHRoLEY9eCtCLEo7aWYocyhhKSYmIWlzTmFOKGEpJiZzKGIpJiYhKGlzTmFOKGIpfHx0aGlzLmhhc0RyYWdnZWQmJiFzKGMpKSl7dGhpcy5uYXZpZ2F0b3JMZWZ0PWc9cShsLmxlZnQsZS5wbG90TGVmdCtuKTt0aGlzLm5hdmlnYXRvcldpZHRoPWg9cShsLmxlbixlLnBsb3RXaWR0aC0yKm4pO3RoaXMuc2Nyb2xsZXJMZWZ0PWk9Zy1uO3RoaXMuc2Nyb2xsZXJXaWR0aD1qPWo9aCsyKm47bC5nZXRFeHRyZW1lcyYmKEo9dGhpcy5nZXRVbmlvbkV4dHJlbWVzKCEwKSkmJlxuKEouZGF0YU1pbiE9PWwubWlufHxKLmRhdGFNYXghPT1sLm1heCkmJmwuc2V0RXh0cmVtZXMoSi5kYXRhTWluLEouZGF0YU1heCwhMCwhMSk7Yz1xKGMsbC50cmFuc2xhdGUoYSkpO2Q9cShkLGwudHJhbnNsYXRlKGIpKTtpZihpc05hTihjKXx8UyhjKT09PUluZmluaXR5KWM9MCxkPWo7aWYoIShsLnRyYW5zbGF0ZShkLCEwKS1sLnRyYW5zbGF0ZShjLCEwKTxlLnhBeGlzWzBdLm1pblJhbmdlKSl7dGhpcy56b29tZWRNYXg9RSh2KGMsZCwwKSxoKTt0aGlzLnpvb21lZE1pbj1FKHYodGhpcy5maXhlZFdpZHRoP3RoaXMuem9vbWVkTWF4LXRoaXMuZml4ZWRXaWR0aDpFKGMsZCksMCksaCk7dGhpcy5yYW5nZT10aGlzLnpvb21lZE1heC10aGlzLnpvb21lZE1pbjtjPXkodGhpcy56b29tZWRNYXgpO2I9eSh0aGlzLnpvb21lZE1pbik7YT1jLWI7aWYoIXRoaXMucmVuZGVyZWQpe2lmKHopdGhpcy5uYXZpZ2F0b3JHcm91cD1sPWYuZyhcIm5hdmlnYXRvclwiKS5hdHRyKHt6SW5kZXg6M30pLmFkZCgpLFxudGhpcy5sZWZ0U2hhZGU9Zi5yZWN0KCkuYXR0cih7ZmlsbDpBLm1hc2tGaWxsfSkuYWRkKGwpLEEubWFza0luc2lkZT90aGlzLmxlZnRTaGFkZS5jc3Moe2N1cnNvcjpcImV3LXJlc2l6ZVwifSk6dGhpcy5yaWdodFNoYWRlPWYucmVjdCgpLmF0dHIoe2ZpbGw6QS5tYXNrRmlsbH0pLmFkZChsKSx0aGlzLm91dGxpbmU9Zi5wYXRoKCkuYXR0cih7XCJzdHJva2Utd2lkdGhcIjpDLHN0cm9rZTpBLm91dGxpbmVDb2xvcn0pLmFkZChsKTtpZihyKXRoaXMuc2Nyb2xsYmFyR3JvdXA9az1mLmcoXCJzY3JvbGxiYXJcIikuYWRkKCksbT10LnRyYWNrQm9yZGVyV2lkdGgsdGhpcy5zY3JvbGxiYXJUcmFjaz1vPWYucmVjdCgpLmF0dHIoe3g6MCx5Oi1tJTIvMixmaWxsOnQudHJhY2tCYWNrZ3JvdW5kQ29sb3Isc3Ryb2tlOnQudHJhY2tCb3JkZXJDb2xvcixcInN0cm9rZS13aWR0aFwiOm0scjp0LnRyYWNrQm9yZGVyUmFkaXVzfHwwLGhlaWdodDpufSkuYWRkKGspLHRoaXMuc2Nyb2xsYmFyPW09Zi5yZWN0KCkuYXR0cih7eTotSCVcbjIvMixoZWlnaHQ6bixmaWxsOnQuYmFyQmFja2dyb3VuZENvbG9yLHN0cm9rZTp0LmJhckJvcmRlckNvbG9yLFwic3Ryb2tlLXdpZHRoXCI6SCxyOkl9KS5hZGQoayksdGhpcy5zY3JvbGxiYXJSaWZsZXM9Zi5wYXRoKCkuYXR0cih7c3Ryb2tlOnQucmlmbGVDb2xvcixcInN0cm9rZS13aWR0aFwiOjF9KS5hZGQoayl9ZT1lLmlzUmVzaXppbmc/XCJhbmltYXRlXCI6XCJhdHRyXCI7aWYoeil7dGhpcy5sZWZ0U2hhZGVbZV0oQS5tYXNrSW5zaWRlP3t4OmcrYix5Ongsd2lkdGg6Yy1iLGhlaWdodDp3fTp7eDpnLHk6eCx3aWR0aDpiLGhlaWdodDp3fSk7aWYodGhpcy5yaWdodFNoYWRlKXRoaXMucmlnaHRTaGFkZVtlXSh7eDpnK2MseTp4LHdpZHRoOmgtYyxoZWlnaHQ6d30pO3RoaXMub3V0bGluZVtlXSh7ZDpbXCJNXCIsaSxGLFwiTFwiLGcrYi1CLEYsZytiLUIsRitHLFwiTFwiLGcrYy1CLEYrRyxcIkxcIixnK2MtQixGLGkraixGXS5jb25jYXQoQS5tYXNrSW5zaWRlP1tcIk1cIixnK2IrQixGLFwiTFwiLGcrYy1CLEZdOlxuW10pfSk7dGhpcy5kcmF3SGFuZGxlKGIrQiwwKTt0aGlzLmRyYXdIYW5kbGUoYytCLDEpfWlmKHImJmspdGhpcy5kcmF3U2Nyb2xsYmFyQnV0dG9uKDApLHRoaXMuZHJhd1Njcm9sbGJhckJ1dHRvbigxKSxrW2VdKHt0cmFuc2xhdGVYOmksdHJhbnNsYXRlWTp5KEYrdyl9KSxvW2VdKHt3aWR0aDpqfSksZz1uK2IsaD1hLUgsaDx1JiYoRD0odS1oKS8yLGg9dSxnLT1EKSx0aGlzLnNjcm9sbGJhclBhZD1ELG1bZV0oe3g6VihnKStIJTIvMix3aWR0aDpofSksdT1uK2IrYS8yLTAuNSx0aGlzLnNjcm9sbGJhclJpZmxlcy5hdHRyKHt2aXNpYmlsaXR5OmE+MTI/XCJ2aXNpYmxlXCI6XCJoaWRkZW5cIn0pW2VdKHtkOltcIk1cIix1LTMsbi80LFwiTFwiLHUtMywyKm4vMyxcIk1cIix1LG4vNCxcIkxcIix1LDIqbi8zLFwiTVwiLHUrMyxuLzQsXCJMXCIsdSszLDIqbi8zXX0pO3RoaXMuc2Nyb2xsYmFyUGFkPUQ7dGhpcy5yZW5kZXJlZD0hMH19fSxhZGRFdmVudHM6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmNoYXJ0LmNvbnRhaW5lcixcbmI9dGhpcy5tb3VzZURvd25IYW5kbGVyLGM9dGhpcy5tb3VzZU1vdmVIYW5kbGVyLGQ9dGhpcy5tb3VzZVVwSGFuZGxlcixlO2U9W1thLFwibW91c2Vkb3duXCIsYl0sW2EsXCJtb3VzZW1vdmVcIixjXSxbQixcIm1vdXNldXBcIixkXV07ZGImJmUucHVzaChbYSxcInRvdWNoc3RhcnRcIixiXSxbYSxcInRvdWNobW92ZVwiLGNdLFtCLFwidG91Y2hlbmRcIixkXSk7bihlLGZ1bmN0aW9uKGEpe0QuYXBwbHkobnVsbCxhKX0pO3RoaXMuX2V2ZW50cz1lfSxyZW1vdmVFdmVudHM6ZnVuY3Rpb24oKXtuKHRoaXMuX2V2ZW50cyxmdW5jdGlvbihhKXtULmFwcGx5KG51bGwsYSl9KTt0aGlzLl9ldmVudHM9dDt0aGlzLm5hdmlnYXRvckVuYWJsZWQmJnRoaXMuYmFzZVNlcmllcyYmVCh0aGlzLmJhc2VTZXJpZXMsXCJ1cGRhdGVkRGF0YVwiLHRoaXMudXBkYXRlZERhdGFIYW5kbGVyKX0saW5pdDpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLmNoYXJ0LGMsZCxlPWEuc2Nyb2xsYmFySGVpZ2h0LGY9YS5uYXZpZ2F0b3JPcHRpb25zLFxuZz1hLmhlaWdodCxoPWEudG9wLGksaj1hLmJhc2VTZXJpZXM7YS5tb3VzZURvd25IYW5kbGVyPWZ1bmN0aW9uKGQpe3ZhciBkPWIucG9pbnRlci5ub3JtYWxpemUoZCksZT1hLnpvb21lZE1pbixmPWEuem9vbWVkTWF4LGg9YS50b3Asaj1hLnNjcm9sbGJhckhlaWdodCxrPWEuc2Nyb2xsZXJMZWZ0LGw9YS5zY3JvbGxlcldpZHRoLG49YS5uYXZpZ2F0b3JMZWZ0LHE9YS5uYXZpZ2F0b3JXaWR0aCxzPWEuc2Nyb2xsYmFyUGFkLHQ9YS5yYW5nZSx2PWQuY2hhcnRYLHg9ZC5jaGFydFksZD1iLnhBeGlzWzBdLHksej1rYj8xMDo3O2lmKHg+aCYmeDxoK2crailpZigoaD0hYS5zY3JvbGxiYXJFbmFibGVkfHx4PGgrZykmJlkuYWJzKHYtZS1uKTx6KWEuZ3JhYmJlZExlZnQ9ITAsYS5vdGhlckhhbmRsZVBvcz1mLGEuZml4ZWRFeHRyZW1lPWQubWF4LGIuZml4ZWRSYW5nZT1udWxsO2Vsc2UgaWYoaCYmWS5hYnModi1mLW4pPHopYS5ncmFiYmVkUmlnaHQ9ITAsYS5vdGhlckhhbmRsZVBvcz1lLFxuYS5maXhlZEV4dHJlbWU9ZC5taW4sYi5maXhlZFJhbmdlPW51bGw7ZWxzZSBpZih2Pm4rZS1zJiZ2PG4rZitzKWEuZ3JhYmJlZENlbnRlcj12LGEuZml4ZWRXaWR0aD10LGk9di1lO2Vsc2UgaWYodj5rJiZ2PGsrbCl7Zj1oP3Ytbi10LzI6djxuP2UtdCowLjI6dj5rK2wtaj9lK3QqMC4yOnY8bitlP2UtdDpmO2lmKGY8MClmPTA7ZWxzZSBpZihmK3Q+PXEpZj1xLXQseT1hLmdldFVuaW9uRXh0cmVtZXMoKS5kYXRhTWF4O2lmKGYhPT1lKWEuZml4ZWRXaWR0aD10LGU9Yy50b0ZpeGVkUmFuZ2UoZixmK3QsbnVsbCx5KSxkLnNldEV4dHJlbWVzKGUubWluLGUubWF4LCEwLCExLHt0cmlnZ2VyOlwibmF2aWdhdG9yXCJ9KX19O2EubW91c2VNb3ZlSGFuZGxlcj1mdW5jdGlvbihjKXt2YXIgZD1hLnNjcm9sbGJhckhlaWdodCxlPWEubmF2aWdhdG9yTGVmdCxmPWEubmF2aWdhdG9yV2lkdGgsZz1hLnNjcm9sbGVyTGVmdCxoPWEuc2Nyb2xsZXJXaWR0aCxqPWEucmFuZ2UsayxsO2lmKCFjLnRvdWNoZXN8fFxuYy50b3VjaGVzWzBdLnBhZ2VYIT09MCljPWIucG9pbnRlci5ub3JtYWxpemUoYyksaz1jLmNoYXJ0WCxrPGU/az1lOms+ZytoLWQmJihrPWcraC1kKSxhLmdyYWJiZWRMZWZ0PyhsPSEwLGEucmVuZGVyKDAsMCxrLWUsYS5vdGhlckhhbmRsZVBvcykpOmEuZ3JhYmJlZFJpZ2h0PyhsPSEwLGEucmVuZGVyKDAsMCxhLm90aGVySGFuZGxlUG9zLGstZSkpOmEuZ3JhYmJlZENlbnRlciYmKGw9ITAsazxpP2s9aTprPmYraS1qJiYoaz1mK2ktaiksYS5yZW5kZXIoMCwwLGstaSxrLWkraikpLGwmJmEuc2Nyb2xsYmFyT3B0aW9ucy5saXZlUmVkcmF3JiZzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7YS5tb3VzZVVwSGFuZGxlcihjKX0sMCksYS5oYXNEcmFnZ2VkPWx9O2EubW91c2VVcEhhbmRsZXI9ZnVuY3Rpb24oZCl7dmFyIGUsZjtpZihhLmhhc0RyYWdnZWQpe2lmKGEuem9vbWVkTWluPT09YS5vdGhlckhhbmRsZVBvcyllPWEuZml4ZWRFeHRyZW1lO2Vsc2UgaWYoYS56b29tZWRNYXg9PT1hLm90aGVySGFuZGxlUG9zKWY9XG5hLmZpeGVkRXh0cmVtZTtpZihhLnpvb21lZE1heD09PWEubmF2aWdhdG9yV2lkdGgpZj1hLmdldFVuaW9uRXh0cmVtZXMoKS5kYXRhTWF4O2U9Yy50b0ZpeGVkUmFuZ2UoYS56b29tZWRNaW4sYS56b29tZWRNYXgsZSxmKTtzKGUubWluKSYmYi54QXhpc1swXS5zZXRFeHRyZW1lcyhlLm1pbixlLm1heCwhMCwhMSx7dHJpZ2dlcjpcIm5hdmlnYXRvclwiLHRyaWdnZXJPcDpcIm5hdmlnYXRvci1kcmFnXCIsRE9NRXZlbnQ6ZH0pfWlmKGQudHlwZSE9PVwibW91c2Vtb3ZlXCIpYS5ncmFiYmVkTGVmdD1hLmdyYWJiZWRSaWdodD1hLmdyYWJiZWRDZW50ZXI9YS5maXhlZFdpZHRoPWEuZml4ZWRFeHRyZW1lPWEub3RoZXJIYW5kbGVQb3M9YS5oYXNEcmFnZ2VkPWk9bnVsbH07dmFyIGs9Yi54QXhpcy5sZW5ndGgsbD1iLnlBeGlzLmxlbmd0aDtiLmV4dHJhQm90dG9tTWFyZ2luPWEub3V0bGluZUhlaWdodCtmLm1hcmdpbjthLm5hdmlnYXRvckVuYWJsZWQ/KGEueEF4aXM9Yz1uZXcgSShiLEMoe2JyZWFrczpqJiZcbmoueEF4aXMub3B0aW9ucy5icmVha3Msb3JkaW5hbDpqJiZqLnhBeGlzLm9wdGlvbnMub3JkaW5hbH0sZi54QXhpcyx7aWQ6XCJuYXZpZ2F0b3IteC1heGlzXCIsaXNYOiEwLHR5cGU6XCJkYXRldGltZVwiLGluZGV4OmssaGVpZ2h0Omcsb2Zmc2V0OjAsb2Zmc2V0TGVmdDplLG9mZnNldFJpZ2h0Oi1lLGtlZXBPcmRpbmFsUGFkZGluZzohMCxzdGFydE9uVGljazohMSxlbmRPblRpY2s6ITEsbWluUGFkZGluZzowLG1heFBhZGRpbmc6MCx6b29tRW5hYmxlZDohMX0pKSxhLnlBeGlzPWQ9bmV3IEkoYixDKGYueUF4aXMse2lkOlwibmF2aWdhdG9yLXktYXhpc1wiLGFsaWduVGlja3M6ITEsaGVpZ2h0Omcsb2Zmc2V0OjAsaW5kZXg6bCx6b29tRW5hYmxlZDohMX0pKSxqfHxmLnNlcmllcy5kYXRhP2EuYWRkQmFzZVNlcmllcygpOmIuc2VyaWVzLmxlbmd0aD09PTAmJlUoYixcInJlZHJhd1wiLGZ1bmN0aW9uKGMsZCl7aWYoYi5zZXJpZXMubGVuZ3RoPjAmJiFhLnNlcmllcylhLnNldEJhc2VTZXJpZXMoKSxcbmIucmVkcmF3PWM7Yy5jYWxsKGIsZCl9KSk6YS54QXhpcz1jPXt0cmFuc2xhdGU6ZnVuY3Rpb24oYSxjKXt2YXIgZD1iLnhBeGlzWzBdLGY9ZC5nZXRFeHRyZW1lcygpLGc9Yi5wbG90V2lkdGgtMiplLGg9eGIoXCJtaW5cIixkLm9wdGlvbnMubWluLGYuZGF0YU1pbiksZD14YihcIm1heFwiLGQub3B0aW9ucy5tYXgsZi5kYXRhTWF4KS1oO3JldHVybiBjP2EqZC9nK2g6ZyooYS1oKS9kfSx0b0ZpeGVkUmFuZ2U6SS5wcm90b3R5cGUudG9GaXhlZFJhbmdlfTtVKGIsXCJnZXRNYXJnaW5zXCIsZnVuY3Rpb24oYil7dmFyIGU9dGhpcy5sZWdlbmQsZj1lLm9wdGlvbnM7Yi5hcHBseSh0aGlzLFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpKTthLnRvcD1oPWEubmF2aWdhdG9yT3B0aW9ucy50b3B8fHRoaXMuY2hhcnRIZWlnaHQtYS5oZWlnaHQtYS5zY3JvbGxiYXJIZWlnaHQtdGhpcy5zcGFjaW5nWzJdLShmLnZlcnRpY2FsQWxpZ249PT1cImJvdHRvbVwiJiZmLmVuYWJsZWQmJiFmLmZsb2F0aW5nP2UubGVnZW5kSGVpZ2h0K1xucShmLm1hcmdpbiwxMCk6MCk7aWYoYyYmZCljLm9wdGlvbnMudG9wPWQub3B0aW9ucy50b3A9aCxjLnNldEF4aXNTaXplKCksZC5zZXRBeGlzU2l6ZSgpfSk7YS5hZGRFdmVudHMoKX0sZ2V0VW5pb25FeHRyZW1lczpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNoYXJ0LnhBeGlzWzBdLGM9dGhpcy54QXhpcyxkPWMub3B0aW9ucyxlPWIub3B0aW9ucyxmO2lmKCFhfHxiLmRhdGFNaW4hPT1udWxsKWY9e2RhdGFNaW46cShkJiZkLm1pbix4YihcIm1pblwiLGUubWluLGIuZGF0YU1pbixjLmRhdGFNaW4pKSxkYXRhTWF4OnEoZCYmZC5tYXgseGIoXCJtYXhcIixlLm1heCxiLmRhdGFNYXgsYy5kYXRhTWF4KSl9O3JldHVybiBmfSxzZXRCYXNlU2VyaWVzOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY2hhcnQsYT1hfHxiLm9wdGlvbnMubmF2aWdhdG9yLmJhc2VTZXJpZXM7dGhpcy5zZXJpZXMmJnRoaXMuc2VyaWVzLnJlbW92ZSgpO3RoaXMuYmFzZVNlcmllcz1iLnNlcmllc1thXXx8dHlwZW9mIGE9PT1cblwic3RyaW5nXCImJmIuZ2V0KGEpfHxiLnNlcmllc1swXTt0aGlzLnhBeGlzJiZ0aGlzLmFkZEJhc2VTZXJpZXMoKX0sYWRkQmFzZVNlcmllczpmdW5jdGlvbigpe3ZhciBhPXRoaXMuYmFzZVNlcmllcyxiPWE/YS5vcHRpb25zOnt9LGM9Yi5kYXRhLGQ9dGhpcy5uYXZpZ2F0b3JPcHRpb25zLnNlcmllcyxlO2U9ZC5kYXRhO3RoaXMuaGFzTmF2aWdhdG9yRGF0YT0hIWU7Yj1DKGIsZCx7ZW5hYmxlTW91c2VUcmFja2luZzohMSxncm91cDpcIm5hdlwiLHBhZFhBeGlzOiExLHhBeGlzOlwibmF2aWdhdG9yLXgtYXhpc1wiLHlBeGlzOlwibmF2aWdhdG9yLXktYXhpc1wiLG5hbWU6XCJOYXZpZ2F0b3JcIixzaG93SW5MZWdlbmQ6ITEsc3RhY2tpbmc6ITEsaXNJbnRlcm5hbDohMCx2aXNpYmxlOiEwfSk7Yi5kYXRhPWV8fGMuc2xpY2UoMCk7dGhpcy5zZXJpZXM9dGhpcy5jaGFydC5pbml0U2VyaWVzKGIpO2lmKGEmJnRoaXMubmF2aWdhdG9yT3B0aW9ucy5hZGFwdFRvVXBkYXRlZERhdGEhPT0hMSlEKGEsXCJ1cGRhdGVkRGF0YVwiLFxudGhpcy51cGRhdGVkRGF0YUhhbmRsZXIpLGEudXNlck9wdGlvbnMuZXZlbnRzPXgoYS51c2VyT3B0aW9ucy5ldmVudCx7dXBkYXRlZERhdGE6dGhpcy51cGRhdGVkRGF0YUhhbmRsZXJ9KX0sdXBkYXRlZERhdGFIYW5kbGVyOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5jaGFydC5zY3JvbGxlcixiPWEuYmFzZVNlcmllcyxjPWIueEF4aXMsZD1jLmdldEV4dHJlbWVzKCksZT1kLm1pbixmPWQubWF4LGc9ZC5kYXRhTWluLGQ9ZC5kYXRhTWF4LGg9Zi1lLGksaixrLGwsbSxvPWEuc2VyaWVzO2k9by54RGF0YTt2YXIgbj0hIWMuc2V0RXh0cmVtZXM7aj1mPj1pW2kubGVuZ3RoLTFdLSh0aGlzLmNsb3Nlc3RQb2ludFJhbmdlfHwwKTtpPWU8PWc7aWYoIWEuaGFzTmF2aWdhdG9yRGF0YSlvLm9wdGlvbnMucG9pbnRTdGFydD1iLnhEYXRhWzBdLG8uc2V0RGF0YShiLm9wdGlvbnMuZGF0YSwhMSksbT0hMDtpJiYobD1nLGs9bCtoKTtqJiYoaz1kLGl8fChsPXYoay1oLG8ueERhdGFbMF0pKSk7biYmXG4oaXx8aik/aXNOYU4obCl8fGMuc2V0RXh0cmVtZXMobCxrLCEwLCExLHt0cmlnZ2VyOlwidXBkYXRlZERhdGFcIn0pOihtJiZ0aGlzLmNoYXJ0LnJlZHJhdyghMSksYS5yZW5kZXIodihlLGcpLEUoZixkKSkpfSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5yZW1vdmVFdmVudHMoKTtuKFt0aGlzLnhBeGlzLHRoaXMueUF4aXMsdGhpcy5sZWZ0U2hhZGUsdGhpcy5yaWdodFNoYWRlLHRoaXMub3V0bGluZSx0aGlzLnNjcm9sbGJhclRyYWNrLHRoaXMuc2Nyb2xsYmFyUmlmbGVzLHRoaXMuc2Nyb2xsYmFyR3JvdXAsdGhpcy5zY3JvbGxiYXJdLGZ1bmN0aW9uKGEpe2EmJmEuZGVzdHJveSYmYS5kZXN0cm95KCl9KTt0aGlzLnhBeGlzPXRoaXMueUF4aXM9dGhpcy5sZWZ0U2hhZGU9dGhpcy5yaWdodFNoYWRlPXRoaXMub3V0bGluZT10aGlzLnNjcm9sbGJhclRyYWNrPXRoaXMuc2Nyb2xsYmFyUmlmbGVzPXRoaXMuc2Nyb2xsYmFyR3JvdXA9dGhpcy5zY3JvbGxiYXI9bnVsbDtuKFt0aGlzLnNjcm9sbGJhckJ1dHRvbnMsXG50aGlzLmhhbmRsZXMsdGhpcy5lbGVtZW50c1RvRGVzdHJveV0sZnVuY3Rpb24oYSl7UGEoYSl9KX19O3ouU2Nyb2xsZXI9SGI7VShJLnByb3RvdHlwZSxcInpvb21cIixmdW5jdGlvbihhLGIsYyl7dmFyIGQ9dGhpcy5jaGFydCxlPWQub3B0aW9ucyxmPWUuY2hhcnQuem9vbVR5cGUsZz1lLm5hdmlnYXRvcixlPWUucmFuZ2VTZWxlY3RvcixoO2lmKHRoaXMuaXNYQXhpcyYmKGcmJmcuZW5hYmxlZHx8ZSYmZS5lbmFibGVkKSlpZihmPT09XCJ4XCIpZC5yZXNldFpvb21CdXR0b249XCJibG9ja2VkXCI7ZWxzZSBpZihmPT09XCJ5XCIpaD0hMTtlbHNlIGlmKGY9PT1cInh5XCIpZD10aGlzLnByZXZpb3VzWm9vbSxzKGIpP3RoaXMucHJldmlvdXNab29tPVt0aGlzLm1pbix0aGlzLm1heF06ZCYmKGI9ZFswXSxjPWRbMV0sZGVsZXRlIHRoaXMucHJldmlvdXNab29tKTtyZXR1cm4gaCE9PXQ/aDphLmNhbGwodGhpcyxiLGMpfSk7VShDYS5wcm90b3R5cGUsXCJpbml0XCIsZnVuY3Rpb24oYSxiLGMpe0QodGhpcyxcblwiYmVmb3JlUmVuZGVyXCIsZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9wdGlvbnM7aWYoYS5uYXZpZ2F0b3IuZW5hYmxlZHx8YS5zY3JvbGxiYXIuZW5hYmxlZCl0aGlzLnNjcm9sbGVyPW5ldyBIYih0aGlzKX0pO2EuY2FsbCh0aGlzLGIsYyl9KTtVKFEucHJvdG90eXBlLFwiYWRkUG9pbnRcIixmdW5jdGlvbihhLGIsYyxkLGUpe3ZhciBmPXRoaXMub3B0aW9ucy50dXJib1RocmVzaG9sZDtmJiZ0aGlzLnhEYXRhLmxlbmd0aD5mJiZkYShiKSYmIUphKGIpJiZ0aGlzLmNoYXJ0LnNjcm9sbGVyJiZnYSgyMCwhMCk7YS5jYWxsKHRoaXMsYixjLGQsZSl9KTt4KE4se3JhbmdlU2VsZWN0b3I6e2J1dHRvblRoZW1lOnt3aWR0aDoyOCxoZWlnaHQ6MTgsZmlsbDpcIiNmN2Y3ZjdcIixwYWRkaW5nOjIscjowLFwic3Ryb2tlLXdpZHRoXCI6MCxzdHlsZTp7Y29sb3I6XCIjNDQ0XCIsY3Vyc29yOlwicG9pbnRlclwiLGZvbnRXZWlnaHQ6XCJub3JtYWxcIn0sekluZGV4Ojcsc3RhdGVzOntob3Zlcjp7ZmlsbDpcIiNlN2U3ZTdcIn0sXG5zZWxlY3Q6e2ZpbGw6XCIjZTdmMGY5XCIsc3R5bGU6e2NvbG9yOlwiYmxhY2tcIixmb250V2VpZ2h0OlwiYm9sZFwifX19fSxoZWlnaHQ6MzUsaW5wdXRQb3NpdGlvbjp7YWxpZ246XCJyaWdodFwifSxsYWJlbFN0eWxlOntjb2xvcjpcIiM2NjZcIn19fSk7Ti5sYW5nPUMoTi5sYW5nLHtyYW5nZVNlbGVjdG9yWm9vbTpcIlpvb21cIixyYW5nZVNlbGVjdG9yRnJvbTpcIkZyb21cIixyYW5nZVNlbGVjdG9yVG86XCJUb1wifSk7SWIucHJvdG90eXBlPXtjbGlja0J1dHRvbjpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMsZD1jLnNlbGVjdGVkLGU9Yy5jaGFydCxmPWMuYnV0dG9ucyxnPWMuYnV0dG9uT3B0aW9uc1thXSxoPWUueEF4aXNbMF0saT1lLnNjcm9sbGVyJiZlLnNjcm9sbGVyLmdldFVuaW9uRXh0cmVtZXMoKXx8aHx8e30saj1pLmRhdGFNaW4saz1pLmRhdGFNYXgsbCxtPWgmJnkoRShoLm1heCxxKGssaC5tYXgpKSksbz1nLnR5cGUscCxpPWcuX3JhbmdlLHIscyx4LHU9Zy5kYXRhR3JvdXBpbmc7aWYoIShqPT09XG5udWxsfHxrPT09bnVsbHx8YT09PWMuc2VsZWN0ZWQpKXtlLmZpeGVkUmFuZ2U9aTtpZih1KXRoaXMuZm9yY2VkRGF0YUdyb3VwaW5nPSEwLEkucHJvdG90eXBlLnNldERhdGFHcm91cGluZy5jYWxsKGh8fHtjaGFydDp0aGlzLmNoYXJ0fSx1LCExKTtpZihvPT09XCJtb250aFwifHxvPT09XCJ5ZWFyXCIpaWYoaCl7aWYobz17cmFuZ2U6ZyxtYXg6bSxkYXRhTWluOmosZGF0YU1heDprfSxsPWgubWluRnJvbVJhbmdlLmNhbGwobyksdHlwZW9mIG8ubmV3TWF4PT09XCJudW1iZXJcIiltPW8ubmV3TWF4fWVsc2UgaT1nO2Vsc2UgaWYoaSlsPXYobS1pLGopLG09RShsK2ksayk7ZWxzZSBpZihvPT09XCJ5dGRcIilpZihoKXtpZihrPT09dClqPU51bWJlci5NQVhfVkFMVUUsaz1OdW1iZXIuTUlOX1ZBTFVFLG4oZS5zZXJpZXMsZnVuY3Rpb24oYSl7YT1hLnhEYXRhO2o9RShhWzBdLGopO2s9dihhW2EubGVuZ3RoLTFdLGspfSksYj0hMTttPW5ldyBmYShrKTtsPW0uZ2V0RnVsbFllYXIoKTtsPXI9dihqfHxcbjAsZmEuVVRDKGwsMCwxKSk7bT1tLmdldFRpbWUoKTttPUUoa3x8bSxtKX1lbHNle0QoZSxcImJlZm9yZVJlbmRlclwiLGZ1bmN0aW9uKCl7Yy5jbGlja0J1dHRvbihhKX0pO3JldHVybn1lbHNlIG89PT1cImFsbFwiJiZoJiYobD1qLG09ayk7ZltkXSYmZltkXS5zZXRTdGF0ZSgwKTtpZihmW2FdKWZbYV0uc2V0U3RhdGUoMiksYy5sYXN0U2VsZWN0ZWQ9YTtoPyhoLnNldEV4dHJlbWVzKGwsbSxxKGIsMSksMCx7dHJpZ2dlcjpcInJhbmdlU2VsZWN0b3JCdXR0b25cIixyYW5nZVNlbGVjdG9yQnV0dG9uOmd9KSxjLnNldFNlbGVjdGVkKGEpKToocD1lLm9wdGlvbnMueEF4aXNbMF0seD1wLnJhbmdlLHAucmFuZ2U9aSxzPXAubWluLHAubWluPXIsYy5zZXRTZWxlY3RlZChhKSxEKGUsXCJsb2FkXCIsZnVuY3Rpb24oKXtwLnJhbmdlPXg7cC5taW49c30pKX19LHNldFNlbGVjdGVkOmZ1bmN0aW9uKGEpe3RoaXMuc2VsZWN0ZWQ9dGhpcy5vcHRpb25zLnNlbGVjdGVkPWF9LGRlZmF1bHRCdXR0b25zOlt7dHlwZTpcIm1vbnRoXCIsXG5jb3VudDoxLHRleHQ6XCIxbVwifSx7dHlwZTpcIm1vbnRoXCIsY291bnQ6Myx0ZXh0OlwiM21cIn0se3R5cGU6XCJtb250aFwiLGNvdW50OjYsdGV4dDpcIjZtXCJ9LHt0eXBlOlwieXRkXCIsdGV4dDpcIllURFwifSx7dHlwZTpcInllYXJcIixjb3VudDoxLHRleHQ6XCIxeVwifSx7dHlwZTpcImFsbFwiLHRleHQ6XCJBbGxcIn1dLGluaXQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcyxjPWEub3B0aW9ucy5yYW5nZVNlbGVjdG9yLGQ9Yy5idXR0b25zfHxbXS5jb25jYXQoYi5kZWZhdWx0QnV0dG9ucyksZT1jLnNlbGVjdGVkLGY9Yi5ibHVySW5wdXRzPWZ1bmN0aW9uKCl7dmFyIGE9Yi5taW5JbnB1dCxjPWIubWF4SW5wdXQ7YSYmYS5ibHVyJiZNKGEsXCJibHVyXCIpO2MmJmMuYmx1ciYmTShjLFwiYmx1clwiKX07Yi5jaGFydD1hO2Iub3B0aW9ucz1jO2IuYnV0dG9ucz1bXTthLmV4dHJhVG9wTWFyZ2luPWMuaGVpZ2h0O2IuYnV0dG9uT3B0aW9ucz1kO0QoYS5jb250YWluZXIsXCJtb3VzZWRvd25cIixmKTtEKGEsXCJyZXNpemVcIixmKTtcbm4oZCxiLmNvbXB1dGVCdXR0b25SYW5nZSk7ZSE9PXQmJmRbZV0mJnRoaXMuY2xpY2tCdXR0b24oZSwhMSk7RChhLFwibG9hZFwiLGZ1bmN0aW9uKCl7RChhLnhBeGlzWzBdLFwic2V0RXh0cmVtZXNcIixmdW5jdGlvbihjKXt0aGlzLm1heC10aGlzLm1pbiE9PWEuZml4ZWRSYW5nZSYmYy50cmlnZ2VyIT09XCJyYW5nZVNlbGVjdG9yQnV0dG9uXCImJmMudHJpZ2dlciE9PVwidXBkYXRlZERhdGFcIiYmYi5mb3JjZWREYXRhR3JvdXBpbmcmJnRoaXMuc2V0RGF0YUdyb3VwaW5nKCExLCExKX0pO0QoYS54QXhpc1swXSxcImFmdGVyU2V0RXh0cmVtZXNcIixmdW5jdGlvbigpe2IudXBkYXRlQnV0dG9uU3RhdGVzKCEwKX0pfSl9LHVwZGF0ZUJ1dHRvblN0YXRlczpmdW5jdGlvbihhKXt2YXIgYj10aGlzLGM9dGhpcy5jaGFydCxkPWMueEF4aXNbMF0sZT1jLnNjcm9sbGVyJiZjLnNjcm9sbGVyLmdldFVuaW9uRXh0cmVtZXMoKXx8ZCxmPWUuZGF0YU1pbixnPWUuZGF0YU1heCxoPWIuc2VsZWN0ZWQsaT1iLm9wdGlvbnMuYWxsQnV0dG9uc0VuYWJsZWQsXG5qPWIuYnV0dG9uczthJiZjLmZpeGVkUmFuZ2UhPT15KGQubWF4LWQubWluKSYmKGpbaF0mJmpbaF0uc2V0U3RhdGUoMCksYi5zZXRTZWxlY3RlZChudWxsKSk7bihiLmJ1dHRvbk9wdGlvbnMsZnVuY3Rpb24oYSxlKXt2YXIgbT15KGQubWF4LWQubWluKSxvPWEuX3JhbmdlLG49YS50eXBlLHE9YS5jb3VudHx8MSxzPW8+Zy1mLHQ9bzxkLm1pblJhbmdlLHU9YS50eXBlPT09XCJhbGxcIiYmZC5tYXgtZC5taW4+PWctZiYmaltlXS5zdGF0ZSE9PTIsdz1hLnR5cGU9PT1cInl0ZFwiJiZtYShcIiVZXCIsZik9PT1tYShcIiVZXCIsZyksdj1jLnJlbmRlcmVyLmZvckV4cG9ydCYmZT09PWgsbz1vPT09bSx4PSFkLmhhc1Zpc2libGVTZXJpZXM7aWYoKG49PT1cIm1vbnRoXCJ8fG49PT1cInllYXJcIikmJm0+PXttb250aDoyOCx5ZWFyOjM2NX1bbl0qODY0RTUqcSYmbTw9e21vbnRoOjMxLHllYXI6MzY2fVtuXSo4NjRFNSpxKW89ITA7dnx8byYmZSE9PWgmJmU9PT1iLmxhc3RTZWxlY3RlZD8oYi5zZXRTZWxlY3RlZChlKSxcbmpbZV0uc2V0U3RhdGUoMikpOiFpJiYoc3x8dHx8dXx8d3x8eCk/altlXS5zZXRTdGF0ZSgzKTpqW2VdLnN0YXRlPT09MyYmaltlXS5zZXRTdGF0ZSgwKX0pfSxjb21wdXRlQnV0dG9uUmFuZ2U6ZnVuY3Rpb24oYSl7dmFyIGI9YS50eXBlLGM9YS5jb3VudHx8MSxkPXttaWxsaXNlY29uZDoxLHNlY29uZDoxRTMsbWludXRlOjZFNCxob3VyOjM2RTUsZGF5Ojg2NEU1LHdlZWs6NjA0OEU1fTtpZihkW2JdKWEuX3JhbmdlPWRbYl0qYztlbHNlIGlmKGI9PT1cIm1vbnRoXCJ8fGI9PT1cInllYXJcIilhLl9yYW5nZT17bW9udGg6MzAseWVhcjozNjV9W2JdKjg2NEU1KmN9LHNldElucHV0VmFsdWU6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmNoYXJ0Lm9wdGlvbnMucmFuZ2VTZWxlY3RvcjtpZihzKGIpKXRoaXNbYStcIklucHV0XCJdLkhDVGltZT1iO3RoaXNbYStcIklucHV0XCJdLnZhbHVlPW1hKGMuaW5wdXRFZGl0RGF0ZUZvcm1hdHx8XCIlWS0lbS0lZFwiLHRoaXNbYStcIklucHV0XCJdLkhDVGltZSk7dGhpc1thK1xuXCJEYXRlQm94XCJdLmF0dHIoe3RleHQ6bWEoYy5pbnB1dERhdGVGb3JtYXR8fFwiJWIgJWUsICVZXCIsdGhpc1thK1wiSW5wdXRcIl0uSENUaW1lKX0pfSxzaG93SW5wdXQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5pbnB1dEdyb3VwLGM9dGhpc1thK1wiRGF0ZUJveFwiXTtGKHRoaXNbYStcIklucHV0XCJdLHtsZWZ0OmIudHJhbnNsYXRlWCtjLngrXCJweFwiLHRvcDpiLnRyYW5zbGF0ZVkrXCJweFwiLHdpZHRoOmMud2lkdGgtMitcInB4XCIsaGVpZ2h0OmMuaGVpZ2h0LTIrXCJweFwiLGJvcmRlcjpcIjJweCBzb2xpZCBzaWx2ZXJcIn0pfSxoaWRlSW5wdXQ6ZnVuY3Rpb24oYSl7Rih0aGlzW2ErXCJJbnB1dFwiXSx7Ym9yZGVyOjAsd2lkdGg6XCIxcHhcIixoZWlnaHQ6XCIxcHhcIn0pO3RoaXMuc2V0SW5wdXRWYWx1ZShhKX0sZHJhd0lucHV0OmZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoKXt2YXIgYT1qLnZhbHVlLGI9KGcuaW5wdXREYXRlUGFyc2VyfHxmYS5wYXJzZSkoYSksZT1kLnhBeGlzWzBdLGY9ZS5kYXRhTWluLGg9ZS5kYXRhTWF4O1xuaWYoYiE9PWoucHJldmlvdXNWYWx1ZSlqLnByZXZpb3VzVmFsdWU9Yixpc05hTihiKSYmKGI9YS5zcGxpdChcIi1cIiksYj1mYS5VVEMoRyhiWzBdKSxHKGJbMV0pLTEsRyhiWzJdKSkpLGlzTmFOKGIpfHwoTi5nbG9iYWwudXNlVVRDfHwoYis9KG5ldyBmYSkuZ2V0VGltZXpvbmVPZmZzZXQoKSo2RTQpLGk/Yj5jLm1heElucHV0LkhDVGltZT9iPXQ6YjxmJiYoYj1mKTpiPGMubWluSW5wdXQuSENUaW1lP2I9dDpiPmgmJihiPWgpLGIhPT10JiZkLnhBeGlzWzBdLnNldEV4dHJlbWVzKGk/YjplLm1pbixpP2UubWF4OmIsdCx0LHt0cmlnZ2VyOlwicmFuZ2VTZWxlY3RvcklucHV0XCJ9KSl9dmFyIGM9dGhpcyxkPWMuY2hhcnQsZT1kLnJlbmRlcmVyLnN0eWxlLGY9ZC5yZW5kZXJlcixnPWQub3B0aW9ucy5yYW5nZVNlbGVjdG9yLGg9Yy5kaXYsaT1hPT09XCJtaW5cIixqLGssbD10aGlzLmlucHV0R3JvdXA7dGhpc1thK1wiTGFiZWxcIl09az1mLmxhYmVsKE4ubGFuZ1tpP1wicmFuZ2VTZWxlY3RvckZyb21cIjpcblwicmFuZ2VTZWxlY3RvclRvXCJdLHRoaXMuaW5wdXRHcm91cC5vZmZzZXQpLmF0dHIoe3BhZGRpbmc6Mn0pLmNzcyhDKGUsZy5sYWJlbFN0eWxlKSkuYWRkKGwpO2wub2Zmc2V0Kz1rLndpZHRoKzU7dGhpc1thK1wiRGF0ZUJveFwiXT1mPWYubGFiZWwoXCJcIixsLm9mZnNldCkuYXR0cih7cGFkZGluZzoyLHdpZHRoOmcuaW5wdXRCb3hXaWR0aHx8OTAsaGVpZ2h0OmcuaW5wdXRCb3hIZWlnaHR8fDE3LHN0cm9rZTpnLmlucHV0Qm94Qm9yZGVyQ29sb3J8fFwic2lsdmVyXCIsXCJzdHJva2Utd2lkdGhcIjoxfSkuY3NzKEMoe3RleHRBbGlnbjpcImNlbnRlclwiLGNvbG9yOlwiIzQ0NFwifSxlLGcuaW5wdXRTdHlsZSkpLm9uKFwiY2xpY2tcIixmdW5jdGlvbigpe2Muc2hvd0lucHV0KGEpO2NbYStcIklucHV0XCJdLmZvY3VzKCl9KS5hZGQobCk7bC5vZmZzZXQrPWYud2lkdGgrKGk/MTA6MCk7dGhpc1thK1wiSW5wdXRcIl09aj1lYShcImlucHV0XCIse25hbWU6YSxjbGFzc05hbWU6XCJoaWdoY2hhcnRzLXJhbmdlLXNlbGVjdG9yXCIsXG50eXBlOlwidGV4dFwifSx4KHtwb3NpdGlvbjpcImFic29sdXRlXCIsYm9yZGVyOjAsd2lkdGg6XCIxcHhcIixoZWlnaHQ6XCIxcHhcIixwYWRkaW5nOjAsdGV4dEFsaWduOlwiY2VudGVyXCIsZm9udFNpemU6ZS5mb250U2l6ZSxmb250RmFtaWx5OmUuZm9udEZhbWlseSxsZWZ0OlwiLTllbVwiLHRvcDpkLnBsb3RUb3ArXCJweFwifSxnLmlucHV0U3R5bGUpLGgpO2oub25mb2N1cz1mdW5jdGlvbigpe2Muc2hvd0lucHV0KGEpfTtqLm9uYmx1cj1mdW5jdGlvbigpe2MuaGlkZUlucHV0KGEpfTtqLm9uY2hhbmdlPWI7ai5vbmtleXByZXNzPWZ1bmN0aW9uKGEpe2Eua2V5Q29kZT09PTEzJiZiKCl9fSxnZXRQb3NpdGlvbjpmdW5jdGlvbigpe3ZhciBhPXRoaXMuY2hhcnQsYj1hLm9wdGlvbnMucmFuZ2VTZWxlY3RvcixhPXEoKGIuYnV0dG9uUG9zaXRpb258fHt9KS55LGEucGxvdFRvcC1hLmF4aXNPZmZzZXRbMF0tYi5oZWlnaHQpO3JldHVybntidXR0b25Ub3A6YSxpbnB1dFRvcDphLTEwfX0scmVuZGVyOmZ1bmN0aW9uKGEsXG5iKXt2YXIgYz10aGlzLGQ9Yy5jaGFydCxlPWQucmVuZGVyZXIsZj1kLmNvbnRhaW5lcixnPWQub3B0aW9ucyxoPWcuZXhwb3J0aW5nJiZnLmV4cG9ydGluZy5lbmFibGVkIT09ITEmJmcubmF2aWdhdGlvbiYmZy5uYXZpZ2F0aW9uLmJ1dHRvbk9wdGlvbnMsaT1nLnJhbmdlU2VsZWN0b3Isaj1jLmJ1dHRvbnMsZz1OLmxhbmcsaz1jLmRpdixrPWMuaW5wdXRHcm91cCxsPWkuYnV0dG9uVGhlbWUsbT1pLmJ1dHRvblBvc2l0aW9ufHx7fSxvPWkuaW5wdXRFbmFibGVkLHA9bCYmbC5zdGF0ZXMscj1kLnBsb3RMZWZ0LHQsdj10aGlzLmdldFBvc2l0aW9uKCksdT1jLmdyb3VwLHc9Yy5yZW5kZXJlZDtpZighdyYmKGMuZ3JvdXA9dT1lLmcoXCJyYW5nZS1zZWxlY3Rvci1idXR0b25zXCIpLmFkZCgpLGMuem9vbVRleHQ9ZS50ZXh0KGcucmFuZ2VTZWxlY3Rvclpvb20scShtLngsciksMTUpLmNzcyhpLmxhYmVsU3R5bGUpLmFkZCh1KSx0PXEobS54LHIpK2Muem9vbVRleHQuZ2V0QkJveCgpLndpZHRoK1xuNSxuKGMuYnV0dG9uT3B0aW9ucyxmdW5jdGlvbihhLGIpe2pbYl09ZS5idXR0b24oYS50ZXh0LHQsMCxmdW5jdGlvbigpe2MuY2xpY2tCdXR0b24oYik7Yy5pc0FjdGl2ZT0hMH0sbCxwJiZwLmhvdmVyLHAmJnAuc2VsZWN0LHAmJnAuZGlzYWJsZWQpLmNzcyh7dGV4dEFsaWduOlwiY2VudGVyXCJ9KS5hZGQodSk7dCs9altiXS53aWR0aCtxKGkuYnV0dG9uU3BhY2luZyw1KTtjLnNlbGVjdGVkPT09YiYmaltiXS5zZXRTdGF0ZSgyKX0pLGMudXBkYXRlQnV0dG9uU3RhdGVzKCksbyE9PSExKSljLmRpdj1rPWVhKFwiZGl2XCIsbnVsbCx7cG9zaXRpb246XCJyZWxhdGl2ZVwiLGhlaWdodDowLHpJbmRleDoxfSksZi5wYXJlbnROb2RlLmluc2VydEJlZm9yZShrLGYpLGMuaW5wdXRHcm91cD1rPWUuZyhcImlucHV0LWdyb3VwXCIpLmFkZCgpLGsub2Zmc2V0PTAsYy5kcmF3SW5wdXQoXCJtaW5cIiksYy5kcmF3SW5wdXQoXCJtYXhcIik7dVt3P1wiYW5pbWF0ZVwiOlwiYXR0clwiXSh7dHJhbnNsYXRlWTp2LmJ1dHRvblRvcH0pO1xubyE9PSExJiYoay5hbGlnbih4KHt5OnYuaW5wdXRUb3Asd2lkdGg6ay5vZmZzZXQseDpoJiZ2LmlucHV0VG9wPChoLnl8fDApK2guaGVpZ2h0LWQuc3BhY2luZ1swXT8tNDA6MH0saS5pbnB1dFBvc2l0aW9uKSwhMCxkLnNwYWNpbmdCb3gpLHMobyl8fChkPXUuZ2V0QkJveCgpLGtbay50cmFuc2xhdGVYPGQueCtkLndpZHRoKzEwP1wiaGlkZVwiOlwic2hvd1wiXSgpKSxjLnNldElucHV0VmFsdWUoXCJtaW5cIixhKSxjLnNldElucHV0VmFsdWUoXCJtYXhcIixiKSk7Yy5yZW5kZXJlZD0hMH0sZGVzdHJveTpmdW5jdGlvbigpe3ZhciBhPXRoaXMubWluSW5wdXQsYj10aGlzLm1heElucHV0LGM9dGhpcy5jaGFydCxkPXRoaXMuYmx1cklucHV0cyxlO1QoYy5jb250YWluZXIsXCJtb3VzZWRvd25cIixkKTtUKGMsXCJyZXNpemVcIixkKTtQYSh0aGlzLmJ1dHRvbnMpO2lmKGEpYS5vbmZvY3VzPWEub25ibHVyPWEub25jaGFuZ2U9bnVsbDtpZihiKWIub25mb2N1cz1iLm9uYmx1cj1iLm9uY2hhbmdlPW51bGw7XG5mb3IoZSBpbiB0aGlzKXRoaXNbZV0mJmUhPT1cImNoYXJ0XCImJih0aGlzW2VdLmRlc3Ryb3k/dGhpc1tlXS5kZXN0cm95KCk6dGhpc1tlXS5ub2RlVHlwZSYmVmEodGhpc1tlXSkpLHRoaXNbZV09bnVsbH19O0kucHJvdG90eXBlLnRvRml4ZWRSYW5nZT1mdW5jdGlvbihhLGIsYyxkKXt2YXIgZT10aGlzLmNoYXJ0JiZ0aGlzLmNoYXJ0LmZpeGVkUmFuZ2UsYT1xKGMsdGhpcy50cmFuc2xhdGUoYSwhMCkpLGI9cShkLHRoaXMudHJhbnNsYXRlKGIsITApKSxjPWUmJihiLWEpL2U7Yz4wLjcmJmM8MS4zJiYoZD9hPWItZTpiPWErZSk7aXNOYU4oYSkmJihhPWI9dm9pZCAwKTtyZXR1cm57bWluOmEsbWF4OmJ9fTtJLnByb3RvdHlwZS5taW5Gcm9tUmFuZ2U9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLnJhbmdlLGI9e21vbnRoOlwiTW9udGhcIix5ZWFyOlwiRnVsbFllYXJcIn1bYS50eXBlXSxjLGQ9dGhpcy5tYXgsZSxmLGc9ZnVuY3Rpb24oYSxjKXt2YXIgZD1uZXcgZmEoYSk7ZFtcInNldFwiK2JdKGRbXCJnZXRcIitcbmJdKCkrYyk7cmV0dXJuIGQuZ2V0VGltZSgpLWF9O3R5cGVvZiBhPT09XCJudW1iZXJcIj8oYz10aGlzLm1heC1hLGY9YSk6Yz1kK2coZCwtYS5jb3VudCk7ZT1xKHRoaXMuZGF0YU1pbixOdW1iZXIuTUlOX1ZBTFVFKTtpc05hTihjKSYmKGM9ZSk7aWYoYzw9ZSljPWUsZj09PXZvaWQgMCYmKGY9ZyhjLGEuY291bnQpKSx0aGlzLm5ld01heD1FKGMrZix0aGlzLmRhdGFNYXgpO2lzTmFOKGQpJiYoYz12b2lkIDApO3JldHVybiBjfTtVKENhLnByb3RvdHlwZSxcImluaXRcIixmdW5jdGlvbihhLGIsYyl7RCh0aGlzLFwiaW5pdFwiLGZ1bmN0aW9uKCl7aWYodGhpcy5vcHRpb25zLnJhbmdlU2VsZWN0b3IuZW5hYmxlZCl0aGlzLnJhbmdlU2VsZWN0b3I9bmV3IEliKHRoaXMpfSk7YS5jYWxsKHRoaXMsYixjKX0pO3ouUmFuZ2VTZWxlY3Rvcj1JYjtDYS5wcm90b3R5cGUuY2FsbGJhY2tzLnB1c2goZnVuY3Rpb24oYSl7ZnVuY3Rpb24gYigpe2Y9YS54QXhpc1swXS5nZXRFeHRyZW1lcygpO2cucmVuZGVyKGYubWluLFxuZi5tYXgpfWZ1bmN0aW9uIGMoKXtmPWEueEF4aXNbMF0uZ2V0RXh0cmVtZXMoKTtpc05hTihmLm1pbil8fGgucmVuZGVyKGYubWluLGYubWF4KX1mdW5jdGlvbiBkKGEpe2EudHJpZ2dlck9wIT09XCJuYXZpZ2F0b3ItZHJhZ1wiJiZnLnJlbmRlcihhLm1pbixhLm1heCl9ZnVuY3Rpb24gZShhKXtoLnJlbmRlcihhLm1pbixhLm1heCl9dmFyIGYsZz1hLnNjcm9sbGVyLGg9YS5yYW5nZVNlbGVjdG9yO2cmJihEKGEueEF4aXNbMF0sXCJhZnRlclNldEV4dHJlbWVzXCIsZCksVShhLFwiZHJhd0NoYXJ0Qm94XCIsZnVuY3Rpb24oYSl7dmFyIGM9dGhpcy5pc0RpcnR5Qm94O2EuY2FsbCh0aGlzKTtjJiZiKCl9KSxiKCkpO2gmJihEKGEueEF4aXNbMF0sXCJhZnRlclNldEV4dHJlbWVzXCIsZSksRChhLFwicmVzaXplXCIsYyksYygpKTtEKGEsXCJkZXN0cm95XCIsZnVuY3Rpb24oKXtnJiZUKGEueEF4aXNbMF0sXCJhZnRlclNldEV4dHJlbWVzXCIsZCk7aCYmKFQoYSxcInJlc2l6ZVwiLGMpLFQoYS54QXhpc1swXSxcImFmdGVyU2V0RXh0cmVtZXNcIixcbmUpKX0pfSk7ei5TdG9ja0NoYXJ0PXouc3RvY2tDaGFydD1mdW5jdGlvbihhLGIsYyl7dmFyIGQ9RGEoYSl8fGEubm9kZU5hbWUsZT1hcmd1bWVudHNbZD8xOjBdLGY9ZS5zZXJpZXMsZyxoPXEoZS5uYXZpZ2F0b3ImJmUubmF2aWdhdG9yLmVuYWJsZWQsITApP3tzdGFydE9uVGljazohMSxlbmRPblRpY2s6ITF9Om51bGwsaT17bWFya2VyOntlbmFibGVkOiExLHJhZGl1czoyfX0saj17c2hhZG93OiExLGJvcmRlcldpZHRoOjB9O2UueEF4aXM9dGEodmEoZS54QXhpc3x8e30pLGZ1bmN0aW9uKGEpe3JldHVybiBDKHttaW5QYWRkaW5nOjAsbWF4UGFkZGluZzowLG9yZGluYWw6ITAsdGl0bGU6e3RleHQ6bnVsbH0sbGFiZWxzOntvdmVyZmxvdzpcImp1c3RpZnlcIn0sc2hvd0xhc3RMYWJlbDohMH0sYSx7dHlwZTpcImRhdGV0aW1lXCIsY2F0ZWdvcmllczpudWxsfSxoKX0pO2UueUF4aXM9dGEodmEoZS55QXhpc3x8e30pLGZ1bmN0aW9uKGEpe2c9cShhLm9wcG9zaXRlLCEwKTtyZXR1cm4gQyh7bGFiZWxzOnt5Oi0yfSxcbm9wcG9zaXRlOmcsc2hvd0xhc3RMYWJlbDohMSx0aXRsZTp7dGV4dDpudWxsfX0sYSl9KTtlLnNlcmllcz1udWxsO2U9Qyh7Y2hhcnQ6e3Bhbm5pbmc6ITAscGluY2hUeXBlOlwieFwifSxuYXZpZ2F0b3I6e2VuYWJsZWQ6ITB9LHNjcm9sbGJhcjp7ZW5hYmxlZDohMH0scmFuZ2VTZWxlY3Rvcjp7ZW5hYmxlZDohMH0sdGl0bGU6e3RleHQ6bnVsbCxzdHlsZTp7Zm9udFNpemU6XCIxNnB4XCJ9fSx0b29sdGlwOntzaGFyZWQ6ITAsY3Jvc3NoYWlyczohMH0sbGVnZW5kOntlbmFibGVkOiExfSxwbG90T3B0aW9uczp7bGluZTppLHNwbGluZTppLGFyZWE6aSxhcmVhc3BsaW5lOmksYXJlYXJhbmdlOmksYXJlYXNwbGluZXJhbmdlOmksY29sdW1uOmosY29sdW1ucmFuZ2U6aixjYW5kbGVzdGljazpqLG9obGM6an19LGUse19zdG9jazohMCxjaGFydDp7aW52ZXJ0ZWQ6ITF9fSk7ZS5zZXJpZXM9ZjtyZXR1cm4gZD9uZXcgQ2EoYSxlLGMpOm5ldyBDYShlLGIpfTtVKFphLnByb3RvdHlwZSxcImluaXRcIixcbmZ1bmN0aW9uKGEsYixjKXt2YXIgZD1jLmNoYXJ0LnBpbmNoVHlwZXx8XCJcIjthLmNhbGwodGhpcyxiLGMpO3RoaXMucGluY2hYPXRoaXMucGluY2hIb3I9ZC5pbmRleE9mKFwieFwiKSE9PS0xO3RoaXMucGluY2hZPXRoaXMucGluY2hWZXJ0PWQuaW5kZXhPZihcInlcIikhPT0tMTt0aGlzLmhhc1pvb209dGhpcy5oYXNab29tfHx0aGlzLnBpbmNoSG9yfHx0aGlzLnBpbmNoVmVydH0pO1UoSS5wcm90b3R5cGUsXCJhdXRvTGFiZWxBbGlnblwiLGZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY2hhcnQsYz10aGlzLm9wdGlvbnMsYj1iLl9sYWJlbFBhbmVzPWIuX2xhYmVsUGFuZXN8fHt9LGQ9dGhpcy5vcHRpb25zLmxhYmVscztpZih0aGlzLmNoYXJ0Lm9wdGlvbnMuX3N0b2NrJiZ0aGlzLmNvbGw9PT1cInlBeGlzXCImJihjPWMudG9wK1wiLFwiK2MuaGVpZ2h0LCFiW2NdJiZkLmVuYWJsZWQpKXtpZihkLng9PT0xNSlkLng9MDtpZihkLmFsaWduPT09dm9pZCAwKWQuYWxpZ249XCJyaWdodFwiO2JbY109MTtyZXR1cm5cInJpZ2h0XCJ9cmV0dXJuIGEuY2FsbCh0aGlzLFxuW10uc2xpY2UuY2FsbChhcmd1bWVudHMsMSkpfSk7VShJLnByb3RvdHlwZSxcImdldFBsb3RMaW5lUGF0aFwiLGZ1bmN0aW9uKGEsYixjLGQsZSxmKXt2YXIgZz10aGlzLGg9dGhpcy5pc0xpbmtlZCYmIXRoaXMuc2VyaWVzP3RoaXMubGlua2VkUGFyZW50LnNlcmllczp0aGlzLnNlcmllcyxpPWcuY2hhcnQsaj1pLnJlbmRlcmVyLGs9Zy5sZWZ0LGw9Zy50b3AsbSxvLHAscix0PVtdLHg9W10sdSx3O2lmKGcuY29sbD09PVwiY29sb3JBeGlzXCIpcmV0dXJuIGEuYXBwbHkodGhpcyxbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSk7eD1nLmlzWEF4aXM/cyhnLm9wdGlvbnMueUF4aXMpP1tpLnlBeGlzW2cub3B0aW9ucy55QXhpc11dOnRhKGgsZnVuY3Rpb24oYSl7cmV0dXJuIGEueUF4aXN9KTpzKGcub3B0aW9ucy54QXhpcyk/W2kueEF4aXNbZy5vcHRpb25zLnhBeGlzXV06dGEoaCxmdW5jdGlvbihhKXtyZXR1cm4gYS54QXhpc30pO24oZy5pc1hBeGlzP2kueUF4aXM6aS54QXhpcyxmdW5jdGlvbihhKXtpZihzKGEub3B0aW9ucy5pZCk/XG5hLm9wdGlvbnMuaWQuaW5kZXhPZihcIm5hdmlnYXRvclwiKT09PS0xOjEpe3ZhciBiPWEuaXNYQXhpcz9cInlBeGlzXCI6XCJ4QXhpc1wiLGI9cyhhLm9wdGlvbnNbYl0pP2lbYl1bYS5vcHRpb25zW2JdXTppW2JdWzBdO2c9PT1iJiZ4LnB1c2goYSl9fSk7dT14Lmxlbmd0aD9bXTpbZy5pc1hBeGlzP2kueUF4aXNbMF06aS54QXhpc1swXV07bih4LGZ1bmN0aW9uKGEpe3NhKGEsdSk9PT0tMSYmdS5wdXNoKGEpfSk7dz1xKGYsZy50cmFuc2xhdGUoYixudWxsLG51bGwsZCkpO2lzTmFOKHcpfHwoZy5ob3Jpej9uKHUsZnVuY3Rpb24oYSl7dmFyIGI7bz1hLnBvcztyPW8rYS5sZW47bT1wPXkodytnLnRyYW5zQik7aWYobTxrfHxtPmsrZy53aWR0aCllP209cD1FKHYoayxtKSxrK2cud2lkdGgpOmI9ITA7Ynx8dC5wdXNoKFwiTVwiLG0sbyxcIkxcIixwLHIpfSk6bih1LGZ1bmN0aW9uKGEpe3ZhciBiO209YS5wb3M7cD1tK2EubGVuO289cj15KGwrZy5oZWlnaHQtdyk7aWYobzxsfHxvPmwrZy5oZWlnaHQpZT9cbm89cj1FKHYobCxvKSxnLnRvcCtnLmhlaWdodCk6Yj0hMDtifHx0LnB1c2goXCJNXCIsbSxvLFwiTFwiLHAscil9KSk7cmV0dXJuIHQubGVuZ3RoPjA/ai5jcmlzcFBvbHlMaW5lKHQsY3x8MSk6bnVsbH0pO0kucHJvdG90eXBlLmdldFBsb3RCYW5kUGF0aD1mdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuZ2V0UGxvdExpbmVQYXRoKGIsbnVsbCxudWxsLCEwKSxkPXRoaXMuZ2V0UGxvdExpbmVQYXRoKGEsbnVsbCxudWxsLCEwKSxlPVtdLGY7aWYoZCYmYyYmZC50b1N0cmluZygpIT09Yy50b1N0cmluZygpKWZvcihmPTA7ZjxkLmxlbmd0aDtmKz02KWUucHVzaChcIk1cIixkW2YrMV0sZFtmKzJdLFwiTFwiLGRbZis0XSxkW2YrNV0sY1tmKzRdLGNbZis1XSxjW2YrMV0sY1tmKzJdKTtlbHNlIGU9bnVsbDtyZXR1cm4gZX07eWEucHJvdG90eXBlLmNyaXNwUG9seUxpbmU9ZnVuY3Rpb24oYSxiKXt2YXIgYztmb3IoYz0wO2M8YS5sZW5ndGg7Yys9NilhW2MrMV09PT1hW2MrNF0mJihhW2MrMV09YVtjKzRdPVxueShhW2MrMV0pLWIlMi8yKSxhW2MrMl09PT1hW2MrNV0mJihhW2MrMl09YVtjKzVdPXkoYVtjKzJdKStiJTIvMik7cmV0dXJuIGF9O2lmKFlhPT09ei5WTUxSZW5kZXJlciltYi5wcm90b3R5cGUuY3Jpc3BQb2x5TGluZT15YS5wcm90b3R5cGUuY3Jpc3BQb2x5TGluZTtVKEkucHJvdG90eXBlLFwiaGlkZUNyb3NzaGFpclwiLGZ1bmN0aW9uKGEsYil7YS5jYWxsKHRoaXMsYik7aWYodGhpcy5jcm9zc0xhYmVsKXRoaXMuY3Jvc3NMYWJlbD10aGlzLmNyb3NzTGFiZWwuaGlkZSgpfSk7VShJLnByb3RvdHlwZSxcImRyYXdDcm9zc2hhaXJcIixmdW5jdGlvbihhLGIsYyl7dmFyIGQsZTthLmNhbGwodGhpcyxiLGMpO2lmKHModGhpcy5jcm9zc2hhaXIubGFiZWwpJiZ0aGlzLmNyb3NzaGFpci5sYWJlbC5lbmFibGVkKXt2YXIgYT10aGlzLmNoYXJ0LGY9dGhpcy5vcHRpb25zLmNyb3NzaGFpci5sYWJlbCxnPXRoaXMuaG9yaXosaD10aGlzLm9wcG9zaXRlLGk9dGhpcy5sZWZ0LGo9dGhpcy50b3Asaz1cbnRoaXMuY3Jvc3NMYWJlbCxsLG09Zi5mb3JtYXQsbj1cIlwiLHA9dGhpcy5vcHRpb25zLnRpY2tQb3NpdGlvbj09PVwiaW5zaWRlXCIscj10aGlzLmNyb3NzaGFpci5zbmFwIT09ITE7bD1nP1wiY2VudGVyXCI6aD90aGlzLmxhYmVsQWxpZ249PT1cInJpZ2h0XCI/XCJyaWdodFwiOlwibGVmdFwiOnRoaXMubGFiZWxBbGlnbj09PVwibGVmdFwiP1wibGVmdFwiOlwiY2VudGVyXCI7aWYoIWspaz10aGlzLmNyb3NzTGFiZWw9YS5yZW5kZXJlci5sYWJlbChudWxsLG51bGwsbnVsbCxmLnNoYXBlfHxcImNhbGxvdXRcIikuYXR0cih7YWxpZ246Zi5hbGlnbnx8bCx6SW5kZXg6MTIsZmlsbDpmLmJhY2tncm91bmRDb2xvcnx8dGhpcy5zZXJpZXNbMF0mJnRoaXMuc2VyaWVzWzBdLmNvbG9yfHxcImdyYXlcIixwYWRkaW5nOnEoZi5wYWRkaW5nLDgpLHN0cm9rZTpmLmJvcmRlckNvbG9yfHxcIlwiLFwic3Ryb2tlLXdpZHRoXCI6Zi5ib3JkZXJXaWR0aHx8MCxyOnEoZi5ib3JkZXJSYWRpdXMsMyl9KS5jc3MoeCh7Y29sb3I6XCJ3aGl0ZVwiLGZvbnRXZWlnaHQ6XCJub3JtYWxcIixcbmZvbnRTaXplOlwiMTFweFwiLHRleHRBbGlnbjpcImNlbnRlclwifSxmLnN0eWxlKSkuYWRkKCk7Zz8obD1yP2MucGxvdFgraTpiLmNoYXJ0WCxqKz1oPzA6dGhpcy5oZWlnaHQpOihsPWg/dGhpcy53aWR0aCtpOjAsaj1yP2MucGxvdFkrajpiLmNoYXJ0WSk7IW0mJiFmLmZvcm1hdHRlciYmKHRoaXMuaXNEYXRldGltZUF4aXMmJihuPVwiJWIgJWQsICVZXCIpLG09XCJ7dmFsdWVcIisobj9cIjpcIituOlwiXCIpK1wifVwiKTtiPXI/Y1t0aGlzLmlzWEF4aXM/XCJ4XCI6XCJ5XCJdOnRoaXMudG9WYWx1ZShnP2IuY2hhcnRYOmIuY2hhcnRZKTtrLmF0dHIoe3RleHQ6bT9MYShtLHt2YWx1ZTpifSk6Zi5mb3JtYXR0ZXIuY2FsbCh0aGlzLGIpLGFuY2hvclg6Zz9sOnRoaXMub3Bwb3NpdGU/MDphLmNoYXJ0V2lkdGgsYW5jaG9yWTpnP3RoaXMub3Bwb3NpdGU/YS5jaGFydEhlaWdodDowOmoseDpsLHk6aix2aXNpYmlsaXR5OlwidmlzaWJsZVwifSk7Yj1rLmdldEJCb3goKTtpZihnKXtpZihwJiYhaHx8IXAmJmgpaj1rLnktXG5iLmhlaWdodH1lbHNlIGo9ay55LWIuaGVpZ2h0LzI7Zz8oZD1pLWIueCxlPWkrdGhpcy53aWR0aC1iLngpOihkPXRoaXMubGFiZWxBbGlnbj09PVwibGVmdFwiP2k6MCxlPXRoaXMubGFiZWxBbGlnbj09PVwicmlnaHRcIj9pK3RoaXMud2lkdGg6YS5jaGFydFdpZHRoKTtrLnRyYW5zbGF0ZVg8ZCYmKGwrPWQtay50cmFuc2xhdGVYKTtrLnRyYW5zbGF0ZVgrYi53aWR0aD49ZSYmKGwtPWsudHJhbnNsYXRlWCtiLndpZHRoLWUpO2suYXR0cih7eDpsLHk6aix2aXNpYmlsaXR5OlwidmlzaWJsZVwifSl9fSk7dmFyIGdjPWlhLmluaXQsaGM9aWEucHJvY2Vzc0RhdGEsaWM9SGEucHJvdG90eXBlLnRvb2x0aXBGb3JtYXR0ZXI7aWEuaW5pdD1mdW5jdGlvbigpe2djLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLnNldENvbXBhcmUodGhpcy5vcHRpb25zLmNvbXBhcmUpfTtpYS5zZXRDb21wYXJlPWZ1bmN0aW9uKGEpe3RoaXMubW9kaWZ5VmFsdWU9YT09PVwidmFsdWVcInx8YT09PVwicGVyY2VudFwiP2Z1bmN0aW9uKGIsXG5jKXt2YXIgZD10aGlzLmNvbXBhcmVWYWx1ZTtpZihiIT09dCYmKGI9YT09PVwidmFsdWVcIj9iLWQ6Yj0xMDAqKGIvZCktMTAwLGMpKWMuY2hhbmdlPWI7cmV0dXJuIGJ9Om51bGw7aWYodGhpcy5jaGFydC5oYXNSZW5kZXJlZCl0aGlzLmlzRGlydHk9ITB9O2lhLnByb2Nlc3NEYXRhPWZ1bmN0aW9uKCl7dmFyIGEsYj0tMSxjLGQsZSxmO2hjLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtpZih0aGlzLnhBeGlzJiZ0aGlzLnByb2Nlc3NlZFlEYXRhKXtjPXRoaXMucHJvY2Vzc2VkWERhdGE7ZD10aGlzLnByb2Nlc3NlZFlEYXRhO2U9ZC5sZW5ndGg7dGhpcy5wb2ludEFycmF5TWFwJiYoYj1zYSh0aGlzLnBvaW50VmFsS2V5fHxcInlcIix0aGlzLnBvaW50QXJyYXlNYXApKTtmb3IoYT0wO2E8ZTthKyspaWYoZj1iPi0xP2RbYV1bYl06ZFthXSx0eXBlb2YgZj09PVwibnVtYmVyXCImJmNbYV0+PXRoaXMueEF4aXMubWluJiZmIT09MCl7dGhpcy5jb21wYXJlVmFsdWU9ZjticmVha319fTtVKGlhLFwiZ2V0RXh0cmVtZXNcIixcbmZ1bmN0aW9uKGEpe3ZhciBiO2EuYXBwbHkodGhpcyxbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSk7aWYodGhpcy5tb2RpZnlWYWx1ZSliPVt0aGlzLm1vZGlmeVZhbHVlKHRoaXMuZGF0YU1pbiksdGhpcy5tb2RpZnlWYWx1ZSh0aGlzLmRhdGFNYXgpXSx0aGlzLmRhdGFNaW49T2EoYiksdGhpcy5kYXRhTWF4PUVhKGIpfSk7SS5wcm90b3R5cGUuc2V0Q29tcGFyZT1mdW5jdGlvbihhLGIpe3RoaXMuaXNYQXhpc3x8KG4odGhpcy5zZXJpZXMsZnVuY3Rpb24oYil7Yi5zZXRDb21wYXJlKGEpfSkscShiLCEwKSYmdGhpcy5jaGFydC5yZWRyYXcoKSl9O0hhLnByb3RvdHlwZS50b29sdGlwRm9ybWF0dGVyPWZ1bmN0aW9uKGEpe2E9YS5yZXBsYWNlKFwie3BvaW50LmNoYW5nZX1cIiwodGhpcy5jaGFuZ2U+MD9cIitcIjpcIlwiKSt6Lm51bWJlckZvcm1hdCh0aGlzLmNoYW5nZSxxKHRoaXMuc2VyaWVzLnRvb2x0aXBPcHRpb25zLmNoYW5nZURlY2ltYWxzLDIpKSk7cmV0dXJuIGljLmFwcGx5KHRoaXMsXG5bYV0pfTtVKFEucHJvdG90eXBlLFwicmVuZGVyXCIsZnVuY3Rpb24oYSl7aWYodGhpcy5jaGFydC5vcHRpb25zLl9zdG9jayYmdGhpcy54QXhpcykhdGhpcy5jbGlwQm94JiZ0aGlzLmFuaW1hdGU/KHRoaXMuY2xpcEJveD1DKHRoaXMuY2hhcnQuY2xpcEJveCksdGhpcy5jbGlwQm94LndpZHRoPXRoaXMueEF4aXMubGVuLHRoaXMuY2xpcEJveC5oZWlnaHQ9dGhpcy55QXhpcy5sZW4pOnRoaXMuY2hhcnRbdGhpcy5zaGFyZWRDbGlwS2V5XSYmKFRhKHRoaXMuY2hhcnRbdGhpcy5zaGFyZWRDbGlwS2V5XSksdGhpcy5jaGFydFt0aGlzLnNoYXJlZENsaXBLZXldLmF0dHIoe3dpZHRoOnRoaXMueEF4aXMubGVuLGhlaWdodDp0aGlzLnlBeGlzLmxlbn0pKTthLmNhbGwodGhpcyl9KTt4KHose0NvbG9yOndhLFBvaW50OkhhLFRpY2s6Y2IsUmVuZGVyZXI6WWEsU1ZHRWxlbWVudDpaLFNWR1JlbmRlcmVyOnlhLGFycmF5TWluOk9hLGFycmF5TWF4OkVhLGNoYXJ0czokLGNvcnJlY3RGbG9hdDpuYSxcbmRhdGVGb3JtYXQ6bWEsZXJyb3I6Z2EsZm9ybWF0OkxhLHBhdGhBbmltOnZvaWQgMCxnZXRPcHRpb25zOmZ1bmN0aW9uKCl7cmV0dXJuIE59LGhhc0JpZGlCdWc6WmIsaXNUb3VjaERldmljZTprYixzZXRPcHRpb25zOmZ1bmN0aW9uKGEpe049QyghMCxOLGEpO09iKCk7cmV0dXJuIE59LGFkZEV2ZW50OkQscmVtb3ZlRXZlbnQ6VCxjcmVhdGVFbGVtZW50OmVhLGRpc2NhcmRFbGVtZW50OlZhLGNzczpGLGVhY2g6bixtYXA6dGEsbWVyZ2U6QyxzcGxhdDp2YSxzdGFibGVTb3J0Om9iLGV4dGVuZENsYXNzOmxhLHBJbnQ6Ryxzdmc6amEsY2FudmFzOnFhLHZtbDohamEmJiFxYSxwcm9kdWN0OlwiSGlnaHN0b2NrXCIsdmVyc2lvbjpcIjQuMi40XCJ9KTtyZXR1cm4gen0pO1xuIiwiLyoqXG4qXG4qIGpxdWVyeS5zcGFya2xpbmUuanNcbipcbiogdjIuMy4yXG4qIChjKSBTcGx1bmssIEluY1xuKiBDb250YWN0OiBHYXJldGggV2F0dHMgKGdhcmV0aEBzcGx1bmsuY29tKVxuKiBodHRwOi8vb21uaXBvdGVudC5uZXQvanF1ZXJ5LnNwYXJrbGluZS9cbipcbiogR2VuZXJhdGVzIGlubGluZSBzcGFya2xpbmUgY2hhcnRzIGZyb20gZGF0YSBzdXBwbGllZCBlaXRoZXIgdG8gdGhlIG1ldGhvZFxuKiBvciBpbmxpbmUgaW4gSFRNTFxuKlxuKiBDb21wYXRpYmxlIHdpdGggSW50ZXJuZXQgRXhwbG9yZXIgNi4wKyBhbmQgbW9kZXJuIGJyb3dzZXJzIGVxdWlwcGVkIHdpdGggdGhlIGNhbnZhcyB0YWdcbiogKEZpcmVmb3ggMi4wKywgU2FmYXJpLCBPcGVyYSwgZXRjKVxuKlxuKiBMaWNlbnNlOiBOZXcgQlNEIExpY2Vuc2VcbipcbiogQ29weXJpZ2h0IChjKSAyMDEyLCBTcGx1bmsgSW5jLlxuKiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuKlxuKiBSZWRpc3RyaWJ1dGlvbiBhbmQgdXNlIGluIHNvdXJjZSBhbmQgYmluYXJ5IGZvcm1zLCB3aXRoIG9yIHdpdGhvdXQgbW9kaWZpY2F0aW9uLFxuKiBhcmUgcGVybWl0dGVkIHByb3ZpZGVkIHRoYXQgdGhlIGZvbGxvd2luZyBjb25kaXRpb25zIGFyZSBtZXQ6XG4qXG4qICAgICAqIFJlZGlzdHJpYnV0aW9ucyBvZiBzb3VyY2UgY29kZSBtdXN0IHJldGFpbiB0aGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSxcbiogICAgICAgdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lci5cbiogICAgICogUmVkaXN0cmlidXRpb25zIGluIGJpbmFyeSBmb3JtIG11c3QgcmVwcm9kdWNlIHRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlLFxuKiAgICAgICB0aGlzIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQgdGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyIGluIHRoZSBkb2N1bWVudGF0aW9uXG4qICAgICAgIGFuZC9vciBvdGhlciBtYXRlcmlhbHMgcHJvdmlkZWQgd2l0aCB0aGUgZGlzdHJpYnV0aW9uLlxuKiAgICAgKiBOZWl0aGVyIHRoZSBuYW1lIG9mIFNwbHVuayBJbmMgbm9yIHRoZSBuYW1lcyBvZiBpdHMgY29udHJpYnV0b3JzIG1heVxuKiAgICAgICBiZSB1c2VkIHRvIGVuZG9yc2Ugb3IgcHJvbW90ZSBwcm9kdWN0cyBkZXJpdmVkIGZyb20gdGhpcyBzb2Z0d2FyZSB3aXRob3V0XG4qICAgICAgIHNwZWNpZmljIHByaW9yIHdyaXR0ZW4gcGVybWlzc2lvbi5cbipcbiogVEhJUyBTT0ZUV0FSRSBJUyBQUk9WSURFRCBCWSBUSEUgQ09QWVJJR0hUIEhPTERFUlMgQU5EIENPTlRSSUJVVE9SUyBcIkFTIElTXCIgQU5EIEFOWVxuKiBFWFBSRVNTIE9SIElNUExJRUQgV0FSUkFOVElFUywgSU5DTFVESU5HLCBCVVQgTk9UIExJTUlURUQgVE8sIFRIRSBJTVBMSUVEIFdBUlJBTlRJRVNcbiogT0YgTUVSQ0hBTlRBQklMSVRZIEFORCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBUkUgRElTQ0xBSU1FRC4gSU4gTk8gRVZFTlRcbiogU0hBTEwgVEhFIENPUFlSSUdIVCBPV05FUiBPUiBDT05UUklCVVRPUlMgQkUgTElBQkxFIEZPUiBBTlkgRElSRUNULCBJTkRJUkVDVCwgSU5DSURFTlRBTCxcbiogU1BFQ0lBTCwgRVhFTVBMQVJZLCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVMgKElOQ0xVRElORywgQlVUIE5PVCBMSU1JVEVEIFRPLCBQUk9DVVJFTUVOVFxuKiBPRiBTVUJTVElUVVRFIEdPT0RTIE9SIFNFUlZJQ0VTOyBMT1NTIE9GIFVTRSwgREFUQSwgT1IgUFJPRklUUzsgT1IgQlVTSU5FU1MgSU5URVJSVVBUSU9OKVxuKiBIT1dFVkVSIENBVVNFRCBBTkQgT04gQU5ZIFRIRU9SWSBPRiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQ09OVFJBQ1QsIFNUUklDVCBMSUFCSUxJVFksXG4qIE9SIFRPUlQgKElOQ0xVRElORyBORUdMSUdFTkNFIE9SIE9USEVSV0lTRSkgQVJJU0lORyBJTiBBTlkgV0FZIE9VVCBPRiBUSEUgVVNFIE9GIFRISVNcbiogU09GVFdBUkUsIEVWRU4gSUYgQURWSVNFRCBPRiBUSEUgUE9TU0lCSUxJVFkgT0YgU1VDSCBEQU1BR0UuXG4qXG4qXG4qIFVzYWdlOlxuKiAgJChzZWxlY3Rvcikuc3BhcmtsaW5lKHZhbHVlcywgb3B0aW9ucylcbipcbiogSWYgdmFsdWVzIGlzIHVuZGVmaW5lZCBvciBzZXQgdG8gJ2h0bWwnIHRoZW4gdGhlIGRhdGEgdmFsdWVzIGFyZSByZWFkIGZyb20gdGhlIHNwZWNpZmllZCB0YWc6XG4qICAgPHA+U3BhcmtsaW5lOiA8c3BhbiBjbGFzcz1cInNwYXJrbGluZVwiPjEsNCw2LDYsOCw1LDMsNTwvc3Bhbj48L3A+XG4qICAgJCgnLnNwYXJrbGluZScpLnNwYXJrbGluZSgpO1xuKiBUaGVyZSBtdXN0IGJlIG5vIHNwYWNlcyBpbiB0aGUgZW5jbG9zZWQgZGF0YSBzZXRcbipcbiogT3RoZXJ3aXNlIHZhbHVlcyBtdXN0IGJlIGFuIGFycmF5IG9mIG51bWJlcnMgb3IgbnVsbCB2YWx1ZXNcbiogICAgPHA+U3BhcmtsaW5lOiA8c3BhbiBpZD1cInNwYXJrbGluZTFcIj5UaGlzIHRleHQgcmVwbGFjZWQgaWYgdGhlIGJyb3dzZXIgaXMgY29tcGF0aWJsZTwvc3Bhbj48L3A+XG4qICAgICQoJyNzcGFya2xpbmUxJykuc3BhcmtsaW5lKFsxLDQsNiw2LDgsNSwzLDVdKVxuKiAgICAkKCcjc3BhcmtsaW5lMicpLnNwYXJrbGluZShbMSw0LDYsbnVsbCxudWxsLDUsMyw1XSlcbipcbiogVmFsdWVzIGNhbiBhbHNvIGJlIHNwZWNpZmllZCBpbiBhbiBIVE1MIGNvbW1lbnQsIG9yIGFzIGEgdmFsdWVzIGF0dHJpYnV0ZTpcbiogICAgPHA+U3BhcmtsaW5lOiA8c3BhbiBjbGFzcz1cInNwYXJrbGluZVwiPjwhLS0xLDQsNiw2LDgsNSwzLDUgLS0+PC9zcGFuPjwvcD5cbiogICAgPHA+U3BhcmtsaW5lOiA8c3BhbiBjbGFzcz1cInNwYXJrbGluZVwiIHZhbHVlcz1cIjEsNCw2LDYsOCw1LDMsNVwiPjwvc3Bhbj48L3A+XG4qICAgICQoJy5zcGFya2xpbmUnKS5zcGFya2xpbmUoKTtcbipcbiogRm9yIGxpbmUgY2hhcnRzLCB4IHZhbHVlcyBjYW4gYWxzbyBiZSBzcGVjaWZpZWQ6XG4qICAgPHA+U3BhcmtsaW5lOiA8c3BhbiBjbGFzcz1cInNwYXJrbGluZVwiPjE6MSwyLjc6NCwzLjQ6Niw1OjYsNjo4LDguNzo1LDk6MywxMDo1PC9zcGFuPjwvcD5cbiogICAgJCgnI3NwYXJrbGluZTEnKS5zcGFya2xpbmUoWyBbMSwxXSwgWzIuNyw0XSwgWzMuNCw2XSwgWzUsNl0sIFs2LDhdLCBbOC43LDVdLCBbOSwzXSwgWzEwLDVdIF0pXG4qXG4qIEJ5IGRlZmF1bHQsIG9wdGlvbnMgc2hvdWxkIGJlIHBhc3NlZCBpbiBhcyB0aGUgc2Vjb25kIGFyZ3VtZW50IHRvIHRoZSBzcGFya2xpbmUgZnVuY3Rpb246XG4qICAgJCgnLnNwYXJrbGluZScpLnNwYXJrbGluZShbMSwyLDMsNF0sIHt0eXBlOiAnYmFyJ30pXG4qXG4qIE9wdGlvbnMgY2FuIGFsc28gYmUgc2V0IGJ5IHBhc3NpbmcgdGhlbSBvbiB0aGUgdGFnIGl0c2VsZi4gIFRoaXMgZmVhdHVyZSBpcyBkaXNhYmxlZCBieSBkZWZhdWx0IHRob3VnaFxuKiBhcyB0aGVyZSdzIGEgc2xpZ2h0IHBlcmZvcm1hbmNlIG92ZXJoZWFkOlxuKiAgICQoJy5zcGFya2xpbmUnKS5zcGFya2xpbmUoWzEsMiwzLDRdLCB7ZW5hYmxlVGFnT3B0aW9uczogdHJ1ZX0pXG4qICAgPHA+U3BhcmtsaW5lOiA8c3BhbiBjbGFzcz1cInNwYXJrbGluZVwiIHNwYXJrVHlwZT1cImJhclwiIHNwYXJrQmFyQ29sb3I9XCJyZWRcIj5sb2FkaW5nPC9zcGFuPjwvcD5cbiogUHJlZml4IGFsbCBvcHRpb25zIHN1cHBsaWVkIGFzIHRhZyBhdHRyaWJ1dGUgd2l0aCBcInNwYXJrXCIgKGNvbmZpZ3VyYWJsZSBieSBzZXR0aW5nIHRhZ09wdGlvbnNQcmVmaXgpXG4qXG4qIFN1cHBvcnRlZCBvcHRpb25zOlxuKiAgIGxpbmVDb2xvciAtIENvbG9yIG9mIHRoZSBsaW5lIHVzZWQgZm9yIHRoZSBjaGFydFxuKiAgIGZpbGxDb2xvciAtIENvbG9yIHVzZWQgdG8gZmlsbCBpbiB0aGUgY2hhcnQgLSBTZXQgdG8gJycgb3IgZmFsc2UgZm9yIGEgdHJhbnNwYXJlbnQgY2hhcnRcbiogICB3aWR0aCAtIFdpZHRoIG9mIHRoZSBjaGFydCAtIERlZmF1bHRzIHRvIDMgdGltZXMgdGhlIG51bWJlciBvZiB2YWx1ZXMgaW4gcGl4ZWxzXG4qICAgaGVpZ2h0IC0gSGVpZ2h0IG9mIHRoZSBjaGFydCAtIERlZmF1bHRzIHRvIHRoZSBoZWlnaHQgb2YgdGhlIGNvbnRhaW5pbmcgZWxlbWVudFxuKiAgIGNoYXJ0UmFuZ2VNaW4gLSBTcGVjaWZ5IHRoZSBtaW5pbXVtIHZhbHVlIHRvIHVzZSBmb3IgdGhlIFkgcmFuZ2Ugb2YgdGhlIGNoYXJ0IC0gRGVmYXVsdHMgdG8gdGhlIG1pbmltdW0gdmFsdWUgc3VwcGxpZWRcbiogICBjaGFydFJhbmdlTWF4IC0gU3BlY2lmeSB0aGUgbWF4aW11bSB2YWx1ZSB0byB1c2UgZm9yIHRoZSBZIHJhbmdlIG9mIHRoZSBjaGFydCAtIERlZmF1bHRzIHRvIHRoZSBtYXhpbXVtIHZhbHVlIHN1cHBsaWVkXG4qICAgY2hhcnRSYW5nZUNsaXAgLSBDbGlwIG91dCBvZiByYW5nZSB2YWx1ZXMgdG8gdGhlIG1heC9taW4gc3BlY2lmaWVkIGJ5IGNoYXJ0UmFuZ2VNaW4gYW5kIGNoYXJ0UmFuZ2VNYXhcbiogICBjaGFydFJhbmdlTWluWCAtIFNwZWNpZnkgdGhlIG1pbmltdW0gdmFsdWUgdG8gdXNlIGZvciB0aGUgWCByYW5nZSBvZiB0aGUgY2hhcnQgLSBEZWZhdWx0cyB0byB0aGUgbWluaW11bSB2YWx1ZSBzdXBwbGllZFxuKiAgIGNoYXJ0UmFuZ2VNYXhYIC0gU3BlY2lmeSB0aGUgbWF4aW11bSB2YWx1ZSB0byB1c2UgZm9yIHRoZSBYIHJhbmdlIG9mIHRoZSBjaGFydCAtIERlZmF1bHRzIHRvIHRoZSBtYXhpbXVtIHZhbHVlIHN1cHBsaWVkXG4qICAgY29tcG9zaXRlIC0gSWYgdHJ1ZSB0aGVuIGRvbid0IGVyYXNlIGFueSBleGlzdGluZyBjaGFydCBhdHRhY2hlZCB0byB0aGUgdGFnLCBidXQgZHJhd1xuKiAgICAgICAgICAgYW5vdGhlciBjaGFydCBvdmVyIHRoZSB0b3AgLSBOb3RlIHRoYXQgd2lkdGggYW5kIGhlaWdodCBhcmUgaWdub3JlZCBpZiBhblxuKiAgICAgICAgICAgZXhpc3RpbmcgY2hhcnQgaXMgZGV0ZWN0ZWQuXG4qICAgdGFnVmFsdWVzQXR0cmlidXRlIC0gTmFtZSBvZiB0YWcgYXR0cmlidXRlIHRvIGNoZWNrIGZvciBkYXRhIHZhbHVlcyAtIERlZmF1bHRzIHRvICd2YWx1ZXMnXG4qICAgZW5hYmxlVGFnT3B0aW9ucyAtIFdoZXRoZXIgdG8gY2hlY2sgdGFncyBmb3Igc3BhcmtsaW5lIG9wdGlvbnNcbiogICB0YWdPcHRpb25zUHJlZml4IC0gUHJlZml4IHVzZWQgZm9yIG9wdGlvbnMgc3VwcGxpZWQgYXMgdGFnIGF0dHJpYnV0ZXMgLSBEZWZhdWx0cyB0byAnc3BhcmsnXG4qICAgZGlzYWJsZUhpZGRlbkNoZWNrIC0gSWYgc2V0IHRvIHRydWUsIHRoZW4gdGhlIHBsdWdpbiB3aWxsIGFzc3VtZSB0aGF0IGNoYXJ0cyB3aWxsIG5ldmVyIGJlIGRyYXduIGludG8gYVxuKiAgICAgICAgICAgaGlkZGVuIGRvbSBlbGVtZW50LCBhdm9kaW5nIGEgYnJvd3NlciByZWZsb3dcbiogICBkaXNhYmxlSW50ZXJhY3Rpb24gLSBJZiBzZXQgdG8gdHJ1ZSB0aGVuIGFsbCBtb3VzZW92ZXIvY2xpY2sgaW50ZXJhY3Rpb24gYmVoYXZpb3VyIHdpbGwgYmUgZGlzYWJsZWQsXG4qICAgICAgIG1ha2luZyB0aGUgcGx1Z2luIHBlcmZvcm0gbXVjaCBsaWtlIGl0IGRpZCBpbiAxLnhcbiogICBkaXNhYmxlVG9vbHRpcHMgLSBJZiBzZXQgdG8gdHJ1ZSB0aGVuIHRvb2x0aXBzIHdpbGwgYmUgZGlzYWJsZWQgLSBEZWZhdWx0cyB0byBmYWxzZSAodG9vbHRpcHMgZW5hYmxlZClcbiogICBkaXNhYmxlSGlnaGxpZ2h0IC0gSWYgc2V0IHRvIHRydWUgdGhlbiBoaWdobGlnaHRpbmcgb2Ygc2VsZWN0ZWQgY2hhcnQgZWxlbWVudHMgb24gbW91c2VvdmVyIHdpbGwgYmUgZGlzYWJsZWRcbiogICAgICAgZGVmYXVsdHMgdG8gZmFsc2UgKGhpZ2hsaWdodHMgZW5hYmxlZClcbiogICBoaWdobGlnaHRMaWdodGVuIC0gRmFjdG9yIHRvIGxpZ2h0ZW4vZGFya2VuIGhpZ2hsaWdodGVkIGNoYXJ0IHZhbHVlcyBieSAtIERlZmF1bHRzIHRvIDEuNCBmb3IgYSA0MCUgaW5jcmVhc2VcbiogICB0b29sdGlwQ29udGFpbmVyIC0gU3BlY2lmeSB3aGljaCBET00gZWxlbWVudCB0aGUgdG9vbHRpcCBzaG91bGQgYmUgcmVuZGVyZWQgaW50byAtIGRlZmF1bHRzIHRvIGRvY3VtZW50LmJvZHlcbiogICB0b29sdGlwQ2xhc3NuYW1lIC0gT3B0aW9uYWwgQ1NTIGNsYXNzbmFtZSB0byBhcHBseSB0byB0b29sdGlwcyAtIElmIG5vdCBzcGVjaWZpZWQgdGhlbiBhIGRlZmF1bHQgc3R5bGUgd2lsbCBiZSBhcHBsaWVkXG4qICAgdG9vbHRpcE9mZnNldFggLSBIb3cgbWFueSBwaXhlbHMgYXdheSBmcm9tIHRoZSBtb3VzZSBwb2ludGVyIHRvIHJlbmRlciB0aGUgdG9vbHRpcCBvbiB0aGUgWCBheGlzXG4qICAgdG9vbHRpcE9mZnNldFkgLSBIb3cgbWFueSBwaXhlbHMgYXdheSBmcm9tIHRoZSBtb3VzZSBwb2ludGVyIHRvIHJlbmRlciB0aGUgdG9vbHRpcCBvbiB0aGUgciBheGlzXG4qICAgdG9vbHRpcEZvcm1hdHRlciAgLSBPcHRpb25hbCBjYWxsYmFjayB0aGF0IGFsbG93cyB5b3UgdG8gb3ZlcnJpZGUgdGhlIEhUTUwgZGlzcGxheWVkIGluIHRoZSB0b29sdGlwXG4qICAgICAgIGNhbGxiYWNrIGlzIGdpdmVuIGFyZ3VtZW50cyBvZiAoc3BhcmtsaW5lLCBvcHRpb25zLCBmaWVsZHMpXG4qICAgdG9vbHRpcENoYXJ0VGl0bGUgLSBJZiBzcGVjaWZpZWQgdGhlbiB0aGUgdG9vbHRpcCB1c2VzIHRoZSBzdHJpbmcgc3BlY2lmaWVkIGJ5IHRoaXMgc2V0dGluZyBhcyBhIHRpdGxlXG4qICAgdG9vbHRpcEZvcm1hdCAtIEEgZm9ybWF0IHN0cmluZyBvciBTUEZvcm1hdCBvYmplY3QgIChvciBhbiBhcnJheSB0aGVyZW9mIGZvciBtdWx0aXBsZSBlbnRyaWVzKVxuKiAgICAgICB0byBjb250cm9sIHRoZSBmb3JtYXQgb2YgdGhlIHRvb2x0aXBcbiogICB0b29sdGlwUHJlZml4IC0gQSBzdHJpbmcgdG8gcHJlcGVuZCB0byBlYWNoIGZpZWxkIGRpc3BsYXllZCBpbiBhIHRvb2x0aXBcbiogICB0b29sdGlwU3VmZml4IC0gQSBzdHJpbmcgdG8gYXBwZW5kIHRvIGVhY2ggZmllbGQgZGlzcGxheWVkIGluIGEgdG9vbHRpcFxuKiAgIHRvb2x0aXBTa2lwTnVsbCAtIElmIHRydWUgdGhlbiBudWxsIHZhbHVlcyB3aWxsIG5vdCBoYXZlIGEgdG9vbHRpcCBkaXNwbGF5ZWQgKGRlZmF1bHRzIHRvIHRydWUpXG4qICAgdG9vbHRpcFZhbHVlTG9va3VwcyAtIEFuIG9iamVjdCBvciByYW5nZSBtYXAgdG8gbWFwIGZpZWxkIHZhbHVlcyB0byB0b29sdGlwIHN0cmluZ3NcbiogICAgICAgKGVnLiB0byBtYXAgLTEgdG8gXCJMb3N0XCIsIDAgdG8gXCJEcmF3XCIsIGFuZCAxIHRvIFwiV2luXCIpXG4qICAgbnVtYmVyRm9ybWF0dGVyIC0gT3B0aW9uYWwgY2FsbGJhY2sgZm9yIGZvcm1hdHRpbmcgbnVtYmVycyBpbiB0b29sdGlwc1xuKiAgIG51bWJlckRpZ2l0R3JvdXBTZXAgLSBDaGFyYWN0ZXIgdG8gdXNlIGZvciBncm91cCBzZXBhcmF0b3IgaW4gbnVtYmVycyBcIjEsMjM0XCIgLSBEZWZhdWx0cyB0byBcIixcIlxuKiAgIG51bWJlckRlY2ltYWxNYXJrIC0gQ2hhcmFjdGVyIHRvIHVzZSBmb3IgdGhlIGRlY2ltYWwgcG9pbnQgd2hlbiBmb3JtYXR0aW5nIG51bWJlcnMgLSBEZWZhdWx0cyB0byBcIi5cIlxuKiAgIG51bWJlckRpZ2l0R3JvdXBDb3VudCAtIE51bWJlciBvZiBkaWdpdHMgYmV0d2VlbiBncm91cCBzZXBhcmF0b3IgLSBEZWZhdWx0cyB0byAzXG4qXG4qIFRoZXJlIGFyZSA3IHR5cGVzIG9mIHNwYXJrbGluZSwgc2VsZWN0ZWQgYnkgc3VwcGx5aW5nIGEgXCJ0eXBlXCIgb3B0aW9uIG9mICdsaW5lJyAoZGVmYXVsdCksXG4qICdiYXInLCAndHJpc3RhdGUnLCAnYnVsbGV0JywgJ2Rpc2NyZXRlJywgJ3BpZScgb3IgJ2JveCdcbiogICAgbGluZSAtIExpbmUgY2hhcnQuICBPcHRpb25zOlxuKiAgICAgICBzcG90Q29sb3IgLSBTZXQgdG8gJycgdG8gbm90IGVuZCBlYWNoIGxpbmUgaW4gYSBjaXJjdWxhciBzcG90XG4qICAgICAgIG1pblNwb3RDb2xvciAtIElmIHNldCwgY29sb3Igb2Ygc3BvdCBhdCBtaW5pbXVtIHZhbHVlXG4qICAgICAgIG1heFNwb3RDb2xvciAtIElmIHNldCwgY29sb3Igb2Ygc3BvdCBhdCBtYXhpbXVtIHZhbHVlXG4qICAgICAgIHNwb3RSYWRpdXMgLSBSYWRpdXMgaW4gcGl4ZWxzXG4qICAgICAgIGxpbmVXaWR0aCAtIFdpZHRoIG9mIGxpbmUgaW4gcGl4ZWxzXG4qICAgICAgIG5vcm1hbFJhbmdlTWluXG4qICAgICAgIG5vcm1hbFJhbmdlTWF4IC0gSWYgc2V0IGRyYXdzIGEgZmlsbGVkIGhvcml6b250YWwgYmFyIGJldHdlZW4gdGhlc2UgdHdvIHZhbHVlcyBtYXJraW5nIHRoZSBcIm5vcm1hbFwiXG4qICAgICAgICAgICAgICAgICAgICAgIG9yIGV4cGVjdGVkIHJhbmdlIG9mIHZhbHVlc1xuKiAgICAgICBub3JtYWxSYW5nZUNvbG9yIC0gQ29sb3IgdG8gdXNlIGZvciB0aGUgYWJvdmUgYmFyXG4qICAgICAgIGRyYXdOb3JtYWxPblRvcCAtIERyYXcgdGhlIG5vcm1hbCByYW5nZSBhYm92ZSB0aGUgY2hhcnQgZmlsbCBjb2xvciBpZiB0cnVlXG4qICAgICAgIGRlZmF1bHRQaXhlbHNQZXJWYWx1ZSAtIERlZmF1bHRzIHRvIDMgcGl4ZWxzIG9mIHdpZHRoIGZvciBlYWNoIHZhbHVlIGluIHRoZSBjaGFydFxuKiAgICAgICBoaWdobGlnaHRTcG90Q29sb3IgLSBUaGUgY29sb3IgdG8gdXNlIGZvciBkcmF3aW5nIGEgaGlnaGxpZ2h0IHNwb3Qgb24gbW91c2VvdmVyIC0gU2V0IHRvIG51bGwgdG8gZGlzYWJsZVxuKiAgICAgICBoaWdobGlnaHRMaW5lQ29sb3IgLSBUaGUgY29sb3IgdG8gdXNlIGZvciBkcmF3aW5nIGEgaGlnaGxpZ2h0IGxpbmUgb24gbW91c2VvdmVyIC0gU2V0IHRvIG51bGwgdG8gZGlzYWJsZVxuKiAgICAgICB2YWx1ZVNwb3RzIC0gU3BlY2lmeSB3aGljaCBwb2ludHMgdG8gZHJhdyBzcG90cyBvbiwgYW5kIGluIHdoaWNoIGNvbG9yLiAgQWNjZXB0cyBhIHJhbmdlIG1hcFxuKlxuKiAgIGJhciAtIEJhciBjaGFydC4gIE9wdGlvbnM6XG4qICAgICAgIGJhckNvbG9yIC0gQ29sb3Igb2YgYmFycyBmb3IgcG9zdGl2ZSB2YWx1ZXNcbiogICAgICAgbmVnQmFyQ29sb3IgLSBDb2xvciBvZiBiYXJzIGZvciBuZWdhdGl2ZSB2YWx1ZXNcbiogICAgICAgemVyb0NvbG9yIC0gQ29sb3Igb2YgYmFycyB3aXRoIHplcm8gdmFsdWVzXG4qICAgICAgIG51bGxDb2xvciAtIENvbG9yIG9mIGJhcnMgd2l0aCBudWxsIHZhbHVlcyAtIERlZmF1bHRzIHRvIG9taXR0aW5nIHRoZSBiYXIgZW50aXJlbHlcbiogICAgICAgYmFyV2lkdGggLSBXaWR0aCBvZiBiYXJzIGluIHBpeGVsc1xuKiAgICAgICBjb2xvck1hcCAtIE9wdGlvbmFsIG1hcHBuaWcgb2YgdmFsdWVzIHRvIGNvbG9ycyB0byBvdmVycmlkZSB0aGUgKkJhckNvbG9yIHZhbHVlcyBhYm92ZVxuKiAgICAgICAgICAgICAgICAgIGNhbiBiZSBhbiBBcnJheSBvZiB2YWx1ZXMgdG8gY29udHJvbCB0aGUgY29sb3Igb2YgaW5kaXZpZHVhbCBiYXJzIG9yIGEgcmFuZ2UgbWFwXG4qICAgICAgICAgICAgICAgICAgdG8gc3BlY2lmeSBjb2xvcnMgZm9yIGluZGl2aWR1YWwgcmFuZ2VzIG9mIHZhbHVlc1xuKiAgICAgICBiYXJTcGFjaW5nIC0gR2FwIGJldHdlZW4gYmFycyBpbiBwaXhlbHNcbiogICAgICAgemVyb0F4aXMgLSBDZW50ZXJzIHRoZSB5LWF4aXMgYXJvdW5kIHplcm8gaWYgdHJ1ZVxuKlxuKiAgIHRyaXN0YXRlIC0gQ2hhcnRzIHZhbHVlcyBvZiB3aW4gKD4wKSwgbG9zZSAoPDApIG9yIGRyYXcgKD0wKVxuKiAgICAgICBwb3NCYXJDb2xvciAtIENvbG9yIG9mIHdpbiB2YWx1ZXNcbiogICAgICAgbmVnQmFyQ29sb3IgLSBDb2xvciBvZiBsb3NlIHZhbHVlc1xuKiAgICAgICB6ZXJvQmFyQ29sb3IgLSBDb2xvciBvZiBkcmF3IHZhbHVlc1xuKiAgICAgICBiYXJXaWR0aCAtIFdpZHRoIG9mIGJhcnMgaW4gcGl4ZWxzXG4qICAgICAgIGJhclNwYWNpbmcgLSBHYXAgYmV0d2VlbiBiYXJzIGluIHBpeGVsc1xuKiAgICAgICBjb2xvck1hcCAtIE9wdGlvbmFsIG1hcHBuaWcgb2YgdmFsdWVzIHRvIGNvbG9ycyB0byBvdmVycmlkZSB0aGUgKkJhckNvbG9yIHZhbHVlcyBhYm92ZVxuKiAgICAgICAgICAgICAgICAgIGNhbiBiZSBhbiBBcnJheSBvZiB2YWx1ZXMgdG8gY29udHJvbCB0aGUgY29sb3Igb2YgaW5kaXZpZHVhbCBiYXJzIG9yIGEgcmFuZ2UgbWFwXG4qICAgICAgICAgICAgICAgICAgdG8gc3BlY2lmeSBjb2xvcnMgZm9yIGluZGl2aWR1YWwgcmFuZ2VzIG9mIHZhbHVlc1xuKlxuKiAgIGRpc2NyZXRlIC0gT3B0aW9uczpcbiogICAgICAgbGluZUhlaWdodCAtIEhlaWdodCBvZiBlYWNoIGxpbmUgaW4gcGl4ZWxzIC0gRGVmYXVsdHMgdG8gMzAlIG9mIHRoZSBncmFwaCBoZWlnaHRcbiogICAgICAgdGhlc2hvbGRWYWx1ZSAtIFZhbHVlcyBsZXNzIHRoYW4gdGhpcyB2YWx1ZSB3aWxsIGJlIGRyYXduIHVzaW5nIHRocmVzaG9sZENvbG9yIGluc3RlYWQgb2YgbGluZUNvbG9yXG4qICAgICAgIHRocmVzaG9sZENvbG9yXG4qXG4qICAgYnVsbGV0IC0gVmFsdWVzIGZvciBidWxsZXQgZ3JhcGhzIG1zdXQgYmUgaW4gdGhlIG9yZGVyOiB0YXJnZXQsIHBlcmZvcm1hbmNlLCByYW5nZTEsIHJhbmdlMiwgcmFuZ2UzLCAuLi5cbiogICAgICAgb3B0aW9uczpcbiogICAgICAgdGFyZ2V0Q29sb3IgLSBUaGUgY29sb3Igb2YgdGhlIHZlcnRpY2FsIHRhcmdldCBtYXJrZXJcbiogICAgICAgdGFyZ2V0V2lkdGggLSBUaGUgd2lkdGggb2YgdGhlIHRhcmdldCBtYXJrZXIgaW4gcGl4ZWxzXG4qICAgICAgIHBlcmZvcm1hbmNlQ29sb3IgLSBUaGUgY29sb3Igb2YgdGhlIHBlcmZvcm1hbmNlIG1lYXN1cmUgaG9yaXpvbnRhbCBiYXJcbiogICAgICAgcmFuZ2VDb2xvcnMgLSBDb2xvcnMgdG8gdXNlIGZvciBlYWNoIHF1YWxpdGF0aXZlIHJhbmdlIGJhY2tncm91bmQgY29sb3JcbipcbiogICBwaWUgLSBQaWUgY2hhcnQuIE9wdGlvbnM6XG4qICAgICAgIHNsaWNlQ29sb3JzIC0gQW4gYXJyYXkgb2YgY29sb3JzIHRvIHVzZSBmb3IgcGllIHNsaWNlc1xuKiAgICAgICBvZmZzZXQgLSBBbmdsZSBpbiBkZWdyZWVzIHRvIG9mZnNldCB0aGUgZmlyc3Qgc2xpY2UgLSBUcnkgLTkwIG9yICs5MFxuKiAgICAgICBib3JkZXJXaWR0aCAtIFdpZHRoIG9mIGJvcmRlciB0byBkcmF3IGFyb3VuZCB0aGUgcGllIGNoYXJ0LCBpbiBwaXhlbHMgLSBEZWZhdWx0cyB0byAwIChubyBib3JkZXIpXG4qICAgICAgIGJvcmRlckNvbG9yIC0gQ29sb3IgdG8gdXNlIGZvciB0aGUgcGllIGNoYXJ0IGJvcmRlciAtIERlZmF1bHRzIHRvICMwMDBcbipcbiogICBib3ggLSBCb3ggcGxvdC4gT3B0aW9uczpcbiogICAgICAgcmF3IC0gU2V0IHRvIHRydWUgdG8gc3VwcGx5IHByZS1jb21wdXRlZCBwbG90IHBvaW50cyBhcyB2YWx1ZXNcbiogICAgICAgICAgICAgdmFsdWVzIHNob3VsZCBiZTogbG93X291dGxpZXIsIGxvd193aGlza2VyLCBxMSwgbWVkaWFuLCBxMywgaGlnaF93aGlza2VyLCBoaWdoX291dGxpZXJcbiogICAgICAgICAgICAgV2hlbiBzZXQgdG8gZmFsc2UgeW91IGNhbiBzdXBwbHkgYW55IG51bWJlciBvZiB2YWx1ZXMgYW5kIHRoZSBib3ggcGxvdCB3aWxsXG4qICAgICAgICAgICAgIGJlIGNvbXB1dGVkIGZvciB5b3UuICBEZWZhdWx0IGlzIGZhbHNlLlxuKiAgICAgICBzaG93T3V0bGllcnMgLSBTZXQgdG8gdHJ1ZSAoZGVmYXVsdCkgdG8gZGlzcGxheSBvdXRsaWVycyBhcyBjaXJjbGVzXG4qICAgICAgIG91dGxpZXJJUVIgLSBJbnRlcnF1YXJ0aWxlIHJhbmdlIHVzZWQgdG8gZGV0ZXJtaW5lIG91dGxpZXJzLiAgRGVmYXVsdCAxLjVcbiogICAgICAgYm94TGluZUNvbG9yIC0gT3V0bGluZSBjb2xvciBvZiB0aGUgYm94XG4qICAgICAgIGJveEZpbGxDb2xvciAtIEZpbGwgY29sb3IgZm9yIHRoZSBib3hcbiogICAgICAgd2hpc2tlckNvbG9yIC0gTGluZSBjb2xvciB1c2VkIGZvciB3aGlza2Vyc1xuKiAgICAgICBvdXRsaWVyTGluZUNvbG9yIC0gT3V0bGluZSBjb2xvciBvZiBvdXRsaWVyIGNpcmNsZXNcbiogICAgICAgb3V0bGllckZpbGxDb2xvciAtIEZpbGwgY29sb3Igb2YgdGhlIG91dGxpZXIgY2lyY2xlc1xuKiAgICAgICBzcG90UmFkaXVzIC0gUmFkaXVzIG9mIG91dGxpZXIgY2lyY2xlc1xuKiAgICAgICBtZWRpYW5Db2xvciAtIExpbmUgY29sb3Igb2YgdGhlIG1lZGlhbiBsaW5lXG4qICAgICAgIHRhcmdldCAtIERyYXcgYSB0YXJnZXQgY3Jvc3MgaGFpciBhdCB0aGUgc3VwcGxpZWQgdmFsdWUgKGRlZmF1bHQgdW5kZWZpbmVkKVxuKlxuKlxuKlxuKiAgIEV4YW1wbGVzOlxuKiAgICQoJyNzcGFya2xpbmUxJykuc3BhcmtsaW5lKG15dmFsdWVzLCB7IGxpbmVDb2xvcjogJyNmMDAnLCBmaWxsQ29sb3I6IGZhbHNlIH0pO1xuKiAgICQoJy5iYXJzcGFya3MnKS5zcGFya2xpbmUoJ2h0bWwnLCB7IHR5cGU6J2JhcicsIGhlaWdodDonNDBweCcsIGJhcldpZHRoOjUgfSk7XG4qICAgJCgnI3RyaXN0YXRlJykuc3BhcmtsaW5lKFsxLDEsLTEsMSwwLDAsLTFdLCB7IHR5cGU6J3RyaXN0YXRlJyB9KTpcbiogICAkKCcjZGlzY3JldGUnKS5zcGFya2xpbmUoWzEsMyw0LDUsNSwzLDQsNV0sIHsgdHlwZTonZGlzY3JldGUnIH0pO1xuKiAgICQoJyNidWxsZXQnKS5zcGFya2xpbmUoWzEwLDEyLDEyLDksN10sIHsgdHlwZTonYnVsbGV0JyB9KTtcbiogICAkKCcjcGllJykuc3BhcmtsaW5lKFsxLDEsMl0sIHsgdHlwZToncGllJyB9KTtcbiovXG5cbi8qanNsaW50IHJlZ2V4cDogdHJ1ZSwgYnJvd3NlcjogdHJ1ZSwganF1ZXJ5OiB0cnVlLCB3aGl0ZTogdHJ1ZSwgbm9tZW46IGZhbHNlLCBwbHVzcGx1czogZmFsc2UsIG1heGVycjogNTAwLCBpbmRlbnQ6IDQgKi9cblxuKGZ1bmN0aW9uKGRvY3VtZW50LCBNYXRoLCB1bmRlZmluZWQpIHsgLy8gcGVyZm9ybWFuY2UvbWluaWZpZWQtc2l6ZSBvcHRpbWl6YXRpb25cbihmdW5jdGlvbihmYWN0b3J5KSB7XG4gICAgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG4gICAgICAgIGRlZmluZShbJ2pxdWVyeSddLCBmYWN0b3J5KTtcbiAgICB9IGVsc2UgaWYgKGpRdWVyeSAmJiAhalF1ZXJ5LmZuLnNwYXJrbGluZSkge1xuICAgICAgICBmYWN0b3J5KGpRdWVyeSk7XG4gICAgfVxufVxuKGZ1bmN0aW9uKCQpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICB2YXIgVU5TRVRfT1BUSU9OID0ge30sXG4gICAgICAgIGdldERlZmF1bHRzLCBjcmVhdGVDbGFzcywgU1BGb3JtYXQsIGNsaXB2YWwsIHF1YXJ0aWxlLCBub3JtYWxpemVWYWx1ZSwgbm9ybWFsaXplVmFsdWVzLFxuICAgICAgICByZW1vdmUsIGlzTnVtYmVyLCBhbGwsIHN1bSwgYWRkQ1NTLCBlbnN1cmVBcnJheSwgZm9ybWF0TnVtYmVyLCBSYW5nZU1hcCxcbiAgICAgICAgTW91c2VIYW5kbGVyLCBUb29sdGlwLCBiYXJIaWdobGlnaHRNaXhpbixcbiAgICAgICAgbGluZSwgYmFyLCB0cmlzdGF0ZSwgZGlzY3JldGUsIGJ1bGxldCwgcGllLCBib3gsIGRlZmF1bHRTdHlsZXMsIGluaXRTdHlsZXMsXG4gICAgICAgIFZTaGFwZSwgVkNhbnZhc19iYXNlLCBWQ2FudmFzX2NhbnZhcywgVkNhbnZhc192bWwsIHBlbmRpbmcsIHNoYXBlQ291bnQgPSAwO1xuXG4gICAgLyoqXG4gICAgICogRGVmYXVsdCBjb25maWd1cmF0aW9uIHNldHRpbmdzXG4gICAgICovXG4gICAgZ2V0RGVmYXVsdHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAvLyBTZXR0aW5ncyBjb21tb24gdG8gbW9zdC9hbGwgY2hhcnQgdHlwZXNcbiAgICAgICAgICAgIGNvbW1vbjoge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdsaW5lJyxcbiAgICAgICAgICAgICAgICBsaW5lQ29sb3I6ICcjMDBmJyxcbiAgICAgICAgICAgICAgICBmaWxsQ29sb3I6ICcjY2RmJyxcbiAgICAgICAgICAgICAgICBkZWZhdWx0UGl4ZWxzUGVyVmFsdWU6IDMsXG4gICAgICAgICAgICAgICAgd2lkdGg6ICdhdXRvJyxcbiAgICAgICAgICAgICAgICBoZWlnaHQ6ICdhdXRvJyxcbiAgICAgICAgICAgICAgICBjb21wb3NpdGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHRhZ1ZhbHVlc0F0dHJpYnV0ZTogJ3ZhbHVlcycsXG4gICAgICAgICAgICAgICAgdGFnT3B0aW9uc1ByZWZpeDogJ3NwYXJrJyxcbiAgICAgICAgICAgICAgICBlbmFibGVUYWdPcHRpb25zOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlbmFibGVIaWdobGlnaHQ6IHRydWUsXG4gICAgICAgICAgICAgICAgaGlnaGxpZ2h0TGlnaHRlbjogMS40LFxuICAgICAgICAgICAgICAgIHRvb2x0aXBTa2lwTnVsbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICB0b29sdGlwUHJlZml4OiAnJyxcbiAgICAgICAgICAgICAgICB0b29sdGlwU3VmZml4OiAnJyxcbiAgICAgICAgICAgICAgICBkaXNhYmxlSGlkZGVuQ2hlY2s6IGZhbHNlLFxuICAgICAgICAgICAgICAgIG51bWJlckZvcm1hdHRlcjogZmFsc2UsXG4gICAgICAgICAgICAgICAgbnVtYmVyRGlnaXRHcm91cENvdW50OiAzLFxuICAgICAgICAgICAgICAgIG51bWJlckRpZ2l0R3JvdXBTZXA6ICcsJyxcbiAgICAgICAgICAgICAgICBudW1iZXJEZWNpbWFsTWFyazogJy4nLFxuICAgICAgICAgICAgICAgIGRpc2FibGVUb29sdGlwczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZGlzYWJsZUludGVyYWN0aW9uOiBmYWxzZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIC8vIERlZmF1bHRzIGZvciBsaW5lIGNoYXJ0c1xuICAgICAgICAgICAgbGluZToge1xuICAgICAgICAgICAgICAgIHNwb3RDb2xvcjogJyNmODAnLFxuICAgICAgICAgICAgICAgIGhpZ2hsaWdodFNwb3RDb2xvcjogJyM1ZjUnLFxuICAgICAgICAgICAgICAgIGhpZ2hsaWdodExpbmVDb2xvcjogJyNmMjInLFxuICAgICAgICAgICAgICAgIHNwb3RSYWRpdXM6IDEuNSxcbiAgICAgICAgICAgICAgICBtaW5TcG90Q29sb3I6ICcjZjgwJyxcbiAgICAgICAgICAgICAgICBtYXhTcG90Q29sb3I6ICcjZjgwJyxcbiAgICAgICAgICAgICAgICBsaW5lV2lkdGg6IDEsXG4gICAgICAgICAgICAgICAgbm9ybWFsUmFuZ2VNaW46IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICBub3JtYWxSYW5nZU1heDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIG5vcm1hbFJhbmdlQ29sb3I6ICcjY2NjJyxcbiAgICAgICAgICAgICAgICBkcmF3Tm9ybWFsT25Ub3A6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGNoYXJ0UmFuZ2VNaW46IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICBjaGFydFJhbmdlTWF4OiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgY2hhcnRSYW5nZU1pblg6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICBjaGFydFJhbmdlTWF4WDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIHRvb2x0aXBGb3JtYXQ6IG5ldyBTUEZvcm1hdCgnPHNwYW4gc3R5bGU9XCJjb2xvcjoge3tjb2xvcn19XCI+JiM5Njc5Ozwvc3Bhbj4ge3twcmVmaXh9fXt7eX19e3tzdWZmaXh9fScpXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgLy8gRGVmYXVsdHMgZm9yIGJhciBjaGFydHNcbiAgICAgICAgICAgIGJhcjoge1xuICAgICAgICAgICAgICAgIGJhckNvbG9yOiAnIzMzNjZjYycsXG4gICAgICAgICAgICAgICAgbmVnQmFyQ29sb3I6ICcjZjQ0JyxcbiAgICAgICAgICAgICAgICBzdGFja2VkQmFyQ29sb3I6IFsnIzMzNjZjYycsICcjZGMzOTEyJywgJyNmZjk5MDAnLCAnIzEwOTYxOCcsICcjNjZhYTAwJyxcbiAgICAgICAgICAgICAgICAgICAgJyNkZDQ0NzcnLCAnIzAwOTljNicsICcjOTkwMDk5J10sXG4gICAgICAgICAgICAgICAgemVyb0NvbG9yOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgbnVsbENvbG9yOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgemVyb0F4aXM6IHRydWUsXG4gICAgICAgICAgICAgICAgYmFyV2lkdGg6IDQsXG4gICAgICAgICAgICAgICAgYmFyU3BhY2luZzogMSxcbiAgICAgICAgICAgICAgICBjaGFydFJhbmdlTWF4OiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgY2hhcnRSYW5nZU1pbjogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIGNoYXJ0UmFuZ2VDbGlwOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBjb2xvck1hcDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIHRvb2x0aXBGb3JtYXQ6IG5ldyBTUEZvcm1hdCgnPHNwYW4gc3R5bGU9XCJjb2xvcjoge3tjb2xvcn19XCI+JiM5Njc5Ozwvc3Bhbj4ge3twcmVmaXh9fXt7dmFsdWV9fXt7c3VmZml4fX0nKVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIC8vIERlZmF1bHRzIGZvciB0cmlzdGF0ZSBjaGFydHNcbiAgICAgICAgICAgIHRyaXN0YXRlOiB7XG4gICAgICAgICAgICAgICAgYmFyV2lkdGg6IDQsXG4gICAgICAgICAgICAgICAgYmFyU3BhY2luZzogMSxcbiAgICAgICAgICAgICAgICBwb3NCYXJDb2xvcjogJyM2ZjYnLFxuICAgICAgICAgICAgICAgIG5lZ0JhckNvbG9yOiAnI2Y0NCcsXG4gICAgICAgICAgICAgICAgemVyb0JhckNvbG9yOiAnIzk5OScsXG4gICAgICAgICAgICAgICAgY29sb3JNYXA6IHt9LFxuICAgICAgICAgICAgICAgIHRvb2x0aXBGb3JtYXQ6IG5ldyBTUEZvcm1hdCgnPHNwYW4gc3R5bGU9XCJjb2xvcjoge3tjb2xvcn19XCI+JiM5Njc5Ozwvc3Bhbj4ge3t2YWx1ZTptYXB9fScpLFxuICAgICAgICAgICAgICAgIHRvb2x0aXBWYWx1ZUxvb2t1cHM6IHsgbWFwOiB7ICctMSc6ICdMb3NzJywgJzAnOiAnRHJhdycsICcxJzogJ1dpbicgfSB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgLy8gRGVmYXVsdHMgZm9yIGRpc2NyZXRlIGNoYXJ0c1xuICAgICAgICAgICAgZGlzY3JldGU6IHtcbiAgICAgICAgICAgICAgICBsaW5lSGVpZ2h0OiAnYXV0bycsXG4gICAgICAgICAgICAgICAgdGhyZXNob2xkQ29sb3I6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICB0aHJlc2hvbGRWYWx1ZTogMCxcbiAgICAgICAgICAgICAgICBjaGFydFJhbmdlTWF4OiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgY2hhcnRSYW5nZU1pbjogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIGNoYXJ0UmFuZ2VDbGlwOiBmYWxzZSxcbiAgICAgICAgICAgICAgICB0b29sdGlwRm9ybWF0OiBuZXcgU1BGb3JtYXQoJ3t7cHJlZml4fX17e3ZhbHVlfX17e3N1ZmZpeH19JylcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvLyBEZWZhdWx0cyBmb3IgYnVsbGV0IGNoYXJ0c1xuICAgICAgICAgICAgYnVsbGV0OiB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0Q29sb3I6ICcjZjMzJyxcbiAgICAgICAgICAgICAgICB0YXJnZXRXaWR0aDogMywgLy8gd2lkdGggb2YgdGhlIHRhcmdldCBiYXIgaW4gcGl4ZWxzXG4gICAgICAgICAgICAgICAgcGVyZm9ybWFuY2VDb2xvcjogJyMzM2YnLFxuICAgICAgICAgICAgICAgIHJhbmdlQ29sb3JzOiBbJyNkM2RhZmUnLCAnI2E4YjZmZicsICcjN2Y5NGZmJ10sXG4gICAgICAgICAgICAgICAgYmFzZTogdW5kZWZpbmVkLCAvLyBzZXQgdGhpcyB0byBhIG51bWJlciB0byBjaGFuZ2UgdGhlIGJhc2Ugc3RhcnQgbnVtYmVyXG4gICAgICAgICAgICAgICAgdG9vbHRpcEZvcm1hdDogbmV3IFNQRm9ybWF0KCd7e2ZpZWxka2V5OmZpZWxkc319IC0ge3t2YWx1ZX19JyksXG4gICAgICAgICAgICAgICAgdG9vbHRpcFZhbHVlTG9va3VwczogeyBmaWVsZHM6IHtyOiAnUmFuZ2UnLCBwOiAnUGVyZm9ybWFuY2UnLCB0OiAnVGFyZ2V0J30gfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIC8vIERlZmF1bHRzIGZvciBwaWUgY2hhcnRzXG4gICAgICAgICAgICBwaWU6IHtcbiAgICAgICAgICAgICAgICBvZmZzZXQ6IDAsXG4gICAgICAgICAgICAgICAgc2xpY2VDb2xvcnM6IFsnIzMzNjZjYycsICcjZGMzOTEyJywgJyNmZjk5MDAnLCAnIzEwOTYxOCcsICcjNjZhYTAwJyxcbiAgICAgICAgICAgICAgICAgICAgJyNkZDQ0NzcnLCAnIzAwOTljNicsICcjOTkwMDk5J10sXG4gICAgICAgICAgICAgICAgYm9yZGVyV2lkdGg6IDAsXG4gICAgICAgICAgICAgICAgYm9yZGVyQ29sb3I6ICcjMDAwJyxcbiAgICAgICAgICAgICAgICB0b29sdGlwRm9ybWF0OiBuZXcgU1BGb3JtYXQoJzxzcGFuIHN0eWxlPVwiY29sb3I6IHt7Y29sb3J9fVwiPiYjOTY3OTs8L3NwYW4+IHt7dmFsdWV9fSAoe3twZXJjZW50LjF9fSUpJylcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvLyBEZWZhdWx0cyBmb3IgYm94IHBsb3RzXG4gICAgICAgICAgICBib3g6IHtcbiAgICAgICAgICAgICAgICByYXc6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGJveExpbmVDb2xvcjogJyMwMDAnLFxuICAgICAgICAgICAgICAgIGJveEZpbGxDb2xvcjogJyNjZGYnLFxuICAgICAgICAgICAgICAgIHdoaXNrZXJDb2xvcjogJyMwMDAnLFxuICAgICAgICAgICAgICAgIG91dGxpZXJMaW5lQ29sb3I6ICcjMzMzJyxcbiAgICAgICAgICAgICAgICBvdXRsaWVyRmlsbENvbG9yOiAnI2ZmZicsXG4gICAgICAgICAgICAgICAgbWVkaWFuQ29sb3I6ICcjZjAwJyxcbiAgICAgICAgICAgICAgICBzaG93T3V0bGllcnM6IHRydWUsXG4gICAgICAgICAgICAgICAgb3V0bGllcklRUjogMS41LFxuICAgICAgICAgICAgICAgIHNwb3RSYWRpdXM6IDEuNSxcbiAgICAgICAgICAgICAgICB0YXJnZXQ6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICB0YXJnZXRDb2xvcjogJyM0YTInLFxuICAgICAgICAgICAgICAgIGNoYXJ0UmFuZ2VNYXg6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICBjaGFydFJhbmdlTWluOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgdG9vbHRpcEZvcm1hdDogbmV3IFNQRm9ybWF0KCd7e2ZpZWxkOmZpZWxkc319OiB7e3ZhbHVlfX0nKSxcbiAgICAgICAgICAgICAgICB0b29sdGlwRm9ybWF0RmllbGRsaXN0S2V5OiAnZmllbGQnLFxuICAgICAgICAgICAgICAgIHRvb2x0aXBWYWx1ZUxvb2t1cHM6IHsgZmllbGRzOiB7IGxxOiAnTG93ZXIgUXVhcnRpbGUnLCBtZWQ6ICdNZWRpYW4nLFxuICAgICAgICAgICAgICAgICAgICB1cTogJ1VwcGVyIFF1YXJ0aWxlJywgbG86ICdMZWZ0IE91dGxpZXInLCBybzogJ1JpZ2h0IE91dGxpZXInLFxuICAgICAgICAgICAgICAgICAgICBsdzogJ0xlZnQgV2hpc2tlcicsIHJ3OiAnUmlnaHQgV2hpc2tlcid9IH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgLy8gWW91IGNhbiBoYXZlIHRvb2x0aXBzIHVzZSBhIGNzcyBjbGFzcyBvdGhlciB0aGFuIGpxc3Rvb2x0aXAgYnkgc3BlY2lmeWluZyB0b29sdGlwQ2xhc3NuYW1lXG4gICAgZGVmYXVsdFN0eWxlcyA9ICcuanFzdG9vbHRpcCB7ICcgK1xuICAgICAgICAgICAgJ3Bvc2l0aW9uOiBhYnNvbHV0ZTsnICtcbiAgICAgICAgICAgICdsZWZ0OiAwcHg7JyArXG4gICAgICAgICAgICAndG9wOiAwcHg7JyArXG4gICAgICAgICAgICAndmlzaWJpbGl0eTogaGlkZGVuOycgK1xuICAgICAgICAgICAgJ2JhY2tncm91bmQ6IHJnYigwLCAwLCAwKSB0cmFuc3BhcmVudDsnICtcbiAgICAgICAgICAgICdiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDAsMCwwLDAuNik7JyArXG4gICAgICAgICAgICAnZmlsdGVyOnByb2dpZDpEWEltYWdlVHJhbnNmb3JtLk1pY3Jvc29mdC5ncmFkaWVudChzdGFydENvbG9yc3RyPSM5OTAwMDAwMCwgZW5kQ29sb3JzdHI9Izk5MDAwMDAwKTsnICtcbiAgICAgICAgICAgICctbXMtZmlsdGVyOiBcInByb2dpZDpEWEltYWdlVHJhbnNmb3JtLk1pY3Jvc29mdC5ncmFkaWVudChzdGFydENvbG9yc3RyPSM5OTAwMDAwMCwgZW5kQ29sb3JzdHI9Izk5MDAwMDAwKVwiOycgK1xuICAgICAgICAgICAgJ2NvbG9yOiB3aGl0ZTsnICtcbiAgICAgICAgICAgICdmb250OiAxMHB4IGFyaWFsLCBzYW4gc2VyaWY7JyArXG4gICAgICAgICAgICAndGV4dC1hbGlnbjogbGVmdDsnICtcbiAgICAgICAgICAgICd3aGl0ZS1zcGFjZTogbm93cmFwOycgK1xuICAgICAgICAgICAgJ3BhZGRpbmc6IDVweDsnICtcbiAgICAgICAgICAgICdib3JkZXI6IDFweCBzb2xpZCB3aGl0ZTsnICtcbiAgICAgICAgICAgICdib3gtc2l6aW5nOiBjb250ZW50LWJveDsnICtcbiAgICAgICAgICAgICd6LWluZGV4OiAxMDAwMDsnICtcbiAgICAgICAgICAgICd9JyArXG4gICAgICAgICAgICAnLmpxc2ZpZWxkIHsgJyArXG4gICAgICAgICAgICAnY29sb3I6IHdoaXRlOycgK1xuICAgICAgICAgICAgJ2ZvbnQ6IDEwcHggYXJpYWwsIHNhbiBzZXJpZjsnICtcbiAgICAgICAgICAgICd0ZXh0LWFsaWduOiBsZWZ0OycgK1xuICAgICAgICAgICAgJ30nO1xuXG4gICAgLyoqXG4gICAgICogVXRpbGl0aWVzXG4gICAgICovXG5cbiAgICBjcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgvKiBbYmFzZWNsYXNzLCBbbWl4aW4sIC4uLl1dLCBkZWZpbml0aW9uICovKSB7XG4gICAgICAgIHZhciBDbGFzcywgYXJncztcbiAgICAgICAgQ2xhc3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLmluaXQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICBpZiAoYXJndW1lbnRzWzBdKSB7XG4gICAgICAgICAgICAgICAgQ2xhc3MucHJvdG90eXBlID0gJC5leHRlbmQobmV3IGFyZ3VtZW50c1swXSgpLCBhcmd1bWVudHNbYXJndW1lbnRzLmxlbmd0aCAtIDFdKTtcbiAgICAgICAgICAgICAgICBDbGFzcy5fc3VwZXIgPSBhcmd1bWVudHNbMF0ucHJvdG90eXBlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBDbGFzcy5wcm90b3R5cGUgPSBhcmd1bWVudHNbYXJndW1lbnRzLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAyKSB7XG4gICAgICAgICAgICAgICAgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSwgLTEpO1xuICAgICAgICAgICAgICAgIGFyZ3MudW5zaGlmdChDbGFzcy5wcm90b3R5cGUpO1xuICAgICAgICAgICAgICAgICQuZXh0ZW5kLmFwcGx5KCQsIGFyZ3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgQ2xhc3MucHJvdG90eXBlID0gYXJndW1lbnRzWzBdO1xuICAgICAgICB9XG4gICAgICAgIENsYXNzLnByb3RvdHlwZS5jbHMgPSBDbGFzcztcbiAgICAgICAgcmV0dXJuIENsYXNzO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBXcmFwcyBhIGZvcm1hdCBzdHJpbmcgZm9yIHRvb2x0aXBzXG4gICAgICoge3t4fX1cbiAgICAgKiB7e3guMn1cbiAgICAgKiB7e3g6bW9udGhzfX1cbiAgICAgKi9cbiAgICAkLlNQRm9ybWF0Q2xhc3MgPSBTUEZvcm1hdCA9IGNyZWF0ZUNsYXNzKHtcbiAgICAgICAgZnJlOiAvXFx7XFx7KFtcXHcuXSs/KSg6KC4rPykpP1xcfVxcfS9nLFxuICAgICAgICBwcmVjcmU6IC8oXFx3KylcXC4oXFxkKykvLFxuXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uIChmb3JtYXQsIGZjbGFzcykge1xuICAgICAgICAgICAgdGhpcy5mb3JtYXQgPSBmb3JtYXQ7XG4gICAgICAgICAgICB0aGlzLmZjbGFzcyA9IGZjbGFzcztcbiAgICAgICAgfSxcblxuICAgICAgICByZW5kZXI6IGZ1bmN0aW9uIChmaWVsZHNldCwgbG9va3Vwcywgb3B0aW9ucykge1xuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzLFxuICAgICAgICAgICAgICAgIGZpZWxkcyA9IGZpZWxkc2V0LFxuICAgICAgICAgICAgICAgIG1hdGNoLCB0b2tlbiwgbG9va3Vwa2V5LCBmaWVsZHZhbHVlLCBwcmVjO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZm9ybWF0LnJlcGxhY2UodGhpcy5mcmUsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgbG9va3VwO1xuICAgICAgICAgICAgICAgIHRva2VuID0gYXJndW1lbnRzWzFdO1xuICAgICAgICAgICAgICAgIGxvb2t1cGtleSA9IGFyZ3VtZW50c1szXTtcbiAgICAgICAgICAgICAgICBtYXRjaCA9IHNlbGYucHJlY3JlLmV4ZWModG9rZW4pO1xuICAgICAgICAgICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgICAgICAgICAgICBwcmVjID0gbWF0Y2hbMl07XG4gICAgICAgICAgICAgICAgICAgIHRva2VuID0gbWF0Y2hbMV07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcHJlYyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmaWVsZHZhbHVlID0gZmllbGRzW3Rva2VuXTtcbiAgICAgICAgICAgICAgICBpZiAoZmllbGR2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGxvb2t1cGtleSAmJiBsb29rdXBzICYmIGxvb2t1cHNbbG9va3Vwa2V5XSkge1xuICAgICAgICAgICAgICAgICAgICBsb29rdXAgPSBsb29rdXBzW2xvb2t1cGtleV07XG4gICAgICAgICAgICAgICAgICAgIGlmIChsb29rdXAuZ2V0KSB7IC8vIFJhbmdlTWFwXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbG9va3Vwc1tsb29rdXBrZXldLmdldChmaWVsZHZhbHVlKSB8fCBmaWVsZHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxvb2t1cHNbbG9va3Vwa2V5XVtmaWVsZHZhbHVlXSB8fCBmaWVsZHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChpc051bWJlcihmaWVsZHZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5nZXQoJ251bWJlckZvcm1hdHRlcicpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaWVsZHZhbHVlID0gb3B0aW9ucy5nZXQoJ251bWJlckZvcm1hdHRlcicpKGZpZWxkdmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZmllbGR2YWx1ZSA9IGZvcm1hdE51bWJlcihmaWVsZHZhbHVlLCBwcmVjLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZ2V0KCdudW1iZXJEaWdpdEdyb3VwQ291bnQnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmdldCgnbnVtYmVyRGlnaXRHcm91cFNlcCcpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZ2V0KCdudW1iZXJEZWNpbWFsTWFyaycpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gZmllbGR2YWx1ZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBjb252aWVuY2UgbWV0aG9kIHRvIGF2b2lkIG5lZWRpbmcgdGhlIG5ldyBvcGVyYXRvclxuICAgICQuc3Bmb3JtYXQgPSBmdW5jdGlvbihmb3JtYXQsIGZjbGFzcykge1xuICAgICAgICByZXR1cm4gbmV3IFNQRm9ybWF0KGZvcm1hdCwgZmNsYXNzKTtcbiAgICB9O1xuXG4gICAgY2xpcHZhbCA9IGZ1bmN0aW9uICh2YWwsIG1pbiwgbWF4KSB7XG4gICAgICAgIGlmICh2YWwgPCBtaW4pIHtcbiAgICAgICAgICAgIHJldHVybiBtaW47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZhbCA+IG1heCkge1xuICAgICAgICAgICAgcmV0dXJuIG1heDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsO1xuICAgIH07XG5cbiAgICBxdWFydGlsZSA9IGZ1bmN0aW9uICh2YWx1ZXMsIHEpIHtcbiAgICAgICAgdmFyIHZsO1xuICAgICAgICBpZiAocSA9PT0gMikge1xuICAgICAgICAgICAgdmwgPSBNYXRoLmZsb29yKHZhbHVlcy5sZW5ndGggLyAyKTtcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZXMubGVuZ3RoICUgMiA/IHZhbHVlc1t2bF0gOiAodmFsdWVzW3ZsLTFdICsgdmFsdWVzW3ZsXSkgLyAyO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKHZhbHVlcy5sZW5ndGggJSAyICkgeyAvLyBvZGRcbiAgICAgICAgICAgICAgICB2bCA9ICh2YWx1ZXMubGVuZ3RoICogcSArIHEpIC8gNDtcbiAgICAgICAgICAgICAgICByZXR1cm4gdmwgJSAxID8gKHZhbHVlc1tNYXRoLmZsb29yKHZsKV0gKyB2YWx1ZXNbTWF0aC5mbG9vcih2bCkgLSAxXSkgLyAyIDogdmFsdWVzW3ZsLTFdO1xuICAgICAgICAgICAgfSBlbHNlIHsgLy9ldmVuXG4gICAgICAgICAgICAgICAgdmwgPSAodmFsdWVzLmxlbmd0aCAqIHEgKyAyKSAvIDQ7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZsICUgMSA/ICh2YWx1ZXNbTWF0aC5mbG9vcih2bCldICsgdmFsdWVzW01hdGguZmxvb3IodmwpIC0gMV0pIC8gMiA6ICB2YWx1ZXNbdmwtMV07XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBub3JtYWxpemVWYWx1ZSA9IGZ1bmN0aW9uICh2YWwpIHtcbiAgICAgICAgdmFyIG5mO1xuICAgICAgICBzd2l0Y2ggKHZhbCkge1xuICAgICAgICAgICAgY2FzZSAndW5kZWZpbmVkJzpcbiAgICAgICAgICAgICAgICB2YWwgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdudWxsJzpcbiAgICAgICAgICAgICAgICB2YWwgPSBudWxsO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAndHJ1ZSc6XG4gICAgICAgICAgICAgICAgdmFsID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2ZhbHNlJzpcbiAgICAgICAgICAgICAgICB2YWwgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgbmYgPSBwYXJzZUZsb2F0KHZhbCk7XG4gICAgICAgICAgICAgICAgaWYgKHZhbCA9PSBuZikge1xuICAgICAgICAgICAgICAgICAgICB2YWwgPSBuZjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbDtcbiAgICB9O1xuXG4gICAgbm9ybWFsaXplVmFsdWVzID0gZnVuY3Rpb24gKHZhbHMpIHtcbiAgICAgICAgdmFyIGksIHJlc3VsdCA9IFtdO1xuICAgICAgICBmb3IgKGkgPSB2YWxzLmxlbmd0aDsgaS0tOykge1xuICAgICAgICAgICAgcmVzdWx0W2ldID0gbm9ybWFsaXplVmFsdWUodmFsc1tpXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuXG4gICAgcmVtb3ZlID0gZnVuY3Rpb24gKHZhbHMsIGZpbHRlcikge1xuICAgICAgICB2YXIgaSwgdmwsIHJlc3VsdCA9IFtdO1xuICAgICAgICBmb3IgKGkgPSAwLCB2bCA9IHZhbHMubGVuZ3RoOyBpIDwgdmw7IGkrKykge1xuICAgICAgICAgICAgaWYgKHZhbHNbaV0gIT09IGZpbHRlcikge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHZhbHNbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcblxuICAgIGlzTnVtYmVyID0gZnVuY3Rpb24gKG51bSkge1xuICAgICAgICByZXR1cm4gIWlzTmFOKHBhcnNlRmxvYXQobnVtKSkgJiYgaXNGaW5pdGUobnVtKTtcbiAgICB9O1xuXG4gICAgZm9ybWF0TnVtYmVyID0gZnVuY3Rpb24gKG51bSwgcHJlYywgZ3JvdXBzaXplLCBncm91cHNlcCwgZGVjc2VwKSB7XG4gICAgICAgIHZhciBwLCBpO1xuICAgICAgICBudW0gPSAocHJlYyA9PT0gZmFsc2UgPyBwYXJzZUZsb2F0KG51bSkudG9TdHJpbmcoKSA6IG51bS50b0ZpeGVkKHByZWMpKS5zcGxpdCgnJyk7XG4gICAgICAgIHAgPSAocCA9ICQuaW5BcnJheSgnLicsIG51bSkpIDwgMCA/IG51bS5sZW5ndGggOiBwO1xuICAgICAgICBpZiAocCA8IG51bS5sZW5ndGgpIHtcbiAgICAgICAgICAgIG51bVtwXSA9IGRlY3NlcDtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGkgPSBwIC0gZ3JvdXBzaXplOyBpID4gMDsgaSAtPSBncm91cHNpemUpIHtcbiAgICAgICAgICAgIG51bS5zcGxpY2UoaSwgMCwgZ3JvdXBzZXApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudW0uam9pbignJyk7XG4gICAgfTtcblxuICAgIC8vIGRldGVybWluZSBpZiBhbGwgdmFsdWVzIG9mIGFuIGFycmF5IG1hdGNoIGEgdmFsdWVcbiAgICAvLyByZXR1cm5zIHRydWUgaWYgdGhlIGFycmF5IGlzIGVtcHR5XG4gICAgYWxsID0gZnVuY3Rpb24gKHZhbCwgYXJyLCBpZ25vcmVOdWxsKSB7XG4gICAgICAgIHZhciBpO1xuICAgICAgICBmb3IgKGkgPSBhcnIubGVuZ3RoOyBpLS07ICkge1xuICAgICAgICAgICAgaWYgKGlnbm9yZU51bGwgJiYgYXJyW2ldID09PSBudWxsKSBjb250aW51ZTtcbiAgICAgICAgICAgIGlmIChhcnJbaV0gIT09IHZhbCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuXG4gICAgLy8gc3VtcyB0aGUgbnVtZXJpYyB2YWx1ZXMgaW4gYW4gYXJyYXksIGlnbm9yaW5nIG90aGVyIHZhbHVlc1xuICAgIHN1bSA9IGZ1bmN0aW9uICh2YWxzKSB7XG4gICAgICAgIHZhciB0b3RhbCA9IDAsIGk7XG4gICAgICAgIGZvciAoaSA9IHZhbHMubGVuZ3RoOyBpLS07KSB7XG4gICAgICAgICAgICB0b3RhbCArPSB0eXBlb2YgdmFsc1tpXSA9PT0gJ251bWJlcicgPyB2YWxzW2ldIDogMDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWw7XG4gICAgfTtcblxuICAgIGVuc3VyZUFycmF5ID0gZnVuY3Rpb24gKHZhbCkge1xuICAgICAgICByZXR1cm4gJC5pc0FycmF5KHZhbCkgPyB2YWwgOiBbdmFsXTtcbiAgICB9O1xuXG4gICAgLy8gaHR0cDovL3BhdWxpcmlzaC5jb20vMjAwOC9ib29rbWFya2xldC1pbmplY3QtbmV3LWNzcy1ydWxlcy9cbiAgICBhZGRDU1MgPSBmdW5jdGlvbihjc3MpIHtcbiAgICAgICAgdmFyIHRhZywgaWVmYWlsO1xuICAgICAgICBpZiAoZG9jdW1lbnQuY3JlYXRlU3R5bGVTaGVldCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5jcmVhdGVTdHlsZVNoZWV0KCkuY3NzVGV4dCA9IGNzcztcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgLy8gSUUgPD0gOSBtYXhlcyBvdXQgYXQgMzEgc3R5bGVzaGVldHM7IGluamVjdCBpbnRvIHBhZ2UgaW5zdGVhZC5cbiAgICAgICAgICAgICAgICBpZWZhaWwgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRhZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7XG4gICAgICAgIHRhZy50eXBlID0gJ3RleHQvY3NzJztcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2hlYWQnKVswXS5hcHBlbmRDaGlsZCh0YWcpO1xuICAgICAgICBpZiAoaWVmYWlsKSB7XG4gICAgICAgICAgICBkb2N1bWVudC5zdHlsZVNoZWV0c1tkb2N1bWVudC5zdHlsZVNoZWV0cy5sZW5ndGggLSAxXS5jc3NUZXh0ID0gY3NzO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGFnWyh0eXBlb2YgZG9jdW1lbnQuYm9keS5zdHlsZS5XZWJraXRBcHBlYXJhbmNlID09ICdzdHJpbmcnKSAvKiB3ZWJraXQgb25seSAqLyA/ICdpbm5lclRleHQnIDogJ2lubmVySFRNTCddID0gY3NzO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIC8vIFByb3ZpZGUgYSBjcm9zcy1icm93c2VyIGludGVyZmFjZSB0byBhIGZldyBzaW1wbGUgZHJhd2luZyBwcmltaXRpdmVzXG4gICAgJC5mbi5zaW1wbGVkcmF3ID0gZnVuY3Rpb24gKHdpZHRoLCBoZWlnaHQsIHVzZUV4aXN0aW5nLCBpbnRlcmFjdCkge1xuICAgICAgICB2YXIgdGFyZ2V0LCBtaGFuZGxlcjtcbiAgICAgICAgaWYgKHVzZUV4aXN0aW5nICYmICh0YXJnZXQgPSB0aGlzLmRhdGEoJ19qcXNfdmNhbnZhcycpKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRhcmdldDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICgkLmZuLnNwYXJrbGluZS5jYW52YXMgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAvLyBXZSd2ZSBhbHJlYWR5IGRldGVybWluZWQgdGhhdCBuZWl0aGVyIENhbnZhcyBub3IgVk1MIGFyZSBhdmFpbGFibGVcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcblxuICAgICAgICB9IGVsc2UgaWYgKCQuZm4uc3BhcmtsaW5lLmNhbnZhcyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAvLyBObyBmdW5jdGlvbiBkZWZpbmVkIHlldCAtLSBuZWVkIHRvIHNlZSBpZiB3ZSBzdXBwb3J0IENhbnZhcyBvciBWTUxcbiAgICAgICAgICAgIHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuICAgICAgICAgICAgaWYgKCEhKGVsLmdldENvbnRleHQgJiYgZWwuZ2V0Q29udGV4dCgnMmQnKSkpIHtcbiAgICAgICAgICAgICAgICAvLyBDYW52YXMgaXMgYXZhaWxhYmxlXG4gICAgICAgICAgICAgICAgJC5mbi5zcGFya2xpbmUuY2FudmFzID0gZnVuY3Rpb24od2lkdGgsIGhlaWdodCwgdGFyZ2V0LCBpbnRlcmFjdCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFZDYW52YXNfY2FudmFzKHdpZHRoLCBoZWlnaHQsIHRhcmdldCwgaW50ZXJhY3QpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGRvY3VtZW50Lm5hbWVzcGFjZXMgJiYgIWRvY3VtZW50Lm5hbWVzcGFjZXMudikge1xuICAgICAgICAgICAgICAgIC8vIFZNTCBpcyBhdmFpbGFibGVcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5uYW1lc3BhY2VzLmFkZCgndicsICd1cm46c2NoZW1hcy1taWNyb3NvZnQtY29tOnZtbCcsICcjZGVmYXVsdCNWTUwnKTtcbiAgICAgICAgICAgICAgICAkLmZuLnNwYXJrbGluZS5jYW52YXMgPSBmdW5jdGlvbih3aWR0aCwgaGVpZ2h0LCB0YXJnZXQsIGludGVyYWN0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVkNhbnZhc192bWwod2lkdGgsIGhlaWdodCwgdGFyZ2V0KTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBOZWl0aGVyIENhbnZhcyBub3IgVk1MIGFyZSBhdmFpbGFibGVcbiAgICAgICAgICAgICAgICAkLmZuLnNwYXJrbGluZS5jYW52YXMgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAod2lkdGggPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgd2lkdGggPSAkKHRoaXMpLmlubmVyV2lkdGgoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaGVpZ2h0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGhlaWdodCA9ICQodGhpcykuaW5uZXJIZWlnaHQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRhcmdldCA9ICQuZm4uc3BhcmtsaW5lLmNhbnZhcyh3aWR0aCwgaGVpZ2h0LCB0aGlzLCBpbnRlcmFjdCk7XG5cbiAgICAgICAgbWhhbmRsZXIgPSAkKHRoaXMpLmRhdGEoJ19qcXNfbWhhbmRsZXInKTtcbiAgICAgICAgaWYgKG1oYW5kbGVyKSB7XG4gICAgICAgICAgICBtaGFuZGxlci5yZWdpc3RlckNhbnZhcyh0YXJnZXQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0YXJnZXQ7XG4gICAgfTtcblxuICAgICQuZm4uY2xlYXJkcmF3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdGFyZ2V0ID0gdGhpcy5kYXRhKCdfanFzX3ZjYW52YXMnKTtcbiAgICAgICAgaWYgKHRhcmdldCkge1xuICAgICAgICAgICAgdGFyZ2V0LnJlc2V0KCk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgJC5SYW5nZU1hcENsYXNzID0gUmFuZ2VNYXAgPSBjcmVhdGVDbGFzcyh7XG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uIChtYXApIHtcbiAgICAgICAgICAgIHZhciBrZXksIHJhbmdlLCByYW5nZWxpc3QgPSBbXTtcbiAgICAgICAgICAgIGZvciAoa2V5IGluIG1hcCkge1xuICAgICAgICAgICAgICAgIGlmIChtYXAuaGFzT3duUHJvcGVydHkoa2V5KSAmJiB0eXBlb2Yga2V5ID09PSAnc3RyaW5nJyAmJiBrZXkuaW5kZXhPZignOicpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmFuZ2UgPSBrZXkuc3BsaXQoJzonKTtcbiAgICAgICAgICAgICAgICAgICAgcmFuZ2VbMF0gPSByYW5nZVswXS5sZW5ndGggPT09IDAgPyAtSW5maW5pdHkgOiBwYXJzZUZsb2F0KHJhbmdlWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgcmFuZ2VbMV0gPSByYW5nZVsxXS5sZW5ndGggPT09IDAgPyBJbmZpbml0eSA6IHBhcnNlRmxvYXQocmFuZ2VbMV0pO1xuICAgICAgICAgICAgICAgICAgICByYW5nZVsyXSA9IG1hcFtrZXldO1xuICAgICAgICAgICAgICAgICAgICByYW5nZWxpc3QucHVzaChyYW5nZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5tYXAgPSBtYXA7XG4gICAgICAgICAgICB0aGlzLnJhbmdlbGlzdCA9IHJhbmdlbGlzdCB8fCBmYWxzZTtcbiAgICAgICAgfSxcblxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdmFyIHJhbmdlbGlzdCA9IHRoaXMucmFuZ2VsaXN0LFxuICAgICAgICAgICAgICAgIGksIHJhbmdlLCByZXN1bHQ7XG4gICAgICAgICAgICBpZiAoKHJlc3VsdCA9IHRoaXMubWFwW3ZhbHVlXSkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocmFuZ2VsaXN0KSB7XG4gICAgICAgICAgICAgICAgZm9yIChpID0gcmFuZ2VsaXN0Lmxlbmd0aDsgaS0tOykge1xuICAgICAgICAgICAgICAgICAgICByYW5nZSA9IHJhbmdlbGlzdFtpXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJhbmdlWzBdIDw9IHZhbHVlICYmIHJhbmdlWzFdID49IHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmFuZ2VbMl07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBDb252ZW5pZW5jZSBmdW5jdGlvblxuICAgICQucmFuZ2VfbWFwID0gZnVuY3Rpb24obWFwKSB7XG4gICAgICAgIHJldHVybiBuZXcgUmFuZ2VNYXAobWFwKTtcbiAgICB9O1xuXG4gICAgTW91c2VIYW5kbGVyID0gY3JlYXRlQ2xhc3Moe1xuICAgICAgICBpbml0OiBmdW5jdGlvbiAoZWwsIG9wdGlvbnMpIHtcbiAgICAgICAgICAgIHZhciAkZWwgPSAkKGVsKTtcbiAgICAgICAgICAgIHRoaXMuJGVsID0gJGVsO1xuICAgICAgICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFBhZ2VYID0gMDtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFBhZ2VZID0gMDtcbiAgICAgICAgICAgIHRoaXMuZWwgPSBlbDtcbiAgICAgICAgICAgIHRoaXMuc3BsaXN0ID0gW107XG4gICAgICAgICAgICB0aGlzLnRvb2x0aXAgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5vdmVyID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmRpc3BsYXlUb29sdGlwcyA9ICFvcHRpb25zLmdldCgnZGlzYWJsZVRvb2x0aXBzJyk7XG4gICAgICAgICAgICB0aGlzLmhpZ2hsaWdodEVuYWJsZWQgPSAhb3B0aW9ucy5nZXQoJ2Rpc2FibGVIaWdobGlnaHQnKTtcbiAgICAgICAgfSxcblxuICAgICAgICByZWdpc3RlclNwYXJrbGluZTogZnVuY3Rpb24gKHNwKSB7XG4gICAgICAgICAgICB0aGlzLnNwbGlzdC5wdXNoKHNwKTtcbiAgICAgICAgICAgIGlmICh0aGlzLm92ZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZURpc3BsYXkoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICByZWdpc3RlckNhbnZhczogZnVuY3Rpb24gKGNhbnZhcykge1xuICAgICAgICAgICAgdmFyICRjYW52YXMgPSAkKGNhbnZhcy5jYW52YXMpO1xuICAgICAgICAgICAgdGhpcy5jYW52YXMgPSBjYW52YXM7XG4gICAgICAgICAgICB0aGlzLiRjYW52YXMgPSAkY2FudmFzO1xuICAgICAgICAgICAgJGNhbnZhcy5tb3VzZWVudGVyKCQucHJveHkodGhpcy5tb3VzZWVudGVyLCB0aGlzKSk7XG4gICAgICAgICAgICAkY2FudmFzLm1vdXNlbGVhdmUoJC5wcm94eSh0aGlzLm1vdXNlbGVhdmUsIHRoaXMpKTtcbiAgICAgICAgICAgICRjYW52YXMuY2xpY2soJC5wcm94eSh0aGlzLm1vdXNlY2xpY2ssIHRoaXMpKTtcbiAgICAgICAgfSxcblxuICAgICAgICByZXNldDogZnVuY3Rpb24gKHJlbW92ZVRvb2x0aXApIHtcbiAgICAgICAgICAgIHRoaXMuc3BsaXN0ID0gW107XG4gICAgICAgICAgICBpZiAodGhpcy50b29sdGlwICYmIHJlbW92ZVRvb2x0aXApIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRvb2x0aXAucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgdGhpcy50b29sdGlwID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIG1vdXNlY2xpY2s6IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICB2YXIgY2xpY2tFdmVudCA9ICQuRXZlbnQoJ3NwYXJrbGluZUNsaWNrJyk7XG4gICAgICAgICAgICBjbGlja0V2ZW50Lm9yaWdpbmFsRXZlbnQgPSBlO1xuICAgICAgICAgICAgY2xpY2tFdmVudC5zcGFya2xpbmVzID0gdGhpcy5zcGxpc3Q7XG4gICAgICAgICAgICB0aGlzLiRlbC50cmlnZ2VyKGNsaWNrRXZlbnQpO1xuICAgICAgICB9LFxuXG4gICAgICAgIG1vdXNlZW50ZXI6IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAkKGRvY3VtZW50LmJvZHkpLnVuYmluZCgnbW91c2Vtb3ZlLmpxcycpO1xuICAgICAgICAgICAgJChkb2N1bWVudC5ib2R5KS5iaW5kKCdtb3VzZW1vdmUuanFzJywgJC5wcm94eSh0aGlzLm1vdXNlbW92ZSwgdGhpcykpO1xuICAgICAgICAgICAgdGhpcy5vdmVyID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFBhZ2VYID0gZS5wYWdlWDtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFBhZ2VZID0gZS5wYWdlWTtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudEVsID0gZS50YXJnZXQ7XG4gICAgICAgICAgICBpZiAoIXRoaXMudG9vbHRpcCAmJiB0aGlzLmRpc3BsYXlUb29sdGlwcykge1xuICAgICAgICAgICAgICAgIHRoaXMudG9vbHRpcCA9IG5ldyBUb29sdGlwKHRoaXMub3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgdGhpcy50b29sdGlwLnVwZGF0ZVBvc2l0aW9uKGUucGFnZVgsIGUucGFnZVkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy51cGRhdGVEaXNwbGF5KCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgbW91c2VsZWF2ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJChkb2N1bWVudC5ib2R5KS51bmJpbmQoJ21vdXNlbW92ZS5qcXMnKTtcbiAgICAgICAgICAgIHZhciBzcGxpc3QgPSB0aGlzLnNwbGlzdCxcbiAgICAgICAgICAgICAgICAgc3Bjb3VudCA9IHNwbGlzdC5sZW5ndGgsXG4gICAgICAgICAgICAgICAgIG5lZWRzUmVmcmVzaCA9IGZhbHNlLFxuICAgICAgICAgICAgICAgICBzcCwgaTtcbiAgICAgICAgICAgIHRoaXMub3ZlciA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50RWwgPSBudWxsO1xuXG4gICAgICAgICAgICBpZiAodGhpcy50b29sdGlwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy50b29sdGlwLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIHRoaXMudG9vbHRpcCA9IG51bGw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBzcGNvdW50OyBpKyspIHtcbiAgICAgICAgICAgICAgICBzcCA9IHNwbGlzdFtpXTtcbiAgICAgICAgICAgICAgICBpZiAoc3AuY2xlYXJSZWdpb25IaWdobGlnaHQoKSkge1xuICAgICAgICAgICAgICAgICAgICBuZWVkc1JlZnJlc2ggPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKG5lZWRzUmVmcmVzaCkge1xuICAgICAgICAgICAgICAgIHRoaXMuY2FudmFzLnJlbmRlcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIG1vdXNlbW92ZTogZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFBhZ2VYID0gZS5wYWdlWDtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFBhZ2VZID0gZS5wYWdlWTtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudEVsID0gZS50YXJnZXQ7XG4gICAgICAgICAgICBpZiAodGhpcy50b29sdGlwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy50b29sdGlwLnVwZGF0ZVBvc2l0aW9uKGUucGFnZVgsIGUucGFnZVkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy51cGRhdGVEaXNwbGF5KCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgdXBkYXRlRGlzcGxheTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHNwbGlzdCA9IHRoaXMuc3BsaXN0LFxuICAgICAgICAgICAgICAgICBzcGNvdW50ID0gc3BsaXN0Lmxlbmd0aCxcbiAgICAgICAgICAgICAgICAgbmVlZHNSZWZyZXNoID0gZmFsc2UsXG4gICAgICAgICAgICAgICAgIG9mZnNldCA9IHRoaXMuJGNhbnZhcy5vZmZzZXQoKSxcbiAgICAgICAgICAgICAgICAgbG9jYWxYID0gdGhpcy5jdXJyZW50UGFnZVggLSBvZmZzZXQubGVmdCxcbiAgICAgICAgICAgICAgICAgbG9jYWxZID0gdGhpcy5jdXJyZW50UGFnZVkgLSBvZmZzZXQudG9wLFxuICAgICAgICAgICAgICAgICB0b29sdGlwaHRtbCwgc3AsIGksIHJlc3VsdCwgY2hhbmdlRXZlbnQ7XG4gICAgICAgICAgICBpZiAoIXRoaXMub3Zlcikge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBzcGNvdW50OyBpKyspIHtcbiAgICAgICAgICAgICAgICBzcCA9IHNwbGlzdFtpXTtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBzcC5zZXRSZWdpb25IaWdobGlnaHQodGhpcy5jdXJyZW50RWwsIGxvY2FsWCwgbG9jYWxZKTtcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIG5lZWRzUmVmcmVzaCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG5lZWRzUmVmcmVzaCkge1xuICAgICAgICAgICAgICAgIGNoYW5nZUV2ZW50ID0gJC5FdmVudCgnc3BhcmtsaW5lUmVnaW9uQ2hhbmdlJyk7XG4gICAgICAgICAgICAgICAgY2hhbmdlRXZlbnQuc3BhcmtsaW5lcyA9IHRoaXMuc3BsaXN0O1xuICAgICAgICAgICAgICAgIHRoaXMuJGVsLnRyaWdnZXIoY2hhbmdlRXZlbnQpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnRvb2x0aXApIHtcbiAgICAgICAgICAgICAgICAgICAgdG9vbHRpcGh0bWwgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHNwY291bnQ7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3AgPSBzcGxpc3RbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICB0b29sdGlwaHRtbCArPSBzcC5nZXRDdXJyZW50UmVnaW9uVG9vbHRpcCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudG9vbHRpcC5zZXRDb250ZW50KHRvb2x0aXBodG1sKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmRpc2FibGVIaWdobGlnaHQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jYW52YXMucmVuZGVyKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHJlc3VsdCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRoaXMubW91c2VsZWF2ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG5cblxuICAgIFRvb2x0aXAgPSBjcmVhdGVDbGFzcyh7XG4gICAgICAgIHNpemVTdHlsZTogJ3Bvc2l0aW9uOiBzdGF0aWMgIWltcG9ydGFudDsnICtcbiAgICAgICAgICAgICdkaXNwbGF5OiBibG9jayAhaW1wb3J0YW50OycgK1xuICAgICAgICAgICAgJ3Zpc2liaWxpdHk6IGhpZGRlbiAhaW1wb3J0YW50OycgK1xuICAgICAgICAgICAgJ2Zsb2F0OiBsZWZ0ICFpbXBvcnRhbnQ7JyxcblxuICAgICAgICBpbml0OiBmdW5jdGlvbiAob3B0aW9ucykge1xuICAgICAgICAgICAgdmFyIHRvb2x0aXBDbGFzc25hbWUgPSBvcHRpb25zLmdldCgndG9vbHRpcENsYXNzbmFtZScsICdqcXN0b29sdGlwJyksXG4gICAgICAgICAgICAgICAgc2l6ZXRpcFN0eWxlID0gdGhpcy5zaXplU3R5bGUsXG4gICAgICAgICAgICAgICAgb2Zmc2V0O1xuICAgICAgICAgICAgdGhpcy5jb250YWluZXIgPSBvcHRpb25zLmdldCgndG9vbHRpcENvbnRhaW5lcicpIHx8IGRvY3VtZW50LmJvZHk7XG4gICAgICAgICAgICB0aGlzLnRvb2x0aXBPZmZzZXRYID0gb3B0aW9ucy5nZXQoJ3Rvb2x0aXBPZmZzZXRYJywgMTApO1xuICAgICAgICAgICAgdGhpcy50b29sdGlwT2Zmc2V0WSA9IG9wdGlvbnMuZ2V0KCd0b29sdGlwT2Zmc2V0WScsIDEyKTtcbiAgICAgICAgICAgIC8vIHJlbW92ZSBhbnkgcHJldmlvdXMgbGluZ2VyaW5nIHRvb2x0aXBcbiAgICAgICAgICAgICQoJyNqcXNzaXpldGlwJykucmVtb3ZlKCk7XG4gICAgICAgICAgICAkKCcjanFzdG9vbHRpcCcpLnJlbW92ZSgpO1xuICAgICAgICAgICAgdGhpcy5zaXpldGlwID0gJCgnPGRpdi8+Jywge1xuICAgICAgICAgICAgICAgIGlkOiAnanFzc2l6ZXRpcCcsXG4gICAgICAgICAgICAgICAgc3R5bGU6IHNpemV0aXBTdHlsZSxcbiAgICAgICAgICAgICAgICAnY2xhc3MnOiB0b29sdGlwQ2xhc3NuYW1lXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMudG9vbHRpcCA9ICQoJzxkaXYvPicsIHtcbiAgICAgICAgICAgICAgICBpZDogJ2pxc3Rvb2x0aXAnLFxuICAgICAgICAgICAgICAgICdjbGFzcyc6IHRvb2x0aXBDbGFzc25hbWVcbiAgICAgICAgICAgIH0pLmFwcGVuZFRvKHRoaXMuY29udGFpbmVyKTtcbiAgICAgICAgICAgIC8vIGFjY291bnQgZm9yIHRoZSBjb250YWluZXIncyBsb2NhdGlvblxuICAgICAgICAgICAgb2Zmc2V0ID0gdGhpcy50b29sdGlwLm9mZnNldCgpO1xuICAgICAgICAgICAgdGhpcy5vZmZzZXRMZWZ0ID0gb2Zmc2V0LmxlZnQ7XG4gICAgICAgICAgICB0aGlzLm9mZnNldFRvcCA9IG9mZnNldC50b3A7XG4gICAgICAgICAgICB0aGlzLmhpZGRlbiA9IHRydWU7XG4gICAgICAgICAgICAkKHdpbmRvdykudW5iaW5kKCdyZXNpemUuanFzIHNjcm9sbC5qcXMnKTtcbiAgICAgICAgICAgICQod2luZG93KS5iaW5kKCdyZXNpemUuanFzIHNjcm9sbC5qcXMnLCAkLnByb3h5KHRoaXMudXBkYXRlV2luZG93RGltcywgdGhpcykpO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVXaW5kb3dEaW1zKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgdXBkYXRlV2luZG93RGltczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5zY3JvbGxUb3AgPSAkKHdpbmRvdykuc2Nyb2xsVG9wKCk7XG4gICAgICAgICAgICB0aGlzLnNjcm9sbExlZnQgPSAkKHdpbmRvdykuc2Nyb2xsTGVmdCgpO1xuICAgICAgICAgICAgdGhpcy5zY3JvbGxSaWdodCA9IHRoaXMuc2Nyb2xsTGVmdCArICQod2luZG93KS53aWR0aCgpO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVQb3NpdGlvbigpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGdldFNpemU6IGZ1bmN0aW9uIChjb250ZW50KSB7XG4gICAgICAgICAgICB0aGlzLnNpemV0aXAuaHRtbChjb250ZW50KS5hcHBlbmRUbyh0aGlzLmNvbnRhaW5lcik7XG4gICAgICAgICAgICB0aGlzLndpZHRoID0gdGhpcy5zaXpldGlwLndpZHRoKCkgKyAxO1xuICAgICAgICAgICAgdGhpcy5oZWlnaHQgPSB0aGlzLnNpemV0aXAuaGVpZ2h0KCk7XG4gICAgICAgICAgICB0aGlzLnNpemV0aXAucmVtb3ZlKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2V0Q29udGVudDogZnVuY3Rpb24gKGNvbnRlbnQpIHtcbiAgICAgICAgICAgIGlmICghY29udGVudCkge1xuICAgICAgICAgICAgICAgIHRoaXMudG9vbHRpcC5jc3MoJ3Zpc2liaWxpdHknLCAnaGlkZGVuJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5oaWRkZW4gPSB0cnVlO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZ2V0U2l6ZShjb250ZW50KTtcbiAgICAgICAgICAgIHRoaXMudG9vbHRpcC5odG1sKGNvbnRlbnQpXG4gICAgICAgICAgICAgICAgLmNzcyh7XG4gICAgICAgICAgICAgICAgICAgICd3aWR0aCc6IHRoaXMud2lkdGgsXG4gICAgICAgICAgICAgICAgICAgICdoZWlnaHQnOiB0aGlzLmhlaWdodCxcbiAgICAgICAgICAgICAgICAgICAgJ3Zpc2liaWxpdHknOiAndmlzaWJsZSdcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmICh0aGlzLmhpZGRlbikge1xuICAgICAgICAgICAgICAgIHRoaXMuaGlkZGVuID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVQb3NpdGlvbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIHVwZGF0ZVBvc2l0aW9uOiBmdW5jdGlvbiAoeCwgeSkge1xuICAgICAgICAgICAgaWYgKHggPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLm1vdXNleCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgeCA9IHRoaXMubW91c2V4IC0gdGhpcy5vZmZzZXRMZWZ0O1xuICAgICAgICAgICAgICAgIHkgPSB0aGlzLm1vdXNleSAtIHRoaXMub2Zmc2V0VG9wO1xuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMubW91c2V4ID0geCA9IHggLSB0aGlzLm9mZnNldExlZnQ7XG4gICAgICAgICAgICAgICAgdGhpcy5tb3VzZXkgPSB5ID0geSAtIHRoaXMub2Zmc2V0VG9wO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCF0aGlzLmhlaWdodCB8fCAhdGhpcy53aWR0aCB8fCB0aGlzLmhpZGRlbikge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgeSAtPSB0aGlzLmhlaWdodCArIHRoaXMudG9vbHRpcE9mZnNldFk7XG4gICAgICAgICAgICB4ICs9IHRoaXMudG9vbHRpcE9mZnNldFg7XG5cbiAgICAgICAgICAgIGlmICh5IDwgdGhpcy5zY3JvbGxUb3ApIHtcbiAgICAgICAgICAgICAgICB5ID0gdGhpcy5zY3JvbGxUb3A7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoeCA8IHRoaXMuc2Nyb2xsTGVmdCkge1xuICAgICAgICAgICAgICAgIHggPSB0aGlzLnNjcm9sbExlZnQ7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHggKyB0aGlzLndpZHRoID4gdGhpcy5zY3JvbGxSaWdodCkge1xuICAgICAgICAgICAgICAgIHggPSB0aGlzLnNjcm9sbFJpZ2h0IC0gdGhpcy53aWR0aDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy50b29sdGlwLmNzcyh7XG4gICAgICAgICAgICAgICAgJ2xlZnQnOiB4LFxuICAgICAgICAgICAgICAgICd0b3AnOiB5XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICByZW1vdmU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMudG9vbHRpcC5yZW1vdmUoKTtcbiAgICAgICAgICAgIHRoaXMuc2l6ZXRpcC5yZW1vdmUoKTtcbiAgICAgICAgICAgIHRoaXMuc2l6ZXRpcCA9IHRoaXMudG9vbHRpcCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICQod2luZG93KS51bmJpbmQoJ3Jlc2l6ZS5qcXMgc2Nyb2xsLmpxcycpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICBpbml0U3R5bGVzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGFkZENTUyhkZWZhdWx0U3R5bGVzKTtcbiAgICB9O1xuXG4gICAgJChpbml0U3R5bGVzKTtcblxuICAgIHBlbmRpbmcgPSBbXTtcbiAgICAkLmZuLnNwYXJrbGluZSA9IGZ1bmN0aW9uICh1c2VyVmFsdWVzLCB1c2VyT3B0aW9ucykge1xuICAgICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBvcHRpb25zID0gbmV3ICQuZm4uc3BhcmtsaW5lLm9wdGlvbnModGhpcywgdXNlck9wdGlvbnMpLFxuICAgICAgICAgICAgICAgICAkdGhpcyA9ICQodGhpcyksXG4gICAgICAgICAgICAgICAgIHJlbmRlciwgaTtcbiAgICAgICAgICAgIHJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWVzLCB3aWR0aCwgaGVpZ2h0LCB0bXAsIG1oYW5kbGVyLCBzcCwgdmFscztcbiAgICAgICAgICAgICAgICBpZiAodXNlclZhbHVlcyA9PT0gJ2h0bWwnIHx8IHVzZXJWYWx1ZXMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICB2YWxzID0gdGhpcy5nZXRBdHRyaWJ1dGUob3B0aW9ucy5nZXQoJ3RhZ1ZhbHVlc0F0dHJpYnV0ZScpKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHMgPT09IHVuZGVmaW5lZCB8fCB2YWxzID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWxzID0gJHRoaXMuaHRtbCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlcyA9IHZhbHMucmVwbGFjZSgvKF5cXHMqPCEtLSl8KC0tPlxccyokKXxcXHMrL2csICcnKS5zcGxpdCgnLCcpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlcyA9IHVzZXJWYWx1ZXM7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd2lkdGggPSBvcHRpb25zLmdldCgnd2lkdGgnKSA9PT0gJ2F1dG8nID8gdmFsdWVzLmxlbmd0aCAqIG9wdGlvbnMuZ2V0KCdkZWZhdWx0UGl4ZWxzUGVyVmFsdWUnKSA6IG9wdGlvbnMuZ2V0KCd3aWR0aCcpO1xuICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLmdldCgnaGVpZ2h0JykgPT09ICdhdXRvJykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIW9wdGlvbnMuZ2V0KCdjb21wb3NpdGUnKSB8fCAhJC5kYXRhKHRoaXMsICdfanFzX3ZjYW52YXMnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbXVzdCBiZSBhIGJldHRlciB3YXkgdG8gZ2V0IHRoZSBsaW5lIGhlaWdodFxuICAgICAgICAgICAgICAgICAgICAgICAgdG1wID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdG1wLmlubmVySFRNTCA9ICdhJztcbiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLmh0bWwodG1wKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodCA9ICQodG1wKS5pbm5lckhlaWdodCgpIHx8ICQodG1wKS5oZWlnaHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICQodG1wKS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRtcCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBoZWlnaHQgPSBvcHRpb25zLmdldCgnaGVpZ2h0Jyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKCFvcHRpb25zLmdldCgnZGlzYWJsZUludGVyYWN0aW9uJykpIHtcbiAgICAgICAgICAgICAgICAgICAgbWhhbmRsZXIgPSAkLmRhdGEodGhpcywgJ19qcXNfbWhhbmRsZXInKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFtaGFuZGxlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWhhbmRsZXIgPSBuZXcgTW91c2VIYW5kbGVyKHRoaXMsIG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJC5kYXRhKHRoaXMsICdfanFzX21oYW5kbGVyJywgbWhhbmRsZXIpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCFvcHRpb25zLmdldCgnY29tcG9zaXRlJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1oYW5kbGVyLnJlc2V0KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBtaGFuZGxlciA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLmdldCgnY29tcG9zaXRlJykgJiYgISQuZGF0YSh0aGlzLCAnX2pxc192Y2FudmFzJykpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEkLmRhdGEodGhpcywgJ19qcXNfZXJybm90aWZ5JykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KCdBdHRlbXB0ZWQgdG8gYXR0YWNoIGEgY29tcG9zaXRlIHNwYXJrbGluZSB0byBhbiBlbGVtZW50IHdpdGggbm8gZXhpc3Rpbmcgc3BhcmtsaW5lJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkLmRhdGEodGhpcywgJ19qcXNfZXJybm90aWZ5JywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHNwID0gbmV3ICQuZm4uc3BhcmtsaW5lW29wdGlvbnMuZ2V0KCd0eXBlJyldKHRoaXMsIHZhbHVlcywgb3B0aW9ucywgd2lkdGgsIGhlaWdodCk7XG5cbiAgICAgICAgICAgICAgICBzcC5yZW5kZXIoKTtcblxuICAgICAgICAgICAgICAgIGlmIChtaGFuZGxlcikge1xuICAgICAgICAgICAgICAgICAgICBtaGFuZGxlci5yZWdpc3RlclNwYXJrbGluZShzcCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGlmICgoJCh0aGlzKS5odG1sKCkgJiYgIW9wdGlvbnMuZ2V0KCdkaXNhYmxlSGlkZGVuQ2hlY2snKSAmJiAkKHRoaXMpLmlzKCc6aGlkZGVuJykpIHx8ICEkKHRoaXMpLnBhcmVudHMoJ2JvZHknKS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBpZiAoIW9wdGlvbnMuZ2V0KCdjb21wb3NpdGUnKSAmJiAkLmRhdGEodGhpcywgJ19qcXNfcGVuZGluZycpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBhbnkgZXhpc3RpbmcgcmVmZXJlbmNlcyB0byB0aGUgZWxlbWVudFxuICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSBwZW5kaW5nLmxlbmd0aDsgaTsgaS0tKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocGVuZGluZ1tpIC0gMV1bMF0gPT0gdGhpcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlbmRpbmcuc3BsaWNlKGkgLSAxLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBwZW5kaW5nLnB1c2goW3RoaXMsIHJlbmRlcl0pO1xuICAgICAgICAgICAgICAgICQuZGF0YSh0aGlzLCAnX2pxc19wZW5kaW5nJywgdHJ1ZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlbmRlci5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgJC5mbi5zcGFya2xpbmUuZGVmYXVsdHMgPSBnZXREZWZhdWx0cygpO1xuXG5cbiAgICAkLnNwYXJrbGluZV9kaXNwbGF5X3Zpc2libGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBlbCwgaSwgcGw7XG4gICAgICAgIHZhciBkb25lID0gW107XG4gICAgICAgIGZvciAoaSA9IDAsIHBsID0gcGVuZGluZy5sZW5ndGg7IGkgPCBwbDsgaSsrKSB7XG4gICAgICAgICAgICBlbCA9IHBlbmRpbmdbaV1bMF07XG4gICAgICAgICAgICBpZiAoJChlbCkuaXMoJzp2aXNpYmxlJykgJiYgISQoZWwpLnBhcmVudHMoKS5pcygnOmhpZGRlbicpKSB7XG4gICAgICAgICAgICAgICAgcGVuZGluZ1tpXVsxXS5jYWxsKGVsKTtcbiAgICAgICAgICAgICAgICAkLmRhdGEocGVuZGluZ1tpXVswXSwgJ19qcXNfcGVuZGluZycsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICBkb25lLnB1c2goaSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKCEkKGVsKS5jbG9zZXN0KCdodG1sJykubGVuZ3RoICYmICEkLmRhdGEoZWwsICdfanFzX3BlbmRpbmcnKSkge1xuICAgICAgICAgICAgICAgIC8vIGVsZW1lbnQgaGFzIGJlZW4gaW5zZXJ0ZWQgYW5kIHJlbW92ZWQgZnJvbSB0aGUgRE9NXG4gICAgICAgICAgICAgICAgLy8gSWYgaXQgd2FzIG5vdCB5ZXQgaW5zZXJ0ZWQgaW50byB0aGUgZG9tIHRoZW4gdGhlIC5kYXRhIHJlcXVlc3RcbiAgICAgICAgICAgICAgICAvLyB3aWxsIHJldHVybiB0cnVlLlxuICAgICAgICAgICAgICAgIC8vIHJlbW92aW5nIGZyb20gdGhlIGRvbSBjYXVzZXMgdGhlIGRhdGEgdG8gYmUgcmVtb3ZlZC5cbiAgICAgICAgICAgICAgICAkLmRhdGEocGVuZGluZ1tpXVswXSwgJ19qcXNfcGVuZGluZycsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICBkb25lLnB1c2goaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChpID0gZG9uZS5sZW5ndGg7IGk7IGktLSkge1xuICAgICAgICAgICAgcGVuZGluZy5zcGxpY2UoZG9uZVtpIC0gMV0sIDEpO1xuICAgICAgICB9XG4gICAgfTtcblxuXG4gICAgLyoqXG4gICAgICogVXNlciBvcHRpb24gaGFuZGxlclxuICAgICAqL1xuICAgICQuZm4uc3BhcmtsaW5lLm9wdGlvbnMgPSBjcmVhdGVDbGFzcyh7XG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uICh0YWcsIHVzZXJPcHRpb25zKSB7XG4gICAgICAgICAgICB2YXIgZXh0ZW5kZWRPcHRpb25zLCBkZWZhdWx0cywgYmFzZSwgdGFnT3B0aW9uVHlwZTtcbiAgICAgICAgICAgIHRoaXMudXNlck9wdGlvbnMgPSB1c2VyT3B0aW9ucyA9IHVzZXJPcHRpb25zIHx8IHt9O1xuICAgICAgICAgICAgdGhpcy50YWcgPSB0YWc7XG4gICAgICAgICAgICB0aGlzLnRhZ1ZhbENhY2hlID0ge307XG4gICAgICAgICAgICBkZWZhdWx0cyA9ICQuZm4uc3BhcmtsaW5lLmRlZmF1bHRzO1xuICAgICAgICAgICAgYmFzZSA9IGRlZmF1bHRzLmNvbW1vbjtcbiAgICAgICAgICAgIHRoaXMudGFnT3B0aW9uc1ByZWZpeCA9IHVzZXJPcHRpb25zLmVuYWJsZVRhZ09wdGlvbnMgJiYgKHVzZXJPcHRpb25zLnRhZ09wdGlvbnNQcmVmaXggfHwgYmFzZS50YWdPcHRpb25zUHJlZml4KTtcblxuICAgICAgICAgICAgdGFnT3B0aW9uVHlwZSA9IHRoaXMuZ2V0VGFnU2V0dGluZygndHlwZScpO1xuICAgICAgICAgICAgaWYgKHRhZ09wdGlvblR5cGUgPT09IFVOU0VUX09QVElPTikge1xuICAgICAgICAgICAgICAgIGV4dGVuZGVkT3B0aW9ucyA9IGRlZmF1bHRzW3VzZXJPcHRpb25zLnR5cGUgfHwgYmFzZS50eXBlXTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZXh0ZW5kZWRPcHRpb25zID0gZGVmYXVsdHNbdGFnT3B0aW9uVHlwZV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm1lcmdlZE9wdGlvbnMgPSAkLmV4dGVuZCh7fSwgYmFzZSwgZXh0ZW5kZWRPcHRpb25zLCB1c2VyT3B0aW9ucyk7XG4gICAgICAgIH0sXG5cblxuICAgICAgICBnZXRUYWdTZXR0aW5nOiBmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgICB2YXIgcHJlZml4ID0gdGhpcy50YWdPcHRpb25zUHJlZml4LFxuICAgICAgICAgICAgICAgIHZhbCwgaSwgcGFpcnMsIGtleXZhbDtcbiAgICAgICAgICAgIGlmIChwcmVmaXggPT09IGZhbHNlIHx8IHByZWZpeCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFVOU0VUX09QVElPTjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnRhZ1ZhbENhY2hlLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgICAgICB2YWwgPSB0aGlzLnRhZ1ZhbENhY2hlLmtleTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFsID0gdGhpcy50YWcuZ2V0QXR0cmlidXRlKHByZWZpeCArIGtleSk7XG4gICAgICAgICAgICAgICAgaWYgKHZhbCA9PT0gdW5kZWZpbmVkIHx8IHZhbCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB2YWwgPSBVTlNFVF9PUFRJT047XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh2YWwuc3Vic3RyKDAsIDEpID09PSAnWycpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsID0gdmFsLnN1YnN0cigxLCB2YWwubGVuZ3RoIC0gMikuc3BsaXQoJywnKTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChpID0gdmFsLmxlbmd0aDsgaS0tOykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsW2ldID0gbm9ybWFsaXplVmFsdWUodmFsW2ldLnJlcGxhY2UoLyheXFxzKil8KFxccyokKS9nLCAnJykpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh2YWwuc3Vic3RyKDAsIDEpID09PSAneycpIHtcbiAgICAgICAgICAgICAgICAgICAgcGFpcnMgPSB2YWwuc3Vic3RyKDEsIHZhbC5sZW5ndGggLSAyKS5zcGxpdCgnLCcpO1xuICAgICAgICAgICAgICAgICAgICB2YWwgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChpID0gcGFpcnMubGVuZ3RoOyBpLS07KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBrZXl2YWwgPSBwYWlyc1tpXS5zcGxpdCgnOicsIDIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsW2tleXZhbFswXS5yZXBsYWNlKC8oXlxccyopfChcXHMqJCkvZywgJycpXSA9IG5vcm1hbGl6ZVZhbHVlKGtleXZhbFsxXS5yZXBsYWNlKC8oXlxccyopfChcXHMqJCkvZywgJycpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbCA9IG5vcm1hbGl6ZVZhbHVlKHZhbCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMudGFnVmFsQ2FjaGUua2V5ID0gdmFsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHZhbDtcbiAgICAgICAgfSxcblxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIChrZXksIGRlZmF1bHR2YWwpIHtcbiAgICAgICAgICAgIHZhciB0YWdPcHRpb24gPSB0aGlzLmdldFRhZ1NldHRpbmcoa2V5KSxcbiAgICAgICAgICAgICAgICByZXN1bHQ7XG4gICAgICAgICAgICBpZiAodGFnT3B0aW9uICE9PSBVTlNFVF9PUFRJT04pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGFnT3B0aW9uO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIChyZXN1bHQgPSB0aGlzLm1lcmdlZE9wdGlvbnNba2V5XSkgPT09IHVuZGVmaW5lZCA/IGRlZmF1bHR2YWwgOiByZXN1bHQ7XG4gICAgICAgIH1cbiAgICB9KTtcblxuXG4gICAgJC5mbi5zcGFya2xpbmUuX2Jhc2UgPSBjcmVhdGVDbGFzcyh7XG4gICAgICAgIGRpc2FibGVkOiBmYWxzZSxcblxuICAgICAgICBpbml0OiBmdW5jdGlvbiAoZWwsIHZhbHVlcywgb3B0aW9ucywgd2lkdGgsIGhlaWdodCkge1xuICAgICAgICAgICAgdGhpcy5lbCA9IGVsO1xuICAgICAgICAgICAgdGhpcy4kZWwgPSAkKGVsKTtcbiAgICAgICAgICAgIHRoaXMudmFsdWVzID0gdmFsdWVzO1xuICAgICAgICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbiAgICAgICAgICAgIHRoaXMud2lkdGggPSB3aWR0aDtcbiAgICAgICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50UmVnaW9uID0gdW5kZWZpbmVkO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTZXR1cCB0aGUgY2FudmFzXG4gICAgICAgICAqL1xuICAgICAgICBpbml0VGFyZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgaW50ZXJhY3RpdmUgPSAhdGhpcy5vcHRpb25zLmdldCgnZGlzYWJsZUludGVyYWN0aW9uJyk7XG4gICAgICAgICAgICBpZiAoISh0aGlzLnRhcmdldCA9IHRoaXMuJGVsLnNpbXBsZWRyYXcodGhpcy53aWR0aCwgdGhpcy5oZWlnaHQsIHRoaXMub3B0aW9ucy5nZXQoJ2NvbXBvc2l0ZScpLCBpbnRlcmFjdGl2ZSkpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kaXNhYmxlZCA9IHRydWU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuY2FudmFzV2lkdGggPSB0aGlzLnRhcmdldC5waXhlbFdpZHRoO1xuICAgICAgICAgICAgICAgIHRoaXMuY2FudmFzSGVpZ2h0ID0gdGhpcy50YXJnZXQucGl4ZWxIZWlnaHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEFjdHVhbGx5IHJlbmRlciB0aGUgY2hhcnQgdG8gdGhlIGNhbnZhc1xuICAgICAgICAgKi9cbiAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5kaXNhYmxlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZWwuaW5uZXJIVE1MID0gJyc7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJldHVybiBhIHJlZ2lvbiBpZCBmb3IgYSBnaXZlbiB4L3kgY28tb3JkaW5hdGVcbiAgICAgICAgICovXG4gICAgICAgIGdldFJlZ2lvbjogZnVuY3Rpb24gKHgsIHkpIHtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogSGlnaGxpZ2h0IGFuIGl0ZW0gYmFzZWQgb24gdGhlIG1vdXNlZC1vdmVyIHgseSBjby1vcmRpbmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgc2V0UmVnaW9uSGlnaGxpZ2h0OiBmdW5jdGlvbiAoZWwsIHgsIHkpIHtcbiAgICAgICAgICAgIHZhciBjdXJyZW50UmVnaW9uID0gdGhpcy5jdXJyZW50UmVnaW9uLFxuICAgICAgICAgICAgICAgIGhpZ2hsaWdodEVuYWJsZWQgPSAhdGhpcy5vcHRpb25zLmdldCgnZGlzYWJsZUhpZ2hsaWdodCcpLFxuICAgICAgICAgICAgICAgIG5ld1JlZ2lvbjtcbiAgICAgICAgICAgIGlmICh4ID4gdGhpcy5jYW52YXNXaWR0aCB8fCB5ID4gdGhpcy5jYW52YXNIZWlnaHQgfHwgeCA8IDAgfHwgeSA8IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5ld1JlZ2lvbiA9IHRoaXMuZ2V0UmVnaW9uKGVsLCB4LCB5KTtcbiAgICAgICAgICAgIGlmIChjdXJyZW50UmVnaW9uICE9PSBuZXdSZWdpb24pIHtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudFJlZ2lvbiAhPT0gdW5kZWZpbmVkICYmIGhpZ2hsaWdodEVuYWJsZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVIaWdobGlnaHQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50UmVnaW9uID0gbmV3UmVnaW9uO1xuICAgICAgICAgICAgICAgIGlmIChuZXdSZWdpb24gIT09IHVuZGVmaW5lZCAmJiBoaWdobGlnaHRFbmFibGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVySGlnaGxpZ2h0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSZXNldCBhbnkgY3VycmVudGx5IGhpZ2hsaWdodGVkIGl0ZW1cbiAgICAgICAgICovXG4gICAgICAgIGNsZWFyUmVnaW9uSGlnaGxpZ2h0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50UmVnaW9uICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUhpZ2hsaWdodCgpO1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFJlZ2lvbiA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSxcblxuICAgICAgICByZW5kZXJIaWdobGlnaHQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlSGlnaGxpZ2h0KHRydWUpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlbW92ZUhpZ2hsaWdodDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5jaGFuZ2VIaWdobGlnaHQoZmFsc2UpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGNoYW5nZUhpZ2hsaWdodDogZnVuY3Rpb24gKGhpZ2hsaWdodCkgIHt9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGZXRjaCB0aGUgSFRNTCB0byBkaXNwbGF5IGFzIGEgdG9vbHRpcFxuICAgICAgICAgKi9cbiAgICAgICAgZ2V0Q3VycmVudFJlZ2lvblRvb2x0aXA6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBvcHRpb25zID0gdGhpcy5vcHRpb25zLFxuICAgICAgICAgICAgICAgIGhlYWRlciA9ICcnLFxuICAgICAgICAgICAgICAgIGVudHJpZXMgPSBbXSxcbiAgICAgICAgICAgICAgICBmaWVsZHMsIGZvcm1hdHMsIGZvcm1hdGxlbiwgZmNsYXNzLCB0ZXh0LCBpLFxuICAgICAgICAgICAgICAgIHNob3dGaWVsZHMsIHNob3dGaWVsZHNLZXksIG5ld0ZpZWxkcywgZnYsXG4gICAgICAgICAgICAgICAgZm9ybWF0dGVyLCBmb3JtYXQsIGZpZWxkbGVuLCBqO1xuICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudFJlZ2lvbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZmllbGRzID0gdGhpcy5nZXRDdXJyZW50UmVnaW9uRmllbGRzKCk7XG4gICAgICAgICAgICBmb3JtYXR0ZXIgPSBvcHRpb25zLmdldCgndG9vbHRpcEZvcm1hdHRlcicpO1xuICAgICAgICAgICAgaWYgKGZvcm1hdHRlcikge1xuICAgICAgICAgICAgICAgIHJldHVybiBmb3JtYXR0ZXIodGhpcywgb3B0aW9ucywgZmllbGRzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChvcHRpb25zLmdldCgndG9vbHRpcENoYXJ0VGl0bGUnKSkge1xuICAgICAgICAgICAgICAgIGhlYWRlciArPSAnPGRpdiBjbGFzcz1cImpxcyBqcXN0aXRsZVwiPicgKyBvcHRpb25zLmdldCgndG9vbHRpcENoYXJ0VGl0bGUnKSArICc8L2Rpdj5cXG4nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9ybWF0cyA9IHRoaXMub3B0aW9ucy5nZXQoJ3Rvb2x0aXBGb3JtYXQnKTtcbiAgICAgICAgICAgIGlmICghZm9ybWF0cykge1xuICAgICAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghJC5pc0FycmF5KGZvcm1hdHMpKSB7XG4gICAgICAgICAgICAgICAgZm9ybWF0cyA9IFtmb3JtYXRzXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghJC5pc0FycmF5KGZpZWxkcykpIHtcbiAgICAgICAgICAgICAgICBmaWVsZHMgPSBbZmllbGRzXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNob3dGaWVsZHMgPSB0aGlzLm9wdGlvbnMuZ2V0KCd0b29sdGlwRm9ybWF0RmllbGRsaXN0Jyk7XG4gICAgICAgICAgICBzaG93RmllbGRzS2V5ID0gdGhpcy5vcHRpb25zLmdldCgndG9vbHRpcEZvcm1hdEZpZWxkbGlzdEtleScpO1xuICAgICAgICAgICAgaWYgKHNob3dGaWVsZHMgJiYgc2hvd0ZpZWxkc0tleSkge1xuICAgICAgICAgICAgICAgIC8vIHVzZXItc2VsZWN0ZWQgb3JkZXJpbmcgb2YgZmllbGRzXG4gICAgICAgICAgICAgICAgbmV3RmllbGRzID0gW107XG4gICAgICAgICAgICAgICAgZm9yIChpID0gZmllbGRzLmxlbmd0aDsgaS0tOykge1xuICAgICAgICAgICAgICAgICAgICBmdiA9IGZpZWxkc1tpXVtzaG93RmllbGRzS2V5XTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKChqID0gJC5pbkFycmF5KGZ2LCBzaG93RmllbGRzKSkgIT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0ZpZWxkc1tqXSA9IGZpZWxkc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmaWVsZHMgPSBuZXdGaWVsZHM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3JtYXRsZW4gPSBmb3JtYXRzLmxlbmd0aDtcbiAgICAgICAgICAgIGZpZWxkbGVuID0gZmllbGRzLmxlbmd0aDtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBmb3JtYXRsZW47IGkrKykge1xuICAgICAgICAgICAgICAgIGZvcm1hdCA9IGZvcm1hdHNbaV07XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBmb3JtYXQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvcm1hdCA9IG5ldyBTUEZvcm1hdChmb3JtYXQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmY2xhc3MgPSBmb3JtYXQuZmNsYXNzIHx8ICdqcXNmaWVsZCc7XG4gICAgICAgICAgICAgICAgZm9yIChqID0gMDsgaiA8IGZpZWxkbGVuOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFmaWVsZHNbal0uaXNOdWxsIHx8ICFvcHRpb25zLmdldCgndG9vbHRpcFNraXBOdWxsJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICQuZXh0ZW5kKGZpZWxkc1tqXSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZWZpeDogb3B0aW9ucy5nZXQoJ3Rvb2x0aXBQcmVmaXgnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWZmaXg6IG9wdGlvbnMuZ2V0KCd0b29sdGlwU3VmZml4JylcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCA9IGZvcm1hdC5yZW5kZXIoZmllbGRzW2pdLCBvcHRpb25zLmdldCgndG9vbHRpcFZhbHVlTG9va3VwcycpLCBvcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVudHJpZXMucHVzaCgnPGRpdiBjbGFzcz1cIicgKyBmY2xhc3MgKyAnXCI+JyArIHRleHQgKyAnPC9kaXY+Jyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZW50cmllcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaGVhZGVyICsgZW50cmllcy5qb2luKCdcXG4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgfSxcblxuICAgICAgICBnZXRDdXJyZW50UmVnaW9uRmllbGRzOiBmdW5jdGlvbiAoKSB7fSxcblxuICAgICAgICBjYWxjSGlnaGxpZ2h0Q29sb3I6IGZ1bmN0aW9uIChjb2xvciwgb3B0aW9ucykge1xuICAgICAgICAgICAgdmFyIGhpZ2hsaWdodENvbG9yID0gb3B0aW9ucy5nZXQoJ2hpZ2hsaWdodENvbG9yJyksXG4gICAgICAgICAgICAgICAgbGlnaHRlbiA9IG9wdGlvbnMuZ2V0KCdoaWdobGlnaHRMaWdodGVuJyksXG4gICAgICAgICAgICAgICAgcGFyc2UsIG11bHQsIHJnYm5ldywgaTtcbiAgICAgICAgICAgIGlmIChoaWdobGlnaHRDb2xvcikge1xuICAgICAgICAgICAgICAgIHJldHVybiBoaWdobGlnaHRDb2xvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChsaWdodGVuKSB7XG4gICAgICAgICAgICAgICAgLy8gZXh0cmFjdCBSR0IgdmFsdWVzXG4gICAgICAgICAgICAgICAgcGFyc2UgPSAvXiMoWzAtOWEtZl0pKFswLTlhLWZdKShbMC05YS1mXSkkL2kuZXhlYyhjb2xvcikgfHwgL14jKFswLTlhLWZdezJ9KShbMC05YS1mXXsyfSkoWzAtOWEtZl17Mn0pJC9pLmV4ZWMoY29sb3IpO1xuICAgICAgICAgICAgICAgIGlmIChwYXJzZSkge1xuICAgICAgICAgICAgICAgICAgICByZ2JuZXcgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgbXVsdCA9IGNvbG9yLmxlbmd0aCA9PT0gNCA/IDE2IDogMTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IDM7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmdibmV3W2ldID0gY2xpcHZhbChNYXRoLnJvdW5kKHBhcnNlSW50KHBhcnNlW2kgKyAxXSwgMTYpICogbXVsdCAqIGxpZ2h0ZW4pLCAwLCAyNTUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAncmdiKCcgKyByZ2JuZXcuam9pbignLCcpICsgJyknO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGNvbG9yO1xuICAgICAgICB9XG5cbiAgICB9KTtcblxuICAgIGJhckhpZ2hsaWdodE1peGluID0ge1xuICAgICAgICBjaGFuZ2VIaWdobGlnaHQ6IGZ1bmN0aW9uIChoaWdobGlnaHQpIHtcbiAgICAgICAgICAgIHZhciBjdXJyZW50UmVnaW9uID0gdGhpcy5jdXJyZW50UmVnaW9uLFxuICAgICAgICAgICAgICAgIHRhcmdldCA9IHRoaXMudGFyZ2V0LFxuICAgICAgICAgICAgICAgIHNoYXBlaWRzID0gdGhpcy5yZWdpb25TaGFwZXNbY3VycmVudFJlZ2lvbl0sXG4gICAgICAgICAgICAgICAgbmV3U2hhcGVzO1xuICAgICAgICAgICAgLy8gd2lsbCBiZSBudWxsIGlmIHRoZSByZWdpb24gdmFsdWUgd2FzIG51bGxcbiAgICAgICAgICAgIGlmIChzaGFwZWlkcykge1xuICAgICAgICAgICAgICAgIG5ld1NoYXBlcyA9IHRoaXMucmVuZGVyUmVnaW9uKGN1cnJlbnRSZWdpb24sIGhpZ2hsaWdodCk7XG4gICAgICAgICAgICAgICAgaWYgKCQuaXNBcnJheShuZXdTaGFwZXMpIHx8ICQuaXNBcnJheShzaGFwZWlkcykpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LnJlcGxhY2VXaXRoU2hhcGVzKHNoYXBlaWRzLCBuZXdTaGFwZXMpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlZ2lvblNoYXBlc1tjdXJyZW50UmVnaW9uXSA9ICQubWFwKG5ld1NoYXBlcywgZnVuY3Rpb24gKG5ld1NoYXBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3U2hhcGUuaWQ7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldC5yZXBsYWNlV2l0aFNoYXBlKHNoYXBlaWRzLCBuZXdTaGFwZXMpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlZ2lvblNoYXBlc1tjdXJyZW50UmVnaW9uXSA9IG5ld1NoYXBlcy5pZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdmFsdWVzID0gdGhpcy52YWx1ZXMsXG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0gdGhpcy50YXJnZXQsXG4gICAgICAgICAgICAgICAgcmVnaW9uU2hhcGVzID0gdGhpcy5yZWdpb25TaGFwZXMsXG4gICAgICAgICAgICAgICAgc2hhcGVzLCBpZHMsIGksIGo7XG5cbiAgICAgICAgICAgIGlmICghdGhpcy5jbHMuX3N1cGVyLnJlbmRlci5jYWxsKHRoaXMpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChpID0gdmFsdWVzLmxlbmd0aDsgaS0tOykge1xuICAgICAgICAgICAgICAgIHNoYXBlcyA9IHRoaXMucmVuZGVyUmVnaW9uKGkpO1xuICAgICAgICAgICAgICAgIGlmIChzaGFwZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCQuaXNBcnJheShzaGFwZXMpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZHMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaiA9IHNoYXBlcy5sZW5ndGg7IGotLTspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGFwZXNbal0uYXBwZW5kKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRzLnB1c2goc2hhcGVzW2pdLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZ2lvblNoYXBlc1tpXSA9IGlkcztcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoYXBlcy5hcHBlbmQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZ2lvblNoYXBlc1tpXSA9IHNoYXBlcy5pZDsgLy8gc3RvcmUganVzdCB0aGUgc2hhcGVpZFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gbnVsbCB2YWx1ZVxuICAgICAgICAgICAgICAgICAgICByZWdpb25TaGFwZXNbaV0gPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRhcmdldC5yZW5kZXIoKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBMaW5lIGNoYXJ0c1xuICAgICAqL1xuICAgICQuZm4uc3BhcmtsaW5lLmxpbmUgPSBsaW5lID0gY3JlYXRlQ2xhc3MoJC5mbi5zcGFya2xpbmUuX2Jhc2UsIHtcbiAgICAgICAgdHlwZTogJ2xpbmUnLFxuXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uIChlbCwgdmFsdWVzLCBvcHRpb25zLCB3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICAgICAgICBsaW5lLl9zdXBlci5pbml0LmNhbGwodGhpcywgZWwsIHZhbHVlcywgb3B0aW9ucywgd2lkdGgsIGhlaWdodCk7XG4gICAgICAgICAgICB0aGlzLnZlcnRpY2VzID0gW107XG4gICAgICAgICAgICB0aGlzLnJlZ2lvbk1hcCA9IFtdO1xuICAgICAgICAgICAgdGhpcy54dmFsdWVzID0gW107XG4gICAgICAgICAgICB0aGlzLnl2YWx1ZXMgPSBbXTtcbiAgICAgICAgICAgIHRoaXMueW1pbm1heCA9IFtdO1xuICAgICAgICAgICAgdGhpcy5oaWdodGxpZ2h0U3BvdElkID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMubGFzdFNoYXBlSWQgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5pbml0VGFyZ2V0KCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2V0UmVnaW9uOiBmdW5jdGlvbiAoZWwsIHgsIHkpIHtcbiAgICAgICAgICAgIHZhciBpLFxuICAgICAgICAgICAgICAgIHJlZ2lvbk1hcCA9IHRoaXMucmVnaW9uTWFwOyAvLyBtYXBzIHJlZ2lvbnMgdG8gdmFsdWUgcG9zaXRpb25zXG4gICAgICAgICAgICBmb3IgKGkgPSByZWdpb25NYXAubGVuZ3RoOyBpLS07KSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlZ2lvbk1hcFtpXSAhPT0gbnVsbCAmJiB4ID49IHJlZ2lvbk1hcFtpXVswXSAmJiB4IDw9IHJlZ2lvbk1hcFtpXVsxXSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnaW9uTWFwW2ldWzJdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2V0Q3VycmVudFJlZ2lvbkZpZWxkczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRSZWdpb24gPSB0aGlzLmN1cnJlbnRSZWdpb247XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGlzTnVsbDogdGhpcy55dmFsdWVzW2N1cnJlbnRSZWdpb25dID09PSBudWxsLFxuICAgICAgICAgICAgICAgIHg6IHRoaXMueHZhbHVlc1tjdXJyZW50UmVnaW9uXSxcbiAgICAgICAgICAgICAgICB5OiB0aGlzLnl2YWx1ZXNbY3VycmVudFJlZ2lvbl0sXG4gICAgICAgICAgICAgICAgY29sb3I6IHRoaXMub3B0aW9ucy5nZXQoJ2xpbmVDb2xvcicpLFxuICAgICAgICAgICAgICAgIGZpbGxDb2xvcjogdGhpcy5vcHRpb25zLmdldCgnZmlsbENvbG9yJyksXG4gICAgICAgICAgICAgICAgb2Zmc2V0OiBjdXJyZW50UmVnaW9uXG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlbmRlckhpZ2hsaWdodDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRSZWdpb24gPSB0aGlzLmN1cnJlbnRSZWdpb24sXG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0gdGhpcy50YXJnZXQsXG4gICAgICAgICAgICAgICAgdmVydGV4ID0gdGhpcy52ZXJ0aWNlc1tjdXJyZW50UmVnaW9uXSxcbiAgICAgICAgICAgICAgICBvcHRpb25zID0gdGhpcy5vcHRpb25zLFxuICAgICAgICAgICAgICAgIHNwb3RSYWRpdXMgPSBvcHRpb25zLmdldCgnc3BvdFJhZGl1cycpLFxuICAgICAgICAgICAgICAgIGhpZ2hsaWdodFNwb3RDb2xvciA9IG9wdGlvbnMuZ2V0KCdoaWdobGlnaHRTcG90Q29sb3InKSxcbiAgICAgICAgICAgICAgICBoaWdobGlnaHRMaW5lQ29sb3IgPSBvcHRpb25zLmdldCgnaGlnaGxpZ2h0TGluZUNvbG9yJyksXG4gICAgICAgICAgICAgICAgaGlnaGxpZ2h0U3BvdCwgaGlnaGxpZ2h0TGluZTtcblxuICAgICAgICAgICAgaWYgKCF2ZXJ0ZXgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc3BvdFJhZGl1cyAmJiBoaWdobGlnaHRTcG90Q29sb3IpIHtcbiAgICAgICAgICAgICAgICBoaWdobGlnaHRTcG90ID0gdGFyZ2V0LmRyYXdDaXJjbGUodmVydGV4WzBdLCB2ZXJ0ZXhbMV0sXG4gICAgICAgICAgICAgICAgICAgIHNwb3RSYWRpdXMsIHVuZGVmaW5lZCwgaGlnaGxpZ2h0U3BvdENvbG9yKTtcbiAgICAgICAgICAgICAgICB0aGlzLmhpZ2hsaWdodFNwb3RJZCA9IGhpZ2hsaWdodFNwb3QuaWQ7XG4gICAgICAgICAgICAgICAgdGFyZ2V0Lmluc2VydEFmdGVyU2hhcGUodGhpcy5sYXN0U2hhcGVJZCwgaGlnaGxpZ2h0U3BvdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaGlnaGxpZ2h0TGluZUNvbG9yKSB7XG4gICAgICAgICAgICAgICAgaGlnaGxpZ2h0TGluZSA9IHRhcmdldC5kcmF3TGluZSh2ZXJ0ZXhbMF0sIHRoaXMuY2FudmFzVG9wLCB2ZXJ0ZXhbMF0sXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2FudmFzVG9wICsgdGhpcy5jYW52YXNIZWlnaHQsIGhpZ2hsaWdodExpbmVDb2xvcik7XG4gICAgICAgICAgICAgICAgdGhpcy5oaWdobGlnaHRMaW5lSWQgPSBoaWdobGlnaHRMaW5lLmlkO1xuICAgICAgICAgICAgICAgIHRhcmdldC5pbnNlcnRBZnRlclNoYXBlKHRoaXMubGFzdFNoYXBlSWQsIGhpZ2hsaWdodExpbmUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIHJlbW92ZUhpZ2hsaWdodDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHRhcmdldCA9IHRoaXMudGFyZ2V0O1xuICAgICAgICAgICAgaWYgKHRoaXMuaGlnaGxpZ2h0U3BvdElkKSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0LnJlbW92ZVNoYXBlSWQodGhpcy5oaWdobGlnaHRTcG90SWQpO1xuICAgICAgICAgICAgICAgIHRoaXMuaGlnaGxpZ2h0U3BvdElkID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmhpZ2hsaWdodExpbmVJZCkge1xuICAgICAgICAgICAgICAgIHRhcmdldC5yZW1vdmVTaGFwZUlkKHRoaXMuaGlnaGxpZ2h0TGluZUlkKTtcbiAgICAgICAgICAgICAgICB0aGlzLmhpZ2hsaWdodExpbmVJZCA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2NhblZhbHVlczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHZhbHVlcyA9IHRoaXMudmFsdWVzLFxuICAgICAgICAgICAgICAgIHZhbGNvdW50ID0gdmFsdWVzLmxlbmd0aCxcbiAgICAgICAgICAgICAgICB4dmFsdWVzID0gdGhpcy54dmFsdWVzLFxuICAgICAgICAgICAgICAgIHl2YWx1ZXMgPSB0aGlzLnl2YWx1ZXMsXG4gICAgICAgICAgICAgICAgeW1pbm1heCA9IHRoaXMueW1pbm1heCxcbiAgICAgICAgICAgICAgICBpLCB2YWwsIGlzU3RyLCBpc0FycmF5LCBzcDtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCB2YWxjb3VudDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFsID0gdmFsdWVzW2ldO1xuICAgICAgICAgICAgICAgIGlzU3RyID0gdHlwZW9mKHZhbHVlc1tpXSkgPT09ICdzdHJpbmcnO1xuICAgICAgICAgICAgICAgIGlzQXJyYXkgPSB0eXBlb2YodmFsdWVzW2ldKSA9PT0gJ29iamVjdCcgJiYgdmFsdWVzW2ldIGluc3RhbmNlb2YgQXJyYXk7XG4gICAgICAgICAgICAgICAgc3AgPSBpc1N0ciAmJiB2YWx1ZXNbaV0uc3BsaXQoJzonKTtcbiAgICAgICAgICAgICAgICBpZiAoaXNTdHIgJiYgc3AubGVuZ3RoID09PSAyKSB7IC8vIHg6eVxuICAgICAgICAgICAgICAgICAgICB4dmFsdWVzLnB1c2goTnVtYmVyKHNwWzBdKSk7XG4gICAgICAgICAgICAgICAgICAgIHl2YWx1ZXMucHVzaChOdW1iZXIoc3BbMV0pKTtcbiAgICAgICAgICAgICAgICAgICAgeW1pbm1heC5wdXNoKE51bWJlcihzcFsxXSkpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNBcnJheSkge1xuICAgICAgICAgICAgICAgICAgICB4dmFsdWVzLnB1c2godmFsWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgeXZhbHVlcy5wdXNoKHZhbFsxXSk7XG4gICAgICAgICAgICAgICAgICAgIHltaW5tYXgucHVzaCh2YWxbMV0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHh2YWx1ZXMucHVzaChpKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlc1tpXSA9PT0gbnVsbCB8fCB2YWx1ZXNbaV0gPT09ICdudWxsJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgeXZhbHVlcy5wdXNoKG51bGwpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgeXZhbHVlcy5wdXNoKE51bWJlcih2YWwpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHltaW5tYXgucHVzaChOdW1iZXIodmFsKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmdldCgneHZhbHVlcycpKSB7XG4gICAgICAgICAgICAgICAgeHZhbHVlcyA9IHRoaXMub3B0aW9ucy5nZXQoJ3h2YWx1ZXMnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5tYXh5ID0gdGhpcy5tYXh5b3JnID0gTWF0aC5tYXguYXBwbHkoTWF0aCwgeW1pbm1heCk7XG4gICAgICAgICAgICB0aGlzLm1pbnkgPSB0aGlzLm1pbnlvcmcgPSBNYXRoLm1pbi5hcHBseShNYXRoLCB5bWlubWF4KTtcblxuICAgICAgICAgICAgdGhpcy5tYXh4ID0gTWF0aC5tYXguYXBwbHkoTWF0aCwgeHZhbHVlcyk7XG4gICAgICAgICAgICB0aGlzLm1pbnggPSBNYXRoLm1pbi5hcHBseShNYXRoLCB4dmFsdWVzKTtcblxuICAgICAgICAgICAgdGhpcy54dmFsdWVzID0geHZhbHVlcztcbiAgICAgICAgICAgIHRoaXMueXZhbHVlcyA9IHl2YWx1ZXM7XG4gICAgICAgICAgICB0aGlzLnltaW5tYXggPSB5bWlubWF4O1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgcHJvY2Vzc1JhbmdlT3B0aW9uczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnMsXG4gICAgICAgICAgICAgICAgbm9ybWFsUmFuZ2VNaW4gPSBvcHRpb25zLmdldCgnbm9ybWFsUmFuZ2VNaW4nKSxcbiAgICAgICAgICAgICAgICBub3JtYWxSYW5nZU1heCA9IG9wdGlvbnMuZ2V0KCdub3JtYWxSYW5nZU1heCcpO1xuXG4gICAgICAgICAgICBpZiAobm9ybWFsUmFuZ2VNaW4gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGlmIChub3JtYWxSYW5nZU1pbiA8IHRoaXMubWlueSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm1pbnkgPSBub3JtYWxSYW5nZU1pbjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG5vcm1hbFJhbmdlTWF4ID4gdGhpcy5tYXh5KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWF4eSA9IG5vcm1hbFJhbmdlTWF4O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChvcHRpb25zLmdldCgnY2hhcnRSYW5nZU1pbicpICE9PSB1bmRlZmluZWQgJiYgKG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlQ2xpcCcpIHx8IG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlTWluJykgPCB0aGlzLm1pbnkpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5taW55ID0gb3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNaW4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChvcHRpb25zLmdldCgnY2hhcnRSYW5nZU1heCcpICE9PSB1bmRlZmluZWQgJiYgKG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlQ2xpcCcpIHx8IG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlTWF4JykgPiB0aGlzLm1heHkpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5tYXh5ID0gb3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNYXgnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChvcHRpb25zLmdldCgnY2hhcnRSYW5nZU1pblgnKSAhPT0gdW5kZWZpbmVkICYmIChvcHRpb25zLmdldCgnY2hhcnRSYW5nZUNsaXBYJykgfHwgb3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNaW5YJykgPCB0aGlzLm1pbngpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5taW54ID0gb3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNaW5YJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAob3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNYXhYJykgIT09IHVuZGVmaW5lZCAmJiAob3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VDbGlwWCcpIHx8IG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlTWF4WCcpID4gdGhpcy5tYXh4KSkge1xuICAgICAgICAgICAgICAgIHRoaXMubWF4eCA9IG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlTWF4WCcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0sXG5cbiAgICAgICAgZHJhd05vcm1hbFJhbmdlOiBmdW5jdGlvbiAoY2FudmFzTGVmdCwgY2FudmFzVG9wLCBjYW52YXNIZWlnaHQsIGNhbnZhc1dpZHRoLCByYW5nZXkpIHtcbiAgICAgICAgICAgIHZhciBub3JtYWxSYW5nZU1pbiA9IHRoaXMub3B0aW9ucy5nZXQoJ25vcm1hbFJhbmdlTWluJyksXG4gICAgICAgICAgICAgICAgbm9ybWFsUmFuZ2VNYXggPSB0aGlzLm9wdGlvbnMuZ2V0KCdub3JtYWxSYW5nZU1heCcpLFxuICAgICAgICAgICAgICAgIHl0b3AgPSBjYW52YXNUb3AgKyBNYXRoLnJvdW5kKGNhbnZhc0hlaWdodCAtIChjYW52YXNIZWlnaHQgKiAoKG5vcm1hbFJhbmdlTWF4IC0gdGhpcy5taW55KSAvIHJhbmdleSkpKSxcbiAgICAgICAgICAgICAgICBoZWlnaHQgPSBNYXRoLnJvdW5kKChjYW52YXNIZWlnaHQgKiAobm9ybWFsUmFuZ2VNYXggLSBub3JtYWxSYW5nZU1pbikpIC8gcmFuZ2V5KTtcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0LmRyYXdSZWN0KGNhbnZhc0xlZnQsIHl0b3AsIGNhbnZhc1dpZHRoLCBoZWlnaHQsIHVuZGVmaW5lZCwgdGhpcy5vcHRpb25zLmdldCgnbm9ybWFsUmFuZ2VDb2xvcicpKS5hcHBlbmQoKTtcbiAgICAgICAgfSxcblxuICAgICAgICByZW5kZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBvcHRpb25zID0gdGhpcy5vcHRpb25zLFxuICAgICAgICAgICAgICAgIHRhcmdldCA9IHRoaXMudGFyZ2V0LFxuICAgICAgICAgICAgICAgIGNhbnZhc1dpZHRoID0gdGhpcy5jYW52YXNXaWR0aCxcbiAgICAgICAgICAgICAgICBjYW52YXNIZWlnaHQgPSB0aGlzLmNhbnZhc0hlaWdodCxcbiAgICAgICAgICAgICAgICB2ZXJ0aWNlcyA9IHRoaXMudmVydGljZXMsXG4gICAgICAgICAgICAgICAgc3BvdFJhZGl1cyA9IG9wdGlvbnMuZ2V0KCdzcG90UmFkaXVzJyksXG4gICAgICAgICAgICAgICAgcmVnaW9uTWFwID0gdGhpcy5yZWdpb25NYXAsXG4gICAgICAgICAgICAgICAgcmFuZ2V4LCByYW5nZXksIHl2YWxsYXN0LFxuICAgICAgICAgICAgICAgIGNhbnZhc1RvcCwgY2FudmFzTGVmdCxcbiAgICAgICAgICAgICAgICB2ZXJ0ZXgsIHBhdGgsIHBhdGhzLCB4LCB5LCB4bmV4dCwgeHBvcywgeHBvc25leHQsXG4gICAgICAgICAgICAgICAgbGFzdCwgbmV4dCwgeXZhbGNvdW50LCBsaW5lU2hhcGVzLCBmaWxsU2hhcGVzLCBwbGVuLFxuICAgICAgICAgICAgICAgIHZhbHVlU3BvdHMsIGhsU3BvdHNFbmFibGVkLCBjb2xvciwgeHZhbHVlcywgeXZhbHVlcywgaTtcblxuICAgICAgICAgICAgaWYgKCFsaW5lLl9zdXBlci5yZW5kZXIuY2FsbCh0aGlzKSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5zY2FuVmFsdWVzKCk7XG4gICAgICAgICAgICB0aGlzLnByb2Nlc3NSYW5nZU9wdGlvbnMoKTtcblxuICAgICAgICAgICAgeHZhbHVlcyA9IHRoaXMueHZhbHVlcztcbiAgICAgICAgICAgIHl2YWx1ZXMgPSB0aGlzLnl2YWx1ZXM7XG5cbiAgICAgICAgICAgIGlmICghdGhpcy55bWlubWF4Lmxlbmd0aCB8fCB0aGlzLnl2YWx1ZXMubGVuZ3RoIDwgMikge1xuICAgICAgICAgICAgICAgIC8vIGVtcHR5IG9yIGFsbCBudWxsIHZhbHVlc3NcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhbnZhc1RvcCA9IGNhbnZhc0xlZnQgPSAwO1xuXG4gICAgICAgICAgICByYW5nZXggPSB0aGlzLm1heHggLSB0aGlzLm1pbnggPT09IDAgPyAxIDogdGhpcy5tYXh4IC0gdGhpcy5taW54O1xuICAgICAgICAgICAgcmFuZ2V5ID0gdGhpcy5tYXh5IC0gdGhpcy5taW55ID09PSAwID8gMSA6IHRoaXMubWF4eSAtIHRoaXMubWlueTtcbiAgICAgICAgICAgIHl2YWxsYXN0ID0gdGhpcy55dmFsdWVzLmxlbmd0aCAtIDE7XG5cbiAgICAgICAgICAgIGlmIChzcG90UmFkaXVzICYmIChjYW52YXNXaWR0aCA8IChzcG90UmFkaXVzICogNCkgfHwgY2FudmFzSGVpZ2h0IDwgKHNwb3RSYWRpdXMgKiA0KSkpIHtcbiAgICAgICAgICAgICAgICBzcG90UmFkaXVzID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzcG90UmFkaXVzKSB7XG4gICAgICAgICAgICAgICAgLy8gYWRqdXN0IHRoZSBjYW52YXMgc2l6ZSBhcyByZXF1aXJlZCBzbyB0aGF0IHNwb3RzIHdpbGwgZml0XG4gICAgICAgICAgICAgICAgaGxTcG90c0VuYWJsZWQgPSBvcHRpb25zLmdldCgnaGlnaGxpZ2h0U3BvdENvbG9yJykgJiYgICFvcHRpb25zLmdldCgnZGlzYWJsZUludGVyYWN0aW9uJyk7XG4gICAgICAgICAgICAgICAgaWYgKGhsU3BvdHNFbmFibGVkIHx8IG9wdGlvbnMuZ2V0KCdtaW5TcG90Q29sb3InKSB8fCAob3B0aW9ucy5nZXQoJ3Nwb3RDb2xvcicpICYmIHl2YWx1ZXNbeXZhbGxhc3RdID09PSB0aGlzLm1pbnkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhbnZhc0hlaWdodCAtPSBNYXRoLmNlaWwoc3BvdFJhZGl1cyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChobFNwb3RzRW5hYmxlZCB8fCBvcHRpb25zLmdldCgnbWF4U3BvdENvbG9yJykgfHwgKG9wdGlvbnMuZ2V0KCdzcG90Q29sb3InKSAmJiB5dmFsdWVzW3l2YWxsYXN0XSA9PT0gdGhpcy5tYXh5KSkge1xuICAgICAgICAgICAgICAgICAgICBjYW52YXNIZWlnaHQgLT0gTWF0aC5jZWlsKHNwb3RSYWRpdXMpO1xuICAgICAgICAgICAgICAgICAgICBjYW52YXNUb3AgKz0gTWF0aC5jZWlsKHNwb3RSYWRpdXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoaGxTcG90c0VuYWJsZWQgfHxcbiAgICAgICAgICAgICAgICAgICAgICgob3B0aW9ucy5nZXQoJ21pblNwb3RDb2xvcicpIHx8IG9wdGlvbnMuZ2V0KCdtYXhTcG90Q29sb3InKSkgJiYgKHl2YWx1ZXNbMF0gPT09IHRoaXMubWlueSB8fCB5dmFsdWVzWzBdID09PSB0aGlzLm1heHkpKSkge1xuICAgICAgICAgICAgICAgICAgICBjYW52YXNMZWZ0ICs9IE1hdGguY2VpbChzcG90UmFkaXVzKTtcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzV2lkdGggLT0gTWF0aC5jZWlsKHNwb3RSYWRpdXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoaGxTcG90c0VuYWJsZWQgfHwgb3B0aW9ucy5nZXQoJ3Nwb3RDb2xvcicpIHx8XG4gICAgICAgICAgICAgICAgICAgIChvcHRpb25zLmdldCgnbWluU3BvdENvbG9yJykgfHwgb3B0aW9ucy5nZXQoJ21heFNwb3RDb2xvcicpICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAoeXZhbHVlc1t5dmFsbGFzdF0gPT09IHRoaXMubWlueSB8fCB5dmFsdWVzW3l2YWxsYXN0XSA9PT0gdGhpcy5tYXh5KSkpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzV2lkdGggLT0gTWF0aC5jZWlsKHNwb3RSYWRpdXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICBjYW52YXNIZWlnaHQtLTtcblxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuZ2V0KCdub3JtYWxSYW5nZU1pbicpICE9PSB1bmRlZmluZWQgJiYgIW9wdGlvbnMuZ2V0KCdkcmF3Tm9ybWFsT25Ub3AnKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZHJhd05vcm1hbFJhbmdlKGNhbnZhc0xlZnQsIGNhbnZhc1RvcCwgY2FudmFzSGVpZ2h0LCBjYW52YXNXaWR0aCwgcmFuZ2V5KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcGF0aCA9IFtdO1xuICAgICAgICAgICAgcGF0aHMgPSBbcGF0aF07XG4gICAgICAgICAgICBsYXN0ID0gbmV4dCA9IG51bGw7XG4gICAgICAgICAgICB5dmFsY291bnQgPSB5dmFsdWVzLmxlbmd0aDtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCB5dmFsY291bnQ7IGkrKykge1xuICAgICAgICAgICAgICAgIHggPSB4dmFsdWVzW2ldO1xuICAgICAgICAgICAgICAgIHhuZXh0ID0geHZhbHVlc1tpICsgMV07XG4gICAgICAgICAgICAgICAgeSA9IHl2YWx1ZXNbaV07XG4gICAgICAgICAgICAgICAgeHBvcyA9IGNhbnZhc0xlZnQgKyBNYXRoLnJvdW5kKCh4IC0gdGhpcy5taW54KSAqIChjYW52YXNXaWR0aCAvIHJhbmdleCkpO1xuICAgICAgICAgICAgICAgIHhwb3NuZXh0ID0gaSA8IHl2YWxjb3VudCAtIDEgPyBjYW52YXNMZWZ0ICsgTWF0aC5yb3VuZCgoeG5leHQgLSB0aGlzLm1pbngpICogKGNhbnZhc1dpZHRoIC8gcmFuZ2V4KSkgOiBjYW52YXNXaWR0aDtcbiAgICAgICAgICAgICAgICBuZXh0ID0geHBvcyArICgoeHBvc25leHQgLSB4cG9zKSAvIDIpO1xuICAgICAgICAgICAgICAgIHJlZ2lvbk1hcFtpXSA9IFtsYXN0IHx8IDAsIG5leHQsIGldO1xuICAgICAgICAgICAgICAgIGxhc3QgPSBuZXh0O1xuICAgICAgICAgICAgICAgIGlmICh5ID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoeXZhbHVlc1tpIC0gMV0gIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aHMucHVzaChwYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHZlcnRpY2VzLnB1c2gobnVsbCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoeSA8IHRoaXMubWlueSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgeSA9IHRoaXMubWlueTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoeSA+IHRoaXMubWF4eSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgeSA9IHRoaXMubWF4eTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoIXBhdGgubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBwcmV2aW91cyB2YWx1ZSB3YXMgbnVsbFxuICAgICAgICAgICAgICAgICAgICAgICAgcGF0aC5wdXNoKFt4cG9zLCBjYW52YXNUb3AgKyBjYW52YXNIZWlnaHRdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2ZXJ0ZXggPSBbeHBvcywgY2FudmFzVG9wICsgTWF0aC5yb3VuZChjYW52YXNIZWlnaHQgLSAoY2FudmFzSGVpZ2h0ICogKCh5IC0gdGhpcy5taW55KSAvIHJhbmdleSkpKV07XG4gICAgICAgICAgICAgICAgICAgIHBhdGgucHVzaCh2ZXJ0ZXgpO1xuICAgICAgICAgICAgICAgICAgICB2ZXJ0aWNlcy5wdXNoKHZlcnRleCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsaW5lU2hhcGVzID0gW107XG4gICAgICAgICAgICBmaWxsU2hhcGVzID0gW107XG4gICAgICAgICAgICBwbGVuID0gcGF0aHMubGVuZ3RoO1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHBsZW47IGkrKykge1xuICAgICAgICAgICAgICAgIHBhdGggPSBwYXRoc1tpXTtcbiAgICAgICAgICAgICAgICBpZiAocGF0aC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuZ2V0KCdmaWxsQ29sb3InKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGF0aC5wdXNoKFtwYXRoW3BhdGgubGVuZ3RoIC0gMV1bMF0sIChjYW52YXNUb3AgKyBjYW52YXNIZWlnaHQpXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaWxsU2hhcGVzLnB1c2gocGF0aC5zbGljZSgwKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXRoLnBvcCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIGlmIHRoZXJlJ3Mgb25seSBhIHNpbmdsZSBwb2ludCBpbiB0aGlzIHBhdGgsIHRoZW4gd2Ugd2FudCB0byBkaXNwbGF5IGl0XG4gICAgICAgICAgICAgICAgICAgIC8vIGFzIGEgdmVydGljYWwgbGluZSB3aGljaCBtZWFucyB3ZSBrZWVwIHBhdGhbMF0gIGFzIGlzXG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXRoLmxlbmd0aCA+IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVsc2Ugd2Ugd2FudCB0aGUgZmlyc3QgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhdGhbMF0gPSBbcGF0aFswXVswXSwgcGF0aFsxXVsxXV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbGluZVNoYXBlcy5wdXNoKHBhdGgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gZHJhdyB0aGUgZmlsbCBmaXJzdCwgdGhlbiBvcHRpb25hbGx5IHRoZSBub3JtYWwgcmFuZ2UsIHRoZW4gdGhlIGxpbmUgb24gdG9wIG9mIHRoYXRcbiAgICAgICAgICAgIHBsZW4gPSBmaWxsU2hhcGVzLmxlbmd0aDtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBwbGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgICB0YXJnZXQuZHJhd1NoYXBlKGZpbGxTaGFwZXNbaV0sXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZ2V0KCdmaWxsQ29sb3InKSwgb3B0aW9ucy5nZXQoJ2ZpbGxDb2xvcicpKS5hcHBlbmQoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuZ2V0KCdub3JtYWxSYW5nZU1pbicpICE9PSB1bmRlZmluZWQgJiYgb3B0aW9ucy5nZXQoJ2RyYXdOb3JtYWxPblRvcCcpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kcmF3Tm9ybWFsUmFuZ2UoY2FudmFzTGVmdCwgY2FudmFzVG9wLCBjYW52YXNIZWlnaHQsIGNhbnZhc1dpZHRoLCByYW5nZXkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBwbGVuID0gbGluZVNoYXBlcy5sZW5ndGg7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgcGxlbjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0LmRyYXdTaGFwZShsaW5lU2hhcGVzW2ldLCBvcHRpb25zLmdldCgnbGluZUNvbG9yJyksIHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5nZXQoJ2xpbmVXaWR0aCcpKS5hcHBlbmQoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHNwb3RSYWRpdXMgJiYgb3B0aW9ucy5nZXQoJ3ZhbHVlU3BvdHMnKSkge1xuICAgICAgICAgICAgICAgIHZhbHVlU3BvdHMgPSBvcHRpb25zLmdldCgndmFsdWVTcG90cycpO1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZVNwb3RzLmdldCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlU3BvdHMgPSBuZXcgUmFuZ2VNYXAodmFsdWVTcG90cyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCB5dmFsY291bnQ7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBjb2xvciA9IHZhbHVlU3BvdHMuZ2V0KHl2YWx1ZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY29sb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldC5kcmF3Q2lyY2xlKGNhbnZhc0xlZnQgKyBNYXRoLnJvdW5kKCh4dmFsdWVzW2ldIC0gdGhpcy5taW54KSAqIChjYW52YXNXaWR0aCAvIHJhbmdleCkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbnZhc1RvcCArIE1hdGgucm91bmQoY2FudmFzSGVpZ2h0IC0gKGNhbnZhc0hlaWdodCAqICgoeXZhbHVlc1tpXSAtIHRoaXMubWlueSkgLyByYW5nZXkpKSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BvdFJhZGl1cywgdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yKS5hcHBlbmQoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNwb3RSYWRpdXMgJiYgb3B0aW9ucy5nZXQoJ3Nwb3RDb2xvcicpICYmIHl2YWx1ZXNbeXZhbGxhc3RdICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0LmRyYXdDaXJjbGUoY2FudmFzTGVmdCArIE1hdGgucm91bmQoKHh2YWx1ZXNbeHZhbHVlcy5sZW5ndGggLSAxXSAtIHRoaXMubWlueCkgKiAoY2FudmFzV2lkdGggLyByYW5nZXgpKSxcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzVG9wICsgTWF0aC5yb3VuZChjYW52YXNIZWlnaHQgLSAoY2FudmFzSGVpZ2h0ICogKCh5dmFsdWVzW3l2YWxsYXN0XSAtIHRoaXMubWlueSkgLyByYW5nZXkpKSksXG4gICAgICAgICAgICAgICAgICAgIHNwb3RSYWRpdXMsIHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5nZXQoJ3Nwb3RDb2xvcicpKS5hcHBlbmQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLm1heHkgIT09IHRoaXMubWlueW9yZykge1xuICAgICAgICAgICAgICAgIGlmIChzcG90UmFkaXVzICYmIG9wdGlvbnMuZ2V0KCdtaW5TcG90Q29sb3InKSkge1xuICAgICAgICAgICAgICAgICAgICB4ID0geHZhbHVlc1skLmluQXJyYXkodGhpcy5taW55b3JnLCB5dmFsdWVzKV07XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldC5kcmF3Q2lyY2xlKGNhbnZhc0xlZnQgKyBNYXRoLnJvdW5kKCh4IC0gdGhpcy5taW54KSAqIChjYW52YXNXaWR0aCAvIHJhbmdleCkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzVG9wICsgTWF0aC5yb3VuZChjYW52YXNIZWlnaHQgLSAoY2FudmFzSGVpZ2h0ICogKCh0aGlzLm1pbnlvcmcgLSB0aGlzLm1pbnkpIC8gcmFuZ2V5KSkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3BvdFJhZGl1cywgdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5nZXQoJ21pblNwb3RDb2xvcicpKS5hcHBlbmQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHNwb3RSYWRpdXMgJiYgb3B0aW9ucy5nZXQoJ21heFNwb3RDb2xvcicpKSB7XG4gICAgICAgICAgICAgICAgICAgIHggPSB4dmFsdWVzWyQuaW5BcnJheSh0aGlzLm1heHlvcmcsIHl2YWx1ZXMpXTtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LmRyYXdDaXJjbGUoY2FudmFzTGVmdCArIE1hdGgucm91bmQoKHggLSB0aGlzLm1pbngpICogKGNhbnZhc1dpZHRoIC8gcmFuZ2V4KSksXG4gICAgICAgICAgICAgICAgICAgICAgICBjYW52YXNUb3AgKyBNYXRoLnJvdW5kKGNhbnZhc0hlaWdodCAtIChjYW52YXNIZWlnaHQgKiAoKHRoaXMubWF4eW9yZyAtIHRoaXMubWlueSkgLyByYW5nZXkpKSksXG4gICAgICAgICAgICAgICAgICAgICAgICBzcG90UmFkaXVzLCB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmdldCgnbWF4U3BvdENvbG9yJykpLmFwcGVuZCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5sYXN0U2hhcGVJZCA9IHRhcmdldC5nZXRMYXN0U2hhcGVJZCgpO1xuICAgICAgICAgICAgdGhpcy5jYW52YXNUb3AgPSBjYW52YXNUb3A7XG4gICAgICAgICAgICB0YXJnZXQucmVuZGVyKCk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIEJhciBjaGFydHNcbiAgICAgKi9cbiAgICAkLmZuLnNwYXJrbGluZS5iYXIgPSBiYXIgPSBjcmVhdGVDbGFzcygkLmZuLnNwYXJrbGluZS5fYmFzZSwgYmFySGlnaGxpZ2h0TWl4aW4sIHtcbiAgICAgICAgdHlwZTogJ2JhcicsXG5cbiAgICAgICAgaW5pdDogZnVuY3Rpb24gKGVsLCB2YWx1ZXMsIG9wdGlvbnMsIHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgICAgIHZhciBiYXJXaWR0aCA9IHBhcnNlSW50KG9wdGlvbnMuZ2V0KCdiYXJXaWR0aCcpLCAxMCksXG4gICAgICAgICAgICAgICAgYmFyU3BhY2luZyA9IHBhcnNlSW50KG9wdGlvbnMuZ2V0KCdiYXJTcGFjaW5nJyksIDEwKSxcbiAgICAgICAgICAgICAgICBjaGFydFJhbmdlTWluID0gb3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNaW4nKSxcbiAgICAgICAgICAgICAgICBjaGFydFJhbmdlTWF4ID0gb3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNYXgnKSxcbiAgICAgICAgICAgICAgICBjaGFydFJhbmdlQ2xpcCA9IG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlQ2xpcCcpLFxuICAgICAgICAgICAgICAgIHN0YWNrTWluID0gSW5maW5pdHksXG4gICAgICAgICAgICAgICAgc3RhY2tNYXggPSAtSW5maW5pdHksXG4gICAgICAgICAgICAgICAgaXNTdGFja1N0cmluZywgZ3JvdXBNaW4sIGdyb3VwTWF4LCBzdGFja1JhbmdlcyxcbiAgICAgICAgICAgICAgICBudW1WYWx1ZXMsIGksIHZsZW4sIHJhbmdlLCB6ZXJvQXhpcywgeGF4aXNPZmZzZXQsIG1pbiwgbWF4LCBjbGlwTWluLCBjbGlwTWF4LFxuICAgICAgICAgICAgICAgIHN0YWNrZWQsIHZsaXN0LCBqLCBzbGVuLCBzdmFscywgdmFsLCB5b2Zmc2V0LCB5TWF4Q2FsYywgY2FudmFzSGVpZ2h0RWY7XG4gICAgICAgICAgICBiYXIuX3N1cGVyLmluaXQuY2FsbCh0aGlzLCBlbCwgdmFsdWVzLCBvcHRpb25zLCB3aWR0aCwgaGVpZ2h0KTtcblxuICAgICAgICAgICAgLy8gc2NhbiB2YWx1ZXMgdG8gZGV0ZXJtaW5lIHdoZXRoZXIgdG8gc3RhY2sgYmFyc1xuICAgICAgICAgICAgZm9yIChpID0gMCwgdmxlbiA9IHZhbHVlcy5sZW5ndGg7IGkgPCB2bGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YWwgPSB2YWx1ZXNbaV07XG4gICAgICAgICAgICAgICAgaXNTdGFja1N0cmluZyA9IHR5cGVvZih2YWwpID09PSAnc3RyaW5nJyAmJiB2YWwuaW5kZXhPZignOicpID4gLTE7XG4gICAgICAgICAgICAgICAgaWYgKGlzU3RhY2tTdHJpbmcgfHwgJC5pc0FycmF5KHZhbCkpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhY2tlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpc1N0YWNrU3RyaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWwgPSB2YWx1ZXNbaV0gPSBub3JtYWxpemVWYWx1ZXModmFsLnNwbGl0KCc6JykpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhbCA9IHJlbW92ZSh2YWwsIG51bGwpOyAvLyBtaW4vbWF4IHdpbGwgdHJlYXQgbnVsbCBhcyB6ZXJvXG4gICAgICAgICAgICAgICAgICAgIGdyb3VwTWluID0gTWF0aC5taW4uYXBwbHkoTWF0aCwgdmFsKTtcbiAgICAgICAgICAgICAgICAgICAgZ3JvdXBNYXggPSBNYXRoLm1heC5hcHBseShNYXRoLCB2YWwpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZ3JvdXBNaW4gPCBzdGFja01pbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RhY2tNaW4gPSBncm91cE1pbjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoZ3JvdXBNYXggPiBzdGFja01heCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RhY2tNYXggPSBncm91cE1heDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5zdGFja2VkID0gc3RhY2tlZDtcbiAgICAgICAgICAgIHRoaXMucmVnaW9uU2hhcGVzID0ge307XG4gICAgICAgICAgICB0aGlzLmJhcldpZHRoID0gYmFyV2lkdGg7XG4gICAgICAgICAgICB0aGlzLmJhclNwYWNpbmcgPSBiYXJTcGFjaW5nO1xuICAgICAgICAgICAgdGhpcy50b3RhbEJhcldpZHRoID0gYmFyV2lkdGggKyBiYXJTcGFjaW5nO1xuICAgICAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoID0gKHZhbHVlcy5sZW5ndGggKiBiYXJXaWR0aCkgKyAoKHZhbHVlcy5sZW5ndGggLSAxKSAqIGJhclNwYWNpbmcpO1xuXG4gICAgICAgICAgICB0aGlzLmluaXRUYXJnZXQoKTtcblxuICAgICAgICAgICAgaWYgKGNoYXJ0UmFuZ2VDbGlwKSB7XG4gICAgICAgICAgICAgICAgY2xpcE1pbiA9IGNoYXJ0UmFuZ2VNaW4gPT09IHVuZGVmaW5lZCA/IC1JbmZpbml0eSA6IGNoYXJ0UmFuZ2VNaW47XG4gICAgICAgICAgICAgICAgY2xpcE1heCA9IGNoYXJ0UmFuZ2VNYXggPT09IHVuZGVmaW5lZCA/IEluZmluaXR5IDogY2hhcnRSYW5nZU1heDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbnVtVmFsdWVzID0gW107XG4gICAgICAgICAgICBzdGFja1JhbmdlcyA9IHN0YWNrZWQgPyBbXSA6IG51bVZhbHVlcztcbiAgICAgICAgICAgIHZhciBzdGFja1RvdGFscyA9IFtdO1xuICAgICAgICAgICAgdmFyIHN0YWNrUmFuZ2VzTmVnID0gW107XG4gICAgICAgICAgICBmb3IgKGkgPSAwLCB2bGVuID0gdmFsdWVzLmxlbmd0aDsgaSA8IHZsZW47IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChzdGFja2VkKSB7XG4gICAgICAgICAgICAgICAgICAgIHZsaXN0ID0gdmFsdWVzW2ldO1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZXNbaV0gPSBzdmFscyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBzdGFja1RvdGFsc1tpXSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIHN0YWNrUmFuZ2VzW2ldID0gc3RhY2tSYW5nZXNOZWdbaV0gPSAwO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGogPSAwLCBzbGVuID0gdmxpc3QubGVuZ3RoOyBqIDwgc2xlbjsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWwgPSBzdmFsc1tqXSA9IGNoYXJ0UmFuZ2VDbGlwID8gY2xpcHZhbCh2bGlzdFtqXSwgY2xpcE1pbiwgY2xpcE1heCkgOiB2bGlzdFtqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWwgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFja1RvdGFsc1tpXSArPSB2YWw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGFja01pbiA8IDAgJiYgc3RhY2tNYXggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWwgPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFja1Jhbmdlc05lZ1tpXSArPSBNYXRoLmFicyh2YWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhY2tSYW5nZXNbaV0gKz0gdmFsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhY2tSYW5nZXNbaV0gKz0gTWF0aC5hYnModmFsIC0gKHZhbCA8IDAgPyBzdGFja01heCA6IHN0YWNrTWluKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bVZhbHVlcy5wdXNoKHZhbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YWwgPSBjaGFydFJhbmdlQ2xpcCA/IGNsaXB2YWwodmFsdWVzW2ldLCBjbGlwTWluLCBjbGlwTWF4KSA6IHZhbHVlc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgdmFsID0gdmFsdWVzW2ldID0gbm9ybWFsaXplVmFsdWUodmFsKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbnVtVmFsdWVzLnB1c2godmFsKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubWF4ID0gbWF4ID0gTWF0aC5tYXguYXBwbHkoTWF0aCwgbnVtVmFsdWVzKTtcbiAgICAgICAgICAgIHRoaXMubWluID0gbWluID0gTWF0aC5taW4uYXBwbHkoTWF0aCwgbnVtVmFsdWVzKTtcbiAgICAgICAgICAgIHRoaXMuc3RhY2tNYXggPSBzdGFja01heCA9IHN0YWNrZWQgPyBNYXRoLm1heC5hcHBseShNYXRoLCBzdGFja1RvdGFscykgOiBtYXg7XG4gICAgICAgICAgICB0aGlzLnN0YWNrTWluID0gc3RhY2tNaW4gPSBzdGFja2VkID8gTWF0aC5taW4uYXBwbHkoTWF0aCwgbnVtVmFsdWVzKSA6IG1pbjtcblxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlTWluJykgIT09IHVuZGVmaW5lZCAmJiAob3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VDbGlwJykgfHwgb3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNaW4nKSA8IG1pbikpIHtcbiAgICAgICAgICAgICAgICBtaW4gPSBvcHRpb25zLmdldCgnY2hhcnRSYW5nZU1pbicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlTWF4JykgIT09IHVuZGVmaW5lZCAmJiAob3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VDbGlwJykgfHwgb3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNYXgnKSA+IG1heCkpIHtcbiAgICAgICAgICAgICAgICBtYXggPSBvcHRpb25zLmdldCgnY2hhcnRSYW5nZU1heCcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLnplcm9BeGlzID0gemVyb0F4aXMgPSBvcHRpb25zLmdldCgnemVyb0F4aXMnLCB0cnVlKTtcbiAgICAgICAgICAgIGlmIChtaW4gPD0gMCAmJiBtYXggPj0gMCAmJiB6ZXJvQXhpcykge1xuICAgICAgICAgICAgICAgIHhheGlzT2Zmc2V0ID0gMDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoemVyb0F4aXMgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICB4YXhpc09mZnNldCA9IG1pbjtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobWluID4gMCkge1xuICAgICAgICAgICAgICAgIHhheGlzT2Zmc2V0ID0gbWluO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB4YXhpc09mZnNldCA9IG1heDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMueGF4aXNPZmZzZXQgPSB4YXhpc09mZnNldDtcblxuICAgICAgICAgICAgcmFuZ2UgPSBzdGFja2VkID8gKE1hdGgubWF4LmFwcGx5KE1hdGgsIHN0YWNrUmFuZ2VzKSArIE1hdGgubWF4LmFwcGx5KE1hdGgsIHN0YWNrUmFuZ2VzTmVnKSkgOiBtYXggLSBtaW47XG5cbiAgICAgICAgICAgIC8vIGFzIHdlIHBsb3QgemVyby9taW4gdmFsdWVzIGEgc2luZ2xlIHBpeGVsIGxpbmUsIHdlIGFkZCBhIHBpeGVsIHRvIGFsbCBvdGhlclxuICAgICAgICAgICAgLy8gdmFsdWVzIC0gUmVkdWNlIHRoZSBlZmZlY3RpdmUgY2FudmFzIHNpemUgdG8gc3VpdFxuICAgICAgICAgICAgdGhpcy5jYW52YXNIZWlnaHRFZiA9ICh6ZXJvQXhpcyAmJiBtaW4gPCAwKSA/IHRoaXMuY2FudmFzSGVpZ2h0IC0gMiA6IHRoaXMuY2FudmFzSGVpZ2h0IC0gMTtcblxuICAgICAgICAgICAgaWYgKG1pbiA8IHhheGlzT2Zmc2V0KSB7XG4gICAgICAgICAgICAgICAgeU1heENhbGMgPSAoc3RhY2tlZCAmJiBtYXggPj0gMCkgPyBzdGFja01heCA6IG1heDtcbiAgICAgICAgICAgICAgICB5b2Zmc2V0ID0gKHlNYXhDYWxjIC0geGF4aXNPZmZzZXQpIC8gcmFuZ2UgKiB0aGlzLmNhbnZhc0hlaWdodDtcbiAgICAgICAgICAgICAgICBpZiAoeW9mZnNldCAhPT0gTWF0aC5jZWlsKHlvZmZzZXQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2FudmFzSGVpZ2h0RWYgLT0gMjtcbiAgICAgICAgICAgICAgICAgICAgeW9mZnNldCA9IE1hdGguY2VpbCh5b2Zmc2V0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHlvZmZzZXQgPSB0aGlzLmNhbnZhc0hlaWdodDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMueW9mZnNldCA9IHlvZmZzZXQ7XG5cbiAgICAgICAgICAgIGlmICgkLmlzQXJyYXkob3B0aW9ucy5nZXQoJ2NvbG9yTWFwJykpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jb2xvck1hcEJ5SW5kZXggPSBvcHRpb25zLmdldCgnY29sb3JNYXAnKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbG9yTWFwQnlWYWx1ZSA9IG51bGw7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuY29sb3JNYXBCeUluZGV4ID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbG9yTWFwQnlWYWx1ZSA9IG9wdGlvbnMuZ2V0KCdjb2xvck1hcCcpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbG9yTWFwQnlWYWx1ZSAmJiB0aGlzLmNvbG9yTWFwQnlWYWx1ZS5nZXQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbG9yTWFwQnlWYWx1ZSA9IG5ldyBSYW5nZU1hcCh0aGlzLmNvbG9yTWFwQnlWYWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLnJhbmdlID0gcmFuZ2U7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2V0UmVnaW9uOiBmdW5jdGlvbiAoZWwsIHgsIHkpIHtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBNYXRoLmZsb29yKHggLyB0aGlzLnRvdGFsQmFyV2lkdGgpO1xuICAgICAgICAgICAgcmV0dXJuIChyZXN1bHQgPCAwIHx8IHJlc3VsdCA+PSB0aGlzLnZhbHVlcy5sZW5ndGgpID8gdW5kZWZpbmVkIDogcmVzdWx0O1xuICAgICAgICB9LFxuXG4gICAgICAgIGdldEN1cnJlbnRSZWdpb25GaWVsZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBjdXJyZW50UmVnaW9uID0gdGhpcy5jdXJyZW50UmVnaW9uLFxuICAgICAgICAgICAgICAgIHZhbHVlcyA9IGVuc3VyZUFycmF5KHRoaXMudmFsdWVzW2N1cnJlbnRSZWdpb25dKSxcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBbXSxcbiAgICAgICAgICAgICAgICB2YWx1ZSwgaTtcbiAgICAgICAgICAgIGZvciAoaSA9IHZhbHVlcy5sZW5ndGg7IGktLTspIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlc1tpXTtcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIGlzTnVsbDogdmFsdWUgPT09IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiB2YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6IHRoaXMuY2FsY0NvbG9yKGksIHZhbHVlLCBjdXJyZW50UmVnaW9uKSxcbiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0OiBjdXJyZW50UmVnaW9uXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9LFxuXG4gICAgICAgIGNhbGNDb2xvcjogZnVuY3Rpb24gKHN0YWNrbnVtLCB2YWx1ZSwgdmFsdWVudW0pIHtcbiAgICAgICAgICAgIHZhciBjb2xvck1hcEJ5SW5kZXggPSB0aGlzLmNvbG9yTWFwQnlJbmRleCxcbiAgICAgICAgICAgICAgICBjb2xvck1hcEJ5VmFsdWUgPSB0aGlzLmNvbG9yTWFwQnlWYWx1ZSxcbiAgICAgICAgICAgICAgICBvcHRpb25zID0gdGhpcy5vcHRpb25zLFxuICAgICAgICAgICAgICAgIGNvbG9yLCBuZXdDb2xvcjtcbiAgICAgICAgICAgIGlmICh0aGlzLnN0YWNrZWQpIHtcbiAgICAgICAgICAgICAgICBjb2xvciA9IG9wdGlvbnMuZ2V0KCdzdGFja2VkQmFyQ29sb3InKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29sb3IgPSAodmFsdWUgPCAwKSA/IG9wdGlvbnMuZ2V0KCduZWdCYXJDb2xvcicpIDogb3B0aW9ucy5nZXQoJ2JhckNvbG9yJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodmFsdWUgPT09IDAgJiYgb3B0aW9ucy5nZXQoJ3plcm9Db2xvcicpICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBjb2xvciA9IG9wdGlvbnMuZ2V0KCd6ZXJvQ29sb3InKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjb2xvck1hcEJ5VmFsdWUgJiYgKG5ld0NvbG9yID0gY29sb3JNYXBCeVZhbHVlLmdldCh2YWx1ZSkpKSB7XG4gICAgICAgICAgICAgICAgY29sb3IgPSBuZXdDb2xvcjtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoY29sb3JNYXBCeUluZGV4ICYmIGNvbG9yTWFwQnlJbmRleC5sZW5ndGggPiB2YWx1ZW51bSkge1xuICAgICAgICAgICAgICAgIGNvbG9yID0gY29sb3JNYXBCeUluZGV4W3ZhbHVlbnVtXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAkLmlzQXJyYXkoY29sb3IpID8gY29sb3Jbc3RhY2tudW0gJSBjb2xvci5sZW5ndGhdIDogY29sb3I7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJlbmRlciBiYXIocykgZm9yIGEgcmVnaW9uXG4gICAgICAgICAqL1xuICAgICAgICByZW5kZXJSZWdpb246IGZ1bmN0aW9uICh2YWx1ZW51bSwgaGlnaGxpZ2h0KSB7XG4gICAgICAgICAgICB2YXIgdmFscyA9IHRoaXMudmFsdWVzW3ZhbHVlbnVtXSxcbiAgICAgICAgICAgICAgICBvcHRpb25zID0gdGhpcy5vcHRpb25zLFxuICAgICAgICAgICAgICAgIHhheGlzT2Zmc2V0ID0gdGhpcy54YXhpc09mZnNldCxcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBbXSxcbiAgICAgICAgICAgICAgICByYW5nZSA9IHRoaXMucmFuZ2UsXG4gICAgICAgICAgICAgICAgc3RhY2tlZCA9IHRoaXMuc3RhY2tlZCxcbiAgICAgICAgICAgICAgICB0YXJnZXQgPSB0aGlzLnRhcmdldCxcbiAgICAgICAgICAgICAgICB4ID0gdmFsdWVudW0gKiB0aGlzLnRvdGFsQmFyV2lkdGgsXG4gICAgICAgICAgICAgICAgY2FudmFzSGVpZ2h0RWYgPSB0aGlzLmNhbnZhc0hlaWdodEVmLFxuICAgICAgICAgICAgICAgIHlvZmZzZXQgPSB0aGlzLnlvZmZzZXQsXG4gICAgICAgICAgICAgICAgeSwgaGVpZ2h0LCBjb2xvciwgaXNOdWxsLCB5b2Zmc2V0TmVnLCBpLCB2YWxjb3VudCwgdmFsLCBtaW5QbG90dGVkLCBhbGxNaW47XG5cbiAgICAgICAgICAgIHZhbHMgPSAkLmlzQXJyYXkodmFscykgPyB2YWxzIDogW3ZhbHNdO1xuICAgICAgICAgICAgdmFsY291bnQgPSB2YWxzLmxlbmd0aDtcbiAgICAgICAgICAgIHZhbCA9IHZhbHNbMF07XG4gICAgICAgICAgICBpc051bGwgPSBhbGwobnVsbCwgdmFscyk7XG4gICAgICAgICAgICBhbGxNaW4gPSBhbGwoeGF4aXNPZmZzZXQsIHZhbHMsIHRydWUpO1xuXG4gICAgICAgICAgICBpZiAoaXNOdWxsKSB7XG4gICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuZ2V0KCdudWxsQ29sb3InKSkge1xuICAgICAgICAgICAgICAgICAgICBjb2xvciA9IGhpZ2hsaWdodCA/IG9wdGlvbnMuZ2V0KCdudWxsQ29sb3InKSA6IHRoaXMuY2FsY0hpZ2hsaWdodENvbG9yKG9wdGlvbnMuZ2V0KCdudWxsQ29sb3InKSwgb3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgIHkgPSAoeW9mZnNldCA+IDApID8geW9mZnNldCAtIDEgOiB5b2Zmc2V0O1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGFyZ2V0LmRyYXdSZWN0KHgsIHksIHRoaXMuYmFyV2lkdGggLSAxLCAwLCBjb2xvciwgY29sb3IpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgeW9mZnNldE5lZyA9IHlvZmZzZXQ7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgdmFsY291bnQ7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhbCA9IHZhbHNbaV07XG5cbiAgICAgICAgICAgICAgICBpZiAoc3RhY2tlZCAmJiB2YWwgPT09IHhheGlzT2Zmc2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghYWxsTWluIHx8IG1pblBsb3R0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIG1pblBsb3R0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChyYW5nZSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0ID0gTWF0aC5mbG9vcihjYW52YXNIZWlnaHRFZiAqICgoTWF0aC5hYnModmFsIC0geGF4aXNPZmZzZXQpIC8gcmFuZ2UpKSkgKyAxO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGhlaWdodCA9IDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh2YWwgPCB4YXhpc09mZnNldCB8fCAodmFsID09PSB4YXhpc09mZnNldCAmJiB5b2Zmc2V0ID09PSAwKSkge1xuICAgICAgICAgICAgICAgICAgICB5ID0geW9mZnNldE5lZztcbiAgICAgICAgICAgICAgICAgICAgeW9mZnNldE5lZyArPSBoZWlnaHQ7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgeSA9IHlvZmZzZXQgLSBoZWlnaHQ7XG4gICAgICAgICAgICAgICAgICAgIHlvZmZzZXQgLT0gaGVpZ2h0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb2xvciA9IHRoaXMuY2FsY0NvbG9yKGksIHZhbCwgdmFsdWVudW0pO1xuICAgICAgICAgICAgICAgIGlmIChoaWdobGlnaHQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29sb3IgPSB0aGlzLmNhbGNIaWdobGlnaHRDb2xvcihjb2xvciwgb3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHRhcmdldC5kcmF3UmVjdCh4LCB5LCB0aGlzLmJhcldpZHRoIC0gMSwgaGVpZ2h0IC0gMSwgY29sb3IsIGNvbG9yKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocmVzdWx0Lmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHRbMF07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBUcmlzdGF0ZSBjaGFydHNcbiAgICAgKi9cbiAgICAkLmZuLnNwYXJrbGluZS50cmlzdGF0ZSA9IHRyaXN0YXRlID0gY3JlYXRlQ2xhc3MoJC5mbi5zcGFya2xpbmUuX2Jhc2UsIGJhckhpZ2hsaWdodE1peGluLCB7XG4gICAgICAgIHR5cGU6ICd0cmlzdGF0ZScsXG5cbiAgICAgICAgaW5pdDogZnVuY3Rpb24gKGVsLCB2YWx1ZXMsIG9wdGlvbnMsIHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgICAgIHZhciBiYXJXaWR0aCA9IHBhcnNlSW50KG9wdGlvbnMuZ2V0KCdiYXJXaWR0aCcpLCAxMCksXG4gICAgICAgICAgICAgICAgYmFyU3BhY2luZyA9IHBhcnNlSW50KG9wdGlvbnMuZ2V0KCdiYXJTcGFjaW5nJyksIDEwKTtcbiAgICAgICAgICAgIHRyaXN0YXRlLl9zdXBlci5pbml0LmNhbGwodGhpcywgZWwsIHZhbHVlcywgb3B0aW9ucywgd2lkdGgsIGhlaWdodCk7XG5cbiAgICAgICAgICAgIHRoaXMucmVnaW9uU2hhcGVzID0ge307XG4gICAgICAgICAgICB0aGlzLmJhcldpZHRoID0gYmFyV2lkdGg7XG4gICAgICAgICAgICB0aGlzLmJhclNwYWNpbmcgPSBiYXJTcGFjaW5nO1xuICAgICAgICAgICAgdGhpcy50b3RhbEJhcldpZHRoID0gYmFyV2lkdGggKyBiYXJTcGFjaW5nO1xuICAgICAgICAgICAgdGhpcy52YWx1ZXMgPSAkLm1hcCh2YWx1ZXMsIE51bWJlcik7XG4gICAgICAgICAgICB0aGlzLndpZHRoID0gd2lkdGggPSAodmFsdWVzLmxlbmd0aCAqIGJhcldpZHRoKSArICgodmFsdWVzLmxlbmd0aCAtIDEpICogYmFyU3BhY2luZyk7XG5cbiAgICAgICAgICAgIGlmICgkLmlzQXJyYXkob3B0aW9ucy5nZXQoJ2NvbG9yTWFwJykpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jb2xvck1hcEJ5SW5kZXggPSBvcHRpb25zLmdldCgnY29sb3JNYXAnKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbG9yTWFwQnlWYWx1ZSA9IG51bGw7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuY29sb3JNYXBCeUluZGV4ID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbG9yTWFwQnlWYWx1ZSA9IG9wdGlvbnMuZ2V0KCdjb2xvck1hcCcpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbG9yTWFwQnlWYWx1ZSAmJiB0aGlzLmNvbG9yTWFwQnlWYWx1ZS5nZXQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbG9yTWFwQnlWYWx1ZSA9IG5ldyBSYW5nZU1hcCh0aGlzLmNvbG9yTWFwQnlWYWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5pbml0VGFyZ2V0KCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2V0UmVnaW9uOiBmdW5jdGlvbiAoZWwsIHgsIHkpIHtcbiAgICAgICAgICAgIHJldHVybiBNYXRoLmZsb29yKHggLyB0aGlzLnRvdGFsQmFyV2lkdGgpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGdldEN1cnJlbnRSZWdpb25GaWVsZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBjdXJyZW50UmVnaW9uID0gdGhpcy5jdXJyZW50UmVnaW9uO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBpc051bGw6IHRoaXMudmFsdWVzW2N1cnJlbnRSZWdpb25dID09PSB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMudmFsdWVzW2N1cnJlbnRSZWdpb25dLFxuICAgICAgICAgICAgICAgIGNvbG9yOiB0aGlzLmNhbGNDb2xvcih0aGlzLnZhbHVlc1tjdXJyZW50UmVnaW9uXSwgY3VycmVudFJlZ2lvbiksXG4gICAgICAgICAgICAgICAgb2Zmc2V0OiBjdXJyZW50UmVnaW9uXG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuXG4gICAgICAgIGNhbGNDb2xvcjogZnVuY3Rpb24gKHZhbHVlLCB2YWx1ZW51bSkge1xuICAgICAgICAgICAgdmFyIHZhbHVlcyA9IHRoaXMudmFsdWVzLFxuICAgICAgICAgICAgICAgIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnMsXG4gICAgICAgICAgICAgICAgY29sb3JNYXBCeUluZGV4ID0gdGhpcy5jb2xvck1hcEJ5SW5kZXgsXG4gICAgICAgICAgICAgICAgY29sb3JNYXBCeVZhbHVlID0gdGhpcy5jb2xvck1hcEJ5VmFsdWUsXG4gICAgICAgICAgICAgICAgY29sb3IsIG5ld0NvbG9yO1xuXG4gICAgICAgICAgICBpZiAoY29sb3JNYXBCeVZhbHVlICYmIChuZXdDb2xvciA9IGNvbG9yTWFwQnlWYWx1ZS5nZXQodmFsdWUpKSkge1xuICAgICAgICAgICAgICAgIGNvbG9yID0gbmV3Q29sb3I7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGNvbG9yTWFwQnlJbmRleCAmJiBjb2xvck1hcEJ5SW5kZXgubGVuZ3RoID4gdmFsdWVudW0pIHtcbiAgICAgICAgICAgICAgICBjb2xvciA9IGNvbG9yTWFwQnlJbmRleFt2YWx1ZW51bV07XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlc1t2YWx1ZW51bV0gPCAwKSB7XG4gICAgICAgICAgICAgICAgY29sb3IgPSBvcHRpb25zLmdldCgnbmVnQmFyQ29sb3InKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodmFsdWVzW3ZhbHVlbnVtXSA+IDApIHtcbiAgICAgICAgICAgICAgICBjb2xvciA9IG9wdGlvbnMuZ2V0KCdwb3NCYXJDb2xvcicpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb2xvciA9IG9wdGlvbnMuZ2V0KCd6ZXJvQmFyQ29sb3InKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjb2xvcjtcbiAgICAgICAgfSxcblxuICAgICAgICByZW5kZXJSZWdpb246IGZ1bmN0aW9uICh2YWx1ZW51bSwgaGlnaGxpZ2h0KSB7XG4gICAgICAgICAgICB2YXIgdmFsdWVzID0gdGhpcy52YWx1ZXMsXG4gICAgICAgICAgICAgICAgb3B0aW9ucyA9IHRoaXMub3B0aW9ucyxcbiAgICAgICAgICAgICAgICB0YXJnZXQgPSB0aGlzLnRhcmdldCxcbiAgICAgICAgICAgICAgICBjYW52YXNIZWlnaHQsIGhlaWdodCwgaGFsZkhlaWdodCxcbiAgICAgICAgICAgICAgICB4LCB5LCBjb2xvcjtcblxuICAgICAgICAgICAgY2FudmFzSGVpZ2h0ID0gdGFyZ2V0LnBpeGVsSGVpZ2h0O1xuICAgICAgICAgICAgaGFsZkhlaWdodCA9IE1hdGgucm91bmQoY2FudmFzSGVpZ2h0IC8gMik7XG5cbiAgICAgICAgICAgIHggPSB2YWx1ZW51bSAqIHRoaXMudG90YWxCYXJXaWR0aDtcbiAgICAgICAgICAgIGlmICh2YWx1ZXNbdmFsdWVudW1dIDwgMCkge1xuICAgICAgICAgICAgICAgIHkgPSBoYWxmSGVpZ2h0O1xuICAgICAgICAgICAgICAgIGhlaWdodCA9IGhhbGZIZWlnaHQgLSAxO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZXNbdmFsdWVudW1dID4gMCkge1xuICAgICAgICAgICAgICAgIHkgPSAwO1xuICAgICAgICAgICAgICAgIGhlaWdodCA9IGhhbGZIZWlnaHQgLSAxO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB5ID0gaGFsZkhlaWdodCAtIDE7XG4gICAgICAgICAgICAgICAgaGVpZ2h0ID0gMjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbG9yID0gdGhpcy5jYWxjQ29sb3IodmFsdWVzW3ZhbHVlbnVtXSwgdmFsdWVudW0pO1xuICAgICAgICAgICAgaWYgKGNvbG9yID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGhpZ2hsaWdodCkge1xuICAgICAgICAgICAgICAgIGNvbG9yID0gdGhpcy5jYWxjSGlnaGxpZ2h0Q29sb3IoY29sb3IsIG9wdGlvbnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRhcmdldC5kcmF3UmVjdCh4LCB5LCB0aGlzLmJhcldpZHRoIC0gMSwgaGVpZ2h0IC0gMSwgY29sb3IsIGNvbG9yKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogRGlzY3JldGUgY2hhcnRzXG4gICAgICovXG4gICAgJC5mbi5zcGFya2xpbmUuZGlzY3JldGUgPSBkaXNjcmV0ZSA9IGNyZWF0ZUNsYXNzKCQuZm4uc3BhcmtsaW5lLl9iYXNlLCBiYXJIaWdobGlnaHRNaXhpbiwge1xuICAgICAgICB0eXBlOiAnZGlzY3JldGUnLFxuXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uIChlbCwgdmFsdWVzLCBvcHRpb25zLCB3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICAgICAgICBkaXNjcmV0ZS5fc3VwZXIuaW5pdC5jYWxsKHRoaXMsIGVsLCB2YWx1ZXMsIG9wdGlvbnMsIHdpZHRoLCBoZWlnaHQpO1xuXG4gICAgICAgICAgICB0aGlzLnJlZ2lvblNoYXBlcyA9IHt9O1xuICAgICAgICAgICAgdGhpcy52YWx1ZXMgPSB2YWx1ZXMgPSAkLm1hcCh2YWx1ZXMsIE51bWJlcik7XG4gICAgICAgICAgICB0aGlzLm1pbiA9IE1hdGgubWluLmFwcGx5KE1hdGgsIHZhbHVlcyk7XG4gICAgICAgICAgICB0aGlzLm1heCA9IE1hdGgubWF4LmFwcGx5KE1hdGgsIHZhbHVlcyk7XG4gICAgICAgICAgICB0aGlzLnJhbmdlID0gdGhpcy5tYXggLSB0aGlzLm1pbjtcbiAgICAgICAgICAgIHRoaXMud2lkdGggPSB3aWR0aCA9IG9wdGlvbnMuZ2V0KCd3aWR0aCcpID09PSAnYXV0bycgPyB2YWx1ZXMubGVuZ3RoICogMiA6IHRoaXMud2lkdGg7XG4gICAgICAgICAgICB0aGlzLmludGVydmFsID0gTWF0aC5mbG9vcih3aWR0aCAvIHZhbHVlcy5sZW5ndGgpO1xuICAgICAgICAgICAgdGhpcy5pdGVtV2lkdGggPSB3aWR0aCAvIHZhbHVlcy5sZW5ndGg7XG4gICAgICAgICAgICBpZiAob3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNaW4nKSAhPT0gdW5kZWZpbmVkICYmIChvcHRpb25zLmdldCgnY2hhcnRSYW5nZUNsaXAnKSB8fCBvcHRpb25zLmdldCgnY2hhcnRSYW5nZU1pbicpIDwgdGhpcy5taW4pKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5taW4gPSBvcHRpb25zLmdldCgnY2hhcnRSYW5nZU1pbicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlTWF4JykgIT09IHVuZGVmaW5lZCAmJiAob3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VDbGlwJykgfHwgb3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNYXgnKSA+IHRoaXMubWF4KSkge1xuICAgICAgICAgICAgICAgIHRoaXMubWF4ID0gb3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNYXgnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuaW5pdFRhcmdldCgpO1xuICAgICAgICAgICAgaWYgKHRoaXMudGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5saW5lSGVpZ2h0ID0gb3B0aW9ucy5nZXQoJ2xpbmVIZWlnaHQnKSA9PT0gJ2F1dG8nID8gTWF0aC5yb3VuZCh0aGlzLmNhbnZhc0hlaWdodCAqIDAuMykgOiBvcHRpb25zLmdldCgnbGluZUhlaWdodCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIGdldFJlZ2lvbjogZnVuY3Rpb24gKGVsLCB4LCB5KSB7XG4gICAgICAgICAgICByZXR1cm4gTWF0aC5mbG9vcih4IC8gdGhpcy5pdGVtV2lkdGgpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGdldEN1cnJlbnRSZWdpb25GaWVsZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBjdXJyZW50UmVnaW9uID0gdGhpcy5jdXJyZW50UmVnaW9uO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBpc051bGw6IHRoaXMudmFsdWVzW2N1cnJlbnRSZWdpb25dID09PSB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMudmFsdWVzW2N1cnJlbnRSZWdpb25dLFxuICAgICAgICAgICAgICAgIG9mZnNldDogY3VycmVudFJlZ2lvblxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSxcblxuICAgICAgICByZW5kZXJSZWdpb246IGZ1bmN0aW9uICh2YWx1ZW51bSwgaGlnaGxpZ2h0KSB7XG4gICAgICAgICAgICB2YXIgdmFsdWVzID0gdGhpcy52YWx1ZXMsXG4gICAgICAgICAgICAgICAgb3B0aW9ucyA9IHRoaXMub3B0aW9ucyxcbiAgICAgICAgICAgICAgICBtaW4gPSB0aGlzLm1pbixcbiAgICAgICAgICAgICAgICBtYXggPSB0aGlzLm1heCxcbiAgICAgICAgICAgICAgICByYW5nZSA9IHRoaXMucmFuZ2UsXG4gICAgICAgICAgICAgICAgaW50ZXJ2YWwgPSB0aGlzLmludGVydmFsLFxuICAgICAgICAgICAgICAgIHRhcmdldCA9IHRoaXMudGFyZ2V0LFxuICAgICAgICAgICAgICAgIGNhbnZhc0hlaWdodCA9IHRoaXMuY2FudmFzSGVpZ2h0LFxuICAgICAgICAgICAgICAgIGxpbmVIZWlnaHQgPSB0aGlzLmxpbmVIZWlnaHQsXG4gICAgICAgICAgICAgICAgcGhlaWdodCA9IGNhbnZhc0hlaWdodCAtIGxpbmVIZWlnaHQsXG4gICAgICAgICAgICAgICAgeXRvcCwgdmFsLCBjb2xvciwgeDtcblxuICAgICAgICAgICAgdmFsID0gY2xpcHZhbCh2YWx1ZXNbdmFsdWVudW1dLCBtaW4sIG1heCk7XG4gICAgICAgICAgICB4ID0gdmFsdWVudW0gKiBpbnRlcnZhbDtcbiAgICAgICAgICAgIHl0b3AgPSBNYXRoLnJvdW5kKHBoZWlnaHQgLSBwaGVpZ2h0ICogKCh2YWwgLSBtaW4pIC8gcmFuZ2UpKTtcbiAgICAgICAgICAgIGNvbG9yID0gKG9wdGlvbnMuZ2V0KCd0aHJlc2hvbGRDb2xvcicpICYmIHZhbCA8IG9wdGlvbnMuZ2V0KCd0aHJlc2hvbGRWYWx1ZScpKSA/IG9wdGlvbnMuZ2V0KCd0aHJlc2hvbGRDb2xvcicpIDogb3B0aW9ucy5nZXQoJ2xpbmVDb2xvcicpO1xuICAgICAgICAgICAgaWYgKGhpZ2hsaWdodCkge1xuICAgICAgICAgICAgICAgIGNvbG9yID0gdGhpcy5jYWxjSGlnaGxpZ2h0Q29sb3IoY29sb3IsIG9wdGlvbnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRhcmdldC5kcmF3TGluZSh4LCB5dG9wLCB4LCB5dG9wICsgbGluZUhlaWdodCwgY29sb3IpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBCdWxsZXQgY2hhcnRzXG4gICAgICovXG4gICAgJC5mbi5zcGFya2xpbmUuYnVsbGV0ID0gYnVsbGV0ID0gY3JlYXRlQ2xhc3MoJC5mbi5zcGFya2xpbmUuX2Jhc2UsIHtcbiAgICAgICAgdHlwZTogJ2J1bGxldCcsXG5cbiAgICAgICAgaW5pdDogZnVuY3Rpb24gKGVsLCB2YWx1ZXMsIG9wdGlvbnMsIHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgICAgIHZhciBtaW4sIG1heCwgdmFscztcbiAgICAgICAgICAgIGJ1bGxldC5fc3VwZXIuaW5pdC5jYWxsKHRoaXMsIGVsLCB2YWx1ZXMsIG9wdGlvbnMsIHdpZHRoLCBoZWlnaHQpO1xuXG4gICAgICAgICAgICAvLyB2YWx1ZXM6IHRhcmdldCwgcGVyZm9ybWFuY2UsIHJhbmdlMSwgcmFuZ2UyLCByYW5nZTNcbiAgICAgICAgICAgIHRoaXMudmFsdWVzID0gdmFsdWVzID0gbm9ybWFsaXplVmFsdWVzKHZhbHVlcyk7XG4gICAgICAgICAgICAvLyB0YXJnZXQgb3IgcGVyZm9ybWFuY2UgY291bGQgYmUgbnVsbFxuICAgICAgICAgICAgdmFscyA9IHZhbHVlcy5zbGljZSgpO1xuICAgICAgICAgICAgdmFsc1swXSA9IHZhbHNbMF0gPT09IG51bGwgPyB2YWxzWzJdIDogdmFsc1swXTtcbiAgICAgICAgICAgIHZhbHNbMV0gPSB2YWx1ZXNbMV0gPT09IG51bGwgPyB2YWxzWzJdIDogdmFsc1sxXTtcbiAgICAgICAgICAgIG1pbiA9IE1hdGgubWluLmFwcGx5KE1hdGgsIHZhbHVlcyk7XG4gICAgICAgICAgICBtYXggPSBNYXRoLm1heC5hcHBseShNYXRoLCB2YWx1ZXMpO1xuICAgICAgICAgICAgaWYgKG9wdGlvbnMuZ2V0KCdiYXNlJykgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIG1pbiA9IG1pbiA8IDAgPyBtaW4gOiAwO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBtaW4gPSBvcHRpb25zLmdldCgnYmFzZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5taW4gPSBtaW47XG4gICAgICAgICAgICB0aGlzLm1heCA9IG1heDtcbiAgICAgICAgICAgIHRoaXMucmFuZ2UgPSBtYXggLSBtaW47XG4gICAgICAgICAgICB0aGlzLnNoYXBlcyA9IHt9O1xuICAgICAgICAgICAgdGhpcy52YWx1ZVNoYXBlcyA9IHt9O1xuICAgICAgICAgICAgdGhpcy5yZWdpb25kYXRhID0ge307XG4gICAgICAgICAgICB0aGlzLndpZHRoID0gd2lkdGggPSBvcHRpb25zLmdldCgnd2lkdGgnKSA9PT0gJ2F1dG8nID8gJzQuMGVtJyA6IHdpZHRoO1xuICAgICAgICAgICAgdGhpcy50YXJnZXQgPSB0aGlzLiRlbC5zaW1wbGVkcmF3KHdpZHRoLCBoZWlnaHQsIG9wdGlvbnMuZ2V0KCdjb21wb3NpdGUnKSk7XG4gICAgICAgICAgICBpZiAoIXZhbHVlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuaW5pdFRhcmdldCgpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGdldFJlZ2lvbjogZnVuY3Rpb24gKGVsLCB4LCB5KSB7XG4gICAgICAgICAgICB2YXIgc2hhcGVpZCA9IHRoaXMudGFyZ2V0LmdldFNoYXBlQXQoZWwsIHgsIHkpO1xuICAgICAgICAgICAgcmV0dXJuIChzaGFwZWlkICE9PSB1bmRlZmluZWQgJiYgdGhpcy5zaGFwZXNbc2hhcGVpZF0gIT09IHVuZGVmaW5lZCkgPyB0aGlzLnNoYXBlc1tzaGFwZWlkXSA6IHVuZGVmaW5lZDtcbiAgICAgICAgfSxcblxuICAgICAgICBnZXRDdXJyZW50UmVnaW9uRmllbGRzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgY3VycmVudFJlZ2lvbiA9IHRoaXMuY3VycmVudFJlZ2lvbjtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZmllbGRrZXk6IGN1cnJlbnRSZWdpb24uc3Vic3RyKDAsIDEpLFxuICAgICAgICAgICAgICAgIHZhbHVlOiB0aGlzLnZhbHVlc1tjdXJyZW50UmVnaW9uLnN1YnN0cigxKV0sXG4gICAgICAgICAgICAgICAgcmVnaW9uOiBjdXJyZW50UmVnaW9uXG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuXG4gICAgICAgIGNoYW5nZUhpZ2hsaWdodDogZnVuY3Rpb24gKGhpZ2hsaWdodCkge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRSZWdpb24gPSB0aGlzLmN1cnJlbnRSZWdpb24sXG4gICAgICAgICAgICAgICAgc2hhcGVpZCA9IHRoaXMudmFsdWVTaGFwZXNbY3VycmVudFJlZ2lvbl0sXG4gICAgICAgICAgICAgICAgc2hhcGU7XG4gICAgICAgICAgICBkZWxldGUgdGhpcy5zaGFwZXNbc2hhcGVpZF07XG4gICAgICAgICAgICBzd2l0Y2ggKGN1cnJlbnRSZWdpb24uc3Vic3RyKDAsIDEpKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAncic6XG4gICAgICAgICAgICAgICAgICAgIHNoYXBlID0gdGhpcy5yZW5kZXJSYW5nZShjdXJyZW50UmVnaW9uLnN1YnN0cigxKSwgaGlnaGxpZ2h0KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAncCc6XG4gICAgICAgICAgICAgICAgICAgIHNoYXBlID0gdGhpcy5yZW5kZXJQZXJmb3JtYW5jZShoaWdobGlnaHQpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICd0JzpcbiAgICAgICAgICAgICAgICAgICAgc2hhcGUgPSB0aGlzLnJlbmRlclRhcmdldChoaWdobGlnaHQpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMudmFsdWVTaGFwZXNbY3VycmVudFJlZ2lvbl0gPSBzaGFwZS5pZDtcbiAgICAgICAgICAgIHRoaXMuc2hhcGVzW3NoYXBlLmlkXSA9IGN1cnJlbnRSZWdpb247XG4gICAgICAgICAgICB0aGlzLnRhcmdldC5yZXBsYWNlV2l0aFNoYXBlKHNoYXBlaWQsIHNoYXBlKTtcbiAgICAgICAgfSxcblxuICAgICAgICByZW5kZXJSYW5nZTogZnVuY3Rpb24gKHJuLCBoaWdobGlnaHQpIHtcbiAgICAgICAgICAgIHZhciByYW5nZXZhbCA9IHRoaXMudmFsdWVzW3JuXSxcbiAgICAgICAgICAgICAgICByYW5nZXdpZHRoID0gTWF0aC5yb3VuZCh0aGlzLmNhbnZhc1dpZHRoICogKChyYW5nZXZhbCAtIHRoaXMubWluKSAvIHRoaXMucmFuZ2UpKSxcbiAgICAgICAgICAgICAgICBjb2xvciA9IHRoaXMub3B0aW9ucy5nZXQoJ3JhbmdlQ29sb3JzJylbcm4gLSAyXTtcbiAgICAgICAgICAgIGlmIChoaWdobGlnaHQpIHtcbiAgICAgICAgICAgICAgICBjb2xvciA9IHRoaXMuY2FsY0hpZ2hsaWdodENvbG9yKGNvbG9yLCB0aGlzLm9wdGlvbnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMudGFyZ2V0LmRyYXdSZWN0KDAsIDAsIHJhbmdld2lkdGggLSAxLCB0aGlzLmNhbnZhc0hlaWdodCAtIDEsIGNvbG9yLCBjb2xvcik7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVuZGVyUGVyZm9ybWFuY2U6IGZ1bmN0aW9uIChoaWdobGlnaHQpIHtcbiAgICAgICAgICAgIHZhciBwZXJmdmFsID0gdGhpcy52YWx1ZXNbMV0sXG4gICAgICAgICAgICAgICAgcGVyZndpZHRoID0gTWF0aC5yb3VuZCh0aGlzLmNhbnZhc1dpZHRoICogKChwZXJmdmFsIC0gdGhpcy5taW4pIC8gdGhpcy5yYW5nZSkpLFxuICAgICAgICAgICAgICAgIGNvbG9yID0gdGhpcy5vcHRpb25zLmdldCgncGVyZm9ybWFuY2VDb2xvcicpO1xuICAgICAgICAgICAgaWYgKGhpZ2hsaWdodCkge1xuICAgICAgICAgICAgICAgIGNvbG9yID0gdGhpcy5jYWxjSGlnaGxpZ2h0Q29sb3IoY29sb3IsIHRoaXMub3B0aW9ucyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy50YXJnZXQuZHJhd1JlY3QoMCwgTWF0aC5yb3VuZCh0aGlzLmNhbnZhc0hlaWdodCAqIDAuMyksIHBlcmZ3aWR0aCAtIDEsXG4gICAgICAgICAgICAgICAgTWF0aC5yb3VuZCh0aGlzLmNhbnZhc0hlaWdodCAqIDAuNCkgLSAxLCBjb2xvciwgY29sb3IpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlbmRlclRhcmdldDogZnVuY3Rpb24gKGhpZ2hsaWdodCkge1xuICAgICAgICAgICAgdmFyIHRhcmdldHZhbCA9IHRoaXMudmFsdWVzWzBdLFxuICAgICAgICAgICAgICAgIHggPSBNYXRoLnJvdW5kKHRoaXMuY2FudmFzV2lkdGggKiAoKHRhcmdldHZhbCAtIHRoaXMubWluKSAvIHRoaXMucmFuZ2UpIC0gKHRoaXMub3B0aW9ucy5nZXQoJ3RhcmdldFdpZHRoJykgLyAyKSksXG4gICAgICAgICAgICAgICAgdGFyZ2V0dG9wID0gTWF0aC5yb3VuZCh0aGlzLmNhbnZhc0hlaWdodCAqIDAuMTApLFxuICAgICAgICAgICAgICAgIHRhcmdldGhlaWdodCA9IHRoaXMuY2FudmFzSGVpZ2h0IC0gKHRhcmdldHRvcCAqIDIpLFxuICAgICAgICAgICAgICAgIGNvbG9yID0gdGhpcy5vcHRpb25zLmdldCgndGFyZ2V0Q29sb3InKTtcbiAgICAgICAgICAgIGlmIChoaWdobGlnaHQpIHtcbiAgICAgICAgICAgICAgICBjb2xvciA9IHRoaXMuY2FsY0hpZ2hsaWdodENvbG9yKGNvbG9yLCB0aGlzLm9wdGlvbnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMudGFyZ2V0LmRyYXdSZWN0KHgsIHRhcmdldHRvcCwgdGhpcy5vcHRpb25zLmdldCgndGFyZ2V0V2lkdGgnKSAtIDEsIHRhcmdldGhlaWdodCAtIDEsIGNvbG9yLCBjb2xvcik7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdmxlbiA9IHRoaXMudmFsdWVzLmxlbmd0aCxcbiAgICAgICAgICAgICAgICB0YXJnZXQgPSB0aGlzLnRhcmdldCxcbiAgICAgICAgICAgICAgICBpLCBzaGFwZTtcbiAgICAgICAgICAgIGlmICghYnVsbGV0Ll9zdXBlci5yZW5kZXIuY2FsbCh0aGlzKSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAoaSA9IDI7IGkgPCB2bGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgICBzaGFwZSA9IHRoaXMucmVuZGVyUmFuZ2UoaSkuYXBwZW5kKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zaGFwZXNbc2hhcGUuaWRdID0gJ3InICsgaTtcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlU2hhcGVzWydyJyArIGldID0gc2hhcGUuaWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy52YWx1ZXNbMV0gIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBzaGFwZSA9IHRoaXMucmVuZGVyUGVyZm9ybWFuY2UoKS5hcHBlbmQoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNoYXBlc1tzaGFwZS5pZF0gPSAncDEnO1xuICAgICAgICAgICAgICAgIHRoaXMudmFsdWVTaGFwZXMucDEgPSBzaGFwZS5pZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnZhbHVlc1swXSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHNoYXBlID0gdGhpcy5yZW5kZXJUYXJnZXQoKS5hcHBlbmQoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNoYXBlc1tzaGFwZS5pZF0gPSAndDAnO1xuICAgICAgICAgICAgICAgIHRoaXMudmFsdWVTaGFwZXMudDAgPSBzaGFwZS5pZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRhcmdldC5yZW5kZXIoKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUGllIGNoYXJ0c1xuICAgICAqL1xuICAgICQuZm4uc3BhcmtsaW5lLnBpZSA9IHBpZSA9IGNyZWF0ZUNsYXNzKCQuZm4uc3BhcmtsaW5lLl9iYXNlLCB7XG4gICAgICAgIHR5cGU6ICdwaWUnLFxuXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uIChlbCwgdmFsdWVzLCBvcHRpb25zLCB3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICAgICAgICB2YXIgdG90YWwgPSAwLCBpO1xuXG4gICAgICAgICAgICBwaWUuX3N1cGVyLmluaXQuY2FsbCh0aGlzLCBlbCwgdmFsdWVzLCBvcHRpb25zLCB3aWR0aCwgaGVpZ2h0KTtcblxuICAgICAgICAgICAgdGhpcy5zaGFwZXMgPSB7fTsgLy8gbWFwIHNoYXBlIGlkcyB0byB2YWx1ZSBvZmZzZXRzXG4gICAgICAgICAgICB0aGlzLnZhbHVlU2hhcGVzID0ge307IC8vIG1hcHMgdmFsdWUgb2Zmc2V0cyB0byBzaGFwZSBpZHNcbiAgICAgICAgICAgIHRoaXMudmFsdWVzID0gdmFsdWVzID0gJC5tYXAodmFsdWVzLCBOdW1iZXIpO1xuXG4gICAgICAgICAgICBpZiAob3B0aW9ucy5nZXQoJ3dpZHRoJykgPT09ICdhdXRvJykge1xuICAgICAgICAgICAgICAgIHRoaXMud2lkdGggPSB0aGlzLmhlaWdodDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHZhbHVlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgZm9yIChpID0gdmFsdWVzLmxlbmd0aDsgaS0tOykge1xuICAgICAgICAgICAgICAgICAgICB0b3RhbCArPSB2YWx1ZXNbaV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy50b3RhbCA9IHRvdGFsO1xuICAgICAgICAgICAgdGhpcy5pbml0VGFyZ2V0KCk7XG4gICAgICAgICAgICB0aGlzLnJhZGl1cyA9IE1hdGguZmxvb3IoTWF0aC5taW4odGhpcy5jYW52YXNXaWR0aCwgdGhpcy5jYW52YXNIZWlnaHQpIC8gMik7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2V0UmVnaW9uOiBmdW5jdGlvbiAoZWwsIHgsIHkpIHtcbiAgICAgICAgICAgIHZhciBzaGFwZWlkID0gdGhpcy50YXJnZXQuZ2V0U2hhcGVBdChlbCwgeCwgeSk7XG4gICAgICAgICAgICByZXR1cm4gKHNoYXBlaWQgIT09IHVuZGVmaW5lZCAmJiB0aGlzLnNoYXBlc1tzaGFwZWlkXSAhPT0gdW5kZWZpbmVkKSA/IHRoaXMuc2hhcGVzW3NoYXBlaWRdIDogdW5kZWZpbmVkO1xuICAgICAgICB9LFxuXG4gICAgICAgIGdldEN1cnJlbnRSZWdpb25GaWVsZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBjdXJyZW50UmVnaW9uID0gdGhpcy5jdXJyZW50UmVnaW9uO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBpc051bGw6IHRoaXMudmFsdWVzW2N1cnJlbnRSZWdpb25dID09PSB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMudmFsdWVzW2N1cnJlbnRSZWdpb25dLFxuICAgICAgICAgICAgICAgIHBlcmNlbnQ6IHRoaXMudmFsdWVzW2N1cnJlbnRSZWdpb25dIC8gdGhpcy50b3RhbCAqIDEwMCxcbiAgICAgICAgICAgICAgICBjb2xvcjogdGhpcy5vcHRpb25zLmdldCgnc2xpY2VDb2xvcnMnKVtjdXJyZW50UmVnaW9uICUgdGhpcy5vcHRpb25zLmdldCgnc2xpY2VDb2xvcnMnKS5sZW5ndGhdLFxuICAgICAgICAgICAgICAgIG9mZnNldDogY3VycmVudFJlZ2lvblxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSxcblxuICAgICAgICBjaGFuZ2VIaWdobGlnaHQ6IGZ1bmN0aW9uIChoaWdobGlnaHQpIHtcbiAgICAgICAgICAgIHZhciBjdXJyZW50UmVnaW9uID0gdGhpcy5jdXJyZW50UmVnaW9uLFxuICAgICAgICAgICAgICAgICBuZXdzbGljZSA9IHRoaXMucmVuZGVyU2xpY2UoY3VycmVudFJlZ2lvbiwgaGlnaGxpZ2h0KSxcbiAgICAgICAgICAgICAgICAgc2hhcGVpZCA9IHRoaXMudmFsdWVTaGFwZXNbY3VycmVudFJlZ2lvbl07XG4gICAgICAgICAgICBkZWxldGUgdGhpcy5zaGFwZXNbc2hhcGVpZF07XG4gICAgICAgICAgICB0aGlzLnRhcmdldC5yZXBsYWNlV2l0aFNoYXBlKHNoYXBlaWQsIG5ld3NsaWNlKTtcbiAgICAgICAgICAgIHRoaXMudmFsdWVTaGFwZXNbY3VycmVudFJlZ2lvbl0gPSBuZXdzbGljZS5pZDtcbiAgICAgICAgICAgIHRoaXMuc2hhcGVzW25ld3NsaWNlLmlkXSA9IGN1cnJlbnRSZWdpb247XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVuZGVyU2xpY2U6IGZ1bmN0aW9uICh2YWx1ZW51bSwgaGlnaGxpZ2h0KSB7XG4gICAgICAgICAgICB2YXIgdGFyZ2V0ID0gdGhpcy50YXJnZXQsXG4gICAgICAgICAgICAgICAgb3B0aW9ucyA9IHRoaXMub3B0aW9ucyxcbiAgICAgICAgICAgICAgICByYWRpdXMgPSB0aGlzLnJhZGl1cyxcbiAgICAgICAgICAgICAgICBib3JkZXJXaWR0aCA9IG9wdGlvbnMuZ2V0KCdib3JkZXJXaWR0aCcpLFxuICAgICAgICAgICAgICAgIG9mZnNldCA9IG9wdGlvbnMuZ2V0KCdvZmZzZXQnKSxcbiAgICAgICAgICAgICAgICBjaXJjbGUgPSAyICogTWF0aC5QSSxcbiAgICAgICAgICAgICAgICB2YWx1ZXMgPSB0aGlzLnZhbHVlcyxcbiAgICAgICAgICAgICAgICB0b3RhbCA9IHRoaXMudG90YWwsXG4gICAgICAgICAgICAgICAgbmV4dCA9IG9mZnNldCA/ICgyKk1hdGguUEkpKihvZmZzZXQvMzYwKSA6IDAsXG4gICAgICAgICAgICAgICAgc3RhcnQsIGVuZCwgaSwgdmxlbiwgY29sb3I7XG5cbiAgICAgICAgICAgIHZsZW4gPSB2YWx1ZXMubGVuZ3RoO1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHZsZW47IGkrKykge1xuICAgICAgICAgICAgICAgIHN0YXJ0ID0gbmV4dDtcbiAgICAgICAgICAgICAgICBlbmQgPSBuZXh0O1xuICAgICAgICAgICAgICAgIGlmICh0b3RhbCA+IDApIHsgIC8vIGF2b2lkIGRpdmlkZSBieSB6ZXJvXG4gICAgICAgICAgICAgICAgICAgIGVuZCA9IG5leHQgKyAoY2lyY2xlICogKHZhbHVlc1tpXSAvIHRvdGFsKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZW51bSA9PT0gaSkge1xuICAgICAgICAgICAgICAgICAgICBjb2xvciA9IG9wdGlvbnMuZ2V0KCdzbGljZUNvbG9ycycpW2kgJSBvcHRpb25zLmdldCgnc2xpY2VDb2xvcnMnKS5sZW5ndGhdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaGlnaGxpZ2h0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xvciA9IHRoaXMuY2FsY0hpZ2hsaWdodENvbG9yKGNvbG9yLCBvcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXQuZHJhd1BpZVNsaWNlKHJhZGl1cywgcmFkaXVzLCByYWRpdXMgLSBib3JkZXJXaWR0aCwgc3RhcnQsIGVuZCwgdW5kZWZpbmVkLCBjb2xvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG5leHQgPSBlbmQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdGFyZ2V0ID0gdGhpcy50YXJnZXQsXG4gICAgICAgICAgICAgICAgdmFsdWVzID0gdGhpcy52YWx1ZXMsXG4gICAgICAgICAgICAgICAgb3B0aW9ucyA9IHRoaXMub3B0aW9ucyxcbiAgICAgICAgICAgICAgICByYWRpdXMgPSB0aGlzLnJhZGl1cyxcbiAgICAgICAgICAgICAgICBib3JkZXJXaWR0aCA9IG9wdGlvbnMuZ2V0KCdib3JkZXJXaWR0aCcpLFxuICAgICAgICAgICAgICAgIHNoYXBlLCBpO1xuXG4gICAgICAgICAgICBpZiAoIXBpZS5fc3VwZXIucmVuZGVyLmNhbGwodGhpcykpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYm9yZGVyV2lkdGgpIHtcbiAgICAgICAgICAgICAgICB0YXJnZXQuZHJhd0NpcmNsZShyYWRpdXMsIHJhZGl1cywgTWF0aC5mbG9vcihyYWRpdXMgLSAoYm9yZGVyV2lkdGggLyAyKSksXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZ2V0KCdib3JkZXJDb2xvcicpLCB1bmRlZmluZWQsIGJvcmRlcldpZHRoKS5hcHBlbmQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAoaSA9IHZhbHVlcy5sZW5ndGg7IGktLTspIHtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWVzW2ldKSB7IC8vIGRvbid0IHJlbmRlciB6ZXJvIHZhbHVlc1xuICAgICAgICAgICAgICAgICAgICBzaGFwZSA9IHRoaXMucmVuZGVyU2xpY2UoaSkuYXBwZW5kKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmFsdWVTaGFwZXNbaV0gPSBzaGFwZS5pZDsgLy8gc3RvcmUganVzdCB0aGUgc2hhcGVpZFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNoYXBlc1tzaGFwZS5pZF0gPSBpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRhcmdldC5yZW5kZXIoKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQm94IHBsb3RzXG4gICAgICovXG4gICAgJC5mbi5zcGFya2xpbmUuYm94ID0gYm94ID0gY3JlYXRlQ2xhc3MoJC5mbi5zcGFya2xpbmUuX2Jhc2UsIHtcbiAgICAgICAgdHlwZTogJ2JveCcsXG5cbiAgICAgICAgaW5pdDogZnVuY3Rpb24gKGVsLCB2YWx1ZXMsIG9wdGlvbnMsIHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgICAgIGJveC5fc3VwZXIuaW5pdC5jYWxsKHRoaXMsIGVsLCB2YWx1ZXMsIG9wdGlvbnMsIHdpZHRoLCBoZWlnaHQpO1xuICAgICAgICAgICAgdGhpcy52YWx1ZXMgPSAkLm1hcCh2YWx1ZXMsIE51bWJlcik7XG4gICAgICAgICAgICB0aGlzLndpZHRoID0gb3B0aW9ucy5nZXQoJ3dpZHRoJykgPT09ICdhdXRvJyA/ICc0LjBlbScgOiB3aWR0aDtcbiAgICAgICAgICAgIHRoaXMuaW5pdFRhcmdldCgpO1xuICAgICAgICAgICAgaWYgKCF0aGlzLnZhbHVlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRpc2FibGVkID0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogU2ltdWxhdGUgYSBzaW5nbGUgcmVnaW9uXG4gICAgICAgICAqL1xuICAgICAgICBnZXRSZWdpb246IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICB9LFxuXG4gICAgICAgIGdldEN1cnJlbnRSZWdpb25GaWVsZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBbXG4gICAgICAgICAgICAgICAgeyBmaWVsZDogJ2xxJywgdmFsdWU6IHRoaXMucXVhcnRpbGVzWzBdIH0sXG4gICAgICAgICAgICAgICAgeyBmaWVsZDogJ21lZCcsIHZhbHVlOiB0aGlzLnF1YXJ0aWxlc1sxXSB9LFxuICAgICAgICAgICAgICAgIHsgZmllbGQ6ICd1cScsIHZhbHVlOiB0aGlzLnF1YXJ0aWxlc1syXSB9XG4gICAgICAgICAgICBdO1xuICAgICAgICAgICAgaWYgKHRoaXMubG91dGxpZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHsgZmllbGQ6ICdsbycsIHZhbHVlOiB0aGlzLmxvdXRsaWVyfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5yb3V0bGllciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goeyBmaWVsZDogJ3JvJywgdmFsdWU6IHRoaXMucm91dGxpZXJ9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmx3aGlza2VyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaCh7IGZpZWxkOiAnbHcnLCB2YWx1ZTogdGhpcy5sd2hpc2tlcn0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMucndoaXNrZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHsgZmllbGQ6ICdydycsIHZhbHVlOiB0aGlzLnJ3aGlza2VyfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlbmRlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHRhcmdldCA9IHRoaXMudGFyZ2V0LFxuICAgICAgICAgICAgICAgIHZhbHVlcyA9IHRoaXMudmFsdWVzLFxuICAgICAgICAgICAgICAgIHZsZW4gPSB2YWx1ZXMubGVuZ3RoLFxuICAgICAgICAgICAgICAgIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnMsXG4gICAgICAgICAgICAgICAgY2FudmFzV2lkdGggPSB0aGlzLmNhbnZhc1dpZHRoLFxuICAgICAgICAgICAgICAgIGNhbnZhc0hlaWdodCA9IHRoaXMuY2FudmFzSGVpZ2h0LFxuICAgICAgICAgICAgICAgIG1pblZhbHVlID0gb3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNaW4nKSA9PT0gdW5kZWZpbmVkID8gTWF0aC5taW4uYXBwbHkoTWF0aCwgdmFsdWVzKSA6IG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlTWluJyksXG4gICAgICAgICAgICAgICAgbWF4VmFsdWUgPSBvcHRpb25zLmdldCgnY2hhcnRSYW5nZU1heCcpID09PSB1bmRlZmluZWQgPyBNYXRoLm1heC5hcHBseShNYXRoLCB2YWx1ZXMpIDogb3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNYXgnKSxcbiAgICAgICAgICAgICAgICBjYW52YXNMZWZ0ID0gMCxcbiAgICAgICAgICAgICAgICBsd2hpc2tlciwgbG91dGxpZXIsIGlxciwgcTEsIHEyLCBxMywgcndoaXNrZXIsIHJvdXRsaWVyLCBpLFxuICAgICAgICAgICAgICAgIHNpemUsIHVuaXRTaXplO1xuXG4gICAgICAgICAgICBpZiAoIWJveC5fc3VwZXIucmVuZGVyLmNhbGwodGhpcykpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChvcHRpb25zLmdldCgncmF3JykpIHtcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5nZXQoJ3Nob3dPdXRsaWVycycpICYmIHZhbHVlcy5sZW5ndGggPiA1KSB7XG4gICAgICAgICAgICAgICAgICAgIGxvdXRsaWVyID0gdmFsdWVzWzBdO1xuICAgICAgICAgICAgICAgICAgICBsd2hpc2tlciA9IHZhbHVlc1sxXTtcbiAgICAgICAgICAgICAgICAgICAgcTEgPSB2YWx1ZXNbMl07XG4gICAgICAgICAgICAgICAgICAgIHEyID0gdmFsdWVzWzNdO1xuICAgICAgICAgICAgICAgICAgICBxMyA9IHZhbHVlc1s0XTtcbiAgICAgICAgICAgICAgICAgICAgcndoaXNrZXIgPSB2YWx1ZXNbNV07XG4gICAgICAgICAgICAgICAgICAgIHJvdXRsaWVyID0gdmFsdWVzWzZdO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGx3aGlza2VyID0gdmFsdWVzWzBdO1xuICAgICAgICAgICAgICAgICAgICBxMSA9IHZhbHVlc1sxXTtcbiAgICAgICAgICAgICAgICAgICAgcTIgPSB2YWx1ZXNbMl07XG4gICAgICAgICAgICAgICAgICAgIHEzID0gdmFsdWVzWzNdO1xuICAgICAgICAgICAgICAgICAgICByd2hpc2tlciA9IHZhbHVlc1s0XTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhbHVlcy5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBhIC0gYjsgfSk7XG4gICAgICAgICAgICAgICAgcTEgPSBxdWFydGlsZSh2YWx1ZXMsIDEpO1xuICAgICAgICAgICAgICAgIHEyID0gcXVhcnRpbGUodmFsdWVzLCAyKTtcbiAgICAgICAgICAgICAgICBxMyA9IHF1YXJ0aWxlKHZhbHVlcywgMyk7XG4gICAgICAgICAgICAgICAgaXFyID0gcTMgLSBxMTtcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5nZXQoJ3Nob3dPdXRsaWVycycpKSB7XG4gICAgICAgICAgICAgICAgICAgIGx3aGlza2VyID0gcndoaXNrZXIgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCB2bGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsd2hpc2tlciA9PT0gdW5kZWZpbmVkICYmIHZhbHVlc1tpXSA+IHExIC0gKGlxciAqIG9wdGlvbnMuZ2V0KCdvdXRsaWVySVFSJykpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbHdoaXNrZXIgPSB2YWx1ZXNbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWVzW2ldIDwgcTMgKyAoaXFyICogb3B0aW9ucy5nZXQoJ291dGxpZXJJUVInKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByd2hpc2tlciA9IHZhbHVlc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBsb3V0bGllciA9IHZhbHVlc1swXTtcbiAgICAgICAgICAgICAgICAgICAgcm91dGxpZXIgPSB2YWx1ZXNbdmxlbiAtIDFdO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGx3aGlza2VyID0gdmFsdWVzWzBdO1xuICAgICAgICAgICAgICAgICAgICByd2hpc2tlciA9IHZhbHVlc1t2bGVuIC0gMV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5xdWFydGlsZXMgPSBbcTEsIHEyLCBxM107XG4gICAgICAgICAgICB0aGlzLmx3aGlza2VyID0gbHdoaXNrZXI7XG4gICAgICAgICAgICB0aGlzLnJ3aGlza2VyID0gcndoaXNrZXI7XG4gICAgICAgICAgICB0aGlzLmxvdXRsaWVyID0gbG91dGxpZXI7XG4gICAgICAgICAgICB0aGlzLnJvdXRsaWVyID0gcm91dGxpZXI7XG5cbiAgICAgICAgICAgIHVuaXRTaXplID0gY2FudmFzV2lkdGggLyAobWF4VmFsdWUgLSBtaW5WYWx1ZSArIDEpO1xuICAgICAgICAgICAgaWYgKG9wdGlvbnMuZ2V0KCdzaG93T3V0bGllcnMnKSkge1xuICAgICAgICAgICAgICAgIGNhbnZhc0xlZnQgPSBNYXRoLmNlaWwob3B0aW9ucy5nZXQoJ3Nwb3RSYWRpdXMnKSk7XG4gICAgICAgICAgICAgICAgY2FudmFzV2lkdGggLT0gMiAqIE1hdGguY2VpbChvcHRpb25zLmdldCgnc3BvdFJhZGl1cycpKTtcbiAgICAgICAgICAgICAgICB1bml0U2l6ZSA9IGNhbnZhc1dpZHRoIC8gKG1heFZhbHVlIC0gbWluVmFsdWUgKyAxKTtcbiAgICAgICAgICAgICAgICBpZiAobG91dGxpZXIgPCBsd2hpc2tlcikge1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXQuZHJhd0NpcmNsZSgobG91dGxpZXIgLSBtaW5WYWx1ZSkgKiB1bml0U2l6ZSArIGNhbnZhc0xlZnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBjYW52YXNIZWlnaHQgLyAyLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5nZXQoJ3Nwb3RSYWRpdXMnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZ2V0KCdvdXRsaWVyTGluZUNvbG9yJyksXG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmdldCgnb3V0bGllckZpbGxDb2xvcicpKS5hcHBlbmQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHJvdXRsaWVyID4gcndoaXNrZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LmRyYXdDaXJjbGUoKHJvdXRsaWVyIC0gbWluVmFsdWUpICogdW5pdFNpemUgKyBjYW52YXNMZWZ0LFxuICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzSGVpZ2h0IC8gMixcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZ2V0KCdzcG90UmFkaXVzJyksXG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmdldCgnb3V0bGllckxpbmVDb2xvcicpLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5nZXQoJ291dGxpZXJGaWxsQ29sb3InKSkuYXBwZW5kKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBib3hcbiAgICAgICAgICAgIHRhcmdldC5kcmF3UmVjdChcbiAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKChxMSAtIG1pblZhbHVlKSAqIHVuaXRTaXplICsgY2FudmFzTGVmdCksXG4gICAgICAgICAgICAgICAgTWF0aC5yb3VuZChjYW52YXNIZWlnaHQgKiAwLjEpLFxuICAgICAgICAgICAgICAgIE1hdGgucm91bmQoKHEzIC0gcTEpICogdW5pdFNpemUpLFxuICAgICAgICAgICAgICAgIE1hdGgucm91bmQoY2FudmFzSGVpZ2h0ICogMC44KSxcbiAgICAgICAgICAgICAgICBvcHRpb25zLmdldCgnYm94TGluZUNvbG9yJyksXG4gICAgICAgICAgICAgICAgb3B0aW9ucy5nZXQoJ2JveEZpbGxDb2xvcicpKS5hcHBlbmQoKTtcbiAgICAgICAgICAgIC8vIGxlZnQgd2hpc2tlclxuICAgICAgICAgICAgdGFyZ2V0LmRyYXdMaW5lKFxuICAgICAgICAgICAgICAgIE1hdGgucm91bmQoKGx3aGlza2VyIC0gbWluVmFsdWUpICogdW5pdFNpemUgKyBjYW52YXNMZWZ0KSxcbiAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKGNhbnZhc0hlaWdodCAvIDIpLFxuICAgICAgICAgICAgICAgIE1hdGgucm91bmQoKHExIC0gbWluVmFsdWUpICogdW5pdFNpemUgKyBjYW52YXNMZWZ0KSxcbiAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKGNhbnZhc0hlaWdodCAvIDIpLFxuICAgICAgICAgICAgICAgIG9wdGlvbnMuZ2V0KCdsaW5lQ29sb3InKSkuYXBwZW5kKCk7XG4gICAgICAgICAgICB0YXJnZXQuZHJhd0xpbmUoXG4gICAgICAgICAgICAgICAgTWF0aC5yb3VuZCgobHdoaXNrZXIgLSBtaW5WYWx1ZSkgKiB1bml0U2l6ZSArIGNhbnZhc0xlZnQpLFxuICAgICAgICAgICAgICAgIE1hdGgucm91bmQoY2FudmFzSGVpZ2h0IC8gNCksXG4gICAgICAgICAgICAgICAgTWF0aC5yb3VuZCgobHdoaXNrZXIgLSBtaW5WYWx1ZSkgKiB1bml0U2l6ZSArIGNhbnZhc0xlZnQpLFxuICAgICAgICAgICAgICAgIE1hdGgucm91bmQoY2FudmFzSGVpZ2h0IC0gY2FudmFzSGVpZ2h0IC8gNCksXG4gICAgICAgICAgICAgICAgb3B0aW9ucy5nZXQoJ3doaXNrZXJDb2xvcicpKS5hcHBlbmQoKTtcbiAgICAgICAgICAgIC8vIHJpZ2h0IHdoaXNrZXJcbiAgICAgICAgICAgIHRhcmdldC5kcmF3TGluZShNYXRoLnJvdW5kKChyd2hpc2tlciAtIG1pblZhbHVlKSAqIHVuaXRTaXplICsgY2FudmFzTGVmdCksXG4gICAgICAgICAgICAgICAgTWF0aC5yb3VuZChjYW52YXNIZWlnaHQgLyAyKSxcbiAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKChxMyAtIG1pblZhbHVlKSAqIHVuaXRTaXplICsgY2FudmFzTGVmdCksXG4gICAgICAgICAgICAgICAgTWF0aC5yb3VuZChjYW52YXNIZWlnaHQgLyAyKSxcbiAgICAgICAgICAgICAgICBvcHRpb25zLmdldCgnbGluZUNvbG9yJykpLmFwcGVuZCgpO1xuICAgICAgICAgICAgdGFyZ2V0LmRyYXdMaW5lKFxuICAgICAgICAgICAgICAgIE1hdGgucm91bmQoKHJ3aGlza2VyIC0gbWluVmFsdWUpICogdW5pdFNpemUgKyBjYW52YXNMZWZ0KSxcbiAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKGNhbnZhc0hlaWdodCAvIDQpLFxuICAgICAgICAgICAgICAgIE1hdGgucm91bmQoKHJ3aGlza2VyIC0gbWluVmFsdWUpICogdW5pdFNpemUgKyBjYW52YXNMZWZ0KSxcbiAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKGNhbnZhc0hlaWdodCAtIGNhbnZhc0hlaWdodCAvIDQpLFxuICAgICAgICAgICAgICAgIG9wdGlvbnMuZ2V0KCd3aGlza2VyQ29sb3InKSkuYXBwZW5kKCk7XG4gICAgICAgICAgICAvLyBtZWRpYW4gbGluZVxuICAgICAgICAgICAgdGFyZ2V0LmRyYXdMaW5lKFxuICAgICAgICAgICAgICAgIE1hdGgucm91bmQoKHEyIC0gbWluVmFsdWUpICogdW5pdFNpemUgKyBjYW52YXNMZWZ0KSxcbiAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKGNhbnZhc0hlaWdodCAqIDAuMSksXG4gICAgICAgICAgICAgICAgTWF0aC5yb3VuZCgocTIgLSBtaW5WYWx1ZSkgKiB1bml0U2l6ZSArIGNhbnZhc0xlZnQpLFxuICAgICAgICAgICAgICAgIE1hdGgucm91bmQoY2FudmFzSGVpZ2h0ICogMC45KSxcbiAgICAgICAgICAgICAgICBvcHRpb25zLmdldCgnbWVkaWFuQ29sb3InKSkuYXBwZW5kKCk7XG4gICAgICAgICAgICBpZiAob3B0aW9ucy5nZXQoJ3RhcmdldCcpKSB7XG4gICAgICAgICAgICAgICAgc2l6ZSA9IE1hdGguY2VpbChvcHRpb25zLmdldCgnc3BvdFJhZGl1cycpKTtcbiAgICAgICAgICAgICAgICB0YXJnZXQuZHJhd0xpbmUoXG4gICAgICAgICAgICAgICAgICAgIE1hdGgucm91bmQoKG9wdGlvbnMuZ2V0KCd0YXJnZXQnKSAtIG1pblZhbHVlKSAqIHVuaXRTaXplICsgY2FudmFzTGVmdCksXG4gICAgICAgICAgICAgICAgICAgIE1hdGgucm91bmQoKGNhbnZhc0hlaWdodCAvIDIpIC0gc2l6ZSksXG4gICAgICAgICAgICAgICAgICAgIE1hdGgucm91bmQoKG9wdGlvbnMuZ2V0KCd0YXJnZXQnKSAtIG1pblZhbHVlKSAqIHVuaXRTaXplICsgY2FudmFzTGVmdCksXG4gICAgICAgICAgICAgICAgICAgIE1hdGgucm91bmQoKGNhbnZhc0hlaWdodCAvIDIpICsgc2l6ZSksXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZ2V0KCd0YXJnZXRDb2xvcicpKS5hcHBlbmQoKTtcbiAgICAgICAgICAgICAgICB0YXJnZXQuZHJhd0xpbmUoXG4gICAgICAgICAgICAgICAgICAgIE1hdGgucm91bmQoKG9wdGlvbnMuZ2V0KCd0YXJnZXQnKSAtIG1pblZhbHVlKSAqIHVuaXRTaXplICsgY2FudmFzTGVmdCAtIHNpemUpLFxuICAgICAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKGNhbnZhc0hlaWdodCAvIDIpLFxuICAgICAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKChvcHRpb25zLmdldCgndGFyZ2V0JykgLSBtaW5WYWx1ZSkgKiB1bml0U2l6ZSArIGNhbnZhc0xlZnQgKyBzaXplKSxcbiAgICAgICAgICAgICAgICAgICAgTWF0aC5yb3VuZChjYW52YXNIZWlnaHQgLyAyKSxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5nZXQoJ3RhcmdldENvbG9yJykpLmFwcGVuZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGFyZ2V0LnJlbmRlcigpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBTZXR1cCBhIHZlcnkgc2ltcGxlIFwidmlydHVhbCBjYW52YXNcIiB0byBtYWtlIGRyYXdpbmcgdGhlIGZldyBzaGFwZXMgd2UgbmVlZCBlYXNpZXJcbiAgICAvLyBUaGlzIGlzIGFjY2Vzc2libGUgYXMgJChmb28pLnNpbXBsZWRyYXcoKVxuXG4gICAgVlNoYXBlID0gY3JlYXRlQ2xhc3Moe1xuICAgICAgICBpbml0OiBmdW5jdGlvbiAodGFyZ2V0LCBpZCwgdHlwZSwgYXJncykge1xuICAgICAgICAgICAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7XG4gICAgICAgICAgICB0aGlzLmlkID0gaWQ7XG4gICAgICAgICAgICB0aGlzLnR5cGUgPSB0eXBlO1xuICAgICAgICAgICAgdGhpcy5hcmdzID0gYXJncztcbiAgICAgICAgfSxcbiAgICAgICAgYXBwZW5kOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLnRhcmdldC5hcHBlbmRTaGFwZSh0aGlzKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICBWQ2FudmFzX2Jhc2UgPSBjcmVhdGVDbGFzcyh7XG4gICAgICAgIF9weHJlZ2V4OiAvKFxcZCspKHB4KT9cXHMqJC9pLFxuXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uICh3aWR0aCwgaGVpZ2h0LCB0YXJnZXQpIHtcbiAgICAgICAgICAgIGlmICghd2lkdGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLndpZHRoID0gd2lkdGg7XG4gICAgICAgICAgICB0aGlzLmhlaWdodCA9IGhlaWdodDtcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0ID0gdGFyZ2V0O1xuICAgICAgICAgICAgdGhpcy5sYXN0U2hhcGVJZCA9IG51bGw7XG4gICAgICAgICAgICBpZiAodGFyZ2V0WzBdKSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0gdGFyZ2V0WzBdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJC5kYXRhKHRhcmdldCwgJ19qcXNfdmNhbnZhcycsIHRoaXMpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGRyYXdMaW5lOiBmdW5jdGlvbiAoeDEsIHkxLCB4MiwgeTIsIGxpbmVDb2xvciwgbGluZVdpZHRoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5kcmF3U2hhcGUoW1t4MSwgeTFdLCBbeDIsIHkyXV0sIGxpbmVDb2xvciwgbGluZVdpZHRoKTtcbiAgICAgICAgfSxcblxuICAgICAgICBkcmF3U2hhcGU6IGZ1bmN0aW9uIChwYXRoLCBsaW5lQ29sb3IsIGZpbGxDb2xvciwgbGluZVdpZHRoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZ2VuU2hhcGUoJ1NoYXBlJywgW3BhdGgsIGxpbmVDb2xvciwgZmlsbENvbG9yLCBsaW5lV2lkdGhdKTtcbiAgICAgICAgfSxcblxuICAgICAgICBkcmF3Q2lyY2xlOiBmdW5jdGlvbiAoeCwgeSwgcmFkaXVzLCBsaW5lQ29sb3IsIGZpbGxDb2xvciwgbGluZVdpZHRoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZ2VuU2hhcGUoJ0NpcmNsZScsIFt4LCB5LCByYWRpdXMsIGxpbmVDb2xvciwgZmlsbENvbG9yLCBsaW5lV2lkdGhdKTtcbiAgICAgICAgfSxcblxuICAgICAgICBkcmF3UGllU2xpY2U6IGZ1bmN0aW9uICh4LCB5LCByYWRpdXMsIHN0YXJ0QW5nbGUsIGVuZEFuZ2xlLCBsaW5lQ29sb3IsIGZpbGxDb2xvcikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dlblNoYXBlKCdQaWVTbGljZScsIFt4LCB5LCByYWRpdXMsIHN0YXJ0QW5nbGUsIGVuZEFuZ2xlLCBsaW5lQ29sb3IsIGZpbGxDb2xvcl0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIGRyYXdSZWN0OiBmdW5jdGlvbiAoeCwgeSwgd2lkdGgsIGhlaWdodCwgbGluZUNvbG9yLCBmaWxsQ29sb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9nZW5TaGFwZSgnUmVjdCcsIFt4LCB5LCB3aWR0aCwgaGVpZ2h0LCBsaW5lQ29sb3IsIGZpbGxDb2xvcl0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIGdldEVsZW1lbnQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNhbnZhcztcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogUmV0dXJuIHRoZSBtb3N0IHJlY2VudGx5IGluc2VydGVkIHNoYXBlIGlkXG4gICAgICAgICAqL1xuICAgICAgICBnZXRMYXN0U2hhcGVJZDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubGFzdFNoYXBlSWQ7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENsZWFyIGFuZCByZXNldCB0aGUgY2FudmFzXG4gICAgICAgICAqL1xuICAgICAgICByZXNldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgYWxlcnQoJ3Jlc2V0IG5vdCBpbXBsZW1lbnRlZCcpO1xuICAgICAgICB9LFxuXG4gICAgICAgIF9pbnNlcnQ6IGZ1bmN0aW9uIChlbCwgdGFyZ2V0KSB7XG4gICAgICAgICAgICAkKHRhcmdldCkuaHRtbChlbCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENhbGN1bGF0ZSB0aGUgcGl4ZWwgZGltZW5zaW9ucyBvZiB0aGUgY2FudmFzXG4gICAgICAgICAqL1xuICAgICAgICBfY2FsY3VsYXRlUGl4ZWxEaW1zOiBmdW5jdGlvbiAod2lkdGgsIGhlaWdodCwgY2FudmFzKSB7XG4gICAgICAgICAgICAvLyBYWFggVGhpcyBzaG91bGQgcHJvYmFibHkgYmUgYSBjb25maWd1cmFibGUgb3B0aW9uXG4gICAgICAgICAgICB2YXIgbWF0Y2g7XG4gICAgICAgICAgICBtYXRjaCA9IHRoaXMuX3B4cmVnZXguZXhlYyhoZWlnaHQpO1xuICAgICAgICAgICAgaWYgKG1hdGNoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5waXhlbEhlaWdodCA9IG1hdGNoWzFdO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBpeGVsSGVpZ2h0ID0gJChjYW52YXMpLmhlaWdodCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbWF0Y2ggPSB0aGlzLl9weHJlZ2V4LmV4ZWMod2lkdGgpO1xuICAgICAgICAgICAgaWYgKG1hdGNoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5waXhlbFdpZHRoID0gbWF0Y2hbMV07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMucGl4ZWxXaWR0aCA9ICQoY2FudmFzKS53aWR0aCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBHZW5lcmF0ZSBhIHNoYXBlIG9iamVjdCBhbmQgaWQgZm9yIGxhdGVyIHJlbmRlcmluZ1xuICAgICAgICAgKi9cbiAgICAgICAgX2dlblNoYXBlOiBmdW5jdGlvbiAoc2hhcGV0eXBlLCBzaGFwZWFyZ3MpIHtcbiAgICAgICAgICAgIHZhciBpZCA9IHNoYXBlQ291bnQrKztcbiAgICAgICAgICAgIHNoYXBlYXJncy51bnNoaWZ0KGlkKTtcbiAgICAgICAgICAgIHJldHVybiBuZXcgVlNoYXBlKHRoaXMsIGlkLCBzaGFwZXR5cGUsIHNoYXBlYXJncyk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEFkZCBhIHNoYXBlIHRvIHRoZSBlbmQgb2YgdGhlIHJlbmRlciBxdWV1ZVxuICAgICAgICAgKi9cbiAgICAgICAgYXBwZW5kU2hhcGU6IGZ1bmN0aW9uIChzaGFwZSkge1xuICAgICAgICAgICAgYWxlcnQoJ2FwcGVuZFNoYXBlIG5vdCBpbXBsZW1lbnRlZCcpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSZXBsYWNlIG9uZSBzaGFwZSB3aXRoIGFub3RoZXJcbiAgICAgICAgICovXG4gICAgICAgIHJlcGxhY2VXaXRoU2hhcGU6IGZ1bmN0aW9uIChzaGFwZWlkLCBzaGFwZSkge1xuICAgICAgICAgICAgYWxlcnQoJ3JlcGxhY2VXaXRoU2hhcGUgbm90IGltcGxlbWVudGVkJyk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEluc2VydCBvbmUgc2hhcGUgYWZ0ZXIgYW5vdGhlciBpbiB0aGUgcmVuZGVyIHF1ZXVlXG4gICAgICAgICAqL1xuICAgICAgICBpbnNlcnRBZnRlclNoYXBlOiBmdW5jdGlvbiAoc2hhcGVpZCwgc2hhcGUpIHtcbiAgICAgICAgICAgIGFsZXJ0KCdpbnNlcnRBZnRlclNoYXBlIG5vdCBpbXBsZW1lbnRlZCcpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSZW1vdmUgYSBzaGFwZSBmcm9tIHRoZSBxdWV1ZVxuICAgICAgICAgKi9cbiAgICAgICAgcmVtb3ZlU2hhcGVJZDogZnVuY3Rpb24gKHNoYXBlaWQpIHtcbiAgICAgICAgICAgIGFsZXJ0KCdyZW1vdmVTaGFwZUlkIG5vdCBpbXBsZW1lbnRlZCcpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaW5kIGEgc2hhcGUgYXQgdGhlIHNwZWNpZmllZCB4L3kgY28tb3JkaW5hdGVzXG4gICAgICAgICAqL1xuICAgICAgICBnZXRTaGFwZUF0OiBmdW5jdGlvbiAoZWwsIHgsIHkpIHtcbiAgICAgICAgICAgIGFsZXJ0KCdnZXRTaGFwZUF0IG5vdCBpbXBsZW1lbnRlZCcpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSZW5kZXIgYWxsIHF1ZXVlZCBzaGFwZXMgb250byB0aGUgY2FudmFzXG4gICAgICAgICAqL1xuICAgICAgICByZW5kZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGFsZXJ0KCdyZW5kZXIgbm90IGltcGxlbWVudGVkJyk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIFZDYW52YXNfY2FudmFzID0gY3JlYXRlQ2xhc3MoVkNhbnZhc19iYXNlLCB7XG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uICh3aWR0aCwgaGVpZ2h0LCB0YXJnZXQsIGludGVyYWN0KSB7XG4gICAgICAgICAgICBWQ2FudmFzX2NhbnZhcy5fc3VwZXIuaW5pdC5jYWxsKHRoaXMsIHdpZHRoLCBoZWlnaHQsIHRhcmdldCk7XG4gICAgICAgICAgICB0aGlzLmNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuICAgICAgICAgICAgaWYgKHRhcmdldFswXSkge1xuICAgICAgICAgICAgICAgIHRhcmdldCA9IHRhcmdldFswXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICQuZGF0YSh0YXJnZXQsICdfanFzX3ZjYW52YXMnLCB0aGlzKTtcbiAgICAgICAgICAgICQodGhpcy5jYW52YXMpLmNzcyh7IGRpc3BsYXk6ICdpbmxpbmUtYmxvY2snLCB3aWR0aDogd2lkdGgsIGhlaWdodDogaGVpZ2h0LCB2ZXJ0aWNhbEFsaWduOiAndG9wJyB9KTtcbiAgICAgICAgICAgIHRoaXMuX2luc2VydCh0aGlzLmNhbnZhcywgdGFyZ2V0KTtcbiAgICAgICAgICAgIHRoaXMuX2NhbGN1bGF0ZVBpeGVsRGltcyh3aWR0aCwgaGVpZ2h0LCB0aGlzLmNhbnZhcyk7XG4gICAgICAgICAgICB0aGlzLmNhbnZhcy53aWR0aCA9IHRoaXMucGl4ZWxXaWR0aDtcbiAgICAgICAgICAgIHRoaXMuY2FudmFzLmhlaWdodCA9IHRoaXMucGl4ZWxIZWlnaHQ7XG4gICAgICAgICAgICB0aGlzLmludGVyYWN0ID0gaW50ZXJhY3Q7XG4gICAgICAgICAgICB0aGlzLnNoYXBlcyA9IHt9O1xuICAgICAgICAgICAgdGhpcy5zaGFwZXNlcSA9IFtdO1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50VGFyZ2V0U2hhcGVJZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICQodGhpcy5jYW52YXMpLmNzcyh7d2lkdGg6IHRoaXMucGl4ZWxXaWR0aCwgaGVpZ2h0OiB0aGlzLnBpeGVsSGVpZ2h0fSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgX2dldENvbnRleHQ6IGZ1bmN0aW9uIChsaW5lQ29sb3IsIGZpbGxDb2xvciwgbGluZVdpZHRoKSB7XG4gICAgICAgICAgICB2YXIgY29udGV4dCA9IHRoaXMuY2FudmFzLmdldENvbnRleHQoJzJkJyk7XG4gICAgICAgICAgICBpZiAobGluZUNvbG9yICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0LnN0cm9rZVN0eWxlID0gbGluZUNvbG9yO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29udGV4dC5saW5lV2lkdGggPSBsaW5lV2lkdGggPT09IHVuZGVmaW5lZCA/IDEgOiBsaW5lV2lkdGg7XG4gICAgICAgICAgICBpZiAoZmlsbENvbG9yICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0LmZpbGxTdHlsZSA9IGZpbGxDb2xvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjb250ZXh0O1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlc2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgY29udGV4dCA9IHRoaXMuX2dldENvbnRleHQoKTtcbiAgICAgICAgICAgIGNvbnRleHQuY2xlYXJSZWN0KDAsIDAsIHRoaXMucGl4ZWxXaWR0aCwgdGhpcy5waXhlbEhlaWdodCk7XG4gICAgICAgICAgICB0aGlzLnNoYXBlcyA9IHt9O1xuICAgICAgICAgICAgdGhpcy5zaGFwZXNlcSA9IFtdO1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50VGFyZ2V0U2hhcGVJZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgfSxcblxuICAgICAgICBfZHJhd1NoYXBlOiBmdW5jdGlvbiAoc2hhcGVpZCwgcGF0aCwgbGluZUNvbG9yLCBmaWxsQ29sb3IsIGxpbmVXaWR0aCkge1xuICAgICAgICAgICAgdmFyIGNvbnRleHQgPSB0aGlzLl9nZXRDb250ZXh0KGxpbmVDb2xvciwgZmlsbENvbG9yLCBsaW5lV2lkdGgpLFxuICAgICAgICAgICAgICAgIGksIHBsZW47XG4gICAgICAgICAgICBjb250ZXh0LmJlZ2luUGF0aCgpO1xuICAgICAgICAgICAgY29udGV4dC5tb3ZlVG8ocGF0aFswXVswXSArIDAuNSwgcGF0aFswXVsxXSArIDAuNSk7XG4gICAgICAgICAgICBmb3IgKGkgPSAxLCBwbGVuID0gcGF0aC5sZW5ndGg7IGkgPCBwbGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0LmxpbmVUbyhwYXRoW2ldWzBdICsgMC41LCBwYXRoW2ldWzFdICsgMC41KTsgLy8gdGhlIDAuNSBvZmZzZXQgZ2l2ZXMgdXMgY3Jpc3AgcGl4ZWwtd2lkdGggbGluZXNcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChsaW5lQ29sb3IgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGNvbnRleHQuc3Ryb2tlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZmlsbENvbG9yICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0LmZpbGwoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnRhcmdldFggIT09IHVuZGVmaW5lZCAmJiB0aGlzLnRhcmdldFkgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgIGNvbnRleHQuaXNQb2ludEluUGF0aCh0aGlzLnRhcmdldFgsIHRoaXMudGFyZ2V0WSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRUYXJnZXRTaGFwZUlkID0gc2hhcGVpZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBfZHJhd0NpcmNsZTogZnVuY3Rpb24gKHNoYXBlaWQsIHgsIHksIHJhZGl1cywgbGluZUNvbG9yLCBmaWxsQ29sb3IsIGxpbmVXaWR0aCkge1xuICAgICAgICAgICAgdmFyIGNvbnRleHQgPSB0aGlzLl9nZXRDb250ZXh0KGxpbmVDb2xvciwgZmlsbENvbG9yLCBsaW5lV2lkdGgpO1xuICAgICAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKTtcbiAgICAgICAgICAgIGNvbnRleHQuYXJjKHgsIHksIHJhZGl1cywgMCwgMiAqIE1hdGguUEksIGZhbHNlKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnRhcmdldFggIT09IHVuZGVmaW5lZCAmJiB0aGlzLnRhcmdldFkgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgIGNvbnRleHQuaXNQb2ludEluUGF0aCh0aGlzLnRhcmdldFgsIHRoaXMudGFyZ2V0WSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRUYXJnZXRTaGFwZUlkID0gc2hhcGVpZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChsaW5lQ29sb3IgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGNvbnRleHQuc3Ryb2tlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZmlsbENvbG9yICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0LmZpbGwoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBfZHJhd1BpZVNsaWNlOiBmdW5jdGlvbiAoc2hhcGVpZCwgeCwgeSwgcmFkaXVzLCBzdGFydEFuZ2xlLCBlbmRBbmdsZSwgbGluZUNvbG9yLCBmaWxsQ29sb3IpIHtcbiAgICAgICAgICAgIHZhciBjb250ZXh0ID0gdGhpcy5fZ2V0Q29udGV4dChsaW5lQ29sb3IsIGZpbGxDb2xvcik7XG4gICAgICAgICAgICBjb250ZXh0LmJlZ2luUGF0aCgpO1xuICAgICAgICAgICAgY29udGV4dC5tb3ZlVG8oeCwgeSk7XG4gICAgICAgICAgICBjb250ZXh0LmFyYyh4LCB5LCByYWRpdXMsIHN0YXJ0QW5nbGUsIGVuZEFuZ2xlLCBmYWxzZSk7XG4gICAgICAgICAgICBjb250ZXh0LmxpbmVUbyh4LCB5KTtcbiAgICAgICAgICAgIGNvbnRleHQuY2xvc2VQYXRoKCk7XG4gICAgICAgICAgICBpZiAobGluZUNvbG9yICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0LnN0cm9rZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGZpbGxDb2xvcikge1xuICAgICAgICAgICAgICAgIGNvbnRleHQuZmlsbCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMudGFyZ2V0WCAhPT0gdW5kZWZpbmVkICYmIHRoaXMudGFyZ2V0WSAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICAgICAgY29udGV4dC5pc1BvaW50SW5QYXRoKHRoaXMudGFyZ2V0WCwgdGhpcy50YXJnZXRZKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFRhcmdldFNoYXBlSWQgPSBzaGFwZWlkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIF9kcmF3UmVjdDogZnVuY3Rpb24gKHNoYXBlaWQsIHgsIHksIHdpZHRoLCBoZWlnaHQsIGxpbmVDb2xvciwgZmlsbENvbG9yKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZHJhd1NoYXBlKHNoYXBlaWQsIFtbeCwgeV0sIFt4ICsgd2lkdGgsIHldLCBbeCArIHdpZHRoLCB5ICsgaGVpZ2h0XSwgW3gsIHkgKyBoZWlnaHRdLCBbeCwgeV1dLCBsaW5lQ29sb3IsIGZpbGxDb2xvcik7XG4gICAgICAgIH0sXG5cbiAgICAgICAgYXBwZW5kU2hhcGU6IGZ1bmN0aW9uIChzaGFwZSkge1xuICAgICAgICAgICAgdGhpcy5zaGFwZXNbc2hhcGUuaWRdID0gc2hhcGU7XG4gICAgICAgICAgICB0aGlzLnNoYXBlc2VxLnB1c2goc2hhcGUuaWQpO1xuICAgICAgICAgICAgdGhpcy5sYXN0U2hhcGVJZCA9IHNoYXBlLmlkO1xuICAgICAgICAgICAgcmV0dXJuIHNoYXBlLmlkO1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlcGxhY2VXaXRoU2hhcGU6IGZ1bmN0aW9uIChzaGFwZWlkLCBzaGFwZSkge1xuICAgICAgICAgICAgdmFyIHNoYXBlc2VxID0gdGhpcy5zaGFwZXNlcSxcbiAgICAgICAgICAgICAgICBpO1xuICAgICAgICAgICAgdGhpcy5zaGFwZXNbc2hhcGUuaWRdID0gc2hhcGU7XG4gICAgICAgICAgICBmb3IgKGkgPSBzaGFwZXNlcS5sZW5ndGg7IGktLTspIHtcbiAgICAgICAgICAgICAgICBpZiAoc2hhcGVzZXFbaV0gPT0gc2hhcGVpZCkge1xuICAgICAgICAgICAgICAgICAgICBzaGFwZXNlcVtpXSA9IHNoYXBlLmlkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRlbGV0ZSB0aGlzLnNoYXBlc1tzaGFwZWlkXTtcbiAgICAgICAgfSxcblxuICAgICAgICByZXBsYWNlV2l0aFNoYXBlczogZnVuY3Rpb24gKHNoYXBlaWRzLCBzaGFwZXMpIHtcbiAgICAgICAgICAgIHZhciBzaGFwZXNlcSA9IHRoaXMuc2hhcGVzZXEsXG4gICAgICAgICAgICAgICAgc2hhcGVtYXAgPSB7fSxcbiAgICAgICAgICAgICAgICBzaWQsIGksIGZpcnN0O1xuXG4gICAgICAgICAgICBmb3IgKGkgPSBzaGFwZWlkcy5sZW5ndGg7IGktLTspIHtcbiAgICAgICAgICAgICAgICBzaGFwZW1hcFtzaGFwZWlkc1tpXV0gPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChpID0gc2hhcGVzZXEubGVuZ3RoOyBpLS07KSB7XG4gICAgICAgICAgICAgICAgc2lkID0gc2hhcGVzZXFbaV07XG4gICAgICAgICAgICAgICAgaWYgKHNoYXBlbWFwW3NpZF0pIHtcbiAgICAgICAgICAgICAgICAgICAgc2hhcGVzZXEuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5zaGFwZXNbc2lkXTtcbiAgICAgICAgICAgICAgICAgICAgZmlyc3QgPSBpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAoaSA9IHNoYXBlcy5sZW5ndGg7IGktLTspIHtcbiAgICAgICAgICAgICAgICBzaGFwZXNlcS5zcGxpY2UoZmlyc3QsIDAsIHNoYXBlc1tpXS5pZCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zaGFwZXNbc2hhcGVzW2ldLmlkXSA9IHNoYXBlc1tpXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9LFxuXG4gICAgICAgIGluc2VydEFmdGVyU2hhcGU6IGZ1bmN0aW9uIChzaGFwZWlkLCBzaGFwZSkge1xuICAgICAgICAgICAgdmFyIHNoYXBlc2VxID0gdGhpcy5zaGFwZXNlcSxcbiAgICAgICAgICAgICAgICBpO1xuICAgICAgICAgICAgZm9yIChpID0gc2hhcGVzZXEubGVuZ3RoOyBpLS07KSB7XG4gICAgICAgICAgICAgICAgaWYgKHNoYXBlc2VxW2ldID09PSBzaGFwZWlkKSB7XG4gICAgICAgICAgICAgICAgICAgIHNoYXBlc2VxLnNwbGljZShpICsgMSwgMCwgc2hhcGUuaWQpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNoYXBlc1tzaGFwZS5pZF0gPSBzaGFwZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICByZW1vdmVTaGFwZUlkOiBmdW5jdGlvbiAoc2hhcGVpZCkge1xuICAgICAgICAgICAgdmFyIHNoYXBlc2VxID0gdGhpcy5zaGFwZXNlcSxcbiAgICAgICAgICAgICAgICBpO1xuICAgICAgICAgICAgZm9yIChpID0gc2hhcGVzZXEubGVuZ3RoOyBpLS07KSB7XG4gICAgICAgICAgICAgICAgaWYgKHNoYXBlc2VxW2ldID09PSBzaGFwZWlkKSB7XG4gICAgICAgICAgICAgICAgICAgIHNoYXBlc2VxLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVsZXRlIHRoaXMuc2hhcGVzW3NoYXBlaWRdO1xuICAgICAgICB9LFxuXG4gICAgICAgIGdldFNoYXBlQXQ6IGZ1bmN0aW9uIChlbCwgeCwgeSkge1xuICAgICAgICAgICAgdGhpcy50YXJnZXRYID0geDtcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0WSA9IHk7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY3VycmVudFRhcmdldFNoYXBlSWQ7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgc2hhcGVzZXEgPSB0aGlzLnNoYXBlc2VxLFxuICAgICAgICAgICAgICAgIHNoYXBlcyA9IHRoaXMuc2hhcGVzLFxuICAgICAgICAgICAgICAgIHNoYXBlQ291bnQgPSBzaGFwZXNlcS5sZW5ndGgsXG4gICAgICAgICAgICAgICAgY29udGV4dCA9IHRoaXMuX2dldENvbnRleHQoKSxcbiAgICAgICAgICAgICAgICBzaGFwZWlkLCBzaGFwZSwgaTtcbiAgICAgICAgICAgIGNvbnRleHQuY2xlYXJSZWN0KDAsIDAsIHRoaXMucGl4ZWxXaWR0aCwgdGhpcy5waXhlbEhlaWdodCk7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgc2hhcGVDb3VudDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgc2hhcGVpZCA9IHNoYXBlc2VxW2ldO1xuICAgICAgICAgICAgICAgIHNoYXBlID0gc2hhcGVzW3NoYXBlaWRdO1xuICAgICAgICAgICAgICAgIHRoaXNbJ19kcmF3JyArIHNoYXBlLnR5cGVdLmFwcGx5KHRoaXMsIHNoYXBlLmFyZ3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCF0aGlzLmludGVyYWN0KSB7XG4gICAgICAgICAgICAgICAgLy8gbm90IGludGVyYWN0aXZlIHNvIG5vIG5lZWQgdG8ga2VlcCB0aGUgc2hhcGVzIGFycmF5XG4gICAgICAgICAgICAgICAgdGhpcy5zaGFwZXMgPSB7fTtcbiAgICAgICAgICAgICAgICB0aGlzLnNoYXBlc2VxID0gW107XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgIH0pO1xuXG4gICAgVkNhbnZhc192bWwgPSBjcmVhdGVDbGFzcyhWQ2FudmFzX2Jhc2UsIHtcbiAgICAgICAgaW5pdDogZnVuY3Rpb24gKHdpZHRoLCBoZWlnaHQsIHRhcmdldCkge1xuICAgICAgICAgICAgdmFyIGdyb3VwZWw7XG4gICAgICAgICAgICBWQ2FudmFzX3ZtbC5fc3VwZXIuaW5pdC5jYWxsKHRoaXMsIHdpZHRoLCBoZWlnaHQsIHRhcmdldCk7XG4gICAgICAgICAgICBpZiAodGFyZ2V0WzBdKSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0gdGFyZ2V0WzBdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJC5kYXRhKHRhcmdldCwgJ19qcXNfdmNhbnZhcycsIHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5jYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICAgICAgICAkKHRoaXMuY2FudmFzKS5jc3MoeyBkaXNwbGF5OiAnaW5saW5lLWJsb2NrJywgcG9zaXRpb246ICdyZWxhdGl2ZScsIG92ZXJmbG93OiAnaGlkZGVuJywgd2lkdGg6IHdpZHRoLCBoZWlnaHQ6IGhlaWdodCwgbWFyZ2luOiAnMHB4JywgcGFkZGluZzogJzBweCcsIHZlcnRpY2FsQWxpZ246ICd0b3AnfSk7XG4gICAgICAgICAgICB0aGlzLl9pbnNlcnQodGhpcy5jYW52YXMsIHRhcmdldCk7XG4gICAgICAgICAgICB0aGlzLl9jYWxjdWxhdGVQaXhlbERpbXMod2lkdGgsIGhlaWdodCwgdGhpcy5jYW52YXMpO1xuICAgICAgICAgICAgdGhpcy5jYW52YXMud2lkdGggPSB0aGlzLnBpeGVsV2lkdGg7XG4gICAgICAgICAgICB0aGlzLmNhbnZhcy5oZWlnaHQgPSB0aGlzLnBpeGVsSGVpZ2h0O1xuICAgICAgICAgICAgZ3JvdXBlbCA9ICc8djpncm91cCBjb29yZG9yaWdpbj1cIjAgMFwiIGNvb3Jkc2l6ZT1cIicgKyB0aGlzLnBpeGVsV2lkdGggKyAnICcgKyB0aGlzLnBpeGVsSGVpZ2h0ICsgJ1wiJyArXG4gICAgICAgICAgICAgICAgICAgICcgc3R5bGU9XCJwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MDtsZWZ0OjA7d2lkdGg6JyArIHRoaXMucGl4ZWxXaWR0aCArICdweDtoZWlnaHQ9JyArIHRoaXMucGl4ZWxIZWlnaHQgKyAncHg7XCI+PC92Omdyb3VwPic7XG4gICAgICAgICAgICB0aGlzLmNhbnZhcy5pbnNlcnRBZGphY2VudEhUTUwoJ2JlZm9yZUVuZCcsIGdyb3VwZWwpO1xuICAgICAgICAgICAgdGhpcy5ncm91cCA9ICQodGhpcy5jYW52YXMpLmNoaWxkcmVuKClbMF07XG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVkID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLnByZXJlbmRlciA9ICcnO1xuICAgICAgICB9LFxuXG4gICAgICAgIF9kcmF3U2hhcGU6IGZ1bmN0aW9uIChzaGFwZWlkLCBwYXRoLCBsaW5lQ29sb3IsIGZpbGxDb2xvciwgbGluZVdpZHRoKSB7XG4gICAgICAgICAgICB2YXIgdnBhdGggPSBbXSxcbiAgICAgICAgICAgICAgICBpbml0aWFsLCBzdHJva2UsIGZpbGwsIGNsb3NlZCwgdmVsLCBwbGVuLCBpO1xuICAgICAgICAgICAgZm9yIChpID0gMCwgcGxlbiA9IHBhdGgubGVuZ3RoOyBpIDwgcGxlbjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdnBhdGhbaV0gPSAnJyArIChwYXRoW2ldWzBdKSArICcsJyArIChwYXRoW2ldWzFdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGluaXRpYWwgPSB2cGF0aC5zcGxpY2UoMCwgMSk7XG4gICAgICAgICAgICBsaW5lV2lkdGggPSBsaW5lV2lkdGggPT09IHVuZGVmaW5lZCA/IDEgOiBsaW5lV2lkdGg7XG4gICAgICAgICAgICBzdHJva2UgPSBsaW5lQ29sb3IgPT09IHVuZGVmaW5lZCA/ICcgc3Ryb2tlZD1cImZhbHNlXCIgJyA6ICcgc3Ryb2tlV2VpZ2h0PVwiJyArIGxpbmVXaWR0aCArICdweFwiIHN0cm9rZUNvbG9yPVwiJyArIGxpbmVDb2xvciArICdcIiAnO1xuICAgICAgICAgICAgZmlsbCA9IGZpbGxDb2xvciA9PT0gdW5kZWZpbmVkID8gJyBmaWxsZWQ9XCJmYWxzZVwiJyA6ICcgZmlsbENvbG9yPVwiJyArIGZpbGxDb2xvciArICdcIiBmaWxsZWQ9XCJ0cnVlXCIgJztcbiAgICAgICAgICAgIGNsb3NlZCA9IHZwYXRoWzBdID09PSB2cGF0aFt2cGF0aC5sZW5ndGggLSAxXSA/ICd4ICcgOiAnJztcbiAgICAgICAgICAgIHZlbCA9ICc8djpzaGFwZSBjb29yZG9yaWdpbj1cIjAgMFwiIGNvb3Jkc2l6ZT1cIicgKyB0aGlzLnBpeGVsV2lkdGggKyAnICcgKyB0aGlzLnBpeGVsSGVpZ2h0ICsgJ1wiICcgK1xuICAgICAgICAgICAgICAgICAnIGlkPVwianFzc2hhcGUnICsgc2hhcGVpZCArICdcIiAnICtcbiAgICAgICAgICAgICAgICAgc3Ryb2tlICtcbiAgICAgICAgICAgICAgICAgZmlsbCArXG4gICAgICAgICAgICAgICAgJyBzdHlsZT1cInBvc2l0aW9uOmFic29sdXRlO2xlZnQ6MHB4O3RvcDowcHg7aGVpZ2h0OicgKyB0aGlzLnBpeGVsSGVpZ2h0ICsgJ3B4O3dpZHRoOicgKyB0aGlzLnBpeGVsV2lkdGggKyAncHg7cGFkZGluZzowcHg7bWFyZ2luOjBweDtcIiAnICtcbiAgICAgICAgICAgICAgICAnIHBhdGg9XCJtICcgKyBpbml0aWFsICsgJyBsICcgKyB2cGF0aC5qb2luKCcsICcpICsgJyAnICsgY2xvc2VkICsgJ2VcIj4nICtcbiAgICAgICAgICAgICAgICAnIDwvdjpzaGFwZT4nO1xuICAgICAgICAgICAgcmV0dXJuIHZlbDtcbiAgICAgICAgfSxcblxuICAgICAgICBfZHJhd0NpcmNsZTogZnVuY3Rpb24gKHNoYXBlaWQsIHgsIHksIHJhZGl1cywgbGluZUNvbG9yLCBmaWxsQ29sb3IsIGxpbmVXaWR0aCkge1xuICAgICAgICAgICAgdmFyIHN0cm9rZSwgZmlsbCwgdmVsO1xuICAgICAgICAgICAgeCAtPSByYWRpdXM7XG4gICAgICAgICAgICB5IC09IHJhZGl1cztcbiAgICAgICAgICAgIHN0cm9rZSA9IGxpbmVDb2xvciA9PT0gdW5kZWZpbmVkID8gJyBzdHJva2VkPVwiZmFsc2VcIiAnIDogJyBzdHJva2VXZWlnaHQ9XCInICsgbGluZVdpZHRoICsgJ3B4XCIgc3Ryb2tlQ29sb3I9XCInICsgbGluZUNvbG9yICsgJ1wiICc7XG4gICAgICAgICAgICBmaWxsID0gZmlsbENvbG9yID09PSB1bmRlZmluZWQgPyAnIGZpbGxlZD1cImZhbHNlXCInIDogJyBmaWxsQ29sb3I9XCInICsgZmlsbENvbG9yICsgJ1wiIGZpbGxlZD1cInRydWVcIiAnO1xuICAgICAgICAgICAgdmVsID0gJzx2Om92YWwgJyArXG4gICAgICAgICAgICAgICAgICcgaWQ9XCJqcXNzaGFwZScgKyBzaGFwZWlkICsgJ1wiICcgK1xuICAgICAgICAgICAgICAgIHN0cm9rZSArXG4gICAgICAgICAgICAgICAgZmlsbCArXG4gICAgICAgICAgICAgICAgJyBzdHlsZT1cInBvc2l0aW9uOmFic29sdXRlO3RvcDonICsgeSArICdweDsgbGVmdDonICsgeCArICdweDsgd2lkdGg6JyArIChyYWRpdXMgKiAyKSArICdweDsgaGVpZ2h0OicgKyAocmFkaXVzICogMikgKyAncHhcIj48L3Y6b3ZhbD4nO1xuICAgICAgICAgICAgcmV0dXJuIHZlbDtcblxuICAgICAgICB9LFxuXG4gICAgICAgIF9kcmF3UGllU2xpY2U6IGZ1bmN0aW9uIChzaGFwZWlkLCB4LCB5LCByYWRpdXMsIHN0YXJ0QW5nbGUsIGVuZEFuZ2xlLCBsaW5lQ29sb3IsIGZpbGxDb2xvcikge1xuICAgICAgICAgICAgdmFyIHZwYXRoLCBzdGFydHgsIHN0YXJ0eSwgZW5keCwgZW5keSwgc3Ryb2tlLCBmaWxsLCB2ZWw7XG4gICAgICAgICAgICBpZiAoc3RhcnRBbmdsZSA9PT0gZW5kQW5nbGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJyc7ICAvLyBWTUwgc2VlbXMgdG8gaGF2ZSBwcm9ibGVtIHdoZW4gc3RhcnQgYW5nbGUgZXF1YWxzIGVuZCBhbmdsZS5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICgoZW5kQW5nbGUgLSBzdGFydEFuZ2xlKSA9PT0gKDIgKiBNYXRoLlBJKSkge1xuICAgICAgICAgICAgICAgIHN0YXJ0QW5nbGUgPSAwLjA7ICAvLyBWTUwgc2VlbXMgdG8gaGF2ZSBhIHByb2JsZW0gd2hlbiBkcmF3aW5nIGEgZnVsbCBjaXJjbGUgdGhhdCBkb2Vzbid0IHN0YXJ0IDBcbiAgICAgICAgICAgICAgICBlbmRBbmdsZSA9ICgyICogTWF0aC5QSSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHN0YXJ0eCA9IHggKyBNYXRoLnJvdW5kKE1hdGguY29zKHN0YXJ0QW5nbGUpICogcmFkaXVzKTtcbiAgICAgICAgICAgIHN0YXJ0eSA9IHkgKyBNYXRoLnJvdW5kKE1hdGguc2luKHN0YXJ0QW5nbGUpICogcmFkaXVzKTtcbiAgICAgICAgICAgIGVuZHggPSB4ICsgTWF0aC5yb3VuZChNYXRoLmNvcyhlbmRBbmdsZSkgKiByYWRpdXMpO1xuICAgICAgICAgICAgZW5keSA9IHkgKyBNYXRoLnJvdW5kKE1hdGguc2luKGVuZEFuZ2xlKSAqIHJhZGl1cyk7XG5cbiAgICAgICAgICAgIGlmIChzdGFydHggPT09IGVuZHggJiYgc3RhcnR5ID09PSBlbmR5KSB7XG4gICAgICAgICAgICAgICAgaWYgKChlbmRBbmdsZSAtIHN0YXJ0QW5nbGUpIDwgTWF0aC5QSSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBQcmV2ZW50IHZlcnkgc21hbGwgc2xpY2VzIGZyb20gYmVpbmcgbWlzdGFrZW4gYXMgYSB3aG9sZSBwaWVcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBlc3NlbnRpYWxseSBnb2luZyB0byBiZSB0aGUgZW50aXJlIGNpcmNsZSwgc28gaWdub3JlIHN0YXJ0QW5nbGVcbiAgICAgICAgICAgICAgICBzdGFydHggPSBlbmR4ID0geCArIHJhZGl1cztcbiAgICAgICAgICAgICAgICBzdGFydHkgPSBlbmR5ID0geTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHN0YXJ0eCA9PT0gZW5keCAmJiBzdGFydHkgPT09IGVuZHkgJiYgKGVuZEFuZ2xlIC0gc3RhcnRBbmdsZSkgPCBNYXRoLlBJKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2cGF0aCA9IFt4IC0gcmFkaXVzLCB5IC0gcmFkaXVzLCB4ICsgcmFkaXVzLCB5ICsgcmFkaXVzLCBzdGFydHgsIHN0YXJ0eSwgZW5keCwgZW5keV07XG4gICAgICAgICAgICBzdHJva2UgPSBsaW5lQ29sb3IgPT09IHVuZGVmaW5lZCA/ICcgc3Ryb2tlZD1cImZhbHNlXCIgJyA6ICcgc3Ryb2tlV2VpZ2h0PVwiMXB4XCIgc3Ryb2tlQ29sb3I9XCInICsgbGluZUNvbG9yICsgJ1wiICc7XG4gICAgICAgICAgICBmaWxsID0gZmlsbENvbG9yID09PSB1bmRlZmluZWQgPyAnIGZpbGxlZD1cImZhbHNlXCInIDogJyBmaWxsQ29sb3I9XCInICsgZmlsbENvbG9yICsgJ1wiIGZpbGxlZD1cInRydWVcIiAnO1xuICAgICAgICAgICAgdmVsID0gJzx2OnNoYXBlIGNvb3Jkb3JpZ2luPVwiMCAwXCIgY29vcmRzaXplPVwiJyArIHRoaXMucGl4ZWxXaWR0aCArICcgJyArIHRoaXMucGl4ZWxIZWlnaHQgKyAnXCIgJyArXG4gICAgICAgICAgICAgICAgICcgaWQ9XCJqcXNzaGFwZScgKyBzaGFwZWlkICsgJ1wiICcgK1xuICAgICAgICAgICAgICAgICBzdHJva2UgK1xuICAgICAgICAgICAgICAgICBmaWxsICtcbiAgICAgICAgICAgICAgICAnIHN0eWxlPVwicG9zaXRpb246YWJzb2x1dGU7bGVmdDowcHg7dG9wOjBweDtoZWlnaHQ6JyArIHRoaXMucGl4ZWxIZWlnaHQgKyAncHg7d2lkdGg6JyArIHRoaXMucGl4ZWxXaWR0aCArICdweDtwYWRkaW5nOjBweDttYXJnaW46MHB4O1wiICcgK1xuICAgICAgICAgICAgICAgICcgcGF0aD1cIm0gJyArIHggKyAnLCcgKyB5ICsgJyB3YSAnICsgdnBhdGguam9pbignLCAnKSArICcgeCBlXCI+JyArXG4gICAgICAgICAgICAgICAgJyA8L3Y6c2hhcGU+JztcbiAgICAgICAgICAgIHJldHVybiB2ZWw7XG4gICAgICAgIH0sXG5cbiAgICAgICAgX2RyYXdSZWN0OiBmdW5jdGlvbiAoc2hhcGVpZCwgeCwgeSwgd2lkdGgsIGhlaWdodCwgbGluZUNvbG9yLCBmaWxsQ29sb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9kcmF3U2hhcGUoc2hhcGVpZCwgW1t4LCB5XSwgW3gsIHkgKyBoZWlnaHRdLCBbeCArIHdpZHRoLCB5ICsgaGVpZ2h0XSwgW3ggKyB3aWR0aCwgeV0sIFt4LCB5XV0sIGxpbmVDb2xvciwgZmlsbENvbG9yKTtcbiAgICAgICAgfSxcblxuICAgICAgICByZXNldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5ncm91cC5pbm5lckhUTUwgPSAnJztcbiAgICAgICAgfSxcblxuICAgICAgICBhcHBlbmRTaGFwZTogZnVuY3Rpb24gKHNoYXBlKSB7XG4gICAgICAgICAgICB2YXIgdmVsID0gdGhpc1snX2RyYXcnICsgc2hhcGUudHlwZV0uYXBwbHkodGhpcywgc2hhcGUuYXJncyk7XG4gICAgICAgICAgICBpZiAodGhpcy5yZW5kZXJlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZ3JvdXAuaW5zZXJ0QWRqYWNlbnRIVE1MKCdiZWZvcmVFbmQnLCB2ZWwpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByZXJlbmRlciArPSB2ZWw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmxhc3RTaGFwZUlkID0gc2hhcGUuaWQ7XG4gICAgICAgICAgICByZXR1cm4gc2hhcGUuaWQ7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVwbGFjZVdpdGhTaGFwZTogZnVuY3Rpb24gKHNoYXBlaWQsIHNoYXBlKSB7XG4gICAgICAgICAgICB2YXIgZXhpc3RpbmcgPSAkKCcjanFzc2hhcGUnICsgc2hhcGVpZCksXG4gICAgICAgICAgICAgICAgdmVsID0gdGhpc1snX2RyYXcnICsgc2hhcGUudHlwZV0uYXBwbHkodGhpcywgc2hhcGUuYXJncyk7XG4gICAgICAgICAgICBleGlzdGluZ1swXS5vdXRlckhUTUwgPSB2ZWw7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVwbGFjZVdpdGhTaGFwZXM6IGZ1bmN0aW9uIChzaGFwZWlkcywgc2hhcGVzKSB7XG4gICAgICAgICAgICAvLyByZXBsYWNlIHRoZSBmaXJzdCBzaGFwZWlkIHdpdGggYWxsIHRoZSBuZXcgc2hhcGVzIHRoZW4gdG9hc3QgdGhlIHJlbWFpbmluZyBvbGQgc2hhcGVzXG4gICAgICAgICAgICB2YXIgZXhpc3RpbmcgPSAkKCcjanFzc2hhcGUnICsgc2hhcGVpZHNbMF0pLFxuICAgICAgICAgICAgICAgIHJlcGxhY2UgPSAnJyxcbiAgICAgICAgICAgICAgICBzbGVuID0gc2hhcGVzLmxlbmd0aCxcbiAgICAgICAgICAgICAgICBpO1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHNsZW47IGkrKykge1xuICAgICAgICAgICAgICAgIHJlcGxhY2UgKz0gdGhpc1snX2RyYXcnICsgc2hhcGVzW2ldLnR5cGVdLmFwcGx5KHRoaXMsIHNoYXBlc1tpXS5hcmdzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGV4aXN0aW5nWzBdLm91dGVySFRNTCA9IHJlcGxhY2U7XG4gICAgICAgICAgICBmb3IgKGkgPSAxOyBpIDwgc2hhcGVpZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAkKCcjanFzc2hhcGUnICsgc2hhcGVpZHNbaV0pLnJlbW92ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIGluc2VydEFmdGVyU2hhcGU6IGZ1bmN0aW9uIChzaGFwZWlkLCBzaGFwZSkge1xuICAgICAgICAgICAgdmFyIGV4aXN0aW5nID0gJCgnI2pxc3NoYXBlJyArIHNoYXBlaWQpLFxuICAgICAgICAgICAgICAgICB2ZWwgPSB0aGlzWydfZHJhdycgKyBzaGFwZS50eXBlXS5hcHBseSh0aGlzLCBzaGFwZS5hcmdzKTtcbiAgICAgICAgICAgIGV4aXN0aW5nWzBdLmluc2VydEFkamFjZW50SFRNTCgnYWZ0ZXJFbmQnLCB2ZWwpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlbW92ZVNoYXBlSWQ6IGZ1bmN0aW9uIChzaGFwZWlkKSB7XG4gICAgICAgICAgICB2YXIgZXhpc3RpbmcgPSAkKCcjanFzc2hhcGUnICsgc2hhcGVpZCk7XG4gICAgICAgICAgICB0aGlzLmdyb3VwLnJlbW92ZUNoaWxkKGV4aXN0aW5nWzBdKTtcbiAgICAgICAgfSxcblxuICAgICAgICBnZXRTaGFwZUF0OiBmdW5jdGlvbiAoZWwsIHgsIHkpIHtcbiAgICAgICAgICAgIHZhciBzaGFwZWlkID0gZWwuaWQuc3Vic3RyKDgpO1xuICAgICAgICAgICAgcmV0dXJuIHNoYXBlaWQ7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMucmVuZGVyZWQpIHtcbiAgICAgICAgICAgICAgICAvLyBiYXRjaCB0aGUgaW50aWFsIHJlbmRlciBpbnRvIGEgc2luZ2xlIHJlcGFpbnRcbiAgICAgICAgICAgICAgICB0aGlzLmdyb3VwLmlubmVySFRNTCA9IHRoaXMucHJlcmVuZGVyO1xuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyZWQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG5cbn0pKX0oZG9jdW1lbnQsIE1hdGgpKTtcbiIsIi8qIVxuICogbXVzdGFjaGUuanMgLSBMb2dpYy1sZXNzIHt7bXVzdGFjaGV9fSB0ZW1wbGF0ZXMgd2l0aCBKYXZhU2NyaXB0XG4gKiBodHRwOi8vZ2l0aHViLmNvbS9qYW5sL211c3RhY2hlLmpzXG4gKi9cblxuLypnbG9iYWwgZGVmaW5lOiBmYWxzZSBNdXN0YWNoZTogdHJ1ZSovXG5cbihmdW5jdGlvbiBkZWZpbmVNdXN0YWNoZSAoZ2xvYmFsLCBmYWN0b3J5KSB7XG4gIGlmICh0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgZXhwb3J0cyAmJiB0eXBlb2YgZXhwb3J0cy5ub2RlTmFtZSAhPT0gJ3N0cmluZycpIHtcbiAgICBmYWN0b3J5KGV4cG9ydHMpOyAvLyBDb21tb25KU1xuICB9IGVsc2UgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuICAgIGRlZmluZShbJ2V4cG9ydHMnXSwgZmFjdG9yeSk7IC8vIEFNRFxuICB9IGVsc2Uge1xuICAgIGdsb2JhbC5NdXN0YWNoZSA9IHt9O1xuICAgIGZhY3RvcnkoZ2xvYmFsLk11c3RhY2hlKTsgLy8gc2NyaXB0LCB3c2gsIGFzcFxuICB9XG59KHRoaXMsIGZ1bmN0aW9uIG11c3RhY2hlRmFjdG9yeSAobXVzdGFjaGUpIHtcblxuICB2YXIgb2JqZWN0VG9TdHJpbmcgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO1xuICB2YXIgaXNBcnJheSA9IEFycmF5LmlzQXJyYXkgfHwgZnVuY3Rpb24gaXNBcnJheVBvbHlmaWxsIChvYmplY3QpIHtcbiAgICByZXR1cm4gb2JqZWN0VG9TdHJpbmcuY2FsbChvYmplY3QpID09PSAnW29iamVjdCBBcnJheV0nO1xuICB9O1xuXG4gIGZ1bmN0aW9uIGlzRnVuY3Rpb24gKG9iamVjdCkge1xuICAgIHJldHVybiB0eXBlb2Ygb2JqZWN0ID09PSAnZnVuY3Rpb24nO1xuICB9XG5cbiAgLyoqXG4gICAqIE1vcmUgY29ycmVjdCB0eXBlb2Ygc3RyaW5nIGhhbmRsaW5nIGFycmF5XG4gICAqIHdoaWNoIG5vcm1hbGx5IHJldHVybnMgdHlwZW9mICdvYmplY3QnXG4gICAqL1xuICBmdW5jdGlvbiB0eXBlU3RyIChvYmopIHtcbiAgICByZXR1cm4gaXNBcnJheShvYmopID8gJ2FycmF5JyA6IHR5cGVvZiBvYmo7XG4gIH1cblxuICBmdW5jdGlvbiBlc2NhcGVSZWdFeHAgKHN0cmluZykge1xuICAgIHJldHVybiBzdHJpbmcucmVwbGFjZSgvW1xcLVxcW1xcXXt9KCkqKz8uLFxcXFxcXF4kfCNcXHNdL2csICdcXFxcJCYnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBOdWxsIHNhZmUgd2F5IG9mIGNoZWNraW5nIHdoZXRoZXIgb3Igbm90IGFuIG9iamVjdCxcbiAgICogaW5jbHVkaW5nIGl0cyBwcm90b3R5cGUsIGhhcyBhIGdpdmVuIHByb3BlcnR5XG4gICAqL1xuICBmdW5jdGlvbiBoYXNQcm9wZXJ0eSAob2JqLCBwcm9wTmFtZSkge1xuICAgIHJldHVybiBvYmogIT0gbnVsbCAmJiB0eXBlb2Ygb2JqID09PSAnb2JqZWN0JyAmJiAocHJvcE5hbWUgaW4gb2JqKTtcbiAgfVxuXG4gIC8vIFdvcmthcm91bmQgZm9yIGh0dHBzOi8vaXNzdWVzLmFwYWNoZS5vcmcvamlyYS9icm93c2UvQ09VQ0hEQi01NzdcbiAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9qYW5sL211c3RhY2hlLmpzL2lzc3Vlcy8xODlcbiAgdmFyIHJlZ0V4cFRlc3QgPSBSZWdFeHAucHJvdG90eXBlLnRlc3Q7XG4gIGZ1bmN0aW9uIHRlc3RSZWdFeHAgKHJlLCBzdHJpbmcpIHtcbiAgICByZXR1cm4gcmVnRXhwVGVzdC5jYWxsKHJlLCBzdHJpbmcpO1xuICB9XG5cbiAgdmFyIG5vblNwYWNlUmUgPSAvXFxTLztcbiAgZnVuY3Rpb24gaXNXaGl0ZXNwYWNlIChzdHJpbmcpIHtcbiAgICByZXR1cm4gIXRlc3RSZWdFeHAobm9uU3BhY2VSZSwgc3RyaW5nKTtcbiAgfVxuXG4gIHZhciBlbnRpdHlNYXAgPSB7XG4gICAgJyYnOiAnJmFtcDsnLFxuICAgICc8JzogJyZsdDsnLFxuICAgICc+JzogJyZndDsnLFxuICAgICdcIic6ICcmcXVvdDsnLFxuICAgIFwiJ1wiOiAnJiMzOTsnLFxuICAgICcvJzogJyYjeDJGOycsXG4gICAgJ2AnOiAnJiN4NjA7JyxcbiAgICAnPSc6ICcmI3gzRDsnXG4gIH07XG5cbiAgZnVuY3Rpb24gZXNjYXBlSHRtbCAoc3RyaW5nKSB7XG4gICAgcmV0dXJuIFN0cmluZyhzdHJpbmcpLnJlcGxhY2UoL1smPD5cIidgPVxcL10vZywgZnVuY3Rpb24gZnJvbUVudGl0eU1hcCAocykge1xuICAgICAgcmV0dXJuIGVudGl0eU1hcFtzXTtcbiAgICB9KTtcbiAgfVxuXG4gIHZhciB3aGl0ZVJlID0gL1xccyovO1xuICB2YXIgc3BhY2VSZSA9IC9cXHMrLztcbiAgdmFyIGVxdWFsc1JlID0gL1xccyo9LztcbiAgdmFyIGN1cmx5UmUgPSAvXFxzKlxcfS87XG4gIHZhciB0YWdSZSA9IC8jfFxcXnxcXC98PnxcXHt8Jnw9fCEvO1xuXG4gIC8qKlxuICAgKiBCcmVha3MgdXAgdGhlIGdpdmVuIGB0ZW1wbGF0ZWAgc3RyaW5nIGludG8gYSB0cmVlIG9mIHRva2Vucy4gSWYgdGhlIGB0YWdzYFxuICAgKiBhcmd1bWVudCBpcyBnaXZlbiBoZXJlIGl0IG11c3QgYmUgYW4gYXJyYXkgd2l0aCB0d28gc3RyaW5nIHZhbHVlczogdGhlXG4gICAqIG9wZW5pbmcgYW5kIGNsb3NpbmcgdGFncyB1c2VkIGluIHRoZSB0ZW1wbGF0ZSAoZS5nLiBbIFwiPCVcIiwgXCIlPlwiIF0pLiBPZlxuICAgKiBjb3Vyc2UsIHRoZSBkZWZhdWx0IGlzIHRvIHVzZSBtdXN0YWNoZXMgKGkuZS4gbXVzdGFjaGUudGFncykuXG4gICAqXG4gICAqIEEgdG9rZW4gaXMgYW4gYXJyYXkgd2l0aCBhdCBsZWFzdCA0IGVsZW1lbnRzLiBUaGUgZmlyc3QgZWxlbWVudCBpcyB0aGVcbiAgICogbXVzdGFjaGUgc3ltYm9sIHRoYXQgd2FzIHVzZWQgaW5zaWRlIHRoZSB0YWcsIGUuZy4gXCIjXCIgb3IgXCImXCIuIElmIHRoZSB0YWdcbiAgICogZGlkIG5vdCBjb250YWluIGEgc3ltYm9sIChpLmUuIHt7bXlWYWx1ZX19KSB0aGlzIGVsZW1lbnQgaXMgXCJuYW1lXCIuIEZvclxuICAgKiBhbGwgdGV4dCB0aGF0IGFwcGVhcnMgb3V0c2lkZSBhIHN5bWJvbCB0aGlzIGVsZW1lbnQgaXMgXCJ0ZXh0XCIuXG4gICAqXG4gICAqIFRoZSBzZWNvbmQgZWxlbWVudCBvZiBhIHRva2VuIGlzIGl0cyBcInZhbHVlXCIuIEZvciBtdXN0YWNoZSB0YWdzIHRoaXMgaXNcbiAgICogd2hhdGV2ZXIgZWxzZSB3YXMgaW5zaWRlIHRoZSB0YWcgYmVzaWRlcyB0aGUgb3BlbmluZyBzeW1ib2wuIEZvciB0ZXh0IHRva2Vuc1xuICAgKiB0aGlzIGlzIHRoZSB0ZXh0IGl0c2VsZi5cbiAgICpcbiAgICogVGhlIHRoaXJkIGFuZCBmb3VydGggZWxlbWVudHMgb2YgdGhlIHRva2VuIGFyZSB0aGUgc3RhcnQgYW5kIGVuZCBpbmRpY2VzLFxuICAgKiByZXNwZWN0aXZlbHksIG9mIHRoZSB0b2tlbiBpbiB0aGUgb3JpZ2luYWwgdGVtcGxhdGUuXG4gICAqXG4gICAqIFRva2VucyB0aGF0IGFyZSB0aGUgcm9vdCBub2RlIG9mIGEgc3VidHJlZSBjb250YWluIHR3byBtb3JlIGVsZW1lbnRzOiAxKSBhblxuICAgKiBhcnJheSBvZiB0b2tlbnMgaW4gdGhlIHN1YnRyZWUgYW5kIDIpIHRoZSBpbmRleCBpbiB0aGUgb3JpZ2luYWwgdGVtcGxhdGUgYXRcbiAgICogd2hpY2ggdGhlIGNsb3NpbmcgdGFnIGZvciB0aGF0IHNlY3Rpb24gYmVnaW5zLlxuICAgKi9cbiAgZnVuY3Rpb24gcGFyc2VUZW1wbGF0ZSAodGVtcGxhdGUsIHRhZ3MpIHtcbiAgICBpZiAoIXRlbXBsYXRlKVxuICAgICAgcmV0dXJuIFtdO1xuXG4gICAgdmFyIHNlY3Rpb25zID0gW107ICAgICAvLyBTdGFjayB0byBob2xkIHNlY3Rpb24gdG9rZW5zXG4gICAgdmFyIHRva2VucyA9IFtdOyAgICAgICAvLyBCdWZmZXIgdG8gaG9sZCB0aGUgdG9rZW5zXG4gICAgdmFyIHNwYWNlcyA9IFtdOyAgICAgICAvLyBJbmRpY2VzIG9mIHdoaXRlc3BhY2UgdG9rZW5zIG9uIHRoZSBjdXJyZW50IGxpbmVcbiAgICB2YXIgaGFzVGFnID0gZmFsc2U7ICAgIC8vIElzIHRoZXJlIGEge3t0YWd9fSBvbiB0aGUgY3VycmVudCBsaW5lP1xuICAgIHZhciBub25TcGFjZSA9IGZhbHNlOyAgLy8gSXMgdGhlcmUgYSBub24tc3BhY2UgY2hhciBvbiB0aGUgY3VycmVudCBsaW5lP1xuXG4gICAgLy8gU3RyaXBzIGFsbCB3aGl0ZXNwYWNlIHRva2VucyBhcnJheSBmb3IgdGhlIGN1cnJlbnQgbGluZVxuICAgIC8vIGlmIHRoZXJlIHdhcyBhIHt7I3RhZ319IG9uIGl0IGFuZCBvdGhlcndpc2Ugb25seSBzcGFjZS5cbiAgICBmdW5jdGlvbiBzdHJpcFNwYWNlICgpIHtcbiAgICAgIGlmIChoYXNUYWcgJiYgIW5vblNwYWNlKSB7XG4gICAgICAgIHdoaWxlIChzcGFjZXMubGVuZ3RoKVxuICAgICAgICAgIGRlbGV0ZSB0b2tlbnNbc3BhY2VzLnBvcCgpXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNwYWNlcyA9IFtdO1xuICAgICAgfVxuXG4gICAgICBoYXNUYWcgPSBmYWxzZTtcbiAgICAgIG5vblNwYWNlID0gZmFsc2U7XG4gICAgfVxuXG4gICAgdmFyIG9wZW5pbmdUYWdSZSwgY2xvc2luZ1RhZ1JlLCBjbG9zaW5nQ3VybHlSZTtcbiAgICBmdW5jdGlvbiBjb21waWxlVGFncyAodGFnc1RvQ29tcGlsZSkge1xuICAgICAgaWYgKHR5cGVvZiB0YWdzVG9Db21waWxlID09PSAnc3RyaW5nJylcbiAgICAgICAgdGFnc1RvQ29tcGlsZSA9IHRhZ3NUb0NvbXBpbGUuc3BsaXQoc3BhY2VSZSwgMik7XG5cbiAgICAgIGlmICghaXNBcnJheSh0YWdzVG9Db21waWxlKSB8fCB0YWdzVG9Db21waWxlLmxlbmd0aCAhPT0gMilcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHRhZ3M6ICcgKyB0YWdzVG9Db21waWxlKTtcblxuICAgICAgb3BlbmluZ1RhZ1JlID0gbmV3IFJlZ0V4cChlc2NhcGVSZWdFeHAodGFnc1RvQ29tcGlsZVswXSkgKyAnXFxcXHMqJyk7XG4gICAgICBjbG9zaW5nVGFnUmUgPSBuZXcgUmVnRXhwKCdcXFxccyonICsgZXNjYXBlUmVnRXhwKHRhZ3NUb0NvbXBpbGVbMV0pKTtcbiAgICAgIGNsb3NpbmdDdXJseVJlID0gbmV3IFJlZ0V4cCgnXFxcXHMqJyArIGVzY2FwZVJlZ0V4cCgnfScgKyB0YWdzVG9Db21waWxlWzFdKSk7XG4gICAgfVxuXG4gICAgY29tcGlsZVRhZ3ModGFncyB8fCBtdXN0YWNoZS50YWdzKTtcblxuICAgIHZhciBzY2FubmVyID0gbmV3IFNjYW5uZXIodGVtcGxhdGUpO1xuXG4gICAgdmFyIHN0YXJ0LCB0eXBlLCB2YWx1ZSwgY2hyLCB0b2tlbiwgb3BlblNlY3Rpb247XG4gICAgd2hpbGUgKCFzY2FubmVyLmVvcygpKSB7XG4gICAgICBzdGFydCA9IHNjYW5uZXIucG9zO1xuXG4gICAgICAvLyBNYXRjaCBhbnkgdGV4dCBiZXR3ZWVuIHRhZ3MuXG4gICAgICB2YWx1ZSA9IHNjYW5uZXIuc2NhblVudGlsKG9wZW5pbmdUYWdSZSk7XG5cbiAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgdmFsdWVMZW5ndGggPSB2YWx1ZS5sZW5ndGg7IGkgPCB2YWx1ZUxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgY2hyID0gdmFsdWUuY2hhckF0KGkpO1xuXG4gICAgICAgICAgaWYgKGlzV2hpdGVzcGFjZShjaHIpKSB7XG4gICAgICAgICAgICBzcGFjZXMucHVzaCh0b2tlbnMubGVuZ3RoKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbm9uU3BhY2UgPSB0cnVlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHRva2Vucy5wdXNoKFsgJ3RleHQnLCBjaHIsIHN0YXJ0LCBzdGFydCArIDEgXSk7XG4gICAgICAgICAgc3RhcnQgKz0gMTtcblxuICAgICAgICAgIC8vIENoZWNrIGZvciB3aGl0ZXNwYWNlIG9uIHRoZSBjdXJyZW50IGxpbmUuXG4gICAgICAgICAgaWYgKGNociA9PT0gJ1xcbicpXG4gICAgICAgICAgICBzdHJpcFNwYWNlKCk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gTWF0Y2ggdGhlIG9wZW5pbmcgdGFnLlxuICAgICAgaWYgKCFzY2FubmVyLnNjYW4ob3BlbmluZ1RhZ1JlKSlcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGhhc1RhZyA9IHRydWU7XG5cbiAgICAgIC8vIEdldCB0aGUgdGFnIHR5cGUuXG4gICAgICB0eXBlID0gc2Nhbm5lci5zY2FuKHRhZ1JlKSB8fCAnbmFtZSc7XG4gICAgICBzY2FubmVyLnNjYW4od2hpdGVSZSk7XG5cbiAgICAgIC8vIEdldCB0aGUgdGFnIHZhbHVlLlxuICAgICAgaWYgKHR5cGUgPT09ICc9Jykge1xuICAgICAgICB2YWx1ZSA9IHNjYW5uZXIuc2NhblVudGlsKGVxdWFsc1JlKTtcbiAgICAgICAgc2Nhbm5lci5zY2FuKGVxdWFsc1JlKTtcbiAgICAgICAgc2Nhbm5lci5zY2FuVW50aWwoY2xvc2luZ1RhZ1JlKTtcbiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ3snKSB7XG4gICAgICAgIHZhbHVlID0gc2Nhbm5lci5zY2FuVW50aWwoY2xvc2luZ0N1cmx5UmUpO1xuICAgICAgICBzY2FubmVyLnNjYW4oY3VybHlSZSk7XG4gICAgICAgIHNjYW5uZXIuc2NhblVudGlsKGNsb3NpbmdUYWdSZSk7XG4gICAgICAgIHR5cGUgPSAnJic7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YWx1ZSA9IHNjYW5uZXIuc2NhblVudGlsKGNsb3NpbmdUYWdSZSk7XG4gICAgICB9XG5cbiAgICAgIC8vIE1hdGNoIHRoZSBjbG9zaW5nIHRhZy5cbiAgICAgIGlmICghc2Nhbm5lci5zY2FuKGNsb3NpbmdUYWdSZSkpXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignVW5jbG9zZWQgdGFnIGF0ICcgKyBzY2FubmVyLnBvcyk7XG5cbiAgICAgIHRva2VuID0gWyB0eXBlLCB2YWx1ZSwgc3RhcnQsIHNjYW5uZXIucG9zIF07XG4gICAgICB0b2tlbnMucHVzaCh0b2tlbik7XG5cbiAgICAgIGlmICh0eXBlID09PSAnIycgfHwgdHlwZSA9PT0gJ14nKSB7XG4gICAgICAgIHNlY3Rpb25zLnB1c2godG9rZW4pO1xuICAgICAgfSBlbHNlIGlmICh0eXBlID09PSAnLycpIHtcbiAgICAgICAgLy8gQ2hlY2sgc2VjdGlvbiBuZXN0aW5nLlxuICAgICAgICBvcGVuU2VjdGlvbiA9IHNlY3Rpb25zLnBvcCgpO1xuXG4gICAgICAgIGlmICghb3BlblNlY3Rpb24pXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdVbm9wZW5lZCBzZWN0aW9uIFwiJyArIHZhbHVlICsgJ1wiIGF0ICcgKyBzdGFydCk7XG5cbiAgICAgICAgaWYgKG9wZW5TZWN0aW9uWzFdICE9PSB2YWx1ZSlcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VuY2xvc2VkIHNlY3Rpb24gXCInICsgb3BlblNlY3Rpb25bMV0gKyAnXCIgYXQgJyArIHN0YXJ0KTtcbiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ25hbWUnIHx8IHR5cGUgPT09ICd7JyB8fCB0eXBlID09PSAnJicpIHtcbiAgICAgICAgbm9uU3BhY2UgPSB0cnVlO1xuICAgICAgfSBlbHNlIGlmICh0eXBlID09PSAnPScpIHtcbiAgICAgICAgLy8gU2V0IHRoZSB0YWdzIGZvciB0aGUgbmV4dCB0aW1lIGFyb3VuZC5cbiAgICAgICAgY29tcGlsZVRhZ3ModmFsdWUpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIE1ha2Ugc3VyZSB0aGVyZSBhcmUgbm8gb3BlbiBzZWN0aW9ucyB3aGVuIHdlJ3JlIGRvbmUuXG4gICAgb3BlblNlY3Rpb24gPSBzZWN0aW9ucy5wb3AoKTtcblxuICAgIGlmIChvcGVuU2VjdGlvbilcbiAgICAgIHRocm93IG5ldyBFcnJvcignVW5jbG9zZWQgc2VjdGlvbiBcIicgKyBvcGVuU2VjdGlvblsxXSArICdcIiBhdCAnICsgc2Nhbm5lci5wb3MpO1xuXG4gICAgcmV0dXJuIG5lc3RUb2tlbnMoc3F1YXNoVG9rZW5zKHRva2VucykpO1xuICB9XG5cbiAgLyoqXG4gICAqIENvbWJpbmVzIHRoZSB2YWx1ZXMgb2YgY29uc2VjdXRpdmUgdGV4dCB0b2tlbnMgaW4gdGhlIGdpdmVuIGB0b2tlbnNgIGFycmF5XG4gICAqIHRvIGEgc2luZ2xlIHRva2VuLlxuICAgKi9cbiAgZnVuY3Rpb24gc3F1YXNoVG9rZW5zICh0b2tlbnMpIHtcbiAgICB2YXIgc3F1YXNoZWRUb2tlbnMgPSBbXTtcblxuICAgIHZhciB0b2tlbiwgbGFzdFRva2VuO1xuICAgIGZvciAodmFyIGkgPSAwLCBudW1Ub2tlbnMgPSB0b2tlbnMubGVuZ3RoOyBpIDwgbnVtVG9rZW5zOyArK2kpIHtcbiAgICAgIHRva2VuID0gdG9rZW5zW2ldO1xuXG4gICAgICBpZiAodG9rZW4pIHtcbiAgICAgICAgaWYgKHRva2VuWzBdID09PSAndGV4dCcgJiYgbGFzdFRva2VuICYmIGxhc3RUb2tlblswXSA9PT0gJ3RleHQnKSB7XG4gICAgICAgICAgbGFzdFRva2VuWzFdICs9IHRva2VuWzFdO1xuICAgICAgICAgIGxhc3RUb2tlblszXSA9IHRva2VuWzNdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHNxdWFzaGVkVG9rZW5zLnB1c2godG9rZW4pO1xuICAgICAgICAgIGxhc3RUb2tlbiA9IHRva2VuO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHNxdWFzaGVkVG9rZW5zO1xuICB9XG5cbiAgLyoqXG4gICAqIEZvcm1zIHRoZSBnaXZlbiBhcnJheSBvZiBgdG9rZW5zYCBpbnRvIGEgbmVzdGVkIHRyZWUgc3RydWN0dXJlIHdoZXJlXG4gICAqIHRva2VucyB0aGF0IHJlcHJlc2VudCBhIHNlY3Rpb24gaGF2ZSB0d28gYWRkaXRpb25hbCBpdGVtczogMSkgYW4gYXJyYXkgb2ZcbiAgICogYWxsIHRva2VucyB0aGF0IGFwcGVhciBpbiB0aGF0IHNlY3Rpb24gYW5kIDIpIHRoZSBpbmRleCBpbiB0aGUgb3JpZ2luYWxcbiAgICogdGVtcGxhdGUgdGhhdCByZXByZXNlbnRzIHRoZSBlbmQgb2YgdGhhdCBzZWN0aW9uLlxuICAgKi9cbiAgZnVuY3Rpb24gbmVzdFRva2VucyAodG9rZW5zKSB7XG4gICAgdmFyIG5lc3RlZFRva2VucyA9IFtdO1xuICAgIHZhciBjb2xsZWN0b3IgPSBuZXN0ZWRUb2tlbnM7XG4gICAgdmFyIHNlY3Rpb25zID0gW107XG5cbiAgICB2YXIgdG9rZW4sIHNlY3Rpb247XG4gICAgZm9yICh2YXIgaSA9IDAsIG51bVRva2VucyA9IHRva2Vucy5sZW5ndGg7IGkgPCBudW1Ub2tlbnM7ICsraSkge1xuICAgICAgdG9rZW4gPSB0b2tlbnNbaV07XG5cbiAgICAgIHN3aXRjaCAodG9rZW5bMF0pIHtcbiAgICAgICAgY2FzZSAnIyc6XG4gICAgICAgIGNhc2UgJ14nOlxuICAgICAgICAgIGNvbGxlY3Rvci5wdXNoKHRva2VuKTtcbiAgICAgICAgICBzZWN0aW9ucy5wdXNoKHRva2VuKTtcbiAgICAgICAgICBjb2xsZWN0b3IgPSB0b2tlbls0XSA9IFtdO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICcvJzpcbiAgICAgICAgICBzZWN0aW9uID0gc2VjdGlvbnMucG9wKCk7XG4gICAgICAgICAgc2VjdGlvbls1XSA9IHRva2VuWzJdO1xuICAgICAgICAgIGNvbGxlY3RvciA9IHNlY3Rpb25zLmxlbmd0aCA+IDAgPyBzZWN0aW9uc1tzZWN0aW9ucy5sZW5ndGggLSAxXVs0XSA6IG5lc3RlZFRva2VucztcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICBjb2xsZWN0b3IucHVzaCh0b2tlbik7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIG5lc3RlZFRva2VucztcbiAgfVxuXG4gIC8qKlxuICAgKiBBIHNpbXBsZSBzdHJpbmcgc2Nhbm5lciB0aGF0IGlzIHVzZWQgYnkgdGhlIHRlbXBsYXRlIHBhcnNlciB0byBmaW5kXG4gICAqIHRva2VucyBpbiB0ZW1wbGF0ZSBzdHJpbmdzLlxuICAgKi9cbiAgZnVuY3Rpb24gU2Nhbm5lciAoc3RyaW5nKSB7XG4gICAgdGhpcy5zdHJpbmcgPSBzdHJpbmc7XG4gICAgdGhpcy50YWlsID0gc3RyaW5nO1xuICAgIHRoaXMucG9zID0gMDtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgdGFpbCBpcyBlbXB0eSAoZW5kIG9mIHN0cmluZykuXG4gICAqL1xuICBTY2FubmVyLnByb3RvdHlwZS5lb3MgPSBmdW5jdGlvbiBlb3MgKCkge1xuICAgIHJldHVybiB0aGlzLnRhaWwgPT09ICcnO1xuICB9O1xuXG4gIC8qKlxuICAgKiBUcmllcyB0byBtYXRjaCB0aGUgZ2l2ZW4gcmVndWxhciBleHByZXNzaW9uIGF0IHRoZSBjdXJyZW50IHBvc2l0aW9uLlxuICAgKiBSZXR1cm5zIHRoZSBtYXRjaGVkIHRleHQgaWYgaXQgY2FuIG1hdGNoLCB0aGUgZW1wdHkgc3RyaW5nIG90aGVyd2lzZS5cbiAgICovXG4gIFNjYW5uZXIucHJvdG90eXBlLnNjYW4gPSBmdW5jdGlvbiBzY2FuIChyZSkge1xuICAgIHZhciBtYXRjaCA9IHRoaXMudGFpbC5tYXRjaChyZSk7XG5cbiAgICBpZiAoIW1hdGNoIHx8IG1hdGNoLmluZGV4ICE9PSAwKVxuICAgICAgcmV0dXJuICcnO1xuXG4gICAgdmFyIHN0cmluZyA9IG1hdGNoWzBdO1xuXG4gICAgdGhpcy50YWlsID0gdGhpcy50YWlsLnN1YnN0cmluZyhzdHJpbmcubGVuZ3RoKTtcbiAgICB0aGlzLnBvcyArPSBzdHJpbmcubGVuZ3RoO1xuXG4gICAgcmV0dXJuIHN0cmluZztcbiAgfTtcblxuICAvKipcbiAgICogU2tpcHMgYWxsIHRleHQgdW50aWwgdGhlIGdpdmVuIHJlZ3VsYXIgZXhwcmVzc2lvbiBjYW4gYmUgbWF0Y2hlZC4gUmV0dXJuc1xuICAgKiB0aGUgc2tpcHBlZCBzdHJpbmcsIHdoaWNoIGlzIHRoZSBlbnRpcmUgdGFpbCBpZiBubyBtYXRjaCBjYW4gYmUgbWFkZS5cbiAgICovXG4gIFNjYW5uZXIucHJvdG90eXBlLnNjYW5VbnRpbCA9IGZ1bmN0aW9uIHNjYW5VbnRpbCAocmUpIHtcbiAgICB2YXIgaW5kZXggPSB0aGlzLnRhaWwuc2VhcmNoKHJlKSwgbWF0Y2g7XG5cbiAgICBzd2l0Y2ggKGluZGV4KSB7XG4gICAgICBjYXNlIC0xOlxuICAgICAgICBtYXRjaCA9IHRoaXMudGFpbDtcbiAgICAgICAgdGhpcy50YWlsID0gJyc7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAwOlxuICAgICAgICBtYXRjaCA9ICcnO1xuICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIG1hdGNoID0gdGhpcy50YWlsLnN1YnN0cmluZygwLCBpbmRleCk7XG4gICAgICAgIHRoaXMudGFpbCA9IHRoaXMudGFpbC5zdWJzdHJpbmcoaW5kZXgpO1xuICAgIH1cblxuICAgIHRoaXMucG9zICs9IG1hdGNoLmxlbmd0aDtcblxuICAgIHJldHVybiBtYXRjaDtcbiAgfTtcblxuICAvKipcbiAgICogUmVwcmVzZW50cyBhIHJlbmRlcmluZyBjb250ZXh0IGJ5IHdyYXBwaW5nIGEgdmlldyBvYmplY3QgYW5kXG4gICAqIG1haW50YWluaW5nIGEgcmVmZXJlbmNlIHRvIHRoZSBwYXJlbnQgY29udGV4dC5cbiAgICovXG4gIGZ1bmN0aW9uIENvbnRleHQgKHZpZXcsIHBhcmVudENvbnRleHQpIHtcbiAgICB0aGlzLnZpZXcgPSB2aWV3O1xuICAgIHRoaXMuY2FjaGUgPSB7ICcuJzogdGhpcy52aWV3IH07XG4gICAgdGhpcy5wYXJlbnQgPSBwYXJlbnRDb250ZXh0O1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYSBuZXcgY29udGV4dCB1c2luZyB0aGUgZ2l2ZW4gdmlldyB3aXRoIHRoaXMgY29udGV4dFxuICAgKiBhcyB0aGUgcGFyZW50LlxuICAgKi9cbiAgQ29udGV4dC5wcm90b3R5cGUucHVzaCA9IGZ1bmN0aW9uIHB1c2ggKHZpZXcpIHtcbiAgICByZXR1cm4gbmV3IENvbnRleHQodmlldywgdGhpcyk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIHZhbHVlIG9mIHRoZSBnaXZlbiBuYW1lIGluIHRoaXMgY29udGV4dCwgdHJhdmVyc2luZ1xuICAgKiB1cCB0aGUgY29udGV4dCBoaWVyYXJjaHkgaWYgdGhlIHZhbHVlIGlzIGFic2VudCBpbiB0aGlzIGNvbnRleHQncyB2aWV3LlxuICAgKi9cbiAgQ29udGV4dC5wcm90b3R5cGUubG9va3VwID0gZnVuY3Rpb24gbG9va3VwIChuYW1lKSB7XG4gICAgdmFyIGNhY2hlID0gdGhpcy5jYWNoZTtcblxuICAgIHZhciB2YWx1ZTtcbiAgICBpZiAoY2FjaGUuaGFzT3duUHJvcGVydHkobmFtZSkpIHtcbiAgICAgIHZhbHVlID0gY2FjaGVbbmFtZV07XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciBjb250ZXh0ID0gdGhpcywgbmFtZXMsIGluZGV4LCBsb29rdXBIaXQgPSBmYWxzZTtcblxuICAgICAgd2hpbGUgKGNvbnRleHQpIHtcbiAgICAgICAgaWYgKG5hbWUuaW5kZXhPZignLicpID4gMCkge1xuICAgICAgICAgIHZhbHVlID0gY29udGV4dC52aWV3O1xuICAgICAgICAgIG5hbWVzID0gbmFtZS5zcGxpdCgnLicpO1xuICAgICAgICAgIGluZGV4ID0gMDtcblxuICAgICAgICAgIC8qKlxuICAgICAgICAgICAqIFVzaW5nIHRoZSBkb3Qgbm90aW9uIHBhdGggaW4gYG5hbWVgLCB3ZSBkZXNjZW5kIHRocm91Z2ggdGhlXG4gICAgICAgICAgICogbmVzdGVkIG9iamVjdHMuXG4gICAgICAgICAgICpcbiAgICAgICAgICAgKiBUbyBiZSBjZXJ0YWluIHRoYXQgdGhlIGxvb2t1cCBoYXMgYmVlbiBzdWNjZXNzZnVsLCB3ZSBoYXZlIHRvXG4gICAgICAgICAgICogY2hlY2sgaWYgdGhlIGxhc3Qgb2JqZWN0IGluIHRoZSBwYXRoIGFjdHVhbGx5IGhhcyB0aGUgcHJvcGVydHlcbiAgICAgICAgICAgKiB3ZSBhcmUgbG9va2luZyBmb3IuIFdlIHN0b3JlIHRoZSByZXN1bHQgaW4gYGxvb2t1cEhpdGAuXG4gICAgICAgICAgICpcbiAgICAgICAgICAgKiBUaGlzIGlzIHNwZWNpYWxseSBuZWNlc3NhcnkgZm9yIHdoZW4gdGhlIHZhbHVlIGhhcyBiZWVuIHNldCB0b1xuICAgICAgICAgICAqIGB1bmRlZmluZWRgIGFuZCB3ZSB3YW50IHRvIGF2b2lkIGxvb2tpbmcgdXAgcGFyZW50IGNvbnRleHRzLlxuICAgICAgICAgICAqKi9cbiAgICAgICAgICB3aGlsZSAodmFsdWUgIT0gbnVsbCAmJiBpbmRleCA8IG5hbWVzLmxlbmd0aCkge1xuICAgICAgICAgICAgaWYgKGluZGV4ID09PSBuYW1lcy5sZW5ndGggLSAxKVxuICAgICAgICAgICAgICBsb29rdXBIaXQgPSBoYXNQcm9wZXJ0eSh2YWx1ZSwgbmFtZXNbaW5kZXhdKTtcblxuICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZVtuYW1lc1tpbmRleCsrXV07XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhbHVlID0gY29udGV4dC52aWV3W25hbWVdO1xuICAgICAgICAgIGxvb2t1cEhpdCA9IGhhc1Byb3BlcnR5KGNvbnRleHQudmlldywgbmFtZSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobG9va3VwSGl0KVxuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNvbnRleHQgPSBjb250ZXh0LnBhcmVudDtcbiAgICAgIH1cblxuICAgICAgY2FjaGVbbmFtZV0gPSB2YWx1ZTtcbiAgICB9XG5cbiAgICBpZiAoaXNGdW5jdGlvbih2YWx1ZSkpXG4gICAgICB2YWx1ZSA9IHZhbHVlLmNhbGwodGhpcy52aWV3KTtcblxuICAgIHJldHVybiB2YWx1ZTtcbiAgfTtcblxuICAvKipcbiAgICogQSBXcml0ZXIga25vd3MgaG93IHRvIHRha2UgYSBzdHJlYW0gb2YgdG9rZW5zIGFuZCByZW5kZXIgdGhlbSB0byBhXG4gICAqIHN0cmluZywgZ2l2ZW4gYSBjb250ZXh0LiBJdCBhbHNvIG1haW50YWlucyBhIGNhY2hlIG9mIHRlbXBsYXRlcyB0b1xuICAgKiBhdm9pZCB0aGUgbmVlZCB0byBwYXJzZSB0aGUgc2FtZSB0ZW1wbGF0ZSB0d2ljZS5cbiAgICovXG4gIGZ1bmN0aW9uIFdyaXRlciAoKSB7XG4gICAgdGhpcy5jYWNoZSA9IHt9O1xuICB9XG5cbiAgLyoqXG4gICAqIENsZWFycyBhbGwgY2FjaGVkIHRlbXBsYXRlcyBpbiB0aGlzIHdyaXRlci5cbiAgICovXG4gIFdyaXRlci5wcm90b3R5cGUuY2xlYXJDYWNoZSA9IGZ1bmN0aW9uIGNsZWFyQ2FjaGUgKCkge1xuICAgIHRoaXMuY2FjaGUgPSB7fTtcbiAgfTtcblxuICAvKipcbiAgICogUGFyc2VzIGFuZCBjYWNoZXMgdGhlIGdpdmVuIGB0ZW1wbGF0ZWAgYW5kIHJldHVybnMgdGhlIGFycmF5IG9mIHRva2Vuc1xuICAgKiB0aGF0IGlzIGdlbmVyYXRlZCBmcm9tIHRoZSBwYXJzZS5cbiAgICovXG4gIFdyaXRlci5wcm90b3R5cGUucGFyc2UgPSBmdW5jdGlvbiBwYXJzZSAodGVtcGxhdGUsIHRhZ3MpIHtcbiAgICB2YXIgY2FjaGUgPSB0aGlzLmNhY2hlO1xuICAgIHZhciB0b2tlbnMgPSBjYWNoZVt0ZW1wbGF0ZV07XG5cbiAgICBpZiAodG9rZW5zID09IG51bGwpXG4gICAgICB0b2tlbnMgPSBjYWNoZVt0ZW1wbGF0ZV0gPSBwYXJzZVRlbXBsYXRlKHRlbXBsYXRlLCB0YWdzKTtcblxuICAgIHJldHVybiB0b2tlbnM7XG4gIH07XG5cbiAgLyoqXG4gICAqIEhpZ2gtbGV2ZWwgbWV0aG9kIHRoYXQgaXMgdXNlZCB0byByZW5kZXIgdGhlIGdpdmVuIGB0ZW1wbGF0ZWAgd2l0aFxuICAgKiB0aGUgZ2l2ZW4gYHZpZXdgLlxuICAgKlxuICAgKiBUaGUgb3B0aW9uYWwgYHBhcnRpYWxzYCBhcmd1bWVudCBtYXkgYmUgYW4gb2JqZWN0IHRoYXQgY29udGFpbnMgdGhlXG4gICAqIG5hbWVzIGFuZCB0ZW1wbGF0ZXMgb2YgcGFydGlhbHMgdGhhdCBhcmUgdXNlZCBpbiB0aGUgdGVtcGxhdGUuIEl0IG1heVxuICAgKiBhbHNvIGJlIGEgZnVuY3Rpb24gdGhhdCBpcyB1c2VkIHRvIGxvYWQgcGFydGlhbCB0ZW1wbGF0ZXMgb24gdGhlIGZseVxuICAgKiB0aGF0IHRha2VzIGEgc2luZ2xlIGFyZ3VtZW50OiB0aGUgbmFtZSBvZiB0aGUgcGFydGlhbC5cbiAgICovXG4gIFdyaXRlci5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gcmVuZGVyICh0ZW1wbGF0ZSwgdmlldywgcGFydGlhbHMpIHtcbiAgICB2YXIgdG9rZW5zID0gdGhpcy5wYXJzZSh0ZW1wbGF0ZSk7XG4gICAgdmFyIGNvbnRleHQgPSAodmlldyBpbnN0YW5jZW9mIENvbnRleHQpID8gdmlldyA6IG5ldyBDb250ZXh0KHZpZXcpO1xuICAgIHJldHVybiB0aGlzLnJlbmRlclRva2Vucyh0b2tlbnMsIGNvbnRleHQsIHBhcnRpYWxzLCB0ZW1wbGF0ZSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIExvdy1sZXZlbCBtZXRob2QgdGhhdCByZW5kZXJzIHRoZSBnaXZlbiBhcnJheSBvZiBgdG9rZW5zYCB1c2luZ1xuICAgKiB0aGUgZ2l2ZW4gYGNvbnRleHRgIGFuZCBgcGFydGlhbHNgLlxuICAgKlxuICAgKiBOb3RlOiBUaGUgYG9yaWdpbmFsVGVtcGxhdGVgIGlzIG9ubHkgZXZlciB1c2VkIHRvIGV4dHJhY3QgdGhlIHBvcnRpb25cbiAgICogb2YgdGhlIG9yaWdpbmFsIHRlbXBsYXRlIHRoYXQgd2FzIGNvbnRhaW5lZCBpbiBhIGhpZ2hlci1vcmRlciBzZWN0aW9uLlxuICAgKiBJZiB0aGUgdGVtcGxhdGUgZG9lc24ndCB1c2UgaGlnaGVyLW9yZGVyIHNlY3Rpb25zLCB0aGlzIGFyZ3VtZW50IG1heVxuICAgKiBiZSBvbWl0dGVkLlxuICAgKi9cbiAgV3JpdGVyLnByb3RvdHlwZS5yZW5kZXJUb2tlbnMgPSBmdW5jdGlvbiByZW5kZXJUb2tlbnMgKHRva2VucywgY29udGV4dCwgcGFydGlhbHMsIG9yaWdpbmFsVGVtcGxhdGUpIHtcbiAgICB2YXIgYnVmZmVyID0gJyc7XG5cbiAgICB2YXIgdG9rZW4sIHN5bWJvbCwgdmFsdWU7XG4gICAgZm9yICh2YXIgaSA9IDAsIG51bVRva2VucyA9IHRva2Vucy5sZW5ndGg7IGkgPCBudW1Ub2tlbnM7ICsraSkge1xuICAgICAgdmFsdWUgPSB1bmRlZmluZWQ7XG4gICAgICB0b2tlbiA9IHRva2Vuc1tpXTtcbiAgICAgIHN5bWJvbCA9IHRva2VuWzBdO1xuXG4gICAgICBpZiAoc3ltYm9sID09PSAnIycpIHZhbHVlID0gdGhpcy5yZW5kZXJTZWN0aW9uKHRva2VuLCBjb250ZXh0LCBwYXJ0aWFscywgb3JpZ2luYWxUZW1wbGF0ZSk7XG4gICAgICBlbHNlIGlmIChzeW1ib2wgPT09ICdeJykgdmFsdWUgPSB0aGlzLnJlbmRlckludmVydGVkKHRva2VuLCBjb250ZXh0LCBwYXJ0aWFscywgb3JpZ2luYWxUZW1wbGF0ZSk7XG4gICAgICBlbHNlIGlmIChzeW1ib2wgPT09ICc+JykgdmFsdWUgPSB0aGlzLnJlbmRlclBhcnRpYWwodG9rZW4sIGNvbnRleHQsIHBhcnRpYWxzLCBvcmlnaW5hbFRlbXBsYXRlKTtcbiAgICAgIGVsc2UgaWYgKHN5bWJvbCA9PT0gJyYnKSB2YWx1ZSA9IHRoaXMudW5lc2NhcGVkVmFsdWUodG9rZW4sIGNvbnRleHQpO1xuICAgICAgZWxzZSBpZiAoc3ltYm9sID09PSAnbmFtZScpIHZhbHVlID0gdGhpcy5lc2NhcGVkVmFsdWUodG9rZW4sIGNvbnRleHQpO1xuICAgICAgZWxzZSBpZiAoc3ltYm9sID09PSAndGV4dCcpIHZhbHVlID0gdGhpcy5yYXdWYWx1ZSh0b2tlbik7XG5cbiAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKVxuICAgICAgICBidWZmZXIgKz0gdmFsdWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIGJ1ZmZlcjtcbiAgfTtcblxuICBXcml0ZXIucHJvdG90eXBlLnJlbmRlclNlY3Rpb24gPSBmdW5jdGlvbiByZW5kZXJTZWN0aW9uICh0b2tlbiwgY29udGV4dCwgcGFydGlhbHMsIG9yaWdpbmFsVGVtcGxhdGUpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdmFyIGJ1ZmZlciA9ICcnO1xuICAgIHZhciB2YWx1ZSA9IGNvbnRleHQubG9va3VwKHRva2VuWzFdKTtcblxuICAgIC8vIFRoaXMgZnVuY3Rpb24gaXMgdXNlZCB0byByZW5kZXIgYW4gYXJiaXRyYXJ5IHRlbXBsYXRlXG4gICAgLy8gaW4gdGhlIGN1cnJlbnQgY29udGV4dCBieSBoaWdoZXItb3JkZXIgc2VjdGlvbnMuXG4gICAgZnVuY3Rpb24gc3ViUmVuZGVyICh0ZW1wbGF0ZSkge1xuICAgICAgcmV0dXJuIHNlbGYucmVuZGVyKHRlbXBsYXRlLCBjb250ZXh0LCBwYXJ0aWFscyk7XG4gICAgfVxuXG4gICAgaWYgKCF2YWx1ZSkgcmV0dXJuO1xuXG4gICAgaWYgKGlzQXJyYXkodmFsdWUpKSB7XG4gICAgICBmb3IgKHZhciBqID0gMCwgdmFsdWVMZW5ndGggPSB2YWx1ZS5sZW5ndGg7IGogPCB2YWx1ZUxlbmd0aDsgKytqKSB7XG4gICAgICAgIGJ1ZmZlciArPSB0aGlzLnJlbmRlclRva2Vucyh0b2tlbls0XSwgY29udGV4dC5wdXNoKHZhbHVlW2pdKSwgcGFydGlhbHMsIG9yaWdpbmFsVGVtcGxhdGUpO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyB8fCB0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnIHx8IHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicpIHtcbiAgICAgIGJ1ZmZlciArPSB0aGlzLnJlbmRlclRva2Vucyh0b2tlbls0XSwgY29udGV4dC5wdXNoKHZhbHVlKSwgcGFydGlhbHMsIG9yaWdpbmFsVGVtcGxhdGUpO1xuICAgIH0gZWxzZSBpZiAoaXNGdW5jdGlvbih2YWx1ZSkpIHtcbiAgICAgIGlmICh0eXBlb2Ygb3JpZ2luYWxUZW1wbGF0ZSAhPT0gJ3N0cmluZycpXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IHVzZSBoaWdoZXItb3JkZXIgc2VjdGlvbnMgd2l0aG91dCB0aGUgb3JpZ2luYWwgdGVtcGxhdGUnKTtcblxuICAgICAgLy8gRXh0cmFjdCB0aGUgcG9ydGlvbiBvZiB0aGUgb3JpZ2luYWwgdGVtcGxhdGUgdGhhdCB0aGUgc2VjdGlvbiBjb250YWlucy5cbiAgICAgIHZhbHVlID0gdmFsdWUuY2FsbChjb250ZXh0LnZpZXcsIG9yaWdpbmFsVGVtcGxhdGUuc2xpY2UodG9rZW5bM10sIHRva2VuWzVdKSwgc3ViUmVuZGVyKTtcblxuICAgICAgaWYgKHZhbHVlICE9IG51bGwpXG4gICAgICAgIGJ1ZmZlciArPSB2YWx1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgYnVmZmVyICs9IHRoaXMucmVuZGVyVG9rZW5zKHRva2VuWzRdLCBjb250ZXh0LCBwYXJ0aWFscywgb3JpZ2luYWxUZW1wbGF0ZSk7XG4gICAgfVxuICAgIHJldHVybiBidWZmZXI7XG4gIH07XG5cbiAgV3JpdGVyLnByb3RvdHlwZS5yZW5kZXJJbnZlcnRlZCA9IGZ1bmN0aW9uIHJlbmRlckludmVydGVkICh0b2tlbiwgY29udGV4dCwgcGFydGlhbHMsIG9yaWdpbmFsVGVtcGxhdGUpIHtcbiAgICB2YXIgdmFsdWUgPSBjb250ZXh0Lmxvb2t1cCh0b2tlblsxXSk7XG5cbiAgICAvLyBVc2UgSmF2YVNjcmlwdCdzIGRlZmluaXRpb24gb2YgZmFsc3kuIEluY2x1ZGUgZW1wdHkgYXJyYXlzLlxuICAgIC8vIFNlZSBodHRwczovL2dpdGh1Yi5jb20vamFubC9tdXN0YWNoZS5qcy9pc3N1ZXMvMTg2XG4gICAgaWYgKCF2YWx1ZSB8fCAoaXNBcnJheSh2YWx1ZSkgJiYgdmFsdWUubGVuZ3RoID09PSAwKSlcbiAgICAgIHJldHVybiB0aGlzLnJlbmRlclRva2Vucyh0b2tlbls0XSwgY29udGV4dCwgcGFydGlhbHMsIG9yaWdpbmFsVGVtcGxhdGUpO1xuICB9O1xuXG4gIFdyaXRlci5wcm90b3R5cGUucmVuZGVyUGFydGlhbCA9IGZ1bmN0aW9uIHJlbmRlclBhcnRpYWwgKHRva2VuLCBjb250ZXh0LCBwYXJ0aWFscykge1xuICAgIGlmICghcGFydGlhbHMpIHJldHVybjtcblxuICAgIHZhciB2YWx1ZSA9IGlzRnVuY3Rpb24ocGFydGlhbHMpID8gcGFydGlhbHModG9rZW5bMV0pIDogcGFydGlhbHNbdG9rZW5bMV1dO1xuICAgIGlmICh2YWx1ZSAhPSBudWxsKVxuICAgICAgcmV0dXJuIHRoaXMucmVuZGVyVG9rZW5zKHRoaXMucGFyc2UodmFsdWUpLCBjb250ZXh0LCBwYXJ0aWFscywgdmFsdWUpO1xuICB9O1xuXG4gIFdyaXRlci5wcm90b3R5cGUudW5lc2NhcGVkVmFsdWUgPSBmdW5jdGlvbiB1bmVzY2FwZWRWYWx1ZSAodG9rZW4sIGNvbnRleHQpIHtcbiAgICB2YXIgdmFsdWUgPSBjb250ZXh0Lmxvb2t1cCh0b2tlblsxXSk7XG4gICAgaWYgKHZhbHVlICE9IG51bGwpXG4gICAgICByZXR1cm4gdmFsdWU7XG4gIH07XG5cbiAgV3JpdGVyLnByb3RvdHlwZS5lc2NhcGVkVmFsdWUgPSBmdW5jdGlvbiBlc2NhcGVkVmFsdWUgKHRva2VuLCBjb250ZXh0KSB7XG4gICAgdmFyIHZhbHVlID0gY29udGV4dC5sb29rdXAodG9rZW5bMV0pO1xuICAgIGlmICh2YWx1ZSAhPSBudWxsKVxuICAgICAgcmV0dXJuIG11c3RhY2hlLmVzY2FwZSh2YWx1ZSk7XG4gIH07XG5cbiAgV3JpdGVyLnByb3RvdHlwZS5yYXdWYWx1ZSA9IGZ1bmN0aW9uIHJhd1ZhbHVlICh0b2tlbikge1xuICAgIHJldHVybiB0b2tlblsxXTtcbiAgfTtcblxuICBtdXN0YWNoZS5uYW1lID0gJ211c3RhY2hlLmpzJztcbiAgbXVzdGFjaGUudmVyc2lvbiA9ICcyLjIuMSc7XG4gIG11c3RhY2hlLnRhZ3MgPSBbICd7eycsICd9fScgXTtcblxuICAvLyBBbGwgaGlnaC1sZXZlbCBtdXN0YWNoZS4qIGZ1bmN0aW9ucyB1c2UgdGhpcyB3cml0ZXIuXG4gIHZhciBkZWZhdWx0V3JpdGVyID0gbmV3IFdyaXRlcigpO1xuXG4gIC8qKlxuICAgKiBDbGVhcnMgYWxsIGNhY2hlZCB0ZW1wbGF0ZXMgaW4gdGhlIGRlZmF1bHQgd3JpdGVyLlxuICAgKi9cbiAgbXVzdGFjaGUuY2xlYXJDYWNoZSA9IGZ1bmN0aW9uIGNsZWFyQ2FjaGUgKCkge1xuICAgIHJldHVybiBkZWZhdWx0V3JpdGVyLmNsZWFyQ2FjaGUoKTtcbiAgfTtcblxuICAvKipcbiAgICogUGFyc2VzIGFuZCBjYWNoZXMgdGhlIGdpdmVuIHRlbXBsYXRlIGluIHRoZSBkZWZhdWx0IHdyaXRlciBhbmQgcmV0dXJucyB0aGVcbiAgICogYXJyYXkgb2YgdG9rZW5zIGl0IGNvbnRhaW5zLiBEb2luZyB0aGlzIGFoZWFkIG9mIHRpbWUgYXZvaWRzIHRoZSBuZWVkIHRvXG4gICAqIHBhcnNlIHRlbXBsYXRlcyBvbiB0aGUgZmx5IGFzIHRoZXkgYXJlIHJlbmRlcmVkLlxuICAgKi9cbiAgbXVzdGFjaGUucGFyc2UgPSBmdW5jdGlvbiBwYXJzZSAodGVtcGxhdGUsIHRhZ3MpIHtcbiAgICByZXR1cm4gZGVmYXVsdFdyaXRlci5wYXJzZSh0ZW1wbGF0ZSwgdGFncyk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFJlbmRlcnMgdGhlIGB0ZW1wbGF0ZWAgd2l0aCB0aGUgZ2l2ZW4gYHZpZXdgIGFuZCBgcGFydGlhbHNgIHVzaW5nIHRoZVxuICAgKiBkZWZhdWx0IHdyaXRlci5cbiAgICovXG4gIG11c3RhY2hlLnJlbmRlciA9IGZ1bmN0aW9uIHJlbmRlciAodGVtcGxhdGUsIHZpZXcsIHBhcnRpYWxzKSB7XG4gICAgaWYgKHR5cGVvZiB0ZW1wbGF0ZSAhPT0gJ3N0cmluZycpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgdGVtcGxhdGUhIFRlbXBsYXRlIHNob3VsZCBiZSBhIFwic3RyaW5nXCIgJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICdidXQgXCInICsgdHlwZVN0cih0ZW1wbGF0ZSkgKyAnXCIgd2FzIGdpdmVuIGFzIHRoZSBmaXJzdCAnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgJ2FyZ3VtZW50IGZvciBtdXN0YWNoZSNyZW5kZXIodGVtcGxhdGUsIHZpZXcsIHBhcnRpYWxzKScpO1xuICAgIH1cblxuICAgIHJldHVybiBkZWZhdWx0V3JpdGVyLnJlbmRlcih0ZW1wbGF0ZSwgdmlldywgcGFydGlhbHMpO1xuICB9O1xuXG4gIC8vIFRoaXMgaXMgaGVyZSBmb3IgYmFja3dhcmRzIGNvbXBhdGliaWxpdHkgd2l0aCAwLjQueC4sXG4gIC8qZXNsaW50LWRpc2FibGUgKi8gLy8gZXNsaW50IHdhbnRzIGNhbWVsIGNhc2VkIGZ1bmN0aW9uIG5hbWVcbiAgbXVzdGFjaGUudG9faHRtbCA9IGZ1bmN0aW9uIHRvX2h0bWwgKHRlbXBsYXRlLCB2aWV3LCBwYXJ0aWFscywgc2VuZCkge1xuICAgIC8qZXNsaW50LWVuYWJsZSovXG5cbiAgICB2YXIgcmVzdWx0ID0gbXVzdGFjaGUucmVuZGVyKHRlbXBsYXRlLCB2aWV3LCBwYXJ0aWFscyk7XG5cbiAgICBpZiAoaXNGdW5jdGlvbihzZW5kKSkge1xuICAgICAgc2VuZChyZXN1bHQpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgfTtcblxuICAvLyBFeHBvcnQgdGhlIGVzY2FwaW5nIGZ1bmN0aW9uIHNvIHRoYXQgdGhlIHVzZXIgbWF5IG92ZXJyaWRlIGl0LlxuICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2phbmwvbXVzdGFjaGUuanMvaXNzdWVzLzI0NFxuICBtdXN0YWNoZS5lc2NhcGUgPSBlc2NhcGVIdG1sO1xuXG4gIC8vIEV4cG9ydCB0aGVzZSBtYWlubHkgZm9yIHRlc3RpbmcsIGJ1dCBhbHNvIGZvciBhZHZhbmNlZCB1c2FnZS5cbiAgbXVzdGFjaGUuU2Nhbm5lciA9IFNjYW5uZXI7XG4gIG11c3RhY2hlLkNvbnRleHQgPSBDb250ZXh0O1xuICBtdXN0YWNoZS5Xcml0ZXIgPSBXcml0ZXI7XG5cbn0pKTtcbiIsIi8qIVxuICogWmVyb0NsaXBib2FyZFxuICogVGhlIFplcm9DbGlwYm9hcmQgbGlicmFyeSBwcm92aWRlcyBhbiBlYXN5IHdheSB0byBjb3B5IHRleHQgdG8gdGhlIGNsaXBib2FyZCB1c2luZyBhbiBpbnZpc2libGUgQWRvYmUgRmxhc2ggbW92aWUgYW5kIGEgSmF2YVNjcmlwdCBpbnRlcmZhY2UuXG4gKiBDb3B5cmlnaHQgKGMpIDIwMDktMjAxNCBKb24gUm9oYW4sIEphbWVzIE0uIEdyZWVuZVxuICogTGljZW5zZWQgTUlUXG4gKiBodHRwOi8vemVyb2NsaXBib2FyZC5vcmcvXG4gKiB2Mi4yLjBcbiAqL1xuKGZ1bmN0aW9uKHdpbmRvdywgdW5kZWZpbmVkKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuICAvKipcbiAqIFN0b3JlIHJlZmVyZW5jZXMgdG8gY3JpdGljYWxseSBpbXBvcnRhbnQgZ2xvYmFsIGZ1bmN0aW9ucyB0aGF0IG1heSBiZVxuICogb3ZlcnJpZGRlbiBvbiBjZXJ0YWluIHdlYiBwYWdlcy5cbiAqL1xuICB2YXIgX3dpbmRvdyA9IHdpbmRvdywgX2RvY3VtZW50ID0gX3dpbmRvdy5kb2N1bWVudCwgX25hdmlnYXRvciA9IF93aW5kb3cubmF2aWdhdG9yLCBfc2V0VGltZW91dCA9IF93aW5kb3cuc2V0VGltZW91dCwgX2NsZWFyVGltZW91dCA9IF93aW5kb3cuY2xlYXJUaW1lb3V0LCBfc2V0SW50ZXJ2YWwgPSBfd2luZG93LnNldEludGVydmFsLCBfY2xlYXJJbnRlcnZhbCA9IF93aW5kb3cuY2xlYXJJbnRlcnZhbCwgX2dldENvbXB1dGVkU3R5bGUgPSBfd2luZG93LmdldENvbXB1dGVkU3R5bGUsIF9lbmNvZGVVUklDb21wb25lbnQgPSBfd2luZG93LmVuY29kZVVSSUNvbXBvbmVudCwgX0FjdGl2ZVhPYmplY3QgPSBfd2luZG93LkFjdGl2ZVhPYmplY3QsIF9FcnJvciA9IF93aW5kb3cuRXJyb3IsIF9wYXJzZUludCA9IF93aW5kb3cuTnVtYmVyLnBhcnNlSW50IHx8IF93aW5kb3cucGFyc2VJbnQsIF9wYXJzZUZsb2F0ID0gX3dpbmRvdy5OdW1iZXIucGFyc2VGbG9hdCB8fCBfd2luZG93LnBhcnNlRmxvYXQsIF9pc05hTiA9IF93aW5kb3cuTnVtYmVyLmlzTmFOIHx8IF93aW5kb3cuaXNOYU4sIF9ub3cgPSBfd2luZG93LkRhdGUubm93LCBfa2V5cyA9IF93aW5kb3cuT2JqZWN0LmtleXMsIF9kZWZpbmVQcm9wZXJ0eSA9IF93aW5kb3cuT2JqZWN0LmRlZmluZVByb3BlcnR5LCBfaGFzT3duID0gX3dpbmRvdy5PYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LCBfc2xpY2UgPSBfd2luZG93LkFycmF5LnByb3RvdHlwZS5zbGljZSwgX3Vud3JhcCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciB1bndyYXBwZXIgPSBmdW5jdGlvbihlbCkge1xuICAgICAgcmV0dXJuIGVsO1xuICAgIH07XG4gICAgaWYgKHR5cGVvZiBfd2luZG93LndyYXAgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgX3dpbmRvdy51bndyYXAgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgdHJ5IHtcbiAgICAgICAgdmFyIGRpdiA9IF9kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICB2YXIgdW53cmFwcGVkRGl2ID0gX3dpbmRvdy51bndyYXAoZGl2KTtcbiAgICAgICAgaWYgKGRpdi5ub2RlVHlwZSA9PT0gMSAmJiB1bndyYXBwZWREaXYgJiYgdW53cmFwcGVkRGl2Lm5vZGVUeXBlID09PSAxKSB7XG4gICAgICAgICAgdW53cmFwcGVyID0gX3dpbmRvdy51bndyYXA7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGUpIHt9XG4gICAgfVxuICAgIHJldHVybiB1bndyYXBwZXI7XG4gIH0oKTtcbiAgLyoqXG4gKiBDb252ZXJ0IGFuIGBhcmd1bWVudHNgIG9iamVjdCBpbnRvIGFuIEFycmF5LlxuICpcbiAqIEByZXR1cm5zIFRoZSBhcmd1bWVudHMgYXMgYW4gQXJyYXlcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9hcmdzID0gZnVuY3Rpb24oYXJndW1lbnRzT2JqKSB7XG4gICAgcmV0dXJuIF9zbGljZS5jYWxsKGFyZ3VtZW50c09iaiwgMCk7XG4gIH07XG4gIC8qKlxuICogU2hhbGxvdy1jb3B5IHRoZSBvd25lZCwgZW51bWVyYWJsZSBwcm9wZXJ0aWVzIG9mIG9uZSBvYmplY3Qgb3ZlciB0byBhbm90aGVyLCBzaW1pbGFyIHRvIGpRdWVyeSdzIGAkLmV4dGVuZGAuXG4gKlxuICogQHJldHVybnMgVGhlIHRhcmdldCBvYmplY3QsIGF1Z21lbnRlZFxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2V4dGVuZCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBpLCBsZW4sIGFyZywgcHJvcCwgc3JjLCBjb3B5LCBhcmdzID0gX2FyZ3MoYXJndW1lbnRzKSwgdGFyZ2V0ID0gYXJnc1swXSB8fCB7fTtcbiAgICBmb3IgKGkgPSAxLCBsZW4gPSBhcmdzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICBpZiAoKGFyZyA9IGFyZ3NbaV0pICE9IG51bGwpIHtcbiAgICAgICAgZm9yIChwcm9wIGluIGFyZykge1xuICAgICAgICAgIGlmIChfaGFzT3duLmNhbGwoYXJnLCBwcm9wKSkge1xuICAgICAgICAgICAgc3JjID0gdGFyZ2V0W3Byb3BdO1xuICAgICAgICAgICAgY29weSA9IGFyZ1twcm9wXTtcbiAgICAgICAgICAgIGlmICh0YXJnZXQgIT09IGNvcHkgJiYgY29weSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgIHRhcmdldFtwcm9wXSA9IGNvcHk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0YXJnZXQ7XG4gIH07XG4gIC8qKlxuICogUmV0dXJuIGEgZGVlcCBjb3B5IG9mIHRoZSBzb3VyY2Ugb2JqZWN0IG9yIGFycmF5LlxuICpcbiAqIEByZXR1cm5zIE9iamVjdCBvciBBcnJheVxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2RlZXBDb3B5ID0gZnVuY3Rpb24oc291cmNlKSB7XG4gICAgdmFyIGNvcHksIGksIGxlbiwgcHJvcDtcbiAgICBpZiAodHlwZW9mIHNvdXJjZSAhPT0gXCJvYmplY3RcIiB8fCBzb3VyY2UgPT0gbnVsbCB8fCB0eXBlb2Ygc291cmNlLm5vZGVUeXBlID09PSBcIm51bWJlclwiKSB7XG4gICAgICBjb3B5ID0gc291cmNlO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIHNvdXJjZS5sZW5ndGggPT09IFwibnVtYmVyXCIpIHtcbiAgICAgIGNvcHkgPSBbXTtcbiAgICAgIGZvciAoaSA9IDAsIGxlbiA9IHNvdXJjZS5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBpZiAoX2hhc093bi5jYWxsKHNvdXJjZSwgaSkpIHtcbiAgICAgICAgICBjb3B5W2ldID0gX2RlZXBDb3B5KHNvdXJjZVtpXSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgY29weSA9IHt9O1xuICAgICAgZm9yIChwcm9wIGluIHNvdXJjZSkge1xuICAgICAgICBpZiAoX2hhc093bi5jYWxsKHNvdXJjZSwgcHJvcCkpIHtcbiAgICAgICAgICBjb3B5W3Byb3BdID0gX2RlZXBDb3B5KHNvdXJjZVtwcm9wXSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGNvcHk7XG4gIH07XG4gIC8qKlxuICogTWFrZXMgYSBzaGFsbG93IGNvcHkgb2YgYG9iamAgKGxpa2UgYF9leHRlbmRgKSBidXQgZmlsdGVycyBpdHMgcHJvcGVydGllcyBiYXNlZCBvbiBhIGxpc3Qgb2YgYGtleXNgIHRvIGtlZXAuXG4gKiBUaGUgaW52ZXJzZSBvZiBgX29taXRgLCBtb3N0bHkuIFRoZSBiaWcgZGlmZmVyZW5jZSBpcyB0aGF0IHRoZXNlIHByb3BlcnRpZXMgZG8gTk9UIG5lZWQgdG8gYmUgZW51bWVyYWJsZSB0b1xuICogYmUga2VwdC5cbiAqXG4gKiBAcmV0dXJucyBBIG5ldyBmaWx0ZXJlZCBvYmplY3QuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfcGljayA9IGZ1bmN0aW9uKG9iaiwga2V5cykge1xuICAgIHZhciBuZXdPYmogPSB7fTtcbiAgICBmb3IgKHZhciBpID0gMCwgbGVuID0ga2V5cy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgaWYgKGtleXNbaV0gaW4gb2JqKSB7XG4gICAgICAgIG5ld09ialtrZXlzW2ldXSA9IG9ialtrZXlzW2ldXTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG5ld09iajtcbiAgfTtcbiAgLyoqXG4gKiBNYWtlcyBhIHNoYWxsb3cgY29weSBvZiBgb2JqYCAobGlrZSBgX2V4dGVuZGApIGJ1dCBmaWx0ZXJzIGl0cyBwcm9wZXJ0aWVzIGJhc2VkIG9uIGEgbGlzdCBvZiBga2V5c2AgdG8gb21pdC5cbiAqIFRoZSBpbnZlcnNlIG9mIGBfcGlja2AuXG4gKlxuICogQHJldHVybnMgQSBuZXcgZmlsdGVyZWQgb2JqZWN0LlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX29taXQgPSBmdW5jdGlvbihvYmosIGtleXMpIHtcbiAgICB2YXIgbmV3T2JqID0ge307XG4gICAgZm9yICh2YXIgcHJvcCBpbiBvYmopIHtcbiAgICAgIGlmIChrZXlzLmluZGV4T2YocHJvcCkgPT09IC0xKSB7XG4gICAgICAgIG5ld09ialtwcm9wXSA9IG9ialtwcm9wXTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG5ld09iajtcbiAgfTtcbiAgLyoqXG4gKiBSZW1vdmUgYWxsIG93bmVkLCBlbnVtZXJhYmxlIHByb3BlcnRpZXMgZnJvbSBhbiBvYmplY3QuXG4gKlxuICogQHJldHVybnMgVGhlIG9yaWdpbmFsIG9iamVjdCB3aXRob3V0IGl0cyBvd25lZCwgZW51bWVyYWJsZSBwcm9wZXJ0aWVzLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2RlbGV0ZU93blByb3BlcnRpZXMgPSBmdW5jdGlvbihvYmopIHtcbiAgICBpZiAob2JqKSB7XG4gICAgICBmb3IgKHZhciBwcm9wIGluIG9iaikge1xuICAgICAgICBpZiAoX2hhc093bi5jYWxsKG9iaiwgcHJvcCkpIHtcbiAgICAgICAgICBkZWxldGUgb2JqW3Byb3BdO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBvYmo7XG4gIH07XG4gIC8qKlxuICogRGV0ZXJtaW5lIGlmIGFuIGVsZW1lbnQgaXMgY29udGFpbmVkIHdpdGhpbiBhbm90aGVyIGVsZW1lbnQuXG4gKlxuICogQHJldHVybnMgQm9vbGVhblxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2NvbnRhaW5lZEJ5ID0gZnVuY3Rpb24oZWwsIGFuY2VzdG9yRWwpIHtcbiAgICBpZiAoZWwgJiYgZWwubm9kZVR5cGUgPT09IDEgJiYgZWwub3duZXJEb2N1bWVudCAmJiBhbmNlc3RvckVsICYmIChhbmNlc3RvckVsLm5vZGVUeXBlID09PSAxICYmIGFuY2VzdG9yRWwub3duZXJEb2N1bWVudCAmJiBhbmNlc3RvckVsLm93bmVyRG9jdW1lbnQgPT09IGVsLm93bmVyRG9jdW1lbnQgfHwgYW5jZXN0b3JFbC5ub2RlVHlwZSA9PT0gOSAmJiAhYW5jZXN0b3JFbC5vd25lckRvY3VtZW50ICYmIGFuY2VzdG9yRWwgPT09IGVsLm93bmVyRG9jdW1lbnQpKSB7XG4gICAgICBkbyB7XG4gICAgICAgIGlmIChlbCA9PT0gYW5jZXN0b3JFbCkge1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsID0gZWwucGFyZW50Tm9kZTtcbiAgICAgIH0gd2hpbGUgKGVsKTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuICAvKipcbiAqIEdldCB0aGUgVVJMIHBhdGgncyBwYXJlbnQgZGlyZWN0b3J5LlxuICpcbiAqIEByZXR1cm5zIFN0cmluZyBvciBgdW5kZWZpbmVkYFxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2dldERpclBhdGhPZlVybCA9IGZ1bmN0aW9uKHVybCkge1xuICAgIHZhciBkaXI7XG4gICAgaWYgKHR5cGVvZiB1cmwgPT09IFwic3RyaW5nXCIgJiYgdXJsKSB7XG4gICAgICBkaXIgPSB1cmwuc3BsaXQoXCIjXCIpWzBdLnNwbGl0KFwiP1wiKVswXTtcbiAgICAgIGRpciA9IHVybC5zbGljZSgwLCB1cmwubGFzdEluZGV4T2YoXCIvXCIpICsgMSk7XG4gICAgfVxuICAgIHJldHVybiBkaXI7XG4gIH07XG4gIC8qKlxuICogR2V0IHRoZSBjdXJyZW50IHNjcmlwdCdzIFVSTCBieSB0aHJvd2luZyBhbiBgRXJyb3JgIGFuZCBhbmFseXppbmcgaXQuXG4gKlxuICogQHJldHVybnMgU3RyaW5nIG9yIGB1bmRlZmluZWRgXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZ2V0Q3VycmVudFNjcmlwdFVybEZyb21FcnJvclN0YWNrID0gZnVuY3Rpb24oc3RhY2spIHtcbiAgICB2YXIgdXJsLCBtYXRjaGVzO1xuICAgIGlmICh0eXBlb2Ygc3RhY2sgPT09IFwic3RyaW5nXCIgJiYgc3RhY2spIHtcbiAgICAgIG1hdGNoZXMgPSBzdGFjay5tYXRjaCgvXig/OnxbXjpAXSpAfC4rXFwpQCg/PWh0dHBbc10/fGZpbGUpfC4rP1xccysoPzogYXQgfEApKD86W146XFwoXSsgKSpbXFwoXT8pKCg/Omh0dHBbc10/fGZpbGUpOlxcL1xcL1tcXC9dPy4rP1xcL1teOlxcKV0qPykoPzo6XFxkKykoPzo6XFxkKyk/Lyk7XG4gICAgICBpZiAobWF0Y2hlcyAmJiBtYXRjaGVzWzFdKSB7XG4gICAgICAgIHVybCA9IG1hdGNoZXNbMV07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBtYXRjaGVzID0gc3RhY2subWF0Y2goL1xcKUAoKD86aHR0cFtzXT98ZmlsZSk6XFwvXFwvW1xcL10/Lis/XFwvW146XFwpXSo/KSg/OjpcXGQrKSg/OjpcXGQrKT8vKTtcbiAgICAgICAgaWYgKG1hdGNoZXMgJiYgbWF0Y2hlc1sxXSkge1xuICAgICAgICAgIHVybCA9IG1hdGNoZXNbMV07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHVybDtcbiAgfTtcbiAgLyoqXG4gKiBHZXQgdGhlIGN1cnJlbnQgc2NyaXB0J3MgVVJMIGJ5IHRocm93aW5nIGFuIGBFcnJvcmAgYW5kIGFuYWx5emluZyBpdC5cbiAqXG4gKiBAcmV0dXJucyBTdHJpbmcgb3IgYHVuZGVmaW5lZGBcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9nZXRDdXJyZW50U2NyaXB0VXJsRnJvbUVycm9yID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHVybCwgZXJyO1xuICAgIHRyeSB7XG4gICAgICB0aHJvdyBuZXcgX0Vycm9yKCk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgZXJyID0gZTtcbiAgICB9XG4gICAgaWYgKGVycikge1xuICAgICAgdXJsID0gZXJyLnNvdXJjZVVSTCB8fCBlcnIuZmlsZU5hbWUgfHwgX2dldEN1cnJlbnRTY3JpcHRVcmxGcm9tRXJyb3JTdGFjayhlcnIuc3RhY2spO1xuICAgIH1cbiAgICByZXR1cm4gdXJsO1xuICB9O1xuICAvKipcbiAqIEdldCB0aGUgY3VycmVudCBzY3JpcHQncyBVUkwuXG4gKlxuICogQHJldHVybnMgU3RyaW5nIG9yIGB1bmRlZmluZWRgXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZ2V0Q3VycmVudFNjcmlwdFVybCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBqc1BhdGgsIHNjcmlwdHMsIGk7XG4gICAgaWYgKF9kb2N1bWVudC5jdXJyZW50U2NyaXB0ICYmIChqc1BhdGggPSBfZG9jdW1lbnQuY3VycmVudFNjcmlwdC5zcmMpKSB7XG4gICAgICByZXR1cm4ganNQYXRoO1xuICAgIH1cbiAgICBzY3JpcHRzID0gX2RvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwic2NyaXB0XCIpO1xuICAgIGlmIChzY3JpcHRzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgcmV0dXJuIHNjcmlwdHNbMF0uc3JjIHx8IHVuZGVmaW5lZDtcbiAgICB9XG4gICAgaWYgKFwicmVhZHlTdGF0ZVwiIGluIHNjcmlwdHNbMF0pIHtcbiAgICAgIGZvciAoaSA9IHNjcmlwdHMubGVuZ3RoOyBpLS07ICkge1xuICAgICAgICBpZiAoc2NyaXB0c1tpXS5yZWFkeVN0YXRlID09PSBcImludGVyYWN0aXZlXCIgJiYgKGpzUGF0aCA9IHNjcmlwdHNbaV0uc3JjKSkge1xuICAgICAgICAgIHJldHVybiBqc1BhdGg7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKF9kb2N1bWVudC5yZWFkeVN0YXRlID09PSBcImxvYWRpbmdcIiAmJiAoanNQYXRoID0gc2NyaXB0c1tzY3JpcHRzLmxlbmd0aCAtIDFdLnNyYykpIHtcbiAgICAgIHJldHVybiBqc1BhdGg7XG4gICAgfVxuICAgIGlmIChqc1BhdGggPSBfZ2V0Q3VycmVudFNjcmlwdFVybEZyb21FcnJvcigpKSB7XG4gICAgICByZXR1cm4ganNQYXRoO1xuICAgIH1cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9O1xuICAvKipcbiAqIEdldCB0aGUgdW5hbmltb3VzIHBhcmVudCBkaXJlY3Rvcnkgb2YgQUxMIHNjcmlwdCB0YWdzLlxuICogSWYgYW55IHNjcmlwdCB0YWdzIGFyZSBlaXRoZXIgKGEpIGlubGluZSBvciAoYikgZnJvbSBkaWZmZXJpbmcgcGFyZW50XG4gKiBkaXJlY3RvcmllcywgdGhpcyBtZXRob2QgbXVzdCByZXR1cm4gYHVuZGVmaW5lZGAuXG4gKlxuICogQHJldHVybnMgU3RyaW5nIG9yIGB1bmRlZmluZWRgXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZ2V0VW5hbmltb3VzU2NyaXB0UGFyZW50RGlyID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGksIGpzRGlyLCBqc1BhdGgsIHNjcmlwdHMgPSBfZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzY3JpcHRcIik7XG4gICAgZm9yIChpID0gc2NyaXB0cy5sZW5ndGg7IGktLTsgKSB7XG4gICAgICBpZiAoIShqc1BhdGggPSBzY3JpcHRzW2ldLnNyYykpIHtcbiAgICAgICAganNEaXIgPSBudWxsO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGpzUGF0aCA9IF9nZXREaXJQYXRoT2ZVcmwoanNQYXRoKTtcbiAgICAgIGlmIChqc0RpciA9PSBudWxsKSB7XG4gICAgICAgIGpzRGlyID0ganNQYXRoO1xuICAgICAgfSBlbHNlIGlmIChqc0RpciAhPT0ganNQYXRoKSB7XG4gICAgICAgIGpzRGlyID0gbnVsbDtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBqc0RpciB8fCB1bmRlZmluZWQ7XG4gIH07XG4gIC8qKlxuICogR2V0IHRoZSBwcmVzdW1lZCBsb2NhdGlvbiBvZiB0aGUgXCJaZXJvQ2xpcGJvYXJkLnN3ZlwiIGZpbGUsIGJhc2VkIG9uIHRoZSBsb2NhdGlvblxuICogb2YgdGhlIGV4ZWN1dGluZyBKYXZhU2NyaXB0IGZpbGUgKGUuZy4gXCJaZXJvQ2xpcGJvYXJkLmpzXCIsIGV0Yy4pLlxuICpcbiAqIEByZXR1cm5zIFN0cmluZ1xuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2dldERlZmF1bHRTd2ZQYXRoID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGpzRGlyID0gX2dldERpclBhdGhPZlVybChfZ2V0Q3VycmVudFNjcmlwdFVybCgpKSB8fCBfZ2V0VW5hbmltb3VzU2NyaXB0UGFyZW50RGlyKCkgfHwgXCJcIjtcbiAgICByZXR1cm4ganNEaXIgKyBcIlplcm9DbGlwYm9hcmQuc3dmXCI7XG4gIH07XG4gIC8qKlxuICogS2VlcCB0cmFjayBvZiBpZiB0aGUgcGFnZSBpcyBmcmFtZWQgKGluIGFuIGBpZnJhbWVgKS4gVGhpcyBjYW4gbmV2ZXIgY2hhbmdlLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX3BhZ2VJc0ZyYW1lZCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB3aW5kb3cub3BlbmVyID09IG51bGwgJiYgKCEhd2luZG93LnRvcCAmJiB3aW5kb3cgIT0gd2luZG93LnRvcCB8fCAhIXdpbmRvdy5wYXJlbnQgJiYgd2luZG93ICE9IHdpbmRvdy5wYXJlbnQpO1xuICB9KCk7XG4gIC8qKlxuICogS2VlcCB0cmFjayBvZiB0aGUgc3RhdGUgb2YgdGhlIEZsYXNoIG9iamVjdC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9mbGFzaFN0YXRlID0ge1xuICAgIGJyaWRnZTogbnVsbCxcbiAgICB2ZXJzaW9uOiBcIjAuMC4wXCIsXG4gICAgcGx1Z2luVHlwZTogXCJ1bmtub3duXCIsXG4gICAgZGlzYWJsZWQ6IG51bGwsXG4gICAgb3V0ZGF0ZWQ6IG51bGwsXG4gICAgc2FuZGJveGVkOiBudWxsLFxuICAgIHVuYXZhaWxhYmxlOiBudWxsLFxuICAgIGRlZ3JhZGVkOiBudWxsLFxuICAgIGRlYWN0aXZhdGVkOiBudWxsLFxuICAgIG92ZXJkdWU6IG51bGwsXG4gICAgcmVhZHk6IG51bGxcbiAgfTtcbiAgLyoqXG4gKiBUaGUgbWluaW11bSBGbGFzaCBQbGF5ZXIgdmVyc2lvbiByZXF1aXJlZCB0byB1c2UgWmVyb0NsaXBib2FyZCBjb21wbGV0ZWx5LlxuICogQHJlYWRvbmx5XG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfbWluaW11bUZsYXNoVmVyc2lvbiA9IFwiMTEuMC4wXCI7XG4gIC8qKlxuICogVGhlIFplcm9DbGlwYm9hcmQgbGlicmFyeSB2ZXJzaW9uIG51bWJlciwgYXMgcmVwb3J0ZWQgYnkgRmxhc2gsIGF0IHRoZSB0aW1lIHRoZSBTV0Ygd2FzIGNvbXBpbGVkLlxuICovXG4gIHZhciBfemNTd2ZWZXJzaW9uO1xuICAvKipcbiAqIEtlZXAgdHJhY2sgb2YgYWxsIGV2ZW50IGxpc3RlbmVyIHJlZ2lzdHJhdGlvbnMuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfaGFuZGxlcnMgPSB7fTtcbiAgLyoqXG4gKiBLZWVwIHRyYWNrIG9mIHRoZSBjdXJyZW50bHkgYWN0aXZhdGVkIGVsZW1lbnQuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY3VycmVudEVsZW1lbnQ7XG4gIC8qKlxuICogS2VlcCB0cmFjayBvZiB0aGUgZWxlbWVudCB0aGF0IHdhcyBhY3RpdmF0ZWQgd2hlbiBhIGBjb3B5YCBwcm9jZXNzIHN0YXJ0ZWQuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY29weVRhcmdldDtcbiAgLyoqXG4gKiBLZWVwIHRyYWNrIG9mIGRhdGEgZm9yIHRoZSBwZW5kaW5nIGNsaXBib2FyZCB0cmFuc2FjdGlvbi5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9jbGlwRGF0YSA9IHt9O1xuICAvKipcbiAqIEtlZXAgdHJhY2sgb2YgZGF0YSBmb3JtYXRzIGZvciB0aGUgcGVuZGluZyBjbGlwYm9hcmQgdHJhbnNhY3Rpb24uXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY2xpcERhdGFGb3JtYXRNYXAgPSBudWxsO1xuICAvKipcbiAqIEtlZXAgdHJhY2sgb2YgdGhlIEZsYXNoIGF2YWlsYWJpbGl0eSBjaGVjayB0aW1lb3V0LlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2ZsYXNoQ2hlY2tUaW1lb3V0ID0gMDtcbiAgLyoqXG4gKiBLZWVwIHRyYWNrIG9mIFNXRiBuZXR3b3JrIGVycm9ycyBpbnRlcnZhbCBwb2xsaW5nLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX3N3ZkZhbGxiYWNrQ2hlY2tJbnRlcnZhbCA9IDA7XG4gIC8qKlxuICogVGhlIGBtZXNzYWdlYCBzdG9yZSBmb3IgZXZlbnRzXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZXZlbnRNZXNzYWdlcyA9IHtcbiAgICByZWFkeTogXCJGbGFzaCBjb21tdW5pY2F0aW9uIGlzIGVzdGFibGlzaGVkXCIsXG4gICAgZXJyb3I6IHtcbiAgICAgIFwiZmxhc2gtZGlzYWJsZWRcIjogXCJGbGFzaCBpcyBkaXNhYmxlZCBvciBub3QgaW5zdGFsbGVkLiBNYXkgYWxzbyBiZSBhdHRlbXB0aW5nIHRvIHJ1biBGbGFzaCBpbiBhIHNhbmRib3hlZCBpZnJhbWUsIHdoaWNoIGlzIGltcG9zc2libGUuXCIsXG4gICAgICBcImZsYXNoLW91dGRhdGVkXCI6IFwiRmxhc2ggaXMgdG9vIG91dGRhdGVkIHRvIHN1cHBvcnQgWmVyb0NsaXBib2FyZFwiLFxuICAgICAgXCJmbGFzaC1zYW5kYm94ZWRcIjogXCJBdHRlbXB0aW5nIHRvIHJ1biBGbGFzaCBpbiBhIHNhbmRib3hlZCBpZnJhbWUsIHdoaWNoIGlzIGltcG9zc2libGVcIixcbiAgICAgIFwiZmxhc2gtdW5hdmFpbGFibGVcIjogXCJGbGFzaCBpcyB1bmFibGUgdG8gY29tbXVuaWNhdGUgYmlkaXJlY3Rpb25hbGx5IHdpdGggSmF2YVNjcmlwdFwiLFxuICAgICAgXCJmbGFzaC1kZWdyYWRlZFwiOiBcIkZsYXNoIGlzIHVuYWJsZSB0byBwcmVzZXJ2ZSBkYXRhIGZpZGVsaXR5IHdoZW4gY29tbXVuaWNhdGluZyB3aXRoIEphdmFTY3JpcHRcIixcbiAgICAgIFwiZmxhc2gtZGVhY3RpdmF0ZWRcIjogXCJGbGFzaCBpcyB0b28gb3V0ZGF0ZWQgZm9yIHlvdXIgYnJvd3NlciBhbmQvb3IgaXMgY29uZmlndXJlZCBhcyBjbGljay10by1hY3RpdmF0ZS5cXG5UaGlzIG1heSBhbHNvIG1lYW4gdGhhdCB0aGUgWmVyb0NsaXBib2FyZCBTV0Ygb2JqZWN0IGNvdWxkIG5vdCBiZSBsb2FkZWQsIHNvIHBsZWFzZSBjaGVjayB5b3VyIGBzd2ZQYXRoYCBjb25maWd1cmF0aW9uIGFuZC9vciBuZXR3b3JrIGNvbm5lY3Rpdml0eS5cXG5NYXkgYWxzbyBiZSBhdHRlbXB0aW5nIHRvIHJ1biBGbGFzaCBpbiBhIHNhbmRib3hlZCBpZnJhbWUsIHdoaWNoIGlzIGltcG9zc2libGUuXCIsXG4gICAgICBcImZsYXNoLW92ZXJkdWVcIjogXCJGbGFzaCBjb21tdW5pY2F0aW9uIHdhcyBlc3RhYmxpc2hlZCBidXQgTk9UIHdpdGhpbiB0aGUgYWNjZXB0YWJsZSB0aW1lIGxpbWl0XCIsXG4gICAgICBcInZlcnNpb24tbWlzbWF0Y2hcIjogXCJaZXJvQ2xpcGJvYXJkIEpTIHZlcnNpb24gbnVtYmVyIGRvZXMgbm90IG1hdGNoIFplcm9DbGlwYm9hcmQgU1dGIHZlcnNpb24gbnVtYmVyXCIsXG4gICAgICBcImNsaXBib2FyZC1lcnJvclwiOiBcIkF0IGxlYXN0IG9uZSBlcnJvciB3YXMgdGhyb3duIHdoaWxlIFplcm9DbGlwYm9hcmQgd2FzIGF0dGVtcHRpbmcgdG8gaW5qZWN0IHlvdXIgZGF0YSBpbnRvIHRoZSBjbGlwYm9hcmRcIixcbiAgICAgIFwiY29uZmlnLW1pc21hdGNoXCI6IFwiWmVyb0NsaXBib2FyZCBjb25maWd1cmF0aW9uIGRvZXMgbm90IG1hdGNoIEZsYXNoJ3MgcmVhbGl0eVwiLFxuICAgICAgXCJzd2Ytbm90LWZvdW5kXCI6IFwiVGhlIFplcm9DbGlwYm9hcmQgU1dGIG9iamVjdCBjb3VsZCBub3QgYmUgbG9hZGVkLCBzbyBwbGVhc2UgY2hlY2sgeW91ciBgc3dmUGF0aGAgY29uZmlndXJhdGlvbiBhbmQvb3IgbmV0d29yayBjb25uZWN0aXZpdHlcIlxuICAgIH1cbiAgfTtcbiAgLyoqXG4gKiBUaGUgYG5hbWVgcyBvZiBgZXJyb3JgIGV2ZW50cyB0aGF0IGNhbiBvbmx5IG9jY3VyIGlzIEZsYXNoIGhhcyBhdCBsZWFzdFxuICogYmVlbiBhYmxlIHRvIGxvYWQgdGhlIFNXRiBzdWNjZXNzZnVsbHkuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZXJyb3JzVGhhdE9ubHlPY2N1ckFmdGVyRmxhc2hMb2FkcyA9IFsgXCJmbGFzaC11bmF2YWlsYWJsZVwiLCBcImZsYXNoLWRlZ3JhZGVkXCIsIFwiZmxhc2gtb3ZlcmR1ZVwiLCBcInZlcnNpb24tbWlzbWF0Y2hcIiwgXCJjb25maWctbWlzbWF0Y2hcIiwgXCJjbGlwYm9hcmQtZXJyb3JcIiBdO1xuICAvKipcbiAqIFRoZSBgbmFtZWBzIG9mIGBlcnJvcmAgZXZlbnRzIHRoYXQgc2hvdWxkIGxpa2VseSByZXN1bHQgaW4gdGhlIGBfZmxhc2hTdGF0ZWBcbiAqIHZhcmlhYmxlJ3MgcHJvcGVydHkgdmFsdWVzIGJlaW5nIHVwZGF0ZWQuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZmxhc2hTdGF0ZUVycm9yTmFtZXMgPSBbIFwiZmxhc2gtZGlzYWJsZWRcIiwgXCJmbGFzaC1vdXRkYXRlZFwiLCBcImZsYXNoLXNhbmRib3hlZFwiLCBcImZsYXNoLXVuYXZhaWxhYmxlXCIsIFwiZmxhc2gtZGVncmFkZWRcIiwgXCJmbGFzaC1kZWFjdGl2YXRlZFwiLCBcImZsYXNoLW92ZXJkdWVcIiBdO1xuICAvKipcbiAqIEEgUmVnRXhwIHRvIG1hdGNoIHRoZSBgbmFtZWAgcHJvcGVydHkgb2YgYGVycm9yYCBldmVudHMgcmVsYXRlZCB0byBGbGFzaC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9mbGFzaFN0YXRlRXJyb3JOYW1lTWF0Y2hpbmdSZWdleCA9IG5ldyBSZWdFeHAoXCJeZmxhc2gtKFwiICsgX2ZsYXNoU3RhdGVFcnJvck5hbWVzLm1hcChmdW5jdGlvbihlcnJvck5hbWUpIHtcbiAgICByZXR1cm4gZXJyb3JOYW1lLnJlcGxhY2UoL15mbGFzaC0vLCBcIlwiKTtcbiAgfSkuam9pbihcInxcIikgKyBcIikkXCIpO1xuICAvKipcbiAqIEEgUmVnRXhwIHRvIG1hdGNoIHRoZSBgbmFtZWAgcHJvcGVydHkgb2YgYGVycm9yYCBldmVudHMgcmVsYXRlZCB0byBGbGFzaCxcbiAqIHdoaWNoIGlzIGVuYWJsZWQuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZmxhc2hTdGF0ZUVuYWJsZWRFcnJvck5hbWVNYXRjaGluZ1JlZ2V4ID0gbmV3IFJlZ0V4cChcIl5mbGFzaC0oXCIgKyBfZmxhc2hTdGF0ZUVycm9yTmFtZXMuc2xpY2UoMSkubWFwKGZ1bmN0aW9uKGVycm9yTmFtZSkge1xuICAgIHJldHVybiBlcnJvck5hbWUucmVwbGFjZSgvXmZsYXNoLS8sIFwiXCIpO1xuICB9KS5qb2luKFwifFwiKSArIFwiKSRcIik7XG4gIC8qKlxuICogWmVyb0NsaXBib2FyZCBjb25maWd1cmF0aW9uIGRlZmF1bHRzIGZvciB0aGUgQ29yZSBtb2R1bGUuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZ2xvYmFsQ29uZmlnID0ge1xuICAgIHN3ZlBhdGg6IF9nZXREZWZhdWx0U3dmUGF0aCgpLFxuICAgIHRydXN0ZWREb21haW5zOiB3aW5kb3cubG9jYXRpb24uaG9zdCA/IFsgd2luZG93LmxvY2F0aW9uLmhvc3QgXSA6IFtdLFxuICAgIGNhY2hlQnVzdDogdHJ1ZSxcbiAgICBmb3JjZUVuaGFuY2VkQ2xpcGJvYXJkOiBmYWxzZSxcbiAgICBmbGFzaExvYWRUaW1lb3V0OiAzZTQsXG4gICAgYXV0b0FjdGl2YXRlOiB0cnVlLFxuICAgIGJ1YmJsZUV2ZW50czogdHJ1ZSxcbiAgICBjb250YWluZXJJZDogXCJnbG9iYWwtemVyb2NsaXBib2FyZC1odG1sLWJyaWRnZVwiLFxuICAgIGNvbnRhaW5lckNsYXNzOiBcImdsb2JhbC16ZXJvY2xpcGJvYXJkLWNvbnRhaW5lclwiLFxuICAgIHN3Zk9iamVjdElkOiBcImdsb2JhbC16ZXJvY2xpcGJvYXJkLWZsYXNoLWJyaWRnZVwiLFxuICAgIGhvdmVyQ2xhc3M6IFwiemVyb2NsaXBib2FyZC1pcy1ob3ZlclwiLFxuICAgIGFjdGl2ZUNsYXNzOiBcInplcm9jbGlwYm9hcmQtaXMtYWN0aXZlXCIsXG4gICAgZm9yY2VIYW5kQ3Vyc29yOiBmYWxzZSxcbiAgICB0aXRsZTogbnVsbCxcbiAgICB6SW5kZXg6IDk5OTk5OTk5OVxuICB9O1xuICAvKipcbiAqIFRoZSB1bmRlcmx5aW5nIGltcGxlbWVudGF0aW9uIG9mIGBaZXJvQ2xpcGJvYXJkLmNvbmZpZ2AuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY29uZmlnID0gZnVuY3Rpb24ob3B0aW9ucykge1xuICAgIGlmICh0eXBlb2Ygb3B0aW9ucyA9PT0gXCJvYmplY3RcIiAmJiBvcHRpb25zICE9PSBudWxsKSB7XG4gICAgICBmb3IgKHZhciBwcm9wIGluIG9wdGlvbnMpIHtcbiAgICAgICAgaWYgKF9oYXNPd24uY2FsbChvcHRpb25zLCBwcm9wKSkge1xuICAgICAgICAgIGlmICgvXig/OmZvcmNlSGFuZEN1cnNvcnx0aXRsZXx6SW5kZXh8YnViYmxlRXZlbnRzKSQvLnRlc3QocHJvcCkpIHtcbiAgICAgICAgICAgIF9nbG9iYWxDb25maWdbcHJvcF0gPSBvcHRpb25zW3Byb3BdO1xuICAgICAgICAgIH0gZWxzZSBpZiAoX2ZsYXNoU3RhdGUuYnJpZGdlID09IG51bGwpIHtcbiAgICAgICAgICAgIGlmIChwcm9wID09PSBcImNvbnRhaW5lcklkXCIgfHwgcHJvcCA9PT0gXCJzd2ZPYmplY3RJZFwiKSB7XG4gICAgICAgICAgICAgIGlmIChfaXNWYWxpZEh0bWw0SWQob3B0aW9uc1twcm9wXSkpIHtcbiAgICAgICAgICAgICAgICBfZ2xvYmFsQ29uZmlnW3Byb3BdID0gb3B0aW9uc1twcm9wXTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUaGUgc3BlY2lmaWVkIGBcIiArIHByb3AgKyBcImAgdmFsdWUgaXMgbm90IHZhbGlkIGFzIGFuIEhUTUw0IEVsZW1lbnQgSURcIik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIF9nbG9iYWxDb25maWdbcHJvcF0gPSBvcHRpb25zW3Byb3BdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBpZiAodHlwZW9mIG9wdGlvbnMgPT09IFwic3RyaW5nXCIgJiYgb3B0aW9ucykge1xuICAgICAgaWYgKF9oYXNPd24uY2FsbChfZ2xvYmFsQ29uZmlnLCBvcHRpb25zKSkge1xuICAgICAgICByZXR1cm4gX2dsb2JhbENvbmZpZ1tvcHRpb25zXTtcbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgcmV0dXJuIF9kZWVwQ29weShfZ2xvYmFsQ29uZmlnKTtcbiAgfTtcbiAgLyoqXG4gKiBUaGUgdW5kZXJseWluZyBpbXBsZW1lbnRhdGlvbiBvZiBgWmVyb0NsaXBib2FyZC5zdGF0ZWAuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfc3RhdGUgPSBmdW5jdGlvbigpIHtcbiAgICBfZGV0ZWN0U2FuZGJveCgpO1xuICAgIHJldHVybiB7XG4gICAgICBicm93c2VyOiBfcGljayhfbmF2aWdhdG9yLCBbIFwidXNlckFnZW50XCIsIFwicGxhdGZvcm1cIiwgXCJhcHBOYW1lXCIgXSksXG4gICAgICBmbGFzaDogX29taXQoX2ZsYXNoU3RhdGUsIFsgXCJicmlkZ2VcIiBdKSxcbiAgICAgIHplcm9jbGlwYm9hcmQ6IHtcbiAgICAgICAgdmVyc2lvbjogWmVyb0NsaXBib2FyZC52ZXJzaW9uLFxuICAgICAgICBjb25maWc6IFplcm9DbGlwYm9hcmQuY29uZmlnKClcbiAgICAgIH1cbiAgICB9O1xuICB9O1xuICAvKipcbiAqIFRoZSB1bmRlcmx5aW5nIGltcGxlbWVudGF0aW9uIG9mIGBaZXJvQ2xpcGJvYXJkLmlzRmxhc2hVbnVzYWJsZWAuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfaXNGbGFzaFVudXNhYmxlID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuICEhKF9mbGFzaFN0YXRlLmRpc2FibGVkIHx8IF9mbGFzaFN0YXRlLm91dGRhdGVkIHx8IF9mbGFzaFN0YXRlLnNhbmRib3hlZCB8fCBfZmxhc2hTdGF0ZS51bmF2YWlsYWJsZSB8fCBfZmxhc2hTdGF0ZS5kZWdyYWRlZCB8fCBfZmxhc2hTdGF0ZS5kZWFjdGl2YXRlZCk7XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQub25gLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX29uID0gZnVuY3Rpb24oZXZlbnRUeXBlLCBsaXN0ZW5lcikge1xuICAgIHZhciBpLCBsZW4sIGV2ZW50cywgYWRkZWQgPSB7fTtcbiAgICBpZiAodHlwZW9mIGV2ZW50VHlwZSA9PT0gXCJzdHJpbmdcIiAmJiBldmVudFR5cGUpIHtcbiAgICAgIGV2ZW50cyA9IGV2ZW50VHlwZS50b0xvd2VyQ2FzZSgpLnNwbGl0KC9cXHMrLyk7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgZXZlbnRUeXBlID09PSBcIm9iamVjdFwiICYmIGV2ZW50VHlwZSAmJiB0eXBlb2YgbGlzdGVuZXIgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIGZvciAoaSBpbiBldmVudFR5cGUpIHtcbiAgICAgICAgaWYgKF9oYXNPd24uY2FsbChldmVudFR5cGUsIGkpICYmIHR5cGVvZiBpID09PSBcInN0cmluZ1wiICYmIGkgJiYgdHlwZW9mIGV2ZW50VHlwZVtpXSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgWmVyb0NsaXBib2FyZC5vbihpLCBldmVudFR5cGVbaV0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChldmVudHMgJiYgZXZlbnRzLmxlbmd0aCkge1xuICAgICAgZm9yIChpID0gMCwgbGVuID0gZXZlbnRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGV2ZW50VHlwZSA9IGV2ZW50c1tpXS5yZXBsYWNlKC9eb24vLCBcIlwiKTtcbiAgICAgICAgYWRkZWRbZXZlbnRUeXBlXSA9IHRydWU7XG4gICAgICAgIGlmICghX2hhbmRsZXJzW2V2ZW50VHlwZV0pIHtcbiAgICAgICAgICBfaGFuZGxlcnNbZXZlbnRUeXBlXSA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIF9oYW5kbGVyc1tldmVudFR5cGVdLnB1c2gobGlzdGVuZXIpO1xuICAgICAgfVxuICAgICAgaWYgKGFkZGVkLnJlYWR5ICYmIF9mbGFzaFN0YXRlLnJlYWR5KSB7XG4gICAgICAgIFplcm9DbGlwYm9hcmQuZW1pdCh7XG4gICAgICAgICAgdHlwZTogXCJyZWFkeVwiXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgaWYgKGFkZGVkLmVycm9yKSB7XG4gICAgICAgIGZvciAoaSA9IDAsIGxlbiA9IF9mbGFzaFN0YXRlRXJyb3JOYW1lcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgIGlmIChfZmxhc2hTdGF0ZVtfZmxhc2hTdGF0ZUVycm9yTmFtZXNbaV0ucmVwbGFjZSgvXmZsYXNoLS8sIFwiXCIpXSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgWmVyb0NsaXBib2FyZC5lbWl0KHtcbiAgICAgICAgICAgICAgdHlwZTogXCJlcnJvclwiLFxuICAgICAgICAgICAgICBuYW1lOiBfZmxhc2hTdGF0ZUVycm9yTmFtZXNbaV1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChfemNTd2ZWZXJzaW9uICE9PSB1bmRlZmluZWQgJiYgWmVyb0NsaXBib2FyZC52ZXJzaW9uICE9PSBfemNTd2ZWZXJzaW9uKSB7XG4gICAgICAgICAgWmVyb0NsaXBib2FyZC5lbWl0KHtcbiAgICAgICAgICAgIHR5cGU6IFwiZXJyb3JcIixcbiAgICAgICAgICAgIG5hbWU6IFwidmVyc2lvbi1taXNtYXRjaFwiLFxuICAgICAgICAgICAganNWZXJzaW9uOiBaZXJvQ2xpcGJvYXJkLnZlcnNpb24sXG4gICAgICAgICAgICBzd2ZWZXJzaW9uOiBfemNTd2ZWZXJzaW9uXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIFplcm9DbGlwYm9hcmQ7XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQub2ZmYC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9vZmYgPSBmdW5jdGlvbihldmVudFR5cGUsIGxpc3RlbmVyKSB7XG4gICAgdmFyIGksIGxlbiwgZm91bmRJbmRleCwgZXZlbnRzLCBwZXJFdmVudEhhbmRsZXJzO1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSB7XG4gICAgICBldmVudHMgPSBfa2V5cyhfaGFuZGxlcnMpO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGV2ZW50VHlwZSA9PT0gXCJzdHJpbmdcIiAmJiBldmVudFR5cGUpIHtcbiAgICAgIGV2ZW50cyA9IGV2ZW50VHlwZS5zcGxpdCgvXFxzKy8pO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGV2ZW50VHlwZSA9PT0gXCJvYmplY3RcIiAmJiBldmVudFR5cGUgJiYgdHlwZW9mIGxpc3RlbmVyID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICBmb3IgKGkgaW4gZXZlbnRUeXBlKSB7XG4gICAgICAgIGlmIChfaGFzT3duLmNhbGwoZXZlbnRUeXBlLCBpKSAmJiB0eXBlb2YgaSA9PT0gXCJzdHJpbmdcIiAmJiBpICYmIHR5cGVvZiBldmVudFR5cGVbaV0gPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgIFplcm9DbGlwYm9hcmQub2ZmKGksIGV2ZW50VHlwZVtpXSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGV2ZW50cyAmJiBldmVudHMubGVuZ3RoKSB7XG4gICAgICBmb3IgKGkgPSAwLCBsZW4gPSBldmVudHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgZXZlbnRUeXBlID0gZXZlbnRzW2ldLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvXm9uLywgXCJcIik7XG4gICAgICAgIHBlckV2ZW50SGFuZGxlcnMgPSBfaGFuZGxlcnNbZXZlbnRUeXBlXTtcbiAgICAgICAgaWYgKHBlckV2ZW50SGFuZGxlcnMgJiYgcGVyRXZlbnRIYW5kbGVycy5sZW5ndGgpIHtcbiAgICAgICAgICBpZiAobGlzdGVuZXIpIHtcbiAgICAgICAgICAgIGZvdW5kSW5kZXggPSBwZXJFdmVudEhhbmRsZXJzLmluZGV4T2YobGlzdGVuZXIpO1xuICAgICAgICAgICAgd2hpbGUgKGZvdW5kSW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgICAgIHBlckV2ZW50SGFuZGxlcnMuc3BsaWNlKGZvdW5kSW5kZXgsIDEpO1xuICAgICAgICAgICAgICBmb3VuZEluZGV4ID0gcGVyRXZlbnRIYW5kbGVycy5pbmRleE9mKGxpc3RlbmVyLCBmb3VuZEluZGV4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcGVyRXZlbnRIYW5kbGVycy5sZW5ndGggPSAwO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gWmVyb0NsaXBib2FyZDtcbiAgfTtcbiAgLyoqXG4gKiBUaGUgdW5kZXJseWluZyBpbXBsZW1lbnRhdGlvbiBvZiBgWmVyb0NsaXBib2FyZC5oYW5kbGVyc2AuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfbGlzdGVuZXJzID0gZnVuY3Rpb24oZXZlbnRUeXBlKSB7XG4gICAgdmFyIGNvcHk7XG4gICAgaWYgKHR5cGVvZiBldmVudFR5cGUgPT09IFwic3RyaW5nXCIgJiYgZXZlbnRUeXBlKSB7XG4gICAgICBjb3B5ID0gX2RlZXBDb3B5KF9oYW5kbGVyc1tldmVudFR5cGVdKSB8fCBudWxsO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb3B5ID0gX2RlZXBDb3B5KF9oYW5kbGVycyk7XG4gICAgfVxuICAgIHJldHVybiBjb3B5O1xuICB9O1xuICAvKipcbiAqIFRoZSB1bmRlcmx5aW5nIGltcGxlbWVudGF0aW9uIG9mIGBaZXJvQ2xpcGJvYXJkLmVtaXRgLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2VtaXQgPSBmdW5jdGlvbihldmVudCkge1xuICAgIHZhciBldmVudENvcHksIHJldHVyblZhbCwgdG1wO1xuICAgIGV2ZW50ID0gX2NyZWF0ZUV2ZW50KGV2ZW50KTtcbiAgICBpZiAoIWV2ZW50KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChfcHJlcHJvY2Vzc0V2ZW50KGV2ZW50KSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoZXZlbnQudHlwZSA9PT0gXCJyZWFkeVwiICYmIF9mbGFzaFN0YXRlLm92ZXJkdWUgPT09IHRydWUpIHtcbiAgICAgIHJldHVybiBaZXJvQ2xpcGJvYXJkLmVtaXQoe1xuICAgICAgICB0eXBlOiBcImVycm9yXCIsXG4gICAgICAgIG5hbWU6IFwiZmxhc2gtb3ZlcmR1ZVwiXG4gICAgICB9KTtcbiAgICB9XG4gICAgZXZlbnRDb3B5ID0gX2V4dGVuZCh7fSwgZXZlbnQpO1xuICAgIF9kaXNwYXRjaENhbGxiYWNrcy5jYWxsKHRoaXMsIGV2ZW50Q29weSk7XG4gICAgaWYgKGV2ZW50LnR5cGUgPT09IFwiY29weVwiKSB7XG4gICAgICB0bXAgPSBfbWFwQ2xpcERhdGFUb0ZsYXNoKF9jbGlwRGF0YSk7XG4gICAgICByZXR1cm5WYWwgPSB0bXAuZGF0YTtcbiAgICAgIF9jbGlwRGF0YUZvcm1hdE1hcCA9IHRtcC5mb3JtYXRNYXA7XG4gICAgfVxuICAgIHJldHVybiByZXR1cm5WYWw7XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuY3JlYXRlYC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9jcmVhdGUgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgcHJldmlvdXNTdGF0ZSA9IF9mbGFzaFN0YXRlLnNhbmRib3hlZDtcbiAgICBfZGV0ZWN0U2FuZGJveCgpO1xuICAgIGlmICh0eXBlb2YgX2ZsYXNoU3RhdGUucmVhZHkgIT09IFwiYm9vbGVhblwiKSB7XG4gICAgICBfZmxhc2hTdGF0ZS5yZWFkeSA9IGZhbHNlO1xuICAgIH1cbiAgICBpZiAoX2ZsYXNoU3RhdGUuc2FuZGJveGVkICE9PSBwcmV2aW91c1N0YXRlICYmIF9mbGFzaFN0YXRlLnNhbmRib3hlZCA9PT0gdHJ1ZSkge1xuICAgICAgX2ZsYXNoU3RhdGUucmVhZHkgPSBmYWxzZTtcbiAgICAgIFplcm9DbGlwYm9hcmQuZW1pdCh7XG4gICAgICAgIHR5cGU6IFwiZXJyb3JcIixcbiAgICAgICAgbmFtZTogXCJmbGFzaC1zYW5kYm94ZWRcIlxuICAgICAgfSk7XG4gICAgfSBlbHNlIGlmICghWmVyb0NsaXBib2FyZC5pc0ZsYXNoVW51c2FibGUoKSAmJiBfZmxhc2hTdGF0ZS5icmlkZ2UgPT09IG51bGwpIHtcbiAgICAgIHZhciBtYXhXYWl0ID0gX2dsb2JhbENvbmZpZy5mbGFzaExvYWRUaW1lb3V0O1xuICAgICAgaWYgKHR5cGVvZiBtYXhXYWl0ID09PSBcIm51bWJlclwiICYmIG1heFdhaXQgPj0gMCkge1xuICAgICAgICBfZmxhc2hDaGVja1RpbWVvdXQgPSBfc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICBpZiAodHlwZW9mIF9mbGFzaFN0YXRlLmRlYWN0aXZhdGVkICE9PSBcImJvb2xlYW5cIikge1xuICAgICAgICAgICAgX2ZsYXNoU3RhdGUuZGVhY3RpdmF0ZWQgPSB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoX2ZsYXNoU3RhdGUuZGVhY3RpdmF0ZWQgPT09IHRydWUpIHtcbiAgICAgICAgICAgIFplcm9DbGlwYm9hcmQuZW1pdCh7XG4gICAgICAgICAgICAgIHR5cGU6IFwiZXJyb3JcIixcbiAgICAgICAgICAgICAgbmFtZTogXCJmbGFzaC1kZWFjdGl2YXRlZFwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sIG1heFdhaXQpO1xuICAgICAgfVxuICAgICAgX2ZsYXNoU3RhdGUub3ZlcmR1ZSA9IGZhbHNlO1xuICAgICAgX2VtYmVkU3dmKCk7XG4gICAgfVxuICB9O1xuICAvKipcbiAqIFRoZSB1bmRlcmx5aW5nIGltcGxlbWVudGF0aW9uIG9mIGBaZXJvQ2xpcGJvYXJkLmRlc3Ryb3lgLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2Rlc3Ryb3kgPSBmdW5jdGlvbigpIHtcbiAgICBaZXJvQ2xpcGJvYXJkLmNsZWFyRGF0YSgpO1xuICAgIFplcm9DbGlwYm9hcmQuYmx1cigpO1xuICAgIFplcm9DbGlwYm9hcmQuZW1pdChcImRlc3Ryb3lcIik7XG4gICAgX3VuZW1iZWRTd2YoKTtcbiAgICBaZXJvQ2xpcGJvYXJkLm9mZigpO1xuICB9O1xuICAvKipcbiAqIFRoZSB1bmRlcmx5aW5nIGltcGxlbWVudGF0aW9uIG9mIGBaZXJvQ2xpcGJvYXJkLnNldERhdGFgLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX3NldERhdGEgPSBmdW5jdGlvbihmb3JtYXQsIGRhdGEpIHtcbiAgICB2YXIgZGF0YU9iajtcbiAgICBpZiAodHlwZW9mIGZvcm1hdCA9PT0gXCJvYmplY3RcIiAmJiBmb3JtYXQgJiYgdHlwZW9mIGRhdGEgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIGRhdGFPYmogPSBmb3JtYXQ7XG4gICAgICBaZXJvQ2xpcGJvYXJkLmNsZWFyRGF0YSgpO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGZvcm1hdCA9PT0gXCJzdHJpbmdcIiAmJiBmb3JtYXQpIHtcbiAgICAgIGRhdGFPYmogPSB7fTtcbiAgICAgIGRhdGFPYmpbZm9ybWF0XSA9IGRhdGE7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZm9yICh2YXIgZGF0YUZvcm1hdCBpbiBkYXRhT2JqKSB7XG4gICAgICBpZiAodHlwZW9mIGRhdGFGb3JtYXQgPT09IFwic3RyaW5nXCIgJiYgZGF0YUZvcm1hdCAmJiBfaGFzT3duLmNhbGwoZGF0YU9iaiwgZGF0YUZvcm1hdCkgJiYgdHlwZW9mIGRhdGFPYmpbZGF0YUZvcm1hdF0gPT09IFwic3RyaW5nXCIgJiYgZGF0YU9ialtkYXRhRm9ybWF0XSkge1xuICAgICAgICBfY2xpcERhdGFbZGF0YUZvcm1hdF0gPSBkYXRhT2JqW2RhdGFGb3JtYXRdO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbiAgLyoqXG4gKiBUaGUgdW5kZXJseWluZyBpbXBsZW1lbnRhdGlvbiBvZiBgWmVyb0NsaXBib2FyZC5jbGVhckRhdGFgLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2NsZWFyRGF0YSA9IGZ1bmN0aW9uKGZvcm1hdCkge1xuICAgIGlmICh0eXBlb2YgZm9ybWF0ID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICBfZGVsZXRlT3duUHJvcGVydGllcyhfY2xpcERhdGEpO1xuICAgICAgX2NsaXBEYXRhRm9ybWF0TWFwID0gbnVsbDtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBmb3JtYXQgPT09IFwic3RyaW5nXCIgJiYgX2hhc093bi5jYWxsKF9jbGlwRGF0YSwgZm9ybWF0KSkge1xuICAgICAgZGVsZXRlIF9jbGlwRGF0YVtmb3JtYXRdO1xuICAgIH1cbiAgfTtcbiAgLyoqXG4gKiBUaGUgdW5kZXJseWluZyBpbXBsZW1lbnRhdGlvbiBvZiBgWmVyb0NsaXBib2FyZC5nZXREYXRhYC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9nZXREYXRhID0gZnVuY3Rpb24oZm9ybWF0KSB7XG4gICAgaWYgKHR5cGVvZiBmb3JtYXQgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIHJldHVybiBfZGVlcENvcHkoX2NsaXBEYXRhKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBmb3JtYXQgPT09IFwic3RyaW5nXCIgJiYgX2hhc093bi5jYWxsKF9jbGlwRGF0YSwgZm9ybWF0KSkge1xuICAgICAgcmV0dXJuIF9jbGlwRGF0YVtmb3JtYXRdO1xuICAgIH1cbiAgfTtcbiAgLyoqXG4gKiBUaGUgdW5kZXJseWluZyBpbXBsZW1lbnRhdGlvbiBvZiBgWmVyb0NsaXBib2FyZC5mb2N1c2AvYFplcm9DbGlwYm9hcmQuYWN0aXZhdGVgLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2ZvY3VzID0gZnVuY3Rpb24oZWxlbWVudCkge1xuICAgIGlmICghKGVsZW1lbnQgJiYgZWxlbWVudC5ub2RlVHlwZSA9PT0gMSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKF9jdXJyZW50RWxlbWVudCkge1xuICAgICAgX3JlbW92ZUNsYXNzKF9jdXJyZW50RWxlbWVudCwgX2dsb2JhbENvbmZpZy5hY3RpdmVDbGFzcyk7XG4gICAgICBpZiAoX2N1cnJlbnRFbGVtZW50ICE9PSBlbGVtZW50KSB7XG4gICAgICAgIF9yZW1vdmVDbGFzcyhfY3VycmVudEVsZW1lbnQsIF9nbG9iYWxDb25maWcuaG92ZXJDbGFzcyk7XG4gICAgICB9XG4gICAgfVxuICAgIF9jdXJyZW50RWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgX2FkZENsYXNzKGVsZW1lbnQsIF9nbG9iYWxDb25maWcuaG92ZXJDbGFzcyk7XG4gICAgdmFyIG5ld1RpdGxlID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJ0aXRsZVwiKSB8fCBfZ2xvYmFsQ29uZmlnLnRpdGxlO1xuICAgIGlmICh0eXBlb2YgbmV3VGl0bGUgPT09IFwic3RyaW5nXCIgJiYgbmV3VGl0bGUpIHtcbiAgICAgIHZhciBodG1sQnJpZGdlID0gX2dldEh0bWxCcmlkZ2UoX2ZsYXNoU3RhdGUuYnJpZGdlKTtcbiAgICAgIGlmIChodG1sQnJpZGdlKSB7XG4gICAgICAgIGh0bWxCcmlkZ2Uuc2V0QXR0cmlidXRlKFwidGl0bGVcIiwgbmV3VGl0bGUpO1xuICAgICAgfVxuICAgIH1cbiAgICB2YXIgdXNlSGFuZEN1cnNvciA9IF9nbG9iYWxDb25maWcuZm9yY2VIYW5kQ3Vyc29yID09PSB0cnVlIHx8IF9nZXRTdHlsZShlbGVtZW50LCBcImN1cnNvclwiKSA9PT0gXCJwb2ludGVyXCI7XG4gICAgX3NldEhhbmRDdXJzb3IodXNlSGFuZEN1cnNvcik7XG4gICAgX3JlcG9zaXRpb24oKTtcbiAgfTtcbiAgLyoqXG4gKiBUaGUgdW5kZXJseWluZyBpbXBsZW1lbnRhdGlvbiBvZiBgWmVyb0NsaXBib2FyZC5ibHVyYC9gWmVyb0NsaXBib2FyZC5kZWFjdGl2YXRlYC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9ibHVyID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGh0bWxCcmlkZ2UgPSBfZ2V0SHRtbEJyaWRnZShfZmxhc2hTdGF0ZS5icmlkZ2UpO1xuICAgIGlmIChodG1sQnJpZGdlKSB7XG4gICAgICBodG1sQnJpZGdlLnJlbW92ZUF0dHJpYnV0ZShcInRpdGxlXCIpO1xuICAgICAgaHRtbEJyaWRnZS5zdHlsZS5sZWZ0ID0gXCIwcHhcIjtcbiAgICAgIGh0bWxCcmlkZ2Uuc3R5bGUudG9wID0gXCItOTk5OXB4XCI7XG4gICAgICBodG1sQnJpZGdlLnN0eWxlLndpZHRoID0gXCIxcHhcIjtcbiAgICAgIGh0bWxCcmlkZ2Uuc3R5bGUuaGVpZ2h0ID0gXCIxcHhcIjtcbiAgICB9XG4gICAgaWYgKF9jdXJyZW50RWxlbWVudCkge1xuICAgICAgX3JlbW92ZUNsYXNzKF9jdXJyZW50RWxlbWVudCwgX2dsb2JhbENvbmZpZy5ob3ZlckNsYXNzKTtcbiAgICAgIF9yZW1vdmVDbGFzcyhfY3VycmVudEVsZW1lbnQsIF9nbG9iYWxDb25maWcuYWN0aXZlQ2xhc3MpO1xuICAgICAgX2N1cnJlbnRFbGVtZW50ID0gbnVsbDtcbiAgICB9XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuYWN0aXZlRWxlbWVudGAuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfYWN0aXZlRWxlbWVudCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfY3VycmVudEVsZW1lbnQgfHwgbnVsbDtcbiAgfTtcbiAgLyoqXG4gKiBDaGVjayBpZiBhIHZhbHVlIGlzIGEgdmFsaWQgSFRNTDQgYElEYCBvciBgTmFtZWAgdG9rZW4uXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfaXNWYWxpZEh0bWw0SWQgPSBmdW5jdGlvbihpZCkge1xuICAgIHJldHVybiB0eXBlb2YgaWQgPT09IFwic3RyaW5nXCIgJiYgaWQgJiYgL15bQS1aYS16XVtBLVphLXowLTlfOlxcLVxcLl0qJC8udGVzdChpZCk7XG4gIH07XG4gIC8qKlxuICogQ3JlYXRlIG9yIHVwZGF0ZSBhbiBgZXZlbnRgIG9iamVjdCwgYmFzZWQgb24gdGhlIGBldmVudFR5cGVgLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2NyZWF0ZUV2ZW50ID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICB2YXIgZXZlbnRUeXBlO1xuICAgIGlmICh0eXBlb2YgZXZlbnQgPT09IFwic3RyaW5nXCIgJiYgZXZlbnQpIHtcbiAgICAgIGV2ZW50VHlwZSA9IGV2ZW50O1xuICAgICAgZXZlbnQgPSB7fTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBldmVudCA9PT0gXCJvYmplY3RcIiAmJiBldmVudCAmJiB0eXBlb2YgZXZlbnQudHlwZSA9PT0gXCJzdHJpbmdcIiAmJiBldmVudC50eXBlKSB7XG4gICAgICBldmVudFR5cGUgPSBldmVudC50eXBlO1xuICAgIH1cbiAgICBpZiAoIWV2ZW50VHlwZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBldmVudFR5cGUgPSBldmVudFR5cGUudG9Mb3dlckNhc2UoKTtcbiAgICBpZiAoIWV2ZW50LnRhcmdldCAmJiAoL14oY29weXxhZnRlcmNvcHl8X2NsaWNrKSQvLnRlc3QoZXZlbnRUeXBlKSB8fCBldmVudFR5cGUgPT09IFwiZXJyb3JcIiAmJiBldmVudC5uYW1lID09PSBcImNsaXBib2FyZC1lcnJvclwiKSkge1xuICAgICAgZXZlbnQudGFyZ2V0ID0gX2NvcHlUYXJnZXQ7XG4gICAgfVxuICAgIF9leHRlbmQoZXZlbnQsIHtcbiAgICAgIHR5cGU6IGV2ZW50VHlwZSxcbiAgICAgIHRhcmdldDogZXZlbnQudGFyZ2V0IHx8IF9jdXJyZW50RWxlbWVudCB8fCBudWxsLFxuICAgICAgcmVsYXRlZFRhcmdldDogZXZlbnQucmVsYXRlZFRhcmdldCB8fCBudWxsLFxuICAgICAgY3VycmVudFRhcmdldDogX2ZsYXNoU3RhdGUgJiYgX2ZsYXNoU3RhdGUuYnJpZGdlIHx8IG51bGwsXG4gICAgICB0aW1lU3RhbXA6IGV2ZW50LnRpbWVTdGFtcCB8fCBfbm93KCkgfHwgbnVsbFxuICAgIH0pO1xuICAgIHZhciBtc2cgPSBfZXZlbnRNZXNzYWdlc1tldmVudC50eXBlXTtcbiAgICBpZiAoZXZlbnQudHlwZSA9PT0gXCJlcnJvclwiICYmIGV2ZW50Lm5hbWUgJiYgbXNnKSB7XG4gICAgICBtc2cgPSBtc2dbZXZlbnQubmFtZV07XG4gICAgfVxuICAgIGlmIChtc2cpIHtcbiAgICAgIGV2ZW50Lm1lc3NhZ2UgPSBtc2c7XG4gICAgfVxuICAgIGlmIChldmVudC50eXBlID09PSBcInJlYWR5XCIpIHtcbiAgICAgIF9leHRlbmQoZXZlbnQsIHtcbiAgICAgICAgdGFyZ2V0OiBudWxsLFxuICAgICAgICB2ZXJzaW9uOiBfZmxhc2hTdGF0ZS52ZXJzaW9uXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKGV2ZW50LnR5cGUgPT09IFwiZXJyb3JcIikge1xuICAgICAgaWYgKF9mbGFzaFN0YXRlRXJyb3JOYW1lTWF0Y2hpbmdSZWdleC50ZXN0KGV2ZW50Lm5hbWUpKSB7XG4gICAgICAgIF9leHRlbmQoZXZlbnQsIHtcbiAgICAgICAgICB0YXJnZXQ6IG51bGwsXG4gICAgICAgICAgbWluaW11bVZlcnNpb246IF9taW5pbXVtRmxhc2hWZXJzaW9uXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgaWYgKF9mbGFzaFN0YXRlRW5hYmxlZEVycm9yTmFtZU1hdGNoaW5nUmVnZXgudGVzdChldmVudC5uYW1lKSkge1xuICAgICAgICBfZXh0ZW5kKGV2ZW50LCB7XG4gICAgICAgICAgdmVyc2lvbjogX2ZsYXNoU3RhdGUudmVyc2lvblxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGV2ZW50LnR5cGUgPT09IFwiY29weVwiKSB7XG4gICAgICBldmVudC5jbGlwYm9hcmREYXRhID0ge1xuICAgICAgICBzZXREYXRhOiBaZXJvQ2xpcGJvYXJkLnNldERhdGEsXG4gICAgICAgIGNsZWFyRGF0YTogWmVyb0NsaXBib2FyZC5jbGVhckRhdGFcbiAgICAgIH07XG4gICAgfVxuICAgIGlmIChldmVudC50eXBlID09PSBcImFmdGVyY29weVwiKSB7XG4gICAgICBldmVudCA9IF9tYXBDbGlwUmVzdWx0c0Zyb21GbGFzaChldmVudCwgX2NsaXBEYXRhRm9ybWF0TWFwKTtcbiAgICB9XG4gICAgaWYgKGV2ZW50LnRhcmdldCAmJiAhZXZlbnQucmVsYXRlZFRhcmdldCkge1xuICAgICAgZXZlbnQucmVsYXRlZFRhcmdldCA9IF9nZXRSZWxhdGVkVGFyZ2V0KGV2ZW50LnRhcmdldCk7XG4gICAgfVxuICAgIHJldHVybiBfYWRkTW91c2VEYXRhKGV2ZW50KTtcbiAgfTtcbiAgLyoqXG4gKiBHZXQgYSByZWxhdGVkVGFyZ2V0IGZyb20gdGhlIHRhcmdldCdzIGBkYXRhLWNsaXBib2FyZC10YXJnZXRgIGF0dHJpYnV0ZVxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2dldFJlbGF0ZWRUYXJnZXQgPSBmdW5jdGlvbih0YXJnZXRFbCkge1xuICAgIHZhciByZWxhdGVkVGFyZ2V0SWQgPSB0YXJnZXRFbCAmJiB0YXJnZXRFbC5nZXRBdHRyaWJ1dGUgJiYgdGFyZ2V0RWwuZ2V0QXR0cmlidXRlKFwiZGF0YS1jbGlwYm9hcmQtdGFyZ2V0XCIpO1xuICAgIHJldHVybiByZWxhdGVkVGFyZ2V0SWQgPyBfZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVsYXRlZFRhcmdldElkKSA6IG51bGw7XG4gIH07XG4gIC8qKlxuICogQWRkIGVsZW1lbnQgYW5kIHBvc2l0aW9uIGRhdGEgdG8gYE1vdXNlRXZlbnRgIGluc3RhbmNlc1xuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2FkZE1vdXNlRGF0YSA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgaWYgKGV2ZW50ICYmIC9eXyg/OmNsaWNrfG1vdXNlKD86b3ZlcnxvdXR8ZG93bnx1cHxtb3ZlKSkkLy50ZXN0KGV2ZW50LnR5cGUpKSB7XG4gICAgICB2YXIgc3JjRWxlbWVudCA9IGV2ZW50LnRhcmdldDtcbiAgICAgIHZhciBmcm9tRWxlbWVudCA9IGV2ZW50LnR5cGUgPT09IFwiX21vdXNlb3ZlclwiICYmIGV2ZW50LnJlbGF0ZWRUYXJnZXQgPyBldmVudC5yZWxhdGVkVGFyZ2V0IDogdW5kZWZpbmVkO1xuICAgICAgdmFyIHRvRWxlbWVudCA9IGV2ZW50LnR5cGUgPT09IFwiX21vdXNlb3V0XCIgJiYgZXZlbnQucmVsYXRlZFRhcmdldCA/IGV2ZW50LnJlbGF0ZWRUYXJnZXQgOiB1bmRlZmluZWQ7XG4gICAgICB2YXIgcG9zID0gX2dldEVsZW1lbnRQb3NpdGlvbihzcmNFbGVtZW50KTtcbiAgICAgIHZhciBzY3JlZW5MZWZ0ID0gX3dpbmRvdy5zY3JlZW5MZWZ0IHx8IF93aW5kb3cuc2NyZWVuWCB8fCAwO1xuICAgICAgdmFyIHNjcmVlblRvcCA9IF93aW5kb3cuc2NyZWVuVG9wIHx8IF93aW5kb3cuc2NyZWVuWSB8fCAwO1xuICAgICAgdmFyIHNjcm9sbExlZnQgPSBfZG9jdW1lbnQuYm9keS5zY3JvbGxMZWZ0ICsgX2RvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxMZWZ0O1xuICAgICAgdmFyIHNjcm9sbFRvcCA9IF9kb2N1bWVudC5ib2R5LnNjcm9sbFRvcCArIF9kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wO1xuICAgICAgdmFyIHBhZ2VYID0gcG9zLmxlZnQgKyAodHlwZW9mIGV2ZW50Ll9zdGFnZVggPT09IFwibnVtYmVyXCIgPyBldmVudC5fc3RhZ2VYIDogMCk7XG4gICAgICB2YXIgcGFnZVkgPSBwb3MudG9wICsgKHR5cGVvZiBldmVudC5fc3RhZ2VZID09PSBcIm51bWJlclwiID8gZXZlbnQuX3N0YWdlWSA6IDApO1xuICAgICAgdmFyIGNsaWVudFggPSBwYWdlWCAtIHNjcm9sbExlZnQ7XG4gICAgICB2YXIgY2xpZW50WSA9IHBhZ2VZIC0gc2Nyb2xsVG9wO1xuICAgICAgdmFyIHNjcmVlblggPSBzY3JlZW5MZWZ0ICsgY2xpZW50WDtcbiAgICAgIHZhciBzY3JlZW5ZID0gc2NyZWVuVG9wICsgY2xpZW50WTtcbiAgICAgIHZhciBtb3ZlWCA9IHR5cGVvZiBldmVudC5tb3ZlbWVudFggPT09IFwibnVtYmVyXCIgPyBldmVudC5tb3ZlbWVudFggOiAwO1xuICAgICAgdmFyIG1vdmVZID0gdHlwZW9mIGV2ZW50Lm1vdmVtZW50WSA9PT0gXCJudW1iZXJcIiA/IGV2ZW50Lm1vdmVtZW50WSA6IDA7XG4gICAgICBkZWxldGUgZXZlbnQuX3N0YWdlWDtcbiAgICAgIGRlbGV0ZSBldmVudC5fc3RhZ2VZO1xuICAgICAgX2V4dGVuZChldmVudCwge1xuICAgICAgICBzcmNFbGVtZW50OiBzcmNFbGVtZW50LFxuICAgICAgICBmcm9tRWxlbWVudDogZnJvbUVsZW1lbnQsXG4gICAgICAgIHRvRWxlbWVudDogdG9FbGVtZW50LFxuICAgICAgICBzY3JlZW5YOiBzY3JlZW5YLFxuICAgICAgICBzY3JlZW5ZOiBzY3JlZW5ZLFxuICAgICAgICBwYWdlWDogcGFnZVgsXG4gICAgICAgIHBhZ2VZOiBwYWdlWSxcbiAgICAgICAgY2xpZW50WDogY2xpZW50WCxcbiAgICAgICAgY2xpZW50WTogY2xpZW50WSxcbiAgICAgICAgeDogY2xpZW50WCxcbiAgICAgICAgeTogY2xpZW50WSxcbiAgICAgICAgbW92ZW1lbnRYOiBtb3ZlWCxcbiAgICAgICAgbW92ZW1lbnRZOiBtb3ZlWSxcbiAgICAgICAgb2Zmc2V0WDogMCxcbiAgICAgICAgb2Zmc2V0WTogMCxcbiAgICAgICAgbGF5ZXJYOiAwLFxuICAgICAgICBsYXllclk6IDBcbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gZXZlbnQ7XG4gIH07XG4gIC8qKlxuICogRGV0ZXJtaW5lIGlmIGFuIGV2ZW50J3MgcmVnaXN0ZXJlZCBoYW5kbGVycyBzaG91bGQgYmUgZXhlY3V0ZSBzeW5jaHJvbm91c2x5IG9yIGFzeW5jaHJvbm91c2x5LlxuICpcbiAqIEByZXR1cm5zIHtib29sZWFufVxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX3Nob3VsZFBlcmZvcm1Bc3luYyA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgdmFyIGV2ZW50VHlwZSA9IGV2ZW50ICYmIHR5cGVvZiBldmVudC50eXBlID09PSBcInN0cmluZ1wiICYmIGV2ZW50LnR5cGUgfHwgXCJcIjtcbiAgICByZXR1cm4gIS9eKD86KD86YmVmb3JlKT9jb3B5fGRlc3Ryb3kpJC8udGVzdChldmVudFR5cGUpO1xuICB9O1xuICAvKipcbiAqIENvbnRyb2wgaWYgYSBjYWxsYmFjayBzaG91bGQgYmUgZXhlY3V0ZWQgYXN5bmNocm9ub3VzbHkgb3Igbm90LlxuICpcbiAqIEByZXR1cm5zIGB1bmRlZmluZWRgXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZGlzcGF0Y2hDYWxsYmFjayA9IGZ1bmN0aW9uKGZ1bmMsIGNvbnRleHQsIGFyZ3MsIGFzeW5jKSB7XG4gICAgaWYgKGFzeW5jKSB7XG4gICAgICBfc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcbiAgICAgIH0sIDApO1xuICAgIH0gZWxzZSB7XG4gICAgICBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xuICAgIH1cbiAgfTtcbiAgLyoqXG4gKiBIYW5kbGUgdGhlIGFjdHVhbCBkaXNwYXRjaGluZyBvZiBldmVudHMgdG8gY2xpZW50IGluc3RhbmNlcy5cbiAqXG4gKiBAcmV0dXJucyBgdW5kZWZpbmVkYFxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2Rpc3BhdGNoQ2FsbGJhY2tzID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICBpZiAoISh0eXBlb2YgZXZlbnQgPT09IFwib2JqZWN0XCIgJiYgZXZlbnQgJiYgZXZlbnQudHlwZSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIGFzeW5jID0gX3Nob3VsZFBlcmZvcm1Bc3luYyhldmVudCk7XG4gICAgdmFyIHdpbGRjYXJkVHlwZUhhbmRsZXJzID0gX2hhbmRsZXJzW1wiKlwiXSB8fCBbXTtcbiAgICB2YXIgc3BlY2lmaWNUeXBlSGFuZGxlcnMgPSBfaGFuZGxlcnNbZXZlbnQudHlwZV0gfHwgW107XG4gICAgdmFyIGhhbmRsZXJzID0gd2lsZGNhcmRUeXBlSGFuZGxlcnMuY29uY2F0KHNwZWNpZmljVHlwZUhhbmRsZXJzKTtcbiAgICBpZiAoaGFuZGxlcnMgJiYgaGFuZGxlcnMubGVuZ3RoKSB7XG4gICAgICB2YXIgaSwgbGVuLCBmdW5jLCBjb250ZXh0LCBldmVudENvcHksIG9yaWdpbmFsQ29udGV4dCA9IHRoaXM7XG4gICAgICBmb3IgKGkgPSAwLCBsZW4gPSBoYW5kbGVycy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBmdW5jID0gaGFuZGxlcnNbaV07XG4gICAgICAgIGNvbnRleHQgPSBvcmlnaW5hbENvbnRleHQ7XG4gICAgICAgIGlmICh0eXBlb2YgZnVuYyA9PT0gXCJzdHJpbmdcIiAmJiB0eXBlb2YgX3dpbmRvd1tmdW5jXSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgZnVuYyA9IF93aW5kb3dbZnVuY107XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBmdW5jID09PSBcIm9iamVjdFwiICYmIGZ1bmMgJiYgdHlwZW9mIGZ1bmMuaGFuZGxlRXZlbnQgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgIGNvbnRleHQgPSBmdW5jO1xuICAgICAgICAgIGZ1bmMgPSBmdW5jLmhhbmRsZUV2ZW50O1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgZnVuYyA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgZXZlbnRDb3B5ID0gX2V4dGVuZCh7fSwgZXZlbnQpO1xuICAgICAgICAgIF9kaXNwYXRjaENhbGxiYWNrKGZ1bmMsIGNvbnRleHQsIFsgZXZlbnRDb3B5IF0sIGFzeW5jKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcbiAgLyoqXG4gKiBDaGVjayBhbiBgZXJyb3JgIGV2ZW50J3MgYG5hbWVgIHByb3BlcnR5IHRvIHNlZSBpZiBGbGFzaCBoYXNcbiAqIGFscmVhZHkgbG9hZGVkLCB3aGljaCBydWxlcyBvdXQgcG9zc2libGUgYGlmcmFtZWAgc2FuZGJveGluZy5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9nZXRTYW5kYm94U3RhdHVzRnJvbUVycm9yRXZlbnQgPSBmdW5jdGlvbihldmVudCkge1xuICAgIHZhciBpc1NhbmRib3hlZCA9IG51bGw7XG4gICAgaWYgKF9wYWdlSXNGcmFtZWQgPT09IGZhbHNlIHx8IGV2ZW50ICYmIGV2ZW50LnR5cGUgPT09IFwiZXJyb3JcIiAmJiBldmVudC5uYW1lICYmIF9lcnJvcnNUaGF0T25seU9jY3VyQWZ0ZXJGbGFzaExvYWRzLmluZGV4T2YoZXZlbnQubmFtZSkgIT09IC0xKSB7XG4gICAgICBpc1NhbmRib3hlZCA9IGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gaXNTYW5kYm94ZWQ7XG4gIH07XG4gIC8qKlxuICogUHJlcHJvY2VzcyBhbnkgc3BlY2lhbCBiZWhhdmlvcnMsIHJlYWN0aW9ucywgb3Igc3RhdGUgY2hhbmdlcyBhZnRlciByZWNlaXZpbmcgdGhpcyBldmVudC5cbiAqIEV4ZWN1dGVzIG9ubHkgb25jZSBwZXIgZXZlbnQgZW1pdHRlZCwgTk9UIG9uY2UgcGVyIGNsaWVudC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9wcmVwcm9jZXNzRXZlbnQgPSBmdW5jdGlvbihldmVudCkge1xuICAgIHZhciBlbGVtZW50ID0gZXZlbnQudGFyZ2V0IHx8IF9jdXJyZW50RWxlbWVudCB8fCBudWxsO1xuICAgIHZhciBzb3VyY2VJc1N3ZiA9IGV2ZW50Ll9zb3VyY2UgPT09IFwic3dmXCI7XG4gICAgZGVsZXRlIGV2ZW50Ll9zb3VyY2U7XG4gICAgc3dpdGNoIChldmVudC50eXBlKSB7XG4gICAgIGNhc2UgXCJlcnJvclwiOlxuICAgICAgdmFyIGlzU2FuZGJveGVkID0gZXZlbnQubmFtZSA9PT0gXCJmbGFzaC1zYW5kYm94ZWRcIiB8fCBfZ2V0U2FuZGJveFN0YXR1c0Zyb21FcnJvckV2ZW50KGV2ZW50KTtcbiAgICAgIGlmICh0eXBlb2YgaXNTYW5kYm94ZWQgPT09IFwiYm9vbGVhblwiKSB7XG4gICAgICAgIF9mbGFzaFN0YXRlLnNhbmRib3hlZCA9IGlzU2FuZGJveGVkO1xuICAgICAgfVxuICAgICAgaWYgKF9mbGFzaFN0YXRlRXJyb3JOYW1lcy5pbmRleE9mKGV2ZW50Lm5hbWUpICE9PSAtMSkge1xuICAgICAgICBfZXh0ZW5kKF9mbGFzaFN0YXRlLCB7XG4gICAgICAgICAgZGlzYWJsZWQ6IGV2ZW50Lm5hbWUgPT09IFwiZmxhc2gtZGlzYWJsZWRcIixcbiAgICAgICAgICBvdXRkYXRlZDogZXZlbnQubmFtZSA9PT0gXCJmbGFzaC1vdXRkYXRlZFwiLFxuICAgICAgICAgIHVuYXZhaWxhYmxlOiBldmVudC5uYW1lID09PSBcImZsYXNoLXVuYXZhaWxhYmxlXCIsXG4gICAgICAgICAgZGVncmFkZWQ6IGV2ZW50Lm5hbWUgPT09IFwiZmxhc2gtZGVncmFkZWRcIixcbiAgICAgICAgICBkZWFjdGl2YXRlZDogZXZlbnQubmFtZSA9PT0gXCJmbGFzaC1kZWFjdGl2YXRlZFwiLFxuICAgICAgICAgIG92ZXJkdWU6IGV2ZW50Lm5hbWUgPT09IFwiZmxhc2gtb3ZlcmR1ZVwiLFxuICAgICAgICAgIHJlYWR5OiBmYWxzZVxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSBpZiAoZXZlbnQubmFtZSA9PT0gXCJ2ZXJzaW9uLW1pc21hdGNoXCIpIHtcbiAgICAgICAgX3pjU3dmVmVyc2lvbiA9IGV2ZW50LnN3ZlZlcnNpb247XG4gICAgICAgIF9leHRlbmQoX2ZsYXNoU3RhdGUsIHtcbiAgICAgICAgICBkaXNhYmxlZDogZmFsc2UsXG4gICAgICAgICAgb3V0ZGF0ZWQ6IGZhbHNlLFxuICAgICAgICAgIHVuYXZhaWxhYmxlOiBmYWxzZSxcbiAgICAgICAgICBkZWdyYWRlZDogZmFsc2UsXG4gICAgICAgICAgZGVhY3RpdmF0ZWQ6IGZhbHNlLFxuICAgICAgICAgIG92ZXJkdWU6IGZhbHNlLFxuICAgICAgICAgIHJlYWR5OiBmYWxzZVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIF9jbGVhclRpbWVvdXRzQW5kUG9sbGluZygpO1xuICAgICAgYnJlYWs7XG5cbiAgICAgY2FzZSBcInJlYWR5XCI6XG4gICAgICBfemNTd2ZWZXJzaW9uID0gZXZlbnQuc3dmVmVyc2lvbjtcbiAgICAgIHZhciB3YXNEZWFjdGl2YXRlZCA9IF9mbGFzaFN0YXRlLmRlYWN0aXZhdGVkID09PSB0cnVlO1xuICAgICAgX2V4dGVuZChfZmxhc2hTdGF0ZSwge1xuICAgICAgICBkaXNhYmxlZDogZmFsc2UsXG4gICAgICAgIG91dGRhdGVkOiBmYWxzZSxcbiAgICAgICAgc2FuZGJveGVkOiBmYWxzZSxcbiAgICAgICAgdW5hdmFpbGFibGU6IGZhbHNlLFxuICAgICAgICBkZWdyYWRlZDogZmFsc2UsXG4gICAgICAgIGRlYWN0aXZhdGVkOiBmYWxzZSxcbiAgICAgICAgb3ZlcmR1ZTogd2FzRGVhY3RpdmF0ZWQsXG4gICAgICAgIHJlYWR5OiAhd2FzRGVhY3RpdmF0ZWRcbiAgICAgIH0pO1xuICAgICAgX2NsZWFyVGltZW91dHNBbmRQb2xsaW5nKCk7XG4gICAgICBicmVhaztcblxuICAgICBjYXNlIFwiYmVmb3JlY29weVwiOlxuICAgICAgX2NvcHlUYXJnZXQgPSBlbGVtZW50O1xuICAgICAgYnJlYWs7XG5cbiAgICAgY2FzZSBcImNvcHlcIjpcbiAgICAgIHZhciB0ZXh0Q29udGVudCwgaHRtbENvbnRlbnQsIHRhcmdldEVsID0gZXZlbnQucmVsYXRlZFRhcmdldDtcbiAgICAgIGlmICghKF9jbGlwRGF0YVtcInRleHQvaHRtbFwiXSB8fCBfY2xpcERhdGFbXCJ0ZXh0L3BsYWluXCJdKSAmJiB0YXJnZXRFbCAmJiAoaHRtbENvbnRlbnQgPSB0YXJnZXRFbC52YWx1ZSB8fCB0YXJnZXRFbC5vdXRlckhUTUwgfHwgdGFyZ2V0RWwuaW5uZXJIVE1MKSAmJiAodGV4dENvbnRlbnQgPSB0YXJnZXRFbC52YWx1ZSB8fCB0YXJnZXRFbC50ZXh0Q29udGVudCB8fCB0YXJnZXRFbC5pbm5lclRleHQpKSB7XG4gICAgICAgIGV2ZW50LmNsaXBib2FyZERhdGEuY2xlYXJEYXRhKCk7XG4gICAgICAgIGV2ZW50LmNsaXBib2FyZERhdGEuc2V0RGF0YShcInRleHQvcGxhaW5cIiwgdGV4dENvbnRlbnQpO1xuICAgICAgICBpZiAoaHRtbENvbnRlbnQgIT09IHRleHRDb250ZW50KSB7XG4gICAgICAgICAgZXZlbnQuY2xpcGJvYXJkRGF0YS5zZXREYXRhKFwidGV4dC9odG1sXCIsIGh0bWxDb250ZW50KTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmICghX2NsaXBEYXRhW1widGV4dC9wbGFpblwiXSAmJiBldmVudC50YXJnZXQgJiYgKHRleHRDb250ZW50ID0gZXZlbnQudGFyZ2V0LmdldEF0dHJpYnV0ZShcImRhdGEtY2xpcGJvYXJkLXRleHRcIikpKSB7XG4gICAgICAgIGV2ZW50LmNsaXBib2FyZERhdGEuY2xlYXJEYXRhKCk7XG4gICAgICAgIGV2ZW50LmNsaXBib2FyZERhdGEuc2V0RGF0YShcInRleHQvcGxhaW5cIiwgdGV4dENvbnRlbnQpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG5cbiAgICAgY2FzZSBcImFmdGVyY29weVwiOlxuICAgICAgX3F1ZXVlRW1pdENsaXBib2FyZEVycm9ycyhldmVudCk7XG4gICAgICBaZXJvQ2xpcGJvYXJkLmNsZWFyRGF0YSgpO1xuICAgICAgaWYgKGVsZW1lbnQgJiYgZWxlbWVudCAhPT0gX3NhZmVBY3RpdmVFbGVtZW50KCkgJiYgZWxlbWVudC5mb2N1cykge1xuICAgICAgICBlbGVtZW50LmZvY3VzKCk7XG4gICAgICB9XG4gICAgICBicmVhaztcblxuICAgICBjYXNlIFwiX21vdXNlb3ZlclwiOlxuICAgICAgWmVyb0NsaXBib2FyZC5mb2N1cyhlbGVtZW50KTtcbiAgICAgIGlmIChfZ2xvYmFsQ29uZmlnLmJ1YmJsZUV2ZW50cyA9PT0gdHJ1ZSAmJiBzb3VyY2VJc1N3Zikge1xuICAgICAgICBpZiAoZWxlbWVudCAmJiBlbGVtZW50ICE9PSBldmVudC5yZWxhdGVkVGFyZ2V0ICYmICFfY29udGFpbmVkQnkoZXZlbnQucmVsYXRlZFRhcmdldCwgZWxlbWVudCkpIHtcbiAgICAgICAgICBfZmlyZU1vdXNlRXZlbnQoX2V4dGVuZCh7fSwgZXZlbnQsIHtcbiAgICAgICAgICAgIHR5cGU6IFwibW91c2VlbnRlclwiLFxuICAgICAgICAgICAgYnViYmxlczogZmFsc2UsXG4gICAgICAgICAgICBjYW5jZWxhYmxlOiBmYWxzZVxuICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBfZmlyZU1vdXNlRXZlbnQoX2V4dGVuZCh7fSwgZXZlbnQsIHtcbiAgICAgICAgICB0eXBlOiBcIm1vdXNlb3ZlclwiXG4gICAgICAgIH0pKTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuXG4gICAgIGNhc2UgXCJfbW91c2VvdXRcIjpcbiAgICAgIFplcm9DbGlwYm9hcmQuYmx1cigpO1xuICAgICAgaWYgKF9nbG9iYWxDb25maWcuYnViYmxlRXZlbnRzID09PSB0cnVlICYmIHNvdXJjZUlzU3dmKSB7XG4gICAgICAgIGlmIChlbGVtZW50ICYmIGVsZW1lbnQgIT09IGV2ZW50LnJlbGF0ZWRUYXJnZXQgJiYgIV9jb250YWluZWRCeShldmVudC5yZWxhdGVkVGFyZ2V0LCBlbGVtZW50KSkge1xuICAgICAgICAgIF9maXJlTW91c2VFdmVudChfZXh0ZW5kKHt9LCBldmVudCwge1xuICAgICAgICAgICAgdHlwZTogXCJtb3VzZWxlYXZlXCIsXG4gICAgICAgICAgICBidWJibGVzOiBmYWxzZSxcbiAgICAgICAgICAgIGNhbmNlbGFibGU6IGZhbHNlXG4gICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIF9maXJlTW91c2VFdmVudChfZXh0ZW5kKHt9LCBldmVudCwge1xuICAgICAgICAgIHR5cGU6IFwibW91c2VvdXRcIlxuICAgICAgICB9KSk7XG4gICAgICB9XG4gICAgICBicmVhaztcblxuICAgICBjYXNlIFwiX21vdXNlZG93blwiOlxuICAgICAgX2FkZENsYXNzKGVsZW1lbnQsIF9nbG9iYWxDb25maWcuYWN0aXZlQ2xhc3MpO1xuICAgICAgaWYgKF9nbG9iYWxDb25maWcuYnViYmxlRXZlbnRzID09PSB0cnVlICYmIHNvdXJjZUlzU3dmKSB7XG4gICAgICAgIF9maXJlTW91c2VFdmVudChfZXh0ZW5kKHt9LCBldmVudCwge1xuICAgICAgICAgIHR5cGU6IGV2ZW50LnR5cGUuc2xpY2UoMSlcbiAgICAgICAgfSkpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG5cbiAgICAgY2FzZSBcIl9tb3VzZXVwXCI6XG4gICAgICBfcmVtb3ZlQ2xhc3MoZWxlbWVudCwgX2dsb2JhbENvbmZpZy5hY3RpdmVDbGFzcyk7XG4gICAgICBpZiAoX2dsb2JhbENvbmZpZy5idWJibGVFdmVudHMgPT09IHRydWUgJiYgc291cmNlSXNTd2YpIHtcbiAgICAgICAgX2ZpcmVNb3VzZUV2ZW50KF9leHRlbmQoe30sIGV2ZW50LCB7XG4gICAgICAgICAgdHlwZTogZXZlbnQudHlwZS5zbGljZSgxKVxuICAgICAgICB9KSk7XG4gICAgICB9XG4gICAgICBicmVhaztcblxuICAgICBjYXNlIFwiX2NsaWNrXCI6XG4gICAgICBfY29weVRhcmdldCA9IG51bGw7XG4gICAgICBpZiAoX2dsb2JhbENvbmZpZy5idWJibGVFdmVudHMgPT09IHRydWUgJiYgc291cmNlSXNTd2YpIHtcbiAgICAgICAgX2ZpcmVNb3VzZUV2ZW50KF9leHRlbmQoe30sIGV2ZW50LCB7XG4gICAgICAgICAgdHlwZTogZXZlbnQudHlwZS5zbGljZSgxKVxuICAgICAgICB9KSk7XG4gICAgICB9XG4gICAgICBicmVhaztcblxuICAgICBjYXNlIFwiX21vdXNlbW92ZVwiOlxuICAgICAgaWYgKF9nbG9iYWxDb25maWcuYnViYmxlRXZlbnRzID09PSB0cnVlICYmIHNvdXJjZUlzU3dmKSB7XG4gICAgICAgIF9maXJlTW91c2VFdmVudChfZXh0ZW5kKHt9LCBldmVudCwge1xuICAgICAgICAgIHR5cGU6IGV2ZW50LnR5cGUuc2xpY2UoMSlcbiAgICAgICAgfSkpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gICAgfVxuICAgIGlmICgvXl8oPzpjbGlja3xtb3VzZSg/Om92ZXJ8b3V0fGRvd258dXB8bW92ZSkpJC8udGVzdChldmVudC50eXBlKSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9O1xuICAvKipcbiAqIENoZWNrIGFuIFwiYWZ0ZXJjb3B5XCIgZXZlbnQgZm9yIGNsaXBib2FyZCBlcnJvcnMgYW5kIGVtaXQgYSBjb3JyZXNwb25kaW5nIFwiZXJyb3JcIiBldmVudC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9xdWV1ZUVtaXRDbGlwYm9hcmRFcnJvcnMgPSBmdW5jdGlvbihhZnRlcmNvcHlFdmVudCkge1xuICAgIGlmIChhZnRlcmNvcHlFdmVudC5lcnJvcnMgJiYgYWZ0ZXJjb3B5RXZlbnQuZXJyb3JzLmxlbmd0aCA+IDApIHtcbiAgICAgIHZhciBlcnJvckV2ZW50ID0gX2RlZXBDb3B5KGFmdGVyY29weUV2ZW50KTtcbiAgICAgIF9leHRlbmQoZXJyb3JFdmVudCwge1xuICAgICAgICB0eXBlOiBcImVycm9yXCIsXG4gICAgICAgIG5hbWU6IFwiY2xpcGJvYXJkLWVycm9yXCJcbiAgICAgIH0pO1xuICAgICAgZGVsZXRlIGVycm9yRXZlbnQuc3VjY2VzcztcbiAgICAgIF9zZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICBaZXJvQ2xpcGJvYXJkLmVtaXQoZXJyb3JFdmVudCk7XG4gICAgICB9LCAwKTtcbiAgICB9XG4gIH07XG4gIC8qKlxuICogRGlzcGF0Y2ggYSBzeW50aGV0aWMgTW91c2VFdmVudC5cbiAqXG4gKiBAcmV0dXJucyBgdW5kZWZpbmVkYFxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2ZpcmVNb3VzZUV2ZW50ID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICBpZiAoIShldmVudCAmJiB0eXBlb2YgZXZlbnQudHlwZSA9PT0gXCJzdHJpbmdcIiAmJiBldmVudCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIGUsIHRhcmdldCA9IGV2ZW50LnRhcmdldCB8fCBudWxsLCBkb2MgPSB0YXJnZXQgJiYgdGFyZ2V0Lm93bmVyRG9jdW1lbnQgfHwgX2RvY3VtZW50LCBkZWZhdWx0cyA9IHtcbiAgICAgIHZpZXc6IGRvYy5kZWZhdWx0VmlldyB8fCBfd2luZG93LFxuICAgICAgY2FuQnViYmxlOiB0cnVlLFxuICAgICAgY2FuY2VsYWJsZTogdHJ1ZSxcbiAgICAgIGRldGFpbDogZXZlbnQudHlwZSA9PT0gXCJjbGlja1wiID8gMSA6IDAsXG4gICAgICBidXR0b246IHR5cGVvZiBldmVudC53aGljaCA9PT0gXCJudW1iZXJcIiA/IGV2ZW50LndoaWNoIC0gMSA6IHR5cGVvZiBldmVudC5idXR0b24gPT09IFwibnVtYmVyXCIgPyBldmVudC5idXR0b24gOiBkb2MuY3JlYXRlRXZlbnQgPyAwIDogMVxuICAgIH0sIGFyZ3MgPSBfZXh0ZW5kKGRlZmF1bHRzLCBldmVudCk7XG4gICAgaWYgKCF0YXJnZXQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGRvYy5jcmVhdGVFdmVudCAmJiB0YXJnZXQuZGlzcGF0Y2hFdmVudCkge1xuICAgICAgYXJncyA9IFsgYXJncy50eXBlLCBhcmdzLmNhbkJ1YmJsZSwgYXJncy5jYW5jZWxhYmxlLCBhcmdzLnZpZXcsIGFyZ3MuZGV0YWlsLCBhcmdzLnNjcmVlblgsIGFyZ3Muc2NyZWVuWSwgYXJncy5jbGllbnRYLCBhcmdzLmNsaWVudFksIGFyZ3MuY3RybEtleSwgYXJncy5hbHRLZXksIGFyZ3Muc2hpZnRLZXksIGFyZ3MubWV0YUtleSwgYXJncy5idXR0b24sIGFyZ3MucmVsYXRlZFRhcmdldCBdO1xuICAgICAgZSA9IGRvYy5jcmVhdGVFdmVudChcIk1vdXNlRXZlbnRzXCIpO1xuICAgICAgaWYgKGUuaW5pdE1vdXNlRXZlbnQpIHtcbiAgICAgICAgZS5pbml0TW91c2VFdmVudC5hcHBseShlLCBhcmdzKTtcbiAgICAgICAgZS5fc291cmNlID0gXCJqc1wiO1xuICAgICAgICB0YXJnZXQuZGlzcGF0Y2hFdmVudChlKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG4gIC8qKlxuICogQ29udGludW91c2x5IHBvbGwgdGhlIERPTSB1bnRpbCBlaXRoZXI6XG4gKiAgKGEpIHRoZSBmYWxsYmFjayBjb250ZW50IGJlY29tZXMgdmlzaWJsZSwgb3JcbiAqICAoYikgd2UgcmVjZWl2ZSBhbiBldmVudCBmcm9tIFNXRiAoaGFuZGxlZCBlbHNld2hlcmUpXG4gKlxuICogSU1QT1JUQU5UOlxuICogVGhpcyBpcyBOT1QgYSBuZWNlc3NhcnkgY2hlY2sgYnV0IGl0IGNhbiByZXN1bHQgaW4gc2lnbmlmaWNhbnRseSBmYXN0ZXJcbiAqIGRldGVjdGlvbiBvZiBiYWQgYHN3ZlBhdGhgIGNvbmZpZ3VyYXRpb24gYW5kL29yIG5ldHdvcmsvc2VydmVyIGlzc3VlcyBbaW5cbiAqIHN1cHBvcnRlZCBicm93c2Vyc10gdGhhbiB3YWl0aW5nIGZvciB0aGUgZW50aXJlIGBmbGFzaExvYWRUaW1lb3V0YCBkdXJhdGlvblxuICogdG8gZWxhcHNlIGJlZm9yZSBkZXRlY3RpbmcgdGhhdCB0aGUgU1dGIGNhbm5vdCBiZSBsb2FkZWQuIFRoZSBkZXRlY3Rpb25cbiAqIGR1cmF0aW9uIGNhbiBiZSBhbnl3aGVyZSBmcm9tIDEwLTMwIHRpbWVzIGZhc3RlciBbaW4gc3VwcG9ydGVkIGJyb3dzZXJzXSBieVxuICogdXNpbmcgdGhpcyBhcHByb2FjaC5cbiAqXG4gKiBAcmV0dXJucyBgdW5kZWZpbmVkYFxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX3dhdGNoRm9yU3dmRmFsbGJhY2tDb250ZW50ID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIG1heFdhaXQgPSBfZ2xvYmFsQ29uZmlnLmZsYXNoTG9hZFRpbWVvdXQ7XG4gICAgaWYgKHR5cGVvZiBtYXhXYWl0ID09PSBcIm51bWJlclwiICYmIG1heFdhaXQgPj0gMCkge1xuICAgICAgdmFyIHBvbGxXYWl0ID0gTWF0aC5taW4oMWUzLCBtYXhXYWl0IC8gMTApO1xuICAgICAgdmFyIGZhbGxiYWNrQ29udGVudElkID0gX2dsb2JhbENvbmZpZy5zd2ZPYmplY3RJZCArIFwiX2ZhbGxiYWNrQ29udGVudFwiO1xuICAgICAgX3N3ZkZhbGxiYWNrQ2hlY2tJbnRlcnZhbCA9IF9zZXRJbnRlcnZhbChmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGVsID0gX2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKGZhbGxiYWNrQ29udGVudElkKTtcbiAgICAgICAgaWYgKF9pc0VsZW1lbnRWaXNpYmxlKGVsKSkge1xuICAgICAgICAgIF9jbGVhclRpbWVvdXRzQW5kUG9sbGluZygpO1xuICAgICAgICAgIF9mbGFzaFN0YXRlLmRlYWN0aXZhdGVkID0gbnVsbDtcbiAgICAgICAgICBaZXJvQ2xpcGJvYXJkLmVtaXQoe1xuICAgICAgICAgICAgdHlwZTogXCJlcnJvclwiLFxuICAgICAgICAgICAgbmFtZTogXCJzd2Ytbm90LWZvdW5kXCJcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSwgcG9sbFdhaXQpO1xuICAgIH1cbiAgfTtcbiAgLyoqXG4gKiBDcmVhdGUgdGhlIEhUTUwgYnJpZGdlIGVsZW1lbnQgdG8gZW1iZWQgdGhlIEZsYXNoIG9iamVjdCBpbnRvLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2NyZWF0ZUh0bWxCcmlkZ2UgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgY29udGFpbmVyID0gX2RvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgY29udGFpbmVyLmlkID0gX2dsb2JhbENvbmZpZy5jb250YWluZXJJZDtcbiAgICBjb250YWluZXIuY2xhc3NOYW1lID0gX2dsb2JhbENvbmZpZy5jb250YWluZXJDbGFzcztcbiAgICBjb250YWluZXIuc3R5bGUucG9zaXRpb24gPSBcImFic29sdXRlXCI7XG4gICAgY29udGFpbmVyLnN0eWxlLmxlZnQgPSBcIjBweFwiO1xuICAgIGNvbnRhaW5lci5zdHlsZS50b3AgPSBcIi05OTk5cHhcIjtcbiAgICBjb250YWluZXIuc3R5bGUud2lkdGggPSBcIjFweFwiO1xuICAgIGNvbnRhaW5lci5zdHlsZS5oZWlnaHQgPSBcIjFweFwiO1xuICAgIGNvbnRhaW5lci5zdHlsZS56SW5kZXggPSBcIlwiICsgX2dldFNhZmVaSW5kZXgoX2dsb2JhbENvbmZpZy56SW5kZXgpO1xuICAgIHJldHVybiBjb250YWluZXI7XG4gIH07XG4gIC8qKlxuICogR2V0IHRoZSBIVE1MIGVsZW1lbnQgY29udGFpbmVyIHRoYXQgd3JhcHMgdGhlIEZsYXNoIGJyaWRnZSBvYmplY3QvZWxlbWVudC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9nZXRIdG1sQnJpZGdlID0gZnVuY3Rpb24oZmxhc2hCcmlkZ2UpIHtcbiAgICB2YXIgaHRtbEJyaWRnZSA9IGZsYXNoQnJpZGdlICYmIGZsYXNoQnJpZGdlLnBhcmVudE5vZGU7XG4gICAgd2hpbGUgKGh0bWxCcmlkZ2UgJiYgaHRtbEJyaWRnZS5ub2RlTmFtZSA9PT0gXCJPQkpFQ1RcIiAmJiBodG1sQnJpZGdlLnBhcmVudE5vZGUpIHtcbiAgICAgIGh0bWxCcmlkZ2UgPSBodG1sQnJpZGdlLnBhcmVudE5vZGU7XG4gICAgfVxuICAgIHJldHVybiBodG1sQnJpZGdlIHx8IG51bGw7XG4gIH07XG4gIC8qKlxuICogQ3JlYXRlIHRoZSBTV0Ygb2JqZWN0LlxuICpcbiAqIEByZXR1cm5zIFRoZSBTV0Ygb2JqZWN0IHJlZmVyZW5jZS5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9lbWJlZFN3ZiA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBsZW4sIGZsYXNoQnJpZGdlID0gX2ZsYXNoU3RhdGUuYnJpZGdlLCBjb250YWluZXIgPSBfZ2V0SHRtbEJyaWRnZShmbGFzaEJyaWRnZSk7XG4gICAgaWYgKCFmbGFzaEJyaWRnZSkge1xuICAgICAgdmFyIGFsbG93U2NyaXB0QWNjZXNzID0gX2RldGVybWluZVNjcmlwdEFjY2Vzcyhfd2luZG93LmxvY2F0aW9uLmhvc3QsIF9nbG9iYWxDb25maWcpO1xuICAgICAgdmFyIGFsbG93TmV0d29ya2luZyA9IGFsbG93U2NyaXB0QWNjZXNzID09PSBcIm5ldmVyXCIgPyBcIm5vbmVcIiA6IFwiYWxsXCI7XG4gICAgICB2YXIgZmxhc2h2YXJzID0gX3ZhcnMoX2V4dGVuZCh7XG4gICAgICAgIGpzVmVyc2lvbjogWmVyb0NsaXBib2FyZC52ZXJzaW9uXG4gICAgICB9LCBfZ2xvYmFsQ29uZmlnKSk7XG4gICAgICB2YXIgc3dmVXJsID0gX2dsb2JhbENvbmZpZy5zd2ZQYXRoICsgX2NhY2hlQnVzdChfZ2xvYmFsQ29uZmlnLnN3ZlBhdGgsIF9nbG9iYWxDb25maWcpO1xuICAgICAgY29udGFpbmVyID0gX2NyZWF0ZUh0bWxCcmlkZ2UoKTtcbiAgICAgIHZhciBkaXZUb0JlUmVwbGFjZWQgPSBfZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChkaXZUb0JlUmVwbGFjZWQpO1xuICAgICAgX2RvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoY29udGFpbmVyKTtcbiAgICAgIHZhciB0bXBEaXYgPSBfZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgIHZhciB1c2luZ0FjdGl2ZVggPSBfZmxhc2hTdGF0ZS5wbHVnaW5UeXBlID09PSBcImFjdGl2ZXhcIjtcbiAgICAgIHRtcERpdi5pbm5lckhUTUwgPSAnPG9iamVjdCBpZD1cIicgKyBfZ2xvYmFsQ29uZmlnLnN3Zk9iamVjdElkICsgJ1wiIG5hbWU9XCInICsgX2dsb2JhbENvbmZpZy5zd2ZPYmplY3RJZCArICdcIiAnICsgJ3dpZHRoPVwiMTAwJVwiIGhlaWdodD1cIjEwMCVcIiAnICsgKHVzaW5nQWN0aXZlWCA/ICdjbGFzc2lkPVwiY2xzaWQ6ZDI3Y2RiNmUtYWU2ZC0xMWNmLTk2YjgtNDQ0NTUzNTQwMDAwXCInIDogJ3R5cGU9XCJhcHBsaWNhdGlvbi94LXNob2Nrd2F2ZS1mbGFzaFwiIGRhdGE9XCInICsgc3dmVXJsICsgJ1wiJykgKyBcIj5cIiArICh1c2luZ0FjdGl2ZVggPyAnPHBhcmFtIG5hbWU9XCJtb3ZpZVwiIHZhbHVlPVwiJyArIHN3ZlVybCArICdcIi8+JyA6IFwiXCIpICsgJzxwYXJhbSBuYW1lPVwiYWxsb3dTY3JpcHRBY2Nlc3NcIiB2YWx1ZT1cIicgKyBhbGxvd1NjcmlwdEFjY2VzcyArICdcIi8+JyArICc8cGFyYW0gbmFtZT1cImFsbG93TmV0d29ya2luZ1wiIHZhbHVlPVwiJyArIGFsbG93TmV0d29ya2luZyArICdcIi8+JyArICc8cGFyYW0gbmFtZT1cIm1lbnVcIiB2YWx1ZT1cImZhbHNlXCIvPicgKyAnPHBhcmFtIG5hbWU9XCJ3bW9kZVwiIHZhbHVlPVwidHJhbnNwYXJlbnRcIi8+JyArICc8cGFyYW0gbmFtZT1cImZsYXNodmFyc1wiIHZhbHVlPVwiJyArIGZsYXNodmFycyArICdcIi8+JyArICc8ZGl2IGlkPVwiJyArIF9nbG9iYWxDb25maWcuc3dmT2JqZWN0SWQgKyAnX2ZhbGxiYWNrQ29udGVudFwiPiZuYnNwOzwvZGl2PicgKyBcIjwvb2JqZWN0PlwiO1xuICAgICAgZmxhc2hCcmlkZ2UgPSB0bXBEaXYuZmlyc3RDaGlsZDtcbiAgICAgIHRtcERpdiA9IG51bGw7XG4gICAgICBfdW53cmFwKGZsYXNoQnJpZGdlKS5aZXJvQ2xpcGJvYXJkID0gWmVyb0NsaXBib2FyZDtcbiAgICAgIGNvbnRhaW5lci5yZXBsYWNlQ2hpbGQoZmxhc2hCcmlkZ2UsIGRpdlRvQmVSZXBsYWNlZCk7XG4gICAgICBfd2F0Y2hGb3JTd2ZGYWxsYmFja0NvbnRlbnQoKTtcbiAgICB9XG4gICAgaWYgKCFmbGFzaEJyaWRnZSkge1xuICAgICAgZmxhc2hCcmlkZ2UgPSBfZG9jdW1lbnRbX2dsb2JhbENvbmZpZy5zd2ZPYmplY3RJZF07XG4gICAgICBpZiAoZmxhc2hCcmlkZ2UgJiYgKGxlbiA9IGZsYXNoQnJpZGdlLmxlbmd0aCkpIHtcbiAgICAgICAgZmxhc2hCcmlkZ2UgPSBmbGFzaEJyaWRnZVtsZW4gLSAxXTtcbiAgICAgIH1cbiAgICAgIGlmICghZmxhc2hCcmlkZ2UgJiYgY29udGFpbmVyKSB7XG4gICAgICAgIGZsYXNoQnJpZGdlID0gY29udGFpbmVyLmZpcnN0Q2hpbGQ7XG4gICAgICB9XG4gICAgfVxuICAgIF9mbGFzaFN0YXRlLmJyaWRnZSA9IGZsYXNoQnJpZGdlIHx8IG51bGw7XG4gICAgcmV0dXJuIGZsYXNoQnJpZGdlO1xuICB9O1xuICAvKipcbiAqIERlc3Ryb3kgdGhlIFNXRiBvYmplY3QuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfdW5lbWJlZFN3ZiA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBmbGFzaEJyaWRnZSA9IF9mbGFzaFN0YXRlLmJyaWRnZTtcbiAgICBpZiAoZmxhc2hCcmlkZ2UpIHtcbiAgICAgIHZhciBodG1sQnJpZGdlID0gX2dldEh0bWxCcmlkZ2UoZmxhc2hCcmlkZ2UpO1xuICAgICAgaWYgKGh0bWxCcmlkZ2UpIHtcbiAgICAgICAgaWYgKF9mbGFzaFN0YXRlLnBsdWdpblR5cGUgPT09IFwiYWN0aXZleFwiICYmIFwicmVhZHlTdGF0ZVwiIGluIGZsYXNoQnJpZGdlKSB7XG4gICAgICAgICAgZmxhc2hCcmlkZ2Uuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgICAgICAgIChmdW5jdGlvbiByZW1vdmVTd2ZGcm9tSUUoKSB7XG4gICAgICAgICAgICBpZiAoZmxhc2hCcmlkZ2UucmVhZHlTdGF0ZSA9PT0gNCkge1xuICAgICAgICAgICAgICBmb3IgKHZhciBwcm9wIGluIGZsYXNoQnJpZGdlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBmbGFzaEJyaWRnZVtwcm9wXSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgICBmbGFzaEJyaWRnZVtwcm9wXSA9IG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGlmIChmbGFzaEJyaWRnZS5wYXJlbnROb2RlKSB7XG4gICAgICAgICAgICAgICAgZmxhc2hCcmlkZ2UucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChmbGFzaEJyaWRnZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgaWYgKGh0bWxCcmlkZ2UucGFyZW50Tm9kZSkge1xuICAgICAgICAgICAgICAgIGh0bWxCcmlkZ2UucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChodG1sQnJpZGdlKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgX3NldFRpbWVvdXQocmVtb3ZlU3dmRnJvbUlFLCAxMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSkoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAoZmxhc2hCcmlkZ2UucGFyZW50Tm9kZSkge1xuICAgICAgICAgICAgZmxhc2hCcmlkZ2UucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChmbGFzaEJyaWRnZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChodG1sQnJpZGdlLnBhcmVudE5vZGUpIHtcbiAgICAgICAgICAgIGh0bWxCcmlkZ2UucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChodG1sQnJpZGdlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIF9jbGVhclRpbWVvdXRzQW5kUG9sbGluZygpO1xuICAgICAgX2ZsYXNoU3RhdGUucmVhZHkgPSBudWxsO1xuICAgICAgX2ZsYXNoU3RhdGUuYnJpZGdlID0gbnVsbDtcbiAgICAgIF9mbGFzaFN0YXRlLmRlYWN0aXZhdGVkID0gbnVsbDtcbiAgICAgIF96Y1N3ZlZlcnNpb24gPSB1bmRlZmluZWQ7XG4gICAgfVxuICB9O1xuICAvKipcbiAqIE1hcCB0aGUgZGF0YSBmb3JtYXQgbmFtZXMgb2YgdGhlIFwiY2xpcERhdGFcIiB0byBGbGFzaC1mcmllbmRseSBuYW1lcy5cbiAqXG4gKiBAcmV0dXJucyBBIG5ldyB0cmFuc2Zvcm1lZCBvYmplY3QuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfbWFwQ2xpcERhdGFUb0ZsYXNoID0gZnVuY3Rpb24oY2xpcERhdGEpIHtcbiAgICB2YXIgbmV3Q2xpcERhdGEgPSB7fSwgZm9ybWF0TWFwID0ge307XG4gICAgaWYgKCEodHlwZW9mIGNsaXBEYXRhID09PSBcIm9iamVjdFwiICYmIGNsaXBEYXRhKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBmb3IgKHZhciBkYXRhRm9ybWF0IGluIGNsaXBEYXRhKSB7XG4gICAgICBpZiAoZGF0YUZvcm1hdCAmJiBfaGFzT3duLmNhbGwoY2xpcERhdGEsIGRhdGFGb3JtYXQpICYmIHR5cGVvZiBjbGlwRGF0YVtkYXRhRm9ybWF0XSA9PT0gXCJzdHJpbmdcIiAmJiBjbGlwRGF0YVtkYXRhRm9ybWF0XSkge1xuICAgICAgICBzd2l0Y2ggKGRhdGFGb3JtYXQudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgY2FzZSBcInRleHQvcGxhaW5cIjpcbiAgICAgICAgIGNhc2UgXCJ0ZXh0XCI6XG4gICAgICAgICBjYXNlIFwiYWlyOnRleHRcIjpcbiAgICAgICAgIGNhc2UgXCJmbGFzaDp0ZXh0XCI6XG4gICAgICAgICAgbmV3Q2xpcERhdGEudGV4dCA9IGNsaXBEYXRhW2RhdGFGb3JtYXRdO1xuICAgICAgICAgIGZvcm1hdE1hcC50ZXh0ID0gZGF0YUZvcm1hdDtcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICAgY2FzZSBcInRleHQvaHRtbFwiOlxuICAgICAgICAgY2FzZSBcImh0bWxcIjpcbiAgICAgICAgIGNhc2UgXCJhaXI6aHRtbFwiOlxuICAgICAgICAgY2FzZSBcImZsYXNoOmh0bWxcIjpcbiAgICAgICAgICBuZXdDbGlwRGF0YS5odG1sID0gY2xpcERhdGFbZGF0YUZvcm1hdF07XG4gICAgICAgICAgZm9ybWF0TWFwLmh0bWwgPSBkYXRhRm9ybWF0O1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICBjYXNlIFwiYXBwbGljYXRpb24vcnRmXCI6XG4gICAgICAgICBjYXNlIFwidGV4dC9ydGZcIjpcbiAgICAgICAgIGNhc2UgXCJydGZcIjpcbiAgICAgICAgIGNhc2UgXCJyaWNodGV4dFwiOlxuICAgICAgICAgY2FzZSBcImFpcjpydGZcIjpcbiAgICAgICAgIGNhc2UgXCJmbGFzaDpydGZcIjpcbiAgICAgICAgICBuZXdDbGlwRGF0YS5ydGYgPSBjbGlwRGF0YVtkYXRhRm9ybWF0XTtcbiAgICAgICAgICBmb3JtYXRNYXAucnRmID0gZGF0YUZvcm1hdDtcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgZGF0YTogbmV3Q2xpcERhdGEsXG4gICAgICBmb3JtYXRNYXA6IGZvcm1hdE1hcFxuICAgIH07XG4gIH07XG4gIC8qKlxuICogTWFwIHRoZSBkYXRhIGZvcm1hdCBuYW1lcyBmcm9tIEZsYXNoLWZyaWVuZGx5IG5hbWVzIGJhY2sgdG8gdGhlaXIgb3JpZ2luYWwgXCJjbGlwRGF0YVwiIG5hbWVzICh2aWEgYSBmb3JtYXQgbWFwcGluZykuXG4gKlxuICogQHJldHVybnMgQSBuZXcgdHJhbnNmb3JtZWQgb2JqZWN0LlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX21hcENsaXBSZXN1bHRzRnJvbUZsYXNoID0gZnVuY3Rpb24oY2xpcFJlc3VsdHMsIGZvcm1hdE1hcCkge1xuICAgIGlmICghKHR5cGVvZiBjbGlwUmVzdWx0cyA9PT0gXCJvYmplY3RcIiAmJiBjbGlwUmVzdWx0cyAmJiB0eXBlb2YgZm9ybWF0TWFwID09PSBcIm9iamVjdFwiICYmIGZvcm1hdE1hcCkpIHtcbiAgICAgIHJldHVybiBjbGlwUmVzdWx0cztcbiAgICB9XG4gICAgdmFyIG5ld1Jlc3VsdHMgPSB7fTtcbiAgICBmb3IgKHZhciBwcm9wIGluIGNsaXBSZXN1bHRzKSB7XG4gICAgICBpZiAoX2hhc093bi5jYWxsKGNsaXBSZXN1bHRzLCBwcm9wKSkge1xuICAgICAgICBpZiAocHJvcCA9PT0gXCJlcnJvcnNcIikge1xuICAgICAgICAgIG5ld1Jlc3VsdHNbcHJvcF0gPSBjbGlwUmVzdWx0c1twcm9wXSA/IGNsaXBSZXN1bHRzW3Byb3BdLnNsaWNlKCkgOiBbXTtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gbmV3UmVzdWx0c1twcm9wXS5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgbmV3UmVzdWx0c1twcm9wXVtpXS5mb3JtYXQgPSBmb3JtYXRNYXBbbmV3UmVzdWx0c1twcm9wXVtpXS5mb3JtYXRdO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChwcm9wICE9PSBcInN1Y2Nlc3NcIiAmJiBwcm9wICE9PSBcImRhdGFcIikge1xuICAgICAgICAgIG5ld1Jlc3VsdHNbcHJvcF0gPSBjbGlwUmVzdWx0c1twcm9wXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBuZXdSZXN1bHRzW3Byb3BdID0ge307XG4gICAgICAgICAgdmFyIHRtcEhhc2ggPSBjbGlwUmVzdWx0c1twcm9wXTtcbiAgICAgICAgICBmb3IgKHZhciBkYXRhRm9ybWF0IGluIHRtcEhhc2gpIHtcbiAgICAgICAgICAgIGlmIChkYXRhRm9ybWF0ICYmIF9oYXNPd24uY2FsbCh0bXBIYXNoLCBkYXRhRm9ybWF0KSAmJiBfaGFzT3duLmNhbGwoZm9ybWF0TWFwLCBkYXRhRm9ybWF0KSkge1xuICAgICAgICAgICAgICBuZXdSZXN1bHRzW3Byb3BdW2Zvcm1hdE1hcFtkYXRhRm9ybWF0XV0gPSB0bXBIYXNoW2RhdGFGb3JtYXRdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbmV3UmVzdWx0cztcbiAgfTtcbiAgLyoqXG4gKiBXaWxsIGxvb2sgYXQgYSBwYXRoLCBhbmQgd2lsbCBjcmVhdGUgYSBcIj9ub0NhY2hlPXt0aW1lfVwiIG9yIFwiJm5vQ2FjaGU9e3RpbWV9XCJcbiAqIHF1ZXJ5IHBhcmFtIHN0cmluZyB0byByZXR1cm4uIERvZXMgTk9UIGFwcGVuZCB0aGF0IHN0cmluZyB0byB0aGUgb3JpZ2luYWwgcGF0aC5cbiAqIFRoaXMgaXMgdXNlZnVsIGJlY2F1c2UgRXh0ZXJuYWxJbnRlcmZhY2Ugb2Z0ZW4gYnJlYWtzIHdoZW4gYSBGbGFzaCBTV0YgaXMgY2FjaGVkLlxuICpcbiAqIEByZXR1cm5zIFRoZSBgbm9DYWNoZWAgcXVlcnkgcGFyYW0gd2l0aCBuZWNlc3NhcnkgXCI/XCIvXCImXCIgcHJlZml4LlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2NhY2hlQnVzdCA9IGZ1bmN0aW9uKHBhdGgsIG9wdGlvbnMpIHtcbiAgICB2YXIgY2FjaGVCdXN0ID0gb3B0aW9ucyA9PSBudWxsIHx8IG9wdGlvbnMgJiYgb3B0aW9ucy5jYWNoZUJ1c3QgPT09IHRydWU7XG4gICAgaWYgKGNhY2hlQnVzdCkge1xuICAgICAgcmV0dXJuIChwYXRoLmluZGV4T2YoXCI/XCIpID09PSAtMSA/IFwiP1wiIDogXCImXCIpICsgXCJub0NhY2hlPVwiICsgX25vdygpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gXCJcIjtcbiAgICB9XG4gIH07XG4gIC8qKlxuICogQ3JlYXRlcyBhIHF1ZXJ5IHN0cmluZyBmb3IgdGhlIEZsYXNoVmFycyBwYXJhbS5cbiAqIERvZXMgTk9UIGluY2x1ZGUgdGhlIGNhY2hlLWJ1c3RpbmcgcXVlcnkgcGFyYW0uXG4gKlxuICogQHJldHVybnMgRmxhc2hWYXJzIHF1ZXJ5IHN0cmluZ1xuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX3ZhcnMgPSBmdW5jdGlvbihvcHRpb25zKSB7XG4gICAgdmFyIGksIGxlbiwgZG9tYWluLCBkb21haW5zLCBzdHIgPSBcIlwiLCB0cnVzdGVkT3JpZ2luc0V4cGFuZGVkID0gW107XG4gICAgaWYgKG9wdGlvbnMudHJ1c3RlZERvbWFpbnMpIHtcbiAgICAgIGlmICh0eXBlb2Ygb3B0aW9ucy50cnVzdGVkRG9tYWlucyA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICBkb21haW5zID0gWyBvcHRpb25zLnRydXN0ZWREb21haW5zIF07XG4gICAgICB9IGVsc2UgaWYgKHR5cGVvZiBvcHRpb25zLnRydXN0ZWREb21haW5zID09PSBcIm9iamVjdFwiICYmIFwibGVuZ3RoXCIgaW4gb3B0aW9ucy50cnVzdGVkRG9tYWlucykge1xuICAgICAgICBkb21haW5zID0gb3B0aW9ucy50cnVzdGVkRG9tYWlucztcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGRvbWFpbnMgJiYgZG9tYWlucy5sZW5ndGgpIHtcbiAgICAgIGZvciAoaSA9IDAsIGxlbiA9IGRvbWFpbnMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgaWYgKF9oYXNPd24uY2FsbChkb21haW5zLCBpKSAmJiBkb21haW5zW2ldICYmIHR5cGVvZiBkb21haW5zW2ldID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgZG9tYWluID0gX2V4dHJhY3REb21haW4oZG9tYWluc1tpXSk7XG4gICAgICAgICAgaWYgKCFkb21haW4pIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoZG9tYWluID09PSBcIipcIikge1xuICAgICAgICAgICAgdHJ1c3RlZE9yaWdpbnNFeHBhbmRlZC5sZW5ndGggPSAwO1xuICAgICAgICAgICAgdHJ1c3RlZE9yaWdpbnNFeHBhbmRlZC5wdXNoKGRvbWFpbik7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgdHJ1c3RlZE9yaWdpbnNFeHBhbmRlZC5wdXNoLmFwcGx5KHRydXN0ZWRPcmlnaW5zRXhwYW5kZWQsIFsgZG9tYWluLCBcIi8vXCIgKyBkb21haW4sIF93aW5kb3cubG9jYXRpb24ucHJvdG9jb2wgKyBcIi8vXCIgKyBkb21haW4gXSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKHRydXN0ZWRPcmlnaW5zRXhwYW5kZWQubGVuZ3RoKSB7XG4gICAgICBzdHIgKz0gXCJ0cnVzdGVkT3JpZ2lucz1cIiArIF9lbmNvZGVVUklDb21wb25lbnQodHJ1c3RlZE9yaWdpbnNFeHBhbmRlZC5qb2luKFwiLFwiKSk7XG4gICAgfVxuICAgIGlmIChvcHRpb25zLmZvcmNlRW5oYW5jZWRDbGlwYm9hcmQgPT09IHRydWUpIHtcbiAgICAgIHN0ciArPSAoc3RyID8gXCImXCIgOiBcIlwiKSArIFwiZm9yY2VFbmhhbmNlZENsaXBib2FyZD10cnVlXCI7XG4gICAgfVxuICAgIGlmICh0eXBlb2Ygb3B0aW9ucy5zd2ZPYmplY3RJZCA9PT0gXCJzdHJpbmdcIiAmJiBvcHRpb25zLnN3Zk9iamVjdElkKSB7XG4gICAgICBzdHIgKz0gKHN0ciA/IFwiJlwiIDogXCJcIikgKyBcInN3Zk9iamVjdElkPVwiICsgX2VuY29kZVVSSUNvbXBvbmVudChvcHRpb25zLnN3Zk9iamVjdElkKTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBvcHRpb25zLmpzVmVyc2lvbiA9PT0gXCJzdHJpbmdcIiAmJiBvcHRpb25zLmpzVmVyc2lvbikge1xuICAgICAgc3RyICs9IChzdHIgPyBcIiZcIiA6IFwiXCIpICsgXCJqc1ZlcnNpb249XCIgKyBfZW5jb2RlVVJJQ29tcG9uZW50KG9wdGlvbnMuanNWZXJzaW9uKTtcbiAgICB9XG4gICAgcmV0dXJuIHN0cjtcbiAgfTtcbiAgLyoqXG4gKiBFeHRyYWN0IHRoZSBkb21haW4gKGUuZy4gXCJnaXRodWIuY29tXCIpIGZyb20gYW4gb3JpZ2luIChlLmcuIFwiaHR0cHM6Ly9naXRodWIuY29tXCIpIG9yXG4gKiBVUkwgKGUuZy4gXCJodHRwczovL2dpdGh1Yi5jb20vemVyb2NsaXBib2FyZC96ZXJvY2xpcGJvYXJkL1wiKS5cbiAqXG4gKiBAcmV0dXJucyB0aGUgZG9tYWluXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZXh0cmFjdERvbWFpbiA9IGZ1bmN0aW9uKG9yaWdpbk9yVXJsKSB7XG4gICAgaWYgKG9yaWdpbk9yVXJsID09IG51bGwgfHwgb3JpZ2luT3JVcmwgPT09IFwiXCIpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBvcmlnaW5PclVybCA9IG9yaWdpbk9yVXJsLnJlcGxhY2UoL15cXHMrfFxccyskL2csIFwiXCIpO1xuICAgIGlmIChvcmlnaW5PclVybCA9PT0gXCJcIikge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciBwcm90b2NvbEluZGV4ID0gb3JpZ2luT3JVcmwuaW5kZXhPZihcIi8vXCIpO1xuICAgIG9yaWdpbk9yVXJsID0gcHJvdG9jb2xJbmRleCA9PT0gLTEgPyBvcmlnaW5PclVybCA6IG9yaWdpbk9yVXJsLnNsaWNlKHByb3RvY29sSW5kZXggKyAyKTtcbiAgICB2YXIgcGF0aEluZGV4ID0gb3JpZ2luT3JVcmwuaW5kZXhPZihcIi9cIik7XG4gICAgb3JpZ2luT3JVcmwgPSBwYXRoSW5kZXggPT09IC0xID8gb3JpZ2luT3JVcmwgOiBwcm90b2NvbEluZGV4ID09PSAtMSB8fCBwYXRoSW5kZXggPT09IDAgPyBudWxsIDogb3JpZ2luT3JVcmwuc2xpY2UoMCwgcGF0aEluZGV4KTtcbiAgICBpZiAob3JpZ2luT3JVcmwgJiYgb3JpZ2luT3JVcmwuc2xpY2UoLTQpLnRvTG93ZXJDYXNlKCkgPT09IFwiLnN3ZlwiKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgcmV0dXJuIG9yaWdpbk9yVXJsIHx8IG51bGw7XG4gIH07XG4gIC8qKlxuICogU2V0IGBhbGxvd1NjcmlwdEFjY2Vzc2AgYmFzZWQgb24gYHRydXN0ZWREb21haW5zYCBhbmQgYHdpbmRvdy5sb2NhdGlvbi5ob3N0YCB2cy4gYHN3ZlBhdGhgLlxuICpcbiAqIEByZXR1cm5zIFRoZSBhcHByb3ByaWF0ZSBzY3JpcHQgYWNjZXNzIGxldmVsLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2RldGVybWluZVNjcmlwdEFjY2VzcyA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBfZXh0cmFjdEFsbERvbWFpbnMgPSBmdW5jdGlvbihvcmlnaW5zKSB7XG4gICAgICB2YXIgaSwgbGVuLCB0bXAsIHJlc3VsdHNBcnJheSA9IFtdO1xuICAgICAgaWYgKHR5cGVvZiBvcmlnaW5zID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIG9yaWdpbnMgPSBbIG9yaWdpbnMgXTtcbiAgICAgIH1cbiAgICAgIGlmICghKHR5cGVvZiBvcmlnaW5zID09PSBcIm9iamVjdFwiICYmIG9yaWdpbnMgJiYgdHlwZW9mIG9yaWdpbnMubGVuZ3RoID09PSBcIm51bWJlclwiKSkge1xuICAgICAgICByZXR1cm4gcmVzdWx0c0FycmF5O1xuICAgICAgfVxuICAgICAgZm9yIChpID0gMCwgbGVuID0gb3JpZ2lucy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBpZiAoX2hhc093bi5jYWxsKG9yaWdpbnMsIGkpICYmICh0bXAgPSBfZXh0cmFjdERvbWFpbihvcmlnaW5zW2ldKSkpIHtcbiAgICAgICAgICBpZiAodG1wID09PSBcIipcIikge1xuICAgICAgICAgICAgcmVzdWx0c0FycmF5Lmxlbmd0aCA9IDA7XG4gICAgICAgICAgICByZXN1bHRzQXJyYXkucHVzaChcIipcIik7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHJlc3VsdHNBcnJheS5pbmRleE9mKHRtcCkgPT09IC0xKSB7XG4gICAgICAgICAgICByZXN1bHRzQXJyYXkucHVzaCh0bXApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3VsdHNBcnJheTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbihjdXJyZW50RG9tYWluLCBjb25maWdPcHRpb25zKSB7XG4gICAgICB2YXIgc3dmRG9tYWluID0gX2V4dHJhY3REb21haW4oY29uZmlnT3B0aW9ucy5zd2ZQYXRoKTtcbiAgICAgIGlmIChzd2ZEb21haW4gPT09IG51bGwpIHtcbiAgICAgICAgc3dmRG9tYWluID0gY3VycmVudERvbWFpbjtcbiAgICAgIH1cbiAgICAgIHZhciB0cnVzdGVkRG9tYWlucyA9IF9leHRyYWN0QWxsRG9tYWlucyhjb25maWdPcHRpb25zLnRydXN0ZWREb21haW5zKTtcbiAgICAgIHZhciBsZW4gPSB0cnVzdGVkRG9tYWlucy5sZW5ndGg7XG4gICAgICBpZiAobGVuID4gMCkge1xuICAgICAgICBpZiAobGVuID09PSAxICYmIHRydXN0ZWREb21haW5zWzBdID09PSBcIipcIikge1xuICAgICAgICAgIHJldHVybiBcImFsd2F5c1wiO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0cnVzdGVkRG9tYWlucy5pbmRleE9mKGN1cnJlbnREb21haW4pICE9PSAtMSkge1xuICAgICAgICAgIGlmIChsZW4gPT09IDEgJiYgY3VycmVudERvbWFpbiA9PT0gc3dmRG9tYWluKSB7XG4gICAgICAgICAgICByZXR1cm4gXCJzYW1lRG9tYWluXCI7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBcImFsd2F5c1wiO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gXCJuZXZlclwiO1xuICAgIH07XG4gIH0oKTtcbiAgLyoqXG4gKiBHZXQgdGhlIGN1cnJlbnRseSBhY3RpdmUvZm9jdXNlZCBET00gZWxlbWVudC5cbiAqXG4gKiBAcmV0dXJucyB0aGUgY3VycmVudGx5IGFjdGl2ZS9mb2N1c2VkIGVsZW1lbnQsIG9yIGBudWxsYFxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX3NhZmVBY3RpdmVFbGVtZW50ID0gZnVuY3Rpb24oKSB7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBfZG9jdW1lbnQuYWN0aXZlRWxlbWVudDtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfTtcbiAgLyoqXG4gKiBBZGQgYSBjbGFzcyB0byBhbiBlbGVtZW50LCBpZiBpdCBkb2Vzbid0IGFscmVhZHkgaGF2ZSBpdC5cbiAqXG4gKiBAcmV0dXJucyBUaGUgZWxlbWVudCwgd2l0aCBpdHMgbmV3IGNsYXNzIGFkZGVkLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2FkZENsYXNzID0gZnVuY3Rpb24oZWxlbWVudCwgdmFsdWUpIHtcbiAgICB2YXIgYywgY2wsIGNsYXNzTmFtZSwgY2xhc3NOYW1lcyA9IFtdO1xuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIgJiYgdmFsdWUpIHtcbiAgICAgIGNsYXNzTmFtZXMgPSB2YWx1ZS5zcGxpdCgvXFxzKy8pO1xuICAgIH1cbiAgICBpZiAoZWxlbWVudCAmJiBlbGVtZW50Lm5vZGVUeXBlID09PSAxICYmIGNsYXNzTmFtZXMubGVuZ3RoID4gMCkge1xuICAgICAgaWYgKGVsZW1lbnQuY2xhc3NMaXN0KSB7XG4gICAgICAgIGZvciAoYyA9IDAsIGNsID0gY2xhc3NOYW1lcy5sZW5ndGg7IGMgPCBjbDsgYysrKSB7XG4gICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKGNsYXNzTmFtZXNbY10pO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGVsZW1lbnQuaGFzT3duUHJvcGVydHkoXCJjbGFzc05hbWVcIikpIHtcbiAgICAgICAgY2xhc3NOYW1lID0gXCIgXCIgKyBlbGVtZW50LmNsYXNzTmFtZSArIFwiIFwiO1xuICAgICAgICBmb3IgKGMgPSAwLCBjbCA9IGNsYXNzTmFtZXMubGVuZ3RoOyBjIDwgY2w7IGMrKykge1xuICAgICAgICAgIGlmIChjbGFzc05hbWUuaW5kZXhPZihcIiBcIiArIGNsYXNzTmFtZXNbY10gKyBcIiBcIikgPT09IC0xKSB7XG4gICAgICAgICAgICBjbGFzc05hbWUgKz0gY2xhc3NOYW1lc1tjXSArIFwiIFwiO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbGVtZW50LmNsYXNzTmFtZSA9IGNsYXNzTmFtZS5yZXBsYWNlKC9eXFxzK3xcXHMrJC9nLCBcIlwiKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGVsZW1lbnQ7XG4gIH07XG4gIC8qKlxuICogUmVtb3ZlIGEgY2xhc3MgZnJvbSBhbiBlbGVtZW50LCBpZiBpdCBoYXMgaXQuXG4gKlxuICogQHJldHVybnMgVGhlIGVsZW1lbnQsIHdpdGggaXRzIGNsYXNzIHJlbW92ZWQuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfcmVtb3ZlQ2xhc3MgPSBmdW5jdGlvbihlbGVtZW50LCB2YWx1ZSkge1xuICAgIHZhciBjLCBjbCwgY2xhc3NOYW1lLCBjbGFzc05hbWVzID0gW107XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIiAmJiB2YWx1ZSkge1xuICAgICAgY2xhc3NOYW1lcyA9IHZhbHVlLnNwbGl0KC9cXHMrLyk7XG4gICAgfVxuICAgIGlmIChlbGVtZW50ICYmIGVsZW1lbnQubm9kZVR5cGUgPT09IDEgJiYgY2xhc3NOYW1lcy5sZW5ndGggPiAwKSB7XG4gICAgICBpZiAoZWxlbWVudC5jbGFzc0xpc3QgJiYgZWxlbWVudC5jbGFzc0xpc3QubGVuZ3RoID4gMCkge1xuICAgICAgICBmb3IgKGMgPSAwLCBjbCA9IGNsYXNzTmFtZXMubGVuZ3RoOyBjIDwgY2w7IGMrKykge1xuICAgICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjbGFzc05hbWVzW2NdKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChlbGVtZW50LmNsYXNzTmFtZSkge1xuICAgICAgICBjbGFzc05hbWUgPSAoXCIgXCIgKyBlbGVtZW50LmNsYXNzTmFtZSArIFwiIFwiKS5yZXBsYWNlKC9bXFxyXFxuXFx0XS9nLCBcIiBcIik7XG4gICAgICAgIGZvciAoYyA9IDAsIGNsID0gY2xhc3NOYW1lcy5sZW5ndGg7IGMgPCBjbDsgYysrKSB7XG4gICAgICAgICAgY2xhc3NOYW1lID0gY2xhc3NOYW1lLnJlcGxhY2UoXCIgXCIgKyBjbGFzc05hbWVzW2NdICsgXCIgXCIsIFwiIFwiKTtcbiAgICAgICAgfVxuICAgICAgICBlbGVtZW50LmNsYXNzTmFtZSA9IGNsYXNzTmFtZS5yZXBsYWNlKC9eXFxzK3xcXHMrJC9nLCBcIlwiKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGVsZW1lbnQ7XG4gIH07XG4gIC8qKlxuICogQXR0ZW1wdCB0byBpbnRlcnByZXQgdGhlIGVsZW1lbnQncyBDU1Mgc3R5bGluZy4gSWYgYHByb3BgIGlzIGBcImN1cnNvclwiYCxcbiAqIHRoZW4gd2UgYXNzdW1lIHRoYXQgaXQgc2hvdWxkIGJlIGEgaGFuZCAoXCJwb2ludGVyXCIpIGN1cnNvciBpZiB0aGUgZWxlbWVudFxuICogaXMgYW4gYW5jaG9yIGVsZW1lbnQgKFwiYVwiIHRhZykuXG4gKlxuICogQHJldHVybnMgVGhlIGNvbXB1dGVkIHN0eWxlIHByb3BlcnR5LlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2dldFN0eWxlID0gZnVuY3Rpb24oZWwsIHByb3ApIHtcbiAgICB2YXIgdmFsdWUgPSBfZ2V0Q29tcHV0ZWRTdHlsZShlbCwgbnVsbCkuZ2V0UHJvcGVydHlWYWx1ZShwcm9wKTtcbiAgICBpZiAocHJvcCA9PT0gXCJjdXJzb3JcIikge1xuICAgICAgaWYgKCF2YWx1ZSB8fCB2YWx1ZSA9PT0gXCJhdXRvXCIpIHtcbiAgICAgICAgaWYgKGVsLm5vZGVOYW1lID09PSBcIkFcIikge1xuICAgICAgICAgIHJldHVybiBcInBvaW50ZXJcIjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdmFsdWU7XG4gIH07XG4gIC8qKlxuICogR2V0IHRoZSBhYnNvbHV0ZWx5IHBvc2l0aW9uZWQgY29vcmRpbmF0ZXMgb2YgYSBET00gZWxlbWVudC5cbiAqXG4gKiBAcmV0dXJucyBPYmplY3QgY29udGFpbmluZyB0aGUgZWxlbWVudCdzIHBvc2l0aW9uLCB3aWR0aCwgYW5kIGhlaWdodC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9nZXRFbGVtZW50UG9zaXRpb24gPSBmdW5jdGlvbihlbCkge1xuICAgIHZhciBwb3MgPSB7XG4gICAgICBsZWZ0OiAwLFxuICAgICAgdG9wOiAwLFxuICAgICAgd2lkdGg6IDAsXG4gICAgICBoZWlnaHQ6IDBcbiAgICB9O1xuICAgIGlmIChlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QpIHtcbiAgICAgIHZhciBlbFJlY3QgPSBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgIHZhciBwYWdlWE9mZnNldCA9IF93aW5kb3cucGFnZVhPZmZzZXQ7XG4gICAgICB2YXIgcGFnZVlPZmZzZXQgPSBfd2luZG93LnBhZ2VZT2Zmc2V0O1xuICAgICAgdmFyIGxlZnRCb3JkZXJXaWR0aCA9IF9kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50TGVmdCB8fCAwO1xuICAgICAgdmFyIHRvcEJvcmRlcldpZHRoID0gX2RvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRUb3AgfHwgMDtcbiAgICAgIHZhciBsZWZ0Qm9keU9mZnNldCA9IDA7XG4gICAgICB2YXIgdG9wQm9keU9mZnNldCA9IDA7XG4gICAgICBpZiAoX2dldFN0eWxlKF9kb2N1bWVudC5ib2R5LCBcInBvc2l0aW9uXCIpID09PSBcInJlbGF0aXZlXCIpIHtcbiAgICAgICAgdmFyIGJvZHlSZWN0ID0gX2RvY3VtZW50LmJvZHkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgIHZhciBodG1sUmVjdCA9IF9kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgIGxlZnRCb2R5T2Zmc2V0ID0gYm9keVJlY3QubGVmdCAtIGh0bWxSZWN0LmxlZnQgfHwgMDtcbiAgICAgICAgdG9wQm9keU9mZnNldCA9IGJvZHlSZWN0LnRvcCAtIGh0bWxSZWN0LnRvcCB8fCAwO1xuICAgICAgfVxuICAgICAgcG9zLmxlZnQgPSBlbFJlY3QubGVmdCArIHBhZ2VYT2Zmc2V0IC0gbGVmdEJvcmRlcldpZHRoIC0gbGVmdEJvZHlPZmZzZXQ7XG4gICAgICBwb3MudG9wID0gZWxSZWN0LnRvcCArIHBhZ2VZT2Zmc2V0IC0gdG9wQm9yZGVyV2lkdGggLSB0b3BCb2R5T2Zmc2V0O1xuICAgICAgcG9zLndpZHRoID0gXCJ3aWR0aFwiIGluIGVsUmVjdCA/IGVsUmVjdC53aWR0aCA6IGVsUmVjdC5yaWdodCAtIGVsUmVjdC5sZWZ0O1xuICAgICAgcG9zLmhlaWdodCA9IFwiaGVpZ2h0XCIgaW4gZWxSZWN0ID8gZWxSZWN0LmhlaWdodCA6IGVsUmVjdC5ib3R0b20gLSBlbFJlY3QudG9wO1xuICAgIH1cbiAgICByZXR1cm4gcG9zO1xuICB9O1xuICAvKipcbiAqIERldGVybWluZSBpcyBhbiBlbGVtZW50IGlzIHZpc2libGUgc29tZXdoZXJlIHdpdGhpbiB0aGUgZG9jdW1lbnQgKHBhZ2UpLlxuICpcbiAqIEByZXR1cm5zIEJvb2xlYW5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9pc0VsZW1lbnRWaXNpYmxlID0gZnVuY3Rpb24oZWwpIHtcbiAgICBpZiAoIWVsKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBzdHlsZXMgPSBfZ2V0Q29tcHV0ZWRTdHlsZShlbCwgbnVsbCk7XG4gICAgdmFyIGhhc0Nzc0hlaWdodCA9IF9wYXJzZUZsb2F0KHN0eWxlcy5oZWlnaHQpID4gMDtcbiAgICB2YXIgaGFzQ3NzV2lkdGggPSBfcGFyc2VGbG9hdChzdHlsZXMud2lkdGgpID4gMDtcbiAgICB2YXIgaGFzQ3NzVG9wID0gX3BhcnNlRmxvYXQoc3R5bGVzLnRvcCkgPj0gMDtcbiAgICB2YXIgaGFzQ3NzTGVmdCA9IF9wYXJzZUZsb2F0KHN0eWxlcy5sZWZ0KSA+PSAwO1xuICAgIHZhciBjc3NLbm93cyA9IGhhc0Nzc0hlaWdodCAmJiBoYXNDc3NXaWR0aCAmJiBoYXNDc3NUb3AgJiYgaGFzQ3NzTGVmdDtcbiAgICB2YXIgcmVjdCA9IGNzc0tub3dzID8gbnVsbCA6IF9nZXRFbGVtZW50UG9zaXRpb24oZWwpO1xuICAgIHZhciBpc1Zpc2libGUgPSBzdHlsZXMuZGlzcGxheSAhPT0gXCJub25lXCIgJiYgc3R5bGVzLnZpc2liaWxpdHkgIT09IFwiY29sbGFwc2VcIiAmJiAoY3NzS25vd3MgfHwgISFyZWN0ICYmIChoYXNDc3NIZWlnaHQgfHwgcmVjdC5oZWlnaHQgPiAwKSAmJiAoaGFzQ3NzV2lkdGggfHwgcmVjdC53aWR0aCA+IDApICYmIChoYXNDc3NUb3AgfHwgcmVjdC50b3AgPj0gMCkgJiYgKGhhc0Nzc0xlZnQgfHwgcmVjdC5sZWZ0ID49IDApKTtcbiAgICByZXR1cm4gaXNWaXNpYmxlO1xuICB9O1xuICAvKipcbiAqIENsZWFyIGFsbCBleGlzdGluZyB0aW1lb3V0cyBhbmQgaW50ZXJ2YWwgcG9sbGluZyBkZWxlZ2F0ZXMuXG4gKlxuICogQHJldHVybnMgYHVuZGVmaW5lZGBcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9jbGVhclRpbWVvdXRzQW5kUG9sbGluZyA9IGZ1bmN0aW9uKCkge1xuICAgIF9jbGVhclRpbWVvdXQoX2ZsYXNoQ2hlY2tUaW1lb3V0KTtcbiAgICBfZmxhc2hDaGVja1RpbWVvdXQgPSAwO1xuICAgIF9jbGVhckludGVydmFsKF9zd2ZGYWxsYmFja0NoZWNrSW50ZXJ2YWwpO1xuICAgIF9zd2ZGYWxsYmFja0NoZWNrSW50ZXJ2YWwgPSAwO1xuICB9O1xuICAvKipcbiAqIFJlcG9zaXRpb24gdGhlIEZsYXNoIG9iamVjdCB0byBjb3ZlciB0aGUgY3VycmVudGx5IGFjdGl2YXRlZCBlbGVtZW50LlxuICpcbiAqIEByZXR1cm5zIGB1bmRlZmluZWRgXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfcmVwb3NpdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBodG1sQnJpZGdlO1xuICAgIGlmIChfY3VycmVudEVsZW1lbnQgJiYgKGh0bWxCcmlkZ2UgPSBfZ2V0SHRtbEJyaWRnZShfZmxhc2hTdGF0ZS5icmlkZ2UpKSkge1xuICAgICAgdmFyIHBvcyA9IF9nZXRFbGVtZW50UG9zaXRpb24oX2N1cnJlbnRFbGVtZW50KTtcbiAgICAgIF9leHRlbmQoaHRtbEJyaWRnZS5zdHlsZSwge1xuICAgICAgICB3aWR0aDogcG9zLndpZHRoICsgXCJweFwiLFxuICAgICAgICBoZWlnaHQ6IHBvcy5oZWlnaHQgKyBcInB4XCIsXG4gICAgICAgIHRvcDogcG9zLnRvcCArIFwicHhcIixcbiAgICAgICAgbGVmdDogcG9zLmxlZnQgKyBcInB4XCIsXG4gICAgICAgIHpJbmRleDogXCJcIiArIF9nZXRTYWZlWkluZGV4KF9nbG9iYWxDb25maWcuekluZGV4KVxuICAgICAgfSk7XG4gICAgfVxuICB9O1xuICAvKipcbiAqIFNlbmRzIGEgc2lnbmFsIHRvIHRoZSBGbGFzaCBvYmplY3QgdG8gZGlzcGxheSB0aGUgaGFuZCBjdXJzb3IgaWYgYHRydWVgLlxuICpcbiAqIEByZXR1cm5zIGB1bmRlZmluZWRgXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfc2V0SGFuZEN1cnNvciA9IGZ1bmN0aW9uKGVuYWJsZWQpIHtcbiAgICBpZiAoX2ZsYXNoU3RhdGUucmVhZHkgPT09IHRydWUpIHtcbiAgICAgIGlmIChfZmxhc2hTdGF0ZS5icmlkZ2UgJiYgdHlwZW9mIF9mbGFzaFN0YXRlLmJyaWRnZS5zZXRIYW5kQ3Vyc29yID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgX2ZsYXNoU3RhdGUuYnJpZGdlLnNldEhhbmRDdXJzb3IoZW5hYmxlZCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBfZmxhc2hTdGF0ZS5yZWFkeSA9IGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbiAgLyoqXG4gKiBHZXQgYSBzYWZlIHZhbHVlIGZvciBgekluZGV4YFxuICpcbiAqIEByZXR1cm5zIGFuIGludGVnZXIsIG9yIFwiYXV0b1wiXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZ2V0U2FmZVpJbmRleCA9IGZ1bmN0aW9uKHZhbCkge1xuICAgIGlmICgvXig/OmF1dG98aW5oZXJpdCkkLy50ZXN0KHZhbCkpIHtcbiAgICAgIHJldHVybiB2YWw7XG4gICAgfVxuICAgIHZhciB6SW5kZXg7XG4gICAgaWYgKHR5cGVvZiB2YWwgPT09IFwibnVtYmVyXCIgJiYgIV9pc05hTih2YWwpKSB7XG4gICAgICB6SW5kZXggPSB2YWw7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsID09PSBcInN0cmluZ1wiKSB7XG4gICAgICB6SW5kZXggPSBfZ2V0U2FmZVpJbmRleChfcGFyc2VJbnQodmFsLCAxMCkpO1xuICAgIH1cbiAgICByZXR1cm4gdHlwZW9mIHpJbmRleCA9PT0gXCJudW1iZXJcIiA/IHpJbmRleCA6IFwiYXV0b1wiO1xuICB9O1xuICAvKipcbiAqIEF0dGVtcHQgdG8gZGV0ZWN0IGlmIFplcm9DbGlwYm9hcmQgaXMgZXhlY3V0aW5nIGluc2lkZSBvZiBhIHNhbmRib3hlZCBpZnJhbWUuXG4gKiBJZiBpdCBpcywgRmxhc2ggUGxheWVyIGNhbm5vdCBiZSB1c2VkLCBzbyBaZXJvQ2xpcGJvYXJkIGlzIGRlYWQgaW4gdGhlIHdhdGVyLlxuICpcbiAqIEBzZWUge0BsaW5rIGh0dHA6Ly9saXN0cy53My5vcmcvQXJjaGl2ZXMvUHVibGljL3B1YmxpYy13aGF0d2ctYXJjaGl2ZS8yMDE0RGVjLzAwMDIuaHRtbH1cbiAqIEBzZWUge0BsaW5rIGh0dHBzOi8vZ2l0aHViLmNvbS96ZXJvY2xpcGJvYXJkL3plcm9jbGlwYm9hcmQvaXNzdWVzLzUxMX1cbiAqIEBzZWUge0BsaW5rIGh0dHA6Ly96ZXJvY2xpcGJvYXJkLm9yZy90ZXN0LWlmcmFtZXMuaHRtbH1cbiAqXG4gKiBAcmV0dXJucyBgdHJ1ZWAgKGlzIHNhbmRib3hlZCksIGBmYWxzZWAgKGlzIG5vdCBzYW5kYm94ZWQpLCBvciBgbnVsbGAgKHVuY2VydGFpbikgXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZGV0ZWN0U2FuZGJveCA9IGZ1bmN0aW9uKGRvTm90UmVhc3Nlc3NGbGFzaFN1cHBvcnQpIHtcbiAgICB2YXIgZWZmZWN0aXZlU2NyaXB0T3JpZ2luLCBmcmFtZSwgZnJhbWVFcnJvciwgcHJldmlvdXNTdGF0ZSA9IF9mbGFzaFN0YXRlLnNhbmRib3hlZCwgaXNTYW5kYm94ZWQgPSBudWxsO1xuICAgIGRvTm90UmVhc3Nlc3NGbGFzaFN1cHBvcnQgPSBkb05vdFJlYXNzZXNzRmxhc2hTdXBwb3J0ID09PSB0cnVlO1xuICAgIGlmIChfcGFnZUlzRnJhbWVkID09PSBmYWxzZSkge1xuICAgICAgaXNTYW5kYm94ZWQgPSBmYWxzZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdHJ5IHtcbiAgICAgICAgZnJhbWUgPSB3aW5kb3cuZnJhbWVFbGVtZW50IHx8IG51bGw7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGZyYW1lRXJyb3IgPSB7XG4gICAgICAgICAgbmFtZTogZS5uYW1lLFxuICAgICAgICAgIG1lc3NhZ2U6IGUubWVzc2FnZVxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgaWYgKGZyYW1lICYmIGZyYW1lLm5vZGVUeXBlID09PSAxICYmIGZyYW1lLm5vZGVOYW1lID09PSBcIklGUkFNRVwiKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgaXNTYW5kYm94ZWQgPSBmcmFtZS5oYXNBdHRyaWJ1dGUoXCJzYW5kYm94XCIpO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgaXNTYW5kYm94ZWQgPSBudWxsO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGVmZmVjdGl2ZVNjcmlwdE9yaWdpbiA9IGRvY3VtZW50LmRvbWFpbiB8fCBudWxsO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgZWZmZWN0aXZlU2NyaXB0T3JpZ2luID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZWZmZWN0aXZlU2NyaXB0T3JpZ2luID09PSBudWxsIHx8IGZyYW1lRXJyb3IgJiYgZnJhbWVFcnJvci5uYW1lID09PSBcIlNlY3VyaXR5RXJyb3JcIiAmJiAvKF58W1xcc1xcKFxcW0BdKXNhbmRib3goZXN8ZWR8aW5nfFtcXHNcXC4sIVxcKVxcXUBdfCQpLy50ZXN0KGZyYW1lRXJyb3IubWVzc2FnZS50b0xvd2VyQ2FzZSgpKSkge1xuICAgICAgICAgIGlzU2FuZGJveGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBfZmxhc2hTdGF0ZS5zYW5kYm94ZWQgPSBpc1NhbmRib3hlZDtcbiAgICBpZiAocHJldmlvdXNTdGF0ZSAhPT0gaXNTYW5kYm94ZWQgJiYgIWRvTm90UmVhc3Nlc3NGbGFzaFN1cHBvcnQpIHtcbiAgICAgIF9kZXRlY3RGbGFzaFN1cHBvcnQoX0FjdGl2ZVhPYmplY3QpO1xuICAgIH1cbiAgICByZXR1cm4gaXNTYW5kYm94ZWQ7XG4gIH07XG4gIC8qKlxuICogRGV0ZWN0IHRoZSBGbGFzaCBQbGF5ZXIgc3RhdHVzLCB2ZXJzaW9uLCBhbmQgcGx1Z2luIHR5cGUuXG4gKlxuICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC9kb2N0eXBlLW1pcnJvci93aWtpL0FydGljbGVEZXRlY3RGbGFzaCNUaGVfY29kZX1cbiAqIEBzZWUge0BsaW5rIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTI4NjYwNjAvZGV0ZWN0aW5nLXBlcHBlci1wcGFwaS1mbGFzaC13aXRoLWphdmFzY3JpcHR9XG4gKlxuICogQHJldHVybnMgYHVuZGVmaW5lZGBcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9kZXRlY3RGbGFzaFN1cHBvcnQgPSBmdW5jdGlvbihBY3RpdmVYT2JqZWN0KSB7XG4gICAgdmFyIHBsdWdpbiwgYXgsIG1pbWVUeXBlLCBoYXNGbGFzaCA9IGZhbHNlLCBpc0FjdGl2ZVggPSBmYWxzZSwgaXNQUEFQSSA9IGZhbHNlLCBmbGFzaFZlcnNpb24gPSBcIlwiO1xuICAgIC8qKlxuICAgKiBEZXJpdmVkIGZyb20gQXBwbGUncyBzdWdnZXN0ZWQgc25pZmZlci5cbiAgICogQHBhcmFtIHtTdHJpbmd9IGRlc2MgZS5nLiBcIlNob2Nrd2F2ZSBGbGFzaCA3LjAgcjYxXCJcbiAgICogQHJldHVybnMge1N0cmluZ30gXCI3LjAuNjFcIlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgICBmdW5jdGlvbiBwYXJzZUZsYXNoVmVyc2lvbihkZXNjKSB7XG4gICAgICB2YXIgbWF0Y2hlcyA9IGRlc2MubWF0Y2goL1tcXGRdKy9nKTtcbiAgICAgIG1hdGNoZXMubGVuZ3RoID0gMztcbiAgICAgIHJldHVybiBtYXRjaGVzLmpvaW4oXCIuXCIpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBpc1BlcHBlckZsYXNoKGZsYXNoUGxheWVyRmlsZU5hbWUpIHtcbiAgICAgIHJldHVybiAhIWZsYXNoUGxheWVyRmlsZU5hbWUgJiYgKGZsYXNoUGxheWVyRmlsZU5hbWUgPSBmbGFzaFBsYXllckZpbGVOYW1lLnRvTG93ZXJDYXNlKCkpICYmICgvXihwZXBmbGFzaHBsYXllclxcLmRsbHxsaWJwZXBmbGFzaHBsYXllclxcLnNvfHBlcHBlcmZsYXNocGxheWVyXFwucGx1Z2luKSQvLnRlc3QoZmxhc2hQbGF5ZXJGaWxlTmFtZSkgfHwgZmxhc2hQbGF5ZXJGaWxlTmFtZS5zbGljZSgtMTMpID09PSBcImNocm9tZS5wbHVnaW5cIik7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGluc3BlY3RQbHVnaW4ocGx1Z2luKSB7XG4gICAgICBpZiAocGx1Z2luKSB7XG4gICAgICAgIGhhc0ZsYXNoID0gdHJ1ZTtcbiAgICAgICAgaWYgKHBsdWdpbi52ZXJzaW9uKSB7XG4gICAgICAgICAgZmxhc2hWZXJzaW9uID0gcGFyc2VGbGFzaFZlcnNpb24ocGx1Z2luLnZlcnNpb24pO1xuICAgICAgICB9XG4gICAgICAgIGlmICghZmxhc2hWZXJzaW9uICYmIHBsdWdpbi5kZXNjcmlwdGlvbikge1xuICAgICAgICAgIGZsYXNoVmVyc2lvbiA9IHBhcnNlRmxhc2hWZXJzaW9uKHBsdWdpbi5kZXNjcmlwdGlvbik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBsdWdpbi5maWxlbmFtZSkge1xuICAgICAgICAgIGlzUFBBUEkgPSBpc1BlcHBlckZsYXNoKHBsdWdpbi5maWxlbmFtZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKF9uYXZpZ2F0b3IucGx1Z2lucyAmJiBfbmF2aWdhdG9yLnBsdWdpbnMubGVuZ3RoKSB7XG4gICAgICBwbHVnaW4gPSBfbmF2aWdhdG9yLnBsdWdpbnNbXCJTaG9ja3dhdmUgRmxhc2hcIl07XG4gICAgICBpbnNwZWN0UGx1Z2luKHBsdWdpbik7XG4gICAgICBpZiAoX25hdmlnYXRvci5wbHVnaW5zW1wiU2hvY2t3YXZlIEZsYXNoIDIuMFwiXSkge1xuICAgICAgICBoYXNGbGFzaCA9IHRydWU7XG4gICAgICAgIGZsYXNoVmVyc2lvbiA9IFwiMi4wLjAuMTFcIjtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKF9uYXZpZ2F0b3IubWltZVR5cGVzICYmIF9uYXZpZ2F0b3IubWltZVR5cGVzLmxlbmd0aCkge1xuICAgICAgbWltZVR5cGUgPSBfbmF2aWdhdG9yLm1pbWVUeXBlc1tcImFwcGxpY2F0aW9uL3gtc2hvY2t3YXZlLWZsYXNoXCJdO1xuICAgICAgcGx1Z2luID0gbWltZVR5cGUgJiYgbWltZVR5cGUuZW5hYmxlZFBsdWdpbjtcbiAgICAgIGluc3BlY3RQbHVnaW4ocGx1Z2luKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBBY3RpdmVYT2JqZWN0ICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICBpc0FjdGl2ZVggPSB0cnVlO1xuICAgICAgdHJ5IHtcbiAgICAgICAgYXggPSBuZXcgQWN0aXZlWE9iamVjdChcIlNob2Nrd2F2ZUZsYXNoLlNob2Nrd2F2ZUZsYXNoLjdcIik7XG4gICAgICAgIGhhc0ZsYXNoID0gdHJ1ZTtcbiAgICAgICAgZmxhc2hWZXJzaW9uID0gcGFyc2VGbGFzaFZlcnNpb24oYXguR2V0VmFyaWFibGUoXCIkdmVyc2lvblwiKSk7XG4gICAgICB9IGNhdGNoIChlMSkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGF4ID0gbmV3IEFjdGl2ZVhPYmplY3QoXCJTaG9ja3dhdmVGbGFzaC5TaG9ja3dhdmVGbGFzaC42XCIpO1xuICAgICAgICAgIGhhc0ZsYXNoID0gdHJ1ZTtcbiAgICAgICAgICBmbGFzaFZlcnNpb24gPSBcIjYuMC4yMVwiO1xuICAgICAgICB9IGNhdGNoIChlMikge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBheCA9IG5ldyBBY3RpdmVYT2JqZWN0KFwiU2hvY2t3YXZlRmxhc2guU2hvY2t3YXZlRmxhc2hcIik7XG4gICAgICAgICAgICBoYXNGbGFzaCA9IHRydWU7XG4gICAgICAgICAgICBmbGFzaFZlcnNpb24gPSBwYXJzZUZsYXNoVmVyc2lvbihheC5HZXRWYXJpYWJsZShcIiR2ZXJzaW9uXCIpKTtcbiAgICAgICAgICB9IGNhdGNoIChlMykge1xuICAgICAgICAgICAgaXNBY3RpdmVYID0gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIF9mbGFzaFN0YXRlLmRpc2FibGVkID0gaGFzRmxhc2ggIT09IHRydWU7XG4gICAgX2ZsYXNoU3RhdGUub3V0ZGF0ZWQgPSBmbGFzaFZlcnNpb24gJiYgX3BhcnNlRmxvYXQoZmxhc2hWZXJzaW9uKSA8IF9wYXJzZUZsb2F0KF9taW5pbXVtRmxhc2hWZXJzaW9uKTtcbiAgICBfZmxhc2hTdGF0ZS52ZXJzaW9uID0gZmxhc2hWZXJzaW9uIHx8IFwiMC4wLjBcIjtcbiAgICBfZmxhc2hTdGF0ZS5wbHVnaW5UeXBlID0gaXNQUEFQSSA/IFwicGVwcGVyXCIgOiBpc0FjdGl2ZVggPyBcImFjdGl2ZXhcIiA6IGhhc0ZsYXNoID8gXCJuZXRzY2FwZVwiIDogXCJ1bmtub3duXCI7XG4gIH07XG4gIC8qKlxuICogSW52b2tlIHRoZSBGbGFzaCBkZXRlY3Rpb24gYWxnb3JpdGhtcyBpbW1lZGlhdGVseSB1cG9uIGluY2x1c2lvbiBzbyB3ZSdyZSBub3Qgd2FpdGluZyBsYXRlci5cbiAqL1xuICBfZGV0ZWN0Rmxhc2hTdXBwb3J0KF9BY3RpdmVYT2JqZWN0KTtcbiAgLyoqXG4gKiBBbHdheXMgYXNzZXNzIHRoZSBgc2FuZGJveGVkYCBzdGF0ZSBvZiB0aGUgcGFnZSBhdCBpbXBvcnRhbnQgRmxhc2gtcmVsYXRlZCBtb21lbnRzLlxuICovXG4gIF9kZXRlY3RTYW5kYm94KHRydWUpO1xuICAvKipcbiAqIEEgc2hlbGwgY29uc3RydWN0b3IgZm9yIGBaZXJvQ2xpcGJvYXJkYCBjbGllbnQgaW5zdGFuY2VzLlxuICpcbiAqIEBjb25zdHJ1Y3RvclxuICovXG4gIHZhciBaZXJvQ2xpcGJvYXJkID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFplcm9DbGlwYm9hcmQpKSB7XG4gICAgICByZXR1cm4gbmV3IFplcm9DbGlwYm9hcmQoKTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBaZXJvQ2xpcGJvYXJkLl9jcmVhdGVDbGllbnQgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgWmVyb0NsaXBib2FyZC5fY3JlYXRlQ2xpZW50LmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICAgIH1cbiAgfTtcbiAgLyoqXG4gKiBUaGUgWmVyb0NsaXBib2FyZCBsaWJyYXJ5J3MgdmVyc2lvbiBudW1iZXIuXG4gKlxuICogQHN0YXRpY1xuICogQHJlYWRvbmx5XG4gKiBAcHJvcGVydHkge3N0cmluZ31cbiAqL1xuICBfZGVmaW5lUHJvcGVydHkoWmVyb0NsaXBib2FyZCwgXCJ2ZXJzaW9uXCIsIHtcbiAgICB2YWx1ZTogXCIyLjIuMFwiLFxuICAgIHdyaXRhYmxlOiBmYWxzZSxcbiAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgZW51bWVyYWJsZTogdHJ1ZVxuICB9KTtcbiAgLyoqXG4gKiBVcGRhdGUgb3IgZ2V0IGEgY29weSBvZiB0aGUgWmVyb0NsaXBib2FyZCBnbG9iYWwgY29uZmlndXJhdGlvbi5cbiAqIFJldHVybnMgYSBjb3B5IG9mIHRoZSBjdXJyZW50L3VwZGF0ZWQgY29uZmlndXJhdGlvbi5cbiAqXG4gKiBAcmV0dXJucyBPYmplY3RcbiAqIEBzdGF0aWNcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLmNvbmZpZyA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfY29uZmlnLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIERpYWdub3N0aWMgbWV0aG9kIHRoYXQgZGVzY3JpYmVzIHRoZSBzdGF0ZSBvZiB0aGUgYnJvd3NlciwgRmxhc2ggUGxheWVyLCBhbmQgWmVyb0NsaXBib2FyZC5cbiAqXG4gKiBAcmV0dXJucyBPYmplY3RcbiAqIEBzdGF0aWNcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLnN0YXRlID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIF9zdGF0ZS5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBDaGVjayBpZiBGbGFzaCBpcyB1bnVzYWJsZSBmb3IgYW55IHJlYXNvbjogZGlzYWJsZWQsIG91dGRhdGVkLCBkZWFjdGl2YXRlZCwgZXRjLlxuICpcbiAqIEByZXR1cm5zIEJvb2xlYW5cbiAqIEBzdGF0aWNcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLmlzRmxhc2hVbnVzYWJsZSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfaXNGbGFzaFVudXNhYmxlLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIFJlZ2lzdGVyIGFuIGV2ZW50IGxpc3RlbmVyLlxuICpcbiAqIEByZXR1cm5zIGBaZXJvQ2xpcGJvYXJkYFxuICogQHN0YXRpY1xuICovXG4gIFplcm9DbGlwYm9hcmQub24gPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX29uLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIFVucmVnaXN0ZXIgYW4gZXZlbnQgbGlzdGVuZXIuXG4gKiBJZiBubyBgbGlzdGVuZXJgIGZ1bmN0aW9uL29iamVjdCBpcyBwcm92aWRlZCwgaXQgd2lsbCB1bnJlZ2lzdGVyIGFsbCBsaXN0ZW5lcnMgZm9yIHRoZSBwcm92aWRlZCBgZXZlbnRUeXBlYC5cbiAqIElmIG5vIGBldmVudFR5cGVgIGlzIHByb3ZpZGVkLCBpdCB3aWxsIHVucmVnaXN0ZXIgYWxsIGxpc3RlbmVycyBmb3IgZXZlcnkgZXZlbnQgdHlwZS5cbiAqXG4gKiBAcmV0dXJucyBgWmVyb0NsaXBib2FyZGBcbiAqIEBzdGF0aWNcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLm9mZiA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfb2ZmLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIFJldHJpZXZlIGV2ZW50IGxpc3RlbmVycyBmb3IgYW4gYGV2ZW50VHlwZWAuXG4gKiBJZiBubyBgZXZlbnRUeXBlYCBpcyBwcm92aWRlZCwgaXQgd2lsbCByZXRyaWV2ZSBhbGwgbGlzdGVuZXJzIGZvciBldmVyeSBldmVudCB0eXBlLlxuICpcbiAqIEByZXR1cm5zIGFycmF5IG9mIGxpc3RlbmVycyBmb3IgdGhlIGBldmVudFR5cGVgOyBpZiBubyBgZXZlbnRUeXBlYCwgdGhlbiBhIG1hcC9oYXNoIG9iamVjdCBvZiBsaXN0ZW5lcnMgZm9yIGFsbCBldmVudCB0eXBlczsgb3IgYG51bGxgXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5oYW5kbGVycyA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfbGlzdGVuZXJzLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIEV2ZW50IGVtaXNzaW9uIHJlY2VpdmVyIGZyb20gdGhlIEZsYXNoIG9iamVjdCwgZm9yd2FyZGluZyB0byBhbnkgcmVnaXN0ZXJlZCBKYXZhU2NyaXB0IGV2ZW50IGxpc3RlbmVycy5cbiAqXG4gKiBAcmV0dXJucyBGb3IgdGhlIFwiY29weVwiIGV2ZW50LCByZXR1cm5zIHRoZSBGbGFzaC1mcmllbmRseSBcImNsaXBEYXRhXCIgb2JqZWN0OyBvdGhlcndpc2UgYHVuZGVmaW5lZGAuXG4gKiBAc3RhdGljXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5lbWl0ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIF9lbWl0LmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIENyZWF0ZSBhbmQgZW1iZWQgdGhlIEZsYXNoIG9iamVjdC5cbiAqXG4gKiBAcmV0dXJucyBUaGUgRmxhc2ggb2JqZWN0XG4gKiBAc3RhdGljXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5jcmVhdGUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX2NyZWF0ZS5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBTZWxmLWRlc3RydWN0IGFuZCBjbGVhbiB1cCBldmVyeXRoaW5nLCBpbmNsdWRpbmcgdGhlIGVtYmVkZGVkIEZsYXNoIG9iamVjdC5cbiAqXG4gKiBAcmV0dXJucyBgdW5kZWZpbmVkYFxuICogQHN0YXRpY1xuICovXG4gIFplcm9DbGlwYm9hcmQuZGVzdHJveSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfZGVzdHJveS5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBTZXQgdGhlIHBlbmRpbmcgZGF0YSBmb3IgY2xpcGJvYXJkIGluamVjdGlvbi5cbiAqXG4gKiBAcmV0dXJucyBgdW5kZWZpbmVkYFxuICogQHN0YXRpY1xuICovXG4gIFplcm9DbGlwYm9hcmQuc2V0RGF0YSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfc2V0RGF0YS5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBDbGVhciB0aGUgcGVuZGluZyBkYXRhIGZvciBjbGlwYm9hcmQgaW5qZWN0aW9uLlxuICogSWYgbm8gYGZvcm1hdGAgaXMgcHJvdmlkZWQsIGFsbCBwZW5kaW5nIGRhdGEgZm9ybWF0cyB3aWxsIGJlIGNsZWFyZWQuXG4gKlxuICogQHJldHVybnMgYHVuZGVmaW5lZGBcbiAqIEBzdGF0aWNcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLmNsZWFyRGF0YSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfY2xlYXJEYXRhLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIEdldCBhIGNvcHkgb2YgdGhlIHBlbmRpbmcgZGF0YSBmb3IgY2xpcGJvYXJkIGluamVjdGlvbi5cbiAqIElmIG5vIGBmb3JtYXRgIGlzIHByb3ZpZGVkLCBhIGNvcHkgb2YgQUxMIHBlbmRpbmcgZGF0YSBmb3JtYXRzIHdpbGwgYmUgcmV0dXJuZWQuXG4gKlxuICogQHJldHVybnMgYFN0cmluZ2Agb3IgYE9iamVjdGBcbiAqIEBzdGF0aWNcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLmdldERhdGEgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX2dldERhdGEuYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gIH07XG4gIC8qKlxuICogU2V0cyB0aGUgY3VycmVudCBIVE1MIG9iamVjdCB0aGF0IHRoZSBGbGFzaCBvYmplY3Qgc2hvdWxkIG92ZXJsYXkuIFRoaXMgd2lsbCBwdXQgdGhlIGdsb2JhbFxuICogRmxhc2ggb2JqZWN0IG9uIHRvcCBvZiB0aGUgY3VycmVudCBlbGVtZW50OyBkZXBlbmRpbmcgb24gdGhlIHNldHVwLCB0aGlzIG1heSBhbHNvIHNldCB0aGVcbiAqIHBlbmRpbmcgY2xpcGJvYXJkIHRleHQgZGF0YSBhcyB3ZWxsIGFzIHRoZSBGbGFzaCBvYmplY3QncyB3cmFwcGluZyBlbGVtZW50J3MgdGl0bGUgYXR0cmlidXRlXG4gKiBiYXNlZCBvbiB0aGUgdW5kZXJseWluZyBIVE1MIGVsZW1lbnQgYW5kIFplcm9DbGlwYm9hcmQgY29uZmlndXJhdGlvbi5cbiAqXG4gKiBAcmV0dXJucyBgdW5kZWZpbmVkYFxuICogQHN0YXRpY1xuICovXG4gIFplcm9DbGlwYm9hcmQuZm9jdXMgPSBaZXJvQ2xpcGJvYXJkLmFjdGl2YXRlID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIF9mb2N1cy5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBVbi1vdmVybGF5cyB0aGUgRmxhc2ggb2JqZWN0LiBUaGlzIHdpbGwgcHV0IHRoZSBnbG9iYWwgRmxhc2ggb2JqZWN0IG9mZi1zY3JlZW47IGRlcGVuZGluZyBvblxuICogdGhlIHNldHVwLCB0aGlzIG1heSBhbHNvIHVuc2V0IHRoZSBGbGFzaCBvYmplY3QncyB3cmFwcGluZyBlbGVtZW50J3MgdGl0bGUgYXR0cmlidXRlIGJhc2VkIG9uXG4gKiB0aGUgdW5kZXJseWluZyBIVE1MIGVsZW1lbnQgYW5kIFplcm9DbGlwYm9hcmQgY29uZmlndXJhdGlvbi5cbiAqXG4gKiBAcmV0dXJucyBgdW5kZWZpbmVkYFxuICogQHN0YXRpY1xuICovXG4gIFplcm9DbGlwYm9hcmQuYmx1ciA9IFplcm9DbGlwYm9hcmQuZGVhY3RpdmF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfYmx1ci5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBSZXR1cm5zIHRoZSBjdXJyZW50bHkgZm9jdXNlZC9cImFjdGl2YXRlZFwiIEhUTUwgZWxlbWVudCB0aGF0IHRoZSBGbGFzaCBvYmplY3QgaXMgd3JhcHBpbmcuXG4gKlxuICogQHJldHVybnMgYEhUTUxFbGVtZW50YCBvciBgbnVsbGBcbiAqIEBzdGF0aWNcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLmFjdGl2ZUVsZW1lbnQgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX2FjdGl2ZUVsZW1lbnQuYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gIH07XG4gIC8qKlxuICogS2VlcCB0cmFjayBvZiB0aGUgWmVyb0NsaXBib2FyZCBjbGllbnQgaW5zdGFuY2UgY291bnRlci5cbiAqL1xuICB2YXIgX2NsaWVudElkQ291bnRlciA9IDA7XG4gIC8qKlxuICogS2VlcCB0cmFjayBvZiB0aGUgc3RhdGUgb2YgdGhlIGNsaWVudCBpbnN0YW5jZXMuXG4gKlxuICogRW50cnkgc3RydWN0dXJlOlxuICogICBfY2xpZW50TWV0YVtjbGllbnQuaWRdID0ge1xuICogICAgIGluc3RhbmNlOiBjbGllbnQsXG4gKiAgICAgZWxlbWVudHM6IFtdLFxuICogICAgIGhhbmRsZXJzOiB7fVxuICogICB9O1xuICovXG4gIHZhciBfY2xpZW50TWV0YSA9IHt9O1xuICAvKipcbiAqIEtlZXAgdHJhY2sgb2YgdGhlIFplcm9DbGlwYm9hcmQgY2xpcHBlZCBlbGVtZW50cyBjb3VudGVyLlxuICovXG4gIHZhciBfZWxlbWVudElkQ291bnRlciA9IDA7XG4gIC8qKlxuICogS2VlcCB0cmFjayBvZiB0aGUgc3RhdGUgb2YgdGhlIGNsaXBwZWQgZWxlbWVudCByZWxhdGlvbnNoaXBzIHRvIGNsaWVudHMuXG4gKlxuICogRW50cnkgc3RydWN0dXJlOlxuICogICBfZWxlbWVudE1ldGFbZWxlbWVudC56Y0NsaXBwaW5nSWRdID0gW2NsaWVudDEuaWQsIGNsaWVudDIuaWRdO1xuICovXG4gIHZhciBfZWxlbWVudE1ldGEgPSB7fTtcbiAgLyoqXG4gKiBLZWVwIHRyYWNrIG9mIHRoZSBzdGF0ZSBvZiB0aGUgbW91c2UgZXZlbnQgaGFuZGxlcnMgZm9yIGNsaXBwZWQgZWxlbWVudHMuXG4gKlxuICogRW50cnkgc3RydWN0dXJlOlxuICogICBfbW91c2VIYW5kbGVyc1tlbGVtZW50LnpjQ2xpcHBpbmdJZF0gPSB7XG4gKiAgICAgbW91c2VvdmVyOiAgZnVuY3Rpb24oZXZlbnQpIHt9LFxuICogICAgIG1vdXNlb3V0OiAgIGZ1bmN0aW9uKGV2ZW50KSB7fSxcbiAqICAgICBtb3VzZWVudGVyOiBmdW5jdGlvbihldmVudCkge30sXG4gKiAgICAgbW91c2VsZWF2ZTogZnVuY3Rpb24oZXZlbnQpIHt9LFxuICogICAgIG1vdXNlbW92ZTogIGZ1bmN0aW9uKGV2ZW50KSB7fVxuICogICB9O1xuICovXG4gIHZhciBfbW91c2VIYW5kbGVycyA9IHt9O1xuICAvKipcbiAqIEV4dGVuZGluZyB0aGUgWmVyb0NsaXBib2FyZCBjb25maWd1cmF0aW9uIGRlZmF1bHRzIGZvciB0aGUgQ2xpZW50IG1vZHVsZS5cbiAqL1xuICBfZXh0ZW5kKF9nbG9iYWxDb25maWcsIHtcbiAgICBhdXRvQWN0aXZhdGU6IHRydWVcbiAgfSk7XG4gIC8qKlxuICogVGhlIHJlYWwgY29uc3RydWN0b3IgZm9yIGBaZXJvQ2xpcGJvYXJkYCBjbGllbnQgaW5zdGFuY2VzLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2NsaWVudENvbnN0cnVjdG9yID0gZnVuY3Rpb24oZWxlbWVudHMpIHtcbiAgICB2YXIgY2xpZW50ID0gdGhpcztcbiAgICBjbGllbnQuaWQgPSBcIlwiICsgX2NsaWVudElkQ291bnRlcisrO1xuICAgIF9jbGllbnRNZXRhW2NsaWVudC5pZF0gPSB7XG4gICAgICBpbnN0YW5jZTogY2xpZW50LFxuICAgICAgZWxlbWVudHM6IFtdLFxuICAgICAgaGFuZGxlcnM6IHt9XG4gICAgfTtcbiAgICBpZiAoZWxlbWVudHMpIHtcbiAgICAgIGNsaWVudC5jbGlwKGVsZW1lbnRzKTtcbiAgICB9XG4gICAgWmVyb0NsaXBib2FyZC5vbihcIipcIiwgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIHJldHVybiBjbGllbnQuZW1pdChldmVudCk7XG4gICAgfSk7XG4gICAgWmVyb0NsaXBib2FyZC5vbihcImRlc3Ryb3lcIiwgZnVuY3Rpb24oKSB7XG4gICAgICBjbGllbnQuZGVzdHJveSgpO1xuICAgIH0pO1xuICAgIFplcm9DbGlwYm9hcmQuY3JlYXRlKCk7XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuQ2xpZW50LnByb3RvdHlwZS5vbmAuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY2xpZW50T24gPSBmdW5jdGlvbihldmVudFR5cGUsIGxpc3RlbmVyKSB7XG4gICAgdmFyIGksIGxlbiwgZXZlbnRzLCBhZGRlZCA9IHt9LCBtZXRhID0gX2NsaWVudE1ldGFbdGhpcy5pZF0sIGhhbmRsZXJzID0gbWV0YSAmJiBtZXRhLmhhbmRsZXJzO1xuICAgIGlmICghbWV0YSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQXR0ZW1wdGVkIHRvIGFkZCBuZXcgbGlzdGVuZXIocykgdG8gYSBkZXN0cm95ZWQgWmVyb0NsaXBib2FyZCBjbGllbnQgaW5zdGFuY2VcIik7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgZXZlbnRUeXBlID09PSBcInN0cmluZ1wiICYmIGV2ZW50VHlwZSkge1xuICAgICAgZXZlbnRzID0gZXZlbnRUeXBlLnRvTG93ZXJDYXNlKCkuc3BsaXQoL1xccysvKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBldmVudFR5cGUgPT09IFwib2JqZWN0XCIgJiYgZXZlbnRUeXBlICYmIHR5cGVvZiBsaXN0ZW5lciA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgZm9yIChpIGluIGV2ZW50VHlwZSkge1xuICAgICAgICBpZiAoX2hhc093bi5jYWxsKGV2ZW50VHlwZSwgaSkgJiYgdHlwZW9mIGkgPT09IFwic3RyaW5nXCIgJiYgaSAmJiB0eXBlb2YgZXZlbnRUeXBlW2ldID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICB0aGlzLm9uKGksIGV2ZW50VHlwZVtpXSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGV2ZW50cyAmJiBldmVudHMubGVuZ3RoKSB7XG4gICAgICBmb3IgKGkgPSAwLCBsZW4gPSBldmVudHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgZXZlbnRUeXBlID0gZXZlbnRzW2ldLnJlcGxhY2UoL15vbi8sIFwiXCIpO1xuICAgICAgICBhZGRlZFtldmVudFR5cGVdID0gdHJ1ZTtcbiAgICAgICAgaWYgKCFoYW5kbGVyc1tldmVudFR5cGVdKSB7XG4gICAgICAgICAgaGFuZGxlcnNbZXZlbnRUeXBlXSA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIGhhbmRsZXJzW2V2ZW50VHlwZV0ucHVzaChsaXN0ZW5lcik7XG4gICAgICB9XG4gICAgICBpZiAoYWRkZWQucmVhZHkgJiYgX2ZsYXNoU3RhdGUucmVhZHkpIHtcbiAgICAgICAgdGhpcy5lbWl0KHtcbiAgICAgICAgICB0eXBlOiBcInJlYWR5XCIsXG4gICAgICAgICAgY2xpZW50OiB0aGlzXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgaWYgKGFkZGVkLmVycm9yKSB7XG4gICAgICAgIGZvciAoaSA9IDAsIGxlbiA9IF9mbGFzaFN0YXRlRXJyb3JOYW1lcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgIGlmIChfZmxhc2hTdGF0ZVtfZmxhc2hTdGF0ZUVycm9yTmFtZXNbaV0ucmVwbGFjZSgvXmZsYXNoLS8sIFwiXCIpXSkge1xuICAgICAgICAgICAgdGhpcy5lbWl0KHtcbiAgICAgICAgICAgICAgdHlwZTogXCJlcnJvclwiLFxuICAgICAgICAgICAgICBuYW1lOiBfZmxhc2hTdGF0ZUVycm9yTmFtZXNbaV0sXG4gICAgICAgICAgICAgIGNsaWVudDogdGhpc1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKF96Y1N3ZlZlcnNpb24gIT09IHVuZGVmaW5lZCAmJiBaZXJvQ2xpcGJvYXJkLnZlcnNpb24gIT09IF96Y1N3ZlZlcnNpb24pIHtcbiAgICAgICAgICB0aGlzLmVtaXQoe1xuICAgICAgICAgICAgdHlwZTogXCJlcnJvclwiLFxuICAgICAgICAgICAgbmFtZTogXCJ2ZXJzaW9uLW1pc21hdGNoXCIsXG4gICAgICAgICAgICBqc1ZlcnNpb246IFplcm9DbGlwYm9hcmQudmVyc2lvbixcbiAgICAgICAgICAgIHN3ZlZlcnNpb246IF96Y1N3ZlZlcnNpb25cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcbiAgLyoqXG4gKiBUaGUgdW5kZXJseWluZyBpbXBsZW1lbnRhdGlvbiBvZiBgWmVyb0NsaXBib2FyZC5DbGllbnQucHJvdG90eXBlLm9mZmAuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY2xpZW50T2ZmID0gZnVuY3Rpb24oZXZlbnRUeXBlLCBsaXN0ZW5lcikge1xuICAgIHZhciBpLCBsZW4sIGZvdW5kSW5kZXgsIGV2ZW50cywgcGVyRXZlbnRIYW5kbGVycywgbWV0YSA9IF9jbGllbnRNZXRhW3RoaXMuaWRdLCBoYW5kbGVycyA9IG1ldGEgJiYgbWV0YS5oYW5kbGVycztcbiAgICBpZiAoIWhhbmRsZXJzKSB7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApIHtcbiAgICAgIGV2ZW50cyA9IF9rZXlzKGhhbmRsZXJzKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBldmVudFR5cGUgPT09IFwic3RyaW5nXCIgJiYgZXZlbnRUeXBlKSB7XG4gICAgICBldmVudHMgPSBldmVudFR5cGUuc3BsaXQoL1xccysvKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBldmVudFR5cGUgPT09IFwib2JqZWN0XCIgJiYgZXZlbnRUeXBlICYmIHR5cGVvZiBsaXN0ZW5lciA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgZm9yIChpIGluIGV2ZW50VHlwZSkge1xuICAgICAgICBpZiAoX2hhc093bi5jYWxsKGV2ZW50VHlwZSwgaSkgJiYgdHlwZW9mIGkgPT09IFwic3RyaW5nXCIgJiYgaSAmJiB0eXBlb2YgZXZlbnRUeXBlW2ldID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICB0aGlzLm9mZihpLCBldmVudFR5cGVbaV0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChldmVudHMgJiYgZXZlbnRzLmxlbmd0aCkge1xuICAgICAgZm9yIChpID0gMCwgbGVuID0gZXZlbnRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGV2ZW50VHlwZSA9IGV2ZW50c1tpXS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL15vbi8sIFwiXCIpO1xuICAgICAgICBwZXJFdmVudEhhbmRsZXJzID0gaGFuZGxlcnNbZXZlbnRUeXBlXTtcbiAgICAgICAgaWYgKHBlckV2ZW50SGFuZGxlcnMgJiYgcGVyRXZlbnRIYW5kbGVycy5sZW5ndGgpIHtcbiAgICAgICAgICBpZiAobGlzdGVuZXIpIHtcbiAgICAgICAgICAgIGZvdW5kSW5kZXggPSBwZXJFdmVudEhhbmRsZXJzLmluZGV4T2YobGlzdGVuZXIpO1xuICAgICAgICAgICAgd2hpbGUgKGZvdW5kSW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgICAgIHBlckV2ZW50SGFuZGxlcnMuc3BsaWNlKGZvdW5kSW5kZXgsIDEpO1xuICAgICAgICAgICAgICBmb3VuZEluZGV4ID0gcGVyRXZlbnRIYW5kbGVycy5pbmRleE9mKGxpc3RlbmVyLCBmb3VuZEluZGV4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcGVyRXZlbnRIYW5kbGVycy5sZW5ndGggPSAwO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcbiAgLyoqXG4gKiBUaGUgdW5kZXJseWluZyBpbXBsZW1lbnRhdGlvbiBvZiBgWmVyb0NsaXBib2FyZC5DbGllbnQucHJvdG90eXBlLmhhbmRsZXJzYC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9jbGllbnRMaXN0ZW5lcnMgPSBmdW5jdGlvbihldmVudFR5cGUpIHtcbiAgICB2YXIgY29weSA9IG51bGwsIGhhbmRsZXJzID0gX2NsaWVudE1ldGFbdGhpcy5pZF0gJiYgX2NsaWVudE1ldGFbdGhpcy5pZF0uaGFuZGxlcnM7XG4gICAgaWYgKGhhbmRsZXJzKSB7XG4gICAgICBpZiAodHlwZW9mIGV2ZW50VHlwZSA9PT0gXCJzdHJpbmdcIiAmJiBldmVudFR5cGUpIHtcbiAgICAgICAgY29weSA9IGhhbmRsZXJzW2V2ZW50VHlwZV0gPyBoYW5kbGVyc1tldmVudFR5cGVdLnNsaWNlKDApIDogW107XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb3B5ID0gX2RlZXBDb3B5KGhhbmRsZXJzKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGNvcHk7XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuQ2xpZW50LnByb3RvdHlwZS5lbWl0YC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9jbGllbnRFbWl0ID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICBpZiAoX2NsaWVudFNob3VsZEVtaXQuY2FsbCh0aGlzLCBldmVudCkpIHtcbiAgICAgIGlmICh0eXBlb2YgZXZlbnQgPT09IFwib2JqZWN0XCIgJiYgZXZlbnQgJiYgdHlwZW9mIGV2ZW50LnR5cGUgPT09IFwic3RyaW5nXCIgJiYgZXZlbnQudHlwZSkge1xuICAgICAgICBldmVudCA9IF9leHRlbmQoe30sIGV2ZW50KTtcbiAgICAgIH1cbiAgICAgIHZhciBldmVudENvcHkgPSBfZXh0ZW5kKHt9LCBfY3JlYXRlRXZlbnQoZXZlbnQpLCB7XG4gICAgICAgIGNsaWVudDogdGhpc1xuICAgICAgfSk7XG4gICAgICBfY2xpZW50RGlzcGF0Y2hDYWxsYmFja3MuY2FsbCh0aGlzLCBldmVudENvcHkpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcbiAgLyoqXG4gKiBUaGUgdW5kZXJseWluZyBpbXBsZW1lbnRhdGlvbiBvZiBgWmVyb0NsaXBib2FyZC5DbGllbnQucHJvdG90eXBlLmNsaXBgLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2NsaWVudENsaXAgPSBmdW5jdGlvbihlbGVtZW50cykge1xuICAgIGlmICghX2NsaWVudE1ldGFbdGhpcy5pZF0pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkF0dGVtcHRlZCB0byBjbGlwIGVsZW1lbnQocykgdG8gYSBkZXN0cm95ZWQgWmVyb0NsaXBib2FyZCBjbGllbnQgaW5zdGFuY2VcIik7XG4gICAgfVxuICAgIGVsZW1lbnRzID0gX3ByZXBDbGlwKGVsZW1lbnRzKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoX2hhc093bi5jYWxsKGVsZW1lbnRzLCBpKSAmJiBlbGVtZW50c1tpXSAmJiBlbGVtZW50c1tpXS5ub2RlVHlwZSA9PT0gMSkge1xuICAgICAgICBpZiAoIWVsZW1lbnRzW2ldLnpjQ2xpcHBpbmdJZCkge1xuICAgICAgICAgIGVsZW1lbnRzW2ldLnpjQ2xpcHBpbmdJZCA9IFwiemNDbGlwcGluZ0lkX1wiICsgX2VsZW1lbnRJZENvdW50ZXIrKztcbiAgICAgICAgICBfZWxlbWVudE1ldGFbZWxlbWVudHNbaV0uemNDbGlwcGluZ0lkXSA9IFsgdGhpcy5pZCBdO1xuICAgICAgICAgIGlmIChfZ2xvYmFsQ29uZmlnLmF1dG9BY3RpdmF0ZSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgX2FkZE1vdXNlSGFuZGxlcnMoZWxlbWVudHNbaV0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChfZWxlbWVudE1ldGFbZWxlbWVudHNbaV0uemNDbGlwcGluZ0lkXS5pbmRleE9mKHRoaXMuaWQpID09PSAtMSkge1xuICAgICAgICAgIF9lbGVtZW50TWV0YVtlbGVtZW50c1tpXS56Y0NsaXBwaW5nSWRdLnB1c2godGhpcy5pZCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNsaXBwZWRFbGVtZW50cyA9IF9jbGllbnRNZXRhW3RoaXMuaWRdICYmIF9jbGllbnRNZXRhW3RoaXMuaWRdLmVsZW1lbnRzO1xuICAgICAgICBpZiAoY2xpcHBlZEVsZW1lbnRzLmluZGV4T2YoZWxlbWVudHNbaV0pID09PSAtMSkge1xuICAgICAgICAgIGNsaXBwZWRFbGVtZW50cy5wdXNoKGVsZW1lbnRzW2ldKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcbiAgLyoqXG4gKiBUaGUgdW5kZXJseWluZyBpbXBsZW1lbnRhdGlvbiBvZiBgWmVyb0NsaXBib2FyZC5DbGllbnQucHJvdG90eXBlLnVuY2xpcGAuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY2xpZW50VW5jbGlwID0gZnVuY3Rpb24oZWxlbWVudHMpIHtcbiAgICB2YXIgbWV0YSA9IF9jbGllbnRNZXRhW3RoaXMuaWRdO1xuICAgIGlmICghbWV0YSkge1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHZhciBjbGlwcGVkRWxlbWVudHMgPSBtZXRhLmVsZW1lbnRzO1xuICAgIHZhciBhcnJheUluZGV4O1xuICAgIGlmICh0eXBlb2YgZWxlbWVudHMgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIGVsZW1lbnRzID0gY2xpcHBlZEVsZW1lbnRzLnNsaWNlKDApO1xuICAgIH0gZWxzZSB7XG4gICAgICBlbGVtZW50cyA9IF9wcmVwQ2xpcChlbGVtZW50cyk7XG4gICAgfVxuICAgIGZvciAodmFyIGkgPSBlbGVtZW50cy5sZW5ndGg7IGktLTsgKSB7XG4gICAgICBpZiAoX2hhc093bi5jYWxsKGVsZW1lbnRzLCBpKSAmJiBlbGVtZW50c1tpXSAmJiBlbGVtZW50c1tpXS5ub2RlVHlwZSA9PT0gMSkge1xuICAgICAgICBhcnJheUluZGV4ID0gMDtcbiAgICAgICAgd2hpbGUgKChhcnJheUluZGV4ID0gY2xpcHBlZEVsZW1lbnRzLmluZGV4T2YoZWxlbWVudHNbaV0sIGFycmF5SW5kZXgpKSAhPT0gLTEpIHtcbiAgICAgICAgICBjbGlwcGVkRWxlbWVudHMuc3BsaWNlKGFycmF5SW5kZXgsIDEpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjbGllbnRJZHMgPSBfZWxlbWVudE1ldGFbZWxlbWVudHNbaV0uemNDbGlwcGluZ0lkXTtcbiAgICAgICAgaWYgKGNsaWVudElkcykge1xuICAgICAgICAgIGFycmF5SW5kZXggPSAwO1xuICAgICAgICAgIHdoaWxlICgoYXJyYXlJbmRleCA9IGNsaWVudElkcy5pbmRleE9mKHRoaXMuaWQsIGFycmF5SW5kZXgpKSAhPT0gLTEpIHtcbiAgICAgICAgICAgIGNsaWVudElkcy5zcGxpY2UoYXJyYXlJbmRleCwgMSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChjbGllbnRJZHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBpZiAoX2dsb2JhbENvbmZpZy5hdXRvQWN0aXZhdGUgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgX3JlbW92ZU1vdXNlSGFuZGxlcnMoZWxlbWVudHNbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVsZXRlIGVsZW1lbnRzW2ldLnpjQ2xpcHBpbmdJZDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuQ2xpZW50LnByb3RvdHlwZS5lbGVtZW50c2AuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY2xpZW50RWxlbWVudHMgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgbWV0YSA9IF9jbGllbnRNZXRhW3RoaXMuaWRdO1xuICAgIHJldHVybiBtZXRhICYmIG1ldGEuZWxlbWVudHMgPyBtZXRhLmVsZW1lbnRzLnNsaWNlKDApIDogW107XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuQ2xpZW50LnByb3RvdHlwZS5kZXN0cm95YC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9jbGllbnREZXN0cm95ID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKCFfY2xpZW50TWV0YVt0aGlzLmlkXSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLnVuY2xpcCgpO1xuICAgIHRoaXMub2ZmKCk7XG4gICAgZGVsZXRlIF9jbGllbnRNZXRhW3RoaXMuaWRdO1xuICB9O1xuICAvKipcbiAqIEluc3BlY3QgYW4gRXZlbnQgdG8gc2VlIGlmIHRoZSBDbGllbnQgKGB0aGlzYCkgc2hvdWxkIGhvbm9yIGl0IGZvciBlbWlzc2lvbi5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9jbGllbnRTaG91bGRFbWl0ID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICBpZiAoIShldmVudCAmJiBldmVudC50eXBlKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAoZXZlbnQuY2xpZW50ICYmIGV2ZW50LmNsaWVudCAhPT0gdGhpcykge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2YXIgbWV0YSA9IF9jbGllbnRNZXRhW3RoaXMuaWRdO1xuICAgIHZhciBjbGlwcGVkRWxzID0gbWV0YSAmJiBtZXRhLmVsZW1lbnRzO1xuICAgIHZhciBoYXNDbGlwcGVkRWxzID0gISFjbGlwcGVkRWxzICYmIGNsaXBwZWRFbHMubGVuZ3RoID4gMDtcbiAgICB2YXIgZ29vZFRhcmdldCA9ICFldmVudC50YXJnZXQgfHwgaGFzQ2xpcHBlZEVscyAmJiBjbGlwcGVkRWxzLmluZGV4T2YoZXZlbnQudGFyZ2V0KSAhPT0gLTE7XG4gICAgdmFyIGdvb2RSZWxUYXJnZXQgPSBldmVudC5yZWxhdGVkVGFyZ2V0ICYmIGhhc0NsaXBwZWRFbHMgJiYgY2xpcHBlZEVscy5pbmRleE9mKGV2ZW50LnJlbGF0ZWRUYXJnZXQpICE9PSAtMTtcbiAgICB2YXIgZ29vZENsaWVudCA9IGV2ZW50LmNsaWVudCAmJiBldmVudC5jbGllbnQgPT09IHRoaXM7XG4gICAgaWYgKCFtZXRhIHx8ICEoZ29vZFRhcmdldCB8fCBnb29kUmVsVGFyZ2V0IHx8IGdvb2RDbGllbnQpKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xuICB9O1xuICAvKipcbiAqIEhhbmRsZSB0aGUgYWN0dWFsIGRpc3BhdGNoaW5nIG9mIGV2ZW50cyB0byBhIGNsaWVudCBpbnN0YW5jZS5cbiAqXG4gKiBAcmV0dXJucyBgdW5kZWZpbmVkYFxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2NsaWVudERpc3BhdGNoQ2FsbGJhY2tzID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICB2YXIgbWV0YSA9IF9jbGllbnRNZXRhW3RoaXMuaWRdO1xuICAgIGlmICghKHR5cGVvZiBldmVudCA9PT0gXCJvYmplY3RcIiAmJiBldmVudCAmJiBldmVudC50eXBlICYmIG1ldGEpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBhc3luYyA9IF9zaG91bGRQZXJmb3JtQXN5bmMoZXZlbnQpO1xuICAgIHZhciB3aWxkY2FyZFR5cGVIYW5kbGVycyA9IG1ldGEgJiYgbWV0YS5oYW5kbGVyc1tcIipcIl0gfHwgW107XG4gICAgdmFyIHNwZWNpZmljVHlwZUhhbmRsZXJzID0gbWV0YSAmJiBtZXRhLmhhbmRsZXJzW2V2ZW50LnR5cGVdIHx8IFtdO1xuICAgIHZhciBoYW5kbGVycyA9IHdpbGRjYXJkVHlwZUhhbmRsZXJzLmNvbmNhdChzcGVjaWZpY1R5cGVIYW5kbGVycyk7XG4gICAgaWYgKGhhbmRsZXJzICYmIGhhbmRsZXJzLmxlbmd0aCkge1xuICAgICAgdmFyIGksIGxlbiwgZnVuYywgY29udGV4dCwgZXZlbnRDb3B5LCBvcmlnaW5hbENvbnRleHQgPSB0aGlzO1xuICAgICAgZm9yIChpID0gMCwgbGVuID0gaGFuZGxlcnMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgZnVuYyA9IGhhbmRsZXJzW2ldO1xuICAgICAgICBjb250ZXh0ID0gb3JpZ2luYWxDb250ZXh0O1xuICAgICAgICBpZiAodHlwZW9mIGZ1bmMgPT09IFwic3RyaW5nXCIgJiYgdHlwZW9mIF93aW5kb3dbZnVuY10gPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgIGZ1bmMgPSBfd2luZG93W2Z1bmNdO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgZnVuYyA9PT0gXCJvYmplY3RcIiAmJiBmdW5jICYmIHR5cGVvZiBmdW5jLmhhbmRsZUV2ZW50ID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICBjb250ZXh0ID0gZnVuYztcbiAgICAgICAgICBmdW5jID0gZnVuYy5oYW5kbGVFdmVudDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGZ1bmMgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgIGV2ZW50Q29weSA9IF9leHRlbmQoe30sIGV2ZW50KTtcbiAgICAgICAgICBfZGlzcGF0Y2hDYWxsYmFjayhmdW5jLCBjb250ZXh0LCBbIGV2ZW50Q29weSBdLCBhc3luYyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH07XG4gIC8qKlxuICogUHJlcGFyZXMgdGhlIGVsZW1lbnRzIGZvciBjbGlwcGluZy91bmNsaXBwaW5nLlxuICpcbiAqIEByZXR1cm5zIEFuIEFycmF5IG9mIGVsZW1lbnRzLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX3ByZXBDbGlwID0gZnVuY3Rpb24oZWxlbWVudHMpIHtcbiAgICBpZiAodHlwZW9mIGVsZW1lbnRzID09PSBcInN0cmluZ1wiKSB7XG4gICAgICBlbGVtZW50cyA9IFtdO1xuICAgIH1cbiAgICByZXR1cm4gdHlwZW9mIGVsZW1lbnRzLmxlbmd0aCAhPT0gXCJudW1iZXJcIiA/IFsgZWxlbWVudHMgXSA6IGVsZW1lbnRzO1xuICB9O1xuICAvKipcbiAqIEFkZCBhIGBtb3VzZW92ZXJgIGhhbmRsZXIgZnVuY3Rpb24gZm9yIGEgY2xpcHBlZCBlbGVtZW50LlxuICpcbiAqIEByZXR1cm5zIGB1bmRlZmluZWRgXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfYWRkTW91c2VIYW5kbGVycyA9IGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICBpZiAoIShlbGVtZW50ICYmIGVsZW1lbnQubm9kZVR5cGUgPT09IDEpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBfc3VwcHJlc3NNb3VzZUV2ZW50cyA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICBpZiAoIShldmVudCB8fCAoZXZlbnQgPSBfd2luZG93LmV2ZW50KSkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKGV2ZW50Ll9zb3VyY2UgIT09IFwianNcIikge1xuICAgICAgICBldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIH1cbiAgICAgIGRlbGV0ZSBldmVudC5fc291cmNlO1xuICAgIH07XG4gICAgdmFyIF9lbGVtZW50TW91c2VPdmVyID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIGlmICghKGV2ZW50IHx8IChldmVudCA9IF93aW5kb3cuZXZlbnQpKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBfc3VwcHJlc3NNb3VzZUV2ZW50cyhldmVudCk7XG4gICAgICBaZXJvQ2xpcGJvYXJkLmZvY3VzKGVsZW1lbnQpO1xuICAgIH07XG4gICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2VvdmVyXCIsIF9lbGVtZW50TW91c2VPdmVyLCBmYWxzZSk7XG4gICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2VvdXRcIiwgX3N1cHByZXNzTW91c2VFdmVudHMsIGZhbHNlKTtcbiAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWVudGVyXCIsIF9zdXBwcmVzc01vdXNlRXZlbnRzLCBmYWxzZSk7XG4gICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2VsZWF2ZVwiLCBfc3VwcHJlc3NNb3VzZUV2ZW50cywgZmFsc2UpO1xuICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCBfc3VwcHJlc3NNb3VzZUV2ZW50cywgZmFsc2UpO1xuICAgIF9tb3VzZUhhbmRsZXJzW2VsZW1lbnQuemNDbGlwcGluZ0lkXSA9IHtcbiAgICAgIG1vdXNlb3ZlcjogX2VsZW1lbnRNb3VzZU92ZXIsXG4gICAgICBtb3VzZW91dDogX3N1cHByZXNzTW91c2VFdmVudHMsXG4gICAgICBtb3VzZWVudGVyOiBfc3VwcHJlc3NNb3VzZUV2ZW50cyxcbiAgICAgIG1vdXNlbGVhdmU6IF9zdXBwcmVzc01vdXNlRXZlbnRzLFxuICAgICAgbW91c2Vtb3ZlOiBfc3VwcHJlc3NNb3VzZUV2ZW50c1xuICAgIH07XG4gIH07XG4gIC8qKlxuICogUmVtb3ZlIGEgYG1vdXNlb3ZlcmAgaGFuZGxlciBmdW5jdGlvbiBmb3IgYSBjbGlwcGVkIGVsZW1lbnQuXG4gKlxuICogQHJldHVybnMgYHVuZGVmaW5lZGBcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9yZW1vdmVNb3VzZUhhbmRsZXJzID0gZnVuY3Rpb24oZWxlbWVudCkge1xuICAgIGlmICghKGVsZW1lbnQgJiYgZWxlbWVudC5ub2RlVHlwZSA9PT0gMSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIG1vdXNlSGFuZGxlcnMgPSBfbW91c2VIYW5kbGVyc1tlbGVtZW50LnpjQ2xpcHBpbmdJZF07XG4gICAgaWYgKCEodHlwZW9mIG1vdXNlSGFuZGxlcnMgPT09IFwib2JqZWN0XCIgJiYgbW91c2VIYW5kbGVycykpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIGtleSwgdmFsLCBtb3VzZUV2ZW50cyA9IFsgXCJtb3ZlXCIsIFwibGVhdmVcIiwgXCJlbnRlclwiLCBcIm91dFwiLCBcIm92ZXJcIiBdO1xuICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBtb3VzZUV2ZW50cy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAga2V5ID0gXCJtb3VzZVwiICsgbW91c2VFdmVudHNbaV07XG4gICAgICB2YWwgPSBtb3VzZUhhbmRsZXJzW2tleV07XG4gICAgICBpZiAodHlwZW9mIHZhbCA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIGVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihrZXksIHZhbCwgZmFsc2UpO1xuICAgICAgfVxuICAgIH1cbiAgICBkZWxldGUgX21vdXNlSGFuZGxlcnNbZWxlbWVudC56Y0NsaXBwaW5nSWRdO1xuICB9O1xuICAvKipcbiAqIENyZWF0ZXMgYSBuZXcgWmVyb0NsaXBib2FyZCBjbGllbnQgaW5zdGFuY2UuXG4gKiBPcHRpb25hbGx5LCBhdXRvLWBjbGlwYCBhbiBlbGVtZW50IG9yIGNvbGxlY3Rpb24gb2YgZWxlbWVudHMuXG4gKlxuICogQGNvbnN0cnVjdG9yXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5fY3JlYXRlQ2xpZW50ID0gZnVuY3Rpb24oKSB7XG4gICAgX2NsaWVudENvbnN0cnVjdG9yLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIFJlZ2lzdGVyIGFuIGV2ZW50IGxpc3RlbmVyIHRvIHRoZSBjbGllbnQuXG4gKlxuICogQHJldHVybnMgYHRoaXNgXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5wcm90b3R5cGUub24gPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX2NsaWVudE9uLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIFVucmVnaXN0ZXIgYW4gZXZlbnQgaGFuZGxlciBmcm9tIHRoZSBjbGllbnQuXG4gKiBJZiBubyBgbGlzdGVuZXJgIGZ1bmN0aW9uL29iamVjdCBpcyBwcm92aWRlZCwgaXQgd2lsbCB1bnJlZ2lzdGVyIGFsbCBoYW5kbGVycyBmb3IgdGhlIHByb3ZpZGVkIGBldmVudFR5cGVgLlxuICogSWYgbm8gYGV2ZW50VHlwZWAgaXMgcHJvdmlkZWQsIGl0IHdpbGwgdW5yZWdpc3RlciBhbGwgaGFuZGxlcnMgZm9yIGV2ZXJ5IGV2ZW50IHR5cGUuXG4gKlxuICogQHJldHVybnMgYHRoaXNgXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5wcm90b3R5cGUub2ZmID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIF9jbGllbnRPZmYuYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gIH07XG4gIC8qKlxuICogUmV0cmlldmUgZXZlbnQgbGlzdGVuZXJzIGZvciBhbiBgZXZlbnRUeXBlYCBmcm9tIHRoZSBjbGllbnQuXG4gKiBJZiBubyBgZXZlbnRUeXBlYCBpcyBwcm92aWRlZCwgaXQgd2lsbCByZXRyaWV2ZSBhbGwgbGlzdGVuZXJzIGZvciBldmVyeSBldmVudCB0eXBlLlxuICpcbiAqIEByZXR1cm5zIGFycmF5IG9mIGxpc3RlbmVycyBmb3IgdGhlIGBldmVudFR5cGVgOyBpZiBubyBgZXZlbnRUeXBlYCwgdGhlbiBhIG1hcC9oYXNoIG9iamVjdCBvZiBsaXN0ZW5lcnMgZm9yIGFsbCBldmVudCB0eXBlczsgb3IgYG51bGxgXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5wcm90b3R5cGUuaGFuZGxlcnMgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX2NsaWVudExpc3RlbmVycy5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBFdmVudCBlbWlzc2lvbiByZWNlaXZlciBmcm9tIHRoZSBGbGFzaCBvYmplY3QgZm9yIHRoaXMgY2xpZW50J3MgcmVnaXN0ZXJlZCBKYXZhU2NyaXB0IGV2ZW50IGxpc3RlbmVycy5cbiAqXG4gKiBAcmV0dXJucyBGb3IgdGhlIFwiY29weVwiIGV2ZW50LCByZXR1cm5zIHRoZSBGbGFzaC1mcmllbmRseSBcImNsaXBEYXRhXCIgb2JqZWN0OyBvdGhlcndpc2UgYHVuZGVmaW5lZGAuXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5wcm90b3R5cGUuZW1pdCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfY2xpZW50RW1pdC5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBSZWdpc3RlciBjbGlwYm9hcmQgYWN0aW9ucyBmb3IgbmV3IGVsZW1lbnQocykgdG8gdGhlIGNsaWVudC5cbiAqXG4gKiBAcmV0dXJucyBgdGhpc2BcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLnByb3RvdHlwZS5jbGlwID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIF9jbGllbnRDbGlwLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIFVucmVnaXN0ZXIgdGhlIGNsaXBib2FyZCBhY3Rpb25zIG9mIHByZXZpb3VzbHkgcmVnaXN0ZXJlZCBlbGVtZW50KHMpIG9uIHRoZSBwYWdlLlxuICogSWYgbm8gZWxlbWVudHMgYXJlIHByb3ZpZGVkLCBBTEwgcmVnaXN0ZXJlZCBlbGVtZW50cyB3aWxsIGJlIHVucmVnaXN0ZXJlZC5cbiAqXG4gKiBAcmV0dXJucyBgdGhpc2BcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLnByb3RvdHlwZS51bmNsaXAgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX2NsaWVudFVuY2xpcC5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBHZXQgYWxsIG9mIHRoZSBlbGVtZW50cyB0byB3aGljaCB0aGlzIGNsaWVudCBpcyBjbGlwcGVkLlxuICpcbiAqIEByZXR1cm5zIGFycmF5IG9mIGNsaXBwZWQgZWxlbWVudHNcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLnByb3RvdHlwZS5lbGVtZW50cyA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfY2xpZW50RWxlbWVudHMuYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gIH07XG4gIC8qKlxuICogU2VsZi1kZXN0cnVjdCBhbmQgY2xlYW4gdXAgZXZlcnl0aGluZyBmb3IgYSBzaW5nbGUgY2xpZW50LlxuICogVGhpcyB3aWxsIE5PVCBkZXN0cm95IHRoZSBlbWJlZGRlZCBGbGFzaCBvYmplY3QuXG4gKlxuICogQHJldHVybnMgYHVuZGVmaW5lZGBcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIF9jbGllbnREZXN0cm95LmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIFN0b3JlcyB0aGUgcGVuZGluZyBwbGFpbiB0ZXh0IHRvIGluamVjdCBpbnRvIHRoZSBjbGlwYm9hcmQuXG4gKlxuICogQHJldHVybnMgYHRoaXNgXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5wcm90b3R5cGUuc2V0VGV4dCA9IGZ1bmN0aW9uKHRleHQpIHtcbiAgICBpZiAoIV9jbGllbnRNZXRhW3RoaXMuaWRdKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBdHRlbXB0ZWQgdG8gc2V0IHBlbmRpbmcgY2xpcGJvYXJkIGRhdGEgZnJvbSBhIGRlc3Ryb3llZCBaZXJvQ2xpcGJvYXJkIGNsaWVudCBpbnN0YW5jZVwiKTtcbiAgICB9XG4gICAgWmVyb0NsaXBib2FyZC5zZXREYXRhKFwidGV4dC9wbGFpblwiLCB0ZXh0KTtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcbiAgLyoqXG4gKiBTdG9yZXMgdGhlIHBlbmRpbmcgSFRNTCB0ZXh0IHRvIGluamVjdCBpbnRvIHRoZSBjbGlwYm9hcmQuXG4gKlxuICogQHJldHVybnMgYHRoaXNgXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5wcm90b3R5cGUuc2V0SHRtbCA9IGZ1bmN0aW9uKGh0bWwpIHtcbiAgICBpZiAoIV9jbGllbnRNZXRhW3RoaXMuaWRdKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBdHRlbXB0ZWQgdG8gc2V0IHBlbmRpbmcgY2xpcGJvYXJkIGRhdGEgZnJvbSBhIGRlc3Ryb3llZCBaZXJvQ2xpcGJvYXJkIGNsaWVudCBpbnN0YW5jZVwiKTtcbiAgICB9XG4gICAgWmVyb0NsaXBib2FyZC5zZXREYXRhKFwidGV4dC9odG1sXCIsIGh0bWwpO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuICAvKipcbiAqIFN0b3JlcyB0aGUgcGVuZGluZyByaWNoIHRleHQgKFJURikgdG8gaW5qZWN0IGludG8gdGhlIGNsaXBib2FyZC5cbiAqXG4gKiBAcmV0dXJucyBgdGhpc2BcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLnByb3RvdHlwZS5zZXRSaWNoVGV4dCA9IGZ1bmN0aW9uKHJpY2hUZXh0KSB7XG4gICAgaWYgKCFfY2xpZW50TWV0YVt0aGlzLmlkXSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQXR0ZW1wdGVkIHRvIHNldCBwZW5kaW5nIGNsaXBib2FyZCBkYXRhIGZyb20gYSBkZXN0cm95ZWQgWmVyb0NsaXBib2FyZCBjbGllbnQgaW5zdGFuY2VcIik7XG4gICAgfVxuICAgIFplcm9DbGlwYm9hcmQuc2V0RGF0YShcImFwcGxpY2F0aW9uL3J0ZlwiLCByaWNoVGV4dCk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG4gIC8qKlxuICogU3RvcmVzIHRoZSBwZW5kaW5nIGRhdGEgdG8gaW5qZWN0IGludG8gdGhlIGNsaXBib2FyZC5cbiAqXG4gKiBAcmV0dXJucyBgdGhpc2BcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLnByb3RvdHlwZS5zZXREYXRhID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKCFfY2xpZW50TWV0YVt0aGlzLmlkXSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQXR0ZW1wdGVkIHRvIHNldCBwZW5kaW5nIGNsaXBib2FyZCBkYXRhIGZyb20gYSBkZXN0cm95ZWQgWmVyb0NsaXBib2FyZCBjbGllbnQgaW5zdGFuY2VcIik7XG4gICAgfVxuICAgIFplcm9DbGlwYm9hcmQuc2V0RGF0YS5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcbiAgLyoqXG4gKiBDbGVhcnMgdGhlIHBlbmRpbmcgZGF0YSB0byBpbmplY3QgaW50byB0aGUgY2xpcGJvYXJkLlxuICogSWYgbm8gYGZvcm1hdGAgaXMgcHJvdmlkZWQsIGFsbCBwZW5kaW5nIGRhdGEgZm9ybWF0cyB3aWxsIGJlIGNsZWFyZWQuXG4gKlxuICogQHJldHVybnMgYHRoaXNgXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5wcm90b3R5cGUuY2xlYXJEYXRhID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKCFfY2xpZW50TWV0YVt0aGlzLmlkXSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQXR0ZW1wdGVkIHRvIGNsZWFyIHBlbmRpbmcgY2xpcGJvYXJkIGRhdGEgZnJvbSBhIGRlc3Ryb3llZCBaZXJvQ2xpcGJvYXJkIGNsaWVudCBpbnN0YW5jZVwiKTtcbiAgICB9XG4gICAgWmVyb0NsaXBib2FyZC5jbGVhckRhdGEuYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG4gIC8qKlxuICogR2V0cyBhIGNvcHkgb2YgdGhlIHBlbmRpbmcgZGF0YSB0byBpbmplY3QgaW50byB0aGUgY2xpcGJvYXJkLlxuICogSWYgbm8gYGZvcm1hdGAgaXMgcHJvdmlkZWQsIGEgY29weSBvZiBBTEwgcGVuZGluZyBkYXRhIGZvcm1hdHMgd2lsbCBiZSByZXR1cm5lZC5cbiAqXG4gKiBAcmV0dXJucyBgU3RyaW5nYCBvciBgT2JqZWN0YFxuICovXG4gIFplcm9DbGlwYm9hcmQucHJvdG90eXBlLmdldERhdGEgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAoIV9jbGllbnRNZXRhW3RoaXMuaWRdKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBdHRlbXB0ZWQgdG8gZ2V0IHBlbmRpbmcgY2xpcGJvYXJkIGRhdGEgZnJvbSBhIGRlc3Ryb3llZCBaZXJvQ2xpcGJvYXJkIGNsaWVudCBpbnN0YW5jZVwiKTtcbiAgICB9XG4gICAgcmV0dXJuIFplcm9DbGlwYm9hcmQuZ2V0RGF0YS5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgaWYgKHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kKSB7XG4gICAgZGVmaW5lKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIFplcm9DbGlwYm9hcmQ7XG4gICAgfSk7XG4gIH0gZWxzZSBpZiAodHlwZW9mIG1vZHVsZSA9PT0gXCJvYmplY3RcIiAmJiBtb2R1bGUgJiYgdHlwZW9mIG1vZHVsZS5leHBvcnRzID09PSBcIm9iamVjdFwiICYmIG1vZHVsZS5leHBvcnRzKSB7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSBaZXJvQ2xpcGJvYXJkO1xuICB9IGVsc2Uge1xuICAgIHdpbmRvdy5aZXJvQ2xpcGJvYXJkID0gWmVyb0NsaXBib2FyZDtcbiAgfVxufSkoZnVuY3Rpb24oKSB7XG4gIHJldHVybiB0aGlzIHx8IHdpbmRvdztcbn0oKSk7IiwiLypqc2xpbnQgYnJvd3NlcjogdHJ1ZSovXHJcbi8qanNoaW50IC1XMDU1ICovXHJcbi8qZ2xvYmFsIGNvbnNvbGUsIGFsZXJ0Ki9cclxuXHJcbi8qXHJcbiAqIEZvciBlYWNoIGRpc2Vhc2UgYXJlYSB0aGVyZSB3aWxsIGJlIDQgc3RhZ2VzOiBEaWFnbm9zaXMsIE1vbml0b3JpbmcsIFRyZWF0bWVudCBhbmQgRXhjbHVzaW9ucy5cclxuICogRWFjaCBzdGFnZSBnZXRzIGEgc2luZ2xlIHBhbmVsIG9uIHRoZSBmcm9udCBzY3JlZW4uXHJcbiAqIENsaWNraW5nIG9uIGEgcGFuZWwgdGFrZXMgeW91IHRvIGEgc2NyZWVuIHNwZWNpZmljIHRvIHRoYXQgc3RhZ2UsIGJ1dCBzaW1pbGFyIGluIGxheW91dCBhbmQgY29udGVudFxyXG4gKiAgdG8gYWxsIHRoZSBvdGhlcnMuXHJcbiAqL1xyXG5cclxudmFyIHRlbXBsYXRlID0gcmVxdWlyZSgnLi9zcmMvdGVtcGxhdGUuanMnKSxcclxuICBtYWluID0gcmVxdWlyZSgnLi9zcmMvbWFpbi5qcycpO1xyXG5cclxuLy9UT0RPIG5vdCBzdXJlIHdoeSBpIGRpZCB0aGlzIC0gd2FzIGluIGxvY2FsIHZhcmlhYmxlXHJcbi8vbWF5YmUgYSBzZXBhcmF0ZSBtb2R1bGVcclxuLy93aW5kb3cubG9jYXRpb24gPSB3aW5kb3cuaGlzdG9yeS5sb2NhdGlvbiB8fCB3aW5kb3cubG9jYXRpb247XHJcbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG4gKioqIFNob3dzIHRoZSBwcmUtbG9hZCBpbWFnZSBhbmQgc2xvd2x5IGZhZGVzIGl0IG91dC4gKioqXHJcbiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cclxuJCh3aW5kb3cpLmxvYWQoZnVuY3Rpb24oKSB7XHJcbiAgJCgnLmxvYWRpbmctY29udGFpbmVyJykuZmFkZU91dCgxMDAwLCBmdW5jdGlvbigpIHtcclxuICAgIC8vJCh0aGlzKS5yZW1vdmUoKTtcclxuICB9KTtcclxufSk7XHJcblxyXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbiAqKiogVGhpcyBoYXBwZW5zIHdoZW4gdGhlIHBhZ2UgaXMgcmVhZHkgKioqXHJcbiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXHJcbiQoZG9jdW1lbnQpLm9uKCdyZWFkeScsIGZ1bmN0aW9uKCkge1xyXG4gIC8vR3JhYiB0aGUgaGFzaCBpZiBleGlzdHMgLSBJRSBzZWVtcyB0byBmb3JnZXQgaXRcclxuICBtYWluLmhhc2ggPSBsb2NhdGlvbi5oYXNoO1xyXG5cclxuICAvL0NIQU5HRSBUSElTIC0gYWRkZWQgdG8gc3Bvb2YgbG9naW5cclxuICBsb2NhdGlvbi5oYXNoPVwiXCI7XHJcbiAgbWFpbi5oYXNoPVwiXCI7XHJcbiAgJCgnI3NpZ25pbicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCl7XHJcbiAgICBpZigkKCcjaW5wRW1haWwnKS52YWwoKS5sZW5ndGg8OCkgYWxlcnQoXCJQbGVhc2UgZW50ZXIgeW91ciBlbWFpbCBhZGRyZXNzLlwiKTtcclxuICAgIGVsc2Uge1xyXG4gICAgICBjb25zb2xlLmxvZygne1wiZXZlbnRcIjp7XCJ3aGF0XCI6XCJsb2dpblwiLFwid2hlblwiOicgKyBuZXcgRGF0ZSgpLmdldFRpbWUoKSArICcsXCJ3aG9cIjpcIicgKyAkKFwiI2lucEVtYWlsXCIpLnZhbCgpICsgJ1wifX0nKTtcclxuICAgICAgJC5hamF4KHtcclxuICAgICAgICB0eXBlOiBcIlBPU1RcIixcclxuICAgICAgICB1cmw6IFwiaHR0cDovLzEzMC44OC4yNTAuMjA2OjkxMDAvcGluZ3JcIixcclxuICAgICAgICBkYXRhOiAne1wiZXZlbnRcIjp7XCJ3aGF0XCI6XCJsb2dpblwiLFwid2hlblwiOicgKyBuZXcgRGF0ZSgpLmdldFRpbWUoKSArICcsXCJ3aG9cIjpcIicgKyAkKFwiI2lucEVtYWlsXCIpLnZhbCgpICsgJ1wifX0nLFxyXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKGQpe2NvbnNvbGUubG9nKGQpO30sXHJcbiAgICAgICAgZGF0YVR5cGU6IFwianNvblwiLFxyXG4gICAgICAgIGNvbnRlbnRUeXBlOlwiYXBwbGljYXRpb24vanNvblwiXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgdmFyIG9iaiA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmJiKTtcclxuICAgICAgb2JqLmVtYWlsPSQoJyNpbnBFbWFpbCcpLnZhbCgpO1xyXG4gICAgICBsb2NhbFN0b3JhZ2UuYmIgPSBKU09OLnN0cmluZ2lmeShvYmopO1xyXG5cclxuXHJcbiAgICAgIGhpc3RvcnkucHVzaFN0YXRlKG51bGwsIG51bGwsICcjb3ZlcnZpZXcnKTtcclxuICAgICAgdGVtcGxhdGUubG9hZENvbnRlbnQoJyNvdmVydmlldycpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG4gICQoJyNpbnBFbWFpbCcpLm9uKCdrZXl1cCcsIGZ1bmN0aW9uKCl7XHJcbiAgICB2YXIgY29kZSA9IGUud2hpY2g7XHJcbiAgICBpZihjb2RlPT0xMyl7XHJcbiAgICAgICQoJyNzaWduaW4nKS5jbGljaygpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICAvL0xvYWQgdGhlIGRhdGEgdGhlbiB3aXJlIHVwIHRoZSBldmVudHMgb24gdGhlIHBhZ2VcclxuICBtYWluLmluaXQoKTtcclxuXHJcbiAgLy9Tb3J0cyBvdXQgdGhlIGRhdGEgaGVsZCBsb2NhbGx5IGluIHRoZSB1c2VyJ3MgYnJvd3NlclxyXG4gIGlmICghbG9jYWxTdG9yYWdlLmJiKSBsb2NhbFN0b3JhZ2UuYmIgPSBKU09OLnN0cmluZ2lmeSh7fSk7XHJcbiAgdmFyIG9iaiA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmJiKTtcclxuICBpZiAoIW9iai52ZXJzaW9uIHx8IG9iai52ZXJzaW9uICE9PSBtYWluLnZlcnNpb24pIHtcclxuICAgIGxvY2FsU3RvcmFnZS5iYiA9IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgXCJ2ZXJzaW9uXCI6IG1haW4udmVyc2lvblxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBpZihKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5iYikuZW1haWwpIHtcclxuICAgICQoJyNpbnBFbWFpbCcpLnZhbChKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5iYikuZW1haWwpO1xyXG4gIH1cclxuXHJcbiAgJCgnW2RhdGEtdG9nZ2xlPVwidG9vbHRpcFwiXScpLnRvb2x0aXAoe1xyXG4gICAgY29udGFpbmVyOiAnYm9keScsXHJcbiAgICBkZWxheToge1xyXG4gICAgICBcInNob3dcIjogNTAwLFxyXG4gICAgICBcImhpZGVcIjogMTAwXHJcbiAgICB9LFxyXG4gICAgaHRtbDogdHJ1ZVxyXG4gIH0pO1xyXG4gICQoJ1tkYXRhLXRvZ2dsZT1cImxvbmUtdG9vbHRpcFwiXScpLnRvb2x0aXAoe1xyXG4gICAgY29udGFpbmVyOiAnYm9keScsXHJcbiAgICBkZWxheToge1xyXG4gICAgICBcInNob3dcIjogMzAwLFxyXG4gICAgICBcImhpZGVcIjogMTAwXHJcbiAgICB9XHJcbiAgfSk7XHJcbiAgJCgnW2RhdGEtdG9nZ2xlPVwibG9uZS10b29sdGlwXCJdJykub24oJ3Nob3duLmJzLnRvb2x0aXAnLCBmdW5jdGlvbihlKSB7XHJcbiAgICAkKCdbZGF0YS10b2dnbGU9XCJ0b29sdGlwXCJdJykubm90KHRoaXMpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICB9KTtcclxuXHJcbiAgLy9lbnN1cmUgb24gZmlyc3QgbG9hZCB0aGUgbG9naW4gc2NyZWVuIGlzIGNhY2hlZCB0byB0aGUgaGlzdG9yeVxyXG4gIGhpc3RvcnkucHVzaFN0YXRlKG51bGwsIG51bGwsICcnKTtcclxufSk7XHJcbiIsInZhciBkYXRhID0gcmVxdWlyZSgnLi9kYXRhLmpzJyksXHJcbiAgbG9va3VwID0gcmVxdWlyZSgnLi9sb29rdXAuanMnKSxcclxuICBjaGFydCA9IHJlcXVpcmUoJy4vY2hhcnQuanMnKSxcclxuICBsb2cgPSByZXF1aXJlKCcuL2xvZy5qcycpLFxyXG4gIE11c3RhY2hlID0gcmVxdWlyZSgnbXVzdGFjaGUnKSxcclxuICBaZXJvQ2xpcGJvYXJkID0gcmVxdWlyZSgnemVyb2NsaXBib2FyZCcpO1xyXG5cclxudmFyIGJhc2UgPSB7XHJcblxyXG4gIC8vb2JqZWN0IGZvciBrZWVwaW5nIHRyYWNrIHdoYXQgaXMgaW4gZWFjaCBwYW5lbCB0byBwcmV2ZW50IHVubmVjZXNzYXJ5IHJlZHJhd3NcclxuICBwYW5lbHM6IHt9LFxyXG5cclxuICBzZWxlY3RUYWI6IGZ1bmN0aW9uKGlkKSB7XHJcbiAgICB2YXIgaHJlZiA9ICQoJyNtYWluVGFiIGxpLmFjdGl2ZSBhJykuZGF0YShcImhyZWZcIik7XHJcbiAgICAkKCcjbWFpblRhYiBsaS5hY3RpdmUnKS5yZW1vdmVDbGFzcygnYWN0aXZlJykuZmluZCgnYScpLmF0dHIoXCJocmVmXCIsIGhyZWYpO1xyXG4gICAgJCgnI21haW5UYWIgbGlbZGF0YS1pZD1cIicgKyBpZCArICdcIl0nKS5hZGRDbGFzcygnYWN0aXZlJykuZmluZCgnYScpLnJlbW92ZUF0dHIoXCJocmVmXCIpO1xyXG4gIH0sXHJcblxyXG4gIGNyZWF0ZVBhbmVsOiBmdW5jdGlvbih0ZW1wbGF0ZVNlbGVjdG9yLCBkYXRhLCB0ZW1wbGF0ZXMpIHtcclxuICAgIHZhciB0ZW1wTXVzdCA9IHRlbXBsYXRlU2VsZWN0b3IuaHRtbCgpO1xyXG4gICAgTXVzdGFjaGUucGFyc2UodGVtcE11c3QpOyAvLyBvcHRpb25hbCwgc3BlZWRzIHVwIGZ1dHVyZSB1c2VzXHJcbiAgICBpZiAodGVtcGxhdGVzKSB7XHJcbiAgICAgIGZvciAodmFyIG8gaW4gdGVtcGxhdGVzKSB7XHJcbiAgICAgICAgaWYgKHRlbXBsYXRlcy5oYXNPd25Qcm9wZXJ0eShvKSkge1xyXG4gICAgICAgICAgTXVzdGFjaGUucGFyc2UodGVtcGxhdGVzW29dKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHZhciByZW5kZXJlZCA9IE11c3RhY2hlLnJlbmRlcih0ZW1wTXVzdCwgZGF0YSwgdGVtcGxhdGVzKTtcclxuICAgIHJldHVybiByZW5kZXJlZDtcclxuICB9LFxyXG5cclxuICBjcmVhdGVQYW5lbFNob3c6IGZ1bmN0aW9uKHRlbXBsYXRlU2VsZWN0b3IsIHBhbmVsU2VsZWN0b3IsIGRhdGEsIHRlbXBsYXRlcykge1xyXG4gICAgdmFyIHJlbmRlcmVkID0gYmFzZS5jcmVhdGVQYW5lbCh0ZW1wbGF0ZVNlbGVjdG9yLCBkYXRhLCB0ZW1wbGF0ZXMpO1xyXG4gICAgcGFuZWxTZWxlY3Rvci5odG1sKHJlbmRlcmVkKS5zaG93KCk7XHJcbiAgfSxcclxuXHJcbiAgc2hvd1BhdGh3YXlTdGFnZU92ZXJ2aWV3UGFuZWw6IGZ1bmN0aW9uKGxvY2F0aW9uLCBlbmFibGVIb3ZlciwgcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UpIHtcclxuICAgIHZhciBzdGFuZGFyZHMgPSBbXTtcclxuICAgIGZvciAodmFyIHN0YW5kYXJkIGluIGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkcykge1xyXG4gICAgICB2YXIgZGVub20gPSBkYXRhLmdldERlbm9taW5hdG9yRm9yU3RhbmRhcmQocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UpO1xyXG4gICAgICB2YXIgbnVtID0gZGVub20gLSBkYXRhLmdldE51bWVyYXRvckZvclN0YW5kYXJkKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCk7XHJcbiAgICAgIHN0YW5kYXJkcy5wdXNoKHtcclxuICAgICAgICBcInN0YW5kYXJkXCI6IGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0udGFiLnRpdGxlLFxyXG4gICAgICAgIFwic3RhbmRhcmRLZXlcIjogc3RhbmRhcmQsXHJcbiAgICAgICAgXCJ0b29sdGlwXCI6IGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF1bXCJzdGFuZGFyZC1tZXQtdG9vbHRpcFwiXSxcclxuICAgICAgICBcIm51bWVyYXRvclwiOiBudW0sXHJcbiAgICAgICAgXCJkZW5vbWluYXRvclwiOiBkZW5vbSxcclxuICAgICAgICBcInBlcmNlbnRhZ2VcIjogKG51bSAqIDEwMCAvIGRlbm9tKS50b0ZpeGVkKDApXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGJhc2UuY3JlYXRlUGFuZWxTaG93KCQoJyNwYXRod2F5LXN0YWdlLW92ZXJ2aWV3LXBhbmVsJyksIGxvY2F0aW9uLCB7XHJcbiAgICAgIHBhdGh3YXk6IGRhdGEucGF0aHdheU5hbWVzW3BhdGh3YXlJZF0sXHJcbiAgICAgIHBhdGh3YXlTdGFnZTogcGF0aHdheVN0YWdlLFxyXG4gICAgICBwYXRod2F5U3RhZ2VOYW1lOiBsb29rdXAuY2F0ZWdvcmllc1twYXRod2F5U3RhZ2VdLmRpc3BsYXksXHJcbiAgICAgIHBhdGh3YXlOYW1lU2hvcnQ6IHBhdGh3YXlJZCxcclxuICAgICAgdGl0bGU6IGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnRleHQucGFuZWwudGV4dCxcclxuICAgICAgc3RhbmRhcmRzOiBzdGFuZGFyZHNcclxuICAgIH0sIHtcclxuICAgICAgXCJyb3dcIjogJCgnI292ZXJ2aWV3LXBhbmVsLXRhYmxlLXJvdycpLmh0bWwoKVxyXG4gICAgfSk7XHJcblxyXG4gICAgJCgnIycgKyBwYXRod2F5U3RhZ2UgKyAnLXRyZW5kLXRvZ2dsZScpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgaWYgKCQodGhpcykudGV4dCgpID09PSBcIlRyZW5kXCIpIHtcclxuICAgICAgICAkKHRoaXMpLnRleHQoXCJUYWJsZVwiKTtcclxuICAgICAgICAkKCcjJyArIHBhdGh3YXlTdGFnZSArICctY2hhcnQtdGFibGUnKS5oaWRlKCk7XHJcbiAgICAgICAgJCgnIycgKyBwYXRod2F5U3RhZ2UgKyAnLWNoYXJ0LXdyYXBwZXInKS5zaG93KCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgJCh0aGlzKS50ZXh0KFwiVHJlbmRcIik7XHJcbiAgICAgICAgJCgnIycgKyBwYXRod2F5U3RhZ2UgKyAnLWNoYXJ0LXRhYmxlJykuc2hvdygpO1xyXG4gICAgICAgICQoJyMnICsgcGF0aHdheVN0YWdlICsgJy1jaGFydC13cmFwcGVyJykuaGlkZSgpO1xyXG4gICAgICB9XHJcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBjaGFydC5kcmF3T3ZlcnZpZXdDaGFydChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgZW5hYmxlSG92ZXIpO1xyXG5cclxuICB9LFxyXG5cclxuICBoaWRlRm9vdGVyOiBmdW5jdGlvbigpIHtcclxuICAgICQoJ2Zvb3RlcicpLmhpZGUoKTtcclxuICB9LFxyXG5cclxuICBzaG93Rm9vdGVyOiBmdW5jdGlvbigpIHtcclxuICAgICQoJ2Zvb3RlcicpLnNob3coKTtcclxuICB9LFxyXG5cclxuICBoaWRlVG9vbHRpcHM6IGZ1bmN0aW9uKCkge1xyXG4gICAgJCgnW2RhdGEtdG9nZ2xlPVwidG9vbHRpcFwiXScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICB9LFxyXG5cclxuICB3aXJlVXBUb29sdGlwczogZnVuY3Rpb24oKSB7XHJcbiAgICAkKCdbZGF0YS10b2dnbGU9XCJ0b29sdGlwXCJdJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgJCgnLnRvb2x0aXAnKS5yZW1vdmUoKTtcclxuXHJcbiAgICAkKCdbZGF0YS10b2dnbGU9XCJ0b29sdGlwXCJdJykudG9vbHRpcCh7XHJcbiAgICAgIGNvbnRhaW5lcjogJ2JvZHknLFxyXG4gICAgICBkZWxheToge1xyXG4gICAgICAgIFwic2hvd1wiOiA1MDAsXHJcbiAgICAgICAgXCJoaWRlXCI6IDEwMFxyXG4gICAgICB9LFxyXG4gICAgICBodG1sOiB0cnVlXHJcbiAgICB9KTtcclxuICAgICQoJ1tkYXRhLXRvZ2dsZT1cImxvbmUtdG9vbHRpcFwiXScpLnRvb2x0aXAoe1xyXG4gICAgICBjb250YWluZXI6ICdib2R5JyxcclxuICAgICAgZGVsYXk6IHtcclxuICAgICAgICBcInNob3dcIjogMzAwLFxyXG4gICAgICAgIFwiaGlkZVwiOiAxMDBcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICAkKCdbZGF0YS10b2dnbGU9XCJsb25lLXRvb2x0aXBcIl0nKS5vbignc2hvd24uYnMudG9vbHRpcCcsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgJCgnW2RhdGEtdG9nZ2xlPVwidG9vbHRpcFwiXScpLm5vdCh0aGlzKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICB9KTtcclxuICAgICQoJy5wYXRpZW50LXJvdy10b29sdGlwJykub24oJ3Nob3cuYnMudG9vbHRpcCcsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgaWYgKCQodGhpcykuaGFzQ2xhc3MoJ2hpZ2hsaWdodGVkJykpIHtcclxuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfSxcclxuXHJcbiAgc2V0dXBDbGlwYm9hcmQ6IGZ1bmN0aW9uKHNlbGVjdG9yLCBkZXN0cm95KSB7XHJcbiAgICBpZiAoZGVzdHJveSkgWmVyb0NsaXBib2FyZC5kZXN0cm95KCk7IC8vdGlkeSB1cFxyXG5cclxuICAgIHZhciBjbGllbnQgPSBuZXcgWmVyb0NsaXBib2FyZChzZWxlY3Rvcik7XHJcblxyXG4gICAgY2xpZW50Lm9uKCdyZWFkeScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICBjbGllbnQub24oJ2FmdGVyY29weScsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ0NvcGllZCB0ZXh0IHRvIGNsaXBib2FyZDogJyArIGV2ZW50LmRhdGFbJ3RleHQvcGxhaW4nXSk7XHJcbiAgICAgICAgJChldmVudC50YXJnZXQpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgICAkKGV2ZW50LnRhcmdldCkucG9wb3Zlcih7XHJcbiAgICAgICAgICB0cmlnZ2VyOiAnbWFudWFsJyxcclxuICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiBjbGFzcz1cInBvcG92ZXJcIiByb2xlPVwidG9vbHRpcFwiPjxkaXYgY2xhc3M9XCJhcnJvd1wiPjwvZGl2PjxkaXYgY2xhc3M9XCJwb3BvdmVyLWNvbnRlbnRcIj48L2Rpdj48L2Rpdj4nLFxyXG4gICAgICAgICAgZGVsYXk6IHtcclxuICAgICAgICAgICAgc2hvdzogNTAwLFxyXG4gICAgICAgICAgICBoaWRlOiA1MDBcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBjbGVhclRpbWVvdXQobG9va3VwLnRtcCk7XHJcbiAgICAgICAgJChldmVudC50YXJnZXQpLnBvcG92ZXIoJ3Nob3cnKTtcclxuICAgICAgICBsb29rdXAudG1wID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICQoZXZlbnQudGFyZ2V0KS5wb3BvdmVyKCdoaWRlJyk7XHJcbiAgICAgICAgfSwgNjAwKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICBjbGVhckJveDogZnVuY3Rpb24oKSB7XHJcbiAgICAvL0NsZWFyIHRoZSBwYXRpZW50IHNlYXJjaCBib3hcclxuICAgICQoJy50eXBlYWhlYWQnKS50eXBlYWhlYWQoJ3ZhbCcsICcnKTtcclxuICB9LFxyXG5cclxuICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuICAgKiBNb2RhbHNcclxuICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXHJcblxyXG4gIGxhdW5jaE1vZGFsOiBmdW5jdGlvbihkYXRhLCBsYWJlbCwgdmFsdWUsIHJlYXNvblRleHQsIGNhbGxiYWNrT25TYXZlLCBjYWxsYmFja09uQ2FuY2VsLCBjYWxsYmFja09uVW5kbykge1xyXG4gICAgdmFyIHRlbXBsYXRlID0gJCgnI21vZGFsLXdoeScpLmh0bWwoKTtcclxuICAgIE11c3RhY2hlLnBhcnNlKHRlbXBsYXRlKTsgLy8gb3B0aW9uYWwsIHNwZWVkcyB1cCBmdXR1cmUgdXNlc1xyXG5cclxuICAgIHZhciByZWFzb25UZW1wbGF0ZSA9ICQoJyNtb2RhbC13aHktaXRlbScpLmh0bWwoKTtcclxuICAgIE11c3RhY2hlLnBhcnNlKHJlYXNvblRlbXBsYXRlKTtcclxuXHJcbiAgICBpZiAoZGF0YS5yZWFzb25zICYmIGRhdGEucmVhc29ucy5sZW5ndGggPiAwKSBkYXRhLmhhc1JlYXNvbnMgPSB0cnVlO1xyXG5cclxuICAgIHZhciByZW5kZXJlZCA9IE11c3RhY2hlLnJlbmRlcih0ZW1wbGF0ZSwgZGF0YSwge1xyXG4gICAgICBcIml0ZW1cIjogcmVhc29uVGVtcGxhdGVcclxuICAgIH0pO1xyXG4gICAgJCgnI21vZGFsJykuaHRtbChyZW5kZXJlZCk7XHJcblxyXG4gICAgaWYgKHJlYXNvblRleHQpIHtcclxuICAgICAgJCgnI21vZGFsIHRleHRhcmVhJykudmFsKHJlYXNvblRleHQpO1xyXG4gICAgfVxyXG4gICAgbG9va3VwLm1vZGFsU2F2ZWQgPSBmYWxzZTtcclxuICAgIGxvb2t1cC5tb2RhbFVuZG8gPSBmYWxzZTtcclxuXHJcbiAgICAkKCcjbW9kYWwgLm1vZGFsJykub2ZmKCdjbGljaycsICcudW5kby1wbGFuJykub24oJ2NsaWNrJywgJy51bmRvLXBsYW4nLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIGxvb2t1cC5tb2RhbFVuZG8gPSB0cnVlO1xyXG4gICAgfSkub2ZmKCdzdWJtaXQnLCAnZm9ybScpLm9uKCdzdWJtaXQnLCAnZm9ybScsIHtcclxuICAgICAgXCJsYWJlbFwiOiBsYWJlbFxyXG4gICAgfSwgZnVuY3Rpb24oZSkge1xyXG4gICAgICBpZiAoIWUuZGF0YS5sYWJlbCkgZS5kYXRhLmxhYmVsID0gXCJ0ZWFtXCI7XHJcbiAgICAgIHZhciByZWFzb24gPSAkKCdpbnB1dDpyYWRpb1tuYW1lPXJlYXNvbl06Y2hlY2tlZCcpLnZhbCgpO1xyXG4gICAgICB2YXIgcmVhc29uVGV4dCA9ICQoJyNtb2RhbCB0ZXh0YXJlYScpLnZhbCgpO1xyXG5cclxuICAgICAgbG9nLnJlY29yZEZlZWRiYWNrKGRhdGEucGF0aHdheUlkLCBlLmRhdGEubGFiZWwsIHZhbHVlLCByZWFzb24sIHJlYXNvblRleHQpO1xyXG5cclxuICAgICAgbG9va3VwLm1vZGFsU2F2ZWQgPSB0cnVlO1xyXG5cclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAkKCcjbW9kYWwgLm1vZGFsJykubW9kYWwoJ2hpZGUnKTtcclxuICAgIH0pLm1vZGFsKCk7XHJcblxyXG4gICAgJCgnI21vZGFsJykub2ZmKCdoaWRkZW4uYnMubW9kYWwnKS5vbignaGlkZGVuLmJzLm1vZGFsJywge1xyXG4gICAgICBcImxhYmVsXCI6IGxhYmVsXHJcbiAgICB9LCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIGlmIChsb29rdXAubW9kYWxTYXZlZCkge1xyXG4gICAgICAgIGxvb2t1cC5tb2RhbFNhdmVkID0gZmFsc2U7XHJcbiAgICAgICAgaWYgKGNhbGxiYWNrT25TYXZlKSBjYWxsYmFja09uU2F2ZSgpO1xyXG4gICAgICB9IGVsc2UgaWYgKGxvb2t1cC5tb2RhbFVuZG8pIHtcclxuICAgICAgICBsb29rdXAubW9kYWxVbmRvID0gZmFsc2U7XHJcbiAgICAgICAgaWYgKGNhbGxiYWNrT25VbmRvKSBjYWxsYmFja09uVW5kbygpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vdW5jaGVjayBhcyBjYW5jZWxsZWQuIC0gYnV0IG5vdCBpZiB2YWx1ZSBpcyBlbXB0eSBhcyB0aGlzIHVuY2hlY2tzIGV2ZXJ5dGhpbmcgLSBvciBpZiBhbHJlYWR5IGNoZWNrZWRcclxuICAgICAgICBpZiAoY2FsbGJhY2tPbkNhbmNlbCkgY2FsbGJhY2tPbkNhbmNlbCgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICBzb3J0U3VnZ2VzdGlvbnM6IGZ1bmN0aW9uKHN1Z2dlc3Rpb25zKSB7XHJcbiAgICBzdWdnZXN0aW9ucy5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcclxuICAgICAgaWYgKGEuYWdyZWUgJiYgIWEuZG9uZSkge1xyXG4gICAgICAgIGlmIChiLmFncmVlICYmICFiLmRvbmUpIHJldHVybiAwO1xyXG4gICAgICAgIHJldHVybiAtMTtcclxuICAgICAgfSBlbHNlIGlmICghYS5hZ3JlZSAmJiAhYS5kaXNhZ3JlZSkge1xyXG4gICAgICAgIGlmICghYi5hZ3JlZSAmJiAhYi5kaXNhZ3JlZSkgcmV0dXJuIDA7XHJcbiAgICAgICAgaWYgKGIuYWdyZWUgJiYgIWIuZG9uZSkgcmV0dXJuIDE7XHJcbiAgICAgICAgcmV0dXJuIC0xO1xyXG4gICAgICB9IGVsc2UgaWYgKGEuYWdyZWUgJiYgYS5kb25lKSB7XHJcbiAgICAgICAgaWYgKGIuYWdyZWUgJiYgYi5kb25lKSByZXR1cm4gMDtcclxuICAgICAgICBpZiAoYi5kaXNhZ3JlZSkgcmV0dXJuIC0xO1xyXG4gICAgICAgIHJldHVybiAxO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGlmIChiLmRpc2FncmVlKSByZXR1cm4gMDtcclxuICAgICAgICByZXR1cm4gMTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIHN1Z2dlc3Rpb25zO1xyXG4gIH0sXHJcblxyXG4gIGFkZERpc2FncmVlUGVyc29uYWxUZWFtOiBmdW5jdGlvbihwbGFucykge1xyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwbGFucy5sZW5ndGg7IGkrKykge1xyXG4gICAgICBpZiAocGxhbnNbaV0uYWdyZWUpIHtcclxuICAgICAgICBwbGFuc1tpXS5kaXNhZ3JlZSA9IGZhbHNlO1xyXG4gICAgICB9IGVsc2UgaWYgKHBsYW5zW2ldLmFncmVlID09PSBmYWxzZSkge1xyXG4gICAgICAgIHBsYW5zW2ldLmRpc2FncmVlID0gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHBsYW5zO1xyXG4gIH0sXHJcblxyXG4gIHN1Z2dlc3Rpb25MaXN0OiBmdW5jdGlvbihpZHMpIHtcclxuICAgIHJldHVybiBpZHMubWFwKGZ1bmN0aW9uKHZhbCkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIFwiaWRcIjogdmFsLmlkIHx8IHZhbCxcclxuICAgICAgICBcInRleHRcIjogbG9nLnRleHRbdmFsLmlkIHx8IHZhbF0udGV4dCxcclxuICAgICAgICBcInN1YnNlY3Rpb25cIjogdmFsLnN1YnNlY3Rpb25cclxuICAgICAgfTtcclxuICAgIH0pLmZpbHRlcihmdW5jdGlvbih2LCBpKSB7IC8vUlcgdG8gYWx3YXlzIGxpbWl0IHRvIDNcclxuICAgICAgcmV0dXJuIGkgPCAzO1xyXG4gICAgfSk7XHJcbiAgfSxcclxuXHJcbiAgbWVyZ2VJbmRpdmlkdWFsU3R1ZmY6IGZ1bmN0aW9uKHN1Z2dlc3Rpb25zLCBwYXRpZW50SWQpIHtcclxuICAgIHZhciBsb2NhbEFjdGlvbnMgPSBsb2cubGlzdEFjdGlvbnMoKTtcclxuICAgIGlmICghbG9jYWxBY3Rpb25zW3BhdGllbnRJZF0pIHJldHVybiBzdWdnZXN0aW9ucztcclxuXHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN1Z2dlc3Rpb25zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIGlmIChsb2NhbEFjdGlvbnNbcGF0aWVudElkXVtzdWdnZXN0aW9uc1tpXS5pZF0pIHtcclxuICAgICAgICBpZiAobG9jYWxBY3Rpb25zW3BhdGllbnRJZF1bc3VnZ2VzdGlvbnNbaV0uaWRdLmFncmVlKSB7XHJcbiAgICAgICAgICBzdWdnZXN0aW9uc1tpXS5hZ3JlZSA9IHRydWU7XHJcbiAgICAgICAgfSBlbHNlIGlmIChsb2NhbEFjdGlvbnNbcGF0aWVudElkXVtzdWdnZXN0aW9uc1tpXS5pZF0uYWdyZWUgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgICBzdWdnZXN0aW9uc1tpXS5kaXNhZ3JlZSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChsb2NhbEFjdGlvbnNbcGF0aWVudElkXVtzdWdnZXN0aW9uc1tpXS5pZF0uZG9uZSkgc3VnZ2VzdGlvbnNbaV0uZG9uZSA9IGxvY2FsQWN0aW9uc1twYXRpZW50SWRdW3N1Z2dlc3Rpb25zW2ldLmlkXS5kb25lO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gc3VnZ2VzdGlvbnM7XHJcbiAgfSxcclxuXHJcbiAgc3dpdGNoVG8xMTBMYXlvdXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgaWYgKGJhc2UubGF5b3V0ID09PSBcIjExMFwiKSByZXR1cm47XHJcbiAgICBiYXNlLmxheW91dCA9IFwiMTEwXCI7XHJcbiAgICBmYXJMZWZ0UGFuZWwucmVtb3ZlQ2xhc3MoJ2NvbC1sZy0zIGNvbC1sZy04JykuYWRkQ2xhc3MoJ2NvbC1sZy02Jykuc2hvdygpO1xyXG4gICAgdG9wUGFuZWwuaGlkZSgpO1xyXG4gICAgdG9wTGVmdFBhbmVsLmhpZGUoKTtcclxuICAgIGJvdHRvbUxlZnRQYW5lbC5oaWRlKCk7XHJcbiAgICB0b3BSaWdodFBhbmVsLmhpZGUoKTtcclxuICAgIGJvdHRvbVJpZ2h0UGFuZWwuaGlkZSgpO1xyXG4gICAgbWlkUGFuZWwuaGlkZSgpO1xyXG4gICAgZmFyUmlnaHRQYW5lbC5yZW1vdmVDbGFzcygnY29sLXhsLTQnKS5hZGRDbGFzcygnY29sLXhsLTgnKS5zaG93KCk7XHJcbiAgfSxcclxuXHJcbiAgc3dpdGNoVG8xMDFMYXlvdXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgaWYgKGJhc2UubGF5b3V0ID09PSBcIjEwMVwiKSByZXR1cm47XHJcbiAgICBiYXNlLmxheW91dCA9IFwiMTAxXCI7XHJcbiAgICBmYXJMZWZ0UGFuZWwucmVtb3ZlQ2xhc3MoJ2NvbC1sZy0zIGNvbC1sZy02IGNvbC14bC00JykuYWRkQ2xhc3MoJ2NvbC1sZy04Jykuc2hvdygpO1xyXG4gICAgdG9wUGFuZWwuaGlkZSgpO1xyXG4gICAgdG9wTGVmdFBhbmVsLmhpZGUoKTtcclxuICAgIGJvdHRvbUxlZnRQYW5lbC5oaWRlKCk7XHJcbiAgICB0b3BSaWdodFBhbmVsLmhpZGUoKTtcclxuICAgIGJvdHRvbVJpZ2h0UGFuZWwuaGlkZSgpO1xyXG4gICAgbWlkUGFuZWwuaGlkZSgpO1xyXG4gICAgZmFyUmlnaHRQYW5lbC5yZW1vdmVDbGFzcygnY29sLXhsLTgnKS5hZGRDbGFzcygnY29sLXhsLTQnKS5zaG93KCk7XHJcbiAgfSxcclxuXHJcblxyXG5cclxuICBzd2l0Y2hUbzIyMUxheW91dDogZnVuY3Rpb24oKSB7XHJcbiAgICBpZiAoYmFzZS5sYXlvdXQgPT09IFwiMjIxXCIpIHJldHVybjtcclxuICAgIGJhc2UubGF5b3V0ID0gXCIyMjFcIjtcclxuICAgIGZhckxlZnRQYW5lbC5oaWRlKCk7XHJcbiAgICB0b3BQYW5lbC5oaWRlKCk7XHJcbiAgICB0b3BMZWZ0UGFuZWwuYWRkQ2xhc3MoJ2NvbC14bC02Jykuc2hvdygpO1xyXG4gICAgYm90dG9tTGVmdFBhbmVsLmFkZENsYXNzKCdjb2wteGwtNicpLnNob3coKTtcclxuICAgIHRvcFJpZ2h0UGFuZWwucmVtb3ZlQ2xhc3MoJ2NvbC14bC0xMicpLmFkZENsYXNzKCdjb2wteGwtNicpLnNob3coKTtcclxuICAgIGJvdHRvbVJpZ2h0UGFuZWwucmVtb3ZlQ2xhc3MoJ2NvbC14bC0xMicpLmFkZENsYXNzKCdjb2wteGwtNicpLnNob3coKTtcclxuICAgIG1pZFBhbmVsLnJlbW92ZUNsYXNzKCdjb2wteGwtNCcpLmFkZENsYXNzKCdjb2wteGwtOCcpLnNob3coKTtcclxuICAgIGZhclJpZ2h0UGFuZWwucmVtb3ZlQ2xhc3MoJ2NvbC14bC04JykuYWRkQ2xhc3MoJ2NvbC14bC00Jykuc2hvdygpO1xyXG4gIH0sXHJcblxyXG4gIHN3aXRjaFRvMjFMYXlvdXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgaWYgKGJhc2UubGF5b3V0ID09PSBcIjIxXCIpIHJldHVybjtcclxuICAgIGJhc2UubGF5b3V0ID0gXCIyMVwiO1xyXG4gICAgZmFyTGVmdFBhbmVsLmhpZGUoKTtcclxuICAgIHRvcFBhbmVsLmhpZGUoKTtcclxuICAgIHRvcExlZnRQYW5lbC5oaWRlKCk7XHJcbiAgICBib3R0b21MZWZ0UGFuZWwuaGlkZSgpO1xyXG4gICAgdG9wUmlnaHRQYW5lbC5yZW1vdmVDbGFzcygnY29sLXhsLTYnKS5hZGRDbGFzcygnY29sLXhsLTEyJykuc2hvdygpO1xyXG4gICAgYm90dG9tUmlnaHRQYW5lbC5yZW1vdmVDbGFzcygnY29sLXhsLTYnKS5hZGRDbGFzcygnY29sLXhsLTEyJykuc2hvdygpO1xyXG4gICAgbWlkUGFuZWwucmVtb3ZlQ2xhc3MoJ2NvbC14bC00JykuYWRkQ2xhc3MoJ2NvbC14bC04Jykuc2hvdygpO1xyXG4gICAgZmFyUmlnaHRQYW5lbC5yZW1vdmVDbGFzcygnY29sLXhsLTgnKS5hZGRDbGFzcygnY29sLXhsLTQnKS5zaG93KCk7XHJcbiAgfSxcclxuXHJcbiAgd2lyZVVwU3RhbmRhcmREcm9wRG93bjogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBjYWxsYmFjaykge1xyXG4gICAgdmFyIGJyZWFjaGVzID0gZGF0YS5vcHRpb25zLmZpbHRlcihmdW5jdGlvbih2YWwpIHtcclxuICAgICAgcmV0dXJuIHZhbC5wYXRod2F5SWQgPT09IHBhdGh3YXlJZCAmJiB2YWwucGF0aHdheVN0YWdlID09PSBwYXRod2F5U3RhZ2UgJiYgdmFsLnN0YW5kYXJkID09PSBzdGFuZGFyZDtcclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChicmVhY2hlcy5sZW5ndGggPiAwKSAkKCdzZWxlY3QnKS52YWwoYnJlYWNoZXNbMF0udmFsdWUpO1xyXG5cclxuICAgICQoJ3NlbGVjdCcpLnNlbGVjdDIoe1xyXG4gICAgICB0ZW1wbGF0ZVJlc3VsdDogYmFzZS5mb3JtYXRTdGFuZGFyZCxcclxuICAgICAgbWluaW11bVJlc3VsdHNGb3JTZWFyY2g6IEluZmluaXR5XHJcbiAgICB9KTtcclxuICAgICQoJ3NwYW4uc2VsZWN0Mi1zZWxlY3Rpb25fX3JlbmRlcmVkJykuYXR0cihcInRpdGxlXCIsIFwiXCIpO1xyXG4gICAgJCgnc2VsZWN0Jykub24oJ2NoYW5nZScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgbG9jYWxEYXRhID0gJCh0aGlzKS5maW5kKCc6c2VsZWN0ZWQnKS5kYXRhKCk7XHJcbiAgICAgIGNhbGxiYWNrKGxvY2FsRGF0YS5wYXRod2F5SWQsIGxvY2FsRGF0YS5wYXRod2F5U3RhZ2UsIGxvY2FsRGF0YS5zdGFuZGFyZCwgZGF0YS5wYXRpZW50SWQpO1xyXG4gICAgfSkub24oXCJzZWxlY3QyOm9wZW5cIiwgZnVuY3Rpb24oZSkge1xyXG4gICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICBmb3JtYXRTdGFuZGFyZDogZnVuY3Rpb24oc3RhbmRhcmQpIHtcclxuICAgIGlmICghc3RhbmRhcmQuaWQpIHtcclxuICAgICAgcmV0dXJuIHN0YW5kYXJkLnRleHQ7XHJcbiAgICB9XHJcbiAgICB2YXIgbG9jYWxEYXRhID0gJChzdGFuZGFyZC5lbGVtZW50KS5kYXRhKCk7XHJcbiAgICAvLyBOb3QgcmVsZXZhbnRcclxuICAgIHZhciBzdGFuZGFyZEh0bWwgPSAnJztcclxuICAgIC8vaWYgZGlhZ25vc2lzIG9wcG9ydHVuaXR5IHRoZW4gbm90IHJlbGV2YW50IGZvciBvdGhlciBzdGFnZXNcclxuICAgIC8vaWYgbm8gbWVudGlvbiBhbnl3aGVyZSB0aGVuIG5vdCByZWxldmFudCBmb3IgdGhhdCBkaXNlYXNlXHJcbiAgICBzd2l0Y2ggKGRhdGEuZ2V0UGF0aWVudFN0YXR1cyhkYXRhLnBhdGllbnRJZCwgbG9jYWxEYXRhLnBhdGh3YXlJZCwgbG9jYWxEYXRhLnBhdGh3YXlTdGFnZSwgbG9jYWxEYXRhLnN0YW5kYXJkKSkge1xyXG4gICAgICBjYXNlIFwib2tcIjpcclxuICAgICAgICBzdGFuZGFyZEh0bWwgPSAnPHNwYW4gY2xhc3M9XCJzdGFuZGFyZC1hY2hpZXZlZFwiIGRhdGEtdG9nZ2xlPVwidG9vbHRpcFwiIGRhdGEtcGxhY2VtZW50PVwibGVmdFwiIHRpdGxlPVwiJyArIGRhdGFbbG9jYWxEYXRhLnBhdGh3YXlJZF1bbG9jYWxEYXRhLnBhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW2xvY2FsRGF0YS5zdGFuZGFyZF1bXCJkcm9wZG93bi10b29sdGlwXCJdICsgJyAtIFFVQUxJVFkgSU5ESUNBVE9SIEFDSElFVkVEXCI+JyArIHN0YW5kYXJkLnRleHQgKyAnIDxpIGNsYXNzPVwiZmEgZmEtc21pbGUtb1wiIHN0eWxlPVwiY29sb3I6Z3JlZW5cIj48L2k+PC9zcGFuPic7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgXCJtaXNzZWRcIjpcclxuICAgICAgICBzdGFuZGFyZEh0bWwgPSAnPHNwYW4gY2xhc3M9XCJzdGFuZGFyZC1taXNzZWRcIiBkYXRhLXRvZ2dsZT1cInRvb2x0aXBcIiBkYXRhLXBsYWNlbWVudD1cImxlZnRcIiB0aXRsZT1cIicgKyBkYXRhW2xvY2FsRGF0YS5wYXRod2F5SWRdW2xvY2FsRGF0YS5wYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tsb2NhbERhdGEuc3RhbmRhcmRdW1wiZHJvcGRvd24tdG9vbHRpcFwiXSArICcgLSBJTVBST1ZFTUVOVCBPUFBPUlRVTklUWSBFWElTVFMgRk9SIFRISVMgUEFUSUVOVFwiPicgKyBzdGFuZGFyZC50ZXh0ICsgJyA8aSBjbGFzcz1cImZhIGZhLWZsYWdcIiBzdHlsZT1cImNvbG9yOnJlZFwiPjwvaT48L3NwYW4+JztcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBcIm5vdFwiOlxyXG4gICAgICAgIHN0YW5kYXJkSHRtbCA9ICc8c3BhbiBjbGFzcz1cInN0YW5kYXJkLW5vdC1yZWxldmFudFwiIGRhdGEtdG9nZ2xlPVwidG9vbHRpcFwiIGRhdGEtcGxhY2VtZW50PVwibGVmdFwiIHRpdGxlPVwiJyArIGRhdGFbbG9jYWxEYXRhLnBhdGh3YXlJZF1bbG9jYWxEYXRhLnBhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW2xvY2FsRGF0YS5zdGFuZGFyZF1bXCJkcm9wZG93bi10b29sdGlwXCJdICsgJyAtIFNUQU5EQVJEIE5PVCBSRUxFVkFOVCBUTyBUSElTIFBBVElFTlRcIj4nICsgc3RhbmRhcmQudGV4dCArICcgPGkgY2xhc3M9XCJmYSBmYS1tZWgtb1wiIHN0eWxlPVwiY29sb3I6Z3JheVwiPjwvaT48L3NwYW4+JztcclxuICAgICAgICBicmVhaztcclxuICAgIH1cclxuICAgIHZhciAkc3RhbmRhcmQgPSAkKHN0YW5kYXJkSHRtbCk7XHJcbiAgICByZXR1cm4gJHN0YW5kYXJkO1xyXG4gIH0sXHJcblxyXG4gIHVwZGF0ZVRpdGxlOiBmdW5jdGlvbih0aXRsZSl7XHJcbiAgICAkKCcjdGl0bGUtbGVmdCcpLmh0bWwodGl0bGUpO1xyXG4gICAgJCgnI3RpdGxlLXJpZ2h0JykuaHRtbChcIlwiKTtcclxuICB9LFxyXG4gIC8qdXBkYXRlVGl0bGU6IGZ1bmN0aW9uKHRpdGxlLCB0b29sdGlwKSB7XHJcbiAgICB2YXIgdGl0bGVzID0gdGl0bGU7XHJcbiAgICBpZiAodHlwZW9mIHRpdGxlID09PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgIHRpdGxlcyA9IFt7XHJcbiAgICAgICAgdGl0bGU6IHRpdGxlLFxyXG4gICAgICAgIHRvb2x0aXA6IHRvb2x0aXBcclxuICAgICAgfV07XHJcbiAgICB9XHJcbiAgICB2YXIgY29udGVudCA9IHRpdGxlcy5tYXAoZnVuY3Rpb24odCwgaWR4KSB7XHJcbiAgICAgIHJldHVybiBpZHggPT09IHRpdGxlcy5sZW5ndGggLSAxID8gJzxzcGFuIHRpdGxlPVwiJyArIHQudG9vbHRpcCArICdcIj4nICsgdC50aXRsZSArICc8L3NwYW4+JyA6ICc8YSBocmVmPVwiJyArIHQudXJsICsgJ1wiIHRpdGxlPVwiJyArIHQudG9vbHRpcCArICdcIj4nICsgdC50aXRsZSArICc8L2E+JztcclxuICAgIH0pLmpvaW4oXCIgPiBcIik7XHJcblxyXG4gICAgJCgnLnBhZ2V0aXRsZScpLmh0bWwoY29udGVudCk7XHJcbiAgfSwqL1xyXG5cclxuICBoaWRlQWxsUGFuZWxzOiBmdW5jdGlvbigpIHtcclxuICAgIHRvcExlZnRQYW5lbC5oaWRlKCk7XHJcbiAgICBib3R0b21MZWZ0UGFuZWwuaGlkZSgpO1xyXG4gICAgdG9wUmlnaHRQYW5lbC5oaWRlKCk7XHJcbiAgICBib3R0b21SaWdodFBhbmVsLmhpZGUoKTtcclxuICAgIGZhckxlZnRQYW5lbC5oaWRlKCk7XHJcbiAgICBmYXJSaWdodFBhbmVsLmhpZGUoKTtcclxuICAgIHRvcFBhbmVsLmhpZGUoKTtcclxuICB9LFxyXG5cclxuICBoaWRlUGFuZWxzOiBmdW5jdGlvbihwYW5lbCkge1xyXG4gICAgcGFuZWwuY2hpbGRyZW4oKS5oaWRlKCk7XHJcbiAgfSxcclxuXHJcbiAgdXBkYXRlVGFiOiBmdW5jdGlvbih0YWIsIHZhbHVlLCB1cmwpIHtcclxuICAgIHZhciB0YWJFbGVtZW50ID0gJCgnI21haW5UYWIgYVtkYXRhLWhyZWY9XCIjJyArIHRhYiArICdcIl0nKTtcclxuICAgIHRhYkVsZW1lbnQuaHRtbCh0YWJFbGVtZW50LnRleHQoKS5zcGxpdChcIjpcIilbMF0gKyBcIjo8YnI+PHNwYW4+PHN0cm9uZz5cIiArIHZhbHVlICsgXCI8L3N0cm9uZz48L3NwYW4+XCIpO1xyXG4gICAgdGFiRWxlbWVudC5kYXRhKFwiaHJlZlwiLCBcIiNcIiArIHRhYiArIFwiL1wiICsgdXJsKTtcclxuICB9LFxyXG5cclxuICBhZGRGdWxsUGFnZTogZnVuY3Rpb24ocGFuZWwpIHtcclxuICAgIHBhbmVsLmZ1bGxwYWdlKHsgdmVydGljYWxDZW50ZXJlZDogZmFsc2UsIHBhZGRpbmdCb3R0b206ICc4MHB4Jywgc2Nyb2xsQmFyOiB0cnVlIH0pO1xyXG5cclxuICAgICQoJy5mcC1kb3duJykub2ZmKCdjbGljaycpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAkLmZuLmZ1bGxwYWdlLm1vdmVTZWN0aW9uRG93bigpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgJCgnLmZwLXVwJykub2ZmKCdjbGljaycpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAkLmZuLmZ1bGxwYWdlLm1vdmVTZWN0aW9uVXAoKTtcclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIHJlbW92ZUZ1bGxQYWdlOiBmdW5jdGlvbihwYW5lbCkge1xyXG4gICAgaWYgKHBhbmVsLmNoaWxkcmVuKCcuc2VjdGlvbicpLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xyXG4gICAgaWYgKCQuZm4uZnVsbHBhZ2UgJiYgJC5mbi5mdWxscGFnZS5kZXN0cm95KSAkLmZuLmZ1bGxwYWdlLmRlc3Ryb3koJ2FsbCcpOyAvL3RpZHkgdXAgYmVmb3JlIGRvaW5nIGl0IGFnYWluXHJcbiAgfSxcclxuXHJcbiAgc2hvd0xvYWRpbmc6IGZ1bmN0aW9uKCl7XHJcbiAgICAkKCcubG9hZGluZy1jb250YWluZXInKS5zaG93KCk7XHJcbiAgICAkKCcjdGl0bGUtcm93JykuaGlkZSgpO1xyXG4gIH0sXHJcblxyXG4gIGhpZGVMb2FkaW5nOiBmdW5jdGlvbigpe1xyXG4gICAgJCgnLmxvYWRpbmctY29udGFpbmVyJykuZmFkZU91dCgxMDAwKTtcclxuICAgICQoJyN0aXRsZS1yb3cnKS5mYWRlSW4oMTAwMCk7XHJcbiAgfSxcclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGJhc2U7XHJcbiIsInZhciBIaWdoY2hhcnRzID0gcmVxdWlyZSgnaGlnaGNoYXJ0cy9oaWdoc3RvY2snKSxcclxuICBkYXRhID0gcmVxdWlyZSgnLi9kYXRhLmpzJyksXHJcbiAgbG9va3VwID0gcmVxdWlyZSgnLi9sb29rdXAuanMnKSxcclxuICBsb2cgPSByZXF1aXJlKCcuL2xvZy5qcycpLFxyXG4gIE11c3RhY2hlID0gcmVxdWlyZSgnbXVzdGFjaGUnKTtcclxuXHJcbmNvbnNvbGUubG9nKFwiY2hhcnQuanM6IGRhdGEubGFzdGxvYWRlcj0gXCIgKyBkYXRhLmxhc3Rsb2FkZXIpO1xyXG5kYXRhLmxhc3Rsb2FkZXIgPSBcImNoYXJ0LmpzXCI7XHJcblxyXG52YXIgY2h0ID0ge1xyXG5cclxuICBkZXN0cm95Q2hhcnRzOiBmdW5jdGlvbihjaGFydHMpIHtcclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hhcnRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIGlmIChsb29rdXAuY2hhcnRzW2NoYXJ0c1tpXV0pIHtcclxuICAgICAgICBsb29rdXAuY2hhcnRzW2NoYXJ0c1tpXV0uZGVzdHJveSgpO1xyXG4gICAgICAgIGRlbGV0ZSBsb29rdXAuY2hhcnRzW2NoYXJ0c1tpXV07XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9LFxyXG5cclxuICBkcmF3VHJlbmRDaGFydDogZnVuY3Rpb24ocGF0aWVudElkLCBwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQpIHtcclxuICAgIHZhciBpLCBqO1xyXG4gICAgY2h0LmRlc3Ryb3lDaGFydHMoWydjaGFydC1kZW1vLXRyZW5kJ10pO1xyXG4gICAgaWYgKCFkYXRhLnBhdGllbnRzW3BhdGllbnRJZF1bZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS5jaGFydFswXV0pIHtcclxuICAgICAgJCgnI2NoYXJ0LWRlbW8tdHJlbmQnKS5odG1sKCdObyBkYXRhIGZvciB0aGlzIHBhdGllbnRzJyk7XHJcbiAgICAgICQoJyNjaGFydC1kZW1vLXRyZW5kJykucGFyZW50KCkuZmluZCgnLnRhYmxlLWNoYXJ0LXRvZ2dsZScpLmhpZGUoKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIHZhciBjaGFydERhdGEgPSBkYXRhLnBhdGllbnRzW3BhdGllbnRJZF1bZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS5jaGFydFswXV07XHJcbiAgICB2YXIgdGFibGVEYXRhID0gW107XHJcbiAgICBmb3IgKGkgPSAxOyBpIDwgZGF0YS5wYXRpZW50c1twYXRpZW50SWRdW2RhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0uY2hhcnRbMF1dWzBdLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIHRhYmxlRGF0YS5wdXNoKHtcclxuICAgICAgICBcIml0ZW1cIjogZGF0YS5wYXRpZW50c1twYXRpZW50SWRdW2RhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0uY2hhcnRbMF1dWzFdWzBdLFxyXG4gICAgICAgIFwidmFsdWVcIjogZGF0YS5wYXRpZW50c1twYXRpZW50SWRdW2RhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0uY2hhcnRbMF1dWzFdW2ldLFxyXG4gICAgICAgIFwiZGF0ZVwiOiBkYXRhLnBhdGllbnRzW3BhdGllbnRJZF1bZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS5jaGFydFswXV1bMF1baV1cclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBmb3IgKGkgPSAxOyBpIDwgZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS5jaGFydC5sZW5ndGg7IGkrKykge1xyXG4gICAgICBjaGFydERhdGEucHVzaChkYXRhLnBhdGllbnRzW3BhdGllbnRJZF1bZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS5jaGFydFtpXV1bMV0pOyAvL1JXIFRPRE8gYXNzdW1wdGlvbiBoZXJlIHRoYXQgYWxsIGRhdGVzIGFyZSB0aGUgc2FtZVxyXG4gICAgICBmb3IgKGogPSAxOyBqIDwgZGF0YS5wYXRpZW50c1twYXRpZW50SWRdW2RhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0uY2hhcnRbMF1dWzBdLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgdGFibGVEYXRhLnB1c2goe1xyXG4gICAgICAgICAgXCJpdGVtXCI6IGRhdGEucGF0aWVudHNbcGF0aWVudElkXVtkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLmNoYXJ0W2ldXVsxXVswXSxcclxuICAgICAgICAgIFwidmFsdWVcIjogZGF0YS5wYXRpZW50c1twYXRpZW50SWRdW2RhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0uY2hhcnRbaV1dWzFdW2pdLFxyXG4gICAgICAgICAgXCJkYXRlXCI6IGRhdGEucGF0aWVudHNbcGF0aWVudElkXVtkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLmNoYXJ0WzBdXVswXVtqXVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICB2YXIgY2hhcnRPcHRpb25zID0ge1xyXG4gICAgICBiaW5kdG86ICcjY2hhcnQtZGVtby10cmVuZCcsXHJcbiAgICAgIGRhdGE6IHtcclxuICAgICAgICB4czoge30sXHJcbiAgICAgICAgY2xhc3Nlczoge30sXHJcbiAgICAgICAgY29sdW1uczogY2hhcnREYXRhLnNsaWNlKClcclxuICAgICAgfSxcclxuICAgICAgem9vbToge1xyXG4gICAgICAgIGVuYWJsZWQ6IHRydWVcclxuICAgICAgfSxcclxuICAgICAgbGluZToge1xyXG4gICAgICAgIGNvbm5lY3ROdWxsOiBmYWxzZVxyXG4gICAgICB9LFxyXG4gICAgICBheGlzOiB7XHJcbiAgICAgICAgeDoge1xyXG4gICAgICAgICAgdHlwZTogJ3RpbWVzZXJpZXMnLFxyXG4gICAgICAgICAgdGljazoge1xyXG4gICAgICAgICAgICBmaXQ6IGZhbHNlLFxyXG4gICAgICAgICAgICBmb3JtYXQ6ICclZC0lbS0lWScsXHJcbiAgICAgICAgICAgIGNvdW50OiA1XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgbWF4OiBuZXcgRGF0ZSgpXHJcbiAgICAgICAgfSxcclxuICAgICAgICB5OiB7XHJcbiAgICAgICAgICBsYWJlbDoge1xyXG4gICAgICAgICAgICB0ZXh0OiBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLmNoYXJ0VW5pdHMsXHJcbiAgICAgICAgICAgIHBvc2l0aW9uOiAnb3V0ZXItbWlkZGxlJ1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgbWF4VmFsdWUgPSAwO1xyXG4gICAgdmFyIHN0YW5kYXJkSXRlbXMgPSBbXTtcclxuXHJcbiAgICBmb3IgKGkgPSAxOyBpIDwgY2hhcnRPcHRpb25zLmRhdGEuY29sdW1ucy5sZW5ndGg7IGkrKykge1xyXG4gICAgICBjaGFydE9wdGlvbnMuZGF0YS54c1tjaGFydE9wdGlvbnMuZGF0YS5jb2x1bW5zW2ldWzBdXSA9IFwieFwiO1xyXG4gICAgICBzdGFuZGFyZEl0ZW1zLnB1c2goY2hhcnRPcHRpb25zLmRhdGEuY29sdW1uc1tpXVswXSk7XHJcblxyXG4gICAgICBmb3IgKGogPSAxOyBqIDwgY2hhcnRPcHRpb25zLmRhdGEuY29sdW1uc1tpXS5sZW5ndGg7IGorKykge1xyXG4gICAgICAgIGlmIChwYXJzZUZsb2F0KGNoYXJ0T3B0aW9ucy5kYXRhLmNvbHVtbnNbaV1bal0pID4gbWF4VmFsdWUpIG1heFZhbHVlID0gcGFyc2VGbG9hdChjaGFydE9wdGlvbnMuZGF0YS5jb2x1bW5zW2ldW2pdKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNoYXJ0T3B0aW9ucy50b29sdGlwID0ge1xyXG4gICAgICBmb3JtYXQ6IHtcclxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24odmFsdWUsIHJhdGlvLCBpZCkge1xyXG4gICAgICAgICAgdmFyIHRleHQgPSBzdGFuZGFyZEl0ZW1zLmluZGV4T2YoaWQpID4gLTEgPyB2YWx1ZSA6IFwiXCI7XHJcbiAgICAgICAgICByZXR1cm4gdGV4dDtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgdmFyIGxpbmVzID0gbnVsbDtcclxuICAgIHZhciBheGlzbnVtID0gMTtcclxuICAgIGlmIChkYXRhLnBhdGllbnRzW3BhdGllbnRJZF0uY29udGFjdHMpIHtcclxuICAgICAgZm9yIChpID0gMDsgaSA8IGRhdGEucGF0aWVudHNbcGF0aWVudElkXS5jb250YWN0cy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGNoYXJ0T3B0aW9ucy5kYXRhLmNsYXNzZXNbZGF0YS5wYXRpZW50c1twYXRpZW50SWRdLmNvbnRhY3RzW2ldLnRleHRdID0gJ2xhcmdlcic7XHJcbiAgICAgICAgaWYgKCFjaGFydE9wdGlvbnMuZGF0YS54c1tkYXRhLnBhdGllbnRzW3BhdGllbnRJZF0uY29udGFjdHNbaV0udGV4dF0pIHtcclxuICAgICAgICAgIGNoYXJ0T3B0aW9ucy5kYXRhLnhzW2RhdGEucGF0aWVudHNbcGF0aWVudElkXS5jb250YWN0c1tpXS50ZXh0XSA9IFwieFwiICsgYXhpc251bTtcclxuICAgICAgICAgIGNoYXJ0T3B0aW9ucy5kYXRhLmNvbHVtbnMucHVzaChbXCJ4XCIgKyBheGlzbnVtLCBkYXRhLnBhdGllbnRzW3BhdGllbnRJZF0uY29udGFjdHNbaV0udmFsdWVdKTtcclxuICAgICAgICAgIGNoYXJ0T3B0aW9ucy5kYXRhLmNvbHVtbnMucHVzaChbZGF0YS5wYXRpZW50c1twYXRpZW50SWRdLmNvbnRhY3RzW2ldLnRleHQsIChtYXhWYWx1ZSAqIDEuMSkudG9TdHJpbmcoKV0pO1xyXG4gICAgICAgICAgYXhpc251bSsrO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB2YXIgYXhpcyA9IGNoYXJ0T3B0aW9ucy5kYXRhLnhzW2RhdGEucGF0aWVudHNbcGF0aWVudElkXS5jb250YWN0c1tpXS50ZXh0XTtcclxuICAgICAgICAgIGZvciAoaiA9IDE7IGogPCBjaGFydE9wdGlvbnMuZGF0YS5jb2x1bW5zLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICAgIGlmIChjaGFydE9wdGlvbnMuZGF0YS5jb2x1bW5zW2pdWzBdID09PSBheGlzKSB7XHJcbiAgICAgICAgICAgICAgY2hhcnRPcHRpb25zLmRhdGEuY29sdW1uc1tqXS5wdXNoKGRhdGEucGF0aWVudHNbcGF0aWVudElkXS5jb250YWN0c1tpXS52YWx1ZSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoY2hhcnRPcHRpb25zLmRhdGEuY29sdW1uc1tqXVswXSA9PT0gZGF0YS5wYXRpZW50c1twYXRpZW50SWRdLmNvbnRhY3RzW2ldLnRleHQpIHtcclxuICAgICAgICAgICAgICBjaGFydE9wdGlvbnMuZGF0YS5jb2x1bW5zW2pdLnB1c2goKG1heFZhbHVlICogMS4xKS50b1N0cmluZygpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0YWJsZURhdGEucHVzaCh7XHJcbiAgICAgICAgICBcIml0ZW1cIjogXCJFdmVudFwiLFxyXG4gICAgICAgICAgXCJ2YWx1ZVwiOiBkYXRhLnBhdGllbnRzW3BhdGllbnRJZF0uY29udGFjdHNbaV0udGV4dCxcclxuICAgICAgICAgIFwiZGF0ZVwiOiBkYXRhLnBhdGllbnRzW3BhdGllbnRJZF0uY29udGFjdHNbaV0udmFsdWVcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHZhciBwYXRpZW50RXZlbnRzID0gbG9nLmdldEV2ZW50cygpLmZpbHRlcihmdW5jdGlvbih2YWwpIHtcclxuICAgICAgcmV0dXJuIHZhbC5pZCA9PT0gcGF0aWVudElkO1xyXG4gICAgfSk7XHJcbiAgICBpZiAocGF0aWVudEV2ZW50cy5sZW5ndGggPiAwKSB7XHJcblxyXG4gICAgICBmb3IgKGkgPSAwOyBpIDwgcGF0aWVudEV2ZW50cy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGNoYXJ0T3B0aW9ucy5kYXRhLmNsYXNzZXNbcGF0aWVudEV2ZW50c1tpXS5uYW1lXSA9ICdsYXJnZXInO1xyXG4gICAgICAgIGlmICghY2hhcnRPcHRpb25zLmRhdGEueHNbcGF0aWVudEV2ZW50c1tpXS5uYW1lXSkge1xyXG4gICAgICAgICAgY2hhcnRPcHRpb25zLmRhdGEueHNbcGF0aWVudEV2ZW50c1tpXS5uYW1lXSA9IFwieFwiICsgYXhpc251bTtcclxuICAgICAgICAgIGNoYXJ0T3B0aW9ucy5kYXRhLmNvbHVtbnMucHVzaChbXCJ4XCIgKyBheGlzbnVtLCBwYXRpZW50RXZlbnRzW2ldLmRhdGUuc3Vic3RyKDAsIDEwKV0pO1xyXG4gICAgICAgICAgY2hhcnRPcHRpb25zLmRhdGEuY29sdW1ucy5wdXNoKFtwYXRpZW50RXZlbnRzW2ldLm5hbWUsIChtYXhWYWx1ZSAqIDEuMSkudG9TdHJpbmcoKV0pO1xyXG4gICAgICAgICAgYXhpc251bSsrO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB2YXIgYXhpczIgPSBjaGFydE9wdGlvbnMuZGF0YS54c1twYXRpZW50RXZlbnRzW2ldLm5hbWVdO1xyXG4gICAgICAgICAgZm9yIChqID0gMTsgaiA8IGNoYXJ0T3B0aW9ucy5kYXRhLmNvbHVtbnMubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgICAgaWYgKGNoYXJ0T3B0aW9ucy5kYXRhLmNvbHVtbnNbal1bMF0gPT09IGF4aXMyKSB7XHJcbiAgICAgICAgICAgICAgY2hhcnRPcHRpb25zLmRhdGEuY29sdW1uc1tqXS5wdXNoKHBhdGllbnRFdmVudHNbaV0uZGF0ZS5zdWJzdHIoMCwgMTApKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChjaGFydE9wdGlvbnMuZGF0YS5jb2x1bW5zW2pdWzBdID09PSBwYXRpZW50RXZlbnRzW2ldLm5hbWUpIHtcclxuICAgICAgICAgICAgICBjaGFydE9wdGlvbnMuZGF0YS5jb2x1bW5zW2pdLnB1c2goKG1heFZhbHVlICogMS4xKS50b1N0cmluZygpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0YWJsZURhdGEucHVzaCh7XHJcbiAgICAgICAgICBcIml0ZW1cIjogXCJFdmVudFwiLFxyXG4gICAgICAgICAgXCJ2YWx1ZVwiOiBwYXRpZW50RXZlbnRzW2ldLm5hbWUsXHJcbiAgICAgICAgICBcImRhdGVcIjogcGF0aWVudEV2ZW50c1tpXS5kYXRlLnN1YnN0cigwLCAxMClcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHRhYmxlRGF0YS5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcclxuICAgICAgaWYgKGEuZGF0ZSA9PT0gYi5kYXRlKSByZXR1cm4gMDtcclxuICAgICAgZWxzZSByZXR1cm4gYS5kYXRlIDwgYi5kYXRlID8gMSA6IC0xO1xyXG4gICAgfSk7XHJcbiAgICAvL2RyYXcgVGFibGVcclxuICAgICQoJyN0YWJsZS1kZW1vLXRyZW5kJykuaHRtbChNdXN0YWNoZS5yZW5kZXIoJCgnI3ZhbHVlLXRyZW5kLXBhbmVsLXRhYmxlJykuaHRtbCgpLCB7XHJcbiAgICAgIFwiaXRlbXNcIjogdGFibGVEYXRhXHJcbiAgICB9LCB7XHJcbiAgICAgIFwiaXRlbS1yb3dcIjogJCgnI3ZhbHVlLXRyZW5kLXBhbmVsLXRhYmxlLXJvdycpLmh0bWwoKVxyXG4gICAgfSkpO1xyXG5cclxuICAgIC8vZHJhdyBjaGFydHMgaW4gc2VwYXJhdGUgdGhyZWFkIGFuZCB3aXRoIGRlbGF5IHRvIHN0b3Agc2x1Z2dpc2ggYXBwZWFyYW5jZVxyXG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgbG9va3VwLmNoYXJ0c1snY2hhcnQtZGVtby10cmVuZCddID0gYzMuZ2VuZXJhdGUoY2hhcnRPcHRpb25zKTtcclxuICAgIH0sIDEpO1xyXG4gIH0sXHJcblxyXG4gIHNlbGVjdFBpZVNsaWNlOiBmdW5jdGlvbihjaGFydCwgZCkge1xyXG4gICAgbG9va3VwLmNoYXJ0Q2xpY2tlZCA9IHRydWU7XHJcbiAgICAkKCcjJyArIGNoYXJ0ICsgJyBwYXRoLmMzLWJhcicpLmF0dHIoJ2NsYXNzJywgZnVuY3Rpb24oaW5kZXgsIGNsYXNzTmFtZXMpIHtcclxuICAgICAgcmV0dXJuIGNsYXNzTmFtZXMgKyAnIF91bnNlbGVjdGVkXyc7XHJcbiAgICB9KTtcclxuICAgIGxvb2t1cC5jaGFydHNbY2hhcnRdLnNlbGVjdChbZC5pZF0sIFtkLmluZGV4XSwgdHJ1ZSk7XHJcblxyXG4gICAgZmFyUmlnaHRQYW5lbC5mYWRlT3V0KDIwMCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciB0ZW1wbGF0ZSA9ICQoJyNwYXRpZW50LXBhbmVsLXBsYWNlaG9sZGVyJykuaHRtbCgpO1xyXG4gICAgICBmYXJSaWdodFBhbmVsLmh0bWwoTXVzdGFjaGUucmVuZGVyKHRlbXBsYXRlKSkuc2hvdygpO1xyXG4gICAgfSk7XHJcbiAgfSxcclxuXHJcbiAgZHJhd092ZXJ2aWV3Q2hhcnQ6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBlbmFibGVIb3Zlcikge1xyXG4gICAgY2h0LmRlc3Ryb3lDaGFydHMoW3BhdGh3YXlTdGFnZSArICctY2hhcnQnXSk7XHJcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICBsb29rdXAuY2hhcnRzW3BhdGh3YXlTdGFnZSArICctY2hhcnQnXSA9IGMzLmdlbmVyYXRlKHtcclxuICAgICAgICBiaW5kdG86ICcjJyArIHBhdGh3YXlTdGFnZSArICctY2hhcnQnLFxyXG4gICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgIHg6ICd4JyxcclxuICAgICAgICAgIGNvbHVtbnM6IGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnRyZW5kXHJcbiAgICAgICAgfSxcclxuICAgICAgICB6b29tOiB7XHJcbiAgICAgICAgICBlbmFibGVkOiB0cnVlXHJcbiAgICAgICAgfSxcclxuICAgICAgICB0b29sdGlwOiB7XHJcbiAgICAgICAgICBmb3JtYXQ6IHtcclxuICAgICAgICAgICAgdGl0bGU6IGZ1bmN0aW9uKHgpIHtcclxuICAgICAgICAgICAgICByZXR1cm4geC50b0RhdGVTdHJpbmcoKSArIChlbmFibGVIb3ZlciA/ICc8YnI+Q2xpY2sgZm9yIG1vcmUgZGV0YWlsJyA6ICcnKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIGVuYWJsZUhvdmVyID8gdmFsdWUgKyAnJScgOiB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIGF4aXM6IHtcclxuICAgICAgICAgIHg6IHtcclxuICAgICAgICAgICAgdHlwZTogJ3RpbWVzZXJpZXMnLFxyXG4gICAgICAgICAgICB0aWNrOiB7XHJcbiAgICAgICAgICAgICAgZm9ybWF0OiAnJWQtJW0tJVknLFxyXG4gICAgICAgICAgICAgIGNvdW50OiA3LFxyXG4gICAgICAgICAgICAgIGN1bGxpbmc6IHtcclxuICAgICAgICAgICAgICAgIG1heDogNFxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbGFiZWw6IHtcclxuICAgICAgICAgICAgICB0ZXh0OiAnRGF0ZScsXHJcbiAgICAgICAgICAgICAgcG9zaXRpb246ICdvdXRlci1jZW50ZXInXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICB5OiB7XHJcbiAgICAgICAgICAgIG1pbjogMCxcclxuICAgICAgICAgICAgbGFiZWw6IHtcclxuICAgICAgICAgICAgICB0ZXh0OiAnUHJvcG9ydGlvbiAoJSknLFxyXG4gICAgICAgICAgICAgIHBvc2l0aW9uOiAnb3V0ZXItbWlkZGxlJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBwb2ludDoge1xyXG4gICAgICAgICAgc2hvdzogZmFsc2VcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNpemU6IHtcclxuICAgICAgICAgIGhlaWdodDogbnVsbFxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9LCAxKTtcclxuICB9LFxyXG5cclxuICBkcmF3QmVuY2htYXJrQ2hhcnQ6IGZ1bmN0aW9uKGVsZW1lbnQsIGRhdGEpIHtcclxuICAgIGNodC5kZXN0cm95Q2hhcnRzKFtlbGVtZW50ICsgJy1jaGFydCddKTtcclxuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgIGxvb2t1cC5jaGFydHNbZWxlbWVudCArICctY2hhcnQnXSA9IGMzLmdlbmVyYXRlKHtcclxuICAgICAgICBiaW5kdG86ICcjJyArIGVsZW1lbnQsXHJcbiAgICAgICAgc2l6ZToge1xyXG4gICAgICAgICAgaGVpZ2h0OiAyMDBcclxuICAgICAgICB9LFxyXG4gICAgICAgIGRhdGE6IGRhdGEsXHJcbiAgICAgICAgYXhpczoge1xyXG4gICAgICAgICAgeDoge1xyXG4gICAgICAgICAgICB0eXBlOiAnY2F0ZWdvcnknLFxyXG4gICAgICAgICAgICB0aWNrOiB7XHJcbiAgICAgICAgICAgICAgcm90YXRlOiA2MCxcclxuICAgICAgICAgICAgICBtdWx0aWxpbmU6IGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICB5OiB7XHJcbiAgICAgICAgICAgIGxhYmVsOiB7XHJcbiAgICAgICAgICAgICAgdGV4dDogJyUgb2YgcGF0aWVudHMgbWVldGluZyB0aGUgdGFyZ2V0JyxcclxuICAgICAgICAgICAgICBwb3NpdGlvbjogJ291dGVyLW1pZGRsZSdcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZ3JpZDoge1xyXG4gICAgICAgICAgeToge1xyXG4gICAgICAgICAgICBzaG93OiB0cnVlXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0sIDEpO1xyXG4gIH0sXHJcblxyXG4gIGRyYXdQZXJmb3JtYW5jZVRyZW5kQ2hhcnQ6IGZ1bmN0aW9uKGVsZW1lbnQsIGRhdGEpIHtcclxuICAgIGNodC5kZXN0cm95Q2hhcnRzKFtlbGVtZW50ICsgJy1jaGFydCddKTtcclxuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgIGxvb2t1cC5jaGFydHNbZWxlbWVudCArICctY2hhcnQnXSA9IGMzLmdlbmVyYXRlKHtcclxuICAgICAgICBiaW5kdG86ICcjJyArIGVsZW1lbnQsXHJcbiAgICAgICAgc2l6ZToge1xyXG4gICAgICAgICAgaGVpZ2h0OiAyMDBcclxuICAgICAgICB9LFxyXG4gICAgICAgIGRhdGE6IGRhdGEsXHJcbiAgICAgICAgYXhpczoge1xyXG4gICAgICAgICAgeDoge1xyXG4gICAgICAgICAgICB0eXBlOiAndGltZXNlcmllcycsXHJcbiAgICAgICAgICAgIHRpY2s6IHtcclxuICAgICAgICAgICAgICBmb3JtYXQ6ICclWS0lbS0lZCcsXHJcbiAgICAgICAgICAgICAgcm90YXRlOiA2MCxcclxuICAgICAgICAgICAgICBtdWx0aWxpbmU6IGZhbHNlXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGhlaWdodDogNjBcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICB5OiB7XHJcbiAgICAgICAgICAgIGxhYmVsOiB7XHJcbiAgICAgICAgICAgICAgdGV4dDogXCJQZXJmb3JtYW5jZVwiLFxyXG4gICAgICAgICAgICAgIHBvc2l0aW9uOiAnb3V0ZXItbWlkZGxlJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBncmlkOiB7XHJcbiAgICAgICAgICB4OiB7XHJcbiAgICAgICAgICAgIHNob3c6IHRydWVcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICB5OiB7XHJcbiAgICAgICAgICAgIHNob3c6IHRydWVcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSwgMSk7XHJcbiAgfSxcclxuXHJcbiAgZHJhd0JlbmNobWFya0NoYXJ0SEM6IGZ1bmN0aW9uKGVsZW1lbnQsIGRhdGEpIHtcclxuXHJcbiAgICBkYXRhID0gW1xyXG4gICAgICB7IHg6IDQ5LjksIHA6ICdQMScsIGxvY2FsOiB0cnVlIH0sXHJcbiAgICAgIHsgeDogNzEuNSwgcDogJ1AyJywgbG9jYWw6IHRydWUgfSxcclxuICAgICAgeyB4OiAxNi40LCBwOiAnUDMnLCBsb2NhbDogdHJ1ZSB9LFxyXG4gICAgICB7IHg6IDI5LjIsIHA6ICdQNCcsIGxvY2FsOiB0cnVlIH0sXHJcbiAgICAgIHsgeDogNDQuMCwgcDogJ1A1JywgbG9jYWw6IHRydWUgfSxcclxuICAgICAgeyB4OiA3Ni4wLCBwOiAnUDYnLCBsb2NhbDogdHJ1ZSB9LFxyXG4gICAgICB7IHg6IDM1LjYsIHA6ICdZT1UnLCBsb2NhbDogdHJ1ZSB9LFxyXG4gICAgICB7IHg6IDQ4LjUsIHA6ICdQNycsIGxvY2FsOiB0cnVlIH0sXHJcbiAgICAgIHsgeDogMjYuNCwgcDogJ1A4JywgbG9jYWw6IHRydWUgfSxcclxuICAgICAgeyB4OiA5NC4xLCBwOiAnUDknLCBsb2NhbDogdHJ1ZSB9LFxyXG4gICAgICB7IHg6IDk1LjYsIHA6ICdQMTAnIH0sXHJcbiAgICAgIHsgeDogNTQuMCwgcDogJ1AxMScgfSxcclxuICAgICAgeyB4OiAzOS45LCBwOiAnUDEyJyB9LFxyXG4gICAgICB7IHg6IDYxLjUsIHA6ICdQMTMnIH0sXHJcbiAgICAgIHsgeDogNi40LCBwOiAnUDE0JyB9LFxyXG4gICAgICB7IHg6IDE5LjIsIHA6ICdQMTUnIH0sXHJcbiAgICAgIHsgeDogMzQuMCwgcDogJ1AxNicgfSxcclxuICAgICAgeyB4OiA2Ni4wLCBwOiAnUDE3JyB9LFxyXG4gICAgICB7IHg6IDI1LjYsIHA6ICdQMTgnIH0sXHJcbiAgICAgIHsgeDogMzguNSwgcDogJ1AxOScgfSxcclxuICAgICAgeyB4OiAzNi40LCBwOiAnUDIwJyB9LFxyXG4gICAgICB7IHg6IDg0LjEsIHA6ICdQMjEnIH0sXHJcbiAgICAgIHsgeDogODUuNiwgcDogJ1AyMicgfSxcclxuICAgICAgeyB4OiA2NC4wLCBwOiAnUDIzJyB9XHJcbiAgICBdO1xyXG4gICAgZGF0YS5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcclxuICAgICAgcmV0dXJuIGEueCAtIGIueDtcclxuICAgIH0pO1xyXG5cclxuICAgIHZhciBsb2NhbCA9IHRydWU7XHJcbiAgICB2YXIgYkNoYXJ0ID0gJCgnIycgKyBlbGVtZW50KS5oaWdoY2hhcnRzKHtcclxuICAgICAgY2hhcnQ6IHtcclxuICAgICAgICB0eXBlOiAnY29sdW1uJyxcclxuICAgICAgICBldmVudHM6IHtcclxuICAgICAgICAgIGxvYWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgdGhpc0NoYXJ0ID0gdGhpcztcclxuICAgICAgICAgICAgdGhpc0NoYXJ0LnJlbmRlcmVyLmJ1dHRvbignVG9nZ2xlIG5laWdoYm91cmhvb2QgLyBDQ0cnLCB0aGlzQ2hhcnQucGxvdFdpZHRoIC0gMTAwLCAwLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICBsb2NhbCA9ICFsb2NhbDtcclxuICAgICAgICAgICAgICB0aGlzQ2hhcnQueEF4aXNbMF0uY2F0ZWdvcmllcyA9IGRhdGEuZmlsdGVyKGZ1bmN0aW9uKHYpIHtcclxuICAgICAgICAgICAgICAgIGlmIChsb2NhbCkgcmV0dXJuIHYubG9jYWw7XHJcbiAgICAgICAgICAgICAgICBlbHNlIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgIH0pLm1hcChmdW5jdGlvbih2KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdi5wO1xyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIHRoaXNDaGFydC5zZXJpZXNbMF0uc2V0RGF0YShkYXRhLmZpbHRlcihmdW5jdGlvbih2KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobG9jYWwpIHJldHVybiB2LmxvY2FsO1xyXG4gICAgICAgICAgICAgICAgZWxzZSByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICB9KS5tYXAoZnVuY3Rpb24odikge1xyXG4gICAgICAgICAgICAgICAgaWYgKHYucCA9PT0gXCJZT1VcIikgcmV0dXJuIHsgeTogdi54LCBjb2xvcjogXCJyZWRcIiB9O1xyXG4gICAgICAgICAgICAgICAgZWxzZSByZXR1cm4gdi54O1xyXG4gICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgfSkuYWRkKCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICB0aXRsZTogeyB0ZXh0OiAnQmVuY2htYXJrJyB9LFxyXG4gICAgICB4QXhpczoge1xyXG4gICAgICAgIGNhdGVnb3JpZXM6IGRhdGEuZmlsdGVyKGZ1bmN0aW9uKHYpIHtcclxuICAgICAgICAgIHJldHVybiB2LmxvY2FsID09PSBsb2NhbDtcclxuICAgICAgICB9KS5tYXAoZnVuY3Rpb24odikge1xyXG4gICAgICAgICAgcmV0dXJuIHYucDtcclxuICAgICAgICB9KSxcclxuICAgICAgICBjcm9zc2hhaXI6IHRydWVcclxuICAgICAgfSxcclxuICAgICAgeUF4aXM6IHtcclxuICAgICAgICBtaW46IDAsXHJcbiAgICAgICAgbWF4OiAxMDAsXHJcbiAgICAgICAgdGl0bGU6IHsgdGV4dDogJyUgcGF0aWVudHMgbWVldGluZyB0YXJnZXQnIH1cclxuICAgICAgfSxcclxuICAgICAgdG9vbHRpcDoge1xyXG4gICAgICAgIGhlYWRlckZvcm1hdDogJzxzcGFuIHN0eWxlPVwiZm9udC1zaXplOjEwcHhcIj5QcmFjdGljZTogPGI+e3BvaW50LmtleX08L2I+PC9zcGFuPjx0YWJsZT4nLFxyXG4gICAgICAgIHBvaW50Rm9ybWF0OiAnPHRyPjx0ZCBzdHlsZT1cImNvbG9yOntzZXJpZXMuY29sb3J9O3BhZGRpbmc6MFwiPntzZXJpZXMubmFtZX06IDwvdGQ+JyArXHJcbiAgICAgICAgICAnPHRkIHN0eWxlPVwicGFkZGluZzowXCI+PGI+e3BvaW50Lnk6LjFmfSU8L2I+PC90ZD48L3RyPicsXHJcbiAgICAgICAgZm9vdGVyRm9ybWF0OiAnPC90YWJsZT4nLFxyXG4gICAgICAgIHNoYXJlZDogdHJ1ZSxcclxuICAgICAgICB1c2VIVE1MOiB0cnVlXHJcbiAgICAgIH0sXHJcbiAgICAgIHBsb3RPcHRpb25zOiB7XHJcbiAgICAgICAgY29sdW1uOiB7XHJcbiAgICAgICAgICBwb2ludFBhZGRpbmc6IDAuMixcclxuICAgICAgICAgIGJvcmRlcldpZHRoOiAwXHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICBsZWdlbmQ6IHtcclxuICAgICAgICBlbmFibGVkOiBmYWxzZVxyXG4gICAgICB9LFxyXG4gICAgICBzZXJpZXM6IFt7XHJcbiAgICAgICAgbmFtZTogJ1BlcmZvcm1hbmNlJyxcclxuICAgICAgICBkYXRhOiBkYXRhLmZpbHRlcihmdW5jdGlvbih2KSB7XHJcbiAgICAgICAgICByZXR1cm4gdi5sb2NhbCA9PT0gbG9jYWw7XHJcbiAgICAgICAgfSkubWFwKGZ1bmN0aW9uKHYpIHtcclxuICAgICAgICAgIGlmICh2LnAgPT09IFwiWU9VXCIpIHJldHVybiB7IHk6IHYueCwgY29sb3I6IFwicmVkXCIgfTtcclxuICAgICAgICAgIGVsc2UgcmV0dXJuIHYueDtcclxuICAgICAgICB9KVxyXG4gICAgICB9XVxyXG4gICAgfSk7XHJcbiAgfSxcclxuXHJcbiAgZHJhd1BlcmZvcm1hbmNlVHJlbmRDaGFydEhDOiBmdW5jdGlvbihlbGVtZW50LCBkYXRhKSB7XHJcblxyXG4gICAgLy8vIGRhdGEgaXNcclxuICAgIC8vIHtcclxuICAgIC8vICBcInZhbHVlc1wiOlxyXG4gICAgLy8gICAgW1wieFwiLCBcIjIwMTUtMDgtMjRcIiwgXCIyMDE1LTA4LTIzXCIsLi4uXHJcbiAgICAvLyAgICBbXCJudW1lcmF0b3JcIiwgMzUsIDM3LCAzMywgMzIsIDMxLC4uLlxyXG4gICAgLy8gICAgW1wiZGVub21pbmF0b3JcIiwgMTM1LCAxMzMsIDEzMywgMTMsLi4uXHJcbiAgICAvLyAgICBbXCJ0YXJnZXRcIiwgMC4zLCAwLjMsIDAuLi5cclxuICAgIC8vIH1cclxuXHJcbiAgICB2YXIgdGFyZ2V0ID0gMC43NSxcclxuICAgICAgbWF4VmFsdWUgPSB0YXJnZXQsXHJcbiAgICAgIG1heFh2YWx1ZSA9IDA7XHJcblxyXG4gICAgdmFyIHNlcmllcyA9IFtcclxuICAgICAgeyB0eXBlOiAnbGluZScsIG5hbWU6ICdUcmVuZCcsIGRhdGE6IFtdIH0sXHJcbiAgICAgIHsgdHlwZTogJ2xpbmUnLCBuYW1lOiAnUHJlZGljdGlvbicsIGRhdGE6IFtdLCBkYXNoU3R5bGU6ICdkb3QnIH1cclxuICAgIF07XHJcblxyXG4gICAgdmFyIHRvZGF5ID0gbmV3IERhdGUoKTtcclxuICAgIHZhciBsYXN0QXByaWwgPSBuZXcgRGF0ZSgpO1xyXG4gICAgdmFyIGFwcmlsQmVmb3JlVGhhdCA9IG5ldyBEYXRlKCk7XHJcbiAgICB2YXIgbmV4dEFwcmlsID0gbmV3IERhdGUoKTtcclxuICAgIGlmICh0b2RheS5nZXRNb250aCgpIDwgMykge1xyXG4gICAgICAvL2FmdGVyIGFwcmlsXHJcbiAgICAgIGxhc3RBcHJpbC5zZXRZZWFyKHRvZGF5LmdldEZ1bGxZZWFyKCkgLSAxKTtcclxuICAgICAgYXByaWxCZWZvcmVUaGF0LnNldFllYXIodG9kYXkuZ2V0RnVsbFllYXIoKSAtIDEpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgbmV4dEFwcmlsLnNldFllYXIodG9kYXkuZ2V0RnVsbFllYXIoKSArIDEpO1xyXG4gICAgfVxyXG4gICAgYXByaWxCZWZvcmVUaGF0LnNldFllYXIoYXByaWxCZWZvcmVUaGF0LmdldEZ1bGxZZWFyKCkgLSAxKTtcclxuICAgIGxhc3RBcHJpbC5zZXRNb250aCgzKTtcclxuICAgIGFwcmlsQmVmb3JlVGhhdC5zZXRNb250aCgzKTtcclxuICAgIG5leHRBcHJpbC5zZXRNb250aCgzKTtcclxuICAgIGxhc3RBcHJpbC5zZXREYXRlKDEpO1xyXG4gICAgYXByaWxCZWZvcmVUaGF0LnNldERhdGUoMSk7XHJcbiAgICBuZXh0QXByaWwuc2V0RGF0ZSgxKTtcclxuXHJcbiAgICB2YXIgbiA9IDAsXHJcbiAgICAgIHN1bVggPSAwLFxyXG4gICAgICBzdW1ZID0gMCxcclxuICAgICAgc3VtWFkgPSAwLFxyXG4gICAgICBzdW1YWCA9IDAsXHJcbiAgICAgIHN1bVlZID0gMCxcclxuICAgICAgaW50ZXJjZXB0LCBncmFkaWVudCwgY29tcERhdGU7XHJcblxyXG4gICAgaWYgKGRhdGEudmFsdWVzWzBdLmZpbHRlcihmdW5jdGlvbih2KSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBEYXRlKHYpLmdldFRpbWUoKSA+IGxhc3RBcHJpbC5nZXRUaW1lKCk7XHJcbiAgICAgIH0pLmxlbmd0aCA+IDIpIGNvbXBEYXRlID0gbmV3IERhdGUobGFzdEFwcmlsLmdldFRpbWUoKSk7XHJcbiAgICBlbHNlIGNvbXBEYXRlID0gbmV3IERhdGUoYXByaWxCZWZvcmVUaGF0LmdldFRpbWUoKSk7XHJcblxyXG4gICAgZGF0YS52YWx1ZXNbMF0uZm9yRWFjaChmdW5jdGlvbih2LCBpKSB7XHJcbiAgICAgIGlmIChpID09PSAwKSByZXR1cm47XHJcbiAgICAgIHZhciB0aW1lID0gbmV3IERhdGUodikuZ2V0VGltZSgpO1xyXG4gICAgICB2YXIgeSA9ICtkYXRhLnZhbHVlc1sxXVtpXSAvICtkYXRhLnZhbHVlc1syXVtpXTtcclxuICAgICAgaWYgKHRpbWUgPj0gY29tcERhdGUuZ2V0VGltZSgpKSB7XHJcbiAgICAgICAgbisrO1xyXG4gICAgICAgIHN1bVggKz0gdGltZTtcclxuICAgICAgICBzdW1ZICs9IHk7XHJcbiAgICAgICAgc3VtWFkgKz0gdGltZSAqIHk7XHJcbiAgICAgICAgc3VtWFggKz0gdGltZSAqIHRpbWU7XHJcbiAgICAgICAgc3VtWVkgKz0geSAqIHk7XHJcbiAgICAgIH1cclxuICAgICAgc2VyaWVzWzBdLmRhdGEucHVzaChbdGltZSwgeV0pO1xyXG4gICAgICBtYXhWYWx1ZSA9IE1hdGgubWF4KG1heFZhbHVlLCB5KTtcclxuICAgICAgbWF4WHZhbHVlID0gTWF0aC5tYXgobWF4WHZhbHVlLCB0aW1lKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGludGVyY2VwdCA9IChzdW1ZICogc3VtWFggLSBzdW1YICogc3VtWFkpIC8gKG4gKiBzdW1YWCAtIHN1bVggKiBzdW1YKTtcclxuICAgIGdyYWRpZW50ID0gKG4gKiBzdW1YWSAtIHN1bVggKiBzdW1ZKSAvIChuICogc3VtWFggLSBzdW1YICogc3VtWCk7XHJcblxyXG4gICAgc2VyaWVzWzFdLmRhdGEucHVzaChbbWF4WHZhbHVlLCBtYXhYdmFsdWUgKiBncmFkaWVudCArIGludGVyY2VwdF0pO1xyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCAxMzsgaSsrKSB7XHJcbiAgICAgIHZhciB4ID0gY29tcERhdGUuZ2V0VGltZSgpO1xyXG4gICAgICBpZiAoeCA8IG1heFh2YWx1ZSkge1xyXG4gICAgICAgIGNvbXBEYXRlLnNldE1vbnRoKGNvbXBEYXRlLmdldE1vbnRoKCkgKyAxKTtcclxuICAgICAgICBjb250aW51ZTtcclxuICAgICAgfVxyXG4gICAgICBzZXJpZXNbMV0uZGF0YS5wdXNoKFt4LCB4ICogZ3JhZGllbnQgKyBpbnRlcmNlcHRdKTtcclxuICAgICAgdmFyIG0gPSBjb21wRGF0ZS5nZXRNb250aCgpO1xyXG4gICAgICBjb21wRGF0ZS5zZXRNb250aChjb21wRGF0ZS5nZXRNb250aCgpICsgMSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy9BZGQgbGluZSBvZiBiZXN0IGZpdCBmb3IgbGF0ZXN0IGRhdGEgc2luY2UgYXByaWwgdG8gbmV4dCBhcHJpbFxyXG5cclxuXHJcbiAgICAvL0RlZmF1bHQgdG8gbGFzdCBhcHJpbCAtIGFwcmlsXHJcblxyXG5cclxuICAgIHZhciBjID0gJCgnIycgKyBlbGVtZW50KS5oaWdoY2hhcnRzKHtcclxuICAgICAgdGl0bGU6IHsgdGV4dDogJycgfSxcclxuICAgICAgeEF4aXM6IHtcclxuICAgICAgICBtYXg6IG5leHRBcHJpbC5nZXRUaW1lKCksXHJcbiAgICAgICAgdHlwZTogJ2RhdGV0aW1lJ1xyXG4gICAgICB9LFxyXG4gICAgICB5QXhpczoge1xyXG4gICAgICAgIHRpdGxlOiB7IHRleHQ6ICdRdWFsaXR5IHN0YW5kYXJkIHBlcmZvcm1hbmNlJyB9LFxyXG4gICAgICAgIG1heDogbWF4VmFsdWUgKyAwLjA1LFxyXG4gICAgICAgIG1pbjogMCxcclxuICAgICAgICBwbG90TGluZXM6IFt7XHJcbiAgICAgICAgICB2YWx1ZTogdGFyZ2V0LFxyXG4gICAgICAgICAgY29sb3I6ICdncmVlbicsXHJcbiAgICAgICAgICBkYXNoU3R5bGU6ICdzaG9ydGRhc2gnLFxyXG4gICAgICAgICAgd2lkdGg6IDIsXHJcbiAgICAgICAgICBsYWJlbDoge1xyXG4gICAgICAgICAgICB0ZXh0OiAnVGFyZ2V0IC0gJyArICh0YXJnZXQgKiAxMDApICsgJyUnXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH1dXHJcbiAgICAgIH0sXHJcbiAgICAgIGxlZ2VuZDogeyBlbmFibGVkOiB0cnVlIH0sXHJcblxyXG4gICAgICBuYXZpZ2F0b3I6IHtcclxuICAgICAgICBlbmFibGVkOiB0cnVlXHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBzZXJpZXM6IHNlcmllc1xyXG4gICAgfSk7XHJcblxyXG4gICAgYy5oaWdoY2hhcnRzKCkuYXhlc1swXS5zZXRFeHRyZW1lcyhhcHJpbEJlZm9yZVRoYXQuZ2V0VGltZSgpLCBsYXN0QXByaWwuZ2V0VGltZSgpLCB1bmRlZmluZWQsIGZhbHNlKTtcclxuXHJcbiAgfSxcclxuXHJcbiAgZHJhd0FuYWx5dGljczogZnVuY3Rpb24oZWxlbWVudCwgZGF0YSwgc2VsZWN0U2VyaWVzRm4pIHtcclxuXHJcbiAgICBjaHQuY2xvbmVUb29sVGlwID0gbnVsbDtcclxuICAgIGNodC5jbG9uZVRvb2xUaXAyID0gbnVsbDtcclxuXHJcbiAgICAkKCcjJyArIGVsZW1lbnQpLmhpZ2hjaGFydHMoe1xyXG4gICAgICBjaGFydDoge1xyXG4gICAgICAgIHR5cGU6IFwiY29sdW1uXCIsXHJcbiAgICAgICAgYmFja2dyb3VuZENvbG9yOiBcIiNGM0Y5RjlcIixcclxuICAgICAgICBoZWlnaHQ6IDIwMCxcclxuICAgICAgICBldmVudHM6IHtcclxuICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBzZWxlY3RTZXJpZXNGbigpO1xyXG5cclxuICAgICAgICAgICAgaWYgKGNodC5jbG9uZVRvb2xUaXApIHtcclxuICAgICAgICAgICAgICB0aGlzLmNvbnRhaW5lci5maXJzdENoaWxkLnJlbW92ZUNoaWxkKGNodC5jbG9uZVRvb2xUaXApO1xyXG4gICAgICAgICAgICAgIGNodC5jbG9uZVRvb2xUaXAgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChjaHQuY2xvbmVUb29sVGlwMikge1xyXG4gICAgICAgICAgICAgIGNodC5jbG9uZVRvb2xUaXAyLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgIGNodC5jbG9uZVRvb2xUaXAyID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuICAgICAgdGl0bGU6IHtcclxuICAgICAgICB0ZXh0OiAnUGF0aWVudHMgbm90IG1lZXRpbmcgdGhlIHN0YW5kYXJkJ1xyXG4gICAgICB9LFxyXG4gICAgICBzdWJ0aXRsZToge1xyXG4gICAgICAgIHRleHQ6IGRvY3VtZW50Lm9udG91Y2hzdGFydCA9PT0gdW5kZWZpbmVkID9cclxuICAgICAgICAgICdDbGljayBhIGNvbHVtbiB0byBmaWx0ZXIgdGhlIHBhdGllbnQgbGlzdCcgOiAnVGFwIGEgY29sdW1uIHRvIGZpbHRlciB0aGUgcGF0aWVudCBsaXN0J1xyXG4gICAgICB9LFxyXG4gICAgICB4QXhpczoge1xyXG4gICAgICAgIGNhdGVnb3JpZXM6IGRhdGEubWFwKGZ1bmN0aW9uKHYsIGkpIHtcclxuICAgICAgICAgIHJldHVybiB2WzBdO1xyXG4gICAgICAgIH0pXHJcbiAgICAgIH0sXHJcbiAgICAgIHlBeGlzOiB7XHJcbiAgICAgICAgdGl0bGU6IHtcclxuICAgICAgICAgIHRleHQ6ICdOdW1iZXIgb2YgcGF0aWVudHMnXHJcbiAgICAgICAgfSxcclxuICAgICAgICBzdGFja0xhYmVsczoge1xyXG4gICAgICAgICAgZW5hYmxlZDogdHJ1ZSxcclxuICAgICAgICAgIHN0eWxlOiB7XHJcbiAgICAgICAgICAgIGZvbnRXZWlnaHQ6ICdib2xkJyxcclxuICAgICAgICAgICAgY29sb3I6IChIaWdoY2hhcnRzLnRoZW1lICYmIEhpZ2hjaGFydHMudGhlbWUudGV4dENvbG9yKSB8fCAnZ3JheSdcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0sXHJcbiAgICAgIGxlZ2VuZDoge1xyXG4gICAgICAgIGVuYWJsZWQ6IGZhbHNlXHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBwbG90T3B0aW9uczoge1xyXG5cclxuICAgICAgICBjb2x1bW46IHtcclxuICAgICAgICAgIGRhdGFMYWJlbHM6IHtcclxuICAgICAgICAgICAgZW5hYmxlZDogdHJ1ZSxcclxuICAgICAgICAgICAgY29sb3I6ICdibGFjaydcclxuICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBzZXJpZXM6IHtcclxuICAgICAgICAgIGN1cnNvcjogJ3BvaW50ZXInLFxyXG4gICAgICAgICAgcG9pbnQ6IHtcclxuICAgICAgICAgICAgZXZlbnRzOiB7XHJcbiAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbnVtUG9pbnRzID0gdGhpcy5zZXJpZXMucG9pbnRzLmxlbmd0aDtcclxuXHJcbiAgICAgICAgICAgICAgICBzZWxlY3RTZXJpZXNGbih0aGlzLmNhdGVnb3J5KTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoY2h0LmNsb25lVG9vbFRpcCkge1xyXG4gICAgICAgICAgICAgICAgICB0aGlzLnNlcmllcy5jaGFydC5jb250YWluZXIuZmlyc3RDaGlsZC5yZW1vdmVDaGlsZChjaHQuY2xvbmVUb29sVGlwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChjaHQuY2xvbmVUb29sVGlwMikge1xyXG4gICAgICAgICAgICAgICAgICBjaHQuY2xvbmVUb29sVGlwMi5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNodC5jbG9uZVRvb2xUaXAgPSB0aGlzLnNlcmllcy5jaGFydC50b29sdGlwLmxhYmVsLmVsZW1lbnQuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXJpZXMuY2hhcnQuY29udGFpbmVyLmZpcnN0Q2hpbGQuYXBwZW5kQ2hpbGQoY2h0LmNsb25lVG9vbFRpcCk7XHJcblxyXG4gICAgICAgICAgICAgICAgY2h0LmNsb25lVG9vbFRpcDIgPSAkKCcuaGlnaGNoYXJ0cy10b29sdGlwJykuY2xvbmUoKTtcclxuICAgICAgICAgICAgICAgICQodGhpcy5zZXJpZXMuY2hhcnQuY29udGFpbmVyKS5hcHBlbmQoY2h0LmNsb25lVG9vbFRpcDIpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBzZXJpZXM6IFt7XHJcbiAgICAgICAgZGF0YTogZGF0YS5tYXAoZnVuY3Rpb24odiwgaSkge1xyXG4gICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgeTogdlt2Lmxlbmd0aCAtIDFdLFxyXG4gICAgICAgICAgICBjb2xvcjogSGlnaGNoYXJ0cy5nZXRPcHRpb25zKCkuY29sb3JzW2ldXHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgIH0pXHJcbiAgICAgIH1dXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBjaHQ7XHJcbiIsInZhciBsb2cgPSByZXF1aXJlKCcuL2xvZy5qcycpLFxyXG4gIGxvb2t1cCA9IHJlcXVpcmUoJy4vbG9va3VwLmpzJyk7XHJcblxyXG5cclxudmFyIF9nZXRBbGxJbmRpY2F0b3JEYXRhID0gZnVuY3Rpb24oY2FsbGJhY2spIHtcclxuICB2YXIgciA9IE1hdGgucmFuZG9tKCk7XHJcbiAgJC5nZXRKU09OKFwiZGF0YS9pbmRpY2F0b3JzLmpzb24/dj1cIiArIHIsIGZ1bmN0aW9uKGZpbGUpIHtcclxuICAgIGR0LmluZGljYXRvcnMgPSBmaWxlO1xyXG5cclxuICAgIGR0LmluZGljYXRvcnMuZm9yRWFjaChmdW5jdGlvbihpbmRpY2F0b3IpIHtcclxuICAgICAgdmFyIHBlcmNlbnRhZ2UgPSBNYXRoLnJvdW5kKDEwMCAqIGluZGljYXRvci52YWx1ZXNbMV1bMV0gKiAxMDAgLyBpbmRpY2F0b3IudmFsdWVzWzJdWzFdKSAvIDEwMDtcclxuICAgICAgaW5kaWNhdG9yLnBlcmZvcm1hbmNlID0gaW5kaWNhdG9yLnZhbHVlc1sxXVsxXSArIFwiIC8gXCIgKyBpbmRpY2F0b3IudmFsdWVzWzJdWzFdICsgXCIgKFwiICsgcGVyY2VudGFnZSArIFwiJSlcIjtcclxuICAgICAgaW5kaWNhdG9yLnRhcmdldCA9IGluZGljYXRvci52YWx1ZXNbM11bMV0gKiAxMDAgKyBcIiVcIjtcclxuICAgICAgaW5kaWNhdG9yLnVwID0gcGVyY2VudGFnZSA+IE1hdGgucm91bmQoMTAwICogaW5kaWNhdG9yLnZhbHVlc1sxXVsyXSAqIDEwMCAvIGluZGljYXRvci52YWx1ZXNbMl1bMl0pIC8gMTAwO1xyXG4gICAgICB2YXIgdHJlbmQgPSBpbmRpY2F0b3IudmFsdWVzWzFdLm1hcChmdW5jdGlvbih2YWwsIGlkeCkge1xyXG4gICAgICAgIHJldHVybiBNYXRoLnJvdW5kKDEwMCAqIHZhbCAqIDEwMCAvIGluZGljYXRvci52YWx1ZXNbMl1baWR4XSkgLyAxMDA7XHJcbiAgICAgIH0pLnNsaWNlKDEsIDEwKTtcclxuICAgICAgdHJlbmQucmV2ZXJzZSgpO1xyXG4gICAgICBpbmRpY2F0b3IudHJlbmQgPSB0cmVuZC5qb2luKFwiLFwiKTtcclxuICAgICAgdmFyIGRhdGVzID0gaW5kaWNhdG9yLnZhbHVlc1swXS5zbGljZSgxLCAxMCk7XHJcbiAgICAgIGRhdGVzLnJldmVyc2UoKTtcclxuICAgICAgaW5kaWNhdG9yLmRhdGVzID0gZGF0ZXM7XHJcbiAgICB9KTtcclxuXHJcblxyXG4gICAgY2FsbGJhY2soZHQuaW5kaWNhdG9ycyk7XHJcbiAgfSk7XHJcbn07XHJcblxyXG52YXIgX2dldEFsbEluZGljYXRvckRhdGFTeW5jID0gZnVuY3Rpb24oY2FsbGJhY2spIHtcclxuICB2YXIgciA9IE1hdGgucmFuZG9tKCk7XHJcbiAgJC5hamF4KHtcclxuICAgIHVybDogXCJkYXRhL2luZGljYXRvcnMuanNvbj92PVwiICsgcixcclxuICAgIGFzeW5jOiBmYWxzZSxcclxuICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKGZpbGUpIHtcclxuICAgICAgZHQuaW5kaWNhdG9ycyA9IGZpbGU7XHJcblxyXG4gICAgICBkdC5pbmRpY2F0b3JzLmZvckVhY2goZnVuY3Rpb24oaW5kaWNhdG9yKSB7XHJcbiAgICAgICAgdmFyIHBlcmNlbnRhZ2UgPSBNYXRoLnJvdW5kKDEwMCAqIGluZGljYXRvci52YWx1ZXNbMV1bMV0gKiAxMDAgLyBpbmRpY2F0b3IudmFsdWVzWzJdWzFdKSAvIDEwMDtcclxuICAgICAgICBpbmRpY2F0b3IucGVyZm9ybWFuY2UgPSBpbmRpY2F0b3IudmFsdWVzWzFdWzFdICsgXCIgLyBcIiArIGluZGljYXRvci52YWx1ZXNbMl1bMV0gKyBcIiAoXCIgKyBwZXJjZW50YWdlICsgXCIlKVwiO1xyXG4gICAgICAgIGluZGljYXRvci50YXJnZXQgPSBpbmRpY2F0b3IudmFsdWVzWzNdWzFdICogMTAwICsgXCIlXCI7XHJcbiAgICAgICAgaW5kaWNhdG9yLnVwID0gcGVyY2VudGFnZSA+IE1hdGgucm91bmQoMTAwICogaW5kaWNhdG9yLnZhbHVlc1sxXVsyXSAqIDEwMCAvIGluZGljYXRvci52YWx1ZXNbMl1bMl0pIC8gMTAwO1xyXG4gICAgICAgIHZhciB0cmVuZCA9IGluZGljYXRvci52YWx1ZXNbMV0ubWFwKGZ1bmN0aW9uKHZhbCwgaWR4KSB7XHJcbiAgICAgICAgICByZXR1cm4gTWF0aC5yb3VuZCgxMDAgKiB2YWwgKiAxMDAgLyBpbmRpY2F0b3IudmFsdWVzWzJdW2lkeF0pIC8gMTAwO1xyXG4gICAgICAgIH0pLnNsaWNlKDEsIDEwKTtcclxuICAgICAgICB0cmVuZC5yZXZlcnNlKCk7XHJcbiAgICAgICAgaW5kaWNhdG9yLnRyZW5kID0gdHJlbmQuam9pbihcIixcIik7XHJcbiAgICAgICAgdmFyIGRhdGVzID0gaW5kaWNhdG9yLnZhbHVlc1swXS5zbGljZSgxLCAxMCk7XHJcbiAgICAgICAgZGF0ZXMucmV2ZXJzZSgpO1xyXG4gICAgICAgIGluZGljYXRvci5kYXRlcyA9IGRhdGVzO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIHJldHVybiBkdC5pbmRpY2F0b3JzO1xyXG59O1xyXG5cclxudmFyIF9nZXRJbmRpY2F0b3JEYXRhID0gZnVuY3Rpb24oaW5kaWNhdG9yLCBjYWxsYmFjaykge1xyXG4gIHZhciByID0gTWF0aC5yYW5kb20oKTtcclxuICAkLmdldEpTT04oXCJkYXRhL2lkYXRhLlwiICsgaW5kaWNhdG9yICsgXCIuanNvbj92PVwiICsgciwgZnVuY3Rpb24oZmlsZSkge1xyXG4gICAgZHQuaW5kaWNhdG9yc1tpbmRpY2F0b3JdID0gZmlsZTtcclxuXHJcbiAgICAvL2FwcGx5IHdoaWNoIGNhdGVnb3JpZXMgcGVvcGxlIGJlbG9uZyB0b1xyXG4gICAgT2JqZWN0LmtleXMoZHQuaW5kaWNhdG9yc1tpbmRpY2F0b3JdLnBhdGllbnRzKS5mb3JFYWNoKGZ1bmN0aW9uKHBhdGllbnQpIHtcclxuICAgICAgZHQuaW5kaWNhdG9yc1tpbmRpY2F0b3JdLnBhdGllbnRzW3BhdGllbnRdLm9wcG9ydHVuaXRpZXMgPSBbXTtcclxuICAgICAgZHQuaW5kaWNhdG9yc1tpbmRpY2F0b3JdLm9wcG9ydHVuaXRpZXMuZm9yRWFjaChmdW5jdGlvbihvcHAsIGlkeCkge1xyXG4gICAgICAgIGlmIChvcHAucGF0aWVudHMuaW5kZXhPZigrcGF0aWVudCkgPiAtMSkge1xyXG4gICAgICAgICAgZHQuaW5kaWNhdG9yc1tpbmRpY2F0b3JdLnBhdGllbnRzW3BhdGllbnRdLm9wcG9ydHVuaXRpZXMucHVzaChpZHgpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBjYWxsYmFjayhkdC5pbmRpY2F0b3JzW2luZGljYXRvcl0pO1xyXG4gIH0pO1xyXG59O1xyXG5cclxudmFyIF9nZXRJbmRpY2F0b3JEYXRhU3luYyA9IGZ1bmN0aW9uKGluZGljYXRvcikge1xyXG4gIHZhciByID0gTWF0aC5yYW5kb20oKTtcclxuICAkLmFqYXgoe1xyXG4gICAgdXJsOiBcImRhdGEvaWRhdGEuXCIgKyBpbmRpY2F0b3IgKyBcIi5qc29uP3Y9XCIgKyByLFxyXG4gICAgYXN5bmM6IGZhbHNlLFxyXG4gICAgc3VjY2VzczogZnVuY3Rpb24oZmlsZSkge1xyXG4gICAgICBkdC5pbmRpY2F0b3JzW2luZGljYXRvcl0gPSBmaWxlO1xyXG5cclxuICAgICAgLy9hcHBseSB3aGljaCBjYXRlZ29yaWVzIHBlb3BsZSBiZWxvbmcgdG9cclxuICAgICAgT2JqZWN0LmtleXMoZHQuaW5kaWNhdG9yc1tpbmRpY2F0b3JdLnBhdGllbnRzKS5mb3JFYWNoKGZ1bmN0aW9uKHBhdGllbnQpIHtcclxuICAgICAgICBkdC5pbmRpY2F0b3JzW2luZGljYXRvcl0ucGF0aWVudHNbcGF0aWVudF0ub3Bwb3J0dW5pdGllcyA9IFtdO1xyXG4gICAgICAgIGR0LmluZGljYXRvcnNbaW5kaWNhdG9yXS5vcHBvcnR1bml0aWVzLmZvckVhY2goZnVuY3Rpb24ob3BwLCBpZHgpIHtcclxuICAgICAgICAgIGlmIChvcHAucGF0aWVudHMuaW5kZXhPZigrcGF0aWVudCkgPiAtMSkge1xyXG4gICAgICAgICAgICBkdC5pbmRpY2F0b3JzW2luZGljYXRvcl0ucGF0aWVudHNbcGF0aWVudF0ub3Bwb3J0dW5pdGllcy5wdXNoKGlkeCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIH1cclxuICB9KTtcclxuICByZXR1cm4gZHQuaW5kaWNhdG9yc1tpbmRpY2F0b3JdO1xyXG59O1xyXG5cclxudmFyIF9nZXRGYWtlUGF0aWVudERhdGEgPSBmdW5jdGlvbihwYXRpZW50LCBjYWxsYmFjaykge1xyXG4gIHZhciByID0gTWF0aC5yYW5kb20oKSxcclxuICAgIGlzQXN5bmMgPSB0eXBlb2YoY2FsbGJhY2spID09PSBcImZ1bmN0aW9uXCI7XHJcbiAgaWYgKGR0LnBhdGllbnRzICYmIGR0LnBhdGllbnRzLnBhdGllbnQpIHtcclxuICAgIGlmIChpc0FzeW5jKSByZXR1cm4gY2FsbGJhY2soZHQucGF0aWVudHMucGF0aWVudCk7XHJcbiAgICBlbHNlIHJldHVybiBkdC5wYXRpZW50cy5wYXRpZW50O1xyXG4gIH1cclxuICAkLmFqYXgoe1xyXG4gICAgdXJsOiBcImRhdGEvcGF0aWVudC5qc29uP3Y9XCIgKyByLFxyXG4gICAgYXN5bmM6IGlzQXN5bmMsXHJcbiAgICBzdWNjZXNzOiBmdW5jdGlvbihmaWxlKSB7XHJcbiAgICAgIGlmICghZHQucGF0aWVudHMpIGR0LnBhdGllbnRzID0ge307XHJcbiAgICAgIGR0LnBhdGllbnRzLnBhdGllbnQgPSBmaWxlO1xyXG4gICAgICBkdC5wYXRpZW50c1twYXRpZW50XSA9IGZpbGU7XHJcblxyXG4gICAgICBpZiAoaXNBc3luYykgY2FsbGJhY2soZHQucGF0aWVudHMucGF0aWVudCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcbiAgaWYgKCFpc0FzeW5jKSByZXR1cm4gZHQucGF0aWVudHMucGF0aWVudDtcclxufTtcclxuXHJcbnZhciBfZ2V0UGF0aWVudERhdGEgPSBmdW5jdGlvbihwYXRpZW50LCBjYWxsYmFjaykge1xyXG4gIC8vaWYgY2FsbGJhY2sgcHJvdmlkZWQgZG8gYXN5bmMgLSBlbHNlIGRvIHN5bmNcclxuICB2YXIgciA9IE1hdGgucmFuZG9tKCksXHJcbiAgICBpc0FzeW5jID0gdHlwZW9mKGNhbGxiYWNrKSA9PT0gXCJmdW5jdGlvblwiO1xyXG5cclxuICBpZiAoZHQucGF0aWVudHMgJiYgZHQucGF0aWVudHNbcGF0aWVudF0pIHtcclxuICAgIGlmIChpc0FzeW5jKSByZXR1cm4gY2FsbGJhY2soZHQucGF0aWVudHNbcGF0aWVudF0pO1xyXG4gICAgZWxzZSByZXR1cm4gZHQucGF0aWVudHNbcGF0aWVudF07XHJcbiAgfVxyXG5cclxuICAkLmFqYXgoe1xyXG4gICAgdXJsOiBcImRhdGEvXCIgKyBwYXRpZW50ICsgXCIuanNvbj92PVwiICsgcixcclxuICAgIGFzeW5jOiBpc0FzeW5jLFxyXG4gICAgc3VjY2VzczogZnVuY3Rpb24oZmlsZSkge1xyXG4gICAgICBpZiAoIWR0LnBhdGllbnRzKSBkdC5wYXRpZW50cyA9IHt9O1xyXG4gICAgICBkdC5wYXRpZW50c1twYXRpZW50XSA9IGZpbGU7XHJcblxyXG4gICAgICBpZiAoaXNBc3luYykgY2FsbGJhY2soZHQucGF0aWVudHNbcGF0aWVudF0pO1xyXG4gICAgfSxcclxuICAgIGVycm9yOiBmdW5jdGlvbigpIHtcclxuICAgICAgaWYgKGR0LnBhdGllbnRzLnBhdGllbnQgJiYgaXNBc3luYykge1xyXG4gICAgICAgIGR0LnBhdGllbnRzW3BhdGllbnRdID0gZHQucGF0aWVudHMucGF0aWVudDtcclxuICAgICAgICByZXR1cm4gY2FsbGJhY2soZHQucGF0aWVudHMucGF0aWVudCk7XHJcbiAgICAgIH0gZWxzZSBpZiAoIWR0LnBhdGllbnRzLnBhdGllbnQpIHtcclxuICAgICAgICBfZ2V0RmFrZVBhdGllbnREYXRhKHBhdGllbnQsIGNhbGxiYWNrKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICBpZiAoIWlzQXN5bmMpIHJldHVybiBkdC5wYXRpZW50cy5wYXRpZW50O1xyXG59O1xyXG5cclxudmFyIGR0ID0ge1xyXG5cclxuICBwYXRod2F5TmFtZXM6IHt9LFxyXG4gIGRpc2Vhc2VzOiBbXSxcclxuICBvcHRpb25zOiBbXSxcclxuICBwYXRMb29rdXA6IHt9LFxyXG5cclxuICBnZXRQYXRpZXRMaXN0Rm9yU3RhbmRhcmQ6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCkge1xyXG4gICAgdmFyIHBhdGllbnRzID0gZHQucmVtb3ZlRHVwbGljYXRlcyhkdFtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS5vcHBvcnR1bml0aWVzLnJlZHVjZShmdW5jdGlvbihhLCBiKSB7XHJcbiAgICAgIHJldHVybiBhLnBhdGllbnRzID8gYS5wYXRpZW50cy5jb25jYXQoYi5wYXRpZW50cykgOiBhLmNvbmNhdChiLnBhdGllbnRzKTtcclxuICAgIH0pKTtcclxuICAgIHJldHVybiBwYXRpZW50cztcclxuICB9LFxyXG5cclxuICBnZXRQYXRpZW50U3RhdHVzOiBmdW5jdGlvbihwYXRpZW50SWQsIHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCkge1xyXG4gICAgaWYgKGR0LnBhdGllbnRzW3BhdGllbnRJZF0uYnJlYWNoKSB7XHJcbiAgICAgIGlmIChkdC5wYXRpZW50c1twYXRpZW50SWRdLmJyZWFjaC5maWx0ZXIoZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgICAgICByZXR1cm4gdmFsLnBhdGh3YXlJZCA9PT0gcGF0aHdheUlkICYmIHZhbC5wYXRod2F5U3RhZ2UgPT09IHBhdGh3YXlTdGFnZSAmJiB2YWwuc3RhbmRhcmQgPT09IHN0YW5kYXJkO1xyXG4gICAgICAgIH0pLmxlbmd0aCA+IDApIHtcclxuICAgICAgICByZXR1cm4gXCJtaXNzZWRcIjtcclxuICAgICAgfSBlbHNlIGlmIChkdC5wYXRpZW50c1twYXRpZW50SWRdLmJyZWFjaC5maWx0ZXIoZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgICAgICByZXR1cm4gdmFsLnBhdGh3YXlJZCA9PT0gcGF0aHdheUlkICYmIHZhbC5wYXRod2F5U3RhZ2UgPT09IFwiZGlhZ25vc2lzXCI7XHJcbiAgICAgICAgfSkubGVuZ3RoID4gMCAmJiBwYXRod2F5U3RhZ2UgIT09IFwiZGlhZ25vc2lzXCIpIHtcclxuICAgICAgICByZXR1cm4gXCJub3RcIjtcclxuICAgICAgfSBlbHNlIGlmIChkdC5wYXRpZW50c1twYXRpZW50SWRdLmJyZWFjaC5maWx0ZXIoZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgICAgICByZXR1cm4gdmFsLnBhdGh3YXlJZCA9PT0gcGF0aHdheUlkO1xyXG4gICAgICAgIH0pLmxlbmd0aCA+IDApIHtcclxuICAgICAgICByZXR1cm4gXCJva1wiO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBcIm5vdFwiO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gXCJub3RcIjtcclxuICAgIH1cclxuICB9LFxyXG5cclxuICBnZXROdW1lcmF0b3JGb3JTdGFuZGFyZDogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkKSB7XHJcbiAgICB2YXIgcGF0aWVudHMgPSBkdC5nZXRQYXRpZXRMaXN0Rm9yU3RhbmRhcmQocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkKTtcclxuICAgIHJldHVybiBwYXRpZW50cy5sZW5ndGg7XHJcbiAgfSxcclxuXHJcbiAgZ2V0RGVub21pbmF0b3JGb3JTdGFuZGFyZDogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UpIHtcclxuICAgIHZhciBwYXRpZW50cyA9IGR0W3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5wYXRpZW50c09rO1xyXG4gICAgZm9yICh2YXIgc3RhbmRhcmQgaW4gZHRbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkcykge1xyXG4gICAgICB2YXIgbmV3UGF0aWVudHMgPSBkdC5nZXRQYXRpZXRMaXN0Rm9yU3RhbmRhcmQocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkKTtcclxuICAgICAgcGF0aWVudHMgPSBwYXRpZW50cy5jb25jYXQobmV3UGF0aWVudHMpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGR0LnJlbW92ZUR1cGxpY2F0ZXMocGF0aWVudHMpLmxlbmd0aDtcclxuICB9LFxyXG5cclxuICByZW1vdmVEdXBsaWNhdGVzOiBmdW5jdGlvbihhcnJheSkge1xyXG4gICAgdmFyIGFyclJlc3VsdCA9IHt9O1xyXG4gICAgdmFyIHJ0biA9IFtdO1xyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykge1xyXG4gICAgICBhcnJSZXN1bHRbYXJyYXlbaV1dID0gYXJyYXlbaV07XHJcbiAgICB9XHJcbiAgICBmb3IgKHZhciBpdGVtIGluIGFyclJlc3VsdCkge1xyXG4gICAgICBydG4ucHVzaChhcnJSZXN1bHRbaXRlbV0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJ0bjtcclxuICB9LFxyXG5cclxuICBudW1iZXJPZlN0YW5kYXJkc01pc3NlZDogZnVuY3Rpb24ocGF0aWVudElkKSB7XHJcbiAgICBpZiAoIWR0LnBhdGllbnRzW3BhdGllbnRJZF0uYnJlYWNoKSByZXR1cm4gMDtcclxuICAgIHZhciBhID0gZHQucGF0aWVudHNbcGF0aWVudElkXS5icmVhY2gubWFwKGZ1bmN0aW9uKHZhbCkge1xyXG4gICAgICByZXR1cm4gdmFsLnBhdGh3YXlJZCArIHZhbC5wYXRod2F5U3RhZ2UgKyB2YWwuc3RhbmRhcmQ7XHJcbiAgICB9KTtcclxuICAgIHZhciBvYmogPSB7fTtcclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYS5sZW5ndGg7IGkrKykge1xyXG4gICAgICBvYmpbYVtpXV0gPSBcIlwiO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKG9iaikubGVuZ3RoO1xyXG4gIH0sXHJcblxyXG4gIGdldEFsbFBhdGllbnRzOiBmdW5jdGlvbigpIHtcclxuICAgIHZhciBwTGlzdCA9IFtdLFxyXG4gICAgICBpLCBrLCBwcm9wO1xyXG4gICAgZm9yIChrID0gMDsgayA8IGR0LmRpc2Vhc2VzLmxlbmd0aDsgaysrKSB7XHJcbiAgICAgIGZvciAoaSBpbiBsb29rdXAuY2F0ZWdvcmllcykge1xyXG4gICAgICAgIGZvciAocHJvcCBpbiBkdFtkdC5kaXNlYXNlc1trXS5pZF1baV0uYmRvd24pIHtcclxuICAgICAgICAgIGlmIChkdFtkdC5kaXNlYXNlc1trXS5pZF1baV0uYmRvd24uaGFzT3duUHJvcGVydHkocHJvcCkpIHtcclxuICAgICAgICAgICAgcExpc3QgPSBwTGlzdC5jb25jYXQoZHRbZHQuZGlzZWFzZXNba10uaWRdW2ldLmJkb3duW3Byb3BdLnBhdGllbnRzKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcExpc3QgPSBwTGlzdC5jb25jYXQoZHRbZHQuZGlzZWFzZXNba10uaWRdW2ldLnBhdGllbnRzT2spO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBwTGlzdCA9IGR0LnJlbW92ZUR1cGxpY2F0ZXMocExpc3QpO1xyXG4gICAgdmFyIHBhdGllbnRzID0gcExpc3QubWFwKGZ1bmN0aW9uKHBhdGllbnRJZCkge1xyXG4gICAgICB2YXIgcmV0ID0gZHQucGF0aWVudHNbcGF0aWVudElkXTtcclxuICAgICAgcmV0Lm5oc051bWJlciA9IGR0LnBhdExvb2t1cCA/IGR0LnBhdExvb2t1cFtwYXRpZW50SWRdIDogcGF0aWVudElkO1xyXG4gICAgICByZXQucGF0aWVudElkID0gcGF0aWVudElkO1xyXG4gICAgICByZXQuaXRlbXMgPSBbXTsgLy9UaGUgZmllbGRzIGluIHRoZSBwYXRpZW50IGxpc3QgdGFibGVcclxuICAgICAgcmV0Lml0ZW1zLnB1c2goZHQubnVtYmVyT2ZTdGFuZGFyZHNNaXNzZWQocGF0aWVudElkKSk7XHJcbiAgICAgIHJldHVybiByZXQ7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gcGF0aWVudHM7XHJcbiAgfSxcclxuXHJcbiAgZ2V0OiBmdW5jdGlvbihjYWxsYmFjaywganNvbikge1xyXG4gICAgLy9nZXQgdGV4dFxyXG4gICAgJC5nZXRKU09OKFwiZGF0YS90ZXh0Lmpzb24/dj1cIiArIE1hdGgucmFuZG9tKCksIGZ1bmN0aW9uKHRleHRmaWxlKSB7XHJcbiAgICAgIGR0LnRleHQgPSB0ZXh0ZmlsZS5wYXRod2F5cztcclxuXHJcbiAgICAgIGlmIChqc29uKSB7XHJcbiAgICAgICAgZHQubmV3bG9hZChqc29uKTtcclxuICAgICAgICBpZiAodHlwZW9mIGNhbGxiYWNrID09PSAnZnVuY3Rpb24nKSBjYWxsYmFjaygpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgICQuZ2V0SlNPTihcImRhdGEvZGF0YS5qc29uP3Y9XCIgKyBNYXRoLnJhbmRvbSgpLCBmdW5jdGlvbihmaWxlKSB7XHJcbiAgICAgICAgICBkdC5uZXdsb2FkKGZpbGUpO1xyXG4gICAgICAgICAgaWYgKHR5cGVvZiBjYWxsYmFjayA9PT0gJ2Z1bmN0aW9uJykgY2FsbGJhY2soKTtcclxuICAgICAgICB9KS5mYWlsKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgYWxlcnQoXCJkYXRhL2RhdGEuanNvbiBmYWlsZWQgdG8gbG9hZCEhIC0gaWYgeW91J3ZlIGNoYW5nZWQgaXQgcmVjZW50bHkgY2hlY2sgaXQncyB2YWxpZCBqc29uIGF0IGpzb25saW50LmNvbVwiKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxuICAgIH0pLmZhaWwoZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgIGFsZXJ0KFwiZGF0YS90ZXh0Lmpzb24gZmFpbGVkIHRvIGxvYWQhISAtIGlmIHlvdSd2ZSBjaGFuZ2VkIGl0IHJlY2VudGx5IGNoZWNrIGl0J3MgdmFsaWQganNvbiBhdCBqc29ubGludC5jb21cIik7XHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICBuZXdsb2FkOiBmdW5jdGlvbihmaWxlKSB7XHJcbiAgICBkdC5pbmRpY2F0b3JzID0gZmlsZS5pbmRpY2F0b3JzO1xyXG4gICAgZHQucGF0aHdheU5hbWVzID0ge307XHJcblxyXG4gICAgZHQuaW5kaWNhdG9ycy5mb3JFYWNoKGZ1bmN0aW9uKGluZGljYXRvcikge1xyXG4gICAgICB2YXIgcGF0aHdheUlkID0gaW5kaWNhdG9yLmlkLnNwbGl0KFwiLlwiKVswXTtcclxuICAgICAgdmFyIHBhdGh3YXlTdGFnZSA9IGluZGljYXRvci5pZC5zcGxpdChcIi5cIilbMV07XHJcbiAgICAgIHZhciBzdGFuZGFyZCA9IGluZGljYXRvci5pZC5zcGxpdChcIi5cIilbMl07XHJcbiAgICAgIGlmICghZHQucGF0aHdheU5hbWVzW3BhdGh3YXlJZF0pIGR0LnBhdGh3YXlOYW1lc1twYXRod2F5SWRdID0gXCJcIjtcclxuICAgICAgdmFyIHBlcmNlbnRhZ2UgPSBNYXRoLnJvdW5kKDEwMCAqIGluZGljYXRvci52YWx1ZXNbMV1bMV0gKiAxMDAgLyBpbmRpY2F0b3IudmFsdWVzWzJdWzFdKSAvIDEwMDtcclxuICAgICAgaW5kaWNhdG9yLnBlcmZvcm1hbmNlID0ge1xyXG4gICAgICAgIGZyYWN0aW9uOiBpbmRpY2F0b3IudmFsdWVzWzFdWzFdICsgXCIvXCIgKyBpbmRpY2F0b3IudmFsdWVzWzJdWzFdLFxyXG4gICAgICAgIHBlcmNlbnRhZ2U6IHBlcmNlbnRhZ2VcclxuICAgICAgfTtcclxuICAgICAgaW5kaWNhdG9yLmJlbmNobWFyayA9IFwiOTAlXCI7IC8vVE9ETyBtYWdpYyBudW1iZXJcclxuICAgICAgaW5kaWNhdG9yLnRhcmdldCA9IGluZGljYXRvci52YWx1ZXNbM11bMV0gKiAxMDAgKyBcIiVcIjtcclxuICAgICAgaW5kaWNhdG9yLnVwID0gcGVyY2VudGFnZSA+IE1hdGgucm91bmQoMTAwICogaW5kaWNhdG9yLnZhbHVlc1sxXVsyXSAqIDEwMCAvIGluZGljYXRvci52YWx1ZXNbMl1bMl0pIC8gMTAwO1xyXG4gICAgICB2YXIgdHJlbmQgPSBpbmRpY2F0b3IudmFsdWVzWzFdLm1hcChmdW5jdGlvbih2YWwsIGlkeCkge1xyXG4gICAgICAgIHJldHVybiBNYXRoLnJvdW5kKDEwMCAqIHZhbCAqIDEwMCAvIGluZGljYXRvci52YWx1ZXNbMl1baWR4XSkgLyAxMDA7XHJcbiAgICAgIH0pLnNsaWNlKDEsIDEwKTtcclxuICAgICAgdHJlbmQucmV2ZXJzZSgpO1xyXG4gICAgICBpbmRpY2F0b3IudHJlbmQgPSB0cmVuZC5qb2luKFwiLFwiKTtcclxuICAgICAgdmFyIGRhdGVzID0gaW5kaWNhdG9yLnZhbHVlc1swXS5zbGljZSgxLCAxMCk7XHJcbiAgICAgIGRhdGVzLnJldmVyc2UoKTtcclxuICAgICAgaW5kaWNhdG9yLmRhdGVzID0gZGF0ZXM7XHJcbiAgICAgIGlmIChkdC50ZXh0W3BhdGh3YXlJZF0gJiYgZHQudGV4dFtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0gJiYgZHQudGV4dFtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXSkge1xyXG4gICAgICAgIGluZGljYXRvci5kZXNjcmlwdGlvbiA9IGR0LnRleHRbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0uZGVzY3JpcHRpb247XHJcbiAgICAgICAgaW5kaWNhdG9yLnRhZ2xpbmUgPSBkdC50ZXh0W3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLnRhZ2xpbmU7XHJcbiAgICAgICAgaW5kaWNhdG9yLnBvc2l0aXZlTWVzc2FnZSA9IGR0LnRleHRbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0ucG9zaXRpdmVNZXNzYWdlO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGluZGljYXRvci5kZXNjcmlwdGlvbiA9IFwiTm8gZGVzY3JpcHRpb24gc3BlY2lmaWVkXCI7XHJcbiAgICAgICAgaW5kaWNhdG9yLnRhZ2xpbmUgPSBcIlwiO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBkdC5pbmRpY2F0b3JzW2luZGljYXRvci5pZF0gPSB7IHBlcmZvcm1hbmNlOiBpbmRpY2F0b3IucGVyZm9ybWFuY2UsIHRhZ2xpbmU6IGluZGljYXRvci50YWdsaW5lLCBwb3NpdGl2ZU1lc3NhZ2U6IGluZGljYXRvci5wb3NpdGl2ZU1lc3NhZ2UsIHRhcmdldDogaW5kaWNhdG9yLnRhcmdldCwgXCJvcHBvcnR1bml0aWVzXCI6IGluZGljYXRvci5vcHBvcnR1bml0aWVzIHx8IFtdLCBcInBhdGllbnRzXCI6IHt9IH07XHJcblxyXG4gICAgICAvL2FwcGx5IHdoaWNoIGNhdGVnb3JpZXMgcGVvcGxlIGJlbG9uZyB0b1xyXG4gICAgICBkdC5wYXRpZW50cyA9IHt9O1xyXG4gICAgICBkdC5wYXRpZW50QXJyYXkgPSBbXTtcclxuXHJcbiAgICAgIE9iamVjdC5rZXlzKGZpbGUucGF0aWVudHMpLmZvckVhY2goZnVuY3Rpb24ocGF0aWVudCkge1xyXG4gICAgICAgIGR0LnBhdGllbnRBcnJheS5wdXNoKHBhdGllbnQpO1xyXG4gICAgICAgIGR0LnBhdGllbnRzW3BhdGllbnRdID0gZmlsZS5wYXRpZW50c1twYXRpZW50XTtcclxuICAgICAgICBkdC5pbmRpY2F0b3JzW2luZGljYXRvci5pZF0ucGF0aWVudHNbcGF0aWVudF0gPSB7fTtcclxuICAgICAgICBkdC5pbmRpY2F0b3JzW2luZGljYXRvci5pZF0ucGF0aWVudHNbcGF0aWVudF0ub3Bwb3J0dW5pdGllcyA9IFtdO1xyXG4gICAgICAgIGR0LmluZGljYXRvcnNbaW5kaWNhdG9yLmlkXS5vcHBvcnR1bml0aWVzLmZvckVhY2goZnVuY3Rpb24ob3BwLCBpZHgpIHtcclxuICAgICAgICAgIGlmIChvcHAucGF0aWVudHMuaW5kZXhPZigrcGF0aWVudCkgPiAtMSkge1xyXG4gICAgICAgICAgICBkdC5pbmRpY2F0b3JzW2luZGljYXRvci5pZF0ucGF0aWVudHNbcGF0aWVudF0ub3Bwb3J0dW5pdGllcy5wdXNoKGlkeCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG5cclxuICB9LFxyXG5cclxuICBsb2FkOiBmdW5jdGlvbihmaWxlKSB7XHJcbiAgICB2YXIgZCA9IFwiXCIsXHJcbiAgICAgIGosIGssIGtleSwgZGF0YSA9IGZpbGUuZGlzZWFzZXM7XHJcblxyXG4gICAgZHQgPSBqUXVlcnkuZXh0ZW5kKGR0LCBkYXRhKTsgLy9jb3B5XHJcblxyXG4gICAgZHQucGF0aWVudHMgPSBmaWxlLnBhdGllbnRzO1xyXG4gICAgZHQuY29kZXMgPSBmaWxlLmNvZGVzO1xyXG4gICAgZHQucGF0aWVudEFycmF5ID0gW107XHJcbiAgICBmb3IgKHZhciBvIGluIGZpbGUucGF0aWVudHMpIHtcclxuICAgICAgaWYgKGZpbGUucGF0aWVudHMuaGFzT3duUHJvcGVydHkobykpIHtcclxuICAgICAgICBkdC5wYXRpZW50QXJyYXkucHVzaChvKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZvciAoZCBpbiBkYXRhKSB7XHJcbiAgICAgIGR0LnBhdGh3YXlOYW1lc1tkXSA9IGRhdGFbZF1bXCJkaXNwbGF5LW5hbWVcIl07XHJcbiAgICAgIHZhciBkaXNlYXNlT2JqZWN0ID0ge1xyXG4gICAgICAgIFwiaWRcIjogZCxcclxuICAgICAgICBcImxpbmtcIjogZGF0YVtkXS5saW5rID8gZGF0YVtkXS5saW5rIDogXCJkdC9cIiArIGQsXHJcbiAgICAgICAgXCJmYUljb25cIjogZGF0YVtkXS5pY29uLFxyXG4gICAgICAgIFwibmFtZVwiOiBkYXRhW2RdW1wiZGlzcGxheS1uYW1lXCJdLFxyXG4gICAgICAgIFwidGV4dFwiOiB7XHJcbiAgICAgICAgICBcImR0XCI6IHtcclxuICAgICAgICAgICAgXCJ0b29sdGlwXCI6IGRhdGFbZF1bXCJzaWRlLXBhbmVsLXRvb2x0aXBcIl1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcbiAgICAgIGlmIChkYXRhW2RdLm1vbml0b3JpbmcudGV4dCkge1xyXG4gICAgICAgIGRpc2Vhc2VPYmplY3QudGV4dC5tb25pdG9yaW5nID0gZGF0YVtkXS5tb25pdG9yaW5nLnRleHQuc2lkZVBhbmVsO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChkYXRhW2RdLnRyZWF0bWVudC50ZXh0KSB7XHJcbiAgICAgICAgZGlzZWFzZU9iamVjdC50ZXh0LnRyZWF0bWVudCA9IGRhdGFbZF0udHJlYXRtZW50LnRleHQuc2lkZVBhbmVsO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChkYXRhW2RdLmRpYWdub3Npcy50ZXh0KSB7XHJcbiAgICAgICAgZGlzZWFzZU9iamVjdC50ZXh0LmRpYWdub3NpcyA9IGRhdGFbZF0uZGlhZ25vc2lzLnRleHQuc2lkZVBhbmVsO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChkYXRhW2RdLmV4Y2x1c2lvbnMudGV4dCkge1xyXG4gICAgICAgIGRpc2Vhc2VPYmplY3QudGV4dC5leGNsdXNpb25zID0gZGF0YVtkXS5leGNsdXNpb25zLnRleHQuc2lkZVBhbmVsO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuZGlzZWFzZXMucHVzaChkaXNlYXNlT2JqZWN0KTtcclxuICAgICAgZHRbZF0uc3VnZ2VzdGlvbnMgPSBsb2cucGxhbltkXS50ZWFtO1xyXG4gICAgICAkLmV4dGVuZChkdFtkXS5tb25pdG9yaW5nLCB7XHJcbiAgICAgICAgXCJicmVha2Rvd25cIjogW10sXHJcbiAgICAgICAgXCJiZG93blwiOiB7fVxyXG4gICAgICB9KTtcclxuICAgICAgJC5leHRlbmQoZHRbZF0udHJlYXRtZW50LCB7XHJcbiAgICAgICAgXCJicmVha2Rvd25cIjogW10sXHJcbiAgICAgICAgXCJiZG93blwiOiB7fVxyXG4gICAgICB9KTtcclxuICAgICAgJC5leHRlbmQoZHRbZF0uZGlhZ25vc2lzLCB7XHJcbiAgICAgICAgXCJicmVha2Rvd25cIjogW10sXHJcbiAgICAgICAgXCJiZG93blwiOiB7fVxyXG4gICAgICB9KTtcclxuICAgICAgJC5leHRlbmQoZHRbZF0uZXhjbHVzaW9ucywge1xyXG4gICAgICAgIFwiYnJlYWtkb3duXCI6IFtdLFxyXG4gICAgICAgIFwiYmRvd25cIjoge31cclxuICAgICAgfSk7XHJcblxyXG4gICAgICBpZiAoIWR0W2RdLm1vbml0b3JpbmcuaGVhZGVyKSBjb250aW51ZTtcclxuICAgICAgZm9yIChrZXkgaW4gZHRbZF0ubW9uaXRvcmluZy5zdGFuZGFyZHMpIHtcclxuICAgICAgICB0aGlzLm9wdGlvbnMucHVzaCh7XHJcbiAgICAgICAgICBcInZhbHVlXCI6IHRoaXMub3B0aW9ucy5sZW5ndGgsXHJcbiAgICAgICAgICBcInBhdGh3YXlJZFwiOiBkLFxyXG4gICAgICAgICAgXCJwYXRod2F5U3RhZ2VcIjogXCJtb25pdG9yaW5nXCIsXHJcbiAgICAgICAgICBcInN0YW5kYXJkXCI6IGtleSxcclxuICAgICAgICAgIFwidGV4dFwiOiB0aGlzLnBhdGh3YXlOYW1lc1tkXSArICcgLSAnICsgXCJNb25pdG9yaW5nXCIgKyAnIC0gJyArIGR0W2RdLm1vbml0b3Jpbmcuc3RhbmRhcmRzW2tleV0udGFiLnRpdGxlXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgZm9yIChqID0gMDsgaiA8IGR0W2RdLm1vbml0b3Jpbmcuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllcy5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgZHRbZF0ubW9uaXRvcmluZy5iZG93bltkdFtkXS5tb25pdG9yaW5nLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ubmFtZV0gPSBkdFtkXS5tb25pdG9yaW5nLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal07XHJcbiAgICAgICAgICBkdFtkXS5tb25pdG9yaW5nLmJkb3duW2R0W2RdLm1vbml0b3Jpbmcuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5uYW1lXS5zdWdnZXN0aW9ucyA9IGxvZy5wbGFuW2RdLm1vbml0b3JpbmcuaW5kaXZpZHVhbFtkdFtkXS5tb25pdG9yaW5nLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ubmFtZV07XHJcbiAgICAgICAgICBmb3IgKGsgPSAwOyBrIDwgZHRbZF0ubW9uaXRvcmluZy5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLnBhdGllbnRzLmxlbmd0aDsgaysrKSB7XHJcbiAgICAgICAgICAgIGlmICghZHQucGF0aWVudHNbZHRbZF0ubW9uaXRvcmluZy5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLnBhdGllbnRzW2tdXS5icmVhY2gpIGR0LnBhdGllbnRzW2R0W2RdLm1vbml0b3Jpbmcuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5wYXRpZW50c1trXV0uYnJlYWNoID0gW107XHJcbiAgICAgICAgICAgIGR0LnBhdGllbnRzW2R0W2RdLm1vbml0b3Jpbmcuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5wYXRpZW50c1trXV0uYnJlYWNoLnB1c2goe1xyXG4gICAgICAgICAgICAgIFwicGF0aHdheUlkXCI6IGQsXHJcbiAgICAgICAgICAgICAgXCJwYXRod2F5U3RhZ2VcIjogXCJtb25pdG9yaW5nXCIsXHJcbiAgICAgICAgICAgICAgXCJzdGFuZGFyZFwiOiBrZXksXHJcbiAgICAgICAgICAgICAgXCJzdWJzZWN0aW9uXCI6IGR0W2RdLm1vbml0b3Jpbmcuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5uYW1lXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBmb3IgKGtleSBpbiBkdFtkXS5kaWFnbm9zaXMuc3RhbmRhcmRzKSB7XHJcbiAgICAgICAgdGhpcy5vcHRpb25zLnB1c2goe1xyXG4gICAgICAgICAgXCJ2YWx1ZVwiOiB0aGlzLm9wdGlvbnMubGVuZ3RoLFxyXG4gICAgICAgICAgXCJwYXRod2F5SWRcIjogZCxcclxuICAgICAgICAgIFwicGF0aHdheVN0YWdlXCI6IFwiZGlhZ25vc2lzXCIsXHJcbiAgICAgICAgICBcInN0YW5kYXJkXCI6IGtleSxcclxuICAgICAgICAgIFwidGV4dFwiOiB0aGlzLnBhdGh3YXlOYW1lc1tkXSArICcgLSAnICsgXCJEaWFnbm9zaXNcIiArICcgLSAnICsgZHRbZF0uZGlhZ25vc2lzLnN0YW5kYXJkc1trZXldLnRhYi50aXRsZVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGZvciAoaiA9IDA7IGogPCBkdFtkXS5kaWFnbm9zaXMuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllcy5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgZHRbZF0uZGlhZ25vc2lzLmJkb3duW2R0W2RdLmRpYWdub3Npcy5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLm5hbWVdID0gZHRbZF0uZGlhZ25vc2lzLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal07XHJcbiAgICAgICAgICBkdFtkXS5kaWFnbm9zaXMuYmRvd25bZHRbZF0uZGlhZ25vc2lzLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ubmFtZV0uc3VnZ2VzdGlvbnMgPSBsb2cucGxhbltkXS5kaWFnbm9zaXMuaW5kaXZpZHVhbFtkdFtkXS5kaWFnbm9zaXMuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5uYW1lXTtcclxuICAgICAgICAgIGZvciAoayA9IDA7IGsgPCBkdFtkXS5kaWFnbm9zaXMuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5wYXRpZW50cy5sZW5ndGg7IGsrKykge1xyXG4gICAgICAgICAgICBpZiAoIWR0LnBhdGllbnRzW2R0W2RdLmRpYWdub3Npcy5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLnBhdGllbnRzW2tdXS5icmVhY2gpIGR0LnBhdGllbnRzW2R0W2RdLmRpYWdub3Npcy5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLnBhdGllbnRzW2tdXS5icmVhY2ggPSBbXTtcclxuICAgICAgICAgICAgZHQucGF0aWVudHNbZHRbZF0uZGlhZ25vc2lzLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ucGF0aWVudHNba11dLmJyZWFjaC5wdXNoKHtcclxuICAgICAgICAgICAgICBcInBhdGh3YXlJZFwiOiBkLFxyXG4gICAgICAgICAgICAgIFwicGF0aHdheVN0YWdlXCI6IFwiZGlhZ25vc2lzXCIsXHJcbiAgICAgICAgICAgICAgXCJzdGFuZGFyZFwiOiBrZXksXHJcbiAgICAgICAgICAgICAgXCJzdWJzZWN0aW9uXCI6IGR0W2RdLmRpYWdub3Npcy5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLm5hbWVcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGZvciAoa2V5IGluIGR0W2RdLnRyZWF0bWVudC5zdGFuZGFyZHMpIHtcclxuICAgICAgICB0aGlzLm9wdGlvbnMucHVzaCh7XHJcbiAgICAgICAgICBcInZhbHVlXCI6IHRoaXMub3B0aW9ucy5sZW5ndGgsXHJcbiAgICAgICAgICBcInBhdGh3YXlJZFwiOiBkLFxyXG4gICAgICAgICAgXCJwYXRod2F5U3RhZ2VcIjogXCJ0cmVhdG1lbnRcIixcclxuICAgICAgICAgIFwic3RhbmRhcmRcIjoga2V5LFxyXG4gICAgICAgICAgXCJ0ZXh0XCI6IHRoaXMucGF0aHdheU5hbWVzW2RdICsgJyAtICcgKyBcIlRyZWF0bWVudFwiICsgJyAtICcgKyBkdFtkXS50cmVhdG1lbnQuc3RhbmRhcmRzW2tleV0udGFiLnRpdGxlXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgZm9yIChqID0gMDsgaiA8IGR0W2RdLnRyZWF0bWVudC5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICBkdFtkXS50cmVhdG1lbnQuYmRvd25bZHRbZF0udHJlYXRtZW50LnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ubmFtZV0gPSBkdFtkXS50cmVhdG1lbnQuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXTtcclxuICAgICAgICAgIGR0W2RdLnRyZWF0bWVudC5iZG93bltkdFtkXS50cmVhdG1lbnQuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5uYW1lXS5zdWdnZXN0aW9ucyA9IGxvZy5wbGFuW2RdLnRyZWF0bWVudC5pbmRpdmlkdWFsW2R0W2RdLnRyZWF0bWVudC5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLm5hbWVdO1xyXG4gICAgICAgICAgZm9yIChrID0gMDsgayA8IGR0W2RdLnRyZWF0bWVudC5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLnBhdGllbnRzLmxlbmd0aDsgaysrKSB7XHJcbiAgICAgICAgICAgIGlmICghZHQucGF0aWVudHNbZHRbZF0udHJlYXRtZW50LnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ucGF0aWVudHNba11dLmJyZWFjaCkgZHQucGF0aWVudHNbZHRbZF0udHJlYXRtZW50LnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ucGF0aWVudHNba11dLmJyZWFjaCA9IFtdO1xyXG4gICAgICAgICAgICBkdC5wYXRpZW50c1tkdFtkXS50cmVhdG1lbnQuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5wYXRpZW50c1trXV0uYnJlYWNoLnB1c2goe1xyXG4gICAgICAgICAgICAgIFwicGF0aHdheUlkXCI6IGQsXHJcbiAgICAgICAgICAgICAgXCJwYXRod2F5U3RhZ2VcIjogXCJ0cmVhdG1lbnRcIixcclxuICAgICAgICAgICAgICBcInN0YW5kYXJkXCI6IGtleSxcclxuICAgICAgICAgICAgICBcInN1YnNlY3Rpb25cIjogZHRbZF0udHJlYXRtZW50LnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ubmFtZVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgZm9yIChrZXkgaW4gZHRbZF0uZXhjbHVzaW9ucy5zdGFuZGFyZHMpIHtcclxuICAgICAgICB0aGlzLm9wdGlvbnMucHVzaCh7XHJcbiAgICAgICAgICBcInZhbHVlXCI6IHRoaXMub3B0aW9ucy5sZW5ndGgsXHJcbiAgICAgICAgICBcInBhdGh3YXlJZFwiOiBkLFxyXG4gICAgICAgICAgXCJwYXRod2F5U3RhZ2VcIjogXCJleGNsdXNpb25zXCIsXHJcbiAgICAgICAgICBcInN0YW5kYXJkXCI6IGtleSxcclxuICAgICAgICAgIFwidGV4dFwiOiB0aGlzLnBhdGh3YXlOYW1lc1tkXSArICcgLSAnICsgXCJFeGNsdXNpb25zXCIgKyAnIC0gJyArIGR0W2RdLmV4Y2x1c2lvbnMuc3RhbmRhcmRzW2tleV0udGFiLnRpdGxlXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgZm9yIChqID0gMDsgaiA8IGR0W2RdLmV4Y2x1c2lvbnMuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllcy5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgZHRbZF0uZXhjbHVzaW9ucy5iZG93bltkdFtkXS5leGNsdXNpb25zLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ubmFtZV0gPSBkdFtkXS5leGNsdXNpb25zLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal07XHJcbiAgICAgICAgICBkdFtkXS5leGNsdXNpb25zLmJkb3duW2R0W2RdLmV4Y2x1c2lvbnMuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5uYW1lXS5zdWdnZXN0aW9ucyA9IGxvZy5wbGFuW2RdLmV4Y2x1c2lvbnMuaW5kaXZpZHVhbFtkdFtkXS5leGNsdXNpb25zLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ubmFtZV07XHJcbiAgICAgICAgICBmb3IgKGsgPSAwOyBrIDwgZHRbZF0uZXhjbHVzaW9ucy5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLnBhdGllbnRzLmxlbmd0aDsgaysrKSB7XHJcbiAgICAgICAgICAgIGlmICghZHQucGF0aWVudHNbZHRbZF0uZXhjbHVzaW9ucy5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLnBhdGllbnRzW2tdXS5icmVhY2gpIGR0LnBhdGllbnRzW2R0W2RdLmV4Y2x1c2lvbnMuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5wYXRpZW50c1trXV0uYnJlYWNoID0gW107XHJcbiAgICAgICAgICAgIGR0LnBhdGllbnRzW2R0W2RdLmV4Y2x1c2lvbnMuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5wYXRpZW50c1trXV0uYnJlYWNoLnB1c2goe1xyXG4gICAgICAgICAgICAgIFwicGF0aHdheUlkXCI6IGQsXHJcbiAgICAgICAgICAgICAgXCJwYXRod2F5U3RhZ2VcIjogXCJleGNsdXNpb25zXCIsXHJcbiAgICAgICAgICAgICAgXCJzdGFuZGFyZFwiOiBrZXksXHJcbiAgICAgICAgICAgICAgXCJzdWJzZWN0aW9uXCI6IGR0W2RdLmV4Y2x1c2lvbnMuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5uYW1lXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIGdldEFsbEluZGljYXRvckRhdGE6IGZ1bmN0aW9uKGNhbGxiYWNrKSB7XHJcbiAgICBpZiAoZHQuaW5kaWNhdG9ycykge1xyXG4gICAgICByZXR1cm4gY2FsbGJhY2soZHQuaW5kaWNhdG9ycyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBfZ2V0QWxsSW5kaWNhdG9yRGF0YShjYWxsYmFjayk7XHJcbiAgICB9XHJcbiAgfSxcclxuXHJcbiAgZ2V0QWxsSW5kaWNhdG9yRGF0YVN5bmM6IGZ1bmN0aW9uKCkge1xyXG4gICAgaWYgKGR0LmluZGljYXRvcnMpIHtcclxuICAgICAgcmV0dXJuIGR0LmluZGljYXRvcnM7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gX2dldEFsbEluZGljYXRvckRhdGFTeW5jKCk7XHJcbiAgICB9XHJcbiAgfSxcclxuXHJcbiAgZ2V0SW5kaWNhdG9yRGF0YTogZnVuY3Rpb24oaW5kaWNhdG9yLCBjYWxsYmFjaykge1xyXG4gICAgaWYgKCFkdC5pbmRpY2F0b3JzKSB7XHJcbiAgICAgIF9nZXRBbGxJbmRpY2F0b3JEYXRhKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICBfZ2V0SW5kaWNhdG9yRGF0YShpbmRpY2F0b3IsIGNhbGxiYWNrKTtcclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2UgaWYgKGR0LmluZGljYXRvcnMgJiYgZHQuaW5kaWNhdG9yc1tpbmRpY2F0b3JdKSB7XHJcbiAgICAgIHJldHVybiBjYWxsYmFjayhkdC5pbmRpY2F0b3JzW2luZGljYXRvcl0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgX2dldEluZGljYXRvckRhdGEoaW5kaWNhdG9yLCBjYWxsYmFjayk7XHJcbiAgICB9XHJcbiAgfSxcclxuXHJcbiAgZ2V0SW5kaWNhdG9yRGF0YVN5bmM6IGZ1bmN0aW9uKGluZGljYXRvcikge1xyXG4gICAgZHQuZ2V0QWxsSW5kaWNhdG9yRGF0YVN5bmMoKTtcclxuICAgIGlmIChkdC5pbmRpY2F0b3JzW2luZGljYXRvcl0pIHtcclxuICAgICAgcmV0dXJuIGR0LmluZGljYXRvcnNbaW5kaWNhdG9yXTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiBfZ2V0SW5kaWNhdG9yRGF0YVN5bmMoaW5kaWNhdG9yKTtcclxuICAgIH1cclxuICB9LFxyXG5cclxuICBnZXRQYXRpZW50RGF0YTogZnVuY3Rpb24ocGF0aWVudElkLCBjYWxsYmFjaykge1xyXG4gICAgcmV0dXJuIF9nZXRQYXRpZW50RGF0YShwYXRpZW50SWQsIGNhbGxiYWNrKTtcclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBkdDtcclxuIiwidmFyIGRhdGEgPSByZXF1aXJlKCcuL2RhdGEuanMnKSxcclxuTXVzdGFjaGUgPSByZXF1aXJlKCdtdXN0YWNoZScpO1xyXG5cclxudmFyIGxheW91dCA9IHtcclxuXHJcbiAgZWxlbWVudHM6IHt9LFxyXG5cclxuICAvL1NpZGUgcGFuZWwsIG5hdmlnYXRpb24sIGhlYWRlciBiYXIgYW5kIG1haW4gcGFnZVxyXG4gIHNob3dNYWluVmlldzogZnVuY3Rpb24oKSB7XHJcbiAgICAvL1NldCB1cCBuYXZpZ2F0aW9uIHBhbmVsXHJcbiAgICAvLy8vbGF5b3V0LnNob3dTaWRlUGFuZWwoKTtcclxuICAgIC8vLy9sYXlvdXQuc2hvd05hdmlnYXRpb24oZGF0YS5kaXNlYXNlcywgaWR4LCAkKCcjbWFpbi1kYXNoYm9hcmQnKSk7XHJcblxyXG4gICAgJCgnI2JvdHRvbW5hdmJhcicpLmhpZGUoKTtcclxuICAgIGxheW91dC5zaG93SGVhZGVyQmFySXRlbXMoKTtcclxuXHJcbiAgICAvL1Nob3cgbWFpbiBkYXNoYm9hcmQgcGFnZVxyXG4gICAgbGF5b3V0LnNob3dQYWdlKCdtYWluLWRhc2hib2FyZCcpO1xyXG4gIH0sXHJcblxyXG4gIGNsZWFyTmF2aWdhdGlvbjogZnVuY3Rpb24oKSB7XHJcbiAgICAkKFwiYXNpZGUubGVmdC1wYW5lbCBuYXYubmF2aWdhdGlvbiA+IHVsID4gbGkgPiB1bFwiKS5zbGlkZVVwKDMwMCk7XHJcbiAgICAkKFwiYXNpZGUubGVmdC1wYW5lbCBuYXYubmF2aWdhdGlvbiA+IHVsID4gbGlcIikucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gIH0sXHJcblxyXG4gIHNob3dOYXZpZ2F0aW9uOiBmdW5jdGlvbihsaXN0LCBpZHgsIHBhcmVudCkge1xyXG4gICAgaWYgKGxheW91dC5lbGVtZW50cy5uYXZpZ2F0aW9uKSB7XHJcblxyXG4gICAgICBpZiAoaWR4ID09PSAtMSkge1xyXG4gICAgICAgIGxheW91dC5jbGVhck5hdmlnYXRpb24oKTtcclxuICAgICAgICAkKCdhc2lkZSBhW2hyZWY9XCIjd2VsY29tZVwiXTpmaXJzdCcpLmNsb3Nlc3QoJ2xpJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICB9IGVsc2UgaWYgKGlkeCA+PSBsaXN0Lmxlbmd0aCkge1xyXG4gICAgICAgIGxheW91dC5jbGVhck5hdmlnYXRpb24oKTtcclxuICAgICAgICAkKCdhc2lkZSBhW2hyZWY9XCIjcGF0aWVudHNcIl0nKS5jbG9zZXN0KCdsaScpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgfSBlbHNlIGlmICghJCgnYXNpZGUgYVtocmVmPVwiIycgKyBsaXN0W2lkeF0ubGluayArICdcIl06Zmlyc3QnKS5jbG9zZXN0KCdsaScpLmhhc0NsYXNzKCdhY3RpdmUnKSkge1xyXG4gICAgICAgIGxheW91dC5jbGVhck5hdmlnYXRpb24oKTtcclxuICAgICAgICAvL3NldCBhY3RpdmVcclxuICAgICAgICAkKCdhc2lkZSBhW2hyZWY9XCIjJyArIGxpc3RbaWR4XS5saW5rICsgJ1wiXScpLm5leHQoKS5zbGlkZVRvZ2dsZSgzMDApO1xyXG4gICAgICAgICQoJ2FzaWRlIGFbaHJlZj1cIiMnICsgbGlzdFtpZHhdLmxpbmsgKyAnXCJdJykuY2xvc2VzdCgnbGknKS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICB2YXIgdGVtcE11c3QgPSAkKCcjcGF0aHdheS1waWNrZXInKS5odG1sKCk7XHJcbiAgICB2YXIgaXRlbVRlbXBsYXRlID0gJCgnI3BhdGh3YXktcGlja2VyLWl0ZW0nKS5odG1sKCk7XHJcbiAgICBNdXN0YWNoZS5wYXJzZSh0ZW1wTXVzdCk7XHJcbiAgICBNdXN0YWNoZS5wYXJzZShpdGVtVGVtcGxhdGUpO1xyXG5cclxuICAgIGxpc3QgPSBsaXN0LnNsaWNlKCk7XHJcbiAgICBsaXN0WzBdLmlzQnJlYWtBYm92ZVByYWN0aWNlID0gdHJ1ZTtcclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykge1xyXG4gICAgICBsaXN0W2ldLmhhc1N1Ykl0ZW1zID0gdHJ1ZTtcclxuICAgIH1cclxuICAgIGxpc3QudW5zaGlmdCh7XHJcbiAgICAgIFwibGlua1wiOiBcIndlbGNvbWVcIixcclxuICAgICAgXCJmYUljb25cIjogXCJmYS1ob21lXCIsXHJcbiAgICAgIFwibmFtZVwiOiBcIkFncmVlZCBhY3Rpb25zXCIsXHJcbiAgICAgIFwiaXNCcmVha0Fib3ZlSG9tZVwiOiB0cnVlLFxyXG4gICAgICBcInRleHRcIjoge1xyXG4gICAgICAgIFwibWFpblwiOiB7XHJcbiAgICAgICAgICBcInRvb2x0aXBcIjogXCJBZ3JlZWQgdG9vbHRpcCAtIGVkaXQgaW4gc2NyaXB0LmpzXCJcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgbGlzdC5wdXNoKHtcclxuICAgICAgXCJsaW5rXCI6IFwicGF0aWVudHNcIixcclxuICAgICAgXCJmYUljb25cIjogXCJmYS11c2Vyc1wiLFxyXG4gICAgICBcIm5hbWVcIjogXCJBbGwgUGF0aWVudHNcIixcclxuICAgICAgXCJpc0JyZWFrQWJvdmVQYXRpZW50XCI6IHRydWUsXHJcbiAgICAgIFwidGV4dFwiOiB7XHJcbiAgICAgICAgXCJtYWluXCI6IHtcclxuICAgICAgICAgIFwidG9vbHRpcFwiOiBcIkFsbCBwYXRpZW50cyB0b29sdGlwIC0gZWRpdCBpbiBzY3JpcHQuanNcIlxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgbGlzdC5tYXAoZnVuY3Rpb24odiwgaSwgYXJyKSB7XHJcbiAgICAgIHYuaXNTZWxlY3RlZCA9IGkgPT09IGlkeCArIDE7XHJcbiAgICAgIHJldHVybiB2O1xyXG4gICAgfSk7XHJcblxyXG4gICAgdmFyIHJlbmRlcmVkQmVmb3JlID0gTXVzdGFjaGUucmVuZGVyKHRlbXBNdXN0LCB7XHJcbiAgICAgIFwiaXRlbXNcIjogbGlzdFxyXG4gICAgfSwge1xyXG4gICAgICBcIml0ZW1cIjogaXRlbVRlbXBsYXRlLFxyXG4gICAgICBcInN1Ykl0ZW1cIjogJCgnI3BhdGh3YXktcGlja2VyLXN1Yi1pdGVtJykuaHRtbCgpXHJcbiAgICB9KTtcclxuICAgICQoJyNhc2lkZS10b2dnbGUgbmF2OmZpcnN0JykuaHRtbChyZW5kZXJlZEJlZm9yZSk7XHJcblxyXG4gICAgJCgnLnVzZXInKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcclxuICAgICAgdGVtcGxhdGUubG9hZENvbnRlbnQoJyNhZ3JlZWRhY3Rpb25zJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBsYXlvdXQuZWxlbWVudHMubmF2aWdhdGlvbiA9IHRydWU7XHJcbiAgfSxcclxuXHJcbiAgc2hvd1BhZ2U6IGZ1bmN0aW9uKHBhZ2UpIHtcclxuICAgIGlmIChsYXlvdXQucGFnZSA9PT0gcGFnZSkgcmV0dXJuO1xyXG4gICAgbGF5b3V0LnBhZ2UgPSBwYWdlO1xyXG4gICAgJCgnLnBhZ2UnKS5oaWRlKCk7XHJcbiAgICAkKCcjJyArIHBhZ2UpLnNob3coKTtcclxuXHJcbiAgICBpZiAocGFnZSAhPT0gJ21haW4tZGFzaGJvYXJkJykge1xyXG4gICAgICAvLy8vbGF5b3V0LmhpZGVTaWRlUGFuZWwoKTtcclxuICAgICAgJCgnI2JvdHRvbW5hdmJhcicpLnNob3coKTtcclxuICAgICAgbGF5b3V0LmhpZGVIZWFkZXJCYXJJdGVtcygpO1xyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIHNob3dTaWRlUGFuZWw6IGZ1bmN0aW9uKCkge1xyXG4gICAgaWYgKGxheW91dC5lbGVtZW50cy5uYXZpZ3Rpb24pIHJldHVybjtcclxuICAgIGxheW91dC5lbGVtZW50cy5uYXZpZ3Rpb24gPSB0cnVlO1xyXG4gICAgJCgnI21haW4nKS5hZGRDbGFzcygnY29udGVudCcpO1xyXG4gICAgJCgnI3RvcG5hdmJhcicpLmFkZENsYXNzKCdmdWxsJyk7XHJcbiAgICAkKCcjYXNpZGUtdG9nZ2xlJykuc2hvdygpO1xyXG4gICAgJCgnI2JvdHRvbW5hdmJhcicpLmhpZGUoKTtcclxuICB9LFxyXG5cclxuICBoaWRlU2lkZVBhbmVsOiBmdW5jdGlvbigpIHtcclxuICAgIGlmIChsYXlvdXQuZWxlbWVudHMubmF2aWd0aW9uID09PSBmYWxzZSkgcmV0dXJuO1xyXG4gICAgbGF5b3V0LmVsZW1lbnRzLm5hdmlndGlvbiA9IGZhbHNlO1xyXG4gICAgJCgnI21haW4nKS5yZW1vdmVDbGFzcygnY29udGVudCcpO1xyXG4gICAgJCgnI3RvcG5hdmJhcicpLnJlbW92ZUNsYXNzKCdmdWxsJyk7XHJcbiAgICAkKCcjYXNpZGUtdG9nZ2xlJykuaGlkZSgpO1xyXG4gICAgJCgnI2JvdHRvbW5hdmJhcicpLnNob3coKTtcclxuICB9LFxyXG5cclxuICBzaG93SGVhZGVyQmFySXRlbXM6IGZ1bmN0aW9uKCkge1xyXG4gICAgaWYgKGxheW91dC5lbGVtZW50cy5oZWFkZXJiYXIpIHJldHVybjtcclxuICAgIGxheW91dC5lbGVtZW50cy5oZWFkZXJiYXIgPSB0cnVlO1xyXG4gICAgJCgnLmhpZGUtaWYtbG9nZ2VkLW91dCcpLnNob3coKTtcclxuICB9LFxyXG5cclxuICBoaWRlSGVhZGVyQmFySXRlbXM6IGZ1bmN0aW9uKCkge1xyXG4gICAgaWYgKGxheW91dC5lbGVtZW50cy5oZWFkZXJiYXIgPT09IGZhbHNlKSByZXR1cm47XHJcbiAgICBsYXlvdXQuZWxlbWVudHMuaGVhZGVyYmFyID0gZmFsc2U7XHJcbiAgICAkKCcuaGlkZS1pZi1sb2dnZWQtb3V0JykuaGlkZSgpO1xyXG4gIH1cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGxheW91dDtcclxuIiwidmFyIG5vdGlmeSA9IHJlcXVpcmUoJy4vbm90aWZ5LmpzJyk7XHJcblxyXG52YXIgbG9nID0ge1xyXG4gIHJlYXNvbjoge30sXHJcblxyXG4gIGdldE9iajogZnVuY3Rpb24ob3B0aW9ucykge1xyXG4gICAgdmFyIG9iaiA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmJiKTtcclxuXHJcbiAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLmxlbmd0aCA+IDApIHtcclxuICAgICAgb3B0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uKG9wdCkge1xyXG4gICAgICAgIGlmICghb2JqW29wdC5uYW1lXSkge1xyXG4gICAgICAgICAgb2JqW29wdC5uYW1lXSA9IG9wdC52YWx1ZTtcclxuICAgICAgICAgIGxvZy5zZXRPYmoob2JqKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBvYmo7XHJcbiAgfSxcclxuXHJcbiAgc2V0T2JqOiBmdW5jdGlvbihvYmopIHtcclxuICAgIGxvY2FsU3RvcmFnZS5iYiA9IEpTT04uc3RyaW5naWZ5KG9iaik7XHJcbiAgfSxcclxuXHJcbiAgbG9hZEFjdGlvbnM6IGZ1bmN0aW9uKGNhbGxiYWNrKSB7XHJcbiAgICB2YXIgciA9IE1hdGgucmFuZG9tKCk7XHJcbiAgICAkLmdldEpTT04oXCJhY3Rpb24tcGxhbi5qc29uP3Y9XCIgKyByLCBmdW5jdGlvbihmaWxlKSB7XHJcbiAgICAgIGxvZy5wbGFuID0gZmlsZS5kaXNlYXNlcztcclxuICAgICAgbG9nLnRleHQgPSBmaWxlLnBsYW5zO1xyXG4gICAgICBjYWxsYmFjaygpO1xyXG4gICAgfSk7XHJcbiAgfSxcclxuXHJcbiAgZWRpdEFjdGlvbjogZnVuY3Rpb24oaWQsIGFjdGlvbklkLCBhZ3JlZSwgZG9uZSwgcmVhc29uKSB7XHJcbiAgICB2YXIgbG9nVGV4dCwgb2JqID0gbG9nLmdldE9iaihbe1xyXG4gICAgICBuYW1lOiBcImFjdGlvbnNcIixcclxuICAgICAgdmFsdWU6IHt9XHJcbiAgICB9XSk7XHJcbiAgICBpZiAoIWlkKSBhbGVydChcIkFDVElPTiBURUFNL0lORCBJRFwiKTtcclxuICAgIGlmICghYWN0aW9uSWQpIGFsZXJ0KFwiQUNUSU9OIElEXCIpO1xyXG5cclxuICAgIGlmICghb2JqLmFjdGlvbnNbaWRdKSB7XHJcbiAgICAgIG9iai5hY3Rpb25zW2lkXSA9IHt9O1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBpZiAoYWdyZWUpIHtcclxuICAgICAgbG9nVGV4dCA9IFwiWW91IGFncmVlZCB3aXRoIHRoaXMgc3VnZ2VzdGVkIGFjdGlvbiBvbiBcIiArIChuZXcgRGF0ZSgpKS50b0RhdGVTdHJpbmcoKTtcclxuICAgIH0gZWxzZSBpZiAoYWdyZWUgPT09IGZhbHNlKSB7XHJcbiAgICAgIHZhciByZWFzb25UZXh0ID0gbG9nLnJlYXNvbi5yZWFzb24gPT09IFwiXCIgJiYgbG9nLnJlYXNvbi5yZWFzb25UZXh0ID09PSBcIlwiID8gXCIgLSBubyByZWFzb24gZ2l2ZW5cIiA6IFwiIC4gWW91IGRpc2FncmVlZCBiZWNhdXNlIHlvdSBzYWlkOiAnXCIgKyBsb2cucmVhc29uLnJlYXNvbiArIFwiOyBcIiArIGxvZy5yZWFzb24ucmVhc29uVGV4dCArIFwiLidcIjtcclxuICAgICAgbG9nVGV4dCA9IFwiWW91IGRpc2FncmVlZCB3aXRoIHRoaXMgYWN0aW9uIG9uIFwiICsgKG5ldyBEYXRlKCkpLnRvRGF0ZVN0cmluZygpICsgcmVhc29uVGV4dDtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoZG9uZSkge1xyXG4gICAgICBsb2dUZXh0ID0gXCJZb3UgYWdyZWVkIHdpdGggdGhpcyBzdWdnZXN0ZWQgYWN0aW9uIG9uIFwiICsgKG5ldyBEYXRlKCkpLnRvRGF0ZVN0cmluZygpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICghb2JqLmFjdGlvbnNbaWRdW2FjdGlvbklkXSkge1xyXG4gICAgICBvYmouYWN0aW9uc1tpZF1bYWN0aW9uSWRdID0ge1xyXG4gICAgICAgIFwiYWdyZWVcIjogYWdyZWUgPyBhZ3JlZSA6IGZhbHNlLFxyXG4gICAgICAgIFwiZG9uZVwiOiBkb25lID8gZG9uZSA6IGZhbHNlLFxyXG4gICAgICAgIFwiaGlzdG9yeVwiOiBbbG9nVGV4dF1cclxuICAgICAgfTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGlmIChhZ3JlZSA9PT0gdHJ1ZSB8fCBhZ3JlZSA9PT0gZmFsc2UpIG9iai5hY3Rpb25zW2lkXVthY3Rpb25JZF0uYWdyZWUgPSBhZ3JlZTtcclxuICAgICAgaWYgKGRvbmUgPT09IHRydWUgfHwgZG9uZSA9PT0gZmFsc2UpIG9iai5hY3Rpb25zW2lkXVthY3Rpb25JZF0uZG9uZSA9IGRvbmU7XHJcbiAgICAgIGlmIChsb2dUZXh0KSB7XHJcbiAgICAgICAgaWYgKG9iai5hY3Rpb25zW2lkXVthY3Rpb25JZF0uaGlzdG9yeSkgb2JqLmFjdGlvbnNbaWRdW2FjdGlvbklkXS5oaXN0b3J5LnVuc2hpZnQobG9nVGV4dCk7XHJcbiAgICAgICAgZWxzZSBvYmouYWN0aW9uc1tpZF1bYWN0aW9uSWRdLmRvbmUuaGlzdG9yeSA9IFtsb2dUZXh0XTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmIChyZWFzb24gJiYgb2JqLmFjdGlvbnNbaWRdW2FjdGlvbklkXS5hZ3JlZSA9PT0gZmFsc2UpIHtcclxuICAgICAgb2JqLmFjdGlvbnNbaWRdW2FjdGlvbklkXS5yZWFzb24gPSByZWFzb247XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBkZWxldGUgb2JqLmFjdGlvbnNbaWRdW2FjdGlvbklkXS5yZWFzb247XHJcbiAgICB9XHJcblxyXG4gICAgbG9nLnNldE9iaihvYmopO1xyXG4gICAgbm90aWZ5LnNob3dTYXZlZCgpO1xyXG4gIH0sXHJcblxyXG4gIGlnbm9yZUFjdGlvbjogZnVuY3Rpb24oaWQsIGFjdGlvbklkKSB7XHJcbiAgICB2YXIgb2JqID0gbG9nLmdldE9iaihbe1xyXG4gICAgICBuYW1lOiBcImFjdGlvbnNcIixcclxuICAgICAgdmFsdWU6IHt9XHJcbiAgICB9XSk7XHJcbiAgICBvYmouYWN0aW9uc1tpZF1bYWN0aW9uSWRdLmFncmVlID0gbnVsbDtcclxuICAgIGRlbGV0ZSBvYmouYWN0aW9uc1tpZF1bYWN0aW9uSWRdLnJlYXNvbjtcclxuICAgIGxvZy5zZXRPYmoob2JqKTtcclxuICB9LFxyXG5cclxuICBnZXRBY3Rpb25zOiBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiBsb2cuZ2V0T2JqKFt7XHJcbiAgICAgIG5hbWU6IFwiYWN0aW9uc1wiLFxyXG4gICAgICB2YWx1ZToge31cclxuICAgIH1dKS5hY3Rpb25zO1xyXG4gIH0sXHJcblxyXG4gIGxpc3RBY3Rpb25zOiBmdW5jdGlvbihpZCwgcGF0aHdheUlkKSB7XHJcbiAgICB2YXIgb2JqID0gbG9nLmdldE9iaihbe1xyXG4gICAgICBuYW1lOiBcImFjdGlvbnNcIixcclxuICAgICAgdmFsdWU6IHt9XHJcbiAgICB9XSk7XHJcbiAgICBhcnIgPSBbXTtcclxuICAgIGlmICghaWQpIHJldHVybiBvYmouYWN0aW9ucztcclxuICAgIGlmICghb2JqLmFjdGlvbnNbaWRdKSByZXR1cm4gYXJyO1xyXG4gICAgZm9yICh2YXIgcHJvcCBpbiBvYmouYWN0aW9uc1tpZF0pIHtcclxuICAgICAgb2JqLmFjdGlvbnNbaWRdW3Byb3BdLmlkID0gcHJvcDtcclxuICAgICAgaWYgKCFvYmouYWN0aW9uc1tpZF1bcHJvcF0udGV4dClcclxuICAgICAgICBhcnIucHVzaChvYmouYWN0aW9uc1tpZF1bcHJvcF0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFycjtcclxuICB9LFxyXG5cclxuICAvL2lkIGlzIGVpdGhlciBcInRlYW1cIiBvciB0aGUgcGF0aWVudElkXHJcbiAgcmVjb3JkRmVlZGJhY2s6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgaWQsIHN1Z2dlc3Rpb24sIHJlYXNvbiwgcmVhc29uVGV4dCkge1xyXG4gICAgbG9nLnJlYXNvbiA9IHtcclxuICAgICAgXCJyZWFzb25cIjogcmVhc29uLFxyXG4gICAgICBcInJlYXNvblRleHRcIjogcmVhc29uVGV4dFxyXG4gICAgfTtcclxuICAgIHZhciBvYmogPSBsb2cuZ2V0T2JqKFt7XHJcbiAgICAgIG5hbWU6IFwiZmVlZGJhY2tcIixcclxuICAgICAgdmFsdWU6IFtdXHJcbiAgICB9XSk7XHJcblxyXG4gICAgdmFyIGl0ZW0gPSB7XHJcbiAgICAgIFwicGF0aHdheUlkXCI6IHBhdGh3YXlJZCxcclxuICAgICAgXCJpZFwiOiBpZCxcclxuICAgICAgXCJ2YWxcIjogc3VnZ2VzdGlvblxyXG4gICAgfTtcclxuICAgIGlmIChyZWFzb25UZXh0ICE9PSBcIlwiKSBpdGVtLnJlYXNvblRleHQgPSByZWFzb25UZXh0O1xyXG4gICAgaWYgKHJlYXNvbiAhPT0gXCJcIikgaXRlbS5yZWFzb24gPSByZWFzb247XHJcbiAgICBvYmouZmVlZGJhY2sucHVzaChpdGVtKTtcclxuICAgIGxvZy5zZXRPYmoob2JqKTtcclxuICB9LFxyXG5cclxuICBnZXRFdmVudHM6IGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIGxvZy5nZXRPYmooW3tcclxuICAgICAgbmFtZTogXCJldmVudHNcIixcclxuICAgICAgdmFsdWU6IFtdXHJcbiAgICB9XSkuZXZlbnRzO1xyXG4gIH0sXHJcblxyXG4gIHJlY29yZEV2ZW50OiBmdW5jdGlvbihwYXRod2F5SWQsIGlkLCBuYW1lKSB7XHJcbiAgICB2YXIgb2JqID0gbG9nLmdldE9iaihbe1xyXG4gICAgICBuYW1lOiBcImV2ZW50c1wiLFxyXG4gICAgICB2YWx1ZTogW11cclxuICAgIH1dKTtcclxuICAgIG9iai5ldmVudHMucHVzaCh7XHJcbiAgICAgIFwicGF0aHdheUlkXCI6IHBhdGh3YXlJZCxcclxuICAgICAgXCJpZFwiOiBpZCxcclxuICAgICAgXCJuYW1lXCI6IG5hbWUsXHJcbiAgICAgIFwiZGF0ZVwiOiBuZXcgRGF0ZSgpXHJcbiAgICB9KTtcclxuICAgIGxvZy5zZXRPYmoob2JqKTtcclxuICB9LFxyXG5cclxuICByZWNvcmRQbGFuOiBmdW5jdGlvbihpZCwgdGV4dCwgcGF0aHdheUlkKSB7XHJcbiAgICBpZiAoIWlkKSBhbGVydChcIlBMQU5cIik7XHJcbiAgICB2YXIgb2JqID0gbG9nLmdldE9iaihbe1xyXG4gICAgICBuYW1lOiBcImFjdGlvbnNcIixcclxuICAgICAgdmFsdWU6IHt9XHJcbiAgICB9XSk7XHJcblxyXG4gICAgaWYgKCFvYmouYWN0aW9uc1tpZF0pIG9iai5hY3Rpb25zW2lkXSA9IHt9O1xyXG4gICAgdmFyIHBsYW5JZCA9IERhdGUubm93KCkgKyBcIlwiO1xyXG4gICAgb2JqLmFjdGlvbnNbaWRdW3BsYW5JZF0gPSB7XHJcbiAgICAgIFwidGV4dFwiOiB0ZXh0LFxyXG4gICAgICBcImFncmVlXCI6IG51bGwsXHJcbiAgICAgIFwiZG9uZVwiOiBmYWxzZSxcclxuICAgICAgXCJwYXRod2F5SWRcIjogcGF0aHdheUlkLFxyXG4gICAgICBcImhpc3RvcnlcIjogW1wiWW91IGFkZGVkIHRoaXMgb24gXCIgKyAobmV3IERhdGUoKSkudG9EYXRlU3RyaW5nKCldXHJcbiAgICB9O1xyXG5cclxuICAgIGxvZy5zZXRPYmoob2JqKTtcclxuICAgIHJldHVybiBwbGFuSWQ7XHJcbiAgfSxcclxuXHJcbiAgZmluZFBsYW46IGZ1bmN0aW9uKG9iaiwgcGxhbklkKSB7XHJcbiAgICBmb3IgKHZhciBrIGluIG9iai5hY3Rpb25zKSB7XHJcbiAgICAgIGlmIChvYmouYWN0aW9uc1trXVtwbGFuSWRdICYmIG9iai5hY3Rpb25zW2tdW3BsYW5JZF0udGV4dCkgcmV0dXJuIGs7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gLTE7XHJcbiAgfSxcclxuXHJcbiAgZWRpdFBsYW46IGZ1bmN0aW9uKHBsYW5JZCwgdGV4dCwgZG9uZSkge1xyXG4gICAgdmFyIG9iaiA9IGxvZy5nZXRPYmooW3tcclxuICAgICAgbmFtZTogXCJhY3Rpb25zXCIsXHJcbiAgICAgIHZhbHVlOiB7fVxyXG4gICAgfV0pO1xyXG4gICAgdmFyIGlkID0gbG9nLmZpbmRQbGFuKG9iaiwgcGxhbklkKTtcclxuICAgIGlmICh0ZXh0KSBvYmouYWN0aW9uc1tpZF1bcGxhbklkXS50ZXh0ID0gdGV4dDtcclxuICAgIGlmIChkb25lID09PSB0cnVlIHx8IGRvbmUgPT09IGZhbHNlKSBvYmouYWN0aW9uc1tpZF1bcGxhbklkXS5kb25lID0gZG9uZTtcclxuICAgIGxvZy5zZXRPYmoob2JqKTtcclxuICB9LFxyXG5cclxuICBkZWxldGVQbGFuOiBmdW5jdGlvbihwbGFuSWQpIHtcclxuICAgIHZhciBvYmogPSBsb2cuZ2V0T2JqKFt7XHJcbiAgICAgIG5hbWU6IFwiYWN0aW9uc1wiLFxyXG4gICAgICB2YWx1ZToge31cclxuICAgIH1dKTtcclxuICAgIHZhciBpZCA9IGxvZy5maW5kUGxhbihvYmosIHBsYW5JZCk7XHJcbiAgICBkZWxldGUgb2JqLmFjdGlvbnNbaWRdW3BsYW5JZF07XHJcbiAgICBsb2cuc2V0T2JqKG9iaik7XHJcbiAgfSxcclxuXHJcbiAgbGlzdFBsYW5zOiBmdW5jdGlvbihpZCwgcGF0aHdheUlkKSB7XHJcbiAgICB2YXIgb2JqID0gbG9nLmdldE9iaihbe1xyXG4gICAgICAgIG5hbWU6IFwiYWN0aW9uc1wiLFxyXG4gICAgICAgIHZhbHVlOiB7fVxyXG4gICAgICB9XSksXHJcbiAgICAgIGFyciA9IFtdO1xyXG4gICAgaWYgKCFpZCkgcmV0dXJuIG9iai5hY3Rpb25zO1xyXG4gICAgZm9yICh2YXIgcHJvcCBpbiBvYmouYWN0aW9uc1tpZF0pIHtcclxuICAgICAgb2JqLmFjdGlvbnNbaWRdW3Byb3BdLmlkID0gcHJvcDtcclxuICAgICAgaWYgKCghcGF0aHdheUlkIHx8IHBhdGh3YXlJZCA9PT0gb2JqLmFjdGlvbnNbaWRdW3Byb3BdLnBhdGh3YXlJZCkgJiYgb2JqLmFjdGlvbnNbaWRdW3Byb3BdLnRleHQpIGFyci5wdXNoKG9iai5hY3Rpb25zW2lkXVtwcm9wXSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYXJyO1xyXG4gIH0sXHJcblxyXG4gIGdldFJlYXNvbjogZnVuY3Rpb24oaWQsIGFjdGlvbklkKSB7XHJcbiAgICB2YXIgb2JqID0gbG9nLmdldE9iaihbe1xyXG4gICAgICBuYW1lOiBcImFjdGlvbnNcIixcclxuICAgICAgdmFsdWU6IHt9XHJcbiAgICB9XSk7XHJcblxyXG4gICAgaWYgKG9iai5hY3Rpb25zW2lkXSAmJiBvYmouYWN0aW9uc1tpZF1bYWN0aW9uSWRdKSByZXR1cm4gb2JqLmFjdGlvbnNbaWRdW2FjdGlvbklkXS5yZWFzb247XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9LFxyXG5cclxuICBnZXRBZ3JlZVJlYXNvbjogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQsIGl0ZW0pIHtcclxuICAgIHZhciBvYmogPSBsb2cuZ2V0T2JqKFt7XHJcbiAgICAgIG5hbWU6IFwiYWdyZWVzXCIsXHJcbiAgICAgIHZhbHVlOiB7fVxyXG4gICAgfV0pO1xyXG4gICAgaWYgKCFwYXRod2F5SWQgfHwgIXBhdGh3YXlTdGFnZSkgYWxlcnQoXCJFRElUUEFUSUVOVEFHUkVFXCIpO1xyXG5cclxuICAgIGlmICghb2JqLmFncmVlc1twYXRpZW50SWRdKSBvYmouYWdyZWVzW3BhdGllbnRJZF0gPSBbXTtcclxuICAgIHZhciBpdGVtcyA9IG9iai5hZ3JlZXNbcGF0aWVudElkXS5maWx0ZXIoZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgIHJldHVybiB2YWwucGF0aHdheUlkID09PSBwYXRod2F5SWQgJiYgdmFsLnBhdGh3YXlTdGFnZSA9PT0gcGF0aHdheVN0YWdlICYmIHZhbC5zdGFuZGFyZCA9PT0gc3RhbmRhcmQgJiYgdmFsLml0ZW0gPT09IGl0ZW07XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gaXRlbXMubGVuZ3RoID09PSAxID8gaXRlbXNbMF0ucmVhc29uIHx8IHt9IDoge307XHJcbiAgfSxcclxuXHJcbiAgZWRpdFBhdGllbnRBZ3JlZTogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQsIGl0ZW0sIGFncmVlLCByZWFzb24pIHtcclxuICAgIHZhciBvYmogPSBsb2cuZ2V0T2JqKCk7XHJcbiAgICBpZiAoIXBhdGh3YXlJZCB8fCAhcGF0aHdheVN0YWdlKSBhbGVydChcIkVESVRQQVRJRU5UQUdSRUVcIik7XHJcblxyXG4gICAgaWYgKCFvYmouYWdyZWVzW3BhdGllbnRJZF0pIG9iai5hZ3JlZXNbcGF0aWVudElkXSA9IFtdO1xyXG4gICAgdmFyIGl0ZW1zID0gb2JqLmFncmVlc1twYXRpZW50SWRdLmZpbHRlcihmdW5jdGlvbih2YWwpIHtcclxuICAgICAgcmV0dXJuIHZhbC5wYXRod2F5SWQgPT09IHBhdGh3YXlJZCAmJiB2YWwucGF0aHdheVN0YWdlID09PSBwYXRod2F5U3RhZ2UgJiYgdmFsLnN0YW5kYXJkID09PSBzdGFuZGFyZCAmJiB2YWwuaXRlbSA9PT0gaXRlbTtcclxuICAgIH0pO1xyXG5cclxuICAgIHZhciBsb2dUZXh0ID0gXCJZb3UgXCIgKyAoYWdyZWUgPyBcIlwiIDogXCJkaXNcIikgKyBcImFncmVlZCB3aXRoIHRoaXMgb24gXCIgKyAobmV3IERhdGUoKSkudG9EYXRlU3RyaW5nKCk7XHJcblxyXG4gICAgaWYgKGl0ZW1zLmxlbmd0aCA9PT0gMSkge1xyXG4gICAgICBpdGVtc1swXS5hZ3JlZSA9IGFncmVlO1xyXG4gICAgICBpdGVtc1swXS5oaXN0b3J5LnB1c2gobG9nVGV4dCk7XHJcbiAgICAgIGl0ZW1zWzBdLnJlYXNvbiA9IHJlYXNvbjtcclxuICAgIH0gZWxzZSBpZiAoaXRlbXMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIG9iai5hZ3JlZXNbcGF0aWVudElkXS5wdXNoKHtcclxuICAgICAgICBcInBhdGh3YXlJZFwiOiBwYXRod2F5SWQsXHJcbiAgICAgICAgXCJwYXRod2F5U3RhZ2VcIjogcGF0aHdheVN0YWdlLFxyXG4gICAgICAgIFwic3RhbmRhcmRcIjogc3RhbmRhcmQsXHJcbiAgICAgICAgXCJpdGVtXCI6IGl0ZW0sXHJcbiAgICAgICAgXCJhZ3JlZVwiOiBhZ3JlZSxcclxuICAgICAgICBcInJlYXNvblwiOiByZWFzb24sXHJcbiAgICAgICAgXCJoaXN0b3J5XCI6IFtsb2dUZXh0XVxyXG4gICAgICB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKFwiRVJST1JSUiEhISEhISFcIik7XHJcbiAgICB9XHJcblxyXG4gICAgbG9nLnNldE9iaihvYmopO1xyXG4gICAgbm90aWZ5LnNob3dTYXZlZCgpO1xyXG4gIH0sXHJcblxyXG4gIGdldEFncmVlczogZnVuY3Rpb24oKXtcclxuICAgIHJldHVybiBsb2cuZ2V0T2JqKFt7XHJcbiAgICAgIG5hbWU6IFwiYWdyZWVzXCIsXHJcbiAgICAgIHZhbHVlOiB7fVxyXG4gICAgfV0pLmFncmVlcztcclxuICB9LFxyXG5cclxuICBnZXRQYXRpZW50QWdyZWVPYmplY3Q6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkLCBpdGVtKSB7XHJcbiAgICB2YXIgb2JqID0gbG9nLmdldE9iaihbe1xyXG4gICAgICBuYW1lOiBcImFncmVlc1wiLFxyXG4gICAgICB2YWx1ZToge31cclxuICAgIH1dKTtcclxuICAgIGlmICghcGF0aHdheUlkIHx8ICFwYXRod2F5U3RhZ2UpIGFsZXJ0KFwiRURJVFBBVElFTlRBR1JFRVwiKTtcclxuXHJcbiAgICBpZiAoIW9iai5hZ3JlZXNbcGF0aWVudElkXSkgb2JqLmFncmVlc1twYXRpZW50SWRdID0gW107XHJcbiAgICB2YXIgaXRlbXMgPSBvYmouYWdyZWVzW3BhdGllbnRJZF0uZmlsdGVyKGZ1bmN0aW9uKHZhbCkge1xyXG4gICAgICByZXR1cm4gdmFsLnBhdGh3YXlJZCA9PT0gcGF0aHdheUlkICYmIHZhbC5wYXRod2F5U3RhZ2UgPT09IHBhdGh3YXlTdGFnZSAmJiB2YWwuc3RhbmRhcmQgPT09IHN0YW5kYXJkICYmIHZhbC5pdGVtID09PSBpdGVtO1xyXG4gICAgfSk7XHJcbiAgICBpZiAoaXRlbXMubGVuZ3RoID09PSAxKSByZXR1cm4gaXRlbXNbMF07XHJcbiAgICByZXR1cm4ge307XHJcbiAgfSxcclxuXHJcbiAgZ2V0UGF0aWVudEFncmVlOiBmdW5jdGlvbihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCwgaXRlbSkge1xyXG4gICAgdmFyIG9iaiA9IGxvZy5nZXRPYmooW3tcclxuICAgICAgbmFtZTogXCJhZ3JlZXNcIixcclxuICAgICAgdmFsdWU6IHt9XHJcbiAgICB9XSk7XHJcblxyXG4gICAgaWYgKCFvYmouYWdyZWVzW3BhdGllbnRJZF0pIHJldHVybiBudWxsO1xyXG4gICAgdmFyIGl0ZW0yID0gb2JqLmFncmVlc1twYXRpZW50SWRdLmZpbHRlcihmdW5jdGlvbih2YWwpIHtcclxuICAgICAgcmV0dXJuIHZhbC5wYXRod2F5SWQgPT09IHBhdGh3YXlJZCAmJiB2YWwucGF0aHdheVN0YWdlID09PSBwYXRod2F5U3RhZ2UgJiYgdmFsLnN0YW5kYXJkID09PSBzdGFuZGFyZCAmJiB2YWwuaXRlbSA9PT0gaXRlbTtcclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChpdGVtLmxlbmd0aCA9PT0gMSkge1xyXG4gICAgICByZXR1cm4gaXRlbVswXS5hZ3JlZTtcclxuICAgIH1cclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGxvZztcclxuIiwibW9kdWxlLmV4cG9ydHMgPSB7XHJcbiAgXCJjdXJyZW50VXJsXCI6IFwiXCIsXHJcbiAgXCJvcHRpb25zXCI6IFtdLFxyXG4gIFwiY2F0ZWdvcmllc1wiOiB7XHJcbiAgICBcImRpYWdub3Npc1wiOiB7XHJcbiAgICAgIFwibmFtZVwiOiBcImRpYWdub3Npc1wiLFxyXG4gICAgICBcImRpc3BsYXlcIjogXCJEaWFnbm9zaXNcIlxyXG4gICAgfSxcclxuICAgIFwibW9uaXRvcmluZ1wiOiB7XHJcbiAgICAgIFwibmFtZVwiOiBcIm1vbml0b3JpbmdcIixcclxuICAgICAgXCJkaXNwbGF5XCI6IFwiTW9uaXRvcmluZ1wiXHJcbiAgICB9LFxyXG4gICAgXCJ0cmVhdG1lbnRcIjoge1xyXG4gICAgICBcIm5hbWVcIjogXCJ0cmVhdG1lbnRcIixcclxuICAgICAgXCJkaXNwbGF5XCI6IFwiQ29udHJvbFwiXHJcbiAgICB9LFxyXG4gICAgXCJleGNsdXNpb25zXCI6IHtcclxuICAgICAgXCJuYW1lXCI6IFwiZXhjbHVzaW9uc1wiLFxyXG4gICAgICBcImRpc3BsYXlcIjogXCJFeGNsdXNpb25zXCJcclxuICAgIH1cclxuICB9LFxyXG4gIFwiY2hhcnRzXCI6IHt9LFxyXG4gIFwicGF0aHdheUlkXCI6IFwiaHRuXCIsXHJcbiAgXCJjb2xvcnNcIjogWycjMWY3N2I0JywgJyNmZjdmMGUnLCAnIzJjYTAyYycsICcjZDYyNzI4JywgJyM5NDY3YmQnLCAnIzhjNTY0YicsICcjZTM3N2MyJywgJyM3ZjdmN2YnLCAnI2JjYmQyMicsICcjMTdiZWNmJ10sXHJcbiAgXCJtb25pdG9yZWRcIjoge1xyXG4gICAgXCJicFwiOiBcIkJsb29kIFByZXNzdXJlXCIsXHJcbiAgICBcImFzdGhtYVwiOiBcIlBlYWsgRXhwaXJhdG9yeSBGbG93XCJcclxuICB9XHJcbn07XHJcbiIsInZhciB0ZW1wbGF0ZSA9IHJlcXVpcmUoJy4vdGVtcGxhdGUuanMnKSxcclxuICBkYXRhID0gcmVxdWlyZSgnLi9kYXRhLmpzJyksXHJcbiAgYmFzZSA9IHJlcXVpcmUoJy4vYmFzZS5qcycpLFxyXG4gIGxheW91dCA9IHJlcXVpcmUoJy4vbGF5b3V0LmpzJyksXHJcbiAgd2VsY29tZSA9IHJlcXVpcmUoJy4vcGFuZWxzL3dlbGNvbWUuanMnKSxcclxuICBsb2cgPSByZXF1aXJlKCcuL2xvZy5qcycpLFxyXG4gIHBhdGllbnRWaWV3ID0gcmVxdWlyZSgnLi92aWV3cy9wYXRpZW50LmpzJyksXHJcbiAgTXVzdGFjaGUgPSByZXF1aXJlKCdtdXN0YWNoZScpO1xyXG5cclxudmFyIHN0YXRlcywgcGF0TG9va3VwLCBwYWdlLCBoYXNoO1xyXG5cclxuY29uc29sZS5sb2coXCJtYWluLmpzOiBkYXRhLmxhc3Rsb2FkZXI9IFwiICsgZGF0YS5sYXN0bG9hZGVyKTtcclxuZGF0YS5sYXN0bG9hZGVyID0gXCJtYWluLmpzXCI7XHJcblxyXG52YXIgbWFpbiA9IHtcclxuICBcInZlcnNpb25cIjogXCIyLjAuMFwiLFxyXG5cclxuICBoYXNoOiBoYXNoLFxyXG4gIGluaXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgbWFpbi5wcmVXaXJlVXBQYWdlcygpO1xyXG5cclxuICAgIGxvZy5sb2FkQWN0aW9ucyhmdW5jdGlvbigpIHtcclxuICAgICAgZGF0YS5nZXQobWFpbi53aXJlVXBQYWdlcyk7XHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICBvblNlbGVjdGVkOiBmdW5jdGlvbigkZSwgbmhzTnVtYmVyT2JqZWN0KSB7XHJcbiAgICAvL0hpZGUgdGhlIHN1Z2dlc3Rpb25zIHBhbmVsXHJcbiAgICAkKCcjc2VhcmNoLWJveCcpLmZpbmQoJy50dC1kcm9wZG93bi1tZW51JykuY3NzKCdkaXNwbGF5JywgJ25vbmUnKTtcclxuXHJcbiAgICBoaXN0b3J5LnB1c2hTdGF0ZShudWxsLCBudWxsLCAnI3BhdGllbnRzLycgKyBuaHNOdW1iZXJPYmplY3QuaWQpO1xyXG4gICAgdGVtcGxhdGUubG9hZENvbnRlbnQoJyNwYXRpZW50cy8nICsgbmhzTnVtYmVyT2JqZWN0LmlkLCB0cnVlKTtcclxuXHJcblxyXG4gICAgLy90ZW1wbGF0ZS5kaXNwbGF5U2VsZWN0ZWRQYXRpZW50KG5oc051bWJlck9iamVjdC5pZCk7XHJcbiAgfSxcclxuXHJcbiAgd2lyZVVwU2VhcmNoQm94OiBmdW5jdGlvbigpIHtcclxuICAgIGlmIChzdGF0ZXMpIHtcclxuICAgICAgc3RhdGVzLmNsZWFyUHJlZmV0Y2hDYWNoZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXRlcyA9IG5ldyBCbG9vZGhvdW5kKHtcclxuICAgICAgZGF0dW1Ub2tlbml6ZXI6IEJsb29kaG91bmQudG9rZW5pemVycy5vYmoud2hpdGVzcGFjZSgndmFsdWUnKSxcclxuICAgICAgcXVlcnlUb2tlbml6ZXI6IEJsb29kaG91bmQudG9rZW5pemVycy53aGl0ZXNwYWNlLFxyXG4gICAgICBsb2NhbDogJC5tYXAoZGF0YS5wYXRpZW50QXJyYXksIGZ1bmN0aW9uKHN0YXRlKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgIGlkOiBzdGF0ZSxcclxuICAgICAgICAgIHZhbHVlOiBkYXRhLnBhdExvb2t1cCAmJiBkYXRhLnBhdExvb2t1cFtzdGF0ZV0gPyBkYXRhLnBhdExvb2t1cFtzdGF0ZV0gOiBzdGF0ZVxyXG4gICAgICAgIH07XHJcbiAgICAgIH0pXHJcbiAgICB9KTtcclxuXHJcbiAgICBzdGF0ZXMuaW5pdGlhbGl6ZSh0cnVlKTtcclxuXHJcbiAgICAkKCcjc2VhcmNoLWJveCcpLmZpbmQoJy50eXBlYWhlYWQnKS50eXBlYWhlYWQoJ2Rlc3Ryb3knKTtcclxuICAgICQoJyNzZWFyY2gtYm94JykuZmluZCgnLnR5cGVhaGVhZCcpLnR5cGVhaGVhZCh7XHJcbiAgICAgICAgaGludDogdHJ1ZSxcclxuICAgICAgICBoaWdobGlnaHQ6IHRydWUsXHJcbiAgICAgICAgbWluTGVuZ3RoOiAxLFxyXG4gICAgICAgIGF1dG9zZWxlY3Q6IHRydWVcclxuICAgICAgfSwge1xyXG4gICAgICAgIG5hbWU6ICdwYXRpZW50cycsXHJcbiAgICAgICAgZGlzcGxheUtleTogJ3ZhbHVlJyxcclxuICAgICAgICBzb3VyY2U6IHN0YXRlcy50dEFkYXB0ZXIoKSxcclxuICAgICAgICB0ZW1wbGF0ZXM6IHtcclxuICAgICAgICAgIGVtcHR5OiBbXHJcbiAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJlbXB0eS1tZXNzYWdlXCI+JyxcclxuICAgICAgICAgICAgICAgICcmbmJzcDsgJm5ic3A7IE5vIG1hdGNoZXMnLFxyXG4gICAgICAgICAgICAgICc8L2Rpdj4nXHJcbiAgICAgICAgICAgIF0uam9pbignXFxuJylcclxuICAgICAgICB9XHJcbiAgICAgIH0pLm9uKCd0eXBlYWhlYWQ6c2VsZWN0ZWQnLCBtYWluLm9uU2VsZWN0ZWQpXHJcbiAgICAgIC5vbigndHlwZWFoZWFkOmF1dG9jb21wbGV0ZWQnLCBtYWluLm9uU2VsZWN0ZWQpO1xyXG5cclxuICAgICQoJyNzZWFyY2hidG4nKS5vbignbW91c2Vkb3duJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciB2YWwgPSAkKCcudHlwZWFoZWFkJykuZXEoMCkudmFsKCk7XHJcbiAgICAgIGlmICghdmFsIHx8IHZhbCA9PT0gXCJcIikgdmFsID0gJCgnLnR5cGVhaGVhZCcpLmVxKDEpLnZhbCgpO1xyXG4gICAgICBtYWluLm9uU2VsZWN0ZWQobnVsbCwge1xyXG4gICAgICAgIFwiaWRcIjogdmFsXHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfSxcclxuXHJcbiAgd2lyZVVwUGFnZXM6IGZ1bmN0aW9uKCkge1xyXG4gICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgbWFpbi53aXJlVXBTZWFyY2hCb3goKTtcclxuXHJcbiAgICAkKCcjZGF0YS1maWxlJykub24oJ2NoYW5nZScsIGZ1bmN0aW9uKGV2dCkge1xyXG4gICAgICAkKCcjZGF0YS1maWxlLXdyYXBwZXInKS5hZGRDbGFzcygnZGlzYWJsZWQnKS50ZXh0KFwiTG9hZGluZy4uLlwiKTtcclxuICAgICAgdmFyIGZpbGUgPSBldnQudGFyZ2V0LmZpbGVzWzBdOyAvLyBGaWxlTGlzdCBvYmplY3RcclxuICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XHJcblxyXG4gICAgICByZWFkZXIub25sb2FkID0gKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICB2YXIgSnNvbk9iaiA9IEpTT04ucGFyc2UoZS50YXJnZXQucmVzdWx0KTtcclxuICAgICAgICAgIGRhdGEuZ2V0KG51bGwsIEpzb25PYmopO1xyXG4gICAgICAgICAgY29uc29sZS5sb2coSnNvbk9iaik7XHJcblxyXG4gICAgICAgICAgbWFpbi53aXJlVXBTZWFyY2hCb3goKTtcclxuXHJcbiAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAoISQoJyNwYXRpZW50LWZpbGUtd3JhcHBlcicpLmlzKCc6dmlzaWJsZScpKSB7XHJcbiAgICAgICAgICAgICAgJCgnI2ZpbGUtbG9hZGVyJykuaGlkZSg1MDApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICQoJyNkYXRhLWZpbGUtd3JhcHBlcicpLmhpZGUoNTAwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0ZW1wbGF0ZS5sb2FkQ29udGVudCgnI292ZXJ2aWV3Jyk7XHJcbiAgICAgICAgICB9LCAxMDAwKTtcclxuICAgICAgICB9O1xyXG4gICAgICB9KShmaWxlKTtcclxuXHJcbiAgICAgIHJlYWRlci5yZWFkQXNUZXh0KGZpbGUpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgJCgnI3BhdGllbnQtZmlsZScpLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbihldnQpIHtcclxuICAgICAgJCgnI3BhdGllbnQtZmlsZS13cmFwcGVyJykuYWRkQ2xhc3MoJ2Rpc2FibGVkJykudGV4dChcIkxvYWRpbmcuLi5cIik7XHJcbiAgICAgIHZhciBmaWxlID0gZXZ0LnRhcmdldC5maWxlc1swXTsgLy8gRmlsZUxpc3Qgb2JqZWN0XHJcbiAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xyXG5cclxuICAgICAgcmVhZGVyLm9ubG9hZCA9IChmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgdmFyIGxpbmVzID0gZS50YXJnZXQucmVzdWx0LnNwbGl0KFwiXFxuXCIpO1xyXG4gICAgICAgICAgZGF0YS5wYXRMb29rdXAgPSB7fTtcclxuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIGZpZWxkcyA9IGxpbmVzW2ldLnNwbGl0KFwiXFx0XCIpO1xyXG4gICAgICAgICAgICBpZiAoZmllbGRzLmxlbmd0aCAhPT0gMikgY29udGludWU7XHJcbiAgICAgICAgICAgIGRhdGEucGF0TG9va3VwW2ZpZWxkc1swXS50cmltKCldID0gZmllbGRzWzFdLnRyaW0oKTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBtYWluLndpcmVVcFNlYXJjaEJveCgpO1xyXG5cclxuICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmICghJCgnI2RhdGEtZmlsZS13cmFwcGVyJykuaXMoJzp2aXNpYmxlJykpIHtcclxuICAgICAgICAgICAgICAkKCcjZmlsZS1sb2FkZXInKS5oaWRlKDUwMCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgJCgnI3BhdGllbnQtZmlsZS13cmFwcGVyJykuaGlkZSg1MDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRlbXBsYXRlLmxvYWRDb250ZW50KCcjb3ZlcnZpZXcnKTtcclxuICAgICAgICAgIH0sIDEwMDApO1xyXG4gICAgICAgIH07XHJcbiAgICAgIH0pKGZpbGUpO1xyXG5cclxuICAgICAgcmVhZGVyLnJlYWRBc1RleHQoZmlsZSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAkKCcjb3V0c3RhbmRpbmdUYXNrcycpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgJCgnI3dlbGNvbWUtdGFicyBsaScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgJCh0aGlzKS5jbG9zZXN0KCdsaScpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgdmFyIHRlbXBNdXN0ID0gJCgnI3dlbGNvbWUtdGFzay1saXN0JykuaHRtbCgpO1xyXG4gICAgICB2YXIgcmVuZGVyZWQgPSBNdXN0YWNoZS5yZW5kZXIodGVtcE11c3QpO1xyXG4gICAgICAkKCcjd2VsY29tZS10YWItY29udGVudCcpLmZhZGVPdXQoMTAwLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAkKHRoaXMpLmh0bWwocmVuZGVyZWQpO1xyXG4gICAgICAgIHdlbGNvbWUucG9wdWxhdGUoKTtcclxuICAgICAgICAkKHRoaXMpLmZhZGVJbigxMDApO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgICQoJyNjb21wbGV0ZWRUYXNrcycpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgJCgnI3dlbGNvbWUtdGFicyBsaScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgJCh0aGlzKS5jbG9zZXN0KCdsaScpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgdmFyIHRlbXBNdXN0ID0gJCgnI3dlbGNvbWUtdGFzay1saXN0JykuaHRtbCgpO1xyXG4gICAgICB2YXIgcmVuZGVyZWQgPSBNdXN0YWNoZS5yZW5kZXIodGVtcE11c3QpO1xyXG4gICAgICAkKCcjd2VsY29tZS10YWItY29udGVudCcpLmZhZGVPdXQoMTAwLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAkKHRoaXMpLmh0bWwocmVuZGVyZWQpO1xyXG4gICAgICAgIHdlbGNvbWUucG9wdWxhdGUodHJ1ZSk7XHJcbiAgICAgICAgJCh0aGlzKS5mYWRlSW4oMTAwKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpZiAobWFpbi5oYXNoICE9PSBsb2NhdGlvbi5oYXNoKSBsb2NhdGlvbi5oYXNoID0gbWFpbi5oYXNoO1xyXG4gICAgdGVtcGxhdGUubG9hZENvbnRlbnQobG9jYXRpb24uaGFzaCwgdHJ1ZSk7XHJcbiAgfSxcclxuXHJcbiAgcHJlV2lyZVVwUGFnZXM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICBsYXlvdXQuc2hvd1BhZ2UoJ2xvZ2luJyk7XHJcblxyXG4gICAgICAvL0V2ZXJ5IGxpbmsgZWxlbWVudCBzdG9yZXMgaHJlZiBpbiBoaXN0b3J5XHJcbiAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICdhLmhpc3RvcnknLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAvLyBrZWVwIHRoZSBsaW5rIGluIHRoZSBicm93c2VyIGhpc3RvcnlcclxuICAgICAgICBoaXN0b3J5LnB1c2hTdGF0ZShudWxsLCBudWxsLCB0aGlzLmhyZWYpO1xyXG4gICAgICAgIHRlbXBsYXRlLmxvYWRDb250ZW50KGxvY2F0aW9uLmhhc2gsIHRydWUpO1xyXG4gICAgICAgIC8vIGRvIG5vdCBnaXZlIGEgZGVmYXVsdCBhY3Rpb25cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy9DYWxsZWQgd2hlbiB0aGUgYmFjayBidXR0b24gaXMgaGl0XHJcbiAgICAgICQod2luZG93KS5vbigncG9wc3RhdGUnLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgdGVtcGxhdGUubG9hZENvbnRlbnQobG9jYXRpb24uaGFzaCwgdHJ1ZSk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy9UZW1wbGF0ZXNcclxuICAgICAgcGF0aWVudHNQYW5lbFRlbXBsYXRlID0gJCgnI3BhdGllbnRzLXBhbmVsJyk7XHJcbiAgICAgIGFjdGlvblBsYW5QYW5lbCA9ICQoJyNhY3Rpb24tcGxhbi1wYW5lbCcpO1xyXG4gICAgICBwYXRpZW50TGlzdCA9ICQoJyNwYXRpZW50LWxpc3QnKTtcclxuICAgICAgc3VnZ2VzdGVkUGxhblRlbXBsYXRlID0gJCgnI3N1Z2dlc3RlZC1wbGFuLXRlbXBsYXRlJyk7XHJcbiAgICAgIGluZGl2aWR1YWxQYW5lbCA9ICQoJyNpbmRpdmlkdWFsLXBhbmVsJyk7XHJcbiAgICAgIHZhbHVlVHJlbmRQYW5lbCA9ICQoJyN2YWx1ZS10cmVuZC1wYW5lbCcpO1xyXG4gICAgICBtZWRpY2F0aW9uUGFuZWwgPSAkKCcjbWVkaWNhdGlvbnMtcGFuZWwnKTtcclxuICAgICAgYWN0aW9uUGxhbkxpc3QgPSAkKCcjYWN0aW9uLXBsYW4tbGlzdCcpO1xyXG5cclxuICAgICAgLy9TZWxlY3RvcnNcclxuICAgICAgYm90dG9tTGVmdFBhbmVsID0gJCgnI2JvdHRvbS1sZWZ0LXBhbmVsJyk7XHJcbiAgICAgIGJvdHRvbVJpZ2h0UGFuZWwgPSAkKCcjYm90dG9tLXJpZ2h0LXBhbmVsJyk7XHJcbiAgICAgIHRvcFBhbmVsID0gJCgnI3RvcC1wYW5lbCcpO1xyXG4gICAgICB0b3BMZWZ0UGFuZWwgPSAkKCcjdG9wLWxlZnQtcGFuZWwnKTtcclxuICAgICAgdG9wUmlnaHRQYW5lbCA9ICQoJyN0b3AtcmlnaHQtcGFuZWwnKTtcclxuICAgICAgbWlkUGFuZWwgPSAkKCcjbWlkLXBhbmVsJyk7XHJcbiAgICAgIGZhckxlZnRQYW5lbCA9ICQoJyNsZWZ0LXBhbmVsJyk7XHJcbiAgICAgIGZhclJpZ2h0UGFuZWwgPSAkKCcjcmlnaHQtcGFuZWwnKTtcclxuICAgIH1cclxuICAgIC8qLFxyXG4gICAgICBcIl9sb2NhbFwiOiBsb2NhbCovXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IG1haW47XHJcbiIsIm1vZHVsZS5leHBvcnRzID0ge1xyXG5cclxuICBzaG93U2F2ZWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgJChcIiNzYXZlZC1tZXNzYWdlXCIpLmhpZGUoKS50b2dnbGVDbGFzcyhcImluXCIpLmZhZGVJbigzMDApO1xyXG4gICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICQoXCIjc2F2ZWQtbWVzc2FnZVwiKS5mYWRlT3V0KDMwMCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgJCh0aGlzKS50b2dnbGVDbGFzcyhcImluXCIpO1xyXG4gICAgICB9KTtcclxuICAgIH0sIDIwMDApO1xyXG4gIH1cclxuXHJcbn07XHJcbiIsInZhciBiYXNlID0gcmVxdWlyZSgnLi4vYmFzZS5qcycpLFxyXG4gIGRhdGEgPSByZXF1aXJlKCcuLi9kYXRhLmpzJyksXHJcbiAgcXVhbGl0eVN0YW5kYXJkID0gcmVxdWlyZSgnLi9xdWFsaXR5U3RhbmRhcmQuanMnKSxcclxuICBvdGhlckNvZGVzID0gcmVxdWlyZSgnLi9vdGhlckNvZGVzLmpzJyksXHJcbiAgbWVkaWNhdGlvbiA9IHJlcXVpcmUoJy4vbWVkaWNhdGlvbi5qcycpLFxyXG4gIHRyZW5kID0gcmVxdWlyZSgnLi90cmVuZC5qcycpLFxyXG4gIGluZGl2aWR1YWxBY3Rpb25QbGFuID0gcmVxdWlyZSgnLi9pbmRpdmlkdWFsQWN0aW9uUGxhbi5qcycpLFxyXG4gIGxheW91dCA9IHJlcXVpcmUoJy4uL2xheW91dC5qcycpLFxyXG4gIGNoYXJ0ID0gcmVxdWlyZSgnLi4vY2hhcnQuanMnKSxcclxuICBNdXN0YWNoZSA9IHJlcXVpcmUoJ211c3RhY2hlJyk7XHJcblxyXG52YXIgYWxsID0ge1xyXG5cclxuICBwb3B1bGF0ZTogZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgcGF0aWVudHMgPSBkYXRhLmdldEFsbFBhdGllbnRzKCk7XHJcblxyXG4gICAgdmFyIGxvY2FsRGF0YSA9IHtcclxuICAgICAgXCJwYXRpZW50c1wiOiBwYXRpZW50cyxcclxuICAgICAgXCJuXCI6IHBhdGllbnRzLmxlbmd0aCxcclxuICAgICAgXCJoZWFkZXItaXRlbXNcIjogW3tcclxuICAgICAgICBcInRpdGxlXCI6IFwiTkhTIG5vLlwiLFxyXG4gICAgICAgIFwiaXNVblNvcnRhYmxlXCI6IHRydWVcclxuICAgICAgfSwge1xyXG4gICAgICAgIFwidGl0bGVcIjogXCJBbGwgT3Bwb3J0dW5pdGllc1wiLFxyXG4gICAgICAgIFwidGl0bGVIVE1MXCI6ICcjIG9mIDxpIGNsYXNzPVwiZmEgZmEtZmxhZ1wiIHN0eWxlPVwiY29sb3I6cmVkXCI+PC9pPicsXHJcbiAgICAgICAgXCJpc1VuU29ydGFibGVcIjogdHJ1ZSxcclxuICAgICAgICBcInRvb2x0aXBcIjogXCJUb3RhbCBudW1iZXIgb2YgaW1wcm92ZW1lbnQgb3Bwb3J0dW5pdGllcyBhdmFpbGFibGUgYWNyb3NzIGFsbCBjb25kaXRpb25zXCJcclxuICAgICAgfV1cclxuICAgIH07XHJcblxyXG4gICAgbG9jYWxEYXRhLnBhdGllbnRzLnNvcnQoZnVuY3Rpb24oYSwgYikge1xyXG4gICAgICBpZiAoYS5pdGVtc1swXSA9PT0gYi5pdGVtc1swXSkge1xyXG4gICAgICAgIHJldHVybiAwO1xyXG4gICAgICB9XHJcbiAgICAgIHZhciBBID0gTnVtYmVyKGEuaXRlbXNbMF0pO1xyXG4gICAgICB2YXIgQiA9IE51bWJlcihiLml0ZW1zWzBdKTtcclxuICAgICAgaWYgKGlzTmFOKEEpIHx8IGlzTmFOKEIpKSB7XHJcbiAgICAgICAgQSA9IGEuaXRlbXNbMF07XHJcbiAgICAgICAgQiA9IGIuaXRlbXNbMF07XHJcbiAgICAgIH1cclxuICAgICAgaWYgKEEgPiBCKSB7XHJcbiAgICAgICAgcmV0dXJuIC0xO1xyXG4gICAgICB9IGVsc2UgaWYgKEEgPCBCKSB7XHJcbiAgICAgICAgcmV0dXJuIDE7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGJhc2UuY3JlYXRlUGFuZWxTaG93KHBhdGllbnRMaXN0LCBwYXRpZW50c1BhbmVsLCBsb2NhbERhdGEsIHtcclxuICAgICAgXCJoZWFkZXItaXRlbVwiOiAkKFwiI3BhdGllbnQtbGlzdC1oZWFkZXItaXRlbVwiKS5odG1sKCksXHJcbiAgICAgIFwiaXRlbVwiOiAkKCcjcGF0aWVudC1saXN0LWl0ZW0nKS5odG1sKClcclxuICAgIH0pO1xyXG5cclxuICAgICQoJyNwYXRpZW50cy1wbGFjZWhvbGRlcicpLmhpZGUoKTtcclxuXHJcbiAgICBiYXNlLnNldHVwQ2xpcGJvYXJkKCQoJy5idG4tY29weScpLCB0cnVlKTtcclxuXHJcbiAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcblxyXG4gICAgdmFyIGMgPSBwYXRpZW50c1BhbmVsLmZpbmQoJ2Rpdi50YWJsZS1zY3JvbGwnKS5nZXROaWNlU2Nyb2xsKCk7XHJcbiAgICBpZiAoYyAmJiBjLmxlbmd0aCA+IDApIHtcclxuICAgICAgYy5yZXNpemUoKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHBhdGllbnRzUGFuZWwuZmluZCgnZGl2LnRhYmxlLXNjcm9sbCcpLm5pY2VTY3JvbGwoe1xyXG4gICAgICAgIGN1cnNvcm9wYWNpdHltaW46IDAuMyxcclxuICAgICAgICBjdXJzb3J3aWR0aDogXCI3cHhcIixcclxuICAgICAgICBob3JpenJhaWxlbmFibGVkOiBmYWxzZVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9LFxyXG5cclxuICAvL1Nob3cgcGF0aWVudCB2aWV3IGZyb20gdGhlIGFsbCBwYXRpZW50IHNjcmVlblxyXG4gIHNob3dJbmRpdmlkdWFsUGF0aWVudFZpZXc6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKSB7XHJcbiAgICBkYXRhLnBhdGllbnRJZCA9IHBhdGllbnRJZDtcclxuXHJcbiAgICBkYXRhLm9wdGlvbnMuc29ydChmdW5jdGlvbihhLCBiKSB7XHJcbiAgICAgIGEgPSBkYXRhLmdldFBhdGllbnRTdGF0dXMocGF0aWVudElkLCBhLnBhdGh3YXlJZCwgYS5wYXRod2F5U3RhZ2UsIGEuc3RhbmRhcmQpO1xyXG4gICAgICBiID0gZGF0YS5nZXRQYXRpZW50U3RhdHVzKHBhdGllbnRJZCwgYi5wYXRod2F5SWQsIGIucGF0aHdheVN0YWdlLCBiLnN0YW5kYXJkKTtcclxuXHJcbiAgICAgIGlmIChhID09PSBiKSByZXR1cm4gMDtcclxuICAgICAgaWYgKGEgPT09IFwibm90XCIpIHJldHVybiAxO1xyXG4gICAgICBpZiAoYiA9PT0gXCJub3RcIikgcmV0dXJuIC0xO1xyXG4gICAgICBpZiAoYSA9PT0gXCJva1wiKSByZXR1cm4gMTtcclxuICAgICAgaWYgKGIgPT09IFwib2tcIikgcmV0dXJuIC0xO1xyXG4gICAgICBhbGVydChcIiEhISEhISFcIik7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpZiAocGF0aHdheUlkID09PSBudWxsKSB7XHJcbiAgICAgIC8vU2hvdyBwYXRpZW50IGJ1dCBkb24ndCBzZWxlY3RcclxuICAgICAgdmFyIHAgPSBiYXNlLmNyZWF0ZVBhbmVsKCQoJyNwYXRpZW50LXBhbmVsJyksIHtcclxuICAgICAgICBcIm9wdGlvbnNcIjogZGF0YS5vcHRpb25zLFxyXG4gICAgICAgIFwibnVtYmVyT2ZTdGFuZGFyZHNNaXNzZWRcIjogZGF0YS5udW1iZXJPZlN0YW5kYXJkc01pc3NlZChwYXRpZW50SWQpLFxyXG4gICAgICAgIFwibmhzTnVtYmVyXCI6IGRhdGEucGF0TG9va3VwID8gZGF0YS5wYXRMb29rdXBbcGF0aWVudElkXSA6IHBhdGllbnRJZCxcclxuICAgICAgICBcInBhdGllbnRJZFwiOiBwYXRpZW50SWRcclxuICAgICAgfSwge1xyXG4gICAgICAgIFwib3B0aW9uXCI6ICQoJyNwYXRpZW50LXBhbmVsLWRyb3AtZG93bi1vcHRpb25zJykuaHRtbCgpXHJcbiAgICAgIH0pO1xyXG4gICAgICBmYXJSaWdodFBhbmVsLmh0bWwocCkuc2hvdygpO1xyXG4gICAgICBmYXJSaWdodFBhbmVsLnJlbW92ZUNsYXNzKCdzdGFuZGFyZC1taXNzZWQtcGFnZScpLnJlbW92ZUNsYXNzKCdzdGFuZGFyZC1hY2hpZXZlZC1wYWdlJykucmVtb3ZlQ2xhc3MoJ3N0YW5kYXJkLW5vdC1yZWxldmFudC1wYWdlJyk7XHJcblxyXG4gICAgICAkKCdzZWxlY3QnKS5zZWxlY3QyKHtcclxuICAgICAgICB0ZW1wbGF0ZVJlc3VsdDogYmFzZS5mb3JtYXRTdGFuZGFyZCxcclxuICAgICAgICBtaW5pbXVtUmVzdWx0c0ZvclNlYXJjaDogSW5maW5pdHksXHJcbiAgICAgICAgcGxhY2Vob2xkZXI6IFwiUGxlYXNlIHNlbGVjdCBhbiBpbXByb3ZlbWVudCBvcHBvcnR1bml0eSBhcmVhLi4uXCJcclxuICAgICAgfSk7XHJcbiAgICAgICQoJ3NwYW4uc2VsZWN0Mi1zZWxlY3Rpb25fX3JlbmRlcmVkJykuYXR0cihcInRpdGxlXCIsIFwiXCIpO1xyXG4gICAgICAkKCdzZWxlY3QnKS5vbignY2hhbmdlJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIGxvY2FsRGF0YSA9ICQodGhpcykuZmluZCgnOnNlbGVjdGVkJykuZGF0YSgpO1xyXG4gICAgICAgIGFsbC5zaG93SW5kaXZpZHVhbFBhdGllbnRWaWV3KGxvY2FsRGF0YS5wYXRod2F5SWQsIGxvY2FsRGF0YS5wYXRod2F5U3RhZ2UsIGxvY2FsRGF0YS5zdGFuZGFyZCwgZGF0YS5wYXRpZW50SWQpO1xyXG4gICAgICB9KS5vbihcInNlbGVjdDI6b3BlblwiLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgICB9KTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIHZhciBwYW5lbCA9IGJhc2UuY3JlYXRlUGFuZWwoJCgnI3BhdGllbnQtcGFuZWwnKSwge1xyXG4gICAgICBcIm9wdGlvbnNcIjogZGF0YS5vcHRpb25zLFxyXG4gICAgICBcIm51bWJlck9mU3RhbmRhcmRzTWlzc2VkXCI6IGRhdGEubnVtYmVyT2ZTdGFuZGFyZHNNaXNzZWQocGF0aWVudElkKSxcclxuICAgICAgXCJzdGFuZGFyZFwiOiBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLnRhYi50aXRsZSxcclxuICAgICAgXCJwYXRod2F5U3RhZ2VcIjogcGF0aHdheVN0YWdlLFxyXG4gICAgICBcIm5oc051bWJlclwiOiBkYXRhLnBhdExvb2t1cCA/IGRhdGEucGF0TG9va3VwW3BhdGllbnRJZF0gOiBwYXRpZW50SWQsXHJcbiAgICAgIFwicGF0aWVudElkXCI6IHBhdGllbnRJZFxyXG4gICAgfSwge1xyXG4gICAgICBcIm9wdGlvblwiOiAkKCcjcGF0aWVudC1wYW5lbC1kcm9wLWRvd24tb3B0aW9ucycpLmh0bWwoKVxyXG4gICAgfSk7XHJcblxyXG4gICAgZmFyUmlnaHRQYW5lbC5odG1sKFwiXCIpO1xyXG4gICAgJCgnI3RlbXAtaGlkZGVuJykuaHRtbChwYW5lbCk7XHJcblxyXG4gICAgdmFyIGFjdGlvblBsYW4gPSBpbmRpdmlkdWFsQWN0aW9uUGxhbi5jcmVhdGUocGF0aHdheVN0YWdlKTtcclxuICAgICQoJyN0ZW1wLWhpZGRlbiAjcGF0aWVudC1wYW5lbC1yaWdodCcpLmh0bWwoYWN0aW9uUGxhbik7XHJcblxyXG4gICAgdmFyIHF1YWxQYW5lbCA9IHF1YWxpdHlTdGFuZGFyZC5jcmVhdGUocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gICAgdmFyIHRyZW5kUGFuZWwgPSB0cmVuZC5jcmVhdGUocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gICAgdmFyIG1lZFBhbmVsID0gbWVkaWNhdGlvbi5jcmVhdGUocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gICAgdmFyIGNvZGVzUGFuZWwgPSBvdGhlckNvZGVzLmNyZWF0ZShwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcbiAgICB2YXIgbWVkQ29kZVdyYXBwZXJQYW5lbCA9IGJhc2UuY3JlYXRlUGFuZWwoJCgnI290aGVyLWNvZGVzLWFuZC1tZWRzLXdyYXBwZXItcGFuZWwnKSk7XHJcbiAgICAkKCcjdGVtcC1oaWRkZW4gI3BhdGllbnQtcGFuZWwtdG9wJykuaHRtbChxdWFsUGFuZWwpO1xyXG4gICAgJCgnI3RlbXAtaGlkZGVuICNwYXRpZW50LXBhbmVsLWxlZnQnKS5odG1sKFwiXCIpLmFwcGVuZCh0cmVuZFBhbmVsKS5hcHBlbmQobWVkQ29kZVdyYXBwZXJQYW5lbCk7XHJcbiAgICAkKCcjdGVtcC1oaWRkZW4gI21lZENvZGVXcmFwcGVyUGFuZWwnKS5hcHBlbmQobWVkUGFuZWwpLmFwcGVuZChjb2Rlc1BhbmVsKTtcclxuXHJcbiAgICBpZiAoZmFyUmlnaHRQYW5lbC5pcygnOnZpc2libGUnKSkge1xyXG4gICAgICBmYXJSaWdodFBhbmVsLmZhZGVPdXQoMTAwLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAkKHRoaXMpLmh0bWwoJCgnI3RlbXAtaGlkZGVuJykuaHRtbCgpKTtcclxuICAgICAgICAkKCcjdGVtcC1oaWRkZW4nKS5odG1sKFwiXCIpO1xyXG4gICAgICAgIGluZGl2aWR1YWxBY3Rpb25QbGFuLndpcmVVcChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcbiAgICAgICAgcXVhbGl0eVN0YW5kYXJkLndpcmVVcChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcbiAgICAgICAgYmFzZS53aXJlVXBTdGFuZGFyZERyb3BEb3duKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgYWxsLnNob3dJbmRpdmlkdWFsUGF0aWVudFZpZXcpO1xyXG4gICAgICAgIHRyZW5kLndpcmVVcChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcbiAgICAgICAgbWVkaWNhdGlvbi53aXJlVXAocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gICAgICAgIG90aGVyQ29kZXMud2lyZVVwKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgICAgICBjaGFydC5kcmF3VHJlbmRDaGFydChwYXRpZW50SWQsIHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCk7XHJcbiAgICAgICAgJCh0aGlzKS5mYWRlSW4oMTAwLCBmdW5jdGlvbigpIHt9KTtcclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBmYXJSaWdodFBhbmVsLmh0bWwoJCgnI3RlbXAtaGlkZGVuJykuaHRtbCgpKTtcclxuICAgICAgJCgnI3RlbXAtaGlkZGVuJykuaHRtbChcIlwiKTtcclxuICAgICAgaW5kaXZpZHVhbEFjdGlvblBsYW4ud2lyZVVwKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgICAgcXVhbGl0eVN0YW5kYXJkLndpcmVVcChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcbiAgICAgIGJhc2Uud2lyZVVwU3RhbmRhcmREcm9wRG93bihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIGFsbC5zaG93SW5kaXZpZHVhbFBhdGllbnRWaWV3KTtcclxuICAgICAgdHJlbmQud2lyZVVwKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgICAgbWVkaWNhdGlvbi53aXJlVXAocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gICAgICBvdGhlckNvZGVzLndpcmVVcChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcbiAgICAgIGNoYXJ0LmRyYXdUcmVuZENoYXJ0KHBhdGllbnRJZCwgcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkKTtcclxuICAgICAgZmFyUmlnaHRQYW5lbC5mYWRlSW4oMTAwLCBmdW5jdGlvbigpIHt9KTtcclxuICAgIH1cclxuICB9LFxyXG5cclxuICBzaG93OiBmdW5jdGlvbihsb2NhdGlvbikge1xyXG4gICAgYmFzZS5jcmVhdGVQYW5lbFNob3coJCgnI2FsbC1wYXRpZW50cy1wYW5lbCcpLCBsb2NhdGlvbiwge1xyXG4gICAgICBcIm5cIjogZGF0YS5nZXRBbGxQYXRpZW50cygpLmxlbmd0aFxyXG4gICAgfSk7XHJcblxyXG4gICAgcGF0aWVudHNQYW5lbCA9ICQoJyNwYXRpZW50cycpO1xyXG5cclxuICAgIHBhdGllbnRzUGFuZWwub24oJ2NsaWNrJywgJ3Rib2R5IHRyJywgZnVuY3Rpb24oZSkgeyAvL1NlbGVjdCBpbmRpdmlkdWFsIHBhdGllbnQgd2hlbiByb3cgY2xpY2tlZFxyXG4gICAgICAkKCdbZGF0YS10b2dnbGU9XCJ0b29sdGlwXCJdJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAkKHRoaXMpLnRvb2x0aXAoJ2Rlc3Ryb3knKTtcclxuICAgICAgYmFzZS5jbGVhckJveCgpO1xyXG4gICAgICAkKCcubGlzdC1pdGVtJykucmVtb3ZlQ2xhc3MoJ2hpZ2hsaWdodGVkJyk7XHJcbiAgICAgICQodGhpcykuYWRkQ2xhc3MoJ2hpZ2hsaWdodGVkJykucmVtb3ZlQXR0cigndGl0bGUnKTtcclxuXHJcbiAgICAgIHZhciBwYXRpZW50SWQgPSAkKHRoaXMpLmZpbmQoJ3RkIGJ1dHRvbicpLmF0dHIoJ2RhdGEtcGF0aWVudC1pZCcpO1xyXG5cclxuICAgICAgYWxsLnNob3dJbmRpdmlkdWFsUGF0aWVudFZpZXcobnVsbCwgbnVsbCwgbnVsbCwgcGF0aWVudElkKTtcclxuXHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgIH0pLm9uKCdjbGljaycsICd0Ym9keSB0ciBidXR0b24nLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIC8vZG9uJ3Qgd2FudCByb3cgc2VsZWN0ZWQgaWYganVzdCBidXR0b24gcHJlc3NlZD9cclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgfSk7XHJcbiAgfSxcclxuXHJcbiAgc2hvd1ZpZXc6IGZ1bmN0aW9uKHBhdGllbnRJZCwgcmVsb2FkKSB7XHJcbiAgICAkKCcjbWFpblRpdGxlJykuaGlkZSgpO1xyXG4gICAgYmFzZS51cGRhdGVUaXRsZShcIkxpc3Qgb2YgYWxsIHBhdGllbnRzIGF0IHlvdXIgcHJhY3RpY2VcIik7XHJcblxyXG4gICAgaWYgKCFwYXRpZW50SWQpIGRhdGEucGF0aHdheUlkID0gXCJcIjtcclxuICAgIGlmICghcGF0aWVudElkIHx8IHJlbG9hZCkge1xyXG5cclxuICAgICAgbGF5b3V0LnNob3dNYWluVmlldyhkYXRhLmRpc2Vhc2VzLmxlbmd0aCk7XHJcblxyXG4gICAgICBiYXNlLnN3aXRjaFRvMTEwTGF5b3V0KCk7XHJcbiAgICAgIGJhc2UuaGlkZUFsbFBhbmVscygpO1xyXG5cclxuICAgICAgYWxsLnNob3coZmFyTGVmdFBhbmVsKTtcclxuICAgICAgYWxsLnBvcHVsYXRlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHBhdGllbnRJZCkge1xyXG4gICAgICBhbGwuc2hvd0luZGl2aWR1YWxQYXRpZW50VmlldyhudWxsLCBudWxsLCBudWxsLCBwYXRpZW50SWQpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdmFyIHRlbXBNdXN0ID0gJCgnI3BhdGllbnQtcGFuZWwtcGxhY2Vob2xkZXInKS5odG1sKCk7XHJcbiAgICAgIGZhclJpZ2h0UGFuZWwuaHRtbChNdXN0YWNoZS5yZW5kZXIodGVtcE11c3QpKS5zaG93KCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gYWxsO1xyXG4iLCJ2YXIgYmFzZSA9IHJlcXVpcmUoJy4uL2Jhc2UuanMnKSxcclxubG9nID0gcmVxdWlyZSgnLi4vbG9nLmpzJyk7XHJcblxyXG52YXIgY29uZmlybSA9IHtcclxuXHJcbiAgd2lyZVVwOiBmdW5jdGlvbihhZ3JlZURpdlNlbGVjdG9yLCBwYW5lbFNlbGVjdG9yLCBwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCwgaXRlbSwgZGlzYWdyZWVUZXh0KSB7XHJcbiAgICBjb25maXJtLndpcmVVcEFncmVlRGlzYWdyZWUoYWdyZWVEaXZTZWxlY3RvciwgbG9nLmdldFBhdGllbnRBZ3JlZU9iamVjdChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCwgaXRlbSkpO1xyXG5cclxuICAgIHBhbmVsU2VsZWN0b3Iub24oJ2NoYW5nZScsICcuYnRuLXRvZ2dsZSBpbnB1dFt0eXBlPWNoZWNrYm94XScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICBjb25maXJtLndpcmVVcEFncmVlRGlzYWdyZWUoYWdyZWVEaXZTZWxlY3RvciwgbG9nLmdldFBhdGllbnRBZ3JlZU9iamVjdChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCwgaXRlbSkpO1xyXG4gICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICB9KS5vbignY2xpY2snLCAnLmJ0bi10b2dnbGUnLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIHZhciBjaGVja2JveCA9ICQodGhpcykuZmluZChcImlucHV0W3R5cGU9Y2hlY2tib3hdXCIpO1xyXG4gICAgICB2YXIgb3RoZXIgPSAkKHRoaXMpLnBhcmVudCgpLmZpbmQoJCh0aGlzKS5oYXNDbGFzcyhcImJ0bi15ZXNcIikgPyBcIi5idG4tbm9cIiA6IFwiLmJ0bi15ZXNcIik7XHJcbiAgICAgIHZhciBBQ1RJT05JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKCdpZCcpO1xyXG4gICAgICBpZiAoJCh0aGlzKS5oYXNDbGFzcyhcImFjdGl2ZVwiKSAmJiBvdGhlci5oYXNDbGFzcyhcImluYWN0aXZlXCIpKSB7XHJcbiAgICAgICAgLy91bnNlbGVjdGluZ1xyXG4gICAgICAgIGlmIChjaGVja2JveC52YWwoKSA9PT0gXCJub1wiKSB7XHJcbiAgICAgICAgICBjb25maXJtLmxhdW5jaFN0YW5kYXJkTW9kYWwoXCJEaXNhZ3JlZSB3aXRoIFwiICsgZGlzYWdyZWVUZXh0LCBcIj9cIiwgbG9nLmdldEFncmVlUmVhc29uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkLCBpdGVtKSwgdHJ1ZSwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGxvZy5lZGl0UGF0aWVudEFncmVlKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkLCBpdGVtLCBmYWxzZSwgbG9nLnJlYXNvbi5yZWFzb25UZXh0KTtcclxuICAgICAgICAgICAgY29uZmlybS53aXJlVXBBZ3JlZURpc2FncmVlKGFncmVlRGl2U2VsZWN0b3IsIGxvZy5nZXRQYXRpZW50QWdyZWVPYmplY3QocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQsIGl0ZW0pKTtcclxuICAgICAgICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgICAgICAgfSwgbnVsbCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGxvZy5lZGl0UGF0aWVudEFncmVlKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkLCBpdGVtLCBudWxsLCBcIlwiKTtcclxuICAgICAgICAgICAgb3RoZXIucmVtb3ZlQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgY2hlY2tib3gucmVtb3ZlQXR0cihcImNoZWNrZWRcIik7XHJcbiAgICAgICAgICAgIGNoZWNrYm94LnBhcmVudCgpLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICBjb25maXJtLndpcmVVcEFncmVlRGlzYWdyZWUoYWdyZWVEaXZTZWxlY3RvciwgbG9nLmdldFBhdGllbnRBZ3JlZU9iamVjdChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCwgaXRlbSkpO1xyXG4gICAgICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGxvZy5lZGl0UGF0aWVudEFncmVlKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkLCBpdGVtLCBudWxsKTtcclxuICAgICAgICAgIG90aGVyLnJlbW92ZUNsYXNzKFwiaW5hY3RpdmVcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2UgaWYgKCEkKHRoaXMpLmhhc0NsYXNzKFwiYWN0aXZlXCIpICYmIG90aGVyLmhhc0NsYXNzKFwiYWN0aXZlXCIpKSB7XHJcbiAgICAgICAgLy9wcmV2ZW50IGNsaWNraW5nIG9uIHVuc2VsZWN0ZWQgb3B0aW9uIG9yIGlmIHRoZSByb3cgaXMgY29tcGxldGVcclxuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy9zZWxlY3RpbmdcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgaWYgKGNoZWNrYm94LnZhbCgpID09PSBcIm5vXCIpIHtcclxuICAgICAgICAgIGNvbmZpcm0ubGF1bmNoU3RhbmRhcmRNb2RhbChcIkRpc2FncmVlIHdpdGggXCIgKyBkaXNhZ3JlZVRleHQsIFwiXCIsIFwiXCIsIGZhbHNlLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgbG9nLmVkaXRQYXRpZW50QWdyZWUocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQsIGl0ZW0sIGZhbHNlLCBsb2cucmVhc29uLnJlYXNvblRleHQpO1xyXG4gICAgICAgICAgICAkKHNlbGYpLnJlbW92ZUNsYXNzKFwiaW5hY3RpdmVcIik7XHJcbiAgICAgICAgICAgIGNoZWNrYm94LmF0dHIoXCJjaGVja2VkXCIsIFwiY2hlY2tlZFwiKTtcclxuICAgICAgICAgICAgY2hlY2tib3gucGFyZW50KCkuYWRkQ2xhc3MoXCJhY3RpdmVcIik7XHJcbiAgICAgICAgICAgIC8vdW5zZWxlY3Qgb3RoZXJcclxuICAgICAgICAgICAgb3RoZXIucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIikuYWRkQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgb3RoZXIuZmluZChcImlucHV0W3R5cGU9Y2hlY2tib3hdXCIpLnByb3AoXCJjaGVja2VkXCIsIGZhbHNlKTtcclxuICAgICAgICAgICAgY29uZmlybS53aXJlVXBBZ3JlZURpc2FncmVlKGFncmVlRGl2U2VsZWN0b3IsIGxvZy5nZXRQYXRpZW50QWdyZWVPYmplY3QocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQsIGl0ZW0pKTtcclxuICAgICAgICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBsb2cuZWRpdFBhdGllbnRBZ3JlZShwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCwgaXRlbSwgdHJ1ZSk7XHJcbiAgICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKFwiaW5hY3RpdmVcIik7XHJcblxyXG4gICAgICAgICAgLy91bnNlbGVjdCBvdGhlclxyXG4gICAgICAgICAgb3RoZXIucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIikuYWRkQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuICAgICAgICAgIG90aGVyLmZpbmQoXCJpbnB1dFt0eXBlPWNoZWNrYm94XVwiKS5wcm9wKFwiY2hlY2tlZFwiLCBmYWxzZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICB3aXJlVXBBZ3JlZURpc2FncmVlOiBmdW5jdGlvbihzZWxlY3RvciwgYWdyZWVPYmplY3QpIHtcclxuICAgIGlmIChhZ3JlZU9iamVjdC5hZ3JlZSA9PT0gdHJ1ZSkge1xyXG4gICAgICBzZWxlY3Rvci5jaGlsZHJlbignOm50aCgwKScpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgc2VsZWN0b3IuY2hpbGRyZW4oJzpudGgoMSknKS5hZGRDbGFzcygnaW5hY3RpdmUnKTtcclxuICAgICAgc2VsZWN0b3IuY2hpbGRyZW4oJzpudGgoMCknKS5hdHRyKFwidGl0bGVcIiwgY29uZmlybS5nZXRBZ3JlZVRvb2x0aXAoYWdyZWVPYmplY3QpKS5hdHRyKFwiZGF0YS1vcmlnaW5hbC10aXRsZVwiLCBjb25maXJtLmdldEFncmVlVG9vbHRpcChhZ3JlZU9iamVjdCkpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICBzZWxlY3Rvci5jaGlsZHJlbignOm50aCgxKScpLmF0dHIoXCJ0aXRsZVwiLCBcIlwiKS5hdHRyKFwiZGF0YS1vcmlnaW5hbC10aXRsZVwiLCBcIlwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgc2VsZWN0b3IucGFyZW50KCkuYWRkQ2xhc3MoJ3N1Y2Nlc3MnKS5yZW1vdmVDbGFzcygnZGFuZ2VyJyk7XHJcbiAgICB9IGVsc2UgaWYgKGFncmVlT2JqZWN0LmFncmVlID09PSBmYWxzZSkge1xyXG4gICAgICBzZWxlY3Rvci5jaGlsZHJlbignOm50aCgwKScpLmFkZENsYXNzKCdpbmFjdGl2ZScpO1xyXG4gICAgICBzZWxlY3Rvci5jaGlsZHJlbignOm50aCgxKScpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgc2VsZWN0b3IuY2hpbGRyZW4oJzpudGgoMCknKS5hdHRyKFwidGl0bGVcIiwgXCJcIikuYXR0cihcImRhdGEtb3JpZ2luYWwtdGl0bGVcIiwgXCJcIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgIHNlbGVjdG9yLmNoaWxkcmVuKCc6bnRoKDEpJykuYXR0cihcInRpdGxlXCIsIGNvbmZpcm0uZ2V0RGlzZ3JlZVRvb2x0aXAoYWdyZWVPYmplY3QpKS5hdHRyKFwiZGF0YS1vcmlnaW5hbC10aXRsZVwiLCBjb25maXJtLmdldERpc2dyZWVUb29sdGlwKGFncmVlT2JqZWN0KSkudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgIHNlbGVjdG9yLnBhcmVudCgpLmFkZENsYXNzKCdkYW5nZXInKS5yZW1vdmVDbGFzcygnc3VjY2VzcycpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgc2VsZWN0b3IuY2hpbGRyZW4oJzpudGgoMCknKS5hdHRyKFwidGl0bGVcIiwgXCJDbGljayB0byBhZ3JlZVwiKS5hdHRyKFwiZGF0YS1vcmlnaW5hbC10aXRsZVwiLCBcIkNsaWNrIHRvIGFncmVlXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICBzZWxlY3Rvci5jaGlsZHJlbignOm50aCgxKScpLmF0dHIoXCJ0aXRsZVwiLCBcIkNsaWNrIHRvIGRpc2FncmVlXCIpLmF0dHIoXCJkYXRhLW9yaWdpbmFsLXRpdGxlXCIsIFwiQ2xpY2sgdG8gZGlzYWdyZWVcIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgIHNlbGVjdG9yLnBhcmVudCgpLnJlbW92ZUNsYXNzKCdzdWNjZXNzJykucmVtb3ZlQ2xhc3MoJ2RhbmdlcicpO1xyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIGdldEFncmVlVG9vbHRpcDogZnVuY3Rpb24oYWdyZWVPYmplY3QpIHtcclxuICAgIHJldHVybiBhZ3JlZU9iamVjdC5oaXN0b3J5W2FncmVlT2JqZWN0Lmhpc3RvcnkubGVuZ3RoIC0gMV07XHJcbiAgfSxcclxuXHJcbiAgZ2V0RGlzZ3JlZVRvb2x0aXA6IGZ1bmN0aW9uKGFncmVlT2JqZWN0KSB7XHJcbiAgICByZXR1cm4gYWdyZWVPYmplY3QuaGlzdG9yeVthZ3JlZU9iamVjdC5oaXN0b3J5Lmxlbmd0aCAtIDFdICsgXCIgWW91IHNhaWQ6IFwiICsgYWdyZWVPYmplY3QucmVhc29uO1xyXG4gIH0sXHJcblxyXG4gIGxhdW5jaFN0YW5kYXJkTW9kYWw6IGZ1bmN0aW9uKGhlYWRlciwgdmFsdWUsIHJlYXNvbiwgaXNVbmRvLCBjYWxsYmFja09uU2F2ZSwgY2FsbGJhY2tPbkNhbmNlbCwgY2FsbGJhY2tPblVuZG8pIHtcclxuICAgIGJhc2UubGF1bmNoTW9kYWwoe1xyXG4gICAgICBcImhlYWRlclwiOiBoZWFkZXIsXHJcbiAgICAgIFwiaXNVbmRvXCI6IGlzVW5kbyxcclxuICAgICAgXCJpdGVtXCI6IHZhbHVlLFxyXG4gICAgICBcInBsYWNlaG9sZGVyXCI6IFwiUHJvdmlkZSBtb3JlIGluZm9ybWF0aW9uIGhlcmUuLi5cIlxyXG4gICAgfSwgbnVsbCwgdmFsdWUsIHJlYXNvbiwgY2FsbGJhY2tPblNhdmUsIGNhbGxiYWNrT25DYW5jZWwsIGNhbGxiYWNrT25VbmRvKTtcclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBjb25maXJtO1xyXG4iLCJ2YXIgYmFzZSA9IHJlcXVpcmUoJy4uL2Jhc2UuanMnKSxcclxuICBkYXRhID0gcmVxdWlyZSgnLi4vZGF0YS5qcycpLFxyXG4gIGNoYXJ0ID0gcmVxdWlyZSgnLi4vY2hhcnQuanMnKSxcclxuICBwYXRpZW50TGlzdCA9IHJlcXVpcmUoJy4vcGF0aWVudExpc3QuanMnKTtcclxuXHJcbnZhciBJRCA9IFwiSU5ESUNBVE9SX0JFTkNITUFSS1wiO1xyXG5cclxudmFyIGlUcmVuZCA9IHtcclxuXHJcbiAgc2hvdzogZnVuY3Rpb24ocGFuZWwsIGlzQXBwZW5kLCBwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQpIHtcclxuXHJcbiAgICB2YXIgZWxlbSA9ICQoXCI8ZGl2IGlkPSdiZW5jaG1hcmstY2hhcnQnIGNsYXNzPSdmaXQtdG8tc2Nyb2xsaW5nLXNlY3Rpb24taGVpZ2h0Jz48L2Rpdj5cIik7XHJcblxyXG4gICAgaWYgKGlzQXBwZW5kKSBwYW5lbC5hcHBlbmQoZWxlbSk7XHJcbiAgICBlbHNlIHBhbmVsLmh0bWwoZWxlbSk7XHJcblxyXG4gICAgY2hhcnQuZHJhd0JlbmNobWFya0NoYXJ0SEMoXCJiZW5jaG1hcmstY2hhcnRcIiwgbnVsbCk7XHJcblxyXG4gIH0sXHJcblxyXG4gIHdpcmVVcDogZnVuY3Rpb24oKSB7XHJcblxyXG4gIH1cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGlUcmVuZDtcclxuIiwidmFyIGRhdGEgPSByZXF1aXJlKCcuLi9kYXRhLmpzJyksXHJcbiAgY2hhcnQgPSByZXF1aXJlKCcuLi9jaGFydC5qcycpO1xyXG5cclxudmFyIGJkID0ge1xyXG5cclxuICB3aXJlVXA6IGZ1bmN0aW9uKCkge1xyXG5cclxuICB9LFxyXG5cclxuICBzaG93OiBmdW5jdGlvbihwYW5lbCwgaXNBcHBlbmQsIHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgc2VsZWN0U2VyaWVzRm4pIHtcclxuXHJcbiAgICB2YXIgaW5kaWNhdG9ycyA9IGRhdGEuZ2V0SW5kaWNhdG9yRGF0YVN5bmMoW3BhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZF0uam9pbihcIi5cIikpO1xyXG5cclxuICAgIHZhciBkYXRhT2JqID0gaW5kaWNhdG9ycy5vcHBvcnR1bml0aWVzLm1hcChmdW5jdGlvbihvcHApIHtcclxuICAgICAgcmV0dXJuIFtvcHAubmFtZSwgb3BwLnBhdGllbnRzLmxlbmd0aF07XHJcbiAgICB9KTtcclxuXHJcbiAgICB2YXIgZWxlbSA9ICQoXCI8ZGl2IGlkPSdicmVha2Rvd24tY2hhcnQnPjwvZGl2PlwiKTtcclxuXHJcbiAgICBpZiAoaXNBcHBlbmQpIHBhbmVsLmFwcGVuZChlbGVtKTtcclxuICAgIGVsc2UgcGFuZWwuaHRtbChlbGVtKTtcclxuXHJcbiAgICBjaGFydC5kcmF3QW5hbHl0aWNzKFwiYnJlYWtkb3duLWNoYXJ0XCIsIGRhdGFPYmosIHNlbGVjdFNlcmllc0ZuKTtcclxuXHJcbiAgICBiZC53aXJlVXAoKTtcclxuXHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gYmQ7XHJcbiIsInZhciBkYXRhID0gcmVxdWlyZSgnLi4vZGF0YS5qcycpLFxyXG4gIGNoYXJ0ID0gcmVxdWlyZSgnLi4vY2hhcnQuanMnKSxcclxuICBNdXN0YWNoZSA9IHJlcXVpcmUoJ211c3RhY2hlJyk7XHJcblxyXG52YXIgaGwgPSB7XHJcblxyXG4gIHdpcmVVcDogZnVuY3Rpb24oKSB7XHJcblxyXG4gIH0sXHJcblxyXG4gIHNob3c6IGZ1bmN0aW9uKHBhbmVsLCBpc0FwcGVuZCwgcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkKSB7XHJcblxyXG4gICAgdmFyIGluZGljYXRvcnMgPSBkYXRhLmdldEluZGljYXRvckRhdGFTeW5jKFtwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmRdLmpvaW4oXCIuXCIpKTtcclxuXHJcbiAgICB2YXIgdGVtcE11c3QgPSAkKCcjaW5kaWNhdG9yLWhlYWRsaW5lLXBhbmVsJykuaHRtbCgpO1xyXG4gICAgdmFyIGh0bWwgPSBNdXN0YWNoZS5yZW5kZXIodGVtcE11c3QsIGluZGljYXRvcnMpO1xyXG5cclxuICAgIGlmKGlzQXBwZW5kKSBwYW5lbC5hcHBlbmQoaHRtbCk7XHJcbiAgICBlbHNlIHBhbmVsLmh0bWwoaHRtbCk7XHJcblxyXG4gIH1cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGhsO1xyXG4iLCJ2YXIgYmFzZSA9IHJlcXVpcmUoJy4uL2Jhc2UuanMnKSxcclxuICBsb2cgPSByZXF1aXJlKCcuLi9sb2cuanMnKSxcclxuICBkYXRhID0gcmVxdWlyZSgnLi4vZGF0YS5qcycpLFxyXG4gIHNwYXJrbGluZSA9IHJlcXVpcmUoJ2pxdWVyeS1zcGFya2xpbmUnKSxcclxuICBNdXN0YWNoZSA9IHJlcXVpcmUoJ211c3RhY2hlJyk7XHJcblxyXG52YXIgaW5kaWNhdG9yTGlzdCA9IHtcclxuXHJcbiAgc2hvdzogZnVuY3Rpb24ocGFuZWwsIGlzQXBwZW5kLCBsb2FkQ29udGVudEZuKSB7XHJcbiAgICBkYXRhLmdldEFsbEluZGljYXRvckRhdGEoZnVuY3Rpb24oaW5kaWNhdG9ycykge1xyXG5cclxuICAgICAgdmFyIHRlbXBNdXN0ID0gJCgnI292ZXJ2aWV3LXBhbmVsLXRhYmxlJykuaHRtbCgpO1xyXG4gICAgICB2YXIgaHRtbCA9IE11c3RhY2hlLnJlbmRlcih0ZW1wTXVzdCwge1xyXG4gICAgICAgIFwiaW5kaWNhdG9yc1wiOiBpbmRpY2F0b3JzXHJcbiAgICAgIH0pO1xyXG4gICAgICBpZiAoaXNBcHBlbmQpIHtcclxuICAgICAgICBwYW5lbC5hcHBlbmQoaHRtbCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcGFuZWwuaHRtbChodG1sKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgJCgnLmlubGluZXNwYXJrbGluZScpLnNwYXJrbGluZSgnaHRtbCcsIHtcclxuICAgICAgICB0b29sdGlwRm9ybWF0dGVyOiBmdW5jdGlvbihzcGFya2xpbmUsIG9wdGlvbnMsIGZpZWxkcykge1xyXG4gICAgICAgICAgdmFyIGR0cyA9IGluZGljYXRvcnNbJCgnLmlubGluZXNwYXJrbGluZScpLmluZGV4KHNwYXJrbGluZS5lbCldLmRhdGVzO1xyXG4gICAgICAgICAgcmV0dXJuIGR0c1tkdHMubGVuZ3RoIC0gMSAtIGZpZWxkcy54XSArIFwiOiBcIiArIGZpZWxkcy55ICsgXCIlXCI7XHJcbiAgICAgICAgfSxcclxuICAgICAgICB3aWR0aDogXCIxMDBweFwiXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgaW5kaWNhdG9yTGlzdC53aXJlVXAocGFuZWwsIGxvYWRDb250ZW50Rm4pO1xyXG5cclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIHBvcHVsYXRlOiBmdW5jdGlvbigpIHtcclxuXHJcbiAgfSxcclxuXHJcbiAgd2lyZVVwOiBmdW5jdGlvbihwYW5lbCwgbG9hZENvbnRlbnRGbikge1xyXG4gICAgcGFuZWwub2ZmKCdjbGljaycsICd0ci5zdGFuZGFyZC1yb3csdHIuc2hvdy1tb3JlLXJvdycpO1xyXG4gICAgcGFuZWwub24oJ2NsaWNrJywgJ3RyLnN0YW5kYXJkLXJvdyx0ci5zaG93LW1vcmUtcm93JywgZnVuY3Rpb24oZSkge1xyXG4gICAgICB2YXIgdXJsID0gJCh0aGlzKS5kYXRhKFwiaWRcIikucmVwbGFjZSgvXFwuL2csIFwiL1wiKTtcclxuICAgICAgaGlzdG9yeS5wdXNoU3RhdGUobnVsbCwgbnVsbCwgJyNpbmRpY2F0b3JzLycgKyB1cmwpO1xyXG4gICAgICBsb2FkQ29udGVudEZuKCcjaW5kaWNhdG9ycy8nICsgdXJsKTtcclxuICAgICAgLy8gZG8gbm90IGdpdmUgYSBkZWZhdWx0IGFjdGlvblxyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0pO1xyXG5cclxuICAgIHBhbmVsLm9mZignbW91c2VlbnRlcicsICcuc2hvdy1tb3JlLXJvdywuc3RhbmRhcmQtcm93Jyk7XHJcbiAgICBwYW5lbC5vZmYoJ21vdXNlbGVhdmUnLCAnLnNob3ctbW9yZS1yb3csLnN0YW5kYXJkLXJvdycpO1xyXG4gICAgcGFuZWwub24oJ21vdXNlZW50ZXInLCAnLnNob3ctbW9yZS1yb3csLnN0YW5kYXJkLXJvdycsIGZ1bmN0aW9uKGUpe1xyXG4gICAgICB2YXIgaWQgPSAkKHRoaXMpLmRhdGEoXCJpZFwiKTtcclxuICAgICAgJCgnLnNob3ctbW9yZS1yb3dbZGF0YS1pZD1cIicgKyBpZCArICdcIl0sLnN0YW5kYXJkLXJvd1tkYXRhLWlkPVwiJyArIGlkICsgJ1wiXScpLmFkZENsYXNzKCdob3ZlcicpO1xyXG4gICAgfSk7XHJcbiAgICBwYW5lbC5vbignbW91c2VsZWF2ZScsICcuc2hvdy1tb3JlLXJvdywuc3RhbmRhcmQtcm93JywgZnVuY3Rpb24oZSl7XHJcbiAgICAgIHZhciBpZCA9ICQodGhpcykuZGF0YShcImlkXCIpO1xyXG4gICAgICAkKCcuc2hvdy1tb3JlLXJvd1tkYXRhLWlkPVwiJyArIGlkICsgJ1wiXSwuc3RhbmRhcmQtcm93W2RhdGEtaWQ9XCInICsgaWQgKyAnXCJdJykucmVtb3ZlQ2xhc3MoJ2hvdmVyJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBwYW5lbC5vZmYoJ2NsaWNrJywgJy5zaG93LW1vcmUnKTtcclxuICAgIHBhbmVsLm9uKCdjbGljaycsICcuc2hvdy1tb3JlJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICB2YXIgaWQgPSAkKHRoaXMpLmRhdGEoXCJpZFwiKTtcclxuICAgICAgdmFyIGVsZW0gPSAkKCcuc2hvdy1tb3JlLXJvd1tkYXRhLWlkPVwiJyArIGlkICsgJ1wiXScpO1xyXG4gICAgICBpZihlbGVtLmlzKCc6dmlzaWJsZScpKXtcclxuICAgICAgICAkKCcuc2hvdy1tb3JlW2RhdGEtaWQ9XCInICsgaWQgKyAnXCJdOmZpcnN0Jykuc2hvdygpO1xyXG4gICAgICAgIGVsZW0uaGlkZSgpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgICQodGhpcykuaGlkZSgpO1xyXG4gICAgICAgIGVsZW0uc2hvdygnZmFzdCcpO1xyXG4gICAgICB9XHJcbiAgICAgIC8vIGRvIG5vdCBnaXZlIGEgZGVmYXVsdCBhY3Rpb25cclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBpbmRpY2F0b3JMaXN0O1xyXG4iLCJ2YXIgYmFzZSA9IHJlcXVpcmUoJy4uL2Jhc2UuanMnKSxcclxuICBkYXRhID0gcmVxdWlyZSgnLi4vZGF0YS5qcycpLFxyXG4gIGNoYXJ0ID0gcmVxdWlyZSgnLi4vY2hhcnQuanMnKSxcclxuICBwYXRpZW50TGlzdCA9IHJlcXVpcmUoJy4vcGF0aWVudExpc3QuanMnKTtcclxuXHJcbnZhciBJRCA9IFwiSU5ESUNBVE9SX1RSRU5EXCI7XHJcblxyXG52YXIgaVRyZW5kID0ge1xyXG5cclxuICBzaG93OiBmdW5jdGlvbihwYW5lbCwgaXNBcHBlbmQsIHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCkge1xyXG5cclxuICAgIHZhciBpbmRpY2F0b3JzID0gZGF0YS5nZXRBbGxJbmRpY2F0b3JEYXRhU3luYygpO1xyXG5cclxuICAgIHZhciBlbGVtID0gJChcIjxkaXYgaWQ9J3RyZW5kLWNoYXJ0JyBjbGFzcz0nZml0LXRvLXNjcm9sbGluZy1zZWN0aW9uLWhlaWdodCc+PC9kaXY+XCIpO1xyXG5cclxuICAgIGlmIChpc0FwcGVuZCkgcGFuZWwuYXBwZW5kKGVsZW0pO1xyXG4gICAgZWxzZSBwYW5lbC5odG1sKGVsZW0pO1xyXG5cclxuICAgIGNoYXJ0LmRyYXdQZXJmb3JtYW5jZVRyZW5kQ2hhcnRIQyhcInRyZW5kLWNoYXJ0XCIsIGluZGljYXRvcnMuZmlsdGVyKGZ1bmN0aW9uKHYpe1xyXG4gICAgICByZXR1cm4gdi5pZD09PVtwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmRdLmpvaW4oXCIuXCIpO1xyXG4gICAgfSlbMF0pO1xyXG5cclxuICB9LFxyXG5cclxuICB3aXJlVXA6IGZ1bmN0aW9uKCkge1xyXG5cclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBpVHJlbmQ7XHJcbiIsInZhciBiYXNlID0gcmVxdWlyZSgnLi4vYmFzZS5qcycpLFxyXG4gIGNvbmZpcm0gPSByZXF1aXJlKCcuL2NvbmZpcm0uanMnKSxcclxuICBkYXRhID0gcmVxdWlyZSgnLi4vZGF0YS5qcycpLFxyXG4gIGxvZyA9IHJlcXVpcmUoJy4uL2xvZy5qcycpO1xyXG5cclxudmFyIGlhcCA9IHtcclxuXHJcbiAgY3JlYXRlOiBmdW5jdGlvbihwYXRod2F5U3RhZ2UpIHtcclxuICAgIHJldHVybiBiYXNlLmNyZWF0ZVBhbmVsKCQoJyNpbmRpdmlkdWFsLWFjdGlvbi1wbGFuLXBhbmVsJyksIHtcclxuICAgICAgXCJwYXRod2F5U3RhZ2VcIjogcGF0aHdheVN0YWdlIHx8IFwiZGVmYXVsdFwiLFxyXG4gICAgICBcIm5vSGVhZGVyXCI6IHRydWVcclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIHNob3c6IGZ1bmN0aW9uKHBhbmVsLCBwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCkge1xyXG4gICAgcGFuZWwuaHRtbChpYXAuY3JlYXRlKHBhdGh3YXlTdGFnZSkpO1xyXG4gICAgaWFwLndpcmVVcChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcblxyXG4gICAgcGFuZWwuZmluZCgnZGl2LmZpdC10by1zY3JlZW4taGVpZ2h0JykubmljZVNjcm9sbCh7XHJcbiAgICAgIGN1cnNvcm9wYWNpdHltaW46IDAuMyxcclxuICAgICAgY3Vyc29yd2lkdGg6IFwiN3B4XCIsXHJcbiAgICAgIGhvcml6cmFpbGVuYWJsZWQ6IGZhbHNlXHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICB3aXJlVXA6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKSB7XHJcbiAgICBpbmRpdmlkdWFsVGFiID0gJCgnI3RhYi1wbGFuLWluZGl2aWR1YWwnKTtcclxuXHJcbiAgICAkKCcjYWR2aWNlLWxpc3QnKS5vbignY2xpY2snLCAnLmNyLXN0eWxlZCBpbnB1dFt0eXBlPWNoZWNrYm94XScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgQUNUSU9OSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YSgnaWQnKTtcclxuICAgICAgbG9nLmVkaXRBY3Rpb24oZGF0YS5wYXRpZW50SWQsIEFDVElPTklELCBudWxsLCB0aGlzLmNoZWNrZWQpO1xyXG5cclxuICAgICAgaWYgKHRoaXMuY2hlY2tlZCkge1xyXG4gICAgICAgIGxvZy5yZWNvcmRFdmVudChwYXRod2F5SWQsIGRhdGEucGF0aWVudElkLCBcIkl0ZW0gY29tcGxldGVkXCIpO1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAkKHNlbGYpLnBhcmVudCgpLmF0dHIoXCJ0aXRsZVwiLCBcIlwiKS5hdHRyKFwiZGF0YS1vcmlnaW5hbC10aXRsZVwiLCBcIlwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICQoc2VsZikucGFyZW50KCkuZmFkZU91dCgzMDAsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgcGFyZW50ID0gJCh0aGlzKS5wYXJlbnQoKTtcclxuICAgICAgICAgICAgJCh0aGlzKS5yZXBsYWNlV2l0aChiYXNlLmNyZWF0ZVBhbmVsKCQoJyNjaGVja2JveC10ZW1wbGF0ZScpLCB7XHJcbiAgICAgICAgICAgICAgXCJkb25lXCI6IHRydWVcclxuICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICAgICAgICAgIHBhcmVudC5maW5kKCdidXR0b24nKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICBBQ1RJT05JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKCdpZCcpO1xyXG4gICAgICAgICAgICAgIGxvZy5lZGl0QWN0aW9uKGRhdGEucGF0aWVudElkLCBBQ1RJT05JRCwgbnVsbCwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICQodGhpcykucmVwbGFjZVdpdGgoYmFzZS5jcmVhdGVQYW5lbCgkKCcjY2hlY2tib3gtdGVtcGxhdGUnKSwge1xyXG4gICAgICAgICAgICAgICAgXCJkb25lXCI6IGZhbHNlXHJcbiAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgIGlhcC51cGRhdGVJbmRpdmlkdWFsU2FwUm93cygpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sIDEwMDApO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpYXAudXBkYXRlSW5kaXZpZHVhbFNhcFJvd3MoKTtcclxuICAgIH0pO1xyXG5cclxuICAgICQoJyNwZXJzb25hbFBsYW5JbmRpdmlkdWFsJykub24oJ2NsaWNrJywgJ2lucHV0W3R5cGU9Y2hlY2tib3hdJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBQTEFOSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YShcImlkXCIpO1xyXG4gICAgICBsb2cuZWRpdFBsYW4oUExBTklELCBudWxsLCB0aGlzLmNoZWNrZWQpO1xyXG5cclxuICAgICAgaWYgKHRoaXMuY2hlY2tlZCkge1xyXG4gICAgICAgICQodGhpcykucGFyZW50KCkucGFyZW50KCkucGFyZW50KCkuYWRkQ2xhc3MoJ3N1Y2Nlc3MnKTtcclxuICAgICAgICBsb2cucmVjb3JkRXZlbnQocGF0aHdheUlkLCBkYXRhLnBhdGllbnRJZCwgXCJQZXJzb25hbCBwbGFuIGl0ZW1cIik7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgICQoc2VsZikucGFyZW50KCkuYXR0cihcInRpdGxlXCIsIFwiXCIpLmF0dHIoXCJkYXRhLW9yaWdpbmFsLXRpdGxlXCIsIFwiXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgJChzZWxmKS5wYXJlbnQoKS5mYWRlT3V0KDMwMCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBwYXJlbnQgPSAkKHRoaXMpLnBhcmVudCgpO1xyXG4gICAgICAgICAgICAkKHRoaXMpLnJlcGxhY2VXaXRoKGJhc2UuY3JlYXRlUGFuZWwoJCgnI2NoZWNrYm94LXRlbXBsYXRlJyksIHtcclxuICAgICAgICAgICAgICBcImRvbmVcIjogdHJ1ZVxyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgICAgICAgICAgcGFyZW50LmZpbmQoJ2J1dHRvbicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgIFBMQU5JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKCdpZCcpO1xyXG4gICAgICAgICAgICAgIGxvZy5lZGl0UGxhbihkYXRhLnBhdGllbnRJZCwgUExBTklELCBudWxsLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgJCh0aGlzKS5yZXBsYWNlV2l0aChiYXNlLmNyZWF0ZVBhbmVsKCQoJyNjaGVja2JveC10ZW1wbGF0ZScpLCB7XHJcbiAgICAgICAgICAgICAgICBcImRvbmVcIjogZmFsc2VcclxuICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgaWFwLnVwZGF0ZUluZGl2aWR1YWxTYXBSb3dzKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSwgMTAwMCk7XHJcbiAgICAgIH1cclxuICAgIH0pLm9uKCdjbGljaycsICcuYnRuLXVuZG8nLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIHZhciBQTEFOSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YSgnaWQnKTtcclxuICAgICAgbG9nLmVkaXRQbGFuKFBMQU5JRCwgbnVsbCwgZmFsc2UpO1xyXG4gICAgICAkKHRoaXMpLnJlcGxhY2VXaXRoKGJhc2UuY3JlYXRlUGFuZWwoJCgnI2NoZWNrYm94LXRlbXBsYXRlJyksIHtcclxuICAgICAgICBcImRvbmVcIjogZmFsc2VcclxuICAgICAgfSkpO1xyXG4gICAgICBpYXAudXBkYXRlSW5kaXZpZHVhbFNhcFJvd3MoKTtcclxuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGluZGl2aWR1YWxUYWIub24oJ2NsaWNrJywgJy5lZGl0LXBsYW4nLCBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIFBMQU5JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKFwiaWRcIik7XHJcblxyXG4gICAgICAkKCcjZWRpdEFjdGlvblBsYW5JdGVtJykudmFsKCQoJCh0aGlzKS5jbG9zZXN0KCd0cicpLmNoaWxkcmVuKCd0ZCcpWzBdKS5maW5kKCdzcGFuJykudGV4dCgpKTtcclxuXHJcbiAgICAgICQoJyNlZGl0UGxhbicpLm9mZignaGlkZGVuLmJzLm1vZGFsJykub24oJ2hpZGRlbi5icy5tb2RhbCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlhcC5kaXNwbGF5UGVyc29uYWxpc2VkSW5kaXZpZHVhbEFjdGlvblBsYW4oZGF0YS5wYXRpZW50SWQsICQoJyNwZXJzb25hbFBsYW5JbmRpdmlkdWFsJykpO1xyXG4gICAgICB9KS5vZmYoJ3Nob3duLmJzLm1vZGFsJykub24oJ3Nob3duLmJzLm1vZGFsJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgJCgnI2VkaXRBY3Rpb25QbGFuSXRlbScpLmZvY3VzKCk7XHJcbiAgICAgIH0pLm9mZignY2xpY2snLCAnLnNhdmUtcGxhbicpLm9uKCdjbGljaycsICcuc2F2ZS1wbGFuJywgZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgIGxvZy5lZGl0UGxhbihQTEFOSUQsICQoJyNlZGl0QWN0aW9uUGxhbkl0ZW0nKS52YWwoKSk7XHJcblxyXG4gICAgICAgICQoJyNlZGl0UGxhbicpLm1vZGFsKCdoaWRlJyk7XHJcbiAgICAgIH0pLm9mZigna2V5dXAnLCAnI2VkaXRBY3Rpb25QbGFuSXRlbScpLm9uKCdrZXl1cCcsICcjZWRpdEFjdGlvblBsYW5JdGVtJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgIGlmIChlLndoaWNoID09PSAxMykgJCgnI2VkaXRQbGFuIC5zYXZlLXBsYW4nKS5jbGljaygpO1xyXG4gICAgICB9KS5tb2RhbCgpO1xyXG4gICAgfSkub24oJ2NsaWNrJywgJy5kZWxldGUtcGxhbicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgUExBTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoXCJpZFwiKTtcclxuXHJcbiAgICAgICQoJyNpbmRpdmlkdWFsLWRlbGV0ZS1pdGVtJykuaHRtbCgkKCQodGhpcykuY2xvc2VzdCgndHInKS5jaGlsZHJlbigndGQnKVswXSkuZmluZCgnc3BhbicpLnRleHQoKSk7XHJcblxyXG4gICAgICAkKCcjZGVsZXRlUGxhbicpLm9mZignaGlkZGVuLmJzLm1vZGFsJykub24oJ2hpZGRlbi5icy5tb2RhbCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlhcC5kaXNwbGF5UGVyc29uYWxpc2VkSW5kaXZpZHVhbEFjdGlvblBsYW4oZGF0YS5wYXRpZW50SWQsICQoJyNwZXJzb25hbFBsYW5JbmRpdmlkdWFsJykpO1xyXG4gICAgICB9KS5vZmYoJ2NsaWNrJywgJy5kZWxldGUtcGxhbicpLm9uKCdjbGljaycsICcuZGVsZXRlLXBsYW4nLCBmdW5jdGlvbigpIHtcclxuICAgICAgICBsb2cuZGVsZXRlUGxhbihQTEFOSUQpO1xyXG5cclxuICAgICAgICAkKCcjZGVsZXRlUGxhbicpLm1vZGFsKCdoaWRlJyk7XHJcbiAgICAgIH0pLm1vZGFsKCk7XHJcbiAgICB9KS5vbignY2xpY2snLCAnLmFkZC1wbGFuJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIGxvZy5yZWNvcmRQbGFuKGRhdGEucGF0aWVudElkLCAkKHRoaXMpLnBhcmVudCgpLnBhcmVudCgpLmZpbmQoJ3RleHRhcmVhJykudmFsKCksIHBhdGh3YXlJZCk7XHJcblxyXG4gICAgICBpYXAuZGlzcGxheVBlcnNvbmFsaXNlZEluZGl2aWR1YWxBY3Rpb25QbGFuKGRhdGEucGF0aWVudElkLCAkKCcjcGVyc29uYWxQbGFuSW5kaXZpZHVhbCcpKTtcclxuICAgIH0pLm9uKCdjaGFuZ2UnLCAnLmJ0bi10b2dnbGUgaW5wdXRbdHlwZT1jaGVja2JveF0nLCBmdW5jdGlvbigpIHtcclxuICAgICAgaWFwLnVwZGF0ZUluZGl2aWR1YWxTYXBSb3dzKCk7XHJcbiAgICB9KS5vbignY2xpY2snLCAnLmJ0bi11bmRvJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICB2YXIgQUNUSU9OSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YSgnaWQnKTtcclxuICAgICAgbG9nLmVkaXRBY3Rpb24oZGF0YS5wYXRpZW50SWQsIEFDVElPTklELCBudWxsLCBmYWxzZSk7XHJcbiAgICAgICQodGhpcykucmVwbGFjZVdpdGgoYmFzZS5jcmVhdGVQYW5lbCgkKCcjY2hlY2tib3gtdGVtcGxhdGUnKSwge1xyXG4gICAgICAgIFwiZG9uZVwiOiBmYWxzZVxyXG4gICAgICB9KSk7XHJcbiAgICAgIGlhcC51cGRhdGVJbmRpdmlkdWFsU2FwUm93cygpO1xyXG4gICAgfSkub24oJ2NsaWNrJywgJy5idG4teWVzLC5idG4tbm8nLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIHZhciBjaGVja2JveCA9ICQodGhpcykuZmluZChcImlucHV0W3R5cGU9Y2hlY2tib3hdXCIpO1xyXG4gICAgICB2YXIgb3RoZXIgPSAkKHRoaXMpLnBhcmVudCgpLmZpbmQoJCh0aGlzKS5oYXNDbGFzcyhcImJ0bi15ZXNcIikgPyBcIi5idG4tbm9cIiA6IFwiLmJ0bi15ZXNcIik7XHJcbiAgICAgIHZhciBBQ1RJT05JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKCdpZCcpO1xyXG4gICAgICBpZiAoJCh0aGlzKS5oYXNDbGFzcyhcImFjdGl2ZVwiKSAmJiBvdGhlci5oYXNDbGFzcyhcImluYWN0aXZlXCIpICYmICEkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuaGFzQ2xhc3MoJ3N1Y2Nlc3MnKSkge1xyXG4gICAgICAgIC8vdW5zZWxlY3RpbmdcclxuICAgICAgICBpZiAoY2hlY2tib3gudmFsKCkgPT09IFwibm9cIikge1xyXG4gICAgICAgICAgaWFwLmxhdW5jaE1vZGFsKGRhdGEuc2VsZWN0ZWQsIGNoZWNrYm94LmNsb3Nlc3QoJ3RyJykuY2hpbGRyZW4oKS5maXJzdCgpLmNoaWxkcmVuKCkuZmlyc3QoKS50ZXh0KCksIGxvZy5nZXRSZWFzb24oZGF0YS5wYXRpZW50SWQsIEFDVElPTklEKSwgdHJ1ZSwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGxvZy5lZGl0QWN0aW9uKGRhdGEucGF0aWVudElkLCBBQ1RJT05JRCwgZmFsc2UsIG51bGwsIGxvZy5yZWFzb24pO1xyXG4gICAgICAgICAgICBpYXAudXBkYXRlSW5kaXZpZHVhbFNhcFJvd3MoKTtcclxuICAgICAgICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgICAgICAgfSwgbnVsbCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGxvZy5pZ25vcmVBY3Rpb24oZGF0YS5wYXRpZW50SWQsIEFDVElPTklEKTtcclxuICAgICAgICAgICAgb3RoZXIucmVtb3ZlQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgY2hlY2tib3gucmVtb3ZlQXR0cihcImNoZWNrZWRcIik7XHJcbiAgICAgICAgICAgIGNoZWNrYm94LnBhcmVudCgpLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICBpYXAudXBkYXRlSW5kaXZpZHVhbFNhcFJvd3MoKTtcclxuICAgICAgICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBsb2cuaWdub3JlQWN0aW9uKGRhdGEucGF0aWVudElkLCBBQ1RJT05JRCk7XHJcbiAgICAgICAgICBvdGhlci5yZW1vdmVDbGFzcyhcImluYWN0aXZlXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIGlmICgoISQodGhpcykuaGFzQ2xhc3MoXCJhY3RpdmVcIikgJiYgb3RoZXIuaGFzQ2xhc3MoXCJhY3RpdmVcIikpIHx8ICQodGhpcykuY2xvc2VzdCgndHInKS5oYXNDbGFzcygnc3VjY2VzcycpKSB7XHJcbiAgICAgICAgLy9wcmV2ZW50IGNsaWNraW5nIG9uIHVuc2VsZWN0ZWQgb3B0aW9uIG9yIGlmIHRoZSByb3cgaXMgY29tcGxldGVcclxuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy9zZWxlY3RpbmdcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgaWYgKGNoZWNrYm94LnZhbCgpID09PSBcIm5vXCIpIHtcclxuICAgICAgICAgIGlhcC5sYXVuY2hNb2RhbChkYXRhLnNlbGVjdGVkLCBjaGVja2JveC5jbG9zZXN0KCd0cicpLmNoaWxkcmVuKCkuZmlyc3QoKS5jaGlsZHJlbigpLmZpcnN0KCkudGV4dCgpLCBsb2cuZ2V0UmVhc29uKGRhdGEucGF0aWVudElkLCBBQ1RJT05JRCksIGZhbHNlLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgbG9nLmVkaXRBY3Rpb24oZGF0YS5wYXRpZW50SWQsIEFDVElPTklELCBmYWxzZSwgbnVsbCwgbG9nLnJlYXNvbik7XHJcbiAgICAgICAgICAgICQoc2VsZikucmVtb3ZlQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuXHJcbiAgICAgICAgICAgIGNoZWNrYm94LmF0dHIoXCJjaGVja2VkXCIsIFwiY2hlY2tlZFwiKTtcclxuICAgICAgICAgICAgY2hlY2tib3gucGFyZW50KCkuYWRkQ2xhc3MoXCJhY3RpdmVcIik7XHJcbiAgICAgICAgICAgIC8vdW5zZWxlY3Qgb3RoZXJcclxuICAgICAgICAgICAgb3RoZXIucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIikuYWRkQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgb3RoZXIuZmluZChcImlucHV0W3R5cGU9Y2hlY2tib3hdXCIpLnByb3AoXCJjaGVja2VkXCIsIGZhbHNlKTtcclxuICAgICAgICAgICAgaWFwLnVwZGF0ZUluZGl2aWR1YWxTYXBSb3dzKCk7XHJcbiAgICAgICAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgbG9nLmVkaXRBY3Rpb24oZGF0YS5wYXRpZW50SWQsIEFDVElPTklELCB0cnVlKTtcclxuICAgICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuXHJcbiAgICAgICAgICAvL3Vuc2VsZWN0IG90aGVyXHJcbiAgICAgICAgICBvdGhlci5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKS5hZGRDbGFzcyhcImluYWN0aXZlXCIpO1xyXG4gICAgICAgICAgb3RoZXIuZmluZChcImlucHV0W3R5cGU9Y2hlY2tib3hdXCIpLnByb3AoXCJjaGVja2VkXCIsIGZhbHNlKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pLm9uKCdrZXl1cCcsICdpbnB1dFt0eXBlPXRleHRdJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICBpZiAoZS53aGljaCA9PT0gMTMpIHtcclxuICAgICAgICBpbmRpdmlkdWFsVGFiLmZpbmQoJy5hZGQtcGxhbicpLmNsaWNrKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgICQoJyNhZHZpY2UtbGlzdCcpLm9mZignY2xpY2snLCAnLnNob3ctbW9yZScpO1xyXG4gICAgJCgnI2FkdmljZS1saXN0Jykub24oJ2NsaWNrJywgJy5zaG93LW1vcmUnLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIHZhciBpZCA9ICQodGhpcykuZGF0YShcImlkXCIpO1xyXG4gICAgICB2YXIgZWxlbSA9ICQoJy5zaG93LW1vcmUtcm93W2RhdGEtaWQ9XCInICsgaWQgKyAnXCJdJyk7XHJcbiAgICAgIGlmKGVsZW0uaXMoJzp2aXNpYmxlJykpe1xyXG4gICAgICAgICQoJy5zaG93LW1vcmVbZGF0YS1pZD1cIicgKyBpZCArICdcIl06Zmlyc3QnKS5zaG93KCk7XHJcbiAgICAgICAgZWxlbS5oaWRlKCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgJCh0aGlzKS5oaWRlKCk7XHJcbiAgICAgICAgZWxlbS5zaG93KCdmYXN0Jyk7XHJcbiAgICAgIH1cclxuICAgICAgLy8gZG8gbm90IGdpdmUgYSBkZWZhdWx0IGFjdGlvblxyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0pO1xyXG5cclxuICAgIGlhcC5wb3B1bGF0ZUluZGl2aWR1YWxTdWdnZXN0ZWRBY3Rpb25zKHBhdGllbnRJZCwgcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkKTtcclxuICB9LFxyXG5cclxuICB1cGRhdGVJbmRpdmlkdWFsU2FwUm93czogZnVuY3Rpb24oKSB7XHJcbiAgICAvKiQoJyNhZHZpY2UtbGlzdCcpLmFkZCgnI3BlcnNvbmFsUGxhbkluZGl2aWR1YWwnKS5maW5kKCcuc3VnZ2VzdGlvbicpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgICQodGhpcykuZmluZCgndGQnKS5sYXN0KCkuY2hpbGRyZW4oKS5oaWRlKCk7XHJcbiAgICB9KTsqL1xyXG5cclxuICAgIC8qJCgnI2FkdmljZS1saXN0JykuYWRkKCcjcGVyc29uYWxQbGFuSW5kaXZpZHVhbCcpLmZpbmQoJy5jci1zdHlsZWQgaW5wdXRbdHlwZT1jaGVja2JveF0nKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICBpZiAodGhpcy5jaGVja2VkKSB7XHJcbiAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5wYXJlbnQoKS5wYXJlbnQoKS5hZGRDbGFzcygnc3VjY2VzcycpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgICQodGhpcykucGFyZW50KCkucGFyZW50KCkucGFyZW50KCkucmVtb3ZlQ2xhc3MoJ3N1Y2Nlc3MnKTtcclxuICAgICAgfVxyXG4gICAgfSk7Ki9cclxuXHJcbiAgICAvKiQoJyNhZHZpY2UtbGlzdCcpLmFkZCgnI3BlcnNvbmFsUGxhbkluZGl2aWR1YWwnKS5maW5kKCcuYnRuLXVuZG8nKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICAkKHRoaXMpLnBhcmVudCgpLnBhcmVudCgpLmFkZENsYXNzKCdzdWNjZXNzJyk7XHJcbiAgICB9KTsqL1xyXG5cclxuICAgIC8vbm8gY2xhc3MgLSB1c2VyIG5vdCB5ZXQgYWdyZWVkL2Rpc2FncmVlZCAtIG5vIGJhY2tncm91bmQgLyBtdXRlZCB0ZXh0XHJcbiAgICAvL2FjdGl2ZSAtIHVzZXIgYWdyZWVzIC0gZ3JlZW4gYmFja2dyb3VuZCAvIG5vcm1hbCB0ZXh0XHJcbiAgICAvL3N1Y2Nlc3MgLSB1c2VyIGNvbXBsZXRlZCAtIGdyZWVuIGJhY2tncm91bmQgLyBzdHJpa2V0aHJvdWdoIHRleHRcclxuICAgIC8vZGFuZ2VyIC0gdXNlciBkaXNhZ3JlZXMgLSByZWQgYmFja2dyb3VuZCAvIHN0cmlrZXRocm91Z2ggdGV4dFxyXG5cclxuICAgICQoJyNhZHZpY2UtbGlzdCcpLmFkZCgnI3BlcnNvbmFsUGxhbkluZGl2aWR1YWwnKS5maW5kKCd0ci5zdWdnZXN0aW9uJykuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIHNlbGYgPSAkKHRoaXMpO1xyXG4gICAgICB2YXIgaWQgPSBzZWxmLmRhdGEoXCJpZFwiKTtcclxuICAgICAgdmFyIGFsbCA9ICQoJy5zaG93LW1vcmUtcm93W2RhdGEtaWQ9XCInICsgaWQgKyAnXCJdLC5zdWdnZXN0aW9uW2RhdGEtaWQ9XCInICsgaWQgKyAnXCJdJyk7XHJcbiAgICAgIHZhciBhbnkgPSBmYWxzZTtcclxuICAgICAgc2VsZi5maW5kKCcuYnRuLXRvZ2dsZSBpbnB1dFt0eXBlPWNoZWNrYm94XTpjaGVja2VkJykuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgICBhbnkgPSB0cnVlO1xyXG4gICAgICAgIGlmICh0aGlzLnZhbHVlID09PSBcInllc1wiKSB7XHJcbiAgICAgICAgICBhbGwucmVtb3ZlQ2xhc3MoJ2RhbmdlcicpO1xyXG4gICAgICAgICAgYWxsLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgIC8vc2VsZi5maW5kKCd0ZCcpLmxhc3QoKS5jaGlsZHJlbigpLnNob3coKTtcclxuICAgICAgICAgIGlmIChsb2cuZ2V0QWN0aW9ucygpW2RhdGEucGF0aWVudElkXVtzZWxmLmRhdGEoXCJpZFwiKV0uaGlzdG9yeSkge1xyXG4gICAgICAgICAgICB2YXIgdG9vbCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5oYXNDbGFzcygnc3VjY2VzcycpID8gXCJcIiA6IFwiPHA+XCIgKyBsb2cuZ2V0QWN0aW9ucygpW2RhdGEucGF0aWVudElkXVtzZWxmLmRhdGEoXCJpZFwiKV0uaGlzdG9yeVswXSArIFwiPC9wPjxwPkNsaWNrIGFnYWluIHRvIGNhbmNlbDwvcD5cIjtcclxuICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5hdHRyKFwidGl0bGVcIiwgdG9vbCkuYXR0cihcImRhdGEtb3JpZ2luYWwtdGl0bGVcIiwgdG9vbCkudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAkKHRoaXMpLnBhcmVudCgpLmF0dHIoXCJ0aXRsZVwiLCBcIllvdSBhZ3JlZWQgLSBjbGljayBhZ2FpbiB0byBjYW5jZWxcIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGFsbC5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgICBhbGwuYWRkQ2xhc3MoJ2RhbmdlcicpO1xyXG4gICAgICAgICAgYWxsLnJlbW92ZUNsYXNzKCdzdWNjZXNzJyk7XHJcbiAgICAgICAgICBpZiAobG9nLmdldEFjdGlvbnMoKVtkYXRhLnBhdGllbnRJZF1bc2VsZi5kYXRhKFwiaWRcIildICYmIGxvZy5nZXRBY3Rpb25zKClbZGF0YS5wYXRpZW50SWRdW3NlbGYuZGF0YShcImlkXCIpXS5oaXN0b3J5KSB7XHJcbiAgICAgICAgICAgICQodGhpcykucGFyZW50KCkuYXR0cihcInRpdGxlXCIsIFwiPHA+XCIgKyBsb2cuZ2V0QWN0aW9ucygpW2RhdGEucGF0aWVudElkXVtzZWxmLmRhdGEoXCJpZFwiKV0uaGlzdG9yeVswXSArIFwiPC9wPjxwPkNsaWNrIGFnYWluIHRvIGVkaXQvY2FuY2VsPC9wPlwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICQodGhpcykucGFyZW50KCkuYXR0cihcInRpdGxlXCIsIFwiWW91IGRpc2FncmVlZCAtIGNsaWNrIGFnYWluIHRvIGVkaXQvY2FuY2VsXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICAgIGlmIChzZWxmLmZpbmQoJy5idG4tdG9nZ2xlIGlucHV0W3R5cGU9Y2hlY2tib3hdOm5vdCg6Y2hlY2tlZCknKS5sZW5ndGggPT0gMSkge1xyXG4gICAgICAgIHNlbGYuZmluZCgnLmJ0bi10b2dnbGUgaW5wdXRbdHlwZT1jaGVja2JveF06bm90KDpjaGVja2VkKScpLnBhcmVudCgpLmFkZENsYXNzKFwiaW5hY3RpdmVcIikuYXR0cihcInRpdGxlXCIsIFwiXCIpLmF0dHIoXCJkYXRhLW9yaWdpbmFsLXRpdGxlXCIsIFwiXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICghYW55KSB7XHJcbiAgICAgICAgYWxsLnJlbW92ZUNsYXNzKCdkYW5nZXInKTtcclxuICAgICAgICBhbGwucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgIGFsbC5yZW1vdmVDbGFzcygnc3VjY2VzcycpO1xyXG5cclxuICAgICAgICBzZWxmLmZpbmQoJy5idG4tdG9nZ2xlLmJ0bi15ZXMnKS5hdHRyKFwidGl0bGVcIiwgXCJDbGljayB0byBhZ3JlZSB3aXRoIHRoaXMgYWN0aW9uIGFuZCBzYXZlIGl0IGluIHlvdXIgYWdyZWVkIGFjdGlvbnMgbGlzdCAgXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgIHNlbGYuZmluZCgnLmJ0bi10b2dnbGUuYnRuLW5vJykuYXR0cihcInRpdGxlXCIsIFwiQ2xpY2sgdG8gZGlzYWdyZWUgd2l0aCB0aGlzIGFjdGlvbiBhbmQgcmVtb3ZlIGl0IGZyb20geW91ciBzdWdnZXN0ZWQgYWN0aW9ucyBsaXN0IFwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgfSk7XHJcbiAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgfSxcclxuXHJcbiAgZGlzcGxheVBlcnNvbmFsaXNlZEluZGl2aWR1YWxBY3Rpb25QbGFuOiBmdW5jdGlvbihpZCwgcGFyZW50RWxlbSkge1xyXG4gICAgdmFyIHBsYW5zID0gYmFzZS5zb3J0U3VnZ2VzdGlvbnMoYmFzZS5hZGREaXNhZ3JlZVBlcnNvbmFsVGVhbShsb2cubGlzdFBsYW5zKGlkKSkpO1xyXG5cclxuICAgIGJhc2UuY3JlYXRlUGFuZWxTaG93KGFjdGlvblBsYW5MaXN0LCBwYXJlbnRFbGVtLCB7XHJcbiAgICAgIFwiaGFzU3VnZ2VzdGlvbnNcIjogcGxhbnMgJiYgcGxhbnMubGVuZ3RoID4gMCxcclxuICAgICAgXCJzdWdnZXN0aW9uc1wiOiBwbGFuc1xyXG4gICAgfSwge1xyXG4gICAgICBcImFjdGlvbi1wbGFuXCI6ICQoJyNhY3Rpb24tcGxhbicpLmh0bWwoKSxcclxuICAgICAgXCJhY3Rpb24tcGxhbi1pdGVtXCI6ICQoJyNhY3Rpb24tcGxhbi1pdGVtJykuaHRtbCgpLFxyXG4gICAgICBcImNoa1wiOiAkKCcjY2hlY2tib3gtdGVtcGxhdGUnKS5odG1sKClcclxuICAgIH0pO1xyXG5cclxuICAgIGlhcC51cGRhdGVJbmRpdmlkdWFsU2FwUm93cygpO1xyXG4gIH0sXHJcblxyXG4gIHBvcHVsYXRlSW5kaXZpZHVhbFN1Z2dlc3RlZEFjdGlvbnM6IGZ1bmN0aW9uKHBhdGllbnRJZCwgcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkKSB7XHJcbiAgICB2YXIgbG9jYWxEYXRhID0ge1xyXG4gICAgICBcIm5oc051bWJlclwiOiBkYXRhLnBhdExvb2t1cCA/IGRhdGEucGF0TG9va3VwW3BhdGllbnRJZF0gOiBwYXRpZW50SWQsXHJcbiAgICAgIFwicGF0aWVudElkXCI6IHBhdGllbnRJZFxyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgcGF0aWVudERhdGEgPSBkYXRhLmdldFBhdGllbnREYXRhKHBhdGllbnRJZCk7XHJcblxyXG4gICAgdmFyIGJyZWFjaGVzID0gZGF0YS5wYXRpZW50c1twYXRpZW50SWRdLmJyZWFjaCA/IGRhdGEucGF0aWVudHNbcGF0aWVudElkXS5icmVhY2guZmlsdGVyKGZ1bmN0aW9uKHYpIHtcclxuICAgICAgcmV0dXJuIHYucGF0aHdheUlkID09PSBwYXRod2F5SWQgJiYgdi5wYXRod2F5U3RhZ2UgPT09IHBhdGh3YXlTdGFnZSAmJiB2LnN0YW5kYXJkID09PSBzdGFuZGFyZDtcclxuICAgIH0pIDogW107XHJcblxyXG4gICAgdmFyIGZuID0gZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgXCJpZFwiOiB2YWwsXHJcbiAgICAgICAgXCJzdWJzZWN0aW9uXCI6IHN1YnNlY3Rpb25cclxuICAgICAgfTtcclxuICAgIH07XHJcblxyXG4gICAgaWYgKHBhdGllbnREYXRhLmFjdGlvbnMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIGxvY2FsRGF0YS5ub1N1Z2dlc3Rpb25zID0gdHJ1ZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8qdmFyIHN1Z2dlc3Rpb25zID0gW10sXHJcbiAgICAgICAgc3Vic2VjdGlvbiA9IFwiXCI7XHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYnJlYWNoZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBzdWJzZWN0aW9uID0gYnJlYWNoZXNbaV0uc3Vic2VjdGlvbjtcclxuICAgICAgICBzdWdnZXN0aW9ucyA9IHN1Z2dlc3Rpb25zLmNvbmNhdChkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5iZG93bltzdWJzZWN0aW9uXS5zdWdnZXN0aW9ucyA/XHJcbiAgICAgICAgICBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5iZG93bltzdWJzZWN0aW9uXS5zdWdnZXN0aW9ucy5tYXAoZm4pIDogW10pO1xyXG4gICAgICB9Ki9cclxuXHJcbiAgICAgIGxvY2FsRGF0YS5zdWdnZXN0aW9ucyA9IGJhc2Uuc29ydFN1Z2dlc3Rpb25zKGJhc2UubWVyZ2VJbmRpdmlkdWFsU3R1ZmYocGF0aWVudERhdGEuYWN0aW9ucywgcGF0aWVudElkKSk7XHJcbiAgICAgIC8qbG9jYWxEYXRhLnNlY3Rpb24gPSB7XHJcbiAgICAgICAgXCJuYW1lXCI6IGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLmJkb3duW3N1YnNlY3Rpb25dLm5hbWUsXHJcbiAgICAgICAgXCJhZ3JlZVwiOiBsb2cuZ2V0UGF0aWVudEFncmVlKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBwYXRpZW50SWQsIFwic2VjdGlvblwiKSA9PT0gdHJ1ZSxcclxuICAgICAgICBcImRpc2FncmVlXCI6IGxvZy5nZXRQYXRpZW50QWdyZWUocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHBhdGllbnRJZCwgXCJzZWN0aW9uXCIpID09PSBmYWxzZSxcclxuICAgICAgfTtcclxuICAgICAgbG9jYWxEYXRhLmNhdGVnb3J5ID0ge1xyXG4gICAgICAgIFwibmFtZVwiOiBkYXRhLnBhdGllbnRzW3BhdGllbnRJZF0uY2F0ZWdvcnksXHJcbiAgICAgICAgXCJhZ3JlZVwiOiBsb2cuZ2V0UGF0aWVudEFncmVlKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBwYXRpZW50SWQsIFwiY2F0ZWdvcnlcIikgPT09IHRydWUsXHJcbiAgICAgICAgXCJkaXNhZ3JlZVwiOiBsb2cuZ2V0UGF0aWVudEFncmVlKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBwYXRpZW50SWQsIFwiY2F0ZWdvcnlcIikgPT09IGZhbHNlLFxyXG4gICAgICB9OyovXHJcbiAgICB9XHJcblxyXG4gICAgJCgnI2FkdmljZS1wbGFjZWhvbGRlcicpLmhpZGUoKTtcclxuICAgICQoJyNhZHZpY2UnKS5zaG93KCk7XHJcblxyXG4gICAgYmFzZS5jcmVhdGVQYW5lbFNob3coaW5kaXZpZHVhbFBhbmVsLCAkKCcjYWR2aWNlLWxpc3QnKSwgbG9jYWxEYXRhKTtcclxuXHJcbiAgICAvL1dpcmUgdXAgYW55IGNsaXBib2FyZCBzdHVmZiBpbiB0aGUgc3VnZ2VzdGlvbnNcclxuICAgICQoJyNhZHZpY2UtbGlzdCcpLmZpbmQoJ3NwYW46Y29udGFpbnMoXCJbQ09QWVwiKScpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBodG1sID0gJCh0aGlzKS5odG1sKCk7XHJcbiAgICAgICQodGhpcykuaHRtbChodG1sLnJlcGxhY2UoL1xcW0NPUFk6KFteXFxdXSopXFxdL2csICckMSA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBkYXRhLWNsaXBib2FyZC10ZXh0PVwiJDFcIiBkYXRhLWNvbnRlbnQ9XCJDb3BpZWRcIiBkYXRhLXRvZ2dsZT1cInRvb2x0aXBcIiBkYXRhLXBsYWNlbWVudD1cInRvcFwiIHRpdGxlPVwiQ29weSAkMSB0byBjbGlwYm9hcmQuXCIgY2xhc3M9XCJidG4gYnRuLXhzIGJ0bi1kZWZhdWx0IGJ0bi1jb3B5XCI+PHNwYW4gY2xhc3M9XCJmYSBmYS1jbGlwYm9hcmRcIj48L3NwYW4+PC9idXR0b24+JykpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgJCgnI2FkdmljZS1saXN0JykuZmluZCgnc3Bhbjpjb250YWlucyhcIltJTkZPXCIpJykuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIGh0bWwgPSAkKHRoaXMpLmh0bWwoKTtcclxuICAgICAgdmFyIHN1YnNlY3Rpb24gPSAkKHRoaXMpLmRhdGEoKS5zdWJzZWN0aW9uO1xyXG4gICAgICB2YXIgZGVzYyA9IGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0ub3Bwb3J0dW5pdGllcy5maWx0ZXIoZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgICAgICByZXR1cm4gdmFsLm5hbWUgPT09IHN1YnNlY3Rpb247XHJcbiAgICAgICAgfSkubGVuZ3RoID4gMCA/XHJcbiAgICAgICAgZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS5vcHBvcnR1bml0aWVzLmZpbHRlcihmdW5jdGlvbih2YWwpIHtcclxuICAgICAgICAgIHJldHVybiB2YWwubmFtZSA9PT0gc3Vic2VjdGlvbjtcclxuICAgICAgICB9KVswXS5kZXNjIDogc3Vic2VjdGlvbjtcclxuICAgICAgdmFyIHRvb2x0aXAgPSBzdWJzZWN0aW9uID8gXCJUaGlzIGFjdGlvbiBpcyBzdWdnZXN0ZWQgYmVjYXVzZSBQSU5HUiBjbGFzc2lmaWVkIHRoaXMgcGF0aWVudCBhczonXCIgKyBkZXNjICsgXCInXCIgOiAnJztcclxuICAgICAgdmFyIG5ld0h0bWwgPSAnIDxpIGNsYXNzPVwiZmEgZmEtaW5mby1jaXJjbGUgZmEtbGcgaW5mby1idXR0b24gY2xpY2thYmxlXCIgZGF0YS10b2dnbGU9XCJ0b29sdGlwXCIgZGF0YS1wbGFjZW1lbnQ9XCJyaWdodFwiIHRpdGxlPVwiJyArIHRvb2x0aXAgKyAnXCI+PC9pPic7XHJcbiAgICAgICQodGhpcykuaHRtbChodG1sLnJlcGxhY2UoL1xcW0lORk9cXF0vZywgbmV3SHRtbCkpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgJCgnI2FkdmljZS1saXN0JykuZmluZCgnc3Bhbjpjb250YWlucyhcIltNRUQtU1VHR0VTVElPTlwiKScpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBodG1sID0gJCh0aGlzKS5odG1sKCk7XHJcbiAgICAgIHZhciBzdWdnZXN0aW9uID0gTWF0aC5yYW5kb20oKSA8IDAuMzMgPyBcIkluY3JlYXNlIFJhbWlwcmlsIHRvIDEwbWcgcGVyIGRheVwiIDogKE1hdGgucmFuZG9tKCkgPCAwLjUgPyBcIkNvbnNpZGVyIGFkZGluZyBhbiBBQ0UgaW5oaWJpb3JcIiA6IFwiQ29uc2lkZXIgYWRkaW5nIGEgdGhpYXppZGUtbGlrZSBkaXVyZXRpY1wiKTtcclxuICAgICAgJCh0aGlzKS5odG1sKGh0bWwucmVwbGFjZSgvXFxbTUVEXFwtU1VHR0VTVElPTlxcXS9nLCBzdWdnZXN0aW9uKSk7XHJcbiAgICB9KTtcclxuXHJcblxyXG4gICAgYmFzZS5zZXR1cENsaXBib2FyZCgkKCcuYnRuLWNvcHknKSwgdHJ1ZSk7XHJcblxyXG4gICAgaWFwLmRpc3BsYXlQZXJzb25hbGlzZWRJbmRpdmlkdWFsQWN0aW9uUGxhbihwYXRpZW50SWQsICQoJyNwZXJzb25hbFBsYW5JbmRpdmlkdWFsJykpO1xyXG4gIH0sXHJcblxyXG4gIGxhdW5jaE1vZGFsOiBmdW5jdGlvbihsYWJlbCwgdmFsdWUsIHJlYXNvbiwgaXNVbmRvLCBjYWxsYmFja09uU2F2ZSwgY2FsbGJhY2tPbkNhbmNlbCwgY2FsbGJhY2tPblVuZG8pIHtcclxuICAgIHZhciByZWFzb25zID0gW3tcclxuICAgICAgXCJyZWFzb25cIjogXCJBbHJlYWR5IGRvbmUgdGhpc1wiLFxyXG4gICAgICBcInZhbHVlXCI6IFwiZG9uZVwiXHJcbiAgICB9LCB7XHJcbiAgICAgIFwicmVhc29uXCI6IFwiV291bGRuJ3Qgd29ya1wiLFxyXG4gICAgICBcInZhbHVlXCI6IFwibm93b3JrXCJcclxuICAgIH0sIHtcclxuICAgICAgXCJyZWFzb25cIjogXCJTb21ldGhpbmcgZWxzZVwiLFxyXG4gICAgICBcInZhbHVlXCI6IFwiZWxzZVwiXHJcbiAgICB9XTtcclxuICAgIGlmIChyZWFzb24gJiYgcmVhc29uLnJlYXNvbikge1xyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlYXNvbnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBpZiAocmVhc29uc1tpXS5yZWFzb24gPT09IHJlYXNvbi5yZWFzb24pIHtcclxuICAgICAgICAgIHJlYXNvbnNbaV0uY2hlY2tlZCA9IHRydWU7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGJhc2UubGF1bmNoTW9kYWwoe1xyXG4gICAgICBcImhlYWRlclwiOiBcIkRpc2FncmVlIHdpdGggYSBzdWdnZXN0ZWQgYWN0aW9uXCIsXHJcbiAgICAgIFwiaXNVbmRvXCI6IGlzVW5kbyxcclxuICAgICAgXCJpdGVtXCI6IHZhbHVlLFxyXG4gICAgICBcInBsYWNlaG9sZGVyXCI6IFwiUHJvdmlkZSBtb3JlIGluZm9ybWF0aW9uIGhlcmUuLi5cIixcclxuICAgICAgXCJyZWFzb25zXCI6IHJlYXNvbnNcclxuICAgIH0sIGxhYmVsLCB2YWx1ZSwgcmVhc29uID8gcmVhc29uLnJlYXNvblRleHQgOiBudWxsLCBjYWxsYmFja09uU2F2ZSwgY2FsbGJhY2tPbkNhbmNlbCwgY2FsbGJhY2tPblVuZG8pO1xyXG4gIH1cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGlhcDtcclxuIiwidmFyIEhpZ2hjaGFydHMgPSByZXF1aXJlKCdoaWdoY2hhcnRzL2hpZ2hzdG9jaycpLFxyXG4gIGJhc2UgPSByZXF1aXJlKCcuLi9iYXNlLmpzJyk7XHJcbnJlcXVpcmUoJ2hpZ2hjaGFydHMvaGlnaGNoYXJ0cy1tb3JlJykoSGlnaGNoYXJ0cyk7XHJcblxyXG52YXIgSUQgPSBcIkxJRkVMSU5FXCI7XHJcblxyXG52YXIgY29sb3VyID0ge1xyXG4gIGluZGV4OiAwLFxyXG4gIG5leHQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgaWYgKHRoaXMuaW5kZXggPj0gSGlnaGNoYXJ0cy5nZXRPcHRpb25zKCkuY29sb3JzLmxlbmd0aCkgdGhpcy5pbmRleCA9IDA7XHJcbiAgICByZXR1cm4gSGlnaGNoYXJ0cy5nZXRPcHRpb25zKCkuY29sb3JzW3RoaXMuaW5kZXgrK107XHJcbiAgfSxcclxuICByZXNldDogZnVuY3Rpb24oKSB7XHJcbiAgICB0aGlzLmluZGV4ID0gMDtcclxuICB9XHJcbn07XHJcblxyXG52YXIgbGwgPSB7XHJcbiAgY2hhcnRBcnJheTogW10sXHJcblxyXG4gIGRlc3Ryb3k6IGZ1bmN0aW9uKGVsZW1lbnRJZCkge1xyXG4gICAgJChlbGVtZW50SWQpLmh0bWwoJycpO1xyXG4gICAgJChlbGVtZW50SWQpLm9mZignbW91c2Vtb3ZlIHRvdWNobW92ZSB0b3VjaHN0YXJ0JywgJy5zeW5jLWNoYXJ0Jyk7XHJcblxyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBIaWdoY2hhcnRzLmNoYXJ0cy5sZW5ndGg7IGkrKykge1xyXG4gICAgICBpZiAoSGlnaGNoYXJ0cy5jaGFydHNbaV0gJiYgSGlnaGNoYXJ0cy5jaGFydHNbaV0ucmVuZGVyVG8uY2xhc3NOYW1lLmluZGV4T2YoXCJoLWNoYXJ0XCIpID4gLTEpIEhpZ2hjaGFydHMuY2hhcnRzW2ldLmRlc3Ryb3koKTtcclxuICAgIH1cclxuICB9LFxyXG5cclxuICBzaG93OiBmdW5jdGlvbihwYW5lbCwgaXNBcHBlbmQsIHBhdGllbnRJZCwgZGF0YSkge1xyXG5cclxuICAgIHZhciBlbGVtZW50ID0gJ2xpZmVsaW5lLWNoYXJ0JztcclxuICAgIHZhciBlbGVtZW50SWQgPSAnIycgKyBlbGVtZW50O1xyXG5cclxuICAgIGxsLmRlc3Ryb3koZWxlbWVudElkKTtcclxuXHJcbiAgICB2YXIgaHRtbEVsZW1lbnQgPSAkKCc8ZGl2IGNsYXNzPVwicGFuZWwgcGFuZWwtZGVmYXVsdFwiPjxkaXYgY2xhc3M9XCJwYW5lbC1ib2R5XCI+PGRpdiBpZD1cIicgKyBlbGVtZW50ICsgJ1wiPjwvZGl2PjwvZGl2PjwvZGl2PicpO1xyXG5cclxuICAgIGlmIChpc0FwcGVuZCkgcGFuZWwuYXBwZW5kKGh0bWxFbGVtZW50KTtcclxuICAgIGVsc2UgcGFuZWwuaHRtbChodG1sRWxlbWVudCk7XHJcblxyXG4gICAgY29sb3VyLnJlc2V0KCk7XHJcbiAgICAvKipcclxuICAgICAqIEluIG9yZGVyIHRvIHN5bmNocm9uaXplIHRvb2x0aXBzIGFuZCBjcm9zc2hhaXJzLCBvdmVycmlkZSB0aGVcclxuICAgICAqIGJ1aWx0LWluIGV2ZW50cyB3aXRoIGhhbmRsZXJzIGRlZmluZWQgb24gdGhlIHBhcmVudCBlbGVtZW50LlxyXG4gICAgICovXHJcblxyXG4gICAgJChlbGVtZW50SWQpLm9uKCdtb3VzZW1vdmUgdG91Y2htb3ZlIHRvdWNoc3RhcnQnLCAnLnN5bmMtY2hhcnQnLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIHZhciBjaGFydCwgcG9pbnQsIGksIGV2ZW50LCBzZXJpZXM7XHJcblxyXG4gICAgICBmb3IgKGkgPSAxOyBpIDwgbGwuY2hhcnRBcnJheS5sZW5ndGggLSAyOyBpID0gaSArIDEpIHtcclxuICAgICAgICBjaGFydCA9IGxsLmNoYXJ0QXJyYXlbaV07XHJcbiAgICAgICAgZXZlbnQgPSBjaGFydC5wb2ludGVyLm5vcm1hbGl6ZShlLm9yaWdpbmFsRXZlbnQpOyAvLyBGaW5kIGNvb3JkaW5hdGVzIHdpdGhpbiB0aGUgY2hhcnRcclxuICAgICAgICAvL2lmIChpID09PSAwKSBjb25zb2xlLmxvZyhldmVudC5jaGFydFggKyBcIiAtLS0gXCIgKyBldmVudC5jaGFydFkpO1xyXG4gICAgICAgIHNlcmllcyA9IGkgPT09IDAgPyBNYXRoLm1heChNYXRoLm1pbihNYXRoLmZsb29yKCgxMzAgLSBldmVudC5jaGFydFkpIC8gMzQpLCBjaGFydC5zZXJpZXMubGVuZ3RoIC0gMSksIDApIDogMDtcclxuICAgICAgICBwb2ludCA9IGNoYXJ0LnNlcmllc1tzZXJpZXNdLnNlYXJjaFBvaW50KGV2ZW50LCB0cnVlKTsgLy8gR2V0IHRoZSBob3ZlcmVkIHBvaW50XHJcblxyXG4gICAgICAgIGlmIChwb2ludCkge1xyXG4gICAgICAgICAgcG9pbnQub25Nb3VzZU92ZXIoKTsgLy8gU2hvdyB0aGUgaG92ZXIgbWFya2VyXHJcbiAgICAgICAgICBjaGFydC50b29sdGlwLnJlZnJlc2gocG9pbnQpOyAvLyBTaG93IHRoZSB0b29sdGlwXHJcbiAgICAgICAgICBjaGFydC54QXhpc1swXS5kcmF3Q3Jvc3NoYWlyKGV2ZW50LCBwb2ludCk7IC8vIFNob3cgdGhlIGNyb3NzaGFpclxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTeW5jaHJvbml6ZSB6b29taW5nIHRocm91Z2ggdGhlIHNldEV4dHJlbWVzIGV2ZW50IGhhbmRsZXIuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIHN5bmNFeHRyZW1lcyhlKSB7XHJcbiAgICAgIHZhciB0aGlzQ2hhcnQgPSB0aGlzLmNoYXJ0O1xyXG5cclxuICAgICAgaWYgKGUudHJpZ2dlciAhPT0gJ3N5bmNFeHRyZW1lcycpIHsgLy8gUHJldmVudCBmZWVkYmFjayBsb29wXHJcbiAgICAgICAgSGlnaGNoYXJ0cy5lYWNoKGxsLmNoYXJ0QXJyYXksIGZ1bmN0aW9uKGNoYXJ0KSB7XHJcbiAgICAgICAgICBpZiAoY2hhcnQgIT09IHRoaXNDaGFydCkge1xyXG4gICAgICAgICAgICBpZiAoY2hhcnQuaW52ZXJ0ZWQpIHtcclxuICAgICAgICAgICAgICBpZiAoY2hhcnQueUF4aXNbMF0uc2V0RXh0cmVtZXMpIHsgLy8gSXQgaXMgbnVsbCB3aGlsZSB1cGRhdGluZ1xyXG4gICAgICAgICAgICAgICAgY2hhcnQueUF4aXNbMF0uc2V0RXh0cmVtZXMoZS5taW4sIGUubWF4LCB1bmRlZmluZWQsIGZhbHNlLCB7XHJcbiAgICAgICAgICAgICAgICAgIHRyaWdnZXI6ICdzeW5jRXh0cmVtZXMnXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgaWYgKGNoYXJ0LnhBeGlzWzBdLnNldEV4dHJlbWVzKSB7IC8vIEl0IGlzIG51bGwgd2hpbGUgdXBkYXRpbmdcclxuICAgICAgICAgICAgICAgIGNoYXJ0LnhBeGlzWzBdLnNldEV4dHJlbWVzKGUubWluLCBlLm1heCwgdW5kZWZpbmVkLCBmYWxzZSwge1xyXG4gICAgICAgICAgICAgICAgICB0cmlnZ2VyOiAnc3luY0V4dHJlbWVzJ1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG4gICAgdmFyIHBsb3RDb25kaXRpb25zID0gZnVuY3Rpb24oY29uZGl0aW9ucywgaW1wb3J0YW50Q29kZXMsIGNvbnRhY3RzKSB7XHJcbiAgICAgIGxsLmNoYXJ0cyA9IDE7XHJcbiAgICAgIHZhciBzZXJpZXMgPSBbXTtcclxuICAgICAgJC5lYWNoKGNvbmRpdGlvbnMucmV2ZXJzZSgpLCBmdW5jdGlvbihpLCB0YXNrKSB7XHJcbiAgICAgICAgdmFyIGl0ZW0gPSB7XHJcbiAgICAgICAgICBuYW1lOiB0YXNrLm5hbWUsXHJcbiAgICAgICAgICBkYXRhOiBbXSxcclxuICAgICAgICAgIGNvbG9yOiBjb2xvdXIubmV4dCgpXHJcbiAgICAgICAgfTtcclxuICAgICAgICAkLmVhY2godGFzay5pbnRlcnZhbHMsIGZ1bmN0aW9uKGosIGludGVydmFsKSB7XHJcbiAgICAgICAgICBpdGVtLmRhdGEucHVzaChbaSArIDAuNDksIGludGVydmFsLmZyb20sIGludGVydmFsLnRvXSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHNlcmllcy5wdXNoKGl0ZW0pO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHZhciBtYXJrZXJUZW1wbGF0ZSA9IHsgXCJsaW5lV2lkdGhcIjogMSwgXCJsaW5lQ29sb3JcIjogXCJibGFja1wiLCBcInJhZGl1c1wiOiA4IH07XHJcbiAgICAgIHZhciBtYXJrZXJzID0ge1xyXG4gICAgICAgIFwiZGVmYXVsdFwiOiAkLmV4dGVuZCh7IFwic3ltYm9sXCI6IFwidHJpYW5nbGVcIiB9LCBtYXJrZXJUZW1wbGF0ZSksXHJcbiAgICAgICAgXCJGYWNlIHRvIGZhY2VcIjogJC5leHRlbmQoeyBcInN5bWJvbFwiOiBcInNxdWFyZVwiIH0sIG1hcmtlclRlbXBsYXRlKSxcclxuICAgICAgICBcIlRlbGVwaG9uZVwiOiAkLmV4dGVuZCh7IFwic3ltYm9sXCI6IFwiY2lyY2xlXCIgfSwgbWFya2VyVGVtcGxhdGUpLFxyXG4gICAgICAgIFwiSG9zcGl0YWwgYWRtaXNzaW9uXCI6ICQuZXh0ZW5kKHsgXCJzeW1ib2xcIjogXCJ0cmlhbmdsZVwiIH0sIG1hcmtlclRlbXBsYXRlKVxyXG4gICAgICB9O1xyXG4gICAgICB2YXIgY29udGFjdFNlcmllcyA9IHt9O1xyXG4gICAgICB2YXIgZXZlbnRTZXJpZXMgPSB7fTtcclxuICAgICAgJC5lYWNoKGNvbnRhY3RzLCBmdW5jdGlvbihpLCBjb250YWN0KSB7XHJcbiAgICAgICAgaWYgKCFjb250YWN0U2VyaWVzW2NvbnRhY3QubmFtZV0pIHtcclxuICAgICAgICAgIGNvbnRhY3RTZXJpZXNbY29udGFjdC5uYW1lXSA9IEhpZ2hjaGFydHMuZXh0ZW5kKGNvbnRhY3QsIHtcclxuICAgICAgICAgICAgZGF0YTogW10sXHJcbiAgICAgICAgICAgIHR5cGU6ICdzY2F0dGVyJyxcclxuICAgICAgICAgICAgbWFya2VyOiBtYXJrZXJzW2NvbnRhY3QubmFtZV0gfHwgbWFya2Vycy5kZWZhdWx0LFxyXG4gICAgICAgICAgICBjb2xvcjogY29sb3VyLm5leHQoKVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnRhY3RTZXJpZXNbY29udGFjdC5uYW1lXS5kYXRhLnB1c2goW1xyXG4gICAgICAgICAgICAgIGNvbnRhY3QudGFzayxcclxuICAgICAgICAgICAgICBjb250YWN0LnRpbWVcclxuICAgICAgICAgIF0pO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgICQuZWFjaChpbXBvcnRhbnRDb2RlcywgZnVuY3Rpb24oaSwgZXZlbnQpIHtcclxuICAgICAgICBpZiAoIWV2ZW50U2VyaWVzW2V2ZW50Lm5hbWVdKSB7XHJcbiAgICAgICAgICBldmVudFNlcmllc1tldmVudC5uYW1lXSA9IEhpZ2hjaGFydHMuZXh0ZW5kKGV2ZW50LCB7XHJcbiAgICAgICAgICAgIGRhdGE6IFtdLFxyXG4gICAgICAgICAgICB0eXBlOiAnc2NhdHRlcicsXHJcbiAgICAgICAgICAgIG1hcmtlcjogbWFya2Vyc1tldmVudC5uYW1lXSB8fCBtYXJrZXJzLmRlZmF1bHQsXHJcbiAgICAgICAgICAgIGNvbG9yOiBjb2xvdXIubmV4dCgpXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZXZlbnRTZXJpZXNbZXZlbnQubmFtZV0uZGF0YS5wdXNoKFtcclxuICAgICAgICAgICAgICBldmVudC50YXNrLFxyXG4gICAgICAgICAgICAgIGV2ZW50LnRpbWVcclxuICAgICAgICAgIF0pO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHNlcmllcyA9IHNlcmllcy5jb25jYXQoT2JqZWN0LmtleXMoY29udGFjdFNlcmllcykubWFwKGZ1bmN0aW9uKGtleSkge1xyXG4gICAgICAgIHJldHVybiBjb250YWN0U2VyaWVzW2tleV07XHJcbiAgICAgIH0pKTtcclxuXHJcbiAgICAgIHNlcmllcyA9IHNlcmllcy5jb25jYXQoT2JqZWN0LmtleXMoZXZlbnRTZXJpZXMpLm1hcChmdW5jdGlvbihrZXkpIHtcclxuICAgICAgICByZXR1cm4gZXZlbnRTZXJpZXNba2V5XTtcclxuICAgICAgfSkpO1xyXG5cclxuICAgICAgJChlbGVtZW50SWQpLmFwcGVuZCgkKCc8ZGl2IGNsYXNzPVwiY2hhcnQtdGl0bGVcIj5QYXRpZW50IGNvbmRpdGlvbnMgYW5kIGNvbnRhY3RzPC9kaXY+JykpO1xyXG4gICAgICAvLyBjcmVhdGUgdGhlIGNoYXJ0XHJcbiAgICAgICQoJzxkaXYgY2xhc3M9XCJoLWNoYXJ0IGgtY29uZGl0aW9uLWNoYXJ0XCI+JylcclxuICAgICAgICAuYXBwZW5kVG8oZWxlbWVudElkKVxyXG4gICAgICAgIC5oaWdoY2hhcnRzKHtcclxuXHJcbiAgICAgICAgICBjaGFydDoge1xyXG4gICAgICAgICAgICByZW5kZXJUbzogZWxlbWVudCxcclxuICAgICAgICAgICAgbWFyZ2luTGVmdDogMTIwLCAvLyBLZWVwIGFsbCBjaGFydHMgbGVmdCBhbGlnbmVkXHJcbiAgICAgICAgICAgIHNwYWNpbmdUb3A6IDIwLFxyXG4gICAgICAgICAgICBzcGFjaW5nQm90dG9tOiAyMCxcclxuICAgICAgICAgICAgdHlwZTogJ2NvbHVtbnJhbmdlJyxcclxuICAgICAgICAgICAgaW52ZXJ0ZWQ6IHRydWUsXHJcbiAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogJyNGOUYzRjknLFxyXG4gICAgICAgICAgICBib3JkZXJXaWR0aDogMixcclxuICAgICAgICAgICAgYm9yZGVyQ29sb3I6ICcjZGRkJ1xyXG4gICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICB0aXRsZTogJycsXHJcblxyXG4gICAgICAgICAgeUF4aXM6IHtcclxuICAgICAgICAgICAgdHlwZTogJ2RhdGV0aW1lJyxcclxuICAgICAgICAgICAgbWluOiBEYXRlLlVUQygyMDA1LCA2LCAxMiksXHJcbiAgICAgICAgICAgIG1heDogbmV3IERhdGUoKS5nZXRUaW1lKCksXHJcbiAgICAgICAgICAgIGNyb3NzaGFpcjogdHJ1ZSxcclxuICAgICAgICAgICAgZXZlbnRzOiB7XHJcbiAgICAgICAgICAgICAgc2V0RXh0cmVtZXM6IHN5bmNFeHRyZW1lc1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBsYWJlbHM6IHtcclxuICAgICAgICAgICAgICBlbmFibGVkOiBmYWxzZVxyXG4gICAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgICAgLy90aGluZ3MgdGhhdCBhcmUgbm9ybWFsbHkgeEF4aXMgZGVmYXVsdHNcclxuICAgICAgICAgICAgZW5kT25UaWNrOiBmYWxzZSxcclxuICAgICAgICAgICAgZ3JpZExpbmVXaWR0aDogMCxcclxuICAgICAgICAgICAgbGluZVdpZHRoOiAxLFxyXG4gICAgICAgICAgICBtYXhQYWRkaW5nOiAwLjAxLFxyXG4gICAgICAgICAgICBtaW5QYWRkaW5nOiAwLjAxLFxyXG4gICAgICAgICAgICBzdGFydE9uVGljazogZmFsc2UsXHJcbiAgICAgICAgICAgIHRpY2tXaWR0aDogMCxcclxuICAgICAgICAgICAgdGl0bGU6IHtcclxuICAgICAgICAgICAgICB0ZXh0OiAnJ1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB0aWNrUGl4ZWxJbnRlcnZhbDogMTAwXHJcbiAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgIHhBeGlzOiB7XHJcbiAgICAgICAgICAgIGxhYmVsczoge1xyXG4gICAgICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHN0YXJ0T25UaWNrOiBmYWxzZSxcclxuICAgICAgICAgICAgZW5kT25UaWNrOiBmYWxzZSxcclxuICAgICAgICAgICAgdGl0bGU6IHtcclxuICAgICAgICAgICAgICB0ZXh0OiAnJ1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB0aWNrV2lkdGg6IDAsXHJcbiAgICAgICAgICAgIG1pblBhZGRpbmc6IDAuMixcclxuICAgICAgICAgICAgbWF4UGFkZGluZzogMC4yLFxyXG5cclxuICAgICAgICAgICAgLy90aGluZ3MgdGhhdCBhcmUgbm9ybWFsbHkgeUF4aXMgZGVmYXVsdHNcclxuICAgICAgICAgICAgZ3JpZExpbmVXaWR0aDogMCxcclxuICAgICAgICAgICAgbGluZVdpZHRoOiAwXHJcblxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIGNyZWRpdHM6IHtcclxuICAgICAgICAgICAgZW5hYmxlZDogZmFsc2VcclxuICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgbGVnZW5kOiB7XHJcbiAgICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlXHJcbiAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgIHRvb2x0aXA6IHtcclxuICAgICAgICAgICAgZm9ybWF0dGVyOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICBpZiAodGhpcy5zZXJpZXMuZGF0YVswXS54ICE9PSAxICYmIHRoaXMuc2VyaWVzLmRhdGFbMF0ueCAhPT0gMikge1xyXG4gICAgICAgICAgICAgICAgLy9SYW5nZSBlcmdvIGNvbmRpdGlvblxyXG4gICAgICAgICAgICAgICAgdmFyIHlDb29yZCA9IHRoaXMueTtcclxuICAgICAgICAgICAgICAgIHZhciBsYWJlbFRtcCA9IGNvbmRpdGlvbnNbTWF0aC5mbG9vcih0aGlzLngpXS5pbnRlcnZhbHMuZmlsdGVyKGZ1bmN0aW9uKHYpIHtcclxuICAgICAgICAgICAgICAgICAgcmV0dXJuIHlDb29yZCA+PSB2LmZyb20gJiYgeUNvb3JkIDw9IHYudG87XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHZhciBsYWJlbCA9IGxhYmVsVG1wLmxlbmd0aCA+IDAgPyBsYWJlbFRtcFswXS5sYWJlbCA6IFwiTm8gbGFiZWwgQVwiO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICc8Yj4nICsgY29uZGl0aW9uc1tNYXRoLmZsb29yKHRoaXMueCldLm5hbWUgKyAobGFiZWwgPyAnOiAnICsgbGFiZWwgOiAnJykgKyAnPC9iPjxici8+JyArXHJcbiAgICAgICAgICAgICAgICAgIEhpZ2hjaGFydHMuZGF0ZUZvcm1hdCgnJVk6JW06JWQnLCB0aGlzLnBvaW50Lm9wdGlvbnMubG93KSArXHJcbiAgICAgICAgICAgICAgICAgICcgLSAnICsgSGlnaGNoYXJ0cy5kYXRlRm9ybWF0KCclWTolbTolZCcsIHRoaXMucG9pbnQub3B0aW9ucy5oaWdoKTtcclxuICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy9TaW5nbGUgdmFsdWUgaGVuY2UgY29udGFjdFxyXG4gICAgICAgICAgICAgICAgdmFyIHRpbWUgPSB0aGlzLnk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gKHRoaXMuc2VyaWVzLmRhdGFbMF0ueCA9PT0gMSA/IGltcG9ydGFudENvZGVzIDogY29udGFjdHMpLmZpbHRlcihmdW5jdGlvbih2YWwpIHtcclxuICAgICAgICAgICAgICAgICAgcmV0dXJuIHZhbC5kYXRhICYmIHZhbC5kYXRhLmZpbHRlcihmdW5jdGlvbih2KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZbMV0gPT09IHRpbWU7XHJcbiAgICAgICAgICAgICAgICAgIH0pLmxlbmd0aCA+IDA7XHJcbiAgICAgICAgICAgICAgICB9KS5tYXAoZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgICAgICAgICAgICAgIHJldHVybiAnPGI+JyArIHZhbC5uYW1lICsgJzwvYj48YnIvPicgKyBIaWdoY2hhcnRzLmRhdGVGb3JtYXQoJyVZOiVtOiVkJywgdGltZSk7XHJcbiAgICAgICAgICAgICAgICB9KS5qb2luKCc8YnIvPicpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZm9sbG93UG9pbnRlcjogdHJ1ZVxyXG4gICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICBwbG90T3B0aW9uczoge1xyXG4gICAgICAgICAgICBjb2x1bW5yYW5nZToge1xyXG4gICAgICAgICAgICAgIGdyb3VwaW5nOiBmYWxzZSxcclxuICAgICAgICAgICAgICAvKmdyb3VwUGFkZGluZzogMC4zLCovXHJcbiAgICAgICAgICAgICAgZGF0YUxhYmVsczoge1xyXG4gICAgICAgICAgICAgICAgYWxsb3dPdmVybGFwOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgZW5hYmxlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGZvcm1hdHRlcjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgIHZhciB5Q29vcmQgPSB0aGlzLnk7XHJcbiAgICAgICAgICAgICAgICAgIHZhciBpZHggPSAtMTtcclxuICAgICAgICAgICAgICAgICAgdmFyIGxhYmVsVG1wID0gY29uZGl0aW9uc1tNYXRoLmZsb29yKHRoaXMueCldLmludGVydmFscy5maWx0ZXIoZnVuY3Rpb24odiwgaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh5Q29vcmQgPj0gdi5mcm9tICYmIHlDb29yZCA8PSB2LnRvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICBpZHggPSBpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgIHZhciBsYWJlbCA9IGxhYmVsVG1wLmxlbmd0aCA+IDAgPyBsYWJlbFRtcFswXS5sYWJlbCA6IFwiTm8gbGFiZWwgQlwiO1xyXG4gICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy55ID09PSB0aGlzLnBvaW50LmxvdyAmJlxyXG4gICAgICAgICAgICAgICAgICAgIChjb25kaXRpb25zW01hdGguZmxvb3IodGhpcy54KV0uaW50ZXJ2YWxzLmxlbmd0aCAtIDEgPT09IGlkeCB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgKHRoaXMuc2VyaWVzLmNoYXJ0LnlBeGlzWzBdLm1pbiA8PSB5Q29vcmQgJiYgdGhpcy5zZXJpZXMuY2hhcnQueUF4aXNbMF0ubWF4ID49IHlDb29yZCkgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICh0aGlzLnNlcmllcy5jaGFydC55QXhpc1swXS5taW4gPj0gdGhpcy5wb2ludC5sb3cgJiYgdGhpcy5zZXJpZXMuY2hhcnQueUF4aXNbMF0ubWF4IDw9IHRoaXMucG9pbnQuaGlnaCkpID8gY29uZGl0aW9uc1tNYXRoLmZsb29yKHRoaXMueCldLm5hbWUgKyAobGFiZWwgPyAnOiAnICsgbGFiZWwgOiAnJykgOiAnJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgc2VyaWVzOiBzZXJpZXNcclxuXHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBwbG90TWVhc3VyZW1lbnRzID0gZnVuY3Rpb24obWVhc3VyZW1lbnRzKSB7XHJcbiAgICAgICQoZWxlbWVudElkKS5hcHBlbmQoJCgnPGRpdiBjbGFzcz1cImNoYXJ0LXRpdGxlXCI+UGF0aWVudCBtZWFzdXJlbWVudHM8L2Rpdj4nKSk7XHJcbiAgICAgICQuZWFjaChtZWFzdXJlbWVudHMsIGZ1bmN0aW9uKGksIGRhdGFzZXQpIHtcclxuICAgICAgICBsbC5jaGFydHMrKztcclxuICAgICAgICAvLyBBZGQgWCB2YWx1ZXNcclxuICAgICAgICAvKmlmIChkYXRhc2V0LmRhdGEgJiYgdHlwZW9mIGRhdGFzZXQuZGF0YVswXSAhPT0gXCJvYmplY3RcIikge1xyXG4gICAgICAgICAgZGF0YXNldC5kYXRhID0gSGlnaGNoYXJ0cy5tYXAoZGF0YXNldC5kYXRhLCBmdW5jdGlvbih2YWwsIGopIHtcclxuICAgICAgICAgICAgcmV0dXJuIFttZWFzdXJlbWVudHMueERhdGFbal0sIHZhbF07XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9Ki9cclxuXHJcbiAgICAgICAgdmFyIGNoYXJ0T3B0aW9ucyA9IHtcclxuICAgICAgICAgIGNoYXJ0OiB7XHJcbiAgICAgICAgICAgIG1hcmdpbkxlZnQ6IDEyMCwgLy8gS2VlcCBhbGwgY2hhcnRzIGxlZnQgYWxpZ25lZFxyXG4gICAgICAgICAgICBzcGFjaW5nVG9wOiAwLFxyXG4gICAgICAgICAgICBzcGFjaW5nQm90dG9tOiA4LFxyXG4gICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6ICcjRjlGOUYzJyxcclxuICAgICAgICAgICAgYm9yZGVyV2lkdGg6IDIsXHJcbiAgICAgICAgICAgIGJvcmRlckNvbG9yOiAnI2RkZCdcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICB0aXRsZToge1xyXG4gICAgICAgICAgICB0ZXh0OiAnJyxcclxuICAgICAgICAgICAgYWxpZ246ICdsZWZ0JyxcclxuICAgICAgICAgICAgbWFyZ2luOiAwLFxyXG4gICAgICAgICAgICB4OiAzMFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIG1hcmtlcjoge1xyXG4gICAgICAgICAgICBlbmFibGVkOiB0cnVlXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgY3JlZGl0czoge1xyXG4gICAgICAgICAgICBlbmFibGVkOiBmYWxzZVxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIGxlZ2VuZDoge1xyXG4gICAgICAgICAgICBlbmFibGVkOiBmYWxzZVxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHhBeGlzOiB7XHJcbiAgICAgICAgICAgIHR5cGU6ICdkYXRldGltZScsXHJcbiAgICAgICAgICAgIG1pbjogRGF0ZS5VVEMoMjAwNSwgNiwgMTIpLFxyXG4gICAgICAgICAgICBtYXg6IG5ldyBEYXRlKCkuZ2V0VGltZSgpLFxyXG4gICAgICAgICAgICBjcm9zc2hhaXI6IHtcclxuICAgICAgICAgICAgICBzbmFwOiBmYWxzZVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBldmVudHM6IHtcclxuICAgICAgICAgICAgICBzZXRFeHRyZW1lczogc3luY0V4dHJlbWVzXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGxhYmVsczoge1xyXG4gICAgICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGxpbmVXaWR0aDogMCxcclxuICAgICAgICAgICAgbWlub3JHcmlkTGluZVdpZHRoOiAwLFxyXG4gICAgICAgICAgICBsaW5lQ29sb3I6ICd0cmFuc3BhcmVudCcsXHJcbiAgICAgICAgICAgIG1pbm9yVGlja0xlbmd0aDogMCxcclxuICAgICAgICAgICAgdGlja0xlbmd0aDogMFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHlBeGlzOiB7XHJcbiAgICAgICAgICAgIHRpdGxlOiB7XHJcbiAgICAgICAgICAgICAgdGV4dDogZGF0YXNldC5uYW1lICsgXCI8YnI+XCIgKyBkYXRhc2V0LnVuaXQucmVwbGFjZSgvXFxeKFswLTldKykvLCBcIjxzdXA+JDE8L3N1cD5cIikgKyBcIlwiLFxyXG4gICAgICAgICAgICAgIG1hcmdpbjogNjAsXHJcbiAgICAgICAgICAgICAgcm90YXRpb246IDBcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc3RhcnRPblRpY2s6IGZhbHNlLFxyXG4gICAgICAgICAgICBlbmRPblRpY2s6IGZhbHNlLFxyXG4gICAgICAgICAgICBsYWJlbHM6IHtcclxuICAgICAgICAgICAgICBzdHlsZToge1xyXG4gICAgICAgICAgICAgICAgXCJ0ZXh0T3ZlcmZsb3dcIjogXCJub25lXCJcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHRpY2tQaXhlbEludGVydmFsOiAyNSxcclxuICAgICAgICAgICAgbWF4UGFkZGluZzogMC4xLFxyXG4gICAgICAgICAgICBtaW5QYWRkaW5nOiAwLjFcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICB0b29sdGlwOiB7XHJcbiAgICAgICAgICAgIHBvc2l0aW9uZXI6IGZ1bmN0aW9uKGxhYmVsV2lkdGgsIGxhYmVsSGVpZ2h0LCBwb2ludCkge1xyXG4gICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICB4OiBNYXRoLm1heCg1MCwgcG9pbnQucGxvdFggLSBsYWJlbFdpZHRoKSwgLy8gbGVmdCBhbGlnbmVkXHJcbiAgICAgICAgICAgICAgICB5OiAtMSAvLyBhbGlnbiB0byB0aXRsZVxyXG4gICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHVzZUhUTUw6IHRydWUsXHJcbiAgICAgICAgICAgIHBvaW50Rm9ybWF0OiAnPGI+JyArIGRhdGFzZXQubmFtZSArICc6PC9iPiB7cG9pbnQueX0gJyArIGRhdGFzZXQudW5pdC5yZXBsYWNlKC9cXF4oWzAtOV0rKS8sIFwiPHN1cD4kMTwvc3VwPlwiKSxcclxuICAgICAgICAgICAgdmFsdWVEZWNpbWFsczogZGF0YXNldC52YWx1ZURlY2ltYWxzXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgcGxvdE9wdGlvbnM6IHtcclxuICAgICAgICAgICAgc2VyaWVzOiB7XHJcbiAgICAgICAgICAgICAgZXZlbnRzOiB7XHJcbiAgICAgICAgICAgICAgICBtb3VzZU91dDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgIHZhciBjaGFydCwgaTtcclxuICAgICAgICAgICAgICAgICAgZm9yIChpID0gMTsgaSA8IGxsLmNoYXJ0QXJyYXkubGVuZ3RoIC0gMjsgaSA9IGkgKyAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhcnQgPSBsbC5jaGFydEFycmF5W2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYXJ0LnRvb2x0aXAuaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgc2VyaWVzOiBbe1xyXG4gICAgICAgICAgICBkYXRhOiBkYXRhc2V0LmRhdGEsXHJcbiAgICAgICAgICAgIG5hbWU6IGRhdGFzZXQubmFtZSxcclxuICAgICAgICAgICAgdHlwZTogZGF0YXNldC50eXBlLFxyXG4gICAgICAgICAgICBjb2xvcjogY29sb3VyLm5leHQoKSxcclxuICAgICAgICAgICAgZmlsbE9wYWNpdHk6IDAuM1xyXG4gICAgICAgICAgICB9XVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGlmIChkYXRhc2V0Lm5hbWUgPT09IFwiQlBcIikge1xyXG4gICAgICAgICAgY2hhcnRPcHRpb25zLnRvb2x0aXAucG9pbnRGb3JtYXQgPSBcIjxiPkJQOjwvYj4ge3BvaW50Lmxvd30ve3BvaW50LmhpZ2h9IG1tSGc8YnIvPlwiO1xyXG4gICAgICAgICAgLy9jaGFydE9wdGlvbnMuc2VyaWVzWzBdLnRvb2x0aXAgPSB7fTtcclxuICAgICAgICAgIGNoYXJ0T3B0aW9ucy5zZXJpZXNbMF0uc3RlbVdpZHRoID0gMztcclxuICAgICAgICAgIGNoYXJ0T3B0aW9ucy5zZXJpZXNbMF0ud2hpc2tlcldpZHRoID0gNTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qaWYgKGkgPT09IDApIHtcclxuICAgICAgICAgIGNoYXJ0T3B0aW9ucy50aXRsZSA9IHtcclxuICAgICAgICAgICAgdGV4dDogJ1BhdGllbnQgbWVhc3VyZW1lbnRzJyxcclxuICAgICAgICAgICAgYWxpZ246ICdsZWZ0JyxcclxuICAgICAgICAgICAgbWFyZ2luOiAxLFxyXG4gICAgICAgICAgICBzdHlsZToge1xyXG4gICAgICAgICAgICAgIGNvbG9yOiBcIiMzMzMzMzNcIixcclxuICAgICAgICAgICAgICBmb250U2l6ZTogXCIxMnB4XCIsXHJcbiAgICAgICAgICAgICAgZm9udFdlaWdodDogXCJib2xkXCJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfTtcclxuICAgICAgICB9Ki9cclxuXHJcbiAgICAgICAgLyppZiAoaSA9PT0gbWVhc3VyZW1lbnRzLmRhdGFzZXRzLmxlbmd0aCAtIDEpIHtcclxuICAgICAgICAgIGNoYXJ0T3B0aW9ucy54QXhpcyA9IHtcclxuICAgICAgICAgICAgY3Jvc3NoYWlyOiB0cnVlLFxyXG4gICAgICAgICAgICBldmVudHM6IHtcclxuICAgICAgICAgICAgICBzZXRFeHRyZW1lczogc3luY0V4dHJlbWVzXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHR5cGU6ICdkYXRldGltZSdcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgfSovXHJcbiAgICAgICAgJCgnPGRpdiBjbGFzcz1cInN5bmMtY2hhcnQgaC1jaGFydCcgKyAoaSA9PT0gbWVhc3VyZW1lbnRzLmxlbmd0aCAtIDEgPyBcIiBoLWxhc3QtbWVhc3VyZW1lbnQtY2hhcnRcIiA6IFwiXCIpICsgJ1wiPicpXHJcbiAgICAgICAgICAuYXBwZW5kVG8oZWxlbWVudElkKVxyXG4gICAgICAgICAgLmhpZ2hjaGFydHMoY2hhcnRPcHRpb25zKTtcclxuXHJcbiAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgcGxvdE5hdmlnYXRvciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICBsbC5jaGFydHMrKztcclxuICAgICAgdmFyIGNoYXJ0ID0gJCgnPGRpdiBjbGFzcz1cImgtY2hhcnQgaC1uYXZpZ2F0b3ItY2hhcnRcIj4nKVxyXG4gICAgICAgIC5hcHBlbmRUbyhlbGVtZW50SWQpXHJcbiAgICAgICAgLmhpZ2hjaGFydHMoe1xyXG5cclxuICAgICAgICAgIGNoYXJ0OiB7XHJcbiAgICAgICAgICAgIHJlbmRlclRvOiBlbGVtZW50LFxyXG4gICAgICAgICAgICBtYXJnaW5MZWZ0OiAxMjAsIC8vIEtlZXAgYWxsIGNoYXJ0cyBsZWZ0IGFsaWduZWRcclxuICAgICAgICAgICAgc3BhY2luZ1RvcDogMjAsXHJcbiAgICAgICAgICAgIHNwYWNpbmdCb3R0b206IDIwLFxyXG4gICAgICAgICAgICBpZ25vcmVIaWRkZW5TZXJpZXM6IGZhbHNlLFxyXG4gICAgICAgICAgICBib3JkZXJXaWR0aDogMixcclxuICAgICAgICAgICAgYm9yZGVyQ29sb3I6ICcjZGRkJ1xyXG4gICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICB0aXRsZToge1xyXG4gICAgICAgICAgICB0ZXh0OiAnJ1xyXG4gICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICB4QXhpczoge1xyXG4gICAgICAgICAgICB0eXBlOiAnZGF0ZXRpbWUnLFxyXG4gICAgICAgICAgICBtaW46IERhdGUuVVRDKDIwMDUsIDYsIDEyKSxcclxuICAgICAgICAgICAgbWF4OiBuZXcgRGF0ZSgpLmdldFRpbWUoKSxcclxuICAgICAgICAgICAgY3Jvc3NoYWlyOiBmYWxzZSxcclxuICAgICAgICAgICAgZXZlbnRzOiB7XHJcbiAgICAgICAgICAgICAgc2V0RXh0cmVtZXM6IHN5bmNFeHRyZW1lc1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBsYWJlbHM6IHtcclxuICAgICAgICAgICAgICBlbmFibGVkOiBmYWxzZVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBsaW5lV2lkdGg6IDAsXHJcbiAgICAgICAgICAgIG1pbm9yR3JpZExpbmVXaWR0aDogMCxcclxuICAgICAgICAgICAgbGluZUNvbG9yOiAndHJhbnNwYXJlbnQnLFxyXG4gICAgICAgICAgICBtaW5vclRpY2tMZW5ndGg6IDAsXHJcbiAgICAgICAgICAgIHRpY2tMZW5ndGg6IDBcclxuICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgeUF4aXM6IHtcclxuICAgICAgICAgICAgbWluOiAwLFxyXG4gICAgICAgICAgICBtYXg6IDEsXHJcbiAgICAgICAgICAgIHRpY2tJbnRlcnZhbDogMSxcclxuICAgICAgICAgICAgc3RhcnRPblRpY2s6IGZhbHNlLFxyXG4gICAgICAgICAgICBlbmRPblRpY2s6IGZhbHNlLFxyXG4gICAgICAgICAgICB0aXRsZToge1xyXG4gICAgICAgICAgICAgIHRleHQ6ICcnXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIG1pblBhZGRpbmc6IDAuMixcclxuICAgICAgICAgICAgbWF4UGFkZGluZzogMC4yLFxyXG4gICAgICAgICAgICBsYWJlbHM6IHtcclxuICAgICAgICAgICAgICBlbmFibGVkOiBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgIGxlZ2VuZDoge1xyXG4gICAgICAgICAgICBlbmFibGVkOiBmYWxzZVxyXG4gICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICBuYXZpZ2F0b3I6IHtcclxuICAgICAgICAgICAgZW5hYmxlZDogdHJ1ZVxyXG4gICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICBwbG90T3B0aW9uczoge1xyXG4gICAgICAgICAgICBsaW5lOiB7XHJcbiAgICAgICAgICAgICAgbGluZVdpZHRoOiAwLFxyXG4gICAgICAgICAgICAgIG1hcmtlcjoge1xyXG4gICAgICAgICAgICAgICAgZW5hYmxlZDogZmFsc2VcclxuICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgIGRhdGFMYWJlbHM6IHtcclxuICAgICAgICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlXHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgIHNlcmllczogW3tcclxuICAgICAgICAgICAgXCJuYW1lXCI6IFwiSFROXCIsXHJcbiAgICAgICAgICAgIFwiZGF0YVwiOiBbe1xyXG4gICAgICAgICAgICAgIFwieFwiOiAxMzczNTg3MjAwMDAwLFxyXG4gICAgICAgICAgICAgIFwieVwiOiAwLFxyXG4gICAgICAgICAgICAgIFwiZnJvbVwiOiAxMzczNTg3MjAwMDAwLFxyXG4gICAgICAgICAgICAgIFwidG9cIjogMTQ1OTgxNDQwMDAwMFxyXG4gICAgICAgICAgICAgIH1dXHJcbiAgICAgICAgICAgIH1dXHJcblxyXG4gICAgICAgIH0pO1xyXG4gICAgICBjaGFydC5oaWdoY2hhcnRzKCkuc2VyaWVzWzBdLmhpZGUoKTtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIHBsb3RNZWRpY2F0aW9ucyA9IGZ1bmN0aW9uKG1lZGljYXRpb25zKSB7XHJcbiAgICAgIGxsLmNoYXJ0cysrO1xyXG4gICAgICB2YXIgc2VyaWVzID0gW107XHJcbiAgICAgICQuZWFjaChtZWRpY2F0aW9ucy5yZXZlcnNlKCksIGZ1bmN0aW9uKGksIHRhc2spIHtcclxuICAgICAgICB2YXIgaXRlbSA9IHtcclxuICAgICAgICAgIG5hbWU6IHRhc2submFtZSxcclxuICAgICAgICAgIGRhdGE6IFtdLFxyXG4gICAgICAgICAgY29sb3I6IGNvbG91ci5uZXh0KClcclxuICAgICAgICB9O1xyXG4gICAgICAgICQuZWFjaCh0YXNrLmludGVydmFscywgZnVuY3Rpb24oaiwgaW50ZXJ2YWwpIHtcclxuICAgICAgICAgIGl0ZW0uZGF0YS5wdXNoKFtpICsgMC40OSwgaW50ZXJ2YWwuZnJvbSwgaW50ZXJ2YWwudG9dKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgc2VyaWVzLnB1c2goaXRlbSk7XHJcbiAgICAgIH0pO1xyXG4gICAgICB2YXIgbm9EYXRhID0gZmFsc2U7XHJcbiAgICAgIGlmIChzZXJpZXMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgc2VyaWVzLnB1c2goe1xyXG4gICAgICAgICAgdHlwZTogJ2xpbmUnLFxyXG4gICAgICAgICAgbmFtZTogJ1JhbmRvbSBkYXRhJyxcclxuICAgICAgICAgIGRhdGE6IFtdXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgbm9EYXRhID0gdHJ1ZTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8kKGVsZW1lbnRJZCkuYXBwZW5kKCQoJzxkaXYgY2xhc3M9XCJjaGFydC10aXRsZVwiJyArIChub0RhdGEgPyAnc3R5bGU9XCJkaXNwbGF5Om5vbmVcIicgOiAnJykgKyAnPlBhdGllbnQgbWVkaWNhdGlvbnM8L2Rpdj4nKSk7XHJcbiAgICAgICQoZWxlbWVudElkKS5hcHBlbmQoJCgnPGRpdiBjbGFzcz1cImNoYXJ0LXRpdGxlXCI+UGF0aWVudCBtZWRpY2F0aW9uczwvZGl2PicpKTtcclxuICAgICAgLy8gY3JlYXRlIHRoZSBjaGFydFxyXG4gICAgICAvL3JldHVybiAkKCc8ZGl2IGNsYXNzPVwiaC1jaGFydCBoLW1lZGljYXRpb24tY2hhcnRcIicgKyAobm9EYXRhID8gJ3N0eWxlPVwiZGlzcGxheTpub25lXCInIDogJycpICsgJz4nKVxyXG4gICAgICByZXR1cm4gJCgnPGRpdiBjbGFzcz1cImgtY2hhcnQgaC1tZWRpY2F0aW9uLWNoYXJ0XCI+JylcclxuICAgICAgICAuYXBwZW5kVG8oZWxlbWVudElkKVxyXG4gICAgICAgIC5oaWdoY2hhcnRzKHtcclxuXHJcbiAgICAgICAgICBjaGFydDoge1xyXG4gICAgICAgICAgICByZW5kZXJUbzogZWxlbWVudCxcclxuICAgICAgICAgICAgbWFyZ2luTGVmdDogMTIwLCAvLyBLZWVwIGFsbCBjaGFydHMgbGVmdCBhbGlnbmVkXHJcbiAgICAgICAgICAgIHNwYWNpbmdUb3A6IDIwLFxyXG4gICAgICAgICAgICBzcGFjaW5nQm90dG9tOiAyMCxcclxuICAgICAgICAgICAgdHlwZTogJ2NvbHVtbnJhbmdlJyxcclxuICAgICAgICAgICAgaW52ZXJ0ZWQ6IHRydWUsXHJcbiAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogJyNGM0Y5RjknXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgbGFuZzoge1xyXG4gICAgICAgICAgICBub0RhdGE6IFwiTm8gcmVsZXZhbnQgbWVkaWNhdGlvbnNcIlxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIG5vRGF0YToge1xyXG4gICAgICAgICAgICBzdHlsZToge1xyXG4gICAgICAgICAgICAgIGZvbnRXZWlnaHQ6ICdib2xkJyxcclxuICAgICAgICAgICAgICBmb250U2l6ZTogJzE1cHgnLFxyXG4gICAgICAgICAgICAgIGNvbG9yOiAnIzMwMzAzMCdcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICB0aXRsZTogJycsXHJcbiAgICAgICAgICAvKntcclxuICAgICAgICAgICAgICAgICAgICAgIHRleHQ6ICdQYXRpZW50IG1lZGljYXRpb25zJyxcclxuICAgICAgICAgICAgICAgICAgICAgIGFsaWduOiAnbGVmdCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICBtYXJnaW46IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICBzdHlsZToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogXCIjMzMzMzMzXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvbnRTaXplOiBcIjEycHhcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9udFdlaWdodDogXCJib2xkXCJcclxuICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LCovXHJcblxyXG5cclxuICAgICAgICAgIHlBeGlzOiB7XHJcbiAgICAgICAgICAgIHR5cGU6ICdkYXRldGltZScsXHJcbiAgICAgICAgICAgIG1pbjogRGF0ZS5VVEMoMjAwNSwgNiwgMTIpLFxyXG4gICAgICAgICAgICBtYXg6IG5ldyBEYXRlKCkuZ2V0VGltZSgpLFxyXG4gICAgICAgICAgICBjcm9zc2hhaXI6IHtcclxuICAgICAgICAgICAgICBzbmFwOiBmYWxzZVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBldmVudHM6IHtcclxuICAgICAgICAgICAgICBzZXRFeHRyZW1lczogc3luY0V4dHJlbWVzXHJcbiAgICAgICAgICAgIH0sXHJcblxyXG5cclxuXHJcbiAgICAgICAgICAgIC8vdGhpbmdzIHRoYXQgYXJlIG5vcm1hbGx5IHhBeGlzIGRlZmF1bHRzXHJcbiAgICAgICAgICAgIGVuZE9uVGljazogZmFsc2UsXHJcbiAgICAgICAgICAgIGdyaWRMaW5lV2lkdGg6IDAsXHJcbiAgICAgICAgICAgIGxpbmVXaWR0aDogMSxcclxuICAgICAgICAgICAgbWF4UGFkZGluZzogMC4wMSxcclxuICAgICAgICAgICAgbWluUGFkZGluZzogMC4wMSxcclxuICAgICAgICAgICAgc3RhcnRPblRpY2s6IGZhbHNlLFxyXG4gICAgICAgICAgICB0aWNrV2lkdGg6IDEsXHJcbiAgICAgICAgICAgIHRpdGxlOiB7XHJcbiAgICAgICAgICAgICAgdGV4dDogJydcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdGlja1BpeGVsSW50ZXJ2YWw6IDEwMFxyXG4gICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICB4QXhpczoge1xyXG4gICAgICAgICAgICBsYWJlbHM6IHtcclxuICAgICAgICAgICAgICBlbmFibGVkOiBmYWxzZVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBzdGFydE9uVGljazogZmFsc2UsXHJcbiAgICAgICAgICAgIGVuZE9uVGljazogZmFsc2UsXHJcbiAgICAgICAgICAgIHRpdGxlOiB7XHJcbiAgICAgICAgICAgICAgdGV4dDogJydcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdGlja1dpZHRoOiAwLFxyXG4gICAgICAgICAgICBtaW5QYWRkaW5nOiAwLjIsXHJcbiAgICAgICAgICAgIG1heFBhZGRpbmc6IDAuMixcclxuXHJcbiAgICAgICAgICAgIC8vdGhpbmdzIHRoYXQgYXJlIG5vcm1hbGx5IHlBeGlzIGRlZmF1bHRzXHJcbiAgICAgICAgICAgIGdyaWRMaW5lV2lkdGg6IDAsXHJcbiAgICAgICAgICAgIGxpbmVXaWR0aDogMFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIGNyZWRpdHM6IHtcclxuICAgICAgICAgICAgZW5hYmxlZDogZmFsc2VcclxuICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgbGVnZW5kOiB7XHJcbiAgICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlXHJcbiAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgIHRvb2x0aXA6IHtcclxuICAgICAgICAgICAgZm9ybWF0dGVyOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICB2YXIgeUNvb3JkID0gdGhpcy55O1xyXG4gICAgICAgICAgICAgIHZhciBsYWJlbFRtcCA9IG1lZGljYXRpb25zW01hdGguZmxvb3IodGhpcy54KV0uaW50ZXJ2YWxzLmZpbHRlcihmdW5jdGlvbih2KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4geUNvb3JkID49IHYuZnJvbSAmJiB5Q29vcmQgPD0gdi50bztcclxuICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICB2YXIgbGFiZWwgPSBsYWJlbFRtcC5sZW5ndGggPiAwID8gbGFiZWxUbXBbMF0ubGFiZWwgOiBcIk5vIGxhYmVsIENcIjtcclxuICAgICAgICAgICAgICByZXR1cm4gJzxiPicgKyBtZWRpY2F0aW9uc1tNYXRoLmZsb29yKHRoaXMueCldLm5hbWUgKyAobGFiZWwgPyAnOiAnICsgbGFiZWwgOiAnJykgKyAnPC9iPjxici8+JyArXHJcbiAgICAgICAgICAgICAgICBIaWdoY2hhcnRzLmRhdGVGb3JtYXQoJyVZOiVtOiVkJywgdGhpcy5wb2ludC5vcHRpb25zLmxvdykgK1xyXG4gICAgICAgICAgICAgICAgJyAtICcgKyBIaWdoY2hhcnRzLmRhdGVGb3JtYXQoJyVZOiVtOiVkJywgdGhpcy5wb2ludC5vcHRpb25zLmhpZ2gpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBmb2xsb3dQb2ludGVyOiB0cnVlXHJcbiAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgIHBsb3RPcHRpb25zOiB7XHJcbiAgICAgICAgICAgIGNvbHVtbnJhbmdlOiB7XHJcbiAgICAgICAgICAgICAgZ3JvdXBpbmc6IGZhbHNlLFxyXG4gICAgICAgICAgICAgIGRhdGFMYWJlbHM6IHtcclxuICAgICAgICAgICAgICAgIGFsbG93T3ZlcmxhcDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGVuYWJsZWQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBmb3JtYXR0ZXI6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICB2YXIgeUNvb3JkID0gdGhpcy55O1xyXG4gICAgICAgICAgICAgICAgICB2YXIgaWR4ID0gLTE7XHJcbiAgICAgICAgICAgICAgICAgIHZhciBsYWJlbFRtcCA9IG1lZGljYXRpb25zW01hdGguZmxvb3IodGhpcy54KV0uaW50ZXJ2YWxzLmZpbHRlcihmdW5jdGlvbih2LCBpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHlDb29yZCA+PSB2LmZyb20gJiYgeUNvb3JkIDw9IHYudG8pIHtcclxuICAgICAgICAgICAgICAgICAgICAgIGlkeCA9IGk7XHJcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgdmFyIGxhYmVsID0gbGFiZWxUbXAubGVuZ3RoID4gMCA/IGxhYmVsVG1wWzBdLmxhYmVsIDogXCJObyBsYWJlbCBEXCI7XHJcbiAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnkgPT09IHRoaXMucG9pbnQubG93ICYmXHJcbiAgICAgICAgICAgICAgICAgICAgKG1lZGljYXRpb25zW01hdGguZmxvb3IodGhpcy54KV0uaW50ZXJ2YWxzLmxlbmd0aCAtIDEgPT09IGlkeCB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgKHRoaXMuc2VyaWVzLmNoYXJ0LnlBeGlzWzBdLm1pbiA8PSB5Q29vcmQgJiYgdGhpcy5zZXJpZXMuY2hhcnQueUF4aXNbMF0ubWF4ID49IHlDb29yZCkgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICh0aGlzLnNlcmllcy5jaGFydC55QXhpc1swXS5taW4gPj0gdGhpcy5wb2ludC5sb3cgJiYgdGhpcy5zZXJpZXMuY2hhcnQueUF4aXNbMF0ubWF4IDw9IHRoaXMucG9pbnQuaGlnaCkpID8gbWVkaWNhdGlvbnNbTWF0aC5mbG9vcih0aGlzLngpXS5uYW1lICsgKGxhYmVsID8gJzogJyArIGxhYmVsIDogJycpIDogJyc7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgIHNlcmllczogc2VyaWVzXHJcblxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICBwbG90Q29uZGl0aW9ucyhkYXRhLmNvbmRpdGlvbnMsIGRhdGEuZXZlbnRzLCBkYXRhLmNvbnRhY3RzKTtcclxuICAgIHBsb3RNZWFzdXJlbWVudHMoZGF0YS5tZWFzdXJlbWVudHMpO1xyXG4gICAgdmFyIGMgPSBwbG90TWVkaWNhdGlvbnMoZGF0YS5tZWRpY2F0aW9ucyk7XHJcbiAgICBwbG90TmF2aWdhdG9yKCk7XHJcbiAgICBjLmhpZ2hjaGFydHMoKS5heGVzWzFdLnNldEV4dHJlbWVzKDE0MzQ4NjQwMDAwMDAsIDE0NTk4MTQ0MDAwMDAsIHVuZGVmaW5lZCwgZmFsc2UsIHtcclxuICAgICAgdHJpZ2dlcjogJ3N5bmNFeHRyZW1lcydcclxuICAgIH0pO1xyXG5cclxuICAgIGxsLmNoYXJ0QXJyYXkgPSBIaWdoY2hhcnRzLmNoYXJ0cy5zbGljZShIaWdoY2hhcnRzLmNoYXJ0cy5sZW5ndGggLSBsbC5jaGFydHMsIEhpZ2hjaGFydHMuY2hhcnRzLmxlbmd0aCk7XHJcblxyXG4gICAgdmFyIHMgPSBzeW5jRXh0cmVtZXMuYmluZChjLmhpZ2hjaGFydHMoKS5zZXJpZXNbMF0pO1xyXG4gICAgcyh7XHJcbiAgICAgIHRyaWdnZXI6ICduYXZpZ2F0b3InLFxyXG4gICAgICBtaW46IDE0MzQ4NjQwMDAwMDAsXHJcbiAgICAgIG1heDogMTQ1OTgxNDQwMDAwMFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gbGw7XHJcbiIsInZhciBiYXNlID0gcmVxdWlyZSgnLi4vYmFzZS5qcycpLFxyXG4gIGNvbmZpcm0gPSByZXF1aXJlKCcuL2NvbmZpcm0uanMnKSxcclxuICBkYXRhID0gcmVxdWlyZSgnLi4vZGF0YS5qcycpLFxyXG4gIGxvZyA9IHJlcXVpcmUoJy4uL2xvZy5qcycpO1xyXG5cclxudmFyIG1lZCA9IHtcclxuXHJcbiAgY3JlYXRlOiBmdW5jdGlvbihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCkge1xyXG4gICAgdmFyIG1lZGljYXRpb25zID0gZGF0YS5wYXRpZW50c1twYXRpZW50SWRdLm1lZGljYXRpb25zIHx8IFtdO1xyXG4gICAgdmFyIGFncmVlID0gbG9nLmdldFBhdGllbnRBZ3JlZU9iamVjdChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCwgXCJtZWRpY2F0aW9uXCIpO1xyXG4gICAgcmV0dXJuIGJhc2UuY3JlYXRlUGFuZWwobWVkaWNhdGlvblBhbmVsLCB7XHJcbiAgICAgIFwiYXJlTWVkaWNhdGlvbnNcIjogbWVkaWNhdGlvbnMubGVuZ3RoID4gMCxcclxuICAgICAgXCJhZ3JlZVwiOiBhZ3JlZSAmJiBhZ3JlZS5hZ3JlZSxcclxuICAgICAgXCJkaXNhZ3JlZVwiOiBhZ3JlZSAmJiBhZ3JlZS5hZ3JlZSA9PT0gZmFsc2UsXHJcbiAgICAgIFwicGF0aHdheVwiOiBkYXRhLnBhdGh3YXlOYW1lc1twYXRod2F5SWRdLFxyXG4gICAgICBcIm1lZGljYXRpb25zXCI6IG1lZGljYXRpb25zLFxyXG4gICAgICBcInBhdGh3YXlTdGFnZVwiOiBwYXRod2F5U3RhZ2VcclxuICAgIH0sIHtcclxuICAgICAgXCJtZWRpY2F0aW9uUm93XCI6ICQoJyNtZWRpY2F0aW9uLXJvdycpLmh0bWwoKVxyXG4gICAgfSk7XHJcbiAgfSxcclxuXHJcbiAgd2lyZVVwOiBmdW5jdGlvbihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCkge1xyXG4gICAgY29uZmlybS53aXJlVXAoJCgnI21lZGljYXRpb24tYWdyZWUtZGlzYWdyZWUnKSwgJCgnI21lZGljYXRpb24tcGFuZWwnKSwgcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQsIFwibWVkaWNhdGlvblwiLCBcIm1lZGljYXRpb24gZGF0YVwiKTtcclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBtZWQ7XHJcbiIsInZhciBiYXNlID0gcmVxdWlyZSgnLi4vYmFzZS5qcycpLFxyXG4gIGNvbmZpcm0gPSByZXF1aXJlKCcuL2NvbmZpcm0uanMnKSxcclxuICBkYXRhID0gcmVxdWlyZSgnLi4vZGF0YS5qcycpLFxyXG4gIGxvZyA9IHJlcXVpcmUoJy4uL2xvZy5qcycpO1xyXG5cclxudmFyIG90aGVyID0ge1xyXG5cclxuICBjcmVhdGU6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKSB7XHJcbiAgICB2YXIgY29kZXMgPSAoZGF0YS5wYXRpZW50c1twYXRpZW50SWRdLmNvZGVzIHx8IFtdKS5tYXAoZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgIHZhbC5kZXNjcmlwdGlvbiA9IGRhdGEuY29kZXNbdmFsLmNvZGVdO1xyXG4gICAgICByZXR1cm4gdmFsO1xyXG4gICAgfSk7XHJcbiAgICB2YXIgYWdyZWUgPSBsb2cuZ2V0UGF0aWVudEFncmVlT2JqZWN0KHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkLCBcImNvZGVzXCIpO1xyXG4gICAgcmV0dXJuIGJhc2UuY3JlYXRlUGFuZWwoJCgnI290aGVyLWNvZGVzLXBhbmVsJyksIHtcclxuICAgICAgXCJhcmVDb2Rlc1wiOiBjb2Rlcy5sZW5ndGggPiAwLFxyXG4gICAgICBcImFncmVlXCI6IGFncmVlICYmIGFncmVlLmFncmVlLFxyXG4gICAgICBcImRpc2FncmVlXCI6IGFncmVlICYmIGFncmVlLmFncmVlID09PSBmYWxzZSxcclxuICAgICAgXCJwYXRod2F5XCI6IGRhdGEucGF0aHdheU5hbWVzW3BhdGh3YXlJZF0sXHJcbiAgICAgIFwic3RhbmRhcmRcIjogZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS50YWIudGl0bGUsXHJcbiAgICAgIFwiY29kZXNcIjogY29kZXMsXHJcbiAgICAgIFwicGF0aHdheVN0YWdlXCI6IHBhdGh3YXlTdGFnZVxyXG4gICAgfSwge1xyXG4gICAgICBcImNvZGVSb3dcIjogJCgnI290aGVyLWNvZGVzLXJvdycpLmh0bWwoKVxyXG4gICAgfSk7XHJcbiAgfSxcclxuXHJcbiAgd2lyZVVwOiBmdW5jdGlvbihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCkge1xyXG4gICAgY29uZmlybS53aXJlVXAoJCgnI290aGVyLWNvZGVzLWFncmVlLWRpc2FncmVlJyksICQoJyNvdGhlci1jb2Rlcy1wYW5lbCcpLCBwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCwgXCJjb2Rlc1wiLCBcIm90aGVyIGNvZGVzXCIpO1xyXG4gIH1cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IG90aGVyO1xyXG4iLCJ2YXIgZGF0YSA9IHJlcXVpcmUoJy4uL2RhdGEuanMnKSxcclxuICBNdXN0YWNoZSA9IHJlcXVpcmUoJ211c3RhY2hlJyk7XHJcblxyXG52YXIgcGMgPSB7XHJcblxyXG4gIHNob3c6IGZ1bmN0aW9uKHBhbmVsLCBpc0FwcGVuZCwgcGF0aWVudElkKSB7XHJcblxyXG4gICAgdmFyIHBhdGllbnREYXRhID0gZGF0YS5nZXRQYXRpZW50RGF0YShwYXRpZW50SWQpO1xyXG5cclxuICAgIHZhciB0ZW1wTXVzdCA9ICQoJyNwYXRpZW50LWNoYXJhY3RlcmlzdGljcy1wYW5lbCcpLmh0bWwoKTtcclxuICAgIHZhciBodG1sID0gTXVzdGFjaGUucmVuZGVyKHRlbXBNdXN0LCBwYXRpZW50RGF0YS5jaGFyYWN0ZXJpc3RpY3MpO1xyXG5cclxuICAgIGlmIChpc0FwcGVuZCkgcGFuZWwuYXBwZW5kKGh0bWwpO1xyXG4gICAgZWxzZSBwYW5lbC5odG1sKGh0bWwpO1xyXG5cclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBwYztcclxuIiwidmFyIEhpZ2hjaGFydHMgPSByZXF1aXJlKCdoaWdoY2hhcnRzL2hpZ2hzdG9jaycpLFxyXG4gIGJhc2UgPSByZXF1aXJlKCcuLi9iYXNlLmpzJyksXHJcbiAgZGF0YSA9IHJlcXVpcmUoJy4uL2RhdGEuanMnKSxcclxuICBsb29rdXAgPSByZXF1aXJlKCcuLi9sb29rdXAuanMnKSxcclxuICBNdXN0YWNoZSA9IHJlcXVpcmUoJ211c3RhY2hlJyk7XHJcblxyXG52YXIgSUQgPSBcIlBBVElFTlRfTElTVFwiO1xyXG5cclxudmFyIHBsID0ge1xyXG5cclxuICB3aXJlVXA6IGZ1bmN0aW9uKG9uUGF0aWVudFNlbGVjdGVkKSB7XHJcbiAgICBwYXRpZW50c1BhbmVsID0gJCgnI3BhdGllbnRzJyk7XHJcblxyXG4gICAgcGF0aWVudHNQYW5lbC5vbignY2xpY2snLCAndGhlYWQgdHIgdGguc29ydGFibGUnLCBmdW5jdGlvbigpIHsgLy9Tb3J0IGNvbHVtbnMgd2hlbiBjb2x1bW4gaGVhZGVyIGNsaWNrZWRcclxuICAgICAgdmFyIHNvcnRBc2MgPSAhJCh0aGlzKS5oYXNDbGFzcygnc29ydC1hc2MnKTtcclxuICAgICAgaWYgKHNvcnRBc2MpIHtcclxuICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKCdzb3J0LWRlc2MnKS5hZGRDbGFzcygnc29ydC1hc2MnKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKCdzb3J0LWFzYycpLmFkZENsYXNzKCdzb3J0LWRlc2MnKTtcclxuICAgICAgfVxyXG4gICAgICBwbC5wb3B1bGF0ZShwbC5zdGF0ZVswXSwgcGwuc3RhdGVbMV0sIHBsLnN0YXRlWzJdLCBwbC5zdGF0ZVszXSwgJCh0aGlzKS5pbmRleCgpLCBzb3J0QXNjKTtcclxuICAgIH0pLm9uKCdjbGljaycsICd0Ym9keSB0cicsIGZ1bmN0aW9uKGUpIHsgLy9TZWxlY3QgaW5kaXZpZHVhbCBwYXRpZW50IHdoZW4gcm93IGNsaWNrZWQjXHJcbiAgICAgIHZhciBjYWxsYmFjayA9IG9uUGF0aWVudFNlbGVjdGVkLmJpbmQodGhpcyk7XHJcbiAgICAgIHZhciBwYXRpZW50SWQgPSAkKHRoaXMpLmZpbmQoJ3RkIGJ1dHRvbicpLmF0dHIoJ2RhdGEtcGF0aWVudC1pZCcpO1xyXG4gICAgICBjYWxsYmFjayhwYXRpZW50SWQpO1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICB9KS5vbignY2xpY2snLCAndGJvZHkgdHIgYnV0dG9uJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAvL2Rvbid0IHdhbnQgcm93IHNlbGVjdGVkIGlmIGp1c3QgYnV0dG9uIHByZXNzZWQ/XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIHNlbGVjdFN1YnNlY3Rpb246IGZ1bmN0aW9uKHNlY3Rpb24pIHtcclxuICAgIHBsLnBvcHVsYXRlKHBsLnN0YXRlWzBdLCBwbC5zdGF0ZVsxXSwgcGwuc3RhdGVbMl0sIHNlY3Rpb24sIHBsLnN0YXRlWzRdLCBwbC5zdGF0ZVs1XSk7XHJcbiAgfSxcclxuXHJcbiAgcG9wdWxhdGU6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgc3Vic2VjdGlvbiwgc29ydEZpZWxkLCBzb3J0QXNjKSB7XHJcbiAgICBwbC5zdGF0ZSA9IFtwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHN1YnNlY3Rpb24sIHNvcnRGaWVsZCwgc29ydEFzY107XHJcbiAgICBwYXRpZW50c1BhbmVsID0gJCgnI3BhdGllbnRzJyk7XHJcbiAgICAvL1JlbW92ZSBzY3JvbGwgaWYgZXhpc3RzXHJcbiAgICBwYXRpZW50c1BhbmVsLmZpbmQoJ2Rpdi50YWJsZS1zY3JvbGwnKS5nZXROaWNlU2Nyb2xsKCkucmVtb3ZlKCk7XHJcblxyXG4gICAgdmFyIGksIGssIHByb3AsIGhlYWRlciwgcExpc3QgPSBbXTtcclxuXHJcbiAgICBkYXRhLmdldEluZGljYXRvckRhdGEoW3BhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZF0uam9pbihcIi5cIiksIGZ1bmN0aW9uKGluZGljYXRvcnMpIHtcclxuXHJcbiAgICAgIGlmIChwYXRod2F5SWQgJiYgcGF0aHdheVN0YWdlICYmIHN0YW5kYXJkICYmIHN1YnNlY3Rpb24pIHtcclxuICAgICAgICBwTGlzdCA9IGluZGljYXRvcnMub3Bwb3J0dW5pdGllcy5maWx0ZXIoZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgICAgICByZXR1cm4gdmFsLm5hbWUgPT09IHN1YnNlY3Rpb247XHJcbiAgICAgICAgfSlbMF0ucGF0aWVudHM7XHJcbiAgICAgICAgaGVhZGVyID0gaW5kaWNhdG9ycy5vcHBvcnR1bml0aWVzLmZpbHRlcihmdW5jdGlvbih2YWwpIHtcclxuICAgICAgICAgIHJldHVybiB2YWwubmFtZSA9PT0gc3Vic2VjdGlvbjtcclxuICAgICAgICB9KVswXS5kZXNjcmlwdGlvbjtcclxuICAgICAgfSBlbHNlIGlmIChwYXRod2F5SWQgJiYgcGF0aHdheVN0YWdlICYmIHN0YW5kYXJkKSB7XHJcbiAgICAgICAgcExpc3QgPSBpbmRpY2F0b3JzLm9wcG9ydHVuaXRpZXMucmVkdWNlKGZ1bmN0aW9uKGEsIGIpIHtcclxuICAgICAgICAgIHJldHVybiBhLnBhdGllbnRzID8gYS5wYXRpZW50cy5jb25jYXQoYi5wYXRpZW50cykgOiBhLmNvbmNhdChiLnBhdGllbnRzKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBoZWFkZXIgPSBkYXRhLnRleHRbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0udGFibGVUaXRsZTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcExpc3QgPSBkYXRhLnJlbW92ZUR1cGxpY2F0ZXMocExpc3QpO1xyXG4gICAgICB2YXIgdklkID0gZGF0YS50ZXh0W3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLnZhbHVlSWQ7XHJcbiAgICAgIHZhciBkT3YgPSBkYXRhLnRleHRbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0uZGF0ZU9SdmFsdWU7XHJcbiAgICAgIHZhciBwYXRpZW50cyA9IHBMaXN0Lm1hcChmdW5jdGlvbihwYXRpZW50SWQpIHtcclxuICAgICAgICB2YXIgcmV0ID0gaW5kaWNhdG9ycy5wYXRpZW50c1twYXRpZW50SWRdO1xyXG4gICAgICAgIHJldC5uaHNOdW1iZXIgPSBkYXRhLnBhdExvb2t1cFtwYXRpZW50SWRdIHx8IHBhdGllbnRJZDtcclxuICAgICAgICByZXQucGF0aWVudElkID0gcGF0aWVudElkO1xyXG4gICAgICAgIHJldC5pdGVtcyA9IFtkYXRhLnBhdGllbnRzW3BhdGllbnRJZF0uY2hhcmFjdGVyaXN0aWNzLmFnZV07IC8vVGhlIGZpZWxkcyBpbiB0aGUgcGF0aWVudCBsaXN0IHRhYmxlXHJcblxyXG4gICAgICAgIHZhciBtZWFzdXJlcyA9IGRhdGEucGF0aWVudHNbcGF0aWVudElkXS5tZWFzdXJlbWVudHMuZmlsdGVyKGZ1bmN0aW9uKHYpe3JldHVybiB2LmlkPT09dklkO30pO1xyXG5cclxuICAgICAgICBpZiAoIG1lYXN1cmVzWzBdICYmIG1lYXN1cmVzWzBdLmRhdGEpIHtcclxuICAgICAgICAgIGlmIChkT3YgPT09IFwiZGF0ZVwiKSB7XHJcbiAgICAgICAgICAgIHJldC5pdGVtcy5wdXNoKG5ldyBEYXRlKG1lYXN1cmVzWzBdLmRhdGFbbWVhc3VyZXNbMF0uZGF0YS5sZW5ndGgtMV1bMF0pKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldC5pdGVtcy5wdXNoKG1lYXN1cmVzWzBdLmRhdGFbbWVhc3VyZXNbMF0uZGF0YS5sZW5ndGgtMV1bMV0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZXQuaXRlbXMucHVzaChcIj9cIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldC5pdGVtcy5wdXNoKGluZGljYXRvcnMucGF0aWVudHNbcGF0aWVudElkXS5vcHBvcnR1bml0aWVzLm1hcChmdW5jdGlvbih2KXtyZXR1cm4gJzxzcGFuIHN0eWxlPVwid2lkdGg6MTNweDtoZWlnaHQ6MTNweDtmbG9hdDpsZWZ0O2JhY2tncm91bmQtY29sb3I6JyArIEhpZ2hjaGFydHMuZ2V0T3B0aW9ucygpLmNvbG9yc1t2XSArICdcIj48L3NwYW4+Jzt9KS5qb2luKFwiXCIpKTtcclxuICAgICAgICAvL3JldC5pdGVtcy5wdXNoKGRhdGEubnVtYmVyT2ZTdGFuZGFyZHNNaXNzZWQocGF0aWVudElkKSk7XHJcbiAgICAgICAgcmV0dXJuIHJldDtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICB2YXIgbG9jYWxEYXRhID0ge1xyXG4gICAgICAgIFwicGF0aWVudHNcIjogcGF0aWVudHMsXHJcbiAgICAgICAgXCJuXCI6IHBhdGllbnRzLmxlbmd0aCxcclxuICAgICAgICBcImhlYWRlclwiOiBoZWFkZXIsXHJcbiAgICAgICAgXCJoZWFkZXItaXRlbXNcIjogW3tcclxuICAgICAgICAgIFwidGl0bGVcIjogXCJOSFMgbm8uXCIsXHJcbiAgICAgICAgICBcImlzU29ydGVkXCI6IGZhbHNlLFxyXG4gICAgICAgICAgXCJkaXJlY3Rpb25cIjogXCJzb3J0LWFzY1wiLFxyXG4gICAgICAgICAgXCJ0b29sdGlwXCI6IFwiTkhTIG51bWJlciBvZiBlYWNoIHBhdGllbnRcIlxyXG4gICAgICAgIH0se1xyXG4gICAgICAgICAgXCJ0aXRsZVwiOiBcIkFnZVwiLFxyXG4gICAgICAgICAgXCJpc1NvcnRlZFwiOiBmYWxzZSxcclxuICAgICAgICAgIFwiZGlyZWN0aW9uXCI6IFwic29ydC1hc2NcIixcclxuICAgICAgICAgIFwidG9vbHRpcFwiOiBcIlRoZSBhZ2Ugb2YgdGhlIHBhdGllbnRcIlxyXG4gICAgICAgIH1dXHJcbiAgICAgIH07XHJcblxyXG4gICAgICAvL21pZGRsZSBjb2x1bW4gaXMgZWl0aGVyIHZhbHVlIG9yIGRhdGVcclxuICAgICAgaWYgKGRPdikge1xyXG4gICAgICAgIGxvY2FsRGF0YVtcImhlYWRlci1pdGVtc1wiXS5wdXNoKHtcclxuICAgICAgICAgIFwidGl0bGVcIjogZGF0YS50ZXh0W3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLnZhbHVlTmFtZSxcclxuICAgICAgICAgIFwidG9vbHRpcFwiOiBkT3YgPT09IFwiZGF0ZVwiID8gXCJMYXN0IGRhdGUgXCIgKyB2SWQgKyBcIiB3YXMgbWVhc3VyZWRcIiA6IFwiTGFzdCBcIiArIHZJZCArIFwiIHJlYWRpbmdcIixcclxuICAgICAgICAgIFwiaXNTb3J0ZWRcIjogZmFsc2UsXHJcbiAgICAgICAgICBcImRpcmVjdGlvblwiOiBcInNvcnQtYXNjXCJcclxuICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBpZiAocGF0aHdheVN0YWdlID09PSBsb29rdXAuY2F0ZWdvcmllcy5tb25pdG9yaW5nLm5hbWUpIHtcclxuICAgICAgICAgIGxvY2FsRGF0YVtcImhlYWRlci1pdGVtc1wiXS5wdXNoKHtcclxuICAgICAgICAgICAgXCJ0aXRsZVwiOiBcIkxhc3QgQlAgRGF0ZVwiLFxyXG4gICAgICAgICAgICBcImlzU29ydGVkXCI6IGZhbHNlLFxyXG4gICAgICAgICAgICBcImRpcmVjdGlvblwiOiBcInNvcnQtYXNjXCIsXHJcbiAgICAgICAgICAgIFwidG9vbHRpcFwiOiBcIkxhc3QgZGF0ZSBCUCB3YXMgbWVhc3VyZWRcIlxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGxvY2FsRGF0YVtcImhlYWRlci1pdGVtc1wiXS5wdXNoKHtcclxuICAgICAgICAgICAgXCJ0aXRsZVwiOiBcIkxhc3QgU0JQXCIsXHJcbiAgICAgICAgICAgIFwidG9vbHRpcFwiOiBcIkxhc3Qgc3lzdG9saWMgQlAgcmVhZGluZ1wiLFxyXG4gICAgICAgICAgICBcImlzU29ydGVkXCI6IGZhbHNlLFxyXG4gICAgICAgICAgICBcImRpcmVjdGlvblwiOiBcInNvcnQtYXNjXCJcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgLy9hZGQgcXVhbCBzdGFuZGFyZCBjb2x1bW5cclxuICAgICAgbG9jYWxEYXRhW1wiaGVhZGVyLWl0ZW1zXCJdLnB1c2goe1xyXG4gICAgICAgIFwidGl0bGVcIjogXCJDYXRlZ29yaWVzXCIsXHJcbiAgICAgICAgXCJ0aXRsZUhUTUxcIjogJ0NhdGVnb3JpZXMnLFxyXG4gICAgICAgIFwiaXNTb3J0ZWRcIjogdHJ1ZSxcclxuICAgICAgICBcInRvb2x0aXBcIjogXCJDYXRlZ29yaWVzIGZyb20gYWJvdmUgY2hhcnRcIlxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGlmIChzb3J0RmllbGQgPT09IHVuZGVmaW5lZCkgc29ydEZpZWxkID0gMjtcclxuICAgICAgaWYgKHNvcnRGaWVsZCAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgbG9jYWxEYXRhLnBhdGllbnRzLnNvcnQoZnVuY3Rpb24oYSwgYikge1xyXG4gICAgICAgICAgaWYgKHNvcnRGaWVsZCA9PT0gMCkgeyAvL05IUyBudW1iZXJcclxuICAgICAgICAgICAgaWYgKGEubmhzTnVtYmVyID09PSBiLm5oc051bWJlcikge1xyXG4gICAgICAgICAgICAgIHJldHVybiAwO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoYS5uaHNOdW1iZXIgPiBiLm5oc051bWJlcikge1xyXG4gICAgICAgICAgICAgIHJldHVybiBzb3J0QXNjID8gMSA6IC0xO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGEubmhzTnVtYmVyIDwgYi5uaHNOdW1iZXIpIHtcclxuICAgICAgICAgICAgICByZXR1cm4gc29ydEFzYyA/IC0xIDogMTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKGEuaXRlbXNbc29ydEZpZWxkIC0gMV0gPT09IGIuaXRlbXNbc29ydEZpZWxkIC0gMV0pIHtcclxuICAgICAgICAgICAgICByZXR1cm4gMDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKGEuaXRlbXNbc29ydEZpZWxkIC0gMV0gPT0gXCI/XCIpIHJldHVybiAxO1xyXG4gICAgICAgICAgICBpZiAoYi5pdGVtc1tzb3J0RmllbGQgLSAxXSA9PSBcIj9cIikgcmV0dXJuIC0xO1xyXG5cclxuICAgICAgICAgICAgdmFyIEEgPSBOdW1iZXIoYS5pdGVtc1tzb3J0RmllbGQgLSAxXSk7XHJcbiAgICAgICAgICAgIHZhciBCID0gTnVtYmVyKGIuaXRlbXNbc29ydEZpZWxkIC0gMV0pO1xyXG4gICAgICAgICAgICBpZiAoaXNOYU4oQSkgfHwgaXNOYU4oQikpIHtcclxuICAgICAgICAgICAgICBBID0gYS5pdGVtc1tzb3J0RmllbGQgLSAxXTtcclxuICAgICAgICAgICAgICBCID0gYi5pdGVtc1tzb3J0RmllbGQgLSAxXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoQSA+IEIpIHtcclxuICAgICAgICAgICAgICByZXR1cm4gc29ydEFzYyA/IDEgOiAtMTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChBIDwgQikge1xyXG4gICAgICAgICAgICAgIHJldHVybiBzb3J0QXNjID8gLTEgOiAxO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBsb2NhbERhdGFbXCJoZWFkZXItaXRlbXNcIl0ubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgIGlmIChpID09PSBzb3J0RmllbGQpIHtcclxuICAgICAgICAgICAgbG9jYWxEYXRhW1wiaGVhZGVyLWl0ZW1zXCJdW2ldLmRpcmVjdGlvbiA9IHNvcnRBc2MgPyBcInNvcnQtYXNjXCIgOiBcInNvcnQtZGVzY1wiO1xyXG4gICAgICAgICAgICBsb2NhbERhdGFbXCJoZWFkZXItaXRlbXNcIl1baV0uaXNBc2MgPSBzb3J0QXNjO1xyXG4gICAgICAgICAgICBsb2NhbERhdGFbXCJoZWFkZXItaXRlbXNcIl1baV0uaXNTb3J0ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgbG9jYWxEYXRhW1wiaGVhZGVyLWl0ZW1zXCJdW2ldLmlzU29ydGVkID0gZmFsc2U7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICBiYXNlLmNyZWF0ZVBhbmVsU2hvdyhwYXRpZW50TGlzdCwgcGF0aWVudHNQYW5lbCwgbG9jYWxEYXRhLCB7XHJcbiAgICAgICAgXCJoZWFkZXItaXRlbVwiOiAkKFwiI3BhdGllbnQtbGlzdC1oZWFkZXItaXRlbVwiKS5odG1sKCksXHJcbiAgICAgICAgXCJpdGVtXCI6ICQoJyNwYXRpZW50LWxpc3QtaXRlbScpLmh0bWwoKVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgICQoJyNwYXRpZW50cy1wbGFjZWhvbGRlcicpLmhpZGUoKTtcclxuXHJcbiAgICAgIGJhc2Uuc2V0dXBDbGlwYm9hcmQoJCgnLmJ0bi1jb3B5JyksIHRydWUpO1xyXG5cclxuICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG5cclxuICAgICAgcGF0aWVudHNQYW5lbC5maW5kKCdkaXYudGFibGUtc2Nyb2xsJykubmljZVNjcm9sbCh7XHJcbiAgICAgICAgY3Vyc29yb3BhY2l0eW1pbjogMC4zLFxyXG4gICAgICAgIGN1cnNvcndpZHRoOiBcIjdweFwiLFxyXG4gICAgICAgIGhvcml6cmFpbGVuYWJsZWQ6IGZhbHNlXHJcbiAgICAgIH0pO1xyXG5cclxuICAgIH0pO1xyXG5cclxuICB9LFxyXG5cclxuICBzaG93OiBmdW5jdGlvbihwYW5lbCwgaXNBcHBlbmQsIHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgbG9hZENvbnRlbnRGbikge1xyXG5cclxuICAgIHZhciB0ZW1wTXVzdCA9ICQoJyNwYXRpZW50cy1wYW5lbC15ZXMnKS5odG1sKCk7XHJcblxyXG4gICAgaWYoaXNBcHBlbmQpIHBhbmVsLmFwcGVuZChNdXN0YWNoZS5yZW5kZXIodGVtcE11c3QpKTtcclxuICAgIGVsc2UgcGFuZWwuaHRtbChNdXN0YWNoZS5yZW5kZXIodGVtcE11c3QpKTtcclxuXHJcbiAgICBwbC53aXJlVXAoZnVuY3Rpb24ocGF0aWVudElkKSB7XHJcbiAgICAgIGhpc3RvcnkucHVzaFN0YXRlKG51bGwsIG51bGwsICcjcGF0aWVudC8nICsgcGF0aWVudElkKTtcclxuICAgICAgbG9hZENvbnRlbnRGbignI3BhdGllbnQvJyArIHBhdGllbnRJZCk7XHJcbiAgICB9KTtcclxuICAgIHBsLnBvcHVsYXRlKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgbnVsbCk7XHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gcGw7XHJcbiIsInZhciBiYXNlID0gcmVxdWlyZSgnLi4vYmFzZS5qcycpLFxyXG4gIGRhdGEgPSByZXF1aXJlKCcuLi9kYXRhLmpzJyksXHJcbiAgbG9va3VwID0gcmVxdWlyZSgnLi4vbG9va3VwLmpzJyksXHJcbiAgTXVzdGFjaGUgPSByZXF1aXJlKCdtdXN0YWNoZScpO1xyXG52YXIgc3RhdGVzLCBsb2FkQ29udEZuLCBJRCA9IFwiUEFUSUVOVF9TRUFSQ0hcIjtcclxuXHJcbnZhciBwcyA9IHtcclxuXHJcbiAgd2lyZVVwOiBmdW5jdGlvbigpIHtcclxuICAgIGlmIChzdGF0ZXMpIHtcclxuICAgICAgc3RhdGVzLmNsZWFyUHJlZmV0Y2hDYWNoZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXRlcyA9IG5ldyBCbG9vZGhvdW5kKHtcclxuICAgICAgZGF0dW1Ub2tlbml6ZXI6IEJsb29kaG91bmQudG9rZW5pemVycy5vYmoud2hpdGVzcGFjZSgndmFsdWUnKSxcclxuICAgICAgcXVlcnlUb2tlbml6ZXI6IEJsb29kaG91bmQudG9rZW5pemVycy53aGl0ZXNwYWNlLFxyXG4gICAgICBsb2NhbDogJC5tYXAoZGF0YS5wYXRpZW50QXJyYXksIGZ1bmN0aW9uKHN0YXRlKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgIGlkOiBzdGF0ZSxcclxuICAgICAgICAgIHZhbHVlOiBkYXRhLnBhdExvb2t1cCAmJiBkYXRhLnBhdExvb2t1cFtzdGF0ZV0gPyBkYXRhLnBhdExvb2t1cFtzdGF0ZV0gOiBzdGF0ZVxyXG4gICAgICAgIH07XHJcbiAgICAgIH0pXHJcbiAgICB9KTtcclxuXHJcbiAgICBzdGF0ZXMuaW5pdGlhbGl6ZSh0cnVlKTtcclxuXHJcbiAgICAkKCcjc2VhcmNoLWJveCcpLmZpbmQoJy50eXBlYWhlYWQnKS50eXBlYWhlYWQoJ2Rlc3Ryb3knKTtcclxuICAgICQoJyNzZWFyY2gtYm94JykuZmluZCgnLnR5cGVhaGVhZCcpLnR5cGVhaGVhZCh7XHJcbiAgICAgICAgaGludDogdHJ1ZSxcclxuICAgICAgICBoaWdobGlnaHQ6IHRydWUsXHJcbiAgICAgICAgbWluTGVuZ3RoOiAxLFxyXG4gICAgICAgIGF1dG9zZWxlY3Q6IHRydWVcclxuICAgICAgfSwge1xyXG4gICAgICAgIG5hbWU6ICdwYXRpZW50cycsXHJcbiAgICAgICAgZGlzcGxheUtleTogJ3ZhbHVlJyxcclxuICAgICAgICBzb3VyY2U6IHN0YXRlcy50dEFkYXB0ZXIoKSxcclxuICAgICAgICB0ZW1wbGF0ZXM6IHtcclxuICAgICAgICAgIGVtcHR5OiBbXHJcbiAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJlbXB0eS1tZXNzYWdlXCI+JyxcclxuICAgICAgICAgICAgICAgICcmbmJzcDsgJm5ic3A7IE5vIG1hdGNoZXMnLFxyXG4gICAgICAgICAgICAgICc8L2Rpdj4nXHJcbiAgICAgICAgICAgIF0uam9pbignXFxuJylcclxuICAgICAgICB9XHJcbiAgICAgIH0pLm9uKCd0eXBlYWhlYWQ6c2VsZWN0ZWQnLCBwcy5vblNlbGVjdGVkKVxyXG4gICAgICAub24oJ3R5cGVhaGVhZDphdXRvY29tcGxldGVkJywgcHMub25TZWxlY3RlZCk7XHJcblxyXG4gICAgJCgnI3NlYXJjaGJ0bicpLm9uKCdtb3VzZWRvd24nLCBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIHZhbCA9ICQoJy50eXBlYWhlYWQnKS5lcSgwKS52YWwoKTtcclxuICAgICAgaWYgKCF2YWwgfHwgdmFsID09PSBcIlwiKSB2YWwgPSAkKCcudHlwZWFoZWFkJykuZXEoMSkudmFsKCk7XHJcbiAgICAgIHBzLm9uU2VsZWN0ZWQobnVsbCwge1xyXG4gICAgICAgIFwiaWRcIjogdmFsXHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfSxcclxuXHJcbiAgb25TZWxlY3RlZDogZnVuY3Rpb24oJGUsIG5oc051bWJlck9iamVjdCkge1xyXG4gICAgLy9IaWRlIHRoZSBzdWdnZXN0aW9ucyBwYW5lbFxyXG4gICAgJCgnI3NlYXJjaC1ib3gnKS5maW5kKCcudHQtZHJvcGRvd24tbWVudScpLmNzcygnZGlzcGxheScsICdub25lJyk7XHJcblxyXG4gICAgaGlzdG9yeS5wdXNoU3RhdGUobnVsbCwgbnVsbCwgJyNwYXRpZW50cy8nICsgbmhzTnVtYmVyT2JqZWN0LmlkKTtcclxuICAgIGxvYWRDb250Rm4oJyNwYXRpZW50cy8nICsgbmhzTnVtYmVyT2JqZWN0LmlkLCB0cnVlKTtcclxuXHJcbiAgfSxcclxuXHJcbiAgc2hvdzogZnVuY3Rpb24ocGFuZWwsIGlzQXBwZW5kLCBsb2FkQ29udGVudEZuKSB7XHJcblxyXG4gICAgbG9hZENvbnRGbiA9IGxvYWRDb250ZW50Rm47XHJcbiAgICB2YXIgdGVtcE11c3QgPSAkKCcjcGF0aWVudC1zZWFyY2gnKS5odG1sKCk7XHJcblxyXG4gICAgaWYoaXNBcHBlbmQpIHBhbmVsLmFwcGVuZChNdXN0YWNoZS5yZW5kZXIodGVtcE11c3QpKTtcclxuICAgIGVsc2UgcGFuZWwuaHRtbChNdXN0YWNoZS5yZW5kZXIodGVtcE11c3QpKTtcclxuXHJcbiAgICBwcy53aXJlVXAoKTtcclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBwcztcclxuIiwidmFyIGJhc2UgPSByZXF1aXJlKCcuLi9iYXNlLmpzJyksXHJcbiAgZGF0YSA9IHJlcXVpcmUoJy4uL2RhdGEuanMnKSxcclxuICBsb29rdXAgPSByZXF1aXJlKCcuLi9sb29rdXAuanMnKSxcclxuICBjaGFydCA9IHJlcXVpcmUoJy4uL2NoYXJ0LmpzJyksXHJcbiAgcXVhbGl0eVN0YW5kYXJkID0gcmVxdWlyZSgnLi9xdWFsaXR5U3RhbmRhcmQuanMnKSxcclxuICBvdGhlckNvZGVzID0gcmVxdWlyZSgnLi9vdGhlckNvZGVzLmpzJyksXHJcbiAgbWVkaWNhdGlvbiA9IHJlcXVpcmUoJy4vbWVkaWNhdGlvbi5qcycpLFxyXG4gIHRyZW5kID0gcmVxdWlyZSgnLi90cmVuZC5qcycpLFxyXG4gIGluZGl2aWR1YWxBY3Rpb25QbGFuID0gcmVxdWlyZSgnLi9pbmRpdmlkdWFsQWN0aW9uUGxhbi5qcycpLFxyXG4gIHBhdGllbnRMaXN0ID0gcmVxdWlyZSgnLi9wYXRpZW50TGlzdC5qcycpO1xyXG5cclxudmFyIHB0ID0ge1xyXG5cclxuICBjcmVhdGU6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCkge1xyXG4gICAgdmFyIHRhYkRhdGEgPSBbXTtcclxuICAgIGZvciAodmFyIGtleSBpbiBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHMpIHtcclxuICAgICAgdGFiRGF0YS5wdXNoKHtcclxuICAgICAgICBcImhlYWRlclwiOiBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNba2V5XS50YWIsXHJcbiAgICAgICAgXCJhY3RpdmVcIjoga2V5ID09PSBzdGFuZGFyZCxcclxuICAgICAgICBcInVybFwiOiB3aW5kb3cubG9jYXRpb24uaGFzaC5yZXBsYWNlKC9cXC9uby4qL2csICdcXC9uby8nICsga2V5KVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICAgIHJldHVybiBiYXNlLmNyZWF0ZVBhbmVsKHBhdGllbnRzUGFuZWxUZW1wbGF0ZSwge1xyXG4gICAgICBcInBhdGh3YXlTdGFnZVwiOiBwYXRod2F5U3RhZ2UsXHJcbiAgICAgIFwiaGVhZGVyXCI6IGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0uY2hhcnRUaXRsZSxcclxuICAgICAgXCJ0b29sdGlwXCI6IGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0udG9vbHRpcCxcclxuICAgICAgXCJ1cmxcIjogd2luZG93LmxvY2F0aW9uLmhhc2gucmVwbGFjZSgvXFwveWVzLiovZywgJycpLnJlcGxhY2UoL1xcL25vLiovZywgJycpLFxyXG4gICAgICBcInRhYnNcIjogdGFiRGF0YSxcclxuICAgICAgXCJ0ZXh0XCI6IGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnRleHRcclxuICAgIH0sIHtcclxuICAgICAgXCJjb250ZW50XCI6ICQoJyNwYXRpZW50cy1wYW5lbC1ubycpLmh0bWwoKSxcclxuICAgICAgXCJ0YWItaGVhZGVyXCI6ICQoJyNwYXRpZW50cy1wYW5lbC1uby10YWJzJykuaHRtbCgpLFxyXG4gICAgICBcInRhYi1jb250ZW50XCI6ICQoJyNwYXRpZW50cy1wYW5lbC1uby1wYWdlJykuaHRtbCgpXHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICBjcmVhdGVPazogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UpIHtcclxuICAgIHJldHVybiBiYXNlLmNyZWF0ZVBhbmVsKHBhdGllbnRzUGFuZWxUZW1wbGF0ZSwge1xyXG4gICAgICBcIm9rXCI6IHRydWUsXHJcbiAgICAgIFwicGF0aHdheVN0YWdlXCI6IHBhdGh3YXlTdGFnZSxcclxuICAgICAgXCJ1cmxcIjogd2luZG93LmxvY2F0aW9uLmhhc2gucmVwbGFjZSgvXFwveWVzL2csICcnKS5yZXBsYWNlKC9cXC9uby9nLCAnJyksXHJcbiAgICAgIFwidGV4dFwiOiBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS50ZXh0XHJcbiAgICB9LCB7XHJcbiAgICAgIFwiY29udGVudFwiOiAkKCcjcGF0aWVudHMtcGFuZWwteWVzJykuaHRtbCgpXHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICB3aXJlVXA6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBsb2NhdGlvbiwgc3RhbmRhcmQpIHtcclxuXHJcbiAgICBwYXRpZW50TGlzdC53aXJlVXAoZnVuY3Rpb24ocGF0aWVudElkKXtcclxuICAgICAgJCgnW2RhdGEtdG9nZ2xlPVwidG9vbHRpcFwiXScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgJCh0aGlzKS50b29sdGlwKCdkZXN0cm95Jyk7XHJcbiAgICAgIGJhc2UuY2xlYXJCb3goKTtcclxuICAgICAgJCgnLmxpc3QtaXRlbScpLnJlbW92ZUNsYXNzKCdoaWdobGlnaHRlZCcpO1xyXG4gICAgICAkKHRoaXMpLmFkZENsYXNzKCdoaWdobGlnaHRlZCcpLnJlbW92ZUF0dHIoXCJ0aXRsZVwiKTtcclxuXHJcbiAgICAgIHB0LnNob3dQYXRod2F5U3RhZ2VQYXRpZW50VmlldyhwYXRpZW50SWQsIHBhdGh3YXlJZCwgc2VsZWN0ZWQsIHN0YW5kYXJkKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHBhdGllbnRzUGFuZWwgPSAkKCcjcGF0aWVudHMnKTtcclxuXHJcbiAgICBsb2NhdGlvbi5vZmYoJ2NsaWNrJywgJyNicmVha2Rvd24tY2hhcnQnKTtcclxuICAgIGxvY2F0aW9uLm9uKCdjbGljaycsICcjYnJlYWtkb3duLWNoYXJ0JywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIGlmICghbG9va3VwLmNoYXJ0Q2xpY2tlZCkge1xyXG4gICAgICAgIC8qanNoaW50IHVudXNlZDogdHJ1ZSovXHJcbiAgICAgICAgJCgncGF0aC5jMy1iYXInKS5hdHRyKCdjbGFzcycsIGZ1bmN0aW9uKGluZGV4LCBjbGFzc05hbWVzKSB7XHJcbiAgICAgICAgICByZXR1cm4gY2xhc3NOYW1lcy5yZXBsYWNlKC9fdW5zZWxlY3RlZF8vZywgJycpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8qanNoaW50IHVudXNlZDogZmFsc2UqL1xyXG5cclxuICAgICAgICBpZiAobG9va3VwLmNoYXJ0c1snYnJlYWtkb3duLWNoYXJ0J10pIGxvb2t1cC5jaGFydHNbJ2JyZWFrZG93bi1jaGFydCddLnVuc2VsZWN0KCk7XHJcblxyXG4gICAgICAgIHBhdGllbnRMaXN0LnBvcHVsYXRlKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgbnVsbCk7XHJcbiAgICAgICAgZGF0YS5zdWJzZWxlY3RlZCA9IG51bGw7XHJcblxyXG4gICAgICAgIGZhclJpZ2h0UGFuZWwuZmFkZU91dCgyMDApO1xyXG4gICAgICB9XHJcbiAgICAgIGxvb2t1cC5jaGFydENsaWNrZWQgPSBmYWxzZTtcclxuICAgIH0pO1xyXG5cclxuICAgIGNoYXJ0LmRlc3Ryb3lDaGFydHMoWydicmVha2Rvd24tY2hhcnQnXSk7XHJcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICBsb29rdXAuY2hhcnRzWydicmVha2Rvd24tY2hhcnQnXSA9IGMzLmdlbmVyYXRlKHtcclxuICAgICAgICBiaW5kdG86ICcjYnJlYWtkb3duLWNoYXJ0JyxcclxuICAgICAgICB0b29sdGlwOiB7XHJcbiAgICAgICAgICBmb3JtYXQ6IHtcclxuICAgICAgICAgICAgbmFtZTogZnVuY3Rpb24obmFtZSwgYSwgYikge1xyXG4gICAgICAgICAgICAgIHZhciB0ZXh0ID0gZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS5vcHBvcnR1bml0aWVzW2xvb2t1cC5pbmRleF0uZGVzYztcclxuICAgICAgICAgICAgICB2YXIgaHRtbCA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgd2hpbGUgKHRleHQubGVuZ3RoID4gNDApIHtcclxuICAgICAgICAgICAgICAgIGlmICh0ZXh0LmluZGV4T2YoJyAnLCA0MCkgPCAwKSBicmVhaztcclxuICAgICAgICAgICAgICAgIGh0bWwgKz0gdGV4dC5zdWJzdHIoMCwgdGV4dC5pbmRleE9mKCcgJywgNDApKSArICc8YnI+JztcclxuICAgICAgICAgICAgICAgIHRleHQgPSB0ZXh0LnN1YnN0cih0ZXh0LmluZGV4T2YoJyAnLCA0MCkgKyAxKTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgaHRtbCArPSB0ZXh0O1xyXG4gICAgICAgICAgICAgIHJldHVybiBodG1sO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24odmFsdWUsIHJhdGlvLCBpZCwgaW5kZXgpIHtcclxuICAgICAgICAgICAgICBsb29rdXAuaW5kZXggPSBpbmRleDtcclxuICAgICAgICAgICAgICByZXR1cm4gdmFsdWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgIGNvbHVtbnM6IFtcclxuICAgICAgICAgICAgW1wiUGF0aWVudHNcIl0uY29uY2F0KGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0ub3Bwb3J0dW5pdGllcy5tYXAoZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIHZhbC5wYXRpZW50cy5sZW5ndGg7XHJcbiAgICAgICAgICAgIH0pKVxyXG4gICAgICAgICAgXSxcclxuICAgICAgICAgIHR5cGU6ICdiYXInLFxyXG4gICAgICAgICAgbGFiZWxzOiB0cnVlLFxyXG4gICAgICAgICAgY29sb3I6IGZ1bmN0aW9uKGNvbG9yLCBkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBsb29rdXAuY29sb3JzW2QuaW5kZXhdO1xyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHNlbGVjdGlvbjoge1xyXG4gICAgICAgICAgICBlbmFibGVkOiB0cnVlXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgb25jbGljazogZnVuY3Rpb24oZCkge1xyXG4gICAgICAgICAgICBjaGFydC5zZWxlY3RQaWVTbGljZSgnYnJlYWtkb3duLWNoYXJ0JywgZCk7XHJcbiAgICAgICAgICAgIHBhdGllbnRMaXN0LnBvcHVsYXRlKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS5vcHBvcnR1bml0aWVzW2QuaW5kZXhdLm5hbWUpO1xyXG4gICAgICAgICAgICBkYXRhLnN1YnNlbGVjdGVkID0gZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS5vcHBvcnR1bml0aWVzW2QuaW5kZXhdLm5hbWU7XHJcblxyXG4gICAgICAgICAgICAvL2NvbG91ciB0YWJsZSBhcHByb3ByaWF0ZWx5IC0gbmVlZCB0byBhZGQgb3BhY2l0eVxyXG4gICAgICAgICAgICB2YXIgc2xpY2VDb2xvdXJIZXggPSBsb29rdXAuY29sb3JzW2QuaW5kZXhdO1xyXG4gICAgICAgICAgICB2YXIgc2hvcnRoYW5kUmVnZXggPSAvXiM/KFthLWZcXGRdKShbYS1mXFxkXSkoW2EtZlxcZF0pJC9pO1xyXG4gICAgICAgICAgICBzbGljZUNvbG91ckhleCA9IHNsaWNlQ29sb3VySGV4LnJlcGxhY2Uoc2hvcnRoYW5kUmVnZXgsIGZ1bmN0aW9uKG0sIHIsIGcsIGIpIHtcclxuICAgICAgICAgICAgICByZXR1cm4gciArIHIgKyBnICsgZyArIGIgKyBiO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IC9eIz8oW2EtZlxcZF17Mn0pKFthLWZcXGRdezJ9KShbYS1mXFxkXXsyfSkkL2kuZXhlYyhzbGljZUNvbG91ckhleCk7XHJcbiAgICAgICAgICAgIHZhciBvcGFjaXR5ID0gMC4yO1xyXG4gICAgICAgICAgICB2YXIgc2xpY2VDb2xvdXIgPSAncmdiYSgnICsgcGFyc2VJbnQocmVzdWx0WzFdLCAxNikgKyAnLCcgKyBwYXJzZUludChyZXN1bHRbMl0sIDE2KSArICcsJyArIHBhcnNlSW50KHJlc3VsdFszXSwgMTYpICsgJywnICsgb3BhY2l0eSArICcpJztcclxuXHJcbiAgICAgICAgICAgICQoJy50YWJsZS5wYXRpZW50LWxpc3QudGFibGUtaGVhZC1oaWRkZW4nKS5jc3Moe1xyXG4gICAgICAgICAgICAgIFwiYmFja2dyb3VuZENvbG9yXCI6IHNsaWNlQ29sb3VyXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgYmFyOiB7XHJcbiAgICAgICAgICB3aWR0aDoge1xyXG4gICAgICAgICAgICByYXRpbzogMC41XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBsZWdlbmQ6IHtcclxuICAgICAgICAgIHNob3c6IGZhbHNlXHJcbiAgICAgICAgfSxcclxuICAgICAgICBncmlkOiB7XHJcbiAgICAgICAgICBmb2N1czoge1xyXG4gICAgICAgICAgICBzaG93OiBmYWxzZVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgYXhpczoge1xyXG4gICAgICAgICAgeDoge1xyXG4gICAgICAgICAgICB0eXBlOiAnY2F0ZWdvcnknLFxyXG4gICAgICAgICAgICBjYXRlZ29yaWVzOiBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLm9wcG9ydHVuaXRpZXMubWFwKGZ1bmN0aW9uKHZhbCkge1xyXG4gICAgICAgICAgICAgIHJldHVybiB2YWwubmFtZTtcclxuICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgIGxhYmVsOiBmYWxzZVxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHk6IHtcclxuICAgICAgICAgICAgbGFiZWw6IHtcclxuICAgICAgICAgICAgICB0ZXh0OiAnUGF0aWVudCBjb3VudCAobiknLFxyXG4gICAgICAgICAgICAgIHBvc2l0aW9uOiAnb3V0ZXItbWlkZGxlJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0sIDEpO1xyXG4gIH0sXHJcblxyXG4gIHdpcmVVcE9rOiBmdW5jdGlvbihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgbG9jYXRpb24pIHtcclxuICAgIHBhdGllbnRzUGFuZWwgPSAkKCcjcGF0aWVudHMnKTtcclxuXHJcbiAgICBwYXRpZW50c1BhbmVsLm9uKCdjbGljaycsICd0aGVhZCB0ciB0aC5zb3J0YWJsZScsIGZ1bmN0aW9uKCkgeyAvL1NvcnQgY29sdW1ucyB3aGVuIGNvbHVtbiBoZWFkZXIgY2xpY2tlZFxyXG4gICAgICB2YXIgc29ydEFzYyA9ICEkKHRoaXMpLmhhc0NsYXNzKCdzb3J0LWFzYycpO1xyXG4gICAgICBpZiAoc29ydEFzYykge1xyXG4gICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoJ3NvcnQtZGVzYycpLmFkZENsYXNzKCdzb3J0LWFzYycpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoJ3NvcnQtYXNjJykuYWRkQ2xhc3MoJ3NvcnQtZGVzYycpO1xyXG4gICAgICB9XHJcbiAgICAgIHB0LnBvcHVsYXRlT2socGF0aHdheUlkLCBkYXRhLnNlbGVjdGVkLCBkYXRhLnN1YnNlbGVjdGVkLCAkKHRoaXMpLmluZGV4KCksIHNvcnRBc2MpO1xyXG4gICAgfSkub24oJ2NsaWNrJywgJ3Rib2R5IHRyJywgZnVuY3Rpb24oZSkgeyAvL1NlbGVjdCBpbmRpdmlkdWFsIHBhdGllbnQgd2hlbiByb3cgY2xpY2tlZFxyXG4gICAgICAkKCdbZGF0YS10b2dnbGU9XCJ0b29sdGlwXCJdJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAkKHRoaXMpLnRvb2x0aXAoJ2Rlc3Ryb3knKTtcclxuICAgICAgYmFzZS5jbGVhckJveCgpO1xyXG4gICAgICAkKCcubGlzdC1pdGVtJykucmVtb3ZlQ2xhc3MoJ2hpZ2hsaWdodGVkJyk7XHJcbiAgICAgICQodGhpcykuYWRkQ2xhc3MoJ2hpZ2hsaWdodGVkJykucmVtb3ZlQXR0cigndGl0bGUnKTtcclxuXHJcbiAgICAgIHZhciBwYXRpZW50SWQgPSAkKHRoaXMpLmZpbmQoJ3RkIGJ1dHRvbicpLmF0dHIoJ2RhdGEtcGF0aWVudC1pZCcpO1xyXG5cclxuICAgICAgcHQuc2hvd1BhdGh3YXlTdGFnZVBhdGllbnRWaWV3KHBhdGllbnRJZCwgcGF0aHdheUlkLCBkYXRhLnNlbGVjdGVkLCBudWxsKTtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgfSkub24oJ2NsaWNrJywgJ3Rib2R5IHRyIGJ1dHRvbicsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgLy9kb24ndCB3YW50IHJvdyBzZWxlY3RlZCBpZiBqdXN0IGJ1dHRvbiBwcmVzc2VkP1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkYXRhLnNlbGVjdGVkID0gcGF0aHdheVN0YWdlO1xyXG4gICAgZGF0YS5zdWJzZWxlY3RlZCA9IG51bGw7XHJcbiAgfSxcclxuXHJcbiAgcG9wdWxhdGVPazogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN1YnNlY3Rpb24sIHNvcnRGaWVsZCwgc29ydEFzYykge1xyXG4gICAgdmFyIHBMaXN0ID0gW10sXHJcbiAgICAgIGksIGssIHByb3AsIGhlYWRlciwgdG9vbHRpcDtcclxuICAgIHBhdGllbnRzUGFuZWwuZmFkZU91dCgyMDAsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAkKHRoaXMpLmZhZGVJbigyMDApO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcExpc3QgPSBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5wYXRpZW50c09rO1xyXG4gICAgaGVhZGVyID0gZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0udGV4dC5wYW5lbE9rSGVhZGVyLnRleHQ7XHJcbiAgICB0b29sdGlwID0gZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0udGV4dC5wYW5lbE9rSGVhZGVyLnRvb2x0aXA7XHJcblxyXG4gICAgcExpc3QgPSBkYXRhLnJlbW92ZUR1cGxpY2F0ZXMocExpc3QpO1xyXG4gICAgdmFyIHBhdGllbnRzID0gcExpc3QubWFwKGZ1bmN0aW9uKHBhdGllbnRJZCkge1xyXG4gICAgICB2YXIgcmV0ID0gZGF0YS5wYXRpZW50c1twYXRpZW50SWRdO1xyXG4gICAgICByZXQubmhzTnVtYmVyID0gZGF0YS5wYXRMb29rdXAgPyBkYXRhLnBhdExvb2t1cFtwYXRpZW50SWRdIDogcGF0aWVudElkO1xyXG4gICAgICByZXQucGF0aWVudElkID0gcGF0aWVudElkO1xyXG4gICAgICByZXQuaXRlbXMgPSBbXTsgLy9UaGUgZmllbGRzIGluIHRoZSBwYXRpZW50IGxpc3QgdGFibGVcclxuICAgICAgcmV0Lml0ZW1zLnB1c2goZGF0YS5wYXRpZW50c1twYXRpZW50SWRdLmJyZWFjaCA/IGRhdGEubnVtYmVyT2ZTdGFuZGFyZHNNaXNzZWQocGF0aWVudElkKSA6IDApO1xyXG4gICAgICByZXR1cm4gcmV0O1xyXG4gICAgfSk7XHJcbiAgICB2YXIgbG9jYWxEYXRhID0ge1xyXG4gICAgICBcInBhdGllbnRzXCI6IHBhdGllbnRzLFxyXG4gICAgICBcIm5cIjogcGF0aWVudHMubGVuZ3RoLFxyXG4gICAgICBcImhlYWRlclwiOiBoZWFkZXIsXHJcbiAgICAgIFwidG9vbHRpcFwiOiB0b29sdGlwLFxyXG4gICAgICBcImhlYWRlci1pdGVtc1wiOiBbe1xyXG4gICAgICAgIFwidGl0bGVcIjogXCJOSFMgbm8uXCIsXHJcbiAgICAgICAgXCJpc1NvcnRlZFwiOiBmYWxzZSxcclxuICAgICAgICBcImRpcmVjdGlvblwiOiBcInNvcnQtYXNjXCJcclxuICAgICAgfSwge1xyXG4gICAgICAgIFwidGl0bGVcIjogXCJBbGwgT3Bwb3J0dW5pdGllc1wiLFxyXG4gICAgICAgIFwidGl0bGVIVE1MXCI6ICcjIG9mIDxpIGNsYXNzPVwiZmEgZmEtZmxhZ1wiIHN0eWxlPVwiY29sb3I6cmVkXCI+PC9pPicsXHJcbiAgICAgICAgXCJpc1NvcnRlZFwiOiB0cnVlLFxyXG4gICAgICAgIFwiZGlyZWN0aW9uXCI6IFwic29ydC1kZXNjXCIsXHJcbiAgICAgICAgXCJ0b29sdGlwXCI6IFwiVG90YWwgbnVtYmVyIG9mIGltcHJvdmVtZW50IG9wcG9ydHVuaXRpZXMgYXZhaWxhYmxlIGFjcm9zcyBhbGwgY29uZGl0aW9uc1wiXHJcbiAgICAgIH1dXHJcbiAgICB9O1xyXG5cclxuICAgIGlmIChzb3J0RmllbGQgPT09IHVuZGVmaW5lZCkgc29ydEZpZWxkID0gMTtcclxuXHJcbiAgICBsb2NhbERhdGEucGF0aWVudHMuc29ydChmdW5jdGlvbihhLCBiKSB7XHJcbiAgICAgIGlmIChzb3J0RmllbGQgPT09IDApIHsgLy9OSFMgbnVtYmVyXHJcbiAgICAgICAgaWYgKGEubmhzTnVtYmVyID09PSBiLm5oc051bWJlcikge1xyXG4gICAgICAgICAgcmV0dXJuIDA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoYS5uaHNOdW1iZXIgPiBiLm5oc051bWJlcikge1xyXG4gICAgICAgICAgcmV0dXJuIHNvcnRBc2MgPyAxIDogLTE7XHJcbiAgICAgICAgfSBlbHNlIGlmIChhLm5oc051bWJlciA8IGIubmhzTnVtYmVyKSB7XHJcbiAgICAgICAgICByZXR1cm4gc29ydEFzYyA/IC0xIDogMTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaWYgKGEuaXRlbXNbc29ydEZpZWxkIC0gMV0gPT09IGIuaXRlbXNbc29ydEZpZWxkIC0gMV0pIHtcclxuICAgICAgICAgIHJldHVybiAwO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIEEgPSBOdW1iZXIoYS5pdGVtc1tzb3J0RmllbGQgLSAxXSk7XHJcbiAgICAgICAgdmFyIEIgPSBOdW1iZXIoYi5pdGVtc1tzb3J0RmllbGQgLSAxXSk7XHJcbiAgICAgICAgaWYgKGlzTmFOKEEpIHx8IGlzTmFOKEIpKSB7XHJcbiAgICAgICAgICBBID0gYS5pdGVtc1tzb3J0RmllbGQgLSAxXTtcclxuICAgICAgICAgIEIgPSBiLml0ZW1zW3NvcnRGaWVsZCAtIDFdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoQSA+IEIpIHtcclxuICAgICAgICAgIHJldHVybiBzb3J0QXNjID8gMSA6IC0xO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoQSA8IEIpIHtcclxuICAgICAgICAgIHJldHVybiBzb3J0QXNjID8gLTEgOiAxO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgZm9yIChpID0gMDsgaSA8IGxvY2FsRGF0YVtcImhlYWRlci1pdGVtc1wiXS5sZW5ndGg7IGkrKykge1xyXG4gICAgICBpZiAoaSA9PT0gc29ydEZpZWxkKSB7XHJcbiAgICAgICAgbG9jYWxEYXRhW1wiaGVhZGVyLWl0ZW1zXCJdW2ldLmRpcmVjdGlvbiA9IHNvcnRBc2MgPyBcInNvcnQtYXNjXCIgOiBcInNvcnQtZGVzY1wiO1xyXG4gICAgICAgIGxvY2FsRGF0YVtcImhlYWRlci1pdGVtc1wiXVtpXS5pc0FzYyA9IHNvcnRBc2M7XHJcbiAgICAgICAgbG9jYWxEYXRhW1wiaGVhZGVyLWl0ZW1zXCJdW2ldLmlzU29ydGVkID0gdHJ1ZTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBsb2NhbERhdGFbXCJoZWFkZXItaXRlbXNcIl1baV0uaXNTb3J0ZWQgPSBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBiYXNlLmNyZWF0ZVBhbmVsU2hvdyhwYXRpZW50TGlzdCwgcGF0aWVudHNQYW5lbCwgbG9jYWxEYXRhLCB7XHJcbiAgICAgIFwiaGVhZGVyLWl0ZW1cIjogJChcIiNwYXRpZW50LWxpc3QtaGVhZGVyLWl0ZW1cIikuaHRtbCgpLFxyXG4gICAgICBcIml0ZW1cIjogJCgnI3BhdGllbnQtbGlzdC1pdGVtJykuaHRtbCgpXHJcbiAgICB9KTtcclxuXHJcbiAgICAkKCcjcGF0aWVudHMtcGxhY2Vob2xkZXInKS5oaWRlKCk7XHJcblxyXG4gICAgYmFzZS5zZXR1cENsaXBib2FyZCgkKCcuYnRuLWNvcHknKSwgdHJ1ZSk7XHJcblxyXG4gICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG5cclxuICAgIHZhciBjID0gcGF0aWVudHNQYW5lbC5maW5kKCdkaXYudGFibGUtc2Nyb2xsJykuZ2V0TmljZVNjcm9sbCgpO1xyXG4gICAgaWYgKGMgJiYgYy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGMucmVzaXplKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBwYXRpZW50c1BhbmVsLmZpbmQoJ2Rpdi50YWJsZS1zY3JvbGwnKS5uaWNlU2Nyb2xsKHtcclxuICAgICAgICBjdXJzb3JvcGFjaXR5bWluOiAwLjMsXHJcbiAgICAgICAgY3Vyc29yd2lkdGg6IFwiN3B4XCIsXHJcbiAgICAgICAgaG9yaXpyYWlsZW5hYmxlZDogZmFsc2VcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfSxcclxuXHJcbiAgLy9TaG93IHBhdGllbnQgdmlldyB3aXRoaW4gdGhlIHBhdGh3YXkgc3RhZ2Ugdmlld1xyXG4gIHNob3dQYXRod2F5U3RhZ2VQYXRpZW50VmlldzogZnVuY3Rpb24ocGF0aWVudElkLCBwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQpIHtcclxuICAgIGRhdGEucGF0aWVudElkID0gcGF0aWVudElkO1xyXG5cclxuICAgIGJhc2Uuc3dpdGNoVG8xMTBMYXlvdXQoKTtcclxuXHJcbiAgICBwdC5zaG93SW5kaXZpZHVhbFBhdGllbnRQYW5lbChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcbiAgfSxcclxuXHJcbiAgc2hvd0luZGl2aWR1YWxQYXRpZW50UGFuZWw6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKSB7XHJcbiAgICB2YXIgc3RhbiA9IGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0gPyBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLnRhYi50aXRsZSA6IFwiVU5TUEVDSUZJRURcIjtcclxuXHJcbiAgICBkYXRhLm9wdGlvbnMuc29ydChmdW5jdGlvbihhLCBiKSB7XHJcbiAgICAgIGEgPSBkYXRhLmdldFBhdGllbnRTdGF0dXMocGF0aWVudElkLCBhLnBhdGh3YXlJZCwgYS5wYXRod2F5U3RhZ2UsIGEuc3RhbmRhcmQpO1xyXG4gICAgICBiID0gZGF0YS5nZXRQYXRpZW50U3RhdHVzKHBhdGllbnRJZCwgYi5wYXRod2F5SWQsIGIucGF0aHdheVN0YWdlLCBiLnN0YW5kYXJkKTtcclxuXHJcbiAgICAgIGlmIChhID09PSBiKSByZXR1cm4gMDtcclxuICAgICAgaWYgKGEgPT09IFwibm90XCIpIHJldHVybiAxO1xyXG4gICAgICBpZiAoYiA9PT0gXCJub3RcIikgcmV0dXJuIC0xO1xyXG4gICAgICBpZiAoYSA9PT0gXCJva1wiKSByZXR1cm4gMTtcclxuICAgICAgaWYgKGIgPT09IFwib2tcIikgcmV0dXJuIC0xO1xyXG4gICAgICBhbGVydChcIiEhISEhISFcIik7XHJcbiAgICB9KTtcclxuXHJcbiAgICB2YXIgcGFuZWwgPSBiYXNlLmNyZWF0ZVBhbmVsKCQoJyNwYXRpZW50LXBhbmVsJyksIHtcclxuICAgICAgXCJvcHRpb25zXCI6IGRhdGEub3B0aW9ucyxcclxuICAgICAgXCJudW1iZXJPZlN0YW5kYXJkc01pc3NlZFwiOiBkYXRhLm51bWJlck9mU3RhbmRhcmRzTWlzc2VkKHBhdGllbnRJZCksXHJcbiAgICAgIFwic3RhbmRhcmRcIjogc3RhbixcclxuICAgICAgXCJwYXRod2F5U3RhZ2VcIjogcGF0aHdheVN0YWdlLFxyXG4gICAgICBcIm5oc051bWJlclwiOiBkYXRhLnBhdExvb2t1cCA/IGRhdGEucGF0TG9va3VwW3BhdGllbnRJZF0gOiBwYXRpZW50SWQsXHJcbiAgICAgIFwicGF0aWVudElkXCI6IHBhdGllbnRJZFxyXG4gICAgfSwge1xyXG4gICAgICBcIm9wdGlvblwiOiAkKCcjcGF0aWVudC1wYW5lbC1kcm9wLWRvd24tb3B0aW9ucycpLmh0bWwoKVxyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKHN0YW5kYXJkID09PSBudWxsKSB7XHJcbiAgICAgIC8vTXVzdCBiZSBhIHBhdGllbnQgZnJvbSB0aGUgKioqIE9LIGdyb3VwXHJcbiAgICAgIHN0YW5kYXJkID0gZGF0YS5vcHRpb25zLmZpbHRlcihmdW5jdGlvbih2YWwpIHtcclxuICAgICAgICByZXR1cm4gdmFsLnBhdGh3YXlJZCA9PT0gcGF0aHdheUlkICYmIHZhbC5wYXRod2F5U3RhZ2UgPT09IHBhdGh3YXlTdGFnZTtcclxuICAgICAgfSlbMF0uc3RhbmRhcmQ7XHJcbiAgICB9XHJcblxyXG4gICAgZmFyUmlnaHRQYW5lbC5odG1sKFwiXCIpO1xyXG4gICAgJCgnI3RlbXAtaGlkZGVuJykuaHRtbChwYW5lbCk7XHJcblxyXG4gICAgdmFyIGFjdGlvblBsYW4gPSBpbmRpdmlkdWFsQWN0aW9uUGxhbi5jcmVhdGUocGF0aHdheVN0YWdlKTtcclxuICAgICQoJyN0ZW1wLWhpZGRlbiAjcGF0aWVudC1wYW5lbC1yaWdodCcpLmh0bWwoYWN0aW9uUGxhbik7XHJcblxyXG4gICAgdmFyIHF1YWxQYW5lbCA9IHF1YWxpdHlTdGFuZGFyZC5jcmVhdGUocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gICAgdmFyIHRyZW5kUGFuZWwgPSB0cmVuZC5jcmVhdGUocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gICAgdmFyIG1lZFBhbmVsID0gbWVkaWNhdGlvbi5jcmVhdGUocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gICAgdmFyIGNvZGVzUGFuZWwgPSBvdGhlckNvZGVzLmNyZWF0ZShwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcbiAgICB2YXIgbWVkQ29kZVdyYXBwZXJQYW5lbCA9IGJhc2UuY3JlYXRlUGFuZWwoJCgnI290aGVyLWNvZGVzLWFuZC1tZWRzLXdyYXBwZXItcGFuZWwnKSk7XHJcbiAgICAkKCcjdGVtcC1oaWRkZW4gI3BhdGllbnQtcGFuZWwtdG9wJykuaHRtbChxdWFsUGFuZWwpO1xyXG4gICAgJCgnI3RlbXAtaGlkZGVuICNwYXRpZW50LXBhbmVsLWxlZnQnKS5odG1sKFwiXCIpLmFwcGVuZCh0cmVuZFBhbmVsKS5hcHBlbmQobWVkQ29kZVdyYXBwZXJQYW5lbCk7XHJcbiAgICAkKCcjdGVtcC1oaWRkZW4gI21lZENvZGVXcmFwcGVyUGFuZWwnKS5hcHBlbmQobWVkUGFuZWwpLmFwcGVuZChjb2Rlc1BhbmVsKTtcclxuXHJcbiAgICBpZiAoZmFyUmlnaHRQYW5lbC5pcygnOnZpc2libGUnKSkge1xyXG4gICAgICBmYXJSaWdodFBhbmVsLmZhZGVPdXQoNTAwLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAkKHRoaXMpLmh0bWwoJCgnI3RlbXAtaGlkZGVuJykuaHRtbCgpKTtcclxuICAgICAgICAkKCcjdGVtcC1oaWRkZW4nKS5odG1sKFwiXCIpO1xyXG4gICAgICAgIGluZGl2aWR1YWxBY3Rpb25QbGFuLndpcmVVcChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcbiAgICAgICAgcXVhbGl0eVN0YW5kYXJkLndpcmVVcChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcbiAgICAgICAgYmFzZS53aXJlVXBTdGFuZGFyZERyb3BEb3duKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcHQuc2hvd0luZGl2aWR1YWxQYXRpZW50UGFuZWwpO1xyXG4gICAgICAgIHRyZW5kLndpcmVVcChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcbiAgICAgICAgbWVkaWNhdGlvbi53aXJlVXAocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gICAgICAgIG90aGVyQ29kZXMud2lyZVVwKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgICAgICBjaGFydC5kcmF3VHJlbmRDaGFydChwYXRpZW50SWQsIHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCk7XHJcbiAgICAgICAgJCh0aGlzKS5mYWRlSW4oNTAwLCBmdW5jdGlvbigpIHt9KTtcclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBmYXJSaWdodFBhbmVsLmh0bWwoJCgnI3RlbXAtaGlkZGVuJykuaHRtbCgpKTtcclxuICAgICAgJCgnI3RlbXAtaGlkZGVuJykuaHRtbChcIlwiKTtcclxuICAgICAgaW5kaXZpZHVhbEFjdGlvblBsYW4ud2lyZVVwKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgICAgcXVhbGl0eVN0YW5kYXJkLndpcmVVcChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcbiAgICAgIGJhc2Uud2lyZVVwU3RhbmRhcmREcm9wRG93bihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHB0LnNob3dJbmRpdmlkdWFsUGF0aWVudFBhbmVsKTtcclxuICAgICAgdHJlbmQud2lyZVVwKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgICAgbWVkaWNhdGlvbi53aXJlVXAocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gICAgICBvdGhlckNvZGVzLndpcmVVcChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcbiAgICAgIGNoYXJ0LmRyYXdUcmVuZENoYXJ0KHBhdGllbnRJZCwgcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkKTtcclxuICAgICAgZmFyUmlnaHRQYW5lbC5mYWRlSW4oNTAwLCBmdW5jdGlvbigpIHt9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBwdDtcclxuIiwidmFyIGJhc2UgPSByZXF1aXJlKCcuLi9iYXNlLmpzJyksXHJcbiAgZGF0YSA9IHJlcXVpcmUoJy4uL2RhdGEuanMnKSxcclxuICBsb2cgPSByZXF1aXJlKCcuLi9sb2cuanMnKSxcclxuICBjb25maXJtID0gcmVxdWlyZSgnLi9jb25maXJtLmpzJyk7XHJcblxyXG52YXIgSUQgPSBcIlFVQUxJVFlTVEFOREFSRFwiO1xyXG5cclxudmFyIHFzID0ge1xyXG5cclxuICBjcmVhdGU6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKSB7XHJcblxyXG4gICAgdmFyIGxvY2FsRGF0YSA9IHtcclxuICAgICAgXCJuaHNOdW1iZXJcIjogZGF0YS5wYXRMb29rdXAgPyBkYXRhLnBhdExvb2t1cFtwYXRpZW50SWRdIDogcGF0aWVudElkLFxyXG4gICAgICBcInBhdGllbnRJZFwiOiBwYXRpZW50SWRcclxuICAgIH07XHJcbiAgICBsb2NhbERhdGEuc3RhbmRhcmQgPSBkYXRhLnBhdGh3YXlOYW1lc1twYXRod2F5SWRdICsgJyAtICcgKyBwYXRod2F5U3RhZ2U7XHJcbiAgICBpZiAoZGF0YS5wYXRpZW50c1twYXRpZW50SWRdLnN0YW5kYXJkcyAmJiBkYXRhLnBhdGllbnRzW3BhdGllbnRJZF0uc3RhbmRhcmRzW3BhdGh3YXlJZF0gJiZcclxuICAgICAgZGF0YS5wYXRpZW50c1twYXRpZW50SWRdLnN0YW5kYXJkc1twYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0gJiZcclxuICAgICAgZGF0YS5wYXRpZW50c1twYXRpZW50SWRdLnN0YW5kYXJkc1twYXRod2F5SWRdW3BhdGh3YXlTdGFnZV1bc3RhbmRhcmRdKSB7XHJcbiAgICAgIGxvY2FsRGF0YS5zdGFuZGFyZCA9IGRhdGEucGF0aWVudHNbcGF0aWVudElkXS5zdGFuZGFyZHNbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdW3N0YW5kYXJkXTtcclxuICAgIH1cclxuXHJcbiAgICBsb2NhbERhdGEudG9vbHRpcCA9IGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF1bXCJzdGFuZGFyZC1tZXQtdG9vbHRpcFwiXTtcclxuXHJcbiAgICBzd2l0Y2ggKGRhdGEuZ2V0UGF0aWVudFN0YXR1cyhwYXRpZW50SWQsIHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCkpIHtcclxuICAgICAgY2FzZSBcIm9rXCI6XHJcbiAgICAgICAgLy8vL2ZhclJpZ2h0UGFuZWwucmVtb3ZlQ2xhc3MoJ3N0YW5kYXJkLW1pc3NlZC1wYWdlJykuYWRkQ2xhc3MoJ3N0YW5kYXJkLWFjaGlldmVkLXBhZ2UnKS5yZW1vdmVDbGFzcygnc3RhbmRhcmQtbm90LXJlbGV2YW50LXBhZ2UnKTtcclxuICAgICAgICBsb2NhbERhdGEuYWNoaWV2ZWQgPSB0cnVlO1xyXG4gICAgICAgIGxvY2FsRGF0YS5yZWxldmFudCA9IHRydWU7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgXCJtaXNzZWRcIjpcclxuICAgICAgICAvLy8vZmFyUmlnaHRQYW5lbC5hZGRDbGFzcygnc3RhbmRhcmQtbWlzc2VkLXBhZ2UnKS5yZW1vdmVDbGFzcygnc3RhbmRhcmQtYWNoaWV2ZWQtcGFnZScpLnJlbW92ZUNsYXNzKCdzdGFuZGFyZC1ub3QtcmVsZXZhbnQtcGFnZScpO1xyXG4gICAgICAgIGxvY2FsRGF0YS5yZWxldmFudCA9IHRydWU7XHJcbiAgICAgICAgbG9jYWxEYXRhLmFjaGlldmVkID0gZmFsc2U7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgXCJub3RcIjpcclxuICAgICAgICAvLy8vZmFyUmlnaHRQYW5lbC5yZW1vdmVDbGFzcygnc3RhbmRhcmQtbWlzc2VkLXBhZ2UnKS5yZW1vdmVDbGFzcygnc3RhbmRhcmQtYWNoaWV2ZWQtcGFnZScpLmFkZENsYXNzKCdzdGFuZGFyZC1ub3QtcmVsZXZhbnQtcGFnZScpO1xyXG4gICAgICAgIGxvY2FsRGF0YS5yZWxldmFudCA9IGZhbHNlO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG5cclxuICAgIHZhciBhZ09iaiA9IGxvZy5nZXRQYXRpZW50QWdyZWVPYmplY3QocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQsIFwic3RhbmRhcmRcIik7XHJcbiAgICBpZiAoYWdPYmogJiYgYWdPYmouYWdyZWUpIGxvY2FsRGF0YS5hZ3JlZSA9IHRydWU7XHJcbiAgICBlbHNlIGlmIChhZ09iaiAmJiBhZ09iai5hZ3JlZSA9PT0gZmFsc2UpIGxvY2FsRGF0YS5kaXNhZ3JlZSA9IHRydWU7XHJcblxyXG4gICAgcmV0dXJuIGJhc2UuY3JlYXRlUGFuZWwoJCgnI3F1YWwtc3RhbmRhcmQnKSwgbG9jYWxEYXRhKTtcclxuICB9LFxyXG5cclxuICBzaG93OiBmdW5jdGlvbihwYW5lbCwgcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpe1xyXG5cclxuICAgIHZhciBwYW5lbElkID0gcGFuZWwuYXR0cihcImlkXCIpO1xyXG5cclxuICAgIGlmIChiYXNlLnBhbmVsc1twYW5lbElkXSAmJlxyXG4gICAgICBiYXNlLnBhbmVsc1twYW5lbElkXS5pZCA9PT0gSUQgJiZcclxuICAgICAgYmFzZS5wYW5lbHNbcGFuZWxJZF0ucGF0aWVudElkID09PSBwYXRpZW50SWQpIHtcclxuICAgICAgICAvL0FscmVhZHkgc2hvd2luZyB0aGUgcmlnaHQgdGhpbmdcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgYmFzZS5wYW5lbHNbcGFuZWxJZF0gPSB7XHJcbiAgICAgIGlkOiBJRCxcclxuICAgICAgcGF0aWVudElkOiBwYXRpZW50SWRcclxuICAgIH07XHJcblxyXG4gICAgcGFuZWwuaHRtbChxcy5jcmVhdGUocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpKTtcclxuICAgIHFzLndpcmVVcChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcbiAgfSxcclxuXHJcbiAgd2lyZVVwOiBmdW5jdGlvbihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCkge1xyXG4gICAgY29uZmlybS53aXJlVXAoJCgnI3F1YWwtYWdyZWUtZGlzYWdyZWUnKSwgJCgnI2luZGl2aWR1YWwtcGFuZWwtY2xhc3NpZmljYXRpb24nKSwgcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQsIFwic3RhbmRhcmRcIiwgXCJxdWFsaXR5IHN0YW5kYXJkXCIpO1xyXG4gIH0sXHJcblxyXG4gIHVwZGF0ZTogZnVuY3Rpb24oKSB7XHJcbiAgICAkKCcjaW5kaXZpZHVhbC1wYW5lbC1jbGFzc2lmaWNhdGlvbicpLmZpbmQoJ2RpdicpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBzZWxmID0gJCh0aGlzKTtcclxuICAgICAgdmFyIGFueSA9IGZhbHNlO1xyXG4gICAgICBzZWxmLmZpbmQoJy5idG4tdG9nZ2xlIGlucHV0W3R5cGU9Y2hlY2tib3hdOmNoZWNrZWQnKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBpc0NsYXNzaWZpY2F0aW9uID0gJCh0aGlzKS5jbG9zZXN0KFwiZGl2XCIpLmRhdGEoXCJpc0NsYXNzaWZpY2F0aW9uXCIpICE9PSB1bmRlZmluZWQ7XHJcbiAgICAgICAgYW55ID0gdHJ1ZTtcclxuICAgICAgICB2YXIgaXRlbSA9IGxvZy5nZXRBZ3JlZXMoKVtkYXRhLnBhdGllbnRJZF0uZmlsdGVyKGZ1bmN0aW9uKGkpIHtcclxuICAgICAgICAgIHJldHVybiBpc0NsYXNzaWZpY2F0aW9uID8gaS5pdGVtID09PSBcInNlY3Rpb25cIiA6IGkuaXRlbSAhPT0gXCJzZWN0aW9uXCI7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIHRvb2w7XHJcbiAgICAgICAgaWYgKHRoaXMudmFsdWUgPT09IFwieWVzXCIpIHtcclxuICAgICAgICAgIGlmIChpdGVtICYmIGl0ZW1bMF0uaGlzdG9yeSkge1xyXG4gICAgICAgICAgICB0b29sID0gXCI8cD5cIiArIGl0ZW1bMF0uaGlzdG9yeVswXSArIFwiPC9wPjxwPkNsaWNrIGFnYWluIHRvIGNhbmNlbDwvcD5cIjtcclxuICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5hdHRyKFwidGl0bGVcIiwgdG9vbCkuYXR0cihcImRhdGEtb3JpZ2luYWwtdGl0bGVcIiwgdG9vbCkudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAkKHRoaXMpLnBhcmVudCgpLmF0dHIoXCJ0aXRsZVwiLCBcIllvdSBhZ3JlZWQgLSBjbGljayBhZ2FpbiB0byBjYW5jZWxcIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGlmIChpdGVtICYmIGl0ZW1bMF0uaGlzdG9yeSkge1xyXG4gICAgICAgICAgICB0b29sID0gXCI8cD5cIiArIGl0ZW1bMF0uaGlzdG9yeVswXSArIFwiPC9wPjxwPkNsaWNrIGFnYWluIHRvIGVkaXQvY2FuY2VsPC9wPlwiO1xyXG4gICAgICAgICAgICAkKHRoaXMpLnBhcmVudCgpLmF0dHIoXCJ0aXRsZVwiLCB0b29sKS5hdHRyKFwiZGF0YS1vcmlnaW5hbC10aXRsZVwiLCB0b29sKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICQodGhpcykucGFyZW50KCkuYXR0cihcInRpdGxlXCIsIFwiWW91IGRpc2FncmVlZCAtIGNsaWNrIGFnYWluIHRvIGVkaXQvY2FuY2VsXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcblxyXG4gICAgICBpZiAoc2VsZi5maW5kKCcuYnRuLXRvZ2dsZSBpbnB1dFt0eXBlPWNoZWNrYm94XTpub3QoOmNoZWNrZWQpJykubGVuZ3RoID09IDEpIHtcclxuICAgICAgICBzZWxmLmZpbmQoJy5idG4tdG9nZ2xlIGlucHV0W3R5cGU9Y2hlY2tib3hdOm5vdCg6Y2hlY2tlZCknKS5wYXJlbnQoKS5hZGRDbGFzcyhcImluYWN0aXZlXCIpLmF0dHIoXCJ0aXRsZVwiLCBcIlwiKS5hdHRyKFwiZGF0YS1vcmlnaW5hbC10aXRsZVwiLCBcIlwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKCFhbnkpIHtcclxuICAgICAgICBzZWxmLmZpbmQoJy5idG4tdG9nZ2xlLmJ0bi15ZXMnKS5hdHRyKFwidGl0bGVcIiwgXCJDbGljayB0byBhZ3JlZSB3aXRoIHRoaXMgYWN0aW9uIGFuZCBzYXZlIGl0IGluIHlvdXIgYWdyZWVkIGFjdGlvbnMgbGlzdCAgXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgIHNlbGYuZmluZCgnLmJ0bi10b2dnbGUuYnRuLW5vJykuYXR0cihcInRpdGxlXCIsIFwiQ2xpY2sgdG8gZGlzYWdyZWUgd2l0aCB0aGlzIGFjdGlvbiBhbmQgcmVtb3ZlIGl0IGZyb20geW91ciBzdWdnZXN0ZWQgYWN0aW9ucyBsaXN0IFwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gIH1cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHFzO1xyXG4iLCJ2YXIgZGF0YSA9IHJlcXVpcmUoJy4uL2RhdGEuanMnKSxcclxuICBNdXN0YWNoZSA9IHJlcXVpcmUoJ211c3RhY2hlJyk7XHJcblxyXG52YXIgcXMgPSB7XHJcblxyXG4gIHNob3c6IGZ1bmN0aW9uKHBhbmVsLCBpc0FwcGVuZCwgcGF0aWVudElkKSB7XHJcblxyXG4gICAgdmFyIHBhdGllbnREYXRhID0gZGF0YS5nZXRQYXRpZW50RGF0YShwYXRpZW50SWQpO1xyXG5cclxuICAgIHZhciB0ZW1wTXVzdCA9ICQoJyNxdWFsaXR5LXN0YW5kYXJkLXBhbmVsJykuaHRtbCgpO1xyXG4gICAgdmFyIGh0bWwgPSBNdXN0YWNoZS5yZW5kZXIodGVtcE11c3QsIHtcclxuICAgICAgXCJzdGFuZGFyZHNcIjogcGF0aWVudERhdGEuc3RhbmRhcmRzXHJcbiAgICB9KTtcclxuXHJcbiAgICBpZiAoaXNBcHBlbmQpIHBhbmVsLmFwcGVuZChodG1sKTtcclxuICAgIGVsc2UgcGFuZWwuaHRtbChodG1sKTtcclxuXHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gcXM7XHJcbiIsInZhciBiYXNlID0gcmVxdWlyZSgnLi4vYmFzZS5qcycpLFxyXG4gIGNvbmZpcm0gPSByZXF1aXJlKCcuL2NvbmZpcm0uanMnKSxcclxuICBkYXRhID0gcmVxdWlyZSgnLi4vZGF0YS5qcycpLFxyXG4gIGxvZyA9IHJlcXVpcmUoJy4uL2xvZy5qcycpO1xyXG5cclxudmFyIHRhcCA9IHtcclxuXHJcbiAgc2hvdzogZnVuY3Rpb24obG9jYXRpb24pIHtcclxuICAgIGxvY2F0aW9uLnJlbW92ZUNsYXNzKCdzdGFuZGFyZC1taXNzZWQtcGFnZScpLnJlbW92ZUNsYXNzKCdzdGFuZGFyZC1hY2hpZXZlZC1wYWdlJykucmVtb3ZlQ2xhc3MoJ3N0YW5kYXJkLW5vdC1yZWxldmFudC1wYWdlJyk7XHJcbiAgICBiYXNlLmNyZWF0ZVBhbmVsU2hvdygkKCcjdGVhbS1hY3Rpb24tcGxhbi1wYW5lbCcpLCBsb2NhdGlvbik7XHJcblxyXG4gICAgc3VnZ2VzdGVkUGxhblRlYW0gPSAkKCcjc3VnZ2VzdGVkUGxhblRlYW0nKTtcclxuXHJcbiAgICBzdWdnZXN0ZWRQbGFuVGVhbS5vbignY2xpY2snLCAnLmNyLXN0eWxlZCBpbnB1dFt0eXBlPWNoZWNrYm94XScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgQUNUSU9OSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YSgnaWQnKTtcclxuICAgICAgbG9nLmVkaXRBY3Rpb24oXCJ0ZWFtXCIsIEFDVElPTklELCBudWxsLCB0aGlzLmNoZWNrZWQpO1xyXG5cclxuICAgICAgaWYgKHRoaXMuY2hlY2tlZCkge1xyXG4gICAgICAgIGxvZy5yZWNvcmRFdmVudChkYXRhLnBhdGh3YXlJZCwgXCJ0ZWFtXCIsIFwiSXRlbSBjb21wbGV0ZWRcIik7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgICQoc2VsZikucGFyZW50KCkuYXR0cihcInRpdGxlXCIsIFwiXCIpLmF0dHIoXCJkYXRhLW9yaWdpbmFsLXRpdGxlXCIsIFwiXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICQoc2VsZikucGFyZW50KCkuZmFkZU91dCgzMDAsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgcGFyZW50ID0gJCh0aGlzKS5wYXJlbnQoKTtcclxuICAgICAgICAgICAgJCh0aGlzKS5yZXBsYWNlV2l0aChiYXNlLmNyZWF0ZVBhbmVsKCQoJyNjaGVja2JveC10ZW1wbGF0ZScpLCB7XHJcbiAgICAgICAgICAgICAgXCJkb25lXCI6IHRydWVcclxuICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICBwYXJlbnQuZmluZCgnYnV0dG9uJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgQUNUSU9OSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YSgnaWQnKTtcclxuICAgICAgICAgICAgICBsb2cuZWRpdEFjdGlvbihcInRlYW1cIiwgQUNUSU9OSUQsIG51bGwsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAkKHRoaXMpLnJlcGxhY2VXaXRoKGJhc2UuY3JlYXRlUGFuZWwoJCgnI2NoZWNrYm94LXRlbXBsYXRlJyksIHtcclxuICAgICAgICAgICAgICAgIFwiZG9uZVwiOiBmYWxzZVxyXG4gICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgICB0YXAudXBkYXRlVGVhbVNhcFJvd3MoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9LCAxMDAwKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgdGFwLnVwZGF0ZVRlYW1TYXBSb3dzKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAkKCcjcGVyc29uYWxQbGFuVGVhbScpLm9uKCdjbGljaycsICdpbnB1dFt0eXBlPWNoZWNrYm94XScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgUExBTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoXCJpZFwiKTtcclxuICAgICAgZWRpdFBsYW4oUExBTklELCBudWxsLCB0aGlzLmNoZWNrZWQpO1xyXG5cclxuICAgICAgaWYgKHRoaXMuY2hlY2tlZCkge1xyXG4gICAgICAgICQodGhpcykucGFyZW50KCkucGFyZW50KCkucGFyZW50KCkuYWRkQ2xhc3MoJ3N1Y2Nlc3MnKTtcclxuICAgICAgICByZWNvcmRFdmVudChkYXRhLnBhdGh3YXlJZCwgXCJ0ZWFtXCIsIFwiUGVyc29uYWwgcGxhbiBpdGVtXCIpO1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAkKHNlbGYpLnBhcmVudCgpLmF0dHIoXCJ0aXRsZVwiLCBcIlwiKS5hdHRyKFwiZGF0YS1vcmlnaW5hbC10aXRsZVwiLCBcIlwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICQoc2VsZikucGFyZW50KCkuZmFkZU91dCgzMDAsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgcGFyZW50ID0gJCh0aGlzKS5wYXJlbnQoKTtcclxuICAgICAgICAgICAgJCh0aGlzKS5yZXBsYWNlV2l0aChiYXNlLmNyZWF0ZVBhbmVsKCQoJyNjaGVja2JveC10ZW1wbGF0ZScpLCB7XHJcbiAgICAgICAgICAgICAgXCJkb25lXCI6IHRydWVcclxuICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICAgICAgICAgIHBhcmVudC5maW5kKCdidXR0b24nKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICBQTEFOSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YSgnaWQnKTtcclxuICAgICAgICAgICAgICBlZGl0UGxhbihcInRlYW1cIiwgUExBTklELCBudWxsLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgJCh0aGlzKS5yZXBsYWNlV2l0aChiYXNlLmNyZWF0ZVBhbmVsKCQoJyNjaGVja2JveC10ZW1wbGF0ZScpLCB7XHJcbiAgICAgICAgICAgICAgICBcImRvbmVcIjogZmFsc2VcclxuICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgdGFwLnVwZGF0ZVRlYW1TYXBSb3dzKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSwgMTAwMCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICB9KS5vbignY2xpY2snLCAnLmJ0bi11bmRvJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICB2YXIgUExBTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoJ2lkJyk7XHJcbiAgICAgIGxvZy5lZGl0UGxhbihQTEFOSUQsIG51bGwsIGZhbHNlKTtcclxuICAgICAgJCh0aGlzKS5yZXBsYWNlV2l0aChiYXNlLmNyZWF0ZVBhbmVsKCQoJyNjaGVja2JveC10ZW1wbGF0ZScpLCB7XHJcbiAgICAgICAgXCJkb25lXCI6IGZhbHNlXHJcbiAgICAgIH0pKTtcclxuICAgICAgdGFwLnVwZGF0ZVRlYW1TYXBSb3dzKCk7XHJcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB2YXIgdGVhbVRhYiA9ICQoJyN0YWItcGxhbi10ZWFtJyksXHJcbiAgICAgIGN1cnJlbnQ7XHJcbiAgICB0ZWFtVGFiLm9uKCdjbGljaycsICcuZWRpdC1wbGFuJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBQTEFOSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YShcImlkXCIpO1xyXG5cclxuICAgICAgJCgnI2VkaXRBY3Rpb25QbGFuSXRlbScpLnZhbCgkKCQodGhpcykuY2xvc2VzdCgndHInKS5jaGlsZHJlbigndGQnKVswXSkuZmluZCgnc3BhbicpLnRleHQoKSk7XHJcblxyXG4gICAgICAkKCcjZWRpdFBsYW4nKS5vZmYoJ2hpZGRlbi5icy5tb2RhbCcpLm9uKCdoaWRkZW4uYnMubW9kYWwnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICB0YXAuZGlzcGxheVBlcnNvbmFsaXNlZFRlYW1BY3Rpb25QbGFuKCQoJyNwZXJzb25hbFBsYW5UZWFtJykpO1xyXG4gICAgICB9KS5vZmYoJ3Nob3duLmJzLm1vZGFsJykub24oJ3Nob3duLmJzLm1vZGFsJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgJCgnI2VkaXRBY3Rpb25QbGFuSXRlbScpLmZvY3VzKCk7XHJcbiAgICAgIH0pLm9mZignY2xpY2snLCAnLnNhdmUtcGxhbicpLm9uKCdjbGljaycsICcuc2F2ZS1wbGFuJywgZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgIGxvZy5lZGl0UGxhbihQTEFOSUQsICQoJyNlZGl0QWN0aW9uUGxhbkl0ZW0nKS52YWwoKSk7XHJcblxyXG4gICAgICAgICQoJyNlZGl0UGxhbicpLm1vZGFsKCdoaWRlJyk7XHJcbiAgICAgIH0pLm9mZigna2V5dXAnLCAnI2VkaXRBY3Rpb25QbGFuSXRlbScpLm9uKCdrZXl1cCcsICcjZWRpdEFjdGlvblBsYW5JdGVtJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgIGlmIChlLndoaWNoID09PSAxMykgJCgnI2VkaXRQbGFuIC5zYXZlLXBsYW4nKS5jbGljaygpO1xyXG4gICAgICB9KS5tb2RhbCgpO1xyXG4gICAgfSkub24oJ2NsaWNrJywgJy5kZWxldGUtcGxhbicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgUExBTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoXCJpZFwiKTtcclxuXHJcbiAgICAgICQoJyN0ZWFtLWRlbGV0ZS1pdGVtJykuaHRtbCgkKCQodGhpcykuY2xvc2VzdCgndHInKS5jaGlsZHJlbigndGQnKVswXSkuZmluZCgnc3BhbicpLnRleHQoKSk7XHJcblxyXG4gICAgICAkKCcjZGVsZXRlUGxhbicpLm9mZignaGlkZGVuLmJzLm1vZGFsJykub24oJ2hpZGRlbi5icy5tb2RhbCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRhcC5kaXNwbGF5UGVyc29uYWxpc2VkVGVhbUFjdGlvblBsYW4oJCgnI3BlcnNvbmFsUGxhblRlYW0nKSk7XHJcbiAgICAgIH0pLm9mZignY2xpY2snLCAnLmRlbGV0ZS1wbGFuJykub24oJ2NsaWNrJywgJy5kZWxldGUtcGxhbicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGxvZy5kZWxldGVQbGFuKFBMQU5JRCk7XHJcblxyXG4gICAgICAgICQoJyNkZWxldGVQbGFuJykubW9kYWwoJ2hpZGUnKTtcclxuICAgICAgfSkubW9kYWwoKTtcclxuICAgIH0pLm9uKCdjbGljaycsICcuYWRkLXBsYW4nLCBmdW5jdGlvbigpIHtcclxuICAgICAgbG9nLnJlY29yZFBsYW4oXCJ0ZWFtXCIsICQodGhpcykucGFyZW50KCkucGFyZW50KCkuZmluZCgndGV4dGFyZWEnKS52YWwoKSwgZGF0YS5wYXRod2F5SWQpO1xyXG5cclxuICAgICAgdGFwLmRpc3BsYXlQZXJzb25hbGlzZWRUZWFtQWN0aW9uUGxhbigkKCcjcGVyc29uYWxQbGFuVGVhbScpKTtcclxuICAgIH0pLm9uKCdjaGFuZ2UnLCAnLmJ0bi10b2dnbGUgaW5wdXRbdHlwZT1jaGVja2JveF0nLCBmdW5jdGlvbigpIHtcclxuICAgICAgdGFwLnVwZGF0ZVRlYW1TYXBSb3dzKCk7XHJcbiAgICB9KS5vbignY2xpY2snLCAnLmJ0bi11bmRvJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICB2YXIgQUNUSU9OSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YSgnaWQnKTtcclxuICAgICAgbG9nLmVkaXRBY3Rpb24oXCJ0ZWFtXCIsIEFDVElPTklELCBudWxsLCBmYWxzZSk7XHJcbiAgICAgICQodGhpcykucmVwbGFjZVdpdGgoYmFzZS5jcmVhdGVQYW5lbCgkKCcjY2hlY2tib3gtdGVtcGxhdGUnKSwge1xyXG4gICAgICAgIFwiZG9uZVwiOiBmYWxzZVxyXG4gICAgICB9KSk7XHJcbiAgICAgIHRhcC51cGRhdGVUZWFtU2FwUm93cygpO1xyXG4gICAgfSkub24oJ2NsaWNrJywgJy5idG4teWVzLC5idG4tbm8nLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIHZhciBjaGVja2JveCA9ICQodGhpcykuZmluZChcImlucHV0W3R5cGU9Y2hlY2tib3hdXCIpO1xyXG4gICAgICB2YXIgb3RoZXIgPSAkKHRoaXMpLnBhcmVudCgpLmZpbmQoJCh0aGlzKS5oYXNDbGFzcyhcImJ0bi15ZXNcIikgPyBcIi5idG4tbm9cIiA6IFwiLmJ0bi15ZXNcIik7XHJcbiAgICAgIHZhciBBQ1RJT05JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKCdpZCcpO1xyXG4gICAgICBpZiAoJCh0aGlzKS5oYXNDbGFzcyhcImFjdGl2ZVwiKSAmJiBvdGhlci5oYXNDbGFzcyhcImluYWN0aXZlXCIpICYmICEkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuaGFzQ2xhc3MoJ3N1Y2Nlc3MnKSkge1xyXG4gICAgICAgIC8vdW5zZWxlY3RpbmdcclxuICAgICAgICBpZiAoY2hlY2tib3gudmFsKCkgPT09IFwibm9cIikge1xyXG4gICAgICAgICAgdGFwLmxhdW5jaE1vZGFsKGRhdGEuc2VsZWN0ZWQsIGNoZWNrYm94LmNsb3Nlc3QoJ3RyJykuY2hpbGRyZW4oKS5maXJzdCgpLmNoaWxkcmVuKCkuZmlyc3QoKS50ZXh0KCksIGxvZy5nZXRSZWFzb24oXCJ0ZWFtXCIsIEFDVElPTklEKSwgdHJ1ZSwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGxvZy5lZGl0QWN0aW9uKFwidGVhbVwiLCBBQ1RJT05JRCwgZmFsc2UsIG51bGwsIGxvZy5yZWFzb24pO1xyXG4gICAgICAgICAgICB0YXAudXBkYXRlVGVhbVNhcFJvd3MoKTtcclxuICAgICAgICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgICAgICAgfSwgbnVsbCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGxvZy5pZ25vcmVBY3Rpb24oXCJ0ZWFtXCIsIEFDVElPTklEKTtcclxuICAgICAgICAgICAgb3RoZXIucmVtb3ZlQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgY2hlY2tib3gucmVtb3ZlQXR0cihcImNoZWNrZWRcIik7XHJcbiAgICAgICAgICAgIGNoZWNrYm94LnBhcmVudCgpLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICB0YXAudXBkYXRlVGVhbVNhcFJvd3MoKTtcclxuICAgICAgICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBsb2cuaWdub3JlQWN0aW9uKFwidGVhbVwiLCBBQ1RJT05JRCk7XHJcbiAgICAgICAgICBvdGhlci5yZW1vdmVDbGFzcyhcImluYWN0aXZlXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIGlmICgoISQodGhpcykuaGFzQ2xhc3MoXCJhY3RpdmVcIikgJiYgb3RoZXIuaGFzQ2xhc3MoXCJhY3RpdmVcIikpIHx8ICQodGhpcykuY2xvc2VzdCgndHInKS5oYXNDbGFzcygnc3VjY2VzcycpKSB7XHJcbiAgICAgICAgLy9wcmV2ZW50IGNsaWNraW5nIG9uIHVuc2VsZWN0ZWQgb3B0aW9uIG9yIGlmIHRoZSByb3cgaXMgY29tcGxldGVcclxuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy9zZWxlY3RpbmdcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgaWYgKGNoZWNrYm94LnZhbCgpID09PSBcIm5vXCIpIHtcclxuICAgICAgICAgIHRhcC5sYXVuY2hNb2RhbChkYXRhLnNlbGVjdGVkLCBjaGVja2JveC5jbG9zZXN0KCd0cicpLmNoaWxkcmVuKCkuZmlyc3QoKS5jaGlsZHJlbigpLmZpcnN0KCkudGV4dCgpLCBsb2cuZ2V0UmVhc29uKFwidGVhbVwiLCBBQ1RJT05JRCksIGZhbHNlLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgbG9nLmVkaXRBY3Rpb24oXCJ0ZWFtXCIsIEFDVElPTklELCBmYWxzZSwgbnVsbCwgbG9nLnJlYXNvbik7XHJcbiAgICAgICAgICAgICQoc2VsZikucmVtb3ZlQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuXHJcbiAgICAgICAgICAgIGNoZWNrYm94LmF0dHIoXCJjaGVja2VkXCIsIFwiY2hlY2tlZFwiKTtcclxuICAgICAgICAgICAgY2hlY2tib3gucGFyZW50KCkuYWRkQ2xhc3MoXCJhY3RpdmVcIik7XHJcbiAgICAgICAgICAgIC8vdW5zZWxlY3Qgb3RoZXJcclxuICAgICAgICAgICAgb3RoZXIucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIikuYWRkQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgb3RoZXIuZmluZChcImlucHV0W3R5cGU9Y2hlY2tib3hdXCIpLnByb3AoXCJjaGVja2VkXCIsIGZhbHNlKTtcclxuICAgICAgICAgICAgdGFwLnVwZGF0ZVRlYW1TYXBSb3dzKCk7XHJcbiAgICAgICAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgbG9nLmVkaXRBY3Rpb24oXCJ0ZWFtXCIsIEFDVElPTklELCB0cnVlKTtcclxuICAgICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuXHJcbiAgICAgICAgICAvL3Vuc2VsZWN0IG90aGVyXHJcbiAgICAgICAgICBvdGhlci5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKS5hZGRDbGFzcyhcImluYWN0aXZlXCIpO1xyXG4gICAgICAgICAgb3RoZXIuZmluZChcImlucHV0W3R5cGU9Y2hlY2tib3hdXCIpLnByb3AoXCJjaGVja2VkXCIsIGZhbHNlKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pLm9uKCdrZXl1cCcsICdpbnB1dFt0eXBlPXRleHRdJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICBpZiAoZS53aGljaCA9PT0gMTMpIHtcclxuICAgICAgICB0ZWFtVGFiLmZpbmQoJy5hZGQtcGxhbicpLmNsaWNrKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHRhcC5wb3B1bGF0ZVRlYW1TdWdnZXN0ZWRBY3Rpb25zUGFuZWwoKTtcclxuXHJcbiAgICBsb2NhdGlvbi5maW5kKCdkaXYuZml0LXRvLXNjcmVlbi1oZWlnaHQnKS5uaWNlU2Nyb2xsKHtcclxuICAgICAgY3Vyc29yb3BhY2l0eW1pbjogMC4zLFxyXG4gICAgICBjdXJzb3J3aWR0aDogXCI3cHhcIixcclxuICAgICAgaG9yaXpyYWlsZW5hYmxlZDogZmFsc2VcclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIHBvcHVsYXRlVGVhbVN1Z2dlc3RlZEFjdGlvbnNQYW5lbDogZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgc3VnZ2VzdGlvbnMgPSBiYXNlLnN1Z2dlc3Rpb25MaXN0KGxvZy5wbGFuW2RhdGEucGF0aHdheUlkXS50ZWFtKTtcclxuICAgIHN1Z2dlc3Rpb25zID0gYmFzZS5zb3J0U3VnZ2VzdGlvbnModGFwLm1lcmdlVGVhbVN0dWZmKHN1Z2dlc3Rpb25zKSk7XHJcblxyXG4gICAgYmFzZS5jcmVhdGVQYW5lbFNob3coc3VnZ2VzdGVkUGxhblRlbXBsYXRlLCBzdWdnZXN0ZWRQbGFuVGVhbSwge1xyXG4gICAgICBcInN1Z2dlc3Rpb25zXCI6IHN1Z2dlc3Rpb25zXHJcbiAgICB9LCB7XHJcbiAgICAgIFwiaXRlbVwiOiAkKCcjc3VnZ2VzdGVkLXBsYW4taXRlbScpLmh0bWwoKSxcclxuICAgICAgXCJjaGtcIjogJCgnI2NoZWNrYm94LXRlbXBsYXRlJykuaHRtbCgpXHJcbiAgICB9KTtcclxuXHJcbiAgICB0YXAuZGlzcGxheVBlcnNvbmFsaXNlZFRlYW1BY3Rpb25QbGFuKCQoJyNwZXJzb25hbFBsYW5UZWFtJykpO1xyXG4gIH0sXHJcblxyXG4gIHVwZGF0ZVRlYW1TYXBSb3dzOiBmdW5jdGlvbigpIHtcclxuICAgIHN1Z2dlc3RlZFBsYW5UZWFtLmFkZCgnI3BlcnNvbmFsUGxhblRlYW0nKS5maW5kKCcuc3VnZ2VzdGlvbicpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgICQodGhpcykuZmluZCgndGQnKS5sYXN0KCkuY2hpbGRyZW4oKS5oaWRlKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBzdWdnZXN0ZWRQbGFuVGVhbS5hZGQoJyNwZXJzb25hbFBsYW5UZWFtJykuZmluZCgnLmNyLXN0eWxlZCBpbnB1dFt0eXBlPWNoZWNrYm94XScpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgIGlmICh0aGlzLmNoZWNrZWQpIHtcclxuICAgICAgICAkKHRoaXMpLnBhcmVudCgpLnBhcmVudCgpLnBhcmVudCgpLmFkZENsYXNzKCdzdWNjZXNzJyk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5wYXJlbnQoKS5wYXJlbnQoKS5yZW1vdmVDbGFzcygnc3VjY2VzcycpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBzdWdnZXN0ZWRQbGFuVGVhbS5hZGQoJyNwZXJzb25hbFBsYW5UZWFtJykuZmluZCgnLmJ0bi11bmRvJykuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgJCh0aGlzKS5wYXJlbnQoKS5wYXJlbnQoKS5hZGRDbGFzcygnc3VjY2VzcycpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy9ubyBjbGFzcyAtIHVzZXIgbm90IHlldCBhZ3JlZWQvZGlzYWdyZWVkIC0gbm8gYmFja2dyb3VuZCAvIG11dGVkIHRleHRcclxuICAgIC8vYWN0aXZlIC0gdXNlciBhZ3JlZXMgLSBncmVlbiBiYWNrZ3JvdW5kIC8gbm9ybWFsIHRleHRcclxuICAgIC8vc3VjY2VzcyAtIHVzZXIgY29tcGxldGVkIC0gZ3JlZW4gYmFja2dyb3VuZCAvIHN0cmlrZXRocm91Z2ggdGV4dFxyXG4gICAgLy9kYW5nZXIgLSB1c2VyIGRpc2FncmVlcyAtIHJlZCBiYWNrZ3JvdW5kIC8gc3RyaWtldGhyb3VnaCB0ZXh0XHJcbiAgICBzdWdnZXN0ZWRQbGFuVGVhbS5hZGQoJyNwZXJzb25hbFBsYW5UZWFtJykuZmluZCgndHInKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgc2VsZiA9ICQodGhpcyk7XHJcbiAgICAgIHZhciBhbnkgPSBmYWxzZTtcclxuICAgICAgc2VsZi5maW5kKCcuYnRuLXRvZ2dsZSBpbnB1dFt0eXBlPWNoZWNrYm94XTpjaGVja2VkJykuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgICBhbnkgPSB0cnVlO1xyXG4gICAgICAgIGlmICh0aGlzLnZhbHVlID09PSBcInllc1wiKSB7XHJcbiAgICAgICAgICBzZWxmLnJlbW92ZUNsYXNzKCdkYW5nZXInKTtcclxuICAgICAgICAgIHNlbGYuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgc2VsZi5maW5kKCd0ZCcpLmxhc3QoKS5jaGlsZHJlbigpLnNob3coKTtcclxuICAgICAgICAgIGlmIChsb2cuZ2V0QWN0aW9ucygpLnRlYW1bc2VsZi5kYXRhKFwiaWRcIildLmhpc3RvcnkpIHtcclxuICAgICAgICAgICAgdmFyIHRvb2wgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuaGFzQ2xhc3MoJ3N1Y2Nlc3MnKSA/IFwiXCIgOiBcIjxwPlwiICsgbG9nLmdldEFjdGlvbnMoKS50ZWFtW3NlbGYuZGF0YShcImlkXCIpXS5oaXN0b3J5WzBdICsgXCI8L3A+PHA+Q2xpY2sgYWdhaW4gdG8gY2FuY2VsPC9wPlwiO1xyXG4gICAgICAgICAgICAkKHRoaXMpLnBhcmVudCgpLmF0dHIoXCJ0aXRsZVwiLCB0b29sKS5hdHRyKFwiZGF0YS1vcmlnaW5hbC10aXRsZVwiLCB0b29sKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICQodGhpcykucGFyZW50KCkuYXR0cihcInRpdGxlXCIsIFwiWW91IGFncmVlZCAtIGNsaWNrIGFnYWluIHRvIGNhbmNlbFwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgc2VsZi5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgICBzZWxmLmFkZENsYXNzKCdkYW5nZXInKTtcclxuICAgICAgICAgIHNlbGYucmVtb3ZlQ2xhc3MoJ3N1Y2Nlc3MnKTtcclxuICAgICAgICAgIGlmIChsb2cuZ2V0QWN0aW9ucygpLnRlYW1bc2VsZi5kYXRhKFwiaWRcIildICYmIGxvZy5nZXRBY3Rpb25zKCkudGVhbVtzZWxmLmRhdGEoXCJpZFwiKV0uaGlzdG9yeSkge1xyXG4gICAgICAgICAgICAkKHRoaXMpLnBhcmVudCgpLmF0dHIoXCJ0aXRsZVwiLCBcIjxwPlwiICsgbG9nLmdldEFjdGlvbnMoKS50ZWFtW3NlbGYuZGF0YShcImlkXCIpXS5oaXN0b3J5WzBdICsgXCI8L3A+PHA+Q2xpY2sgYWdhaW4gdG8gZWRpdC9jYW5jZWw8L3A+XCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5hdHRyKFwidGl0bGVcIiwgXCJZb3UgZGlzYWdyZWVkIC0gY2xpY2sgYWdhaW4gdG8gZWRpdC9jYW5jZWxcIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgICAgaWYgKHNlbGYuZmluZCgnLmJ0bi10b2dnbGUgaW5wdXRbdHlwZT1jaGVja2JveF06bm90KDpjaGVja2VkKScpLmxlbmd0aCA9PSAxKSB7XHJcbiAgICAgICAgc2VsZi5maW5kKCcuYnRuLXRvZ2dsZSBpbnB1dFt0eXBlPWNoZWNrYm94XTpub3QoOmNoZWNrZWQpJykucGFyZW50KCkuYWRkQ2xhc3MoXCJpbmFjdGl2ZVwiKS5hdHRyKFwidGl0bGVcIiwgXCJcIikuYXR0cihcImRhdGEtb3JpZ2luYWwtdGl0bGVcIiwgXCJcIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKCFhbnkpIHtcclxuICAgICAgICBzZWxmLnJlbW92ZUNsYXNzKCdkYW5nZXInKTtcclxuICAgICAgICBzZWxmLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICBzZWxmLnJlbW92ZUNsYXNzKCdzdWNjZXNzJyk7XHJcblxyXG4gICAgICAgIHNlbGYuZmluZCgnLmJ0bi10b2dnbGUuYnRuLXllcycpLmF0dHIoXCJ0aXRsZVwiLCBcIkNsaWNrIHRvIGFncmVlIHdpdGggdGhpcyBhY3Rpb24gYW5kIHNhdmUgaXQgaW4geW91ciBhZ3JlZWQgYWN0aW9ucyBsaXN0ICBcIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgICAgc2VsZi5maW5kKCcuYnRuLXRvZ2dsZS5idG4tbm8nKS5hdHRyKFwidGl0bGVcIiwgXCJDbGljayB0byBkaXNhZ3JlZSB3aXRoIHRoaXMgYWN0aW9uIGFuZCByZW1vdmUgaXQgZnJvbSB5b3VyIHN1Z2dlc3RlZCBhY3Rpb25zIGxpc3QgXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgfSxcclxuXHJcbiAgZGlzcGxheVBlcnNvbmFsaXNlZFRlYW1BY3Rpb25QbGFuOiBmdW5jdGlvbihwYXJlbnRFbGVtKSB7XHJcbiAgICB2YXIgcGxhbnMgPSBiYXNlLnNvcnRTdWdnZXN0aW9ucyhiYXNlLmFkZERpc2FncmVlUGVyc29uYWxUZWFtKGxvZy5saXN0UGxhbnMoXCJ0ZWFtXCIsIGRhdGEucGF0aHdheUlkKSkpO1xyXG5cclxuICAgIGJhc2UuY3JlYXRlUGFuZWxTaG93KGFjdGlvblBsYW5MaXN0LCBwYXJlbnRFbGVtLCB7XHJcbiAgICAgIFwiaGFzU3VnZ2VzdGlvbnNcIjogcGxhbnMgJiYgcGxhbnMubGVuZ3RoID4gMCxcclxuICAgICAgXCJzdWdnZXN0aW9uc1wiOiBwbGFuc1xyXG4gICAgfSwge1xyXG4gICAgICBcImFjdGlvbi1wbGFuXCI6ICQoJyNhY3Rpb24tcGxhbicpLmh0bWwoKSxcclxuICAgICAgXCJhY3Rpb24tcGxhbi1pdGVtXCI6ICQoJyNhY3Rpb24tcGxhbi1pdGVtJykuaHRtbCgpLFxyXG4gICAgICBcImNoa1wiOiAkKCcjY2hlY2tib3gtdGVtcGxhdGUnKS5odG1sKClcclxuICAgIH0pO1xyXG5cclxuICAgIHRhcC51cGRhdGVUZWFtU2FwUm93cygpO1xyXG4gIH0sXHJcblxyXG4gIG1lcmdlVGVhbVN0dWZmOiBmdW5jdGlvbihzdWdnZXN0aW9ucykge1xyXG4gICAgdmFyIHRlYW1BY3Rpb25zID0gbG9nLmxpc3RBY3Rpb25zKCk7XHJcbiAgICBpZiAoIXRlYW1BY3Rpb25zLnRlYW0pIHJldHVybiBzdWdnZXN0aW9ucztcclxuXHJcbiAgICBzdWdnZXN0aW9ucyA9IHRhcC5hZGREaXNhZ3JlZShzdWdnZXN0aW9ucywgdGVhbUFjdGlvbnMsIFwidGVhbVwiKTtcclxuICAgIHJldHVybiBzdWdnZXN0aW9ucztcclxuICB9LFxyXG5cclxuICBsYXVuY2hNb2RhbDogZnVuY3Rpb24obGFiZWwsIHZhbHVlLCByZWFzb24sIGlzVW5kbywgY2FsbGJhY2tPblNhdmUsIGNhbGxiYWNrT25DYW5jZWwsIGNhbGxiYWNrT25VbmRvKSB7XHJcbiAgICB2YXIgcmVhc29ucyA9IFt7XHJcbiAgICAgIFwicmVhc29uXCI6IFwiV2UndmUgYWxyZWFkeSBkb25lIHRoaXNcIixcclxuICAgICAgXCJ2YWx1ZVwiOiBcImRvbmVcIlxyXG4gICAgfSwge1xyXG4gICAgICBcInJlYXNvblwiOiBcIkl0IHdvdWxkbid0IHdvcmtcIixcclxuICAgICAgXCJ2YWx1ZVwiOiBcIm5vd29ya1wiXHJcbiAgICB9LCB7XHJcbiAgICAgIFwicmVhc29uXCI6IFwiT3RoZXJcIixcclxuICAgICAgXCJ2YWx1ZVwiOiBcImVsc2VcIlxyXG4gICAgfV07XHJcbiAgICBpZiAocmVhc29uICYmIHJlYXNvbi5yZWFzb24pIHtcclxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZWFzb25zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgaWYgKHJlYXNvbnNbaV0ucmVhc29uID09PSByZWFzb24ucmVhc29uKSB7XHJcbiAgICAgICAgICByZWFzb25zW2ldLmNoZWNrZWQgPSB0cnVlO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBiYXNlLmxhdW5jaE1vZGFsKHtcclxuICAgICAgXCJoZWFkZXJcIjogXCJEaXNhZ3JlZSB3aXRoIGEgc3VnZ2VzdGVkIGFjdGlvblwiLFxyXG4gICAgICBcImlzVW5kb1wiOiBpc1VuZG8sXHJcbiAgICAgIFwiaXRlbVwiOiB2YWx1ZSxcclxuICAgICAgXCJwbGFjZWhvbGRlclwiOiBcIkVudGVyIGZyZWUtdGV4dCBoZXJlLi4uXCIsXHJcbiAgICAgIFwicmVhc29uc1wiOiByZWFzb25zXHJcbiAgICB9LCBsYWJlbCwgdmFsdWUsIHJlYXNvbiA/IHJlYXNvbi5yZWFzb25UZXh0IDogbnVsbCwgY2FsbGJhY2tPblNhdmUsIGNhbGxiYWNrT25DYW5jZWwsIGNhbGxiYWNrT25VbmRvKTtcclxuICB9LFxyXG5cclxuICBhZGREaXNhZ3JlZTogZnVuY3Rpb24oc3VnZ2VzdGlvbnMsIGFjdGlvbnMsIGlkKSB7XHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN1Z2dlc3Rpb25zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIGlmIChhY3Rpb25zW2lkXVtzdWdnZXN0aW9uc1tpXS5pZF0pIHtcclxuICAgICAgICBpZiAoYWN0aW9uc1tpZF1bc3VnZ2VzdGlvbnNbaV0uaWRdLmFncmVlKSB7XHJcbiAgICAgICAgICBzdWdnZXN0aW9uc1tpXS5hZ3JlZSA9IHRydWU7XHJcbiAgICAgICAgICBzdWdnZXN0aW9uc1tpXS5kaXNhZ3JlZSA9IGZhbHNlO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoYWN0aW9uc1tpZF1bc3VnZ2VzdGlvbnNbaV0uaWRdLmFncmVlID09PSBmYWxzZSkge1xyXG4gICAgICAgICAgc3VnZ2VzdGlvbnNbaV0uYWdyZWUgPSBmYWxzZTtcclxuICAgICAgICAgIHN1Z2dlc3Rpb25zW2ldLmRpc2FncmVlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGFjdGlvbnNbaWRdW3N1Z2dlc3Rpb25zW2ldLmlkXS5kb25lKSBzdWdnZXN0aW9uc1tpXS5kb25lID0gYWN0aW9uc1tpZF1bc3VnZ2VzdGlvbnNbaV0uaWRdLmRvbmU7XHJcbiAgICAgICAgZWxzZSBzdWdnZXN0aW9uc1tpXS5kb25lID0gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBzdWdnZXN0aW9ucztcclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSB0YXA7XHJcbiIsInZhciBiYXNlID0gcmVxdWlyZSgnLi4vYmFzZS5qcycpLFxyXG4gIGNvbmZpcm0gPSByZXF1aXJlKCcuL2NvbmZpcm0uanMnKSxcclxuICBkYXRhID0gcmVxdWlyZSgnLi4vZGF0YS5qcycpLFxyXG4gIGxvZyA9IHJlcXVpcmUoJy4uL2xvZy5qcycpLFxyXG4gIGxvb2t1cCA9IHJlcXVpcmUoJy4uL2xvb2t1cC5qcycpO1xyXG5cclxudmFyIHRybmQgPSB7XHJcblxyXG4gIGNyZWF0ZTogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpIHtcclxuICAgIHZhciBhZ3JlZSA9IGxvZy5nZXRQYXRpZW50QWdyZWVPYmplY3QocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQsIFwidHJlbmRcIik7XHJcbiAgICByZXR1cm4gYmFzZS5jcmVhdGVQYW5lbCh2YWx1ZVRyZW5kUGFuZWwsIHtcclxuICAgICAgXCJwYXRod2F5XCI6IGxvb2t1cC5tb25pdG9yZWRbcGF0aHdheUlkXSxcclxuICAgICAgXCJhZ3JlZVwiOiBhZ3JlZSAmJiBhZ3JlZS5hZ3JlZSxcclxuICAgICAgXCJkaXNhZ3JlZVwiOiBhZ3JlZSAmJiBhZ3JlZS5hZ3JlZSA9PT0gZmFsc2UsXHJcbiAgICAgIFwic3RhbmRhcmRcIjogZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS50YWIudGl0bGUsXHJcbiAgICAgIFwicGF0aHdheVN0YWdlXCI6IHBhdGh3YXlTdGFnZVxyXG4gICAgfSk7XHJcbiAgfSxcclxuXHJcbiAgd2lyZVVwOiBmdW5jdGlvbihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCkge1xyXG4gICAgY29uZmlybS53aXJlVXAoJCgnI3RyZW5kLWFncmVlLWRpc2FncmVlJyksICQoJyN0cmVuZC1wYW5lbCcpLCBwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCwgXCJ0cmVuZFwiLCBcInRyZW5kIGRhdGFcIik7XHJcblxyXG4gICAgJCgnI3RyZW5kLXBhbmVsJykub24oJ2NsaWNrJywgJy50YWJsZS1jaGFydC10b2dnbGUnLCBmdW5jdGlvbigpIHtcclxuICAgICAgaWYgKCQodGhpcykudGV4dCgpID09PSBcIlRhYmxlXCIpIHtcclxuICAgICAgICAkKHRoaXMpLnRleHQoXCJDaGFydFwiKTtcclxuICAgICAgICAkKCcjY2hhcnQtZGVtby10cmVuZCcpLmhpZGUoKTtcclxuICAgICAgICAkKCcjdGFibGUtZGVtby10cmVuZCcpLnNob3coKTtcclxuXHJcbiAgICAgICAgdmFyIGMgPSAkKCcjdGFibGUtZGVtby10cmVuZCAudGFibGVTY3JvbGwnKS5nZXROaWNlU2Nyb2xsKCk7XHJcbiAgICAgICAgaWYgKGMgJiYgYy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICBjLnJlc2l6ZSgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAkKCcjdGFibGUtZGVtby10cmVuZCAudGFibGVTY3JvbGwnKS5uaWNlU2Nyb2xsKHtcclxuICAgICAgICAgICAgY3Vyc29yb3BhY2l0eW1pbjogMC4zLFxyXG4gICAgICAgICAgICBjdXJzb3J3aWR0aDogXCI3cHhcIixcclxuICAgICAgICAgICAgaG9yaXpyYWlsZW5hYmxlZDogZmFsc2VcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAkKHRoaXMpLnRleHQoXCJUYWJsZVwiKTtcclxuICAgICAgICAkKCcjY2hhcnQtZGVtby10cmVuZCcpLnNob3coKTtcclxuICAgICAgICAkKCcjdGFibGUtZGVtby10cmVuZCcpLmhpZGUoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gdHJuZDtcclxuIiwidmFyIGJhc2UgPSByZXF1aXJlKCcuLi9iYXNlLmpzJyksXHJcbiAgZGF0YSA9IHJlcXVpcmUoJy4uL2RhdGEuanMnKSxcclxuICBsb2cgPSByZXF1aXJlKCcuLi9sb2cuanMnKSxcclxuICBpbmRpdmlkdWFsQWN0aW9uUGxhbiA9IHJlcXVpcmUoJy4vaW5kaXZpZHVhbEFjdGlvblBsYW4uanMnKSxcclxuICB0ZWFtQWN0aW9uUGxhbiA9IHJlcXVpcmUoJy4vdGVhbUFjdGlvblBsYW4uanMnKSxcclxuICBNdXN0YWNoZSA9IHJlcXVpcmUoJ211c3RhY2hlJyk7XHJcblxyXG52YXIgd2VsY29tZSA9IHtcclxuXHJcbiAgd2lyZVVwV2VsY29tZVBhZ2U6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlKSB7XHJcbiAgICAkKCcjdGVhbS10YXNrLXBhbmVsJykub24oJ2NsaWNrJywgJy5jci1zdHlsZWQgaW5wdXRbdHlwZT1jaGVja2JveF0nLCBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIEFDVElPTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoJ2lkJyk7XHJcbiAgICAgIGxvZy5lZGl0QWN0aW9uKFwidGVhbVwiLCBBQ1RJT05JRCwgbnVsbCwgdGhpcy5jaGVja2VkKTtcclxuXHJcbiAgICAgIGlmICh0aGlzLmNoZWNrZWQpIHtcclxuICAgICAgICBsb2cucmVjb3JkRXZlbnQocGF0aHdheUlkLCBcInRlYW1cIiwgXCJJdGVtIGNvbXBsZXRlZFwiKTtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgJChzZWxmKS5wYXJlbnQoKS5hdHRyKFwidGl0bGVcIiwgXCJcIikuYXR0cihcImRhdGEtb3JpZ2luYWwtdGl0bGVcIiwgXCJcIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgJChzZWxmKS5wYXJlbnQoKS5mYWRlT3V0KDMwMCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBwYXJlbnQgPSAkKHRoaXMpLnBhcmVudCgpO1xyXG4gICAgICAgICAgICAkKHRoaXMpLnJlcGxhY2VXaXRoKGJhc2UuY3JlYXRlUGFuZWwoJCgnI2NoZWNrYm94LXRlbXBsYXRlJyksIHtcclxuICAgICAgICAgICAgICBcImRvbmVcIjogdHJ1ZVxyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgIHBhcmVudC5maW5kKCdidXR0b24nKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICBBQ1RJT05JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKCdpZCcpO1xyXG4gICAgICAgICAgICAgIGxvZy5lZGl0QWN0aW9uKFwidGVhbVwiLCBBQ1RJT05JRCwgbnVsbCwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICQodGhpcykucmVwbGFjZVdpdGgoYmFzZS5jcmVhdGVQYW5lbCgkKCcjY2hlY2tib3gtdGVtcGxhdGUnKSwge1xyXG4gICAgICAgICAgICAgICAgXCJkb25lXCI6IGZhbHNlXHJcbiAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgIHdlbGNvbWUudXBkYXRlV2VsY29tZVBhZ2UoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9LCAxMDAwKTtcclxuICAgICAgfVxyXG4gICAgICB3ZWxjb21lLnVwZGF0ZVdlbGNvbWVQYWdlKCk7XHJcbiAgICB9KS5vbignY2hhbmdlJywgJy5idG4tdG9nZ2xlIGlucHV0W3R5cGU9Y2hlY2tib3hdJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIHdlbGNvbWUudXBkYXRlV2VsY29tZVBhZ2UoKTtcclxuICAgIH0pLm9uKCdjbGljaycsICcuZWRpdC1wbGFuJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBQTEFOSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YShcImlkXCIpO1xyXG5cclxuICAgICAgJCgnI2VkaXRBY3Rpb25QbGFuSXRlbScpLnZhbCgkKCQodGhpcykuY2xvc2VzdCgndHInKS5jaGlsZHJlbigndGQnKVsxXSkuZmluZCgnc3BhbicpLnRleHQoKSk7XHJcblxyXG4gICAgICAkKCcjZWRpdFBsYW4nKS5vZmYoJ2hpZGRlbi5icy5tb2RhbCcpLm9uKCdoaWRkZW4uYnMubW9kYWwnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICB3ZWxjb21lLnBvcHVsYXRlKCEkKCcjb3V0c3RhbmRpbmdUYXNrcycpLnBhcmVudCgpLmhhc0NsYXNzKFwiYWN0aXZlXCIpKTtcclxuICAgICAgfSkub2ZmKCdzaG93bi5icy5tb2RhbCcpLm9uKCdzaG93bi5icy5tb2RhbCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICQoJyNlZGl0QWN0aW9uUGxhbkl0ZW0nKS5mb2N1cygpO1xyXG4gICAgICB9KS5vZmYoJ2NsaWNrJywgJy5zYXZlLXBsYW4nKS5vbignY2xpY2snLCAnLnNhdmUtcGxhbicsIGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICBsb2cuZWRpdFBsYW4oUExBTklELCAkKCcjZWRpdEFjdGlvblBsYW5JdGVtJykudmFsKCkpO1xyXG5cclxuICAgICAgICAkKCcjZWRpdFBsYW4nKS5tb2RhbCgnaGlkZScpO1xyXG4gICAgICB9KS5vZmYoJ2tleXVwJywgJyNlZGl0QWN0aW9uUGxhbkl0ZW0nKS5vbigna2V5dXAnLCAnI2VkaXRBY3Rpb25QbGFuSXRlbScsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICBpZiAoZS53aGljaCA9PT0gMTMpICQoJyNlZGl0UGxhbiAuc2F2ZS1wbGFuJykuY2xpY2soKTtcclxuICAgICAgfSkubW9kYWwoKTtcclxuICAgIH0pLm9uKCdjbGljaycsICcuZGVsZXRlLXBsYW4nLCBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIFBMQU5JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKFwiaWRcIik7XHJcblxyXG4gICAgICAkKCcjdGVhbS1kZWxldGUtaXRlbScpLmh0bWwoJCgkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuY2hpbGRyZW4oJ3RkJylbMV0pLmZpbmQoJ3NwYW4nKS50ZXh0KCkpO1xyXG5cclxuICAgICAgJCgnI2RlbGV0ZVBsYW4nKS5vZmYoJ2hpZGRlbi5icy5tb2RhbCcpLm9uKCdoaWRkZW4uYnMubW9kYWwnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICB3ZWxjb21lLnBvcHVsYXRlKCEkKCcjb3V0c3RhbmRpbmdUYXNrcycpLnBhcmVudCgpLmhhc0NsYXNzKFwiYWN0aXZlXCIpKTtcclxuICAgICAgfSkub2ZmKCdjbGljaycsICcuZGVsZXRlLXBsYW4nKS5vbignY2xpY2snLCAnLmRlbGV0ZS1wbGFuJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgbG9nLmRlbGV0ZVBsYW4oUExBTklEKTtcclxuXHJcbiAgICAgICAgJCgnI2RlbGV0ZVBsYW4nKS5tb2RhbCgnaGlkZScpO1xyXG4gICAgICB9KS5tb2RhbCgpO1xyXG4gICAgfSkub24oJ2NsaWNrJywgJy5idG4tdW5kbycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgdmFyIEFDVElPTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoJ2lkJyk7XHJcbiAgICAgIGxvZy5lZGl0QWN0aW9uKFwidGVhbVwiLCBBQ1RJT05JRCwgbnVsbCwgZmFsc2UpO1xyXG4gICAgICAkKHRoaXMpLnJlcGxhY2VXaXRoKGJhc2UuY3JlYXRlUGFuZWwoJCgnI2NoZWNrYm94LXRlbXBsYXRlJyksIHtcclxuICAgICAgICBcImRvbmVcIjogZmFsc2VcclxuICAgICAgfSkpO1xyXG4gICAgICB3ZWxjb21lLnVwZGF0ZVdlbGNvbWVQYWdlKCk7XHJcbiAgICB9KS5vbignY2xpY2snLCAnLmJ0bi15ZXMsLmJ0bi1ubycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgdmFyIGNoZWNrYm94ID0gJCh0aGlzKS5maW5kKFwiaW5wdXRbdHlwZT1jaGVja2JveF1cIik7XHJcbiAgICAgIHZhciBvdGhlciA9ICQodGhpcykucGFyZW50KCkuZmluZCgkKHRoaXMpLmhhc0NsYXNzKFwiYnRuLXllc1wiKSA/IFwiLmJ0bi1ub1wiIDogXCIuYnRuLXllc1wiKTtcclxuICAgICAgdmFyIEFDVElPTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoJ2lkJyk7XHJcbiAgICAgIGlmICgkKHRoaXMpLmhhc0NsYXNzKFwiYWN0aXZlXCIpICYmIG90aGVyLmhhc0NsYXNzKFwiaW5hY3RpdmVcIikgJiYgISQodGhpcykuY2xvc2VzdCgndHInKS5oYXNDbGFzcygnc3VjY2VzcycpKSB7XHJcbiAgICAgICAgLy91bnNlbGVjdGluZ1xyXG4gICAgICAgIGlmIChjaGVja2JveC52YWwoKSA9PT0gXCJub1wiKSB7XHJcbiAgICAgICAgICB0ZWFtQWN0aW9uUGxhbi5sYXVuY2hNb2RhbChkYXRhLnNlbGVjdGVkLCBjaGVja2JveC5jbG9zZXN0KCd0cicpLmNoaWxkcmVuKCc6bnRoKDEpJykuZmluZCgnc3BhbicpLnRleHQoKSwgbG9nLmdldFJlYXNvbihcInRlYW1cIiwgQUNUSU9OSUQpLCB0cnVlLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgbG9nLmVkaXRBY3Rpb24oXCJ0ZWFtXCIsIEFDVElPTklELCBmYWxzZSwgbnVsbCwgbG9nLnJlYXNvbik7XHJcbiAgICAgICAgICAgIHdlbGNvbWUudXBkYXRlV2VsY29tZVBhZ2UoKTtcclxuICAgICAgICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgICAgICAgfSwgbnVsbCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGxvZy5pZ25vcmVBY3Rpb24oXCJ0ZWFtXCIsIEFDVElPTklEKTtcclxuICAgICAgICAgICAgb3RoZXIucmVtb3ZlQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgY2hlY2tib3gucmVtb3ZlQXR0cihcImNoZWNrZWRcIik7XHJcbiAgICAgICAgICAgIGNoZWNrYm94LnBhcmVudCgpLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICB3ZWxjb21lLnVwZGF0ZVdlbGNvbWVQYWdlKCk7XHJcbiAgICAgICAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgbG9nLmlnbm9yZUFjdGlvbihcInRlYW1cIiwgQUNUSU9OSUQpO1xyXG4gICAgICAgICAgb3RoZXIucmVtb3ZlQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSBpZiAoKCEkKHRoaXMpLmhhc0NsYXNzKFwiYWN0aXZlXCIpICYmIG90aGVyLmhhc0NsYXNzKFwiYWN0aXZlXCIpKSB8fCAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuaGFzQ2xhc3MoJ3N1Y2Nlc3MnKSkge1xyXG4gICAgICAgIC8vcHJldmVudCBjbGlja2luZyBvbiB1bnNlbGVjdGVkIG9wdGlvbiBvciBpZiB0aGUgcm93IGlzIGNvbXBsZXRlXHJcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vc2VsZWN0aW5nXHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIGlmIChjaGVja2JveC52YWwoKSA9PT0gXCJub1wiKSB7XHJcbiAgICAgICAgICB0ZWFtQWN0aW9uUGxhbi5sYXVuY2hNb2RhbChkYXRhLnNlbGVjdGVkLCBjaGVja2JveC5jbG9zZXN0KCd0cicpLmNoaWxkcmVuKCc6bnRoKDEpJykuZmluZCgnc3BhbicpLnRleHQoKSwgbG9nLmdldFJlYXNvbihcInRlYW1cIiwgQUNUSU9OSUQpLCBmYWxzZSwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGxvZy5lZGl0QWN0aW9uKFwidGVhbVwiLCBBQ1RJT05JRCwgZmFsc2UsIG51bGwsIGxvZy5yZWFzb24pO1xyXG4gICAgICAgICAgICAkKHNlbGYpLnJlbW92ZUNsYXNzKFwiaW5hY3RpdmVcIik7XHJcblxyXG4gICAgICAgICAgICBjaGVja2JveC5hdHRyKFwiY2hlY2tlZFwiLCBcImNoZWNrZWRcIik7XHJcbiAgICAgICAgICAgIGNoZWNrYm94LnBhcmVudCgpLmFkZENsYXNzKFwiYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICAvL3Vuc2VsZWN0IG90aGVyXHJcbiAgICAgICAgICAgIG90aGVyLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpLmFkZENsYXNzKFwiaW5hY3RpdmVcIik7XHJcbiAgICAgICAgICAgIG90aGVyLmZpbmQoXCJpbnB1dFt0eXBlPWNoZWNrYm94XVwiKS5wcm9wKFwiY2hlY2tlZFwiLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIHdlbGNvbWUudXBkYXRlV2VsY29tZVBhZ2UoKTtcclxuICAgICAgICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBsb2cuZWRpdEFjdGlvbihcInRlYW1cIiwgQUNUSU9OSUQsIHRydWUpO1xyXG4gICAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcyhcImluYWN0aXZlXCIpO1xyXG5cclxuICAgICAgICAgIC8vdW5zZWxlY3Qgb3RoZXJcclxuICAgICAgICAgIG90aGVyLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpLmFkZENsYXNzKFwiaW5hY3RpdmVcIik7XHJcbiAgICAgICAgICBvdGhlci5maW5kKFwiaW5wdXRbdHlwZT1jaGVja2JveF1cIikucHJvcChcImNoZWNrZWRcIiwgZmFsc2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgJCgnI2luZGl2aWR1YWwtdGFzay1wYW5lbCcpLm9uKCdjbGljaycsICcuY3Itc3R5bGVkIGlucHV0W3R5cGU9Y2hlY2tib3hdJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBBQ1RJT05JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKCdpZCcpO1xyXG4gICAgICB2YXIgcGF0aWVudElkID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoJ3RlYW0tb3ItcGF0aWVudC1pZCcpO1xyXG4gICAgICBsb2cuZWRpdEFjdGlvbihwYXRpZW50SWQsIEFDVElPTklELCBudWxsLCB0aGlzLmNoZWNrZWQpO1xyXG5cclxuICAgICAgaWYgKHRoaXMuY2hlY2tlZCkge1xyXG4gICAgICAgIGxvZy5yZWNvcmRFdmVudChwYXRod2F5SWQsIHBhdGllbnRJZCwgXCJJdGVtIGNvbXBsZXRlZFwiKTtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgJChzZWxmKS5wYXJlbnQoKS5hdHRyKFwidGl0bGVcIiwgXCJcIikuYXR0cihcImRhdGEtb3JpZ2luYWwtdGl0bGVcIiwgXCJcIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgJChzZWxmKS5wYXJlbnQoKS5mYWRlT3V0KDMwMCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBwYXJlbnQgPSAkKHRoaXMpLnBhcmVudCgpO1xyXG4gICAgICAgICAgICAkKHRoaXMpLnJlcGxhY2VXaXRoKGJhc2UuY3JlYXRlUGFuZWwoJCgnI2NoZWNrYm94LXRlbXBsYXRlJyksIHtcclxuICAgICAgICAgICAgICBcImRvbmVcIjogdHJ1ZVxyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgIHBhcmVudC5maW5kKCdidXR0b24nKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICBBQ1RJT05JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKCdpZCcpO1xyXG4gICAgICAgICAgICAgIGxvZy5lZGl0QWN0aW9uKHBhdGllbnRJZCwgQUNUSU9OSUQsIG51bGwsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAkKHRoaXMpLnJlcGxhY2VXaXRoKGJhc2UuY3JlYXRlUGFuZWwoJCgnI2NoZWNrYm94LXRlbXBsYXRlJyksIHtcclxuICAgICAgICAgICAgICAgIFwiZG9uZVwiOiBmYWxzZVxyXG4gICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgICB3ZWxjb21lLnVwZGF0ZVdlbGNvbWVQYWdlKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSwgMTAwMCk7XHJcbiAgICAgIH1cclxuICAgICAgd2VsY29tZS51cGRhdGVXZWxjb21lUGFnZSgpO1xyXG4gICAgfSkub24oJ2NoYW5nZScsICcuYnRuLXRvZ2dsZSBpbnB1dFt0eXBlPWNoZWNrYm94XScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICB3ZWxjb21lLnVwZGF0ZVdlbGNvbWVQYWdlKCk7XHJcbiAgICB9KS5vbignY2xpY2snLCAnLmVkaXQtcGxhbicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgUExBTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoXCJpZFwiKTtcclxuXHJcbiAgICAgICQoJyNlZGl0QWN0aW9uUGxhbkl0ZW0nKS52YWwoJCgkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuY2hpbGRyZW4oJ3RkJylbMl0pLmZpbmQoJ3NwYW4nKS50ZXh0KCkpO1xyXG5cclxuICAgICAgJCgnI2VkaXRQbGFuJykub2ZmKCdoaWRkZW4uYnMubW9kYWwnKS5vbignaGlkZGVuLmJzLm1vZGFsJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgd2VsY29tZS5wb3B1bGF0ZSghJCgnI291dHN0YW5kaW5nVGFza3MnKS5wYXJlbnQoKS5oYXNDbGFzcyhcImFjdGl2ZVwiKSk7XHJcbiAgICAgIH0pLm9mZignc2hvd24uYnMubW9kYWwnKS5vbignc2hvd24uYnMubW9kYWwnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAkKCcjZWRpdEFjdGlvblBsYW5JdGVtJykuZm9jdXMoKTtcclxuICAgICAgfSkub2ZmKCdjbGljaycsICcuc2F2ZS1wbGFuJykub24oJ2NsaWNrJywgJy5zYXZlLXBsYW4nLCBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgbG9nLmVkaXRQbGFuKFBMQU5JRCwgJCgnI2VkaXRBY3Rpb25QbGFuSXRlbScpLnZhbCgpKTtcclxuXHJcbiAgICAgICAgJCgnI2VkaXRQbGFuJykubW9kYWwoJ2hpZGUnKTtcclxuICAgICAgfSkub2ZmKCdrZXl1cCcsICcjZWRpdEFjdGlvblBsYW5JdGVtJykub24oJ2tleXVwJywgJyNlZGl0QWN0aW9uUGxhbkl0ZW0nLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgaWYgKGUud2hpY2ggPT09IDEzKSAkKCcjZWRpdFBsYW4gLnNhdmUtcGxhbicpLmNsaWNrKCk7XHJcbiAgICAgIH0pLm1vZGFsKCk7XHJcbiAgICB9KS5vbignY2xpY2snLCAnLmRlbGV0ZS1wbGFuJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBQTEFOSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YShcImlkXCIpO1xyXG5cclxuICAgICAgJCgnI3RlYW0tZGVsZXRlLWl0ZW0nKS5odG1sKCQoJCh0aGlzKS5jbG9zZXN0KCd0cicpLmNoaWxkcmVuKCd0ZCcpWzJdKS5maW5kKCdzcGFuJykudGV4dCgpKTtcclxuXHJcbiAgICAgICQoJyNkZWxldGVQbGFuJykub2ZmKCdoaWRkZW4uYnMubW9kYWwnKS5vbignaGlkZGVuLmJzLm1vZGFsJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgd2VsY29tZS5wb3B1bGF0ZSghJCgnI291dHN0YW5kaW5nVGFza3MnKS5wYXJlbnQoKS5oYXNDbGFzcyhcImFjdGl2ZVwiKSk7XHJcbiAgICAgIH0pLm9mZignY2xpY2snLCAnLmRlbGV0ZS1wbGFuJykub24oJ2NsaWNrJywgJy5kZWxldGUtcGxhbicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGxvZy5kZWxldGVQbGFuKFBMQU5JRCk7XHJcblxyXG4gICAgICAgICQoJyNkZWxldGVQbGFuJykubW9kYWwoJ2hpZGUnKTtcclxuICAgICAgfSkubW9kYWwoKTtcclxuICAgIH0pLm9uKCdjbGljaycsICcuYnRuLXVuZG8nLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIHZhciBBQ1RJT05JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKCdpZCcpO1xyXG4gICAgICB2YXIgcGF0aWVudElkID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoJ3RlYW0tb3ItcGF0aWVudC1pZCcpO1xyXG4gICAgICBsb2cuZWRpdEFjdGlvbihwYXRpZW50SWQsIEFDVElPTklELCBudWxsLCBmYWxzZSk7XHJcbiAgICAgICQodGhpcykucmVwbGFjZVdpdGgoYmFzZS5jcmVhdGVQYW5lbCgkKCcjY2hlY2tib3gtdGVtcGxhdGUnKSwge1xyXG4gICAgICAgIFwiZG9uZVwiOiBmYWxzZVxyXG4gICAgICB9KSk7XHJcbiAgICAgIHdlbGNvbWUudXBkYXRlV2VsY29tZVBhZ2UoKTtcclxuICAgIH0pLm9uKCdjbGljaycsICcuYnRuLXllcywuYnRuLW5vJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICB2YXIgY2hlY2tib3ggPSAkKHRoaXMpLmZpbmQoXCJpbnB1dFt0eXBlPWNoZWNrYm94XVwiKTtcclxuICAgICAgdmFyIG90aGVyID0gJCh0aGlzKS5wYXJlbnQoKS5maW5kKCQodGhpcykuaGFzQ2xhc3MoXCJidG4teWVzXCIpID8gXCIuYnRuLW5vXCIgOiBcIi5idG4teWVzXCIpO1xyXG4gICAgICB2YXIgQUNUSU9OSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YSgnaWQnKTtcclxuICAgICAgdmFyIHBhdGllbnRJZCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKCd0ZWFtLW9yLXBhdGllbnQtaWQnKTtcclxuICAgICAgaWYgKCQodGhpcykuaGFzQ2xhc3MoXCJhY3RpdmVcIikgJiYgb3RoZXIuaGFzQ2xhc3MoXCJpbmFjdGl2ZVwiKSAmJiAhJCh0aGlzKS5jbG9zZXN0KCd0cicpLmhhc0NsYXNzKCdzdWNjZXNzJykpIHtcclxuICAgICAgICAvL3Vuc2VsZWN0aW5nXHJcbiAgICAgICAgaWYgKGNoZWNrYm94LnZhbCgpID09PSBcIm5vXCIpIHtcclxuICAgICAgICAgIGluZGl2aWR1YWxBY3Rpb25QbGFuLmxhdW5jaE1vZGFsKGRhdGEuc2VsZWN0ZWQsIGNoZWNrYm94LmNsb3Nlc3QoJ3RyJykuY2hpbGRyZW4oJzpudGgoMiknKS5maW5kKCdzcGFuJykudGV4dCgpLCBsb2cuZ2V0UmVhc29uKHBhdGllbnRJZCwgQUNUSU9OSUQpLCB0cnVlLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgbG9nLmVkaXRBY3Rpb24ocGF0aWVudElkLCBBQ1RJT05JRCwgZmFsc2UsIG51bGwsIGxvZy5yZWFzb24pO1xyXG4gICAgICAgICAgICB3ZWxjb21lLnVwZGF0ZVdlbGNvbWVQYWdlKCk7XHJcbiAgICAgICAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgICAgICAgIH0sIG51bGwsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBsb2cuaWdub3JlQWN0aW9uKHBhdGllbnRJZCwgQUNUSU9OSUQpO1xyXG4gICAgICAgICAgICBvdGhlci5yZW1vdmVDbGFzcyhcImluYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICBjaGVja2JveC5yZW1vdmVBdHRyKFwiY2hlY2tlZFwiKTtcclxuICAgICAgICAgICAgY2hlY2tib3gucGFyZW50KCkucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XHJcbiAgICAgICAgICAgIHdlbGNvbWUudXBkYXRlV2VsY29tZVBhZ2UoKTtcclxuICAgICAgICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBsb2cuaWdub3JlQWN0aW9uKHBhdGllbnRJZCwgQUNUSU9OSUQpO1xyXG4gICAgICAgICAgb3RoZXIucmVtb3ZlQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSBpZiAoKCEkKHRoaXMpLmhhc0NsYXNzKFwiYWN0aXZlXCIpICYmIG90aGVyLmhhc0NsYXNzKFwiYWN0aXZlXCIpKSB8fCAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuaGFzQ2xhc3MoJ3N1Y2Nlc3MnKSkge1xyXG4gICAgICAgIC8vcHJldmVudCBjbGlja2luZyBvbiB1bnNlbGVjdGVkIG9wdGlvbiBvciBpZiB0aGUgcm93IGlzIGNvbXBsZXRlXHJcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vc2VsZWN0aW5nXHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIGlmIChjaGVja2JveC52YWwoKSA9PT0gXCJub1wiKSB7XHJcbiAgICAgICAgICBpbmRpdmlkdWFsQWN0aW9uUGxhbi5sYXVuY2hNb2RhbChkYXRhLnNlbGVjdGVkLCBjaGVja2JveC5jbG9zZXN0KCd0cicpLmNoaWxkcmVuKCc6bnRoKDIpJykuZmluZCgnc3BhbicpLnRleHQoKSwgbG9nLmdldFJlYXNvbihwYXRpZW50SWQsIEFDVElPTklEKSwgZmFsc2UsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBsb2cuZWRpdEFjdGlvbihwYXRpZW50SWQsIEFDVElPTklELCBmYWxzZSwgbnVsbCwgbG9nLnJlYXNvbik7XHJcbiAgICAgICAgICAgICQoc2VsZikucmVtb3ZlQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuXHJcbiAgICAgICAgICAgIGNoZWNrYm94LmF0dHIoXCJjaGVja2VkXCIsIFwiY2hlY2tlZFwiKTtcclxuICAgICAgICAgICAgY2hlY2tib3gucGFyZW50KCkuYWRkQ2xhc3MoXCJhY3RpdmVcIik7XHJcbiAgICAgICAgICAgIC8vdW5zZWxlY3Qgb3RoZXJcclxuICAgICAgICAgICAgb3RoZXIucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIikuYWRkQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgb3RoZXIuZmluZChcImlucHV0W3R5cGU9Y2hlY2tib3hdXCIpLnByb3AoXCJjaGVja2VkXCIsIGZhbHNlKTtcclxuICAgICAgICAgICAgd2VsY29tZS51cGRhdGVXZWxjb21lUGFnZSgpO1xyXG4gICAgICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGxvZy5lZGl0QWN0aW9uKHBhdGllbnRJZCwgQUNUSU9OSUQsIHRydWUpO1xyXG4gICAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcyhcImluYWN0aXZlXCIpO1xyXG5cclxuICAgICAgICAgIC8vdW5zZWxlY3Qgb3RoZXJcclxuICAgICAgICAgIG90aGVyLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpLmFkZENsYXNzKFwiaW5hY3RpdmVcIik7XHJcbiAgICAgICAgICBvdGhlci5maW5kKFwiaW5wdXRbdHlwZT1jaGVja2JveF1cIikucHJvcChcImNoZWNrZWRcIiwgZmFsc2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgd2VsY29tZS51cGRhdGVXZWxjb21lUGFnZSgpO1xyXG4gIH0sXHJcblxyXG4gIHVwZGF0ZVdlbGNvbWVQYWdlOiBmdW5jdGlvbigpIHtcclxuICAgICQoJyN0ZWFtLXRhc2stcGFuZWwnKS5hZGQoJyNpbmRpdmlkdWFsLXRhc2stcGFuZWwnKS5maW5kKCcuc3VnZ2VzdGlvbicpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgICQodGhpcykuZmluZCgndGQnKS5sYXN0KCkuY2hpbGRyZW4oKS5oaWRlKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAkKCcjdGVhbS10YXNrLXBhbmVsJykuYWRkKCcjaW5kaXZpZHVhbC10YXNrLXBhbmVsJykuZmluZCgnLmNyLXN0eWxlZCBpbnB1dFt0eXBlPWNoZWNrYm94XScpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgIGlmICh0aGlzLmNoZWNrZWQpIHtcclxuICAgICAgICAkKHRoaXMpLnBhcmVudCgpLnBhcmVudCgpLnBhcmVudCgpLmFkZENsYXNzKCdzdWNjZXNzJyk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5wYXJlbnQoKS5wYXJlbnQoKS5yZW1vdmVDbGFzcygnc3VjY2VzcycpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAkKCcjdGVhbS10YXNrLXBhbmVsJykuYWRkKCcjaW5kaXZpZHVhbC10YXNrLXBhbmVsJykuZmluZCgnLmJ0bi11bmRvJykuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgJCh0aGlzKS5wYXJlbnQoKS5wYXJlbnQoKS5hZGRDbGFzcygnc3VjY2VzcycpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy9ubyBjbGFzcyAtIHVzZXIgbm90IHlldCBhZ3JlZWQvZGlzYWdyZWVkIC0gbm8gYmFja2dyb3VuZCAvIG11dGVkIHRleHRcclxuICAgIC8vYWN0aXZlIC0gdXNlciBhZ3JlZXMgLSBncmVlbiBiYWNrZ3JvdW5kIC8gbm9ybWFsIHRleHRcclxuICAgIC8vc3VjY2VzcyAtIHVzZXIgY29tcGxldGVkIC0gZ3JlZW4gYmFja2dyb3VuZCAvIHN0cmlrZXRocm91Z2ggdGV4dFxyXG4gICAgLy9kYW5nZXIgLSB1c2VyIGRpc2FncmVlcyAtIHJlZCBiYWNrZ3JvdW5kIC8gc3RyaWtldGhyb3VnaCB0ZXh0XHJcbiAgICAkKCcjdGVhbS10YXNrLXBhbmVsJykuYWRkKCcjaW5kaXZpZHVhbC10YXNrLXBhbmVsJykuZmluZCgndHInKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgc2VsZiA9ICQodGhpcyk7XHJcbiAgICAgIHZhciBhbnkgPSBmYWxzZTtcclxuICAgICAgc2VsZi5maW5kKCcuYnRuLXRvZ2dsZSBpbnB1dFt0eXBlPWNoZWNrYm94XTpjaGVja2VkJykuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgICBhbnkgPSB0cnVlO1xyXG4gICAgICAgIGlmICh0aGlzLnZhbHVlID09PSBcInllc1wiKSB7XHJcbiAgICAgICAgICBzZWxmLnJlbW92ZUNsYXNzKCdkYW5nZXInKTtcclxuICAgICAgICAgIHNlbGYuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgc2VsZi5maW5kKCd0ZCcpLmxhc3QoKS5jaGlsZHJlbigpLnNob3coKTtcclxuICAgICAgICAgIGlmIChsb2cuZ2V0QWN0aW9ucygpLnRlYW1bc2VsZi5kYXRhKFwiaWRcIildICYmIGxvZy5nZXRBY3Rpb25zKCkudGVhbVtzZWxmLmRhdGEoXCJpZFwiKV0uaGlzdG9yeSkge1xyXG4gICAgICAgICAgICB2YXIgdG9vbCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5oYXNDbGFzcygnc3VjY2VzcycpID8gXCJcIiA6IFwiPHA+XCIgKyBsb2cuZ2V0QWN0aW9ucygpLnRlYW1bc2VsZi5kYXRhKFwiaWRcIildLmhpc3RvcnlbMF0gKyBcIjwvcD48cD5DbGljayBhZ2FpbiB0byBjYW5jZWw8L3A+XCI7XHJcbiAgICAgICAgICAgICQodGhpcykucGFyZW50KCkuYXR0cihcInRpdGxlXCIsIHRvb2wpLmF0dHIoXCJkYXRhLW9yaWdpbmFsLXRpdGxlXCIsIHRvb2wpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5hdHRyKFwidGl0bGVcIiwgXCJZb3UgYWdyZWVkIC0gY2xpY2sgYWdhaW4gdG8gY2FuY2VsXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBzZWxmLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgIHNlbGYuYWRkQ2xhc3MoJ2RhbmdlcicpO1xyXG4gICAgICAgICAgc2VsZi5yZW1vdmVDbGFzcygnc3VjY2VzcycpO1xyXG4gICAgICAgICAgaWYgKGxvZy5nZXRBY3Rpb25zKCkudGVhbVtzZWxmLmRhdGEoXCJpZFwiKV0gJiYgbG9nLmdldEFjdGlvbnMoKS50ZWFtW3NlbGYuZGF0YShcImlkXCIpXS5oaXN0b3J5KSB7XHJcbiAgICAgICAgICAgICQodGhpcykucGFyZW50KCkuYXR0cihcInRpdGxlXCIsIFwiPHA+XCIgKyBsb2cuZ2V0QWN0aW9ucygpLnRlYW1bc2VsZi5kYXRhKFwiaWRcIildLmhpc3RvcnlbMF0gKyBcIjwvcD48cD5DbGljayBhZ2FpbiB0byBlZGl0L2NhbmNlbDwvcD5cIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAkKHRoaXMpLnBhcmVudCgpLmF0dHIoXCJ0aXRsZVwiLCBcIllvdSBkaXNhZ3JlZWQgLSBjbGljayBhZ2FpbiB0byBlZGl0L2NhbmNlbFwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgICBpZiAoc2VsZi5maW5kKCcuYnRuLXRvZ2dsZSBpbnB1dFt0eXBlPWNoZWNrYm94XTpub3QoOmNoZWNrZWQpJykubGVuZ3RoID09IDEpIHtcclxuICAgICAgICBzZWxmLmZpbmQoJy5idG4tdG9nZ2xlIGlucHV0W3R5cGU9Y2hlY2tib3hdOm5vdCg6Y2hlY2tlZCknKS5wYXJlbnQoKS5hZGRDbGFzcyhcImluYWN0aXZlXCIpLmF0dHIoXCJ0aXRsZVwiLCBcIlwiKS5hdHRyKFwiZGF0YS1vcmlnaW5hbC10aXRsZVwiLCBcIlwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAoIWFueSkge1xyXG4gICAgICAgIHNlbGYucmVtb3ZlQ2xhc3MoJ2RhbmdlcicpO1xyXG4gICAgICAgIHNlbGYucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgIHNlbGYucmVtb3ZlQ2xhc3MoJ3N1Y2Nlc3MnKTtcclxuXHJcbiAgICAgICAgc2VsZi5maW5kKCcuYnRuLXRvZ2dsZS5idG4teWVzJykuYXR0cihcInRpdGxlXCIsIFwiQ2xpY2sgdG8gYWdyZWUgd2l0aCB0aGlzIGFjdGlvbiBhbmQgc2F2ZSBpdCBpbiB5b3VyIGFncmVlZCBhY3Rpb25zIGxpc3QgIFwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgICBzZWxmLmZpbmQoJy5idG4tdG9nZ2xlLmJ0bi1ubycpLmF0dHIoXCJ0aXRsZVwiLCBcIkNsaWNrIHRvIGRpc2FncmVlIHdpdGggdGhpcyBhY3Rpb24gYW5kIHJlbW92ZSBpdCBmcm9tIHlvdXIgc3VnZ2VzdGVkIGFjdGlvbnMgbGlzdCBcIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICB9LFxyXG5cclxuICBwb3B1bGF0ZTogZnVuY3Rpb24oY29tcGxldGUpIHtcclxuXHJcbiAgICB2YXIgayxsO1xyXG4gICAgLy9hZGQgdGFza3NcclxuICAgIHZhciB0ZWFtVGFza3MgPSBbXTtcclxuICAgIHZhciBpbmRpdmlkdWFsVGFza3MgPSBbXTtcclxuXHJcbiAgICAvL0FkZCB0aGUgdGVhbSB0YXNrc1xyXG4gICAgZm9yIChrIGluIGxvZy5saXN0QWN0aW9ucyhcInRlYW1cIikpIHtcclxuICAgICAgaWYgKGxvZy5saXN0QWN0aW9ucyhcInRlYW1cIilba10uYWdyZWUgJiYgKCghbG9nLmxpc3RBY3Rpb25zKFwidGVhbVwiKVtrXS5kb25lICYmICFjb21wbGV0ZSkgfHwgKGxvZy5saXN0QWN0aW9ucyhcInRlYW1cIilba10uZG9uZSAmJiBjb21wbGV0ZSkpKSB7XHJcbiAgICAgICAgdGVhbVRhc2tzLnB1c2goe1xyXG4gICAgICAgICAgXCJwYXRod2F5XCI6IFwiTi9BXCIsXHJcbiAgICAgICAgICBcInRhc2tcIjogbG9nLnRleHRbbG9nLmxpc3RBY3Rpb25zKFwidGVhbVwiKVtrXS5pZF0udGV4dCxcclxuICAgICAgICAgIFwiZGF0YVwiOiBsb2cubGlzdEFjdGlvbnMoXCJ0ZWFtXCIpW2tdLmlkLFxyXG4gICAgICAgICAgXCJ0cElkXCI6IFwidGVhbVwiLFxyXG4gICAgICAgICAgXCJhZ3JlZVwiOiB0cnVlLFxyXG4gICAgICAgICAgXCJkb25lXCI6IGNvbXBsZXRlXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvL0FkZCB0aGUgdXNlciBhZGRlZCB0ZWFtIHRhc2tzXHJcbiAgICBmb3IgKGsgaW4gbG9nLmxpc3RQbGFucyhcInRlYW1cIikpIHtcclxuICAgICAgaWYgKCghbG9nLmxpc3RQbGFucyhcInRlYW1cIilba10uZG9uZSAmJiAhY29tcGxldGUpIHx8IChsb2cubGlzdFBsYW5zKFwidGVhbVwiKVtrXS5kb25lICYmIGNvbXBsZXRlKSkge1xyXG4gICAgICAgIHRlYW1UYXNrcy5wdXNoKHtcclxuICAgICAgICAgIFwiY2FuRWRpdFwiOiB0cnVlLFxyXG4gICAgICAgICAgXCJwYXRod2F5XCI6IGRhdGEucGF0aHdheU5hbWVzW2xvZy5saXN0UGxhbnMoXCJ0ZWFtXCIpW2tdLnBhdGh3YXlJZF0sXHJcbiAgICAgICAgICBcInBhdGh3YXlJZFwiOiBsb2cubGlzdFBsYW5zKFwidGVhbVwiKVtrXS5wYXRod2F5SWQsXHJcbiAgICAgICAgICBcInRhc2tcIjogbG9nLmxpc3RQbGFucyhcInRlYW1cIilba10udGV4dCxcclxuICAgICAgICAgIFwiZGF0YVwiOiBsb2cubGlzdFBsYW5zKFwidGVhbVwiKVtrXS5pZCxcclxuICAgICAgICAgIFwiYWdyZWVcIjogbG9nLmxpc3RQbGFucyhcInRlYW1cIilba10uYWdyZWUsXHJcbiAgICAgICAgICBcImRpc2FncmVlXCI6IGxvZy5saXN0UGxhbnMoXCJ0ZWFtXCIpW2tdLmFncmVlID09PSBmYWxzZSxcclxuICAgICAgICAgIFwiZG9uZVwiOiBjb21wbGV0ZVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy9BZGQgaW5kaXZpZHVhbFxyXG4gICAgZm9yIChrIGluIGxvZy5saXN0QWN0aW9ucygpKSB7XHJcbiAgICAgIGlmIChrID09PSBcInRlYW1cIikgY29udGludWU7XHJcbiAgICAgIGZvciAobCBpbiBsb2cubGlzdEFjdGlvbnMoKVtrXSkge1xyXG4gICAgICAgIGlmIChsb2cudGV4dFtsXSAmJiBsb2cubGlzdEFjdGlvbnMoKVtrXVtsXS5hZ3JlZSAmJiAoKCFsb2cubGlzdEFjdGlvbnMoKVtrXVtsXS5kb25lICYmICFjb21wbGV0ZSkgfHwgKGxvZy5saXN0QWN0aW9ucygpW2tdW2xdLmRvbmUgJiYgY29tcGxldGUpKSkge1xyXG4gICAgICAgICAgaW5kaXZpZHVhbFRhc2tzLnB1c2goe1xyXG4gICAgICAgICAgICBcInBhdGh3YXlcIjogXCJOL0FcIixcclxuICAgICAgICAgICAgXCJwYXRpZW50SWRcIjogayxcclxuICAgICAgICAgICAgXCJ0YXNrXCI6IGxvZy50ZXh0W2xdLnRleHQsXHJcbiAgICAgICAgICAgIFwicGF0aHdheUlkXCI6IGxvZy5saXN0UGxhbnMoKVtrXVtsXS5wYXRod2F5SWQsXHJcbiAgICAgICAgICAgIFwiZGF0YVwiOiBsLFxyXG4gICAgICAgICAgICBcInRwSWRcIjogayxcclxuICAgICAgICAgICAgXCJhZ3JlZVwiOiB0cnVlLFxyXG4gICAgICAgICAgICBcImRvbmVcIjogY29tcGxldGVcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vQWRkIGN1c3RvbSBpbmRpdmlkdWFsXHJcbiAgICBmb3IgKGsgaW4gbG9nLmxpc3RQbGFucygpKSB7XHJcbiAgICAgIGlmIChrID09PSBcInRlYW1cIikgY29udGludWU7XHJcbiAgICAgIGZvciAobCBpbiBsb2cubGlzdFBsYW5zKClba10pIHtcclxuICAgICAgICBpZiAobG9nLmxpc3RQbGFucygpW2tdW2xdLnRleHQgJiYgKCFsb2cubGlzdFBsYW5zKClba11bbF0uZG9uZSAmJiAhY29tcGxldGUpIHx8IChsb2cubGlzdFBsYW5zKClba11bbF0uZG9uZSAmJiBjb21wbGV0ZSkpIHtcclxuICAgICAgICAgIGluZGl2aWR1YWxUYXNrcy5wdXNoKHtcclxuICAgICAgICAgICAgXCJjYW5FZGl0XCI6IHRydWUsXHJcbiAgICAgICAgICAgIFwicGF0aHdheVwiOiBkYXRhLnBhdGh3YXlOYW1lc1tsb2cubGlzdFBsYW5zKClba11bbF0ucGF0aHdheUlkXSxcclxuICAgICAgICAgICAgXCJwYXRod2F5SWRcIjogbG9nLmxpc3RQbGFucygpW2tdW2xdLnBhdGh3YXlJZCxcclxuICAgICAgICAgICAgXCJwYXRpZW50SWRcIjogayxcclxuICAgICAgICAgICAgXCJ0cElkXCI6IGssXHJcbiAgICAgICAgICAgIFwidGFza1wiOiBsb2cubGlzdFBsYW5zKClba11bbF0udGV4dCxcclxuICAgICAgICAgICAgXCJkYXRhXCI6IGwsXHJcbiAgICAgICAgICAgIFwiYWdyZWVcIjogdHJ1ZSxcclxuICAgICAgICAgICAgXCJkb25lXCI6IGNvbXBsZXRlXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB2YXIgbGlzdFRlbXBsYXRlID0gJCgnI3dlbGNvbWUtdGFzay1saXN0JykuaHRtbCgpO1xyXG4gICAgTXVzdGFjaGUucGFyc2UobGlzdFRlbXBsYXRlKTtcclxuICAgICQoJyN3ZWxjb21lLXRhYi1jb250ZW50JykuaHRtbChNdXN0YWNoZS5yZW5kZXIobGlzdFRlbXBsYXRlKSk7XHJcblxyXG4gICAgdmFyIGFkZFRlbXBsYXRlID0gJCgnI2FjdGlvbi1wbGFuJykuaHRtbCgpO1xyXG4gICAgTXVzdGFjaGUucGFyc2UoYWRkVGVtcGxhdGUpO1xyXG4gICAgdmFyIHJlbmRlcmVkID0gTXVzdGFjaGUucmVuZGVyKGFkZFRlbXBsYXRlKTtcclxuICAgICQoJyN0ZWFtLWFkZC1wbGFuJykuaHRtbChyZW5kZXJlZCk7XHJcblxyXG4gICAgdmFyIHRlbXBNdXN0ID0gJCgnI3dlbGNvbWUtdGFzay1pdGVtcycpLmh0bWwoKTtcclxuICAgIHZhciBpdGVtVGVtcGxhdGUgPSAkKCcjd2VsY29tZS10YXNrLWl0ZW0nKS5odG1sKCk7XHJcbiAgICBNdXN0YWNoZS5wYXJzZSh0ZW1wTXVzdCk7XHJcbiAgICBNdXN0YWNoZS5wYXJzZShpdGVtVGVtcGxhdGUpO1xyXG5cclxuICAgICQoJyN0ZWFtLWFkZC1wbGFuJykub2ZmKCdjbGljaycpLm9uKCdjbGljaycsICcuYWRkLXBsYW4nLCBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIHBsYW4gPSAkKHRoaXMpLnBhcmVudCgpLnBhcmVudCgpLmZpbmQoJ3RleHRhcmVhJykudmFsKCk7XHJcbiAgICAgIHZhciBwbGFuSWQgPSByZWNvcmRQbGFuKFwidGVhbVwiLCBwbGFuLCBcImN1c3RvbVwiKTtcclxuICAgICAgJCgnI3RlYW0tdGFzay1wYW5lbCcpLmZpbmQoJ3RhYmxlIHRib2R5JykuYXBwZW5kKE11c3RhY2hlLnJlbmRlcihpdGVtVGVtcGxhdGUsIHtcclxuICAgICAgICBcInBhdGh3YXlcIjogXCJcIixcclxuICAgICAgICBcInBhdGh3YXlJZFwiOiBcImN1c3RvbVwiLFxyXG4gICAgICAgIFwiY2FuRWRpdFwiOiB0cnVlLFxyXG4gICAgICAgIFwidGFza1wiOiBwbGFuLFxyXG4gICAgICAgIFwiZGF0YVwiOiBwbGFuSWQsXHJcbiAgICAgICAgXCJhZ3JlZVwiOiBudWxsLFxyXG4gICAgICAgIFwiZG9uZVwiOiBudWxsXHJcbiAgICAgIH0sIHtcclxuICAgICAgICBcImNoa1wiOiAkKCcjY2hlY2tib3gtdGVtcGxhdGUnKS5odG1sKClcclxuICAgICAgfSkpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcmVuZGVyZWQgPSBNdXN0YWNoZS5yZW5kZXIodGVtcE11c3QsIHtcclxuICAgICAgXCJ0YXNrc1wiOiB0ZWFtVGFza3MsXHJcbiAgICAgIFwiaGFzVGFza3NcIjogdGVhbVRhc2tzLmxlbmd0aCA+IDBcclxuICAgIH0sIHtcclxuICAgICAgXCJ0YXNrLWl0ZW1cIjogaXRlbVRlbXBsYXRlLFxyXG4gICAgICBcImNoa1wiOiAkKCcjY2hlY2tib3gtdGVtcGxhdGUnKS5odG1sKClcclxuICAgIH0pO1xyXG4gICAgJCgnI3RlYW0tdGFzay1wYW5lbCcpLmNoaWxkcmVuKCkubm90KFwiOmZpcnN0XCIpLnJlbW92ZSgpO1xyXG4gICAgJCgnI3RlYW0tdGFzay1wYW5lbCcpLmFwcGVuZChyZW5kZXJlZCk7XHJcblxyXG4gICAgcmVuZGVyZWQgPSBNdXN0YWNoZS5yZW5kZXIodGVtcE11c3QsIHtcclxuICAgICAgXCJ0YXNrc1wiOiBpbmRpdmlkdWFsVGFza3MsXHJcbiAgICAgIFwiaXNQYXRpZW50VGFibGVcIjogdHJ1ZSxcclxuICAgICAgXCJoYXNUYXNrc1wiOiBpbmRpdmlkdWFsVGFza3MubGVuZ3RoID4gMFxyXG4gICAgfSwge1xyXG4gICAgICBcInRhc2staXRlbVwiOiBpdGVtVGVtcGxhdGUsXHJcbiAgICAgIFwiY2hrXCI6ICQoJyNjaGVja2JveC10ZW1wbGF0ZScpLmh0bWwoKVxyXG4gICAgfSk7XHJcbiAgICAkKCcjaW5kaXZpZHVhbC10YXNrLXBhbmVsJykuY2hpbGRyZW4oKS5ub3QoXCI6Zmlyc3RcIikucmVtb3ZlKCk7XHJcbiAgICAkKCcjaW5kaXZpZHVhbC10YXNrLXBhbmVsJykuYXBwZW5kKHJlbmRlcmVkKTtcclxuXHJcbiAgICB3ZWxjb21lLndpcmVVcFdlbGNvbWVQYWdlKCk7XHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gd2VsY29tZTtcclxuIiwidmFyIGRhdGEgPSByZXF1aXJlKCcuLi9kYXRhLmpzJyksXHJcbiAgY2hhcnQgPSByZXF1aXJlKCcuLi9jaGFydC5qcycpO1xyXG5cclxudmFyIGJkID0ge1xyXG5cclxuICB3aXJlVXA6IGZ1bmN0aW9uKCkge1xyXG5cclxuICB9LFxyXG5cclxuICBzaG93OiBmdW5jdGlvbihwYW5lbCwgaXNBcHBlbmQsIHN1YlBhbmVscywgaXNEb3duVGV4dCwgaXNVcFRleHQpIHtcclxuXHJcbiAgICB2YXIgc2VjdGlvbkVsZW1lbnQgPSAkKCc8ZGl2IGNsYXNzPVwic2VjdGlvblwiPjwvZGl2PicpO1xyXG5cclxuICAgIGlmIChpc0FwcGVuZCkgcGFuZWwuYXBwZW5kKHNlY3Rpb25FbGVtZW50KTtcclxuICAgIGVsc2UgcGFuZWwuaHRtbChzZWN0aW9uRWxlbWVudCk7XHJcblxyXG4gICAgc3ViUGFuZWxzLmZvckVhY2goZnVuY3Rpb24odikge1xyXG4gICAgICB2YXIgYXJncyA9IHYuYXJncztcclxuICAgICAgYXJncy51bnNoaWZ0KHRydWUpO1xyXG4gICAgICBhcmdzLnVuc2hpZnQoc2VjdGlvbkVsZW1lbnQpO1xyXG4gICAgICB2LnNob3cuYXBwbHkobnVsbCwgYXJncyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpZiAoaXNVcFRleHQpIHNlY3Rpb25FbGVtZW50LnByZXBlbmQoJCgnPGRpdiBjbGFzcz1cImZwLWNvbnRyb2xBcnJvdyBmcC11cFwiPjxkaXY+JyArIGlzVXBUZXh0ICsgJzwvZGl2PjwvZGl2PicpKTtcclxuICAgIGlmIChpc0Rvd25UZXh0KSBzZWN0aW9uRWxlbWVudC5hcHBlbmQoJCgnPGRpdiBjbGFzcz1cImZwLWNvbnRyb2xBcnJvdyBmcC1kb3duXCI+PGRpdj4nICsgaXNEb3duVGV4dCArICc8L2Rpdj48L2Rpdj4nKSk7XHJcblxyXG4gIH1cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGJkO1xyXG4iLCJ2YXIgZGF0YSA9IHJlcXVpcmUoJy4vZGF0YS5qcycpLFxyXG4gIGxvb2t1cCA9IHJlcXVpcmUoJy4vbG9va3VwLmpzJyksXHJcbiAgYmFzZSA9IHJlcXVpcmUoJy4vYmFzZS5qcycpLFxyXG4gIHBhdGllbnRzID0gcmVxdWlyZSgnLi9wYW5lbHMvcGF0aWVudHMuanMnKSxcclxuICBwYXRpZW50TGlzdCA9IHJlcXVpcmUoJy4vcGFuZWxzL3BhdGllbnRMaXN0LmpzJyksXHJcbiAgdGVhbUFjdGlvblBsYW4gPSByZXF1aXJlKCcuL3BhbmVscy90ZWFtQWN0aW9uUGxhbi5qcycpLFxyXG4gIGFsbFBhdGllbnRzID0gcmVxdWlyZSgnLi9wYW5lbHMvYWxsUGF0aWVudHMuanMnKSxcclxuICB3ZWxjb21lID0gcmVxdWlyZSgnLi9wYW5lbHMvd2VsY29tZS5qcycpLFxyXG4gIGxheW91dCA9IHJlcXVpcmUoJy4vbGF5b3V0LmpzJyksXHJcbiAgb3ZlcnZpZXcgPSByZXF1aXJlKCcuL3ZpZXdzL292ZXJ2aWV3LmpzJyksXHJcbiAgaW5kaWNhdG9yVmlldyA9IHJlcXVpcmUoJy4vdmlld3MvaW5kaWNhdG9yLmpzJyksXHJcbiAgcGF0aWVudFZpZXcgPSByZXF1aXJlKCcuL3ZpZXdzL3BhdGllbnQuanMnKSxcclxuICBhY3Rpb25QbGFuID0gcmVxdWlyZSgnLi92aWV3cy9hY3Rpb25zLmpzJyksXHJcbiAgTXVzdGFjaGUgPSByZXF1aXJlKCdtdXN0YWNoZScpO1xyXG5cclxudmFyIHRlbXBsYXRlID0ge1xyXG5cclxuICBsb2FkQ29udGVudDogZnVuY3Rpb24oaGFzaCwgaXNQb3BwaW5nU3RhdGUpIHtcclxuICAgIGJhc2UuaGlkZVRvb2x0aXBzKCk7XHJcblxyXG4gICAgdmFyIGksIHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgaW5kaWNhdG9yLCBwYXRpZW50SWQ7XHJcbiAgICBpZiAoIWlzUG9wcGluZ1N0YXRlKSB7XHJcbiAgICAgIHdpbmRvdy5sb2NhdGlvbi5oYXNoID0gaGFzaDtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoaGFzaCA9PT0gJycpIHtcclxuICAgICAgYmFzZS5jbGVhckJveCgpO1xyXG4gICAgICBiYXNlLnNob3dGb290ZXIoKTtcclxuICAgICAgbGF5b3V0LnNob3dQYWdlKCdsb2dpbicpO1xyXG4gICAgICAkKCdodG1sJykucmVtb3ZlQ2xhc3MoJ3Njcm9sbC1iYXInKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGJhc2UuaGlkZUZvb3RlcigpO1xyXG4gICAgICAkKCdodG1sJykuYWRkQ2xhc3MoJ3Njcm9sbC1iYXInKTtcclxuICAgICAgdmFyIHBhcmFtcyA9IHt9O1xyXG4gICAgICB2YXIgdXJsQml0cyA9IGhhc2guc3BsaXQoJy8nKTtcclxuXHJcbiAgICAgIGlmIChoYXNoLmluZGV4T2YoJz8nKSA+IC0xKSB7XHJcbiAgICAgICAgaGFzaC5zcGxpdCgnPycpWzFdLnNwbGl0KCcmJykuZm9yRWFjaChmdW5jdGlvbihwYXJhbSkge1xyXG4gICAgICAgICAgdmFyIGVsZW1zID0gcGFyYW0uc3BsaXQoXCI9XCIpO1xyXG4gICAgICAgICAgcGFyYW1zW2VsZW1zWzBdXSA9IGVsZW1zWzFdO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHVybEJpdHMgPSBoYXNoLnNwbGl0KCc/JylbMF0uc3BsaXQoJy8nKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKHVybEJpdHNbMF0gPT09IFwiI292ZXJ2aWV3XCIgJiYgIXVybEJpdHNbMV0pIHtcclxuXHJcbiAgICAgICAgb3ZlcnZpZXcuY3JlYXRlKHRlbXBsYXRlLmxvYWRDb250ZW50KTtcclxuXHJcbiAgICAgIH0gZWxzZSBpZiAodXJsQml0c1swXSA9PT0gXCIjaW5kaWNhdG9yc1wiKSB7XHJcblxyXG4gICAgICAgIGluZGljYXRvclZpZXcuY3JlYXRlKHVybEJpdHNbMV0sIHVybEJpdHNbMl0sIHVybEJpdHNbM10sIHBhcmFtcy50YWIgfHwgXCJ0cmVuZFwiLCB0ZW1wbGF0ZS5sb2FkQ29udGVudCk7XHJcblxyXG4gICAgICB9IGVsc2UgaWYgKHVybEJpdHNbMF0gPT09IFwiI21haW5cIikge1xyXG4gICAgICAgIGJhc2UuY2xlYXJCb3goKTtcclxuICAgICAgICBwYXRod2F5SWQgPSB1cmxCaXRzWzFdO1xyXG4gICAgICAgIGRhdGEucGF0aHdheUlkID0gcGF0aHdheUlkO1xyXG4gICAgICAgIHBhdGh3YXlTdGFnZSA9IHVybEJpdHNbMl07XHJcbiAgICAgICAgdmFyIHllc1Blb3BsZSA9IHVybEJpdHNbM10gIT09IFwibm9cIjtcclxuICAgICAgICBzdGFuZGFyZCA9IHVybEJpdHNbNF07XHJcblxyXG4gICAgICAgIGlmIChwYXRod2F5U3RhZ2UgJiYgbGF5b3V0LnBhZ2UgIT09ICdtYWluLWRhc2hib2FyZCcpIHtcclxuICAgICAgICAgICQoJy5wYWdlJykuaGlkZSgpO1xyXG4gICAgICAgICAgJCgnI21haW4tZGFzaGJvYXJkJykuc2hvdygpO1xyXG5cclxuICAgICAgICAgIC8vLy9sYXlvdXQuc2hvd1NpZGVQYW5lbCgpO1xyXG4gICAgICAgICAgbGF5b3V0LnNob3dPdmVydmlld1BhbmVscygpO1xyXG4gICAgICAgICAgbGF5b3V0LnNob3dIZWFkZXJCYXJJdGVtcygpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHBhdGh3YXlTdGFnZSkge1xyXG4gICAgICAgICAgaWYgKHllc1Blb3BsZSkge1xyXG4gICAgICAgICAgICB0ZW1wbGF0ZS5zaG93UGF0aHdheVN0YWdlVmlld09rKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCB0ZW1wbGF0ZS5zaG91bGRXZUZhZGUobG9va3VwLmN1cnJlbnRVcmwsIGhhc2gpKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlLnNob3dQYXRod2F5U3RhZ2VWaWV3KHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgdGVtcGxhdGUuc2hvdWxkV2VGYWRlKGxvb2t1cC5jdXJyZW50VXJsLCBoYXNoKSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHRlbXBsYXRlLnNob3dPdmVydmlldyhwYXRod2F5SWQpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG5cclxuICAgICAgfSBlbHNlIGlmICh1cmxCaXRzWzBdID09PSBcIiNoZWxwXCIpIHtcclxuICAgICAgICBiYXNlLmNsZWFyQm94KCk7XHJcbiAgICAgICAgYmFzZS5zZWxlY3RUYWIoXCJcIik7XHJcbiAgICAgICAgbGF5b3V0LnNob3dQYWdlKCdoZWxwLXBhZ2UnKTtcclxuXHJcbiAgICAgICAgbGF5b3V0LnNob3dIZWFkZXJCYXJJdGVtcygpO1xyXG5cclxuICAgICAgfSBlbHNlIGlmICh1cmxCaXRzWzBdID09PSBcIiNwYXRpZW50XCIpIHtcclxuXHJcbiAgICAgICAgLy9jcmVhdGUocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpXHJcbiAgICAgICAgcGF0aWVudFZpZXcuY3JlYXRlKHVybEJpdHNbMl0sIHVybEJpdHNbM10sIHVybEJpdHNbNF0sIHVybEJpdHNbMV0sIHRlbXBsYXRlLmxvYWRDb250ZW50KTtcclxuXHJcbiAgICAgIH0gZWxzZSBpZiAodXJsQml0c1swXSA9PT0gXCIjcGF0aWVudHNcIikge1xyXG5cclxuICAgICAgICBwYXRpZW50SWQgPSB1cmxCaXRzWzFdO1xyXG5cclxuICAgICAgICBwYXRpZW50Vmlldy5jcmVhdGUobnVsbCwgbnVsbCwgbnVsbCwgcGF0aWVudElkLCB0ZW1wbGF0ZS5sb2FkQ29udGVudCk7XHJcbiAgICAgICAgLypwYXRod2F5SWQgPSB1cmxCaXRzWzJdO1xyXG5cclxuICAgICAgICBhbGxQYXRpZW50cy5zaG93VmlldyhwYXRpZW50SWQsIHRydWUpO1xyXG5cclxuICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcblxyXG4gICAgICAgIGlmIChwYXRpZW50SWQpIHtcclxuICAgICAgICAgIHZhciBuaHMgPSBkYXRhLnBhdExvb2t1cCA/IGRhdGEucGF0TG9va3VwW3BhdGllbnRJZF0gOiBwYXRpZW50SWQ7XHJcbiAgICAgICAgICAkKCcjcGF0aWVudHMnKS5maW5kKCdkaXYudGFibGUtc2Nyb2xsJykuZ2V0TmljZVNjcm9sbCgpLmRvU2Nyb2xsUG9zKDAsICQoJyNwYXRpZW50cyB0ZCcpLmZpbHRlcihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuICQodGhpcykudGV4dCgpLnRyaW0oKSA9PT0gbmhzO1xyXG4gICAgICAgICAgfSkucG9zaXRpb24oKS50b3AgLSAxNDApO1xyXG4gICAgICAgICAgJCgnI3BhdGllbnRzJykuZmluZCgndHI6Y29udGFpbnMoJyArIG5ocyArICcpJykuYWRkQ2xhc3MoXCJoaWdobGlnaHRlZFwiKTtcclxuICAgICAgICB9Ki9cclxuICAgICAgfSBlbHNlIGlmICh1cmxCaXRzWzBdID09PSBcIiNhZ3JlZWRhY3Rpb25zXCIpIHtcclxuXHJcbiAgICAgICAgYWN0aW9uUGxhbi5jcmVhdGUoKTtcclxuXHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy9pZiBzY3JlZW4gbm90IGluIGNvcnJlY3Qgc2VnbWVudCB0aGVuIHNlbGVjdCBpdFxyXG4gICAgICAgIGFsZXJ0KFwic2hvdWxkbid0IGdldCBoZXJlXCIpO1xyXG4gICAgICAgIHBhdGh3YXlTdGFnZSA9IGhhc2guc3Vic3RyKDEpO1xyXG5cclxuICAgICAgICB0ZW1wbGF0ZS5zaG93UGF0aHdheVN0YWdlVmlldyhwYXRod2F5U3RhZ2UpO1xyXG5cclxuICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBsb29rdXAuY3VycmVudFVybCA9IGhhc2g7XHJcbiAgfSxcclxuXHJcbiAgLy9TaG93IHRoZSBvdmVydmlldyBwYWdlIGZvciBhIGRpc2Vhc2VcclxuICBzaG93T3ZlcnZpZXc6IGZ1bmN0aW9uKGRpc2Vhc2UpIHtcclxuICAgIGRhdGEucGF0aHdheUlkID0gZGlzZWFzZTtcclxuXHJcbiAgICBsYXlvdXQuc2hvd01haW5WaWV3KGRhdGEuZGlzZWFzZXMubWFwKGZ1bmN0aW9uKHYpIHtcclxuICAgICAgcmV0dXJuIHYuaWQ7XHJcbiAgICB9KS5pbmRleE9mKGRpc2Vhc2UpKTtcclxuXHJcbiAgICAkKCdhc2lkZSBsaSB1bCBsaScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICQoJ2FzaWRlIGFbaHJlZj1cIiNtYWluLycgKyBkaXNlYXNlICsgJ1wiXTpjb250YWlucyhcIk92ZXJ2aWV3XCIpJykucGFyZW50KCkuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG5cclxuICAgICQoJyNtYWluVGl0bGUnKS5zaG93KCk7XHJcbiAgICBiYXNlLnVwZGF0ZVRpdGxlKGRhdGEudGV4dFtkYXRhLnBhdGh3YXlJZF1bXCJkaXNwbGF5LW5hbWVcIl0gKyBcIjogT3ZlcnZpZXcgKHByYWN0aWNlLWxldmVsIGRhdGEpXCIpO1xyXG5cclxuICAgIC8vU2hvdyBvdmVydmlldyBwYW5lbHNcclxuICAgIHRlbXBsYXRlLnNob3dPdmVydmlld1BhbmVscygpO1xyXG4gICAgdGVhbUFjdGlvblBsYW4uc2hvdyhmYXJSaWdodFBhbmVsKTtcclxuICB9LFxyXG5cclxuICBzaG93T3ZlcnZpZXdQYW5lbHM6IGZ1bmN0aW9uKCkge1xyXG4gICAgYmFzZS5zd2l0Y2hUbzIyMUxheW91dCgpO1xyXG5cclxuICAgIHRlbXBsYXRlLnNob3dQYW5lbChsb29rdXAuY2F0ZWdvcmllcy5kaWFnbm9zaXMubmFtZSwgdG9wTGVmdFBhbmVsLCB0cnVlKTtcclxuICAgIHRlbXBsYXRlLnNob3dQYW5lbChsb29rdXAuY2F0ZWdvcmllcy5tb25pdG9yaW5nLm5hbWUsIHRvcFJpZ2h0UGFuZWwsIHRydWUpO1xyXG4gICAgdGVtcGxhdGUuc2hvd1BhbmVsKGxvb2t1cC5jYXRlZ29yaWVzLnRyZWF0bWVudC5uYW1lLCBib3R0b21MZWZ0UGFuZWwsIHRydWUpO1xyXG4gICAgdGVtcGxhdGUuc2hvd1BhbmVsKGxvb2t1cC5jYXRlZ29yaWVzLmV4Y2x1c2lvbnMubmFtZSwgYm90dG9tUmlnaHRQYW5lbCwgdHJ1ZSk7XHJcblxyXG4gICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gIH0sXHJcblxyXG4gIHNob3dQYW5lbDogZnVuY3Rpb24ocGF0aHdheVN0YWdlLCBsb2NhdGlvbiwgZW5hYmxlSG92ZXIpIHtcclxuICAgIGJhc2Uuc2hvd1BhdGh3YXlTdGFnZU92ZXJ2aWV3UGFuZWwobG9jYXRpb24sIGVuYWJsZUhvdmVyLCBkYXRhLnBhdGh3YXlJZCwgcGF0aHdheVN0YWdlKTtcclxuXHJcbiAgICBpZiAoZW5hYmxlSG92ZXIpIHRlbXBsYXRlLmhpZ2hsaWdodE9uSG92ZXJBbmRFbmFibGVTZWxlY3RCeUNsaWNrKGxvY2F0aW9uKTtcclxuICAgIGVsc2UgbG9jYXRpb24uY2hpbGRyZW4oJ2RpdicpLmFkZENsYXNzKCd1bmNsaWNrYWJsZScpO1xyXG4gIH0sXHJcblxyXG4gIC8vU2hvdyB0aGUgcGF0aHdheSBzdGFnZSBmb3IgYSBkaXNlYXNlXHJcbiAgc2hvd1BhdGh3YXlTdGFnZVZpZXc6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgc2hvdWxkRmFkZSkge1xyXG4gICAgZmFyUmlnaHRQYW5lbC5yZW1vdmVDbGFzcygnc3RhbmRhcmQtbWlzc2VkLXBhZ2UnKS5yZW1vdmVDbGFzcygnc3RhbmRhcmQtYWNoaWV2ZWQtcGFnZScpLnJlbW92ZUNsYXNzKCdzdGFuZGFyZC1ub3QtcmVsZXZhbnQtcGFnZScpO1xyXG4gICAgZGF0YS5wYXRod2F5SWQgPSBwYXRod2F5SWQ7XHJcbiAgICBsYXlvdXQuc2hvd01haW5WaWV3KGRhdGEuZGlzZWFzZXMubWFwKGZ1bmN0aW9uKHYpIHtcclxuICAgICAgcmV0dXJuIHYuaWQ7XHJcbiAgICB9KS5pbmRleE9mKHBhdGh3YXlJZCkpO1xyXG5cclxuICAgICQoJ2FzaWRlIGxpIHVsIGxpJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgdmFyIHJlID0gbmV3IFJlZ0V4cChwYXRod2F5U3RhZ2UsIFwiZ1wiKTtcclxuICAgICQoJ2FzaWRlIGEnKS5maWx0ZXIoZnVuY3Rpb24oKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLmhyZWYubWF0Y2gocmUpO1xyXG4gICAgfSkucGFyZW50KCkuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG5cclxuICAgIGJhc2Uuc3dpdGNoVG8xMTBMYXlvdXQoKTtcclxuXHJcbiAgICBpZiAoIXN0YW5kYXJkKSB7XHJcbiAgICAgIHN0YW5kYXJkID0gT2JqZWN0LmtleXMoZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzKVswXTtcclxuICAgIH1cclxuXHJcbiAgICB2YXIgcGFuZWwgPSBwYXRpZW50cy5jcmVhdGUocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkKTtcclxuXHJcbiAgICBpZiAoc2hvdWxkRmFkZSkge1xyXG4gICAgICBmYXJMZWZ0UGFuZWwuZmFkZU91dCgxMDAsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICQodGhpcykuaHRtbChwYW5lbCk7XHJcbiAgICAgICAgcGF0aWVudHMud2lyZVVwKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBmYXJMZWZ0UGFuZWwsIHN0YW5kYXJkKTtcclxuICAgICAgICBwYXRpZW50TGlzdC5wb3B1bGF0ZShwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIG51bGwpO1xyXG4gICAgICAgICQoJyNtYWluVGl0bGUnKS5oaWRlKCk7XHJcbiAgICAgICAgYmFzZS51cGRhdGVUaXRsZShkYXRhLnRleHRbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnRleHQucGFnZS50ZXh0LCBkYXRhLnRleHRbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnRleHQucGFnZS50b29sdGlwKTtcclxuICAgICAgICAkKHRoaXMpLmZhZGVJbigxMDApO1xyXG4gICAgICB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGZhckxlZnRQYW5lbC5odG1sKHBhbmVsKTtcclxuICAgICAgcGF0aWVudHMud2lyZVVwKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBmYXJMZWZ0UGFuZWwsIHN0YW5kYXJkKTtcclxuICAgICAgcGF0aWVudExpc3QucG9wdWxhdGUocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBudWxsKTtcclxuICAgICAgJCgnI21haW5UaXRsZScpLmhpZGUoKTtcclxuICAgICAgYmFzZS51cGRhdGVUaXRsZShkYXRhLnRleHRbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnRleHQucGFnZS50ZXh0LCBkYXRhLnRleHRbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnRleHQucGFnZS50b29sdGlwKTtcclxuICAgIH1cclxuXHJcbiAgICB2YXIgdGVtcE11c3QgPSAkKCcjcGF0aWVudC1wYW5lbC1wbGFjZWhvbGRlcicpLmh0bWwoKTtcclxuICAgIGZhclJpZ2h0UGFuZWwuaHRtbChNdXN0YWNoZS5yZW5kZXIodGVtcE11c3QpKTtcclxuICB9LFxyXG5cclxuICBzaG93UGF0aHdheVN0YWdlVmlld09rOiBmdW5jdGlvbihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc2hvdWxkRmFkZSkge1xyXG4gICAgZmFyUmlnaHRQYW5lbC5yZW1vdmVDbGFzcygnc3RhbmRhcmQtbWlzc2VkLXBhZ2UnKS5yZW1vdmVDbGFzcygnc3RhbmRhcmQtYWNoaWV2ZWQtcGFnZScpLnJlbW92ZUNsYXNzKCdzdGFuZGFyZC1ub3QtcmVsZXZhbnQtcGFnZScpO1xyXG4gICAgbGF5b3V0LnNob3dNYWluVmlldyhkYXRhLmRpc2Vhc2VzLm1hcChmdW5jdGlvbih2KSB7XHJcbiAgICAgIHJldHVybiB2LmlkO1xyXG4gICAgfSkuaW5kZXhPZihwYXRod2F5SWQpKTtcclxuXHJcbiAgICAkKCdhc2lkZSBsaSB1bCBsaScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgIHZhciByZSA9IG5ldyBSZWdFeHAocGF0aHdheVN0YWdlLCBcImdcIik7XHJcbiAgICAkKCdhc2lkZSBhJykuZmlsdGVyKGZ1bmN0aW9uKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5ocmVmLm1hdGNoKHJlKTtcclxuICAgIH0pLnBhcmVudCgpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuXHJcbiAgICBiYXNlLnN3aXRjaFRvMTEwTGF5b3V0KCk7XHJcblxyXG4gICAgdmFyIHBhbmVsID0gcGF0aWVudHMuY3JlYXRlT2socGF0aHdheUlkLCBwYXRod2F5U3RhZ2UpO1xyXG5cclxuICAgIGlmIChzaG91bGRGYWRlKSB7XHJcbiAgICAgIGZhckxlZnRQYW5lbC5mYWRlT3V0KDIwMCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgJCh0aGlzKS5odG1sKHBhbmVsKTtcclxuICAgICAgICBwYXRpZW50cy53aXJlVXBPayhwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgZmFyTGVmdFBhbmVsKTtcclxuICAgICAgICBwYXRpZW50cy5wb3B1bGF0ZU9rKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBudWxsKTtcclxuICAgICAgICAkKCcjbWFpblRpdGxlJykuaGlkZSgpO1xyXG4gICAgICAgIGJhc2UudXBkYXRlVGl0bGUoZGF0YS50ZXh0W3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS50ZXh0LnBhZ2UudGV4dCwgZGF0YS50ZXh0W3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS50ZXh0LnBhZ2UudG9vbHRpcCk7XHJcbiAgICAgICAgJCh0aGlzKS5mYWRlSW4oMzAwKTtcclxuICAgICAgfSk7XHJcbiAgICAgIHZhciB0ZW1wTXVzdCA9ICQoJyNwYXRpZW50LXBhbmVsLXBsYWNlaG9sZGVyJykuaHRtbCgpO1xyXG4gICAgICBmYXJSaWdodFBhbmVsLmh0bWwoTXVzdGFjaGUucmVuZGVyKHRlbXBNdXN0KSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBmYXJMZWZ0UGFuZWwuaHRtbChwYW5lbCk7XHJcbiAgICAgIHBhdGllbnRzLndpcmVVcE9rKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBmYXJMZWZ0UGFuZWwpO1xyXG4gICAgICBwYXRpZW50cy5wb3B1bGF0ZU9rKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBudWxsKTtcclxuICAgICAgJCgnI21haW5UaXRsZScpLmhpZGUoKTtcclxuICAgICAgYmFzZS51cGRhdGVUaXRsZShkYXRhLnRleHRbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnRleHQucGFnZS50ZXh0LCBkYXRhLnRleHRbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnRleHQucGFnZS50b29sdGlwKTtcclxuICAgIH1cclxuICB9LFxyXG5cclxuICBoaWdobGlnaHRPbkhvdmVyQW5kRW5hYmxlU2VsZWN0QnlDbGljazogZnVuY3Rpb24ocGFuZWxTZWxlY3Rvcikge1xyXG4gICAgcGFuZWxTZWxlY3Rvci5jaGlsZHJlbignZGl2JykucmVtb3ZlQ2xhc3MoJ3VuY2xpY2thYmxlJykub24oJ21vdXNlb3ZlcicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKCdwYW5lbC1kZWZhdWx0Jyk7XHJcbiAgICB9KS5vbignbW91c2VvdXQnLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICQodGhpcykuYWRkQ2xhc3MoJ3BhbmVsLWRlZmF1bHQnKTtcclxuICAgIH0pLm9uKCdjbGljaycsICd0ci5zdGFuZGFyZC1yb3cnLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIGhpc3RvcnkucHVzaFN0YXRlKG51bGwsIG51bGwsICcjbWFpbi8nICsgZGF0YS5wYXRod2F5SWQgKyAnLycgKyAkKHRoaXMpLmNsb3Nlc3QoJy5wYW5lbCcpLmRhdGEoJ3N0YWdlJykgKyAnL25vLycgKyAkKHRoaXMpLmRhdGEoJ3N0YW5kYXJkJykpO1xyXG4gICAgICB0ZW1wbGF0ZS5sb2FkQ29udGVudCgnI21haW4vJyArIGRhdGEucGF0aHdheUlkICsgJy8nICsgJCh0aGlzKS5jbG9zZXN0KCcucGFuZWwnKS5kYXRhKCdzdGFnZScpICsgJy9uby8nICsgJCh0aGlzKS5kYXRhKCdzdGFuZGFyZCcpLCB0cnVlKTtcclxuICAgICAgLy8gZG8gbm90IGdpdmUgYSBkZWZhdWx0IGFjdGlvblxyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0pLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgLy8ga2VlcCB0aGUgbGluayBpbiB0aGUgYnJvd3NlciBoaXN0b3J5XHJcbiAgICAgIGhpc3RvcnkucHVzaFN0YXRlKG51bGwsIG51bGwsICcjbWFpbi8nICsgZGF0YS5wYXRod2F5SWQgKyAnLycgKyAkKHRoaXMpLmRhdGEoJ3N0YWdlJykgKyAnL25vJyk7XHJcbiAgICAgIHRlbXBsYXRlLmxvYWRDb250ZW50KCcjbWFpbi8nICsgZGF0YS5wYXRod2F5SWQgKyAnLycgKyAkKHRoaXMpLmRhdGEoJ3N0YWdlJykgKyAnL25vJywgdHJ1ZSk7XHJcbiAgICAgIC8vIGRvIG5vdCBnaXZlIGEgZGVmYXVsdCBhY3Rpb25cclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfSk7XHJcblxyXG4gIH0sXHJcblxyXG4gIGRpc3BsYXlTZWxlY3RlZFBhdGllbnQ6IGZ1bmN0aW9uKGlkKSB7XHJcbiAgICB2YXIgbmhzID0gZGF0YS5wYXRMb29rdXAgPyBkYXRhLnBhdExvb2t1cFtpZF0gOiBpZDtcclxuXHJcbiAgICBoaXN0b3J5LnB1c2hTdGF0ZShudWxsLCBudWxsLCAnI3BhdGllbnRzLycgKyBpZCk7XHJcbiAgICB0ZW1wbGF0ZS5sb2FkQ29udGVudCgnI3BhdGllbnRzLycgKyBpZCwgdHJ1ZSk7XHJcblxyXG4gICAgJCgnLmxpc3QtaXRlbScpLnJlbW92ZUNsYXNzKCdoaWdobGlnaHRlZCcpO1xyXG4gICAgJCgnLmxpc3QtaXRlbTpoYXMoYnV0dG9uW2RhdGEtY2xpcGJvYXJkLXRleHQ9JyArIG5ocyArICddKScpLmFkZENsYXNzKCdoaWdobGlnaHRlZCcpO1xyXG5cclxuICAgIC8vc2Nyb2xsIHRvIHBhdGllbnRzXHJcbiAgICAkKCcjcGF0aWVudHMnKS5maW5kKCdkaXYudGFibGUtc2Nyb2xsJykuZ2V0TmljZVNjcm9sbCgpLmRvU2Nyb2xsUG9zKDAsICQoJyNwYXRpZW50cyB0ZCcpLmZpbHRlcihmdW5jdGlvbigpIHtcclxuICAgICAgcmV0dXJuICQodGhpcykudGV4dCgpLnRyaW0oKSA9PT0gbmhzO1xyXG4gICAgfSkucG9zaXRpb24oKS50b3AgLSAxNDApO1xyXG4gIH0sXHJcblxyXG4gIHNob3VsZFdlRmFkZTogZnVuY3Rpb24ob2xkSGFzaCwgbmV3SGFzaCkge1xyXG4gICAgb2xkSGFzaCA9IG9sZEhhc2guc3BsaXQoJy8nKTtcclxuICAgIG5ld0hhc2ggPSBuZXdIYXNoLnNwbGl0KCcvJyk7XHJcblxyXG4gICAgaWYgKG9sZEhhc2hbMF0gPT09IG5ld0hhc2hbMF0gJiYgb2xkSGFzaFsxXSA9PT0gbmV3SGFzaFsxXSAmJiBvbGRIYXNoWzJdID09PSBuZXdIYXNoWzJdICYmIG9sZEhhc2hbMF0gJiYgbmV3SGFzaFswXSkgcmV0dXJuIGZhbHNlO1xyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gdGVtcGxhdGU7XHJcbiIsInZhciBiYXNlID0gcmVxdWlyZSgnLi4vYmFzZS5qcycpLFxyXG4gIGxheW91dCA9IHJlcXVpcmUoJy4uL2xheW91dC5qcycpLFxyXG4gIHdlbGNvbWUgPSByZXF1aXJlKCcuLi9wYW5lbHMvd2VsY29tZS5qcycpO1xyXG5cclxudmFyIElEID0gXCJBQ1RJT05fUExBTl9WSUVXXCI7XHJcblxyXG52YXIgYXAgPSB7XHJcblxyXG4gIGNyZWF0ZTogZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgYmFzZS5zZWxlY3RUYWIoXCJhY3Rpb25zXCIpO1xyXG5cclxuICAgIGlmKGxheW91dC52aWV3ICE9PSBJRCkge1xyXG4gICAgICAvL05vdCBhbHJlYWR5IGluIHRoaXMgdmlldyBzbyB3ZSBuZWVkIHRvIHJlamlnIGEgZmV3IHRoaW5nc1xyXG4gICAgICBiYXNlLmNsZWFyQm94KCk7XHJcbiAgICAgIGxheW91dC5zaG93UGFnZSgnd2VsY29tZScpO1xyXG4gICAgICBsYXlvdXQuc2hvd0hlYWRlckJhckl0ZW1zKCk7XHJcblxyXG4gICAgICAkKCcjd2VsY29tZS10YWJzIGxpJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAkKCcjb3V0c3RhbmRpbmdUYXNrcycpLmNsb3Nlc3QoJ2xpJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG5cclxuICAgICAgbGF5b3V0LnZpZXcgPSBJRDtcclxuICAgIH1cclxuXHJcbiAgICB3ZWxjb21lLnBvcHVsYXRlKCk7XHJcblxyXG4gIH1cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGFwO1xyXG4iLCJ2YXIgYmFzZSA9IHJlcXVpcmUoJy4uL2Jhc2UuanMnKSxcclxuICBkYXRhID0gcmVxdWlyZSgnLi4vZGF0YS5qcycpLFxyXG4gIHBhdGllbnRMaXN0ID0gcmVxdWlyZSgnLi4vcGFuZWxzL3BhdGllbnRMaXN0LmpzJyksXHJcbiAgaW5kaWNhdG9yQnJlYWtkb3duID0gcmVxdWlyZSgnLi4vcGFuZWxzL2luZGljYXRvckJyZWFrZG93bi5qcycpLFxyXG4gIGluZGljYXRvckJlbmNobWFyayA9IHJlcXVpcmUoJy4uL3BhbmVscy9pbmRpY2F0b3JCZW5jaG1hcmsuanMnKSxcclxuICBpbmRpY2F0b3JUcmVuZCA9IHJlcXVpcmUoJy4uL3BhbmVscy9pbmRpY2F0b3JUcmVuZC5qcycpLFxyXG4gIGluZGljYXRvckhlYWRsaW5lcyA9IHJlcXVpcmUoJy4uL3BhbmVscy9pbmRpY2F0b3JIZWFkbGluZXMuanMnKSxcclxuICB0ZWFtQWN0aW9uUGxhbiA9IHJlcXVpcmUoJy4uL3BhbmVscy90ZWFtQWN0aW9uUGxhbi5qcycpLFxyXG4gIHdyYXBwZXIgPSByZXF1aXJlKCcuLi9wYW5lbHMvd3JhcHBlci5qcycpLFxyXG4gIGxheW91dCA9IHJlcXVpcmUoJy4uL2xheW91dC5qcycpO1xyXG5cclxudmFyIElEID0gXCJJTkRJQ0FUT1JcIjtcclxuLypcclxuICogVGhlIGluZGljYXRvciBwYWdlIGNvbnNpc3RzIG9mIHRoZSBwYW5lbHM6XHJcbiAqICAgVGFiYmVkIHBhbmVsXHJcbiAqICAgICAtIHBlcmZvcm1hbmNlIHRyZW5kXHJcbiAqICAgICAtIHBlcmZvcm1hbmNlIGJlbmNobWFya1xyXG4gKiAgIFBhdGllbnQgZ3JvdXBzXHJcbiAqICAgUGF0aWVudCBsaXN0XHJcbiAqICAgVGVhbSBhY3Rpb24gcGxhblxyXG4gKi9cclxuXHJcbnZhciBpbmQgPSB7XHJcblxyXG4gIGNyZWF0ZTogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCB0YWIsIGxvYWRDb250ZW50Rm4pIHtcclxuXHJcbiAgICBiYXNlLnNlbGVjdFRhYihcImluZGljYXRvclwiKTtcclxuICAgIGJhc2Uuc2hvd0xvYWRpbmcoKTtcclxuXHJcbiAgICAvL3VzZSBhIHNldFRpbWVvdXQgdG8gZm9yY2UgdGhlIFVJIHRvIGNoYW5nZSBlLmcuIHNob3cgdGhlIGxvYWRpbmctY29udGFpbmVyXHJcbiAgICAvL2JlZm9yZSBmdXJ0aGVyIGV4ZWN1dGlvblxyXG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgaWYgKGxheW91dC52aWV3ICE9PSBJRCkge1xyXG4gICAgICAgIC8vTm90IGFscmVhZHkgaW4gdGhpcyB2aWV3IHNvIHdlIG5lZWQgdG8gcmVqaWcgYSBmZXcgdGhpbmdzXHJcbiAgICAgICAgYmFzZS5jbGVhckJveCgpO1xyXG4gICAgICAgIC8vYmFzZS5zd2l0Y2hUbzIxTGF5b3V0KCk7XHJcbiAgICAgICAgbGF5b3V0LnNob3dNYWluVmlldygpO1xyXG5cclxuICAgICAgICBiYXNlLnJlbW92ZUZ1bGxQYWdlKGZhclJpZ2h0UGFuZWwpO1xyXG4gICAgICAgIGJhc2UuaGlkZVBhbmVscyhmYXJSaWdodFBhbmVsKTtcclxuXHJcbiAgICAgICAgbGF5b3V0LnZpZXcgPSBJRDtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKCFwYXRod2F5SWQpIHtcclxuICAgICAgICBpZiAobGF5b3V0LnBhdGh3YXlJZCkgcGF0aHdheUlkID0gbGF5b3V0LnBhdGh3YXlJZDtcclxuICAgICAgICBlbHNlIHBhdGh3YXlJZCA9IE9iamVjdC5rZXlzKGRhdGEucGF0aHdheU5hbWVzKVswXTtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKCFwYXRod2F5U3RhZ2UpIHtcclxuICAgICAgICBpZiAobGF5b3V0LnBhdGh3YXlTdGFnZSkgcGF0aHdheVN0YWdlID0gbGF5b3V0LnBhdGh3YXlTdGFnZTtcclxuICAgICAgICBlbHNlIHBhdGh3YXlTdGFnZSA9IE9iamVjdC5rZXlzKGRhdGEudGV4dFtwYXRod2F5SWRdKVswXTtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKCFzdGFuZGFyZCkge1xyXG4gICAgICAgIGlmIChsYXlvdXQuc3RhbmRhcmQpIHN0YW5kYXJkID0gbGF5b3V0LnN0YW5kYXJkO1xyXG4gICAgICAgIGVsc2Ugc3RhbmRhcmQgPSBPYmplY3Qua2V5cyhkYXRhLnRleHRbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkcylbMF07XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vaWYgKGxheW91dC5wYXRod2F5SWQgIT09IHBhdGh3YXlJZCB8fCBsYXlvdXQucGF0aHdheVN0YWdlICE9PSBwYXRod2F5U3RhZ2UpIHtcclxuICAgICAgICAvL2RpZmZlcmVudCBwYXRod2F5IG9yIHN0YWdlIHNvIHRpdGxlIG5lZWRzIHVwZGF0aW5nXHJcbiAgICAgICAgYmFzZS51cGRhdGVUaXRsZShkYXRhLnRleHRbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0ubmFtZSk7XHJcbiAgICAgICAgLypiYXNlLnVwZGF0ZVRpdGxlKFt7XHJcbiAgICAgICAgICB0aXRsZTogXCJPdmVydmlld1wiLFxyXG4gICAgICAgICAgdXJsOiBcIiNvdmVydmlld1wiXHJcbiAgICAgICAgfSwge1xyXG4gICAgICAgICAgdGl0bGU6IGRhdGEudGV4dFtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0udGV4dC5wYWdlLnRleHQsXHJcbiAgICAgICAgICB0b29sdGlwOiBkYXRhLnRleHRbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnRleHQucGFnZS50b29sdGlwXHJcbiAgICAgICAgfV0pO1xyXG4gICAgICAgICQoJyNtYWluVGl0bGUnKS5zaG93KCk7Ki9cclxuICAgICAgLy99XHJcblxyXG4gICAgICBsYXlvdXQucGF0aHdheUlkID0gcGF0aHdheUlkO1xyXG4gICAgICBsYXlvdXQucGF0aHdheVN0YWdlID0gcGF0aHdheVN0YWdlO1xyXG4gICAgICBsYXlvdXQuc3RhbmRhcmQgPSBzdGFuZGFyZDtcclxuXHJcbiAgICAgIC8vVE9ETyBub3Qgc3VyZSBpZiB0aGlzIG5lZWRzIG1vdmluZy4uP1xyXG4gICAgICBkYXRhLnBhdGh3YXlJZCA9IHBhdGh3YXlJZDtcclxuXHJcbiAgICAgIC8vVGhlIHRocmVlIHBhbmVscyB3ZSBuZWVkIHRvIHNob3dcclxuICAgICAgLy9QYW5lbHMgZGVjaWRlIHdoZXRoZXIgdGhleSBuZWVkIHRvIHJlZHJhdyB0aGVtc2VsdmVzXHJcbiAgICAgIHRlYW1BY3Rpb25QbGFuLnNob3coZmFyTGVmdFBhbmVsKTtcclxuXHJcbiAgICAgIGJhc2UudXBkYXRlVGFiKFwiaW5kaWNhdG9yc1wiLCBbcGF0aHdheUlkLnRvVXBwZXJDYXNlKCksIHN0YW5kYXJkLnRvVXBwZXJDYXNlKCldLmpvaW4oXCIgXCIpLCBbcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkXS5qb2luKFwiL1wiKSk7XHJcblxyXG4gICAgICB3cmFwcGVyLnNob3coZmFyUmlnaHRQYW5lbCwgZmFsc2UsIFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICBzaG93OiBpbmRpY2F0b3JIZWFkbGluZXMuc2hvdyxcclxuICAgICAgICAgIGFyZ3M6IFtwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmRdXHJcbiAgICAgICAgfSwge1xyXG4gICAgICAgICAgc2hvdzogaW5kaWNhdG9yQnJlYWtkb3duLnNob3csXHJcbiAgICAgICAgICBhcmdzOiBbcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50TGlzdC5zZWxlY3RTdWJzZWN0aW9uXVxyXG4gICAgICAgIH0sIHtcclxuICAgICAgICAgIHNob3c6IHBhdGllbnRMaXN0LnNob3csXHJcbiAgICAgICAgICBhcmdzOiBbcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBsb2FkQ29udGVudEZuXVxyXG4gICAgICAgIH1cclxuICAgICAgXSwgXCJQZXJmb3JtYW5jZSBvdmVyIHRpbWVcIiwgZmFsc2UpO1xyXG4gICAgICB3cmFwcGVyLnNob3coZmFyUmlnaHRQYW5lbCwgdHJ1ZSwgW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgIHNob3c6IGluZGljYXRvclRyZW5kLnNob3csXHJcbiAgICAgICAgICBhcmdzOiBbcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkXVxyXG4gICAgICAgIH1cclxuICAgICAgXSwgXCJCZW5jaG1hcmtpbmdcIiwgXCJQYXRpZW50cyBhdCByaXNrXCIpO1xyXG4gICAgICB3cmFwcGVyLnNob3coZmFyUmlnaHRQYW5lbCwgdHJ1ZSwgW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgIHNob3c6IGluZGljYXRvckJlbmNobWFyay5zaG93LFxyXG4gICAgICAgICAgYXJnczogW3BhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZF1cclxuICAgICAgICB9XHJcbiAgICAgIF0sIGZhbHNlLCBcIlBlcmZvcm1hbmNlIG92ZXIgdGltZVwiKTtcclxuXHJcbiAgICAgIGJhc2UuYWRkRnVsbFBhZ2UoZmFyUmlnaHRQYW5lbCk7XHJcblxyXG4gICAgICAkKCcjaW5kaWNhdG9yLXBhbmUnKS5zaG93KCk7XHJcblxyXG4gICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcblxyXG4gICAgICAvKnNldFRpbWVvdXQoJCgnLmZwLWNvbnRyb2xBcnJvdycpLmVhY2goZnVuY3Rpb24oaWR4LCBlbCkge1xyXG4gICAgICAgIGlmKGVsLmlzKFwiOnZpc2libGVcIikpXHJcbiAgICAgIH0pLCAyMDAwKTsqL1xyXG5cclxuICAgICAgYmFzZS5oaWRlTG9hZGluZygpO1xyXG4gICAgfSwgMCk7XHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gaW5kO1xyXG4iLCJ2YXIgYmFzZSA9IHJlcXVpcmUoJy4uL2Jhc2UuanMnKSxcclxuICBkYXRhID0gcmVxdWlyZSgnLi4vZGF0YS5qcycpLFxyXG4gIGxheW91dCA9IHJlcXVpcmUoJy4uL2xheW91dC5qcycpLFxyXG4gIGluZGljYXRvckxpc3QgPSByZXF1aXJlKCcuLi9wYW5lbHMvaW5kaWNhdG9yTGlzdC5qcycpLFxyXG4gIHRlYW1BY3Rpb25QbGFuID0gcmVxdWlyZSgnLi4vcGFuZWxzL3RlYW1BY3Rpb25QbGFuLmpzJyk7XHJcblxyXG52YXIgSUQgPSBcIk9WRVJWSUVXXCI7XHJcbi8qXHJcbiAqIFRoZSBvdmVydmlldyBwYWdlIGNvbnNpc3RzIG9mIHRoZSBwYW5lbHM6XHJcbiAqICAgSW5kaWNhdG9yIGxpc3RcclxuICogICBUZWFtIGFjdGlvbiBwbGFuXHJcbiAqL1xyXG52YXIgb3ZlcnZpZXcgPSB7XHJcblxyXG4gIGNyZWF0ZTogZnVuY3Rpb24obG9hZENvbnRlbnRGbikge1xyXG5cclxuICAgIGJhc2Uuc2VsZWN0VGFiKFwib3ZlcnZpZXdcIik7XHJcbiAgICBiYXNlLnNob3dMb2FkaW5nKCk7XHJcblxyXG4gICAgLy91c2UgYSBzZXRUaW1lb3V0IHRvIGZvcmNlIHRoZSBVSSB0byBjaGFuZ2UgZS5nLiBzaG93IHRoZSBsb2FkaW5nLWNvbnRhaW5lclxyXG4gICAgLy9iZWZvcmUgZnVydGhlciBleGVjdXRpb25cclxuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICBpZiAobGF5b3V0LnZpZXcgIT09IElEKSB7XHJcbiAgICAgICAgLy9Ob3QgYWxyZWFkeSBpbiB0aGlzIHZpZXcgc28gd2UgbmVlZCB0byByZWppZyBhIGZldyB0aGluZ3NcclxuICAgICAgICBiYXNlLmNsZWFyQm94KCk7XHJcbiAgICAgICAgLy9iYXNlLnN3aXRjaFRvMTAxTGF5b3V0KCk7XHJcbiAgICAgICAgbGF5b3V0LnNob3dNYWluVmlldygpO1xyXG5cclxuICAgICAgICAkKCcjbWFpblRpdGxlJykuc2hvdygpO1xyXG4gICAgICAgIGJhc2UudXBkYXRlVGl0bGUoXCJPdmVydmlldyBvZiB5b3VyIHByYWN0aWNlIHBlcmZvcm1hbmNlXCIpO1xyXG5cclxuICAgICAgICBiYXNlLnJlbW92ZUZ1bGxQYWdlKGZhclJpZ2h0UGFuZWwpO1xyXG4gICAgICAgIGJhc2UuaGlkZVBhbmVscyhmYXJSaWdodFBhbmVsKTtcclxuXHJcbiAgICAgICAgbGF5b3V0LnZpZXcgPSBJRDtcclxuICAgICAgfVxyXG5cclxuICAgICAgZGF0YS5wYXRod2F5SWQgPSBcImh0blwiOyAvL1RPRE8gZnVkZ2VcclxuXHJcbiAgICAgIC8vVGhlIHR3byBwYW5lbHMgd2UgbmVlZCB0byBzaG93XHJcbiAgICAgIC8vUGFuZWxzIGRlY2lkZSB3aGV0aGVyIHRoZXkgbmVlZCB0byByZWRyYXcgdGhlbXNlbHZlc1xyXG4gICAgICB0ZWFtQWN0aW9uUGxhbi5zaG93KGZhckxlZnRQYW5lbCk7XHJcbiAgICAgIGluZGljYXRvckxpc3Quc2hvdyhmYXJSaWdodFBhbmVsLCBmYWxzZSwgbG9hZENvbnRlbnRGbik7XHJcblxyXG4gICAgICAkKCcjb3ZlcnZpZXctcGFuZScpLnNob3coKTtcclxuXHJcbiAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgICAgYmFzZS5oaWRlTG9hZGluZygpO1xyXG4gICAgfSwgMCk7XHJcblxyXG4gIH1cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IG92ZXJ2aWV3O1xyXG4iLCJ2YXIgbGlmZWxpbmUgPSByZXF1aXJlKCcuLi9wYW5lbHMvbGlmZWxpbmUuanMnKSxcclxuICBkYXRhID0gcmVxdWlyZSgnLi4vZGF0YS5qcycpLFxyXG4gIGJhc2UgPSByZXF1aXJlKCcuLi9iYXNlLmpzJyksXHJcbiAgbGF5b3V0ID0gcmVxdWlyZSgnLi4vbGF5b3V0LmpzJyksXHJcbiAgaW5kaXZpZHVhbEFjdGlvblBsYW4gPSByZXF1aXJlKCcuLi9wYW5lbHMvaW5kaXZpZHVhbEFjdGlvblBsYW4uanMnKSxcclxuICBxdWFsaXR5U3RhbmRhcmRzID0gcmVxdWlyZSgnLi4vcGFuZWxzL3F1YWxpdHlTdGFuZGFyZHMuanMnKSxcclxuICBwYXRpZW50Q2hhcmFjdGVyaXN0aWNzID0gcmVxdWlyZSgnLi4vcGFuZWxzL3BhdGllbnRDaGFyYWN0ZXJpc3RpY3MuanMnKSxcclxuICBwYXRpZW50U2VhcmNoID0gcmVxdWlyZSgnLi4vcGFuZWxzL3BhdGllbnRTZWFyY2guanMnKTtcclxuXHJcbnZhciBJRCA9IFwiUEFUSUVOVF9WSUVXXCI7XHJcbi8qXHJcbiAqIFRoZSBwYXRpZW50IHBhZ2UgY29uc2lzdHMgb2YgdGhlIHBhbmVsczpcclxuICogICBMaWZlbGluZSBjaGFydFxyXG4gKiAgIEluZGl2aWR1YWwgYWN0aW9uIHBsYW5cclxuICovXHJcblxyXG52YXIgcHYgPSB7XHJcblxyXG4gIHdpcmVVcDogZnVuY3Rpb24oKSB7XHJcblxyXG4gIH0sXHJcblxyXG4gIGNyZWF0ZTogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQsIGxvYWRDb250ZW50Rm4pIHtcclxuXHJcbiAgICBiYXNlLnNlbGVjdFRhYihcInBhdGllbnRcIik7XHJcbiAgICBiYXNlLnNob3dMb2FkaW5nKCk7XHJcblxyXG4gICAgLy91c2UgYSBzZXRUaW1lb3V0IHRvIGZvcmNlIHRoZSBVSSB0byBjaGFuZ2UgZS5nLiBzaG93IHRoZSBsb2FkaW5nLWNvbnRhaW5lclxyXG4gICAgLy9iZWZvcmUgZnVydGhlciBleGVjdXRpb25cclxuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICBkYXRhLmdldFBhdGllbnREYXRhKHBhdGllbnRJZCwgZnVuY3Rpb24ocGF0aWVudERhdGEpIHtcclxuICAgICAgICBpZiAobGF5b3V0LnZpZXcgIT09IElEKSB7XHJcbiAgICAgICAgICAvL05vdCBhbHJlYWR5IGluIHRoaXMgdmlldyBzbyB3ZSBuZWVkIHRvIHJlamlnIGEgZmV3IHRoaW5nc1xyXG4gICAgICAgICAgYmFzZS5jbGVhckJveCgpO1xyXG4gICAgICAgICAgLy9iYXNlLnN3aXRjaFRvMjFMYXlvdXQoKTtcclxuICAgICAgICAgIGxheW91dC5zaG93TWFpblZpZXcoKTtcclxuXHJcbiAgICAgICAgICBiYXNlLnJlbW92ZUZ1bGxQYWdlKGZhclJpZ2h0UGFuZWwpO1xyXG4gICAgICAgICAgYmFzZS5oaWRlUGFuZWxzKGZhclJpZ2h0UGFuZWwpO1xyXG5cclxuICAgICAgICAgIGxheW91dC52aWV3ID0gSUQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAobGF5b3V0LnBhdGh3YXlJZCAhPT0gcGF0aHdheUlkIHx8IGxheW91dC5wYXRod2F5U3RhZ2UgIT09IHBhdGh3YXlTdGFnZSB8fFxyXG4gICAgICAgICAgbGF5b3V0LnN0YW5kYXJkICE9PSBzdGFuZGFyZCB8fCBsYXlvdXQucGF0aWVudElkICE9PSBwYXRpZW50SWQpIHtcclxuICAgICAgICAgIC8vZGlmZmVyZW50IHBhdGh3YXkgb3Igc3RhZ2Ugb3IgcGF0aWVudElkIHNvIHRpdGxlIG5lZWRzIHVwZGF0aW5nXHJcbiAgICAgICAgICAkKCcjbWFpblRpdGxlJykuc2hvdygpO1xyXG5cclxuICAgICAgICAgIHZhciBwYXRpZCA9IChkYXRhLnBhdExvb2t1cCAmJiBkYXRhLnBhdExvb2t1cFtwYXRpZW50SWRdID8gZGF0YS5wYXRMb29rdXBbcGF0aWVudElkXSA6IHBhdGllbnRJZCk7XHJcbiAgICAgICAgICB2YXIgc2V4ID0gcGF0aWVudERhdGEuY2hhcmFjdGVyaXN0aWNzLnNleC50b0xvd2VyQ2FzZSgpPT09XCJtXCIgP1xyXG4gICAgICAgICAgICBcIm1hbGVcIiA6IChwYXRpZW50RGF0YS5jaGFyYWN0ZXJpc3RpY3Muc2V4LnRvTG93ZXJDYXNlKCk9PT1cImZcIiA/IFwiZmVtYWxlXCIgOiBwYXRpZW50RGF0YS5jaGFyYWN0ZXJpc3RpY3Muc2V4LnRvTG93ZXJDYXNlKCkpXHJcbiAgICAgICAgICA7XHJcbiAgICAgICAgICBiYXNlLnVwZGF0ZVRpdGxlKFwiUGF0aWVudCBcIiArIHBhdGlkICtcclxuICAgICAgICAgICAgXCIgLSBcIiArIHBhdGllbnREYXRhLmNoYXJhY3RlcmlzdGljcy5hZ2UgKyBcIiB5ZWFyIG9sZCBcIiArIHNleCk7XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgYmFzZS5oaWRlUGFuZWxzKGZhckxlZnRQYW5lbCk7XHJcblxyXG5cclxuICAgICAgICBpZiAocGF0aWVudElkKSB7XHJcbiAgICAgICAgICBiYXNlLnVwZGF0ZVRhYihcInBhdGllbnRzXCIsIGRhdGEucGF0TG9va3VwW3BhdGllbnRJZF0gfHwgcGF0aWVudElkLCBwYXRpZW50SWQpO1xyXG5cclxuICAgICAgICAgIGxheW91dC5wYXRpZW50SWQgPSBwYXRpZW50SWQ7XHJcbiAgICAgICAgICBkYXRhLnBhdGllbnRJZCA9IHBhdGllbnRJZDtcclxuICAgICAgICAgIGRhdGEucGF0aHdheUlkID0gcGF0aHdheUlkO1xyXG5cclxuICAgICAgICAgIHBhdGllbnRTZWFyY2guc2hvdygkKCcjdGl0bGUtcmlnaHQnKSwgdHJ1ZSwgbG9hZENvbnRlbnRGbik7XHJcbiAgICAgICAgICBxdWFsaXR5U3RhbmRhcmRzLnNob3coZmFyUmlnaHRQYW5lbCwgZmFsc2UsIHBhdGllbnRJZCk7XHJcblxyXG4gICAgICAgICAgbGlmZWxpbmUuc2hvdyhmYXJSaWdodFBhbmVsLCB0cnVlLCBwYXRpZW50SWQsIHBhdGllbnREYXRhKTtcclxuICAgICAgICAgIGluZGl2aWR1YWxBY3Rpb25QbGFuLnNob3coZmFyTGVmdFBhbmVsLCBwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcblxyXG4gICAgICAgICAgcGF0aWVudFNlYXJjaC53aXJlVXAoKTtcclxuICAgICAgICAgICQoJyNwYXRpZW50LXBhbmUnKS5zaG93KCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGJhc2UudXBkYXRlVGl0bGUoXCJObyBwYXRpZW50IGN1cnJlbnRseSBzZWxlY3RlZFwiKTtcclxuXHJcbiAgICAgICAgICBwYXRpZW50U2VhcmNoLnNob3coZmFyUmlnaHRQYW5lbCwgdHJ1ZSwgbG9hZENvbnRlbnRGbik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICAgICAgYmFzZS5oaWRlTG9hZGluZygpO1xyXG5cclxuICAgICAgfSk7XHJcbiAgICB9LCAwKTtcclxuXHJcbiAgfSxcclxuXHJcbiAgcG9wdWxhdGU6IGZ1bmN0aW9uKCkge1xyXG5cclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBwdjtcclxuIl19
