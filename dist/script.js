(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/*
 Highcharts JS v4.2.4 (2016-04-14)

 (c) 2009-2016 Torstein Honsi

 License: www.highcharts.com/license
*/
(function(m){typeof module==="object"&&module.exports?module.exports=m:m(Highcharts)})(function(m){function L(a,b,c){this.init(a,b,c)}var Q=m.arrayMin,R=m.arrayMax,t=m.each,H=m.extend,u=m.merge,S=m.map,o=m.pick,B=m.pInt,G=m.correctFloat,p=m.getOptions().plotOptions,i=m.seriesTypes,v=m.extendClass,M=m.splat,w=m.wrap,N=m.Axis,z=m.Tick,I=m.Point,T=m.Pointer,U=m.CenteredSeriesMixin,C=m.TrackerMixin,x=m.Series,y=Math,F=y.round,D=y.floor,O=y.max,V=m.Color,r=function(){};H(L.prototype,{init:function(a,b,
c){var d=this,g=d.defaultOptions;d.chart=b;d.options=a=u(g,b.angular?{background:{}}:void 0,a);(a=a.background)&&t([].concat(M(a)).reverse(),function(a){var b=a.backgroundColor,g=c.userOptions,a=u(d.defaultBackgroundOptions,a);if(b)a.backgroundColor=b;a.color=a.backgroundColor;c.options.plotBands.unshift(a);g.plotBands=g.plotBands||[];g.plotBands!==c.options.plotBands&&g.plotBands.unshift(a)})},defaultOptions:{center:["50%","50%"],size:"85%",startAngle:0},defaultBackgroundOptions:{shape:"circle",
borderWidth:1,borderColor:"silver",backgroundColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,"#FFF"],[1,"#DDD"]]},from:-Number.MAX_VALUE,innerRadius:0,to:Number.MAX_VALUE,outerRadius:"105%"}});var A=N.prototype,z=z.prototype,W={getOffset:r,redraw:function(){this.isDirty=!1},render:function(){this.isDirty=!1},setScale:r,setCategories:r,setTitle:r},P={isRadial:!0,defaultRadialGaugeOptions:{labels:{align:"center",x:0,y:null},minorGridLineWidth:0,minorTickInterval:"auto",minorTickLength:10,minorTickPosition:"inside",
minorTickWidth:1,tickLength:10,tickPosition:"inside",tickWidth:2,title:{rotation:0},zIndex:2},defaultRadialXOptions:{gridLineWidth:1,labels:{align:null,distance:15,x:0,y:null},maxPadding:0,minPadding:0,showLastLabel:!1,tickLength:0},defaultRadialYOptions:{gridLineInterpolation:"circle",labels:{align:"right",x:-3,y:-2},showLastLabel:!1,title:{x:4,text:null,rotation:90}},setOptions:function(a){a=this.options=u(this.defaultOptions,this.defaultRadialOptions,a);if(!a.plotBands)a.plotBands=[]},getOffset:function(){A.getOffset.call(this);
this.chart.axisOffset[this.side]=0;this.center=this.pane.center=U.getCenter.call(this.pane)},getLinePath:function(a,b){var c=this.center,b=o(b,c[2]/2-this.offset);return this.chart.renderer.symbols.arc(this.left+c[0],this.top+c[1],b,b,{start:this.startAngleRad,end:this.endAngleRad,open:!0,innerR:0})},setAxisTranslation:function(){A.setAxisTranslation.call(this);if(this.center)this.transA=this.isCircular?(this.endAngleRad-this.startAngleRad)/(this.max-this.min||1):this.center[2]/2/(this.max-this.min||
1),this.minPixelPadding=this.isXAxis?this.transA*this.minPointOffset:0},beforeSetTickPositions:function(){this.autoConnect&&(this.max+=this.categories&&1||this.pointRange||this.closestPointRange||0)},setAxisSize:function(){A.setAxisSize.call(this);if(this.isRadial){this.center=this.pane.center=m.CenteredSeriesMixin.getCenter.call(this.pane);if(this.isCircular)this.sector=this.endAngleRad-this.startAngleRad;this.len=this.width=this.height=this.center[2]*o(this.sector,1)/2}},getPosition:function(a,
b){return this.postTranslate(this.isCircular?this.translate(a):0,o(this.isCircular?b:this.translate(a),this.center[2]/2)-this.offset)},postTranslate:function(a,b){var c=this.chart,d=this.center,a=this.startAngleRad+a;return{x:c.plotLeft+d[0]+Math.cos(a)*b,y:c.plotTop+d[1]+Math.sin(a)*b}},getPlotBandPath:function(a,b,c){var d=this.center,g=this.startAngleRad,e=d[2]/2,j=[o(c.outerRadius,"100%"),c.innerRadius,o(c.thickness,10)],l=/%$/,h,f=this.isCircular;this.options.gridLineInterpolation==="polygon"?
d=this.getPlotLinePath(a).concat(this.getPlotLinePath(b,!0)):(a=Math.max(a,this.min),b=Math.min(b,this.max),f||(j[0]=this.translate(a),j[1]=this.translate(b)),j=S(j,function(a){l.test(a)&&(a=B(a,10)*e/100);return a}),c.shape==="circle"||!f?(a=-Math.PI/2,b=Math.PI*1.5,h=!0):(a=g+this.translate(a),b=g+this.translate(b)),d=this.chart.renderer.symbols.arc(this.left+d[0],this.top+d[1],j[0],j[0],{start:Math.min(a,b),end:Math.max(a,b),innerR:o(j[1],j[0]-j[2]),open:h}));return d},getPlotLinePath:function(a,
b){var c=this,d=c.center,g=c.chart,e=c.getPosition(a),j,l,h;c.isCircular?h=["M",d[0]+g.plotLeft,d[1]+g.plotTop,"L",e.x,e.y]:c.options.gridLineInterpolation==="circle"?(a=c.translate(a))&&(h=c.getLinePath(0,a)):(t(g.xAxis,function(a){a.pane===c.pane&&(j=a)}),h=[],a=c.translate(a),d=j.tickPositions,j.autoConnect&&(d=d.concat([d[0]])),b&&(d=[].concat(d).reverse()),t(d,function(e,b){l=j.getPosition(e,a);h.push(b?"L":"M",l.x,l.y)}));return h},getTitlePosition:function(){var a=this.center,b=this.chart,
c=this.options.title;return{x:b.plotLeft+a[0]+(c.x||0),y:b.plotTop+a[1]-{high:0.5,middle:0.25,low:0}[c.align]*a[2]+(c.y||0)}}};w(A,"init",function(a,b,c){var k;var d=b.angular,g=b.polar,e=c.isX,j=d&&e,l,h;h=b.options;var f=c.pane||0;if(d){if(H(this,j?W:P),l=!e)this.defaultRadialOptions=this.defaultRadialGaugeOptions}else if(g)H(this,P),this.defaultRadialOptions=(l=e)?this.defaultRadialXOptions:u(this.defaultYAxisOptions,this.defaultRadialYOptions);a.call(this,b,c);if(!j&&(d||g)){a=this.options;if(!b.panes)b.panes=
[];this.pane=(k=b.panes[f]=b.panes[f]||new L(M(h.pane)[f],b,this),f=k);f=f.options;b.inverted=!1;h.chart.zoomType=null;this.startAngleRad=b=(f.startAngle-90)*Math.PI/180;this.endAngleRad=h=(o(f.endAngle,f.startAngle+360)-90)*Math.PI/180;this.offset=a.offset||0;if((this.isCircular=l)&&c.max===void 0&&h-b===2*Math.PI)this.autoConnect=!0}});w(A,"autoLabelAlign",function(a){if(!this.isRadial)return a.apply(this,[].slice.call(arguments,1))});w(z,"getPosition",function(a,b,c,d,g){var e=this.axis;return e.getPosition?
e.getPosition(c):a.call(this,b,c,d,g)});w(z,"getLabelPosition",function(a,b,c,d,g,e,j,l,h){var f=this.axis,k=e.y,n=20,s=e.align,i=(f.translate(this.pos)+f.startAngleRad+Math.PI/2)/Math.PI*180%360;f.isRadial?(a=f.getPosition(this.pos,f.center[2]/2+o(e.distance,-25)),e.rotation==="auto"?d.attr({rotation:i}):k===null&&(k=f.chart.renderer.fontMetrics(d.styles.fontSize).b-d.getBBox().height/2),s===null&&(f.isCircular?(this.label.getBBox().width>f.len*f.tickInterval/(f.max-f.min)&&(n=0),s=i>n&&i<180-n?
"left":i>180+n&&i<360-n?"right":"center"):s="center",d.attr({align:s})),a.x+=e.x,a.y+=k):a=a.call(this,b,c,d,g,e,j,l,h);return a});w(z,"getMarkPath",function(a,b,c,d,g,e,j){var l=this.axis;l.isRadial?(a=l.getPosition(this.pos,l.center[2]/2+d),b=["M",b,c,"L",a.x,a.y]):b=a.call(this,b,c,d,g,e,j);return b});p.arearange=u(p.area,{lineWidth:1,marker:null,threshold:null,tooltip:{pointFormat:'<span style="color:{series.color}">\u25cf</span> {series.name}: <b>{point.low}</b> - <b>{point.high}</b><br/>'},
trackByArea:!0,dataLabels:{align:null,verticalAlign:null,xLow:0,xHigh:0,yLow:0,yHigh:0},states:{hover:{halo:!1}}});i.arearange=v(i.area,{type:"arearange",pointArrayMap:["low","high"],dataLabelCollections:["dataLabel","dataLabelUpper"],toYData:function(a){return[a.low,a.high]},pointValKey:"low",deferTranslatePolar:!0,highToXY:function(a){var b=this.chart,c=this.xAxis.postTranslate(a.rectPlotX,this.yAxis.len-a.plotHigh);a.plotHighX=c.x-b.plotLeft;a.plotHigh=c.y-b.plotTop},translate:function(){var a=
this,b=a.yAxis;i.area.prototype.translate.apply(a);t(a.points,function(a){var d=a.low,g=a.high,e=a.plotY;g===null||d===null?a.isNull=!0:(a.plotLow=e,a.plotHigh=b.translate(g,0,1,0,1))});this.chart.polar&&t(this.points,function(b){a.highToXY(b)})},getGraphPath:function(){var a=this.points,b=[],c=[],d=a.length,g=x.prototype.getGraphPath,e,j,l;l=this.options;for(var h=l.step,d=a.length;d--;)e=a[d],!e.isNull&&(!a[d+1]||a[d+1].isNull)&&c.push({plotX:e.plotX,plotY:e.plotLow}),j={plotX:e.plotX,plotY:e.plotHigh,
isNull:e.isNull},c.push(j),b.push(j),!e.isNull&&(!a[d-1]||a[d-1].isNull)&&c.push({plotX:e.plotX,plotY:e.plotLow});a=g.call(this,a);if(h)h===!0&&(h="left"),l.step={left:"right",center:"center",right:"left"}[h];b=g.call(this,b);c=g.call(this,c);l.step=h;l=[].concat(a,b);!this.chart.polar&&c[0]==="M"&&(c[0]="L");this.areaPath=this.areaPath.concat(a,c);return l},drawDataLabels:function(){var a=this.data,b=a.length,c,d=[],g=x.prototype,e=this.options.dataLabels,j=e.align,l=e.verticalAlign,h=e.inside,f,
k,n=this.chart.inverted;if(e.enabled||this._hasPointLabels){for(c=b;c--;)if(f=a[c]){k=h?f.plotHigh<f.plotLow:f.plotHigh>f.plotLow;f.y=f.high;f._plotY=f.plotY;f.plotY=f.plotHigh;d[c]=f.dataLabel;f.dataLabel=f.dataLabelUpper;f.below=k;if(n){if(!j)e.align=k?"right":"left"}else if(!l)e.verticalAlign=k?"top":"bottom";e.x=e.xHigh;e.y=e.yHigh}g.drawDataLabels&&g.drawDataLabels.apply(this,arguments);for(c=b;c--;)if(f=a[c]){k=h?f.plotHigh<f.plotLow:f.plotHigh>f.plotLow;f.dataLabelUpper=f.dataLabel;f.dataLabel=
d[c];f.y=f.low;f.plotY=f._plotY;f.below=!k;if(n){if(!j)e.align=k?"left":"right"}else if(!l)e.verticalAlign=k?"bottom":"top";e.x=e.xLow;e.y=e.yLow}g.drawDataLabels&&g.drawDataLabels.apply(this,arguments)}e.align=j;e.verticalAlign=l},alignDataLabel:function(){i.column.prototype.alignDataLabel.apply(this,arguments)},setStackedPoints:r,getSymbol:r,drawPoints:r});p.areasplinerange=u(p.arearange);i.areasplinerange=v(i.arearange,{type:"areasplinerange",getPointSpline:i.spline.prototype.getPointSpline});
(function(){var a=i.column.prototype;p.columnrange=u(p.column,p.arearange,{lineWidth:1,pointRange:null});i.columnrange=v(i.arearange,{type:"columnrange",translate:function(){var b=this,c=b.yAxis,d=b.xAxis,g=d.startAngleRad,e,j=b.chart,l=b.xAxis.isRadial,h;a.translate.apply(b);t(b.points,function(a){var k=a.shapeArgs,n=b.options.minPointLength,s,i;a.plotHigh=h=c.translate(a.high,0,1,0,1);a.plotLow=a.plotY;i=h;s=o(a.rectPlotY,a.plotY)-h;Math.abs(s)<n?(n-=s,s+=n,i-=n/2):s<0&&(s*=-1,i-=s);l?(e=a.barX+
g,a.shapeType="path",a.shapeArgs={d:b.polarArc(i+s,i,e,e+a.pointWidth)}):(k.height=s,k.y=i,a.tooltipPos=j.inverted?[c.len+c.pos-j.plotLeft-i-s/2,d.len+d.pos-j.plotTop-k.x-k.width/2,s]:[d.left-j.plotLeft+k.x+k.width/2,c.pos-j.plotTop+i+s/2,s])})},directTouch:!0,trackerGroups:["group","dataLabelsGroup"],drawGraph:r,crispCol:a.crispCol,pointAttrToOptions:a.pointAttrToOptions,drawPoints:a.drawPoints,drawTracker:a.drawTracker,getColumnMetrics:a.getColumnMetrics,animate:function(){return a.animate.apply(this,
arguments)},polarArc:function(){return a.polarArc.apply(this,arguments)}})})();p.gauge=u(p.line,{dataLabels:{enabled:!0,defer:!1,y:15,borderWidth:1,borderColor:"silver",borderRadius:3,crop:!1,verticalAlign:"top",zIndex:2},dial:{},pivot:{},tooltip:{headerFormat:""},showInLegend:!1});C={type:"gauge",pointClass:v(I,{setState:function(a){this.state=a}}),angular:!0,directTouch:!0,drawGraph:r,fixedBox:!0,forceDL:!0,trackerGroups:["group","dataLabelsGroup"],translate:function(){var a=this.yAxis,b=this.options,
c=a.center;this.generatePoints();t(this.points,function(d){var g=u(b.dial,d.dial),e=B(o(g.radius,80))*c[2]/200,j=B(o(g.baseLength,70))*e/100,l=B(o(g.rearLength,10))*e/100,h=g.baseWidth||3,f=g.topWidth||1,k=b.overshoot,n=a.startAngleRad+a.translate(d.y,null,null,null,!0);k&&typeof k==="number"?(k=k/180*Math.PI,n=Math.max(a.startAngleRad-k,Math.min(a.endAngleRad+k,n))):b.wrap===!1&&(n=Math.max(a.startAngleRad,Math.min(a.endAngleRad,n)));n=n*180/Math.PI;d.shapeType="path";d.shapeArgs={d:g.path||["M",
-l,-h/2,"L",j,-h/2,e,-f/2,e,f/2,j,h/2,-l,h/2,"z"],translateX:c[0],translateY:c[1],rotation:n};d.plotX=c[0];d.plotY=c[1]})},drawPoints:function(){var a=this,b=a.yAxis.center,c=a.pivot,d=a.options,g=d.pivot,e=a.chart.renderer;t(a.points,function(b){var g=b.graphic,c=b.shapeArgs,f=c.d,k=u(d.dial,b.dial);g?(g.animate(c),c.d=f):b.graphic=e[b.shapeType](c).attr({stroke:k.borderColor||"none","stroke-width":k.borderWidth||0,fill:k.backgroundColor||"black",rotation:c.rotation,zIndex:1}).add(a.group)});c?c.animate({translateX:b[0],
translateY:b[1]}):a.pivot=e.circle(0,0,o(g.radius,5)).attr({"stroke-width":g.borderWidth||0,stroke:g.borderColor||"silver",fill:g.backgroundColor||"black",zIndex:2}).translate(b[0],b[1]).add(a.group)},animate:function(a){var b=this;if(!a)t(b.points,function(a){var d=a.graphic;d&&(d.attr({rotation:b.yAxis.startAngleRad*180/Math.PI}),d.animate({rotation:a.shapeArgs.rotation},b.options.animation))}),b.animate=null},render:function(){this.group=this.plotGroup("group","series",this.visible?"visible":"hidden",
this.options.zIndex,this.chart.seriesGroup);x.prototype.render.call(this);this.group.clip(this.chart.clipRect)},setData:function(a,b){x.prototype.setData.call(this,a,!1);this.processData();this.generatePoints();o(b,!0)&&this.chart.redraw()},drawTracker:C&&C.drawTrackerPoint};i.gauge=v(i.line,C);p.boxplot=u(p.column,{fillColor:"#FFFFFF",lineWidth:1,medianWidth:2,states:{hover:{brightness:-0.3}},threshold:null,tooltip:{pointFormat:'<span style="color:{point.color}">\u25cf</span> <b> {series.name}</b><br/>Maximum: {point.high}<br/>Upper quartile: {point.q3}<br/>Median: {point.median}<br/>Lower quartile: {point.q1}<br/>Minimum: {point.low}<br/>'},
whiskerLength:"50%",whiskerWidth:2});i.boxplot=v(i.column,{type:"boxplot",pointArrayMap:["low","q1","median","q3","high"],toYData:function(a){return[a.low,a.q1,a.median,a.q3,a.high]},pointValKey:"high",pointAttrToOptions:{fill:"fillColor",stroke:"color","stroke-width":"lineWidth"},drawDataLabels:r,translate:function(){var a=this.yAxis,b=this.pointArrayMap;i.column.prototype.translate.apply(this);t(this.points,function(c){t(b,function(b){c[b]!==null&&(c[b+"Plot"]=a.translate(c[b],0,1,0,1))})})},drawPoints:function(){var a=
this,b=a.options,c=a.chart.renderer,d,g,e,j,l,h,f,k,n,i,m,J,K,p,u,r,w,v,x,y,C,B,z=a.doQuartiles!==!1,A,E=a.options.whiskerLength;t(a.points,function(q){n=q.graphic;C=q.shapeArgs;m={};p={};r={};B=q.color||a.color;if(q.plotY!==void 0)if(d=q.pointAttr[q.selected?"selected":""],w=C.width,v=D(C.x),x=v+w,y=F(w/2),g=D(z?q.q1Plot:q.lowPlot),e=D(z?q.q3Plot:q.lowPlot),j=D(q.highPlot),l=D(q.lowPlot),m.stroke=q.stemColor||b.stemColor||B,m["stroke-width"]=o(q.stemWidth,b.stemWidth,b.lineWidth),m.dashstyle=q.stemDashStyle||
b.stemDashStyle,p.stroke=q.whiskerColor||b.whiskerColor||B,p["stroke-width"]=o(q.whiskerWidth,b.whiskerWidth,b.lineWidth),r.stroke=q.medianColor||b.medianColor||B,r["stroke-width"]=o(q.medianWidth,b.medianWidth,b.lineWidth),f=m["stroke-width"]%2/2,k=v+y+f,i=["M",k,e,"L",k,j,"M",k,g,"L",k,l],z&&(f=d["stroke-width"]%2/2,k=D(k)+f,g=D(g)+f,e=D(e)+f,v+=f,x+=f,J=["M",v,e,"L",v,g,"L",x,g,"L",x,e,"L",v,e,"z"]),E&&(f=p["stroke-width"]%2/2,j+=f,l+=f,A=/%$/.test(E)?y*parseFloat(E)/100:E/2,K=["M",k-A,j,"L",k+
A,j,"M",k-A,l,"L",k+A,l]),f=r["stroke-width"]%2/2,h=F(q.medianPlot)+f,u=["M",v,h,"L",x,h],n)q.stem.animate({d:i}),E&&q.whiskers.animate({d:K}),z&&q.box.animate({d:J}),q.medianShape.animate({d:u});else{q.graphic=n=c.g().add(a.group);q.stem=c.path(i).attr(m).add(n);if(E)q.whiskers=c.path(K).attr(p).add(n);if(z)q.box=c.path(J).attr(d).add(n);q.medianShape=c.path(u).attr(r).add(n)}})},setStackedPoints:r});p.errorbar=u(p.boxplot,{color:"#000000",grouping:!1,linkedTo:":previous",tooltip:{pointFormat:'<span style="color:{point.color}">\u25cf</span> {series.name}: <b>{point.low}</b> - <b>{point.high}</b><br/>'},
whiskerWidth:null});i.errorbar=v(i.boxplot,{type:"errorbar",pointArrayMap:["low","high"],toYData:function(a){return[a.low,a.high]},pointValKey:"high",doQuartiles:!1,drawDataLabels:i.arearange?i.arearange.prototype.drawDataLabels:r,getColumnMetrics:function(){return this.linkedParent&&this.linkedParent.columnMetrics||i.column.prototype.getColumnMetrics.call(this)}});p.waterfall=u(p.column,{lineWidth:1,lineColor:"#333",dashStyle:"dot",borderColor:"#333",dataLabels:{inside:!0},states:{hover:{lineWidthPlus:0}}});
i.waterfall=v(i.column,{type:"waterfall",upColorProp:"fill",pointValKey:"y",translate:function(){var a=this.options,b=this.yAxis,c,d,g,e,j,l,h,f,k,n=o(a.minPointLength,5),s=a.threshold,m=a.stacking;i.column.prototype.translate.apply(this);this.minPointLengthOffset=0;h=f=s;d=this.points;for(c=0,a=d.length;c<a;c++){g=d[c];l=this.processedYData[c];e=g.shapeArgs;k=(j=m&&b.stacks[(this.negStacks&&l<s?"-":"")+this.stackKey])?j[g.x].points[this.index+","+c]:[0,l];if(g.isSum)g.y=G(l);else if(g.isIntermediateSum)g.y=
G(l-f);j=O(h,h+g.y)+k[0];e.y=b.translate(j,0,1);if(g.isSum)e.y=b.translate(k[1],0,1),e.height=Math.min(b.translate(k[0],0,1),b.len)-e.y+this.minPointLengthOffset;else if(g.isIntermediateSum)e.y=b.translate(k[1],0,1),e.height=Math.min(b.translate(f,0,1),b.len)-e.y+this.minPointLengthOffset,f=k[1];else{if(h!==0)e.height=l>0?b.translate(h,0,1)-e.y:b.translate(h,0,1)-b.translate(h-l,0,1);h+=l}e.height<0&&(e.y+=e.height,e.height*=-1);g.plotY=e.y=F(e.y)-this.borderWidth%2/2;e.height=O(F(e.height),0.001);
g.yBottom=e.y+e.height;if(e.height<=n)e.height=n,this.minPointLengthOffset+=n;e.y-=this.minPointLengthOffset;e=g.plotY+(g.negative?e.height:0)-this.minPointLengthOffset;this.chart.inverted?g.tooltipPos[0]=b.len-e:g.tooltipPos[1]=e}},processData:function(a){var b=this.yData,c=this.options.data,d,g=b.length,e,j,l,h,f,k;j=e=l=h=this.options.threshold||0;for(k=0;k<g;k++)f=b[k],d=c&&c[k]?c[k]:{},f==="sum"||d.isSum?b[k]=G(j):f==="intermediateSum"||d.isIntermediateSum?b[k]=G(e):(j+=f,e+=f),l=Math.min(j,
l),h=Math.max(j,h);x.prototype.processData.call(this,a);this.dataMin=l;this.dataMax=h},toYData:function(a){return a.isSum?a.x===0?null:"sum":a.isIntermediateSum?a.x===0?null:"intermediateSum":a.y},getAttribs:function(){i.column.prototype.getAttribs.apply(this,arguments);var a=this,b=a.options,c=b.states,d=b.upColor||a.color,b=m.Color(d).brighten(0.1).get(),g=u(a.pointAttr),e=a.upColorProp;g[""][e]=d;g.hover[e]=c.hover.upColor||b;g.select[e]=c.select.upColor||d;t(a.points,function(e){if(!e.options.color)e.y>
0?(e.pointAttr=g,e.color=d):e.pointAttr=a.pointAttr})},getGraphPath:function(){var a=this.data,b=a.length,c=F(this.options.lineWidth+this.borderWidth)%2/2,d=[],g,e,j;for(j=1;j<b;j++)e=a[j].shapeArgs,g=a[j-1].shapeArgs,e=["M",g.x+g.width,g.y+c,"L",e.x,g.y+c],a[j-1].y<0&&(e[2]+=g.height,e[5]+=g.height),d=d.concat(e);return d},getExtremes:r,drawGraph:x.prototype.drawGraph});p.polygon=u(p.scatter,{marker:{enabled:!1}});i.polygon=v(i.scatter,{type:"polygon",fillGraph:!0,getSegmentPath:function(a){return x.prototype.getSegmentPath.call(this,
a).concat("z")},drawGraph:x.prototype.drawGraph,drawLegendSymbol:m.LegendSymbolMixin.drawRectangle});p.bubble=u(p.scatter,{dataLabels:{formatter:function(){return this.point.z},inside:!0,verticalAlign:"middle"},marker:{lineColor:null,lineWidth:1},minSize:8,maxSize:"20%",softThreshold:!1,states:{hover:{halo:{size:5}}},tooltip:{pointFormat:"({point.x}, {point.y}), Size: {point.z}"},turboThreshold:0,zThreshold:0,zoneAxis:"z"});C=v(I,{haloPath:function(){return I.prototype.haloPath.call(this,this.shapeArgs.r+
this.series.options.states.hover.halo.size)},ttBelow:!1});i.bubble=v(i.scatter,{type:"bubble",pointClass:C,pointArrayMap:["y","z"],parallelArrays:["x","y","z"],trackerGroups:["group","dataLabelsGroup"],bubblePadding:!0,zoneAxis:"z",pointAttrToOptions:{stroke:"lineColor","stroke-width":"lineWidth",fill:"fillColor"},applyOpacity:function(a){var b=this.options.marker,c=o(b.fillOpacity,0.5),a=a||b.fillColor||this.color;c!==1&&(a=V(a).setOpacity(c).get("rgba"));return a},convertAttribs:function(){var a=
x.prototype.convertAttribs.apply(this,arguments);a.fill=this.applyOpacity(a.fill);return a},getRadii:function(a,b,c,d){var g,e,j,l=this.zData,h=[],f=this.options,k=f.sizeBy!=="width",n=f.zThreshold,i=b-a;for(e=0,g=l.length;e<g;e++)j=l[e],f.sizeByAbsoluteValue&&j!==null&&(j=Math.abs(j-n),b=Math.max(b-n,Math.abs(a-n)),a=0),j===null?j=null:j<a?j=c/2-1:(j=i>0?(j-a)/i:0.5,k&&j>=0&&(j=Math.sqrt(j)),j=y.ceil(c+j*(d-c))/2),h.push(j);this.radii=h},animate:function(a){var b=this.options.animation;if(!a)t(this.points,
function(a){var d=a.graphic,a=a.shapeArgs;d&&a&&(d.attr("r",1),d.animate({r:a.r},b))}),this.animate=null},translate:function(){var a,b=this.data,c,d,g=this.radii;i.scatter.prototype.translate.call(this);for(a=b.length;a--;)c=b[a],d=g?g[a]:0,typeof d==="number"&&d>=this.minPxSize/2?(c.shapeType="circle",c.shapeArgs={x:c.plotX,y:c.plotY,r:d},c.dlBox={x:c.plotX-d,y:c.plotY-d,width:2*d,height:2*d}):c.shapeArgs=c.plotY=c.dlBox=void 0},drawLegendSymbol:function(a,b){var c=this.chart.renderer,d=c.fontMetrics(a.itemStyle.fontSize).f/
2;b.legendSymbol=c.circle(d,a.baseline-d,d).attr({zIndex:3}).add(b.legendGroup);b.legendSymbol.isMarker=!0},drawPoints:i.column.prototype.drawPoints,alignDataLabel:i.column.prototype.alignDataLabel,buildKDTree:r,applyZones:r});N.prototype.beforePadding=function(){var a=this,b=this.len,c=this.chart,d=0,g=b,e=this.isXAxis,j=e?"xData":"yData",l=this.min,h={},f=y.min(c.plotWidth,c.plotHeight),k=Number.MAX_VALUE,n=-Number.MAX_VALUE,i=this.max-l,m=b/i,p=[];t(this.series,function(b){var g=b.options;if(b.bubblePadding&&
(b.visible||!c.options.chart.ignoreHiddenSeries))if(a.allowZoomOutside=!0,p.push(b),e)t(["minSize","maxSize"],function(a){var b=g[a],e=/%$/.test(b),b=B(b);h[a]=e?f*b/100:b}),b.minPxSize=h.minSize,b.maxPxSize=h.maxSize,b=b.zData,b.length&&(k=o(g.zMin,y.min(k,y.max(Q(b),g.displayNegative===!1?g.zThreshold:-Number.MAX_VALUE))),n=o(g.zMax,y.max(n,R(b))))});t(p,function(b){var c=b[j],f=c.length,h;e&&b.getRadii(k,n,b.minPxSize,b.maxPxSize);if(i>0)for(;f--;)typeof c[f]==="number"&&a.dataMin<=c[f]&&c[f]<=
a.dataMax&&(h=b.radii[f],d=Math.min((c[f]-l)*m-h,d),g=Math.max((c[f]-l)*m+h,g))});p.length&&i>0&&!this.isLog&&(g-=b,m*=(b+d-g)/b,t([["min","userMin",d],["max","userMax",g]],function(b){o(a.options[b[0]],a[b[1]])===void 0&&(a[b[0]]+=b[2]/m)}))};(function(){function a(a,b){var c=this.chart,d=this.options.animation,h=this.group,f=this.markerGroup,k=this.xAxis.center,i=c.plotLeft,m=c.plotTop;if(c.polar){if(c.renderer.isSVG)d===!0&&(d={}),b?(c={translateX:k[0]+i,translateY:k[1]+m,scaleX:0.001,scaleY:0.001},
h.attr(c),f&&f.attr(c)):(c={translateX:i,translateY:m,scaleX:1,scaleY:1},h.animate(c,d),f&&f.animate(c,d),this.animate=null)}else a.call(this,b)}var b=x.prototype,c=T.prototype,d;b.searchPointByAngle=function(a){var b=this.chart,c=this.xAxis.pane.center;return this.searchKDTree({clientX:180+Math.atan2(a.chartX-c[0]-b.plotLeft,a.chartY-c[1]-b.plotTop)*(-180/Math.PI)})};w(b,"buildKDTree",function(a){if(this.chart.polar)this.kdByAngle?this.searchPoint=this.searchPointByAngle:this.kdDimensions=2;a.apply(this)});
b.toXY=function(a){var b,c=this.chart,d=a.plotX;b=a.plotY;a.rectPlotX=d;a.rectPlotY=b;b=this.xAxis.postTranslate(a.plotX,this.yAxis.len-b);a.plotX=a.polarPlotX=b.x-c.plotLeft;a.plotY=a.polarPlotY=b.y-c.plotTop;this.kdByAngle?(c=(d/Math.PI*180+this.xAxis.pane.options.startAngle)%360,c<0&&(c+=360),a.clientX=c):a.clientX=a.plotX};i.spline&&w(i.spline.prototype,"getPointSpline",function(a,b,c,d){var h,f,k,i,m,p,o;if(this.chart.polar){h=c.plotX;f=c.plotY;a=b[d-1];k=b[d+1];this.connectEnds&&(a||(a=b[b.length-
2]),k||(k=b[1]));if(a&&k)i=a.plotX,m=a.plotY,b=k.plotX,p=k.plotY,i=(1.5*h+i)/2.5,m=(1.5*f+m)/2.5,k=(1.5*h+b)/2.5,o=(1.5*f+p)/2.5,b=Math.sqrt(Math.pow(i-h,2)+Math.pow(m-f,2)),p=Math.sqrt(Math.pow(k-h,2)+Math.pow(o-f,2)),i=Math.atan2(m-f,i-h),m=Math.atan2(o-f,k-h),o=Math.PI/2+(i+m)/2,Math.abs(i-o)>Math.PI/2&&(o-=Math.PI),i=h+Math.cos(o)*b,m=f+Math.sin(o)*b,k=h+Math.cos(Math.PI+o)*p,o=f+Math.sin(Math.PI+o)*p,c.rightContX=k,c.rightContY=o;d?(c=["C",a.rightContX||a.plotX,a.rightContY||a.plotY,i||h,m||
f,h,f],a.rightContX=a.rightContY=null):c=["M",h,f]}else c=a.call(this,b,c,d);return c});w(b,"translate",function(a){var b=this.chart;a.call(this);if(b.polar&&(this.kdByAngle=b.tooltip&&b.tooltip.shared,!this.preventPostTranslate)){a=this.points;for(b=a.length;b--;)this.toXY(a[b])}});w(b,"getGraphPath",function(a,b){var c=this;if(this.chart.polar){b=b||this.points;if(this.options.connectEnds!==!1&&b[0].y!==null)this.connectEnds=!0,b.splice(b.length,0,b[0]);t(b,function(a){a.polarPlotY===void 0&&c.toXY(a)})}return a.apply(this,
[].slice.call(arguments,1))});w(b,"animate",a);if(i.column)d=i.column.prototype,d.polarArc=function(a,b,c,d){var h=this.xAxis.center,f=this.yAxis.len;return this.chart.renderer.symbols.arc(h[0],h[1],f-b,null,{start:c,end:d,innerR:f-o(a,f)})},w(d,"animate",a),w(d,"translate",function(a){var b=this.xAxis,c=b.startAngleRad,d,h,f;this.preventPostTranslate=!0;a.call(this);if(b.isRadial){d=this.points;for(f=d.length;f--;)h=d[f],a=h.barX+c,h.shapeType="path",h.shapeArgs=this.polarArc(h.yBottom,h.plotY,a,
a+h.pointWidth),this.toXY(h),h.tooltipPos=[h.plotX,h.plotY],h.ttBelow=h.plotY>b.center[1]}}),w(d,"alignDataLabel",function(a,c,d,i,h,f){if(this.chart.polar){a=c.rectPlotX/Math.PI*180;if(i.align===null)i.align=a>20&&a<160?"left":a>200&&a<340?"right":"center";if(i.verticalAlign===null)i.verticalAlign=a<45||a>315?"bottom":a>135&&a<225?"top":"middle";b.alignDataLabel.call(this,c,d,i,h,f)}else a.call(this,c,d,i,h,f)});w(c,"getCoordinates",function(a,b){var c=this.chart,d={xAxis:[],yAxis:[]};c.polar?t(c.axes,
function(a){var f=a.isXAxis,g=a.center,i=b.chartX-g[0]-c.plotLeft,g=b.chartY-g[1]-c.plotTop;d[f?"xAxis":"yAxis"].push({axis:a,value:a.translate(f?Math.PI-Math.atan2(i,g):Math.sqrt(Math.pow(i,2)+Math.pow(g,2)),!0)})}):d=a.call(this,b);return d})})()});

},{}],2:[function(require,module,exports){
/*
 Highstock JS v4.2.4 (2016-04-14)

 (c) 2009-2016 Torstein Honsi

 License: www.highcharts.com/license
*/
(function(J,ga){typeof module==="object"&&module.exports?module.exports=J.document?ga(J):ga:J.Highcharts=ga(J)})(typeof window!=="undefined"?window:this,function(J){function ga(a,b){var c="Highcharts error #"+a+": www.highcharts.com/errors/"+a;if(b)throw Error(c);J.console&&console.log(c)}function yb(a,b,c){this.options=b;this.elem=a;this.prop=c}function C(){var a,b=arguments,c,d={},e=function(a,b){var c,d;typeof a!=="object"&&(a={});for(d in b)b.hasOwnProperty(d)&&(c=b[d],a[d]=c&&typeof c==="object"&&
Object.prototype.toString.call(c)!=="[object Array]"&&d!=="renderTo"&&typeof c.nodeType!=="number"?e(a[d]||{},c):b[d]);return a};b[0]===!0&&(d=b[1],b=Array.prototype.slice.call(b,2));c=b.length;for(a=0;a<c;a++)d=e(d,b[a]);return d}function G(a,b){return parseInt(a,b||10)}function Da(a){return typeof a==="string"}function da(a){return a&&typeof a==="object"}function Ja(a){return Object.prototype.toString.call(a)==="[object Array]"}function ua(a){return typeof a==="number"}function Aa(a,b){for(var c=
a.length;c--;)if(a[c]===b){a.splice(c,1);break}}function s(a){return a!==t&&a!==null}function X(a,b,c){var d,e;if(Da(b))s(c)?a.setAttribute(b,c):a&&a.getAttribute&&(e=a.getAttribute(b));else if(s(b)&&da(b))for(d in b)a.setAttribute(d,b[d]);return e}function va(a){return Ja(a)?a:[a]}function $a(a,b,c){if(b)return setTimeout(a,b,c);a.call(0,c)}function F(a,b){if(Ka&&!ja&&b&&b.opacity!==t)b.filter="alpha(opacity="+b.opacity*100+")";x(a.style,b)}function ea(a,b,c,d,e){a=B.createElement(a);b&&x(a,b);e&&
F(a,{padding:0,border:"none",margin:0});c&&F(a,c);d&&d.appendChild(a);return a}function la(a,b){var c=function(){};c.prototype=new a;x(c.prototype,b);return c}function Na(a,b,c){return Array((b||2)+1-String(a).length).join(c||0)+a}function fb(a){return(gb&&gb(a)||zb||0)*6E4}function La(a,b){for(var c="{",d=!1,e,f,g,h,i,j=[];(c=a.indexOf(c))!==-1;){e=a.slice(0,c);if(d){f=e.split(":");g=f.shift().split(".");i=g.length;e=b;for(h=0;h<i;h++)e=e[g[h]];if(f.length)f=f.join(":"),g=/\.([0-9])/,h=N.lang,i=
void 0,/f$/.test(f)?(i=(i=f.match(g))?i[1]:-1,e!==null&&(e=z.numberFormat(e,i,h.decimalPoint,f.indexOf(",")>-1?h.thousandsSep:""))):e=ma(f,e)}j.push(e);a=a.slice(c+1);c=(d=!d)?"}":"{"}j.push(a);return j.join("")}function Ab(a){return Y.pow(10,V(Y.log(a)/Y.LN10))}function Bb(a,b,c,d,e){var f,g=a,c=q(c,1);f=a/c;b||(b=[1,2,2.5,5,10],d===!1&&(c===1?b=[1,2,5,10]:c<=0.1&&(b=[1/c])));for(d=0;d<b.length;d++)if(g=b[d],e&&g*c>=a||!e&&f<=(b[d]+(b[d+1]||b[d]))/2)break;g*=c;return g}function ob(a,b){var c=a.length,
d,e;for(e=0;e<c;e++)a[e].safeI=e;a.sort(function(a,c){d=b(a,c);return d===0?a.safeI-c.safeI:d});for(e=0;e<c;e++)delete a[e].safeI}function Oa(a){for(var b=a.length,c=a[0];b--;)a[b]<c&&(c=a[b]);return c}function Ea(a){for(var b=a.length,c=a[0];b--;)a[b]>c&&(c=a[b]);return c}function Pa(a,b){for(var c in a)a[c]&&a[c]!==b&&a[c].destroy&&a[c].destroy(),delete a[c]}function Va(a){pb||(pb=ea(Wa));a&&pb.appendChild(a);pb.innerHTML=""}function na(a,b){return parseFloat(a.toPrecision(b||14))}function ab(a,
b){b.renderer.globalAnimation=q(a,b.animation)}function hb(a){return da(a)?C(a):{duration:a?500:0}}function Ob(){var a=N.global,b=a.useUTC,c=b?"getUTC":"get",d=b?"setUTC":"set";fa=a.Date||J.Date;zb=b&&a.timezoneOffset;gb=b&&a.getTimezoneOffset;qb=function(a,c,d,h,i,j){var k;b?(k=fa.UTC.apply(0,arguments),k+=fb(k)):k=(new fa(a,c,q(d,1),q(h,0),q(i,0),q(j,0))).getTime();return k};Cb=c+"Minutes";Db=c+"Hours";Eb=c+"Day";bb=c+"Date";ib=c+"Month";jb=c+"FullYear";Pb=d+"Milliseconds";Qb=d+"Seconds";Rb=d+"Minutes";
Sb=d+"Hours";rb=d+"Date";Fb=d+"Month";Gb=d+"FullYear"}function wa(a){if(!(this instanceof wa))return new wa(a);this.init(a)}function Z(){}function cb(a,b,c,d){this.axis=a;this.pos=b;this.type=c||"";this.isNew=!0;!c&&!d&&this.addLabel()}function Tb(a,b,c,d,e){var f=a.chart.inverted;this.axis=a;this.isNegative=c;this.options=b;this.x=d;this.total=null;this.points={};this.stack=e;this.rightCliff=this.leftCliff=0;this.alignOptions={align:b.align||(f?c?"left":"right":"center"),verticalAlign:b.verticalAlign||
(f?"middle":c?"bottom":"top"),y:q(b.y,f?4:c?14:-6),x:q(b.x,f?c?-6:6:0)};this.textAlign=b.textAlign||(f?c?"right":"left":"center")}function Hb(a){var b=a.options,c=b.navigator,d=c.enabled,b=b.scrollbar,e=b.enabled,f=d?c.height:0,g=e?b.height:0;this.handles=[];this.scrollbarButtons=[];this.elementsToDestroy=[];this.chart=a;this.setBaseSeries();this.height=f;this.scrollbarHeight=g;this.scrollbarEnabled=e;this.navigatorEnabled=d;this.navigatorOptions=c;this.scrollbarOptions=b;this.outlineHeight=f+g;this.init()}
function Ib(a){this.init(a)}var t,B=J.document,Y=Math,y=Y.round,V=Y.floor,Fa=Y.ceil,v=Y.max,E=Y.min,S=Y.abs,ba=Y.cos,ka=Y.sin,Ba=Y.PI,pa=Ba*2/360,Ma=J.navigator&&J.navigator.userAgent||"",Ub=J.opera,Ka=/(msie|trident|edge)/i.test(Ma)&&!Ub,sb=B&&B.documentMode===8,tb=!Ka&&/AppleWebKit/.test(Ma),Xa=/Firefox/.test(Ma),kb=/(Mobile|Android|Windows Phone)/.test(Ma),Qa="http://www.w3.org/2000/svg",ja=B&&B.createElementNS&&!!B.createElementNS(Qa,"svg").createSVGRect,Zb=Xa&&parseInt(Ma.split("Firefox/")[1],
10)<4,qa=B&&!ja&&!Ka&&!!B.createElement("canvas").getContext,Ya,db,Vb={},Jb=0,pb,N,ma,H,ra=function(){},$=[],lb=0,Wa="div",$b=/^[0-9]+$/,ub=["plotTop","marginRight","marginBottom","plotLeft"],fa,qb,zb,gb,Cb,Db,Eb,bb,ib,jb,Pb,Qb,Rb,Sb,rb,Fb,Gb,K={},z;z=J.Highcharts?ga(16,!0):{win:J};z.seriesTypes=K;var Ra=[],xa,sa,n,Sa,Kb,ta,D,T,M,eb,Ta;yb.prototype={dSetter:function(){var a=this.paths[0],b=this.paths[1],c=[],d=this.now,e=a.length,f;if(d===1)c=this.toD;else if(e===b.length&&d<1)for(;e--;)f=parseFloat(a[e]),
c[e]=isNaN(f)?a[e]:d*parseFloat(b[e]-f)+f;else c=b;this.elem.attr("d",c)},update:function(){var a=this.elem,b=this.prop,c=this.now,d=this.options.step;if(this[b+"Setter"])this[b+"Setter"]();else a.attr?a.element&&a.attr(b,c):a.style[b]=c+this.unit;d&&d.call(a,c,this)},run:function(a,b,c){var d=this,e=function(a){return e.stopped?!1:d.step(a)},f;this.startTime=+new fa;this.start=a;this.end=b;this.unit=c;this.now=this.start;this.pos=0;e.elem=this.elem;if(e()&&Ra.push(e)===1)e.timerId=setInterval(function(){for(f=
0;f<Ra.length;f++)Ra[f]()||Ra.splice(f--,1);Ra.length||clearInterval(e.timerId)},13)},step:function(a){var b=+new fa,c,d=this.options;c=this.elem;var e=d.complete,f=d.duration,g=d.curAnim,h;if(c.attr&&!c.element)c=!1;else if(a||b>=f+this.startTime){this.now=this.end;this.pos=1;this.update();a=g[this.prop]=!0;for(h in g)g[h]!==!0&&(a=!1);a&&e&&e.call(c);c=!1}else this.pos=d.easing((b-this.startTime)/f),this.now=this.start+(this.end-this.start)*this.pos,this.update(),c=!0;return c},initPath:function(a,
b,c){var b=b||"",d=a.shift,e=b.indexOf("C")>-1,f=e?7:3,g,b=b.split(" "),c=[].concat(c),h=a.isArea,i=h?2:1,j=function(a){for(g=a.length;g--;)(a[g]==="M"||a[g]==="L")&&a.splice(g+1,0,a[g+1],a[g+2],a[g+1],a[g+2])};e&&(j(b),j(c));if(d<=c.length/f&&b.length===c.length)for(;d--;)c=c.slice(0,f).concat(c),h&&(c=c.concat(c.slice(c.length-f)));a.shift=0;if(b.length)for(a=c.length;b.length<a;)d=b.slice().splice(b.length/i-f,f*i),e&&(d[f-6]=d[f-2],d[f-5]=d[f-1]),[].splice.apply(b,[b.length/i,0].concat(d));return[b,
c]}};var x=z.extend=function(a,b){var c;a||(a={});for(c in b)a[c]=b[c];return a},q=z.pick=function(){var a=arguments,b,c,d=a.length;for(b=0;b<d;b++)if(c=a[b],c!==t&&c!==null)return c},U=z.wrap=function(a,b,c){var d=a[b];a[b]=function(){var a=Array.prototype.slice.call(arguments);a.unshift(d);return c.apply(this,a)}};ma=function(a,b,c){if(!s(b)||isNaN(b))return N.lang.invalidDate||"";var a=q(a,"%Y-%m-%d %H:%M:%S"),d=new fa(b-fb(b)),e,f=d[Db](),g=d[Eb](),h=d[bb](),i=d[ib](),j=d[jb](),k=N.lang,l=k.weekdays,
m=k.shortWeekdays,d=x({a:m?m[g]:l[g].substr(0,3),A:l[g],d:Na(h),e:Na(h,2," "),w:g,b:k.shortMonths[i],B:k.months[i],m:Na(i+1),y:j.toString().substr(2,2),Y:j,H:Na(f),k:f,I:Na(f%12||12),l:f%12||12,M:Na(d[Cb]()),p:f<12?"AM":"PM",P:f<12?"am":"pm",S:Na(d.getSeconds()),L:Na(y(b%1E3),3)},z.dateFormats);for(e in d)for(;a.indexOf("%"+e)!==-1;)a=a.replace("%"+e,typeof d[e]==="function"?d[e](b):d[e]);return c?a.substr(0,1).toUpperCase()+a.substr(1):a};H={millisecond:1,second:1E3,minute:6E4,hour:36E5,day:864E5,
week:6048E5,month:24192E5,year:314496E5};z.numberFormat=function(a,b,c,d){var a=+a||0,e=N.lang,f=(a.toString().split(".")[1]||"").length,g,h,i=Math.abs(a);b===-1?b=Math.min(f,20):isNaN(b)&&(b=2);g=String(G(i.toFixed(b)));h=g.length>3?g.length%3:0;c=q(c,e.decimalPoint);d=q(d,e.thousandsSep);a=a<0?"-":"";a+=h?g.substr(0,h)+d:"";a+=g.substr(h).replace(/(\d{3})(?=\d)/g,"$1"+d);+b&&(d=Math.abs(i-g+Math.pow(10,-Math.max(b,f)-1)),a+=c+d.toFixed(b).slice(2));return a};Math.easeInOutSine=function(a){return-0.5*
(Math.cos(Math.PI*a)-1)};xa=function(a,b){var c;if(b==="width")return Math.min(a.offsetWidth,a.scrollWidth)-xa(a,"padding-left")-xa(a,"padding-right");else if(b==="height")return Math.min(a.offsetHeight,a.scrollHeight)-xa(a,"padding-top")-xa(a,"padding-bottom");return(c=J.getComputedStyle(a,void 0))&&G(c.getPropertyValue(b))};sa=function(a,b){return b.indexOf?b.indexOf(a):[].indexOf.call(b,a)};Sa=function(a,b){return[].filter.call(a,b)};ta=function(a,b){for(var c=[],d=0,e=a.length;d<e;d++)c[d]=b.call(a[d],
a[d],d,a);return c};Kb=function(a){var b=B.documentElement,a=a.getBoundingClientRect();return{top:a.top+(J.pageYOffset||b.scrollTop)-(b.clientTop||0),left:a.left+(J.pageXOffset||b.scrollLeft)-(b.clientLeft||0)}};Ta=function(a){for(var b=Ra.length;b--;)if(Ra[b].elem===a)Ra[b].stopped=!0};n=function(a,b){return Array.prototype.forEach.call(a,b)};D=function(a,b,c){function d(b){b.target=b.srcElement||J;c.call(a,b)}var e=a.hcEvents=a.hcEvents||{};if(a.addEventListener)a.addEventListener(b,c,!1);else if(a.attachEvent){if(!a.hcEventsIE)a.hcEventsIE=
{};a.hcEventsIE[c.toString()]=d;a.attachEvent("on"+b,d)}e[b]||(e[b]=[]);e[b].push(c)};T=function(a,b,c){function d(b,c){a.removeEventListener?a.removeEventListener(b,c,!1):a.attachEvent&&(c=a.hcEventsIE[c.toString()],a.detachEvent("on"+b,c))}function e(){var c,e,f;if(a.nodeName)for(f in b?(c={},c[b]=!0):c=g,c)if(g[f])for(e=g[f].length;e--;)d(f,g[f][e])}var f,g=a.hcEvents,h;if(g)b?(f=g[b]||[],c?(h=sa(c,f),h>-1&&(f.splice(h,1),g[b]=f),d(b,c)):(e(),g[b]=[])):(e(),a.hcEvents={})};M=function(a,b,c,d){var e;
e=a.hcEvents;var f,g,c=c||{};if(B.createEvent&&(a.dispatchEvent||a.fireEvent))e=B.createEvent("Events"),e.initEvent(b,!0,!0),e.target=a,x(e,c),a.dispatchEvent?a.dispatchEvent(e):a.fireEvent(b,e);else if(e){e=e[b]||[];f=e.length;if(!c.preventDefault)c.preventDefault=function(){c.defaultPrevented=!0};c.target=a;if(!c.type)c.type=b;for(b=0;b<f;b++)g=e[b],g.call(a,c)===!1&&c.preventDefault()}d&&!c.defaultPrevented&&d(c)};eb=function(a,b,c){var d,e="",f,g,h;da(c)||(d=arguments,c={duration:d[2],easing:d[3],
complete:d[4]});if(!ua(c.duration))c.duration=400;c.easing=typeof c.easing==="function"?c.easing:Math[c.easing]||Math.easeInOutSine;c.curAnim=C(b);for(h in b)g=new yb(a,c,h),f=null,h==="d"?(g.paths=g.initPath(a,a.d,b.d),g.toD=b.d,d=0,f=1):a.attr?d=a.attr(h):(d=parseFloat(xa(a,h))||0,h!=="opacity"&&(e="px")),f||(f=b[h]),f.match&&f.match("px")&&(f=f.replace(/px/g,"")),g.run(d,f,e)};if(J.jQuery)J.jQuery.fn.highcharts=function(){var a=[].slice.call(arguments);if(this[0])return a[0]?(new (z[Da(a[0])?a.shift():
"Chart"])(this[0],a[0],a[1]),this):$[X(this[0],"data-highcharts-chart")]};B&&!B.defaultView&&(xa=function(a,b){var c;c={width:"clientWidth",height:"clientHeight"}[b];if(a.style[b])return G(a.style[b]);b==="opacity"&&(b="filter");if(c)return a.style.zoom=1,Math.max(a[c]-2*xa(a,"padding"),0);c=a.currentStyle[b.replace(/\-(\w)/g,function(a,b){return b.toUpperCase()})];b==="filter"&&(c=c.replace(/alpha\(opacity=([0-9]+)\)/,function(a,b){return b/100}));return c===""?1:G(c)});Array.prototype.forEach||
(n=function(a,b){for(var c=0,d=a.length;c<d;c++)if(b.call(a[c],a[c],c,a)===!1)return c});Array.prototype.indexOf||(sa=function(a,b){var c,d=0;if(b)for(c=b.length;d<c;d++)if(b[d]===a)return d;return-1});Array.prototype.filter||(Sa=function(a,b){for(var c=[],d=0,e=a.length;d<e;d++)b(a[d],d)&&c.push(a[d]);return c});z.Fx=yb;z.inArray=sa;z.each=n;z.grep=Sa;z.offset=Kb;z.map=ta;z.addEvent=D;z.removeEvent=T;z.fireEvent=M;z.animate=eb;z.animObject=hb;z.stop=Ta;N={colors:"#7cb5ec,#434348,#90ed7d,#f7a35c,#8085e9,#f15c80,#e4d354,#2b908f,#f45b5b,#91e8e1".split(","),
symbols:["circle","diamond","square","triangle","triangle-down"],lang:{loading:"Loading...",months:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),shortMonths:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),weekdays:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),decimalPoint:".",numericSymbols:"k,M,G,T,P,E".split(","),resetZoom:"Reset zoom",resetZoomTitle:"Reset zoom level 1:1",thousandsSep:" "},global:{useUTC:!0,
canvasToolsURL:"http://code.highcharts.com/modules/canvas-tools.js",VMLRadialGradientURL:"http://code.highcharts.com/stock/4.2.4/gfx/vml-radial-gradient.png"},chart:{borderColor:"#4572A7",borderRadius:0,defaultSeriesType:"line",ignoreHiddenSeries:!0,spacing:[10,10,15,10],backgroundColor:"#FFFFFF",plotBorderColor:"#C0C0C0",resetZoomButton:{theme:{zIndex:20},position:{align:"right",x:-10,y:10}}},title:{text:"Chart title",align:"center",margin:15,style:{color:"#333333",fontSize:"18px"}},subtitle:{text:"",
align:"center",style:{color:"#555555"}},plotOptions:{line:{allowPointSelect:!1,showCheckbox:!1,animation:{duration:1E3},events:{},lineWidth:2,marker:{lineWidth:0,radius:4,lineColor:"#FFFFFF",states:{hover:{enabled:!0,lineWidthPlus:1,radiusPlus:2},select:{fillColor:"#FFFFFF",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:{align:"center",formatter:function(){return this.y===null?"":z.numberFormat(this.y,-1)},style:{color:"contrast",fontSize:"11px",fontWeight:"bold",textShadow:"0 0 6px contrast, 0 0 3px contrast"},
verticalAlign:"bottom",x:0,y:0,padding:5},cropThreshold:300,pointRange:0,softThreshold:!0,states:{hover:{lineWidthPlus:1,marker:{},halo:{size:10,opacity:0.25}},select:{marker:{}}},stickyTracking:!0,turboThreshold:1E3}},labels:{style:{position:"absolute",color:"#3E576F"}},legend:{enabled:!0,align:"center",layout:"horizontal",labelFormatter:function(){return this.name},borderColor:"#909090",borderRadius:0,navigation:{activeColor:"#274b6d",inactiveColor:"#CCC"},shadow:!1,itemStyle:{color:"#333333",fontSize:"12px",
fontWeight:"bold"},itemHoverStyle:{color:"#000"},itemHiddenStyle:{color:"#CCC"},itemCheckboxStyle:{position:"absolute",width:"13px",height:"13px"},symbolPadding:5,verticalAlign:"bottom",x:0,y:0,title:{style:{fontWeight:"bold"}}},loading:{labelStyle:{fontWeight:"bold",position:"relative",top:"45%"},style:{position:"absolute",backgroundColor:"white",opacity:0.5,textAlign:"center"}},tooltip:{enabled:!0,animation:ja,backgroundColor:"rgba(249, 249, 249, .85)",borderWidth:1,borderRadius:3,dateTimeLabelFormats:{millisecond:"%A, %b %e, %H:%M:%S.%L",
second:"%A, %b %e, %H:%M:%S",minute:"%A, %b %e, %H:%M",hour:"%A, %b %e, %H:%M",day:"%A, %b %e, %Y",week:"Week from %A, %b %e, %Y",month:"%B %Y",year:"%Y"},footerFormat:"",headerFormat:'<span style="font-size: 10px">{point.key}</span><br/>',pointFormat:'<span style="color:{point.color}">\u25cf</span> {series.name}: <b>{point.y}</b><br/>',shadow:!0,snap:kb?25:10,style:{color:"#333333",cursor:"default",fontSize:"12px",padding:"8px",pointerEvents:"none",whiteSpace:"nowrap"}},credits:{enabled:!0,text:"Highcharts.com",
href:"http://www.highcharts.com",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#909090",fontSize:"9px"}}};var W=N.plotOptions,ca=W.line;Ob();wa.prototype={parsers:[{regex:/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]?(?:\.[0-9]+)?)\s*\)/,parse:function(a){return[G(a[1]),G(a[2]),G(a[3]),parseFloat(a[4],10)]}},{regex:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,parse:function(a){return[G(a[1],16),G(a[2],16),G(a[3],16),1]}},
{regex:/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/,parse:function(a){return[G(a[1]),G(a[2]),G(a[3]),1]}}],init:function(a){var b,c,d,e;if((this.input=a)&&a.stops)this.stops=ta(a.stops,function(a){return new wa(a[1])});else for(d=this.parsers.length;d--&&!c;)e=this.parsers[d],(b=e.regex.exec(a))&&(c=e.parse(b));this.rgba=c||[]},get:function(a){var b=this.input,c=this.rgba,d;this.stops?(d=C(b),d.stops=[].concat(d.stops),n(this.stops,function(b,c){d.stops[c]=[d.stops[c][0],b.get(a)]})):
d=c&&!isNaN(c[0])?a==="rgb"||!a&&c[3]===1?"rgb("+c[0]+","+c[1]+","+c[2]+")":a==="a"?c[3]:"rgba("+c.join(",")+")":b;return d},brighten:function(a){var b,c=this.rgba;if(this.stops)n(this.stops,function(b){b.brighten(a)});else if(ua(a)&&a!==0)for(b=0;b<3;b++)c[b]+=G(a*255),c[b]<0&&(c[b]=0),c[b]>255&&(c[b]=255);return this},setOpacity:function(a){this.rgba[3]=a;return this}};Z.prototype={opacity:1,textProps:"direction,fontSize,fontWeight,fontFamily,fontStyle,color,lineHeight,width,textDecoration,textOverflow,textShadow".split(","),
init:function(a,b){this.element=b==="span"?ea(b):B.createElementNS(Qa,b);this.renderer=a},animate:function(a,b,c){b=q(b,this.renderer.globalAnimation,!0);Ta(this);if(b){if(c)b.complete=c;eb(this,a,b)}else this.attr(a,null,c);return this},colorGradient:function(a,b,c){var d=this.renderer,e,f,g,h,i,j,k,l,m,o,p,r=[],A;a.linearGradient?f="linearGradient":a.radialGradient&&(f="radialGradient");if(f){g=a[f];i=d.gradients;k=a.stops;o=c.radialReference;Ja(g)&&(a[f]=g={x1:g[0],y1:g[1],x2:g[2],y2:g[3],gradientUnits:"userSpaceOnUse"});
f==="radialGradient"&&o&&!s(g.gradientUnits)&&(h=g,g=C(g,d.getRadialAttr(o,h),{gradientUnits:"userSpaceOnUse"}));for(p in g)p!=="id"&&r.push(p,g[p]);for(p in k)r.push(k[p]);r=r.join(",");i[r]?o=i[r].attr("id"):(g.id=o="highcharts-"+Jb++,i[r]=j=d.createElement(f).attr(g).add(d.defs),j.radAttr=h,j.stops=[],n(k,function(a){a[1].indexOf("rgba")===0?(e=wa(a[1]),l=e.get("rgb"),m=e.get("a")):(l=a[1],m=1);a=d.createElement("stop").attr({offset:a[0],"stop-color":l,"stop-opacity":m}).add(j);j.stops.push(a)}));
A="url("+d.url+"#"+o+")";c.setAttribute(b,A);c.gradient=r;a.toString=function(){return A}}},applyTextShadow:function(a){var b=this.element,c,d=a.indexOf("contrast")!==-1,e={},f=this.renderer.forExport,g=f||b.style.textShadow!==t&&!Ka;if(d)e.textShadow=a=a.replace(/contrast/g,this.renderer.getContrast(b.style.fill));if(tb||f)e.textRendering="geometricPrecision";g?this.css(e):(this.fakeTS=!0,this.ySetter=this.xSetter,c=[].slice.call(b.getElementsByTagName("tspan")),n(a.split(/\s?,\s?/g),function(a){var d=
b.firstChild,e,f,a=a.split(" ");e=a[a.length-1];(f=a[a.length-2])&&n(c,function(a,c){var g;c===0&&(a.setAttribute("x",b.getAttribute("x")),c=b.getAttribute("y"),a.setAttribute("y",c||0),c===null&&b.setAttribute("y",0));g=a.cloneNode(1);X(g,{"class":"highcharts-text-shadow",fill:e,stroke:e,"stroke-opacity":1/v(G(f),3),"stroke-width":f,"stroke-linejoin":"round"});b.insertBefore(g,d)})}))},attr:function(a,b,c){var d,e=this.element,f,g=this,h;typeof a==="string"&&b!==t&&(d=a,a={},a[d]=b);if(typeof a===
"string")g=(this[a+"Getter"]||this._defaultGetter).call(this,a,e);else{for(d in a){b=a[d];h=!1;this.symbolName&&/^(x|y|width|height|r|start|end|innerR|anchorX|anchorY)/.test(d)&&(f||(this.symbolAttr(a),f=!0),h=!0);if(this.rotation&&(d==="x"||d==="y"))this.doTransform=!0;h||(h=this[d+"Setter"]||this._defaultSetter,h.call(this,b,d,e),this.shadows&&/^(width|height|visibility|x|y|d|transform|cx|cy|r)$/.test(d)&&this.updateShadows(d,b,h))}if(this.doTransform)this.updateTransform(),this.doTransform=!1}c&&
c();return g},updateShadows:function(a,b,c){for(var d=this.shadows,e=d.length;e--;)c.call(d[e],a==="height"?Math.max(b-(d[e].cutHeight||0),0):a==="d"?this.d:b,a,d[e])},addClass:function(a){var b=this.element,c=X(b,"class")||"";c.indexOf(a)===-1&&X(b,"class",c+" "+a);return this},symbolAttr:function(a){var b=this;n("x,y,r,start,end,width,height,innerR,anchorX,anchorY".split(","),function(c){b[c]=q(a[c],b[c])});b.attr({d:b.renderer.symbols[b.symbolName](b.x,b.y,b.width,b.height,b)})},clip:function(a){return this.attr("clip-path",
a?"url("+this.renderer.url+"#"+a.id+")":"none")},crisp:function(a){var b,c={},d,e=this.strokeWidth||0;d=y(e)%2/2;a.x=V(a.x||this.x||0)+d;a.y=V(a.y||this.y||0)+d;a.width=V((a.width||this.width||0)-2*d);a.height=V((a.height||this.height||0)-2*d);a.strokeWidth=e;for(b in a)this[b]!==a[b]&&(this[b]=c[b]=a[b]);return c},css:function(a){var b=this.styles,c={},d=this.element,e,f,g="";e=!b;if(a&&a.color)a.fill=a.color;if(b)for(f in a)a[f]!==b[f]&&(c[f]=a[f],e=!0);if(e){e=this.textWidth=a&&a.width&&d.nodeName.toLowerCase()===
"text"&&G(a.width)||this.textWidth;b&&(a=x(b,c));this.styles=a;e&&(qa||!ja&&this.renderer.forExport)&&delete a.width;if(Ka&&!ja)F(this.element,a);else{b=function(a,b){return"-"+b.toLowerCase()};for(f in a)g+=f.replace(/([A-Z])/g,b)+":"+a[f]+";";X(d,"style",g)}e&&this.added&&this.renderer.buildText(this)}return this},on:function(a,b){var c=this,d=c.element;db&&a==="click"?(d.ontouchstart=function(a){c.touchEventFired=fa.now();a.preventDefault();b.call(d,a)},d.onclick=function(a){(Ma.indexOf("Android")===
-1||fa.now()-(c.touchEventFired||0)>1100)&&b.call(d,a)}):d["on"+a]=b;return this},setRadialReference:function(a){var b=this.renderer.gradients[this.element.gradient];this.element.radialReference=a;b&&b.radAttr&&b.animate(this.renderer.getRadialAttr(a,b.radAttr));return this},translate:function(a,b){return this.attr({translateX:a,translateY:b})},invert:function(){this.inverted=!0;this.updateTransform();return this},updateTransform:function(){var a=this.translateX||0,b=this.translateY||0,c=this.scaleX,
d=this.scaleY,e=this.inverted,f=this.rotation,g=this.element;e&&(a+=this.attr("width"),b+=this.attr("height"));a=["translate("+a+","+b+")"];e?a.push("rotate(90) scale(-1,1)"):f&&a.push("rotate("+f+" "+(g.getAttribute("x")||0)+" "+(g.getAttribute("y")||0)+")");(s(c)||s(d))&&a.push("scale("+q(c,1)+" "+q(d,1)+")");a.length&&g.setAttribute("transform",a.join(" "))},toFront:function(){var a=this.element;a.parentNode.appendChild(a);return this},align:function(a,b,c){var d,e,f,g,h={};e=this.renderer;f=e.alignedObjects;
if(a){if(this.alignOptions=a,this.alignByTranslate=b,!c||Da(c))this.alignTo=d=c||"renderer",Aa(f,this),f.push(this),c=null}else a=this.alignOptions,b=this.alignByTranslate,d=this.alignTo;c=q(c,e[d],e);d=a.align;e=a.verticalAlign;f=(c.x||0)+(a.x||0);g=(c.y||0)+(a.y||0);if(d==="right"||d==="center")f+=(c.width-(a.width||0))/{right:1,center:2}[d];h[b?"translateX":"x"]=y(f);if(e==="bottom"||e==="middle")g+=(c.height-(a.height||0))/({bottom:1,middle:2}[e]||1);h[b?"translateY":"y"]=y(g);this[this.placed?
"animate":"attr"](h);this.placed=!0;this.alignAttr=h;return this},getBBox:function(a,b){var c,d=this.renderer,e,f,g,h=this.element,i=this.styles;e=this.textStr;var j,k=h.style,l,m=d.cache,o=d.cacheKeys,p;f=q(b,this.rotation);g=f*pa;e!==t&&(p=["",f||0,i&&i.fontSize,h.style.width].join(","),p=e===""||$b.test(e)?"num:"+e.toString().length+p:e+p);p&&!a&&(c=m[p]);if(!c){if(h.namespaceURI===Qa||d.forExport){try{l=this.fakeTS&&function(a){n(h.querySelectorAll(".highcharts-text-shadow"),function(b){b.style.display=
a})},Xa&&k.textShadow?(j=k.textShadow,k.textShadow=""):l&&l("none"),c=h.getBBox?x({},h.getBBox()):{width:h.offsetWidth,height:h.offsetHeight},j?k.textShadow=j:l&&l("")}catch(r){}if(!c||c.width<0)c={width:0,height:0}}else c=this.htmlGetBBox();if(d.isSVG){d=c.width;e=c.height;if(Ka&&i&&i.fontSize==="11px"&&e.toPrecision(3)==="16.9")c.height=e=14;if(f)c.width=S(e*ka(g))+S(d*ba(g)),c.height=S(e*ba(g))+S(d*ka(g))}if(p){for(;o.length>250;)delete m[o.shift()];m[p]||o.push(p);m[p]=c}}return c},show:function(a){return this.attr({visibility:a?
"inherit":"visible"})},hide:function(){return this.attr({visibility:"hidden"})},fadeOut:function(a){var b=this;b.animate({opacity:0},{duration:a||150,complete:function(){b.attr({y:-9999})}})},add:function(a){var b=this.renderer,c=this.element,d;if(a)this.parentGroup=a;this.parentInverted=a&&a.inverted;this.textStr!==void 0&&b.buildText(this);this.added=!0;if(!a||a.handleZ||this.zIndex)d=this.zIndexSetter();d||(a?a.element:b.box).appendChild(c);if(this.onAdd)this.onAdd();return this},safeRemoveChild:function(a){var b=
a.parentNode;b&&b.removeChild(a)},destroy:function(){var a=this,b=a.element||{},c=a.shadows,d=a.renderer.isSVG&&b.nodeName==="SPAN"&&a.parentGroup,e,f;b.onclick=b.onmouseout=b.onmouseover=b.onmousemove=b.point=null;Ta(a);if(a.clipPath)a.clipPath=a.clipPath.destroy();if(a.stops){for(f=0;f<a.stops.length;f++)a.stops[f]=a.stops[f].destroy();a.stops=null}a.safeRemoveChild(b);for(c&&n(c,function(b){a.safeRemoveChild(b)});d&&d.div&&d.div.childNodes.length===0;)b=d.parentGroup,a.safeRemoveChild(d.div),delete d.div,
d=b;a.alignTo&&Aa(a.renderer.alignedObjects,a);for(e in a)delete a[e];return null},shadow:function(a,b,c){var d=[],e,f,g=this.element,h,i,j,k;if(a){i=q(a.width,3);j=(a.opacity||0.15)/i;k=this.parentInverted?"(-1,-1)":"("+q(a.offsetX,1)+", "+q(a.offsetY,1)+")";for(e=1;e<=i;e++){f=g.cloneNode(0);h=i*2+1-2*e;X(f,{isShadow:"true",stroke:a.color||"black","stroke-opacity":j*e,"stroke-width":h,transform:"translate"+k,fill:"none"});if(c)X(f,"height",v(X(f,"height")-h,0)),f.cutHeight=h;b?b.element.appendChild(f):
g.parentNode.insertBefore(f,g);d.push(f)}this.shadows=d}return this},xGetter:function(a){this.element.nodeName==="circle"&&(a={x:"cx",y:"cy"}[a]||a);return this._defaultGetter(a)},_defaultGetter:function(a){a=q(this[a],this.element?this.element.getAttribute(a):null,0);/^[\-0-9\.]+$/.test(a)&&(a=parseFloat(a));return a},dSetter:function(a,b,c){a&&a.join&&(a=a.join(" "));/(NaN| {2}|^$)/.test(a)&&(a="M 0 0");c.setAttribute(b,a);this[b]=a},dashstyleSetter:function(a){var b,c=this["stroke-width"];c===
"inherit"&&(c=1);if(a=a&&a.toLowerCase()){a=a.replace("shortdashdotdot","3,1,1,1,1,1,").replace("shortdashdot","3,1,1,1").replace("shortdot","1,1,").replace("shortdash","3,1,").replace("longdash","8,3,").replace(/dot/g,"1,3,").replace("dash","4,3,").replace(/,$/,"").split(",");for(b=a.length;b--;)a[b]=G(a[b])*c;a=a.join(",").replace(/NaN/g,"none");this.element.setAttribute("stroke-dasharray",a)}},alignSetter:function(a){this.element.setAttribute("text-anchor",{left:"start",center:"middle",right:"end"}[a])},
opacitySetter:function(a,b,c){this[b]=a;c.setAttribute(b,a)},titleSetter:function(a){var b=this.element.getElementsByTagName("title")[0];b||(b=B.createElementNS(Qa,"title"),this.element.appendChild(b));b.appendChild(B.createTextNode(String(q(a),"").replace(/<[^>]*>/g,"")))},textSetter:function(a){if(a!==this.textStr)delete this.bBox,this.textStr=a,this.added&&this.renderer.buildText(this)},fillSetter:function(a,b,c){typeof a==="string"?c.setAttribute(b,a):a&&this.colorGradient(a,b,c)},visibilitySetter:function(a,
b,c){a==="inherit"?c.removeAttribute(b):c.setAttribute(b,a)},zIndexSetter:function(a,b){var c=this.renderer,d=this.parentGroup,c=(d||c).element||c.box,e,f,g=this.element,h;e=this.added;var i;if(s(a))g.zIndex=a,a=+a,this[b]===a&&(e=!1),this[b]=a;if(e){if((a=this.zIndex)&&d)d.handleZ=!0;d=c.childNodes;for(i=0;i<d.length&&!h;i++)if(e=d[i],f=e.zIndex,e!==g&&(G(f)>a||!s(a)&&s(f)))c.insertBefore(g,e),h=!0;h||c.appendChild(g)}return h},_defaultSetter:function(a,b,c){c.setAttribute(b,a)}};Z.prototype.yGetter=
Z.prototype.xGetter;Z.prototype.translateXSetter=Z.prototype.translateYSetter=Z.prototype.rotationSetter=Z.prototype.verticalAlignSetter=Z.prototype.scaleXSetter=Z.prototype.scaleYSetter=function(a,b){this[b]=a;this.doTransform=!0};Z.prototype["stroke-widthSetter"]=Z.prototype.strokeSetter=function(a,b,c){this[b]=a;if(this.stroke&&this["stroke-width"])this.strokeWidth=this["stroke-width"],Z.prototype.fillSetter.call(this,this.stroke,"stroke",c),c.setAttribute("stroke-width",this["stroke-width"]),
this.hasStroke=!0;else if(b==="stroke-width"&&a===0&&this.hasStroke)c.removeAttribute("stroke"),this.hasStroke=!1};var ya=function(){this.init.apply(this,arguments)};ya.prototype={Element:Z,init:function(a,b,c,d,e,f){var g,d=this.createElement("svg").attr({version:"1.1"}).css(this.getStyle(d));g=d.element;a.appendChild(g);a.innerHTML.indexOf("xmlns")===-1&&X(g,"xmlns",Qa);this.isSVG=!0;this.box=g;this.boxWrapper=d;this.alignedObjects=[];this.url=(Xa||tb)&&B.getElementsByTagName("base").length?J.location.href.replace(/#.*?$/,
"").replace(/([\('\)])/g,"\\$1").replace(/ /g,"%20"):"";this.createElement("desc").add().element.appendChild(B.createTextNode("Created with Highstock 4.2.4"));this.defs=this.createElement("defs").add();this.allowHTML=f;this.forExport=e;this.gradients={};this.cache={};this.cacheKeys=[];this.imgCount=0;this.setSize(b,c,!1);var h;if(Xa&&a.getBoundingClientRect)this.subPixelFix=b=function(){F(a,{left:0,top:0});h=a.getBoundingClientRect();F(a,{left:Fa(h.left)-h.left+"px",top:Fa(h.top)-h.top+"px"})},b(),
D(J,"resize",b)},getStyle:function(a){return this.style=x({fontFamily:'"Lucida Grande", "Lucida Sans Unicode", Arial, Helvetica, sans-serif',fontSize:"12px"},a)},isHidden:function(){return!this.boxWrapper.getBBox().width},destroy:function(){var a=this.defs;this.box=null;this.boxWrapper=this.boxWrapper.destroy();Pa(this.gradients||{});this.gradients=null;if(a)this.defs=a.destroy();this.subPixelFix&&T(J,"resize",this.subPixelFix);return this.alignedObjects=null},createElement:function(a){var b=new this.Element;
b.init(this,a);return b},draw:function(){},getRadialAttr:function(a,b){return{cx:a[0]-a[2]/2+b.cx*a[2],cy:a[1]-a[2]/2+b.cy*a[2],r:b.r*a[2]}},buildText:function(a){for(var b=a.element,c=this,d=c.forExport,e=q(a.textStr,"").toString(),f=e.indexOf("<")!==-1,g=b.childNodes,h,i,j=X(b,"x"),k=a.styles,l=a.textWidth,m=k&&k.lineHeight,o=k&&k.textShadow,p=k&&k.textOverflow==="ellipsis",r=g.length,A=l&&!a.added&&this.box,P=function(a){return m?G(m):c.fontMetrics(/(px|em)$/.test(a&&a.style.fontSize)?a.style.fontSize:
k&&k.fontSize||c.style.fontSize||12,a).h},u=function(a){return a.replace(/&lt;/g,"<").replace(/&gt;/g,">")};r--;)b.removeChild(g[r]);!f&&!o&&!p&&e.indexOf(" ")===-1?b.appendChild(B.createTextNode(u(e))):(h=/<.*style="([^"]+)".*>/,i=/<.*href="(http[^"]+)".*>/,A&&A.appendChild(b),e=f?e.replace(/<(b|strong)>/g,'<span style="font-weight:bold">').replace(/<(i|em)>/g,'<span style="font-style:italic">').replace(/<a/g,"<span").replace(/<\/(b|strong|i|em|a)>/g,"</span>").split(/<br.*?>/g):[e],e[e.length-1]===
""&&e.pop(),n(e,function(e,f){var g,m=0,e=e.replace(/<span/g,"|||<span").replace(/<\/span>/g,"</span>|||");g=e.split("|||");n(g,function(e){if(e!==""||g.length===1){var o={},r=B.createElementNS(Qa,"tspan"),A;h.test(e)&&(A=e.match(h)[1].replace(/(;| |^)color([ :])/,"$1fill$2"),X(r,"style",A));i.test(e)&&!d&&(X(r,"onclick",'location.href="'+e.match(i)[1]+'"'),F(r,{cursor:"pointer"}));e=u(e.replace(/<(.|\n)*?>/g,"")||" ");if(e!==" "){r.appendChild(B.createTextNode(e));if(m)o.dx=0;else if(f&&j!==null)o.x=
j;X(r,o);b.appendChild(r);!m&&f&&(!ja&&d&&F(r,{display:"block"}),X(r,"dy",P(r)));if(l){for(var o=e.replace(/([^\^])-/g,"$1- ").split(" "),q=g.length>1||f||o.length>1&&k.whiteSpace!=="nowrap",w,n,s,t=[],v=P(r),y=1,x=a.rotation,C=e,z=C.length;(q||p)&&(o.length||t.length);)a.rotation=0,w=a.getBBox(!0),s=w.width,!ja&&c.forExport&&(s=c.measureSpanWidth(r.firstChild.data,a.styles)),w=s>l,n===void 0&&(n=w),p&&n?(z/=2,C===""||!w&&z<0.5?o=[]:(w&&(n=!0),C=e.substring(0,C.length+(w?-1:1)*Fa(z)),o=[C+(l>3?"\u2026":
"")],r.removeChild(r.firstChild))):!w||o.length===1?(o=t,t=[],o.length&&(y++,r=B.createElementNS(Qa,"tspan"),X(r,{dy:v,x:j}),A&&X(r,"style",A),b.appendChild(r)),s>l&&(l=s)):(r.removeChild(r.firstChild),t.unshift(o.pop())),o.length&&r.appendChild(B.createTextNode(o.join(" ").replace(/- /g,"-")));n&&a.attr("title",a.textStr);a.rotation=x}m++}}})}),A&&A.removeChild(b),o&&a.applyTextShadow&&a.applyTextShadow(o))},getContrast:function(a){a=wa(a).rgba;return a[0]+a[1]+a[2]>384?"#000000":"#FFFFFF"},button:function(a,
b,c,d,e,f,g,h,i){var j=this.label(a,b,c,i,null,null,null,null,"button"),k=0,l,m,o,p,r,A,a={x1:0,y1:0,x2:0,y2:1},e=C({"stroke-width":1,stroke:"#CCCCCC",fill:{linearGradient:a,stops:[[0,"#FEFEFE"],[1,"#F6F6F6"]]},r:2,padding:5,style:{color:"black"}},e);o=e.style;delete e.style;f=C(e,{stroke:"#68A",fill:{linearGradient:a,stops:[[0,"#FFF"],[1,"#ACF"]]}},f);p=f.style;delete f.style;g=C(e,{stroke:"#68A",fill:{linearGradient:a,stops:[[0,"#9BD"],[1,"#CDF"]]}},g);r=g.style;delete g.style;h=C(e,{style:{color:"#CCC"}},
h);A=h.style;delete h.style;D(j.element,Ka?"mouseover":"mouseenter",function(){k!==3&&j.attr(f).css(p)});D(j.element,Ka?"mouseout":"mouseleave",function(){k!==3&&(l=[e,f,g][k],m=[o,p,r][k],j.attr(l).css(m))});j.setState=function(a){(j.state=k=a)?a===2?j.attr(g).css(r):a===3&&j.attr(h).css(A):j.attr(e).css(o)};return j.on("click",function(a){k!==3&&d.call(j,a)}).attr(e).css(x({cursor:"default"},o))},crispLine:function(a,b){a[1]===a[4]&&(a[1]=a[4]=y(a[1])-b%2/2);a[2]===a[5]&&(a[2]=a[5]=y(a[2])+b%2/
2);return a},path:function(a){var b={fill:"none"};Ja(a)?b.d=a:da(a)&&x(b,a);return this.createElement("path").attr(b)},circle:function(a,b,c){a=da(a)?a:{x:a,y:b,r:c};b=this.createElement("circle");b.xSetter=b.ySetter=function(a,b,c){c.setAttribute("c"+b,a)};return b.attr(a)},arc:function(a,b,c,d,e,f){if(da(a))b=a.y,c=a.r,d=a.innerR,e=a.start,f=a.end,a=a.x;a=this.symbol("arc",a||0,b||0,c||0,c||0,{innerR:d||0,start:e||0,end:f||0});a.r=c;return a},rect:function(a,b,c,d,e,f){var e=da(a)?a.r:e,g=this.createElement("rect"),
a=da(a)?a:a===t?{}:{x:a,y:b,width:v(c,0),height:v(d,0)};if(f!==t)g.strokeWidth=f,a=g.crisp(a);if(e)a.r=e;g.rSetter=function(a,b,c){X(c,{rx:a,ry:a})};return g.attr(a)},setSize:function(a,b,c){var d=this.alignedObjects,e=d.length;this.width=a;this.height=b;for(this.boxWrapper[q(c,!0)?"animate":"attr"]({width:a,height:b});e--;)d[e].align()},g:function(a){var b=this.createElement("g");return s(a)?b.attr({"class":"highcharts-"+a}):b},image:function(a,b,c,d,e){var f={preserveAspectRatio:"none"};arguments.length>
1&&x(f,{x:b,y:c,width:d,height:e});f=this.createElement("image").attr(f);f.element.setAttributeNS?f.element.setAttributeNS("http://www.w3.org/1999/xlink","href",a):f.element.setAttribute("hc-svg-href",a);return f},symbol:function(a,b,c,d,e,f){var g=this,h,i=this.symbols[a],i=i&&i(y(b),y(c),d,e,f),j=/^url\((.*?)\)$/,k,l;if(i)h=this.path(i),x(h,{symbolName:a,x:b,y:c,width:d,height:e}),f&&x(h,f);else if(j.test(a))l=function(a,b){a.element&&(a.attr({width:b[0],height:b[1]}),a.alignByTranslate||a.translate(y((d-
b[0])/2),y((e-b[1])/2)))},k=a.match(j)[1],a=Vb[k]||f&&f.width&&f.height&&[f.width,f.height],h=this.image(k).attr({x:b,y:c}),h.isImg=!0,a?l(h,a):(h.attr({width:0,height:0}),ea("img",{onload:function(){this.width===0&&(F(this,{position:"absolute",top:"-999em"}),B.body.appendChild(this));l(h,Vb[k]=[this.width,this.height]);this.parentNode&&this.parentNode.removeChild(this);g.imgCount--;if(!g.imgCount&&$[g.chartIndex].onload)$[g.chartIndex].onload()},src:k}),this.imgCount++);return h},symbols:{circle:function(a,
b,c,d){var e=0.166*c;return["M",a+c/2,b,"C",a+c+e,b,a+c+e,b+d,a+c/2,b+d,"C",a-e,b+d,a-e,b,a+c/2,b,"Z"]},square:function(a,b,c,d){return["M",a,b,"L",a+c,b,a+c,b+d,a,b+d,"Z"]},triangle:function(a,b,c,d){return["M",a+c/2,b,"L",a+c,b+d,a,b+d,"Z"]},"triangle-down":function(a,b,c,d){return["M",a,b,"L",a+c,b,a+c/2,b+d,"Z"]},diamond:function(a,b,c,d){return["M",a+c/2,b,"L",a+c,b+d/2,a+c/2,b+d,a,b+d/2,"Z"]},arc:function(a,b,c,d,e){var f=e.start,c=e.r||c||d,g=e.end-0.001,d=e.innerR,h=e.open,i=ba(f),j=ka(f),
k=ba(g),g=ka(g),e=e.end-f<Ba?0:1;return["M",a+c*i,b+c*j,"A",c,c,0,e,1,a+c*k,b+c*g,h?"M":"L",a+d*k,b+d*g,"A",d,d,0,e,0,a+d*i,b+d*j,h?"":"Z"]},callout:function(a,b,c,d,e){var f=E(e&&e.r||0,c,d),g=f+6,h=e&&e.anchorX,e=e&&e.anchorY,i;i=["M",a+f,b,"L",a+c-f,b,"C",a+c,b,a+c,b,a+c,b+f,"L",a+c,b+d-f,"C",a+c,b+d,a+c,b+d,a+c-f,b+d,"L",a+f,b+d,"C",a,b+d,a,b+d,a,b+d-f,"L",a,b+f,"C",a,b,a,b,a+f,b];h&&h>c&&e>b+g&&e<b+d-g?i.splice(13,3,"L",a+c,e-6,a+c+6,e,a+c,e+6,a+c,b+d-f):h&&h<0&&e>b+g&&e<b+d-g?i.splice(33,3,
"L",a,e+6,a-6,e,a,e-6,a,b+f):e&&e>d&&h>a+g&&h<a+c-g?i.splice(23,3,"L",h+6,b+d,h,b+d+6,h-6,b+d,a+f,b+d):e&&e<0&&h>a+g&&h<a+c-g&&i.splice(3,3,"L",h-6,b,h,b-6,h+6,b,c-f,b);return i}},clipRect:function(a,b,c,d){var e="highcharts-"+Jb++,f=this.createElement("clipPath").attr({id:e}).add(this.defs),a=this.rect(a,b,c,d,0).add(f);a.id=e;a.clipPath=f;a.count=0;return a},text:function(a,b,c,d){var e=qa||!ja&&this.forExport,f={};if(d&&(this.allowHTML||!this.forExport))return this.html(a,b,c);f.x=Math.round(b||
0);if(c)f.y=Math.round(c);if(a||a===0)f.text=a;a=this.createElement("text").attr(f);e&&a.css({position:"absolute"});if(!d)a.xSetter=function(a,b,c){var d=c.getElementsByTagName("tspan"),e,f=c.getAttribute(b),m;for(m=0;m<d.length;m++)e=d[m],e.getAttribute(b)===f&&e.setAttribute(b,a);c.setAttribute(b,a)};return a},fontMetrics:function(a,b){var c,d,a=a||this.style.fontSize;!a&&b&&J.getComputedStyle&&(b=b.element||b,a=(c=J.getComputedStyle(b,""))&&c.fontSize);a=/px/.test(a)?G(a):/em/.test(a)?parseFloat(a)*
12:12;c=a<24?a+3:y(a*1.2);d=y(c*0.8);return{h:c,b:d,f:a}},rotCorr:function(a,b,c){var d=a;b&&c&&(d=v(d*ba(b*pa),4));return{x:-a/3*ka(b*pa),y:d}},label:function(a,b,c,d,e,f,g,h,i){var j=this,k=j.g(i),l=j.text("",0,0,g).attr({zIndex:1}),m,o,p=0,r=3,A=0,q,u,w,O,R=0,ha={},v,z,L,E,B;L=function(){var a,b;a=l.element.style;o=(q===void 0||u===void 0||k.styles.textAlign)&&s(l.textStr)&&l.getBBox();k.width=(q||o.width||0)+2*r+A;k.height=(u||o.height||0)+2*r;v=r+j.fontMetrics(a&&a.fontSize,l).b;if(z){if(!m)a=
R,b=(h?-v:0)+R,k.box=m=d?j.symbol(d,a,b,k.width,k.height,ha):j.rect(a,b,k.width,k.height,0,ha["stroke-width"]),m.isImg||m.attr("fill","none"),m.add(k);m.isImg||m.attr(x({width:y(k.width),height:y(k.height)},ha));ha=null}};E=function(){var a=k.styles,a=a&&a.textAlign,b=A+r,c;c=h?0:v;if(s(q)&&o&&(a==="center"||a==="right"))b+={center:0.5,right:1}[a]*(q-o.width);if(b!==l.x||c!==l.y)l.attr("x",b),c!==t&&l.attr("y",c);l.x=b;l.y=c};B=function(a,b){m?m.attr(a,b):ha[a]=b};k.onAdd=function(){l.add(k);k.attr({text:a||
a===0?a:"",x:b,y:c});m&&s(e)&&k.attr({anchorX:e,anchorY:f})};k.widthSetter=function(a){q=a};k.heightSetter=function(a){u=a};k.paddingSetter=function(a){if(s(a)&&a!==r)r=k.padding=a,E()};k.paddingLeftSetter=function(a){s(a)&&a!==A&&(A=a,E())};k.alignSetter=function(a){a={left:0,center:0.5,right:1}[a];a!==p&&(p=a,o&&k.attr({x:w}))};k.textSetter=function(a){a!==t&&l.textSetter(a);L();E()};k["stroke-widthSetter"]=function(a,b){a&&(z=!0);R=a%2/2;B(b,a)};k.strokeSetter=k.fillSetter=k.rSetter=function(a,
b){b==="fill"&&a&&(z=!0);B(b,a)};k.anchorXSetter=function(a,b){e=a;B(b,y(a)-R-w)};k.anchorYSetter=function(a,b){f=a;B(b,a-O)};k.xSetter=function(a){k.x=a;p&&(a-=p*((q||o.width)+2*r));w=y(a);k.attr("translateX",w)};k.ySetter=function(a){O=k.y=y(a);k.attr("translateY",O)};var D=k.css;return x(k,{css:function(a){if(a){var b={},a=C(a);n(k.textProps,function(c){a[c]!==t&&(b[c]=a[c],delete a[c])});l.css(b)}return D.call(k,a)},getBBox:function(){return{width:o.width+2*r,height:o.height+2*r,x:o.x-r,y:o.y-
r}},shadow:function(a){m&&m.shadow(a);return k},destroy:function(){T(k.element,"mouseenter");T(k.element,"mouseleave");l&&(l=l.destroy());m&&(m=m.destroy());Z.prototype.destroy.call(k);k=j=L=E=B=null}})}};Ya=ya;x(Z.prototype,{htmlCss:function(a){var b=this.element;if(b=a&&b.tagName==="SPAN"&&a.width)delete a.width,this.textWidth=b,this.updateTransform();if(a&&a.textOverflow==="ellipsis")a.whiteSpace="nowrap",a.overflow="hidden";this.styles=x(this.styles,a);F(this.element,a);return this},htmlGetBBox:function(){var a=
this.element;if(a.nodeName==="text")a.style.position="absolute";return{x:a.offsetLeft,y:a.offsetTop,width:a.offsetWidth,height:a.offsetHeight}},htmlUpdateTransform:function(){if(this.added){var a=this.renderer,b=this.element,c=this.translateX||0,d=this.translateY||0,e=this.x||0,f=this.y||0,g=this.textAlign||"left",h={left:0,center:0.5,right:1}[g],i=this.shadows,j=this.styles;F(b,{marginLeft:c,marginTop:d});i&&n(i,function(a){F(a,{marginLeft:c+1,marginTop:d+1})});this.inverted&&n(b.childNodes,function(c){a.invertChild(c,
b)});if(b.tagName==="SPAN"){var i=this.rotation,k=G(this.textWidth),l=j&&j.whiteSpace,m=[i,g,b.innerHTML,this.textWidth,this.textAlign].join(",");if(m!==this.cTT){j=a.fontMetrics(b.style.fontSize).b;s(i)&&this.setSpanRotation(i,h,j);if(b.offsetWidth>k&&/[ \-]/.test(b.textContent||b.innerText))F(b,{width:k+"px",display:"block",whiteSpace:l||"normal"}),this.hasTextWidth=!0;else if(this.hasTextWidth)F(b,{width:"",display:"",whiteSpace:l||"nowrap"}),this.hasTextWidth=!1;this.getSpanCorrection(this.hasTextWidth?
k:b.offsetWidth,j,h,i,g)}F(b,{left:e+(this.xCorr||0)+"px",top:f+(this.yCorr||0)+"px"});if(tb)j=b.offsetHeight;this.cTT=m}}else this.alignOnAdd=!0},setSpanRotation:function(a,b,c){var d={},e=Ka?"-ms-transform":tb?"-webkit-transform":Xa?"MozTransform":Ub?"-o-transform":"";d[e]=d.transform="rotate("+a+"deg)";d[e+(Xa?"Origin":"-origin")]=d.transformOrigin=b*100+"% "+c+"px";F(this.element,d)},getSpanCorrection:function(a,b,c){this.xCorr=-a*c;this.yCorr=-b}});x(ya.prototype,{html:function(a,b,c){var d=
this.createElement("span"),e=d.element,f=d.renderer,g=f.isSVG,h=function(a,b){n(["opacity","visibility"],function(c){U(a,c+"Setter",function(a,c,d,e){a.call(this,c,d,e);b[d]=c})})};d.textSetter=function(a){a!==e.innerHTML&&delete this.bBox;e.innerHTML=this.textStr=a;d.htmlUpdateTransform()};g&&h(d,d.element.style);d.xSetter=d.ySetter=d.alignSetter=d.rotationSetter=function(a,b){b==="align"&&(b="textAlign");d[b]=a;d.htmlUpdateTransform()};d.attr({text:a,x:y(b),y:y(c)}).css({position:"absolute",fontFamily:this.style.fontFamily,
fontSize:this.style.fontSize});e.style.whiteSpace="nowrap";d.css=d.htmlCss;if(g)d.add=function(a){var b,c=f.box.parentNode,g=[];if(this.parentGroup=a){if(b=a.div,!b){for(;a;)g.push(a),a=a.parentGroup;n(g.reverse(),function(a){var d,e=X(a.element,"class");e&&(e={className:e});b=a.div=a.div||ea(Wa,e,{position:"absolute",left:(a.translateX||0)+"px",top:(a.translateY||0)+"px",opacity:a.opacity},b||c);d=b.style;x(a,{translateXSetter:function(b,c){d.left=b+"px";a[c]=b;a.doTransform=!0},translateYSetter:function(b,
c){d.top=b+"px";a[c]=b;a.doTransform=!0}});h(a,d)})}}else b=c;b.appendChild(e);d.added=!0;d.alignOnAdd&&d.htmlUpdateTransform();return d};return d}});var mb,aa;if(!ja&&!qa)aa={init:function(a,b){var c=["<",b,' filled="f" stroked="f"'],d=["position: ","absolute",";"],e=b===Wa;(b==="shape"||e)&&d.push("left:0;top:0;width:1px;height:1px;");d.push("visibility: ",e?"hidden":"visible");c.push(' style="',d.join(""),'"/>');if(b)c=e||b==="span"||b==="img"?c.join(""):a.prepVML(c),this.element=ea(c);this.renderer=
a},add:function(a){var b=this.renderer,c=this.element,d=b.box,e=a&&a.inverted,d=a?a.element||a:d;if(a)this.parentGroup=a;e&&b.invertChild(c,d);d.appendChild(c);this.added=!0;this.alignOnAdd&&!this.deferUpdateTransform&&this.updateTransform();if(this.onAdd)this.onAdd();return this},updateTransform:Z.prototype.htmlUpdateTransform,setSpanRotation:function(){var a=this.rotation,b=ba(a*pa),c=ka(a*pa);F(this.element,{filter:a?["progid:DXImageTransform.Microsoft.Matrix(M11=",b,", M12=",-c,", M21=",c,", M22=",
b,", sizingMethod='auto expand')"].join(""):"none"})},getSpanCorrection:function(a,b,c,d,e){var f=d?ba(d*pa):1,g=d?ka(d*pa):0,h=q(this.elemHeight,this.element.offsetHeight),i;this.xCorr=f<0&&-a;this.yCorr=g<0&&-h;i=f*g<0;this.xCorr+=g*b*(i?1-c:c);this.yCorr-=f*b*(d?i?c:1-c:1);e&&e!=="left"&&(this.xCorr-=a*c*(f<0?-1:1),d&&(this.yCorr-=h*c*(g<0?-1:1)),F(this.element,{textAlign:e}))},pathToVML:function(a){for(var b=a.length,c=[];b--;)if(ua(a[b]))c[b]=y(a[b]*10)-5;else if(a[b]==="Z")c[b]="x";else if(c[b]=
a[b],a.isArc&&(a[b]==="wa"||a[b]==="at"))c[b+5]===c[b+7]&&(c[b+7]+=a[b+7]>a[b+5]?1:-1),c[b+6]===c[b+8]&&(c[b+8]+=a[b+8]>a[b+6]?1:-1);return c.join(" ")||"x"},clip:function(a){var b=this,c;a?(c=a.members,Aa(c,b),c.push(b),b.destroyClip=function(){Aa(c,b)},a=a.getCSS(b)):(b.destroyClip&&b.destroyClip(),a={clip:sb?"inherit":"rect(auto)"});return b.css(a)},css:Z.prototype.htmlCss,safeRemoveChild:function(a){a.parentNode&&Va(a)},destroy:function(){this.destroyClip&&this.destroyClip();return Z.prototype.destroy.apply(this)},
on:function(a,b){this.element["on"+a]=function(){var a=J.event;a.target=a.srcElement;b(a)};return this},cutOffPath:function(a,b){var c,a=a.split(/[ ,]/);c=a.length;if(c===9||c===11)a[c-4]=a[c-2]=G(a[c-2])-10*b;return a.join(" ")},shadow:function(a,b,c){var d=[],e,f=this.element,g=this.renderer,h,i=f.style,j,k=f.path,l,m,o,p;k&&typeof k.value!=="string"&&(k="x");m=k;if(a){o=q(a.width,3);p=(a.opacity||0.15)/o;for(e=1;e<=3;e++){l=o*2+1-2*e;c&&(m=this.cutOffPath(k.value,l+0.5));j=['<shape isShadow="true" strokeweight="',
l,'" filled="false" path="',m,'" coordsize="10 10" style="',f.style.cssText,'" />'];h=ea(g.prepVML(j),null,{left:G(i.left)+q(a.offsetX,1),top:G(i.top)+q(a.offsetY,1)});if(c)h.cutOff=l+1;j=['<stroke color="',a.color||"black",'" opacity="',p*e,'"/>'];ea(g.prepVML(j),null,null,h);b?b.element.appendChild(h):f.parentNode.insertBefore(h,f);d.push(h)}this.shadows=d}return this},updateShadows:ra,setAttr:function(a,b){sb?this.element[a]=b:this.element.setAttribute(a,b)},classSetter:function(a){this.element.className=
a},dashstyleSetter:function(a,b,c){(c.getElementsByTagName("stroke")[0]||ea(this.renderer.prepVML(["<stroke/>"]),null,null,c))[b]=a||"solid";this[b]=a},dSetter:function(a,b,c){var d=this.shadows,a=a||[];this.d=a.join&&a.join(" ");c.path=a=this.pathToVML(a);if(d)for(c=d.length;c--;)d[c].path=d[c].cutOff?this.cutOffPath(a,d[c].cutOff):a;this.setAttr(b,a)},fillSetter:function(a,b,c){var d=c.nodeName;if(d==="SPAN")c.style.color=a;else if(d!=="IMG")c.filled=a!=="none",this.setAttr("fillcolor",this.renderer.color(a,
c,b,this))},"fill-opacitySetter":function(a,b,c){ea(this.renderer.prepVML(["<",b.split("-")[0],' opacity="',a,'"/>']),null,null,c)},opacitySetter:ra,rotationSetter:function(a,b,c){c=c.style;this[b]=c[b]=a;c.left=-y(ka(a*pa)+1)+"px";c.top=y(ba(a*pa))+"px"},strokeSetter:function(a,b,c){this.setAttr("strokecolor",this.renderer.color(a,c,b,this))},"stroke-widthSetter":function(a,b,c){c.stroked=!!a;this[b]=a;ua(a)&&(a+="px");this.setAttr("strokeweight",a)},titleSetter:function(a,b){this.setAttr(b,a)},
visibilitySetter:function(a,b,c){a==="inherit"&&(a="visible");this.shadows&&n(this.shadows,function(c){c.style[b]=a});c.nodeName==="DIV"&&(a=a==="hidden"?"-999em":0,sb||(c.style[b]=a?"visible":"hidden"),b="top");c.style[b]=a},xSetter:function(a,b,c){this[b]=a;b==="x"?b="left":b==="y"&&(b="top");this.updateClipping?(this[b]=a,this.updateClipping()):c.style[b]=a},zIndexSetter:function(a,b,c){c.style[b]=a}},aa["stroke-opacitySetter"]=aa["fill-opacitySetter"],z.VMLElement=aa=la(Z,aa),aa.prototype.ySetter=
aa.prototype.widthSetter=aa.prototype.heightSetter=aa.prototype.xSetter,aa={Element:aa,isIE8:Ma.indexOf("MSIE 8.0")>-1,init:function(a,b,c,d){var e;this.alignedObjects=[];d=this.createElement(Wa).css(x(this.getStyle(d),{position:"relative"}));e=d.element;a.appendChild(d.element);this.isVML=!0;this.box=e;this.boxWrapper=d;this.gradients={};this.cache={};this.cacheKeys=[];this.imgCount=0;this.setSize(b,c,!1);if(!B.namespaces.hcv){B.namespaces.add("hcv","urn:schemas-microsoft-com:vml");try{B.createStyleSheet().cssText=
"hcv\\:fill, hcv\\:path, hcv\\:shape, hcv\\:stroke{ behavior:url(#default#VML); display: inline-block; } "}catch(f){B.styleSheets[0].cssText+="hcv\\:fill, hcv\\:path, hcv\\:shape, hcv\\:stroke{ behavior:url(#default#VML); display: inline-block; } "}}},isHidden:function(){return!this.box.offsetWidth},clipRect:function(a,b,c,d){var e=this.createElement(),f=da(a);return x(e,{members:[],count:0,left:(f?a.x:a)+1,top:(f?a.y:b)+1,width:(f?a.width:c)-1,height:(f?a.height:d)-1,getCSS:function(a){var b=a.element,
c=b.nodeName,a=a.inverted,d=this.top-(c==="shape"?b.offsetTop:0),e=this.left,b=e+this.width,f=d+this.height,d={clip:"rect("+y(a?e:d)+"px,"+y(a?f:b)+"px,"+y(a?b:f)+"px,"+y(a?d:e)+"px)"};!a&&sb&&c==="DIV"&&x(d,{width:b+"px",height:f+"px"});return d},updateClipping:function(){n(e.members,function(a){a.element&&a.css(e.getCSS(a))})}})},color:function(a,b,c,d){var e=this,f,g=/^rgba/,h,i,j="none";a&&a.linearGradient?i="gradient":a&&a.radialGradient&&(i="pattern");if(i){var k,l,m=a.linearGradient||a.radialGradient,
o,p,r,A,q,u="",a=a.stops,w,O=[],R=function(){h=['<fill colors="'+O.join(",")+'" opacity="',r,'" o:opacity2="',p,'" type="',i,'" ',u,'focus="100%" method="any" />'];ea(e.prepVML(h),null,null,b)};o=a[0];w=a[a.length-1];o[0]>0&&a.unshift([0,o[1]]);w[0]<1&&a.push([1,w[1]]);n(a,function(a,b){g.test(a[1])?(f=wa(a[1]),k=f.get("rgb"),l=f.get("a")):(k=a[1],l=1);O.push(a[0]*100+"% "+k);b?(r=l,A=k):(p=l,q=k)});if(c==="fill")if(i==="gradient")c=m.x1||m[0]||0,a=m.y1||m[1]||0,o=m.x2||m[2]||0,m=m.y2||m[3]||0,u=
'angle="'+(90-Y.atan((m-a)/(o-c))*180/Ba)+'"',R();else{var j=m.r,ha=j*2,s=j*2,v=m.cx,t=m.cy,y=b.radialReference,x,j=function(){y&&(x=d.getBBox(),v+=(y[0]-x.x)/x.width-0.5,t+=(y[1]-x.y)/x.height-0.5,ha*=y[2]/x.width,s*=y[2]/x.height);u='src="'+N.global.VMLRadialGradientURL+'" size="'+ha+","+s+'" origin="0.5,0.5" position="'+v+","+t+'" color2="'+q+'" ';R()};d.added?j():d.onAdd=j;j=A}else j=k}else if(g.test(a)&&b.tagName!=="IMG")f=wa(a),d[c+"-opacitySetter"](f.get("a"),c,b),j=f.get("rgb");else{j=b.getElementsByTagName(c);
if(j.length)j[0].opacity=1,j[0].type="solid";j=a}return j},prepVML:function(a){var b=this.isIE8,a=a.join("");b?(a=a.replace("/>",' xmlns="urn:schemas-microsoft-com:vml" />'),a=a.indexOf('style="')===-1?a.replace("/>",' style="display:inline-block;behavior:url(#default#VML);" />'):a.replace('style="','style="display:inline-block;behavior:url(#default#VML);')):a=a.replace("<","<hcv:");return a},text:ya.prototype.html,path:function(a){var b={coordsize:"10 10"};Ja(a)?b.d=a:da(a)&&x(b,a);return this.createElement("shape").attr(b)},
circle:function(a,b,c){var d=this.symbol("circle");if(da(a))c=a.r,b=a.y,a=a.x;d.isCircle=!0;d.r=c;return d.attr({x:a,y:b})},g:function(a){var b;a&&(b={className:"highcharts-"+a,"class":"highcharts-"+a});return this.createElement(Wa).attr(b)},image:function(a,b,c,d,e){var f=this.createElement("img").attr({src:a});arguments.length>1&&f.attr({x:b,y:c,width:d,height:e});return f},createElement:function(a){return a==="rect"?this.symbol(a):ya.prototype.createElement.call(this,a)},invertChild:function(a,
b){var c=this,d=b.style,e=a.tagName==="IMG"&&a.style;F(a,{flip:"x",left:G(d.width)-(e?G(e.top):1),top:G(d.height)-(e?G(e.left):1),rotation:-90});n(a.childNodes,function(b){c.invertChild(b,a)})},symbols:{arc:function(a,b,c,d,e){var f=e.start,g=e.end,h=e.r||c||d,c=e.innerR,d=ba(f),i=ka(f),j=ba(g),k=ka(g);if(g-f===0)return["x"];f=["wa",a-h,b-h,a+h,b+h,a+h*d,b+h*i,a+h*j,b+h*k];e.open&&!c&&f.push("e","M",a,b);f.push("at",a-c,b-c,a+c,b+c,a+c*j,b+c*k,a+c*d,b+c*i,"x","e");f.isArc=!0;return f},circle:function(a,
b,c,d,e){e&&(c=d=2*e.r);e&&e.isCircle&&(a-=c/2,b-=d/2);return["wa",a,b,a+c,b+d,a+c,b+d/2,a+c,b+d/2,"e"]},rect:function(a,b,c,d,e){return ya.prototype.symbols[!s(e)||!e.r?"square":"callout"].call(0,a,b,c,d,e)}}},z.VMLRenderer=mb=function(){this.init.apply(this,arguments)},mb.prototype=C(ya.prototype,aa),Ya=mb;ya.prototype.measureSpanWidth=function(a,b){var c=B.createElement("span"),d;d=B.createTextNode(a);c.appendChild(d);F(c,b);this.box.appendChild(c);d=c.offsetWidth;Va(c);return d};var Wb;if(qa)z.CanVGRenderer=
aa=function(){Qa="http://www.w3.org/1999/xhtml"},aa.prototype.symbols={},Wb=function(){function a(){var a=b.length,d;for(d=0;d<a;d++)b[d]();b=[]}var b=[];return{push:function(c,d){if(b.length===0){var e=B.getElementsByTagName("head")[0],f=B.createElement("script");f.type="text/javascript";f.src=d;f.onload=a;e.appendChild(f)}b.push(c)}}}(),Ya=aa;cb.prototype={addLabel:function(){var a=this.axis,b=a.options,c=a.chart,d=a.categories,e=a.names,f=this.pos,g=b.labels,h=a.tickPositions,i=f===h[0],j=f===
h[h.length-1],e=d?q(d[f],e[f],f):f,d=this.label,h=h.info,k;a.isDatetimeAxis&&h&&(k=b.dateTimeLabelFormats[h.higherRanks[f]||h.unitName]);this.isFirst=i;this.isLast=j;b=a.labelFormatter.call({axis:a,chart:c,isFirst:i,isLast:j,dateTimeLabelFormat:k,value:a.isLog?na(a.lin2log(e)):e});s(d)?d&&d.attr({text:b}):(this.labelLength=(this.label=d=s(b)&&g.enabled?c.renderer.text(b,0,0,g.useHTML).css(C(g.style)).add(a.labelGroup):null)&&d.getBBox().width,this.rotation=0)},getLabelSize:function(){return this.label?
this.label.getBBox()[this.axis.horiz?"height":"width"]:0},handleOverflow:function(a){var b=this.axis,c=a.x,d=b.chart.chartWidth,e=b.chart.spacing,f=q(b.labelLeft,E(b.pos,e[3])),e=q(b.labelRight,v(b.pos+b.len,d-e[1])),g=this.label,h=this.rotation,i={left:0,center:0.5,right:1}[b.labelAlign],j=g.getBBox().width,k=b.getSlotWidth(),l=k,m=1,o,p={};if(h)h<0&&c-i*j<f?o=y(c/ba(h*pa)-f):h>0&&c+i*j>e&&(o=y((d-c)/ba(h*pa)));else if(d=c+(1-i)*j,c-i*j<f?l=a.x+l*(1-i)-f:d>e&&(l=e-a.x+l*i,m=-1),l=E(k,l),l<k&&b.labelAlign===
"center"&&(a.x+=m*(k-l-i*(k-E(j,l)))),j>l||b.autoRotation&&g.styles.width)o=l;if(o){p.width=o;if(!b.options.labels.style.textOverflow)p.textOverflow="ellipsis";g.css(p)}},getPosition:function(a,b,c,d){var e=this.axis,f=e.chart,g=d&&f.oldChartHeight||f.chartHeight;return{x:a?e.translate(b+c,null,null,d)+e.transB:e.left+e.offset+(e.opposite?(d&&f.oldChartWidth||f.chartWidth)-e.right-e.left:0),y:a?g-e.bottom+e.offset-(e.opposite?e.height:0):g-e.translate(b+c,null,null,d)-e.transB}},getLabelPosition:function(a,
b,c,d,e,f,g,h){var i=this.axis,j=i.transA,k=i.reversed,l=i.staggerLines,m=i.tickRotCorr||{x:0,y:0},o=e.y;s(o)||(o=i.side===0?c.rotation?-8:-c.getBBox().height:i.side===2?m.y+8:ba(c.rotation*pa)*(m.y-c.getBBox(!1,0).height/2));a=a+e.x+m.x-(f&&d?f*j*(k?-1:1):0);b=b+o-(f&&!d?f*j*(k?1:-1):0);l&&(c=g/(h||1)%l,i.opposite&&(c=l-c-1),b+=c*(i.labelOffset/l));return{x:a,y:y(b)}},getMarkPath:function(a,b,c,d,e,f){return f.crispLine(["M",a,b,"L",a+(e?0:-c),b+(e?c:0)],d)},render:function(a,b,c){var d=this.axis,
e=d.options,f=d.chart.renderer,g=d.horiz,h=this.type,i=this.label,j=this.pos,k=e.labels,l=this.gridLine,m=h?h+"Grid":"grid",o=h?h+"Tick":"tick",p=e[m+"LineWidth"],r=e[m+"LineColor"],A=e[m+"LineDashStyle"],m=d.tickSize(o),o=e[o+"Color"],P=this.mark,u=k.step,w=!0,n=d.tickmarkOffset,R=this.getPosition(g,j,n,b),ha=R.x,R=R.y,s=g&&ha===d.pos+d.len||!g&&R===d.pos?-1:1,c=q(c,1);this.isActive=!0;if(p){j=d.getPlotLinePath(j+n,p*s,b,!0);if(l===t){l={stroke:r,"stroke-width":p};if(A)l.dashstyle=A;if(!h)l.zIndex=
1;if(b)l.opacity=0;this.gridLine=l=p?f.path(j).attr(l).add(d.gridGroup):null}if(!b&&l&&j)l[this.isNew?"attr":"animate"]({d:j,opacity:c})}if(m)d.opposite&&(m[0]=-m[0]),h=this.getMarkPath(ha,R,m[0],m[1]*s,g,f),P?P.animate({d:h,opacity:c}):this.mark=f.path(h).attr({stroke:o,"stroke-width":m[1],opacity:c}).add(d.axisGroup);if(i&&!isNaN(ha))i.xy=R=this.getLabelPosition(ha,R,i,g,k,n,a,u),this.isFirst&&!this.isLast&&!q(e.showFirstLabel,1)||this.isLast&&!this.isFirst&&!q(e.showLastLabel,1)?w=!1:g&&!d.isRadial&&
!k.step&&!k.rotation&&!b&&c!==0&&this.handleOverflow(R),u&&a%u&&(w=!1),w&&!isNaN(R.y)?(R.opacity=c,i[this.isNew?"attr":"animate"](R),this.isNew=!1):i.attr("y",-9999)},destroy:function(){Pa(this,this.axis)}};z.PlotLineOrBand=function(a,b){this.axis=a;if(b)this.options=b,this.id=b.id};z.PlotLineOrBand.prototype={render:function(){var a=this,b=a.axis,c=b.horiz,d=a.options,e=d.label,f=a.label,g=d.width,h=d.to,i=d.from,j=s(i)&&s(h),k=d.value,l=d.dashStyle,m=a.svgElem,o=[],p,r=d.color,A=q(d.zIndex,0),n=
d.events,u={},w=b.chart.renderer,o=b.log2lin;b.isLog&&(i=o(i),h=o(h),k=o(k));if(g){if(o=b.getPlotLinePath(k,g),u={stroke:r,"stroke-width":g},l)u.dashstyle=l}else if(j){o=b.getPlotBandPath(i,h,d);if(r)u.fill=r;if(d.borderWidth)u.stroke=d.borderColor,u["stroke-width"]=d.borderWidth}else return;u.zIndex=A;if(m)if(o)m.show(),m.animate({d:o});else{if(m.hide(),f)a.label=f=f.destroy()}else if(o&&o.length&&(a.svgElem=m=w.path(o).attr(u).add(),n))for(p in d=function(b){m.on(b,function(c){n[b].apply(a,[c])})},
n)d(p);e&&s(e.text)&&o&&o.length&&b.width>0&&b.height>0&&!o.flat?(e=C({align:c&&j&&"center",x:c?!j&&4:10,verticalAlign:!c&&j&&"middle",y:c?j?16:10:j?6:-4,rotation:c&&!j&&90},e),this.renderLabel(e,o,j,A)):f&&f.hide();return a},renderLabel:function(a,b,c,d){var e=this.label,f=this.axis.chart.renderer;if(!e)e={align:a.textAlign||a.align,rotation:a.rotation},e.zIndex=d,this.label=e=f.text(a.text,0,0,a.useHTML).attr(e).css(a.style).add();d=[b[1],b[4],c?b[6]:b[1]];b=[b[2],b[5],c?b[7]:b[2]];c=Oa(d);f=Oa(b);
e.align(a,!1,{x:c,y:f,width:Ea(d)-c,height:Ea(b)-f});e.show()},destroy:function(){Aa(this.axis.plotLinesAndBands,this);delete this.axis;Pa(this)}};var I=z.Axis=function(){this.init.apply(this,arguments)};I.prototype={defaultOptions:{dateTimeLabelFormats:{millisecond:"%H:%M:%S.%L",second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%e. %b",week:"%e. %b",month:"%b '%y",year:"%Y"},endOnTick:!1,gridLineColor:"#D8D8D8",labels:{enabled:!0,style:{color:"#606060",cursor:"default",fontSize:"11px"},x:0},lineColor:"#C0D0E0",
lineWidth:1,minPadding:0.01,maxPadding:0.01,minorGridLineColor:"#E0E0E0",minorGridLineWidth:1,minorTickColor:"#A0A0A0",minorTickLength:2,minorTickPosition:"outside",startOfWeek:1,startOnTick:!1,tickColor:"#C0D0E0",tickLength:10,tickmarkPlacement:"between",tickPixelInterval:100,tickPosition:"outside",title:{align:"middle",style:{color:"#707070"}},type:"linear"},defaultYAxisOptions:{endOnTick:!0,gridLineWidth:1,tickPixelInterval:72,showLastLabel:!0,labels:{x:-8},lineWidth:0,maxPadding:0.05,minPadding:0.05,
startOnTick:!0,title:{rotation:270,text:"Values"},stackLabels:{enabled:!1,formatter:function(){return z.numberFormat(this.total,-1)},style:C(W.line.dataLabels.style,{color:"#000000"})}},defaultLeftAxisOptions:{labels:{x:-15},title:{rotation:270}},defaultRightAxisOptions:{labels:{x:15},title:{rotation:90}},defaultBottomAxisOptions:{labels:{autoRotation:[-45],x:0},title:{rotation:0}},defaultTopAxisOptions:{labels:{autoRotation:[-45],x:0},title:{rotation:0}},init:function(a,b){var c=b.isX;this.chart=
a;this.horiz=a.inverted?!c:c;this.coll=(this.isXAxis=c)?"xAxis":"yAxis";this.opposite=b.opposite;this.side=b.side||(this.horiz?this.opposite?0:2:this.opposite?1:3);this.setOptions(b);var d=this.options,e=d.type;this.labelFormatter=d.labels.formatter||this.defaultLabelFormatter;this.userOptions=b;this.minPixelPadding=0;this.reversed=d.reversed;this.visible=d.visible!==!1;this.zoomEnabled=d.zoomEnabled!==!1;this.categories=d.categories||e==="category";this.names=this.names||[];this.isLog=e==="logarithmic";
this.isDatetimeAxis=e==="datetime";this.isLinked=s(d.linkedTo);this.ticks={};this.labelEdge=[];this.minorTicks={};this.plotLinesAndBands=[];this.alternateBands={};this.len=0;this.minRange=this.userMinRange=d.minRange||d.maxZoom;this.range=d.range;this.offset=d.offset||0;this.stacks={};this.oldStacks={};this.stacksTouched=0;this.min=this.max=null;this.crosshair=q(d.crosshair,va(a.options.tooltip.crosshairs)[c?0:1],!1);var f,d=this.options.events;sa(this,a.axes)===-1&&(c&&!this.isColorAxis?a.axes.splice(a.xAxis.length,
0,this):a.axes.push(this),a[this.coll].push(this));this.series=this.series||[];if(a.inverted&&c&&this.reversed===t)this.reversed=!0;this.removePlotLine=this.removePlotBand=this.removePlotBandOrLine;for(f in d)D(this,f,d[f]);if(this.isLog)this.val2lin=this.log2lin,this.lin2val=this.lin2log},setOptions:function(a){this.options=C(this.defaultOptions,this.isXAxis?{}:this.defaultYAxisOptions,[this.defaultTopAxisOptions,this.defaultRightAxisOptions,this.defaultBottomAxisOptions,this.defaultLeftAxisOptions][this.side],
C(N[this.coll],a))},defaultLabelFormatter:function(){var a=this.axis,b=this.value,c=a.categories,d=this.dateTimeLabelFormat,e=N.lang.numericSymbols,f=e&&e.length,g,h=a.options.labels.format,a=a.isLog?b:a.tickInterval;if(h)g=La(h,this);else if(c)g=b;else if(d)g=ma(d,b);else if(f&&a>=1E3)for(;f--&&g===t;)c=Math.pow(1E3,f+1),a>=c&&b*10%c===0&&e[f]!==null&&(g=z.numberFormat(b/c,-1)+e[f]);g===t&&(g=S(b)>=1E4?z.numberFormat(b,-1):z.numberFormat(b,-1,t,""));return g},getSeriesExtremes:function(){var a=this,
b=a.chart;a.hasVisibleSeries=!1;a.dataMin=a.dataMax=a.threshold=null;a.softThreshold=!a.isXAxis;a.buildStacks&&a.buildStacks();n(a.series,function(c){if(c.visible||!b.options.chart.ignoreHiddenSeries){var d=c.options,e=d.threshold,f;a.hasVisibleSeries=!0;a.isLog&&e<=0&&(e=null);if(a.isXAxis){if(d=c.xData,d.length)a.dataMin=E(q(a.dataMin,d[0]),Oa(d)),a.dataMax=v(q(a.dataMax,d[0]),Ea(d))}else{c.getExtremes();f=c.dataMax;c=c.dataMin;if(s(c)&&s(f))a.dataMin=E(q(a.dataMin,c),c),a.dataMax=v(q(a.dataMax,
f),f);if(s(e))a.threshold=e;if(!d.softThreshold||a.isLog)a.softThreshold=!1}}})},translate:function(a,b,c,d,e,f){var g=this.linkedParent||this,h=1,i=0,j=d?g.oldTransA:g.transA,d=d?g.oldMin:g.min,k=g.minPixelPadding,e=(g.isOrdinal||g.isBroken||g.isLog&&e)&&g.lin2val;if(!j)j=g.transA;if(c)h*=-1,i=g.len;g.reversed&&(h*=-1,i-=h*(g.sector||g.len));b?(a=a*h+i,a-=k,a=a/j+d,e&&(a=g.lin2val(a))):(e&&(a=g.val2lin(a)),f==="between"&&(f=0.5),a=h*(a-d)*j+i+h*k+(ua(f)?j*f*g.pointRange:0));return a},toPixels:function(a,
b){return this.translate(a,!1,!this.horiz,null,!0)+(b?0:this.pos)},toValue:function(a,b){return this.translate(a-(b?0:this.pos),!0,!this.horiz,null,!0)},getPlotLinePath:function(a,b,c,d,e){var f=this.chart,g=this.left,h=this.top,i,j,k=c&&f.oldChartHeight||f.chartHeight,l=c&&f.oldChartWidth||f.chartWidth,m;i=this.transB;var o=function(a,b,c){if(a<b||a>c)d?a=E(v(b,a),c):m=!0;return a},e=q(e,this.translate(a,null,null,c)),a=c=y(e+i);i=j=y(k-e-i);isNaN(e)?m=!0:this.horiz?(i=h,j=k-this.bottom,a=c=o(a,
g,g+this.width)):(a=g,c=l-this.right,i=j=o(i,h,h+this.height));return m&&!d?null:f.renderer.crispLine(["M",a,i,"L",c,j],b||1)},getLinearTickPositions:function(a,b,c){var d,e=na(V(b/a)*a),f=na(Fa(c/a)*a),g=[];if(b===c&&ua(b))return[b];for(b=e;b<=f;){g.push(b);b=na(b+a);if(b===d)break;d=b}return g},getMinorTickPositions:function(){var a=this.options,b=this.tickPositions,c=this.minorTickInterval,d=[],e,f=this.pointRangePadding||0;e=this.min-f;var f=this.max+f,g=f-e;if(g&&g/c<this.len/3)if(this.isLog){f=
b.length;for(e=1;e<f;e++)d=d.concat(this.getLogTickPositions(c,b[e-1],b[e],!0))}else if(this.isDatetimeAxis&&a.minorTickInterval==="auto")d=d.concat(this.getTimeTicks(this.normalizeTimeTickInterval(c),e,f,a.startOfWeek));else for(b=e+(b[0]-e)%c;b<=f;b+=c)d.push(b);d.length!==0&&this.trimTicks(d,a.startOnTick,a.endOnTick);return d},adjustForMinRange:function(){var a=this.options,b=this.min,c=this.max,d,e=this.dataMax-this.dataMin>=this.minRange,f,g,h,i,j,k;if(this.isXAxis&&this.minRange===t&&!this.isLog)s(a.min)||
s(a.max)?this.minRange=null:(n(this.series,function(a){i=a.xData;for(g=j=a.xIncrement?1:i.length-1;g>0;g--)if(h=i[g]-i[g-1],f===t||h<f)f=h}),this.minRange=E(f*5,this.dataMax-this.dataMin));if(c-b<this.minRange){k=this.minRange;d=(k-c+b)/2;d=[b-d,q(a.min,b-d)];if(e)d[2]=this.dataMin;b=Ea(d);c=[b+k,q(a.max,b+k)];if(e)c[2]=this.dataMax;c=Oa(c);c-b<k&&(d[0]=c-k,d[1]=q(a.min,c-k),b=Ea(d))}this.min=b;this.max=c},getClosest:function(){var a;n(this.series,function(b){var c=b.closestPointRange;!b.noSharedTooltip&&
s(c)&&(a=s(a)?E(a,c):c)});return a},setAxisTranslation:function(a){var b=this,c=b.max-b.min,d=b.axisPointRange||0,e,f=0,g=0,h=b.linkedParent,i=!!b.categories,j=b.transA,k=b.isXAxis;if(k||i||d)if(h?(f=h.minPointOffset,g=h.pointRangePadding):(e=b.getClosest(),n(b.series,function(a){var c=i?1:k?q(a.options.pointRange,e,0):b.axisPointRange||0,a=a.options.pointPlacement;d=v(d,c);b.single||(f=v(f,Da(a)?0:c/2),g=v(g,a==="on"?0:c))})),h=b.ordinalSlope&&e?b.ordinalSlope/e:1,b.minPointOffset=f*=h,b.pointRangePadding=
g*=h,b.pointRange=E(d,c),k)b.closestPointRange=e;if(a)b.oldTransA=j;b.translationSlope=b.transA=j=b.len/(c+g||1);b.transB=b.horiz?b.left:b.bottom;b.minPixelPadding=j*f},minFromRange:function(){return this.max-this.range},setTickInterval:function(a){var b=this,c=b.chart,d=b.options,e=b.isLog,f=b.log2lin,g=b.isDatetimeAxis,h=b.isXAxis,i=b.isLinked,j=d.maxPadding,k=d.minPadding,l=d.tickInterval,m=d.tickPixelInterval,o=b.categories,p=b.threshold,r=b.softThreshold,A,P,u,w;!g&&!o&&!i&&this.getTickAmount();
u=q(b.userMin,d.min);w=q(b.userMax,d.max);i?(b.linkedParent=c[b.coll][d.linkedTo],c=b.linkedParent.getExtremes(),b.min=q(c.min,c.dataMin),b.max=q(c.max,c.dataMax),d.type!==b.linkedParent.options.type&&ga(11,1)):(!r&&s(p)&&(b.dataMin>=p?(A=p,k=0):b.dataMax<=p&&(P=p,j=0)),b.min=q(u,A,b.dataMin),b.max=q(w,P,b.dataMax));if(e)!a&&E(b.min,q(b.dataMin,b.min))<=0&&ga(10,1),b.min=na(f(b.min),15),b.max=na(f(b.max),15);if(b.range&&s(b.max))b.userMin=b.min=u=v(b.min,b.minFromRange()),b.userMax=w=b.max,b.range=
null;b.beforePadding&&b.beforePadding();b.adjustForMinRange();if(!o&&!b.axisPointRange&&!b.usePercentage&&!i&&s(b.min)&&s(b.max)&&(f=b.max-b.min))!s(u)&&k&&(b.min-=f*k),!s(w)&&j&&(b.max+=f*j);if(ua(d.floor))b.min=v(b.min,d.floor);if(ua(d.ceiling))b.max=E(b.max,d.ceiling);if(r&&s(b.dataMin))if(p=p||0,!s(u)&&b.min<p&&b.dataMin>=p)b.min=p;else if(!s(w)&&b.max>p&&b.dataMax<=p)b.max=p;b.tickInterval=b.min===b.max||b.min===void 0||b.max===void 0?1:i&&!l&&m===b.linkedParent.options.tickPixelInterval?l=b.linkedParent.tickInterval:
q(l,this.tickAmount?(b.max-b.min)/v(this.tickAmount-1,1):void 0,o?1:(b.max-b.min)*m/v(b.len,m));h&&!a&&n(b.series,function(a){a.processData(b.min!==b.oldMin||b.max!==b.oldMax)});b.setAxisTranslation(!0);b.beforeSetTickPositions&&b.beforeSetTickPositions();if(b.postProcessTickInterval)b.tickInterval=b.postProcessTickInterval(b.tickInterval);if(b.pointRange&&!l)b.tickInterval=v(b.pointRange,b.tickInterval);a=q(d.minTickInterval,b.isDatetimeAxis&&b.closestPointRange);if(!l&&b.tickInterval<a)b.tickInterval=
a;if(!g&&!e&&!l)b.tickInterval=Bb(b.tickInterval,null,Ab(b.tickInterval),q(d.allowDecimals,!(b.tickInterval>0.5&&b.tickInterval<5&&b.max>1E3&&b.max<9999)),!!this.tickAmount);if(!this.tickAmount&&this.len)b.tickInterval=b.unsquish();this.setTickPositions()},setTickPositions:function(){var a=this.options,b,c=a.tickPositions,d=a.tickPositioner,e=a.startOnTick,f=a.endOnTick,g;this.tickmarkOffset=this.categories&&a.tickmarkPlacement==="between"&&this.tickInterval===1?0.5:0;this.minorTickInterval=a.minorTickInterval===
"auto"&&this.tickInterval?this.tickInterval/5:a.minorTickInterval;this.tickPositions=b=c&&c.slice();if(!b&&(b=this.isDatetimeAxis?this.getTimeTicks(this.normalizeTimeTickInterval(this.tickInterval,a.units),this.min,this.max,a.startOfWeek,this.ordinalPositions,this.closestPointRange,!0):this.isLog?this.getLogTickPositions(this.tickInterval,this.min,this.max):this.getLinearTickPositions(this.tickInterval,this.min,this.max),b.length>this.len&&(b=[b[0],b.pop()]),this.tickPositions=b,d&&(d=d.apply(this,
[this.min,this.max]))))this.tickPositions=b=d;if(!this.isLinked)this.trimTicks(b,e,f),this.min===this.max&&s(this.min)&&!this.tickAmount&&(g=!0,this.min-=0.5,this.max+=0.5),this.single=g,!c&&!d&&this.adjustTickAmount()},trimTicks:function(a,b,c){var d=a[0],e=a[a.length-1],f=this.minPointOffset||0;if(b)this.min=d;else for(;this.min-f>a[0];)a.shift();if(c)this.max=e;else for(;this.max+f<a[a.length-1];)a.pop();a.length===0&&s(d)&&a.push((e+d)/2)},alignToOthers:function(){var a={},b,c=this.options;this.chart.options.chart.alignTicks!==
!1&&c.alignTicks!==!1&&n(this.chart[this.coll],function(c){var e=c.options,e=[c.horiz?e.left:e.top,e.width,e.height,e.pane].join(",");c.series.length&&(a[e]?b=!0:a[e]=1)});return b},getTickAmount:function(){var a=this.options,b=a.tickAmount,c=a.tickPixelInterval;!s(a.tickInterval)&&this.len<c&&!this.isRadial&&!this.isLog&&a.startOnTick&&a.endOnTick&&(b=2);!b&&this.alignToOthers()&&(b=Fa(this.len/c)+1);if(b<4)this.finalTickAmt=b,b=5;this.tickAmount=b},adjustTickAmount:function(){var a=this.tickInterval,
b=this.tickPositions,c=this.tickAmount,d=this.finalTickAmt,e=b&&b.length;if(e<c){for(;b.length<c;)b.push(na(b[b.length-1]+a));this.transA*=(e-1)/(c-1);this.max=b[b.length-1]}else e>c&&(this.tickInterval*=2,this.setTickPositions());if(s(d)){for(a=c=b.length;a--;)(d===3&&a%2===1||d<=2&&a>0&&a<c-1)&&b.splice(a,1);this.finalTickAmt=t}},setScale:function(){var a,b;this.oldMin=this.min;this.oldMax=this.max;this.oldAxisLength=this.len;this.setAxisSize();b=this.len!==this.oldAxisLength;n(this.series,function(b){if(b.isDirtyData||
b.isDirty||b.xAxis.isDirty)a=!0});if(b||a||this.isLinked||this.forceRedraw||this.userMin!==this.oldUserMin||this.userMax!==this.oldUserMax||this.alignToOthers()){if(this.resetStacks&&this.resetStacks(),this.forceRedraw=!1,this.getSeriesExtremes(),this.setTickInterval(),this.oldUserMin=this.userMin,this.oldUserMax=this.userMax,!this.isDirty)this.isDirty=b||this.min!==this.oldMin||this.max!==this.oldMax}else this.cleanStacks&&this.cleanStacks()},setExtremes:function(a,b,c,d,e){var f=this,g=f.chart,
c=q(c,!0);n(f.series,function(a){delete a.kdTree});e=x(e,{min:a,max:b});M(f,"setExtremes",e,function(){f.userMin=a;f.userMax=b;f.eventArgs=e;c&&g.redraw(d)})},zoom:function(a,b){var c=this.dataMin,d=this.dataMax,e=this.options,f=E(c,q(e.min,c)),e=v(d,q(e.max,d));this.allowZoomOutside||(s(c)&&a<=f&&(a=f),s(d)&&b>=e&&(b=e));this.displayBtn=a!==t||b!==t;this.setExtremes(a,b,!1,t,{trigger:"zoom"});return!0},setAxisSize:function(){var a=this.chart,b=this.options,c=b.offsetLeft||0,d=this.horiz,e=q(b.width,
a.plotWidth-c+(b.offsetRight||0)),f=q(b.height,a.plotHeight),g=q(b.top,a.plotTop),b=q(b.left,a.plotLeft+c),c=/%$/;c.test(f)&&(f=Math.round(parseFloat(f)/100*a.plotHeight));c.test(g)&&(g=Math.round(parseFloat(g)/100*a.plotHeight+a.plotTop));this.left=b;this.top=g;this.width=e;this.height=f;this.bottom=a.chartHeight-f-g;this.right=a.chartWidth-e-b;this.len=v(d?e:f,0);this.pos=d?b:g},getExtremes:function(){var a=this.isLog,b=this.lin2log;return{min:a?na(b(this.min)):this.min,max:a?na(b(this.max)):this.max,
dataMin:this.dataMin,dataMax:this.dataMax,userMin:this.userMin,userMax:this.userMax}},getThreshold:function(a){var b=this.isLog,c=this.lin2log,d=b?c(this.min):this.min,b=b?c(this.max):this.max;a===null?a=b<0?b:d:d>a?a=d:b<a&&(a=b);return this.translate(a,0,1,0,1)},autoLabelAlign:function(a){a=(q(a,0)-this.side*90+720)%360;return a>15&&a<165?"right":a>195&&a<345?"left":"center"},tickSize:function(a){var b=this.options,c=b[a+"Length"],d=q(b[a+"Width"],a==="tick"&&this.isXAxis?1:0);if(d&&c)return b[a+
"Position"]==="inside"&&(c=-c),[c,d]},labelMetrics:function(){return this.chart.renderer.fontMetrics(this.options.labels.style.fontSize,this.ticks[0]&&this.ticks[0].label)},unsquish:function(){var a=this.options.labels,b=this.horiz,c=this.tickInterval,d=c,e=this.len/(((this.categories?1:0)+this.max-this.min)/c),f,g=a.rotation,h=this.labelMetrics(),i,j=Number.MAX_VALUE,k,l=function(a){a/=e||1;a=a>1?Fa(a):1;return a*c};b?(k=!a.staggerLines&&!a.step&&(s(g)?[g]:e<q(a.autoRotationLimit,80)&&a.autoRotation))&&
n(k,function(a){var b;if(a===g||a&&a>=-90&&a<=90)i=l(S(h.h/ka(pa*a))),b=i+S(a/360),b<j&&(j=b,f=a,d=i)}):a.step||(d=l(h.h));this.autoRotation=k;this.labelRotation=q(f,g);return d},getSlotWidth:function(){var a=this.chart,b=this.horiz,c=this.options.labels,d=Math.max(this.tickPositions.length-(this.categories?0:1),1),e=a.margin[3];return b&&(c.step||0)<2&&!c.rotation&&(this.staggerLines||1)*a.plotWidth/d||!b&&(e&&e-a.spacing[3]||a.chartWidth*0.33)},renderUnsquish:function(){var a=this.chart,b=a.renderer,
c=this.tickPositions,d=this.ticks,e=this.options.labels,f=this.horiz,g=this.getSlotWidth(),h=v(1,y(g-2*(e.padding||5))),i={},j=this.labelMetrics(),k=e.style.textOverflow,l,m=0,o,p;if(!Da(e.rotation))i.rotation=e.rotation||0;if(this.autoRotation)n(c,function(a){if((a=d[a])&&a.labelLength>m)m=a.labelLength}),m>h&&m>j.h?i.rotation=this.labelRotation:this.labelRotation=0;else if(g&&(l={width:h+"px"},!k)){l.textOverflow="clip";for(o=c.length;!f&&o--;)if(p=c[o],h=d[p].label)if(h.styles.textOverflow==="ellipsis"?
h.css({textOverflow:"clip"}):d[p].labelLength>g&&h.css({width:g+"px"}),h.getBBox().height>this.len/c.length-(j.h-j.f))h.specCss={textOverflow:"ellipsis"}}if(i.rotation&&(l={width:(m>a.chartHeight*0.5?a.chartHeight*0.33:a.chartHeight)+"px"},!k))l.textOverflow="ellipsis";if(this.labelAlign=e.align||this.autoLabelAlign(this.labelRotation))i.align=this.labelAlign;n(c,function(a){var b=(a=d[a])&&a.label;if(b)b.attr(i),l&&b.css(C(l,b.specCss)),delete b.specCss,a.rotation=i.rotation});this.tickRotCorr=b.rotCorr(j.b,
this.labelRotation||0,this.side!==0)},hasData:function(){return this.hasVisibleSeries||s(this.min)&&s(this.max)&&!!this.tickPositions},getOffset:function(){var a=this,b=a.chart,c=b.renderer,d=a.options,e=a.tickPositions,f=a.ticks,g=a.horiz,h=a.side,i=b.inverted?[1,0,3,2][h]:h,j,k,l=0,m,o=0,p=d.title,r=d.labels,A=0,P=a.opposite,u=b.axisOffset,b=b.clipOffset,w=[-1,1,1,-1][h],O,R=a.axisParent,ha=this.tickSize("tick");j=a.hasData();a.showAxis=k=j||q(d.showEmpty,!0);a.staggerLines=a.horiz&&r.staggerLines;
if(!a.axisGroup)a.gridGroup=c.g("grid").attr({zIndex:d.gridZIndex||1}).add(R),a.axisGroup=c.g("axis").attr({zIndex:d.zIndex||2}).add(R),a.labelGroup=c.g("axis-labels").attr({zIndex:r.zIndex||7}).addClass("highcharts-"+a.coll.toLowerCase()+"-labels").add(R);if(j||a.isLinked){if(n(e,function(b){f[b]?f[b].addLabel():f[b]=new cb(a,b)}),a.renderUnsquish(),r.reserveSpace!==!1&&(h===0||h===2||{1:"left",3:"right"}[h]===a.labelAlign||a.labelAlign==="center")&&n(e,function(a){A=v(f[a].getLabelSize(),A)}),a.staggerLines)A*=
a.staggerLines,a.labelOffset=A*(a.opposite?-1:1)}else for(O in f)f[O].destroy(),delete f[O];if(p&&p.text&&p.enabled!==!1){if(!a.axisTitle)a.axisTitle=c.text(p.text,0,0,p.useHTML).attr({zIndex:7,rotation:p.rotation||0,align:p.textAlign||{low:P?"right":"left",middle:"center",high:P?"left":"right"}[p.align]}).addClass("highcharts-"+this.coll.toLowerCase()+"-title").css(p.style).add(a.axisGroup),a.axisTitle.isNew=!0;if(k)l=a.axisTitle.getBBox()[g?"height":"width"],m=p.offset,o=s(m)?0:q(p.margin,g?5:10);
a.axisTitle[k?"show":"hide"](!0)}a.offset=w*q(d.offset,u[h]);a.tickRotCorr=a.tickRotCorr||{x:0,y:0};c=h===0?-a.labelMetrics().h:h===2?a.tickRotCorr.y:0;o=Math.abs(A)+o;A&&(o-=c,o+=w*(g?q(r.y,a.tickRotCorr.y+w*8):r.x));a.axisTitleMargin=q(m,o);u[h]=v(u[h],a.axisTitleMargin+l+w*a.offset,o,j&&e.length&&ha?ha[0]:0);d=d.offset?0:V(d.lineWidth/2)*2;b[i]=v(b[i],d)},getLinePath:function(a){var b=this.chart,c=this.opposite,d=this.offset,e=this.horiz,f=this.left+(c?this.width:0)+d,d=b.chartHeight-this.bottom-
(c?this.height:0)+d;c&&(a*=-1);return b.renderer.crispLine(["M",e?this.left:f,e?d:this.top,"L",e?b.chartWidth-this.right:f,e?d:b.chartHeight-this.bottom],a)},getTitlePosition:function(){var a=this.horiz,b=this.left,c=this.top,d=this.len,e=this.options.title,f=a?b:c,g=this.opposite,h=this.offset,i=e.x||0,j=e.y||0,k=G(e.style.fontSize||12),d={low:f+(a?0:d),middle:f+d/2,high:f+(a?d:0)}[e.align],b=(a?c+this.height:b)+(a?1:-1)*(g?-1:1)*this.axisTitleMargin+(this.side===2?k:0);return{x:a?d+i:b+(g?this.width:
0)+h+i,y:a?b+j-(g?this.height:0)+h:d+j}},render:function(){var a=this,b=a.chart,c=b.renderer,d=a.options,e=a.isLog,f=a.lin2log,g=a.isLinked,h=a.tickPositions,i=a.axisTitle,j=a.ticks,k=a.minorTicks,l=a.alternateBands,m=d.stackLabels,o=d.alternateGridColor,p=a.tickmarkOffset,r=d.lineWidth,A,q=b.hasRendered&&s(a.oldMin)&&!isNaN(a.oldMin),u=a.showAxis,w=hb(c.globalAnimation),O,R;a.labelEdge.length=0;a.overlap=!1;n([j,k,l],function(a){for(var b in a)a[b].isActive=!1});if(a.hasData()||g){a.minorTickInterval&&
!a.categories&&n(a.getMinorTickPositions(),function(b){k[b]||(k[b]=new cb(a,b,"minor"));q&&k[b].isNew&&k[b].render(null,!0);k[b].render(null,!1,1)});if(h.length&&(n(h,function(b,c){if(!g||b>=a.min&&b<=a.max)j[b]||(j[b]=new cb(a,b)),q&&j[b].isNew&&j[b].render(c,!0,0.1),j[b].render(c)}),p&&(a.min===0||a.single)))j[-1]||(j[-1]=new cb(a,-1,null,!0)),j[-1].render(-1);o&&n(h,function(c,d){R=h[d+1]!==t?h[d+1]+p:a.max-p;if(d%2===0&&c<a.max&&R<=a.max+(b.polar?-p:p))l[c]||(l[c]=new z.PlotLineOrBand(a)),O=c+
p,l[c].options={from:e?f(O):O,to:e?f(R):R,color:o},l[c].render(),l[c].isActive=!0});if(!a._addedPlotLB)n((d.plotLines||[]).concat(d.plotBands||[]),function(b){a.addPlotBandOrLine(b)}),a._addedPlotLB=!0}n([j,k,l],function(a){var c,d,e=[],f=w.duration;for(c in a)if(!a[c].isActive)a[c].render(c,!1,0),a[c].isActive=!1,e.push(c);$a(function(){for(d=e.length;d--;)a[e[d]]&&!a[e[d]].isActive&&(a[e[d]].destroy(),delete a[e[d]])},a===l||!b.hasRendered||!f?0:f)});if(r)A=a.getLinePath(r),a.axisLine?a.axisLine.animate({d:A}):
a.axisLine=c.path(A).attr({stroke:d.lineColor,"stroke-width":r,zIndex:7}).add(a.axisGroup),a.axisLine[u?"show":"hide"](!0);if(i&&u)i[i.isNew?"attr":"animate"](a.getTitlePosition()),i.isNew=!1;m&&m.enabled&&a.renderStackTotals();a.isDirty=!1},redraw:function(){this.visible&&(this.render(),n(this.plotLinesAndBands,function(a){a.render()}));n(this.series,function(a){a.isDirty=!0})},destroy:function(a){var b=this,c=b.stacks,d,e=b.plotLinesAndBands;a||T(b);for(d in c)Pa(c[d]),c[d]=null;n([b.ticks,b.minorTicks,
b.alternateBands],function(a){Pa(a)});for(a=e.length;a--;)e[a].destroy();n("stackTotalGroup,axisLine,axisTitle,axisGroup,cross,gridGroup,labelGroup".split(","),function(a){b[a]&&(b[a]=b[a].destroy())});this.cross&&this.cross.destroy()},drawCrosshair:function(a,b){var c,d=this.crosshair,e,f;if(!this.crosshair||(s(b)||!q(d.snap,!0))===!1)this.hideCrosshair();else if(q(d.snap,!0)?s(b)&&(c=this.isXAxis?b.plotX:this.len-b.plotY):c=this.horiz?a.chartX-this.pos:this.len-a.chartY+this.pos,c=this.isRadial?
this.getPlotLinePath(this.isXAxis?b.x:q(b.stackY,b.y))||null:this.getPlotLinePath(null,null,null,null,c)||null,c===null)this.hideCrosshair();else if(e=this.categories&&!this.isRadial,f=q(d.width,e?this.transA:1),this.cross)this.cross.attr({d:c,visibility:"visible","stroke-width":f});else{e={"stroke-width":f,stroke:d.color||(e?"rgba(155,200,255,0.2)":"#C0C0C0"),zIndex:q(d.zIndex,2)};if(d.dashStyle)e.dashstyle=d.dashStyle;this.cross=this.chart.renderer.path(c).attr(e).add()}},hideCrosshair:function(){this.cross&&
this.cross.hide()}};x(I.prototype,{getPlotBandPath:function(a,b){var c=this.getPlotLinePath(b,null,null,!0),d=this.getPlotLinePath(a,null,null,!0);d&&c?(d.flat=d.toString()===c.toString(),d.push(c[4],c[5],c[1],c[2])):d=null;return d},addPlotBand:function(a){return this.addPlotBandOrLine(a,"plotBands")},addPlotLine:function(a){return this.addPlotBandOrLine(a,"plotLines")},addPlotBandOrLine:function(a,b){var c=(new z.PlotLineOrBand(this,a)).render(),d=this.userOptions;c&&(b&&(d[b]=d[b]||[],d[b].push(a)),
this.plotLinesAndBands.push(c));return c},removePlotBandOrLine:function(a){for(var b=this.plotLinesAndBands,c=this.options,d=this.userOptions,e=b.length;e--;)b[e].id===a&&b[e].destroy();n([c.plotLines||[],d.plotLines||[],c.plotBands||[],d.plotBands||[]],function(b){for(e=b.length;e--;)b[e].id===a&&Aa(b,b[e])})}});I.prototype.getTimeTicks=function(a,b,c,d){var e=[],f={},g=N.global.useUTC,h,i=new fa(b-fb(b)),j=a.unitRange,k=a.count;if(s(b)){i[Pb](j>=H.second?0:k*V(i.getMilliseconds()/k));if(j>=H.second)i[Qb](j>=
H.minute?0:k*V(i.getSeconds()/k));if(j>=H.minute)i[Rb](j>=H.hour?0:k*V(i[Cb]()/k));if(j>=H.hour)i[Sb](j>=H.day?0:k*V(i[Db]()/k));if(j>=H.day)i[rb](j>=H.month?1:k*V(i[bb]()/k));j>=H.month&&(i[Fb](j>=H.year?0:k*V(i[ib]()/k)),h=i[jb]());j>=H.year&&(h-=h%k,i[Gb](h));if(j===H.week)i[rb](i[bb]()-i[Eb]()+q(d,1));b=1;if(zb||gb)i=i.getTime(),i=new fa(i+fb(i));h=i[jb]();for(var d=i.getTime(),l=i[ib](),m=i[bb](),o=!g||!!gb,p=(H.day+(g?fb(i):i.getTimezoneOffset()*6E4))%H.day;d<c;)e.push(d),j===H.year?d=qb(h+
b*k,0):j===H.month?d=qb(h,l+b*k):o&&(j===H.day||j===H.week)?d=qb(h,l,m+b*k*(j===H.day?1:7)):d+=j*k,b++;e.push(d);n(Sa(e,function(a){return j<=H.hour&&a%H.day===p}),function(a){f[a]="day"})}e.info=x(a,{higherRanks:f,totalRange:j*k});return e};I.prototype.normalizeTimeTickInterval=function(a,b){var c=b||[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1,2]],["week",[1,2]],["month",[1,2,3,4,6]],["year",null]],d=
c[c.length-1],e=H[d[0]],f=d[1],g;for(g=0;g<c.length;g++)if(d=c[g],e=H[d[0]],f=d[1],c[g+1]&&a<=(e*f[f.length-1]+H[c[g+1][0]])/2)break;e===H.year&&a<5*e&&(f=[1,2,5]);c=Bb(a/e,f,d[0]==="year"?v(Ab(a/e),1):1);return{unitRange:e,count:c,unitName:d[0]}};I.prototype.getLogTickPositions=function(a,b,c,d){var e=this.options,f=this.len,g=this.lin2log,h=this.log2lin,i=[];if(!d)this._minorAutoInterval=null;if(a>=0.5)a=y(a),i=this.getLinearTickPositions(a,b,c);else if(a>=0.08)for(var f=V(b),j,k,l,m,o,e=a>0.3?
[1,2,4]:a>0.15?[1,2,4,6,8]:[1,2,3,4,5,6,7,8,9];f<c+1&&!o;f++){k=e.length;for(j=0;j<k&&!o;j++)l=h(g(f)*e[j]),l>b&&(!d||m<=c)&&m!==t&&i.push(m),m>c&&(o=!0),m=l}else if(b=g(b),c=g(c),a=e[d?"minorTickInterval":"tickInterval"],a=q(a==="auto"?null:a,this._minorAutoInterval,(c-b)*(e.tickPixelInterval/(d?5:1))/((d?f/this.tickPositions.length:f)||1)),a=Bb(a,null,Ab(a)),i=ta(this.getLinearTickPositions(a,b,c),h),!d)this._minorAutoInterval=a/5;if(!d)this.tickInterval=a;return i};I.prototype.log2lin=function(a){return Y.log(a)/
Y.LN10};I.prototype.lin2log=function(a){return Y.pow(10,a)};var Lb=z.Tooltip=function(){this.init.apply(this,arguments)};Lb.prototype={init:function(a,b){var c=b.borderWidth,d=b.style,e=G(d.padding);this.chart=a;this.options=b;this.crosshairs=[];this.now={x:0,y:0};this.isHidden=!0;this.label=a.renderer.label("",0,0,b.shape||"callout",null,null,b.useHTML,null,"tooltip").attr({padding:e,fill:b.backgroundColor,"stroke-width":c,r:b.borderRadius,zIndex:8}).css(d).css({padding:0}).add().attr({y:-9999});
qa||this.label.shadow(b.shadow);this.shared=b.shared},destroy:function(){if(this.label)this.label=this.label.destroy();clearTimeout(this.hideTimer);clearTimeout(this.tooltipTimeout)},move:function(a,b,c,d){var e=this,f=e.now,g=e.options.animation!==!1&&!e.isHidden&&(S(a-f.x)>1||S(b-f.y)>1),h=e.followPointer||e.len>1;x(f,{x:g?(2*f.x+a)/3:a,y:g?(f.y+b)/2:b,anchorX:h?t:g?(2*f.anchorX+c)/3:c,anchorY:h?t:g?(f.anchorY+d)/2:d});e.label.attr(f);if(g)clearTimeout(this.tooltipTimeout),this.tooltipTimeout=setTimeout(function(){e&&
e.move(a,b,c,d)},32)},hide:function(a){var b=this;clearTimeout(this.hideTimer);a=q(a,this.options.hideDelay,500);if(!this.isHidden)this.hideTimer=$a(function(){b.label[a?"fadeOut":"hide"]();b.isHidden=!0},a)},getAnchor:function(a,b){var c,d=this.chart,e=d.inverted,f=d.plotTop,g=d.plotLeft,h=0,i=0,j,k,a=va(a);c=a[0].tooltipPos;this.followPointer&&b&&(b.chartX===t&&(b=d.pointer.normalize(b)),c=[b.chartX-d.plotLeft,b.chartY-f]);c||(n(a,function(a){j=a.series.yAxis;k=a.series.xAxis;h+=a.plotX+(!e&&k?
k.left-g:0);i+=(a.plotLow?(a.plotLow+a.plotHigh)/2:a.plotY)+(!e&&j?j.top-f:0)}),h/=a.length,i/=a.length,c=[e?d.plotWidth-i:h,this.shared&&!e&&a.length>1&&b?b.chartY-f:e?d.plotHeight-h:i]);return ta(c,y)},getPosition:function(a,b,c){var d=this.chart,e=this.distance,f={},g=c.h||0,h,i=["y",d.chartHeight,b,c.plotY+d.plotTop,d.plotTop,d.plotTop+d.plotHeight],j=["x",d.chartWidth,a,c.plotX+d.plotLeft,d.plotLeft,d.plotLeft+d.plotWidth],k=!this.followPointer&&q(c.ttBelow,!d.inverted===!!c.negative),l=function(a,
b,c,d,h,i){var j=c<d-e,m=d+e+c<b,l=d-e-c;d+=e;if(k&&m)f[a]=d;else if(!k&&j)f[a]=l;else if(j)f[a]=E(i-c,l-g<0?l:l-g);else if(m)f[a]=v(h,d+g+c>b?d:d+g);else return!1},m=function(a,b,c,d){var g;d<e||d>b-e?g=!1:f[a]=d<c/2?1:d>b-c/2?b-c-2:d-c/2;return g},o=function(a){var b=i;i=j;j=b;h=a},p=function(){l.apply(0,i)!==!1?m.apply(0,j)===!1&&!h&&(o(!0),p()):h?f.x=f.y=0:(o(!0),p())};(d.inverted||this.len>1)&&o();p();return f},defaultFormatter:function(a){var b=this.points||va(this),c;c=[a.tooltipFooterHeaderFormatter(b[0])];
c=c.concat(a.bodyFormatter(b));c.push(a.tooltipFooterHeaderFormatter(b[0],!0));return c.join("")},refresh:function(a,b){var c=this.chart,d=this.label,e=this.options,f,g,h,i={},j,k=[];j=e.formatter||this.defaultFormatter;var i=c.hoverPoints,l,m=this.shared;clearTimeout(this.hideTimer);this.followPointer=va(a)[0].series.tooltipOptions.followPointer;h=this.getAnchor(a,b);f=h[0];g=h[1];m&&(!a.series||!a.series.noSharedTooltip)?(c.hoverPoints=a,i&&n(i,function(a){a.setState()}),n(a,function(a){a.setState("hover");
k.push(a.getLabelConfig())}),i={x:a[0].category,y:a[0].y},i.points=k,this.len=k.length,a=a[0]):i=a.getLabelConfig();j=j.call(i,this);i=a.series;this.distance=q(i.tooltipOptions.distance,16);j===!1?this.hide():(this.isHidden&&(Ta(d),d.attr("opacity",1).show()),d.attr({text:j}),l=e.borderColor||a.color||i.color||"#606060",d.attr({stroke:l}),this.updatePosition({plotX:f,plotY:g,negative:a.negative,ttBelow:a.ttBelow,h:h[2]||0}),this.isHidden=!1);M(c,"tooltipRefresh",{text:j,x:f+c.plotLeft,y:g+c.plotTop,
borderColor:l})},updatePosition:function(a){var b=this.chart,c=this.label,c=(this.options.positioner||this.getPosition).call(this,c.width,c.height,a);this.move(y(c.x),y(c.y||0),a.plotX+b.plotLeft,a.plotY+b.plotTop)},getXDateFormat:function(a,b,c){var d,b=b.dateTimeLabelFormats,e=c&&c.closestPointRange,f,g={millisecond:15,second:12,minute:9,hour:6,day:3},h,i="millisecond";if(e){h=ma("%m-%d %H:%M:%S.%L",a.x);for(f in H){if(e===H.week&&+ma("%w",a.x)===c.options.startOfWeek&&h.substr(6)==="00:00:00.000"){f=
"week";break}if(H[f]>e){f=i;break}if(g[f]&&h.substr(g[f])!=="01-01 00:00:00.000".substr(g[f]))break;f!=="week"&&(i=f)}f&&(d=b[f])}else d=b.day;return d||b.year},tooltipFooterHeaderFormatter:function(a,b){var c=b?"footer":"header",d=a.series,e=d.tooltipOptions,f=e.xDateFormat,g=d.xAxis,h=g&&g.options.type==="datetime"&&ua(a.key),c=e[c+"Format"];h&&!f&&(f=this.getXDateFormat(a,e,g));h&&f&&(c=c.replace("{point.key}","{point.key:"+f+"}"));return La(c,{point:a,series:d})},bodyFormatter:function(a){return ta(a,
function(a){var c=a.series.tooltipOptions;return(c.pointFormatter||a.point.tooltipFormatter).call(a.point,c.pointFormat)})}};var oa;db=B&&B.documentElement.ontouchstart!==t;var Za=z.Pointer=function(a,b){this.init(a,b)};Za.prototype={init:function(a,b){var c=b.chart,d=c.events,e=qa?"":c.zoomType,c=a.inverted,f;this.options=b;this.chart=a;this.zoomX=f=/x/.test(e);this.zoomY=e=/y/.test(e);this.zoomHor=f&&!c||e&&c;this.zoomVert=e&&!c||f&&c;this.hasZoom=f||e;this.runChartClick=d&&!!d.click;this.pinchDown=
[];this.lastValidTouch={};if(z.Tooltip&&b.tooltip.enabled)a.tooltip=new Lb(a,b.tooltip),this.followTouchMove=q(b.tooltip.followTouchMove,!0);this.setDOMEvents()},normalize:function(a,b){var c,d,a=a||J.event;if(!a.target)a.target=a.srcElement;d=a.touches?a.touches.length?a.touches.item(0):a.changedTouches[0]:a;if(!b)this.chartPosition=b=Kb(this.chart.container);d.pageX===t?(c=v(a.x,a.clientX-b.left),d=a.y):(c=d.pageX-b.left,d=d.pageY-b.top);return x(a,{chartX:y(c),chartY:y(d)})},getCoordinates:function(a){var b=
{xAxis:[],yAxis:[]};n(this.chart.axes,function(c){b[c.isXAxis?"xAxis":"yAxis"].push({axis:c,value:c.toValue(a[c.horiz?"chartX":"chartY"])})});return b},runPointActions:function(a){var b=this.chart,c=b.series,d=b.tooltip,e=d?d.shared:!1,f=b.hoverPoint,g=b.hoverSeries,h,i=[Number.MAX_VALUE,Number.MAX_VALUE],j,k,l=[],m=[],o;if(!e&&!g)for(h=0;h<c.length;h++)if(c[h].directTouch||!c[h].options.stickyTracking)c=[];g&&(e?g.noSharedTooltip:g.directTouch)&&f?m=[f]:(n(c,function(b){j=b.noSharedTooltip&&e;k=
!e&&b.directTouch;b.visible&&!j&&!k&&q(b.options.enableMouseTracking,!0)&&(o=b.searchPoint(a,!j&&b.kdDimensions===1))&&l.push(o)}),n(l,function(a){a&&n(["dist","distX"],function(b,c){if(typeof a[b]==="number"){var d=a[b]===i[c]&&a.series.group.zIndex>=m[c].series.group.zIndex;if(a[b]<i[c]||d)i[c]=a[b],m[c]=a}})}));if(e)for(h=l.length;h--;)(l[h].clientX!==m[1].clientX||l[h].series.noSharedTooltip)&&l.splice(h,1);if(m[0]&&(m[0]!==this.prevKDPoint||d&&d.isHidden))if(e&&!m[0].series.noSharedTooltip)l.length&&
d&&d.refresh(l,a),n(l,function(b){b.onMouseOver(a,b!==(g&&g.directTouch&&f||m[0]))}),this.prevKDPoint=m[1];else{d&&d.refresh(m[0],a);if(!g||!g.directTouch)m[0].onMouseOver(a);this.prevKDPoint=m[0]}else c=g&&g.tooltipOptions.followPointer,d&&c&&!d.isHidden&&(c=d.getAnchor([{}],a),d.updatePosition({plotX:c[0],plotY:c[1]}));if(!this._onDocumentMouseMove)this._onDocumentMouseMove=function(a){if($[oa])$[oa].pointer.onDocumentMouseMove(a)},D(B,"mousemove",this._onDocumentMouseMove);n(e?l:[q(m[1],f)],function(c){n(b.axes,
function(b){(!c||c.series[b.coll]===b)&&b.drawCrosshair(a,c)})})},reset:function(a,b){var c=this.chart,d=c.hoverSeries,e=c.hoverPoint,f=c.hoverPoints,g=c.tooltip,h=g&&g.shared?f:e;a&&h&&n(va(h),function(b){b.series.isCartesian&&b.plotX===void 0&&(a=!1)});if(a)g&&h&&(g.refresh(h),e&&(e.setState(e.state,!0),n(c.axes,function(a){q(a.crosshair&&a.crosshair.snap,!0)?a.drawCrosshair(null,e):a.hideCrosshair()})));else{if(e)e.onMouseOut();f&&n(f,function(a){a.setState()});if(d)d.onMouseOut();g&&g.hide(b);
if(this._onDocumentMouseMove)T(B,"mousemove",this._onDocumentMouseMove),this._onDocumentMouseMove=null;n(c.axes,function(a){a.hideCrosshair()});this.hoverX=c.hoverPoints=c.hoverPoint=null}},scaleGroups:function(a,b){var c=this.chart,d;n(c.series,function(e){d=a||e.getPlotBox();e.xAxis&&e.xAxis.zoomEnabled&&(e.group.attr(d),e.markerGroup&&(e.markerGroup.attr(d),e.markerGroup.clip(b?c.clipRect:null)),e.dataLabelsGroup&&e.dataLabelsGroup.attr(d))});c.clipRect.attr(b||c.clipBox)},dragStart:function(a){var b=
this.chart;b.mouseIsDown=a.type;b.cancelClick=!1;b.mouseDownX=this.mouseDownX=a.chartX;b.mouseDownY=this.mouseDownY=a.chartY},drag:function(a){var b=this.chart,c=b.options.chart,d=a.chartX,e=a.chartY,f=this.zoomHor,g=this.zoomVert,h=b.plotLeft,i=b.plotTop,j=b.plotWidth,k=b.plotHeight,l,m=this.selectionMarker,o=this.mouseDownX,p=this.mouseDownY,r=c.panKey&&a[c.panKey+"Key"];if(!m||!m.touch)if(d<h?d=h:d>h+j&&(d=h+j),e<i?e=i:e>i+k&&(e=i+k),this.hasDragged=Math.sqrt(Math.pow(o-d,2)+Math.pow(p-e,2)),this.hasDragged>
10){l=b.isInsidePlot(o-h,p-i);if(b.hasCartesianSeries&&(this.zoomX||this.zoomY)&&l&&!r&&!m)this.selectionMarker=m=b.renderer.rect(h,i,f?1:j,g?1:k,0).attr({fill:c.selectionMarkerFill||"rgba(69,114,167,0.25)",zIndex:7}).add();m&&f&&(d-=o,m.attr({width:S(d),x:(d>0?0:d)+o}));m&&g&&(d=e-p,m.attr({height:S(d),y:(d>0?0:d)+p}));l&&!m&&c.panning&&b.pan(a,c.panning)}},drop:function(a){var b=this,c=this.chart,d=this.hasPinched;if(this.selectionMarker){var e={originalEvent:a,xAxis:[],yAxis:[]},f=this.selectionMarker,
g=f.attr?f.attr("x"):f.x,h=f.attr?f.attr("y"):f.y,i=f.attr?f.attr("width"):f.width,j=f.attr?f.attr("height"):f.height,k;if(this.hasDragged||d)n(c.axes,function(c){if(c.zoomEnabled&&s(c.min)&&(d||b[{xAxis:"zoomX",yAxis:"zoomY"}[c.coll]])){var f=c.horiz,o=a.type==="touchend"?c.minPixelPadding:0,p=c.toValue((f?g:h)+o),f=c.toValue((f?g+i:h+j)-o);e[c.coll].push({axis:c,min:E(p,f),max:v(p,f)});k=!0}}),k&&M(c,"selection",e,function(a){c.zoom(x(a,d?{animation:!1}:null))});this.selectionMarker=this.selectionMarker.destroy();
d&&this.scaleGroups()}if(c)F(c.container,{cursor:c._cursor}),c.cancelClick=this.hasDragged>10,c.mouseIsDown=this.hasDragged=this.hasPinched=!1,this.pinchDown=[]},onContainerMouseDown:function(a){a=this.normalize(a);a.preventDefault&&a.preventDefault();this.dragStart(a)},onDocumentMouseUp:function(a){$[oa]&&$[oa].pointer.drop(a)},onDocumentMouseMove:function(a){var b=this.chart,c=this.chartPosition,a=this.normalize(a,c);c&&!this.inClass(a.target,"highcharts-tracker")&&!b.isInsidePlot(a.chartX-b.plotLeft,
a.chartY-b.plotTop)&&this.reset()},onContainerMouseLeave:function(a){var b=$[oa];if(b&&(a.relatedTarget||a.toElement))b.pointer.reset(),b.pointer.chartPosition=null},onContainerMouseMove:function(a){var b=this.chart;if(!s(oa)||!$[oa]||!$[oa].mouseIsDown)oa=b.index;a=this.normalize(a);a.returnValue=!1;b.mouseIsDown==="mousedown"&&this.drag(a);(this.inClass(a.target,"highcharts-tracker")||b.isInsidePlot(a.chartX-b.plotLeft,a.chartY-b.plotTop))&&!b.openMenu&&this.runPointActions(a)},inClass:function(a,
b){for(var c;a;){if(c=X(a,"class")){if(c.indexOf(b)!==-1)return!0;if(c.indexOf("highcharts-container")!==-1)return!1}a=a.parentNode}},onTrackerMouseOut:function(a){var b=this.chart.hoverSeries,a=a.relatedTarget||a.toElement;if(b&&a&&!b.options.stickyTracking&&!this.inClass(a,"highcharts-tooltip")&&!this.inClass(a,"highcharts-series-"+b.index))b.onMouseOut()},onContainerClick:function(a){var b=this.chart,c=b.hoverPoint,d=b.plotLeft,e=b.plotTop,a=this.normalize(a);b.cancelClick||(c&&this.inClass(a.target,
"highcharts-tracker")?(M(c.series,"click",x(a,{point:c})),b.hoverPoint&&c.firePointEvent("click",a)):(x(a,this.getCoordinates(a)),b.isInsidePlot(a.chartX-d,a.chartY-e)&&M(b,"click",a)))},setDOMEvents:function(){var a=this,b=a.chart.container;b.onmousedown=function(b){a.onContainerMouseDown(b)};b.onmousemove=function(b){a.onContainerMouseMove(b)};b.onclick=function(b){a.onContainerClick(b)};D(b,"mouseleave",a.onContainerMouseLeave);lb===1&&D(B,"mouseup",a.onDocumentMouseUp);if(db)b.ontouchstart=function(b){a.onContainerTouchStart(b)},
b.ontouchmove=function(b){a.onContainerTouchMove(b)},lb===1&&D(B,"touchend",a.onDocumentTouchEnd)},destroy:function(){var a;T(this.chart.container,"mouseleave",this.onContainerMouseLeave);lb||(T(B,"mouseup",this.onDocumentMouseUp),T(B,"touchend",this.onDocumentTouchEnd));clearInterval(this.tooltipTimeout);for(a in this)this[a]=null}};x(z.Pointer.prototype,{pinchTranslate:function(a,b,c,d,e,f){(this.zoomHor||this.pinchHor)&&this.pinchTranslateDirection(!0,a,b,c,d,e,f);(this.zoomVert||this.pinchVert)&&
this.pinchTranslateDirection(!1,a,b,c,d,e,f)},pinchTranslateDirection:function(a,b,c,d,e,f,g,h){var i=this.chart,j=a?"x":"y",k=a?"X":"Y",l="chart"+k,m=a?"width":"height",o=i["plot"+(a?"Left":"Top")],p,r,A=h||1,q=i.inverted,n=i.bounds[a?"h":"v"],w=b.length===1,O=b[0][l],s=c[0][l],v=!w&&b[1][l],t=!w&&c[1][l],y,c=function(){!w&&S(O-v)>20&&(A=h||S(s-t)/S(O-v));r=(o-s)/A+O;p=i["plot"+(a?"Width":"Height")]/A};c();b=r;b<n.min?(b=n.min,y=!0):b+p>n.max&&(b=n.max-p,y=!0);y?(s-=0.8*(s-g[j][0]),w||(t-=0.8*(t-
g[j][1])),c()):g[j]=[s,t];q||(f[j]=r-o,f[m]=p);f=q?1/A:A;e[m]=p;e[j]=b;d[q?a?"scaleY":"scaleX":"scale"+k]=A;d["translate"+k]=f*o+(s-f*O)},pinch:function(a){var b=this,c=b.chart,d=b.pinchDown,e=a.touches,f=e.length,g=b.lastValidTouch,h=b.hasZoom,i=b.selectionMarker,j={},k=f===1&&(b.inClass(a.target,"highcharts-tracker")&&c.runTrackerClick||b.runChartClick),l={};if(f>1)b.initiated=!0;h&&b.initiated&&!k&&a.preventDefault();ta(e,function(a){return b.normalize(a)});if(a.type==="touchstart")n(e,function(a,
b){d[b]={chartX:a.chartX,chartY:a.chartY}}),g.x=[d[0].chartX,d[1]&&d[1].chartX],g.y=[d[0].chartY,d[1]&&d[1].chartY],n(c.axes,function(a){if(a.zoomEnabled){var b=c.bounds[a.horiz?"h":"v"],d=a.minPixelPadding,e=a.toPixels(q(a.options.min,a.dataMin)),f=a.toPixels(q(a.options.max,a.dataMax)),g=E(e,f),e=v(e,f);b.min=E(a.pos,g-d);b.max=v(a.pos+a.len,e+d)}}),b.res=!0;else if(d.length){if(!i)b.selectionMarker=i=x({destroy:ra,touch:!0},c.plotBox);b.pinchTranslate(d,e,j,i,l,g);b.hasPinched=h;b.scaleGroups(j,
l);if(!h&&b.followTouchMove&&f===1)this.runPointActions(b.normalize(a));else if(b.res)b.res=!1,this.reset(!1,0)}},touch:function(a,b){var c=this.chart,d;oa=c.index;if(a.touches.length===1)if(a=this.normalize(a),c.isInsidePlot(a.chartX-c.plotLeft,a.chartY-c.plotTop)&&!c.openMenu){b&&this.runPointActions(a);if(a.type==="touchmove")c=this.pinchDown,d=Math.sqrt(Math.pow(c[0].chartX-a.chartX,2)+Math.pow(c[0].chartY-a.chartY,2))>=4;q(d,!0)&&this.pinch(a)}else b&&this.reset();else a.touches.length===2&&
this.pinch(a)},onContainerTouchStart:function(a){this.touch(a,!0)},onContainerTouchMove:function(a){this.touch(a)},onDocumentTouchEnd:function(a){$[oa]&&$[oa].pointer.drop(a)}});if(J.PointerEvent||J.MSPointerEvent){var Ga={},Mb=!!J.PointerEvent,ac=function(){var a,b=[];b.item=function(a){return this[a]};for(a in Ga)Ga.hasOwnProperty(a)&&b.push({pageX:Ga[a].pageX,pageY:Ga[a].pageY,target:Ga[a].target});return b},Nb=function(a,b,c,d){if((a.pointerType==="touch"||a.pointerType===a.MSPOINTER_TYPE_TOUCH)&&
$[oa])d(a),d=$[oa].pointer,d[b]({type:c,target:a.currentTarget,preventDefault:ra,touches:ac()})};x(Za.prototype,{onContainerPointerDown:function(a){Nb(a,"onContainerTouchStart","touchstart",function(a){Ga[a.pointerId]={pageX:a.pageX,pageY:a.pageY,target:a.currentTarget}})},onContainerPointerMove:function(a){Nb(a,"onContainerTouchMove","touchmove",function(a){Ga[a.pointerId]={pageX:a.pageX,pageY:a.pageY};if(!Ga[a.pointerId].target)Ga[a.pointerId].target=a.currentTarget})},onDocumentPointerUp:function(a){Nb(a,
"onDocumentTouchEnd","touchend",function(a){delete Ga[a.pointerId]})},batchMSEvents:function(a){a(this.chart.container,Mb?"pointerdown":"MSPointerDown",this.onContainerPointerDown);a(this.chart.container,Mb?"pointermove":"MSPointerMove",this.onContainerPointerMove);a(B,Mb?"pointerup":"MSPointerUp",this.onDocumentPointerUp)}});U(Za.prototype,"init",function(a,b,c){a.call(this,b,c);this.hasZoom&&F(b.container,{"-ms-touch-action":"none","touch-action":"none"})});U(Za.prototype,"setDOMEvents",function(a){a.apply(this);
(this.hasZoom||this.followTouchMove)&&this.batchMSEvents(D)});U(Za.prototype,"destroy",function(a){this.batchMSEvents(T);a.call(this)})}var vb=z.Legend=function(a,b){this.init(a,b)};vb.prototype={init:function(a,b){var c=this,d=b.itemStyle,e=b.itemMarginTop||0;this.options=b;if(b.enabled)c.itemStyle=d,c.itemHiddenStyle=C(d,b.itemHiddenStyle),c.itemMarginTop=e,c.padding=d=q(b.padding,8),c.initialItemX=d,c.initialItemY=d-5,c.maxItemWidth=0,c.chart=a,c.itemHeight=0,c.symbolWidth=q(b.symbolWidth,16),
c.pages=[],c.render(),D(c.chart,"endResize",function(){c.positionCheckboxes()})},colorizeItem:function(a,b){var c=this.options,d=a.legendItem,e=a.legendLine,f=a.legendSymbol,g=this.itemHiddenStyle.color,c=b?c.itemStyle.color:g,h=b?a.legendColor||a.color||"#CCC":g,g=a.options&&a.options.marker,i={fill:h},j;d&&d.css({fill:c,color:c});e&&e.attr({stroke:h});if(f){if(g&&f.isMarker)for(j in i.stroke=h,g=a.convertAttribs(g),g)d=g[j],d!==t&&(i[j]=d);f.attr(i)}},positionItem:function(a){var b=this.options,
c=b.symbolPadding,b=!b.rtl,d=a._legendItemPos,e=d[0],d=d[1],f=a.checkbox;(a=a.legendGroup)&&a.element&&a.translate(b?e:this.legendWidth-e-2*c-4,d);if(f)f.x=e,f.y=d},destroyItem:function(a){var b=a.checkbox;n(["legendItem","legendLine","legendSymbol","legendGroup"],function(b){a[b]&&(a[b]=a[b].destroy())});b&&Va(a.checkbox)},destroy:function(){var a=this.group,b=this.box;if(b)this.box=b.destroy();if(a)this.group=a.destroy()},positionCheckboxes:function(a){var b=this.group.alignAttr,c,d=this.clipHeight||
this.legendHeight,e=this.titleHeight;if(b)c=b.translateY,n(this.allItems,function(f){var g=f.checkbox,h;g&&(h=c+e+g.y+(a||0)+3,F(g,{left:b.translateX+f.checkboxOffset+g.x-20+"px",top:h+"px",display:h>c-6&&h<c+d-6?"":"none"}))})},renderTitle:function(){var a=this.padding,b=this.options.title,c=0;if(b.text){if(!this.title)this.title=this.chart.renderer.label(b.text,a-3,a-4,null,null,null,null,null,"legend-title").attr({zIndex:1}).css(b.style).add(this.group);a=this.title.getBBox();c=a.height;this.offsetWidth=
a.width;this.contentGroup.attr({translateY:c})}this.titleHeight=c},setText:function(a){var b=this.options;a.legendItem.attr({text:b.labelFormat?La(b.labelFormat,a):b.labelFormatter.call(a)})},renderItem:function(a){var b=this.chart,c=b.renderer,d=this.options,e=d.layout==="horizontal",f=this.symbolWidth,g=d.symbolPadding,h=this.itemStyle,i=this.itemHiddenStyle,j=this.padding,k=e?q(d.itemDistance,20):0,l=!d.rtl,m=d.width,o=d.itemMarginBottom||0,p=this.itemMarginTop,r=this.initialItemX,A=a.legendItem,
n=a.series&&a.series.drawLegendSymbol?a.series:a,u=n.options,u=this.createCheckboxForItem&&u&&u.showCheckbox,w=d.useHTML;if(!A){a.legendGroup=c.g("legend-item").attr({zIndex:1}).add(this.scrollGroup);a.legendItem=A=c.text("",l?f+g:-g,this.baseline||0,w).css(C(a.visible?h:i)).attr({align:l?"left":"right",zIndex:2}).add(a.legendGroup);if(!this.baseline)this.fontMetrics=c.fontMetrics(h.fontSize,A),this.baseline=this.fontMetrics.f+3+p,A.attr("y",this.baseline);n.drawLegendSymbol(this,a);this.setItemEvents&&
this.setItemEvents(a,A,w,h,i);u&&this.createCheckboxForItem(a)}this.colorizeItem(a,a.visible);this.setText(a);c=A.getBBox();f=a.checkboxOffset=d.itemWidth||a.legendItemWidth||f+g+c.width+k+(u?20:0);this.itemHeight=g=y(a.legendItemHeight||c.height);if(e&&this.itemX-r+f>(m||b.chartWidth-2*j-r-d.x))this.itemX=r,this.itemY+=p+this.lastLineHeight+o,this.lastLineHeight=0;this.maxItemWidth=v(this.maxItemWidth,f);this.lastItemY=p+this.itemY+o;this.lastLineHeight=v(g,this.lastLineHeight);a._legendItemPos=
[this.itemX,this.itemY];e?this.itemX+=f:(this.itemY+=p+g+o,this.lastLineHeight=g);this.offsetWidth=m||v((e?this.itemX-r-k:f)+j,this.offsetWidth)},getAllItems:function(){var a=[];n(this.chart.series,function(b){var c=b.options;if(q(c.showInLegend,!s(c.linkedTo)?t:!1,!0))a=a.concat(b.legendItems||(c.legendType==="point"?b.data:b))});return a},adjustMargins:function(a,b){var c=this.chart,d=this.options,e=d.align.charAt(0)+d.verticalAlign.charAt(0)+d.layout.charAt(0);this.display&&!d.floating&&n([/(lth|ct|rth)/,
/(rtv|rm|rbv)/,/(rbh|cb|lbh)/,/(lbv|lm|ltv)/],function(f,g){f.test(e)&&!s(a[g])&&(c[ub[g]]=v(c[ub[g]],c.legend[(g+1)%2?"legendHeight":"legendWidth"]+[1,-1,-1,1][g]*d[g%2?"x":"y"]+q(d.margin,12)+b[g]))})},render:function(){var a=this,b=a.chart,c=b.renderer,d=a.group,e,f,g,h,i=a.box,j=a.options,k=a.padding,l=j.borderWidth,m=j.backgroundColor;a.itemX=a.initialItemX;a.itemY=a.initialItemY;a.offsetWidth=0;a.lastItemY=0;if(!d)a.group=d=c.g("legend").attr({zIndex:7}).add(),a.contentGroup=c.g().attr({zIndex:1}).add(d),
a.scrollGroup=c.g().add(a.contentGroup);a.renderTitle();e=a.getAllItems();ob(e,function(a,b){return(a.options&&a.options.legendIndex||0)-(b.options&&b.options.legendIndex||0)});j.reversed&&e.reverse();a.allItems=e;a.display=f=!!e.length;a.lastLineHeight=0;n(e,function(b){a.renderItem(b)});g=(j.width||a.offsetWidth)+k;h=a.lastItemY+a.lastLineHeight+a.titleHeight;h=a.handleOverflow(h);h+=k;if(l||m){if(i){if(g>0&&h>0)i[i.isNew?"attr":"animate"](i.crisp({width:g,height:h})),i.isNew=!1}else a.box=i=c.rect(0,
0,g,h,j.borderRadius,l||0).attr({stroke:j.borderColor,"stroke-width":l||0,fill:m||"none"}).add(d).shadow(j.shadow),i.isNew=!0;i[f?"show":"hide"]()}a.legendWidth=g;a.legendHeight=h;n(e,function(b){a.positionItem(b)});f&&d.align(x({width:g,height:h},j),!0,"spacingBox");b.isResizing||this.positionCheckboxes()},handleOverflow:function(a){var b=this,c=this.chart,d=c.renderer,e=this.options,f=e.y,f=c.spacingBox.height+(e.verticalAlign==="top"?-f:f)-this.padding,g=e.maxHeight,h,i=this.clipRect,j=e.navigation,
k=q(j.animation,!0),l=j.arrowSize||12,m=this.nav,o=this.pages,p=this.padding,r,A=this.allItems,P=function(a){i.attr({height:a});if(b.contentGroup.div)b.contentGroup.div.style.clip="rect("+p+"px,9999px,"+(p+a)+"px,0)"};e.layout==="horizontal"&&(f/=2);g&&(f=E(f,g));o.length=0;if(a>f&&j.enabled!==!1){this.clipHeight=h=v(f-20-this.titleHeight-p,0);this.currentPage=q(this.currentPage,1);this.fullHeight=a;n(A,function(a,b){var c=a._legendItemPos[1],d=y(a.legendItem.getBBox().height),e=o.length;if(!e||c-
o[e-1]>h&&(r||c)!==o[e-1])o.push(r||c),e++;b===A.length-1&&c+d-o[e-1]>h&&o.push(c);c!==r&&(r=c)});if(!i)i=b.clipRect=d.clipRect(0,p,9999,0),b.contentGroup.clip(i);P(h);if(!m)this.nav=m=d.g().attr({zIndex:1}).add(this.group),this.up=d.symbol("triangle",0,0,l,l).on("click",function(){b.scroll(-1,k)}).add(m),this.pager=d.text("",15,10).css(j.style).add(m),this.down=d.symbol("triangle-down",0,0,l,l).on("click",function(){b.scroll(1,k)}).add(m);b.scroll(0);a=f}else if(m)P(c.chartHeight),m.hide(),this.scrollGroup.attr({translateY:1}),
this.clipHeight=0;return a},scroll:function(a,b){var c=this.pages,d=c.length,e=this.currentPage+a,f=this.clipHeight,g=this.options.navigation,h=g.activeColor,g=g.inactiveColor,i=this.pager,j=this.padding;e>d&&(e=d);if(e>0)b!==t&&ab(b,this.chart),this.nav.attr({translateX:j,translateY:f+this.padding+7+this.titleHeight,visibility:"visible"}),this.up.attr({fill:e===1?g:h}).css({cursor:e===1?"default":"pointer"}),i.attr({text:e+"/"+d}),this.down.attr({x:18+this.pager.getBBox().width,fill:e===d?g:h}).css({cursor:e===
d?"default":"pointer"}),c=-c[e-1]+this.initialItemY,this.scrollGroup.animate({translateY:c}),this.currentPage=e,this.positionCheckboxes(c)}};aa=z.LegendSymbolMixin={drawRectangle:function(a,b){var c=a.options.symbolHeight||a.fontMetrics.f;b.legendSymbol=this.chart.renderer.rect(0,a.baseline-c+1,a.symbolWidth,c,a.options.symbolRadius||0).attr({zIndex:3}).add(b.legendGroup)},drawLineMarker:function(a){var b=this.options,c=b.marker,d=a.symbolWidth,e=this.chart.renderer,f=this.legendGroup,a=a.baseline-
y(a.fontMetrics.b*0.3),g;if(b.lineWidth){g={"stroke-width":b.lineWidth};if(b.dashStyle)g.dashstyle=b.dashStyle;this.legendLine=e.path(["M",0,a,"L",d,a]).attr(g).add(f)}if(c&&c.enabled!==!1)b=c.radius,this.legendSymbol=c=e.symbol(this.symbol,d/2-b,a-b,2*b,2*b,c).add(f),c.isMarker=!0}};(/Trident\/7\.0/.test(Ma)||Xa)&&U(vb.prototype,"positionItem",function(a,b){var c=this,d=function(){b._legendItemPos&&a.call(c,b)};d();setTimeout(d)});var Ca=z.Chart=function(){this.getArgs.apply(this,arguments)};z.chart=
function(a,b,c){return new Ca(a,b,c)};Ca.prototype={callbacks:[],getArgs:function(){var a=[].slice.call(arguments);if(Da(a[0])||a[0].nodeName)this.renderTo=a.shift();this.init(a[0],a[1])},init:function(a,b){var c,d=a.series;a.series=null;c=C(N,a);c.series=a.series=d;this.userOptions=a;d=c.chart;this.margin=this.splashArray("margin",d);this.spacing=this.splashArray("spacing",d);var e=d.events;this.bounds={h:{},v:{}};this.callback=b;this.isResizing=0;this.options=c;this.axes=[];this.series=[];this.hasCartesianSeries=
d.showAxes;var f=this,g;f.index=$.length;$.push(f);lb++;d.reflow!==!1&&D(f,"load",function(){f.initReflow()});if(e)for(g in e)D(f,g,e[g]);f.xAxis=[];f.yAxis=[];f.animation=qa?!1:q(d.animation,!0);f.pointCount=f.colorCounter=f.symbolCounter=0;f.firstRender()},initSeries:function(a){var b=this.options.chart;(b=K[a.type||b.type||b.defaultSeriesType])||ga(17,!0);b=new b;b.init(this,a);return b},isInsidePlot:function(a,b,c){var d=c?b:a,a=c?a:b;return d>=0&&d<=this.plotWidth&&a>=0&&a<=this.plotHeight},
redraw:function(a){var b=this.axes,c=this.series,d=this.pointer,e=this.legend,f=this.isDirtyLegend,g,h,i=this.hasCartesianSeries,j=this.isDirtyBox,k=c.length,l=k,m=this.renderer,o=m.isHidden(),p=[];ab(a,this);o&&this.cloneRenderTo();for(this.layOutTitles();l--;)if(a=c[l],a.options.stacking&&(g=!0,a.isDirty)){h=!0;break}if(h)for(l=k;l--;)if(a=c[l],a.options.stacking)a.isDirty=!0;n(c,function(a){a.isDirty&&a.options.legendType==="point"&&(a.updateTotals&&a.updateTotals(),f=!0)});if(f&&e.options.enabled)e.render(),
this.isDirtyLegend=!1;g&&this.getStacks();if(i&&!this.isResizing)this.maxTicks=null,n(b,function(a){a.setScale()});this.getMargins();i&&(n(b,function(a){a.isDirty&&(j=!0)}),n(b,function(a){var b=a.min+","+a.max;if(a.extKey!==b)a.extKey=b,p.push(function(){M(a,"afterSetExtremes",x(a.eventArgs,a.getExtremes()));delete a.eventArgs});(j||g)&&a.redraw()}));j&&this.drawChartBox();n(c,function(a){a.isDirty&&a.visible&&(!a.isCartesian||a.xAxis)&&a.redraw()});d&&d.reset(!0);m.draw();M(this,"redraw");o&&this.cloneRenderTo(!0);
n(p,function(a){a.call()})},get:function(a){var b=this.axes,c=this.series,d,e;for(d=0;d<b.length;d++)if(b[d].options.id===a)return b[d];for(d=0;d<c.length;d++)if(c[d].options.id===a)return c[d];for(d=0;d<c.length;d++){e=c[d].points||[];for(b=0;b<e.length;b++)if(e[b].id===a)return e[b]}return null},getAxes:function(){var a=this,b=this.options,c=b.xAxis=va(b.xAxis||{}),b=b.yAxis=va(b.yAxis||{});n(c,function(a,b){a.index=b;a.isX=!0});n(b,function(a,b){a.index=b});c=c.concat(b);n(c,function(b){new I(a,
b)})},getSelectedPoints:function(){var a=[];n(this.series,function(b){a=a.concat(Sa(b.points||[],function(a){return a.selected}))});return a},getSelectedSeries:function(){return Sa(this.series,function(a){return a.selected})},setTitle:function(a,b,c){var g;var d=this,e=d.options,f;f=e.title=C(e.title,a);g=e.subtitle=C(e.subtitle,b),e=g;n([["title",a,f],["subtitle",b,e]],function(a){var b=a[0],c=d[b],e=a[1],a=a[2];c&&e&&(d[b]=c=c.destroy());a&&a.text&&!c&&(d[b]=d.renderer.text(a.text,0,0,a.useHTML).attr({align:a.align,
"class":"highcharts-"+b,zIndex:a.zIndex||4}).css(a.style).add())});d.layOutTitles(c)},layOutTitles:function(a){var b=0,c=this.title,d=this.subtitle,e=this.options,f=e.title,e=e.subtitle,g=this.renderer,h=this.spacingBox.width-44;if(c&&(c.css({width:(f.width||h)+"px"}).align(x({y:g.fontMetrics(f.style.fontSize,c).b-3},f),!1,"spacingBox"),!f.floating&&!f.verticalAlign))b=c.getBBox().height;d&&(d.css({width:(e.width||h)+"px"}).align(x({y:b+(f.margin-13)+g.fontMetrics(e.style.fontSize,c).b},e),!1,"spacingBox"),
!e.floating&&!e.verticalAlign&&(b=Fa(b+d.getBBox().height)));c=this.titleOffset!==b;this.titleOffset=b;if(!this.isDirtyBox&&c)this.isDirtyBox=c,this.hasRendered&&q(a,!0)&&this.isDirtyBox&&this.redraw()},getChartSize:function(){var a=this.options.chart,b=a.width,a=a.height,c=this.renderToClone||this.renderTo;if(!s(b))this.containerWidth=xa(c,"width");if(!s(a))this.containerHeight=xa(c,"height");this.chartWidth=v(0,b||this.containerWidth||600);this.chartHeight=v(0,q(a,this.containerHeight>19?this.containerHeight:
400))},cloneRenderTo:function(a){var b=this.renderToClone,c=this.container;a?b&&(this.renderTo.appendChild(c),Va(b),delete this.renderToClone):(c&&c.parentNode===this.renderTo&&this.renderTo.removeChild(c),this.renderToClone=b=this.renderTo.cloneNode(0),F(b,{position:"absolute",top:"-9999px",display:"block"}),b.style.setProperty&&b.style.setProperty("display","block","important"),B.body.appendChild(b),c&&b.appendChild(c))},getContainer:function(){var a,b=this.options,c=b.chart,d,e;a=this.renderTo;
var f="highcharts-"+Jb++;if(!a)this.renderTo=a=c.renderTo;if(Da(a))this.renderTo=a=B.getElementById(a);a||ga(13,!0);d=G(X(a,"data-highcharts-chart"));!isNaN(d)&&$[d]&&$[d].hasRendered&&$[d].destroy();X(a,"data-highcharts-chart",this.index);a.innerHTML="";!c.skipClone&&!a.offsetWidth&&this.cloneRenderTo();this.getChartSize();d=this.chartWidth;e=this.chartHeight;this.container=a=ea(Wa,{className:"highcharts-container"+(c.className?" "+c.className:""),id:f},x({position:"relative",overflow:"hidden",width:d+
"px",height:e+"px",textAlign:"left",lineHeight:"normal",zIndex:0,"-webkit-tap-highlight-color":"rgba(0,0,0,0)"},c.style),this.renderToClone||a);this._cursor=a.style.cursor;this.renderer=new (z[c.renderer]||Ya)(a,d,e,c.style,c.forExport,b.exporting&&b.exporting.allowHTML);qa&&this.renderer.create(this,a,d,e);this.renderer.chartIndex=this.index},getMargins:function(a){var b=this.spacing,c=this.margin,d=this.titleOffset;this.resetMargins();if(d&&!s(c[0]))this.plotTop=v(this.plotTop,d+this.options.title.margin+
b[0]);this.legend.adjustMargins(c,b);this.extraBottomMargin&&(this.marginBottom+=this.extraBottomMargin);this.extraTopMargin&&(this.plotTop+=this.extraTopMargin);a||this.getAxisMargins()},getAxisMargins:function(){var a=this,b=a.axisOffset=[0,0,0,0],c=a.margin;a.hasCartesianSeries&&n(a.axes,function(a){a.visible&&a.getOffset()});n(ub,function(d,e){s(c[e])||(a[d]+=b[e])});a.setChartSize()},reflow:function(a){var b=this,c=b.options.chart,d=b.renderTo,e=c.width||xa(d,"width"),f=c.height||xa(d,"height"),
c=a?a.target:J;if(!b.hasUserSize&&!b.isPrinting&&e&&f&&(c===J||c===B)){if(e!==b.containerWidth||f!==b.containerHeight)clearTimeout(b.reflowTimeout),b.reflowTimeout=$a(function(){if(b.container)b.setSize(e,f,!1),b.hasUserSize=null},a?100:0);b.containerWidth=e;b.containerHeight=f}},initReflow:function(){var a=this,b=function(b){a.reflow(b)};D(J,"resize",b);D(a,"destroy",function(){T(J,"resize",b)})},setSize:function(a,b,c){var d=this,e,f,g=d.renderer;d.isResizing+=1;ab(c,d);d.oldChartHeight=d.chartHeight;
d.oldChartWidth=d.chartWidth;if(s(a))d.chartWidth=e=v(0,y(a)),d.hasUserSize=!!e;if(s(b))d.chartHeight=f=v(0,y(b));a=g.globalAnimation;(a?eb:F)(d.container,{width:e+"px",height:f+"px"},a);d.setChartSize(!0);g.setSize(e,f,c);d.maxTicks=null;n(d.axes,function(a){a.isDirty=!0;a.setScale()});n(d.series,function(a){a.isDirty=!0});d.isDirtyLegend=!0;d.isDirtyBox=!0;d.layOutTitles();d.getMargins();d.redraw(c);d.oldChartHeight=null;M(d,"resize");$a(function(){d&&M(d,"endResize",null,function(){d.isResizing-=
1})},hb(a).duration)},setChartSize:function(a){var b=this.inverted,c=this.renderer,d=this.chartWidth,e=this.chartHeight,f=this.options.chart,g=this.spacing,h=this.clipOffset,i,j,k,l;this.plotLeft=i=y(this.plotLeft);this.plotTop=j=y(this.plotTop);this.plotWidth=k=v(0,y(d-i-this.marginRight));this.plotHeight=l=v(0,y(e-j-this.marginBottom));this.plotSizeX=b?l:k;this.plotSizeY=b?k:l;this.plotBorderWidth=f.plotBorderWidth||0;this.spacingBox=c.spacingBox={x:g[3],y:g[0],width:d-g[3]-g[1],height:e-g[0]-g[2]};
this.plotBox=c.plotBox={x:i,y:j,width:k,height:l};d=2*V(this.plotBorderWidth/2);b=Fa(v(d,h[3])/2);c=Fa(v(d,h[0])/2);this.clipBox={x:b,y:c,width:V(this.plotSizeX-v(d,h[1])/2-b),height:v(0,V(this.plotSizeY-v(d,h[2])/2-c))};a||n(this.axes,function(a){a.setAxisSize();a.setAxisTranslation()})},resetMargins:function(){var a=this;n(ub,function(b,c){a[b]=q(a.margin[c],a.spacing[c])});a.axisOffset=[0,0,0,0];a.clipOffset=[0,0,0,0]},drawChartBox:function(){var a=this.options.chart,b=this.renderer,c=this.chartWidth,
d=this.chartHeight,e=this.chartBackground,f=this.plotBackground,g=this.plotBorder,h=this.plotBGImage,i=a.borderWidth||0,j=a.backgroundColor,k=a.plotBackgroundColor,l=a.plotBackgroundImage,m=a.plotBorderWidth||0,o,p=this.plotLeft,r=this.plotTop,A=this.plotWidth,q=this.plotHeight,n=this.plotBox,w=this.clipRect,O=this.clipBox;o=i+(a.shadow?8:0);if(i||j)if(e)e.animate(e.crisp({width:c-o,height:d-o}));else{e={fill:j||"none"};if(i)e.stroke=a.borderColor,e["stroke-width"]=i;this.chartBackground=b.rect(o/
2,o/2,c-o,d-o,a.borderRadius,i).attr(e).addClass("highcharts-background").add().shadow(a.shadow)}if(k)f?f.animate(n):this.plotBackground=b.rect(p,r,A,q,0).attr({fill:k}).add().shadow(a.plotShadow);if(l)h?h.animate(n):this.plotBGImage=b.image(l,p,r,A,q).add();w?w.animate({width:O.width,height:O.height}):this.clipRect=b.clipRect(O);if(m)g?(g.strokeWidth=-m,g.animate(g.crisp({x:p,y:r,width:A,height:q}))):this.plotBorder=b.rect(p,r,A,q,0,-m).attr({stroke:a.plotBorderColor,"stroke-width":m,fill:"none",
zIndex:1}).add();this.isDirtyBox=!1},propFromSeries:function(){var a=this,b=a.options.chart,c,d=a.options.series,e,f;n(["inverted","angular","polar"],function(g){c=K[b.type||b.defaultSeriesType];f=a[g]||b[g]||c&&c.prototype[g];for(e=d&&d.length;!f&&e--;)(c=K[d[e].type])&&c.prototype[g]&&(f=!0);a[g]=f})},linkSeries:function(){var a=this,b=a.series;n(b,function(a){a.linkedSeries.length=0});n(b,function(b){var d=b.options.linkedTo;if(Da(d)&&(d=d===":previous"?a.series[b.index-1]:a.get(d)))d.linkedSeries.push(b),
b.linkedParent=d,b.visible=q(b.options.visible,d.options.visible,b.visible)})},renderSeries:function(){n(this.series,function(a){a.translate();a.render()})},renderLabels:function(){var a=this,b=a.options.labels;b.items&&n(b.items,function(c){var d=x(b.style,c.style),e=G(d.left)+a.plotLeft,f=G(d.top)+a.plotTop+12;delete d.left;delete d.top;a.renderer.text(c.html,e,f).attr({zIndex:2}).css(d).add()})},render:function(){var a=this.axes,b=this.renderer,c=this.options,d,e,f,g;this.setTitle();this.legend=
new vb(this,c.legend);this.getStacks&&this.getStacks();this.getMargins(!0);this.setChartSize();d=this.plotWidth;e=this.plotHeight-=21;n(a,function(a){a.setScale()});this.getAxisMargins();f=d/this.plotWidth>1.1;g=e/this.plotHeight>1.05;if(f||g)this.maxTicks=null,n(a,function(a){(a.horiz&&f||!a.horiz&&g)&&a.setTickInterval(!0)}),this.getMargins();this.drawChartBox();this.hasCartesianSeries&&n(a,function(a){a.visible&&a.render()});if(!this.seriesGroup)this.seriesGroup=b.g("series-group").attr({zIndex:3}).add();
this.renderSeries();this.renderLabels();this.showCredits(c.credits);this.hasRendered=!0},showCredits:function(a){if(a.enabled&&!this.credits)this.credits=this.renderer.text(a.text,0,0).on("click",function(){if(a.href)J.location.href=a.href}).attr({align:a.position.align,zIndex:8}).css(a.style).add().align(a.position)},destroy:function(){var a=this,b=a.axes,c=a.series,d=a.container,e,f=d&&d.parentNode;M(a,"destroy");$[a.index]=t;lb--;a.renderTo.removeAttribute("data-highcharts-chart");T(a);for(e=b.length;e--;)b[e]=
b[e].destroy();for(e=c.length;e--;)c[e]=c[e].destroy();n("title,subtitle,chartBackground,plotBackground,plotBGImage,plotBorder,seriesGroup,clipRect,credits,pointer,scroller,rangeSelector,legend,resetZoomButton,tooltip,renderer".split(","),function(b){var c=a[b];c&&c.destroy&&(a[b]=c.destroy())});if(d)d.innerHTML="",T(d),f&&Va(d);for(e in a)delete a[e]},isReadyToRender:function(){var a=this;return!ja&&J==J.top&&B.readyState!=="complete"||qa&&!J.canvg?(qa?Wb.push(function(){a.firstRender()},a.options.global.canvasToolsURL):
B.attachEvent("onreadystatechange",function(){B.detachEvent("onreadystatechange",a.firstRender);B.readyState==="complete"&&a.firstRender()}),!1):!0},firstRender:function(){var a=this,b=a.options;if(a.isReadyToRender()){a.getContainer();M(a,"init");a.resetMargins();a.setChartSize();a.propFromSeries();a.getAxes();n(b.series||[],function(b){a.initSeries(b)});a.linkSeries();M(a,"beforeRender");if(z.Pointer)a.pointer=new Za(a,b);a.render();a.renderer.draw();if(!a.renderer.imgCount&&a.onload)a.onload();
a.cloneRenderTo(!0)}},onload:function(){var a=this;n([this.callback].concat(this.callbacks),function(b){b&&a.index!==void 0&&b.apply(a,[a])});M(a,"load");this.onload=null},splashArray:function(a,b){var c=b[a],c=da(c)?c:[c,c,c,c];return[q(b[a+"Top"],c[0]),q(b[a+"Right"],c[1]),q(b[a+"Bottom"],c[2]),q(b[a+"Left"],c[3])]}};var bc=z.CenteredSeriesMixin={getCenter:function(){var a=this.options,b=this.chart,c=2*(a.slicedOffset||0),d=b.plotWidth-2*c,b=b.plotHeight-2*c,e=a.center,e=[q(e[0],"50%"),q(e[1],"50%"),
a.size||"100%",a.innerSize||0],f=E(d,b),g,h;for(g=0;g<4;++g)h=e[g],a=g<2||g===2&&/%$/.test(h),e[g]=(/%$/.test(h)?[d,b,f,e[2]][g]*parseFloat(h)/100:parseFloat(h))+(a?c:0);e[3]>e[2]&&(e[3]=e[2]);return e}},Ha=function(){};Ha.prototype={init:function(a,b,c){this.series=a;this.color=a.color;this.applyOptions(b,c);this.pointAttr={};if(a.options.colorByPoint&&(b=a.options.colors||a.chart.options.colors,this.color=this.color||b[a.colorCounter++],a.colorCounter===b.length))a.colorCounter=0;a.chart.pointCount++;
return this},applyOptions:function(a,b){var c=this.series,d=c.options.pointValKey||c.pointValKey,a=Ha.prototype.optionsToObject.call(this,a);x(this,a);this.options=this.options?x(this.options,a):a;if(d)this.y=this[d];this.isNull=this.y===null;if(this.x===void 0&&c)this.x=b===void 0?c.autoIncrement():b;return this},optionsToObject:function(a){var b={},c=this.series,d=c.options.keys,e=d||c.pointArrayMap||["y"],f=e.length,g=0,h=0;if(typeof a==="number"||a===null)b[e[0]]=a;else if(Ja(a)){if(!d&&a.length>
f){c=typeof a[0];if(c==="string")b.name=a[0];else if(c==="number")b.x=a[0];g++}for(;h<f;){if(!d||a[g]!==void 0)b[e[h]]=a[g];g++;h++}}else if(typeof a==="object"){b=a;if(a.dataLabels)c._hasPointLabels=!0;if(a.marker)c._hasPointMarkers=!0}return b},destroy:function(){var a=this.series.chart,b=a.hoverPoints,c;a.pointCount--;if(b&&(this.setState(),Aa(b,this),!b.length))a.hoverPoints=null;if(this===a.hoverPoint)this.onMouseOut();if(this.graphic||this.dataLabel)T(this),this.destroyElements();this.legendItem&&
a.legend.destroyItem(this);for(c in this)this[c]=null},destroyElements:function(){for(var a=["graphic","dataLabel","dataLabelUpper","connector","shadowGroup"],b,c=6;c--;)b=a[c],this[b]&&(this[b]=this[b].destroy())},getLabelConfig:function(){return{x:this.category,y:this.y,color:this.color,key:this.name||this.category,series:this.series,point:this,percentage:this.percentage,total:this.total||this.stackTotal}},tooltipFormatter:function(a){var b=this.series,c=b.tooltipOptions,d=q(c.valueDecimals,""),
e=c.valuePrefix||"",f=c.valueSuffix||"";n(b.pointArrayMap||["y"],function(b){b="{point."+b;if(e||f)a=a.replace(b+"}",e+b+"}"+f);a=a.replace(b+"}",b+":,."+d+"f}")});return La(a,{point:this,series:this.series})},firePointEvent:function(a,b,c){var d=this,e=this.series.options;(e.point.events[a]||d.options&&d.options.events&&d.options.events[a])&&this.importEvents();a==="click"&&e.allowPointSelect&&(c=function(a){d.select&&d.select(null,a.ctrlKey||a.metaKey||a.shiftKey)});M(this,a,b,c)},visible:!0};var Q=
z.Series=function(){};Q.prototype={isCartesian:!0,type:"line",pointClass:Ha,sorted:!0,requireSorting:!0,pointAttrToOptions:{stroke:"lineColor","stroke-width":"lineWidth",fill:"fillColor",r:"radius"},directTouch:!1,axisTypes:["xAxis","yAxis"],colorCounter:0,parallelArrays:["x","y"],init:function(a,b){var c=this,d,e,f=a.series,g=function(a,b){return q(a.options.index,a._i)-q(b.options.index,b._i)};c.chart=a;c.options=b=c.setOptions(b);c.linkedSeries=[];c.bindAxes();x(c,{name:b.name,state:"",pointAttr:{},
visible:b.visible!==!1,selected:b.selected===!0});if(qa)b.animation=!1;e=b.events;for(d in e)D(c,d,e[d]);if(e&&e.click||b.point&&b.point.events&&b.point.events.click||b.allowPointSelect)a.runTrackerClick=!0;c.getColor();c.getSymbol();n(c.parallelArrays,function(a){c[a+"Data"]=[]});c.setData(b.data,!1);if(c.isCartesian)a.hasCartesianSeries=!0;f.push(c);c._i=f.length-1;ob(f,g);this.yAxis&&ob(this.yAxis.series,g);n(f,function(a,b){a.index=b;a.name=a.name||"Series "+(b+1)})},bindAxes:function(){var a=
this,b=a.options,c=a.chart,d;n(a.axisTypes||[],function(e){n(c[e],function(c){d=c.options;if(b[e]===d.index||b[e]!==t&&b[e]===d.id||b[e]===t&&d.index===0)c.series.push(a),a[e]=c,c.isDirty=!0});!a[e]&&a.optionalAxis!==e&&ga(18,!0)})},updateParallelArrays:function(a,b){var c=a.series,d=arguments;n(c.parallelArrays,typeof b==="number"?function(d){var f=d==="y"&&c.toYData?c.toYData(a):a[d];c[d+"Data"][b]=f}:function(a){Array.prototype[b].apply(c[a+"Data"],Array.prototype.slice.call(d,2))})},autoIncrement:function(){var a=
this.options,b=this.xIncrement,c,d=a.pointIntervalUnit,b=q(b,a.pointStart,0);this.pointInterval=c=q(this.pointInterval,a.pointInterval,1);d&&(a=new fa(b),d==="day"?a=+a[rb](a[bb]()+c):d==="month"?a=+a[Fb](a[ib]()+c):d==="year"&&(a=+a[Gb](a[jb]()+c)),c=a-b);this.xIncrement=b+c;return b},setOptions:function(a){var b=this.chart,c=b.options.plotOptions,b=b.userOptions||{},d=b.plotOptions||{},e=c[this.type];this.userOptions=a;c=C(e,c.series,a);this.tooltipOptions=C(N.tooltip,N.plotOptions[this.type].tooltip,
b.tooltip,d.series&&d.series.tooltip,d[this.type]&&d[this.type].tooltip,a.tooltip);e.marker===null&&delete c.marker;this.zoneAxis=c.zoneAxis;a=this.zones=(c.zones||[]).slice();if((c.negativeColor||c.negativeFillColor)&&!c.zones)a.push({value:c[this.zoneAxis+"Threshold"]||c.threshold||0,color:c.negativeColor,fillColor:c.negativeFillColor});a.length&&s(a[a.length-1].value)&&a.push({color:this.color,fillColor:this.fillColor});return c},getCyclic:function(a,b,c){var d=this.userOptions,e="_"+a+"Index",
f=a+"Counter";b||(s(d[e])?b=d[e]:(d[e]=b=this.chart[f]%c.length,this.chart[f]+=1),b=c[b]);this[a]=b},getColor:function(){this.options.colorByPoint?this.options.color=null:this.getCyclic("color",this.options.color||W[this.type].color,this.chart.options.colors)},getSymbol:function(){var a=this.options.marker;this.getCyclic("symbol",a.symbol,this.chart.options.symbols);if(/^url/.test(this.symbol))a.radius=0},drawLegendSymbol:aa.drawLineMarker,setData:function(a,b,c,d){var e=this,f=e.points,g=f&&f.length||
0,h,i=e.options,j=e.chart,k=null,l=e.xAxis,m=l&&!!l.categories,o=i.turboThreshold,p=this.xData,r=this.yData,A=(h=e.pointArrayMap)&&h.length,a=a||[];h=a.length;b=q(b,!0);if(d!==!1&&h&&g===h&&!e.cropped&&!e.hasGroupedData&&e.visible)n(a,function(a,b){f[b].update&&a!==i.data[b]&&f[b].update(a,!1,null,!1)});else{e.xIncrement=null;e.colorCounter=0;n(this.parallelArrays,function(a){e[a+"Data"].length=0});if(o&&h>o){for(c=0;k===null&&c<h;)k=a[c],c++;if(ua(k)){m=q(i.pointStart,0);k=q(i.pointInterval,1);for(c=
0;c<h;c++)p[c]=m,r[c]=a[c],m+=k;e.xIncrement=m}else if(Ja(k))if(A)for(c=0;c<h;c++)k=a[c],p[c]=k[0],r[c]=k.slice(1,A+1);else for(c=0;c<h;c++)k=a[c],p[c]=k[0],r[c]=k[1];else ga(12)}else for(c=0;c<h;c++)if(a[c]!==t&&(k={series:e},e.pointClass.prototype.applyOptions.apply(k,[a[c]]),e.updateParallelArrays(k,c),m&&s(k.name)))l.names[k.x]=k.name;Da(r[0])&&ga(14,!0);e.data=[];e.options.data=e.userOptions.data=a;for(c=g;c--;)f[c]&&f[c].destroy&&f[c].destroy();if(l)l.minRange=l.userMinRange;e.isDirty=e.isDirtyData=
j.isDirtyBox=!0;c=!1}i.legendType==="point"&&(this.processData(),this.generatePoints());b&&j.redraw(c)},processData:function(a){var b=this.xData,c=this.yData,d=b.length,e;e=0;var f,g,h=this.xAxis,i,j=this.options;i=j.cropThreshold;var k=this.getExtremesFromAll||j.getExtremesFromAll,l=this.isCartesian,j=h&&h.val2lin,m=h&&h.isLog,o,p;if(l&&!this.isDirty&&!h.isDirty&&!this.yAxis.isDirty&&!a)return!1;if(h)a=h.getExtremes(),o=a.min,p=a.max;if(l&&this.sorted&&!k&&(!i||d>i||this.forceCrop))if(b[d-1]<o||
b[0]>p)b=[],c=[];else if(b[0]<o||b[d-1]>p)e=this.cropData(this.xData,this.yData,o,p),b=e.xData,c=e.yData,e=e.start,f=!0;for(i=b.length||1;--i;)d=m?j(b[i])-j(b[i-1]):b[i]-b[i-1],d>0&&(g===t||d<g)?g=d:d<0&&this.requireSorting&&ga(15);this.cropped=f;this.cropStart=e;this.processedXData=b;this.processedYData=c;this.closestPointRange=g},cropData:function(a,b,c,d){var e=a.length,f=0,g=e,h=q(this.cropShoulder,1),i;for(i=0;i<e;i++)if(a[i]>=c){f=v(0,i-h);break}for(c=i;c<e;c++)if(a[c]>d){g=c+h;break}return{xData:a.slice(f,
g),yData:b.slice(f,g),start:f,end:g}},generatePoints:function(){var a=this.options.data,b=this.data,c,d=this.processedXData,e=this.processedYData,f=this.pointClass,g=d.length,h=this.cropStart||0,i,j=this.hasGroupedData,k,l=[],m;if(!b&&!j)b=[],b.length=a.length,b=this.data=b;for(m=0;m<g;m++)i=h+m,j?(l[m]=(new f).init(this,[d[m]].concat(va(e[m]))),l[m].dataGroup=this.groupMap[m]):(b[i]?k=b[i]:a[i]!==t&&(b[i]=k=(new f).init(this,a[i],d[m])),l[m]=k),l[m].index=i;if(b&&(g!==(c=b.length)||j))for(m=0;m<
c;m++)if(m===h&&!j&&(m+=g),b[m])b[m].destroyElements(),b[m].plotX=t;this.data=b;this.points=l},getExtremes:function(a){var b=this.yAxis,c=this.processedXData,d,e=[],f=0;d=this.xAxis.getExtremes();var g=d.min,h=d.max,i,j,k,l,a=a||this.stackedYData||this.processedYData;d=a.length;for(l=0;l<d;l++)if(j=c[l],k=a[l],i=k!==null&&k!==t&&(!b.isLog||k.length||k>0),j=this.getExtremesFromAll||this.options.getExtremesFromAll||this.cropped||(c[l+1]||j)>=g&&(c[l-1]||j)<=h,i&&j)if(i=k.length)for(;i--;)k[i]!==null&&
(e[f++]=k[i]);else e[f++]=k;this.dataMin=Oa(e);this.dataMax=Ea(e)},translate:function(){this.processedXData||this.processData();this.generatePoints();for(var a=this.options,b=a.stacking,c=this.xAxis,d=c.categories,e=this.yAxis,f=this.points,g=f.length,h=!!this.modifyValue,i=a.pointPlacement,j=i==="between"||ua(i),k=a.threshold,l=a.startFromThreshold?k:0,m,o,p,r,A=Number.MAX_VALUE,a=0;a<g;a++){var n=f[a],u=n.x,w=n.y;o=n.low;var O=b&&e.stacks[(this.negStacks&&w<(l?0:k)?"-":"")+this.stackKey];if(e.isLog&&
w!==null&&w<=0)n.y=w=null,ga(10);n.plotX=m=E(v(-1E5,c.translate(u,0,0,0,1,i,this.type==="flags")),1E5);if(b&&this.visible&&!n.isNull&&O&&O[u])r=this.getStackIndicator(r,u,this.index),O=O[u],w=O.points[r.key],o=w[0],w=w[1],o===l&&(o=q(k,e.min)),e.isLog&&o<=0&&(o=null),n.total=n.stackTotal=O.total,n.percentage=O.total&&n.y/O.total*100,n.stackY=w,O.setOffset(this.pointXOffset||0,this.barW||0);n.yBottom=s(o)?e.translate(o,0,1,0,1):null;h&&(w=this.modifyValue(w,n));n.plotY=o=typeof w==="number"&&w!==Infinity?
E(v(-1E5,e.translate(w,0,1,0,1)),1E5):t;n.isInside=o!==t&&o>=0&&o<=e.len&&m>=0&&m<=c.len;n.clientX=j?c.translate(u,0,0,0,1):m;n.negative=n.y<(k||0);n.category=d&&d[n.x]!==t?d[n.x]:n.x;n.isNull||(p!==void 0&&(A=E(A,S(m-p))),p=m)}this.closestPointRangePx=A},getValidPoints:function(a,b){var c=this.chart;return Sa(a||this.points||[],function(a){return b&&!c.isInsidePlot(a.plotX,a.plotY,c.inverted)?!1:!a.isNull})},setClip:function(a){var b=this.chart,c=this.options,d=b.renderer,e=b.inverted,f=this.clipBox,
g=f||b.clipBox,h=this.sharedClipKey||["_sharedClip",a&&a.duration,a&&a.easing,g.height,c.xAxis,c.yAxis].join(","),i=b[h],j=b[h+"m"];if(!i){if(a)g.width=0,b[h+"m"]=j=d.clipRect(-99,e?-b.plotLeft:-b.plotTop,99,e?b.chartWidth:b.chartHeight);b[h]=i=d.clipRect(g)}a&&(i.count+=1);if(c.clip!==!1)this.group.clip(a||f?i:b.clipRect),this.markerGroup.clip(j),this.sharedClipKey=h;a||(i.count-=1,i.count<=0&&h&&b[h]&&(f||(b[h]=b[h].destroy()),b[h+"m"]&&(b[h+"m"]=b[h+"m"].destroy())))},animate:function(a){var b=
this.chart,c=this.options.animation,d;if(c&&!da(c))c=W[this.type].animation;a?this.setClip(c):(d=this.sharedClipKey,(a=b[d])&&a.animate({width:b.plotSizeX},c),b[d+"m"]&&b[d+"m"].animate({width:b.plotSizeX+99},c),this.animate=null)},afterAnimate:function(){this.setClip();M(this,"afterAnimate")},drawPoints:function(){var a,b=this.points,c=this.chart,d,e,f,g,h,i,j,k,l=this.options.marker,m=this.pointAttr[""],o,p,r,A=this.markerGroup,n=q(l.enabled,this.xAxis.isRadial,this.closestPointRangePx>2*l.radius);
if(l.enabled!==!1||this._hasPointMarkers)for(f=b.length;f--;)if(g=b[f],d=V(g.plotX),e=g.plotY,k=g.graphic,o=g.marker||{},p=!!g.marker,a=n&&o.enabled===t||o.enabled,r=g.isInside,a&&e!==t&&!isNaN(e)&&g.y!==null)if(a=g.pointAttr[g.selected?"select":""]||m,h=a.r,i=q(o.symbol,this.symbol),j=i.indexOf("url")===0,k)k[r?"show":"hide"](!0).attr(a).animate(x({x:d-h,y:e-h},k.symbolName?{width:2*h,height:2*h}:{}));else{if(r&&(h>0||j))g.graphic=c.renderer.symbol(i,d-h,e-h,2*h,2*h,p?o:l).attr(a).add(A)}else if(k)g.graphic=
k.destroy()},convertAttribs:function(a,b,c,d){var e=this.pointAttrToOptions,f,g,h={},a=a||{},b=b||{},c=c||{},d=d||{};for(f in e)g=e[f],h[f]=q(a[g],b[f],c[f],d[f]);return h},getAttribs:function(){var a=this,b=a.options,c=W[a.type].marker?b.marker:b,d=c.states,e=d.hover,f,g=a.color,h=a.options.negativeColor;f={stroke:g,fill:g};var i=a.points||[],j,k,l=[],m=a.pointAttrToOptions;j=a.hasPointSpecificOptions;var o=c.lineColor,p=c.fillColor;k=b.turboThreshold;var r=a.zones,A=a.zoneAxis||"y",P;b.marker?(e.radius=
e.radius||c.radius+e.radiusPlus,e.lineWidth=e.lineWidth||c.lineWidth+e.lineWidthPlus):(e.color=e.color||wa(e.color||g).brighten(e.brightness).get(),e.negativeColor=e.negativeColor||wa(e.negativeColor||h).brighten(e.brightness).get());l[""]=a.convertAttribs(c,f);n(["hover","select"],function(b){l[b]=a.convertAttribs(d[b],l[""])});a.pointAttr=l;g=i.length;if(!k||g<k||j)for(;g--;){k=i[g];if((c=k.options&&k.options.marker||k.options)&&c.enabled===!1)c.radius=0;if(r.length){j=0;for(f=r[j];k[A]>=f.value;)f=
r[++j];k.color=k.fillColor=q(f.color,a.color)}j=b.colorByPoint||k.color;if(k.options)for(P in m)s(c[m[P]])&&(j=!0);if(j){c=c||{};j=[];d=c.states||{};f=d.hover=d.hover||{};if(!b.marker||k.negative&&!f.fillColor&&!e.fillColor)f[a.pointAttrToOptions.fill]=f.color||!k.options.color&&e[k.negative&&h?"negativeColor":"color"]||wa(k.color).brighten(f.brightness||e.brightness).get();f={color:k.color};if(!p)f.fillColor=k.color;if(!o)f.lineColor=k.color;c.hasOwnProperty("color")&&!c.color&&delete c.color;j[""]=
a.convertAttribs(x(f,c),l[""]);j.hover=a.convertAttribs(d.hover,l.hover,j[""]);j.select=a.convertAttribs(d.select,l.select,j[""])}else j=l;k.pointAttr=j}},destroy:function(){var a=this,b=a.chart,c=/AppleWebKit\/533/.test(Ma),d,e=a.data||[],f,g,h;M(a,"destroy");T(a);n(a.axisTypes||[],function(b){if(h=a[b])Aa(h.series,a),h.isDirty=h.forceRedraw=!0});a.legendItem&&a.chart.legend.destroyItem(a);for(d=e.length;d--;)(f=e[d])&&f.destroy&&f.destroy();a.points=null;clearTimeout(a.animationTimeout);for(g in a)a[g]instanceof
Z&&!a[g].survive&&(d=c&&g==="group"?"hide":"destroy",a[g][d]());if(b.hoverSeries===a)b.hoverSeries=null;Aa(b.series,a);for(g in a)delete a[g]},getGraphPath:function(a,b,c){var d=this,e=d.options,f=e.step,g,h=[],i,a=a||d.points;(g=a.reversed)&&a.reverse();(f={right:1,center:2}[f]||f&&3)&&g&&(f=4-f);e.connectNulls&&!b&&!c&&(a=this.getValidPoints(a));n(a,function(g,k){var l=g.plotX,m=g.plotY,o=a[k-1];if((g.leftCliff||o&&o.rightCliff)&&!c)i=!0;g.isNull&&!s(b)&&k>0?i=!e.connectNulls:g.isNull&&!b?i=!0:
(k===0||i?o=["M",g.plotX,g.plotY]:d.getPointSpline?o=d.getPointSpline(a,g,k):f?(o=f===1?["L",o.plotX,m]:f===2?["L",(o.plotX+l)/2,o.plotY,"L",(o.plotX+l)/2,m]:["L",l,o.plotY],o.push("L",l,m)):o=["L",l,m],h.push.apply(h,o),i=!1)});return d.graphPath=h},drawGraph:function(){var a=this,b=this.options,c=[["graph",b.lineColor||this.color,b.dashStyle]],d=b.lineWidth,e=b.linecap!=="square",f=(this.gappedPath||this.getGraphPath).call(this),g=this.fillGraph&&this.color||"none";n(this.zones,function(d,e){c.push(["zoneGraph"+
e,d.color||a.color,d.dashStyle||b.dashStyle])});n(c,function(c,i){var j=c[0],k=a[j];if(k)k.animate({d:f});else if((d||g)&&f.length)k={stroke:c[1],"stroke-width":d,fill:g,zIndex:1},c[2]?k.dashstyle=c[2]:e&&(k["stroke-linecap"]=k["stroke-linejoin"]="round"),a[j]=a.chart.renderer.path(f).attr(k).add(a.group).shadow(i<2&&b.shadow)})},applyZones:function(){var a=this,b=this.chart,c=b.renderer,d=this.zones,e,f,g=this.clips||[],h,i=this.graph,j=this.area,k=v(b.chartWidth,b.chartHeight),l=this[(this.zoneAxis||
"y")+"Axis"],m,o=l.reversed,p=b.inverted,r=l.horiz,A,P,u,w=!1;if(d.length&&(i||j)&&l.min!==t)i&&i.hide(),j&&j.hide(),m=l.getExtremes(),n(d,function(d,n){e=o?r?b.plotWidth:0:r?0:l.toPixels(m.min);e=E(v(q(f,e),0),k);f=E(v(y(l.toPixels(q(d.value,m.max),!0)),0),k);w&&(e=f=l.toPixels(m.max));A=Math.abs(e-f);P=E(e,f);u=v(e,f);if(l.isXAxis){if(h={x:p?u:P,y:0,width:A,height:k},!r)h.x=b.plotHeight-h.x}else if(h={x:0,y:p?u:P,width:k,height:A},r)h.y=b.plotWidth-h.y;b.inverted&&c.isVML&&(h=l.isXAxis?{x:0,y:o?
P:u,height:h.width,width:b.chartWidth}:{x:h.y-b.plotLeft-b.spacingBox.x,y:0,width:h.height,height:b.chartHeight});g[n]?g[n].animate(h):(g[n]=c.clipRect(h),i&&a["zoneGraph"+n].clip(g[n]),j&&a["zoneArea"+n].clip(g[n]));w=d.value>m.max}),this.clips=g},invertGroups:function(){function a(){var a={width:b.yAxis.len,height:b.xAxis.len};n(["group","markerGroup"],function(c){b[c]&&b[c].attr(a).invert()})}var b=this,c=b.chart;if(b.xAxis)D(c,"resize",a),D(b,"destroy",function(){T(c,"resize",a)}),a(),b.invertGroups=
a},plotGroup:function(a,b,c,d,e){var f=this[a],g=!f;g&&(this[a]=f=this.chart.renderer.g(b).attr({zIndex:d||0.1}).add(e),f.addClass("highcharts-series-"+this.index));f.attr({visibility:c})[g?"attr":"animate"](this.getPlotBox());return f},getPlotBox:function(){var a=this.chart,b=this.xAxis,c=this.yAxis;if(a.inverted)b=c,c=this.xAxis;return{translateX:b?b.left:a.plotLeft,translateY:c?c.top:a.plotTop,scaleX:1,scaleY:1}},render:function(){var a=this,b=a.chart,c,d=a.options,e=!!a.animate&&b.renderer.isSVG&&
hb(d.animation).duration,f=a.visible?"inherit":"hidden",g=d.zIndex,h=a.hasRendered,i=b.seriesGroup;c=a.plotGroup("group","series",f,g,i);a.markerGroup=a.plotGroup("markerGroup","markers",f,g,i);e&&a.animate(!0);a.getAttribs();c.inverted=a.isCartesian?b.inverted:!1;a.drawGraph&&(a.drawGraph(),a.applyZones());n(a.points,function(a){a.redraw&&a.redraw()});a.drawDataLabels&&a.drawDataLabels();a.visible&&a.drawPoints();a.drawTracker&&a.options.enableMouseTracking!==!1&&a.drawTracker();b.inverted&&a.invertGroups();
d.clip!==!1&&!a.sharedClipKey&&!h&&c.clip(b.clipRect);e&&a.animate();if(!h)a.animationTimeout=$a(function(){a.afterAnimate()},e);a.isDirty=a.isDirtyData=!1;a.hasRendered=!0},redraw:function(){var a=this.chart,b=this.isDirtyData,c=this.isDirty,d=this.group,e=this.xAxis,f=this.yAxis;d&&(a.inverted&&d.attr({width:a.plotWidth,height:a.plotHeight}),d.animate({translateX:q(e&&e.left,a.plotLeft),translateY:q(f&&f.top,a.plotTop)}));this.translate();this.render();b&&M(this,"updatedData");(c||b)&&delete this.kdTree},
kdDimensions:1,kdAxisArray:["clientX","plotY"],searchPoint:function(a,b){var c=this.xAxis,d=this.yAxis,e=this.chart.inverted;return this.searchKDTree({clientX:e?c.len-a.chartY+c.pos:a.chartX-c.pos,plotY:e?d.len-a.chartX+d.pos:a.chartY-d.pos},b)},buildKDTree:function(){function a(c,e,f){var g,h;if(h=c&&c.length)return g=b.kdAxisArray[e%f],c.sort(function(a,b){return a[g]-b[g]}),h=Math.floor(h/2),{point:c[h],left:a(c.slice(0,h),e+1,f),right:a(c.slice(h+1),e+1,f)}}var b=this,c=b.kdDimensions;delete b.kdTree;
$a(function(){b.kdTree=a(b.getValidPoints(null,!b.directTouch),c,c)},b.options.kdNow?0:1)},searchKDTree:function(a,b){function c(a,b,j,k){var l=b.point,m=d.kdAxisArray[j%k],o,p,r=l;p=s(a[e])&&s(l[e])?Math.pow(a[e]-l[e],2):null;o=s(a[f])&&s(l[f])?Math.pow(a[f]-l[f],2):null;o=(p||0)+(o||0);l.dist=s(o)?Math.sqrt(o):Number.MAX_VALUE;l.distX=s(p)?Math.sqrt(p):Number.MAX_VALUE;m=a[m]-l[m];o=m<0?"left":"right";p=m<0?"right":"left";b[o]&&(o=c(a,b[o],j+1,k),r=o[g]<r[g]?o:l);b[p]&&Math.sqrt(m*m)<r[g]&&(a=c(a,
b[p],j+1,k),r=a[g]<r[g]?a:r);return r}var d=this,e=this.kdAxisArray[0],f=this.kdAxisArray[1],g=b?"distX":"dist";this.kdTree||this.buildKDTree();if(this.kdTree)return c(a,this.kdTree,this.kdDimensions,this.kdDimensions)}};Tb.prototype={destroy:function(){Pa(this,this.axis)},render:function(a){var b=this.options,c=b.format,c=c?La(c,this):b.formatter.call(this);this.label?this.label.attr({text:c,visibility:"hidden"}):this.label=this.axis.chart.renderer.text(c,null,null,b.useHTML).css(b.style).attr({align:this.textAlign,
rotation:b.rotation,visibility:"hidden"}).add(a)},setOffset:function(a,b){var c=this.axis,d=c.chart,e=d.inverted,f=c.reversed,f=this.isNegative&&!f||!this.isNegative&&f,g=c.translate(c.usePercentage?100:this.total,0,0,0,1),c=c.translate(0),c=S(g-c),h=d.xAxis[0].translate(this.x)+a,i=d.plotHeight,f={x:e?f?g:g-c:h,y:e?i-h-b:f?i-g-c:i-g,width:e?c:b,height:e?b:c};if(e=this.label)e.align(this.alignOptions,null,f),f=e.alignAttr,e[this.options.crop===!1||d.isInsidePlot(f.x,f.y)?"show":"hide"](!0)}};Ca.prototype.getStacks=
function(){var a=this;n(a.yAxis,function(a){if(a.stacks&&a.hasVisibleSeries)a.oldStacks=a.stacks});n(a.series,function(b){if(b.options.stacking&&(b.visible===!0||a.options.chart.ignoreHiddenSeries===!1))b.stackKey=b.type+q(b.options.stack,"")})};I.prototype.buildStacks=function(){var a=this.series,b,c=q(this.options.reversedStacks,!0),d=a.length,e;if(!this.isXAxis){this.usePercentage=!1;for(e=d;e--;)a[c?e:d-e-1].setStackedPoints();for(e=d;e--;)b=a[c?e:d-e-1],b.setStackCliffs&&b.setStackCliffs();if(this.usePercentage)for(e=
0;e<d;e++)a[e].setPercentStacks()}};I.prototype.renderStackTotals=function(){var a=this.chart,b=a.renderer,c=this.stacks,d,e,f=this.stackTotalGroup;if(!f)this.stackTotalGroup=f=b.g("stack-labels").attr({visibility:"visible",zIndex:6}).add();f.translate(a.plotLeft,a.plotTop);for(d in c)for(e in a=c[d],a)a[e].render(f)};I.prototype.resetStacks=function(){var a=this.stacks,b,c;if(!this.isXAxis)for(b in a)for(c in a[b])a[b][c].touched<this.stacksTouched?(a[b][c].destroy(),delete a[b][c]):(a[b][c].total=
null,a[b][c].cum=0)};I.prototype.cleanStacks=function(){var a,b,c;if(!this.isXAxis){if(this.oldStacks)a=this.stacks=this.oldStacks;for(b in a)for(c in a[b])a[b][c].cum=a[b][c].total}};Q.prototype.setStackedPoints=function(){if(this.options.stacking&&!(this.visible!==!0&&this.chart.options.chart.ignoreHiddenSeries!==!1)){var a=this.processedXData,b=this.processedYData,c=[],d=b.length,e=this.options,f=e.threshold,g=e.startFromThreshold?f:0,h=e.stack,e=e.stacking,i=this.stackKey,j="-"+i,k=this.negStacks,
l=this.yAxis,m=l.stacks,o=l.oldStacks,p,r,n,P,u,w,s;l.stacksTouched+=1;for(u=0;u<d;u++){w=a[u];s=b[u];p=this.getStackIndicator(p,w,this.index);P=p.key;n=(r=k&&s<(g?0:f))?j:i;m[n]||(m[n]={});if(!m[n][w])o[n]&&o[n][w]?(m[n][w]=o[n][w],m[n][w].total=null):m[n][w]=new Tb(l,l.options.stackLabels,r,w,h);n=m[n][w];if(s!==null)n.points[P]=n.points[this.index]=[q(n.cum,g)],n.touched=l.stacksTouched,p.index>0&&this.singleStacks===!1&&(n.points[P][0]=n.points[this.index+","+w+",0"][0]);e==="percent"?(r=r?i:
j,k&&m[r]&&m[r][w]?(r=m[r][w],n.total=r.total=v(r.total,n.total)+S(s)||0):n.total=na(n.total+(S(s)||0))):n.total=na(n.total+(s||0));n.cum=q(n.cum,g)+(s||0);if(s!==null)n.points[P].push(n.cum),c[u]=n.cum}if(e==="percent")l.usePercentage=!0;this.stackedYData=c;l.oldStacks={}}};Q.prototype.setPercentStacks=function(){var a=this,b=a.stackKey,c=a.yAxis.stacks,d=a.processedXData,e;n([b,"-"+b],function(b){var f;for(var g=d.length,h,i;g--;)if(h=d[g],e=a.getStackIndicator(e,h,a.index),f=(i=c[b]&&c[b][h])&&
i.points[e.key],h=f)i=i.total?100/i.total:0,h[0]=na(h[0]*i),h[1]=na(h[1]*i),a.stackedYData[g]=h[1]})};Q.prototype.getStackIndicator=function(a,b,c){!s(a)||a.x!==b?a={x:b,index:0}:a.index++;a.key=[c,b,a.index].join(",");return a};x(Ca.prototype,{addSeries:function(a,b,c){var d,e=this;a&&(b=q(b,!0),M(e,"addSeries",{options:a},function(){d=e.initSeries(a);e.isDirtyLegend=!0;e.linkSeries();b&&e.redraw(c)}));return d},addAxis:function(a,b,c,d){var e=b?"xAxis":"yAxis",f=this.options,a=C(a,{index:this[e].length,
isX:b});new I(this,a);f[e]=va(f[e]||{});f[e].push(a);q(c,!0)&&this.redraw(d)},showLoading:function(a){var b=this,c=b.options,d=b.loadingDiv,e=c.loading,f=function(){d&&F(d,{left:b.plotLeft+"px",top:b.plotTop+"px",width:b.plotWidth+"px",height:b.plotHeight+"px"})};if(!d)b.loadingDiv=d=ea(Wa,{className:"highcharts-loading"},x(e.style,{zIndex:10,display:"none"}),b.container),b.loadingSpan=ea("span",null,e.labelStyle,d),D(b,"redraw",f);b.loadingSpan.innerHTML=a||c.lang.loading;if(!b.loadingShown)F(d,
{opacity:0,display:""}),eb(d,{opacity:e.style.opacity},{duration:e.showDuration||0}),b.loadingShown=!0;f()},hideLoading:function(){var a=this.options,b=this.loadingDiv;b&&eb(b,{opacity:0},{duration:a.loading.hideDuration||100,complete:function(){F(b,{display:"none"})}});this.loadingShown=!1}});x(Ha.prototype,{update:function(a,b,c,d){function e(){f.applyOptions(a);if(f.y===null&&h)f.graphic=h.destroy();if(da(a)&&!Ja(a))f.redraw=function(){if(h&&h.element&&a&&a.marker&&a.marker.symbol)f.graphic=h.destroy();
if(a&&a.dataLabels&&f.dataLabel)f.dataLabel=f.dataLabel.destroy();f.redraw=null};i=f.index;g.updateParallelArrays(f,i);if(l&&f.name)l[f.x]=f.name;k.data[i]=da(k.data[i])&&!Ja(k.data[i])?f.options:a;g.isDirty=g.isDirtyData=!0;if(!g.fixedBox&&g.hasCartesianSeries)j.isDirtyBox=!0;if(k.legendType==="point")j.isDirtyLegend=!0;b&&j.redraw(c)}var f=this,g=f.series,h=f.graphic,i,j=g.chart,k=g.options,l=g.xAxis&&g.xAxis.names,b=q(b,!0);d===!1?e():f.firePointEvent("update",{options:a},e)},remove:function(a,
b){this.series.removePoint(sa(this,this.series.data),a,b)}});x(Q.prototype,{addPoint:function(a,b,c,d){var e=this,f=e.options,g=e.data,h=e.graph,i=e.area,j=e.chart,k=e.xAxis&&e.xAxis.names,l=h&&h.shift||0,m=["graph","area"],h=f.data,o,p=e.xData;ab(d,j);if(c){for(d=e.zones.length;d--;)m.push("zoneGraph"+d,"zoneArea"+d);n(m,function(a){if(e[a])e[a].shift=l+(f.step?2:1)})}if(i)i.isArea=!0;b=q(b,!0);i={series:e};e.pointClass.prototype.applyOptions.apply(i,[a]);m=i.x;d=p.length;if(e.requireSorting&&m<
p[d-1])for(o=!0;d&&p[d-1]>m;)d--;e.updateParallelArrays(i,"splice",d,0,0);e.updateParallelArrays(i,d);if(k&&i.name)k[m]=i.name;h.splice(d,0,a);o&&(e.data.splice(d,0,null),e.processData());f.legendType==="point"&&e.generatePoints();c&&(g[0]&&g[0].remove?g[0].remove(!1):(g.shift(),e.updateParallelArrays(i,"shift"),h.shift()));e.isDirty=!0;e.isDirtyData=!0;b&&(e.getAttribs(),j.redraw())},removePoint:function(a,b,c){var d=this,e=d.data,f=e[a],g=d.points,h=d.chart,i=function(){g&&g.length===e.length&&
g.splice(a,1);e.splice(a,1);d.options.data.splice(a,1);d.updateParallelArrays(f||{series:d},"splice",a,1);f&&f.destroy();d.isDirty=!0;d.isDirtyData=!0;b&&h.redraw()};ab(c,h);b=q(b,!0);f?f.firePointEvent("remove",null,i):i()},remove:function(a,b){var c=this,d=c.chart;M(c,"remove",null,function(){c.destroy();d.isDirtyLegend=d.isDirtyBox=!0;d.linkSeries();q(a,!0)&&d.redraw(b)})},update:function(a,b){var c=this,d=this.chart,e=this.userOptions,f=this.type,g=K[f].prototype,h=["group","markerGroup","dataLabelsGroup"],
i;if(a.type&&a.type!==f||a.zIndex!==void 0)h.length=0;n(h,function(a){h[a]=c[a];delete c[a]});a=C(e,{animation:!1,index:this.index,pointStart:this.xData[0]},{data:this.options.data},a);this.remove(!1);for(i in g)this[i]=t;x(this,K[a.type||f].prototype);n(h,function(a){c[a]=h[a]});this.init(d,a);d.linkSeries();q(b,!0)&&d.redraw(!1)}});x(I.prototype,{update:function(a,b){var c=this.chart,a=c.options[this.coll][this.options.index]=C(this.userOptions,a);this.destroy(!0);this._addedPlotLB=this.chart._labelPanes=
t;this.init(c,x(a,{events:t}));c.isDirtyBox=!0;q(b,!0)&&c.redraw()},remove:function(a){for(var b=this.chart,c=this.coll,d=this.series,e=d.length;e--;)d[e]&&d[e].remove(!1);Aa(b.axes,this);Aa(b[c],this);b.options[c].splice(this.options.index,1);n(b[c],function(a,b){a.options.index=b});this.destroy();b.isDirtyBox=!0;q(a,!0)&&b.redraw()},setTitle:function(a,b){this.update({title:a},b)},setCategories:function(a,b){this.update({categories:a},b)}});var Ia=la(Q);K.line=Ia;W.area=C(ca,{softThreshold:!1,threshold:0});
var za=la(Q,{type:"area",singleStacks:!1,getStackPoints:function(){var a=[],b=[],c=this.xAxis,d=this.yAxis,e=d.stacks[this.stackKey],f={},g=this.points,h=this.index,i=d.series,j=i.length,k,l=q(d.options.reversedStacks,!0)?1:-1,m,o;if(this.options.stacking){for(m=0;m<g.length;m++)f[g[m].x]=g[m];for(o in e)e[o].total!==null&&b.push(o);b.sort(function(a,b){return a-b});k=ta(i,function(){return this.visible});n(b,function(g,i){var o=0,q,u;if(f[g]&&!f[g].isNull)a.push(f[g]),n([-1,1],function(a){var c=
a===1?"rightNull":"leftNull",d=0,o=e[b[i+a]];if(o)for(m=h;m>=0&&m<j;)q=o.points[m],q||(m===h?f[g][c]=!0:k[m]&&(u=e[g].points[m])&&(d-=u[1]-u[0])),m+=l;f[g][a===1?"rightCliff":"leftCliff"]=d});else{for(m=h;m>=0&&m<j;){if(q=e[g].points[m]){o=q[1];break}m+=l}o=d.toPixels(o,!0);a.push({isNull:!0,plotX:c.toPixels(g,!0),plotY:o,yBottom:o})}})}return a},getGraphPath:function(a){var b=Q.prototype.getGraphPath,c=this.options,d=c.stacking,e=this.yAxis,f,g,h=[],i=[],j=this.index,k,l=e.stacks[this.stackKey],
m=c.threshold,o=e.getThreshold(c.threshold),p,c=c.connectNulls||d==="percent",r=function(b,c,f){var g=a[b],b=d&&l[g.x].points[j],p=g[f+"Null"]||0,f=g[f+"Cliff"]||0,r,n,g=!0;f||p?(r=(p?b[0]:b[1])+f,n=b[0]+f,g=!!p):!d&&a[c]&&a[c].isNull&&(r=n=m);r!==void 0&&(i.push({plotX:k,plotY:r===null?o:e.getThreshold(r),isNull:g}),h.push({plotX:k,plotY:n===null?o:e.getThreshold(n)}))},a=a||this.points;d&&(a=this.getStackPoints());for(f=0;f<a.length;f++)if(g=a[f].isNull,k=q(a[f].rectPlotX,a[f].plotX),p=q(a[f].yBottom,
o),!g||c){c||r(f,f-1,"left");if(!g||d||!c)i.push(a[f]),h.push({x:f,plotX:k,plotY:p});c||r(f,f+1,"right")}f=b.call(this,i,!0,!0);h.reversed=!0;g=b.call(this,h,!0,!0);g.length&&(g[0]="L");f=f.concat(g);b=b.call(this,i,!1,c);this.areaPath=f;return b},drawGraph:function(){this.areaPath=[];Q.prototype.drawGraph.apply(this);var a=this,b=this.areaPath,c=this.options,d=[["area",this.color,c.fillColor]];n(this.zones,function(b,f){d.push(["zoneArea"+f,b.color||a.color,b.fillColor||c.fillColor])});n(d,function(d){var f=
d[0],g=a[f];g?g.animate({d:b}):(g={fill:d[2]||d[1],zIndex:0},d[2]||(g["fill-opacity"]=q(c.fillOpacity,0.75)),a[f]=a.chart.renderer.path(b).attr(g).add(a.group))})},drawLegendSymbol:aa.drawRectangle});K.area=za;W.spline=C(ca);Ia=la(Q,{type:"spline",getPointSpline:function(a,b,c){var d=b.plotX,e=b.plotY,f=a[c-1],c=a[c+1],g,h,i,j;if(f&&!f.isNull&&c&&!c.isNull){a=f.plotY;i=c.plotX;var c=c.plotY,k=0;g=(1.5*d+f.plotX)/2.5;h=(1.5*e+a)/2.5;i=(1.5*d+i)/2.5;j=(1.5*e+c)/2.5;i!==g&&(k=(j-h)*(i-d)/(i-g)+e-j);
h+=k;j+=k;h>a&&h>e?(h=v(a,e),j=2*e-h):h<a&&h<e&&(h=E(a,e),j=2*e-h);j>c&&j>e?(j=v(c,e),h=2*e-j):j<c&&j<e&&(j=E(c,e),h=2*e-j);b.rightContX=i;b.rightContY=j}b=["C",q(f.rightContX,f.plotX),q(f.rightContY,f.plotY),q(g,d),q(h,e),d,e];f.rightContX=f.rightContY=null;return b}});K.spline=Ia;W.areaspline=C(W.area);za=za.prototype;Ia=la(Ia,{type:"areaspline",getStackPoints:za.getStackPoints,getGraphPath:za.getGraphPath,setStackCliffs:za.setStackCliffs,drawGraph:za.drawGraph,drawLegendSymbol:aa.drawRectangle});
K.areaspline=Ia;W.column=C(ca,{borderColor:"#FFFFFF",borderRadius:0,groupPadding:0.2,marker:null,pointPadding:0.1,minPointLength:0,cropThreshold:50,pointRange:null,states:{hover:{brightness:0.1,shadow:!1,halo:!1},select:{color:"#C0C0C0",borderColor:"#000000",shadow:!1}},dataLabels:{align:null,verticalAlign:null,y:null},softThreshold:!1,startFromThreshold:!0,stickyTracking:!1,tooltip:{distance:6},threshold:0});Ia=la(Q,{type:"column",pointAttrToOptions:{stroke:"borderColor",fill:"color",r:"borderRadius"},
cropShoulder:0,directTouch:!0,trackerGroups:["group","dataLabelsGroup"],negStacks:!0,init:function(){Q.prototype.init.apply(this,arguments);var a=this,b=a.chart;b.hasRendered&&n(b.series,function(b){if(b.type===a.type)b.isDirty=!0})},getColumnMetrics:function(){var a=this,b=a.options,c=a.xAxis,d=a.yAxis,e=c.reversed,f,g={},h=0;b.grouping===!1?h=1:n(a.chart.series,function(b){var c=b.options,e=b.yAxis,i;if(b.type===a.type&&b.visible&&d.len===e.len&&d.pos===e.pos)c.stacking?(f=b.stackKey,g[f]===t&&
(g[f]=h++),i=g[f]):c.grouping!==!1&&(i=h++),b.columnIndex=i});var i=E(S(c.transA)*(c.ordinalSlope||b.pointRange||c.closestPointRange||c.tickInterval||1),c.len),j=i*b.groupPadding,k=(i-2*j)/h,b=E(b.maxPointWidth||c.len,q(b.pointWidth,k*(1-2*b.pointPadding)));a.columnMetrics={width:b,offset:(k-b)/2+(j+((a.columnIndex||0)+(e?1:0))*k-i/2)*(e?-1:1)};return a.columnMetrics},crispCol:function(a,b,c,d){var e=this.chart,f=this.borderWidth,g=-(f%2?0.5:0),f=f%2?0.5:1;e.inverted&&e.renderer.isVML&&(f+=1);c=Math.round(a+
c)+g;a=Math.round(a)+g;c-=a;d=Math.round(b+d)+f;g=S(b)<=0.5&&d>0.5;b=Math.round(b)+f;d-=b;g&&d&&(b-=1,d+=1);return{x:a,y:b,width:c,height:d}},translate:function(){var a=this,b=a.chart,c=a.options,d=a.borderWidth=q(c.borderWidth,a.closestPointRange*a.xAxis.transA<2?0:1),e=a.yAxis,f=a.translatedThreshold=e.getThreshold(c.threshold),g=q(c.minPointLength,5),h=a.getColumnMetrics(),i=h.width,j=a.barW=v(i,1+2*d),k=a.pointXOffset=h.offset;b.inverted&&(f-=0.5);c.pointPadding&&(j=Fa(j));Q.prototype.translate.apply(a);
n(a.points,function(c){var d=E(q(c.yBottom,f),9E4),h=999+S(d),h=E(v(-h,c.plotY),e.len+h),p=c.plotX+k,r=j,n=E(h,d),s,u=v(h,d)-n;S(u)<g&&g&&(u=g,s=!e.reversed&&!c.negative||e.reversed&&c.negative,n=S(n-f)>g?d-g:f-(s?g:0));c.barX=p;c.pointWidth=i;c.tooltipPos=b.inverted?[e.len+e.pos-b.plotLeft-h,a.xAxis.len-p-r/2,u]:[p+r/2,h+e.pos-b.plotTop,u];c.shapeType="rect";c.shapeArgs=a.crispCol(p,n,r,u)})},getSymbol:ra,drawLegendSymbol:aa.drawRectangle,drawGraph:ra,drawPoints:function(){var a=this,b=this.chart,
c=a.options,d=b.renderer,e=c.animationLimit||250,f,g;n(a.points,function(h){var i=h.plotY,j=h.graphic;if(i!==t&&!isNaN(i)&&h.y!==null)f=h.shapeArgs,i=s(a.borderWidth)?{"stroke-width":a.borderWidth}:{},g=h.pointAttr[h.selected?"select":""]||a.pointAttr[""],j?(Ta(j),j.attr(i).attr(g)[b.pointCount<e?"animate":"attr"](C(f))):h.graphic=d[h.shapeType](f).attr(i).attr(g).add(h.group||a.group).shadow(c.shadow,null,c.stacking&&!c.borderRadius);else if(j)h.graphic=j.destroy()})},animate:function(a){var b=this,
c=this.yAxis,d=b.options,e=this.chart.inverted,f={};if(ja)a?(f.scaleY=0.001,a=E(c.pos+c.len,v(c.pos,c.toPixels(d.threshold))),e?f.translateX=a-c.len:f.translateY=a,b.group.attr(f)):(f[e?"translateX":"translateY"]=c.pos,b.group.animate(f,x(hb(b.options.animation),{step:function(a,c){b.group.attr({scaleY:c.pos})}})),b.animate=null)},remove:function(){var a=this,b=a.chart;b.hasRendered&&n(b.series,function(b){if(b.type===a.type)b.isDirty=!0});Q.prototype.remove.apply(a,arguments)}});K.column=Ia;W.bar=
C(W.column);za=la(Ia,{type:"bar",inverted:!0});K.bar=za;W.scatter=C(ca,{lineWidth:0,marker:{enabled:!0},tooltip:{headerFormat:'<span style="color:{point.color}">\u25cf</span> <span style="font-size: 10px;"> {series.name}</span><br/>',pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>"}});za=la(Q,{type:"scatter",sorted:!1,requireSorting:!1,noSharedTooltip:!0,trackerGroups:["group","markerGroup","dataLabelsGroup"],takeOrdinalPosition:!1,kdDimensions:2,drawGraph:function(){this.options.lineWidth&&
Q.prototype.drawGraph.call(this)}});K.scatter=za;W.pie=C(ca,{borderColor:"#FFFFFF",borderWidth:1,center:[null,null],clip:!1,colorByPoint:!0,dataLabels:{distance:30,enabled:!0,formatter:function(){return this.y===null?void 0:this.point.name},x:0},ignoreHiddenPoint:!0,legendType:"point",marker:null,size:null,showInLegend:!1,slicedOffset:10,states:{hover:{brightness:0.1,shadow:!1}},stickyTracking:!1,tooltip:{followPointer:!0}});ca={type:"pie",isCartesian:!1,pointClass:la(Ha,{init:function(){Ha.prototype.init.apply(this,
arguments);var a=this,b;a.name=q(a.name,"Slice");b=function(b){a.slice(b.type==="select")};D(a,"select",b);D(a,"unselect",b);return a},setVisible:function(a,b){var c=this,d=c.series,e=d.chart,f=d.options.ignoreHiddenPoint,b=q(b,f);if(a!==c.visible){c.visible=c.options.visible=a=a===t?!c.visible:a;d.options.data[sa(c,d.data)]=c.options;n(["graphic","dataLabel","connector","shadowGroup"],function(b){if(c[b])c[b][a?"show":"hide"](!0)});c.legendItem&&e.legend.colorizeItem(c,a);!a&&c.state==="hover"&&
c.setState("");if(f)d.isDirty=!0;b&&e.redraw()}},slice:function(a,b,c){var d=this.series;ab(c,d.chart);q(b,!0);this.sliced=this.options.sliced=a=s(a)?a:!this.sliced;d.options.data[sa(this,d.data)]=this.options;a=a?this.slicedTranslation:{translateX:0,translateY:0};this.graphic.animate(a);this.shadowGroup&&this.shadowGroup.animate(a)},haloPath:function(a){var b=this.shapeArgs,c=this.series.chart;return this.sliced||!this.visible?[]:this.series.chart.renderer.symbols.arc(c.plotLeft+b.x,c.plotTop+b.y,
b.r+a,b.r+a,{innerR:this.shapeArgs.r,start:b.start,end:b.end})}}),requireSorting:!1,directTouch:!0,noSharedTooltip:!0,trackerGroups:["group","dataLabelsGroup"],axisTypes:[],pointAttrToOptions:{stroke:"borderColor","stroke-width":"borderWidth",fill:"color"},animate:function(a){var b=this,c=b.points,d=b.startAngleRad;if(!a)n(c,function(a){var c=a.graphic,g=a.shapeArgs;c&&(c.attr({r:a.startR||b.center[3]/2,start:d,end:d}),c.animate({r:g.r,start:g.start,end:g.end},b.options.animation))}),b.animate=null},
updateTotals:function(){var a,b=0,c=this.points,d=c.length,e,f=this.options.ignoreHiddenPoint;for(a=0;a<d;a++)e=c[a],b+=f&&!e.visible?0:e.y;this.total=b;for(a=0;a<d;a++)e=c[a],e.percentage=b>0&&(e.visible||!f)?e.y/b*100:0,e.total=b},generatePoints:function(){Q.prototype.generatePoints.call(this);this.updateTotals()},translate:function(a){this.generatePoints();var b=0,c=this.options,d=c.slicedOffset,e=d+c.borderWidth,f,g,h,i=c.startAngle||0,j=this.startAngleRad=Ba/180*(i-90),i=(this.endAngleRad=Ba/
180*(q(c.endAngle,i+360)-90))-j,k=this.points,l=c.dataLabels.distance,c=c.ignoreHiddenPoint,m,o=k.length,p;if(!a)this.center=a=this.getCenter();this.getX=function(b,c){h=Y.asin(E((b-a[1])/(a[2]/2+l),1));return a[0]+(c?-1:1)*ba(h)*(a[2]/2+l)};for(m=0;m<o;m++){p=k[m];f=j+b*i;if(!c||p.visible)b+=p.percentage/100;g=j+b*i;p.shapeType="arc";p.shapeArgs={x:a[0],y:a[1],r:a[2]/2,innerR:a[3]/2,start:y(f*1E3)/1E3,end:y(g*1E3)/1E3};h=(g+f)/2;h>1.5*Ba?h-=2*Ba:h<-Ba/2&&(h+=2*Ba);p.slicedTranslation={translateX:y(ba(h)*
d),translateY:y(ka(h)*d)};f=ba(h)*a[2]/2;g=ka(h)*a[2]/2;p.tooltipPos=[a[0]+f*0.7,a[1]+g*0.7];p.half=h<-Ba/2||h>Ba/2?1:0;p.angle=h;e=E(e,l/2);p.labelPos=[a[0]+f+ba(h)*l,a[1]+g+ka(h)*l,a[0]+f+ba(h)*e,a[1]+g+ka(h)*e,a[0]+f,a[1]+g,l<0?"center":p.half?"right":"left",h]}},drawGraph:null,drawPoints:function(){var a=this,b=a.chart.renderer,c,d,e=a.options.shadow,f,g,h,i;if(e&&!a.shadowGroup)a.shadowGroup=b.g("shadow").add(a.group);n(a.points,function(j){if(j.y!==null){d=j.graphic;h=j.shapeArgs;f=j.shadowGroup;
g=j.pointAttr[j.selected?"select":""];if(!g.stroke)g.stroke=g.fill;if(e&&!f)f=j.shadowGroup=b.g("shadow").add(a.shadowGroup);c=j.sliced?j.slicedTranslation:{translateX:0,translateY:0};f&&f.attr(c);if(d)d.setRadialReference(a.center).attr(g).animate(x(h,c));else{i={"stroke-linejoin":"round"};if(!j.visible)i.visibility="hidden";j.graphic=d=b[j.shapeType](h).setRadialReference(a.center).attr(g).attr(i).attr(c).add(a.group).shadow(e,f)}}})},searchPoint:ra,sortByAngle:function(a,b){a.sort(function(a,d){return a.angle!==
void 0&&(d.angle-a.angle)*b})},drawLegendSymbol:aa.drawRectangle,getCenter:bc.getCenter,getSymbol:ra};ca=la(Q,ca);K.pie=ca;Q.prototype.drawDataLabels=function(){var a=this,b=a.options,c=b.cursor,d=b.dataLabels,e=a.points,f,g,h=a.hasRendered||0,i,j,k=q(d.defer,!0),l=a.chart.renderer;if(d.enabled||a._hasPointLabels)a.dlProcessOptions&&a.dlProcessOptions(d),j=a.plotGroup("dataLabelsGroup","data-labels",k&&!h?"hidden":"visible",d.zIndex||6),k&&(j.attr({opacity:+h}),h||D(a,"afterAnimate",function(){a.visible&&
j.show();j[b.animation?"animate":"attr"]({opacity:1},{duration:200})})),g=d,n(e,function(e){var h,k=e.dataLabel,r,n,P=e.connector,u=!0,w,v={};f=e.dlOptions||e.options&&e.options.dataLabels;h=q(f&&f.enabled,g.enabled)&&e.y!==null;if(k&&!h)e.dataLabel=k.destroy();else if(h){d=C(g,f);w=d.style;h=d.rotation;r=e.getLabelConfig();i=d.format?La(d.format,r):d.formatter.call(r,d);w.color=q(d.color,w.color,a.color,"black");if(k)if(s(i))k.attr({text:i}),u=!1;else{if(e.dataLabel=k=k.destroy(),P)e.connector=P.destroy()}else if(s(i)){k=
{fill:d.backgroundColor,stroke:d.borderColor,"stroke-width":d.borderWidth,r:d.borderRadius||0,rotation:h,padding:d.padding,zIndex:1};if(w.color==="contrast")v.color=d.inside||d.distance<0||b.stacking?l.getContrast(e.color||a.color):"#000000";if(c)v.cursor=c;for(n in k)k[n]===t&&delete k[n];k=e.dataLabel=l[h?"text":"label"](i,0,-9999,d.shape,null,null,d.useHTML).attr(k).css(x(w,v)).add(j).shadow(d.shadow)}k&&a.alignDataLabel(e,k,d,null,u)}})};Q.prototype.alignDataLabel=function(a,b,c,d,e){var f=this.chart,
g=f.inverted,h=q(a.plotX,-9999),i=q(a.plotY,-9999),j=b.getBBox(),k=f.renderer.fontMetrics(c.style.fontSize).b,l=c.rotation,m=c.align,o=this.visible&&(a.series.forceDL||f.isInsidePlot(h,y(i),g)||d&&f.isInsidePlot(h,g?d.x+1:d.y+d.height-1,g)),p=q(c.overflow,"justify")==="justify";if(o)d=x({x:g?f.plotWidth-i:h,y:y(g?f.plotHeight-h:i),width:0,height:0},d),x(c,{width:j.width,height:j.height}),l?(p=!1,g=f.renderer.rotCorr(k,l),g={x:d.x+c.x+d.width/2+g.x,y:d.y+c.y+d.height/2},b[e?"attr":"animate"](g).attr({align:c.align}),
h=(l+720)%360,h=h>180&&h<360,m==="left"?g.y-=h?j.height:0:m==="center"?(g.x-=j.width/2,g.y-=j.height/2):m==="right"&&(g.x-=j.width,g.y-=h?0:j.height)):(b.align(c,null,d),g=b.alignAttr),p?this.justifyDataLabel(b,c,g,j,d,e):q(c.crop,!0)&&(o=f.isInsidePlot(g.x,g.y)&&f.isInsidePlot(g.x+j.width,g.y+j.height)),c.shape&&!l&&b.attr({anchorX:a.plotX,anchorY:a.plotY});if(!o)Ta(b),b.attr({y:-9999}),b.placed=!1};Q.prototype.justifyDataLabel=function(a,b,c,d,e,f){var g=this.chart,h=b.align,i=b.verticalAlign,j,
k,l=a.box?0:a.padding||0;j=c.x+l;if(j<0)h==="right"?b.align="left":b.x=-j,k=!0;j=c.x+d.width-l;if(j>g.plotWidth)h==="left"?b.align="right":b.x=g.plotWidth-j,k=!0;j=c.y+l;if(j<0)i==="bottom"?b.verticalAlign="top":b.y=-j,k=!0;j=c.y+d.height-l;if(j>g.plotHeight)i==="top"?b.verticalAlign="bottom":b.y=g.plotHeight-j,k=!0;if(k)a.placed=!f,a.align(b,null,e)};if(K.pie)K.pie.prototype.drawDataLabels=function(){var a=this,b=a.data,c,d=a.chart,e=a.options.dataLabels,f=q(e.connectorPadding,10),g=q(e.connectorWidth,
1),h=d.plotWidth,i=d.plotHeight,j,k,l=q(e.softConnector,!0),m=e.distance,o=a.center,p=o[2]/2,r=o[1],A=m>0,s,u,w,t=[[],[]],x,z,C,B,L,D=[0,0,0,0],J=function(a,b){return b.y-a.y};if(a.visible&&(e.enabled||a._hasPointLabels)){Q.prototype.drawDataLabels.apply(a);n(b,function(a){if(a.dataLabel&&a.visible)t[a.half].push(a),a.dataLabel._pos=null});for(B=2;B--;){var G=[],K=[],I=t[B],F=I.length,H;if(F){a.sortByAngle(I,B-0.5);for(L=b=0;!b&&I[L];)b=I[L]&&I[L].dataLabel&&(I[L].dataLabel.getBBox().height||21),
L++;if(m>0){u=E(r+p+m,d.plotHeight);for(L=v(0,r-p-m);L<=u;L+=b)G.push(L);u=G.length;if(F>u){c=[].concat(I);c.sort(J);for(L=F;L--;)c[L].rank=L;for(L=F;L--;)I[L].rank>=u&&I.splice(L,1);F=I.length}for(L=0;L<F;L++){c=I[L];w=c.labelPos;c=9999;var M,N;for(N=0;N<u;N++)M=S(G[N]-w[1]),M<c&&(c=M,H=N);if(H<L&&G[L]!==null)H=L;else for(u<F-L+H&&G[L]!==null&&(H=u-F+L);G[H]===null;)H++;K.push({i:H,y:G[H]});G[H]=null}K.sort(J)}for(L=0;L<F;L++){c=I[L];w=c.labelPos;s=c.dataLabel;C=c.visible===!1?"hidden":"inherit";
c=w[1];if(m>0){if(u=K.pop(),H=u.i,z=u.y,c>z&&G[H+1]!==null||c<z&&G[H-1]!==null)z=E(v(0,c),d.plotHeight)}else z=c;x=e.justify?o[0]+(B?-1:1)*(p+m):a.getX(z===r-p-m||z===r+p+m?c:z,B);s._attr={visibility:C,align:w[6]};s._pos={x:x+e.x+({left:f,right:-f}[w[6]]||0),y:z+e.y-10};s.connX=x;s.connY=z;if(this.options.size===null)u=s.width,x-u<f?D[3]=v(y(u-x+f),D[3]):x+u>h-f&&(D[1]=v(y(x+u-h+f),D[1])),z-b/2<0?D[0]=v(y(-z+b/2),D[0]):z+b/2>i&&(D[2]=v(y(z+b/2-i),D[2]))}}}if(Ea(D)===0||this.verifyDataLabelOverflow(D))this.placeDataLabels(),
A&&g&&n(this.points,function(b){j=b.connector;w=b.labelPos;if((s=b.dataLabel)&&s._pos&&b.visible)C=s._attr.visibility,x=s.connX,z=s.connY,k=l?["M",x+(w[6]==="left"?5:-5),z,"C",x,z,2*w[2]-w[4],2*w[3]-w[5],w[2],w[3],"L",w[4],w[5]]:["M",x+(w[6]==="left"?5:-5),z,"L",w[2],w[3],"L",w[4],w[5]],j?(j.animate({d:k}),j.attr("visibility",C)):b.connector=j=a.chart.renderer.path(k).attr({"stroke-width":g,stroke:e.connectorColor||b.color||"#606060",visibility:C}).add(a.dataLabelsGroup);else if(j)b.connector=j.destroy()})}},
K.pie.prototype.placeDataLabels=function(){n(this.points,function(a){var b=a.dataLabel;if(b&&a.visible)(a=b._pos)?(b.attr(b._attr),b[b.moved?"animate":"attr"](a),b.moved=!0):b&&b.attr({y:-9999})})},K.pie.prototype.alignDataLabel=ra,K.pie.prototype.verifyDataLabelOverflow=function(a){var b=this.center,c=this.options,d=c.center,e=c.minSize||80,f=e,g;d[0]!==null?f=v(b[2]-v(a[1],a[3]),e):(f=v(b[2]-a[1]-a[3],e),b[0]+=(a[3]-a[1])/2);d[1]!==null?f=v(E(f,b[2]-v(a[0],a[2])),e):(f=v(E(f,b[2]-a[0]-a[2]),e),
b[1]+=(a[0]-a[2])/2);f<b[2]?(b[2]=f,b[3]=Math.min(/%$/.test(c.innerSize||0)?f*parseFloat(c.innerSize||0)/100:parseFloat(c.innerSize||0),f),this.translate(b),this.drawDataLabels&&this.drawDataLabels()):g=!0;return g};if(K.column)K.column.prototype.alignDataLabel=function(a,b,c,d,e){var f=this.chart.inverted,g=a.series,h=a.dlBox||a.shapeArgs,i=q(a.below,a.plotY>q(this.translatedThreshold,g.yAxis.len)),j=q(c.inside,!!this.options.stacking);if(h){d=C(h);if(d.y<0)d.height+=d.y,d.y=0;h=d.y+d.height-g.yAxis.len;
h>0&&(d.height-=h);f&&(d={x:g.yAxis.len-d.y-d.height,y:g.xAxis.len-d.x-d.width,width:d.height,height:d.width});if(!j)f?(d.x+=i?0:d.width,d.width=0):(d.y+=i?d.height:0,d.height=0)}c.align=q(c.align,!f||j?"center":i?"right":"left");c.verticalAlign=q(c.verticalAlign,f||j?"middle":i?"top":"bottom");Q.prototype.alignDataLabel.call(this,a,b,c,d,e)};(function(a){var b=a.Chart,c=a.each,d=a.pick,e=a.addEvent;b.prototype.callbacks.push(function(a){function b(){var e=[];c(a.series,function(a){var b=a.options.dataLabels,
f=a.dataLabelCollections||["dataLabel"];(b.enabled||a._hasPointLabels)&&!b.allowOverlap&&a.visible&&c(f,function(b){c(a.points,function(a){if(a[b])a[b].labelrank=d(a.labelrank,a.shapeArgs&&a.shapeArgs.height),e.push(a[b])})})});a.hideOverlappingLabels(e)}b();e(a,"redraw",b)});b.prototype.hideOverlappingLabels=function(a){var b=a.length,d,e,j,k,l,m,o,p,n;for(e=0;e<b;e++)if(d=a[e])d.oldOpacity=d.opacity,d.newOpacity=1;a.sort(function(a,b){return(b.labelrank||0)-(a.labelrank||0)});for(e=0;e<b;e++){j=
a[e];for(d=e+1;d<b;++d)if(k=a[d],j&&k&&j.placed&&k.placed&&j.newOpacity!==0&&k.newOpacity!==0&&(l=j.alignAttr,m=k.alignAttr,o=j.parentGroup,p=k.parentGroup,n=2*(j.box?0:j.padding),l=!(m.x+p.translateX>l.x+o.translateX+(j.width-n)||m.x+p.translateX+(k.width-n)<l.x+o.translateX||m.y+p.translateY>l.y+o.translateY+(j.height-n)||m.y+p.translateY+(k.height-n)<l.y+o.translateY)))(j.labelrank<k.labelrank?j:k).newOpacity=0}c(a,function(a){var b,c;if(a){c=a.newOpacity;if(a.oldOpacity!==c&&a.placed)c?a.show(!0):
b=function(){a.hide()},a.alignAttr.opacity=c,a[a.isOld?"animate":"attr"](a.alignAttr,null,b);a.isOld=!0}})}})(z);var nb=z.TrackerMixin={drawTrackerPoint:function(){var a=this,b=a.chart,c=b.pointer,d=a.options.cursor,e=d&&{cursor:d},f=function(a){for(var c=a.target,d;c&&!d;)d=c.point,c=c.parentNode;if(d!==t&&d!==b.hoverPoint)d.onMouseOver(a)};n(a.points,function(a){if(a.graphic)a.graphic.element.point=a;if(a.dataLabel)a.dataLabel.element.point=a});if(!a._hasTracking)n(a.trackerGroups,function(b){if(a[b]&&
(a[b].addClass("highcharts-tracker").on("mouseover",f).on("mouseout",function(a){c.onTrackerMouseOut(a)}).css(e),db))a[b].on("touchstart",f)}),a._hasTracking=!0},drawTrackerGraph:function(){var a=this,b=a.options,c=b.trackByArea,d=[].concat(c?a.areaPath:a.graphPath),e=d.length,f=a.chart,g=f.pointer,h=f.renderer,i=f.options.tooltip.snap,j=a.tracker,k=b.cursor,l=k&&{cursor:k},m=function(){if(f.hoverSeries!==a)a.onMouseOver()},o="rgba(192,192,192,"+(ja?1.0E-4:0.002)+")";if(e&&!c)for(k=e+1;k--;)d[k]===
"M"&&d.splice(k+1,0,d[k+1]-i,d[k+2],"L"),(k&&d[k]==="M"||k===e)&&d.splice(k,0,"L",d[k-2]+i,d[k-1]);j?j.attr({d:d}):(a.tracker=h.path(d).attr({"stroke-linejoin":"round",visibility:a.visible?"visible":"hidden",stroke:o,fill:c?o:"none","stroke-width":b.lineWidth+(c?0:2*i),zIndex:2}).add(a.group),n([a.tracker,a.markerGroup],function(a){a.addClass("highcharts-tracker").on("mouseover",m).on("mouseout",function(a){g.onTrackerMouseOut(a)}).css(l);if(db)a.on("touchstart",m)}))}};if(K.column)Ia.prototype.drawTracker=
nb.drawTrackerPoint;if(K.pie)K.pie.prototype.drawTracker=nb.drawTrackerPoint;if(K.scatter)za.prototype.drawTracker=nb.drawTrackerPoint;x(vb.prototype,{setItemEvents:function(a,b,c,d,e){var f=this;(c?b:a.legendGroup).on("mouseover",function(){a.setState("hover");b.css(f.options.itemHoverStyle)}).on("mouseout",function(){b.css(a.visible?d:e);a.setState()}).on("click",function(b){var c=function(){a.setVisible&&a.setVisible()},b={browserEvent:b};a.firePointEvent?a.firePointEvent("legendItemClick",b,c):
M(a,"legendItemClick",b,c)})},createCheckboxForItem:function(a){a.checkbox=ea("input",{type:"checkbox",checked:a.selected,defaultChecked:a.selected},this.options.itemCheckboxStyle,this.chart.container);D(a.checkbox,"click",function(b){M(a.series||a,"checkboxClick",{checked:b.target.checked,item:a},function(){a.select()})})}});N.legend.itemStyle.cursor="pointer";x(Ca.prototype,{showResetZoom:function(){var a=this,b=N.lang,c=a.options.chart.resetZoomButton,d=c.theme,e=d.states,f=c.relativeTo==="chart"?
null:"plotBox";this.resetZoomButton=a.renderer.button(b.resetZoom,null,null,function(){a.zoomOut()},d,e&&e.hover).attr({align:c.position.align,title:b.resetZoomTitle}).add().align(c.position,!1,f)},zoomOut:function(){var a=this;M(a,"selection",{resetSelection:!0},function(){a.zoom()})},zoom:function(a){var b,c=this.pointer,d=!1,e;!a||a.resetSelection?n(this.axes,function(a){b=a.zoom()}):n(a.xAxis.concat(a.yAxis),function(a){var e=a.axis,h=e.isXAxis;if(c[h?"zoomX":"zoomY"]||c[h?"pinchX":"pinchY"])b=
e.zoom(a.min,a.max),e.displayBtn&&(d=!0)});e=this.resetZoomButton;if(d&&!e)this.showResetZoom();else if(!d&&da(e))this.resetZoomButton=e.destroy();b&&this.redraw(q(this.options.chart.animation,a&&a.animation,this.pointCount<100))},pan:function(a,b){var c=this,d=c.hoverPoints,e;d&&n(d,function(a){a.setState()});n(b==="xy"?[1,0]:[1],function(b){var b=c[b?"xAxis":"yAxis"][0],d=b.horiz,h=a[d?"chartX":"chartY"],d=d?"mouseDownX":"mouseDownY",i=c[d],j=(b.pointRange||0)/2,k=b.getExtremes(),l=b.toValue(i-
h,!0)+j,j=b.toValue(i+b.len-h,!0)-j,i=i>h;if(b.series.length&&(i||l>E(k.dataMin,k.min))&&(!i||j<v(k.dataMax,k.max)))b.setExtremes(l,j,!1,!1,{trigger:"pan"}),e=!0;c[d]=h});e&&c.redraw(!1);F(c.container,{cursor:"move"})}});x(Ha.prototype,{select:function(a,b){var c=this,d=c.series,e=d.chart,a=q(a,!c.selected);c.firePointEvent(a?"select":"unselect",{accumulate:b},function(){c.selected=c.options.selected=a;d.options.data[sa(c,d.data)]=c.options;c.setState(a&&"select");b||n(e.getSelectedPoints(),function(a){if(a.selected&&
a!==c)a.selected=a.options.selected=!1,d.options.data[sa(a,d.data)]=a.options,a.setState(""),a.firePointEvent("unselect")})})},onMouseOver:function(a,b){var c=this.series,d=c.chart,e=d.tooltip,f=d.hoverPoint;if(d.hoverSeries!==c)c.onMouseOver();if(f&&f!==this)f.onMouseOut();if(this.series&&(this.firePointEvent("mouseOver"),e&&(!e.shared||c.noSharedTooltip)&&e.refresh(this,a),this.setState("hover"),!b))d.hoverPoint=this},onMouseOut:function(){var a=this.series.chart,b=a.hoverPoints;this.firePointEvent("mouseOut");
if(!b||sa(this,b)===-1)this.setState(),a.hoverPoint=null},importEvents:function(){if(!this.hasImportedEvents){var a=C(this.series.options.point,this.options).events,b;this.events=a;for(b in a)D(this,b,a[b]);this.hasImportedEvents=!0}},setState:function(a,b){var c=V(this.plotX),d=this.plotY,e=this.series,f=e.options.states,g=W[e.type].marker&&e.options.marker,h=g&&!g.enabled,i=g&&g.states[a],j=i&&i.enabled===!1,k=e.stateMarkerGraphic,l=this.marker||{},m=e.chart,o=e.halo,p,a=a||"";p=this.pointAttr[a]||
e.pointAttr[a];if(!(a===this.state&&!b||this.selected&&a!=="select"||f[a]&&f[a].enabled===!1||a&&(j||h&&i.enabled===!1)||a&&l.states&&l.states[a]&&l.states[a].enabled===!1)){if(this.graphic)g=g&&this.graphic.symbolName&&p.r,this.graphic.attr(C(p,g?{x:c-g,y:d-g,width:2*g,height:2*g}:{})),k&&k.hide();else{if(a&&i)if(g=i.radius,l=l.symbol||e.symbol,k&&k.currentSymbol!==l&&(k=k.destroy()),k)k[b?"animate":"attr"]({x:c-g,y:d-g});else if(l)e.stateMarkerGraphic=k=m.renderer.symbol(l,c-g,d-g,2*g,2*g).attr(p).add(e.markerGroup),
k.currentSymbol=l;if(k)k[a&&m.isInsidePlot(c,d,m.inverted)?"show":"hide"](),k.element.point=this}if((c=f[a]&&f[a].halo)&&c.size){if(!o)e.halo=o=m.renderer.path().add(m.seriesGroup);o.attr(x({fill:this.color||e.color,"fill-opacity":c.opacity,zIndex:-1},c.attributes))[b?"animate":"attr"]({d:this.haloPath(c.size)})}else o&&o.attr({d:[]});this.state=a}},haloPath:function(a){var b=this.series,c=b.chart,d=b.getPlotBox(),e=c.inverted,f=Math.floor(this.plotX);return c.renderer.symbols.circle(d.translateX+
(e?b.yAxis.len-this.plotY:f)-a,d.translateY+(e?b.xAxis.len-f:this.plotY)-a,a*2,a*2)}});x(Q.prototype,{onMouseOver:function(){var a=this.chart,b=a.hoverSeries;if(b&&b!==this)b.onMouseOut();this.options.events.mouseOver&&M(this,"mouseOver");this.setState("hover");a.hoverSeries=this},onMouseOut:function(){var a=this.options,b=this.chart,c=b.tooltip,d=b.hoverPoint;b.hoverSeries=null;if(d)d.onMouseOut();this&&a.events.mouseOut&&M(this,"mouseOut");c&&!a.stickyTracking&&(!c.shared||this.noSharedTooltip)&&
c.hide();this.setState()},setState:function(a){var b=this.options,c=this.graph,d=b.states,e=b.lineWidth,b=0,a=a||"";if(this.state!==a&&(this.state=a,!(d[a]&&d[a].enabled===!1)&&(a&&(e=d[a].lineWidth||e+(d[a].lineWidthPlus||0)),c&&!c.dashstyle))){a={"stroke-width":e};for(c.attr(a);this["zoneGraph"+b];)this["zoneGraph"+b].attr(a),b+=1}},setVisible:function(a,b){var c=this,d=c.chart,e=c.legendItem,f,g=d.options.chart.ignoreHiddenSeries,h=c.visible;f=(c.visible=a=c.userOptions.visible=a===t?!h:a)?"show":
"hide";n(["group","dataLabelsGroup","markerGroup","tracker"],function(a){if(c[a])c[a][f]()});if(d.hoverSeries===c||(d.hoverPoint&&d.hoverPoint.series)===c)c.onMouseOut();e&&d.legend.colorizeItem(c,a);c.isDirty=!0;c.options.stacking&&n(d.series,function(a){if(a.options.stacking&&a.visible)a.isDirty=!0});n(c.linkedSeries,function(b){b.setVisible(a,!1)});if(g)d.isDirtyBox=!0;b!==!1&&d.redraw();M(c,f)},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)},select:function(a){this.selected=
a=a===t?!this.selected:a;if(this.checkbox)this.checkbox.checked=a;M(this,a?"select":"unselect")},drawTracker:nb.drawTrackerGraph});U(Q.prototype,"init",function(a){var b;a.apply(this,Array.prototype.slice.call(arguments,1));(b=this.xAxis)&&b.options.ordinal&&D(this,"updatedData",function(){delete b.ordinalIndex})});U(I.prototype,"getTimeTicks",function(a,b,c,d,e,f,g,h){var i=0,j,k,l={},m,o,p,n=[],q=-Number.MAX_VALUE,v=this.options.tickPixelInterval;if(!this.options.ordinal&&!this.options.breaks||
!f||f.length<3||c===t)return a.call(this,b,c,d,e);o=f.length;for(j=0;j<o;j++){p=j&&f[j-1]>d;f[j]<c&&(i=j);if(j===o-1||f[j+1]-f[j]>g*5||p){if(f[j]>q){for(k=a.call(this,b,f[i],f[j],e);k.length&&k[0]<=q;)k.shift();k.length&&(q=k[k.length-1]);n=n.concat(k)}i=j+1}if(p)break}a=k.info;if(h&&a.unitRange<=H.hour){j=n.length-1;for(i=1;i<j;i++)ma("%d",n[i])!==ma("%d",n[i-1])&&(l[n[i]]="day",m=!0);m&&(l[n[0]]="day");a.higherRanks=l}n.info=a;if(h&&s(v)){h=a=n.length;j=[];var u;for(m=[];h--;)i=this.translate(n[h]),
u&&(m[h]=u-i),j[h]=u=i;m.sort();m=m[V(m.length/2)];m<v*0.6&&(m=null);h=n[a-1]>d?a-1:a;for(u=void 0;h--;)i=j[h],d=u-i,u&&d<v*0.8&&(m===null||d<m*0.8)?(l[n[h]]&&!l[n[h+1]]?(d=h+1,u=i):d=h,n.splice(d,1)):u=i}return n});x(I.prototype,{beforeSetTickPositions:function(){var a,b=[],c=!1,d,e=this.getExtremes(),f=e.min,g=e.max,h,i=this.isXAxis&&!!this.options.breaks;if((e=this.options.ordinal)||i){n(this.series,function(c,d){if(c.visible!==!1&&(c.takeOrdinalPosition!==!1||i))if(b=b.concat(c.processedXData),
a=b.length,b.sort(function(a,b){return a-b}),a)for(d=a-1;d--;)b[d]===b[d+1]&&b.splice(d,1)});a=b.length;if(a>2){d=b[1]-b[0];for(h=a-1;h--&&!c;)b[h+1]-b[h]!==d&&(c=!0);if(!this.options.keepOrdinalPadding&&(b[0]-f>d||g-b[b.length-1]>d))c=!0}c?(this.ordinalPositions=b,d=this.val2lin(v(f,b[0]),!0),h=v(this.val2lin(E(g,b[b.length-1]),!0),1),this.ordinalSlope=g=(g-f)/(h-d),this.ordinalOffset=f-d*g):this.ordinalPositions=this.ordinalSlope=this.ordinalOffset=t}this.isOrdinal=e&&c;this.groupIntervalFactor=
null},val2lin:function(a,b){var c=this.ordinalPositions,d;if(c){var e=c.length,f;for(d=e;d--;)if(c[d]===a){f=d;break}for(d=e-1;d--;)if(a>c[d]||d===0){c=(a-c[d])/(c[d+1]-c[d]);f=d+c;break}d=b?f:this.ordinalSlope*(f||0)+this.ordinalOffset}else d=a;return d},lin2val:function(a,b){var c=this.ordinalPositions;if(c){var d=this.ordinalSlope,e=this.ordinalOffset,f=c.length-1,g,h;if(b)a<0?a=c[0]:a>f?a=c[f]:(f=V(a),h=a-f);else for(;f--;)if(g=d*f+e,a>=g){d=d*(f+1)+e;h=(a-g)/(d-g);break}c=h!==t&&c[f]!==t?c[f]+
(h?h*(c[f+1]-c[f]):0):a}else c=a;return c},getExtendedPositions:function(){var a=this.chart,b=this.series[0].currentDataGrouping,c=this.ordinalIndex,d=b?b.count+b.unitName:"raw",e=this.getExtremes(),f,g;if(!c)c=this.ordinalIndex={};if(!c[d])f={series:[],getExtremes:function(){return{min:e.dataMin,max:e.dataMax}},options:{ordinal:!0},val2lin:I.prototype.val2lin},n(this.series,function(c){g={xAxis:f,xData:c.xData,chart:a,destroyGroupedData:ra};g.options={dataGrouping:b?{enabled:!0,forced:!0,approximation:"open",
units:[[b.unitName,[b.count]]]}:{enabled:!1}};c.processData.apply(g);f.series.push(g)}),this.beforeSetTickPositions.apply(f),c[d]=f.ordinalPositions;return c[d]},getGroupIntervalFactor:function(a,b,c){var d,c=c.processedXData,e=c.length,f=[];d=this.groupIntervalFactor;if(!d){for(d=0;d<e-1;d++)f[d]=c[d+1]-c[d];f.sort(function(a,b){return a-b});f=f[V(e/2)];a=v(a,c[0]);b=E(b,c[e-1]);this.groupIntervalFactor=d=e*f/(b-a)}return d},postProcessTickInterval:function(a){var b=this.ordinalSlope;return b?this.options.breaks?
this.closestPointRange:a/(b/this.closestPointRange):a}});U(Ca.prototype,"pan",function(a,b){var c=this.xAxis[0],d=b.chartX,e=!1;if(c.options.ordinal&&c.series.length){var f=this.mouseDownX,g=c.getExtremes(),h=g.dataMax,i=g.min,j=g.max,k=this.hoverPoints,l=c.closestPointRange,f=(f-d)/(c.translationSlope*(c.ordinalSlope||l)),m={ordinalPositions:c.getExtendedPositions()},l=c.lin2val,o=c.val2lin,p;if(m.ordinalPositions){if(S(f)>1)k&&n(k,function(a){a.setState()}),f<0?(k=m,p=c.ordinalPositions?c:m):(k=
c.ordinalPositions?c:m,p=m),m=p.ordinalPositions,h>m[m.length-1]&&m.push(h),this.fixedRange=j-i,f=c.toFixedRange(null,null,l.apply(k,[o.apply(k,[i,!0])+f,!0]),l.apply(p,[o.apply(p,[j,!0])+f,!0])),f.min>=E(g.dataMin,i)&&f.max<=v(h,j)&&c.setExtremes(f.min,f.max,!0,!1,{trigger:"pan"}),this.mouseDownX=d,F(this.container,{cursor:"move"})}else e=!0}else e=!0;e&&a.apply(this,Array.prototype.slice.call(arguments,1))});Q.prototype.gappedPath=function(){var a=this.options.gapSize,b=this.points.slice(),c=b.length-
1;if(a&&c>0)for(;c--;)b[c+1].x-b[c].x>this.closestPointRange*a&&b.splice(c+1,0,{isNull:!0});return this.getGraphPath(b)};(function(a){a(z)})(function(a){function b(){return Array.prototype.slice.call(arguments,1)}function c(a){a.apply(this);this.drawBreaks(this.xAxis,["x"]);this.drawBreaks(this.yAxis,d(this.pointArrayMap,["y"]))}var d=a.pick,e=a.wrap,f=a.each,g=a.extend,h=a.fireEvent,i=a.Axis,j=a.Series;g(i.prototype,{isInBreak:function(a,b){var c=a.repeat||Infinity,d=a.from,e=a.to-a.from,c=b>=d?
(b-d)%c:c-(d-b)%c;return a.inclusive?c<=e:c<e&&c!==0},isInAnyBreak:function(a,b){var c=this.options.breaks,e=c&&c.length,f,g,h;if(e){for(;e--;)this.isInBreak(c[e],a)&&(f=!0,g||(g=d(c[e].showPoints,this.isXAxis?!1:!0)));h=f&&b?f&&!g:f}return h}});e(i.prototype,"setTickPositions",function(a){a.apply(this,Array.prototype.slice.call(arguments,1));if(this.options.breaks){var b=this.tickPositions,c=this.tickPositions.info,d=[],e;for(e=0;e<b.length;e++)this.isInAnyBreak(b[e])||d.push(b[e]);this.tickPositions=
d;this.tickPositions.info=c}});e(i.prototype,"init",function(a,b,c){if(c.breaks&&c.breaks.length)c.ordinal=!1;a.call(this,b,c);if(this.options.breaks){var d=this;d.isBroken=!0;this.val2lin=function(a){var b=a,c,e;for(e=0;e<d.breakArray.length;e++)if(c=d.breakArray[e],c.to<=a)b-=c.len;else if(c.from>=a)break;else if(d.isInBreak(c,a)){b-=a-c.from;break}return b};this.lin2val=function(a){var b,c;for(c=0;c<d.breakArray.length;c++)if(b=d.breakArray[c],b.from>=a)break;else b.to<a?a+=b.len:d.isInBreak(b,
a)&&(a+=b.len);return a};this.setExtremes=function(a,b,c,d,e){for(;this.isInAnyBreak(a);)a-=this.closestPointRange;for(;this.isInAnyBreak(b);)b-=this.closestPointRange;i.prototype.setExtremes.call(this,a,b,c,d,e)};this.setAxisTranslation=function(a){i.prototype.setAxisTranslation.call(this,a);var b=d.options.breaks,a=[],c=[],e=0,f,g,k=d.userMin||d.min,j=d.userMax||d.max,l,m;for(m in b)g=b[m],f=g.repeat||Infinity,d.isInBreak(g,k)&&(k+=g.to%f-k%f),d.isInBreak(g,j)&&(j-=j%f-g.from%f);for(m in b){g=b[m];
l=g.from;for(f=g.repeat||Infinity;l-f>k;)l-=f;for(;l<k;)l+=f;for(;l<j;l+=f)a.push({value:l,move:"in"}),a.push({value:l+(g.to-g.from),move:"out",size:g.breakSize})}a.sort(function(a,b){return a.value===b.value?(a.move==="in"?0:1)-(b.move==="in"?0:1):a.value-b.value});b=0;l=k;for(m in a){g=a[m];b+=g.move==="in"?1:-1;if(b===1&&g.move==="in")l=g.value;b===0&&(c.push({from:l,to:g.value,len:g.value-l-(g.size||0)}),e+=g.value-l-(g.size||0))}d.breakArray=c;h(d,"afterBreaks");d.transA*=(j-d.min)/(j-k-e);d.min=
k;d.max=j}}});e(j.prototype,"generatePoints",function(a){a.apply(this,b(arguments));var c=this.xAxis,d=this.yAxis,e=this.points,f,g=e.length,h=this.options.connectNulls,i;if(c&&d&&(c.options.breaks||d.options.breaks))for(;g--;)if(f=e[g],i=f.y===null&&h===!1,!i&&(c.isInAnyBreak(f.x,!0)||d.isInAnyBreak(f.y,!0)))e.splice(g,1),this.data[g]&&this.data[g].destroyElements()});a.Series.prototype.drawBreaks=function(a,b){var c=this,e=c.points,g,i,j,n;f(b,function(b){g=a.breakArray||[];i=a.isXAxis?a.min:d(c.options.threshold,
a.min);f(e,function(c){n=d(c["stack"+b.toUpperCase()],c[b]);f(g,function(b){j=!1;if(i<b.from&&n>b.to||i>b.from&&n<b.from)j="pointBreak";else if(i<b.from&&n>b.from&&n<b.to||i>b.from&&n>b.to&&n<b.from)j="pointInBreak";j&&h(a,j,{point:c,brk:b})})})})};e(a.seriesTypes.column.prototype,"drawPoints",c);e(a.Series.prototype,"drawPoints",c)});var ia=Q.prototype,cc=ia.processData,dc=ia.generatePoints,ec=ia.destroy,fc={approximation:"average",groupPixelWidth:2,dateTimeLabelFormats:{millisecond:["%A, %b %e, %H:%M:%S.%L",
"%A, %b %e, %H:%M:%S.%L","-%H:%M:%S.%L"],second:["%A, %b %e, %H:%M:%S","%A, %b %e, %H:%M:%S","-%H:%M:%S"],minute:["%A, %b %e, %H:%M","%A, %b %e, %H:%M","-%H:%M"],hour:["%A, %b %e, %H:%M","%A, %b %e, %H:%M","-%H:%M"],day:["%A, %b %e, %Y","%A, %b %e","-%A, %b %e, %Y"],week:["Week from %A, %b %e, %Y","%A, %b %e","-%A, %b %e, %Y"],month:["%B %Y","%B","-%B %Y"],year:["%Y","%Y","-%Y"]}},Xb={line:{},spline:{},area:{},areaspline:{},column:{approximation:"sum",groupPixelWidth:10},arearange:{approximation:"range"},
areasplinerange:{approximation:"range"},columnrange:{approximation:"range",groupPixelWidth:10},candlestick:{approximation:"ohlc",groupPixelWidth:10},ohlc:{approximation:"ohlc",groupPixelWidth:5}},Yb=[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1]],["week",[1]],["month",[1,3,6]],["year",null]],Ua={sum:function(a){var b=a.length,c;if(!b&&a.hasNulls)c=null;else if(b)for(c=0;b--;)c+=a[b];return c},average:function(a){var b=
a.length,a=Ua.sum(a);typeof a==="number"&&b&&(a/=b);return a},open:function(a){return a.length?a[0]:a.hasNulls?null:t},high:function(a){return a.length?Ea(a):a.hasNulls?null:t},low:function(a){return a.length?Oa(a):a.hasNulls?null:t},close:function(a){return a.length?a[a.length-1]:a.hasNulls?null:t},ohlc:function(a,b,c,d){a=Ua.open(a);b=Ua.high(b);c=Ua.low(c);d=Ua.close(d);if(typeof a==="number"||typeof b==="number"||typeof c==="number"||typeof d==="number")return[a,b,c,d]},range:function(a,b){a=
Ua.low(a);b=Ua.high(b);if(typeof a==="number"||typeof b==="number")return[a,b]}};ia.groupData=function(a,b,c,d){var e=this.data,f=this.options.data,g=[],h=[],i=[],j=a.length,k,l,m=!!b,o=[[],[],[],[]],d=typeof d==="function"?d:Ua[d],p=this.pointArrayMap,n=p&&p.length,q,s=0;for(q=0;q<=j;q++)if(a[q]>=c[0])break;for(;q<=j;q++){for(;c[1]!==t&&a[q]>=c[1]||q===j;)if(k=c.shift(),l=d.apply(0,o),l!==t&&(g.push(k),h.push(l),i.push({start:s,length:o[0].length})),s=q,o[0]=[],o[1]=[],o[2]=[],o[3]=[],q===j)break;
if(q===j)break;if(p){k=this.cropStart+q;k=e&&e[k]||this.pointClass.prototype.applyOptions.apply({series:this},[f[k]]);var u;for(l=0;l<n;l++)if(u=k[p[l]],typeof u==="number")o[l].push(u);else if(u===null)o[l].hasNulls=!0}else if(k=m?b[q]:null,typeof k==="number")o[0].push(k);else if(k===null)o[0].hasNulls=!0}return[g,h,i]};ia.processData=function(){var a=this.chart,b=this.options.dataGrouping,c=this.allowDG!==!1&&b&&q(b.enabled,a.options._stock),d;this.forceCrop=c;this.groupPixelWidth=null;this.hasProcessed=
!0;if(cc.apply(this,arguments)!==!1&&c){this.destroyGroupedData();var e=this.processedXData,f=this.processedYData,g=a.plotSizeX,a=this.xAxis,h=a.options.ordinal,i=this.groupPixelWidth=a.getGroupPixelWidth&&a.getGroupPixelWidth();if(i){d=!0;this.points=null;var j=a.getExtremes(),c=j.min,j=j.max,h=h&&a.getGroupIntervalFactor(c,j,this)||1,g=i*(j-c)/g*h,i=a.getTimeTicks(a.normalizeTimeTickInterval(g,b.units||Yb),Math.min(c,e[0]),Math.max(j,e[e.length-1]),a.options.startOfWeek,e,this.closestPointRange),
e=ia.groupData.apply(this,[e,f,i,b.approximation]),f=e[0],h=e[1];if(b.smoothed){b=f.length-1;for(f[b]=Math.min(f[b],j);b--&&b>0;)f[b]+=g/2;f[0]=Math.max(f[0],c)}this.currentDataGrouping=i.info;this.closestPointRange=i.info.totalRange;this.groupMap=e[2];if(s(f[0])&&f[0]<a.dataMin){if(a.min===a.dataMin)a.min=f[0];a.dataMin=f[0]}this.processedXData=f;this.processedYData=h}else this.currentDataGrouping=this.groupMap=null;this.hasGroupedData=d}};ia.destroyGroupedData=function(){var a=this.groupedData;
n(a||[],function(b,c){b&&(a[c]=b.destroy?b.destroy():null)});this.groupedData=null};ia.generatePoints=function(){dc.apply(this);this.destroyGroupedData();this.groupedData=this.hasGroupedData?this.points:null};U(Lb.prototype,"tooltipFooterHeaderFormatter",function(a,b,c){var d=b.series,e=d.tooltipOptions,f=d.options.dataGrouping,g=e.xDateFormat,h,i=d.xAxis;return i&&i.options.type==="datetime"&&f&&ua(b.key)?(a=d.currentDataGrouping,f=f.dateTimeLabelFormats,a?(i=f[a.unitName],a.count===1?g=i[0]:(g=
i[1],h=i[2])):!g&&f&&(g=this.getXDateFormat(b,e,i)),g=ma(g,b.key),h&&(g+=ma(h,b.key+a.totalRange-1)),La(e[(c?"footer":"header")+"Format"],{point:x(b,{key:g}),series:d})):a.call(this,b,c)});ia.destroy=function(){for(var a=this.groupedData||[],b=a.length;b--;)a[b]&&a[b].destroy();ec.apply(this)};U(ia,"setOptions",function(a,b){var c=a.call(this,b),d=this.type,e=this.chart.options.plotOptions,f=W[d].dataGrouping;if(Xb[d])f||(f=C(fc,Xb[d])),c.dataGrouping=C(f,e.series&&e.series.dataGrouping,e[d].dataGrouping,
b.dataGrouping);if(this.chart.options._stock)this.requireSorting=!0;return c});U(I.prototype,"setScale",function(a){a.call(this);n(this.series,function(a){a.hasProcessed=!1})});I.prototype.getGroupPixelWidth=function(){var a=this.series,b=a.length,c,d=0,e=!1,f;for(c=b;c--;)(f=a[c].options.dataGrouping)&&(d=v(d,f.groupPixelWidth));for(c=b;c--;)if((f=a[c].options.dataGrouping)&&a[c].hasProcessed)if(b=(a[c].processedXData||a[c].data).length,a[c].groupPixelWidth||b>this.chart.plotSizeX/d||b&&f.forced)e=
!0;return e?d:0};I.prototype.setDataGrouping=function(a,b){var c,b=q(b,!0);a||(a={forced:!1,units:null});if(this instanceof I)for(c=this.series.length;c--;)this.series[c].update({dataGrouping:a},!1);else n(this.chart.options.series,function(b){b.dataGrouping=a},!1);b&&this.chart.redraw()};W.ohlc=C(W.column,{lineWidth:1,tooltip:{pointFormat:'<span style="color:{point.color}">\u25cf</span> <b> {series.name}</b><br/>Open: {point.open}<br/>High: {point.high}<br/>Low: {point.low}<br/>Close: {point.close}<br/>'},
states:{hover:{lineWidth:3}},threshold:null});ca=la(K.column,{type:"ohlc",pointArrayMap:["open","high","low","close"],toYData:function(a){return[a.open,a.high,a.low,a.close]},pointValKey:"high",pointAttrToOptions:{stroke:"color","stroke-width":"lineWidth"},upColorProp:"stroke",getAttribs:function(){K.column.prototype.getAttribs.apply(this,arguments);var a=this.options,b=a.states,a=a.upColor||this.color,c=C(this.pointAttr),d=this.upColorProp;c[""][d]=a;c.hover[d]=b.hover.upColor||a;c.select[d]=b.select.upColor||
a;n(this.points,function(a){if(a.open<a.close&&!a.options.color)a.pointAttr=c})},translate:function(){var a=this.yAxis;K.column.prototype.translate.apply(this);n(this.points,function(b){if(b.open!==null)b.plotOpen=a.translate(b.open,0,1,0,1);if(b.close!==null)b.plotClose=a.translate(b.close,0,1,0,1)})},drawPoints:function(){var a=this,b=a.chart,c,d,e,f,g,h,i,j;n(a.points,function(k){if(k.plotY!==t)i=k.graphic,c=k.pointAttr[k.selected?"selected":""]||a.pointAttr[""],f=c["stroke-width"]%2/2,j=y(k.plotX)-
f,g=y(k.shapeArgs.width/2),h=["M",j,y(k.yBottom),"L",j,y(k.plotY)],k.open!==null&&(d=y(k.plotOpen)+f,h.push("M",j,d,"L",j-g,d)),k.close!==null&&(e=y(k.plotClose)+f,h.push("M",j,e,"L",j+g,e)),i?i.attr(c).animate({d:h}):k.graphic=b.renderer.path(h).attr(c).add(a.group)})},animate:null});K.ohlc=ca;W.candlestick=C(W.column,{lineColor:"black",lineWidth:1,states:{hover:{lineWidth:2}},tooltip:W.ohlc.tooltip,threshold:null,upColor:"white"});ca=la(ca,{type:"candlestick",pointAttrToOptions:{fill:"color",stroke:"lineColor",
"stroke-width":"lineWidth"},upColorProp:"fill",getAttribs:function(){K.ohlc.prototype.getAttribs.apply(this,arguments);var a=this.options,b=a.states,c=a.upLineColor||a.lineColor,d=b.hover.upLineColor||c,e=b.select.upLineColor||c;n(this.points,function(a){if(a.open<a.close){if(a.lineColor)a.pointAttr=C(a.pointAttr),c=a.lineColor;a.pointAttr[""].stroke=c;a.pointAttr.hover.stroke=d;a.pointAttr.select.stroke=e}})},drawPoints:function(){var a=this,b=a.chart,c,d=a.pointAttr[""],e,f,g,h,i,j,k,l,m,o,p;n(a.points,
function(n){m=n.graphic;if(n.plotY!==t)c=n.pointAttr[n.selected?"selected":""]||d,k=c["stroke-width"]%2/2,l=y(n.plotX)-k,e=n.plotOpen,f=n.plotClose,g=Y.min(e,f),h=Y.max(e,f),p=y(n.shapeArgs.width/2),i=y(g)!==y(n.plotY),j=h!==n.yBottom,g=y(g)+k,h=y(h)+k,o=["M",l-p,h,"L",l-p,g,"L",l+p,g,"L",l+p,h,"Z","M",l,g,"L",l,i?y(n.plotY):g,"M",l,h,"L",l,j?y(n.yBottom):h],m?m.attr(c).animate({d:o}):n.graphic=b.renderer.path(o).attr(c).add(a.group).shadow(a.options.shadow)})}});K.candlestick=ca;var wb=ya.prototype.symbols;
W.flags=C(W.column,{fillColor:"white",lineWidth:1,pointRange:0,shape:"flag",stackDistance:12,states:{hover:{lineColor:"black",fillColor:"#FCFFC5"}},style:{fontSize:"11px",fontWeight:"bold",textAlign:"center"},tooltip:{pointFormat:"{point.text}<br/>"},threshold:null,y:-30});K.flags=la(K.column,{type:"flags",sorted:!1,noSharedTooltip:!0,allowDG:!1,takeOrdinalPosition:!1,trackerGroups:["markerGroup"],forceCrop:!0,init:Q.prototype.init,pointAttrToOptions:{fill:"fillColor",stroke:"color","stroke-width":"lineWidth",
r:"radius"},translate:function(){K.column.prototype.translate.apply(this);var a=this.options,b=this.chart,c=this.points,d=c.length-1,e,f,g=a.onSeries;e=g&&b.get(g);var a=a.onKey||"y",g=e&&e.options.step,h=e&&e.points,i=h&&h.length,j=this.xAxis,k=j.getExtremes(),l,m,o;if(e&&e.visible&&i){e=e.currentDataGrouping;m=h[i-1].x+(e?e.totalRange:0);c.sort(function(a,b){return a.x-b.x});for(a="plot"+a[0].toUpperCase()+a.substr(1);i--&&c[d];)if(e=c[d],l=h[i],l.x<=e.x&&l[a]!==void 0){if(e.x<=m)e.plotY=l[a],l.x<
e.x&&!g&&(o=h[i+1])&&o[a]!==t&&(e.plotY+=(e.x-l.x)/(o.x-l.x)*(o[a]-l[a]));d--;i++;if(d<0)break}}n(c,function(a,d){var e;if(a.plotY===t)a.x>=k.min&&a.x<=k.max?a.plotY=b.chartHeight-j.bottom-(j.opposite?j.height:0)+j.offset-b.plotTop:a.shapeArgs={};if((f=c[d-1])&&f.plotX===a.plotX){if(f.stackIndex===t)f.stackIndex=0;e=f.stackIndex+1}a.stackIndex=e})},drawPoints:function(){var a,b=this.pointAttr[""],c=this.points,d=this.chart,e=d.renderer,f,g,h=this.options,i=h.y,j,k,l,m,o,n,r=this.yAxis;for(k=c.length;k--;)if(l=
c[k],a=l.plotX>this.xAxis.len,f=l.plotX,f>0&&(f-=q(l.lineWidth,h.lineWidth)%2),m=l.stackIndex,j=l.options.shape||h.shape,g=l.plotY,g!==t&&(g=l.plotY+i-(m!==t&&m*h.stackDistance)),o=m?t:l.plotX,n=m?t:l.plotY,m=l.graphic,g!==t&&f>=0&&!a)a=l.pointAttr[l.selected?"select":""]||b,m?m.attr({x:f,y:g,r:a.r,anchorX:o,anchorY:n}):l.graphic=e.label(l.options.title||h.title||"A",f,g,j,o,n,h.useHTML).css(C(h.style,l.style)).attr(a).attr({align:j==="flag"?"left":"center",width:h.width,height:h.height}).add(this.markerGroup).shadow(h.shadow),
l.tooltipPos=d.inverted?[r.len+r.pos-d.plotLeft-g,this.xAxis.len-f]:[f,g];else if(m)l.graphic=m.destroy()},drawTracker:function(){var a=this.points;nb.drawTrackerPoint.apply(this);n(a,function(b){var c=b.graphic;c&&D(c.element,"mouseover",function(){if(b.stackIndex>0&&!b.raised)b._y=c.y,c.attr({y:b._y-8}),b.raised=!0;n(a,function(a){if(a!==b&&a.raised&&a.graphic)a.graphic.attr({y:a._y}),a.raised=!1})})})},animate:ra,buildKDTree:ra,setClip:ra});wb.flag=function(a,b,c,d,e){return["M",e&&e.anchorX||
a,e&&e.anchorY||b,"L",a,b+d,a,b,a+c,b,a+c,b+d,a,b+d,"Z"]};n(["circle","square"],function(a){wb[a+"pin"]=function(b,c,d,e,f){var g=f&&f.anchorX,f=f&&f.anchorY;a==="circle"&&e>d&&(b-=y((e-d)/2),d=e);b=wb[a](b,c,d,e);g&&f&&b.push("M",g,c>f?c:c+e,"L",g,f);return b}});Ya===z.VMLRenderer&&n(["flag","circlepin","squarepin"],function(a){mb.prototype.symbols[a]=wb[a]});var ca=[].concat(Yb),xb=function(a){var b=Sa(arguments,function(a){return typeof a==="number"});if(b.length)return Math[a].apply(0,b)};ca[4]=
["day",[1,2,3,4]];ca[5]=["week",[1,2,3]];x(N,{navigator:{handles:{backgroundColor:"#ebe7e8",borderColor:"#b2b1b6"},height:40,margin:25,maskFill:"rgba(128,179,236,0.3)",maskInside:!0,outlineColor:"#b2b1b6",outlineWidth:1,series:{type:K.areaspline===t?"line":"areaspline",color:"#4572A7",compare:null,fillOpacity:0.05,dataGrouping:{approximation:"average",enabled:!0,groupPixelWidth:2,smoothed:!0,units:ca},dataLabels:{enabled:!1,zIndex:2},id:"highcharts-navigator-series",lineColor:null,lineWidth:1,marker:{enabled:!1},
pointRange:0,shadow:!1,threshold:null},xAxis:{tickWidth:0,lineWidth:0,gridLineColor:"#EEE",gridLineWidth:1,tickPixelInterval:200,labels:{align:"left",style:{color:"#888"},x:3,y:-4},crosshair:!1},yAxis:{gridLineWidth:0,startOnTick:!1,endOnTick:!1,minPadding:0.1,maxPadding:0.1,labels:{enabled:!1},crosshair:!1,title:{text:null},tickWidth:0}},scrollbar:{height:kb?20:14,barBackgroundColor:"#bfc8d1",barBorderRadius:0,barBorderWidth:1,barBorderColor:"#bfc8d1",buttonArrowColor:"#666",buttonBackgroundColor:"#ebe7e8",
buttonBorderColor:"#bbb",buttonBorderRadius:0,buttonBorderWidth:1,minWidth:6,rifleColor:"#666",trackBackgroundColor:"#eeeeee",trackBorderColor:"#eeeeee",trackBorderWidth:1,liveRedraw:ja&&!kb}});Hb.prototype={drawHandle:function(a,b){var c=this.chart,d=c.renderer,e=this.elementsToDestroy,f=this.handles,g=this.navigatorOptions.handles,g={fill:g.backgroundColor,stroke:g.borderColor,"stroke-width":1},h;this.rendered||(f[b]=d.g("navigator-handle-"+["left","right"][b]).css({cursor:"ew-resize"}).attr({zIndex:10-
b}).add(),h=d.rect(-4.5,0,9,16,0,1).attr(g).add(f[b]),e.push(h),h=d.path(["M",-1.5,4,"L",-1.5,12,"M",0.5,4,"L",0.5,12]).attr(g).add(f[b]),e.push(h));f[b][c.isResizing?"animate":"attr"]({translateX:this.scrollerLeft+this.scrollbarHeight+parseInt(a,10),translateY:this.top+this.height/2-8})},drawScrollbarButton:function(a){var b=this.chart.renderer,c=this.elementsToDestroy,d=this.scrollbarButtons,e=this.scrollbarHeight,f=this.scrollbarOptions,g;this.rendered||(d[a]=b.g().add(this.scrollbarGroup),g=b.rect(-0.5,
-0.5,e+1,e+1,f.buttonBorderRadius,f.buttonBorderWidth).attr({stroke:f.buttonBorderColor,"stroke-width":f.buttonBorderWidth,fill:f.buttonBackgroundColor}).add(d[a]),c.push(g),g=b.path(["M",e/2+(a?-1:1),e/2-3,"L",e/2+(a?-1:1),e/2+3,e/2+(a?2:-2),e/2]).attr({fill:f.buttonArrowColor}).add(d[a]),c.push(g));a&&d[a].attr({translateX:this.scrollerWidth-e})},render:function(a,b,c,d){var e=this.chart,f=e.renderer,g,h,i,j,k=this.scrollbarGroup,l=this.navigatorGroup,m=this.scrollbar,l=this.xAxis,o=this.scrollbarTrack,
n=this.scrollbarHeight,r=this.scrollbarEnabled,A=this.navigatorOptions,t=this.scrollbarOptions,u=t.minWidth,w=this.height,x=this.top,z=this.navigatorEnabled,C=A.outlineWidth,B=C/2,D=0,G=this.outlineHeight,I=t.barBorderRadius,H=t.barBorderWidth,F=x+B,J;if(s(a)&&!isNaN(a)&&s(b)&&!(isNaN(b)||this.hasDragged&&!s(c))){this.navigatorLeft=g=q(l.left,e.plotLeft+n);this.navigatorWidth=h=q(l.len,e.plotWidth-2*n);this.scrollerLeft=i=g-n;this.scrollerWidth=j=j=h+2*n;l.getExtremes&&(J=this.getUnionExtremes(!0))&&
(J.dataMin!==l.min||J.dataMax!==l.max)&&l.setExtremes(J.dataMin,J.dataMax,!0,!1);c=q(c,l.translate(a));d=q(d,l.translate(b));if(isNaN(c)||S(c)===Infinity)c=0,d=j;if(!(l.translate(d,!0)-l.translate(c,!0)<e.xAxis[0].minRange)){this.zoomedMax=E(v(c,d,0),h);this.zoomedMin=E(v(this.fixedWidth?this.zoomedMax-this.fixedWidth:E(c,d),0),h);this.range=this.zoomedMax-this.zoomedMin;c=y(this.zoomedMax);b=y(this.zoomedMin);a=c-b;if(!this.rendered){if(z)this.navigatorGroup=l=f.g("navigator").attr({zIndex:3}).add(),
this.leftShade=f.rect().attr({fill:A.maskFill}).add(l),A.maskInside?this.leftShade.css({cursor:"ew-resize"}):this.rightShade=f.rect().attr({fill:A.maskFill}).add(l),this.outline=f.path().attr({"stroke-width":C,stroke:A.outlineColor}).add(l);if(r)this.scrollbarGroup=k=f.g("scrollbar").add(),m=t.trackBorderWidth,this.scrollbarTrack=o=f.rect().attr({x:0,y:-m%2/2,fill:t.trackBackgroundColor,stroke:t.trackBorderColor,"stroke-width":m,r:t.trackBorderRadius||0,height:n}).add(k),this.scrollbar=m=f.rect().attr({y:-H%
2/2,height:n,fill:t.barBackgroundColor,stroke:t.barBorderColor,"stroke-width":H,r:I}).add(k),this.scrollbarRifles=f.path().attr({stroke:t.rifleColor,"stroke-width":1}).add(k)}e=e.isResizing?"animate":"attr";if(z){this.leftShade[e](A.maskInside?{x:g+b,y:x,width:c-b,height:w}:{x:g,y:x,width:b,height:w});if(this.rightShade)this.rightShade[e]({x:g+c,y:x,width:h-c,height:w});this.outline[e]({d:["M",i,F,"L",g+b-B,F,g+b-B,F+G,"L",g+c-B,F+G,"L",g+c-B,F,i+j,F].concat(A.maskInside?["M",g+b+B,F,"L",g+c-B,F]:
[])});this.drawHandle(b+B,0);this.drawHandle(c+B,1)}if(r&&k)this.drawScrollbarButton(0),this.drawScrollbarButton(1),k[e]({translateX:i,translateY:y(F+w)}),o[e]({width:j}),g=n+b,h=a-H,h<u&&(D=(u-h)/2,h=u,g-=D),this.scrollbarPad=D,m[e]({x:V(g)+H%2/2,width:h}),u=n+b+a/2-0.5,this.scrollbarRifles.attr({visibility:a>12?"visible":"hidden"})[e]({d:["M",u-3,n/4,"L",u-3,2*n/3,"M",u,n/4,"L",u,2*n/3,"M",u+3,n/4,"L",u+3,2*n/3]});this.scrollbarPad=D;this.rendered=!0}}},addEvents:function(){var a=this.chart.container,
b=this.mouseDownHandler,c=this.mouseMoveHandler,d=this.mouseUpHandler,e;e=[[a,"mousedown",b],[a,"mousemove",c],[B,"mouseup",d]];db&&e.push([a,"touchstart",b],[a,"touchmove",c],[B,"touchend",d]);n(e,function(a){D.apply(null,a)});this._events=e},removeEvents:function(){n(this._events,function(a){T.apply(null,a)});this._events=t;this.navigatorEnabled&&this.baseSeries&&T(this.baseSeries,"updatedData",this.updatedDataHandler)},init:function(){var a=this,b=a.chart,c,d,e=a.scrollbarHeight,f=a.navigatorOptions,
g=a.height,h=a.top,i,j=a.baseSeries;a.mouseDownHandler=function(d){var d=b.pointer.normalize(d),e=a.zoomedMin,f=a.zoomedMax,h=a.top,j=a.scrollbarHeight,k=a.scrollerLeft,l=a.scrollerWidth,n=a.navigatorLeft,q=a.navigatorWidth,s=a.scrollbarPad,t=a.range,v=d.chartX,x=d.chartY,d=b.xAxis[0],y,z=kb?10:7;if(x>h&&x<h+g+j)if((h=!a.scrollbarEnabled||x<h+g)&&Y.abs(v-e-n)<z)a.grabbedLeft=!0,a.otherHandlePos=f,a.fixedExtreme=d.max,b.fixedRange=null;else if(h&&Y.abs(v-f-n)<z)a.grabbedRight=!0,a.otherHandlePos=e,
a.fixedExtreme=d.min,b.fixedRange=null;else if(v>n+e-s&&v<n+f+s)a.grabbedCenter=v,a.fixedWidth=t,i=v-e;else if(v>k&&v<k+l){f=h?v-n-t/2:v<n?e-t*0.2:v>k+l-j?e+t*0.2:v<n+e?e-t:f;if(f<0)f=0;else if(f+t>=q)f=q-t,y=a.getUnionExtremes().dataMax;if(f!==e)a.fixedWidth=t,e=c.toFixedRange(f,f+t,null,y),d.setExtremes(e.min,e.max,!0,!1,{trigger:"navigator"})}};a.mouseMoveHandler=function(c){var d=a.scrollbarHeight,e=a.navigatorLeft,f=a.navigatorWidth,g=a.scrollerLeft,h=a.scrollerWidth,j=a.range,k,l;if(!c.touches||
c.touches[0].pageX!==0)c=b.pointer.normalize(c),k=c.chartX,k<e?k=e:k>g+h-d&&(k=g+h-d),a.grabbedLeft?(l=!0,a.render(0,0,k-e,a.otherHandlePos)):a.grabbedRight?(l=!0,a.render(0,0,a.otherHandlePos,k-e)):a.grabbedCenter&&(l=!0,k<i?k=i:k>f+i-j&&(k=f+i-j),a.render(0,0,k-i,k-i+j)),l&&a.scrollbarOptions.liveRedraw&&setTimeout(function(){a.mouseUpHandler(c)},0),a.hasDragged=l};a.mouseUpHandler=function(d){var e,f;if(a.hasDragged){if(a.zoomedMin===a.otherHandlePos)e=a.fixedExtreme;else if(a.zoomedMax===a.otherHandlePos)f=
a.fixedExtreme;if(a.zoomedMax===a.navigatorWidth)f=a.getUnionExtremes().dataMax;e=c.toFixedRange(a.zoomedMin,a.zoomedMax,e,f);s(e.min)&&b.xAxis[0].setExtremes(e.min,e.max,!0,!1,{trigger:"navigator",triggerOp:"navigator-drag",DOMEvent:d})}if(d.type!=="mousemove")a.grabbedLeft=a.grabbedRight=a.grabbedCenter=a.fixedWidth=a.fixedExtreme=a.otherHandlePos=a.hasDragged=i=null};var k=b.xAxis.length,l=b.yAxis.length;b.extraBottomMargin=a.outlineHeight+f.margin;a.navigatorEnabled?(a.xAxis=c=new I(b,C({breaks:j&&
j.xAxis.options.breaks,ordinal:j&&j.xAxis.options.ordinal},f.xAxis,{id:"navigator-x-axis",isX:!0,type:"datetime",index:k,height:g,offset:0,offsetLeft:e,offsetRight:-e,keepOrdinalPadding:!0,startOnTick:!1,endOnTick:!1,minPadding:0,maxPadding:0,zoomEnabled:!1})),a.yAxis=d=new I(b,C(f.yAxis,{id:"navigator-y-axis",alignTicks:!1,height:g,offset:0,index:l,zoomEnabled:!1})),j||f.series.data?a.addBaseSeries():b.series.length===0&&U(b,"redraw",function(c,d){if(b.series.length>0&&!a.series)a.setBaseSeries(),
b.redraw=c;c.call(b,d)})):a.xAxis=c={translate:function(a,c){var d=b.xAxis[0],f=d.getExtremes(),g=b.plotWidth-2*e,h=xb("min",d.options.min,f.dataMin),d=xb("max",d.options.max,f.dataMax)-h;return c?a*d/g+h:g*(a-h)/d},toFixedRange:I.prototype.toFixedRange};U(b,"getMargins",function(b){var e=this.legend,f=e.options;b.apply(this,[].slice.call(arguments,1));a.top=h=a.navigatorOptions.top||this.chartHeight-a.height-a.scrollbarHeight-this.spacing[2]-(f.verticalAlign==="bottom"&&f.enabled&&!f.floating?e.legendHeight+
q(f.margin,10):0);if(c&&d)c.options.top=d.options.top=h,c.setAxisSize(),d.setAxisSize()});a.addEvents()},getUnionExtremes:function(a){var b=this.chart.xAxis[0],c=this.xAxis,d=c.options,e=b.options,f;if(!a||b.dataMin!==null)f={dataMin:q(d&&d.min,xb("min",e.min,b.dataMin,c.dataMin)),dataMax:q(d&&d.max,xb("max",e.max,b.dataMax,c.dataMax))};return f},setBaseSeries:function(a){var b=this.chart,a=a||b.options.navigator.baseSeries;this.series&&this.series.remove();this.baseSeries=b.series[a]||typeof a===
"string"&&b.get(a)||b.series[0];this.xAxis&&this.addBaseSeries()},addBaseSeries:function(){var a=this.baseSeries,b=a?a.options:{},c=b.data,d=this.navigatorOptions.series,e;e=d.data;this.hasNavigatorData=!!e;b=C(b,d,{enableMouseTracking:!1,group:"nav",padXAxis:!1,xAxis:"navigator-x-axis",yAxis:"navigator-y-axis",name:"Navigator",showInLegend:!1,stacking:!1,isInternal:!0,visible:!0});b.data=e||c.slice(0);this.series=this.chart.initSeries(b);if(a&&this.navigatorOptions.adaptToUpdatedData!==!1)D(a,"updatedData",
this.updatedDataHandler),a.userOptions.events=x(a.userOptions.event,{updatedData:this.updatedDataHandler})},updatedDataHandler:function(){var a=this.chart.scroller,b=a.baseSeries,c=b.xAxis,d=c.getExtremes(),e=d.min,f=d.max,g=d.dataMin,d=d.dataMax,h=f-e,i,j,k,l,m,o=a.series;i=o.xData;var n=!!c.setExtremes;j=f>=i[i.length-1]-(this.closestPointRange||0);i=e<=g;if(!a.hasNavigatorData)o.options.pointStart=b.xData[0],o.setData(b.options.data,!1),m=!0;i&&(l=g,k=l+h);j&&(k=d,i||(l=v(k-h,o.xData[0])));n&&
(i||j)?isNaN(l)||c.setExtremes(l,k,!0,!1,{trigger:"updatedData"}):(m&&this.chart.redraw(!1),a.render(v(e,g),E(f,d)))},destroy:function(){this.removeEvents();n([this.xAxis,this.yAxis,this.leftShade,this.rightShade,this.outline,this.scrollbarTrack,this.scrollbarRifles,this.scrollbarGroup,this.scrollbar],function(a){a&&a.destroy&&a.destroy()});this.xAxis=this.yAxis=this.leftShade=this.rightShade=this.outline=this.scrollbarTrack=this.scrollbarRifles=this.scrollbarGroup=this.scrollbar=null;n([this.scrollbarButtons,
this.handles,this.elementsToDestroy],function(a){Pa(a)})}};z.Scroller=Hb;U(I.prototype,"zoom",function(a,b,c){var d=this.chart,e=d.options,f=e.chart.zoomType,g=e.navigator,e=e.rangeSelector,h;if(this.isXAxis&&(g&&g.enabled||e&&e.enabled))if(f==="x")d.resetZoomButton="blocked";else if(f==="y")h=!1;else if(f==="xy")d=this.previousZoom,s(b)?this.previousZoom=[this.min,this.max]:d&&(b=d[0],c=d[1],delete this.previousZoom);return h!==t?h:a.call(this,b,c)});U(Ca.prototype,"init",function(a,b,c){D(this,
"beforeRender",function(){var a=this.options;if(a.navigator.enabled||a.scrollbar.enabled)this.scroller=new Hb(this)});a.call(this,b,c)});U(Q.prototype,"addPoint",function(a,b,c,d,e){var f=this.options.turboThreshold;f&&this.xData.length>f&&da(b)&&!Ja(b)&&this.chart.scroller&&ga(20,!0);a.call(this,b,c,d,e)});x(N,{rangeSelector:{buttonTheme:{width:28,height:18,fill:"#f7f7f7",padding:2,r:0,"stroke-width":0,style:{color:"#444",cursor:"pointer",fontWeight:"normal"},zIndex:7,states:{hover:{fill:"#e7e7e7"},
select:{fill:"#e7f0f9",style:{color:"black",fontWeight:"bold"}}}},height:35,inputPosition:{align:"right"},labelStyle:{color:"#666"}}});N.lang=C(N.lang,{rangeSelectorZoom:"Zoom",rangeSelectorFrom:"From",rangeSelectorTo:"To"});Ib.prototype={clickButton:function(a,b){var c=this,d=c.selected,e=c.chart,f=c.buttons,g=c.buttonOptions[a],h=e.xAxis[0],i=e.scroller&&e.scroller.getUnionExtremes()||h||{},j=i.dataMin,k=i.dataMax,l,m=h&&y(E(h.max,q(k,h.max))),o=g.type,p,i=g._range,r,s,x,u=g.dataGrouping;if(!(j===
null||k===null||a===c.selected)){e.fixedRange=i;if(u)this.forcedDataGrouping=!0,I.prototype.setDataGrouping.call(h||{chart:this.chart},u,!1);if(o==="month"||o==="year")if(h){if(o={range:g,max:m,dataMin:j,dataMax:k},l=h.minFromRange.call(o),typeof o.newMax==="number")m=o.newMax}else i=g;else if(i)l=v(m-i,j),m=E(l+i,k);else if(o==="ytd")if(h){if(k===t)j=Number.MAX_VALUE,k=Number.MIN_VALUE,n(e.series,function(a){a=a.xData;j=E(a[0],j);k=v(a[a.length-1],k)}),b=!1;m=new fa(k);l=m.getFullYear();l=r=v(j||
0,fa.UTC(l,0,1));m=m.getTime();m=E(k||m,m)}else{D(e,"beforeRender",function(){c.clickButton(a)});return}else o==="all"&&h&&(l=j,m=k);f[d]&&f[d].setState(0);if(f[a])f[a].setState(2),c.lastSelected=a;h?(h.setExtremes(l,m,q(b,1),0,{trigger:"rangeSelectorButton",rangeSelectorButton:g}),c.setSelected(a)):(p=e.options.xAxis[0],x=p.range,p.range=i,s=p.min,p.min=r,c.setSelected(a),D(e,"load",function(){p.range=x;p.min=s}))}},setSelected:function(a){this.selected=this.options.selected=a},defaultButtons:[{type:"month",
count:1,text:"1m"},{type:"month",count:3,text:"3m"},{type:"month",count:6,text:"6m"},{type:"ytd",text:"YTD"},{type:"year",count:1,text:"1y"},{type:"all",text:"All"}],init:function(a){var b=this,c=a.options.rangeSelector,d=c.buttons||[].concat(b.defaultButtons),e=c.selected,f=b.blurInputs=function(){var a=b.minInput,c=b.maxInput;a&&a.blur&&M(a,"blur");c&&c.blur&&M(c,"blur")};b.chart=a;b.options=c;b.buttons=[];a.extraTopMargin=c.height;b.buttonOptions=d;D(a.container,"mousedown",f);D(a,"resize",f);
n(d,b.computeButtonRange);e!==t&&d[e]&&this.clickButton(e,!1);D(a,"load",function(){D(a.xAxis[0],"setExtremes",function(c){this.max-this.min!==a.fixedRange&&c.trigger!=="rangeSelectorButton"&&c.trigger!=="updatedData"&&b.forcedDataGrouping&&this.setDataGrouping(!1,!1)});D(a.xAxis[0],"afterSetExtremes",function(){b.updateButtonStates(!0)})})},updateButtonStates:function(a){var b=this,c=this.chart,d=c.xAxis[0],e=c.scroller&&c.scroller.getUnionExtremes()||d,f=e.dataMin,g=e.dataMax,h=b.selected,i=b.options.allButtonsEnabled,
j=b.buttons;a&&c.fixedRange!==y(d.max-d.min)&&(j[h]&&j[h].setState(0),b.setSelected(null));n(b.buttonOptions,function(a,e){var m=y(d.max-d.min),o=a._range,n=a.type,q=a.count||1,s=o>g-f,t=o<d.minRange,u=a.type==="all"&&d.max-d.min>=g-f&&j[e].state!==2,w=a.type==="ytd"&&ma("%Y",f)===ma("%Y",g),v=c.renderer.forExport&&e===h,o=o===m,x=!d.hasVisibleSeries;if((n==="month"||n==="year")&&m>={month:28,year:365}[n]*864E5*q&&m<={month:31,year:366}[n]*864E5*q)o=!0;v||o&&e!==h&&e===b.lastSelected?(b.setSelected(e),
j[e].setState(2)):!i&&(s||t||u||w||x)?j[e].setState(3):j[e].state===3&&j[e].setState(0)})},computeButtonRange:function(a){var b=a.type,c=a.count||1,d={millisecond:1,second:1E3,minute:6E4,hour:36E5,day:864E5,week:6048E5};if(d[b])a._range=d[b]*c;else if(b==="month"||b==="year")a._range={month:30,year:365}[b]*864E5*c},setInputValue:function(a,b){var c=this.chart.options.rangeSelector;if(s(b))this[a+"Input"].HCTime=b;this[a+"Input"].value=ma(c.inputEditDateFormat||"%Y-%m-%d",this[a+"Input"].HCTime);this[a+
"DateBox"].attr({text:ma(c.inputDateFormat||"%b %e, %Y",this[a+"Input"].HCTime)})},showInput:function(a){var b=this.inputGroup,c=this[a+"DateBox"];F(this[a+"Input"],{left:b.translateX+c.x+"px",top:b.translateY+"px",width:c.width-2+"px",height:c.height-2+"px",border:"2px solid silver"})},hideInput:function(a){F(this[a+"Input"],{border:0,width:"1px",height:"1px"});this.setInputValue(a)},drawInput:function(a){function b(){var a=j.value,b=(g.inputDateParser||fa.parse)(a),e=d.xAxis[0],f=e.dataMin,h=e.dataMax;
if(b!==j.previousValue)j.previousValue=b,isNaN(b)&&(b=a.split("-"),b=fa.UTC(G(b[0]),G(b[1])-1,G(b[2]))),isNaN(b)||(N.global.useUTC||(b+=(new fa).getTimezoneOffset()*6E4),i?b>c.maxInput.HCTime?b=t:b<f&&(b=f):b<c.minInput.HCTime?b=t:b>h&&(b=h),b!==t&&d.xAxis[0].setExtremes(i?b:e.min,i?e.max:b,t,t,{trigger:"rangeSelectorInput"}))}var c=this,d=c.chart,e=d.renderer.style,f=d.renderer,g=d.options.rangeSelector,h=c.div,i=a==="min",j,k,l=this.inputGroup;this[a+"Label"]=k=f.label(N.lang[i?"rangeSelectorFrom":
"rangeSelectorTo"],this.inputGroup.offset).attr({padding:2}).css(C(e,g.labelStyle)).add(l);l.offset+=k.width+5;this[a+"DateBox"]=f=f.label("",l.offset).attr({padding:2,width:g.inputBoxWidth||90,height:g.inputBoxHeight||17,stroke:g.inputBoxBorderColor||"silver","stroke-width":1}).css(C({textAlign:"center",color:"#444"},e,g.inputStyle)).on("click",function(){c.showInput(a);c[a+"Input"].focus()}).add(l);l.offset+=f.width+(i?10:0);this[a+"Input"]=j=ea("input",{name:a,className:"highcharts-range-selector",
type:"text"},x({position:"absolute",border:0,width:"1px",height:"1px",padding:0,textAlign:"center",fontSize:e.fontSize,fontFamily:e.fontFamily,left:"-9em",top:d.plotTop+"px"},g.inputStyle),h);j.onfocus=function(){c.showInput(a)};j.onblur=function(){c.hideInput(a)};j.onchange=b;j.onkeypress=function(a){a.keyCode===13&&b()}},getPosition:function(){var a=this.chart,b=a.options.rangeSelector,a=q((b.buttonPosition||{}).y,a.plotTop-a.axisOffset[0]-b.height);return{buttonTop:a,inputTop:a-10}},render:function(a,
b){var c=this,d=c.chart,e=d.renderer,f=d.container,g=d.options,h=g.exporting&&g.exporting.enabled!==!1&&g.navigation&&g.navigation.buttonOptions,i=g.rangeSelector,j=c.buttons,g=N.lang,k=c.div,k=c.inputGroup,l=i.buttonTheme,m=i.buttonPosition||{},o=i.inputEnabled,p=l&&l.states,r=d.plotLeft,t,v=this.getPosition(),u=c.group,w=c.rendered;if(!w&&(c.group=u=e.g("range-selector-buttons").add(),c.zoomText=e.text(g.rangeSelectorZoom,q(m.x,r),15).css(i.labelStyle).add(u),t=q(m.x,r)+c.zoomText.getBBox().width+
5,n(c.buttonOptions,function(a,b){j[b]=e.button(a.text,t,0,function(){c.clickButton(b);c.isActive=!0},l,p&&p.hover,p&&p.select,p&&p.disabled).css({textAlign:"center"}).add(u);t+=j[b].width+q(i.buttonSpacing,5);c.selected===b&&j[b].setState(2)}),c.updateButtonStates(),o!==!1))c.div=k=ea("div",null,{position:"relative",height:0,zIndex:1}),f.parentNode.insertBefore(k,f),c.inputGroup=k=e.g("input-group").add(),k.offset=0,c.drawInput("min"),c.drawInput("max");u[w?"animate":"attr"]({translateY:v.buttonTop});
o!==!1&&(k.align(x({y:v.inputTop,width:k.offset,x:h&&v.inputTop<(h.y||0)+h.height-d.spacing[0]?-40:0},i.inputPosition),!0,d.spacingBox),s(o)||(d=u.getBBox(),k[k.translateX<d.x+d.width+10?"hide":"show"]()),c.setInputValue("min",a),c.setInputValue("max",b));c.rendered=!0},destroy:function(){var a=this.minInput,b=this.maxInput,c=this.chart,d=this.blurInputs,e;T(c.container,"mousedown",d);T(c,"resize",d);Pa(this.buttons);if(a)a.onfocus=a.onblur=a.onchange=null;if(b)b.onfocus=b.onblur=b.onchange=null;
for(e in this)this[e]&&e!=="chart"&&(this[e].destroy?this[e].destroy():this[e].nodeType&&Va(this[e])),this[e]=null}};I.prototype.toFixedRange=function(a,b,c,d){var e=this.chart&&this.chart.fixedRange,a=q(c,this.translate(a,!0)),b=q(d,this.translate(b,!0)),c=e&&(b-a)/e;c>0.7&&c<1.3&&(d?a=b-e:b=a+e);isNaN(a)&&(a=b=void 0);return{min:a,max:b}};I.prototype.minFromRange=function(){var a=this.range,b={month:"Month",year:"FullYear"}[a.type],c,d=this.max,e,f,g=function(a,c){var d=new fa(a);d["set"+b](d["get"+
b]()+c);return d.getTime()-a};typeof a==="number"?(c=this.max-a,f=a):c=d+g(d,-a.count);e=q(this.dataMin,Number.MIN_VALUE);isNaN(c)&&(c=e);if(c<=e)c=e,f===void 0&&(f=g(c,a.count)),this.newMax=E(c+f,this.dataMax);isNaN(d)&&(c=void 0);return c};U(Ca.prototype,"init",function(a,b,c){D(this,"init",function(){if(this.options.rangeSelector.enabled)this.rangeSelector=new Ib(this)});a.call(this,b,c)});z.RangeSelector=Ib;Ca.prototype.callbacks.push(function(a){function b(){f=a.xAxis[0].getExtremes();g.render(f.min,
f.max)}function c(){f=a.xAxis[0].getExtremes();isNaN(f.min)||h.render(f.min,f.max)}function d(a){a.triggerOp!=="navigator-drag"&&g.render(a.min,a.max)}function e(a){h.render(a.min,a.max)}var f,g=a.scroller,h=a.rangeSelector;g&&(D(a.xAxis[0],"afterSetExtremes",d),U(a,"drawChartBox",function(a){var c=this.isDirtyBox;a.call(this);c&&b()}),b());h&&(D(a.xAxis[0],"afterSetExtremes",e),D(a,"resize",c),c());D(a,"destroy",function(){g&&T(a.xAxis[0],"afterSetExtremes",d);h&&(T(a,"resize",c),T(a.xAxis[0],"afterSetExtremes",
e))})});z.StockChart=z.stockChart=function(a,b,c){var d=Da(a)||a.nodeName,e=arguments[d?1:0],f=e.series,g,h=q(e.navigator&&e.navigator.enabled,!0)?{startOnTick:!1,endOnTick:!1}:null,i={marker:{enabled:!1,radius:2}},j={shadow:!1,borderWidth:0};e.xAxis=ta(va(e.xAxis||{}),function(a){return C({minPadding:0,maxPadding:0,ordinal:!0,title:{text:null},labels:{overflow:"justify"},showLastLabel:!0},a,{type:"datetime",categories:null},h)});e.yAxis=ta(va(e.yAxis||{}),function(a){g=q(a.opposite,!0);return C({labels:{y:-2},
opposite:g,showLastLabel:!1,title:{text:null}},a)});e.series=null;e=C({chart:{panning:!0,pinchType:"x"},navigator:{enabled:!0},scrollbar:{enabled:!0},rangeSelector:{enabled:!0},title:{text:null,style:{fontSize:"16px"}},tooltip:{shared:!0,crosshairs:!0},legend:{enabled:!1},plotOptions:{line:i,spline:i,area:i,areaspline:i,arearange:i,areasplinerange:i,column:j,columnrange:j,candlestick:j,ohlc:j}},e,{_stock:!0,chart:{inverted:!1}});e.series=f;return d?new Ca(a,e,c):new Ca(e,b)};U(Za.prototype,"init",
function(a,b,c){var d=c.chart.pinchType||"";a.call(this,b,c);this.pinchX=this.pinchHor=d.indexOf("x")!==-1;this.pinchY=this.pinchVert=d.indexOf("y")!==-1;this.hasZoom=this.hasZoom||this.pinchHor||this.pinchVert});U(I.prototype,"autoLabelAlign",function(a){var b=this.chart,c=this.options,b=b._labelPanes=b._labelPanes||{},d=this.options.labels;if(this.chart.options._stock&&this.coll==="yAxis"&&(c=c.top+","+c.height,!b[c]&&d.enabled)){if(d.x===15)d.x=0;if(d.align===void 0)d.align="right";b[c]=1;return"right"}return a.call(this,
[].slice.call(arguments,1))});U(I.prototype,"getPlotLinePath",function(a,b,c,d,e,f){var g=this,h=this.isLinked&&!this.series?this.linkedParent.series:this.series,i=g.chart,j=i.renderer,k=g.left,l=g.top,m,o,p,r,t=[],x=[],u,w;if(g.coll==="colorAxis")return a.apply(this,[].slice.call(arguments,1));x=g.isXAxis?s(g.options.yAxis)?[i.yAxis[g.options.yAxis]]:ta(h,function(a){return a.yAxis}):s(g.options.xAxis)?[i.xAxis[g.options.xAxis]]:ta(h,function(a){return a.xAxis});n(g.isXAxis?i.yAxis:i.xAxis,function(a){if(s(a.options.id)?
a.options.id.indexOf("navigator")===-1:1){var b=a.isXAxis?"yAxis":"xAxis",b=s(a.options[b])?i[b][a.options[b]]:i[b][0];g===b&&x.push(a)}});u=x.length?[]:[g.isXAxis?i.yAxis[0]:i.xAxis[0]];n(x,function(a){sa(a,u)===-1&&u.push(a)});w=q(f,g.translate(b,null,null,d));isNaN(w)||(g.horiz?n(u,function(a){var b;o=a.pos;r=o+a.len;m=p=y(w+g.transB);if(m<k||m>k+g.width)e?m=p=E(v(k,m),k+g.width):b=!0;b||t.push("M",m,o,"L",p,r)}):n(u,function(a){var b;m=a.pos;p=m+a.len;o=r=y(l+g.height-w);if(o<l||o>l+g.height)e?
o=r=E(v(l,o),g.top+g.height):b=!0;b||t.push("M",m,o,"L",p,r)}));return t.length>0?j.crispPolyLine(t,c||1):null});I.prototype.getPlotBandPath=function(a,b){var c=this.getPlotLinePath(b,null,null,!0),d=this.getPlotLinePath(a,null,null,!0),e=[],f;if(d&&c&&d.toString()!==c.toString())for(f=0;f<d.length;f+=6)e.push("M",d[f+1],d[f+2],"L",d[f+4],d[f+5],c[f+4],c[f+5],c[f+1],c[f+2]);else e=null;return e};ya.prototype.crispPolyLine=function(a,b){var c;for(c=0;c<a.length;c+=6)a[c+1]===a[c+4]&&(a[c+1]=a[c+4]=
y(a[c+1])-b%2/2),a[c+2]===a[c+5]&&(a[c+2]=a[c+5]=y(a[c+2])+b%2/2);return a};if(Ya===z.VMLRenderer)mb.prototype.crispPolyLine=ya.prototype.crispPolyLine;U(I.prototype,"hideCrosshair",function(a,b){a.call(this,b);if(this.crossLabel)this.crossLabel=this.crossLabel.hide()});U(I.prototype,"drawCrosshair",function(a,b,c){var d,e;a.call(this,b,c);if(s(this.crosshair.label)&&this.crosshair.label.enabled){var a=this.chart,f=this.options.crosshair.label,g=this.horiz,h=this.opposite,i=this.left,j=this.top,k=
this.crossLabel,l,m=f.format,n="",p=this.options.tickPosition==="inside",r=this.crosshair.snap!==!1;l=g?"center":h?this.labelAlign==="right"?"right":"left":this.labelAlign==="left"?"left":"center";if(!k)k=this.crossLabel=a.renderer.label(null,null,null,f.shape||"callout").attr({align:f.align||l,zIndex:12,fill:f.backgroundColor||this.series[0]&&this.series[0].color||"gray",padding:q(f.padding,8),stroke:f.borderColor||"","stroke-width":f.borderWidth||0,r:q(f.borderRadius,3)}).css(x({color:"white",fontWeight:"normal",
fontSize:"11px",textAlign:"center"},f.style)).add();g?(l=r?c.plotX+i:b.chartX,j+=h?0:this.height):(l=h?this.width+i:0,j=r?c.plotY+j:b.chartY);!m&&!f.formatter&&(this.isDatetimeAxis&&(n="%b %d, %Y"),m="{value"+(n?":"+n:"")+"}");b=r?c[this.isXAxis?"x":"y"]:this.toValue(g?b.chartX:b.chartY);k.attr({text:m?La(m,{value:b}):f.formatter.call(this,b),anchorX:g?l:this.opposite?0:a.chartWidth,anchorY:g?this.opposite?a.chartHeight:0:j,x:l,y:j,visibility:"visible"});b=k.getBBox();if(g){if(p&&!h||!p&&h)j=k.y-
b.height}else j=k.y-b.height/2;g?(d=i-b.x,e=i+this.width-b.x):(d=this.labelAlign==="left"?i:0,e=this.labelAlign==="right"?i+this.width:a.chartWidth);k.translateX<d&&(l+=d-k.translateX);k.translateX+b.width>=e&&(l-=k.translateX+b.width-e);k.attr({x:l,y:j,visibility:"visible"})}});var gc=ia.init,hc=ia.processData,ic=Ha.prototype.tooltipFormatter;ia.init=function(){gc.apply(this,arguments);this.setCompare(this.options.compare)};ia.setCompare=function(a){this.modifyValue=a==="value"||a==="percent"?function(b,
c){var d=this.compareValue;if(b!==t&&(b=a==="value"?b-d:b=100*(b/d)-100,c))c.change=b;return b}:null;if(this.chart.hasRendered)this.isDirty=!0};ia.processData=function(){var a,b=-1,c,d,e,f;hc.apply(this,arguments);if(this.xAxis&&this.processedYData){c=this.processedXData;d=this.processedYData;e=d.length;this.pointArrayMap&&(b=sa(this.pointValKey||"y",this.pointArrayMap));for(a=0;a<e;a++)if(f=b>-1?d[a][b]:d[a],typeof f==="number"&&c[a]>=this.xAxis.min&&f!==0){this.compareValue=f;break}}};U(ia,"getExtremes",
function(a){var b;a.apply(this,[].slice.call(arguments,1));if(this.modifyValue)b=[this.modifyValue(this.dataMin),this.modifyValue(this.dataMax)],this.dataMin=Oa(b),this.dataMax=Ea(b)});I.prototype.setCompare=function(a,b){this.isXAxis||(n(this.series,function(b){b.setCompare(a)}),q(b,!0)&&this.chart.redraw())};Ha.prototype.tooltipFormatter=function(a){a=a.replace("{point.change}",(this.change>0?"+":"")+z.numberFormat(this.change,q(this.series.tooltipOptions.changeDecimals,2)));return ic.apply(this,
[a])};U(Q.prototype,"render",function(a){if(this.chart.options._stock&&this.xAxis)!this.clipBox&&this.animate?(this.clipBox=C(this.chart.clipBox),this.clipBox.width=this.xAxis.len,this.clipBox.height=this.yAxis.len):this.chart[this.sharedClipKey]&&(Ta(this.chart[this.sharedClipKey]),this.chart[this.sharedClipKey].attr({width:this.xAxis.len,height:this.yAxis.len}));a.call(this)});x(z,{Color:wa,Point:Ha,Tick:cb,Renderer:Ya,SVGElement:Z,SVGRenderer:ya,arrayMin:Oa,arrayMax:Ea,charts:$,correctFloat:na,
dateFormat:ma,error:ga,format:La,pathAnim:void 0,getOptions:function(){return N},hasBidiBug:Zb,isTouchDevice:kb,setOptions:function(a){N=C(!0,N,a);Ob();return N},addEvent:D,removeEvent:T,createElement:ea,discardElement:Va,css:F,each:n,map:ta,merge:C,splat:va,stableSort:ob,extendClass:la,pInt:G,svg:ja,canvas:qa,vml:!ja&&!qa,product:"Highstock",version:"4.2.4"});return z});

},{}],3:[function(require,module,exports){
/**
*
* jquery.sparkline.js
*
* v2.3.2
* (c) Splunk, Inc
* Contact: Gareth Watts (gareth@splunk.com)
* http://omnipotent.net/jquery.sparkline/
*
* Generates inline sparkline charts from data supplied either to the method
* or inline in HTML
*
* Compatible with Internet Explorer 6.0+ and modern browsers equipped with the canvas tag
* (Firefox 2.0+, Safari, Opera, etc)
*
* License: New BSD License
*
* Copyright (c) 2012, Splunk Inc.
* All rights reserved.
*
* Redistribution and use in source and binary forms, with or without modification,
* are permitted provided that the following conditions are met:
*
*     * Redistributions of source code must retain the above copyright notice,
*       this list of conditions and the following disclaimer.
*     * Redistributions in binary form must reproduce the above copyright notice,
*       this list of conditions and the following disclaimer in the documentation
*       and/or other materials provided with the distribution.
*     * Neither the name of Splunk Inc nor the names of its contributors may
*       be used to endorse or promote products derived from this software without
*       specific prior written permission.
*
* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY
* EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
* OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT
* SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
* SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT
* OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
* HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
* OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
* SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*
*
* Usage:
*  $(selector).sparkline(values, options)
*
* If values is undefined or set to 'html' then the data values are read from the specified tag:
*   <p>Sparkline: <span class="sparkline">1,4,6,6,8,5,3,5</span></p>
*   $('.sparkline').sparkline();
* There must be no spaces in the enclosed data set
*
* Otherwise values must be an array of numbers or null values
*    <p>Sparkline: <span id="sparkline1">This text replaced if the browser is compatible</span></p>
*    $('#sparkline1').sparkline([1,4,6,6,8,5,3,5])
*    $('#sparkline2').sparkline([1,4,6,null,null,5,3,5])
*
* Values can also be specified in an HTML comment, or as a values attribute:
*    <p>Sparkline: <span class="sparkline"><!--1,4,6,6,8,5,3,5 --></span></p>
*    <p>Sparkline: <span class="sparkline" values="1,4,6,6,8,5,3,5"></span></p>
*    $('.sparkline').sparkline();
*
* For line charts, x values can also be specified:
*   <p>Sparkline: <span class="sparkline">1:1,2.7:4,3.4:6,5:6,6:8,8.7:5,9:3,10:5</span></p>
*    $('#sparkline1').sparkline([ [1,1], [2.7,4], [3.4,6], [5,6], [6,8], [8.7,5], [9,3], [10,5] ])
*
* By default, options should be passed in as the second argument to the sparkline function:
*   $('.sparkline').sparkline([1,2,3,4], {type: 'bar'})
*
* Options can also be set by passing them on the tag itself.  This feature is disabled by default though
* as there's a slight performance overhead:
*   $('.sparkline').sparkline([1,2,3,4], {enableTagOptions: true})
*   <p>Sparkline: <span class="sparkline" sparkType="bar" sparkBarColor="red">loading</span></p>
* Prefix all options supplied as tag attribute with "spark" (configurable by setting tagOptionsPrefix)
*
* Supported options:
*   lineColor - Color of the line used for the chart
*   fillColor - Color used to fill in the chart - Set to '' or false for a transparent chart
*   width - Width of the chart - Defaults to 3 times the number of values in pixels
*   height - Height of the chart - Defaults to the height of the containing element
*   chartRangeMin - Specify the minimum value to use for the Y range of the chart - Defaults to the minimum value supplied
*   chartRangeMax - Specify the maximum value to use for the Y range of the chart - Defaults to the maximum value supplied
*   chartRangeClip - Clip out of range values to the max/min specified by chartRangeMin and chartRangeMax
*   chartRangeMinX - Specify the minimum value to use for the X range of the chart - Defaults to the minimum value supplied
*   chartRangeMaxX - Specify the maximum value to use for the X range of the chart - Defaults to the maximum value supplied
*   composite - If true then don't erase any existing chart attached to the tag, but draw
*           another chart over the top - Note that width and height are ignored if an
*           existing chart is detected.
*   tagValuesAttribute - Name of tag attribute to check for data values - Defaults to 'values'
*   enableTagOptions - Whether to check tags for sparkline options
*   tagOptionsPrefix - Prefix used for options supplied as tag attributes - Defaults to 'spark'
*   disableHiddenCheck - If set to true, then the plugin will assume that charts will never be drawn into a
*           hidden dom element, avoding a browser reflow
*   disableInteraction - If set to true then all mouseover/click interaction behaviour will be disabled,
*       making the plugin perform much like it did in 1.x
*   disableTooltips - If set to true then tooltips will be disabled - Defaults to false (tooltips enabled)
*   disableHighlight - If set to true then highlighting of selected chart elements on mouseover will be disabled
*       defaults to false (highlights enabled)
*   highlightLighten - Factor to lighten/darken highlighted chart values by - Defaults to 1.4 for a 40% increase
*   tooltipContainer - Specify which DOM element the tooltip should be rendered into - defaults to document.body
*   tooltipClassname - Optional CSS classname to apply to tooltips - If not specified then a default style will be applied
*   tooltipOffsetX - How many pixels away from the mouse pointer to render the tooltip on the X axis
*   tooltipOffsetY - How many pixels away from the mouse pointer to render the tooltip on the r axis
*   tooltipFormatter  - Optional callback that allows you to override the HTML displayed in the tooltip
*       callback is given arguments of (sparkline, options, fields)
*   tooltipChartTitle - If specified then the tooltip uses the string specified by this setting as a title
*   tooltipFormat - A format string or SPFormat object  (or an array thereof for multiple entries)
*       to control the format of the tooltip
*   tooltipPrefix - A string to prepend to each field displayed in a tooltip
*   tooltipSuffix - A string to append to each field displayed in a tooltip
*   tooltipSkipNull - If true then null values will not have a tooltip displayed (defaults to true)
*   tooltipValueLookups - An object or range map to map field values to tooltip strings
*       (eg. to map -1 to "Lost", 0 to "Draw", and 1 to "Win")
*   numberFormatter - Optional callback for formatting numbers in tooltips
*   numberDigitGroupSep - Character to use for group separator in numbers "1,234" - Defaults to ","
*   numberDecimalMark - Character to use for the decimal point when formatting numbers - Defaults to "."
*   numberDigitGroupCount - Number of digits between group separator - Defaults to 3
*
* There are 7 types of sparkline, selected by supplying a "type" option of 'line' (default),
* 'bar', 'tristate', 'bullet', 'discrete', 'pie' or 'box'
*    line - Line chart.  Options:
*       spotColor - Set to '' to not end each line in a circular spot
*       minSpotColor - If set, color of spot at minimum value
*       maxSpotColor - If set, color of spot at maximum value
*       spotRadius - Radius in pixels
*       lineWidth - Width of line in pixels
*       normalRangeMin
*       normalRangeMax - If set draws a filled horizontal bar between these two values marking the "normal"
*                      or expected range of values
*       normalRangeColor - Color to use for the above bar
*       drawNormalOnTop - Draw the normal range above the chart fill color if true
*       defaultPixelsPerValue - Defaults to 3 pixels of width for each value in the chart
*       highlightSpotColor - The color to use for drawing a highlight spot on mouseover - Set to null to disable
*       highlightLineColor - The color to use for drawing a highlight line on mouseover - Set to null to disable
*       valueSpots - Specify which points to draw spots on, and in which color.  Accepts a range map
*
*   bar - Bar chart.  Options:
*       barColor - Color of bars for postive values
*       negBarColor - Color of bars for negative values
*       zeroColor - Color of bars with zero values
*       nullColor - Color of bars with null values - Defaults to omitting the bar entirely
*       barWidth - Width of bars in pixels
*       colorMap - Optional mappnig of values to colors to override the *BarColor values above
*                  can be an Array of values to control the color of individual bars or a range map
*                  to specify colors for individual ranges of values
*       barSpacing - Gap between bars in pixels
*       zeroAxis - Centers the y-axis around zero if true
*
*   tristate - Charts values of win (>0), lose (<0) or draw (=0)
*       posBarColor - Color of win values
*       negBarColor - Color of lose values
*       zeroBarColor - Color of draw values
*       barWidth - Width of bars in pixels
*       barSpacing - Gap between bars in pixels
*       colorMap - Optional mappnig of values to colors to override the *BarColor values above
*                  can be an Array of values to control the color of individual bars or a range map
*                  to specify colors for individual ranges of values
*
*   discrete - Options:
*       lineHeight - Height of each line in pixels - Defaults to 30% of the graph height
*       thesholdValue - Values less than this value will be drawn using thresholdColor instead of lineColor
*       thresholdColor
*
*   bullet - Values for bullet graphs msut be in the order: target, performance, range1, range2, range3, ...
*       options:
*       targetColor - The color of the vertical target marker
*       targetWidth - The width of the target marker in pixels
*       performanceColor - The color of the performance measure horizontal bar
*       rangeColors - Colors to use for each qualitative range background color
*
*   pie - Pie chart. Options:
*       sliceColors - An array of colors to use for pie slices
*       offset - Angle in degrees to offset the first slice - Try -90 or +90
*       borderWidth - Width of border to draw around the pie chart, in pixels - Defaults to 0 (no border)
*       borderColor - Color to use for the pie chart border - Defaults to #000
*
*   box - Box plot. Options:
*       raw - Set to true to supply pre-computed plot points as values
*             values should be: low_outlier, low_whisker, q1, median, q3, high_whisker, high_outlier
*             When set to false you can supply any number of values and the box plot will
*             be computed for you.  Default is false.
*       showOutliers - Set to true (default) to display outliers as circles
*       outlierIQR - Interquartile range used to determine outliers.  Default 1.5
*       boxLineColor - Outline color of the box
*       boxFillColor - Fill color for the box
*       whiskerColor - Line color used for whiskers
*       outlierLineColor - Outline color of outlier circles
*       outlierFillColor - Fill color of the outlier circles
*       spotRadius - Radius of outlier circles
*       medianColor - Line color of the median line
*       target - Draw a target cross hair at the supplied value (default undefined)
*
*
*
*   Examples:
*   $('#sparkline1').sparkline(myvalues, { lineColor: '#f00', fillColor: false });
*   $('.barsparks').sparkline('html', { type:'bar', height:'40px', barWidth:5 });
*   $('#tristate').sparkline([1,1,-1,1,0,0,-1], { type:'tristate' }):
*   $('#discrete').sparkline([1,3,4,5,5,3,4,5], { type:'discrete' });
*   $('#bullet').sparkline([10,12,12,9,7], { type:'bullet' });
*   $('#pie').sparkline([1,1,2], { type:'pie' });
*/

/*jslint regexp: true, browser: true, jquery: true, white: true, nomen: false, plusplus: false, maxerr: 500, indent: 4 */

(function(document, Math, undefined) { // performance/minified-size optimization
(function(factory) {
    if(typeof define === 'function' && define.amd) {
        define(['jquery'], factory);
    } else if (jQuery && !jQuery.fn.sparkline) {
        factory(jQuery);
    }
}
(function($) {
    'use strict';

    var UNSET_OPTION = {},
        getDefaults, createClass, SPFormat, clipval, quartile, normalizeValue, normalizeValues,
        remove, isNumber, all, sum, addCSS, ensureArray, formatNumber, RangeMap,
        MouseHandler, Tooltip, barHighlightMixin,
        line, bar, tristate, discrete, bullet, pie, box, defaultStyles, initStyles,
        VShape, VCanvas_base, VCanvas_canvas, VCanvas_vml, pending, shapeCount = 0;

    /**
     * Default configuration settings
     */
    getDefaults = function () {
        return {
            // Settings common to most/all chart types
            common: {
                type: 'line',
                lineColor: '#00f',
                fillColor: '#cdf',
                defaultPixelsPerValue: 3,
                width: 'auto',
                height: 'auto',
                composite: false,
                tagValuesAttribute: 'values',
                tagOptionsPrefix: 'spark',
                enableTagOptions: false,
                enableHighlight: true,
                highlightLighten: 1.4,
                tooltipSkipNull: true,
                tooltipPrefix: '',
                tooltipSuffix: '',
                disableHiddenCheck: false,
                numberFormatter: false,
                numberDigitGroupCount: 3,
                numberDigitGroupSep: ',',
                numberDecimalMark: '.',
                disableTooltips: false,
                disableInteraction: false
            },
            // Defaults for line charts
            line: {
                spotColor: '#f80',
                highlightSpotColor: '#5f5',
                highlightLineColor: '#f22',
                spotRadius: 1.5,
                minSpotColor: '#f80',
                maxSpotColor: '#f80',
                lineWidth: 1,
                normalRangeMin: undefined,
                normalRangeMax: undefined,
                normalRangeColor: '#ccc',
                drawNormalOnTop: false,
                chartRangeMin: undefined,
                chartRangeMax: undefined,
                chartRangeMinX: undefined,
                chartRangeMaxX: undefined,
                tooltipFormat: new SPFormat('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{y}}{{suffix}}')
            },
            // Defaults for bar charts
            bar: {
                barColor: '#3366cc',
                negBarColor: '#f44',
                stackedBarColor: ['#3366cc', '#dc3912', '#ff9900', '#109618', '#66aa00',
                    '#dd4477', '#0099c6', '#990099'],
                zeroColor: undefined,
                nullColor: undefined,
                zeroAxis: true,
                barWidth: 4,
                barSpacing: 1,
                chartRangeMax: undefined,
                chartRangeMin: undefined,
                chartRangeClip: false,
                colorMap: undefined,
                tooltipFormat: new SPFormat('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{value}}{{suffix}}')
            },
            // Defaults for tristate charts
            tristate: {
                barWidth: 4,
                barSpacing: 1,
                posBarColor: '#6f6',
                negBarColor: '#f44',
                zeroBarColor: '#999',
                colorMap: {},
                tooltipFormat: new SPFormat('<span style="color: {{color}}">&#9679;</span> {{value:map}}'),
                tooltipValueLookups: { map: { '-1': 'Loss', '0': 'Draw', '1': 'Win' } }
            },
            // Defaults for discrete charts
            discrete: {
                lineHeight: 'auto',
                thresholdColor: undefined,
                thresholdValue: 0,
                chartRangeMax: undefined,
                chartRangeMin: undefined,
                chartRangeClip: false,
                tooltipFormat: new SPFormat('{{prefix}}{{value}}{{suffix}}')
            },
            // Defaults for bullet charts
            bullet: {
                targetColor: '#f33',
                targetWidth: 3, // width of the target bar in pixels
                performanceColor: '#33f',
                rangeColors: ['#d3dafe', '#a8b6ff', '#7f94ff'],
                base: undefined, // set this to a number to change the base start number
                tooltipFormat: new SPFormat('{{fieldkey:fields}} - {{value}}'),
                tooltipValueLookups: { fields: {r: 'Range', p: 'Performance', t: 'Target'} }
            },
            // Defaults for pie charts
            pie: {
                offset: 0,
                sliceColors: ['#3366cc', '#dc3912', '#ff9900', '#109618', '#66aa00',
                    '#dd4477', '#0099c6', '#990099'],
                borderWidth: 0,
                borderColor: '#000',
                tooltipFormat: new SPFormat('<span style="color: {{color}}">&#9679;</span> {{value}} ({{percent.1}}%)')
            },
            // Defaults for box plots
            box: {
                raw: false,
                boxLineColor: '#000',
                boxFillColor: '#cdf',
                whiskerColor: '#000',
                outlierLineColor: '#333',
                outlierFillColor: '#fff',
                medianColor: '#f00',
                showOutliers: true,
                outlierIQR: 1.5,
                spotRadius: 1.5,
                target: undefined,
                targetColor: '#4a2',
                chartRangeMax: undefined,
                chartRangeMin: undefined,
                tooltipFormat: new SPFormat('{{field:fields}}: {{value}}'),
                tooltipFormatFieldlistKey: 'field',
                tooltipValueLookups: { fields: { lq: 'Lower Quartile', med: 'Median',
                    uq: 'Upper Quartile', lo: 'Left Outlier', ro: 'Right Outlier',
                    lw: 'Left Whisker', rw: 'Right Whisker'} }
            }
        };
    };

    // You can have tooltips use a css class other than jqstooltip by specifying tooltipClassname
    defaultStyles = '.jqstooltip { ' +
            'position: absolute;' +
            'left: 0px;' +
            'top: 0px;' +
            'visibility: hidden;' +
            'background: rgb(0, 0, 0) transparent;' +
            'background-color: rgba(0,0,0,0.6);' +
            'filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000);' +
            '-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000)";' +
            'color: white;' +
            'font: 10px arial, san serif;' +
            'text-align: left;' +
            'white-space: nowrap;' +
            'padding: 5px;' +
            'border: 1px solid white;' +
            'box-sizing: content-box;' +
            'z-index: 10000;' +
            '}' +
            '.jqsfield { ' +
            'color: white;' +
            'font: 10px arial, san serif;' +
            'text-align: left;' +
            '}';

    /**
     * Utilities
     */

    createClass = function (/* [baseclass, [mixin, ...]], definition */) {
        var Class, args;
        Class = function () {
            this.init.apply(this, arguments);
        };
        if (arguments.length > 1) {
            if (arguments[0]) {
                Class.prototype = $.extend(new arguments[0](), arguments[arguments.length - 1]);
                Class._super = arguments[0].prototype;
            } else {
                Class.prototype = arguments[arguments.length - 1];
            }
            if (arguments.length > 2) {
                args = Array.prototype.slice.call(arguments, 1, -1);
                args.unshift(Class.prototype);
                $.extend.apply($, args);
            }
        } else {
            Class.prototype = arguments[0];
        }
        Class.prototype.cls = Class;
        return Class;
    };

    /**
     * Wraps a format string for tooltips
     * {{x}}
     * {{x.2}
     * {{x:months}}
     */
    $.SPFormatClass = SPFormat = createClass({
        fre: /\{\{([\w.]+?)(:(.+?))?\}\}/g,
        precre: /(\w+)\.(\d+)/,

        init: function (format, fclass) {
            this.format = format;
            this.fclass = fclass;
        },

        render: function (fieldset, lookups, options) {
            var self = this,
                fields = fieldset,
                match, token, lookupkey, fieldvalue, prec;
            return this.format.replace(this.fre, function () {
                var lookup;
                token = arguments[1];
                lookupkey = arguments[3];
                match = self.precre.exec(token);
                if (match) {
                    prec = match[2];
                    token = match[1];
                } else {
                    prec = false;
                }
                fieldvalue = fields[token];
                if (fieldvalue === undefined) {
                    return '';
                }
                if (lookupkey && lookups && lookups[lookupkey]) {
                    lookup = lookups[lookupkey];
                    if (lookup.get) { // RangeMap
                        return lookups[lookupkey].get(fieldvalue) || fieldvalue;
                    } else {
                        return lookups[lookupkey][fieldvalue] || fieldvalue;
                    }
                }
                if (isNumber(fieldvalue)) {
                    if (options.get('numberFormatter')) {
                        fieldvalue = options.get('numberFormatter')(fieldvalue);
                    } else {
                        fieldvalue = formatNumber(fieldvalue, prec,
                            options.get('numberDigitGroupCount'),
                            options.get('numberDigitGroupSep'),
                            options.get('numberDecimalMark'));
                    }
                }
                return fieldvalue;
            });
        }
    });

    // convience method to avoid needing the new operator
    $.spformat = function(format, fclass) {
        return new SPFormat(format, fclass);
    };

    clipval = function (val, min, max) {
        if (val < min) {
            return min;
        }
        if (val > max) {
            return max;
        }
        return val;
    };

    quartile = function (values, q) {
        var vl;
        if (q === 2) {
            vl = Math.floor(values.length / 2);
            return values.length % 2 ? values[vl] : (values[vl-1] + values[vl]) / 2;
        } else {
            if (values.length % 2 ) { // odd
                vl = (values.length * q + q) / 4;
                return vl % 1 ? (values[Math.floor(vl)] + values[Math.floor(vl) - 1]) / 2 : values[vl-1];
            } else { //even
                vl = (values.length * q + 2) / 4;
                return vl % 1 ? (values[Math.floor(vl)] + values[Math.floor(vl) - 1]) / 2 :  values[vl-1];

            }
        }
    };

    normalizeValue = function (val) {
        var nf;
        switch (val) {
            case 'undefined':
                val = undefined;
                break;
            case 'null':
                val = null;
                break;
            case 'true':
                val = true;
                break;
            case 'false':
                val = false;
                break;
            default:
                nf = parseFloat(val);
                if (val == nf) {
                    val = nf;
                }
        }
        return val;
    };

    normalizeValues = function (vals) {
        var i, result = [];
        for (i = vals.length; i--;) {
            result[i] = normalizeValue(vals[i]);
        }
        return result;
    };

    remove = function (vals, filter) {
        var i, vl, result = [];
        for (i = 0, vl = vals.length; i < vl; i++) {
            if (vals[i] !== filter) {
                result.push(vals[i]);
            }
        }
        return result;
    };

    isNumber = function (num) {
        return !isNaN(parseFloat(num)) && isFinite(num);
    };

    formatNumber = function (num, prec, groupsize, groupsep, decsep) {
        var p, i;
        num = (prec === false ? parseFloat(num).toString() : num.toFixed(prec)).split('');
        p = (p = $.inArray('.', num)) < 0 ? num.length : p;
        if (p < num.length) {
            num[p] = decsep;
        }
        for (i = p - groupsize; i > 0; i -= groupsize) {
            num.splice(i, 0, groupsep);
        }
        return num.join('');
    };

    // determine if all values of an array match a value
    // returns true if the array is empty
    all = function (val, arr, ignoreNull) {
        var i;
        for (i = arr.length; i--; ) {
            if (ignoreNull && arr[i] === null) continue;
            if (arr[i] !== val) {
                return false;
            }
        }
        return true;
    };

    // sums the numeric values in an array, ignoring other values
    sum = function (vals) {
        var total = 0, i;
        for (i = vals.length; i--;) {
            total += typeof vals[i] === 'number' ? vals[i] : 0;
        }
        return total;
    };

    ensureArray = function (val) {
        return $.isArray(val) ? val : [val];
    };

    // http://paulirish.com/2008/bookmarklet-inject-new-css-rules/
    addCSS = function(css) {
        var tag, iefail;
        if (document.createStyleSheet) {
            try {
                document.createStyleSheet().cssText = css;
                return;
            } catch (e) {
                // IE <= 9 maxes out at 31 stylesheets; inject into page instead.
                iefail = true;
            }
        }
        tag = document.createElement('style');
        tag.type = 'text/css';
        document.getElementsByTagName('head')[0].appendChild(tag);
        if (iefail) {
            document.styleSheets[document.styleSheets.length - 1].cssText = css;
        } else {
            tag[(typeof document.body.style.WebkitAppearance == 'string') /* webkit only */ ? 'innerText' : 'innerHTML'] = css;
        }
    };

    // Provide a cross-browser interface to a few simple drawing primitives
    $.fn.simpledraw = function (width, height, useExisting, interact) {
        var target, mhandler;
        if (useExisting && (target = this.data('_jqs_vcanvas'))) {
            return target;
        }

        if ($.fn.sparkline.canvas === false) {
            // We've already determined that neither Canvas nor VML are available
            return false;

        } else if ($.fn.sparkline.canvas === undefined) {
            // No function defined yet -- need to see if we support Canvas or VML
            var el = document.createElement('canvas');
            if (!!(el.getContext && el.getContext('2d'))) {
                // Canvas is available
                $.fn.sparkline.canvas = function(width, height, target, interact) {
                    return new VCanvas_canvas(width, height, target, interact);
                };
            } else if (document.namespaces && !document.namespaces.v) {
                // VML is available
                document.namespaces.add('v', 'urn:schemas-microsoft-com:vml', '#default#VML');
                $.fn.sparkline.canvas = function(width, height, target, interact) {
                    return new VCanvas_vml(width, height, target);
                };
            } else {
                // Neither Canvas nor VML are available
                $.fn.sparkline.canvas = false;
                return false;
            }
        }

        if (width === undefined) {
            width = $(this).innerWidth();
        }
        if (height === undefined) {
            height = $(this).innerHeight();
        }

        target = $.fn.sparkline.canvas(width, height, this, interact);

        mhandler = $(this).data('_jqs_mhandler');
        if (mhandler) {
            mhandler.registerCanvas(target);
        }
        return target;
    };

    $.fn.cleardraw = function () {
        var target = this.data('_jqs_vcanvas');
        if (target) {
            target.reset();
        }
    };

    $.RangeMapClass = RangeMap = createClass({
        init: function (map) {
            var key, range, rangelist = [];
            for (key in map) {
                if (map.hasOwnProperty(key) && typeof key === 'string' && key.indexOf(':') > -1) {
                    range = key.split(':');
                    range[0] = range[0].length === 0 ? -Infinity : parseFloat(range[0]);
                    range[1] = range[1].length === 0 ? Infinity : parseFloat(range[1]);
                    range[2] = map[key];
                    rangelist.push(range);
                }
            }
            this.map = map;
            this.rangelist = rangelist || false;
        },

        get: function (value) {
            var rangelist = this.rangelist,
                i, range, result;
            if ((result = this.map[value]) !== undefined) {
                return result;
            }
            if (rangelist) {
                for (i = rangelist.length; i--;) {
                    range = rangelist[i];
                    if (range[0] <= value && range[1] >= value) {
                        return range[2];
                    }
                }
            }
            return undefined;
        }
    });

    // Convenience function
    $.range_map = function(map) {
        return new RangeMap(map);
    };

    MouseHandler = createClass({
        init: function (el, options) {
            var $el = $(el);
            this.$el = $el;
            this.options = options;
            this.currentPageX = 0;
            this.currentPageY = 0;
            this.el = el;
            this.splist = [];
            this.tooltip = null;
            this.over = false;
            this.displayTooltips = !options.get('disableTooltips');
            this.highlightEnabled = !options.get('disableHighlight');
        },

        registerSparkline: function (sp) {
            this.splist.push(sp);
            if (this.over) {
                this.updateDisplay();
            }
        },

        registerCanvas: function (canvas) {
            var $canvas = $(canvas.canvas);
            this.canvas = canvas;
            this.$canvas = $canvas;
            $canvas.mouseenter($.proxy(this.mouseenter, this));
            $canvas.mouseleave($.proxy(this.mouseleave, this));
            $canvas.click($.proxy(this.mouseclick, this));
        },

        reset: function (removeTooltip) {
            this.splist = [];
            if (this.tooltip && removeTooltip) {
                this.tooltip.remove();
                this.tooltip = undefined;
            }
        },

        mouseclick: function (e) {
            var clickEvent = $.Event('sparklineClick');
            clickEvent.originalEvent = e;
            clickEvent.sparklines = this.splist;
            this.$el.trigger(clickEvent);
        },

        mouseenter: function (e) {
            $(document.body).unbind('mousemove.jqs');
            $(document.body).bind('mousemove.jqs', $.proxy(this.mousemove, this));
            this.over = true;
            this.currentPageX = e.pageX;
            this.currentPageY = e.pageY;
            this.currentEl = e.target;
            if (!this.tooltip && this.displayTooltips) {
                this.tooltip = new Tooltip(this.options);
                this.tooltip.updatePosition(e.pageX, e.pageY);
            }
            this.updateDisplay();
        },

        mouseleave: function () {
            $(document.body).unbind('mousemove.jqs');
            var splist = this.splist,
                 spcount = splist.length,
                 needsRefresh = false,
                 sp, i;
            this.over = false;
            this.currentEl = null;

            if (this.tooltip) {
                this.tooltip.remove();
                this.tooltip = null;
            }

            for (i = 0; i < spcount; i++) {
                sp = splist[i];
                if (sp.clearRegionHighlight()) {
                    needsRefresh = true;
                }
            }

            if (needsRefresh) {
                this.canvas.render();
            }
        },

        mousemove: function (e) {
            this.currentPageX = e.pageX;
            this.currentPageY = e.pageY;
            this.currentEl = e.target;
            if (this.tooltip) {
                this.tooltip.updatePosition(e.pageX, e.pageY);
            }
            this.updateDisplay();
        },

        updateDisplay: function () {
            var splist = this.splist,
                 spcount = splist.length,
                 needsRefresh = false,
                 offset = this.$canvas.offset(),
                 localX = this.currentPageX - offset.left,
                 localY = this.currentPageY - offset.top,
                 tooltiphtml, sp, i, result, changeEvent;
            if (!this.over) {
                return;
            }
            for (i = 0; i < spcount; i++) {
                sp = splist[i];
                result = sp.setRegionHighlight(this.currentEl, localX, localY);
                if (result) {
                    needsRefresh = true;
                }
            }
            if (needsRefresh) {
                changeEvent = $.Event('sparklineRegionChange');
                changeEvent.sparklines = this.splist;
                this.$el.trigger(changeEvent);
                if (this.tooltip) {
                    tooltiphtml = '';
                    for (i = 0; i < spcount; i++) {
                        sp = splist[i];
                        tooltiphtml += sp.getCurrentRegionTooltip();
                    }
                    this.tooltip.setContent(tooltiphtml);
                }
                if (!this.disableHighlight) {
                    this.canvas.render();
                }
            }
            if (result === null) {
                this.mouseleave();
            }
        }
    });


    Tooltip = createClass({
        sizeStyle: 'position: static !important;' +
            'display: block !important;' +
            'visibility: hidden !important;' +
            'float: left !important;',

        init: function (options) {
            var tooltipClassname = options.get('tooltipClassname', 'jqstooltip'),
                sizetipStyle = this.sizeStyle,
                offset;
            this.container = options.get('tooltipContainer') || document.body;
            this.tooltipOffsetX = options.get('tooltipOffsetX', 10);
            this.tooltipOffsetY = options.get('tooltipOffsetY', 12);
            // remove any previous lingering tooltip
            $('#jqssizetip').remove();
            $('#jqstooltip').remove();
            this.sizetip = $('<div/>', {
                id: 'jqssizetip',
                style: sizetipStyle,
                'class': tooltipClassname
            });
            this.tooltip = $('<div/>', {
                id: 'jqstooltip',
                'class': tooltipClassname
            }).appendTo(this.container);
            // account for the container's location
            offset = this.tooltip.offset();
            this.offsetLeft = offset.left;
            this.offsetTop = offset.top;
            this.hidden = true;
            $(window).unbind('resize.jqs scroll.jqs');
            $(window).bind('resize.jqs scroll.jqs', $.proxy(this.updateWindowDims, this));
            this.updateWindowDims();
        },

        updateWindowDims: function () {
            this.scrollTop = $(window).scrollTop();
            this.scrollLeft = $(window).scrollLeft();
            this.scrollRight = this.scrollLeft + $(window).width();
            this.updatePosition();
        },

        getSize: function (content) {
            this.sizetip.html(content).appendTo(this.container);
            this.width = this.sizetip.width() + 1;
            this.height = this.sizetip.height();
            this.sizetip.remove();
        },

        setContent: function (content) {
            if (!content) {
                this.tooltip.css('visibility', 'hidden');
                this.hidden = true;
                return;
            }
            this.getSize(content);
            this.tooltip.html(content)
                .css({
                    'width': this.width,
                    'height': this.height,
                    'visibility': 'visible'
                });
            if (this.hidden) {
                this.hidden = false;
                this.updatePosition();
            }
        },

        updatePosition: function (x, y) {
            if (x === undefined) {
                if (this.mousex === undefined) {
                    return;
                }
                x = this.mousex - this.offsetLeft;
                y = this.mousey - this.offsetTop;

            } else {
                this.mousex = x = x - this.offsetLeft;
                this.mousey = y = y - this.offsetTop;
            }
            if (!this.height || !this.width || this.hidden) {
                return;
            }

            y -= this.height + this.tooltipOffsetY;
            x += this.tooltipOffsetX;

            if (y < this.scrollTop) {
                y = this.scrollTop;
            }
            if (x < this.scrollLeft) {
                x = this.scrollLeft;
            } else if (x + this.width > this.scrollRight) {
                x = this.scrollRight - this.width;
            }

            this.tooltip.css({
                'left': x,
                'top': y
            });
        },

        remove: function () {
            this.tooltip.remove();
            this.sizetip.remove();
            this.sizetip = this.tooltip = undefined;
            $(window).unbind('resize.jqs scroll.jqs');
        }
    });

    initStyles = function() {
        addCSS(defaultStyles);
    };

    $(initStyles);

    pending = [];
    $.fn.sparkline = function (userValues, userOptions) {
        return this.each(function () {
            var options = new $.fn.sparkline.options(this, userOptions),
                 $this = $(this),
                 render, i;
            render = function () {
                var values, width, height, tmp, mhandler, sp, vals;
                if (userValues === 'html' || userValues === undefined) {
                    vals = this.getAttribute(options.get('tagValuesAttribute'));
                    if (vals === undefined || vals === null) {
                        vals = $this.html();
                    }
                    values = vals.replace(/(^\s*<!--)|(-->\s*$)|\s+/g, '').split(',');
                } else {
                    values = userValues;
                }

                width = options.get('width') === 'auto' ? values.length * options.get('defaultPixelsPerValue') : options.get('width');
                if (options.get('height') === 'auto') {
                    if (!options.get('composite') || !$.data(this, '_jqs_vcanvas')) {
                        // must be a better way to get the line height
                        tmp = document.createElement('span');
                        tmp.innerHTML = 'a';
                        $this.html(tmp);
                        height = $(tmp).innerHeight() || $(tmp).height();
                        $(tmp).remove();
                        tmp = null;
                    }
                } else {
                    height = options.get('height');
                }

                if (!options.get('disableInteraction')) {
                    mhandler = $.data(this, '_jqs_mhandler');
                    if (!mhandler) {
                        mhandler = new MouseHandler(this, options);
                        $.data(this, '_jqs_mhandler', mhandler);
                    } else if (!options.get('composite')) {
                        mhandler.reset();
                    }
                } else {
                    mhandler = false;
                }

                if (options.get('composite') && !$.data(this, '_jqs_vcanvas')) {
                    if (!$.data(this, '_jqs_errnotify')) {
                        alert('Attempted to attach a composite sparkline to an element with no existing sparkline');
                        $.data(this, '_jqs_errnotify', true);
                    }
                    return;
                }

                sp = new $.fn.sparkline[options.get('type')](this, values, options, width, height);

                sp.render();

                if (mhandler) {
                    mhandler.registerSparkline(sp);
                }
            };
            if (($(this).html() && !options.get('disableHiddenCheck') && $(this).is(':hidden')) || !$(this).parents('body').length) {
                if (!options.get('composite') && $.data(this, '_jqs_pending')) {
                    // remove any existing references to the element
                    for (i = pending.length; i; i--) {
                        if (pending[i - 1][0] == this) {
                            pending.splice(i - 1, 1);
                        }
                    }
                }
                pending.push([this, render]);
                $.data(this, '_jqs_pending', true);
            } else {
                render.call(this);
            }
        });
    };

    $.fn.sparkline.defaults = getDefaults();


    $.sparkline_display_visible = function () {
        var el, i, pl;
        var done = [];
        for (i = 0, pl = pending.length; i < pl; i++) {
            el = pending[i][0];
            if ($(el).is(':visible') && !$(el).parents().is(':hidden')) {
                pending[i][1].call(el);
                $.data(pending[i][0], '_jqs_pending', false);
                done.push(i);
            } else if (!$(el).closest('html').length && !$.data(el, '_jqs_pending')) {
                // element has been inserted and removed from the DOM
                // If it was not yet inserted into the dom then the .data request
                // will return true.
                // removing from the dom causes the data to be removed.
                $.data(pending[i][0], '_jqs_pending', false);
                done.push(i);
            }
        }
        for (i = done.length; i; i--) {
            pending.splice(done[i - 1], 1);
        }
    };


    /**
     * User option handler
     */
    $.fn.sparkline.options = createClass({
        init: function (tag, userOptions) {
            var extendedOptions, defaults, base, tagOptionType;
            this.userOptions = userOptions = userOptions || {};
            this.tag = tag;
            this.tagValCache = {};
            defaults = $.fn.sparkline.defaults;
            base = defaults.common;
            this.tagOptionsPrefix = userOptions.enableTagOptions && (userOptions.tagOptionsPrefix || base.tagOptionsPrefix);

            tagOptionType = this.getTagSetting('type');
            if (tagOptionType === UNSET_OPTION) {
                extendedOptions = defaults[userOptions.type || base.type];
            } else {
                extendedOptions = defaults[tagOptionType];
            }
            this.mergedOptions = $.extend({}, base, extendedOptions, userOptions);
        },


        getTagSetting: function (key) {
            var prefix = this.tagOptionsPrefix,
                val, i, pairs, keyval;
            if (prefix === false || prefix === undefined) {
                return UNSET_OPTION;
            }
            if (this.tagValCache.hasOwnProperty(key)) {
                val = this.tagValCache.key;
            } else {
                val = this.tag.getAttribute(prefix + key);
                if (val === undefined || val === null) {
                    val = UNSET_OPTION;
                } else if (val.substr(0, 1) === '[') {
                    val = val.substr(1, val.length - 2).split(',');
                    for (i = val.length; i--;) {
                        val[i] = normalizeValue(val[i].replace(/(^\s*)|(\s*$)/g, ''));
                    }
                } else if (val.substr(0, 1) === '{') {
                    pairs = val.substr(1, val.length - 2).split(',');
                    val = {};
                    for (i = pairs.length; i--;) {
                        keyval = pairs[i].split(':', 2);
                        val[keyval[0].replace(/(^\s*)|(\s*$)/g, '')] = normalizeValue(keyval[1].replace(/(^\s*)|(\s*$)/g, ''));
                    }
                } else {
                    val = normalizeValue(val);
                }
                this.tagValCache.key = val;
            }
            return val;
        },

        get: function (key, defaultval) {
            var tagOption = this.getTagSetting(key),
                result;
            if (tagOption !== UNSET_OPTION) {
                return tagOption;
            }
            return (result = this.mergedOptions[key]) === undefined ? defaultval : result;
        }
    });


    $.fn.sparkline._base = createClass({
        disabled: false,

        init: function (el, values, options, width, height) {
            this.el = el;
            this.$el = $(el);
            this.values = values;
            this.options = options;
            this.width = width;
            this.height = height;
            this.currentRegion = undefined;
        },

        /**
         * Setup the canvas
         */
        initTarget: function () {
            var interactive = !this.options.get('disableInteraction');
            if (!(this.target = this.$el.simpledraw(this.width, this.height, this.options.get('composite'), interactive))) {
                this.disabled = true;
            } else {
                this.canvasWidth = this.target.pixelWidth;
                this.canvasHeight = this.target.pixelHeight;
            }
        },

        /**
         * Actually render the chart to the canvas
         */
        render: function () {
            if (this.disabled) {
                this.el.innerHTML = '';
                return false;
            }
            return true;
        },

        /**
         * Return a region id for a given x/y co-ordinate
         */
        getRegion: function (x, y) {
        },

        /**
         * Highlight an item based on the moused-over x,y co-ordinate
         */
        setRegionHighlight: function (el, x, y) {
            var currentRegion = this.currentRegion,
                highlightEnabled = !this.options.get('disableHighlight'),
                newRegion;
            if (x > this.canvasWidth || y > this.canvasHeight || x < 0 || y < 0) {
                return null;
            }
            newRegion = this.getRegion(el, x, y);
            if (currentRegion !== newRegion) {
                if (currentRegion !== undefined && highlightEnabled) {
                    this.removeHighlight();
                }
                this.currentRegion = newRegion;
                if (newRegion !== undefined && highlightEnabled) {
                    this.renderHighlight();
                }
                return true;
            }
            return false;
        },

        /**
         * Reset any currently highlighted item
         */
        clearRegionHighlight: function () {
            if (this.currentRegion !== undefined) {
                this.removeHighlight();
                this.currentRegion = undefined;
                return true;
            }
            return false;
        },

        renderHighlight: function () {
            this.changeHighlight(true);
        },

        removeHighlight: function () {
            this.changeHighlight(false);
        },

        changeHighlight: function (highlight)  {},

        /**
         * Fetch the HTML to display as a tooltip
         */
        getCurrentRegionTooltip: function () {
            var options = this.options,
                header = '',
                entries = [],
                fields, formats, formatlen, fclass, text, i,
                showFields, showFieldsKey, newFields, fv,
                formatter, format, fieldlen, j;
            if (this.currentRegion === undefined) {
                return '';
            }
            fields = this.getCurrentRegionFields();
            formatter = options.get('tooltipFormatter');
            if (formatter) {
                return formatter(this, options, fields);
            }
            if (options.get('tooltipChartTitle')) {
                header += '<div class="jqs jqstitle">' + options.get('tooltipChartTitle') + '</div>\n';
            }
            formats = this.options.get('tooltipFormat');
            if (!formats) {
                return '';
            }
            if (!$.isArray(formats)) {
                formats = [formats];
            }
            if (!$.isArray(fields)) {
                fields = [fields];
            }
            showFields = this.options.get('tooltipFormatFieldlist');
            showFieldsKey = this.options.get('tooltipFormatFieldlistKey');
            if (showFields && showFieldsKey) {
                // user-selected ordering of fields
                newFields = [];
                for (i = fields.length; i--;) {
                    fv = fields[i][showFieldsKey];
                    if ((j = $.inArray(fv, showFields)) != -1) {
                        newFields[j] = fields[i];
                    }
                }
                fields = newFields;
            }
            formatlen = formats.length;
            fieldlen = fields.length;
            for (i = 0; i < formatlen; i++) {
                format = formats[i];
                if (typeof format === 'string') {
                    format = new SPFormat(format);
                }
                fclass = format.fclass || 'jqsfield';
                for (j = 0; j < fieldlen; j++) {
                    if (!fields[j].isNull || !options.get('tooltipSkipNull')) {
                        $.extend(fields[j], {
                            prefix: options.get('tooltipPrefix'),
                            suffix: options.get('tooltipSuffix')
                        });
                        text = format.render(fields[j], options.get('tooltipValueLookups'), options);
                        entries.push('<div class="' + fclass + '">' + text + '</div>');
                    }
                }
            }
            if (entries.length) {
                return header + entries.join('\n');
            }
            return '';
        },

        getCurrentRegionFields: function () {},

        calcHighlightColor: function (color, options) {
            var highlightColor = options.get('highlightColor'),
                lighten = options.get('highlightLighten'),
                parse, mult, rgbnew, i;
            if (highlightColor) {
                return highlightColor;
            }
            if (lighten) {
                // extract RGB values
                parse = /^#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(color) || /^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(color);
                if (parse) {
                    rgbnew = [];
                    mult = color.length === 4 ? 16 : 1;
                    for (i = 0; i < 3; i++) {
                        rgbnew[i] = clipval(Math.round(parseInt(parse[i + 1], 16) * mult * lighten), 0, 255);
                    }
                    return 'rgb(' + rgbnew.join(',') + ')';
                }

            }
            return color;
        }

    });

    barHighlightMixin = {
        changeHighlight: function (highlight) {
            var currentRegion = this.currentRegion,
                target = this.target,
                shapeids = this.regionShapes[currentRegion],
                newShapes;
            // will be null if the region value was null
            if (shapeids) {
                newShapes = this.renderRegion(currentRegion, highlight);
                if ($.isArray(newShapes) || $.isArray(shapeids)) {
                    target.replaceWithShapes(shapeids, newShapes);
                    this.regionShapes[currentRegion] = $.map(newShapes, function (newShape) {
                        return newShape.id;
                    });
                } else {
                    target.replaceWithShape(shapeids, newShapes);
                    this.regionShapes[currentRegion] = newShapes.id;
                }
            }
        },

        render: function () {
            var values = this.values,
                target = this.target,
                regionShapes = this.regionShapes,
                shapes, ids, i, j;

            if (!this.cls._super.render.call(this)) {
                return;
            }
            for (i = values.length; i--;) {
                shapes = this.renderRegion(i);
                if (shapes) {
                    if ($.isArray(shapes)) {
                        ids = [];
                        for (j = shapes.length; j--;) {
                            shapes[j].append();
                            ids.push(shapes[j].id);
                        }
                        regionShapes[i] = ids;
                    } else {
                        shapes.append();
                        regionShapes[i] = shapes.id; // store just the shapeid
                    }
                } else {
                    // null value
                    regionShapes[i] = null;
                }
            }
            target.render();
        }
    };

    /**
     * Line charts
     */
    $.fn.sparkline.line = line = createClass($.fn.sparkline._base, {
        type: 'line',

        init: function (el, values, options, width, height) {
            line._super.init.call(this, el, values, options, width, height);
            this.vertices = [];
            this.regionMap = [];
            this.xvalues = [];
            this.yvalues = [];
            this.yminmax = [];
            this.hightlightSpotId = null;
            this.lastShapeId = null;
            this.initTarget();
        },

        getRegion: function (el, x, y) {
            var i,
                regionMap = this.regionMap; // maps regions to value positions
            for (i = regionMap.length; i--;) {
                if (regionMap[i] !== null && x >= regionMap[i][0] && x <= regionMap[i][1]) {
                    return regionMap[i][2];
                }
            }
            return undefined;
        },

        getCurrentRegionFields: function () {
            var currentRegion = this.currentRegion;
            return {
                isNull: this.yvalues[currentRegion] === null,
                x: this.xvalues[currentRegion],
                y: this.yvalues[currentRegion],
                color: this.options.get('lineColor'),
                fillColor: this.options.get('fillColor'),
                offset: currentRegion
            };
        },

        renderHighlight: function () {
            var currentRegion = this.currentRegion,
                target = this.target,
                vertex = this.vertices[currentRegion],
                options = this.options,
                spotRadius = options.get('spotRadius'),
                highlightSpotColor = options.get('highlightSpotColor'),
                highlightLineColor = options.get('highlightLineColor'),
                highlightSpot, highlightLine;

            if (!vertex) {
                return;
            }
            if (spotRadius && highlightSpotColor) {
                highlightSpot = target.drawCircle(vertex[0], vertex[1],
                    spotRadius, undefined, highlightSpotColor);
                this.highlightSpotId = highlightSpot.id;
                target.insertAfterShape(this.lastShapeId, highlightSpot);
            }
            if (highlightLineColor) {
                highlightLine = target.drawLine(vertex[0], this.canvasTop, vertex[0],
                    this.canvasTop + this.canvasHeight, highlightLineColor);
                this.highlightLineId = highlightLine.id;
                target.insertAfterShape(this.lastShapeId, highlightLine);
            }
        },

        removeHighlight: function () {
            var target = this.target;
            if (this.highlightSpotId) {
                target.removeShapeId(this.highlightSpotId);
                this.highlightSpotId = null;
            }
            if (this.highlightLineId) {
                target.removeShapeId(this.highlightLineId);
                this.highlightLineId = null;
            }
        },

        scanValues: function () {
            var values = this.values,
                valcount = values.length,
                xvalues = this.xvalues,
                yvalues = this.yvalues,
                yminmax = this.yminmax,
                i, val, isStr, isArray, sp;
            for (i = 0; i < valcount; i++) {
                val = values[i];
                isStr = typeof(values[i]) === 'string';
                isArray = typeof(values[i]) === 'object' && values[i] instanceof Array;
                sp = isStr && values[i].split(':');
                if (isStr && sp.length === 2) { // x:y
                    xvalues.push(Number(sp[0]));
                    yvalues.push(Number(sp[1]));
                    yminmax.push(Number(sp[1]));
                } else if (isArray) {
                    xvalues.push(val[0]);
                    yvalues.push(val[1]);
                    yminmax.push(val[1]);
                } else {
                    xvalues.push(i);
                    if (values[i] === null || values[i] === 'null') {
                        yvalues.push(null);
                    } else {
                        yvalues.push(Number(val));
                        yminmax.push(Number(val));
                    }
                }
            }
            if (this.options.get('xvalues')) {
                xvalues = this.options.get('xvalues');
            }

            this.maxy = this.maxyorg = Math.max.apply(Math, yminmax);
            this.miny = this.minyorg = Math.min.apply(Math, yminmax);

            this.maxx = Math.max.apply(Math, xvalues);
            this.minx = Math.min.apply(Math, xvalues);

            this.xvalues = xvalues;
            this.yvalues = yvalues;
            this.yminmax = yminmax;

        },

        processRangeOptions: function () {
            var options = this.options,
                normalRangeMin = options.get('normalRangeMin'),
                normalRangeMax = options.get('normalRangeMax');

            if (normalRangeMin !== undefined) {
                if (normalRangeMin < this.miny) {
                    this.miny = normalRangeMin;
                }
                if (normalRangeMax > this.maxy) {
                    this.maxy = normalRangeMax;
                }
            }
            if (options.get('chartRangeMin') !== undefined && (options.get('chartRangeClip') || options.get('chartRangeMin') < this.miny)) {
                this.miny = options.get('chartRangeMin');
            }
            if (options.get('chartRangeMax') !== undefined && (options.get('chartRangeClip') || options.get('chartRangeMax') > this.maxy)) {
                this.maxy = options.get('chartRangeMax');
            }
            if (options.get('chartRangeMinX') !== undefined && (options.get('chartRangeClipX') || options.get('chartRangeMinX') < this.minx)) {
                this.minx = options.get('chartRangeMinX');
            }
            if (options.get('chartRangeMaxX') !== undefined && (options.get('chartRangeClipX') || options.get('chartRangeMaxX') > this.maxx)) {
                this.maxx = options.get('chartRangeMaxX');
            }

        },

        drawNormalRange: function (canvasLeft, canvasTop, canvasHeight, canvasWidth, rangey) {
            var normalRangeMin = this.options.get('normalRangeMin'),
                normalRangeMax = this.options.get('normalRangeMax'),
                ytop = canvasTop + Math.round(canvasHeight - (canvasHeight * ((normalRangeMax - this.miny) / rangey))),
                height = Math.round((canvasHeight * (normalRangeMax - normalRangeMin)) / rangey);
            this.target.drawRect(canvasLeft, ytop, canvasWidth, height, undefined, this.options.get('normalRangeColor')).append();
        },

        render: function () {
            var options = this.options,
                target = this.target,
                canvasWidth = this.canvasWidth,
                canvasHeight = this.canvasHeight,
                vertices = this.vertices,
                spotRadius = options.get('spotRadius'),
                regionMap = this.regionMap,
                rangex, rangey, yvallast,
                canvasTop, canvasLeft,
                vertex, path, paths, x, y, xnext, xpos, xposnext,
                last, next, yvalcount, lineShapes, fillShapes, plen,
                valueSpots, hlSpotsEnabled, color, xvalues, yvalues, i;

            if (!line._super.render.call(this)) {
                return;
            }

            this.scanValues();
            this.processRangeOptions();

            xvalues = this.xvalues;
            yvalues = this.yvalues;

            if (!this.yminmax.length || this.yvalues.length < 2) {
                // empty or all null valuess
                return;
            }

            canvasTop = canvasLeft = 0;

            rangex = this.maxx - this.minx === 0 ? 1 : this.maxx - this.minx;
            rangey = this.maxy - this.miny === 0 ? 1 : this.maxy - this.miny;
            yvallast = this.yvalues.length - 1;

            if (spotRadius && (canvasWidth < (spotRadius * 4) || canvasHeight < (spotRadius * 4))) {
                spotRadius = 0;
            }
            if (spotRadius) {
                // adjust the canvas size as required so that spots will fit
                hlSpotsEnabled = options.get('highlightSpotColor') &&  !options.get('disableInteraction');
                if (hlSpotsEnabled || options.get('minSpotColor') || (options.get('spotColor') && yvalues[yvallast] === this.miny)) {
                    canvasHeight -= Math.ceil(spotRadius);
                }
                if (hlSpotsEnabled || options.get('maxSpotColor') || (options.get('spotColor') && yvalues[yvallast] === this.maxy)) {
                    canvasHeight -= Math.ceil(spotRadius);
                    canvasTop += Math.ceil(spotRadius);
                }
                if (hlSpotsEnabled ||
                     ((options.get('minSpotColor') || options.get('maxSpotColor')) && (yvalues[0] === this.miny || yvalues[0] === this.maxy))) {
                    canvasLeft += Math.ceil(spotRadius);
                    canvasWidth -= Math.ceil(spotRadius);
                }
                if (hlSpotsEnabled || options.get('spotColor') ||
                    (options.get('minSpotColor') || options.get('maxSpotColor') &&
                        (yvalues[yvallast] === this.miny || yvalues[yvallast] === this.maxy))) {
                    canvasWidth -= Math.ceil(spotRadius);
                }
            }


            canvasHeight--;

            if (options.get('normalRangeMin') !== undefined && !options.get('drawNormalOnTop')) {
                this.drawNormalRange(canvasLeft, canvasTop, canvasHeight, canvasWidth, rangey);
            }

            path = [];
            paths = [path];
            last = next = null;
            yvalcount = yvalues.length;
            for (i = 0; i < yvalcount; i++) {
                x = xvalues[i];
                xnext = xvalues[i + 1];
                y = yvalues[i];
                xpos = canvasLeft + Math.round((x - this.minx) * (canvasWidth / rangex));
                xposnext = i < yvalcount - 1 ? canvasLeft + Math.round((xnext - this.minx) * (canvasWidth / rangex)) : canvasWidth;
                next = xpos + ((xposnext - xpos) / 2);
                regionMap[i] = [last || 0, next, i];
                last = next;
                if (y === null) {
                    if (i) {
                        if (yvalues[i - 1] !== null) {
                            path = [];
                            paths.push(path);
                        }
                        vertices.push(null);
                    }
                } else {
                    if (y < this.miny) {
                        y = this.miny;
                    }
                    if (y > this.maxy) {
                        y = this.maxy;
                    }
                    if (!path.length) {
                        // previous value was null
                        path.push([xpos, canvasTop + canvasHeight]);
                    }
                    vertex = [xpos, canvasTop + Math.round(canvasHeight - (canvasHeight * ((y - this.miny) / rangey)))];
                    path.push(vertex);
                    vertices.push(vertex);
                }
            }

            lineShapes = [];
            fillShapes = [];
            plen = paths.length;
            for (i = 0; i < plen; i++) {
                path = paths[i];
                if (path.length) {
                    if (options.get('fillColor')) {
                        path.push([path[path.length - 1][0], (canvasTop + canvasHeight)]);
                        fillShapes.push(path.slice(0));
                        path.pop();
                    }
                    // if there's only a single point in this path, then we want to display it
                    // as a vertical line which means we keep path[0]  as is
                    if (path.length > 2) {
                        // else we want the first value
                        path[0] = [path[0][0], path[1][1]];
                    }
                    lineShapes.push(path);
                }
            }

            // draw the fill first, then optionally the normal range, then the line on top of that
            plen = fillShapes.length;
            for (i = 0; i < plen; i++) {
                target.drawShape(fillShapes[i],
                    options.get('fillColor'), options.get('fillColor')).append();
            }

            if (options.get('normalRangeMin') !== undefined && options.get('drawNormalOnTop')) {
                this.drawNormalRange(canvasLeft, canvasTop, canvasHeight, canvasWidth, rangey);
            }

            plen = lineShapes.length;
            for (i = 0; i < plen; i++) {
                target.drawShape(lineShapes[i], options.get('lineColor'), undefined,
                    options.get('lineWidth')).append();
            }

            if (spotRadius && options.get('valueSpots')) {
                valueSpots = options.get('valueSpots');
                if (valueSpots.get === undefined) {
                    valueSpots = new RangeMap(valueSpots);
                }
                for (i = 0; i < yvalcount; i++) {
                    color = valueSpots.get(yvalues[i]);
                    if (color) {
                        target.drawCircle(canvasLeft + Math.round((xvalues[i] - this.minx) * (canvasWidth / rangex)),
                            canvasTop + Math.round(canvasHeight - (canvasHeight * ((yvalues[i] - this.miny) / rangey))),
                            spotRadius, undefined,
                            color).append();
                    }
                }

            }
            if (spotRadius && options.get('spotColor') && yvalues[yvallast] !== null) {
                target.drawCircle(canvasLeft + Math.round((xvalues[xvalues.length - 1] - this.minx) * (canvasWidth / rangex)),
                    canvasTop + Math.round(canvasHeight - (canvasHeight * ((yvalues[yvallast] - this.miny) / rangey))),
                    spotRadius, undefined,
                    options.get('spotColor')).append();
            }
            if (this.maxy !== this.minyorg) {
                if (spotRadius && options.get('minSpotColor')) {
                    x = xvalues[$.inArray(this.minyorg, yvalues)];
                    target.drawCircle(canvasLeft + Math.round((x - this.minx) * (canvasWidth / rangex)),
                        canvasTop + Math.round(canvasHeight - (canvasHeight * ((this.minyorg - this.miny) / rangey))),
                        spotRadius, undefined,
                        options.get('minSpotColor')).append();
                }
                if (spotRadius && options.get('maxSpotColor')) {
                    x = xvalues[$.inArray(this.maxyorg, yvalues)];
                    target.drawCircle(canvasLeft + Math.round((x - this.minx) * (canvasWidth / rangex)),
                        canvasTop + Math.round(canvasHeight - (canvasHeight * ((this.maxyorg - this.miny) / rangey))),
                        spotRadius, undefined,
                        options.get('maxSpotColor')).append();
                }
            }

            this.lastShapeId = target.getLastShapeId();
            this.canvasTop = canvasTop;
            target.render();
        }
    });

    /**
     * Bar charts
     */
    $.fn.sparkline.bar = bar = createClass($.fn.sparkline._base, barHighlightMixin, {
        type: 'bar',

        init: function (el, values, options, width, height) {
            var barWidth = parseInt(options.get('barWidth'), 10),
                barSpacing = parseInt(options.get('barSpacing'), 10),
                chartRangeMin = options.get('chartRangeMin'),
                chartRangeMax = options.get('chartRangeMax'),
                chartRangeClip = options.get('chartRangeClip'),
                stackMin = Infinity,
                stackMax = -Infinity,
                isStackString, groupMin, groupMax, stackRanges,
                numValues, i, vlen, range, zeroAxis, xaxisOffset, min, max, clipMin, clipMax,
                stacked, vlist, j, slen, svals, val, yoffset, yMaxCalc, canvasHeightEf;
            bar._super.init.call(this, el, values, options, width, height);

            // scan values to determine whether to stack bars
            for (i = 0, vlen = values.length; i < vlen; i++) {
                val = values[i];
                isStackString = typeof(val) === 'string' && val.indexOf(':') > -1;
                if (isStackString || $.isArray(val)) {
                    stacked = true;
                    if (isStackString) {
                        val = values[i] = normalizeValues(val.split(':'));
                    }
                    val = remove(val, null); // min/max will treat null as zero
                    groupMin = Math.min.apply(Math, val);
                    groupMax = Math.max.apply(Math, val);
                    if (groupMin < stackMin) {
                        stackMin = groupMin;
                    }
                    if (groupMax > stackMax) {
                        stackMax = groupMax;
                    }
                }
            }

            this.stacked = stacked;
            this.regionShapes = {};
            this.barWidth = barWidth;
            this.barSpacing = barSpacing;
            this.totalBarWidth = barWidth + barSpacing;
            this.width = width = (values.length * barWidth) + ((values.length - 1) * barSpacing);

            this.initTarget();

            if (chartRangeClip) {
                clipMin = chartRangeMin === undefined ? -Infinity : chartRangeMin;
                clipMax = chartRangeMax === undefined ? Infinity : chartRangeMax;
            }

            numValues = [];
            stackRanges = stacked ? [] : numValues;
            var stackTotals = [];
            var stackRangesNeg = [];
            for (i = 0, vlen = values.length; i < vlen; i++) {
                if (stacked) {
                    vlist = values[i];
                    values[i] = svals = [];
                    stackTotals[i] = 0;
                    stackRanges[i] = stackRangesNeg[i] = 0;
                    for (j = 0, slen = vlist.length; j < slen; j++) {
                        val = svals[j] = chartRangeClip ? clipval(vlist[j], clipMin, clipMax) : vlist[j];
                        if (val !== null) {
                            if (val > 0) {
                                stackTotals[i] += val;
                            }
                            if (stackMin < 0 && stackMax > 0) {
                                if (val < 0) {
                                    stackRangesNeg[i] += Math.abs(val);
                                } else {
                                    stackRanges[i] += val;
                                }
                            } else {
                                stackRanges[i] += Math.abs(val - (val < 0 ? stackMax : stackMin));
                            }
                            numValues.push(val);
                        }
                    }
                } else {
                    val = chartRangeClip ? clipval(values[i], clipMin, clipMax) : values[i];
                    val = values[i] = normalizeValue(val);
                    if (val !== null) {
                        numValues.push(val);
                    }
                }
            }
            this.max = max = Math.max.apply(Math, numValues);
            this.min = min = Math.min.apply(Math, numValues);
            this.stackMax = stackMax = stacked ? Math.max.apply(Math, stackTotals) : max;
            this.stackMin = stackMin = stacked ? Math.min.apply(Math, numValues) : min;

            if (options.get('chartRangeMin') !== undefined && (options.get('chartRangeClip') || options.get('chartRangeMin') < min)) {
                min = options.get('chartRangeMin');
            }
            if (options.get('chartRangeMax') !== undefined && (options.get('chartRangeClip') || options.get('chartRangeMax') > max)) {
                max = options.get('chartRangeMax');
            }

            this.zeroAxis = zeroAxis = options.get('zeroAxis', true);
            if (min <= 0 && max >= 0 && zeroAxis) {
                xaxisOffset = 0;
            } else if (zeroAxis == false) {
                xaxisOffset = min;
            } else if (min > 0) {
                xaxisOffset = min;
            } else {
                xaxisOffset = max;
            }
            this.xaxisOffset = xaxisOffset;

            range = stacked ? (Math.max.apply(Math, stackRanges) + Math.max.apply(Math, stackRangesNeg)) : max - min;

            // as we plot zero/min values a single pixel line, we add a pixel to all other
            // values - Reduce the effective canvas size to suit
            this.canvasHeightEf = (zeroAxis && min < 0) ? this.canvasHeight - 2 : this.canvasHeight - 1;

            if (min < xaxisOffset) {
                yMaxCalc = (stacked && max >= 0) ? stackMax : max;
                yoffset = (yMaxCalc - xaxisOffset) / range * this.canvasHeight;
                if (yoffset !== Math.ceil(yoffset)) {
                    this.canvasHeightEf -= 2;
                    yoffset = Math.ceil(yoffset);
                }
            } else {
                yoffset = this.canvasHeight;
            }
            this.yoffset = yoffset;

            if ($.isArray(options.get('colorMap'))) {
                this.colorMapByIndex = options.get('colorMap');
                this.colorMapByValue = null;
            } else {
                this.colorMapByIndex = null;
                this.colorMapByValue = options.get('colorMap');
                if (this.colorMapByValue && this.colorMapByValue.get === undefined) {
                    this.colorMapByValue = new RangeMap(this.colorMapByValue);
                }
            }

            this.range = range;
        },

        getRegion: function (el, x, y) {
            var result = Math.floor(x / this.totalBarWidth);
            return (result < 0 || result >= this.values.length) ? undefined : result;
        },

        getCurrentRegionFields: function () {
            var currentRegion = this.currentRegion,
                values = ensureArray(this.values[currentRegion]),
                result = [],
                value, i;
            for (i = values.length; i--;) {
                value = values[i];
                result.push({
                    isNull: value === null,
                    value: value,
                    color: this.calcColor(i, value, currentRegion),
                    offset: currentRegion
                });
            }
            return result;
        },

        calcColor: function (stacknum, value, valuenum) {
            var colorMapByIndex = this.colorMapByIndex,
                colorMapByValue = this.colorMapByValue,
                options = this.options,
                color, newColor;
            if (this.stacked) {
                color = options.get('stackedBarColor');
            } else {
                color = (value < 0) ? options.get('negBarColor') : options.get('barColor');
            }
            if (value === 0 && options.get('zeroColor') !== undefined) {
                color = options.get('zeroColor');
            }
            if (colorMapByValue && (newColor = colorMapByValue.get(value))) {
                color = newColor;
            } else if (colorMapByIndex && colorMapByIndex.length > valuenum) {
                color = colorMapByIndex[valuenum];
            }
            return $.isArray(color) ? color[stacknum % color.length] : color;
        },

        /**
         * Render bar(s) for a region
         */
        renderRegion: function (valuenum, highlight) {
            var vals = this.values[valuenum],
                options = this.options,
                xaxisOffset = this.xaxisOffset,
                result = [],
                range = this.range,
                stacked = this.stacked,
                target = this.target,
                x = valuenum * this.totalBarWidth,
                canvasHeightEf = this.canvasHeightEf,
                yoffset = this.yoffset,
                y, height, color, isNull, yoffsetNeg, i, valcount, val, minPlotted, allMin;

            vals = $.isArray(vals) ? vals : [vals];
            valcount = vals.length;
            val = vals[0];
            isNull = all(null, vals);
            allMin = all(xaxisOffset, vals, true);

            if (isNull) {
                if (options.get('nullColor')) {
                    color = highlight ? options.get('nullColor') : this.calcHighlightColor(options.get('nullColor'), options);
                    y = (yoffset > 0) ? yoffset - 1 : yoffset;
                    return target.drawRect(x, y, this.barWidth - 1, 0, color, color);
                } else {
                    return undefined;
                }
            }
            yoffsetNeg = yoffset;
            for (i = 0; i < valcount; i++) {
                val = vals[i];

                if (stacked && val === xaxisOffset) {
                    if (!allMin || minPlotted) {
                        continue;
                    }
                    minPlotted = true;
                }

                if (range > 0) {
                    height = Math.floor(canvasHeightEf * ((Math.abs(val - xaxisOffset) / range))) + 1;
                } else {
                    height = 1;
                }
                if (val < xaxisOffset || (val === xaxisOffset && yoffset === 0)) {
                    y = yoffsetNeg;
                    yoffsetNeg += height;
                } else {
                    y = yoffset - height;
                    yoffset -= height;
                }
                color = this.calcColor(i, val, valuenum);
                if (highlight) {
                    color = this.calcHighlightColor(color, options);
                }
                result.push(target.drawRect(x, y, this.barWidth - 1, height - 1, color, color));
            }
            if (result.length === 1) {
                return result[0];
            }
            return result;
        }
    });

    /**
     * Tristate charts
     */
    $.fn.sparkline.tristate = tristate = createClass($.fn.sparkline._base, barHighlightMixin, {
        type: 'tristate',

        init: function (el, values, options, width, height) {
            var barWidth = parseInt(options.get('barWidth'), 10),
                barSpacing = parseInt(options.get('barSpacing'), 10);
            tristate._super.init.call(this, el, values, options, width, height);

            this.regionShapes = {};
            this.barWidth = barWidth;
            this.barSpacing = barSpacing;
            this.totalBarWidth = barWidth + barSpacing;
            this.values = $.map(values, Number);
            this.width = width = (values.length * barWidth) + ((values.length - 1) * barSpacing);

            if ($.isArray(options.get('colorMap'))) {
                this.colorMapByIndex = options.get('colorMap');
                this.colorMapByValue = null;
            } else {
                this.colorMapByIndex = null;
                this.colorMapByValue = options.get('colorMap');
                if (this.colorMapByValue && this.colorMapByValue.get === undefined) {
                    this.colorMapByValue = new RangeMap(this.colorMapByValue);
                }
            }
            this.initTarget();
        },

        getRegion: function (el, x, y) {
            return Math.floor(x / this.totalBarWidth);
        },

        getCurrentRegionFields: function () {
            var currentRegion = this.currentRegion;
            return {
                isNull: this.values[currentRegion] === undefined,
                value: this.values[currentRegion],
                color: this.calcColor(this.values[currentRegion], currentRegion),
                offset: currentRegion
            };
        },

        calcColor: function (value, valuenum) {
            var values = this.values,
                options = this.options,
                colorMapByIndex = this.colorMapByIndex,
                colorMapByValue = this.colorMapByValue,
                color, newColor;

            if (colorMapByValue && (newColor = colorMapByValue.get(value))) {
                color = newColor;
            } else if (colorMapByIndex && colorMapByIndex.length > valuenum) {
                color = colorMapByIndex[valuenum];
            } else if (values[valuenum] < 0) {
                color = options.get('negBarColor');
            } else if (values[valuenum] > 0) {
                color = options.get('posBarColor');
            } else {
                color = options.get('zeroBarColor');
            }
            return color;
        },

        renderRegion: function (valuenum, highlight) {
            var values = this.values,
                options = this.options,
                target = this.target,
                canvasHeight, height, halfHeight,
                x, y, color;

            canvasHeight = target.pixelHeight;
            halfHeight = Math.round(canvasHeight / 2);

            x = valuenum * this.totalBarWidth;
            if (values[valuenum] < 0) {
                y = halfHeight;
                height = halfHeight - 1;
            } else if (values[valuenum] > 0) {
                y = 0;
                height = halfHeight - 1;
            } else {
                y = halfHeight - 1;
                height = 2;
            }
            color = this.calcColor(values[valuenum], valuenum);
            if (color === null) {
                return;
            }
            if (highlight) {
                color = this.calcHighlightColor(color, options);
            }
            return target.drawRect(x, y, this.barWidth - 1, height - 1, color, color);
        }
    });

    /**
     * Discrete charts
     */
    $.fn.sparkline.discrete = discrete = createClass($.fn.sparkline._base, barHighlightMixin, {
        type: 'discrete',

        init: function (el, values, options, width, height) {
            discrete._super.init.call(this, el, values, options, width, height);

            this.regionShapes = {};
            this.values = values = $.map(values, Number);
            this.min = Math.min.apply(Math, values);
            this.max = Math.max.apply(Math, values);
            this.range = this.max - this.min;
            this.width = width = options.get('width') === 'auto' ? values.length * 2 : this.width;
            this.interval = Math.floor(width / values.length);
            this.itemWidth = width / values.length;
            if (options.get('chartRangeMin') !== undefined && (options.get('chartRangeClip') || options.get('chartRangeMin') < this.min)) {
                this.min = options.get('chartRangeMin');
            }
            if (options.get('chartRangeMax') !== undefined && (options.get('chartRangeClip') || options.get('chartRangeMax') > this.max)) {
                this.max = options.get('chartRangeMax');
            }
            this.initTarget();
            if (this.target) {
                this.lineHeight = options.get('lineHeight') === 'auto' ? Math.round(this.canvasHeight * 0.3) : options.get('lineHeight');
            }
        },

        getRegion: function (el, x, y) {
            return Math.floor(x / this.itemWidth);
        },

        getCurrentRegionFields: function () {
            var currentRegion = this.currentRegion;
            return {
                isNull: this.values[currentRegion] === undefined,
                value: this.values[currentRegion],
                offset: currentRegion
            };
        },

        renderRegion: function (valuenum, highlight) {
            var values = this.values,
                options = this.options,
                min = this.min,
                max = this.max,
                range = this.range,
                interval = this.interval,
                target = this.target,
                canvasHeight = this.canvasHeight,
                lineHeight = this.lineHeight,
                pheight = canvasHeight - lineHeight,
                ytop, val, color, x;

            val = clipval(values[valuenum], min, max);
            x = valuenum * interval;
            ytop = Math.round(pheight - pheight * ((val - min) / range));
            color = (options.get('thresholdColor') && val < options.get('thresholdValue')) ? options.get('thresholdColor') : options.get('lineColor');
            if (highlight) {
                color = this.calcHighlightColor(color, options);
            }
            return target.drawLine(x, ytop, x, ytop + lineHeight, color);
        }
    });

    /**
     * Bullet charts
     */
    $.fn.sparkline.bullet = bullet = createClass($.fn.sparkline._base, {
        type: 'bullet',

        init: function (el, values, options, width, height) {
            var min, max, vals;
            bullet._super.init.call(this, el, values, options, width, height);

            // values: target, performance, range1, range2, range3
            this.values = values = normalizeValues(values);
            // target or performance could be null
            vals = values.slice();
            vals[0] = vals[0] === null ? vals[2] : vals[0];
            vals[1] = values[1] === null ? vals[2] : vals[1];
            min = Math.min.apply(Math, values);
            max = Math.max.apply(Math, values);
            if (options.get('base') === undefined) {
                min = min < 0 ? min : 0;
            } else {
                min = options.get('base');
            }
            this.min = min;
            this.max = max;
            this.range = max - min;
            this.shapes = {};
            this.valueShapes = {};
            this.regiondata = {};
            this.width = width = options.get('width') === 'auto' ? '4.0em' : width;
            this.target = this.$el.simpledraw(width, height, options.get('composite'));
            if (!values.length) {
                this.disabled = true;
            }
            this.initTarget();
        },

        getRegion: function (el, x, y) {
            var shapeid = this.target.getShapeAt(el, x, y);
            return (shapeid !== undefined && this.shapes[shapeid] !== undefined) ? this.shapes[shapeid] : undefined;
        },

        getCurrentRegionFields: function () {
            var currentRegion = this.currentRegion;
            return {
                fieldkey: currentRegion.substr(0, 1),
                value: this.values[currentRegion.substr(1)],
                region: currentRegion
            };
        },

        changeHighlight: function (highlight) {
            var currentRegion = this.currentRegion,
                shapeid = this.valueShapes[currentRegion],
                shape;
            delete this.shapes[shapeid];
            switch (currentRegion.substr(0, 1)) {
                case 'r':
                    shape = this.renderRange(currentRegion.substr(1), highlight);
                    break;
                case 'p':
                    shape = this.renderPerformance(highlight);
                    break;
                case 't':
                    shape = this.renderTarget(highlight);
                    break;
            }
            this.valueShapes[currentRegion] = shape.id;
            this.shapes[shape.id] = currentRegion;
            this.target.replaceWithShape(shapeid, shape);
        },

        renderRange: function (rn, highlight) {
            var rangeval = this.values[rn],
                rangewidth = Math.round(this.canvasWidth * ((rangeval - this.min) / this.range)),
                color = this.options.get('rangeColors')[rn - 2];
            if (highlight) {
                color = this.calcHighlightColor(color, this.options);
            }
            return this.target.drawRect(0, 0, rangewidth - 1, this.canvasHeight - 1, color, color);
        },

        renderPerformance: function (highlight) {
            var perfval = this.values[1],
                perfwidth = Math.round(this.canvasWidth * ((perfval - this.min) / this.range)),
                color = this.options.get('performanceColor');
            if (highlight) {
                color = this.calcHighlightColor(color, this.options);
            }
            return this.target.drawRect(0, Math.round(this.canvasHeight * 0.3), perfwidth - 1,
                Math.round(this.canvasHeight * 0.4) - 1, color, color);
        },

        renderTarget: function (highlight) {
            var targetval = this.values[0],
                x = Math.round(this.canvasWidth * ((targetval - this.min) / this.range) - (this.options.get('targetWidth') / 2)),
                targettop = Math.round(this.canvasHeight * 0.10),
                targetheight = this.canvasHeight - (targettop * 2),
                color = this.options.get('targetColor');
            if (highlight) {
                color = this.calcHighlightColor(color, this.options);
            }
            return this.target.drawRect(x, targettop, this.options.get('targetWidth') - 1, targetheight - 1, color, color);
        },

        render: function () {
            var vlen = this.values.length,
                target = this.target,
                i, shape;
            if (!bullet._super.render.call(this)) {
                return;
            }
            for (i = 2; i < vlen; i++) {
                shape = this.renderRange(i).append();
                this.shapes[shape.id] = 'r' + i;
                this.valueShapes['r' + i] = shape.id;
            }
            if (this.values[1] !== null) {
                shape = this.renderPerformance().append();
                this.shapes[shape.id] = 'p1';
                this.valueShapes.p1 = shape.id;
            }
            if (this.values[0] !== null) {
                shape = this.renderTarget().append();
                this.shapes[shape.id] = 't0';
                this.valueShapes.t0 = shape.id;
            }
            target.render();
        }
    });

    /**
     * Pie charts
     */
    $.fn.sparkline.pie = pie = createClass($.fn.sparkline._base, {
        type: 'pie',

        init: function (el, values, options, width, height) {
            var total = 0, i;

            pie._super.init.call(this, el, values, options, width, height);

            this.shapes = {}; // map shape ids to value offsets
            this.valueShapes = {}; // maps value offsets to shape ids
            this.values = values = $.map(values, Number);

            if (options.get('width') === 'auto') {
                this.width = this.height;
            }

            if (values.length > 0) {
                for (i = values.length; i--;) {
                    total += values[i];
                }
            }
            this.total = total;
            this.initTarget();
            this.radius = Math.floor(Math.min(this.canvasWidth, this.canvasHeight) / 2);
        },

        getRegion: function (el, x, y) {
            var shapeid = this.target.getShapeAt(el, x, y);
            return (shapeid !== undefined && this.shapes[shapeid] !== undefined) ? this.shapes[shapeid] : undefined;
        },

        getCurrentRegionFields: function () {
            var currentRegion = this.currentRegion;
            return {
                isNull: this.values[currentRegion] === undefined,
                value: this.values[currentRegion],
                percent: this.values[currentRegion] / this.total * 100,
                color: this.options.get('sliceColors')[currentRegion % this.options.get('sliceColors').length],
                offset: currentRegion
            };
        },

        changeHighlight: function (highlight) {
            var currentRegion = this.currentRegion,
                 newslice = this.renderSlice(currentRegion, highlight),
                 shapeid = this.valueShapes[currentRegion];
            delete this.shapes[shapeid];
            this.target.replaceWithShape(shapeid, newslice);
            this.valueShapes[currentRegion] = newslice.id;
            this.shapes[newslice.id] = currentRegion;
        },

        renderSlice: function (valuenum, highlight) {
            var target = this.target,
                options = this.options,
                radius = this.radius,
                borderWidth = options.get('borderWidth'),
                offset = options.get('offset'),
                circle = 2 * Math.PI,
                values = this.values,
                total = this.total,
                next = offset ? (2*Math.PI)*(offset/360) : 0,
                start, end, i, vlen, color;

            vlen = values.length;
            for (i = 0; i < vlen; i++) {
                start = next;
                end = next;
                if (total > 0) {  // avoid divide by zero
                    end = next + (circle * (values[i] / total));
                }
                if (valuenum === i) {
                    color = options.get('sliceColors')[i % options.get('sliceColors').length];
                    if (highlight) {
                        color = this.calcHighlightColor(color, options);
                    }

                    return target.drawPieSlice(radius, radius, radius - borderWidth, start, end, undefined, color);
                }
                next = end;
            }
        },

        render: function () {
            var target = this.target,
                values = this.values,
                options = this.options,
                radius = this.radius,
                borderWidth = options.get('borderWidth'),
                shape, i;

            if (!pie._super.render.call(this)) {
                return;
            }
            if (borderWidth) {
                target.drawCircle(radius, radius, Math.floor(radius - (borderWidth / 2)),
                    options.get('borderColor'), undefined, borderWidth).append();
            }
            for (i = values.length; i--;) {
                if (values[i]) { // don't render zero values
                    shape = this.renderSlice(i).append();
                    this.valueShapes[i] = shape.id; // store just the shapeid
                    this.shapes[shape.id] = i;
                }
            }
            target.render();
        }
    });

    /**
     * Box plots
     */
    $.fn.sparkline.box = box = createClass($.fn.sparkline._base, {
        type: 'box',

        init: function (el, values, options, width, height) {
            box._super.init.call(this, el, values, options, width, height);
            this.values = $.map(values, Number);
            this.width = options.get('width') === 'auto' ? '4.0em' : width;
            this.initTarget();
            if (!this.values.length) {
                this.disabled = 1;
            }
        },

        /**
         * Simulate a single region
         */
        getRegion: function () {
            return 1;
        },

        getCurrentRegionFields: function () {
            var result = [
                { field: 'lq', value: this.quartiles[0] },
                { field: 'med', value: this.quartiles[1] },
                { field: 'uq', value: this.quartiles[2] }
            ];
            if (this.loutlier !== undefined) {
                result.push({ field: 'lo', value: this.loutlier});
            }
            if (this.routlier !== undefined) {
                result.push({ field: 'ro', value: this.routlier});
            }
            if (this.lwhisker !== undefined) {
                result.push({ field: 'lw', value: this.lwhisker});
            }
            if (this.rwhisker !== undefined) {
                result.push({ field: 'rw', value: this.rwhisker});
            }
            return result;
        },

        render: function () {
            var target = this.target,
                values = this.values,
                vlen = values.length,
                options = this.options,
                canvasWidth = this.canvasWidth,
                canvasHeight = this.canvasHeight,
                minValue = options.get('chartRangeMin') === undefined ? Math.min.apply(Math, values) : options.get('chartRangeMin'),
                maxValue = options.get('chartRangeMax') === undefined ? Math.max.apply(Math, values) : options.get('chartRangeMax'),
                canvasLeft = 0,
                lwhisker, loutlier, iqr, q1, q2, q3, rwhisker, routlier, i,
                size, unitSize;

            if (!box._super.render.call(this)) {
                return;
            }

            if (options.get('raw')) {
                if (options.get('showOutliers') && values.length > 5) {
                    loutlier = values[0];
                    lwhisker = values[1];
                    q1 = values[2];
                    q2 = values[3];
                    q3 = values[4];
                    rwhisker = values[5];
                    routlier = values[6];
                } else {
                    lwhisker = values[0];
                    q1 = values[1];
                    q2 = values[2];
                    q3 = values[3];
                    rwhisker = values[4];
                }
            } else {
                values.sort(function (a, b) { return a - b; });
                q1 = quartile(values, 1);
                q2 = quartile(values, 2);
                q3 = quartile(values, 3);
                iqr = q3 - q1;
                if (options.get('showOutliers')) {
                    lwhisker = rwhisker = undefined;
                    for (i = 0; i < vlen; i++) {
                        if (lwhisker === undefined && values[i] > q1 - (iqr * options.get('outlierIQR'))) {
                            lwhisker = values[i];
                        }
                        if (values[i] < q3 + (iqr * options.get('outlierIQR'))) {
                            rwhisker = values[i];
                        }
                    }
                    loutlier = values[0];
                    routlier = values[vlen - 1];
                } else {
                    lwhisker = values[0];
                    rwhisker = values[vlen - 1];
                }
            }
            this.quartiles = [q1, q2, q3];
            this.lwhisker = lwhisker;
            this.rwhisker = rwhisker;
            this.loutlier = loutlier;
            this.routlier = routlier;

            unitSize = canvasWidth / (maxValue - minValue + 1);
            if (options.get('showOutliers')) {
                canvasLeft = Math.ceil(options.get('spotRadius'));
                canvasWidth -= 2 * Math.ceil(options.get('spotRadius'));
                unitSize = canvasWidth / (maxValue - minValue + 1);
                if (loutlier < lwhisker) {
                    target.drawCircle((loutlier - minValue) * unitSize + canvasLeft,
                        canvasHeight / 2,
                        options.get('spotRadius'),
                        options.get('outlierLineColor'),
                        options.get('outlierFillColor')).append();
                }
                if (routlier > rwhisker) {
                    target.drawCircle((routlier - minValue) * unitSize + canvasLeft,
                        canvasHeight / 2,
                        options.get('spotRadius'),
                        options.get('outlierLineColor'),
                        options.get('outlierFillColor')).append();
                }
            }

            // box
            target.drawRect(
                Math.round((q1 - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight * 0.1),
                Math.round((q3 - q1) * unitSize),
                Math.round(canvasHeight * 0.8),
                options.get('boxLineColor'),
                options.get('boxFillColor')).append();
            // left whisker
            target.drawLine(
                Math.round((lwhisker - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight / 2),
                Math.round((q1 - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight / 2),
                options.get('lineColor')).append();
            target.drawLine(
                Math.round((lwhisker - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight / 4),
                Math.round((lwhisker - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight - canvasHeight / 4),
                options.get('whiskerColor')).append();
            // right whisker
            target.drawLine(Math.round((rwhisker - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight / 2),
                Math.round((q3 - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight / 2),
                options.get('lineColor')).append();
            target.drawLine(
                Math.round((rwhisker - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight / 4),
                Math.round((rwhisker - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight - canvasHeight / 4),
                options.get('whiskerColor')).append();
            // median line
            target.drawLine(
                Math.round((q2 - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight * 0.1),
                Math.round((q2 - minValue) * unitSize + canvasLeft),
                Math.round(canvasHeight * 0.9),
                options.get('medianColor')).append();
            if (options.get('target')) {
                size = Math.ceil(options.get('spotRadius'));
                target.drawLine(
                    Math.round((options.get('target') - minValue) * unitSize + canvasLeft),
                    Math.round((canvasHeight / 2) - size),
                    Math.round((options.get('target') - minValue) * unitSize + canvasLeft),
                    Math.round((canvasHeight / 2) + size),
                    options.get('targetColor')).append();
                target.drawLine(
                    Math.round((options.get('target') - minValue) * unitSize + canvasLeft - size),
                    Math.round(canvasHeight / 2),
                    Math.round((options.get('target') - minValue) * unitSize + canvasLeft + size),
                    Math.round(canvasHeight / 2),
                    options.get('targetColor')).append();
            }
            target.render();
        }
    });

    // Setup a very simple "virtual canvas" to make drawing the few shapes we need easier
    // This is accessible as $(foo).simpledraw()

    VShape = createClass({
        init: function (target, id, type, args) {
            this.target = target;
            this.id = id;
            this.type = type;
            this.args = args;
        },
        append: function () {
            this.target.appendShape(this);
            return this;
        }
    });

    VCanvas_base = createClass({
        _pxregex: /(\d+)(px)?\s*$/i,

        init: function (width, height, target) {
            if (!width) {
                return;
            }
            this.width = width;
            this.height = height;
            this.target = target;
            this.lastShapeId = null;
            if (target[0]) {
                target = target[0];
            }
            $.data(target, '_jqs_vcanvas', this);
        },

        drawLine: function (x1, y1, x2, y2, lineColor, lineWidth) {
            return this.drawShape([[x1, y1], [x2, y2]], lineColor, lineWidth);
        },

        drawShape: function (path, lineColor, fillColor, lineWidth) {
            return this._genShape('Shape', [path, lineColor, fillColor, lineWidth]);
        },

        drawCircle: function (x, y, radius, lineColor, fillColor, lineWidth) {
            return this._genShape('Circle', [x, y, radius, lineColor, fillColor, lineWidth]);
        },

        drawPieSlice: function (x, y, radius, startAngle, endAngle, lineColor, fillColor) {
            return this._genShape('PieSlice', [x, y, radius, startAngle, endAngle, lineColor, fillColor]);
        },

        drawRect: function (x, y, width, height, lineColor, fillColor) {
            return this._genShape('Rect', [x, y, width, height, lineColor, fillColor]);
        },

        getElement: function () {
            return this.canvas;
        },

        /**
         * Return the most recently inserted shape id
         */
        getLastShapeId: function () {
            return this.lastShapeId;
        },

        /**
         * Clear and reset the canvas
         */
        reset: function () {
            alert('reset not implemented');
        },

        _insert: function (el, target) {
            $(target).html(el);
        },

        /**
         * Calculate the pixel dimensions of the canvas
         */
        _calculatePixelDims: function (width, height, canvas) {
            // XXX This should probably be a configurable option
            var match;
            match = this._pxregex.exec(height);
            if (match) {
                this.pixelHeight = match[1];
            } else {
                this.pixelHeight = $(canvas).height();
            }
            match = this._pxregex.exec(width);
            if (match) {
                this.pixelWidth = match[1];
            } else {
                this.pixelWidth = $(canvas).width();
            }
        },

        /**
         * Generate a shape object and id for later rendering
         */
        _genShape: function (shapetype, shapeargs) {
            var id = shapeCount++;
            shapeargs.unshift(id);
            return new VShape(this, id, shapetype, shapeargs);
        },

        /**
         * Add a shape to the end of the render queue
         */
        appendShape: function (shape) {
            alert('appendShape not implemented');
        },

        /**
         * Replace one shape with another
         */
        replaceWithShape: function (shapeid, shape) {
            alert('replaceWithShape not implemented');
        },

        /**
         * Insert one shape after another in the render queue
         */
        insertAfterShape: function (shapeid, shape) {
            alert('insertAfterShape not implemented');
        },

        /**
         * Remove a shape from the queue
         */
        removeShapeId: function (shapeid) {
            alert('removeShapeId not implemented');
        },

        /**
         * Find a shape at the specified x/y co-ordinates
         */
        getShapeAt: function (el, x, y) {
            alert('getShapeAt not implemented');
        },

        /**
         * Render all queued shapes onto the canvas
         */
        render: function () {
            alert('render not implemented');
        }
    });

    VCanvas_canvas = createClass(VCanvas_base, {
        init: function (width, height, target, interact) {
            VCanvas_canvas._super.init.call(this, width, height, target);
            this.canvas = document.createElement('canvas');
            if (target[0]) {
                target = target[0];
            }
            $.data(target, '_jqs_vcanvas', this);
            $(this.canvas).css({ display: 'inline-block', width: width, height: height, verticalAlign: 'top' });
            this._insert(this.canvas, target);
            this._calculatePixelDims(width, height, this.canvas);
            this.canvas.width = this.pixelWidth;
            this.canvas.height = this.pixelHeight;
            this.interact = interact;
            this.shapes = {};
            this.shapeseq = [];
            this.currentTargetShapeId = undefined;
            $(this.canvas).css({width: this.pixelWidth, height: this.pixelHeight});
        },

        _getContext: function (lineColor, fillColor, lineWidth) {
            var context = this.canvas.getContext('2d');
            if (lineColor !== undefined) {
                context.strokeStyle = lineColor;
            }
            context.lineWidth = lineWidth === undefined ? 1 : lineWidth;
            if (fillColor !== undefined) {
                context.fillStyle = fillColor;
            }
            return context;
        },

        reset: function () {
            var context = this._getContext();
            context.clearRect(0, 0, this.pixelWidth, this.pixelHeight);
            this.shapes = {};
            this.shapeseq = [];
            this.currentTargetShapeId = undefined;
        },

        _drawShape: function (shapeid, path, lineColor, fillColor, lineWidth) {
            var context = this._getContext(lineColor, fillColor, lineWidth),
                i, plen;
            context.beginPath();
            context.moveTo(path[0][0] + 0.5, path[0][1] + 0.5);
            for (i = 1, plen = path.length; i < plen; i++) {
                context.lineTo(path[i][0] + 0.5, path[i][1] + 0.5); // the 0.5 offset gives us crisp pixel-width lines
            }
            if (lineColor !== undefined) {
                context.stroke();
            }
            if (fillColor !== undefined) {
                context.fill();
            }
            if (this.targetX !== undefined && this.targetY !== undefined &&
                context.isPointInPath(this.targetX, this.targetY)) {
                this.currentTargetShapeId = shapeid;
            }
        },

        _drawCircle: function (shapeid, x, y, radius, lineColor, fillColor, lineWidth) {
            var context = this._getContext(lineColor, fillColor, lineWidth);
            context.beginPath();
            context.arc(x, y, radius, 0, 2 * Math.PI, false);
            if (this.targetX !== undefined && this.targetY !== undefined &&
                context.isPointInPath(this.targetX, this.targetY)) {
                this.currentTargetShapeId = shapeid;
            }
            if (lineColor !== undefined) {
                context.stroke();
            }
            if (fillColor !== undefined) {
                context.fill();
            }
        },

        _drawPieSlice: function (shapeid, x, y, radius, startAngle, endAngle, lineColor, fillColor) {
            var context = this._getContext(lineColor, fillColor);
            context.beginPath();
            context.moveTo(x, y);
            context.arc(x, y, radius, startAngle, endAngle, false);
            context.lineTo(x, y);
            context.closePath();
            if (lineColor !== undefined) {
                context.stroke();
            }
            if (fillColor) {
                context.fill();
            }
            if (this.targetX !== undefined && this.targetY !== undefined &&
                context.isPointInPath(this.targetX, this.targetY)) {
                this.currentTargetShapeId = shapeid;
            }
        },

        _drawRect: function (shapeid, x, y, width, height, lineColor, fillColor) {
            return this._drawShape(shapeid, [[x, y], [x + width, y], [x + width, y + height], [x, y + height], [x, y]], lineColor, fillColor);
        },

        appendShape: function (shape) {
            this.shapes[shape.id] = shape;
            this.shapeseq.push(shape.id);
            this.lastShapeId = shape.id;
            return shape.id;
        },

        replaceWithShape: function (shapeid, shape) {
            var shapeseq = this.shapeseq,
                i;
            this.shapes[shape.id] = shape;
            for (i = shapeseq.length; i--;) {
                if (shapeseq[i] == shapeid) {
                    shapeseq[i] = shape.id;
                }
            }
            delete this.shapes[shapeid];
        },

        replaceWithShapes: function (shapeids, shapes) {
            var shapeseq = this.shapeseq,
                shapemap = {},
                sid, i, first;

            for (i = shapeids.length; i--;) {
                shapemap[shapeids[i]] = true;
            }
            for (i = shapeseq.length; i--;) {
                sid = shapeseq[i];
                if (shapemap[sid]) {
                    shapeseq.splice(i, 1);
                    delete this.shapes[sid];
                    first = i;
                }
            }
            for (i = shapes.length; i--;) {
                shapeseq.splice(first, 0, shapes[i].id);
                this.shapes[shapes[i].id] = shapes[i];
            }

        },

        insertAfterShape: function (shapeid, shape) {
            var shapeseq = this.shapeseq,
                i;
            for (i = shapeseq.length; i--;) {
                if (shapeseq[i] === shapeid) {
                    shapeseq.splice(i + 1, 0, shape.id);
                    this.shapes[shape.id] = shape;
                    return;
                }
            }
        },

        removeShapeId: function (shapeid) {
            var shapeseq = this.shapeseq,
                i;
            for (i = shapeseq.length; i--;) {
                if (shapeseq[i] === shapeid) {
                    shapeseq.splice(i, 1);
                    break;
                }
            }
            delete this.shapes[shapeid];
        },

        getShapeAt: function (el, x, y) {
            this.targetX = x;
            this.targetY = y;
            this.render();
            return this.currentTargetShapeId;
        },

        render: function () {
            var shapeseq = this.shapeseq,
                shapes = this.shapes,
                shapeCount = shapeseq.length,
                context = this._getContext(),
                shapeid, shape, i;
            context.clearRect(0, 0, this.pixelWidth, this.pixelHeight);
            for (i = 0; i < shapeCount; i++) {
                shapeid = shapeseq[i];
                shape = shapes[shapeid];
                this['_draw' + shape.type].apply(this, shape.args);
            }
            if (!this.interact) {
                // not interactive so no need to keep the shapes array
                this.shapes = {};
                this.shapeseq = [];
            }
        }

    });

    VCanvas_vml = createClass(VCanvas_base, {
        init: function (width, height, target) {
            var groupel;
            VCanvas_vml._super.init.call(this, width, height, target);
            if (target[0]) {
                target = target[0];
            }
            $.data(target, '_jqs_vcanvas', this);
            this.canvas = document.createElement('span');
            $(this.canvas).css({ display: 'inline-block', position: 'relative', overflow: 'hidden', width: width, height: height, margin: '0px', padding: '0px', verticalAlign: 'top'});
            this._insert(this.canvas, target);
            this._calculatePixelDims(width, height, this.canvas);
            this.canvas.width = this.pixelWidth;
            this.canvas.height = this.pixelHeight;
            groupel = '<v:group coordorigin="0 0" coordsize="' + this.pixelWidth + ' ' + this.pixelHeight + '"' +
                    ' style="position:absolute;top:0;left:0;width:' + this.pixelWidth + 'px;height=' + this.pixelHeight + 'px;"></v:group>';
            this.canvas.insertAdjacentHTML('beforeEnd', groupel);
            this.group = $(this.canvas).children()[0];
            this.rendered = false;
            this.prerender = '';
        },

        _drawShape: function (shapeid, path, lineColor, fillColor, lineWidth) {
            var vpath = [],
                initial, stroke, fill, closed, vel, plen, i;
            for (i = 0, plen = path.length; i < plen; i++) {
                vpath[i] = '' + (path[i][0]) + ',' + (path[i][1]);
            }
            initial = vpath.splice(0, 1);
            lineWidth = lineWidth === undefined ? 1 : lineWidth;
            stroke = lineColor === undefined ? ' stroked="false" ' : ' strokeWeight="' + lineWidth + 'px" strokeColor="' + lineColor + '" ';
            fill = fillColor === undefined ? ' filled="false"' : ' fillColor="' + fillColor + '" filled="true" ';
            closed = vpath[0] === vpath[vpath.length - 1] ? 'x ' : '';
            vel = '<v:shape coordorigin="0 0" coordsize="' + this.pixelWidth + ' ' + this.pixelHeight + '" ' +
                 ' id="jqsshape' + shapeid + '" ' +
                 stroke +
                 fill +
                ' style="position:absolute;left:0px;top:0px;height:' + this.pixelHeight + 'px;width:' + this.pixelWidth + 'px;padding:0px;margin:0px;" ' +
                ' path="m ' + initial + ' l ' + vpath.join(', ') + ' ' + closed + 'e">' +
                ' </v:shape>';
            return vel;
        },

        _drawCircle: function (shapeid, x, y, radius, lineColor, fillColor, lineWidth) {
            var stroke, fill, vel;
            x -= radius;
            y -= radius;
            stroke = lineColor === undefined ? ' stroked="false" ' : ' strokeWeight="' + lineWidth + 'px" strokeColor="' + lineColor + '" ';
            fill = fillColor === undefined ? ' filled="false"' : ' fillColor="' + fillColor + '" filled="true" ';
            vel = '<v:oval ' +
                 ' id="jqsshape' + shapeid + '" ' +
                stroke +
                fill +
                ' style="position:absolute;top:' + y + 'px; left:' + x + 'px; width:' + (radius * 2) + 'px; height:' + (radius * 2) + 'px"></v:oval>';
            return vel;

        },

        _drawPieSlice: function (shapeid, x, y, radius, startAngle, endAngle, lineColor, fillColor) {
            var vpath, startx, starty, endx, endy, stroke, fill, vel;
            if (startAngle === endAngle) {
                return '';  // VML seems to have problem when start angle equals end angle.
            }
            if ((endAngle - startAngle) === (2 * Math.PI)) {
                startAngle = 0.0;  // VML seems to have a problem when drawing a full circle that doesn't start 0
                endAngle = (2 * Math.PI);
            }

            startx = x + Math.round(Math.cos(startAngle) * radius);
            starty = y + Math.round(Math.sin(startAngle) * radius);
            endx = x + Math.round(Math.cos(endAngle) * radius);
            endy = y + Math.round(Math.sin(endAngle) * radius);

            if (startx === endx && starty === endy) {
                if ((endAngle - startAngle) < Math.PI) {
                    // Prevent very small slices from being mistaken as a whole pie
                    return '';
                }
                // essentially going to be the entire circle, so ignore startAngle
                startx = endx = x + radius;
                starty = endy = y;
            }

            if (startx === endx && starty === endy && (endAngle - startAngle) < Math.PI) {
                return '';
            }

            vpath = [x - radius, y - radius, x + radius, y + radius, startx, starty, endx, endy];
            stroke = lineColor === undefined ? ' stroked="false" ' : ' strokeWeight="1px" strokeColor="' + lineColor + '" ';
            fill = fillColor === undefined ? ' filled="false"' : ' fillColor="' + fillColor + '" filled="true" ';
            vel = '<v:shape coordorigin="0 0" coordsize="' + this.pixelWidth + ' ' + this.pixelHeight + '" ' +
                 ' id="jqsshape' + shapeid + '" ' +
                 stroke +
                 fill +
                ' style="position:absolute;left:0px;top:0px;height:' + this.pixelHeight + 'px;width:' + this.pixelWidth + 'px;padding:0px;margin:0px;" ' +
                ' path="m ' + x + ',' + y + ' wa ' + vpath.join(', ') + ' x e">' +
                ' </v:shape>';
            return vel;
        },

        _drawRect: function (shapeid, x, y, width, height, lineColor, fillColor) {
            return this._drawShape(shapeid, [[x, y], [x, y + height], [x + width, y + height], [x + width, y], [x, y]], lineColor, fillColor);
        },

        reset: function () {
            this.group.innerHTML = '';
        },

        appendShape: function (shape) {
            var vel = this['_draw' + shape.type].apply(this, shape.args);
            if (this.rendered) {
                this.group.insertAdjacentHTML('beforeEnd', vel);
            } else {
                this.prerender += vel;
            }
            this.lastShapeId = shape.id;
            return shape.id;
        },

        replaceWithShape: function (shapeid, shape) {
            var existing = $('#jqsshape' + shapeid),
                vel = this['_draw' + shape.type].apply(this, shape.args);
            existing[0].outerHTML = vel;
        },

        replaceWithShapes: function (shapeids, shapes) {
            // replace the first shapeid with all the new shapes then toast the remaining old shapes
            var existing = $('#jqsshape' + shapeids[0]),
                replace = '',
                slen = shapes.length,
                i;
            for (i = 0; i < slen; i++) {
                replace += this['_draw' + shapes[i].type].apply(this, shapes[i].args);
            }
            existing[0].outerHTML = replace;
            for (i = 1; i < shapeids.length; i++) {
                $('#jqsshape' + shapeids[i]).remove();
            }
        },

        insertAfterShape: function (shapeid, shape) {
            var existing = $('#jqsshape' + shapeid),
                 vel = this['_draw' + shape.type].apply(this, shape.args);
            existing[0].insertAdjacentHTML('afterEnd', vel);
        },

        removeShapeId: function (shapeid) {
            var existing = $('#jqsshape' + shapeid);
            this.group.removeChild(existing[0]);
        },

        getShapeAt: function (el, x, y) {
            var shapeid = el.id.substr(8);
            return shapeid;
        },

        render: function () {
            if (!this.rendered) {
                // batch the intial render into a single repaint
                this.group.innerHTML = this.prerender;
                this.rendered = true;
            }
        }
    });

}))}(document, Math));

},{}],4:[function(require,module,exports){
/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */

/*global define: false Mustache: true*/

(function defineMustache (global, factory) {
  if (typeof exports === 'object' && exports && typeof exports.nodeName !== 'string') {
    factory(exports); // CommonJS
  } else if (typeof define === 'function' && define.amd) {
    define(['exports'], factory); // AMD
  } else {
    global.Mustache = {};
    factory(global.Mustache); // script, wsh, asp
  }
}(this, function mustacheFactory (mustache) {

  var objectToString = Object.prototype.toString;
  var isArray = Array.isArray || function isArrayPolyfill (object) {
    return objectToString.call(object) === '[object Array]';
  };

  function isFunction (object) {
    return typeof object === 'function';
  }

  /**
   * More correct typeof string handling array
   * which normally returns typeof 'object'
   */
  function typeStr (obj) {
    return isArray(obj) ? 'array' : typeof obj;
  }

  function escapeRegExp (string) {
    return string.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g, '\\$&');
  }

  /**
   * Null safe way of checking whether or not an object,
   * including its prototype, has a given property
   */
  function hasProperty (obj, propName) {
    return obj != null && typeof obj === 'object' && (propName in obj);
  }

  // Workaround for https://issues.apache.org/jira/browse/COUCHDB-577
  // See https://github.com/janl/mustache.js/issues/189
  var regExpTest = RegExp.prototype.test;
  function testRegExp (re, string) {
    return regExpTest.call(re, string);
  }

  var nonSpaceRe = /\S/;
  function isWhitespace (string) {
    return !testRegExp(nonSpaceRe, string);
  }

  var entityMap = {
    '&': '&amp;',
    '<': '&lt;',
    '>': '&gt;',
    '"': '&quot;',
    "'": '&#39;',
    '/': '&#x2F;',
    '`': '&#x60;',
    '=': '&#x3D;'
  };

  function escapeHtml (string) {
    return String(string).replace(/[&<>"'`=\/]/g, function fromEntityMap (s) {
      return entityMap[s];
    });
  }

  var whiteRe = /\s*/;
  var spaceRe = /\s+/;
  var equalsRe = /\s*=/;
  var curlyRe = /\s*\}/;
  var tagRe = /#|\^|\/|>|\{|&|=|!/;

  /**
   * Breaks up the given `template` string into a tree of tokens. If the `tags`
   * argument is given here it must be an array with two string values: the
   * opening and closing tags used in the template (e.g. [ "<%", "%>" ]). Of
   * course, the default is to use mustaches (i.e. mustache.tags).
   *
   * A token is an array with at least 4 elements. The first element is the
   * mustache symbol that was used inside the tag, e.g. "#" or "&". If the tag
   * did not contain a symbol (i.e. {{myValue}}) this element is "name". For
   * all text that appears outside a symbol this element is "text".
   *
   * The second element of a token is its "value". For mustache tags this is
   * whatever else was inside the tag besides the opening symbol. For text tokens
   * this is the text itself.
   *
   * The third and fourth elements of the token are the start and end indices,
   * respectively, of the token in the original template.
   *
   * Tokens that are the root node of a subtree contain two more elements: 1) an
   * array of tokens in the subtree and 2) the index in the original template at
   * which the closing tag for that section begins.
   */
  function parseTemplate (template, tags) {
    if (!template)
      return [];

    var sections = [];     // Stack to hold section tokens
    var tokens = [];       // Buffer to hold the tokens
    var spaces = [];       // Indices of whitespace tokens on the current line
    var hasTag = false;    // Is there a {{tag}} on the current line?
    var nonSpace = false;  // Is there a non-space char on the current line?

    // Strips all whitespace tokens array for the current line
    // if there was a {{#tag}} on it and otherwise only space.
    function stripSpace () {
      if (hasTag && !nonSpace) {
        while (spaces.length)
          delete tokens[spaces.pop()];
      } else {
        spaces = [];
      }

      hasTag = false;
      nonSpace = false;
    }

    var openingTagRe, closingTagRe, closingCurlyRe;
    function compileTags (tagsToCompile) {
      if (typeof tagsToCompile === 'string')
        tagsToCompile = tagsToCompile.split(spaceRe, 2);

      if (!isArray(tagsToCompile) || tagsToCompile.length !== 2)
        throw new Error('Invalid tags: ' + tagsToCompile);

      openingTagRe = new RegExp(escapeRegExp(tagsToCompile[0]) + '\\s*');
      closingTagRe = new RegExp('\\s*' + escapeRegExp(tagsToCompile[1]));
      closingCurlyRe = new RegExp('\\s*' + escapeRegExp('}' + tagsToCompile[1]));
    }

    compileTags(tags || mustache.tags);

    var scanner = new Scanner(template);

    var start, type, value, chr, token, openSection;
    while (!scanner.eos()) {
      start = scanner.pos;

      // Match any text between tags.
      value = scanner.scanUntil(openingTagRe);

      if (value) {
        for (var i = 0, valueLength = value.length; i < valueLength; ++i) {
          chr = value.charAt(i);

          if (isWhitespace(chr)) {
            spaces.push(tokens.length);
          } else {
            nonSpace = true;
          }

          tokens.push([ 'text', chr, start, start + 1 ]);
          start += 1;

          // Check for whitespace on the current line.
          if (chr === '\n')
            stripSpace();
        }
      }

      // Match the opening tag.
      if (!scanner.scan(openingTagRe))
        break;

      hasTag = true;

      // Get the tag type.
      type = scanner.scan(tagRe) || 'name';
      scanner.scan(whiteRe);

      // Get the tag value.
      if (type === '=') {
        value = scanner.scanUntil(equalsRe);
        scanner.scan(equalsRe);
        scanner.scanUntil(closingTagRe);
      } else if (type === '{') {
        value = scanner.scanUntil(closingCurlyRe);
        scanner.scan(curlyRe);
        scanner.scanUntil(closingTagRe);
        type = '&';
      } else {
        value = scanner.scanUntil(closingTagRe);
      }

      // Match the closing tag.
      if (!scanner.scan(closingTagRe))
        throw new Error('Unclosed tag at ' + scanner.pos);

      token = [ type, value, start, scanner.pos ];
      tokens.push(token);

      if (type === '#' || type === '^') {
        sections.push(token);
      } else if (type === '/') {
        // Check section nesting.
        openSection = sections.pop();

        if (!openSection)
          throw new Error('Unopened section "' + value + '" at ' + start);

        if (openSection[1] !== value)
          throw new Error('Unclosed section "' + openSection[1] + '" at ' + start);
      } else if (type === 'name' || type === '{' || type === '&') {
        nonSpace = true;
      } else if (type === '=') {
        // Set the tags for the next time around.
        compileTags(value);
      }
    }

    // Make sure there are no open sections when we're done.
    openSection = sections.pop();

    if (openSection)
      throw new Error('Unclosed section "' + openSection[1] + '" at ' + scanner.pos);

    return nestTokens(squashTokens(tokens));
  }

  /**
   * Combines the values of consecutive text tokens in the given `tokens` array
   * to a single token.
   */
  function squashTokens (tokens) {
    var squashedTokens = [];

    var token, lastToken;
    for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {
      token = tokens[i];

      if (token) {
        if (token[0] === 'text' && lastToken && lastToken[0] === 'text') {
          lastToken[1] += token[1];
          lastToken[3] = token[3];
        } else {
          squashedTokens.push(token);
          lastToken = token;
        }
      }
    }

    return squashedTokens;
  }

  /**
   * Forms the given array of `tokens` into a nested tree structure where
   * tokens that represent a section have two additional items: 1) an array of
   * all tokens that appear in that section and 2) the index in the original
   * template that represents the end of that section.
   */
  function nestTokens (tokens) {
    var nestedTokens = [];
    var collector = nestedTokens;
    var sections = [];

    var token, section;
    for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {
      token = tokens[i];

      switch (token[0]) {
        case '#':
        case '^':
          collector.push(token);
          sections.push(token);
          collector = token[4] = [];
          break;
        case '/':
          section = sections.pop();
          section[5] = token[2];
          collector = sections.length > 0 ? sections[sections.length - 1][4] : nestedTokens;
          break;
        default:
          collector.push(token);
      }
    }

    return nestedTokens;
  }

  /**
   * A simple string scanner that is used by the template parser to find
   * tokens in template strings.
   */
  function Scanner (string) {
    this.string = string;
    this.tail = string;
    this.pos = 0;
  }

  /**
   * Returns `true` if the tail is empty (end of string).
   */
  Scanner.prototype.eos = function eos () {
    return this.tail === '';
  };

  /**
   * Tries to match the given regular expression at the current position.
   * Returns the matched text if it can match, the empty string otherwise.
   */
  Scanner.prototype.scan = function scan (re) {
    var match = this.tail.match(re);

    if (!match || match.index !== 0)
      return '';

    var string = match[0];

    this.tail = this.tail.substring(string.length);
    this.pos += string.length;

    return string;
  };

  /**
   * Skips all text until the given regular expression can be matched. Returns
   * the skipped string, which is the entire tail if no match can be made.
   */
  Scanner.prototype.scanUntil = function scanUntil (re) {
    var index = this.tail.search(re), match;

    switch (index) {
      case -1:
        match = this.tail;
        this.tail = '';
        break;
      case 0:
        match = '';
        break;
      default:
        match = this.tail.substring(0, index);
        this.tail = this.tail.substring(index);
    }

    this.pos += match.length;

    return match;
  };

  /**
   * Represents a rendering context by wrapping a view object and
   * maintaining a reference to the parent context.
   */
  function Context (view, parentContext) {
    this.view = view;
    this.cache = { '.': this.view };
    this.parent = parentContext;
  }

  /**
   * Creates a new context using the given view with this context
   * as the parent.
   */
  Context.prototype.push = function push (view) {
    return new Context(view, this);
  };

  /**
   * Returns the value of the given name in this context, traversing
   * up the context hierarchy if the value is absent in this context's view.
   */
  Context.prototype.lookup = function lookup (name) {
    var cache = this.cache;

    var value;
    if (cache.hasOwnProperty(name)) {
      value = cache[name];
    } else {
      var context = this, names, index, lookupHit = false;

      while (context) {
        if (name.indexOf('.') > 0) {
          value = context.view;
          names = name.split('.');
          index = 0;

          /**
           * Using the dot notion path in `name`, we descend through the
           * nested objects.
           *
           * To be certain that the lookup has been successful, we have to
           * check if the last object in the path actually has the property
           * we are looking for. We store the result in `lookupHit`.
           *
           * This is specially necessary for when the value has been set to
           * `undefined` and we want to avoid looking up parent contexts.
           **/
          while (value != null && index < names.length) {
            if (index === names.length - 1)
              lookupHit = hasProperty(value, names[index]);

            value = value[names[index++]];
          }
        } else {
          value = context.view[name];
          lookupHit = hasProperty(context.view, name);
        }

        if (lookupHit)
          break;

        context = context.parent;
      }

      cache[name] = value;
    }

    if (isFunction(value))
      value = value.call(this.view);

    return value;
  };

  /**
   * A Writer knows how to take a stream of tokens and render them to a
   * string, given a context. It also maintains a cache of templates to
   * avoid the need to parse the same template twice.
   */
  function Writer () {
    this.cache = {};
  }

  /**
   * Clears all cached templates in this writer.
   */
  Writer.prototype.clearCache = function clearCache () {
    this.cache = {};
  };

  /**
   * Parses and caches the given `template` and returns the array of tokens
   * that is generated from the parse.
   */
  Writer.prototype.parse = function parse (template, tags) {
    var cache = this.cache;
    var tokens = cache[template];

    if (tokens == null)
      tokens = cache[template] = parseTemplate(template, tags);

    return tokens;
  };

  /**
   * High-level method that is used to render the given `template` with
   * the given `view`.
   *
   * The optional `partials` argument may be an object that contains the
   * names and templates of partials that are used in the template. It may
   * also be a function that is used to load partial templates on the fly
   * that takes a single argument: the name of the partial.
   */
  Writer.prototype.render = function render (template, view, partials) {
    var tokens = this.parse(template);
    var context = (view instanceof Context) ? view : new Context(view);
    return this.renderTokens(tokens, context, partials, template);
  };

  /**
   * Low-level method that renders the given array of `tokens` using
   * the given `context` and `partials`.
   *
   * Note: The `originalTemplate` is only ever used to extract the portion
   * of the original template that was contained in a higher-order section.
   * If the template doesn't use higher-order sections, this argument may
   * be omitted.
   */
  Writer.prototype.renderTokens = function renderTokens (tokens, context, partials, originalTemplate) {
    var buffer = '';

    var token, symbol, value;
    for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {
      value = undefined;
      token = tokens[i];
      symbol = token[0];

      if (symbol === '#') value = this.renderSection(token, context, partials, originalTemplate);
      else if (symbol === '^') value = this.renderInverted(token, context, partials, originalTemplate);
      else if (symbol === '>') value = this.renderPartial(token, context, partials, originalTemplate);
      else if (symbol === '&') value = this.unescapedValue(token, context);
      else if (symbol === 'name') value = this.escapedValue(token, context);
      else if (symbol === 'text') value = this.rawValue(token);

      if (value !== undefined)
        buffer += value;
    }

    return buffer;
  };

  Writer.prototype.renderSection = function renderSection (token, context, partials, originalTemplate) {
    var self = this;
    var buffer = '';
    var value = context.lookup(token[1]);

    // This function is used to render an arbitrary template
    // in the current context by higher-order sections.
    function subRender (template) {
      return self.render(template, context, partials);
    }

    if (!value) return;

    if (isArray(value)) {
      for (var j = 0, valueLength = value.length; j < valueLength; ++j) {
        buffer += this.renderTokens(token[4], context.push(value[j]), partials, originalTemplate);
      }
    } else if (typeof value === 'object' || typeof value === 'string' || typeof value === 'number') {
      buffer += this.renderTokens(token[4], context.push(value), partials, originalTemplate);
    } else if (isFunction(value)) {
      if (typeof originalTemplate !== 'string')
        throw new Error('Cannot use higher-order sections without the original template');

      // Extract the portion of the original template that the section contains.
      value = value.call(context.view, originalTemplate.slice(token[3], token[5]), subRender);

      if (value != null)
        buffer += value;
    } else {
      buffer += this.renderTokens(token[4], context, partials, originalTemplate);
    }
    return buffer;
  };

  Writer.prototype.renderInverted = function renderInverted (token, context, partials, originalTemplate) {
    var value = context.lookup(token[1]);

    // Use JavaScript's definition of falsy. Include empty arrays.
    // See https://github.com/janl/mustache.js/issues/186
    if (!value || (isArray(value) && value.length === 0))
      return this.renderTokens(token[4], context, partials, originalTemplate);
  };

  Writer.prototype.renderPartial = function renderPartial (token, context, partials) {
    if (!partials) return;

    var value = isFunction(partials) ? partials(token[1]) : partials[token[1]];
    if (value != null)
      return this.renderTokens(this.parse(value), context, partials, value);
  };

  Writer.prototype.unescapedValue = function unescapedValue (token, context) {
    var value = context.lookup(token[1]);
    if (value != null)
      return value;
  };

  Writer.prototype.escapedValue = function escapedValue (token, context) {
    var value = context.lookup(token[1]);
    if (value != null)
      return mustache.escape(value);
  };

  Writer.prototype.rawValue = function rawValue (token) {
    return token[1];
  };

  mustache.name = 'mustache.js';
  mustache.version = '2.2.1';
  mustache.tags = [ '{{', '}}' ];

  // All high-level mustache.* functions use this writer.
  var defaultWriter = new Writer();

  /**
   * Clears all cached templates in the default writer.
   */
  mustache.clearCache = function clearCache () {
    return defaultWriter.clearCache();
  };

  /**
   * Parses and caches the given template in the default writer and returns the
   * array of tokens it contains. Doing this ahead of time avoids the need to
   * parse templates on the fly as they are rendered.
   */
  mustache.parse = function parse (template, tags) {
    return defaultWriter.parse(template, tags);
  };

  /**
   * Renders the `template` with the given `view` and `partials` using the
   * default writer.
   */
  mustache.render = function render (template, view, partials) {
    if (typeof template !== 'string') {
      throw new TypeError('Invalid template! Template should be a "string" ' +
                          'but "' + typeStr(template) + '" was given as the first ' +
                          'argument for mustache#render(template, view, partials)');
    }

    return defaultWriter.render(template, view, partials);
  };

  // This is here for backwards compatibility with 0.4.x.,
  /*eslint-disable */ // eslint wants camel cased function name
  mustache.to_html = function to_html (template, view, partials, send) {
    /*eslint-enable*/

    var result = mustache.render(template, view, partials);

    if (isFunction(send)) {
      send(result);
    } else {
      return result;
    }
  };

  // Export the escaping function so that the user may override it.
  // See https://github.com/janl/mustache.js/issues/244
  mustache.escape = escapeHtml;

  // Export these mainly for testing, but also for advanced usage.
  mustache.Scanner = Scanner;
  mustache.Context = Context;
  mustache.Writer = Writer;

}));

},{}],5:[function(require,module,exports){
/*!
 * ZeroClipboard
 * The ZeroClipboard library provides an easy way to copy text to the clipboard using an invisible Adobe Flash movie and a JavaScript interface.
 * Copyright (c) 2009-2014 Jon Rohan, James M. Greene
 * Licensed MIT
 * http://zeroclipboard.org/
 * v2.2.0
 */
(function(window, undefined) {
  "use strict";
  /**
 * Store references to critically important global functions that may be
 * overridden on certain web pages.
 */
  var _window = window, _document = _window.document, _navigator = _window.navigator, _setTimeout = _window.setTimeout, _clearTimeout = _window.clearTimeout, _setInterval = _window.setInterval, _clearInterval = _window.clearInterval, _getComputedStyle = _window.getComputedStyle, _encodeURIComponent = _window.encodeURIComponent, _ActiveXObject = _window.ActiveXObject, _Error = _window.Error, _parseInt = _window.Number.parseInt || _window.parseInt, _parseFloat = _window.Number.parseFloat || _window.parseFloat, _isNaN = _window.Number.isNaN || _window.isNaN, _now = _window.Date.now, _keys = _window.Object.keys, _defineProperty = _window.Object.defineProperty, _hasOwn = _window.Object.prototype.hasOwnProperty, _slice = _window.Array.prototype.slice, _unwrap = function() {
    var unwrapper = function(el) {
      return el;
    };
    if (typeof _window.wrap === "function" && typeof _window.unwrap === "function") {
      try {
        var div = _document.createElement("div");
        var unwrappedDiv = _window.unwrap(div);
        if (div.nodeType === 1 && unwrappedDiv && unwrappedDiv.nodeType === 1) {
          unwrapper = _window.unwrap;
        }
      } catch (e) {}
    }
    return unwrapper;
  }();
  /**
 * Convert an `arguments` object into an Array.
 *
 * @returns The arguments as an Array
 * @private
 */
  var _args = function(argumentsObj) {
    return _slice.call(argumentsObj, 0);
  };
  /**
 * Shallow-copy the owned, enumerable properties of one object over to another, similar to jQuery's `$.extend`.
 *
 * @returns The target object, augmented
 * @private
 */
  var _extend = function() {
    var i, len, arg, prop, src, copy, args = _args(arguments), target = args[0] || {};
    for (i = 1, len = args.length; i < len; i++) {
      if ((arg = args[i]) != null) {
        for (prop in arg) {
          if (_hasOwn.call(arg, prop)) {
            src = target[prop];
            copy = arg[prop];
            if (target !== copy && copy !== undefined) {
              target[prop] = copy;
            }
          }
        }
      }
    }
    return target;
  };
  /**
 * Return a deep copy of the source object or array.
 *
 * @returns Object or Array
 * @private
 */
  var _deepCopy = function(source) {
    var copy, i, len, prop;
    if (typeof source !== "object" || source == null || typeof source.nodeType === "number") {
      copy = source;
    } else if (typeof source.length === "number") {
      copy = [];
      for (i = 0, len = source.length; i < len; i++) {
        if (_hasOwn.call(source, i)) {
          copy[i] = _deepCopy(source[i]);
        }
      }
    } else {
      copy = {};
      for (prop in source) {
        if (_hasOwn.call(source, prop)) {
          copy[prop] = _deepCopy(source[prop]);
        }
      }
    }
    return copy;
  };
  /**
 * Makes a shallow copy of `obj` (like `_extend`) but filters its properties based on a list of `keys` to keep.
 * The inverse of `_omit`, mostly. The big difference is that these properties do NOT need to be enumerable to
 * be kept.
 *
 * @returns A new filtered object.
 * @private
 */
  var _pick = function(obj, keys) {
    var newObj = {};
    for (var i = 0, len = keys.length; i < len; i++) {
      if (keys[i] in obj) {
        newObj[keys[i]] = obj[keys[i]];
      }
    }
    return newObj;
  };
  /**
 * Makes a shallow copy of `obj` (like `_extend`) but filters its properties based on a list of `keys` to omit.
 * The inverse of `_pick`.
 *
 * @returns A new filtered object.
 * @private
 */
  var _omit = function(obj, keys) {
    var newObj = {};
    for (var prop in obj) {
      if (keys.indexOf(prop) === -1) {
        newObj[prop] = obj[prop];
      }
    }
    return newObj;
  };
  /**
 * Remove all owned, enumerable properties from an object.
 *
 * @returns The original object without its owned, enumerable properties.
 * @private
 */
  var _deleteOwnProperties = function(obj) {
    if (obj) {
      for (var prop in obj) {
        if (_hasOwn.call(obj, prop)) {
          delete obj[prop];
        }
      }
    }
    return obj;
  };
  /**
 * Determine if an element is contained within another element.
 *
 * @returns Boolean
 * @private
 */
  var _containedBy = function(el, ancestorEl) {
    if (el && el.nodeType === 1 && el.ownerDocument && ancestorEl && (ancestorEl.nodeType === 1 && ancestorEl.ownerDocument && ancestorEl.ownerDocument === el.ownerDocument || ancestorEl.nodeType === 9 && !ancestorEl.ownerDocument && ancestorEl === el.ownerDocument)) {
      do {
        if (el === ancestorEl) {
          return true;
        }
        el = el.parentNode;
      } while (el);
    }
    return false;
  };
  /**
 * Get the URL path's parent directory.
 *
 * @returns String or `undefined`
 * @private
 */
  var _getDirPathOfUrl = function(url) {
    var dir;
    if (typeof url === "string" && url) {
      dir = url.split("#")[0].split("?")[0];
      dir = url.slice(0, url.lastIndexOf("/") + 1);
    }
    return dir;
  };
  /**
 * Get the current script's URL by throwing an `Error` and analyzing it.
 *
 * @returns String or `undefined`
 * @private
 */
  var _getCurrentScriptUrlFromErrorStack = function(stack) {
    var url, matches;
    if (typeof stack === "string" && stack) {
      matches = stack.match(/^(?:|[^:@]*@|.+\)@(?=http[s]?|file)|.+?\s+(?: at |@)(?:[^:\(]+ )*[\(]?)((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/);
      if (matches && matches[1]) {
        url = matches[1];
      } else {
        matches = stack.match(/\)@((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/);
        if (matches && matches[1]) {
          url = matches[1];
        }
      }
    }
    return url;
  };
  /**
 * Get the current script's URL by throwing an `Error` and analyzing it.
 *
 * @returns String or `undefined`
 * @private
 */
  var _getCurrentScriptUrlFromError = function() {
    var url, err;
    try {
      throw new _Error();
    } catch (e) {
      err = e;
    }
    if (err) {
      url = err.sourceURL || err.fileName || _getCurrentScriptUrlFromErrorStack(err.stack);
    }
    return url;
  };
  /**
 * Get the current script's URL.
 *
 * @returns String or `undefined`
 * @private
 */
  var _getCurrentScriptUrl = function() {
    var jsPath, scripts, i;
    if (_document.currentScript && (jsPath = _document.currentScript.src)) {
      return jsPath;
    }
    scripts = _document.getElementsByTagName("script");
    if (scripts.length === 1) {
      return scripts[0].src || undefined;
    }
    if ("readyState" in scripts[0]) {
      for (i = scripts.length; i--; ) {
        if (scripts[i].readyState === "interactive" && (jsPath = scripts[i].src)) {
          return jsPath;
        }
      }
    }
    if (_document.readyState === "loading" && (jsPath = scripts[scripts.length - 1].src)) {
      return jsPath;
    }
    if (jsPath = _getCurrentScriptUrlFromError()) {
      return jsPath;
    }
    return undefined;
  };
  /**
 * Get the unanimous parent directory of ALL script tags.
 * If any script tags are either (a) inline or (b) from differing parent
 * directories, this method must return `undefined`.
 *
 * @returns String or `undefined`
 * @private
 */
  var _getUnanimousScriptParentDir = function() {
    var i, jsDir, jsPath, scripts = _document.getElementsByTagName("script");
    for (i = scripts.length; i--; ) {
      if (!(jsPath = scripts[i].src)) {
        jsDir = null;
        break;
      }
      jsPath = _getDirPathOfUrl(jsPath);
      if (jsDir == null) {
        jsDir = jsPath;
      } else if (jsDir !== jsPath) {
        jsDir = null;
        break;
      }
    }
    return jsDir || undefined;
  };
  /**
 * Get the presumed location of the "ZeroClipboard.swf" file, based on the location
 * of the executing JavaScript file (e.g. "ZeroClipboard.js", etc.).
 *
 * @returns String
 * @private
 */
  var _getDefaultSwfPath = function() {
    var jsDir = _getDirPathOfUrl(_getCurrentScriptUrl()) || _getUnanimousScriptParentDir() || "";
    return jsDir + "ZeroClipboard.swf";
  };
  /**
 * Keep track of if the page is framed (in an `iframe`). This can never change.
 * @private
 */
  var _pageIsFramed = function() {
    return window.opener == null && (!!window.top && window != window.top || !!window.parent && window != window.parent);
  }();
  /**
 * Keep track of the state of the Flash object.
 * @private
 */
  var _flashState = {
    bridge: null,
    version: "0.0.0",
    pluginType: "unknown",
    disabled: null,
    outdated: null,
    sandboxed: null,
    unavailable: null,
    degraded: null,
    deactivated: null,
    overdue: null,
    ready: null
  };
  /**
 * The minimum Flash Player version required to use ZeroClipboard completely.
 * @readonly
 * @private
 */
  var _minimumFlashVersion = "11.0.0";
  /**
 * The ZeroClipboard library version number, as reported by Flash, at the time the SWF was compiled.
 */
  var _zcSwfVersion;
  /**
 * Keep track of all event listener registrations.
 * @private
 */
  var _handlers = {};
  /**
 * Keep track of the currently activated element.
 * @private
 */
  var _currentElement;
  /**
 * Keep track of the element that was activated when a `copy` process started.
 * @private
 */
  var _copyTarget;
  /**
 * Keep track of data for the pending clipboard transaction.
 * @private
 */
  var _clipData = {};
  /**
 * Keep track of data formats for the pending clipboard transaction.
 * @private
 */
  var _clipDataFormatMap = null;
  /**
 * Keep track of the Flash availability check timeout.
 * @private
 */
  var _flashCheckTimeout = 0;
  /**
 * Keep track of SWF network errors interval polling.
 * @private
 */
  var _swfFallbackCheckInterval = 0;
  /**
 * The `message` store for events
 * @private
 */
  var _eventMessages = {
    ready: "Flash communication is established",
    error: {
      "flash-disabled": "Flash is disabled or not installed. May also be attempting to run Flash in a sandboxed iframe, which is impossible.",
      "flash-outdated": "Flash is too outdated to support ZeroClipboard",
      "flash-sandboxed": "Attempting to run Flash in a sandboxed iframe, which is impossible",
      "flash-unavailable": "Flash is unable to communicate bidirectionally with JavaScript",
      "flash-degraded": "Flash is unable to preserve data fidelity when communicating with JavaScript",
      "flash-deactivated": "Flash is too outdated for your browser and/or is configured as click-to-activate.\nThis may also mean that the ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity.\nMay also be attempting to run Flash in a sandboxed iframe, which is impossible.",
      "flash-overdue": "Flash communication was established but NOT within the acceptable time limit",
      "version-mismatch": "ZeroClipboard JS version number does not match ZeroClipboard SWF version number",
      "clipboard-error": "At least one error was thrown while ZeroClipboard was attempting to inject your data into the clipboard",
      "config-mismatch": "ZeroClipboard configuration does not match Flash's reality",
      "swf-not-found": "The ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity"
    }
  };
  /**
 * The `name`s of `error` events that can only occur is Flash has at least
 * been able to load the SWF successfully.
 * @private
 */
  var _errorsThatOnlyOccurAfterFlashLoads = [ "flash-unavailable", "flash-degraded", "flash-overdue", "version-mismatch", "config-mismatch", "clipboard-error" ];
  /**
 * The `name`s of `error` events that should likely result in the `_flashState`
 * variable's property values being updated.
 * @private
 */
  var _flashStateErrorNames = [ "flash-disabled", "flash-outdated", "flash-sandboxed", "flash-unavailable", "flash-degraded", "flash-deactivated", "flash-overdue" ];
  /**
 * A RegExp to match the `name` property of `error` events related to Flash.
 * @private
 */
  var _flashStateErrorNameMatchingRegex = new RegExp("^flash-(" + _flashStateErrorNames.map(function(errorName) {
    return errorName.replace(/^flash-/, "");
  }).join("|") + ")$");
  /**
 * A RegExp to match the `name` property of `error` events related to Flash,
 * which is enabled.
 * @private
 */
  var _flashStateEnabledErrorNameMatchingRegex = new RegExp("^flash-(" + _flashStateErrorNames.slice(1).map(function(errorName) {
    return errorName.replace(/^flash-/, "");
  }).join("|") + ")$");
  /**
 * ZeroClipboard configuration defaults for the Core module.
 * @private
 */
  var _globalConfig = {
    swfPath: _getDefaultSwfPath(),
    trustedDomains: window.location.host ? [ window.location.host ] : [],
    cacheBust: true,
    forceEnhancedClipboard: false,
    flashLoadTimeout: 3e4,
    autoActivate: true,
    bubbleEvents: true,
    containerId: "global-zeroclipboard-html-bridge",
    containerClass: "global-zeroclipboard-container",
    swfObjectId: "global-zeroclipboard-flash-bridge",
    hoverClass: "zeroclipboard-is-hover",
    activeClass: "zeroclipboard-is-active",
    forceHandCursor: false,
    title: null,
    zIndex: 999999999
  };
  /**
 * The underlying implementation of `ZeroClipboard.config`.
 * @private
 */
  var _config = function(options) {
    if (typeof options === "object" && options !== null) {
      for (var prop in options) {
        if (_hasOwn.call(options, prop)) {
          if (/^(?:forceHandCursor|title|zIndex|bubbleEvents)$/.test(prop)) {
            _globalConfig[prop] = options[prop];
          } else if (_flashState.bridge == null) {
            if (prop === "containerId" || prop === "swfObjectId") {
              if (_isValidHtml4Id(options[prop])) {
                _globalConfig[prop] = options[prop];
              } else {
                throw new Error("The specified `" + prop + "` value is not valid as an HTML4 Element ID");
              }
            } else {
              _globalConfig[prop] = options[prop];
            }
          }
        }
      }
    }
    if (typeof options === "string" && options) {
      if (_hasOwn.call(_globalConfig, options)) {
        return _globalConfig[options];
      }
      return;
    }
    return _deepCopy(_globalConfig);
  };
  /**
 * The underlying implementation of `ZeroClipboard.state`.
 * @private
 */
  var _state = function() {
    _detectSandbox();
    return {
      browser: _pick(_navigator, [ "userAgent", "platform", "appName" ]),
      flash: _omit(_flashState, [ "bridge" ]),
      zeroclipboard: {
        version: ZeroClipboard.version,
        config: ZeroClipboard.config()
      }
    };
  };
  /**
 * The underlying implementation of `ZeroClipboard.isFlashUnusable`.
 * @private
 */
  var _isFlashUnusable = function() {
    return !!(_flashState.disabled || _flashState.outdated || _flashState.sandboxed || _flashState.unavailable || _flashState.degraded || _flashState.deactivated);
  };
  /**
 * The underlying implementation of `ZeroClipboard.on`.
 * @private
 */
  var _on = function(eventType, listener) {
    var i, len, events, added = {};
    if (typeof eventType === "string" && eventType) {
      events = eventType.toLowerCase().split(/\s+/);
    } else if (typeof eventType === "object" && eventType && typeof listener === "undefined") {
      for (i in eventType) {
        if (_hasOwn.call(eventType, i) && typeof i === "string" && i && typeof eventType[i] === "function") {
          ZeroClipboard.on(i, eventType[i]);
        }
      }
    }
    if (events && events.length) {
      for (i = 0, len = events.length; i < len; i++) {
        eventType = events[i].replace(/^on/, "");
        added[eventType] = true;
        if (!_handlers[eventType]) {
          _handlers[eventType] = [];
        }
        _handlers[eventType].push(listener);
      }
      if (added.ready && _flashState.ready) {
        ZeroClipboard.emit({
          type: "ready"
        });
      }
      if (added.error) {
        for (i = 0, len = _flashStateErrorNames.length; i < len; i++) {
          if (_flashState[_flashStateErrorNames[i].replace(/^flash-/, "")] === true) {
            ZeroClipboard.emit({
              type: "error",
              name: _flashStateErrorNames[i]
            });
            break;
          }
        }
        if (_zcSwfVersion !== undefined && ZeroClipboard.version !== _zcSwfVersion) {
          ZeroClipboard.emit({
            type: "error",
            name: "version-mismatch",
            jsVersion: ZeroClipboard.version,
            swfVersion: _zcSwfVersion
          });
        }
      }
    }
    return ZeroClipboard;
  };
  /**
 * The underlying implementation of `ZeroClipboard.off`.
 * @private
 */
  var _off = function(eventType, listener) {
    var i, len, foundIndex, events, perEventHandlers;
    if (arguments.length === 0) {
      events = _keys(_handlers);
    } else if (typeof eventType === "string" && eventType) {
      events = eventType.split(/\s+/);
    } else if (typeof eventType === "object" && eventType && typeof listener === "undefined") {
      for (i in eventType) {
        if (_hasOwn.call(eventType, i) && typeof i === "string" && i && typeof eventType[i] === "function") {
          ZeroClipboard.off(i, eventType[i]);
        }
      }
    }
    if (events && events.length) {
      for (i = 0, len = events.length; i < len; i++) {
        eventType = events[i].toLowerCase().replace(/^on/, "");
        perEventHandlers = _handlers[eventType];
        if (perEventHandlers && perEventHandlers.length) {
          if (listener) {
            foundIndex = perEventHandlers.indexOf(listener);
            while (foundIndex !== -1) {
              perEventHandlers.splice(foundIndex, 1);
              foundIndex = perEventHandlers.indexOf(listener, foundIndex);
            }
          } else {
            perEventHandlers.length = 0;
          }
        }
      }
    }
    return ZeroClipboard;
  };
  /**
 * The underlying implementation of `ZeroClipboard.handlers`.
 * @private
 */
  var _listeners = function(eventType) {
    var copy;
    if (typeof eventType === "string" && eventType) {
      copy = _deepCopy(_handlers[eventType]) || null;
    } else {
      copy = _deepCopy(_handlers);
    }
    return copy;
  };
  /**
 * The underlying implementation of `ZeroClipboard.emit`.
 * @private
 */
  var _emit = function(event) {
    var eventCopy, returnVal, tmp;
    event = _createEvent(event);
    if (!event) {
      return;
    }
    if (_preprocessEvent(event)) {
      return;
    }
    if (event.type === "ready" && _flashState.overdue === true) {
      return ZeroClipboard.emit({
        type: "error",
        name: "flash-overdue"
      });
    }
    eventCopy = _extend({}, event);
    _dispatchCallbacks.call(this, eventCopy);
    if (event.type === "copy") {
      tmp = _mapClipDataToFlash(_clipData);
      returnVal = tmp.data;
      _clipDataFormatMap = tmp.formatMap;
    }
    return returnVal;
  };
  /**
 * The underlying implementation of `ZeroClipboard.create`.
 * @private
 */
  var _create = function() {
    var previousState = _flashState.sandboxed;
    _detectSandbox();
    if (typeof _flashState.ready !== "boolean") {
      _flashState.ready = false;
    }
    if (_flashState.sandboxed !== previousState && _flashState.sandboxed === true) {
      _flashState.ready = false;
      ZeroClipboard.emit({
        type: "error",
        name: "flash-sandboxed"
      });
    } else if (!ZeroClipboard.isFlashUnusable() && _flashState.bridge === null) {
      var maxWait = _globalConfig.flashLoadTimeout;
      if (typeof maxWait === "number" && maxWait >= 0) {
        _flashCheckTimeout = _setTimeout(function() {
          if (typeof _flashState.deactivated !== "boolean") {
            _flashState.deactivated = true;
          }
          if (_flashState.deactivated === true) {
            ZeroClipboard.emit({
              type: "error",
              name: "flash-deactivated"
            });
          }
        }, maxWait);
      }
      _flashState.overdue = false;
      _embedSwf();
    }
  };
  /**
 * The underlying implementation of `ZeroClipboard.destroy`.
 * @private
 */
  var _destroy = function() {
    ZeroClipboard.clearData();
    ZeroClipboard.blur();
    ZeroClipboard.emit("destroy");
    _unembedSwf();
    ZeroClipboard.off();
  };
  /**
 * The underlying implementation of `ZeroClipboard.setData`.
 * @private
 */
  var _setData = function(format, data) {
    var dataObj;
    if (typeof format === "object" && format && typeof data === "undefined") {
      dataObj = format;
      ZeroClipboard.clearData();
    } else if (typeof format === "string" && format) {
      dataObj = {};
      dataObj[format] = data;
    } else {
      return;
    }
    for (var dataFormat in dataObj) {
      if (typeof dataFormat === "string" && dataFormat && _hasOwn.call(dataObj, dataFormat) && typeof dataObj[dataFormat] === "string" && dataObj[dataFormat]) {
        _clipData[dataFormat] = dataObj[dataFormat];
      }
    }
  };
  /**
 * The underlying implementation of `ZeroClipboard.clearData`.
 * @private
 */
  var _clearData = function(format) {
    if (typeof format === "undefined") {
      _deleteOwnProperties(_clipData);
      _clipDataFormatMap = null;
    } else if (typeof format === "string" && _hasOwn.call(_clipData, format)) {
      delete _clipData[format];
    }
  };
  /**
 * The underlying implementation of `ZeroClipboard.getData`.
 * @private
 */
  var _getData = function(format) {
    if (typeof format === "undefined") {
      return _deepCopy(_clipData);
    } else if (typeof format === "string" && _hasOwn.call(_clipData, format)) {
      return _clipData[format];
    }
  };
  /**
 * The underlying implementation of `ZeroClipboard.focus`/`ZeroClipboard.activate`.
 * @private
 */
  var _focus = function(element) {
    if (!(element && element.nodeType === 1)) {
      return;
    }
    if (_currentElement) {
      _removeClass(_currentElement, _globalConfig.activeClass);
      if (_currentElement !== element) {
        _removeClass(_currentElement, _globalConfig.hoverClass);
      }
    }
    _currentElement = element;
    _addClass(element, _globalConfig.hoverClass);
    var newTitle = element.getAttribute("title") || _globalConfig.title;
    if (typeof newTitle === "string" && newTitle) {
      var htmlBridge = _getHtmlBridge(_flashState.bridge);
      if (htmlBridge) {
        htmlBridge.setAttribute("title", newTitle);
      }
    }
    var useHandCursor = _globalConfig.forceHandCursor === true || _getStyle(element, "cursor") === "pointer";
    _setHandCursor(useHandCursor);
    _reposition();
  };
  /**
 * The underlying implementation of `ZeroClipboard.blur`/`ZeroClipboard.deactivate`.
 * @private
 */
  var _blur = function() {
    var htmlBridge = _getHtmlBridge(_flashState.bridge);
    if (htmlBridge) {
      htmlBridge.removeAttribute("title");
      htmlBridge.style.left = "0px";
      htmlBridge.style.top = "-9999px";
      htmlBridge.style.width = "1px";
      htmlBridge.style.height = "1px";
    }
    if (_currentElement) {
      _removeClass(_currentElement, _globalConfig.hoverClass);
      _removeClass(_currentElement, _globalConfig.activeClass);
      _currentElement = null;
    }
  };
  /**
 * The underlying implementation of `ZeroClipboard.activeElement`.
 * @private
 */
  var _activeElement = function() {
    return _currentElement || null;
  };
  /**
 * Check if a value is a valid HTML4 `ID` or `Name` token.
 * @private
 */
  var _isValidHtml4Id = function(id) {
    return typeof id === "string" && id && /^[A-Za-z][A-Za-z0-9_:\-\.]*$/.test(id);
  };
  /**
 * Create or update an `event` object, based on the `eventType`.
 * @private
 */
  var _createEvent = function(event) {
    var eventType;
    if (typeof event === "string" && event) {
      eventType = event;
      event = {};
    } else if (typeof event === "object" && event && typeof event.type === "string" && event.type) {
      eventType = event.type;
    }
    if (!eventType) {
      return;
    }
    eventType = eventType.toLowerCase();
    if (!event.target && (/^(copy|aftercopy|_click)$/.test(eventType) || eventType === "error" && event.name === "clipboard-error")) {
      event.target = _copyTarget;
    }
    _extend(event, {
      type: eventType,
      target: event.target || _currentElement || null,
      relatedTarget: event.relatedTarget || null,
      currentTarget: _flashState && _flashState.bridge || null,
      timeStamp: event.timeStamp || _now() || null
    });
    var msg = _eventMessages[event.type];
    if (event.type === "error" && event.name && msg) {
      msg = msg[event.name];
    }
    if (msg) {
      event.message = msg;
    }
    if (event.type === "ready") {
      _extend(event, {
        target: null,
        version: _flashState.version
      });
    }
    if (event.type === "error") {
      if (_flashStateErrorNameMatchingRegex.test(event.name)) {
        _extend(event, {
          target: null,
          minimumVersion: _minimumFlashVersion
        });
      }
      if (_flashStateEnabledErrorNameMatchingRegex.test(event.name)) {
        _extend(event, {
          version: _flashState.version
        });
      }
    }
    if (event.type === "copy") {
      event.clipboardData = {
        setData: ZeroClipboard.setData,
        clearData: ZeroClipboard.clearData
      };
    }
    if (event.type === "aftercopy") {
      event = _mapClipResultsFromFlash(event, _clipDataFormatMap);
    }
    if (event.target && !event.relatedTarget) {
      event.relatedTarget = _getRelatedTarget(event.target);
    }
    return _addMouseData(event);
  };
  /**
 * Get a relatedTarget from the target's `data-clipboard-target` attribute
 * @private
 */
  var _getRelatedTarget = function(targetEl) {
    var relatedTargetId = targetEl && targetEl.getAttribute && targetEl.getAttribute("data-clipboard-target");
    return relatedTargetId ? _document.getElementById(relatedTargetId) : null;
  };
  /**
 * Add element and position data to `MouseEvent` instances
 * @private
 */
  var _addMouseData = function(event) {
    if (event && /^_(?:click|mouse(?:over|out|down|up|move))$/.test(event.type)) {
      var srcElement = event.target;
      var fromElement = event.type === "_mouseover" && event.relatedTarget ? event.relatedTarget : undefined;
      var toElement = event.type === "_mouseout" && event.relatedTarget ? event.relatedTarget : undefined;
      var pos = _getElementPosition(srcElement);
      var screenLeft = _window.screenLeft || _window.screenX || 0;
      var screenTop = _window.screenTop || _window.screenY || 0;
      var scrollLeft = _document.body.scrollLeft + _document.documentElement.scrollLeft;
      var scrollTop = _document.body.scrollTop + _document.documentElement.scrollTop;
      var pageX = pos.left + (typeof event._stageX === "number" ? event._stageX : 0);
      var pageY = pos.top + (typeof event._stageY === "number" ? event._stageY : 0);
      var clientX = pageX - scrollLeft;
      var clientY = pageY - scrollTop;
      var screenX = screenLeft + clientX;
      var screenY = screenTop + clientY;
      var moveX = typeof event.movementX === "number" ? event.movementX : 0;
      var moveY = typeof event.movementY === "number" ? event.movementY : 0;
      delete event._stageX;
      delete event._stageY;
      _extend(event, {
        srcElement: srcElement,
        fromElement: fromElement,
        toElement: toElement,
        screenX: screenX,
        screenY: screenY,
        pageX: pageX,
        pageY: pageY,
        clientX: clientX,
        clientY: clientY,
        x: clientX,
        y: clientY,
        movementX: moveX,
        movementY: moveY,
        offsetX: 0,
        offsetY: 0,
        layerX: 0,
        layerY: 0
      });
    }
    return event;
  };
  /**
 * Determine if an event's registered handlers should be execute synchronously or asynchronously.
 *
 * @returns {boolean}
 * @private
 */
  var _shouldPerformAsync = function(event) {
    var eventType = event && typeof event.type === "string" && event.type || "";
    return !/^(?:(?:before)?copy|destroy)$/.test(eventType);
  };
  /**
 * Control if a callback should be executed asynchronously or not.
 *
 * @returns `undefined`
 * @private
 */
  var _dispatchCallback = function(func, context, args, async) {
    if (async) {
      _setTimeout(function() {
        func.apply(context, args);
      }, 0);
    } else {
      func.apply(context, args);
    }
  };
  /**
 * Handle the actual dispatching of events to client instances.
 *
 * @returns `undefined`
 * @private
 */
  var _dispatchCallbacks = function(event) {
    if (!(typeof event === "object" && event && event.type)) {
      return;
    }
    var async = _shouldPerformAsync(event);
    var wildcardTypeHandlers = _handlers["*"] || [];
    var specificTypeHandlers = _handlers[event.type] || [];
    var handlers = wildcardTypeHandlers.concat(specificTypeHandlers);
    if (handlers && handlers.length) {
      var i, len, func, context, eventCopy, originalContext = this;
      for (i = 0, len = handlers.length; i < len; i++) {
        func = handlers[i];
        context = originalContext;
        if (typeof func === "string" && typeof _window[func] === "function") {
          func = _window[func];
        }
        if (typeof func === "object" && func && typeof func.handleEvent === "function") {
          context = func;
          func = func.handleEvent;
        }
        if (typeof func === "function") {
          eventCopy = _extend({}, event);
          _dispatchCallback(func, context, [ eventCopy ], async);
        }
      }
    }
    return this;
  };
  /**
 * Check an `error` event's `name` property to see if Flash has
 * already loaded, which rules out possible `iframe` sandboxing.
 * @private
 */
  var _getSandboxStatusFromErrorEvent = function(event) {
    var isSandboxed = null;
    if (_pageIsFramed === false || event && event.type === "error" && event.name && _errorsThatOnlyOccurAfterFlashLoads.indexOf(event.name) !== -1) {
      isSandboxed = false;
    }
    return isSandboxed;
  };
  /**
 * Preprocess any special behaviors, reactions, or state changes after receiving this event.
 * Executes only once per event emitted, NOT once per client.
 * @private
 */
  var _preprocessEvent = function(event) {
    var element = event.target || _currentElement || null;
    var sourceIsSwf = event._source === "swf";
    delete event._source;
    switch (event.type) {
     case "error":
      var isSandboxed = event.name === "flash-sandboxed" || _getSandboxStatusFromErrorEvent(event);
      if (typeof isSandboxed === "boolean") {
        _flashState.sandboxed = isSandboxed;
      }
      if (_flashStateErrorNames.indexOf(event.name) !== -1) {
        _extend(_flashState, {
          disabled: event.name === "flash-disabled",
          outdated: event.name === "flash-outdated",
          unavailable: event.name === "flash-unavailable",
          degraded: event.name === "flash-degraded",
          deactivated: event.name === "flash-deactivated",
          overdue: event.name === "flash-overdue",
          ready: false
        });
      } else if (event.name === "version-mismatch") {
        _zcSwfVersion = event.swfVersion;
        _extend(_flashState, {
          disabled: false,
          outdated: false,
          unavailable: false,
          degraded: false,
          deactivated: false,
          overdue: false,
          ready: false
        });
      }
      _clearTimeoutsAndPolling();
      break;

     case "ready":
      _zcSwfVersion = event.swfVersion;
      var wasDeactivated = _flashState.deactivated === true;
      _extend(_flashState, {
        disabled: false,
        outdated: false,
        sandboxed: false,
        unavailable: false,
        degraded: false,
        deactivated: false,
        overdue: wasDeactivated,
        ready: !wasDeactivated
      });
      _clearTimeoutsAndPolling();
      break;

     case "beforecopy":
      _copyTarget = element;
      break;

     case "copy":
      var textContent, htmlContent, targetEl = event.relatedTarget;
      if (!(_clipData["text/html"] || _clipData["text/plain"]) && targetEl && (htmlContent = targetEl.value || targetEl.outerHTML || targetEl.innerHTML) && (textContent = targetEl.value || targetEl.textContent || targetEl.innerText)) {
        event.clipboardData.clearData();
        event.clipboardData.setData("text/plain", textContent);
        if (htmlContent !== textContent) {
          event.clipboardData.setData("text/html", htmlContent);
        }
      } else if (!_clipData["text/plain"] && event.target && (textContent = event.target.getAttribute("data-clipboard-text"))) {
        event.clipboardData.clearData();
        event.clipboardData.setData("text/plain", textContent);
      }
      break;

     case "aftercopy":
      _queueEmitClipboardErrors(event);
      ZeroClipboard.clearData();
      if (element && element !== _safeActiveElement() && element.focus) {
        element.focus();
      }
      break;

     case "_mouseover":
      ZeroClipboard.focus(element);
      if (_globalConfig.bubbleEvents === true && sourceIsSwf) {
        if (element && element !== event.relatedTarget && !_containedBy(event.relatedTarget, element)) {
          _fireMouseEvent(_extend({}, event, {
            type: "mouseenter",
            bubbles: false,
            cancelable: false
          }));
        }
        _fireMouseEvent(_extend({}, event, {
          type: "mouseover"
        }));
      }
      break;

     case "_mouseout":
      ZeroClipboard.blur();
      if (_globalConfig.bubbleEvents === true && sourceIsSwf) {
        if (element && element !== event.relatedTarget && !_containedBy(event.relatedTarget, element)) {
          _fireMouseEvent(_extend({}, event, {
            type: "mouseleave",
            bubbles: false,
            cancelable: false
          }));
        }
        _fireMouseEvent(_extend({}, event, {
          type: "mouseout"
        }));
      }
      break;

     case "_mousedown":
      _addClass(element, _globalConfig.activeClass);
      if (_globalConfig.bubbleEvents === true && sourceIsSwf) {
        _fireMouseEvent(_extend({}, event, {
          type: event.type.slice(1)
        }));
      }
      break;

     case "_mouseup":
      _removeClass(element, _globalConfig.activeClass);
      if (_globalConfig.bubbleEvents === true && sourceIsSwf) {
        _fireMouseEvent(_extend({}, event, {
          type: event.type.slice(1)
        }));
      }
      break;

     case "_click":
      _copyTarget = null;
      if (_globalConfig.bubbleEvents === true && sourceIsSwf) {
        _fireMouseEvent(_extend({}, event, {
          type: event.type.slice(1)
        }));
      }
      break;

     case "_mousemove":
      if (_globalConfig.bubbleEvents === true && sourceIsSwf) {
        _fireMouseEvent(_extend({}, event, {
          type: event.type.slice(1)
        }));
      }
      break;
    }
    if (/^_(?:click|mouse(?:over|out|down|up|move))$/.test(event.type)) {
      return true;
    }
  };
  /**
 * Check an "aftercopy" event for clipboard errors and emit a corresponding "error" event.
 * @private
 */
  var _queueEmitClipboardErrors = function(aftercopyEvent) {
    if (aftercopyEvent.errors && aftercopyEvent.errors.length > 0) {
      var errorEvent = _deepCopy(aftercopyEvent);
      _extend(errorEvent, {
        type: "error",
        name: "clipboard-error"
      });
      delete errorEvent.success;
      _setTimeout(function() {
        ZeroClipboard.emit(errorEvent);
      }, 0);
    }
  };
  /**
 * Dispatch a synthetic MouseEvent.
 *
 * @returns `undefined`
 * @private
 */
  var _fireMouseEvent = function(event) {
    if (!(event && typeof event.type === "string" && event)) {
      return;
    }
    var e, target = event.target || null, doc = target && target.ownerDocument || _document, defaults = {
      view: doc.defaultView || _window,
      canBubble: true,
      cancelable: true,
      detail: event.type === "click" ? 1 : 0,
      button: typeof event.which === "number" ? event.which - 1 : typeof event.button === "number" ? event.button : doc.createEvent ? 0 : 1
    }, args = _extend(defaults, event);
    if (!target) {
      return;
    }
    if (doc.createEvent && target.dispatchEvent) {
      args = [ args.type, args.canBubble, args.cancelable, args.view, args.detail, args.screenX, args.screenY, args.clientX, args.clientY, args.ctrlKey, args.altKey, args.shiftKey, args.metaKey, args.button, args.relatedTarget ];
      e = doc.createEvent("MouseEvents");
      if (e.initMouseEvent) {
        e.initMouseEvent.apply(e, args);
        e._source = "js";
        target.dispatchEvent(e);
      }
    }
  };
  /**
 * Continuously poll the DOM until either:
 *  (a) the fallback content becomes visible, or
 *  (b) we receive an event from SWF (handled elsewhere)
 *
 * IMPORTANT:
 * This is NOT a necessary check but it can result in significantly faster
 * detection of bad `swfPath` configuration and/or network/server issues [in
 * supported browsers] than waiting for the entire `flashLoadTimeout` duration
 * to elapse before detecting that the SWF cannot be loaded. The detection
 * duration can be anywhere from 10-30 times faster [in supported browsers] by
 * using this approach.
 *
 * @returns `undefined`
 * @private
 */
  var _watchForSwfFallbackContent = function() {
    var maxWait = _globalConfig.flashLoadTimeout;
    if (typeof maxWait === "number" && maxWait >= 0) {
      var pollWait = Math.min(1e3, maxWait / 10);
      var fallbackContentId = _globalConfig.swfObjectId + "_fallbackContent";
      _swfFallbackCheckInterval = _setInterval(function() {
        var el = _document.getElementById(fallbackContentId);
        if (_isElementVisible(el)) {
          _clearTimeoutsAndPolling();
          _flashState.deactivated = null;
          ZeroClipboard.emit({
            type: "error",
            name: "swf-not-found"
          });
        }
      }, pollWait);
    }
  };
  /**
 * Create the HTML bridge element to embed the Flash object into.
 * @private
 */
  var _createHtmlBridge = function() {
    var container = _document.createElement("div");
    container.id = _globalConfig.containerId;
    container.className = _globalConfig.containerClass;
    container.style.position = "absolute";
    container.style.left = "0px";
    container.style.top = "-9999px";
    container.style.width = "1px";
    container.style.height = "1px";
    container.style.zIndex = "" + _getSafeZIndex(_globalConfig.zIndex);
    return container;
  };
  /**
 * Get the HTML element container that wraps the Flash bridge object/element.
 * @private
 */
  var _getHtmlBridge = function(flashBridge) {
    var htmlBridge = flashBridge && flashBridge.parentNode;
    while (htmlBridge && htmlBridge.nodeName === "OBJECT" && htmlBridge.parentNode) {
      htmlBridge = htmlBridge.parentNode;
    }
    return htmlBridge || null;
  };
  /**
 * Create the SWF object.
 *
 * @returns The SWF object reference.
 * @private
 */
  var _embedSwf = function() {
    var len, flashBridge = _flashState.bridge, container = _getHtmlBridge(flashBridge);
    if (!flashBridge) {
      var allowScriptAccess = _determineScriptAccess(_window.location.host, _globalConfig);
      var allowNetworking = allowScriptAccess === "never" ? "none" : "all";
      var flashvars = _vars(_extend({
        jsVersion: ZeroClipboard.version
      }, _globalConfig));
      var swfUrl = _globalConfig.swfPath + _cacheBust(_globalConfig.swfPath, _globalConfig);
      container = _createHtmlBridge();
      var divToBeReplaced = _document.createElement("div");
      container.appendChild(divToBeReplaced);
      _document.body.appendChild(container);
      var tmpDiv = _document.createElement("div");
      var usingActiveX = _flashState.pluginType === "activex";
      tmpDiv.innerHTML = '<object id="' + _globalConfig.swfObjectId + '" name="' + _globalConfig.swfObjectId + '" ' + 'width="100%" height="100%" ' + (usingActiveX ? 'classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"' : 'type="application/x-shockwave-flash" data="' + swfUrl + '"') + ">" + (usingActiveX ? '<param name="movie" value="' + swfUrl + '"/>' : "") + '<param name="allowScriptAccess" value="' + allowScriptAccess + '"/>' + '<param name="allowNetworking" value="' + allowNetworking + '"/>' + '<param name="menu" value="false"/>' + '<param name="wmode" value="transparent"/>' + '<param name="flashvars" value="' + flashvars + '"/>' + '<div id="' + _globalConfig.swfObjectId + '_fallbackContent">&nbsp;</div>' + "</object>";
      flashBridge = tmpDiv.firstChild;
      tmpDiv = null;
      _unwrap(flashBridge).ZeroClipboard = ZeroClipboard;
      container.replaceChild(flashBridge, divToBeReplaced);
      _watchForSwfFallbackContent();
    }
    if (!flashBridge) {
      flashBridge = _document[_globalConfig.swfObjectId];
      if (flashBridge && (len = flashBridge.length)) {
        flashBridge = flashBridge[len - 1];
      }
      if (!flashBridge && container) {
        flashBridge = container.firstChild;
      }
    }
    _flashState.bridge = flashBridge || null;
    return flashBridge;
  };
  /**
 * Destroy the SWF object.
 * @private
 */
  var _unembedSwf = function() {
    var flashBridge = _flashState.bridge;
    if (flashBridge) {
      var htmlBridge = _getHtmlBridge(flashBridge);
      if (htmlBridge) {
        if (_flashState.pluginType === "activex" && "readyState" in flashBridge) {
          flashBridge.style.display = "none";
          (function removeSwfFromIE() {
            if (flashBridge.readyState === 4) {
              for (var prop in flashBridge) {
                if (typeof flashBridge[prop] === "function") {
                  flashBridge[prop] = null;
                }
              }
              if (flashBridge.parentNode) {
                flashBridge.parentNode.removeChild(flashBridge);
              }
              if (htmlBridge.parentNode) {
                htmlBridge.parentNode.removeChild(htmlBridge);
              }
            } else {
              _setTimeout(removeSwfFromIE, 10);
            }
          })();
        } else {
          if (flashBridge.parentNode) {
            flashBridge.parentNode.removeChild(flashBridge);
          }
          if (htmlBridge.parentNode) {
            htmlBridge.parentNode.removeChild(htmlBridge);
          }
        }
      }
      _clearTimeoutsAndPolling();
      _flashState.ready = null;
      _flashState.bridge = null;
      _flashState.deactivated = null;
      _zcSwfVersion = undefined;
    }
  };
  /**
 * Map the data format names of the "clipData" to Flash-friendly names.
 *
 * @returns A new transformed object.
 * @private
 */
  var _mapClipDataToFlash = function(clipData) {
    var newClipData = {}, formatMap = {};
    if (!(typeof clipData === "object" && clipData)) {
      return;
    }
    for (var dataFormat in clipData) {
      if (dataFormat && _hasOwn.call(clipData, dataFormat) && typeof clipData[dataFormat] === "string" && clipData[dataFormat]) {
        switch (dataFormat.toLowerCase()) {
         case "text/plain":
         case "text":
         case "air:text":
         case "flash:text":
          newClipData.text = clipData[dataFormat];
          formatMap.text = dataFormat;
          break;

         case "text/html":
         case "html":
         case "air:html":
         case "flash:html":
          newClipData.html = clipData[dataFormat];
          formatMap.html = dataFormat;
          break;

         case "application/rtf":
         case "text/rtf":
         case "rtf":
         case "richtext":
         case "air:rtf":
         case "flash:rtf":
          newClipData.rtf = clipData[dataFormat];
          formatMap.rtf = dataFormat;
          break;

         default:
          break;
        }
      }
    }
    return {
      data: newClipData,
      formatMap: formatMap
    };
  };
  /**
 * Map the data format names from Flash-friendly names back to their original "clipData" names (via a format mapping).
 *
 * @returns A new transformed object.
 * @private
 */
  var _mapClipResultsFromFlash = function(clipResults, formatMap) {
    if (!(typeof clipResults === "object" && clipResults && typeof formatMap === "object" && formatMap)) {
      return clipResults;
    }
    var newResults = {};
    for (var prop in clipResults) {
      if (_hasOwn.call(clipResults, prop)) {
        if (prop === "errors") {
          newResults[prop] = clipResults[prop] ? clipResults[prop].slice() : [];
          for (var i = 0, len = newResults[prop].length; i < len; i++) {
            newResults[prop][i].format = formatMap[newResults[prop][i].format];
          }
        } else if (prop !== "success" && prop !== "data") {
          newResults[prop] = clipResults[prop];
        } else {
          newResults[prop] = {};
          var tmpHash = clipResults[prop];
          for (var dataFormat in tmpHash) {
            if (dataFormat && _hasOwn.call(tmpHash, dataFormat) && _hasOwn.call(formatMap, dataFormat)) {
              newResults[prop][formatMap[dataFormat]] = tmpHash[dataFormat];
            }
          }
        }
      }
    }
    return newResults;
  };
  /**
 * Will look at a path, and will create a "?noCache={time}" or "&noCache={time}"
 * query param string to return. Does NOT append that string to the original path.
 * This is useful because ExternalInterface often breaks when a Flash SWF is cached.
 *
 * @returns The `noCache` query param with necessary "?"/"&" prefix.
 * @private
 */
  var _cacheBust = function(path, options) {
    var cacheBust = options == null || options && options.cacheBust === true;
    if (cacheBust) {
      return (path.indexOf("?") === -1 ? "?" : "&") + "noCache=" + _now();
    } else {
      return "";
    }
  };
  /**
 * Creates a query string for the FlashVars param.
 * Does NOT include the cache-busting query param.
 *
 * @returns FlashVars query string
 * @private
 */
  var _vars = function(options) {
    var i, len, domain, domains, str = "", trustedOriginsExpanded = [];
    if (options.trustedDomains) {
      if (typeof options.trustedDomains === "string") {
        domains = [ options.trustedDomains ];
      } else if (typeof options.trustedDomains === "object" && "length" in options.trustedDomains) {
        domains = options.trustedDomains;
      }
    }
    if (domains && domains.length) {
      for (i = 0, len = domains.length; i < len; i++) {
        if (_hasOwn.call(domains, i) && domains[i] && typeof domains[i] === "string") {
          domain = _extractDomain(domains[i]);
          if (!domain) {
            continue;
          }
          if (domain === "*") {
            trustedOriginsExpanded.length = 0;
            trustedOriginsExpanded.push(domain);
            break;
          }
          trustedOriginsExpanded.push.apply(trustedOriginsExpanded, [ domain, "//" + domain, _window.location.protocol + "//" + domain ]);
        }
      }
    }
    if (trustedOriginsExpanded.length) {
      str += "trustedOrigins=" + _encodeURIComponent(trustedOriginsExpanded.join(","));
    }
    if (options.forceEnhancedClipboard === true) {
      str += (str ? "&" : "") + "forceEnhancedClipboard=true";
    }
    if (typeof options.swfObjectId === "string" && options.swfObjectId) {
      str += (str ? "&" : "") + "swfObjectId=" + _encodeURIComponent(options.swfObjectId);
    }
    if (typeof options.jsVersion === "string" && options.jsVersion) {
      str += (str ? "&" : "") + "jsVersion=" + _encodeURIComponent(options.jsVersion);
    }
    return str;
  };
  /**
 * Extract the domain (e.g. "github.com") from an origin (e.g. "https://github.com") or
 * URL (e.g. "https://github.com/zeroclipboard/zeroclipboard/").
 *
 * @returns the domain
 * @private
 */
  var _extractDomain = function(originOrUrl) {
    if (originOrUrl == null || originOrUrl === "") {
      return null;
    }
    originOrUrl = originOrUrl.replace(/^\s+|\s+$/g, "");
    if (originOrUrl === "") {
      return null;
    }
    var protocolIndex = originOrUrl.indexOf("//");
    originOrUrl = protocolIndex === -1 ? originOrUrl : originOrUrl.slice(protocolIndex + 2);
    var pathIndex = originOrUrl.indexOf("/");
    originOrUrl = pathIndex === -1 ? originOrUrl : protocolIndex === -1 || pathIndex === 0 ? null : originOrUrl.slice(0, pathIndex);
    if (originOrUrl && originOrUrl.slice(-4).toLowerCase() === ".swf") {
      return null;
    }
    return originOrUrl || null;
  };
  /**
 * Set `allowScriptAccess` based on `trustedDomains` and `window.location.host` vs. `swfPath`.
 *
 * @returns The appropriate script access level.
 * @private
 */
  var _determineScriptAccess = function() {
    var _extractAllDomains = function(origins) {
      var i, len, tmp, resultsArray = [];
      if (typeof origins === "string") {
        origins = [ origins ];
      }
      if (!(typeof origins === "object" && origins && typeof origins.length === "number")) {
        return resultsArray;
      }
      for (i = 0, len = origins.length; i < len; i++) {
        if (_hasOwn.call(origins, i) && (tmp = _extractDomain(origins[i]))) {
          if (tmp === "*") {
            resultsArray.length = 0;
            resultsArray.push("*");
            break;
          }
          if (resultsArray.indexOf(tmp) === -1) {
            resultsArray.push(tmp);
          }
        }
      }
      return resultsArray;
    };
    return function(currentDomain, configOptions) {
      var swfDomain = _extractDomain(configOptions.swfPath);
      if (swfDomain === null) {
        swfDomain = currentDomain;
      }
      var trustedDomains = _extractAllDomains(configOptions.trustedDomains);
      var len = trustedDomains.length;
      if (len > 0) {
        if (len === 1 && trustedDomains[0] === "*") {
          return "always";
        }
        if (trustedDomains.indexOf(currentDomain) !== -1) {
          if (len === 1 && currentDomain === swfDomain) {
            return "sameDomain";
          }
          return "always";
        }
      }
      return "never";
    };
  }();
  /**
 * Get the currently active/focused DOM element.
 *
 * @returns the currently active/focused element, or `null`
 * @private
 */
  var _safeActiveElement = function() {
    try {
      return _document.activeElement;
    } catch (err) {
      return null;
    }
  };
  /**
 * Add a class to an element, if it doesn't already have it.
 *
 * @returns The element, with its new class added.
 * @private
 */
  var _addClass = function(element, value) {
    var c, cl, className, classNames = [];
    if (typeof value === "string" && value) {
      classNames = value.split(/\s+/);
    }
    if (element && element.nodeType === 1 && classNames.length > 0) {
      if (element.classList) {
        for (c = 0, cl = classNames.length; c < cl; c++) {
          element.classList.add(classNames[c]);
        }
      } else if (element.hasOwnProperty("className")) {
        className = " " + element.className + " ";
        for (c = 0, cl = classNames.length; c < cl; c++) {
          if (className.indexOf(" " + classNames[c] + " ") === -1) {
            className += classNames[c] + " ";
          }
        }
        element.className = className.replace(/^\s+|\s+$/g, "");
      }
    }
    return element;
  };
  /**
 * Remove a class from an element, if it has it.
 *
 * @returns The element, with its class removed.
 * @private
 */
  var _removeClass = function(element, value) {
    var c, cl, className, classNames = [];
    if (typeof value === "string" && value) {
      classNames = value.split(/\s+/);
    }
    if (element && element.nodeType === 1 && classNames.length > 0) {
      if (element.classList && element.classList.length > 0) {
        for (c = 0, cl = classNames.length; c < cl; c++) {
          element.classList.remove(classNames[c]);
        }
      } else if (element.className) {
        className = (" " + element.className + " ").replace(/[\r\n\t]/g, " ");
        for (c = 0, cl = classNames.length; c < cl; c++) {
          className = className.replace(" " + classNames[c] + " ", " ");
        }
        element.className = className.replace(/^\s+|\s+$/g, "");
      }
    }
    return element;
  };
  /**
 * Attempt to interpret the element's CSS styling. If `prop` is `"cursor"`,
 * then we assume that it should be a hand ("pointer") cursor if the element
 * is an anchor element ("a" tag).
 *
 * @returns The computed style property.
 * @private
 */
  var _getStyle = function(el, prop) {
    var value = _getComputedStyle(el, null).getPropertyValue(prop);
    if (prop === "cursor") {
      if (!value || value === "auto") {
        if (el.nodeName === "A") {
          return "pointer";
        }
      }
    }
    return value;
  };
  /**
 * Get the absolutely positioned coordinates of a DOM element.
 *
 * @returns Object containing the element's position, width, and height.
 * @private
 */
  var _getElementPosition = function(el) {
    var pos = {
      left: 0,
      top: 0,
      width: 0,
      height: 0
    };
    if (el.getBoundingClientRect) {
      var elRect = el.getBoundingClientRect();
      var pageXOffset = _window.pageXOffset;
      var pageYOffset = _window.pageYOffset;
      var leftBorderWidth = _document.documentElement.clientLeft || 0;
      var topBorderWidth = _document.documentElement.clientTop || 0;
      var leftBodyOffset = 0;
      var topBodyOffset = 0;
      if (_getStyle(_document.body, "position") === "relative") {
        var bodyRect = _document.body.getBoundingClientRect();
        var htmlRect = _document.documentElement.getBoundingClientRect();
        leftBodyOffset = bodyRect.left - htmlRect.left || 0;
        topBodyOffset = bodyRect.top - htmlRect.top || 0;
      }
      pos.left = elRect.left + pageXOffset - leftBorderWidth - leftBodyOffset;
      pos.top = elRect.top + pageYOffset - topBorderWidth - topBodyOffset;
      pos.width = "width" in elRect ? elRect.width : elRect.right - elRect.left;
      pos.height = "height" in elRect ? elRect.height : elRect.bottom - elRect.top;
    }
    return pos;
  };
  /**
 * Determine is an element is visible somewhere within the document (page).
 *
 * @returns Boolean
 * @private
 */
  var _isElementVisible = function(el) {
    if (!el) {
      return false;
    }
    var styles = _getComputedStyle(el, null);
    var hasCssHeight = _parseFloat(styles.height) > 0;
    var hasCssWidth = _parseFloat(styles.width) > 0;
    var hasCssTop = _parseFloat(styles.top) >= 0;
    var hasCssLeft = _parseFloat(styles.left) >= 0;
    var cssKnows = hasCssHeight && hasCssWidth && hasCssTop && hasCssLeft;
    var rect = cssKnows ? null : _getElementPosition(el);
    var isVisible = styles.display !== "none" && styles.visibility !== "collapse" && (cssKnows || !!rect && (hasCssHeight || rect.height > 0) && (hasCssWidth || rect.width > 0) && (hasCssTop || rect.top >= 0) && (hasCssLeft || rect.left >= 0));
    return isVisible;
  };
  /**
 * Clear all existing timeouts and interval polling delegates.
 *
 * @returns `undefined`
 * @private
 */
  var _clearTimeoutsAndPolling = function() {
    _clearTimeout(_flashCheckTimeout);
    _flashCheckTimeout = 0;
    _clearInterval(_swfFallbackCheckInterval);
    _swfFallbackCheckInterval = 0;
  };
  /**
 * Reposition the Flash object to cover the currently activated element.
 *
 * @returns `undefined`
 * @private
 */
  var _reposition = function() {
    var htmlBridge;
    if (_currentElement && (htmlBridge = _getHtmlBridge(_flashState.bridge))) {
      var pos = _getElementPosition(_currentElement);
      _extend(htmlBridge.style, {
        width: pos.width + "px",
        height: pos.height + "px",
        top: pos.top + "px",
        left: pos.left + "px",
        zIndex: "" + _getSafeZIndex(_globalConfig.zIndex)
      });
    }
  };
  /**
 * Sends a signal to the Flash object to display the hand cursor if `true`.
 *
 * @returns `undefined`
 * @private
 */
  var _setHandCursor = function(enabled) {
    if (_flashState.ready === true) {
      if (_flashState.bridge && typeof _flashState.bridge.setHandCursor === "function") {
        _flashState.bridge.setHandCursor(enabled);
      } else {
        _flashState.ready = false;
      }
    }
  };
  /**
 * Get a safe value for `zIndex`
 *
 * @returns an integer, or "auto"
 * @private
 */
  var _getSafeZIndex = function(val) {
    if (/^(?:auto|inherit)$/.test(val)) {
      return val;
    }
    var zIndex;
    if (typeof val === "number" && !_isNaN(val)) {
      zIndex = val;
    } else if (typeof val === "string") {
      zIndex = _getSafeZIndex(_parseInt(val, 10));
    }
    return typeof zIndex === "number" ? zIndex : "auto";
  };
  /**
 * Attempt to detect if ZeroClipboard is executing inside of a sandboxed iframe.
 * If it is, Flash Player cannot be used, so ZeroClipboard is dead in the water.
 *
 * @see {@link http://lists.w3.org/Archives/Public/public-whatwg-archive/2014Dec/0002.html}
 * @see {@link https://github.com/zeroclipboard/zeroclipboard/issues/511}
 * @see {@link http://zeroclipboard.org/test-iframes.html}
 *
 * @returns `true` (is sandboxed), `false` (is not sandboxed), or `null` (uncertain) 
 * @private
 */
  var _detectSandbox = function(doNotReassessFlashSupport) {
    var effectiveScriptOrigin, frame, frameError, previousState = _flashState.sandboxed, isSandboxed = null;
    doNotReassessFlashSupport = doNotReassessFlashSupport === true;
    if (_pageIsFramed === false) {
      isSandboxed = false;
    } else {
      try {
        frame = window.frameElement || null;
      } catch (e) {
        frameError = {
          name: e.name,
          message: e.message
        };
      }
      if (frame && frame.nodeType === 1 && frame.nodeName === "IFRAME") {
        try {
          isSandboxed = frame.hasAttribute("sandbox");
        } catch (e) {
          isSandboxed = null;
        }
      } else {
        try {
          effectiveScriptOrigin = document.domain || null;
        } catch (e) {
          effectiveScriptOrigin = null;
        }
        if (effectiveScriptOrigin === null || frameError && frameError.name === "SecurityError" && /(^|[\s\(\[@])sandbox(es|ed|ing|[\s\.,!\)\]@]|$)/.test(frameError.message.toLowerCase())) {
          isSandboxed = true;
        }
      }
    }
    _flashState.sandboxed = isSandboxed;
    if (previousState !== isSandboxed && !doNotReassessFlashSupport) {
      _detectFlashSupport(_ActiveXObject);
    }
    return isSandboxed;
  };
  /**
 * Detect the Flash Player status, version, and plugin type.
 *
 * @see {@link https://code.google.com/p/doctype-mirror/wiki/ArticleDetectFlash#The_code}
 * @see {@link http://stackoverflow.com/questions/12866060/detecting-pepper-ppapi-flash-with-javascript}
 *
 * @returns `undefined`
 * @private
 */
  var _detectFlashSupport = function(ActiveXObject) {
    var plugin, ax, mimeType, hasFlash = false, isActiveX = false, isPPAPI = false, flashVersion = "";
    /**
   * Derived from Apple's suggested sniffer.
   * @param {String} desc e.g. "Shockwave Flash 7.0 r61"
   * @returns {String} "7.0.61"
   * @private
   */
    function parseFlashVersion(desc) {
      var matches = desc.match(/[\d]+/g);
      matches.length = 3;
      return matches.join(".");
    }
    function isPepperFlash(flashPlayerFileName) {
      return !!flashPlayerFileName && (flashPlayerFileName = flashPlayerFileName.toLowerCase()) && (/^(pepflashplayer\.dll|libpepflashplayer\.so|pepperflashplayer\.plugin)$/.test(flashPlayerFileName) || flashPlayerFileName.slice(-13) === "chrome.plugin");
    }
    function inspectPlugin(plugin) {
      if (plugin) {
        hasFlash = true;
        if (plugin.version) {
          flashVersion = parseFlashVersion(plugin.version);
        }
        if (!flashVersion && plugin.description) {
          flashVersion = parseFlashVersion(plugin.description);
        }
        if (plugin.filename) {
          isPPAPI = isPepperFlash(plugin.filename);
        }
      }
    }
    if (_navigator.plugins && _navigator.plugins.length) {
      plugin = _navigator.plugins["Shockwave Flash"];
      inspectPlugin(plugin);
      if (_navigator.plugins["Shockwave Flash 2.0"]) {
        hasFlash = true;
        flashVersion = "2.0.0.11";
      }
    } else if (_navigator.mimeTypes && _navigator.mimeTypes.length) {
      mimeType = _navigator.mimeTypes["application/x-shockwave-flash"];
      plugin = mimeType && mimeType.enabledPlugin;
      inspectPlugin(plugin);
    } else if (typeof ActiveXObject !== "undefined") {
      isActiveX = true;
      try {
        ax = new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");
        hasFlash = true;
        flashVersion = parseFlashVersion(ax.GetVariable("$version"));
      } catch (e1) {
        try {
          ax = new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");
          hasFlash = true;
          flashVersion = "6.0.21";
        } catch (e2) {
          try {
            ax = new ActiveXObject("ShockwaveFlash.ShockwaveFlash");
            hasFlash = true;
            flashVersion = parseFlashVersion(ax.GetVariable("$version"));
          } catch (e3) {
            isActiveX = false;
          }
        }
      }
    }
    _flashState.disabled = hasFlash !== true;
    _flashState.outdated = flashVersion && _parseFloat(flashVersion) < _parseFloat(_minimumFlashVersion);
    _flashState.version = flashVersion || "0.0.0";
    _flashState.pluginType = isPPAPI ? "pepper" : isActiveX ? "activex" : hasFlash ? "netscape" : "unknown";
  };
  /**
 * Invoke the Flash detection algorithms immediately upon inclusion so we're not waiting later.
 */
  _detectFlashSupport(_ActiveXObject);
  /**
 * Always assess the `sandboxed` state of the page at important Flash-related moments.
 */
  _detectSandbox(true);
  /**
 * A shell constructor for `ZeroClipboard` client instances.
 *
 * @constructor
 */
  var ZeroClipboard = function() {
    if (!(this instanceof ZeroClipboard)) {
      return new ZeroClipboard();
    }
    if (typeof ZeroClipboard._createClient === "function") {
      ZeroClipboard._createClient.apply(this, _args(arguments));
    }
  };
  /**
 * The ZeroClipboard library's version number.
 *
 * @static
 * @readonly
 * @property {string}
 */
  _defineProperty(ZeroClipboard, "version", {
    value: "2.2.0",
    writable: false,
    configurable: true,
    enumerable: true
  });
  /**
 * Update or get a copy of the ZeroClipboard global configuration.
 * Returns a copy of the current/updated configuration.
 *
 * @returns Object
 * @static
 */
  ZeroClipboard.config = function() {
    return _config.apply(this, _args(arguments));
  };
  /**
 * Diagnostic method that describes the state of the browser, Flash Player, and ZeroClipboard.
 *
 * @returns Object
 * @static
 */
  ZeroClipboard.state = function() {
    return _state.apply(this, _args(arguments));
  };
  /**
 * Check if Flash is unusable for any reason: disabled, outdated, deactivated, etc.
 *
 * @returns Boolean
 * @static
 */
  ZeroClipboard.isFlashUnusable = function() {
    return _isFlashUnusable.apply(this, _args(arguments));
  };
  /**
 * Register an event listener.
 *
 * @returns `ZeroClipboard`
 * @static
 */
  ZeroClipboard.on = function() {
    return _on.apply(this, _args(arguments));
  };
  /**
 * Unregister an event listener.
 * If no `listener` function/object is provided, it will unregister all listeners for the provided `eventType`.
 * If no `eventType` is provided, it will unregister all listeners for every event type.
 *
 * @returns `ZeroClipboard`
 * @static
 */
  ZeroClipboard.off = function() {
    return _off.apply(this, _args(arguments));
  };
  /**
 * Retrieve event listeners for an `eventType`.
 * If no `eventType` is provided, it will retrieve all listeners for every event type.
 *
 * @returns array of listeners for the `eventType`; if no `eventType`, then a map/hash object of listeners for all event types; or `null`
 */
  ZeroClipboard.handlers = function() {
    return _listeners.apply(this, _args(arguments));
  };
  /**
 * Event emission receiver from the Flash object, forwarding to any registered JavaScript event listeners.
 *
 * @returns For the "copy" event, returns the Flash-friendly "clipData" object; otherwise `undefined`.
 * @static
 */
  ZeroClipboard.emit = function() {
    return _emit.apply(this, _args(arguments));
  };
  /**
 * Create and embed the Flash object.
 *
 * @returns The Flash object
 * @static
 */
  ZeroClipboard.create = function() {
    return _create.apply(this, _args(arguments));
  };
  /**
 * Self-destruct and clean up everything, including the embedded Flash object.
 *
 * @returns `undefined`
 * @static
 */
  ZeroClipboard.destroy = function() {
    return _destroy.apply(this, _args(arguments));
  };
  /**
 * Set the pending data for clipboard injection.
 *
 * @returns `undefined`
 * @static
 */
  ZeroClipboard.setData = function() {
    return _setData.apply(this, _args(arguments));
  };
  /**
 * Clear the pending data for clipboard injection.
 * If no `format` is provided, all pending data formats will be cleared.
 *
 * @returns `undefined`
 * @static
 */
  ZeroClipboard.clearData = function() {
    return _clearData.apply(this, _args(arguments));
  };
  /**
 * Get a copy of the pending data for clipboard injection.
 * If no `format` is provided, a copy of ALL pending data formats will be returned.
 *
 * @returns `String` or `Object`
 * @static
 */
  ZeroClipboard.getData = function() {
    return _getData.apply(this, _args(arguments));
  };
  /**
 * Sets the current HTML object that the Flash object should overlay. This will put the global
 * Flash object on top of the current element; depending on the setup, this may also set the
 * pending clipboard text data as well as the Flash object's wrapping element's title attribute
 * based on the underlying HTML element and ZeroClipboard configuration.
 *
 * @returns `undefined`
 * @static
 */
  ZeroClipboard.focus = ZeroClipboard.activate = function() {
    return _focus.apply(this, _args(arguments));
  };
  /**
 * Un-overlays the Flash object. This will put the global Flash object off-screen; depending on
 * the setup, this may also unset the Flash object's wrapping element's title attribute based on
 * the underlying HTML element and ZeroClipboard configuration.
 *
 * @returns `undefined`
 * @static
 */
  ZeroClipboard.blur = ZeroClipboard.deactivate = function() {
    return _blur.apply(this, _args(arguments));
  };
  /**
 * Returns the currently focused/"activated" HTML element that the Flash object is wrapping.
 *
 * @returns `HTMLElement` or `null`
 * @static
 */
  ZeroClipboard.activeElement = function() {
    return _activeElement.apply(this, _args(arguments));
  };
  /**
 * Keep track of the ZeroClipboard client instance counter.
 */
  var _clientIdCounter = 0;
  /**
 * Keep track of the state of the client instances.
 *
 * Entry structure:
 *   _clientMeta[client.id] = {
 *     instance: client,
 *     elements: [],
 *     handlers: {}
 *   };
 */
  var _clientMeta = {};
  /**
 * Keep track of the ZeroClipboard clipped elements counter.
 */
  var _elementIdCounter = 0;
  /**
 * Keep track of the state of the clipped element relationships to clients.
 *
 * Entry structure:
 *   _elementMeta[element.zcClippingId] = [client1.id, client2.id];
 */
  var _elementMeta = {};
  /**
 * Keep track of the state of the mouse event handlers for clipped elements.
 *
 * Entry structure:
 *   _mouseHandlers[element.zcClippingId] = {
 *     mouseover:  function(event) {},
 *     mouseout:   function(event) {},
 *     mouseenter: function(event) {},
 *     mouseleave: function(event) {},
 *     mousemove:  function(event) {}
 *   };
 */
  var _mouseHandlers = {};
  /**
 * Extending the ZeroClipboard configuration defaults for the Client module.
 */
  _extend(_globalConfig, {
    autoActivate: true
  });
  /**
 * The real constructor for `ZeroClipboard` client instances.
 * @private
 */
  var _clientConstructor = function(elements) {
    var client = this;
    client.id = "" + _clientIdCounter++;
    _clientMeta[client.id] = {
      instance: client,
      elements: [],
      handlers: {}
    };
    if (elements) {
      client.clip(elements);
    }
    ZeroClipboard.on("*", function(event) {
      return client.emit(event);
    });
    ZeroClipboard.on("destroy", function() {
      client.destroy();
    });
    ZeroClipboard.create();
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.on`.
 * @private
 */
  var _clientOn = function(eventType, listener) {
    var i, len, events, added = {}, meta = _clientMeta[this.id], handlers = meta && meta.handlers;
    if (!meta) {
      throw new Error("Attempted to add new listener(s) to a destroyed ZeroClipboard client instance");
    }
    if (typeof eventType === "string" && eventType) {
      events = eventType.toLowerCase().split(/\s+/);
    } else if (typeof eventType === "object" && eventType && typeof listener === "undefined") {
      for (i in eventType) {
        if (_hasOwn.call(eventType, i) && typeof i === "string" && i && typeof eventType[i] === "function") {
          this.on(i, eventType[i]);
        }
      }
    }
    if (events && events.length) {
      for (i = 0, len = events.length; i < len; i++) {
        eventType = events[i].replace(/^on/, "");
        added[eventType] = true;
        if (!handlers[eventType]) {
          handlers[eventType] = [];
        }
        handlers[eventType].push(listener);
      }
      if (added.ready && _flashState.ready) {
        this.emit({
          type: "ready",
          client: this
        });
      }
      if (added.error) {
        for (i = 0, len = _flashStateErrorNames.length; i < len; i++) {
          if (_flashState[_flashStateErrorNames[i].replace(/^flash-/, "")]) {
            this.emit({
              type: "error",
              name: _flashStateErrorNames[i],
              client: this
            });
            break;
          }
        }
        if (_zcSwfVersion !== undefined && ZeroClipboard.version !== _zcSwfVersion) {
          this.emit({
            type: "error",
            name: "version-mismatch",
            jsVersion: ZeroClipboard.version,
            swfVersion: _zcSwfVersion
          });
        }
      }
    }
    return this;
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.off`.
 * @private
 */
  var _clientOff = function(eventType, listener) {
    var i, len, foundIndex, events, perEventHandlers, meta = _clientMeta[this.id], handlers = meta && meta.handlers;
    if (!handlers) {
      return this;
    }
    if (arguments.length === 0) {
      events = _keys(handlers);
    } else if (typeof eventType === "string" && eventType) {
      events = eventType.split(/\s+/);
    } else if (typeof eventType === "object" && eventType && typeof listener === "undefined") {
      for (i in eventType) {
        if (_hasOwn.call(eventType, i) && typeof i === "string" && i && typeof eventType[i] === "function") {
          this.off(i, eventType[i]);
        }
      }
    }
    if (events && events.length) {
      for (i = 0, len = events.length; i < len; i++) {
        eventType = events[i].toLowerCase().replace(/^on/, "");
        perEventHandlers = handlers[eventType];
        if (perEventHandlers && perEventHandlers.length) {
          if (listener) {
            foundIndex = perEventHandlers.indexOf(listener);
            while (foundIndex !== -1) {
              perEventHandlers.splice(foundIndex, 1);
              foundIndex = perEventHandlers.indexOf(listener, foundIndex);
            }
          } else {
            perEventHandlers.length = 0;
          }
        }
      }
    }
    return this;
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.handlers`.
 * @private
 */
  var _clientListeners = function(eventType) {
    var copy = null, handlers = _clientMeta[this.id] && _clientMeta[this.id].handlers;
    if (handlers) {
      if (typeof eventType === "string" && eventType) {
        copy = handlers[eventType] ? handlers[eventType].slice(0) : [];
      } else {
        copy = _deepCopy(handlers);
      }
    }
    return copy;
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.emit`.
 * @private
 */
  var _clientEmit = function(event) {
    if (_clientShouldEmit.call(this, event)) {
      if (typeof event === "object" && event && typeof event.type === "string" && event.type) {
        event = _extend({}, event);
      }
      var eventCopy = _extend({}, _createEvent(event), {
        client: this
      });
      _clientDispatchCallbacks.call(this, eventCopy);
    }
    return this;
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.clip`.
 * @private
 */
  var _clientClip = function(elements) {
    if (!_clientMeta[this.id]) {
      throw new Error("Attempted to clip element(s) to a destroyed ZeroClipboard client instance");
    }
    elements = _prepClip(elements);
    for (var i = 0; i < elements.length; i++) {
      if (_hasOwn.call(elements, i) && elements[i] && elements[i].nodeType === 1) {
        if (!elements[i].zcClippingId) {
          elements[i].zcClippingId = "zcClippingId_" + _elementIdCounter++;
          _elementMeta[elements[i].zcClippingId] = [ this.id ];
          if (_globalConfig.autoActivate === true) {
            _addMouseHandlers(elements[i]);
          }
        } else if (_elementMeta[elements[i].zcClippingId].indexOf(this.id) === -1) {
          _elementMeta[elements[i].zcClippingId].push(this.id);
        }
        var clippedElements = _clientMeta[this.id] && _clientMeta[this.id].elements;
        if (clippedElements.indexOf(elements[i]) === -1) {
          clippedElements.push(elements[i]);
        }
      }
    }
    return this;
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.unclip`.
 * @private
 */
  var _clientUnclip = function(elements) {
    var meta = _clientMeta[this.id];
    if (!meta) {
      return this;
    }
    var clippedElements = meta.elements;
    var arrayIndex;
    if (typeof elements === "undefined") {
      elements = clippedElements.slice(0);
    } else {
      elements = _prepClip(elements);
    }
    for (var i = elements.length; i--; ) {
      if (_hasOwn.call(elements, i) && elements[i] && elements[i].nodeType === 1) {
        arrayIndex = 0;
        while ((arrayIndex = clippedElements.indexOf(elements[i], arrayIndex)) !== -1) {
          clippedElements.splice(arrayIndex, 1);
        }
        var clientIds = _elementMeta[elements[i].zcClippingId];
        if (clientIds) {
          arrayIndex = 0;
          while ((arrayIndex = clientIds.indexOf(this.id, arrayIndex)) !== -1) {
            clientIds.splice(arrayIndex, 1);
          }
          if (clientIds.length === 0) {
            if (_globalConfig.autoActivate === true) {
              _removeMouseHandlers(elements[i]);
            }
            delete elements[i].zcClippingId;
          }
        }
      }
    }
    return this;
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.elements`.
 * @private
 */
  var _clientElements = function() {
    var meta = _clientMeta[this.id];
    return meta && meta.elements ? meta.elements.slice(0) : [];
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.destroy`.
 * @private
 */
  var _clientDestroy = function() {
    if (!_clientMeta[this.id]) {
      return;
    }
    this.unclip();
    this.off();
    delete _clientMeta[this.id];
  };
  /**
 * Inspect an Event to see if the Client (`this`) should honor it for emission.
 * @private
 */
  var _clientShouldEmit = function(event) {
    if (!(event && event.type)) {
      return false;
    }
    if (event.client && event.client !== this) {
      return false;
    }
    var meta = _clientMeta[this.id];
    var clippedEls = meta && meta.elements;
    var hasClippedEls = !!clippedEls && clippedEls.length > 0;
    var goodTarget = !event.target || hasClippedEls && clippedEls.indexOf(event.target) !== -1;
    var goodRelTarget = event.relatedTarget && hasClippedEls && clippedEls.indexOf(event.relatedTarget) !== -1;
    var goodClient = event.client && event.client === this;
    if (!meta || !(goodTarget || goodRelTarget || goodClient)) {
      return false;
    }
    return true;
  };
  /**
 * Handle the actual dispatching of events to a client instance.
 *
 * @returns `undefined`
 * @private
 */
  var _clientDispatchCallbacks = function(event) {
    var meta = _clientMeta[this.id];
    if (!(typeof event === "object" && event && event.type && meta)) {
      return;
    }
    var async = _shouldPerformAsync(event);
    var wildcardTypeHandlers = meta && meta.handlers["*"] || [];
    var specificTypeHandlers = meta && meta.handlers[event.type] || [];
    var handlers = wildcardTypeHandlers.concat(specificTypeHandlers);
    if (handlers && handlers.length) {
      var i, len, func, context, eventCopy, originalContext = this;
      for (i = 0, len = handlers.length; i < len; i++) {
        func = handlers[i];
        context = originalContext;
        if (typeof func === "string" && typeof _window[func] === "function") {
          func = _window[func];
        }
        if (typeof func === "object" && func && typeof func.handleEvent === "function") {
          context = func;
          func = func.handleEvent;
        }
        if (typeof func === "function") {
          eventCopy = _extend({}, event);
          _dispatchCallback(func, context, [ eventCopy ], async);
        }
      }
    }
  };
  /**
 * Prepares the elements for clipping/unclipping.
 *
 * @returns An Array of elements.
 * @private
 */
  var _prepClip = function(elements) {
    if (typeof elements === "string") {
      elements = [];
    }
    return typeof elements.length !== "number" ? [ elements ] : elements;
  };
  /**
 * Add a `mouseover` handler function for a clipped element.
 *
 * @returns `undefined`
 * @private
 */
  var _addMouseHandlers = function(element) {
    if (!(element && element.nodeType === 1)) {
      return;
    }
    var _suppressMouseEvents = function(event) {
      if (!(event || (event = _window.event))) {
        return;
      }
      if (event._source !== "js") {
        event.stopImmediatePropagation();
        event.preventDefault();
      }
      delete event._source;
    };
    var _elementMouseOver = function(event) {
      if (!(event || (event = _window.event))) {
        return;
      }
      _suppressMouseEvents(event);
      ZeroClipboard.focus(element);
    };
    element.addEventListener("mouseover", _elementMouseOver, false);
    element.addEventListener("mouseout", _suppressMouseEvents, false);
    element.addEventListener("mouseenter", _suppressMouseEvents, false);
    element.addEventListener("mouseleave", _suppressMouseEvents, false);
    element.addEventListener("mousemove", _suppressMouseEvents, false);
    _mouseHandlers[element.zcClippingId] = {
      mouseover: _elementMouseOver,
      mouseout: _suppressMouseEvents,
      mouseenter: _suppressMouseEvents,
      mouseleave: _suppressMouseEvents,
      mousemove: _suppressMouseEvents
    };
  };
  /**
 * Remove a `mouseover` handler function for a clipped element.
 *
 * @returns `undefined`
 * @private
 */
  var _removeMouseHandlers = function(element) {
    if (!(element && element.nodeType === 1)) {
      return;
    }
    var mouseHandlers = _mouseHandlers[element.zcClippingId];
    if (!(typeof mouseHandlers === "object" && mouseHandlers)) {
      return;
    }
    var key, val, mouseEvents = [ "move", "leave", "enter", "out", "over" ];
    for (var i = 0, len = mouseEvents.length; i < len; i++) {
      key = "mouse" + mouseEvents[i];
      val = mouseHandlers[key];
      if (typeof val === "function") {
        element.removeEventListener(key, val, false);
      }
    }
    delete _mouseHandlers[element.zcClippingId];
  };
  /**
 * Creates a new ZeroClipboard client instance.
 * Optionally, auto-`clip` an element or collection of elements.
 *
 * @constructor
 */
  ZeroClipboard._createClient = function() {
    _clientConstructor.apply(this, _args(arguments));
  };
  /**
 * Register an event listener to the client.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.on = function() {
    return _clientOn.apply(this, _args(arguments));
  };
  /**
 * Unregister an event handler from the client.
 * If no `listener` function/object is provided, it will unregister all handlers for the provided `eventType`.
 * If no `eventType` is provided, it will unregister all handlers for every event type.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.off = function() {
    return _clientOff.apply(this, _args(arguments));
  };
  /**
 * Retrieve event listeners for an `eventType` from the client.
 * If no `eventType` is provided, it will retrieve all listeners for every event type.
 *
 * @returns array of listeners for the `eventType`; if no `eventType`, then a map/hash object of listeners for all event types; or `null`
 */
  ZeroClipboard.prototype.handlers = function() {
    return _clientListeners.apply(this, _args(arguments));
  };
  /**
 * Event emission receiver from the Flash object for this client's registered JavaScript event listeners.
 *
 * @returns For the "copy" event, returns the Flash-friendly "clipData" object; otherwise `undefined`.
 */
  ZeroClipboard.prototype.emit = function() {
    return _clientEmit.apply(this, _args(arguments));
  };
  /**
 * Register clipboard actions for new element(s) to the client.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.clip = function() {
    return _clientClip.apply(this, _args(arguments));
  };
  /**
 * Unregister the clipboard actions of previously registered element(s) on the page.
 * If no elements are provided, ALL registered elements will be unregistered.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.unclip = function() {
    return _clientUnclip.apply(this, _args(arguments));
  };
  /**
 * Get all of the elements to which this client is clipped.
 *
 * @returns array of clipped elements
 */
  ZeroClipboard.prototype.elements = function() {
    return _clientElements.apply(this, _args(arguments));
  };
  /**
 * Self-destruct and clean up everything for a single client.
 * This will NOT destroy the embedded Flash object.
 *
 * @returns `undefined`
 */
  ZeroClipboard.prototype.destroy = function() {
    return _clientDestroy.apply(this, _args(arguments));
  };
  /**
 * Stores the pending plain text to inject into the clipboard.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.setText = function(text) {
    if (!_clientMeta[this.id]) {
      throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");
    }
    ZeroClipboard.setData("text/plain", text);
    return this;
  };
  /**
 * Stores the pending HTML text to inject into the clipboard.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.setHtml = function(html) {
    if (!_clientMeta[this.id]) {
      throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");
    }
    ZeroClipboard.setData("text/html", html);
    return this;
  };
  /**
 * Stores the pending rich text (RTF) to inject into the clipboard.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.setRichText = function(richText) {
    if (!_clientMeta[this.id]) {
      throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");
    }
    ZeroClipboard.setData("application/rtf", richText);
    return this;
  };
  /**
 * Stores the pending data to inject into the clipboard.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.setData = function() {
    if (!_clientMeta[this.id]) {
      throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");
    }
    ZeroClipboard.setData.apply(this, _args(arguments));
    return this;
  };
  /**
 * Clears the pending data to inject into the clipboard.
 * If no `format` is provided, all pending data formats will be cleared.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.clearData = function() {
    if (!_clientMeta[this.id]) {
      throw new Error("Attempted to clear pending clipboard data from a destroyed ZeroClipboard client instance");
    }
    ZeroClipboard.clearData.apply(this, _args(arguments));
    return this;
  };
  /**
 * Gets a copy of the pending data to inject into the clipboard.
 * If no `format` is provided, a copy of ALL pending data formats will be returned.
 *
 * @returns `String` or `Object`
 */
  ZeroClipboard.prototype.getData = function() {
    if (!_clientMeta[this.id]) {
      throw new Error("Attempted to get pending clipboard data from a destroyed ZeroClipboard client instance");
    }
    return ZeroClipboard.getData.apply(this, _args(arguments));
  };
  if (typeof define === "function" && define.amd) {
    define(function() {
      return ZeroClipboard;
    });
  } else if (typeof module === "object" && module && typeof module.exports === "object" && module.exports) {
    module.exports = ZeroClipboard;
  } else {
    window.ZeroClipboard = ZeroClipboard;
  }
})(function() {
  return this || window;
}());
},{}],6:[function(require,module,exports){
/*jslint browser: true*/
/*jshint -W055 */
/*global console, alert*/

/*
 * For each disease area there will be 4 stages: Diagnosis, Monitoring, Treatment and Exclusions.
 * Each stage gets a single panel on the front screen.
 * Clicking on a panel takes you to a screen specific to that stage, but similar in layout and content
 *  to all the others.
 */

var template = require('./src/template.js'),
  main = require('./src/main.js');

//TODO not sure why i did this - was in local variable
//maybe a separate module
//window.location = window.history.location || window.location;
/********************************************************
 *** Shows the pre-load image and slowly fades it out. ***
 ********************************************************/
$(window).load(function() {
  $('.loading-container').fadeOut(1000, function() {
    //$(this).remove();
  });
});

/******************************************
 *** This happens when the page is ready ***
 ******************************************/
$(document).on('ready', function() {
  //Grab the hash if exists - IE seems to forget it
  main.hash = location.hash;

  //CHANGE THIS - added to spoof login
  location.hash="";
  main.hash="";
  $('#signin').on('click', function(){
    if($('#inpEmail').val().length<8) alert("Please enter your email address.");
    else {
      console.log('{"event":{"what":"login","when":' + new Date().getTime() + ',"who":"' + $("#inpEmail").val() + '"}}');
      $.ajax({
        type: "POST",
        url: "http://130.88.250.206:9100/pingr",
        data: '{"event":{"what":"login","when":' + new Date().getTime() + ',"who":"' + $("#inpEmail").val() + '"}}',
        success: function(d){console.log(d);},
        dataType: "json",
        contentType:"application/json"
      });

      var obj = JSON.parse(localStorage.bb);
      obj.email=$('#inpEmail').val();
      localStorage.bb = JSON.stringify(obj);


      history.pushState(null, null, '#overview');
      template.loadContent('#overview');
    }
  });
  $('#inpEmail').on('keyup', function(){
    var code = e.which;
    if(code==13){
      $('#signin').click();
    }
  });

  //Load the data then wire up the events on the page
  main.init();

  //Sorts out the data held locally in the user's browser
  if (!localStorage.bb) localStorage.bb = JSON.stringify({});
  var obj = JSON.parse(localStorage.bb);
  if (!obj.version || obj.version !== main.version) {
    localStorage.bb = JSON.stringify({
      "version": main.version
    });
  }

  if(JSON.parse(localStorage.bb).email) {
    $('#inpEmail').val(JSON.parse(localStorage.bb).email);
  }

  $('[data-toggle="tooltip"]').tooltip({
    container: 'body',
    delay: {
      "show": 500,
      "hide": 100
    },
    html: true
  });
  $('[data-toggle="lone-tooltip"]').tooltip({
    container: 'body',
    delay: {
      "show": 300,
      "hide": 100
    }
  });
  $('[data-toggle="lone-tooltip"]').on('shown.bs.tooltip', function(e) {
    $('[data-toggle="tooltip"]').not(this).tooltip('hide');
  });

  //ensure on first load the login screen is cached to the history
  history.pushState(null, null, '');
});

},{"./src/main.js":13,"./src/template.js":36}],7:[function(require,module,exports){
var data = require('./data.js'),
  lookup = require('./lookup.js'),
  chart = require('./chart.js'),
  log = require('./log.js'),
  Mustache = require('mustache'),
  ZeroClipboard = require('zeroclipboard');

var base = {

  //object for keeping track what is in each panel to prevent unnecessary redraws
  panels: {},

  selectTab: function(id) {
    var href = $('#mainTab li.active a').data("href");
    $('#mainTab li.active').removeClass('active').find('a').attr("href", href);
    $('#mainTab li[data-id="' + id + '"]').addClass('active').find('a').removeAttr("href");
  },

  createPanel: function(templateSelector, data, templates) {
    var tempMust = templateSelector.html();
    Mustache.parse(tempMust); // optional, speeds up future uses
    if (templates) {
      for (var o in templates) {
        if (templates.hasOwnProperty(o)) {
          Mustache.parse(templates[o]);
        }
      }
    }
    var rendered = Mustache.render(tempMust, data, templates);
    return rendered;
  },

  createPanelShow: function(templateSelector, panelSelector, data, templates) {
    var rendered = base.createPanel(templateSelector, data, templates);
    panelSelector.html(rendered).show();
  },

  showPathwayStageOverviewPanel: function(location, enableHover, pathwayId, pathwayStage) {
    var standards = [];
    for (var standard in data[pathwayId][pathwayStage].standards) {
      var denom = data.getDenominatorForStandard(pathwayId, pathwayStage);
      var num = denom - data.getNumeratorForStandard(pathwayId, pathwayStage, standard);
      standards.push({
        "standard": data[pathwayId][pathwayStage].standards[standard].tab.title,
        "standardKey": standard,
        "tooltip": data[pathwayId][pathwayStage].standards[standard]["standard-met-tooltip"],
        "numerator": num,
        "denominator": denom,
        "percentage": (num * 100 / denom).toFixed(0)
      });
    }

    base.createPanelShow($('#pathway-stage-overview-panel'), location, {
      pathway: data.pathwayNames[pathwayId],
      pathwayStage: pathwayStage,
      pathwayStageName: lookup.categories[pathwayStage].display,
      pathwayNameShort: pathwayId,
      title: data[pathwayId][pathwayStage].text.panel.text,
      standards: standards
    }, {
      "row": $('#overview-panel-table-row').html()
    });

    $('#' + pathwayStage + '-trend-toggle').on('click', function(e) {
      if ($(this).text() === "Trend") {
        $(this).text("Table");
        $('#' + pathwayStage + '-chart-table').hide();
        $('#' + pathwayStage + '-chart-wrapper').show();
      } else {
        $(this).text("Trend");
        $('#' + pathwayStage + '-chart-table').show();
        $('#' + pathwayStage + '-chart-wrapper').hide();
      }
      e.stopPropagation();
    });

    chart.drawOverviewChart(pathwayId, pathwayStage, enableHover);

  },

  hideFooter: function() {
    $('footer').hide();
  },

  showFooter: function() {
    $('footer').show();
  },

  hideTooltips: function() {
    $('[data-toggle="tooltip"]').tooltip('hide');
  },

  wireUpTooltips: function() {
    $('[data-toggle="tooltip"]').tooltip('hide');
    $('.tooltip').remove();

    $('[data-toggle="tooltip"]').tooltip({
      container: 'body',
      delay: {
        "show": 500,
        "hide": 100
      },
      html: true
    });
    $('[data-toggle="lone-tooltip"]').tooltip({
      container: 'body',
      delay: {
        "show": 300,
        "hide": 100
      }
    });
    $('[data-toggle="lone-tooltip"]').on('shown.bs.tooltip', function(e) {
      $('[data-toggle="tooltip"]').not(this).tooltip('hide');
    });
    $('.patient-row-tooltip').on('show.bs.tooltip', function(e) {
      if ($(this).hasClass('highlighted')) {
        e.stopPropagation();
        e.preventDefault();
      }
    });
  },

  setupClipboard: function(selector, destroy) {
    if (destroy) ZeroClipboard.destroy(); //tidy up

    var client = new ZeroClipboard(selector);

    client.on('ready', function() {
      client.on('aftercopy', function(event) {
        console.log('Copied text to clipboard: ' + event.data['text/plain']);
        $(event.target).tooltip('hide');
        $(event.target).popover({
          trigger: 'manual',
          template: '<div class="popover" role="tooltip"><div class="arrow"></div><div class="popover-content"></div></div>',
          delay: {
            show: 500,
            hide: 500
          }
        });
        clearTimeout(lookup.tmp);
        $(event.target).popover('show');
        lookup.tmp = setTimeout(function() {
          $(event.target).popover('hide');
        }, 600);
      });
    });
  },

  clearBox: function() {
    //Clear the patient search box
    $('.typeahead').typeahead('val', '');
  },

  /********************************
   * Modals
   ********************************/

  launchModal: function(data, label, value, reasonText, callbackOnSave, callbackOnCancel, callbackOnUndo) {
    var template = $('#modal-why').html();
    Mustache.parse(template); // optional, speeds up future uses

    var reasonTemplate = $('#modal-why-item').html();
    Mustache.parse(reasonTemplate);

    if (data.reasons && data.reasons.length > 0) data.hasReasons = true;

    var rendered = Mustache.render(template, data, {
      "item": reasonTemplate
    });
    $('#modal').html(rendered);

    if (reasonText) {
      $('#modal textarea').val(reasonText);
    }
    lookup.modalSaved = false;
    lookup.modalUndo = false;

    $('#modal .modal').off('click', '.undo-plan').on('click', '.undo-plan', function(e) {
      lookup.modalUndo = true;
    }).off('submit', 'form').on('submit', 'form', {
      "label": label
    }, function(e) {
      if (!e.data.label) e.data.label = "team";
      var reason = $('input:radio[name=reason]:checked').val();
      var reasonText = $('#modal textarea').val();

      log.recordFeedback(data.pathwayId, e.data.label, value, reason, reasonText);

      lookup.modalSaved = true;

      e.preventDefault();
      $('#modal .modal').modal('hide');
    }).modal();

    $('#modal').off('hidden.bs.modal').on('hidden.bs.modal', {
      "label": label
    }, function(e) {
      if (lookup.modalSaved) {
        lookup.modalSaved = false;
        if (callbackOnSave) callbackOnSave();
      } else if (lookup.modalUndo) {
        lookup.modalUndo = false;
        if (callbackOnUndo) callbackOnUndo();
      } else {
        //uncheck as cancelled. - but not if value is empty as this unchecks everything - or if already checked
        if (callbackOnCancel) callbackOnCancel();
      }
    });
  },

  sortSuggestions: function(suggestions) {
    suggestions.sort(function(a, b) {
      if (a.agree && !a.done) {
        if (b.agree && !b.done) return 0;
        return -1;
      } else if (!a.agree && !a.disagree) {
        if (!b.agree && !b.disagree) return 0;
        if (b.agree && !b.done) return 1;
        return -1;
      } else if (a.agree && a.done) {
        if (b.agree && b.done) return 0;
        if (b.disagree) return -1;
        return 1;
      } else {
        if (b.disagree) return 0;
        return 1;
      }
    });

    return suggestions;
  },

  addDisagreePersonalTeam: function(plans) {
    for (var i = 0; i < plans.length; i++) {
      if (plans[i].agree) {
        plans[i].disagree = false;
      } else if (plans[i].agree === false) {
        plans[i].disagree = true;
      }
    }
    return plans;
  },

  suggestionList: function(ids) {
    return ids.map(function(val) {
      return {
        "id": val.id || val,
        "text": log.text[val.id || val].text,
        "subsection": val.subsection
      };
    }).filter(function(v, i) { //RW to always limit to 3
      return i < 3;
    });
  },

  mergeIndividualStuff: function(suggestions, patientId) {
    var localActions = log.listActions();
    if (!localActions[patientId]) return suggestions;

    for (var i = 0; i < suggestions.length; i++) {
      if (localActions[patientId][suggestions[i].id]) {
        if (localActions[patientId][suggestions[i].id].agree) {
          suggestions[i].agree = true;
        } else if (localActions[patientId][suggestions[i].id].agree === false) {
          suggestions[i].disagree = true;
        }
        if (localActions[patientId][suggestions[i].id].done) suggestions[i].done = localActions[patientId][suggestions[i].id].done;
      }
    }
    return suggestions;
  },

  switchTo110Layout: function() {
    if (base.layout === "110") return;
    base.layout = "110";
    farLeftPanel.removeClass('col-lg-3 col-lg-8').addClass('col-lg-6').show();
    topPanel.hide();
    topLeftPanel.hide();
    bottomLeftPanel.hide();
    topRightPanel.hide();
    bottomRightPanel.hide();
    midPanel.hide();
    farRightPanel.removeClass('col-xl-4').addClass('col-xl-8').show();
  },

  switchTo101Layout: function() {
    if (base.layout === "101") return;
    base.layout = "101";
    farLeftPanel.removeClass('col-lg-3 col-lg-6 col-xl-4').addClass('col-lg-8').show();
    topPanel.hide();
    topLeftPanel.hide();
    bottomLeftPanel.hide();
    topRightPanel.hide();
    bottomRightPanel.hide();
    midPanel.hide();
    farRightPanel.removeClass('col-xl-8').addClass('col-xl-4').show();
  },



  switchTo221Layout: function() {
    if (base.layout === "221") return;
    base.layout = "221";
    farLeftPanel.hide();
    topPanel.hide();
    topLeftPanel.addClass('col-xl-6').show();
    bottomLeftPanel.addClass('col-xl-6').show();
    topRightPanel.removeClass('col-xl-12').addClass('col-xl-6').show();
    bottomRightPanel.removeClass('col-xl-12').addClass('col-xl-6').show();
    midPanel.removeClass('col-xl-4').addClass('col-xl-8').show();
    farRightPanel.removeClass('col-xl-8').addClass('col-xl-4').show();
  },

  switchTo21Layout: function() {
    if (base.layout === "21") return;
    base.layout = "21";
    farLeftPanel.hide();
    topPanel.hide();
    topLeftPanel.hide();
    bottomLeftPanel.hide();
    topRightPanel.removeClass('col-xl-6').addClass('col-xl-12').show();
    bottomRightPanel.removeClass('col-xl-6').addClass('col-xl-12').show();
    midPanel.removeClass('col-xl-4').addClass('col-xl-8').show();
    farRightPanel.removeClass('col-xl-8').addClass('col-xl-4').show();
  },

  wireUpStandardDropDown: function(pathwayId, pathwayStage, standard, callback) {
    var breaches = data.options.filter(function(val) {
      return val.pathwayId === pathwayId && val.pathwayStage === pathwayStage && val.standard === standard;
    });

    if (breaches.length > 0) $('select').val(breaches[0].value);

    $('select').select2({
      templateResult: base.formatStandard,
      minimumResultsForSearch: Infinity
    });
    $('span.select2-selection__rendered').attr("title", "");
    $('select').on('change', function() {
      var localData = $(this).find(':selected').data();
      callback(localData.pathwayId, localData.pathwayStage, localData.standard, data.patientId);
    }).on("select2:open", function(e) {
      base.wireUpTooltips();
    });
  },

  formatStandard: function(standard) {
    if (!standard.id) {
      return standard.text;
    }
    var localData = $(standard.element).data();
    // Not relevant
    var standardHtml = '';
    //if diagnosis opportunity then not relevant for other stages
    //if no mention anywhere then not relevant for that disease
    switch (data.getPatientStatus(data.patientId, localData.pathwayId, localData.pathwayStage, localData.standard)) {
      case "ok":
        standardHtml = '<span class="standard-achieved" data-toggle="tooltip" data-placement="left" title="' + data[localData.pathwayId][localData.pathwayStage].standards[localData.standard]["dropdown-tooltip"] + ' - QUALITY INDICATOR ACHIEVED">' + standard.text + ' <i class="fa fa-smile-o" style="color:green"></i></span>';
        break;
      case "missed":
        standardHtml = '<span class="standard-missed" data-toggle="tooltip" data-placement="left" title="' + data[localData.pathwayId][localData.pathwayStage].standards[localData.standard]["dropdown-tooltip"] + ' - IMPROVEMENT OPPORTUNITY EXISTS FOR THIS PATIENT">' + standard.text + ' <i class="fa fa-flag" style="color:red"></i></span>';
        break;
      case "not":
        standardHtml = '<span class="standard-not-relevant" data-toggle="tooltip" data-placement="left" title="' + data[localData.pathwayId][localData.pathwayStage].standards[localData.standard]["dropdown-tooltip"] + ' - STANDARD NOT RELEVANT TO THIS PATIENT">' + standard.text + ' <i class="fa fa-meh-o" style="color:gray"></i></span>';
        break;
    }
    var $standard = $(standardHtml);
    return $standard;
  },

  updateTitle: function(title){
    $('#title-left').html(title);
    $('#title-right').html("");
  },
  /*updateTitle: function(title, tooltip) {
    var titles = title;
    if (typeof title === "string") {
      titles = [{
        title: title,
        tooltip: tooltip
      }];
    }
    var content = titles.map(function(t, idx) {
      return idx === titles.length - 1 ? '<span title="' + t.tooltip + '">' + t.title + '</span>' : '<a href="' + t.url + '" title="' + t.tooltip + '">' + t.title + '</a>';
    }).join(" > ");

    $('.pagetitle').html(content);
  },*/

  hideAllPanels: function() {
    topLeftPanel.hide();
    bottomLeftPanel.hide();
    topRightPanel.hide();
    bottomRightPanel.hide();
    farLeftPanel.hide();
    farRightPanel.hide();
    topPanel.hide();
  },

  hidePanels: function(panel) {
    panel.children().hide();
  },

  updateTab: function(tab, value, url) {
    var tabElement = $('#mainTab a[data-href="#' + tab + '"]');
    tabElement.html(tabElement.text().split(":")[0] + ":<br><span><strong>" + value + "</strong></span>");
    tabElement.data("href", "#" + tab + "/" + url);
  },

  addFullPage: function(panel) {
    panel.fullpage({ verticalCentered: false, paddingBottom: '80px', scrollBar: true });

    $('.fp-down').off('click').on('click', function() {
      $.fn.fullpage.moveSectionDown();
    });

    $('.fp-up').off('click').on('click', function() {
      $.fn.fullpage.moveSectionUp();
    });
  },

  removeFullPage: function(panel) {
    if (panel.children('.section').length === 0) return;
    if ($.fn.fullpage && $.fn.fullpage.destroy) $.fn.fullpage.destroy('all'); //tidy up before doing it again
  },

  showLoading: function(){
    $('.loading-container').show();
    $('#title-row').hide();
  },

  hideLoading: function(){
    $('.loading-container').fadeOut(1000);
    $('#title-row').fadeIn(1000);
  },

};

module.exports = base;

},{"./chart.js":8,"./data.js":9,"./log.js":11,"./lookup.js":12,"mustache":4,"zeroclipboard":5}],8:[function(require,module,exports){
var Highcharts = require('highcharts/highstock'),
  data = require('./data.js'),
  lookup = require('./lookup.js'),
  log = require('./log.js'),
  Mustache = require('mustache');

console.log("chart.js: data.lastloader= " + data.lastloader);
data.lastloader = "chart.js";

var cht = {

  destroyCharts: function(charts) {
    for (var i = 0; i < charts.length; i++) {
      if (lookup.charts[charts[i]]) {
        lookup.charts[charts[i]].destroy();
        delete lookup.charts[charts[i]];
      }
    }
  },

  drawTrendChart: function(patientId, pathwayId, pathwayStage, standard) {
    var i, j;
    cht.destroyCharts(['chart-demo-trend']);
    if (!data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[0]]) {
      $('#chart-demo-trend').html('No data for this patients');
      $('#chart-demo-trend').parent().find('.table-chart-toggle').hide();
      return;
    }

    var chartData = data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[0]];
    var tableData = [];
    for (i = 1; i < data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[0]][0].length; i++) {
      tableData.push({
        "item": data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[0]][1][0],
        "value": data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[0]][1][i],
        "date": data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[0]][0][i]
      });
    }
    for (i = 1; i < data[pathwayId][pathwayStage].standards[standard].chart.length; i++) {
      chartData.push(data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[i]][1]); //RW TODO assumption here that all dates are the same
      for (j = 1; j < data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[0]][0].length; j++) {
        tableData.push({
          "item": data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[i]][1][0],
          "value": data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[i]][1][j],
          "date": data.patients[patientId][data[pathwayId][pathwayStage].standards[standard].chart[0]][0][j]
        });
      }
    }
    var chartOptions = {
      bindto: '#chart-demo-trend',
      data: {
        xs: {},
        classes: {},
        columns: chartData.slice()
      },
      zoom: {
        enabled: true
      },
      line: {
        connectNull: false
      },
      axis: {
        x: {
          type: 'timeseries',
          tick: {
            fit: false,
            format: '%d-%m-%Y',
            count: 5
          },
          max: new Date()
        },
        y: {
          label: {
            text: data[pathwayId][pathwayStage].standards[standard].chartUnits,
            position: 'outer-middle'
          }
        }
      }
    };

    var maxValue = 0;
    var standardItems = [];

    for (i = 1; i < chartOptions.data.columns.length; i++) {
      chartOptions.data.xs[chartOptions.data.columns[i][0]] = "x";
      standardItems.push(chartOptions.data.columns[i][0]);

      for (j = 1; j < chartOptions.data.columns[i].length; j++) {
        if (parseFloat(chartOptions.data.columns[i][j]) > maxValue) maxValue = parseFloat(chartOptions.data.columns[i][j]);
      }
    }

    chartOptions.tooltip = {
      format: {
        value: function(value, ratio, id) {
          var text = standardItems.indexOf(id) > -1 ? value : "";
          return text;
        }
      }
    };

    var lines = null;
    var axisnum = 1;
    if (data.patients[patientId].contacts) {
      for (i = 0; i < data.patients[patientId].contacts.length; i++) {
        chartOptions.data.classes[data.patients[patientId].contacts[i].text] = 'larger';
        if (!chartOptions.data.xs[data.patients[patientId].contacts[i].text]) {
          chartOptions.data.xs[data.patients[patientId].contacts[i].text] = "x" + axisnum;
          chartOptions.data.columns.push(["x" + axisnum, data.patients[patientId].contacts[i].value]);
          chartOptions.data.columns.push([data.patients[patientId].contacts[i].text, (maxValue * 1.1).toString()]);
          axisnum++;
        } else {
          var axis = chartOptions.data.xs[data.patients[patientId].contacts[i].text];
          for (j = 1; j < chartOptions.data.columns.length; j++) {
            if (chartOptions.data.columns[j][0] === axis) {
              chartOptions.data.columns[j].push(data.patients[patientId].contacts[i].value);
            } else if (chartOptions.data.columns[j][0] === data.patients[patientId].contacts[i].text) {
              chartOptions.data.columns[j].push((maxValue * 1.1).toString());
            }
          }
        }
        tableData.push({
          "item": "Event",
          "value": data.patients[patientId].contacts[i].text,
          "date": data.patients[patientId].contacts[i].value
        });
      }
    }

    var patientEvents = log.getEvents().filter(function(val) {
      return val.id === patientId;
    });
    if (patientEvents.length > 0) {

      for (i = 0; i < patientEvents.length; i++) {
        chartOptions.data.classes[patientEvents[i].name] = 'larger';
        if (!chartOptions.data.xs[patientEvents[i].name]) {
          chartOptions.data.xs[patientEvents[i].name] = "x" + axisnum;
          chartOptions.data.columns.push(["x" + axisnum, patientEvents[i].date.substr(0, 10)]);
          chartOptions.data.columns.push([patientEvents[i].name, (maxValue * 1.1).toString()]);
          axisnum++;
        } else {
          var axis2 = chartOptions.data.xs[patientEvents[i].name];
          for (j = 1; j < chartOptions.data.columns.length; j++) {
            if (chartOptions.data.columns[j][0] === axis2) {
              chartOptions.data.columns[j].push(patientEvents[i].date.substr(0, 10));
            } else if (chartOptions.data.columns[j][0] === patientEvents[i].name) {
              chartOptions.data.columns[j].push((maxValue * 1.1).toString());
            }
          }
        }
        tableData.push({
          "item": "Event",
          "value": patientEvents[i].name,
          "date": patientEvents[i].date.substr(0, 10)
        });
      }
    }

    tableData.sort(function(a, b) {
      if (a.date === b.date) return 0;
      else return a.date < b.date ? 1 : -1;
    });
    //draw Table
    $('#table-demo-trend').html(Mustache.render($('#value-trend-panel-table').html(), {
      "items": tableData
    }, {
      "item-row": $('#value-trend-panel-table-row').html()
    }));

    //draw charts in separate thread and with delay to stop sluggish appearance
    setTimeout(function() {
      lookup.charts['chart-demo-trend'] = c3.generate(chartOptions);
    }, 1);
  },

  selectPieSlice: function(chart, d) {
    lookup.chartClicked = true;
    $('#' + chart + ' path.c3-bar').attr('class', function(index, classNames) {
      return classNames + ' _unselected_';
    });
    lookup.charts[chart].select([d.id], [d.index], true);

    farRightPanel.fadeOut(200, function() {
      var template = $('#patient-panel-placeholder').html();
      farRightPanel.html(Mustache.render(template)).show();
    });
  },

  drawOverviewChart: function(pathwayId, pathwayStage, enableHover) {
    cht.destroyCharts([pathwayStage + '-chart']);
    setTimeout(function() {
      lookup.charts[pathwayStage + '-chart'] = c3.generate({
        bindto: '#' + pathwayStage + '-chart',
        data: {
          x: 'x',
          columns: data[pathwayId][pathwayStage].trend
        },
        zoom: {
          enabled: true
        },
        tooltip: {
          format: {
            title: function(x) {
              return x.toDateString() + (enableHover ? '<br>Click for more detail' : '');
            },
            value: function(value) {
              return enableHover ? value + '%' : undefined;
            }
          }
        },
        axis: {
          x: {
            type: 'timeseries',
            tick: {
              format: '%d-%m-%Y',
              count: 7,
              culling: {
                max: 4
              }
            },
            label: {
              text: 'Date',
              position: 'outer-center'
            }
          },
          y: {
            min: 0,
            label: {
              text: 'Proportion (%)',
              position: 'outer-middle'
            }
          }
        },
        point: {
          show: false
        },
        size: {
          height: null
        }
      });
    }, 1);
  },

  drawBenchmarkChart: function(element, data) {
    cht.destroyCharts([element + '-chart']);
    setTimeout(function() {
      lookup.charts[element + '-chart'] = c3.generate({
        bindto: '#' + element,
        size: {
          height: 200
        },
        data: data,
        axis: {
          x: {
            type: 'category',
            tick: {
              rotate: 60,
              multiline: false
            }
          },
          y: {
            label: {
              text: '% of patients meeting the target',
              position: 'outer-middle'
            }
          }
        },
        grid: {
          y: {
            show: true
          }
        }
      });
    }, 1);
  },

  drawPerformanceTrendChart: function(element, data) {
    cht.destroyCharts([element + '-chart']);
    setTimeout(function() {
      lookup.charts[element + '-chart'] = c3.generate({
        bindto: '#' + element,
        size: {
          height: 200
        },
        data: data,
        axis: {
          x: {
            type: 'timeseries',
            tick: {
              format: '%Y-%m-%d',
              rotate: 60,
              multiline: false
            },
            height: 60
          },
          y: {
            label: {
              text: "Performance",
              position: 'outer-middle'
            }
          }
        },
        grid: {
          x: {
            show: true
          },
          y: {
            show: true
          }
        }
      });
    }, 1);
  },

  drawBenchmarkChartHC: function(element, data) {

    data = [
      { x: 49.9, p: 'P1', local: true },
      { x: 71.5, p: 'P2', local: true },
      { x: 16.4, p: 'P3', local: true },
      { x: 29.2, p: 'P4', local: true },
      { x: 44.0, p: 'P5', local: true },
      { x: 76.0, p: 'P6', local: true },
      { x: 35.6, p: 'YOU', local: true },
      { x: 48.5, p: 'P7', local: true },
      { x: 26.4, p: 'P8', local: true },
      { x: 94.1, p: 'P9', local: true },
      { x: 95.6, p: 'P10' },
      { x: 54.0, p: 'P11' },
      { x: 39.9, p: 'P12' },
      { x: 61.5, p: 'P13' },
      { x: 6.4, p: 'P14' },
      { x: 19.2, p: 'P15' },
      { x: 34.0, p: 'P16' },
      { x: 66.0, p: 'P17' },
      { x: 25.6, p: 'P18' },
      { x: 38.5, p: 'P19' },
      { x: 36.4, p: 'P20' },
      { x: 84.1, p: 'P21' },
      { x: 85.6, p: 'P22' },
      { x: 64.0, p: 'P23' }
    ];
    data.sort(function(a, b) {
      return a.x - b.x;
    });

    var local = true;
    var bChart = $('#' + element).highcharts({
        chart: {
          type: 'column',
          events: {
            load: function() {
              var thisChart = this;
              thisChart.renderer.button('Toggle neighbourhood / CCG', thisChart.plotWidth - 100, 0, function() {
                local = !local;
                thisChart.xAxis[0].categories = data.filter(function(v) {
                  if (local) return v.local;
                  else return true;
                }).map(function(v) {
                  return v.p;
                });
                thisChart.series[0].setData(data.filter(function(v) {
                  if (local) return v.local;
                  else return true;
                }).map(function(v) {
                  if (v.p === "YOU") return { y: v.x, color: "red" };
                  else return v.x;
                }));
              }).add();
            }
          }
        },
        title: { text: 'Benchmark' },
        xAxis: {
          categories: data.filter(function(v) {
            return v.local === local;
          }).map(function(v) {
            return v.p;
          }),
          crosshair: true
        },
        yAxis: {
          min: 0,
          max: 100,
          title: { text: '% patients meeting target' }
        },
        tooltip: {
          headerFormat: '<span style="font-size:10px">Practice: <b>{point.key}</b></span><table>',
          pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
            '<td style="padding:0"><b>{point.y:.1f}%</b></td></tr>',
          footerFormat: '</table>',
          shared: true,
          useHTML: true
        },
        plotOptions: {
          column: {
            pointPadding: 0.2,
            borderWidth: 0
          }
        },
        legend: {
          enabled: false
        },
        series: [{
          name: 'Performance',
          data: data.filter(function(v) {
            return v.local === local;
          }).map(function(v) {
            if (v.p === "YOU") return { y: v.x, color: "red" };
            else return v.x;
          })
      }]
      },
      function(chart) { // on complete
        var textX = chart.plotLeft + (chart.plotWidth * 0.5);
        var textY = chart.plotTop + (chart.plotHeight * 0.5);

        var span = '<span id="pieChartInfoText" style="position:absolute; text-align:center;-ms-transform: rotate(335deg);-webkit-transform: rotate(335deg);transform: rotate(335deg);">';
        span += '<span style="font-size: 64px">Coming Soon!</span>';
        span += '</span>';

        $("#benchmark-chart").append(span);
        span = $('#pieChartInfoText');
        span.css('left', textX + (span.width() * -0.5));
        span.css('top', textY + (span.height() * -0.5));
      });

  },

  drawPerformanceTrendChartHC: function(element, data) {

    /// data is
    // {
    //  "values":
    //    ["x", "2015-08-24", "2015-08-23",...
    //    ["numerator", 35, 37, 33, 32, 31,...
    //    ["denominator", 135, 133, 133, 13,...
    //    ["target", 0.3, 0.3, 0...
    // }

    var target = 75,
      maxValue = target,
      maxXvalue = 0;

    var series = [
      { type: 'line', name: 'Trend', data: [] },
      { type: 'line', name: 'Prediction', data: [], dashStyle: 'dot' }
    ];

    var today = new Date();
    var lastApril = new Date();
    var aprilBeforeThat = new Date();
    var nextApril = new Date();
    if (today.getMonth() < 3) {
      //after april
      lastApril.setYear(today.getFullYear() - 1);
      aprilBeforeThat.setYear(today.getFullYear() - 1);
    } else {
      nextApril.setYear(today.getFullYear() + 1);
    }
    aprilBeforeThat.setYear(aprilBeforeThat.getFullYear() - 1);
    lastApril.setMonth(3);
    aprilBeforeThat.setMonth(3);
    nextApril.setMonth(3);
    lastApril.setDate(1);
    aprilBeforeThat.setDate(1);
    nextApril.setDate(1);

    var n = 0,
      sumX = 0,
      sumY = 0,
      sumXY = 0,
      sumXX = 0,
      sumYY = 0,
      intercept, gradient, compDate;

    if (data.values[0].filter(function(v) {
        return new Date(v).getTime() > lastApril.getTime();
      }).length > 2) compDate = new Date(lastApril.getTime());
    else compDate = new Date(aprilBeforeThat.getTime());

    data.values[0].forEach(function(v, i) {
      if (i === 0) return;
      var time = new Date(v).getTime();
      var y = +data.values[1][i] * 100 / +data.values[2][i];
      if (time >= compDate.getTime()) {
        n++;
        sumX += time;
        sumY += y;
        sumXY += time * y;
        sumXX += time * time;
        sumYY += y * y;
      }
      series[0].data.push([time, y]);
      maxValue = Math.max(maxValue, y);
      maxXvalue = Math.max(maxXvalue, time);
    });

    intercept = (sumY * sumXX - sumX * sumXY) / (n * sumXX - sumX * sumX);
    gradient = (n * sumXY - sumX * sumY) / (n * sumXX - sumX * sumX);

    var newCompDate = new Date(lastApril.getTime());
    series[1].data.push([maxXvalue, maxXvalue * gradient + intercept]);
    for (var i = 0; i < 13; i++) {
      var x = newCompDate.getTime();
      if (x < maxXvalue) {
        newCompDate.setMonth(newCompDate.getMonth() + 1);
        continue;
      }
      series[1].data.push([x, x * gradient + intercept]);
      var m = newCompDate.getMonth();
      newCompDate.setMonth(newCompDate.getMonth() + 1);
    }

    //Add line of best fit for latest data since april to next april


    //Default to last april - april


    var c = $('#' + element).highcharts({
      title: { text: '' },
      xAxis: {
        max: nextApril.getTime(),
        type: 'datetime'
      },
      yAxis: {
        title: { text: 'Quality standard performance' },
        max: maxValue + 5,
        min: 0,
        plotLines: [{
          value: target,
          color: 'green',
          dashStyle: 'shortdash',
          width: 2,
          label: {
            text: 'Target - ' + (target) + '%'
          },
        }]
      },
      legend: { enabled: true },
      tooltip: {
        pointFormat: '<span style="color:{point.color}">\u25CF</span> {series.name}: <b>{point.y:.2f}%</b><br/>'
      },

      navigator: {
        enabled: true
      },

      series: series
    });

    c.highcharts().axes[0].setExtremes(aprilBeforeThat.getTime(), lastApril.getTime(), undefined, false);

  },

  drawAnalytics: function(element, data, selectSeriesFn) {

    cht.cloneToolTip = null;
    cht.cloneToolTip2 = null;

    $('#' + element).highcharts({
      chart: {
        type: "column",
        backgroundColor: "#F3F9F9",
        height: 200,
        events: {
          click: function(event) {
            selectSeriesFn();

            if (cht.cloneToolTip) {
              this.container.firstChild.removeChild(cht.cloneToolTip);
              cht.cloneToolTip = null;
            }
            if (cht.cloneToolTip2) {
              cht.cloneToolTip2.remove();
              cht.cloneToolTip2 = null;
            }

            return false;
          }
        }
      },
      title: {
        text: 'Patients not meeting the standard'
      },
      subtitle: {
        text: document.ontouchstart === undefined ?
          'Click a column to filter the patient list' : 'Tap a column to filter the patient list'
      },
      xAxis: {
        categories: data.map(function(v, i) {
          return v[0];
        })
      },
      yAxis: {
        title: {
          text: 'Number of patients'
        },
        stackLabels: {
          enabled: true,
          style: {
            fontWeight: 'bold',
            color: (Highcharts.theme && Highcharts.theme.textColor) || 'gray'
          }
        }
      },
      legend: {
        enabled: false
      },

      tooltip: {
        animation: false,

        formatter: function() {
          return this.point.desc.match(/.{1,40}[^ ]* ?/g).join("<br>");
        },

        style: {
          "whiteSpace": "normal"
        },

        useHTML: true
      },

      plotOptions: {

        column: {
          dataLabels: {
            enabled: true,
            color: 'black'
          }
        },

        series: {
          cursor: 'pointer',
          point: {
            events: {
              click: function(event) {
                var numPoints = this.series.points.length;

                selectSeriesFn(this.category);

                if (cht.cloneToolTip) {
                  this.series.chart.container.firstChild.removeChild(cht.cloneToolTip);
                }
                if (cht.cloneToolTip2) {
                  cht.cloneToolTip2.remove();
                }
                cht.cloneToolTip = this.series.chart.tooltip.label.element.cloneNode(true);
                this.series.chart.container.firstChild.appendChild(cht.cloneToolTip);

                cht.cloneToolTip2 = $('.highcharts-tooltip').clone();
                $(this.series.chart.container).append(cht.cloneToolTip2);

                return false;
              }
            }
          }
        }
      },

      series: [{
        data: data.map(function(v, i) {
          return {
            y: v[2],
            desc: v[1],
            color: Highcharts.getOptions().colors[i]
          };
        })
      }]
    });
  }

};

module.exports = cht;

},{"./data.js":9,"./log.js":11,"./lookup.js":12,"highcharts/highstock":2,"mustache":4}],9:[function(require,module,exports){
var log = require('./log.js'),
  lookup = require('./lookup.js');


var _getAllIndicatorData = function(callback) {
  var r = Math.random();
  $.getJSON("data/indicators.json?v=" + r, function(file) {
    dt.indicators = file;

    dt.indicators.forEach(function(indicator) {
      var percentage = Math.round(100 * indicator.values[1][1] * 100 / indicator.values[2][1]) / 100;
      indicator.performance = indicator.values[1][1] + " / " + indicator.values[2][1] + " (" + percentage + "%)";
      indicator.target = indicator.values[3][1] * 100 + "%";
      indicator.up = percentage > Math.round(100 * indicator.values[1][2] * 100 / indicator.values[2][2]) / 100;
      var trend = indicator.values[1].map(function(val, idx) {
        return Math.round(100 * val * 100 / indicator.values[2][idx]) / 100;
      }).slice(1, 10);
      trend.reverse();
      indicator.trend = trend.join(",");
      var dates = indicator.values[0].slice(1, 10);
      dates.reverse();
      indicator.dates = dates;
    });


    callback(dt.indicators);
  });
};

var _getAllIndicatorDataSync = function(callback) {
  var r = Math.random();
  $.ajax({
    url: "data/indicators.json?v=" + r,
    async: false,
    success: function(file) {
      dt.indicators = file;

      dt.indicators.forEach(function(indicator) {
        var percentage = Math.round(100 * indicator.values[1][1] * 100 / indicator.values[2][1]) / 100;
        indicator.performance = indicator.values[1][1] + " / " + indicator.values[2][1] + " (" + percentage + "%)";
        indicator.target = indicator.values[3][1] * 100 + "%";
        indicator.up = percentage > Math.round(100 * indicator.values[1][2] * 100 / indicator.values[2][2]) / 100;
        var trend = indicator.values[1].map(function(val, idx) {
          return Math.round(100 * val * 100 / indicator.values[2][idx]) / 100;
        }).slice(1, 10);
        trend.reverse();
        indicator.trend = trend.join(",");
        var dates = indicator.values[0].slice(1, 10);
        dates.reverse();
        indicator.dates = dates;
      });

    }
  });

  return dt.indicators;
};

var _getIndicatorData = function(indicator, callback) {
  var r = Math.random();
  $.getJSON("data/idata." + indicator + ".json?v=" + r, function(file) {
    dt.indicators[indicator] = file;

    //apply which categories people belong to
    Object.keys(dt.indicators[indicator].patients).forEach(function(patient) {
      dt.indicators[indicator].patients[patient].opportunities = [];
      dt.indicators[indicator].opportunities.forEach(function(opp, idx) {
        if (opp.patients.indexOf(+patient) > -1) {
          dt.indicators[indicator].patients[patient].opportunities.push(idx);
        }
      });
    });

    callback(dt.indicators[indicator]);
  });
};

var _getIndicatorDataSync = function(indicator) {
  var r = Math.random();
  $.ajax({
    url: "data/idata." + indicator + ".json?v=" + r,
    async: false,
    success: function(file) {
      dt.indicators[indicator] = file;

      //apply which categories people belong to
      Object.keys(dt.indicators[indicator].patients).forEach(function(patient) {
        dt.indicators[indicator].patients[patient].opportunities = [];
        dt.indicators[indicator].opportunities.forEach(function(opp, idx) {
          if (opp.patients.indexOf(+patient) > -1) {
            dt.indicators[indicator].patients[patient].opportunities.push(idx);
          }
        });
      });

    }
  });
  return dt.indicators[indicator];
};

var _getFakePatientData = function(patient, callback) {
  var r = Math.random(),
    isAsync = typeof(callback) === "function";
  if (dt.patients && dt.patients.patient) {
    if (isAsync) return callback(dt.patients.patient);
    else return dt.patients.patient;
  }
  $.ajax({
    url: "data/patient.json?v=" + r,
    async: isAsync,
    success: function(file) {
      if (!dt.patients) dt.patients = {};
      dt.patients.patient = file;
      dt.patients[patient] = file;

      if (isAsync) callback(dt.patients.patient);
    }
  });
  if (!isAsync) return dt.patients.patient;
};

var _getPatientData = function(patient, callback) {
  //if callback provided do async - else do sync
  var r = Math.random(),
    isAsync = typeof(callback) === "function";

  if (dt.patients && dt.patients[patient]) {
    if (isAsync) return callback(dt.patients[patient]);
    else return dt.patients[patient];
  }

  $.ajax({
    url: "data/" + patient + ".json?v=" + r,
    async: isAsync,
    success: function(file) {
      if (!dt.patients) dt.patients = {};
      dt.patients[patient] = file;

      if (isAsync) callback(dt.patients[patient]);
    },
    error: function() {
      if (dt.patients.patient && isAsync) {
        dt.patients[patient] = dt.patients.patient;
        return callback(dt.patients.patient);
      } else if (!dt.patients.patient) {
        _getFakePatientData(patient, callback);
      }
    }
  });

  if (!isAsync) return dt.patients.patient;
};

var dt = {

  pathwayNames: {},
  diseases: [],
  options: [],
  patLookup: {},

  getPatietListForStandard: function(pathwayId, pathwayStage, standard) {
    var patients = dt.removeDuplicates(dt[pathwayId][pathwayStage].standards[standard].opportunities.reduce(function(a, b) {
      return a.patients ? a.patients.concat(b.patients) : a.concat(b.patients);
    }));
    return patients;
  },

  getPatientStatus: function(patientId, pathwayId, pathwayStage, standard) {
    if (dt.patients[patientId].breach) {
      if (dt.patients[patientId].breach.filter(function(val) {
          return val.pathwayId === pathwayId && val.pathwayStage === pathwayStage && val.standard === standard;
        }).length > 0) {
        return "missed";
      } else if (dt.patients[patientId].breach.filter(function(val) {
          return val.pathwayId === pathwayId && val.pathwayStage === "diagnosis";
        }).length > 0 && pathwayStage !== "diagnosis") {
        return "not";
      } else if (dt.patients[patientId].breach.filter(function(val) {
          return val.pathwayId === pathwayId;
        }).length > 0) {
        return "ok";
      } else {
        return "not";
      }
    } else {
      return "not";
    }
  },

  getNumeratorForStandard: function(pathwayId, pathwayStage, standard) {
    var patients = dt.getPatietListForStandard(pathwayId, pathwayStage, standard);
    return patients.length;
  },

  getDenominatorForStandard: function(pathwayId, pathwayStage) {
    var patients = dt[pathwayId][pathwayStage].patientsOk;
    for (var standard in dt[pathwayId][pathwayStage].standards) {
      var newPatients = dt.getPatietListForStandard(pathwayId, pathwayStage, standard);
      patients = patients.concat(newPatients);
    }
    return dt.removeDuplicates(patients).length;
  },

  removeDuplicates: function(array) {
    var arrResult = {};
    var rtn = [];
    for (var i = 0; i < array.length; i++) {
      arrResult[array[i]] = array[i];
    }
    for (var item in arrResult) {
      rtn.push(arrResult[item]);
    }
    return rtn;
  },

  numberOfStandardsMissed: function(patientId) {
    if (!dt.patients[patientId].breach) return 0;
    var a = dt.patients[patientId].breach.map(function(val) {
      return val.pathwayId + val.pathwayStage + val.standard;
    });
    var obj = {};
    for (var i = 0; i < a.length; i++) {
      obj[a[i]] = "";
    }
    return Object.keys(obj).length;
  },

  getAllPatients: function() {
    var pList = [],
      i, k, prop;
    for (k = 0; k < dt.diseases.length; k++) {
      for (i in lookup.categories) {
        for (prop in dt[dt.diseases[k].id][i].bdown) {
          if (dt[dt.diseases[k].id][i].bdown.hasOwnProperty(prop)) {
            pList = pList.concat(dt[dt.diseases[k].id][i].bdown[prop].patients);
          }
        }
        pList = pList.concat(dt[dt.diseases[k].id][i].patientsOk);
      }
    }
    pList = dt.removeDuplicates(pList);
    var patients = pList.map(function(patientId) {
      var ret = dt.patients[patientId];
      ret.nhsNumber = dt.patLookup ? dt.patLookup[patientId] : patientId;
      ret.patientId = patientId;
      ret.items = []; //The fields in the patient list table
      ret.items.push(dt.numberOfStandardsMissed(patientId));
      return ret;
    });

    return patients;
  },

  get: function(callback, json) {
    //get text
    $.getJSON("data/text.json?v=" + Math.random(), function(textfile) {
      dt.text = textfile.pathways;

      if (json) {
        dt.newload(json);
        if (typeof callback === 'function') callback();
      } else {
        $.getJSON("data/data.json?v=" + Math.random(), function(file) {
          dt.newload(file);
          if (typeof callback === 'function') callback();
        }).fail(function(err) {
          alert("data/data.json failed to load!! - if you've changed it recently check it's valid json at jsonlint.com");
        });
      }

    }).fail(function(err) {
      alert("data/text.json failed to load!! - if you've changed it recently check it's valid json at jsonlint.com");
    });
  },

  newload: function(file) {
    dt.indicators = file.indicators;
    dt.pathwayNames = {};

    dt.indicators.forEach(function(indicator) {
      var last = indicator.values[0].length-1;
      var pathwayId = indicator.id.split(".")[0];
      var pathwayStage = indicator.id.split(".")[1];
      var standard = indicator.id.split(".")[2];
      if (!dt.pathwayNames[pathwayId]) dt.pathwayNames[pathwayId] = "";
      var percentage = Math.round(100 * indicator.values[1][last] * 100 / indicator.values[2][last]) / 100;
      indicator.performance = {
        fraction: indicator.values[1][last] + "/" + indicator.values[2][last],
        percentage: percentage
      };
      indicator.benchmark = "90%"; //TODO magic number
      indicator.target = indicator.values[3][last] * 100 + "%";
      indicator.up = percentage > Math.round(100 * indicator.values[1][last-1] * 100 / indicator.values[2][last-1]) / 100;
      var trend = indicator.values[1].map(function(val, idx) {
        return Math.round(100 * val * 100 / indicator.values[2][idx]) / 100;
      }).slice(1, 10);
      //trend.reverse();
      indicator.trend = trend.join(",");
      var dates = indicator.values[0].slice(Math.max(1,last-10), 10);
      //dates.reverse();
      indicator.dates = dates;
      if (dt.text[pathwayId] && dt.text[pathwayId][pathwayStage] && dt.text[pathwayId][pathwayStage].standards[standard]) {
        indicator.description = dt.text[pathwayId][pathwayStage].standards[standard].description;
        indicator.tagline = dt.text[pathwayId][pathwayStage].standards[standard].tagline;
        indicator.positiveMessage = dt.text[pathwayId][pathwayStage].standards[standard].positiveMessage;
      } else {
        indicator.description = "No description specified";
        indicator.tagline = "";
      }
      indicator.aboveTarget = indicator.performance.percentage > +indicator.values[3][last]*100;

      dt.indicators[indicator.id] = { performance: indicator.performance, tagline: indicator.tagline, positiveMessage: indicator.positiveMessage, target: indicator.target, "opportunities": indicator.opportunities || [], "patients": {} };

      //apply which categories people belong to
      dt.patients = {};
      dt.patientArray = [];

      Object.keys(file.patients).forEach(function(patient) {
        dt.patientArray.push(patient);
        dt.patients[patient] = file.patients[patient];
        dt.indicators[indicator.id].patients[patient] = {};
        dt.indicators[indicator.id].patients[patient].opportunities = [];
        dt.indicators[indicator.id].opportunities.forEach(function(opp, idx) {
          if (opp.patients.indexOf(+patient) > -1) {
            dt.indicators[indicator.id].patients[patient].opportunities.push(idx);
          }
        });
      });
    });


  },

  load: function(file) {
    var d = "",
      j, k, key, data = file.diseases;

    dt = jQuery.extend(dt, data); //copy

    dt.patients = file.patients;
    dt.codes = file.codes;
    dt.patientArray = [];
    for (var o in file.patients) {
      if (file.patients.hasOwnProperty(o)) {
        dt.patientArray.push(o);
      }
    }

    for (d in data) {
      dt.pathwayNames[d] = data[d]["display-name"];
      var diseaseObject = {
        "id": d,
        "link": data[d].link ? data[d].link : "dt/" + d,
        "faIcon": data[d].icon,
        "name": data[d]["display-name"],
        "text": {
          "dt": {
            "tooltip": data[d]["side-panel-tooltip"]
          }
        }
      };
      if (data[d].monitoring.text) {
        diseaseObject.text.monitoring = data[d].monitoring.text.sidePanel;
      }
      if (data[d].treatment.text) {
        diseaseObject.text.treatment = data[d].treatment.text.sidePanel;
      }
      if (data[d].diagnosis.text) {
        diseaseObject.text.diagnosis = data[d].diagnosis.text.sidePanel;
      }
      if (data[d].exclusions.text) {
        diseaseObject.text.exclusions = data[d].exclusions.text.sidePanel;
      }
      this.diseases.push(diseaseObject);
      dt[d].suggestions = log.plan[d].team;
      $.extend(dt[d].monitoring, {
        "breakdown": [],
        "bdown": {}
      });
      $.extend(dt[d].treatment, {
        "breakdown": [],
        "bdown": {}
      });
      $.extend(dt[d].diagnosis, {
        "breakdown": [],
        "bdown": {}
      });
      $.extend(dt[d].exclusions, {
        "breakdown": [],
        "bdown": {}
      });

      if (!dt[d].monitoring.header) continue;
      for (key in dt[d].monitoring.standards) {
        this.options.push({
          "value": this.options.length,
          "pathwayId": d,
          "pathwayStage": "monitoring",
          "standard": key,
          "text": this.pathwayNames[d] + ' - ' + "Monitoring" + ' - ' + dt[d].monitoring.standards[key].tab.title
        });
        for (j = 0; j < dt[d].monitoring.standards[key].opportunities.length; j++) {
          dt[d].monitoring.bdown[dt[d].monitoring.standards[key].opportunities[j].name] = dt[d].monitoring.standards[key].opportunities[j];
          dt[d].monitoring.bdown[dt[d].monitoring.standards[key].opportunities[j].name].suggestions = log.plan[d].monitoring.individual[dt[d].monitoring.standards[key].opportunities[j].name];
          for (k = 0; k < dt[d].monitoring.standards[key].opportunities[j].patients.length; k++) {
            if (!dt.patients[dt[d].monitoring.standards[key].opportunities[j].patients[k]].breach) dt.patients[dt[d].monitoring.standards[key].opportunities[j].patients[k]].breach = [];
            dt.patients[dt[d].monitoring.standards[key].opportunities[j].patients[k]].breach.push({
              "pathwayId": d,
              "pathwayStage": "monitoring",
              "standard": key,
              "subsection": dt[d].monitoring.standards[key].opportunities[j].name
            });
          }
        }
      }
      for (key in dt[d].diagnosis.standards) {
        this.options.push({
          "value": this.options.length,
          "pathwayId": d,
          "pathwayStage": "diagnosis",
          "standard": key,
          "text": this.pathwayNames[d] + ' - ' + "Diagnosis" + ' - ' + dt[d].diagnosis.standards[key].tab.title
        });
        for (j = 0; j < dt[d].diagnosis.standards[key].opportunities.length; j++) {
          dt[d].diagnosis.bdown[dt[d].diagnosis.standards[key].opportunities[j].name] = dt[d].diagnosis.standards[key].opportunities[j];
          dt[d].diagnosis.bdown[dt[d].diagnosis.standards[key].opportunities[j].name].suggestions = log.plan[d].diagnosis.individual[dt[d].diagnosis.standards[key].opportunities[j].name];
          for (k = 0; k < dt[d].diagnosis.standards[key].opportunities[j].patients.length; k++) {
            if (!dt.patients[dt[d].diagnosis.standards[key].opportunities[j].patients[k]].breach) dt.patients[dt[d].diagnosis.standards[key].opportunities[j].patients[k]].breach = [];
            dt.patients[dt[d].diagnosis.standards[key].opportunities[j].patients[k]].breach.push({
              "pathwayId": d,
              "pathwayStage": "diagnosis",
              "standard": key,
              "subsection": dt[d].diagnosis.standards[key].opportunities[j].name
            });
          }
        }
      }
      for (key in dt[d].treatment.standards) {
        this.options.push({
          "value": this.options.length,
          "pathwayId": d,
          "pathwayStage": "treatment",
          "standard": key,
          "text": this.pathwayNames[d] + ' - ' + "Treatment" + ' - ' + dt[d].treatment.standards[key].tab.title
        });
        for (j = 0; j < dt[d].treatment.standards[key].opportunities.length; j++) {
          dt[d].treatment.bdown[dt[d].treatment.standards[key].opportunities[j].name] = dt[d].treatment.standards[key].opportunities[j];
          dt[d].treatment.bdown[dt[d].treatment.standards[key].opportunities[j].name].suggestions = log.plan[d].treatment.individual[dt[d].treatment.standards[key].opportunities[j].name];
          for (k = 0; k < dt[d].treatment.standards[key].opportunities[j].patients.length; k++) {
            if (!dt.patients[dt[d].treatment.standards[key].opportunities[j].patients[k]].breach) dt.patients[dt[d].treatment.standards[key].opportunities[j].patients[k]].breach = [];
            dt.patients[dt[d].treatment.standards[key].opportunities[j].patients[k]].breach.push({
              "pathwayId": d,
              "pathwayStage": "treatment",
              "standard": key,
              "subsection": dt[d].treatment.standards[key].opportunities[j].name
            });
          }
        }
      }
      for (key in dt[d].exclusions.standards) {
        this.options.push({
          "value": this.options.length,
          "pathwayId": d,
          "pathwayStage": "exclusions",
          "standard": key,
          "text": this.pathwayNames[d] + ' - ' + "Exclusions" + ' - ' + dt[d].exclusions.standards[key].tab.title
        });
        for (j = 0; j < dt[d].exclusions.standards[key].opportunities.length; j++) {
          dt[d].exclusions.bdown[dt[d].exclusions.standards[key].opportunities[j].name] = dt[d].exclusions.standards[key].opportunities[j];
          dt[d].exclusions.bdown[dt[d].exclusions.standards[key].opportunities[j].name].suggestions = log.plan[d].exclusions.individual[dt[d].exclusions.standards[key].opportunities[j].name];
          for (k = 0; k < dt[d].exclusions.standards[key].opportunities[j].patients.length; k++) {
            if (!dt.patients[dt[d].exclusions.standards[key].opportunities[j].patients[k]].breach) dt.patients[dt[d].exclusions.standards[key].opportunities[j].patients[k]].breach = [];
            dt.patients[dt[d].exclusions.standards[key].opportunities[j].patients[k]].breach.push({
              "pathwayId": d,
              "pathwayStage": "exclusions",
              "standard": key,
              "subsection": dt[d].exclusions.standards[key].opportunities[j].name
            });
          }
        }
      }
    }
  },

  getAllIndicatorData: function(callback) {
    if (dt.indicators) {
      return callback(dt.indicators);
    } else {
      _getAllIndicatorData(callback);
    }
  },

  getAllIndicatorDataSync: function() {
    if (dt.indicators) {
      return dt.indicators;
    } else {
      return _getAllIndicatorDataSync();
    }
  },

  getIndicatorData: function(indicator, callback) {
    if (!dt.indicators) {
      _getAllIndicatorData(function(data) {
        _getIndicatorData(indicator, callback);
      });
    } else if (dt.indicators && dt.indicators[indicator]) {
      return callback(dt.indicators[indicator]);
    } else {
      _getIndicatorData(indicator, callback);
    }
  },

  getIndicatorDataSync: function(indicator) {
    dt.getAllIndicatorDataSync();
    if (dt.indicators[indicator]) {
      return dt.indicators[indicator];
    } else {
      return _getIndicatorDataSync(indicator);
    }
  },

  getPatientData: function(patientId, callback) {
    return _getPatientData(patientId, callback);
  }

};

module.exports = dt;

},{"./log.js":11,"./lookup.js":12}],10:[function(require,module,exports){
var data = require('./data.js'),
Mustache = require('mustache');

var layout = {

  elements: {},

  //Side panel, navigation, header bar and main page
  showMainView: function() {
    //Set up navigation panel
    ////layout.showSidePanel();
    ////layout.showNavigation(data.diseases, idx, $('#main-dashboard'));

    $('#bottomnavbar').hide();
    layout.showHeaderBarItems();

    //Show main dashboard page
    layout.showPage('main-dashboard');
  },

  clearNavigation: function() {
    $("aside.left-panel nav.navigation > ul > li > ul").slideUp(300);
    $("aside.left-panel nav.navigation > ul > li").removeClass('active');
  },

  showNavigation: function(list, idx, parent) {
    if (layout.elements.navigation) {

      if (idx === -1) {
        layout.clearNavigation();
        $('aside a[href="#welcome"]:first').closest('li').addClass('active');
      } else if (idx >= list.length) {
        layout.clearNavigation();
        $('aside a[href="#patients"]').closest('li').addClass('active');
      } else if (!$('aside a[href="#' + list[idx].link + '"]:first').closest('li').hasClass('active')) {
        layout.clearNavigation();
        //set active
        $('aside a[href="#' + list[idx].link + '"]').next().slideToggle(300);
        $('aside a[href="#' + list[idx].link + '"]').closest('li').addClass('active');
      }

      return;
    }

    var tempMust = $('#pathway-picker').html();
    var itemTemplate = $('#pathway-picker-item').html();
    Mustache.parse(tempMust);
    Mustache.parse(itemTemplate);

    list = list.slice();
    list[0].isBreakAbovePractice = true;
    for (var i = 0; i < list.length; i++) {
      list[i].hasSubItems = true;
    }
    list.unshift({
      "link": "welcome",
      "faIcon": "fa-home",
      "name": "Agreed actions",
      "isBreakAboveHome": true,
      "text": {
        "main": {
          "tooltip": "Agreed tooltip - edit in script.js"
        }
      }
    });
    list.push({
      "link": "patients",
      "faIcon": "fa-users",
      "name": "All Patients",
      "isBreakAbovePatient": true,
      "text": {
        "main": {
          "tooltip": "All patients tooltip - edit in script.js"
        }
      }
    });

    list.map(function(v, i, arr) {
      v.isSelected = i === idx + 1;
      return v;
    });

    var renderedBefore = Mustache.render(tempMust, {
      "items": list
    }, {
      "item": itemTemplate,
      "subItem": $('#pathway-picker-sub-item').html()
    });
    $('#aside-toggle nav:first').html(renderedBefore);

    $('.user').on('click', function() {
      template.loadContent('#agreedactions');
    });

    layout.elements.navigation = true;
  },

  showPage: function(page) {
    if (layout.page === page) return;
    layout.page = page;
    $('.page').hide();
    $('#' + page).show();

    if (page !== 'main-dashboard') {
      ////layout.hideSidePanel();
      $('#bottomnavbar').show();
      layout.hideHeaderBarItems();
    }
  },

  showSidePanel: function() {
    if (layout.elements.navigtion) return;
    layout.elements.navigtion = true;
    $('#main').addClass('content');
    $('#topnavbar').addClass('full');
    $('#aside-toggle').show();
    $('#bottomnavbar').hide();
  },

  hideSidePanel: function() {
    if (layout.elements.navigtion === false) return;
    layout.elements.navigtion = false;
    $('#main').removeClass('content');
    $('#topnavbar').removeClass('full');
    $('#aside-toggle').hide();
    $('#bottomnavbar').show();
  },

  showHeaderBarItems: function() {
    if (layout.elements.headerbar) return;
    layout.elements.headerbar = true;
    $('.hide-if-logged-out').show();
  },

  hideHeaderBarItems: function() {
    if (layout.elements.headerbar === false) return;
    layout.elements.headerbar = false;
    $('.hide-if-logged-out').hide();
  }

};

module.exports = layout;

},{"./data.js":9,"mustache":4}],11:[function(require,module,exports){
var notify = require('./notify.js');

var log = {
  reason: {},

  getObj: function(options) {
    var obj = JSON.parse(localStorage.bb);

    if (options && options.length > 0) {
      options.forEach(function(opt) {
        if (!obj[opt.name]) {
          obj[opt.name] = opt.value;
          log.setObj(obj);
        }
      });
    }

    return obj;
  },

  setObj: function(obj) {
    localStorage.bb = JSON.stringify(obj);
  },

  loadActions: function(callback) {
    var r = Math.random();
    $.getJSON("action-plan.json?v=" + r, function(file) {
      log.plan = file.diseases;
      log.text = file.plans;
      callback();
    });
  },

  editAction: function(id, actionId, agree, done, reason) {
    var logText, obj = log.getObj([{
      name: "actions",
      value: {}
    }]);
    if (!id) alert("ACTION TEAM/IND ID");
    if (!actionId) alert("ACTION ID");

    if (!obj.actions[id]) {
      obj.actions[id] = {};
    }


    if (agree) {
      logText = "You agreed with this suggested action on " + (new Date()).toDateString();
    } else if (agree === false) {
      var reasonText = log.reason.reason === "" && log.reason.reasonText === "" ? " - no reason given" : " . You disagreed because you said: '" + log.reason.reason + "; " + log.reason.reasonText + ".'";
      logText = "You disagreed with this action on " + (new Date()).toDateString() + reasonText;
    }

    if (done) {
      logText = "You agreed with this suggested action on " + (new Date()).toDateString();
    }

    if (!obj.actions[id][actionId]) {
      obj.actions[id][actionId] = {
        "agree": agree ? agree : false,
        "done": done ? done : false,
        "history": [logText]
      };
    } else {
      if (agree === true || agree === false) obj.actions[id][actionId].agree = agree;
      if (done === true || done === false) obj.actions[id][actionId].done = done;
      if (logText) {
        if (obj.actions[id][actionId].history) obj.actions[id][actionId].history.unshift(logText);
        else obj.actions[id][actionId].done.history = [logText];
      }
    }

    if (reason && obj.actions[id][actionId].agree === false) {
      obj.actions[id][actionId].reason = reason;
    } else {
      delete obj.actions[id][actionId].reason;
    }

    log.setObj(obj);
    notify.showSaved();
  },

  ignoreAction: function(id, actionId) {
    var obj = log.getObj([{
      name: "actions",
      value: {}
    }]);
    obj.actions[id][actionId].agree = null;
    delete obj.actions[id][actionId].reason;
    log.setObj(obj);
  },

  getActions: function() {
    return log.getObj([{
      name: "actions",
      value: {}
    }]).actions;
  },

  listActions: function(id, pathwayId) {
    var obj = log.getObj([{
      name: "actions",
      value: {}
    }]);
    arr = [];
    if (!id) return obj.actions;
    if (!obj.actions[id]) return arr;
    for (var prop in obj.actions[id]) {
      obj.actions[id][prop].id = prop;
      if (!obj.actions[id][prop].text)
        arr.push(obj.actions[id][prop]);
    }
    return arr;
  },

  //id is either "team" or the patientId
  recordFeedback: function(pathwayId, id, suggestion, reason, reasonText) {
    log.reason = {
      "reason": reason,
      "reasonText": reasonText
    };
    var obj = log.getObj([{
      name: "feedback",
      value: []
    }]);

    var item = {
      "pathwayId": pathwayId,
      "id": id,
      "val": suggestion
    };
    if (reasonText !== "") item.reasonText = reasonText;
    if (reason !== "") item.reason = reason;
    obj.feedback.push(item);
    log.setObj(obj);
  },

  getEvents: function() {
    return log.getObj([{
      name: "events",
      value: []
    }]).events;
  },

  recordEvent: function(pathwayId, id, name) {
    var obj = log.getObj([{
      name: "events",
      value: []
    }]);
    obj.events.push({
      "pathwayId": pathwayId,
      "id": id,
      "name": name,
      "date": new Date()
    });
    log.setObj(obj);
  },

  recordPlan: function(id, text, pathwayId) {
    if (!id) alert("PLAN");
    var obj = log.getObj([{
      name: "actions",
      value: {}
    }]);

    if (!obj.actions[id]) obj.actions[id] = {};
    var planId = Date.now() + "";
    obj.actions[id][planId] = {
      "text": text,
      "agree": null,
      "done": false,
      "pathwayId": pathwayId,
      "history": ["You added this on " + (new Date()).toDateString()]
    };

    log.setObj(obj);
    return planId;
  },

  findPlan: function(obj, planId) {
    for (var k in obj.actions) {
      if (obj.actions[k][planId] && obj.actions[k][planId].text) return k;
    }
    return -1;
  },

  editPlan: function(planId, text, done) {
    var obj = log.getObj([{
      name: "actions",
      value: {}
    }]);
    var id = log.findPlan(obj, planId);
    if (text) obj.actions[id][planId].text = text;
    if (done === true || done === false) obj.actions[id][planId].done = done;
    log.setObj(obj);
  },

  deletePlan: function(planId) {
    var obj = log.getObj([{
      name: "actions",
      value: {}
    }]);
    var id = log.findPlan(obj, planId);
    delete obj.actions[id][planId];
    log.setObj(obj);
  },

  listPlans: function(id, pathwayId) {
    var obj = log.getObj([{
        name: "actions",
        value: {}
      }]),
      arr = [];
    if (!id) return obj.actions;
    for (var prop in obj.actions[id]) {
      obj.actions[id][prop].id = prop;
      if ((!pathwayId || pathwayId === obj.actions[id][prop].pathwayId) && obj.actions[id][prop].text) arr.push(obj.actions[id][prop]);
    }
    return arr;
  },

  getReason: function(id, actionId) {
    var obj = log.getObj([{
      name: "actions",
      value: {}
    }]);

    if (obj.actions[id] && obj.actions[id][actionId]) return obj.actions[id][actionId].reason;
    return null;
  },

  getAgreeReason: function(pathwayId, pathwayStage, standard, patientId, item) {
    var obj = log.getObj([{
      name: "agrees",
      value: {}
    }]);
    if (!pathwayId || !pathwayStage) alert("EDITPATIENTAGREE");

    if (!obj.agrees[patientId]) obj.agrees[patientId] = [];
    var items = obj.agrees[patientId].filter(function(val) {
      return val.pathwayId === pathwayId && val.pathwayStage === pathwayStage && val.standard === standard && val.item === item;
    });

    return items.length === 1 ? items[0].reason || {} : {};
  },

  editPatientAgree: function(pathwayId, pathwayStage, standard, patientId, item, agree, reason) {
    var obj = log.getObj();
    if (!pathwayId || !pathwayStage) alert("EDITPATIENTAGREE");

    if (!obj.agrees[patientId]) obj.agrees[patientId] = [];
    var items = obj.agrees[patientId].filter(function(val) {
      return val.pathwayId === pathwayId && val.pathwayStage === pathwayStage && val.standard === standard && val.item === item;
    });

    var logText = "You " + (agree ? "" : "dis") + "agreed with this on " + (new Date()).toDateString();

    if (items.length === 1) {
      items[0].agree = agree;
      items[0].history.push(logText);
      items[0].reason = reason;
    } else if (items.length === 0) {
      obj.agrees[patientId].push({
        "pathwayId": pathwayId,
        "pathwayStage": pathwayStage,
        "standard": standard,
        "item": item,
        "agree": agree,
        "reason": reason,
        "history": [logText]
      });
    } else {
      console.log("ERRORRR!!!!!!!");
    }

    log.setObj(obj);
    notify.showSaved();
  },

  getAgrees: function(){
    return log.getObj([{
      name: "agrees",
      value: {}
    }]).agrees;
  },

  getPatientAgreeObject: function(pathwayId, pathwayStage, standard, patientId, item) {
    var obj = log.getObj([{
      name: "agrees",
      value: {}
    }]);
    if (!pathwayId || !pathwayStage) alert("EDITPATIENTAGREE");

    if (!obj.agrees[patientId]) obj.agrees[patientId] = [];
    var items = obj.agrees[patientId].filter(function(val) {
      return val.pathwayId === pathwayId && val.pathwayStage === pathwayStage && val.standard === standard && val.item === item;
    });
    if (items.length === 1) return items[0];
    return {};
  },

  getPatientAgree: function(pathwayId, pathwayStage, standard, patientId, item) {
    var obj = log.getObj([{
      name: "agrees",
      value: {}
    }]);

    if (!obj.agrees[patientId]) return null;
    var item2 = obj.agrees[patientId].filter(function(val) {
      return val.pathwayId === pathwayId && val.pathwayStage === pathwayStage && val.standard === standard && val.item === item;
    });

    if (item.length === 1) {
      return item[0].agree;
    }
    return null;
  }

};

module.exports = log;

},{"./notify.js":14}],12:[function(require,module,exports){
module.exports = {
  "currentUrl": "",
  "options": [],
  "categories": {
    "diagnosis": {
      "name": "diagnosis",
      "display": "Diagnosis"
    },
    "monitoring": {
      "name": "monitoring",
      "display": "Monitoring"
    },
    "treatment": {
      "name": "treatment",
      "display": "Control"
    },
    "exclusions": {
      "name": "exclusions",
      "display": "Exclusions"
    }
  },
  "charts": {},
  "pathwayId": "htn",
  "colors": ['#1f77b4', '#ff7f0e', '#2ca02c', '#d62728', '#9467bd', '#8c564b', '#e377c2', '#7f7f7f', '#bcbd22', '#17becf'],
  "monitored": {
    "bp": "Blood Pressure",
    "asthma": "Peak Expiratory Flow"
  }
};

},{}],13:[function(require,module,exports){
var template = require('./template.js'),
  data = require('./data.js'),
  base = require('./base.js'),
  layout = require('./layout.js'),
  welcome = require('./panels/welcome.js'),
  log = require('./log.js'),
  patientView = require('./views/patient.js'),
  Mustache = require('mustache');

var states, patLookup, page, hash;

console.log("main.js: data.lastloader= " + data.lastloader);
data.lastloader = "main.js";

var main = {
  "version": "2.0.0",

  hash: hash,
  init: function() {
    main.preWireUpPages();

    log.loadActions(function() {
      data.get(main.wireUpPages);
    });
  },

  onSelected: function($e, nhsNumberObject) {
    //Hide the suggestions panel
    $('#search-box').find('.tt-dropdown-menu').css('display', 'none');

    history.pushState(null, null, '#patients/' + nhsNumberObject.id);
    template.loadContent('#patients/' + nhsNumberObject.id, true);


    //template.displaySelectedPatient(nhsNumberObject.id);
  },

  wireUpSearchBox: function() {
    if (states) {
      states.clearPrefetchCache();
    }

    states = new Bloodhound({
      datumTokenizer: Bloodhound.tokenizers.obj.whitespace('value'),
      queryTokenizer: Bloodhound.tokenizers.whitespace,
      local: $.map(data.patientArray, function(state) {
        return {
          id: state,
          value: data.patLookup && data.patLookup[state] ? data.patLookup[state] : state
        };
      })
    });

    states.initialize(true);

    $('#search-box').find('.typeahead').typeahead('destroy');
    $('#search-box').find('.typeahead').typeahead({
        hint: true,
        highlight: true,
        minLength: 1,
        autoselect: true
      }, {
        name: 'patients',
        displayKey: 'value',
        source: states.ttAdapter(),
        templates: {
          empty: [
              '<div class="empty-message">',
                '&nbsp; &nbsp; No matches',
              '</div>'
            ].join('\n')
        }
      }).on('typeahead:selected', main.onSelected)
      .on('typeahead:autocompleted', main.onSelected);

    $('#searchbtn').on('mousedown', function() {
      var val = $('.typeahead').eq(0).val();
      if (!val || val === "") val = $('.typeahead').eq(1).val();
      main.onSelected(null, {
        "id": val
      });
    });
  },

  wireUpPages: function() {
    base.wireUpTooltips();
    main.wireUpSearchBox();

    $('#data-file').on('change', function(evt) {
      $('#data-file-wrapper').addClass('disabled').text("Loading...");
      var file = evt.target.files[0]; // FileList object
      var reader = new FileReader();

      reader.onload = (function() {
        return function(e) {
          var JsonObj = JSON.parse(e.target.result);
          data.get(null, JsonObj);
          console.log(JsonObj);

          main.wireUpSearchBox();

          setTimeout(function() {
            if (!$('#patient-file-wrapper').is(':visible')) {
              $('#file-loader').hide(500);
            } else {
              $('#data-file-wrapper').hide(500);
            }
            template.loadContent('#overview');
          }, 1000);
        };
      })(file);

      reader.readAsText(file);
    });

    $('#patient-file').on('change', function(evt) {
      $('#patient-file-wrapper').addClass('disabled').text("Loading...");
      var file = evt.target.files[0]; // FileList object
      var reader = new FileReader();

      reader.onload = (function() {
        return function(e) {
          var lines = e.target.result.split("\n");
          data.patLookup = {};
          for (var i = 0; i < lines.length; i++) {
            var fields = lines[i].split("\t");
            if (fields.length !== 2) continue;
            data.patLookup[fields[0].trim()] = fields[1].trim();
          }

          main.wireUpSearchBox();

          setTimeout(function() {
            if (!$('#data-file-wrapper').is(':visible')) {
              $('#file-loader').hide(500);
            } else {
              $('#patient-file-wrapper').hide(500);
            }
            template.loadContent('#overview');
          }, 1000);
        };
      })(file);

      reader.readAsText(file);
    });

    $('#outstandingTasks').on('click', function(e) {
      e.preventDefault();

      $('#welcome-tabs li').removeClass('active');
      $(this).closest('li').addClass('active');
      var tempMust = $('#welcome-task-list').html();
      var rendered = Mustache.render(tempMust);
      $('#welcome-tab-content').fadeOut(100, function() {
        $(this).html(rendered);
        welcome.populate();
        $(this).fadeIn(100);
      });
    });

    $('#completedTasks').on('click', function(e) {
      e.preventDefault();

      $('#welcome-tabs li').removeClass('active');
      $(this).closest('li').addClass('active');
      var tempMust = $('#welcome-task-list').html();
      var rendered = Mustache.render(tempMust);
      $('#welcome-tab-content').fadeOut(100, function() {
        $(this).html(rendered);
        welcome.populate(true);
        $(this).fadeIn(100);
      });
    });

    if (main.hash !== location.hash) location.hash = main.hash;
    template.loadContent(location.hash, true);
  },

  preWireUpPages: function() {
      layout.showPage('login');

      //Every link element stores href in history
      $(document).on('click', 'a.history', function() {
        // keep the link in the browser history
        history.pushState(null, null, this.href);
        template.loadContent(location.hash, true);
        // do not give a default action
        return false;
      });

      //Called when the back button is hit
      $(window).on('popstate', function(e) {
        template.loadContent(location.hash, true);
      });

      //Templates
      patientsPanelTemplate = $('#patients-panel');
      actionPlanPanel = $('#action-plan-panel');
      patientList = $('#patient-list');
      suggestedPlanTemplate = $('#suggested-plan-template');
      individualPanel = $('#individual-panel');
      valueTrendPanel = $('#value-trend-panel');
      medicationPanel = $('#medications-panel');
      actionPlanList = $('#action-plan-list');

      //Selectors
      bottomLeftPanel = $('#bottom-left-panel');
      bottomRightPanel = $('#bottom-right-panel');
      topPanel = $('#top-panel');
      topLeftPanel = $('#top-left-panel');
      topRightPanel = $('#top-right-panel');
      midPanel = $('#mid-panel');
      farLeftPanel = $('#left-panel');
      farRightPanel = $('#right-panel');
    }
    /*,
      "_local": local*/
};

module.exports = main;

},{"./base.js":7,"./data.js":9,"./layout.js":10,"./log.js":11,"./panels/welcome.js":34,"./template.js":36,"./views/patient.js":40,"mustache":4}],14:[function(require,module,exports){
module.exports = {

  showSaved: function() {
    $("#saved-message").hide().toggleClass("in").fadeIn(300);
    window.setTimeout(function() {
      $("#saved-message").fadeOut(300, function() {
        $(this).toggleClass("in");
      });
    }, 2000);
  }

};

},{}],15:[function(require,module,exports){
var base = require('../base.js'),
  data = require('../data.js'),
  qualityStandard = require('./qualityStandard.js'),
  otherCodes = require('./otherCodes.js'),
  medication = require('./medication.js'),
  trend = require('./trend.js'),
  individualActionPlan = require('./individualActionPlan.js'),
  layout = require('../layout.js'),
  chart = require('../chart.js'),
  Mustache = require('mustache');

var all = {

  populate: function() {
    var patients = data.getAllPatients();

    var localData = {
      "patients": patients,
      "n": patients.length,
      "header-items": [{
        "title": "NHS no.",
        "isUnSortable": true
      }, {
        "title": "All Opportunities",
        "titleHTML": '# of <i class="fa fa-flag" style="color:red"></i>',
        "isUnSortable": true,
        "tooltip": "Total number of improvement opportunities available across all conditions"
      }]
    };

    localData.patients.sort(function(a, b) {
      if (a.items[0] === b.items[0]) {
        return 0;
      }
      var A = Number(a.items[0]);
      var B = Number(b.items[0]);
      if (isNaN(A) || isNaN(B)) {
        A = a.items[0];
        B = b.items[0];
      }
      if (A > B) {
        return -1;
      } else if (A < B) {
        return 1;
      }
    });

    base.createPanelShow(patientList, patientsPanel, localData, {
      "header-item": $("#patient-list-header-item").html(),
      "item": $('#patient-list-item').html()
    });

    $('#patients-placeholder').hide();

    base.setupClipboard($('.btn-copy'), true);

    base.wireUpTooltips();

    var c = patientsPanel.find('div.table-scroll').getNiceScroll();
    if (c && c.length > 0) {
      c.resize();
    } else {
      patientsPanel.find('div.table-scroll').niceScroll({
        cursoropacitymin: 0.3,
        cursorwidth: "7px",
        horizrailenabled: false
      });
    }
  },

  //Show patient view from the all patient screen
  showIndividualPatientView: function(pathwayId, pathwayStage, standard, patientId) {
    data.patientId = patientId;

    data.options.sort(function(a, b) {
      a = data.getPatientStatus(patientId, a.pathwayId, a.pathwayStage, a.standard);
      b = data.getPatientStatus(patientId, b.pathwayId, b.pathwayStage, b.standard);

      if (a === b) return 0;
      if (a === "not") return 1;
      if (b === "not") return -1;
      if (a === "ok") return 1;
      if (b === "ok") return -1;
      alert("!!!!!!!");
    });

    if (pathwayId === null) {
      //Show patient but don't select
      var p = base.createPanel($('#patient-panel'), {
        "options": data.options,
        "numberOfStandardsMissed": data.numberOfStandardsMissed(patientId),
        "nhsNumber": data.patLookup ? data.patLookup[patientId] : patientId,
        "patientId": patientId
      }, {
        "option": $('#patient-panel-drop-down-options').html()
      });
      farRightPanel.html(p).show();
      farRightPanel.removeClass('standard-missed-page').removeClass('standard-achieved-page').removeClass('standard-not-relevant-page');

      $('select').select2({
        templateResult: base.formatStandard,
        minimumResultsForSearch: Infinity,
        placeholder: "Please select an improvement opportunity area..."
      });
      $('span.select2-selection__rendered').attr("title", "");
      $('select').on('change', function() {
        var localData = $(this).find(':selected').data();
        all.showIndividualPatientView(localData.pathwayId, localData.pathwayStage, localData.standard, data.patientId);
      }).on("select2:open", function(e) {
        base.wireUpTooltips();
      });
      return;
    }

    var panel = base.createPanel($('#patient-panel'), {
      "options": data.options,
      "numberOfStandardsMissed": data.numberOfStandardsMissed(patientId),
      "standard": data[pathwayId][pathwayStage].standards[standard].tab.title,
      "pathwayStage": pathwayStage,
      "nhsNumber": data.patLookup ? data.patLookup[patientId] : patientId,
      "patientId": patientId
    }, {
      "option": $('#patient-panel-drop-down-options').html()
    });

    farRightPanel.html("");
    $('#temp-hidden').html(panel);

    var actionPlan = individualActionPlan.create(pathwayStage);
    $('#temp-hidden #patient-panel-right').html(actionPlan);

    var qualPanel = qualityStandard.create(pathwayId, pathwayStage, standard, patientId);
    var trendPanel = trend.create(pathwayId, pathwayStage, standard, patientId);
    var medPanel = medication.create(pathwayId, pathwayStage, standard, patientId);
    var codesPanel = otherCodes.create(pathwayId, pathwayStage, standard, patientId);
    var medCodeWrapperPanel = base.createPanel($('#other-codes-and-meds-wrapper-panel'));
    $('#temp-hidden #patient-panel-top').html(qualPanel);
    $('#temp-hidden #patient-panel-left').html("").append(trendPanel).append(medCodeWrapperPanel);
    $('#temp-hidden #medCodeWrapperPanel').append(medPanel).append(codesPanel);

    if (farRightPanel.is(':visible')) {
      farRightPanel.fadeOut(100, function() {
        $(this).html($('#temp-hidden').html());
        $('#temp-hidden').html("");
        individualActionPlan.wireUp(pathwayId, pathwayStage, standard, patientId);
        qualityStandard.wireUp(pathwayId, pathwayStage, standard, patientId);
        base.wireUpStandardDropDown(pathwayId, pathwayStage, standard, all.showIndividualPatientView);
        trend.wireUp(pathwayId, pathwayStage, standard, patientId);
        medication.wireUp(pathwayId, pathwayStage, standard, patientId);
        otherCodes.wireUp(pathwayId, pathwayStage, standard, patientId);
        chart.drawTrendChart(patientId, pathwayId, pathwayStage, standard);
        $(this).fadeIn(100, function() {});
      });
    } else {
      farRightPanel.html($('#temp-hidden').html());
      $('#temp-hidden').html("");
      individualActionPlan.wireUp(pathwayId, pathwayStage, standard, patientId);
      qualityStandard.wireUp(pathwayId, pathwayStage, standard, patientId);
      base.wireUpStandardDropDown(pathwayId, pathwayStage, standard, all.showIndividualPatientView);
      trend.wireUp(pathwayId, pathwayStage, standard, patientId);
      medication.wireUp(pathwayId, pathwayStage, standard, patientId);
      otherCodes.wireUp(pathwayId, pathwayStage, standard, patientId);
      chart.drawTrendChart(patientId, pathwayId, pathwayStage, standard);
      farRightPanel.fadeIn(100, function() {});
    }
  },

  show: function(location) {
    base.createPanelShow($('#all-patients-panel'), location, {
      "n": data.getAllPatients().length
    });

    patientsPanel = $('#patients');

    patientsPanel.on('click', 'tbody tr', function(e) { //Select individual patient when row clicked
      $('[data-toggle="tooltip"]').tooltip('hide');
      $(this).tooltip('destroy');
      base.clearBox();
      $('.list-item').removeClass('highlighted');
      $(this).addClass('highlighted').removeAttr('title');

      var patientId = $(this).find('td button').attr('data-patient-id');

      all.showIndividualPatientView(null, null, null, patientId);

      e.preventDefault();
      e.stopPropagation();
    }).on('click', 'tbody tr button', function(e) {
      //don't want row selected if just button pressed?
      e.preventDefault();
      e.stopPropagation();
    });
  },

  showView: function(patientId, reload) {
    $('#mainTitle').hide();
    base.updateTitle("List of all patients at your practice");

    if (!patientId) data.pathwayId = "";
    if (!patientId || reload) {

      layout.showMainView(data.diseases.length);

      base.switchTo110Layout();
      base.hideAllPanels();

      all.show(farLeftPanel);
      all.populate();
    }

    if (patientId) {
      all.showIndividualPatientView(null, null, null, patientId);
    } else {
      var tempMust = $('#patient-panel-placeholder').html();
      farRightPanel.html(Mustache.render(tempMust)).show();
    }
  }

};

module.exports = all;

},{"../base.js":7,"../chart.js":8,"../data.js":9,"../layout.js":10,"./individualActionPlan.js":22,"./medication.js":24,"./otherCodes.js":25,"./qualityStandard.js":30,"./trend.js":33,"mustache":4}],16:[function(require,module,exports){
var base = require('../base.js'),
log = require('../log.js');

var confirm = {

  wireUp: function(agreeDivSelector, panelSelector, pathwayId, pathwayStage, standard, patientId, item, disagreeText) {
    confirm.wireUpAgreeDisagree(agreeDivSelector, log.getPatientAgreeObject(pathwayId, pathwayStage, standard, patientId, item));

    panelSelector.on('change', '.btn-toggle input[type=checkbox]', function() {
      confirm.wireUpAgreeDisagree(agreeDivSelector, log.getPatientAgreeObject(pathwayId, pathwayStage, standard, patientId, item));
      base.wireUpTooltips();
    }).on('click', '.btn-toggle', function(e) {
      var checkbox = $(this).find("input[type=checkbox]");
      var other = $(this).parent().find($(this).hasClass("btn-yes") ? ".btn-no" : ".btn-yes");
      var ACTIONID = $(this).closest('tr').data('id');
      if ($(this).hasClass("active") && other.hasClass("inactive")) {
        //unselecting
        if (checkbox.val() === "no") {
          confirm.launchStandardModal("Disagree with " + disagreeText, "?", log.getAgreeReason(pathwayId, pathwayStage, standard, patientId, item), true, function() {
            log.editPatientAgree(pathwayId, pathwayStage, standard, patientId, item, false, log.reason.reasonText);
            confirm.wireUpAgreeDisagree(agreeDivSelector, log.getPatientAgreeObject(pathwayId, pathwayStage, standard, patientId, item));
            base.wireUpTooltips();
          }, null, function() {
            log.editPatientAgree(pathwayId, pathwayStage, standard, patientId, item, null, "");
            other.removeClass("inactive");
            checkbox.removeAttr("checked");
            checkbox.parent().removeClass("active");
            confirm.wireUpAgreeDisagree(agreeDivSelector, log.getPatientAgreeObject(pathwayId, pathwayStage, standard, patientId, item));
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.editPatientAgree(pathwayId, pathwayStage, standard, patientId, item, null);
          other.removeClass("inactive");
        }
      } else if (!$(this).hasClass("active") && other.hasClass("active")) {
        //prevent clicking on unselected option or if the row is complete
        e.stopPropagation();
        e.preventDefault();
        return;
      } else {
        //selecting
        var self = this;
        if (checkbox.val() === "no") {
          confirm.launchStandardModal("Disagree with " + disagreeText, "", "", false, function() {
            log.editPatientAgree(pathwayId, pathwayStage, standard, patientId, item, false, log.reason.reasonText);
            $(self).removeClass("inactive");
            checkbox.attr("checked", "checked");
            checkbox.parent().addClass("active");
            //unselect other
            other.removeClass("active").addClass("inactive");
            other.find("input[type=checkbox]").prop("checked", false);
            confirm.wireUpAgreeDisagree(agreeDivSelector, log.getPatientAgreeObject(pathwayId, pathwayStage, standard, patientId, item));
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.editPatientAgree(pathwayId, pathwayStage, standard, patientId, item, true);
          $(this).removeClass("inactive");

          //unselect other
          other.removeClass("active").addClass("inactive");
          other.find("input[type=checkbox]").prop("checked", false);
        }
      }
    });
  },

  wireUpAgreeDisagree: function(selector, agreeObject) {
    if (agreeObject.agree === true) {
      selector.children(':nth(0)').addClass('active');
      selector.children(':nth(1)').addClass('inactive');
      selector.children(':nth(0)').attr("title", confirm.getAgreeTooltip(agreeObject)).attr("data-original-title", confirm.getAgreeTooltip(agreeObject)).tooltip('fixTitle').tooltip('hide');
      selector.children(':nth(1)').attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
      selector.parent().addClass('success').removeClass('danger');
    } else if (agreeObject.agree === false) {
      selector.children(':nth(0)').addClass('inactive');
      selector.children(':nth(1)').addClass('active');
      selector.children(':nth(0)').attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
      selector.children(':nth(1)').attr("title", confirm.getDisgreeTooltip(agreeObject)).attr("data-original-title", confirm.getDisgreeTooltip(agreeObject)).tooltip('fixTitle').tooltip('hide');
      selector.parent().addClass('danger').removeClass('success');
    } else {
      selector.children(':nth(0)').attr("title", "Click to agree").attr("data-original-title", "Click to agree").tooltip('fixTitle').tooltip('hide');
      selector.children(':nth(1)').attr("title", "Click to disagree").attr("data-original-title", "Click to disagree").tooltip('fixTitle').tooltip('hide');
      selector.parent().removeClass('success').removeClass('danger');
    }
  },

  getAgreeTooltip: function(agreeObject) {
    return agreeObject.history[agreeObject.history.length - 1];
  },

  getDisgreeTooltip: function(agreeObject) {
    return agreeObject.history[agreeObject.history.length - 1] + " You said: " + agreeObject.reason;
  },

  launchStandardModal: function(header, value, reason, isUndo, callbackOnSave, callbackOnCancel, callbackOnUndo) {
    base.launchModal({
      "header": header,
      "isUndo": isUndo,
      "item": value,
      "placeholder": "Provide more information here..."
    }, null, value, reason, callbackOnSave, callbackOnCancel, callbackOnUndo);
  }

};

module.exports = confirm;

},{"../base.js":7,"../log.js":11}],17:[function(require,module,exports){
var base = require('../base.js'),
  data = require('../data.js'),
  chart = require('../chart.js'),
  patientList = require('./patientList.js');

var ID = "INDICATOR_BENCHMARK";

var iTrend = {

  show: function(panel, isAppend, pathwayId, pathwayStage, standard) {

    var elem = $("<div id='benchmark-chart' class='fit-to-scrolling-section-height'></div>");

    if (isAppend) panel.append(elem);
    else panel.html(elem);

    chart.drawBenchmarkChartHC("benchmark-chart", null);

  },

  wireUp: function() {

  }

};

module.exports = iTrend;

},{"../base.js":7,"../chart.js":8,"../data.js":9,"./patientList.js":27}],18:[function(require,module,exports){
var data = require('../data.js'),
  chart = require('../chart.js');

var bd = {

  wireUp: function() {

  },

  show: function(panel, isAppend, pathwayId, pathwayStage, standard, selectSeriesFn) {

    var indicators = data.getIndicatorDataSync([pathwayId, pathwayStage, standard].join("."));

    var dataObj = indicators.opportunities.map(function(opp) {
      return [opp.name, opp.description, opp.patients.length];
    });

    var elem = $("<div id='breakdown-chart'></div>");

    if (isAppend) panel.append(elem);
    else panel.html(elem);

    chart.drawAnalytics("breakdown-chart", dataObj, selectSeriesFn);

    bd.wireUp();

  }

};

module.exports = bd;

},{"../chart.js":8,"../data.js":9}],19:[function(require,module,exports){
var data = require('../data.js'),
  chart = require('../chart.js'),
  Mustache = require('mustache');

var hl = {

  wireUp: function() {

  },

  show: function(panel, isAppend, pathwayId, pathwayStage, standard) {

    var indicators = data.getIndicatorDataSync([pathwayId, pathwayStage, standard].join("."));

    var tempMust = $('#indicator-headline-panel').html();
    var html = Mustache.render(tempMust, indicators);

    if(isAppend) panel.append(html);
    else panel.html(html);

  }

};

module.exports = hl;

},{"../chart.js":8,"../data.js":9,"mustache":4}],20:[function(require,module,exports){
var base = require('../base.js'),
  log = require('../log.js'),
  data = require('../data.js'),
  sparkline = require('jquery-sparkline'),
  Mustache = require('mustache');

var indicatorList = {

  show: function(panel, isAppend, loadContentFn) {
    data.getAllIndicatorData(function(indicators) {
      indicators.sort(function(a,b){
        return a.performance - b.performance;
      });
      var tempMust = $('#overview-panel-table').html();
      var html = Mustache.render(tempMust, {
        "indicators": indicators
      });
      if (isAppend) {
        panel.append(html);
      } else {
        panel.html(html);
      }

      $('.inlinesparkline').sparkline('html', {
        tooltipFormatter: function(sparkline, options, fields) {
          var dts = indicators[$('.inlinesparkline').index(sparkline.el)].dates;
          return dts[dts.length - 1 - fields.x] + ": " + fields.y + "%";
        },
        width: "100px"
      });

      indicatorList.wireUp(panel, loadContentFn);

    });
  },

  populate: function() {

  },

  wireUp: function(panel, loadContentFn) {
    panel.off('click', 'tr.show-more-row a');
    panel.on('click', 'tr.show-more-row a', function(e) {

      // do not give a default action
      //e.preventDefault();
      e.stopPropagation();
      //return false;
    });

    panel.off('click', 'tr.standard-row,tr.show-more-row');
    panel.on('click', 'tr.standard-row,tr.show-more-row', function(e) {
      var url = $(this).data("id").replace(/\./g, "/");
      history.pushState(null, null, '#indicators/' + url);
      loadContentFn('#indicators/' + url);
      // do not give a default action
      e.preventDefault();
      e.stopPropagation();
      return false;
    });

    panel.off('mouseenter', '.show-more-row,.standard-row');
    panel.off('mouseleave', '.show-more-row,.standard-row');
    panel.on('mouseenter', '.show-more-row,.standard-row', function(e){
      var id = $(this).data("id");
      $('.show-more-row[data-id="' + id + '"],.standard-row[data-id="' + id + '"]').addClass('hover');
    });
    panel.on('mouseleave', '.show-more-row,.standard-row', function(e){
      var id = $(this).data("id");
      $('.show-more-row[data-id="' + id + '"],.standard-row[data-id="' + id + '"]').removeClass('hover');
    });

    panel.off('click', '.show-more');
    panel.on('click', '.show-more', function(e) {
      var id = $(this).data("id");
      var elem = $('.show-more-row[data-id="' + id + '"]');
      if(elem.is(':visible')){
        $('.show-more[data-id="' + id + '"]:first').show();
        elem.hide();
      } else {
        $(this).hide();
        elem.show('fast');
      }
      // do not give a default action
      e.preventDefault();
      e.stopPropagation();
      return false;
    });
  }

};

module.exports = indicatorList;

},{"../base.js":7,"../data.js":9,"../log.js":11,"jquery-sparkline":3,"mustache":4}],21:[function(require,module,exports){
var base = require('../base.js'),
  data = require('../data.js'),
  chart = require('../chart.js'),
  patientList = require('./patientList.js');

var ID = "INDICATOR_TREND";

var iTrend = {

  show: function(panel, isAppend, pathwayId, pathwayStage, standard) {

    var indicators = data.getAllIndicatorDataSync();

    var elem = $("<div id='trend-chart' class='fit-to-scrolling-section-height'></div>");

    if (isAppend) panel.append(elem);
    else panel.html(elem);

    chart.drawPerformanceTrendChartHC("trend-chart", indicators.filter(function(v){
      return v.id===[pathwayId, pathwayStage, standard].join(".");
    })[0]);

  },

  wireUp: function() {

  }

};

module.exports = iTrend;

},{"../base.js":7,"../chart.js":8,"../data.js":9,"./patientList.js":27}],22:[function(require,module,exports){
var base = require('../base.js'),
  confirm = require('./confirm.js'),
  data = require('../data.js'),
  log = require('../log.js');

var iap = {

  create: function(pathwayStage) {
    return base.createPanel($('#individual-action-plan-panel'), {
      "pathwayStage": pathwayStage || "default",
      "noHeader": true
    });
  },

  show: function(panel, pathwayId, pathwayStage, standard, patientId) {
    panel.html(iap.create(pathwayStage));
    iap.wireUp(pathwayId, pathwayStage, standard, patientId);

    panel.find('div.fit-to-screen-height').niceScroll({
      cursoropacitymin: 0.3,
      cursorwidth: "7px",
      horizrailenabled: false
    });
  },

  wireUp: function(pathwayId, pathwayStage, standard, patientId) {
    individualTab = $('#tab-plan-individual');

    //find [] and replace with copy button

    $('#advice-list').on('click', '.cr-styled input[type=checkbox]', function() {
      var ACTIONID = $(this).closest('tr').data('id');
      log.editAction(data.patientId, ACTIONID, null, this.checked);

      if (this.checked) {
        log.recordEvent(pathwayId, data.patientId, "Item completed");
        var self = this;
        $(self).parent().attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
        setTimeout(function(e) {
          $(self).parent().fadeOut(300, function() {
            var parent = $(this).parent();
            $(this).replaceWith(base.createPanel($('#checkbox-template'), {
              "done": true
            }));
            base.wireUpTooltips();
            parent.find('button').on('click', function() {
              ACTIONID = $(this).closest('tr').data('id');
              log.editAction(data.patientId, ACTIONID, null, false);
              $(this).replaceWith(base.createPanel($('#checkbox-template'), {
                "done": false
              }));
              iap.updateIndividualSapRows();
            });
          });
        }, 1000);
      }

      iap.updateIndividualSapRows();
    });

    $('#personalPlanIndividual').on('click', 'input[type=checkbox]', function() {
      var PLANID = $(this).closest('tr').data("id");
      log.editPlan(PLANID, null, this.checked);

      if (this.checked) {
        $(this).parent().parent().parent().addClass('success');
        log.recordEvent(pathwayId, data.patientId, "Personal plan item");
        var self = this;
        $(self).parent().attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
        setTimeout(function(e) {
          $(self).parent().fadeOut(300, function() {
            var parent = $(this).parent();
            $(this).replaceWith(base.createPanel($('#checkbox-template'), {
              "done": true
            }));
            base.wireUpTooltips();
            parent.find('button').on('click', function() {
              PLANID = $(this).closest('tr').data('id');
              log.editPlan(data.patientId, PLANID, null, false);
              $(this).replaceWith(base.createPanel($('#checkbox-template'), {
                "done": false
              }));
              iap.updateIndividualSapRows();
            });
          });
        }, 1000);
      }
    }).on('click', '.btn-undo', function(e) {
      var PLANID = $(this).closest('tr').data('id');
      log.editPlan(PLANID, null, false);
      $(this).replaceWith(base.createPanel($('#checkbox-template'), {
        "done": false
      }));
      iap.updateIndividualSapRows();
      e.stopPropagation();
    });

    individualTab.on('click', '.edit-plan', function() {
      var PLANID = $(this).closest('tr').data("id");

      $('#editActionPlanItem').val($($(this).closest('tr').children('td')[0]).find('span').text());

      $('#editPlan').off('hidden.bs.modal').on('hidden.bs.modal', function() {
        iap.displayPersonalisedIndividualActionPlan(data.patientId, $('#personalPlanIndividual'));
      }).off('shown.bs.modal').on('shown.bs.modal', function() {
        $('#editActionPlanItem').focus();
      }).off('click', '.save-plan').on('click', '.save-plan', function() {

        log.editPlan(PLANID, $('#editActionPlanItem').val());

        $('#editPlan').modal('hide');
      }).off('keyup', '#editActionPlanItem').on('keyup', '#editActionPlanItem', function(e) {
        if (e.which === 13) $('#editPlan .save-plan').click();
      }).modal();
    }).on('click', '.delete-plan', function() {
      var PLANID = $(this).closest('tr').data("id");

      $('#individual-delete-item').html($($(this).closest('tr').children('td')[0]).find('span').text());

      $('#deletePlan').off('hidden.bs.modal').on('hidden.bs.modal', function() {
        iap.displayPersonalisedIndividualActionPlan(data.patientId, $('#personalPlanIndividual'));
      }).off('click', '.delete-plan').on('click', '.delete-plan', function() {
        log.deletePlan(PLANID);

        $('#deletePlan').modal('hide');
      }).modal();
    }).on('click', '.add-plan', function() {
      log.recordPlan(data.patientId, $(this).parent().parent().find('textarea').val(), pathwayId);

      iap.displayPersonalisedIndividualActionPlan(data.patientId, $('#personalPlanIndividual'));
    }).on('change', '.btn-toggle input[type=checkbox]', function() {
      iap.updateIndividualSapRows();
    }).on('click', '.btn-undo', function(e) {
      var ACTIONID = $(this).closest('tr').data('id');
      log.editAction(data.patientId, ACTIONID, null, false);
      $(this).replaceWith(base.createPanel($('#checkbox-template'), {
        "done": false
      }));
      iap.updateIndividualSapRows();
    }).on('click', '.btn-yes,.btn-no', function(e) {
      var checkbox = $(this).find("input[type=checkbox]");
      var other = $(this).parent().find($(this).hasClass("btn-yes") ? ".btn-no" : ".btn-yes");
      var ACTIONID = $(this).closest('tr').data('id');
      if ($(this).hasClass("active") && other.hasClass("inactive") && !$(this).closest('tr').hasClass('success')) {
        //unselecting
        if (checkbox.val() === "no") {
          iap.launchModal(data.selected, checkbox.closest('tr').children().first().children().first().text(), log.getReason(data.patientId, ACTIONID), true, function() {
            log.editAction(data.patientId, ACTIONID, false, null, log.reason);
            iap.updateIndividualSapRows();
            base.wireUpTooltips();
          }, null, function() {
            log.ignoreAction(data.patientId, ACTIONID);
            other.removeClass("inactive");
            checkbox.removeAttr("checked");
            checkbox.parent().removeClass("active");
            iap.updateIndividualSapRows();
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.ignoreAction(data.patientId, ACTIONID);
          other.removeClass("inactive");
        }
      } else if ((!$(this).hasClass("active") && other.hasClass("active")) || $(this).closest('tr').hasClass('success')) {
        //prevent clicking on unselected option or if the row is complete
        e.stopPropagation();
        e.preventDefault();
        return;
      } else {
        //selecting
        var self = this;
        if (checkbox.val() === "no") {
          iap.launchModal(data.selected, checkbox.closest('tr').children().first().children().first().text(), log.getReason(data.patientId, ACTIONID), false, function() {
            log.editAction(data.patientId, ACTIONID, false, null, log.reason);
            $(self).removeClass("inactive");

            checkbox.attr("checked", "checked");
            checkbox.parent().addClass("active");
            //unselect other
            other.removeClass("active").addClass("inactive");
            other.find("input[type=checkbox]").prop("checked", false);
            iap.updateIndividualSapRows();
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.editAction(data.patientId, ACTIONID, true);
          $(this).removeClass("inactive");

          //unselect other
          other.removeClass("active").addClass("inactive");
          other.find("input[type=checkbox]").prop("checked", false);
        }
      }
    }).on('keyup', 'input[type=text]', function(e) {
      if (e.which === 13) {
        individualTab.find('.add-plan').click();
      }
    });

    $('#advice-list').off('click', '.show-more');
    $('#advice-list').on('click', '.show-more', function(e) {
      var id = $(this).data("id");
      var elem = $('.show-more-row[data-id="' + id + '"]');
      if(elem.is(':visible')){
        $('.show-more[data-id="' + id + '"]:first').show();
        elem.hide();
      } else {
        $(this).hide();
        elem.show('fast');
      }
      // do not give a default action
      e.preventDefault();
      e.stopPropagation();
      return false;
    });

    iap.populateIndividualSuggestedActions(patientId, pathwayId, pathwayStage, standard);
  },

  updateIndividualSapRows: function() {
    /*$('#advice-list').add('#personalPlanIndividual').find('.suggestion').each(function() {
      $(this).find('td').last().children().hide();
    });*/

    /*$('#advice-list').add('#personalPlanIndividual').find('.cr-styled input[type=checkbox]').each(function() {
      if (this.checked) {
        $(this).parent().parent().parent().addClass('success');
      } else {
        $(this).parent().parent().parent().removeClass('success');
      }
    });*/

    /*$('#advice-list').add('#personalPlanIndividual').find('.btn-undo').each(function() {
      $(this).parent().parent().addClass('success');
    });*/

    //no class - user not yet agreed/disagreed - no background / muted text
    //active - user agrees - green background / normal text
    //success - user completed - green background / strikethrough text
    //danger - user disagrees - red background / strikethrough text

    $('#advice-list').add('#personalPlanIndividual').find('tr.suggestion').each(function() {
      var self = $(this);
      var id = self.data("id");
      var all = $('.show-more-row[data-id="' + id + '"],.suggestion[data-id="' + id + '"]');
      var any = false;
      self.find('.btn-toggle input[type=checkbox]:checked').each(function() {
        any = true;
        if (this.value === "yes") {
          all.removeClass('danger');
          all.addClass('active');
          //self.find('td').last().children().show();
          if (log.getActions()[data.patientId][self.data("id")].history) {
            var tool = $(this).closest('tr').hasClass('success') ? "" : "<p>" + log.getActions()[data.patientId][self.data("id")].history[0] + "</p><p>Click again to cancel</p>";
            $(this).parent().attr("title", tool).attr("data-original-title", tool).tooltip('fixTitle').tooltip('hide');
          } else {
            $(this).parent().attr("title", "You agreed - click again to cancel").tooltip('fixTitle').tooltip('hide');
          }
        } else {
          all.removeClass('active');
          all.addClass('danger');
          all.removeClass('success');
          if (log.getActions()[data.patientId][self.data("id")] && log.getActions()[data.patientId][self.data("id")].history) {
            $(this).parent().attr("title", "<p>" + log.getActions()[data.patientId][self.data("id")].history[0] + "</p><p>Click again to edit/cancel</p>").tooltip('fixTitle').tooltip('hide');
          } else {
            $(this).parent().attr("title", "You disagreed - click again to edit/cancel").tooltip('fixTitle').tooltip('hide');
          }
        }
      });
      if (self.find('.btn-toggle input[type=checkbox]:not(:checked)').length == 1) {
        self.find('.btn-toggle input[type=checkbox]:not(:checked)').parent().addClass("inactive").attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
      }
      if (!any) {
        all.removeClass('danger');
        all.removeClass('active');
        all.removeClass('success');

        self.find('.btn-toggle.btn-yes').attr("title", "Click to agree with this action and save it in your agreed actions list  ").tooltip('fixTitle').tooltip('hide');
        self.find('.btn-toggle.btn-no').attr("title", "Click to disagree with this action and remove it from your suggested actions list ").tooltip('fixTitle').tooltip('hide');
      }

      base.wireUpTooltips();
    });
    base.wireUpTooltips();
  },

  displayPersonalisedIndividualActionPlan: function(id, parentElem) {
    var plans = base.sortSuggestions(base.addDisagreePersonalTeam(log.listPlans(id)));

    base.createPanelShow(actionPlanList, parentElem, {
      "hasSuggestions": plans && plans.length > 0,
      "suggestions": plans
    }, {
      "action-plan": $('#action-plan').html(),
      "action-plan-item": $('#action-plan-item').html(),
      "chk": $('#checkbox-template').html()
    });

    iap.updateIndividualSapRows();
  },

  populateIndividualSuggestedActions: function(patientId, pathwayId, pathwayStage, standard) {
    var localData = {
      "nhsNumber": data.patLookup ? data.patLookup[patientId] : patientId,
      "patientId": patientId
    };

    var patientData = data.getPatientData(patientId);

    var breaches = data.patients[patientId].breach ? data.patients[patientId].breach.filter(function(v) {
      return v.pathwayId === pathwayId && v.pathwayStage === pathwayStage && v.standard === standard;
    }) : [];

    var fn = function(val) {
      return {
        "id": val,
        "subsection": subsection
      };
    };

    if (patientData.actions.length === 0) {
      localData.noSuggestions = true;
    } else {
      /*var suggestions = [],
        subsection = "";
      for (var i = 0; i < breaches.length; i++) {
        subsection = breaches[i].subsection;
        suggestions = suggestions.concat(data[pathwayId][pathwayStage].bdown[subsection].suggestions ?
          data[pathwayId][pathwayStage].bdown[subsection].suggestions.map(fn) : []);
      }*/

      localData.suggestions = base.sortSuggestions(base.mergeIndividualStuff(patientData.actions, patientId));
      /*localData.section = {
        "name": data[pathwayId][pathwayStage].bdown[subsection].name,
        "agree": log.getPatientAgree(pathwayId, pathwayStage, patientId, "section") === true,
        "disagree": log.getPatientAgree(pathwayId, pathwayStage, patientId, "section") === false,
      };
      localData.category = {
        "name": data.patients[patientId].category,
        "agree": log.getPatientAgree(pathwayId, pathwayStage, patientId, "category") === true,
        "disagree": log.getPatientAgree(pathwayId, pathwayStage, patientId, "category") === false,
      };*/
    }

    $('#advice-placeholder').hide();
    $('#advice').show();

    base.createPanelShow(individualPanel, $('#advice-list'), localData);

    //Wire up any clipboard stuff in the suggestions
    $('#advice-list').find('span:contains("[COPY")').each(function() {
      var html = $(this).html();
      $(this).html(html.replace(/\[COPY:([^\]]*)\]/g, '$1 <button type="button" data-clipboard-text="$1" data-content="Copied" data-toggle="tooltip" data-placement="top" title="Copy $1 to clipboard." class="btn btn-xs btn-default btn-copy"><span class="fa fa-clipboard"></span></button>'));
    });
    $('#advice-list').find('span:contains("[")').each(function() {
      var html = $(this).html();
      $(this).html(html.replace(/\[([^\]]*)\]/g, ' <button type="button" data-clipboard-text="$1" data-content="Copied" data-toggle="tooltip" data-placement="top" title="Copy $1 to clipboard." class="btn btn-xs btn-default btn-copy"><span class="fa fa-clipboard"></span></button>'));
    });

    $('#advice-list').find('span:contains("[INFO")').each(function() {
      var html = $(this).html();
      var subsection = $(this).data().subsection;
      var desc = data[pathwayId][pathwayStage].standards[standard].opportunities.filter(function(val) {
          return val.name === subsection;
        }).length > 0 ?
        data[pathwayId][pathwayStage].standards[standard].opportunities.filter(function(val) {
          return val.name === subsection;
        })[0].desc : subsection;
      var tooltip = subsection ? "This action is suggested because PINGR classified this patient as:'" + desc + "'" : '';
      var newHtml = ' <i class="fa fa-info-circle fa-lg info-button clickable" data-toggle="tooltip" data-placement="right" title="' + tooltip + '"></i>';
      $(this).html(html.replace(/\[INFO\]/g, newHtml));
    });

    $('#advice-list').find('span:contains("[MED-SUGGESTION")').each(function() {
      var html = $(this).html();
      var suggestion = Math.random() < 0.33 ? "Increase Ramipril to 10mg per day" : (Math.random() < 0.5 ? "Consider adding an ACE inhibior" : "Consider adding a thiazide-like diuretic");
      $(this).html(html.replace(/\[MED\-SUGGESTION\]/g, suggestion));
    });


    base.setupClipboard($('.btn-copy'), true);

    iap.displayPersonalisedIndividualActionPlan(patientId, $('#personalPlanIndividual'));
  },

  launchModal: function(label, value, reason, isUndo, callbackOnSave, callbackOnCancel, callbackOnUndo) {
    var reasons = [{
      "reason": "Already done this",
      "value": "done"
    }, {
      "reason": "Wouldn't work",
      "value": "nowork"
    }, {
      "reason": "Something else",
      "value": "else"
    }];
    if (reason && reason.reason) {
      for (var i = 0; i < reasons.length; i++) {
        if (reasons[i].reason === reason.reason) {
          reasons[i].checked = true;
          break;
        }
      }
    }
    base.launchModal({
      "header": "Disagree with a suggested action",
      "isUndo": isUndo,
      "item": value,
      "placeholder": "Provide more information here...",
      "reasons": reasons
    }, label, value, reason ? reason.reasonText : null, callbackOnSave, callbackOnCancel, callbackOnUndo);
  }

};

module.exports = iap;

},{"../base.js":7,"../data.js":9,"../log.js":11,"./confirm.js":16}],23:[function(require,module,exports){
var Highcharts = require('highcharts/highstock'),
  base = require('../base.js');
require('highcharts/highcharts-more')(Highcharts);

var ID = "LIFELINE";

var colour = {
  index: 0,
  next: function() {
    if (this.index >= Highcharts.getOptions().colors.length) this.index = 0;
    return Highcharts.getOptions().colors[this.index++];
  },
  reset: function() {
    this.index = 0;
  }
};

var ll = {
  chartArray: [],

  destroy: function(elementId) {
    $(elementId).html('');
    $(elementId).off('mousemove touchmove touchstart', '.sync-chart');

    for (var i = 0; i < Highcharts.charts.length; i++) {
      if (Highcharts.charts[i] && Highcharts.charts[i].renderTo.className.indexOf("h-chart") > -1) Highcharts.charts[i].destroy();
    }
  },

  show: function(panel, isAppend, patientId, data) {

    var element = 'lifeline-chart';
    var elementId = '#' + element;

    ll.destroy(elementId);

    var htmlElement = $('<div class="panel panel-default"><div class="panel-body"><div id="' + element + '"></div></div></div>');

    if (isAppend) panel.append(htmlElement);
    else panel.html(htmlElement);

    colour.reset();
    /**
     * In order to synchronize tooltips and crosshairs, override the
     * built-in events with handlers defined on the parent element.
     */

    $(elementId).on('mousemove touchmove touchstart', '.sync-chart', function(e) {
      var chart, point, i, event, series;

      for (i = 1; i < ll.chartArray.length - 2; i = i + 1) {
        chart = ll.chartArray[i];
        event = chart.pointer.normalize(e.originalEvent); // Find coordinates within the chart
        //if (i === 0) console.log(event.chartX + " --- " + event.chartY);
        series = i === 0 ? Math.max(Math.min(Math.floor((130 - event.chartY) / 34), chart.series.length - 1), 0) : 0;
        point = chart.series[series].searchPoint(event, true); // Get the hovered point

        if (point) {
          point.onMouseOver(); // Show the hover marker
          chart.tooltip.refresh(point); // Show the tooltip
          chart.xAxis[0].drawCrosshair(event, point); // Show the crosshair
        }
      }
    });

    /**
     * Synchronize zooming through the setExtremes event handler.
     */
    function syncExtremes(e) {
      var thisChart = this.chart;

      if (e.trigger !== 'syncExtremes') { // Prevent feedback loop
        Highcharts.each(ll.chartArray, function(chart) {
          if (chart !== thisChart) {
            if (chart.inverted) {
              if (chart.yAxis[0].setExtremes) { // It is null while updating
                chart.yAxis[0].setExtremes(e.min, e.max, undefined, false, {
                  trigger: 'syncExtremes'
                });
              }
            } else {
              if (chart.xAxis[0].setExtremes) { // It is null while updating
                chart.xAxis[0].setExtremes(e.min, e.max, undefined, false, {
                  trigger: 'syncExtremes'
                });
              }
            }
          }
        });
      }
    }


    var plotConditions = function(conditions, importantCodes, contacts) {
      ll.charts = 1;
      var series = [];
      $.each(conditions.reverse(), function(i, task) {
        var item = {
          name: task.name,
          data: [],
          color: colour.next()
        };
        $.each(task.intervals, function(j, interval) {
          item.data.push([i + 0.49, interval.from, interval.to]);
        });

        series.push(item);
      });

      var markerTemplate = { "lineWidth": 1, "lineColor": "black", "radius": 8 };
      var markers = {
        "default": $.extend({ "symbol": "triangle" }, markerTemplate),
        "Face to face": $.extend({ "symbol": "square" }, markerTemplate),
        "Telephone": $.extend({ "symbol": "circle" }, markerTemplate),
        "Hospital admission": $.extend({ "symbol": "triangle" }, markerTemplate)
      };
      var contactSeries = {};
      var eventSeries = {};
      $.each(contacts, function(i, contact) {
        if (!contactSeries[contact.name]) {
          contactSeries[contact.name] = Highcharts.extend(contact, {
            data: [],
            type: 'scatter',
            marker: markers[contact.name] || markers.default,
            color: colour.next()
          });
        }
        contactSeries[contact.name].data.push([
              contact.task,
              contact.time
          ]);
      });

      $.each(importantCodes, function(i, event) {
        if (!eventSeries[event.name]) {
          eventSeries[event.name] = Highcharts.extend(event, {
            data: [],
            type: 'scatter',
            marker: markers[event.name] || markers.default,
            color: colour.next()
          });
        }
        eventSeries[event.name].data.push([
              event.task,
              event.time
          ]);
      });

      series = series.concat(Object.keys(contactSeries).map(function(key) {
        return contactSeries[key];
      }));

      series = series.concat(Object.keys(eventSeries).map(function(key) {
        return eventSeries[key];
      }));

      $(elementId).append($('<div class="chart-title">Patient conditions and contacts</div>'));
      // create the chart
      $('<div class="h-chart h-condition-chart">')
        .appendTo(elementId)
        .highcharts({

          chart: {
            renderTo: element,
            marginLeft: 120, // Keep all charts left aligned
            spacingTop: 20,
            spacingBottom: 20,
            type: 'columnrange',
            inverted: true,
            backgroundColor: '#F9F3F9',
            borderWidth: 2,
            borderColor: '#ddd'
          },

          title: '',

          yAxis: {
            type: 'datetime',
            min: Date.UTC(2005, 6, 12),
            max: new Date().getTime(),
            crosshair: true,
            events: {
              setExtremes: syncExtremes
            },
            labels: {
              enabled: false
            },

            //things that are normally xAxis defaults
            endOnTick: false,
            gridLineWidth: 0,
            lineWidth: 1,
            maxPadding: 0.01,
            minPadding: 0.01,
            startOnTick: false,
            tickWidth: 0,
            title: {
              text: ''
            },
            tickPixelInterval: 100
          },

          xAxis: {
            labels: {
              enabled: false
            },
            startOnTick: false,
            endOnTick: false,
            title: {
              text: ''
            },
            tickWidth: 0,
            minPadding: 0.2,
            maxPadding: 0.2,

            //things that are normally yAxis defaults
            gridLineWidth: 0,
            lineWidth: 0

          },
          credits: {
            enabled: false
          },

          legend: {
            enabled: false
          },

          tooltip: {
            formatter: function() {
              if (this.series.data[0].x !== 1 && this.series.data[0].x !== 2) {
                //Range ergo condition
                var yCoord = this.y;
                var labelTmp = conditions[Math.floor(this.x)].intervals.filter(function(v) {
                  return yCoord >= v.from && yCoord <= v.to;
                });
                var label = labelTmp.length > 0 ? labelTmp[0].label : "No label A";
                return '<b>' + conditions[Math.floor(this.x)].name + (label ? ': ' + label : '') + '</b><br/>' +
                  Highcharts.dateFormat('%d/%m/%Y', this.point.options.low) +
                  ' - ' + Highcharts.dateFormat('%d/%m/%Y', this.point.options.high);
              } else {
                //Single value hence contact
                var time = this.y;
                return (this.series.data[0].x === 1 ? importantCodes : contacts).filter(function(val) {
                  return val.data && val.data.filter(function(v) {
                    return v[1] === time;
                  }).length > 0;
                }).map(function(val) {
                  return '<b>' + val.name + '</b><br/>' + Highcharts.dateFormat('%d/%m/%Y', time);
                }).join('<br/>');
              }
            },
            followPointer: true
          },

          plotOptions: {
            columnrange: {
              grouping: false,
              /*groupPadding: 0.3,*/
              dataLabels: {
                allowOverlap: true,
                enabled: true,
                formatter: function() {
                  var yCoord = this.y;
                  var idx = -1;
                  var labelTmp = conditions[Math.floor(this.x)].intervals.filter(function(v, i) {
                    if (yCoord >= v.from && yCoord <= v.to) {
                      idx = i;
                      return true;
                    }
                    return false;
                  });
                  var label = labelTmp.length > 0 ? labelTmp[0].label : "No label B";
                  return this.y === this.point.low &&
                    (conditions[Math.floor(this.x)].intervals.length - 1 === idx ||
                      (this.series.chart.yAxis[0].min <= yCoord && this.series.chart.yAxis[0].max >= yCoord) ||
                      (this.series.chart.yAxis[0].min >= this.point.low && this.series.chart.yAxis[0].max <= this.point.high)) ? conditions[Math.floor(this.x)].name + (label ? ': ' + label : '') : '';
                }
              }
            }
          },

          series: series

        });
    };

    var plotMeasurements = function(measurements) {
      $(elementId).append($('<div class="chart-title">Patient measurements</div>'));
      $.each(measurements, function(i, dataset) {
        ll.charts++;
        // Add X values
        /*if (dataset.data && typeof dataset.data[0] !== "object") {
          dataset.data = Highcharts.map(dataset.data, function(val, j) {
            return [measurements.xData[j], val];
          });
        }*/

        var chartOptions = {
          chart: {
            marginLeft: 120, // Keep all charts left aligned
            spacingTop: 0,
            spacingBottom: 8,
            backgroundColor: '#F9F9F3',
            borderWidth: 2,
            borderColor: '#ddd'
          },
          title: {
            text: '',
            align: 'left',
            margin: 0,
            x: 30
          },
          marker: {
            enabled: true
          },
          credits: {
            enabled: false
          },
          legend: {
            enabled: false
          },
          xAxis: {
            type: 'datetime',
            min: Date.UTC(2005, 6, 12),
            max: new Date().getTime(),
            crosshair: {
              snap: false
            },
            events: {
              setExtremes: syncExtremes
            },
            labels: {
              enabled: false
            },
            lineWidth: 0,
            minorGridLineWidth: 0,
            lineColor: 'transparent',
            minorTickLength: 0,
            tickLength: 0
          },
          yAxis: {
            title: {
              text: dataset.name + "<br>" + dataset.unit.replace(/\^([0-9]+)/, "<sup>$1</sup>") + "",
              margin: 60,
              rotation: 0
            },
            startOnTick: false,
            endOnTick: false,
            labels: {
              style: {
                "textOverflow": "none"
              }
            },
            tickPixelInterval: 25,
            maxPadding: 0.1,
            minPadding: 0.1
          },
          tooltip: {
            positioner: function(labelWidth, labelHeight, point) {
              return {
                x: Math.max(50, point.plotX - labelWidth), // left aligned
                y: -1 // align to title
              };
            },
            useHTML: true,
            pointFormat: '<b>' + dataset.name + ':</b> {point.y} ' + dataset.unit.replace(/\^([0-9]+)/, "<sup>$1</sup>"),
            valueDecimals: dataset.valueDecimals
          },
          plotOptions: {
            series: {
              events: {
                mouseOut: function() {
                  var chart, i;
                  for (i = 1; i < ll.chartArray.length - 2; i = i + 1) {
                    chart = ll.chartArray[i];
                    chart.tooltip.hide();
                  }
                }
              }
            }
          },
          series: [{
            data: dataset.data,
            name: dataset.name,
            type: dataset.type,
            color: colour.next(),
            fillOpacity: 0.3
            }]
        };

        if (dataset.name === "BP") {
          chartOptions.tooltip.pointFormat = "<b>BP:</b> {point.low}/{point.high} mmHg<br/>";
          //chartOptions.series[0].tooltip = {};
          chartOptions.series[0].stemWidth = 3;
          chartOptions.series[0].whiskerWidth = 5;
        }

        /*if (i === 0) {
          chartOptions.title = {
            text: 'Patient measurements',
            align: 'left',
            margin: 1,
            style: {
              color: "#333333",
              fontSize: "12px",
              fontWeight: "bold"
            }
          };
        }*/

        /*if (i === measurements.datasets.length - 1) {
          chartOptions.xAxis = {
            crosshair: true,
            events: {
              setExtremes: syncExtremes
            },
            type: 'datetime'
          };
        }*/
        $('<div class="sync-chart h-chart' + (i === measurements.length - 1 ? " h-last-measurement-chart" : "") + '">')
          .appendTo(elementId)
          .highcharts(chartOptions);

      });
    };

    var plotNavigator = function() {
      ll.charts++;
      var chart = $('<div class="h-chart h-navigator-chart">')
        .appendTo(elementId)
        .highcharts({

          chart: {
            renderTo: element,
            marginLeft: 120, // Keep all charts left aligned
            spacingTop: 20,
            spacingBottom: 20,
            ignoreHiddenSeries: false,
            borderWidth: 2,
            borderColor: '#ddd'
          },

          title: {
            text: ''
          },

          xAxis: {
            type: 'datetime',
            min: Date.UTC(2005, 6, 12),
            max: new Date().getTime(),
            crosshair: false,
            events: {
              setExtremes: syncExtremes
            },
            labels: {
              enabled: false
            },
            lineWidth: 0,
            minorGridLineWidth: 0,
            lineColor: 'transparent',
            minorTickLength: 0,
            tickLength: 0
          },

          yAxis: {
            min: 0,
            max: 1,
            tickInterval: 1,
            startOnTick: false,
            endOnTick: false,
            title: {
              text: ''
            },
            minPadding: 0.2,
            maxPadding: 0.2,
            labels: {
              enabled: false
            }
          },

          legend: {
            enabled: false
          },

          navigator: {
            enabled: true
          },

          plotOptions: {
            line: {
              lineWidth: 0,
              marker: {
                enabled: false
              },
              dataLabels: {
                enabled: false
              }
            }
          },

          series: [{
            "name": "HTN",
            "data": [{
              "x": 1373587200000,
              "y": 0,
              "from": 1373587200000,
              "to": 1459814400000
              }]
            }]

        });
      chart.highcharts().series[0].hide();
    };

    var plotMedications = function(medications) {
      ll.charts++;
      var series = [];
      $.each(medications.reverse(), function(i, task) {
        var item = {
          name: task.name,
          data: [],
          color: colour.next()
        };
        $.each(task.intervals, function(j, interval) {
          item.data.push([i + 0.49, interval.from, interval.to]);
        });

        series.push(item);
      });
      var noData = false;
      if (series.length === 0) {
        series.push({
          type: 'line',
          name: 'Random data',
          data: []
        });
        noData = true;
      }

      //$(elementId).append($('<div class="chart-title"' + (noData ? 'style="display:none"' : '') + '>Patient medications</div>'));
      $(elementId).append($('<div class="chart-title">Patient medications</div>'));
      // create the chart
      //return $('<div class="h-chart h-medication-chart"' + (noData ? 'style="display:none"' : '') + '>')
      return $('<div class="h-chart h-medication-chart">')
        .appendTo(elementId)
        .highcharts({

          chart: {
            renderTo: element,
            marginLeft: 120, // Keep all charts left aligned
            spacingTop: 20,
            spacingBottom: 20,
            type: 'columnrange',
            inverted: true,
            backgroundColor: '#F3F9F9'
          },
          lang: {
            noData: "No relevant medications"
          },
          noData: {
            style: {
              fontWeight: 'bold',
              fontSize: '15px',
              color: '#303030'
            }
          },

          title: '',
          /*{
                      text: 'Patient medications',
                      align: 'left',
                      margin: 1,
                      style: {
                        color: "#333333",
                        fontSize: "12px",
                        fontWeight: "bold"
                      }
                    },*/


          yAxis: {
            type: 'datetime',
            min: Date.UTC(2005, 6, 12),
            max: new Date().getTime(),
            crosshair: {
              snap: false
            },
            events: {
              setExtremes: syncExtremes
            },



            //things that are normally xAxis defaults
            endOnTick: false,
            gridLineWidth: 0,
            lineWidth: 1,
            maxPadding: 0.01,
            minPadding: 0.01,
            startOnTick: false,
            tickWidth: 1,
            title: {
              text: ''
            },
            tickPixelInterval: 100
          },

          xAxis: {
            labels: {
              enabled: false
            },
            startOnTick: false,
            endOnTick: false,
            title: {
              text: ''
            },
            tickWidth: 0,
            minPadding: 0.2,
            maxPadding: 0.2,

            //things that are normally yAxis defaults
            gridLineWidth: 0,
            lineWidth: 0
          },
          credits: {
            enabled: false
          },

          legend: {
            enabled: false
          },

          tooltip: {
            formatter: function() {
              var yCoord = this.y;
              var labelTmp = medications[Math.floor(this.x)].intervals.filter(function(v) {
                return yCoord >= v.from && yCoord <= v.to;
              });
              var label = labelTmp.length > 0 ? labelTmp[0].label : "No label C";
              return '<b>' + medications[Math.floor(this.x)].name + (label ? ': ' + label : '') + '</b><br/>' +
                Highcharts.dateFormat('%d/%m/%Y', this.point.options.low) +
                ' - ' + Highcharts.dateFormat('%d/%m/%Y', this.point.options.high);
            },
            followPointer: true
          },

          plotOptions: {
            columnrange: {
              grouping: false,
              dataLabels: {
                allowOverlap: true,
                enabled: true,
                formatter: function() {
                  var yCoord = this.y;
                  var idx = -1;
                  var labelTmp = medications[Math.floor(this.x)].intervals.filter(function(v, i) {
                    if (yCoord >= v.from && yCoord <= v.to) {
                      idx = i;
                      return true;
                    }
                    return false;
                  });
                  var label = labelTmp.length > 0 ? labelTmp[0].label : "No label D";
                  return this.y === this.point.low &&
                    (medications[Math.floor(this.x)].intervals.length - 1 === idx ||
                      (this.series.chart.yAxis[0].min <= yCoord && this.series.chart.yAxis[0].max >= yCoord) ||
                      (this.series.chart.yAxis[0].min >= this.point.low && this.series.chart.yAxis[0].max <= this.point.high)) ? medications[Math.floor(this.x)].name + (label ? ': ' + label : '') : '';
                }
              }
            }
          },

          series: series

        });
    };

    plotConditions(data.conditions, data.events, data.contacts);
    plotMeasurements(data.measurements);
    var c = plotMedications(data.medications);
    plotNavigator();
    c.highcharts().axes[1].setExtremes(1434864000000, 1459814400000, undefined, false, {
      trigger: 'syncExtremes'
    });

    ll.chartArray = Highcharts.charts.slice(Highcharts.charts.length - ll.charts, Highcharts.charts.length);

    var s = syncExtremes.bind(c.highcharts().series[0]);
    s({
      trigger: 'navigator',
      min: 1434864000000,
      max: 1459814400000
    });
  }

};

module.exports = ll;

},{"../base.js":7,"highcharts/highcharts-more":1,"highcharts/highstock":2}],24:[function(require,module,exports){
var base = require('../base.js'),
  confirm = require('./confirm.js'),
  data = require('../data.js'),
  log = require('../log.js');

var med = {

  create: function(pathwayId, pathwayStage, standard, patientId) {
    var medications = data.patients[patientId].medications || [];
    var agree = log.getPatientAgreeObject(pathwayId, pathwayStage, standard, patientId, "medication");
    return base.createPanel(medicationPanel, {
      "areMedications": medications.length > 0,
      "agree": agree && agree.agree,
      "disagree": agree && agree.agree === false,
      "pathway": data.pathwayNames[pathwayId],
      "medications": medications,
      "pathwayStage": pathwayStage
    }, {
      "medicationRow": $('#medication-row').html()
    });
  },

  wireUp: function(pathwayId, pathwayStage, standard, patientId) {
    confirm.wireUp($('#medication-agree-disagree'), $('#medication-panel'), pathwayId, pathwayStage, standard, patientId, "medication", "medication data");
  }

};

module.exports = med;

},{"../base.js":7,"../data.js":9,"../log.js":11,"./confirm.js":16}],25:[function(require,module,exports){
var base = require('../base.js'),
  confirm = require('./confirm.js'),
  data = require('../data.js'),
  log = require('../log.js');

var other = {

  create: function(pathwayId, pathwayStage, standard, patientId) {
    var codes = (data.patients[patientId].codes || []).map(function(val) {
      val.description = data.codes[val.code];
      return val;
    });
    var agree = log.getPatientAgreeObject(pathwayId, pathwayStage, standard, patientId, "codes");
    return base.createPanel($('#other-codes-panel'), {
      "areCodes": codes.length > 0,
      "agree": agree && agree.agree,
      "disagree": agree && agree.agree === false,
      "pathway": data.pathwayNames[pathwayId],
      "standard": data[pathwayId][pathwayStage].standards[standard].tab.title,
      "codes": codes,
      "pathwayStage": pathwayStage
    }, {
      "codeRow": $('#other-codes-row').html()
    });
  },

  wireUp: function(pathwayId, pathwayStage, standard, patientId) {
    confirm.wireUp($('#other-codes-agree-disagree'), $('#other-codes-panel'), pathwayId, pathwayStage, standard, patientId, "codes", "other codes");
  }

};

module.exports = other;

},{"../base.js":7,"../data.js":9,"../log.js":11,"./confirm.js":16}],26:[function(require,module,exports){
var data = require('../data.js'),
  Mustache = require('mustache');

var pc = {

  show: function(panel, isAppend, patientId) {

    var patientData = data.getPatientData(patientId);

    var tempMust = $('#patient-characteristics-panel').html();
    var html = Mustache.render(tempMust, patientData.characteristics);

    if (isAppend) panel.append(html);
    else panel.html(html);

  }

};

module.exports = pc;

},{"../data.js":9,"mustache":4}],27:[function(require,module,exports){
var Highcharts = require('highcharts/highstock'),
  base = require('../base.js'),
  data = require('../data.js'),
  lookup = require('../lookup.js'),
  Mustache = require('mustache');

var ID = "PATIENT_LIST";

var pl = {

  wireUp: function(onPatientSelected) {
    patientsPanel = $('#patients');

    patientsPanel.on('click', 'thead tr th.sortable', function() { //Sort columns when column header clicked
      var sortAsc = !$(this).hasClass('sort-asc');
      if (sortAsc) {
        $(this).removeClass('sort-desc').addClass('sort-asc');
      } else {
        $(this).removeClass('sort-asc').addClass('sort-desc');
      }
      pl.populate(pl.state[0], pl.state[1], pl.state[2], pl.state[3], $(this).index(), sortAsc);
    }).on('click', 'tbody tr', function(e) { //Select individual patient when row clicked#
      var callback = onPatientSelected.bind(this);
      var patientId = $(this).find('td button').attr('data-patient-id');
      callback(patientId);
      e.preventDefault();
      e.stopPropagation();
    }).on('click', 'tbody tr button', function(e) {
      //don't want row selected if just button pressed?
      e.preventDefault();
      e.stopPropagation();
    });
  },

  selectSubsection: function(section) {
    pl.populate(pl.state[0], pl.state[1], pl.state[2], section, pl.state[4], pl.state[5]);
  },

  populate: function(pathwayId, pathwayStage, standard, subsection, sortField, sortAsc) {
    pl.state = [pathwayId, pathwayStage, standard, subsection, sortField, sortAsc];
    patientsPanel = $('#patients');
    //Remove scroll if exists
    patientsPanel.find('div.table-scroll').getNiceScroll().remove();

    var i, k, prop, header, pList = [];

    data.getIndicatorData([pathwayId, pathwayStage, standard].join("."), function(indicators) {

      if (pathwayId && pathwayStage && standard && subsection) {
        pList = indicators.opportunities.filter(function(val) {
          return val.name === subsection;
        })[0].patients;
        header = indicators.opportunities.filter(function(val) {
          return val.name === subsection;
        })[0].description;
      } else if (pathwayId && pathwayStage && standard) {
        pList = indicators.opportunities.reduce(function(a, b) {
          return a.patients ? a.patients.concat(b.patients) : a.concat(b.patients);
        });
        header = data.text[pathwayId][pathwayStage].standards[standard].tableTitle;
      }

      pList = data.removeDuplicates(pList);
      var vId = data.text[pathwayId][pathwayStage].standards[standard].valueId;
      var dOv = data.text[pathwayId][pathwayStage].standards[standard].dateORvalue;
      var patients = pList.map(function(patientId) {
        var ret = indicators.patients[patientId];
        ret.nhsNumber = data.patLookup[patientId] || patientId;
        ret.patientId = patientId;
        ret.items = [data.patients[patientId].characteristics.age]; //The fields in the patient list table

        var measures = data.patients[patientId].measurements.filter(function(v){return v.id===vId;});

        if ( measures[0] && measures[0].data) {
          if (dOv === "date") {
            ret.items.push(new Date(measures[0].data[measures[0].data.length-1][0]));
          } else {
            ret.items.push(measures[0].data[measures[0].data.length-1][1]);
          }
        } else {
          ret.items.push("?");
        }
        ret.items.push(indicators.patients[patientId].opportunities.map(function(v){return '<span style="width:13px;height:13px;float:left;background-color:' + Highcharts.getOptions().colors[v] + '"></span>';}).join(""));
        //ret.items.push(data.numberOfStandardsMissed(patientId));
        return ret;
      });

      var localData = {
        "patients": patients,
        "n": patients.length,
        "header": header,
        "header-items": [{
          "title": "NHS no.",
          "isSorted": false,
          "direction": "sort-asc",
          "tooltip": "NHS number of each patient"
        },{
          "title": "Age",
          "isSorted": false,
          "direction": "sort-asc",
          "tooltip": "The age of the patient"
        }]
      };

      //middle column is either value or date
      if (dOv) {
        localData["header-items"].push({
          "title": data.text[pathwayId][pathwayStage].standards[standard].valueName,
          "tooltip": dOv === "date" ? "Last date " + vId + " was measured" : "Last " + vId + " reading",
          "isSorted": false,
          "direction": "sort-asc"
        });
      } else {
        if (pathwayStage === lookup.categories.monitoring.name) {
          localData["header-items"].push({
            "title": "Last BP Date",
            "isSorted": false,
            "direction": "sort-asc",
            "tooltip": "Last date BP was measured"
          });
        } else {
          localData["header-items"].push({
            "title": "Last SBP",
            "tooltip": "Last systolic BP reading",
            "isSorted": false,
            "direction": "sort-asc"
          });
        }
      }

      //add qual standard column
      localData["header-items"].push({
        "title": "Categories",
        "titleHTML": 'Categories',
        "isSorted": true,
        "tooltip": "Categories from above chart"
      });

      if (sortField === undefined) sortField = 2;
      if (sortField !== undefined) {
        localData.patients.sort(function(a, b) {
          if (sortField === 0) { //NHS number
            if (a.nhsNumber === b.nhsNumber) {
              return 0;
            }

            if (a.nhsNumber > b.nhsNumber) {
              return sortAsc ? 1 : -1;
            } else if (a.nhsNumber < b.nhsNumber) {
              return sortAsc ? -1 : 1;
            }
          } else {
            if (a.items[sortField - 1] === b.items[sortField - 1]) {
              return 0;
            }

            if (a.items[sortField - 1] == "?") return 1;
            if (b.items[sortField - 1] == "?") return -1;

            var A = Number(a.items[sortField - 1]);
            var B = Number(b.items[sortField - 1]);
            if (isNaN(A) || isNaN(B)) {
              A = a.items[sortField - 1];
              B = b.items[sortField - 1];
            }
            if (A > B) {
              return sortAsc ? 1 : -1;
            } else if (A < B) {
              return sortAsc ? -1 : 1;
            }
          }
        });

        for (i = 0; i < localData["header-items"].length; i++) {
          if (i === sortField) {
            localData["header-items"][i].direction = sortAsc ? "sort-asc" : "sort-desc";
            localData["header-items"][i].isAsc = sortAsc;
            localData["header-items"][i].isSorted = true;
          } else {
            localData["header-items"][i].isSorted = false;
          }
        }
      }

      base.createPanelShow(patientList, patientsPanel, localData, {
        "header-item": $("#patient-list-header-item").html(),
        "item": $('#patient-list-item').html()
      });

      $('#patients-placeholder').hide();

      base.setupClipboard($('.btn-copy'), true);

      base.wireUpTooltips();

      patientsPanel.find('div.table-scroll').niceScroll({
        cursoropacitymin: 0.3,
        cursorwidth: "7px",
        horizrailenabled: false
      });

    });

  },

  show: function(panel, isAppend, pathwayId, pathwayStage, standard, loadContentFn) {

    var tempMust = $('#patients-panel-yes').html();

    if(isAppend) panel.append(Mustache.render(tempMust));
    else panel.html(Mustache.render(tempMust));

    pl.wireUp(function(patientId) {
      history.pushState(null, null, '#patient/' + patientId);
      loadContentFn('#patient/' + patientId);
    });
    pl.populate(pathwayId, pathwayStage, standard, null);
  }

};

module.exports = pl;

},{"../base.js":7,"../data.js":9,"../lookup.js":12,"highcharts/highstock":2,"mustache":4}],28:[function(require,module,exports){
var base = require('../base.js'),
  data = require('../data.js'),
  lookup = require('../lookup.js'),
  Mustache = require('mustache');
var states, loadContFn, ID = "PATIENT_SEARCH";

var ps = {

  wireUp: function() {
    if (states) {
      states.clearPrefetchCache();
    }

    states = new Bloodhound({
      datumTokenizer: Bloodhound.tokenizers.obj.whitespace('value'),
      queryTokenizer: Bloodhound.tokenizers.whitespace,
      local: $.map(data.patientArray, function(state) {
        return {
          id: state,
          value: data.patLookup && data.patLookup[state] ? data.patLookup[state] : state
        };
      })
    });

    states.initialize(true);

    $('#search-box').find('.typeahead').typeahead('destroy');
    $('#search-box').find('.typeahead').typeahead({
        hint: true,
        highlight: true,
        minLength: 1,
        autoselect: true
      }, {
        name: 'patients',
        displayKey: 'value',
        source: states.ttAdapter(),
        templates: {
          empty: [
              '<div class="empty-message">',
                '&nbsp; &nbsp; No matches',
              '</div>'
            ].join('\n')
        }
      }).on('typeahead:selected', ps.onSelected)
      .on('typeahead:autocompleted', ps.onSelected);

    $('#searchbtn').on('mousedown', function() {
      var val = $('.typeahead').eq(0).val();
      if (!val || val === "") val = $('.typeahead').eq(1).val();
      ps.onSelected(null, {
        "id": val
      });
    });
  },

  onSelected: function($e, nhsNumberObject) {
    //Hide the suggestions panel
    $('#search-box').find('.tt-dropdown-menu').css('display', 'none');

    history.pushState(null, null, '#patients/' + nhsNumberObject.id);
    loadContFn('#patients/' + nhsNumberObject.id, true);

  },

  show: function(panel, isAppend, loadContentFn) {

    loadContFn = loadContentFn;
    var tempMust = $('#patient-search').html();

    if(isAppend) panel.append(Mustache.render(tempMust));
    else panel.html(Mustache.render(tempMust));

    ps.wireUp();
  }

};

module.exports = ps;

},{"../base.js":7,"../data.js":9,"../lookup.js":12,"mustache":4}],29:[function(require,module,exports){
var base = require('../base.js'),
  data = require('../data.js'),
  lookup = require('../lookup.js'),
  chart = require('../chart.js'),
  qualityStandard = require('./qualityStandard.js'),
  otherCodes = require('./otherCodes.js'),
  medication = require('./medication.js'),
  trend = require('./trend.js'),
  individualActionPlan = require('./individualActionPlan.js'),
  patientList = require('./patientList.js');

var pt = {

  create: function(pathwayId, pathwayStage, standard) {
    var tabData = [];
    for (var key in data[pathwayId][pathwayStage].standards) {
      tabData.push({
        "header": data[pathwayId][pathwayStage].standards[key].tab,
        "active": key === standard,
        "url": window.location.hash.replace(/\/no.*/g, '\/no/' + key)
      });
    }
    return base.createPanel(patientsPanelTemplate, {
      "pathwayStage": pathwayStage,
      "header": data[pathwayId][pathwayStage].standards[standard].chartTitle,
      "tooltip": data[pathwayId][pathwayStage].standards[standard].tooltip,
      "url": window.location.hash.replace(/\/yes.*/g, '').replace(/\/no.*/g, ''),
      "tabs": tabData,
      "text": data[pathwayId][pathwayStage].text
    }, {
      "content": $('#patients-panel-no').html(),
      "tab-header": $('#patients-panel-no-tabs').html(),
      "tab-content": $('#patients-panel-no-page').html()
    });
  },

  createOk: function(pathwayId, pathwayStage) {
    return base.createPanel(patientsPanelTemplate, {
      "ok": true,
      "pathwayStage": pathwayStage,
      "url": window.location.hash.replace(/\/yes/g, '').replace(/\/no/g, ''),
      "text": data[pathwayId][pathwayStage].text
    }, {
      "content": $('#patients-panel-yes').html()
    });
  },

  wireUp: function(pathwayId, pathwayStage, location, standard) {

    patientList.wireUp(function(patientId){
      $('[data-toggle="tooltip"]').tooltip('hide');
      $(this).tooltip('destroy');
      base.clearBox();
      $('.list-item').removeClass('highlighted');
      $(this).addClass('highlighted').removeAttr("title");

      pt.showPathwayStagePatientView(patientId, pathwayId, selected, standard);
    });

    patientsPanel = $('#patients');

    location.off('click', '#breakdown-chart');
    location.on('click', '#breakdown-chart', function() {
      if (!lookup.chartClicked) {
        /*jshint unused: true*/
        $('path.c3-bar').attr('class', function(index, classNames) {
          return classNames.replace(/_unselected_/g, '');
        });
        /*jshint unused: false*/

        if (lookup.charts['breakdown-chart']) lookup.charts['breakdown-chart'].unselect();

        patientList.populate(pathwayId, pathwayStage, standard, null);
        data.subselected = null;

        farRightPanel.fadeOut(200);
      }
      lookup.chartClicked = false;
    });

    chart.destroyCharts(['breakdown-chart']);
    setTimeout(function() {
      lookup.charts['breakdown-chart'] = c3.generate({
        bindto: '#breakdown-chart',
        tooltip: {
          format: {
            name: function(name, a, b) {
              var text = data[pathwayId][pathwayStage].standards[standard].opportunities[lookup.index].desc;
              var html = "";
              while (text.length > 40) {
                if (text.indexOf(' ', 40) < 0) break;
                html += text.substr(0, text.indexOf(' ', 40)) + '<br>';
                text = text.substr(text.indexOf(' ', 40) + 1);
              }
              html += text;
              return html;
            },
            value: function(value, ratio, id, index) {
              lookup.index = index;
              return value;
            }
          }
        },
        data: {
          columns: [
            ["Patients"].concat(data[pathwayId][pathwayStage].standards[standard].opportunities.map(function(val) {
              return val.patients.length;
            }))
          ],
          type: 'bar',
          labels: true,
          color: function(color, d) {
            return lookup.colors[d.index];
          },
          selection: {
            enabled: true
          },
          onclick: function(d) {
            chart.selectPieSlice('breakdown-chart', d);
            patientList.populate(pathwayId, pathwayStage, standard, data[pathwayId][pathwayStage].standards[standard].opportunities[d.index].name);
            data.subselected = data[pathwayId][pathwayStage].standards[standard].opportunities[d.index].name;

            //colour table appropriately - need to add opacity
            var sliceColourHex = lookup.colors[d.index];
            var shorthandRegex = /^#?([a-f\d])([a-f\d])([a-f\d])$/i;
            sliceColourHex = sliceColourHex.replace(shorthandRegex, function(m, r, g, b) {
              return r + r + g + g + b + b;
            });
            var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(sliceColourHex);
            var opacity = 0.2;
            var sliceColour = 'rgba(' + parseInt(result[1], 16) + ',' + parseInt(result[2], 16) + ',' + parseInt(result[3], 16) + ',' + opacity + ')';

            $('.table.patient-list.table-head-hidden').css({
              "backgroundColor": sliceColour
            });
          }
        },
        bar: {
          width: {
            ratio: 0.5
          }
        },
        legend: {
          show: false
        },
        grid: {
          focus: {
            show: false
          }
        },
        axis: {
          x: {
            type: 'category',
            categories: data[pathwayId][pathwayStage].standards[standard].opportunities.map(function(val) {
              return val.name;
            }),
            label: false
          },
          y: {
            label: {
              text: 'Patient count (n)',
              position: 'outer-middle'
            }
          }
        }
      });
    }, 1);
  },

  wireUpOk: function(pathwayId, pathwayStage, location) {
    patientsPanel = $('#patients');

    patientsPanel.on('click', 'thead tr th.sortable', function() { //Sort columns when column header clicked
      var sortAsc = !$(this).hasClass('sort-asc');
      if (sortAsc) {
        $(this).removeClass('sort-desc').addClass('sort-asc');
      } else {
        $(this).removeClass('sort-asc').addClass('sort-desc');
      }
      pt.populateOk(pathwayId, data.selected, data.subselected, $(this).index(), sortAsc);
    }).on('click', 'tbody tr', function(e) { //Select individual patient when row clicked
      $('[data-toggle="tooltip"]').tooltip('hide');
      $(this).tooltip('destroy');
      base.clearBox();
      $('.list-item').removeClass('highlighted');
      $(this).addClass('highlighted').removeAttr('title');

      var patientId = $(this).find('td button').attr('data-patient-id');

      pt.showPathwayStagePatientView(patientId, pathwayId, data.selected, null);
      e.preventDefault();
      e.stopPropagation();
    }).on('click', 'tbody tr button', function(e) {
      //don't want row selected if just button pressed?
      e.preventDefault();
      e.stopPropagation();
    });

    data.selected = pathwayStage;
    data.subselected = null;
  },

  populateOk: function(pathwayId, pathwayStage, subsection, sortField, sortAsc) {
    var pList = [],
      i, k, prop, header, tooltip;
    patientsPanel.fadeOut(200, function() {
      $(this).fadeIn(200);
    });

    pList = data[pathwayId][pathwayStage].patientsOk;
    header = data[pathwayId][pathwayStage].text.panelOkHeader.text;
    tooltip = data[pathwayId][pathwayStage].text.panelOkHeader.tooltip;

    pList = data.removeDuplicates(pList);
    var patients = pList.map(function(patientId) {
      var ret = data.patients[patientId];
      ret.nhsNumber = data.patLookup ? data.patLookup[patientId] : patientId;
      ret.patientId = patientId;
      ret.items = []; //The fields in the patient list table
      ret.items.push(data.patients[patientId].breach ? data.numberOfStandardsMissed(patientId) : 0);
      return ret;
    });
    var localData = {
      "patients": patients,
      "n": patients.length,
      "header": header,
      "tooltip": tooltip,
      "header-items": [{
        "title": "NHS no.",
        "isSorted": false,
        "direction": "sort-asc"
      }, {
        "title": "All Opportunities",
        "titleHTML": '# of <i class="fa fa-flag" style="color:red"></i>',
        "isSorted": true,
        "direction": "sort-desc",
        "tooltip": "Total number of improvement opportunities available across all conditions"
      }]
    };

    if (sortField === undefined) sortField = 1;

    localData.patients.sort(function(a, b) {
      if (sortField === 0) { //NHS number
        if (a.nhsNumber === b.nhsNumber) {
          return 0;
        }

        if (a.nhsNumber > b.nhsNumber) {
          return sortAsc ? 1 : -1;
        } else if (a.nhsNumber < b.nhsNumber) {
          return sortAsc ? -1 : 1;
        }
      } else {
        if (a.items[sortField - 1] === b.items[sortField - 1]) {
          return 0;
        }

        var A = Number(a.items[sortField - 1]);
        var B = Number(b.items[sortField - 1]);
        if (isNaN(A) || isNaN(B)) {
          A = a.items[sortField - 1];
          B = b.items[sortField - 1];
        }
        if (A > B) {
          return sortAsc ? 1 : -1;
        } else if (A < B) {
          return sortAsc ? -1 : 1;
        }
      }
    });

    for (i = 0; i < localData["header-items"].length; i++) {
      if (i === sortField) {
        localData["header-items"][i].direction = sortAsc ? "sort-asc" : "sort-desc";
        localData["header-items"][i].isAsc = sortAsc;
        localData["header-items"][i].isSorted = true;
      } else {
        localData["header-items"][i].isSorted = false;
      }
    }


    base.createPanelShow(patientList, patientsPanel, localData, {
      "header-item": $("#patient-list-header-item").html(),
      "item": $('#patient-list-item').html()
    });

    $('#patients-placeholder').hide();

    base.setupClipboard($('.btn-copy'), true);

    base.wireUpTooltips();

    var c = patientsPanel.find('div.table-scroll').getNiceScroll();
    if (c && c.length > 0) {
      c.resize();
    } else {
      patientsPanel.find('div.table-scroll').niceScroll({
        cursoropacitymin: 0.3,
        cursorwidth: "7px",
        horizrailenabled: false
      });
    }
  },

  //Show patient view within the pathway stage view
  showPathwayStagePatientView: function(patientId, pathwayId, pathwayStage, standard) {
    data.patientId = patientId;

    base.switchTo110Layout();

    pt.showIndividualPatientPanel(pathwayId, pathwayStage, standard, patientId);
  },

  showIndividualPatientPanel: function(pathwayId, pathwayStage, standard, patientId) {
    var stan = data[pathwayId][pathwayStage].standards[standard] ? data[pathwayId][pathwayStage].standards[standard].tab.title : "UNSPECIFIED";

    data.options.sort(function(a, b) {
      a = data.getPatientStatus(patientId, a.pathwayId, a.pathwayStage, a.standard);
      b = data.getPatientStatus(patientId, b.pathwayId, b.pathwayStage, b.standard);

      if (a === b) return 0;
      if (a === "not") return 1;
      if (b === "not") return -1;
      if (a === "ok") return 1;
      if (b === "ok") return -1;
      alert("!!!!!!!");
    });

    var panel = base.createPanel($('#patient-panel'), {
      "options": data.options,
      "numberOfStandardsMissed": data.numberOfStandardsMissed(patientId),
      "standard": stan,
      "pathwayStage": pathwayStage,
      "nhsNumber": data.patLookup ? data.patLookup[patientId] : patientId,
      "patientId": patientId
    }, {
      "option": $('#patient-panel-drop-down-options').html()
    });

    if (standard === null) {
      //Must be a patient from the *** OK group
      standard = data.options.filter(function(val) {
        return val.pathwayId === pathwayId && val.pathwayStage === pathwayStage;
      })[0].standard;
    }

    farRightPanel.html("");
    $('#temp-hidden').html(panel);

    var actionPlan = individualActionPlan.create(pathwayStage);
    $('#temp-hidden #patient-panel-right').html(actionPlan);

    var qualPanel = qualityStandard.create(pathwayId, pathwayStage, standard, patientId);
    var trendPanel = trend.create(pathwayId, pathwayStage, standard, patientId);
    var medPanel = medication.create(pathwayId, pathwayStage, standard, patientId);
    var codesPanel = otherCodes.create(pathwayId, pathwayStage, standard, patientId);
    var medCodeWrapperPanel = base.createPanel($('#other-codes-and-meds-wrapper-panel'));
    $('#temp-hidden #patient-panel-top').html(qualPanel);
    $('#temp-hidden #patient-panel-left').html("").append(trendPanel).append(medCodeWrapperPanel);
    $('#temp-hidden #medCodeWrapperPanel').append(medPanel).append(codesPanel);

    if (farRightPanel.is(':visible')) {
      farRightPanel.fadeOut(500, function() {
        $(this).html($('#temp-hidden').html());
        $('#temp-hidden').html("");
        individualActionPlan.wireUp(pathwayId, pathwayStage, standard, patientId);
        qualityStandard.wireUp(pathwayId, pathwayStage, standard, patientId);
        base.wireUpStandardDropDown(pathwayId, pathwayStage, standard, pt.showIndividualPatientPanel);
        trend.wireUp(pathwayId, pathwayStage, standard, patientId);
        medication.wireUp(pathwayId, pathwayStage, standard, patientId);
        otherCodes.wireUp(pathwayId, pathwayStage, standard, patientId);
        chart.drawTrendChart(patientId, pathwayId, pathwayStage, standard);
        $(this).fadeIn(500, function() {});
      });
    } else {
      farRightPanel.html($('#temp-hidden').html());
      $('#temp-hidden').html("");
      individualActionPlan.wireUp(pathwayId, pathwayStage, standard, patientId);
      qualityStandard.wireUp(pathwayId, pathwayStage, standard, patientId);
      base.wireUpStandardDropDown(pathwayId, pathwayStage, standard, pt.showIndividualPatientPanel);
      trend.wireUp(pathwayId, pathwayStage, standard, patientId);
      medication.wireUp(pathwayId, pathwayStage, standard, patientId);
      otherCodes.wireUp(pathwayId, pathwayStage, standard, patientId);
      chart.drawTrendChart(patientId, pathwayId, pathwayStage, standard);
      farRightPanel.fadeIn(500, function() {});
    }
  }

};

module.exports = pt;

},{"../base.js":7,"../chart.js":8,"../data.js":9,"../lookup.js":12,"./individualActionPlan.js":22,"./medication.js":24,"./otherCodes.js":25,"./patientList.js":27,"./qualityStandard.js":30,"./trend.js":33}],30:[function(require,module,exports){
var base = require('../base.js'),
  data = require('../data.js'),
  log = require('../log.js'),
  confirm = require('./confirm.js');

var ID = "QUALITYSTANDARD";

var qs = {

  create: function(pathwayId, pathwayStage, standard, patientId) {

    var localData = {
      "nhsNumber": data.patLookup ? data.patLookup[patientId] : patientId,
      "patientId": patientId
    };
    localData.standard = data.pathwayNames[pathwayId] + ' - ' + pathwayStage;
    if (data.patients[patientId].standards && data.patients[patientId].standards[pathwayId] &&
      data.patients[patientId].standards[pathwayId][pathwayStage] &&
      data.patients[patientId].standards[pathwayId][pathwayStage][standard]) {
      localData.standard = data.patients[patientId].standards[pathwayId][pathwayStage][standard];
    }

    localData.tooltip = data[pathwayId][pathwayStage].standards[standard]["standard-met-tooltip"];

    switch (data.getPatientStatus(patientId, pathwayId, pathwayStage, standard)) {
      case "ok":
        ////farRightPanel.removeClass('standard-missed-page').addClass('standard-achieved-page').removeClass('standard-not-relevant-page');
        localData.achieved = true;
        localData.relevant = true;
        break;
      case "missed":
        ////farRightPanel.addClass('standard-missed-page').removeClass('standard-achieved-page').removeClass('standard-not-relevant-page');
        localData.relevant = true;
        localData.achieved = false;
        break;
      case "not":
        ////farRightPanel.removeClass('standard-missed-page').removeClass('standard-achieved-page').addClass('standard-not-relevant-page');
        localData.relevant = false;
        break;
    }

    var agObj = log.getPatientAgreeObject(pathwayId, pathwayStage, standard, patientId, "standard");
    if (agObj && agObj.agree) localData.agree = true;
    else if (agObj && agObj.agree === false) localData.disagree = true;

    return base.createPanel($('#qual-standard'), localData);
  },

  show: function(panel, pathwayId, pathwayStage, standard, patientId){

    var panelId = panel.attr("id");

    if (base.panels[panelId] &&
      base.panels[panelId].id === ID &&
      base.panels[panelId].patientId === patientId) {
        //Already showing the right thing
        return;
    }

    base.panels[panelId] = {
      id: ID,
      patientId: patientId
    };

    panel.html(qs.create(pathwayId, pathwayStage, standard, patientId));
    qs.wireUp(pathwayId, pathwayStage, standard, patientId);
  },

  wireUp: function(pathwayId, pathwayStage, standard, patientId) {
    confirm.wireUp($('#qual-agree-disagree'), $('#individual-panel-classification'), pathwayId, pathwayStage, standard, patientId, "standard", "quality standard");
  },

  update: function() {
    $('#individual-panel-classification').find('div').each(function() {
      var self = $(this);
      var any = false;
      self.find('.btn-toggle input[type=checkbox]:checked').each(function() {
        var isClassification = $(this).closest("div").data("isClassification") !== undefined;
        any = true;
        var item = log.getAgrees()[data.patientId].filter(function(i) {
          return isClassification ? i.item === "section" : i.item !== "section";
        });
        var tool;
        if (this.value === "yes") {
          if (item && item[0].history) {
            tool = "<p>" + item[0].history[0] + "</p><p>Click again to cancel</p>";
            $(this).parent().attr("title", tool).attr("data-original-title", tool).tooltip('fixTitle').tooltip('hide');
          } else {
            $(this).parent().attr("title", "You agreed - click again to cancel").tooltip('fixTitle').tooltip('hide');
          }
        } else {
          if (item && item[0].history) {
            tool = "<p>" + item[0].history[0] + "</p><p>Click again to edit/cancel</p>";
            $(this).parent().attr("title", tool).attr("data-original-title", tool).tooltip('fixTitle').tooltip('hide');
          } else {
            $(this).parent().attr("title", "You disagreed - click again to edit/cancel").tooltip('fixTitle').tooltip('hide');
          }
        }
      });

      if (self.find('.btn-toggle input[type=checkbox]:not(:checked)').length == 1) {
        self.find('.btn-toggle input[type=checkbox]:not(:checked)').parent().addClass("inactive").attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
      }

      if (!any) {
        self.find('.btn-toggle.btn-yes').attr("title", "Click to agree with this action and save it in your agreed actions list  ").tooltip('fixTitle').tooltip('hide');
        self.find('.btn-toggle.btn-no').attr("title", "Click to disagree with this action and remove it from your suggested actions list ").tooltip('fixTitle').tooltip('hide');
      }

      base.wireUpTooltips();
    });

    base.wireUpTooltips();
  }

};

module.exports = qs;

},{"../base.js":7,"../data.js":9,"../log.js":11,"./confirm.js":16}],31:[function(require,module,exports){
var data = require('../data.js'),
  Mustache = require('mustache');

var qs = {

  show: function(panel, isAppend, patientId) {

    var patientData = data.getPatientData(patientId);

    var tempMust = $('#quality-standard-panel').html();
    var html = Mustache.render(tempMust, {
      "standards": patientData.standards
    });

    if (isAppend) panel.append(html);
    else panel.html(html);

  }

};

module.exports = qs;

},{"../data.js":9,"mustache":4}],32:[function(require,module,exports){
var base = require('../base.js'),
  confirm = require('./confirm.js'),
  data = require('../data.js'),
  log = require('../log.js');

var tap = {

  show: function(location) {
    location.removeClass('standard-missed-page').removeClass('standard-achieved-page').removeClass('standard-not-relevant-page');
    base.createPanelShow($('#team-action-plan-panel'), location);

    suggestedPlanTeam = $('#suggestedPlanTeam');

    suggestedPlanTeam.on('click', '.cr-styled input[type=checkbox]', function() {
      var ACTIONID = $(this).closest('tr').data('id');
      log.editAction("team", ACTIONID, null, this.checked);

      if (this.checked) {
        log.recordEvent(data.pathwayId, "team", "Item completed");
        var self = this;
        $(self).parent().attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
        base.wireUpTooltips();
        setTimeout(function(e) {
          $(self).parent().fadeOut(300, function() {
            var parent = $(this).parent();
            $(this).replaceWith(base.createPanel($('#checkbox-template'), {
              "done": true
            }));
            parent.find('button').on('click', function() {
              ACTIONID = $(this).closest('tr').data('id');
              log.editAction("team", ACTIONID, null, false);
              $(this).replaceWith(base.createPanel($('#checkbox-template'), {
                "done": false
              }));
              tap.updateTeamSapRows();
            });
          });
        }, 1000);
      }

      tap.updateTeamSapRows();
    });

    $('#personalPlanTeam').on('click', 'input[type=checkbox]', function() {
      var PLANID = $(this).closest('tr').data("id");
      editPlan(PLANID, null, this.checked);

      if (this.checked) {
        $(this).parent().parent().parent().addClass('success');
        recordEvent(data.pathwayId, "team", "Personal plan item");
        var self = this;
        $(self).parent().attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
        setTimeout(function(e) {
          $(self).parent().fadeOut(300, function() {
            var parent = $(this).parent();
            $(this).replaceWith(base.createPanel($('#checkbox-template'), {
              "done": true
            }));
            base.wireUpTooltips();
            parent.find('button').on('click', function() {
              PLANID = $(this).closest('tr').data('id');
              editPlan("team", PLANID, null, false);
              $(this).replaceWith(base.createPanel($('#checkbox-template'), {
                "done": false
              }));
              tap.updateTeamSapRows();
            });
          });
        }, 1000);
      }

    }).on('click', '.btn-undo', function(e) {
      var PLANID = $(this).closest('tr').data('id');
      log.editPlan(PLANID, null, false);
      $(this).replaceWith(base.createPanel($('#checkbox-template'), {
        "done": false
      }));
      tap.updateTeamSapRows();
      e.stopPropagation();
    });

    var teamTab = $('#tab-plan-team'),
      current;
    teamTab.on('click', '.edit-plan', function() {
      var PLANID = $(this).closest('tr').data("id");

      $('#editActionPlanItem').val($($(this).closest('tr').children('td')[0]).find('span').text());

      $('#editPlan').off('hidden.bs.modal').on('hidden.bs.modal', function() {
        tap.displayPersonalisedTeamActionPlan($('#personalPlanTeam'));
      }).off('shown.bs.modal').on('shown.bs.modal', function() {
        $('#editActionPlanItem').focus();
      }).off('click', '.save-plan').on('click', '.save-plan', function() {

        log.editPlan(PLANID, $('#editActionPlanItem').val());

        $('#editPlan').modal('hide');
      }).off('keyup', '#editActionPlanItem').on('keyup', '#editActionPlanItem', function(e) {
        if (e.which === 13) $('#editPlan .save-plan').click();
      }).modal();
    }).on('click', '.delete-plan', function() {
      var PLANID = $(this).closest('tr').data("id");

      $('#team-delete-item').html($($(this).closest('tr').children('td')[0]).find('span').text());

      $('#deletePlan').off('hidden.bs.modal').on('hidden.bs.modal', function() {
        tap.displayPersonalisedTeamActionPlan($('#personalPlanTeam'));
      }).off('click', '.delete-plan').on('click', '.delete-plan', function() {
        log.deletePlan(PLANID);

        $('#deletePlan').modal('hide');
      }).modal();
    }).on('click', '.add-plan', function() {
      log.recordPlan("team", $(this).parent().parent().find('textarea').val(), data.pathwayId);

      tap.displayPersonalisedTeamActionPlan($('#personalPlanTeam'));
    }).on('change', '.btn-toggle input[type=checkbox]', function() {
      tap.updateTeamSapRows();
    }).on('click', '.btn-undo', function(e) {
      var ACTIONID = $(this).closest('tr').data('id');
      log.editAction("team", ACTIONID, null, false);
      $(this).replaceWith(base.createPanel($('#checkbox-template'), {
        "done": false
      }));
      tap.updateTeamSapRows();
    }).on('click', '.btn-yes,.btn-no', function(e) {
      var checkbox = $(this).find("input[type=checkbox]");
      var other = $(this).parent().find($(this).hasClass("btn-yes") ? ".btn-no" : ".btn-yes");
      var ACTIONID = $(this).closest('tr').data('id');
      if ($(this).hasClass("active") && other.hasClass("inactive") && !$(this).closest('tr').hasClass('success')) {
        //unselecting
        if (checkbox.val() === "no") {
          tap.launchModal(data.selected, checkbox.closest('tr').children().first().children().first().text(), log.getReason("team", ACTIONID), true, function() {
            log.editAction("team", ACTIONID, false, null, log.reason);
            tap.updateTeamSapRows();
            base.wireUpTooltips();
          }, null, function() {
            log.ignoreAction("team", ACTIONID);
            other.removeClass("inactive");
            checkbox.removeAttr("checked");
            checkbox.parent().removeClass("active");
            tap.updateTeamSapRows();
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.ignoreAction("team", ACTIONID);
          other.removeClass("inactive");
        }
      } else if ((!$(this).hasClass("active") && other.hasClass("active")) || $(this).closest('tr').hasClass('success')) {
        //prevent clicking on unselected option or if the row is complete
        e.stopPropagation();
        e.preventDefault();
        return;
      } else {
        //selecting
        var self = this;
        if (checkbox.val() === "no") {
          tap.launchModal(data.selected, checkbox.closest('tr').children().first().children().first().text(), log.getReason("team", ACTIONID), false, function() {
            log.editAction("team", ACTIONID, false, null, log.reason);
            $(self).removeClass("inactive");

            checkbox.attr("checked", "checked");
            checkbox.parent().addClass("active");
            //unselect other
            other.removeClass("active").addClass("inactive");
            other.find("input[type=checkbox]").prop("checked", false);
            tap.updateTeamSapRows();
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.editAction("team", ACTIONID, true);
          $(this).removeClass("inactive");

          //unselect other
          other.removeClass("active").addClass("inactive");
          other.find("input[type=checkbox]").prop("checked", false);
        }
      }
    }).on('keyup', 'input[type=text]', function(e) {
      if (e.which === 13) {
        teamTab.find('.add-plan').click();
      }
    });

    tap.populateTeamSuggestedActionsPanel();

    location.find('div.fit-to-screen-height').niceScroll({
      cursoropacitymin: 0.3,
      cursorwidth: "7px",
      horizrailenabled: false
    });
  },

  populateTeamSuggestedActionsPanel: function() {
    var suggestions = base.suggestionList(log.plan[data.pathwayId].team);
    suggestions = base.sortSuggestions(tap.mergeTeamStuff(suggestions));

    base.createPanelShow(suggestedPlanTemplate, suggestedPlanTeam, {
      "suggestions": suggestions
    }, {
      "item": $('#suggested-plan-item').html(),
      "chk": $('#checkbox-template').html()
    });

    tap.displayPersonalisedTeamActionPlan($('#personalPlanTeam'));
  },

  updateTeamSapRows: function() {
    suggestedPlanTeam.add('#personalPlanTeam').find('.suggestion').each(function() {
      $(this).find('td').last().children().hide();
    });

    suggestedPlanTeam.add('#personalPlanTeam').find('.cr-styled input[type=checkbox]').each(function() {
      if (this.checked) {
        $(this).parent().parent().parent().addClass('success');
      } else {
        $(this).parent().parent().parent().removeClass('success');
      }
    });

    suggestedPlanTeam.add('#personalPlanTeam').find('.btn-undo').each(function() {
      $(this).parent().parent().addClass('success');
    });

    //no class - user not yet agreed/disagreed - no background / muted text
    //active - user agrees - green background / normal text
    //success - user completed - green background / strikethrough text
    //danger - user disagrees - red background / strikethrough text
    suggestedPlanTeam.add('#personalPlanTeam').find('tr').each(function() {
      var self = $(this);
      var any = false;
      self.find('.btn-toggle input[type=checkbox]:checked').each(function() {
        any = true;
        if (this.value === "yes") {
          self.removeClass('danger');
          self.addClass('active');
          self.find('td').last().children().show();
          if (log.getActions().team[self.data("id")].history) {
            var tool = $(this).closest('tr').hasClass('success') ? "" : "<p>" + log.getActions().team[self.data("id")].history[0] + "</p><p>Click again to cancel</p>";
            $(this).parent().attr("title", tool).attr("data-original-title", tool).tooltip('fixTitle').tooltip('hide');
          } else {
            $(this).parent().attr("title", "You agreed - click again to cancel").tooltip('fixTitle').tooltip('hide');
          }
        } else {
          self.removeClass('active');
          self.addClass('danger');
          self.removeClass('success');
          if (log.getActions().team[self.data("id")] && log.getActions().team[self.data("id")].history) {
            $(this).parent().attr("title", "<p>" + log.getActions().team[self.data("id")].history[0] + "</p><p>Click again to edit/cancel</p>").tooltip('fixTitle').tooltip('hide');
          } else {
            $(this).parent().attr("title", "You disagreed - click again to edit/cancel").tooltip('fixTitle').tooltip('hide');
          }
        }
      });
      if (self.find('.btn-toggle input[type=checkbox]:not(:checked)').length == 1) {
        self.find('.btn-toggle input[type=checkbox]:not(:checked)').parent().addClass("inactive").attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
      }
      if (!any) {
        self.removeClass('danger');
        self.removeClass('active');
        self.removeClass('success');

        self.find('.btn-toggle.btn-yes').attr("title", "Click to agree with this action and save it in your agreed actions list  ").tooltip('fixTitle').tooltip('hide');
        self.find('.btn-toggle.btn-no').attr("title", "Click to disagree with this action and remove it from your suggested actions list ").tooltip('fixTitle').tooltip('hide');
      }

      base.wireUpTooltips();
    });

    base.wireUpTooltips();
  },

  displayPersonalisedTeamActionPlan: function(parentElem) {
    var plans = base.sortSuggestions(base.addDisagreePersonalTeam(log.listPlans("team", data.pathwayId)));

    base.createPanelShow(actionPlanList, parentElem, {
      "hasSuggestions": plans && plans.length > 0,
      "suggestions": plans
    }, {
      "action-plan": $('#action-plan').html(),
      "action-plan-item": $('#action-plan-item').html(),
      "chk": $('#checkbox-template').html()
    });

    tap.updateTeamSapRows();
  },

  mergeTeamStuff: function(suggestions) {
    var teamActions = log.listActions();
    if (!teamActions.team) return suggestions;

    suggestions = tap.addDisagree(suggestions, teamActions, "team");
    return suggestions;
  },

  launchModal: function(label, value, reason, isUndo, callbackOnSave, callbackOnCancel, callbackOnUndo) {
    var reasons = [{
      "reason": "We've already done this",
      "value": "done"
    }, {
      "reason": "It wouldn't work",
      "value": "nowork"
    }, {
      "reason": "Other",
      "value": "else"
    }];
    if (reason && reason.reason) {
      for (var i = 0; i < reasons.length; i++) {
        if (reasons[i].reason === reason.reason) {
          reasons[i].checked = true;
          break;
        }
      }
    }
    base.launchModal({
      "header": "Disagree with a suggested action",
      "isUndo": isUndo,
      "item": value,
      "placeholder": "Enter free-text here...",
      "reasons": reasons
    }, label, value, reason ? reason.reasonText : null, callbackOnSave, callbackOnCancel, callbackOnUndo);
  },

  addDisagree: function(suggestions, actions, id) {
    for (var i = 0; i < suggestions.length; i++) {
      if (actions[id][suggestions[i].id]) {
        if (actions[id][suggestions[i].id].agree) {
          suggestions[i].agree = true;
          suggestions[i].disagree = false;
        } else if (actions[id][suggestions[i].id].agree === false) {
          suggestions[i].agree = false;
          suggestions[i].disagree = true;
        }
        if (actions[id][suggestions[i].id].done) suggestions[i].done = actions[id][suggestions[i].id].done;
        else suggestions[i].done = false;
      }
    }
    return suggestions;
  }

};

module.exports = tap;

},{"../base.js":7,"../data.js":9,"../log.js":11,"./confirm.js":16}],33:[function(require,module,exports){
var base = require('../base.js'),
  confirm = require('./confirm.js'),
  data = require('../data.js'),
  log = require('../log.js'),
  lookup = require('../lookup.js');

var trnd = {

  create: function(pathwayId, pathwayStage, standard, patientId) {
    var agree = log.getPatientAgreeObject(pathwayId, pathwayStage, standard, patientId, "trend");
    return base.createPanel(valueTrendPanel, {
      "pathway": lookup.monitored[pathwayId],
      "agree": agree && agree.agree,
      "disagree": agree && agree.agree === false,
      "standard": data[pathwayId][pathwayStage].standards[standard].tab.title,
      "pathwayStage": pathwayStage
    });
  },

  wireUp: function(pathwayId, pathwayStage, standard, patientId) {
    confirm.wireUp($('#trend-agree-disagree'), $('#trend-panel'), pathwayId, pathwayStage, standard, patientId, "trend", "trend data");

    $('#trend-panel').on('click', '.table-chart-toggle', function() {
      if ($(this).text() === "Table") {
        $(this).text("Chart");
        $('#chart-demo-trend').hide();
        $('#table-demo-trend').show();

        var c = $('#table-demo-trend .tableScroll').getNiceScroll();
        if (c && c.length > 0) {
          c.resize();
        } else {
          $('#table-demo-trend .tableScroll').niceScroll({
            cursoropacitymin: 0.3,
            cursorwidth: "7px",
            horizrailenabled: false
          });
        }
      } else {
        $(this).text("Table");
        $('#chart-demo-trend').show();
        $('#table-demo-trend').hide();
      }
    });
  }

};

module.exports = trnd;

},{"../base.js":7,"../data.js":9,"../log.js":11,"../lookup.js":12,"./confirm.js":16}],34:[function(require,module,exports){
var base = require('../base.js'),
  data = require('../data.js'),
  log = require('../log.js'),
  individualActionPlan = require('./individualActionPlan.js'),
  teamActionPlan = require('./teamActionPlan.js'),
  Mustache = require('mustache');

var welcome = {

  wireUpWelcomePage: function(pathwayId, pathwayStage) {
    $('#team-task-panel').on('click', '.cr-styled input[type=checkbox]', function() {
      var ACTIONID = $(this).closest('tr').data('id');
      log.editAction("team", ACTIONID, null, this.checked);

      if (this.checked) {
        log.recordEvent(pathwayId, "team", "Item completed");
        var self = this;
        $(self).parent().attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
        base.wireUpTooltips();
        setTimeout(function(e) {
          $(self).parent().fadeOut(300, function() {
            var parent = $(this).parent();
            $(this).replaceWith(base.createPanel($('#checkbox-template'), {
              "done": true
            }));
            parent.find('button').on('click', function() {
              ACTIONID = $(this).closest('tr').data('id');
              log.editAction("team", ACTIONID, null, false);
              $(this).replaceWith(base.createPanel($('#checkbox-template'), {
                "done": false
              }));
              welcome.updateWelcomePage();
            });
          });
        }, 1000);
      }
      welcome.updateWelcomePage();
    }).on('change', '.btn-toggle input[type=checkbox]', function() {
      welcome.updateWelcomePage();
    }).on('click', '.edit-plan', function() {
      var PLANID = $(this).closest('tr').data("id");

      $('#editActionPlanItem').val($($(this).closest('tr').children('td')[1]).find('span').text());

      $('#editPlan').off('hidden.bs.modal').on('hidden.bs.modal', function() {
        welcome.populate(!$('#outstandingTasks').parent().hasClass("active"));
      }).off('shown.bs.modal').on('shown.bs.modal', function() {
        $('#editActionPlanItem').focus();
      }).off('click', '.save-plan').on('click', '.save-plan', function() {

        log.editPlan(PLANID, $('#editActionPlanItem').val());

        $('#editPlan').modal('hide');
      }).off('keyup', '#editActionPlanItem').on('keyup', '#editActionPlanItem', function(e) {
        if (e.which === 13) $('#editPlan .save-plan').click();
      }).modal();
    }).on('click', '.delete-plan', function() {
      var PLANID = $(this).closest('tr').data("id");

      $('#team-delete-item').html($($(this).closest('tr').children('td')[1]).find('span').text());

      $('#deletePlan').off('hidden.bs.modal').on('hidden.bs.modal', function() {
        welcome.populate(!$('#outstandingTasks').parent().hasClass("active"));
      }).off('click', '.delete-plan').on('click', '.delete-plan', function() {
        log.deletePlan(PLANID);

        $('#deletePlan').modal('hide');
      }).modal();
    }).on('click', '.btn-undo', function(e) {
      var ACTIONID = $(this).closest('tr').data('id');
      log.editAction("team", ACTIONID, null, false);
      $(this).replaceWith(base.createPanel($('#checkbox-template'), {
        "done": false
      }));
      welcome.updateWelcomePage();
    }).on('click', '.btn-yes,.btn-no', function(e) {
      var checkbox = $(this).find("input[type=checkbox]");
      var other = $(this).parent().find($(this).hasClass("btn-yes") ? ".btn-no" : ".btn-yes");
      var ACTIONID = $(this).closest('tr').data('id');
      if ($(this).hasClass("active") && other.hasClass("inactive") && !$(this).closest('tr').hasClass('success')) {
        //unselecting
        if (checkbox.val() === "no") {
          teamActionPlan.launchModal(data.selected, checkbox.closest('tr').children(':nth(1)').find('span').text(), log.getReason("team", ACTIONID), true, function() {
            log.editAction("team", ACTIONID, false, null, log.reason);
            welcome.updateWelcomePage();
            base.wireUpTooltips();
          }, null, function() {
            log.ignoreAction("team", ACTIONID);
            other.removeClass("inactive");
            checkbox.removeAttr("checked");
            checkbox.parent().removeClass("active");
            welcome.updateWelcomePage();
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.ignoreAction("team", ACTIONID);
          other.removeClass("inactive");
        }
      } else if ((!$(this).hasClass("active") && other.hasClass("active")) || $(this).closest('tr').hasClass('success')) {
        //prevent clicking on unselected option or if the row is complete
        e.stopPropagation();
        e.preventDefault();
        return;
      } else {
        //selecting
        var self = this;
        if (checkbox.val() === "no") {
          teamActionPlan.launchModal(data.selected, checkbox.closest('tr').children(':nth(1)').find('span').text(), log.getReason("team", ACTIONID), false, function() {
            log.editAction("team", ACTIONID, false, null, log.reason);
            $(self).removeClass("inactive");

            checkbox.attr("checked", "checked");
            checkbox.parent().addClass("active");
            //unselect other
            other.removeClass("active").addClass("inactive");
            other.find("input[type=checkbox]").prop("checked", false);
            welcome.updateWelcomePage();
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.editAction("team", ACTIONID, true);
          $(this).removeClass("inactive");

          //unselect other
          other.removeClass("active").addClass("inactive");
          other.find("input[type=checkbox]").prop("checked", false);
        }
      }
    });

    $('#individual-task-panel').on('click', '.cr-styled input[type=checkbox]', function() {
      var ACTIONID = $(this).closest('tr').data('id');
      var patientId = $(this).closest('tr').data('team-or-patient-id');
      log.editAction(patientId, ACTIONID, null, this.checked);

      if (this.checked) {
        log.recordEvent(pathwayId, patientId, "Item completed");
        var self = this;
        $(self).parent().attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
        base.wireUpTooltips();
        setTimeout(function(e) {
          $(self).parent().fadeOut(300, function() {
            var parent = $(this).parent();
            $(this).replaceWith(base.createPanel($('#checkbox-template'), {
              "done": true
            }));
            parent.find('button').on('click', function() {
              ACTIONID = $(this).closest('tr').data('id');
              log.editAction(patientId, ACTIONID, null, false);
              $(this).replaceWith(base.createPanel($('#checkbox-template'), {
                "done": false
              }));
              welcome.updateWelcomePage();
            });
          });
        }, 1000);
      }
      welcome.updateWelcomePage();
    }).on('change', '.btn-toggle input[type=checkbox]', function() {
      welcome.updateWelcomePage();
    }).on('click', '.edit-plan', function() {
      var PLANID = $(this).closest('tr').data("id");

      $('#editActionPlanItem').val($($(this).closest('tr').children('td')[2]).find('span').text());

      $('#editPlan').off('hidden.bs.modal').on('hidden.bs.modal', function() {
        welcome.populate(!$('#outstandingTasks').parent().hasClass("active"));
      }).off('shown.bs.modal').on('shown.bs.modal', function() {
        $('#editActionPlanItem').focus();
      }).off('click', '.save-plan').on('click', '.save-plan', function() {

        log.editPlan(PLANID, $('#editActionPlanItem').val());

        $('#editPlan').modal('hide');
      }).off('keyup', '#editActionPlanItem').on('keyup', '#editActionPlanItem', function(e) {
        if (e.which === 13) $('#editPlan .save-plan').click();
      }).modal();
    }).on('click', '.delete-plan', function() {
      var PLANID = $(this).closest('tr').data("id");

      $('#team-delete-item').html($($(this).closest('tr').children('td')[2]).find('span').text());

      $('#deletePlan').off('hidden.bs.modal').on('hidden.bs.modal', function() {
        welcome.populate(!$('#outstandingTasks').parent().hasClass("active"));
      }).off('click', '.delete-plan').on('click', '.delete-plan', function() {
        log.deletePlan(PLANID);

        $('#deletePlan').modal('hide');
      }).modal();
    }).on('click', '.btn-undo', function(e) {
      var ACTIONID = $(this).closest('tr').data('id');
      var patientId = $(this).closest('tr').data('team-or-patient-id');
      log.editAction(patientId, ACTIONID, null, false);
      $(this).replaceWith(base.createPanel($('#checkbox-template'), {
        "done": false
      }));
      welcome.updateWelcomePage();
    }).on('click', '.btn-yes,.btn-no', function(e) {
      var checkbox = $(this).find("input[type=checkbox]");
      var other = $(this).parent().find($(this).hasClass("btn-yes") ? ".btn-no" : ".btn-yes");
      var ACTIONID = $(this).closest('tr').data('id');
      var patientId = $(this).closest('tr').data('team-or-patient-id');
      if ($(this).hasClass("active") && other.hasClass("inactive") && !$(this).closest('tr').hasClass('success')) {
        //unselecting
        if (checkbox.val() === "no") {
          individualActionPlan.launchModal(data.selected, checkbox.closest('tr').children(':nth(2)').find('span').text(), log.getReason(patientId, ACTIONID), true, function() {
            log.editAction(patientId, ACTIONID, false, null, log.reason);
            welcome.updateWelcomePage();
            base.wireUpTooltips();
          }, null, function() {
            log.ignoreAction(patientId, ACTIONID);
            other.removeClass("inactive");
            checkbox.removeAttr("checked");
            checkbox.parent().removeClass("active");
            welcome.updateWelcomePage();
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.ignoreAction(patientId, ACTIONID);
          other.removeClass("inactive");
        }
      } else if ((!$(this).hasClass("active") && other.hasClass("active")) || $(this).closest('tr').hasClass('success')) {
        //prevent clicking on unselected option or if the row is complete
        e.stopPropagation();
        e.preventDefault();
        return;
      } else {
        //selecting
        var self = this;
        if (checkbox.val() === "no") {
          individualActionPlan.launchModal(data.selected, checkbox.closest('tr').children(':nth(2)').find('span').text(), log.getReason(patientId, ACTIONID), false, function() {
            log.editAction(patientId, ACTIONID, false, null, log.reason);
            $(self).removeClass("inactive");

            checkbox.attr("checked", "checked");
            checkbox.parent().addClass("active");
            //unselect other
            other.removeClass("active").addClass("inactive");
            other.find("input[type=checkbox]").prop("checked", false);
            welcome.updateWelcomePage();
            base.wireUpTooltips();
          });
          e.stopPropagation();
          e.preventDefault();
        } else {
          log.editAction(patientId, ACTIONID, true);
          $(this).removeClass("inactive");

          //unselect other
          other.removeClass("active").addClass("inactive");
          other.find("input[type=checkbox]").prop("checked", false);
        }
      }
    });

    welcome.updateWelcomePage();
  },

  updateWelcomePage: function() {
    $('#team-task-panel').add('#individual-task-panel').find('.suggestion').each(function() {
      $(this).find('td').last().children().hide();
    });

    $('#team-task-panel').add('#individual-task-panel').find('.cr-styled input[type=checkbox]').each(function() {
      if (this.checked) {
        $(this).parent().parent().parent().addClass('success');
      } else {
        $(this).parent().parent().parent().removeClass('success');
      }
    });

    $('#team-task-panel').add('#individual-task-panel').find('.btn-undo').each(function() {
      $(this).parent().parent().addClass('success');
    });

    //no class - user not yet agreed/disagreed - no background / muted text
    //active - user agrees - green background / normal text
    //success - user completed - green background / strikethrough text
    //danger - user disagrees - red background / strikethrough text
    $('#team-task-panel').add('#individual-task-panel').find('tr').each(function() {
      var self = $(this);
      var any = false;
      self.find('.btn-toggle input[type=checkbox]:checked').each(function() {
        any = true;
        if (this.value === "yes") {
          self.removeClass('danger');
          self.addClass('active');
          self.find('td').last().children().show();
          if (log.getActions().team[self.data("id")] && log.getActions().team[self.data("id")].history) {
            var tool = $(this).closest('tr').hasClass('success') ? "" : "<p>" + log.getActions().team[self.data("id")].history[0] + "</p><p>Click again to cancel</p>";
            $(this).parent().attr("title", tool).attr("data-original-title", tool).tooltip('fixTitle').tooltip('hide');
          } else {
            $(this).parent().attr("title", "You agreed - click again to cancel").tooltip('fixTitle').tooltip('hide');
          }
        } else {
          self.removeClass('active');
          self.addClass('danger');
          self.removeClass('success');
          if (log.getActions().team[self.data("id")] && log.getActions().team[self.data("id")].history) {
            $(this).parent().attr("title", "<p>" + log.getActions().team[self.data("id")].history[0] + "</p><p>Click again to edit/cancel</p>").tooltip('fixTitle').tooltip('hide');
          } else {
            $(this).parent().attr("title", "You disagreed - click again to edit/cancel").tooltip('fixTitle').tooltip('hide');
          }
        }
      });
      if (self.find('.btn-toggle input[type=checkbox]:not(:checked)').length == 1) {
        self.find('.btn-toggle input[type=checkbox]:not(:checked)').parent().addClass("inactive").attr("title", "").attr("data-original-title", "").tooltip('fixTitle').tooltip('hide');
      }
      if (!any) {
        self.removeClass('danger');
        self.removeClass('active');
        self.removeClass('success');

        self.find('.btn-toggle.btn-yes').attr("title", "Click to agree with this action and save it in your agreed actions list  ").tooltip('fixTitle').tooltip('hide');
        self.find('.btn-toggle.btn-no').attr("title", "Click to disagree with this action and remove it from your suggested actions list ").tooltip('fixTitle').tooltip('hide');
      }

      base.wireUpTooltips();
    });

    base.wireUpTooltips();
  },

  populate: function(complete) {

    var k,l;
    //add tasks
    var teamTasks = [];
    var individualTasks = [];

    //Add the team tasks
    for (k in log.listActions("team")) {
      if (log.listActions("team")[k].agree && ((!log.listActions("team")[k].done && !complete) || (log.listActions("team")[k].done && complete))) {
        teamTasks.push({
          "pathway": "N/A",
          "task": log.text[log.listActions("team")[k].id].text,
          "data": log.listActions("team")[k].id,
          "tpId": "team",
          "agree": true,
          "done": complete
        });
      }
    }

    //Add the user added team tasks
    for (k in log.listPlans("team")) {
      if ((!log.listPlans("team")[k].done && !complete) || (log.listPlans("team")[k].done && complete)) {
        teamTasks.push({
          "canEdit": true,
          "pathway": data.pathwayNames[log.listPlans("team")[k].pathwayId],
          "pathwayId": log.listPlans("team")[k].pathwayId,
          "task": log.listPlans("team")[k].text,
          "data": log.listPlans("team")[k].id,
          "agree": log.listPlans("team")[k].agree,
          "disagree": log.listPlans("team")[k].agree === false,
          "done": complete
        });
      }
    }

    //Add individual
    for (k in log.listActions()) {
      if (k === "team") continue;
      for (l in log.listActions()[k]) {
        if (log.text[l] && log.listActions()[k][l].agree && ((!log.listActions()[k][l].done && !complete) || (log.listActions()[k][l].done && complete))) {
          individualTasks.push({
            "pathway": "N/A",
            "patientId": k,
            "task": log.text[l].text,
            "pathwayId": log.listPlans()[k][l].pathwayId,
            "data": l,
            "tpId": k,
            "agree": true,
            "done": complete
          });
        }
      }
    }

    //Add custom individual
    for (k in log.listPlans()) {
      if (k === "team") continue;
      for (l in log.listPlans()[k]) {
        if (log.listPlans()[k][l].text && (!log.listPlans()[k][l].done && !complete) || (log.listPlans()[k][l].done && complete)) {
          individualTasks.push({
            "canEdit": true,
            "pathway": data.pathwayNames[log.listPlans()[k][l].pathwayId],
            "pathwayId": log.listPlans()[k][l].pathwayId,
            "patientId": k,
            "tpId": k,
            "task": log.listPlans()[k][l].text,
            "data": l,
            "agree": true,
            "done": complete
          });
        }
      }
    }

    var listTemplate = $('#welcome-task-list').html();
    Mustache.parse(listTemplate);
    $('#welcome-tab-content').html(Mustache.render(listTemplate));

    var addTemplate = $('#action-plan').html();
    Mustache.parse(addTemplate);
    var rendered = Mustache.render(addTemplate);
    $('#team-add-plan').html(rendered);

    var tempMust = $('#welcome-task-items').html();
    var itemTemplate = $('#welcome-task-item').html();
    Mustache.parse(tempMust);
    Mustache.parse(itemTemplate);

    $('#team-add-plan').off('click').on('click', '.add-plan', function() {
      var plan = $(this).parent().parent().find('textarea').val();
      var planId = recordPlan("team", plan, "custom");
      $('#team-task-panel').find('table tbody').append(Mustache.render(itemTemplate, {
        "pathway": "",
        "pathwayId": "custom",
        "canEdit": true,
        "task": plan,
        "data": planId,
        "agree": null,
        "done": null
      }, {
        "chk": $('#checkbox-template').html()
      }));
    });

    rendered = Mustache.render(tempMust, {
      "tasks": teamTasks,
      "hasTasks": teamTasks.length > 0
    }, {
      "task-item": itemTemplate,
      "chk": $('#checkbox-template').html()
    });
    $('#team-task-panel').children().not(":first").remove();
    $('#team-task-panel').append(rendered);

    rendered = Mustache.render(tempMust, {
      "tasks": individualTasks,
      "isPatientTable": true,
      "hasTasks": individualTasks.length > 0
    }, {
      "task-item": itemTemplate,
      "chk": $('#checkbox-template').html()
    });
    $('#individual-task-panel').children().not(":first").remove();
    $('#individual-task-panel').append(rendered);

    welcome.wireUpWelcomePage();
  }

};

module.exports = welcome;

},{"../base.js":7,"../data.js":9,"../log.js":11,"./individualActionPlan.js":22,"./teamActionPlan.js":32,"mustache":4}],35:[function(require,module,exports){
var data = require('../data.js'),
  chart = require('../chart.js');

var bd = {

  wireUp: function() {

  },

  show: function(panel, isAppend, subPanels, isDownText, isUpText) {

    var sectionElement = $('<div class="section"></div>');

    if (isAppend) panel.append(sectionElement);
    else panel.html(sectionElement);

    subPanels.forEach(function(v) {
      var args = v.args;
      args.unshift(true);
      args.unshift(sectionElement);
      v.show.apply(null, args);
    });

    if (isUpText) sectionElement.prepend($('<div class="fp-controlArrow fp-up"><div>' + isUpText + '</div></div>'));
    if (isDownText) sectionElement.append($('<div class="fp-controlArrow fp-down"><div>' + isDownText + '</div></div>'));

  }

};

module.exports = bd;

},{"../chart.js":8,"../data.js":9}],36:[function(require,module,exports){
var data = require('./data.js'),
  lookup = require('./lookup.js'),
  base = require('./base.js'),
  patients = require('./panels/patients.js'),
  patientList = require('./panels/patientList.js'),
  teamActionPlan = require('./panels/teamActionPlan.js'),
  allPatients = require('./panels/allPatients.js'),
  welcome = require('./panels/welcome.js'),
  layout = require('./layout.js'),
  overview = require('./views/overview.js'),
  indicatorView = require('./views/indicator.js'),
  patientView = require('./views/patient.js'),
  actionPlan = require('./views/actions.js'),
  Mustache = require('mustache');

var template = {

  loadContent: function(hash, isPoppingState) {
    base.hideTooltips();

    var i, pathwayId, pathwayStage, standard, indicator, patientId;
    if (!isPoppingState) {
      window.location.hash = hash;
    }

    if (hash === '') {
      base.clearBox();
      base.showFooter();
      layout.showPage('login');
      $('html').removeClass('scroll-bar');
    } else {
      base.hideFooter();
      $('html').addClass('scroll-bar');
      var params = {};
      var urlBits = hash.split('/');

      if (hash.indexOf('?') > -1) {
        hash.split('?')[1].split('&').forEach(function(param) {
          var elems = param.split("=");
          params[elems[0]] = elems[1];
        });
        urlBits = hash.split('?')[0].split('/');
      }

      if (urlBits[0] === "#overview" && !urlBits[1]) {

        overview.create(template.loadContent);

      } else if (urlBits[0] === "#indicators") {

        indicatorView.create(urlBits[1], urlBits[2], urlBits[3], params.tab || "trend", template.loadContent);

      } else if (urlBits[0] === "#main") {
        base.clearBox();
        pathwayId = urlBits[1];
        data.pathwayId = pathwayId;
        pathwayStage = urlBits[2];
        var yesPeople = urlBits[3] !== "no";
        standard = urlBits[4];

        if (pathwayStage && layout.page !== 'main-dashboard') {
          $('.page').hide();
          $('#main-dashboard').show();

          ////layout.showSidePanel();
          layout.showOverviewPanels();
          layout.showHeaderBarItems();
        }

        if (pathwayStage) {
          if (yesPeople) {
            template.showPathwayStageViewOk(pathwayId, pathwayStage, template.shouldWeFade(lookup.currentUrl, hash));
          } else {
            template.showPathwayStageView(pathwayId, pathwayStage, standard, template.shouldWeFade(lookup.currentUrl, hash));
          }
        } else {
          template.showOverview(pathwayId);
        }

        base.wireUpTooltips();

      } else if (urlBits[0] === "#help") {
        base.clearBox();
        base.selectTab("");
        layout.showPage('help-page');

        layout.showHeaderBarItems();

      } else if (urlBits[0] === "#patient") {

        //create(pathwayId, pathwayStage, standard, patientId)
        patientView.create(urlBits[2], urlBits[3], urlBits[4], urlBits[1], template.loadContent);

      } else if (urlBits[0] === "#patients") {

        patientId = urlBits[1];

        patientView.create(null, null, null, patientId, template.loadContent);
        /*pathwayId = urlBits[2];

        allPatients.showView(patientId, true);

        base.wireUpTooltips();

        if (patientId) {
          var nhs = data.patLookup ? data.patLookup[patientId] : patientId;
          $('#patients').find('div.table-scroll').getNiceScroll().doScrollPos(0, $('#patients td').filter(function() {
            return $(this).text().trim() === nhs;
          }).position().top - 140);
          $('#patients').find('tr:contains(' + nhs + ')').addClass("highlighted");
        }*/
      } else if (urlBits[0] === "#agreedactions") {

        actionPlan.create();

      } else {
        //if screen not in correct segment then select it
        alert("shouldn't get here");
        pathwayStage = hash.substr(1);

        template.showPathwayStageView(pathwayStage);

        base.wireUpTooltips();
      }
    }

    lookup.currentUrl = hash;
  },

  //Show the overview page for a disease
  showOverview: function(disease) {
    data.pathwayId = disease;

    layout.showMainView(data.diseases.map(function(v) {
      return v.id;
    }).indexOf(disease));

    $('aside li ul li').removeClass('active');
    $('aside a[href="#main/' + disease + '"]:contains("Overview")').parent().addClass('active');

    $('#mainTitle').show();
    base.updateTitle(data.text[data.pathwayId]["display-name"] + ": Overview (practice-level data)");

    //Show overview panels
    template.showOverviewPanels();
    teamActionPlan.show(farRightPanel);
  },

  showOverviewPanels: function() {
    base.switchTo221Layout();

    template.showPanel(lookup.categories.diagnosis.name, topLeftPanel, true);
    template.showPanel(lookup.categories.monitoring.name, topRightPanel, true);
    template.showPanel(lookup.categories.treatment.name, bottomLeftPanel, true);
    template.showPanel(lookup.categories.exclusions.name, bottomRightPanel, true);

    base.wireUpTooltips();
  },

  showPanel: function(pathwayStage, location, enableHover) {
    base.showPathwayStageOverviewPanel(location, enableHover, data.pathwayId, pathwayStage);

    if (enableHover) template.highlightOnHoverAndEnableSelectByClick(location);
    else location.children('div').addClass('unclickable');
  },

  //Show the pathway stage for a disease
  showPathwayStageView: function(pathwayId, pathwayStage, standard, shouldFade) {
    farRightPanel.removeClass('standard-missed-page').removeClass('standard-achieved-page').removeClass('standard-not-relevant-page');
    data.pathwayId = pathwayId;
    layout.showMainView(data.diseases.map(function(v) {
      return v.id;
    }).indexOf(pathwayId));

    $('aside li ul li').removeClass('active');
    var re = new RegExp(pathwayStage, "g");
    $('aside a').filter(function() {
      return this.href.match(re);
    }).parent().addClass('active');

    base.switchTo110Layout();

    if (!standard) {
      standard = Object.keys(data[pathwayId][pathwayStage].standards)[0];
    }

    var panel = patients.create(pathwayId, pathwayStage, standard);

    if (shouldFade) {
      farLeftPanel.fadeOut(100, function() {
        $(this).html(panel);
        patients.wireUp(pathwayId, pathwayStage, farLeftPanel, standard);
        patientList.populate(pathwayId, pathwayStage, standard, null);
        $('#mainTitle').hide();
        base.updateTitle(data.text[pathwayId][pathwayStage].text.page.text, data.text[pathwayId][pathwayStage].text.page.tooltip);
        $(this).fadeIn(100);
      });
    } else {
      farLeftPanel.html(panel);
      patients.wireUp(pathwayId, pathwayStage, farLeftPanel, standard);
      patientList.populate(pathwayId, pathwayStage, standard, null);
      $('#mainTitle').hide();
      base.updateTitle(data.text[pathwayId][pathwayStage].text.page.text, data.text[pathwayId][pathwayStage].text.page.tooltip);
    }

    var tempMust = $('#patient-panel-placeholder').html();
    farRightPanel.html(Mustache.render(tempMust));
  },

  showPathwayStageViewOk: function(pathwayId, pathwayStage, shouldFade) {
    farRightPanel.removeClass('standard-missed-page').removeClass('standard-achieved-page').removeClass('standard-not-relevant-page');
    layout.showMainView(data.diseases.map(function(v) {
      return v.id;
    }).indexOf(pathwayId));

    $('aside li ul li').removeClass('active');
    var re = new RegExp(pathwayStage, "g");
    $('aside a').filter(function() {
      return this.href.match(re);
    }).parent().addClass('active');

    base.switchTo110Layout();

    var panel = patients.createOk(pathwayId, pathwayStage);

    if (shouldFade) {
      farLeftPanel.fadeOut(200, function() {
        $(this).html(panel);
        patients.wireUpOk(pathwayId, pathwayStage, farLeftPanel);
        patients.populateOk(pathwayId, pathwayStage, null);
        $('#mainTitle').hide();
        base.updateTitle(data.text[pathwayId][pathwayStage].text.page.text, data.text[pathwayId][pathwayStage].text.page.tooltip);
        $(this).fadeIn(300);
      });
      var tempMust = $('#patient-panel-placeholder').html();
      farRightPanel.html(Mustache.render(tempMust));
    } else {
      farLeftPanel.html(panel);
      patients.wireUpOk(pathwayId, pathwayStage, farLeftPanel);
      patients.populateOk(pathwayId, pathwayStage, null);
      $('#mainTitle').hide();
      base.updateTitle(data.text[pathwayId][pathwayStage].text.page.text, data.text[pathwayId][pathwayStage].text.page.tooltip);
    }
  },

  highlightOnHoverAndEnableSelectByClick: function(panelSelector) {
    panelSelector.children('div').removeClass('unclickable').on('mouseover', function() {
      $(this).removeClass('panel-default');
    }).on('mouseout', function(e) {
      $(this).addClass('panel-default');
    }).on('click', 'tr.standard-row', function(e) {
      history.pushState(null, null, '#main/' + data.pathwayId + '/' + $(this).closest('.panel').data('stage') + '/no/' + $(this).data('standard'));
      template.loadContent('#main/' + data.pathwayId + '/' + $(this).closest('.panel').data('stage') + '/no/' + $(this).data('standard'), true);
      // do not give a default action
      e.preventDefault();
      e.stopPropagation();
      return false;
    }).on('click', function(e) {
      // keep the link in the browser history
      history.pushState(null, null, '#main/' + data.pathwayId + '/' + $(this).data('stage') + '/no');
      template.loadContent('#main/' + data.pathwayId + '/' + $(this).data('stage') + '/no', true);
      // do not give a default action
      return false;
    });

  },

  displaySelectedPatient: function(id) {
    var nhs = data.patLookup ? data.patLookup[id] : id;

    history.pushState(null, null, '#patients/' + id);
    template.loadContent('#patients/' + id, true);

    $('.list-item').removeClass('highlighted');
    $('.list-item:has(button[data-clipboard-text=' + nhs + '])').addClass('highlighted');

    //scroll to patients
    $('#patients').find('div.table-scroll').getNiceScroll().doScrollPos(0, $('#patients td').filter(function() {
      return $(this).text().trim() === nhs;
    }).position().top - 140);
  },

  shouldWeFade: function(oldHash, newHash) {
    oldHash = oldHash.split('/');
    newHash = newHash.split('/');

    if (oldHash[0] === newHash[0] && oldHash[1] === newHash[1] && oldHash[2] === newHash[2] && oldHash[0] && newHash[0]) return false;
    return true;
  }

};

module.exports = template;

},{"./base.js":7,"./data.js":9,"./layout.js":10,"./lookup.js":12,"./panels/allPatients.js":15,"./panels/patientList.js":27,"./panels/patients.js":29,"./panels/teamActionPlan.js":32,"./panels/welcome.js":34,"./views/actions.js":37,"./views/indicator.js":38,"./views/overview.js":39,"./views/patient.js":40,"mustache":4}],37:[function(require,module,exports){
var base = require('../base.js'),
  layout = require('../layout.js'),
  welcome = require('../panels/welcome.js');

var ID = "ACTION_PLAN_VIEW";

var ap = {

  create: function() {

    base.selectTab("actions");

    if(layout.view !== ID) {
      //Not already in this view so we need to rejig a few things
      base.clearBox();
      layout.showPage('welcome');
      layout.showHeaderBarItems();

      $('#welcome-tabs li').removeClass('active');
      $('#outstandingTasks').closest('li').addClass('active');

      layout.view = ID;
    }

    welcome.populate();

  }

};

module.exports = ap;

},{"../base.js":7,"../layout.js":10,"../panels/welcome.js":34}],38:[function(require,module,exports){
var base = require('../base.js'),
  data = require('../data.js'),
  patientList = require('../panels/patientList.js'),
  indicatorBreakdown = require('../panels/indicatorBreakdown.js'),
  indicatorBenchmark = require('../panels/indicatorBenchmark.js'),
  indicatorTrend = require('../panels/indicatorTrend.js'),
  indicatorHeadlines = require('../panels/indicatorHeadlines.js'),
  teamActionPlan = require('../panels/teamActionPlan.js'),
  wrapper = require('../panels/wrapper.js'),
  layout = require('../layout.js');

var ID = "INDICATOR";
/*
 * The indicator page consists of the panels:
 *   Tabbed panel
 *     - performance trend
 *     - performance benchmark
 *   Patient groups
 *   Patient list
 *   Team action plan
 */

var ind = {

  create: function(pathwayId, pathwayStage, standard, tab, loadContentFn) {

    base.selectTab("indicator");
    base.showLoading();

    //use a setTimeout to force the UI to change e.g. show the loading-container
    //before further execution
    setTimeout(function() {
      if (layout.view !== ID) {
        //Not already in this view so we need to rejig a few things
        base.clearBox();
        //base.switchTo21Layout();
        layout.showMainView();

        base.removeFullPage(farRightPanel);
        base.hidePanels(farRightPanel);

        layout.view = ID;
      }

      if (!pathwayId) {
        if (layout.pathwayId) pathwayId = layout.pathwayId;
        else pathwayId = Object.keys(data.pathwayNames)[0];
      }

      if (!pathwayStage) {
        if (layout.pathwayStage) pathwayStage = layout.pathwayStage;
        else pathwayStage = Object.keys(data.text[pathwayId])[0];
      }

      if (!standard) {
        if (layout.standard) standard = layout.standard;
        else standard = Object.keys(data.text[pathwayId][pathwayStage].standards)[0];
      }

      //if (layout.pathwayId !== pathwayId || layout.pathwayStage !== pathwayStage) {
        //different pathway or stage so title needs updating
        base.updateTitle(data.text[pathwayId][pathwayStage].standards[standard].name);
        /*base.updateTitle([{
          title: "Overview",
          url: "#overview"
        }, {
          title: data.text[pathwayId][pathwayStage].text.page.text,
          tooltip: data.text[pathwayId][pathwayStage].text.page.tooltip
        }]);
        $('#mainTitle').show();*/
      //}

      layout.pathwayId = pathwayId;
      layout.pathwayStage = pathwayStage;
      layout.standard = standard;

      //TODO not sure if this needs moving..?
      data.pathwayId = pathwayId;

      //The three panels we need to show
      //Panels decide whether they need to redraw themselves
      teamActionPlan.show(farLeftPanel);

      base.updateTab("indicators", data.text[pathwayId][pathwayStage].standards[standard].tabText, [pathwayId, pathwayStage, standard].join("/"));

      wrapper.show(farRightPanel, false, [
        {
          show: indicatorHeadlines.show,
          args: [pathwayId, pathwayStage, standard]
        }, {
          show: indicatorBreakdown.show,
          args: [pathwayId, pathwayStage, standard, patientList.selectSubsection]
        }, {
          show: patientList.show,
          args: [pathwayId, pathwayStage, standard, loadContentFn]
        }
      ], "Performance over time", false);
      wrapper.show(farRightPanel, true, [
        {
          show: indicatorTrend.show,
          args: [pathwayId, pathwayStage, standard]
        }
      ], "Benchmarking", "Patients at risk");
      wrapper.show(farRightPanel, true, [
        {
          show: indicatorBenchmark.show,
          args: [pathwayId, pathwayStage, standard]
        }
      ], false, "Performance over time");

      base.addFullPage(farRightPanel);

      $('#indicator-pane').show();

      base.wireUpTooltips();

      /*setTimeout($('.fp-controlArrow').each(function(idx, el) {
        if(el.is(":visible"))
      }), 2000);*/

      base.hideLoading();
    }, 0);
  }

};

module.exports = ind;

},{"../base.js":7,"../data.js":9,"../layout.js":10,"../panels/indicatorBenchmark.js":17,"../panels/indicatorBreakdown.js":18,"../panels/indicatorHeadlines.js":19,"../panels/indicatorTrend.js":21,"../panels/patientList.js":27,"../panels/teamActionPlan.js":32,"../panels/wrapper.js":35}],39:[function(require,module,exports){
var base = require('../base.js'),
  data = require('../data.js'),
  layout = require('../layout.js'),
  indicatorList = require('../panels/indicatorList.js'),
  teamActionPlan = require('../panels/teamActionPlan.js');

var ID = "OVERVIEW";
/*
 * The overview page consists of the panels:
 *   Indicator list
 *   Team action plan
 */
var overview = {

  create: function(loadContentFn) {

    base.selectTab("overview");
    base.showLoading();

    //use a setTimeout to force the UI to change e.g. show the loading-container
    //before further execution
    setTimeout(function() {

      if (layout.view !== ID) {
        //Not already in this view so we need to rejig a few things
        base.clearBox();
        //base.switchTo101Layout();
        layout.showMainView();

        $('#mainTitle').show();
        base.updateTitle("Overview of your practice performance");

        base.removeFullPage(farRightPanel);
        base.hidePanels(farRightPanel);

        layout.view = ID;
      }

      data.pathwayId = "htn"; //TODO fudge

      //The two panels we need to show
      //Panels decide whether they need to redraw themselves
      teamActionPlan.show(farLeftPanel);
      indicatorList.show(farRightPanel, false, loadContentFn);

      $('#overview-pane').show();

      base.wireUpTooltips();
      base.hideLoading();
    }, 0);

  }

};

module.exports = overview;

},{"../base.js":7,"../data.js":9,"../layout.js":10,"../panels/indicatorList.js":20,"../panels/teamActionPlan.js":32}],40:[function(require,module,exports){
var lifeline = require('../panels/lifeline.js'),
  data = require('../data.js'),
  base = require('../base.js'),
  layout = require('../layout.js'),
  individualActionPlan = require('../panels/individualActionPlan.js'),
  qualityStandards = require('../panels/qualityStandards.js'),
  patientCharacteristics = require('../panels/patientCharacteristics.js'),
  patientSearch = require('../panels/patientSearch.js');

var ID = "PATIENT_VIEW";
/*
 * The patient page consists of the panels:
 *   Lifeline chart
 *   Individual action plan
 */

var pv = {

  wireUp: function() {

  },

  create: function(pathwayId, pathwayStage, standard, patientId, loadContentFn) {

    base.selectTab("patient");
    base.showLoading();

    //use a setTimeout to force the UI to change e.g. show the loading-container
    //before further execution
    setTimeout(function() {

      if (layout.view !== ID) {
        //Not already in this view so we need to rejig a few things
        base.clearBox();
        //base.switchTo21Layout();
        layout.showMainView();

        base.removeFullPage(farRightPanel);
        base.hidePanels(farRightPanel);

        layout.view = ID;
      }

      base.hidePanels(farLeftPanel);

      if (patientId) {
        data.getPatientData(patientId, function(patientData) {


          if (layout.pathwayId !== pathwayId || layout.pathwayStage !== pathwayStage ||
            layout.standard !== standard || layout.patientId !== patientId) {
            //different pathway or stage or patientId so title needs updating
            $('#mainTitle').show();

            var patid = (data.patLookup && data.patLookup[patientId] ? data.patLookup[patientId] : patientId);
            var sex = patientData.characteristics.sex.toLowerCase() === "m" ?
              "male" : (patientData.characteristics.sex.toLowerCase() === "f" ? "female" : patientData.characteristics.sex.toLowerCase());
            base.updateTitle("Patient " + patid +
              " - " + patientData.characteristics.age + " year old " + sex);
          }

          base.updateTab("patients", data.patLookup[patientId] || patientId, patientId);

          layout.patientId = patientId;
          data.patientId = patientId;
          data.pathwayId = pathwayId;

          patientSearch.show($('#title-right'), true, loadContentFn);
          qualityStandards.show(farRightPanel, false, patientId);

          lifeline.show(farRightPanel, true, patientId, patientData);
          individualActionPlan.show(farLeftPanel, pathwayId, pathwayStage, standard, patientId);

          patientSearch.wireUp();
          $('#patient-pane').show();

          base.wireUpTooltips();
          base.hideLoading();

        });
      } else {
        base.updateTitle("No patient currently selected");

        patientSearch.show(farRightPanel, true, loadContentFn);

        base.wireUpTooltips();
        base.hideLoading();
      }

    }, 0);

  },

  populate: function() {

  }

};

module.exports = pv;

},{"../base.js":7,"../data.js":9,"../layout.js":10,"../panels/individualActionPlan.js":22,"../panels/lifeline.js":23,"../panels/patientCharacteristics.js":26,"../panels/patientSearch.js":28,"../panels/qualityStandards.js":31}]},{},[6])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvaGlnaGNoYXJ0cy9oaWdoY2hhcnRzLW1vcmUuanMiLCJub2RlX21vZHVsZXMvaGlnaGNoYXJ0cy9oaWdoc3RvY2suanMiLCJub2RlX21vZHVsZXMvanF1ZXJ5LXNwYXJrbGluZS9qcXVlcnkuc3BhcmtsaW5lLmpzIiwibm9kZV9tb2R1bGVzL211c3RhY2hlL211c3RhY2hlLmpzIiwibm9kZV9tb2R1bGVzL3plcm9jbGlwYm9hcmQvZGlzdC9aZXJvQ2xpcGJvYXJkLmpzIiwic2NyaXB0LmpzIiwic3JjL2Jhc2UuanMiLCJzcmMvY2hhcnQuanMiLCJzcmMvZGF0YS5qcyIsInNyYy9sYXlvdXQuanMiLCJzcmMvbG9nLmpzIiwic3JjL2xvb2t1cC5qcyIsInNyYy9tYWluLmpzIiwic3JjL25vdGlmeS5qcyIsInNyYy9wYW5lbHMvYWxsUGF0aWVudHMuanMiLCJzcmMvcGFuZWxzL2NvbmZpcm0uanMiLCJzcmMvcGFuZWxzL2luZGljYXRvckJlbmNobWFyay5qcyIsInNyYy9wYW5lbHMvaW5kaWNhdG9yQnJlYWtkb3duLmpzIiwic3JjL3BhbmVscy9pbmRpY2F0b3JIZWFkbGluZXMuanMiLCJzcmMvcGFuZWxzL2luZGljYXRvckxpc3QuanMiLCJzcmMvcGFuZWxzL2luZGljYXRvclRyZW5kLmpzIiwic3JjL3BhbmVscy9pbmRpdmlkdWFsQWN0aW9uUGxhbi5qcyIsInNyYy9wYW5lbHMvbGlmZWxpbmUuanMiLCJzcmMvcGFuZWxzL21lZGljYXRpb24uanMiLCJzcmMvcGFuZWxzL290aGVyQ29kZXMuanMiLCJzcmMvcGFuZWxzL3BhdGllbnRDaGFyYWN0ZXJpc3RpY3MuanMiLCJzcmMvcGFuZWxzL3BhdGllbnRMaXN0LmpzIiwic3JjL3BhbmVscy9wYXRpZW50U2VhcmNoLmpzIiwic3JjL3BhbmVscy9wYXRpZW50cy5qcyIsInNyYy9wYW5lbHMvcXVhbGl0eVN0YW5kYXJkLmpzIiwic3JjL3BhbmVscy9xdWFsaXR5U3RhbmRhcmRzLmpzIiwic3JjL3BhbmVscy90ZWFtQWN0aW9uUGxhbi5qcyIsInNyYy9wYW5lbHMvdHJlbmQuanMiLCJzcmMvcGFuZWxzL3dlbGNvbWUuanMiLCJzcmMvcGFuZWxzL3dyYXBwZXIuanMiLCJzcmMvdGVtcGxhdGUuanMiLCJzcmMvdmlld3MvYWN0aW9ucy5qcyIsInNyYy92aWV3cy9pbmRpY2F0b3IuanMiLCJzcmMvdmlld3Mvb3ZlcnZpZXcuanMiLCJzcmMvdmlld3MvcGF0aWVudC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xiQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2L0ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNybkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BoRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2YkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdHFCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoaEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDalVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1TkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDWkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3RkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25hQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzckJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOU5BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6WUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0SEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNWQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5Y0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9IQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeERBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiLypcbiBIaWdoY2hhcnRzIEpTIHY0LjIuNCAoMjAxNi0wNC0xNClcblxuIChjKSAyMDA5LTIwMTYgVG9yc3RlaW4gSG9uc2lcblxuIExpY2Vuc2U6IHd3dy5oaWdoY2hhcnRzLmNvbS9saWNlbnNlXG4qL1xuKGZ1bmN0aW9uKG0pe3R5cGVvZiBtb2R1bGU9PT1cIm9iamVjdFwiJiZtb2R1bGUuZXhwb3J0cz9tb2R1bGUuZXhwb3J0cz1tOm0oSGlnaGNoYXJ0cyl9KShmdW5jdGlvbihtKXtmdW5jdGlvbiBMKGEsYixjKXt0aGlzLmluaXQoYSxiLGMpfXZhciBRPW0uYXJyYXlNaW4sUj1tLmFycmF5TWF4LHQ9bS5lYWNoLEg9bS5leHRlbmQsdT1tLm1lcmdlLFM9bS5tYXAsbz1tLnBpY2ssQj1tLnBJbnQsRz1tLmNvcnJlY3RGbG9hdCxwPW0uZ2V0T3B0aW9ucygpLnBsb3RPcHRpb25zLGk9bS5zZXJpZXNUeXBlcyx2PW0uZXh0ZW5kQ2xhc3MsTT1tLnNwbGF0LHc9bS53cmFwLE49bS5BeGlzLHo9bS5UaWNrLEk9bS5Qb2ludCxUPW0uUG9pbnRlcixVPW0uQ2VudGVyZWRTZXJpZXNNaXhpbixDPW0uVHJhY2tlck1peGluLHg9bS5TZXJpZXMseT1NYXRoLEY9eS5yb3VuZCxEPXkuZmxvb3IsTz15Lm1heCxWPW0uQ29sb3Iscj1mdW5jdGlvbigpe307SChMLnByb3RvdHlwZSx7aW5pdDpmdW5jdGlvbihhLGIsXG5jKXt2YXIgZD10aGlzLGc9ZC5kZWZhdWx0T3B0aW9ucztkLmNoYXJ0PWI7ZC5vcHRpb25zPWE9dShnLGIuYW5ndWxhcj97YmFja2dyb3VuZDp7fX06dm9pZCAwLGEpOyhhPWEuYmFja2dyb3VuZCkmJnQoW10uY29uY2F0KE0oYSkpLnJldmVyc2UoKSxmdW5jdGlvbihhKXt2YXIgYj1hLmJhY2tncm91bmRDb2xvcixnPWMudXNlck9wdGlvbnMsYT11KGQuZGVmYXVsdEJhY2tncm91bmRPcHRpb25zLGEpO2lmKGIpYS5iYWNrZ3JvdW5kQ29sb3I9YjthLmNvbG9yPWEuYmFja2dyb3VuZENvbG9yO2Mub3B0aW9ucy5wbG90QmFuZHMudW5zaGlmdChhKTtnLnBsb3RCYW5kcz1nLnBsb3RCYW5kc3x8W107Zy5wbG90QmFuZHMhPT1jLm9wdGlvbnMucGxvdEJhbmRzJiZnLnBsb3RCYW5kcy51bnNoaWZ0KGEpfSl9LGRlZmF1bHRPcHRpb25zOntjZW50ZXI6W1wiNTAlXCIsXCI1MCVcIl0sc2l6ZTpcIjg1JVwiLHN0YXJ0QW5nbGU6MH0sZGVmYXVsdEJhY2tncm91bmRPcHRpb25zOntzaGFwZTpcImNpcmNsZVwiLFxuYm9yZGVyV2lkdGg6MSxib3JkZXJDb2xvcjpcInNpbHZlclwiLGJhY2tncm91bmRDb2xvcjp7bGluZWFyR3JhZGllbnQ6e3gxOjAseTE6MCx4MjowLHkyOjF9LHN0b3BzOltbMCxcIiNGRkZcIl0sWzEsXCIjREREXCJdXX0sZnJvbTotTnVtYmVyLk1BWF9WQUxVRSxpbm5lclJhZGl1czowLHRvOk51bWJlci5NQVhfVkFMVUUsb3V0ZXJSYWRpdXM6XCIxMDUlXCJ9fSk7dmFyIEE9Ti5wcm90b3R5cGUsej16LnByb3RvdHlwZSxXPXtnZXRPZmZzZXQ6cixyZWRyYXc6ZnVuY3Rpb24oKXt0aGlzLmlzRGlydHk9ITF9LHJlbmRlcjpmdW5jdGlvbigpe3RoaXMuaXNEaXJ0eT0hMX0sc2V0U2NhbGU6cixzZXRDYXRlZ29yaWVzOnIsc2V0VGl0bGU6cn0sUD17aXNSYWRpYWw6ITAsZGVmYXVsdFJhZGlhbEdhdWdlT3B0aW9uczp7bGFiZWxzOnthbGlnbjpcImNlbnRlclwiLHg6MCx5Om51bGx9LG1pbm9yR3JpZExpbmVXaWR0aDowLG1pbm9yVGlja0ludGVydmFsOlwiYXV0b1wiLG1pbm9yVGlja0xlbmd0aDoxMCxtaW5vclRpY2tQb3NpdGlvbjpcImluc2lkZVwiLFxubWlub3JUaWNrV2lkdGg6MSx0aWNrTGVuZ3RoOjEwLHRpY2tQb3NpdGlvbjpcImluc2lkZVwiLHRpY2tXaWR0aDoyLHRpdGxlOntyb3RhdGlvbjowfSx6SW5kZXg6Mn0sZGVmYXVsdFJhZGlhbFhPcHRpb25zOntncmlkTGluZVdpZHRoOjEsbGFiZWxzOnthbGlnbjpudWxsLGRpc3RhbmNlOjE1LHg6MCx5Om51bGx9LG1heFBhZGRpbmc6MCxtaW5QYWRkaW5nOjAsc2hvd0xhc3RMYWJlbDohMSx0aWNrTGVuZ3RoOjB9LGRlZmF1bHRSYWRpYWxZT3B0aW9uczp7Z3JpZExpbmVJbnRlcnBvbGF0aW9uOlwiY2lyY2xlXCIsbGFiZWxzOnthbGlnbjpcInJpZ2h0XCIseDotMyx5Oi0yfSxzaG93TGFzdExhYmVsOiExLHRpdGxlOnt4OjQsdGV4dDpudWxsLHJvdGF0aW9uOjkwfX0sc2V0T3B0aW9uczpmdW5jdGlvbihhKXthPXRoaXMub3B0aW9ucz11KHRoaXMuZGVmYXVsdE9wdGlvbnMsdGhpcy5kZWZhdWx0UmFkaWFsT3B0aW9ucyxhKTtpZighYS5wbG90QmFuZHMpYS5wbG90QmFuZHM9W119LGdldE9mZnNldDpmdW5jdGlvbigpe0EuZ2V0T2Zmc2V0LmNhbGwodGhpcyk7XG50aGlzLmNoYXJ0LmF4aXNPZmZzZXRbdGhpcy5zaWRlXT0wO3RoaXMuY2VudGVyPXRoaXMucGFuZS5jZW50ZXI9VS5nZXRDZW50ZXIuY2FsbCh0aGlzLnBhbmUpfSxnZXRMaW5lUGF0aDpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuY2VudGVyLGI9byhiLGNbMl0vMi10aGlzLm9mZnNldCk7cmV0dXJuIHRoaXMuY2hhcnQucmVuZGVyZXIuc3ltYm9scy5hcmModGhpcy5sZWZ0K2NbMF0sdGhpcy50b3ArY1sxXSxiLGIse3N0YXJ0OnRoaXMuc3RhcnRBbmdsZVJhZCxlbmQ6dGhpcy5lbmRBbmdsZVJhZCxvcGVuOiEwLGlubmVyUjowfSl9LHNldEF4aXNUcmFuc2xhdGlvbjpmdW5jdGlvbigpe0Euc2V0QXhpc1RyYW5zbGF0aW9uLmNhbGwodGhpcyk7aWYodGhpcy5jZW50ZXIpdGhpcy50cmFuc0E9dGhpcy5pc0NpcmN1bGFyPyh0aGlzLmVuZEFuZ2xlUmFkLXRoaXMuc3RhcnRBbmdsZVJhZCkvKHRoaXMubWF4LXRoaXMubWlufHwxKTp0aGlzLmNlbnRlclsyXS8yLyh0aGlzLm1heC10aGlzLm1pbnx8XG4xKSx0aGlzLm1pblBpeGVsUGFkZGluZz10aGlzLmlzWEF4aXM/dGhpcy50cmFuc0EqdGhpcy5taW5Qb2ludE9mZnNldDowfSxiZWZvcmVTZXRUaWNrUG9zaXRpb25zOmZ1bmN0aW9uKCl7dGhpcy5hdXRvQ29ubmVjdCYmKHRoaXMubWF4Kz10aGlzLmNhdGVnb3JpZXMmJjF8fHRoaXMucG9pbnRSYW5nZXx8dGhpcy5jbG9zZXN0UG9pbnRSYW5nZXx8MCl9LHNldEF4aXNTaXplOmZ1bmN0aW9uKCl7QS5zZXRBeGlzU2l6ZS5jYWxsKHRoaXMpO2lmKHRoaXMuaXNSYWRpYWwpe3RoaXMuY2VudGVyPXRoaXMucGFuZS5jZW50ZXI9bS5DZW50ZXJlZFNlcmllc01peGluLmdldENlbnRlci5jYWxsKHRoaXMucGFuZSk7aWYodGhpcy5pc0NpcmN1bGFyKXRoaXMuc2VjdG9yPXRoaXMuZW5kQW5nbGVSYWQtdGhpcy5zdGFydEFuZ2xlUmFkO3RoaXMubGVuPXRoaXMud2lkdGg9dGhpcy5oZWlnaHQ9dGhpcy5jZW50ZXJbMl0qbyh0aGlzLnNlY3RvciwxKS8yfX0sZ2V0UG9zaXRpb246ZnVuY3Rpb24oYSxcbmIpe3JldHVybiB0aGlzLnBvc3RUcmFuc2xhdGUodGhpcy5pc0NpcmN1bGFyP3RoaXMudHJhbnNsYXRlKGEpOjAsbyh0aGlzLmlzQ2lyY3VsYXI/Yjp0aGlzLnRyYW5zbGF0ZShhKSx0aGlzLmNlbnRlclsyXS8yKS10aGlzLm9mZnNldCl9LHBvc3RUcmFuc2xhdGU6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmNoYXJ0LGQ9dGhpcy5jZW50ZXIsYT10aGlzLnN0YXJ0QW5nbGVSYWQrYTtyZXR1cm57eDpjLnBsb3RMZWZ0K2RbMF0rTWF0aC5jb3MoYSkqYix5OmMucGxvdFRvcCtkWzFdK01hdGguc2luKGEpKmJ9fSxnZXRQbG90QmFuZFBhdGg6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXRoaXMuY2VudGVyLGc9dGhpcy5zdGFydEFuZ2xlUmFkLGU9ZFsyXS8yLGo9W28oYy5vdXRlclJhZGl1cyxcIjEwMCVcIiksYy5pbm5lclJhZGl1cyxvKGMudGhpY2tuZXNzLDEwKV0sbD0vJSQvLGgsZj10aGlzLmlzQ2lyY3VsYXI7dGhpcy5vcHRpb25zLmdyaWRMaW5lSW50ZXJwb2xhdGlvbj09PVwicG9seWdvblwiP1xuZD10aGlzLmdldFBsb3RMaW5lUGF0aChhKS5jb25jYXQodGhpcy5nZXRQbG90TGluZVBhdGgoYiwhMCkpOihhPU1hdGgubWF4KGEsdGhpcy5taW4pLGI9TWF0aC5taW4oYix0aGlzLm1heCksZnx8KGpbMF09dGhpcy50cmFuc2xhdGUoYSksalsxXT10aGlzLnRyYW5zbGF0ZShiKSksaj1TKGosZnVuY3Rpb24oYSl7bC50ZXN0KGEpJiYoYT1CKGEsMTApKmUvMTAwKTtyZXR1cm4gYX0pLGMuc2hhcGU9PT1cImNpcmNsZVwifHwhZj8oYT0tTWF0aC5QSS8yLGI9TWF0aC5QSSoxLjUsaD0hMCk6KGE9Zyt0aGlzLnRyYW5zbGF0ZShhKSxiPWcrdGhpcy50cmFuc2xhdGUoYikpLGQ9dGhpcy5jaGFydC5yZW5kZXJlci5zeW1ib2xzLmFyYyh0aGlzLmxlZnQrZFswXSx0aGlzLnRvcCtkWzFdLGpbMF0salswXSx7c3RhcnQ6TWF0aC5taW4oYSxiKSxlbmQ6TWF0aC5tYXgoYSxiKSxpbm5lclI6byhqWzFdLGpbMF0talsyXSksb3BlbjpofSkpO3JldHVybiBkfSxnZXRQbG90TGluZVBhdGg6ZnVuY3Rpb24oYSxcbmIpe3ZhciBjPXRoaXMsZD1jLmNlbnRlcixnPWMuY2hhcnQsZT1jLmdldFBvc2l0aW9uKGEpLGosbCxoO2MuaXNDaXJjdWxhcj9oPVtcIk1cIixkWzBdK2cucGxvdExlZnQsZFsxXStnLnBsb3RUb3AsXCJMXCIsZS54LGUueV06Yy5vcHRpb25zLmdyaWRMaW5lSW50ZXJwb2xhdGlvbj09PVwiY2lyY2xlXCI/KGE9Yy50cmFuc2xhdGUoYSkpJiYoaD1jLmdldExpbmVQYXRoKDAsYSkpOih0KGcueEF4aXMsZnVuY3Rpb24oYSl7YS5wYW5lPT09Yy5wYW5lJiYoaj1hKX0pLGg9W10sYT1jLnRyYW5zbGF0ZShhKSxkPWoudGlja1Bvc2l0aW9ucyxqLmF1dG9Db25uZWN0JiYoZD1kLmNvbmNhdChbZFswXV0pKSxiJiYoZD1bXS5jb25jYXQoZCkucmV2ZXJzZSgpKSx0KGQsZnVuY3Rpb24oZSxiKXtsPWouZ2V0UG9zaXRpb24oZSxhKTtoLnB1c2goYj9cIkxcIjpcIk1cIixsLngsbC55KX0pKTtyZXR1cm4gaH0sZ2V0VGl0bGVQb3NpdGlvbjpmdW5jdGlvbigpe3ZhciBhPXRoaXMuY2VudGVyLGI9dGhpcy5jaGFydCxcbmM9dGhpcy5vcHRpb25zLnRpdGxlO3JldHVybnt4OmIucGxvdExlZnQrYVswXSsoYy54fHwwKSx5OmIucGxvdFRvcCthWzFdLXtoaWdoOjAuNSxtaWRkbGU6MC4yNSxsb3c6MH1bYy5hbGlnbl0qYVsyXSsoYy55fHwwKX19fTt3KEEsXCJpbml0XCIsZnVuY3Rpb24oYSxiLGMpe3ZhciBrO3ZhciBkPWIuYW5ndWxhcixnPWIucG9sYXIsZT1jLmlzWCxqPWQmJmUsbCxoO2g9Yi5vcHRpb25zO3ZhciBmPWMucGFuZXx8MDtpZihkKXtpZihIKHRoaXMsaj9XOlApLGw9IWUpdGhpcy5kZWZhdWx0UmFkaWFsT3B0aW9ucz10aGlzLmRlZmF1bHRSYWRpYWxHYXVnZU9wdGlvbnN9ZWxzZSBpZihnKUgodGhpcyxQKSx0aGlzLmRlZmF1bHRSYWRpYWxPcHRpb25zPShsPWUpP3RoaXMuZGVmYXVsdFJhZGlhbFhPcHRpb25zOnUodGhpcy5kZWZhdWx0WUF4aXNPcHRpb25zLHRoaXMuZGVmYXVsdFJhZGlhbFlPcHRpb25zKTthLmNhbGwodGhpcyxiLGMpO2lmKCFqJiYoZHx8Zykpe2E9dGhpcy5vcHRpb25zO2lmKCFiLnBhbmVzKWIucGFuZXM9XG5bXTt0aGlzLnBhbmU9KGs9Yi5wYW5lc1tmXT1iLnBhbmVzW2ZdfHxuZXcgTChNKGgucGFuZSlbZl0sYix0aGlzKSxmPWspO2Y9Zi5vcHRpb25zO2IuaW52ZXJ0ZWQ9ITE7aC5jaGFydC56b29tVHlwZT1udWxsO3RoaXMuc3RhcnRBbmdsZVJhZD1iPShmLnN0YXJ0QW5nbGUtOTApKk1hdGguUEkvMTgwO3RoaXMuZW5kQW5nbGVSYWQ9aD0obyhmLmVuZEFuZ2xlLGYuc3RhcnRBbmdsZSszNjApLTkwKSpNYXRoLlBJLzE4MDt0aGlzLm9mZnNldD1hLm9mZnNldHx8MDtpZigodGhpcy5pc0NpcmN1bGFyPWwpJiZjLm1heD09PXZvaWQgMCYmaC1iPT09MipNYXRoLlBJKXRoaXMuYXV0b0Nvbm5lY3Q9ITB9fSk7dyhBLFwiYXV0b0xhYmVsQWxpZ25cIixmdW5jdGlvbihhKXtpZighdGhpcy5pc1JhZGlhbClyZXR1cm4gYS5hcHBseSh0aGlzLFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpKX0pO3coeixcImdldFBvc2l0aW9uXCIsZnVuY3Rpb24oYSxiLGMsZCxnKXt2YXIgZT10aGlzLmF4aXM7cmV0dXJuIGUuZ2V0UG9zaXRpb24/XG5lLmdldFBvc2l0aW9uKGMpOmEuY2FsbCh0aGlzLGIsYyxkLGcpfSk7dyh6LFwiZ2V0TGFiZWxQb3NpdGlvblwiLGZ1bmN0aW9uKGEsYixjLGQsZyxlLGosbCxoKXt2YXIgZj10aGlzLmF4aXMsaz1lLnksbj0yMCxzPWUuYWxpZ24saT0oZi50cmFuc2xhdGUodGhpcy5wb3MpK2Yuc3RhcnRBbmdsZVJhZCtNYXRoLlBJLzIpL01hdGguUEkqMTgwJTM2MDtmLmlzUmFkaWFsPyhhPWYuZ2V0UG9zaXRpb24odGhpcy5wb3MsZi5jZW50ZXJbMl0vMitvKGUuZGlzdGFuY2UsLTI1KSksZS5yb3RhdGlvbj09PVwiYXV0b1wiP2QuYXR0cih7cm90YXRpb246aX0pOms9PT1udWxsJiYoaz1mLmNoYXJ0LnJlbmRlcmVyLmZvbnRNZXRyaWNzKGQuc3R5bGVzLmZvbnRTaXplKS5iLWQuZ2V0QkJveCgpLmhlaWdodC8yKSxzPT09bnVsbCYmKGYuaXNDaXJjdWxhcj8odGhpcy5sYWJlbC5nZXRCQm94KCkud2lkdGg+Zi5sZW4qZi50aWNrSW50ZXJ2YWwvKGYubWF4LWYubWluKSYmKG49MCkscz1pPm4mJmk8MTgwLW4/XG5cImxlZnRcIjppPjE4MCtuJiZpPDM2MC1uP1wicmlnaHRcIjpcImNlbnRlclwiKTpzPVwiY2VudGVyXCIsZC5hdHRyKHthbGlnbjpzfSkpLGEueCs9ZS54LGEueSs9ayk6YT1hLmNhbGwodGhpcyxiLGMsZCxnLGUsaixsLGgpO3JldHVybiBhfSk7dyh6LFwiZ2V0TWFya1BhdGhcIixmdW5jdGlvbihhLGIsYyxkLGcsZSxqKXt2YXIgbD10aGlzLmF4aXM7bC5pc1JhZGlhbD8oYT1sLmdldFBvc2l0aW9uKHRoaXMucG9zLGwuY2VudGVyWzJdLzIrZCksYj1bXCJNXCIsYixjLFwiTFwiLGEueCxhLnldKTpiPWEuY2FsbCh0aGlzLGIsYyxkLGcsZSxqKTtyZXR1cm4gYn0pO3AuYXJlYXJhbmdlPXUocC5hcmVhLHtsaW5lV2lkdGg6MSxtYXJrZXI6bnVsbCx0aHJlc2hvbGQ6bnVsbCx0b29sdGlwOntwb2ludEZvcm1hdDonPHNwYW4gc3R5bGU9XCJjb2xvcjp7c2VyaWVzLmNvbG9yfVwiPlxcdTI1Y2Y8L3NwYW4+IHtzZXJpZXMubmFtZX06IDxiPntwb2ludC5sb3d9PC9iPiAtIDxiPntwb2ludC5oaWdofTwvYj48YnIvPid9LFxudHJhY2tCeUFyZWE6ITAsZGF0YUxhYmVsczp7YWxpZ246bnVsbCx2ZXJ0aWNhbEFsaWduOm51bGwseExvdzowLHhIaWdoOjAseUxvdzowLHlIaWdoOjB9LHN0YXRlczp7aG92ZXI6e2hhbG86ITF9fX0pO2kuYXJlYXJhbmdlPXYoaS5hcmVhLHt0eXBlOlwiYXJlYXJhbmdlXCIscG9pbnRBcnJheU1hcDpbXCJsb3dcIixcImhpZ2hcIl0sZGF0YUxhYmVsQ29sbGVjdGlvbnM6W1wiZGF0YUxhYmVsXCIsXCJkYXRhTGFiZWxVcHBlclwiXSx0b1lEYXRhOmZ1bmN0aW9uKGEpe3JldHVyblthLmxvdyxhLmhpZ2hdfSxwb2ludFZhbEtleTpcImxvd1wiLGRlZmVyVHJhbnNsYXRlUG9sYXI6ITAsaGlnaFRvWFk6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jaGFydCxjPXRoaXMueEF4aXMucG9zdFRyYW5zbGF0ZShhLnJlY3RQbG90WCx0aGlzLnlBeGlzLmxlbi1hLnBsb3RIaWdoKTthLnBsb3RIaWdoWD1jLngtYi5wbG90TGVmdDthLnBsb3RIaWdoPWMueS1iLnBsb3RUb3B9LHRyYW5zbGF0ZTpmdW5jdGlvbigpe3ZhciBhPVxudGhpcyxiPWEueUF4aXM7aS5hcmVhLnByb3RvdHlwZS50cmFuc2xhdGUuYXBwbHkoYSk7dChhLnBvaW50cyxmdW5jdGlvbihhKXt2YXIgZD1hLmxvdyxnPWEuaGlnaCxlPWEucGxvdFk7Zz09PW51bGx8fGQ9PT1udWxsP2EuaXNOdWxsPSEwOihhLnBsb3RMb3c9ZSxhLnBsb3RIaWdoPWIudHJhbnNsYXRlKGcsMCwxLDAsMSkpfSk7dGhpcy5jaGFydC5wb2xhciYmdCh0aGlzLnBvaW50cyxmdW5jdGlvbihiKXthLmhpZ2hUb1hZKGIpfSl9LGdldEdyYXBoUGF0aDpmdW5jdGlvbigpe3ZhciBhPXRoaXMucG9pbnRzLGI9W10sYz1bXSxkPWEubGVuZ3RoLGc9eC5wcm90b3R5cGUuZ2V0R3JhcGhQYXRoLGUsaixsO2w9dGhpcy5vcHRpb25zO2Zvcih2YXIgaD1sLnN0ZXAsZD1hLmxlbmd0aDtkLS07KWU9YVtkXSwhZS5pc051bGwmJighYVtkKzFdfHxhW2QrMV0uaXNOdWxsKSYmYy5wdXNoKHtwbG90WDplLnBsb3RYLHBsb3RZOmUucGxvdExvd30pLGo9e3Bsb3RYOmUucGxvdFgscGxvdFk6ZS5wbG90SGlnaCxcbmlzTnVsbDplLmlzTnVsbH0sYy5wdXNoKGopLGIucHVzaChqKSwhZS5pc051bGwmJighYVtkLTFdfHxhW2QtMV0uaXNOdWxsKSYmYy5wdXNoKHtwbG90WDplLnBsb3RYLHBsb3RZOmUucGxvdExvd30pO2E9Zy5jYWxsKHRoaXMsYSk7aWYoaCloPT09ITAmJihoPVwibGVmdFwiKSxsLnN0ZXA9e2xlZnQ6XCJyaWdodFwiLGNlbnRlcjpcImNlbnRlclwiLHJpZ2h0OlwibGVmdFwifVtoXTtiPWcuY2FsbCh0aGlzLGIpO2M9Zy5jYWxsKHRoaXMsYyk7bC5zdGVwPWg7bD1bXS5jb25jYXQoYSxiKTshdGhpcy5jaGFydC5wb2xhciYmY1swXT09PVwiTVwiJiYoY1swXT1cIkxcIik7dGhpcy5hcmVhUGF0aD10aGlzLmFyZWFQYXRoLmNvbmNhdChhLGMpO3JldHVybiBsfSxkcmF3RGF0YUxhYmVsczpmdW5jdGlvbigpe3ZhciBhPXRoaXMuZGF0YSxiPWEubGVuZ3RoLGMsZD1bXSxnPXgucHJvdG90eXBlLGU9dGhpcy5vcHRpb25zLmRhdGFMYWJlbHMsaj1lLmFsaWduLGw9ZS52ZXJ0aWNhbEFsaWduLGg9ZS5pbnNpZGUsZixcbmssbj10aGlzLmNoYXJ0LmludmVydGVkO2lmKGUuZW5hYmxlZHx8dGhpcy5faGFzUG9pbnRMYWJlbHMpe2ZvcihjPWI7Yy0tOylpZihmPWFbY10pe2s9aD9mLnBsb3RIaWdoPGYucGxvdExvdzpmLnBsb3RIaWdoPmYucGxvdExvdztmLnk9Zi5oaWdoO2YuX3Bsb3RZPWYucGxvdFk7Zi5wbG90WT1mLnBsb3RIaWdoO2RbY109Zi5kYXRhTGFiZWw7Zi5kYXRhTGFiZWw9Zi5kYXRhTGFiZWxVcHBlcjtmLmJlbG93PWs7aWYobil7aWYoIWopZS5hbGlnbj1rP1wicmlnaHRcIjpcImxlZnRcIn1lbHNlIGlmKCFsKWUudmVydGljYWxBbGlnbj1rP1widG9wXCI6XCJib3R0b21cIjtlLng9ZS54SGlnaDtlLnk9ZS55SGlnaH1nLmRyYXdEYXRhTGFiZWxzJiZnLmRyYXdEYXRhTGFiZWxzLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtmb3IoYz1iO2MtLTspaWYoZj1hW2NdKXtrPWg/Zi5wbG90SGlnaDxmLnBsb3RMb3c6Zi5wbG90SGlnaD5mLnBsb3RMb3c7Zi5kYXRhTGFiZWxVcHBlcj1mLmRhdGFMYWJlbDtmLmRhdGFMYWJlbD1cbmRbY107Zi55PWYubG93O2YucGxvdFk9Zi5fcGxvdFk7Zi5iZWxvdz0haztpZihuKXtpZighaillLmFsaWduPWs/XCJsZWZ0XCI6XCJyaWdodFwifWVsc2UgaWYoIWwpZS52ZXJ0aWNhbEFsaWduPWs/XCJib3R0b21cIjpcInRvcFwiO2UueD1lLnhMb3c7ZS55PWUueUxvd31nLmRyYXdEYXRhTGFiZWxzJiZnLmRyYXdEYXRhTGFiZWxzLmFwcGx5KHRoaXMsYXJndW1lbnRzKX1lLmFsaWduPWo7ZS52ZXJ0aWNhbEFsaWduPWx9LGFsaWduRGF0YUxhYmVsOmZ1bmN0aW9uKCl7aS5jb2x1bW4ucHJvdG90eXBlLmFsaWduRGF0YUxhYmVsLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sc2V0U3RhY2tlZFBvaW50czpyLGdldFN5bWJvbDpyLGRyYXdQb2ludHM6cn0pO3AuYXJlYXNwbGluZXJhbmdlPXUocC5hcmVhcmFuZ2UpO2kuYXJlYXNwbGluZXJhbmdlPXYoaS5hcmVhcmFuZ2Use3R5cGU6XCJhcmVhc3BsaW5lcmFuZ2VcIixnZXRQb2ludFNwbGluZTppLnNwbGluZS5wcm90b3R5cGUuZ2V0UG9pbnRTcGxpbmV9KTtcbihmdW5jdGlvbigpe3ZhciBhPWkuY29sdW1uLnByb3RvdHlwZTtwLmNvbHVtbnJhbmdlPXUocC5jb2x1bW4scC5hcmVhcmFuZ2Use2xpbmVXaWR0aDoxLHBvaW50UmFuZ2U6bnVsbH0pO2kuY29sdW1ucmFuZ2U9dihpLmFyZWFyYW5nZSx7dHlwZTpcImNvbHVtbnJhbmdlXCIsdHJhbnNsYXRlOmZ1bmN0aW9uKCl7dmFyIGI9dGhpcyxjPWIueUF4aXMsZD1iLnhBeGlzLGc9ZC5zdGFydEFuZ2xlUmFkLGUsaj1iLmNoYXJ0LGw9Yi54QXhpcy5pc1JhZGlhbCxoO2EudHJhbnNsYXRlLmFwcGx5KGIpO3QoYi5wb2ludHMsZnVuY3Rpb24oYSl7dmFyIGs9YS5zaGFwZUFyZ3Msbj1iLm9wdGlvbnMubWluUG9pbnRMZW5ndGgscyxpO2EucGxvdEhpZ2g9aD1jLnRyYW5zbGF0ZShhLmhpZ2gsMCwxLDAsMSk7YS5wbG90TG93PWEucGxvdFk7aT1oO3M9byhhLnJlY3RQbG90WSxhLnBsb3RZKS1oO01hdGguYWJzKHMpPG4/KG4tPXMscys9bixpLT1uLzIpOnM8MCYmKHMqPS0xLGktPXMpO2w/KGU9YS5iYXJYK1xuZyxhLnNoYXBlVHlwZT1cInBhdGhcIixhLnNoYXBlQXJncz17ZDpiLnBvbGFyQXJjKGkrcyxpLGUsZSthLnBvaW50V2lkdGgpfSk6KGsuaGVpZ2h0PXMsay55PWksYS50b29sdGlwUG9zPWouaW52ZXJ0ZWQ/W2MubGVuK2MucG9zLWoucGxvdExlZnQtaS1zLzIsZC5sZW4rZC5wb3Mtai5wbG90VG9wLWsueC1rLndpZHRoLzIsc106W2QubGVmdC1qLnBsb3RMZWZ0K2sueCtrLndpZHRoLzIsYy5wb3Mtai5wbG90VG9wK2krcy8yLHNdKX0pfSxkaXJlY3RUb3VjaDohMCx0cmFja2VyR3JvdXBzOltcImdyb3VwXCIsXCJkYXRhTGFiZWxzR3JvdXBcIl0sZHJhd0dyYXBoOnIsY3Jpc3BDb2w6YS5jcmlzcENvbCxwb2ludEF0dHJUb09wdGlvbnM6YS5wb2ludEF0dHJUb09wdGlvbnMsZHJhd1BvaW50czphLmRyYXdQb2ludHMsZHJhd1RyYWNrZXI6YS5kcmF3VHJhY2tlcixnZXRDb2x1bW5NZXRyaWNzOmEuZ2V0Q29sdW1uTWV0cmljcyxhbmltYXRlOmZ1bmN0aW9uKCl7cmV0dXJuIGEuYW5pbWF0ZS5hcHBseSh0aGlzLFxuYXJndW1lbnRzKX0scG9sYXJBcmM6ZnVuY3Rpb24oKXtyZXR1cm4gYS5wb2xhckFyYy5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fSl9KSgpO3AuZ2F1Z2U9dShwLmxpbmUse2RhdGFMYWJlbHM6e2VuYWJsZWQ6ITAsZGVmZXI6ITEseToxNSxib3JkZXJXaWR0aDoxLGJvcmRlckNvbG9yOlwic2lsdmVyXCIsYm9yZGVyUmFkaXVzOjMsY3JvcDohMSx2ZXJ0aWNhbEFsaWduOlwidG9wXCIsekluZGV4OjJ9LGRpYWw6e30scGl2b3Q6e30sdG9vbHRpcDp7aGVhZGVyRm9ybWF0OlwiXCJ9LHNob3dJbkxlZ2VuZDohMX0pO0M9e3R5cGU6XCJnYXVnZVwiLHBvaW50Q2xhc3M6dihJLHtzZXRTdGF0ZTpmdW5jdGlvbihhKXt0aGlzLnN0YXRlPWF9fSksYW5ndWxhcjohMCxkaXJlY3RUb3VjaDohMCxkcmF3R3JhcGg6cixmaXhlZEJveDohMCxmb3JjZURMOiEwLHRyYWNrZXJHcm91cHM6W1wiZ3JvdXBcIixcImRhdGFMYWJlbHNHcm91cFwiXSx0cmFuc2xhdGU6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLnlBeGlzLGI9dGhpcy5vcHRpb25zLFxuYz1hLmNlbnRlcjt0aGlzLmdlbmVyYXRlUG9pbnRzKCk7dCh0aGlzLnBvaW50cyxmdW5jdGlvbihkKXt2YXIgZz11KGIuZGlhbCxkLmRpYWwpLGU9QihvKGcucmFkaXVzLDgwKSkqY1syXS8yMDAsaj1CKG8oZy5iYXNlTGVuZ3RoLDcwKSkqZS8xMDAsbD1CKG8oZy5yZWFyTGVuZ3RoLDEwKSkqZS8xMDAsaD1nLmJhc2VXaWR0aHx8MyxmPWcudG9wV2lkdGh8fDEsaz1iLm92ZXJzaG9vdCxuPWEuc3RhcnRBbmdsZVJhZCthLnRyYW5zbGF0ZShkLnksbnVsbCxudWxsLG51bGwsITApO2smJnR5cGVvZiBrPT09XCJudW1iZXJcIj8oaz1rLzE4MCpNYXRoLlBJLG49TWF0aC5tYXgoYS5zdGFydEFuZ2xlUmFkLWssTWF0aC5taW4oYS5lbmRBbmdsZVJhZCtrLG4pKSk6Yi53cmFwPT09ITEmJihuPU1hdGgubWF4KGEuc3RhcnRBbmdsZVJhZCxNYXRoLm1pbihhLmVuZEFuZ2xlUmFkLG4pKSk7bj1uKjE4MC9NYXRoLlBJO2Quc2hhcGVUeXBlPVwicGF0aFwiO2Quc2hhcGVBcmdzPXtkOmcucGF0aHx8W1wiTVwiLFxuLWwsLWgvMixcIkxcIixqLC1oLzIsZSwtZi8yLGUsZi8yLGosaC8yLC1sLGgvMixcInpcIl0sdHJhbnNsYXRlWDpjWzBdLHRyYW5zbGF0ZVk6Y1sxXSxyb3RhdGlvbjpufTtkLnBsb3RYPWNbMF07ZC5wbG90WT1jWzFdfSl9LGRyYXdQb2ludHM6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS55QXhpcy5jZW50ZXIsYz1hLnBpdm90LGQ9YS5vcHRpb25zLGc9ZC5waXZvdCxlPWEuY2hhcnQucmVuZGVyZXI7dChhLnBvaW50cyxmdW5jdGlvbihiKXt2YXIgZz1iLmdyYXBoaWMsYz1iLnNoYXBlQXJncyxmPWMuZCxrPXUoZC5kaWFsLGIuZGlhbCk7Zz8oZy5hbmltYXRlKGMpLGMuZD1mKTpiLmdyYXBoaWM9ZVtiLnNoYXBlVHlwZV0oYykuYXR0cih7c3Ryb2tlOmsuYm9yZGVyQ29sb3J8fFwibm9uZVwiLFwic3Ryb2tlLXdpZHRoXCI6ay5ib3JkZXJXaWR0aHx8MCxmaWxsOmsuYmFja2dyb3VuZENvbG9yfHxcImJsYWNrXCIscm90YXRpb246Yy5yb3RhdGlvbix6SW5kZXg6MX0pLmFkZChhLmdyb3VwKX0pO2M/Yy5hbmltYXRlKHt0cmFuc2xhdGVYOmJbMF0sXG50cmFuc2xhdGVZOmJbMV19KTphLnBpdm90PWUuY2lyY2xlKDAsMCxvKGcucmFkaXVzLDUpKS5hdHRyKHtcInN0cm9rZS13aWR0aFwiOmcuYm9yZGVyV2lkdGh8fDAsc3Ryb2tlOmcuYm9yZGVyQ29sb3J8fFwic2lsdmVyXCIsZmlsbDpnLmJhY2tncm91bmRDb2xvcnx8XCJibGFja1wiLHpJbmRleDoyfSkudHJhbnNsYXRlKGJbMF0sYlsxXSkuYWRkKGEuZ3JvdXApfSxhbmltYXRlOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7aWYoIWEpdChiLnBvaW50cyxmdW5jdGlvbihhKXt2YXIgZD1hLmdyYXBoaWM7ZCYmKGQuYXR0cih7cm90YXRpb246Yi55QXhpcy5zdGFydEFuZ2xlUmFkKjE4MC9NYXRoLlBJfSksZC5hbmltYXRlKHtyb3RhdGlvbjphLnNoYXBlQXJncy5yb3RhdGlvbn0sYi5vcHRpb25zLmFuaW1hdGlvbikpfSksYi5hbmltYXRlPW51bGx9LHJlbmRlcjpmdW5jdGlvbigpe3RoaXMuZ3JvdXA9dGhpcy5wbG90R3JvdXAoXCJncm91cFwiLFwic2VyaWVzXCIsdGhpcy52aXNpYmxlP1widmlzaWJsZVwiOlwiaGlkZGVuXCIsXG50aGlzLm9wdGlvbnMuekluZGV4LHRoaXMuY2hhcnQuc2VyaWVzR3JvdXApO3gucHJvdG90eXBlLnJlbmRlci5jYWxsKHRoaXMpO3RoaXMuZ3JvdXAuY2xpcCh0aGlzLmNoYXJ0LmNsaXBSZWN0KX0sc2V0RGF0YTpmdW5jdGlvbihhLGIpe3gucHJvdG90eXBlLnNldERhdGEuY2FsbCh0aGlzLGEsITEpO3RoaXMucHJvY2Vzc0RhdGEoKTt0aGlzLmdlbmVyYXRlUG9pbnRzKCk7byhiLCEwKSYmdGhpcy5jaGFydC5yZWRyYXcoKX0sZHJhd1RyYWNrZXI6QyYmQy5kcmF3VHJhY2tlclBvaW50fTtpLmdhdWdlPXYoaS5saW5lLEMpO3AuYm94cGxvdD11KHAuY29sdW1uLHtmaWxsQ29sb3I6XCIjRkZGRkZGXCIsbGluZVdpZHRoOjEsbWVkaWFuV2lkdGg6MixzdGF0ZXM6e2hvdmVyOnticmlnaHRuZXNzOi0wLjN9fSx0aHJlc2hvbGQ6bnVsbCx0b29sdGlwOntwb2ludEZvcm1hdDonPHNwYW4gc3R5bGU9XCJjb2xvcjp7cG9pbnQuY29sb3J9XCI+XFx1MjVjZjwvc3Bhbj4gPGI+IHtzZXJpZXMubmFtZX08L2I+PGJyLz5NYXhpbXVtOiB7cG9pbnQuaGlnaH08YnIvPlVwcGVyIHF1YXJ0aWxlOiB7cG9pbnQucTN9PGJyLz5NZWRpYW46IHtwb2ludC5tZWRpYW59PGJyLz5Mb3dlciBxdWFydGlsZToge3BvaW50LnExfTxici8+TWluaW11bToge3BvaW50Lmxvd308YnIvPid9LFxud2hpc2tlckxlbmd0aDpcIjUwJVwiLHdoaXNrZXJXaWR0aDoyfSk7aS5ib3hwbG90PXYoaS5jb2x1bW4se3R5cGU6XCJib3hwbG90XCIscG9pbnRBcnJheU1hcDpbXCJsb3dcIixcInExXCIsXCJtZWRpYW5cIixcInEzXCIsXCJoaWdoXCJdLHRvWURhdGE6ZnVuY3Rpb24oYSl7cmV0dXJuW2EubG93LGEucTEsYS5tZWRpYW4sYS5xMyxhLmhpZ2hdfSxwb2ludFZhbEtleTpcImhpZ2hcIixwb2ludEF0dHJUb09wdGlvbnM6e2ZpbGw6XCJmaWxsQ29sb3JcIixzdHJva2U6XCJjb2xvclwiLFwic3Ryb2tlLXdpZHRoXCI6XCJsaW5lV2lkdGhcIn0sZHJhd0RhdGFMYWJlbHM6cix0cmFuc2xhdGU6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLnlBeGlzLGI9dGhpcy5wb2ludEFycmF5TWFwO2kuY29sdW1uLnByb3RvdHlwZS50cmFuc2xhdGUuYXBwbHkodGhpcyk7dCh0aGlzLnBvaW50cyxmdW5jdGlvbihjKXt0KGIsZnVuY3Rpb24oYil7Y1tiXSE9PW51bGwmJihjW2IrXCJQbG90XCJdPWEudHJhbnNsYXRlKGNbYl0sMCwxLDAsMSkpfSl9KX0sZHJhd1BvaW50czpmdW5jdGlvbigpe3ZhciBhPVxudGhpcyxiPWEub3B0aW9ucyxjPWEuY2hhcnQucmVuZGVyZXIsZCxnLGUsaixsLGgsZixrLG4saSxtLEosSyxwLHUscix3LHYseCx5LEMsQix6PWEuZG9RdWFydGlsZXMhPT0hMSxBLEU9YS5vcHRpb25zLndoaXNrZXJMZW5ndGg7dChhLnBvaW50cyxmdW5jdGlvbihxKXtuPXEuZ3JhcGhpYztDPXEuc2hhcGVBcmdzO209e307cD17fTtyPXt9O0I9cS5jb2xvcnx8YS5jb2xvcjtpZihxLnBsb3RZIT09dm9pZCAwKWlmKGQ9cS5wb2ludEF0dHJbcS5zZWxlY3RlZD9cInNlbGVjdGVkXCI6XCJcIl0sdz1DLndpZHRoLHY9RChDLngpLHg9dit3LHk9Rih3LzIpLGc9RCh6P3EucTFQbG90OnEubG93UGxvdCksZT1EKHo/cS5xM1Bsb3Q6cS5sb3dQbG90KSxqPUQocS5oaWdoUGxvdCksbD1EKHEubG93UGxvdCksbS5zdHJva2U9cS5zdGVtQ29sb3J8fGIuc3RlbUNvbG9yfHxCLG1bXCJzdHJva2Utd2lkdGhcIl09byhxLnN0ZW1XaWR0aCxiLnN0ZW1XaWR0aCxiLmxpbmVXaWR0aCksbS5kYXNoc3R5bGU9cS5zdGVtRGFzaFN0eWxlfHxcbmIuc3RlbURhc2hTdHlsZSxwLnN0cm9rZT1xLndoaXNrZXJDb2xvcnx8Yi53aGlza2VyQ29sb3J8fEIscFtcInN0cm9rZS13aWR0aFwiXT1vKHEud2hpc2tlcldpZHRoLGIud2hpc2tlcldpZHRoLGIubGluZVdpZHRoKSxyLnN0cm9rZT1xLm1lZGlhbkNvbG9yfHxiLm1lZGlhbkNvbG9yfHxCLHJbXCJzdHJva2Utd2lkdGhcIl09byhxLm1lZGlhbldpZHRoLGIubWVkaWFuV2lkdGgsYi5saW5lV2lkdGgpLGY9bVtcInN0cm9rZS13aWR0aFwiXSUyLzIsaz12K3krZixpPVtcIk1cIixrLGUsXCJMXCIsayxqLFwiTVwiLGssZyxcIkxcIixrLGxdLHomJihmPWRbXCJzdHJva2Utd2lkdGhcIl0lMi8yLGs9RChrKStmLGc9RChnKStmLGU9RChlKStmLHYrPWYseCs9ZixKPVtcIk1cIix2LGUsXCJMXCIsdixnLFwiTFwiLHgsZyxcIkxcIix4LGUsXCJMXCIsdixlLFwielwiXSksRSYmKGY9cFtcInN0cm9rZS13aWR0aFwiXSUyLzIsais9ZixsKz1mLEE9LyUkLy50ZXN0KEUpP3kqcGFyc2VGbG9hdChFKS8xMDA6RS8yLEs9W1wiTVwiLGstQSxqLFwiTFwiLGsrXG5BLGosXCJNXCIsay1BLGwsXCJMXCIsaytBLGxdKSxmPXJbXCJzdHJva2Utd2lkdGhcIl0lMi8yLGg9RihxLm1lZGlhblBsb3QpK2YsdT1bXCJNXCIsdixoLFwiTFwiLHgsaF0sbilxLnN0ZW0uYW5pbWF0ZSh7ZDppfSksRSYmcS53aGlza2Vycy5hbmltYXRlKHtkOkt9KSx6JiZxLmJveC5hbmltYXRlKHtkOkp9KSxxLm1lZGlhblNoYXBlLmFuaW1hdGUoe2Q6dX0pO2Vsc2V7cS5ncmFwaGljPW49Yy5nKCkuYWRkKGEuZ3JvdXApO3Euc3RlbT1jLnBhdGgoaSkuYXR0cihtKS5hZGQobik7aWYoRSlxLndoaXNrZXJzPWMucGF0aChLKS5hdHRyKHApLmFkZChuKTtpZih6KXEuYm94PWMucGF0aChKKS5hdHRyKGQpLmFkZChuKTtxLm1lZGlhblNoYXBlPWMucGF0aCh1KS5hdHRyKHIpLmFkZChuKX19KX0sc2V0U3RhY2tlZFBvaW50czpyfSk7cC5lcnJvcmJhcj11KHAuYm94cGxvdCx7Y29sb3I6XCIjMDAwMDAwXCIsZ3JvdXBpbmc6ITEsbGlua2VkVG86XCI6cHJldmlvdXNcIix0b29sdGlwOntwb2ludEZvcm1hdDonPHNwYW4gc3R5bGU9XCJjb2xvcjp7cG9pbnQuY29sb3J9XCI+XFx1MjVjZjwvc3Bhbj4ge3Nlcmllcy5uYW1lfTogPGI+e3BvaW50Lmxvd308L2I+IC0gPGI+e3BvaW50LmhpZ2h9PC9iPjxici8+J30sXG53aGlza2VyV2lkdGg6bnVsbH0pO2kuZXJyb3JiYXI9dihpLmJveHBsb3Qse3R5cGU6XCJlcnJvcmJhclwiLHBvaW50QXJyYXlNYXA6W1wibG93XCIsXCJoaWdoXCJdLHRvWURhdGE6ZnVuY3Rpb24oYSl7cmV0dXJuW2EubG93LGEuaGlnaF19LHBvaW50VmFsS2V5OlwiaGlnaFwiLGRvUXVhcnRpbGVzOiExLGRyYXdEYXRhTGFiZWxzOmkuYXJlYXJhbmdlP2kuYXJlYXJhbmdlLnByb3RvdHlwZS5kcmF3RGF0YUxhYmVsczpyLGdldENvbHVtbk1ldHJpY3M6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5saW5rZWRQYXJlbnQmJnRoaXMubGlua2VkUGFyZW50LmNvbHVtbk1ldHJpY3N8fGkuY29sdW1uLnByb3RvdHlwZS5nZXRDb2x1bW5NZXRyaWNzLmNhbGwodGhpcyl9fSk7cC53YXRlcmZhbGw9dShwLmNvbHVtbix7bGluZVdpZHRoOjEsbGluZUNvbG9yOlwiIzMzM1wiLGRhc2hTdHlsZTpcImRvdFwiLGJvcmRlckNvbG9yOlwiIzMzM1wiLGRhdGFMYWJlbHM6e2luc2lkZTohMH0sc3RhdGVzOntob3Zlcjp7bGluZVdpZHRoUGx1czowfX19KTtcbmkud2F0ZXJmYWxsPXYoaS5jb2x1bW4se3R5cGU6XCJ3YXRlcmZhbGxcIix1cENvbG9yUHJvcDpcImZpbGxcIixwb2ludFZhbEtleTpcInlcIix0cmFuc2xhdGU6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9wdGlvbnMsYj10aGlzLnlBeGlzLGMsZCxnLGUsaixsLGgsZixrLG49byhhLm1pblBvaW50TGVuZ3RoLDUpLHM9YS50aHJlc2hvbGQsbT1hLnN0YWNraW5nO2kuY29sdW1uLnByb3RvdHlwZS50cmFuc2xhdGUuYXBwbHkodGhpcyk7dGhpcy5taW5Qb2ludExlbmd0aE9mZnNldD0wO2g9Zj1zO2Q9dGhpcy5wb2ludHM7Zm9yKGM9MCxhPWQubGVuZ3RoO2M8YTtjKyspe2c9ZFtjXTtsPXRoaXMucHJvY2Vzc2VkWURhdGFbY107ZT1nLnNoYXBlQXJncztrPShqPW0mJmIuc3RhY2tzWyh0aGlzLm5lZ1N0YWNrcyYmbDxzP1wiLVwiOlwiXCIpK3RoaXMuc3RhY2tLZXldKT9qW2cueF0ucG9pbnRzW3RoaXMuaW5kZXgrXCIsXCIrY106WzAsbF07aWYoZy5pc1N1bSlnLnk9RyhsKTtlbHNlIGlmKGcuaXNJbnRlcm1lZGlhdGVTdW0pZy55PVxuRyhsLWYpO2o9TyhoLGgrZy55KStrWzBdO2UueT1iLnRyYW5zbGF0ZShqLDAsMSk7aWYoZy5pc1N1bSllLnk9Yi50cmFuc2xhdGUoa1sxXSwwLDEpLGUuaGVpZ2h0PU1hdGgubWluKGIudHJhbnNsYXRlKGtbMF0sMCwxKSxiLmxlbiktZS55K3RoaXMubWluUG9pbnRMZW5ndGhPZmZzZXQ7ZWxzZSBpZihnLmlzSW50ZXJtZWRpYXRlU3VtKWUueT1iLnRyYW5zbGF0ZShrWzFdLDAsMSksZS5oZWlnaHQ9TWF0aC5taW4oYi50cmFuc2xhdGUoZiwwLDEpLGIubGVuKS1lLnkrdGhpcy5taW5Qb2ludExlbmd0aE9mZnNldCxmPWtbMV07ZWxzZXtpZihoIT09MCllLmhlaWdodD1sPjA/Yi50cmFuc2xhdGUoaCwwLDEpLWUueTpiLnRyYW5zbGF0ZShoLDAsMSktYi50cmFuc2xhdGUoaC1sLDAsMSk7aCs9bH1lLmhlaWdodDwwJiYoZS55Kz1lLmhlaWdodCxlLmhlaWdodCo9LTEpO2cucGxvdFk9ZS55PUYoZS55KS10aGlzLmJvcmRlcldpZHRoJTIvMjtlLmhlaWdodD1PKEYoZS5oZWlnaHQpLDAuMDAxKTtcbmcueUJvdHRvbT1lLnkrZS5oZWlnaHQ7aWYoZS5oZWlnaHQ8PW4pZS5oZWlnaHQ9bix0aGlzLm1pblBvaW50TGVuZ3RoT2Zmc2V0Kz1uO2UueS09dGhpcy5taW5Qb2ludExlbmd0aE9mZnNldDtlPWcucGxvdFkrKGcubmVnYXRpdmU/ZS5oZWlnaHQ6MCktdGhpcy5taW5Qb2ludExlbmd0aE9mZnNldDt0aGlzLmNoYXJ0LmludmVydGVkP2cudG9vbHRpcFBvc1swXT1iLmxlbi1lOmcudG9vbHRpcFBvc1sxXT1lfX0scHJvY2Vzc0RhdGE6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy55RGF0YSxjPXRoaXMub3B0aW9ucy5kYXRhLGQsZz1iLmxlbmd0aCxlLGosbCxoLGYsaztqPWU9bD1oPXRoaXMub3B0aW9ucy50aHJlc2hvbGR8fDA7Zm9yKGs9MDtrPGc7aysrKWY9YltrXSxkPWMmJmNba10/Y1trXTp7fSxmPT09XCJzdW1cInx8ZC5pc1N1bT9iW2tdPUcoaik6Zj09PVwiaW50ZXJtZWRpYXRlU3VtXCJ8fGQuaXNJbnRlcm1lZGlhdGVTdW0/YltrXT1HKGUpOihqKz1mLGUrPWYpLGw9TWF0aC5taW4oaixcbmwpLGg9TWF0aC5tYXgoaixoKTt4LnByb3RvdHlwZS5wcm9jZXNzRGF0YS5jYWxsKHRoaXMsYSk7dGhpcy5kYXRhTWluPWw7dGhpcy5kYXRhTWF4PWh9LHRvWURhdGE6ZnVuY3Rpb24oYSl7cmV0dXJuIGEuaXNTdW0/YS54PT09MD9udWxsOlwic3VtXCI6YS5pc0ludGVybWVkaWF0ZVN1bT9hLng9PT0wP251bGw6XCJpbnRlcm1lZGlhdGVTdW1cIjphLnl9LGdldEF0dHJpYnM6ZnVuY3Rpb24oKXtpLmNvbHVtbi5wcm90b3R5cGUuZ2V0QXR0cmlicy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dmFyIGE9dGhpcyxiPWEub3B0aW9ucyxjPWIuc3RhdGVzLGQ9Yi51cENvbG9yfHxhLmNvbG9yLGI9bS5Db2xvcihkKS5icmlnaHRlbigwLjEpLmdldCgpLGc9dShhLnBvaW50QXR0ciksZT1hLnVwQ29sb3JQcm9wO2dbXCJcIl1bZV09ZDtnLmhvdmVyW2VdPWMuaG92ZXIudXBDb2xvcnx8YjtnLnNlbGVjdFtlXT1jLnNlbGVjdC51cENvbG9yfHxkO3QoYS5wb2ludHMsZnVuY3Rpb24oZSl7aWYoIWUub3B0aW9ucy5jb2xvcillLnk+XG4wPyhlLnBvaW50QXR0cj1nLGUuY29sb3I9ZCk6ZS5wb2ludEF0dHI9YS5wb2ludEF0dHJ9KX0sZ2V0R3JhcGhQYXRoOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5kYXRhLGI9YS5sZW5ndGgsYz1GKHRoaXMub3B0aW9ucy5saW5lV2lkdGgrdGhpcy5ib3JkZXJXaWR0aCklMi8yLGQ9W10sZyxlLGo7Zm9yKGo9MTtqPGI7aisrKWU9YVtqXS5zaGFwZUFyZ3MsZz1hW2otMV0uc2hhcGVBcmdzLGU9W1wiTVwiLGcueCtnLndpZHRoLGcueStjLFwiTFwiLGUueCxnLnkrY10sYVtqLTFdLnk8MCYmKGVbMl0rPWcuaGVpZ2h0LGVbNV0rPWcuaGVpZ2h0KSxkPWQuY29uY2F0KGUpO3JldHVybiBkfSxnZXRFeHRyZW1lczpyLGRyYXdHcmFwaDp4LnByb3RvdHlwZS5kcmF3R3JhcGh9KTtwLnBvbHlnb249dShwLnNjYXR0ZXIse21hcmtlcjp7ZW5hYmxlZDohMX19KTtpLnBvbHlnb249dihpLnNjYXR0ZXIse3R5cGU6XCJwb2x5Z29uXCIsZmlsbEdyYXBoOiEwLGdldFNlZ21lbnRQYXRoOmZ1bmN0aW9uKGEpe3JldHVybiB4LnByb3RvdHlwZS5nZXRTZWdtZW50UGF0aC5jYWxsKHRoaXMsXG5hKS5jb25jYXQoXCJ6XCIpfSxkcmF3R3JhcGg6eC5wcm90b3R5cGUuZHJhd0dyYXBoLGRyYXdMZWdlbmRTeW1ib2w6bS5MZWdlbmRTeW1ib2xNaXhpbi5kcmF3UmVjdGFuZ2xlfSk7cC5idWJibGU9dShwLnNjYXR0ZXIse2RhdGFMYWJlbHM6e2Zvcm1hdHRlcjpmdW5jdGlvbigpe3JldHVybiB0aGlzLnBvaW50Lnp9LGluc2lkZTohMCx2ZXJ0aWNhbEFsaWduOlwibWlkZGxlXCJ9LG1hcmtlcjp7bGluZUNvbG9yOm51bGwsbGluZVdpZHRoOjF9LG1pblNpemU6OCxtYXhTaXplOlwiMjAlXCIsc29mdFRocmVzaG9sZDohMSxzdGF0ZXM6e2hvdmVyOntoYWxvOntzaXplOjV9fX0sdG9vbHRpcDp7cG9pbnRGb3JtYXQ6XCIoe3BvaW50Lnh9LCB7cG9pbnQueX0pLCBTaXplOiB7cG9pbnQuen1cIn0sdHVyYm9UaHJlc2hvbGQ6MCx6VGhyZXNob2xkOjAsem9uZUF4aXM6XCJ6XCJ9KTtDPXYoSSx7aGFsb1BhdGg6ZnVuY3Rpb24oKXtyZXR1cm4gSS5wcm90b3R5cGUuaGFsb1BhdGguY2FsbCh0aGlzLHRoaXMuc2hhcGVBcmdzLnIrXG50aGlzLnNlcmllcy5vcHRpb25zLnN0YXRlcy5ob3Zlci5oYWxvLnNpemUpfSx0dEJlbG93OiExfSk7aS5idWJibGU9dihpLnNjYXR0ZXIse3R5cGU6XCJidWJibGVcIixwb2ludENsYXNzOkMscG9pbnRBcnJheU1hcDpbXCJ5XCIsXCJ6XCJdLHBhcmFsbGVsQXJyYXlzOltcInhcIixcInlcIixcInpcIl0sdHJhY2tlckdyb3VwczpbXCJncm91cFwiLFwiZGF0YUxhYmVsc0dyb3VwXCJdLGJ1YmJsZVBhZGRpbmc6ITAsem9uZUF4aXM6XCJ6XCIscG9pbnRBdHRyVG9PcHRpb25zOntzdHJva2U6XCJsaW5lQ29sb3JcIixcInN0cm9rZS13aWR0aFwiOlwibGluZVdpZHRoXCIsZmlsbDpcImZpbGxDb2xvclwifSxhcHBseU9wYWNpdHk6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5vcHRpb25zLm1hcmtlcixjPW8oYi5maWxsT3BhY2l0eSwwLjUpLGE9YXx8Yi5maWxsQ29sb3J8fHRoaXMuY29sb3I7YyE9PTEmJihhPVYoYSkuc2V0T3BhY2l0eShjKS5nZXQoXCJyZ2JhXCIpKTtyZXR1cm4gYX0sY29udmVydEF0dHJpYnM6ZnVuY3Rpb24oKXt2YXIgYT1cbngucHJvdG90eXBlLmNvbnZlcnRBdHRyaWJzLmFwcGx5KHRoaXMsYXJndW1lbnRzKTthLmZpbGw9dGhpcy5hcHBseU9wYWNpdHkoYS5maWxsKTtyZXR1cm4gYX0sZ2V0UmFkaWk6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGcsZSxqLGw9dGhpcy56RGF0YSxoPVtdLGY9dGhpcy5vcHRpb25zLGs9Zi5zaXplQnkhPT1cIndpZHRoXCIsbj1mLnpUaHJlc2hvbGQsaT1iLWE7Zm9yKGU9MCxnPWwubGVuZ3RoO2U8ZztlKyspaj1sW2VdLGYuc2l6ZUJ5QWJzb2x1dGVWYWx1ZSYmaiE9PW51bGwmJihqPU1hdGguYWJzKGotbiksYj1NYXRoLm1heChiLW4sTWF0aC5hYnMoYS1uKSksYT0wKSxqPT09bnVsbD9qPW51bGw6ajxhP2o9Yy8yLTE6KGo9aT4wPyhqLWEpL2k6MC41LGsmJmo+PTAmJihqPU1hdGguc3FydChqKSksaj15LmNlaWwoYytqKihkLWMpKS8yKSxoLnB1c2goaik7dGhpcy5yYWRpaT1ofSxhbmltYXRlOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMub3B0aW9ucy5hbmltYXRpb247aWYoIWEpdCh0aGlzLnBvaW50cyxcbmZ1bmN0aW9uKGEpe3ZhciBkPWEuZ3JhcGhpYyxhPWEuc2hhcGVBcmdzO2QmJmEmJihkLmF0dHIoXCJyXCIsMSksZC5hbmltYXRlKHtyOmEucn0sYikpfSksdGhpcy5hbmltYXRlPW51bGx9LHRyYW5zbGF0ZTpmdW5jdGlvbigpe3ZhciBhLGI9dGhpcy5kYXRhLGMsZCxnPXRoaXMucmFkaWk7aS5zY2F0dGVyLnByb3RvdHlwZS50cmFuc2xhdGUuY2FsbCh0aGlzKTtmb3IoYT1iLmxlbmd0aDthLS07KWM9YlthXSxkPWc/Z1thXTowLHR5cGVvZiBkPT09XCJudW1iZXJcIiYmZD49dGhpcy5taW5QeFNpemUvMj8oYy5zaGFwZVR5cGU9XCJjaXJjbGVcIixjLnNoYXBlQXJncz17eDpjLnBsb3RYLHk6Yy5wbG90WSxyOmR9LGMuZGxCb3g9e3g6Yy5wbG90WC1kLHk6Yy5wbG90WS1kLHdpZHRoOjIqZCxoZWlnaHQ6MipkfSk6Yy5zaGFwZUFyZ3M9Yy5wbG90WT1jLmRsQm94PXZvaWQgMH0sZHJhd0xlZ2VuZFN5bWJvbDpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuY2hhcnQucmVuZGVyZXIsZD1jLmZvbnRNZXRyaWNzKGEuaXRlbVN0eWxlLmZvbnRTaXplKS5mL1xuMjtiLmxlZ2VuZFN5bWJvbD1jLmNpcmNsZShkLGEuYmFzZWxpbmUtZCxkKS5hdHRyKHt6SW5kZXg6M30pLmFkZChiLmxlZ2VuZEdyb3VwKTtiLmxlZ2VuZFN5bWJvbC5pc01hcmtlcj0hMH0sZHJhd1BvaW50czppLmNvbHVtbi5wcm90b3R5cGUuZHJhd1BvaW50cyxhbGlnbkRhdGFMYWJlbDppLmNvbHVtbi5wcm90b3R5cGUuYWxpZ25EYXRhTGFiZWwsYnVpbGRLRFRyZWU6cixhcHBseVpvbmVzOnJ9KTtOLnByb3RvdHlwZS5iZWZvcmVQYWRkaW5nPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPXRoaXMubGVuLGM9dGhpcy5jaGFydCxkPTAsZz1iLGU9dGhpcy5pc1hBeGlzLGo9ZT9cInhEYXRhXCI6XCJ5RGF0YVwiLGw9dGhpcy5taW4saD17fSxmPXkubWluKGMucGxvdFdpZHRoLGMucGxvdEhlaWdodCksaz1OdW1iZXIuTUFYX1ZBTFVFLG49LU51bWJlci5NQVhfVkFMVUUsaT10aGlzLm1heC1sLG09Yi9pLHA9W107dCh0aGlzLnNlcmllcyxmdW5jdGlvbihiKXt2YXIgZz1iLm9wdGlvbnM7aWYoYi5idWJibGVQYWRkaW5nJiZcbihiLnZpc2libGV8fCFjLm9wdGlvbnMuY2hhcnQuaWdub3JlSGlkZGVuU2VyaWVzKSlpZihhLmFsbG93Wm9vbU91dHNpZGU9ITAscC5wdXNoKGIpLGUpdChbXCJtaW5TaXplXCIsXCJtYXhTaXplXCJdLGZ1bmN0aW9uKGEpe3ZhciBiPWdbYV0sZT0vJSQvLnRlc3QoYiksYj1CKGIpO2hbYV09ZT9mKmIvMTAwOmJ9KSxiLm1pblB4U2l6ZT1oLm1pblNpemUsYi5tYXhQeFNpemU9aC5tYXhTaXplLGI9Yi56RGF0YSxiLmxlbmd0aCYmKGs9byhnLnpNaW4seS5taW4oayx5Lm1heChRKGIpLGcuZGlzcGxheU5lZ2F0aXZlPT09ITE/Zy56VGhyZXNob2xkOi1OdW1iZXIuTUFYX1ZBTFVFKSkpLG49byhnLnpNYXgseS5tYXgobixSKGIpKSkpfSk7dChwLGZ1bmN0aW9uKGIpe3ZhciBjPWJbal0sZj1jLmxlbmd0aCxoO2UmJmIuZ2V0UmFkaWkoayxuLGIubWluUHhTaXplLGIubWF4UHhTaXplKTtpZihpPjApZm9yKDtmLS07KXR5cGVvZiBjW2ZdPT09XCJudW1iZXJcIiYmYS5kYXRhTWluPD1jW2ZdJiZjW2ZdPD1cbmEuZGF0YU1heCYmKGg9Yi5yYWRpaVtmXSxkPU1hdGgubWluKChjW2ZdLWwpKm0taCxkKSxnPU1hdGgubWF4KChjW2ZdLWwpKm0raCxnKSl9KTtwLmxlbmd0aCYmaT4wJiYhdGhpcy5pc0xvZyYmKGctPWIsbSo9KGIrZC1nKS9iLHQoW1tcIm1pblwiLFwidXNlck1pblwiLGRdLFtcIm1heFwiLFwidXNlck1heFwiLGddXSxmdW5jdGlvbihiKXtvKGEub3B0aW9uc1tiWzBdXSxhW2JbMV1dKT09PXZvaWQgMCYmKGFbYlswXV0rPWJbMl0vbSl9KSl9OyhmdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXt2YXIgYz10aGlzLmNoYXJ0LGQ9dGhpcy5vcHRpb25zLmFuaW1hdGlvbixoPXRoaXMuZ3JvdXAsZj10aGlzLm1hcmtlckdyb3VwLGs9dGhpcy54QXhpcy5jZW50ZXIsaT1jLnBsb3RMZWZ0LG09Yy5wbG90VG9wO2lmKGMucG9sYXIpe2lmKGMucmVuZGVyZXIuaXNTVkcpZD09PSEwJiYoZD17fSksYj8oYz17dHJhbnNsYXRlWDprWzBdK2ksdHJhbnNsYXRlWTprWzFdK20sc2NhbGVYOjAuMDAxLHNjYWxlWTowLjAwMX0sXG5oLmF0dHIoYyksZiYmZi5hdHRyKGMpKTooYz17dHJhbnNsYXRlWDppLHRyYW5zbGF0ZVk6bSxzY2FsZVg6MSxzY2FsZVk6MX0saC5hbmltYXRlKGMsZCksZiYmZi5hbmltYXRlKGMsZCksdGhpcy5hbmltYXRlPW51bGwpfWVsc2UgYS5jYWxsKHRoaXMsYil9dmFyIGI9eC5wcm90b3R5cGUsYz1ULnByb3RvdHlwZSxkO2Iuc2VhcmNoUG9pbnRCeUFuZ2xlPWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY2hhcnQsYz10aGlzLnhBeGlzLnBhbmUuY2VudGVyO3JldHVybiB0aGlzLnNlYXJjaEtEVHJlZSh7Y2xpZW50WDoxODArTWF0aC5hdGFuMihhLmNoYXJ0WC1jWzBdLWIucGxvdExlZnQsYS5jaGFydFktY1sxXS1iLnBsb3RUb3ApKigtMTgwL01hdGguUEkpfSl9O3coYixcImJ1aWxkS0RUcmVlXCIsZnVuY3Rpb24oYSl7aWYodGhpcy5jaGFydC5wb2xhcil0aGlzLmtkQnlBbmdsZT90aGlzLnNlYXJjaFBvaW50PXRoaXMuc2VhcmNoUG9pbnRCeUFuZ2xlOnRoaXMua2REaW1lbnNpb25zPTI7YS5hcHBseSh0aGlzKX0pO1xuYi50b1hZPWZ1bmN0aW9uKGEpe3ZhciBiLGM9dGhpcy5jaGFydCxkPWEucGxvdFg7Yj1hLnBsb3RZO2EucmVjdFBsb3RYPWQ7YS5yZWN0UGxvdFk9YjtiPXRoaXMueEF4aXMucG9zdFRyYW5zbGF0ZShhLnBsb3RYLHRoaXMueUF4aXMubGVuLWIpO2EucGxvdFg9YS5wb2xhclBsb3RYPWIueC1jLnBsb3RMZWZ0O2EucGxvdFk9YS5wb2xhclBsb3RZPWIueS1jLnBsb3RUb3A7dGhpcy5rZEJ5QW5nbGU/KGM9KGQvTWF0aC5QSSoxODArdGhpcy54QXhpcy5wYW5lLm9wdGlvbnMuc3RhcnRBbmdsZSklMzYwLGM8MCYmKGMrPTM2MCksYS5jbGllbnRYPWMpOmEuY2xpZW50WD1hLnBsb3RYfTtpLnNwbGluZSYmdyhpLnNwbGluZS5wcm90b3R5cGUsXCJnZXRQb2ludFNwbGluZVwiLGZ1bmN0aW9uKGEsYixjLGQpe3ZhciBoLGYsayxpLG0scCxvO2lmKHRoaXMuY2hhcnQucG9sYXIpe2g9Yy5wbG90WDtmPWMucGxvdFk7YT1iW2QtMV07az1iW2QrMV07dGhpcy5jb25uZWN0RW5kcyYmKGF8fChhPWJbYi5sZW5ndGgtXG4yXSksa3x8KGs9YlsxXSkpO2lmKGEmJmspaT1hLnBsb3RYLG09YS5wbG90WSxiPWsucGxvdFgscD1rLnBsb3RZLGk9KDEuNSpoK2kpLzIuNSxtPSgxLjUqZittKS8yLjUsaz0oMS41KmgrYikvMi41LG89KDEuNSpmK3ApLzIuNSxiPU1hdGguc3FydChNYXRoLnBvdyhpLWgsMikrTWF0aC5wb3cobS1mLDIpKSxwPU1hdGguc3FydChNYXRoLnBvdyhrLWgsMikrTWF0aC5wb3coby1mLDIpKSxpPU1hdGguYXRhbjIobS1mLGktaCksbT1NYXRoLmF0YW4yKG8tZixrLWgpLG89TWF0aC5QSS8yKyhpK20pLzIsTWF0aC5hYnMoaS1vKT5NYXRoLlBJLzImJihvLT1NYXRoLlBJKSxpPWgrTWF0aC5jb3MobykqYixtPWYrTWF0aC5zaW4obykqYixrPWgrTWF0aC5jb3MoTWF0aC5QSStvKSpwLG89ZitNYXRoLnNpbihNYXRoLlBJK28pKnAsYy5yaWdodENvbnRYPWssYy5yaWdodENvbnRZPW87ZD8oYz1bXCJDXCIsYS5yaWdodENvbnRYfHxhLnBsb3RYLGEucmlnaHRDb250WXx8YS5wbG90WSxpfHxoLG18fFxuZixoLGZdLGEucmlnaHRDb250WD1hLnJpZ2h0Q29udFk9bnVsbCk6Yz1bXCJNXCIsaCxmXX1lbHNlIGM9YS5jYWxsKHRoaXMsYixjLGQpO3JldHVybiBjfSk7dyhiLFwidHJhbnNsYXRlXCIsZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jaGFydDthLmNhbGwodGhpcyk7aWYoYi5wb2xhciYmKHRoaXMua2RCeUFuZ2xlPWIudG9vbHRpcCYmYi50b29sdGlwLnNoYXJlZCwhdGhpcy5wcmV2ZW50UG9zdFRyYW5zbGF0ZSkpe2E9dGhpcy5wb2ludHM7Zm9yKGI9YS5sZW5ndGg7Yi0tOyl0aGlzLnRvWFkoYVtiXSl9fSk7dyhiLFwiZ2V0R3JhcGhQYXRoXCIsZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzO2lmKHRoaXMuY2hhcnQucG9sYXIpe2I9Ynx8dGhpcy5wb2ludHM7aWYodGhpcy5vcHRpb25zLmNvbm5lY3RFbmRzIT09ITEmJmJbMF0ueSE9PW51bGwpdGhpcy5jb25uZWN0RW5kcz0hMCxiLnNwbGljZShiLmxlbmd0aCwwLGJbMF0pO3QoYixmdW5jdGlvbihhKXthLnBvbGFyUGxvdFk9PT12b2lkIDAmJmMudG9YWShhKX0pfXJldHVybiBhLmFwcGx5KHRoaXMsXG5bXS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSl9KTt3KGIsXCJhbmltYXRlXCIsYSk7aWYoaS5jb2x1bW4pZD1pLmNvbHVtbi5wcm90b3R5cGUsZC5wb2xhckFyYz1mdW5jdGlvbihhLGIsYyxkKXt2YXIgaD10aGlzLnhBeGlzLmNlbnRlcixmPXRoaXMueUF4aXMubGVuO3JldHVybiB0aGlzLmNoYXJ0LnJlbmRlcmVyLnN5bWJvbHMuYXJjKGhbMF0saFsxXSxmLWIsbnVsbCx7c3RhcnQ6YyxlbmQ6ZCxpbm5lclI6Zi1vKGEsZil9KX0sdyhkLFwiYW5pbWF0ZVwiLGEpLHcoZCxcInRyYW5zbGF0ZVwiLGZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMueEF4aXMsYz1iLnN0YXJ0QW5nbGVSYWQsZCxoLGY7dGhpcy5wcmV2ZW50UG9zdFRyYW5zbGF0ZT0hMDthLmNhbGwodGhpcyk7aWYoYi5pc1JhZGlhbCl7ZD10aGlzLnBvaW50cztmb3IoZj1kLmxlbmd0aDtmLS07KWg9ZFtmXSxhPWguYmFyWCtjLGguc2hhcGVUeXBlPVwicGF0aFwiLGguc2hhcGVBcmdzPXRoaXMucG9sYXJBcmMoaC55Qm90dG9tLGgucGxvdFksYSxcbmEraC5wb2ludFdpZHRoKSx0aGlzLnRvWFkoaCksaC50b29sdGlwUG9zPVtoLnBsb3RYLGgucGxvdFldLGgudHRCZWxvdz1oLnBsb3RZPmIuY2VudGVyWzFdfX0pLHcoZCxcImFsaWduRGF0YUxhYmVsXCIsZnVuY3Rpb24oYSxjLGQsaSxoLGYpe2lmKHRoaXMuY2hhcnQucG9sYXIpe2E9Yy5yZWN0UGxvdFgvTWF0aC5QSSoxODA7aWYoaS5hbGlnbj09PW51bGwpaS5hbGlnbj1hPjIwJiZhPDE2MD9cImxlZnRcIjphPjIwMCYmYTwzNDA/XCJyaWdodFwiOlwiY2VudGVyXCI7aWYoaS52ZXJ0aWNhbEFsaWduPT09bnVsbClpLnZlcnRpY2FsQWxpZ249YTw0NXx8YT4zMTU/XCJib3R0b21cIjphPjEzNSYmYTwyMjU/XCJ0b3BcIjpcIm1pZGRsZVwiO2IuYWxpZ25EYXRhTGFiZWwuY2FsbCh0aGlzLGMsZCxpLGgsZil9ZWxzZSBhLmNhbGwodGhpcyxjLGQsaSxoLGYpfSk7dyhjLFwiZ2V0Q29vcmRpbmF0ZXNcIixmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuY2hhcnQsZD17eEF4aXM6W10seUF4aXM6W119O2MucG9sYXI/dChjLmF4ZXMsXG5mdW5jdGlvbihhKXt2YXIgZj1hLmlzWEF4aXMsZz1hLmNlbnRlcixpPWIuY2hhcnRYLWdbMF0tYy5wbG90TGVmdCxnPWIuY2hhcnRZLWdbMV0tYy5wbG90VG9wO2RbZj9cInhBeGlzXCI6XCJ5QXhpc1wiXS5wdXNoKHtheGlzOmEsdmFsdWU6YS50cmFuc2xhdGUoZj9NYXRoLlBJLU1hdGguYXRhbjIoaSxnKTpNYXRoLnNxcnQoTWF0aC5wb3coaSwyKStNYXRoLnBvdyhnLDIpKSwhMCl9KX0pOmQ9YS5jYWxsKHRoaXMsYik7cmV0dXJuIGR9KX0pKCl9KTtcbiIsIi8qXG4gSGlnaHN0b2NrIEpTIHY0LjIuNCAoMjAxNi0wNC0xNClcblxuIChjKSAyMDA5LTIwMTYgVG9yc3RlaW4gSG9uc2lcblxuIExpY2Vuc2U6IHd3dy5oaWdoY2hhcnRzLmNvbS9saWNlbnNlXG4qL1xuKGZ1bmN0aW9uKEosZ2Epe3R5cGVvZiBtb2R1bGU9PT1cIm9iamVjdFwiJiZtb2R1bGUuZXhwb3J0cz9tb2R1bGUuZXhwb3J0cz1KLmRvY3VtZW50P2dhKEopOmdhOkouSGlnaGNoYXJ0cz1nYShKKX0pKHR5cGVvZiB3aW5kb3chPT1cInVuZGVmaW5lZFwiP3dpbmRvdzp0aGlzLGZ1bmN0aW9uKEope2Z1bmN0aW9uIGdhKGEsYil7dmFyIGM9XCJIaWdoY2hhcnRzIGVycm9yICNcIithK1wiOiB3d3cuaGlnaGNoYXJ0cy5jb20vZXJyb3JzL1wiK2E7aWYoYil0aHJvdyBFcnJvcihjKTtKLmNvbnNvbGUmJmNvbnNvbGUubG9nKGMpfWZ1bmN0aW9uIHliKGEsYixjKXt0aGlzLm9wdGlvbnM9Yjt0aGlzLmVsZW09YTt0aGlzLnByb3A9Y31mdW5jdGlvbiBDKCl7dmFyIGEsYj1hcmd1bWVudHMsYyxkPXt9LGU9ZnVuY3Rpb24oYSxiKXt2YXIgYyxkO3R5cGVvZiBhIT09XCJvYmplY3RcIiYmKGE9e30pO2ZvcihkIGluIGIpYi5oYXNPd25Qcm9wZXJ0eShkKSYmKGM9YltkXSxhW2RdPWMmJnR5cGVvZiBjPT09XCJvYmplY3RcIiYmXG5PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoYykhPT1cIltvYmplY3QgQXJyYXldXCImJmQhPT1cInJlbmRlclRvXCImJnR5cGVvZiBjLm5vZGVUeXBlIT09XCJudW1iZXJcIj9lKGFbZF18fHt9LGMpOmJbZF0pO3JldHVybiBhfTtiWzBdPT09ITAmJihkPWJbMV0sYj1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChiLDIpKTtjPWIubGVuZ3RoO2ZvcihhPTA7YTxjO2ErKylkPWUoZCxiW2FdKTtyZXR1cm4gZH1mdW5jdGlvbiBHKGEsYil7cmV0dXJuIHBhcnNlSW50KGEsYnx8MTApfWZ1bmN0aW9uIERhKGEpe3JldHVybiB0eXBlb2YgYT09PVwic3RyaW5nXCJ9ZnVuY3Rpb24gZGEoYSl7cmV0dXJuIGEmJnR5cGVvZiBhPT09XCJvYmplY3RcIn1mdW5jdGlvbiBKYShhKXtyZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGEpPT09XCJbb2JqZWN0IEFycmF5XVwifWZ1bmN0aW9uIHVhKGEpe3JldHVybiB0eXBlb2YgYT09PVwibnVtYmVyXCJ9ZnVuY3Rpb24gQWEoYSxiKXtmb3IodmFyIGM9XG5hLmxlbmd0aDtjLS07KWlmKGFbY109PT1iKXthLnNwbGljZShjLDEpO2JyZWFrfX1mdW5jdGlvbiBzKGEpe3JldHVybiBhIT09dCYmYSE9PW51bGx9ZnVuY3Rpb24gWChhLGIsYyl7dmFyIGQsZTtpZihEYShiKSlzKGMpP2Euc2V0QXR0cmlidXRlKGIsYyk6YSYmYS5nZXRBdHRyaWJ1dGUmJihlPWEuZ2V0QXR0cmlidXRlKGIpKTtlbHNlIGlmKHMoYikmJmRhKGIpKWZvcihkIGluIGIpYS5zZXRBdHRyaWJ1dGUoZCxiW2RdKTtyZXR1cm4gZX1mdW5jdGlvbiB2YShhKXtyZXR1cm4gSmEoYSk/YTpbYV19ZnVuY3Rpb24gJGEoYSxiLGMpe2lmKGIpcmV0dXJuIHNldFRpbWVvdXQoYSxiLGMpO2EuY2FsbCgwLGMpfWZ1bmN0aW9uIEYoYSxiKXtpZihLYSYmIWphJiZiJiZiLm9wYWNpdHkhPT10KWIuZmlsdGVyPVwiYWxwaGEob3BhY2l0eT1cIitiLm9wYWNpdHkqMTAwK1wiKVwiO3goYS5zdHlsZSxiKX1mdW5jdGlvbiBlYShhLGIsYyxkLGUpe2E9Qi5jcmVhdGVFbGVtZW50KGEpO2ImJngoYSxiKTtlJiZcbkYoYSx7cGFkZGluZzowLGJvcmRlcjpcIm5vbmVcIixtYXJnaW46MH0pO2MmJkYoYSxjKTtkJiZkLmFwcGVuZENoaWxkKGEpO3JldHVybiBhfWZ1bmN0aW9uIGxhKGEsYil7dmFyIGM9ZnVuY3Rpb24oKXt9O2MucHJvdG90eXBlPW5ldyBhO3goYy5wcm90b3R5cGUsYik7cmV0dXJuIGN9ZnVuY3Rpb24gTmEoYSxiLGMpe3JldHVybiBBcnJheSgoYnx8MikrMS1TdHJpbmcoYSkubGVuZ3RoKS5qb2luKGN8fDApK2F9ZnVuY3Rpb24gZmIoYSl7cmV0dXJuKGdiJiZnYihhKXx8emJ8fDApKjZFNH1mdW5jdGlvbiBMYShhLGIpe2Zvcih2YXIgYz1cIntcIixkPSExLGUsZixnLGgsaSxqPVtdOyhjPWEuaW5kZXhPZihjKSkhPT0tMTspe2U9YS5zbGljZSgwLGMpO2lmKGQpe2Y9ZS5zcGxpdChcIjpcIik7Zz1mLnNoaWZ0KCkuc3BsaXQoXCIuXCIpO2k9Zy5sZW5ndGg7ZT1iO2ZvcihoPTA7aDxpO2grKyllPWVbZ1toXV07aWYoZi5sZW5ndGgpZj1mLmpvaW4oXCI6XCIpLGc9L1xcLihbMC05XSkvLGg9Ti5sYW5nLGk9XG52b2lkIDAsL2YkLy50ZXN0KGYpPyhpPShpPWYubWF0Y2goZykpP2lbMV06LTEsZSE9PW51bGwmJihlPXoubnVtYmVyRm9ybWF0KGUsaSxoLmRlY2ltYWxQb2ludCxmLmluZGV4T2YoXCIsXCIpPi0xP2gudGhvdXNhbmRzU2VwOlwiXCIpKSk6ZT1tYShmLGUpfWoucHVzaChlKTthPWEuc2xpY2UoYysxKTtjPShkPSFkKT9cIn1cIjpcIntcIn1qLnB1c2goYSk7cmV0dXJuIGouam9pbihcIlwiKX1mdW5jdGlvbiBBYihhKXtyZXR1cm4gWS5wb3coMTAsVihZLmxvZyhhKS9ZLkxOMTApKX1mdW5jdGlvbiBCYihhLGIsYyxkLGUpe3ZhciBmLGc9YSxjPXEoYywxKTtmPWEvYztifHwoYj1bMSwyLDIuNSw1LDEwXSxkPT09ITEmJihjPT09MT9iPVsxLDIsNSwxMF06Yzw9MC4xJiYoYj1bMS9jXSkpKTtmb3IoZD0wO2Q8Yi5sZW5ndGg7ZCsrKWlmKGc9YltkXSxlJiZnKmM+PWF8fCFlJiZmPD0oYltkXSsoYltkKzFdfHxiW2RdKSkvMilicmVhaztnKj1jO3JldHVybiBnfWZ1bmN0aW9uIG9iKGEsYil7dmFyIGM9YS5sZW5ndGgsXG5kLGU7Zm9yKGU9MDtlPGM7ZSsrKWFbZV0uc2FmZUk9ZTthLnNvcnQoZnVuY3Rpb24oYSxjKXtkPWIoYSxjKTtyZXR1cm4gZD09PTA/YS5zYWZlSS1jLnNhZmVJOmR9KTtmb3IoZT0wO2U8YztlKyspZGVsZXRlIGFbZV0uc2FmZUl9ZnVuY3Rpb24gT2EoYSl7Zm9yKHZhciBiPWEubGVuZ3RoLGM9YVswXTtiLS07KWFbYl08YyYmKGM9YVtiXSk7cmV0dXJuIGN9ZnVuY3Rpb24gRWEoYSl7Zm9yKHZhciBiPWEubGVuZ3RoLGM9YVswXTtiLS07KWFbYl0+YyYmKGM9YVtiXSk7cmV0dXJuIGN9ZnVuY3Rpb24gUGEoYSxiKXtmb3IodmFyIGMgaW4gYSlhW2NdJiZhW2NdIT09YiYmYVtjXS5kZXN0cm95JiZhW2NdLmRlc3Ryb3koKSxkZWxldGUgYVtjXX1mdW5jdGlvbiBWYShhKXtwYnx8KHBiPWVhKFdhKSk7YSYmcGIuYXBwZW5kQ2hpbGQoYSk7cGIuaW5uZXJIVE1MPVwiXCJ9ZnVuY3Rpb24gbmEoYSxiKXtyZXR1cm4gcGFyc2VGbG9hdChhLnRvUHJlY2lzaW9uKGJ8fDE0KSl9ZnVuY3Rpb24gYWIoYSxcbmIpe2IucmVuZGVyZXIuZ2xvYmFsQW5pbWF0aW9uPXEoYSxiLmFuaW1hdGlvbil9ZnVuY3Rpb24gaGIoYSl7cmV0dXJuIGRhKGEpP0MoYSk6e2R1cmF0aW9uOmE/NTAwOjB9fWZ1bmN0aW9uIE9iKCl7dmFyIGE9Ti5nbG9iYWwsYj1hLnVzZVVUQyxjPWI/XCJnZXRVVENcIjpcImdldFwiLGQ9Yj9cInNldFVUQ1wiOlwic2V0XCI7ZmE9YS5EYXRlfHxKLkRhdGU7emI9YiYmYS50aW1lem9uZU9mZnNldDtnYj1iJiZhLmdldFRpbWV6b25lT2Zmc2V0O3FiPWZ1bmN0aW9uKGEsYyxkLGgsaSxqKXt2YXIgaztiPyhrPWZhLlVUQy5hcHBseSgwLGFyZ3VtZW50cyksays9ZmIoaykpOms9KG5ldyBmYShhLGMscShkLDEpLHEoaCwwKSxxKGksMCkscShqLDApKSkuZ2V0VGltZSgpO3JldHVybiBrfTtDYj1jK1wiTWludXRlc1wiO0RiPWMrXCJIb3Vyc1wiO0ViPWMrXCJEYXlcIjtiYj1jK1wiRGF0ZVwiO2liPWMrXCJNb250aFwiO2piPWMrXCJGdWxsWWVhclwiO1BiPWQrXCJNaWxsaXNlY29uZHNcIjtRYj1kK1wiU2Vjb25kc1wiO1JiPWQrXCJNaW51dGVzXCI7XG5TYj1kK1wiSG91cnNcIjtyYj1kK1wiRGF0ZVwiO0ZiPWQrXCJNb250aFwiO0diPWQrXCJGdWxsWWVhclwifWZ1bmN0aW9uIHdhKGEpe2lmKCEodGhpcyBpbnN0YW5jZW9mIHdhKSlyZXR1cm4gbmV3IHdhKGEpO3RoaXMuaW5pdChhKX1mdW5jdGlvbiBaKCl7fWZ1bmN0aW9uIGNiKGEsYixjLGQpe3RoaXMuYXhpcz1hO3RoaXMucG9zPWI7dGhpcy50eXBlPWN8fFwiXCI7dGhpcy5pc05ldz0hMDshYyYmIWQmJnRoaXMuYWRkTGFiZWwoKX1mdW5jdGlvbiBUYihhLGIsYyxkLGUpe3ZhciBmPWEuY2hhcnQuaW52ZXJ0ZWQ7dGhpcy5heGlzPWE7dGhpcy5pc05lZ2F0aXZlPWM7dGhpcy5vcHRpb25zPWI7dGhpcy54PWQ7dGhpcy50b3RhbD1udWxsO3RoaXMucG9pbnRzPXt9O3RoaXMuc3RhY2s9ZTt0aGlzLnJpZ2h0Q2xpZmY9dGhpcy5sZWZ0Q2xpZmY9MDt0aGlzLmFsaWduT3B0aW9ucz17YWxpZ246Yi5hbGlnbnx8KGY/Yz9cImxlZnRcIjpcInJpZ2h0XCI6XCJjZW50ZXJcIiksdmVydGljYWxBbGlnbjpiLnZlcnRpY2FsQWxpZ258fFxuKGY/XCJtaWRkbGVcIjpjP1wiYm90dG9tXCI6XCJ0b3BcIikseTpxKGIueSxmPzQ6Yz8xNDotNikseDpxKGIueCxmP2M/LTY6NjowKX07dGhpcy50ZXh0QWxpZ249Yi50ZXh0QWxpZ258fChmP2M/XCJyaWdodFwiOlwibGVmdFwiOlwiY2VudGVyXCIpfWZ1bmN0aW9uIEhiKGEpe3ZhciBiPWEub3B0aW9ucyxjPWIubmF2aWdhdG9yLGQ9Yy5lbmFibGVkLGI9Yi5zY3JvbGxiYXIsZT1iLmVuYWJsZWQsZj1kP2MuaGVpZ2h0OjAsZz1lP2IuaGVpZ2h0OjA7dGhpcy5oYW5kbGVzPVtdO3RoaXMuc2Nyb2xsYmFyQnV0dG9ucz1bXTt0aGlzLmVsZW1lbnRzVG9EZXN0cm95PVtdO3RoaXMuY2hhcnQ9YTt0aGlzLnNldEJhc2VTZXJpZXMoKTt0aGlzLmhlaWdodD1mO3RoaXMuc2Nyb2xsYmFySGVpZ2h0PWc7dGhpcy5zY3JvbGxiYXJFbmFibGVkPWU7dGhpcy5uYXZpZ2F0b3JFbmFibGVkPWQ7dGhpcy5uYXZpZ2F0b3JPcHRpb25zPWM7dGhpcy5zY3JvbGxiYXJPcHRpb25zPWI7dGhpcy5vdXRsaW5lSGVpZ2h0PWYrZzt0aGlzLmluaXQoKX1cbmZ1bmN0aW9uIEliKGEpe3RoaXMuaW5pdChhKX12YXIgdCxCPUouZG9jdW1lbnQsWT1NYXRoLHk9WS5yb3VuZCxWPVkuZmxvb3IsRmE9WS5jZWlsLHY9WS5tYXgsRT1ZLm1pbixTPVkuYWJzLGJhPVkuY29zLGthPVkuc2luLEJhPVkuUEkscGE9QmEqMi8zNjAsTWE9Si5uYXZpZ2F0b3ImJkoubmF2aWdhdG9yLnVzZXJBZ2VudHx8XCJcIixVYj1KLm9wZXJhLEthPS8obXNpZXx0cmlkZW50fGVkZ2UpL2kudGVzdChNYSkmJiFVYixzYj1CJiZCLmRvY3VtZW50TW9kZT09PTgsdGI9IUthJiYvQXBwbGVXZWJLaXQvLnRlc3QoTWEpLFhhPS9GaXJlZm94Ly50ZXN0KE1hKSxrYj0vKE1vYmlsZXxBbmRyb2lkfFdpbmRvd3MgUGhvbmUpLy50ZXN0KE1hKSxRYT1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIsamE9QiYmQi5jcmVhdGVFbGVtZW50TlMmJiEhQi5jcmVhdGVFbGVtZW50TlMoUWEsXCJzdmdcIikuY3JlYXRlU1ZHUmVjdCxaYj1YYSYmcGFyc2VJbnQoTWEuc3BsaXQoXCJGaXJlZm94L1wiKVsxXSxcbjEwKTw0LHFhPUImJiFqYSYmIUthJiYhIUIuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKS5nZXRDb250ZXh0LFlhLGRiLFZiPXt9LEpiPTAscGIsTixtYSxILHJhPWZ1bmN0aW9uKCl7fSwkPVtdLGxiPTAsV2E9XCJkaXZcIiwkYj0vXlswLTldKyQvLHViPVtcInBsb3RUb3BcIixcIm1hcmdpblJpZ2h0XCIsXCJtYXJnaW5Cb3R0b21cIixcInBsb3RMZWZ0XCJdLGZhLHFiLHpiLGdiLENiLERiLEViLGJiLGliLGpiLFBiLFFiLFJiLFNiLHJiLEZiLEdiLEs9e30sejt6PUouSGlnaGNoYXJ0cz9nYSgxNiwhMCk6e3dpbjpKfTt6LnNlcmllc1R5cGVzPUs7dmFyIFJhPVtdLHhhLHNhLG4sU2EsS2IsdGEsRCxULE0sZWIsVGE7eWIucHJvdG90eXBlPXtkU2V0dGVyOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5wYXRoc1swXSxiPXRoaXMucGF0aHNbMV0sYz1bXSxkPXRoaXMubm93LGU9YS5sZW5ndGgsZjtpZihkPT09MSljPXRoaXMudG9EO2Vsc2UgaWYoZT09PWIubGVuZ3RoJiZkPDEpZm9yKDtlLS07KWY9cGFyc2VGbG9hdChhW2VdKSxcbmNbZV09aXNOYU4oZik/YVtlXTpkKnBhcnNlRmxvYXQoYltlXS1mKStmO2Vsc2UgYz1iO3RoaXMuZWxlbS5hdHRyKFwiZFwiLGMpfSx1cGRhdGU6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmVsZW0sYj10aGlzLnByb3AsYz10aGlzLm5vdyxkPXRoaXMub3B0aW9ucy5zdGVwO2lmKHRoaXNbYitcIlNldHRlclwiXSl0aGlzW2IrXCJTZXR0ZXJcIl0oKTtlbHNlIGEuYXR0cj9hLmVsZW1lbnQmJmEuYXR0cihiLGMpOmEuc3R5bGVbYl09Yyt0aGlzLnVuaXQ7ZCYmZC5jYWxsKGEsYyx0aGlzKX0scnVuOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD10aGlzLGU9ZnVuY3Rpb24oYSl7cmV0dXJuIGUuc3RvcHBlZD8hMTpkLnN0ZXAoYSl9LGY7dGhpcy5zdGFydFRpbWU9K25ldyBmYTt0aGlzLnN0YXJ0PWE7dGhpcy5lbmQ9Yjt0aGlzLnVuaXQ9Yzt0aGlzLm5vdz10aGlzLnN0YXJ0O3RoaXMucG9zPTA7ZS5lbGVtPXRoaXMuZWxlbTtpZihlKCkmJlJhLnB1c2goZSk9PT0xKWUudGltZXJJZD1zZXRJbnRlcnZhbChmdW5jdGlvbigpe2ZvcihmPVxuMDtmPFJhLmxlbmd0aDtmKyspUmFbZl0oKXx8UmEuc3BsaWNlKGYtLSwxKTtSYS5sZW5ndGh8fGNsZWFySW50ZXJ2YWwoZS50aW1lcklkKX0sMTMpfSxzdGVwOmZ1bmN0aW9uKGEpe3ZhciBiPStuZXcgZmEsYyxkPXRoaXMub3B0aW9ucztjPXRoaXMuZWxlbTt2YXIgZT1kLmNvbXBsZXRlLGY9ZC5kdXJhdGlvbixnPWQuY3VyQW5pbSxoO2lmKGMuYXR0ciYmIWMuZWxlbWVudCljPSExO2Vsc2UgaWYoYXx8Yj49Zit0aGlzLnN0YXJ0VGltZSl7dGhpcy5ub3c9dGhpcy5lbmQ7dGhpcy5wb3M9MTt0aGlzLnVwZGF0ZSgpO2E9Z1t0aGlzLnByb3BdPSEwO2ZvcihoIGluIGcpZ1toXSE9PSEwJiYoYT0hMSk7YSYmZSYmZS5jYWxsKGMpO2M9ITF9ZWxzZSB0aGlzLnBvcz1kLmVhc2luZygoYi10aGlzLnN0YXJ0VGltZSkvZiksdGhpcy5ub3c9dGhpcy5zdGFydCsodGhpcy5lbmQtdGhpcy5zdGFydCkqdGhpcy5wb3MsdGhpcy51cGRhdGUoKSxjPSEwO3JldHVybiBjfSxpbml0UGF0aDpmdW5jdGlvbihhLFxuYixjKXt2YXIgYj1ifHxcIlwiLGQ9YS5zaGlmdCxlPWIuaW5kZXhPZihcIkNcIik+LTEsZj1lPzc6MyxnLGI9Yi5zcGxpdChcIiBcIiksYz1bXS5jb25jYXQoYyksaD1hLmlzQXJlYSxpPWg/MjoxLGo9ZnVuY3Rpb24oYSl7Zm9yKGc9YS5sZW5ndGg7Zy0tOykoYVtnXT09PVwiTVwifHxhW2ddPT09XCJMXCIpJiZhLnNwbGljZShnKzEsMCxhW2crMV0sYVtnKzJdLGFbZysxXSxhW2crMl0pfTtlJiYoaihiKSxqKGMpKTtpZihkPD1jLmxlbmd0aC9mJiZiLmxlbmd0aD09PWMubGVuZ3RoKWZvcig7ZC0tOyljPWMuc2xpY2UoMCxmKS5jb25jYXQoYyksaCYmKGM9Yy5jb25jYXQoYy5zbGljZShjLmxlbmd0aC1mKSkpO2Euc2hpZnQ9MDtpZihiLmxlbmd0aClmb3IoYT1jLmxlbmd0aDtiLmxlbmd0aDxhOylkPWIuc2xpY2UoKS5zcGxpY2UoYi5sZW5ndGgvaS1mLGYqaSksZSYmKGRbZi02XT1kW2YtMl0sZFtmLTVdPWRbZi0xXSksW10uc3BsaWNlLmFwcGx5KGIsW2IubGVuZ3RoL2ksMF0uY29uY2F0KGQpKTtyZXR1cm5bYixcbmNdfX07dmFyIHg9ei5leHRlbmQ9ZnVuY3Rpb24oYSxiKXt2YXIgYzthfHwoYT17fSk7Zm9yKGMgaW4gYilhW2NdPWJbY107cmV0dXJuIGF9LHE9ei5waWNrPWZ1bmN0aW9uKCl7dmFyIGE9YXJndW1lbnRzLGIsYyxkPWEubGVuZ3RoO2ZvcihiPTA7YjxkO2IrKylpZihjPWFbYl0sYyE9PXQmJmMhPT1udWxsKXJldHVybiBjfSxVPXoud3JhcD1mdW5jdGlvbihhLGIsYyl7dmFyIGQ9YVtiXTthW2JdPWZ1bmN0aW9uKCl7dmFyIGE9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKTthLnVuc2hpZnQoZCk7cmV0dXJuIGMuYXBwbHkodGhpcyxhKX19O21hPWZ1bmN0aW9uKGEsYixjKXtpZighcyhiKXx8aXNOYU4oYikpcmV0dXJuIE4ubGFuZy5pbnZhbGlkRGF0ZXx8XCJcIjt2YXIgYT1xKGEsXCIlWS0lbS0lZCAlSDolTTolU1wiKSxkPW5ldyBmYShiLWZiKGIpKSxlLGY9ZFtEYl0oKSxnPWRbRWJdKCksaD1kW2JiXSgpLGk9ZFtpYl0oKSxqPWRbamJdKCksaz1OLmxhbmcsbD1rLndlZWtkYXlzLFxubT1rLnNob3J0V2Vla2RheXMsZD14KHthOm0/bVtnXTpsW2ddLnN1YnN0cigwLDMpLEE6bFtnXSxkOk5hKGgpLGU6TmEoaCwyLFwiIFwiKSx3OmcsYjprLnNob3J0TW9udGhzW2ldLEI6ay5tb250aHNbaV0sbTpOYShpKzEpLHk6ai50b1N0cmluZygpLnN1YnN0cigyLDIpLFk6aixIOk5hKGYpLGs6ZixJOk5hKGYlMTJ8fDEyKSxsOmYlMTJ8fDEyLE06TmEoZFtDYl0oKSkscDpmPDEyP1wiQU1cIjpcIlBNXCIsUDpmPDEyP1wiYW1cIjpcInBtXCIsUzpOYShkLmdldFNlY29uZHMoKSksTDpOYSh5KGIlMUUzKSwzKX0sei5kYXRlRm9ybWF0cyk7Zm9yKGUgaW4gZClmb3IoO2EuaW5kZXhPZihcIiVcIitlKSE9PS0xOylhPWEucmVwbGFjZShcIiVcIitlLHR5cGVvZiBkW2VdPT09XCJmdW5jdGlvblwiP2RbZV0oYik6ZFtlXSk7cmV0dXJuIGM/YS5zdWJzdHIoMCwxKS50b1VwcGVyQ2FzZSgpK2Euc3Vic3RyKDEpOmF9O0g9e21pbGxpc2Vjb25kOjEsc2Vjb25kOjFFMyxtaW51dGU6NkU0LGhvdXI6MzZFNSxkYXk6ODY0RTUsXG53ZWVrOjYwNDhFNSxtb250aDoyNDE5MkU1LHllYXI6MzE0NDk2RTV9O3oubnVtYmVyRm9ybWF0PWZ1bmN0aW9uKGEsYixjLGQpe3ZhciBhPSthfHwwLGU9Ti5sYW5nLGY9KGEudG9TdHJpbmcoKS5zcGxpdChcIi5cIilbMV18fFwiXCIpLmxlbmd0aCxnLGgsaT1NYXRoLmFicyhhKTtiPT09LTE/Yj1NYXRoLm1pbihmLDIwKTppc05hTihiKSYmKGI9Mik7Zz1TdHJpbmcoRyhpLnRvRml4ZWQoYikpKTtoPWcubGVuZ3RoPjM/Zy5sZW5ndGglMzowO2M9cShjLGUuZGVjaW1hbFBvaW50KTtkPXEoZCxlLnRob3VzYW5kc1NlcCk7YT1hPDA/XCItXCI6XCJcIjthKz1oP2cuc3Vic3RyKDAsaCkrZDpcIlwiO2ErPWcuc3Vic3RyKGgpLnJlcGxhY2UoLyhcXGR7M30pKD89XFxkKS9nLFwiJDFcIitkKTsrYiYmKGQ9TWF0aC5hYnMoaS1nK01hdGgucG93KDEwLC1NYXRoLm1heChiLGYpLTEpKSxhKz1jK2QudG9GaXhlZChiKS5zbGljZSgyKSk7cmV0dXJuIGF9O01hdGguZWFzZUluT3V0U2luZT1mdW5jdGlvbihhKXtyZXR1cm4tMC41KlxuKE1hdGguY29zKE1hdGguUEkqYSktMSl9O3hhPWZ1bmN0aW9uKGEsYil7dmFyIGM7aWYoYj09PVwid2lkdGhcIilyZXR1cm4gTWF0aC5taW4oYS5vZmZzZXRXaWR0aCxhLnNjcm9sbFdpZHRoKS14YShhLFwicGFkZGluZy1sZWZ0XCIpLXhhKGEsXCJwYWRkaW5nLXJpZ2h0XCIpO2Vsc2UgaWYoYj09PVwiaGVpZ2h0XCIpcmV0dXJuIE1hdGgubWluKGEub2Zmc2V0SGVpZ2h0LGEuc2Nyb2xsSGVpZ2h0KS14YShhLFwicGFkZGluZy10b3BcIikteGEoYSxcInBhZGRpbmctYm90dG9tXCIpO3JldHVybihjPUouZ2V0Q29tcHV0ZWRTdHlsZShhLHZvaWQgMCkpJiZHKGMuZ2V0UHJvcGVydHlWYWx1ZShiKSl9O3NhPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGIuaW5kZXhPZj9iLmluZGV4T2YoYSk6W10uaW5kZXhPZi5jYWxsKGIsYSl9O1NhPWZ1bmN0aW9uKGEsYil7cmV0dXJuW10uZmlsdGVyLmNhbGwoYSxiKX07dGE9ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9W10sZD0wLGU9YS5sZW5ndGg7ZDxlO2QrKyljW2RdPWIuY2FsbChhW2RdLFxuYVtkXSxkLGEpO3JldHVybiBjfTtLYj1mdW5jdGlvbihhKXt2YXIgYj1CLmRvY3VtZW50RWxlbWVudCxhPWEuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7cmV0dXJue3RvcDphLnRvcCsoSi5wYWdlWU9mZnNldHx8Yi5zY3JvbGxUb3ApLShiLmNsaWVudFRvcHx8MCksbGVmdDphLmxlZnQrKEoucGFnZVhPZmZzZXR8fGIuc2Nyb2xsTGVmdCktKGIuY2xpZW50TGVmdHx8MCl9fTtUYT1mdW5jdGlvbihhKXtmb3IodmFyIGI9UmEubGVuZ3RoO2ItLTspaWYoUmFbYl0uZWxlbT09PWEpUmFbYl0uc3RvcHBlZD0hMH07bj1mdW5jdGlvbihhLGIpe3JldHVybiBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGEsYil9O0Q9ZnVuY3Rpb24oYSxiLGMpe2Z1bmN0aW9uIGQoYil7Yi50YXJnZXQ9Yi5zcmNFbGVtZW50fHxKO2MuY2FsbChhLGIpfXZhciBlPWEuaGNFdmVudHM9YS5oY0V2ZW50c3x8e307aWYoYS5hZGRFdmVudExpc3RlbmVyKWEuYWRkRXZlbnRMaXN0ZW5lcihiLGMsITEpO2Vsc2UgaWYoYS5hdHRhY2hFdmVudCl7aWYoIWEuaGNFdmVudHNJRSlhLmhjRXZlbnRzSUU9XG57fTthLmhjRXZlbnRzSUVbYy50b1N0cmluZygpXT1kO2EuYXR0YWNoRXZlbnQoXCJvblwiK2IsZCl9ZVtiXXx8KGVbYl09W10pO2VbYl0ucHVzaChjKX07VD1mdW5jdGlvbihhLGIsYyl7ZnVuY3Rpb24gZChiLGMpe2EucmVtb3ZlRXZlbnRMaXN0ZW5lcj9hLnJlbW92ZUV2ZW50TGlzdGVuZXIoYixjLCExKTphLmF0dGFjaEV2ZW50JiYoYz1hLmhjRXZlbnRzSUVbYy50b1N0cmluZygpXSxhLmRldGFjaEV2ZW50KFwib25cIitiLGMpKX1mdW5jdGlvbiBlKCl7dmFyIGMsZSxmO2lmKGEubm9kZU5hbWUpZm9yKGYgaW4gYj8oYz17fSxjW2JdPSEwKTpjPWcsYylpZihnW2ZdKWZvcihlPWdbZl0ubGVuZ3RoO2UtLTspZChmLGdbZl1bZV0pfXZhciBmLGc9YS5oY0V2ZW50cyxoO2lmKGcpYj8oZj1nW2JdfHxbXSxjPyhoPXNhKGMsZiksaD4tMSYmKGYuc3BsaWNlKGgsMSksZ1tiXT1mKSxkKGIsYykpOihlKCksZ1tiXT1bXSkpOihlKCksYS5oY0V2ZW50cz17fSl9O009ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU7XG5lPWEuaGNFdmVudHM7dmFyIGYsZyxjPWN8fHt9O2lmKEIuY3JlYXRlRXZlbnQmJihhLmRpc3BhdGNoRXZlbnR8fGEuZmlyZUV2ZW50KSllPUIuY3JlYXRlRXZlbnQoXCJFdmVudHNcIiksZS5pbml0RXZlbnQoYiwhMCwhMCksZS50YXJnZXQ9YSx4KGUsYyksYS5kaXNwYXRjaEV2ZW50P2EuZGlzcGF0Y2hFdmVudChlKTphLmZpcmVFdmVudChiLGUpO2Vsc2UgaWYoZSl7ZT1lW2JdfHxbXTtmPWUubGVuZ3RoO2lmKCFjLnByZXZlbnREZWZhdWx0KWMucHJldmVudERlZmF1bHQ9ZnVuY3Rpb24oKXtjLmRlZmF1bHRQcmV2ZW50ZWQ9ITB9O2MudGFyZ2V0PWE7aWYoIWMudHlwZSljLnR5cGU9Yjtmb3IoYj0wO2I8ZjtiKyspZz1lW2JdLGcuY2FsbChhLGMpPT09ITEmJmMucHJldmVudERlZmF1bHQoKX1kJiYhYy5kZWZhdWx0UHJldmVudGVkJiZkKGMpfTtlYj1mdW5jdGlvbihhLGIsYyl7dmFyIGQsZT1cIlwiLGYsZyxoO2RhKGMpfHwoZD1hcmd1bWVudHMsYz17ZHVyYXRpb246ZFsyXSxlYXNpbmc6ZFszXSxcbmNvbXBsZXRlOmRbNF19KTtpZighdWEoYy5kdXJhdGlvbikpYy5kdXJhdGlvbj00MDA7Yy5lYXNpbmc9dHlwZW9mIGMuZWFzaW5nPT09XCJmdW5jdGlvblwiP2MuZWFzaW5nOk1hdGhbYy5lYXNpbmddfHxNYXRoLmVhc2VJbk91dFNpbmU7Yy5jdXJBbmltPUMoYik7Zm9yKGggaW4gYilnPW5ldyB5YihhLGMsaCksZj1udWxsLGg9PT1cImRcIj8oZy5wYXRocz1nLmluaXRQYXRoKGEsYS5kLGIuZCksZy50b0Q9Yi5kLGQ9MCxmPTEpOmEuYXR0cj9kPWEuYXR0cihoKTooZD1wYXJzZUZsb2F0KHhhKGEsaCkpfHwwLGghPT1cIm9wYWNpdHlcIiYmKGU9XCJweFwiKSksZnx8KGY9YltoXSksZi5tYXRjaCYmZi5tYXRjaChcInB4XCIpJiYoZj1mLnJlcGxhY2UoL3B4L2csXCJcIikpLGcucnVuKGQsZixlKX07aWYoSi5qUXVlcnkpSi5qUXVlcnkuZm4uaGlnaGNoYXJ0cz1mdW5jdGlvbigpe3ZhciBhPVtdLnNsaWNlLmNhbGwoYXJndW1lbnRzKTtpZih0aGlzWzBdKXJldHVybiBhWzBdPyhuZXcgKHpbRGEoYVswXSk/YS5zaGlmdCgpOlxuXCJDaGFydFwiXSkodGhpc1swXSxhWzBdLGFbMV0pLHRoaXMpOiRbWCh0aGlzWzBdLFwiZGF0YS1oaWdoY2hhcnRzLWNoYXJ0XCIpXX07QiYmIUIuZGVmYXVsdFZpZXcmJih4YT1mdW5jdGlvbihhLGIpe3ZhciBjO2M9e3dpZHRoOlwiY2xpZW50V2lkdGhcIixoZWlnaHQ6XCJjbGllbnRIZWlnaHRcIn1bYl07aWYoYS5zdHlsZVtiXSlyZXR1cm4gRyhhLnN0eWxlW2JdKTtiPT09XCJvcGFjaXR5XCImJihiPVwiZmlsdGVyXCIpO2lmKGMpcmV0dXJuIGEuc3R5bGUuem9vbT0xLE1hdGgubWF4KGFbY10tMip4YShhLFwicGFkZGluZ1wiKSwwKTtjPWEuY3VycmVudFN0eWxlW2IucmVwbGFjZSgvXFwtKFxcdykvZyxmdW5jdGlvbihhLGIpe3JldHVybiBiLnRvVXBwZXJDYXNlKCl9KV07Yj09PVwiZmlsdGVyXCImJihjPWMucmVwbGFjZSgvYWxwaGFcXChvcGFjaXR5PShbMC05XSspXFwpLyxmdW5jdGlvbihhLGIpe3JldHVybiBiLzEwMH0pKTtyZXR1cm4gYz09PVwiXCI/MTpHKGMpfSk7QXJyYXkucHJvdG90eXBlLmZvckVhY2h8fFxuKG49ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9MCxkPWEubGVuZ3RoO2M8ZDtjKyspaWYoYi5jYWxsKGFbY10sYVtjXSxjLGEpPT09ITEpcmV0dXJuIGN9KTtBcnJheS5wcm90b3R5cGUuaW5kZXhPZnx8KHNhPWZ1bmN0aW9uKGEsYil7dmFyIGMsZD0wO2lmKGIpZm9yKGM9Yi5sZW5ndGg7ZDxjO2QrKylpZihiW2RdPT09YSlyZXR1cm4gZDtyZXR1cm4tMX0pO0FycmF5LnByb3RvdHlwZS5maWx0ZXJ8fChTYT1mdW5jdGlvbihhLGIpe2Zvcih2YXIgYz1bXSxkPTAsZT1hLmxlbmd0aDtkPGU7ZCsrKWIoYVtkXSxkKSYmYy5wdXNoKGFbZF0pO3JldHVybiBjfSk7ei5GeD15Yjt6LmluQXJyYXk9c2E7ei5lYWNoPW47ei5ncmVwPVNhO3oub2Zmc2V0PUtiO3oubWFwPXRhO3ouYWRkRXZlbnQ9RDt6LnJlbW92ZUV2ZW50PVQ7ei5maXJlRXZlbnQ9TTt6LmFuaW1hdGU9ZWI7ei5hbmltT2JqZWN0PWhiO3ouc3RvcD1UYTtOPXtjb2xvcnM6XCIjN2NiNWVjLCM0MzQzNDgsIzkwZWQ3ZCwjZjdhMzVjLCM4MDg1ZTksI2YxNWM4MCwjZTRkMzU0LCMyYjkwOGYsI2Y0NWI1YiwjOTFlOGUxXCIuc3BsaXQoXCIsXCIpLFxuc3ltYm9sczpbXCJjaXJjbGVcIixcImRpYW1vbmRcIixcInNxdWFyZVwiLFwidHJpYW5nbGVcIixcInRyaWFuZ2xlLWRvd25cIl0sbGFuZzp7bG9hZGluZzpcIkxvYWRpbmcuLi5cIixtb250aHM6XCJKYW51YXJ5LEZlYnJ1YXJ5LE1hcmNoLEFwcmlsLE1heSxKdW5lLEp1bHksQXVndXN0LFNlcHRlbWJlcixPY3RvYmVyLE5vdmVtYmVyLERlY2VtYmVyXCIuc3BsaXQoXCIsXCIpLHNob3J0TW9udGhzOlwiSmFuLEZlYixNYXIsQXByLE1heSxKdW4sSnVsLEF1ZyxTZXAsT2N0LE5vdixEZWNcIi5zcGxpdChcIixcIiksd2Vla2RheXM6XCJTdW5kYXksTW9uZGF5LFR1ZXNkYXksV2VkbmVzZGF5LFRodXJzZGF5LEZyaWRheSxTYXR1cmRheVwiLnNwbGl0KFwiLFwiKSxkZWNpbWFsUG9pbnQ6XCIuXCIsbnVtZXJpY1N5bWJvbHM6XCJrLE0sRyxULFAsRVwiLnNwbGl0KFwiLFwiKSxyZXNldFpvb206XCJSZXNldCB6b29tXCIscmVzZXRab29tVGl0bGU6XCJSZXNldCB6b29tIGxldmVsIDE6MVwiLHRob3VzYW5kc1NlcDpcIiBcIn0sZ2xvYmFsOnt1c2VVVEM6ITAsXG5jYW52YXNUb29sc1VSTDpcImh0dHA6Ly9jb2RlLmhpZ2hjaGFydHMuY29tL21vZHVsZXMvY2FudmFzLXRvb2xzLmpzXCIsVk1MUmFkaWFsR3JhZGllbnRVUkw6XCJodHRwOi8vY29kZS5oaWdoY2hhcnRzLmNvbS9zdG9jay80LjIuNC9nZngvdm1sLXJhZGlhbC1ncmFkaWVudC5wbmdcIn0sY2hhcnQ6e2JvcmRlckNvbG9yOlwiIzQ1NzJBN1wiLGJvcmRlclJhZGl1czowLGRlZmF1bHRTZXJpZXNUeXBlOlwibGluZVwiLGlnbm9yZUhpZGRlblNlcmllczohMCxzcGFjaW5nOlsxMCwxMCwxNSwxMF0sYmFja2dyb3VuZENvbG9yOlwiI0ZGRkZGRlwiLHBsb3RCb3JkZXJDb2xvcjpcIiNDMEMwQzBcIixyZXNldFpvb21CdXR0b246e3RoZW1lOnt6SW5kZXg6MjB9LHBvc2l0aW9uOnthbGlnbjpcInJpZ2h0XCIseDotMTAseToxMH19fSx0aXRsZTp7dGV4dDpcIkNoYXJ0IHRpdGxlXCIsYWxpZ246XCJjZW50ZXJcIixtYXJnaW46MTUsc3R5bGU6e2NvbG9yOlwiIzMzMzMzM1wiLGZvbnRTaXplOlwiMThweFwifX0sc3VidGl0bGU6e3RleHQ6XCJcIixcbmFsaWduOlwiY2VudGVyXCIsc3R5bGU6e2NvbG9yOlwiIzU1NTU1NVwifX0scGxvdE9wdGlvbnM6e2xpbmU6e2FsbG93UG9pbnRTZWxlY3Q6ITEsc2hvd0NoZWNrYm94OiExLGFuaW1hdGlvbjp7ZHVyYXRpb246MUUzfSxldmVudHM6e30sbGluZVdpZHRoOjIsbWFya2VyOntsaW5lV2lkdGg6MCxyYWRpdXM6NCxsaW5lQ29sb3I6XCIjRkZGRkZGXCIsc3RhdGVzOntob3Zlcjp7ZW5hYmxlZDohMCxsaW5lV2lkdGhQbHVzOjEscmFkaXVzUGx1czoyfSxzZWxlY3Q6e2ZpbGxDb2xvcjpcIiNGRkZGRkZcIixsaW5lQ29sb3I6XCIjMDAwMDAwXCIsbGluZVdpZHRoOjJ9fX0scG9pbnQ6e2V2ZW50czp7fX0sZGF0YUxhYmVsczp7YWxpZ246XCJjZW50ZXJcIixmb3JtYXR0ZXI6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy55PT09bnVsbD9cIlwiOnoubnVtYmVyRm9ybWF0KHRoaXMueSwtMSl9LHN0eWxlOntjb2xvcjpcImNvbnRyYXN0XCIsZm9udFNpemU6XCIxMXB4XCIsZm9udFdlaWdodDpcImJvbGRcIix0ZXh0U2hhZG93OlwiMCAwIDZweCBjb250cmFzdCwgMCAwIDNweCBjb250cmFzdFwifSxcbnZlcnRpY2FsQWxpZ246XCJib3R0b21cIix4OjAseTowLHBhZGRpbmc6NX0sY3JvcFRocmVzaG9sZDozMDAscG9pbnRSYW5nZTowLHNvZnRUaHJlc2hvbGQ6ITAsc3RhdGVzOntob3Zlcjp7bGluZVdpZHRoUGx1czoxLG1hcmtlcjp7fSxoYWxvOntzaXplOjEwLG9wYWNpdHk6MC4yNX19LHNlbGVjdDp7bWFya2VyOnt9fX0sc3RpY2t5VHJhY2tpbmc6ITAsdHVyYm9UaHJlc2hvbGQ6MUUzfX0sbGFiZWxzOntzdHlsZTp7cG9zaXRpb246XCJhYnNvbHV0ZVwiLGNvbG9yOlwiIzNFNTc2RlwifX0sbGVnZW5kOntlbmFibGVkOiEwLGFsaWduOlwiY2VudGVyXCIsbGF5b3V0OlwiaG9yaXpvbnRhbFwiLGxhYmVsRm9ybWF0dGVyOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubmFtZX0sYm9yZGVyQ29sb3I6XCIjOTA5MDkwXCIsYm9yZGVyUmFkaXVzOjAsbmF2aWdhdGlvbjp7YWN0aXZlQ29sb3I6XCIjMjc0YjZkXCIsaW5hY3RpdmVDb2xvcjpcIiNDQ0NcIn0sc2hhZG93OiExLGl0ZW1TdHlsZTp7Y29sb3I6XCIjMzMzMzMzXCIsZm9udFNpemU6XCIxMnB4XCIsXG5mb250V2VpZ2h0OlwiYm9sZFwifSxpdGVtSG92ZXJTdHlsZTp7Y29sb3I6XCIjMDAwXCJ9LGl0ZW1IaWRkZW5TdHlsZTp7Y29sb3I6XCIjQ0NDXCJ9LGl0ZW1DaGVja2JveFN0eWxlOntwb3NpdGlvbjpcImFic29sdXRlXCIsd2lkdGg6XCIxM3B4XCIsaGVpZ2h0OlwiMTNweFwifSxzeW1ib2xQYWRkaW5nOjUsdmVydGljYWxBbGlnbjpcImJvdHRvbVwiLHg6MCx5OjAsdGl0bGU6e3N0eWxlOntmb250V2VpZ2h0OlwiYm9sZFwifX19LGxvYWRpbmc6e2xhYmVsU3R5bGU6e2ZvbnRXZWlnaHQ6XCJib2xkXCIscG9zaXRpb246XCJyZWxhdGl2ZVwiLHRvcDpcIjQ1JVwifSxzdHlsZTp7cG9zaXRpb246XCJhYnNvbHV0ZVwiLGJhY2tncm91bmRDb2xvcjpcIndoaXRlXCIsb3BhY2l0eTowLjUsdGV4dEFsaWduOlwiY2VudGVyXCJ9fSx0b29sdGlwOntlbmFibGVkOiEwLGFuaW1hdGlvbjpqYSxiYWNrZ3JvdW5kQ29sb3I6XCJyZ2JhKDI0OSwgMjQ5LCAyNDksIC44NSlcIixib3JkZXJXaWR0aDoxLGJvcmRlclJhZGl1czozLGRhdGVUaW1lTGFiZWxGb3JtYXRzOnttaWxsaXNlY29uZDpcIiVBLCAlYiAlZSwgJUg6JU06JVMuJUxcIixcbnNlY29uZDpcIiVBLCAlYiAlZSwgJUg6JU06JVNcIixtaW51dGU6XCIlQSwgJWIgJWUsICVIOiVNXCIsaG91cjpcIiVBLCAlYiAlZSwgJUg6JU1cIixkYXk6XCIlQSwgJWIgJWUsICVZXCIsd2VlazpcIldlZWsgZnJvbSAlQSwgJWIgJWUsICVZXCIsbW9udGg6XCIlQiAlWVwiLHllYXI6XCIlWVwifSxmb290ZXJGb3JtYXQ6XCJcIixoZWFkZXJGb3JtYXQ6JzxzcGFuIHN0eWxlPVwiZm9udC1zaXplOiAxMHB4XCI+e3BvaW50LmtleX08L3NwYW4+PGJyLz4nLHBvaW50Rm9ybWF0Oic8c3BhbiBzdHlsZT1cImNvbG9yOntwb2ludC5jb2xvcn1cIj5cXHUyNWNmPC9zcGFuPiB7c2VyaWVzLm5hbWV9OiA8Yj57cG9pbnQueX08L2I+PGJyLz4nLHNoYWRvdzohMCxzbmFwOmtiPzI1OjEwLHN0eWxlOntjb2xvcjpcIiMzMzMzMzNcIixjdXJzb3I6XCJkZWZhdWx0XCIsZm9udFNpemU6XCIxMnB4XCIscGFkZGluZzpcIjhweFwiLHBvaW50ZXJFdmVudHM6XCJub25lXCIsd2hpdGVTcGFjZTpcIm5vd3JhcFwifX0sY3JlZGl0czp7ZW5hYmxlZDohMCx0ZXh0OlwiSGlnaGNoYXJ0cy5jb21cIixcbmhyZWY6XCJodHRwOi8vd3d3LmhpZ2hjaGFydHMuY29tXCIscG9zaXRpb246e2FsaWduOlwicmlnaHRcIix4Oi0xMCx2ZXJ0aWNhbEFsaWduOlwiYm90dG9tXCIseTotNX0sc3R5bGU6e2N1cnNvcjpcInBvaW50ZXJcIixjb2xvcjpcIiM5MDkwOTBcIixmb250U2l6ZTpcIjlweFwifX19O3ZhciBXPU4ucGxvdE9wdGlvbnMsY2E9Vy5saW5lO09iKCk7d2EucHJvdG90eXBlPXtwYXJzZXJzOlt7cmVnZXg6L3JnYmFcXChcXHMqKFswLTldezEsM30pXFxzKixcXHMqKFswLTldezEsM30pXFxzKixcXHMqKFswLTldezEsM30pXFxzKixcXHMqKFswLTldPyg/OlxcLlswLTldKyk/KVxccypcXCkvLHBhcnNlOmZ1bmN0aW9uKGEpe3JldHVybltHKGFbMV0pLEcoYVsyXSksRyhhWzNdKSxwYXJzZUZsb2F0KGFbNF0sMTApXX19LHtyZWdleDovIyhbYS1mQS1GMC05XXsyfSkoW2EtZkEtRjAtOV17Mn0pKFthLWZBLUYwLTldezJ9KS8scGFyc2U6ZnVuY3Rpb24oYSl7cmV0dXJuW0coYVsxXSwxNiksRyhhWzJdLDE2KSxHKGFbM10sMTYpLDFdfX0sXG57cmVnZXg6L3JnYlxcKFxccyooWzAtOV17MSwzfSlcXHMqLFxccyooWzAtOV17MSwzfSlcXHMqLFxccyooWzAtOV17MSwzfSlcXHMqXFwpLyxwYXJzZTpmdW5jdGlvbihhKXtyZXR1cm5bRyhhWzFdKSxHKGFbMl0pLEcoYVszXSksMV19fV0saW5pdDpmdW5jdGlvbihhKXt2YXIgYixjLGQsZTtpZigodGhpcy5pbnB1dD1hKSYmYS5zdG9wcyl0aGlzLnN0b3BzPXRhKGEuc3RvcHMsZnVuY3Rpb24oYSl7cmV0dXJuIG5ldyB3YShhWzFdKX0pO2Vsc2UgZm9yKGQ9dGhpcy5wYXJzZXJzLmxlbmd0aDtkLS0mJiFjOyllPXRoaXMucGFyc2Vyc1tkXSwoYj1lLnJlZ2V4LmV4ZWMoYSkpJiYoYz1lLnBhcnNlKGIpKTt0aGlzLnJnYmE9Y3x8W119LGdldDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmlucHV0LGM9dGhpcy5yZ2JhLGQ7dGhpcy5zdG9wcz8oZD1DKGIpLGQuc3RvcHM9W10uY29uY2F0KGQuc3RvcHMpLG4odGhpcy5zdG9wcyxmdW5jdGlvbihiLGMpe2Quc3RvcHNbY109W2Quc3RvcHNbY11bMF0sYi5nZXQoYSldfSkpOlxuZD1jJiYhaXNOYU4oY1swXSk/YT09PVwicmdiXCJ8fCFhJiZjWzNdPT09MT9cInJnYihcIitjWzBdK1wiLFwiK2NbMV0rXCIsXCIrY1syXStcIilcIjphPT09XCJhXCI/Y1szXTpcInJnYmEoXCIrYy5qb2luKFwiLFwiKStcIilcIjpiO3JldHVybiBkfSxicmlnaHRlbjpmdW5jdGlvbihhKXt2YXIgYixjPXRoaXMucmdiYTtpZih0aGlzLnN0b3BzKW4odGhpcy5zdG9wcyxmdW5jdGlvbihiKXtiLmJyaWdodGVuKGEpfSk7ZWxzZSBpZih1YShhKSYmYSE9PTApZm9yKGI9MDtiPDM7YisrKWNbYl0rPUcoYSoyNTUpLGNbYl08MCYmKGNbYl09MCksY1tiXT4yNTUmJihjW2JdPTI1NSk7cmV0dXJuIHRoaXN9LHNldE9wYWNpdHk6ZnVuY3Rpb24oYSl7dGhpcy5yZ2JhWzNdPWE7cmV0dXJuIHRoaXN9fTtaLnByb3RvdHlwZT17b3BhY2l0eToxLHRleHRQcm9wczpcImRpcmVjdGlvbixmb250U2l6ZSxmb250V2VpZ2h0LGZvbnRGYW1pbHksZm9udFN0eWxlLGNvbG9yLGxpbmVIZWlnaHQsd2lkdGgsdGV4dERlY29yYXRpb24sdGV4dE92ZXJmbG93LHRleHRTaGFkb3dcIi5zcGxpdChcIixcIiksXG5pbml0OmZ1bmN0aW9uKGEsYil7dGhpcy5lbGVtZW50PWI9PT1cInNwYW5cIj9lYShiKTpCLmNyZWF0ZUVsZW1lbnROUyhRYSxiKTt0aGlzLnJlbmRlcmVyPWF9LGFuaW1hdGU6ZnVuY3Rpb24oYSxiLGMpe2I9cShiLHRoaXMucmVuZGVyZXIuZ2xvYmFsQW5pbWF0aW9uLCEwKTtUYSh0aGlzKTtpZihiKXtpZihjKWIuY29tcGxldGU9YztlYih0aGlzLGEsYil9ZWxzZSB0aGlzLmF0dHIoYSxudWxsLGMpO3JldHVybiB0aGlzfSxjb2xvckdyYWRpZW50OmZ1bmN0aW9uKGEsYixjKXt2YXIgZD10aGlzLnJlbmRlcmVyLGUsZixnLGgsaSxqLGssbCxtLG8scCxyPVtdLEE7YS5saW5lYXJHcmFkaWVudD9mPVwibGluZWFyR3JhZGllbnRcIjphLnJhZGlhbEdyYWRpZW50JiYoZj1cInJhZGlhbEdyYWRpZW50XCIpO2lmKGYpe2c9YVtmXTtpPWQuZ3JhZGllbnRzO2s9YS5zdG9wcztvPWMucmFkaWFsUmVmZXJlbmNlO0phKGcpJiYoYVtmXT1nPXt4MTpnWzBdLHkxOmdbMV0seDI6Z1syXSx5MjpnWzNdLGdyYWRpZW50VW5pdHM6XCJ1c2VyU3BhY2VPblVzZVwifSk7XG5mPT09XCJyYWRpYWxHcmFkaWVudFwiJiZvJiYhcyhnLmdyYWRpZW50VW5pdHMpJiYoaD1nLGc9QyhnLGQuZ2V0UmFkaWFsQXR0cihvLGgpLHtncmFkaWVudFVuaXRzOlwidXNlclNwYWNlT25Vc2VcIn0pKTtmb3IocCBpbiBnKXAhPT1cImlkXCImJnIucHVzaChwLGdbcF0pO2ZvcihwIGluIGspci5wdXNoKGtbcF0pO3I9ci5qb2luKFwiLFwiKTtpW3JdP289aVtyXS5hdHRyKFwiaWRcIik6KGcuaWQ9bz1cImhpZ2hjaGFydHMtXCIrSmIrKyxpW3JdPWo9ZC5jcmVhdGVFbGVtZW50KGYpLmF0dHIoZykuYWRkKGQuZGVmcyksai5yYWRBdHRyPWgsai5zdG9wcz1bXSxuKGssZnVuY3Rpb24oYSl7YVsxXS5pbmRleE9mKFwicmdiYVwiKT09PTA/KGU9d2EoYVsxXSksbD1lLmdldChcInJnYlwiKSxtPWUuZ2V0KFwiYVwiKSk6KGw9YVsxXSxtPTEpO2E9ZC5jcmVhdGVFbGVtZW50KFwic3RvcFwiKS5hdHRyKHtvZmZzZXQ6YVswXSxcInN0b3AtY29sb3JcIjpsLFwic3RvcC1vcGFjaXR5XCI6bX0pLmFkZChqKTtqLnN0b3BzLnB1c2goYSl9KSk7XG5BPVwidXJsKFwiK2QudXJsK1wiI1wiK28rXCIpXCI7Yy5zZXRBdHRyaWJ1dGUoYixBKTtjLmdyYWRpZW50PXI7YS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiBBfX19LGFwcGx5VGV4dFNoYWRvdzpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmVsZW1lbnQsYyxkPWEuaW5kZXhPZihcImNvbnRyYXN0XCIpIT09LTEsZT17fSxmPXRoaXMucmVuZGVyZXIuZm9yRXhwb3J0LGc9Znx8Yi5zdHlsZS50ZXh0U2hhZG93IT09dCYmIUthO2lmKGQpZS50ZXh0U2hhZG93PWE9YS5yZXBsYWNlKC9jb250cmFzdC9nLHRoaXMucmVuZGVyZXIuZ2V0Q29udHJhc3QoYi5zdHlsZS5maWxsKSk7aWYodGJ8fGYpZS50ZXh0UmVuZGVyaW5nPVwiZ2VvbWV0cmljUHJlY2lzaW9uXCI7Zz90aGlzLmNzcyhlKToodGhpcy5mYWtlVFM9ITAsdGhpcy55U2V0dGVyPXRoaXMueFNldHRlcixjPVtdLnNsaWNlLmNhbGwoYi5nZXRFbGVtZW50c0J5VGFnTmFtZShcInRzcGFuXCIpKSxuKGEuc3BsaXQoL1xccz8sXFxzPy9nKSxmdW5jdGlvbihhKXt2YXIgZD1cbmIuZmlyc3RDaGlsZCxlLGYsYT1hLnNwbGl0KFwiIFwiKTtlPWFbYS5sZW5ndGgtMV07KGY9YVthLmxlbmd0aC0yXSkmJm4oYyxmdW5jdGlvbihhLGMpe3ZhciBnO2M9PT0wJiYoYS5zZXRBdHRyaWJ1dGUoXCJ4XCIsYi5nZXRBdHRyaWJ1dGUoXCJ4XCIpKSxjPWIuZ2V0QXR0cmlidXRlKFwieVwiKSxhLnNldEF0dHJpYnV0ZShcInlcIixjfHwwKSxjPT09bnVsbCYmYi5zZXRBdHRyaWJ1dGUoXCJ5XCIsMCkpO2c9YS5jbG9uZU5vZGUoMSk7WChnLHtcImNsYXNzXCI6XCJoaWdoY2hhcnRzLXRleHQtc2hhZG93XCIsZmlsbDplLHN0cm9rZTplLFwic3Ryb2tlLW9wYWNpdHlcIjoxL3YoRyhmKSwzKSxcInN0cm9rZS13aWR0aFwiOmYsXCJzdHJva2UtbGluZWpvaW5cIjpcInJvdW5kXCJ9KTtiLmluc2VydEJlZm9yZShnLGQpfSl9KSl9LGF0dHI6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGU9dGhpcy5lbGVtZW50LGYsZz10aGlzLGg7dHlwZW9mIGE9PT1cInN0cmluZ1wiJiZiIT09dCYmKGQ9YSxhPXt9LGFbZF09Yik7aWYodHlwZW9mIGE9PT1cblwic3RyaW5nXCIpZz0odGhpc1thK1wiR2V0dGVyXCJdfHx0aGlzLl9kZWZhdWx0R2V0dGVyKS5jYWxsKHRoaXMsYSxlKTtlbHNle2ZvcihkIGluIGEpe2I9YVtkXTtoPSExO3RoaXMuc3ltYm9sTmFtZSYmL14oeHx5fHdpZHRofGhlaWdodHxyfHN0YXJ0fGVuZHxpbm5lclJ8YW5jaG9yWHxhbmNob3JZKS8udGVzdChkKSYmKGZ8fCh0aGlzLnN5bWJvbEF0dHIoYSksZj0hMCksaD0hMCk7aWYodGhpcy5yb3RhdGlvbiYmKGQ9PT1cInhcInx8ZD09PVwieVwiKSl0aGlzLmRvVHJhbnNmb3JtPSEwO2h8fChoPXRoaXNbZCtcIlNldHRlclwiXXx8dGhpcy5fZGVmYXVsdFNldHRlcixoLmNhbGwodGhpcyxiLGQsZSksdGhpcy5zaGFkb3dzJiYvXih3aWR0aHxoZWlnaHR8dmlzaWJpbGl0eXx4fHl8ZHx0cmFuc2Zvcm18Y3h8Y3l8cikkLy50ZXN0KGQpJiZ0aGlzLnVwZGF0ZVNoYWRvd3MoZCxiLGgpKX1pZih0aGlzLmRvVHJhbnNmb3JtKXRoaXMudXBkYXRlVHJhbnNmb3JtKCksdGhpcy5kb1RyYW5zZm9ybT0hMX1jJiZcbmMoKTtyZXR1cm4gZ30sdXBkYXRlU2hhZG93czpmdW5jdGlvbihhLGIsYyl7Zm9yKHZhciBkPXRoaXMuc2hhZG93cyxlPWQubGVuZ3RoO2UtLTspYy5jYWxsKGRbZV0sYT09PVwiaGVpZ2h0XCI/TWF0aC5tYXgoYi0oZFtlXS5jdXRIZWlnaHR8fDApLDApOmE9PT1cImRcIj90aGlzLmQ6YixhLGRbZV0pfSxhZGRDbGFzczpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmVsZW1lbnQsYz1YKGIsXCJjbGFzc1wiKXx8XCJcIjtjLmluZGV4T2YoYSk9PT0tMSYmWChiLFwiY2xhc3NcIixjK1wiIFwiK2EpO3JldHVybiB0aGlzfSxzeW1ib2xBdHRyOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7bihcIngseSxyLHN0YXJ0LGVuZCx3aWR0aCxoZWlnaHQsaW5uZXJSLGFuY2hvclgsYW5jaG9yWVwiLnNwbGl0KFwiLFwiKSxmdW5jdGlvbihjKXtiW2NdPXEoYVtjXSxiW2NdKX0pO2IuYXR0cih7ZDpiLnJlbmRlcmVyLnN5bWJvbHNbYi5zeW1ib2xOYW1lXShiLngsYi55LGIud2lkdGgsYi5oZWlnaHQsYil9KX0sY2xpcDpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5hdHRyKFwiY2xpcC1wYXRoXCIsXG5hP1widXJsKFwiK3RoaXMucmVuZGVyZXIudXJsK1wiI1wiK2EuaWQrXCIpXCI6XCJub25lXCIpfSxjcmlzcDpmdW5jdGlvbihhKXt2YXIgYixjPXt9LGQsZT10aGlzLnN0cm9rZVdpZHRofHwwO2Q9eShlKSUyLzI7YS54PVYoYS54fHx0aGlzLnh8fDApK2Q7YS55PVYoYS55fHx0aGlzLnl8fDApK2Q7YS53aWR0aD1WKChhLndpZHRofHx0aGlzLndpZHRofHwwKS0yKmQpO2EuaGVpZ2h0PVYoKGEuaGVpZ2h0fHx0aGlzLmhlaWdodHx8MCktMipkKTthLnN0cm9rZVdpZHRoPWU7Zm9yKGIgaW4gYSl0aGlzW2JdIT09YVtiXSYmKHRoaXNbYl09Y1tiXT1hW2JdKTtyZXR1cm4gY30sY3NzOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuc3R5bGVzLGM9e30sZD10aGlzLmVsZW1lbnQsZSxmLGc9XCJcIjtlPSFiO2lmKGEmJmEuY29sb3IpYS5maWxsPWEuY29sb3I7aWYoYilmb3IoZiBpbiBhKWFbZl0hPT1iW2ZdJiYoY1tmXT1hW2ZdLGU9ITApO2lmKGUpe2U9dGhpcy50ZXh0V2lkdGg9YSYmYS53aWR0aCYmZC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpPT09XG5cInRleHRcIiYmRyhhLndpZHRoKXx8dGhpcy50ZXh0V2lkdGg7YiYmKGE9eChiLGMpKTt0aGlzLnN0eWxlcz1hO2UmJihxYXx8IWphJiZ0aGlzLnJlbmRlcmVyLmZvckV4cG9ydCkmJmRlbGV0ZSBhLndpZHRoO2lmKEthJiYhamEpRih0aGlzLmVsZW1lbnQsYSk7ZWxzZXtiPWZ1bmN0aW9uKGEsYil7cmV0dXJuXCItXCIrYi50b0xvd2VyQ2FzZSgpfTtmb3IoZiBpbiBhKWcrPWYucmVwbGFjZSgvKFtBLVpdKS9nLGIpK1wiOlwiK2FbZl0rXCI7XCI7WChkLFwic3R5bGVcIixnKX1lJiZ0aGlzLmFkZGVkJiZ0aGlzLnJlbmRlcmVyLmJ1aWxkVGV4dCh0aGlzKX1yZXR1cm4gdGhpc30sb246ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLGQ9Yy5lbGVtZW50O2RiJiZhPT09XCJjbGlja1wiPyhkLm9udG91Y2hzdGFydD1mdW5jdGlvbihhKXtjLnRvdWNoRXZlbnRGaXJlZD1mYS5ub3coKTthLnByZXZlbnREZWZhdWx0KCk7Yi5jYWxsKGQsYSl9LGQub25jbGljaz1mdW5jdGlvbihhKXsoTWEuaW5kZXhPZihcIkFuZHJvaWRcIik9PT1cbi0xfHxmYS5ub3coKS0oYy50b3VjaEV2ZW50RmlyZWR8fDApPjExMDApJiZiLmNhbGwoZCxhKX0pOmRbXCJvblwiK2FdPWI7cmV0dXJuIHRoaXN9LHNldFJhZGlhbFJlZmVyZW5jZTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLnJlbmRlcmVyLmdyYWRpZW50c1t0aGlzLmVsZW1lbnQuZ3JhZGllbnRdO3RoaXMuZWxlbWVudC5yYWRpYWxSZWZlcmVuY2U9YTtiJiZiLnJhZEF0dHImJmIuYW5pbWF0ZSh0aGlzLnJlbmRlcmVyLmdldFJhZGlhbEF0dHIoYSxiLnJhZEF0dHIpKTtyZXR1cm4gdGhpc30sdHJhbnNsYXRlOmZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuYXR0cih7dHJhbnNsYXRlWDphLHRyYW5zbGF0ZVk6Yn0pfSxpbnZlcnQ6ZnVuY3Rpb24oKXt0aGlzLmludmVydGVkPSEwO3RoaXMudXBkYXRlVHJhbnNmb3JtKCk7cmV0dXJuIHRoaXN9LHVwZGF0ZVRyYW5zZm9ybTpmdW5jdGlvbigpe3ZhciBhPXRoaXMudHJhbnNsYXRlWHx8MCxiPXRoaXMudHJhbnNsYXRlWXx8MCxjPXRoaXMuc2NhbGVYLFxuZD10aGlzLnNjYWxlWSxlPXRoaXMuaW52ZXJ0ZWQsZj10aGlzLnJvdGF0aW9uLGc9dGhpcy5lbGVtZW50O2UmJihhKz10aGlzLmF0dHIoXCJ3aWR0aFwiKSxiKz10aGlzLmF0dHIoXCJoZWlnaHRcIikpO2E9W1widHJhbnNsYXRlKFwiK2ErXCIsXCIrYitcIilcIl07ZT9hLnB1c2goXCJyb3RhdGUoOTApIHNjYWxlKC0xLDEpXCIpOmYmJmEucHVzaChcInJvdGF0ZShcIitmK1wiIFwiKyhnLmdldEF0dHJpYnV0ZShcInhcIil8fDApK1wiIFwiKyhnLmdldEF0dHJpYnV0ZShcInlcIil8fDApK1wiKVwiKTsocyhjKXx8cyhkKSkmJmEucHVzaChcInNjYWxlKFwiK3EoYywxKStcIiBcIitxKGQsMSkrXCIpXCIpO2EubGVuZ3RoJiZnLnNldEF0dHJpYnV0ZShcInRyYW5zZm9ybVwiLGEuam9pbihcIiBcIikpfSx0b0Zyb250OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5lbGVtZW50O2EucGFyZW50Tm9kZS5hcHBlbmRDaGlsZChhKTtyZXR1cm4gdGhpc30sYWxpZ246ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGUsZixnLGg9e307ZT10aGlzLnJlbmRlcmVyO2Y9ZS5hbGlnbmVkT2JqZWN0cztcbmlmKGEpe2lmKHRoaXMuYWxpZ25PcHRpb25zPWEsdGhpcy5hbGlnbkJ5VHJhbnNsYXRlPWIsIWN8fERhKGMpKXRoaXMuYWxpZ25Ubz1kPWN8fFwicmVuZGVyZXJcIixBYShmLHRoaXMpLGYucHVzaCh0aGlzKSxjPW51bGx9ZWxzZSBhPXRoaXMuYWxpZ25PcHRpb25zLGI9dGhpcy5hbGlnbkJ5VHJhbnNsYXRlLGQ9dGhpcy5hbGlnblRvO2M9cShjLGVbZF0sZSk7ZD1hLmFsaWduO2U9YS52ZXJ0aWNhbEFsaWduO2Y9KGMueHx8MCkrKGEueHx8MCk7Zz0oYy55fHwwKSsoYS55fHwwKTtpZihkPT09XCJyaWdodFwifHxkPT09XCJjZW50ZXJcIilmKz0oYy53aWR0aC0oYS53aWR0aHx8MCkpL3tyaWdodDoxLGNlbnRlcjoyfVtkXTtoW2I/XCJ0cmFuc2xhdGVYXCI6XCJ4XCJdPXkoZik7aWYoZT09PVwiYm90dG9tXCJ8fGU9PT1cIm1pZGRsZVwiKWcrPShjLmhlaWdodC0oYS5oZWlnaHR8fDApKS8oe2JvdHRvbToxLG1pZGRsZToyfVtlXXx8MSk7aFtiP1widHJhbnNsYXRlWVwiOlwieVwiXT15KGcpO3RoaXNbdGhpcy5wbGFjZWQ/XG5cImFuaW1hdGVcIjpcImF0dHJcIl0oaCk7dGhpcy5wbGFjZWQ9ITA7dGhpcy5hbGlnbkF0dHI9aDtyZXR1cm4gdGhpc30sZ2V0QkJveDpmdW5jdGlvbihhLGIpe3ZhciBjLGQ9dGhpcy5yZW5kZXJlcixlLGYsZyxoPXRoaXMuZWxlbWVudCxpPXRoaXMuc3R5bGVzO2U9dGhpcy50ZXh0U3RyO3ZhciBqLGs9aC5zdHlsZSxsLG09ZC5jYWNoZSxvPWQuY2FjaGVLZXlzLHA7Zj1xKGIsdGhpcy5yb3RhdGlvbik7Zz1mKnBhO2UhPT10JiYocD1bXCJcIixmfHwwLGkmJmkuZm9udFNpemUsaC5zdHlsZS53aWR0aF0uam9pbihcIixcIikscD1lPT09XCJcInx8JGIudGVzdChlKT9cIm51bTpcIitlLnRvU3RyaW5nKCkubGVuZ3RoK3A6ZStwKTtwJiYhYSYmKGM9bVtwXSk7aWYoIWMpe2lmKGgubmFtZXNwYWNlVVJJPT09UWF8fGQuZm9yRXhwb3J0KXt0cnl7bD10aGlzLmZha2VUUyYmZnVuY3Rpb24oYSl7bihoLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuaGlnaGNoYXJ0cy10ZXh0LXNoYWRvd1wiKSxmdW5jdGlvbihiKXtiLnN0eWxlLmRpc3BsYXk9XG5hfSl9LFhhJiZrLnRleHRTaGFkb3c/KGo9ay50ZXh0U2hhZG93LGsudGV4dFNoYWRvdz1cIlwiKTpsJiZsKFwibm9uZVwiKSxjPWguZ2V0QkJveD94KHt9LGguZ2V0QkJveCgpKTp7d2lkdGg6aC5vZmZzZXRXaWR0aCxoZWlnaHQ6aC5vZmZzZXRIZWlnaHR9LGo/ay50ZXh0U2hhZG93PWo6bCYmbChcIlwiKX1jYXRjaChyKXt9aWYoIWN8fGMud2lkdGg8MCljPXt3aWR0aDowLGhlaWdodDowfX1lbHNlIGM9dGhpcy5odG1sR2V0QkJveCgpO2lmKGQuaXNTVkcpe2Q9Yy53aWR0aDtlPWMuaGVpZ2h0O2lmKEthJiZpJiZpLmZvbnRTaXplPT09XCIxMXB4XCImJmUudG9QcmVjaXNpb24oMyk9PT1cIjE2LjlcIiljLmhlaWdodD1lPTE0O2lmKGYpYy53aWR0aD1TKGUqa2EoZykpK1MoZCpiYShnKSksYy5oZWlnaHQ9UyhlKmJhKGcpKStTKGQqa2EoZykpfWlmKHApe2Zvcig7by5sZW5ndGg+MjUwOylkZWxldGUgbVtvLnNoaWZ0KCldO21bcF18fG8ucHVzaChwKTttW3BdPWN9fXJldHVybiBjfSxzaG93OmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmF0dHIoe3Zpc2liaWxpdHk6YT9cblwiaW5oZXJpdFwiOlwidmlzaWJsZVwifSl9LGhpZGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hdHRyKHt2aXNpYmlsaXR5OlwiaGlkZGVuXCJ9KX0sZmFkZU91dDpmdW5jdGlvbihhKXt2YXIgYj10aGlzO2IuYW5pbWF0ZSh7b3BhY2l0eTowfSx7ZHVyYXRpb246YXx8MTUwLGNvbXBsZXRlOmZ1bmN0aW9uKCl7Yi5hdHRyKHt5Oi05OTk5fSl9fSl9LGFkZDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLnJlbmRlcmVyLGM9dGhpcy5lbGVtZW50LGQ7aWYoYSl0aGlzLnBhcmVudEdyb3VwPWE7dGhpcy5wYXJlbnRJbnZlcnRlZD1hJiZhLmludmVydGVkO3RoaXMudGV4dFN0ciE9PXZvaWQgMCYmYi5idWlsZFRleHQodGhpcyk7dGhpcy5hZGRlZD0hMDtpZighYXx8YS5oYW5kbGVafHx0aGlzLnpJbmRleClkPXRoaXMuekluZGV4U2V0dGVyKCk7ZHx8KGE/YS5lbGVtZW50OmIuYm94KS5hcHBlbmRDaGlsZChjKTtpZih0aGlzLm9uQWRkKXRoaXMub25BZGQoKTtyZXR1cm4gdGhpc30sc2FmZVJlbW92ZUNoaWxkOmZ1bmN0aW9uKGEpe3ZhciBiPVxuYS5wYXJlbnROb2RlO2ImJmIucmVtb3ZlQ2hpbGQoYSl9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5lbGVtZW50fHx7fSxjPWEuc2hhZG93cyxkPWEucmVuZGVyZXIuaXNTVkcmJmIubm9kZU5hbWU9PT1cIlNQQU5cIiYmYS5wYXJlbnRHcm91cCxlLGY7Yi5vbmNsaWNrPWIub25tb3VzZW91dD1iLm9ubW91c2VvdmVyPWIub25tb3VzZW1vdmU9Yi5wb2ludD1udWxsO1RhKGEpO2lmKGEuY2xpcFBhdGgpYS5jbGlwUGF0aD1hLmNsaXBQYXRoLmRlc3Ryb3koKTtpZihhLnN0b3BzKXtmb3IoZj0wO2Y8YS5zdG9wcy5sZW5ndGg7ZisrKWEuc3RvcHNbZl09YS5zdG9wc1tmXS5kZXN0cm95KCk7YS5zdG9wcz1udWxsfWEuc2FmZVJlbW92ZUNoaWxkKGIpO2ZvcihjJiZuKGMsZnVuY3Rpb24oYil7YS5zYWZlUmVtb3ZlQ2hpbGQoYil9KTtkJiZkLmRpdiYmZC5kaXYuY2hpbGROb2Rlcy5sZW5ndGg9PT0wOyliPWQucGFyZW50R3JvdXAsYS5zYWZlUmVtb3ZlQ2hpbGQoZC5kaXYpLGRlbGV0ZSBkLmRpdixcbmQ9YjthLmFsaWduVG8mJkFhKGEucmVuZGVyZXIuYWxpZ25lZE9iamVjdHMsYSk7Zm9yKGUgaW4gYSlkZWxldGUgYVtlXTtyZXR1cm4gbnVsbH0sc2hhZG93OmZ1bmN0aW9uKGEsYixjKXt2YXIgZD1bXSxlLGYsZz10aGlzLmVsZW1lbnQsaCxpLGosaztpZihhKXtpPXEoYS53aWR0aCwzKTtqPShhLm9wYWNpdHl8fDAuMTUpL2k7az10aGlzLnBhcmVudEludmVydGVkP1wiKC0xLC0xKVwiOlwiKFwiK3EoYS5vZmZzZXRYLDEpK1wiLCBcIitxKGEub2Zmc2V0WSwxKStcIilcIjtmb3IoZT0xO2U8PWk7ZSsrKXtmPWcuY2xvbmVOb2RlKDApO2g9aSoyKzEtMiplO1goZix7aXNTaGFkb3c6XCJ0cnVlXCIsc3Ryb2tlOmEuY29sb3J8fFwiYmxhY2tcIixcInN0cm9rZS1vcGFjaXR5XCI6aiplLFwic3Ryb2tlLXdpZHRoXCI6aCx0cmFuc2Zvcm06XCJ0cmFuc2xhdGVcIitrLGZpbGw6XCJub25lXCJ9KTtpZihjKVgoZixcImhlaWdodFwiLHYoWChmLFwiaGVpZ2h0XCIpLWgsMCkpLGYuY3V0SGVpZ2h0PWg7Yj9iLmVsZW1lbnQuYXBwZW5kQ2hpbGQoZik6XG5nLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGYsZyk7ZC5wdXNoKGYpfXRoaXMuc2hhZG93cz1kfXJldHVybiB0aGlzfSx4R2V0dGVyOmZ1bmN0aW9uKGEpe3RoaXMuZWxlbWVudC5ub2RlTmFtZT09PVwiY2lyY2xlXCImJihhPXt4OlwiY3hcIix5OlwiY3lcIn1bYV18fGEpO3JldHVybiB0aGlzLl9kZWZhdWx0R2V0dGVyKGEpfSxfZGVmYXVsdEdldHRlcjpmdW5jdGlvbihhKXthPXEodGhpc1thXSx0aGlzLmVsZW1lbnQ/dGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZShhKTpudWxsLDApOy9eW1xcLTAtOVxcLl0rJC8udGVzdChhKSYmKGE9cGFyc2VGbG9hdChhKSk7cmV0dXJuIGF9LGRTZXR0ZXI6ZnVuY3Rpb24oYSxiLGMpe2EmJmEuam9pbiYmKGE9YS5qb2luKFwiIFwiKSk7LyhOYU58IHsyfXxeJCkvLnRlc3QoYSkmJihhPVwiTSAwIDBcIik7Yy5zZXRBdHRyaWJ1dGUoYixhKTt0aGlzW2JdPWF9LGRhc2hzdHlsZVNldHRlcjpmdW5jdGlvbihhKXt2YXIgYixjPXRoaXNbXCJzdHJva2Utd2lkdGhcIl07Yz09PVxuXCJpbmhlcml0XCImJihjPTEpO2lmKGE9YSYmYS50b0xvd2VyQ2FzZSgpKXthPWEucmVwbGFjZShcInNob3J0ZGFzaGRvdGRvdFwiLFwiMywxLDEsMSwxLDEsXCIpLnJlcGxhY2UoXCJzaG9ydGRhc2hkb3RcIixcIjMsMSwxLDFcIikucmVwbGFjZShcInNob3J0ZG90XCIsXCIxLDEsXCIpLnJlcGxhY2UoXCJzaG9ydGRhc2hcIixcIjMsMSxcIikucmVwbGFjZShcImxvbmdkYXNoXCIsXCI4LDMsXCIpLnJlcGxhY2UoL2RvdC9nLFwiMSwzLFwiKS5yZXBsYWNlKFwiZGFzaFwiLFwiNCwzLFwiKS5yZXBsYWNlKC8sJC8sXCJcIikuc3BsaXQoXCIsXCIpO2ZvcihiPWEubGVuZ3RoO2ItLTspYVtiXT1HKGFbYl0pKmM7YT1hLmpvaW4oXCIsXCIpLnJlcGxhY2UoL05hTi9nLFwibm9uZVwiKTt0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKFwic3Ryb2tlLWRhc2hhcnJheVwiLGEpfX0sYWxpZ25TZXR0ZXI6ZnVuY3Rpb24oYSl7dGhpcy5lbGVtZW50LnNldEF0dHJpYnV0ZShcInRleHQtYW5jaG9yXCIse2xlZnQ6XCJzdGFydFwiLGNlbnRlcjpcIm1pZGRsZVwiLHJpZ2h0OlwiZW5kXCJ9W2FdKX0sXG5vcGFjaXR5U2V0dGVyOmZ1bmN0aW9uKGEsYixjKXt0aGlzW2JdPWE7Yy5zZXRBdHRyaWJ1dGUoYixhKX0sdGl0bGVTZXR0ZXI6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5lbGVtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwidGl0bGVcIilbMF07Ynx8KGI9Qi5jcmVhdGVFbGVtZW50TlMoUWEsXCJ0aXRsZVwiKSx0aGlzLmVsZW1lbnQuYXBwZW5kQ2hpbGQoYikpO2IuYXBwZW5kQ2hpbGQoQi5jcmVhdGVUZXh0Tm9kZShTdHJpbmcocShhKSxcIlwiKS5yZXBsYWNlKC88W14+XSo+L2csXCJcIikpKX0sdGV4dFNldHRlcjpmdW5jdGlvbihhKXtpZihhIT09dGhpcy50ZXh0U3RyKWRlbGV0ZSB0aGlzLmJCb3gsdGhpcy50ZXh0U3RyPWEsdGhpcy5hZGRlZCYmdGhpcy5yZW5kZXJlci5idWlsZFRleHQodGhpcyl9LGZpbGxTZXR0ZXI6ZnVuY3Rpb24oYSxiLGMpe3R5cGVvZiBhPT09XCJzdHJpbmdcIj9jLnNldEF0dHJpYnV0ZShiLGEpOmEmJnRoaXMuY29sb3JHcmFkaWVudChhLGIsYyl9LHZpc2liaWxpdHlTZXR0ZXI6ZnVuY3Rpb24oYSxcbmIsYyl7YT09PVwiaW5oZXJpdFwiP2MucmVtb3ZlQXR0cmlidXRlKGIpOmMuc2V0QXR0cmlidXRlKGIsYSl9LHpJbmRleFNldHRlcjpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMucmVuZGVyZXIsZD10aGlzLnBhcmVudEdyb3VwLGM9KGR8fGMpLmVsZW1lbnR8fGMuYm94LGUsZixnPXRoaXMuZWxlbWVudCxoO2U9dGhpcy5hZGRlZDt2YXIgaTtpZihzKGEpKWcuekluZGV4PWEsYT0rYSx0aGlzW2JdPT09YSYmKGU9ITEpLHRoaXNbYl09YTtpZihlKXtpZigoYT10aGlzLnpJbmRleCkmJmQpZC5oYW5kbGVaPSEwO2Q9Yy5jaGlsZE5vZGVzO2ZvcihpPTA7aTxkLmxlbmd0aCYmIWg7aSsrKWlmKGU9ZFtpXSxmPWUuekluZGV4LGUhPT1nJiYoRyhmKT5hfHwhcyhhKSYmcyhmKSkpYy5pbnNlcnRCZWZvcmUoZyxlKSxoPSEwO2h8fGMuYXBwZW5kQ2hpbGQoZyl9cmV0dXJuIGh9LF9kZWZhdWx0U2V0dGVyOmZ1bmN0aW9uKGEsYixjKXtjLnNldEF0dHJpYnV0ZShiLGEpfX07Wi5wcm90b3R5cGUueUdldHRlcj1cbloucHJvdG90eXBlLnhHZXR0ZXI7Wi5wcm90b3R5cGUudHJhbnNsYXRlWFNldHRlcj1aLnByb3RvdHlwZS50cmFuc2xhdGVZU2V0dGVyPVoucHJvdG90eXBlLnJvdGF0aW9uU2V0dGVyPVoucHJvdG90eXBlLnZlcnRpY2FsQWxpZ25TZXR0ZXI9Wi5wcm90b3R5cGUuc2NhbGVYU2V0dGVyPVoucHJvdG90eXBlLnNjYWxlWVNldHRlcj1mdW5jdGlvbihhLGIpe3RoaXNbYl09YTt0aGlzLmRvVHJhbnNmb3JtPSEwfTtaLnByb3RvdHlwZVtcInN0cm9rZS13aWR0aFNldHRlclwiXT1aLnByb3RvdHlwZS5zdHJva2VTZXR0ZXI9ZnVuY3Rpb24oYSxiLGMpe3RoaXNbYl09YTtpZih0aGlzLnN0cm9rZSYmdGhpc1tcInN0cm9rZS13aWR0aFwiXSl0aGlzLnN0cm9rZVdpZHRoPXRoaXNbXCJzdHJva2Utd2lkdGhcIl0sWi5wcm90b3R5cGUuZmlsbFNldHRlci5jYWxsKHRoaXMsdGhpcy5zdHJva2UsXCJzdHJva2VcIixjKSxjLnNldEF0dHJpYnV0ZShcInN0cm9rZS13aWR0aFwiLHRoaXNbXCJzdHJva2Utd2lkdGhcIl0pLFxudGhpcy5oYXNTdHJva2U9ITA7ZWxzZSBpZihiPT09XCJzdHJva2Utd2lkdGhcIiYmYT09PTAmJnRoaXMuaGFzU3Ryb2tlKWMucmVtb3ZlQXR0cmlidXRlKFwic3Ryb2tlXCIpLHRoaXMuaGFzU3Ryb2tlPSExfTt2YXIgeWE9ZnVuY3Rpb24oKXt0aGlzLmluaXQuYXBwbHkodGhpcyxhcmd1bWVudHMpfTt5YS5wcm90b3R5cGU9e0VsZW1lbnQ6Wixpbml0OmZ1bmN0aW9uKGEsYixjLGQsZSxmKXt2YXIgZyxkPXRoaXMuY3JlYXRlRWxlbWVudChcInN2Z1wiKS5hdHRyKHt2ZXJzaW9uOlwiMS4xXCJ9KS5jc3ModGhpcy5nZXRTdHlsZShkKSk7Zz1kLmVsZW1lbnQ7YS5hcHBlbmRDaGlsZChnKTthLmlubmVySFRNTC5pbmRleE9mKFwieG1sbnNcIik9PT0tMSYmWChnLFwieG1sbnNcIixRYSk7dGhpcy5pc1NWRz0hMDt0aGlzLmJveD1nO3RoaXMuYm94V3JhcHBlcj1kO3RoaXMuYWxpZ25lZE9iamVjdHM9W107dGhpcy51cmw9KFhhfHx0YikmJkIuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJiYXNlXCIpLmxlbmd0aD9KLmxvY2F0aW9uLmhyZWYucmVwbGFjZSgvIy4qPyQvLFxuXCJcIikucmVwbGFjZSgvKFtcXCgnXFwpXSkvZyxcIlxcXFwkMVwiKS5yZXBsYWNlKC8gL2csXCIlMjBcIik6XCJcIjt0aGlzLmNyZWF0ZUVsZW1lbnQoXCJkZXNjXCIpLmFkZCgpLmVsZW1lbnQuYXBwZW5kQ2hpbGQoQi5jcmVhdGVUZXh0Tm9kZShcIkNyZWF0ZWQgd2l0aCBIaWdoc3RvY2sgNC4yLjRcIikpO3RoaXMuZGVmcz10aGlzLmNyZWF0ZUVsZW1lbnQoXCJkZWZzXCIpLmFkZCgpO3RoaXMuYWxsb3dIVE1MPWY7dGhpcy5mb3JFeHBvcnQ9ZTt0aGlzLmdyYWRpZW50cz17fTt0aGlzLmNhY2hlPXt9O3RoaXMuY2FjaGVLZXlzPVtdO3RoaXMuaW1nQ291bnQ9MDt0aGlzLnNldFNpemUoYixjLCExKTt2YXIgaDtpZihYYSYmYS5nZXRCb3VuZGluZ0NsaWVudFJlY3QpdGhpcy5zdWJQaXhlbEZpeD1iPWZ1bmN0aW9uKCl7RihhLHtsZWZ0OjAsdG9wOjB9KTtoPWEuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7RihhLHtsZWZ0OkZhKGgubGVmdCktaC5sZWZ0K1wicHhcIix0b3A6RmEoaC50b3ApLWgudG9wK1wicHhcIn0pfSxiKCksXG5EKEosXCJyZXNpemVcIixiKX0sZ2V0U3R5bGU6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuc3R5bGU9eCh7Zm9udEZhbWlseTonXCJMdWNpZGEgR3JhbmRlXCIsIFwiTHVjaWRhIFNhbnMgVW5pY29kZVwiLCBBcmlhbCwgSGVsdmV0aWNhLCBzYW5zLXNlcmlmJyxmb250U2l6ZTpcIjEycHhcIn0sYSl9LGlzSGlkZGVuOmZ1bmN0aW9uKCl7cmV0dXJuIXRoaXMuYm94V3JhcHBlci5nZXRCQm94KCkud2lkdGh9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmRlZnM7dGhpcy5ib3g9bnVsbDt0aGlzLmJveFdyYXBwZXI9dGhpcy5ib3hXcmFwcGVyLmRlc3Ryb3koKTtQYSh0aGlzLmdyYWRpZW50c3x8e30pO3RoaXMuZ3JhZGllbnRzPW51bGw7aWYoYSl0aGlzLmRlZnM9YS5kZXN0cm95KCk7dGhpcy5zdWJQaXhlbEZpeCYmVChKLFwicmVzaXplXCIsdGhpcy5zdWJQaXhlbEZpeCk7cmV0dXJuIHRoaXMuYWxpZ25lZE9iamVjdHM9bnVsbH0sY3JlYXRlRWxlbWVudDpmdW5jdGlvbihhKXt2YXIgYj1uZXcgdGhpcy5FbGVtZW50O1xuYi5pbml0KHRoaXMsYSk7cmV0dXJuIGJ9LGRyYXc6ZnVuY3Rpb24oKXt9LGdldFJhZGlhbEF0dHI6ZnVuY3Rpb24oYSxiKXtyZXR1cm57Y3g6YVswXS1hWzJdLzIrYi5jeCphWzJdLGN5OmFbMV0tYVsyXS8yK2IuY3kqYVsyXSxyOmIuciphWzJdfX0sYnVpbGRUZXh0OmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1hLmVsZW1lbnQsYz10aGlzLGQ9Yy5mb3JFeHBvcnQsZT1xKGEudGV4dFN0cixcIlwiKS50b1N0cmluZygpLGY9ZS5pbmRleE9mKFwiPFwiKSE9PS0xLGc9Yi5jaGlsZE5vZGVzLGgsaSxqPVgoYixcInhcIiksaz1hLnN0eWxlcyxsPWEudGV4dFdpZHRoLG09ayYmay5saW5lSGVpZ2h0LG89ayYmay50ZXh0U2hhZG93LHA9ayYmay50ZXh0T3ZlcmZsb3c9PT1cImVsbGlwc2lzXCIscj1nLmxlbmd0aCxBPWwmJiFhLmFkZGVkJiZ0aGlzLmJveCxQPWZ1bmN0aW9uKGEpe3JldHVybiBtP0cobSk6Yy5mb250TWV0cmljcygvKHB4fGVtKSQvLnRlc3QoYSYmYS5zdHlsZS5mb250U2l6ZSk/YS5zdHlsZS5mb250U2l6ZTpcbmsmJmsuZm9udFNpemV8fGMuc3R5bGUuZm9udFNpemV8fDEyLGEpLmh9LHU9ZnVuY3Rpb24oYSl7cmV0dXJuIGEucmVwbGFjZSgvJmx0Oy9nLFwiPFwiKS5yZXBsYWNlKC8mZ3Q7L2csXCI+XCIpfTtyLS07KWIucmVtb3ZlQ2hpbGQoZ1tyXSk7IWYmJiFvJiYhcCYmZS5pbmRleE9mKFwiIFwiKT09PS0xP2IuYXBwZW5kQ2hpbGQoQi5jcmVhdGVUZXh0Tm9kZSh1KGUpKSk6KGg9LzwuKnN0eWxlPVwiKFteXCJdKylcIi4qPi8saT0vPC4qaHJlZj1cIihodHRwW15cIl0rKVwiLio+LyxBJiZBLmFwcGVuZENoaWxkKGIpLGU9Zj9lLnJlcGxhY2UoLzwoYnxzdHJvbmcpPi9nLCc8c3BhbiBzdHlsZT1cImZvbnQtd2VpZ2h0OmJvbGRcIj4nKS5yZXBsYWNlKC88KGl8ZW0pPi9nLCc8c3BhbiBzdHlsZT1cImZvbnQtc3R5bGU6aXRhbGljXCI+JykucmVwbGFjZSgvPGEvZyxcIjxzcGFuXCIpLnJlcGxhY2UoLzxcXC8oYnxzdHJvbmd8aXxlbXxhKT4vZyxcIjwvc3Bhbj5cIikuc3BsaXQoLzxici4qPz4vZyk6W2VdLGVbZS5sZW5ndGgtMV09PT1cblwiXCImJmUucG9wKCksbihlLGZ1bmN0aW9uKGUsZil7dmFyIGcsbT0wLGU9ZS5yZXBsYWNlKC88c3Bhbi9nLFwifHx8PHNwYW5cIikucmVwbGFjZSgvPFxcL3NwYW4+L2csXCI8L3NwYW4+fHx8XCIpO2c9ZS5zcGxpdChcInx8fFwiKTtuKGcsZnVuY3Rpb24oZSl7aWYoZSE9PVwiXCJ8fGcubGVuZ3RoPT09MSl7dmFyIG89e30scj1CLmNyZWF0ZUVsZW1lbnROUyhRYSxcInRzcGFuXCIpLEE7aC50ZXN0KGUpJiYoQT1lLm1hdGNoKGgpWzFdLnJlcGxhY2UoLyg7fCB8Xiljb2xvcihbIDpdKS8sXCIkMWZpbGwkMlwiKSxYKHIsXCJzdHlsZVwiLEEpKTtpLnRlc3QoZSkmJiFkJiYoWChyLFwib25jbGlja1wiLCdsb2NhdGlvbi5ocmVmPVwiJytlLm1hdGNoKGkpWzFdKydcIicpLEYocix7Y3Vyc29yOlwicG9pbnRlclwifSkpO2U9dShlLnJlcGxhY2UoLzwoLnxcXG4pKj8+L2csXCJcIil8fFwiIFwiKTtpZihlIT09XCIgXCIpe3IuYXBwZW5kQ2hpbGQoQi5jcmVhdGVUZXh0Tm9kZShlKSk7aWYobSlvLmR4PTA7ZWxzZSBpZihmJiZqIT09bnVsbClvLng9XG5qO1gocixvKTtiLmFwcGVuZENoaWxkKHIpOyFtJiZmJiYoIWphJiZkJiZGKHIse2Rpc3BsYXk6XCJibG9ja1wifSksWChyLFwiZHlcIixQKHIpKSk7aWYobCl7Zm9yKHZhciBvPWUucmVwbGFjZSgvKFteXFxeXSktL2csXCIkMS0gXCIpLnNwbGl0KFwiIFwiKSxxPWcubGVuZ3RoPjF8fGZ8fG8ubGVuZ3RoPjEmJmsud2hpdGVTcGFjZSE9PVwibm93cmFwXCIsdyxuLHMsdD1bXSx2PVAocikseT0xLHg9YS5yb3RhdGlvbixDPWUsej1DLmxlbmd0aDsocXx8cCkmJihvLmxlbmd0aHx8dC5sZW5ndGgpOylhLnJvdGF0aW9uPTAsdz1hLmdldEJCb3goITApLHM9dy53aWR0aCwhamEmJmMuZm9yRXhwb3J0JiYocz1jLm1lYXN1cmVTcGFuV2lkdGgoci5maXJzdENoaWxkLmRhdGEsYS5zdHlsZXMpKSx3PXM+bCxuPT09dm9pZCAwJiYobj13KSxwJiZuPyh6Lz0yLEM9PT1cIlwifHwhdyYmejwwLjU/bz1bXToodyYmKG49ITApLEM9ZS5zdWJzdHJpbmcoMCxDLmxlbmd0aCsodz8tMToxKSpGYSh6KSksbz1bQysobD4zP1wiXFx1MjAyNlwiOlxuXCJcIildLHIucmVtb3ZlQ2hpbGQoci5maXJzdENoaWxkKSkpOiF3fHxvLmxlbmd0aD09PTE/KG89dCx0PVtdLG8ubGVuZ3RoJiYoeSsrLHI9Qi5jcmVhdGVFbGVtZW50TlMoUWEsXCJ0c3BhblwiKSxYKHIse2R5OnYseDpqfSksQSYmWChyLFwic3R5bGVcIixBKSxiLmFwcGVuZENoaWxkKHIpKSxzPmwmJihsPXMpKTooci5yZW1vdmVDaGlsZChyLmZpcnN0Q2hpbGQpLHQudW5zaGlmdChvLnBvcCgpKSksby5sZW5ndGgmJnIuYXBwZW5kQ2hpbGQoQi5jcmVhdGVUZXh0Tm9kZShvLmpvaW4oXCIgXCIpLnJlcGxhY2UoLy0gL2csXCItXCIpKSk7biYmYS5hdHRyKFwidGl0bGVcIixhLnRleHRTdHIpO2Eucm90YXRpb249eH1tKyt9fX0pfSksQSYmQS5yZW1vdmVDaGlsZChiKSxvJiZhLmFwcGx5VGV4dFNoYWRvdyYmYS5hcHBseVRleHRTaGFkb3cobykpfSxnZXRDb250cmFzdDpmdW5jdGlvbihhKXthPXdhKGEpLnJnYmE7cmV0dXJuIGFbMF0rYVsxXSthWzJdPjM4ND9cIiMwMDAwMDBcIjpcIiNGRkZGRkZcIn0sYnV0dG9uOmZ1bmN0aW9uKGEsXG5iLGMsZCxlLGYsZyxoLGkpe3ZhciBqPXRoaXMubGFiZWwoYSxiLGMsaSxudWxsLG51bGwsbnVsbCxudWxsLFwiYnV0dG9uXCIpLGs9MCxsLG0sbyxwLHIsQSxhPXt4MTowLHkxOjAseDI6MCx5MjoxfSxlPUMoe1wic3Ryb2tlLXdpZHRoXCI6MSxzdHJva2U6XCIjQ0NDQ0NDXCIsZmlsbDp7bGluZWFyR3JhZGllbnQ6YSxzdG9wczpbWzAsXCIjRkVGRUZFXCJdLFsxLFwiI0Y2RjZGNlwiXV19LHI6MixwYWRkaW5nOjUsc3R5bGU6e2NvbG9yOlwiYmxhY2tcIn19LGUpO289ZS5zdHlsZTtkZWxldGUgZS5zdHlsZTtmPUMoZSx7c3Ryb2tlOlwiIzY4QVwiLGZpbGw6e2xpbmVhckdyYWRpZW50OmEsc3RvcHM6W1swLFwiI0ZGRlwiXSxbMSxcIiNBQ0ZcIl1dfX0sZik7cD1mLnN0eWxlO2RlbGV0ZSBmLnN0eWxlO2c9QyhlLHtzdHJva2U6XCIjNjhBXCIsZmlsbDp7bGluZWFyR3JhZGllbnQ6YSxzdG9wczpbWzAsXCIjOUJEXCJdLFsxLFwiI0NERlwiXV19fSxnKTtyPWcuc3R5bGU7ZGVsZXRlIGcuc3R5bGU7aD1DKGUse3N0eWxlOntjb2xvcjpcIiNDQ0NcIn19LFxuaCk7QT1oLnN0eWxlO2RlbGV0ZSBoLnN0eWxlO0Qoai5lbGVtZW50LEthP1wibW91c2VvdmVyXCI6XCJtb3VzZWVudGVyXCIsZnVuY3Rpb24oKXtrIT09MyYmai5hdHRyKGYpLmNzcyhwKX0pO0Qoai5lbGVtZW50LEthP1wibW91c2VvdXRcIjpcIm1vdXNlbGVhdmVcIixmdW5jdGlvbigpe2shPT0zJiYobD1bZSxmLGddW2tdLG09W28scCxyXVtrXSxqLmF0dHIobCkuY3NzKG0pKX0pO2ouc2V0U3RhdGU9ZnVuY3Rpb24oYSl7KGouc3RhdGU9az1hKT9hPT09Mj9qLmF0dHIoZykuY3NzKHIpOmE9PT0zJiZqLmF0dHIoaCkuY3NzKEEpOmouYXR0cihlKS5jc3Mobyl9O3JldHVybiBqLm9uKFwiY2xpY2tcIixmdW5jdGlvbihhKXtrIT09MyYmZC5jYWxsKGosYSl9KS5hdHRyKGUpLmNzcyh4KHtjdXJzb3I6XCJkZWZhdWx0XCJ9LG8pKX0sY3Jpc3BMaW5lOmZ1bmN0aW9uKGEsYil7YVsxXT09PWFbNF0mJihhWzFdPWFbNF09eShhWzFdKS1iJTIvMik7YVsyXT09PWFbNV0mJihhWzJdPWFbNV09eShhWzJdKStiJTIvXG4yKTtyZXR1cm4gYX0scGF0aDpmdW5jdGlvbihhKXt2YXIgYj17ZmlsbDpcIm5vbmVcIn07SmEoYSk/Yi5kPWE6ZGEoYSkmJngoYixhKTtyZXR1cm4gdGhpcy5jcmVhdGVFbGVtZW50KFwicGF0aFwiKS5hdHRyKGIpfSxjaXJjbGU6ZnVuY3Rpb24oYSxiLGMpe2E9ZGEoYSk/YTp7eDphLHk6YixyOmN9O2I9dGhpcy5jcmVhdGVFbGVtZW50KFwiY2lyY2xlXCIpO2IueFNldHRlcj1iLnlTZXR0ZXI9ZnVuY3Rpb24oYSxiLGMpe2Muc2V0QXR0cmlidXRlKFwiY1wiK2IsYSl9O3JldHVybiBiLmF0dHIoYSl9LGFyYzpmdW5jdGlvbihhLGIsYyxkLGUsZil7aWYoZGEoYSkpYj1hLnksYz1hLnIsZD1hLmlubmVyUixlPWEuc3RhcnQsZj1hLmVuZCxhPWEueDthPXRoaXMuc3ltYm9sKFwiYXJjXCIsYXx8MCxifHwwLGN8fDAsY3x8MCx7aW5uZXJSOmR8fDAsc3RhcnQ6ZXx8MCxlbmQ6Znx8MH0pO2Eucj1jO3JldHVybiBhfSxyZWN0OmZ1bmN0aW9uKGEsYixjLGQsZSxmKXt2YXIgZT1kYShhKT9hLnI6ZSxnPXRoaXMuY3JlYXRlRWxlbWVudChcInJlY3RcIiksXG5hPWRhKGEpP2E6YT09PXQ/e306e3g6YSx5OmIsd2lkdGg6dihjLDApLGhlaWdodDp2KGQsMCl9O2lmKGYhPT10KWcuc3Ryb2tlV2lkdGg9ZixhPWcuY3Jpc3AoYSk7aWYoZSlhLnI9ZTtnLnJTZXR0ZXI9ZnVuY3Rpb24oYSxiLGMpe1goYyx7cng6YSxyeTphfSl9O3JldHVybiBnLmF0dHIoYSl9LHNldFNpemU6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXRoaXMuYWxpZ25lZE9iamVjdHMsZT1kLmxlbmd0aDt0aGlzLndpZHRoPWE7dGhpcy5oZWlnaHQ9Yjtmb3IodGhpcy5ib3hXcmFwcGVyW3EoYywhMCk/XCJhbmltYXRlXCI6XCJhdHRyXCJdKHt3aWR0aDphLGhlaWdodDpifSk7ZS0tOylkW2VdLmFsaWduKCl9LGc6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50KFwiZ1wiKTtyZXR1cm4gcyhhKT9iLmF0dHIoe1wiY2xhc3NcIjpcImhpZ2hjaGFydHMtXCIrYX0pOmJ9LGltYWdlOmZ1bmN0aW9uKGEsYixjLGQsZSl7dmFyIGY9e3ByZXNlcnZlQXNwZWN0UmF0aW86XCJub25lXCJ9O2FyZ3VtZW50cy5sZW5ndGg+XG4xJiZ4KGYse3g6Yix5OmMsd2lkdGg6ZCxoZWlnaHQ6ZX0pO2Y9dGhpcy5jcmVhdGVFbGVtZW50KFwiaW1hZ2VcIikuYXR0cihmKTtmLmVsZW1lbnQuc2V0QXR0cmlidXRlTlM/Zi5lbGVtZW50LnNldEF0dHJpYnV0ZU5TKFwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGlua1wiLFwiaHJlZlwiLGEpOmYuZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJoYy1zdmctaHJlZlwiLGEpO3JldHVybiBmfSxzeW1ib2w6ZnVuY3Rpb24oYSxiLGMsZCxlLGYpe3ZhciBnPXRoaXMsaCxpPXRoaXMuc3ltYm9sc1thXSxpPWkmJmkoeShiKSx5KGMpLGQsZSxmKSxqPS9edXJsXFwoKC4qPylcXCkkLyxrLGw7aWYoaSloPXRoaXMucGF0aChpKSx4KGgse3N5bWJvbE5hbWU6YSx4OmIseTpjLHdpZHRoOmQsaGVpZ2h0OmV9KSxmJiZ4KGgsZik7ZWxzZSBpZihqLnRlc3QoYSkpbD1mdW5jdGlvbihhLGIpe2EuZWxlbWVudCYmKGEuYXR0cih7d2lkdGg6YlswXSxoZWlnaHQ6YlsxXX0pLGEuYWxpZ25CeVRyYW5zbGF0ZXx8YS50cmFuc2xhdGUoeSgoZC1cbmJbMF0pLzIpLHkoKGUtYlsxXSkvMikpKX0saz1hLm1hdGNoKGopWzFdLGE9VmJba118fGYmJmYud2lkdGgmJmYuaGVpZ2h0JiZbZi53aWR0aCxmLmhlaWdodF0saD10aGlzLmltYWdlKGspLmF0dHIoe3g6Yix5OmN9KSxoLmlzSW1nPSEwLGE/bChoLGEpOihoLmF0dHIoe3dpZHRoOjAsaGVpZ2h0OjB9KSxlYShcImltZ1wiLHtvbmxvYWQ6ZnVuY3Rpb24oKXt0aGlzLndpZHRoPT09MCYmKEYodGhpcyx7cG9zaXRpb246XCJhYnNvbHV0ZVwiLHRvcDpcIi05OTllbVwifSksQi5ib2R5LmFwcGVuZENoaWxkKHRoaXMpKTtsKGgsVmJba109W3RoaXMud2lkdGgsdGhpcy5oZWlnaHRdKTt0aGlzLnBhcmVudE5vZGUmJnRoaXMucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzKTtnLmltZ0NvdW50LS07aWYoIWcuaW1nQ291bnQmJiRbZy5jaGFydEluZGV4XS5vbmxvYWQpJFtnLmNoYXJ0SW5kZXhdLm9ubG9hZCgpfSxzcmM6a30pLHRoaXMuaW1nQ291bnQrKyk7cmV0dXJuIGh9LHN5bWJvbHM6e2NpcmNsZTpmdW5jdGlvbihhLFxuYixjLGQpe3ZhciBlPTAuMTY2KmM7cmV0dXJuW1wiTVwiLGErYy8yLGIsXCJDXCIsYStjK2UsYixhK2MrZSxiK2QsYStjLzIsYitkLFwiQ1wiLGEtZSxiK2QsYS1lLGIsYStjLzIsYixcIlpcIl19LHNxdWFyZTpmdW5jdGlvbihhLGIsYyxkKXtyZXR1cm5bXCJNXCIsYSxiLFwiTFwiLGErYyxiLGErYyxiK2QsYSxiK2QsXCJaXCJdfSx0cmlhbmdsZTpmdW5jdGlvbihhLGIsYyxkKXtyZXR1cm5bXCJNXCIsYStjLzIsYixcIkxcIixhK2MsYitkLGEsYitkLFwiWlwiXX0sXCJ0cmlhbmdsZS1kb3duXCI6ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuW1wiTVwiLGEsYixcIkxcIixhK2MsYixhK2MvMixiK2QsXCJaXCJdfSxkaWFtb25kOmZ1bmN0aW9uKGEsYixjLGQpe3JldHVybltcIk1cIixhK2MvMixiLFwiTFwiLGErYyxiK2QvMixhK2MvMixiK2QsYSxiK2QvMixcIlpcIl19LGFyYzpmdW5jdGlvbihhLGIsYyxkLGUpe3ZhciBmPWUuc3RhcnQsYz1lLnJ8fGN8fGQsZz1lLmVuZC0wLjAwMSxkPWUuaW5uZXJSLGg9ZS5vcGVuLGk9YmEoZiksaj1rYShmKSxcbms9YmEoZyksZz1rYShnKSxlPWUuZW5kLWY8QmE/MDoxO3JldHVybltcIk1cIixhK2MqaSxiK2MqaixcIkFcIixjLGMsMCxlLDEsYStjKmssYitjKmcsaD9cIk1cIjpcIkxcIixhK2QqayxiK2QqZyxcIkFcIixkLGQsMCxlLDAsYStkKmksYitkKmosaD9cIlwiOlwiWlwiXX0sY2FsbG91dDpmdW5jdGlvbihhLGIsYyxkLGUpe3ZhciBmPUUoZSYmZS5yfHwwLGMsZCksZz1mKzYsaD1lJiZlLmFuY2hvclgsZT1lJiZlLmFuY2hvclksaTtpPVtcIk1cIixhK2YsYixcIkxcIixhK2MtZixiLFwiQ1wiLGErYyxiLGErYyxiLGErYyxiK2YsXCJMXCIsYStjLGIrZC1mLFwiQ1wiLGErYyxiK2QsYStjLGIrZCxhK2MtZixiK2QsXCJMXCIsYStmLGIrZCxcIkNcIixhLGIrZCxhLGIrZCxhLGIrZC1mLFwiTFwiLGEsYitmLFwiQ1wiLGEsYixhLGIsYStmLGJdO2gmJmg+YyYmZT5iK2cmJmU8YitkLWc/aS5zcGxpY2UoMTMsMyxcIkxcIixhK2MsZS02LGErYys2LGUsYStjLGUrNixhK2MsYitkLWYpOmgmJmg8MCYmZT5iK2cmJmU8YitkLWc/aS5zcGxpY2UoMzMsMyxcblwiTFwiLGEsZSs2LGEtNixlLGEsZS02LGEsYitmKTplJiZlPmQmJmg+YStnJiZoPGErYy1nP2kuc3BsaWNlKDIzLDMsXCJMXCIsaCs2LGIrZCxoLGIrZCs2LGgtNixiK2QsYStmLGIrZCk6ZSYmZTwwJiZoPmErZyYmaDxhK2MtZyYmaS5zcGxpY2UoMywzLFwiTFwiLGgtNixiLGgsYi02LGgrNixiLGMtZixiKTtyZXR1cm4gaX19LGNsaXBSZWN0OmZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPVwiaGlnaGNoYXJ0cy1cIitKYisrLGY9dGhpcy5jcmVhdGVFbGVtZW50KFwiY2xpcFBhdGhcIikuYXR0cih7aWQ6ZX0pLmFkZCh0aGlzLmRlZnMpLGE9dGhpcy5yZWN0KGEsYixjLGQsMCkuYWRkKGYpO2EuaWQ9ZTthLmNsaXBQYXRoPWY7YS5jb3VudD0wO3JldHVybiBhfSx0ZXh0OmZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPXFhfHwhamEmJnRoaXMuZm9yRXhwb3J0LGY9e307aWYoZCYmKHRoaXMuYWxsb3dIVE1MfHwhdGhpcy5mb3JFeHBvcnQpKXJldHVybiB0aGlzLmh0bWwoYSxiLGMpO2YueD1NYXRoLnJvdW5kKGJ8fFxuMCk7aWYoYylmLnk9TWF0aC5yb3VuZChjKTtpZihhfHxhPT09MClmLnRleHQ9YTthPXRoaXMuY3JlYXRlRWxlbWVudChcInRleHRcIikuYXR0cihmKTtlJiZhLmNzcyh7cG9zaXRpb246XCJhYnNvbHV0ZVwifSk7aWYoIWQpYS54U2V0dGVyPWZ1bmN0aW9uKGEsYixjKXt2YXIgZD1jLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwidHNwYW5cIiksZSxmPWMuZ2V0QXR0cmlidXRlKGIpLG07Zm9yKG09MDttPGQubGVuZ3RoO20rKyllPWRbbV0sZS5nZXRBdHRyaWJ1dGUoYik9PT1mJiZlLnNldEF0dHJpYnV0ZShiLGEpO2Muc2V0QXR0cmlidXRlKGIsYSl9O3JldHVybiBhfSxmb250TWV0cmljczpmdW5jdGlvbihhLGIpe3ZhciBjLGQsYT1hfHx0aGlzLnN0eWxlLmZvbnRTaXplOyFhJiZiJiZKLmdldENvbXB1dGVkU3R5bGUmJihiPWIuZWxlbWVudHx8YixhPShjPUouZ2V0Q29tcHV0ZWRTdHlsZShiLFwiXCIpKSYmYy5mb250U2l6ZSk7YT0vcHgvLnRlc3QoYSk/RyhhKTovZW0vLnRlc3QoYSk/cGFyc2VGbG9hdChhKSpcbjEyOjEyO2M9YTwyND9hKzM6eShhKjEuMik7ZD15KGMqMC44KTtyZXR1cm57aDpjLGI6ZCxmOmF9fSxyb3RDb3JyOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD1hO2ImJmMmJihkPXYoZCpiYShiKnBhKSw0KSk7cmV0dXJue3g6LWEvMyprYShiKnBhKSx5OmR9fSxsYWJlbDpmdW5jdGlvbihhLGIsYyxkLGUsZixnLGgsaSl7dmFyIGo9dGhpcyxrPWouZyhpKSxsPWoudGV4dChcIlwiLDAsMCxnKS5hdHRyKHt6SW5kZXg6MX0pLG0sbyxwPTAscj0zLEE9MCxxLHUsdyxPLFI9MCxoYT17fSx2LHosTCxFLEI7TD1mdW5jdGlvbigpe3ZhciBhLGI7YT1sLmVsZW1lbnQuc3R5bGU7bz0ocT09PXZvaWQgMHx8dT09PXZvaWQgMHx8ay5zdHlsZXMudGV4dEFsaWduKSYmcyhsLnRleHRTdHIpJiZsLmdldEJCb3goKTtrLndpZHRoPShxfHxvLndpZHRofHwwKSsyKnIrQTtrLmhlaWdodD0odXx8by5oZWlnaHR8fDApKzIqcjt2PXIrai5mb250TWV0cmljcyhhJiZhLmZvbnRTaXplLGwpLmI7aWYoeil7aWYoIW0pYT1cblIsYj0oaD8tdjowKStSLGsuYm94PW09ZD9qLnN5bWJvbChkLGEsYixrLndpZHRoLGsuaGVpZ2h0LGhhKTpqLnJlY3QoYSxiLGsud2lkdGgsay5oZWlnaHQsMCxoYVtcInN0cm9rZS13aWR0aFwiXSksbS5pc0ltZ3x8bS5hdHRyKFwiZmlsbFwiLFwibm9uZVwiKSxtLmFkZChrKTttLmlzSW1nfHxtLmF0dHIoeCh7d2lkdGg6eShrLndpZHRoKSxoZWlnaHQ6eShrLmhlaWdodCl9LGhhKSk7aGE9bnVsbH19O0U9ZnVuY3Rpb24oKXt2YXIgYT1rLnN0eWxlcyxhPWEmJmEudGV4dEFsaWduLGI9QStyLGM7Yz1oPzA6djtpZihzKHEpJiZvJiYoYT09PVwiY2VudGVyXCJ8fGE9PT1cInJpZ2h0XCIpKWIrPXtjZW50ZXI6MC41LHJpZ2h0OjF9W2FdKihxLW8ud2lkdGgpO2lmKGIhPT1sLnh8fGMhPT1sLnkpbC5hdHRyKFwieFwiLGIpLGMhPT10JiZsLmF0dHIoXCJ5XCIsYyk7bC54PWI7bC55PWN9O0I9ZnVuY3Rpb24oYSxiKXttP20uYXR0cihhLGIpOmhhW2FdPWJ9O2sub25BZGQ9ZnVuY3Rpb24oKXtsLmFkZChrKTtrLmF0dHIoe3RleHQ6YXx8XG5hPT09MD9hOlwiXCIseDpiLHk6Y30pO20mJnMoZSkmJmsuYXR0cih7YW5jaG9yWDplLGFuY2hvclk6Zn0pfTtrLndpZHRoU2V0dGVyPWZ1bmN0aW9uKGEpe3E9YX07ay5oZWlnaHRTZXR0ZXI9ZnVuY3Rpb24oYSl7dT1hfTtrLnBhZGRpbmdTZXR0ZXI9ZnVuY3Rpb24oYSl7aWYocyhhKSYmYSE9PXIpcj1rLnBhZGRpbmc9YSxFKCl9O2sucGFkZGluZ0xlZnRTZXR0ZXI9ZnVuY3Rpb24oYSl7cyhhKSYmYSE9PUEmJihBPWEsRSgpKX07ay5hbGlnblNldHRlcj1mdW5jdGlvbihhKXthPXtsZWZ0OjAsY2VudGVyOjAuNSxyaWdodDoxfVthXTthIT09cCYmKHA9YSxvJiZrLmF0dHIoe3g6d30pKX07ay50ZXh0U2V0dGVyPWZ1bmN0aW9uKGEpe2EhPT10JiZsLnRleHRTZXR0ZXIoYSk7TCgpO0UoKX07a1tcInN0cm9rZS13aWR0aFNldHRlclwiXT1mdW5jdGlvbihhLGIpe2EmJih6PSEwKTtSPWElMi8yO0IoYixhKX07ay5zdHJva2VTZXR0ZXI9ay5maWxsU2V0dGVyPWsuclNldHRlcj1mdW5jdGlvbihhLFxuYil7Yj09PVwiZmlsbFwiJiZhJiYoej0hMCk7QihiLGEpfTtrLmFuY2hvclhTZXR0ZXI9ZnVuY3Rpb24oYSxiKXtlPWE7QihiLHkoYSktUi13KX07ay5hbmNob3JZU2V0dGVyPWZ1bmN0aW9uKGEsYil7Zj1hO0IoYixhLU8pfTtrLnhTZXR0ZXI9ZnVuY3Rpb24oYSl7ay54PWE7cCYmKGEtPXAqKChxfHxvLndpZHRoKSsyKnIpKTt3PXkoYSk7ay5hdHRyKFwidHJhbnNsYXRlWFwiLHcpfTtrLnlTZXR0ZXI9ZnVuY3Rpb24oYSl7Tz1rLnk9eShhKTtrLmF0dHIoXCJ0cmFuc2xhdGVZXCIsTyl9O3ZhciBEPWsuY3NzO3JldHVybiB4KGsse2NzczpmdW5jdGlvbihhKXtpZihhKXt2YXIgYj17fSxhPUMoYSk7bihrLnRleHRQcm9wcyxmdW5jdGlvbihjKXthW2NdIT09dCYmKGJbY109YVtjXSxkZWxldGUgYVtjXSl9KTtsLmNzcyhiKX1yZXR1cm4gRC5jYWxsKGssYSl9LGdldEJCb3g6ZnVuY3Rpb24oKXtyZXR1cm57d2lkdGg6by53aWR0aCsyKnIsaGVpZ2h0Om8uaGVpZ2h0KzIqcix4Om8ueC1yLHk6by55LVxucn19LHNoYWRvdzpmdW5jdGlvbihhKXttJiZtLnNoYWRvdyhhKTtyZXR1cm4ga30sZGVzdHJveTpmdW5jdGlvbigpe1Qoay5lbGVtZW50LFwibW91c2VlbnRlclwiKTtUKGsuZWxlbWVudCxcIm1vdXNlbGVhdmVcIik7bCYmKGw9bC5kZXN0cm95KCkpO20mJihtPW0uZGVzdHJveSgpKTtaLnByb3RvdHlwZS5kZXN0cm95LmNhbGwoayk7az1qPUw9RT1CPW51bGx9fSl9fTtZYT15YTt4KFoucHJvdG90eXBlLHtodG1sQ3NzOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuZWxlbWVudDtpZihiPWEmJmIudGFnTmFtZT09PVwiU1BBTlwiJiZhLndpZHRoKWRlbGV0ZSBhLndpZHRoLHRoaXMudGV4dFdpZHRoPWIsdGhpcy51cGRhdGVUcmFuc2Zvcm0oKTtpZihhJiZhLnRleHRPdmVyZmxvdz09PVwiZWxsaXBzaXNcIilhLndoaXRlU3BhY2U9XCJub3dyYXBcIixhLm92ZXJmbG93PVwiaGlkZGVuXCI7dGhpcy5zdHlsZXM9eCh0aGlzLnN0eWxlcyxhKTtGKHRoaXMuZWxlbWVudCxhKTtyZXR1cm4gdGhpc30saHRtbEdldEJCb3g6ZnVuY3Rpb24oKXt2YXIgYT1cbnRoaXMuZWxlbWVudDtpZihhLm5vZGVOYW1lPT09XCJ0ZXh0XCIpYS5zdHlsZS5wb3NpdGlvbj1cImFic29sdXRlXCI7cmV0dXJue3g6YS5vZmZzZXRMZWZ0LHk6YS5vZmZzZXRUb3Asd2lkdGg6YS5vZmZzZXRXaWR0aCxoZWlnaHQ6YS5vZmZzZXRIZWlnaHR9fSxodG1sVXBkYXRlVHJhbnNmb3JtOmZ1bmN0aW9uKCl7aWYodGhpcy5hZGRlZCl7dmFyIGE9dGhpcy5yZW5kZXJlcixiPXRoaXMuZWxlbWVudCxjPXRoaXMudHJhbnNsYXRlWHx8MCxkPXRoaXMudHJhbnNsYXRlWXx8MCxlPXRoaXMueHx8MCxmPXRoaXMueXx8MCxnPXRoaXMudGV4dEFsaWdufHxcImxlZnRcIixoPXtsZWZ0OjAsY2VudGVyOjAuNSxyaWdodDoxfVtnXSxpPXRoaXMuc2hhZG93cyxqPXRoaXMuc3R5bGVzO0YoYix7bWFyZ2luTGVmdDpjLG1hcmdpblRvcDpkfSk7aSYmbihpLGZ1bmN0aW9uKGEpe0YoYSx7bWFyZ2luTGVmdDpjKzEsbWFyZ2luVG9wOmQrMX0pfSk7dGhpcy5pbnZlcnRlZCYmbihiLmNoaWxkTm9kZXMsZnVuY3Rpb24oYyl7YS5pbnZlcnRDaGlsZChjLFxuYil9KTtpZihiLnRhZ05hbWU9PT1cIlNQQU5cIil7dmFyIGk9dGhpcy5yb3RhdGlvbixrPUcodGhpcy50ZXh0V2lkdGgpLGw9aiYmai53aGl0ZVNwYWNlLG09W2ksZyxiLmlubmVySFRNTCx0aGlzLnRleHRXaWR0aCx0aGlzLnRleHRBbGlnbl0uam9pbihcIixcIik7aWYobSE9PXRoaXMuY1RUKXtqPWEuZm9udE1ldHJpY3MoYi5zdHlsZS5mb250U2l6ZSkuYjtzKGkpJiZ0aGlzLnNldFNwYW5Sb3RhdGlvbihpLGgsaik7aWYoYi5vZmZzZXRXaWR0aD5rJiYvWyBcXC1dLy50ZXN0KGIudGV4dENvbnRlbnR8fGIuaW5uZXJUZXh0KSlGKGIse3dpZHRoOmsrXCJweFwiLGRpc3BsYXk6XCJibG9ja1wiLHdoaXRlU3BhY2U6bHx8XCJub3JtYWxcIn0pLHRoaXMuaGFzVGV4dFdpZHRoPSEwO2Vsc2UgaWYodGhpcy5oYXNUZXh0V2lkdGgpRihiLHt3aWR0aDpcIlwiLGRpc3BsYXk6XCJcIix3aGl0ZVNwYWNlOmx8fFwibm93cmFwXCJ9KSx0aGlzLmhhc1RleHRXaWR0aD0hMTt0aGlzLmdldFNwYW5Db3JyZWN0aW9uKHRoaXMuaGFzVGV4dFdpZHRoP1xuazpiLm9mZnNldFdpZHRoLGosaCxpLGcpfUYoYix7bGVmdDplKyh0aGlzLnhDb3JyfHwwKStcInB4XCIsdG9wOmYrKHRoaXMueUNvcnJ8fDApK1wicHhcIn0pO2lmKHRiKWo9Yi5vZmZzZXRIZWlnaHQ7dGhpcy5jVFQ9bX19ZWxzZSB0aGlzLmFsaWduT25BZGQ9ITB9LHNldFNwYW5Sb3RhdGlvbjpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9e30sZT1LYT9cIi1tcy10cmFuc2Zvcm1cIjp0Yj9cIi13ZWJraXQtdHJhbnNmb3JtXCI6WGE/XCJNb3pUcmFuc2Zvcm1cIjpVYj9cIi1vLXRyYW5zZm9ybVwiOlwiXCI7ZFtlXT1kLnRyYW5zZm9ybT1cInJvdGF0ZShcIithK1wiZGVnKVwiO2RbZSsoWGE/XCJPcmlnaW5cIjpcIi1vcmlnaW5cIildPWQudHJhbnNmb3JtT3JpZ2luPWIqMTAwK1wiJSBcIitjK1wicHhcIjtGKHRoaXMuZWxlbWVudCxkKX0sZ2V0U3BhbkNvcnJlY3Rpb246ZnVuY3Rpb24oYSxiLGMpe3RoaXMueENvcnI9LWEqYzt0aGlzLnlDb3JyPS1ifX0pO3goeWEucHJvdG90eXBlLHtodG1sOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD1cbnRoaXMuY3JlYXRlRWxlbWVudChcInNwYW5cIiksZT1kLmVsZW1lbnQsZj1kLnJlbmRlcmVyLGc9Zi5pc1NWRyxoPWZ1bmN0aW9uKGEsYil7bihbXCJvcGFjaXR5XCIsXCJ2aXNpYmlsaXR5XCJdLGZ1bmN0aW9uKGMpe1UoYSxjK1wiU2V0dGVyXCIsZnVuY3Rpb24oYSxjLGQsZSl7YS5jYWxsKHRoaXMsYyxkLGUpO2JbZF09Y30pfSl9O2QudGV4dFNldHRlcj1mdW5jdGlvbihhKXthIT09ZS5pbm5lckhUTUwmJmRlbGV0ZSB0aGlzLmJCb3g7ZS5pbm5lckhUTUw9dGhpcy50ZXh0U3RyPWE7ZC5odG1sVXBkYXRlVHJhbnNmb3JtKCl9O2cmJmgoZCxkLmVsZW1lbnQuc3R5bGUpO2QueFNldHRlcj1kLnlTZXR0ZXI9ZC5hbGlnblNldHRlcj1kLnJvdGF0aW9uU2V0dGVyPWZ1bmN0aW9uKGEsYil7Yj09PVwiYWxpZ25cIiYmKGI9XCJ0ZXh0QWxpZ25cIik7ZFtiXT1hO2QuaHRtbFVwZGF0ZVRyYW5zZm9ybSgpfTtkLmF0dHIoe3RleHQ6YSx4OnkoYikseTp5KGMpfSkuY3NzKHtwb3NpdGlvbjpcImFic29sdXRlXCIsZm9udEZhbWlseTp0aGlzLnN0eWxlLmZvbnRGYW1pbHksXG5mb250U2l6ZTp0aGlzLnN0eWxlLmZvbnRTaXplfSk7ZS5zdHlsZS53aGl0ZVNwYWNlPVwibm93cmFwXCI7ZC5jc3M9ZC5odG1sQ3NzO2lmKGcpZC5hZGQ9ZnVuY3Rpb24oYSl7dmFyIGIsYz1mLmJveC5wYXJlbnROb2RlLGc9W107aWYodGhpcy5wYXJlbnRHcm91cD1hKXtpZihiPWEuZGl2LCFiKXtmb3IoO2E7KWcucHVzaChhKSxhPWEucGFyZW50R3JvdXA7bihnLnJldmVyc2UoKSxmdW5jdGlvbihhKXt2YXIgZCxlPVgoYS5lbGVtZW50LFwiY2xhc3NcIik7ZSYmKGU9e2NsYXNzTmFtZTplfSk7Yj1hLmRpdj1hLmRpdnx8ZWEoV2EsZSx7cG9zaXRpb246XCJhYnNvbHV0ZVwiLGxlZnQ6KGEudHJhbnNsYXRlWHx8MCkrXCJweFwiLHRvcDooYS50cmFuc2xhdGVZfHwwKStcInB4XCIsb3BhY2l0eTphLm9wYWNpdHl9LGJ8fGMpO2Q9Yi5zdHlsZTt4KGEse3RyYW5zbGF0ZVhTZXR0ZXI6ZnVuY3Rpb24oYixjKXtkLmxlZnQ9YitcInB4XCI7YVtjXT1iO2EuZG9UcmFuc2Zvcm09ITB9LHRyYW5zbGF0ZVlTZXR0ZXI6ZnVuY3Rpb24oYixcbmMpe2QudG9wPWIrXCJweFwiO2FbY109YjthLmRvVHJhbnNmb3JtPSEwfX0pO2goYSxkKX0pfX1lbHNlIGI9YztiLmFwcGVuZENoaWxkKGUpO2QuYWRkZWQ9ITA7ZC5hbGlnbk9uQWRkJiZkLmh0bWxVcGRhdGVUcmFuc2Zvcm0oKTtyZXR1cm4gZH07cmV0dXJuIGR9fSk7dmFyIG1iLGFhO2lmKCFqYSYmIXFhKWFhPXtpbml0OmZ1bmN0aW9uKGEsYil7dmFyIGM9W1wiPFwiLGIsJyBmaWxsZWQ9XCJmXCIgc3Ryb2tlZD1cImZcIiddLGQ9W1wicG9zaXRpb246IFwiLFwiYWJzb2x1dGVcIixcIjtcIl0sZT1iPT09V2E7KGI9PT1cInNoYXBlXCJ8fGUpJiZkLnB1c2goXCJsZWZ0OjA7dG9wOjA7d2lkdGg6MXB4O2hlaWdodDoxcHg7XCIpO2QucHVzaChcInZpc2liaWxpdHk6IFwiLGU/XCJoaWRkZW5cIjpcInZpc2libGVcIik7Yy5wdXNoKCcgc3R5bGU9XCInLGQuam9pbihcIlwiKSwnXCIvPicpO2lmKGIpYz1lfHxiPT09XCJzcGFuXCJ8fGI9PT1cImltZ1wiP2Muam9pbihcIlwiKTphLnByZXBWTUwoYyksdGhpcy5lbGVtZW50PWVhKGMpO3RoaXMucmVuZGVyZXI9XG5hfSxhZGQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5yZW5kZXJlcixjPXRoaXMuZWxlbWVudCxkPWIuYm94LGU9YSYmYS5pbnZlcnRlZCxkPWE/YS5lbGVtZW50fHxhOmQ7aWYoYSl0aGlzLnBhcmVudEdyb3VwPWE7ZSYmYi5pbnZlcnRDaGlsZChjLGQpO2QuYXBwZW5kQ2hpbGQoYyk7dGhpcy5hZGRlZD0hMDt0aGlzLmFsaWduT25BZGQmJiF0aGlzLmRlZmVyVXBkYXRlVHJhbnNmb3JtJiZ0aGlzLnVwZGF0ZVRyYW5zZm9ybSgpO2lmKHRoaXMub25BZGQpdGhpcy5vbkFkZCgpO3JldHVybiB0aGlzfSx1cGRhdGVUcmFuc2Zvcm06Wi5wcm90b3R5cGUuaHRtbFVwZGF0ZVRyYW5zZm9ybSxzZXRTcGFuUm90YXRpb246ZnVuY3Rpb24oKXt2YXIgYT10aGlzLnJvdGF0aW9uLGI9YmEoYSpwYSksYz1rYShhKnBhKTtGKHRoaXMuZWxlbWVudCx7ZmlsdGVyOmE/W1wicHJvZ2lkOkRYSW1hZ2VUcmFuc2Zvcm0uTWljcm9zb2Z0Lk1hdHJpeChNMTE9XCIsYixcIiwgTTEyPVwiLC1jLFwiLCBNMjE9XCIsYyxcIiwgTTIyPVwiLFxuYixcIiwgc2l6aW5nTWV0aG9kPSdhdXRvIGV4cGFuZCcpXCJdLmpvaW4oXCJcIik6XCJub25lXCJ9KX0sZ2V0U3BhbkNvcnJlY3Rpb246ZnVuY3Rpb24oYSxiLGMsZCxlKXt2YXIgZj1kP2JhKGQqcGEpOjEsZz1kP2thKGQqcGEpOjAsaD1xKHRoaXMuZWxlbUhlaWdodCx0aGlzLmVsZW1lbnQub2Zmc2V0SGVpZ2h0KSxpO3RoaXMueENvcnI9ZjwwJiYtYTt0aGlzLnlDb3JyPWc8MCYmLWg7aT1mKmc8MDt0aGlzLnhDb3JyKz1nKmIqKGk/MS1jOmMpO3RoaXMueUNvcnItPWYqYiooZD9pP2M6MS1jOjEpO2UmJmUhPT1cImxlZnRcIiYmKHRoaXMueENvcnItPWEqYyooZjwwPy0xOjEpLGQmJih0aGlzLnlDb3JyLT1oKmMqKGc8MD8tMToxKSksRih0aGlzLmVsZW1lbnQse3RleHRBbGlnbjplfSkpfSxwYXRoVG9WTUw6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPWEubGVuZ3RoLGM9W107Yi0tOylpZih1YShhW2JdKSljW2JdPXkoYVtiXSoxMCktNTtlbHNlIGlmKGFbYl09PT1cIlpcIiljW2JdPVwieFwiO2Vsc2UgaWYoY1tiXT1cbmFbYl0sYS5pc0FyYyYmKGFbYl09PT1cIndhXCJ8fGFbYl09PT1cImF0XCIpKWNbYis1XT09PWNbYis3XSYmKGNbYis3XSs9YVtiKzddPmFbYis1XT8xOi0xKSxjW2IrNl09PT1jW2IrOF0mJihjW2IrOF0rPWFbYis4XT5hW2IrNl0/MTotMSk7cmV0dXJuIGMuam9pbihcIiBcIil8fFwieFwifSxjbGlwOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMsYzthPyhjPWEubWVtYmVycyxBYShjLGIpLGMucHVzaChiKSxiLmRlc3Ryb3lDbGlwPWZ1bmN0aW9uKCl7QWEoYyxiKX0sYT1hLmdldENTUyhiKSk6KGIuZGVzdHJveUNsaXAmJmIuZGVzdHJveUNsaXAoKSxhPXtjbGlwOnNiP1wiaW5oZXJpdFwiOlwicmVjdChhdXRvKVwifSk7cmV0dXJuIGIuY3NzKGEpfSxjc3M6Wi5wcm90b3R5cGUuaHRtbENzcyxzYWZlUmVtb3ZlQ2hpbGQ6ZnVuY3Rpb24oYSl7YS5wYXJlbnROb2RlJiZWYShhKX0sZGVzdHJveTpmdW5jdGlvbigpe3RoaXMuZGVzdHJveUNsaXAmJnRoaXMuZGVzdHJveUNsaXAoKTtyZXR1cm4gWi5wcm90b3R5cGUuZGVzdHJveS5hcHBseSh0aGlzKX0sXG5vbjpmdW5jdGlvbihhLGIpe3RoaXMuZWxlbWVudFtcIm9uXCIrYV09ZnVuY3Rpb24oKXt2YXIgYT1KLmV2ZW50O2EudGFyZ2V0PWEuc3JjRWxlbWVudDtiKGEpfTtyZXR1cm4gdGhpc30sY3V0T2ZmUGF0aDpmdW5jdGlvbihhLGIpe3ZhciBjLGE9YS5zcGxpdCgvWyAsXS8pO2M9YS5sZW5ndGg7aWYoYz09PTl8fGM9PT0xMSlhW2MtNF09YVtjLTJdPUcoYVtjLTJdKS0xMCpiO3JldHVybiBhLmpvaW4oXCIgXCIpfSxzaGFkb3c6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPVtdLGUsZj10aGlzLmVsZW1lbnQsZz10aGlzLnJlbmRlcmVyLGgsaT1mLnN0eWxlLGosaz1mLnBhdGgsbCxtLG8scDtrJiZ0eXBlb2Ygay52YWx1ZSE9PVwic3RyaW5nXCImJihrPVwieFwiKTttPWs7aWYoYSl7bz1xKGEud2lkdGgsMyk7cD0oYS5vcGFjaXR5fHwwLjE1KS9vO2ZvcihlPTE7ZTw9MztlKyspe2w9byoyKzEtMiplO2MmJihtPXRoaXMuY3V0T2ZmUGF0aChrLnZhbHVlLGwrMC41KSk7aj1bJzxzaGFwZSBpc1NoYWRvdz1cInRydWVcIiBzdHJva2V3ZWlnaHQ9XCInLFxubCwnXCIgZmlsbGVkPVwiZmFsc2VcIiBwYXRoPVwiJyxtLCdcIiBjb29yZHNpemU9XCIxMCAxMFwiIHN0eWxlPVwiJyxmLnN0eWxlLmNzc1RleHQsJ1wiIC8+J107aD1lYShnLnByZXBWTUwoaiksbnVsbCx7bGVmdDpHKGkubGVmdCkrcShhLm9mZnNldFgsMSksdG9wOkcoaS50b3ApK3EoYS5vZmZzZXRZLDEpfSk7aWYoYyloLmN1dE9mZj1sKzE7aj1bJzxzdHJva2UgY29sb3I9XCInLGEuY29sb3J8fFwiYmxhY2tcIiwnXCIgb3BhY2l0eT1cIicscCplLCdcIi8+J107ZWEoZy5wcmVwVk1MKGopLG51bGwsbnVsbCxoKTtiP2IuZWxlbWVudC5hcHBlbmRDaGlsZChoKTpmLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGgsZik7ZC5wdXNoKGgpfXRoaXMuc2hhZG93cz1kfXJldHVybiB0aGlzfSx1cGRhdGVTaGFkb3dzOnJhLHNldEF0dHI6ZnVuY3Rpb24oYSxiKXtzYj90aGlzLmVsZW1lbnRbYV09Yjp0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKGEsYil9LGNsYXNzU2V0dGVyOmZ1bmN0aW9uKGEpe3RoaXMuZWxlbWVudC5jbGFzc05hbWU9XG5hfSxkYXNoc3R5bGVTZXR0ZXI6ZnVuY3Rpb24oYSxiLGMpeyhjLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwic3Ryb2tlXCIpWzBdfHxlYSh0aGlzLnJlbmRlcmVyLnByZXBWTUwoW1wiPHN0cm9rZS8+XCJdKSxudWxsLG51bGwsYykpW2JdPWF8fFwic29saWRcIjt0aGlzW2JdPWF9LGRTZXR0ZXI6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXRoaXMuc2hhZG93cyxhPWF8fFtdO3RoaXMuZD1hLmpvaW4mJmEuam9pbihcIiBcIik7Yy5wYXRoPWE9dGhpcy5wYXRoVG9WTUwoYSk7aWYoZClmb3IoYz1kLmxlbmd0aDtjLS07KWRbY10ucGF0aD1kW2NdLmN1dE9mZj90aGlzLmN1dE9mZlBhdGgoYSxkW2NdLmN1dE9mZik6YTt0aGlzLnNldEF0dHIoYixhKX0sZmlsbFNldHRlcjpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9Yy5ub2RlTmFtZTtpZihkPT09XCJTUEFOXCIpYy5zdHlsZS5jb2xvcj1hO2Vsc2UgaWYoZCE9PVwiSU1HXCIpYy5maWxsZWQ9YSE9PVwibm9uZVwiLHRoaXMuc2V0QXR0cihcImZpbGxjb2xvclwiLHRoaXMucmVuZGVyZXIuY29sb3IoYSxcbmMsYix0aGlzKSl9LFwiZmlsbC1vcGFjaXR5U2V0dGVyXCI6ZnVuY3Rpb24oYSxiLGMpe2VhKHRoaXMucmVuZGVyZXIucHJlcFZNTChbXCI8XCIsYi5zcGxpdChcIi1cIilbMF0sJyBvcGFjaXR5PVwiJyxhLCdcIi8+J10pLG51bGwsbnVsbCxjKX0sb3BhY2l0eVNldHRlcjpyYSxyb3RhdGlvblNldHRlcjpmdW5jdGlvbihhLGIsYyl7Yz1jLnN0eWxlO3RoaXNbYl09Y1tiXT1hO2MubGVmdD0teShrYShhKnBhKSsxKStcInB4XCI7Yy50b3A9eShiYShhKnBhKSkrXCJweFwifSxzdHJva2VTZXR0ZXI6ZnVuY3Rpb24oYSxiLGMpe3RoaXMuc2V0QXR0cihcInN0cm9rZWNvbG9yXCIsdGhpcy5yZW5kZXJlci5jb2xvcihhLGMsYix0aGlzKSl9LFwic3Ryb2tlLXdpZHRoU2V0dGVyXCI6ZnVuY3Rpb24oYSxiLGMpe2Muc3Ryb2tlZD0hIWE7dGhpc1tiXT1hO3VhKGEpJiYoYSs9XCJweFwiKTt0aGlzLnNldEF0dHIoXCJzdHJva2V3ZWlnaHRcIixhKX0sdGl0bGVTZXR0ZXI6ZnVuY3Rpb24oYSxiKXt0aGlzLnNldEF0dHIoYixhKX0sXG52aXNpYmlsaXR5U2V0dGVyOmZ1bmN0aW9uKGEsYixjKXthPT09XCJpbmhlcml0XCImJihhPVwidmlzaWJsZVwiKTt0aGlzLnNoYWRvd3MmJm4odGhpcy5zaGFkb3dzLGZ1bmN0aW9uKGMpe2Muc3R5bGVbYl09YX0pO2Mubm9kZU5hbWU9PT1cIkRJVlwiJiYoYT1hPT09XCJoaWRkZW5cIj9cIi05OTllbVwiOjAsc2J8fChjLnN0eWxlW2JdPWE/XCJ2aXNpYmxlXCI6XCJoaWRkZW5cIiksYj1cInRvcFwiKTtjLnN0eWxlW2JdPWF9LHhTZXR0ZXI6ZnVuY3Rpb24oYSxiLGMpe3RoaXNbYl09YTtiPT09XCJ4XCI/Yj1cImxlZnRcIjpiPT09XCJ5XCImJihiPVwidG9wXCIpO3RoaXMudXBkYXRlQ2xpcHBpbmc/KHRoaXNbYl09YSx0aGlzLnVwZGF0ZUNsaXBwaW5nKCkpOmMuc3R5bGVbYl09YX0sekluZGV4U2V0dGVyOmZ1bmN0aW9uKGEsYixjKXtjLnN0eWxlW2JdPWF9fSxhYVtcInN0cm9rZS1vcGFjaXR5U2V0dGVyXCJdPWFhW1wiZmlsbC1vcGFjaXR5U2V0dGVyXCJdLHouVk1MRWxlbWVudD1hYT1sYShaLGFhKSxhYS5wcm90b3R5cGUueVNldHRlcj1cbmFhLnByb3RvdHlwZS53aWR0aFNldHRlcj1hYS5wcm90b3R5cGUuaGVpZ2h0U2V0dGVyPWFhLnByb3RvdHlwZS54U2V0dGVyLGFhPXtFbGVtZW50OmFhLGlzSUU4Ok1hLmluZGV4T2YoXCJNU0lFIDguMFwiKT4tMSxpbml0OmZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlO3RoaXMuYWxpZ25lZE9iamVjdHM9W107ZD10aGlzLmNyZWF0ZUVsZW1lbnQoV2EpLmNzcyh4KHRoaXMuZ2V0U3R5bGUoZCkse3Bvc2l0aW9uOlwicmVsYXRpdmVcIn0pKTtlPWQuZWxlbWVudDthLmFwcGVuZENoaWxkKGQuZWxlbWVudCk7dGhpcy5pc1ZNTD0hMDt0aGlzLmJveD1lO3RoaXMuYm94V3JhcHBlcj1kO3RoaXMuZ3JhZGllbnRzPXt9O3RoaXMuY2FjaGU9e307dGhpcy5jYWNoZUtleXM9W107dGhpcy5pbWdDb3VudD0wO3RoaXMuc2V0U2l6ZShiLGMsITEpO2lmKCFCLm5hbWVzcGFjZXMuaGN2KXtCLm5hbWVzcGFjZXMuYWRkKFwiaGN2XCIsXCJ1cm46c2NoZW1hcy1taWNyb3NvZnQtY29tOnZtbFwiKTt0cnl7Qi5jcmVhdGVTdHlsZVNoZWV0KCkuY3NzVGV4dD1cblwiaGN2XFxcXDpmaWxsLCBoY3ZcXFxcOnBhdGgsIGhjdlxcXFw6c2hhcGUsIGhjdlxcXFw6c3Ryb2tleyBiZWhhdmlvcjp1cmwoI2RlZmF1bHQjVk1MKTsgZGlzcGxheTogaW5saW5lLWJsb2NrOyB9IFwifWNhdGNoKGYpe0Iuc3R5bGVTaGVldHNbMF0uY3NzVGV4dCs9XCJoY3ZcXFxcOmZpbGwsIGhjdlxcXFw6cGF0aCwgaGN2XFxcXDpzaGFwZSwgaGN2XFxcXDpzdHJva2V7IGJlaGF2aW9yOnVybCgjZGVmYXVsdCNWTUwpOyBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IH0gXCJ9fX0saXNIaWRkZW46ZnVuY3Rpb24oKXtyZXR1cm4hdGhpcy5ib3gub2Zmc2V0V2lkdGh9LGNsaXBSZWN0OmZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPXRoaXMuY3JlYXRlRWxlbWVudCgpLGY9ZGEoYSk7cmV0dXJuIHgoZSx7bWVtYmVyczpbXSxjb3VudDowLGxlZnQ6KGY/YS54OmEpKzEsdG9wOihmP2EueTpiKSsxLHdpZHRoOihmP2Eud2lkdGg6YyktMSxoZWlnaHQ6KGY/YS5oZWlnaHQ6ZCktMSxnZXRDU1M6ZnVuY3Rpb24oYSl7dmFyIGI9YS5lbGVtZW50LFxuYz1iLm5vZGVOYW1lLGE9YS5pbnZlcnRlZCxkPXRoaXMudG9wLShjPT09XCJzaGFwZVwiP2Iub2Zmc2V0VG9wOjApLGU9dGhpcy5sZWZ0LGI9ZSt0aGlzLndpZHRoLGY9ZCt0aGlzLmhlaWdodCxkPXtjbGlwOlwicmVjdChcIit5KGE/ZTpkKStcInB4LFwiK3koYT9mOmIpK1wicHgsXCIreShhP2I6ZikrXCJweCxcIit5KGE/ZDplKStcInB4KVwifTshYSYmc2ImJmM9PT1cIkRJVlwiJiZ4KGQse3dpZHRoOmIrXCJweFwiLGhlaWdodDpmK1wicHhcIn0pO3JldHVybiBkfSx1cGRhdGVDbGlwcGluZzpmdW5jdGlvbigpe24oZS5tZW1iZXJzLGZ1bmN0aW9uKGEpe2EuZWxlbWVudCYmYS5jc3MoZS5nZXRDU1MoYSkpfSl9fSl9LGNvbG9yOmZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPXRoaXMsZixnPS9ecmdiYS8saCxpLGo9XCJub25lXCI7YSYmYS5saW5lYXJHcmFkaWVudD9pPVwiZ3JhZGllbnRcIjphJiZhLnJhZGlhbEdyYWRpZW50JiYoaT1cInBhdHRlcm5cIik7aWYoaSl7dmFyIGssbCxtPWEubGluZWFyR3JhZGllbnR8fGEucmFkaWFsR3JhZGllbnQsXG5vLHAscixBLHEsdT1cIlwiLGE9YS5zdG9wcyx3LE89W10sUj1mdW5jdGlvbigpe2g9Wyc8ZmlsbCBjb2xvcnM9XCInK08uam9pbihcIixcIikrJ1wiIG9wYWNpdHk9XCInLHIsJ1wiIG86b3BhY2l0eTI9XCInLHAsJ1wiIHR5cGU9XCInLGksJ1wiICcsdSwnZm9jdXM9XCIxMDAlXCIgbWV0aG9kPVwiYW55XCIgLz4nXTtlYShlLnByZXBWTUwoaCksbnVsbCxudWxsLGIpfTtvPWFbMF07dz1hW2EubGVuZ3RoLTFdO29bMF0+MCYmYS51bnNoaWZ0KFswLG9bMV1dKTt3WzBdPDEmJmEucHVzaChbMSx3WzFdXSk7bihhLGZ1bmN0aW9uKGEsYil7Zy50ZXN0KGFbMV0pPyhmPXdhKGFbMV0pLGs9Zi5nZXQoXCJyZ2JcIiksbD1mLmdldChcImFcIikpOihrPWFbMV0sbD0xKTtPLnB1c2goYVswXSoxMDArXCIlIFwiK2spO2I/KHI9bCxBPWspOihwPWwscT1rKX0pO2lmKGM9PT1cImZpbGxcIilpZihpPT09XCJncmFkaWVudFwiKWM9bS54MXx8bVswXXx8MCxhPW0ueTF8fG1bMV18fDAsbz1tLngyfHxtWzJdfHwwLG09bS55Mnx8bVszXXx8MCx1PVxuJ2FuZ2xlPVwiJysoOTAtWS5hdGFuKChtLWEpLyhvLWMpKSoxODAvQmEpKydcIicsUigpO2Vsc2V7dmFyIGo9bS5yLGhhPWoqMixzPWoqMix2PW0uY3gsdD1tLmN5LHk9Yi5yYWRpYWxSZWZlcmVuY2UseCxqPWZ1bmN0aW9uKCl7eSYmKHg9ZC5nZXRCQm94KCksdis9KHlbMF0teC54KS94LndpZHRoLTAuNSx0Kz0oeVsxXS14LnkpL3guaGVpZ2h0LTAuNSxoYSo9eVsyXS94LndpZHRoLHMqPXlbMl0veC5oZWlnaHQpO3U9J3NyYz1cIicrTi5nbG9iYWwuVk1MUmFkaWFsR3JhZGllbnRVUkwrJ1wiIHNpemU9XCInK2hhK1wiLFwiK3MrJ1wiIG9yaWdpbj1cIjAuNSwwLjVcIiBwb3NpdGlvbj1cIicrditcIixcIit0KydcIiBjb2xvcjI9XCInK3ErJ1wiICc7UigpfTtkLmFkZGVkP2ooKTpkLm9uQWRkPWo7aj1BfWVsc2Ugaj1rfWVsc2UgaWYoZy50ZXN0KGEpJiZiLnRhZ05hbWUhPT1cIklNR1wiKWY9d2EoYSksZFtjK1wiLW9wYWNpdHlTZXR0ZXJcIl0oZi5nZXQoXCJhXCIpLGMsYiksaj1mLmdldChcInJnYlwiKTtlbHNle2o9Yi5nZXRFbGVtZW50c0J5VGFnTmFtZShjKTtcbmlmKGoubGVuZ3RoKWpbMF0ub3BhY2l0eT0xLGpbMF0udHlwZT1cInNvbGlkXCI7aj1hfXJldHVybiBqfSxwcmVwVk1MOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuaXNJRTgsYT1hLmpvaW4oXCJcIik7Yj8oYT1hLnJlcGxhY2UoXCIvPlwiLCcgeG1sbnM9XCJ1cm46c2NoZW1hcy1taWNyb3NvZnQtY29tOnZtbFwiIC8+JyksYT1hLmluZGV4T2YoJ3N0eWxlPVwiJyk9PT0tMT9hLnJlcGxhY2UoXCIvPlwiLCcgc3R5bGU9XCJkaXNwbGF5OmlubGluZS1ibG9jaztiZWhhdmlvcjp1cmwoI2RlZmF1bHQjVk1MKTtcIiAvPicpOmEucmVwbGFjZSgnc3R5bGU9XCInLCdzdHlsZT1cImRpc3BsYXk6aW5saW5lLWJsb2NrO2JlaGF2aW9yOnVybCgjZGVmYXVsdCNWTUwpOycpKTphPWEucmVwbGFjZShcIjxcIixcIjxoY3Y6XCIpO3JldHVybiBhfSx0ZXh0OnlhLnByb3RvdHlwZS5odG1sLHBhdGg6ZnVuY3Rpb24oYSl7dmFyIGI9e2Nvb3Jkc2l6ZTpcIjEwIDEwXCJ9O0phKGEpP2IuZD1hOmRhKGEpJiZ4KGIsYSk7cmV0dXJuIHRoaXMuY3JlYXRlRWxlbWVudChcInNoYXBlXCIpLmF0dHIoYil9LFxuY2lyY2xlOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD10aGlzLnN5bWJvbChcImNpcmNsZVwiKTtpZihkYShhKSljPWEucixiPWEueSxhPWEueDtkLmlzQ2lyY2xlPSEwO2Qucj1jO3JldHVybiBkLmF0dHIoe3g6YSx5OmJ9KX0sZzpmdW5jdGlvbihhKXt2YXIgYjthJiYoYj17Y2xhc3NOYW1lOlwiaGlnaGNoYXJ0cy1cIithLFwiY2xhc3NcIjpcImhpZ2hjaGFydHMtXCIrYX0pO3JldHVybiB0aGlzLmNyZWF0ZUVsZW1lbnQoV2EpLmF0dHIoYil9LGltYWdlOmZ1bmN0aW9uKGEsYixjLGQsZSl7dmFyIGY9dGhpcy5jcmVhdGVFbGVtZW50KFwiaW1nXCIpLmF0dHIoe3NyYzphfSk7YXJndW1lbnRzLmxlbmd0aD4xJiZmLmF0dHIoe3g6Yix5OmMsd2lkdGg6ZCxoZWlnaHQ6ZX0pO3JldHVybiBmfSxjcmVhdGVFbGVtZW50OmZ1bmN0aW9uKGEpe3JldHVybiBhPT09XCJyZWN0XCI/dGhpcy5zeW1ib2woYSk6eWEucHJvdG90eXBlLmNyZWF0ZUVsZW1lbnQuY2FsbCh0aGlzLGEpfSxpbnZlcnRDaGlsZDpmdW5jdGlvbihhLFxuYil7dmFyIGM9dGhpcyxkPWIuc3R5bGUsZT1hLnRhZ05hbWU9PT1cIklNR1wiJiZhLnN0eWxlO0YoYSx7ZmxpcDpcInhcIixsZWZ0OkcoZC53aWR0aCktKGU/RyhlLnRvcCk6MSksdG9wOkcoZC5oZWlnaHQpLShlP0coZS5sZWZ0KToxKSxyb3RhdGlvbjotOTB9KTtuKGEuY2hpbGROb2RlcyxmdW5jdGlvbihiKXtjLmludmVydENoaWxkKGIsYSl9KX0sc3ltYm9sczp7YXJjOmZ1bmN0aW9uKGEsYixjLGQsZSl7dmFyIGY9ZS5zdGFydCxnPWUuZW5kLGg9ZS5yfHxjfHxkLGM9ZS5pbm5lclIsZD1iYShmKSxpPWthKGYpLGo9YmEoZyksaz1rYShnKTtpZihnLWY9PT0wKXJldHVybltcInhcIl07Zj1bXCJ3YVwiLGEtaCxiLWgsYStoLGIraCxhK2gqZCxiK2gqaSxhK2gqaixiK2gqa107ZS5vcGVuJiYhYyYmZi5wdXNoKFwiZVwiLFwiTVwiLGEsYik7Zi5wdXNoKFwiYXRcIixhLWMsYi1jLGErYyxiK2MsYStjKmosYitjKmssYStjKmQsYitjKmksXCJ4XCIsXCJlXCIpO2YuaXNBcmM9ITA7cmV0dXJuIGZ9LGNpcmNsZTpmdW5jdGlvbihhLFxuYixjLGQsZSl7ZSYmKGM9ZD0yKmUucik7ZSYmZS5pc0NpcmNsZSYmKGEtPWMvMixiLT1kLzIpO3JldHVybltcIndhXCIsYSxiLGErYyxiK2QsYStjLGIrZC8yLGErYyxiK2QvMixcImVcIl19LHJlY3Q6ZnVuY3Rpb24oYSxiLGMsZCxlKXtyZXR1cm4geWEucHJvdG90eXBlLnN5bWJvbHNbIXMoZSl8fCFlLnI/XCJzcXVhcmVcIjpcImNhbGxvdXRcIl0uY2FsbCgwLGEsYixjLGQsZSl9fX0sei5WTUxSZW5kZXJlcj1tYj1mdW5jdGlvbigpe3RoaXMuaW5pdC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LG1iLnByb3RvdHlwZT1DKHlhLnByb3RvdHlwZSxhYSksWWE9bWI7eWEucHJvdG90eXBlLm1lYXN1cmVTcGFuV2lkdGg9ZnVuY3Rpb24oYSxiKXt2YXIgYz1CLmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpLGQ7ZD1CLmNyZWF0ZVRleHROb2RlKGEpO2MuYXBwZW5kQ2hpbGQoZCk7RihjLGIpO3RoaXMuYm94LmFwcGVuZENoaWxkKGMpO2Q9Yy5vZmZzZXRXaWR0aDtWYShjKTtyZXR1cm4gZH07dmFyIFdiO2lmKHFhKXouQ2FuVkdSZW5kZXJlcj1cbmFhPWZ1bmN0aW9uKCl7UWE9XCJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sXCJ9LGFhLnByb3RvdHlwZS5zeW1ib2xzPXt9LFdiPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYSgpe3ZhciBhPWIubGVuZ3RoLGQ7Zm9yKGQ9MDtkPGE7ZCsrKWJbZF0oKTtiPVtdfXZhciBiPVtdO3JldHVybntwdXNoOmZ1bmN0aW9uKGMsZCl7aWYoYi5sZW5ndGg9PT0wKXt2YXIgZT1CLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaGVhZFwiKVswXSxmPUIuY3JlYXRlRWxlbWVudChcInNjcmlwdFwiKTtmLnR5cGU9XCJ0ZXh0L2phdmFzY3JpcHRcIjtmLnNyYz1kO2Yub25sb2FkPWE7ZS5hcHBlbmRDaGlsZChmKX1iLnB1c2goYyl9fX0oKSxZYT1hYTtjYi5wcm90b3R5cGU9e2FkZExhYmVsOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5heGlzLGI9YS5vcHRpb25zLGM9YS5jaGFydCxkPWEuY2F0ZWdvcmllcyxlPWEubmFtZXMsZj10aGlzLnBvcyxnPWIubGFiZWxzLGg9YS50aWNrUG9zaXRpb25zLGk9Zj09PWhbMF0saj1mPT09XG5oW2gubGVuZ3RoLTFdLGU9ZD9xKGRbZl0sZVtmXSxmKTpmLGQ9dGhpcy5sYWJlbCxoPWguaW5mbyxrO2EuaXNEYXRldGltZUF4aXMmJmgmJihrPWIuZGF0ZVRpbWVMYWJlbEZvcm1hdHNbaC5oaWdoZXJSYW5rc1tmXXx8aC51bml0TmFtZV0pO3RoaXMuaXNGaXJzdD1pO3RoaXMuaXNMYXN0PWo7Yj1hLmxhYmVsRm9ybWF0dGVyLmNhbGwoe2F4aXM6YSxjaGFydDpjLGlzRmlyc3Q6aSxpc0xhc3Q6aixkYXRlVGltZUxhYmVsRm9ybWF0OmssdmFsdWU6YS5pc0xvZz9uYShhLmxpbjJsb2coZSkpOmV9KTtzKGQpP2QmJmQuYXR0cih7dGV4dDpifSk6KHRoaXMubGFiZWxMZW5ndGg9KHRoaXMubGFiZWw9ZD1zKGIpJiZnLmVuYWJsZWQ/Yy5yZW5kZXJlci50ZXh0KGIsMCwwLGcudXNlSFRNTCkuY3NzKEMoZy5zdHlsZSkpLmFkZChhLmxhYmVsR3JvdXApOm51bGwpJiZkLmdldEJCb3goKS53aWR0aCx0aGlzLnJvdGF0aW9uPTApfSxnZXRMYWJlbFNpemU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5sYWJlbD9cbnRoaXMubGFiZWwuZ2V0QkJveCgpW3RoaXMuYXhpcy5ob3Jpej9cImhlaWdodFwiOlwid2lkdGhcIl06MH0saGFuZGxlT3ZlcmZsb3c6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5heGlzLGM9YS54LGQ9Yi5jaGFydC5jaGFydFdpZHRoLGU9Yi5jaGFydC5zcGFjaW5nLGY9cShiLmxhYmVsTGVmdCxFKGIucG9zLGVbM10pKSxlPXEoYi5sYWJlbFJpZ2h0LHYoYi5wb3MrYi5sZW4sZC1lWzFdKSksZz10aGlzLmxhYmVsLGg9dGhpcy5yb3RhdGlvbixpPXtsZWZ0OjAsY2VudGVyOjAuNSxyaWdodDoxfVtiLmxhYmVsQWxpZ25dLGo9Zy5nZXRCQm94KCkud2lkdGgsaz1iLmdldFNsb3RXaWR0aCgpLGw9ayxtPTEsbyxwPXt9O2lmKGgpaDwwJiZjLWkqajxmP289eShjL2JhKGgqcGEpLWYpOmg+MCYmYytpKmo+ZSYmKG89eSgoZC1jKS9iYShoKnBhKSkpO2Vsc2UgaWYoZD1jKygxLWkpKmosYy1pKmo8Zj9sPWEueCtsKigxLWkpLWY6ZD5lJiYobD1lLWEueCtsKmksbT0tMSksbD1FKGssbCksbDxrJiZiLmxhYmVsQWxpZ249PT1cblwiY2VudGVyXCImJihhLngrPW0qKGstbC1pKihrLUUoaixsKSkpKSxqPmx8fGIuYXV0b1JvdGF0aW9uJiZnLnN0eWxlcy53aWR0aClvPWw7aWYobyl7cC53aWR0aD1vO2lmKCFiLm9wdGlvbnMubGFiZWxzLnN0eWxlLnRleHRPdmVyZmxvdylwLnRleHRPdmVyZmxvdz1cImVsbGlwc2lzXCI7Zy5jc3MocCl9fSxnZXRQb3NpdGlvbjpmdW5jdGlvbihhLGIsYyxkKXt2YXIgZT10aGlzLmF4aXMsZj1lLmNoYXJ0LGc9ZCYmZi5vbGRDaGFydEhlaWdodHx8Zi5jaGFydEhlaWdodDtyZXR1cm57eDphP2UudHJhbnNsYXRlKGIrYyxudWxsLG51bGwsZCkrZS50cmFuc0I6ZS5sZWZ0K2Uub2Zmc2V0KyhlLm9wcG9zaXRlPyhkJiZmLm9sZENoYXJ0V2lkdGh8fGYuY2hhcnRXaWR0aCktZS5yaWdodC1lLmxlZnQ6MCkseTphP2ctZS5ib3R0b20rZS5vZmZzZXQtKGUub3Bwb3NpdGU/ZS5oZWlnaHQ6MCk6Zy1lLnRyYW5zbGF0ZShiK2MsbnVsbCxudWxsLGQpLWUudHJhbnNCfX0sZ2V0TGFiZWxQb3NpdGlvbjpmdW5jdGlvbihhLFxuYixjLGQsZSxmLGcsaCl7dmFyIGk9dGhpcy5heGlzLGo9aS50cmFuc0Esaz1pLnJldmVyc2VkLGw9aS5zdGFnZ2VyTGluZXMsbT1pLnRpY2tSb3RDb3JyfHx7eDowLHk6MH0sbz1lLnk7cyhvKXx8KG89aS5zaWRlPT09MD9jLnJvdGF0aW9uPy04Oi1jLmdldEJCb3goKS5oZWlnaHQ6aS5zaWRlPT09Mj9tLnkrODpiYShjLnJvdGF0aW9uKnBhKSoobS55LWMuZ2V0QkJveCghMSwwKS5oZWlnaHQvMikpO2E9YStlLngrbS54LShmJiZkP2Yqaiooaz8tMToxKTowKTtiPWIrby0oZiYmIWQ/ZipqKihrPzE6LTEpOjApO2wmJihjPWcvKGh8fDEpJWwsaS5vcHBvc2l0ZSYmKGM9bC1jLTEpLGIrPWMqKGkubGFiZWxPZmZzZXQvbCkpO3JldHVybnt4OmEseTp5KGIpfX0sZ2V0TWFya1BhdGg6ZnVuY3Rpb24oYSxiLGMsZCxlLGYpe3JldHVybiBmLmNyaXNwTGluZShbXCJNXCIsYSxiLFwiTFwiLGErKGU/MDotYyksYisoZT9jOjApXSxkKX0scmVuZGVyOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD10aGlzLmF4aXMsXG5lPWQub3B0aW9ucyxmPWQuY2hhcnQucmVuZGVyZXIsZz1kLmhvcml6LGg9dGhpcy50eXBlLGk9dGhpcy5sYWJlbCxqPXRoaXMucG9zLGs9ZS5sYWJlbHMsbD10aGlzLmdyaWRMaW5lLG09aD9oK1wiR3JpZFwiOlwiZ3JpZFwiLG89aD9oK1wiVGlja1wiOlwidGlja1wiLHA9ZVttK1wiTGluZVdpZHRoXCJdLHI9ZVttK1wiTGluZUNvbG9yXCJdLEE9ZVttK1wiTGluZURhc2hTdHlsZVwiXSxtPWQudGlja1NpemUobyksbz1lW28rXCJDb2xvclwiXSxQPXRoaXMubWFyayx1PWsuc3RlcCx3PSEwLG49ZC50aWNrbWFya09mZnNldCxSPXRoaXMuZ2V0UG9zaXRpb24oZyxqLG4sYiksaGE9Ui54LFI9Ui55LHM9ZyYmaGE9PT1kLnBvcytkLmxlbnx8IWcmJlI9PT1kLnBvcz8tMToxLGM9cShjLDEpO3RoaXMuaXNBY3RpdmU9ITA7aWYocCl7aj1kLmdldFBsb3RMaW5lUGF0aChqK24scCpzLGIsITApO2lmKGw9PT10KXtsPXtzdHJva2U6cixcInN0cm9rZS13aWR0aFwiOnB9O2lmKEEpbC5kYXNoc3R5bGU9QTtpZighaClsLnpJbmRleD1cbjE7aWYoYilsLm9wYWNpdHk9MDt0aGlzLmdyaWRMaW5lPWw9cD9mLnBhdGgoaikuYXR0cihsKS5hZGQoZC5ncmlkR3JvdXApOm51bGx9aWYoIWImJmwmJmopbFt0aGlzLmlzTmV3P1wiYXR0clwiOlwiYW5pbWF0ZVwiXSh7ZDpqLG9wYWNpdHk6Y30pfWlmKG0pZC5vcHBvc2l0ZSYmKG1bMF09LW1bMF0pLGg9dGhpcy5nZXRNYXJrUGF0aChoYSxSLG1bMF0sbVsxXSpzLGcsZiksUD9QLmFuaW1hdGUoe2Q6aCxvcGFjaXR5OmN9KTp0aGlzLm1hcms9Zi5wYXRoKGgpLmF0dHIoe3N0cm9rZTpvLFwic3Ryb2tlLXdpZHRoXCI6bVsxXSxvcGFjaXR5OmN9KS5hZGQoZC5heGlzR3JvdXApO2lmKGkmJiFpc05hTihoYSkpaS54eT1SPXRoaXMuZ2V0TGFiZWxQb3NpdGlvbihoYSxSLGksZyxrLG4sYSx1KSx0aGlzLmlzRmlyc3QmJiF0aGlzLmlzTGFzdCYmIXEoZS5zaG93Rmlyc3RMYWJlbCwxKXx8dGhpcy5pc0xhc3QmJiF0aGlzLmlzRmlyc3QmJiFxKGUuc2hvd0xhc3RMYWJlbCwxKT93PSExOmcmJiFkLmlzUmFkaWFsJiZcbiFrLnN0ZXAmJiFrLnJvdGF0aW9uJiYhYiYmYyE9PTAmJnRoaXMuaGFuZGxlT3ZlcmZsb3coUiksdSYmYSV1JiYodz0hMSksdyYmIWlzTmFOKFIueSk/KFIub3BhY2l0eT1jLGlbdGhpcy5pc05ldz9cImF0dHJcIjpcImFuaW1hdGVcIl0oUiksdGhpcy5pc05ldz0hMSk6aS5hdHRyKFwieVwiLC05OTk5KX0sZGVzdHJveTpmdW5jdGlvbigpe1BhKHRoaXMsdGhpcy5heGlzKX19O3ouUGxvdExpbmVPckJhbmQ9ZnVuY3Rpb24oYSxiKXt0aGlzLmF4aXM9YTtpZihiKXRoaXMub3B0aW9ucz1iLHRoaXMuaWQ9Yi5pZH07ei5QbG90TGluZU9yQmFuZC5wcm90b3R5cGU9e3JlbmRlcjpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLmF4aXMsYz1iLmhvcml6LGQ9YS5vcHRpb25zLGU9ZC5sYWJlbCxmPWEubGFiZWwsZz1kLndpZHRoLGg9ZC50byxpPWQuZnJvbSxqPXMoaSkmJnMoaCksaz1kLnZhbHVlLGw9ZC5kYXNoU3R5bGUsbT1hLnN2Z0VsZW0sbz1bXSxwLHI9ZC5jb2xvcixBPXEoZC56SW5kZXgsMCksbj1cbmQuZXZlbnRzLHU9e30sdz1iLmNoYXJ0LnJlbmRlcmVyLG89Yi5sb2cybGluO2IuaXNMb2cmJihpPW8oaSksaD1vKGgpLGs9byhrKSk7aWYoZyl7aWYobz1iLmdldFBsb3RMaW5lUGF0aChrLGcpLHU9e3N0cm9rZTpyLFwic3Ryb2tlLXdpZHRoXCI6Z30sbCl1LmRhc2hzdHlsZT1sfWVsc2UgaWYoail7bz1iLmdldFBsb3RCYW5kUGF0aChpLGgsZCk7aWYocil1LmZpbGw9cjtpZihkLmJvcmRlcldpZHRoKXUuc3Ryb2tlPWQuYm9yZGVyQ29sb3IsdVtcInN0cm9rZS13aWR0aFwiXT1kLmJvcmRlcldpZHRofWVsc2UgcmV0dXJuO3UuekluZGV4PUE7aWYobSlpZihvKW0uc2hvdygpLG0uYW5pbWF0ZSh7ZDpvfSk7ZWxzZXtpZihtLmhpZGUoKSxmKWEubGFiZWw9Zj1mLmRlc3Ryb3koKX1lbHNlIGlmKG8mJm8ubGVuZ3RoJiYoYS5zdmdFbGVtPW09dy5wYXRoKG8pLmF0dHIodSkuYWRkKCksbikpZm9yKHAgaW4gZD1mdW5jdGlvbihiKXttLm9uKGIsZnVuY3Rpb24oYyl7bltiXS5hcHBseShhLFtjXSl9KX0sXG5uKWQocCk7ZSYmcyhlLnRleHQpJiZvJiZvLmxlbmd0aCYmYi53aWR0aD4wJiZiLmhlaWdodD4wJiYhby5mbGF0PyhlPUMoe2FsaWduOmMmJmomJlwiY2VudGVyXCIseDpjPyFqJiY0OjEwLHZlcnRpY2FsQWxpZ246IWMmJmomJlwibWlkZGxlXCIseTpjP2o/MTY6MTA6aj82Oi00LHJvdGF0aW9uOmMmJiFqJiY5MH0sZSksdGhpcy5yZW5kZXJMYWJlbChlLG8saixBKSk6ZiYmZi5oaWRlKCk7cmV0dXJuIGF9LHJlbmRlckxhYmVsOmZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPXRoaXMubGFiZWwsZj10aGlzLmF4aXMuY2hhcnQucmVuZGVyZXI7aWYoIWUpZT17YWxpZ246YS50ZXh0QWxpZ258fGEuYWxpZ24scm90YXRpb246YS5yb3RhdGlvbn0sZS56SW5kZXg9ZCx0aGlzLmxhYmVsPWU9Zi50ZXh0KGEudGV4dCwwLDAsYS51c2VIVE1MKS5hdHRyKGUpLmNzcyhhLnN0eWxlKS5hZGQoKTtkPVtiWzFdLGJbNF0sYz9iWzZdOmJbMV1dO2I9W2JbMl0sYls1XSxjP2JbN106YlsyXV07Yz1PYShkKTtmPU9hKGIpO1xuZS5hbGlnbihhLCExLHt4OmMseTpmLHdpZHRoOkVhKGQpLWMsaGVpZ2h0OkVhKGIpLWZ9KTtlLnNob3coKX0sZGVzdHJveTpmdW5jdGlvbigpe0FhKHRoaXMuYXhpcy5wbG90TGluZXNBbmRCYW5kcyx0aGlzKTtkZWxldGUgdGhpcy5heGlzO1BhKHRoaXMpfX07dmFyIEk9ei5BeGlzPWZ1bmN0aW9uKCl7dGhpcy5pbml0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX07SS5wcm90b3R5cGU9e2RlZmF1bHRPcHRpb25zOntkYXRlVGltZUxhYmVsRm9ybWF0czp7bWlsbGlzZWNvbmQ6XCIlSDolTTolUy4lTFwiLHNlY29uZDpcIiVIOiVNOiVTXCIsbWludXRlOlwiJUg6JU1cIixob3VyOlwiJUg6JU1cIixkYXk6XCIlZS4gJWJcIix3ZWVrOlwiJWUuICViXCIsbW9udGg6XCIlYiAnJXlcIix5ZWFyOlwiJVlcIn0sZW5kT25UaWNrOiExLGdyaWRMaW5lQ29sb3I6XCIjRDhEOEQ4XCIsbGFiZWxzOntlbmFibGVkOiEwLHN0eWxlOntjb2xvcjpcIiM2MDYwNjBcIixjdXJzb3I6XCJkZWZhdWx0XCIsZm9udFNpemU6XCIxMXB4XCJ9LHg6MH0sbGluZUNvbG9yOlwiI0MwRDBFMFwiLFxubGluZVdpZHRoOjEsbWluUGFkZGluZzowLjAxLG1heFBhZGRpbmc6MC4wMSxtaW5vckdyaWRMaW5lQ29sb3I6XCIjRTBFMEUwXCIsbWlub3JHcmlkTGluZVdpZHRoOjEsbWlub3JUaWNrQ29sb3I6XCIjQTBBMEEwXCIsbWlub3JUaWNrTGVuZ3RoOjIsbWlub3JUaWNrUG9zaXRpb246XCJvdXRzaWRlXCIsc3RhcnRPZldlZWs6MSxzdGFydE9uVGljazohMSx0aWNrQ29sb3I6XCIjQzBEMEUwXCIsdGlja0xlbmd0aDoxMCx0aWNrbWFya1BsYWNlbWVudDpcImJldHdlZW5cIix0aWNrUGl4ZWxJbnRlcnZhbDoxMDAsdGlja1Bvc2l0aW9uOlwib3V0c2lkZVwiLHRpdGxlOnthbGlnbjpcIm1pZGRsZVwiLHN0eWxlOntjb2xvcjpcIiM3MDcwNzBcIn19LHR5cGU6XCJsaW5lYXJcIn0sZGVmYXVsdFlBeGlzT3B0aW9uczp7ZW5kT25UaWNrOiEwLGdyaWRMaW5lV2lkdGg6MSx0aWNrUGl4ZWxJbnRlcnZhbDo3MixzaG93TGFzdExhYmVsOiEwLGxhYmVsczp7eDotOH0sbGluZVdpZHRoOjAsbWF4UGFkZGluZzowLjA1LG1pblBhZGRpbmc6MC4wNSxcbnN0YXJ0T25UaWNrOiEwLHRpdGxlOntyb3RhdGlvbjoyNzAsdGV4dDpcIlZhbHVlc1wifSxzdGFja0xhYmVsczp7ZW5hYmxlZDohMSxmb3JtYXR0ZXI6ZnVuY3Rpb24oKXtyZXR1cm4gei5udW1iZXJGb3JtYXQodGhpcy50b3RhbCwtMSl9LHN0eWxlOkMoVy5saW5lLmRhdGFMYWJlbHMuc3R5bGUse2NvbG9yOlwiIzAwMDAwMFwifSl9fSxkZWZhdWx0TGVmdEF4aXNPcHRpb25zOntsYWJlbHM6e3g6LTE1fSx0aXRsZTp7cm90YXRpb246MjcwfX0sZGVmYXVsdFJpZ2h0QXhpc09wdGlvbnM6e2xhYmVsczp7eDoxNX0sdGl0bGU6e3JvdGF0aW9uOjkwfX0sZGVmYXVsdEJvdHRvbUF4aXNPcHRpb25zOntsYWJlbHM6e2F1dG9Sb3RhdGlvbjpbLTQ1XSx4OjB9LHRpdGxlOntyb3RhdGlvbjowfX0sZGVmYXVsdFRvcEF4aXNPcHRpb25zOntsYWJlbHM6e2F1dG9Sb3RhdGlvbjpbLTQ1XSx4OjB9LHRpdGxlOntyb3RhdGlvbjowfX0saW5pdDpmdW5jdGlvbihhLGIpe3ZhciBjPWIuaXNYO3RoaXMuY2hhcnQ9XG5hO3RoaXMuaG9yaXo9YS5pbnZlcnRlZD8hYzpjO3RoaXMuY29sbD0odGhpcy5pc1hBeGlzPWMpP1wieEF4aXNcIjpcInlBeGlzXCI7dGhpcy5vcHBvc2l0ZT1iLm9wcG9zaXRlO3RoaXMuc2lkZT1iLnNpZGV8fCh0aGlzLmhvcml6P3RoaXMub3Bwb3NpdGU/MDoyOnRoaXMub3Bwb3NpdGU/MTozKTt0aGlzLnNldE9wdGlvbnMoYik7dmFyIGQ9dGhpcy5vcHRpb25zLGU9ZC50eXBlO3RoaXMubGFiZWxGb3JtYXR0ZXI9ZC5sYWJlbHMuZm9ybWF0dGVyfHx0aGlzLmRlZmF1bHRMYWJlbEZvcm1hdHRlcjt0aGlzLnVzZXJPcHRpb25zPWI7dGhpcy5taW5QaXhlbFBhZGRpbmc9MDt0aGlzLnJldmVyc2VkPWQucmV2ZXJzZWQ7dGhpcy52aXNpYmxlPWQudmlzaWJsZSE9PSExO3RoaXMuem9vbUVuYWJsZWQ9ZC56b29tRW5hYmxlZCE9PSExO3RoaXMuY2F0ZWdvcmllcz1kLmNhdGVnb3JpZXN8fGU9PT1cImNhdGVnb3J5XCI7dGhpcy5uYW1lcz10aGlzLm5hbWVzfHxbXTt0aGlzLmlzTG9nPWU9PT1cImxvZ2FyaXRobWljXCI7XG50aGlzLmlzRGF0ZXRpbWVBeGlzPWU9PT1cImRhdGV0aW1lXCI7dGhpcy5pc0xpbmtlZD1zKGQubGlua2VkVG8pO3RoaXMudGlja3M9e307dGhpcy5sYWJlbEVkZ2U9W107dGhpcy5taW5vclRpY2tzPXt9O3RoaXMucGxvdExpbmVzQW5kQmFuZHM9W107dGhpcy5hbHRlcm5hdGVCYW5kcz17fTt0aGlzLmxlbj0wO3RoaXMubWluUmFuZ2U9dGhpcy51c2VyTWluUmFuZ2U9ZC5taW5SYW5nZXx8ZC5tYXhab29tO3RoaXMucmFuZ2U9ZC5yYW5nZTt0aGlzLm9mZnNldD1kLm9mZnNldHx8MDt0aGlzLnN0YWNrcz17fTt0aGlzLm9sZFN0YWNrcz17fTt0aGlzLnN0YWNrc1RvdWNoZWQ9MDt0aGlzLm1pbj10aGlzLm1heD1udWxsO3RoaXMuY3Jvc3NoYWlyPXEoZC5jcm9zc2hhaXIsdmEoYS5vcHRpb25zLnRvb2x0aXAuY3Jvc3NoYWlycylbYz8wOjFdLCExKTt2YXIgZixkPXRoaXMub3B0aW9ucy5ldmVudHM7c2EodGhpcyxhLmF4ZXMpPT09LTEmJihjJiYhdGhpcy5pc0NvbG9yQXhpcz9hLmF4ZXMuc3BsaWNlKGEueEF4aXMubGVuZ3RoLFxuMCx0aGlzKTphLmF4ZXMucHVzaCh0aGlzKSxhW3RoaXMuY29sbF0ucHVzaCh0aGlzKSk7dGhpcy5zZXJpZXM9dGhpcy5zZXJpZXN8fFtdO2lmKGEuaW52ZXJ0ZWQmJmMmJnRoaXMucmV2ZXJzZWQ9PT10KXRoaXMucmV2ZXJzZWQ9ITA7dGhpcy5yZW1vdmVQbG90TGluZT10aGlzLnJlbW92ZVBsb3RCYW5kPXRoaXMucmVtb3ZlUGxvdEJhbmRPckxpbmU7Zm9yKGYgaW4gZClEKHRoaXMsZixkW2ZdKTtpZih0aGlzLmlzTG9nKXRoaXMudmFsMmxpbj10aGlzLmxvZzJsaW4sdGhpcy5saW4ydmFsPXRoaXMubGluMmxvZ30sc2V0T3B0aW9uczpmdW5jdGlvbihhKXt0aGlzLm9wdGlvbnM9Qyh0aGlzLmRlZmF1bHRPcHRpb25zLHRoaXMuaXNYQXhpcz97fTp0aGlzLmRlZmF1bHRZQXhpc09wdGlvbnMsW3RoaXMuZGVmYXVsdFRvcEF4aXNPcHRpb25zLHRoaXMuZGVmYXVsdFJpZ2h0QXhpc09wdGlvbnMsdGhpcy5kZWZhdWx0Qm90dG9tQXhpc09wdGlvbnMsdGhpcy5kZWZhdWx0TGVmdEF4aXNPcHRpb25zXVt0aGlzLnNpZGVdLFxuQyhOW3RoaXMuY29sbF0sYSkpfSxkZWZhdWx0TGFiZWxGb3JtYXR0ZXI6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmF4aXMsYj10aGlzLnZhbHVlLGM9YS5jYXRlZ29yaWVzLGQ9dGhpcy5kYXRlVGltZUxhYmVsRm9ybWF0LGU9Ti5sYW5nLm51bWVyaWNTeW1ib2xzLGY9ZSYmZS5sZW5ndGgsZyxoPWEub3B0aW9ucy5sYWJlbHMuZm9ybWF0LGE9YS5pc0xvZz9iOmEudGlja0ludGVydmFsO2lmKGgpZz1MYShoLHRoaXMpO2Vsc2UgaWYoYylnPWI7ZWxzZSBpZihkKWc9bWEoZCxiKTtlbHNlIGlmKGYmJmE+PTFFMylmb3IoO2YtLSYmZz09PXQ7KWM9TWF0aC5wb3coMUUzLGYrMSksYT49YyYmYioxMCVjPT09MCYmZVtmXSE9PW51bGwmJihnPXoubnVtYmVyRm9ybWF0KGIvYywtMSkrZVtmXSk7Zz09PXQmJihnPVMoYik+PTFFND96Lm51bWJlckZvcm1hdChiLC0xKTp6Lm51bWJlckZvcm1hdChiLC0xLHQsXCJcIikpO3JldHVybiBnfSxnZXRTZXJpZXNFeHRyZW1lczpmdW5jdGlvbigpe3ZhciBhPXRoaXMsXG5iPWEuY2hhcnQ7YS5oYXNWaXNpYmxlU2VyaWVzPSExO2EuZGF0YU1pbj1hLmRhdGFNYXg9YS50aHJlc2hvbGQ9bnVsbDthLnNvZnRUaHJlc2hvbGQ9IWEuaXNYQXhpczthLmJ1aWxkU3RhY2tzJiZhLmJ1aWxkU3RhY2tzKCk7bihhLnNlcmllcyxmdW5jdGlvbihjKXtpZihjLnZpc2libGV8fCFiLm9wdGlvbnMuY2hhcnQuaWdub3JlSGlkZGVuU2VyaWVzKXt2YXIgZD1jLm9wdGlvbnMsZT1kLnRocmVzaG9sZCxmO2EuaGFzVmlzaWJsZVNlcmllcz0hMDthLmlzTG9nJiZlPD0wJiYoZT1udWxsKTtpZihhLmlzWEF4aXMpe2lmKGQ9Yy54RGF0YSxkLmxlbmd0aClhLmRhdGFNaW49RShxKGEuZGF0YU1pbixkWzBdKSxPYShkKSksYS5kYXRhTWF4PXYocShhLmRhdGFNYXgsZFswXSksRWEoZCkpfWVsc2V7Yy5nZXRFeHRyZW1lcygpO2Y9Yy5kYXRhTWF4O2M9Yy5kYXRhTWluO2lmKHMoYykmJnMoZikpYS5kYXRhTWluPUUocShhLmRhdGFNaW4sYyksYyksYS5kYXRhTWF4PXYocShhLmRhdGFNYXgsXG5mKSxmKTtpZihzKGUpKWEudGhyZXNob2xkPWU7aWYoIWQuc29mdFRocmVzaG9sZHx8YS5pc0xvZylhLnNvZnRUaHJlc2hvbGQ9ITF9fX0pfSx0cmFuc2xhdGU6ZnVuY3Rpb24oYSxiLGMsZCxlLGYpe3ZhciBnPXRoaXMubGlua2VkUGFyZW50fHx0aGlzLGg9MSxpPTAsaj1kP2cub2xkVHJhbnNBOmcudHJhbnNBLGQ9ZD9nLm9sZE1pbjpnLm1pbixrPWcubWluUGl4ZWxQYWRkaW5nLGU9KGcuaXNPcmRpbmFsfHxnLmlzQnJva2VufHxnLmlzTG9nJiZlKSYmZy5saW4ydmFsO2lmKCFqKWo9Zy50cmFuc0E7aWYoYyloKj0tMSxpPWcubGVuO2cucmV2ZXJzZWQmJihoKj0tMSxpLT1oKihnLnNlY3Rvcnx8Zy5sZW4pKTtiPyhhPWEqaCtpLGEtPWssYT1hL2orZCxlJiYoYT1nLmxpbjJ2YWwoYSkpKTooZSYmKGE9Zy52YWwybGluKGEpKSxmPT09XCJiZXR3ZWVuXCImJihmPTAuNSksYT1oKihhLWQpKmoraStoKmsrKHVhKGYpP2oqZipnLnBvaW50UmFuZ2U6MCkpO3JldHVybiBhfSx0b1BpeGVsczpmdW5jdGlvbihhLFxuYil7cmV0dXJuIHRoaXMudHJhbnNsYXRlKGEsITEsIXRoaXMuaG9yaXosbnVsbCwhMCkrKGI/MDp0aGlzLnBvcyl9LHRvVmFsdWU6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy50cmFuc2xhdGUoYS0oYj8wOnRoaXMucG9zKSwhMCwhdGhpcy5ob3JpeixudWxsLCEwKX0sZ2V0UGxvdExpbmVQYXRoOmZ1bmN0aW9uKGEsYixjLGQsZSl7dmFyIGY9dGhpcy5jaGFydCxnPXRoaXMubGVmdCxoPXRoaXMudG9wLGksaixrPWMmJmYub2xkQ2hhcnRIZWlnaHR8fGYuY2hhcnRIZWlnaHQsbD1jJiZmLm9sZENoYXJ0V2lkdGh8fGYuY2hhcnRXaWR0aCxtO2k9dGhpcy50cmFuc0I7dmFyIG89ZnVuY3Rpb24oYSxiLGMpe2lmKGE8Ynx8YT5jKWQ/YT1FKHYoYixhKSxjKTptPSEwO3JldHVybiBhfSxlPXEoZSx0aGlzLnRyYW5zbGF0ZShhLG51bGwsbnVsbCxjKSksYT1jPXkoZStpKTtpPWo9eShrLWUtaSk7aXNOYU4oZSk/bT0hMDp0aGlzLmhvcml6PyhpPWgsaj1rLXRoaXMuYm90dG9tLGE9Yz1vKGEsXG5nLGcrdGhpcy53aWR0aCkpOihhPWcsYz1sLXRoaXMucmlnaHQsaT1qPW8oaSxoLGgrdGhpcy5oZWlnaHQpKTtyZXR1cm4gbSYmIWQ/bnVsbDpmLnJlbmRlcmVyLmNyaXNwTGluZShbXCJNXCIsYSxpLFwiTFwiLGMsal0sYnx8MSl9LGdldExpbmVhclRpY2tQb3NpdGlvbnM6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGU9bmEoVihiL2EpKmEpLGY9bmEoRmEoYy9hKSphKSxnPVtdO2lmKGI9PT1jJiZ1YShiKSlyZXR1cm5bYl07Zm9yKGI9ZTtiPD1mOyl7Zy5wdXNoKGIpO2I9bmEoYithKTtpZihiPT09ZClicmVhaztkPWJ9cmV0dXJuIGd9LGdldE1pbm9yVGlja1Bvc2l0aW9uczpmdW5jdGlvbigpe3ZhciBhPXRoaXMub3B0aW9ucyxiPXRoaXMudGlja1Bvc2l0aW9ucyxjPXRoaXMubWlub3JUaWNrSW50ZXJ2YWwsZD1bXSxlLGY9dGhpcy5wb2ludFJhbmdlUGFkZGluZ3x8MDtlPXRoaXMubWluLWY7dmFyIGY9dGhpcy5tYXgrZixnPWYtZTtpZihnJiZnL2M8dGhpcy5sZW4vMylpZih0aGlzLmlzTG9nKXtmPVxuYi5sZW5ndGg7Zm9yKGU9MTtlPGY7ZSsrKWQ9ZC5jb25jYXQodGhpcy5nZXRMb2dUaWNrUG9zaXRpb25zKGMsYltlLTFdLGJbZV0sITApKX1lbHNlIGlmKHRoaXMuaXNEYXRldGltZUF4aXMmJmEubWlub3JUaWNrSW50ZXJ2YWw9PT1cImF1dG9cIilkPWQuY29uY2F0KHRoaXMuZ2V0VGltZVRpY2tzKHRoaXMubm9ybWFsaXplVGltZVRpY2tJbnRlcnZhbChjKSxlLGYsYS5zdGFydE9mV2VlaykpO2Vsc2UgZm9yKGI9ZSsoYlswXS1lKSVjO2I8PWY7Yis9YylkLnB1c2goYik7ZC5sZW5ndGghPT0wJiZ0aGlzLnRyaW1UaWNrcyhkLGEuc3RhcnRPblRpY2ssYS5lbmRPblRpY2spO3JldHVybiBkfSxhZGp1c3RGb3JNaW5SYW5nZTpmdW5jdGlvbigpe3ZhciBhPXRoaXMub3B0aW9ucyxiPXRoaXMubWluLGM9dGhpcy5tYXgsZCxlPXRoaXMuZGF0YU1heC10aGlzLmRhdGFNaW4+PXRoaXMubWluUmFuZ2UsZixnLGgsaSxqLGs7aWYodGhpcy5pc1hBeGlzJiZ0aGlzLm1pblJhbmdlPT09dCYmIXRoaXMuaXNMb2cpcyhhLm1pbil8fFxucyhhLm1heCk/dGhpcy5taW5SYW5nZT1udWxsOihuKHRoaXMuc2VyaWVzLGZ1bmN0aW9uKGEpe2k9YS54RGF0YTtmb3IoZz1qPWEueEluY3JlbWVudD8xOmkubGVuZ3RoLTE7Zz4wO2ctLSlpZihoPWlbZ10taVtnLTFdLGY9PT10fHxoPGYpZj1ofSksdGhpcy5taW5SYW5nZT1FKGYqNSx0aGlzLmRhdGFNYXgtdGhpcy5kYXRhTWluKSk7aWYoYy1iPHRoaXMubWluUmFuZ2Upe2s9dGhpcy5taW5SYW5nZTtkPShrLWMrYikvMjtkPVtiLWQscShhLm1pbixiLWQpXTtpZihlKWRbMl09dGhpcy5kYXRhTWluO2I9RWEoZCk7Yz1bYitrLHEoYS5tYXgsYitrKV07aWYoZSljWzJdPXRoaXMuZGF0YU1heDtjPU9hKGMpO2MtYjxrJiYoZFswXT1jLWssZFsxXT1xKGEubWluLGMtayksYj1FYShkKSl9dGhpcy5taW49Yjt0aGlzLm1heD1jfSxnZXRDbG9zZXN0OmZ1bmN0aW9uKCl7dmFyIGE7bih0aGlzLnNlcmllcyxmdW5jdGlvbihiKXt2YXIgYz1iLmNsb3Nlc3RQb2ludFJhbmdlOyFiLm5vU2hhcmVkVG9vbHRpcCYmXG5zKGMpJiYoYT1zKGEpP0UoYSxjKTpjKX0pO3JldHVybiBhfSxzZXRBeGlzVHJhbnNsYXRpb246ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcyxjPWIubWF4LWIubWluLGQ9Yi5heGlzUG9pbnRSYW5nZXx8MCxlLGY9MCxnPTAsaD1iLmxpbmtlZFBhcmVudCxpPSEhYi5jYXRlZ29yaWVzLGo9Yi50cmFuc0Esaz1iLmlzWEF4aXM7aWYoa3x8aXx8ZClpZihoPyhmPWgubWluUG9pbnRPZmZzZXQsZz1oLnBvaW50UmFuZ2VQYWRkaW5nKTooZT1iLmdldENsb3Nlc3QoKSxuKGIuc2VyaWVzLGZ1bmN0aW9uKGEpe3ZhciBjPWk/MTprP3EoYS5vcHRpb25zLnBvaW50UmFuZ2UsZSwwKTpiLmF4aXNQb2ludFJhbmdlfHwwLGE9YS5vcHRpb25zLnBvaW50UGxhY2VtZW50O2Q9dihkLGMpO2Iuc2luZ2xlfHwoZj12KGYsRGEoYSk/MDpjLzIpLGc9dihnLGE9PT1cIm9uXCI/MDpjKSl9KSksaD1iLm9yZGluYWxTbG9wZSYmZT9iLm9yZGluYWxTbG9wZS9lOjEsYi5taW5Qb2ludE9mZnNldD1mKj1oLGIucG9pbnRSYW5nZVBhZGRpbmc9XG5nKj1oLGIucG9pbnRSYW5nZT1FKGQsYyksayliLmNsb3Nlc3RQb2ludFJhbmdlPWU7aWYoYSliLm9sZFRyYW5zQT1qO2IudHJhbnNsYXRpb25TbG9wZT1iLnRyYW5zQT1qPWIubGVuLyhjK2d8fDEpO2IudHJhbnNCPWIuaG9yaXo/Yi5sZWZ0OmIuYm90dG9tO2IubWluUGl4ZWxQYWRkaW5nPWoqZn0sbWluRnJvbVJhbmdlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWF4LXRoaXMucmFuZ2V9LHNldFRpY2tJbnRlcnZhbDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLGM9Yi5jaGFydCxkPWIub3B0aW9ucyxlPWIuaXNMb2csZj1iLmxvZzJsaW4sZz1iLmlzRGF0ZXRpbWVBeGlzLGg9Yi5pc1hBeGlzLGk9Yi5pc0xpbmtlZCxqPWQubWF4UGFkZGluZyxrPWQubWluUGFkZGluZyxsPWQudGlja0ludGVydmFsLG09ZC50aWNrUGl4ZWxJbnRlcnZhbCxvPWIuY2F0ZWdvcmllcyxwPWIudGhyZXNob2xkLHI9Yi5zb2Z0VGhyZXNob2xkLEEsUCx1LHc7IWcmJiFvJiYhaSYmdGhpcy5nZXRUaWNrQW1vdW50KCk7XG51PXEoYi51c2VyTWluLGQubWluKTt3PXEoYi51c2VyTWF4LGQubWF4KTtpPyhiLmxpbmtlZFBhcmVudD1jW2IuY29sbF1bZC5saW5rZWRUb10sYz1iLmxpbmtlZFBhcmVudC5nZXRFeHRyZW1lcygpLGIubWluPXEoYy5taW4sYy5kYXRhTWluKSxiLm1heD1xKGMubWF4LGMuZGF0YU1heCksZC50eXBlIT09Yi5saW5rZWRQYXJlbnQub3B0aW9ucy50eXBlJiZnYSgxMSwxKSk6KCFyJiZzKHApJiYoYi5kYXRhTWluPj1wPyhBPXAsaz0wKTpiLmRhdGFNYXg8PXAmJihQPXAsaj0wKSksYi5taW49cSh1LEEsYi5kYXRhTWluKSxiLm1heD1xKHcsUCxiLmRhdGFNYXgpKTtpZihlKSFhJiZFKGIubWluLHEoYi5kYXRhTWluLGIubWluKSk8PTAmJmdhKDEwLDEpLGIubWluPW5hKGYoYi5taW4pLDE1KSxiLm1heD1uYShmKGIubWF4KSwxNSk7aWYoYi5yYW5nZSYmcyhiLm1heCkpYi51c2VyTWluPWIubWluPXU9dihiLm1pbixiLm1pbkZyb21SYW5nZSgpKSxiLnVzZXJNYXg9dz1iLm1heCxiLnJhbmdlPVxubnVsbDtiLmJlZm9yZVBhZGRpbmcmJmIuYmVmb3JlUGFkZGluZygpO2IuYWRqdXN0Rm9yTWluUmFuZ2UoKTtpZighbyYmIWIuYXhpc1BvaW50UmFuZ2UmJiFiLnVzZVBlcmNlbnRhZ2UmJiFpJiZzKGIubWluKSYmcyhiLm1heCkmJihmPWIubWF4LWIubWluKSkhcyh1KSYmayYmKGIubWluLT1mKmspLCFzKHcpJiZqJiYoYi5tYXgrPWYqaik7aWYodWEoZC5mbG9vcikpYi5taW49dihiLm1pbixkLmZsb29yKTtpZih1YShkLmNlaWxpbmcpKWIubWF4PUUoYi5tYXgsZC5jZWlsaW5nKTtpZihyJiZzKGIuZGF0YU1pbikpaWYocD1wfHwwLCFzKHUpJiZiLm1pbjxwJiZiLmRhdGFNaW4+PXApYi5taW49cDtlbHNlIGlmKCFzKHcpJiZiLm1heD5wJiZiLmRhdGFNYXg8PXApYi5tYXg9cDtiLnRpY2tJbnRlcnZhbD1iLm1pbj09PWIubWF4fHxiLm1pbj09PXZvaWQgMHx8Yi5tYXg9PT12b2lkIDA/MTppJiYhbCYmbT09PWIubGlua2VkUGFyZW50Lm9wdGlvbnMudGlja1BpeGVsSW50ZXJ2YWw/bD1iLmxpbmtlZFBhcmVudC50aWNrSW50ZXJ2YWw6XG5xKGwsdGhpcy50aWNrQW1vdW50PyhiLm1heC1iLm1pbikvdih0aGlzLnRpY2tBbW91bnQtMSwxKTp2b2lkIDAsbz8xOihiLm1heC1iLm1pbikqbS92KGIubGVuLG0pKTtoJiYhYSYmbihiLnNlcmllcyxmdW5jdGlvbihhKXthLnByb2Nlc3NEYXRhKGIubWluIT09Yi5vbGRNaW58fGIubWF4IT09Yi5vbGRNYXgpfSk7Yi5zZXRBeGlzVHJhbnNsYXRpb24oITApO2IuYmVmb3JlU2V0VGlja1Bvc2l0aW9ucyYmYi5iZWZvcmVTZXRUaWNrUG9zaXRpb25zKCk7aWYoYi5wb3N0UHJvY2Vzc1RpY2tJbnRlcnZhbCliLnRpY2tJbnRlcnZhbD1iLnBvc3RQcm9jZXNzVGlja0ludGVydmFsKGIudGlja0ludGVydmFsKTtpZihiLnBvaW50UmFuZ2UmJiFsKWIudGlja0ludGVydmFsPXYoYi5wb2ludFJhbmdlLGIudGlja0ludGVydmFsKTthPXEoZC5taW5UaWNrSW50ZXJ2YWwsYi5pc0RhdGV0aW1lQXhpcyYmYi5jbG9zZXN0UG9pbnRSYW5nZSk7aWYoIWwmJmIudGlja0ludGVydmFsPGEpYi50aWNrSW50ZXJ2YWw9XG5hO2lmKCFnJiYhZSYmIWwpYi50aWNrSW50ZXJ2YWw9QmIoYi50aWNrSW50ZXJ2YWwsbnVsbCxBYihiLnRpY2tJbnRlcnZhbCkscShkLmFsbG93RGVjaW1hbHMsIShiLnRpY2tJbnRlcnZhbD4wLjUmJmIudGlja0ludGVydmFsPDUmJmIubWF4PjFFMyYmYi5tYXg8OTk5OSkpLCEhdGhpcy50aWNrQW1vdW50KTtpZighdGhpcy50aWNrQW1vdW50JiZ0aGlzLmxlbiliLnRpY2tJbnRlcnZhbD1iLnVuc3F1aXNoKCk7dGhpcy5zZXRUaWNrUG9zaXRpb25zKCl9LHNldFRpY2tQb3NpdGlvbnM6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9wdGlvbnMsYixjPWEudGlja1Bvc2l0aW9ucyxkPWEudGlja1Bvc2l0aW9uZXIsZT1hLnN0YXJ0T25UaWNrLGY9YS5lbmRPblRpY2ssZzt0aGlzLnRpY2ttYXJrT2Zmc2V0PXRoaXMuY2F0ZWdvcmllcyYmYS50aWNrbWFya1BsYWNlbWVudD09PVwiYmV0d2VlblwiJiZ0aGlzLnRpY2tJbnRlcnZhbD09PTE/MC41OjA7dGhpcy5taW5vclRpY2tJbnRlcnZhbD1hLm1pbm9yVGlja0ludGVydmFsPT09XG5cImF1dG9cIiYmdGhpcy50aWNrSW50ZXJ2YWw/dGhpcy50aWNrSW50ZXJ2YWwvNTphLm1pbm9yVGlja0ludGVydmFsO3RoaXMudGlja1Bvc2l0aW9ucz1iPWMmJmMuc2xpY2UoKTtpZighYiYmKGI9dGhpcy5pc0RhdGV0aW1lQXhpcz90aGlzLmdldFRpbWVUaWNrcyh0aGlzLm5vcm1hbGl6ZVRpbWVUaWNrSW50ZXJ2YWwodGhpcy50aWNrSW50ZXJ2YWwsYS51bml0cyksdGhpcy5taW4sdGhpcy5tYXgsYS5zdGFydE9mV2Vlayx0aGlzLm9yZGluYWxQb3NpdGlvbnMsdGhpcy5jbG9zZXN0UG9pbnRSYW5nZSwhMCk6dGhpcy5pc0xvZz90aGlzLmdldExvZ1RpY2tQb3NpdGlvbnModGhpcy50aWNrSW50ZXJ2YWwsdGhpcy5taW4sdGhpcy5tYXgpOnRoaXMuZ2V0TGluZWFyVGlja1Bvc2l0aW9ucyh0aGlzLnRpY2tJbnRlcnZhbCx0aGlzLm1pbix0aGlzLm1heCksYi5sZW5ndGg+dGhpcy5sZW4mJihiPVtiWzBdLGIucG9wKCldKSx0aGlzLnRpY2tQb3NpdGlvbnM9YixkJiYoZD1kLmFwcGx5KHRoaXMsXG5bdGhpcy5taW4sdGhpcy5tYXhdKSkpKXRoaXMudGlja1Bvc2l0aW9ucz1iPWQ7aWYoIXRoaXMuaXNMaW5rZWQpdGhpcy50cmltVGlja3MoYixlLGYpLHRoaXMubWluPT09dGhpcy5tYXgmJnModGhpcy5taW4pJiYhdGhpcy50aWNrQW1vdW50JiYoZz0hMCx0aGlzLm1pbi09MC41LHRoaXMubWF4Kz0wLjUpLHRoaXMuc2luZ2xlPWcsIWMmJiFkJiZ0aGlzLmFkanVzdFRpY2tBbW91bnQoKX0sdHJpbVRpY2tzOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD1hWzBdLGU9YVthLmxlbmd0aC0xXSxmPXRoaXMubWluUG9pbnRPZmZzZXR8fDA7aWYoYil0aGlzLm1pbj1kO2Vsc2UgZm9yKDt0aGlzLm1pbi1mPmFbMF07KWEuc2hpZnQoKTtpZihjKXRoaXMubWF4PWU7ZWxzZSBmb3IoO3RoaXMubWF4K2Y8YVthLmxlbmd0aC0xXTspYS5wb3AoKTthLmxlbmd0aD09PTAmJnMoZCkmJmEucHVzaCgoZStkKS8yKX0sYWxpZ25Ub090aGVyczpmdW5jdGlvbigpe3ZhciBhPXt9LGIsYz10aGlzLm9wdGlvbnM7dGhpcy5jaGFydC5vcHRpb25zLmNoYXJ0LmFsaWduVGlja3MhPT1cbiExJiZjLmFsaWduVGlja3MhPT0hMSYmbih0aGlzLmNoYXJ0W3RoaXMuY29sbF0sZnVuY3Rpb24oYyl7dmFyIGU9Yy5vcHRpb25zLGU9W2MuaG9yaXo/ZS5sZWZ0OmUudG9wLGUud2lkdGgsZS5oZWlnaHQsZS5wYW5lXS5qb2luKFwiLFwiKTtjLnNlcmllcy5sZW5ndGgmJihhW2VdP2I9ITA6YVtlXT0xKX0pO3JldHVybiBifSxnZXRUaWNrQW1vdW50OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcHRpb25zLGI9YS50aWNrQW1vdW50LGM9YS50aWNrUGl4ZWxJbnRlcnZhbDshcyhhLnRpY2tJbnRlcnZhbCkmJnRoaXMubGVuPGMmJiF0aGlzLmlzUmFkaWFsJiYhdGhpcy5pc0xvZyYmYS5zdGFydE9uVGljayYmYS5lbmRPblRpY2smJihiPTIpOyFiJiZ0aGlzLmFsaWduVG9PdGhlcnMoKSYmKGI9RmEodGhpcy5sZW4vYykrMSk7aWYoYjw0KXRoaXMuZmluYWxUaWNrQW10PWIsYj01O3RoaXMudGlja0Ftb3VudD1ifSxhZGp1c3RUaWNrQW1vdW50OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy50aWNrSW50ZXJ2YWwsXG5iPXRoaXMudGlja1Bvc2l0aW9ucyxjPXRoaXMudGlja0Ftb3VudCxkPXRoaXMuZmluYWxUaWNrQW10LGU9YiYmYi5sZW5ndGg7aWYoZTxjKXtmb3IoO2IubGVuZ3RoPGM7KWIucHVzaChuYShiW2IubGVuZ3RoLTFdK2EpKTt0aGlzLnRyYW5zQSo9KGUtMSkvKGMtMSk7dGhpcy5tYXg9YltiLmxlbmd0aC0xXX1lbHNlIGU+YyYmKHRoaXMudGlja0ludGVydmFsKj0yLHRoaXMuc2V0VGlja1Bvc2l0aW9ucygpKTtpZihzKGQpKXtmb3IoYT1jPWIubGVuZ3RoO2EtLTspKGQ9PT0zJiZhJTI9PT0xfHxkPD0yJiZhPjAmJmE8Yy0xKSYmYi5zcGxpY2UoYSwxKTt0aGlzLmZpbmFsVGlja0FtdD10fX0sc2V0U2NhbGU6ZnVuY3Rpb24oKXt2YXIgYSxiO3RoaXMub2xkTWluPXRoaXMubWluO3RoaXMub2xkTWF4PXRoaXMubWF4O3RoaXMub2xkQXhpc0xlbmd0aD10aGlzLmxlbjt0aGlzLnNldEF4aXNTaXplKCk7Yj10aGlzLmxlbiE9PXRoaXMub2xkQXhpc0xlbmd0aDtuKHRoaXMuc2VyaWVzLGZ1bmN0aW9uKGIpe2lmKGIuaXNEaXJ0eURhdGF8fFxuYi5pc0RpcnR5fHxiLnhBeGlzLmlzRGlydHkpYT0hMH0pO2lmKGJ8fGF8fHRoaXMuaXNMaW5rZWR8fHRoaXMuZm9yY2VSZWRyYXd8fHRoaXMudXNlck1pbiE9PXRoaXMub2xkVXNlck1pbnx8dGhpcy51c2VyTWF4IT09dGhpcy5vbGRVc2VyTWF4fHx0aGlzLmFsaWduVG9PdGhlcnMoKSl7aWYodGhpcy5yZXNldFN0YWNrcyYmdGhpcy5yZXNldFN0YWNrcygpLHRoaXMuZm9yY2VSZWRyYXc9ITEsdGhpcy5nZXRTZXJpZXNFeHRyZW1lcygpLHRoaXMuc2V0VGlja0ludGVydmFsKCksdGhpcy5vbGRVc2VyTWluPXRoaXMudXNlck1pbix0aGlzLm9sZFVzZXJNYXg9dGhpcy51c2VyTWF4LCF0aGlzLmlzRGlydHkpdGhpcy5pc0RpcnR5PWJ8fHRoaXMubWluIT09dGhpcy5vbGRNaW58fHRoaXMubWF4IT09dGhpcy5vbGRNYXh9ZWxzZSB0aGlzLmNsZWFuU3RhY2tzJiZ0aGlzLmNsZWFuU3RhY2tzKCl9LHNldEV4dHJlbWVzOmZ1bmN0aW9uKGEsYixjLGQsZSl7dmFyIGY9dGhpcyxnPWYuY2hhcnQsXG5jPXEoYywhMCk7bihmLnNlcmllcyxmdW5jdGlvbihhKXtkZWxldGUgYS5rZFRyZWV9KTtlPXgoZSx7bWluOmEsbWF4OmJ9KTtNKGYsXCJzZXRFeHRyZW1lc1wiLGUsZnVuY3Rpb24oKXtmLnVzZXJNaW49YTtmLnVzZXJNYXg9YjtmLmV2ZW50QXJncz1lO2MmJmcucmVkcmF3KGQpfSl9LHpvb206ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmRhdGFNaW4sZD10aGlzLmRhdGFNYXgsZT10aGlzLm9wdGlvbnMsZj1FKGMscShlLm1pbixjKSksZT12KGQscShlLm1heCxkKSk7dGhpcy5hbGxvd1pvb21PdXRzaWRlfHwocyhjKSYmYTw9ZiYmKGE9ZikscyhkKSYmYj49ZSYmKGI9ZSkpO3RoaXMuZGlzcGxheUJ0bj1hIT09dHx8YiE9PXQ7dGhpcy5zZXRFeHRyZW1lcyhhLGIsITEsdCx7dHJpZ2dlcjpcInpvb21cIn0pO3JldHVybiEwfSxzZXRBeGlzU2l6ZTpmdW5jdGlvbigpe3ZhciBhPXRoaXMuY2hhcnQsYj10aGlzLm9wdGlvbnMsYz1iLm9mZnNldExlZnR8fDAsZD10aGlzLmhvcml6LGU9cShiLndpZHRoLFxuYS5wbG90V2lkdGgtYysoYi5vZmZzZXRSaWdodHx8MCkpLGY9cShiLmhlaWdodCxhLnBsb3RIZWlnaHQpLGc9cShiLnRvcCxhLnBsb3RUb3ApLGI9cShiLmxlZnQsYS5wbG90TGVmdCtjKSxjPS8lJC87Yy50ZXN0KGYpJiYoZj1NYXRoLnJvdW5kKHBhcnNlRmxvYXQoZikvMTAwKmEucGxvdEhlaWdodCkpO2MudGVzdChnKSYmKGc9TWF0aC5yb3VuZChwYXJzZUZsb2F0KGcpLzEwMCphLnBsb3RIZWlnaHQrYS5wbG90VG9wKSk7dGhpcy5sZWZ0PWI7dGhpcy50b3A9Zzt0aGlzLndpZHRoPWU7dGhpcy5oZWlnaHQ9Zjt0aGlzLmJvdHRvbT1hLmNoYXJ0SGVpZ2h0LWYtZzt0aGlzLnJpZ2h0PWEuY2hhcnRXaWR0aC1lLWI7dGhpcy5sZW49dihkP2U6ZiwwKTt0aGlzLnBvcz1kP2I6Z30sZ2V0RXh0cmVtZXM6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmlzTG9nLGI9dGhpcy5saW4ybG9nO3JldHVybnttaW46YT9uYShiKHRoaXMubWluKSk6dGhpcy5taW4sbWF4OmE/bmEoYih0aGlzLm1heCkpOnRoaXMubWF4LFxuZGF0YU1pbjp0aGlzLmRhdGFNaW4sZGF0YU1heDp0aGlzLmRhdGFNYXgsdXNlck1pbjp0aGlzLnVzZXJNaW4sdXNlck1heDp0aGlzLnVzZXJNYXh9fSxnZXRUaHJlc2hvbGQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5pc0xvZyxjPXRoaXMubGluMmxvZyxkPWI/Yyh0aGlzLm1pbik6dGhpcy5taW4sYj1iP2ModGhpcy5tYXgpOnRoaXMubWF4O2E9PT1udWxsP2E9YjwwP2I6ZDpkPmE/YT1kOmI8YSYmKGE9Yik7cmV0dXJuIHRoaXMudHJhbnNsYXRlKGEsMCwxLDAsMSl9LGF1dG9MYWJlbEFsaWduOmZ1bmN0aW9uKGEpe2E9KHEoYSwwKS10aGlzLnNpZGUqOTArNzIwKSUzNjA7cmV0dXJuIGE+MTUmJmE8MTY1P1wicmlnaHRcIjphPjE5NSYmYTwzNDU/XCJsZWZ0XCI6XCJjZW50ZXJcIn0sdGlja1NpemU6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5vcHRpb25zLGM9YlthK1wiTGVuZ3RoXCJdLGQ9cShiW2ErXCJXaWR0aFwiXSxhPT09XCJ0aWNrXCImJnRoaXMuaXNYQXhpcz8xOjApO2lmKGQmJmMpcmV0dXJuIGJbYStcblwiUG9zaXRpb25cIl09PT1cImluc2lkZVwiJiYoYz0tYyksW2MsZF19LGxhYmVsTWV0cmljczpmdW5jdGlvbigpe3JldHVybiB0aGlzLmNoYXJ0LnJlbmRlcmVyLmZvbnRNZXRyaWNzKHRoaXMub3B0aW9ucy5sYWJlbHMuc3R5bGUuZm9udFNpemUsdGhpcy50aWNrc1swXSYmdGhpcy50aWNrc1swXS5sYWJlbCl9LHVuc3F1aXNoOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcHRpb25zLmxhYmVscyxiPXRoaXMuaG9yaXosYz10aGlzLnRpY2tJbnRlcnZhbCxkPWMsZT10aGlzLmxlbi8oKCh0aGlzLmNhdGVnb3JpZXM/MTowKSt0aGlzLm1heC10aGlzLm1pbikvYyksZixnPWEucm90YXRpb24saD10aGlzLmxhYmVsTWV0cmljcygpLGksaj1OdW1iZXIuTUFYX1ZBTFVFLGssbD1mdW5jdGlvbihhKXthLz1lfHwxO2E9YT4xP0ZhKGEpOjE7cmV0dXJuIGEqY307Yj8oaz0hYS5zdGFnZ2VyTGluZXMmJiFhLnN0ZXAmJihzKGcpP1tnXTplPHEoYS5hdXRvUm90YXRpb25MaW1pdCw4MCkmJmEuYXV0b1JvdGF0aW9uKSkmJlxubihrLGZ1bmN0aW9uKGEpe3ZhciBiO2lmKGE9PT1nfHxhJiZhPj0tOTAmJmE8PTkwKWk9bChTKGguaC9rYShwYSphKSkpLGI9aStTKGEvMzYwKSxiPGomJihqPWIsZj1hLGQ9aSl9KTphLnN0ZXB8fChkPWwoaC5oKSk7dGhpcy5hdXRvUm90YXRpb249azt0aGlzLmxhYmVsUm90YXRpb249cShmLGcpO3JldHVybiBkfSxnZXRTbG90V2lkdGg6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmNoYXJ0LGI9dGhpcy5ob3JpeixjPXRoaXMub3B0aW9ucy5sYWJlbHMsZD1NYXRoLm1heCh0aGlzLnRpY2tQb3NpdGlvbnMubGVuZ3RoLSh0aGlzLmNhdGVnb3JpZXM/MDoxKSwxKSxlPWEubWFyZ2luWzNdO3JldHVybiBiJiYoYy5zdGVwfHwwKTwyJiYhYy5yb3RhdGlvbiYmKHRoaXMuc3RhZ2dlckxpbmVzfHwxKSphLnBsb3RXaWR0aC9kfHwhYiYmKGUmJmUtYS5zcGFjaW5nWzNdfHxhLmNoYXJ0V2lkdGgqMC4zMyl9LHJlbmRlclVuc3F1aXNoOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5jaGFydCxiPWEucmVuZGVyZXIsXG5jPXRoaXMudGlja1Bvc2l0aW9ucyxkPXRoaXMudGlja3MsZT10aGlzLm9wdGlvbnMubGFiZWxzLGY9dGhpcy5ob3JpeixnPXRoaXMuZ2V0U2xvdFdpZHRoKCksaD12KDEseShnLTIqKGUucGFkZGluZ3x8NSkpKSxpPXt9LGo9dGhpcy5sYWJlbE1ldHJpY3MoKSxrPWUuc3R5bGUudGV4dE92ZXJmbG93LGwsbT0wLG8scDtpZighRGEoZS5yb3RhdGlvbikpaS5yb3RhdGlvbj1lLnJvdGF0aW9ufHwwO2lmKHRoaXMuYXV0b1JvdGF0aW9uKW4oYyxmdW5jdGlvbihhKXtpZigoYT1kW2FdKSYmYS5sYWJlbExlbmd0aD5tKW09YS5sYWJlbExlbmd0aH0pLG0+aCYmbT5qLmg/aS5yb3RhdGlvbj10aGlzLmxhYmVsUm90YXRpb246dGhpcy5sYWJlbFJvdGF0aW9uPTA7ZWxzZSBpZihnJiYobD17d2lkdGg6aCtcInB4XCJ9LCFrKSl7bC50ZXh0T3ZlcmZsb3c9XCJjbGlwXCI7Zm9yKG89Yy5sZW5ndGg7IWYmJm8tLTspaWYocD1jW29dLGg9ZFtwXS5sYWJlbClpZihoLnN0eWxlcy50ZXh0T3ZlcmZsb3c9PT1cImVsbGlwc2lzXCI/XG5oLmNzcyh7dGV4dE92ZXJmbG93OlwiY2xpcFwifSk6ZFtwXS5sYWJlbExlbmd0aD5nJiZoLmNzcyh7d2lkdGg6ZytcInB4XCJ9KSxoLmdldEJCb3goKS5oZWlnaHQ+dGhpcy5sZW4vYy5sZW5ndGgtKGouaC1qLmYpKWguc3BlY0Nzcz17dGV4dE92ZXJmbG93OlwiZWxsaXBzaXNcIn19aWYoaS5yb3RhdGlvbiYmKGw9e3dpZHRoOihtPmEuY2hhcnRIZWlnaHQqMC41P2EuY2hhcnRIZWlnaHQqMC4zMzphLmNoYXJ0SGVpZ2h0KStcInB4XCJ9LCFrKSlsLnRleHRPdmVyZmxvdz1cImVsbGlwc2lzXCI7aWYodGhpcy5sYWJlbEFsaWduPWUuYWxpZ258fHRoaXMuYXV0b0xhYmVsQWxpZ24odGhpcy5sYWJlbFJvdGF0aW9uKSlpLmFsaWduPXRoaXMubGFiZWxBbGlnbjtuKGMsZnVuY3Rpb24oYSl7dmFyIGI9KGE9ZFthXSkmJmEubGFiZWw7aWYoYiliLmF0dHIoaSksbCYmYi5jc3MoQyhsLGIuc3BlY0NzcykpLGRlbGV0ZSBiLnNwZWNDc3MsYS5yb3RhdGlvbj1pLnJvdGF0aW9ufSk7dGhpcy50aWNrUm90Q29ycj1iLnJvdENvcnIoai5iLFxudGhpcy5sYWJlbFJvdGF0aW9ufHwwLHRoaXMuc2lkZSE9PTApfSxoYXNEYXRhOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaGFzVmlzaWJsZVNlcmllc3x8cyh0aGlzLm1pbikmJnModGhpcy5tYXgpJiYhIXRoaXMudGlja1Bvc2l0aW9uc30sZ2V0T2Zmc2V0OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEuY2hhcnQsYz1iLnJlbmRlcmVyLGQ9YS5vcHRpb25zLGU9YS50aWNrUG9zaXRpb25zLGY9YS50aWNrcyxnPWEuaG9yaXosaD1hLnNpZGUsaT1iLmludmVydGVkP1sxLDAsMywyXVtoXTpoLGosayxsPTAsbSxvPTAscD1kLnRpdGxlLHI9ZC5sYWJlbHMsQT0wLFA9YS5vcHBvc2l0ZSx1PWIuYXhpc09mZnNldCxiPWIuY2xpcE9mZnNldCx3PVstMSwxLDEsLTFdW2hdLE8sUj1hLmF4aXNQYXJlbnQsaGE9dGhpcy50aWNrU2l6ZShcInRpY2tcIik7aj1hLmhhc0RhdGEoKTthLnNob3dBeGlzPWs9anx8cShkLnNob3dFbXB0eSwhMCk7YS5zdGFnZ2VyTGluZXM9YS5ob3JpeiYmci5zdGFnZ2VyTGluZXM7XG5pZighYS5heGlzR3JvdXApYS5ncmlkR3JvdXA9Yy5nKFwiZ3JpZFwiKS5hdHRyKHt6SW5kZXg6ZC5ncmlkWkluZGV4fHwxfSkuYWRkKFIpLGEuYXhpc0dyb3VwPWMuZyhcImF4aXNcIikuYXR0cih7ekluZGV4OmQuekluZGV4fHwyfSkuYWRkKFIpLGEubGFiZWxHcm91cD1jLmcoXCJheGlzLWxhYmVsc1wiKS5hdHRyKHt6SW5kZXg6ci56SW5kZXh8fDd9KS5hZGRDbGFzcyhcImhpZ2hjaGFydHMtXCIrYS5jb2xsLnRvTG93ZXJDYXNlKCkrXCItbGFiZWxzXCIpLmFkZChSKTtpZihqfHxhLmlzTGlua2VkKXtpZihuKGUsZnVuY3Rpb24oYil7ZltiXT9mW2JdLmFkZExhYmVsKCk6ZltiXT1uZXcgY2IoYSxiKX0pLGEucmVuZGVyVW5zcXVpc2goKSxyLnJlc2VydmVTcGFjZSE9PSExJiYoaD09PTB8fGg9PT0yfHx7MTpcImxlZnRcIiwzOlwicmlnaHRcIn1baF09PT1hLmxhYmVsQWxpZ258fGEubGFiZWxBbGlnbj09PVwiY2VudGVyXCIpJiZuKGUsZnVuY3Rpb24oYSl7QT12KGZbYV0uZ2V0TGFiZWxTaXplKCksQSl9KSxhLnN0YWdnZXJMaW5lcylBKj1cbmEuc3RhZ2dlckxpbmVzLGEubGFiZWxPZmZzZXQ9QSooYS5vcHBvc2l0ZT8tMToxKX1lbHNlIGZvcihPIGluIGYpZltPXS5kZXN0cm95KCksZGVsZXRlIGZbT107aWYocCYmcC50ZXh0JiZwLmVuYWJsZWQhPT0hMSl7aWYoIWEuYXhpc1RpdGxlKWEuYXhpc1RpdGxlPWMudGV4dChwLnRleHQsMCwwLHAudXNlSFRNTCkuYXR0cih7ekluZGV4Ojcscm90YXRpb246cC5yb3RhdGlvbnx8MCxhbGlnbjpwLnRleHRBbGlnbnx8e2xvdzpQP1wicmlnaHRcIjpcImxlZnRcIixtaWRkbGU6XCJjZW50ZXJcIixoaWdoOlA/XCJsZWZ0XCI6XCJyaWdodFwifVtwLmFsaWduXX0pLmFkZENsYXNzKFwiaGlnaGNoYXJ0cy1cIit0aGlzLmNvbGwudG9Mb3dlckNhc2UoKStcIi10aXRsZVwiKS5jc3MocC5zdHlsZSkuYWRkKGEuYXhpc0dyb3VwKSxhLmF4aXNUaXRsZS5pc05ldz0hMDtpZihrKWw9YS5heGlzVGl0bGUuZ2V0QkJveCgpW2c/XCJoZWlnaHRcIjpcIndpZHRoXCJdLG09cC5vZmZzZXQsbz1zKG0pPzA6cShwLm1hcmdpbixnPzU6MTApO1xuYS5heGlzVGl0bGVbaz9cInNob3dcIjpcImhpZGVcIl0oITApfWEub2Zmc2V0PXcqcShkLm9mZnNldCx1W2hdKTthLnRpY2tSb3RDb3JyPWEudGlja1JvdENvcnJ8fHt4OjAseTowfTtjPWg9PT0wPy1hLmxhYmVsTWV0cmljcygpLmg6aD09PTI/YS50aWNrUm90Q29yci55OjA7bz1NYXRoLmFicyhBKStvO0EmJihvLT1jLG8rPXcqKGc/cShyLnksYS50aWNrUm90Q29yci55K3cqOCk6ci54KSk7YS5heGlzVGl0bGVNYXJnaW49cShtLG8pO3VbaF09dih1W2hdLGEuYXhpc1RpdGxlTWFyZ2luK2wrdyphLm9mZnNldCxvLGomJmUubGVuZ3RoJiZoYT9oYVswXTowKTtkPWQub2Zmc2V0PzA6VihkLmxpbmVXaWR0aC8yKSoyO2JbaV09dihiW2ldLGQpfSxnZXRMaW5lUGF0aDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNoYXJ0LGM9dGhpcy5vcHBvc2l0ZSxkPXRoaXMub2Zmc2V0LGU9dGhpcy5ob3JpeixmPXRoaXMubGVmdCsoYz90aGlzLndpZHRoOjApK2QsZD1iLmNoYXJ0SGVpZ2h0LXRoaXMuYm90dG9tLVxuKGM/dGhpcy5oZWlnaHQ6MCkrZDtjJiYoYSo9LTEpO3JldHVybiBiLnJlbmRlcmVyLmNyaXNwTGluZShbXCJNXCIsZT90aGlzLmxlZnQ6ZixlP2Q6dGhpcy50b3AsXCJMXCIsZT9iLmNoYXJ0V2lkdGgtdGhpcy5yaWdodDpmLGU/ZDpiLmNoYXJ0SGVpZ2h0LXRoaXMuYm90dG9tXSxhKX0sZ2V0VGl0bGVQb3NpdGlvbjpmdW5jdGlvbigpe3ZhciBhPXRoaXMuaG9yaXosYj10aGlzLmxlZnQsYz10aGlzLnRvcCxkPXRoaXMubGVuLGU9dGhpcy5vcHRpb25zLnRpdGxlLGY9YT9iOmMsZz10aGlzLm9wcG9zaXRlLGg9dGhpcy5vZmZzZXQsaT1lLnh8fDAsaj1lLnl8fDAsaz1HKGUuc3R5bGUuZm9udFNpemV8fDEyKSxkPXtsb3c6ZisoYT8wOmQpLG1pZGRsZTpmK2QvMixoaWdoOmYrKGE/ZDowKX1bZS5hbGlnbl0sYj0oYT9jK3RoaXMuaGVpZ2h0OmIpKyhhPzE6LTEpKihnPy0xOjEpKnRoaXMuYXhpc1RpdGxlTWFyZ2luKyh0aGlzLnNpZGU9PT0yP2s6MCk7cmV0dXJue3g6YT9kK2k6YisoZz90aGlzLndpZHRoOlxuMCkraCtpLHk6YT9iK2otKGc/dGhpcy5oZWlnaHQ6MCkraDpkK2p9fSxyZW5kZXI6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5jaGFydCxjPWIucmVuZGVyZXIsZD1hLm9wdGlvbnMsZT1hLmlzTG9nLGY9YS5saW4ybG9nLGc9YS5pc0xpbmtlZCxoPWEudGlja1Bvc2l0aW9ucyxpPWEuYXhpc1RpdGxlLGo9YS50aWNrcyxrPWEubWlub3JUaWNrcyxsPWEuYWx0ZXJuYXRlQmFuZHMsbT1kLnN0YWNrTGFiZWxzLG89ZC5hbHRlcm5hdGVHcmlkQ29sb3IscD1hLnRpY2ttYXJrT2Zmc2V0LHI9ZC5saW5lV2lkdGgsQSxxPWIuaGFzUmVuZGVyZWQmJnMoYS5vbGRNaW4pJiYhaXNOYU4oYS5vbGRNaW4pLHU9YS5zaG93QXhpcyx3PWhiKGMuZ2xvYmFsQW5pbWF0aW9uKSxPLFI7YS5sYWJlbEVkZ2UubGVuZ3RoPTA7YS5vdmVybGFwPSExO24oW2osayxsXSxmdW5jdGlvbihhKXtmb3IodmFyIGIgaW4gYSlhW2JdLmlzQWN0aXZlPSExfSk7aWYoYS5oYXNEYXRhKCl8fGcpe2EubWlub3JUaWNrSW50ZXJ2YWwmJlxuIWEuY2F0ZWdvcmllcyYmbihhLmdldE1pbm9yVGlja1Bvc2l0aW9ucygpLGZ1bmN0aW9uKGIpe2tbYl18fChrW2JdPW5ldyBjYihhLGIsXCJtaW5vclwiKSk7cSYma1tiXS5pc05ldyYma1tiXS5yZW5kZXIobnVsbCwhMCk7a1tiXS5yZW5kZXIobnVsbCwhMSwxKX0pO2lmKGgubGVuZ3RoJiYobihoLGZ1bmN0aW9uKGIsYyl7aWYoIWd8fGI+PWEubWluJiZiPD1hLm1heClqW2JdfHwoaltiXT1uZXcgY2IoYSxiKSkscSYmaltiXS5pc05ldyYmaltiXS5yZW5kZXIoYywhMCwwLjEpLGpbYl0ucmVuZGVyKGMpfSkscCYmKGEubWluPT09MHx8YS5zaW5nbGUpKSlqWy0xXXx8KGpbLTFdPW5ldyBjYihhLC0xLG51bGwsITApKSxqWy0xXS5yZW5kZXIoLTEpO28mJm4oaCxmdW5jdGlvbihjLGQpe1I9aFtkKzFdIT09dD9oW2QrMV0rcDphLm1heC1wO2lmKGQlMj09PTAmJmM8YS5tYXgmJlI8PWEubWF4KyhiLnBvbGFyPy1wOnApKWxbY118fChsW2NdPW5ldyB6LlBsb3RMaW5lT3JCYW5kKGEpKSxPPWMrXG5wLGxbY10ub3B0aW9ucz17ZnJvbTplP2YoTyk6Tyx0bzplP2YoUik6Uixjb2xvcjpvfSxsW2NdLnJlbmRlcigpLGxbY10uaXNBY3RpdmU9ITB9KTtpZighYS5fYWRkZWRQbG90TEIpbigoZC5wbG90TGluZXN8fFtdKS5jb25jYXQoZC5wbG90QmFuZHN8fFtdKSxmdW5jdGlvbihiKXthLmFkZFBsb3RCYW5kT3JMaW5lKGIpfSksYS5fYWRkZWRQbG90TEI9ITB9bihbaixrLGxdLGZ1bmN0aW9uKGEpe3ZhciBjLGQsZT1bXSxmPXcuZHVyYXRpb247Zm9yKGMgaW4gYSlpZighYVtjXS5pc0FjdGl2ZSlhW2NdLnJlbmRlcihjLCExLDApLGFbY10uaXNBY3RpdmU9ITEsZS5wdXNoKGMpOyRhKGZ1bmN0aW9uKCl7Zm9yKGQ9ZS5sZW5ndGg7ZC0tOylhW2VbZF1dJiYhYVtlW2RdXS5pc0FjdGl2ZSYmKGFbZVtkXV0uZGVzdHJveSgpLGRlbGV0ZSBhW2VbZF1dKX0sYT09PWx8fCFiLmhhc1JlbmRlcmVkfHwhZj8wOmYpfSk7aWYocilBPWEuZ2V0TGluZVBhdGgociksYS5heGlzTGluZT9hLmF4aXNMaW5lLmFuaW1hdGUoe2Q6QX0pOlxuYS5heGlzTGluZT1jLnBhdGgoQSkuYXR0cih7c3Ryb2tlOmQubGluZUNvbG9yLFwic3Ryb2tlLXdpZHRoXCI6cix6SW5kZXg6N30pLmFkZChhLmF4aXNHcm91cCksYS5heGlzTGluZVt1P1wic2hvd1wiOlwiaGlkZVwiXSghMCk7aWYoaSYmdSlpW2kuaXNOZXc/XCJhdHRyXCI6XCJhbmltYXRlXCJdKGEuZ2V0VGl0bGVQb3NpdGlvbigpKSxpLmlzTmV3PSExO20mJm0uZW5hYmxlZCYmYS5yZW5kZXJTdGFja1RvdGFscygpO2EuaXNEaXJ0eT0hMX0scmVkcmF3OmZ1bmN0aW9uKCl7dGhpcy52aXNpYmxlJiYodGhpcy5yZW5kZXIoKSxuKHRoaXMucGxvdExpbmVzQW5kQmFuZHMsZnVuY3Rpb24oYSl7YS5yZW5kZXIoKX0pKTtuKHRoaXMuc2VyaWVzLGZ1bmN0aW9uKGEpe2EuaXNEaXJ0eT0hMH0pfSxkZXN0cm95OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMsYz1iLnN0YWNrcyxkLGU9Yi5wbG90TGluZXNBbmRCYW5kczthfHxUKGIpO2ZvcihkIGluIGMpUGEoY1tkXSksY1tkXT1udWxsO24oW2IudGlja3MsYi5taW5vclRpY2tzLFxuYi5hbHRlcm5hdGVCYW5kc10sZnVuY3Rpb24oYSl7UGEoYSl9KTtmb3IoYT1lLmxlbmd0aDthLS07KWVbYV0uZGVzdHJveSgpO24oXCJzdGFja1RvdGFsR3JvdXAsYXhpc0xpbmUsYXhpc1RpdGxlLGF4aXNHcm91cCxjcm9zcyxncmlkR3JvdXAsbGFiZWxHcm91cFwiLnNwbGl0KFwiLFwiKSxmdW5jdGlvbihhKXtiW2FdJiYoYlthXT1iW2FdLmRlc3Ryb3koKSl9KTt0aGlzLmNyb3NzJiZ0aGlzLmNyb3NzLmRlc3Ryb3koKX0sZHJhd0Nyb3NzaGFpcjpmdW5jdGlvbihhLGIpe3ZhciBjLGQ9dGhpcy5jcm9zc2hhaXIsZSxmO2lmKCF0aGlzLmNyb3NzaGFpcnx8KHMoYil8fCFxKGQuc25hcCwhMCkpPT09ITEpdGhpcy5oaWRlQ3Jvc3NoYWlyKCk7ZWxzZSBpZihxKGQuc25hcCwhMCk/cyhiKSYmKGM9dGhpcy5pc1hBeGlzP2IucGxvdFg6dGhpcy5sZW4tYi5wbG90WSk6Yz10aGlzLmhvcml6P2EuY2hhcnRYLXRoaXMucG9zOnRoaXMubGVuLWEuY2hhcnRZK3RoaXMucG9zLGM9dGhpcy5pc1JhZGlhbD9cbnRoaXMuZ2V0UGxvdExpbmVQYXRoKHRoaXMuaXNYQXhpcz9iLng6cShiLnN0YWNrWSxiLnkpKXx8bnVsbDp0aGlzLmdldFBsb3RMaW5lUGF0aChudWxsLG51bGwsbnVsbCxudWxsLGMpfHxudWxsLGM9PT1udWxsKXRoaXMuaGlkZUNyb3NzaGFpcigpO2Vsc2UgaWYoZT10aGlzLmNhdGVnb3JpZXMmJiF0aGlzLmlzUmFkaWFsLGY9cShkLndpZHRoLGU/dGhpcy50cmFuc0E6MSksdGhpcy5jcm9zcyl0aGlzLmNyb3NzLmF0dHIoe2Q6Yyx2aXNpYmlsaXR5OlwidmlzaWJsZVwiLFwic3Ryb2tlLXdpZHRoXCI6Zn0pO2Vsc2V7ZT17XCJzdHJva2Utd2lkdGhcIjpmLHN0cm9rZTpkLmNvbG9yfHwoZT9cInJnYmEoMTU1LDIwMCwyNTUsMC4yKVwiOlwiI0MwQzBDMFwiKSx6SW5kZXg6cShkLnpJbmRleCwyKX07aWYoZC5kYXNoU3R5bGUpZS5kYXNoc3R5bGU9ZC5kYXNoU3R5bGU7dGhpcy5jcm9zcz10aGlzLmNoYXJ0LnJlbmRlcmVyLnBhdGgoYykuYXR0cihlKS5hZGQoKX19LGhpZGVDcm9zc2hhaXI6ZnVuY3Rpb24oKXt0aGlzLmNyb3NzJiZcbnRoaXMuY3Jvc3MuaGlkZSgpfX07eChJLnByb3RvdHlwZSx7Z2V0UGxvdEJhbmRQYXRoOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5nZXRQbG90TGluZVBhdGgoYixudWxsLG51bGwsITApLGQ9dGhpcy5nZXRQbG90TGluZVBhdGgoYSxudWxsLG51bGwsITApO2QmJmM/KGQuZmxhdD1kLnRvU3RyaW5nKCk9PT1jLnRvU3RyaW5nKCksZC5wdXNoKGNbNF0sY1s1XSxjWzFdLGNbMl0pKTpkPW51bGw7cmV0dXJuIGR9LGFkZFBsb3RCYW5kOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmFkZFBsb3RCYW5kT3JMaW5lKGEsXCJwbG90QmFuZHNcIil9LGFkZFBsb3RMaW5lOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmFkZFBsb3RCYW5kT3JMaW5lKGEsXCJwbG90TGluZXNcIil9LGFkZFBsb3RCYW5kT3JMaW5lOmZ1bmN0aW9uKGEsYil7dmFyIGM9KG5ldyB6LlBsb3RMaW5lT3JCYW5kKHRoaXMsYSkpLnJlbmRlcigpLGQ9dGhpcy51c2VyT3B0aW9ucztjJiYoYiYmKGRbYl09ZFtiXXx8W10sZFtiXS5wdXNoKGEpKSxcbnRoaXMucGxvdExpbmVzQW5kQmFuZHMucHVzaChjKSk7cmV0dXJuIGN9LHJlbW92ZVBsb3RCYW5kT3JMaW5lOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj10aGlzLnBsb3RMaW5lc0FuZEJhbmRzLGM9dGhpcy5vcHRpb25zLGQ9dGhpcy51c2VyT3B0aW9ucyxlPWIubGVuZ3RoO2UtLTspYltlXS5pZD09PWEmJmJbZV0uZGVzdHJveSgpO24oW2MucGxvdExpbmVzfHxbXSxkLnBsb3RMaW5lc3x8W10sYy5wbG90QmFuZHN8fFtdLGQucGxvdEJhbmRzfHxbXV0sZnVuY3Rpb24oYil7Zm9yKGU9Yi5sZW5ndGg7ZS0tOyliW2VdLmlkPT09YSYmQWEoYixiW2VdKX0pfX0pO0kucHJvdG90eXBlLmdldFRpbWVUaWNrcz1mdW5jdGlvbihhLGIsYyxkKXt2YXIgZT1bXSxmPXt9LGc9Ti5nbG9iYWwudXNlVVRDLGgsaT1uZXcgZmEoYi1mYihiKSksaj1hLnVuaXRSYW5nZSxrPWEuY291bnQ7aWYocyhiKSl7aVtQYl0oaj49SC5zZWNvbmQ/MDprKlYoaS5nZXRNaWxsaXNlY29uZHMoKS9rKSk7aWYoaj49SC5zZWNvbmQpaVtRYl0oaj49XG5ILm1pbnV0ZT8wOmsqVihpLmdldFNlY29uZHMoKS9rKSk7aWYoaj49SC5taW51dGUpaVtSYl0oaj49SC5ob3VyPzA6aypWKGlbQ2JdKCkvaykpO2lmKGo+PUguaG91cilpW1NiXShqPj1ILmRheT8wOmsqVihpW0RiXSgpL2spKTtpZihqPj1ILmRheSlpW3JiXShqPj1ILm1vbnRoPzE6aypWKGlbYmJdKCkvaykpO2o+PUgubW9udGgmJihpW0ZiXShqPj1ILnllYXI/MDprKlYoaVtpYl0oKS9rKSksaD1pW2piXSgpKTtqPj1ILnllYXImJihoLT1oJWssaVtHYl0oaCkpO2lmKGo9PT1ILndlZWspaVtyYl0oaVtiYl0oKS1pW0ViXSgpK3EoZCwxKSk7Yj0xO2lmKHpifHxnYilpPWkuZ2V0VGltZSgpLGk9bmV3IGZhKGkrZmIoaSkpO2g9aVtqYl0oKTtmb3IodmFyIGQ9aS5nZXRUaW1lKCksbD1pW2liXSgpLG09aVtiYl0oKSxvPSFnfHwhIWdiLHA9KEguZGF5KyhnP2ZiKGkpOmkuZ2V0VGltZXpvbmVPZmZzZXQoKSo2RTQpKSVILmRheTtkPGM7KWUucHVzaChkKSxqPT09SC55ZWFyP2Q9cWIoaCtcbmIqaywwKTpqPT09SC5tb250aD9kPXFiKGgsbCtiKmspOm8mJihqPT09SC5kYXl8fGo9PT1ILndlZWspP2Q9cWIoaCxsLG0rYiprKihqPT09SC5kYXk/MTo3KSk6ZCs9aiprLGIrKztlLnB1c2goZCk7bihTYShlLGZ1bmN0aW9uKGEpe3JldHVybiBqPD1ILmhvdXImJmElSC5kYXk9PT1wfSksZnVuY3Rpb24oYSl7ZlthXT1cImRheVwifSl9ZS5pbmZvPXgoYSx7aGlnaGVyUmFua3M6Zix0b3RhbFJhbmdlOmoqa30pO3JldHVybiBlfTtJLnByb3RvdHlwZS5ub3JtYWxpemVUaW1lVGlja0ludGVydmFsPWZ1bmN0aW9uKGEsYil7dmFyIGM9Ynx8W1tcIm1pbGxpc2Vjb25kXCIsWzEsMiw1LDEwLDIwLDI1LDUwLDEwMCwyMDAsNTAwXV0sW1wic2Vjb25kXCIsWzEsMiw1LDEwLDE1LDMwXV0sW1wibWludXRlXCIsWzEsMiw1LDEwLDE1LDMwXV0sW1wiaG91clwiLFsxLDIsMyw0LDYsOCwxMl1dLFtcImRheVwiLFsxLDJdXSxbXCJ3ZWVrXCIsWzEsMl1dLFtcIm1vbnRoXCIsWzEsMiwzLDQsNl1dLFtcInllYXJcIixudWxsXV0sZD1cbmNbYy5sZW5ndGgtMV0sZT1IW2RbMF1dLGY9ZFsxXSxnO2ZvcihnPTA7ZzxjLmxlbmd0aDtnKyspaWYoZD1jW2ddLGU9SFtkWzBdXSxmPWRbMV0sY1tnKzFdJiZhPD0oZSpmW2YubGVuZ3RoLTFdK0hbY1tnKzFdWzBdXSkvMilicmVhaztlPT09SC55ZWFyJiZhPDUqZSYmKGY9WzEsMiw1XSk7Yz1CYihhL2UsZixkWzBdPT09XCJ5ZWFyXCI/dihBYihhL2UpLDEpOjEpO3JldHVybnt1bml0UmFuZ2U6ZSxjb3VudDpjLHVuaXROYW1lOmRbMF19fTtJLnByb3RvdHlwZS5nZXRMb2dUaWNrUG9zaXRpb25zPWZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPXRoaXMub3B0aW9ucyxmPXRoaXMubGVuLGc9dGhpcy5saW4ybG9nLGg9dGhpcy5sb2cybGluLGk9W107aWYoIWQpdGhpcy5fbWlub3JBdXRvSW50ZXJ2YWw9bnVsbDtpZihhPj0wLjUpYT15KGEpLGk9dGhpcy5nZXRMaW5lYXJUaWNrUG9zaXRpb25zKGEsYixjKTtlbHNlIGlmKGE+PTAuMDgpZm9yKHZhciBmPVYoYiksaixrLGwsbSxvLGU9YT4wLjM/XG5bMSwyLDRdOmE+MC4xNT9bMSwyLDQsNiw4XTpbMSwyLDMsNCw1LDYsNyw4LDldO2Y8YysxJiYhbztmKyspe2s9ZS5sZW5ndGg7Zm9yKGo9MDtqPGsmJiFvO2orKylsPWgoZyhmKSplW2pdKSxsPmImJighZHx8bTw9YykmJm0hPT10JiZpLnB1c2gobSksbT5jJiYobz0hMCksbT1sfWVsc2UgaWYoYj1nKGIpLGM9ZyhjKSxhPWVbZD9cIm1pbm9yVGlja0ludGVydmFsXCI6XCJ0aWNrSW50ZXJ2YWxcIl0sYT1xKGE9PT1cImF1dG9cIj9udWxsOmEsdGhpcy5fbWlub3JBdXRvSW50ZXJ2YWwsKGMtYikqKGUudGlja1BpeGVsSW50ZXJ2YWwvKGQ/NToxKSkvKChkP2YvdGhpcy50aWNrUG9zaXRpb25zLmxlbmd0aDpmKXx8MSkpLGE9QmIoYSxudWxsLEFiKGEpKSxpPXRhKHRoaXMuZ2V0TGluZWFyVGlja1Bvc2l0aW9ucyhhLGIsYyksaCksIWQpdGhpcy5fbWlub3JBdXRvSW50ZXJ2YWw9YS81O2lmKCFkKXRoaXMudGlja0ludGVydmFsPWE7cmV0dXJuIGl9O0kucHJvdG90eXBlLmxvZzJsaW49ZnVuY3Rpb24oYSl7cmV0dXJuIFkubG9nKGEpL1xuWS5MTjEwfTtJLnByb3RvdHlwZS5saW4ybG9nPWZ1bmN0aW9uKGEpe3JldHVybiBZLnBvdygxMCxhKX07dmFyIExiPXouVG9vbHRpcD1mdW5jdGlvbigpe3RoaXMuaW5pdC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9O0xiLnByb3RvdHlwZT17aW5pdDpmdW5jdGlvbihhLGIpe3ZhciBjPWIuYm9yZGVyV2lkdGgsZD1iLnN0eWxlLGU9RyhkLnBhZGRpbmcpO3RoaXMuY2hhcnQ9YTt0aGlzLm9wdGlvbnM9Yjt0aGlzLmNyb3NzaGFpcnM9W107dGhpcy5ub3c9e3g6MCx5OjB9O3RoaXMuaXNIaWRkZW49ITA7dGhpcy5sYWJlbD1hLnJlbmRlcmVyLmxhYmVsKFwiXCIsMCwwLGIuc2hhcGV8fFwiY2FsbG91dFwiLG51bGwsbnVsbCxiLnVzZUhUTUwsbnVsbCxcInRvb2x0aXBcIikuYXR0cih7cGFkZGluZzplLGZpbGw6Yi5iYWNrZ3JvdW5kQ29sb3IsXCJzdHJva2Utd2lkdGhcIjpjLHI6Yi5ib3JkZXJSYWRpdXMsekluZGV4Ojh9KS5jc3MoZCkuY3NzKHtwYWRkaW5nOjB9KS5hZGQoKS5hdHRyKHt5Oi05OTk5fSk7XG5xYXx8dGhpcy5sYWJlbC5zaGFkb3coYi5zaGFkb3cpO3RoaXMuc2hhcmVkPWIuc2hhcmVkfSxkZXN0cm95OmZ1bmN0aW9uKCl7aWYodGhpcy5sYWJlbCl0aGlzLmxhYmVsPXRoaXMubGFiZWwuZGVzdHJveSgpO2NsZWFyVGltZW91dCh0aGlzLmhpZGVUaW1lcik7Y2xlYXJUaW1lb3V0KHRoaXMudG9vbHRpcFRpbWVvdXQpfSxtb3ZlOmZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPXRoaXMsZj1lLm5vdyxnPWUub3B0aW9ucy5hbmltYXRpb24hPT0hMSYmIWUuaXNIaWRkZW4mJihTKGEtZi54KT4xfHxTKGItZi55KT4xKSxoPWUuZm9sbG93UG9pbnRlcnx8ZS5sZW4+MTt4KGYse3g6Zz8oMipmLngrYSkvMzphLHk6Zz8oZi55K2IpLzI6YixhbmNob3JYOmg/dDpnPygyKmYuYW5jaG9yWCtjKS8zOmMsYW5jaG9yWTpoP3Q6Zz8oZi5hbmNob3JZK2QpLzI6ZH0pO2UubGFiZWwuYXR0cihmKTtpZihnKWNsZWFyVGltZW91dCh0aGlzLnRvb2x0aXBUaW1lb3V0KSx0aGlzLnRvb2x0aXBUaW1lb3V0PXNldFRpbWVvdXQoZnVuY3Rpb24oKXtlJiZcbmUubW92ZShhLGIsYyxkKX0sMzIpfSxoaWRlOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7Y2xlYXJUaW1lb3V0KHRoaXMuaGlkZVRpbWVyKTthPXEoYSx0aGlzLm9wdGlvbnMuaGlkZURlbGF5LDUwMCk7aWYoIXRoaXMuaXNIaWRkZW4pdGhpcy5oaWRlVGltZXI9JGEoZnVuY3Rpb24oKXtiLmxhYmVsW2E/XCJmYWRlT3V0XCI6XCJoaWRlXCJdKCk7Yi5pc0hpZGRlbj0hMH0sYSl9LGdldEFuY2hvcjpmdW5jdGlvbihhLGIpe3ZhciBjLGQ9dGhpcy5jaGFydCxlPWQuaW52ZXJ0ZWQsZj1kLnBsb3RUb3AsZz1kLnBsb3RMZWZ0LGg9MCxpPTAsaixrLGE9dmEoYSk7Yz1hWzBdLnRvb2x0aXBQb3M7dGhpcy5mb2xsb3dQb2ludGVyJiZiJiYoYi5jaGFydFg9PT10JiYoYj1kLnBvaW50ZXIubm9ybWFsaXplKGIpKSxjPVtiLmNoYXJ0WC1kLnBsb3RMZWZ0LGIuY2hhcnRZLWZdKTtjfHwobihhLGZ1bmN0aW9uKGEpe2o9YS5zZXJpZXMueUF4aXM7az1hLnNlcmllcy54QXhpcztoKz1hLnBsb3RYKyghZSYmaz9cbmsubGVmdC1nOjApO2krPShhLnBsb3RMb3c/KGEucGxvdExvdythLnBsb3RIaWdoKS8yOmEucGxvdFkpKyghZSYmaj9qLnRvcC1mOjApfSksaC89YS5sZW5ndGgsaS89YS5sZW5ndGgsYz1bZT9kLnBsb3RXaWR0aC1pOmgsdGhpcy5zaGFyZWQmJiFlJiZhLmxlbmd0aD4xJiZiP2IuY2hhcnRZLWY6ZT9kLnBsb3RIZWlnaHQtaDppXSk7cmV0dXJuIHRhKGMseSl9LGdldFBvc2l0aW9uOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD10aGlzLmNoYXJ0LGU9dGhpcy5kaXN0YW5jZSxmPXt9LGc9Yy5ofHwwLGgsaT1bXCJ5XCIsZC5jaGFydEhlaWdodCxiLGMucGxvdFkrZC5wbG90VG9wLGQucGxvdFRvcCxkLnBsb3RUb3ArZC5wbG90SGVpZ2h0XSxqPVtcInhcIixkLmNoYXJ0V2lkdGgsYSxjLnBsb3RYK2QucGxvdExlZnQsZC5wbG90TGVmdCxkLnBsb3RMZWZ0K2QucGxvdFdpZHRoXSxrPSF0aGlzLmZvbGxvd1BvaW50ZXImJnEoYy50dEJlbG93LCFkLmludmVydGVkPT09ISFjLm5lZ2F0aXZlKSxsPWZ1bmN0aW9uKGEsXG5iLGMsZCxoLGkpe3ZhciBqPWM8ZC1lLG09ZCtlK2M8YixsPWQtZS1jO2QrPWU7aWYoayYmbSlmW2FdPWQ7ZWxzZSBpZighayYmailmW2FdPWw7ZWxzZSBpZihqKWZbYV09RShpLWMsbC1nPDA/bDpsLWcpO2Vsc2UgaWYobSlmW2FdPXYoaCxkK2crYz5iP2Q6ZCtnKTtlbHNlIHJldHVybiExfSxtPWZ1bmN0aW9uKGEsYixjLGQpe3ZhciBnO2Q8ZXx8ZD5iLWU/Zz0hMTpmW2FdPWQ8Yy8yPzE6ZD5iLWMvMj9iLWMtMjpkLWMvMjtyZXR1cm4gZ30sbz1mdW5jdGlvbihhKXt2YXIgYj1pO2k9ajtqPWI7aD1hfSxwPWZ1bmN0aW9uKCl7bC5hcHBseSgwLGkpIT09ITE/bS5hcHBseSgwLGopPT09ITEmJiFoJiYobyghMCkscCgpKTpoP2YueD1mLnk9MDoobyghMCkscCgpKX07KGQuaW52ZXJ0ZWR8fHRoaXMubGVuPjEpJiZvKCk7cCgpO3JldHVybiBmfSxkZWZhdWx0Rm9ybWF0dGVyOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMucG9pbnRzfHx2YSh0aGlzKSxjO2M9W2EudG9vbHRpcEZvb3RlckhlYWRlckZvcm1hdHRlcihiWzBdKV07XG5jPWMuY29uY2F0KGEuYm9keUZvcm1hdHRlcihiKSk7Yy5wdXNoKGEudG9vbHRpcEZvb3RlckhlYWRlckZvcm1hdHRlcihiWzBdLCEwKSk7cmV0dXJuIGMuam9pbihcIlwiKX0scmVmcmVzaDpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuY2hhcnQsZD10aGlzLmxhYmVsLGU9dGhpcy5vcHRpb25zLGYsZyxoLGk9e30saixrPVtdO2o9ZS5mb3JtYXR0ZXJ8fHRoaXMuZGVmYXVsdEZvcm1hdHRlcjt2YXIgaT1jLmhvdmVyUG9pbnRzLGwsbT10aGlzLnNoYXJlZDtjbGVhclRpbWVvdXQodGhpcy5oaWRlVGltZXIpO3RoaXMuZm9sbG93UG9pbnRlcj12YShhKVswXS5zZXJpZXMudG9vbHRpcE9wdGlvbnMuZm9sbG93UG9pbnRlcjtoPXRoaXMuZ2V0QW5jaG9yKGEsYik7Zj1oWzBdO2c9aFsxXTttJiYoIWEuc2VyaWVzfHwhYS5zZXJpZXMubm9TaGFyZWRUb29sdGlwKT8oYy5ob3ZlclBvaW50cz1hLGkmJm4oaSxmdW5jdGlvbihhKXthLnNldFN0YXRlKCl9KSxuKGEsZnVuY3Rpb24oYSl7YS5zZXRTdGF0ZShcImhvdmVyXCIpO1xuay5wdXNoKGEuZ2V0TGFiZWxDb25maWcoKSl9KSxpPXt4OmFbMF0uY2F0ZWdvcnkseTphWzBdLnl9LGkucG9pbnRzPWssdGhpcy5sZW49ay5sZW5ndGgsYT1hWzBdKTppPWEuZ2V0TGFiZWxDb25maWcoKTtqPWouY2FsbChpLHRoaXMpO2k9YS5zZXJpZXM7dGhpcy5kaXN0YW5jZT1xKGkudG9vbHRpcE9wdGlvbnMuZGlzdGFuY2UsMTYpO2o9PT0hMT90aGlzLmhpZGUoKToodGhpcy5pc0hpZGRlbiYmKFRhKGQpLGQuYXR0cihcIm9wYWNpdHlcIiwxKS5zaG93KCkpLGQuYXR0cih7dGV4dDpqfSksbD1lLmJvcmRlckNvbG9yfHxhLmNvbG9yfHxpLmNvbG9yfHxcIiM2MDYwNjBcIixkLmF0dHIoe3N0cm9rZTpsfSksdGhpcy51cGRhdGVQb3NpdGlvbih7cGxvdFg6ZixwbG90WTpnLG5lZ2F0aXZlOmEubmVnYXRpdmUsdHRCZWxvdzphLnR0QmVsb3csaDpoWzJdfHwwfSksdGhpcy5pc0hpZGRlbj0hMSk7TShjLFwidG9vbHRpcFJlZnJlc2hcIix7dGV4dDpqLHg6ZitjLnBsb3RMZWZ0LHk6ZytjLnBsb3RUb3AsXG5ib3JkZXJDb2xvcjpsfSl9LHVwZGF0ZVBvc2l0aW9uOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY2hhcnQsYz10aGlzLmxhYmVsLGM9KHRoaXMub3B0aW9ucy5wb3NpdGlvbmVyfHx0aGlzLmdldFBvc2l0aW9uKS5jYWxsKHRoaXMsYy53aWR0aCxjLmhlaWdodCxhKTt0aGlzLm1vdmUoeShjLngpLHkoYy55fHwwKSxhLnBsb3RYK2IucGxvdExlZnQsYS5wbG90WStiLnBsb3RUb3ApfSxnZXRYRGF0ZUZvcm1hdDpmdW5jdGlvbihhLGIsYyl7dmFyIGQsYj1iLmRhdGVUaW1lTGFiZWxGb3JtYXRzLGU9YyYmYy5jbG9zZXN0UG9pbnRSYW5nZSxmLGc9e21pbGxpc2Vjb25kOjE1LHNlY29uZDoxMixtaW51dGU6OSxob3VyOjYsZGF5OjN9LGgsaT1cIm1pbGxpc2Vjb25kXCI7aWYoZSl7aD1tYShcIiVtLSVkICVIOiVNOiVTLiVMXCIsYS54KTtmb3IoZiBpbiBIKXtpZihlPT09SC53ZWVrJiYrbWEoXCIld1wiLGEueCk9PT1jLm9wdGlvbnMuc3RhcnRPZldlZWsmJmguc3Vic3RyKDYpPT09XCIwMDowMDowMC4wMDBcIil7Zj1cblwid2Vla1wiO2JyZWFrfWlmKEhbZl0+ZSl7Zj1pO2JyZWFrfWlmKGdbZl0mJmguc3Vic3RyKGdbZl0pIT09XCIwMS0wMSAwMDowMDowMC4wMDBcIi5zdWJzdHIoZ1tmXSkpYnJlYWs7ZiE9PVwid2Vla1wiJiYoaT1mKX1mJiYoZD1iW2ZdKX1lbHNlIGQ9Yi5kYXk7cmV0dXJuIGR8fGIueWVhcn0sdG9vbHRpcEZvb3RlckhlYWRlckZvcm1hdHRlcjpmdW5jdGlvbihhLGIpe3ZhciBjPWI/XCJmb290ZXJcIjpcImhlYWRlclwiLGQ9YS5zZXJpZXMsZT1kLnRvb2x0aXBPcHRpb25zLGY9ZS54RGF0ZUZvcm1hdCxnPWQueEF4aXMsaD1nJiZnLm9wdGlvbnMudHlwZT09PVwiZGF0ZXRpbWVcIiYmdWEoYS5rZXkpLGM9ZVtjK1wiRm9ybWF0XCJdO2gmJiFmJiYoZj10aGlzLmdldFhEYXRlRm9ybWF0KGEsZSxnKSk7aCYmZiYmKGM9Yy5yZXBsYWNlKFwie3BvaW50LmtleX1cIixcIntwb2ludC5rZXk6XCIrZitcIn1cIikpO3JldHVybiBMYShjLHtwb2ludDphLHNlcmllczpkfSl9LGJvZHlGb3JtYXR0ZXI6ZnVuY3Rpb24oYSl7cmV0dXJuIHRhKGEsXG5mdW5jdGlvbihhKXt2YXIgYz1hLnNlcmllcy50b29sdGlwT3B0aW9ucztyZXR1cm4oYy5wb2ludEZvcm1hdHRlcnx8YS5wb2ludC50b29sdGlwRm9ybWF0dGVyKS5jYWxsKGEucG9pbnQsYy5wb2ludEZvcm1hdCl9KX19O3ZhciBvYTtkYj1CJiZCLmRvY3VtZW50RWxlbWVudC5vbnRvdWNoc3RhcnQhPT10O3ZhciBaYT16LlBvaW50ZXI9ZnVuY3Rpb24oYSxiKXt0aGlzLmluaXQoYSxiKX07WmEucHJvdG90eXBlPXtpbml0OmZ1bmN0aW9uKGEsYil7dmFyIGM9Yi5jaGFydCxkPWMuZXZlbnRzLGU9cWE/XCJcIjpjLnpvb21UeXBlLGM9YS5pbnZlcnRlZCxmO3RoaXMub3B0aW9ucz1iO3RoaXMuY2hhcnQ9YTt0aGlzLnpvb21YPWY9L3gvLnRlc3QoZSk7dGhpcy56b29tWT1lPS95Ly50ZXN0KGUpO3RoaXMuem9vbUhvcj1mJiYhY3x8ZSYmYzt0aGlzLnpvb21WZXJ0PWUmJiFjfHxmJiZjO3RoaXMuaGFzWm9vbT1mfHxlO3RoaXMucnVuQ2hhcnRDbGljaz1kJiYhIWQuY2xpY2s7dGhpcy5waW5jaERvd249XG5bXTt0aGlzLmxhc3RWYWxpZFRvdWNoPXt9O2lmKHouVG9vbHRpcCYmYi50b29sdGlwLmVuYWJsZWQpYS50b29sdGlwPW5ldyBMYihhLGIudG9vbHRpcCksdGhpcy5mb2xsb3dUb3VjaE1vdmU9cShiLnRvb2x0aXAuZm9sbG93VG91Y2hNb3ZlLCEwKTt0aGlzLnNldERPTUV2ZW50cygpfSxub3JtYWxpemU6ZnVuY3Rpb24oYSxiKXt2YXIgYyxkLGE9YXx8Si5ldmVudDtpZighYS50YXJnZXQpYS50YXJnZXQ9YS5zcmNFbGVtZW50O2Q9YS50b3VjaGVzP2EudG91Y2hlcy5sZW5ndGg/YS50b3VjaGVzLml0ZW0oMCk6YS5jaGFuZ2VkVG91Y2hlc1swXTphO2lmKCFiKXRoaXMuY2hhcnRQb3NpdGlvbj1iPUtiKHRoaXMuY2hhcnQuY29udGFpbmVyKTtkLnBhZ2VYPT09dD8oYz12KGEueCxhLmNsaWVudFgtYi5sZWZ0KSxkPWEueSk6KGM9ZC5wYWdlWC1iLmxlZnQsZD1kLnBhZ2VZLWIudG9wKTtyZXR1cm4geChhLHtjaGFydFg6eShjKSxjaGFydFk6eShkKX0pfSxnZXRDb29yZGluYXRlczpmdW5jdGlvbihhKXt2YXIgYj1cbnt4QXhpczpbXSx5QXhpczpbXX07bih0aGlzLmNoYXJ0LmF4ZXMsZnVuY3Rpb24oYyl7YltjLmlzWEF4aXM/XCJ4QXhpc1wiOlwieUF4aXNcIl0ucHVzaCh7YXhpczpjLHZhbHVlOmMudG9WYWx1ZShhW2MuaG9yaXo/XCJjaGFydFhcIjpcImNoYXJ0WVwiXSl9KX0pO3JldHVybiBifSxydW5Qb2ludEFjdGlvbnM6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jaGFydCxjPWIuc2VyaWVzLGQ9Yi50b29sdGlwLGU9ZD9kLnNoYXJlZDohMSxmPWIuaG92ZXJQb2ludCxnPWIuaG92ZXJTZXJpZXMsaCxpPVtOdW1iZXIuTUFYX1ZBTFVFLE51bWJlci5NQVhfVkFMVUVdLGosayxsPVtdLG09W10sbztpZighZSYmIWcpZm9yKGg9MDtoPGMubGVuZ3RoO2grKylpZihjW2hdLmRpcmVjdFRvdWNofHwhY1toXS5vcHRpb25zLnN0aWNreVRyYWNraW5nKWM9W107ZyYmKGU/Zy5ub1NoYXJlZFRvb2x0aXA6Zy5kaXJlY3RUb3VjaCkmJmY/bT1bZl06KG4oYyxmdW5jdGlvbihiKXtqPWIubm9TaGFyZWRUb29sdGlwJiZlO2s9XG4hZSYmYi5kaXJlY3RUb3VjaDtiLnZpc2libGUmJiFqJiYhayYmcShiLm9wdGlvbnMuZW5hYmxlTW91c2VUcmFja2luZywhMCkmJihvPWIuc2VhcmNoUG9pbnQoYSwhaiYmYi5rZERpbWVuc2lvbnM9PT0xKSkmJmwucHVzaChvKX0pLG4obCxmdW5jdGlvbihhKXthJiZuKFtcImRpc3RcIixcImRpc3RYXCJdLGZ1bmN0aW9uKGIsYyl7aWYodHlwZW9mIGFbYl09PT1cIm51bWJlclwiKXt2YXIgZD1hW2JdPT09aVtjXSYmYS5zZXJpZXMuZ3JvdXAuekluZGV4Pj1tW2NdLnNlcmllcy5ncm91cC56SW5kZXg7aWYoYVtiXTxpW2NdfHxkKWlbY109YVtiXSxtW2NdPWF9fSl9KSk7aWYoZSlmb3IoaD1sLmxlbmd0aDtoLS07KShsW2hdLmNsaWVudFghPT1tWzFdLmNsaWVudFh8fGxbaF0uc2VyaWVzLm5vU2hhcmVkVG9vbHRpcCkmJmwuc3BsaWNlKGgsMSk7aWYobVswXSYmKG1bMF0hPT10aGlzLnByZXZLRFBvaW50fHxkJiZkLmlzSGlkZGVuKSlpZihlJiYhbVswXS5zZXJpZXMubm9TaGFyZWRUb29sdGlwKWwubGVuZ3RoJiZcbmQmJmQucmVmcmVzaChsLGEpLG4obCxmdW5jdGlvbihiKXtiLm9uTW91c2VPdmVyKGEsYiE9PShnJiZnLmRpcmVjdFRvdWNoJiZmfHxtWzBdKSl9KSx0aGlzLnByZXZLRFBvaW50PW1bMV07ZWxzZXtkJiZkLnJlZnJlc2gobVswXSxhKTtpZighZ3x8IWcuZGlyZWN0VG91Y2gpbVswXS5vbk1vdXNlT3ZlcihhKTt0aGlzLnByZXZLRFBvaW50PW1bMF19ZWxzZSBjPWcmJmcudG9vbHRpcE9wdGlvbnMuZm9sbG93UG9pbnRlcixkJiZjJiYhZC5pc0hpZGRlbiYmKGM9ZC5nZXRBbmNob3IoW3t9XSxhKSxkLnVwZGF0ZVBvc2l0aW9uKHtwbG90WDpjWzBdLHBsb3RZOmNbMV19KSk7aWYoIXRoaXMuX29uRG9jdW1lbnRNb3VzZU1vdmUpdGhpcy5fb25Eb2N1bWVudE1vdXNlTW92ZT1mdW5jdGlvbihhKXtpZigkW29hXSkkW29hXS5wb2ludGVyLm9uRG9jdW1lbnRNb3VzZU1vdmUoYSl9LEQoQixcIm1vdXNlbW92ZVwiLHRoaXMuX29uRG9jdW1lbnRNb3VzZU1vdmUpO24oZT9sOltxKG1bMV0sZildLGZ1bmN0aW9uKGMpe24oYi5heGVzLFxuZnVuY3Rpb24oYil7KCFjfHxjLnNlcmllc1tiLmNvbGxdPT09YikmJmIuZHJhd0Nyb3NzaGFpcihhLGMpfSl9KX0scmVzZXQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmNoYXJ0LGQ9Yy5ob3ZlclNlcmllcyxlPWMuaG92ZXJQb2ludCxmPWMuaG92ZXJQb2ludHMsZz1jLnRvb2x0aXAsaD1nJiZnLnNoYXJlZD9mOmU7YSYmaCYmbih2YShoKSxmdW5jdGlvbihiKXtiLnNlcmllcy5pc0NhcnRlc2lhbiYmYi5wbG90WD09PXZvaWQgMCYmKGE9ITEpfSk7aWYoYSlnJiZoJiYoZy5yZWZyZXNoKGgpLGUmJihlLnNldFN0YXRlKGUuc3RhdGUsITApLG4oYy5heGVzLGZ1bmN0aW9uKGEpe3EoYS5jcm9zc2hhaXImJmEuY3Jvc3NoYWlyLnNuYXAsITApP2EuZHJhd0Nyb3NzaGFpcihudWxsLGUpOmEuaGlkZUNyb3NzaGFpcigpfSkpKTtlbHNle2lmKGUpZS5vbk1vdXNlT3V0KCk7ZiYmbihmLGZ1bmN0aW9uKGEpe2Euc2V0U3RhdGUoKX0pO2lmKGQpZC5vbk1vdXNlT3V0KCk7ZyYmZy5oaWRlKGIpO1xuaWYodGhpcy5fb25Eb2N1bWVudE1vdXNlTW92ZSlUKEIsXCJtb3VzZW1vdmVcIix0aGlzLl9vbkRvY3VtZW50TW91c2VNb3ZlKSx0aGlzLl9vbkRvY3VtZW50TW91c2VNb3ZlPW51bGw7bihjLmF4ZXMsZnVuY3Rpb24oYSl7YS5oaWRlQ3Jvc3NoYWlyKCl9KTt0aGlzLmhvdmVyWD1jLmhvdmVyUG9pbnRzPWMuaG92ZXJQb2ludD1udWxsfX0sc2NhbGVHcm91cHM6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmNoYXJ0LGQ7bihjLnNlcmllcyxmdW5jdGlvbihlKXtkPWF8fGUuZ2V0UGxvdEJveCgpO2UueEF4aXMmJmUueEF4aXMuem9vbUVuYWJsZWQmJihlLmdyb3VwLmF0dHIoZCksZS5tYXJrZXJHcm91cCYmKGUubWFya2VyR3JvdXAuYXR0cihkKSxlLm1hcmtlckdyb3VwLmNsaXAoYj9jLmNsaXBSZWN0Om51bGwpKSxlLmRhdGFMYWJlbHNHcm91cCYmZS5kYXRhTGFiZWxzR3JvdXAuYXR0cihkKSl9KTtjLmNsaXBSZWN0LmF0dHIoYnx8Yy5jbGlwQm94KX0sZHJhZ1N0YXJ0OmZ1bmN0aW9uKGEpe3ZhciBiPVxudGhpcy5jaGFydDtiLm1vdXNlSXNEb3duPWEudHlwZTtiLmNhbmNlbENsaWNrPSExO2IubW91c2VEb3duWD10aGlzLm1vdXNlRG93blg9YS5jaGFydFg7Yi5tb3VzZURvd25ZPXRoaXMubW91c2VEb3duWT1hLmNoYXJ0WX0sZHJhZzpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNoYXJ0LGM9Yi5vcHRpb25zLmNoYXJ0LGQ9YS5jaGFydFgsZT1hLmNoYXJ0WSxmPXRoaXMuem9vbUhvcixnPXRoaXMuem9vbVZlcnQsaD1iLnBsb3RMZWZ0LGk9Yi5wbG90VG9wLGo9Yi5wbG90V2lkdGgsaz1iLnBsb3RIZWlnaHQsbCxtPXRoaXMuc2VsZWN0aW9uTWFya2VyLG89dGhpcy5tb3VzZURvd25YLHA9dGhpcy5tb3VzZURvd25ZLHI9Yy5wYW5LZXkmJmFbYy5wYW5LZXkrXCJLZXlcIl07aWYoIW18fCFtLnRvdWNoKWlmKGQ8aD9kPWg6ZD5oK2omJihkPWgraiksZTxpP2U9aTplPmkrayYmKGU9aStrKSx0aGlzLmhhc0RyYWdnZWQ9TWF0aC5zcXJ0KE1hdGgucG93KG8tZCwyKStNYXRoLnBvdyhwLWUsMikpLHRoaXMuaGFzRHJhZ2dlZD5cbjEwKXtsPWIuaXNJbnNpZGVQbG90KG8taCxwLWkpO2lmKGIuaGFzQ2FydGVzaWFuU2VyaWVzJiYodGhpcy56b29tWHx8dGhpcy56b29tWSkmJmwmJiFyJiYhbSl0aGlzLnNlbGVjdGlvbk1hcmtlcj1tPWIucmVuZGVyZXIucmVjdChoLGksZj8xOmosZz8xOmssMCkuYXR0cih7ZmlsbDpjLnNlbGVjdGlvbk1hcmtlckZpbGx8fFwicmdiYSg2OSwxMTQsMTY3LDAuMjUpXCIsekluZGV4Ojd9KS5hZGQoKTttJiZmJiYoZC09byxtLmF0dHIoe3dpZHRoOlMoZCkseDooZD4wPzA6ZCkrb30pKTttJiZnJiYoZD1lLXAsbS5hdHRyKHtoZWlnaHQ6UyhkKSx5OihkPjA/MDpkKStwfSkpO2wmJiFtJiZjLnBhbm5pbmcmJmIucGFuKGEsYy5wYW5uaW5nKX19LGRyb3A6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcyxjPXRoaXMuY2hhcnQsZD10aGlzLmhhc1BpbmNoZWQ7aWYodGhpcy5zZWxlY3Rpb25NYXJrZXIpe3ZhciBlPXtvcmlnaW5hbEV2ZW50OmEseEF4aXM6W10seUF4aXM6W119LGY9dGhpcy5zZWxlY3Rpb25NYXJrZXIsXG5nPWYuYXR0cj9mLmF0dHIoXCJ4XCIpOmYueCxoPWYuYXR0cj9mLmF0dHIoXCJ5XCIpOmYueSxpPWYuYXR0cj9mLmF0dHIoXCJ3aWR0aFwiKTpmLndpZHRoLGo9Zi5hdHRyP2YuYXR0cihcImhlaWdodFwiKTpmLmhlaWdodCxrO2lmKHRoaXMuaGFzRHJhZ2dlZHx8ZCluKGMuYXhlcyxmdW5jdGlvbihjKXtpZihjLnpvb21FbmFibGVkJiZzKGMubWluKSYmKGR8fGJbe3hBeGlzOlwiem9vbVhcIix5QXhpczpcInpvb21ZXCJ9W2MuY29sbF1dKSl7dmFyIGY9Yy5ob3JpeixvPWEudHlwZT09PVwidG91Y2hlbmRcIj9jLm1pblBpeGVsUGFkZGluZzowLHA9Yy50b1ZhbHVlKChmP2c6aCkrbyksZj1jLnRvVmFsdWUoKGY/ZytpOmgraiktbyk7ZVtjLmNvbGxdLnB1c2goe2F4aXM6YyxtaW46RShwLGYpLG1heDp2KHAsZil9KTtrPSEwfX0pLGsmJk0oYyxcInNlbGVjdGlvblwiLGUsZnVuY3Rpb24oYSl7Yy56b29tKHgoYSxkP3thbmltYXRpb246ITF9Om51bGwpKX0pO3RoaXMuc2VsZWN0aW9uTWFya2VyPXRoaXMuc2VsZWN0aW9uTWFya2VyLmRlc3Ryb3koKTtcbmQmJnRoaXMuc2NhbGVHcm91cHMoKX1pZihjKUYoYy5jb250YWluZXIse2N1cnNvcjpjLl9jdXJzb3J9KSxjLmNhbmNlbENsaWNrPXRoaXMuaGFzRHJhZ2dlZD4xMCxjLm1vdXNlSXNEb3duPXRoaXMuaGFzRHJhZ2dlZD10aGlzLmhhc1BpbmNoZWQ9ITEsdGhpcy5waW5jaERvd249W119LG9uQ29udGFpbmVyTW91c2VEb3duOmZ1bmN0aW9uKGEpe2E9dGhpcy5ub3JtYWxpemUoYSk7YS5wcmV2ZW50RGVmYXVsdCYmYS5wcmV2ZW50RGVmYXVsdCgpO3RoaXMuZHJhZ1N0YXJ0KGEpfSxvbkRvY3VtZW50TW91c2VVcDpmdW5jdGlvbihhKXskW29hXSYmJFtvYV0ucG9pbnRlci5kcm9wKGEpfSxvbkRvY3VtZW50TW91c2VNb3ZlOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY2hhcnQsYz10aGlzLmNoYXJ0UG9zaXRpb24sYT10aGlzLm5vcm1hbGl6ZShhLGMpO2MmJiF0aGlzLmluQ2xhc3MoYS50YXJnZXQsXCJoaWdoY2hhcnRzLXRyYWNrZXJcIikmJiFiLmlzSW5zaWRlUGxvdChhLmNoYXJ0WC1iLnBsb3RMZWZ0LFxuYS5jaGFydFktYi5wbG90VG9wKSYmdGhpcy5yZXNldCgpfSxvbkNvbnRhaW5lck1vdXNlTGVhdmU6ZnVuY3Rpb24oYSl7dmFyIGI9JFtvYV07aWYoYiYmKGEucmVsYXRlZFRhcmdldHx8YS50b0VsZW1lbnQpKWIucG9pbnRlci5yZXNldCgpLGIucG9pbnRlci5jaGFydFBvc2l0aW9uPW51bGx9LG9uQ29udGFpbmVyTW91c2VNb3ZlOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY2hhcnQ7aWYoIXMob2EpfHwhJFtvYV18fCEkW29hXS5tb3VzZUlzRG93bilvYT1iLmluZGV4O2E9dGhpcy5ub3JtYWxpemUoYSk7YS5yZXR1cm5WYWx1ZT0hMTtiLm1vdXNlSXNEb3duPT09XCJtb3VzZWRvd25cIiYmdGhpcy5kcmFnKGEpOyh0aGlzLmluQ2xhc3MoYS50YXJnZXQsXCJoaWdoY2hhcnRzLXRyYWNrZXJcIil8fGIuaXNJbnNpZGVQbG90KGEuY2hhcnRYLWIucGxvdExlZnQsYS5jaGFydFktYi5wbG90VG9wKSkmJiFiLm9wZW5NZW51JiZ0aGlzLnJ1blBvaW50QWN0aW9ucyhhKX0saW5DbGFzczpmdW5jdGlvbihhLFxuYil7Zm9yKHZhciBjO2E7KXtpZihjPVgoYSxcImNsYXNzXCIpKXtpZihjLmluZGV4T2YoYikhPT0tMSlyZXR1cm4hMDtpZihjLmluZGV4T2YoXCJoaWdoY2hhcnRzLWNvbnRhaW5lclwiKSE9PS0xKXJldHVybiExfWE9YS5wYXJlbnROb2RlfX0sb25UcmFja2VyTW91c2VPdXQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jaGFydC5ob3ZlclNlcmllcyxhPWEucmVsYXRlZFRhcmdldHx8YS50b0VsZW1lbnQ7aWYoYiYmYSYmIWIub3B0aW9ucy5zdGlja3lUcmFja2luZyYmIXRoaXMuaW5DbGFzcyhhLFwiaGlnaGNoYXJ0cy10b29sdGlwXCIpJiYhdGhpcy5pbkNsYXNzKGEsXCJoaWdoY2hhcnRzLXNlcmllcy1cIitiLmluZGV4KSliLm9uTW91c2VPdXQoKX0sb25Db250YWluZXJDbGljazpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNoYXJ0LGM9Yi5ob3ZlclBvaW50LGQ9Yi5wbG90TGVmdCxlPWIucGxvdFRvcCxhPXRoaXMubm9ybWFsaXplKGEpO2IuY2FuY2VsQ2xpY2t8fChjJiZ0aGlzLmluQ2xhc3MoYS50YXJnZXQsXG5cImhpZ2hjaGFydHMtdHJhY2tlclwiKT8oTShjLnNlcmllcyxcImNsaWNrXCIseChhLHtwb2ludDpjfSkpLGIuaG92ZXJQb2ludCYmYy5maXJlUG9pbnRFdmVudChcImNsaWNrXCIsYSkpOih4KGEsdGhpcy5nZXRDb29yZGluYXRlcyhhKSksYi5pc0luc2lkZVBsb3QoYS5jaGFydFgtZCxhLmNoYXJ0WS1lKSYmTShiLFwiY2xpY2tcIixhKSkpfSxzZXRET01FdmVudHM6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5jaGFydC5jb250YWluZXI7Yi5vbm1vdXNlZG93bj1mdW5jdGlvbihiKXthLm9uQ29udGFpbmVyTW91c2VEb3duKGIpfTtiLm9ubW91c2Vtb3ZlPWZ1bmN0aW9uKGIpe2Eub25Db250YWluZXJNb3VzZU1vdmUoYil9O2Iub25jbGljaz1mdW5jdGlvbihiKXthLm9uQ29udGFpbmVyQ2xpY2soYil9O0QoYixcIm1vdXNlbGVhdmVcIixhLm9uQ29udGFpbmVyTW91c2VMZWF2ZSk7bGI9PT0xJiZEKEIsXCJtb3VzZXVwXCIsYS5vbkRvY3VtZW50TW91c2VVcCk7aWYoZGIpYi5vbnRvdWNoc3RhcnQ9ZnVuY3Rpb24oYil7YS5vbkNvbnRhaW5lclRvdWNoU3RhcnQoYil9LFxuYi5vbnRvdWNobW92ZT1mdW5jdGlvbihiKXthLm9uQ29udGFpbmVyVG91Y2hNb3ZlKGIpfSxsYj09PTEmJkQoQixcInRvdWNoZW5kXCIsYS5vbkRvY3VtZW50VG91Y2hFbmQpfSxkZXN0cm95OmZ1bmN0aW9uKCl7dmFyIGE7VCh0aGlzLmNoYXJ0LmNvbnRhaW5lcixcIm1vdXNlbGVhdmVcIix0aGlzLm9uQ29udGFpbmVyTW91c2VMZWF2ZSk7bGJ8fChUKEIsXCJtb3VzZXVwXCIsdGhpcy5vbkRvY3VtZW50TW91c2VVcCksVChCLFwidG91Y2hlbmRcIix0aGlzLm9uRG9jdW1lbnRUb3VjaEVuZCkpO2NsZWFySW50ZXJ2YWwodGhpcy50b29sdGlwVGltZW91dCk7Zm9yKGEgaW4gdGhpcyl0aGlzW2FdPW51bGx9fTt4KHouUG9pbnRlci5wcm90b3R5cGUse3BpbmNoVHJhbnNsYXRlOmZ1bmN0aW9uKGEsYixjLGQsZSxmKXsodGhpcy56b29tSG9yfHx0aGlzLnBpbmNoSG9yKSYmdGhpcy5waW5jaFRyYW5zbGF0ZURpcmVjdGlvbighMCxhLGIsYyxkLGUsZik7KHRoaXMuem9vbVZlcnR8fHRoaXMucGluY2hWZXJ0KSYmXG50aGlzLnBpbmNoVHJhbnNsYXRlRGlyZWN0aW9uKCExLGEsYixjLGQsZSxmKX0scGluY2hUcmFuc2xhdGVEaXJlY3Rpb246ZnVuY3Rpb24oYSxiLGMsZCxlLGYsZyxoKXt2YXIgaT10aGlzLmNoYXJ0LGo9YT9cInhcIjpcInlcIixrPWE/XCJYXCI6XCJZXCIsbD1cImNoYXJ0XCIrayxtPWE/XCJ3aWR0aFwiOlwiaGVpZ2h0XCIsbz1pW1wicGxvdFwiKyhhP1wiTGVmdFwiOlwiVG9wXCIpXSxwLHIsQT1ofHwxLHE9aS5pbnZlcnRlZCxuPWkuYm91bmRzW2E/XCJoXCI6XCJ2XCJdLHc9Yi5sZW5ndGg9PT0xLE89YlswXVtsXSxzPWNbMF1bbF0sdj0hdyYmYlsxXVtsXSx0PSF3JiZjWzFdW2xdLHksYz1mdW5jdGlvbigpeyF3JiZTKE8tdik+MjAmJihBPWh8fFMocy10KS9TKE8tdikpO3I9KG8tcykvQStPO3A9aVtcInBsb3RcIisoYT9cIldpZHRoXCI6XCJIZWlnaHRcIildL0F9O2MoKTtiPXI7YjxuLm1pbj8oYj1uLm1pbix5PSEwKTpiK3A+bi5tYXgmJihiPW4ubWF4LXAseT0hMCk7eT8ocy09MC44KihzLWdbal1bMF0pLHd8fCh0LT0wLjgqKHQtXG5nW2pdWzFdKSksYygpKTpnW2pdPVtzLHRdO3F8fChmW2pdPXItbyxmW21dPXApO2Y9cT8xL0E6QTtlW21dPXA7ZVtqXT1iO2RbcT9hP1wic2NhbGVZXCI6XCJzY2FsZVhcIjpcInNjYWxlXCIra109QTtkW1widHJhbnNsYXRlXCIra109ZipvKyhzLWYqTyl9LHBpbmNoOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMsYz1iLmNoYXJ0LGQ9Yi5waW5jaERvd24sZT1hLnRvdWNoZXMsZj1lLmxlbmd0aCxnPWIubGFzdFZhbGlkVG91Y2gsaD1iLmhhc1pvb20saT1iLnNlbGVjdGlvbk1hcmtlcixqPXt9LGs9Zj09PTEmJihiLmluQ2xhc3MoYS50YXJnZXQsXCJoaWdoY2hhcnRzLXRyYWNrZXJcIikmJmMucnVuVHJhY2tlckNsaWNrfHxiLnJ1bkNoYXJ0Q2xpY2spLGw9e307aWYoZj4xKWIuaW5pdGlhdGVkPSEwO2gmJmIuaW5pdGlhdGVkJiYhayYmYS5wcmV2ZW50RGVmYXVsdCgpO3RhKGUsZnVuY3Rpb24oYSl7cmV0dXJuIGIubm9ybWFsaXplKGEpfSk7aWYoYS50eXBlPT09XCJ0b3VjaHN0YXJ0XCIpbihlLGZ1bmN0aW9uKGEsXG5iKXtkW2JdPXtjaGFydFg6YS5jaGFydFgsY2hhcnRZOmEuY2hhcnRZfX0pLGcueD1bZFswXS5jaGFydFgsZFsxXSYmZFsxXS5jaGFydFhdLGcueT1bZFswXS5jaGFydFksZFsxXSYmZFsxXS5jaGFydFldLG4oYy5heGVzLGZ1bmN0aW9uKGEpe2lmKGEuem9vbUVuYWJsZWQpe3ZhciBiPWMuYm91bmRzW2EuaG9yaXo/XCJoXCI6XCJ2XCJdLGQ9YS5taW5QaXhlbFBhZGRpbmcsZT1hLnRvUGl4ZWxzKHEoYS5vcHRpb25zLm1pbixhLmRhdGFNaW4pKSxmPWEudG9QaXhlbHMocShhLm9wdGlvbnMubWF4LGEuZGF0YU1heCkpLGc9RShlLGYpLGU9dihlLGYpO2IubWluPUUoYS5wb3MsZy1kKTtiLm1heD12KGEucG9zK2EubGVuLGUrZCl9fSksYi5yZXM9ITA7ZWxzZSBpZihkLmxlbmd0aCl7aWYoIWkpYi5zZWxlY3Rpb25NYXJrZXI9aT14KHtkZXN0cm95OnJhLHRvdWNoOiEwfSxjLnBsb3RCb3gpO2IucGluY2hUcmFuc2xhdGUoZCxlLGosaSxsLGcpO2IuaGFzUGluY2hlZD1oO2Iuc2NhbGVHcm91cHMoaixcbmwpO2lmKCFoJiZiLmZvbGxvd1RvdWNoTW92ZSYmZj09PTEpdGhpcy5ydW5Qb2ludEFjdGlvbnMoYi5ub3JtYWxpemUoYSkpO2Vsc2UgaWYoYi5yZXMpYi5yZXM9ITEsdGhpcy5yZXNldCghMSwwKX19LHRvdWNoOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5jaGFydCxkO29hPWMuaW5kZXg7aWYoYS50b3VjaGVzLmxlbmd0aD09PTEpaWYoYT10aGlzLm5vcm1hbGl6ZShhKSxjLmlzSW5zaWRlUGxvdChhLmNoYXJ0WC1jLnBsb3RMZWZ0LGEuY2hhcnRZLWMucGxvdFRvcCkmJiFjLm9wZW5NZW51KXtiJiZ0aGlzLnJ1blBvaW50QWN0aW9ucyhhKTtpZihhLnR5cGU9PT1cInRvdWNobW92ZVwiKWM9dGhpcy5waW5jaERvd24sZD1NYXRoLnNxcnQoTWF0aC5wb3coY1swXS5jaGFydFgtYS5jaGFydFgsMikrTWF0aC5wb3coY1swXS5jaGFydFktYS5jaGFydFksMikpPj00O3EoZCwhMCkmJnRoaXMucGluY2goYSl9ZWxzZSBiJiZ0aGlzLnJlc2V0KCk7ZWxzZSBhLnRvdWNoZXMubGVuZ3RoPT09MiYmXG50aGlzLnBpbmNoKGEpfSxvbkNvbnRhaW5lclRvdWNoU3RhcnQ6ZnVuY3Rpb24oYSl7dGhpcy50b3VjaChhLCEwKX0sb25Db250YWluZXJUb3VjaE1vdmU6ZnVuY3Rpb24oYSl7dGhpcy50b3VjaChhKX0sb25Eb2N1bWVudFRvdWNoRW5kOmZ1bmN0aW9uKGEpeyRbb2FdJiYkW29hXS5wb2ludGVyLmRyb3AoYSl9fSk7aWYoSi5Qb2ludGVyRXZlbnR8fEouTVNQb2ludGVyRXZlbnQpe3ZhciBHYT17fSxNYj0hIUouUG9pbnRlckV2ZW50LGFjPWZ1bmN0aW9uKCl7dmFyIGEsYj1bXTtiLml0ZW09ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXNbYV19O2ZvcihhIGluIEdhKUdhLmhhc093blByb3BlcnR5KGEpJiZiLnB1c2goe3BhZ2VYOkdhW2FdLnBhZ2VYLHBhZ2VZOkdhW2FdLnBhZ2VZLHRhcmdldDpHYVthXS50YXJnZXR9KTtyZXR1cm4gYn0sTmI9ZnVuY3Rpb24oYSxiLGMsZCl7aWYoKGEucG9pbnRlclR5cGU9PT1cInRvdWNoXCJ8fGEucG9pbnRlclR5cGU9PT1hLk1TUE9JTlRFUl9UWVBFX1RPVUNIKSYmXG4kW29hXSlkKGEpLGQ9JFtvYV0ucG9pbnRlcixkW2JdKHt0eXBlOmMsdGFyZ2V0OmEuY3VycmVudFRhcmdldCxwcmV2ZW50RGVmYXVsdDpyYSx0b3VjaGVzOmFjKCl9KX07eChaYS5wcm90b3R5cGUse29uQ29udGFpbmVyUG9pbnRlckRvd246ZnVuY3Rpb24oYSl7TmIoYSxcIm9uQ29udGFpbmVyVG91Y2hTdGFydFwiLFwidG91Y2hzdGFydFwiLGZ1bmN0aW9uKGEpe0dhW2EucG9pbnRlcklkXT17cGFnZVg6YS5wYWdlWCxwYWdlWTphLnBhZ2VZLHRhcmdldDphLmN1cnJlbnRUYXJnZXR9fSl9LG9uQ29udGFpbmVyUG9pbnRlck1vdmU6ZnVuY3Rpb24oYSl7TmIoYSxcIm9uQ29udGFpbmVyVG91Y2hNb3ZlXCIsXCJ0b3VjaG1vdmVcIixmdW5jdGlvbihhKXtHYVthLnBvaW50ZXJJZF09e3BhZ2VYOmEucGFnZVgscGFnZVk6YS5wYWdlWX07aWYoIUdhW2EucG9pbnRlcklkXS50YXJnZXQpR2FbYS5wb2ludGVySWRdLnRhcmdldD1hLmN1cnJlbnRUYXJnZXR9KX0sb25Eb2N1bWVudFBvaW50ZXJVcDpmdW5jdGlvbihhKXtOYihhLFxuXCJvbkRvY3VtZW50VG91Y2hFbmRcIixcInRvdWNoZW5kXCIsZnVuY3Rpb24oYSl7ZGVsZXRlIEdhW2EucG9pbnRlcklkXX0pfSxiYXRjaE1TRXZlbnRzOmZ1bmN0aW9uKGEpe2EodGhpcy5jaGFydC5jb250YWluZXIsTWI/XCJwb2ludGVyZG93blwiOlwiTVNQb2ludGVyRG93blwiLHRoaXMub25Db250YWluZXJQb2ludGVyRG93bik7YSh0aGlzLmNoYXJ0LmNvbnRhaW5lcixNYj9cInBvaW50ZXJtb3ZlXCI6XCJNU1BvaW50ZXJNb3ZlXCIsdGhpcy5vbkNvbnRhaW5lclBvaW50ZXJNb3ZlKTthKEIsTWI/XCJwb2ludGVydXBcIjpcIk1TUG9pbnRlclVwXCIsdGhpcy5vbkRvY3VtZW50UG9pbnRlclVwKX19KTtVKFphLnByb3RvdHlwZSxcImluaXRcIixmdW5jdGlvbihhLGIsYyl7YS5jYWxsKHRoaXMsYixjKTt0aGlzLmhhc1pvb20mJkYoYi5jb250YWluZXIse1wiLW1zLXRvdWNoLWFjdGlvblwiOlwibm9uZVwiLFwidG91Y2gtYWN0aW9uXCI6XCJub25lXCJ9KX0pO1UoWmEucHJvdG90eXBlLFwic2V0RE9NRXZlbnRzXCIsZnVuY3Rpb24oYSl7YS5hcHBseSh0aGlzKTtcbih0aGlzLmhhc1pvb218fHRoaXMuZm9sbG93VG91Y2hNb3ZlKSYmdGhpcy5iYXRjaE1TRXZlbnRzKEQpfSk7VShaYS5wcm90b3R5cGUsXCJkZXN0cm95XCIsZnVuY3Rpb24oYSl7dGhpcy5iYXRjaE1TRXZlbnRzKFQpO2EuY2FsbCh0aGlzKX0pfXZhciB2Yj16LkxlZ2VuZD1mdW5jdGlvbihhLGIpe3RoaXMuaW5pdChhLGIpfTt2Yi5wcm90b3R5cGU9e2luaXQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLGQ9Yi5pdGVtU3R5bGUsZT1iLml0ZW1NYXJnaW5Ub3B8fDA7dGhpcy5vcHRpb25zPWI7aWYoYi5lbmFibGVkKWMuaXRlbVN0eWxlPWQsYy5pdGVtSGlkZGVuU3R5bGU9QyhkLGIuaXRlbUhpZGRlblN0eWxlKSxjLml0ZW1NYXJnaW5Ub3A9ZSxjLnBhZGRpbmc9ZD1xKGIucGFkZGluZyw4KSxjLmluaXRpYWxJdGVtWD1kLGMuaW5pdGlhbEl0ZW1ZPWQtNSxjLm1heEl0ZW1XaWR0aD0wLGMuY2hhcnQ9YSxjLml0ZW1IZWlnaHQ9MCxjLnN5bWJvbFdpZHRoPXEoYi5zeW1ib2xXaWR0aCwxNiksXG5jLnBhZ2VzPVtdLGMucmVuZGVyKCksRChjLmNoYXJ0LFwiZW5kUmVzaXplXCIsZnVuY3Rpb24oKXtjLnBvc2l0aW9uQ2hlY2tib3hlcygpfSl9LGNvbG9yaXplSXRlbTpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMub3B0aW9ucyxkPWEubGVnZW5kSXRlbSxlPWEubGVnZW5kTGluZSxmPWEubGVnZW5kU3ltYm9sLGc9dGhpcy5pdGVtSGlkZGVuU3R5bGUuY29sb3IsYz1iP2MuaXRlbVN0eWxlLmNvbG9yOmcsaD1iP2EubGVnZW5kQ29sb3J8fGEuY29sb3J8fFwiI0NDQ1wiOmcsZz1hLm9wdGlvbnMmJmEub3B0aW9ucy5tYXJrZXIsaT17ZmlsbDpofSxqO2QmJmQuY3NzKHtmaWxsOmMsY29sb3I6Y30pO2UmJmUuYXR0cih7c3Ryb2tlOmh9KTtpZihmKXtpZihnJiZmLmlzTWFya2VyKWZvcihqIGluIGkuc3Ryb2tlPWgsZz1hLmNvbnZlcnRBdHRyaWJzKGcpLGcpZD1nW2pdLGQhPT10JiYoaVtqXT1kKTtmLmF0dHIoaSl9fSxwb3NpdGlvbkl0ZW06ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5vcHRpb25zLFxuYz1iLnN5bWJvbFBhZGRpbmcsYj0hYi5ydGwsZD1hLl9sZWdlbmRJdGVtUG9zLGU9ZFswXSxkPWRbMV0sZj1hLmNoZWNrYm94OyhhPWEubGVnZW5kR3JvdXApJiZhLmVsZW1lbnQmJmEudHJhbnNsYXRlKGI/ZTp0aGlzLmxlZ2VuZFdpZHRoLWUtMipjLTQsZCk7aWYoZilmLng9ZSxmLnk9ZH0sZGVzdHJveUl0ZW06ZnVuY3Rpb24oYSl7dmFyIGI9YS5jaGVja2JveDtuKFtcImxlZ2VuZEl0ZW1cIixcImxlZ2VuZExpbmVcIixcImxlZ2VuZFN5bWJvbFwiLFwibGVnZW5kR3JvdXBcIl0sZnVuY3Rpb24oYil7YVtiXSYmKGFbYl09YVtiXS5kZXN0cm95KCkpfSk7YiYmVmEoYS5jaGVja2JveCl9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmdyb3VwLGI9dGhpcy5ib3g7aWYoYil0aGlzLmJveD1iLmRlc3Ryb3koKTtpZihhKXRoaXMuZ3JvdXA9YS5kZXN0cm95KCl9LHBvc2l0aW9uQ2hlY2tib3hlczpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmdyb3VwLmFsaWduQXR0cixjLGQ9dGhpcy5jbGlwSGVpZ2h0fHxcbnRoaXMubGVnZW5kSGVpZ2h0LGU9dGhpcy50aXRsZUhlaWdodDtpZihiKWM9Yi50cmFuc2xhdGVZLG4odGhpcy5hbGxJdGVtcyxmdW5jdGlvbihmKXt2YXIgZz1mLmNoZWNrYm94LGg7ZyYmKGg9YytlK2cueSsoYXx8MCkrMyxGKGcse2xlZnQ6Yi50cmFuc2xhdGVYK2YuY2hlY2tib3hPZmZzZXQrZy54LTIwK1wicHhcIix0b3A6aCtcInB4XCIsZGlzcGxheTpoPmMtNiYmaDxjK2QtNj9cIlwiOlwibm9uZVwifSkpfSl9LHJlbmRlclRpdGxlOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5wYWRkaW5nLGI9dGhpcy5vcHRpb25zLnRpdGxlLGM9MDtpZihiLnRleHQpe2lmKCF0aGlzLnRpdGxlKXRoaXMudGl0bGU9dGhpcy5jaGFydC5yZW5kZXJlci5sYWJlbChiLnRleHQsYS0zLGEtNCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsXCJsZWdlbmQtdGl0bGVcIikuYXR0cih7ekluZGV4OjF9KS5jc3MoYi5zdHlsZSkuYWRkKHRoaXMuZ3JvdXApO2E9dGhpcy50aXRsZS5nZXRCQm94KCk7Yz1hLmhlaWdodDt0aGlzLm9mZnNldFdpZHRoPVxuYS53aWR0aDt0aGlzLmNvbnRlbnRHcm91cC5hdHRyKHt0cmFuc2xhdGVZOmN9KX10aGlzLnRpdGxlSGVpZ2h0PWN9LHNldFRleHQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5vcHRpb25zO2EubGVnZW5kSXRlbS5hdHRyKHt0ZXh0OmIubGFiZWxGb3JtYXQ/TGEoYi5sYWJlbEZvcm1hdCxhKTpiLmxhYmVsRm9ybWF0dGVyLmNhbGwoYSl9KX0scmVuZGVySXRlbTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNoYXJ0LGM9Yi5yZW5kZXJlcixkPXRoaXMub3B0aW9ucyxlPWQubGF5b3V0PT09XCJob3Jpem9udGFsXCIsZj10aGlzLnN5bWJvbFdpZHRoLGc9ZC5zeW1ib2xQYWRkaW5nLGg9dGhpcy5pdGVtU3R5bGUsaT10aGlzLml0ZW1IaWRkZW5TdHlsZSxqPXRoaXMucGFkZGluZyxrPWU/cShkLml0ZW1EaXN0YW5jZSwyMCk6MCxsPSFkLnJ0bCxtPWQud2lkdGgsbz1kLml0ZW1NYXJnaW5Cb3R0b218fDAscD10aGlzLml0ZW1NYXJnaW5Ub3Ascj10aGlzLmluaXRpYWxJdGVtWCxBPWEubGVnZW5kSXRlbSxcbm49YS5zZXJpZXMmJmEuc2VyaWVzLmRyYXdMZWdlbmRTeW1ib2w/YS5zZXJpZXM6YSx1PW4ub3B0aW9ucyx1PXRoaXMuY3JlYXRlQ2hlY2tib3hGb3JJdGVtJiZ1JiZ1LnNob3dDaGVja2JveCx3PWQudXNlSFRNTDtpZighQSl7YS5sZWdlbmRHcm91cD1jLmcoXCJsZWdlbmQtaXRlbVwiKS5hdHRyKHt6SW5kZXg6MX0pLmFkZCh0aGlzLnNjcm9sbEdyb3VwKTthLmxlZ2VuZEl0ZW09QT1jLnRleHQoXCJcIixsP2YrZzotZyx0aGlzLmJhc2VsaW5lfHwwLHcpLmNzcyhDKGEudmlzaWJsZT9oOmkpKS5hdHRyKHthbGlnbjpsP1wibGVmdFwiOlwicmlnaHRcIix6SW5kZXg6Mn0pLmFkZChhLmxlZ2VuZEdyb3VwKTtpZighdGhpcy5iYXNlbGluZSl0aGlzLmZvbnRNZXRyaWNzPWMuZm9udE1ldHJpY3MoaC5mb250U2l6ZSxBKSx0aGlzLmJhc2VsaW5lPXRoaXMuZm9udE1ldHJpY3MuZiszK3AsQS5hdHRyKFwieVwiLHRoaXMuYmFzZWxpbmUpO24uZHJhd0xlZ2VuZFN5bWJvbCh0aGlzLGEpO3RoaXMuc2V0SXRlbUV2ZW50cyYmXG50aGlzLnNldEl0ZW1FdmVudHMoYSxBLHcsaCxpKTt1JiZ0aGlzLmNyZWF0ZUNoZWNrYm94Rm9ySXRlbShhKX10aGlzLmNvbG9yaXplSXRlbShhLGEudmlzaWJsZSk7dGhpcy5zZXRUZXh0KGEpO2M9QS5nZXRCQm94KCk7Zj1hLmNoZWNrYm94T2Zmc2V0PWQuaXRlbVdpZHRofHxhLmxlZ2VuZEl0ZW1XaWR0aHx8ZitnK2Mud2lkdGgraysodT8yMDowKTt0aGlzLml0ZW1IZWlnaHQ9Zz15KGEubGVnZW5kSXRlbUhlaWdodHx8Yy5oZWlnaHQpO2lmKGUmJnRoaXMuaXRlbVgtcitmPihtfHxiLmNoYXJ0V2lkdGgtMipqLXItZC54KSl0aGlzLml0ZW1YPXIsdGhpcy5pdGVtWSs9cCt0aGlzLmxhc3RMaW5lSGVpZ2h0K28sdGhpcy5sYXN0TGluZUhlaWdodD0wO3RoaXMubWF4SXRlbVdpZHRoPXYodGhpcy5tYXhJdGVtV2lkdGgsZik7dGhpcy5sYXN0SXRlbVk9cCt0aGlzLml0ZW1ZK287dGhpcy5sYXN0TGluZUhlaWdodD12KGcsdGhpcy5sYXN0TGluZUhlaWdodCk7YS5fbGVnZW5kSXRlbVBvcz1cblt0aGlzLml0ZW1YLHRoaXMuaXRlbVldO2U/dGhpcy5pdGVtWCs9ZjoodGhpcy5pdGVtWSs9cCtnK28sdGhpcy5sYXN0TGluZUhlaWdodD1nKTt0aGlzLm9mZnNldFdpZHRoPW18fHYoKGU/dGhpcy5pdGVtWC1yLWs6Zikraix0aGlzLm9mZnNldFdpZHRoKX0sZ2V0QWxsSXRlbXM6ZnVuY3Rpb24oKXt2YXIgYT1bXTtuKHRoaXMuY2hhcnQuc2VyaWVzLGZ1bmN0aW9uKGIpe3ZhciBjPWIub3B0aW9ucztpZihxKGMuc2hvd0luTGVnZW5kLCFzKGMubGlua2VkVG8pP3Q6ITEsITApKWE9YS5jb25jYXQoYi5sZWdlbmRJdGVtc3x8KGMubGVnZW5kVHlwZT09PVwicG9pbnRcIj9iLmRhdGE6YikpfSk7cmV0dXJuIGF9LGFkanVzdE1hcmdpbnM6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmNoYXJ0LGQ9dGhpcy5vcHRpb25zLGU9ZC5hbGlnbi5jaGFyQXQoMCkrZC52ZXJ0aWNhbEFsaWduLmNoYXJBdCgwKStkLmxheW91dC5jaGFyQXQoMCk7dGhpcy5kaXNwbGF5JiYhZC5mbG9hdGluZyYmbihbLyhsdGh8Y3R8cnRoKS8sXG4vKHJ0dnxybXxyYnYpLywvKHJiaHxjYnxsYmgpLywvKGxidnxsbXxsdHYpL10sZnVuY3Rpb24oZixnKXtmLnRlc3QoZSkmJiFzKGFbZ10pJiYoY1t1YltnXV09dihjW3ViW2ddXSxjLmxlZ2VuZFsoZysxKSUyP1wibGVnZW5kSGVpZ2h0XCI6XCJsZWdlbmRXaWR0aFwiXStbMSwtMSwtMSwxXVtnXSpkW2clMj9cInhcIjpcInlcIl0rcShkLm1hcmdpbiwxMikrYltnXSkpfSl9LHJlbmRlcjpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLmNoYXJ0LGM9Yi5yZW5kZXJlcixkPWEuZ3JvdXAsZSxmLGcsaCxpPWEuYm94LGo9YS5vcHRpb25zLGs9YS5wYWRkaW5nLGw9ai5ib3JkZXJXaWR0aCxtPWouYmFja2dyb3VuZENvbG9yO2EuaXRlbVg9YS5pbml0aWFsSXRlbVg7YS5pdGVtWT1hLmluaXRpYWxJdGVtWTthLm9mZnNldFdpZHRoPTA7YS5sYXN0SXRlbVk9MDtpZighZClhLmdyb3VwPWQ9Yy5nKFwibGVnZW5kXCIpLmF0dHIoe3pJbmRleDo3fSkuYWRkKCksYS5jb250ZW50R3JvdXA9Yy5nKCkuYXR0cih7ekluZGV4OjF9KS5hZGQoZCksXG5hLnNjcm9sbEdyb3VwPWMuZygpLmFkZChhLmNvbnRlbnRHcm91cCk7YS5yZW5kZXJUaXRsZSgpO2U9YS5nZXRBbGxJdGVtcygpO29iKGUsZnVuY3Rpb24oYSxiKXtyZXR1cm4oYS5vcHRpb25zJiZhLm9wdGlvbnMubGVnZW5kSW5kZXh8fDApLShiLm9wdGlvbnMmJmIub3B0aW9ucy5sZWdlbmRJbmRleHx8MCl9KTtqLnJldmVyc2VkJiZlLnJldmVyc2UoKTthLmFsbEl0ZW1zPWU7YS5kaXNwbGF5PWY9ISFlLmxlbmd0aDthLmxhc3RMaW5lSGVpZ2h0PTA7bihlLGZ1bmN0aW9uKGIpe2EucmVuZGVySXRlbShiKX0pO2c9KGoud2lkdGh8fGEub2Zmc2V0V2lkdGgpK2s7aD1hLmxhc3RJdGVtWSthLmxhc3RMaW5lSGVpZ2h0K2EudGl0bGVIZWlnaHQ7aD1hLmhhbmRsZU92ZXJmbG93KGgpO2grPWs7aWYobHx8bSl7aWYoaSl7aWYoZz4wJiZoPjApaVtpLmlzTmV3P1wiYXR0clwiOlwiYW5pbWF0ZVwiXShpLmNyaXNwKHt3aWR0aDpnLGhlaWdodDpofSkpLGkuaXNOZXc9ITF9ZWxzZSBhLmJveD1pPWMucmVjdCgwLFxuMCxnLGgsai5ib3JkZXJSYWRpdXMsbHx8MCkuYXR0cih7c3Ryb2tlOmouYm9yZGVyQ29sb3IsXCJzdHJva2Utd2lkdGhcIjpsfHwwLGZpbGw6bXx8XCJub25lXCJ9KS5hZGQoZCkuc2hhZG93KGouc2hhZG93KSxpLmlzTmV3PSEwO2lbZj9cInNob3dcIjpcImhpZGVcIl0oKX1hLmxlZ2VuZFdpZHRoPWc7YS5sZWdlbmRIZWlnaHQ9aDtuKGUsZnVuY3Rpb24oYil7YS5wb3NpdGlvbkl0ZW0oYil9KTtmJiZkLmFsaWduKHgoe3dpZHRoOmcsaGVpZ2h0Omh9LGopLCEwLFwic3BhY2luZ0JveFwiKTtiLmlzUmVzaXppbmd8fHRoaXMucG9zaXRpb25DaGVja2JveGVzKCl9LGhhbmRsZU92ZXJmbG93OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMsYz10aGlzLmNoYXJ0LGQ9Yy5yZW5kZXJlcixlPXRoaXMub3B0aW9ucyxmPWUueSxmPWMuc3BhY2luZ0JveC5oZWlnaHQrKGUudmVydGljYWxBbGlnbj09PVwidG9wXCI/LWY6ZiktdGhpcy5wYWRkaW5nLGc9ZS5tYXhIZWlnaHQsaCxpPXRoaXMuY2xpcFJlY3Qsaj1lLm5hdmlnYXRpb24sXG5rPXEoai5hbmltYXRpb24sITApLGw9ai5hcnJvd1NpemV8fDEyLG09dGhpcy5uYXYsbz10aGlzLnBhZ2VzLHA9dGhpcy5wYWRkaW5nLHIsQT10aGlzLmFsbEl0ZW1zLFA9ZnVuY3Rpb24oYSl7aS5hdHRyKHtoZWlnaHQ6YX0pO2lmKGIuY29udGVudEdyb3VwLmRpdiliLmNvbnRlbnRHcm91cC5kaXYuc3R5bGUuY2xpcD1cInJlY3QoXCIrcCtcInB4LDk5OTlweCxcIisocCthKStcInB4LDApXCJ9O2UubGF5b3V0PT09XCJob3Jpem9udGFsXCImJihmLz0yKTtnJiYoZj1FKGYsZykpO28ubGVuZ3RoPTA7aWYoYT5mJiZqLmVuYWJsZWQhPT0hMSl7dGhpcy5jbGlwSGVpZ2h0PWg9dihmLTIwLXRoaXMudGl0bGVIZWlnaHQtcCwwKTt0aGlzLmN1cnJlbnRQYWdlPXEodGhpcy5jdXJyZW50UGFnZSwxKTt0aGlzLmZ1bGxIZWlnaHQ9YTtuKEEsZnVuY3Rpb24oYSxiKXt2YXIgYz1hLl9sZWdlbmRJdGVtUG9zWzFdLGQ9eShhLmxlZ2VuZEl0ZW0uZ2V0QkJveCgpLmhlaWdodCksZT1vLmxlbmd0aDtpZighZXx8Yy1cbm9bZS0xXT5oJiYocnx8YykhPT1vW2UtMV0pby5wdXNoKHJ8fGMpLGUrKztiPT09QS5sZW5ndGgtMSYmYytkLW9bZS0xXT5oJiZvLnB1c2goYyk7YyE9PXImJihyPWMpfSk7aWYoIWkpaT1iLmNsaXBSZWN0PWQuY2xpcFJlY3QoMCxwLDk5OTksMCksYi5jb250ZW50R3JvdXAuY2xpcChpKTtQKGgpO2lmKCFtKXRoaXMubmF2PW09ZC5nKCkuYXR0cih7ekluZGV4OjF9KS5hZGQodGhpcy5ncm91cCksdGhpcy51cD1kLnN5bWJvbChcInRyaWFuZ2xlXCIsMCwwLGwsbCkub24oXCJjbGlja1wiLGZ1bmN0aW9uKCl7Yi5zY3JvbGwoLTEsayl9KS5hZGQobSksdGhpcy5wYWdlcj1kLnRleHQoXCJcIiwxNSwxMCkuY3NzKGouc3R5bGUpLmFkZChtKSx0aGlzLmRvd249ZC5zeW1ib2woXCJ0cmlhbmdsZS1kb3duXCIsMCwwLGwsbCkub24oXCJjbGlja1wiLGZ1bmN0aW9uKCl7Yi5zY3JvbGwoMSxrKX0pLmFkZChtKTtiLnNjcm9sbCgwKTthPWZ9ZWxzZSBpZihtKVAoYy5jaGFydEhlaWdodCksbS5oaWRlKCksdGhpcy5zY3JvbGxHcm91cC5hdHRyKHt0cmFuc2xhdGVZOjF9KSxcbnRoaXMuY2xpcEhlaWdodD0wO3JldHVybiBhfSxzY3JvbGw6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLnBhZ2VzLGQ9Yy5sZW5ndGgsZT10aGlzLmN1cnJlbnRQYWdlK2EsZj10aGlzLmNsaXBIZWlnaHQsZz10aGlzLm9wdGlvbnMubmF2aWdhdGlvbixoPWcuYWN0aXZlQ29sb3IsZz1nLmluYWN0aXZlQ29sb3IsaT10aGlzLnBhZ2VyLGo9dGhpcy5wYWRkaW5nO2U+ZCYmKGU9ZCk7aWYoZT4wKWIhPT10JiZhYihiLHRoaXMuY2hhcnQpLHRoaXMubmF2LmF0dHIoe3RyYW5zbGF0ZVg6aix0cmFuc2xhdGVZOmYrdGhpcy5wYWRkaW5nKzcrdGhpcy50aXRsZUhlaWdodCx2aXNpYmlsaXR5OlwidmlzaWJsZVwifSksdGhpcy51cC5hdHRyKHtmaWxsOmU9PT0xP2c6aH0pLmNzcyh7Y3Vyc29yOmU9PT0xP1wiZGVmYXVsdFwiOlwicG9pbnRlclwifSksaS5hdHRyKHt0ZXh0OmUrXCIvXCIrZH0pLHRoaXMuZG93bi5hdHRyKHt4OjE4K3RoaXMucGFnZXIuZ2V0QkJveCgpLndpZHRoLGZpbGw6ZT09PWQ/ZzpofSkuY3NzKHtjdXJzb3I6ZT09PVxuZD9cImRlZmF1bHRcIjpcInBvaW50ZXJcIn0pLGM9LWNbZS0xXSt0aGlzLmluaXRpYWxJdGVtWSx0aGlzLnNjcm9sbEdyb3VwLmFuaW1hdGUoe3RyYW5zbGF0ZVk6Y30pLHRoaXMuY3VycmVudFBhZ2U9ZSx0aGlzLnBvc2l0aW9uQ2hlY2tib3hlcyhjKX19O2FhPXouTGVnZW5kU3ltYm9sTWl4aW49e2RyYXdSZWN0YW5nbGU6ZnVuY3Rpb24oYSxiKXt2YXIgYz1hLm9wdGlvbnMuc3ltYm9sSGVpZ2h0fHxhLmZvbnRNZXRyaWNzLmY7Yi5sZWdlbmRTeW1ib2w9dGhpcy5jaGFydC5yZW5kZXJlci5yZWN0KDAsYS5iYXNlbGluZS1jKzEsYS5zeW1ib2xXaWR0aCxjLGEub3B0aW9ucy5zeW1ib2xSYWRpdXN8fDApLmF0dHIoe3pJbmRleDozfSkuYWRkKGIubGVnZW5kR3JvdXApfSxkcmF3TGluZU1hcmtlcjpmdW5jdGlvbihhKXt2YXIgYj10aGlzLm9wdGlvbnMsYz1iLm1hcmtlcixkPWEuc3ltYm9sV2lkdGgsZT10aGlzLmNoYXJ0LnJlbmRlcmVyLGY9dGhpcy5sZWdlbmRHcm91cCxhPWEuYmFzZWxpbmUtXG55KGEuZm9udE1ldHJpY3MuYiowLjMpLGc7aWYoYi5saW5lV2lkdGgpe2c9e1wic3Ryb2tlLXdpZHRoXCI6Yi5saW5lV2lkdGh9O2lmKGIuZGFzaFN0eWxlKWcuZGFzaHN0eWxlPWIuZGFzaFN0eWxlO3RoaXMubGVnZW5kTGluZT1lLnBhdGgoW1wiTVwiLDAsYSxcIkxcIixkLGFdKS5hdHRyKGcpLmFkZChmKX1pZihjJiZjLmVuYWJsZWQhPT0hMSliPWMucmFkaXVzLHRoaXMubGVnZW5kU3ltYm9sPWM9ZS5zeW1ib2wodGhpcy5zeW1ib2wsZC8yLWIsYS1iLDIqYiwyKmIsYykuYWRkKGYpLGMuaXNNYXJrZXI9ITB9fTsoL1RyaWRlbnRcXC83XFwuMC8udGVzdChNYSl8fFhhKSYmVSh2Yi5wcm90b3R5cGUsXCJwb3NpdGlvbkl0ZW1cIixmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMsZD1mdW5jdGlvbigpe2IuX2xlZ2VuZEl0ZW1Qb3MmJmEuY2FsbChjLGIpfTtkKCk7c2V0VGltZW91dChkKX0pO3ZhciBDYT16LkNoYXJ0PWZ1bmN0aW9uKCl7dGhpcy5nZXRBcmdzLmFwcGx5KHRoaXMsYXJndW1lbnRzKX07ei5jaGFydD1cbmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gbmV3IENhKGEsYixjKX07Q2EucHJvdG90eXBlPXtjYWxsYmFja3M6W10sZ2V0QXJnczpmdW5jdGlvbigpe3ZhciBhPVtdLnNsaWNlLmNhbGwoYXJndW1lbnRzKTtpZihEYShhWzBdKXx8YVswXS5ub2RlTmFtZSl0aGlzLnJlbmRlclRvPWEuc2hpZnQoKTt0aGlzLmluaXQoYVswXSxhWzFdKX0saW5pdDpmdW5jdGlvbihhLGIpe3ZhciBjLGQ9YS5zZXJpZXM7YS5zZXJpZXM9bnVsbDtjPUMoTixhKTtjLnNlcmllcz1hLnNlcmllcz1kO3RoaXMudXNlck9wdGlvbnM9YTtkPWMuY2hhcnQ7dGhpcy5tYXJnaW49dGhpcy5zcGxhc2hBcnJheShcIm1hcmdpblwiLGQpO3RoaXMuc3BhY2luZz10aGlzLnNwbGFzaEFycmF5KFwic3BhY2luZ1wiLGQpO3ZhciBlPWQuZXZlbnRzO3RoaXMuYm91bmRzPXtoOnt9LHY6e319O3RoaXMuY2FsbGJhY2s9Yjt0aGlzLmlzUmVzaXppbmc9MDt0aGlzLm9wdGlvbnM9Yzt0aGlzLmF4ZXM9W107dGhpcy5zZXJpZXM9W107dGhpcy5oYXNDYXJ0ZXNpYW5TZXJpZXM9XG5kLnNob3dBeGVzO3ZhciBmPXRoaXMsZztmLmluZGV4PSQubGVuZ3RoOyQucHVzaChmKTtsYisrO2QucmVmbG93IT09ITEmJkQoZixcImxvYWRcIixmdW5jdGlvbigpe2YuaW5pdFJlZmxvdygpfSk7aWYoZSlmb3IoZyBpbiBlKUQoZixnLGVbZ10pO2YueEF4aXM9W107Zi55QXhpcz1bXTtmLmFuaW1hdGlvbj1xYT8hMTpxKGQuYW5pbWF0aW9uLCEwKTtmLnBvaW50Q291bnQ9Zi5jb2xvckNvdW50ZXI9Zi5zeW1ib2xDb3VudGVyPTA7Zi5maXJzdFJlbmRlcigpfSxpbml0U2VyaWVzOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMub3B0aW9ucy5jaGFydDsoYj1LW2EudHlwZXx8Yi50eXBlfHxiLmRlZmF1bHRTZXJpZXNUeXBlXSl8fGdhKDE3LCEwKTtiPW5ldyBiO2IuaW5pdCh0aGlzLGEpO3JldHVybiBifSxpc0luc2lkZVBsb3Q6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPWM/YjphLGE9Yz9hOmI7cmV0dXJuIGQ+PTAmJmQ8PXRoaXMucGxvdFdpZHRoJiZhPj0wJiZhPD10aGlzLnBsb3RIZWlnaHR9LFxucmVkcmF3OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuYXhlcyxjPXRoaXMuc2VyaWVzLGQ9dGhpcy5wb2ludGVyLGU9dGhpcy5sZWdlbmQsZj10aGlzLmlzRGlydHlMZWdlbmQsZyxoLGk9dGhpcy5oYXNDYXJ0ZXNpYW5TZXJpZXMsaj10aGlzLmlzRGlydHlCb3gsaz1jLmxlbmd0aCxsPWssbT10aGlzLnJlbmRlcmVyLG89bS5pc0hpZGRlbigpLHA9W107YWIoYSx0aGlzKTtvJiZ0aGlzLmNsb25lUmVuZGVyVG8oKTtmb3IodGhpcy5sYXlPdXRUaXRsZXMoKTtsLS07KWlmKGE9Y1tsXSxhLm9wdGlvbnMuc3RhY2tpbmcmJihnPSEwLGEuaXNEaXJ0eSkpe2g9ITA7YnJlYWt9aWYoaClmb3IobD1rO2wtLTspaWYoYT1jW2xdLGEub3B0aW9ucy5zdGFja2luZylhLmlzRGlydHk9ITA7bihjLGZ1bmN0aW9uKGEpe2EuaXNEaXJ0eSYmYS5vcHRpb25zLmxlZ2VuZFR5cGU9PT1cInBvaW50XCImJihhLnVwZGF0ZVRvdGFscyYmYS51cGRhdGVUb3RhbHMoKSxmPSEwKX0pO2lmKGYmJmUub3B0aW9ucy5lbmFibGVkKWUucmVuZGVyKCksXG50aGlzLmlzRGlydHlMZWdlbmQ9ITE7ZyYmdGhpcy5nZXRTdGFja3MoKTtpZihpJiYhdGhpcy5pc1Jlc2l6aW5nKXRoaXMubWF4VGlja3M9bnVsbCxuKGIsZnVuY3Rpb24oYSl7YS5zZXRTY2FsZSgpfSk7dGhpcy5nZXRNYXJnaW5zKCk7aSYmKG4oYixmdW5jdGlvbihhKXthLmlzRGlydHkmJihqPSEwKX0pLG4oYixmdW5jdGlvbihhKXt2YXIgYj1hLm1pbitcIixcIithLm1heDtpZihhLmV4dEtleSE9PWIpYS5leHRLZXk9YixwLnB1c2goZnVuY3Rpb24oKXtNKGEsXCJhZnRlclNldEV4dHJlbWVzXCIseChhLmV2ZW50QXJncyxhLmdldEV4dHJlbWVzKCkpKTtkZWxldGUgYS5ldmVudEFyZ3N9KTsoanx8ZykmJmEucmVkcmF3KCl9KSk7aiYmdGhpcy5kcmF3Q2hhcnRCb3goKTtuKGMsZnVuY3Rpb24oYSl7YS5pc0RpcnR5JiZhLnZpc2libGUmJighYS5pc0NhcnRlc2lhbnx8YS54QXhpcykmJmEucmVkcmF3KCl9KTtkJiZkLnJlc2V0KCEwKTttLmRyYXcoKTtNKHRoaXMsXCJyZWRyYXdcIik7byYmdGhpcy5jbG9uZVJlbmRlclRvKCEwKTtcbm4ocCxmdW5jdGlvbihhKXthLmNhbGwoKX0pfSxnZXQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5heGVzLGM9dGhpcy5zZXJpZXMsZCxlO2ZvcihkPTA7ZDxiLmxlbmd0aDtkKyspaWYoYltkXS5vcHRpb25zLmlkPT09YSlyZXR1cm4gYltkXTtmb3IoZD0wO2Q8Yy5sZW5ndGg7ZCsrKWlmKGNbZF0ub3B0aW9ucy5pZD09PWEpcmV0dXJuIGNbZF07Zm9yKGQ9MDtkPGMubGVuZ3RoO2QrKyl7ZT1jW2RdLnBvaW50c3x8W107Zm9yKGI9MDtiPGUubGVuZ3RoO2IrKylpZihlW2JdLmlkPT09YSlyZXR1cm4gZVtiXX1yZXR1cm4gbnVsbH0sZ2V0QXhlczpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj10aGlzLm9wdGlvbnMsYz1iLnhBeGlzPXZhKGIueEF4aXN8fHt9KSxiPWIueUF4aXM9dmEoYi55QXhpc3x8e30pO24oYyxmdW5jdGlvbihhLGIpe2EuaW5kZXg9YjthLmlzWD0hMH0pO24oYixmdW5jdGlvbihhLGIpe2EuaW5kZXg9Yn0pO2M9Yy5jb25jYXQoYik7bihjLGZ1bmN0aW9uKGIpe25ldyBJKGEsXG5iKX0pfSxnZXRTZWxlY3RlZFBvaW50czpmdW5jdGlvbigpe3ZhciBhPVtdO24odGhpcy5zZXJpZXMsZnVuY3Rpb24oYil7YT1hLmNvbmNhdChTYShiLnBvaW50c3x8W10sZnVuY3Rpb24oYSl7cmV0dXJuIGEuc2VsZWN0ZWR9KSl9KTtyZXR1cm4gYX0sZ2V0U2VsZWN0ZWRTZXJpZXM6ZnVuY3Rpb24oKXtyZXR1cm4gU2EodGhpcy5zZXJpZXMsZnVuY3Rpb24oYSl7cmV0dXJuIGEuc2VsZWN0ZWR9KX0sc2V0VGl0bGU6ZnVuY3Rpb24oYSxiLGMpe3ZhciBnO3ZhciBkPXRoaXMsZT1kLm9wdGlvbnMsZjtmPWUudGl0bGU9QyhlLnRpdGxlLGEpO2c9ZS5zdWJ0aXRsZT1DKGUuc3VidGl0bGUsYiksZT1nO24oW1tcInRpdGxlXCIsYSxmXSxbXCJzdWJ0aXRsZVwiLGIsZV1dLGZ1bmN0aW9uKGEpe3ZhciBiPWFbMF0sYz1kW2JdLGU9YVsxXSxhPWFbMl07YyYmZSYmKGRbYl09Yz1jLmRlc3Ryb3koKSk7YSYmYS50ZXh0JiYhYyYmKGRbYl09ZC5yZW5kZXJlci50ZXh0KGEudGV4dCwwLDAsYS51c2VIVE1MKS5hdHRyKHthbGlnbjphLmFsaWduLFxuXCJjbGFzc1wiOlwiaGlnaGNoYXJ0cy1cIitiLHpJbmRleDphLnpJbmRleHx8NH0pLmNzcyhhLnN0eWxlKS5hZGQoKSl9KTtkLmxheU91dFRpdGxlcyhjKX0sbGF5T3V0VGl0bGVzOmZ1bmN0aW9uKGEpe3ZhciBiPTAsYz10aGlzLnRpdGxlLGQ9dGhpcy5zdWJ0aXRsZSxlPXRoaXMub3B0aW9ucyxmPWUudGl0bGUsZT1lLnN1YnRpdGxlLGc9dGhpcy5yZW5kZXJlcixoPXRoaXMuc3BhY2luZ0JveC53aWR0aC00NDtpZihjJiYoYy5jc3Moe3dpZHRoOihmLndpZHRofHxoKStcInB4XCJ9KS5hbGlnbih4KHt5OmcuZm9udE1ldHJpY3MoZi5zdHlsZS5mb250U2l6ZSxjKS5iLTN9LGYpLCExLFwic3BhY2luZ0JveFwiKSwhZi5mbG9hdGluZyYmIWYudmVydGljYWxBbGlnbikpYj1jLmdldEJCb3goKS5oZWlnaHQ7ZCYmKGQuY3NzKHt3aWR0aDooZS53aWR0aHx8aCkrXCJweFwifSkuYWxpZ24oeCh7eTpiKyhmLm1hcmdpbi0xMykrZy5mb250TWV0cmljcyhlLnN0eWxlLmZvbnRTaXplLGMpLmJ9LGUpLCExLFwic3BhY2luZ0JveFwiKSxcbiFlLmZsb2F0aW5nJiYhZS52ZXJ0aWNhbEFsaWduJiYoYj1GYShiK2QuZ2V0QkJveCgpLmhlaWdodCkpKTtjPXRoaXMudGl0bGVPZmZzZXQhPT1iO3RoaXMudGl0bGVPZmZzZXQ9YjtpZighdGhpcy5pc0RpcnR5Qm94JiZjKXRoaXMuaXNEaXJ0eUJveD1jLHRoaXMuaGFzUmVuZGVyZWQmJnEoYSwhMCkmJnRoaXMuaXNEaXJ0eUJveCYmdGhpcy5yZWRyYXcoKX0sZ2V0Q2hhcnRTaXplOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcHRpb25zLmNoYXJ0LGI9YS53aWR0aCxhPWEuaGVpZ2h0LGM9dGhpcy5yZW5kZXJUb0Nsb25lfHx0aGlzLnJlbmRlclRvO2lmKCFzKGIpKXRoaXMuY29udGFpbmVyV2lkdGg9eGEoYyxcIndpZHRoXCIpO2lmKCFzKGEpKXRoaXMuY29udGFpbmVySGVpZ2h0PXhhKGMsXCJoZWlnaHRcIik7dGhpcy5jaGFydFdpZHRoPXYoMCxifHx0aGlzLmNvbnRhaW5lcldpZHRofHw2MDApO3RoaXMuY2hhcnRIZWlnaHQ9digwLHEoYSx0aGlzLmNvbnRhaW5lckhlaWdodD4xOT90aGlzLmNvbnRhaW5lckhlaWdodDpcbjQwMCkpfSxjbG9uZVJlbmRlclRvOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMucmVuZGVyVG9DbG9uZSxjPXRoaXMuY29udGFpbmVyO2E/YiYmKHRoaXMucmVuZGVyVG8uYXBwZW5kQ2hpbGQoYyksVmEoYiksZGVsZXRlIHRoaXMucmVuZGVyVG9DbG9uZSk6KGMmJmMucGFyZW50Tm9kZT09PXRoaXMucmVuZGVyVG8mJnRoaXMucmVuZGVyVG8ucmVtb3ZlQ2hpbGQoYyksdGhpcy5yZW5kZXJUb0Nsb25lPWI9dGhpcy5yZW5kZXJUby5jbG9uZU5vZGUoMCksRihiLHtwb3NpdGlvbjpcImFic29sdXRlXCIsdG9wOlwiLTk5OTlweFwiLGRpc3BsYXk6XCJibG9ja1wifSksYi5zdHlsZS5zZXRQcm9wZXJ0eSYmYi5zdHlsZS5zZXRQcm9wZXJ0eShcImRpc3BsYXlcIixcImJsb2NrXCIsXCJpbXBvcnRhbnRcIiksQi5ib2R5LmFwcGVuZENoaWxkKGIpLGMmJmIuYXBwZW5kQ2hpbGQoYykpfSxnZXRDb250YWluZXI6ZnVuY3Rpb24oKXt2YXIgYSxiPXRoaXMub3B0aW9ucyxjPWIuY2hhcnQsZCxlO2E9dGhpcy5yZW5kZXJUbztcbnZhciBmPVwiaGlnaGNoYXJ0cy1cIitKYisrO2lmKCFhKXRoaXMucmVuZGVyVG89YT1jLnJlbmRlclRvO2lmKERhKGEpKXRoaXMucmVuZGVyVG89YT1CLmdldEVsZW1lbnRCeUlkKGEpO2F8fGdhKDEzLCEwKTtkPUcoWChhLFwiZGF0YS1oaWdoY2hhcnRzLWNoYXJ0XCIpKTshaXNOYU4oZCkmJiRbZF0mJiRbZF0uaGFzUmVuZGVyZWQmJiRbZF0uZGVzdHJveSgpO1goYSxcImRhdGEtaGlnaGNoYXJ0cy1jaGFydFwiLHRoaXMuaW5kZXgpO2EuaW5uZXJIVE1MPVwiXCI7IWMuc2tpcENsb25lJiYhYS5vZmZzZXRXaWR0aCYmdGhpcy5jbG9uZVJlbmRlclRvKCk7dGhpcy5nZXRDaGFydFNpemUoKTtkPXRoaXMuY2hhcnRXaWR0aDtlPXRoaXMuY2hhcnRIZWlnaHQ7dGhpcy5jb250YWluZXI9YT1lYShXYSx7Y2xhc3NOYW1lOlwiaGlnaGNoYXJ0cy1jb250YWluZXJcIisoYy5jbGFzc05hbWU/XCIgXCIrYy5jbGFzc05hbWU6XCJcIiksaWQ6Zn0seCh7cG9zaXRpb246XCJyZWxhdGl2ZVwiLG92ZXJmbG93OlwiaGlkZGVuXCIsd2lkdGg6ZCtcblwicHhcIixoZWlnaHQ6ZStcInB4XCIsdGV4dEFsaWduOlwibGVmdFwiLGxpbmVIZWlnaHQ6XCJub3JtYWxcIix6SW5kZXg6MCxcIi13ZWJraXQtdGFwLWhpZ2hsaWdodC1jb2xvclwiOlwicmdiYSgwLDAsMCwwKVwifSxjLnN0eWxlKSx0aGlzLnJlbmRlclRvQ2xvbmV8fGEpO3RoaXMuX2N1cnNvcj1hLnN0eWxlLmN1cnNvcjt0aGlzLnJlbmRlcmVyPW5ldyAoeltjLnJlbmRlcmVyXXx8WWEpKGEsZCxlLGMuc3R5bGUsYy5mb3JFeHBvcnQsYi5leHBvcnRpbmcmJmIuZXhwb3J0aW5nLmFsbG93SFRNTCk7cWEmJnRoaXMucmVuZGVyZXIuY3JlYXRlKHRoaXMsYSxkLGUpO3RoaXMucmVuZGVyZXIuY2hhcnRJbmRleD10aGlzLmluZGV4fSxnZXRNYXJnaW5zOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuc3BhY2luZyxjPXRoaXMubWFyZ2luLGQ9dGhpcy50aXRsZU9mZnNldDt0aGlzLnJlc2V0TWFyZ2lucygpO2lmKGQmJiFzKGNbMF0pKXRoaXMucGxvdFRvcD12KHRoaXMucGxvdFRvcCxkK3RoaXMub3B0aW9ucy50aXRsZS5tYXJnaW4rXG5iWzBdKTt0aGlzLmxlZ2VuZC5hZGp1c3RNYXJnaW5zKGMsYik7dGhpcy5leHRyYUJvdHRvbU1hcmdpbiYmKHRoaXMubWFyZ2luQm90dG9tKz10aGlzLmV4dHJhQm90dG9tTWFyZ2luKTt0aGlzLmV4dHJhVG9wTWFyZ2luJiYodGhpcy5wbG90VG9wKz10aGlzLmV4dHJhVG9wTWFyZ2luKTthfHx0aGlzLmdldEF4aXNNYXJnaW5zKCl9LGdldEF4aXNNYXJnaW5zOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEuYXhpc09mZnNldD1bMCwwLDAsMF0sYz1hLm1hcmdpbjthLmhhc0NhcnRlc2lhblNlcmllcyYmbihhLmF4ZXMsZnVuY3Rpb24oYSl7YS52aXNpYmxlJiZhLmdldE9mZnNldCgpfSk7bih1YixmdW5jdGlvbihkLGUpe3MoY1tlXSl8fChhW2RdKz1iW2VdKX0pO2Euc2V0Q2hhcnRTaXplKCl9LHJlZmxvdzpmdW5jdGlvbihhKXt2YXIgYj10aGlzLGM9Yi5vcHRpb25zLmNoYXJ0LGQ9Yi5yZW5kZXJUbyxlPWMud2lkdGh8fHhhKGQsXCJ3aWR0aFwiKSxmPWMuaGVpZ2h0fHx4YShkLFwiaGVpZ2h0XCIpLFxuYz1hP2EudGFyZ2V0Oko7aWYoIWIuaGFzVXNlclNpemUmJiFiLmlzUHJpbnRpbmcmJmUmJmYmJihjPT09Snx8Yz09PUIpKXtpZihlIT09Yi5jb250YWluZXJXaWR0aHx8ZiE9PWIuY29udGFpbmVySGVpZ2h0KWNsZWFyVGltZW91dChiLnJlZmxvd1RpbWVvdXQpLGIucmVmbG93VGltZW91dD0kYShmdW5jdGlvbigpe2lmKGIuY29udGFpbmVyKWIuc2V0U2l6ZShlLGYsITEpLGIuaGFzVXNlclNpemU9bnVsbH0sYT8xMDA6MCk7Yi5jb250YWluZXJXaWR0aD1lO2IuY29udGFpbmVySGVpZ2h0PWZ9fSxpbml0UmVmbG93OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWZ1bmN0aW9uKGIpe2EucmVmbG93KGIpfTtEKEosXCJyZXNpemVcIixiKTtEKGEsXCJkZXN0cm95XCIsZnVuY3Rpb24oKXtUKEosXCJyZXNpemVcIixiKX0pfSxzZXRTaXplOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD10aGlzLGUsZixnPWQucmVuZGVyZXI7ZC5pc1Jlc2l6aW5nKz0xO2FiKGMsZCk7ZC5vbGRDaGFydEhlaWdodD1kLmNoYXJ0SGVpZ2h0O1xuZC5vbGRDaGFydFdpZHRoPWQuY2hhcnRXaWR0aDtpZihzKGEpKWQuY2hhcnRXaWR0aD1lPXYoMCx5KGEpKSxkLmhhc1VzZXJTaXplPSEhZTtpZihzKGIpKWQuY2hhcnRIZWlnaHQ9Zj12KDAseShiKSk7YT1nLmdsb2JhbEFuaW1hdGlvbjsoYT9lYjpGKShkLmNvbnRhaW5lcix7d2lkdGg6ZStcInB4XCIsaGVpZ2h0OmYrXCJweFwifSxhKTtkLnNldENoYXJ0U2l6ZSghMCk7Zy5zZXRTaXplKGUsZixjKTtkLm1heFRpY2tzPW51bGw7bihkLmF4ZXMsZnVuY3Rpb24oYSl7YS5pc0RpcnR5PSEwO2Euc2V0U2NhbGUoKX0pO24oZC5zZXJpZXMsZnVuY3Rpb24oYSl7YS5pc0RpcnR5PSEwfSk7ZC5pc0RpcnR5TGVnZW5kPSEwO2QuaXNEaXJ0eUJveD0hMDtkLmxheU91dFRpdGxlcygpO2QuZ2V0TWFyZ2lucygpO2QucmVkcmF3KGMpO2Qub2xkQ2hhcnRIZWlnaHQ9bnVsbDtNKGQsXCJyZXNpemVcIik7JGEoZnVuY3Rpb24oKXtkJiZNKGQsXCJlbmRSZXNpemVcIixudWxsLGZ1bmN0aW9uKCl7ZC5pc1Jlc2l6aW5nLT1cbjF9KX0saGIoYSkuZHVyYXRpb24pfSxzZXRDaGFydFNpemU6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5pbnZlcnRlZCxjPXRoaXMucmVuZGVyZXIsZD10aGlzLmNoYXJ0V2lkdGgsZT10aGlzLmNoYXJ0SGVpZ2h0LGY9dGhpcy5vcHRpb25zLmNoYXJ0LGc9dGhpcy5zcGFjaW5nLGg9dGhpcy5jbGlwT2Zmc2V0LGksaixrLGw7dGhpcy5wbG90TGVmdD1pPXkodGhpcy5wbG90TGVmdCk7dGhpcy5wbG90VG9wPWo9eSh0aGlzLnBsb3RUb3ApO3RoaXMucGxvdFdpZHRoPWs9digwLHkoZC1pLXRoaXMubWFyZ2luUmlnaHQpKTt0aGlzLnBsb3RIZWlnaHQ9bD12KDAseShlLWotdGhpcy5tYXJnaW5Cb3R0b20pKTt0aGlzLnBsb3RTaXplWD1iP2w6azt0aGlzLnBsb3RTaXplWT1iP2s6bDt0aGlzLnBsb3RCb3JkZXJXaWR0aD1mLnBsb3RCb3JkZXJXaWR0aHx8MDt0aGlzLnNwYWNpbmdCb3g9Yy5zcGFjaW5nQm94PXt4OmdbM10seTpnWzBdLHdpZHRoOmQtZ1szXS1nWzFdLGhlaWdodDplLWdbMF0tZ1syXX07XG50aGlzLnBsb3RCb3g9Yy5wbG90Qm94PXt4OmkseTpqLHdpZHRoOmssaGVpZ2h0Omx9O2Q9MipWKHRoaXMucGxvdEJvcmRlcldpZHRoLzIpO2I9RmEodihkLGhbM10pLzIpO2M9RmEodihkLGhbMF0pLzIpO3RoaXMuY2xpcEJveD17eDpiLHk6Yyx3aWR0aDpWKHRoaXMucGxvdFNpemVYLXYoZCxoWzFdKS8yLWIpLGhlaWdodDp2KDAsVih0aGlzLnBsb3RTaXplWS12KGQsaFsyXSkvMi1jKSl9O2F8fG4odGhpcy5heGVzLGZ1bmN0aW9uKGEpe2Euc2V0QXhpc1NpemUoKTthLnNldEF4aXNUcmFuc2xhdGlvbigpfSl9LHJlc2V0TWFyZ2luczpmdW5jdGlvbigpe3ZhciBhPXRoaXM7bih1YixmdW5jdGlvbihiLGMpe2FbYl09cShhLm1hcmdpbltjXSxhLnNwYWNpbmdbY10pfSk7YS5heGlzT2Zmc2V0PVswLDAsMCwwXTthLmNsaXBPZmZzZXQ9WzAsMCwwLDBdfSxkcmF3Q2hhcnRCb3g6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9wdGlvbnMuY2hhcnQsYj10aGlzLnJlbmRlcmVyLGM9dGhpcy5jaGFydFdpZHRoLFxuZD10aGlzLmNoYXJ0SGVpZ2h0LGU9dGhpcy5jaGFydEJhY2tncm91bmQsZj10aGlzLnBsb3RCYWNrZ3JvdW5kLGc9dGhpcy5wbG90Qm9yZGVyLGg9dGhpcy5wbG90QkdJbWFnZSxpPWEuYm9yZGVyV2lkdGh8fDAsaj1hLmJhY2tncm91bmRDb2xvcixrPWEucGxvdEJhY2tncm91bmRDb2xvcixsPWEucGxvdEJhY2tncm91bmRJbWFnZSxtPWEucGxvdEJvcmRlcldpZHRofHwwLG8scD10aGlzLnBsb3RMZWZ0LHI9dGhpcy5wbG90VG9wLEE9dGhpcy5wbG90V2lkdGgscT10aGlzLnBsb3RIZWlnaHQsbj10aGlzLnBsb3RCb3gsdz10aGlzLmNsaXBSZWN0LE89dGhpcy5jbGlwQm94O289aSsoYS5zaGFkb3c/ODowKTtpZihpfHxqKWlmKGUpZS5hbmltYXRlKGUuY3Jpc3Aoe3dpZHRoOmMtbyxoZWlnaHQ6ZC1vfSkpO2Vsc2V7ZT17ZmlsbDpqfHxcIm5vbmVcIn07aWYoaSllLnN0cm9rZT1hLmJvcmRlckNvbG9yLGVbXCJzdHJva2Utd2lkdGhcIl09aTt0aGlzLmNoYXJ0QmFja2dyb3VuZD1iLnJlY3Qoby9cbjIsby8yLGMtbyxkLW8sYS5ib3JkZXJSYWRpdXMsaSkuYXR0cihlKS5hZGRDbGFzcyhcImhpZ2hjaGFydHMtYmFja2dyb3VuZFwiKS5hZGQoKS5zaGFkb3coYS5zaGFkb3cpfWlmKGspZj9mLmFuaW1hdGUobik6dGhpcy5wbG90QmFja2dyb3VuZD1iLnJlY3QocCxyLEEscSwwKS5hdHRyKHtmaWxsOmt9KS5hZGQoKS5zaGFkb3coYS5wbG90U2hhZG93KTtpZihsKWg/aC5hbmltYXRlKG4pOnRoaXMucGxvdEJHSW1hZ2U9Yi5pbWFnZShsLHAscixBLHEpLmFkZCgpO3c/dy5hbmltYXRlKHt3aWR0aDpPLndpZHRoLGhlaWdodDpPLmhlaWdodH0pOnRoaXMuY2xpcFJlY3Q9Yi5jbGlwUmVjdChPKTtpZihtKWc/KGcuc3Ryb2tlV2lkdGg9LW0sZy5hbmltYXRlKGcuY3Jpc3Aoe3g6cCx5OnIsd2lkdGg6QSxoZWlnaHQ6cX0pKSk6dGhpcy5wbG90Qm9yZGVyPWIucmVjdChwLHIsQSxxLDAsLW0pLmF0dHIoe3N0cm9rZTphLnBsb3RCb3JkZXJDb2xvcixcInN0cm9rZS13aWR0aFwiOm0sZmlsbDpcIm5vbmVcIixcbnpJbmRleDoxfSkuYWRkKCk7dGhpcy5pc0RpcnR5Qm94PSExfSxwcm9wRnJvbVNlcmllczpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLm9wdGlvbnMuY2hhcnQsYyxkPWEub3B0aW9ucy5zZXJpZXMsZSxmO24oW1wiaW52ZXJ0ZWRcIixcImFuZ3VsYXJcIixcInBvbGFyXCJdLGZ1bmN0aW9uKGcpe2M9S1tiLnR5cGV8fGIuZGVmYXVsdFNlcmllc1R5cGVdO2Y9YVtnXXx8YltnXXx8YyYmYy5wcm90b3R5cGVbZ107Zm9yKGU9ZCYmZC5sZW5ndGg7IWYmJmUtLTspKGM9S1tkW2VdLnR5cGVdKSYmYy5wcm90b3R5cGVbZ10mJihmPSEwKTthW2ddPWZ9KX0sbGlua1NlcmllczpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLnNlcmllcztuKGIsZnVuY3Rpb24oYSl7YS5saW5rZWRTZXJpZXMubGVuZ3RoPTB9KTtuKGIsZnVuY3Rpb24oYil7dmFyIGQ9Yi5vcHRpb25zLmxpbmtlZFRvO2lmKERhKGQpJiYoZD1kPT09XCI6cHJldmlvdXNcIj9hLnNlcmllc1tiLmluZGV4LTFdOmEuZ2V0KGQpKSlkLmxpbmtlZFNlcmllcy5wdXNoKGIpLFxuYi5saW5rZWRQYXJlbnQ9ZCxiLnZpc2libGU9cShiLm9wdGlvbnMudmlzaWJsZSxkLm9wdGlvbnMudmlzaWJsZSxiLnZpc2libGUpfSl9LHJlbmRlclNlcmllczpmdW5jdGlvbigpe24odGhpcy5zZXJpZXMsZnVuY3Rpb24oYSl7YS50cmFuc2xhdGUoKTthLnJlbmRlcigpfSl9LHJlbmRlckxhYmVsczpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLm9wdGlvbnMubGFiZWxzO2IuaXRlbXMmJm4oYi5pdGVtcyxmdW5jdGlvbihjKXt2YXIgZD14KGIuc3R5bGUsYy5zdHlsZSksZT1HKGQubGVmdCkrYS5wbG90TGVmdCxmPUcoZC50b3ApK2EucGxvdFRvcCsxMjtkZWxldGUgZC5sZWZ0O2RlbGV0ZSBkLnRvcDthLnJlbmRlcmVyLnRleHQoYy5odG1sLGUsZikuYXR0cih7ekluZGV4OjJ9KS5jc3MoZCkuYWRkKCl9KX0scmVuZGVyOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5heGVzLGI9dGhpcy5yZW5kZXJlcixjPXRoaXMub3B0aW9ucyxkLGUsZixnO3RoaXMuc2V0VGl0bGUoKTt0aGlzLmxlZ2VuZD1cbm5ldyB2Yih0aGlzLGMubGVnZW5kKTt0aGlzLmdldFN0YWNrcyYmdGhpcy5nZXRTdGFja3MoKTt0aGlzLmdldE1hcmdpbnMoITApO3RoaXMuc2V0Q2hhcnRTaXplKCk7ZD10aGlzLnBsb3RXaWR0aDtlPXRoaXMucGxvdEhlaWdodC09MjE7bihhLGZ1bmN0aW9uKGEpe2Euc2V0U2NhbGUoKX0pO3RoaXMuZ2V0QXhpc01hcmdpbnMoKTtmPWQvdGhpcy5wbG90V2lkdGg+MS4xO2c9ZS90aGlzLnBsb3RIZWlnaHQ+MS4wNTtpZihmfHxnKXRoaXMubWF4VGlja3M9bnVsbCxuKGEsZnVuY3Rpb24oYSl7KGEuaG9yaXomJmZ8fCFhLmhvcml6JiZnKSYmYS5zZXRUaWNrSW50ZXJ2YWwoITApfSksdGhpcy5nZXRNYXJnaW5zKCk7dGhpcy5kcmF3Q2hhcnRCb3goKTt0aGlzLmhhc0NhcnRlc2lhblNlcmllcyYmbihhLGZ1bmN0aW9uKGEpe2EudmlzaWJsZSYmYS5yZW5kZXIoKX0pO2lmKCF0aGlzLnNlcmllc0dyb3VwKXRoaXMuc2VyaWVzR3JvdXA9Yi5nKFwic2VyaWVzLWdyb3VwXCIpLmF0dHIoe3pJbmRleDozfSkuYWRkKCk7XG50aGlzLnJlbmRlclNlcmllcygpO3RoaXMucmVuZGVyTGFiZWxzKCk7dGhpcy5zaG93Q3JlZGl0cyhjLmNyZWRpdHMpO3RoaXMuaGFzUmVuZGVyZWQ9ITB9LHNob3dDcmVkaXRzOmZ1bmN0aW9uKGEpe2lmKGEuZW5hYmxlZCYmIXRoaXMuY3JlZGl0cyl0aGlzLmNyZWRpdHM9dGhpcy5yZW5kZXJlci50ZXh0KGEudGV4dCwwLDApLm9uKFwiY2xpY2tcIixmdW5jdGlvbigpe2lmKGEuaHJlZilKLmxvY2F0aW9uLmhyZWY9YS5ocmVmfSkuYXR0cih7YWxpZ246YS5wb3NpdGlvbi5hbGlnbix6SW5kZXg6OH0pLmNzcyhhLnN0eWxlKS5hZGQoKS5hbGlnbihhLnBvc2l0aW9uKX0sZGVzdHJveTpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLmF4ZXMsYz1hLnNlcmllcyxkPWEuY29udGFpbmVyLGUsZj1kJiZkLnBhcmVudE5vZGU7TShhLFwiZGVzdHJveVwiKTskW2EuaW5kZXhdPXQ7bGItLTthLnJlbmRlclRvLnJlbW92ZUF0dHJpYnV0ZShcImRhdGEtaGlnaGNoYXJ0cy1jaGFydFwiKTtUKGEpO2ZvcihlPWIubGVuZ3RoO2UtLTspYltlXT1cbmJbZV0uZGVzdHJveSgpO2ZvcihlPWMubGVuZ3RoO2UtLTspY1tlXT1jW2VdLmRlc3Ryb3koKTtuKFwidGl0bGUsc3VidGl0bGUsY2hhcnRCYWNrZ3JvdW5kLHBsb3RCYWNrZ3JvdW5kLHBsb3RCR0ltYWdlLHBsb3RCb3JkZXIsc2VyaWVzR3JvdXAsY2xpcFJlY3QsY3JlZGl0cyxwb2ludGVyLHNjcm9sbGVyLHJhbmdlU2VsZWN0b3IsbGVnZW5kLHJlc2V0Wm9vbUJ1dHRvbix0b29sdGlwLHJlbmRlcmVyXCIuc3BsaXQoXCIsXCIpLGZ1bmN0aW9uKGIpe3ZhciBjPWFbYl07YyYmYy5kZXN0cm95JiYoYVtiXT1jLmRlc3Ryb3koKSl9KTtpZihkKWQuaW5uZXJIVE1MPVwiXCIsVChkKSxmJiZWYShkKTtmb3IoZSBpbiBhKWRlbGV0ZSBhW2VdfSxpc1JlYWR5VG9SZW5kZXI6ZnVuY3Rpb24oKXt2YXIgYT10aGlzO3JldHVybiFqYSYmSj09Si50b3AmJkIucmVhZHlTdGF0ZSE9PVwiY29tcGxldGVcInx8cWEmJiFKLmNhbnZnPyhxYT9XYi5wdXNoKGZ1bmN0aW9uKCl7YS5maXJzdFJlbmRlcigpfSxhLm9wdGlvbnMuZ2xvYmFsLmNhbnZhc1Rvb2xzVVJMKTpcbkIuYXR0YWNoRXZlbnQoXCJvbnJlYWR5c3RhdGVjaGFuZ2VcIixmdW5jdGlvbigpe0IuZGV0YWNoRXZlbnQoXCJvbnJlYWR5c3RhdGVjaGFuZ2VcIixhLmZpcnN0UmVuZGVyKTtCLnJlYWR5U3RhdGU9PT1cImNvbXBsZXRlXCImJmEuZmlyc3RSZW5kZXIoKX0pLCExKTohMH0sZmlyc3RSZW5kZXI6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5vcHRpb25zO2lmKGEuaXNSZWFkeVRvUmVuZGVyKCkpe2EuZ2V0Q29udGFpbmVyKCk7TShhLFwiaW5pdFwiKTthLnJlc2V0TWFyZ2lucygpO2Euc2V0Q2hhcnRTaXplKCk7YS5wcm9wRnJvbVNlcmllcygpO2EuZ2V0QXhlcygpO24oYi5zZXJpZXN8fFtdLGZ1bmN0aW9uKGIpe2EuaW5pdFNlcmllcyhiKX0pO2EubGlua1NlcmllcygpO00oYSxcImJlZm9yZVJlbmRlclwiKTtpZih6LlBvaW50ZXIpYS5wb2ludGVyPW5ldyBaYShhLGIpO2EucmVuZGVyKCk7YS5yZW5kZXJlci5kcmF3KCk7aWYoIWEucmVuZGVyZXIuaW1nQ291bnQmJmEub25sb2FkKWEub25sb2FkKCk7XG5hLmNsb25lUmVuZGVyVG8oITApfX0sb25sb2FkOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcztuKFt0aGlzLmNhbGxiYWNrXS5jb25jYXQodGhpcy5jYWxsYmFja3MpLGZ1bmN0aW9uKGIpe2ImJmEuaW5kZXghPT12b2lkIDAmJmIuYXBwbHkoYSxbYV0pfSk7TShhLFwibG9hZFwiKTt0aGlzLm9ubG9hZD1udWxsfSxzcGxhc2hBcnJheTpmdW5jdGlvbihhLGIpe3ZhciBjPWJbYV0sYz1kYShjKT9jOltjLGMsYyxjXTtyZXR1cm5bcShiW2ErXCJUb3BcIl0sY1swXSkscShiW2ErXCJSaWdodFwiXSxjWzFdKSxxKGJbYStcIkJvdHRvbVwiXSxjWzJdKSxxKGJbYStcIkxlZnRcIl0sY1szXSldfX07dmFyIGJjPXouQ2VudGVyZWRTZXJpZXNNaXhpbj17Z2V0Q2VudGVyOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcHRpb25zLGI9dGhpcy5jaGFydCxjPTIqKGEuc2xpY2VkT2Zmc2V0fHwwKSxkPWIucGxvdFdpZHRoLTIqYyxiPWIucGxvdEhlaWdodC0yKmMsZT1hLmNlbnRlcixlPVtxKGVbMF0sXCI1MCVcIikscShlWzFdLFwiNTAlXCIpLFxuYS5zaXplfHxcIjEwMCVcIixhLmlubmVyU2l6ZXx8MF0sZj1FKGQsYiksZyxoO2ZvcihnPTA7Zzw0OysrZyloPWVbZ10sYT1nPDJ8fGc9PT0yJiYvJSQvLnRlc3QoaCksZVtnXT0oLyUkLy50ZXN0KGgpP1tkLGIsZixlWzJdXVtnXSpwYXJzZUZsb2F0KGgpLzEwMDpwYXJzZUZsb2F0KGgpKSsoYT9jOjApO2VbM10+ZVsyXSYmKGVbM109ZVsyXSk7cmV0dXJuIGV9fSxIYT1mdW5jdGlvbigpe307SGEucHJvdG90eXBlPXtpbml0OmZ1bmN0aW9uKGEsYixjKXt0aGlzLnNlcmllcz1hO3RoaXMuY29sb3I9YS5jb2xvcjt0aGlzLmFwcGx5T3B0aW9ucyhiLGMpO3RoaXMucG9pbnRBdHRyPXt9O2lmKGEub3B0aW9ucy5jb2xvckJ5UG9pbnQmJihiPWEub3B0aW9ucy5jb2xvcnN8fGEuY2hhcnQub3B0aW9ucy5jb2xvcnMsdGhpcy5jb2xvcj10aGlzLmNvbG9yfHxiW2EuY29sb3JDb3VudGVyKytdLGEuY29sb3JDb3VudGVyPT09Yi5sZW5ndGgpKWEuY29sb3JDb3VudGVyPTA7YS5jaGFydC5wb2ludENvdW50Kys7XG5yZXR1cm4gdGhpc30sYXBwbHlPcHRpb25zOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5zZXJpZXMsZD1jLm9wdGlvbnMucG9pbnRWYWxLZXl8fGMucG9pbnRWYWxLZXksYT1IYS5wcm90b3R5cGUub3B0aW9uc1RvT2JqZWN0LmNhbGwodGhpcyxhKTt4KHRoaXMsYSk7dGhpcy5vcHRpb25zPXRoaXMub3B0aW9ucz94KHRoaXMub3B0aW9ucyxhKTphO2lmKGQpdGhpcy55PXRoaXNbZF07dGhpcy5pc051bGw9dGhpcy55PT09bnVsbDtpZih0aGlzLng9PT12b2lkIDAmJmMpdGhpcy54PWI9PT12b2lkIDA/Yy5hdXRvSW5jcmVtZW50KCk6YjtyZXR1cm4gdGhpc30sb3B0aW9uc1RvT2JqZWN0OmZ1bmN0aW9uKGEpe3ZhciBiPXt9LGM9dGhpcy5zZXJpZXMsZD1jLm9wdGlvbnMua2V5cyxlPWR8fGMucG9pbnRBcnJheU1hcHx8W1wieVwiXSxmPWUubGVuZ3RoLGc9MCxoPTA7aWYodHlwZW9mIGE9PT1cIm51bWJlclwifHxhPT09bnVsbCliW2VbMF1dPWE7ZWxzZSBpZihKYShhKSl7aWYoIWQmJmEubGVuZ3RoPlxuZil7Yz10eXBlb2YgYVswXTtpZihjPT09XCJzdHJpbmdcIiliLm5hbWU9YVswXTtlbHNlIGlmKGM9PT1cIm51bWJlclwiKWIueD1hWzBdO2crK31mb3IoO2g8Zjspe2lmKCFkfHxhW2ddIT09dm9pZCAwKWJbZVtoXV09YVtnXTtnKys7aCsrfX1lbHNlIGlmKHR5cGVvZiBhPT09XCJvYmplY3RcIil7Yj1hO2lmKGEuZGF0YUxhYmVscyljLl9oYXNQb2ludExhYmVscz0hMDtpZihhLm1hcmtlciljLl9oYXNQb2ludE1hcmtlcnM9ITB9cmV0dXJuIGJ9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLnNlcmllcy5jaGFydCxiPWEuaG92ZXJQb2ludHMsYzthLnBvaW50Q291bnQtLTtpZihiJiYodGhpcy5zZXRTdGF0ZSgpLEFhKGIsdGhpcyksIWIubGVuZ3RoKSlhLmhvdmVyUG9pbnRzPW51bGw7aWYodGhpcz09PWEuaG92ZXJQb2ludCl0aGlzLm9uTW91c2VPdXQoKTtpZih0aGlzLmdyYXBoaWN8fHRoaXMuZGF0YUxhYmVsKVQodGhpcyksdGhpcy5kZXN0cm95RWxlbWVudHMoKTt0aGlzLmxlZ2VuZEl0ZW0mJlxuYS5sZWdlbmQuZGVzdHJveUl0ZW0odGhpcyk7Zm9yKGMgaW4gdGhpcyl0aGlzW2NdPW51bGx9LGRlc3Ryb3lFbGVtZW50czpmdW5jdGlvbigpe2Zvcih2YXIgYT1bXCJncmFwaGljXCIsXCJkYXRhTGFiZWxcIixcImRhdGFMYWJlbFVwcGVyXCIsXCJjb25uZWN0b3JcIixcInNoYWRvd0dyb3VwXCJdLGIsYz02O2MtLTspYj1hW2NdLHRoaXNbYl0mJih0aGlzW2JdPXRoaXNbYl0uZGVzdHJveSgpKX0sZ2V0TGFiZWxDb25maWc6ZnVuY3Rpb24oKXtyZXR1cm57eDp0aGlzLmNhdGVnb3J5LHk6dGhpcy55LGNvbG9yOnRoaXMuY29sb3Isa2V5OnRoaXMubmFtZXx8dGhpcy5jYXRlZ29yeSxzZXJpZXM6dGhpcy5zZXJpZXMscG9pbnQ6dGhpcyxwZXJjZW50YWdlOnRoaXMucGVyY2VudGFnZSx0b3RhbDp0aGlzLnRvdGFsfHx0aGlzLnN0YWNrVG90YWx9fSx0b29sdGlwRm9ybWF0dGVyOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuc2VyaWVzLGM9Yi50b29sdGlwT3B0aW9ucyxkPXEoYy52YWx1ZURlY2ltYWxzLFwiXCIpLFxuZT1jLnZhbHVlUHJlZml4fHxcIlwiLGY9Yy52YWx1ZVN1ZmZpeHx8XCJcIjtuKGIucG9pbnRBcnJheU1hcHx8W1wieVwiXSxmdW5jdGlvbihiKXtiPVwie3BvaW50LlwiK2I7aWYoZXx8ZilhPWEucmVwbGFjZShiK1wifVwiLGUrYitcIn1cIitmKTthPWEucmVwbGFjZShiK1wifVwiLGIrXCI6LC5cIitkK1wiZn1cIil9KTtyZXR1cm4gTGEoYSx7cG9pbnQ6dGhpcyxzZXJpZXM6dGhpcy5zZXJpZXN9KX0sZmlyZVBvaW50RXZlbnQ6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXRoaXMsZT10aGlzLnNlcmllcy5vcHRpb25zOyhlLnBvaW50LmV2ZW50c1thXXx8ZC5vcHRpb25zJiZkLm9wdGlvbnMuZXZlbnRzJiZkLm9wdGlvbnMuZXZlbnRzW2FdKSYmdGhpcy5pbXBvcnRFdmVudHMoKTthPT09XCJjbGlja1wiJiZlLmFsbG93UG9pbnRTZWxlY3QmJihjPWZ1bmN0aW9uKGEpe2Quc2VsZWN0JiZkLnNlbGVjdChudWxsLGEuY3RybEtleXx8YS5tZXRhS2V5fHxhLnNoaWZ0S2V5KX0pO00odGhpcyxhLGIsYyl9LHZpc2libGU6ITB9O3ZhciBRPVxuei5TZXJpZXM9ZnVuY3Rpb24oKXt9O1EucHJvdG90eXBlPXtpc0NhcnRlc2lhbjohMCx0eXBlOlwibGluZVwiLHBvaW50Q2xhc3M6SGEsc29ydGVkOiEwLHJlcXVpcmVTb3J0aW5nOiEwLHBvaW50QXR0clRvT3B0aW9uczp7c3Ryb2tlOlwibGluZUNvbG9yXCIsXCJzdHJva2Utd2lkdGhcIjpcImxpbmVXaWR0aFwiLGZpbGw6XCJmaWxsQ29sb3JcIixyOlwicmFkaXVzXCJ9LGRpcmVjdFRvdWNoOiExLGF4aXNUeXBlczpbXCJ4QXhpc1wiLFwieUF4aXNcIl0sY29sb3JDb3VudGVyOjAscGFyYWxsZWxBcnJheXM6W1wieFwiLFwieVwiXSxpbml0OmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcyxkLGUsZj1hLnNlcmllcyxnPWZ1bmN0aW9uKGEsYil7cmV0dXJuIHEoYS5vcHRpb25zLmluZGV4LGEuX2kpLXEoYi5vcHRpb25zLmluZGV4LGIuX2kpfTtjLmNoYXJ0PWE7Yy5vcHRpb25zPWI9Yy5zZXRPcHRpb25zKGIpO2MubGlua2VkU2VyaWVzPVtdO2MuYmluZEF4ZXMoKTt4KGMse25hbWU6Yi5uYW1lLHN0YXRlOlwiXCIscG9pbnRBdHRyOnt9LFxudmlzaWJsZTpiLnZpc2libGUhPT0hMSxzZWxlY3RlZDpiLnNlbGVjdGVkPT09ITB9KTtpZihxYSliLmFuaW1hdGlvbj0hMTtlPWIuZXZlbnRzO2ZvcihkIGluIGUpRChjLGQsZVtkXSk7aWYoZSYmZS5jbGlja3x8Yi5wb2ludCYmYi5wb2ludC5ldmVudHMmJmIucG9pbnQuZXZlbnRzLmNsaWNrfHxiLmFsbG93UG9pbnRTZWxlY3QpYS5ydW5UcmFja2VyQ2xpY2s9ITA7Yy5nZXRDb2xvcigpO2MuZ2V0U3ltYm9sKCk7bihjLnBhcmFsbGVsQXJyYXlzLGZ1bmN0aW9uKGEpe2NbYStcIkRhdGFcIl09W119KTtjLnNldERhdGEoYi5kYXRhLCExKTtpZihjLmlzQ2FydGVzaWFuKWEuaGFzQ2FydGVzaWFuU2VyaWVzPSEwO2YucHVzaChjKTtjLl9pPWYubGVuZ3RoLTE7b2IoZixnKTt0aGlzLnlBeGlzJiZvYih0aGlzLnlBeGlzLnNlcmllcyxnKTtuKGYsZnVuY3Rpb24oYSxiKXthLmluZGV4PWI7YS5uYW1lPWEubmFtZXx8XCJTZXJpZXMgXCIrKGIrMSl9KX0sYmluZEF4ZXM6ZnVuY3Rpb24oKXt2YXIgYT1cbnRoaXMsYj1hLm9wdGlvbnMsYz1hLmNoYXJ0LGQ7bihhLmF4aXNUeXBlc3x8W10sZnVuY3Rpb24oZSl7bihjW2VdLGZ1bmN0aW9uKGMpe2Q9Yy5vcHRpb25zO2lmKGJbZV09PT1kLmluZGV4fHxiW2VdIT09dCYmYltlXT09PWQuaWR8fGJbZV09PT10JiZkLmluZGV4PT09MCljLnNlcmllcy5wdXNoKGEpLGFbZV09YyxjLmlzRGlydHk9ITB9KTshYVtlXSYmYS5vcHRpb25hbEF4aXMhPT1lJiZnYSgxOCwhMCl9KX0sdXBkYXRlUGFyYWxsZWxBcnJheXM6ZnVuY3Rpb24oYSxiKXt2YXIgYz1hLnNlcmllcyxkPWFyZ3VtZW50cztuKGMucGFyYWxsZWxBcnJheXMsdHlwZW9mIGI9PT1cIm51bWJlclwiP2Z1bmN0aW9uKGQpe3ZhciBmPWQ9PT1cInlcIiYmYy50b1lEYXRhP2MudG9ZRGF0YShhKTphW2RdO2NbZCtcIkRhdGFcIl1bYl09Zn06ZnVuY3Rpb24oYSl7QXJyYXkucHJvdG90eXBlW2JdLmFwcGx5KGNbYStcIkRhdGFcIl0sQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZCwyKSl9KX0sYXV0b0luY3JlbWVudDpmdW5jdGlvbigpe3ZhciBhPVxudGhpcy5vcHRpb25zLGI9dGhpcy54SW5jcmVtZW50LGMsZD1hLnBvaW50SW50ZXJ2YWxVbml0LGI9cShiLGEucG9pbnRTdGFydCwwKTt0aGlzLnBvaW50SW50ZXJ2YWw9Yz1xKHRoaXMucG9pbnRJbnRlcnZhbCxhLnBvaW50SW50ZXJ2YWwsMSk7ZCYmKGE9bmV3IGZhKGIpLGQ9PT1cImRheVwiP2E9K2FbcmJdKGFbYmJdKCkrYyk6ZD09PVwibW9udGhcIj9hPSthW0ZiXShhW2liXSgpK2MpOmQ9PT1cInllYXJcIiYmKGE9K2FbR2JdKGFbamJdKCkrYykpLGM9YS1iKTt0aGlzLnhJbmNyZW1lbnQ9YitjO3JldHVybiBifSxzZXRPcHRpb25zOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY2hhcnQsYz1iLm9wdGlvbnMucGxvdE9wdGlvbnMsYj1iLnVzZXJPcHRpb25zfHx7fSxkPWIucGxvdE9wdGlvbnN8fHt9LGU9Y1t0aGlzLnR5cGVdO3RoaXMudXNlck9wdGlvbnM9YTtjPUMoZSxjLnNlcmllcyxhKTt0aGlzLnRvb2x0aXBPcHRpb25zPUMoTi50b29sdGlwLE4ucGxvdE9wdGlvbnNbdGhpcy50eXBlXS50b29sdGlwLFxuYi50b29sdGlwLGQuc2VyaWVzJiZkLnNlcmllcy50b29sdGlwLGRbdGhpcy50eXBlXSYmZFt0aGlzLnR5cGVdLnRvb2x0aXAsYS50b29sdGlwKTtlLm1hcmtlcj09PW51bGwmJmRlbGV0ZSBjLm1hcmtlcjt0aGlzLnpvbmVBeGlzPWMuem9uZUF4aXM7YT10aGlzLnpvbmVzPShjLnpvbmVzfHxbXSkuc2xpY2UoKTtpZigoYy5uZWdhdGl2ZUNvbG9yfHxjLm5lZ2F0aXZlRmlsbENvbG9yKSYmIWMuem9uZXMpYS5wdXNoKHt2YWx1ZTpjW3RoaXMuem9uZUF4aXMrXCJUaHJlc2hvbGRcIl18fGMudGhyZXNob2xkfHwwLGNvbG9yOmMubmVnYXRpdmVDb2xvcixmaWxsQ29sb3I6Yy5uZWdhdGl2ZUZpbGxDb2xvcn0pO2EubGVuZ3RoJiZzKGFbYS5sZW5ndGgtMV0udmFsdWUpJiZhLnB1c2goe2NvbG9yOnRoaXMuY29sb3IsZmlsbENvbG9yOnRoaXMuZmlsbENvbG9yfSk7cmV0dXJuIGN9LGdldEN5Y2xpYzpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9dGhpcy51c2VyT3B0aW9ucyxlPVwiX1wiK2ErXCJJbmRleFwiLFxuZj1hK1wiQ291bnRlclwiO2J8fChzKGRbZV0pP2I9ZFtlXTooZFtlXT1iPXRoaXMuY2hhcnRbZl0lYy5sZW5ndGgsdGhpcy5jaGFydFtmXSs9MSksYj1jW2JdKTt0aGlzW2FdPWJ9LGdldENvbG9yOmZ1bmN0aW9uKCl7dGhpcy5vcHRpb25zLmNvbG9yQnlQb2ludD90aGlzLm9wdGlvbnMuY29sb3I9bnVsbDp0aGlzLmdldEN5Y2xpYyhcImNvbG9yXCIsdGhpcy5vcHRpb25zLmNvbG9yfHxXW3RoaXMudHlwZV0uY29sb3IsdGhpcy5jaGFydC5vcHRpb25zLmNvbG9ycyl9LGdldFN5bWJvbDpmdW5jdGlvbigpe3ZhciBhPXRoaXMub3B0aW9ucy5tYXJrZXI7dGhpcy5nZXRDeWNsaWMoXCJzeW1ib2xcIixhLnN5bWJvbCx0aGlzLmNoYXJ0Lm9wdGlvbnMuc3ltYm9scyk7aWYoL151cmwvLnRlc3QodGhpcy5zeW1ib2wpKWEucmFkaXVzPTB9LGRyYXdMZWdlbmRTeW1ib2w6YWEuZHJhd0xpbmVNYXJrZXIsc2V0RGF0YTpmdW5jdGlvbihhLGIsYyxkKXt2YXIgZT10aGlzLGY9ZS5wb2ludHMsZz1mJiZmLmxlbmd0aHx8XG4wLGgsaT1lLm9wdGlvbnMsaj1lLmNoYXJ0LGs9bnVsbCxsPWUueEF4aXMsbT1sJiYhIWwuY2F0ZWdvcmllcyxvPWkudHVyYm9UaHJlc2hvbGQscD10aGlzLnhEYXRhLHI9dGhpcy55RGF0YSxBPShoPWUucG9pbnRBcnJheU1hcCkmJmgubGVuZ3RoLGE9YXx8W107aD1hLmxlbmd0aDtiPXEoYiwhMCk7aWYoZCE9PSExJiZoJiZnPT09aCYmIWUuY3JvcHBlZCYmIWUuaGFzR3JvdXBlZERhdGEmJmUudmlzaWJsZSluKGEsZnVuY3Rpb24oYSxiKXtmW2JdLnVwZGF0ZSYmYSE9PWkuZGF0YVtiXSYmZltiXS51cGRhdGUoYSwhMSxudWxsLCExKX0pO2Vsc2V7ZS54SW5jcmVtZW50PW51bGw7ZS5jb2xvckNvdW50ZXI9MDtuKHRoaXMucGFyYWxsZWxBcnJheXMsZnVuY3Rpb24oYSl7ZVthK1wiRGF0YVwiXS5sZW5ndGg9MH0pO2lmKG8mJmg+byl7Zm9yKGM9MDtrPT09bnVsbCYmYzxoOylrPWFbY10sYysrO2lmKHVhKGspKXttPXEoaS5wb2ludFN0YXJ0LDApO2s9cShpLnBvaW50SW50ZXJ2YWwsMSk7Zm9yKGM9XG4wO2M8aDtjKyspcFtjXT1tLHJbY109YVtjXSxtKz1rO2UueEluY3JlbWVudD1tfWVsc2UgaWYoSmEoaykpaWYoQSlmb3IoYz0wO2M8aDtjKyspaz1hW2NdLHBbY109a1swXSxyW2NdPWsuc2xpY2UoMSxBKzEpO2Vsc2UgZm9yKGM9MDtjPGg7YysrKWs9YVtjXSxwW2NdPWtbMF0scltjXT1rWzFdO2Vsc2UgZ2EoMTIpfWVsc2UgZm9yKGM9MDtjPGg7YysrKWlmKGFbY10hPT10JiYoaz17c2VyaWVzOmV9LGUucG9pbnRDbGFzcy5wcm90b3R5cGUuYXBwbHlPcHRpb25zLmFwcGx5KGssW2FbY11dKSxlLnVwZGF0ZVBhcmFsbGVsQXJyYXlzKGssYyksbSYmcyhrLm5hbWUpKSlsLm5hbWVzW2sueF09ay5uYW1lO0RhKHJbMF0pJiZnYSgxNCwhMCk7ZS5kYXRhPVtdO2Uub3B0aW9ucy5kYXRhPWUudXNlck9wdGlvbnMuZGF0YT1hO2ZvcihjPWc7Yy0tOylmW2NdJiZmW2NdLmRlc3Ryb3kmJmZbY10uZGVzdHJveSgpO2lmKGwpbC5taW5SYW5nZT1sLnVzZXJNaW5SYW5nZTtlLmlzRGlydHk9ZS5pc0RpcnR5RGF0YT1cbmouaXNEaXJ0eUJveD0hMDtjPSExfWkubGVnZW5kVHlwZT09PVwicG9pbnRcIiYmKHRoaXMucHJvY2Vzc0RhdGEoKSx0aGlzLmdlbmVyYXRlUG9pbnRzKCkpO2ImJmoucmVkcmF3KGMpfSxwcm9jZXNzRGF0YTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLnhEYXRhLGM9dGhpcy55RGF0YSxkPWIubGVuZ3RoLGU7ZT0wO3ZhciBmLGcsaD10aGlzLnhBeGlzLGksaj10aGlzLm9wdGlvbnM7aT1qLmNyb3BUaHJlc2hvbGQ7dmFyIGs9dGhpcy5nZXRFeHRyZW1lc0Zyb21BbGx8fGouZ2V0RXh0cmVtZXNGcm9tQWxsLGw9dGhpcy5pc0NhcnRlc2lhbixqPWgmJmgudmFsMmxpbixtPWgmJmguaXNMb2csbyxwO2lmKGwmJiF0aGlzLmlzRGlydHkmJiFoLmlzRGlydHkmJiF0aGlzLnlBeGlzLmlzRGlydHkmJiFhKXJldHVybiExO2lmKGgpYT1oLmdldEV4dHJlbWVzKCksbz1hLm1pbixwPWEubWF4O2lmKGwmJnRoaXMuc29ydGVkJiYhayYmKCFpfHxkPml8fHRoaXMuZm9yY2VDcm9wKSlpZihiW2QtMV08b3x8XG5iWzBdPnApYj1bXSxjPVtdO2Vsc2UgaWYoYlswXTxvfHxiW2QtMV0+cCllPXRoaXMuY3JvcERhdGEodGhpcy54RGF0YSx0aGlzLnlEYXRhLG8scCksYj1lLnhEYXRhLGM9ZS55RGF0YSxlPWUuc3RhcnQsZj0hMDtmb3IoaT1iLmxlbmd0aHx8MTstLWk7KWQ9bT9qKGJbaV0pLWooYltpLTFdKTpiW2ldLWJbaS0xXSxkPjAmJihnPT09dHx8ZDxnKT9nPWQ6ZDwwJiZ0aGlzLnJlcXVpcmVTb3J0aW5nJiZnYSgxNSk7dGhpcy5jcm9wcGVkPWY7dGhpcy5jcm9wU3RhcnQ9ZTt0aGlzLnByb2Nlc3NlZFhEYXRhPWI7dGhpcy5wcm9jZXNzZWRZRGF0YT1jO3RoaXMuY2xvc2VzdFBvaW50UmFuZ2U9Z30sY3JvcERhdGE6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9YS5sZW5ndGgsZj0wLGc9ZSxoPXEodGhpcy5jcm9wU2hvdWxkZXIsMSksaTtmb3IoaT0wO2k8ZTtpKyspaWYoYVtpXT49Yyl7Zj12KDAsaS1oKTticmVha31mb3IoYz1pO2M8ZTtjKyspaWYoYVtjXT5kKXtnPWMraDticmVha31yZXR1cm57eERhdGE6YS5zbGljZShmLFxuZykseURhdGE6Yi5zbGljZShmLGcpLHN0YXJ0OmYsZW5kOmd9fSxnZW5lcmF0ZVBvaW50czpmdW5jdGlvbigpe3ZhciBhPXRoaXMub3B0aW9ucy5kYXRhLGI9dGhpcy5kYXRhLGMsZD10aGlzLnByb2Nlc3NlZFhEYXRhLGU9dGhpcy5wcm9jZXNzZWRZRGF0YSxmPXRoaXMucG9pbnRDbGFzcyxnPWQubGVuZ3RoLGg9dGhpcy5jcm9wU3RhcnR8fDAsaSxqPXRoaXMuaGFzR3JvdXBlZERhdGEsayxsPVtdLG07aWYoIWImJiFqKWI9W10sYi5sZW5ndGg9YS5sZW5ndGgsYj10aGlzLmRhdGE9Yjtmb3IobT0wO208ZzttKyspaT1oK20saj8obFttXT0obmV3IGYpLmluaXQodGhpcyxbZFttXV0uY29uY2F0KHZhKGVbbV0pKSksbFttXS5kYXRhR3JvdXA9dGhpcy5ncm91cE1hcFttXSk6KGJbaV0/az1iW2ldOmFbaV0hPT10JiYoYltpXT1rPShuZXcgZikuaW5pdCh0aGlzLGFbaV0sZFttXSkpLGxbbV09ayksbFttXS5pbmRleD1pO2lmKGImJihnIT09KGM9Yi5sZW5ndGgpfHxqKSlmb3IobT0wO208XG5jO20rKylpZihtPT09aCYmIWomJihtKz1nKSxiW21dKWJbbV0uZGVzdHJveUVsZW1lbnRzKCksYlttXS5wbG90WD10O3RoaXMuZGF0YT1iO3RoaXMucG9pbnRzPWx9LGdldEV4dHJlbWVzOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMueUF4aXMsYz10aGlzLnByb2Nlc3NlZFhEYXRhLGQsZT1bXSxmPTA7ZD10aGlzLnhBeGlzLmdldEV4dHJlbWVzKCk7dmFyIGc9ZC5taW4saD1kLm1heCxpLGosayxsLGE9YXx8dGhpcy5zdGFja2VkWURhdGF8fHRoaXMucHJvY2Vzc2VkWURhdGE7ZD1hLmxlbmd0aDtmb3IobD0wO2w8ZDtsKyspaWYoaj1jW2xdLGs9YVtsXSxpPWshPT1udWxsJiZrIT09dCYmKCFiLmlzTG9nfHxrLmxlbmd0aHx8az4wKSxqPXRoaXMuZ2V0RXh0cmVtZXNGcm9tQWxsfHx0aGlzLm9wdGlvbnMuZ2V0RXh0cmVtZXNGcm9tQWxsfHx0aGlzLmNyb3BwZWR8fChjW2wrMV18fGopPj1nJiYoY1tsLTFdfHxqKTw9aCxpJiZqKWlmKGk9ay5sZW5ndGgpZm9yKDtpLS07KWtbaV0hPT1udWxsJiZcbihlW2YrK109a1tpXSk7ZWxzZSBlW2YrK109azt0aGlzLmRhdGFNaW49T2EoZSk7dGhpcy5kYXRhTWF4PUVhKGUpfSx0cmFuc2xhdGU6ZnVuY3Rpb24oKXt0aGlzLnByb2Nlc3NlZFhEYXRhfHx0aGlzLnByb2Nlc3NEYXRhKCk7dGhpcy5nZW5lcmF0ZVBvaW50cygpO2Zvcih2YXIgYT10aGlzLm9wdGlvbnMsYj1hLnN0YWNraW5nLGM9dGhpcy54QXhpcyxkPWMuY2F0ZWdvcmllcyxlPXRoaXMueUF4aXMsZj10aGlzLnBvaW50cyxnPWYubGVuZ3RoLGg9ISF0aGlzLm1vZGlmeVZhbHVlLGk9YS5wb2ludFBsYWNlbWVudCxqPWk9PT1cImJldHdlZW5cInx8dWEoaSksaz1hLnRocmVzaG9sZCxsPWEuc3RhcnRGcm9tVGhyZXNob2xkP2s6MCxtLG8scCxyLEE9TnVtYmVyLk1BWF9WQUxVRSxhPTA7YTxnO2ErKyl7dmFyIG49ZlthXSx1PW4ueCx3PW4ueTtvPW4ubG93O3ZhciBPPWImJmUuc3RhY2tzWyh0aGlzLm5lZ1N0YWNrcyYmdzwobD8wOmspP1wiLVwiOlwiXCIpK3RoaXMuc3RhY2tLZXldO2lmKGUuaXNMb2cmJlxudyE9PW51bGwmJnc8PTApbi55PXc9bnVsbCxnYSgxMCk7bi5wbG90WD1tPUUodigtMUU1LGMudHJhbnNsYXRlKHUsMCwwLDAsMSxpLHRoaXMudHlwZT09PVwiZmxhZ3NcIikpLDFFNSk7aWYoYiYmdGhpcy52aXNpYmxlJiYhbi5pc051bGwmJk8mJk9bdV0pcj10aGlzLmdldFN0YWNrSW5kaWNhdG9yKHIsdSx0aGlzLmluZGV4KSxPPU9bdV0sdz1PLnBvaW50c1tyLmtleV0sbz13WzBdLHc9d1sxXSxvPT09bCYmKG89cShrLGUubWluKSksZS5pc0xvZyYmbzw9MCYmKG89bnVsbCksbi50b3RhbD1uLnN0YWNrVG90YWw9Ty50b3RhbCxuLnBlcmNlbnRhZ2U9Ty50b3RhbCYmbi55L08udG90YWwqMTAwLG4uc3RhY2tZPXcsTy5zZXRPZmZzZXQodGhpcy5wb2ludFhPZmZzZXR8fDAsdGhpcy5iYXJXfHwwKTtuLnlCb3R0b209cyhvKT9lLnRyYW5zbGF0ZShvLDAsMSwwLDEpOm51bGw7aCYmKHc9dGhpcy5tb2RpZnlWYWx1ZSh3LG4pKTtuLnBsb3RZPW89dHlwZW9mIHc9PT1cIm51bWJlclwiJiZ3IT09SW5maW5pdHk/XG5FKHYoLTFFNSxlLnRyYW5zbGF0ZSh3LDAsMSwwLDEpKSwxRTUpOnQ7bi5pc0luc2lkZT1vIT09dCYmbz49MCYmbzw9ZS5sZW4mJm0+PTAmJm08PWMubGVuO24uY2xpZW50WD1qP2MudHJhbnNsYXRlKHUsMCwwLDAsMSk6bTtuLm5lZ2F0aXZlPW4ueTwoa3x8MCk7bi5jYXRlZ29yeT1kJiZkW24ueF0hPT10P2Rbbi54XTpuLng7bi5pc051bGx8fChwIT09dm9pZCAwJiYoQT1FKEEsUyhtLXApKSkscD1tKX10aGlzLmNsb3Nlc3RQb2ludFJhbmdlUHg9QX0sZ2V0VmFsaWRQb2ludHM6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmNoYXJ0O3JldHVybiBTYShhfHx0aGlzLnBvaW50c3x8W10sZnVuY3Rpb24oYSl7cmV0dXJuIGImJiFjLmlzSW5zaWRlUGxvdChhLnBsb3RYLGEucGxvdFksYy5pbnZlcnRlZCk/ITE6IWEuaXNOdWxsfSl9LHNldENsaXA6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jaGFydCxjPXRoaXMub3B0aW9ucyxkPWIucmVuZGVyZXIsZT1iLmludmVydGVkLGY9dGhpcy5jbGlwQm94LFxuZz1mfHxiLmNsaXBCb3gsaD10aGlzLnNoYXJlZENsaXBLZXl8fFtcIl9zaGFyZWRDbGlwXCIsYSYmYS5kdXJhdGlvbixhJiZhLmVhc2luZyxnLmhlaWdodCxjLnhBeGlzLGMueUF4aXNdLmpvaW4oXCIsXCIpLGk9YltoXSxqPWJbaCtcIm1cIl07aWYoIWkpe2lmKGEpZy53aWR0aD0wLGJbaCtcIm1cIl09aj1kLmNsaXBSZWN0KC05OSxlPy1iLnBsb3RMZWZ0Oi1iLnBsb3RUb3AsOTksZT9iLmNoYXJ0V2lkdGg6Yi5jaGFydEhlaWdodCk7YltoXT1pPWQuY2xpcFJlY3QoZyl9YSYmKGkuY291bnQrPTEpO2lmKGMuY2xpcCE9PSExKXRoaXMuZ3JvdXAuY2xpcChhfHxmP2k6Yi5jbGlwUmVjdCksdGhpcy5tYXJrZXJHcm91cC5jbGlwKGopLHRoaXMuc2hhcmVkQ2xpcEtleT1oO2F8fChpLmNvdW50LT0xLGkuY291bnQ8PTAmJmgmJmJbaF0mJihmfHwoYltoXT1iW2hdLmRlc3Ryb3koKSksYltoK1wibVwiXSYmKGJbaCtcIm1cIl09YltoK1wibVwiXS5kZXN0cm95KCkpKSl9LGFuaW1hdGU6ZnVuY3Rpb24oYSl7dmFyIGI9XG50aGlzLmNoYXJ0LGM9dGhpcy5vcHRpb25zLmFuaW1hdGlvbixkO2lmKGMmJiFkYShjKSljPVdbdGhpcy50eXBlXS5hbmltYXRpb247YT90aGlzLnNldENsaXAoYyk6KGQ9dGhpcy5zaGFyZWRDbGlwS2V5LChhPWJbZF0pJiZhLmFuaW1hdGUoe3dpZHRoOmIucGxvdFNpemVYfSxjKSxiW2QrXCJtXCJdJiZiW2QrXCJtXCJdLmFuaW1hdGUoe3dpZHRoOmIucGxvdFNpemVYKzk5fSxjKSx0aGlzLmFuaW1hdGU9bnVsbCl9LGFmdGVyQW5pbWF0ZTpmdW5jdGlvbigpe3RoaXMuc2V0Q2xpcCgpO00odGhpcyxcImFmdGVyQW5pbWF0ZVwiKX0sZHJhd1BvaW50czpmdW5jdGlvbigpe3ZhciBhLGI9dGhpcy5wb2ludHMsYz10aGlzLmNoYXJ0LGQsZSxmLGcsaCxpLGosayxsPXRoaXMub3B0aW9ucy5tYXJrZXIsbT10aGlzLnBvaW50QXR0cltcIlwiXSxvLHAscixBPXRoaXMubWFya2VyR3JvdXAsbj1xKGwuZW5hYmxlZCx0aGlzLnhBeGlzLmlzUmFkaWFsLHRoaXMuY2xvc2VzdFBvaW50UmFuZ2VQeD4yKmwucmFkaXVzKTtcbmlmKGwuZW5hYmxlZCE9PSExfHx0aGlzLl9oYXNQb2ludE1hcmtlcnMpZm9yKGY9Yi5sZW5ndGg7Zi0tOylpZihnPWJbZl0sZD1WKGcucGxvdFgpLGU9Zy5wbG90WSxrPWcuZ3JhcGhpYyxvPWcubWFya2VyfHx7fSxwPSEhZy5tYXJrZXIsYT1uJiZvLmVuYWJsZWQ9PT10fHxvLmVuYWJsZWQscj1nLmlzSW5zaWRlLGEmJmUhPT10JiYhaXNOYU4oZSkmJmcueSE9PW51bGwpaWYoYT1nLnBvaW50QXR0cltnLnNlbGVjdGVkP1wic2VsZWN0XCI6XCJcIl18fG0saD1hLnIsaT1xKG8uc3ltYm9sLHRoaXMuc3ltYm9sKSxqPWkuaW5kZXhPZihcInVybFwiKT09PTAsaylrW3I/XCJzaG93XCI6XCJoaWRlXCJdKCEwKS5hdHRyKGEpLmFuaW1hdGUoeCh7eDpkLWgseTplLWh9LGsuc3ltYm9sTmFtZT97d2lkdGg6MipoLGhlaWdodDoyKmh9Ont9KSk7ZWxzZXtpZihyJiYoaD4wfHxqKSlnLmdyYXBoaWM9Yy5yZW5kZXJlci5zeW1ib2woaSxkLWgsZS1oLDIqaCwyKmgscD9vOmwpLmF0dHIoYSkuYWRkKEEpfWVsc2UgaWYoaylnLmdyYXBoaWM9XG5rLmRlc3Ryb3koKX0sY29udmVydEF0dHJpYnM6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9dGhpcy5wb2ludEF0dHJUb09wdGlvbnMsZixnLGg9e30sYT1hfHx7fSxiPWJ8fHt9LGM9Y3x8e30sZD1kfHx7fTtmb3IoZiBpbiBlKWc9ZVtmXSxoW2ZdPXEoYVtnXSxiW2ZdLGNbZl0sZFtmXSk7cmV0dXJuIGh9LGdldEF0dHJpYnM6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5vcHRpb25zLGM9V1thLnR5cGVdLm1hcmtlcj9iLm1hcmtlcjpiLGQ9Yy5zdGF0ZXMsZT1kLmhvdmVyLGYsZz1hLmNvbG9yLGg9YS5vcHRpb25zLm5lZ2F0aXZlQ29sb3I7Zj17c3Ryb2tlOmcsZmlsbDpnfTt2YXIgaT1hLnBvaW50c3x8W10saixrLGw9W10sbT1hLnBvaW50QXR0clRvT3B0aW9ucztqPWEuaGFzUG9pbnRTcGVjaWZpY09wdGlvbnM7dmFyIG89Yy5saW5lQ29sb3IscD1jLmZpbGxDb2xvcjtrPWIudHVyYm9UaHJlc2hvbGQ7dmFyIHI9YS56b25lcyxBPWEuem9uZUF4aXN8fFwieVwiLFA7Yi5tYXJrZXI/KGUucmFkaXVzPVxuZS5yYWRpdXN8fGMucmFkaXVzK2UucmFkaXVzUGx1cyxlLmxpbmVXaWR0aD1lLmxpbmVXaWR0aHx8Yy5saW5lV2lkdGgrZS5saW5lV2lkdGhQbHVzKTooZS5jb2xvcj1lLmNvbG9yfHx3YShlLmNvbG9yfHxnKS5icmlnaHRlbihlLmJyaWdodG5lc3MpLmdldCgpLGUubmVnYXRpdmVDb2xvcj1lLm5lZ2F0aXZlQ29sb3J8fHdhKGUubmVnYXRpdmVDb2xvcnx8aCkuYnJpZ2h0ZW4oZS5icmlnaHRuZXNzKS5nZXQoKSk7bFtcIlwiXT1hLmNvbnZlcnRBdHRyaWJzKGMsZik7bihbXCJob3ZlclwiLFwic2VsZWN0XCJdLGZ1bmN0aW9uKGIpe2xbYl09YS5jb252ZXJ0QXR0cmlicyhkW2JdLGxbXCJcIl0pfSk7YS5wb2ludEF0dHI9bDtnPWkubGVuZ3RoO2lmKCFrfHxnPGt8fGopZm9yKDtnLS07KXtrPWlbZ107aWYoKGM9ay5vcHRpb25zJiZrLm9wdGlvbnMubWFya2VyfHxrLm9wdGlvbnMpJiZjLmVuYWJsZWQ9PT0hMSljLnJhZGl1cz0wO2lmKHIubGVuZ3RoKXtqPTA7Zm9yKGY9cltqXTtrW0FdPj1mLnZhbHVlOylmPVxuclsrK2pdO2suY29sb3I9ay5maWxsQ29sb3I9cShmLmNvbG9yLGEuY29sb3IpfWo9Yi5jb2xvckJ5UG9pbnR8fGsuY29sb3I7aWYoay5vcHRpb25zKWZvcihQIGluIG0pcyhjW21bUF1dKSYmKGo9ITApO2lmKGope2M9Y3x8e307aj1bXTtkPWMuc3RhdGVzfHx7fTtmPWQuaG92ZXI9ZC5ob3Zlcnx8e307aWYoIWIubWFya2VyfHxrLm5lZ2F0aXZlJiYhZi5maWxsQ29sb3ImJiFlLmZpbGxDb2xvcilmW2EucG9pbnRBdHRyVG9PcHRpb25zLmZpbGxdPWYuY29sb3J8fCFrLm9wdGlvbnMuY29sb3ImJmVbay5uZWdhdGl2ZSYmaD9cIm5lZ2F0aXZlQ29sb3JcIjpcImNvbG9yXCJdfHx3YShrLmNvbG9yKS5icmlnaHRlbihmLmJyaWdodG5lc3N8fGUuYnJpZ2h0bmVzcykuZ2V0KCk7Zj17Y29sb3I6ay5jb2xvcn07aWYoIXApZi5maWxsQ29sb3I9ay5jb2xvcjtpZighbylmLmxpbmVDb2xvcj1rLmNvbG9yO2MuaGFzT3duUHJvcGVydHkoXCJjb2xvclwiKSYmIWMuY29sb3ImJmRlbGV0ZSBjLmNvbG9yO2pbXCJcIl09XG5hLmNvbnZlcnRBdHRyaWJzKHgoZixjKSxsW1wiXCJdKTtqLmhvdmVyPWEuY29udmVydEF0dHJpYnMoZC5ob3ZlcixsLmhvdmVyLGpbXCJcIl0pO2ouc2VsZWN0PWEuY29udmVydEF0dHJpYnMoZC5zZWxlY3QsbC5zZWxlY3QsaltcIlwiXSl9ZWxzZSBqPWw7ay5wb2ludEF0dHI9an19LGRlc3Ryb3k6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5jaGFydCxjPS9BcHBsZVdlYktpdFxcLzUzMy8udGVzdChNYSksZCxlPWEuZGF0YXx8W10sZixnLGg7TShhLFwiZGVzdHJveVwiKTtUKGEpO24oYS5heGlzVHlwZXN8fFtdLGZ1bmN0aW9uKGIpe2lmKGg9YVtiXSlBYShoLnNlcmllcyxhKSxoLmlzRGlydHk9aC5mb3JjZVJlZHJhdz0hMH0pO2EubGVnZW5kSXRlbSYmYS5jaGFydC5sZWdlbmQuZGVzdHJveUl0ZW0oYSk7Zm9yKGQ9ZS5sZW5ndGg7ZC0tOykoZj1lW2RdKSYmZi5kZXN0cm95JiZmLmRlc3Ryb3koKTthLnBvaW50cz1udWxsO2NsZWFyVGltZW91dChhLmFuaW1hdGlvblRpbWVvdXQpO2ZvcihnIGluIGEpYVtnXWluc3RhbmNlb2ZcblomJiFhW2ddLnN1cnZpdmUmJihkPWMmJmc9PT1cImdyb3VwXCI/XCJoaWRlXCI6XCJkZXN0cm95XCIsYVtnXVtkXSgpKTtpZihiLmhvdmVyU2VyaWVzPT09YSliLmhvdmVyU2VyaWVzPW51bGw7QWEoYi5zZXJpZXMsYSk7Zm9yKGcgaW4gYSlkZWxldGUgYVtnXX0sZ2V0R3JhcGhQYXRoOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD10aGlzLGU9ZC5vcHRpb25zLGY9ZS5zdGVwLGcsaD1bXSxpLGE9YXx8ZC5wb2ludHM7KGc9YS5yZXZlcnNlZCkmJmEucmV2ZXJzZSgpOyhmPXtyaWdodDoxLGNlbnRlcjoyfVtmXXx8ZiYmMykmJmcmJihmPTQtZik7ZS5jb25uZWN0TnVsbHMmJiFiJiYhYyYmKGE9dGhpcy5nZXRWYWxpZFBvaW50cyhhKSk7bihhLGZ1bmN0aW9uKGcsayl7dmFyIGw9Zy5wbG90WCxtPWcucGxvdFksbz1hW2stMV07aWYoKGcubGVmdENsaWZmfHxvJiZvLnJpZ2h0Q2xpZmYpJiYhYylpPSEwO2cuaXNOdWxsJiYhcyhiKSYmaz4wP2k9IWUuY29ubmVjdE51bGxzOmcuaXNOdWxsJiYhYj9pPSEwOlxuKGs9PT0wfHxpP289W1wiTVwiLGcucGxvdFgsZy5wbG90WV06ZC5nZXRQb2ludFNwbGluZT9vPWQuZ2V0UG9pbnRTcGxpbmUoYSxnLGspOmY/KG89Zj09PTE/W1wiTFwiLG8ucGxvdFgsbV06Zj09PTI/W1wiTFwiLChvLnBsb3RYK2wpLzIsby5wbG90WSxcIkxcIiwoby5wbG90WCtsKS8yLG1dOltcIkxcIixsLG8ucGxvdFldLG8ucHVzaChcIkxcIixsLG0pKTpvPVtcIkxcIixsLG1dLGgucHVzaC5hcHBseShoLG8pLGk9ITEpfSk7cmV0dXJuIGQuZ3JhcGhQYXRoPWh9LGRyYXdHcmFwaDpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj10aGlzLm9wdGlvbnMsYz1bW1wiZ3JhcGhcIixiLmxpbmVDb2xvcnx8dGhpcy5jb2xvcixiLmRhc2hTdHlsZV1dLGQ9Yi5saW5lV2lkdGgsZT1iLmxpbmVjYXAhPT1cInNxdWFyZVwiLGY9KHRoaXMuZ2FwcGVkUGF0aHx8dGhpcy5nZXRHcmFwaFBhdGgpLmNhbGwodGhpcyksZz10aGlzLmZpbGxHcmFwaCYmdGhpcy5jb2xvcnx8XCJub25lXCI7bih0aGlzLnpvbmVzLGZ1bmN0aW9uKGQsZSl7Yy5wdXNoKFtcInpvbmVHcmFwaFwiK1xuZSxkLmNvbG9yfHxhLmNvbG9yLGQuZGFzaFN0eWxlfHxiLmRhc2hTdHlsZV0pfSk7bihjLGZ1bmN0aW9uKGMsaSl7dmFyIGo9Y1swXSxrPWFbal07aWYoaylrLmFuaW1hdGUoe2Q6Zn0pO2Vsc2UgaWYoKGR8fGcpJiZmLmxlbmd0aClrPXtzdHJva2U6Y1sxXSxcInN0cm9rZS13aWR0aFwiOmQsZmlsbDpnLHpJbmRleDoxfSxjWzJdP2suZGFzaHN0eWxlPWNbMl06ZSYmKGtbXCJzdHJva2UtbGluZWNhcFwiXT1rW1wic3Ryb2tlLWxpbmVqb2luXCJdPVwicm91bmRcIiksYVtqXT1hLmNoYXJ0LnJlbmRlcmVyLnBhdGgoZikuYXR0cihrKS5hZGQoYS5ncm91cCkuc2hhZG93KGk8MiYmYi5zaGFkb3cpfSl9LGFwcGx5Wm9uZXM6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9dGhpcy5jaGFydCxjPWIucmVuZGVyZXIsZD10aGlzLnpvbmVzLGUsZixnPXRoaXMuY2xpcHN8fFtdLGgsaT10aGlzLmdyYXBoLGo9dGhpcy5hcmVhLGs9dihiLmNoYXJ0V2lkdGgsYi5jaGFydEhlaWdodCksbD10aGlzWyh0aGlzLnpvbmVBeGlzfHxcblwieVwiKStcIkF4aXNcIl0sbSxvPWwucmV2ZXJzZWQscD1iLmludmVydGVkLHI9bC5ob3JpeixBLFAsdSx3PSExO2lmKGQubGVuZ3RoJiYoaXx8aikmJmwubWluIT09dClpJiZpLmhpZGUoKSxqJiZqLmhpZGUoKSxtPWwuZ2V0RXh0cmVtZXMoKSxuKGQsZnVuY3Rpb24oZCxuKXtlPW8/cj9iLnBsb3RXaWR0aDowOnI/MDpsLnRvUGl4ZWxzKG0ubWluKTtlPUUodihxKGYsZSksMCksayk7Zj1FKHYoeShsLnRvUGl4ZWxzKHEoZC52YWx1ZSxtLm1heCksITApKSwwKSxrKTt3JiYoZT1mPWwudG9QaXhlbHMobS5tYXgpKTtBPU1hdGguYWJzKGUtZik7UD1FKGUsZik7dT12KGUsZik7aWYobC5pc1hBeGlzKXtpZihoPXt4OnA/dTpQLHk6MCx3aWR0aDpBLGhlaWdodDprfSwhciloLng9Yi5wbG90SGVpZ2h0LWgueH1lbHNlIGlmKGg9e3g6MCx5OnA/dTpQLHdpZHRoOmssaGVpZ2h0OkF9LHIpaC55PWIucGxvdFdpZHRoLWgueTtiLmludmVydGVkJiZjLmlzVk1MJiYoaD1sLmlzWEF4aXM/e3g6MCx5Om8/XG5QOnUsaGVpZ2h0Omgud2lkdGgsd2lkdGg6Yi5jaGFydFdpZHRofTp7eDpoLnktYi5wbG90TGVmdC1iLnNwYWNpbmdCb3gueCx5OjAsd2lkdGg6aC5oZWlnaHQsaGVpZ2h0OmIuY2hhcnRIZWlnaHR9KTtnW25dP2dbbl0uYW5pbWF0ZShoKTooZ1tuXT1jLmNsaXBSZWN0KGgpLGkmJmFbXCJ6b25lR3JhcGhcIituXS5jbGlwKGdbbl0pLGomJmFbXCJ6b25lQXJlYVwiK25dLmNsaXAoZ1tuXSkpO3c9ZC52YWx1ZT5tLm1heH0pLHRoaXMuY2xpcHM9Z30saW52ZXJ0R3JvdXBzOmZ1bmN0aW9uKCl7ZnVuY3Rpb24gYSgpe3ZhciBhPXt3aWR0aDpiLnlBeGlzLmxlbixoZWlnaHQ6Yi54QXhpcy5sZW59O24oW1wiZ3JvdXBcIixcIm1hcmtlckdyb3VwXCJdLGZ1bmN0aW9uKGMpe2JbY10mJmJbY10uYXR0cihhKS5pbnZlcnQoKX0pfXZhciBiPXRoaXMsYz1iLmNoYXJ0O2lmKGIueEF4aXMpRChjLFwicmVzaXplXCIsYSksRChiLFwiZGVzdHJveVwiLGZ1bmN0aW9uKCl7VChjLFwicmVzaXplXCIsYSl9KSxhKCksYi5pbnZlcnRHcm91cHM9XG5hfSxwbG90R3JvdXA6ZnVuY3Rpb24oYSxiLGMsZCxlKXt2YXIgZj10aGlzW2FdLGc9IWY7ZyYmKHRoaXNbYV09Zj10aGlzLmNoYXJ0LnJlbmRlcmVyLmcoYikuYXR0cih7ekluZGV4OmR8fDAuMX0pLmFkZChlKSxmLmFkZENsYXNzKFwiaGlnaGNoYXJ0cy1zZXJpZXMtXCIrdGhpcy5pbmRleCkpO2YuYXR0cih7dmlzaWJpbGl0eTpjfSlbZz9cImF0dHJcIjpcImFuaW1hdGVcIl0odGhpcy5nZXRQbG90Qm94KCkpO3JldHVybiBmfSxnZXRQbG90Qm94OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5jaGFydCxiPXRoaXMueEF4aXMsYz10aGlzLnlBeGlzO2lmKGEuaW52ZXJ0ZWQpYj1jLGM9dGhpcy54QXhpcztyZXR1cm57dHJhbnNsYXRlWDpiP2IubGVmdDphLnBsb3RMZWZ0LHRyYW5zbGF0ZVk6Yz9jLnRvcDphLnBsb3RUb3Asc2NhbGVYOjEsc2NhbGVZOjF9fSxyZW5kZXI6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5jaGFydCxjLGQ9YS5vcHRpb25zLGU9ISFhLmFuaW1hdGUmJmIucmVuZGVyZXIuaXNTVkcmJlxuaGIoZC5hbmltYXRpb24pLmR1cmF0aW9uLGY9YS52aXNpYmxlP1wiaW5oZXJpdFwiOlwiaGlkZGVuXCIsZz1kLnpJbmRleCxoPWEuaGFzUmVuZGVyZWQsaT1iLnNlcmllc0dyb3VwO2M9YS5wbG90R3JvdXAoXCJncm91cFwiLFwic2VyaWVzXCIsZixnLGkpO2EubWFya2VyR3JvdXA9YS5wbG90R3JvdXAoXCJtYXJrZXJHcm91cFwiLFwibWFya2Vyc1wiLGYsZyxpKTtlJiZhLmFuaW1hdGUoITApO2EuZ2V0QXR0cmlicygpO2MuaW52ZXJ0ZWQ9YS5pc0NhcnRlc2lhbj9iLmludmVydGVkOiExO2EuZHJhd0dyYXBoJiYoYS5kcmF3R3JhcGgoKSxhLmFwcGx5Wm9uZXMoKSk7bihhLnBvaW50cyxmdW5jdGlvbihhKXthLnJlZHJhdyYmYS5yZWRyYXcoKX0pO2EuZHJhd0RhdGFMYWJlbHMmJmEuZHJhd0RhdGFMYWJlbHMoKTthLnZpc2libGUmJmEuZHJhd1BvaW50cygpO2EuZHJhd1RyYWNrZXImJmEub3B0aW9ucy5lbmFibGVNb3VzZVRyYWNraW5nIT09ITEmJmEuZHJhd1RyYWNrZXIoKTtiLmludmVydGVkJiZhLmludmVydEdyb3VwcygpO1xuZC5jbGlwIT09ITEmJiFhLnNoYXJlZENsaXBLZXkmJiFoJiZjLmNsaXAoYi5jbGlwUmVjdCk7ZSYmYS5hbmltYXRlKCk7aWYoIWgpYS5hbmltYXRpb25UaW1lb3V0PSRhKGZ1bmN0aW9uKCl7YS5hZnRlckFuaW1hdGUoKX0sZSk7YS5pc0RpcnR5PWEuaXNEaXJ0eURhdGE9ITE7YS5oYXNSZW5kZXJlZD0hMH0scmVkcmF3OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5jaGFydCxiPXRoaXMuaXNEaXJ0eURhdGEsYz10aGlzLmlzRGlydHksZD10aGlzLmdyb3VwLGU9dGhpcy54QXhpcyxmPXRoaXMueUF4aXM7ZCYmKGEuaW52ZXJ0ZWQmJmQuYXR0cih7d2lkdGg6YS5wbG90V2lkdGgsaGVpZ2h0OmEucGxvdEhlaWdodH0pLGQuYW5pbWF0ZSh7dHJhbnNsYXRlWDpxKGUmJmUubGVmdCxhLnBsb3RMZWZ0KSx0cmFuc2xhdGVZOnEoZiYmZi50b3AsYS5wbG90VG9wKX0pKTt0aGlzLnRyYW5zbGF0ZSgpO3RoaXMucmVuZGVyKCk7YiYmTSh0aGlzLFwidXBkYXRlZERhdGFcIik7KGN8fGIpJiZkZWxldGUgdGhpcy5rZFRyZWV9LFxua2REaW1lbnNpb25zOjEsa2RBeGlzQXJyYXk6W1wiY2xpZW50WFwiLFwicGxvdFlcIl0sc2VhcmNoUG9pbnQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLnhBeGlzLGQ9dGhpcy55QXhpcyxlPXRoaXMuY2hhcnQuaW52ZXJ0ZWQ7cmV0dXJuIHRoaXMuc2VhcmNoS0RUcmVlKHtjbGllbnRYOmU/Yy5sZW4tYS5jaGFydFkrYy5wb3M6YS5jaGFydFgtYy5wb3MscGxvdFk6ZT9kLmxlbi1hLmNoYXJ0WCtkLnBvczphLmNoYXJ0WS1kLnBvc30sYil9LGJ1aWxkS0RUcmVlOmZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShjLGUsZil7dmFyIGcsaDtpZihoPWMmJmMubGVuZ3RoKXJldHVybiBnPWIua2RBeGlzQXJyYXlbZSVmXSxjLnNvcnQoZnVuY3Rpb24oYSxiKXtyZXR1cm4gYVtnXS1iW2ddfSksaD1NYXRoLmZsb29yKGgvMikse3BvaW50OmNbaF0sbGVmdDphKGMuc2xpY2UoMCxoKSxlKzEsZikscmlnaHQ6YShjLnNsaWNlKGgrMSksZSsxLGYpfX12YXIgYj10aGlzLGM9Yi5rZERpbWVuc2lvbnM7ZGVsZXRlIGIua2RUcmVlO1xuJGEoZnVuY3Rpb24oKXtiLmtkVHJlZT1hKGIuZ2V0VmFsaWRQb2ludHMobnVsbCwhYi5kaXJlY3RUb3VjaCksYyxjKX0sYi5vcHRpb25zLmtkTm93PzA6MSl9LHNlYXJjaEtEVHJlZTpmdW5jdGlvbihhLGIpe2Z1bmN0aW9uIGMoYSxiLGosayl7dmFyIGw9Yi5wb2ludCxtPWQua2RBeGlzQXJyYXlbaiVrXSxvLHAscj1sO3A9cyhhW2VdKSYmcyhsW2VdKT9NYXRoLnBvdyhhW2VdLWxbZV0sMik6bnVsbDtvPXMoYVtmXSkmJnMobFtmXSk/TWF0aC5wb3coYVtmXS1sW2ZdLDIpOm51bGw7bz0ocHx8MCkrKG98fDApO2wuZGlzdD1zKG8pP01hdGguc3FydChvKTpOdW1iZXIuTUFYX1ZBTFVFO2wuZGlzdFg9cyhwKT9NYXRoLnNxcnQocCk6TnVtYmVyLk1BWF9WQUxVRTttPWFbbV0tbFttXTtvPW08MD9cImxlZnRcIjpcInJpZ2h0XCI7cD1tPDA/XCJyaWdodFwiOlwibGVmdFwiO2Jbb10mJihvPWMoYSxiW29dLGorMSxrKSxyPW9bZ108cltnXT9vOmwpO2JbcF0mJk1hdGguc3FydChtKm0pPHJbZ10mJihhPWMoYSxcbmJbcF0saisxLGspLHI9YVtnXTxyW2ddP2E6cik7cmV0dXJuIHJ9dmFyIGQ9dGhpcyxlPXRoaXMua2RBeGlzQXJyYXlbMF0sZj10aGlzLmtkQXhpc0FycmF5WzFdLGc9Yj9cImRpc3RYXCI6XCJkaXN0XCI7dGhpcy5rZFRyZWV8fHRoaXMuYnVpbGRLRFRyZWUoKTtpZih0aGlzLmtkVHJlZSlyZXR1cm4gYyhhLHRoaXMua2RUcmVlLHRoaXMua2REaW1lbnNpb25zLHRoaXMua2REaW1lbnNpb25zKX19O1RiLnByb3RvdHlwZT17ZGVzdHJveTpmdW5jdGlvbigpe1BhKHRoaXMsdGhpcy5heGlzKX0scmVuZGVyOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMub3B0aW9ucyxjPWIuZm9ybWF0LGM9Yz9MYShjLHRoaXMpOmIuZm9ybWF0dGVyLmNhbGwodGhpcyk7dGhpcy5sYWJlbD90aGlzLmxhYmVsLmF0dHIoe3RleHQ6Yyx2aXNpYmlsaXR5OlwiaGlkZGVuXCJ9KTp0aGlzLmxhYmVsPXRoaXMuYXhpcy5jaGFydC5yZW5kZXJlci50ZXh0KGMsbnVsbCxudWxsLGIudXNlSFRNTCkuY3NzKGIuc3R5bGUpLmF0dHIoe2FsaWduOnRoaXMudGV4dEFsaWduLFxucm90YXRpb246Yi5yb3RhdGlvbix2aXNpYmlsaXR5OlwiaGlkZGVuXCJ9KS5hZGQoYSl9LHNldE9mZnNldDpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuYXhpcyxkPWMuY2hhcnQsZT1kLmludmVydGVkLGY9Yy5yZXZlcnNlZCxmPXRoaXMuaXNOZWdhdGl2ZSYmIWZ8fCF0aGlzLmlzTmVnYXRpdmUmJmYsZz1jLnRyYW5zbGF0ZShjLnVzZVBlcmNlbnRhZ2U/MTAwOnRoaXMudG90YWwsMCwwLDAsMSksYz1jLnRyYW5zbGF0ZSgwKSxjPVMoZy1jKSxoPWQueEF4aXNbMF0udHJhbnNsYXRlKHRoaXMueCkrYSxpPWQucGxvdEhlaWdodCxmPXt4OmU/Zj9nOmctYzpoLHk6ZT9pLWgtYjpmP2ktZy1jOmktZyx3aWR0aDplP2M6YixoZWlnaHQ6ZT9iOmN9O2lmKGU9dGhpcy5sYWJlbCllLmFsaWduKHRoaXMuYWxpZ25PcHRpb25zLG51bGwsZiksZj1lLmFsaWduQXR0cixlW3RoaXMub3B0aW9ucy5jcm9wPT09ITF8fGQuaXNJbnNpZGVQbG90KGYueCxmLnkpP1wic2hvd1wiOlwiaGlkZVwiXSghMCl9fTtDYS5wcm90b3R5cGUuZ2V0U3RhY2tzPVxuZnVuY3Rpb24oKXt2YXIgYT10aGlzO24oYS55QXhpcyxmdW5jdGlvbihhKXtpZihhLnN0YWNrcyYmYS5oYXNWaXNpYmxlU2VyaWVzKWEub2xkU3RhY2tzPWEuc3RhY2tzfSk7bihhLnNlcmllcyxmdW5jdGlvbihiKXtpZihiLm9wdGlvbnMuc3RhY2tpbmcmJihiLnZpc2libGU9PT0hMHx8YS5vcHRpb25zLmNoYXJ0Lmlnbm9yZUhpZGRlblNlcmllcz09PSExKSliLnN0YWNrS2V5PWIudHlwZStxKGIub3B0aW9ucy5zdGFjayxcIlwiKX0pfTtJLnByb3RvdHlwZS5idWlsZFN0YWNrcz1mdW5jdGlvbigpe3ZhciBhPXRoaXMuc2VyaWVzLGIsYz1xKHRoaXMub3B0aW9ucy5yZXZlcnNlZFN0YWNrcywhMCksZD1hLmxlbmd0aCxlO2lmKCF0aGlzLmlzWEF4aXMpe3RoaXMudXNlUGVyY2VudGFnZT0hMTtmb3IoZT1kO2UtLTspYVtjP2U6ZC1lLTFdLnNldFN0YWNrZWRQb2ludHMoKTtmb3IoZT1kO2UtLTspYj1hW2M/ZTpkLWUtMV0sYi5zZXRTdGFja0NsaWZmcyYmYi5zZXRTdGFja0NsaWZmcygpO2lmKHRoaXMudXNlUGVyY2VudGFnZSlmb3IoZT1cbjA7ZTxkO2UrKylhW2VdLnNldFBlcmNlbnRTdGFja3MoKX19O0kucHJvdG90eXBlLnJlbmRlclN0YWNrVG90YWxzPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5jaGFydCxiPWEucmVuZGVyZXIsYz10aGlzLnN0YWNrcyxkLGUsZj10aGlzLnN0YWNrVG90YWxHcm91cDtpZighZil0aGlzLnN0YWNrVG90YWxHcm91cD1mPWIuZyhcInN0YWNrLWxhYmVsc1wiKS5hdHRyKHt2aXNpYmlsaXR5OlwidmlzaWJsZVwiLHpJbmRleDo2fSkuYWRkKCk7Zi50cmFuc2xhdGUoYS5wbG90TGVmdCxhLnBsb3RUb3ApO2ZvcihkIGluIGMpZm9yKGUgaW4gYT1jW2RdLGEpYVtlXS5yZW5kZXIoZil9O0kucHJvdG90eXBlLnJlc2V0U3RhY2tzPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5zdGFja3MsYixjO2lmKCF0aGlzLmlzWEF4aXMpZm9yKGIgaW4gYSlmb3IoYyBpbiBhW2JdKWFbYl1bY10udG91Y2hlZDx0aGlzLnN0YWNrc1RvdWNoZWQ/KGFbYl1bY10uZGVzdHJveSgpLGRlbGV0ZSBhW2JdW2NdKTooYVtiXVtjXS50b3RhbD1cbm51bGwsYVtiXVtjXS5jdW09MCl9O0kucHJvdG90eXBlLmNsZWFuU3RhY2tzPWZ1bmN0aW9uKCl7dmFyIGEsYixjO2lmKCF0aGlzLmlzWEF4aXMpe2lmKHRoaXMub2xkU3RhY2tzKWE9dGhpcy5zdGFja3M9dGhpcy5vbGRTdGFja3M7Zm9yKGIgaW4gYSlmb3IoYyBpbiBhW2JdKWFbYl1bY10uY3VtPWFbYl1bY10udG90YWx9fTtRLnByb3RvdHlwZS5zZXRTdGFja2VkUG9pbnRzPWZ1bmN0aW9uKCl7aWYodGhpcy5vcHRpb25zLnN0YWNraW5nJiYhKHRoaXMudmlzaWJsZSE9PSEwJiZ0aGlzLmNoYXJ0Lm9wdGlvbnMuY2hhcnQuaWdub3JlSGlkZGVuU2VyaWVzIT09ITEpKXt2YXIgYT10aGlzLnByb2Nlc3NlZFhEYXRhLGI9dGhpcy5wcm9jZXNzZWRZRGF0YSxjPVtdLGQ9Yi5sZW5ndGgsZT10aGlzLm9wdGlvbnMsZj1lLnRocmVzaG9sZCxnPWUuc3RhcnRGcm9tVGhyZXNob2xkP2Y6MCxoPWUuc3RhY2ssZT1lLnN0YWNraW5nLGk9dGhpcy5zdGFja0tleSxqPVwiLVwiK2ksaz10aGlzLm5lZ1N0YWNrcyxcbmw9dGhpcy55QXhpcyxtPWwuc3RhY2tzLG89bC5vbGRTdGFja3MscCxyLG4sUCx1LHcscztsLnN0YWNrc1RvdWNoZWQrPTE7Zm9yKHU9MDt1PGQ7dSsrKXt3PWFbdV07cz1iW3VdO3A9dGhpcy5nZXRTdGFja0luZGljYXRvcihwLHcsdGhpcy5pbmRleCk7UD1wLmtleTtuPShyPWsmJnM8KGc/MDpmKSk/ajppO21bbl18fChtW25dPXt9KTtpZighbVtuXVt3XSlvW25dJiZvW25dW3ddPyhtW25dW3ddPW9bbl1bd10sbVtuXVt3XS50b3RhbD1udWxsKTptW25dW3ddPW5ldyBUYihsLGwub3B0aW9ucy5zdGFja0xhYmVscyxyLHcsaCk7bj1tW25dW3ddO2lmKHMhPT1udWxsKW4ucG9pbnRzW1BdPW4ucG9pbnRzW3RoaXMuaW5kZXhdPVtxKG4uY3VtLGcpXSxuLnRvdWNoZWQ9bC5zdGFja3NUb3VjaGVkLHAuaW5kZXg+MCYmdGhpcy5zaW5nbGVTdGFja3M9PT0hMSYmKG4ucG9pbnRzW1BdWzBdPW4ucG9pbnRzW3RoaXMuaW5kZXgrXCIsXCIrdytcIiwwXCJdWzBdKTtlPT09XCJwZXJjZW50XCI/KHI9cj9pOlxuaixrJiZtW3JdJiZtW3JdW3ddPyhyPW1bcl1bd10sbi50b3RhbD1yLnRvdGFsPXYoci50b3RhbCxuLnRvdGFsKStTKHMpfHwwKTpuLnRvdGFsPW5hKG4udG90YWwrKFMocyl8fDApKSk6bi50b3RhbD1uYShuLnRvdGFsKyhzfHwwKSk7bi5jdW09cShuLmN1bSxnKSsoc3x8MCk7aWYocyE9PW51bGwpbi5wb2ludHNbUF0ucHVzaChuLmN1bSksY1t1XT1uLmN1bX1pZihlPT09XCJwZXJjZW50XCIpbC51c2VQZXJjZW50YWdlPSEwO3RoaXMuc3RhY2tlZFlEYXRhPWM7bC5vbGRTdGFja3M9e319fTtRLnByb3RvdHlwZS5zZXRQZXJjZW50U3RhY2tzPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEuc3RhY2tLZXksYz1hLnlBeGlzLnN0YWNrcyxkPWEucHJvY2Vzc2VkWERhdGEsZTtuKFtiLFwiLVwiK2JdLGZ1bmN0aW9uKGIpe3ZhciBmO2Zvcih2YXIgZz1kLmxlbmd0aCxoLGk7Zy0tOylpZihoPWRbZ10sZT1hLmdldFN0YWNrSW5kaWNhdG9yKGUsaCxhLmluZGV4KSxmPShpPWNbYl0mJmNbYl1baF0pJiZcbmkucG9pbnRzW2Uua2V5XSxoPWYpaT1pLnRvdGFsPzEwMC9pLnRvdGFsOjAsaFswXT1uYShoWzBdKmkpLGhbMV09bmEoaFsxXSppKSxhLnN0YWNrZWRZRGF0YVtnXT1oWzFdfSl9O1EucHJvdG90eXBlLmdldFN0YWNrSW5kaWNhdG9yPWZ1bmN0aW9uKGEsYixjKXshcyhhKXx8YS54IT09Yj9hPXt4OmIsaW5kZXg6MH06YS5pbmRleCsrO2Eua2V5PVtjLGIsYS5pbmRleF0uam9pbihcIixcIik7cmV0dXJuIGF9O3goQ2EucHJvdG90eXBlLHthZGRTZXJpZXM6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGU9dGhpczthJiYoYj1xKGIsITApLE0oZSxcImFkZFNlcmllc1wiLHtvcHRpb25zOmF9LGZ1bmN0aW9uKCl7ZD1lLmluaXRTZXJpZXMoYSk7ZS5pc0RpcnR5TGVnZW5kPSEwO2UubGlua1NlcmllcygpO2ImJmUucmVkcmF3KGMpfSkpO3JldHVybiBkfSxhZGRBeGlzOmZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPWI/XCJ4QXhpc1wiOlwieUF4aXNcIixmPXRoaXMub3B0aW9ucyxhPUMoYSx7aW5kZXg6dGhpc1tlXS5sZW5ndGgsXG5pc1g6Yn0pO25ldyBJKHRoaXMsYSk7ZltlXT12YShmW2VdfHx7fSk7ZltlXS5wdXNoKGEpO3EoYywhMCkmJnRoaXMucmVkcmF3KGQpfSxzaG93TG9hZGluZzpmdW5jdGlvbihhKXt2YXIgYj10aGlzLGM9Yi5vcHRpb25zLGQ9Yi5sb2FkaW5nRGl2LGU9Yy5sb2FkaW5nLGY9ZnVuY3Rpb24oKXtkJiZGKGQse2xlZnQ6Yi5wbG90TGVmdCtcInB4XCIsdG9wOmIucGxvdFRvcCtcInB4XCIsd2lkdGg6Yi5wbG90V2lkdGgrXCJweFwiLGhlaWdodDpiLnBsb3RIZWlnaHQrXCJweFwifSl9O2lmKCFkKWIubG9hZGluZ0Rpdj1kPWVhKFdhLHtjbGFzc05hbWU6XCJoaWdoY2hhcnRzLWxvYWRpbmdcIn0seChlLnN0eWxlLHt6SW5kZXg6MTAsZGlzcGxheTpcIm5vbmVcIn0pLGIuY29udGFpbmVyKSxiLmxvYWRpbmdTcGFuPWVhKFwic3BhblwiLG51bGwsZS5sYWJlbFN0eWxlLGQpLEQoYixcInJlZHJhd1wiLGYpO2IubG9hZGluZ1NwYW4uaW5uZXJIVE1MPWF8fGMubGFuZy5sb2FkaW5nO2lmKCFiLmxvYWRpbmdTaG93bilGKGQsXG57b3BhY2l0eTowLGRpc3BsYXk6XCJcIn0pLGViKGQse29wYWNpdHk6ZS5zdHlsZS5vcGFjaXR5fSx7ZHVyYXRpb246ZS5zaG93RHVyYXRpb258fDB9KSxiLmxvYWRpbmdTaG93bj0hMDtmKCl9LGhpZGVMb2FkaW5nOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcHRpb25zLGI9dGhpcy5sb2FkaW5nRGl2O2ImJmViKGIse29wYWNpdHk6MH0se2R1cmF0aW9uOmEubG9hZGluZy5oaWRlRHVyYXRpb258fDEwMCxjb21wbGV0ZTpmdW5jdGlvbigpe0YoYix7ZGlzcGxheTpcIm5vbmVcIn0pfX0pO3RoaXMubG9hZGluZ1Nob3duPSExfX0pO3goSGEucHJvdG90eXBlLHt1cGRhdGU6ZnVuY3Rpb24oYSxiLGMsZCl7ZnVuY3Rpb24gZSgpe2YuYXBwbHlPcHRpb25zKGEpO2lmKGYueT09PW51bGwmJmgpZi5ncmFwaGljPWguZGVzdHJveSgpO2lmKGRhKGEpJiYhSmEoYSkpZi5yZWRyYXc9ZnVuY3Rpb24oKXtpZihoJiZoLmVsZW1lbnQmJmEmJmEubWFya2VyJiZhLm1hcmtlci5zeW1ib2wpZi5ncmFwaGljPWguZGVzdHJveSgpO1xuaWYoYSYmYS5kYXRhTGFiZWxzJiZmLmRhdGFMYWJlbClmLmRhdGFMYWJlbD1mLmRhdGFMYWJlbC5kZXN0cm95KCk7Zi5yZWRyYXc9bnVsbH07aT1mLmluZGV4O2cudXBkYXRlUGFyYWxsZWxBcnJheXMoZixpKTtpZihsJiZmLm5hbWUpbFtmLnhdPWYubmFtZTtrLmRhdGFbaV09ZGEoay5kYXRhW2ldKSYmIUphKGsuZGF0YVtpXSk/Zi5vcHRpb25zOmE7Zy5pc0RpcnR5PWcuaXNEaXJ0eURhdGE9ITA7aWYoIWcuZml4ZWRCb3gmJmcuaGFzQ2FydGVzaWFuU2VyaWVzKWouaXNEaXJ0eUJveD0hMDtpZihrLmxlZ2VuZFR5cGU9PT1cInBvaW50XCIpai5pc0RpcnR5TGVnZW5kPSEwO2ImJmoucmVkcmF3KGMpfXZhciBmPXRoaXMsZz1mLnNlcmllcyxoPWYuZ3JhcGhpYyxpLGo9Zy5jaGFydCxrPWcub3B0aW9ucyxsPWcueEF4aXMmJmcueEF4aXMubmFtZXMsYj1xKGIsITApO2Q9PT0hMT9lKCk6Zi5maXJlUG9pbnRFdmVudChcInVwZGF0ZVwiLHtvcHRpb25zOmF9LGUpfSxyZW1vdmU6ZnVuY3Rpb24oYSxcbmIpe3RoaXMuc2VyaWVzLnJlbW92ZVBvaW50KHNhKHRoaXMsdGhpcy5zZXJpZXMuZGF0YSksYSxiKX19KTt4KFEucHJvdG90eXBlLHthZGRQb2ludDpmdW5jdGlvbihhLGIsYyxkKXt2YXIgZT10aGlzLGY9ZS5vcHRpb25zLGc9ZS5kYXRhLGg9ZS5ncmFwaCxpPWUuYXJlYSxqPWUuY2hhcnQsaz1lLnhBeGlzJiZlLnhBeGlzLm5hbWVzLGw9aCYmaC5zaGlmdHx8MCxtPVtcImdyYXBoXCIsXCJhcmVhXCJdLGg9Zi5kYXRhLG8scD1lLnhEYXRhO2FiKGQsaik7aWYoYyl7Zm9yKGQ9ZS56b25lcy5sZW5ndGg7ZC0tOyltLnB1c2goXCJ6b25lR3JhcGhcIitkLFwiem9uZUFyZWFcIitkKTtuKG0sZnVuY3Rpb24oYSl7aWYoZVthXSllW2FdLnNoaWZ0PWwrKGYuc3RlcD8yOjEpfSl9aWYoaSlpLmlzQXJlYT0hMDtiPXEoYiwhMCk7aT17c2VyaWVzOmV9O2UucG9pbnRDbGFzcy5wcm90b3R5cGUuYXBwbHlPcHRpb25zLmFwcGx5KGksW2FdKTttPWkueDtkPXAubGVuZ3RoO2lmKGUucmVxdWlyZVNvcnRpbmcmJm08XG5wW2QtMV0pZm9yKG89ITA7ZCYmcFtkLTFdPm07KWQtLTtlLnVwZGF0ZVBhcmFsbGVsQXJyYXlzKGksXCJzcGxpY2VcIixkLDAsMCk7ZS51cGRhdGVQYXJhbGxlbEFycmF5cyhpLGQpO2lmKGsmJmkubmFtZSlrW21dPWkubmFtZTtoLnNwbGljZShkLDAsYSk7byYmKGUuZGF0YS5zcGxpY2UoZCwwLG51bGwpLGUucHJvY2Vzc0RhdGEoKSk7Zi5sZWdlbmRUeXBlPT09XCJwb2ludFwiJiZlLmdlbmVyYXRlUG9pbnRzKCk7YyYmKGdbMF0mJmdbMF0ucmVtb3ZlP2dbMF0ucmVtb3ZlKCExKTooZy5zaGlmdCgpLGUudXBkYXRlUGFyYWxsZWxBcnJheXMoaSxcInNoaWZ0XCIpLGguc2hpZnQoKSkpO2UuaXNEaXJ0eT0hMDtlLmlzRGlydHlEYXRhPSEwO2ImJihlLmdldEF0dHJpYnMoKSxqLnJlZHJhdygpKX0scmVtb3ZlUG9pbnQ6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXRoaXMsZT1kLmRhdGEsZj1lW2FdLGc9ZC5wb2ludHMsaD1kLmNoYXJ0LGk9ZnVuY3Rpb24oKXtnJiZnLmxlbmd0aD09PWUubGVuZ3RoJiZcbmcuc3BsaWNlKGEsMSk7ZS5zcGxpY2UoYSwxKTtkLm9wdGlvbnMuZGF0YS5zcGxpY2UoYSwxKTtkLnVwZGF0ZVBhcmFsbGVsQXJyYXlzKGZ8fHtzZXJpZXM6ZH0sXCJzcGxpY2VcIixhLDEpO2YmJmYuZGVzdHJveSgpO2QuaXNEaXJ0eT0hMDtkLmlzRGlydHlEYXRhPSEwO2ImJmgucmVkcmF3KCl9O2FiKGMsaCk7Yj1xKGIsITApO2Y/Zi5maXJlUG9pbnRFdmVudChcInJlbW92ZVwiLG51bGwsaSk6aSgpfSxyZW1vdmU6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLGQ9Yy5jaGFydDtNKGMsXCJyZW1vdmVcIixudWxsLGZ1bmN0aW9uKCl7Yy5kZXN0cm95KCk7ZC5pc0RpcnR5TGVnZW5kPWQuaXNEaXJ0eUJveD0hMDtkLmxpbmtTZXJpZXMoKTtxKGEsITApJiZkLnJlZHJhdyhiKX0pfSx1cGRhdGU6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLGQ9dGhpcy5jaGFydCxlPXRoaXMudXNlck9wdGlvbnMsZj10aGlzLnR5cGUsZz1LW2ZdLnByb3RvdHlwZSxoPVtcImdyb3VwXCIsXCJtYXJrZXJHcm91cFwiLFwiZGF0YUxhYmVsc0dyb3VwXCJdLFxuaTtpZihhLnR5cGUmJmEudHlwZSE9PWZ8fGEuekluZGV4IT09dm9pZCAwKWgubGVuZ3RoPTA7bihoLGZ1bmN0aW9uKGEpe2hbYV09Y1thXTtkZWxldGUgY1thXX0pO2E9QyhlLHthbmltYXRpb246ITEsaW5kZXg6dGhpcy5pbmRleCxwb2ludFN0YXJ0OnRoaXMueERhdGFbMF19LHtkYXRhOnRoaXMub3B0aW9ucy5kYXRhfSxhKTt0aGlzLnJlbW92ZSghMSk7Zm9yKGkgaW4gZyl0aGlzW2ldPXQ7eCh0aGlzLEtbYS50eXBlfHxmXS5wcm90b3R5cGUpO24oaCxmdW5jdGlvbihhKXtjW2FdPWhbYV19KTt0aGlzLmluaXQoZCxhKTtkLmxpbmtTZXJpZXMoKTtxKGIsITApJiZkLnJlZHJhdyghMSl9fSk7eChJLnByb3RvdHlwZSx7dXBkYXRlOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5jaGFydCxhPWMub3B0aW9uc1t0aGlzLmNvbGxdW3RoaXMub3B0aW9ucy5pbmRleF09Qyh0aGlzLnVzZXJPcHRpb25zLGEpO3RoaXMuZGVzdHJveSghMCk7dGhpcy5fYWRkZWRQbG90TEI9dGhpcy5jaGFydC5fbGFiZWxQYW5lcz1cbnQ7dGhpcy5pbml0KGMseChhLHtldmVudHM6dH0pKTtjLmlzRGlydHlCb3g9ITA7cShiLCEwKSYmYy5yZWRyYXcoKX0scmVtb3ZlOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj10aGlzLmNoYXJ0LGM9dGhpcy5jb2xsLGQ9dGhpcy5zZXJpZXMsZT1kLmxlbmd0aDtlLS07KWRbZV0mJmRbZV0ucmVtb3ZlKCExKTtBYShiLmF4ZXMsdGhpcyk7QWEoYltjXSx0aGlzKTtiLm9wdGlvbnNbY10uc3BsaWNlKHRoaXMub3B0aW9ucy5pbmRleCwxKTtuKGJbY10sZnVuY3Rpb24oYSxiKXthLm9wdGlvbnMuaW5kZXg9Yn0pO3RoaXMuZGVzdHJveSgpO2IuaXNEaXJ0eUJveD0hMDtxKGEsITApJiZiLnJlZHJhdygpfSxzZXRUaXRsZTpmdW5jdGlvbihhLGIpe3RoaXMudXBkYXRlKHt0aXRsZTphfSxiKX0sc2V0Q2F0ZWdvcmllczpmdW5jdGlvbihhLGIpe3RoaXMudXBkYXRlKHtjYXRlZ29yaWVzOmF9LGIpfX0pO3ZhciBJYT1sYShRKTtLLmxpbmU9SWE7Vy5hcmVhPUMoY2Ese3NvZnRUaHJlc2hvbGQ6ITEsdGhyZXNob2xkOjB9KTtcbnZhciB6YT1sYShRLHt0eXBlOlwiYXJlYVwiLHNpbmdsZVN0YWNrczohMSxnZXRTdGFja1BvaW50czpmdW5jdGlvbigpe3ZhciBhPVtdLGI9W10sYz10aGlzLnhBeGlzLGQ9dGhpcy55QXhpcyxlPWQuc3RhY2tzW3RoaXMuc3RhY2tLZXldLGY9e30sZz10aGlzLnBvaW50cyxoPXRoaXMuaW5kZXgsaT1kLnNlcmllcyxqPWkubGVuZ3RoLGssbD1xKGQub3B0aW9ucy5yZXZlcnNlZFN0YWNrcywhMCk/MTotMSxtLG87aWYodGhpcy5vcHRpb25zLnN0YWNraW5nKXtmb3IobT0wO208Zy5sZW5ndGg7bSsrKWZbZ1ttXS54XT1nW21dO2ZvcihvIGluIGUpZVtvXS50b3RhbCE9PW51bGwmJmIucHVzaChvKTtiLnNvcnQoZnVuY3Rpb24oYSxiKXtyZXR1cm4gYS1ifSk7az10YShpLGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudmlzaWJsZX0pO24oYixmdW5jdGlvbihnLGkpe3ZhciBvPTAscSx1O2lmKGZbZ10mJiFmW2ddLmlzTnVsbClhLnB1c2goZltnXSksbihbLTEsMV0sZnVuY3Rpb24oYSl7dmFyIGM9XG5hPT09MT9cInJpZ2h0TnVsbFwiOlwibGVmdE51bGxcIixkPTAsbz1lW2JbaSthXV07aWYobylmb3IobT1oO20+PTAmJm08ajspcT1vLnBvaW50c1ttXSxxfHwobT09PWg/ZltnXVtjXT0hMDprW21dJiYodT1lW2ddLnBvaW50c1ttXSkmJihkLT11WzFdLXVbMF0pKSxtKz1sO2ZbZ11bYT09PTE/XCJyaWdodENsaWZmXCI6XCJsZWZ0Q2xpZmZcIl09ZH0pO2Vsc2V7Zm9yKG09aDttPj0wJiZtPGo7KXtpZihxPWVbZ10ucG9pbnRzW21dKXtvPXFbMV07YnJlYWt9bSs9bH1vPWQudG9QaXhlbHMobywhMCk7YS5wdXNoKHtpc051bGw6ITAscGxvdFg6Yy50b1BpeGVscyhnLCEwKSxwbG90WTpvLHlCb3R0b206b30pfX0pfXJldHVybiBhfSxnZXRHcmFwaFBhdGg6ZnVuY3Rpb24oYSl7dmFyIGI9US5wcm90b3R5cGUuZ2V0R3JhcGhQYXRoLGM9dGhpcy5vcHRpb25zLGQ9Yy5zdGFja2luZyxlPXRoaXMueUF4aXMsZixnLGg9W10saT1bXSxqPXRoaXMuaW5kZXgsayxsPWUuc3RhY2tzW3RoaXMuc3RhY2tLZXldLFxubT1jLnRocmVzaG9sZCxvPWUuZ2V0VGhyZXNob2xkKGMudGhyZXNob2xkKSxwLGM9Yy5jb25uZWN0TnVsbHN8fGQ9PT1cInBlcmNlbnRcIixyPWZ1bmN0aW9uKGIsYyxmKXt2YXIgZz1hW2JdLGI9ZCYmbFtnLnhdLnBvaW50c1tqXSxwPWdbZitcIk51bGxcIl18fDAsZj1nW2YrXCJDbGlmZlwiXXx8MCxyLG4sZz0hMDtmfHxwPyhyPShwP2JbMF06YlsxXSkrZixuPWJbMF0rZixnPSEhcCk6IWQmJmFbY10mJmFbY10uaXNOdWxsJiYocj1uPW0pO3IhPT12b2lkIDAmJihpLnB1c2goe3Bsb3RYOmsscGxvdFk6cj09PW51bGw/bzplLmdldFRocmVzaG9sZChyKSxpc051bGw6Z30pLGgucHVzaCh7cGxvdFg6ayxwbG90WTpuPT09bnVsbD9vOmUuZ2V0VGhyZXNob2xkKG4pfSkpfSxhPWF8fHRoaXMucG9pbnRzO2QmJihhPXRoaXMuZ2V0U3RhY2tQb2ludHMoKSk7Zm9yKGY9MDtmPGEubGVuZ3RoO2YrKylpZihnPWFbZl0uaXNOdWxsLGs9cShhW2ZdLnJlY3RQbG90WCxhW2ZdLnBsb3RYKSxwPXEoYVtmXS55Qm90dG9tLFxubyksIWd8fGMpe2N8fHIoZixmLTEsXCJsZWZ0XCIpO2lmKCFnfHxkfHwhYylpLnB1c2goYVtmXSksaC5wdXNoKHt4OmYscGxvdFg6ayxwbG90WTpwfSk7Y3x8cihmLGYrMSxcInJpZ2h0XCIpfWY9Yi5jYWxsKHRoaXMsaSwhMCwhMCk7aC5yZXZlcnNlZD0hMDtnPWIuY2FsbCh0aGlzLGgsITAsITApO2cubGVuZ3RoJiYoZ1swXT1cIkxcIik7Zj1mLmNvbmNhdChnKTtiPWIuY2FsbCh0aGlzLGksITEsYyk7dGhpcy5hcmVhUGF0aD1mO3JldHVybiBifSxkcmF3R3JhcGg6ZnVuY3Rpb24oKXt0aGlzLmFyZWFQYXRoPVtdO1EucHJvdG90eXBlLmRyYXdHcmFwaC5hcHBseSh0aGlzKTt2YXIgYT10aGlzLGI9dGhpcy5hcmVhUGF0aCxjPXRoaXMub3B0aW9ucyxkPVtbXCJhcmVhXCIsdGhpcy5jb2xvcixjLmZpbGxDb2xvcl1dO24odGhpcy56b25lcyxmdW5jdGlvbihiLGYpe2QucHVzaChbXCJ6b25lQXJlYVwiK2YsYi5jb2xvcnx8YS5jb2xvcixiLmZpbGxDb2xvcnx8Yy5maWxsQ29sb3JdKX0pO24oZCxmdW5jdGlvbihkKXt2YXIgZj1cbmRbMF0sZz1hW2ZdO2c/Zy5hbmltYXRlKHtkOmJ9KTooZz17ZmlsbDpkWzJdfHxkWzFdLHpJbmRleDowfSxkWzJdfHwoZ1tcImZpbGwtb3BhY2l0eVwiXT1xKGMuZmlsbE9wYWNpdHksMC43NSkpLGFbZl09YS5jaGFydC5yZW5kZXJlci5wYXRoKGIpLmF0dHIoZykuYWRkKGEuZ3JvdXApKX0pfSxkcmF3TGVnZW5kU3ltYm9sOmFhLmRyYXdSZWN0YW5nbGV9KTtLLmFyZWE9emE7Vy5zcGxpbmU9QyhjYSk7SWE9bGEoUSx7dHlwZTpcInNwbGluZVwiLGdldFBvaW50U3BsaW5lOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD1iLnBsb3RYLGU9Yi5wbG90WSxmPWFbYy0xXSxjPWFbYysxXSxnLGgsaSxqO2lmKGYmJiFmLmlzTnVsbCYmYyYmIWMuaXNOdWxsKXthPWYucGxvdFk7aT1jLnBsb3RYO3ZhciBjPWMucGxvdFksaz0wO2c9KDEuNSpkK2YucGxvdFgpLzIuNTtoPSgxLjUqZSthKS8yLjU7aT0oMS41KmQraSkvMi41O2o9KDEuNSplK2MpLzIuNTtpIT09ZyYmKGs9KGotaCkqKGktZCkvKGktZykrZS1qKTtcbmgrPWs7ais9aztoPmEmJmg+ZT8oaD12KGEsZSksaj0yKmUtaCk6aDxhJiZoPGUmJihoPUUoYSxlKSxqPTIqZS1oKTtqPmMmJmo+ZT8oaj12KGMsZSksaD0yKmUtaik6ajxjJiZqPGUmJihqPUUoYyxlKSxoPTIqZS1qKTtiLnJpZ2h0Q29udFg9aTtiLnJpZ2h0Q29udFk9an1iPVtcIkNcIixxKGYucmlnaHRDb250WCxmLnBsb3RYKSxxKGYucmlnaHRDb250WSxmLnBsb3RZKSxxKGcsZCkscShoLGUpLGQsZV07Zi5yaWdodENvbnRYPWYucmlnaHRDb250WT1udWxsO3JldHVybiBifX0pO0suc3BsaW5lPUlhO1cuYXJlYXNwbGluZT1DKFcuYXJlYSk7emE9emEucHJvdG90eXBlO0lhPWxhKElhLHt0eXBlOlwiYXJlYXNwbGluZVwiLGdldFN0YWNrUG9pbnRzOnphLmdldFN0YWNrUG9pbnRzLGdldEdyYXBoUGF0aDp6YS5nZXRHcmFwaFBhdGgsc2V0U3RhY2tDbGlmZnM6emEuc2V0U3RhY2tDbGlmZnMsZHJhd0dyYXBoOnphLmRyYXdHcmFwaCxkcmF3TGVnZW5kU3ltYm9sOmFhLmRyYXdSZWN0YW5nbGV9KTtcbksuYXJlYXNwbGluZT1JYTtXLmNvbHVtbj1DKGNhLHtib3JkZXJDb2xvcjpcIiNGRkZGRkZcIixib3JkZXJSYWRpdXM6MCxncm91cFBhZGRpbmc6MC4yLG1hcmtlcjpudWxsLHBvaW50UGFkZGluZzowLjEsbWluUG9pbnRMZW5ndGg6MCxjcm9wVGhyZXNob2xkOjUwLHBvaW50UmFuZ2U6bnVsbCxzdGF0ZXM6e2hvdmVyOnticmlnaHRuZXNzOjAuMSxzaGFkb3c6ITEsaGFsbzohMX0sc2VsZWN0Ontjb2xvcjpcIiNDMEMwQzBcIixib3JkZXJDb2xvcjpcIiMwMDAwMDBcIixzaGFkb3c6ITF9fSxkYXRhTGFiZWxzOnthbGlnbjpudWxsLHZlcnRpY2FsQWxpZ246bnVsbCx5Om51bGx9LHNvZnRUaHJlc2hvbGQ6ITEsc3RhcnRGcm9tVGhyZXNob2xkOiEwLHN0aWNreVRyYWNraW5nOiExLHRvb2x0aXA6e2Rpc3RhbmNlOjZ9LHRocmVzaG9sZDowfSk7SWE9bGEoUSx7dHlwZTpcImNvbHVtblwiLHBvaW50QXR0clRvT3B0aW9uczp7c3Ryb2tlOlwiYm9yZGVyQ29sb3JcIixmaWxsOlwiY29sb3JcIixyOlwiYm9yZGVyUmFkaXVzXCJ9LFxuY3JvcFNob3VsZGVyOjAsZGlyZWN0VG91Y2g6ITAsdHJhY2tlckdyb3VwczpbXCJncm91cFwiLFwiZGF0YUxhYmVsc0dyb3VwXCJdLG5lZ1N0YWNrczohMCxpbml0OmZ1bmN0aW9uKCl7US5wcm90b3R5cGUuaW5pdC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dmFyIGE9dGhpcyxiPWEuY2hhcnQ7Yi5oYXNSZW5kZXJlZCYmbihiLnNlcmllcyxmdW5jdGlvbihiKXtpZihiLnR5cGU9PT1hLnR5cGUpYi5pc0RpcnR5PSEwfSl9LGdldENvbHVtbk1ldHJpY3M6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5vcHRpb25zLGM9YS54QXhpcyxkPWEueUF4aXMsZT1jLnJldmVyc2VkLGYsZz17fSxoPTA7Yi5ncm91cGluZz09PSExP2g9MTpuKGEuY2hhcnQuc2VyaWVzLGZ1bmN0aW9uKGIpe3ZhciBjPWIub3B0aW9ucyxlPWIueUF4aXMsaTtpZihiLnR5cGU9PT1hLnR5cGUmJmIudmlzaWJsZSYmZC5sZW49PT1lLmxlbiYmZC5wb3M9PT1lLnBvcyljLnN0YWNraW5nPyhmPWIuc3RhY2tLZXksZ1tmXT09PXQmJlxuKGdbZl09aCsrKSxpPWdbZl0pOmMuZ3JvdXBpbmchPT0hMSYmKGk9aCsrKSxiLmNvbHVtbkluZGV4PWl9KTt2YXIgaT1FKFMoYy50cmFuc0EpKihjLm9yZGluYWxTbG9wZXx8Yi5wb2ludFJhbmdlfHxjLmNsb3Nlc3RQb2ludFJhbmdlfHxjLnRpY2tJbnRlcnZhbHx8MSksYy5sZW4pLGo9aSpiLmdyb3VwUGFkZGluZyxrPShpLTIqaikvaCxiPUUoYi5tYXhQb2ludFdpZHRofHxjLmxlbixxKGIucG9pbnRXaWR0aCxrKigxLTIqYi5wb2ludFBhZGRpbmcpKSk7YS5jb2x1bW5NZXRyaWNzPXt3aWR0aDpiLG9mZnNldDooay1iKS8yKyhqKygoYS5jb2x1bW5JbmRleHx8MCkrKGU/MTowKSkqay1pLzIpKihlPy0xOjEpfTtyZXR1cm4gYS5jb2x1bW5NZXRyaWNzfSxjcmlzcENvbDpmdW5jdGlvbihhLGIsYyxkKXt2YXIgZT10aGlzLmNoYXJ0LGY9dGhpcy5ib3JkZXJXaWR0aCxnPS0oZiUyPzAuNTowKSxmPWYlMj8wLjU6MTtlLmludmVydGVkJiZlLnJlbmRlcmVyLmlzVk1MJiYoZis9MSk7Yz1NYXRoLnJvdW5kKGErXG5jKStnO2E9TWF0aC5yb3VuZChhKStnO2MtPWE7ZD1NYXRoLnJvdW5kKGIrZCkrZjtnPVMoYik8PTAuNSYmZD4wLjU7Yj1NYXRoLnJvdW5kKGIpK2Y7ZC09YjtnJiZkJiYoYi09MSxkKz0xKTtyZXR1cm57eDphLHk6Yix3aWR0aDpjLGhlaWdodDpkfX0sdHJhbnNsYXRlOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEuY2hhcnQsYz1hLm9wdGlvbnMsZD1hLmJvcmRlcldpZHRoPXEoYy5ib3JkZXJXaWR0aCxhLmNsb3Nlc3RQb2ludFJhbmdlKmEueEF4aXMudHJhbnNBPDI/MDoxKSxlPWEueUF4aXMsZj1hLnRyYW5zbGF0ZWRUaHJlc2hvbGQ9ZS5nZXRUaHJlc2hvbGQoYy50aHJlc2hvbGQpLGc9cShjLm1pblBvaW50TGVuZ3RoLDUpLGg9YS5nZXRDb2x1bW5NZXRyaWNzKCksaT1oLndpZHRoLGo9YS5iYXJXPXYoaSwxKzIqZCksaz1hLnBvaW50WE9mZnNldD1oLm9mZnNldDtiLmludmVydGVkJiYoZi09MC41KTtjLnBvaW50UGFkZGluZyYmKGo9RmEoaikpO1EucHJvdG90eXBlLnRyYW5zbGF0ZS5hcHBseShhKTtcbm4oYS5wb2ludHMsZnVuY3Rpb24oYyl7dmFyIGQ9RShxKGMueUJvdHRvbSxmKSw5RTQpLGg9OTk5K1MoZCksaD1FKHYoLWgsYy5wbG90WSksZS5sZW4raCkscD1jLnBsb3RYK2sscj1qLG49RShoLGQpLHMsdT12KGgsZCktbjtTKHUpPGcmJmcmJih1PWcscz0hZS5yZXZlcnNlZCYmIWMubmVnYXRpdmV8fGUucmV2ZXJzZWQmJmMubmVnYXRpdmUsbj1TKG4tZik+Zz9kLWc6Zi0ocz9nOjApKTtjLmJhclg9cDtjLnBvaW50V2lkdGg9aTtjLnRvb2x0aXBQb3M9Yi5pbnZlcnRlZD9bZS5sZW4rZS5wb3MtYi5wbG90TGVmdC1oLGEueEF4aXMubGVuLXAtci8yLHVdOltwK3IvMixoK2UucG9zLWIucGxvdFRvcCx1XTtjLnNoYXBlVHlwZT1cInJlY3RcIjtjLnNoYXBlQXJncz1hLmNyaXNwQ29sKHAsbixyLHUpfSl9LGdldFN5bWJvbDpyYSxkcmF3TGVnZW5kU3ltYm9sOmFhLmRyYXdSZWN0YW5nbGUsZHJhd0dyYXBoOnJhLGRyYXdQb2ludHM6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9dGhpcy5jaGFydCxcbmM9YS5vcHRpb25zLGQ9Yi5yZW5kZXJlcixlPWMuYW5pbWF0aW9uTGltaXR8fDI1MCxmLGc7bihhLnBvaW50cyxmdW5jdGlvbihoKXt2YXIgaT1oLnBsb3RZLGo9aC5ncmFwaGljO2lmKGkhPT10JiYhaXNOYU4oaSkmJmgueSE9PW51bGwpZj1oLnNoYXBlQXJncyxpPXMoYS5ib3JkZXJXaWR0aCk/e1wic3Ryb2tlLXdpZHRoXCI6YS5ib3JkZXJXaWR0aH06e30sZz1oLnBvaW50QXR0cltoLnNlbGVjdGVkP1wic2VsZWN0XCI6XCJcIl18fGEucG9pbnRBdHRyW1wiXCJdLGo/KFRhKGopLGouYXR0cihpKS5hdHRyKGcpW2IucG9pbnRDb3VudDxlP1wiYW5pbWF0ZVwiOlwiYXR0clwiXShDKGYpKSk6aC5ncmFwaGljPWRbaC5zaGFwZVR5cGVdKGYpLmF0dHIoaSkuYXR0cihnKS5hZGQoaC5ncm91cHx8YS5ncm91cCkuc2hhZG93KGMuc2hhZG93LG51bGwsYy5zdGFja2luZyYmIWMuYm9yZGVyUmFkaXVzKTtlbHNlIGlmKGopaC5ncmFwaGljPWouZGVzdHJveSgpfSl9LGFuaW1hdGU6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcyxcbmM9dGhpcy55QXhpcyxkPWIub3B0aW9ucyxlPXRoaXMuY2hhcnQuaW52ZXJ0ZWQsZj17fTtpZihqYSlhPyhmLnNjYWxlWT0wLjAwMSxhPUUoYy5wb3MrYy5sZW4sdihjLnBvcyxjLnRvUGl4ZWxzKGQudGhyZXNob2xkKSkpLGU/Zi50cmFuc2xhdGVYPWEtYy5sZW46Zi50cmFuc2xhdGVZPWEsYi5ncm91cC5hdHRyKGYpKTooZltlP1widHJhbnNsYXRlWFwiOlwidHJhbnNsYXRlWVwiXT1jLnBvcyxiLmdyb3VwLmFuaW1hdGUoZix4KGhiKGIub3B0aW9ucy5hbmltYXRpb24pLHtzdGVwOmZ1bmN0aW9uKGEsYyl7Yi5ncm91cC5hdHRyKHtzY2FsZVk6Yy5wb3N9KX19KSksYi5hbmltYXRlPW51bGwpfSxyZW1vdmU6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5jaGFydDtiLmhhc1JlbmRlcmVkJiZuKGIuc2VyaWVzLGZ1bmN0aW9uKGIpe2lmKGIudHlwZT09PWEudHlwZSliLmlzRGlydHk9ITB9KTtRLnByb3RvdHlwZS5yZW1vdmUuYXBwbHkoYSxhcmd1bWVudHMpfX0pO0suY29sdW1uPUlhO1cuYmFyPVxuQyhXLmNvbHVtbik7emE9bGEoSWEse3R5cGU6XCJiYXJcIixpbnZlcnRlZDohMH0pO0suYmFyPXphO1cuc2NhdHRlcj1DKGNhLHtsaW5lV2lkdGg6MCxtYXJrZXI6e2VuYWJsZWQ6ITB9LHRvb2x0aXA6e2hlYWRlckZvcm1hdDonPHNwYW4gc3R5bGU9XCJjb2xvcjp7cG9pbnQuY29sb3J9XCI+XFx1MjVjZjwvc3Bhbj4gPHNwYW4gc3R5bGU9XCJmb250LXNpemU6IDEwcHg7XCI+IHtzZXJpZXMubmFtZX08L3NwYW4+PGJyLz4nLHBvaW50Rm9ybWF0OlwieDogPGI+e3BvaW50Lnh9PC9iPjxici8+eTogPGI+e3BvaW50Lnl9PC9iPjxici8+XCJ9fSk7emE9bGEoUSx7dHlwZTpcInNjYXR0ZXJcIixzb3J0ZWQ6ITEscmVxdWlyZVNvcnRpbmc6ITEsbm9TaGFyZWRUb29sdGlwOiEwLHRyYWNrZXJHcm91cHM6W1wiZ3JvdXBcIixcIm1hcmtlckdyb3VwXCIsXCJkYXRhTGFiZWxzR3JvdXBcIl0sdGFrZU9yZGluYWxQb3NpdGlvbjohMSxrZERpbWVuc2lvbnM6MixkcmF3R3JhcGg6ZnVuY3Rpb24oKXt0aGlzLm9wdGlvbnMubGluZVdpZHRoJiZcblEucHJvdG90eXBlLmRyYXdHcmFwaC5jYWxsKHRoaXMpfX0pO0suc2NhdHRlcj16YTtXLnBpZT1DKGNhLHtib3JkZXJDb2xvcjpcIiNGRkZGRkZcIixib3JkZXJXaWR0aDoxLGNlbnRlcjpbbnVsbCxudWxsXSxjbGlwOiExLGNvbG9yQnlQb2ludDohMCxkYXRhTGFiZWxzOntkaXN0YW5jZTozMCxlbmFibGVkOiEwLGZvcm1hdHRlcjpmdW5jdGlvbigpe3JldHVybiB0aGlzLnk9PT1udWxsP3ZvaWQgMDp0aGlzLnBvaW50Lm5hbWV9LHg6MH0saWdub3JlSGlkZGVuUG9pbnQ6ITAsbGVnZW5kVHlwZTpcInBvaW50XCIsbWFya2VyOm51bGwsc2l6ZTpudWxsLHNob3dJbkxlZ2VuZDohMSxzbGljZWRPZmZzZXQ6MTAsc3RhdGVzOntob3Zlcjp7YnJpZ2h0bmVzczowLjEsc2hhZG93OiExfX0sc3RpY2t5VHJhY2tpbmc6ITEsdG9vbHRpcDp7Zm9sbG93UG9pbnRlcjohMH19KTtjYT17dHlwZTpcInBpZVwiLGlzQ2FydGVzaWFuOiExLHBvaW50Q2xhc3M6bGEoSGEse2luaXQ6ZnVuY3Rpb24oKXtIYS5wcm90b3R5cGUuaW5pdC5hcHBseSh0aGlzLFxuYXJndW1lbnRzKTt2YXIgYT10aGlzLGI7YS5uYW1lPXEoYS5uYW1lLFwiU2xpY2VcIik7Yj1mdW5jdGlvbihiKXthLnNsaWNlKGIudHlwZT09PVwic2VsZWN0XCIpfTtEKGEsXCJzZWxlY3RcIixiKTtEKGEsXCJ1bnNlbGVjdFwiLGIpO3JldHVybiBhfSxzZXRWaXNpYmxlOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcyxkPWMuc2VyaWVzLGU9ZC5jaGFydCxmPWQub3B0aW9ucy5pZ25vcmVIaWRkZW5Qb2ludCxiPXEoYixmKTtpZihhIT09Yy52aXNpYmxlKXtjLnZpc2libGU9Yy5vcHRpb25zLnZpc2libGU9YT1hPT09dD8hYy52aXNpYmxlOmE7ZC5vcHRpb25zLmRhdGFbc2EoYyxkLmRhdGEpXT1jLm9wdGlvbnM7bihbXCJncmFwaGljXCIsXCJkYXRhTGFiZWxcIixcImNvbm5lY3RvclwiLFwic2hhZG93R3JvdXBcIl0sZnVuY3Rpb24oYil7aWYoY1tiXSljW2JdW2E/XCJzaG93XCI6XCJoaWRlXCJdKCEwKX0pO2MubGVnZW5kSXRlbSYmZS5sZWdlbmQuY29sb3JpemVJdGVtKGMsYSk7IWEmJmMuc3RhdGU9PT1cImhvdmVyXCImJlxuYy5zZXRTdGF0ZShcIlwiKTtpZihmKWQuaXNEaXJ0eT0hMDtiJiZlLnJlZHJhdygpfX0sc2xpY2U6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXRoaXMuc2VyaWVzO2FiKGMsZC5jaGFydCk7cShiLCEwKTt0aGlzLnNsaWNlZD10aGlzLm9wdGlvbnMuc2xpY2VkPWE9cyhhKT9hOiF0aGlzLnNsaWNlZDtkLm9wdGlvbnMuZGF0YVtzYSh0aGlzLGQuZGF0YSldPXRoaXMub3B0aW9uczthPWE/dGhpcy5zbGljZWRUcmFuc2xhdGlvbjp7dHJhbnNsYXRlWDowLHRyYW5zbGF0ZVk6MH07dGhpcy5ncmFwaGljLmFuaW1hdGUoYSk7dGhpcy5zaGFkb3dHcm91cCYmdGhpcy5zaGFkb3dHcm91cC5hbmltYXRlKGEpfSxoYWxvUGF0aDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLnNoYXBlQXJncyxjPXRoaXMuc2VyaWVzLmNoYXJ0O3JldHVybiB0aGlzLnNsaWNlZHx8IXRoaXMudmlzaWJsZT9bXTp0aGlzLnNlcmllcy5jaGFydC5yZW5kZXJlci5zeW1ib2xzLmFyYyhjLnBsb3RMZWZ0K2IueCxjLnBsb3RUb3ArYi55LFxuYi5yK2EsYi5yK2Ese2lubmVyUjp0aGlzLnNoYXBlQXJncy5yLHN0YXJ0OmIuc3RhcnQsZW5kOmIuZW5kfSl9fSkscmVxdWlyZVNvcnRpbmc6ITEsZGlyZWN0VG91Y2g6ITAsbm9TaGFyZWRUb29sdGlwOiEwLHRyYWNrZXJHcm91cHM6W1wiZ3JvdXBcIixcImRhdGFMYWJlbHNHcm91cFwiXSxheGlzVHlwZXM6W10scG9pbnRBdHRyVG9PcHRpb25zOntzdHJva2U6XCJib3JkZXJDb2xvclwiLFwic3Ryb2tlLXdpZHRoXCI6XCJib3JkZXJXaWR0aFwiLGZpbGw6XCJjb2xvclwifSxhbmltYXRlOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMsYz1iLnBvaW50cyxkPWIuc3RhcnRBbmdsZVJhZDtpZighYSluKGMsZnVuY3Rpb24oYSl7dmFyIGM9YS5ncmFwaGljLGc9YS5zaGFwZUFyZ3M7YyYmKGMuYXR0cih7cjphLnN0YXJ0Unx8Yi5jZW50ZXJbM10vMixzdGFydDpkLGVuZDpkfSksYy5hbmltYXRlKHtyOmcucixzdGFydDpnLnN0YXJ0LGVuZDpnLmVuZH0sYi5vcHRpb25zLmFuaW1hdGlvbikpfSksYi5hbmltYXRlPW51bGx9LFxudXBkYXRlVG90YWxzOmZ1bmN0aW9uKCl7dmFyIGEsYj0wLGM9dGhpcy5wb2ludHMsZD1jLmxlbmd0aCxlLGY9dGhpcy5vcHRpb25zLmlnbm9yZUhpZGRlblBvaW50O2ZvcihhPTA7YTxkO2ErKyllPWNbYV0sYis9ZiYmIWUudmlzaWJsZT8wOmUueTt0aGlzLnRvdGFsPWI7Zm9yKGE9MDthPGQ7YSsrKWU9Y1thXSxlLnBlcmNlbnRhZ2U9Yj4wJiYoZS52aXNpYmxlfHwhZik/ZS55L2IqMTAwOjAsZS50b3RhbD1ifSxnZW5lcmF0ZVBvaW50czpmdW5jdGlvbigpe1EucHJvdG90eXBlLmdlbmVyYXRlUG9pbnRzLmNhbGwodGhpcyk7dGhpcy51cGRhdGVUb3RhbHMoKX0sdHJhbnNsYXRlOmZ1bmN0aW9uKGEpe3RoaXMuZ2VuZXJhdGVQb2ludHMoKTt2YXIgYj0wLGM9dGhpcy5vcHRpb25zLGQ9Yy5zbGljZWRPZmZzZXQsZT1kK2MuYm9yZGVyV2lkdGgsZixnLGgsaT1jLnN0YXJ0QW5nbGV8fDAsaj10aGlzLnN0YXJ0QW5nbGVSYWQ9QmEvMTgwKihpLTkwKSxpPSh0aGlzLmVuZEFuZ2xlUmFkPUJhL1xuMTgwKihxKGMuZW5kQW5nbGUsaSszNjApLTkwKSktaixrPXRoaXMucG9pbnRzLGw9Yy5kYXRhTGFiZWxzLmRpc3RhbmNlLGM9Yy5pZ25vcmVIaWRkZW5Qb2ludCxtLG89ay5sZW5ndGgscDtpZighYSl0aGlzLmNlbnRlcj1hPXRoaXMuZ2V0Q2VudGVyKCk7dGhpcy5nZXRYPWZ1bmN0aW9uKGIsYyl7aD1ZLmFzaW4oRSgoYi1hWzFdKS8oYVsyXS8yK2wpLDEpKTtyZXR1cm4gYVswXSsoYz8tMToxKSpiYShoKSooYVsyXS8yK2wpfTtmb3IobT0wO208bzttKyspe3A9a1ttXTtmPWorYippO2lmKCFjfHxwLnZpc2libGUpYis9cC5wZXJjZW50YWdlLzEwMDtnPWorYippO3Auc2hhcGVUeXBlPVwiYXJjXCI7cC5zaGFwZUFyZ3M9e3g6YVswXSx5OmFbMV0scjphWzJdLzIsaW5uZXJSOmFbM10vMixzdGFydDp5KGYqMUUzKS8xRTMsZW5kOnkoZyoxRTMpLzFFM307aD0oZytmKS8yO2g+MS41KkJhP2gtPTIqQmE6aDwtQmEvMiYmKGgrPTIqQmEpO3Auc2xpY2VkVHJhbnNsYXRpb249e3RyYW5zbGF0ZVg6eShiYShoKSpcbmQpLHRyYW5zbGF0ZVk6eShrYShoKSpkKX07Zj1iYShoKSphWzJdLzI7Zz1rYShoKSphWzJdLzI7cC50b29sdGlwUG9zPVthWzBdK2YqMC43LGFbMV0rZyowLjddO3AuaGFsZj1oPC1CYS8yfHxoPkJhLzI/MTowO3AuYW5nbGU9aDtlPUUoZSxsLzIpO3AubGFiZWxQb3M9W2FbMF0rZitiYShoKSpsLGFbMV0rZytrYShoKSpsLGFbMF0rZitiYShoKSplLGFbMV0rZytrYShoKSplLGFbMF0rZixhWzFdK2csbDwwP1wiY2VudGVyXCI6cC5oYWxmP1wicmlnaHRcIjpcImxlZnRcIixoXX19LGRyYXdHcmFwaDpudWxsLGRyYXdQb2ludHM6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5jaGFydC5yZW5kZXJlcixjLGQsZT1hLm9wdGlvbnMuc2hhZG93LGYsZyxoLGk7aWYoZSYmIWEuc2hhZG93R3JvdXApYS5zaGFkb3dHcm91cD1iLmcoXCJzaGFkb3dcIikuYWRkKGEuZ3JvdXApO24oYS5wb2ludHMsZnVuY3Rpb24oail7aWYoai55IT09bnVsbCl7ZD1qLmdyYXBoaWM7aD1qLnNoYXBlQXJncztmPWouc2hhZG93R3JvdXA7XG5nPWoucG9pbnRBdHRyW2ouc2VsZWN0ZWQ/XCJzZWxlY3RcIjpcIlwiXTtpZighZy5zdHJva2UpZy5zdHJva2U9Zy5maWxsO2lmKGUmJiFmKWY9ai5zaGFkb3dHcm91cD1iLmcoXCJzaGFkb3dcIikuYWRkKGEuc2hhZG93R3JvdXApO2M9ai5zbGljZWQ/ai5zbGljZWRUcmFuc2xhdGlvbjp7dHJhbnNsYXRlWDowLHRyYW5zbGF0ZVk6MH07ZiYmZi5hdHRyKGMpO2lmKGQpZC5zZXRSYWRpYWxSZWZlcmVuY2UoYS5jZW50ZXIpLmF0dHIoZykuYW5pbWF0ZSh4KGgsYykpO2Vsc2V7aT17XCJzdHJva2UtbGluZWpvaW5cIjpcInJvdW5kXCJ9O2lmKCFqLnZpc2libGUpaS52aXNpYmlsaXR5PVwiaGlkZGVuXCI7ai5ncmFwaGljPWQ9YltqLnNoYXBlVHlwZV0oaCkuc2V0UmFkaWFsUmVmZXJlbmNlKGEuY2VudGVyKS5hdHRyKGcpLmF0dHIoaSkuYXR0cihjKS5hZGQoYS5ncm91cCkuc2hhZG93KGUsZil9fX0pfSxzZWFyY2hQb2ludDpyYSxzb3J0QnlBbmdsZTpmdW5jdGlvbihhLGIpe2Euc29ydChmdW5jdGlvbihhLGQpe3JldHVybiBhLmFuZ2xlIT09XG52b2lkIDAmJihkLmFuZ2xlLWEuYW5nbGUpKmJ9KX0sZHJhd0xlZ2VuZFN5bWJvbDphYS5kcmF3UmVjdGFuZ2xlLGdldENlbnRlcjpiYy5nZXRDZW50ZXIsZ2V0U3ltYm9sOnJhfTtjYT1sYShRLGNhKTtLLnBpZT1jYTtRLnByb3RvdHlwZS5kcmF3RGF0YUxhYmVscz1mdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLm9wdGlvbnMsYz1iLmN1cnNvcixkPWIuZGF0YUxhYmVscyxlPWEucG9pbnRzLGYsZyxoPWEuaGFzUmVuZGVyZWR8fDAsaSxqLGs9cShkLmRlZmVyLCEwKSxsPWEuY2hhcnQucmVuZGVyZXI7aWYoZC5lbmFibGVkfHxhLl9oYXNQb2ludExhYmVscylhLmRsUHJvY2Vzc09wdGlvbnMmJmEuZGxQcm9jZXNzT3B0aW9ucyhkKSxqPWEucGxvdEdyb3VwKFwiZGF0YUxhYmVsc0dyb3VwXCIsXCJkYXRhLWxhYmVsc1wiLGsmJiFoP1wiaGlkZGVuXCI6XCJ2aXNpYmxlXCIsZC56SW5kZXh8fDYpLGsmJihqLmF0dHIoe29wYWNpdHk6K2h9KSxofHxEKGEsXCJhZnRlckFuaW1hdGVcIixmdW5jdGlvbigpe2EudmlzaWJsZSYmXG5qLnNob3coKTtqW2IuYW5pbWF0aW9uP1wiYW5pbWF0ZVwiOlwiYXR0clwiXSh7b3BhY2l0eToxfSx7ZHVyYXRpb246MjAwfSl9KSksZz1kLG4oZSxmdW5jdGlvbihlKXt2YXIgaCxrPWUuZGF0YUxhYmVsLHIsbixQPWUuY29ubmVjdG9yLHU9ITAsdyx2PXt9O2Y9ZS5kbE9wdGlvbnN8fGUub3B0aW9ucyYmZS5vcHRpb25zLmRhdGFMYWJlbHM7aD1xKGYmJmYuZW5hYmxlZCxnLmVuYWJsZWQpJiZlLnkhPT1udWxsO2lmKGsmJiFoKWUuZGF0YUxhYmVsPWsuZGVzdHJveSgpO2Vsc2UgaWYoaCl7ZD1DKGcsZik7dz1kLnN0eWxlO2g9ZC5yb3RhdGlvbjtyPWUuZ2V0TGFiZWxDb25maWcoKTtpPWQuZm9ybWF0P0xhKGQuZm9ybWF0LHIpOmQuZm9ybWF0dGVyLmNhbGwocixkKTt3LmNvbG9yPXEoZC5jb2xvcix3LmNvbG9yLGEuY29sb3IsXCJibGFja1wiKTtpZihrKWlmKHMoaSkpay5hdHRyKHt0ZXh0Oml9KSx1PSExO2Vsc2V7aWYoZS5kYXRhTGFiZWw9az1rLmRlc3Ryb3koKSxQKWUuY29ubmVjdG9yPVAuZGVzdHJveSgpfWVsc2UgaWYocyhpKSl7az1cbntmaWxsOmQuYmFja2dyb3VuZENvbG9yLHN0cm9rZTpkLmJvcmRlckNvbG9yLFwic3Ryb2tlLXdpZHRoXCI6ZC5ib3JkZXJXaWR0aCxyOmQuYm9yZGVyUmFkaXVzfHwwLHJvdGF0aW9uOmgscGFkZGluZzpkLnBhZGRpbmcsekluZGV4OjF9O2lmKHcuY29sb3I9PT1cImNvbnRyYXN0XCIpdi5jb2xvcj1kLmluc2lkZXx8ZC5kaXN0YW5jZTwwfHxiLnN0YWNraW5nP2wuZ2V0Q29udHJhc3QoZS5jb2xvcnx8YS5jb2xvcik6XCIjMDAwMDAwXCI7aWYoYyl2LmN1cnNvcj1jO2ZvcihuIGluIGspa1tuXT09PXQmJmRlbGV0ZSBrW25dO2s9ZS5kYXRhTGFiZWw9bFtoP1widGV4dFwiOlwibGFiZWxcIl0oaSwwLC05OTk5LGQuc2hhcGUsbnVsbCxudWxsLGQudXNlSFRNTCkuYXR0cihrKS5jc3MoeCh3LHYpKS5hZGQoaikuc2hhZG93KGQuc2hhZG93KX1rJiZhLmFsaWduRGF0YUxhYmVsKGUsayxkLG51bGwsdSl9fSl9O1EucHJvdG90eXBlLmFsaWduRGF0YUxhYmVsPWZ1bmN0aW9uKGEsYixjLGQsZSl7dmFyIGY9dGhpcy5jaGFydCxcbmc9Zi5pbnZlcnRlZCxoPXEoYS5wbG90WCwtOTk5OSksaT1xKGEucGxvdFksLTk5OTkpLGo9Yi5nZXRCQm94KCksaz1mLnJlbmRlcmVyLmZvbnRNZXRyaWNzKGMuc3R5bGUuZm9udFNpemUpLmIsbD1jLnJvdGF0aW9uLG09Yy5hbGlnbixvPXRoaXMudmlzaWJsZSYmKGEuc2VyaWVzLmZvcmNlREx8fGYuaXNJbnNpZGVQbG90KGgseShpKSxnKXx8ZCYmZi5pc0luc2lkZVBsb3QoaCxnP2QueCsxOmQueStkLmhlaWdodC0xLGcpKSxwPXEoYy5vdmVyZmxvdyxcImp1c3RpZnlcIik9PT1cImp1c3RpZnlcIjtpZihvKWQ9eCh7eDpnP2YucGxvdFdpZHRoLWk6aCx5OnkoZz9mLnBsb3RIZWlnaHQtaDppKSx3aWR0aDowLGhlaWdodDowfSxkKSx4KGMse3dpZHRoOmoud2lkdGgsaGVpZ2h0OmouaGVpZ2h0fSksbD8ocD0hMSxnPWYucmVuZGVyZXIucm90Q29ycihrLGwpLGc9e3g6ZC54K2MueCtkLndpZHRoLzIrZy54LHk6ZC55K2MueStkLmhlaWdodC8yfSxiW2U/XCJhdHRyXCI6XCJhbmltYXRlXCJdKGcpLmF0dHIoe2FsaWduOmMuYWxpZ259KSxcbmg9KGwrNzIwKSUzNjAsaD1oPjE4MCYmaDwzNjAsbT09PVwibGVmdFwiP2cueS09aD9qLmhlaWdodDowOm09PT1cImNlbnRlclwiPyhnLngtPWoud2lkdGgvMixnLnktPWouaGVpZ2h0LzIpOm09PT1cInJpZ2h0XCImJihnLngtPWoud2lkdGgsZy55LT1oPzA6ai5oZWlnaHQpKTooYi5hbGlnbihjLG51bGwsZCksZz1iLmFsaWduQXR0cikscD90aGlzLmp1c3RpZnlEYXRhTGFiZWwoYixjLGcsaixkLGUpOnEoYy5jcm9wLCEwKSYmKG89Zi5pc0luc2lkZVBsb3QoZy54LGcueSkmJmYuaXNJbnNpZGVQbG90KGcueCtqLndpZHRoLGcueStqLmhlaWdodCkpLGMuc2hhcGUmJiFsJiZiLmF0dHIoe2FuY2hvclg6YS5wbG90WCxhbmNob3JZOmEucGxvdFl9KTtpZighbylUYShiKSxiLmF0dHIoe3k6LTk5OTl9KSxiLnBsYWNlZD0hMX07US5wcm90b3R5cGUuanVzdGlmeURhdGFMYWJlbD1mdW5jdGlvbihhLGIsYyxkLGUsZil7dmFyIGc9dGhpcy5jaGFydCxoPWIuYWxpZ24saT1iLnZlcnRpY2FsQWxpZ24saixcbmssbD1hLmJveD8wOmEucGFkZGluZ3x8MDtqPWMueCtsO2lmKGo8MCloPT09XCJyaWdodFwiP2IuYWxpZ249XCJsZWZ0XCI6Yi54PS1qLGs9ITA7aj1jLngrZC53aWR0aC1sO2lmKGo+Zy5wbG90V2lkdGgpaD09PVwibGVmdFwiP2IuYWxpZ249XCJyaWdodFwiOmIueD1nLnBsb3RXaWR0aC1qLGs9ITA7aj1jLnkrbDtpZihqPDApaT09PVwiYm90dG9tXCI/Yi52ZXJ0aWNhbEFsaWduPVwidG9wXCI6Yi55PS1qLGs9ITA7aj1jLnkrZC5oZWlnaHQtbDtpZihqPmcucGxvdEhlaWdodClpPT09XCJ0b3BcIj9iLnZlcnRpY2FsQWxpZ249XCJib3R0b21cIjpiLnk9Zy5wbG90SGVpZ2h0LWosaz0hMDtpZihrKWEucGxhY2VkPSFmLGEuYWxpZ24oYixudWxsLGUpfTtpZihLLnBpZSlLLnBpZS5wcm90b3R5cGUuZHJhd0RhdGFMYWJlbHM9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5kYXRhLGMsZD1hLmNoYXJ0LGU9YS5vcHRpb25zLmRhdGFMYWJlbHMsZj1xKGUuY29ubmVjdG9yUGFkZGluZywxMCksZz1xKGUuY29ubmVjdG9yV2lkdGgsXG4xKSxoPWQucGxvdFdpZHRoLGk9ZC5wbG90SGVpZ2h0LGosayxsPXEoZS5zb2Z0Q29ubmVjdG9yLCEwKSxtPWUuZGlzdGFuY2Usbz1hLmNlbnRlcixwPW9bMl0vMixyPW9bMV0sQT1tPjAscyx1LHcsdD1bW10sW11dLHgseixDLEIsTCxEPVswLDAsMCwwXSxKPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGIueS1hLnl9O2lmKGEudmlzaWJsZSYmKGUuZW5hYmxlZHx8YS5faGFzUG9pbnRMYWJlbHMpKXtRLnByb3RvdHlwZS5kcmF3RGF0YUxhYmVscy5hcHBseShhKTtuKGIsZnVuY3Rpb24oYSl7aWYoYS5kYXRhTGFiZWwmJmEudmlzaWJsZSl0W2EuaGFsZl0ucHVzaChhKSxhLmRhdGFMYWJlbC5fcG9zPW51bGx9KTtmb3IoQj0yO0ItLTspe3ZhciBHPVtdLEs9W10sST10W0JdLEY9SS5sZW5ndGgsSDtpZihGKXthLnNvcnRCeUFuZ2xlKEksQi0wLjUpO2ZvcihMPWI9MDshYiYmSVtMXTspYj1JW0xdJiZJW0xdLmRhdGFMYWJlbCYmKElbTF0uZGF0YUxhYmVsLmdldEJCb3goKS5oZWlnaHR8fDIxKSxcbkwrKztpZihtPjApe3U9RShyK3ArbSxkLnBsb3RIZWlnaHQpO2ZvcihMPXYoMCxyLXAtbSk7TDw9dTtMKz1iKUcucHVzaChMKTt1PUcubGVuZ3RoO2lmKEY+dSl7Yz1bXS5jb25jYXQoSSk7Yy5zb3J0KEopO2ZvcihMPUY7TC0tOyljW0xdLnJhbms9TDtmb3IoTD1GO0wtLTspSVtMXS5yYW5rPj11JiZJLnNwbGljZShMLDEpO0Y9SS5sZW5ndGh9Zm9yKEw9MDtMPEY7TCsrKXtjPUlbTF07dz1jLmxhYmVsUG9zO2M9OTk5OTt2YXIgTSxOO2ZvcihOPTA7Tjx1O04rKylNPVMoR1tOXS13WzFdKSxNPGMmJihjPU0sSD1OKTtpZihIPEwmJkdbTF0hPT1udWxsKUg9TDtlbHNlIGZvcih1PEYtTCtIJiZHW0xdIT09bnVsbCYmKEg9dS1GK0wpO0dbSF09PT1udWxsOylIKys7Sy5wdXNoKHtpOkgseTpHW0hdfSk7R1tIXT1udWxsfUsuc29ydChKKX1mb3IoTD0wO0w8RjtMKyspe2M9SVtMXTt3PWMubGFiZWxQb3M7cz1jLmRhdGFMYWJlbDtDPWMudmlzaWJsZT09PSExP1wiaGlkZGVuXCI6XCJpbmhlcml0XCI7XG5jPXdbMV07aWYobT4wKXtpZih1PUsucG9wKCksSD11Lmksej11LnksYz56JiZHW0grMV0hPT1udWxsfHxjPHomJkdbSC0xXSE9PW51bGwpej1FKHYoMCxjKSxkLnBsb3RIZWlnaHQpfWVsc2Ugej1jO3g9ZS5qdXN0aWZ5P29bMF0rKEI/LTE6MSkqKHArbSk6YS5nZXRYKHo9PT1yLXAtbXx8ej09PXIrcCttP2M6eixCKTtzLl9hdHRyPXt2aXNpYmlsaXR5OkMsYWxpZ246d1s2XX07cy5fcG9zPXt4OngrZS54Kyh7bGVmdDpmLHJpZ2h0Oi1mfVt3WzZdXXx8MCkseTp6K2UueS0xMH07cy5jb25uWD14O3MuY29ublk9ejtpZih0aGlzLm9wdGlvbnMuc2l6ZT09PW51bGwpdT1zLndpZHRoLHgtdTxmP0RbM109dih5KHUteCtmKSxEWzNdKTp4K3U+aC1mJiYoRFsxXT12KHkoeCt1LWgrZiksRFsxXSkpLHotYi8yPDA/RFswXT12KHkoLXorYi8yKSxEWzBdKTp6K2IvMj5pJiYoRFsyXT12KHkoeitiLzItaSksRFsyXSkpfX19aWYoRWEoRCk9PT0wfHx0aGlzLnZlcmlmeURhdGFMYWJlbE92ZXJmbG93KEQpKXRoaXMucGxhY2VEYXRhTGFiZWxzKCksXG5BJiZnJiZuKHRoaXMucG9pbnRzLGZ1bmN0aW9uKGIpe2o9Yi5jb25uZWN0b3I7dz1iLmxhYmVsUG9zO2lmKChzPWIuZGF0YUxhYmVsKSYmcy5fcG9zJiZiLnZpc2libGUpQz1zLl9hdHRyLnZpc2liaWxpdHkseD1zLmNvbm5YLHo9cy5jb25uWSxrPWw/W1wiTVwiLHgrKHdbNl09PT1cImxlZnRcIj81Oi01KSx6LFwiQ1wiLHgseiwyKndbMl0td1s0XSwyKndbM10td1s1XSx3WzJdLHdbM10sXCJMXCIsd1s0XSx3WzVdXTpbXCJNXCIseCsod1s2XT09PVwibGVmdFwiPzU6LTUpLHosXCJMXCIsd1syXSx3WzNdLFwiTFwiLHdbNF0sd1s1XV0saj8oai5hbmltYXRlKHtkOmt9KSxqLmF0dHIoXCJ2aXNpYmlsaXR5XCIsQykpOmIuY29ubmVjdG9yPWo9YS5jaGFydC5yZW5kZXJlci5wYXRoKGspLmF0dHIoe1wic3Ryb2tlLXdpZHRoXCI6ZyxzdHJva2U6ZS5jb25uZWN0b3JDb2xvcnx8Yi5jb2xvcnx8XCIjNjA2MDYwXCIsdmlzaWJpbGl0eTpDfSkuYWRkKGEuZGF0YUxhYmVsc0dyb3VwKTtlbHNlIGlmKGopYi5jb25uZWN0b3I9ai5kZXN0cm95KCl9KX19LFxuSy5waWUucHJvdG90eXBlLnBsYWNlRGF0YUxhYmVscz1mdW5jdGlvbigpe24odGhpcy5wb2ludHMsZnVuY3Rpb24oYSl7dmFyIGI9YS5kYXRhTGFiZWw7aWYoYiYmYS52aXNpYmxlKShhPWIuX3Bvcyk/KGIuYXR0cihiLl9hdHRyKSxiW2IubW92ZWQ/XCJhbmltYXRlXCI6XCJhdHRyXCJdKGEpLGIubW92ZWQ9ITApOmImJmIuYXR0cih7eTotOTk5OX0pfSl9LEsucGllLnByb3RvdHlwZS5hbGlnbkRhdGFMYWJlbD1yYSxLLnBpZS5wcm90b3R5cGUudmVyaWZ5RGF0YUxhYmVsT3ZlcmZsb3c9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jZW50ZXIsYz10aGlzLm9wdGlvbnMsZD1jLmNlbnRlcixlPWMubWluU2l6ZXx8ODAsZj1lLGc7ZFswXSE9PW51bGw/Zj12KGJbMl0tdihhWzFdLGFbM10pLGUpOihmPXYoYlsyXS1hWzFdLWFbM10sZSksYlswXSs9KGFbM10tYVsxXSkvMik7ZFsxXSE9PW51bGw/Zj12KEUoZixiWzJdLXYoYVswXSxhWzJdKSksZSk6KGY9dihFKGYsYlsyXS1hWzBdLWFbMl0pLGUpLFxuYlsxXSs9KGFbMF0tYVsyXSkvMik7ZjxiWzJdPyhiWzJdPWYsYlszXT1NYXRoLm1pbigvJSQvLnRlc3QoYy5pbm5lclNpemV8fDApP2YqcGFyc2VGbG9hdChjLmlubmVyU2l6ZXx8MCkvMTAwOnBhcnNlRmxvYXQoYy5pbm5lclNpemV8fDApLGYpLHRoaXMudHJhbnNsYXRlKGIpLHRoaXMuZHJhd0RhdGFMYWJlbHMmJnRoaXMuZHJhd0RhdGFMYWJlbHMoKSk6Zz0hMDtyZXR1cm4gZ307aWYoSy5jb2x1bW4pSy5jb2x1bW4ucHJvdG90eXBlLmFsaWduRGF0YUxhYmVsPWZ1bmN0aW9uKGEsYixjLGQsZSl7dmFyIGY9dGhpcy5jaGFydC5pbnZlcnRlZCxnPWEuc2VyaWVzLGg9YS5kbEJveHx8YS5zaGFwZUFyZ3MsaT1xKGEuYmVsb3csYS5wbG90WT5xKHRoaXMudHJhbnNsYXRlZFRocmVzaG9sZCxnLnlBeGlzLmxlbikpLGo9cShjLmluc2lkZSwhIXRoaXMub3B0aW9ucy5zdGFja2luZyk7aWYoaCl7ZD1DKGgpO2lmKGQueTwwKWQuaGVpZ2h0Kz1kLnksZC55PTA7aD1kLnkrZC5oZWlnaHQtZy55QXhpcy5sZW47XG5oPjAmJihkLmhlaWdodC09aCk7ZiYmKGQ9e3g6Zy55QXhpcy5sZW4tZC55LWQuaGVpZ2h0LHk6Zy54QXhpcy5sZW4tZC54LWQud2lkdGgsd2lkdGg6ZC5oZWlnaHQsaGVpZ2h0OmQud2lkdGh9KTtpZighailmPyhkLngrPWk/MDpkLndpZHRoLGQud2lkdGg9MCk6KGQueSs9aT9kLmhlaWdodDowLGQuaGVpZ2h0PTApfWMuYWxpZ249cShjLmFsaWduLCFmfHxqP1wiY2VudGVyXCI6aT9cInJpZ2h0XCI6XCJsZWZ0XCIpO2MudmVydGljYWxBbGlnbj1xKGMudmVydGljYWxBbGlnbixmfHxqP1wibWlkZGxlXCI6aT9cInRvcFwiOlwiYm90dG9tXCIpO1EucHJvdG90eXBlLmFsaWduRGF0YUxhYmVsLmNhbGwodGhpcyxhLGIsYyxkLGUpfTsoZnVuY3Rpb24oYSl7dmFyIGI9YS5DaGFydCxjPWEuZWFjaCxkPWEucGljayxlPWEuYWRkRXZlbnQ7Yi5wcm90b3R5cGUuY2FsbGJhY2tzLnB1c2goZnVuY3Rpb24oYSl7ZnVuY3Rpb24gYigpe3ZhciBlPVtdO2MoYS5zZXJpZXMsZnVuY3Rpb24oYSl7dmFyIGI9YS5vcHRpb25zLmRhdGFMYWJlbHMsXG5mPWEuZGF0YUxhYmVsQ29sbGVjdGlvbnN8fFtcImRhdGFMYWJlbFwiXTsoYi5lbmFibGVkfHxhLl9oYXNQb2ludExhYmVscykmJiFiLmFsbG93T3ZlcmxhcCYmYS52aXNpYmxlJiZjKGYsZnVuY3Rpb24oYil7YyhhLnBvaW50cyxmdW5jdGlvbihhKXtpZihhW2JdKWFbYl0ubGFiZWxyYW5rPWQoYS5sYWJlbHJhbmssYS5zaGFwZUFyZ3MmJmEuc2hhcGVBcmdzLmhlaWdodCksZS5wdXNoKGFbYl0pfSl9KX0pO2EuaGlkZU92ZXJsYXBwaW5nTGFiZWxzKGUpfWIoKTtlKGEsXCJyZWRyYXdcIixiKX0pO2IucHJvdG90eXBlLmhpZGVPdmVybGFwcGluZ0xhYmVscz1mdW5jdGlvbihhKXt2YXIgYj1hLmxlbmd0aCxkLGUsaixrLGwsbSxvLHAsbjtmb3IoZT0wO2U8YjtlKyspaWYoZD1hW2VdKWQub2xkT3BhY2l0eT1kLm9wYWNpdHksZC5uZXdPcGFjaXR5PTE7YS5zb3J0KGZ1bmN0aW9uKGEsYil7cmV0dXJuKGIubGFiZWxyYW5rfHwwKS0oYS5sYWJlbHJhbmt8fDApfSk7Zm9yKGU9MDtlPGI7ZSsrKXtqPVxuYVtlXTtmb3IoZD1lKzE7ZDxiOysrZClpZihrPWFbZF0saiYmayYmai5wbGFjZWQmJmsucGxhY2VkJiZqLm5ld09wYWNpdHkhPT0wJiZrLm5ld09wYWNpdHkhPT0wJiYobD1qLmFsaWduQXR0cixtPWsuYWxpZ25BdHRyLG89ai5wYXJlbnRHcm91cCxwPWsucGFyZW50R3JvdXAsbj0yKihqLmJveD8wOmoucGFkZGluZyksbD0hKG0ueCtwLnRyYW5zbGF0ZVg+bC54K28udHJhbnNsYXRlWCsoai53aWR0aC1uKXx8bS54K3AudHJhbnNsYXRlWCsoay53aWR0aC1uKTxsLngrby50cmFuc2xhdGVYfHxtLnkrcC50cmFuc2xhdGVZPmwueStvLnRyYW5zbGF0ZVkrKGouaGVpZ2h0LW4pfHxtLnkrcC50cmFuc2xhdGVZKyhrLmhlaWdodC1uKTxsLnkrby50cmFuc2xhdGVZKSkpKGoubGFiZWxyYW5rPGsubGFiZWxyYW5rP2o6aykubmV3T3BhY2l0eT0wfWMoYSxmdW5jdGlvbihhKXt2YXIgYixjO2lmKGEpe2M9YS5uZXdPcGFjaXR5O2lmKGEub2xkT3BhY2l0eSE9PWMmJmEucGxhY2VkKWM/YS5zaG93KCEwKTpcbmI9ZnVuY3Rpb24oKXthLmhpZGUoKX0sYS5hbGlnbkF0dHIub3BhY2l0eT1jLGFbYS5pc09sZD9cImFuaW1hdGVcIjpcImF0dHJcIl0oYS5hbGlnbkF0dHIsbnVsbCxiKTthLmlzT2xkPSEwfX0pfX0pKHopO3ZhciBuYj16LlRyYWNrZXJNaXhpbj17ZHJhd1RyYWNrZXJQb2ludDpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLmNoYXJ0LGM9Yi5wb2ludGVyLGQ9YS5vcHRpb25zLmN1cnNvcixlPWQmJntjdXJzb3I6ZH0sZj1mdW5jdGlvbihhKXtmb3IodmFyIGM9YS50YXJnZXQsZDtjJiYhZDspZD1jLnBvaW50LGM9Yy5wYXJlbnROb2RlO2lmKGQhPT10JiZkIT09Yi5ob3ZlclBvaW50KWQub25Nb3VzZU92ZXIoYSl9O24oYS5wb2ludHMsZnVuY3Rpb24oYSl7aWYoYS5ncmFwaGljKWEuZ3JhcGhpYy5lbGVtZW50LnBvaW50PWE7aWYoYS5kYXRhTGFiZWwpYS5kYXRhTGFiZWwuZWxlbWVudC5wb2ludD1hfSk7aWYoIWEuX2hhc1RyYWNraW5nKW4oYS50cmFja2VyR3JvdXBzLGZ1bmN0aW9uKGIpe2lmKGFbYl0mJlxuKGFbYl0uYWRkQ2xhc3MoXCJoaWdoY2hhcnRzLXRyYWNrZXJcIikub24oXCJtb3VzZW92ZXJcIixmKS5vbihcIm1vdXNlb3V0XCIsZnVuY3Rpb24oYSl7Yy5vblRyYWNrZXJNb3VzZU91dChhKX0pLmNzcyhlKSxkYikpYVtiXS5vbihcInRvdWNoc3RhcnRcIixmKX0pLGEuX2hhc1RyYWNraW5nPSEwfSxkcmF3VHJhY2tlckdyYXBoOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEub3B0aW9ucyxjPWIudHJhY2tCeUFyZWEsZD1bXS5jb25jYXQoYz9hLmFyZWFQYXRoOmEuZ3JhcGhQYXRoKSxlPWQubGVuZ3RoLGY9YS5jaGFydCxnPWYucG9pbnRlcixoPWYucmVuZGVyZXIsaT1mLm9wdGlvbnMudG9vbHRpcC5zbmFwLGo9YS50cmFja2VyLGs9Yi5jdXJzb3IsbD1rJiZ7Y3Vyc29yOmt9LG09ZnVuY3Rpb24oKXtpZihmLmhvdmVyU2VyaWVzIT09YSlhLm9uTW91c2VPdmVyKCl9LG89XCJyZ2JhKDE5MiwxOTIsMTkyLFwiKyhqYT8xLjBFLTQ6MC4wMDIpK1wiKVwiO2lmKGUmJiFjKWZvcihrPWUrMTtrLS07KWRba109PT1cblwiTVwiJiZkLnNwbGljZShrKzEsMCxkW2srMV0taSxkW2srMl0sXCJMXCIpLChrJiZkW2tdPT09XCJNXCJ8fGs9PT1lKSYmZC5zcGxpY2UoaywwLFwiTFwiLGRbay0yXStpLGRbay0xXSk7aj9qLmF0dHIoe2Q6ZH0pOihhLnRyYWNrZXI9aC5wYXRoKGQpLmF0dHIoe1wic3Ryb2tlLWxpbmVqb2luXCI6XCJyb3VuZFwiLHZpc2liaWxpdHk6YS52aXNpYmxlP1widmlzaWJsZVwiOlwiaGlkZGVuXCIsc3Ryb2tlOm8sZmlsbDpjP286XCJub25lXCIsXCJzdHJva2Utd2lkdGhcIjpiLmxpbmVXaWR0aCsoYz8wOjIqaSksekluZGV4OjJ9KS5hZGQoYS5ncm91cCksbihbYS50cmFja2VyLGEubWFya2VyR3JvdXBdLGZ1bmN0aW9uKGEpe2EuYWRkQ2xhc3MoXCJoaWdoY2hhcnRzLXRyYWNrZXJcIikub24oXCJtb3VzZW92ZXJcIixtKS5vbihcIm1vdXNlb3V0XCIsZnVuY3Rpb24oYSl7Zy5vblRyYWNrZXJNb3VzZU91dChhKX0pLmNzcyhsKTtpZihkYilhLm9uKFwidG91Y2hzdGFydFwiLG0pfSkpfX07aWYoSy5jb2x1bW4pSWEucHJvdG90eXBlLmRyYXdUcmFja2VyPVxubmIuZHJhd1RyYWNrZXJQb2ludDtpZihLLnBpZSlLLnBpZS5wcm90b3R5cGUuZHJhd1RyYWNrZXI9bmIuZHJhd1RyYWNrZXJQb2ludDtpZihLLnNjYXR0ZXIpemEucHJvdG90eXBlLmRyYXdUcmFja2VyPW5iLmRyYXdUcmFja2VyUG9pbnQ7eCh2Yi5wcm90b3R5cGUse3NldEl0ZW1FdmVudHM6ZnVuY3Rpb24oYSxiLGMsZCxlKXt2YXIgZj10aGlzOyhjP2I6YS5sZWdlbmRHcm91cCkub24oXCJtb3VzZW92ZXJcIixmdW5jdGlvbigpe2Euc2V0U3RhdGUoXCJob3ZlclwiKTtiLmNzcyhmLm9wdGlvbnMuaXRlbUhvdmVyU3R5bGUpfSkub24oXCJtb3VzZW91dFwiLGZ1bmN0aW9uKCl7Yi5jc3MoYS52aXNpYmxlP2Q6ZSk7YS5zZXRTdGF0ZSgpfSkub24oXCJjbGlja1wiLGZ1bmN0aW9uKGIpe3ZhciBjPWZ1bmN0aW9uKCl7YS5zZXRWaXNpYmxlJiZhLnNldFZpc2libGUoKX0sYj17YnJvd3NlckV2ZW50OmJ9O2EuZmlyZVBvaW50RXZlbnQ/YS5maXJlUG9pbnRFdmVudChcImxlZ2VuZEl0ZW1DbGlja1wiLGIsYyk6XG5NKGEsXCJsZWdlbmRJdGVtQ2xpY2tcIixiLGMpfSl9LGNyZWF0ZUNoZWNrYm94Rm9ySXRlbTpmdW5jdGlvbihhKXthLmNoZWNrYm94PWVhKFwiaW5wdXRcIix7dHlwZTpcImNoZWNrYm94XCIsY2hlY2tlZDphLnNlbGVjdGVkLGRlZmF1bHRDaGVja2VkOmEuc2VsZWN0ZWR9LHRoaXMub3B0aW9ucy5pdGVtQ2hlY2tib3hTdHlsZSx0aGlzLmNoYXJ0LmNvbnRhaW5lcik7RChhLmNoZWNrYm94LFwiY2xpY2tcIixmdW5jdGlvbihiKXtNKGEuc2VyaWVzfHxhLFwiY2hlY2tib3hDbGlja1wiLHtjaGVja2VkOmIudGFyZ2V0LmNoZWNrZWQsaXRlbTphfSxmdW5jdGlvbigpe2Euc2VsZWN0KCl9KX0pfX0pO04ubGVnZW5kLml0ZW1TdHlsZS5jdXJzb3I9XCJwb2ludGVyXCI7eChDYS5wcm90b3R5cGUse3Nob3dSZXNldFpvb206ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9Ti5sYW5nLGM9YS5vcHRpb25zLmNoYXJ0LnJlc2V0Wm9vbUJ1dHRvbixkPWMudGhlbWUsZT1kLnN0YXRlcyxmPWMucmVsYXRpdmVUbz09PVwiY2hhcnRcIj9cbm51bGw6XCJwbG90Qm94XCI7dGhpcy5yZXNldFpvb21CdXR0b249YS5yZW5kZXJlci5idXR0b24oYi5yZXNldFpvb20sbnVsbCxudWxsLGZ1bmN0aW9uKCl7YS56b29tT3V0KCl9LGQsZSYmZS5ob3ZlcikuYXR0cih7YWxpZ246Yy5wb3NpdGlvbi5hbGlnbix0aXRsZTpiLnJlc2V0Wm9vbVRpdGxlfSkuYWRkKCkuYWxpZ24oYy5wb3NpdGlvbiwhMSxmKX0sem9vbU91dDpmdW5jdGlvbigpe3ZhciBhPXRoaXM7TShhLFwic2VsZWN0aW9uXCIse3Jlc2V0U2VsZWN0aW9uOiEwfSxmdW5jdGlvbigpe2Euem9vbSgpfSl9LHpvb206ZnVuY3Rpb24oYSl7dmFyIGIsYz10aGlzLnBvaW50ZXIsZD0hMSxlOyFhfHxhLnJlc2V0U2VsZWN0aW9uP24odGhpcy5heGVzLGZ1bmN0aW9uKGEpe2I9YS56b29tKCl9KTpuKGEueEF4aXMuY29uY2F0KGEueUF4aXMpLGZ1bmN0aW9uKGEpe3ZhciBlPWEuYXhpcyxoPWUuaXNYQXhpcztpZihjW2g/XCJ6b29tWFwiOlwiem9vbVlcIl18fGNbaD9cInBpbmNoWFwiOlwicGluY2hZXCJdKWI9XG5lLnpvb20oYS5taW4sYS5tYXgpLGUuZGlzcGxheUJ0biYmKGQ9ITApfSk7ZT10aGlzLnJlc2V0Wm9vbUJ1dHRvbjtpZihkJiYhZSl0aGlzLnNob3dSZXNldFpvb20oKTtlbHNlIGlmKCFkJiZkYShlKSl0aGlzLnJlc2V0Wm9vbUJ1dHRvbj1lLmRlc3Ryb3koKTtiJiZ0aGlzLnJlZHJhdyhxKHRoaXMub3B0aW9ucy5jaGFydC5hbmltYXRpb24sYSYmYS5hbmltYXRpb24sdGhpcy5wb2ludENvdW50PDEwMCkpfSxwYW46ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLGQ9Yy5ob3ZlclBvaW50cyxlO2QmJm4oZCxmdW5jdGlvbihhKXthLnNldFN0YXRlKCl9KTtuKGI9PT1cInh5XCI/WzEsMF06WzFdLGZ1bmN0aW9uKGIpe3ZhciBiPWNbYj9cInhBeGlzXCI6XCJ5QXhpc1wiXVswXSxkPWIuaG9yaXosaD1hW2Q/XCJjaGFydFhcIjpcImNoYXJ0WVwiXSxkPWQ/XCJtb3VzZURvd25YXCI6XCJtb3VzZURvd25ZXCIsaT1jW2RdLGo9KGIucG9pbnRSYW5nZXx8MCkvMixrPWIuZ2V0RXh0cmVtZXMoKSxsPWIudG9WYWx1ZShpLVxuaCwhMCkraixqPWIudG9WYWx1ZShpK2IubGVuLWgsITApLWosaT1pPmg7aWYoYi5zZXJpZXMubGVuZ3RoJiYoaXx8bD5FKGsuZGF0YU1pbixrLm1pbikpJiYoIWl8fGo8dihrLmRhdGFNYXgsay5tYXgpKSliLnNldEV4dHJlbWVzKGwsaiwhMSwhMSx7dHJpZ2dlcjpcInBhblwifSksZT0hMDtjW2RdPWh9KTtlJiZjLnJlZHJhdyghMSk7RihjLmNvbnRhaW5lcix7Y3Vyc29yOlwibW92ZVwifSl9fSk7eChIYS5wcm90b3R5cGUse3NlbGVjdDpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMsZD1jLnNlcmllcyxlPWQuY2hhcnQsYT1xKGEsIWMuc2VsZWN0ZWQpO2MuZmlyZVBvaW50RXZlbnQoYT9cInNlbGVjdFwiOlwidW5zZWxlY3RcIix7YWNjdW11bGF0ZTpifSxmdW5jdGlvbigpe2Muc2VsZWN0ZWQ9Yy5vcHRpb25zLnNlbGVjdGVkPWE7ZC5vcHRpb25zLmRhdGFbc2EoYyxkLmRhdGEpXT1jLm9wdGlvbnM7Yy5zZXRTdGF0ZShhJiZcInNlbGVjdFwiKTtifHxuKGUuZ2V0U2VsZWN0ZWRQb2ludHMoKSxmdW5jdGlvbihhKXtpZihhLnNlbGVjdGVkJiZcbmEhPT1jKWEuc2VsZWN0ZWQ9YS5vcHRpb25zLnNlbGVjdGVkPSExLGQub3B0aW9ucy5kYXRhW3NhKGEsZC5kYXRhKV09YS5vcHRpb25zLGEuc2V0U3RhdGUoXCJcIiksYS5maXJlUG9pbnRFdmVudChcInVuc2VsZWN0XCIpfSl9KX0sb25Nb3VzZU92ZXI6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLnNlcmllcyxkPWMuY2hhcnQsZT1kLnRvb2x0aXAsZj1kLmhvdmVyUG9pbnQ7aWYoZC5ob3ZlclNlcmllcyE9PWMpYy5vbk1vdXNlT3ZlcigpO2lmKGYmJmYhPT10aGlzKWYub25Nb3VzZU91dCgpO2lmKHRoaXMuc2VyaWVzJiYodGhpcy5maXJlUG9pbnRFdmVudChcIm1vdXNlT3ZlclwiKSxlJiYoIWUuc2hhcmVkfHxjLm5vU2hhcmVkVG9vbHRpcCkmJmUucmVmcmVzaCh0aGlzLGEpLHRoaXMuc2V0U3RhdGUoXCJob3ZlclwiKSwhYikpZC5ob3ZlclBvaW50PXRoaXN9LG9uTW91c2VPdXQ6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLnNlcmllcy5jaGFydCxiPWEuaG92ZXJQb2ludHM7dGhpcy5maXJlUG9pbnRFdmVudChcIm1vdXNlT3V0XCIpO1xuaWYoIWJ8fHNhKHRoaXMsYik9PT0tMSl0aGlzLnNldFN0YXRlKCksYS5ob3ZlclBvaW50PW51bGx9LGltcG9ydEV2ZW50czpmdW5jdGlvbigpe2lmKCF0aGlzLmhhc0ltcG9ydGVkRXZlbnRzKXt2YXIgYT1DKHRoaXMuc2VyaWVzLm9wdGlvbnMucG9pbnQsdGhpcy5vcHRpb25zKS5ldmVudHMsYjt0aGlzLmV2ZW50cz1hO2ZvcihiIGluIGEpRCh0aGlzLGIsYVtiXSk7dGhpcy5oYXNJbXBvcnRlZEV2ZW50cz0hMH19LHNldFN0YXRlOmZ1bmN0aW9uKGEsYil7dmFyIGM9Vih0aGlzLnBsb3RYKSxkPXRoaXMucGxvdFksZT10aGlzLnNlcmllcyxmPWUub3B0aW9ucy5zdGF0ZXMsZz1XW2UudHlwZV0ubWFya2VyJiZlLm9wdGlvbnMubWFya2VyLGg9ZyYmIWcuZW5hYmxlZCxpPWcmJmcuc3RhdGVzW2FdLGo9aSYmaS5lbmFibGVkPT09ITEsaz1lLnN0YXRlTWFya2VyR3JhcGhpYyxsPXRoaXMubWFya2VyfHx7fSxtPWUuY2hhcnQsbz1lLmhhbG8scCxhPWF8fFwiXCI7cD10aGlzLnBvaW50QXR0clthXXx8XG5lLnBvaW50QXR0clthXTtpZighKGE9PT10aGlzLnN0YXRlJiYhYnx8dGhpcy5zZWxlY3RlZCYmYSE9PVwic2VsZWN0XCJ8fGZbYV0mJmZbYV0uZW5hYmxlZD09PSExfHxhJiYoanx8aCYmaS5lbmFibGVkPT09ITEpfHxhJiZsLnN0YXRlcyYmbC5zdGF0ZXNbYV0mJmwuc3RhdGVzW2FdLmVuYWJsZWQ9PT0hMSkpe2lmKHRoaXMuZ3JhcGhpYylnPWcmJnRoaXMuZ3JhcGhpYy5zeW1ib2xOYW1lJiZwLnIsdGhpcy5ncmFwaGljLmF0dHIoQyhwLGc/e3g6Yy1nLHk6ZC1nLHdpZHRoOjIqZyxoZWlnaHQ6MipnfTp7fSkpLGsmJmsuaGlkZSgpO2Vsc2V7aWYoYSYmaSlpZihnPWkucmFkaXVzLGw9bC5zeW1ib2x8fGUuc3ltYm9sLGsmJmsuY3VycmVudFN5bWJvbCE9PWwmJihrPWsuZGVzdHJveSgpKSxrKWtbYj9cImFuaW1hdGVcIjpcImF0dHJcIl0oe3g6Yy1nLHk6ZC1nfSk7ZWxzZSBpZihsKWUuc3RhdGVNYXJrZXJHcmFwaGljPWs9bS5yZW5kZXJlci5zeW1ib2wobCxjLWcsZC1nLDIqZywyKmcpLmF0dHIocCkuYWRkKGUubWFya2VyR3JvdXApLFxuay5jdXJyZW50U3ltYm9sPWw7aWYoaylrW2EmJm0uaXNJbnNpZGVQbG90KGMsZCxtLmludmVydGVkKT9cInNob3dcIjpcImhpZGVcIl0oKSxrLmVsZW1lbnQucG9pbnQ9dGhpc31pZigoYz1mW2FdJiZmW2FdLmhhbG8pJiZjLnNpemUpe2lmKCFvKWUuaGFsbz1vPW0ucmVuZGVyZXIucGF0aCgpLmFkZChtLnNlcmllc0dyb3VwKTtvLmF0dHIoeCh7ZmlsbDp0aGlzLmNvbG9yfHxlLmNvbG9yLFwiZmlsbC1vcGFjaXR5XCI6Yy5vcGFjaXR5LHpJbmRleDotMX0sYy5hdHRyaWJ1dGVzKSlbYj9cImFuaW1hdGVcIjpcImF0dHJcIl0oe2Q6dGhpcy5oYWxvUGF0aChjLnNpemUpfSl9ZWxzZSBvJiZvLmF0dHIoe2Q6W119KTt0aGlzLnN0YXRlPWF9fSxoYWxvUGF0aDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLnNlcmllcyxjPWIuY2hhcnQsZD1iLmdldFBsb3RCb3goKSxlPWMuaW52ZXJ0ZWQsZj1NYXRoLmZsb29yKHRoaXMucGxvdFgpO3JldHVybiBjLnJlbmRlcmVyLnN5bWJvbHMuY2lyY2xlKGQudHJhbnNsYXRlWCtcbihlP2IueUF4aXMubGVuLXRoaXMucGxvdFk6ZiktYSxkLnRyYW5zbGF0ZVkrKGU/Yi54QXhpcy5sZW4tZjp0aGlzLnBsb3RZKS1hLGEqMixhKjIpfX0pO3goUS5wcm90b3R5cGUse29uTW91c2VPdmVyOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5jaGFydCxiPWEuaG92ZXJTZXJpZXM7aWYoYiYmYiE9PXRoaXMpYi5vbk1vdXNlT3V0KCk7dGhpcy5vcHRpb25zLmV2ZW50cy5tb3VzZU92ZXImJk0odGhpcyxcIm1vdXNlT3ZlclwiKTt0aGlzLnNldFN0YXRlKFwiaG92ZXJcIik7YS5ob3ZlclNlcmllcz10aGlzfSxvbk1vdXNlT3V0OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcHRpb25zLGI9dGhpcy5jaGFydCxjPWIudG9vbHRpcCxkPWIuaG92ZXJQb2ludDtiLmhvdmVyU2VyaWVzPW51bGw7aWYoZClkLm9uTW91c2VPdXQoKTt0aGlzJiZhLmV2ZW50cy5tb3VzZU91dCYmTSh0aGlzLFwibW91c2VPdXRcIik7YyYmIWEuc3RpY2t5VHJhY2tpbmcmJighYy5zaGFyZWR8fHRoaXMubm9TaGFyZWRUb29sdGlwKSYmXG5jLmhpZGUoKTt0aGlzLnNldFN0YXRlKCl9LHNldFN0YXRlOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMub3B0aW9ucyxjPXRoaXMuZ3JhcGgsZD1iLnN0YXRlcyxlPWIubGluZVdpZHRoLGI9MCxhPWF8fFwiXCI7aWYodGhpcy5zdGF0ZSE9PWEmJih0aGlzLnN0YXRlPWEsIShkW2FdJiZkW2FdLmVuYWJsZWQ9PT0hMSkmJihhJiYoZT1kW2FdLmxpbmVXaWR0aHx8ZSsoZFthXS5saW5lV2lkdGhQbHVzfHwwKSksYyYmIWMuZGFzaHN0eWxlKSkpe2E9e1wic3Ryb2tlLXdpZHRoXCI6ZX07Zm9yKGMuYXR0cihhKTt0aGlzW1wiem9uZUdyYXBoXCIrYl07KXRoaXNbXCJ6b25lR3JhcGhcIitiXS5hdHRyKGEpLGIrPTF9fSxzZXRWaXNpYmxlOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcyxkPWMuY2hhcnQsZT1jLmxlZ2VuZEl0ZW0sZixnPWQub3B0aW9ucy5jaGFydC5pZ25vcmVIaWRkZW5TZXJpZXMsaD1jLnZpc2libGU7Zj0oYy52aXNpYmxlPWE9Yy51c2VyT3B0aW9ucy52aXNpYmxlPWE9PT10PyFoOmEpP1wic2hvd1wiOlxuXCJoaWRlXCI7bihbXCJncm91cFwiLFwiZGF0YUxhYmVsc0dyb3VwXCIsXCJtYXJrZXJHcm91cFwiLFwidHJhY2tlclwiXSxmdW5jdGlvbihhKXtpZihjW2FdKWNbYV1bZl0oKX0pO2lmKGQuaG92ZXJTZXJpZXM9PT1jfHwoZC5ob3ZlclBvaW50JiZkLmhvdmVyUG9pbnQuc2VyaWVzKT09PWMpYy5vbk1vdXNlT3V0KCk7ZSYmZC5sZWdlbmQuY29sb3JpemVJdGVtKGMsYSk7Yy5pc0RpcnR5PSEwO2Mub3B0aW9ucy5zdGFja2luZyYmbihkLnNlcmllcyxmdW5jdGlvbihhKXtpZihhLm9wdGlvbnMuc3RhY2tpbmcmJmEudmlzaWJsZSlhLmlzRGlydHk9ITB9KTtuKGMubGlua2VkU2VyaWVzLGZ1bmN0aW9uKGIpe2Iuc2V0VmlzaWJsZShhLCExKX0pO2lmKGcpZC5pc0RpcnR5Qm94PSEwO2IhPT0hMSYmZC5yZWRyYXcoKTtNKGMsZil9LHNob3c6ZnVuY3Rpb24oKXt0aGlzLnNldFZpc2libGUoITApfSxoaWRlOmZ1bmN0aW9uKCl7dGhpcy5zZXRWaXNpYmxlKCExKX0sc2VsZWN0OmZ1bmN0aW9uKGEpe3RoaXMuc2VsZWN0ZWQ9XG5hPWE9PT10PyF0aGlzLnNlbGVjdGVkOmE7aWYodGhpcy5jaGVja2JveCl0aGlzLmNoZWNrYm94LmNoZWNrZWQ9YTtNKHRoaXMsYT9cInNlbGVjdFwiOlwidW5zZWxlY3RcIil9LGRyYXdUcmFja2VyOm5iLmRyYXdUcmFja2VyR3JhcGh9KTtVKFEucHJvdG90eXBlLFwiaW5pdFwiLGZ1bmN0aW9uKGEpe3ZhciBiO2EuYXBwbHkodGhpcyxBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSkpOyhiPXRoaXMueEF4aXMpJiZiLm9wdGlvbnMub3JkaW5hbCYmRCh0aGlzLFwidXBkYXRlZERhdGFcIixmdW5jdGlvbigpe2RlbGV0ZSBiLm9yZGluYWxJbmRleH0pfSk7VShJLnByb3RvdHlwZSxcImdldFRpbWVUaWNrc1wiLGZ1bmN0aW9uKGEsYixjLGQsZSxmLGcsaCl7dmFyIGk9MCxqLGssbD17fSxtLG8scCxuPVtdLHE9LU51bWJlci5NQVhfVkFMVUUsdj10aGlzLm9wdGlvbnMudGlja1BpeGVsSW50ZXJ2YWw7aWYoIXRoaXMub3B0aW9ucy5vcmRpbmFsJiYhdGhpcy5vcHRpb25zLmJyZWFrc3x8XG4hZnx8Zi5sZW5ndGg8M3x8Yz09PXQpcmV0dXJuIGEuY2FsbCh0aGlzLGIsYyxkLGUpO289Zi5sZW5ndGg7Zm9yKGo9MDtqPG87aisrKXtwPWomJmZbai0xXT5kO2Zbal08YyYmKGk9aik7aWYoaj09PW8tMXx8ZltqKzFdLWZbal0+Zyo1fHxwKXtpZihmW2pdPnEpe2ZvcihrPWEuY2FsbCh0aGlzLGIsZltpXSxmW2pdLGUpO2subGVuZ3RoJiZrWzBdPD1xOylrLnNoaWZ0KCk7ay5sZW5ndGgmJihxPWtbay5sZW5ndGgtMV0pO249bi5jb25jYXQoayl9aT1qKzF9aWYocClicmVha31hPWsuaW5mbztpZihoJiZhLnVuaXRSYW5nZTw9SC5ob3VyKXtqPW4ubGVuZ3RoLTE7Zm9yKGk9MTtpPGo7aSsrKW1hKFwiJWRcIixuW2ldKSE9PW1hKFwiJWRcIixuW2ktMV0pJiYobFtuW2ldXT1cImRheVwiLG09ITApO20mJihsW25bMF1dPVwiZGF5XCIpO2EuaGlnaGVyUmFua3M9bH1uLmluZm89YTtpZihoJiZzKHYpKXtoPWE9bi5sZW5ndGg7aj1bXTt2YXIgdTtmb3IobT1bXTtoLS07KWk9dGhpcy50cmFuc2xhdGUobltoXSksXG51JiYobVtoXT11LWkpLGpbaF09dT1pO20uc29ydCgpO209bVtWKG0ubGVuZ3RoLzIpXTttPHYqMC42JiYobT1udWxsKTtoPW5bYS0xXT5kP2EtMTphO2Zvcih1PXZvaWQgMDtoLS07KWk9altoXSxkPXUtaSx1JiZkPHYqMC44JiYobT09PW51bGx8fGQ8bSowLjgpPyhsW25baF1dJiYhbFtuW2grMV1dPyhkPWgrMSx1PWkpOmQ9aCxuLnNwbGljZShkLDEpKTp1PWl9cmV0dXJuIG59KTt4KEkucHJvdG90eXBlLHtiZWZvcmVTZXRUaWNrUG9zaXRpb25zOmZ1bmN0aW9uKCl7dmFyIGEsYj1bXSxjPSExLGQsZT10aGlzLmdldEV4dHJlbWVzKCksZj1lLm1pbixnPWUubWF4LGgsaT10aGlzLmlzWEF4aXMmJiEhdGhpcy5vcHRpb25zLmJyZWFrcztpZigoZT10aGlzLm9wdGlvbnMub3JkaW5hbCl8fGkpe24odGhpcy5zZXJpZXMsZnVuY3Rpb24oYyxkKXtpZihjLnZpc2libGUhPT0hMSYmKGMudGFrZU9yZGluYWxQb3NpdGlvbiE9PSExfHxpKSlpZihiPWIuY29uY2F0KGMucHJvY2Vzc2VkWERhdGEpLFxuYT1iLmxlbmd0aCxiLnNvcnQoZnVuY3Rpb24oYSxiKXtyZXR1cm4gYS1ifSksYSlmb3IoZD1hLTE7ZC0tOyliW2RdPT09YltkKzFdJiZiLnNwbGljZShkLDEpfSk7YT1iLmxlbmd0aDtpZihhPjIpe2Q9YlsxXS1iWzBdO2ZvcihoPWEtMTtoLS0mJiFjOyliW2grMV0tYltoXSE9PWQmJihjPSEwKTtpZighdGhpcy5vcHRpb25zLmtlZXBPcmRpbmFsUGFkZGluZyYmKGJbMF0tZj5kfHxnLWJbYi5sZW5ndGgtMV0+ZCkpYz0hMH1jPyh0aGlzLm9yZGluYWxQb3NpdGlvbnM9YixkPXRoaXMudmFsMmxpbih2KGYsYlswXSksITApLGg9dih0aGlzLnZhbDJsaW4oRShnLGJbYi5sZW5ndGgtMV0pLCEwKSwxKSx0aGlzLm9yZGluYWxTbG9wZT1nPShnLWYpLyhoLWQpLHRoaXMub3JkaW5hbE9mZnNldD1mLWQqZyk6dGhpcy5vcmRpbmFsUG9zaXRpb25zPXRoaXMub3JkaW5hbFNsb3BlPXRoaXMub3JkaW5hbE9mZnNldD10fXRoaXMuaXNPcmRpbmFsPWUmJmM7dGhpcy5ncm91cEludGVydmFsRmFjdG9yPVxubnVsbH0sdmFsMmxpbjpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMub3JkaW5hbFBvc2l0aW9ucyxkO2lmKGMpe3ZhciBlPWMubGVuZ3RoLGY7Zm9yKGQ9ZTtkLS07KWlmKGNbZF09PT1hKXtmPWQ7YnJlYWt9Zm9yKGQ9ZS0xO2QtLTspaWYoYT5jW2RdfHxkPT09MCl7Yz0oYS1jW2RdKS8oY1tkKzFdLWNbZF0pO2Y9ZCtjO2JyZWFrfWQ9Yj9mOnRoaXMub3JkaW5hbFNsb3BlKihmfHwwKSt0aGlzLm9yZGluYWxPZmZzZXR9ZWxzZSBkPWE7cmV0dXJuIGR9LGxpbjJ2YWw6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLm9yZGluYWxQb3NpdGlvbnM7aWYoYyl7dmFyIGQ9dGhpcy5vcmRpbmFsU2xvcGUsZT10aGlzLm9yZGluYWxPZmZzZXQsZj1jLmxlbmd0aC0xLGcsaDtpZihiKWE8MD9hPWNbMF06YT5mP2E9Y1tmXTooZj1WKGEpLGg9YS1mKTtlbHNlIGZvcig7Zi0tOylpZihnPWQqZitlLGE+PWcpe2Q9ZCooZisxKStlO2g9KGEtZykvKGQtZyk7YnJlYWt9Yz1oIT09dCYmY1tmXSE9PXQ/Y1tmXStcbihoP2gqKGNbZisxXS1jW2ZdKTowKTphfWVsc2UgYz1hO3JldHVybiBjfSxnZXRFeHRlbmRlZFBvc2l0aW9uczpmdW5jdGlvbigpe3ZhciBhPXRoaXMuY2hhcnQsYj10aGlzLnNlcmllc1swXS5jdXJyZW50RGF0YUdyb3VwaW5nLGM9dGhpcy5vcmRpbmFsSW5kZXgsZD1iP2IuY291bnQrYi51bml0TmFtZTpcInJhd1wiLGU9dGhpcy5nZXRFeHRyZW1lcygpLGYsZztpZighYyljPXRoaXMub3JkaW5hbEluZGV4PXt9O2lmKCFjW2RdKWY9e3NlcmllczpbXSxnZXRFeHRyZW1lczpmdW5jdGlvbigpe3JldHVybnttaW46ZS5kYXRhTWluLG1heDplLmRhdGFNYXh9fSxvcHRpb25zOntvcmRpbmFsOiEwfSx2YWwybGluOkkucHJvdG90eXBlLnZhbDJsaW59LG4odGhpcy5zZXJpZXMsZnVuY3Rpb24oYyl7Zz17eEF4aXM6Zix4RGF0YTpjLnhEYXRhLGNoYXJ0OmEsZGVzdHJveUdyb3VwZWREYXRhOnJhfTtnLm9wdGlvbnM9e2RhdGFHcm91cGluZzpiP3tlbmFibGVkOiEwLGZvcmNlZDohMCxhcHByb3hpbWF0aW9uOlwib3BlblwiLFxudW5pdHM6W1tiLnVuaXROYW1lLFtiLmNvdW50XV1dfTp7ZW5hYmxlZDohMX19O2MucHJvY2Vzc0RhdGEuYXBwbHkoZyk7Zi5zZXJpZXMucHVzaChnKX0pLHRoaXMuYmVmb3JlU2V0VGlja1Bvc2l0aW9ucy5hcHBseShmKSxjW2RdPWYub3JkaW5hbFBvc2l0aW9ucztyZXR1cm4gY1tkXX0sZ2V0R3JvdXBJbnRlcnZhbEZhY3RvcjpmdW5jdGlvbihhLGIsYyl7dmFyIGQsYz1jLnByb2Nlc3NlZFhEYXRhLGU9Yy5sZW5ndGgsZj1bXTtkPXRoaXMuZ3JvdXBJbnRlcnZhbEZhY3RvcjtpZighZCl7Zm9yKGQ9MDtkPGUtMTtkKyspZltkXT1jW2QrMV0tY1tkXTtmLnNvcnQoZnVuY3Rpb24oYSxiKXtyZXR1cm4gYS1ifSk7Zj1mW1YoZS8yKV07YT12KGEsY1swXSk7Yj1FKGIsY1tlLTFdKTt0aGlzLmdyb3VwSW50ZXJ2YWxGYWN0b3I9ZD1lKmYvKGItYSl9cmV0dXJuIGR9LHBvc3RQcm9jZXNzVGlja0ludGVydmFsOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMub3JkaW5hbFNsb3BlO3JldHVybiBiP3RoaXMub3B0aW9ucy5icmVha3M/XG50aGlzLmNsb3Nlc3RQb2ludFJhbmdlOmEvKGIvdGhpcy5jbG9zZXN0UG9pbnRSYW5nZSk6YX19KTtVKENhLnByb3RvdHlwZSxcInBhblwiLGZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy54QXhpc1swXSxkPWIuY2hhcnRYLGU9ITE7aWYoYy5vcHRpb25zLm9yZGluYWwmJmMuc2VyaWVzLmxlbmd0aCl7dmFyIGY9dGhpcy5tb3VzZURvd25YLGc9Yy5nZXRFeHRyZW1lcygpLGg9Zy5kYXRhTWF4LGk9Zy5taW4saj1nLm1heCxrPXRoaXMuaG92ZXJQb2ludHMsbD1jLmNsb3Nlc3RQb2ludFJhbmdlLGY9KGYtZCkvKGMudHJhbnNsYXRpb25TbG9wZSooYy5vcmRpbmFsU2xvcGV8fGwpKSxtPXtvcmRpbmFsUG9zaXRpb25zOmMuZ2V0RXh0ZW5kZWRQb3NpdGlvbnMoKX0sbD1jLmxpbjJ2YWwsbz1jLnZhbDJsaW4scDtpZihtLm9yZGluYWxQb3NpdGlvbnMpe2lmKFMoZik+MSlrJiZuKGssZnVuY3Rpb24oYSl7YS5zZXRTdGF0ZSgpfSksZjwwPyhrPW0scD1jLm9yZGluYWxQb3NpdGlvbnM/YzptKTooaz1cbmMub3JkaW5hbFBvc2l0aW9ucz9jOm0scD1tKSxtPXAub3JkaW5hbFBvc2l0aW9ucyxoPm1bbS5sZW5ndGgtMV0mJm0ucHVzaChoKSx0aGlzLmZpeGVkUmFuZ2U9ai1pLGY9Yy50b0ZpeGVkUmFuZ2UobnVsbCxudWxsLGwuYXBwbHkoayxbby5hcHBseShrLFtpLCEwXSkrZiwhMF0pLGwuYXBwbHkocCxbby5hcHBseShwLFtqLCEwXSkrZiwhMF0pKSxmLm1pbj49RShnLmRhdGFNaW4saSkmJmYubWF4PD12KGgsaikmJmMuc2V0RXh0cmVtZXMoZi5taW4sZi5tYXgsITAsITEse3RyaWdnZXI6XCJwYW5cIn0pLHRoaXMubW91c2VEb3duWD1kLEYodGhpcy5jb250YWluZXIse2N1cnNvcjpcIm1vdmVcIn0pfWVsc2UgZT0hMH1lbHNlIGU9ITA7ZSYmYS5hcHBseSh0aGlzLEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSl9KTtRLnByb3RvdHlwZS5nYXBwZWRQYXRoPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcHRpb25zLmdhcFNpemUsYj10aGlzLnBvaW50cy5zbGljZSgpLGM9Yi5sZW5ndGgtXG4xO2lmKGEmJmM+MClmb3IoO2MtLTspYltjKzFdLngtYltjXS54PnRoaXMuY2xvc2VzdFBvaW50UmFuZ2UqYSYmYi5zcGxpY2UoYysxLDAse2lzTnVsbDohMH0pO3JldHVybiB0aGlzLmdldEdyYXBoUGF0aChiKX07KGZ1bmN0aW9uKGEpe2Eoeil9KShmdW5jdGlvbihhKXtmdW5jdGlvbiBiKCl7cmV0dXJuIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKX1mdW5jdGlvbiBjKGEpe2EuYXBwbHkodGhpcyk7dGhpcy5kcmF3QnJlYWtzKHRoaXMueEF4aXMsW1wieFwiXSk7dGhpcy5kcmF3QnJlYWtzKHRoaXMueUF4aXMsZCh0aGlzLnBvaW50QXJyYXlNYXAsW1wieVwiXSkpfXZhciBkPWEucGljayxlPWEud3JhcCxmPWEuZWFjaCxnPWEuZXh0ZW5kLGg9YS5maXJlRXZlbnQsaT1hLkF4aXMsaj1hLlNlcmllcztnKGkucHJvdG90eXBlLHtpc0luQnJlYWs6ZnVuY3Rpb24oYSxiKXt2YXIgYz1hLnJlcGVhdHx8SW5maW5pdHksZD1hLmZyb20sZT1hLnRvLWEuZnJvbSxjPWI+PWQ/XG4oYi1kKSVjOmMtKGQtYiklYztyZXR1cm4gYS5pbmNsdXNpdmU/Yzw9ZTpjPGUmJmMhPT0wfSxpc0luQW55QnJlYWs6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLm9wdGlvbnMuYnJlYWtzLGU9YyYmYy5sZW5ndGgsZixnLGg7aWYoZSl7Zm9yKDtlLS07KXRoaXMuaXNJbkJyZWFrKGNbZV0sYSkmJihmPSEwLGd8fChnPWQoY1tlXS5zaG93UG9pbnRzLHRoaXMuaXNYQXhpcz8hMTohMCkpKTtoPWYmJmI/ZiYmIWc6Zn1yZXR1cm4gaH19KTtlKGkucHJvdG90eXBlLFwic2V0VGlja1Bvc2l0aW9uc1wiLGZ1bmN0aW9uKGEpe2EuYXBwbHkodGhpcyxBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSkpO2lmKHRoaXMub3B0aW9ucy5icmVha3Mpe3ZhciBiPXRoaXMudGlja1Bvc2l0aW9ucyxjPXRoaXMudGlja1Bvc2l0aW9ucy5pbmZvLGQ9W10sZTtmb3IoZT0wO2U8Yi5sZW5ndGg7ZSsrKXRoaXMuaXNJbkFueUJyZWFrKGJbZV0pfHxkLnB1c2goYltlXSk7dGhpcy50aWNrUG9zaXRpb25zPVxuZDt0aGlzLnRpY2tQb3NpdGlvbnMuaW5mbz1jfX0pO2UoaS5wcm90b3R5cGUsXCJpbml0XCIsZnVuY3Rpb24oYSxiLGMpe2lmKGMuYnJlYWtzJiZjLmJyZWFrcy5sZW5ndGgpYy5vcmRpbmFsPSExO2EuY2FsbCh0aGlzLGIsYyk7aWYodGhpcy5vcHRpb25zLmJyZWFrcyl7dmFyIGQ9dGhpcztkLmlzQnJva2VuPSEwO3RoaXMudmFsMmxpbj1mdW5jdGlvbihhKXt2YXIgYj1hLGMsZTtmb3IoZT0wO2U8ZC5icmVha0FycmF5Lmxlbmd0aDtlKyspaWYoYz1kLmJyZWFrQXJyYXlbZV0sYy50bzw9YSliLT1jLmxlbjtlbHNlIGlmKGMuZnJvbT49YSlicmVhaztlbHNlIGlmKGQuaXNJbkJyZWFrKGMsYSkpe2ItPWEtYy5mcm9tO2JyZWFrfXJldHVybiBifTt0aGlzLmxpbjJ2YWw9ZnVuY3Rpb24oYSl7dmFyIGIsYztmb3IoYz0wO2M8ZC5icmVha0FycmF5Lmxlbmd0aDtjKyspaWYoYj1kLmJyZWFrQXJyYXlbY10sYi5mcm9tPj1hKWJyZWFrO2Vsc2UgYi50bzxhP2ErPWIubGVuOmQuaXNJbkJyZWFrKGIsXG5hKSYmKGErPWIubGVuKTtyZXR1cm4gYX07dGhpcy5zZXRFeHRyZW1lcz1mdW5jdGlvbihhLGIsYyxkLGUpe2Zvcig7dGhpcy5pc0luQW55QnJlYWsoYSk7KWEtPXRoaXMuY2xvc2VzdFBvaW50UmFuZ2U7Zm9yKDt0aGlzLmlzSW5BbnlCcmVhayhiKTspYi09dGhpcy5jbG9zZXN0UG9pbnRSYW5nZTtpLnByb3RvdHlwZS5zZXRFeHRyZW1lcy5jYWxsKHRoaXMsYSxiLGMsZCxlKX07dGhpcy5zZXRBeGlzVHJhbnNsYXRpb249ZnVuY3Rpb24oYSl7aS5wcm90b3R5cGUuc2V0QXhpc1RyYW5zbGF0aW9uLmNhbGwodGhpcyxhKTt2YXIgYj1kLm9wdGlvbnMuYnJlYWtzLGE9W10sYz1bXSxlPTAsZixnLGs9ZC51c2VyTWlufHxkLm1pbixqPWQudXNlck1heHx8ZC5tYXgsbCxtO2ZvcihtIGluIGIpZz1iW21dLGY9Zy5yZXBlYXR8fEluZmluaXR5LGQuaXNJbkJyZWFrKGcsaykmJihrKz1nLnRvJWYtayVmKSxkLmlzSW5CcmVhayhnLGopJiYoai09aiVmLWcuZnJvbSVmKTtmb3IobSBpbiBiKXtnPWJbbV07XG5sPWcuZnJvbTtmb3IoZj1nLnJlcGVhdHx8SW5maW5pdHk7bC1mPms7KWwtPWY7Zm9yKDtsPGs7KWwrPWY7Zm9yKDtsPGo7bCs9ZilhLnB1c2goe3ZhbHVlOmwsbW92ZTpcImluXCJ9KSxhLnB1c2goe3ZhbHVlOmwrKGcudG8tZy5mcm9tKSxtb3ZlOlwib3V0XCIsc2l6ZTpnLmJyZWFrU2l6ZX0pfWEuc29ydChmdW5jdGlvbihhLGIpe3JldHVybiBhLnZhbHVlPT09Yi52YWx1ZT8oYS5tb3ZlPT09XCJpblwiPzA6MSktKGIubW92ZT09PVwiaW5cIj8wOjEpOmEudmFsdWUtYi52YWx1ZX0pO2I9MDtsPWs7Zm9yKG0gaW4gYSl7Zz1hW21dO2IrPWcubW92ZT09PVwiaW5cIj8xOi0xO2lmKGI9PT0xJiZnLm1vdmU9PT1cImluXCIpbD1nLnZhbHVlO2I9PT0wJiYoYy5wdXNoKHtmcm9tOmwsdG86Zy52YWx1ZSxsZW46Zy52YWx1ZS1sLShnLnNpemV8fDApfSksZSs9Zy52YWx1ZS1sLShnLnNpemV8fDApKX1kLmJyZWFrQXJyYXk9YztoKGQsXCJhZnRlckJyZWFrc1wiKTtkLnRyYW5zQSo9KGotZC5taW4pLyhqLWstZSk7ZC5taW49XG5rO2QubWF4PWp9fX0pO2Uoai5wcm90b3R5cGUsXCJnZW5lcmF0ZVBvaW50c1wiLGZ1bmN0aW9uKGEpe2EuYXBwbHkodGhpcyxiKGFyZ3VtZW50cykpO3ZhciBjPXRoaXMueEF4aXMsZD10aGlzLnlBeGlzLGU9dGhpcy5wb2ludHMsZixnPWUubGVuZ3RoLGg9dGhpcy5vcHRpb25zLmNvbm5lY3ROdWxscyxpO2lmKGMmJmQmJihjLm9wdGlvbnMuYnJlYWtzfHxkLm9wdGlvbnMuYnJlYWtzKSlmb3IoO2ctLTspaWYoZj1lW2ddLGk9Zi55PT09bnVsbCYmaD09PSExLCFpJiYoYy5pc0luQW55QnJlYWsoZi54LCEwKXx8ZC5pc0luQW55QnJlYWsoZi55LCEwKSkpZS5zcGxpY2UoZywxKSx0aGlzLmRhdGFbZ10mJnRoaXMuZGF0YVtnXS5kZXN0cm95RWxlbWVudHMoKX0pO2EuU2VyaWVzLnByb3RvdHlwZS5kcmF3QnJlYWtzPWZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcyxlPWMucG9pbnRzLGcsaSxqLG47ZihiLGZ1bmN0aW9uKGIpe2c9YS5icmVha0FycmF5fHxbXTtpPWEuaXNYQXhpcz9hLm1pbjpkKGMub3B0aW9ucy50aHJlc2hvbGQsXG5hLm1pbik7ZihlLGZ1bmN0aW9uKGMpe249ZChjW1wic3RhY2tcIitiLnRvVXBwZXJDYXNlKCldLGNbYl0pO2YoZyxmdW5jdGlvbihiKXtqPSExO2lmKGk8Yi5mcm9tJiZuPmIudG98fGk+Yi5mcm9tJiZuPGIuZnJvbSlqPVwicG9pbnRCcmVha1wiO2Vsc2UgaWYoaTxiLmZyb20mJm4+Yi5mcm9tJiZuPGIudG98fGk+Yi5mcm9tJiZuPmIudG8mJm48Yi5mcm9tKWo9XCJwb2ludEluQnJlYWtcIjtqJiZoKGEsaix7cG9pbnQ6Yyxicms6Yn0pfSl9KX0pfTtlKGEuc2VyaWVzVHlwZXMuY29sdW1uLnByb3RvdHlwZSxcImRyYXdQb2ludHNcIixjKTtlKGEuU2VyaWVzLnByb3RvdHlwZSxcImRyYXdQb2ludHNcIixjKX0pO3ZhciBpYT1RLnByb3RvdHlwZSxjYz1pYS5wcm9jZXNzRGF0YSxkYz1pYS5nZW5lcmF0ZVBvaW50cyxlYz1pYS5kZXN0cm95LGZjPXthcHByb3hpbWF0aW9uOlwiYXZlcmFnZVwiLGdyb3VwUGl4ZWxXaWR0aDoyLGRhdGVUaW1lTGFiZWxGb3JtYXRzOnttaWxsaXNlY29uZDpbXCIlQSwgJWIgJWUsICVIOiVNOiVTLiVMXCIsXG5cIiVBLCAlYiAlZSwgJUg6JU06JVMuJUxcIixcIi0lSDolTTolUy4lTFwiXSxzZWNvbmQ6W1wiJUEsICViICVlLCAlSDolTTolU1wiLFwiJUEsICViICVlLCAlSDolTTolU1wiLFwiLSVIOiVNOiVTXCJdLG1pbnV0ZTpbXCIlQSwgJWIgJWUsICVIOiVNXCIsXCIlQSwgJWIgJWUsICVIOiVNXCIsXCItJUg6JU1cIl0saG91cjpbXCIlQSwgJWIgJWUsICVIOiVNXCIsXCIlQSwgJWIgJWUsICVIOiVNXCIsXCItJUg6JU1cIl0sZGF5OltcIiVBLCAlYiAlZSwgJVlcIixcIiVBLCAlYiAlZVwiLFwiLSVBLCAlYiAlZSwgJVlcIl0sd2VlazpbXCJXZWVrIGZyb20gJUEsICViICVlLCAlWVwiLFwiJUEsICViICVlXCIsXCItJUEsICViICVlLCAlWVwiXSxtb250aDpbXCIlQiAlWVwiLFwiJUJcIixcIi0lQiAlWVwiXSx5ZWFyOltcIiVZXCIsXCIlWVwiLFwiLSVZXCJdfX0sWGI9e2xpbmU6e30sc3BsaW5lOnt9LGFyZWE6e30sYXJlYXNwbGluZTp7fSxjb2x1bW46e2FwcHJveGltYXRpb246XCJzdW1cIixncm91cFBpeGVsV2lkdGg6MTB9LGFyZWFyYW5nZTp7YXBwcm94aW1hdGlvbjpcInJhbmdlXCJ9LFxuYXJlYXNwbGluZXJhbmdlOnthcHByb3hpbWF0aW9uOlwicmFuZ2VcIn0sY29sdW1ucmFuZ2U6e2FwcHJveGltYXRpb246XCJyYW5nZVwiLGdyb3VwUGl4ZWxXaWR0aDoxMH0sY2FuZGxlc3RpY2s6e2FwcHJveGltYXRpb246XCJvaGxjXCIsZ3JvdXBQaXhlbFdpZHRoOjEwfSxvaGxjOnthcHByb3hpbWF0aW9uOlwib2hsY1wiLGdyb3VwUGl4ZWxXaWR0aDo1fX0sWWI9W1tcIm1pbGxpc2Vjb25kXCIsWzEsMiw1LDEwLDIwLDI1LDUwLDEwMCwyMDAsNTAwXV0sW1wic2Vjb25kXCIsWzEsMiw1LDEwLDE1LDMwXV0sW1wibWludXRlXCIsWzEsMiw1LDEwLDE1LDMwXV0sW1wiaG91clwiLFsxLDIsMyw0LDYsOCwxMl1dLFtcImRheVwiLFsxXV0sW1wid2Vla1wiLFsxXV0sW1wibW9udGhcIixbMSwzLDZdXSxbXCJ5ZWFyXCIsbnVsbF1dLFVhPXtzdW06ZnVuY3Rpb24oYSl7dmFyIGI9YS5sZW5ndGgsYztpZighYiYmYS5oYXNOdWxscyljPW51bGw7ZWxzZSBpZihiKWZvcihjPTA7Yi0tOyljKz1hW2JdO3JldHVybiBjfSxhdmVyYWdlOmZ1bmN0aW9uKGEpe3ZhciBiPVxuYS5sZW5ndGgsYT1VYS5zdW0oYSk7dHlwZW9mIGE9PT1cIm51bWJlclwiJiZiJiYoYS89Yik7cmV0dXJuIGF9LG9wZW46ZnVuY3Rpb24oYSl7cmV0dXJuIGEubGVuZ3RoP2FbMF06YS5oYXNOdWxscz9udWxsOnR9LGhpZ2g6ZnVuY3Rpb24oYSl7cmV0dXJuIGEubGVuZ3RoP0VhKGEpOmEuaGFzTnVsbHM/bnVsbDp0fSxsb3c6ZnVuY3Rpb24oYSl7cmV0dXJuIGEubGVuZ3RoP09hKGEpOmEuaGFzTnVsbHM/bnVsbDp0fSxjbG9zZTpmdW5jdGlvbihhKXtyZXR1cm4gYS5sZW5ndGg/YVthLmxlbmd0aC0xXTphLmhhc051bGxzP251bGw6dH0sb2hsYzpmdW5jdGlvbihhLGIsYyxkKXthPVVhLm9wZW4oYSk7Yj1VYS5oaWdoKGIpO2M9VWEubG93KGMpO2Q9VWEuY2xvc2UoZCk7aWYodHlwZW9mIGE9PT1cIm51bWJlclwifHx0eXBlb2YgYj09PVwibnVtYmVyXCJ8fHR5cGVvZiBjPT09XCJudW1iZXJcInx8dHlwZW9mIGQ9PT1cIm51bWJlclwiKXJldHVyblthLGIsYyxkXX0scmFuZ2U6ZnVuY3Rpb24oYSxiKXthPVxuVWEubG93KGEpO2I9VWEuaGlnaChiKTtpZih0eXBlb2YgYT09PVwibnVtYmVyXCJ8fHR5cGVvZiBiPT09XCJudW1iZXJcIilyZXR1cm5bYSxiXX19O2lhLmdyb3VwRGF0YT1mdW5jdGlvbihhLGIsYyxkKXt2YXIgZT10aGlzLmRhdGEsZj10aGlzLm9wdGlvbnMuZGF0YSxnPVtdLGg9W10saT1bXSxqPWEubGVuZ3RoLGssbCxtPSEhYixvPVtbXSxbXSxbXSxbXV0sZD10eXBlb2YgZD09PVwiZnVuY3Rpb25cIj9kOlVhW2RdLHA9dGhpcy5wb2ludEFycmF5TWFwLG49cCYmcC5sZW5ndGgscSxzPTA7Zm9yKHE9MDtxPD1qO3ErKylpZihhW3FdPj1jWzBdKWJyZWFrO2Zvcig7cTw9ajtxKyspe2Zvcig7Y1sxXSE9PXQmJmFbcV0+PWNbMV18fHE9PT1qOylpZihrPWMuc2hpZnQoKSxsPWQuYXBwbHkoMCxvKSxsIT09dCYmKGcucHVzaChrKSxoLnB1c2gobCksaS5wdXNoKHtzdGFydDpzLGxlbmd0aDpvWzBdLmxlbmd0aH0pKSxzPXEsb1swXT1bXSxvWzFdPVtdLG9bMl09W10sb1szXT1bXSxxPT09ailicmVhaztcbmlmKHE9PT1qKWJyZWFrO2lmKHApe2s9dGhpcy5jcm9wU3RhcnQrcTtrPWUmJmVba118fHRoaXMucG9pbnRDbGFzcy5wcm90b3R5cGUuYXBwbHlPcHRpb25zLmFwcGx5KHtzZXJpZXM6dGhpc30sW2Zba11dKTt2YXIgdTtmb3IobD0wO2w8bjtsKyspaWYodT1rW3BbbF1dLHR5cGVvZiB1PT09XCJudW1iZXJcIilvW2xdLnB1c2godSk7ZWxzZSBpZih1PT09bnVsbClvW2xdLmhhc051bGxzPSEwfWVsc2UgaWYoaz1tP2JbcV06bnVsbCx0eXBlb2Ygaz09PVwibnVtYmVyXCIpb1swXS5wdXNoKGspO2Vsc2UgaWYoaz09PW51bGwpb1swXS5oYXNOdWxscz0hMH1yZXR1cm5bZyxoLGldfTtpYS5wcm9jZXNzRGF0YT1mdW5jdGlvbigpe3ZhciBhPXRoaXMuY2hhcnQsYj10aGlzLm9wdGlvbnMuZGF0YUdyb3VwaW5nLGM9dGhpcy5hbGxvd0RHIT09ITEmJmImJnEoYi5lbmFibGVkLGEub3B0aW9ucy5fc3RvY2spLGQ7dGhpcy5mb3JjZUNyb3A9Yzt0aGlzLmdyb3VwUGl4ZWxXaWR0aD1udWxsO3RoaXMuaGFzUHJvY2Vzc2VkPVxuITA7aWYoY2MuYXBwbHkodGhpcyxhcmd1bWVudHMpIT09ITEmJmMpe3RoaXMuZGVzdHJveUdyb3VwZWREYXRhKCk7dmFyIGU9dGhpcy5wcm9jZXNzZWRYRGF0YSxmPXRoaXMucHJvY2Vzc2VkWURhdGEsZz1hLnBsb3RTaXplWCxhPXRoaXMueEF4aXMsaD1hLm9wdGlvbnMub3JkaW5hbCxpPXRoaXMuZ3JvdXBQaXhlbFdpZHRoPWEuZ2V0R3JvdXBQaXhlbFdpZHRoJiZhLmdldEdyb3VwUGl4ZWxXaWR0aCgpO2lmKGkpe2Q9ITA7dGhpcy5wb2ludHM9bnVsbDt2YXIgaj1hLmdldEV4dHJlbWVzKCksYz1qLm1pbixqPWoubWF4LGg9aCYmYS5nZXRHcm91cEludGVydmFsRmFjdG9yKGMsaix0aGlzKXx8MSxnPWkqKGotYykvZypoLGk9YS5nZXRUaW1lVGlja3MoYS5ub3JtYWxpemVUaW1lVGlja0ludGVydmFsKGcsYi51bml0c3x8WWIpLE1hdGgubWluKGMsZVswXSksTWF0aC5tYXgoaixlW2UubGVuZ3RoLTFdKSxhLm9wdGlvbnMuc3RhcnRPZldlZWssZSx0aGlzLmNsb3Nlc3RQb2ludFJhbmdlKSxcbmU9aWEuZ3JvdXBEYXRhLmFwcGx5KHRoaXMsW2UsZixpLGIuYXBwcm94aW1hdGlvbl0pLGY9ZVswXSxoPWVbMV07aWYoYi5zbW9vdGhlZCl7Yj1mLmxlbmd0aC0xO2ZvcihmW2JdPU1hdGgubWluKGZbYl0saik7Yi0tJiZiPjA7KWZbYl0rPWcvMjtmWzBdPU1hdGgubWF4KGZbMF0sYyl9dGhpcy5jdXJyZW50RGF0YUdyb3VwaW5nPWkuaW5mbzt0aGlzLmNsb3Nlc3RQb2ludFJhbmdlPWkuaW5mby50b3RhbFJhbmdlO3RoaXMuZ3JvdXBNYXA9ZVsyXTtpZihzKGZbMF0pJiZmWzBdPGEuZGF0YU1pbil7aWYoYS5taW49PT1hLmRhdGFNaW4pYS5taW49ZlswXTthLmRhdGFNaW49ZlswXX10aGlzLnByb2Nlc3NlZFhEYXRhPWY7dGhpcy5wcm9jZXNzZWRZRGF0YT1ofWVsc2UgdGhpcy5jdXJyZW50RGF0YUdyb3VwaW5nPXRoaXMuZ3JvdXBNYXA9bnVsbDt0aGlzLmhhc0dyb3VwZWREYXRhPWR9fTtpYS5kZXN0cm95R3JvdXBlZERhdGE9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmdyb3VwZWREYXRhO1xubihhfHxbXSxmdW5jdGlvbihiLGMpe2ImJihhW2NdPWIuZGVzdHJveT9iLmRlc3Ryb3koKTpudWxsKX0pO3RoaXMuZ3JvdXBlZERhdGE9bnVsbH07aWEuZ2VuZXJhdGVQb2ludHM9ZnVuY3Rpb24oKXtkYy5hcHBseSh0aGlzKTt0aGlzLmRlc3Ryb3lHcm91cGVkRGF0YSgpO3RoaXMuZ3JvdXBlZERhdGE9dGhpcy5oYXNHcm91cGVkRGF0YT90aGlzLnBvaW50czpudWxsfTtVKExiLnByb3RvdHlwZSxcInRvb2x0aXBGb290ZXJIZWFkZXJGb3JtYXR0ZXJcIixmdW5jdGlvbihhLGIsYyl7dmFyIGQ9Yi5zZXJpZXMsZT1kLnRvb2x0aXBPcHRpb25zLGY9ZC5vcHRpb25zLmRhdGFHcm91cGluZyxnPWUueERhdGVGb3JtYXQsaCxpPWQueEF4aXM7cmV0dXJuIGkmJmkub3B0aW9ucy50eXBlPT09XCJkYXRldGltZVwiJiZmJiZ1YShiLmtleSk/KGE9ZC5jdXJyZW50RGF0YUdyb3VwaW5nLGY9Zi5kYXRlVGltZUxhYmVsRm9ybWF0cyxhPyhpPWZbYS51bml0TmFtZV0sYS5jb3VudD09PTE/Zz1pWzBdOihnPVxuaVsxXSxoPWlbMl0pKTohZyYmZiYmKGc9dGhpcy5nZXRYRGF0ZUZvcm1hdChiLGUsaSkpLGc9bWEoZyxiLmtleSksaCYmKGcrPW1hKGgsYi5rZXkrYS50b3RhbFJhbmdlLTEpKSxMYShlWyhjP1wiZm9vdGVyXCI6XCJoZWFkZXJcIikrXCJGb3JtYXRcIl0se3BvaW50OngoYix7a2V5Omd9KSxzZXJpZXM6ZH0pKTphLmNhbGwodGhpcyxiLGMpfSk7aWEuZGVzdHJveT1mdW5jdGlvbigpe2Zvcih2YXIgYT10aGlzLmdyb3VwZWREYXRhfHxbXSxiPWEubGVuZ3RoO2ItLTspYVtiXSYmYVtiXS5kZXN0cm95KCk7ZWMuYXBwbHkodGhpcyl9O1UoaWEsXCJzZXRPcHRpb25zXCIsZnVuY3Rpb24oYSxiKXt2YXIgYz1hLmNhbGwodGhpcyxiKSxkPXRoaXMudHlwZSxlPXRoaXMuY2hhcnQub3B0aW9ucy5wbG90T3B0aW9ucyxmPVdbZF0uZGF0YUdyb3VwaW5nO2lmKFhiW2RdKWZ8fChmPUMoZmMsWGJbZF0pKSxjLmRhdGFHcm91cGluZz1DKGYsZS5zZXJpZXMmJmUuc2VyaWVzLmRhdGFHcm91cGluZyxlW2RdLmRhdGFHcm91cGluZyxcbmIuZGF0YUdyb3VwaW5nKTtpZih0aGlzLmNoYXJ0Lm9wdGlvbnMuX3N0b2NrKXRoaXMucmVxdWlyZVNvcnRpbmc9ITA7cmV0dXJuIGN9KTtVKEkucHJvdG90eXBlLFwic2V0U2NhbGVcIixmdW5jdGlvbihhKXthLmNhbGwodGhpcyk7bih0aGlzLnNlcmllcyxmdW5jdGlvbihhKXthLmhhc1Byb2Nlc3NlZD0hMX0pfSk7SS5wcm90b3R5cGUuZ2V0R3JvdXBQaXhlbFdpZHRoPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5zZXJpZXMsYj1hLmxlbmd0aCxjLGQ9MCxlPSExLGY7Zm9yKGM9YjtjLS07KShmPWFbY10ub3B0aW9ucy5kYXRhR3JvdXBpbmcpJiYoZD12KGQsZi5ncm91cFBpeGVsV2lkdGgpKTtmb3IoYz1iO2MtLTspaWYoKGY9YVtjXS5vcHRpb25zLmRhdGFHcm91cGluZykmJmFbY10uaGFzUHJvY2Vzc2VkKWlmKGI9KGFbY10ucHJvY2Vzc2VkWERhdGF8fGFbY10uZGF0YSkubGVuZ3RoLGFbY10uZ3JvdXBQaXhlbFdpZHRofHxiPnRoaXMuY2hhcnQucGxvdFNpemVYL2R8fGImJmYuZm9yY2VkKWU9XG4hMDtyZXR1cm4gZT9kOjB9O0kucHJvdG90eXBlLnNldERhdGFHcm91cGluZz1mdW5jdGlvbihhLGIpe3ZhciBjLGI9cShiLCEwKTthfHwoYT17Zm9yY2VkOiExLHVuaXRzOm51bGx9KTtpZih0aGlzIGluc3RhbmNlb2YgSSlmb3IoYz10aGlzLnNlcmllcy5sZW5ndGg7Yy0tOyl0aGlzLnNlcmllc1tjXS51cGRhdGUoe2RhdGFHcm91cGluZzphfSwhMSk7ZWxzZSBuKHRoaXMuY2hhcnQub3B0aW9ucy5zZXJpZXMsZnVuY3Rpb24oYil7Yi5kYXRhR3JvdXBpbmc9YX0sITEpO2ImJnRoaXMuY2hhcnQucmVkcmF3KCl9O1cub2hsYz1DKFcuY29sdW1uLHtsaW5lV2lkdGg6MSx0b29sdGlwOntwb2ludEZvcm1hdDonPHNwYW4gc3R5bGU9XCJjb2xvcjp7cG9pbnQuY29sb3J9XCI+XFx1MjVjZjwvc3Bhbj4gPGI+IHtzZXJpZXMubmFtZX08L2I+PGJyLz5PcGVuOiB7cG9pbnQub3Blbn08YnIvPkhpZ2g6IHtwb2ludC5oaWdofTxici8+TG93OiB7cG9pbnQubG93fTxici8+Q2xvc2U6IHtwb2ludC5jbG9zZX08YnIvPid9LFxuc3RhdGVzOntob3Zlcjp7bGluZVdpZHRoOjN9fSx0aHJlc2hvbGQ6bnVsbH0pO2NhPWxhKEsuY29sdW1uLHt0eXBlOlwib2hsY1wiLHBvaW50QXJyYXlNYXA6W1wib3BlblwiLFwiaGlnaFwiLFwibG93XCIsXCJjbG9zZVwiXSx0b1lEYXRhOmZ1bmN0aW9uKGEpe3JldHVyblthLm9wZW4sYS5oaWdoLGEubG93LGEuY2xvc2VdfSxwb2ludFZhbEtleTpcImhpZ2hcIixwb2ludEF0dHJUb09wdGlvbnM6e3N0cm9rZTpcImNvbG9yXCIsXCJzdHJva2Utd2lkdGhcIjpcImxpbmVXaWR0aFwifSx1cENvbG9yUHJvcDpcInN0cm9rZVwiLGdldEF0dHJpYnM6ZnVuY3Rpb24oKXtLLmNvbHVtbi5wcm90b3R5cGUuZ2V0QXR0cmlicy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dmFyIGE9dGhpcy5vcHRpb25zLGI9YS5zdGF0ZXMsYT1hLnVwQ29sb3J8fHRoaXMuY29sb3IsYz1DKHRoaXMucG9pbnRBdHRyKSxkPXRoaXMudXBDb2xvclByb3A7Y1tcIlwiXVtkXT1hO2MuaG92ZXJbZF09Yi5ob3Zlci51cENvbG9yfHxhO2Muc2VsZWN0W2RdPWIuc2VsZWN0LnVwQ29sb3J8fFxuYTtuKHRoaXMucG9pbnRzLGZ1bmN0aW9uKGEpe2lmKGEub3BlbjxhLmNsb3NlJiYhYS5vcHRpb25zLmNvbG9yKWEucG9pbnRBdHRyPWN9KX0sdHJhbnNsYXRlOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy55QXhpcztLLmNvbHVtbi5wcm90b3R5cGUudHJhbnNsYXRlLmFwcGx5KHRoaXMpO24odGhpcy5wb2ludHMsZnVuY3Rpb24oYil7aWYoYi5vcGVuIT09bnVsbCliLnBsb3RPcGVuPWEudHJhbnNsYXRlKGIub3BlbiwwLDEsMCwxKTtpZihiLmNsb3NlIT09bnVsbCliLnBsb3RDbG9zZT1hLnRyYW5zbGF0ZShiLmNsb3NlLDAsMSwwLDEpfSl9LGRyYXdQb2ludHM6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5jaGFydCxjLGQsZSxmLGcsaCxpLGo7bihhLnBvaW50cyxmdW5jdGlvbihrKXtpZihrLnBsb3RZIT09dClpPWsuZ3JhcGhpYyxjPWsucG9pbnRBdHRyW2suc2VsZWN0ZWQ/XCJzZWxlY3RlZFwiOlwiXCJdfHxhLnBvaW50QXR0cltcIlwiXSxmPWNbXCJzdHJva2Utd2lkdGhcIl0lMi8yLGo9eShrLnBsb3RYKS1cbmYsZz15KGsuc2hhcGVBcmdzLndpZHRoLzIpLGg9W1wiTVwiLGoseShrLnlCb3R0b20pLFwiTFwiLGoseShrLnBsb3RZKV0say5vcGVuIT09bnVsbCYmKGQ9eShrLnBsb3RPcGVuKStmLGgucHVzaChcIk1cIixqLGQsXCJMXCIsai1nLGQpKSxrLmNsb3NlIT09bnVsbCYmKGU9eShrLnBsb3RDbG9zZSkrZixoLnB1c2goXCJNXCIsaixlLFwiTFwiLGorZyxlKSksaT9pLmF0dHIoYykuYW5pbWF0ZSh7ZDpofSk6ay5ncmFwaGljPWIucmVuZGVyZXIucGF0aChoKS5hdHRyKGMpLmFkZChhLmdyb3VwKX0pfSxhbmltYXRlOm51bGx9KTtLLm9obGM9Y2E7Vy5jYW5kbGVzdGljaz1DKFcuY29sdW1uLHtsaW5lQ29sb3I6XCJibGFja1wiLGxpbmVXaWR0aDoxLHN0YXRlczp7aG92ZXI6e2xpbmVXaWR0aDoyfX0sdG9vbHRpcDpXLm9obGMudG9vbHRpcCx0aHJlc2hvbGQ6bnVsbCx1cENvbG9yOlwid2hpdGVcIn0pO2NhPWxhKGNhLHt0eXBlOlwiY2FuZGxlc3RpY2tcIixwb2ludEF0dHJUb09wdGlvbnM6e2ZpbGw6XCJjb2xvclwiLHN0cm9rZTpcImxpbmVDb2xvclwiLFxuXCJzdHJva2Utd2lkdGhcIjpcImxpbmVXaWR0aFwifSx1cENvbG9yUHJvcDpcImZpbGxcIixnZXRBdHRyaWJzOmZ1bmN0aW9uKCl7Sy5vaGxjLnByb3RvdHlwZS5nZXRBdHRyaWJzLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt2YXIgYT10aGlzLm9wdGlvbnMsYj1hLnN0YXRlcyxjPWEudXBMaW5lQ29sb3J8fGEubGluZUNvbG9yLGQ9Yi5ob3Zlci51cExpbmVDb2xvcnx8YyxlPWIuc2VsZWN0LnVwTGluZUNvbG9yfHxjO24odGhpcy5wb2ludHMsZnVuY3Rpb24oYSl7aWYoYS5vcGVuPGEuY2xvc2Upe2lmKGEubGluZUNvbG9yKWEucG9pbnRBdHRyPUMoYS5wb2ludEF0dHIpLGM9YS5saW5lQ29sb3I7YS5wb2ludEF0dHJbXCJcIl0uc3Ryb2tlPWM7YS5wb2ludEF0dHIuaG92ZXIuc3Ryb2tlPWQ7YS5wb2ludEF0dHIuc2VsZWN0LnN0cm9rZT1lfX0pfSxkcmF3UG9pbnRzOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEuY2hhcnQsYyxkPWEucG9pbnRBdHRyW1wiXCJdLGUsZixnLGgsaSxqLGssbCxtLG8scDtuKGEucG9pbnRzLFxuZnVuY3Rpb24obil7bT1uLmdyYXBoaWM7aWYobi5wbG90WSE9PXQpYz1uLnBvaW50QXR0cltuLnNlbGVjdGVkP1wic2VsZWN0ZWRcIjpcIlwiXXx8ZCxrPWNbXCJzdHJva2Utd2lkdGhcIl0lMi8yLGw9eShuLnBsb3RYKS1rLGU9bi5wbG90T3BlbixmPW4ucGxvdENsb3NlLGc9WS5taW4oZSxmKSxoPVkubWF4KGUsZikscD15KG4uc2hhcGVBcmdzLndpZHRoLzIpLGk9eShnKSE9PXkobi5wbG90WSksaj1oIT09bi55Qm90dG9tLGc9eShnKStrLGg9eShoKStrLG89W1wiTVwiLGwtcCxoLFwiTFwiLGwtcCxnLFwiTFwiLGwrcCxnLFwiTFwiLGwrcCxoLFwiWlwiLFwiTVwiLGwsZyxcIkxcIixsLGk/eShuLnBsb3RZKTpnLFwiTVwiLGwsaCxcIkxcIixsLGo/eShuLnlCb3R0b20pOmhdLG0/bS5hdHRyKGMpLmFuaW1hdGUoe2Q6b30pOm4uZ3JhcGhpYz1iLnJlbmRlcmVyLnBhdGgobykuYXR0cihjKS5hZGQoYS5ncm91cCkuc2hhZG93KGEub3B0aW9ucy5zaGFkb3cpfSl9fSk7Sy5jYW5kbGVzdGljaz1jYTt2YXIgd2I9eWEucHJvdG90eXBlLnN5bWJvbHM7XG5XLmZsYWdzPUMoVy5jb2x1bW4se2ZpbGxDb2xvcjpcIndoaXRlXCIsbGluZVdpZHRoOjEscG9pbnRSYW5nZTowLHNoYXBlOlwiZmxhZ1wiLHN0YWNrRGlzdGFuY2U6MTIsc3RhdGVzOntob3Zlcjp7bGluZUNvbG9yOlwiYmxhY2tcIixmaWxsQ29sb3I6XCIjRkNGRkM1XCJ9fSxzdHlsZTp7Zm9udFNpemU6XCIxMXB4XCIsZm9udFdlaWdodDpcImJvbGRcIix0ZXh0QWxpZ246XCJjZW50ZXJcIn0sdG9vbHRpcDp7cG9pbnRGb3JtYXQ6XCJ7cG9pbnQudGV4dH08YnIvPlwifSx0aHJlc2hvbGQ6bnVsbCx5Oi0zMH0pO0suZmxhZ3M9bGEoSy5jb2x1bW4se3R5cGU6XCJmbGFnc1wiLHNvcnRlZDohMSxub1NoYXJlZFRvb2x0aXA6ITAsYWxsb3dERzohMSx0YWtlT3JkaW5hbFBvc2l0aW9uOiExLHRyYWNrZXJHcm91cHM6W1wibWFya2VyR3JvdXBcIl0sZm9yY2VDcm9wOiEwLGluaXQ6US5wcm90b3R5cGUuaW5pdCxwb2ludEF0dHJUb09wdGlvbnM6e2ZpbGw6XCJmaWxsQ29sb3JcIixzdHJva2U6XCJjb2xvclwiLFwic3Ryb2tlLXdpZHRoXCI6XCJsaW5lV2lkdGhcIixcbnI6XCJyYWRpdXNcIn0sdHJhbnNsYXRlOmZ1bmN0aW9uKCl7Sy5jb2x1bW4ucHJvdG90eXBlLnRyYW5zbGF0ZS5hcHBseSh0aGlzKTt2YXIgYT10aGlzLm9wdGlvbnMsYj10aGlzLmNoYXJ0LGM9dGhpcy5wb2ludHMsZD1jLmxlbmd0aC0xLGUsZixnPWEub25TZXJpZXM7ZT1nJiZiLmdldChnKTt2YXIgYT1hLm9uS2V5fHxcInlcIixnPWUmJmUub3B0aW9ucy5zdGVwLGg9ZSYmZS5wb2ludHMsaT1oJiZoLmxlbmd0aCxqPXRoaXMueEF4aXMsaz1qLmdldEV4dHJlbWVzKCksbCxtLG87aWYoZSYmZS52aXNpYmxlJiZpKXtlPWUuY3VycmVudERhdGFHcm91cGluZzttPWhbaS0xXS54KyhlP2UudG90YWxSYW5nZTowKTtjLnNvcnQoZnVuY3Rpb24oYSxiKXtyZXR1cm4gYS54LWIueH0pO2ZvcihhPVwicGxvdFwiK2FbMF0udG9VcHBlckNhc2UoKSthLnN1YnN0cigxKTtpLS0mJmNbZF07KWlmKGU9Y1tkXSxsPWhbaV0sbC54PD1lLngmJmxbYV0hPT12b2lkIDApe2lmKGUueDw9bSllLnBsb3RZPWxbYV0sbC54PFxuZS54JiYhZyYmKG89aFtpKzFdKSYmb1thXSE9PXQmJihlLnBsb3RZKz0oZS54LWwueCkvKG8ueC1sLngpKihvW2FdLWxbYV0pKTtkLS07aSsrO2lmKGQ8MClicmVha319bihjLGZ1bmN0aW9uKGEsZCl7dmFyIGU7aWYoYS5wbG90WT09PXQpYS54Pj1rLm1pbiYmYS54PD1rLm1heD9hLnBsb3RZPWIuY2hhcnRIZWlnaHQtai5ib3R0b20tKGoub3Bwb3NpdGU/ai5oZWlnaHQ6MCkrai5vZmZzZXQtYi5wbG90VG9wOmEuc2hhcGVBcmdzPXt9O2lmKChmPWNbZC0xXSkmJmYucGxvdFg9PT1hLnBsb3RYKXtpZihmLnN0YWNrSW5kZXg9PT10KWYuc3RhY2tJbmRleD0wO2U9Zi5zdGFja0luZGV4KzF9YS5zdGFja0luZGV4PWV9KX0sZHJhd1BvaW50czpmdW5jdGlvbigpe3ZhciBhLGI9dGhpcy5wb2ludEF0dHJbXCJcIl0sYz10aGlzLnBvaW50cyxkPXRoaXMuY2hhcnQsZT1kLnJlbmRlcmVyLGYsZyxoPXRoaXMub3B0aW9ucyxpPWgueSxqLGssbCxtLG8sbixyPXRoaXMueUF4aXM7Zm9yKGs9Yy5sZW5ndGg7ay0tOylpZihsPVxuY1trXSxhPWwucGxvdFg+dGhpcy54QXhpcy5sZW4sZj1sLnBsb3RYLGY+MCYmKGYtPXEobC5saW5lV2lkdGgsaC5saW5lV2lkdGgpJTIpLG09bC5zdGFja0luZGV4LGo9bC5vcHRpb25zLnNoYXBlfHxoLnNoYXBlLGc9bC5wbG90WSxnIT09dCYmKGc9bC5wbG90WStpLShtIT09dCYmbSpoLnN0YWNrRGlzdGFuY2UpKSxvPW0/dDpsLnBsb3RYLG49bT90OmwucGxvdFksbT1sLmdyYXBoaWMsZyE9PXQmJmY+PTAmJiFhKWE9bC5wb2ludEF0dHJbbC5zZWxlY3RlZD9cInNlbGVjdFwiOlwiXCJdfHxiLG0/bS5hdHRyKHt4OmYseTpnLHI6YS5yLGFuY2hvclg6byxhbmNob3JZOm59KTpsLmdyYXBoaWM9ZS5sYWJlbChsLm9wdGlvbnMudGl0bGV8fGgudGl0bGV8fFwiQVwiLGYsZyxqLG8sbixoLnVzZUhUTUwpLmNzcyhDKGguc3R5bGUsbC5zdHlsZSkpLmF0dHIoYSkuYXR0cih7YWxpZ246aj09PVwiZmxhZ1wiP1wibGVmdFwiOlwiY2VudGVyXCIsd2lkdGg6aC53aWR0aCxoZWlnaHQ6aC5oZWlnaHR9KS5hZGQodGhpcy5tYXJrZXJHcm91cCkuc2hhZG93KGguc2hhZG93KSxcbmwudG9vbHRpcFBvcz1kLmludmVydGVkP1tyLmxlbityLnBvcy1kLnBsb3RMZWZ0LWcsdGhpcy54QXhpcy5sZW4tZl06W2YsZ107ZWxzZSBpZihtKWwuZ3JhcGhpYz1tLmRlc3Ryb3koKX0sZHJhd1RyYWNrZXI6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLnBvaW50cztuYi5kcmF3VHJhY2tlclBvaW50LmFwcGx5KHRoaXMpO24oYSxmdW5jdGlvbihiKXt2YXIgYz1iLmdyYXBoaWM7YyYmRChjLmVsZW1lbnQsXCJtb3VzZW92ZXJcIixmdW5jdGlvbigpe2lmKGIuc3RhY2tJbmRleD4wJiYhYi5yYWlzZWQpYi5feT1jLnksYy5hdHRyKHt5OmIuX3ktOH0pLGIucmFpc2VkPSEwO24oYSxmdW5jdGlvbihhKXtpZihhIT09YiYmYS5yYWlzZWQmJmEuZ3JhcGhpYylhLmdyYXBoaWMuYXR0cih7eTphLl95fSksYS5yYWlzZWQ9ITF9KX0pfSl9LGFuaW1hdGU6cmEsYnVpbGRLRFRyZWU6cmEsc2V0Q2xpcDpyYX0pO3diLmZsYWc9ZnVuY3Rpb24oYSxiLGMsZCxlKXtyZXR1cm5bXCJNXCIsZSYmZS5hbmNob3JYfHxcbmEsZSYmZS5hbmNob3JZfHxiLFwiTFwiLGEsYitkLGEsYixhK2MsYixhK2MsYitkLGEsYitkLFwiWlwiXX07bihbXCJjaXJjbGVcIixcInNxdWFyZVwiXSxmdW5jdGlvbihhKXt3YlthK1wicGluXCJdPWZ1bmN0aW9uKGIsYyxkLGUsZil7dmFyIGc9ZiYmZi5hbmNob3JYLGY9ZiYmZi5hbmNob3JZO2E9PT1cImNpcmNsZVwiJiZlPmQmJihiLT15KChlLWQpLzIpLGQ9ZSk7Yj13YlthXShiLGMsZCxlKTtnJiZmJiZiLnB1c2goXCJNXCIsZyxjPmY/YzpjK2UsXCJMXCIsZyxmKTtyZXR1cm4gYn19KTtZYT09PXouVk1MUmVuZGVyZXImJm4oW1wiZmxhZ1wiLFwiY2lyY2xlcGluXCIsXCJzcXVhcmVwaW5cIl0sZnVuY3Rpb24oYSl7bWIucHJvdG90eXBlLnN5bWJvbHNbYV09d2JbYV19KTt2YXIgY2E9W10uY29uY2F0KFliKSx4Yj1mdW5jdGlvbihhKXt2YXIgYj1TYShhcmd1bWVudHMsZnVuY3Rpb24oYSl7cmV0dXJuIHR5cGVvZiBhPT09XCJudW1iZXJcIn0pO2lmKGIubGVuZ3RoKXJldHVybiBNYXRoW2FdLmFwcGx5KDAsYil9O2NhWzRdPVxuW1wiZGF5XCIsWzEsMiwzLDRdXTtjYVs1XT1bXCJ3ZWVrXCIsWzEsMiwzXV07eChOLHtuYXZpZ2F0b3I6e2hhbmRsZXM6e2JhY2tncm91bmRDb2xvcjpcIiNlYmU3ZThcIixib3JkZXJDb2xvcjpcIiNiMmIxYjZcIn0saGVpZ2h0OjQwLG1hcmdpbjoyNSxtYXNrRmlsbDpcInJnYmEoMTI4LDE3OSwyMzYsMC4zKVwiLG1hc2tJbnNpZGU6ITAsb3V0bGluZUNvbG9yOlwiI2IyYjFiNlwiLG91dGxpbmVXaWR0aDoxLHNlcmllczp7dHlwZTpLLmFyZWFzcGxpbmU9PT10P1wibGluZVwiOlwiYXJlYXNwbGluZVwiLGNvbG9yOlwiIzQ1NzJBN1wiLGNvbXBhcmU6bnVsbCxmaWxsT3BhY2l0eTowLjA1LGRhdGFHcm91cGluZzp7YXBwcm94aW1hdGlvbjpcImF2ZXJhZ2VcIixlbmFibGVkOiEwLGdyb3VwUGl4ZWxXaWR0aDoyLHNtb290aGVkOiEwLHVuaXRzOmNhfSxkYXRhTGFiZWxzOntlbmFibGVkOiExLHpJbmRleDoyfSxpZDpcImhpZ2hjaGFydHMtbmF2aWdhdG9yLXNlcmllc1wiLGxpbmVDb2xvcjpudWxsLGxpbmVXaWR0aDoxLG1hcmtlcjp7ZW5hYmxlZDohMX0sXG5wb2ludFJhbmdlOjAsc2hhZG93OiExLHRocmVzaG9sZDpudWxsfSx4QXhpczp7dGlja1dpZHRoOjAsbGluZVdpZHRoOjAsZ3JpZExpbmVDb2xvcjpcIiNFRUVcIixncmlkTGluZVdpZHRoOjEsdGlja1BpeGVsSW50ZXJ2YWw6MjAwLGxhYmVsczp7YWxpZ246XCJsZWZ0XCIsc3R5bGU6e2NvbG9yOlwiIzg4OFwifSx4OjMseTotNH0sY3Jvc3NoYWlyOiExfSx5QXhpczp7Z3JpZExpbmVXaWR0aDowLHN0YXJ0T25UaWNrOiExLGVuZE9uVGljazohMSxtaW5QYWRkaW5nOjAuMSxtYXhQYWRkaW5nOjAuMSxsYWJlbHM6e2VuYWJsZWQ6ITF9LGNyb3NzaGFpcjohMSx0aXRsZTp7dGV4dDpudWxsfSx0aWNrV2lkdGg6MH19LHNjcm9sbGJhcjp7aGVpZ2h0OmtiPzIwOjE0LGJhckJhY2tncm91bmRDb2xvcjpcIiNiZmM4ZDFcIixiYXJCb3JkZXJSYWRpdXM6MCxiYXJCb3JkZXJXaWR0aDoxLGJhckJvcmRlckNvbG9yOlwiI2JmYzhkMVwiLGJ1dHRvbkFycm93Q29sb3I6XCIjNjY2XCIsYnV0dG9uQmFja2dyb3VuZENvbG9yOlwiI2ViZTdlOFwiLFxuYnV0dG9uQm9yZGVyQ29sb3I6XCIjYmJiXCIsYnV0dG9uQm9yZGVyUmFkaXVzOjAsYnV0dG9uQm9yZGVyV2lkdGg6MSxtaW5XaWR0aDo2LHJpZmxlQ29sb3I6XCIjNjY2XCIsdHJhY2tCYWNrZ3JvdW5kQ29sb3I6XCIjZWVlZWVlXCIsdHJhY2tCb3JkZXJDb2xvcjpcIiNlZWVlZWVcIix0cmFja0JvcmRlcldpZHRoOjEsbGl2ZVJlZHJhdzpqYSYmIWtifX0pO0hiLnByb3RvdHlwZT17ZHJhd0hhbmRsZTpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuY2hhcnQsZD1jLnJlbmRlcmVyLGU9dGhpcy5lbGVtZW50c1RvRGVzdHJveSxmPXRoaXMuaGFuZGxlcyxnPXRoaXMubmF2aWdhdG9yT3B0aW9ucy5oYW5kbGVzLGc9e2ZpbGw6Zy5iYWNrZ3JvdW5kQ29sb3Isc3Ryb2tlOmcuYm9yZGVyQ29sb3IsXCJzdHJva2Utd2lkdGhcIjoxfSxoO3RoaXMucmVuZGVyZWR8fChmW2JdPWQuZyhcIm5hdmlnYXRvci1oYW5kbGUtXCIrW1wibGVmdFwiLFwicmlnaHRcIl1bYl0pLmNzcyh7Y3Vyc29yOlwiZXctcmVzaXplXCJ9KS5hdHRyKHt6SW5kZXg6MTAtXG5ifSkuYWRkKCksaD1kLnJlY3QoLTQuNSwwLDksMTYsMCwxKS5hdHRyKGcpLmFkZChmW2JdKSxlLnB1c2goaCksaD1kLnBhdGgoW1wiTVwiLC0xLjUsNCxcIkxcIiwtMS41LDEyLFwiTVwiLDAuNSw0LFwiTFwiLDAuNSwxMl0pLmF0dHIoZykuYWRkKGZbYl0pLGUucHVzaChoKSk7ZltiXVtjLmlzUmVzaXppbmc/XCJhbmltYXRlXCI6XCJhdHRyXCJdKHt0cmFuc2xhdGVYOnRoaXMuc2Nyb2xsZXJMZWZ0K3RoaXMuc2Nyb2xsYmFySGVpZ2h0K3BhcnNlSW50KGEsMTApLHRyYW5zbGF0ZVk6dGhpcy50b3ArdGhpcy5oZWlnaHQvMi04fSl9LGRyYXdTY3JvbGxiYXJCdXR0b246ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jaGFydC5yZW5kZXJlcixjPXRoaXMuZWxlbWVudHNUb0Rlc3Ryb3ksZD10aGlzLnNjcm9sbGJhckJ1dHRvbnMsZT10aGlzLnNjcm9sbGJhckhlaWdodCxmPXRoaXMuc2Nyb2xsYmFyT3B0aW9ucyxnO3RoaXMucmVuZGVyZWR8fChkW2FdPWIuZygpLmFkZCh0aGlzLnNjcm9sbGJhckdyb3VwKSxnPWIucmVjdCgtMC41LFxuLTAuNSxlKzEsZSsxLGYuYnV0dG9uQm9yZGVyUmFkaXVzLGYuYnV0dG9uQm9yZGVyV2lkdGgpLmF0dHIoe3N0cm9rZTpmLmJ1dHRvbkJvcmRlckNvbG9yLFwic3Ryb2tlLXdpZHRoXCI6Zi5idXR0b25Cb3JkZXJXaWR0aCxmaWxsOmYuYnV0dG9uQmFja2dyb3VuZENvbG9yfSkuYWRkKGRbYV0pLGMucHVzaChnKSxnPWIucGF0aChbXCJNXCIsZS8yKyhhPy0xOjEpLGUvMi0zLFwiTFwiLGUvMisoYT8tMToxKSxlLzIrMyxlLzIrKGE/MjotMiksZS8yXSkuYXR0cih7ZmlsbDpmLmJ1dHRvbkFycm93Q29sb3J9KS5hZGQoZFthXSksYy5wdXNoKGcpKTthJiZkW2FdLmF0dHIoe3RyYW5zbGF0ZVg6dGhpcy5zY3JvbGxlcldpZHRoLWV9KX0scmVuZGVyOmZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPXRoaXMuY2hhcnQsZj1lLnJlbmRlcmVyLGcsaCxpLGosaz10aGlzLnNjcm9sbGJhckdyb3VwLGw9dGhpcy5uYXZpZ2F0b3JHcm91cCxtPXRoaXMuc2Nyb2xsYmFyLGw9dGhpcy54QXhpcyxvPXRoaXMuc2Nyb2xsYmFyVHJhY2ssXG5uPXRoaXMuc2Nyb2xsYmFySGVpZ2h0LHI9dGhpcy5zY3JvbGxiYXJFbmFibGVkLEE9dGhpcy5uYXZpZ2F0b3JPcHRpb25zLHQ9dGhpcy5zY3JvbGxiYXJPcHRpb25zLHU9dC5taW5XaWR0aCx3PXRoaXMuaGVpZ2h0LHg9dGhpcy50b3Asej10aGlzLm5hdmlnYXRvckVuYWJsZWQsQz1BLm91dGxpbmVXaWR0aCxCPUMvMixEPTAsRz10aGlzLm91dGxpbmVIZWlnaHQsST10LmJhckJvcmRlclJhZGl1cyxIPXQuYmFyQm9yZGVyV2lkdGgsRj14K0IsSjtpZihzKGEpJiYhaXNOYU4oYSkmJnMoYikmJiEoaXNOYU4oYil8fHRoaXMuaGFzRHJhZ2dlZCYmIXMoYykpKXt0aGlzLm5hdmlnYXRvckxlZnQ9Zz1xKGwubGVmdCxlLnBsb3RMZWZ0K24pO3RoaXMubmF2aWdhdG9yV2lkdGg9aD1xKGwubGVuLGUucGxvdFdpZHRoLTIqbik7dGhpcy5zY3JvbGxlckxlZnQ9aT1nLW47dGhpcy5zY3JvbGxlcldpZHRoPWo9aj1oKzIqbjtsLmdldEV4dHJlbWVzJiYoSj10aGlzLmdldFVuaW9uRXh0cmVtZXMoITApKSYmXG4oSi5kYXRhTWluIT09bC5taW58fEouZGF0YU1heCE9PWwubWF4KSYmbC5zZXRFeHRyZW1lcyhKLmRhdGFNaW4sSi5kYXRhTWF4LCEwLCExKTtjPXEoYyxsLnRyYW5zbGF0ZShhKSk7ZD1xKGQsbC50cmFuc2xhdGUoYikpO2lmKGlzTmFOKGMpfHxTKGMpPT09SW5maW5pdHkpYz0wLGQ9ajtpZighKGwudHJhbnNsYXRlKGQsITApLWwudHJhbnNsYXRlKGMsITApPGUueEF4aXNbMF0ubWluUmFuZ2UpKXt0aGlzLnpvb21lZE1heD1FKHYoYyxkLDApLGgpO3RoaXMuem9vbWVkTWluPUUodih0aGlzLmZpeGVkV2lkdGg/dGhpcy56b29tZWRNYXgtdGhpcy5maXhlZFdpZHRoOkUoYyxkKSwwKSxoKTt0aGlzLnJhbmdlPXRoaXMuem9vbWVkTWF4LXRoaXMuem9vbWVkTWluO2M9eSh0aGlzLnpvb21lZE1heCk7Yj15KHRoaXMuem9vbWVkTWluKTthPWMtYjtpZighdGhpcy5yZW5kZXJlZCl7aWYoeil0aGlzLm5hdmlnYXRvckdyb3VwPWw9Zi5nKFwibmF2aWdhdG9yXCIpLmF0dHIoe3pJbmRleDozfSkuYWRkKCksXG50aGlzLmxlZnRTaGFkZT1mLnJlY3QoKS5hdHRyKHtmaWxsOkEubWFza0ZpbGx9KS5hZGQobCksQS5tYXNrSW5zaWRlP3RoaXMubGVmdFNoYWRlLmNzcyh7Y3Vyc29yOlwiZXctcmVzaXplXCJ9KTp0aGlzLnJpZ2h0U2hhZGU9Zi5yZWN0KCkuYXR0cih7ZmlsbDpBLm1hc2tGaWxsfSkuYWRkKGwpLHRoaXMub3V0bGluZT1mLnBhdGgoKS5hdHRyKHtcInN0cm9rZS13aWR0aFwiOkMsc3Ryb2tlOkEub3V0bGluZUNvbG9yfSkuYWRkKGwpO2lmKHIpdGhpcy5zY3JvbGxiYXJHcm91cD1rPWYuZyhcInNjcm9sbGJhclwiKS5hZGQoKSxtPXQudHJhY2tCb3JkZXJXaWR0aCx0aGlzLnNjcm9sbGJhclRyYWNrPW89Zi5yZWN0KCkuYXR0cih7eDowLHk6LW0lMi8yLGZpbGw6dC50cmFja0JhY2tncm91bmRDb2xvcixzdHJva2U6dC50cmFja0JvcmRlckNvbG9yLFwic3Ryb2tlLXdpZHRoXCI6bSxyOnQudHJhY2tCb3JkZXJSYWRpdXN8fDAsaGVpZ2h0Om59KS5hZGQoayksdGhpcy5zY3JvbGxiYXI9bT1mLnJlY3QoKS5hdHRyKHt5Oi1IJVxuMi8yLGhlaWdodDpuLGZpbGw6dC5iYXJCYWNrZ3JvdW5kQ29sb3Isc3Ryb2tlOnQuYmFyQm9yZGVyQ29sb3IsXCJzdHJva2Utd2lkdGhcIjpILHI6SX0pLmFkZChrKSx0aGlzLnNjcm9sbGJhclJpZmxlcz1mLnBhdGgoKS5hdHRyKHtzdHJva2U6dC5yaWZsZUNvbG9yLFwic3Ryb2tlLXdpZHRoXCI6MX0pLmFkZChrKX1lPWUuaXNSZXNpemluZz9cImFuaW1hdGVcIjpcImF0dHJcIjtpZih6KXt0aGlzLmxlZnRTaGFkZVtlXShBLm1hc2tJbnNpZGU/e3g6ZytiLHk6eCx3aWR0aDpjLWIsaGVpZ2h0Ond9Ont4OmcseTp4LHdpZHRoOmIsaGVpZ2h0Ond9KTtpZih0aGlzLnJpZ2h0U2hhZGUpdGhpcy5yaWdodFNoYWRlW2VdKHt4OmcrYyx5Ongsd2lkdGg6aC1jLGhlaWdodDp3fSk7dGhpcy5vdXRsaW5lW2VdKHtkOltcIk1cIixpLEYsXCJMXCIsZytiLUIsRixnK2ItQixGK0csXCJMXCIsZytjLUIsRitHLFwiTFwiLGcrYy1CLEYsaStqLEZdLmNvbmNhdChBLm1hc2tJbnNpZGU/W1wiTVwiLGcrYitCLEYsXCJMXCIsZytjLUIsRl06XG5bXSl9KTt0aGlzLmRyYXdIYW5kbGUoYitCLDApO3RoaXMuZHJhd0hhbmRsZShjK0IsMSl9aWYociYmayl0aGlzLmRyYXdTY3JvbGxiYXJCdXR0b24oMCksdGhpcy5kcmF3U2Nyb2xsYmFyQnV0dG9uKDEpLGtbZV0oe3RyYW5zbGF0ZVg6aSx0cmFuc2xhdGVZOnkoRit3KX0pLG9bZV0oe3dpZHRoOmp9KSxnPW4rYixoPWEtSCxoPHUmJihEPSh1LWgpLzIsaD11LGctPUQpLHRoaXMuc2Nyb2xsYmFyUGFkPUQsbVtlXSh7eDpWKGcpK0glMi8yLHdpZHRoOmh9KSx1PW4rYithLzItMC41LHRoaXMuc2Nyb2xsYmFyUmlmbGVzLmF0dHIoe3Zpc2liaWxpdHk6YT4xMj9cInZpc2libGVcIjpcImhpZGRlblwifSlbZV0oe2Q6W1wiTVwiLHUtMyxuLzQsXCJMXCIsdS0zLDIqbi8zLFwiTVwiLHUsbi80LFwiTFwiLHUsMipuLzMsXCJNXCIsdSszLG4vNCxcIkxcIix1KzMsMipuLzNdfSk7dGhpcy5zY3JvbGxiYXJQYWQ9RDt0aGlzLnJlbmRlcmVkPSEwfX19LGFkZEV2ZW50czpmdW5jdGlvbigpe3ZhciBhPXRoaXMuY2hhcnQuY29udGFpbmVyLFxuYj10aGlzLm1vdXNlRG93bkhhbmRsZXIsYz10aGlzLm1vdXNlTW92ZUhhbmRsZXIsZD10aGlzLm1vdXNlVXBIYW5kbGVyLGU7ZT1bW2EsXCJtb3VzZWRvd25cIixiXSxbYSxcIm1vdXNlbW92ZVwiLGNdLFtCLFwibW91c2V1cFwiLGRdXTtkYiYmZS5wdXNoKFthLFwidG91Y2hzdGFydFwiLGJdLFthLFwidG91Y2htb3ZlXCIsY10sW0IsXCJ0b3VjaGVuZFwiLGRdKTtuKGUsZnVuY3Rpb24oYSl7RC5hcHBseShudWxsLGEpfSk7dGhpcy5fZXZlbnRzPWV9LHJlbW92ZUV2ZW50czpmdW5jdGlvbigpe24odGhpcy5fZXZlbnRzLGZ1bmN0aW9uKGEpe1QuYXBwbHkobnVsbCxhKX0pO3RoaXMuX2V2ZW50cz10O3RoaXMubmF2aWdhdG9yRW5hYmxlZCYmdGhpcy5iYXNlU2VyaWVzJiZUKHRoaXMuYmFzZVNlcmllcyxcInVwZGF0ZWREYXRhXCIsdGhpcy51cGRhdGVkRGF0YUhhbmRsZXIpfSxpbml0OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEuY2hhcnQsYyxkLGU9YS5zY3JvbGxiYXJIZWlnaHQsZj1hLm5hdmlnYXRvck9wdGlvbnMsXG5nPWEuaGVpZ2h0LGg9YS50b3AsaSxqPWEuYmFzZVNlcmllczthLm1vdXNlRG93bkhhbmRsZXI9ZnVuY3Rpb24oZCl7dmFyIGQ9Yi5wb2ludGVyLm5vcm1hbGl6ZShkKSxlPWEuem9vbWVkTWluLGY9YS56b29tZWRNYXgsaD1hLnRvcCxqPWEuc2Nyb2xsYmFySGVpZ2h0LGs9YS5zY3JvbGxlckxlZnQsbD1hLnNjcm9sbGVyV2lkdGgsbj1hLm5hdmlnYXRvckxlZnQscT1hLm5hdmlnYXRvcldpZHRoLHM9YS5zY3JvbGxiYXJQYWQsdD1hLnJhbmdlLHY9ZC5jaGFydFgseD1kLmNoYXJ0WSxkPWIueEF4aXNbMF0seSx6PWtiPzEwOjc7aWYoeD5oJiZ4PGgrZytqKWlmKChoPSFhLnNjcm9sbGJhckVuYWJsZWR8fHg8aCtnKSYmWS5hYnModi1lLW4pPHopYS5ncmFiYmVkTGVmdD0hMCxhLm90aGVySGFuZGxlUG9zPWYsYS5maXhlZEV4dHJlbWU9ZC5tYXgsYi5maXhlZFJhbmdlPW51bGw7ZWxzZSBpZihoJiZZLmFicyh2LWYtbik8eilhLmdyYWJiZWRSaWdodD0hMCxhLm90aGVySGFuZGxlUG9zPWUsXG5hLmZpeGVkRXh0cmVtZT1kLm1pbixiLmZpeGVkUmFuZ2U9bnVsbDtlbHNlIGlmKHY+bitlLXMmJnY8bitmK3MpYS5ncmFiYmVkQ2VudGVyPXYsYS5maXhlZFdpZHRoPXQsaT12LWU7ZWxzZSBpZih2PmsmJnY8aytsKXtmPWg/di1uLXQvMjp2PG4/ZS10KjAuMjp2PmsrbC1qP2UrdCowLjI6djxuK2U/ZS10OmY7aWYoZjwwKWY9MDtlbHNlIGlmKGYrdD49cSlmPXEtdCx5PWEuZ2V0VW5pb25FeHRyZW1lcygpLmRhdGFNYXg7aWYoZiE9PWUpYS5maXhlZFdpZHRoPXQsZT1jLnRvRml4ZWRSYW5nZShmLGYrdCxudWxsLHkpLGQuc2V0RXh0cmVtZXMoZS5taW4sZS5tYXgsITAsITEse3RyaWdnZXI6XCJuYXZpZ2F0b3JcIn0pfX07YS5tb3VzZU1vdmVIYW5kbGVyPWZ1bmN0aW9uKGMpe3ZhciBkPWEuc2Nyb2xsYmFySGVpZ2h0LGU9YS5uYXZpZ2F0b3JMZWZ0LGY9YS5uYXZpZ2F0b3JXaWR0aCxnPWEuc2Nyb2xsZXJMZWZ0LGg9YS5zY3JvbGxlcldpZHRoLGo9YS5yYW5nZSxrLGw7aWYoIWMudG91Y2hlc3x8XG5jLnRvdWNoZXNbMF0ucGFnZVghPT0wKWM9Yi5wb2ludGVyLm5vcm1hbGl6ZShjKSxrPWMuY2hhcnRYLGs8ZT9rPWU6az5nK2gtZCYmKGs9ZytoLWQpLGEuZ3JhYmJlZExlZnQ/KGw9ITAsYS5yZW5kZXIoMCwwLGstZSxhLm90aGVySGFuZGxlUG9zKSk6YS5ncmFiYmVkUmlnaHQ/KGw9ITAsYS5yZW5kZXIoMCwwLGEub3RoZXJIYW5kbGVQb3Msay1lKSk6YS5ncmFiYmVkQ2VudGVyJiYobD0hMCxrPGk/az1pOms+ZitpLWomJihrPWYraS1qKSxhLnJlbmRlcigwLDAsay1pLGstaStqKSksbCYmYS5zY3JvbGxiYXJPcHRpb25zLmxpdmVSZWRyYXcmJnNldFRpbWVvdXQoZnVuY3Rpb24oKXthLm1vdXNlVXBIYW5kbGVyKGMpfSwwKSxhLmhhc0RyYWdnZWQ9bH07YS5tb3VzZVVwSGFuZGxlcj1mdW5jdGlvbihkKXt2YXIgZSxmO2lmKGEuaGFzRHJhZ2dlZCl7aWYoYS56b29tZWRNaW49PT1hLm90aGVySGFuZGxlUG9zKWU9YS5maXhlZEV4dHJlbWU7ZWxzZSBpZihhLnpvb21lZE1heD09PWEub3RoZXJIYW5kbGVQb3MpZj1cbmEuZml4ZWRFeHRyZW1lO2lmKGEuem9vbWVkTWF4PT09YS5uYXZpZ2F0b3JXaWR0aClmPWEuZ2V0VW5pb25FeHRyZW1lcygpLmRhdGFNYXg7ZT1jLnRvRml4ZWRSYW5nZShhLnpvb21lZE1pbixhLnpvb21lZE1heCxlLGYpO3MoZS5taW4pJiZiLnhBeGlzWzBdLnNldEV4dHJlbWVzKGUubWluLGUubWF4LCEwLCExLHt0cmlnZ2VyOlwibmF2aWdhdG9yXCIsdHJpZ2dlck9wOlwibmF2aWdhdG9yLWRyYWdcIixET01FdmVudDpkfSl9aWYoZC50eXBlIT09XCJtb3VzZW1vdmVcIilhLmdyYWJiZWRMZWZ0PWEuZ3JhYmJlZFJpZ2h0PWEuZ3JhYmJlZENlbnRlcj1hLmZpeGVkV2lkdGg9YS5maXhlZEV4dHJlbWU9YS5vdGhlckhhbmRsZVBvcz1hLmhhc0RyYWdnZWQ9aT1udWxsfTt2YXIgaz1iLnhBeGlzLmxlbmd0aCxsPWIueUF4aXMubGVuZ3RoO2IuZXh0cmFCb3R0b21NYXJnaW49YS5vdXRsaW5lSGVpZ2h0K2YubWFyZ2luO2EubmF2aWdhdG9yRW5hYmxlZD8oYS54QXhpcz1jPW5ldyBJKGIsQyh7YnJlYWtzOmomJlxuai54QXhpcy5vcHRpb25zLmJyZWFrcyxvcmRpbmFsOmomJmoueEF4aXMub3B0aW9ucy5vcmRpbmFsfSxmLnhBeGlzLHtpZDpcIm5hdmlnYXRvci14LWF4aXNcIixpc1g6ITAsdHlwZTpcImRhdGV0aW1lXCIsaW5kZXg6ayxoZWlnaHQ6ZyxvZmZzZXQ6MCxvZmZzZXRMZWZ0OmUsb2Zmc2V0UmlnaHQ6LWUsa2VlcE9yZGluYWxQYWRkaW5nOiEwLHN0YXJ0T25UaWNrOiExLGVuZE9uVGljazohMSxtaW5QYWRkaW5nOjAsbWF4UGFkZGluZzowLHpvb21FbmFibGVkOiExfSkpLGEueUF4aXM9ZD1uZXcgSShiLEMoZi55QXhpcyx7aWQ6XCJuYXZpZ2F0b3IteS1heGlzXCIsYWxpZ25UaWNrczohMSxoZWlnaHQ6ZyxvZmZzZXQ6MCxpbmRleDpsLHpvb21FbmFibGVkOiExfSkpLGp8fGYuc2VyaWVzLmRhdGE/YS5hZGRCYXNlU2VyaWVzKCk6Yi5zZXJpZXMubGVuZ3RoPT09MCYmVShiLFwicmVkcmF3XCIsZnVuY3Rpb24oYyxkKXtpZihiLnNlcmllcy5sZW5ndGg+MCYmIWEuc2VyaWVzKWEuc2V0QmFzZVNlcmllcygpLFxuYi5yZWRyYXc9YztjLmNhbGwoYixkKX0pKTphLnhBeGlzPWM9e3RyYW5zbGF0ZTpmdW5jdGlvbihhLGMpe3ZhciBkPWIueEF4aXNbMF0sZj1kLmdldEV4dHJlbWVzKCksZz1iLnBsb3RXaWR0aC0yKmUsaD14YihcIm1pblwiLGQub3B0aW9ucy5taW4sZi5kYXRhTWluKSxkPXhiKFwibWF4XCIsZC5vcHRpb25zLm1heCxmLmRhdGFNYXgpLWg7cmV0dXJuIGM/YSpkL2craDpnKihhLWgpL2R9LHRvRml4ZWRSYW5nZTpJLnByb3RvdHlwZS50b0ZpeGVkUmFuZ2V9O1UoYixcImdldE1hcmdpbnNcIixmdW5jdGlvbihiKXt2YXIgZT10aGlzLmxlZ2VuZCxmPWUub3B0aW9ucztiLmFwcGx5KHRoaXMsW10uc2xpY2UuY2FsbChhcmd1bWVudHMsMSkpO2EudG9wPWg9YS5uYXZpZ2F0b3JPcHRpb25zLnRvcHx8dGhpcy5jaGFydEhlaWdodC1hLmhlaWdodC1hLnNjcm9sbGJhckhlaWdodC10aGlzLnNwYWNpbmdbMl0tKGYudmVydGljYWxBbGlnbj09PVwiYm90dG9tXCImJmYuZW5hYmxlZCYmIWYuZmxvYXRpbmc/ZS5sZWdlbmRIZWlnaHQrXG5xKGYubWFyZ2luLDEwKTowKTtpZihjJiZkKWMub3B0aW9ucy50b3A9ZC5vcHRpb25zLnRvcD1oLGMuc2V0QXhpc1NpemUoKSxkLnNldEF4aXNTaXplKCl9KTthLmFkZEV2ZW50cygpfSxnZXRVbmlvbkV4dHJlbWVzOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY2hhcnQueEF4aXNbMF0sYz10aGlzLnhBeGlzLGQ9Yy5vcHRpb25zLGU9Yi5vcHRpb25zLGY7aWYoIWF8fGIuZGF0YU1pbiE9PW51bGwpZj17ZGF0YU1pbjpxKGQmJmQubWluLHhiKFwibWluXCIsZS5taW4sYi5kYXRhTWluLGMuZGF0YU1pbikpLGRhdGFNYXg6cShkJiZkLm1heCx4YihcIm1heFwiLGUubWF4LGIuZGF0YU1heCxjLmRhdGFNYXgpKX07cmV0dXJuIGZ9LHNldEJhc2VTZXJpZXM6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jaGFydCxhPWF8fGIub3B0aW9ucy5uYXZpZ2F0b3IuYmFzZVNlcmllczt0aGlzLnNlcmllcyYmdGhpcy5zZXJpZXMucmVtb3ZlKCk7dGhpcy5iYXNlU2VyaWVzPWIuc2VyaWVzW2FdfHx0eXBlb2YgYT09PVxuXCJzdHJpbmdcIiYmYi5nZXQoYSl8fGIuc2VyaWVzWzBdO3RoaXMueEF4aXMmJnRoaXMuYWRkQmFzZVNlcmllcygpfSxhZGRCYXNlU2VyaWVzOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5iYXNlU2VyaWVzLGI9YT9hLm9wdGlvbnM6e30sYz1iLmRhdGEsZD10aGlzLm5hdmlnYXRvck9wdGlvbnMuc2VyaWVzLGU7ZT1kLmRhdGE7dGhpcy5oYXNOYXZpZ2F0b3JEYXRhPSEhZTtiPUMoYixkLHtlbmFibGVNb3VzZVRyYWNraW5nOiExLGdyb3VwOlwibmF2XCIscGFkWEF4aXM6ITEseEF4aXM6XCJuYXZpZ2F0b3IteC1heGlzXCIseUF4aXM6XCJuYXZpZ2F0b3IteS1heGlzXCIsbmFtZTpcIk5hdmlnYXRvclwiLHNob3dJbkxlZ2VuZDohMSxzdGFja2luZzohMSxpc0ludGVybmFsOiEwLHZpc2libGU6ITB9KTtiLmRhdGE9ZXx8Yy5zbGljZSgwKTt0aGlzLnNlcmllcz10aGlzLmNoYXJ0LmluaXRTZXJpZXMoYik7aWYoYSYmdGhpcy5uYXZpZ2F0b3JPcHRpb25zLmFkYXB0VG9VcGRhdGVkRGF0YSE9PSExKUQoYSxcInVwZGF0ZWREYXRhXCIsXG50aGlzLnVwZGF0ZWREYXRhSGFuZGxlciksYS51c2VyT3B0aW9ucy5ldmVudHM9eChhLnVzZXJPcHRpb25zLmV2ZW50LHt1cGRhdGVkRGF0YTp0aGlzLnVwZGF0ZWREYXRhSGFuZGxlcn0pfSx1cGRhdGVkRGF0YUhhbmRsZXI6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmNoYXJ0LnNjcm9sbGVyLGI9YS5iYXNlU2VyaWVzLGM9Yi54QXhpcyxkPWMuZ2V0RXh0cmVtZXMoKSxlPWQubWluLGY9ZC5tYXgsZz1kLmRhdGFNaW4sZD1kLmRhdGFNYXgsaD1mLWUsaSxqLGssbCxtLG89YS5zZXJpZXM7aT1vLnhEYXRhO3ZhciBuPSEhYy5zZXRFeHRyZW1lcztqPWY+PWlbaS5sZW5ndGgtMV0tKHRoaXMuY2xvc2VzdFBvaW50UmFuZ2V8fDApO2k9ZTw9ZztpZighYS5oYXNOYXZpZ2F0b3JEYXRhKW8ub3B0aW9ucy5wb2ludFN0YXJ0PWIueERhdGFbMF0sby5zZXREYXRhKGIub3B0aW9ucy5kYXRhLCExKSxtPSEwO2kmJihsPWcsaz1sK2gpO2omJihrPWQsaXx8KGw9dihrLWgsby54RGF0YVswXSkpKTtuJiZcbihpfHxqKT9pc05hTihsKXx8Yy5zZXRFeHRyZW1lcyhsLGssITAsITEse3RyaWdnZXI6XCJ1cGRhdGVkRGF0YVwifSk6KG0mJnRoaXMuY2hhcnQucmVkcmF3KCExKSxhLnJlbmRlcih2KGUsZyksRShmLGQpKSl9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLnJlbW92ZUV2ZW50cygpO24oW3RoaXMueEF4aXMsdGhpcy55QXhpcyx0aGlzLmxlZnRTaGFkZSx0aGlzLnJpZ2h0U2hhZGUsdGhpcy5vdXRsaW5lLHRoaXMuc2Nyb2xsYmFyVHJhY2ssdGhpcy5zY3JvbGxiYXJSaWZsZXMsdGhpcy5zY3JvbGxiYXJHcm91cCx0aGlzLnNjcm9sbGJhcl0sZnVuY3Rpb24oYSl7YSYmYS5kZXN0cm95JiZhLmRlc3Ryb3koKX0pO3RoaXMueEF4aXM9dGhpcy55QXhpcz10aGlzLmxlZnRTaGFkZT10aGlzLnJpZ2h0U2hhZGU9dGhpcy5vdXRsaW5lPXRoaXMuc2Nyb2xsYmFyVHJhY2s9dGhpcy5zY3JvbGxiYXJSaWZsZXM9dGhpcy5zY3JvbGxiYXJHcm91cD10aGlzLnNjcm9sbGJhcj1udWxsO24oW3RoaXMuc2Nyb2xsYmFyQnV0dG9ucyxcbnRoaXMuaGFuZGxlcyx0aGlzLmVsZW1lbnRzVG9EZXN0cm95XSxmdW5jdGlvbihhKXtQYShhKX0pfX07ei5TY3JvbGxlcj1IYjtVKEkucHJvdG90eXBlLFwiem9vbVwiLGZ1bmN0aW9uKGEsYixjKXt2YXIgZD10aGlzLmNoYXJ0LGU9ZC5vcHRpb25zLGY9ZS5jaGFydC56b29tVHlwZSxnPWUubmF2aWdhdG9yLGU9ZS5yYW5nZVNlbGVjdG9yLGg7aWYodGhpcy5pc1hBeGlzJiYoZyYmZy5lbmFibGVkfHxlJiZlLmVuYWJsZWQpKWlmKGY9PT1cInhcIilkLnJlc2V0Wm9vbUJ1dHRvbj1cImJsb2NrZWRcIjtlbHNlIGlmKGY9PT1cInlcIiloPSExO2Vsc2UgaWYoZj09PVwieHlcIilkPXRoaXMucHJldmlvdXNab29tLHMoYik/dGhpcy5wcmV2aW91c1pvb209W3RoaXMubWluLHRoaXMubWF4XTpkJiYoYj1kWzBdLGM9ZFsxXSxkZWxldGUgdGhpcy5wcmV2aW91c1pvb20pO3JldHVybiBoIT09dD9oOmEuY2FsbCh0aGlzLGIsYyl9KTtVKENhLnByb3RvdHlwZSxcImluaXRcIixmdW5jdGlvbihhLGIsYyl7RCh0aGlzLFxuXCJiZWZvcmVSZW5kZXJcIixmdW5jdGlvbigpe3ZhciBhPXRoaXMub3B0aW9ucztpZihhLm5hdmlnYXRvci5lbmFibGVkfHxhLnNjcm9sbGJhci5lbmFibGVkKXRoaXMuc2Nyb2xsZXI9bmV3IEhiKHRoaXMpfSk7YS5jYWxsKHRoaXMsYixjKX0pO1UoUS5wcm90b3R5cGUsXCJhZGRQb2ludFwiLGZ1bmN0aW9uKGEsYixjLGQsZSl7dmFyIGY9dGhpcy5vcHRpb25zLnR1cmJvVGhyZXNob2xkO2YmJnRoaXMueERhdGEubGVuZ3RoPmYmJmRhKGIpJiYhSmEoYikmJnRoaXMuY2hhcnQuc2Nyb2xsZXImJmdhKDIwLCEwKTthLmNhbGwodGhpcyxiLGMsZCxlKX0pO3goTix7cmFuZ2VTZWxlY3Rvcjp7YnV0dG9uVGhlbWU6e3dpZHRoOjI4LGhlaWdodDoxOCxmaWxsOlwiI2Y3ZjdmN1wiLHBhZGRpbmc6MixyOjAsXCJzdHJva2Utd2lkdGhcIjowLHN0eWxlOntjb2xvcjpcIiM0NDRcIixjdXJzb3I6XCJwb2ludGVyXCIsZm9udFdlaWdodDpcIm5vcm1hbFwifSx6SW5kZXg6NyxzdGF0ZXM6e2hvdmVyOntmaWxsOlwiI2U3ZTdlN1wifSxcbnNlbGVjdDp7ZmlsbDpcIiNlN2YwZjlcIixzdHlsZTp7Y29sb3I6XCJibGFja1wiLGZvbnRXZWlnaHQ6XCJib2xkXCJ9fX19LGhlaWdodDozNSxpbnB1dFBvc2l0aW9uOnthbGlnbjpcInJpZ2h0XCJ9LGxhYmVsU3R5bGU6e2NvbG9yOlwiIzY2NlwifX19KTtOLmxhbmc9QyhOLmxhbmcse3JhbmdlU2VsZWN0b3Jab29tOlwiWm9vbVwiLHJhbmdlU2VsZWN0b3JGcm9tOlwiRnJvbVwiLHJhbmdlU2VsZWN0b3JUbzpcIlRvXCJ9KTtJYi5wcm90b3R5cGU9e2NsaWNrQnV0dG9uOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcyxkPWMuc2VsZWN0ZWQsZT1jLmNoYXJ0LGY9Yy5idXR0b25zLGc9Yy5idXR0b25PcHRpb25zW2FdLGg9ZS54QXhpc1swXSxpPWUuc2Nyb2xsZXImJmUuc2Nyb2xsZXIuZ2V0VW5pb25FeHRyZW1lcygpfHxofHx7fSxqPWkuZGF0YU1pbixrPWkuZGF0YU1heCxsLG09aCYmeShFKGgubWF4LHEoayxoLm1heCkpKSxvPWcudHlwZSxwLGk9Zy5fcmFuZ2UscixzLHgsdT1nLmRhdGFHcm91cGluZztpZighKGo9PT1cbm51bGx8fGs9PT1udWxsfHxhPT09Yy5zZWxlY3RlZCkpe2UuZml4ZWRSYW5nZT1pO2lmKHUpdGhpcy5mb3JjZWREYXRhR3JvdXBpbmc9ITAsSS5wcm90b3R5cGUuc2V0RGF0YUdyb3VwaW5nLmNhbGwoaHx8e2NoYXJ0OnRoaXMuY2hhcnR9LHUsITEpO2lmKG89PT1cIm1vbnRoXCJ8fG89PT1cInllYXJcIilpZihoKXtpZihvPXtyYW5nZTpnLG1heDptLGRhdGFNaW46aixkYXRhTWF4Omt9LGw9aC5taW5Gcm9tUmFuZ2UuY2FsbChvKSx0eXBlb2Ygby5uZXdNYXg9PT1cIm51bWJlclwiKW09by5uZXdNYXh9ZWxzZSBpPWc7ZWxzZSBpZihpKWw9dihtLWksaiksbT1FKGwraSxrKTtlbHNlIGlmKG89PT1cInl0ZFwiKWlmKGgpe2lmKGs9PT10KWo9TnVtYmVyLk1BWF9WQUxVRSxrPU51bWJlci5NSU5fVkFMVUUsbihlLnNlcmllcyxmdW5jdGlvbihhKXthPWEueERhdGE7aj1FKGFbMF0saik7az12KGFbYS5sZW5ndGgtMV0sayl9KSxiPSExO209bmV3IGZhKGspO2w9bS5nZXRGdWxsWWVhcigpO2w9cj12KGp8fFxuMCxmYS5VVEMobCwwLDEpKTttPW0uZ2V0VGltZSgpO209RShrfHxtLG0pfWVsc2V7RChlLFwiYmVmb3JlUmVuZGVyXCIsZnVuY3Rpb24oKXtjLmNsaWNrQnV0dG9uKGEpfSk7cmV0dXJufWVsc2Ugbz09PVwiYWxsXCImJmgmJihsPWosbT1rKTtmW2RdJiZmW2RdLnNldFN0YXRlKDApO2lmKGZbYV0pZlthXS5zZXRTdGF0ZSgyKSxjLmxhc3RTZWxlY3RlZD1hO2g/KGguc2V0RXh0cmVtZXMobCxtLHEoYiwxKSwwLHt0cmlnZ2VyOlwicmFuZ2VTZWxlY3RvckJ1dHRvblwiLHJhbmdlU2VsZWN0b3JCdXR0b246Z30pLGMuc2V0U2VsZWN0ZWQoYSkpOihwPWUub3B0aW9ucy54QXhpc1swXSx4PXAucmFuZ2UscC5yYW5nZT1pLHM9cC5taW4scC5taW49cixjLnNldFNlbGVjdGVkKGEpLEQoZSxcImxvYWRcIixmdW5jdGlvbigpe3AucmFuZ2U9eDtwLm1pbj1zfSkpfX0sc2V0U2VsZWN0ZWQ6ZnVuY3Rpb24oYSl7dGhpcy5zZWxlY3RlZD10aGlzLm9wdGlvbnMuc2VsZWN0ZWQ9YX0sZGVmYXVsdEJ1dHRvbnM6W3t0eXBlOlwibW9udGhcIixcbmNvdW50OjEsdGV4dDpcIjFtXCJ9LHt0eXBlOlwibW9udGhcIixjb3VudDozLHRleHQ6XCIzbVwifSx7dHlwZTpcIm1vbnRoXCIsY291bnQ6Nix0ZXh0OlwiNm1cIn0se3R5cGU6XCJ5dGRcIix0ZXh0OlwiWVREXCJ9LHt0eXBlOlwieWVhclwiLGNvdW50OjEsdGV4dDpcIjF5XCJ9LHt0eXBlOlwiYWxsXCIsdGV4dDpcIkFsbFwifV0saW5pdDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLGM9YS5vcHRpb25zLnJhbmdlU2VsZWN0b3IsZD1jLmJ1dHRvbnN8fFtdLmNvbmNhdChiLmRlZmF1bHRCdXR0b25zKSxlPWMuc2VsZWN0ZWQsZj1iLmJsdXJJbnB1dHM9ZnVuY3Rpb24oKXt2YXIgYT1iLm1pbklucHV0LGM9Yi5tYXhJbnB1dDthJiZhLmJsdXImJk0oYSxcImJsdXJcIik7YyYmYy5ibHVyJiZNKGMsXCJibHVyXCIpfTtiLmNoYXJ0PWE7Yi5vcHRpb25zPWM7Yi5idXR0b25zPVtdO2EuZXh0cmFUb3BNYXJnaW49Yy5oZWlnaHQ7Yi5idXR0b25PcHRpb25zPWQ7RChhLmNvbnRhaW5lcixcIm1vdXNlZG93blwiLGYpO0QoYSxcInJlc2l6ZVwiLGYpO1xubihkLGIuY29tcHV0ZUJ1dHRvblJhbmdlKTtlIT09dCYmZFtlXSYmdGhpcy5jbGlja0J1dHRvbihlLCExKTtEKGEsXCJsb2FkXCIsZnVuY3Rpb24oKXtEKGEueEF4aXNbMF0sXCJzZXRFeHRyZW1lc1wiLGZ1bmN0aW9uKGMpe3RoaXMubWF4LXRoaXMubWluIT09YS5maXhlZFJhbmdlJiZjLnRyaWdnZXIhPT1cInJhbmdlU2VsZWN0b3JCdXR0b25cIiYmYy50cmlnZ2VyIT09XCJ1cGRhdGVkRGF0YVwiJiZiLmZvcmNlZERhdGFHcm91cGluZyYmdGhpcy5zZXREYXRhR3JvdXBpbmcoITEsITEpfSk7RChhLnhBeGlzWzBdLFwiYWZ0ZXJTZXRFeHRyZW1lc1wiLGZ1bmN0aW9uKCl7Yi51cGRhdGVCdXR0b25TdGF0ZXMoITApfSl9KX0sdXBkYXRlQnV0dG9uU3RhdGVzOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMsYz10aGlzLmNoYXJ0LGQ9Yy54QXhpc1swXSxlPWMuc2Nyb2xsZXImJmMuc2Nyb2xsZXIuZ2V0VW5pb25FeHRyZW1lcygpfHxkLGY9ZS5kYXRhTWluLGc9ZS5kYXRhTWF4LGg9Yi5zZWxlY3RlZCxpPWIub3B0aW9ucy5hbGxCdXR0b25zRW5hYmxlZCxcbmo9Yi5idXR0b25zO2EmJmMuZml4ZWRSYW5nZSE9PXkoZC5tYXgtZC5taW4pJiYoaltoXSYmaltoXS5zZXRTdGF0ZSgwKSxiLnNldFNlbGVjdGVkKG51bGwpKTtuKGIuYnV0dG9uT3B0aW9ucyxmdW5jdGlvbihhLGUpe3ZhciBtPXkoZC5tYXgtZC5taW4pLG89YS5fcmFuZ2Usbj1hLnR5cGUscT1hLmNvdW50fHwxLHM9bz5nLWYsdD1vPGQubWluUmFuZ2UsdT1hLnR5cGU9PT1cImFsbFwiJiZkLm1heC1kLm1pbj49Zy1mJiZqW2VdLnN0YXRlIT09Mix3PWEudHlwZT09PVwieXRkXCImJm1hKFwiJVlcIixmKT09PW1hKFwiJVlcIixnKSx2PWMucmVuZGVyZXIuZm9yRXhwb3J0JiZlPT09aCxvPW89PT1tLHg9IWQuaGFzVmlzaWJsZVNlcmllcztpZigobj09PVwibW9udGhcInx8bj09PVwieWVhclwiKSYmbT49e21vbnRoOjI4LHllYXI6MzY1fVtuXSo4NjRFNSpxJiZtPD17bW9udGg6MzEseWVhcjozNjZ9W25dKjg2NEU1KnEpbz0hMDt2fHxvJiZlIT09aCYmZT09PWIubGFzdFNlbGVjdGVkPyhiLnNldFNlbGVjdGVkKGUpLFxualtlXS5zZXRTdGF0ZSgyKSk6IWkmJihzfHx0fHx1fHx3fHx4KT9qW2VdLnNldFN0YXRlKDMpOmpbZV0uc3RhdGU9PT0zJiZqW2VdLnNldFN0YXRlKDApfSl9LGNvbXB1dGVCdXR0b25SYW5nZTpmdW5jdGlvbihhKXt2YXIgYj1hLnR5cGUsYz1hLmNvdW50fHwxLGQ9e21pbGxpc2Vjb25kOjEsc2Vjb25kOjFFMyxtaW51dGU6NkU0LGhvdXI6MzZFNSxkYXk6ODY0RTUsd2Vlazo2MDQ4RTV9O2lmKGRbYl0pYS5fcmFuZ2U9ZFtiXSpjO2Vsc2UgaWYoYj09PVwibW9udGhcInx8Yj09PVwieWVhclwiKWEuX3JhbmdlPXttb250aDozMCx5ZWFyOjM2NX1bYl0qODY0RTUqY30sc2V0SW5wdXRWYWx1ZTpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuY2hhcnQub3B0aW9ucy5yYW5nZVNlbGVjdG9yO2lmKHMoYikpdGhpc1thK1wiSW5wdXRcIl0uSENUaW1lPWI7dGhpc1thK1wiSW5wdXRcIl0udmFsdWU9bWEoYy5pbnB1dEVkaXREYXRlRm9ybWF0fHxcIiVZLSVtLSVkXCIsdGhpc1thK1wiSW5wdXRcIl0uSENUaW1lKTt0aGlzW2ErXG5cIkRhdGVCb3hcIl0uYXR0cih7dGV4dDptYShjLmlucHV0RGF0ZUZvcm1hdHx8XCIlYiAlZSwgJVlcIix0aGlzW2ErXCJJbnB1dFwiXS5IQ1RpbWUpfSl9LHNob3dJbnB1dDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmlucHV0R3JvdXAsYz10aGlzW2ErXCJEYXRlQm94XCJdO0YodGhpc1thK1wiSW5wdXRcIl0se2xlZnQ6Yi50cmFuc2xhdGVYK2MueCtcInB4XCIsdG9wOmIudHJhbnNsYXRlWStcInB4XCIsd2lkdGg6Yy53aWR0aC0yK1wicHhcIixoZWlnaHQ6Yy5oZWlnaHQtMitcInB4XCIsYm9yZGVyOlwiMnB4IHNvbGlkIHNpbHZlclwifSl9LGhpZGVJbnB1dDpmdW5jdGlvbihhKXtGKHRoaXNbYStcIklucHV0XCJdLHtib3JkZXI6MCx3aWR0aDpcIjFweFwiLGhlaWdodDpcIjFweFwifSk7dGhpcy5zZXRJbnB1dFZhbHVlKGEpfSxkcmF3SW5wdXQ6ZnVuY3Rpb24oYSl7ZnVuY3Rpb24gYigpe3ZhciBhPWoudmFsdWUsYj0oZy5pbnB1dERhdGVQYXJzZXJ8fGZhLnBhcnNlKShhKSxlPWQueEF4aXNbMF0sZj1lLmRhdGFNaW4saD1lLmRhdGFNYXg7XG5pZihiIT09ai5wcmV2aW91c1ZhbHVlKWoucHJldmlvdXNWYWx1ZT1iLGlzTmFOKGIpJiYoYj1hLnNwbGl0KFwiLVwiKSxiPWZhLlVUQyhHKGJbMF0pLEcoYlsxXSktMSxHKGJbMl0pKSksaXNOYU4oYil8fChOLmdsb2JhbC51c2VVVEN8fChiKz0obmV3IGZhKS5nZXRUaW1lem9uZU9mZnNldCgpKjZFNCksaT9iPmMubWF4SW5wdXQuSENUaW1lP2I9dDpiPGYmJihiPWYpOmI8Yy5taW5JbnB1dC5IQ1RpbWU/Yj10OmI+aCYmKGI9aCksYiE9PXQmJmQueEF4aXNbMF0uc2V0RXh0cmVtZXMoaT9iOmUubWluLGk/ZS5tYXg6Yix0LHQse3RyaWdnZXI6XCJyYW5nZVNlbGVjdG9ySW5wdXRcIn0pKX12YXIgYz10aGlzLGQ9Yy5jaGFydCxlPWQucmVuZGVyZXIuc3R5bGUsZj1kLnJlbmRlcmVyLGc9ZC5vcHRpb25zLnJhbmdlU2VsZWN0b3IsaD1jLmRpdixpPWE9PT1cIm1pblwiLGosayxsPXRoaXMuaW5wdXRHcm91cDt0aGlzW2ErXCJMYWJlbFwiXT1rPWYubGFiZWwoTi5sYW5nW2k/XCJyYW5nZVNlbGVjdG9yRnJvbVwiOlxuXCJyYW5nZVNlbGVjdG9yVG9cIl0sdGhpcy5pbnB1dEdyb3VwLm9mZnNldCkuYXR0cih7cGFkZGluZzoyfSkuY3NzKEMoZSxnLmxhYmVsU3R5bGUpKS5hZGQobCk7bC5vZmZzZXQrPWsud2lkdGgrNTt0aGlzW2ErXCJEYXRlQm94XCJdPWY9Zi5sYWJlbChcIlwiLGwub2Zmc2V0KS5hdHRyKHtwYWRkaW5nOjIsd2lkdGg6Zy5pbnB1dEJveFdpZHRofHw5MCxoZWlnaHQ6Zy5pbnB1dEJveEhlaWdodHx8MTcsc3Ryb2tlOmcuaW5wdXRCb3hCb3JkZXJDb2xvcnx8XCJzaWx2ZXJcIixcInN0cm9rZS13aWR0aFwiOjF9KS5jc3MoQyh7dGV4dEFsaWduOlwiY2VudGVyXCIsY29sb3I6XCIjNDQ0XCJ9LGUsZy5pbnB1dFN0eWxlKSkub24oXCJjbGlja1wiLGZ1bmN0aW9uKCl7Yy5zaG93SW5wdXQoYSk7Y1thK1wiSW5wdXRcIl0uZm9jdXMoKX0pLmFkZChsKTtsLm9mZnNldCs9Zi53aWR0aCsoaT8xMDowKTt0aGlzW2ErXCJJbnB1dFwiXT1qPWVhKFwiaW5wdXRcIix7bmFtZTphLGNsYXNzTmFtZTpcImhpZ2hjaGFydHMtcmFuZ2Utc2VsZWN0b3JcIixcbnR5cGU6XCJ0ZXh0XCJ9LHgoe3Bvc2l0aW9uOlwiYWJzb2x1dGVcIixib3JkZXI6MCx3aWR0aDpcIjFweFwiLGhlaWdodDpcIjFweFwiLHBhZGRpbmc6MCx0ZXh0QWxpZ246XCJjZW50ZXJcIixmb250U2l6ZTplLmZvbnRTaXplLGZvbnRGYW1pbHk6ZS5mb250RmFtaWx5LGxlZnQ6XCItOWVtXCIsdG9wOmQucGxvdFRvcCtcInB4XCJ9LGcuaW5wdXRTdHlsZSksaCk7ai5vbmZvY3VzPWZ1bmN0aW9uKCl7Yy5zaG93SW5wdXQoYSl9O2oub25ibHVyPWZ1bmN0aW9uKCl7Yy5oaWRlSW5wdXQoYSl9O2oub25jaGFuZ2U9YjtqLm9ua2V5cHJlc3M9ZnVuY3Rpb24oYSl7YS5rZXlDb2RlPT09MTMmJmIoKX19LGdldFBvc2l0aW9uOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5jaGFydCxiPWEub3B0aW9ucy5yYW5nZVNlbGVjdG9yLGE9cSgoYi5idXR0b25Qb3NpdGlvbnx8e30pLnksYS5wbG90VG9wLWEuYXhpc09mZnNldFswXS1iLmhlaWdodCk7cmV0dXJue2J1dHRvblRvcDphLGlucHV0VG9wOmEtMTB9fSxyZW5kZXI6ZnVuY3Rpb24oYSxcbmIpe3ZhciBjPXRoaXMsZD1jLmNoYXJ0LGU9ZC5yZW5kZXJlcixmPWQuY29udGFpbmVyLGc9ZC5vcHRpb25zLGg9Zy5leHBvcnRpbmcmJmcuZXhwb3J0aW5nLmVuYWJsZWQhPT0hMSYmZy5uYXZpZ2F0aW9uJiZnLm5hdmlnYXRpb24uYnV0dG9uT3B0aW9ucyxpPWcucmFuZ2VTZWxlY3RvcixqPWMuYnV0dG9ucyxnPU4ubGFuZyxrPWMuZGl2LGs9Yy5pbnB1dEdyb3VwLGw9aS5idXR0b25UaGVtZSxtPWkuYnV0dG9uUG9zaXRpb258fHt9LG89aS5pbnB1dEVuYWJsZWQscD1sJiZsLnN0YXRlcyxyPWQucGxvdExlZnQsdCx2PXRoaXMuZ2V0UG9zaXRpb24oKSx1PWMuZ3JvdXAsdz1jLnJlbmRlcmVkO2lmKCF3JiYoYy5ncm91cD11PWUuZyhcInJhbmdlLXNlbGVjdG9yLWJ1dHRvbnNcIikuYWRkKCksYy56b29tVGV4dD1lLnRleHQoZy5yYW5nZVNlbGVjdG9yWm9vbSxxKG0ueCxyKSwxNSkuY3NzKGkubGFiZWxTdHlsZSkuYWRkKHUpLHQ9cShtLngscikrYy56b29tVGV4dC5nZXRCQm94KCkud2lkdGgrXG41LG4oYy5idXR0b25PcHRpb25zLGZ1bmN0aW9uKGEsYil7altiXT1lLmJ1dHRvbihhLnRleHQsdCwwLGZ1bmN0aW9uKCl7Yy5jbGlja0J1dHRvbihiKTtjLmlzQWN0aXZlPSEwfSxsLHAmJnAuaG92ZXIscCYmcC5zZWxlY3QscCYmcC5kaXNhYmxlZCkuY3NzKHt0ZXh0QWxpZ246XCJjZW50ZXJcIn0pLmFkZCh1KTt0Kz1qW2JdLndpZHRoK3EoaS5idXR0b25TcGFjaW5nLDUpO2Muc2VsZWN0ZWQ9PT1iJiZqW2JdLnNldFN0YXRlKDIpfSksYy51cGRhdGVCdXR0b25TdGF0ZXMoKSxvIT09ITEpKWMuZGl2PWs9ZWEoXCJkaXZcIixudWxsLHtwb3NpdGlvbjpcInJlbGF0aXZlXCIsaGVpZ2h0OjAsekluZGV4OjF9KSxmLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGssZiksYy5pbnB1dEdyb3VwPWs9ZS5nKFwiaW5wdXQtZ3JvdXBcIikuYWRkKCksay5vZmZzZXQ9MCxjLmRyYXdJbnB1dChcIm1pblwiKSxjLmRyYXdJbnB1dChcIm1heFwiKTt1W3c/XCJhbmltYXRlXCI6XCJhdHRyXCJdKHt0cmFuc2xhdGVZOnYuYnV0dG9uVG9wfSk7XG5vIT09ITEmJihrLmFsaWduKHgoe3k6di5pbnB1dFRvcCx3aWR0aDprLm9mZnNldCx4OmgmJnYuaW5wdXRUb3A8KGgueXx8MCkraC5oZWlnaHQtZC5zcGFjaW5nWzBdPy00MDowfSxpLmlucHV0UG9zaXRpb24pLCEwLGQuc3BhY2luZ0JveCkscyhvKXx8KGQ9dS5nZXRCQm94KCksa1trLnRyYW5zbGF0ZVg8ZC54K2Qud2lkdGgrMTA/XCJoaWRlXCI6XCJzaG93XCJdKCkpLGMuc2V0SW5wdXRWYWx1ZShcIm1pblwiLGEpLGMuc2V0SW5wdXRWYWx1ZShcIm1heFwiLGIpKTtjLnJlbmRlcmVkPSEwfSxkZXN0cm95OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5taW5JbnB1dCxiPXRoaXMubWF4SW5wdXQsYz10aGlzLmNoYXJ0LGQ9dGhpcy5ibHVySW5wdXRzLGU7VChjLmNvbnRhaW5lcixcIm1vdXNlZG93blwiLGQpO1QoYyxcInJlc2l6ZVwiLGQpO1BhKHRoaXMuYnV0dG9ucyk7aWYoYSlhLm9uZm9jdXM9YS5vbmJsdXI9YS5vbmNoYW5nZT1udWxsO2lmKGIpYi5vbmZvY3VzPWIub25ibHVyPWIub25jaGFuZ2U9bnVsbDtcbmZvcihlIGluIHRoaXMpdGhpc1tlXSYmZSE9PVwiY2hhcnRcIiYmKHRoaXNbZV0uZGVzdHJveT90aGlzW2VdLmRlc3Ryb3koKTp0aGlzW2VdLm5vZGVUeXBlJiZWYSh0aGlzW2VdKSksdGhpc1tlXT1udWxsfX07SS5wcm90b3R5cGUudG9GaXhlZFJhbmdlPWZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPXRoaXMuY2hhcnQmJnRoaXMuY2hhcnQuZml4ZWRSYW5nZSxhPXEoYyx0aGlzLnRyYW5zbGF0ZShhLCEwKSksYj1xKGQsdGhpcy50cmFuc2xhdGUoYiwhMCkpLGM9ZSYmKGItYSkvZTtjPjAuNyYmYzwxLjMmJihkP2E9Yi1lOmI9YStlKTtpc05hTihhKSYmKGE9Yj12b2lkIDApO3JldHVybnttaW46YSxtYXg6Yn19O0kucHJvdG90eXBlLm1pbkZyb21SYW5nZT1mdW5jdGlvbigpe3ZhciBhPXRoaXMucmFuZ2UsYj17bW9udGg6XCJNb250aFwiLHllYXI6XCJGdWxsWWVhclwifVthLnR5cGVdLGMsZD10aGlzLm1heCxlLGYsZz1mdW5jdGlvbihhLGMpe3ZhciBkPW5ldyBmYShhKTtkW1wic2V0XCIrYl0oZFtcImdldFwiK1xuYl0oKStjKTtyZXR1cm4gZC5nZXRUaW1lKCktYX07dHlwZW9mIGE9PT1cIm51bWJlclwiPyhjPXRoaXMubWF4LWEsZj1hKTpjPWQrZyhkLC1hLmNvdW50KTtlPXEodGhpcy5kYXRhTWluLE51bWJlci5NSU5fVkFMVUUpO2lzTmFOKGMpJiYoYz1lKTtpZihjPD1lKWM9ZSxmPT09dm9pZCAwJiYoZj1nKGMsYS5jb3VudCkpLHRoaXMubmV3TWF4PUUoYytmLHRoaXMuZGF0YU1heCk7aXNOYU4oZCkmJihjPXZvaWQgMCk7cmV0dXJuIGN9O1UoQ2EucHJvdG90eXBlLFwiaW5pdFwiLGZ1bmN0aW9uKGEsYixjKXtEKHRoaXMsXCJpbml0XCIsZnVuY3Rpb24oKXtpZih0aGlzLm9wdGlvbnMucmFuZ2VTZWxlY3Rvci5lbmFibGVkKXRoaXMucmFuZ2VTZWxlY3Rvcj1uZXcgSWIodGhpcyl9KTthLmNhbGwodGhpcyxiLGMpfSk7ei5SYW5nZVNlbGVjdG9yPUliO0NhLnByb3RvdHlwZS5jYWxsYmFja3MucHVzaChmdW5jdGlvbihhKXtmdW5jdGlvbiBiKCl7Zj1hLnhBeGlzWzBdLmdldEV4dHJlbWVzKCk7Zy5yZW5kZXIoZi5taW4sXG5mLm1heCl9ZnVuY3Rpb24gYygpe2Y9YS54QXhpc1swXS5nZXRFeHRyZW1lcygpO2lzTmFOKGYubWluKXx8aC5yZW5kZXIoZi5taW4sZi5tYXgpfWZ1bmN0aW9uIGQoYSl7YS50cmlnZ2VyT3AhPT1cIm5hdmlnYXRvci1kcmFnXCImJmcucmVuZGVyKGEubWluLGEubWF4KX1mdW5jdGlvbiBlKGEpe2gucmVuZGVyKGEubWluLGEubWF4KX12YXIgZixnPWEuc2Nyb2xsZXIsaD1hLnJhbmdlU2VsZWN0b3I7ZyYmKEQoYS54QXhpc1swXSxcImFmdGVyU2V0RXh0cmVtZXNcIixkKSxVKGEsXCJkcmF3Q2hhcnRCb3hcIixmdW5jdGlvbihhKXt2YXIgYz10aGlzLmlzRGlydHlCb3g7YS5jYWxsKHRoaXMpO2MmJmIoKX0pLGIoKSk7aCYmKEQoYS54QXhpc1swXSxcImFmdGVyU2V0RXh0cmVtZXNcIixlKSxEKGEsXCJyZXNpemVcIixjKSxjKCkpO0QoYSxcImRlc3Ryb3lcIixmdW5jdGlvbigpe2cmJlQoYS54QXhpc1swXSxcImFmdGVyU2V0RXh0cmVtZXNcIixkKTtoJiYoVChhLFwicmVzaXplXCIsYyksVChhLnhBeGlzWzBdLFwiYWZ0ZXJTZXRFeHRyZW1lc1wiLFxuZSkpfSl9KTt6LlN0b2NrQ2hhcnQ9ei5zdG9ja0NoYXJ0PWZ1bmN0aW9uKGEsYixjKXt2YXIgZD1EYShhKXx8YS5ub2RlTmFtZSxlPWFyZ3VtZW50c1tkPzE6MF0sZj1lLnNlcmllcyxnLGg9cShlLm5hdmlnYXRvciYmZS5uYXZpZ2F0b3IuZW5hYmxlZCwhMCk/e3N0YXJ0T25UaWNrOiExLGVuZE9uVGljazohMX06bnVsbCxpPXttYXJrZXI6e2VuYWJsZWQ6ITEscmFkaXVzOjJ9fSxqPXtzaGFkb3c6ITEsYm9yZGVyV2lkdGg6MH07ZS54QXhpcz10YSh2YShlLnhBeGlzfHx7fSksZnVuY3Rpb24oYSl7cmV0dXJuIEMoe21pblBhZGRpbmc6MCxtYXhQYWRkaW5nOjAsb3JkaW5hbDohMCx0aXRsZTp7dGV4dDpudWxsfSxsYWJlbHM6e292ZXJmbG93OlwianVzdGlmeVwifSxzaG93TGFzdExhYmVsOiEwfSxhLHt0eXBlOlwiZGF0ZXRpbWVcIixjYXRlZ29yaWVzOm51bGx9LGgpfSk7ZS55QXhpcz10YSh2YShlLnlBeGlzfHx7fSksZnVuY3Rpb24oYSl7Zz1xKGEub3Bwb3NpdGUsITApO3JldHVybiBDKHtsYWJlbHM6e3k6LTJ9LFxub3Bwb3NpdGU6ZyxzaG93TGFzdExhYmVsOiExLHRpdGxlOnt0ZXh0Om51bGx9fSxhKX0pO2Uuc2VyaWVzPW51bGw7ZT1DKHtjaGFydDp7cGFubmluZzohMCxwaW5jaFR5cGU6XCJ4XCJ9LG5hdmlnYXRvcjp7ZW5hYmxlZDohMH0sc2Nyb2xsYmFyOntlbmFibGVkOiEwfSxyYW5nZVNlbGVjdG9yOntlbmFibGVkOiEwfSx0aXRsZTp7dGV4dDpudWxsLHN0eWxlOntmb250U2l6ZTpcIjE2cHhcIn19LHRvb2x0aXA6e3NoYXJlZDohMCxjcm9zc2hhaXJzOiEwfSxsZWdlbmQ6e2VuYWJsZWQ6ITF9LHBsb3RPcHRpb25zOntsaW5lOmksc3BsaW5lOmksYXJlYTppLGFyZWFzcGxpbmU6aSxhcmVhcmFuZ2U6aSxhcmVhc3BsaW5lcmFuZ2U6aSxjb2x1bW46aixjb2x1bW5yYW5nZTpqLGNhbmRsZXN0aWNrOmosb2hsYzpqfX0sZSx7X3N0b2NrOiEwLGNoYXJ0OntpbnZlcnRlZDohMX19KTtlLnNlcmllcz1mO3JldHVybiBkP25ldyBDYShhLGUsYyk6bmV3IENhKGUsYil9O1UoWmEucHJvdG90eXBlLFwiaW5pdFwiLFxuZnVuY3Rpb24oYSxiLGMpe3ZhciBkPWMuY2hhcnQucGluY2hUeXBlfHxcIlwiO2EuY2FsbCh0aGlzLGIsYyk7dGhpcy5waW5jaFg9dGhpcy5waW5jaEhvcj1kLmluZGV4T2YoXCJ4XCIpIT09LTE7dGhpcy5waW5jaFk9dGhpcy5waW5jaFZlcnQ9ZC5pbmRleE9mKFwieVwiKSE9PS0xO3RoaXMuaGFzWm9vbT10aGlzLmhhc1pvb218fHRoaXMucGluY2hIb3J8fHRoaXMucGluY2hWZXJ0fSk7VShJLnByb3RvdHlwZSxcImF1dG9MYWJlbEFsaWduXCIsZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jaGFydCxjPXRoaXMub3B0aW9ucyxiPWIuX2xhYmVsUGFuZXM9Yi5fbGFiZWxQYW5lc3x8e30sZD10aGlzLm9wdGlvbnMubGFiZWxzO2lmKHRoaXMuY2hhcnQub3B0aW9ucy5fc3RvY2smJnRoaXMuY29sbD09PVwieUF4aXNcIiYmKGM9Yy50b3ArXCIsXCIrYy5oZWlnaHQsIWJbY10mJmQuZW5hYmxlZCkpe2lmKGQueD09PTE1KWQueD0wO2lmKGQuYWxpZ249PT12b2lkIDApZC5hbGlnbj1cInJpZ2h0XCI7YltjXT0xO3JldHVyblwicmlnaHRcIn1yZXR1cm4gYS5jYWxsKHRoaXMsXG5bXS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSl9KTtVKEkucHJvdG90eXBlLFwiZ2V0UGxvdExpbmVQYXRoXCIsZnVuY3Rpb24oYSxiLGMsZCxlLGYpe3ZhciBnPXRoaXMsaD10aGlzLmlzTGlua2VkJiYhdGhpcy5zZXJpZXM/dGhpcy5saW5rZWRQYXJlbnQuc2VyaWVzOnRoaXMuc2VyaWVzLGk9Zy5jaGFydCxqPWkucmVuZGVyZXIsaz1nLmxlZnQsbD1nLnRvcCxtLG8scCxyLHQ9W10seD1bXSx1LHc7aWYoZy5jb2xsPT09XCJjb2xvckF4aXNcIilyZXR1cm4gYS5hcHBseSh0aGlzLFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpKTt4PWcuaXNYQXhpcz9zKGcub3B0aW9ucy55QXhpcyk/W2kueUF4aXNbZy5vcHRpb25zLnlBeGlzXV06dGEoaCxmdW5jdGlvbihhKXtyZXR1cm4gYS55QXhpc30pOnMoZy5vcHRpb25zLnhBeGlzKT9baS54QXhpc1tnLm9wdGlvbnMueEF4aXNdXTp0YShoLGZ1bmN0aW9uKGEpe3JldHVybiBhLnhBeGlzfSk7bihnLmlzWEF4aXM/aS55QXhpczppLnhBeGlzLGZ1bmN0aW9uKGEpe2lmKHMoYS5vcHRpb25zLmlkKT9cbmEub3B0aW9ucy5pZC5pbmRleE9mKFwibmF2aWdhdG9yXCIpPT09LTE6MSl7dmFyIGI9YS5pc1hBeGlzP1wieUF4aXNcIjpcInhBeGlzXCIsYj1zKGEub3B0aW9uc1tiXSk/aVtiXVthLm9wdGlvbnNbYl1dOmlbYl1bMF07Zz09PWImJngucHVzaChhKX19KTt1PXgubGVuZ3RoP1tdOltnLmlzWEF4aXM/aS55QXhpc1swXTppLnhBeGlzWzBdXTtuKHgsZnVuY3Rpb24oYSl7c2EoYSx1KT09PS0xJiZ1LnB1c2goYSl9KTt3PXEoZixnLnRyYW5zbGF0ZShiLG51bGwsbnVsbCxkKSk7aXNOYU4odyl8fChnLmhvcml6P24odSxmdW5jdGlvbihhKXt2YXIgYjtvPWEucG9zO3I9bythLmxlbjttPXA9eSh3K2cudHJhbnNCKTtpZihtPGt8fG0+aytnLndpZHRoKWU/bT1wPUUodihrLG0pLGsrZy53aWR0aCk6Yj0hMDtifHx0LnB1c2goXCJNXCIsbSxvLFwiTFwiLHAscil9KTpuKHUsZnVuY3Rpb24oYSl7dmFyIGI7bT1hLnBvcztwPW0rYS5sZW47bz1yPXkobCtnLmhlaWdodC13KTtpZihvPGx8fG8+bCtnLmhlaWdodCllP1xubz1yPUUodihsLG8pLGcudG9wK2cuaGVpZ2h0KTpiPSEwO2J8fHQucHVzaChcIk1cIixtLG8sXCJMXCIscCxyKX0pKTtyZXR1cm4gdC5sZW5ndGg+MD9qLmNyaXNwUG9seUxpbmUodCxjfHwxKTpudWxsfSk7SS5wcm90b3R5cGUuZ2V0UGxvdEJhbmRQYXRoPWZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5nZXRQbG90TGluZVBhdGgoYixudWxsLG51bGwsITApLGQ9dGhpcy5nZXRQbG90TGluZVBhdGgoYSxudWxsLG51bGwsITApLGU9W10sZjtpZihkJiZjJiZkLnRvU3RyaW5nKCkhPT1jLnRvU3RyaW5nKCkpZm9yKGY9MDtmPGQubGVuZ3RoO2YrPTYpZS5wdXNoKFwiTVwiLGRbZisxXSxkW2YrMl0sXCJMXCIsZFtmKzRdLGRbZis1XSxjW2YrNF0sY1tmKzVdLGNbZisxXSxjW2YrMl0pO2Vsc2UgZT1udWxsO3JldHVybiBlfTt5YS5wcm90b3R5cGUuY3Jpc3BQb2x5TGluZT1mdW5jdGlvbihhLGIpe3ZhciBjO2ZvcihjPTA7YzxhLmxlbmd0aDtjKz02KWFbYysxXT09PWFbYys0XSYmKGFbYysxXT1hW2MrNF09XG55KGFbYysxXSktYiUyLzIpLGFbYysyXT09PWFbYys1XSYmKGFbYysyXT1hW2MrNV09eShhW2MrMl0pK2IlMi8yKTtyZXR1cm4gYX07aWYoWWE9PT16LlZNTFJlbmRlcmVyKW1iLnByb3RvdHlwZS5jcmlzcFBvbHlMaW5lPXlhLnByb3RvdHlwZS5jcmlzcFBvbHlMaW5lO1UoSS5wcm90b3R5cGUsXCJoaWRlQ3Jvc3NoYWlyXCIsZnVuY3Rpb24oYSxiKXthLmNhbGwodGhpcyxiKTtpZih0aGlzLmNyb3NzTGFiZWwpdGhpcy5jcm9zc0xhYmVsPXRoaXMuY3Jvc3NMYWJlbC5oaWRlKCl9KTtVKEkucHJvdG90eXBlLFwiZHJhd0Nyb3NzaGFpclwiLGZ1bmN0aW9uKGEsYixjKXt2YXIgZCxlO2EuY2FsbCh0aGlzLGIsYyk7aWYocyh0aGlzLmNyb3NzaGFpci5sYWJlbCkmJnRoaXMuY3Jvc3NoYWlyLmxhYmVsLmVuYWJsZWQpe3ZhciBhPXRoaXMuY2hhcnQsZj10aGlzLm9wdGlvbnMuY3Jvc3NoYWlyLmxhYmVsLGc9dGhpcy5ob3JpeixoPXRoaXMub3Bwb3NpdGUsaT10aGlzLmxlZnQsaj10aGlzLnRvcCxrPVxudGhpcy5jcm9zc0xhYmVsLGwsbT1mLmZvcm1hdCxuPVwiXCIscD10aGlzLm9wdGlvbnMudGlja1Bvc2l0aW9uPT09XCJpbnNpZGVcIixyPXRoaXMuY3Jvc3NoYWlyLnNuYXAhPT0hMTtsPWc/XCJjZW50ZXJcIjpoP3RoaXMubGFiZWxBbGlnbj09PVwicmlnaHRcIj9cInJpZ2h0XCI6XCJsZWZ0XCI6dGhpcy5sYWJlbEFsaWduPT09XCJsZWZ0XCI/XCJsZWZ0XCI6XCJjZW50ZXJcIjtpZighaylrPXRoaXMuY3Jvc3NMYWJlbD1hLnJlbmRlcmVyLmxhYmVsKG51bGwsbnVsbCxudWxsLGYuc2hhcGV8fFwiY2FsbG91dFwiKS5hdHRyKHthbGlnbjpmLmFsaWdufHxsLHpJbmRleDoxMixmaWxsOmYuYmFja2dyb3VuZENvbG9yfHx0aGlzLnNlcmllc1swXSYmdGhpcy5zZXJpZXNbMF0uY29sb3J8fFwiZ3JheVwiLHBhZGRpbmc6cShmLnBhZGRpbmcsOCksc3Ryb2tlOmYuYm9yZGVyQ29sb3J8fFwiXCIsXCJzdHJva2Utd2lkdGhcIjpmLmJvcmRlcldpZHRofHwwLHI6cShmLmJvcmRlclJhZGl1cywzKX0pLmNzcyh4KHtjb2xvcjpcIndoaXRlXCIsZm9udFdlaWdodDpcIm5vcm1hbFwiLFxuZm9udFNpemU6XCIxMXB4XCIsdGV4dEFsaWduOlwiY2VudGVyXCJ9LGYuc3R5bGUpKS5hZGQoKTtnPyhsPXI/Yy5wbG90WCtpOmIuY2hhcnRYLGorPWg/MDp0aGlzLmhlaWdodCk6KGw9aD90aGlzLndpZHRoK2k6MCxqPXI/Yy5wbG90WStqOmIuY2hhcnRZKTshbSYmIWYuZm9ybWF0dGVyJiYodGhpcy5pc0RhdGV0aW1lQXhpcyYmKG49XCIlYiAlZCwgJVlcIiksbT1cInt2YWx1ZVwiKyhuP1wiOlwiK246XCJcIikrXCJ9XCIpO2I9cj9jW3RoaXMuaXNYQXhpcz9cInhcIjpcInlcIl06dGhpcy50b1ZhbHVlKGc/Yi5jaGFydFg6Yi5jaGFydFkpO2suYXR0cih7dGV4dDptP0xhKG0se3ZhbHVlOmJ9KTpmLmZvcm1hdHRlci5jYWxsKHRoaXMsYiksYW5jaG9yWDpnP2w6dGhpcy5vcHBvc2l0ZT8wOmEuY2hhcnRXaWR0aCxhbmNob3JZOmc/dGhpcy5vcHBvc2l0ZT9hLmNoYXJ0SGVpZ2h0OjA6aix4OmwseTpqLHZpc2liaWxpdHk6XCJ2aXNpYmxlXCJ9KTtiPWsuZ2V0QkJveCgpO2lmKGcpe2lmKHAmJiFofHwhcCYmaClqPWsueS1cbmIuaGVpZ2h0fWVsc2Ugaj1rLnktYi5oZWlnaHQvMjtnPyhkPWktYi54LGU9aSt0aGlzLndpZHRoLWIueCk6KGQ9dGhpcy5sYWJlbEFsaWduPT09XCJsZWZ0XCI/aTowLGU9dGhpcy5sYWJlbEFsaWduPT09XCJyaWdodFwiP2krdGhpcy53aWR0aDphLmNoYXJ0V2lkdGgpO2sudHJhbnNsYXRlWDxkJiYobCs9ZC1rLnRyYW5zbGF0ZVgpO2sudHJhbnNsYXRlWCtiLndpZHRoPj1lJiYobC09ay50cmFuc2xhdGVYK2Iud2lkdGgtZSk7ay5hdHRyKHt4OmwseTpqLHZpc2liaWxpdHk6XCJ2aXNpYmxlXCJ9KX19KTt2YXIgZ2M9aWEuaW5pdCxoYz1pYS5wcm9jZXNzRGF0YSxpYz1IYS5wcm90b3R5cGUudG9vbHRpcEZvcm1hdHRlcjtpYS5pbml0PWZ1bmN0aW9uKCl7Z2MuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuc2V0Q29tcGFyZSh0aGlzLm9wdGlvbnMuY29tcGFyZSl9O2lhLnNldENvbXBhcmU9ZnVuY3Rpb24oYSl7dGhpcy5tb2RpZnlWYWx1ZT1hPT09XCJ2YWx1ZVwifHxhPT09XCJwZXJjZW50XCI/ZnVuY3Rpb24oYixcbmMpe3ZhciBkPXRoaXMuY29tcGFyZVZhbHVlO2lmKGIhPT10JiYoYj1hPT09XCJ2YWx1ZVwiP2ItZDpiPTEwMCooYi9kKS0xMDAsYykpYy5jaGFuZ2U9YjtyZXR1cm4gYn06bnVsbDtpZih0aGlzLmNoYXJ0Lmhhc1JlbmRlcmVkKXRoaXMuaXNEaXJ0eT0hMH07aWEucHJvY2Vzc0RhdGE9ZnVuY3Rpb24oKXt2YXIgYSxiPS0xLGMsZCxlLGY7aGMuYXBwbHkodGhpcyxhcmd1bWVudHMpO2lmKHRoaXMueEF4aXMmJnRoaXMucHJvY2Vzc2VkWURhdGEpe2M9dGhpcy5wcm9jZXNzZWRYRGF0YTtkPXRoaXMucHJvY2Vzc2VkWURhdGE7ZT1kLmxlbmd0aDt0aGlzLnBvaW50QXJyYXlNYXAmJihiPXNhKHRoaXMucG9pbnRWYWxLZXl8fFwieVwiLHRoaXMucG9pbnRBcnJheU1hcCkpO2ZvcihhPTA7YTxlO2ErKylpZihmPWI+LTE/ZFthXVtiXTpkW2FdLHR5cGVvZiBmPT09XCJudW1iZXJcIiYmY1thXT49dGhpcy54QXhpcy5taW4mJmYhPT0wKXt0aGlzLmNvbXBhcmVWYWx1ZT1mO2JyZWFrfX19O1UoaWEsXCJnZXRFeHRyZW1lc1wiLFxuZnVuY3Rpb24oYSl7dmFyIGI7YS5hcHBseSh0aGlzLFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpKTtpZih0aGlzLm1vZGlmeVZhbHVlKWI9W3RoaXMubW9kaWZ5VmFsdWUodGhpcy5kYXRhTWluKSx0aGlzLm1vZGlmeVZhbHVlKHRoaXMuZGF0YU1heCldLHRoaXMuZGF0YU1pbj1PYShiKSx0aGlzLmRhdGFNYXg9RWEoYil9KTtJLnByb3RvdHlwZS5zZXRDb21wYXJlPWZ1bmN0aW9uKGEsYil7dGhpcy5pc1hBeGlzfHwobih0aGlzLnNlcmllcyxmdW5jdGlvbihiKXtiLnNldENvbXBhcmUoYSl9KSxxKGIsITApJiZ0aGlzLmNoYXJ0LnJlZHJhdygpKX07SGEucHJvdG90eXBlLnRvb2x0aXBGb3JtYXR0ZXI9ZnVuY3Rpb24oYSl7YT1hLnJlcGxhY2UoXCJ7cG9pbnQuY2hhbmdlfVwiLCh0aGlzLmNoYW5nZT4wP1wiK1wiOlwiXCIpK3oubnVtYmVyRm9ybWF0KHRoaXMuY2hhbmdlLHEodGhpcy5zZXJpZXMudG9vbHRpcE9wdGlvbnMuY2hhbmdlRGVjaW1hbHMsMikpKTtyZXR1cm4gaWMuYXBwbHkodGhpcyxcblthXSl9O1UoUS5wcm90b3R5cGUsXCJyZW5kZXJcIixmdW5jdGlvbihhKXtpZih0aGlzLmNoYXJ0Lm9wdGlvbnMuX3N0b2NrJiZ0aGlzLnhBeGlzKSF0aGlzLmNsaXBCb3gmJnRoaXMuYW5pbWF0ZT8odGhpcy5jbGlwQm94PUModGhpcy5jaGFydC5jbGlwQm94KSx0aGlzLmNsaXBCb3gud2lkdGg9dGhpcy54QXhpcy5sZW4sdGhpcy5jbGlwQm94LmhlaWdodD10aGlzLnlBeGlzLmxlbik6dGhpcy5jaGFydFt0aGlzLnNoYXJlZENsaXBLZXldJiYoVGEodGhpcy5jaGFydFt0aGlzLnNoYXJlZENsaXBLZXldKSx0aGlzLmNoYXJ0W3RoaXMuc2hhcmVkQ2xpcEtleV0uYXR0cih7d2lkdGg6dGhpcy54QXhpcy5sZW4saGVpZ2h0OnRoaXMueUF4aXMubGVufSkpO2EuY2FsbCh0aGlzKX0pO3goeix7Q29sb3I6d2EsUG9pbnQ6SGEsVGljazpjYixSZW5kZXJlcjpZYSxTVkdFbGVtZW50OlosU1ZHUmVuZGVyZXI6eWEsYXJyYXlNaW46T2EsYXJyYXlNYXg6RWEsY2hhcnRzOiQsY29ycmVjdEZsb2F0Om5hLFxuZGF0ZUZvcm1hdDptYSxlcnJvcjpnYSxmb3JtYXQ6TGEscGF0aEFuaW06dm9pZCAwLGdldE9wdGlvbnM6ZnVuY3Rpb24oKXtyZXR1cm4gTn0saGFzQmlkaUJ1ZzpaYixpc1RvdWNoRGV2aWNlOmtiLHNldE9wdGlvbnM6ZnVuY3Rpb24oYSl7Tj1DKCEwLE4sYSk7T2IoKTtyZXR1cm4gTn0sYWRkRXZlbnQ6RCxyZW1vdmVFdmVudDpULGNyZWF0ZUVsZW1lbnQ6ZWEsZGlzY2FyZEVsZW1lbnQ6VmEsY3NzOkYsZWFjaDpuLG1hcDp0YSxtZXJnZTpDLHNwbGF0OnZhLHN0YWJsZVNvcnQ6b2IsZXh0ZW5kQ2xhc3M6bGEscEludDpHLHN2ZzpqYSxjYW52YXM6cWEsdm1sOiFqYSYmIXFhLHByb2R1Y3Q6XCJIaWdoc3RvY2tcIix2ZXJzaW9uOlwiNC4yLjRcIn0pO3JldHVybiB6fSk7XG4iLCIvKipcbipcbioganF1ZXJ5LnNwYXJrbGluZS5qc1xuKlxuKiB2Mi4zLjJcbiogKGMpIFNwbHVuaywgSW5jXG4qIENvbnRhY3Q6IEdhcmV0aCBXYXR0cyAoZ2FyZXRoQHNwbHVuay5jb20pXG4qIGh0dHA6Ly9vbW5pcG90ZW50Lm5ldC9qcXVlcnkuc3BhcmtsaW5lL1xuKlxuKiBHZW5lcmF0ZXMgaW5saW5lIHNwYXJrbGluZSBjaGFydHMgZnJvbSBkYXRhIHN1cHBsaWVkIGVpdGhlciB0byB0aGUgbWV0aG9kXG4qIG9yIGlubGluZSBpbiBIVE1MXG4qXG4qIENvbXBhdGlibGUgd2l0aCBJbnRlcm5ldCBFeHBsb3JlciA2LjArIGFuZCBtb2Rlcm4gYnJvd3NlcnMgZXF1aXBwZWQgd2l0aCB0aGUgY2FudmFzIHRhZ1xuKiAoRmlyZWZveCAyLjArLCBTYWZhcmksIE9wZXJhLCBldGMpXG4qXG4qIExpY2Vuc2U6IE5ldyBCU0QgTGljZW5zZVxuKlxuKiBDb3B5cmlnaHQgKGMpIDIwMTIsIFNwbHVuayBJbmMuXG4qIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4qXG4qIFJlZGlzdHJpYnV0aW9uIGFuZCB1c2UgaW4gc291cmNlIGFuZCBiaW5hcnkgZm9ybXMsIHdpdGggb3Igd2l0aG91dCBtb2RpZmljYXRpb24sXG4qIGFyZSBwZXJtaXR0ZWQgcHJvdmlkZWQgdGhhdCB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnMgYXJlIG1ldDpcbipcbiogICAgICogUmVkaXN0cmlidXRpb25zIG9mIHNvdXJjZSBjb2RlIG11c3QgcmV0YWluIHRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlLFxuKiAgICAgICB0aGlzIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQgdGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyLlxuKiAgICAgKiBSZWRpc3RyaWJ1dGlvbnMgaW4gYmluYXJ5IGZvcm0gbXVzdCByZXByb2R1Y2UgdGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UsXG4qICAgICAgIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIgaW4gdGhlIGRvY3VtZW50YXRpb25cbiogICAgICAgYW5kL29yIG90aGVyIG1hdGVyaWFscyBwcm92aWRlZCB3aXRoIHRoZSBkaXN0cmlidXRpb24uXG4qICAgICAqIE5laXRoZXIgdGhlIG5hbWUgb2YgU3BsdW5rIEluYyBub3IgdGhlIG5hbWVzIG9mIGl0cyBjb250cmlidXRvcnMgbWF5XG4qICAgICAgIGJlIHVzZWQgdG8gZW5kb3JzZSBvciBwcm9tb3RlIHByb2R1Y3RzIGRlcml2ZWQgZnJvbSB0aGlzIHNvZnR3YXJlIHdpdGhvdXRcbiogICAgICAgc3BlY2lmaWMgcHJpb3Igd3JpdHRlbiBwZXJtaXNzaW9uLlxuKlxuKiBUSElTIFNPRlRXQVJFIElTIFBST1ZJREVEIEJZIFRIRSBDT1BZUklHSFQgSE9MREVSUyBBTkQgQ09OVFJJQlVUT1JTIFwiQVMgSVNcIiBBTkQgQU5ZXG4qIEVYUFJFU1MgT1IgSU1QTElFRCBXQVJSQU5USUVTLCBJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRCBUTywgVEhFIElNUExJRUQgV0FSUkFOVElFU1xuKiBPRiBNRVJDSEFOVEFCSUxJVFkgQU5EIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFSRSBESVNDTEFJTUVELiBJTiBOTyBFVkVOVFxuKiBTSEFMTCBUSEUgQ09QWVJJR0hUIE9XTkVSIE9SIENPTlRSSUJVVE9SUyBCRSBMSUFCTEUgRk9SIEFOWSBESVJFQ1QsIElORElSRUNULCBJTkNJREVOVEFMLFxuKiBTUEVDSUFMLCBFWEVNUExBUlksIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyAoSU5DTFVESU5HLCBCVVQgTk9UIExJTUlURUQgVE8sIFBST0NVUkVNRU5UXG4qIE9GIFNVQlNUSVRVVEUgR09PRFMgT1IgU0VSVklDRVM7IExPU1MgT0YgVVNFLCBEQVRBLCBPUiBQUk9GSVRTOyBPUiBCVVNJTkVTUyBJTlRFUlJVUFRJT04pXG4qIEhPV0VWRVIgQ0FVU0VEIEFORCBPTiBBTlkgVEhFT1JZIE9GIExJQUJJTElUWSwgV0hFVEhFUiBJTiBDT05UUkFDVCwgU1RSSUNUIExJQUJJTElUWSxcbiogT1IgVE9SVCAoSU5DTFVESU5HIE5FR0xJR0VOQ0UgT1IgT1RIRVJXSVNFKSBBUklTSU5HIElOIEFOWSBXQVkgT1VUIE9GIFRIRSBVU0UgT0YgVEhJU1xuKiBTT0ZUV0FSRSwgRVZFTiBJRiBBRFZJU0VEIE9GIFRIRSBQT1NTSUJJTElUWSBPRiBTVUNIIERBTUFHRS5cbipcbipcbiogVXNhZ2U6XG4qICAkKHNlbGVjdG9yKS5zcGFya2xpbmUodmFsdWVzLCBvcHRpb25zKVxuKlxuKiBJZiB2YWx1ZXMgaXMgdW5kZWZpbmVkIG9yIHNldCB0byAnaHRtbCcgdGhlbiB0aGUgZGF0YSB2YWx1ZXMgYXJlIHJlYWQgZnJvbSB0aGUgc3BlY2lmaWVkIHRhZzpcbiogICA8cD5TcGFya2xpbmU6IDxzcGFuIGNsYXNzPVwic3BhcmtsaW5lXCI+MSw0LDYsNiw4LDUsMyw1PC9zcGFuPjwvcD5cbiogICAkKCcuc3BhcmtsaW5lJykuc3BhcmtsaW5lKCk7XG4qIFRoZXJlIG11c3QgYmUgbm8gc3BhY2VzIGluIHRoZSBlbmNsb3NlZCBkYXRhIHNldFxuKlxuKiBPdGhlcndpc2UgdmFsdWVzIG11c3QgYmUgYW4gYXJyYXkgb2YgbnVtYmVycyBvciBudWxsIHZhbHVlc1xuKiAgICA8cD5TcGFya2xpbmU6IDxzcGFuIGlkPVwic3BhcmtsaW5lMVwiPlRoaXMgdGV4dCByZXBsYWNlZCBpZiB0aGUgYnJvd3NlciBpcyBjb21wYXRpYmxlPC9zcGFuPjwvcD5cbiogICAgJCgnI3NwYXJrbGluZTEnKS5zcGFya2xpbmUoWzEsNCw2LDYsOCw1LDMsNV0pXG4qICAgICQoJyNzcGFya2xpbmUyJykuc3BhcmtsaW5lKFsxLDQsNixudWxsLG51bGwsNSwzLDVdKVxuKlxuKiBWYWx1ZXMgY2FuIGFsc28gYmUgc3BlY2lmaWVkIGluIGFuIEhUTUwgY29tbWVudCwgb3IgYXMgYSB2YWx1ZXMgYXR0cmlidXRlOlxuKiAgICA8cD5TcGFya2xpbmU6IDxzcGFuIGNsYXNzPVwic3BhcmtsaW5lXCI+PCEtLTEsNCw2LDYsOCw1LDMsNSAtLT48L3NwYW4+PC9wPlxuKiAgICA8cD5TcGFya2xpbmU6IDxzcGFuIGNsYXNzPVwic3BhcmtsaW5lXCIgdmFsdWVzPVwiMSw0LDYsNiw4LDUsMyw1XCI+PC9zcGFuPjwvcD5cbiogICAgJCgnLnNwYXJrbGluZScpLnNwYXJrbGluZSgpO1xuKlxuKiBGb3IgbGluZSBjaGFydHMsIHggdmFsdWVzIGNhbiBhbHNvIGJlIHNwZWNpZmllZDpcbiogICA8cD5TcGFya2xpbmU6IDxzcGFuIGNsYXNzPVwic3BhcmtsaW5lXCI+MToxLDIuNzo0LDMuNDo2LDU6Niw2OjgsOC43OjUsOTozLDEwOjU8L3NwYW4+PC9wPlxuKiAgICAkKCcjc3BhcmtsaW5lMScpLnNwYXJrbGluZShbIFsxLDFdLCBbMi43LDRdLCBbMy40LDZdLCBbNSw2XSwgWzYsOF0sIFs4LjcsNV0sIFs5LDNdLCBbMTAsNV0gXSlcbipcbiogQnkgZGVmYXVsdCwgb3B0aW9ucyBzaG91bGQgYmUgcGFzc2VkIGluIGFzIHRoZSBzZWNvbmQgYXJndW1lbnQgdG8gdGhlIHNwYXJrbGluZSBmdW5jdGlvbjpcbiogICAkKCcuc3BhcmtsaW5lJykuc3BhcmtsaW5lKFsxLDIsMyw0XSwge3R5cGU6ICdiYXInfSlcbipcbiogT3B0aW9ucyBjYW4gYWxzbyBiZSBzZXQgYnkgcGFzc2luZyB0aGVtIG9uIHRoZSB0YWcgaXRzZWxmLiAgVGhpcyBmZWF0dXJlIGlzIGRpc2FibGVkIGJ5IGRlZmF1bHQgdGhvdWdoXG4qIGFzIHRoZXJlJ3MgYSBzbGlnaHQgcGVyZm9ybWFuY2Ugb3ZlcmhlYWQ6XG4qICAgJCgnLnNwYXJrbGluZScpLnNwYXJrbGluZShbMSwyLDMsNF0sIHtlbmFibGVUYWdPcHRpb25zOiB0cnVlfSlcbiogICA8cD5TcGFya2xpbmU6IDxzcGFuIGNsYXNzPVwic3BhcmtsaW5lXCIgc3BhcmtUeXBlPVwiYmFyXCIgc3BhcmtCYXJDb2xvcj1cInJlZFwiPmxvYWRpbmc8L3NwYW4+PC9wPlxuKiBQcmVmaXggYWxsIG9wdGlvbnMgc3VwcGxpZWQgYXMgdGFnIGF0dHJpYnV0ZSB3aXRoIFwic3BhcmtcIiAoY29uZmlndXJhYmxlIGJ5IHNldHRpbmcgdGFnT3B0aW9uc1ByZWZpeClcbipcbiogU3VwcG9ydGVkIG9wdGlvbnM6XG4qICAgbGluZUNvbG9yIC0gQ29sb3Igb2YgdGhlIGxpbmUgdXNlZCBmb3IgdGhlIGNoYXJ0XG4qICAgZmlsbENvbG9yIC0gQ29sb3IgdXNlZCB0byBmaWxsIGluIHRoZSBjaGFydCAtIFNldCB0byAnJyBvciBmYWxzZSBmb3IgYSB0cmFuc3BhcmVudCBjaGFydFxuKiAgIHdpZHRoIC0gV2lkdGggb2YgdGhlIGNoYXJ0IC0gRGVmYXVsdHMgdG8gMyB0aW1lcyB0aGUgbnVtYmVyIG9mIHZhbHVlcyBpbiBwaXhlbHNcbiogICBoZWlnaHQgLSBIZWlnaHQgb2YgdGhlIGNoYXJ0IC0gRGVmYXVsdHMgdG8gdGhlIGhlaWdodCBvZiB0aGUgY29udGFpbmluZyBlbGVtZW50XG4qICAgY2hhcnRSYW5nZU1pbiAtIFNwZWNpZnkgdGhlIG1pbmltdW0gdmFsdWUgdG8gdXNlIGZvciB0aGUgWSByYW5nZSBvZiB0aGUgY2hhcnQgLSBEZWZhdWx0cyB0byB0aGUgbWluaW11bSB2YWx1ZSBzdXBwbGllZFxuKiAgIGNoYXJ0UmFuZ2VNYXggLSBTcGVjaWZ5IHRoZSBtYXhpbXVtIHZhbHVlIHRvIHVzZSBmb3IgdGhlIFkgcmFuZ2Ugb2YgdGhlIGNoYXJ0IC0gRGVmYXVsdHMgdG8gdGhlIG1heGltdW0gdmFsdWUgc3VwcGxpZWRcbiogICBjaGFydFJhbmdlQ2xpcCAtIENsaXAgb3V0IG9mIHJhbmdlIHZhbHVlcyB0byB0aGUgbWF4L21pbiBzcGVjaWZpZWQgYnkgY2hhcnRSYW5nZU1pbiBhbmQgY2hhcnRSYW5nZU1heFxuKiAgIGNoYXJ0UmFuZ2VNaW5YIC0gU3BlY2lmeSB0aGUgbWluaW11bSB2YWx1ZSB0byB1c2UgZm9yIHRoZSBYIHJhbmdlIG9mIHRoZSBjaGFydCAtIERlZmF1bHRzIHRvIHRoZSBtaW5pbXVtIHZhbHVlIHN1cHBsaWVkXG4qICAgY2hhcnRSYW5nZU1heFggLSBTcGVjaWZ5IHRoZSBtYXhpbXVtIHZhbHVlIHRvIHVzZSBmb3IgdGhlIFggcmFuZ2Ugb2YgdGhlIGNoYXJ0IC0gRGVmYXVsdHMgdG8gdGhlIG1heGltdW0gdmFsdWUgc3VwcGxpZWRcbiogICBjb21wb3NpdGUgLSBJZiB0cnVlIHRoZW4gZG9uJ3QgZXJhc2UgYW55IGV4aXN0aW5nIGNoYXJ0IGF0dGFjaGVkIHRvIHRoZSB0YWcsIGJ1dCBkcmF3XG4qICAgICAgICAgICBhbm90aGVyIGNoYXJ0IG92ZXIgdGhlIHRvcCAtIE5vdGUgdGhhdCB3aWR0aCBhbmQgaGVpZ2h0IGFyZSBpZ25vcmVkIGlmIGFuXG4qICAgICAgICAgICBleGlzdGluZyBjaGFydCBpcyBkZXRlY3RlZC5cbiogICB0YWdWYWx1ZXNBdHRyaWJ1dGUgLSBOYW1lIG9mIHRhZyBhdHRyaWJ1dGUgdG8gY2hlY2sgZm9yIGRhdGEgdmFsdWVzIC0gRGVmYXVsdHMgdG8gJ3ZhbHVlcydcbiogICBlbmFibGVUYWdPcHRpb25zIC0gV2hldGhlciB0byBjaGVjayB0YWdzIGZvciBzcGFya2xpbmUgb3B0aW9uc1xuKiAgIHRhZ09wdGlvbnNQcmVmaXggLSBQcmVmaXggdXNlZCBmb3Igb3B0aW9ucyBzdXBwbGllZCBhcyB0YWcgYXR0cmlidXRlcyAtIERlZmF1bHRzIHRvICdzcGFyaydcbiogICBkaXNhYmxlSGlkZGVuQ2hlY2sgLSBJZiBzZXQgdG8gdHJ1ZSwgdGhlbiB0aGUgcGx1Z2luIHdpbGwgYXNzdW1lIHRoYXQgY2hhcnRzIHdpbGwgbmV2ZXIgYmUgZHJhd24gaW50byBhXG4qICAgICAgICAgICBoaWRkZW4gZG9tIGVsZW1lbnQsIGF2b2RpbmcgYSBicm93c2VyIHJlZmxvd1xuKiAgIGRpc2FibGVJbnRlcmFjdGlvbiAtIElmIHNldCB0byB0cnVlIHRoZW4gYWxsIG1vdXNlb3Zlci9jbGljayBpbnRlcmFjdGlvbiBiZWhhdmlvdXIgd2lsbCBiZSBkaXNhYmxlZCxcbiogICAgICAgbWFraW5nIHRoZSBwbHVnaW4gcGVyZm9ybSBtdWNoIGxpa2UgaXQgZGlkIGluIDEueFxuKiAgIGRpc2FibGVUb29sdGlwcyAtIElmIHNldCB0byB0cnVlIHRoZW4gdG9vbHRpcHMgd2lsbCBiZSBkaXNhYmxlZCAtIERlZmF1bHRzIHRvIGZhbHNlICh0b29sdGlwcyBlbmFibGVkKVxuKiAgIGRpc2FibGVIaWdobGlnaHQgLSBJZiBzZXQgdG8gdHJ1ZSB0aGVuIGhpZ2hsaWdodGluZyBvZiBzZWxlY3RlZCBjaGFydCBlbGVtZW50cyBvbiBtb3VzZW92ZXIgd2lsbCBiZSBkaXNhYmxlZFxuKiAgICAgICBkZWZhdWx0cyB0byBmYWxzZSAoaGlnaGxpZ2h0cyBlbmFibGVkKVxuKiAgIGhpZ2hsaWdodExpZ2h0ZW4gLSBGYWN0b3IgdG8gbGlnaHRlbi9kYXJrZW4gaGlnaGxpZ2h0ZWQgY2hhcnQgdmFsdWVzIGJ5IC0gRGVmYXVsdHMgdG8gMS40IGZvciBhIDQwJSBpbmNyZWFzZVxuKiAgIHRvb2x0aXBDb250YWluZXIgLSBTcGVjaWZ5IHdoaWNoIERPTSBlbGVtZW50IHRoZSB0b29sdGlwIHNob3VsZCBiZSByZW5kZXJlZCBpbnRvIC0gZGVmYXVsdHMgdG8gZG9jdW1lbnQuYm9keVxuKiAgIHRvb2x0aXBDbGFzc25hbWUgLSBPcHRpb25hbCBDU1MgY2xhc3NuYW1lIHRvIGFwcGx5IHRvIHRvb2x0aXBzIC0gSWYgbm90IHNwZWNpZmllZCB0aGVuIGEgZGVmYXVsdCBzdHlsZSB3aWxsIGJlIGFwcGxpZWRcbiogICB0b29sdGlwT2Zmc2V0WCAtIEhvdyBtYW55IHBpeGVscyBhd2F5IGZyb20gdGhlIG1vdXNlIHBvaW50ZXIgdG8gcmVuZGVyIHRoZSB0b29sdGlwIG9uIHRoZSBYIGF4aXNcbiogICB0b29sdGlwT2Zmc2V0WSAtIEhvdyBtYW55IHBpeGVscyBhd2F5IGZyb20gdGhlIG1vdXNlIHBvaW50ZXIgdG8gcmVuZGVyIHRoZSB0b29sdGlwIG9uIHRoZSByIGF4aXNcbiogICB0b29sdGlwRm9ybWF0dGVyICAtIE9wdGlvbmFsIGNhbGxiYWNrIHRoYXQgYWxsb3dzIHlvdSB0byBvdmVycmlkZSB0aGUgSFRNTCBkaXNwbGF5ZWQgaW4gdGhlIHRvb2x0aXBcbiogICAgICAgY2FsbGJhY2sgaXMgZ2l2ZW4gYXJndW1lbnRzIG9mIChzcGFya2xpbmUsIG9wdGlvbnMsIGZpZWxkcylcbiogICB0b29sdGlwQ2hhcnRUaXRsZSAtIElmIHNwZWNpZmllZCB0aGVuIHRoZSB0b29sdGlwIHVzZXMgdGhlIHN0cmluZyBzcGVjaWZpZWQgYnkgdGhpcyBzZXR0aW5nIGFzIGEgdGl0bGVcbiogICB0b29sdGlwRm9ybWF0IC0gQSBmb3JtYXQgc3RyaW5nIG9yIFNQRm9ybWF0IG9iamVjdCAgKG9yIGFuIGFycmF5IHRoZXJlb2YgZm9yIG11bHRpcGxlIGVudHJpZXMpXG4qICAgICAgIHRvIGNvbnRyb2wgdGhlIGZvcm1hdCBvZiB0aGUgdG9vbHRpcFxuKiAgIHRvb2x0aXBQcmVmaXggLSBBIHN0cmluZyB0byBwcmVwZW5kIHRvIGVhY2ggZmllbGQgZGlzcGxheWVkIGluIGEgdG9vbHRpcFxuKiAgIHRvb2x0aXBTdWZmaXggLSBBIHN0cmluZyB0byBhcHBlbmQgdG8gZWFjaCBmaWVsZCBkaXNwbGF5ZWQgaW4gYSB0b29sdGlwXG4qICAgdG9vbHRpcFNraXBOdWxsIC0gSWYgdHJ1ZSB0aGVuIG51bGwgdmFsdWVzIHdpbGwgbm90IGhhdmUgYSB0b29sdGlwIGRpc3BsYXllZCAoZGVmYXVsdHMgdG8gdHJ1ZSlcbiogICB0b29sdGlwVmFsdWVMb29rdXBzIC0gQW4gb2JqZWN0IG9yIHJhbmdlIG1hcCB0byBtYXAgZmllbGQgdmFsdWVzIHRvIHRvb2x0aXAgc3RyaW5nc1xuKiAgICAgICAoZWcuIHRvIG1hcCAtMSB0byBcIkxvc3RcIiwgMCB0byBcIkRyYXdcIiwgYW5kIDEgdG8gXCJXaW5cIilcbiogICBudW1iZXJGb3JtYXR0ZXIgLSBPcHRpb25hbCBjYWxsYmFjayBmb3IgZm9ybWF0dGluZyBudW1iZXJzIGluIHRvb2x0aXBzXG4qICAgbnVtYmVyRGlnaXRHcm91cFNlcCAtIENoYXJhY3RlciB0byB1c2UgZm9yIGdyb3VwIHNlcGFyYXRvciBpbiBudW1iZXJzIFwiMSwyMzRcIiAtIERlZmF1bHRzIHRvIFwiLFwiXG4qICAgbnVtYmVyRGVjaW1hbE1hcmsgLSBDaGFyYWN0ZXIgdG8gdXNlIGZvciB0aGUgZGVjaW1hbCBwb2ludCB3aGVuIGZvcm1hdHRpbmcgbnVtYmVycyAtIERlZmF1bHRzIHRvIFwiLlwiXG4qICAgbnVtYmVyRGlnaXRHcm91cENvdW50IC0gTnVtYmVyIG9mIGRpZ2l0cyBiZXR3ZWVuIGdyb3VwIHNlcGFyYXRvciAtIERlZmF1bHRzIHRvIDNcbipcbiogVGhlcmUgYXJlIDcgdHlwZXMgb2Ygc3BhcmtsaW5lLCBzZWxlY3RlZCBieSBzdXBwbHlpbmcgYSBcInR5cGVcIiBvcHRpb24gb2YgJ2xpbmUnIChkZWZhdWx0KSxcbiogJ2JhcicsICd0cmlzdGF0ZScsICdidWxsZXQnLCAnZGlzY3JldGUnLCAncGllJyBvciAnYm94J1xuKiAgICBsaW5lIC0gTGluZSBjaGFydC4gIE9wdGlvbnM6XG4qICAgICAgIHNwb3RDb2xvciAtIFNldCB0byAnJyB0byBub3QgZW5kIGVhY2ggbGluZSBpbiBhIGNpcmN1bGFyIHNwb3RcbiogICAgICAgbWluU3BvdENvbG9yIC0gSWYgc2V0LCBjb2xvciBvZiBzcG90IGF0IG1pbmltdW0gdmFsdWVcbiogICAgICAgbWF4U3BvdENvbG9yIC0gSWYgc2V0LCBjb2xvciBvZiBzcG90IGF0IG1heGltdW0gdmFsdWVcbiogICAgICAgc3BvdFJhZGl1cyAtIFJhZGl1cyBpbiBwaXhlbHNcbiogICAgICAgbGluZVdpZHRoIC0gV2lkdGggb2YgbGluZSBpbiBwaXhlbHNcbiogICAgICAgbm9ybWFsUmFuZ2VNaW5cbiogICAgICAgbm9ybWFsUmFuZ2VNYXggLSBJZiBzZXQgZHJhd3MgYSBmaWxsZWQgaG9yaXpvbnRhbCBiYXIgYmV0d2VlbiB0aGVzZSB0d28gdmFsdWVzIG1hcmtpbmcgdGhlIFwibm9ybWFsXCJcbiogICAgICAgICAgICAgICAgICAgICAgb3IgZXhwZWN0ZWQgcmFuZ2Ugb2YgdmFsdWVzXG4qICAgICAgIG5vcm1hbFJhbmdlQ29sb3IgLSBDb2xvciB0byB1c2UgZm9yIHRoZSBhYm92ZSBiYXJcbiogICAgICAgZHJhd05vcm1hbE9uVG9wIC0gRHJhdyB0aGUgbm9ybWFsIHJhbmdlIGFib3ZlIHRoZSBjaGFydCBmaWxsIGNvbG9yIGlmIHRydWVcbiogICAgICAgZGVmYXVsdFBpeGVsc1BlclZhbHVlIC0gRGVmYXVsdHMgdG8gMyBwaXhlbHMgb2Ygd2lkdGggZm9yIGVhY2ggdmFsdWUgaW4gdGhlIGNoYXJ0XG4qICAgICAgIGhpZ2hsaWdodFNwb3RDb2xvciAtIFRoZSBjb2xvciB0byB1c2UgZm9yIGRyYXdpbmcgYSBoaWdobGlnaHQgc3BvdCBvbiBtb3VzZW92ZXIgLSBTZXQgdG8gbnVsbCB0byBkaXNhYmxlXG4qICAgICAgIGhpZ2hsaWdodExpbmVDb2xvciAtIFRoZSBjb2xvciB0byB1c2UgZm9yIGRyYXdpbmcgYSBoaWdobGlnaHQgbGluZSBvbiBtb3VzZW92ZXIgLSBTZXQgdG8gbnVsbCB0byBkaXNhYmxlXG4qICAgICAgIHZhbHVlU3BvdHMgLSBTcGVjaWZ5IHdoaWNoIHBvaW50cyB0byBkcmF3IHNwb3RzIG9uLCBhbmQgaW4gd2hpY2ggY29sb3IuICBBY2NlcHRzIGEgcmFuZ2UgbWFwXG4qXG4qICAgYmFyIC0gQmFyIGNoYXJ0LiAgT3B0aW9uczpcbiogICAgICAgYmFyQ29sb3IgLSBDb2xvciBvZiBiYXJzIGZvciBwb3N0aXZlIHZhbHVlc1xuKiAgICAgICBuZWdCYXJDb2xvciAtIENvbG9yIG9mIGJhcnMgZm9yIG5lZ2F0aXZlIHZhbHVlc1xuKiAgICAgICB6ZXJvQ29sb3IgLSBDb2xvciBvZiBiYXJzIHdpdGggemVybyB2YWx1ZXNcbiogICAgICAgbnVsbENvbG9yIC0gQ29sb3Igb2YgYmFycyB3aXRoIG51bGwgdmFsdWVzIC0gRGVmYXVsdHMgdG8gb21pdHRpbmcgdGhlIGJhciBlbnRpcmVseVxuKiAgICAgICBiYXJXaWR0aCAtIFdpZHRoIG9mIGJhcnMgaW4gcGl4ZWxzXG4qICAgICAgIGNvbG9yTWFwIC0gT3B0aW9uYWwgbWFwcG5pZyBvZiB2YWx1ZXMgdG8gY29sb3JzIHRvIG92ZXJyaWRlIHRoZSAqQmFyQ29sb3IgdmFsdWVzIGFib3ZlXG4qICAgICAgICAgICAgICAgICAgY2FuIGJlIGFuIEFycmF5IG9mIHZhbHVlcyB0byBjb250cm9sIHRoZSBjb2xvciBvZiBpbmRpdmlkdWFsIGJhcnMgb3IgYSByYW5nZSBtYXBcbiogICAgICAgICAgICAgICAgICB0byBzcGVjaWZ5IGNvbG9ycyBmb3IgaW5kaXZpZHVhbCByYW5nZXMgb2YgdmFsdWVzXG4qICAgICAgIGJhclNwYWNpbmcgLSBHYXAgYmV0d2VlbiBiYXJzIGluIHBpeGVsc1xuKiAgICAgICB6ZXJvQXhpcyAtIENlbnRlcnMgdGhlIHktYXhpcyBhcm91bmQgemVybyBpZiB0cnVlXG4qXG4qICAgdHJpc3RhdGUgLSBDaGFydHMgdmFsdWVzIG9mIHdpbiAoPjApLCBsb3NlICg8MCkgb3IgZHJhdyAoPTApXG4qICAgICAgIHBvc0JhckNvbG9yIC0gQ29sb3Igb2Ygd2luIHZhbHVlc1xuKiAgICAgICBuZWdCYXJDb2xvciAtIENvbG9yIG9mIGxvc2UgdmFsdWVzXG4qICAgICAgIHplcm9CYXJDb2xvciAtIENvbG9yIG9mIGRyYXcgdmFsdWVzXG4qICAgICAgIGJhcldpZHRoIC0gV2lkdGggb2YgYmFycyBpbiBwaXhlbHNcbiogICAgICAgYmFyU3BhY2luZyAtIEdhcCBiZXR3ZWVuIGJhcnMgaW4gcGl4ZWxzXG4qICAgICAgIGNvbG9yTWFwIC0gT3B0aW9uYWwgbWFwcG5pZyBvZiB2YWx1ZXMgdG8gY29sb3JzIHRvIG92ZXJyaWRlIHRoZSAqQmFyQ29sb3IgdmFsdWVzIGFib3ZlXG4qICAgICAgICAgICAgICAgICAgY2FuIGJlIGFuIEFycmF5IG9mIHZhbHVlcyB0byBjb250cm9sIHRoZSBjb2xvciBvZiBpbmRpdmlkdWFsIGJhcnMgb3IgYSByYW5nZSBtYXBcbiogICAgICAgICAgICAgICAgICB0byBzcGVjaWZ5IGNvbG9ycyBmb3IgaW5kaXZpZHVhbCByYW5nZXMgb2YgdmFsdWVzXG4qXG4qICAgZGlzY3JldGUgLSBPcHRpb25zOlxuKiAgICAgICBsaW5lSGVpZ2h0IC0gSGVpZ2h0IG9mIGVhY2ggbGluZSBpbiBwaXhlbHMgLSBEZWZhdWx0cyB0byAzMCUgb2YgdGhlIGdyYXBoIGhlaWdodFxuKiAgICAgICB0aGVzaG9sZFZhbHVlIC0gVmFsdWVzIGxlc3MgdGhhbiB0aGlzIHZhbHVlIHdpbGwgYmUgZHJhd24gdXNpbmcgdGhyZXNob2xkQ29sb3IgaW5zdGVhZCBvZiBsaW5lQ29sb3JcbiogICAgICAgdGhyZXNob2xkQ29sb3JcbipcbiogICBidWxsZXQgLSBWYWx1ZXMgZm9yIGJ1bGxldCBncmFwaHMgbXN1dCBiZSBpbiB0aGUgb3JkZXI6IHRhcmdldCwgcGVyZm9ybWFuY2UsIHJhbmdlMSwgcmFuZ2UyLCByYW5nZTMsIC4uLlxuKiAgICAgICBvcHRpb25zOlxuKiAgICAgICB0YXJnZXRDb2xvciAtIFRoZSBjb2xvciBvZiB0aGUgdmVydGljYWwgdGFyZ2V0IG1hcmtlclxuKiAgICAgICB0YXJnZXRXaWR0aCAtIFRoZSB3aWR0aCBvZiB0aGUgdGFyZ2V0IG1hcmtlciBpbiBwaXhlbHNcbiogICAgICAgcGVyZm9ybWFuY2VDb2xvciAtIFRoZSBjb2xvciBvZiB0aGUgcGVyZm9ybWFuY2UgbWVhc3VyZSBob3Jpem9udGFsIGJhclxuKiAgICAgICByYW5nZUNvbG9ycyAtIENvbG9ycyB0byB1c2UgZm9yIGVhY2ggcXVhbGl0YXRpdmUgcmFuZ2UgYmFja2dyb3VuZCBjb2xvclxuKlxuKiAgIHBpZSAtIFBpZSBjaGFydC4gT3B0aW9uczpcbiogICAgICAgc2xpY2VDb2xvcnMgLSBBbiBhcnJheSBvZiBjb2xvcnMgdG8gdXNlIGZvciBwaWUgc2xpY2VzXG4qICAgICAgIG9mZnNldCAtIEFuZ2xlIGluIGRlZ3JlZXMgdG8gb2Zmc2V0IHRoZSBmaXJzdCBzbGljZSAtIFRyeSAtOTAgb3IgKzkwXG4qICAgICAgIGJvcmRlcldpZHRoIC0gV2lkdGggb2YgYm9yZGVyIHRvIGRyYXcgYXJvdW5kIHRoZSBwaWUgY2hhcnQsIGluIHBpeGVscyAtIERlZmF1bHRzIHRvIDAgKG5vIGJvcmRlcilcbiogICAgICAgYm9yZGVyQ29sb3IgLSBDb2xvciB0byB1c2UgZm9yIHRoZSBwaWUgY2hhcnQgYm9yZGVyIC0gRGVmYXVsdHMgdG8gIzAwMFxuKlxuKiAgIGJveCAtIEJveCBwbG90LiBPcHRpb25zOlxuKiAgICAgICByYXcgLSBTZXQgdG8gdHJ1ZSB0byBzdXBwbHkgcHJlLWNvbXB1dGVkIHBsb3QgcG9pbnRzIGFzIHZhbHVlc1xuKiAgICAgICAgICAgICB2YWx1ZXMgc2hvdWxkIGJlOiBsb3dfb3V0bGllciwgbG93X3doaXNrZXIsIHExLCBtZWRpYW4sIHEzLCBoaWdoX3doaXNrZXIsIGhpZ2hfb3V0bGllclxuKiAgICAgICAgICAgICBXaGVuIHNldCB0byBmYWxzZSB5b3UgY2FuIHN1cHBseSBhbnkgbnVtYmVyIG9mIHZhbHVlcyBhbmQgdGhlIGJveCBwbG90IHdpbGxcbiogICAgICAgICAgICAgYmUgY29tcHV0ZWQgZm9yIHlvdS4gIERlZmF1bHQgaXMgZmFsc2UuXG4qICAgICAgIHNob3dPdXRsaWVycyAtIFNldCB0byB0cnVlIChkZWZhdWx0KSB0byBkaXNwbGF5IG91dGxpZXJzIGFzIGNpcmNsZXNcbiogICAgICAgb3V0bGllcklRUiAtIEludGVycXVhcnRpbGUgcmFuZ2UgdXNlZCB0byBkZXRlcm1pbmUgb3V0bGllcnMuICBEZWZhdWx0IDEuNVxuKiAgICAgICBib3hMaW5lQ29sb3IgLSBPdXRsaW5lIGNvbG9yIG9mIHRoZSBib3hcbiogICAgICAgYm94RmlsbENvbG9yIC0gRmlsbCBjb2xvciBmb3IgdGhlIGJveFxuKiAgICAgICB3aGlza2VyQ29sb3IgLSBMaW5lIGNvbG9yIHVzZWQgZm9yIHdoaXNrZXJzXG4qICAgICAgIG91dGxpZXJMaW5lQ29sb3IgLSBPdXRsaW5lIGNvbG9yIG9mIG91dGxpZXIgY2lyY2xlc1xuKiAgICAgICBvdXRsaWVyRmlsbENvbG9yIC0gRmlsbCBjb2xvciBvZiB0aGUgb3V0bGllciBjaXJjbGVzXG4qICAgICAgIHNwb3RSYWRpdXMgLSBSYWRpdXMgb2Ygb3V0bGllciBjaXJjbGVzXG4qICAgICAgIG1lZGlhbkNvbG9yIC0gTGluZSBjb2xvciBvZiB0aGUgbWVkaWFuIGxpbmVcbiogICAgICAgdGFyZ2V0IC0gRHJhdyBhIHRhcmdldCBjcm9zcyBoYWlyIGF0IHRoZSBzdXBwbGllZCB2YWx1ZSAoZGVmYXVsdCB1bmRlZmluZWQpXG4qXG4qXG4qXG4qICAgRXhhbXBsZXM6XG4qICAgJCgnI3NwYXJrbGluZTEnKS5zcGFya2xpbmUobXl2YWx1ZXMsIHsgbGluZUNvbG9yOiAnI2YwMCcsIGZpbGxDb2xvcjogZmFsc2UgfSk7XG4qICAgJCgnLmJhcnNwYXJrcycpLnNwYXJrbGluZSgnaHRtbCcsIHsgdHlwZTonYmFyJywgaGVpZ2h0Oic0MHB4JywgYmFyV2lkdGg6NSB9KTtcbiogICAkKCcjdHJpc3RhdGUnKS5zcGFya2xpbmUoWzEsMSwtMSwxLDAsMCwtMV0sIHsgdHlwZTondHJpc3RhdGUnIH0pOlxuKiAgICQoJyNkaXNjcmV0ZScpLnNwYXJrbGluZShbMSwzLDQsNSw1LDMsNCw1XSwgeyB0eXBlOidkaXNjcmV0ZScgfSk7XG4qICAgJCgnI2J1bGxldCcpLnNwYXJrbGluZShbMTAsMTIsMTIsOSw3XSwgeyB0eXBlOididWxsZXQnIH0pO1xuKiAgICQoJyNwaWUnKS5zcGFya2xpbmUoWzEsMSwyXSwgeyB0eXBlOidwaWUnIH0pO1xuKi9cblxuLypqc2xpbnQgcmVnZXhwOiB0cnVlLCBicm93c2VyOiB0cnVlLCBqcXVlcnk6IHRydWUsIHdoaXRlOiB0cnVlLCBub21lbjogZmFsc2UsIHBsdXNwbHVzOiBmYWxzZSwgbWF4ZXJyOiA1MDAsIGluZGVudDogNCAqL1xuXG4oZnVuY3Rpb24oZG9jdW1lbnQsIE1hdGgsIHVuZGVmaW5lZCkgeyAvLyBwZXJmb3JtYW5jZS9taW5pZmllZC1zaXplIG9wdGltaXphdGlvblxuKGZ1bmN0aW9uKGZhY3RvcnkpIHtcbiAgICBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcbiAgICAgICAgZGVmaW5lKFsnanF1ZXJ5J10sIGZhY3RvcnkpO1xuICAgIH0gZWxzZSBpZiAoalF1ZXJ5ICYmICFqUXVlcnkuZm4uc3BhcmtsaW5lKSB7XG4gICAgICAgIGZhY3RvcnkoalF1ZXJ5KTtcbiAgICB9XG59XG4oZnVuY3Rpb24oJCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIHZhciBVTlNFVF9PUFRJT04gPSB7fSxcbiAgICAgICAgZ2V0RGVmYXVsdHMsIGNyZWF0ZUNsYXNzLCBTUEZvcm1hdCwgY2xpcHZhbCwgcXVhcnRpbGUsIG5vcm1hbGl6ZVZhbHVlLCBub3JtYWxpemVWYWx1ZXMsXG4gICAgICAgIHJlbW92ZSwgaXNOdW1iZXIsIGFsbCwgc3VtLCBhZGRDU1MsIGVuc3VyZUFycmF5LCBmb3JtYXROdW1iZXIsIFJhbmdlTWFwLFxuICAgICAgICBNb3VzZUhhbmRsZXIsIFRvb2x0aXAsIGJhckhpZ2hsaWdodE1peGluLFxuICAgICAgICBsaW5lLCBiYXIsIHRyaXN0YXRlLCBkaXNjcmV0ZSwgYnVsbGV0LCBwaWUsIGJveCwgZGVmYXVsdFN0eWxlcywgaW5pdFN0eWxlcyxcbiAgICAgICAgVlNoYXBlLCBWQ2FudmFzX2Jhc2UsIFZDYW52YXNfY2FudmFzLCBWQ2FudmFzX3ZtbCwgcGVuZGluZywgc2hhcGVDb3VudCA9IDA7XG5cbiAgICAvKipcbiAgICAgKiBEZWZhdWx0IGNvbmZpZ3VyYXRpb24gc2V0dGluZ3NcbiAgICAgKi9cbiAgICBnZXREZWZhdWx0cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIC8vIFNldHRpbmdzIGNvbW1vbiB0byBtb3N0L2FsbCBjaGFydCB0eXBlc1xuICAgICAgICAgICAgY29tbW9uOiB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ2xpbmUnLFxuICAgICAgICAgICAgICAgIGxpbmVDb2xvcjogJyMwMGYnLFxuICAgICAgICAgICAgICAgIGZpbGxDb2xvcjogJyNjZGYnLFxuICAgICAgICAgICAgICAgIGRlZmF1bHRQaXhlbHNQZXJWYWx1ZTogMyxcbiAgICAgICAgICAgICAgICB3aWR0aDogJ2F1dG8nLFxuICAgICAgICAgICAgICAgIGhlaWdodDogJ2F1dG8nLFxuICAgICAgICAgICAgICAgIGNvbXBvc2l0ZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgdGFnVmFsdWVzQXR0cmlidXRlOiAndmFsdWVzJyxcbiAgICAgICAgICAgICAgICB0YWdPcHRpb25zUHJlZml4OiAnc3BhcmsnLFxuICAgICAgICAgICAgICAgIGVuYWJsZVRhZ09wdGlvbnM6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVuYWJsZUhpZ2hsaWdodDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBoaWdobGlnaHRMaWdodGVuOiAxLjQsXG4gICAgICAgICAgICAgICAgdG9vbHRpcFNraXBOdWxsOiB0cnVlLFxuICAgICAgICAgICAgICAgIHRvb2x0aXBQcmVmaXg6ICcnLFxuICAgICAgICAgICAgICAgIHRvb2x0aXBTdWZmaXg6ICcnLFxuICAgICAgICAgICAgICAgIGRpc2FibGVIaWRkZW5DaGVjazogZmFsc2UsXG4gICAgICAgICAgICAgICAgbnVtYmVyRm9ybWF0dGVyOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBudW1iZXJEaWdpdEdyb3VwQ291bnQ6IDMsXG4gICAgICAgICAgICAgICAgbnVtYmVyRGlnaXRHcm91cFNlcDogJywnLFxuICAgICAgICAgICAgICAgIG51bWJlckRlY2ltYWxNYXJrOiAnLicsXG4gICAgICAgICAgICAgICAgZGlzYWJsZVRvb2x0aXBzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBkaXNhYmxlSW50ZXJhY3Rpb246IGZhbHNlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgLy8gRGVmYXVsdHMgZm9yIGxpbmUgY2hhcnRzXG4gICAgICAgICAgICBsaW5lOiB7XG4gICAgICAgICAgICAgICAgc3BvdENvbG9yOiAnI2Y4MCcsXG4gICAgICAgICAgICAgICAgaGlnaGxpZ2h0U3BvdENvbG9yOiAnIzVmNScsXG4gICAgICAgICAgICAgICAgaGlnaGxpZ2h0TGluZUNvbG9yOiAnI2YyMicsXG4gICAgICAgICAgICAgICAgc3BvdFJhZGl1czogMS41LFxuICAgICAgICAgICAgICAgIG1pblNwb3RDb2xvcjogJyNmODAnLFxuICAgICAgICAgICAgICAgIG1heFNwb3RDb2xvcjogJyNmODAnLFxuICAgICAgICAgICAgICAgIGxpbmVXaWR0aDogMSxcbiAgICAgICAgICAgICAgICBub3JtYWxSYW5nZU1pbjogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIG5vcm1hbFJhbmdlTWF4OiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgbm9ybWFsUmFuZ2VDb2xvcjogJyNjY2MnLFxuICAgICAgICAgICAgICAgIGRyYXdOb3JtYWxPblRvcDogZmFsc2UsXG4gICAgICAgICAgICAgICAgY2hhcnRSYW5nZU1pbjogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIGNoYXJ0UmFuZ2VNYXg6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICBjaGFydFJhbmdlTWluWDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIGNoYXJ0UmFuZ2VNYXhYOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgdG9vbHRpcEZvcm1hdDogbmV3IFNQRm9ybWF0KCc8c3BhbiBzdHlsZT1cImNvbG9yOiB7e2NvbG9yfX1cIj4mIzk2Nzk7PC9zcGFuPiB7e3ByZWZpeH19e3t5fX17e3N1ZmZpeH19JylcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvLyBEZWZhdWx0cyBmb3IgYmFyIGNoYXJ0c1xuICAgICAgICAgICAgYmFyOiB7XG4gICAgICAgICAgICAgICAgYmFyQ29sb3I6ICcjMzM2NmNjJyxcbiAgICAgICAgICAgICAgICBuZWdCYXJDb2xvcjogJyNmNDQnLFxuICAgICAgICAgICAgICAgIHN0YWNrZWRCYXJDb2xvcjogWycjMzM2NmNjJywgJyNkYzM5MTInLCAnI2ZmOTkwMCcsICcjMTA5NjE4JywgJyM2NmFhMDAnLFxuICAgICAgICAgICAgICAgICAgICAnI2RkNDQ3NycsICcjMDA5OWM2JywgJyM5OTAwOTknXSxcbiAgICAgICAgICAgICAgICB6ZXJvQ29sb3I6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICBudWxsQ29sb3I6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICB6ZXJvQXhpczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBiYXJXaWR0aDogNCxcbiAgICAgICAgICAgICAgICBiYXJTcGFjaW5nOiAxLFxuICAgICAgICAgICAgICAgIGNoYXJ0UmFuZ2VNYXg6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICBjaGFydFJhbmdlTWluOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgY2hhcnRSYW5nZUNsaXA6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGNvbG9yTWFwOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgdG9vbHRpcEZvcm1hdDogbmV3IFNQRm9ybWF0KCc8c3BhbiBzdHlsZT1cImNvbG9yOiB7e2NvbG9yfX1cIj4mIzk2Nzk7PC9zcGFuPiB7e3ByZWZpeH19e3t2YWx1ZX19e3tzdWZmaXh9fScpXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgLy8gRGVmYXVsdHMgZm9yIHRyaXN0YXRlIGNoYXJ0c1xuICAgICAgICAgICAgdHJpc3RhdGU6IHtcbiAgICAgICAgICAgICAgICBiYXJXaWR0aDogNCxcbiAgICAgICAgICAgICAgICBiYXJTcGFjaW5nOiAxLFxuICAgICAgICAgICAgICAgIHBvc0JhckNvbG9yOiAnIzZmNicsXG4gICAgICAgICAgICAgICAgbmVnQmFyQ29sb3I6ICcjZjQ0JyxcbiAgICAgICAgICAgICAgICB6ZXJvQmFyQ29sb3I6ICcjOTk5JyxcbiAgICAgICAgICAgICAgICBjb2xvck1hcDoge30sXG4gICAgICAgICAgICAgICAgdG9vbHRpcEZvcm1hdDogbmV3IFNQRm9ybWF0KCc8c3BhbiBzdHlsZT1cImNvbG9yOiB7e2NvbG9yfX1cIj4mIzk2Nzk7PC9zcGFuPiB7e3ZhbHVlOm1hcH19JyksXG4gICAgICAgICAgICAgICAgdG9vbHRpcFZhbHVlTG9va3VwczogeyBtYXA6IHsgJy0xJzogJ0xvc3MnLCAnMCc6ICdEcmF3JywgJzEnOiAnV2luJyB9IH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvLyBEZWZhdWx0cyBmb3IgZGlzY3JldGUgY2hhcnRzXG4gICAgICAgICAgICBkaXNjcmV0ZToge1xuICAgICAgICAgICAgICAgIGxpbmVIZWlnaHQ6ICdhdXRvJyxcbiAgICAgICAgICAgICAgICB0aHJlc2hvbGRDb2xvcjogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIHRocmVzaG9sZFZhbHVlOiAwLFxuICAgICAgICAgICAgICAgIGNoYXJ0UmFuZ2VNYXg6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICBjaGFydFJhbmdlTWluOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgY2hhcnRSYW5nZUNsaXA6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHRvb2x0aXBGb3JtYXQ6IG5ldyBTUEZvcm1hdCgne3twcmVmaXh9fXt7dmFsdWV9fXt7c3VmZml4fX0nKVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIC8vIERlZmF1bHRzIGZvciBidWxsZXQgY2hhcnRzXG4gICAgICAgICAgICBidWxsZXQ6IHtcbiAgICAgICAgICAgICAgICB0YXJnZXRDb2xvcjogJyNmMzMnLFxuICAgICAgICAgICAgICAgIHRhcmdldFdpZHRoOiAzLCAvLyB3aWR0aCBvZiB0aGUgdGFyZ2V0IGJhciBpbiBwaXhlbHNcbiAgICAgICAgICAgICAgICBwZXJmb3JtYW5jZUNvbG9yOiAnIzMzZicsXG4gICAgICAgICAgICAgICAgcmFuZ2VDb2xvcnM6IFsnI2QzZGFmZScsICcjYThiNmZmJywgJyM3Zjk0ZmYnXSxcbiAgICAgICAgICAgICAgICBiYXNlOiB1bmRlZmluZWQsIC8vIHNldCB0aGlzIHRvIGEgbnVtYmVyIHRvIGNoYW5nZSB0aGUgYmFzZSBzdGFydCBudW1iZXJcbiAgICAgICAgICAgICAgICB0b29sdGlwRm9ybWF0OiBuZXcgU1BGb3JtYXQoJ3t7ZmllbGRrZXk6ZmllbGRzfX0gLSB7e3ZhbHVlfX0nKSxcbiAgICAgICAgICAgICAgICB0b29sdGlwVmFsdWVMb29rdXBzOiB7IGZpZWxkczoge3I6ICdSYW5nZScsIHA6ICdQZXJmb3JtYW5jZScsIHQ6ICdUYXJnZXQnfSB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgLy8gRGVmYXVsdHMgZm9yIHBpZSBjaGFydHNcbiAgICAgICAgICAgIHBpZToge1xuICAgICAgICAgICAgICAgIG9mZnNldDogMCxcbiAgICAgICAgICAgICAgICBzbGljZUNvbG9yczogWycjMzM2NmNjJywgJyNkYzM5MTInLCAnI2ZmOTkwMCcsICcjMTA5NjE4JywgJyM2NmFhMDAnLFxuICAgICAgICAgICAgICAgICAgICAnI2RkNDQ3NycsICcjMDA5OWM2JywgJyM5OTAwOTknXSxcbiAgICAgICAgICAgICAgICBib3JkZXJXaWR0aDogMCxcbiAgICAgICAgICAgICAgICBib3JkZXJDb2xvcjogJyMwMDAnLFxuICAgICAgICAgICAgICAgIHRvb2x0aXBGb3JtYXQ6IG5ldyBTUEZvcm1hdCgnPHNwYW4gc3R5bGU9XCJjb2xvcjoge3tjb2xvcn19XCI+JiM5Njc5Ozwvc3Bhbj4ge3t2YWx1ZX19ICh7e3BlcmNlbnQuMX19JSknKVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIC8vIERlZmF1bHRzIGZvciBib3ggcGxvdHNcbiAgICAgICAgICAgIGJveDoge1xuICAgICAgICAgICAgICAgIHJhdzogZmFsc2UsXG4gICAgICAgICAgICAgICAgYm94TGluZUNvbG9yOiAnIzAwMCcsXG4gICAgICAgICAgICAgICAgYm94RmlsbENvbG9yOiAnI2NkZicsXG4gICAgICAgICAgICAgICAgd2hpc2tlckNvbG9yOiAnIzAwMCcsXG4gICAgICAgICAgICAgICAgb3V0bGllckxpbmVDb2xvcjogJyMzMzMnLFxuICAgICAgICAgICAgICAgIG91dGxpZXJGaWxsQ29sb3I6ICcjZmZmJyxcbiAgICAgICAgICAgICAgICBtZWRpYW5Db2xvcjogJyNmMDAnLFxuICAgICAgICAgICAgICAgIHNob3dPdXRsaWVyczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBvdXRsaWVySVFSOiAxLjUsXG4gICAgICAgICAgICAgICAgc3BvdFJhZGl1czogMS41LFxuICAgICAgICAgICAgICAgIHRhcmdldDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIHRhcmdldENvbG9yOiAnIzRhMicsXG4gICAgICAgICAgICAgICAgY2hhcnRSYW5nZU1heDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIGNoYXJ0UmFuZ2VNaW46IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICB0b29sdGlwRm9ybWF0OiBuZXcgU1BGb3JtYXQoJ3t7ZmllbGQ6ZmllbGRzfX06IHt7dmFsdWV9fScpLFxuICAgICAgICAgICAgICAgIHRvb2x0aXBGb3JtYXRGaWVsZGxpc3RLZXk6ICdmaWVsZCcsXG4gICAgICAgICAgICAgICAgdG9vbHRpcFZhbHVlTG9va3VwczogeyBmaWVsZHM6IHsgbHE6ICdMb3dlciBRdWFydGlsZScsIG1lZDogJ01lZGlhbicsXG4gICAgICAgICAgICAgICAgICAgIHVxOiAnVXBwZXIgUXVhcnRpbGUnLCBsbzogJ0xlZnQgT3V0bGllcicsIHJvOiAnUmlnaHQgT3V0bGllcicsXG4gICAgICAgICAgICAgICAgICAgIGx3OiAnTGVmdCBXaGlza2VyJywgcnc6ICdSaWdodCBXaGlza2VyJ30gfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH07XG5cbiAgICAvLyBZb3UgY2FuIGhhdmUgdG9vbHRpcHMgdXNlIGEgY3NzIGNsYXNzIG90aGVyIHRoYW4ganFzdG9vbHRpcCBieSBzcGVjaWZ5aW5nIHRvb2x0aXBDbGFzc25hbWVcbiAgICBkZWZhdWx0U3R5bGVzID0gJy5qcXN0b29sdGlwIHsgJyArXG4gICAgICAgICAgICAncG9zaXRpb246IGFic29sdXRlOycgK1xuICAgICAgICAgICAgJ2xlZnQ6IDBweDsnICtcbiAgICAgICAgICAgICd0b3A6IDBweDsnICtcbiAgICAgICAgICAgICd2aXNpYmlsaXR5OiBoaWRkZW47JyArXG4gICAgICAgICAgICAnYmFja2dyb3VuZDogcmdiKDAsIDAsIDApIHRyYW5zcGFyZW50OycgK1xuICAgICAgICAgICAgJ2JhY2tncm91bmQtY29sb3I6IHJnYmEoMCwwLDAsMC42KTsnICtcbiAgICAgICAgICAgICdmaWx0ZXI6cHJvZ2lkOkRYSW1hZ2VUcmFuc2Zvcm0uTWljcm9zb2Z0LmdyYWRpZW50KHN0YXJ0Q29sb3JzdHI9Izk5MDAwMDAwLCBlbmRDb2xvcnN0cj0jOTkwMDAwMDApOycgK1xuICAgICAgICAgICAgJy1tcy1maWx0ZXI6IFwicHJvZ2lkOkRYSW1hZ2VUcmFuc2Zvcm0uTWljcm9zb2Z0LmdyYWRpZW50KHN0YXJ0Q29sb3JzdHI9Izk5MDAwMDAwLCBlbmRDb2xvcnN0cj0jOTkwMDAwMDApXCI7JyArXG4gICAgICAgICAgICAnY29sb3I6IHdoaXRlOycgK1xuICAgICAgICAgICAgJ2ZvbnQ6IDEwcHggYXJpYWwsIHNhbiBzZXJpZjsnICtcbiAgICAgICAgICAgICd0ZXh0LWFsaWduOiBsZWZ0OycgK1xuICAgICAgICAgICAgJ3doaXRlLXNwYWNlOiBub3dyYXA7JyArXG4gICAgICAgICAgICAncGFkZGluZzogNXB4OycgK1xuICAgICAgICAgICAgJ2JvcmRlcjogMXB4IHNvbGlkIHdoaXRlOycgK1xuICAgICAgICAgICAgJ2JveC1zaXppbmc6IGNvbnRlbnQtYm94OycgK1xuICAgICAgICAgICAgJ3otaW5kZXg6IDEwMDAwOycgK1xuICAgICAgICAgICAgJ30nICtcbiAgICAgICAgICAgICcuanFzZmllbGQgeyAnICtcbiAgICAgICAgICAgICdjb2xvcjogd2hpdGU7JyArXG4gICAgICAgICAgICAnZm9udDogMTBweCBhcmlhbCwgc2FuIHNlcmlmOycgK1xuICAgICAgICAgICAgJ3RleHQtYWxpZ246IGxlZnQ7JyArXG4gICAgICAgICAgICAnfSc7XG5cbiAgICAvKipcbiAgICAgKiBVdGlsaXRpZXNcbiAgICAgKi9cblxuICAgIGNyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKC8qIFtiYXNlY2xhc3MsIFttaXhpbiwgLi4uXV0sIGRlZmluaXRpb24gKi8pIHtcbiAgICAgICAgdmFyIENsYXNzLCBhcmdzO1xuICAgICAgICBDbGFzcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuaW5pdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICB9O1xuICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgIGlmIChhcmd1bWVudHNbMF0pIHtcbiAgICAgICAgICAgICAgICBDbGFzcy5wcm90b3R5cGUgPSAkLmV4dGVuZChuZXcgYXJndW1lbnRzWzBdKCksIGFyZ3VtZW50c1thcmd1bWVudHMubGVuZ3RoIC0gMV0pO1xuICAgICAgICAgICAgICAgIENsYXNzLl9zdXBlciA9IGFyZ3VtZW50c1swXS5wcm90b3R5cGU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIENsYXNzLnByb3RvdHlwZSA9IGFyZ3VtZW50c1thcmd1bWVudHMubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDIpIHtcbiAgICAgICAgICAgICAgICBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxLCAtMSk7XG4gICAgICAgICAgICAgICAgYXJncy51bnNoaWZ0KENsYXNzLnByb3RvdHlwZSk7XG4gICAgICAgICAgICAgICAgJC5leHRlbmQuYXBwbHkoJCwgYXJncyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBDbGFzcy5wcm90b3R5cGUgPSBhcmd1bWVudHNbMF07XG4gICAgICAgIH1cbiAgICAgICAgQ2xhc3MucHJvdG90eXBlLmNscyA9IENsYXNzO1xuICAgICAgICByZXR1cm4gQ2xhc3M7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFdyYXBzIGEgZm9ybWF0IHN0cmluZyBmb3IgdG9vbHRpcHNcbiAgICAgKiB7e3h9fVxuICAgICAqIHt7eC4yfVxuICAgICAqIHt7eDptb250aHN9fVxuICAgICAqL1xuICAgICQuU1BGb3JtYXRDbGFzcyA9IFNQRm9ybWF0ID0gY3JlYXRlQ2xhc3Moe1xuICAgICAgICBmcmU6IC9cXHtcXHsoW1xcdy5dKz8pKDooLis/KSk/XFx9XFx9L2csXG4gICAgICAgIHByZWNyZTogLyhcXHcrKVxcLihcXGQrKS8sXG5cbiAgICAgICAgaW5pdDogZnVuY3Rpb24gKGZvcm1hdCwgZmNsYXNzKSB7XG4gICAgICAgICAgICB0aGlzLmZvcm1hdCA9IGZvcm1hdDtcbiAgICAgICAgICAgIHRoaXMuZmNsYXNzID0gZmNsYXNzO1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlbmRlcjogZnVuY3Rpb24gKGZpZWxkc2V0LCBsb29rdXBzLCBvcHRpb25zKSB7XG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXMsXG4gICAgICAgICAgICAgICAgZmllbGRzID0gZmllbGRzZXQsXG4gICAgICAgICAgICAgICAgbWF0Y2gsIHRva2VuLCBsb29rdXBrZXksIGZpZWxkdmFsdWUsIHByZWM7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5mb3JtYXQucmVwbGFjZSh0aGlzLmZyZSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBsb29rdXA7XG4gICAgICAgICAgICAgICAgdG9rZW4gPSBhcmd1bWVudHNbMV07XG4gICAgICAgICAgICAgICAgbG9va3Vwa2V5ID0gYXJndW1lbnRzWzNdO1xuICAgICAgICAgICAgICAgIG1hdGNoID0gc2VsZi5wcmVjcmUuZXhlYyh0b2tlbik7XG4gICAgICAgICAgICAgICAgaWYgKG1hdGNoKSB7XG4gICAgICAgICAgICAgICAgICAgIHByZWMgPSBtYXRjaFsyXTtcbiAgICAgICAgICAgICAgICAgICAgdG9rZW4gPSBtYXRjaFsxXTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBwcmVjID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZpZWxkdmFsdWUgPSBmaWVsZHNbdG9rZW5dO1xuICAgICAgICAgICAgICAgIGlmIChmaWVsZHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobG9va3Vwa2V5ICYmIGxvb2t1cHMgJiYgbG9va3Vwc1tsb29rdXBrZXldKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvb2t1cCA9IGxvb2t1cHNbbG9va3Vwa2V5XTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxvb2t1cC5nZXQpIHsgLy8gUmFuZ2VNYXBcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBsb29rdXBzW2xvb2t1cGtleV0uZ2V0KGZpZWxkdmFsdWUpIHx8IGZpZWxkdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbG9va3Vwc1tsb29rdXBrZXldW2ZpZWxkdmFsdWVdIHx8IGZpZWxkdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGlzTnVtYmVyKGZpZWxkdmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLmdldCgnbnVtYmVyRm9ybWF0dGVyJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkdmFsdWUgPSBvcHRpb25zLmdldCgnbnVtYmVyRm9ybWF0dGVyJykoZmllbGR2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaWVsZHZhbHVlID0gZm9ybWF0TnVtYmVyKGZpZWxkdmFsdWUsIHByZWMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5nZXQoJ251bWJlckRpZ2l0R3JvdXBDb3VudCcpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZ2V0KCdudW1iZXJEaWdpdEdyb3VwU2VwJyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5nZXQoJ251bWJlckRlY2ltYWxNYXJrJykpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBmaWVsZHZhbHVlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIGNvbnZpZW5jZSBtZXRob2QgdG8gYXZvaWQgbmVlZGluZyB0aGUgbmV3IG9wZXJhdG9yXG4gICAgJC5zcGZvcm1hdCA9IGZ1bmN0aW9uKGZvcm1hdCwgZmNsYXNzKSB7XG4gICAgICAgIHJldHVybiBuZXcgU1BGb3JtYXQoZm9ybWF0LCBmY2xhc3MpO1xuICAgIH07XG5cbiAgICBjbGlwdmFsID0gZnVuY3Rpb24gKHZhbCwgbWluLCBtYXgpIHtcbiAgICAgICAgaWYgKHZhbCA8IG1pbikge1xuICAgICAgICAgICAgcmV0dXJuIG1pbjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodmFsID4gbWF4KSB7XG4gICAgICAgICAgICByZXR1cm4gbWF4O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWw7XG4gICAgfTtcblxuICAgIHF1YXJ0aWxlID0gZnVuY3Rpb24gKHZhbHVlcywgcSkge1xuICAgICAgICB2YXIgdmw7XG4gICAgICAgIGlmIChxID09PSAyKSB7XG4gICAgICAgICAgICB2bCA9IE1hdGguZmxvb3IodmFsdWVzLmxlbmd0aCAvIDIpO1xuICAgICAgICAgICAgcmV0dXJuIHZhbHVlcy5sZW5ndGggJSAyID8gdmFsdWVzW3ZsXSA6ICh2YWx1ZXNbdmwtMV0gKyB2YWx1ZXNbdmxdKSAvIDI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAodmFsdWVzLmxlbmd0aCAlIDIgKSB7IC8vIG9kZFxuICAgICAgICAgICAgICAgIHZsID0gKHZhbHVlcy5sZW5ndGggKiBxICsgcSkgLyA0O1xuICAgICAgICAgICAgICAgIHJldHVybiB2bCAlIDEgPyAodmFsdWVzW01hdGguZmxvb3IodmwpXSArIHZhbHVlc1tNYXRoLmZsb29yKHZsKSAtIDFdKSAvIDIgOiB2YWx1ZXNbdmwtMV07XG4gICAgICAgICAgICB9IGVsc2UgeyAvL2V2ZW5cbiAgICAgICAgICAgICAgICB2bCA9ICh2YWx1ZXMubGVuZ3RoICogcSArIDIpIC8gNDtcbiAgICAgICAgICAgICAgICByZXR1cm4gdmwgJSAxID8gKHZhbHVlc1tNYXRoLmZsb29yKHZsKV0gKyB2YWx1ZXNbTWF0aC5mbG9vcih2bCkgLSAxXSkgLyAyIDogIHZhbHVlc1t2bC0xXTtcblxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcblxuICAgIG5vcm1hbGl6ZVZhbHVlID0gZnVuY3Rpb24gKHZhbCkge1xuICAgICAgICB2YXIgbmY7XG4gICAgICAgIHN3aXRjaCAodmFsKSB7XG4gICAgICAgICAgICBjYXNlICd1bmRlZmluZWQnOlxuICAgICAgICAgICAgICAgIHZhbCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ251bGwnOlxuICAgICAgICAgICAgICAgIHZhbCA9IG51bGw7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICd0cnVlJzpcbiAgICAgICAgICAgICAgICB2YWwgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnZmFsc2UnOlxuICAgICAgICAgICAgICAgIHZhbCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBuZiA9IHBhcnNlRmxvYXQodmFsKTtcbiAgICAgICAgICAgICAgICBpZiAodmFsID09IG5mKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbCA9IG5mO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsO1xuICAgIH07XG5cbiAgICBub3JtYWxpemVWYWx1ZXMgPSBmdW5jdGlvbiAodmFscykge1xuICAgICAgICB2YXIgaSwgcmVzdWx0ID0gW107XG4gICAgICAgIGZvciAoaSA9IHZhbHMubGVuZ3RoOyBpLS07KSB7XG4gICAgICAgICAgICByZXN1bHRbaV0gPSBub3JtYWxpemVWYWx1ZSh2YWxzW2ldKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG5cbiAgICByZW1vdmUgPSBmdW5jdGlvbiAodmFscywgZmlsdGVyKSB7XG4gICAgICAgIHZhciBpLCB2bCwgcmVzdWx0ID0gW107XG4gICAgICAgIGZvciAoaSA9IDAsIHZsID0gdmFscy5sZW5ndGg7IGkgPCB2bDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAodmFsc1tpXSAhPT0gZmlsdGVyKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2godmFsc1tpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuXG4gICAgaXNOdW1iZXIgPSBmdW5jdGlvbiAobnVtKSB7XG4gICAgICAgIHJldHVybiAhaXNOYU4ocGFyc2VGbG9hdChudW0pKSAmJiBpc0Zpbml0ZShudW0pO1xuICAgIH07XG5cbiAgICBmb3JtYXROdW1iZXIgPSBmdW5jdGlvbiAobnVtLCBwcmVjLCBncm91cHNpemUsIGdyb3Vwc2VwLCBkZWNzZXApIHtcbiAgICAgICAgdmFyIHAsIGk7XG4gICAgICAgIG51bSA9IChwcmVjID09PSBmYWxzZSA/IHBhcnNlRmxvYXQobnVtKS50b1N0cmluZygpIDogbnVtLnRvRml4ZWQocHJlYykpLnNwbGl0KCcnKTtcbiAgICAgICAgcCA9IChwID0gJC5pbkFycmF5KCcuJywgbnVtKSkgPCAwID8gbnVtLmxlbmd0aCA6IHA7XG4gICAgICAgIGlmIChwIDwgbnVtLmxlbmd0aCkge1xuICAgICAgICAgICAgbnVtW3BdID0gZGVjc2VwO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoaSA9IHAgLSBncm91cHNpemU7IGkgPiAwOyBpIC09IGdyb3Vwc2l6ZSkge1xuICAgICAgICAgICAgbnVtLnNwbGljZShpLCAwLCBncm91cHNlcCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bS5qb2luKCcnKTtcbiAgICB9O1xuXG4gICAgLy8gZGV0ZXJtaW5lIGlmIGFsbCB2YWx1ZXMgb2YgYW4gYXJyYXkgbWF0Y2ggYSB2YWx1ZVxuICAgIC8vIHJldHVybnMgdHJ1ZSBpZiB0aGUgYXJyYXkgaXMgZW1wdHlcbiAgICBhbGwgPSBmdW5jdGlvbiAodmFsLCBhcnIsIGlnbm9yZU51bGwpIHtcbiAgICAgICAgdmFyIGk7XG4gICAgICAgIGZvciAoaSA9IGFyci5sZW5ndGg7IGktLTsgKSB7XG4gICAgICAgICAgICBpZiAoaWdub3JlTnVsbCAmJiBhcnJbaV0gPT09IG51bGwpIGNvbnRpbnVlO1xuICAgICAgICAgICAgaWYgKGFycltpXSAhPT0gdmFsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG5cbiAgICAvLyBzdW1zIHRoZSBudW1lcmljIHZhbHVlcyBpbiBhbiBhcnJheSwgaWdub3Jpbmcgb3RoZXIgdmFsdWVzXG4gICAgc3VtID0gZnVuY3Rpb24gKHZhbHMpIHtcbiAgICAgICAgdmFyIHRvdGFsID0gMCwgaTtcbiAgICAgICAgZm9yIChpID0gdmFscy5sZW5ndGg7IGktLTspIHtcbiAgICAgICAgICAgIHRvdGFsICs9IHR5cGVvZiB2YWxzW2ldID09PSAnbnVtYmVyJyA/IHZhbHNbaV0gOiAwO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0b3RhbDtcbiAgICB9O1xuXG4gICAgZW5zdXJlQXJyYXkgPSBmdW5jdGlvbiAodmFsKSB7XG4gICAgICAgIHJldHVybiAkLmlzQXJyYXkodmFsKSA/IHZhbCA6IFt2YWxdO1xuICAgIH07XG5cbiAgICAvLyBodHRwOi8vcGF1bGlyaXNoLmNvbS8yMDA4L2Jvb2ttYXJrbGV0LWluamVjdC1uZXctY3NzLXJ1bGVzL1xuICAgIGFkZENTUyA9IGZ1bmN0aW9uKGNzcykge1xuICAgICAgICB2YXIgdGFnLCBpZWZhaWw7XG4gICAgICAgIGlmIChkb2N1bWVudC5jcmVhdGVTdHlsZVNoZWV0KSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmNyZWF0ZVN0eWxlU2hlZXQoKS5jc3NUZXh0ID0gY3NzO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAvLyBJRSA8PSA5IG1heGVzIG91dCBhdCAzMSBzdHlsZXNoZWV0czsgaW5qZWN0IGludG8gcGFnZSBpbnN0ZWFkLlxuICAgICAgICAgICAgICAgIGllZmFpbCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGFnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTtcbiAgICAgICAgdGFnLnR5cGUgPSAndGV4dC9jc3MnO1xuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaGVhZCcpWzBdLmFwcGVuZENoaWxkKHRhZyk7XG4gICAgICAgIGlmIChpZWZhaWwpIHtcbiAgICAgICAgICAgIGRvY3VtZW50LnN0eWxlU2hlZXRzW2RvY3VtZW50LnN0eWxlU2hlZXRzLmxlbmd0aCAtIDFdLmNzc1RleHQgPSBjc3M7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0YWdbKHR5cGVvZiBkb2N1bWVudC5ib2R5LnN0eWxlLldlYmtpdEFwcGVhcmFuY2UgPT0gJ3N0cmluZycpIC8qIHdlYmtpdCBvbmx5ICovID8gJ2lubmVyVGV4dCcgOiAnaW5uZXJIVE1MJ10gPSBjc3M7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgLy8gUHJvdmlkZSBhIGNyb3NzLWJyb3dzZXIgaW50ZXJmYWNlIHRvIGEgZmV3IHNpbXBsZSBkcmF3aW5nIHByaW1pdGl2ZXNcbiAgICAkLmZuLnNpbXBsZWRyYXcgPSBmdW5jdGlvbiAod2lkdGgsIGhlaWdodCwgdXNlRXhpc3RpbmcsIGludGVyYWN0KSB7XG4gICAgICAgIHZhciB0YXJnZXQsIG1oYW5kbGVyO1xuICAgICAgICBpZiAodXNlRXhpc3RpbmcgJiYgKHRhcmdldCA9IHRoaXMuZGF0YSgnX2pxc192Y2FudmFzJykpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGFyZ2V0O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCQuZm4uc3BhcmtsaW5lLmNhbnZhcyA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIC8vIFdlJ3ZlIGFscmVhZHkgZGV0ZXJtaW5lZCB0aGF0IG5laXRoZXIgQ2FudmFzIG5vciBWTUwgYXJlIGF2YWlsYWJsZVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgIH0gZWxzZSBpZiAoJC5mbi5zcGFya2xpbmUuY2FudmFzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIC8vIE5vIGZ1bmN0aW9uIGRlZmluZWQgeWV0IC0tIG5lZWQgdG8gc2VlIGlmIHdlIHN1cHBvcnQgQ2FudmFzIG9yIFZNTFxuICAgICAgICAgICAgdmFyIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG4gICAgICAgICAgICBpZiAoISEoZWwuZ2V0Q29udGV4dCAmJiBlbC5nZXRDb250ZXh0KCcyZCcpKSkge1xuICAgICAgICAgICAgICAgIC8vIENhbnZhcyBpcyBhdmFpbGFibGVcbiAgICAgICAgICAgICAgICAkLmZuLnNwYXJrbGluZS5jYW52YXMgPSBmdW5jdGlvbih3aWR0aCwgaGVpZ2h0LCB0YXJnZXQsIGludGVyYWN0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVkNhbnZhc19jYW52YXMod2lkdGgsIGhlaWdodCwgdGFyZ2V0LCBpbnRlcmFjdCk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZG9jdW1lbnQubmFtZXNwYWNlcyAmJiAhZG9jdW1lbnQubmFtZXNwYWNlcy52KSB7XG4gICAgICAgICAgICAgICAgLy8gVk1MIGlzIGF2YWlsYWJsZVxuICAgICAgICAgICAgICAgIGRvY3VtZW50Lm5hbWVzcGFjZXMuYWRkKCd2JywgJ3VybjpzY2hlbWFzLW1pY3Jvc29mdC1jb206dm1sJywgJyNkZWZhdWx0I1ZNTCcpO1xuICAgICAgICAgICAgICAgICQuZm4uc3BhcmtsaW5lLmNhbnZhcyA9IGZ1bmN0aW9uKHdpZHRoLCBoZWlnaHQsIHRhcmdldCwgaW50ZXJhY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBWQ2FudmFzX3ZtbCh3aWR0aCwgaGVpZ2h0LCB0YXJnZXQpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIE5laXRoZXIgQ2FudmFzIG5vciBWTUwgYXJlIGF2YWlsYWJsZVxuICAgICAgICAgICAgICAgICQuZm4uc3BhcmtsaW5lLmNhbnZhcyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh3aWR0aCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB3aWR0aCA9ICQodGhpcykuaW5uZXJXaWR0aCgpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChoZWlnaHQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgaGVpZ2h0ID0gJCh0aGlzKS5pbm5lckhlaWdodCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGFyZ2V0ID0gJC5mbi5zcGFya2xpbmUuY2FudmFzKHdpZHRoLCBoZWlnaHQsIHRoaXMsIGludGVyYWN0KTtcblxuICAgICAgICBtaGFuZGxlciA9ICQodGhpcykuZGF0YSgnX2pxc19taGFuZGxlcicpO1xuICAgICAgICBpZiAobWhhbmRsZXIpIHtcbiAgICAgICAgICAgIG1oYW5kbGVyLnJlZ2lzdGVyQ2FudmFzKHRhcmdldCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRhcmdldDtcbiAgICB9O1xuXG4gICAgJC5mbi5jbGVhcmRyYXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0YXJnZXQgPSB0aGlzLmRhdGEoJ19qcXNfdmNhbnZhcycpO1xuICAgICAgICBpZiAodGFyZ2V0KSB7XG4gICAgICAgICAgICB0YXJnZXQucmVzZXQoKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAkLlJhbmdlTWFwQ2xhc3MgPSBSYW5nZU1hcCA9IGNyZWF0ZUNsYXNzKHtcbiAgICAgICAgaW5pdDogZnVuY3Rpb24gKG1hcCkge1xuICAgICAgICAgICAgdmFyIGtleSwgcmFuZ2UsIHJhbmdlbGlzdCA9IFtdO1xuICAgICAgICAgICAgZm9yIChrZXkgaW4gbWFwKSB7XG4gICAgICAgICAgICAgICAgaWYgKG1hcC5oYXNPd25Qcm9wZXJ0eShrZXkpICYmIHR5cGVvZiBrZXkgPT09ICdzdHJpbmcnICYmIGtleS5pbmRleE9mKCc6JykgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICByYW5nZSA9IGtleS5zcGxpdCgnOicpO1xuICAgICAgICAgICAgICAgICAgICByYW5nZVswXSA9IHJhbmdlWzBdLmxlbmd0aCA9PT0gMCA/IC1JbmZpbml0eSA6IHBhcnNlRmxvYXQocmFuZ2VbMF0pO1xuICAgICAgICAgICAgICAgICAgICByYW5nZVsxXSA9IHJhbmdlWzFdLmxlbmd0aCA9PT0gMCA/IEluZmluaXR5IDogcGFyc2VGbG9hdChyYW5nZVsxXSk7XG4gICAgICAgICAgICAgICAgICAgIHJhbmdlWzJdID0gbWFwW2tleV07XG4gICAgICAgICAgICAgICAgICAgIHJhbmdlbGlzdC5wdXNoKHJhbmdlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm1hcCA9IG1hcDtcbiAgICAgICAgICAgIHRoaXMucmFuZ2VsaXN0ID0gcmFuZ2VsaXN0IHx8IGZhbHNlO1xuICAgICAgICB9LFxuXG4gICAgICAgIGdldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgcmFuZ2VsaXN0ID0gdGhpcy5yYW5nZWxpc3QsXG4gICAgICAgICAgICAgICAgaSwgcmFuZ2UsIHJlc3VsdDtcbiAgICAgICAgICAgIGlmICgocmVzdWx0ID0gdGhpcy5tYXBbdmFsdWVdKSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChyYW5nZWxpc3QpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSByYW5nZWxpc3QubGVuZ3RoOyBpLS07KSB7XG4gICAgICAgICAgICAgICAgICAgIHJhbmdlID0gcmFuZ2VsaXN0W2ldO1xuICAgICAgICAgICAgICAgICAgICBpZiAocmFuZ2VbMF0gPD0gdmFsdWUgJiYgcmFuZ2VbMV0gPj0gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByYW5nZVsyXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIENvbnZlbmllbmNlIGZ1bmN0aW9uXG4gICAgJC5yYW5nZV9tYXAgPSBmdW5jdGlvbihtYXApIHtcbiAgICAgICAgcmV0dXJuIG5ldyBSYW5nZU1hcChtYXApO1xuICAgIH07XG5cbiAgICBNb3VzZUhhbmRsZXIgPSBjcmVhdGVDbGFzcyh7XG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uIChlbCwgb3B0aW9ucykge1xuICAgICAgICAgICAgdmFyICRlbCA9ICQoZWwpO1xuICAgICAgICAgICAgdGhpcy4kZWwgPSAkZWw7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50UGFnZVggPSAwO1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50UGFnZVkgPSAwO1xuICAgICAgICAgICAgdGhpcy5lbCA9IGVsO1xuICAgICAgICAgICAgdGhpcy5zcGxpc3QgPSBbXTtcbiAgICAgICAgICAgIHRoaXMudG9vbHRpcCA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLm92ZXIgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuZGlzcGxheVRvb2x0aXBzID0gIW9wdGlvbnMuZ2V0KCdkaXNhYmxlVG9vbHRpcHMnKTtcbiAgICAgICAgICAgIHRoaXMuaGlnaGxpZ2h0RW5hYmxlZCA9ICFvcHRpb25zLmdldCgnZGlzYWJsZUhpZ2hsaWdodCcpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlZ2lzdGVyU3BhcmtsaW5lOiBmdW5jdGlvbiAoc3ApIHtcbiAgICAgICAgICAgIHRoaXMuc3BsaXN0LnB1c2goc3ApO1xuICAgICAgICAgICAgaWYgKHRoaXMub3Zlcikge1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlRGlzcGxheSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIHJlZ2lzdGVyQ2FudmFzOiBmdW5jdGlvbiAoY2FudmFzKSB7XG4gICAgICAgICAgICB2YXIgJGNhbnZhcyA9ICQoY2FudmFzLmNhbnZhcyk7XG4gICAgICAgICAgICB0aGlzLmNhbnZhcyA9IGNhbnZhcztcbiAgICAgICAgICAgIHRoaXMuJGNhbnZhcyA9ICRjYW52YXM7XG4gICAgICAgICAgICAkY2FudmFzLm1vdXNlZW50ZXIoJC5wcm94eSh0aGlzLm1vdXNlZW50ZXIsIHRoaXMpKTtcbiAgICAgICAgICAgICRjYW52YXMubW91c2VsZWF2ZSgkLnByb3h5KHRoaXMubW91c2VsZWF2ZSwgdGhpcykpO1xuICAgICAgICAgICAgJGNhbnZhcy5jbGljaygkLnByb3h5KHRoaXMubW91c2VjbGljaywgdGhpcykpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlc2V0OiBmdW5jdGlvbiAocmVtb3ZlVG9vbHRpcCkge1xuICAgICAgICAgICAgdGhpcy5zcGxpc3QgPSBbXTtcbiAgICAgICAgICAgIGlmICh0aGlzLnRvb2x0aXAgJiYgcmVtb3ZlVG9vbHRpcCkge1xuICAgICAgICAgICAgICAgIHRoaXMudG9vbHRpcC5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnRvb2x0aXAgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgbW91c2VjbGljazogZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHZhciBjbGlja0V2ZW50ID0gJC5FdmVudCgnc3BhcmtsaW5lQ2xpY2snKTtcbiAgICAgICAgICAgIGNsaWNrRXZlbnQub3JpZ2luYWxFdmVudCA9IGU7XG4gICAgICAgICAgICBjbGlja0V2ZW50LnNwYXJrbGluZXMgPSB0aGlzLnNwbGlzdDtcbiAgICAgICAgICAgIHRoaXMuJGVsLnRyaWdnZXIoY2xpY2tFdmVudCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgbW91c2VlbnRlcjogZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICQoZG9jdW1lbnQuYm9keSkudW5iaW5kKCdtb3VzZW1vdmUuanFzJyk7XG4gICAgICAgICAgICAkKGRvY3VtZW50LmJvZHkpLmJpbmQoJ21vdXNlbW92ZS5qcXMnLCAkLnByb3h5KHRoaXMubW91c2Vtb3ZlLCB0aGlzKSk7XG4gICAgICAgICAgICB0aGlzLm92ZXIgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50UGFnZVggPSBlLnBhZ2VYO1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50UGFnZVkgPSBlLnBhZ2VZO1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50RWwgPSBlLnRhcmdldDtcbiAgICAgICAgICAgIGlmICghdGhpcy50b29sdGlwICYmIHRoaXMuZGlzcGxheVRvb2x0aXBzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy50b29sdGlwID0gbmV3IFRvb2x0aXAodGhpcy5vcHRpb25zKTtcbiAgICAgICAgICAgICAgICB0aGlzLnRvb2x0aXAudXBkYXRlUG9zaXRpb24oZS5wYWdlWCwgZS5wYWdlWSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZURpc3BsYXkoKTtcbiAgICAgICAgfSxcblxuICAgICAgICBtb3VzZWxlYXZlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkKGRvY3VtZW50LmJvZHkpLnVuYmluZCgnbW91c2Vtb3ZlLmpxcycpO1xuICAgICAgICAgICAgdmFyIHNwbGlzdCA9IHRoaXMuc3BsaXN0LFxuICAgICAgICAgICAgICAgICBzcGNvdW50ID0gc3BsaXN0Lmxlbmd0aCxcbiAgICAgICAgICAgICAgICAgbmVlZHNSZWZyZXNoID0gZmFsc2UsXG4gICAgICAgICAgICAgICAgIHNwLCBpO1xuICAgICAgICAgICAgdGhpcy5vdmVyID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRFbCA9IG51bGw7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLnRvb2x0aXApIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRvb2x0aXAucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgdGhpcy50b29sdGlwID0gbnVsbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHNwY291bnQ7IGkrKykge1xuICAgICAgICAgICAgICAgIHNwID0gc3BsaXN0W2ldO1xuICAgICAgICAgICAgICAgIGlmIChzcC5jbGVhclJlZ2lvbkhpZ2hsaWdodCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIG5lZWRzUmVmcmVzaCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAobmVlZHNSZWZyZXNoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jYW52YXMucmVuZGVyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgbW91c2Vtb3ZlOiBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50UGFnZVggPSBlLnBhZ2VYO1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50UGFnZVkgPSBlLnBhZ2VZO1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50RWwgPSBlLnRhcmdldDtcbiAgICAgICAgICAgIGlmICh0aGlzLnRvb2x0aXApIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRvb2x0aXAudXBkYXRlUG9zaXRpb24oZS5wYWdlWCwgZS5wYWdlWSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZURpc3BsYXkoKTtcbiAgICAgICAgfSxcblxuICAgICAgICB1cGRhdGVEaXNwbGF5OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgc3BsaXN0ID0gdGhpcy5zcGxpc3QsXG4gICAgICAgICAgICAgICAgIHNwY291bnQgPSBzcGxpc3QubGVuZ3RoLFxuICAgICAgICAgICAgICAgICBuZWVkc1JlZnJlc2ggPSBmYWxzZSxcbiAgICAgICAgICAgICAgICAgb2Zmc2V0ID0gdGhpcy4kY2FudmFzLm9mZnNldCgpLFxuICAgICAgICAgICAgICAgICBsb2NhbFggPSB0aGlzLmN1cnJlbnRQYWdlWCAtIG9mZnNldC5sZWZ0LFxuICAgICAgICAgICAgICAgICBsb2NhbFkgPSB0aGlzLmN1cnJlbnRQYWdlWSAtIG9mZnNldC50b3AsXG4gICAgICAgICAgICAgICAgIHRvb2x0aXBodG1sLCBzcCwgaSwgcmVzdWx0LCBjaGFuZ2VFdmVudDtcbiAgICAgICAgICAgIGlmICghdGhpcy5vdmVyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHNwY291bnQ7IGkrKykge1xuICAgICAgICAgICAgICAgIHNwID0gc3BsaXN0W2ldO1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHNwLnNldFJlZ2lvbkhpZ2hsaWdodCh0aGlzLmN1cnJlbnRFbCwgbG9jYWxYLCBsb2NhbFkpO1xuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgbmVlZHNSZWZyZXNoID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobmVlZHNSZWZyZXNoKSB7XG4gICAgICAgICAgICAgICAgY2hhbmdlRXZlbnQgPSAkLkV2ZW50KCdzcGFya2xpbmVSZWdpb25DaGFuZ2UnKTtcbiAgICAgICAgICAgICAgICBjaGFuZ2VFdmVudC5zcGFya2xpbmVzID0gdGhpcy5zcGxpc3Q7XG4gICAgICAgICAgICAgICAgdGhpcy4kZWwudHJpZ2dlcihjaGFuZ2VFdmVudCk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudG9vbHRpcCkge1xuICAgICAgICAgICAgICAgICAgICB0b29sdGlwaHRtbCA9ICcnO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgc3Bjb3VudDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzcCA9IHNwbGlzdFtpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvb2x0aXBodG1sICs9IHNwLmdldEN1cnJlbnRSZWdpb25Ub29sdGlwKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy50b29sdGlwLnNldENvbnRlbnQodG9vbHRpcGh0bWwpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuZGlzYWJsZUhpZ2hsaWdodCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNhbnZhcy5yZW5kZXIoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocmVzdWx0ID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5tb3VzZWxlYXZlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcblxuXG4gICAgVG9vbHRpcCA9IGNyZWF0ZUNsYXNzKHtcbiAgICAgICAgc2l6ZVN0eWxlOiAncG9zaXRpb246IHN0YXRpYyAhaW1wb3J0YW50OycgK1xuICAgICAgICAgICAgJ2Rpc3BsYXk6IGJsb2NrICFpbXBvcnRhbnQ7JyArXG4gICAgICAgICAgICAndmlzaWJpbGl0eTogaGlkZGVuICFpbXBvcnRhbnQ7JyArXG4gICAgICAgICAgICAnZmxvYXQ6IGxlZnQgIWltcG9ydGFudDsnLFxuXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gICAgICAgICAgICB2YXIgdG9vbHRpcENsYXNzbmFtZSA9IG9wdGlvbnMuZ2V0KCd0b29sdGlwQ2xhc3NuYW1lJywgJ2pxc3Rvb2x0aXAnKSxcbiAgICAgICAgICAgICAgICBzaXpldGlwU3R5bGUgPSB0aGlzLnNpemVTdHlsZSxcbiAgICAgICAgICAgICAgICBvZmZzZXQ7XG4gICAgICAgICAgICB0aGlzLmNvbnRhaW5lciA9IG9wdGlvbnMuZ2V0KCd0b29sdGlwQ29udGFpbmVyJykgfHwgZG9jdW1lbnQuYm9keTtcbiAgICAgICAgICAgIHRoaXMudG9vbHRpcE9mZnNldFggPSBvcHRpb25zLmdldCgndG9vbHRpcE9mZnNldFgnLCAxMCk7XG4gICAgICAgICAgICB0aGlzLnRvb2x0aXBPZmZzZXRZID0gb3B0aW9ucy5nZXQoJ3Rvb2x0aXBPZmZzZXRZJywgMTIpO1xuICAgICAgICAgICAgLy8gcmVtb3ZlIGFueSBwcmV2aW91cyBsaW5nZXJpbmcgdG9vbHRpcFxuICAgICAgICAgICAgJCgnI2pxc3NpemV0aXAnKS5yZW1vdmUoKTtcbiAgICAgICAgICAgICQoJyNqcXN0b29sdGlwJykucmVtb3ZlKCk7XG4gICAgICAgICAgICB0aGlzLnNpemV0aXAgPSAkKCc8ZGl2Lz4nLCB7XG4gICAgICAgICAgICAgICAgaWQ6ICdqcXNzaXpldGlwJyxcbiAgICAgICAgICAgICAgICBzdHlsZTogc2l6ZXRpcFN0eWxlLFxuICAgICAgICAgICAgICAgICdjbGFzcyc6IHRvb2x0aXBDbGFzc25hbWVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy50b29sdGlwID0gJCgnPGRpdi8+Jywge1xuICAgICAgICAgICAgICAgIGlkOiAnanFzdG9vbHRpcCcsXG4gICAgICAgICAgICAgICAgJ2NsYXNzJzogdG9vbHRpcENsYXNzbmFtZVxuICAgICAgICAgICAgfSkuYXBwZW5kVG8odGhpcy5jb250YWluZXIpO1xuICAgICAgICAgICAgLy8gYWNjb3VudCBmb3IgdGhlIGNvbnRhaW5lcidzIGxvY2F0aW9uXG4gICAgICAgICAgICBvZmZzZXQgPSB0aGlzLnRvb2x0aXAub2Zmc2V0KCk7XG4gICAgICAgICAgICB0aGlzLm9mZnNldExlZnQgPSBvZmZzZXQubGVmdDtcbiAgICAgICAgICAgIHRoaXMub2Zmc2V0VG9wID0gb2Zmc2V0LnRvcDtcbiAgICAgICAgICAgIHRoaXMuaGlkZGVuID0gdHJ1ZTtcbiAgICAgICAgICAgICQod2luZG93KS51bmJpbmQoJ3Jlc2l6ZS5qcXMgc2Nyb2xsLmpxcycpO1xuICAgICAgICAgICAgJCh3aW5kb3cpLmJpbmQoJ3Jlc2l6ZS5qcXMgc2Nyb2xsLmpxcycsICQucHJveHkodGhpcy51cGRhdGVXaW5kb3dEaW1zLCB0aGlzKSk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVdpbmRvd0RpbXMoKTtcbiAgICAgICAgfSxcblxuICAgICAgICB1cGRhdGVXaW5kb3dEaW1zOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLnNjcm9sbFRvcCA9ICQod2luZG93KS5zY3JvbGxUb3AoKTtcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsTGVmdCA9ICQod2luZG93KS5zY3JvbGxMZWZ0KCk7XG4gICAgICAgICAgICB0aGlzLnNjcm9sbFJpZ2h0ID0gdGhpcy5zY3JvbGxMZWZ0ICsgJCh3aW5kb3cpLndpZHRoKCk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVBvc2l0aW9uKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2V0U2l6ZTogZnVuY3Rpb24gKGNvbnRlbnQpIHtcbiAgICAgICAgICAgIHRoaXMuc2l6ZXRpcC5odG1sKGNvbnRlbnQpLmFwcGVuZFRvKHRoaXMuY29udGFpbmVyKTtcbiAgICAgICAgICAgIHRoaXMud2lkdGggPSB0aGlzLnNpemV0aXAud2lkdGgoKSArIDE7XG4gICAgICAgICAgICB0aGlzLmhlaWdodCA9IHRoaXMuc2l6ZXRpcC5oZWlnaHQoKTtcbiAgICAgICAgICAgIHRoaXMuc2l6ZXRpcC5yZW1vdmUoKTtcbiAgICAgICAgfSxcblxuICAgICAgICBzZXRDb250ZW50OiBmdW5jdGlvbiAoY29udGVudCkge1xuICAgICAgICAgICAgaWYgKCFjb250ZW50KSB7XG4gICAgICAgICAgICAgICAgdGhpcy50b29sdGlwLmNzcygndmlzaWJpbGl0eScsICdoaWRkZW4nKTtcbiAgICAgICAgICAgICAgICB0aGlzLmhpZGRlbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5nZXRTaXplKGNvbnRlbnQpO1xuICAgICAgICAgICAgdGhpcy50b29sdGlwLmh0bWwoY29udGVudClcbiAgICAgICAgICAgICAgICAuY3NzKHtcbiAgICAgICAgICAgICAgICAgICAgJ3dpZHRoJzogdGhpcy53aWR0aCxcbiAgICAgICAgICAgICAgICAgICAgJ2hlaWdodCc6IHRoaXMuaGVpZ2h0LFxuICAgICAgICAgICAgICAgICAgICAndmlzaWJpbGl0eSc6ICd2aXNpYmxlJ1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKHRoaXMuaGlkZGVuKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5oaWRkZW4gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVBvc2l0aW9uKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgdXBkYXRlUG9zaXRpb246IGZ1bmN0aW9uICh4LCB5KSB7XG4gICAgICAgICAgICBpZiAoeCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubW91c2V4ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB4ID0gdGhpcy5tb3VzZXggLSB0aGlzLm9mZnNldExlZnQ7XG4gICAgICAgICAgICAgICAgeSA9IHRoaXMubW91c2V5IC0gdGhpcy5vZmZzZXRUb3A7XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5tb3VzZXggPSB4ID0geCAtIHRoaXMub2Zmc2V0TGVmdDtcbiAgICAgICAgICAgICAgICB0aGlzLm1vdXNleSA9IHkgPSB5IC0gdGhpcy5vZmZzZXRUb3A7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIXRoaXMuaGVpZ2h0IHx8ICF0aGlzLndpZHRoIHx8IHRoaXMuaGlkZGVuKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB5IC09IHRoaXMuaGVpZ2h0ICsgdGhpcy50b29sdGlwT2Zmc2V0WTtcbiAgICAgICAgICAgIHggKz0gdGhpcy50b29sdGlwT2Zmc2V0WDtcblxuICAgICAgICAgICAgaWYgKHkgPCB0aGlzLnNjcm9sbFRvcCkge1xuICAgICAgICAgICAgICAgIHkgPSB0aGlzLnNjcm9sbFRvcDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh4IDwgdGhpcy5zY3JvbGxMZWZ0KSB7XG4gICAgICAgICAgICAgICAgeCA9IHRoaXMuc2Nyb2xsTGVmdDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoeCArIHRoaXMud2lkdGggPiB0aGlzLnNjcm9sbFJpZ2h0KSB7XG4gICAgICAgICAgICAgICAgeCA9IHRoaXMuc2Nyb2xsUmlnaHQgLSB0aGlzLndpZHRoO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLnRvb2x0aXAuY3NzKHtcbiAgICAgICAgICAgICAgICAnbGVmdCc6IHgsXG4gICAgICAgICAgICAgICAgJ3RvcCc6IHlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlbW92ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy50b29sdGlwLnJlbW92ZSgpO1xuICAgICAgICAgICAgdGhpcy5zaXpldGlwLnJlbW92ZSgpO1xuICAgICAgICAgICAgdGhpcy5zaXpldGlwID0gdGhpcy50b29sdGlwID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgJCh3aW5kb3cpLnVuYmluZCgncmVzaXplLmpxcyBzY3JvbGwuanFzJyk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIGluaXRTdHlsZXMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgYWRkQ1NTKGRlZmF1bHRTdHlsZXMpO1xuICAgIH07XG5cbiAgICAkKGluaXRTdHlsZXMpO1xuXG4gICAgcGVuZGluZyA9IFtdO1xuICAgICQuZm4uc3BhcmtsaW5lID0gZnVuY3Rpb24gKHVzZXJWYWx1ZXMsIHVzZXJPcHRpb25zKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSBuZXcgJC5mbi5zcGFya2xpbmUub3B0aW9ucyh0aGlzLCB1c2VyT3B0aW9ucyksXG4gICAgICAgICAgICAgICAgICR0aGlzID0gJCh0aGlzKSxcbiAgICAgICAgICAgICAgICAgcmVuZGVyLCBpO1xuICAgICAgICAgICAgcmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciB2YWx1ZXMsIHdpZHRoLCBoZWlnaHQsIHRtcCwgbWhhbmRsZXIsIHNwLCB2YWxzO1xuICAgICAgICAgICAgICAgIGlmICh1c2VyVmFsdWVzID09PSAnaHRtbCcgfHwgdXNlclZhbHVlcyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHMgPSB0aGlzLmdldEF0dHJpYnV0ZShvcHRpb25zLmdldCgndGFnVmFsdWVzQXR0cmlidXRlJykpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodmFscyA9PT0gdW5kZWZpbmVkIHx8IHZhbHMgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHMgPSAkdGhpcy5odG1sKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFsdWVzID0gdmFscy5yZXBsYWNlKC8oXlxccyo8IS0tKXwoLS0+XFxzKiQpfFxccysvZywgJycpLnNwbGl0KCcsJyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWVzID0gdXNlclZhbHVlcztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3aWR0aCA9IG9wdGlvbnMuZ2V0KCd3aWR0aCcpID09PSAnYXV0bycgPyB2YWx1ZXMubGVuZ3RoICogb3B0aW9ucy5nZXQoJ2RlZmF1bHRQaXhlbHNQZXJWYWx1ZScpIDogb3B0aW9ucy5nZXQoJ3dpZHRoJyk7XG4gICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuZ2V0KCdoZWlnaHQnKSA9PT0gJ2F1dG8nKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghb3B0aW9ucy5nZXQoJ2NvbXBvc2l0ZScpIHx8ICEkLmRhdGEodGhpcywgJ19qcXNfdmNhbnZhcycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBtdXN0IGJlIGEgYmV0dGVyIHdheSB0byBnZXQgdGhlIGxpbmUgaGVpZ2h0XG4gICAgICAgICAgICAgICAgICAgICAgICB0bXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0bXAuaW5uZXJIVE1MID0gJ2EnO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMuaHRtbCh0bXApO1xuICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0ID0gJCh0bXApLmlubmVySGVpZ2h0KCkgfHwgJCh0bXApLmhlaWdodCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJCh0bXApLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdG1wID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGhlaWdodCA9IG9wdGlvbnMuZ2V0KCdoZWlnaHQnKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoIW9wdGlvbnMuZ2V0KCdkaXNhYmxlSW50ZXJhY3Rpb24nKSkge1xuICAgICAgICAgICAgICAgICAgICBtaGFuZGxlciA9ICQuZGF0YSh0aGlzLCAnX2pxc19taGFuZGxlcicpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIW1oYW5kbGVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtaGFuZGxlciA9IG5ldyBNb3VzZUhhbmRsZXIodGhpcywgb3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkLmRhdGEodGhpcywgJ19qcXNfbWhhbmRsZXInLCBtaGFuZGxlcik7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIW9wdGlvbnMuZ2V0KCdjb21wb3NpdGUnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWhhbmRsZXIucmVzZXQoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG1oYW5kbGVyID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuZ2V0KCdjb21wb3NpdGUnKSAmJiAhJC5kYXRhKHRoaXMsICdfanFzX3ZjYW52YXMnKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoISQuZGF0YSh0aGlzLCAnX2pxc19lcnJub3RpZnknKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoJ0F0dGVtcHRlZCB0byBhdHRhY2ggYSBjb21wb3NpdGUgc3BhcmtsaW5lIHRvIGFuIGVsZW1lbnQgd2l0aCBubyBleGlzdGluZyBzcGFya2xpbmUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICQuZGF0YSh0aGlzLCAnX2pxc19lcnJub3RpZnknLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgc3AgPSBuZXcgJC5mbi5zcGFya2xpbmVbb3B0aW9ucy5nZXQoJ3R5cGUnKV0odGhpcywgdmFsdWVzLCBvcHRpb25zLCB3aWR0aCwgaGVpZ2h0KTtcblxuICAgICAgICAgICAgICAgIHNwLnJlbmRlcigpO1xuXG4gICAgICAgICAgICAgICAgaWYgKG1oYW5kbGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIG1oYW5kbGVyLnJlZ2lzdGVyU3BhcmtsaW5lKHNwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaWYgKCgkKHRoaXMpLmh0bWwoKSAmJiAhb3B0aW9ucy5nZXQoJ2Rpc2FibGVIaWRkZW5DaGVjaycpICYmICQodGhpcykuaXMoJzpoaWRkZW4nKSkgfHwgISQodGhpcykucGFyZW50cygnYm9keScpLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGlmICghb3B0aW9ucy5nZXQoJ2NvbXBvc2l0ZScpICYmICQuZGF0YSh0aGlzLCAnX2pxc19wZW5kaW5nJykpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gcmVtb3ZlIGFueSBleGlzdGluZyByZWZlcmVuY2VzIHRvIHRoZSBlbGVtZW50XG4gICAgICAgICAgICAgICAgICAgIGZvciAoaSA9IHBlbmRpbmcubGVuZ3RoOyBpOyBpLS0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwZW5kaW5nW2kgLSAxXVswXSA9PSB0aGlzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVuZGluZy5zcGxpY2UoaSAtIDEsIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHBlbmRpbmcucHVzaChbdGhpcywgcmVuZGVyXSk7XG4gICAgICAgICAgICAgICAgJC5kYXRhKHRoaXMsICdfanFzX3BlbmRpbmcnLCB0cnVlKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVuZGVyLmNhbGwodGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICAkLmZuLnNwYXJrbGluZS5kZWZhdWx0cyA9IGdldERlZmF1bHRzKCk7XG5cblxuICAgICQuc3BhcmtsaW5lX2Rpc3BsYXlfdmlzaWJsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGVsLCBpLCBwbDtcbiAgICAgICAgdmFyIGRvbmUgPSBbXTtcbiAgICAgICAgZm9yIChpID0gMCwgcGwgPSBwZW5kaW5nLmxlbmd0aDsgaSA8IHBsOyBpKyspIHtcbiAgICAgICAgICAgIGVsID0gcGVuZGluZ1tpXVswXTtcbiAgICAgICAgICAgIGlmICgkKGVsKS5pcygnOnZpc2libGUnKSAmJiAhJChlbCkucGFyZW50cygpLmlzKCc6aGlkZGVuJykpIHtcbiAgICAgICAgICAgICAgICBwZW5kaW5nW2ldWzFdLmNhbGwoZWwpO1xuICAgICAgICAgICAgICAgICQuZGF0YShwZW5kaW5nW2ldWzBdLCAnX2pxc19wZW5kaW5nJywgZmFsc2UpO1xuICAgICAgICAgICAgICAgIGRvbmUucHVzaChpKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoISQoZWwpLmNsb3Nlc3QoJ2h0bWwnKS5sZW5ndGggJiYgISQuZGF0YShlbCwgJ19qcXNfcGVuZGluZycpKSB7XG4gICAgICAgICAgICAgICAgLy8gZWxlbWVudCBoYXMgYmVlbiBpbnNlcnRlZCBhbmQgcmVtb3ZlZCBmcm9tIHRoZSBET01cbiAgICAgICAgICAgICAgICAvLyBJZiBpdCB3YXMgbm90IHlldCBpbnNlcnRlZCBpbnRvIHRoZSBkb20gdGhlbiB0aGUgLmRhdGEgcmVxdWVzdFxuICAgICAgICAgICAgICAgIC8vIHdpbGwgcmV0dXJuIHRydWUuXG4gICAgICAgICAgICAgICAgLy8gcmVtb3ZpbmcgZnJvbSB0aGUgZG9tIGNhdXNlcyB0aGUgZGF0YSB0byBiZSByZW1vdmVkLlxuICAgICAgICAgICAgICAgICQuZGF0YShwZW5kaW5nW2ldWzBdLCAnX2pxc19wZW5kaW5nJywgZmFsc2UpO1xuICAgICAgICAgICAgICAgIGRvbmUucHVzaChpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKGkgPSBkb25lLmxlbmd0aDsgaTsgaS0tKSB7XG4gICAgICAgICAgICBwZW5kaW5nLnNwbGljZShkb25lW2kgLSAxXSwgMSk7XG4gICAgICAgIH1cbiAgICB9O1xuXG5cbiAgICAvKipcbiAgICAgKiBVc2VyIG9wdGlvbiBoYW5kbGVyXG4gICAgICovXG4gICAgJC5mbi5zcGFya2xpbmUub3B0aW9ucyA9IGNyZWF0ZUNsYXNzKHtcbiAgICAgICAgaW5pdDogZnVuY3Rpb24gKHRhZywgdXNlck9wdGlvbnMpIHtcbiAgICAgICAgICAgIHZhciBleHRlbmRlZE9wdGlvbnMsIGRlZmF1bHRzLCBiYXNlLCB0YWdPcHRpb25UeXBlO1xuICAgICAgICAgICAgdGhpcy51c2VyT3B0aW9ucyA9IHVzZXJPcHRpb25zID0gdXNlck9wdGlvbnMgfHwge307XG4gICAgICAgICAgICB0aGlzLnRhZyA9IHRhZztcbiAgICAgICAgICAgIHRoaXMudGFnVmFsQ2FjaGUgPSB7fTtcbiAgICAgICAgICAgIGRlZmF1bHRzID0gJC5mbi5zcGFya2xpbmUuZGVmYXVsdHM7XG4gICAgICAgICAgICBiYXNlID0gZGVmYXVsdHMuY29tbW9uO1xuICAgICAgICAgICAgdGhpcy50YWdPcHRpb25zUHJlZml4ID0gdXNlck9wdGlvbnMuZW5hYmxlVGFnT3B0aW9ucyAmJiAodXNlck9wdGlvbnMudGFnT3B0aW9uc1ByZWZpeCB8fCBiYXNlLnRhZ09wdGlvbnNQcmVmaXgpO1xuXG4gICAgICAgICAgICB0YWdPcHRpb25UeXBlID0gdGhpcy5nZXRUYWdTZXR0aW5nKCd0eXBlJyk7XG4gICAgICAgICAgICBpZiAodGFnT3B0aW9uVHlwZSA9PT0gVU5TRVRfT1BUSU9OKSB7XG4gICAgICAgICAgICAgICAgZXh0ZW5kZWRPcHRpb25zID0gZGVmYXVsdHNbdXNlck9wdGlvbnMudHlwZSB8fCBiYXNlLnR5cGVdO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBleHRlbmRlZE9wdGlvbnMgPSBkZWZhdWx0c1t0YWdPcHRpb25UeXBlXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubWVyZ2VkT3B0aW9ucyA9ICQuZXh0ZW5kKHt9LCBiYXNlLCBleHRlbmRlZE9wdGlvbnMsIHVzZXJPcHRpb25zKTtcbiAgICAgICAgfSxcblxuXG4gICAgICAgIGdldFRhZ1NldHRpbmc6IGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgICAgIHZhciBwcmVmaXggPSB0aGlzLnRhZ09wdGlvbnNQcmVmaXgsXG4gICAgICAgICAgICAgICAgdmFsLCBpLCBwYWlycywga2V5dmFsO1xuICAgICAgICAgICAgaWYgKHByZWZpeCA9PT0gZmFsc2UgfHwgcHJlZml4ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gVU5TRVRfT1BUSU9OO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMudGFnVmFsQ2FjaGUuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgICAgIHZhbCA9IHRoaXMudGFnVmFsQ2FjaGUua2V5O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YWwgPSB0aGlzLnRhZy5nZXRBdHRyaWJ1dGUocHJlZml4ICsga2V5KTtcbiAgICAgICAgICAgICAgICBpZiAodmFsID09PSB1bmRlZmluZWQgfHwgdmFsID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbCA9IFVOU0VUX09QVElPTjtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHZhbC5zdWJzdHIoMCwgMSkgPT09ICdbJykge1xuICAgICAgICAgICAgICAgICAgICB2YWwgPSB2YWwuc3Vic3RyKDEsIHZhbC5sZW5ndGggLSAyKS5zcGxpdCgnLCcpO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSB2YWwubGVuZ3RoOyBpLS07KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWxbaV0gPSBub3JtYWxpemVWYWx1ZSh2YWxbaV0ucmVwbGFjZSgvKF5cXHMqKXwoXFxzKiQpL2csICcnKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHZhbC5zdWJzdHIoMCwgMSkgPT09ICd7Jykge1xuICAgICAgICAgICAgICAgICAgICBwYWlycyA9IHZhbC5zdWJzdHIoMSwgdmFsLmxlbmd0aCAtIDIpLnNwbGl0KCcsJyk7XG4gICAgICAgICAgICAgICAgICAgIHZhbCA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSBwYWlycy5sZW5ndGg7IGktLTspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleXZhbCA9IHBhaXJzW2ldLnNwbGl0KCc6JywgMik7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWxba2V5dmFsWzBdLnJlcGxhY2UoLyheXFxzKil8KFxccyokKS9nLCAnJyldID0gbm9ybWFsaXplVmFsdWUoa2V5dmFsWzFdLnJlcGxhY2UoLyheXFxzKil8KFxccyokKS9nLCAnJykpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsID0gbm9ybWFsaXplVmFsdWUodmFsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy50YWdWYWxDYWNoZS5rZXkgPSB2YWw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdmFsO1xuICAgICAgICB9LFxuXG4gICAgICAgIGdldDogZnVuY3Rpb24gKGtleSwgZGVmYXVsdHZhbCkge1xuICAgICAgICAgICAgdmFyIHRhZ09wdGlvbiA9IHRoaXMuZ2V0VGFnU2V0dGluZyhrZXkpLFxuICAgICAgICAgICAgICAgIHJlc3VsdDtcbiAgICAgICAgICAgIGlmICh0YWdPcHRpb24gIT09IFVOU0VUX09QVElPTikge1xuICAgICAgICAgICAgICAgIHJldHVybiB0YWdPcHRpb247XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gKHJlc3VsdCA9IHRoaXMubWVyZ2VkT3B0aW9uc1trZXldKSA9PT0gdW5kZWZpbmVkID8gZGVmYXVsdHZhbCA6IHJlc3VsdDtcbiAgICAgICAgfVxuICAgIH0pO1xuXG5cbiAgICAkLmZuLnNwYXJrbGluZS5fYmFzZSA9IGNyZWF0ZUNsYXNzKHtcbiAgICAgICAgZGlzYWJsZWQ6IGZhbHNlLFxuXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uIChlbCwgdmFsdWVzLCBvcHRpb25zLCB3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICAgICAgICB0aGlzLmVsID0gZWw7XG4gICAgICAgICAgICB0aGlzLiRlbCA9ICQoZWwpO1xuICAgICAgICAgICAgdGhpcy52YWx1ZXMgPSB2YWx1ZXM7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgICAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoO1xuICAgICAgICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRSZWdpb24gPSB1bmRlZmluZWQ7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNldHVwIHRoZSBjYW52YXNcbiAgICAgICAgICovXG4gICAgICAgIGluaXRUYXJnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBpbnRlcmFjdGl2ZSA9ICF0aGlzLm9wdGlvbnMuZ2V0KCdkaXNhYmxlSW50ZXJhY3Rpb24nKTtcbiAgICAgICAgICAgIGlmICghKHRoaXMudGFyZ2V0ID0gdGhpcy4kZWwuc2ltcGxlZHJhdyh0aGlzLndpZHRoLCB0aGlzLmhlaWdodCwgdGhpcy5vcHRpb25zLmdldCgnY29tcG9zaXRlJyksIGludGVyYWN0aXZlKSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jYW52YXNXaWR0aCA9IHRoaXMudGFyZ2V0LnBpeGVsV2lkdGg7XG4gICAgICAgICAgICAgICAgdGhpcy5jYW52YXNIZWlnaHQgPSB0aGlzLnRhcmdldC5waXhlbEhlaWdodDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogQWN0dWFsbHkgcmVuZGVyIHRoZSBjaGFydCB0byB0aGUgY2FudmFzXG4gICAgICAgICAqL1xuICAgICAgICByZW5kZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmRpc2FibGVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5lbC5pbm5lckhUTUwgPSAnJztcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogUmV0dXJuIGEgcmVnaW9uIGlkIGZvciBhIGdpdmVuIHgveSBjby1vcmRpbmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgZ2V0UmVnaW9uOiBmdW5jdGlvbiAoeCwgeSkge1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBIaWdobGlnaHQgYW4gaXRlbSBiYXNlZCBvbiB0aGUgbW91c2VkLW92ZXIgeCx5IGNvLW9yZGluYXRlXG4gICAgICAgICAqL1xuICAgICAgICBzZXRSZWdpb25IaWdobGlnaHQ6IGZ1bmN0aW9uIChlbCwgeCwgeSkge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRSZWdpb24gPSB0aGlzLmN1cnJlbnRSZWdpb24sXG4gICAgICAgICAgICAgICAgaGlnaGxpZ2h0RW5hYmxlZCA9ICF0aGlzLm9wdGlvbnMuZ2V0KCdkaXNhYmxlSGlnaGxpZ2h0JyksXG4gICAgICAgICAgICAgICAgbmV3UmVnaW9uO1xuICAgICAgICAgICAgaWYgKHggPiB0aGlzLmNhbnZhc1dpZHRoIHx8IHkgPiB0aGlzLmNhbnZhc0hlaWdodCB8fCB4IDwgMCB8fCB5IDwgMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbmV3UmVnaW9uID0gdGhpcy5nZXRSZWdpb24oZWwsIHgsIHkpO1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRSZWdpb24gIT09IG5ld1JlZ2lvbikge1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50UmVnaW9uICE9PSB1bmRlZmluZWQgJiYgaGlnaGxpZ2h0RW5hYmxlZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUhpZ2hsaWdodCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRSZWdpb24gPSBuZXdSZWdpb247XG4gICAgICAgICAgICAgICAgaWYgKG5ld1JlZ2lvbiAhPT0gdW5kZWZpbmVkICYmIGhpZ2hsaWdodEVuYWJsZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJIaWdobGlnaHQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJlc2V0IGFueSBjdXJyZW50bHkgaGlnaGxpZ2h0ZWQgaXRlbVxuICAgICAgICAgKi9cbiAgICAgICAgY2xlYXJSZWdpb25IaWdobGlnaHQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRSZWdpb24gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlSGlnaGxpZ2h0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50UmVnaW9uID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlbmRlckhpZ2hsaWdodDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5jaGFuZ2VIaWdobGlnaHQodHJ1ZSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVtb3ZlSGlnaGxpZ2h0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLmNoYW5nZUhpZ2hsaWdodChmYWxzZSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgY2hhbmdlSGlnaGxpZ2h0OiBmdW5jdGlvbiAoaGlnaGxpZ2h0KSAge30sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZldGNoIHRoZSBIVE1MIHRvIGRpc3BsYXkgYXMgYSB0b29sdGlwXG4gICAgICAgICAqL1xuICAgICAgICBnZXRDdXJyZW50UmVnaW9uVG9vbHRpcDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnMsXG4gICAgICAgICAgICAgICAgaGVhZGVyID0gJycsXG4gICAgICAgICAgICAgICAgZW50cmllcyA9IFtdLFxuICAgICAgICAgICAgICAgIGZpZWxkcywgZm9ybWF0cywgZm9ybWF0bGVuLCBmY2xhc3MsIHRleHQsIGksXG4gICAgICAgICAgICAgICAgc2hvd0ZpZWxkcywgc2hvd0ZpZWxkc0tleSwgbmV3RmllbGRzLCBmdixcbiAgICAgICAgICAgICAgICBmb3JtYXR0ZXIsIGZvcm1hdCwgZmllbGRsZW4sIGo7XG4gICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50UmVnaW9uID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaWVsZHMgPSB0aGlzLmdldEN1cnJlbnRSZWdpb25GaWVsZHMoKTtcbiAgICAgICAgICAgIGZvcm1hdHRlciA9IG9wdGlvbnMuZ2V0KCd0b29sdGlwRm9ybWF0dGVyJyk7XG4gICAgICAgICAgICBpZiAoZm9ybWF0dGVyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZvcm1hdHRlcih0aGlzLCBvcHRpb25zLCBmaWVsZHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuZ2V0KCd0b29sdGlwQ2hhcnRUaXRsZScpKSB7XG4gICAgICAgICAgICAgICAgaGVhZGVyICs9ICc8ZGl2IGNsYXNzPVwianFzIGpxc3RpdGxlXCI+JyArIG9wdGlvbnMuZ2V0KCd0b29sdGlwQ2hhcnRUaXRsZScpICsgJzwvZGl2Plxcbic7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3JtYXRzID0gdGhpcy5vcHRpb25zLmdldCgndG9vbHRpcEZvcm1hdCcpO1xuICAgICAgICAgICAgaWYgKCFmb3JtYXRzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCEkLmlzQXJyYXkoZm9ybWF0cykpIHtcbiAgICAgICAgICAgICAgICBmb3JtYXRzID0gW2Zvcm1hdHNdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCEkLmlzQXJyYXkoZmllbGRzKSkge1xuICAgICAgICAgICAgICAgIGZpZWxkcyA9IFtmaWVsZHNdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2hvd0ZpZWxkcyA9IHRoaXMub3B0aW9ucy5nZXQoJ3Rvb2x0aXBGb3JtYXRGaWVsZGxpc3QnKTtcbiAgICAgICAgICAgIHNob3dGaWVsZHNLZXkgPSB0aGlzLm9wdGlvbnMuZ2V0KCd0b29sdGlwRm9ybWF0RmllbGRsaXN0S2V5Jyk7XG4gICAgICAgICAgICBpZiAoc2hvd0ZpZWxkcyAmJiBzaG93RmllbGRzS2V5KSB7XG4gICAgICAgICAgICAgICAgLy8gdXNlci1zZWxlY3RlZCBvcmRlcmluZyBvZiBmaWVsZHNcbiAgICAgICAgICAgICAgICBuZXdGaWVsZHMgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSBmaWVsZHMubGVuZ3RoOyBpLS07KSB7XG4gICAgICAgICAgICAgICAgICAgIGZ2ID0gZmllbGRzW2ldW3Nob3dGaWVsZHNLZXldO1xuICAgICAgICAgICAgICAgICAgICBpZiAoKGogPSAkLmluQXJyYXkoZnYsIHNob3dGaWVsZHMpKSAhPSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3RmllbGRzW2pdID0gZmllbGRzW2ldO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZpZWxkcyA9IG5ld0ZpZWxkcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvcm1hdGxlbiA9IGZvcm1hdHMubGVuZ3RoO1xuICAgICAgICAgICAgZmllbGRsZW4gPSBmaWVsZHMubGVuZ3RoO1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGZvcm1hdGxlbjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgZm9ybWF0ID0gZm9ybWF0c1tpXTtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGZvcm1hdCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9ybWF0ID0gbmV3IFNQRm9ybWF0KGZvcm1hdCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZjbGFzcyA9IGZvcm1hdC5mY2xhc3MgfHwgJ2pxc2ZpZWxkJztcbiAgICAgICAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgZmllbGRsZW47IGorKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWZpZWxkc1tqXS5pc051bGwgfHwgIW9wdGlvbnMuZ2V0KCd0b29sdGlwU2tpcE51bGwnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJC5leHRlbmQoZmllbGRzW2pdLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJlZml4OiBvcHRpb25zLmdldCgndG9vbHRpcFByZWZpeCcpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1ZmZpeDogb3B0aW9ucy5nZXQoJ3Rvb2x0aXBTdWZmaXgnKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gZm9ybWF0LnJlbmRlcihmaWVsZHNbal0sIG9wdGlvbnMuZ2V0KCd0b29sdGlwVmFsdWVMb29rdXBzJyksIG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZW50cmllcy5wdXNoKCc8ZGl2IGNsYXNzPVwiJyArIGZjbGFzcyArICdcIj4nICsgdGV4dCArICc8L2Rpdj4nKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChlbnRyaWVzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBoZWFkZXIgKyBlbnRyaWVzLmpvaW4oJ1xcbicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICB9LFxuXG4gICAgICAgIGdldEN1cnJlbnRSZWdpb25GaWVsZHM6IGZ1bmN0aW9uICgpIHt9LFxuXG4gICAgICAgIGNhbGNIaWdobGlnaHRDb2xvcjogZnVuY3Rpb24gKGNvbG9yLCBvcHRpb25zKSB7XG4gICAgICAgICAgICB2YXIgaGlnaGxpZ2h0Q29sb3IgPSBvcHRpb25zLmdldCgnaGlnaGxpZ2h0Q29sb3InKSxcbiAgICAgICAgICAgICAgICBsaWdodGVuID0gb3B0aW9ucy5nZXQoJ2hpZ2hsaWdodExpZ2h0ZW4nKSxcbiAgICAgICAgICAgICAgICBwYXJzZSwgbXVsdCwgcmdibmV3LCBpO1xuICAgICAgICAgICAgaWYgKGhpZ2hsaWdodENvbG9yKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGhpZ2hsaWdodENvbG9yO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGxpZ2h0ZW4pIHtcbiAgICAgICAgICAgICAgICAvLyBleHRyYWN0IFJHQiB2YWx1ZXNcbiAgICAgICAgICAgICAgICBwYXJzZSA9IC9eIyhbMC05YS1mXSkoWzAtOWEtZl0pKFswLTlhLWZdKSQvaS5leGVjKGNvbG9yKSB8fCAvXiMoWzAtOWEtZl17Mn0pKFswLTlhLWZdezJ9KShbMC05YS1mXXsyfSkkL2kuZXhlYyhjb2xvcik7XG4gICAgICAgICAgICAgICAgaWYgKHBhcnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJnYm5ldyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBtdWx0ID0gY29sb3IubGVuZ3RoID09PSA0ID8gMTYgOiAxO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgMzsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZ2JuZXdbaV0gPSBjbGlwdmFsKE1hdGgucm91bmQocGFyc2VJbnQocGFyc2VbaSArIDFdLCAxNikgKiBtdWx0ICogbGlnaHRlbiksIDAsIDI1NSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdyZ2IoJyArIHJnYm5ldy5qb2luKCcsJykgKyAnKSc7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY29sb3I7XG4gICAgICAgIH1cblxuICAgIH0pO1xuXG4gICAgYmFySGlnaGxpZ2h0TWl4aW4gPSB7XG4gICAgICAgIGNoYW5nZUhpZ2hsaWdodDogZnVuY3Rpb24gKGhpZ2hsaWdodCkge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRSZWdpb24gPSB0aGlzLmN1cnJlbnRSZWdpb24sXG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0gdGhpcy50YXJnZXQsXG4gICAgICAgICAgICAgICAgc2hhcGVpZHMgPSB0aGlzLnJlZ2lvblNoYXBlc1tjdXJyZW50UmVnaW9uXSxcbiAgICAgICAgICAgICAgICBuZXdTaGFwZXM7XG4gICAgICAgICAgICAvLyB3aWxsIGJlIG51bGwgaWYgdGhlIHJlZ2lvbiB2YWx1ZSB3YXMgbnVsbFxuICAgICAgICAgICAgaWYgKHNoYXBlaWRzKSB7XG4gICAgICAgICAgICAgICAgbmV3U2hhcGVzID0gdGhpcy5yZW5kZXJSZWdpb24oY3VycmVudFJlZ2lvbiwgaGlnaGxpZ2h0KTtcbiAgICAgICAgICAgICAgICBpZiAoJC5pc0FycmF5KG5ld1NoYXBlcykgfHwgJC5pc0FycmF5KHNoYXBlaWRzKSkge1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXQucmVwbGFjZVdpdGhTaGFwZXMoc2hhcGVpZHMsIG5ld1NoYXBlcyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVnaW9uU2hhcGVzW2N1cnJlbnRSZWdpb25dID0gJC5tYXAobmV3U2hhcGVzLCBmdW5jdGlvbiAobmV3U2hhcGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXdTaGFwZS5pZDtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LnJlcGxhY2VXaXRoU2hhcGUoc2hhcGVpZHMsIG5ld1NoYXBlcyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVnaW9uU2hhcGVzW2N1cnJlbnRSZWdpb25dID0gbmV3U2hhcGVzLmlkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICByZW5kZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB2YWx1ZXMgPSB0aGlzLnZhbHVlcyxcbiAgICAgICAgICAgICAgICB0YXJnZXQgPSB0aGlzLnRhcmdldCxcbiAgICAgICAgICAgICAgICByZWdpb25TaGFwZXMgPSB0aGlzLnJlZ2lvblNoYXBlcyxcbiAgICAgICAgICAgICAgICBzaGFwZXMsIGlkcywgaSwgajtcblxuICAgICAgICAgICAgaWYgKCF0aGlzLmNscy5fc3VwZXIucmVuZGVyLmNhbGwodGhpcykpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGkgPSB2YWx1ZXMubGVuZ3RoOyBpLS07KSB7XG4gICAgICAgICAgICAgICAgc2hhcGVzID0gdGhpcy5yZW5kZXJSZWdpb24oaSk7XG4gICAgICAgICAgICAgICAgaWYgKHNoYXBlcykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoJC5pc0FycmF5KHNoYXBlcykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkcyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChqID0gc2hhcGVzLmxlbmd0aDsgai0tOykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXBlc1tqXS5hcHBlbmQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZHMucHVzaChzaGFwZXNbal0uaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmVnaW9uU2hhcGVzW2ldID0gaWRzO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2hhcGVzLmFwcGVuZCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVnaW9uU2hhcGVzW2ldID0gc2hhcGVzLmlkOyAvLyBzdG9yZSBqdXN0IHRoZSBzaGFwZWlkXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBudWxsIHZhbHVlXG4gICAgICAgICAgICAgICAgICAgIHJlZ2lvblNoYXBlc1tpXSA9IG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGFyZ2V0LnJlbmRlcigpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIExpbmUgY2hhcnRzXG4gICAgICovXG4gICAgJC5mbi5zcGFya2xpbmUubGluZSA9IGxpbmUgPSBjcmVhdGVDbGFzcygkLmZuLnNwYXJrbGluZS5fYmFzZSwge1xuICAgICAgICB0eXBlOiAnbGluZScsXG5cbiAgICAgICAgaW5pdDogZnVuY3Rpb24gKGVsLCB2YWx1ZXMsIG9wdGlvbnMsIHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgICAgIGxpbmUuX3N1cGVyLmluaXQuY2FsbCh0aGlzLCBlbCwgdmFsdWVzLCBvcHRpb25zLCB3aWR0aCwgaGVpZ2h0KTtcbiAgICAgICAgICAgIHRoaXMudmVydGljZXMgPSBbXTtcbiAgICAgICAgICAgIHRoaXMucmVnaW9uTWFwID0gW107XG4gICAgICAgICAgICB0aGlzLnh2YWx1ZXMgPSBbXTtcbiAgICAgICAgICAgIHRoaXMueXZhbHVlcyA9IFtdO1xuICAgICAgICAgICAgdGhpcy55bWlubWF4ID0gW107XG4gICAgICAgICAgICB0aGlzLmhpZ2h0bGlnaHRTcG90SWQgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5sYXN0U2hhcGVJZCA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLmluaXRUYXJnZXQoKTtcbiAgICAgICAgfSxcblxuICAgICAgICBnZXRSZWdpb246IGZ1bmN0aW9uIChlbCwgeCwgeSkge1xuICAgICAgICAgICAgdmFyIGksXG4gICAgICAgICAgICAgICAgcmVnaW9uTWFwID0gdGhpcy5yZWdpb25NYXA7IC8vIG1hcHMgcmVnaW9ucyB0byB2YWx1ZSBwb3NpdGlvbnNcbiAgICAgICAgICAgIGZvciAoaSA9IHJlZ2lvbk1hcC5sZW5ndGg7IGktLTspIHtcbiAgICAgICAgICAgICAgICBpZiAocmVnaW9uTWFwW2ldICE9PSBudWxsICYmIHggPj0gcmVnaW9uTWFwW2ldWzBdICYmIHggPD0gcmVnaW9uTWFwW2ldWzFdKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdpb25NYXBbaV1bMl07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfSxcblxuICAgICAgICBnZXRDdXJyZW50UmVnaW9uRmllbGRzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgY3VycmVudFJlZ2lvbiA9IHRoaXMuY3VycmVudFJlZ2lvbjtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgaXNOdWxsOiB0aGlzLnl2YWx1ZXNbY3VycmVudFJlZ2lvbl0gPT09IG51bGwsXG4gICAgICAgICAgICAgICAgeDogdGhpcy54dmFsdWVzW2N1cnJlbnRSZWdpb25dLFxuICAgICAgICAgICAgICAgIHk6IHRoaXMueXZhbHVlc1tjdXJyZW50UmVnaW9uXSxcbiAgICAgICAgICAgICAgICBjb2xvcjogdGhpcy5vcHRpb25zLmdldCgnbGluZUNvbG9yJyksXG4gICAgICAgICAgICAgICAgZmlsbENvbG9yOiB0aGlzLm9wdGlvbnMuZ2V0KCdmaWxsQ29sb3InKSxcbiAgICAgICAgICAgICAgICBvZmZzZXQ6IGN1cnJlbnRSZWdpb25cbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVuZGVySGlnaGxpZ2h0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgY3VycmVudFJlZ2lvbiA9IHRoaXMuY3VycmVudFJlZ2lvbixcbiAgICAgICAgICAgICAgICB0YXJnZXQgPSB0aGlzLnRhcmdldCxcbiAgICAgICAgICAgICAgICB2ZXJ0ZXggPSB0aGlzLnZlcnRpY2VzW2N1cnJlbnRSZWdpb25dLFxuICAgICAgICAgICAgICAgIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnMsXG4gICAgICAgICAgICAgICAgc3BvdFJhZGl1cyA9IG9wdGlvbnMuZ2V0KCdzcG90UmFkaXVzJyksXG4gICAgICAgICAgICAgICAgaGlnaGxpZ2h0U3BvdENvbG9yID0gb3B0aW9ucy5nZXQoJ2hpZ2hsaWdodFNwb3RDb2xvcicpLFxuICAgICAgICAgICAgICAgIGhpZ2hsaWdodExpbmVDb2xvciA9IG9wdGlvbnMuZ2V0KCdoaWdobGlnaHRMaW5lQ29sb3InKSxcbiAgICAgICAgICAgICAgICBoaWdobGlnaHRTcG90LCBoaWdobGlnaHRMaW5lO1xuXG4gICAgICAgICAgICBpZiAoIXZlcnRleCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzcG90UmFkaXVzICYmIGhpZ2hsaWdodFNwb3RDb2xvcikge1xuICAgICAgICAgICAgICAgIGhpZ2hsaWdodFNwb3QgPSB0YXJnZXQuZHJhd0NpcmNsZSh2ZXJ0ZXhbMF0sIHZlcnRleFsxXSxcbiAgICAgICAgICAgICAgICAgICAgc3BvdFJhZGl1cywgdW5kZWZpbmVkLCBoaWdobGlnaHRTcG90Q29sb3IpO1xuICAgICAgICAgICAgICAgIHRoaXMuaGlnaGxpZ2h0U3BvdElkID0gaGlnaGxpZ2h0U3BvdC5pZDtcbiAgICAgICAgICAgICAgICB0YXJnZXQuaW5zZXJ0QWZ0ZXJTaGFwZSh0aGlzLmxhc3RTaGFwZUlkLCBoaWdobGlnaHRTcG90KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChoaWdobGlnaHRMaW5lQ29sb3IpIHtcbiAgICAgICAgICAgICAgICBoaWdobGlnaHRMaW5lID0gdGFyZ2V0LmRyYXdMaW5lKHZlcnRleFswXSwgdGhpcy5jYW52YXNUb3AsIHZlcnRleFswXSxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jYW52YXNUb3AgKyB0aGlzLmNhbnZhc0hlaWdodCwgaGlnaGxpZ2h0TGluZUNvbG9yKTtcbiAgICAgICAgICAgICAgICB0aGlzLmhpZ2hsaWdodExpbmVJZCA9IGhpZ2hsaWdodExpbmUuaWQ7XG4gICAgICAgICAgICAgICAgdGFyZ2V0Lmluc2VydEFmdGVyU2hhcGUodGhpcy5sYXN0U2hhcGVJZCwgaGlnaGxpZ2h0TGluZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVtb3ZlSGlnaGxpZ2h0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdGFyZ2V0ID0gdGhpcy50YXJnZXQ7XG4gICAgICAgICAgICBpZiAodGhpcy5oaWdobGlnaHRTcG90SWQpIHtcbiAgICAgICAgICAgICAgICB0YXJnZXQucmVtb3ZlU2hhcGVJZCh0aGlzLmhpZ2hsaWdodFNwb3RJZCk7XG4gICAgICAgICAgICAgICAgdGhpcy5oaWdobGlnaHRTcG90SWQgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuaGlnaGxpZ2h0TGluZUlkKSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0LnJlbW92ZVNoYXBlSWQodGhpcy5oaWdobGlnaHRMaW5lSWQpO1xuICAgICAgICAgICAgICAgIHRoaXMuaGlnaGxpZ2h0TGluZUlkID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBzY2FuVmFsdWVzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdmFsdWVzID0gdGhpcy52YWx1ZXMsXG4gICAgICAgICAgICAgICAgdmFsY291bnQgPSB2YWx1ZXMubGVuZ3RoLFxuICAgICAgICAgICAgICAgIHh2YWx1ZXMgPSB0aGlzLnh2YWx1ZXMsXG4gICAgICAgICAgICAgICAgeXZhbHVlcyA9IHRoaXMueXZhbHVlcyxcbiAgICAgICAgICAgICAgICB5bWlubWF4ID0gdGhpcy55bWlubWF4LFxuICAgICAgICAgICAgICAgIGksIHZhbCwgaXNTdHIsIGlzQXJyYXksIHNwO1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHZhbGNvdW50OyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YWwgPSB2YWx1ZXNbaV07XG4gICAgICAgICAgICAgICAgaXNTdHIgPSB0eXBlb2YodmFsdWVzW2ldKSA9PT0gJ3N0cmluZyc7XG4gICAgICAgICAgICAgICAgaXNBcnJheSA9IHR5cGVvZih2YWx1ZXNbaV0pID09PSAnb2JqZWN0JyAmJiB2YWx1ZXNbaV0gaW5zdGFuY2VvZiBBcnJheTtcbiAgICAgICAgICAgICAgICBzcCA9IGlzU3RyICYmIHZhbHVlc1tpXS5zcGxpdCgnOicpO1xuICAgICAgICAgICAgICAgIGlmIChpc1N0ciAmJiBzcC5sZW5ndGggPT09IDIpIHsgLy8geDp5XG4gICAgICAgICAgICAgICAgICAgIHh2YWx1ZXMucHVzaChOdW1iZXIoc3BbMF0pKTtcbiAgICAgICAgICAgICAgICAgICAgeXZhbHVlcy5wdXNoKE51bWJlcihzcFsxXSkpO1xuICAgICAgICAgICAgICAgICAgICB5bWlubWF4LnB1c2goTnVtYmVyKHNwWzFdKSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpc0FycmF5KSB7XG4gICAgICAgICAgICAgICAgICAgIHh2YWx1ZXMucHVzaCh2YWxbMF0pO1xuICAgICAgICAgICAgICAgICAgICB5dmFsdWVzLnB1c2godmFsWzFdKTtcbiAgICAgICAgICAgICAgICAgICAgeW1pbm1heC5wdXNoKHZhbFsxXSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgeHZhbHVlcy5wdXNoKGkpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWVzW2ldID09PSBudWxsIHx8IHZhbHVlc1tpXSA9PT0gJ251bGwnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB5dmFsdWVzLnB1c2gobnVsbCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB5dmFsdWVzLnB1c2goTnVtYmVyKHZhbCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgeW1pbm1heC5wdXNoKE51bWJlcih2YWwpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZ2V0KCd4dmFsdWVzJykpIHtcbiAgICAgICAgICAgICAgICB4dmFsdWVzID0gdGhpcy5vcHRpb25zLmdldCgneHZhbHVlcycpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLm1heHkgPSB0aGlzLm1heHlvcmcgPSBNYXRoLm1heC5hcHBseShNYXRoLCB5bWlubWF4KTtcbiAgICAgICAgICAgIHRoaXMubWlueSA9IHRoaXMubWlueW9yZyA9IE1hdGgubWluLmFwcGx5KE1hdGgsIHltaW5tYXgpO1xuXG4gICAgICAgICAgICB0aGlzLm1heHggPSBNYXRoLm1heC5hcHBseShNYXRoLCB4dmFsdWVzKTtcbiAgICAgICAgICAgIHRoaXMubWlueCA9IE1hdGgubWluLmFwcGx5KE1hdGgsIHh2YWx1ZXMpO1xuXG4gICAgICAgICAgICB0aGlzLnh2YWx1ZXMgPSB4dmFsdWVzO1xuICAgICAgICAgICAgdGhpcy55dmFsdWVzID0geXZhbHVlcztcbiAgICAgICAgICAgIHRoaXMueW1pbm1heCA9IHltaW5tYXg7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBwcm9jZXNzUmFuZ2VPcHRpb25zOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgb3B0aW9ucyA9IHRoaXMub3B0aW9ucyxcbiAgICAgICAgICAgICAgICBub3JtYWxSYW5nZU1pbiA9IG9wdGlvbnMuZ2V0KCdub3JtYWxSYW5nZU1pbicpLFxuICAgICAgICAgICAgICAgIG5vcm1hbFJhbmdlTWF4ID0gb3B0aW9ucy5nZXQoJ25vcm1hbFJhbmdlTWF4Jyk7XG5cbiAgICAgICAgICAgIGlmIChub3JtYWxSYW5nZU1pbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgaWYgKG5vcm1hbFJhbmdlTWluIDwgdGhpcy5taW55KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWlueSA9IG5vcm1hbFJhbmdlTWluO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobm9ybWFsUmFuZ2VNYXggPiB0aGlzLm1heHkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tYXh5ID0gbm9ybWFsUmFuZ2VNYXg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlTWluJykgIT09IHVuZGVmaW5lZCAmJiAob3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VDbGlwJykgfHwgb3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNaW4nKSA8IHRoaXMubWlueSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1pbnkgPSBvcHRpb25zLmdldCgnY2hhcnRSYW5nZU1pbicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlTWF4JykgIT09IHVuZGVmaW5lZCAmJiAob3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VDbGlwJykgfHwgb3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNYXgnKSA+IHRoaXMubWF4eSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1heHkgPSBvcHRpb25zLmdldCgnY2hhcnRSYW5nZU1heCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlTWluWCcpICE9PSB1bmRlZmluZWQgJiYgKG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlQ2xpcFgnKSB8fCBvcHRpb25zLmdldCgnY2hhcnRSYW5nZU1pblgnKSA8IHRoaXMubWlueCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1pbnggPSBvcHRpb25zLmdldCgnY2hhcnRSYW5nZU1pblgnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChvcHRpb25zLmdldCgnY2hhcnRSYW5nZU1heFgnKSAhPT0gdW5kZWZpbmVkICYmIChvcHRpb25zLmdldCgnY2hhcnRSYW5nZUNsaXBYJykgfHwgb3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNYXhYJykgPiB0aGlzLm1heHgpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5tYXh4ID0gb3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNYXhYJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSxcblxuICAgICAgICBkcmF3Tm9ybWFsUmFuZ2U6IGZ1bmN0aW9uIChjYW52YXNMZWZ0LCBjYW52YXNUb3AsIGNhbnZhc0hlaWdodCwgY2FudmFzV2lkdGgsIHJhbmdleSkge1xuICAgICAgICAgICAgdmFyIG5vcm1hbFJhbmdlTWluID0gdGhpcy5vcHRpb25zLmdldCgnbm9ybWFsUmFuZ2VNaW4nKSxcbiAgICAgICAgICAgICAgICBub3JtYWxSYW5nZU1heCA9IHRoaXMub3B0aW9ucy5nZXQoJ25vcm1hbFJhbmdlTWF4JyksXG4gICAgICAgICAgICAgICAgeXRvcCA9IGNhbnZhc1RvcCArIE1hdGgucm91bmQoY2FudmFzSGVpZ2h0IC0gKGNhbnZhc0hlaWdodCAqICgobm9ybWFsUmFuZ2VNYXggLSB0aGlzLm1pbnkpIC8gcmFuZ2V5KSkpLFxuICAgICAgICAgICAgICAgIGhlaWdodCA9IE1hdGgucm91bmQoKGNhbnZhc0hlaWdodCAqIChub3JtYWxSYW5nZU1heCAtIG5vcm1hbFJhbmdlTWluKSkgLyByYW5nZXkpO1xuICAgICAgICAgICAgdGhpcy50YXJnZXQuZHJhd1JlY3QoY2FudmFzTGVmdCwgeXRvcCwgY2FudmFzV2lkdGgsIGhlaWdodCwgdW5kZWZpbmVkLCB0aGlzLm9wdGlvbnMuZ2V0KCdub3JtYWxSYW5nZUNvbG9yJykpLmFwcGVuZCgpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlbmRlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnMsXG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0gdGhpcy50YXJnZXQsXG4gICAgICAgICAgICAgICAgY2FudmFzV2lkdGggPSB0aGlzLmNhbnZhc1dpZHRoLFxuICAgICAgICAgICAgICAgIGNhbnZhc0hlaWdodCA9IHRoaXMuY2FudmFzSGVpZ2h0LFxuICAgICAgICAgICAgICAgIHZlcnRpY2VzID0gdGhpcy52ZXJ0aWNlcyxcbiAgICAgICAgICAgICAgICBzcG90UmFkaXVzID0gb3B0aW9ucy5nZXQoJ3Nwb3RSYWRpdXMnKSxcbiAgICAgICAgICAgICAgICByZWdpb25NYXAgPSB0aGlzLnJlZ2lvbk1hcCxcbiAgICAgICAgICAgICAgICByYW5nZXgsIHJhbmdleSwgeXZhbGxhc3QsXG4gICAgICAgICAgICAgICAgY2FudmFzVG9wLCBjYW52YXNMZWZ0LFxuICAgICAgICAgICAgICAgIHZlcnRleCwgcGF0aCwgcGF0aHMsIHgsIHksIHhuZXh0LCB4cG9zLCB4cG9zbmV4dCxcbiAgICAgICAgICAgICAgICBsYXN0LCBuZXh0LCB5dmFsY291bnQsIGxpbmVTaGFwZXMsIGZpbGxTaGFwZXMsIHBsZW4sXG4gICAgICAgICAgICAgICAgdmFsdWVTcG90cywgaGxTcG90c0VuYWJsZWQsIGNvbG9yLCB4dmFsdWVzLCB5dmFsdWVzLCBpO1xuXG4gICAgICAgICAgICBpZiAoIWxpbmUuX3N1cGVyLnJlbmRlci5jYWxsKHRoaXMpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLnNjYW5WYWx1ZXMoKTtcbiAgICAgICAgICAgIHRoaXMucHJvY2Vzc1JhbmdlT3B0aW9ucygpO1xuXG4gICAgICAgICAgICB4dmFsdWVzID0gdGhpcy54dmFsdWVzO1xuICAgICAgICAgICAgeXZhbHVlcyA9IHRoaXMueXZhbHVlcztcblxuICAgICAgICAgICAgaWYgKCF0aGlzLnltaW5tYXgubGVuZ3RoIHx8IHRoaXMueXZhbHVlcy5sZW5ndGggPCAyKSB7XG4gICAgICAgICAgICAgICAgLy8gZW1wdHkgb3IgYWxsIG51bGwgdmFsdWVzc1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2FudmFzVG9wID0gY2FudmFzTGVmdCA9IDA7XG5cbiAgICAgICAgICAgIHJhbmdleCA9IHRoaXMubWF4eCAtIHRoaXMubWlueCA9PT0gMCA/IDEgOiB0aGlzLm1heHggLSB0aGlzLm1pbng7XG4gICAgICAgICAgICByYW5nZXkgPSB0aGlzLm1heHkgLSB0aGlzLm1pbnkgPT09IDAgPyAxIDogdGhpcy5tYXh5IC0gdGhpcy5taW55O1xuICAgICAgICAgICAgeXZhbGxhc3QgPSB0aGlzLnl2YWx1ZXMubGVuZ3RoIC0gMTtcblxuICAgICAgICAgICAgaWYgKHNwb3RSYWRpdXMgJiYgKGNhbnZhc1dpZHRoIDwgKHNwb3RSYWRpdXMgKiA0KSB8fCBjYW52YXNIZWlnaHQgPCAoc3BvdFJhZGl1cyAqIDQpKSkge1xuICAgICAgICAgICAgICAgIHNwb3RSYWRpdXMgPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNwb3RSYWRpdXMpIHtcbiAgICAgICAgICAgICAgICAvLyBhZGp1c3QgdGhlIGNhbnZhcyBzaXplIGFzIHJlcXVpcmVkIHNvIHRoYXQgc3BvdHMgd2lsbCBmaXRcbiAgICAgICAgICAgICAgICBobFNwb3RzRW5hYmxlZCA9IG9wdGlvbnMuZ2V0KCdoaWdobGlnaHRTcG90Q29sb3InKSAmJiAgIW9wdGlvbnMuZ2V0KCdkaXNhYmxlSW50ZXJhY3Rpb24nKTtcbiAgICAgICAgICAgICAgICBpZiAoaGxTcG90c0VuYWJsZWQgfHwgb3B0aW9ucy5nZXQoJ21pblNwb3RDb2xvcicpIHx8IChvcHRpb25zLmdldCgnc3BvdENvbG9yJykgJiYgeXZhbHVlc1t5dmFsbGFzdF0gPT09IHRoaXMubWlueSkpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzSGVpZ2h0IC09IE1hdGguY2VpbChzcG90UmFkaXVzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGhsU3BvdHNFbmFibGVkIHx8IG9wdGlvbnMuZ2V0KCdtYXhTcG90Q29sb3InKSB8fCAob3B0aW9ucy5nZXQoJ3Nwb3RDb2xvcicpICYmIHl2YWx1ZXNbeXZhbGxhc3RdID09PSB0aGlzLm1heHkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhbnZhc0hlaWdodCAtPSBNYXRoLmNlaWwoc3BvdFJhZGl1cyk7XG4gICAgICAgICAgICAgICAgICAgIGNhbnZhc1RvcCArPSBNYXRoLmNlaWwoc3BvdFJhZGl1cyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChobFNwb3RzRW5hYmxlZCB8fFxuICAgICAgICAgICAgICAgICAgICAgKChvcHRpb25zLmdldCgnbWluU3BvdENvbG9yJykgfHwgb3B0aW9ucy5nZXQoJ21heFNwb3RDb2xvcicpKSAmJiAoeXZhbHVlc1swXSA9PT0gdGhpcy5taW55IHx8IHl2YWx1ZXNbMF0gPT09IHRoaXMubWF4eSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhbnZhc0xlZnQgKz0gTWF0aC5jZWlsKHNwb3RSYWRpdXMpO1xuICAgICAgICAgICAgICAgICAgICBjYW52YXNXaWR0aCAtPSBNYXRoLmNlaWwoc3BvdFJhZGl1cyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChobFNwb3RzRW5hYmxlZCB8fCBvcHRpb25zLmdldCgnc3BvdENvbG9yJykgfHxcbiAgICAgICAgICAgICAgICAgICAgKG9wdGlvbnMuZ2V0KCdtaW5TcG90Q29sb3InKSB8fCBvcHRpb25zLmdldCgnbWF4U3BvdENvbG9yJykgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICh5dmFsdWVzW3l2YWxsYXN0XSA9PT0gdGhpcy5taW55IHx8IHl2YWx1ZXNbeXZhbGxhc3RdID09PSB0aGlzLm1heHkpKSkge1xuICAgICAgICAgICAgICAgICAgICBjYW52YXNXaWR0aCAtPSBNYXRoLmNlaWwoc3BvdFJhZGl1cyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgIGNhbnZhc0hlaWdodC0tO1xuXG4gICAgICAgICAgICBpZiAob3B0aW9ucy5nZXQoJ25vcm1hbFJhbmdlTWluJykgIT09IHVuZGVmaW5lZCAmJiAhb3B0aW9ucy5nZXQoJ2RyYXdOb3JtYWxPblRvcCcpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kcmF3Tm9ybWFsUmFuZ2UoY2FudmFzTGVmdCwgY2FudmFzVG9wLCBjYW52YXNIZWlnaHQsIGNhbnZhc1dpZHRoLCByYW5nZXkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBwYXRoID0gW107XG4gICAgICAgICAgICBwYXRocyA9IFtwYXRoXTtcbiAgICAgICAgICAgIGxhc3QgPSBuZXh0ID0gbnVsbDtcbiAgICAgICAgICAgIHl2YWxjb3VudCA9IHl2YWx1ZXMubGVuZ3RoO1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHl2YWxjb3VudDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgeCA9IHh2YWx1ZXNbaV07XG4gICAgICAgICAgICAgICAgeG5leHQgPSB4dmFsdWVzW2kgKyAxXTtcbiAgICAgICAgICAgICAgICB5ID0geXZhbHVlc1tpXTtcbiAgICAgICAgICAgICAgICB4cG9zID0gY2FudmFzTGVmdCArIE1hdGgucm91bmQoKHggLSB0aGlzLm1pbngpICogKGNhbnZhc1dpZHRoIC8gcmFuZ2V4KSk7XG4gICAgICAgICAgICAgICAgeHBvc25leHQgPSBpIDwgeXZhbGNvdW50IC0gMSA/IGNhbnZhc0xlZnQgKyBNYXRoLnJvdW5kKCh4bmV4dCAtIHRoaXMubWlueCkgKiAoY2FudmFzV2lkdGggLyByYW5nZXgpKSA6IGNhbnZhc1dpZHRoO1xuICAgICAgICAgICAgICAgIG5leHQgPSB4cG9zICsgKCh4cG9zbmV4dCAtIHhwb3MpIC8gMik7XG4gICAgICAgICAgICAgICAgcmVnaW9uTWFwW2ldID0gW2xhc3QgfHwgMCwgbmV4dCwgaV07XG4gICAgICAgICAgICAgICAgbGFzdCA9IG5leHQ7XG4gICAgICAgICAgICAgICAgaWYgKHkgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh5dmFsdWVzW2kgLSAxXSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGggPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRocy5wdXNoKHBhdGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmVydGljZXMucHVzaChudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh5IDwgdGhpcy5taW55KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB5ID0gdGhpcy5taW55O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh5ID4gdGhpcy5tYXh5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB5ID0gdGhpcy5tYXh5O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICghcGF0aC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHByZXZpb3VzIHZhbHVlIHdhcyBudWxsXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXRoLnB1c2goW3hwb3MsIGNhbnZhc1RvcCArIGNhbnZhc0hlaWdodF0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZlcnRleCA9IFt4cG9zLCBjYW52YXNUb3AgKyBNYXRoLnJvdW5kKGNhbnZhc0hlaWdodCAtIChjYW52YXNIZWlnaHQgKiAoKHkgLSB0aGlzLm1pbnkpIC8gcmFuZ2V5KSkpXTtcbiAgICAgICAgICAgICAgICAgICAgcGF0aC5wdXNoKHZlcnRleCk7XG4gICAgICAgICAgICAgICAgICAgIHZlcnRpY2VzLnB1c2godmVydGV4KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGxpbmVTaGFwZXMgPSBbXTtcbiAgICAgICAgICAgIGZpbGxTaGFwZXMgPSBbXTtcbiAgICAgICAgICAgIHBsZW4gPSBwYXRocy5sZW5ndGg7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgcGxlbjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgcGF0aCA9IHBhdGhzW2ldO1xuICAgICAgICAgICAgICAgIGlmIChwYXRoLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5nZXQoJ2ZpbGxDb2xvcicpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXRoLnB1c2goW3BhdGhbcGF0aC5sZW5ndGggLSAxXVswXSwgKGNhbnZhc1RvcCArIGNhbnZhc0hlaWdodCldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGxTaGFwZXMucHVzaChwYXRoLnNsaWNlKDApKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhdGgucG9wKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhlcmUncyBvbmx5IGEgc2luZ2xlIHBvaW50IGluIHRoaXMgcGF0aCwgdGhlbiB3ZSB3YW50IHRvIGRpc3BsYXkgaXRcbiAgICAgICAgICAgICAgICAgICAgLy8gYXMgYSB2ZXJ0aWNhbCBsaW5lIHdoaWNoIG1lYW5zIHdlIGtlZXAgcGF0aFswXSAgYXMgaXNcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhdGgubGVuZ3RoID4gMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZWxzZSB3ZSB3YW50IHRoZSBmaXJzdCB2YWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgcGF0aFswXSA9IFtwYXRoWzBdWzBdLCBwYXRoWzFdWzFdXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBsaW5lU2hhcGVzLnB1c2gocGF0aCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBkcmF3IHRoZSBmaWxsIGZpcnN0LCB0aGVuIG9wdGlvbmFsbHkgdGhlIG5vcm1hbCByYW5nZSwgdGhlbiB0aGUgbGluZSBvbiB0b3Agb2YgdGhhdFxuICAgICAgICAgICAgcGxlbiA9IGZpbGxTaGFwZXMubGVuZ3RoO1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHBsZW47IGkrKykge1xuICAgICAgICAgICAgICAgIHRhcmdldC5kcmF3U2hhcGUoZmlsbFNoYXBlc1tpXSxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5nZXQoJ2ZpbGxDb2xvcicpLCBvcHRpb25zLmdldCgnZmlsbENvbG9yJykpLmFwcGVuZCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAob3B0aW9ucy5nZXQoJ25vcm1hbFJhbmdlTWluJykgIT09IHVuZGVmaW5lZCAmJiBvcHRpb25zLmdldCgnZHJhd05vcm1hbE9uVG9wJykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRyYXdOb3JtYWxSYW5nZShjYW52YXNMZWZ0LCBjYW52YXNUb3AsIGNhbnZhc0hlaWdodCwgY2FudmFzV2lkdGgsIHJhbmdleSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHBsZW4gPSBsaW5lU2hhcGVzLmxlbmd0aDtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBwbGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgICB0YXJnZXQuZHJhd1NoYXBlKGxpbmVTaGFwZXNbaV0sIG9wdGlvbnMuZ2V0KCdsaW5lQ29sb3InKSwgdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmdldCgnbGluZVdpZHRoJykpLmFwcGVuZCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoc3BvdFJhZGl1cyAmJiBvcHRpb25zLmdldCgndmFsdWVTcG90cycpKSB7XG4gICAgICAgICAgICAgICAgdmFsdWVTcG90cyA9IG9wdGlvbnMuZ2V0KCd2YWx1ZVNwb3RzJyk7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlU3BvdHMuZ2V0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWVTcG90cyA9IG5ldyBSYW5nZU1hcCh2YWx1ZVNwb3RzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHl2YWxjb3VudDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbG9yID0gdmFsdWVTcG90cy5nZXQoeXZhbHVlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb2xvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LmRyYXdDaXJjbGUoY2FudmFzTGVmdCArIE1hdGgucm91bmQoKHh2YWx1ZXNbaV0gLSB0aGlzLm1pbngpICogKGNhbnZhc1dpZHRoIC8gcmFuZ2V4KSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzVG9wICsgTWF0aC5yb3VuZChjYW52YXNIZWlnaHQgLSAoY2FudmFzSGVpZ2h0ICogKCh5dmFsdWVzW2ldIC0gdGhpcy5taW55KSAvIHJhbmdleSkpKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcG90UmFkaXVzLCB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3IpLmFwcGVuZCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc3BvdFJhZGl1cyAmJiBvcHRpb25zLmdldCgnc3BvdENvbG9yJykgJiYgeXZhbHVlc1t5dmFsbGFzdF0gIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0YXJnZXQuZHJhd0NpcmNsZShjYW52YXNMZWZ0ICsgTWF0aC5yb3VuZCgoeHZhbHVlc1t4dmFsdWVzLmxlbmd0aCAtIDFdIC0gdGhpcy5taW54KSAqIChjYW52YXNXaWR0aCAvIHJhbmdleCkpLFxuICAgICAgICAgICAgICAgICAgICBjYW52YXNUb3AgKyBNYXRoLnJvdW5kKGNhbnZhc0hlaWdodCAtIChjYW52YXNIZWlnaHQgKiAoKHl2YWx1ZXNbeXZhbGxhc3RdIC0gdGhpcy5taW55KSAvIHJhbmdleSkpKSxcbiAgICAgICAgICAgICAgICAgICAgc3BvdFJhZGl1cywgdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmdldCgnc3BvdENvbG9yJykpLmFwcGVuZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMubWF4eSAhPT0gdGhpcy5taW55b3JnKSB7XG4gICAgICAgICAgICAgICAgaWYgKHNwb3RSYWRpdXMgJiYgb3B0aW9ucy5nZXQoJ21pblNwb3RDb2xvcicpKSB7XG4gICAgICAgICAgICAgICAgICAgIHggPSB4dmFsdWVzWyQuaW5BcnJheSh0aGlzLm1pbnlvcmcsIHl2YWx1ZXMpXTtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LmRyYXdDaXJjbGUoY2FudmFzTGVmdCArIE1hdGgucm91bmQoKHggLSB0aGlzLm1pbngpICogKGNhbnZhc1dpZHRoIC8gcmFuZ2V4KSksXG4gICAgICAgICAgICAgICAgICAgICAgICBjYW52YXNUb3AgKyBNYXRoLnJvdW5kKGNhbnZhc0hlaWdodCAtIChjYW52YXNIZWlnaHQgKiAoKHRoaXMubWlueW9yZyAtIHRoaXMubWlueSkgLyByYW5nZXkpKSksXG4gICAgICAgICAgICAgICAgICAgICAgICBzcG90UmFkaXVzLCB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmdldCgnbWluU3BvdENvbG9yJykpLmFwcGVuZCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoc3BvdFJhZGl1cyAmJiBvcHRpb25zLmdldCgnbWF4U3BvdENvbG9yJykpIHtcbiAgICAgICAgICAgICAgICAgICAgeCA9IHh2YWx1ZXNbJC5pbkFycmF5KHRoaXMubWF4eW9yZywgeXZhbHVlcyldO1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXQuZHJhd0NpcmNsZShjYW52YXNMZWZ0ICsgTWF0aC5yb3VuZCgoeCAtIHRoaXMubWlueCkgKiAoY2FudmFzV2lkdGggLyByYW5nZXgpKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbnZhc1RvcCArIE1hdGgucm91bmQoY2FudmFzSGVpZ2h0IC0gKGNhbnZhc0hlaWdodCAqICgodGhpcy5tYXh5b3JnIC0gdGhpcy5taW55KSAvIHJhbmdleSkpKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNwb3RSYWRpdXMsIHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZ2V0KCdtYXhTcG90Q29sb3InKSkuYXBwZW5kKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLmxhc3RTaGFwZUlkID0gdGFyZ2V0LmdldExhc3RTaGFwZUlkKCk7XG4gICAgICAgICAgICB0aGlzLmNhbnZhc1RvcCA9IGNhbnZhc1RvcDtcbiAgICAgICAgICAgIHRhcmdldC5yZW5kZXIoKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQmFyIGNoYXJ0c1xuICAgICAqL1xuICAgICQuZm4uc3BhcmtsaW5lLmJhciA9IGJhciA9IGNyZWF0ZUNsYXNzKCQuZm4uc3BhcmtsaW5lLl9iYXNlLCBiYXJIaWdobGlnaHRNaXhpbiwge1xuICAgICAgICB0eXBlOiAnYmFyJyxcblxuICAgICAgICBpbml0OiBmdW5jdGlvbiAoZWwsIHZhbHVlcywgb3B0aW9ucywgd2lkdGgsIGhlaWdodCkge1xuICAgICAgICAgICAgdmFyIGJhcldpZHRoID0gcGFyc2VJbnQob3B0aW9ucy5nZXQoJ2JhcldpZHRoJyksIDEwKSxcbiAgICAgICAgICAgICAgICBiYXJTcGFjaW5nID0gcGFyc2VJbnQob3B0aW9ucy5nZXQoJ2JhclNwYWNpbmcnKSwgMTApLFxuICAgICAgICAgICAgICAgIGNoYXJ0UmFuZ2VNaW4gPSBvcHRpb25zLmdldCgnY2hhcnRSYW5nZU1pbicpLFxuICAgICAgICAgICAgICAgIGNoYXJ0UmFuZ2VNYXggPSBvcHRpb25zLmdldCgnY2hhcnRSYW5nZU1heCcpLFxuICAgICAgICAgICAgICAgIGNoYXJ0UmFuZ2VDbGlwID0gb3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VDbGlwJyksXG4gICAgICAgICAgICAgICAgc3RhY2tNaW4gPSBJbmZpbml0eSxcbiAgICAgICAgICAgICAgICBzdGFja01heCA9IC1JbmZpbml0eSxcbiAgICAgICAgICAgICAgICBpc1N0YWNrU3RyaW5nLCBncm91cE1pbiwgZ3JvdXBNYXgsIHN0YWNrUmFuZ2VzLFxuICAgICAgICAgICAgICAgIG51bVZhbHVlcywgaSwgdmxlbiwgcmFuZ2UsIHplcm9BeGlzLCB4YXhpc09mZnNldCwgbWluLCBtYXgsIGNsaXBNaW4sIGNsaXBNYXgsXG4gICAgICAgICAgICAgICAgc3RhY2tlZCwgdmxpc3QsIGosIHNsZW4sIHN2YWxzLCB2YWwsIHlvZmZzZXQsIHlNYXhDYWxjLCBjYW52YXNIZWlnaHRFZjtcbiAgICAgICAgICAgIGJhci5fc3VwZXIuaW5pdC5jYWxsKHRoaXMsIGVsLCB2YWx1ZXMsIG9wdGlvbnMsIHdpZHRoLCBoZWlnaHQpO1xuXG4gICAgICAgICAgICAvLyBzY2FuIHZhbHVlcyB0byBkZXRlcm1pbmUgd2hldGhlciB0byBzdGFjayBiYXJzXG4gICAgICAgICAgICBmb3IgKGkgPSAwLCB2bGVuID0gdmFsdWVzLmxlbmd0aDsgaSA8IHZsZW47IGkrKykge1xuICAgICAgICAgICAgICAgIHZhbCA9IHZhbHVlc1tpXTtcbiAgICAgICAgICAgICAgICBpc1N0YWNrU3RyaW5nID0gdHlwZW9mKHZhbCkgPT09ICdzdHJpbmcnICYmIHZhbC5pbmRleE9mKCc6JykgPiAtMTtcbiAgICAgICAgICAgICAgICBpZiAoaXNTdGFja1N0cmluZyB8fCAkLmlzQXJyYXkodmFsKSkge1xuICAgICAgICAgICAgICAgICAgICBzdGFja2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzU3RhY2tTdHJpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbCA9IHZhbHVlc1tpXSA9IG5vcm1hbGl6ZVZhbHVlcyh2YWwuc3BsaXQoJzonKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFsID0gcmVtb3ZlKHZhbCwgbnVsbCk7IC8vIG1pbi9tYXggd2lsbCB0cmVhdCBudWxsIGFzIHplcm9cbiAgICAgICAgICAgICAgICAgICAgZ3JvdXBNaW4gPSBNYXRoLm1pbi5hcHBseShNYXRoLCB2YWwpO1xuICAgICAgICAgICAgICAgICAgICBncm91cE1heCA9IE1hdGgubWF4LmFwcGx5KE1hdGgsIHZhbCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChncm91cE1pbiA8IHN0YWNrTWluKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFja01pbiA9IGdyb3VwTWluO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChncm91cE1heCA+IHN0YWNrTWF4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFja01heCA9IGdyb3VwTWF4O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLnN0YWNrZWQgPSBzdGFja2VkO1xuICAgICAgICAgICAgdGhpcy5yZWdpb25TaGFwZXMgPSB7fTtcbiAgICAgICAgICAgIHRoaXMuYmFyV2lkdGggPSBiYXJXaWR0aDtcbiAgICAgICAgICAgIHRoaXMuYmFyU3BhY2luZyA9IGJhclNwYWNpbmc7XG4gICAgICAgICAgICB0aGlzLnRvdGFsQmFyV2lkdGggPSBiYXJXaWR0aCArIGJhclNwYWNpbmc7XG4gICAgICAgICAgICB0aGlzLndpZHRoID0gd2lkdGggPSAodmFsdWVzLmxlbmd0aCAqIGJhcldpZHRoKSArICgodmFsdWVzLmxlbmd0aCAtIDEpICogYmFyU3BhY2luZyk7XG5cbiAgICAgICAgICAgIHRoaXMuaW5pdFRhcmdldCgpO1xuXG4gICAgICAgICAgICBpZiAoY2hhcnRSYW5nZUNsaXApIHtcbiAgICAgICAgICAgICAgICBjbGlwTWluID0gY2hhcnRSYW5nZU1pbiA9PT0gdW5kZWZpbmVkID8gLUluZmluaXR5IDogY2hhcnRSYW5nZU1pbjtcbiAgICAgICAgICAgICAgICBjbGlwTWF4ID0gY2hhcnRSYW5nZU1heCA9PT0gdW5kZWZpbmVkID8gSW5maW5pdHkgOiBjaGFydFJhbmdlTWF4O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBudW1WYWx1ZXMgPSBbXTtcbiAgICAgICAgICAgIHN0YWNrUmFuZ2VzID0gc3RhY2tlZCA/IFtdIDogbnVtVmFsdWVzO1xuICAgICAgICAgICAgdmFyIHN0YWNrVG90YWxzID0gW107XG4gICAgICAgICAgICB2YXIgc3RhY2tSYW5nZXNOZWcgPSBbXTtcbiAgICAgICAgICAgIGZvciAoaSA9IDAsIHZsZW4gPSB2YWx1ZXMubGVuZ3RoOyBpIDwgdmxlbjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKHN0YWNrZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmxpc3QgPSB2YWx1ZXNbaV07XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlc1tpXSA9IHN2YWxzID0gW107XG4gICAgICAgICAgICAgICAgICAgIHN0YWNrVG90YWxzW2ldID0gMDtcbiAgICAgICAgICAgICAgICAgICAgc3RhY2tSYW5nZXNbaV0gPSBzdGFja1Jhbmdlc05lZ1tpXSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoaiA9IDAsIHNsZW4gPSB2bGlzdC5sZW5ndGg7IGogPCBzbGVuOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbCA9IHN2YWxzW2pdID0gY2hhcnRSYW5nZUNsaXAgPyBjbGlwdmFsKHZsaXN0W2pdLCBjbGlwTWluLCBjbGlwTWF4KSA6IHZsaXN0W2pdO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhbCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWwgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrVG90YWxzW2ldICs9IHZhbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0YWNrTWluIDwgMCAmJiBzdGFja01heCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhbCA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrUmFuZ2VzTmVnW2ldICs9IE1hdGguYWJzKHZhbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFja1Jhbmdlc1tpXSArPSB2YWw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFja1Jhbmdlc1tpXSArPSBNYXRoLmFicyh2YWwgLSAodmFsIDwgMCA/IHN0YWNrTWF4IDogc3RhY2tNaW4pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVtVmFsdWVzLnB1c2godmFsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbCA9IGNoYXJ0UmFuZ2VDbGlwID8gY2xpcHZhbCh2YWx1ZXNbaV0sIGNsaXBNaW4sIGNsaXBNYXgpIDogdmFsdWVzW2ldO1xuICAgICAgICAgICAgICAgICAgICB2YWwgPSB2YWx1ZXNbaV0gPSBub3JtYWxpemVWYWx1ZSh2YWwpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodmFsICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBudW1WYWx1ZXMucHVzaCh2YWwpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5tYXggPSBtYXggPSBNYXRoLm1heC5hcHBseShNYXRoLCBudW1WYWx1ZXMpO1xuICAgICAgICAgICAgdGhpcy5taW4gPSBtaW4gPSBNYXRoLm1pbi5hcHBseShNYXRoLCBudW1WYWx1ZXMpO1xuICAgICAgICAgICAgdGhpcy5zdGFja01heCA9IHN0YWNrTWF4ID0gc3RhY2tlZCA/IE1hdGgubWF4LmFwcGx5KE1hdGgsIHN0YWNrVG90YWxzKSA6IG1heDtcbiAgICAgICAgICAgIHRoaXMuc3RhY2tNaW4gPSBzdGFja01pbiA9IHN0YWNrZWQgPyBNYXRoLm1pbi5hcHBseShNYXRoLCBudW1WYWx1ZXMpIDogbWluO1xuXG4gICAgICAgICAgICBpZiAob3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNaW4nKSAhPT0gdW5kZWZpbmVkICYmIChvcHRpb25zLmdldCgnY2hhcnRSYW5nZUNsaXAnKSB8fCBvcHRpb25zLmdldCgnY2hhcnRSYW5nZU1pbicpIDwgbWluKSkge1xuICAgICAgICAgICAgICAgIG1pbiA9IG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlTWluJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAob3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNYXgnKSAhPT0gdW5kZWZpbmVkICYmIChvcHRpb25zLmdldCgnY2hhcnRSYW5nZUNsaXAnKSB8fCBvcHRpb25zLmdldCgnY2hhcnRSYW5nZU1heCcpID4gbWF4KSkge1xuICAgICAgICAgICAgICAgIG1heCA9IG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlTWF4Jyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuemVyb0F4aXMgPSB6ZXJvQXhpcyA9IG9wdGlvbnMuZ2V0KCd6ZXJvQXhpcycsIHRydWUpO1xuICAgICAgICAgICAgaWYgKG1pbiA8PSAwICYmIG1heCA+PSAwICYmIHplcm9BeGlzKSB7XG4gICAgICAgICAgICAgICAgeGF4aXNPZmZzZXQgPSAwO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh6ZXJvQXhpcyA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIHhheGlzT2Zmc2V0ID0gbWluO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChtaW4gPiAwKSB7XG4gICAgICAgICAgICAgICAgeGF4aXNPZmZzZXQgPSBtaW47XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHhheGlzT2Zmc2V0ID0gbWF4O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy54YXhpc09mZnNldCA9IHhheGlzT2Zmc2V0O1xuXG4gICAgICAgICAgICByYW5nZSA9IHN0YWNrZWQgPyAoTWF0aC5tYXguYXBwbHkoTWF0aCwgc3RhY2tSYW5nZXMpICsgTWF0aC5tYXguYXBwbHkoTWF0aCwgc3RhY2tSYW5nZXNOZWcpKSA6IG1heCAtIG1pbjtcblxuICAgICAgICAgICAgLy8gYXMgd2UgcGxvdCB6ZXJvL21pbiB2YWx1ZXMgYSBzaW5nbGUgcGl4ZWwgbGluZSwgd2UgYWRkIGEgcGl4ZWwgdG8gYWxsIG90aGVyXG4gICAgICAgICAgICAvLyB2YWx1ZXMgLSBSZWR1Y2UgdGhlIGVmZmVjdGl2ZSBjYW52YXMgc2l6ZSB0byBzdWl0XG4gICAgICAgICAgICB0aGlzLmNhbnZhc0hlaWdodEVmID0gKHplcm9BeGlzICYmIG1pbiA8IDApID8gdGhpcy5jYW52YXNIZWlnaHQgLSAyIDogdGhpcy5jYW52YXNIZWlnaHQgLSAxO1xuXG4gICAgICAgICAgICBpZiAobWluIDwgeGF4aXNPZmZzZXQpIHtcbiAgICAgICAgICAgICAgICB5TWF4Q2FsYyA9IChzdGFja2VkICYmIG1heCA+PSAwKSA/IHN0YWNrTWF4IDogbWF4O1xuICAgICAgICAgICAgICAgIHlvZmZzZXQgPSAoeU1heENhbGMgLSB4YXhpc09mZnNldCkgLyByYW5nZSAqIHRoaXMuY2FudmFzSGVpZ2h0O1xuICAgICAgICAgICAgICAgIGlmICh5b2Zmc2V0ICE9PSBNYXRoLmNlaWwoeW9mZnNldCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jYW52YXNIZWlnaHRFZiAtPSAyO1xuICAgICAgICAgICAgICAgICAgICB5b2Zmc2V0ID0gTWF0aC5jZWlsKHlvZmZzZXQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgeW9mZnNldCA9IHRoaXMuY2FudmFzSGVpZ2h0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy55b2Zmc2V0ID0geW9mZnNldDtcblxuICAgICAgICAgICAgaWYgKCQuaXNBcnJheShvcHRpb25zLmdldCgnY29sb3JNYXAnKSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbG9yTWFwQnlJbmRleCA9IG9wdGlvbnMuZ2V0KCdjb2xvck1hcCcpO1xuICAgICAgICAgICAgICAgIHRoaXMuY29sb3JNYXBCeVZhbHVlID0gbnVsbDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jb2xvck1hcEJ5SW5kZXggPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMuY29sb3JNYXBCeVZhbHVlID0gb3B0aW9ucy5nZXQoJ2NvbG9yTWFwJyk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY29sb3JNYXBCeVZhbHVlICYmIHRoaXMuY29sb3JNYXBCeVZhbHVlLmdldCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29sb3JNYXBCeVZhbHVlID0gbmV3IFJhbmdlTWFwKHRoaXMuY29sb3JNYXBCeVZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMucmFuZ2UgPSByYW5nZTtcbiAgICAgICAgfSxcblxuICAgICAgICBnZXRSZWdpb246IGZ1bmN0aW9uIChlbCwgeCwgeSkge1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IE1hdGguZmxvb3IoeCAvIHRoaXMudG90YWxCYXJXaWR0aCk7XG4gICAgICAgICAgICByZXR1cm4gKHJlc3VsdCA8IDAgfHwgcmVzdWx0ID49IHRoaXMudmFsdWVzLmxlbmd0aCkgPyB1bmRlZmluZWQgOiByZXN1bHQ7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2V0Q3VycmVudFJlZ2lvbkZpZWxkczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRSZWdpb24gPSB0aGlzLmN1cnJlbnRSZWdpb24sXG4gICAgICAgICAgICAgICAgdmFsdWVzID0gZW5zdXJlQXJyYXkodGhpcy52YWx1ZXNbY3VycmVudFJlZ2lvbl0pLFxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IFtdLFxuICAgICAgICAgICAgICAgIHZhbHVlLCBpO1xuICAgICAgICAgICAgZm9yIChpID0gdmFsdWVzLmxlbmd0aDsgaS0tOykge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWVzW2ldO1xuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgaXNOdWxsOiB2YWx1ZSA9PT0gbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHZhbHVlLFxuICAgICAgICAgICAgICAgICAgICBjb2xvcjogdGhpcy5jYWxjQ29sb3IoaSwgdmFsdWUsIGN1cnJlbnRSZWdpb24pLFxuICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6IGN1cnJlbnRSZWdpb25cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH0sXG5cbiAgICAgICAgY2FsY0NvbG9yOiBmdW5jdGlvbiAoc3RhY2tudW0sIHZhbHVlLCB2YWx1ZW51bSkge1xuICAgICAgICAgICAgdmFyIGNvbG9yTWFwQnlJbmRleCA9IHRoaXMuY29sb3JNYXBCeUluZGV4LFxuICAgICAgICAgICAgICAgIGNvbG9yTWFwQnlWYWx1ZSA9IHRoaXMuY29sb3JNYXBCeVZhbHVlLFxuICAgICAgICAgICAgICAgIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnMsXG4gICAgICAgICAgICAgICAgY29sb3IsIG5ld0NvbG9yO1xuICAgICAgICAgICAgaWYgKHRoaXMuc3RhY2tlZCkge1xuICAgICAgICAgICAgICAgIGNvbG9yID0gb3B0aW9ucy5nZXQoJ3N0YWNrZWRCYXJDb2xvcicpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb2xvciA9ICh2YWx1ZSA8IDApID8gb3B0aW9ucy5nZXQoJ25lZ0JhckNvbG9yJykgOiBvcHRpb25zLmdldCgnYmFyQ29sb3InKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gMCAmJiBvcHRpb25zLmdldCgnemVyb0NvbG9yJykgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGNvbG9yID0gb3B0aW9ucy5nZXQoJ3plcm9Db2xvcicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNvbG9yTWFwQnlWYWx1ZSAmJiAobmV3Q29sb3IgPSBjb2xvck1hcEJ5VmFsdWUuZ2V0KHZhbHVlKSkpIHtcbiAgICAgICAgICAgICAgICBjb2xvciA9IG5ld0NvbG9yO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChjb2xvck1hcEJ5SW5kZXggJiYgY29sb3JNYXBCeUluZGV4Lmxlbmd0aCA+IHZhbHVlbnVtKSB7XG4gICAgICAgICAgICAgICAgY29sb3IgPSBjb2xvck1hcEJ5SW5kZXhbdmFsdWVudW1dO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuICQuaXNBcnJheShjb2xvcikgPyBjb2xvcltzdGFja251bSAlIGNvbG9yLmxlbmd0aF0gOiBjb2xvcjtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogUmVuZGVyIGJhcihzKSBmb3IgYSByZWdpb25cbiAgICAgICAgICovXG4gICAgICAgIHJlbmRlclJlZ2lvbjogZnVuY3Rpb24gKHZhbHVlbnVtLCBoaWdobGlnaHQpIHtcbiAgICAgICAgICAgIHZhciB2YWxzID0gdGhpcy52YWx1ZXNbdmFsdWVudW1dLFxuICAgICAgICAgICAgICAgIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnMsXG4gICAgICAgICAgICAgICAgeGF4aXNPZmZzZXQgPSB0aGlzLnhheGlzT2Zmc2V0LFxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IFtdLFxuICAgICAgICAgICAgICAgIHJhbmdlID0gdGhpcy5yYW5nZSxcbiAgICAgICAgICAgICAgICBzdGFja2VkID0gdGhpcy5zdGFja2VkLFxuICAgICAgICAgICAgICAgIHRhcmdldCA9IHRoaXMudGFyZ2V0LFxuICAgICAgICAgICAgICAgIHggPSB2YWx1ZW51bSAqIHRoaXMudG90YWxCYXJXaWR0aCxcbiAgICAgICAgICAgICAgICBjYW52YXNIZWlnaHRFZiA9IHRoaXMuY2FudmFzSGVpZ2h0RWYsXG4gICAgICAgICAgICAgICAgeW9mZnNldCA9IHRoaXMueW9mZnNldCxcbiAgICAgICAgICAgICAgICB5LCBoZWlnaHQsIGNvbG9yLCBpc051bGwsIHlvZmZzZXROZWcsIGksIHZhbGNvdW50LCB2YWwsIG1pblBsb3R0ZWQsIGFsbE1pbjtcblxuICAgICAgICAgICAgdmFscyA9ICQuaXNBcnJheSh2YWxzKSA/IHZhbHMgOiBbdmFsc107XG4gICAgICAgICAgICB2YWxjb3VudCA9IHZhbHMubGVuZ3RoO1xuICAgICAgICAgICAgdmFsID0gdmFsc1swXTtcbiAgICAgICAgICAgIGlzTnVsbCA9IGFsbChudWxsLCB2YWxzKTtcbiAgICAgICAgICAgIGFsbE1pbiA9IGFsbCh4YXhpc09mZnNldCwgdmFscywgdHJ1ZSk7XG5cbiAgICAgICAgICAgIGlmIChpc051bGwpIHtcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5nZXQoJ251bGxDb2xvcicpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbG9yID0gaGlnaGxpZ2h0ID8gb3B0aW9ucy5nZXQoJ251bGxDb2xvcicpIDogdGhpcy5jYWxjSGlnaGxpZ2h0Q29sb3Iob3B0aW9ucy5nZXQoJ251bGxDb2xvcicpLCBvcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgeSA9ICh5b2Zmc2V0ID4gMCkgPyB5b2Zmc2V0IC0gMSA6IHlvZmZzZXQ7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXQuZHJhd1JlY3QoeCwgeSwgdGhpcy5iYXJXaWR0aCAtIDEsIDAsIGNvbG9yLCBjb2xvcik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB5b2Zmc2V0TmVnID0geW9mZnNldDtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCB2YWxjb3VudDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFsID0gdmFsc1tpXTtcblxuICAgICAgICAgICAgICAgIGlmIChzdGFja2VkICYmIHZhbCA9PT0geGF4aXNPZmZzZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFhbGxNaW4gfHwgbWluUGxvdHRlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbWluUGxvdHRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHJhbmdlID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBoZWlnaHQgPSBNYXRoLmZsb29yKGNhbnZhc0hlaWdodEVmICogKChNYXRoLmFicyh2YWwgLSB4YXhpc09mZnNldCkgLyByYW5nZSkpKSArIDE7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0ID0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHZhbCA8IHhheGlzT2Zmc2V0IHx8ICh2YWwgPT09IHhheGlzT2Zmc2V0ICYmIHlvZmZzZXQgPT09IDApKSB7XG4gICAgICAgICAgICAgICAgICAgIHkgPSB5b2Zmc2V0TmVnO1xuICAgICAgICAgICAgICAgICAgICB5b2Zmc2V0TmVnICs9IGhlaWdodDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB5ID0geW9mZnNldCAtIGhlaWdodDtcbiAgICAgICAgICAgICAgICAgICAgeW9mZnNldCAtPSBoZWlnaHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbG9yID0gdGhpcy5jYWxjQ29sb3IoaSwgdmFsLCB2YWx1ZW51bSk7XG4gICAgICAgICAgICAgICAgaWYgKGhpZ2hsaWdodCkge1xuICAgICAgICAgICAgICAgICAgICBjb2xvciA9IHRoaXMuY2FsY0hpZ2hsaWdodENvbG9yKGNvbG9yLCBvcHRpb25zKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2godGFyZ2V0LmRyYXdSZWN0KHgsIHksIHRoaXMuYmFyV2lkdGggLSAxLCBoZWlnaHQgLSAxLCBjb2xvciwgY29sb3IpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChyZXN1bHQubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdFswXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFRyaXN0YXRlIGNoYXJ0c1xuICAgICAqL1xuICAgICQuZm4uc3BhcmtsaW5lLnRyaXN0YXRlID0gdHJpc3RhdGUgPSBjcmVhdGVDbGFzcygkLmZuLnNwYXJrbGluZS5fYmFzZSwgYmFySGlnaGxpZ2h0TWl4aW4sIHtcbiAgICAgICAgdHlwZTogJ3RyaXN0YXRlJyxcblxuICAgICAgICBpbml0OiBmdW5jdGlvbiAoZWwsIHZhbHVlcywgb3B0aW9ucywgd2lkdGgsIGhlaWdodCkge1xuICAgICAgICAgICAgdmFyIGJhcldpZHRoID0gcGFyc2VJbnQob3B0aW9ucy5nZXQoJ2JhcldpZHRoJyksIDEwKSxcbiAgICAgICAgICAgICAgICBiYXJTcGFjaW5nID0gcGFyc2VJbnQob3B0aW9ucy5nZXQoJ2JhclNwYWNpbmcnKSwgMTApO1xuICAgICAgICAgICAgdHJpc3RhdGUuX3N1cGVyLmluaXQuY2FsbCh0aGlzLCBlbCwgdmFsdWVzLCBvcHRpb25zLCB3aWR0aCwgaGVpZ2h0KTtcblxuICAgICAgICAgICAgdGhpcy5yZWdpb25TaGFwZXMgPSB7fTtcbiAgICAgICAgICAgIHRoaXMuYmFyV2lkdGggPSBiYXJXaWR0aDtcbiAgICAgICAgICAgIHRoaXMuYmFyU3BhY2luZyA9IGJhclNwYWNpbmc7XG4gICAgICAgICAgICB0aGlzLnRvdGFsQmFyV2lkdGggPSBiYXJXaWR0aCArIGJhclNwYWNpbmc7XG4gICAgICAgICAgICB0aGlzLnZhbHVlcyA9ICQubWFwKHZhbHVlcywgTnVtYmVyKTtcbiAgICAgICAgICAgIHRoaXMud2lkdGggPSB3aWR0aCA9ICh2YWx1ZXMubGVuZ3RoICogYmFyV2lkdGgpICsgKCh2YWx1ZXMubGVuZ3RoIC0gMSkgKiBiYXJTcGFjaW5nKTtcblxuICAgICAgICAgICAgaWYgKCQuaXNBcnJheShvcHRpb25zLmdldCgnY29sb3JNYXAnKSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbG9yTWFwQnlJbmRleCA9IG9wdGlvbnMuZ2V0KCdjb2xvck1hcCcpO1xuICAgICAgICAgICAgICAgIHRoaXMuY29sb3JNYXBCeVZhbHVlID0gbnVsbDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jb2xvck1hcEJ5SW5kZXggPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMuY29sb3JNYXBCeVZhbHVlID0gb3B0aW9ucy5nZXQoJ2NvbG9yTWFwJyk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY29sb3JNYXBCeVZhbHVlICYmIHRoaXMuY29sb3JNYXBCeVZhbHVlLmdldCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29sb3JNYXBCeVZhbHVlID0gbmV3IFJhbmdlTWFwKHRoaXMuY29sb3JNYXBCeVZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmluaXRUYXJnZXQoKTtcbiAgICAgICAgfSxcblxuICAgICAgICBnZXRSZWdpb246IGZ1bmN0aW9uIChlbCwgeCwgeSkge1xuICAgICAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoeCAvIHRoaXMudG90YWxCYXJXaWR0aCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2V0Q3VycmVudFJlZ2lvbkZpZWxkczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRSZWdpb24gPSB0aGlzLmN1cnJlbnRSZWdpb247XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGlzTnVsbDogdGhpcy52YWx1ZXNbY3VycmVudFJlZ2lvbl0gPT09IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy52YWx1ZXNbY3VycmVudFJlZ2lvbl0sXG4gICAgICAgICAgICAgICAgY29sb3I6IHRoaXMuY2FsY0NvbG9yKHRoaXMudmFsdWVzW2N1cnJlbnRSZWdpb25dLCBjdXJyZW50UmVnaW9uKSxcbiAgICAgICAgICAgICAgICBvZmZzZXQ6IGN1cnJlbnRSZWdpb25cbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG5cbiAgICAgICAgY2FsY0NvbG9yOiBmdW5jdGlvbiAodmFsdWUsIHZhbHVlbnVtKSB7XG4gICAgICAgICAgICB2YXIgdmFsdWVzID0gdGhpcy52YWx1ZXMsXG4gICAgICAgICAgICAgICAgb3B0aW9ucyA9IHRoaXMub3B0aW9ucyxcbiAgICAgICAgICAgICAgICBjb2xvck1hcEJ5SW5kZXggPSB0aGlzLmNvbG9yTWFwQnlJbmRleCxcbiAgICAgICAgICAgICAgICBjb2xvck1hcEJ5VmFsdWUgPSB0aGlzLmNvbG9yTWFwQnlWYWx1ZSxcbiAgICAgICAgICAgICAgICBjb2xvciwgbmV3Q29sb3I7XG5cbiAgICAgICAgICAgIGlmIChjb2xvck1hcEJ5VmFsdWUgJiYgKG5ld0NvbG9yID0gY29sb3JNYXBCeVZhbHVlLmdldCh2YWx1ZSkpKSB7XG4gICAgICAgICAgICAgICAgY29sb3IgPSBuZXdDb2xvcjtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoY29sb3JNYXBCeUluZGV4ICYmIGNvbG9yTWFwQnlJbmRleC5sZW5ndGggPiB2YWx1ZW51bSkge1xuICAgICAgICAgICAgICAgIGNvbG9yID0gY29sb3JNYXBCeUluZGV4W3ZhbHVlbnVtXTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodmFsdWVzW3ZhbHVlbnVtXSA8IDApIHtcbiAgICAgICAgICAgICAgICBjb2xvciA9IG9wdGlvbnMuZ2V0KCduZWdCYXJDb2xvcicpO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZXNbdmFsdWVudW1dID4gMCkge1xuICAgICAgICAgICAgICAgIGNvbG9yID0gb3B0aW9ucy5nZXQoJ3Bvc0JhckNvbG9yJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbG9yID0gb3B0aW9ucy5nZXQoJ3plcm9CYXJDb2xvcicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGNvbG9yO1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlbmRlclJlZ2lvbjogZnVuY3Rpb24gKHZhbHVlbnVtLCBoaWdobGlnaHQpIHtcbiAgICAgICAgICAgIHZhciB2YWx1ZXMgPSB0aGlzLnZhbHVlcyxcbiAgICAgICAgICAgICAgICBvcHRpb25zID0gdGhpcy5vcHRpb25zLFxuICAgICAgICAgICAgICAgIHRhcmdldCA9IHRoaXMudGFyZ2V0LFxuICAgICAgICAgICAgICAgIGNhbnZhc0hlaWdodCwgaGVpZ2h0LCBoYWxmSGVpZ2h0LFxuICAgICAgICAgICAgICAgIHgsIHksIGNvbG9yO1xuXG4gICAgICAgICAgICBjYW52YXNIZWlnaHQgPSB0YXJnZXQucGl4ZWxIZWlnaHQ7XG4gICAgICAgICAgICBoYWxmSGVpZ2h0ID0gTWF0aC5yb3VuZChjYW52YXNIZWlnaHQgLyAyKTtcblxuICAgICAgICAgICAgeCA9IHZhbHVlbnVtICogdGhpcy50b3RhbEJhcldpZHRoO1xuICAgICAgICAgICAgaWYgKHZhbHVlc1t2YWx1ZW51bV0gPCAwKSB7XG4gICAgICAgICAgICAgICAgeSA9IGhhbGZIZWlnaHQ7XG4gICAgICAgICAgICAgICAgaGVpZ2h0ID0gaGFsZkhlaWdodCAtIDE7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlc1t2YWx1ZW51bV0gPiAwKSB7XG4gICAgICAgICAgICAgICAgeSA9IDA7XG4gICAgICAgICAgICAgICAgaGVpZ2h0ID0gaGFsZkhlaWdodCAtIDE7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHkgPSBoYWxmSGVpZ2h0IC0gMTtcbiAgICAgICAgICAgICAgICBoZWlnaHQgPSAyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29sb3IgPSB0aGlzLmNhbGNDb2xvcih2YWx1ZXNbdmFsdWVudW1dLCB2YWx1ZW51bSk7XG4gICAgICAgICAgICBpZiAoY29sb3IgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaGlnaGxpZ2h0KSB7XG4gICAgICAgICAgICAgICAgY29sb3IgPSB0aGlzLmNhbGNIaWdobGlnaHRDb2xvcihjb2xvciwgb3B0aW9ucyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGFyZ2V0LmRyYXdSZWN0KHgsIHksIHRoaXMuYmFyV2lkdGggLSAxLCBoZWlnaHQgLSAxLCBjb2xvciwgY29sb3IpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBEaXNjcmV0ZSBjaGFydHNcbiAgICAgKi9cbiAgICAkLmZuLnNwYXJrbGluZS5kaXNjcmV0ZSA9IGRpc2NyZXRlID0gY3JlYXRlQ2xhc3MoJC5mbi5zcGFya2xpbmUuX2Jhc2UsIGJhckhpZ2hsaWdodE1peGluLCB7XG4gICAgICAgIHR5cGU6ICdkaXNjcmV0ZScsXG5cbiAgICAgICAgaW5pdDogZnVuY3Rpb24gKGVsLCB2YWx1ZXMsIG9wdGlvbnMsIHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgICAgIGRpc2NyZXRlLl9zdXBlci5pbml0LmNhbGwodGhpcywgZWwsIHZhbHVlcywgb3B0aW9ucywgd2lkdGgsIGhlaWdodCk7XG5cbiAgICAgICAgICAgIHRoaXMucmVnaW9uU2hhcGVzID0ge307XG4gICAgICAgICAgICB0aGlzLnZhbHVlcyA9IHZhbHVlcyA9ICQubWFwKHZhbHVlcywgTnVtYmVyKTtcbiAgICAgICAgICAgIHRoaXMubWluID0gTWF0aC5taW4uYXBwbHkoTWF0aCwgdmFsdWVzKTtcbiAgICAgICAgICAgIHRoaXMubWF4ID0gTWF0aC5tYXguYXBwbHkoTWF0aCwgdmFsdWVzKTtcbiAgICAgICAgICAgIHRoaXMucmFuZ2UgPSB0aGlzLm1heCAtIHRoaXMubWluO1xuICAgICAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoID0gb3B0aW9ucy5nZXQoJ3dpZHRoJykgPT09ICdhdXRvJyA/IHZhbHVlcy5sZW5ndGggKiAyIDogdGhpcy53aWR0aDtcbiAgICAgICAgICAgIHRoaXMuaW50ZXJ2YWwgPSBNYXRoLmZsb29yKHdpZHRoIC8gdmFsdWVzLmxlbmd0aCk7XG4gICAgICAgICAgICB0aGlzLml0ZW1XaWR0aCA9IHdpZHRoIC8gdmFsdWVzLmxlbmd0aDtcbiAgICAgICAgICAgIGlmIChvcHRpb25zLmdldCgnY2hhcnRSYW5nZU1pbicpICE9PSB1bmRlZmluZWQgJiYgKG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlQ2xpcCcpIHx8IG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlTWluJykgPCB0aGlzLm1pbikpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1pbiA9IG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlTWluJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAob3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNYXgnKSAhPT0gdW5kZWZpbmVkICYmIChvcHRpb25zLmdldCgnY2hhcnRSYW5nZUNsaXAnKSB8fCBvcHRpb25zLmdldCgnY2hhcnRSYW5nZU1heCcpID4gdGhpcy5tYXgpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5tYXggPSBvcHRpb25zLmdldCgnY2hhcnRSYW5nZU1heCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5pbml0VGFyZ2V0KCk7XG4gICAgICAgICAgICBpZiAodGhpcy50YXJnZXQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxpbmVIZWlnaHQgPSBvcHRpb25zLmdldCgnbGluZUhlaWdodCcpID09PSAnYXV0bycgPyBNYXRoLnJvdW5kKHRoaXMuY2FudmFzSGVpZ2h0ICogMC4zKSA6IG9wdGlvbnMuZ2V0KCdsaW5lSGVpZ2h0Jyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2V0UmVnaW9uOiBmdW5jdGlvbiAoZWwsIHgsIHkpIHtcbiAgICAgICAgICAgIHJldHVybiBNYXRoLmZsb29yKHggLyB0aGlzLml0ZW1XaWR0aCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2V0Q3VycmVudFJlZ2lvbkZpZWxkczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRSZWdpb24gPSB0aGlzLmN1cnJlbnRSZWdpb247XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGlzTnVsbDogdGhpcy52YWx1ZXNbY3VycmVudFJlZ2lvbl0gPT09IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy52YWx1ZXNbY3VycmVudFJlZ2lvbl0sXG4gICAgICAgICAgICAgICAgb2Zmc2V0OiBjdXJyZW50UmVnaW9uXG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlbmRlclJlZ2lvbjogZnVuY3Rpb24gKHZhbHVlbnVtLCBoaWdobGlnaHQpIHtcbiAgICAgICAgICAgIHZhciB2YWx1ZXMgPSB0aGlzLnZhbHVlcyxcbiAgICAgICAgICAgICAgICBvcHRpb25zID0gdGhpcy5vcHRpb25zLFxuICAgICAgICAgICAgICAgIG1pbiA9IHRoaXMubWluLFxuICAgICAgICAgICAgICAgIG1heCA9IHRoaXMubWF4LFxuICAgICAgICAgICAgICAgIHJhbmdlID0gdGhpcy5yYW5nZSxcbiAgICAgICAgICAgICAgICBpbnRlcnZhbCA9IHRoaXMuaW50ZXJ2YWwsXG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0gdGhpcy50YXJnZXQsXG4gICAgICAgICAgICAgICAgY2FudmFzSGVpZ2h0ID0gdGhpcy5jYW52YXNIZWlnaHQsXG4gICAgICAgICAgICAgICAgbGluZUhlaWdodCA9IHRoaXMubGluZUhlaWdodCxcbiAgICAgICAgICAgICAgICBwaGVpZ2h0ID0gY2FudmFzSGVpZ2h0IC0gbGluZUhlaWdodCxcbiAgICAgICAgICAgICAgICB5dG9wLCB2YWwsIGNvbG9yLCB4O1xuXG4gICAgICAgICAgICB2YWwgPSBjbGlwdmFsKHZhbHVlc1t2YWx1ZW51bV0sIG1pbiwgbWF4KTtcbiAgICAgICAgICAgIHggPSB2YWx1ZW51bSAqIGludGVydmFsO1xuICAgICAgICAgICAgeXRvcCA9IE1hdGgucm91bmQocGhlaWdodCAtIHBoZWlnaHQgKiAoKHZhbCAtIG1pbikgLyByYW5nZSkpO1xuICAgICAgICAgICAgY29sb3IgPSAob3B0aW9ucy5nZXQoJ3RocmVzaG9sZENvbG9yJykgJiYgdmFsIDwgb3B0aW9ucy5nZXQoJ3RocmVzaG9sZFZhbHVlJykpID8gb3B0aW9ucy5nZXQoJ3RocmVzaG9sZENvbG9yJykgOiBvcHRpb25zLmdldCgnbGluZUNvbG9yJyk7XG4gICAgICAgICAgICBpZiAoaGlnaGxpZ2h0KSB7XG4gICAgICAgICAgICAgICAgY29sb3IgPSB0aGlzLmNhbGNIaWdobGlnaHRDb2xvcihjb2xvciwgb3B0aW9ucyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGFyZ2V0LmRyYXdMaW5lKHgsIHl0b3AsIHgsIHl0b3AgKyBsaW5lSGVpZ2h0LCBjb2xvcik7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIEJ1bGxldCBjaGFydHNcbiAgICAgKi9cbiAgICAkLmZuLnNwYXJrbGluZS5idWxsZXQgPSBidWxsZXQgPSBjcmVhdGVDbGFzcygkLmZuLnNwYXJrbGluZS5fYmFzZSwge1xuICAgICAgICB0eXBlOiAnYnVsbGV0JyxcblxuICAgICAgICBpbml0OiBmdW5jdGlvbiAoZWwsIHZhbHVlcywgb3B0aW9ucywgd2lkdGgsIGhlaWdodCkge1xuICAgICAgICAgICAgdmFyIG1pbiwgbWF4LCB2YWxzO1xuICAgICAgICAgICAgYnVsbGV0Ll9zdXBlci5pbml0LmNhbGwodGhpcywgZWwsIHZhbHVlcywgb3B0aW9ucywgd2lkdGgsIGhlaWdodCk7XG5cbiAgICAgICAgICAgIC8vIHZhbHVlczogdGFyZ2V0LCBwZXJmb3JtYW5jZSwgcmFuZ2UxLCByYW5nZTIsIHJhbmdlM1xuICAgICAgICAgICAgdGhpcy52YWx1ZXMgPSB2YWx1ZXMgPSBub3JtYWxpemVWYWx1ZXModmFsdWVzKTtcbiAgICAgICAgICAgIC8vIHRhcmdldCBvciBwZXJmb3JtYW5jZSBjb3VsZCBiZSBudWxsXG4gICAgICAgICAgICB2YWxzID0gdmFsdWVzLnNsaWNlKCk7XG4gICAgICAgICAgICB2YWxzWzBdID0gdmFsc1swXSA9PT0gbnVsbCA/IHZhbHNbMl0gOiB2YWxzWzBdO1xuICAgICAgICAgICAgdmFsc1sxXSA9IHZhbHVlc1sxXSA9PT0gbnVsbCA/IHZhbHNbMl0gOiB2YWxzWzFdO1xuICAgICAgICAgICAgbWluID0gTWF0aC5taW4uYXBwbHkoTWF0aCwgdmFsdWVzKTtcbiAgICAgICAgICAgIG1heCA9IE1hdGgubWF4LmFwcGx5KE1hdGgsIHZhbHVlcyk7XG4gICAgICAgICAgICBpZiAob3B0aW9ucy5nZXQoJ2Jhc2UnKSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgbWluID0gbWluIDwgMCA/IG1pbiA6IDA7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG1pbiA9IG9wdGlvbnMuZ2V0KCdiYXNlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm1pbiA9IG1pbjtcbiAgICAgICAgICAgIHRoaXMubWF4ID0gbWF4O1xuICAgICAgICAgICAgdGhpcy5yYW5nZSA9IG1heCAtIG1pbjtcbiAgICAgICAgICAgIHRoaXMuc2hhcGVzID0ge307XG4gICAgICAgICAgICB0aGlzLnZhbHVlU2hhcGVzID0ge307XG4gICAgICAgICAgICB0aGlzLnJlZ2lvbmRhdGEgPSB7fTtcbiAgICAgICAgICAgIHRoaXMud2lkdGggPSB3aWR0aCA9IG9wdGlvbnMuZ2V0KCd3aWR0aCcpID09PSAnYXV0bycgPyAnNC4wZW0nIDogd2lkdGg7XG4gICAgICAgICAgICB0aGlzLnRhcmdldCA9IHRoaXMuJGVsLnNpbXBsZWRyYXcod2lkdGgsIGhlaWdodCwgb3B0aW9ucy5nZXQoJ2NvbXBvc2l0ZScpKTtcbiAgICAgICAgICAgIGlmICghdmFsdWVzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5pbml0VGFyZ2V0KCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2V0UmVnaW9uOiBmdW5jdGlvbiAoZWwsIHgsIHkpIHtcbiAgICAgICAgICAgIHZhciBzaGFwZWlkID0gdGhpcy50YXJnZXQuZ2V0U2hhcGVBdChlbCwgeCwgeSk7XG4gICAgICAgICAgICByZXR1cm4gKHNoYXBlaWQgIT09IHVuZGVmaW5lZCAmJiB0aGlzLnNoYXBlc1tzaGFwZWlkXSAhPT0gdW5kZWZpbmVkKSA/IHRoaXMuc2hhcGVzW3NoYXBlaWRdIDogdW5kZWZpbmVkO1xuICAgICAgICB9LFxuXG4gICAgICAgIGdldEN1cnJlbnRSZWdpb25GaWVsZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBjdXJyZW50UmVnaW9uID0gdGhpcy5jdXJyZW50UmVnaW9uO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBmaWVsZGtleTogY3VycmVudFJlZ2lvbi5zdWJzdHIoMCwgMSksXG4gICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMudmFsdWVzW2N1cnJlbnRSZWdpb24uc3Vic3RyKDEpXSxcbiAgICAgICAgICAgICAgICByZWdpb246IGN1cnJlbnRSZWdpb25cbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG5cbiAgICAgICAgY2hhbmdlSGlnaGxpZ2h0OiBmdW5jdGlvbiAoaGlnaGxpZ2h0KSB7XG4gICAgICAgICAgICB2YXIgY3VycmVudFJlZ2lvbiA9IHRoaXMuY3VycmVudFJlZ2lvbixcbiAgICAgICAgICAgICAgICBzaGFwZWlkID0gdGhpcy52YWx1ZVNoYXBlc1tjdXJyZW50UmVnaW9uXSxcbiAgICAgICAgICAgICAgICBzaGFwZTtcbiAgICAgICAgICAgIGRlbGV0ZSB0aGlzLnNoYXBlc1tzaGFwZWlkXTtcbiAgICAgICAgICAgIHN3aXRjaCAoY3VycmVudFJlZ2lvbi5zdWJzdHIoMCwgMSkpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdyJzpcbiAgICAgICAgICAgICAgICAgICAgc2hhcGUgPSB0aGlzLnJlbmRlclJhbmdlKGN1cnJlbnRSZWdpb24uc3Vic3RyKDEpLCBoaWdobGlnaHQpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdwJzpcbiAgICAgICAgICAgICAgICAgICAgc2hhcGUgPSB0aGlzLnJlbmRlclBlcmZvcm1hbmNlKGhpZ2hsaWdodCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ3QnOlxuICAgICAgICAgICAgICAgICAgICBzaGFwZSA9IHRoaXMucmVuZGVyVGFyZ2V0KGhpZ2hsaWdodCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy52YWx1ZVNoYXBlc1tjdXJyZW50UmVnaW9uXSA9IHNoYXBlLmlkO1xuICAgICAgICAgICAgdGhpcy5zaGFwZXNbc2hhcGUuaWRdID0gY3VycmVudFJlZ2lvbjtcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0LnJlcGxhY2VXaXRoU2hhcGUoc2hhcGVpZCwgc2hhcGUpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlbmRlclJhbmdlOiBmdW5jdGlvbiAocm4sIGhpZ2hsaWdodCkge1xuICAgICAgICAgICAgdmFyIHJhbmdldmFsID0gdGhpcy52YWx1ZXNbcm5dLFxuICAgICAgICAgICAgICAgIHJhbmdld2lkdGggPSBNYXRoLnJvdW5kKHRoaXMuY2FudmFzV2lkdGggKiAoKHJhbmdldmFsIC0gdGhpcy5taW4pIC8gdGhpcy5yYW5nZSkpLFxuICAgICAgICAgICAgICAgIGNvbG9yID0gdGhpcy5vcHRpb25zLmdldCgncmFuZ2VDb2xvcnMnKVtybiAtIDJdO1xuICAgICAgICAgICAgaWYgKGhpZ2hsaWdodCkge1xuICAgICAgICAgICAgICAgIGNvbG9yID0gdGhpcy5jYWxjSGlnaGxpZ2h0Q29sb3IoY29sb3IsIHRoaXMub3B0aW9ucyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy50YXJnZXQuZHJhd1JlY3QoMCwgMCwgcmFuZ2V3aWR0aCAtIDEsIHRoaXMuY2FudmFzSGVpZ2h0IC0gMSwgY29sb3IsIGNvbG9yKTtcbiAgICAgICAgfSxcblxuICAgICAgICByZW5kZXJQZXJmb3JtYW5jZTogZnVuY3Rpb24gKGhpZ2hsaWdodCkge1xuICAgICAgICAgICAgdmFyIHBlcmZ2YWwgPSB0aGlzLnZhbHVlc1sxXSxcbiAgICAgICAgICAgICAgICBwZXJmd2lkdGggPSBNYXRoLnJvdW5kKHRoaXMuY2FudmFzV2lkdGggKiAoKHBlcmZ2YWwgLSB0aGlzLm1pbikgLyB0aGlzLnJhbmdlKSksXG4gICAgICAgICAgICAgICAgY29sb3IgPSB0aGlzLm9wdGlvbnMuZ2V0KCdwZXJmb3JtYW5jZUNvbG9yJyk7XG4gICAgICAgICAgICBpZiAoaGlnaGxpZ2h0KSB7XG4gICAgICAgICAgICAgICAgY29sb3IgPSB0aGlzLmNhbGNIaWdobGlnaHRDb2xvcihjb2xvciwgdGhpcy5vcHRpb25zKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLnRhcmdldC5kcmF3UmVjdCgwLCBNYXRoLnJvdW5kKHRoaXMuY2FudmFzSGVpZ2h0ICogMC4zKSwgcGVyZndpZHRoIC0gMSxcbiAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKHRoaXMuY2FudmFzSGVpZ2h0ICogMC40KSAtIDEsIGNvbG9yLCBjb2xvcik7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVuZGVyVGFyZ2V0OiBmdW5jdGlvbiAoaGlnaGxpZ2h0KSB7XG4gICAgICAgICAgICB2YXIgdGFyZ2V0dmFsID0gdGhpcy52YWx1ZXNbMF0sXG4gICAgICAgICAgICAgICAgeCA9IE1hdGgucm91bmQodGhpcy5jYW52YXNXaWR0aCAqICgodGFyZ2V0dmFsIC0gdGhpcy5taW4pIC8gdGhpcy5yYW5nZSkgLSAodGhpcy5vcHRpb25zLmdldCgndGFyZ2V0V2lkdGgnKSAvIDIpKSxcbiAgICAgICAgICAgICAgICB0YXJnZXR0b3AgPSBNYXRoLnJvdW5kKHRoaXMuY2FudmFzSGVpZ2h0ICogMC4xMCksXG4gICAgICAgICAgICAgICAgdGFyZ2V0aGVpZ2h0ID0gdGhpcy5jYW52YXNIZWlnaHQgLSAodGFyZ2V0dG9wICogMiksXG4gICAgICAgICAgICAgICAgY29sb3IgPSB0aGlzLm9wdGlvbnMuZ2V0KCd0YXJnZXRDb2xvcicpO1xuICAgICAgICAgICAgaWYgKGhpZ2hsaWdodCkge1xuICAgICAgICAgICAgICAgIGNvbG9yID0gdGhpcy5jYWxjSGlnaGxpZ2h0Q29sb3IoY29sb3IsIHRoaXMub3B0aW9ucyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy50YXJnZXQuZHJhd1JlY3QoeCwgdGFyZ2V0dG9wLCB0aGlzLm9wdGlvbnMuZ2V0KCd0YXJnZXRXaWR0aCcpIC0gMSwgdGFyZ2V0aGVpZ2h0IC0gMSwgY29sb3IsIGNvbG9yKTtcbiAgICAgICAgfSxcblxuICAgICAgICByZW5kZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB2bGVuID0gdGhpcy52YWx1ZXMubGVuZ3RoLFxuICAgICAgICAgICAgICAgIHRhcmdldCA9IHRoaXMudGFyZ2V0LFxuICAgICAgICAgICAgICAgIGksIHNoYXBlO1xuICAgICAgICAgICAgaWYgKCFidWxsZXQuX3N1cGVyLnJlbmRlci5jYWxsKHRoaXMpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChpID0gMjsgaSA8IHZsZW47IGkrKykge1xuICAgICAgICAgICAgICAgIHNoYXBlID0gdGhpcy5yZW5kZXJSYW5nZShpKS5hcHBlbmQoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNoYXBlc1tzaGFwZS5pZF0gPSAncicgKyBpO1xuICAgICAgICAgICAgICAgIHRoaXMudmFsdWVTaGFwZXNbJ3InICsgaV0gPSBzaGFwZS5pZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnZhbHVlc1sxXSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHNoYXBlID0gdGhpcy5yZW5kZXJQZXJmb3JtYW5jZSgpLmFwcGVuZCgpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2hhcGVzW3NoYXBlLmlkXSA9ICdwMSc7XG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZVNoYXBlcy5wMSA9IHNoYXBlLmlkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMudmFsdWVzWzBdICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgc2hhcGUgPSB0aGlzLnJlbmRlclRhcmdldCgpLmFwcGVuZCgpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2hhcGVzW3NoYXBlLmlkXSA9ICd0MCc7XG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZVNoYXBlcy50MCA9IHNoYXBlLmlkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGFyZ2V0LnJlbmRlcigpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBQaWUgY2hhcnRzXG4gICAgICovXG4gICAgJC5mbi5zcGFya2xpbmUucGllID0gcGllID0gY3JlYXRlQ2xhc3MoJC5mbi5zcGFya2xpbmUuX2Jhc2UsIHtcbiAgICAgICAgdHlwZTogJ3BpZScsXG5cbiAgICAgICAgaW5pdDogZnVuY3Rpb24gKGVsLCB2YWx1ZXMsIG9wdGlvbnMsIHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgICAgIHZhciB0b3RhbCA9IDAsIGk7XG5cbiAgICAgICAgICAgIHBpZS5fc3VwZXIuaW5pdC5jYWxsKHRoaXMsIGVsLCB2YWx1ZXMsIG9wdGlvbnMsIHdpZHRoLCBoZWlnaHQpO1xuXG4gICAgICAgICAgICB0aGlzLnNoYXBlcyA9IHt9OyAvLyBtYXAgc2hhcGUgaWRzIHRvIHZhbHVlIG9mZnNldHNcbiAgICAgICAgICAgIHRoaXMudmFsdWVTaGFwZXMgPSB7fTsgLy8gbWFwcyB2YWx1ZSBvZmZzZXRzIHRvIHNoYXBlIGlkc1xuICAgICAgICAgICAgdGhpcy52YWx1ZXMgPSB2YWx1ZXMgPSAkLm1hcCh2YWx1ZXMsIE51bWJlcik7XG5cbiAgICAgICAgICAgIGlmIChvcHRpb25zLmdldCgnd2lkdGgnKSA9PT0gJ2F1dG8nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy53aWR0aCA9IHRoaXMuaGVpZ2h0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodmFsdWVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSB2YWx1ZXMubGVuZ3RoOyBpLS07KSB7XG4gICAgICAgICAgICAgICAgICAgIHRvdGFsICs9IHZhbHVlc1tpXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnRvdGFsID0gdG90YWw7XG4gICAgICAgICAgICB0aGlzLmluaXRUYXJnZXQoKTtcbiAgICAgICAgICAgIHRoaXMucmFkaXVzID0gTWF0aC5mbG9vcihNYXRoLm1pbih0aGlzLmNhbnZhc1dpZHRoLCB0aGlzLmNhbnZhc0hlaWdodCkgLyAyKTtcbiAgICAgICAgfSxcblxuICAgICAgICBnZXRSZWdpb246IGZ1bmN0aW9uIChlbCwgeCwgeSkge1xuICAgICAgICAgICAgdmFyIHNoYXBlaWQgPSB0aGlzLnRhcmdldC5nZXRTaGFwZUF0KGVsLCB4LCB5KTtcbiAgICAgICAgICAgIHJldHVybiAoc2hhcGVpZCAhPT0gdW5kZWZpbmVkICYmIHRoaXMuc2hhcGVzW3NoYXBlaWRdICE9PSB1bmRlZmluZWQpID8gdGhpcy5zaGFwZXNbc2hhcGVpZF0gOiB1bmRlZmluZWQ7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2V0Q3VycmVudFJlZ2lvbkZpZWxkczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRSZWdpb24gPSB0aGlzLmN1cnJlbnRSZWdpb247XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGlzTnVsbDogdGhpcy52YWx1ZXNbY3VycmVudFJlZ2lvbl0gPT09IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy52YWx1ZXNbY3VycmVudFJlZ2lvbl0sXG4gICAgICAgICAgICAgICAgcGVyY2VudDogdGhpcy52YWx1ZXNbY3VycmVudFJlZ2lvbl0gLyB0aGlzLnRvdGFsICogMTAwLFxuICAgICAgICAgICAgICAgIGNvbG9yOiB0aGlzLm9wdGlvbnMuZ2V0KCdzbGljZUNvbG9ycycpW2N1cnJlbnRSZWdpb24gJSB0aGlzLm9wdGlvbnMuZ2V0KCdzbGljZUNvbG9ycycpLmxlbmd0aF0sXG4gICAgICAgICAgICAgICAgb2Zmc2V0OiBjdXJyZW50UmVnaW9uXG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuXG4gICAgICAgIGNoYW5nZUhpZ2hsaWdodDogZnVuY3Rpb24gKGhpZ2hsaWdodCkge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRSZWdpb24gPSB0aGlzLmN1cnJlbnRSZWdpb24sXG4gICAgICAgICAgICAgICAgIG5ld3NsaWNlID0gdGhpcy5yZW5kZXJTbGljZShjdXJyZW50UmVnaW9uLCBoaWdobGlnaHQpLFxuICAgICAgICAgICAgICAgICBzaGFwZWlkID0gdGhpcy52YWx1ZVNoYXBlc1tjdXJyZW50UmVnaW9uXTtcbiAgICAgICAgICAgIGRlbGV0ZSB0aGlzLnNoYXBlc1tzaGFwZWlkXTtcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0LnJlcGxhY2VXaXRoU2hhcGUoc2hhcGVpZCwgbmV3c2xpY2UpO1xuICAgICAgICAgICAgdGhpcy52YWx1ZVNoYXBlc1tjdXJyZW50UmVnaW9uXSA9IG5ld3NsaWNlLmlkO1xuICAgICAgICAgICAgdGhpcy5zaGFwZXNbbmV3c2xpY2UuaWRdID0gY3VycmVudFJlZ2lvbjtcbiAgICAgICAgfSxcblxuICAgICAgICByZW5kZXJTbGljZTogZnVuY3Rpb24gKHZhbHVlbnVtLCBoaWdobGlnaHQpIHtcbiAgICAgICAgICAgIHZhciB0YXJnZXQgPSB0aGlzLnRhcmdldCxcbiAgICAgICAgICAgICAgICBvcHRpb25zID0gdGhpcy5vcHRpb25zLFxuICAgICAgICAgICAgICAgIHJhZGl1cyA9IHRoaXMucmFkaXVzLFxuICAgICAgICAgICAgICAgIGJvcmRlcldpZHRoID0gb3B0aW9ucy5nZXQoJ2JvcmRlcldpZHRoJyksXG4gICAgICAgICAgICAgICAgb2Zmc2V0ID0gb3B0aW9ucy5nZXQoJ29mZnNldCcpLFxuICAgICAgICAgICAgICAgIGNpcmNsZSA9IDIgKiBNYXRoLlBJLFxuICAgICAgICAgICAgICAgIHZhbHVlcyA9IHRoaXMudmFsdWVzLFxuICAgICAgICAgICAgICAgIHRvdGFsID0gdGhpcy50b3RhbCxcbiAgICAgICAgICAgICAgICBuZXh0ID0gb2Zmc2V0ID8gKDIqTWF0aC5QSSkqKG9mZnNldC8zNjApIDogMCxcbiAgICAgICAgICAgICAgICBzdGFydCwgZW5kLCBpLCB2bGVuLCBjb2xvcjtcblxuICAgICAgICAgICAgdmxlbiA9IHZhbHVlcy5sZW5ndGg7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgdmxlbjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgc3RhcnQgPSBuZXh0O1xuICAgICAgICAgICAgICAgIGVuZCA9IG5leHQ7XG4gICAgICAgICAgICAgICAgaWYgKHRvdGFsID4gMCkgeyAgLy8gYXZvaWQgZGl2aWRlIGJ5IHplcm9cbiAgICAgICAgICAgICAgICAgICAgZW5kID0gbmV4dCArIChjaXJjbGUgKiAodmFsdWVzW2ldIC8gdG90YWwpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlbnVtID09PSBpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbG9yID0gb3B0aW9ucy5nZXQoJ3NsaWNlQ29sb3JzJylbaSAlIG9wdGlvbnMuZ2V0KCdzbGljZUNvbG9ycycpLmxlbmd0aF07XG4gICAgICAgICAgICAgICAgICAgIGlmIChoaWdobGlnaHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yID0gdGhpcy5jYWxjSGlnaGxpZ2h0Q29sb3IoY29sb3IsIG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRhcmdldC5kcmF3UGllU2xpY2UocmFkaXVzLCByYWRpdXMsIHJhZGl1cyAtIGJvcmRlcldpZHRoLCBzdGFydCwgZW5kLCB1bmRlZmluZWQsIGNvbG9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbmV4dCA9IGVuZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICByZW5kZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB0YXJnZXQgPSB0aGlzLnRhcmdldCxcbiAgICAgICAgICAgICAgICB2YWx1ZXMgPSB0aGlzLnZhbHVlcyxcbiAgICAgICAgICAgICAgICBvcHRpb25zID0gdGhpcy5vcHRpb25zLFxuICAgICAgICAgICAgICAgIHJhZGl1cyA9IHRoaXMucmFkaXVzLFxuICAgICAgICAgICAgICAgIGJvcmRlcldpZHRoID0gb3B0aW9ucy5nZXQoJ2JvcmRlcldpZHRoJyksXG4gICAgICAgICAgICAgICAgc2hhcGUsIGk7XG5cbiAgICAgICAgICAgIGlmICghcGllLl9zdXBlci5yZW5kZXIuY2FsbCh0aGlzKSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChib3JkZXJXaWR0aCkge1xuICAgICAgICAgICAgICAgIHRhcmdldC5kcmF3Q2lyY2xlKHJhZGl1cywgcmFkaXVzLCBNYXRoLmZsb29yKHJhZGl1cyAtIChib3JkZXJXaWR0aCAvIDIpKSxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5nZXQoJ2JvcmRlckNvbG9yJyksIHVuZGVmaW5lZCwgYm9yZGVyV2lkdGgpLmFwcGVuZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChpID0gdmFsdWVzLmxlbmd0aDsgaS0tOykge1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZXNbaV0pIHsgLy8gZG9uJ3QgcmVuZGVyIHplcm8gdmFsdWVzXG4gICAgICAgICAgICAgICAgICAgIHNoYXBlID0gdGhpcy5yZW5kZXJTbGljZShpKS5hcHBlbmQoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52YWx1ZVNoYXBlc1tpXSA9IHNoYXBlLmlkOyAvLyBzdG9yZSBqdXN0IHRoZSBzaGFwZWlkXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2hhcGVzW3NoYXBlLmlkXSA9IGk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGFyZ2V0LnJlbmRlcigpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBCb3ggcGxvdHNcbiAgICAgKi9cbiAgICAkLmZuLnNwYXJrbGluZS5ib3ggPSBib3ggPSBjcmVhdGVDbGFzcygkLmZuLnNwYXJrbGluZS5fYmFzZSwge1xuICAgICAgICB0eXBlOiAnYm94JyxcblxuICAgICAgICBpbml0OiBmdW5jdGlvbiAoZWwsIHZhbHVlcywgb3B0aW9ucywgd2lkdGgsIGhlaWdodCkge1xuICAgICAgICAgICAgYm94Ll9zdXBlci5pbml0LmNhbGwodGhpcywgZWwsIHZhbHVlcywgb3B0aW9ucywgd2lkdGgsIGhlaWdodCk7XG4gICAgICAgICAgICB0aGlzLnZhbHVlcyA9ICQubWFwKHZhbHVlcywgTnVtYmVyKTtcbiAgICAgICAgICAgIHRoaXMud2lkdGggPSBvcHRpb25zLmdldCgnd2lkdGgnKSA9PT0gJ2F1dG8nID8gJzQuMGVtJyA6IHdpZHRoO1xuICAgICAgICAgICAgdGhpcy5pbml0VGFyZ2V0KCk7XG4gICAgICAgICAgICBpZiAoIXRoaXMudmFsdWVzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZGlzYWJsZWQgPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTaW11bGF0ZSBhIHNpbmdsZSByZWdpb25cbiAgICAgICAgICovXG4gICAgICAgIGdldFJlZ2lvbjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2V0Q3VycmVudFJlZ2lvbkZpZWxkczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IFtcbiAgICAgICAgICAgICAgICB7IGZpZWxkOiAnbHEnLCB2YWx1ZTogdGhpcy5xdWFydGlsZXNbMF0gfSxcbiAgICAgICAgICAgICAgICB7IGZpZWxkOiAnbWVkJywgdmFsdWU6IHRoaXMucXVhcnRpbGVzWzFdIH0sXG4gICAgICAgICAgICAgICAgeyBmaWVsZDogJ3VxJywgdmFsdWU6IHRoaXMucXVhcnRpbGVzWzJdIH1cbiAgICAgICAgICAgIF07XG4gICAgICAgICAgICBpZiAodGhpcy5sb3V0bGllciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goeyBmaWVsZDogJ2xvJywgdmFsdWU6IHRoaXMubG91dGxpZXJ9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnJvdXRsaWVyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaCh7IGZpZWxkOiAncm8nLCB2YWx1ZTogdGhpcy5yb3V0bGllcn0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMubHdoaXNrZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHsgZmllbGQ6ICdsdycsIHZhbHVlOiB0aGlzLmx3aGlza2VyfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5yd2hpc2tlciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goeyBmaWVsZDogJ3J3JywgdmFsdWU6IHRoaXMucndoaXNrZXJ9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdGFyZ2V0ID0gdGhpcy50YXJnZXQsXG4gICAgICAgICAgICAgICAgdmFsdWVzID0gdGhpcy52YWx1ZXMsXG4gICAgICAgICAgICAgICAgdmxlbiA9IHZhbHVlcy5sZW5ndGgsXG4gICAgICAgICAgICAgICAgb3B0aW9ucyA9IHRoaXMub3B0aW9ucyxcbiAgICAgICAgICAgICAgICBjYW52YXNXaWR0aCA9IHRoaXMuY2FudmFzV2lkdGgsXG4gICAgICAgICAgICAgICAgY2FudmFzSGVpZ2h0ID0gdGhpcy5jYW52YXNIZWlnaHQsXG4gICAgICAgICAgICAgICAgbWluVmFsdWUgPSBvcHRpb25zLmdldCgnY2hhcnRSYW5nZU1pbicpID09PSB1bmRlZmluZWQgPyBNYXRoLm1pbi5hcHBseShNYXRoLCB2YWx1ZXMpIDogb3B0aW9ucy5nZXQoJ2NoYXJ0UmFuZ2VNaW4nKSxcbiAgICAgICAgICAgICAgICBtYXhWYWx1ZSA9IG9wdGlvbnMuZ2V0KCdjaGFydFJhbmdlTWF4JykgPT09IHVuZGVmaW5lZCA/IE1hdGgubWF4LmFwcGx5KE1hdGgsIHZhbHVlcykgOiBvcHRpb25zLmdldCgnY2hhcnRSYW5nZU1heCcpLFxuICAgICAgICAgICAgICAgIGNhbnZhc0xlZnQgPSAwLFxuICAgICAgICAgICAgICAgIGx3aGlza2VyLCBsb3V0bGllciwgaXFyLCBxMSwgcTIsIHEzLCByd2hpc2tlciwgcm91dGxpZXIsIGksXG4gICAgICAgICAgICAgICAgc2l6ZSwgdW5pdFNpemU7XG5cbiAgICAgICAgICAgIGlmICghYm94Ll9zdXBlci5yZW5kZXIuY2FsbCh0aGlzKSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuZ2V0KCdyYXcnKSkge1xuICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLmdldCgnc2hvd091dGxpZXJzJykgJiYgdmFsdWVzLmxlbmd0aCA+IDUpIHtcbiAgICAgICAgICAgICAgICAgICAgbG91dGxpZXIgPSB2YWx1ZXNbMF07XG4gICAgICAgICAgICAgICAgICAgIGx3aGlza2VyID0gdmFsdWVzWzFdO1xuICAgICAgICAgICAgICAgICAgICBxMSA9IHZhbHVlc1syXTtcbiAgICAgICAgICAgICAgICAgICAgcTIgPSB2YWx1ZXNbM107XG4gICAgICAgICAgICAgICAgICAgIHEzID0gdmFsdWVzWzRdO1xuICAgICAgICAgICAgICAgICAgICByd2hpc2tlciA9IHZhbHVlc1s1XTtcbiAgICAgICAgICAgICAgICAgICAgcm91dGxpZXIgPSB2YWx1ZXNbNl07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbHdoaXNrZXIgPSB2YWx1ZXNbMF07XG4gICAgICAgICAgICAgICAgICAgIHExID0gdmFsdWVzWzFdO1xuICAgICAgICAgICAgICAgICAgICBxMiA9IHZhbHVlc1syXTtcbiAgICAgICAgICAgICAgICAgICAgcTMgPSB2YWx1ZXNbM107XG4gICAgICAgICAgICAgICAgICAgIHJ3aGlza2VyID0gdmFsdWVzWzRdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFsdWVzLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIGEgLSBiOyB9KTtcbiAgICAgICAgICAgICAgICBxMSA9IHF1YXJ0aWxlKHZhbHVlcywgMSk7XG4gICAgICAgICAgICAgICAgcTIgPSBxdWFydGlsZSh2YWx1ZXMsIDIpO1xuICAgICAgICAgICAgICAgIHEzID0gcXVhcnRpbGUodmFsdWVzLCAzKTtcbiAgICAgICAgICAgICAgICBpcXIgPSBxMyAtIHExO1xuICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLmdldCgnc2hvd091dGxpZXJzJykpIHtcbiAgICAgICAgICAgICAgICAgICAgbHdoaXNrZXIgPSByd2hpc2tlciA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHZsZW47IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGx3aGlza2VyID09PSB1bmRlZmluZWQgJiYgdmFsdWVzW2ldID4gcTEgLSAoaXFyICogb3B0aW9ucy5nZXQoJ291dGxpZXJJUVInKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsd2hpc2tlciA9IHZhbHVlc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZXNbaV0gPCBxMyArIChpcXIgKiBvcHRpb25zLmdldCgnb3V0bGllcklRUicpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ3aGlza2VyID0gdmFsdWVzW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGxvdXRsaWVyID0gdmFsdWVzWzBdO1xuICAgICAgICAgICAgICAgICAgICByb3V0bGllciA9IHZhbHVlc1t2bGVuIC0gMV07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbHdoaXNrZXIgPSB2YWx1ZXNbMF07XG4gICAgICAgICAgICAgICAgICAgIHJ3aGlza2VyID0gdmFsdWVzW3ZsZW4gLSAxXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnF1YXJ0aWxlcyA9IFtxMSwgcTIsIHEzXTtcbiAgICAgICAgICAgIHRoaXMubHdoaXNrZXIgPSBsd2hpc2tlcjtcbiAgICAgICAgICAgIHRoaXMucndoaXNrZXIgPSByd2hpc2tlcjtcbiAgICAgICAgICAgIHRoaXMubG91dGxpZXIgPSBsb3V0bGllcjtcbiAgICAgICAgICAgIHRoaXMucm91dGxpZXIgPSByb3V0bGllcjtcblxuICAgICAgICAgICAgdW5pdFNpemUgPSBjYW52YXNXaWR0aCAvIChtYXhWYWx1ZSAtIG1pblZhbHVlICsgMSk7XG4gICAgICAgICAgICBpZiAob3B0aW9ucy5nZXQoJ3Nob3dPdXRsaWVycycpKSB7XG4gICAgICAgICAgICAgICAgY2FudmFzTGVmdCA9IE1hdGguY2VpbChvcHRpb25zLmdldCgnc3BvdFJhZGl1cycpKTtcbiAgICAgICAgICAgICAgICBjYW52YXNXaWR0aCAtPSAyICogTWF0aC5jZWlsKG9wdGlvbnMuZ2V0KCdzcG90UmFkaXVzJykpO1xuICAgICAgICAgICAgICAgIHVuaXRTaXplID0gY2FudmFzV2lkdGggLyAobWF4VmFsdWUgLSBtaW5WYWx1ZSArIDEpO1xuICAgICAgICAgICAgICAgIGlmIChsb3V0bGllciA8IGx3aGlza2VyKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldC5kcmF3Q2lyY2xlKChsb3V0bGllciAtIG1pblZhbHVlKSAqIHVuaXRTaXplICsgY2FudmFzTGVmdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbnZhc0hlaWdodCAvIDIsXG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmdldCgnc3BvdFJhZGl1cycpLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5nZXQoJ291dGxpZXJMaW5lQ29sb3InKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZ2V0KCdvdXRsaWVyRmlsbENvbG9yJykpLmFwcGVuZCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAocm91dGxpZXIgPiByd2hpc2tlcikge1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXQuZHJhd0NpcmNsZSgocm91dGxpZXIgLSBtaW5WYWx1ZSkgKiB1bml0U2l6ZSArIGNhbnZhc0xlZnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBjYW52YXNIZWlnaHQgLyAyLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5nZXQoJ3Nwb3RSYWRpdXMnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZ2V0KCdvdXRsaWVyTGluZUNvbG9yJyksXG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmdldCgnb3V0bGllckZpbGxDb2xvcicpKS5hcHBlbmQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGJveFxuICAgICAgICAgICAgdGFyZ2V0LmRyYXdSZWN0KFxuICAgICAgICAgICAgICAgIE1hdGgucm91bmQoKHExIC0gbWluVmFsdWUpICogdW5pdFNpemUgKyBjYW52YXNMZWZ0KSxcbiAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKGNhbnZhc0hlaWdodCAqIDAuMSksXG4gICAgICAgICAgICAgICAgTWF0aC5yb3VuZCgocTMgLSBxMSkgKiB1bml0U2l6ZSksXG4gICAgICAgICAgICAgICAgTWF0aC5yb3VuZChjYW52YXNIZWlnaHQgKiAwLjgpLFxuICAgICAgICAgICAgICAgIG9wdGlvbnMuZ2V0KCdib3hMaW5lQ29sb3InKSxcbiAgICAgICAgICAgICAgICBvcHRpb25zLmdldCgnYm94RmlsbENvbG9yJykpLmFwcGVuZCgpO1xuICAgICAgICAgICAgLy8gbGVmdCB3aGlza2VyXG4gICAgICAgICAgICB0YXJnZXQuZHJhd0xpbmUoXG4gICAgICAgICAgICAgICAgTWF0aC5yb3VuZCgobHdoaXNrZXIgLSBtaW5WYWx1ZSkgKiB1bml0U2l6ZSArIGNhbnZhc0xlZnQpLFxuICAgICAgICAgICAgICAgIE1hdGgucm91bmQoY2FudmFzSGVpZ2h0IC8gMiksXG4gICAgICAgICAgICAgICAgTWF0aC5yb3VuZCgocTEgLSBtaW5WYWx1ZSkgKiB1bml0U2l6ZSArIGNhbnZhc0xlZnQpLFxuICAgICAgICAgICAgICAgIE1hdGgucm91bmQoY2FudmFzSGVpZ2h0IC8gMiksXG4gICAgICAgICAgICAgICAgb3B0aW9ucy5nZXQoJ2xpbmVDb2xvcicpKS5hcHBlbmQoKTtcbiAgICAgICAgICAgIHRhcmdldC5kcmF3TGluZShcbiAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKChsd2hpc2tlciAtIG1pblZhbHVlKSAqIHVuaXRTaXplICsgY2FudmFzTGVmdCksXG4gICAgICAgICAgICAgICAgTWF0aC5yb3VuZChjYW52YXNIZWlnaHQgLyA0KSxcbiAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKChsd2hpc2tlciAtIG1pblZhbHVlKSAqIHVuaXRTaXplICsgY2FudmFzTGVmdCksXG4gICAgICAgICAgICAgICAgTWF0aC5yb3VuZChjYW52YXNIZWlnaHQgLSBjYW52YXNIZWlnaHQgLyA0KSxcbiAgICAgICAgICAgICAgICBvcHRpb25zLmdldCgnd2hpc2tlckNvbG9yJykpLmFwcGVuZCgpO1xuICAgICAgICAgICAgLy8gcmlnaHQgd2hpc2tlclxuICAgICAgICAgICAgdGFyZ2V0LmRyYXdMaW5lKE1hdGgucm91bmQoKHJ3aGlza2VyIC0gbWluVmFsdWUpICogdW5pdFNpemUgKyBjYW52YXNMZWZ0KSxcbiAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKGNhbnZhc0hlaWdodCAvIDIpLFxuICAgICAgICAgICAgICAgIE1hdGgucm91bmQoKHEzIC0gbWluVmFsdWUpICogdW5pdFNpemUgKyBjYW52YXNMZWZ0KSxcbiAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKGNhbnZhc0hlaWdodCAvIDIpLFxuICAgICAgICAgICAgICAgIG9wdGlvbnMuZ2V0KCdsaW5lQ29sb3InKSkuYXBwZW5kKCk7XG4gICAgICAgICAgICB0YXJnZXQuZHJhd0xpbmUoXG4gICAgICAgICAgICAgICAgTWF0aC5yb3VuZCgocndoaXNrZXIgLSBtaW5WYWx1ZSkgKiB1bml0U2l6ZSArIGNhbnZhc0xlZnQpLFxuICAgICAgICAgICAgICAgIE1hdGgucm91bmQoY2FudmFzSGVpZ2h0IC8gNCksXG4gICAgICAgICAgICAgICAgTWF0aC5yb3VuZCgocndoaXNrZXIgLSBtaW5WYWx1ZSkgKiB1bml0U2l6ZSArIGNhbnZhc0xlZnQpLFxuICAgICAgICAgICAgICAgIE1hdGgucm91bmQoY2FudmFzSGVpZ2h0IC0gY2FudmFzSGVpZ2h0IC8gNCksXG4gICAgICAgICAgICAgICAgb3B0aW9ucy5nZXQoJ3doaXNrZXJDb2xvcicpKS5hcHBlbmQoKTtcbiAgICAgICAgICAgIC8vIG1lZGlhbiBsaW5lXG4gICAgICAgICAgICB0YXJnZXQuZHJhd0xpbmUoXG4gICAgICAgICAgICAgICAgTWF0aC5yb3VuZCgocTIgLSBtaW5WYWx1ZSkgKiB1bml0U2l6ZSArIGNhbnZhc0xlZnQpLFxuICAgICAgICAgICAgICAgIE1hdGgucm91bmQoY2FudmFzSGVpZ2h0ICogMC4xKSxcbiAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKChxMiAtIG1pblZhbHVlKSAqIHVuaXRTaXplICsgY2FudmFzTGVmdCksXG4gICAgICAgICAgICAgICAgTWF0aC5yb3VuZChjYW52YXNIZWlnaHQgKiAwLjkpLFxuICAgICAgICAgICAgICAgIG9wdGlvbnMuZ2V0KCdtZWRpYW5Db2xvcicpKS5hcHBlbmQoKTtcbiAgICAgICAgICAgIGlmIChvcHRpb25zLmdldCgndGFyZ2V0JykpIHtcbiAgICAgICAgICAgICAgICBzaXplID0gTWF0aC5jZWlsKG9wdGlvbnMuZ2V0KCdzcG90UmFkaXVzJykpO1xuICAgICAgICAgICAgICAgIHRhcmdldC5kcmF3TGluZShcbiAgICAgICAgICAgICAgICAgICAgTWF0aC5yb3VuZCgob3B0aW9ucy5nZXQoJ3RhcmdldCcpIC0gbWluVmFsdWUpICogdW5pdFNpemUgKyBjYW52YXNMZWZ0KSxcbiAgICAgICAgICAgICAgICAgICAgTWF0aC5yb3VuZCgoY2FudmFzSGVpZ2h0IC8gMikgLSBzaXplKSxcbiAgICAgICAgICAgICAgICAgICAgTWF0aC5yb3VuZCgob3B0aW9ucy5nZXQoJ3RhcmdldCcpIC0gbWluVmFsdWUpICogdW5pdFNpemUgKyBjYW52YXNMZWZ0KSxcbiAgICAgICAgICAgICAgICAgICAgTWF0aC5yb3VuZCgoY2FudmFzSGVpZ2h0IC8gMikgKyBzaXplKSxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5nZXQoJ3RhcmdldENvbG9yJykpLmFwcGVuZCgpO1xuICAgICAgICAgICAgICAgIHRhcmdldC5kcmF3TGluZShcbiAgICAgICAgICAgICAgICAgICAgTWF0aC5yb3VuZCgob3B0aW9ucy5nZXQoJ3RhcmdldCcpIC0gbWluVmFsdWUpICogdW5pdFNpemUgKyBjYW52YXNMZWZ0IC0gc2l6ZSksXG4gICAgICAgICAgICAgICAgICAgIE1hdGgucm91bmQoY2FudmFzSGVpZ2h0IC8gMiksXG4gICAgICAgICAgICAgICAgICAgIE1hdGgucm91bmQoKG9wdGlvbnMuZ2V0KCd0YXJnZXQnKSAtIG1pblZhbHVlKSAqIHVuaXRTaXplICsgY2FudmFzTGVmdCArIHNpemUpLFxuICAgICAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKGNhbnZhc0hlaWdodCAvIDIpLFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmdldCgndGFyZ2V0Q29sb3InKSkuYXBwZW5kKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0YXJnZXQucmVuZGVyKCk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFNldHVwIGEgdmVyeSBzaW1wbGUgXCJ2aXJ0dWFsIGNhbnZhc1wiIHRvIG1ha2UgZHJhd2luZyB0aGUgZmV3IHNoYXBlcyB3ZSBuZWVkIGVhc2llclxuICAgIC8vIFRoaXMgaXMgYWNjZXNzaWJsZSBhcyAkKGZvbykuc2ltcGxlZHJhdygpXG5cbiAgICBWU2hhcGUgPSBjcmVhdGVDbGFzcyh7XG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uICh0YXJnZXQsIGlkLCB0eXBlLCBhcmdzKSB7XG4gICAgICAgICAgICB0aGlzLnRhcmdldCA9IHRhcmdldDtcbiAgICAgICAgICAgIHRoaXMuaWQgPSBpZDtcbiAgICAgICAgICAgIHRoaXMudHlwZSA9IHR5cGU7XG4gICAgICAgICAgICB0aGlzLmFyZ3MgPSBhcmdzO1xuICAgICAgICB9LFxuICAgICAgICBhcHBlbmQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0LmFwcGVuZFNoYXBlKHRoaXMpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIFZDYW52YXNfYmFzZSA9IGNyZWF0ZUNsYXNzKHtcbiAgICAgICAgX3B4cmVnZXg6IC8oXFxkKykocHgpP1xccyokL2ksXG5cbiAgICAgICAgaW5pdDogZnVuY3Rpb24gKHdpZHRoLCBoZWlnaHQsIHRhcmdldCkge1xuICAgICAgICAgICAgaWYgKCF3aWR0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMud2lkdGggPSB3aWR0aDtcbiAgICAgICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xuICAgICAgICAgICAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7XG4gICAgICAgICAgICB0aGlzLmxhc3RTaGFwZUlkID0gbnVsbDtcbiAgICAgICAgICAgIGlmICh0YXJnZXRbMF0pIHtcbiAgICAgICAgICAgICAgICB0YXJnZXQgPSB0YXJnZXRbMF07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkLmRhdGEodGFyZ2V0LCAnX2pxc192Y2FudmFzJywgdGhpcyk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZHJhd0xpbmU6IGZ1bmN0aW9uICh4MSwgeTEsIHgyLCB5MiwgbGluZUNvbG9yLCBsaW5lV2lkdGgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmRyYXdTaGFwZShbW3gxLCB5MV0sIFt4MiwgeTJdXSwgbGluZUNvbG9yLCBsaW5lV2lkdGgpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGRyYXdTaGFwZTogZnVuY3Rpb24gKHBhdGgsIGxpbmVDb2xvciwgZmlsbENvbG9yLCBsaW5lV2lkdGgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9nZW5TaGFwZSgnU2hhcGUnLCBbcGF0aCwgbGluZUNvbG9yLCBmaWxsQ29sb3IsIGxpbmVXaWR0aF0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIGRyYXdDaXJjbGU6IGZ1bmN0aW9uICh4LCB5LCByYWRpdXMsIGxpbmVDb2xvciwgZmlsbENvbG9yLCBsaW5lV2lkdGgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9nZW5TaGFwZSgnQ2lyY2xlJywgW3gsIHksIHJhZGl1cywgbGluZUNvbG9yLCBmaWxsQ29sb3IsIGxpbmVXaWR0aF0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIGRyYXdQaWVTbGljZTogZnVuY3Rpb24gKHgsIHksIHJhZGl1cywgc3RhcnRBbmdsZSwgZW5kQW5nbGUsIGxpbmVDb2xvciwgZmlsbENvbG9yKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZ2VuU2hhcGUoJ1BpZVNsaWNlJywgW3gsIHksIHJhZGl1cywgc3RhcnRBbmdsZSwgZW5kQW5nbGUsIGxpbmVDb2xvciwgZmlsbENvbG9yXSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZHJhd1JlY3Q6IGZ1bmN0aW9uICh4LCB5LCB3aWR0aCwgaGVpZ2h0LCBsaW5lQ29sb3IsIGZpbGxDb2xvcikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dlblNoYXBlKCdSZWN0JywgW3gsIHksIHdpZHRoLCBoZWlnaHQsIGxpbmVDb2xvciwgZmlsbENvbG9yXSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2V0RWxlbWVudDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2FudmFzO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSZXR1cm4gdGhlIG1vc3QgcmVjZW50bHkgaW5zZXJ0ZWQgc2hhcGUgaWRcbiAgICAgICAgICovXG4gICAgICAgIGdldExhc3RTaGFwZUlkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5sYXN0U2hhcGVJZDtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogQ2xlYXIgYW5kIHJlc2V0IHRoZSBjYW52YXNcbiAgICAgICAgICovXG4gICAgICAgIHJlc2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBhbGVydCgncmVzZXQgbm90IGltcGxlbWVudGVkJyk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgX2luc2VydDogZnVuY3Rpb24gKGVsLCB0YXJnZXQpIHtcbiAgICAgICAgICAgICQodGFyZ2V0KS5odG1sKGVsKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogQ2FsY3VsYXRlIHRoZSBwaXhlbCBkaW1lbnNpb25zIG9mIHRoZSBjYW52YXNcbiAgICAgICAgICovXG4gICAgICAgIF9jYWxjdWxhdGVQaXhlbERpbXM6IGZ1bmN0aW9uICh3aWR0aCwgaGVpZ2h0LCBjYW52YXMpIHtcbiAgICAgICAgICAgIC8vIFhYWCBUaGlzIHNob3VsZCBwcm9iYWJseSBiZSBhIGNvbmZpZ3VyYWJsZSBvcHRpb25cbiAgICAgICAgICAgIHZhciBtYXRjaDtcbiAgICAgICAgICAgIG1hdGNoID0gdGhpcy5fcHhyZWdleC5leGVjKGhlaWdodCk7XG4gICAgICAgICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBpeGVsSGVpZ2h0ID0gbWF0Y2hbMV07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMucGl4ZWxIZWlnaHQgPSAkKGNhbnZhcykuaGVpZ2h0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBtYXRjaCA9IHRoaXMuX3B4cmVnZXguZXhlYyh3aWR0aCk7XG4gICAgICAgICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBpeGVsV2lkdGggPSBtYXRjaFsxXTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5waXhlbFdpZHRoID0gJChjYW52YXMpLndpZHRoKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEdlbmVyYXRlIGEgc2hhcGUgb2JqZWN0IGFuZCBpZCBmb3IgbGF0ZXIgcmVuZGVyaW5nXG4gICAgICAgICAqL1xuICAgICAgICBfZ2VuU2hhcGU6IGZ1bmN0aW9uIChzaGFwZXR5cGUsIHNoYXBlYXJncykge1xuICAgICAgICAgICAgdmFyIGlkID0gc2hhcGVDb3VudCsrO1xuICAgICAgICAgICAgc2hhcGVhcmdzLnVuc2hpZnQoaWQpO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBWU2hhcGUodGhpcywgaWQsIHNoYXBldHlwZSwgc2hhcGVhcmdzKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogQWRkIGEgc2hhcGUgdG8gdGhlIGVuZCBvZiB0aGUgcmVuZGVyIHF1ZXVlXG4gICAgICAgICAqL1xuICAgICAgICBhcHBlbmRTaGFwZTogZnVuY3Rpb24gKHNoYXBlKSB7XG4gICAgICAgICAgICBhbGVydCgnYXBwZW5kU2hhcGUgbm90IGltcGxlbWVudGVkJyk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJlcGxhY2Ugb25lIHNoYXBlIHdpdGggYW5vdGhlclxuICAgICAgICAgKi9cbiAgICAgICAgcmVwbGFjZVdpdGhTaGFwZTogZnVuY3Rpb24gKHNoYXBlaWQsIHNoYXBlKSB7XG4gICAgICAgICAgICBhbGVydCgncmVwbGFjZVdpdGhTaGFwZSBub3QgaW1wbGVtZW50ZWQnKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogSW5zZXJ0IG9uZSBzaGFwZSBhZnRlciBhbm90aGVyIGluIHRoZSByZW5kZXIgcXVldWVcbiAgICAgICAgICovXG4gICAgICAgIGluc2VydEFmdGVyU2hhcGU6IGZ1bmN0aW9uIChzaGFwZWlkLCBzaGFwZSkge1xuICAgICAgICAgICAgYWxlcnQoJ2luc2VydEFmdGVyU2hhcGUgbm90IGltcGxlbWVudGVkJyk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJlbW92ZSBhIHNoYXBlIGZyb20gdGhlIHF1ZXVlXG4gICAgICAgICAqL1xuICAgICAgICByZW1vdmVTaGFwZUlkOiBmdW5jdGlvbiAoc2hhcGVpZCkge1xuICAgICAgICAgICAgYWxlcnQoJ3JlbW92ZVNoYXBlSWQgbm90IGltcGxlbWVudGVkJyk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpbmQgYSBzaGFwZSBhdCB0aGUgc3BlY2lmaWVkIHgveSBjby1vcmRpbmF0ZXNcbiAgICAgICAgICovXG4gICAgICAgIGdldFNoYXBlQXQ6IGZ1bmN0aW9uIChlbCwgeCwgeSkge1xuICAgICAgICAgICAgYWxlcnQoJ2dldFNoYXBlQXQgbm90IGltcGxlbWVudGVkJyk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJlbmRlciBhbGwgcXVldWVkIHNoYXBlcyBvbnRvIHRoZSBjYW52YXNcbiAgICAgICAgICovXG4gICAgICAgIHJlbmRlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgYWxlcnQoJ3JlbmRlciBub3QgaW1wbGVtZW50ZWQnKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgVkNhbnZhc19jYW52YXMgPSBjcmVhdGVDbGFzcyhWQ2FudmFzX2Jhc2UsIHtcbiAgICAgICAgaW5pdDogZnVuY3Rpb24gKHdpZHRoLCBoZWlnaHQsIHRhcmdldCwgaW50ZXJhY3QpIHtcbiAgICAgICAgICAgIFZDYW52YXNfY2FudmFzLl9zdXBlci5pbml0LmNhbGwodGhpcywgd2lkdGgsIGhlaWdodCwgdGFyZ2V0KTtcbiAgICAgICAgICAgIHRoaXMuY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG4gICAgICAgICAgICBpZiAodGFyZ2V0WzBdKSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0gdGFyZ2V0WzBdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJC5kYXRhKHRhcmdldCwgJ19qcXNfdmNhbnZhcycsIHRoaXMpO1xuICAgICAgICAgICAgJCh0aGlzLmNhbnZhcykuY3NzKHsgZGlzcGxheTogJ2lubGluZS1ibG9jaycsIHdpZHRoOiB3aWR0aCwgaGVpZ2h0OiBoZWlnaHQsIHZlcnRpY2FsQWxpZ246ICd0b3AnIH0pO1xuICAgICAgICAgICAgdGhpcy5faW5zZXJ0KHRoaXMuY2FudmFzLCB0YXJnZXQpO1xuICAgICAgICAgICAgdGhpcy5fY2FsY3VsYXRlUGl4ZWxEaW1zKHdpZHRoLCBoZWlnaHQsIHRoaXMuY2FudmFzKTtcbiAgICAgICAgICAgIHRoaXMuY2FudmFzLndpZHRoID0gdGhpcy5waXhlbFdpZHRoO1xuICAgICAgICAgICAgdGhpcy5jYW52YXMuaGVpZ2h0ID0gdGhpcy5waXhlbEhlaWdodDtcbiAgICAgICAgICAgIHRoaXMuaW50ZXJhY3QgPSBpbnRlcmFjdDtcbiAgICAgICAgICAgIHRoaXMuc2hhcGVzID0ge307XG4gICAgICAgICAgICB0aGlzLnNoYXBlc2VxID0gW107XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRUYXJnZXRTaGFwZUlkID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgJCh0aGlzLmNhbnZhcykuY3NzKHt3aWR0aDogdGhpcy5waXhlbFdpZHRoLCBoZWlnaHQ6IHRoaXMucGl4ZWxIZWlnaHR9KTtcbiAgICAgICAgfSxcblxuICAgICAgICBfZ2V0Q29udGV4dDogZnVuY3Rpb24gKGxpbmVDb2xvciwgZmlsbENvbG9yLCBsaW5lV2lkdGgpIHtcbiAgICAgICAgICAgIHZhciBjb250ZXh0ID0gdGhpcy5jYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcbiAgICAgICAgICAgIGlmIChsaW5lQ29sb3IgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGNvbnRleHQuc3Ryb2tlU3R5bGUgPSBsaW5lQ29sb3I7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb250ZXh0LmxpbmVXaWR0aCA9IGxpbmVXaWR0aCA9PT0gdW5kZWZpbmVkID8gMSA6IGxpbmVXaWR0aDtcbiAgICAgICAgICAgIGlmIChmaWxsQ29sb3IgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGNvbnRleHQuZmlsbFN0eWxlID0gZmlsbENvbG9yO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQ7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVzZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBjb250ZXh0ID0gdGhpcy5fZ2V0Q29udGV4dCgpO1xuICAgICAgICAgICAgY29udGV4dC5jbGVhclJlY3QoMCwgMCwgdGhpcy5waXhlbFdpZHRoLCB0aGlzLnBpeGVsSGVpZ2h0KTtcbiAgICAgICAgICAgIHRoaXMuc2hhcGVzID0ge307XG4gICAgICAgICAgICB0aGlzLnNoYXBlc2VxID0gW107XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRUYXJnZXRTaGFwZUlkID0gdW5kZWZpbmVkO1xuICAgICAgICB9LFxuXG4gICAgICAgIF9kcmF3U2hhcGU6IGZ1bmN0aW9uIChzaGFwZWlkLCBwYXRoLCBsaW5lQ29sb3IsIGZpbGxDb2xvciwgbGluZVdpZHRoKSB7XG4gICAgICAgICAgICB2YXIgY29udGV4dCA9IHRoaXMuX2dldENvbnRleHQobGluZUNvbG9yLCBmaWxsQ29sb3IsIGxpbmVXaWR0aCksXG4gICAgICAgICAgICAgICAgaSwgcGxlbjtcbiAgICAgICAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICBjb250ZXh0Lm1vdmVUbyhwYXRoWzBdWzBdICsgMC41LCBwYXRoWzBdWzFdICsgMC41KTtcbiAgICAgICAgICAgIGZvciAoaSA9IDEsIHBsZW4gPSBwYXRoLmxlbmd0aDsgaSA8IHBsZW47IGkrKykge1xuICAgICAgICAgICAgICAgIGNvbnRleHQubGluZVRvKHBhdGhbaV1bMF0gKyAwLjUsIHBhdGhbaV1bMV0gKyAwLjUpOyAvLyB0aGUgMC41IG9mZnNldCBnaXZlcyB1cyBjcmlzcCBwaXhlbC13aWR0aCBsaW5lc1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGxpbmVDb2xvciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgY29udGV4dC5zdHJva2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChmaWxsQ29sb3IgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGNvbnRleHQuZmlsbCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMudGFyZ2V0WCAhPT0gdW5kZWZpbmVkICYmIHRoaXMudGFyZ2V0WSAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICAgICAgY29udGV4dC5pc1BvaW50SW5QYXRoKHRoaXMudGFyZ2V0WCwgdGhpcy50YXJnZXRZKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFRhcmdldFNoYXBlSWQgPSBzaGFwZWlkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIF9kcmF3Q2lyY2xlOiBmdW5jdGlvbiAoc2hhcGVpZCwgeCwgeSwgcmFkaXVzLCBsaW5lQ29sb3IsIGZpbGxDb2xvciwgbGluZVdpZHRoKSB7XG4gICAgICAgICAgICB2YXIgY29udGV4dCA9IHRoaXMuX2dldENvbnRleHQobGluZUNvbG9yLCBmaWxsQ29sb3IsIGxpbmVXaWR0aCk7XG4gICAgICAgICAgICBjb250ZXh0LmJlZ2luUGF0aCgpO1xuICAgICAgICAgICAgY29udGV4dC5hcmMoeCwgeSwgcmFkaXVzLCAwLCAyICogTWF0aC5QSSwgZmFsc2UpO1xuICAgICAgICAgICAgaWYgKHRoaXMudGFyZ2V0WCAhPT0gdW5kZWZpbmVkICYmIHRoaXMudGFyZ2V0WSAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICAgICAgY29udGV4dC5pc1BvaW50SW5QYXRoKHRoaXMudGFyZ2V0WCwgdGhpcy50YXJnZXRZKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFRhcmdldFNoYXBlSWQgPSBzaGFwZWlkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGxpbmVDb2xvciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgY29udGV4dC5zdHJva2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChmaWxsQ29sb3IgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGNvbnRleHQuZmlsbCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIF9kcmF3UGllU2xpY2U6IGZ1bmN0aW9uIChzaGFwZWlkLCB4LCB5LCByYWRpdXMsIHN0YXJ0QW5nbGUsIGVuZEFuZ2xlLCBsaW5lQ29sb3IsIGZpbGxDb2xvcikge1xuICAgICAgICAgICAgdmFyIGNvbnRleHQgPSB0aGlzLl9nZXRDb250ZXh0KGxpbmVDb2xvciwgZmlsbENvbG9yKTtcbiAgICAgICAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICBjb250ZXh0Lm1vdmVUbyh4LCB5KTtcbiAgICAgICAgICAgIGNvbnRleHQuYXJjKHgsIHksIHJhZGl1cywgc3RhcnRBbmdsZSwgZW5kQW5nbGUsIGZhbHNlKTtcbiAgICAgICAgICAgIGNvbnRleHQubGluZVRvKHgsIHkpO1xuICAgICAgICAgICAgY29udGV4dC5jbG9zZVBhdGgoKTtcbiAgICAgICAgICAgIGlmIChsaW5lQ29sb3IgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGNvbnRleHQuc3Ryb2tlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZmlsbENvbG9yKSB7XG4gICAgICAgICAgICAgICAgY29udGV4dC5maWxsKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy50YXJnZXRYICE9PSB1bmRlZmluZWQgJiYgdGhpcy50YXJnZXRZICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgICAgICBjb250ZXh0LmlzUG9pbnRJblBhdGgodGhpcy50YXJnZXRYLCB0aGlzLnRhcmdldFkpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50VGFyZ2V0U2hhcGVJZCA9IHNoYXBlaWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgX2RyYXdSZWN0OiBmdW5jdGlvbiAoc2hhcGVpZCwgeCwgeSwgd2lkdGgsIGhlaWdodCwgbGluZUNvbG9yLCBmaWxsQ29sb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9kcmF3U2hhcGUoc2hhcGVpZCwgW1t4LCB5XSwgW3ggKyB3aWR0aCwgeV0sIFt4ICsgd2lkdGgsIHkgKyBoZWlnaHRdLCBbeCwgeSArIGhlaWdodF0sIFt4LCB5XV0sIGxpbmVDb2xvciwgZmlsbENvbG9yKTtcbiAgICAgICAgfSxcblxuICAgICAgICBhcHBlbmRTaGFwZTogZnVuY3Rpb24gKHNoYXBlKSB7XG4gICAgICAgICAgICB0aGlzLnNoYXBlc1tzaGFwZS5pZF0gPSBzaGFwZTtcbiAgICAgICAgICAgIHRoaXMuc2hhcGVzZXEucHVzaChzaGFwZS5pZCk7XG4gICAgICAgICAgICB0aGlzLmxhc3RTaGFwZUlkID0gc2hhcGUuaWQ7XG4gICAgICAgICAgICByZXR1cm4gc2hhcGUuaWQ7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVwbGFjZVdpdGhTaGFwZTogZnVuY3Rpb24gKHNoYXBlaWQsIHNoYXBlKSB7XG4gICAgICAgICAgICB2YXIgc2hhcGVzZXEgPSB0aGlzLnNoYXBlc2VxLFxuICAgICAgICAgICAgICAgIGk7XG4gICAgICAgICAgICB0aGlzLnNoYXBlc1tzaGFwZS5pZF0gPSBzaGFwZTtcbiAgICAgICAgICAgIGZvciAoaSA9IHNoYXBlc2VxLmxlbmd0aDsgaS0tOykge1xuICAgICAgICAgICAgICAgIGlmIChzaGFwZXNlcVtpXSA9PSBzaGFwZWlkKSB7XG4gICAgICAgICAgICAgICAgICAgIHNoYXBlc2VxW2ldID0gc2hhcGUuaWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVsZXRlIHRoaXMuc2hhcGVzW3NoYXBlaWRdO1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlcGxhY2VXaXRoU2hhcGVzOiBmdW5jdGlvbiAoc2hhcGVpZHMsIHNoYXBlcykge1xuICAgICAgICAgICAgdmFyIHNoYXBlc2VxID0gdGhpcy5zaGFwZXNlcSxcbiAgICAgICAgICAgICAgICBzaGFwZW1hcCA9IHt9LFxuICAgICAgICAgICAgICAgIHNpZCwgaSwgZmlyc3Q7XG5cbiAgICAgICAgICAgIGZvciAoaSA9IHNoYXBlaWRzLmxlbmd0aDsgaS0tOykge1xuICAgICAgICAgICAgICAgIHNoYXBlbWFwW3NoYXBlaWRzW2ldXSA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGkgPSBzaGFwZXNlcS5sZW5ndGg7IGktLTspIHtcbiAgICAgICAgICAgICAgICBzaWQgPSBzaGFwZXNlcVtpXTtcbiAgICAgICAgICAgICAgICBpZiAoc2hhcGVtYXBbc2lkXSkge1xuICAgICAgICAgICAgICAgICAgICBzaGFwZXNlcS5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLnNoYXBlc1tzaWRdO1xuICAgICAgICAgICAgICAgICAgICBmaXJzdCA9IGk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChpID0gc2hhcGVzLmxlbmd0aDsgaS0tOykge1xuICAgICAgICAgICAgICAgIHNoYXBlc2VxLnNwbGljZShmaXJzdCwgMCwgc2hhcGVzW2ldLmlkKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNoYXBlc1tzaGFwZXNbaV0uaWRdID0gc2hhcGVzW2ldO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0sXG5cbiAgICAgICAgaW5zZXJ0QWZ0ZXJTaGFwZTogZnVuY3Rpb24gKHNoYXBlaWQsIHNoYXBlKSB7XG4gICAgICAgICAgICB2YXIgc2hhcGVzZXEgPSB0aGlzLnNoYXBlc2VxLFxuICAgICAgICAgICAgICAgIGk7XG4gICAgICAgICAgICBmb3IgKGkgPSBzaGFwZXNlcS5sZW5ndGg7IGktLTspIHtcbiAgICAgICAgICAgICAgICBpZiAoc2hhcGVzZXFbaV0gPT09IHNoYXBlaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc2hhcGVzZXEuc3BsaWNlKGkgKyAxLCAwLCBzaGFwZS5pZCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2hhcGVzW3NoYXBlLmlkXSA9IHNoYXBlO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIHJlbW92ZVNoYXBlSWQ6IGZ1bmN0aW9uIChzaGFwZWlkKSB7XG4gICAgICAgICAgICB2YXIgc2hhcGVzZXEgPSB0aGlzLnNoYXBlc2VxLFxuICAgICAgICAgICAgICAgIGk7XG4gICAgICAgICAgICBmb3IgKGkgPSBzaGFwZXNlcS5sZW5ndGg7IGktLTspIHtcbiAgICAgICAgICAgICAgICBpZiAoc2hhcGVzZXFbaV0gPT09IHNoYXBlaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc2hhcGVzZXEuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkZWxldGUgdGhpcy5zaGFwZXNbc2hhcGVpZF07XG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2V0U2hhcGVBdDogZnVuY3Rpb24gKGVsLCB4LCB5KSB7XG4gICAgICAgICAgICB0aGlzLnRhcmdldFggPSB4O1xuICAgICAgICAgICAgdGhpcy50YXJnZXRZID0geTtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jdXJyZW50VGFyZ2V0U2hhcGVJZDtcbiAgICAgICAgfSxcblxuICAgICAgICByZW5kZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBzaGFwZXNlcSA9IHRoaXMuc2hhcGVzZXEsXG4gICAgICAgICAgICAgICAgc2hhcGVzID0gdGhpcy5zaGFwZXMsXG4gICAgICAgICAgICAgICAgc2hhcGVDb3VudCA9IHNoYXBlc2VxLmxlbmd0aCxcbiAgICAgICAgICAgICAgICBjb250ZXh0ID0gdGhpcy5fZ2V0Q29udGV4dCgpLFxuICAgICAgICAgICAgICAgIHNoYXBlaWQsIHNoYXBlLCBpO1xuICAgICAgICAgICAgY29udGV4dC5jbGVhclJlY3QoMCwgMCwgdGhpcy5waXhlbFdpZHRoLCB0aGlzLnBpeGVsSGVpZ2h0KTtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBzaGFwZUNvdW50OyBpKyspIHtcbiAgICAgICAgICAgICAgICBzaGFwZWlkID0gc2hhcGVzZXFbaV07XG4gICAgICAgICAgICAgICAgc2hhcGUgPSBzaGFwZXNbc2hhcGVpZF07XG4gICAgICAgICAgICAgICAgdGhpc1snX2RyYXcnICsgc2hhcGUudHlwZV0uYXBwbHkodGhpcywgc2hhcGUuYXJncyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIXRoaXMuaW50ZXJhY3QpIHtcbiAgICAgICAgICAgICAgICAvLyBub3QgaW50ZXJhY3RpdmUgc28gbm8gbmVlZCB0byBrZWVwIHRoZSBzaGFwZXMgYXJyYXlcbiAgICAgICAgICAgICAgICB0aGlzLnNoYXBlcyA9IHt9O1xuICAgICAgICAgICAgICAgIHRoaXMuc2hhcGVzZXEgPSBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgfSk7XG5cbiAgICBWQ2FudmFzX3ZtbCA9IGNyZWF0ZUNsYXNzKFZDYW52YXNfYmFzZSwge1xuICAgICAgICBpbml0OiBmdW5jdGlvbiAod2lkdGgsIGhlaWdodCwgdGFyZ2V0KSB7XG4gICAgICAgICAgICB2YXIgZ3JvdXBlbDtcbiAgICAgICAgICAgIFZDYW52YXNfdm1sLl9zdXBlci5pbml0LmNhbGwodGhpcywgd2lkdGgsIGhlaWdodCwgdGFyZ2V0KTtcbiAgICAgICAgICAgIGlmICh0YXJnZXRbMF0pIHtcbiAgICAgICAgICAgICAgICB0YXJnZXQgPSB0YXJnZXRbMF07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkLmRhdGEodGFyZ2V0LCAnX2pxc192Y2FudmFzJywgdGhpcyk7XG4gICAgICAgICAgICB0aGlzLmNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgICAgICAgICQodGhpcy5jYW52YXMpLmNzcyh7IGRpc3BsYXk6ICdpbmxpbmUtYmxvY2snLCBwb3NpdGlvbjogJ3JlbGF0aXZlJywgb3ZlcmZsb3c6ICdoaWRkZW4nLCB3aWR0aDogd2lkdGgsIGhlaWdodDogaGVpZ2h0LCBtYXJnaW46ICcwcHgnLCBwYWRkaW5nOiAnMHB4JywgdmVydGljYWxBbGlnbjogJ3RvcCd9KTtcbiAgICAgICAgICAgIHRoaXMuX2luc2VydCh0aGlzLmNhbnZhcywgdGFyZ2V0KTtcbiAgICAgICAgICAgIHRoaXMuX2NhbGN1bGF0ZVBpeGVsRGltcyh3aWR0aCwgaGVpZ2h0LCB0aGlzLmNhbnZhcyk7XG4gICAgICAgICAgICB0aGlzLmNhbnZhcy53aWR0aCA9IHRoaXMucGl4ZWxXaWR0aDtcbiAgICAgICAgICAgIHRoaXMuY2FudmFzLmhlaWdodCA9IHRoaXMucGl4ZWxIZWlnaHQ7XG4gICAgICAgICAgICBncm91cGVsID0gJzx2Omdyb3VwIGNvb3Jkb3JpZ2luPVwiMCAwXCIgY29vcmRzaXplPVwiJyArIHRoaXMucGl4ZWxXaWR0aCArICcgJyArIHRoaXMucGl4ZWxIZWlnaHQgKyAnXCInICtcbiAgICAgICAgICAgICAgICAgICAgJyBzdHlsZT1cInBvc2l0aW9uOmFic29sdXRlO3RvcDowO2xlZnQ6MDt3aWR0aDonICsgdGhpcy5waXhlbFdpZHRoICsgJ3B4O2hlaWdodD0nICsgdGhpcy5waXhlbEhlaWdodCArICdweDtcIj48L3Y6Z3JvdXA+JztcbiAgICAgICAgICAgIHRoaXMuY2FudmFzLmluc2VydEFkamFjZW50SFRNTCgnYmVmb3JlRW5kJywgZ3JvdXBlbCk7XG4gICAgICAgICAgICB0aGlzLmdyb3VwID0gJCh0aGlzLmNhbnZhcykuY2hpbGRyZW4oKVswXTtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMucHJlcmVuZGVyID0gJyc7XG4gICAgICAgIH0sXG5cbiAgICAgICAgX2RyYXdTaGFwZTogZnVuY3Rpb24gKHNoYXBlaWQsIHBhdGgsIGxpbmVDb2xvciwgZmlsbENvbG9yLCBsaW5lV2lkdGgpIHtcbiAgICAgICAgICAgIHZhciB2cGF0aCA9IFtdLFxuICAgICAgICAgICAgICAgIGluaXRpYWwsIHN0cm9rZSwgZmlsbCwgY2xvc2VkLCB2ZWwsIHBsZW4sIGk7XG4gICAgICAgICAgICBmb3IgKGkgPSAwLCBwbGVuID0gcGF0aC5sZW5ndGg7IGkgPCBwbGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2cGF0aFtpXSA9ICcnICsgKHBhdGhbaV1bMF0pICsgJywnICsgKHBhdGhbaV1bMV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaW5pdGlhbCA9IHZwYXRoLnNwbGljZSgwLCAxKTtcbiAgICAgICAgICAgIGxpbmVXaWR0aCA9IGxpbmVXaWR0aCA9PT0gdW5kZWZpbmVkID8gMSA6IGxpbmVXaWR0aDtcbiAgICAgICAgICAgIHN0cm9rZSA9IGxpbmVDb2xvciA9PT0gdW5kZWZpbmVkID8gJyBzdHJva2VkPVwiZmFsc2VcIiAnIDogJyBzdHJva2VXZWlnaHQ9XCInICsgbGluZVdpZHRoICsgJ3B4XCIgc3Ryb2tlQ29sb3I9XCInICsgbGluZUNvbG9yICsgJ1wiICc7XG4gICAgICAgICAgICBmaWxsID0gZmlsbENvbG9yID09PSB1bmRlZmluZWQgPyAnIGZpbGxlZD1cImZhbHNlXCInIDogJyBmaWxsQ29sb3I9XCInICsgZmlsbENvbG9yICsgJ1wiIGZpbGxlZD1cInRydWVcIiAnO1xuICAgICAgICAgICAgY2xvc2VkID0gdnBhdGhbMF0gPT09IHZwYXRoW3ZwYXRoLmxlbmd0aCAtIDFdID8gJ3ggJyA6ICcnO1xuICAgICAgICAgICAgdmVsID0gJzx2OnNoYXBlIGNvb3Jkb3JpZ2luPVwiMCAwXCIgY29vcmRzaXplPVwiJyArIHRoaXMucGl4ZWxXaWR0aCArICcgJyArIHRoaXMucGl4ZWxIZWlnaHQgKyAnXCIgJyArXG4gICAgICAgICAgICAgICAgICcgaWQ9XCJqcXNzaGFwZScgKyBzaGFwZWlkICsgJ1wiICcgK1xuICAgICAgICAgICAgICAgICBzdHJva2UgK1xuICAgICAgICAgICAgICAgICBmaWxsICtcbiAgICAgICAgICAgICAgICAnIHN0eWxlPVwicG9zaXRpb246YWJzb2x1dGU7bGVmdDowcHg7dG9wOjBweDtoZWlnaHQ6JyArIHRoaXMucGl4ZWxIZWlnaHQgKyAncHg7d2lkdGg6JyArIHRoaXMucGl4ZWxXaWR0aCArICdweDtwYWRkaW5nOjBweDttYXJnaW46MHB4O1wiICcgK1xuICAgICAgICAgICAgICAgICcgcGF0aD1cIm0gJyArIGluaXRpYWwgKyAnIGwgJyArIHZwYXRoLmpvaW4oJywgJykgKyAnICcgKyBjbG9zZWQgKyAnZVwiPicgK1xuICAgICAgICAgICAgICAgICcgPC92OnNoYXBlPic7XG4gICAgICAgICAgICByZXR1cm4gdmVsO1xuICAgICAgICB9LFxuXG4gICAgICAgIF9kcmF3Q2lyY2xlOiBmdW5jdGlvbiAoc2hhcGVpZCwgeCwgeSwgcmFkaXVzLCBsaW5lQ29sb3IsIGZpbGxDb2xvciwgbGluZVdpZHRoKSB7XG4gICAgICAgICAgICB2YXIgc3Ryb2tlLCBmaWxsLCB2ZWw7XG4gICAgICAgICAgICB4IC09IHJhZGl1cztcbiAgICAgICAgICAgIHkgLT0gcmFkaXVzO1xuICAgICAgICAgICAgc3Ryb2tlID0gbGluZUNvbG9yID09PSB1bmRlZmluZWQgPyAnIHN0cm9rZWQ9XCJmYWxzZVwiICcgOiAnIHN0cm9rZVdlaWdodD1cIicgKyBsaW5lV2lkdGggKyAncHhcIiBzdHJva2VDb2xvcj1cIicgKyBsaW5lQ29sb3IgKyAnXCIgJztcbiAgICAgICAgICAgIGZpbGwgPSBmaWxsQ29sb3IgPT09IHVuZGVmaW5lZCA/ICcgZmlsbGVkPVwiZmFsc2VcIicgOiAnIGZpbGxDb2xvcj1cIicgKyBmaWxsQ29sb3IgKyAnXCIgZmlsbGVkPVwidHJ1ZVwiICc7XG4gICAgICAgICAgICB2ZWwgPSAnPHY6b3ZhbCAnICtcbiAgICAgICAgICAgICAgICAgJyBpZD1cImpxc3NoYXBlJyArIHNoYXBlaWQgKyAnXCIgJyArXG4gICAgICAgICAgICAgICAgc3Ryb2tlICtcbiAgICAgICAgICAgICAgICBmaWxsICtcbiAgICAgICAgICAgICAgICAnIHN0eWxlPVwicG9zaXRpb246YWJzb2x1dGU7dG9wOicgKyB5ICsgJ3B4OyBsZWZ0OicgKyB4ICsgJ3B4OyB3aWR0aDonICsgKHJhZGl1cyAqIDIpICsgJ3B4OyBoZWlnaHQ6JyArIChyYWRpdXMgKiAyKSArICdweFwiPjwvdjpvdmFsPic7XG4gICAgICAgICAgICByZXR1cm4gdmVsO1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgX2RyYXdQaWVTbGljZTogZnVuY3Rpb24gKHNoYXBlaWQsIHgsIHksIHJhZGl1cywgc3RhcnRBbmdsZSwgZW5kQW5nbGUsIGxpbmVDb2xvciwgZmlsbENvbG9yKSB7XG4gICAgICAgICAgICB2YXIgdnBhdGgsIHN0YXJ0eCwgc3RhcnR5LCBlbmR4LCBlbmR5LCBzdHJva2UsIGZpbGwsIHZlbDtcbiAgICAgICAgICAgIGlmIChzdGFydEFuZ2xlID09PSBlbmRBbmdsZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAnJzsgIC8vIFZNTCBzZWVtcyB0byBoYXZlIHByb2JsZW0gd2hlbiBzdGFydCBhbmdsZSBlcXVhbHMgZW5kIGFuZ2xlLlxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKChlbmRBbmdsZSAtIHN0YXJ0QW5nbGUpID09PSAoMiAqIE1hdGguUEkpKSB7XG4gICAgICAgICAgICAgICAgc3RhcnRBbmdsZSA9IDAuMDsgIC8vIFZNTCBzZWVtcyB0byBoYXZlIGEgcHJvYmxlbSB3aGVuIGRyYXdpbmcgYSBmdWxsIGNpcmNsZSB0aGF0IGRvZXNuJ3Qgc3RhcnQgMFxuICAgICAgICAgICAgICAgIGVuZEFuZ2xlID0gKDIgKiBNYXRoLlBJKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgc3RhcnR4ID0geCArIE1hdGgucm91bmQoTWF0aC5jb3Moc3RhcnRBbmdsZSkgKiByYWRpdXMpO1xuICAgICAgICAgICAgc3RhcnR5ID0geSArIE1hdGgucm91bmQoTWF0aC5zaW4oc3RhcnRBbmdsZSkgKiByYWRpdXMpO1xuICAgICAgICAgICAgZW5keCA9IHggKyBNYXRoLnJvdW5kKE1hdGguY29zKGVuZEFuZ2xlKSAqIHJhZGl1cyk7XG4gICAgICAgICAgICBlbmR5ID0geSArIE1hdGgucm91bmQoTWF0aC5zaW4oZW5kQW5nbGUpICogcmFkaXVzKTtcblxuICAgICAgICAgICAgaWYgKHN0YXJ0eCA9PT0gZW5keCAmJiBzdGFydHkgPT09IGVuZHkpIHtcbiAgICAgICAgICAgICAgICBpZiAoKGVuZEFuZ2xlIC0gc3RhcnRBbmdsZSkgPCBNYXRoLlBJKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFByZXZlbnQgdmVyeSBzbWFsbCBzbGljZXMgZnJvbSBiZWluZyBtaXN0YWtlbiBhcyBhIHdob2xlIHBpZVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIGVzc2VudGlhbGx5IGdvaW5nIHRvIGJlIHRoZSBlbnRpcmUgY2lyY2xlLCBzbyBpZ25vcmUgc3RhcnRBbmdsZVxuICAgICAgICAgICAgICAgIHN0YXJ0eCA9IGVuZHggPSB4ICsgcmFkaXVzO1xuICAgICAgICAgICAgICAgIHN0YXJ0eSA9IGVuZHkgPSB5O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoc3RhcnR4ID09PSBlbmR4ICYmIHN0YXJ0eSA9PT0gZW5keSAmJiAoZW5kQW5nbGUgLSBzdGFydEFuZ2xlKSA8IE1hdGguUEkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZwYXRoID0gW3ggLSByYWRpdXMsIHkgLSByYWRpdXMsIHggKyByYWRpdXMsIHkgKyByYWRpdXMsIHN0YXJ0eCwgc3RhcnR5LCBlbmR4LCBlbmR5XTtcbiAgICAgICAgICAgIHN0cm9rZSA9IGxpbmVDb2xvciA9PT0gdW5kZWZpbmVkID8gJyBzdHJva2VkPVwiZmFsc2VcIiAnIDogJyBzdHJva2VXZWlnaHQ9XCIxcHhcIiBzdHJva2VDb2xvcj1cIicgKyBsaW5lQ29sb3IgKyAnXCIgJztcbiAgICAgICAgICAgIGZpbGwgPSBmaWxsQ29sb3IgPT09IHVuZGVmaW5lZCA/ICcgZmlsbGVkPVwiZmFsc2VcIicgOiAnIGZpbGxDb2xvcj1cIicgKyBmaWxsQ29sb3IgKyAnXCIgZmlsbGVkPVwidHJ1ZVwiICc7XG4gICAgICAgICAgICB2ZWwgPSAnPHY6c2hhcGUgY29vcmRvcmlnaW49XCIwIDBcIiBjb29yZHNpemU9XCInICsgdGhpcy5waXhlbFdpZHRoICsgJyAnICsgdGhpcy5waXhlbEhlaWdodCArICdcIiAnICtcbiAgICAgICAgICAgICAgICAgJyBpZD1cImpxc3NoYXBlJyArIHNoYXBlaWQgKyAnXCIgJyArXG4gICAgICAgICAgICAgICAgIHN0cm9rZSArXG4gICAgICAgICAgICAgICAgIGZpbGwgK1xuICAgICAgICAgICAgICAgICcgc3R5bGU9XCJwb3NpdGlvbjphYnNvbHV0ZTtsZWZ0OjBweDt0b3A6MHB4O2hlaWdodDonICsgdGhpcy5waXhlbEhlaWdodCArICdweDt3aWR0aDonICsgdGhpcy5waXhlbFdpZHRoICsgJ3B4O3BhZGRpbmc6MHB4O21hcmdpbjowcHg7XCIgJyArXG4gICAgICAgICAgICAgICAgJyBwYXRoPVwibSAnICsgeCArICcsJyArIHkgKyAnIHdhICcgKyB2cGF0aC5qb2luKCcsICcpICsgJyB4IGVcIj4nICtcbiAgICAgICAgICAgICAgICAnIDwvdjpzaGFwZT4nO1xuICAgICAgICAgICAgcmV0dXJuIHZlbDtcbiAgICAgICAgfSxcblxuICAgICAgICBfZHJhd1JlY3Q6IGZ1bmN0aW9uIChzaGFwZWlkLCB4LCB5LCB3aWR0aCwgaGVpZ2h0LCBsaW5lQ29sb3IsIGZpbGxDb2xvcikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2RyYXdTaGFwZShzaGFwZWlkLCBbW3gsIHldLCBbeCwgeSArIGhlaWdodF0sIFt4ICsgd2lkdGgsIHkgKyBoZWlnaHRdLCBbeCArIHdpZHRoLCB5XSwgW3gsIHldXSwgbGluZUNvbG9yLCBmaWxsQ29sb3IpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlc2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLmdyb3VwLmlubmVySFRNTCA9ICcnO1xuICAgICAgICB9LFxuXG4gICAgICAgIGFwcGVuZFNoYXBlOiBmdW5jdGlvbiAoc2hhcGUpIHtcbiAgICAgICAgICAgIHZhciB2ZWwgPSB0aGlzWydfZHJhdycgKyBzaGFwZS50eXBlXS5hcHBseSh0aGlzLCBzaGFwZS5hcmdzKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnJlbmRlcmVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5ncm91cC5pbnNlcnRBZGphY2VudEhUTUwoJ2JlZm9yZUVuZCcsIHZlbCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMucHJlcmVuZGVyICs9IHZlbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubGFzdFNoYXBlSWQgPSBzaGFwZS5pZDtcbiAgICAgICAgICAgIHJldHVybiBzaGFwZS5pZDtcbiAgICAgICAgfSxcblxuICAgICAgICByZXBsYWNlV2l0aFNoYXBlOiBmdW5jdGlvbiAoc2hhcGVpZCwgc2hhcGUpIHtcbiAgICAgICAgICAgIHZhciBleGlzdGluZyA9ICQoJyNqcXNzaGFwZScgKyBzaGFwZWlkKSxcbiAgICAgICAgICAgICAgICB2ZWwgPSB0aGlzWydfZHJhdycgKyBzaGFwZS50eXBlXS5hcHBseSh0aGlzLCBzaGFwZS5hcmdzKTtcbiAgICAgICAgICAgIGV4aXN0aW5nWzBdLm91dGVySFRNTCA9IHZlbDtcbiAgICAgICAgfSxcblxuICAgICAgICByZXBsYWNlV2l0aFNoYXBlczogZnVuY3Rpb24gKHNoYXBlaWRzLCBzaGFwZXMpIHtcbiAgICAgICAgICAgIC8vIHJlcGxhY2UgdGhlIGZpcnN0IHNoYXBlaWQgd2l0aCBhbGwgdGhlIG5ldyBzaGFwZXMgdGhlbiB0b2FzdCB0aGUgcmVtYWluaW5nIG9sZCBzaGFwZXNcbiAgICAgICAgICAgIHZhciBleGlzdGluZyA9ICQoJyNqcXNzaGFwZScgKyBzaGFwZWlkc1swXSksXG4gICAgICAgICAgICAgICAgcmVwbGFjZSA9ICcnLFxuICAgICAgICAgICAgICAgIHNsZW4gPSBzaGFwZXMubGVuZ3RoLFxuICAgICAgICAgICAgICAgIGk7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgc2xlbjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgcmVwbGFjZSArPSB0aGlzWydfZHJhdycgKyBzaGFwZXNbaV0udHlwZV0uYXBwbHkodGhpcywgc2hhcGVzW2ldLmFyZ3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZXhpc3RpbmdbMF0ub3V0ZXJIVE1MID0gcmVwbGFjZTtcbiAgICAgICAgICAgIGZvciAoaSA9IDE7IGkgPCBzaGFwZWlkcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICQoJyNqcXNzaGFwZScgKyBzaGFwZWlkc1tpXSkucmVtb3ZlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgaW5zZXJ0QWZ0ZXJTaGFwZTogZnVuY3Rpb24gKHNoYXBlaWQsIHNoYXBlKSB7XG4gICAgICAgICAgICB2YXIgZXhpc3RpbmcgPSAkKCcjanFzc2hhcGUnICsgc2hhcGVpZCksXG4gICAgICAgICAgICAgICAgIHZlbCA9IHRoaXNbJ19kcmF3JyArIHNoYXBlLnR5cGVdLmFwcGx5KHRoaXMsIHNoYXBlLmFyZ3MpO1xuICAgICAgICAgICAgZXhpc3RpbmdbMF0uaW5zZXJ0QWRqYWNlbnRIVE1MKCdhZnRlckVuZCcsIHZlbCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVtb3ZlU2hhcGVJZDogZnVuY3Rpb24gKHNoYXBlaWQpIHtcbiAgICAgICAgICAgIHZhciBleGlzdGluZyA9ICQoJyNqcXNzaGFwZScgKyBzaGFwZWlkKTtcbiAgICAgICAgICAgIHRoaXMuZ3JvdXAucmVtb3ZlQ2hpbGQoZXhpc3RpbmdbMF0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIGdldFNoYXBlQXQ6IGZ1bmN0aW9uIChlbCwgeCwgeSkge1xuICAgICAgICAgICAgdmFyIHNoYXBlaWQgPSBlbC5pZC5zdWJzdHIoOCk7XG4gICAgICAgICAgICByZXR1cm4gc2hhcGVpZDtcbiAgICAgICAgfSxcblxuICAgICAgICByZW5kZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5yZW5kZXJlZCkge1xuICAgICAgICAgICAgICAgIC8vIGJhdGNoIHRoZSBpbnRpYWwgcmVuZGVyIGludG8gYSBzaW5nbGUgcmVwYWludFxuICAgICAgICAgICAgICAgIHRoaXMuZ3JvdXAuaW5uZXJIVE1MID0gdGhpcy5wcmVyZW5kZXI7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcblxufSkpfShkb2N1bWVudCwgTWF0aCkpO1xuIiwiLyohXG4gKiBtdXN0YWNoZS5qcyAtIExvZ2ljLWxlc3Mge3ttdXN0YWNoZX19IHRlbXBsYXRlcyB3aXRoIEphdmFTY3JpcHRcbiAqIGh0dHA6Ly9naXRodWIuY29tL2phbmwvbXVzdGFjaGUuanNcbiAqL1xuXG4vKmdsb2JhbCBkZWZpbmU6IGZhbHNlIE11c3RhY2hlOiB0cnVlKi9cblxuKGZ1bmN0aW9uIGRlZmluZU11c3RhY2hlIChnbG9iYWwsIGZhY3RvcnkpIHtcbiAgaWYgKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiBleHBvcnRzICYmIHR5cGVvZiBleHBvcnRzLm5vZGVOYW1lICE9PSAnc3RyaW5nJykge1xuICAgIGZhY3RvcnkoZXhwb3J0cyk7IC8vIENvbW1vbkpTXG4gIH0gZWxzZSBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG4gICAgZGVmaW5lKFsnZXhwb3J0cyddLCBmYWN0b3J5KTsgLy8gQU1EXG4gIH0gZWxzZSB7XG4gICAgZ2xvYmFsLk11c3RhY2hlID0ge307XG4gICAgZmFjdG9yeShnbG9iYWwuTXVzdGFjaGUpOyAvLyBzY3JpcHQsIHdzaCwgYXNwXG4gIH1cbn0odGhpcywgZnVuY3Rpb24gbXVzdGFjaGVGYWN0b3J5IChtdXN0YWNoZSkge1xuXG4gIHZhciBvYmplY3RUb1N0cmluZyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7XG4gIHZhciBpc0FycmF5ID0gQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbiBpc0FycmF5UG9seWZpbGwgKG9iamVjdCkge1xuICAgIHJldHVybiBvYmplY3RUb1N0cmluZy5jYWxsKG9iamVjdCkgPT09ICdbb2JqZWN0IEFycmF5XSc7XG4gIH07XG5cbiAgZnVuY3Rpb24gaXNGdW5jdGlvbiAob2JqZWN0KSB7XG4gICAgcmV0dXJuIHR5cGVvZiBvYmplY3QgPT09ICdmdW5jdGlvbic7XG4gIH1cblxuICAvKipcbiAgICogTW9yZSBjb3JyZWN0IHR5cGVvZiBzdHJpbmcgaGFuZGxpbmcgYXJyYXlcbiAgICogd2hpY2ggbm9ybWFsbHkgcmV0dXJucyB0eXBlb2YgJ29iamVjdCdcbiAgICovXG4gIGZ1bmN0aW9uIHR5cGVTdHIgKG9iaikge1xuICAgIHJldHVybiBpc0FycmF5KG9iaikgPyAnYXJyYXknIDogdHlwZW9mIG9iajtcbiAgfVxuXG4gIGZ1bmN0aW9uIGVzY2FwZVJlZ0V4cCAoc3RyaW5nKSB7XG4gICAgcmV0dXJuIHN0cmluZy5yZXBsYWNlKC9bXFwtXFxbXFxde30oKSorPy4sXFxcXFxcXiR8I1xcc10vZywgJ1xcXFwkJicpO1xuICB9XG5cbiAgLyoqXG4gICAqIE51bGwgc2FmZSB3YXkgb2YgY2hlY2tpbmcgd2hldGhlciBvciBub3QgYW4gb2JqZWN0LFxuICAgKiBpbmNsdWRpbmcgaXRzIHByb3RvdHlwZSwgaGFzIGEgZ2l2ZW4gcHJvcGVydHlcbiAgICovXG4gIGZ1bmN0aW9uIGhhc1Byb3BlcnR5IChvYmosIHByb3BOYW1lKSB7XG4gICAgcmV0dXJuIG9iaiAhPSBudWxsICYmIHR5cGVvZiBvYmogPT09ICdvYmplY3QnICYmIChwcm9wTmFtZSBpbiBvYmopO1xuICB9XG5cbiAgLy8gV29ya2Fyb3VuZCBmb3IgaHR0cHM6Ly9pc3N1ZXMuYXBhY2hlLm9yZy9qaXJhL2Jyb3dzZS9DT1VDSERCLTU3N1xuICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2phbmwvbXVzdGFjaGUuanMvaXNzdWVzLzE4OVxuICB2YXIgcmVnRXhwVGVzdCA9IFJlZ0V4cC5wcm90b3R5cGUudGVzdDtcbiAgZnVuY3Rpb24gdGVzdFJlZ0V4cCAocmUsIHN0cmluZykge1xuICAgIHJldHVybiByZWdFeHBUZXN0LmNhbGwocmUsIHN0cmluZyk7XG4gIH1cblxuICB2YXIgbm9uU3BhY2VSZSA9IC9cXFMvO1xuICBmdW5jdGlvbiBpc1doaXRlc3BhY2UgKHN0cmluZykge1xuICAgIHJldHVybiAhdGVzdFJlZ0V4cChub25TcGFjZVJlLCBzdHJpbmcpO1xuICB9XG5cbiAgdmFyIGVudGl0eU1hcCA9IHtcbiAgICAnJic6ICcmYW1wOycsXG4gICAgJzwnOiAnJmx0OycsXG4gICAgJz4nOiAnJmd0OycsXG4gICAgJ1wiJzogJyZxdW90OycsXG4gICAgXCInXCI6ICcmIzM5OycsXG4gICAgJy8nOiAnJiN4MkY7JyxcbiAgICAnYCc6ICcmI3g2MDsnLFxuICAgICc9JzogJyYjeDNEOydcbiAgfTtcblxuICBmdW5jdGlvbiBlc2NhcGVIdG1sIChzdHJpbmcpIHtcbiAgICByZXR1cm4gU3RyaW5nKHN0cmluZykucmVwbGFjZSgvWyY8PlwiJ2A9XFwvXS9nLCBmdW5jdGlvbiBmcm9tRW50aXR5TWFwIChzKSB7XG4gICAgICByZXR1cm4gZW50aXR5TWFwW3NdO1xuICAgIH0pO1xuICB9XG5cbiAgdmFyIHdoaXRlUmUgPSAvXFxzKi87XG4gIHZhciBzcGFjZVJlID0gL1xccysvO1xuICB2YXIgZXF1YWxzUmUgPSAvXFxzKj0vO1xuICB2YXIgY3VybHlSZSA9IC9cXHMqXFx9LztcbiAgdmFyIHRhZ1JlID0gLyN8XFxefFxcL3w+fFxce3wmfD18IS87XG5cbiAgLyoqXG4gICAqIEJyZWFrcyB1cCB0aGUgZ2l2ZW4gYHRlbXBsYXRlYCBzdHJpbmcgaW50byBhIHRyZWUgb2YgdG9rZW5zLiBJZiB0aGUgYHRhZ3NgXG4gICAqIGFyZ3VtZW50IGlzIGdpdmVuIGhlcmUgaXQgbXVzdCBiZSBhbiBhcnJheSB3aXRoIHR3byBzdHJpbmcgdmFsdWVzOiB0aGVcbiAgICogb3BlbmluZyBhbmQgY2xvc2luZyB0YWdzIHVzZWQgaW4gdGhlIHRlbXBsYXRlIChlLmcuIFsgXCI8JVwiLCBcIiU+XCIgXSkuIE9mXG4gICAqIGNvdXJzZSwgdGhlIGRlZmF1bHQgaXMgdG8gdXNlIG11c3RhY2hlcyAoaS5lLiBtdXN0YWNoZS50YWdzKS5cbiAgICpcbiAgICogQSB0b2tlbiBpcyBhbiBhcnJheSB3aXRoIGF0IGxlYXN0IDQgZWxlbWVudHMuIFRoZSBmaXJzdCBlbGVtZW50IGlzIHRoZVxuICAgKiBtdXN0YWNoZSBzeW1ib2wgdGhhdCB3YXMgdXNlZCBpbnNpZGUgdGhlIHRhZywgZS5nLiBcIiNcIiBvciBcIiZcIi4gSWYgdGhlIHRhZ1xuICAgKiBkaWQgbm90IGNvbnRhaW4gYSBzeW1ib2wgKGkuZS4ge3tteVZhbHVlfX0pIHRoaXMgZWxlbWVudCBpcyBcIm5hbWVcIi4gRm9yXG4gICAqIGFsbCB0ZXh0IHRoYXQgYXBwZWFycyBvdXRzaWRlIGEgc3ltYm9sIHRoaXMgZWxlbWVudCBpcyBcInRleHRcIi5cbiAgICpcbiAgICogVGhlIHNlY29uZCBlbGVtZW50IG9mIGEgdG9rZW4gaXMgaXRzIFwidmFsdWVcIi4gRm9yIG11c3RhY2hlIHRhZ3MgdGhpcyBpc1xuICAgKiB3aGF0ZXZlciBlbHNlIHdhcyBpbnNpZGUgdGhlIHRhZyBiZXNpZGVzIHRoZSBvcGVuaW5nIHN5bWJvbC4gRm9yIHRleHQgdG9rZW5zXG4gICAqIHRoaXMgaXMgdGhlIHRleHQgaXRzZWxmLlxuICAgKlxuICAgKiBUaGUgdGhpcmQgYW5kIGZvdXJ0aCBlbGVtZW50cyBvZiB0aGUgdG9rZW4gYXJlIHRoZSBzdGFydCBhbmQgZW5kIGluZGljZXMsXG4gICAqIHJlc3BlY3RpdmVseSwgb2YgdGhlIHRva2VuIGluIHRoZSBvcmlnaW5hbCB0ZW1wbGF0ZS5cbiAgICpcbiAgICogVG9rZW5zIHRoYXQgYXJlIHRoZSByb290IG5vZGUgb2YgYSBzdWJ0cmVlIGNvbnRhaW4gdHdvIG1vcmUgZWxlbWVudHM6IDEpIGFuXG4gICAqIGFycmF5IG9mIHRva2VucyBpbiB0aGUgc3VidHJlZSBhbmQgMikgdGhlIGluZGV4IGluIHRoZSBvcmlnaW5hbCB0ZW1wbGF0ZSBhdFxuICAgKiB3aGljaCB0aGUgY2xvc2luZyB0YWcgZm9yIHRoYXQgc2VjdGlvbiBiZWdpbnMuXG4gICAqL1xuICBmdW5jdGlvbiBwYXJzZVRlbXBsYXRlICh0ZW1wbGF0ZSwgdGFncykge1xuICAgIGlmICghdGVtcGxhdGUpXG4gICAgICByZXR1cm4gW107XG5cbiAgICB2YXIgc2VjdGlvbnMgPSBbXTsgICAgIC8vIFN0YWNrIHRvIGhvbGQgc2VjdGlvbiB0b2tlbnNcbiAgICB2YXIgdG9rZW5zID0gW107ICAgICAgIC8vIEJ1ZmZlciB0byBob2xkIHRoZSB0b2tlbnNcbiAgICB2YXIgc3BhY2VzID0gW107ICAgICAgIC8vIEluZGljZXMgb2Ygd2hpdGVzcGFjZSB0b2tlbnMgb24gdGhlIGN1cnJlbnQgbGluZVxuICAgIHZhciBoYXNUYWcgPSBmYWxzZTsgICAgLy8gSXMgdGhlcmUgYSB7e3RhZ319IG9uIHRoZSBjdXJyZW50IGxpbmU/XG4gICAgdmFyIG5vblNwYWNlID0gZmFsc2U7ICAvLyBJcyB0aGVyZSBhIG5vbi1zcGFjZSBjaGFyIG9uIHRoZSBjdXJyZW50IGxpbmU/XG5cbiAgICAvLyBTdHJpcHMgYWxsIHdoaXRlc3BhY2UgdG9rZW5zIGFycmF5IGZvciB0aGUgY3VycmVudCBsaW5lXG4gICAgLy8gaWYgdGhlcmUgd2FzIGEge3sjdGFnfX0gb24gaXQgYW5kIG90aGVyd2lzZSBvbmx5IHNwYWNlLlxuICAgIGZ1bmN0aW9uIHN0cmlwU3BhY2UgKCkge1xuICAgICAgaWYgKGhhc1RhZyAmJiAhbm9uU3BhY2UpIHtcbiAgICAgICAgd2hpbGUgKHNwYWNlcy5sZW5ndGgpXG4gICAgICAgICAgZGVsZXRlIHRva2Vuc1tzcGFjZXMucG9wKCldO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc3BhY2VzID0gW107XG4gICAgICB9XG5cbiAgICAgIGhhc1RhZyA9IGZhbHNlO1xuICAgICAgbm9uU3BhY2UgPSBmYWxzZTtcbiAgICB9XG5cbiAgICB2YXIgb3BlbmluZ1RhZ1JlLCBjbG9zaW5nVGFnUmUsIGNsb3NpbmdDdXJseVJlO1xuICAgIGZ1bmN0aW9uIGNvbXBpbGVUYWdzICh0YWdzVG9Db21waWxlKSB7XG4gICAgICBpZiAodHlwZW9mIHRhZ3NUb0NvbXBpbGUgPT09ICdzdHJpbmcnKVxuICAgICAgICB0YWdzVG9Db21waWxlID0gdGFnc1RvQ29tcGlsZS5zcGxpdChzcGFjZVJlLCAyKTtcblxuICAgICAgaWYgKCFpc0FycmF5KHRhZ3NUb0NvbXBpbGUpIHx8IHRhZ3NUb0NvbXBpbGUubGVuZ3RoICE9PSAyKVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgdGFnczogJyArIHRhZ3NUb0NvbXBpbGUpO1xuXG4gICAgICBvcGVuaW5nVGFnUmUgPSBuZXcgUmVnRXhwKGVzY2FwZVJlZ0V4cCh0YWdzVG9Db21waWxlWzBdKSArICdcXFxccyonKTtcbiAgICAgIGNsb3NpbmdUYWdSZSA9IG5ldyBSZWdFeHAoJ1xcXFxzKicgKyBlc2NhcGVSZWdFeHAodGFnc1RvQ29tcGlsZVsxXSkpO1xuICAgICAgY2xvc2luZ0N1cmx5UmUgPSBuZXcgUmVnRXhwKCdcXFxccyonICsgZXNjYXBlUmVnRXhwKCd9JyArIHRhZ3NUb0NvbXBpbGVbMV0pKTtcbiAgICB9XG5cbiAgICBjb21waWxlVGFncyh0YWdzIHx8IG11c3RhY2hlLnRhZ3MpO1xuXG4gICAgdmFyIHNjYW5uZXIgPSBuZXcgU2Nhbm5lcih0ZW1wbGF0ZSk7XG5cbiAgICB2YXIgc3RhcnQsIHR5cGUsIHZhbHVlLCBjaHIsIHRva2VuLCBvcGVuU2VjdGlvbjtcbiAgICB3aGlsZSAoIXNjYW5uZXIuZW9zKCkpIHtcbiAgICAgIHN0YXJ0ID0gc2Nhbm5lci5wb3M7XG5cbiAgICAgIC8vIE1hdGNoIGFueSB0ZXh0IGJldHdlZW4gdGFncy5cbiAgICAgIHZhbHVlID0gc2Nhbm5lci5zY2FuVW50aWwob3BlbmluZ1RhZ1JlKTtcblxuICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCB2YWx1ZUxlbmd0aCA9IHZhbHVlLmxlbmd0aDsgaSA8IHZhbHVlTGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICBjaHIgPSB2YWx1ZS5jaGFyQXQoaSk7XG5cbiAgICAgICAgICBpZiAoaXNXaGl0ZXNwYWNlKGNocikpIHtcbiAgICAgICAgICAgIHNwYWNlcy5wdXNoKHRva2Vucy5sZW5ndGgpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBub25TcGFjZSA9IHRydWU7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdG9rZW5zLnB1c2goWyAndGV4dCcsIGNociwgc3RhcnQsIHN0YXJ0ICsgMSBdKTtcbiAgICAgICAgICBzdGFydCArPSAxO1xuXG4gICAgICAgICAgLy8gQ2hlY2sgZm9yIHdoaXRlc3BhY2Ugb24gdGhlIGN1cnJlbnQgbGluZS5cbiAgICAgICAgICBpZiAoY2hyID09PSAnXFxuJylcbiAgICAgICAgICAgIHN0cmlwU3BhY2UoKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBNYXRjaCB0aGUgb3BlbmluZyB0YWcuXG4gICAgICBpZiAoIXNjYW5uZXIuc2NhbihvcGVuaW5nVGFnUmUpKVxuICAgICAgICBicmVhaztcblxuICAgICAgaGFzVGFnID0gdHJ1ZTtcblxuICAgICAgLy8gR2V0IHRoZSB0YWcgdHlwZS5cbiAgICAgIHR5cGUgPSBzY2FubmVyLnNjYW4odGFnUmUpIHx8ICduYW1lJztcbiAgICAgIHNjYW5uZXIuc2Nhbih3aGl0ZVJlKTtcblxuICAgICAgLy8gR2V0IHRoZSB0YWcgdmFsdWUuXG4gICAgICBpZiAodHlwZSA9PT0gJz0nKSB7XG4gICAgICAgIHZhbHVlID0gc2Nhbm5lci5zY2FuVW50aWwoZXF1YWxzUmUpO1xuICAgICAgICBzY2FubmVyLnNjYW4oZXF1YWxzUmUpO1xuICAgICAgICBzY2FubmVyLnNjYW5VbnRpbChjbG9zaW5nVGFnUmUpO1xuICAgICAgfSBlbHNlIGlmICh0eXBlID09PSAneycpIHtcbiAgICAgICAgdmFsdWUgPSBzY2FubmVyLnNjYW5VbnRpbChjbG9zaW5nQ3VybHlSZSk7XG4gICAgICAgIHNjYW5uZXIuc2NhbihjdXJseVJlKTtcbiAgICAgICAgc2Nhbm5lci5zY2FuVW50aWwoY2xvc2luZ1RhZ1JlKTtcbiAgICAgICAgdHlwZSA9ICcmJztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhbHVlID0gc2Nhbm5lci5zY2FuVW50aWwoY2xvc2luZ1RhZ1JlKTtcbiAgICAgIH1cblxuICAgICAgLy8gTWF0Y2ggdGhlIGNsb3NpbmcgdGFnLlxuICAgICAgaWYgKCFzY2FubmVyLnNjYW4oY2xvc2luZ1RhZ1JlKSlcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdVbmNsb3NlZCB0YWcgYXQgJyArIHNjYW5uZXIucG9zKTtcblxuICAgICAgdG9rZW4gPSBbIHR5cGUsIHZhbHVlLCBzdGFydCwgc2Nhbm5lci5wb3MgXTtcbiAgICAgIHRva2Vucy5wdXNoKHRva2VuKTtcblxuICAgICAgaWYgKHR5cGUgPT09ICcjJyB8fCB0eXBlID09PSAnXicpIHtcbiAgICAgICAgc2VjdGlvbnMucHVzaCh0b2tlbik7XG4gICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICcvJykge1xuICAgICAgICAvLyBDaGVjayBzZWN0aW9uIG5lc3RpbmcuXG4gICAgICAgIG9wZW5TZWN0aW9uID0gc2VjdGlvbnMucG9wKCk7XG5cbiAgICAgICAgaWYgKCFvcGVuU2VjdGlvbilcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Vub3BlbmVkIHNlY3Rpb24gXCInICsgdmFsdWUgKyAnXCIgYXQgJyArIHN0YXJ0KTtcblxuICAgICAgICBpZiAob3BlblNlY3Rpb25bMV0gIT09IHZhbHVlKVxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVW5jbG9zZWQgc2VjdGlvbiBcIicgKyBvcGVuU2VjdGlvblsxXSArICdcIiBhdCAnICsgc3RhcnQpO1xuICAgICAgfSBlbHNlIGlmICh0eXBlID09PSAnbmFtZScgfHwgdHlwZSA9PT0gJ3snIHx8IHR5cGUgPT09ICcmJykge1xuICAgICAgICBub25TcGFjZSA9IHRydWU7XG4gICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICc9Jykge1xuICAgICAgICAvLyBTZXQgdGhlIHRhZ3MgZm9yIHRoZSBuZXh0IHRpbWUgYXJvdW5kLlxuICAgICAgICBjb21waWxlVGFncyh2YWx1ZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gTWFrZSBzdXJlIHRoZXJlIGFyZSBubyBvcGVuIHNlY3Rpb25zIHdoZW4gd2UncmUgZG9uZS5cbiAgICBvcGVuU2VjdGlvbiA9IHNlY3Rpb25zLnBvcCgpO1xuXG4gICAgaWYgKG9wZW5TZWN0aW9uKVxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdVbmNsb3NlZCBzZWN0aW9uIFwiJyArIG9wZW5TZWN0aW9uWzFdICsgJ1wiIGF0ICcgKyBzY2FubmVyLnBvcyk7XG5cbiAgICByZXR1cm4gbmVzdFRva2VucyhzcXVhc2hUb2tlbnModG9rZW5zKSk7XG4gIH1cblxuICAvKipcbiAgICogQ29tYmluZXMgdGhlIHZhbHVlcyBvZiBjb25zZWN1dGl2ZSB0ZXh0IHRva2VucyBpbiB0aGUgZ2l2ZW4gYHRva2Vuc2AgYXJyYXlcbiAgICogdG8gYSBzaW5nbGUgdG9rZW4uXG4gICAqL1xuICBmdW5jdGlvbiBzcXVhc2hUb2tlbnMgKHRva2Vucykge1xuICAgIHZhciBzcXVhc2hlZFRva2VucyA9IFtdO1xuXG4gICAgdmFyIHRva2VuLCBsYXN0VG9rZW47XG4gICAgZm9yICh2YXIgaSA9IDAsIG51bVRva2VucyA9IHRva2Vucy5sZW5ndGg7IGkgPCBudW1Ub2tlbnM7ICsraSkge1xuICAgICAgdG9rZW4gPSB0b2tlbnNbaV07XG5cbiAgICAgIGlmICh0b2tlbikge1xuICAgICAgICBpZiAodG9rZW5bMF0gPT09ICd0ZXh0JyAmJiBsYXN0VG9rZW4gJiYgbGFzdFRva2VuWzBdID09PSAndGV4dCcpIHtcbiAgICAgICAgICBsYXN0VG9rZW5bMV0gKz0gdG9rZW5bMV07XG4gICAgICAgICAgbGFzdFRva2VuWzNdID0gdG9rZW5bM107XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc3F1YXNoZWRUb2tlbnMucHVzaCh0b2tlbik7XG4gICAgICAgICAgbGFzdFRva2VuID0gdG9rZW47XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gc3F1YXNoZWRUb2tlbnM7XG4gIH1cblxuICAvKipcbiAgICogRm9ybXMgdGhlIGdpdmVuIGFycmF5IG9mIGB0b2tlbnNgIGludG8gYSBuZXN0ZWQgdHJlZSBzdHJ1Y3R1cmUgd2hlcmVcbiAgICogdG9rZW5zIHRoYXQgcmVwcmVzZW50IGEgc2VjdGlvbiBoYXZlIHR3byBhZGRpdGlvbmFsIGl0ZW1zOiAxKSBhbiBhcnJheSBvZlxuICAgKiBhbGwgdG9rZW5zIHRoYXQgYXBwZWFyIGluIHRoYXQgc2VjdGlvbiBhbmQgMikgdGhlIGluZGV4IGluIHRoZSBvcmlnaW5hbFxuICAgKiB0ZW1wbGF0ZSB0aGF0IHJlcHJlc2VudHMgdGhlIGVuZCBvZiB0aGF0IHNlY3Rpb24uXG4gICAqL1xuICBmdW5jdGlvbiBuZXN0VG9rZW5zICh0b2tlbnMpIHtcbiAgICB2YXIgbmVzdGVkVG9rZW5zID0gW107XG4gICAgdmFyIGNvbGxlY3RvciA9IG5lc3RlZFRva2VucztcbiAgICB2YXIgc2VjdGlvbnMgPSBbXTtcblxuICAgIHZhciB0b2tlbiwgc2VjdGlvbjtcbiAgICBmb3IgKHZhciBpID0gMCwgbnVtVG9rZW5zID0gdG9rZW5zLmxlbmd0aDsgaSA8IG51bVRva2VuczsgKytpKSB7XG4gICAgICB0b2tlbiA9IHRva2Vuc1tpXTtcblxuICAgICAgc3dpdGNoICh0b2tlblswXSkge1xuICAgICAgICBjYXNlICcjJzpcbiAgICAgICAgY2FzZSAnXic6XG4gICAgICAgICAgY29sbGVjdG9yLnB1c2godG9rZW4pO1xuICAgICAgICAgIHNlY3Rpb25zLnB1c2godG9rZW4pO1xuICAgICAgICAgIGNvbGxlY3RvciA9IHRva2VuWzRdID0gW107XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJy8nOlxuICAgICAgICAgIHNlY3Rpb24gPSBzZWN0aW9ucy5wb3AoKTtcbiAgICAgICAgICBzZWN0aW9uWzVdID0gdG9rZW5bMl07XG4gICAgICAgICAgY29sbGVjdG9yID0gc2VjdGlvbnMubGVuZ3RoID4gMCA/IHNlY3Rpb25zW3NlY3Rpb25zLmxlbmd0aCAtIDFdWzRdIDogbmVzdGVkVG9rZW5zO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIGNvbGxlY3Rvci5wdXNoKHRva2VuKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gbmVzdGVkVG9rZW5zO1xuICB9XG5cbiAgLyoqXG4gICAqIEEgc2ltcGxlIHN0cmluZyBzY2FubmVyIHRoYXQgaXMgdXNlZCBieSB0aGUgdGVtcGxhdGUgcGFyc2VyIHRvIGZpbmRcbiAgICogdG9rZW5zIGluIHRlbXBsYXRlIHN0cmluZ3MuXG4gICAqL1xuICBmdW5jdGlvbiBTY2FubmVyIChzdHJpbmcpIHtcbiAgICB0aGlzLnN0cmluZyA9IHN0cmluZztcbiAgICB0aGlzLnRhaWwgPSBzdHJpbmc7XG4gICAgdGhpcy5wb3MgPSAwO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYHRydWVgIGlmIHRoZSB0YWlsIGlzIGVtcHR5IChlbmQgb2Ygc3RyaW5nKS5cbiAgICovXG4gIFNjYW5uZXIucHJvdG90eXBlLmVvcyA9IGZ1bmN0aW9uIGVvcyAoKSB7XG4gICAgcmV0dXJuIHRoaXMudGFpbCA9PT0gJyc7XG4gIH07XG5cbiAgLyoqXG4gICAqIFRyaWVzIHRvIG1hdGNoIHRoZSBnaXZlbiByZWd1bGFyIGV4cHJlc3Npb24gYXQgdGhlIGN1cnJlbnQgcG9zaXRpb24uXG4gICAqIFJldHVybnMgdGhlIG1hdGNoZWQgdGV4dCBpZiBpdCBjYW4gbWF0Y2gsIHRoZSBlbXB0eSBzdHJpbmcgb3RoZXJ3aXNlLlxuICAgKi9cbiAgU2Nhbm5lci5wcm90b3R5cGUuc2NhbiA9IGZ1bmN0aW9uIHNjYW4gKHJlKSB7XG4gICAgdmFyIG1hdGNoID0gdGhpcy50YWlsLm1hdGNoKHJlKTtcblxuICAgIGlmICghbWF0Y2ggfHwgbWF0Y2guaW5kZXggIT09IDApXG4gICAgICByZXR1cm4gJyc7XG5cbiAgICB2YXIgc3RyaW5nID0gbWF0Y2hbMF07XG5cbiAgICB0aGlzLnRhaWwgPSB0aGlzLnRhaWwuc3Vic3RyaW5nKHN0cmluZy5sZW5ndGgpO1xuICAgIHRoaXMucG9zICs9IHN0cmluZy5sZW5ndGg7XG5cbiAgICByZXR1cm4gc3RyaW5nO1xuICB9O1xuXG4gIC8qKlxuICAgKiBTa2lwcyBhbGwgdGV4dCB1bnRpbCB0aGUgZ2l2ZW4gcmVndWxhciBleHByZXNzaW9uIGNhbiBiZSBtYXRjaGVkLiBSZXR1cm5zXG4gICAqIHRoZSBza2lwcGVkIHN0cmluZywgd2hpY2ggaXMgdGhlIGVudGlyZSB0YWlsIGlmIG5vIG1hdGNoIGNhbiBiZSBtYWRlLlxuICAgKi9cbiAgU2Nhbm5lci5wcm90b3R5cGUuc2NhblVudGlsID0gZnVuY3Rpb24gc2NhblVudGlsIChyZSkge1xuICAgIHZhciBpbmRleCA9IHRoaXMudGFpbC5zZWFyY2gocmUpLCBtYXRjaDtcblxuICAgIHN3aXRjaCAoaW5kZXgpIHtcbiAgICAgIGNhc2UgLTE6XG4gICAgICAgIG1hdGNoID0gdGhpcy50YWlsO1xuICAgICAgICB0aGlzLnRhaWwgPSAnJztcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIDA6XG4gICAgICAgIG1hdGNoID0gJyc7XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgbWF0Y2ggPSB0aGlzLnRhaWwuc3Vic3RyaW5nKDAsIGluZGV4KTtcbiAgICAgICAgdGhpcy50YWlsID0gdGhpcy50YWlsLnN1YnN0cmluZyhpbmRleCk7XG4gICAgfVxuXG4gICAgdGhpcy5wb3MgKz0gbWF0Y2gubGVuZ3RoO1xuXG4gICAgcmV0dXJuIG1hdGNoO1xuICB9O1xuXG4gIC8qKlxuICAgKiBSZXByZXNlbnRzIGEgcmVuZGVyaW5nIGNvbnRleHQgYnkgd3JhcHBpbmcgYSB2aWV3IG9iamVjdCBhbmRcbiAgICogbWFpbnRhaW5pbmcgYSByZWZlcmVuY2UgdG8gdGhlIHBhcmVudCBjb250ZXh0LlxuICAgKi9cbiAgZnVuY3Rpb24gQ29udGV4dCAodmlldywgcGFyZW50Q29udGV4dCkge1xuICAgIHRoaXMudmlldyA9IHZpZXc7XG4gICAgdGhpcy5jYWNoZSA9IHsgJy4nOiB0aGlzLnZpZXcgfTtcbiAgICB0aGlzLnBhcmVudCA9IHBhcmVudENvbnRleHQ7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlcyBhIG5ldyBjb250ZXh0IHVzaW5nIHRoZSBnaXZlbiB2aWV3IHdpdGggdGhpcyBjb250ZXh0XG4gICAqIGFzIHRoZSBwYXJlbnQuXG4gICAqL1xuICBDb250ZXh0LnByb3RvdHlwZS5wdXNoID0gZnVuY3Rpb24gcHVzaCAodmlldykge1xuICAgIHJldHVybiBuZXcgQ29udGV4dCh2aWV3LCB0aGlzKTtcbiAgfTtcblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgdmFsdWUgb2YgdGhlIGdpdmVuIG5hbWUgaW4gdGhpcyBjb250ZXh0LCB0cmF2ZXJzaW5nXG4gICAqIHVwIHRoZSBjb250ZXh0IGhpZXJhcmNoeSBpZiB0aGUgdmFsdWUgaXMgYWJzZW50IGluIHRoaXMgY29udGV4dCdzIHZpZXcuXG4gICAqL1xuICBDb250ZXh0LnByb3RvdHlwZS5sb29rdXAgPSBmdW5jdGlvbiBsb29rdXAgKG5hbWUpIHtcbiAgICB2YXIgY2FjaGUgPSB0aGlzLmNhY2hlO1xuXG4gICAgdmFyIHZhbHVlO1xuICAgIGlmIChjYWNoZS5oYXNPd25Qcm9wZXJ0eShuYW1lKSkge1xuICAgICAgdmFsdWUgPSBjYWNoZVtuYW1lXTtcbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIGNvbnRleHQgPSB0aGlzLCBuYW1lcywgaW5kZXgsIGxvb2t1cEhpdCA9IGZhbHNlO1xuXG4gICAgICB3aGlsZSAoY29udGV4dCkge1xuICAgICAgICBpZiAobmFtZS5pbmRleE9mKCcuJykgPiAwKSB7XG4gICAgICAgICAgdmFsdWUgPSBjb250ZXh0LnZpZXc7XG4gICAgICAgICAgbmFtZXMgPSBuYW1lLnNwbGl0KCcuJyk7XG4gICAgICAgICAgaW5kZXggPSAwO1xuXG4gICAgICAgICAgLyoqXG4gICAgICAgICAgICogVXNpbmcgdGhlIGRvdCBub3Rpb24gcGF0aCBpbiBgbmFtZWAsIHdlIGRlc2NlbmQgdGhyb3VnaCB0aGVcbiAgICAgICAgICAgKiBuZXN0ZWQgb2JqZWN0cy5cbiAgICAgICAgICAgKlxuICAgICAgICAgICAqIFRvIGJlIGNlcnRhaW4gdGhhdCB0aGUgbG9va3VwIGhhcyBiZWVuIHN1Y2Nlc3NmdWwsIHdlIGhhdmUgdG9cbiAgICAgICAgICAgKiBjaGVjayBpZiB0aGUgbGFzdCBvYmplY3QgaW4gdGhlIHBhdGggYWN0dWFsbHkgaGFzIHRoZSBwcm9wZXJ0eVxuICAgICAgICAgICAqIHdlIGFyZSBsb29raW5nIGZvci4gV2Ugc3RvcmUgdGhlIHJlc3VsdCBpbiBgbG9va3VwSGl0YC5cbiAgICAgICAgICAgKlxuICAgICAgICAgICAqIFRoaXMgaXMgc3BlY2lhbGx5IG5lY2Vzc2FyeSBmb3Igd2hlbiB0aGUgdmFsdWUgaGFzIGJlZW4gc2V0IHRvXG4gICAgICAgICAgICogYHVuZGVmaW5lZGAgYW5kIHdlIHdhbnQgdG8gYXZvaWQgbG9va2luZyB1cCBwYXJlbnQgY29udGV4dHMuXG4gICAgICAgICAgICoqL1xuICAgICAgICAgIHdoaWxlICh2YWx1ZSAhPSBudWxsICYmIGluZGV4IDwgbmFtZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICBpZiAoaW5kZXggPT09IG5hbWVzLmxlbmd0aCAtIDEpXG4gICAgICAgICAgICAgIGxvb2t1cEhpdCA9IGhhc1Byb3BlcnR5KHZhbHVlLCBuYW1lc1tpbmRleF0pO1xuXG4gICAgICAgICAgICB2YWx1ZSA9IHZhbHVlW25hbWVzW2luZGV4KytdXTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdmFsdWUgPSBjb250ZXh0LnZpZXdbbmFtZV07XG4gICAgICAgICAgbG9va3VwSGl0ID0gaGFzUHJvcGVydHkoY29udGV4dC52aWV3LCBuYW1lKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChsb29rdXBIaXQpXG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY29udGV4dCA9IGNvbnRleHQucGFyZW50O1xuICAgICAgfVxuXG4gICAgICBjYWNoZVtuYW1lXSA9IHZhbHVlO1xuICAgIH1cblxuICAgIGlmIChpc0Z1bmN0aW9uKHZhbHVlKSlcbiAgICAgIHZhbHVlID0gdmFsdWUuY2FsbCh0aGlzLnZpZXcpO1xuXG4gICAgcmV0dXJuIHZhbHVlO1xuICB9O1xuXG4gIC8qKlxuICAgKiBBIFdyaXRlciBrbm93cyBob3cgdG8gdGFrZSBhIHN0cmVhbSBvZiB0b2tlbnMgYW5kIHJlbmRlciB0aGVtIHRvIGFcbiAgICogc3RyaW5nLCBnaXZlbiBhIGNvbnRleHQuIEl0IGFsc28gbWFpbnRhaW5zIGEgY2FjaGUgb2YgdGVtcGxhdGVzIHRvXG4gICAqIGF2b2lkIHRoZSBuZWVkIHRvIHBhcnNlIHRoZSBzYW1lIHRlbXBsYXRlIHR3aWNlLlxuICAgKi9cbiAgZnVuY3Rpb24gV3JpdGVyICgpIHtcbiAgICB0aGlzLmNhY2hlID0ge307XG4gIH1cblxuICAvKipcbiAgICogQ2xlYXJzIGFsbCBjYWNoZWQgdGVtcGxhdGVzIGluIHRoaXMgd3JpdGVyLlxuICAgKi9cbiAgV3JpdGVyLnByb3RvdHlwZS5jbGVhckNhY2hlID0gZnVuY3Rpb24gY2xlYXJDYWNoZSAoKSB7XG4gICAgdGhpcy5jYWNoZSA9IHt9O1xuICB9O1xuXG4gIC8qKlxuICAgKiBQYXJzZXMgYW5kIGNhY2hlcyB0aGUgZ2l2ZW4gYHRlbXBsYXRlYCBhbmQgcmV0dXJucyB0aGUgYXJyYXkgb2YgdG9rZW5zXG4gICAqIHRoYXQgaXMgZ2VuZXJhdGVkIGZyb20gdGhlIHBhcnNlLlxuICAgKi9cbiAgV3JpdGVyLnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uIHBhcnNlICh0ZW1wbGF0ZSwgdGFncykge1xuICAgIHZhciBjYWNoZSA9IHRoaXMuY2FjaGU7XG4gICAgdmFyIHRva2VucyA9IGNhY2hlW3RlbXBsYXRlXTtcblxuICAgIGlmICh0b2tlbnMgPT0gbnVsbClcbiAgICAgIHRva2VucyA9IGNhY2hlW3RlbXBsYXRlXSA9IHBhcnNlVGVtcGxhdGUodGVtcGxhdGUsIHRhZ3MpO1xuXG4gICAgcmV0dXJuIHRva2VucztcbiAgfTtcblxuICAvKipcbiAgICogSGlnaC1sZXZlbCBtZXRob2QgdGhhdCBpcyB1c2VkIHRvIHJlbmRlciB0aGUgZ2l2ZW4gYHRlbXBsYXRlYCB3aXRoXG4gICAqIHRoZSBnaXZlbiBgdmlld2AuXG4gICAqXG4gICAqIFRoZSBvcHRpb25hbCBgcGFydGlhbHNgIGFyZ3VtZW50IG1heSBiZSBhbiBvYmplY3QgdGhhdCBjb250YWlucyB0aGVcbiAgICogbmFtZXMgYW5kIHRlbXBsYXRlcyBvZiBwYXJ0aWFscyB0aGF0IGFyZSB1c2VkIGluIHRoZSB0ZW1wbGF0ZS4gSXQgbWF5XG4gICAqIGFsc28gYmUgYSBmdW5jdGlvbiB0aGF0IGlzIHVzZWQgdG8gbG9hZCBwYXJ0aWFsIHRlbXBsYXRlcyBvbiB0aGUgZmx5XG4gICAqIHRoYXQgdGFrZXMgYSBzaW5nbGUgYXJndW1lbnQ6IHRoZSBuYW1lIG9mIHRoZSBwYXJ0aWFsLlxuICAgKi9cbiAgV3JpdGVyLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiByZW5kZXIgKHRlbXBsYXRlLCB2aWV3LCBwYXJ0aWFscykge1xuICAgIHZhciB0b2tlbnMgPSB0aGlzLnBhcnNlKHRlbXBsYXRlKTtcbiAgICB2YXIgY29udGV4dCA9ICh2aWV3IGluc3RhbmNlb2YgQ29udGV4dCkgPyB2aWV3IDogbmV3IENvbnRleHQodmlldyk7XG4gICAgcmV0dXJuIHRoaXMucmVuZGVyVG9rZW5zKHRva2VucywgY29udGV4dCwgcGFydGlhbHMsIHRlbXBsYXRlKTtcbiAgfTtcblxuICAvKipcbiAgICogTG93LWxldmVsIG1ldGhvZCB0aGF0IHJlbmRlcnMgdGhlIGdpdmVuIGFycmF5IG9mIGB0b2tlbnNgIHVzaW5nXG4gICAqIHRoZSBnaXZlbiBgY29udGV4dGAgYW5kIGBwYXJ0aWFsc2AuXG4gICAqXG4gICAqIE5vdGU6IFRoZSBgb3JpZ2luYWxUZW1wbGF0ZWAgaXMgb25seSBldmVyIHVzZWQgdG8gZXh0cmFjdCB0aGUgcG9ydGlvblxuICAgKiBvZiB0aGUgb3JpZ2luYWwgdGVtcGxhdGUgdGhhdCB3YXMgY29udGFpbmVkIGluIGEgaGlnaGVyLW9yZGVyIHNlY3Rpb24uXG4gICAqIElmIHRoZSB0ZW1wbGF0ZSBkb2Vzbid0IHVzZSBoaWdoZXItb3JkZXIgc2VjdGlvbnMsIHRoaXMgYXJndW1lbnQgbWF5XG4gICAqIGJlIG9taXR0ZWQuXG4gICAqL1xuICBXcml0ZXIucHJvdG90eXBlLnJlbmRlclRva2VucyA9IGZ1bmN0aW9uIHJlbmRlclRva2VucyAodG9rZW5zLCBjb250ZXh0LCBwYXJ0aWFscywgb3JpZ2luYWxUZW1wbGF0ZSkge1xuICAgIHZhciBidWZmZXIgPSAnJztcblxuICAgIHZhciB0b2tlbiwgc3ltYm9sLCB2YWx1ZTtcbiAgICBmb3IgKHZhciBpID0gMCwgbnVtVG9rZW5zID0gdG9rZW5zLmxlbmd0aDsgaSA8IG51bVRva2VuczsgKytpKSB7XG4gICAgICB2YWx1ZSA9IHVuZGVmaW5lZDtcbiAgICAgIHRva2VuID0gdG9rZW5zW2ldO1xuICAgICAgc3ltYm9sID0gdG9rZW5bMF07XG5cbiAgICAgIGlmIChzeW1ib2wgPT09ICcjJykgdmFsdWUgPSB0aGlzLnJlbmRlclNlY3Rpb24odG9rZW4sIGNvbnRleHQsIHBhcnRpYWxzLCBvcmlnaW5hbFRlbXBsYXRlKTtcbiAgICAgIGVsc2UgaWYgKHN5bWJvbCA9PT0gJ14nKSB2YWx1ZSA9IHRoaXMucmVuZGVySW52ZXJ0ZWQodG9rZW4sIGNvbnRleHQsIHBhcnRpYWxzLCBvcmlnaW5hbFRlbXBsYXRlKTtcbiAgICAgIGVsc2UgaWYgKHN5bWJvbCA9PT0gJz4nKSB2YWx1ZSA9IHRoaXMucmVuZGVyUGFydGlhbCh0b2tlbiwgY29udGV4dCwgcGFydGlhbHMsIG9yaWdpbmFsVGVtcGxhdGUpO1xuICAgICAgZWxzZSBpZiAoc3ltYm9sID09PSAnJicpIHZhbHVlID0gdGhpcy51bmVzY2FwZWRWYWx1ZSh0b2tlbiwgY29udGV4dCk7XG4gICAgICBlbHNlIGlmIChzeW1ib2wgPT09ICduYW1lJykgdmFsdWUgPSB0aGlzLmVzY2FwZWRWYWx1ZSh0b2tlbiwgY29udGV4dCk7XG4gICAgICBlbHNlIGlmIChzeW1ib2wgPT09ICd0ZXh0JykgdmFsdWUgPSB0aGlzLnJhd1ZhbHVlKHRva2VuKTtcblxuICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpXG4gICAgICAgIGJ1ZmZlciArPSB2YWx1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gYnVmZmVyO1xuICB9O1xuXG4gIFdyaXRlci5wcm90b3R5cGUucmVuZGVyU2VjdGlvbiA9IGZ1bmN0aW9uIHJlbmRlclNlY3Rpb24gKHRva2VuLCBjb250ZXh0LCBwYXJ0aWFscywgb3JpZ2luYWxUZW1wbGF0ZSkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgYnVmZmVyID0gJyc7XG4gICAgdmFyIHZhbHVlID0gY29udGV4dC5sb29rdXAodG9rZW5bMV0pO1xuXG4gICAgLy8gVGhpcyBmdW5jdGlvbiBpcyB1c2VkIHRvIHJlbmRlciBhbiBhcmJpdHJhcnkgdGVtcGxhdGVcbiAgICAvLyBpbiB0aGUgY3VycmVudCBjb250ZXh0IGJ5IGhpZ2hlci1vcmRlciBzZWN0aW9ucy5cbiAgICBmdW5jdGlvbiBzdWJSZW5kZXIgKHRlbXBsYXRlKSB7XG4gICAgICByZXR1cm4gc2VsZi5yZW5kZXIodGVtcGxhdGUsIGNvbnRleHQsIHBhcnRpYWxzKTtcbiAgICB9XG5cbiAgICBpZiAoIXZhbHVlKSByZXR1cm47XG5cbiAgICBpZiAoaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgIGZvciAodmFyIGogPSAwLCB2YWx1ZUxlbmd0aCA9IHZhbHVlLmxlbmd0aDsgaiA8IHZhbHVlTGVuZ3RoOyArK2opIHtcbiAgICAgICAgYnVmZmVyICs9IHRoaXMucmVuZGVyVG9rZW5zKHRva2VuWzRdLCBjb250ZXh0LnB1c2godmFsdWVbal0pLCBwYXJ0aWFscywgb3JpZ2luYWxUZW1wbGF0ZSk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnIHx8IHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgfHwgdHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJykge1xuICAgICAgYnVmZmVyICs9IHRoaXMucmVuZGVyVG9rZW5zKHRva2VuWzRdLCBjb250ZXh0LnB1c2godmFsdWUpLCBwYXJ0aWFscywgb3JpZ2luYWxUZW1wbGF0ZSk7XG4gICAgfSBlbHNlIGlmIChpc0Z1bmN0aW9uKHZhbHVlKSkge1xuICAgICAgaWYgKHR5cGVvZiBvcmlnaW5hbFRlbXBsYXRlICE9PSAnc3RyaW5nJylcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDYW5ub3QgdXNlIGhpZ2hlci1vcmRlciBzZWN0aW9ucyB3aXRob3V0IHRoZSBvcmlnaW5hbCB0ZW1wbGF0ZScpO1xuXG4gICAgICAvLyBFeHRyYWN0IHRoZSBwb3J0aW9uIG9mIHRoZSBvcmlnaW5hbCB0ZW1wbGF0ZSB0aGF0IHRoZSBzZWN0aW9uIGNvbnRhaW5zLlxuICAgICAgdmFsdWUgPSB2YWx1ZS5jYWxsKGNvbnRleHQudmlldywgb3JpZ2luYWxUZW1wbGF0ZS5zbGljZSh0b2tlblszXSwgdG9rZW5bNV0pLCBzdWJSZW5kZXIpO1xuXG4gICAgICBpZiAodmFsdWUgIT0gbnVsbClcbiAgICAgICAgYnVmZmVyICs9IHZhbHVlO1xuICAgIH0gZWxzZSB7XG4gICAgICBidWZmZXIgKz0gdGhpcy5yZW5kZXJUb2tlbnModG9rZW5bNF0sIGNvbnRleHQsIHBhcnRpYWxzLCBvcmlnaW5hbFRlbXBsYXRlKTtcbiAgICB9XG4gICAgcmV0dXJuIGJ1ZmZlcjtcbiAgfTtcblxuICBXcml0ZXIucHJvdG90eXBlLnJlbmRlckludmVydGVkID0gZnVuY3Rpb24gcmVuZGVySW52ZXJ0ZWQgKHRva2VuLCBjb250ZXh0LCBwYXJ0aWFscywgb3JpZ2luYWxUZW1wbGF0ZSkge1xuICAgIHZhciB2YWx1ZSA9IGNvbnRleHQubG9va3VwKHRva2VuWzFdKTtcblxuICAgIC8vIFVzZSBKYXZhU2NyaXB0J3MgZGVmaW5pdGlvbiBvZiBmYWxzeS4gSW5jbHVkZSBlbXB0eSBhcnJheXMuXG4gICAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9qYW5sL211c3RhY2hlLmpzL2lzc3Vlcy8xODZcbiAgICBpZiAoIXZhbHVlIHx8IChpc0FycmF5KHZhbHVlKSAmJiB2YWx1ZS5sZW5ndGggPT09IDApKVxuICAgICAgcmV0dXJuIHRoaXMucmVuZGVyVG9rZW5zKHRva2VuWzRdLCBjb250ZXh0LCBwYXJ0aWFscywgb3JpZ2luYWxUZW1wbGF0ZSk7XG4gIH07XG5cbiAgV3JpdGVyLnByb3RvdHlwZS5yZW5kZXJQYXJ0aWFsID0gZnVuY3Rpb24gcmVuZGVyUGFydGlhbCAodG9rZW4sIGNvbnRleHQsIHBhcnRpYWxzKSB7XG4gICAgaWYgKCFwYXJ0aWFscykgcmV0dXJuO1xuXG4gICAgdmFyIHZhbHVlID0gaXNGdW5jdGlvbihwYXJ0aWFscykgPyBwYXJ0aWFscyh0b2tlblsxXSkgOiBwYXJ0aWFsc1t0b2tlblsxXV07XG4gICAgaWYgKHZhbHVlICE9IG51bGwpXG4gICAgICByZXR1cm4gdGhpcy5yZW5kZXJUb2tlbnModGhpcy5wYXJzZSh2YWx1ZSksIGNvbnRleHQsIHBhcnRpYWxzLCB2YWx1ZSk7XG4gIH07XG5cbiAgV3JpdGVyLnByb3RvdHlwZS51bmVzY2FwZWRWYWx1ZSA9IGZ1bmN0aW9uIHVuZXNjYXBlZFZhbHVlICh0b2tlbiwgY29udGV4dCkge1xuICAgIHZhciB2YWx1ZSA9IGNvbnRleHQubG9va3VwKHRva2VuWzFdKTtcbiAgICBpZiAodmFsdWUgIT0gbnVsbClcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgfTtcblxuICBXcml0ZXIucHJvdG90eXBlLmVzY2FwZWRWYWx1ZSA9IGZ1bmN0aW9uIGVzY2FwZWRWYWx1ZSAodG9rZW4sIGNvbnRleHQpIHtcbiAgICB2YXIgdmFsdWUgPSBjb250ZXh0Lmxvb2t1cCh0b2tlblsxXSk7XG4gICAgaWYgKHZhbHVlICE9IG51bGwpXG4gICAgICByZXR1cm4gbXVzdGFjaGUuZXNjYXBlKHZhbHVlKTtcbiAgfTtcblxuICBXcml0ZXIucHJvdG90eXBlLnJhd1ZhbHVlID0gZnVuY3Rpb24gcmF3VmFsdWUgKHRva2VuKSB7XG4gICAgcmV0dXJuIHRva2VuWzFdO1xuICB9O1xuXG4gIG11c3RhY2hlLm5hbWUgPSAnbXVzdGFjaGUuanMnO1xuICBtdXN0YWNoZS52ZXJzaW9uID0gJzIuMi4xJztcbiAgbXVzdGFjaGUudGFncyA9IFsgJ3t7JywgJ319JyBdO1xuXG4gIC8vIEFsbCBoaWdoLWxldmVsIG11c3RhY2hlLiogZnVuY3Rpb25zIHVzZSB0aGlzIHdyaXRlci5cbiAgdmFyIGRlZmF1bHRXcml0ZXIgPSBuZXcgV3JpdGVyKCk7XG5cbiAgLyoqXG4gICAqIENsZWFycyBhbGwgY2FjaGVkIHRlbXBsYXRlcyBpbiB0aGUgZGVmYXVsdCB3cml0ZXIuXG4gICAqL1xuICBtdXN0YWNoZS5jbGVhckNhY2hlID0gZnVuY3Rpb24gY2xlYXJDYWNoZSAoKSB7XG4gICAgcmV0dXJuIGRlZmF1bHRXcml0ZXIuY2xlYXJDYWNoZSgpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBQYXJzZXMgYW5kIGNhY2hlcyB0aGUgZ2l2ZW4gdGVtcGxhdGUgaW4gdGhlIGRlZmF1bHQgd3JpdGVyIGFuZCByZXR1cm5zIHRoZVxuICAgKiBhcnJheSBvZiB0b2tlbnMgaXQgY29udGFpbnMuIERvaW5nIHRoaXMgYWhlYWQgb2YgdGltZSBhdm9pZHMgdGhlIG5lZWQgdG9cbiAgICogcGFyc2UgdGVtcGxhdGVzIG9uIHRoZSBmbHkgYXMgdGhleSBhcmUgcmVuZGVyZWQuXG4gICAqL1xuICBtdXN0YWNoZS5wYXJzZSA9IGZ1bmN0aW9uIHBhcnNlICh0ZW1wbGF0ZSwgdGFncykge1xuICAgIHJldHVybiBkZWZhdWx0V3JpdGVyLnBhcnNlKHRlbXBsYXRlLCB0YWdzKTtcbiAgfTtcblxuICAvKipcbiAgICogUmVuZGVycyB0aGUgYHRlbXBsYXRlYCB3aXRoIHRoZSBnaXZlbiBgdmlld2AgYW5kIGBwYXJ0aWFsc2AgdXNpbmcgdGhlXG4gICAqIGRlZmF1bHQgd3JpdGVyLlxuICAgKi9cbiAgbXVzdGFjaGUucmVuZGVyID0gZnVuY3Rpb24gcmVuZGVyICh0ZW1wbGF0ZSwgdmlldywgcGFydGlhbHMpIHtcbiAgICBpZiAodHlwZW9mIHRlbXBsYXRlICE9PSAnc3RyaW5nJykge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSW52YWxpZCB0ZW1wbGF0ZSEgVGVtcGxhdGUgc2hvdWxkIGJlIGEgXCJzdHJpbmdcIiAnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgJ2J1dCBcIicgKyB0eXBlU3RyKHRlbXBsYXRlKSArICdcIiB3YXMgZ2l2ZW4gYXMgdGhlIGZpcnN0ICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAnYXJndW1lbnQgZm9yIG11c3RhY2hlI3JlbmRlcih0ZW1wbGF0ZSwgdmlldywgcGFydGlhbHMpJyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGRlZmF1bHRXcml0ZXIucmVuZGVyKHRlbXBsYXRlLCB2aWV3LCBwYXJ0aWFscyk7XG4gIH07XG5cbiAgLy8gVGhpcyBpcyBoZXJlIGZvciBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eSB3aXRoIDAuNC54LixcbiAgLyplc2xpbnQtZGlzYWJsZSAqLyAvLyBlc2xpbnQgd2FudHMgY2FtZWwgY2FzZWQgZnVuY3Rpb24gbmFtZVxuICBtdXN0YWNoZS50b19odG1sID0gZnVuY3Rpb24gdG9faHRtbCAodGVtcGxhdGUsIHZpZXcsIHBhcnRpYWxzLCBzZW5kKSB7XG4gICAgLyplc2xpbnQtZW5hYmxlKi9cblxuICAgIHZhciByZXN1bHQgPSBtdXN0YWNoZS5yZW5kZXIodGVtcGxhdGUsIHZpZXcsIHBhcnRpYWxzKTtcblxuICAgIGlmIChpc0Z1bmN0aW9uKHNlbmQpKSB7XG4gICAgICBzZW5kKHJlc3VsdCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICB9O1xuXG4gIC8vIEV4cG9ydCB0aGUgZXNjYXBpbmcgZnVuY3Rpb24gc28gdGhhdCB0aGUgdXNlciBtYXkgb3ZlcnJpZGUgaXQuXG4gIC8vIFNlZSBodHRwczovL2dpdGh1Yi5jb20vamFubC9tdXN0YWNoZS5qcy9pc3N1ZXMvMjQ0XG4gIG11c3RhY2hlLmVzY2FwZSA9IGVzY2FwZUh0bWw7XG5cbiAgLy8gRXhwb3J0IHRoZXNlIG1haW5seSBmb3IgdGVzdGluZywgYnV0IGFsc28gZm9yIGFkdmFuY2VkIHVzYWdlLlxuICBtdXN0YWNoZS5TY2FubmVyID0gU2Nhbm5lcjtcbiAgbXVzdGFjaGUuQ29udGV4dCA9IENvbnRleHQ7XG4gIG11c3RhY2hlLldyaXRlciA9IFdyaXRlcjtcblxufSkpO1xuIiwiLyohXG4gKiBaZXJvQ2xpcGJvYXJkXG4gKiBUaGUgWmVyb0NsaXBib2FyZCBsaWJyYXJ5IHByb3ZpZGVzIGFuIGVhc3kgd2F5IHRvIGNvcHkgdGV4dCB0byB0aGUgY2xpcGJvYXJkIHVzaW5nIGFuIGludmlzaWJsZSBBZG9iZSBGbGFzaCBtb3ZpZSBhbmQgYSBKYXZhU2NyaXB0IGludGVyZmFjZS5cbiAqIENvcHlyaWdodCAoYykgMjAwOS0yMDE0IEpvbiBSb2hhbiwgSmFtZXMgTS4gR3JlZW5lXG4gKiBMaWNlbnNlZCBNSVRcbiAqIGh0dHA6Ly96ZXJvY2xpcGJvYXJkLm9yZy9cbiAqIHYyLjIuMFxuICovXG4oZnVuY3Rpb24od2luZG93LCB1bmRlZmluZWQpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG4gIC8qKlxuICogU3RvcmUgcmVmZXJlbmNlcyB0byBjcml0aWNhbGx5IGltcG9ydGFudCBnbG9iYWwgZnVuY3Rpb25zIHRoYXQgbWF5IGJlXG4gKiBvdmVycmlkZGVuIG9uIGNlcnRhaW4gd2ViIHBhZ2VzLlxuICovXG4gIHZhciBfd2luZG93ID0gd2luZG93LCBfZG9jdW1lbnQgPSBfd2luZG93LmRvY3VtZW50LCBfbmF2aWdhdG9yID0gX3dpbmRvdy5uYXZpZ2F0b3IsIF9zZXRUaW1lb3V0ID0gX3dpbmRvdy5zZXRUaW1lb3V0LCBfY2xlYXJUaW1lb3V0ID0gX3dpbmRvdy5jbGVhclRpbWVvdXQsIF9zZXRJbnRlcnZhbCA9IF93aW5kb3cuc2V0SW50ZXJ2YWwsIF9jbGVhckludGVydmFsID0gX3dpbmRvdy5jbGVhckludGVydmFsLCBfZ2V0Q29tcHV0ZWRTdHlsZSA9IF93aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSwgX2VuY29kZVVSSUNvbXBvbmVudCA9IF93aW5kb3cuZW5jb2RlVVJJQ29tcG9uZW50LCBfQWN0aXZlWE9iamVjdCA9IF93aW5kb3cuQWN0aXZlWE9iamVjdCwgX0Vycm9yID0gX3dpbmRvdy5FcnJvciwgX3BhcnNlSW50ID0gX3dpbmRvdy5OdW1iZXIucGFyc2VJbnQgfHwgX3dpbmRvdy5wYXJzZUludCwgX3BhcnNlRmxvYXQgPSBfd2luZG93Lk51bWJlci5wYXJzZUZsb2F0IHx8IF93aW5kb3cucGFyc2VGbG9hdCwgX2lzTmFOID0gX3dpbmRvdy5OdW1iZXIuaXNOYU4gfHwgX3dpbmRvdy5pc05hTiwgX25vdyA9IF93aW5kb3cuRGF0ZS5ub3csIF9rZXlzID0gX3dpbmRvdy5PYmplY3Qua2V5cywgX2RlZmluZVByb3BlcnR5ID0gX3dpbmRvdy5PYmplY3QuZGVmaW5lUHJvcGVydHksIF9oYXNPd24gPSBfd2luZG93Lk9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHksIF9zbGljZSA9IF93aW5kb3cuQXJyYXkucHJvdG90eXBlLnNsaWNlLCBfdW53cmFwID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHVud3JhcHBlciA9IGZ1bmN0aW9uKGVsKSB7XG4gICAgICByZXR1cm4gZWw7XG4gICAgfTtcbiAgICBpZiAodHlwZW9mIF93aW5kb3cud3JhcCA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBfd2luZG93LnVud3JhcCA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICB0cnkge1xuICAgICAgICB2YXIgZGl2ID0gX2RvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgIHZhciB1bndyYXBwZWREaXYgPSBfd2luZG93LnVud3JhcChkaXYpO1xuICAgICAgICBpZiAoZGl2Lm5vZGVUeXBlID09PSAxICYmIHVud3JhcHBlZERpdiAmJiB1bndyYXBwZWREaXYubm9kZVR5cGUgPT09IDEpIHtcbiAgICAgICAgICB1bndyYXBwZXIgPSBfd2luZG93LnVud3JhcDtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZSkge31cbiAgICB9XG4gICAgcmV0dXJuIHVud3JhcHBlcjtcbiAgfSgpO1xuICAvKipcbiAqIENvbnZlcnQgYW4gYGFyZ3VtZW50c2Agb2JqZWN0IGludG8gYW4gQXJyYXkuXG4gKlxuICogQHJldHVybnMgVGhlIGFyZ3VtZW50cyBhcyBhbiBBcnJheVxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2FyZ3MgPSBmdW5jdGlvbihhcmd1bWVudHNPYmopIHtcbiAgICByZXR1cm4gX3NsaWNlLmNhbGwoYXJndW1lbnRzT2JqLCAwKTtcbiAgfTtcbiAgLyoqXG4gKiBTaGFsbG93LWNvcHkgdGhlIG93bmVkLCBlbnVtZXJhYmxlIHByb3BlcnRpZXMgb2Ygb25lIG9iamVjdCBvdmVyIHRvIGFub3RoZXIsIHNpbWlsYXIgdG8galF1ZXJ5J3MgYCQuZXh0ZW5kYC5cbiAqXG4gKiBAcmV0dXJucyBUaGUgdGFyZ2V0IG9iamVjdCwgYXVnbWVudGVkXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZXh0ZW5kID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGksIGxlbiwgYXJnLCBwcm9wLCBzcmMsIGNvcHksIGFyZ3MgPSBfYXJncyhhcmd1bWVudHMpLCB0YXJnZXQgPSBhcmdzWzBdIHx8IHt9O1xuICAgIGZvciAoaSA9IDEsIGxlbiA9IGFyZ3MubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgIGlmICgoYXJnID0gYXJnc1tpXSkgIT0gbnVsbCkge1xuICAgICAgICBmb3IgKHByb3AgaW4gYXJnKSB7XG4gICAgICAgICAgaWYgKF9oYXNPd24uY2FsbChhcmcsIHByb3ApKSB7XG4gICAgICAgICAgICBzcmMgPSB0YXJnZXRbcHJvcF07XG4gICAgICAgICAgICBjb3B5ID0gYXJnW3Byb3BdO1xuICAgICAgICAgICAgaWYgKHRhcmdldCAhPT0gY29weSAmJiBjb3B5ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgdGFyZ2V0W3Byb3BdID0gY29weTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRhcmdldDtcbiAgfTtcbiAgLyoqXG4gKiBSZXR1cm4gYSBkZWVwIGNvcHkgb2YgdGhlIHNvdXJjZSBvYmplY3Qgb3IgYXJyYXkuXG4gKlxuICogQHJldHVybnMgT2JqZWN0IG9yIEFycmF5XG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZGVlcENvcHkgPSBmdW5jdGlvbihzb3VyY2UpIHtcbiAgICB2YXIgY29weSwgaSwgbGVuLCBwcm9wO1xuICAgIGlmICh0eXBlb2Ygc291cmNlICE9PSBcIm9iamVjdFwiIHx8IHNvdXJjZSA9PSBudWxsIHx8IHR5cGVvZiBzb3VyY2Uubm9kZVR5cGUgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgIGNvcHkgPSBzb3VyY2U7XG4gICAgfSBlbHNlIGlmICh0eXBlb2Ygc291cmNlLmxlbmd0aCA9PT0gXCJudW1iZXJcIikge1xuICAgICAgY29weSA9IFtdO1xuICAgICAgZm9yIChpID0gMCwgbGVuID0gc291cmNlLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGlmIChfaGFzT3duLmNhbGwoc291cmNlLCBpKSkge1xuICAgICAgICAgIGNvcHlbaV0gPSBfZGVlcENvcHkoc291cmNlW2ldKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBjb3B5ID0ge307XG4gICAgICBmb3IgKHByb3AgaW4gc291cmNlKSB7XG4gICAgICAgIGlmIChfaGFzT3duLmNhbGwoc291cmNlLCBwcm9wKSkge1xuICAgICAgICAgIGNvcHlbcHJvcF0gPSBfZGVlcENvcHkoc291cmNlW3Byb3BdKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gY29weTtcbiAgfTtcbiAgLyoqXG4gKiBNYWtlcyBhIHNoYWxsb3cgY29weSBvZiBgb2JqYCAobGlrZSBgX2V4dGVuZGApIGJ1dCBmaWx0ZXJzIGl0cyBwcm9wZXJ0aWVzIGJhc2VkIG9uIGEgbGlzdCBvZiBga2V5c2AgdG8ga2VlcC5cbiAqIFRoZSBpbnZlcnNlIG9mIGBfb21pdGAsIG1vc3RseS4gVGhlIGJpZyBkaWZmZXJlbmNlIGlzIHRoYXQgdGhlc2UgcHJvcGVydGllcyBkbyBOT1QgbmVlZCB0byBiZSBlbnVtZXJhYmxlIHRvXG4gKiBiZSBrZXB0LlxuICpcbiAqIEByZXR1cm5zIEEgbmV3IGZpbHRlcmVkIG9iamVjdC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9waWNrID0gZnVuY3Rpb24ob2JqLCBrZXlzKSB7XG4gICAgdmFyIG5ld09iaiA9IHt9O1xuICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBrZXlzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICBpZiAoa2V5c1tpXSBpbiBvYmopIHtcbiAgICAgICAgbmV3T2JqW2tleXNbaV1dID0gb2JqW2tleXNbaV1dO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbmV3T2JqO1xuICB9O1xuICAvKipcbiAqIE1ha2VzIGEgc2hhbGxvdyBjb3B5IG9mIGBvYmpgIChsaWtlIGBfZXh0ZW5kYCkgYnV0IGZpbHRlcnMgaXRzIHByb3BlcnRpZXMgYmFzZWQgb24gYSBsaXN0IG9mIGBrZXlzYCB0byBvbWl0LlxuICogVGhlIGludmVyc2Ugb2YgYF9waWNrYC5cbiAqXG4gKiBAcmV0dXJucyBBIG5ldyBmaWx0ZXJlZCBvYmplY3QuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfb21pdCA9IGZ1bmN0aW9uKG9iaiwga2V5cykge1xuICAgIHZhciBuZXdPYmogPSB7fTtcbiAgICBmb3IgKHZhciBwcm9wIGluIG9iaikge1xuICAgICAgaWYgKGtleXMuaW5kZXhPZihwcm9wKSA9PT0gLTEpIHtcbiAgICAgICAgbmV3T2JqW3Byb3BdID0gb2JqW3Byb3BdO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbmV3T2JqO1xuICB9O1xuICAvKipcbiAqIFJlbW92ZSBhbGwgb3duZWQsIGVudW1lcmFibGUgcHJvcGVydGllcyBmcm9tIGFuIG9iamVjdC5cbiAqXG4gKiBAcmV0dXJucyBUaGUgb3JpZ2luYWwgb2JqZWN0IHdpdGhvdXQgaXRzIG93bmVkLCBlbnVtZXJhYmxlIHByb3BlcnRpZXMuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZGVsZXRlT3duUHJvcGVydGllcyA9IGZ1bmN0aW9uKG9iaikge1xuICAgIGlmIChvYmopIHtcbiAgICAgIGZvciAodmFyIHByb3AgaW4gb2JqKSB7XG4gICAgICAgIGlmIChfaGFzT3duLmNhbGwob2JqLCBwcm9wKSkge1xuICAgICAgICAgIGRlbGV0ZSBvYmpbcHJvcF07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG9iajtcbiAgfTtcbiAgLyoqXG4gKiBEZXRlcm1pbmUgaWYgYW4gZWxlbWVudCBpcyBjb250YWluZWQgd2l0aGluIGFub3RoZXIgZWxlbWVudC5cbiAqXG4gKiBAcmV0dXJucyBCb29sZWFuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY29udGFpbmVkQnkgPSBmdW5jdGlvbihlbCwgYW5jZXN0b3JFbCkge1xuICAgIGlmIChlbCAmJiBlbC5ub2RlVHlwZSA9PT0gMSAmJiBlbC5vd25lckRvY3VtZW50ICYmIGFuY2VzdG9yRWwgJiYgKGFuY2VzdG9yRWwubm9kZVR5cGUgPT09IDEgJiYgYW5jZXN0b3JFbC5vd25lckRvY3VtZW50ICYmIGFuY2VzdG9yRWwub3duZXJEb2N1bWVudCA9PT0gZWwub3duZXJEb2N1bWVudCB8fCBhbmNlc3RvckVsLm5vZGVUeXBlID09PSA5ICYmICFhbmNlc3RvckVsLm93bmVyRG9jdW1lbnQgJiYgYW5jZXN0b3JFbCA9PT0gZWwub3duZXJEb2N1bWVudCkpIHtcbiAgICAgIGRvIHtcbiAgICAgICAgaWYgKGVsID09PSBhbmNlc3RvckVsKSB7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgZWwgPSBlbC5wYXJlbnROb2RlO1xuICAgICAgfSB3aGlsZSAoZWwpO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH07XG4gIC8qKlxuICogR2V0IHRoZSBVUkwgcGF0aCdzIHBhcmVudCBkaXJlY3RvcnkuXG4gKlxuICogQHJldHVybnMgU3RyaW5nIG9yIGB1bmRlZmluZWRgXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZ2V0RGlyUGF0aE9mVXJsID0gZnVuY3Rpb24odXJsKSB7XG4gICAgdmFyIGRpcjtcbiAgICBpZiAodHlwZW9mIHVybCA9PT0gXCJzdHJpbmdcIiAmJiB1cmwpIHtcbiAgICAgIGRpciA9IHVybC5zcGxpdChcIiNcIilbMF0uc3BsaXQoXCI/XCIpWzBdO1xuICAgICAgZGlyID0gdXJsLnNsaWNlKDAsIHVybC5sYXN0SW5kZXhPZihcIi9cIikgKyAxKTtcbiAgICB9XG4gICAgcmV0dXJuIGRpcjtcbiAgfTtcbiAgLyoqXG4gKiBHZXQgdGhlIGN1cnJlbnQgc2NyaXB0J3MgVVJMIGJ5IHRocm93aW5nIGFuIGBFcnJvcmAgYW5kIGFuYWx5emluZyBpdC5cbiAqXG4gKiBAcmV0dXJucyBTdHJpbmcgb3IgYHVuZGVmaW5lZGBcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9nZXRDdXJyZW50U2NyaXB0VXJsRnJvbUVycm9yU3RhY2sgPSBmdW5jdGlvbihzdGFjaykge1xuICAgIHZhciB1cmwsIG1hdGNoZXM7XG4gICAgaWYgKHR5cGVvZiBzdGFjayA9PT0gXCJzdHJpbmdcIiAmJiBzdGFjaykge1xuICAgICAgbWF0Y2hlcyA9IHN0YWNrLm1hdGNoKC9eKD86fFteOkBdKkB8LitcXClAKD89aHR0cFtzXT98ZmlsZSl8Lis/XFxzKyg/OiBhdCB8QCkoPzpbXjpcXChdKyApKltcXChdPykoKD86aHR0cFtzXT98ZmlsZSk6XFwvXFwvW1xcL10/Lis/XFwvW146XFwpXSo/KSg/OjpcXGQrKSg/OjpcXGQrKT8vKTtcbiAgICAgIGlmIChtYXRjaGVzICYmIG1hdGNoZXNbMV0pIHtcbiAgICAgICAgdXJsID0gbWF0Y2hlc1sxXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG1hdGNoZXMgPSBzdGFjay5tYXRjaCgvXFwpQCgoPzpodHRwW3NdP3xmaWxlKTpcXC9cXC9bXFwvXT8uKz9cXC9bXjpcXCldKj8pKD86OlxcZCspKD86OlxcZCspPy8pO1xuICAgICAgICBpZiAobWF0Y2hlcyAmJiBtYXRjaGVzWzFdKSB7XG4gICAgICAgICAgdXJsID0gbWF0Y2hlc1sxXTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdXJsO1xuICB9O1xuICAvKipcbiAqIEdldCB0aGUgY3VycmVudCBzY3JpcHQncyBVUkwgYnkgdGhyb3dpbmcgYW4gYEVycm9yYCBhbmQgYW5hbHl6aW5nIGl0LlxuICpcbiAqIEByZXR1cm5zIFN0cmluZyBvciBgdW5kZWZpbmVkYFxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2dldEN1cnJlbnRTY3JpcHRVcmxGcm9tRXJyb3IgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgdXJsLCBlcnI7XG4gICAgdHJ5IHtcbiAgICAgIHRocm93IG5ldyBfRXJyb3IoKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBlcnIgPSBlO1xuICAgIH1cbiAgICBpZiAoZXJyKSB7XG4gICAgICB1cmwgPSBlcnIuc291cmNlVVJMIHx8IGVyci5maWxlTmFtZSB8fCBfZ2V0Q3VycmVudFNjcmlwdFVybEZyb21FcnJvclN0YWNrKGVyci5zdGFjayk7XG4gICAgfVxuICAgIHJldHVybiB1cmw7XG4gIH07XG4gIC8qKlxuICogR2V0IHRoZSBjdXJyZW50IHNjcmlwdCdzIFVSTC5cbiAqXG4gKiBAcmV0dXJucyBTdHJpbmcgb3IgYHVuZGVmaW5lZGBcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9nZXRDdXJyZW50U2NyaXB0VXJsID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGpzUGF0aCwgc2NyaXB0cywgaTtcbiAgICBpZiAoX2RvY3VtZW50LmN1cnJlbnRTY3JpcHQgJiYgKGpzUGF0aCA9IF9kb2N1bWVudC5jdXJyZW50U2NyaXB0LnNyYykpIHtcbiAgICAgIHJldHVybiBqc1BhdGg7XG4gICAgfVxuICAgIHNjcmlwdHMgPSBfZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzY3JpcHRcIik7XG4gICAgaWYgKHNjcmlwdHMubGVuZ3RoID09PSAxKSB7XG4gICAgICByZXR1cm4gc2NyaXB0c1swXS5zcmMgfHwgdW5kZWZpbmVkO1xuICAgIH1cbiAgICBpZiAoXCJyZWFkeVN0YXRlXCIgaW4gc2NyaXB0c1swXSkge1xuICAgICAgZm9yIChpID0gc2NyaXB0cy5sZW5ndGg7IGktLTsgKSB7XG4gICAgICAgIGlmIChzY3JpcHRzW2ldLnJlYWR5U3RhdGUgPT09IFwiaW50ZXJhY3RpdmVcIiAmJiAoanNQYXRoID0gc2NyaXB0c1tpXS5zcmMpKSB7XG4gICAgICAgICAgcmV0dXJuIGpzUGF0aDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBpZiAoX2RvY3VtZW50LnJlYWR5U3RhdGUgPT09IFwibG9hZGluZ1wiICYmIChqc1BhdGggPSBzY3JpcHRzW3NjcmlwdHMubGVuZ3RoIC0gMV0uc3JjKSkge1xuICAgICAgcmV0dXJuIGpzUGF0aDtcbiAgICB9XG4gICAgaWYgKGpzUGF0aCA9IF9nZXRDdXJyZW50U2NyaXB0VXJsRnJvbUVycm9yKCkpIHtcbiAgICAgIHJldHVybiBqc1BhdGg7XG4gICAgfVxuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH07XG4gIC8qKlxuICogR2V0IHRoZSB1bmFuaW1vdXMgcGFyZW50IGRpcmVjdG9yeSBvZiBBTEwgc2NyaXB0IHRhZ3MuXG4gKiBJZiBhbnkgc2NyaXB0IHRhZ3MgYXJlIGVpdGhlciAoYSkgaW5saW5lIG9yIChiKSBmcm9tIGRpZmZlcmluZyBwYXJlbnRcbiAqIGRpcmVjdG9yaWVzLCB0aGlzIG1ldGhvZCBtdXN0IHJldHVybiBgdW5kZWZpbmVkYC5cbiAqXG4gKiBAcmV0dXJucyBTdHJpbmcgb3IgYHVuZGVmaW5lZGBcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9nZXRVbmFuaW1vdXNTY3JpcHRQYXJlbnREaXIgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgaSwganNEaXIsIGpzUGF0aCwgc2NyaXB0cyA9IF9kb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcInNjcmlwdFwiKTtcbiAgICBmb3IgKGkgPSBzY3JpcHRzLmxlbmd0aDsgaS0tOyApIHtcbiAgICAgIGlmICghKGpzUGF0aCA9IHNjcmlwdHNbaV0uc3JjKSkge1xuICAgICAgICBqc0RpciA9IG51bGw7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAganNQYXRoID0gX2dldERpclBhdGhPZlVybChqc1BhdGgpO1xuICAgICAgaWYgKGpzRGlyID09IG51bGwpIHtcbiAgICAgICAganNEaXIgPSBqc1BhdGg7XG4gICAgICB9IGVsc2UgaWYgKGpzRGlyICE9PSBqc1BhdGgpIHtcbiAgICAgICAganNEaXIgPSBudWxsO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGpzRGlyIHx8IHVuZGVmaW5lZDtcbiAgfTtcbiAgLyoqXG4gKiBHZXQgdGhlIHByZXN1bWVkIGxvY2F0aW9uIG9mIHRoZSBcIlplcm9DbGlwYm9hcmQuc3dmXCIgZmlsZSwgYmFzZWQgb24gdGhlIGxvY2F0aW9uXG4gKiBvZiB0aGUgZXhlY3V0aW5nIEphdmFTY3JpcHQgZmlsZSAoZS5nLiBcIlplcm9DbGlwYm9hcmQuanNcIiwgZXRjLikuXG4gKlxuICogQHJldHVybnMgU3RyaW5nXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZ2V0RGVmYXVsdFN3ZlBhdGggPSBmdW5jdGlvbigpIHtcbiAgICB2YXIganNEaXIgPSBfZ2V0RGlyUGF0aE9mVXJsKF9nZXRDdXJyZW50U2NyaXB0VXJsKCkpIHx8IF9nZXRVbmFuaW1vdXNTY3JpcHRQYXJlbnREaXIoKSB8fCBcIlwiO1xuICAgIHJldHVybiBqc0RpciArIFwiWmVyb0NsaXBib2FyZC5zd2ZcIjtcbiAgfTtcbiAgLyoqXG4gKiBLZWVwIHRyYWNrIG9mIGlmIHRoZSBwYWdlIGlzIGZyYW1lZCAoaW4gYW4gYGlmcmFtZWApLiBUaGlzIGNhbiBuZXZlciBjaGFuZ2UuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfcGFnZUlzRnJhbWVkID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHdpbmRvdy5vcGVuZXIgPT0gbnVsbCAmJiAoISF3aW5kb3cudG9wICYmIHdpbmRvdyAhPSB3aW5kb3cudG9wIHx8ICEhd2luZG93LnBhcmVudCAmJiB3aW5kb3cgIT0gd2luZG93LnBhcmVudCk7XG4gIH0oKTtcbiAgLyoqXG4gKiBLZWVwIHRyYWNrIG9mIHRoZSBzdGF0ZSBvZiB0aGUgRmxhc2ggb2JqZWN0LlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2ZsYXNoU3RhdGUgPSB7XG4gICAgYnJpZGdlOiBudWxsLFxuICAgIHZlcnNpb246IFwiMC4wLjBcIixcbiAgICBwbHVnaW5UeXBlOiBcInVua25vd25cIixcbiAgICBkaXNhYmxlZDogbnVsbCxcbiAgICBvdXRkYXRlZDogbnVsbCxcbiAgICBzYW5kYm94ZWQ6IG51bGwsXG4gICAgdW5hdmFpbGFibGU6IG51bGwsXG4gICAgZGVncmFkZWQ6IG51bGwsXG4gICAgZGVhY3RpdmF0ZWQ6IG51bGwsXG4gICAgb3ZlcmR1ZTogbnVsbCxcbiAgICByZWFkeTogbnVsbFxuICB9O1xuICAvKipcbiAqIFRoZSBtaW5pbXVtIEZsYXNoIFBsYXllciB2ZXJzaW9uIHJlcXVpcmVkIHRvIHVzZSBaZXJvQ2xpcGJvYXJkIGNvbXBsZXRlbHkuXG4gKiBAcmVhZG9ubHlcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9taW5pbXVtRmxhc2hWZXJzaW9uID0gXCIxMS4wLjBcIjtcbiAgLyoqXG4gKiBUaGUgWmVyb0NsaXBib2FyZCBsaWJyYXJ5IHZlcnNpb24gbnVtYmVyLCBhcyByZXBvcnRlZCBieSBGbGFzaCwgYXQgdGhlIHRpbWUgdGhlIFNXRiB3YXMgY29tcGlsZWQuXG4gKi9cbiAgdmFyIF96Y1N3ZlZlcnNpb247XG4gIC8qKlxuICogS2VlcCB0cmFjayBvZiBhbGwgZXZlbnQgbGlzdGVuZXIgcmVnaXN0cmF0aW9ucy5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9oYW5kbGVycyA9IHt9O1xuICAvKipcbiAqIEtlZXAgdHJhY2sgb2YgdGhlIGN1cnJlbnRseSBhY3RpdmF0ZWQgZWxlbWVudC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9jdXJyZW50RWxlbWVudDtcbiAgLyoqXG4gKiBLZWVwIHRyYWNrIG9mIHRoZSBlbGVtZW50IHRoYXQgd2FzIGFjdGl2YXRlZCB3aGVuIGEgYGNvcHlgIHByb2Nlc3Mgc3RhcnRlZC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9jb3B5VGFyZ2V0O1xuICAvKipcbiAqIEtlZXAgdHJhY2sgb2YgZGF0YSBmb3IgdGhlIHBlbmRpbmcgY2xpcGJvYXJkIHRyYW5zYWN0aW9uLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2NsaXBEYXRhID0ge307XG4gIC8qKlxuICogS2VlcCB0cmFjayBvZiBkYXRhIGZvcm1hdHMgZm9yIHRoZSBwZW5kaW5nIGNsaXBib2FyZCB0cmFuc2FjdGlvbi5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9jbGlwRGF0YUZvcm1hdE1hcCA9IG51bGw7XG4gIC8qKlxuICogS2VlcCB0cmFjayBvZiB0aGUgRmxhc2ggYXZhaWxhYmlsaXR5IGNoZWNrIHRpbWVvdXQuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZmxhc2hDaGVja1RpbWVvdXQgPSAwO1xuICAvKipcbiAqIEtlZXAgdHJhY2sgb2YgU1dGIG5ldHdvcmsgZXJyb3JzIGludGVydmFsIHBvbGxpbmcuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfc3dmRmFsbGJhY2tDaGVja0ludGVydmFsID0gMDtcbiAgLyoqXG4gKiBUaGUgYG1lc3NhZ2VgIHN0b3JlIGZvciBldmVudHNcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9ldmVudE1lc3NhZ2VzID0ge1xuICAgIHJlYWR5OiBcIkZsYXNoIGNvbW11bmljYXRpb24gaXMgZXN0YWJsaXNoZWRcIixcbiAgICBlcnJvcjoge1xuICAgICAgXCJmbGFzaC1kaXNhYmxlZFwiOiBcIkZsYXNoIGlzIGRpc2FibGVkIG9yIG5vdCBpbnN0YWxsZWQuIE1heSBhbHNvIGJlIGF0dGVtcHRpbmcgdG8gcnVuIEZsYXNoIGluIGEgc2FuZGJveGVkIGlmcmFtZSwgd2hpY2ggaXMgaW1wb3NzaWJsZS5cIixcbiAgICAgIFwiZmxhc2gtb3V0ZGF0ZWRcIjogXCJGbGFzaCBpcyB0b28gb3V0ZGF0ZWQgdG8gc3VwcG9ydCBaZXJvQ2xpcGJvYXJkXCIsXG4gICAgICBcImZsYXNoLXNhbmRib3hlZFwiOiBcIkF0dGVtcHRpbmcgdG8gcnVuIEZsYXNoIGluIGEgc2FuZGJveGVkIGlmcmFtZSwgd2hpY2ggaXMgaW1wb3NzaWJsZVwiLFxuICAgICAgXCJmbGFzaC11bmF2YWlsYWJsZVwiOiBcIkZsYXNoIGlzIHVuYWJsZSB0byBjb21tdW5pY2F0ZSBiaWRpcmVjdGlvbmFsbHkgd2l0aCBKYXZhU2NyaXB0XCIsXG4gICAgICBcImZsYXNoLWRlZ3JhZGVkXCI6IFwiRmxhc2ggaXMgdW5hYmxlIHRvIHByZXNlcnZlIGRhdGEgZmlkZWxpdHkgd2hlbiBjb21tdW5pY2F0aW5nIHdpdGggSmF2YVNjcmlwdFwiLFxuICAgICAgXCJmbGFzaC1kZWFjdGl2YXRlZFwiOiBcIkZsYXNoIGlzIHRvbyBvdXRkYXRlZCBmb3IgeW91ciBicm93c2VyIGFuZC9vciBpcyBjb25maWd1cmVkIGFzIGNsaWNrLXRvLWFjdGl2YXRlLlxcblRoaXMgbWF5IGFsc28gbWVhbiB0aGF0IHRoZSBaZXJvQ2xpcGJvYXJkIFNXRiBvYmplY3QgY291bGQgbm90IGJlIGxvYWRlZCwgc28gcGxlYXNlIGNoZWNrIHlvdXIgYHN3ZlBhdGhgIGNvbmZpZ3VyYXRpb24gYW5kL29yIG5ldHdvcmsgY29ubmVjdGl2aXR5Llxcbk1heSBhbHNvIGJlIGF0dGVtcHRpbmcgdG8gcnVuIEZsYXNoIGluIGEgc2FuZGJveGVkIGlmcmFtZSwgd2hpY2ggaXMgaW1wb3NzaWJsZS5cIixcbiAgICAgIFwiZmxhc2gtb3ZlcmR1ZVwiOiBcIkZsYXNoIGNvbW11bmljYXRpb24gd2FzIGVzdGFibGlzaGVkIGJ1dCBOT1Qgd2l0aGluIHRoZSBhY2NlcHRhYmxlIHRpbWUgbGltaXRcIixcbiAgICAgIFwidmVyc2lvbi1taXNtYXRjaFwiOiBcIlplcm9DbGlwYm9hcmQgSlMgdmVyc2lvbiBudW1iZXIgZG9lcyBub3QgbWF0Y2ggWmVyb0NsaXBib2FyZCBTV0YgdmVyc2lvbiBudW1iZXJcIixcbiAgICAgIFwiY2xpcGJvYXJkLWVycm9yXCI6IFwiQXQgbGVhc3Qgb25lIGVycm9yIHdhcyB0aHJvd24gd2hpbGUgWmVyb0NsaXBib2FyZCB3YXMgYXR0ZW1wdGluZyB0byBpbmplY3QgeW91ciBkYXRhIGludG8gdGhlIGNsaXBib2FyZFwiLFxuICAgICAgXCJjb25maWctbWlzbWF0Y2hcIjogXCJaZXJvQ2xpcGJvYXJkIGNvbmZpZ3VyYXRpb24gZG9lcyBub3QgbWF0Y2ggRmxhc2gncyByZWFsaXR5XCIsXG4gICAgICBcInN3Zi1ub3QtZm91bmRcIjogXCJUaGUgWmVyb0NsaXBib2FyZCBTV0Ygb2JqZWN0IGNvdWxkIG5vdCBiZSBsb2FkZWQsIHNvIHBsZWFzZSBjaGVjayB5b3VyIGBzd2ZQYXRoYCBjb25maWd1cmF0aW9uIGFuZC9vciBuZXR3b3JrIGNvbm5lY3Rpdml0eVwiXG4gICAgfVxuICB9O1xuICAvKipcbiAqIFRoZSBgbmFtZWBzIG9mIGBlcnJvcmAgZXZlbnRzIHRoYXQgY2FuIG9ubHkgb2NjdXIgaXMgRmxhc2ggaGFzIGF0IGxlYXN0XG4gKiBiZWVuIGFibGUgdG8gbG9hZCB0aGUgU1dGIHN1Y2Nlc3NmdWxseS5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9lcnJvcnNUaGF0T25seU9jY3VyQWZ0ZXJGbGFzaExvYWRzID0gWyBcImZsYXNoLXVuYXZhaWxhYmxlXCIsIFwiZmxhc2gtZGVncmFkZWRcIiwgXCJmbGFzaC1vdmVyZHVlXCIsIFwidmVyc2lvbi1taXNtYXRjaFwiLCBcImNvbmZpZy1taXNtYXRjaFwiLCBcImNsaXBib2FyZC1lcnJvclwiIF07XG4gIC8qKlxuICogVGhlIGBuYW1lYHMgb2YgYGVycm9yYCBldmVudHMgdGhhdCBzaG91bGQgbGlrZWx5IHJlc3VsdCBpbiB0aGUgYF9mbGFzaFN0YXRlYFxuICogdmFyaWFibGUncyBwcm9wZXJ0eSB2YWx1ZXMgYmVpbmcgdXBkYXRlZC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9mbGFzaFN0YXRlRXJyb3JOYW1lcyA9IFsgXCJmbGFzaC1kaXNhYmxlZFwiLCBcImZsYXNoLW91dGRhdGVkXCIsIFwiZmxhc2gtc2FuZGJveGVkXCIsIFwiZmxhc2gtdW5hdmFpbGFibGVcIiwgXCJmbGFzaC1kZWdyYWRlZFwiLCBcImZsYXNoLWRlYWN0aXZhdGVkXCIsIFwiZmxhc2gtb3ZlcmR1ZVwiIF07XG4gIC8qKlxuICogQSBSZWdFeHAgdG8gbWF0Y2ggdGhlIGBuYW1lYCBwcm9wZXJ0eSBvZiBgZXJyb3JgIGV2ZW50cyByZWxhdGVkIHRvIEZsYXNoLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2ZsYXNoU3RhdGVFcnJvck5hbWVNYXRjaGluZ1JlZ2V4ID0gbmV3IFJlZ0V4cChcIl5mbGFzaC0oXCIgKyBfZmxhc2hTdGF0ZUVycm9yTmFtZXMubWFwKGZ1bmN0aW9uKGVycm9yTmFtZSkge1xuICAgIHJldHVybiBlcnJvck5hbWUucmVwbGFjZSgvXmZsYXNoLS8sIFwiXCIpO1xuICB9KS5qb2luKFwifFwiKSArIFwiKSRcIik7XG4gIC8qKlxuICogQSBSZWdFeHAgdG8gbWF0Y2ggdGhlIGBuYW1lYCBwcm9wZXJ0eSBvZiBgZXJyb3JgIGV2ZW50cyByZWxhdGVkIHRvIEZsYXNoLFxuICogd2hpY2ggaXMgZW5hYmxlZC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9mbGFzaFN0YXRlRW5hYmxlZEVycm9yTmFtZU1hdGNoaW5nUmVnZXggPSBuZXcgUmVnRXhwKFwiXmZsYXNoLShcIiArIF9mbGFzaFN0YXRlRXJyb3JOYW1lcy5zbGljZSgxKS5tYXAoZnVuY3Rpb24oZXJyb3JOYW1lKSB7XG4gICAgcmV0dXJuIGVycm9yTmFtZS5yZXBsYWNlKC9eZmxhc2gtLywgXCJcIik7XG4gIH0pLmpvaW4oXCJ8XCIpICsgXCIpJFwiKTtcbiAgLyoqXG4gKiBaZXJvQ2xpcGJvYXJkIGNvbmZpZ3VyYXRpb24gZGVmYXVsdHMgZm9yIHRoZSBDb3JlIG1vZHVsZS5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9nbG9iYWxDb25maWcgPSB7XG4gICAgc3dmUGF0aDogX2dldERlZmF1bHRTd2ZQYXRoKCksXG4gICAgdHJ1c3RlZERvbWFpbnM6IHdpbmRvdy5sb2NhdGlvbi5ob3N0ID8gWyB3aW5kb3cubG9jYXRpb24uaG9zdCBdIDogW10sXG4gICAgY2FjaGVCdXN0OiB0cnVlLFxuICAgIGZvcmNlRW5oYW5jZWRDbGlwYm9hcmQ6IGZhbHNlLFxuICAgIGZsYXNoTG9hZFRpbWVvdXQ6IDNlNCxcbiAgICBhdXRvQWN0aXZhdGU6IHRydWUsXG4gICAgYnViYmxlRXZlbnRzOiB0cnVlLFxuICAgIGNvbnRhaW5lcklkOiBcImdsb2JhbC16ZXJvY2xpcGJvYXJkLWh0bWwtYnJpZGdlXCIsXG4gICAgY29udGFpbmVyQ2xhc3M6IFwiZ2xvYmFsLXplcm9jbGlwYm9hcmQtY29udGFpbmVyXCIsXG4gICAgc3dmT2JqZWN0SWQ6IFwiZ2xvYmFsLXplcm9jbGlwYm9hcmQtZmxhc2gtYnJpZGdlXCIsXG4gICAgaG92ZXJDbGFzczogXCJ6ZXJvY2xpcGJvYXJkLWlzLWhvdmVyXCIsXG4gICAgYWN0aXZlQ2xhc3M6IFwiemVyb2NsaXBib2FyZC1pcy1hY3RpdmVcIixcbiAgICBmb3JjZUhhbmRDdXJzb3I6IGZhbHNlLFxuICAgIHRpdGxlOiBudWxsLFxuICAgIHpJbmRleDogOTk5OTk5OTk5XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuY29uZmlnYC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9jb25maWcgPSBmdW5jdGlvbihvcHRpb25zKSB7XG4gICAgaWYgKHR5cGVvZiBvcHRpb25zID09PSBcIm9iamVjdFwiICYmIG9wdGlvbnMgIT09IG51bGwpIHtcbiAgICAgIGZvciAodmFyIHByb3AgaW4gb3B0aW9ucykge1xuICAgICAgICBpZiAoX2hhc093bi5jYWxsKG9wdGlvbnMsIHByb3ApKSB7XG4gICAgICAgICAgaWYgKC9eKD86Zm9yY2VIYW5kQ3Vyc29yfHRpdGxlfHpJbmRleHxidWJibGVFdmVudHMpJC8udGVzdChwcm9wKSkge1xuICAgICAgICAgICAgX2dsb2JhbENvbmZpZ1twcm9wXSA9IG9wdGlvbnNbcHJvcF07XG4gICAgICAgICAgfSBlbHNlIGlmIChfZmxhc2hTdGF0ZS5icmlkZ2UgPT0gbnVsbCkge1xuICAgICAgICAgICAgaWYgKHByb3AgPT09IFwiY29udGFpbmVySWRcIiB8fCBwcm9wID09PSBcInN3Zk9iamVjdElkXCIpIHtcbiAgICAgICAgICAgICAgaWYgKF9pc1ZhbGlkSHRtbDRJZChvcHRpb25zW3Byb3BdKSkge1xuICAgICAgICAgICAgICAgIF9nbG9iYWxDb25maWdbcHJvcF0gPSBvcHRpb25zW3Byb3BdO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRoZSBzcGVjaWZpZWQgYFwiICsgcHJvcCArIFwiYCB2YWx1ZSBpcyBub3QgdmFsaWQgYXMgYW4gSFRNTDQgRWxlbWVudCBJRFwiKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgX2dsb2JhbENvbmZpZ1twcm9wXSA9IG9wdGlvbnNbcHJvcF07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGlmICh0eXBlb2Ygb3B0aW9ucyA9PT0gXCJzdHJpbmdcIiAmJiBvcHRpb25zKSB7XG4gICAgICBpZiAoX2hhc093bi5jYWxsKF9nbG9iYWxDb25maWcsIG9wdGlvbnMpKSB7XG4gICAgICAgIHJldHVybiBfZ2xvYmFsQ29uZmlnW29wdGlvbnNdO1xuICAgICAgfVxuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICByZXR1cm4gX2RlZXBDb3B5KF9nbG9iYWxDb25maWcpO1xuICB9O1xuICAvKipcbiAqIFRoZSB1bmRlcmx5aW5nIGltcGxlbWVudGF0aW9uIG9mIGBaZXJvQ2xpcGJvYXJkLnN0YXRlYC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9zdGF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgIF9kZXRlY3RTYW5kYm94KCk7XG4gICAgcmV0dXJuIHtcbiAgICAgIGJyb3dzZXI6IF9waWNrKF9uYXZpZ2F0b3IsIFsgXCJ1c2VyQWdlbnRcIiwgXCJwbGF0Zm9ybVwiLCBcImFwcE5hbWVcIiBdKSxcbiAgICAgIGZsYXNoOiBfb21pdChfZmxhc2hTdGF0ZSwgWyBcImJyaWRnZVwiIF0pLFxuICAgICAgemVyb2NsaXBib2FyZDoge1xuICAgICAgICB2ZXJzaW9uOiBaZXJvQ2xpcGJvYXJkLnZlcnNpb24sXG4gICAgICAgIGNvbmZpZzogWmVyb0NsaXBib2FyZC5jb25maWcoKVxuICAgICAgfVxuICAgIH07XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuaXNGbGFzaFVudXNhYmxlYC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9pc0ZsYXNoVW51c2FibGUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gISEoX2ZsYXNoU3RhdGUuZGlzYWJsZWQgfHwgX2ZsYXNoU3RhdGUub3V0ZGF0ZWQgfHwgX2ZsYXNoU3RhdGUuc2FuZGJveGVkIHx8IF9mbGFzaFN0YXRlLnVuYXZhaWxhYmxlIHx8IF9mbGFzaFN0YXRlLmRlZ3JhZGVkIHx8IF9mbGFzaFN0YXRlLmRlYWN0aXZhdGVkKTtcbiAgfTtcbiAgLyoqXG4gKiBUaGUgdW5kZXJseWluZyBpbXBsZW1lbnRhdGlvbiBvZiBgWmVyb0NsaXBib2FyZC5vbmAuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfb24gPSBmdW5jdGlvbihldmVudFR5cGUsIGxpc3RlbmVyKSB7XG4gICAgdmFyIGksIGxlbiwgZXZlbnRzLCBhZGRlZCA9IHt9O1xuICAgIGlmICh0eXBlb2YgZXZlbnRUeXBlID09PSBcInN0cmluZ1wiICYmIGV2ZW50VHlwZSkge1xuICAgICAgZXZlbnRzID0gZXZlbnRUeXBlLnRvTG93ZXJDYXNlKCkuc3BsaXQoL1xccysvKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBldmVudFR5cGUgPT09IFwib2JqZWN0XCIgJiYgZXZlbnRUeXBlICYmIHR5cGVvZiBsaXN0ZW5lciA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgZm9yIChpIGluIGV2ZW50VHlwZSkge1xuICAgICAgICBpZiAoX2hhc093bi5jYWxsKGV2ZW50VHlwZSwgaSkgJiYgdHlwZW9mIGkgPT09IFwic3RyaW5nXCIgJiYgaSAmJiB0eXBlb2YgZXZlbnRUeXBlW2ldID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICBaZXJvQ2xpcGJvYXJkLm9uKGksIGV2ZW50VHlwZVtpXSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGV2ZW50cyAmJiBldmVudHMubGVuZ3RoKSB7XG4gICAgICBmb3IgKGkgPSAwLCBsZW4gPSBldmVudHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgZXZlbnRUeXBlID0gZXZlbnRzW2ldLnJlcGxhY2UoL15vbi8sIFwiXCIpO1xuICAgICAgICBhZGRlZFtldmVudFR5cGVdID0gdHJ1ZTtcbiAgICAgICAgaWYgKCFfaGFuZGxlcnNbZXZlbnRUeXBlXSkge1xuICAgICAgICAgIF9oYW5kbGVyc1tldmVudFR5cGVdID0gW107XG4gICAgICAgIH1cbiAgICAgICAgX2hhbmRsZXJzW2V2ZW50VHlwZV0ucHVzaChsaXN0ZW5lcik7XG4gICAgICB9XG4gICAgICBpZiAoYWRkZWQucmVhZHkgJiYgX2ZsYXNoU3RhdGUucmVhZHkpIHtcbiAgICAgICAgWmVyb0NsaXBib2FyZC5lbWl0KHtcbiAgICAgICAgICB0eXBlOiBcInJlYWR5XCJcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBpZiAoYWRkZWQuZXJyb3IpIHtcbiAgICAgICAgZm9yIChpID0gMCwgbGVuID0gX2ZsYXNoU3RhdGVFcnJvck5hbWVzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgaWYgKF9mbGFzaFN0YXRlW19mbGFzaFN0YXRlRXJyb3JOYW1lc1tpXS5yZXBsYWNlKC9eZmxhc2gtLywgXCJcIildID09PSB0cnVlKSB7XG4gICAgICAgICAgICBaZXJvQ2xpcGJvYXJkLmVtaXQoe1xuICAgICAgICAgICAgICB0eXBlOiBcImVycm9yXCIsXG4gICAgICAgICAgICAgIG5hbWU6IF9mbGFzaFN0YXRlRXJyb3JOYW1lc1tpXVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKF96Y1N3ZlZlcnNpb24gIT09IHVuZGVmaW5lZCAmJiBaZXJvQ2xpcGJvYXJkLnZlcnNpb24gIT09IF96Y1N3ZlZlcnNpb24pIHtcbiAgICAgICAgICBaZXJvQ2xpcGJvYXJkLmVtaXQoe1xuICAgICAgICAgICAgdHlwZTogXCJlcnJvclwiLFxuICAgICAgICAgICAgbmFtZTogXCJ2ZXJzaW9uLW1pc21hdGNoXCIsXG4gICAgICAgICAgICBqc1ZlcnNpb246IFplcm9DbGlwYm9hcmQudmVyc2lvbixcbiAgICAgICAgICAgIHN3ZlZlcnNpb246IF96Y1N3ZlZlcnNpb25cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gWmVyb0NsaXBib2FyZDtcbiAgfTtcbiAgLyoqXG4gKiBUaGUgdW5kZXJseWluZyBpbXBsZW1lbnRhdGlvbiBvZiBgWmVyb0NsaXBib2FyZC5vZmZgLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX29mZiA9IGZ1bmN0aW9uKGV2ZW50VHlwZSwgbGlzdGVuZXIpIHtcbiAgICB2YXIgaSwgbGVuLCBmb3VuZEluZGV4LCBldmVudHMsIHBlckV2ZW50SGFuZGxlcnM7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApIHtcbiAgICAgIGV2ZW50cyA9IF9rZXlzKF9oYW5kbGVycyk7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgZXZlbnRUeXBlID09PSBcInN0cmluZ1wiICYmIGV2ZW50VHlwZSkge1xuICAgICAgZXZlbnRzID0gZXZlbnRUeXBlLnNwbGl0KC9cXHMrLyk7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgZXZlbnRUeXBlID09PSBcIm9iamVjdFwiICYmIGV2ZW50VHlwZSAmJiB0eXBlb2YgbGlzdGVuZXIgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIGZvciAoaSBpbiBldmVudFR5cGUpIHtcbiAgICAgICAgaWYgKF9oYXNPd24uY2FsbChldmVudFR5cGUsIGkpICYmIHR5cGVvZiBpID09PSBcInN0cmluZ1wiICYmIGkgJiYgdHlwZW9mIGV2ZW50VHlwZVtpXSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgWmVyb0NsaXBib2FyZC5vZmYoaSwgZXZlbnRUeXBlW2ldKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBpZiAoZXZlbnRzICYmIGV2ZW50cy5sZW5ndGgpIHtcbiAgICAgIGZvciAoaSA9IDAsIGxlbiA9IGV2ZW50cy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBldmVudFR5cGUgPSBldmVudHNbaV0udG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9eb24vLCBcIlwiKTtcbiAgICAgICAgcGVyRXZlbnRIYW5kbGVycyA9IF9oYW5kbGVyc1tldmVudFR5cGVdO1xuICAgICAgICBpZiAocGVyRXZlbnRIYW5kbGVycyAmJiBwZXJFdmVudEhhbmRsZXJzLmxlbmd0aCkge1xuICAgICAgICAgIGlmIChsaXN0ZW5lcikge1xuICAgICAgICAgICAgZm91bmRJbmRleCA9IHBlckV2ZW50SGFuZGxlcnMuaW5kZXhPZihsaXN0ZW5lcik7XG4gICAgICAgICAgICB3aGlsZSAoZm91bmRJbmRleCAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgcGVyRXZlbnRIYW5kbGVycy5zcGxpY2UoZm91bmRJbmRleCwgMSk7XG4gICAgICAgICAgICAgIGZvdW5kSW5kZXggPSBwZXJFdmVudEhhbmRsZXJzLmluZGV4T2YobGlzdGVuZXIsIGZvdW5kSW5kZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBwZXJFdmVudEhhbmRsZXJzLmxlbmd0aCA9IDA7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBaZXJvQ2xpcGJvYXJkO1xuICB9O1xuICAvKipcbiAqIFRoZSB1bmRlcmx5aW5nIGltcGxlbWVudGF0aW9uIG9mIGBaZXJvQ2xpcGJvYXJkLmhhbmRsZXJzYC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9saXN0ZW5lcnMgPSBmdW5jdGlvbihldmVudFR5cGUpIHtcbiAgICB2YXIgY29weTtcbiAgICBpZiAodHlwZW9mIGV2ZW50VHlwZSA9PT0gXCJzdHJpbmdcIiAmJiBldmVudFR5cGUpIHtcbiAgICAgIGNvcHkgPSBfZGVlcENvcHkoX2hhbmRsZXJzW2V2ZW50VHlwZV0pIHx8IG51bGw7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvcHkgPSBfZGVlcENvcHkoX2hhbmRsZXJzKTtcbiAgICB9XG4gICAgcmV0dXJuIGNvcHk7XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuZW1pdGAuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZW1pdCA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgdmFyIGV2ZW50Q29weSwgcmV0dXJuVmFsLCB0bXA7XG4gICAgZXZlbnQgPSBfY3JlYXRlRXZlbnQoZXZlbnQpO1xuICAgIGlmICghZXZlbnQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKF9wcmVwcm9jZXNzRXZlbnQoZXZlbnQpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChldmVudC50eXBlID09PSBcInJlYWR5XCIgJiYgX2ZsYXNoU3RhdGUub3ZlcmR1ZSA9PT0gdHJ1ZSkge1xuICAgICAgcmV0dXJuIFplcm9DbGlwYm9hcmQuZW1pdCh7XG4gICAgICAgIHR5cGU6IFwiZXJyb3JcIixcbiAgICAgICAgbmFtZTogXCJmbGFzaC1vdmVyZHVlXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBldmVudENvcHkgPSBfZXh0ZW5kKHt9LCBldmVudCk7XG4gICAgX2Rpc3BhdGNoQ2FsbGJhY2tzLmNhbGwodGhpcywgZXZlbnRDb3B5KTtcbiAgICBpZiAoZXZlbnQudHlwZSA9PT0gXCJjb3B5XCIpIHtcbiAgICAgIHRtcCA9IF9tYXBDbGlwRGF0YVRvRmxhc2goX2NsaXBEYXRhKTtcbiAgICAgIHJldHVyblZhbCA9IHRtcC5kYXRhO1xuICAgICAgX2NsaXBEYXRhRm9ybWF0TWFwID0gdG1wLmZvcm1hdE1hcDtcbiAgICB9XG4gICAgcmV0dXJuIHJldHVyblZhbDtcbiAgfTtcbiAgLyoqXG4gKiBUaGUgdW5kZXJseWluZyBpbXBsZW1lbnRhdGlvbiBvZiBgWmVyb0NsaXBib2FyZC5jcmVhdGVgLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2NyZWF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBwcmV2aW91c1N0YXRlID0gX2ZsYXNoU3RhdGUuc2FuZGJveGVkO1xuICAgIF9kZXRlY3RTYW5kYm94KCk7XG4gICAgaWYgKHR5cGVvZiBfZmxhc2hTdGF0ZS5yZWFkeSAhPT0gXCJib29sZWFuXCIpIHtcbiAgICAgIF9mbGFzaFN0YXRlLnJlYWR5ID0gZmFsc2U7XG4gICAgfVxuICAgIGlmIChfZmxhc2hTdGF0ZS5zYW5kYm94ZWQgIT09IHByZXZpb3VzU3RhdGUgJiYgX2ZsYXNoU3RhdGUuc2FuZGJveGVkID09PSB0cnVlKSB7XG4gICAgICBfZmxhc2hTdGF0ZS5yZWFkeSA9IGZhbHNlO1xuICAgICAgWmVyb0NsaXBib2FyZC5lbWl0KHtcbiAgICAgICAgdHlwZTogXCJlcnJvclwiLFxuICAgICAgICBuYW1lOiBcImZsYXNoLXNhbmRib3hlZFwiXG4gICAgICB9KTtcbiAgICB9IGVsc2UgaWYgKCFaZXJvQ2xpcGJvYXJkLmlzRmxhc2hVbnVzYWJsZSgpICYmIF9mbGFzaFN0YXRlLmJyaWRnZSA9PT0gbnVsbCkge1xuICAgICAgdmFyIG1heFdhaXQgPSBfZ2xvYmFsQ29uZmlnLmZsYXNoTG9hZFRpbWVvdXQ7XG4gICAgICBpZiAodHlwZW9mIG1heFdhaXQgPT09IFwibnVtYmVyXCIgJiYgbWF4V2FpdCA+PSAwKSB7XG4gICAgICAgIF9mbGFzaENoZWNrVGltZW91dCA9IF9zZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGlmICh0eXBlb2YgX2ZsYXNoU3RhdGUuZGVhY3RpdmF0ZWQgIT09IFwiYm9vbGVhblwiKSB7XG4gICAgICAgICAgICBfZmxhc2hTdGF0ZS5kZWFjdGl2YXRlZCA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChfZmxhc2hTdGF0ZS5kZWFjdGl2YXRlZCA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgWmVyb0NsaXBib2FyZC5lbWl0KHtcbiAgICAgICAgICAgICAgdHlwZTogXCJlcnJvclwiLFxuICAgICAgICAgICAgICBuYW1lOiBcImZsYXNoLWRlYWN0aXZhdGVkXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSwgbWF4V2FpdCk7XG4gICAgICB9XG4gICAgICBfZmxhc2hTdGF0ZS5vdmVyZHVlID0gZmFsc2U7XG4gICAgICBfZW1iZWRTd2YoKTtcbiAgICB9XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuZGVzdHJveWAuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZGVzdHJveSA9IGZ1bmN0aW9uKCkge1xuICAgIFplcm9DbGlwYm9hcmQuY2xlYXJEYXRhKCk7XG4gICAgWmVyb0NsaXBib2FyZC5ibHVyKCk7XG4gICAgWmVyb0NsaXBib2FyZC5lbWl0KFwiZGVzdHJveVwiKTtcbiAgICBfdW5lbWJlZFN3ZigpO1xuICAgIFplcm9DbGlwYm9hcmQub2ZmKCk7XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuc2V0RGF0YWAuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfc2V0RGF0YSA9IGZ1bmN0aW9uKGZvcm1hdCwgZGF0YSkge1xuICAgIHZhciBkYXRhT2JqO1xuICAgIGlmICh0eXBlb2YgZm9ybWF0ID09PSBcIm9iamVjdFwiICYmIGZvcm1hdCAmJiB0eXBlb2YgZGF0YSA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgZGF0YU9iaiA9IGZvcm1hdDtcbiAgICAgIFplcm9DbGlwYm9hcmQuY2xlYXJEYXRhKCk7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgZm9ybWF0ID09PSBcInN0cmluZ1wiICYmIGZvcm1hdCkge1xuICAgICAgZGF0YU9iaiA9IHt9O1xuICAgICAgZGF0YU9ialtmb3JtYXRdID0gZGF0YTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBmb3IgKHZhciBkYXRhRm9ybWF0IGluIGRhdGFPYmopIHtcbiAgICAgIGlmICh0eXBlb2YgZGF0YUZvcm1hdCA9PT0gXCJzdHJpbmdcIiAmJiBkYXRhRm9ybWF0ICYmIF9oYXNPd24uY2FsbChkYXRhT2JqLCBkYXRhRm9ybWF0KSAmJiB0eXBlb2YgZGF0YU9ialtkYXRhRm9ybWF0XSA9PT0gXCJzdHJpbmdcIiAmJiBkYXRhT2JqW2RhdGFGb3JtYXRdKSB7XG4gICAgICAgIF9jbGlwRGF0YVtkYXRhRm9ybWF0XSA9IGRhdGFPYmpbZGF0YUZvcm1hdF07XG4gICAgICB9XG4gICAgfVxuICB9O1xuICAvKipcbiAqIFRoZSB1bmRlcmx5aW5nIGltcGxlbWVudGF0aW9uIG9mIGBaZXJvQ2xpcGJvYXJkLmNsZWFyRGF0YWAuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY2xlYXJEYXRhID0gZnVuY3Rpb24oZm9ybWF0KSB7XG4gICAgaWYgKHR5cGVvZiBmb3JtYXQgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIF9kZWxldGVPd25Qcm9wZXJ0aWVzKF9jbGlwRGF0YSk7XG4gICAgICBfY2xpcERhdGFGb3JtYXRNYXAgPSBudWxsO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGZvcm1hdCA9PT0gXCJzdHJpbmdcIiAmJiBfaGFzT3duLmNhbGwoX2NsaXBEYXRhLCBmb3JtYXQpKSB7XG4gICAgICBkZWxldGUgX2NsaXBEYXRhW2Zvcm1hdF07XG4gICAgfVxuICB9O1xuICAvKipcbiAqIFRoZSB1bmRlcmx5aW5nIGltcGxlbWVudGF0aW9uIG9mIGBaZXJvQ2xpcGJvYXJkLmdldERhdGFgLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2dldERhdGEgPSBmdW5jdGlvbihmb3JtYXQpIHtcbiAgICBpZiAodHlwZW9mIGZvcm1hdCA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgcmV0dXJuIF9kZWVwQ29weShfY2xpcERhdGEpO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGZvcm1hdCA9PT0gXCJzdHJpbmdcIiAmJiBfaGFzT3duLmNhbGwoX2NsaXBEYXRhLCBmb3JtYXQpKSB7XG4gICAgICByZXR1cm4gX2NsaXBEYXRhW2Zvcm1hdF07XG4gICAgfVxuICB9O1xuICAvKipcbiAqIFRoZSB1bmRlcmx5aW5nIGltcGxlbWVudGF0aW9uIG9mIGBaZXJvQ2xpcGJvYXJkLmZvY3VzYC9gWmVyb0NsaXBib2FyZC5hY3RpdmF0ZWAuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZm9jdXMgPSBmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgaWYgKCEoZWxlbWVudCAmJiBlbGVtZW50Lm5vZGVUeXBlID09PSAxKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoX2N1cnJlbnRFbGVtZW50KSB7XG4gICAgICBfcmVtb3ZlQ2xhc3MoX2N1cnJlbnRFbGVtZW50LCBfZ2xvYmFsQ29uZmlnLmFjdGl2ZUNsYXNzKTtcbiAgICAgIGlmIChfY3VycmVudEVsZW1lbnQgIT09IGVsZW1lbnQpIHtcbiAgICAgICAgX3JlbW92ZUNsYXNzKF9jdXJyZW50RWxlbWVudCwgX2dsb2JhbENvbmZpZy5ob3ZlckNsYXNzKTtcbiAgICAgIH1cbiAgICB9XG4gICAgX2N1cnJlbnRFbGVtZW50ID0gZWxlbWVudDtcbiAgICBfYWRkQ2xhc3MoZWxlbWVudCwgX2dsb2JhbENvbmZpZy5ob3ZlckNsYXNzKTtcbiAgICB2YXIgbmV3VGl0bGUgPSBlbGVtZW50LmdldEF0dHJpYnV0ZShcInRpdGxlXCIpIHx8IF9nbG9iYWxDb25maWcudGl0bGU7XG4gICAgaWYgKHR5cGVvZiBuZXdUaXRsZSA9PT0gXCJzdHJpbmdcIiAmJiBuZXdUaXRsZSkge1xuICAgICAgdmFyIGh0bWxCcmlkZ2UgPSBfZ2V0SHRtbEJyaWRnZShfZmxhc2hTdGF0ZS5icmlkZ2UpO1xuICAgICAgaWYgKGh0bWxCcmlkZ2UpIHtcbiAgICAgICAgaHRtbEJyaWRnZS5zZXRBdHRyaWJ1dGUoXCJ0aXRsZVwiLCBuZXdUaXRsZSk7XG4gICAgICB9XG4gICAgfVxuICAgIHZhciB1c2VIYW5kQ3Vyc29yID0gX2dsb2JhbENvbmZpZy5mb3JjZUhhbmRDdXJzb3IgPT09IHRydWUgfHwgX2dldFN0eWxlKGVsZW1lbnQsIFwiY3Vyc29yXCIpID09PSBcInBvaW50ZXJcIjtcbiAgICBfc2V0SGFuZEN1cnNvcih1c2VIYW5kQ3Vyc29yKTtcbiAgICBfcmVwb3NpdGlvbigpO1xuICB9O1xuICAvKipcbiAqIFRoZSB1bmRlcmx5aW5nIGltcGxlbWVudGF0aW9uIG9mIGBaZXJvQ2xpcGJvYXJkLmJsdXJgL2BaZXJvQ2xpcGJvYXJkLmRlYWN0aXZhdGVgLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2JsdXIgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgaHRtbEJyaWRnZSA9IF9nZXRIdG1sQnJpZGdlKF9mbGFzaFN0YXRlLmJyaWRnZSk7XG4gICAgaWYgKGh0bWxCcmlkZ2UpIHtcbiAgICAgIGh0bWxCcmlkZ2UucmVtb3ZlQXR0cmlidXRlKFwidGl0bGVcIik7XG4gICAgICBodG1sQnJpZGdlLnN0eWxlLmxlZnQgPSBcIjBweFwiO1xuICAgICAgaHRtbEJyaWRnZS5zdHlsZS50b3AgPSBcIi05OTk5cHhcIjtcbiAgICAgIGh0bWxCcmlkZ2Uuc3R5bGUud2lkdGggPSBcIjFweFwiO1xuICAgICAgaHRtbEJyaWRnZS5zdHlsZS5oZWlnaHQgPSBcIjFweFwiO1xuICAgIH1cbiAgICBpZiAoX2N1cnJlbnRFbGVtZW50KSB7XG4gICAgICBfcmVtb3ZlQ2xhc3MoX2N1cnJlbnRFbGVtZW50LCBfZ2xvYmFsQ29uZmlnLmhvdmVyQ2xhc3MpO1xuICAgICAgX3JlbW92ZUNsYXNzKF9jdXJyZW50RWxlbWVudCwgX2dsb2JhbENvbmZpZy5hY3RpdmVDbGFzcyk7XG4gICAgICBfY3VycmVudEVsZW1lbnQgPSBudWxsO1xuICAgIH1cbiAgfTtcbiAgLyoqXG4gKiBUaGUgdW5kZXJseWluZyBpbXBsZW1lbnRhdGlvbiBvZiBgWmVyb0NsaXBib2FyZC5hY3RpdmVFbGVtZW50YC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9hY3RpdmVFbGVtZW50ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIF9jdXJyZW50RWxlbWVudCB8fCBudWxsO1xuICB9O1xuICAvKipcbiAqIENoZWNrIGlmIGEgdmFsdWUgaXMgYSB2YWxpZCBIVE1MNCBgSURgIG9yIGBOYW1lYCB0b2tlbi5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9pc1ZhbGlkSHRtbDRJZCA9IGZ1bmN0aW9uKGlkKSB7XG4gICAgcmV0dXJuIHR5cGVvZiBpZCA9PT0gXCJzdHJpbmdcIiAmJiBpZCAmJiAvXltBLVphLXpdW0EtWmEtejAtOV86XFwtXFwuXSokLy50ZXN0KGlkKTtcbiAgfTtcbiAgLyoqXG4gKiBDcmVhdGUgb3IgdXBkYXRlIGFuIGBldmVudGAgb2JqZWN0LCBiYXNlZCBvbiB0aGUgYGV2ZW50VHlwZWAuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY3JlYXRlRXZlbnQgPSBmdW5jdGlvbihldmVudCkge1xuICAgIHZhciBldmVudFR5cGU7XG4gICAgaWYgKHR5cGVvZiBldmVudCA9PT0gXCJzdHJpbmdcIiAmJiBldmVudCkge1xuICAgICAgZXZlbnRUeXBlID0gZXZlbnQ7XG4gICAgICBldmVudCA9IHt9O1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGV2ZW50ID09PSBcIm9iamVjdFwiICYmIGV2ZW50ICYmIHR5cGVvZiBldmVudC50eXBlID09PSBcInN0cmluZ1wiICYmIGV2ZW50LnR5cGUpIHtcbiAgICAgIGV2ZW50VHlwZSA9IGV2ZW50LnR5cGU7XG4gICAgfVxuICAgIGlmICghZXZlbnRUeXBlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGV2ZW50VHlwZSA9IGV2ZW50VHlwZS50b0xvd2VyQ2FzZSgpO1xuICAgIGlmICghZXZlbnQudGFyZ2V0ICYmICgvXihjb3B5fGFmdGVyY29weXxfY2xpY2spJC8udGVzdChldmVudFR5cGUpIHx8IGV2ZW50VHlwZSA9PT0gXCJlcnJvclwiICYmIGV2ZW50Lm5hbWUgPT09IFwiY2xpcGJvYXJkLWVycm9yXCIpKSB7XG4gICAgICBldmVudC50YXJnZXQgPSBfY29weVRhcmdldDtcbiAgICB9XG4gICAgX2V4dGVuZChldmVudCwge1xuICAgICAgdHlwZTogZXZlbnRUeXBlLFxuICAgICAgdGFyZ2V0OiBldmVudC50YXJnZXQgfHwgX2N1cnJlbnRFbGVtZW50IHx8IG51bGwsXG4gICAgICByZWxhdGVkVGFyZ2V0OiBldmVudC5yZWxhdGVkVGFyZ2V0IHx8IG51bGwsXG4gICAgICBjdXJyZW50VGFyZ2V0OiBfZmxhc2hTdGF0ZSAmJiBfZmxhc2hTdGF0ZS5icmlkZ2UgfHwgbnVsbCxcbiAgICAgIHRpbWVTdGFtcDogZXZlbnQudGltZVN0YW1wIHx8IF9ub3coKSB8fCBudWxsXG4gICAgfSk7XG4gICAgdmFyIG1zZyA9IF9ldmVudE1lc3NhZ2VzW2V2ZW50LnR5cGVdO1xuICAgIGlmIChldmVudC50eXBlID09PSBcImVycm9yXCIgJiYgZXZlbnQubmFtZSAmJiBtc2cpIHtcbiAgICAgIG1zZyA9IG1zZ1tldmVudC5uYW1lXTtcbiAgICB9XG4gICAgaWYgKG1zZykge1xuICAgICAgZXZlbnQubWVzc2FnZSA9IG1zZztcbiAgICB9XG4gICAgaWYgKGV2ZW50LnR5cGUgPT09IFwicmVhZHlcIikge1xuICAgICAgX2V4dGVuZChldmVudCwge1xuICAgICAgICB0YXJnZXQ6IG51bGwsXG4gICAgICAgIHZlcnNpb246IF9mbGFzaFN0YXRlLnZlcnNpb25cbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoZXZlbnQudHlwZSA9PT0gXCJlcnJvclwiKSB7XG4gICAgICBpZiAoX2ZsYXNoU3RhdGVFcnJvck5hbWVNYXRjaGluZ1JlZ2V4LnRlc3QoZXZlbnQubmFtZSkpIHtcbiAgICAgICAgX2V4dGVuZChldmVudCwge1xuICAgICAgICAgIHRhcmdldDogbnVsbCxcbiAgICAgICAgICBtaW5pbXVtVmVyc2lvbjogX21pbmltdW1GbGFzaFZlcnNpb25cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBpZiAoX2ZsYXNoU3RhdGVFbmFibGVkRXJyb3JOYW1lTWF0Y2hpbmdSZWdleC50ZXN0KGV2ZW50Lm5hbWUpKSB7XG4gICAgICAgIF9leHRlbmQoZXZlbnQsIHtcbiAgICAgICAgICB2ZXJzaW9uOiBfZmxhc2hTdGF0ZS52ZXJzaW9uXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoZXZlbnQudHlwZSA9PT0gXCJjb3B5XCIpIHtcbiAgICAgIGV2ZW50LmNsaXBib2FyZERhdGEgPSB7XG4gICAgICAgIHNldERhdGE6IFplcm9DbGlwYm9hcmQuc2V0RGF0YSxcbiAgICAgICAgY2xlYXJEYXRhOiBaZXJvQ2xpcGJvYXJkLmNsZWFyRGF0YVxuICAgICAgfTtcbiAgICB9XG4gICAgaWYgKGV2ZW50LnR5cGUgPT09IFwiYWZ0ZXJjb3B5XCIpIHtcbiAgICAgIGV2ZW50ID0gX21hcENsaXBSZXN1bHRzRnJvbUZsYXNoKGV2ZW50LCBfY2xpcERhdGFGb3JtYXRNYXApO1xuICAgIH1cbiAgICBpZiAoZXZlbnQudGFyZ2V0ICYmICFldmVudC5yZWxhdGVkVGFyZ2V0KSB7XG4gICAgICBldmVudC5yZWxhdGVkVGFyZ2V0ID0gX2dldFJlbGF0ZWRUYXJnZXQoZXZlbnQudGFyZ2V0KTtcbiAgICB9XG4gICAgcmV0dXJuIF9hZGRNb3VzZURhdGEoZXZlbnQpO1xuICB9O1xuICAvKipcbiAqIEdldCBhIHJlbGF0ZWRUYXJnZXQgZnJvbSB0aGUgdGFyZ2V0J3MgYGRhdGEtY2xpcGJvYXJkLXRhcmdldGAgYXR0cmlidXRlXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZ2V0UmVsYXRlZFRhcmdldCA9IGZ1bmN0aW9uKHRhcmdldEVsKSB7XG4gICAgdmFyIHJlbGF0ZWRUYXJnZXRJZCA9IHRhcmdldEVsICYmIHRhcmdldEVsLmdldEF0dHJpYnV0ZSAmJiB0YXJnZXRFbC5nZXRBdHRyaWJ1dGUoXCJkYXRhLWNsaXBib2FyZC10YXJnZXRcIik7XG4gICAgcmV0dXJuIHJlbGF0ZWRUYXJnZXRJZCA/IF9kb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWxhdGVkVGFyZ2V0SWQpIDogbnVsbDtcbiAgfTtcbiAgLyoqXG4gKiBBZGQgZWxlbWVudCBhbmQgcG9zaXRpb24gZGF0YSB0byBgTW91c2VFdmVudGAgaW5zdGFuY2VzXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfYWRkTW91c2VEYXRhID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICBpZiAoZXZlbnQgJiYgL15fKD86Y2xpY2t8bW91c2UoPzpvdmVyfG91dHxkb3dufHVwfG1vdmUpKSQvLnRlc3QoZXZlbnQudHlwZSkpIHtcbiAgICAgIHZhciBzcmNFbGVtZW50ID0gZXZlbnQudGFyZ2V0O1xuICAgICAgdmFyIGZyb21FbGVtZW50ID0gZXZlbnQudHlwZSA9PT0gXCJfbW91c2VvdmVyXCIgJiYgZXZlbnQucmVsYXRlZFRhcmdldCA/IGV2ZW50LnJlbGF0ZWRUYXJnZXQgOiB1bmRlZmluZWQ7XG4gICAgICB2YXIgdG9FbGVtZW50ID0gZXZlbnQudHlwZSA9PT0gXCJfbW91c2VvdXRcIiAmJiBldmVudC5yZWxhdGVkVGFyZ2V0ID8gZXZlbnQucmVsYXRlZFRhcmdldCA6IHVuZGVmaW5lZDtcbiAgICAgIHZhciBwb3MgPSBfZ2V0RWxlbWVudFBvc2l0aW9uKHNyY0VsZW1lbnQpO1xuICAgICAgdmFyIHNjcmVlbkxlZnQgPSBfd2luZG93LnNjcmVlbkxlZnQgfHwgX3dpbmRvdy5zY3JlZW5YIHx8IDA7XG4gICAgICB2YXIgc2NyZWVuVG9wID0gX3dpbmRvdy5zY3JlZW5Ub3AgfHwgX3dpbmRvdy5zY3JlZW5ZIHx8IDA7XG4gICAgICB2YXIgc2Nyb2xsTGVmdCA9IF9kb2N1bWVudC5ib2R5LnNjcm9sbExlZnQgKyBfZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbExlZnQ7XG4gICAgICB2YXIgc2Nyb2xsVG9wID0gX2RvY3VtZW50LmJvZHkuc2Nyb2xsVG9wICsgX2RvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3A7XG4gICAgICB2YXIgcGFnZVggPSBwb3MubGVmdCArICh0eXBlb2YgZXZlbnQuX3N0YWdlWCA9PT0gXCJudW1iZXJcIiA/IGV2ZW50Ll9zdGFnZVggOiAwKTtcbiAgICAgIHZhciBwYWdlWSA9IHBvcy50b3AgKyAodHlwZW9mIGV2ZW50Ll9zdGFnZVkgPT09IFwibnVtYmVyXCIgPyBldmVudC5fc3RhZ2VZIDogMCk7XG4gICAgICB2YXIgY2xpZW50WCA9IHBhZ2VYIC0gc2Nyb2xsTGVmdDtcbiAgICAgIHZhciBjbGllbnRZID0gcGFnZVkgLSBzY3JvbGxUb3A7XG4gICAgICB2YXIgc2NyZWVuWCA9IHNjcmVlbkxlZnQgKyBjbGllbnRYO1xuICAgICAgdmFyIHNjcmVlblkgPSBzY3JlZW5Ub3AgKyBjbGllbnRZO1xuICAgICAgdmFyIG1vdmVYID0gdHlwZW9mIGV2ZW50Lm1vdmVtZW50WCA9PT0gXCJudW1iZXJcIiA/IGV2ZW50Lm1vdmVtZW50WCA6IDA7XG4gICAgICB2YXIgbW92ZVkgPSB0eXBlb2YgZXZlbnQubW92ZW1lbnRZID09PSBcIm51bWJlclwiID8gZXZlbnQubW92ZW1lbnRZIDogMDtcbiAgICAgIGRlbGV0ZSBldmVudC5fc3RhZ2VYO1xuICAgICAgZGVsZXRlIGV2ZW50Ll9zdGFnZVk7XG4gICAgICBfZXh0ZW5kKGV2ZW50LCB7XG4gICAgICAgIHNyY0VsZW1lbnQ6IHNyY0VsZW1lbnQsXG4gICAgICAgIGZyb21FbGVtZW50OiBmcm9tRWxlbWVudCxcbiAgICAgICAgdG9FbGVtZW50OiB0b0VsZW1lbnQsXG4gICAgICAgIHNjcmVlblg6IHNjcmVlblgsXG4gICAgICAgIHNjcmVlblk6IHNjcmVlblksXG4gICAgICAgIHBhZ2VYOiBwYWdlWCxcbiAgICAgICAgcGFnZVk6IHBhZ2VZLFxuICAgICAgICBjbGllbnRYOiBjbGllbnRYLFxuICAgICAgICBjbGllbnRZOiBjbGllbnRZLFxuICAgICAgICB4OiBjbGllbnRYLFxuICAgICAgICB5OiBjbGllbnRZLFxuICAgICAgICBtb3ZlbWVudFg6IG1vdmVYLFxuICAgICAgICBtb3ZlbWVudFk6IG1vdmVZLFxuICAgICAgICBvZmZzZXRYOiAwLFxuICAgICAgICBvZmZzZXRZOiAwLFxuICAgICAgICBsYXllclg6IDAsXG4gICAgICAgIGxheWVyWTogMFxuICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiBldmVudDtcbiAgfTtcbiAgLyoqXG4gKiBEZXRlcm1pbmUgaWYgYW4gZXZlbnQncyByZWdpc3RlcmVkIGhhbmRsZXJzIHNob3VsZCBiZSBleGVjdXRlIHN5bmNocm9ub3VzbHkgb3IgYXN5bmNocm9ub3VzbHkuXG4gKlxuICogQHJldHVybnMge2Jvb2xlYW59XG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfc2hvdWxkUGVyZm9ybUFzeW5jID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICB2YXIgZXZlbnRUeXBlID0gZXZlbnQgJiYgdHlwZW9mIGV2ZW50LnR5cGUgPT09IFwic3RyaW5nXCIgJiYgZXZlbnQudHlwZSB8fCBcIlwiO1xuICAgIHJldHVybiAhL14oPzooPzpiZWZvcmUpP2NvcHl8ZGVzdHJveSkkLy50ZXN0KGV2ZW50VHlwZSk7XG4gIH07XG4gIC8qKlxuICogQ29udHJvbCBpZiBhIGNhbGxiYWNrIHNob3VsZCBiZSBleGVjdXRlZCBhc3luY2hyb25vdXNseSBvciBub3QuXG4gKlxuICogQHJldHVybnMgYHVuZGVmaW5lZGBcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9kaXNwYXRjaENhbGxiYWNrID0gZnVuY3Rpb24oZnVuYywgY29udGV4dCwgYXJncywgYXN5bmMpIHtcbiAgICBpZiAoYXN5bmMpIHtcbiAgICAgIF9zZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xuICAgICAgfSwgMCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGZ1bmMuYXBwbHkoY29udGV4dCwgYXJncyk7XG4gICAgfVxuICB9O1xuICAvKipcbiAqIEhhbmRsZSB0aGUgYWN0dWFsIGRpc3BhdGNoaW5nIG9mIGV2ZW50cyB0byBjbGllbnQgaW5zdGFuY2VzLlxuICpcbiAqIEByZXR1cm5zIGB1bmRlZmluZWRgXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZGlzcGF0Y2hDYWxsYmFja3MgPSBmdW5jdGlvbihldmVudCkge1xuICAgIGlmICghKHR5cGVvZiBldmVudCA9PT0gXCJvYmplY3RcIiAmJiBldmVudCAmJiBldmVudC50eXBlKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgYXN5bmMgPSBfc2hvdWxkUGVyZm9ybUFzeW5jKGV2ZW50KTtcbiAgICB2YXIgd2lsZGNhcmRUeXBlSGFuZGxlcnMgPSBfaGFuZGxlcnNbXCIqXCJdIHx8IFtdO1xuICAgIHZhciBzcGVjaWZpY1R5cGVIYW5kbGVycyA9IF9oYW5kbGVyc1tldmVudC50eXBlXSB8fCBbXTtcbiAgICB2YXIgaGFuZGxlcnMgPSB3aWxkY2FyZFR5cGVIYW5kbGVycy5jb25jYXQoc3BlY2lmaWNUeXBlSGFuZGxlcnMpO1xuICAgIGlmIChoYW5kbGVycyAmJiBoYW5kbGVycy5sZW5ndGgpIHtcbiAgICAgIHZhciBpLCBsZW4sIGZ1bmMsIGNvbnRleHQsIGV2ZW50Q29weSwgb3JpZ2luYWxDb250ZXh0ID0gdGhpcztcbiAgICAgIGZvciAoaSA9IDAsIGxlbiA9IGhhbmRsZXJzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGZ1bmMgPSBoYW5kbGVyc1tpXTtcbiAgICAgICAgY29udGV4dCA9IG9yaWdpbmFsQ29udGV4dDtcbiAgICAgICAgaWYgKHR5cGVvZiBmdW5jID09PSBcInN0cmluZ1wiICYmIHR5cGVvZiBfd2luZG93W2Z1bmNdID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICBmdW5jID0gX3dpbmRvd1tmdW5jXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGZ1bmMgPT09IFwib2JqZWN0XCIgJiYgZnVuYyAmJiB0eXBlb2YgZnVuYy5oYW5kbGVFdmVudCA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgY29udGV4dCA9IGZ1bmM7XG4gICAgICAgICAgZnVuYyA9IGZ1bmMuaGFuZGxlRXZlbnQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBmdW5jID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICBldmVudENvcHkgPSBfZXh0ZW5kKHt9LCBldmVudCk7XG4gICAgICAgICAgX2Rpc3BhdGNoQ2FsbGJhY2soZnVuYywgY29udGV4dCwgWyBldmVudENvcHkgXSwgYXN5bmMpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuICAvKipcbiAqIENoZWNrIGFuIGBlcnJvcmAgZXZlbnQncyBgbmFtZWAgcHJvcGVydHkgdG8gc2VlIGlmIEZsYXNoIGhhc1xuICogYWxyZWFkeSBsb2FkZWQsIHdoaWNoIHJ1bGVzIG91dCBwb3NzaWJsZSBgaWZyYW1lYCBzYW5kYm94aW5nLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2dldFNhbmRib3hTdGF0dXNGcm9tRXJyb3JFdmVudCA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgdmFyIGlzU2FuZGJveGVkID0gbnVsbDtcbiAgICBpZiAoX3BhZ2VJc0ZyYW1lZCA9PT0gZmFsc2UgfHwgZXZlbnQgJiYgZXZlbnQudHlwZSA9PT0gXCJlcnJvclwiICYmIGV2ZW50Lm5hbWUgJiYgX2Vycm9yc1RoYXRPbmx5T2NjdXJBZnRlckZsYXNoTG9hZHMuaW5kZXhPZihldmVudC5uYW1lKSAhPT0gLTEpIHtcbiAgICAgIGlzU2FuZGJveGVkID0gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiBpc1NhbmRib3hlZDtcbiAgfTtcbiAgLyoqXG4gKiBQcmVwcm9jZXNzIGFueSBzcGVjaWFsIGJlaGF2aW9ycywgcmVhY3Rpb25zLCBvciBzdGF0ZSBjaGFuZ2VzIGFmdGVyIHJlY2VpdmluZyB0aGlzIGV2ZW50LlxuICogRXhlY3V0ZXMgb25seSBvbmNlIHBlciBldmVudCBlbWl0dGVkLCBOT1Qgb25jZSBwZXIgY2xpZW50LlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX3ByZXByb2Nlc3NFdmVudCA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgdmFyIGVsZW1lbnQgPSBldmVudC50YXJnZXQgfHwgX2N1cnJlbnRFbGVtZW50IHx8IG51bGw7XG4gICAgdmFyIHNvdXJjZUlzU3dmID0gZXZlbnQuX3NvdXJjZSA9PT0gXCJzd2ZcIjtcbiAgICBkZWxldGUgZXZlbnQuX3NvdXJjZTtcbiAgICBzd2l0Y2ggKGV2ZW50LnR5cGUpIHtcbiAgICAgY2FzZSBcImVycm9yXCI6XG4gICAgICB2YXIgaXNTYW5kYm94ZWQgPSBldmVudC5uYW1lID09PSBcImZsYXNoLXNhbmRib3hlZFwiIHx8IF9nZXRTYW5kYm94U3RhdHVzRnJvbUVycm9yRXZlbnQoZXZlbnQpO1xuICAgICAgaWYgKHR5cGVvZiBpc1NhbmRib3hlZCA9PT0gXCJib29sZWFuXCIpIHtcbiAgICAgICAgX2ZsYXNoU3RhdGUuc2FuZGJveGVkID0gaXNTYW5kYm94ZWQ7XG4gICAgICB9XG4gICAgICBpZiAoX2ZsYXNoU3RhdGVFcnJvck5hbWVzLmluZGV4T2YoZXZlbnQubmFtZSkgIT09IC0xKSB7XG4gICAgICAgIF9leHRlbmQoX2ZsYXNoU3RhdGUsIHtcbiAgICAgICAgICBkaXNhYmxlZDogZXZlbnQubmFtZSA9PT0gXCJmbGFzaC1kaXNhYmxlZFwiLFxuICAgICAgICAgIG91dGRhdGVkOiBldmVudC5uYW1lID09PSBcImZsYXNoLW91dGRhdGVkXCIsXG4gICAgICAgICAgdW5hdmFpbGFibGU6IGV2ZW50Lm5hbWUgPT09IFwiZmxhc2gtdW5hdmFpbGFibGVcIixcbiAgICAgICAgICBkZWdyYWRlZDogZXZlbnQubmFtZSA9PT0gXCJmbGFzaC1kZWdyYWRlZFwiLFxuICAgICAgICAgIGRlYWN0aXZhdGVkOiBldmVudC5uYW1lID09PSBcImZsYXNoLWRlYWN0aXZhdGVkXCIsXG4gICAgICAgICAgb3ZlcmR1ZTogZXZlbnQubmFtZSA9PT0gXCJmbGFzaC1vdmVyZHVlXCIsXG4gICAgICAgICAgcmVhZHk6IGZhbHNlXG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIGlmIChldmVudC5uYW1lID09PSBcInZlcnNpb24tbWlzbWF0Y2hcIikge1xuICAgICAgICBfemNTd2ZWZXJzaW9uID0gZXZlbnQuc3dmVmVyc2lvbjtcbiAgICAgICAgX2V4dGVuZChfZmxhc2hTdGF0ZSwge1xuICAgICAgICAgIGRpc2FibGVkOiBmYWxzZSxcbiAgICAgICAgICBvdXRkYXRlZDogZmFsc2UsXG4gICAgICAgICAgdW5hdmFpbGFibGU6IGZhbHNlLFxuICAgICAgICAgIGRlZ3JhZGVkOiBmYWxzZSxcbiAgICAgICAgICBkZWFjdGl2YXRlZDogZmFsc2UsXG4gICAgICAgICAgb3ZlcmR1ZTogZmFsc2UsXG4gICAgICAgICAgcmVhZHk6IGZhbHNlXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgX2NsZWFyVGltZW91dHNBbmRQb2xsaW5nKCk7XG4gICAgICBicmVhaztcblxuICAgICBjYXNlIFwicmVhZHlcIjpcbiAgICAgIF96Y1N3ZlZlcnNpb24gPSBldmVudC5zd2ZWZXJzaW9uO1xuICAgICAgdmFyIHdhc0RlYWN0aXZhdGVkID0gX2ZsYXNoU3RhdGUuZGVhY3RpdmF0ZWQgPT09IHRydWU7XG4gICAgICBfZXh0ZW5kKF9mbGFzaFN0YXRlLCB7XG4gICAgICAgIGRpc2FibGVkOiBmYWxzZSxcbiAgICAgICAgb3V0ZGF0ZWQ6IGZhbHNlLFxuICAgICAgICBzYW5kYm94ZWQ6IGZhbHNlLFxuICAgICAgICB1bmF2YWlsYWJsZTogZmFsc2UsXG4gICAgICAgIGRlZ3JhZGVkOiBmYWxzZSxcbiAgICAgICAgZGVhY3RpdmF0ZWQ6IGZhbHNlLFxuICAgICAgICBvdmVyZHVlOiB3YXNEZWFjdGl2YXRlZCxcbiAgICAgICAgcmVhZHk6ICF3YXNEZWFjdGl2YXRlZFxuICAgICAgfSk7XG4gICAgICBfY2xlYXJUaW1lb3V0c0FuZFBvbGxpbmcoKTtcbiAgICAgIGJyZWFrO1xuXG4gICAgIGNhc2UgXCJiZWZvcmVjb3B5XCI6XG4gICAgICBfY29weVRhcmdldCA9IGVsZW1lbnQ7XG4gICAgICBicmVhaztcblxuICAgICBjYXNlIFwiY29weVwiOlxuICAgICAgdmFyIHRleHRDb250ZW50LCBodG1sQ29udGVudCwgdGFyZ2V0RWwgPSBldmVudC5yZWxhdGVkVGFyZ2V0O1xuICAgICAgaWYgKCEoX2NsaXBEYXRhW1widGV4dC9odG1sXCJdIHx8IF9jbGlwRGF0YVtcInRleHQvcGxhaW5cIl0pICYmIHRhcmdldEVsICYmIChodG1sQ29udGVudCA9IHRhcmdldEVsLnZhbHVlIHx8IHRhcmdldEVsLm91dGVySFRNTCB8fCB0YXJnZXRFbC5pbm5lckhUTUwpICYmICh0ZXh0Q29udGVudCA9IHRhcmdldEVsLnZhbHVlIHx8IHRhcmdldEVsLnRleHRDb250ZW50IHx8IHRhcmdldEVsLmlubmVyVGV4dCkpIHtcbiAgICAgICAgZXZlbnQuY2xpcGJvYXJkRGF0YS5jbGVhckRhdGEoKTtcbiAgICAgICAgZXZlbnQuY2xpcGJvYXJkRGF0YS5zZXREYXRhKFwidGV4dC9wbGFpblwiLCB0ZXh0Q29udGVudCk7XG4gICAgICAgIGlmIChodG1sQ29udGVudCAhPT0gdGV4dENvbnRlbnQpIHtcbiAgICAgICAgICBldmVudC5jbGlwYm9hcmREYXRhLnNldERhdGEoXCJ0ZXh0L2h0bWxcIiwgaHRtbENvbnRlbnQpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKCFfY2xpcERhdGFbXCJ0ZXh0L3BsYWluXCJdICYmIGV2ZW50LnRhcmdldCAmJiAodGV4dENvbnRlbnQgPSBldmVudC50YXJnZXQuZ2V0QXR0cmlidXRlKFwiZGF0YS1jbGlwYm9hcmQtdGV4dFwiKSkpIHtcbiAgICAgICAgZXZlbnQuY2xpcGJvYXJkRGF0YS5jbGVhckRhdGEoKTtcbiAgICAgICAgZXZlbnQuY2xpcGJvYXJkRGF0YS5zZXREYXRhKFwidGV4dC9wbGFpblwiLCB0ZXh0Q29udGVudCk7XG4gICAgICB9XG4gICAgICBicmVhaztcblxuICAgICBjYXNlIFwiYWZ0ZXJjb3B5XCI6XG4gICAgICBfcXVldWVFbWl0Q2xpcGJvYXJkRXJyb3JzKGV2ZW50KTtcbiAgICAgIFplcm9DbGlwYm9hcmQuY2xlYXJEYXRhKCk7XG4gICAgICBpZiAoZWxlbWVudCAmJiBlbGVtZW50ICE9PSBfc2FmZUFjdGl2ZUVsZW1lbnQoKSAmJiBlbGVtZW50LmZvY3VzKSB7XG4gICAgICAgIGVsZW1lbnQuZm9jdXMoKTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuXG4gICAgIGNhc2UgXCJfbW91c2VvdmVyXCI6XG4gICAgICBaZXJvQ2xpcGJvYXJkLmZvY3VzKGVsZW1lbnQpO1xuICAgICAgaWYgKF9nbG9iYWxDb25maWcuYnViYmxlRXZlbnRzID09PSB0cnVlICYmIHNvdXJjZUlzU3dmKSB7XG4gICAgICAgIGlmIChlbGVtZW50ICYmIGVsZW1lbnQgIT09IGV2ZW50LnJlbGF0ZWRUYXJnZXQgJiYgIV9jb250YWluZWRCeShldmVudC5yZWxhdGVkVGFyZ2V0LCBlbGVtZW50KSkge1xuICAgICAgICAgIF9maXJlTW91c2VFdmVudChfZXh0ZW5kKHt9LCBldmVudCwge1xuICAgICAgICAgICAgdHlwZTogXCJtb3VzZWVudGVyXCIsXG4gICAgICAgICAgICBidWJibGVzOiBmYWxzZSxcbiAgICAgICAgICAgIGNhbmNlbGFibGU6IGZhbHNlXG4gICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIF9maXJlTW91c2VFdmVudChfZXh0ZW5kKHt9LCBldmVudCwge1xuICAgICAgICAgIHR5cGU6IFwibW91c2VvdmVyXCJcbiAgICAgICAgfSkpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG5cbiAgICAgY2FzZSBcIl9tb3VzZW91dFwiOlxuICAgICAgWmVyb0NsaXBib2FyZC5ibHVyKCk7XG4gICAgICBpZiAoX2dsb2JhbENvbmZpZy5idWJibGVFdmVudHMgPT09IHRydWUgJiYgc291cmNlSXNTd2YpIHtcbiAgICAgICAgaWYgKGVsZW1lbnQgJiYgZWxlbWVudCAhPT0gZXZlbnQucmVsYXRlZFRhcmdldCAmJiAhX2NvbnRhaW5lZEJ5KGV2ZW50LnJlbGF0ZWRUYXJnZXQsIGVsZW1lbnQpKSB7XG4gICAgICAgICAgX2ZpcmVNb3VzZUV2ZW50KF9leHRlbmQoe30sIGV2ZW50LCB7XG4gICAgICAgICAgICB0eXBlOiBcIm1vdXNlbGVhdmVcIixcbiAgICAgICAgICAgIGJ1YmJsZXM6IGZhbHNlLFxuICAgICAgICAgICAgY2FuY2VsYWJsZTogZmFsc2VcbiAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgX2ZpcmVNb3VzZUV2ZW50KF9leHRlbmQoe30sIGV2ZW50LCB7XG4gICAgICAgICAgdHlwZTogXCJtb3VzZW91dFwiXG4gICAgICAgIH0pKTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuXG4gICAgIGNhc2UgXCJfbW91c2Vkb3duXCI6XG4gICAgICBfYWRkQ2xhc3MoZWxlbWVudCwgX2dsb2JhbENvbmZpZy5hY3RpdmVDbGFzcyk7XG4gICAgICBpZiAoX2dsb2JhbENvbmZpZy5idWJibGVFdmVudHMgPT09IHRydWUgJiYgc291cmNlSXNTd2YpIHtcbiAgICAgICAgX2ZpcmVNb3VzZUV2ZW50KF9leHRlbmQoe30sIGV2ZW50LCB7XG4gICAgICAgICAgdHlwZTogZXZlbnQudHlwZS5zbGljZSgxKVxuICAgICAgICB9KSk7XG4gICAgICB9XG4gICAgICBicmVhaztcblxuICAgICBjYXNlIFwiX21vdXNldXBcIjpcbiAgICAgIF9yZW1vdmVDbGFzcyhlbGVtZW50LCBfZ2xvYmFsQ29uZmlnLmFjdGl2ZUNsYXNzKTtcbiAgICAgIGlmIChfZ2xvYmFsQ29uZmlnLmJ1YmJsZUV2ZW50cyA9PT0gdHJ1ZSAmJiBzb3VyY2VJc1N3Zikge1xuICAgICAgICBfZmlyZU1vdXNlRXZlbnQoX2V4dGVuZCh7fSwgZXZlbnQsIHtcbiAgICAgICAgICB0eXBlOiBldmVudC50eXBlLnNsaWNlKDEpXG4gICAgICAgIH0pKTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuXG4gICAgIGNhc2UgXCJfY2xpY2tcIjpcbiAgICAgIF9jb3B5VGFyZ2V0ID0gbnVsbDtcbiAgICAgIGlmIChfZ2xvYmFsQ29uZmlnLmJ1YmJsZUV2ZW50cyA9PT0gdHJ1ZSAmJiBzb3VyY2VJc1N3Zikge1xuICAgICAgICBfZmlyZU1vdXNlRXZlbnQoX2V4dGVuZCh7fSwgZXZlbnQsIHtcbiAgICAgICAgICB0eXBlOiBldmVudC50eXBlLnNsaWNlKDEpXG4gICAgICAgIH0pKTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuXG4gICAgIGNhc2UgXCJfbW91c2Vtb3ZlXCI6XG4gICAgICBpZiAoX2dsb2JhbENvbmZpZy5idWJibGVFdmVudHMgPT09IHRydWUgJiYgc291cmNlSXNTd2YpIHtcbiAgICAgICAgX2ZpcmVNb3VzZUV2ZW50KF9leHRlbmQoe30sIGV2ZW50LCB7XG4gICAgICAgICAgdHlwZTogZXZlbnQudHlwZS5zbGljZSgxKVxuICAgICAgICB9KSk7XG4gICAgICB9XG4gICAgICBicmVhaztcbiAgICB9XG4gICAgaWYgKC9eXyg/OmNsaWNrfG1vdXNlKD86b3ZlcnxvdXR8ZG93bnx1cHxtb3ZlKSkkLy50ZXN0KGV2ZW50LnR5cGUpKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH07XG4gIC8qKlxuICogQ2hlY2sgYW4gXCJhZnRlcmNvcHlcIiBldmVudCBmb3IgY2xpcGJvYXJkIGVycm9ycyBhbmQgZW1pdCBhIGNvcnJlc3BvbmRpbmcgXCJlcnJvclwiIGV2ZW50LlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX3F1ZXVlRW1pdENsaXBib2FyZEVycm9ycyA9IGZ1bmN0aW9uKGFmdGVyY29weUV2ZW50KSB7XG4gICAgaWYgKGFmdGVyY29weUV2ZW50LmVycm9ycyAmJiBhZnRlcmNvcHlFdmVudC5lcnJvcnMubGVuZ3RoID4gMCkge1xuICAgICAgdmFyIGVycm9yRXZlbnQgPSBfZGVlcENvcHkoYWZ0ZXJjb3B5RXZlbnQpO1xuICAgICAgX2V4dGVuZChlcnJvckV2ZW50LCB7XG4gICAgICAgIHR5cGU6IFwiZXJyb3JcIixcbiAgICAgICAgbmFtZTogXCJjbGlwYm9hcmQtZXJyb3JcIlxuICAgICAgfSk7XG4gICAgICBkZWxldGUgZXJyb3JFdmVudC5zdWNjZXNzO1xuICAgICAgX3NldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgIFplcm9DbGlwYm9hcmQuZW1pdChlcnJvckV2ZW50KTtcbiAgICAgIH0sIDApO1xuICAgIH1cbiAgfTtcbiAgLyoqXG4gKiBEaXNwYXRjaCBhIHN5bnRoZXRpYyBNb3VzZUV2ZW50LlxuICpcbiAqIEByZXR1cm5zIGB1bmRlZmluZWRgXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZmlyZU1vdXNlRXZlbnQgPSBmdW5jdGlvbihldmVudCkge1xuICAgIGlmICghKGV2ZW50ICYmIHR5cGVvZiBldmVudC50eXBlID09PSBcInN0cmluZ1wiICYmIGV2ZW50KSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgZSwgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0IHx8IG51bGwsIGRvYyA9IHRhcmdldCAmJiB0YXJnZXQub3duZXJEb2N1bWVudCB8fCBfZG9jdW1lbnQsIGRlZmF1bHRzID0ge1xuICAgICAgdmlldzogZG9jLmRlZmF1bHRWaWV3IHx8IF93aW5kb3csXG4gICAgICBjYW5CdWJibGU6IHRydWUsXG4gICAgICBjYW5jZWxhYmxlOiB0cnVlLFxuICAgICAgZGV0YWlsOiBldmVudC50eXBlID09PSBcImNsaWNrXCIgPyAxIDogMCxcbiAgICAgIGJ1dHRvbjogdHlwZW9mIGV2ZW50LndoaWNoID09PSBcIm51bWJlclwiID8gZXZlbnQud2hpY2ggLSAxIDogdHlwZW9mIGV2ZW50LmJ1dHRvbiA9PT0gXCJudW1iZXJcIiA/IGV2ZW50LmJ1dHRvbiA6IGRvYy5jcmVhdGVFdmVudCA/IDAgOiAxXG4gICAgfSwgYXJncyA9IF9leHRlbmQoZGVmYXVsdHMsIGV2ZW50KTtcbiAgICBpZiAoIXRhcmdldCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoZG9jLmNyZWF0ZUV2ZW50ICYmIHRhcmdldC5kaXNwYXRjaEV2ZW50KSB7XG4gICAgICBhcmdzID0gWyBhcmdzLnR5cGUsIGFyZ3MuY2FuQnViYmxlLCBhcmdzLmNhbmNlbGFibGUsIGFyZ3MudmlldywgYXJncy5kZXRhaWwsIGFyZ3Muc2NyZWVuWCwgYXJncy5zY3JlZW5ZLCBhcmdzLmNsaWVudFgsIGFyZ3MuY2xpZW50WSwgYXJncy5jdHJsS2V5LCBhcmdzLmFsdEtleSwgYXJncy5zaGlmdEtleSwgYXJncy5tZXRhS2V5LCBhcmdzLmJ1dHRvbiwgYXJncy5yZWxhdGVkVGFyZ2V0IF07XG4gICAgICBlID0gZG9jLmNyZWF0ZUV2ZW50KFwiTW91c2VFdmVudHNcIik7XG4gICAgICBpZiAoZS5pbml0TW91c2VFdmVudCkge1xuICAgICAgICBlLmluaXRNb3VzZUV2ZW50LmFwcGx5KGUsIGFyZ3MpO1xuICAgICAgICBlLl9zb3VyY2UgPSBcImpzXCI7XG4gICAgICAgIHRhcmdldC5kaXNwYXRjaEV2ZW50KGUpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbiAgLyoqXG4gKiBDb250aW51b3VzbHkgcG9sbCB0aGUgRE9NIHVudGlsIGVpdGhlcjpcbiAqICAoYSkgdGhlIGZhbGxiYWNrIGNvbnRlbnQgYmVjb21lcyB2aXNpYmxlLCBvclxuICogIChiKSB3ZSByZWNlaXZlIGFuIGV2ZW50IGZyb20gU1dGIChoYW5kbGVkIGVsc2V3aGVyZSlcbiAqXG4gKiBJTVBPUlRBTlQ6XG4gKiBUaGlzIGlzIE5PVCBhIG5lY2Vzc2FyeSBjaGVjayBidXQgaXQgY2FuIHJlc3VsdCBpbiBzaWduaWZpY2FudGx5IGZhc3RlclxuICogZGV0ZWN0aW9uIG9mIGJhZCBgc3dmUGF0aGAgY29uZmlndXJhdGlvbiBhbmQvb3IgbmV0d29yay9zZXJ2ZXIgaXNzdWVzIFtpblxuICogc3VwcG9ydGVkIGJyb3dzZXJzXSB0aGFuIHdhaXRpbmcgZm9yIHRoZSBlbnRpcmUgYGZsYXNoTG9hZFRpbWVvdXRgIGR1cmF0aW9uXG4gKiB0byBlbGFwc2UgYmVmb3JlIGRldGVjdGluZyB0aGF0IHRoZSBTV0YgY2Fubm90IGJlIGxvYWRlZC4gVGhlIGRldGVjdGlvblxuICogZHVyYXRpb24gY2FuIGJlIGFueXdoZXJlIGZyb20gMTAtMzAgdGltZXMgZmFzdGVyIFtpbiBzdXBwb3J0ZWQgYnJvd3NlcnNdIGJ5XG4gKiB1c2luZyB0aGlzIGFwcHJvYWNoLlxuICpcbiAqIEByZXR1cm5zIGB1bmRlZmluZWRgXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfd2F0Y2hGb3JTd2ZGYWxsYmFja0NvbnRlbnQgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgbWF4V2FpdCA9IF9nbG9iYWxDb25maWcuZmxhc2hMb2FkVGltZW91dDtcbiAgICBpZiAodHlwZW9mIG1heFdhaXQgPT09IFwibnVtYmVyXCIgJiYgbWF4V2FpdCA+PSAwKSB7XG4gICAgICB2YXIgcG9sbFdhaXQgPSBNYXRoLm1pbigxZTMsIG1heFdhaXQgLyAxMCk7XG4gICAgICB2YXIgZmFsbGJhY2tDb250ZW50SWQgPSBfZ2xvYmFsQ29uZmlnLnN3Zk9iamVjdElkICsgXCJfZmFsbGJhY2tDb250ZW50XCI7XG4gICAgICBfc3dmRmFsbGJhY2tDaGVja0ludGVydmFsID0gX3NldEludGVydmFsKGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgZWwgPSBfZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZmFsbGJhY2tDb250ZW50SWQpO1xuICAgICAgICBpZiAoX2lzRWxlbWVudFZpc2libGUoZWwpKSB7XG4gICAgICAgICAgX2NsZWFyVGltZW91dHNBbmRQb2xsaW5nKCk7XG4gICAgICAgICAgX2ZsYXNoU3RhdGUuZGVhY3RpdmF0ZWQgPSBudWxsO1xuICAgICAgICAgIFplcm9DbGlwYm9hcmQuZW1pdCh7XG4gICAgICAgICAgICB0eXBlOiBcImVycm9yXCIsXG4gICAgICAgICAgICBuYW1lOiBcInN3Zi1ub3QtZm91bmRcIlxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9LCBwb2xsV2FpdCk7XG4gICAgfVxuICB9O1xuICAvKipcbiAqIENyZWF0ZSB0aGUgSFRNTCBicmlkZ2UgZWxlbWVudCB0byBlbWJlZCB0aGUgRmxhc2ggb2JqZWN0IGludG8uXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY3JlYXRlSHRtbEJyaWRnZSA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBjb250YWluZXIgPSBfZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICBjb250YWluZXIuaWQgPSBfZ2xvYmFsQ29uZmlnLmNvbnRhaW5lcklkO1xuICAgIGNvbnRhaW5lci5jbGFzc05hbWUgPSBfZ2xvYmFsQ29uZmlnLmNvbnRhaW5lckNsYXNzO1xuICAgIGNvbnRhaW5lci5zdHlsZS5wb3NpdGlvbiA9IFwiYWJzb2x1dGVcIjtcbiAgICBjb250YWluZXIuc3R5bGUubGVmdCA9IFwiMHB4XCI7XG4gICAgY29udGFpbmVyLnN0eWxlLnRvcCA9IFwiLTk5OTlweFwiO1xuICAgIGNvbnRhaW5lci5zdHlsZS53aWR0aCA9IFwiMXB4XCI7XG4gICAgY29udGFpbmVyLnN0eWxlLmhlaWdodCA9IFwiMXB4XCI7XG4gICAgY29udGFpbmVyLnN0eWxlLnpJbmRleCA9IFwiXCIgKyBfZ2V0U2FmZVpJbmRleChfZ2xvYmFsQ29uZmlnLnpJbmRleCk7XG4gICAgcmV0dXJuIGNvbnRhaW5lcjtcbiAgfTtcbiAgLyoqXG4gKiBHZXQgdGhlIEhUTUwgZWxlbWVudCBjb250YWluZXIgdGhhdCB3cmFwcyB0aGUgRmxhc2ggYnJpZGdlIG9iamVjdC9lbGVtZW50LlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2dldEh0bWxCcmlkZ2UgPSBmdW5jdGlvbihmbGFzaEJyaWRnZSkge1xuICAgIHZhciBodG1sQnJpZGdlID0gZmxhc2hCcmlkZ2UgJiYgZmxhc2hCcmlkZ2UucGFyZW50Tm9kZTtcbiAgICB3aGlsZSAoaHRtbEJyaWRnZSAmJiBodG1sQnJpZGdlLm5vZGVOYW1lID09PSBcIk9CSkVDVFwiICYmIGh0bWxCcmlkZ2UucGFyZW50Tm9kZSkge1xuICAgICAgaHRtbEJyaWRnZSA9IGh0bWxCcmlkZ2UucGFyZW50Tm9kZTtcbiAgICB9XG4gICAgcmV0dXJuIGh0bWxCcmlkZ2UgfHwgbnVsbDtcbiAgfTtcbiAgLyoqXG4gKiBDcmVhdGUgdGhlIFNXRiBvYmplY3QuXG4gKlxuICogQHJldHVybnMgVGhlIFNXRiBvYmplY3QgcmVmZXJlbmNlLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2VtYmVkU3dmID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGxlbiwgZmxhc2hCcmlkZ2UgPSBfZmxhc2hTdGF0ZS5icmlkZ2UsIGNvbnRhaW5lciA9IF9nZXRIdG1sQnJpZGdlKGZsYXNoQnJpZGdlKTtcbiAgICBpZiAoIWZsYXNoQnJpZGdlKSB7XG4gICAgICB2YXIgYWxsb3dTY3JpcHRBY2Nlc3MgPSBfZGV0ZXJtaW5lU2NyaXB0QWNjZXNzKF93aW5kb3cubG9jYXRpb24uaG9zdCwgX2dsb2JhbENvbmZpZyk7XG4gICAgICB2YXIgYWxsb3dOZXR3b3JraW5nID0gYWxsb3dTY3JpcHRBY2Nlc3MgPT09IFwibmV2ZXJcIiA/IFwibm9uZVwiIDogXCJhbGxcIjtcbiAgICAgIHZhciBmbGFzaHZhcnMgPSBfdmFycyhfZXh0ZW5kKHtcbiAgICAgICAganNWZXJzaW9uOiBaZXJvQ2xpcGJvYXJkLnZlcnNpb25cbiAgICAgIH0sIF9nbG9iYWxDb25maWcpKTtcbiAgICAgIHZhciBzd2ZVcmwgPSBfZ2xvYmFsQ29uZmlnLnN3ZlBhdGggKyBfY2FjaGVCdXN0KF9nbG9iYWxDb25maWcuc3dmUGF0aCwgX2dsb2JhbENvbmZpZyk7XG4gICAgICBjb250YWluZXIgPSBfY3JlYXRlSHRtbEJyaWRnZSgpO1xuICAgICAgdmFyIGRpdlRvQmVSZXBsYWNlZCA9IF9kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGRpdlRvQmVSZXBsYWNlZCk7XG4gICAgICBfZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChjb250YWluZXIpO1xuICAgICAgdmFyIHRtcERpdiA9IF9kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgdmFyIHVzaW5nQWN0aXZlWCA9IF9mbGFzaFN0YXRlLnBsdWdpblR5cGUgPT09IFwiYWN0aXZleFwiO1xuICAgICAgdG1wRGl2LmlubmVySFRNTCA9ICc8b2JqZWN0IGlkPVwiJyArIF9nbG9iYWxDb25maWcuc3dmT2JqZWN0SWQgKyAnXCIgbmFtZT1cIicgKyBfZ2xvYmFsQ29uZmlnLnN3Zk9iamVjdElkICsgJ1wiICcgKyAnd2lkdGg9XCIxMDAlXCIgaGVpZ2h0PVwiMTAwJVwiICcgKyAodXNpbmdBY3RpdmVYID8gJ2NsYXNzaWQ9XCJjbHNpZDpkMjdjZGI2ZS1hZTZkLTExY2YtOTZiOC00NDQ1NTM1NDAwMDBcIicgOiAndHlwZT1cImFwcGxpY2F0aW9uL3gtc2hvY2t3YXZlLWZsYXNoXCIgZGF0YT1cIicgKyBzd2ZVcmwgKyAnXCInKSArIFwiPlwiICsgKHVzaW5nQWN0aXZlWCA/ICc8cGFyYW0gbmFtZT1cIm1vdmllXCIgdmFsdWU9XCInICsgc3dmVXJsICsgJ1wiLz4nIDogXCJcIikgKyAnPHBhcmFtIG5hbWU9XCJhbGxvd1NjcmlwdEFjY2Vzc1wiIHZhbHVlPVwiJyArIGFsbG93U2NyaXB0QWNjZXNzICsgJ1wiLz4nICsgJzxwYXJhbSBuYW1lPVwiYWxsb3dOZXR3b3JraW5nXCIgdmFsdWU9XCInICsgYWxsb3dOZXR3b3JraW5nICsgJ1wiLz4nICsgJzxwYXJhbSBuYW1lPVwibWVudVwiIHZhbHVlPVwiZmFsc2VcIi8+JyArICc8cGFyYW0gbmFtZT1cIndtb2RlXCIgdmFsdWU9XCJ0cmFuc3BhcmVudFwiLz4nICsgJzxwYXJhbSBuYW1lPVwiZmxhc2h2YXJzXCIgdmFsdWU9XCInICsgZmxhc2h2YXJzICsgJ1wiLz4nICsgJzxkaXYgaWQ9XCInICsgX2dsb2JhbENvbmZpZy5zd2ZPYmplY3RJZCArICdfZmFsbGJhY2tDb250ZW50XCI+Jm5ic3A7PC9kaXY+JyArIFwiPC9vYmplY3Q+XCI7XG4gICAgICBmbGFzaEJyaWRnZSA9IHRtcERpdi5maXJzdENoaWxkO1xuICAgICAgdG1wRGl2ID0gbnVsbDtcbiAgICAgIF91bndyYXAoZmxhc2hCcmlkZ2UpLlplcm9DbGlwYm9hcmQgPSBaZXJvQ2xpcGJvYXJkO1xuICAgICAgY29udGFpbmVyLnJlcGxhY2VDaGlsZChmbGFzaEJyaWRnZSwgZGl2VG9CZVJlcGxhY2VkKTtcbiAgICAgIF93YXRjaEZvclN3ZkZhbGxiYWNrQ29udGVudCgpO1xuICAgIH1cbiAgICBpZiAoIWZsYXNoQnJpZGdlKSB7XG4gICAgICBmbGFzaEJyaWRnZSA9IF9kb2N1bWVudFtfZ2xvYmFsQ29uZmlnLnN3Zk9iamVjdElkXTtcbiAgICAgIGlmIChmbGFzaEJyaWRnZSAmJiAobGVuID0gZmxhc2hCcmlkZ2UubGVuZ3RoKSkge1xuICAgICAgICBmbGFzaEJyaWRnZSA9IGZsYXNoQnJpZGdlW2xlbiAtIDFdO1xuICAgICAgfVxuICAgICAgaWYgKCFmbGFzaEJyaWRnZSAmJiBjb250YWluZXIpIHtcbiAgICAgICAgZmxhc2hCcmlkZ2UgPSBjb250YWluZXIuZmlyc3RDaGlsZDtcbiAgICAgIH1cbiAgICB9XG4gICAgX2ZsYXNoU3RhdGUuYnJpZGdlID0gZmxhc2hCcmlkZ2UgfHwgbnVsbDtcbiAgICByZXR1cm4gZmxhc2hCcmlkZ2U7XG4gIH07XG4gIC8qKlxuICogRGVzdHJveSB0aGUgU1dGIG9iamVjdC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF91bmVtYmVkU3dmID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGZsYXNoQnJpZGdlID0gX2ZsYXNoU3RhdGUuYnJpZGdlO1xuICAgIGlmIChmbGFzaEJyaWRnZSkge1xuICAgICAgdmFyIGh0bWxCcmlkZ2UgPSBfZ2V0SHRtbEJyaWRnZShmbGFzaEJyaWRnZSk7XG4gICAgICBpZiAoaHRtbEJyaWRnZSkge1xuICAgICAgICBpZiAoX2ZsYXNoU3RhdGUucGx1Z2luVHlwZSA9PT0gXCJhY3RpdmV4XCIgJiYgXCJyZWFkeVN0YXRlXCIgaW4gZmxhc2hCcmlkZ2UpIHtcbiAgICAgICAgICBmbGFzaEJyaWRnZS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgICAgICAgKGZ1bmN0aW9uIHJlbW92ZVN3ZkZyb21JRSgpIHtcbiAgICAgICAgICAgIGlmIChmbGFzaEJyaWRnZS5yZWFkeVN0YXRlID09PSA0KSB7XG4gICAgICAgICAgICAgIGZvciAodmFyIHByb3AgaW4gZmxhc2hCcmlkZ2UpIHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGZsYXNoQnJpZGdlW3Byb3BdID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgICAgIGZsYXNoQnJpZGdlW3Byb3BdID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgaWYgKGZsYXNoQnJpZGdlLnBhcmVudE5vZGUpIHtcbiAgICAgICAgICAgICAgICBmbGFzaEJyaWRnZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGZsYXNoQnJpZGdlKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBpZiAoaHRtbEJyaWRnZS5wYXJlbnROb2RlKSB7XG4gICAgICAgICAgICAgICAgaHRtbEJyaWRnZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGh0bWxCcmlkZ2UpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBfc2V0VGltZW91dChyZW1vdmVTd2ZGcm9tSUUsIDEwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChmbGFzaEJyaWRnZS5wYXJlbnROb2RlKSB7XG4gICAgICAgICAgICBmbGFzaEJyaWRnZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGZsYXNoQnJpZGdlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGh0bWxCcmlkZ2UucGFyZW50Tm9kZSkge1xuICAgICAgICAgICAgaHRtbEJyaWRnZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGh0bWxCcmlkZ2UpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgX2NsZWFyVGltZW91dHNBbmRQb2xsaW5nKCk7XG4gICAgICBfZmxhc2hTdGF0ZS5yZWFkeSA9IG51bGw7XG4gICAgICBfZmxhc2hTdGF0ZS5icmlkZ2UgPSBudWxsO1xuICAgICAgX2ZsYXNoU3RhdGUuZGVhY3RpdmF0ZWQgPSBudWxsO1xuICAgICAgX3pjU3dmVmVyc2lvbiA9IHVuZGVmaW5lZDtcbiAgICB9XG4gIH07XG4gIC8qKlxuICogTWFwIHRoZSBkYXRhIGZvcm1hdCBuYW1lcyBvZiB0aGUgXCJjbGlwRGF0YVwiIHRvIEZsYXNoLWZyaWVuZGx5IG5hbWVzLlxuICpcbiAqIEByZXR1cm5zIEEgbmV3IHRyYW5zZm9ybWVkIG9iamVjdC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9tYXBDbGlwRGF0YVRvRmxhc2ggPSBmdW5jdGlvbihjbGlwRGF0YSkge1xuICAgIHZhciBuZXdDbGlwRGF0YSA9IHt9LCBmb3JtYXRNYXAgPSB7fTtcbiAgICBpZiAoISh0eXBlb2YgY2xpcERhdGEgPT09IFwib2JqZWN0XCIgJiYgY2xpcERhdGEpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGZvciAodmFyIGRhdGFGb3JtYXQgaW4gY2xpcERhdGEpIHtcbiAgICAgIGlmIChkYXRhRm9ybWF0ICYmIF9oYXNPd24uY2FsbChjbGlwRGF0YSwgZGF0YUZvcm1hdCkgJiYgdHlwZW9mIGNsaXBEYXRhW2RhdGFGb3JtYXRdID09PSBcInN0cmluZ1wiICYmIGNsaXBEYXRhW2RhdGFGb3JtYXRdKSB7XG4gICAgICAgIHN3aXRjaCAoZGF0YUZvcm1hdC50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICBjYXNlIFwidGV4dC9wbGFpblwiOlxuICAgICAgICAgY2FzZSBcInRleHRcIjpcbiAgICAgICAgIGNhc2UgXCJhaXI6dGV4dFwiOlxuICAgICAgICAgY2FzZSBcImZsYXNoOnRleHRcIjpcbiAgICAgICAgICBuZXdDbGlwRGF0YS50ZXh0ID0gY2xpcERhdGFbZGF0YUZvcm1hdF07XG4gICAgICAgICAgZm9ybWF0TWFwLnRleHQgPSBkYXRhRm9ybWF0O1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICBjYXNlIFwidGV4dC9odG1sXCI6XG4gICAgICAgICBjYXNlIFwiaHRtbFwiOlxuICAgICAgICAgY2FzZSBcImFpcjpodG1sXCI6XG4gICAgICAgICBjYXNlIFwiZmxhc2g6aHRtbFwiOlxuICAgICAgICAgIG5ld0NsaXBEYXRhLmh0bWwgPSBjbGlwRGF0YVtkYXRhRm9ybWF0XTtcbiAgICAgICAgICBmb3JtYXRNYXAuaHRtbCA9IGRhdGFGb3JtYXQ7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgIGNhc2UgXCJhcHBsaWNhdGlvbi9ydGZcIjpcbiAgICAgICAgIGNhc2UgXCJ0ZXh0L3J0ZlwiOlxuICAgICAgICAgY2FzZSBcInJ0ZlwiOlxuICAgICAgICAgY2FzZSBcInJpY2h0ZXh0XCI6XG4gICAgICAgICBjYXNlIFwiYWlyOnJ0ZlwiOlxuICAgICAgICAgY2FzZSBcImZsYXNoOnJ0ZlwiOlxuICAgICAgICAgIG5ld0NsaXBEYXRhLnJ0ZiA9IGNsaXBEYXRhW2RhdGFGb3JtYXRdO1xuICAgICAgICAgIGZvcm1hdE1hcC5ydGYgPSBkYXRhRm9ybWF0O1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICBkYXRhOiBuZXdDbGlwRGF0YSxcbiAgICAgIGZvcm1hdE1hcDogZm9ybWF0TWFwXG4gICAgfTtcbiAgfTtcbiAgLyoqXG4gKiBNYXAgdGhlIGRhdGEgZm9ybWF0IG5hbWVzIGZyb20gRmxhc2gtZnJpZW5kbHkgbmFtZXMgYmFjayB0byB0aGVpciBvcmlnaW5hbCBcImNsaXBEYXRhXCIgbmFtZXMgKHZpYSBhIGZvcm1hdCBtYXBwaW5nKS5cbiAqXG4gKiBAcmV0dXJucyBBIG5ldyB0cmFuc2Zvcm1lZCBvYmplY3QuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfbWFwQ2xpcFJlc3VsdHNGcm9tRmxhc2ggPSBmdW5jdGlvbihjbGlwUmVzdWx0cywgZm9ybWF0TWFwKSB7XG4gICAgaWYgKCEodHlwZW9mIGNsaXBSZXN1bHRzID09PSBcIm9iamVjdFwiICYmIGNsaXBSZXN1bHRzICYmIHR5cGVvZiBmb3JtYXRNYXAgPT09IFwib2JqZWN0XCIgJiYgZm9ybWF0TWFwKSkge1xuICAgICAgcmV0dXJuIGNsaXBSZXN1bHRzO1xuICAgIH1cbiAgICB2YXIgbmV3UmVzdWx0cyA9IHt9O1xuICAgIGZvciAodmFyIHByb3AgaW4gY2xpcFJlc3VsdHMpIHtcbiAgICAgIGlmIChfaGFzT3duLmNhbGwoY2xpcFJlc3VsdHMsIHByb3ApKSB7XG4gICAgICAgIGlmIChwcm9wID09PSBcImVycm9yc1wiKSB7XG4gICAgICAgICAgbmV3UmVzdWx0c1twcm9wXSA9IGNsaXBSZXN1bHRzW3Byb3BdID8gY2xpcFJlc3VsdHNbcHJvcF0uc2xpY2UoKSA6IFtdO1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBuZXdSZXN1bHRzW3Byb3BdLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICBuZXdSZXN1bHRzW3Byb3BdW2ldLmZvcm1hdCA9IGZvcm1hdE1hcFtuZXdSZXN1bHRzW3Byb3BdW2ldLmZvcm1hdF07XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHByb3AgIT09IFwic3VjY2Vzc1wiICYmIHByb3AgIT09IFwiZGF0YVwiKSB7XG4gICAgICAgICAgbmV3UmVzdWx0c1twcm9wXSA9IGNsaXBSZXN1bHRzW3Byb3BdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG5ld1Jlc3VsdHNbcHJvcF0gPSB7fTtcbiAgICAgICAgICB2YXIgdG1wSGFzaCA9IGNsaXBSZXN1bHRzW3Byb3BdO1xuICAgICAgICAgIGZvciAodmFyIGRhdGFGb3JtYXQgaW4gdG1wSGFzaCkge1xuICAgICAgICAgICAgaWYgKGRhdGFGb3JtYXQgJiYgX2hhc093bi5jYWxsKHRtcEhhc2gsIGRhdGFGb3JtYXQpICYmIF9oYXNPd24uY2FsbChmb3JtYXRNYXAsIGRhdGFGb3JtYXQpKSB7XG4gICAgICAgICAgICAgIG5ld1Jlc3VsdHNbcHJvcF1bZm9ybWF0TWFwW2RhdGFGb3JtYXRdXSA9IHRtcEhhc2hbZGF0YUZvcm1hdF07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBuZXdSZXN1bHRzO1xuICB9O1xuICAvKipcbiAqIFdpbGwgbG9vayBhdCBhIHBhdGgsIGFuZCB3aWxsIGNyZWF0ZSBhIFwiP25vQ2FjaGU9e3RpbWV9XCIgb3IgXCImbm9DYWNoZT17dGltZX1cIlxuICogcXVlcnkgcGFyYW0gc3RyaW5nIHRvIHJldHVybi4gRG9lcyBOT1QgYXBwZW5kIHRoYXQgc3RyaW5nIHRvIHRoZSBvcmlnaW5hbCBwYXRoLlxuICogVGhpcyBpcyB1c2VmdWwgYmVjYXVzZSBFeHRlcm5hbEludGVyZmFjZSBvZnRlbiBicmVha3Mgd2hlbiBhIEZsYXNoIFNXRiBpcyBjYWNoZWQuXG4gKlxuICogQHJldHVybnMgVGhlIGBub0NhY2hlYCBxdWVyeSBwYXJhbSB3aXRoIG5lY2Vzc2FyeSBcIj9cIi9cIiZcIiBwcmVmaXguXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY2FjaGVCdXN0ID0gZnVuY3Rpb24ocGF0aCwgb3B0aW9ucykge1xuICAgIHZhciBjYWNoZUJ1c3QgPSBvcHRpb25zID09IG51bGwgfHwgb3B0aW9ucyAmJiBvcHRpb25zLmNhY2hlQnVzdCA9PT0gdHJ1ZTtcbiAgICBpZiAoY2FjaGVCdXN0KSB7XG4gICAgICByZXR1cm4gKHBhdGguaW5kZXhPZihcIj9cIikgPT09IC0xID8gXCI/XCIgOiBcIiZcIikgKyBcIm5vQ2FjaGU9XCIgKyBfbm93KCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBcIlwiO1xuICAgIH1cbiAgfTtcbiAgLyoqXG4gKiBDcmVhdGVzIGEgcXVlcnkgc3RyaW5nIGZvciB0aGUgRmxhc2hWYXJzIHBhcmFtLlxuICogRG9lcyBOT1QgaW5jbHVkZSB0aGUgY2FjaGUtYnVzdGluZyBxdWVyeSBwYXJhbS5cbiAqXG4gKiBAcmV0dXJucyBGbGFzaFZhcnMgcXVlcnkgc3RyaW5nXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfdmFycyA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICB2YXIgaSwgbGVuLCBkb21haW4sIGRvbWFpbnMsIHN0ciA9IFwiXCIsIHRydXN0ZWRPcmlnaW5zRXhwYW5kZWQgPSBbXTtcbiAgICBpZiAob3B0aW9ucy50cnVzdGVkRG9tYWlucykge1xuICAgICAgaWYgKHR5cGVvZiBvcHRpb25zLnRydXN0ZWREb21haW5zID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIGRvbWFpbnMgPSBbIG9wdGlvbnMudHJ1c3RlZERvbWFpbnMgXTtcbiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIG9wdGlvbnMudHJ1c3RlZERvbWFpbnMgPT09IFwib2JqZWN0XCIgJiYgXCJsZW5ndGhcIiBpbiBvcHRpb25zLnRydXN0ZWREb21haW5zKSB7XG4gICAgICAgIGRvbWFpbnMgPSBvcHRpb25zLnRydXN0ZWREb21haW5zO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoZG9tYWlucyAmJiBkb21haW5zLmxlbmd0aCkge1xuICAgICAgZm9yIChpID0gMCwgbGVuID0gZG9tYWlucy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBpZiAoX2hhc093bi5jYWxsKGRvbWFpbnMsIGkpICYmIGRvbWFpbnNbaV0gJiYgdHlwZW9mIGRvbWFpbnNbaV0gPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICBkb21haW4gPSBfZXh0cmFjdERvbWFpbihkb21haW5zW2ldKTtcbiAgICAgICAgICBpZiAoIWRvbWFpbikge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChkb21haW4gPT09IFwiKlwiKSB7XG4gICAgICAgICAgICB0cnVzdGVkT3JpZ2luc0V4cGFuZGVkLmxlbmd0aCA9IDA7XG4gICAgICAgICAgICB0cnVzdGVkT3JpZ2luc0V4cGFuZGVkLnB1c2goZG9tYWluKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0cnVzdGVkT3JpZ2luc0V4cGFuZGVkLnB1c2guYXBwbHkodHJ1c3RlZE9yaWdpbnNFeHBhbmRlZCwgWyBkb21haW4sIFwiLy9cIiArIGRvbWFpbiwgX3dpbmRvdy5sb2NhdGlvbi5wcm90b2NvbCArIFwiLy9cIiArIGRvbWFpbiBdKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBpZiAodHJ1c3RlZE9yaWdpbnNFeHBhbmRlZC5sZW5ndGgpIHtcbiAgICAgIHN0ciArPSBcInRydXN0ZWRPcmlnaW5zPVwiICsgX2VuY29kZVVSSUNvbXBvbmVudCh0cnVzdGVkT3JpZ2luc0V4cGFuZGVkLmpvaW4oXCIsXCIpKTtcbiAgICB9XG4gICAgaWYgKG9wdGlvbnMuZm9yY2VFbmhhbmNlZENsaXBib2FyZCA9PT0gdHJ1ZSkge1xuICAgICAgc3RyICs9IChzdHIgPyBcIiZcIiA6IFwiXCIpICsgXCJmb3JjZUVuaGFuY2VkQ2xpcGJvYXJkPXRydWVcIjtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBvcHRpb25zLnN3Zk9iamVjdElkID09PSBcInN0cmluZ1wiICYmIG9wdGlvbnMuc3dmT2JqZWN0SWQpIHtcbiAgICAgIHN0ciArPSAoc3RyID8gXCImXCIgOiBcIlwiKSArIFwic3dmT2JqZWN0SWQ9XCIgKyBfZW5jb2RlVVJJQ29tcG9uZW50KG9wdGlvbnMuc3dmT2JqZWN0SWQpO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIG9wdGlvbnMuanNWZXJzaW9uID09PSBcInN0cmluZ1wiICYmIG9wdGlvbnMuanNWZXJzaW9uKSB7XG4gICAgICBzdHIgKz0gKHN0ciA/IFwiJlwiIDogXCJcIikgKyBcImpzVmVyc2lvbj1cIiArIF9lbmNvZGVVUklDb21wb25lbnQob3B0aW9ucy5qc1ZlcnNpb24pO1xuICAgIH1cbiAgICByZXR1cm4gc3RyO1xuICB9O1xuICAvKipcbiAqIEV4dHJhY3QgdGhlIGRvbWFpbiAoZS5nLiBcImdpdGh1Yi5jb21cIikgZnJvbSBhbiBvcmlnaW4gKGUuZy4gXCJodHRwczovL2dpdGh1Yi5jb21cIikgb3JcbiAqIFVSTCAoZS5nLiBcImh0dHBzOi8vZ2l0aHViLmNvbS96ZXJvY2xpcGJvYXJkL3plcm9jbGlwYm9hcmQvXCIpLlxuICpcbiAqIEByZXR1cm5zIHRoZSBkb21haW5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9leHRyYWN0RG9tYWluID0gZnVuY3Rpb24ob3JpZ2luT3JVcmwpIHtcbiAgICBpZiAob3JpZ2luT3JVcmwgPT0gbnVsbCB8fCBvcmlnaW5PclVybCA9PT0gXCJcIikge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIG9yaWdpbk9yVXJsID0gb3JpZ2luT3JVcmwucmVwbGFjZSgvXlxccyt8XFxzKyQvZywgXCJcIik7XG4gICAgaWYgKG9yaWdpbk9yVXJsID09PSBcIlwiKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgdmFyIHByb3RvY29sSW5kZXggPSBvcmlnaW5PclVybC5pbmRleE9mKFwiLy9cIik7XG4gICAgb3JpZ2luT3JVcmwgPSBwcm90b2NvbEluZGV4ID09PSAtMSA/IG9yaWdpbk9yVXJsIDogb3JpZ2luT3JVcmwuc2xpY2UocHJvdG9jb2xJbmRleCArIDIpO1xuICAgIHZhciBwYXRoSW5kZXggPSBvcmlnaW5PclVybC5pbmRleE9mKFwiL1wiKTtcbiAgICBvcmlnaW5PclVybCA9IHBhdGhJbmRleCA9PT0gLTEgPyBvcmlnaW5PclVybCA6IHByb3RvY29sSW5kZXggPT09IC0xIHx8IHBhdGhJbmRleCA9PT0gMCA/IG51bGwgOiBvcmlnaW5PclVybC5zbGljZSgwLCBwYXRoSW5kZXgpO1xuICAgIGlmIChvcmlnaW5PclVybCAmJiBvcmlnaW5PclVybC5zbGljZSgtNCkudG9Mb3dlckNhc2UoKSA9PT0gXCIuc3dmXCIpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICByZXR1cm4gb3JpZ2luT3JVcmwgfHwgbnVsbDtcbiAgfTtcbiAgLyoqXG4gKiBTZXQgYGFsbG93U2NyaXB0QWNjZXNzYCBiYXNlZCBvbiBgdHJ1c3RlZERvbWFpbnNgIGFuZCBgd2luZG93LmxvY2F0aW9uLmhvc3RgIHZzLiBgc3dmUGF0aGAuXG4gKlxuICogQHJldHVybnMgVGhlIGFwcHJvcHJpYXRlIHNjcmlwdCBhY2Nlc3MgbGV2ZWwuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZGV0ZXJtaW5lU2NyaXB0QWNjZXNzID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIF9leHRyYWN0QWxsRG9tYWlucyA9IGZ1bmN0aW9uKG9yaWdpbnMpIHtcbiAgICAgIHZhciBpLCBsZW4sIHRtcCwgcmVzdWx0c0FycmF5ID0gW107XG4gICAgICBpZiAodHlwZW9mIG9yaWdpbnMgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgb3JpZ2lucyA9IFsgb3JpZ2lucyBdO1xuICAgICAgfVxuICAgICAgaWYgKCEodHlwZW9mIG9yaWdpbnMgPT09IFwib2JqZWN0XCIgJiYgb3JpZ2lucyAmJiB0eXBlb2Ygb3JpZ2lucy5sZW5ndGggPT09IFwibnVtYmVyXCIpKSB7XG4gICAgICAgIHJldHVybiByZXN1bHRzQXJyYXk7XG4gICAgICB9XG4gICAgICBmb3IgKGkgPSAwLCBsZW4gPSBvcmlnaW5zLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGlmIChfaGFzT3duLmNhbGwob3JpZ2lucywgaSkgJiYgKHRtcCA9IF9leHRyYWN0RG9tYWluKG9yaWdpbnNbaV0pKSkge1xuICAgICAgICAgIGlmICh0bXAgPT09IFwiKlwiKSB7XG4gICAgICAgICAgICByZXN1bHRzQXJyYXkubGVuZ3RoID0gMDtcbiAgICAgICAgICAgIHJlc3VsdHNBcnJheS5wdXNoKFwiKlwiKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAocmVzdWx0c0FycmF5LmluZGV4T2YodG1wKSA9PT0gLTEpIHtcbiAgICAgICAgICAgIHJlc3VsdHNBcnJheS5wdXNoKHRtcCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0c0FycmF5O1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uKGN1cnJlbnREb21haW4sIGNvbmZpZ09wdGlvbnMpIHtcbiAgICAgIHZhciBzd2ZEb21haW4gPSBfZXh0cmFjdERvbWFpbihjb25maWdPcHRpb25zLnN3ZlBhdGgpO1xuICAgICAgaWYgKHN3ZkRvbWFpbiA9PT0gbnVsbCkge1xuICAgICAgICBzd2ZEb21haW4gPSBjdXJyZW50RG9tYWluO1xuICAgICAgfVxuICAgICAgdmFyIHRydXN0ZWREb21haW5zID0gX2V4dHJhY3RBbGxEb21haW5zKGNvbmZpZ09wdGlvbnMudHJ1c3RlZERvbWFpbnMpO1xuICAgICAgdmFyIGxlbiA9IHRydXN0ZWREb21haW5zLmxlbmd0aDtcbiAgICAgIGlmIChsZW4gPiAwKSB7XG4gICAgICAgIGlmIChsZW4gPT09IDEgJiYgdHJ1c3RlZERvbWFpbnNbMF0gPT09IFwiKlwiKSB7XG4gICAgICAgICAgcmV0dXJuIFwiYWx3YXlzXCI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRydXN0ZWREb21haW5zLmluZGV4T2YoY3VycmVudERvbWFpbikgIT09IC0xKSB7XG4gICAgICAgICAgaWYgKGxlbiA9PT0gMSAmJiBjdXJyZW50RG9tYWluID09PSBzd2ZEb21haW4pIHtcbiAgICAgICAgICAgIHJldHVybiBcInNhbWVEb21haW5cIjtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIFwiYWx3YXlzXCI7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBcIm5ldmVyXCI7XG4gICAgfTtcbiAgfSgpO1xuICAvKipcbiAqIEdldCB0aGUgY3VycmVudGx5IGFjdGl2ZS9mb2N1c2VkIERPTSBlbGVtZW50LlxuICpcbiAqIEByZXR1cm5zIHRoZSBjdXJyZW50bHkgYWN0aXZlL2ZvY3VzZWQgZWxlbWVudCwgb3IgYG51bGxgXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfc2FmZUFjdGl2ZUVsZW1lbnQgPSBmdW5jdGlvbigpIHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIF9kb2N1bWVudC5hY3RpdmVFbGVtZW50O1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9O1xuICAvKipcbiAqIEFkZCBhIGNsYXNzIHRvIGFuIGVsZW1lbnQsIGlmIGl0IGRvZXNuJ3QgYWxyZWFkeSBoYXZlIGl0LlxuICpcbiAqIEByZXR1cm5zIFRoZSBlbGVtZW50LCB3aXRoIGl0cyBuZXcgY2xhc3MgYWRkZWQuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfYWRkQ2xhc3MgPSBmdW5jdGlvbihlbGVtZW50LCB2YWx1ZSkge1xuICAgIHZhciBjLCBjbCwgY2xhc3NOYW1lLCBjbGFzc05hbWVzID0gW107XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIiAmJiB2YWx1ZSkge1xuICAgICAgY2xhc3NOYW1lcyA9IHZhbHVlLnNwbGl0KC9cXHMrLyk7XG4gICAgfVxuICAgIGlmIChlbGVtZW50ICYmIGVsZW1lbnQubm9kZVR5cGUgPT09IDEgJiYgY2xhc3NOYW1lcy5sZW5ndGggPiAwKSB7XG4gICAgICBpZiAoZWxlbWVudC5jbGFzc0xpc3QpIHtcbiAgICAgICAgZm9yIChjID0gMCwgY2wgPSBjbGFzc05hbWVzLmxlbmd0aDsgYyA8IGNsOyBjKyspIHtcbiAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lc1tjXSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoZWxlbWVudC5oYXNPd25Qcm9wZXJ0eShcImNsYXNzTmFtZVwiKSkge1xuICAgICAgICBjbGFzc05hbWUgPSBcIiBcIiArIGVsZW1lbnQuY2xhc3NOYW1lICsgXCIgXCI7XG4gICAgICAgIGZvciAoYyA9IDAsIGNsID0gY2xhc3NOYW1lcy5sZW5ndGg7IGMgPCBjbDsgYysrKSB7XG4gICAgICAgICAgaWYgKGNsYXNzTmFtZS5pbmRleE9mKFwiIFwiICsgY2xhc3NOYW1lc1tjXSArIFwiIFwiKSA9PT0gLTEpIHtcbiAgICAgICAgICAgIGNsYXNzTmFtZSArPSBjbGFzc05hbWVzW2NdICsgXCIgXCI7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsZW1lbnQuY2xhc3NOYW1lID0gY2xhc3NOYW1lLnJlcGxhY2UoL15cXHMrfFxccyskL2csIFwiXCIpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZWxlbWVudDtcbiAgfTtcbiAgLyoqXG4gKiBSZW1vdmUgYSBjbGFzcyBmcm9tIGFuIGVsZW1lbnQsIGlmIGl0IGhhcyBpdC5cbiAqXG4gKiBAcmV0dXJucyBUaGUgZWxlbWVudCwgd2l0aCBpdHMgY2xhc3MgcmVtb3ZlZC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9yZW1vdmVDbGFzcyA9IGZ1bmN0aW9uKGVsZW1lbnQsIHZhbHVlKSB7XG4gICAgdmFyIGMsIGNsLCBjbGFzc05hbWUsIGNsYXNzTmFtZXMgPSBbXTtcbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiICYmIHZhbHVlKSB7XG4gICAgICBjbGFzc05hbWVzID0gdmFsdWUuc3BsaXQoL1xccysvKTtcbiAgICB9XG4gICAgaWYgKGVsZW1lbnQgJiYgZWxlbWVudC5ub2RlVHlwZSA9PT0gMSAmJiBjbGFzc05hbWVzLmxlbmd0aCA+IDApIHtcbiAgICAgIGlmIChlbGVtZW50LmNsYXNzTGlzdCAmJiBlbGVtZW50LmNsYXNzTGlzdC5sZW5ndGggPiAwKSB7XG4gICAgICAgIGZvciAoYyA9IDAsIGNsID0gY2xhc3NOYW1lcy5sZW5ndGg7IGMgPCBjbDsgYysrKSB7XG4gICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGNsYXNzTmFtZXNbY10pO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGVsZW1lbnQuY2xhc3NOYW1lKSB7XG4gICAgICAgIGNsYXNzTmFtZSA9IChcIiBcIiArIGVsZW1lbnQuY2xhc3NOYW1lICsgXCIgXCIpLnJlcGxhY2UoL1tcXHJcXG5cXHRdL2csIFwiIFwiKTtcbiAgICAgICAgZm9yIChjID0gMCwgY2wgPSBjbGFzc05hbWVzLmxlbmd0aDsgYyA8IGNsOyBjKyspIHtcbiAgICAgICAgICBjbGFzc05hbWUgPSBjbGFzc05hbWUucmVwbGFjZShcIiBcIiArIGNsYXNzTmFtZXNbY10gKyBcIiBcIiwgXCIgXCIpO1xuICAgICAgICB9XG4gICAgICAgIGVsZW1lbnQuY2xhc3NOYW1lID0gY2xhc3NOYW1lLnJlcGxhY2UoL15cXHMrfFxccyskL2csIFwiXCIpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZWxlbWVudDtcbiAgfTtcbiAgLyoqXG4gKiBBdHRlbXB0IHRvIGludGVycHJldCB0aGUgZWxlbWVudCdzIENTUyBzdHlsaW5nLiBJZiBgcHJvcGAgaXMgYFwiY3Vyc29yXCJgLFxuICogdGhlbiB3ZSBhc3N1bWUgdGhhdCBpdCBzaG91bGQgYmUgYSBoYW5kIChcInBvaW50ZXJcIikgY3Vyc29yIGlmIHRoZSBlbGVtZW50XG4gKiBpcyBhbiBhbmNob3IgZWxlbWVudCAoXCJhXCIgdGFnKS5cbiAqXG4gKiBAcmV0dXJucyBUaGUgY29tcHV0ZWQgc3R5bGUgcHJvcGVydHkuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZ2V0U3R5bGUgPSBmdW5jdGlvbihlbCwgcHJvcCkge1xuICAgIHZhciB2YWx1ZSA9IF9nZXRDb21wdXRlZFN0eWxlKGVsLCBudWxsKS5nZXRQcm9wZXJ0eVZhbHVlKHByb3ApO1xuICAgIGlmIChwcm9wID09PSBcImN1cnNvclwiKSB7XG4gICAgICBpZiAoIXZhbHVlIHx8IHZhbHVlID09PSBcImF1dG9cIikge1xuICAgICAgICBpZiAoZWwubm9kZU5hbWUgPT09IFwiQVwiKSB7XG4gICAgICAgICAgcmV0dXJuIFwicG9pbnRlclwiO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB2YWx1ZTtcbiAgfTtcbiAgLyoqXG4gKiBHZXQgdGhlIGFic29sdXRlbHkgcG9zaXRpb25lZCBjb29yZGluYXRlcyBvZiBhIERPTSBlbGVtZW50LlxuICpcbiAqIEByZXR1cm5zIE9iamVjdCBjb250YWluaW5nIHRoZSBlbGVtZW50J3MgcG9zaXRpb24sIHdpZHRoLCBhbmQgaGVpZ2h0LlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2dldEVsZW1lbnRQb3NpdGlvbiA9IGZ1bmN0aW9uKGVsKSB7XG4gICAgdmFyIHBvcyA9IHtcbiAgICAgIGxlZnQ6IDAsXG4gICAgICB0b3A6IDAsXG4gICAgICB3aWR0aDogMCxcbiAgICAgIGhlaWdodDogMFxuICAgIH07XG4gICAgaWYgKGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCkge1xuICAgICAgdmFyIGVsUmVjdCA9IGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgdmFyIHBhZ2VYT2Zmc2V0ID0gX3dpbmRvdy5wYWdlWE9mZnNldDtcbiAgICAgIHZhciBwYWdlWU9mZnNldCA9IF93aW5kb3cucGFnZVlPZmZzZXQ7XG4gICAgICB2YXIgbGVmdEJvcmRlcldpZHRoID0gX2RvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRMZWZ0IHx8IDA7XG4gICAgICB2YXIgdG9wQm9yZGVyV2lkdGggPSBfZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFRvcCB8fCAwO1xuICAgICAgdmFyIGxlZnRCb2R5T2Zmc2V0ID0gMDtcbiAgICAgIHZhciB0b3BCb2R5T2Zmc2V0ID0gMDtcbiAgICAgIGlmIChfZ2V0U3R5bGUoX2RvY3VtZW50LmJvZHksIFwicG9zaXRpb25cIikgPT09IFwicmVsYXRpdmVcIikge1xuICAgICAgICB2YXIgYm9keVJlY3QgPSBfZG9jdW1lbnQuYm9keS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgdmFyIGh0bWxSZWN0ID0gX2RvY3VtZW50LmRvY3VtZW50RWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgbGVmdEJvZHlPZmZzZXQgPSBib2R5UmVjdC5sZWZ0IC0gaHRtbFJlY3QubGVmdCB8fCAwO1xuICAgICAgICB0b3BCb2R5T2Zmc2V0ID0gYm9keVJlY3QudG9wIC0gaHRtbFJlY3QudG9wIHx8IDA7XG4gICAgICB9XG4gICAgICBwb3MubGVmdCA9IGVsUmVjdC5sZWZ0ICsgcGFnZVhPZmZzZXQgLSBsZWZ0Qm9yZGVyV2lkdGggLSBsZWZ0Qm9keU9mZnNldDtcbiAgICAgIHBvcy50b3AgPSBlbFJlY3QudG9wICsgcGFnZVlPZmZzZXQgLSB0b3BCb3JkZXJXaWR0aCAtIHRvcEJvZHlPZmZzZXQ7XG4gICAgICBwb3Mud2lkdGggPSBcIndpZHRoXCIgaW4gZWxSZWN0ID8gZWxSZWN0LndpZHRoIDogZWxSZWN0LnJpZ2h0IC0gZWxSZWN0LmxlZnQ7XG4gICAgICBwb3MuaGVpZ2h0ID0gXCJoZWlnaHRcIiBpbiBlbFJlY3QgPyBlbFJlY3QuaGVpZ2h0IDogZWxSZWN0LmJvdHRvbSAtIGVsUmVjdC50b3A7XG4gICAgfVxuICAgIHJldHVybiBwb3M7XG4gIH07XG4gIC8qKlxuICogRGV0ZXJtaW5lIGlzIGFuIGVsZW1lbnQgaXMgdmlzaWJsZSBzb21ld2hlcmUgd2l0aGluIHRoZSBkb2N1bWVudCAocGFnZSkuXG4gKlxuICogQHJldHVybnMgQm9vbGVhblxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2lzRWxlbWVudFZpc2libGUgPSBmdW5jdGlvbihlbCkge1xuICAgIGlmICghZWwpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdmFyIHN0eWxlcyA9IF9nZXRDb21wdXRlZFN0eWxlKGVsLCBudWxsKTtcbiAgICB2YXIgaGFzQ3NzSGVpZ2h0ID0gX3BhcnNlRmxvYXQoc3R5bGVzLmhlaWdodCkgPiAwO1xuICAgIHZhciBoYXNDc3NXaWR0aCA9IF9wYXJzZUZsb2F0KHN0eWxlcy53aWR0aCkgPiAwO1xuICAgIHZhciBoYXNDc3NUb3AgPSBfcGFyc2VGbG9hdChzdHlsZXMudG9wKSA+PSAwO1xuICAgIHZhciBoYXNDc3NMZWZ0ID0gX3BhcnNlRmxvYXQoc3R5bGVzLmxlZnQpID49IDA7XG4gICAgdmFyIGNzc0tub3dzID0gaGFzQ3NzSGVpZ2h0ICYmIGhhc0Nzc1dpZHRoICYmIGhhc0Nzc1RvcCAmJiBoYXNDc3NMZWZ0O1xuICAgIHZhciByZWN0ID0gY3NzS25vd3MgPyBudWxsIDogX2dldEVsZW1lbnRQb3NpdGlvbihlbCk7XG4gICAgdmFyIGlzVmlzaWJsZSA9IHN0eWxlcy5kaXNwbGF5ICE9PSBcIm5vbmVcIiAmJiBzdHlsZXMudmlzaWJpbGl0eSAhPT0gXCJjb2xsYXBzZVwiICYmIChjc3NLbm93cyB8fCAhIXJlY3QgJiYgKGhhc0Nzc0hlaWdodCB8fCByZWN0LmhlaWdodCA+IDApICYmIChoYXNDc3NXaWR0aCB8fCByZWN0LndpZHRoID4gMCkgJiYgKGhhc0Nzc1RvcCB8fCByZWN0LnRvcCA+PSAwKSAmJiAoaGFzQ3NzTGVmdCB8fCByZWN0LmxlZnQgPj0gMCkpO1xuICAgIHJldHVybiBpc1Zpc2libGU7XG4gIH07XG4gIC8qKlxuICogQ2xlYXIgYWxsIGV4aXN0aW5nIHRpbWVvdXRzIGFuZCBpbnRlcnZhbCBwb2xsaW5nIGRlbGVnYXRlcy5cbiAqXG4gKiBAcmV0dXJucyBgdW5kZWZpbmVkYFxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2NsZWFyVGltZW91dHNBbmRQb2xsaW5nID0gZnVuY3Rpb24oKSB7XG4gICAgX2NsZWFyVGltZW91dChfZmxhc2hDaGVja1RpbWVvdXQpO1xuICAgIF9mbGFzaENoZWNrVGltZW91dCA9IDA7XG4gICAgX2NsZWFySW50ZXJ2YWwoX3N3ZkZhbGxiYWNrQ2hlY2tJbnRlcnZhbCk7XG4gICAgX3N3ZkZhbGxiYWNrQ2hlY2tJbnRlcnZhbCA9IDA7XG4gIH07XG4gIC8qKlxuICogUmVwb3NpdGlvbiB0aGUgRmxhc2ggb2JqZWN0IHRvIGNvdmVyIHRoZSBjdXJyZW50bHkgYWN0aXZhdGVkIGVsZW1lbnQuXG4gKlxuICogQHJldHVybnMgYHVuZGVmaW5lZGBcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9yZXBvc2l0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGh0bWxCcmlkZ2U7XG4gICAgaWYgKF9jdXJyZW50RWxlbWVudCAmJiAoaHRtbEJyaWRnZSA9IF9nZXRIdG1sQnJpZGdlKF9mbGFzaFN0YXRlLmJyaWRnZSkpKSB7XG4gICAgICB2YXIgcG9zID0gX2dldEVsZW1lbnRQb3NpdGlvbihfY3VycmVudEVsZW1lbnQpO1xuICAgICAgX2V4dGVuZChodG1sQnJpZGdlLnN0eWxlLCB7XG4gICAgICAgIHdpZHRoOiBwb3Mud2lkdGggKyBcInB4XCIsXG4gICAgICAgIGhlaWdodDogcG9zLmhlaWdodCArIFwicHhcIixcbiAgICAgICAgdG9wOiBwb3MudG9wICsgXCJweFwiLFxuICAgICAgICBsZWZ0OiBwb3MubGVmdCArIFwicHhcIixcbiAgICAgICAgekluZGV4OiBcIlwiICsgX2dldFNhZmVaSW5kZXgoX2dsb2JhbENvbmZpZy56SW5kZXgpXG4gICAgICB9KTtcbiAgICB9XG4gIH07XG4gIC8qKlxuICogU2VuZHMgYSBzaWduYWwgdG8gdGhlIEZsYXNoIG9iamVjdCB0byBkaXNwbGF5IHRoZSBoYW5kIGN1cnNvciBpZiBgdHJ1ZWAuXG4gKlxuICogQHJldHVybnMgYHVuZGVmaW5lZGBcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9zZXRIYW5kQ3Vyc29yID0gZnVuY3Rpb24oZW5hYmxlZCkge1xuICAgIGlmIChfZmxhc2hTdGF0ZS5yZWFkeSA9PT0gdHJ1ZSkge1xuICAgICAgaWYgKF9mbGFzaFN0YXRlLmJyaWRnZSAmJiB0eXBlb2YgX2ZsYXNoU3RhdGUuYnJpZGdlLnNldEhhbmRDdXJzb3IgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICBfZmxhc2hTdGF0ZS5icmlkZ2Uuc2V0SGFuZEN1cnNvcihlbmFibGVkKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIF9mbGFzaFN0YXRlLnJlYWR5ID0gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICB9O1xuICAvKipcbiAqIEdldCBhIHNhZmUgdmFsdWUgZm9yIGB6SW5kZXhgXG4gKlxuICogQHJldHVybnMgYW4gaW50ZWdlciwgb3IgXCJhdXRvXCJcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9nZXRTYWZlWkluZGV4ID0gZnVuY3Rpb24odmFsKSB7XG4gICAgaWYgKC9eKD86YXV0b3xpbmhlcml0KSQvLnRlc3QodmFsKSkge1xuICAgICAgcmV0dXJuIHZhbDtcbiAgICB9XG4gICAgdmFyIHpJbmRleDtcbiAgICBpZiAodHlwZW9mIHZhbCA9PT0gXCJudW1iZXJcIiAmJiAhX2lzTmFOKHZhbCkpIHtcbiAgICAgIHpJbmRleCA9IHZhbDtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWwgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgIHpJbmRleCA9IF9nZXRTYWZlWkluZGV4KF9wYXJzZUludCh2YWwsIDEwKSk7XG4gICAgfVxuICAgIHJldHVybiB0eXBlb2YgekluZGV4ID09PSBcIm51bWJlclwiID8gekluZGV4IDogXCJhdXRvXCI7XG4gIH07XG4gIC8qKlxuICogQXR0ZW1wdCB0byBkZXRlY3QgaWYgWmVyb0NsaXBib2FyZCBpcyBleGVjdXRpbmcgaW5zaWRlIG9mIGEgc2FuZGJveGVkIGlmcmFtZS5cbiAqIElmIGl0IGlzLCBGbGFzaCBQbGF5ZXIgY2Fubm90IGJlIHVzZWQsIHNvIFplcm9DbGlwYm9hcmQgaXMgZGVhZCBpbiB0aGUgd2F0ZXIuXG4gKlxuICogQHNlZSB7QGxpbmsgaHR0cDovL2xpc3RzLnczLm9yZy9BcmNoaXZlcy9QdWJsaWMvcHVibGljLXdoYXR3Zy1hcmNoaXZlLzIwMTREZWMvMDAwMi5odG1sfVxuICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9naXRodWIuY29tL3plcm9jbGlwYm9hcmQvemVyb2NsaXBib2FyZC9pc3N1ZXMvNTExfVxuICogQHNlZSB7QGxpbmsgaHR0cDovL3plcm9jbGlwYm9hcmQub3JnL3Rlc3QtaWZyYW1lcy5odG1sfVxuICpcbiAqIEByZXR1cm5zIGB0cnVlYCAoaXMgc2FuZGJveGVkKSwgYGZhbHNlYCAoaXMgbm90IHNhbmRib3hlZCksIG9yIGBudWxsYCAodW5jZXJ0YWluKSBcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9kZXRlY3RTYW5kYm94ID0gZnVuY3Rpb24oZG9Ob3RSZWFzc2Vzc0ZsYXNoU3VwcG9ydCkge1xuICAgIHZhciBlZmZlY3RpdmVTY3JpcHRPcmlnaW4sIGZyYW1lLCBmcmFtZUVycm9yLCBwcmV2aW91c1N0YXRlID0gX2ZsYXNoU3RhdGUuc2FuZGJveGVkLCBpc1NhbmRib3hlZCA9IG51bGw7XG4gICAgZG9Ob3RSZWFzc2Vzc0ZsYXNoU3VwcG9ydCA9IGRvTm90UmVhc3Nlc3NGbGFzaFN1cHBvcnQgPT09IHRydWU7XG4gICAgaWYgKF9wYWdlSXNGcmFtZWQgPT09IGZhbHNlKSB7XG4gICAgICBpc1NhbmRib3hlZCA9IGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0cnkge1xuICAgICAgICBmcmFtZSA9IHdpbmRvdy5mcmFtZUVsZW1lbnQgfHwgbnVsbDtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgZnJhbWVFcnJvciA9IHtcbiAgICAgICAgICBuYW1lOiBlLm5hbWUsXG4gICAgICAgICAgbWVzc2FnZTogZS5tZXNzYWdlXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICBpZiAoZnJhbWUgJiYgZnJhbWUubm9kZVR5cGUgPT09IDEgJiYgZnJhbWUubm9kZU5hbWUgPT09IFwiSUZSQU1FXCIpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBpc1NhbmRib3hlZCA9IGZyYW1lLmhhc0F0dHJpYnV0ZShcInNhbmRib3hcIik7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICBpc1NhbmRib3hlZCA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgZWZmZWN0aXZlU2NyaXB0T3JpZ2luID0gZG9jdW1lbnQuZG9tYWluIHx8IG51bGw7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICBlZmZlY3RpdmVTY3JpcHRPcmlnaW4gPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGlmIChlZmZlY3RpdmVTY3JpcHRPcmlnaW4gPT09IG51bGwgfHwgZnJhbWVFcnJvciAmJiBmcmFtZUVycm9yLm5hbWUgPT09IFwiU2VjdXJpdHlFcnJvclwiICYmIC8oXnxbXFxzXFwoXFxbQF0pc2FuZGJveChlc3xlZHxpbmd8W1xcc1xcLiwhXFwpXFxdQF18JCkvLnRlc3QoZnJhbWVFcnJvci5tZXNzYWdlLnRvTG93ZXJDYXNlKCkpKSB7XG4gICAgICAgICAgaXNTYW5kYm94ZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIF9mbGFzaFN0YXRlLnNhbmRib3hlZCA9IGlzU2FuZGJveGVkO1xuICAgIGlmIChwcmV2aW91c1N0YXRlICE9PSBpc1NhbmRib3hlZCAmJiAhZG9Ob3RSZWFzc2Vzc0ZsYXNoU3VwcG9ydCkge1xuICAgICAgX2RldGVjdEZsYXNoU3VwcG9ydChfQWN0aXZlWE9iamVjdCk7XG4gICAgfVxuICAgIHJldHVybiBpc1NhbmRib3hlZDtcbiAgfTtcbiAgLyoqXG4gKiBEZXRlY3QgdGhlIEZsYXNoIFBsYXllciBzdGF0dXMsIHZlcnNpb24sIGFuZCBwbHVnaW4gdHlwZS5cbiAqXG4gKiBAc2VlIHtAbGluayBodHRwczovL2NvZGUuZ29vZ2xlLmNvbS9wL2RvY3R5cGUtbWlycm9yL3dpa2kvQXJ0aWNsZURldGVjdEZsYXNoI1RoZV9jb2RlfVxuICogQHNlZSB7QGxpbmsgaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8xMjg2NjA2MC9kZXRlY3RpbmctcGVwcGVyLXBwYXBpLWZsYXNoLXdpdGgtamF2YXNjcmlwdH1cbiAqXG4gKiBAcmV0dXJucyBgdW5kZWZpbmVkYFxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2RldGVjdEZsYXNoU3VwcG9ydCA9IGZ1bmN0aW9uKEFjdGl2ZVhPYmplY3QpIHtcbiAgICB2YXIgcGx1Z2luLCBheCwgbWltZVR5cGUsIGhhc0ZsYXNoID0gZmFsc2UsIGlzQWN0aXZlWCA9IGZhbHNlLCBpc1BQQVBJID0gZmFsc2UsIGZsYXNoVmVyc2lvbiA9IFwiXCI7XG4gICAgLyoqXG4gICAqIERlcml2ZWQgZnJvbSBBcHBsZSdzIHN1Z2dlc3RlZCBzbmlmZmVyLlxuICAgKiBAcGFyYW0ge1N0cmluZ30gZGVzYyBlLmcuIFwiU2hvY2t3YXZlIEZsYXNoIDcuMCByNjFcIlxuICAgKiBAcmV0dXJucyB7U3RyaW5nfSBcIjcuMC42MVwiXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICAgIGZ1bmN0aW9uIHBhcnNlRmxhc2hWZXJzaW9uKGRlc2MpIHtcbiAgICAgIHZhciBtYXRjaGVzID0gZGVzYy5tYXRjaCgvW1xcZF0rL2cpO1xuICAgICAgbWF0Y2hlcy5sZW5ndGggPSAzO1xuICAgICAgcmV0dXJuIG1hdGNoZXMuam9pbihcIi5cIik7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGlzUGVwcGVyRmxhc2goZmxhc2hQbGF5ZXJGaWxlTmFtZSkge1xuICAgICAgcmV0dXJuICEhZmxhc2hQbGF5ZXJGaWxlTmFtZSAmJiAoZmxhc2hQbGF5ZXJGaWxlTmFtZSA9IGZsYXNoUGxheWVyRmlsZU5hbWUudG9Mb3dlckNhc2UoKSkgJiYgKC9eKHBlcGZsYXNocGxheWVyXFwuZGxsfGxpYnBlcGZsYXNocGxheWVyXFwuc298cGVwcGVyZmxhc2hwbGF5ZXJcXC5wbHVnaW4pJC8udGVzdChmbGFzaFBsYXllckZpbGVOYW1lKSB8fCBmbGFzaFBsYXllckZpbGVOYW1lLnNsaWNlKC0xMykgPT09IFwiY2hyb21lLnBsdWdpblwiKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gaW5zcGVjdFBsdWdpbihwbHVnaW4pIHtcbiAgICAgIGlmIChwbHVnaW4pIHtcbiAgICAgICAgaGFzRmxhc2ggPSB0cnVlO1xuICAgICAgICBpZiAocGx1Z2luLnZlcnNpb24pIHtcbiAgICAgICAgICBmbGFzaFZlcnNpb24gPSBwYXJzZUZsYXNoVmVyc2lvbihwbHVnaW4udmVyc2lvbik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFmbGFzaFZlcnNpb24gJiYgcGx1Z2luLmRlc2NyaXB0aW9uKSB7XG4gICAgICAgICAgZmxhc2hWZXJzaW9uID0gcGFyc2VGbGFzaFZlcnNpb24ocGx1Z2luLmRlc2NyaXB0aW9uKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGx1Z2luLmZpbGVuYW1lKSB7XG4gICAgICAgICAgaXNQUEFQSSA9IGlzUGVwcGVyRmxhc2gocGx1Z2luLmZpbGVuYW1lKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBpZiAoX25hdmlnYXRvci5wbHVnaW5zICYmIF9uYXZpZ2F0b3IucGx1Z2lucy5sZW5ndGgpIHtcbiAgICAgIHBsdWdpbiA9IF9uYXZpZ2F0b3IucGx1Z2luc1tcIlNob2Nrd2F2ZSBGbGFzaFwiXTtcbiAgICAgIGluc3BlY3RQbHVnaW4ocGx1Z2luKTtcbiAgICAgIGlmIChfbmF2aWdhdG9yLnBsdWdpbnNbXCJTaG9ja3dhdmUgRmxhc2ggMi4wXCJdKSB7XG4gICAgICAgIGhhc0ZsYXNoID0gdHJ1ZTtcbiAgICAgICAgZmxhc2hWZXJzaW9uID0gXCIyLjAuMC4xMVwiO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoX25hdmlnYXRvci5taW1lVHlwZXMgJiYgX25hdmlnYXRvci5taW1lVHlwZXMubGVuZ3RoKSB7XG4gICAgICBtaW1lVHlwZSA9IF9uYXZpZ2F0b3IubWltZVR5cGVzW1wiYXBwbGljYXRpb24veC1zaG9ja3dhdmUtZmxhc2hcIl07XG4gICAgICBwbHVnaW4gPSBtaW1lVHlwZSAmJiBtaW1lVHlwZS5lbmFibGVkUGx1Z2luO1xuICAgICAgaW5zcGVjdFBsdWdpbihwbHVnaW4pO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIEFjdGl2ZVhPYmplY3QgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIGlzQWN0aXZlWCA9IHRydWU7XG4gICAgICB0cnkge1xuICAgICAgICBheCA9IG5ldyBBY3RpdmVYT2JqZWN0KFwiU2hvY2t3YXZlRmxhc2guU2hvY2t3YXZlRmxhc2guN1wiKTtcbiAgICAgICAgaGFzRmxhc2ggPSB0cnVlO1xuICAgICAgICBmbGFzaFZlcnNpb24gPSBwYXJzZUZsYXNoVmVyc2lvbihheC5HZXRWYXJpYWJsZShcIiR2ZXJzaW9uXCIpKTtcbiAgICAgIH0gY2F0Y2ggKGUxKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgYXggPSBuZXcgQWN0aXZlWE9iamVjdChcIlNob2Nrd2F2ZUZsYXNoLlNob2Nrd2F2ZUZsYXNoLjZcIik7XG4gICAgICAgICAgaGFzRmxhc2ggPSB0cnVlO1xuICAgICAgICAgIGZsYXNoVmVyc2lvbiA9IFwiNi4wLjIxXCI7XG4gICAgICAgIH0gY2F0Y2ggKGUyKSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF4ID0gbmV3IEFjdGl2ZVhPYmplY3QoXCJTaG9ja3dhdmVGbGFzaC5TaG9ja3dhdmVGbGFzaFwiKTtcbiAgICAgICAgICAgIGhhc0ZsYXNoID0gdHJ1ZTtcbiAgICAgICAgICAgIGZsYXNoVmVyc2lvbiA9IHBhcnNlRmxhc2hWZXJzaW9uKGF4LkdldFZhcmlhYmxlKFwiJHZlcnNpb25cIikpO1xuICAgICAgICAgIH0gY2F0Y2ggKGUzKSB7XG4gICAgICAgICAgICBpc0FjdGl2ZVggPSBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgX2ZsYXNoU3RhdGUuZGlzYWJsZWQgPSBoYXNGbGFzaCAhPT0gdHJ1ZTtcbiAgICBfZmxhc2hTdGF0ZS5vdXRkYXRlZCA9IGZsYXNoVmVyc2lvbiAmJiBfcGFyc2VGbG9hdChmbGFzaFZlcnNpb24pIDwgX3BhcnNlRmxvYXQoX21pbmltdW1GbGFzaFZlcnNpb24pO1xuICAgIF9mbGFzaFN0YXRlLnZlcnNpb24gPSBmbGFzaFZlcnNpb24gfHwgXCIwLjAuMFwiO1xuICAgIF9mbGFzaFN0YXRlLnBsdWdpblR5cGUgPSBpc1BQQVBJID8gXCJwZXBwZXJcIiA6IGlzQWN0aXZlWCA/IFwiYWN0aXZleFwiIDogaGFzRmxhc2ggPyBcIm5ldHNjYXBlXCIgOiBcInVua25vd25cIjtcbiAgfTtcbiAgLyoqXG4gKiBJbnZva2UgdGhlIEZsYXNoIGRldGVjdGlvbiBhbGdvcml0aG1zIGltbWVkaWF0ZWx5IHVwb24gaW5jbHVzaW9uIHNvIHdlJ3JlIG5vdCB3YWl0aW5nIGxhdGVyLlxuICovXG4gIF9kZXRlY3RGbGFzaFN1cHBvcnQoX0FjdGl2ZVhPYmplY3QpO1xuICAvKipcbiAqIEFsd2F5cyBhc3Nlc3MgdGhlIGBzYW5kYm94ZWRgIHN0YXRlIG9mIHRoZSBwYWdlIGF0IGltcG9ydGFudCBGbGFzaC1yZWxhdGVkIG1vbWVudHMuXG4gKi9cbiAgX2RldGVjdFNhbmRib3godHJ1ZSk7XG4gIC8qKlxuICogQSBzaGVsbCBjb25zdHJ1Y3RvciBmb3IgYFplcm9DbGlwYm9hcmRgIGNsaWVudCBpbnN0YW5jZXMuXG4gKlxuICogQGNvbnN0cnVjdG9yXG4gKi9cbiAgdmFyIFplcm9DbGlwYm9hcmQgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgWmVyb0NsaXBib2FyZCkpIHtcbiAgICAgIHJldHVybiBuZXcgWmVyb0NsaXBib2FyZCgpO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIFplcm9DbGlwYm9hcmQuX2NyZWF0ZUNsaWVudCA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICBaZXJvQ2xpcGJvYXJkLl9jcmVhdGVDbGllbnQuYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gICAgfVxuICB9O1xuICAvKipcbiAqIFRoZSBaZXJvQ2xpcGJvYXJkIGxpYnJhcnkncyB2ZXJzaW9uIG51bWJlci5cbiAqXG4gKiBAc3RhdGljXG4gKiBAcmVhZG9ubHlcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfVxuICovXG4gIF9kZWZpbmVQcm9wZXJ0eShaZXJvQ2xpcGJvYXJkLCBcInZlcnNpb25cIiwge1xuICAgIHZhbHVlOiBcIjIuMi4wXCIsXG4gICAgd3JpdGFibGU6IGZhbHNlLFxuICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICBlbnVtZXJhYmxlOiB0cnVlXG4gIH0pO1xuICAvKipcbiAqIFVwZGF0ZSBvciBnZXQgYSBjb3B5IG9mIHRoZSBaZXJvQ2xpcGJvYXJkIGdsb2JhbCBjb25maWd1cmF0aW9uLlxuICogUmV0dXJucyBhIGNvcHkgb2YgdGhlIGN1cnJlbnQvdXBkYXRlZCBjb25maWd1cmF0aW9uLlxuICpcbiAqIEByZXR1cm5zIE9iamVjdFxuICogQHN0YXRpY1xuICovXG4gIFplcm9DbGlwYm9hcmQuY29uZmlnID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIF9jb25maWcuYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gIH07XG4gIC8qKlxuICogRGlhZ25vc3RpYyBtZXRob2QgdGhhdCBkZXNjcmliZXMgdGhlIHN0YXRlIG9mIHRoZSBicm93c2VyLCBGbGFzaCBQbGF5ZXIsIGFuZCBaZXJvQ2xpcGJvYXJkLlxuICpcbiAqIEByZXR1cm5zIE9iamVjdFxuICogQHN0YXRpY1xuICovXG4gIFplcm9DbGlwYm9hcmQuc3RhdGUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX3N0YXRlLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIENoZWNrIGlmIEZsYXNoIGlzIHVudXNhYmxlIGZvciBhbnkgcmVhc29uOiBkaXNhYmxlZCwgb3V0ZGF0ZWQsIGRlYWN0aXZhdGVkLCBldGMuXG4gKlxuICogQHJldHVybnMgQm9vbGVhblxuICogQHN0YXRpY1xuICovXG4gIFplcm9DbGlwYm9hcmQuaXNGbGFzaFVudXNhYmxlID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIF9pc0ZsYXNoVW51c2FibGUuYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gIH07XG4gIC8qKlxuICogUmVnaXN0ZXIgYW4gZXZlbnQgbGlzdGVuZXIuXG4gKlxuICogQHJldHVybnMgYFplcm9DbGlwYm9hcmRgXG4gKiBAc3RhdGljXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5vbiA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfb24uYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gIH07XG4gIC8qKlxuICogVW5yZWdpc3RlciBhbiBldmVudCBsaXN0ZW5lci5cbiAqIElmIG5vIGBsaXN0ZW5lcmAgZnVuY3Rpb24vb2JqZWN0IGlzIHByb3ZpZGVkLCBpdCB3aWxsIHVucmVnaXN0ZXIgYWxsIGxpc3RlbmVycyBmb3IgdGhlIHByb3ZpZGVkIGBldmVudFR5cGVgLlxuICogSWYgbm8gYGV2ZW50VHlwZWAgaXMgcHJvdmlkZWQsIGl0IHdpbGwgdW5yZWdpc3RlciBhbGwgbGlzdGVuZXJzIGZvciBldmVyeSBldmVudCB0eXBlLlxuICpcbiAqIEByZXR1cm5zIGBaZXJvQ2xpcGJvYXJkYFxuICogQHN0YXRpY1xuICovXG4gIFplcm9DbGlwYm9hcmQub2ZmID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIF9vZmYuYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gIH07XG4gIC8qKlxuICogUmV0cmlldmUgZXZlbnQgbGlzdGVuZXJzIGZvciBhbiBgZXZlbnRUeXBlYC5cbiAqIElmIG5vIGBldmVudFR5cGVgIGlzIHByb3ZpZGVkLCBpdCB3aWxsIHJldHJpZXZlIGFsbCBsaXN0ZW5lcnMgZm9yIGV2ZXJ5IGV2ZW50IHR5cGUuXG4gKlxuICogQHJldHVybnMgYXJyYXkgb2YgbGlzdGVuZXJzIGZvciB0aGUgYGV2ZW50VHlwZWA7IGlmIG5vIGBldmVudFR5cGVgLCB0aGVuIGEgbWFwL2hhc2ggb2JqZWN0IG9mIGxpc3RlbmVycyBmb3IgYWxsIGV2ZW50IHR5cGVzOyBvciBgbnVsbGBcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLmhhbmRsZXJzID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIF9saXN0ZW5lcnMuYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gIH07XG4gIC8qKlxuICogRXZlbnQgZW1pc3Npb24gcmVjZWl2ZXIgZnJvbSB0aGUgRmxhc2ggb2JqZWN0LCBmb3J3YXJkaW5nIHRvIGFueSByZWdpc3RlcmVkIEphdmFTY3JpcHQgZXZlbnQgbGlzdGVuZXJzLlxuICpcbiAqIEByZXR1cm5zIEZvciB0aGUgXCJjb3B5XCIgZXZlbnQsIHJldHVybnMgdGhlIEZsYXNoLWZyaWVuZGx5IFwiY2xpcERhdGFcIiBvYmplY3Q7IG90aGVyd2lzZSBgdW5kZWZpbmVkYC5cbiAqIEBzdGF0aWNcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLmVtaXQgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX2VtaXQuYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gIH07XG4gIC8qKlxuICogQ3JlYXRlIGFuZCBlbWJlZCB0aGUgRmxhc2ggb2JqZWN0LlxuICpcbiAqIEByZXR1cm5zIFRoZSBGbGFzaCBvYmplY3RcbiAqIEBzdGF0aWNcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLmNyZWF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfY3JlYXRlLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIFNlbGYtZGVzdHJ1Y3QgYW5kIGNsZWFuIHVwIGV2ZXJ5dGhpbmcsIGluY2x1ZGluZyB0aGUgZW1iZWRkZWQgRmxhc2ggb2JqZWN0LlxuICpcbiAqIEByZXR1cm5zIGB1bmRlZmluZWRgXG4gKiBAc3RhdGljXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5kZXN0cm95ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIF9kZXN0cm95LmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIFNldCB0aGUgcGVuZGluZyBkYXRhIGZvciBjbGlwYm9hcmQgaW5qZWN0aW9uLlxuICpcbiAqIEByZXR1cm5zIGB1bmRlZmluZWRgXG4gKiBAc3RhdGljXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5zZXREYXRhID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIF9zZXREYXRhLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIENsZWFyIHRoZSBwZW5kaW5nIGRhdGEgZm9yIGNsaXBib2FyZCBpbmplY3Rpb24uXG4gKiBJZiBubyBgZm9ybWF0YCBpcyBwcm92aWRlZCwgYWxsIHBlbmRpbmcgZGF0YSBmb3JtYXRzIHdpbGwgYmUgY2xlYXJlZC5cbiAqXG4gKiBAcmV0dXJucyBgdW5kZWZpbmVkYFxuICogQHN0YXRpY1xuICovXG4gIFplcm9DbGlwYm9hcmQuY2xlYXJEYXRhID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIF9jbGVhckRhdGEuYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gIH07XG4gIC8qKlxuICogR2V0IGEgY29weSBvZiB0aGUgcGVuZGluZyBkYXRhIGZvciBjbGlwYm9hcmQgaW5qZWN0aW9uLlxuICogSWYgbm8gYGZvcm1hdGAgaXMgcHJvdmlkZWQsIGEgY29weSBvZiBBTEwgcGVuZGluZyBkYXRhIGZvcm1hdHMgd2lsbCBiZSByZXR1cm5lZC5cbiAqXG4gKiBAcmV0dXJucyBgU3RyaW5nYCBvciBgT2JqZWN0YFxuICogQHN0YXRpY1xuICovXG4gIFplcm9DbGlwYm9hcmQuZ2V0RGF0YSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfZ2V0RGF0YS5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBTZXRzIHRoZSBjdXJyZW50IEhUTUwgb2JqZWN0IHRoYXQgdGhlIEZsYXNoIG9iamVjdCBzaG91bGQgb3ZlcmxheS4gVGhpcyB3aWxsIHB1dCB0aGUgZ2xvYmFsXG4gKiBGbGFzaCBvYmplY3Qgb24gdG9wIG9mIHRoZSBjdXJyZW50IGVsZW1lbnQ7IGRlcGVuZGluZyBvbiB0aGUgc2V0dXAsIHRoaXMgbWF5IGFsc28gc2V0IHRoZVxuICogcGVuZGluZyBjbGlwYm9hcmQgdGV4dCBkYXRhIGFzIHdlbGwgYXMgdGhlIEZsYXNoIG9iamVjdCdzIHdyYXBwaW5nIGVsZW1lbnQncyB0aXRsZSBhdHRyaWJ1dGVcbiAqIGJhc2VkIG9uIHRoZSB1bmRlcmx5aW5nIEhUTUwgZWxlbWVudCBhbmQgWmVyb0NsaXBib2FyZCBjb25maWd1cmF0aW9uLlxuICpcbiAqIEByZXR1cm5zIGB1bmRlZmluZWRgXG4gKiBAc3RhdGljXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5mb2N1cyA9IFplcm9DbGlwYm9hcmQuYWN0aXZhdGUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX2ZvY3VzLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIFVuLW92ZXJsYXlzIHRoZSBGbGFzaCBvYmplY3QuIFRoaXMgd2lsbCBwdXQgdGhlIGdsb2JhbCBGbGFzaCBvYmplY3Qgb2ZmLXNjcmVlbjsgZGVwZW5kaW5nIG9uXG4gKiB0aGUgc2V0dXAsIHRoaXMgbWF5IGFsc28gdW5zZXQgdGhlIEZsYXNoIG9iamVjdCdzIHdyYXBwaW5nIGVsZW1lbnQncyB0aXRsZSBhdHRyaWJ1dGUgYmFzZWQgb25cbiAqIHRoZSB1bmRlcmx5aW5nIEhUTUwgZWxlbWVudCBhbmQgWmVyb0NsaXBib2FyZCBjb25maWd1cmF0aW9uLlxuICpcbiAqIEByZXR1cm5zIGB1bmRlZmluZWRgXG4gKiBAc3RhdGljXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5ibHVyID0gWmVyb0NsaXBib2FyZC5kZWFjdGl2YXRlID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIF9ibHVyLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIFJldHVybnMgdGhlIGN1cnJlbnRseSBmb2N1c2VkL1wiYWN0aXZhdGVkXCIgSFRNTCBlbGVtZW50IHRoYXQgdGhlIEZsYXNoIG9iamVjdCBpcyB3cmFwcGluZy5cbiAqXG4gKiBAcmV0dXJucyBgSFRNTEVsZW1lbnRgIG9yIGBudWxsYFxuICogQHN0YXRpY1xuICovXG4gIFplcm9DbGlwYm9hcmQuYWN0aXZlRWxlbWVudCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfYWN0aXZlRWxlbWVudC5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBLZWVwIHRyYWNrIG9mIHRoZSBaZXJvQ2xpcGJvYXJkIGNsaWVudCBpbnN0YW5jZSBjb3VudGVyLlxuICovXG4gIHZhciBfY2xpZW50SWRDb3VudGVyID0gMDtcbiAgLyoqXG4gKiBLZWVwIHRyYWNrIG9mIHRoZSBzdGF0ZSBvZiB0aGUgY2xpZW50IGluc3RhbmNlcy5cbiAqXG4gKiBFbnRyeSBzdHJ1Y3R1cmU6XG4gKiAgIF9jbGllbnRNZXRhW2NsaWVudC5pZF0gPSB7XG4gKiAgICAgaW5zdGFuY2U6IGNsaWVudCxcbiAqICAgICBlbGVtZW50czogW10sXG4gKiAgICAgaGFuZGxlcnM6IHt9XG4gKiAgIH07XG4gKi9cbiAgdmFyIF9jbGllbnRNZXRhID0ge307XG4gIC8qKlxuICogS2VlcCB0cmFjayBvZiB0aGUgWmVyb0NsaXBib2FyZCBjbGlwcGVkIGVsZW1lbnRzIGNvdW50ZXIuXG4gKi9cbiAgdmFyIF9lbGVtZW50SWRDb3VudGVyID0gMDtcbiAgLyoqXG4gKiBLZWVwIHRyYWNrIG9mIHRoZSBzdGF0ZSBvZiB0aGUgY2xpcHBlZCBlbGVtZW50IHJlbGF0aW9uc2hpcHMgdG8gY2xpZW50cy5cbiAqXG4gKiBFbnRyeSBzdHJ1Y3R1cmU6XG4gKiAgIF9lbGVtZW50TWV0YVtlbGVtZW50LnpjQ2xpcHBpbmdJZF0gPSBbY2xpZW50MS5pZCwgY2xpZW50Mi5pZF07XG4gKi9cbiAgdmFyIF9lbGVtZW50TWV0YSA9IHt9O1xuICAvKipcbiAqIEtlZXAgdHJhY2sgb2YgdGhlIHN0YXRlIG9mIHRoZSBtb3VzZSBldmVudCBoYW5kbGVycyBmb3IgY2xpcHBlZCBlbGVtZW50cy5cbiAqXG4gKiBFbnRyeSBzdHJ1Y3R1cmU6XG4gKiAgIF9tb3VzZUhhbmRsZXJzW2VsZW1lbnQuemNDbGlwcGluZ0lkXSA9IHtcbiAqICAgICBtb3VzZW92ZXI6ICBmdW5jdGlvbihldmVudCkge30sXG4gKiAgICAgbW91c2VvdXQ6ICAgZnVuY3Rpb24oZXZlbnQpIHt9LFxuICogICAgIG1vdXNlZW50ZXI6IGZ1bmN0aW9uKGV2ZW50KSB7fSxcbiAqICAgICBtb3VzZWxlYXZlOiBmdW5jdGlvbihldmVudCkge30sXG4gKiAgICAgbW91c2Vtb3ZlOiAgZnVuY3Rpb24oZXZlbnQpIHt9XG4gKiAgIH07XG4gKi9cbiAgdmFyIF9tb3VzZUhhbmRsZXJzID0ge307XG4gIC8qKlxuICogRXh0ZW5kaW5nIHRoZSBaZXJvQ2xpcGJvYXJkIGNvbmZpZ3VyYXRpb24gZGVmYXVsdHMgZm9yIHRoZSBDbGllbnQgbW9kdWxlLlxuICovXG4gIF9leHRlbmQoX2dsb2JhbENvbmZpZywge1xuICAgIGF1dG9BY3RpdmF0ZTogdHJ1ZVxuICB9KTtcbiAgLyoqXG4gKiBUaGUgcmVhbCBjb25zdHJ1Y3RvciBmb3IgYFplcm9DbGlwYm9hcmRgIGNsaWVudCBpbnN0YW5jZXMuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY2xpZW50Q29uc3RydWN0b3IgPSBmdW5jdGlvbihlbGVtZW50cykge1xuICAgIHZhciBjbGllbnQgPSB0aGlzO1xuICAgIGNsaWVudC5pZCA9IFwiXCIgKyBfY2xpZW50SWRDb3VudGVyKys7XG4gICAgX2NsaWVudE1ldGFbY2xpZW50LmlkXSA9IHtcbiAgICAgIGluc3RhbmNlOiBjbGllbnQsXG4gICAgICBlbGVtZW50czogW10sXG4gICAgICBoYW5kbGVyczoge31cbiAgICB9O1xuICAgIGlmIChlbGVtZW50cykge1xuICAgICAgY2xpZW50LmNsaXAoZWxlbWVudHMpO1xuICAgIH1cbiAgICBaZXJvQ2xpcGJvYXJkLm9uKFwiKlwiLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgcmV0dXJuIGNsaWVudC5lbWl0KGV2ZW50KTtcbiAgICB9KTtcbiAgICBaZXJvQ2xpcGJvYXJkLm9uKFwiZGVzdHJveVwiLCBmdW5jdGlvbigpIHtcbiAgICAgIGNsaWVudC5kZXN0cm95KCk7XG4gICAgfSk7XG4gICAgWmVyb0NsaXBib2FyZC5jcmVhdGUoKTtcbiAgfTtcbiAgLyoqXG4gKiBUaGUgdW5kZXJseWluZyBpbXBsZW1lbnRhdGlvbiBvZiBgWmVyb0NsaXBib2FyZC5DbGllbnQucHJvdG90eXBlLm9uYC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9jbGllbnRPbiA9IGZ1bmN0aW9uKGV2ZW50VHlwZSwgbGlzdGVuZXIpIHtcbiAgICB2YXIgaSwgbGVuLCBldmVudHMsIGFkZGVkID0ge30sIG1ldGEgPSBfY2xpZW50TWV0YVt0aGlzLmlkXSwgaGFuZGxlcnMgPSBtZXRhICYmIG1ldGEuaGFuZGxlcnM7XG4gICAgaWYgKCFtZXRhKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBdHRlbXB0ZWQgdG8gYWRkIG5ldyBsaXN0ZW5lcihzKSB0byBhIGRlc3Ryb3llZCBaZXJvQ2xpcGJvYXJkIGNsaWVudCBpbnN0YW5jZVwiKTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBldmVudFR5cGUgPT09IFwic3RyaW5nXCIgJiYgZXZlbnRUeXBlKSB7XG4gICAgICBldmVudHMgPSBldmVudFR5cGUudG9Mb3dlckNhc2UoKS5zcGxpdCgvXFxzKy8pO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGV2ZW50VHlwZSA9PT0gXCJvYmplY3RcIiAmJiBldmVudFR5cGUgJiYgdHlwZW9mIGxpc3RlbmVyID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICBmb3IgKGkgaW4gZXZlbnRUeXBlKSB7XG4gICAgICAgIGlmIChfaGFzT3duLmNhbGwoZXZlbnRUeXBlLCBpKSAmJiB0eXBlb2YgaSA9PT0gXCJzdHJpbmdcIiAmJiBpICYmIHR5cGVvZiBldmVudFR5cGVbaV0gPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgIHRoaXMub24oaSwgZXZlbnRUeXBlW2ldKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBpZiAoZXZlbnRzICYmIGV2ZW50cy5sZW5ndGgpIHtcbiAgICAgIGZvciAoaSA9IDAsIGxlbiA9IGV2ZW50cy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBldmVudFR5cGUgPSBldmVudHNbaV0ucmVwbGFjZSgvXm9uLywgXCJcIik7XG4gICAgICAgIGFkZGVkW2V2ZW50VHlwZV0gPSB0cnVlO1xuICAgICAgICBpZiAoIWhhbmRsZXJzW2V2ZW50VHlwZV0pIHtcbiAgICAgICAgICBoYW5kbGVyc1tldmVudFR5cGVdID0gW107XG4gICAgICAgIH1cbiAgICAgICAgaGFuZGxlcnNbZXZlbnRUeXBlXS5wdXNoKGxpc3RlbmVyKTtcbiAgICAgIH1cbiAgICAgIGlmIChhZGRlZC5yZWFkeSAmJiBfZmxhc2hTdGF0ZS5yZWFkeSkge1xuICAgICAgICB0aGlzLmVtaXQoe1xuICAgICAgICAgIHR5cGU6IFwicmVhZHlcIixcbiAgICAgICAgICBjbGllbnQ6IHRoaXNcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBpZiAoYWRkZWQuZXJyb3IpIHtcbiAgICAgICAgZm9yIChpID0gMCwgbGVuID0gX2ZsYXNoU3RhdGVFcnJvck5hbWVzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgaWYgKF9mbGFzaFN0YXRlW19mbGFzaFN0YXRlRXJyb3JOYW1lc1tpXS5yZXBsYWNlKC9eZmxhc2gtLywgXCJcIildKSB7XG4gICAgICAgICAgICB0aGlzLmVtaXQoe1xuICAgICAgICAgICAgICB0eXBlOiBcImVycm9yXCIsXG4gICAgICAgICAgICAgIG5hbWU6IF9mbGFzaFN0YXRlRXJyb3JOYW1lc1tpXSxcbiAgICAgICAgICAgICAgY2xpZW50OiB0aGlzXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoX3pjU3dmVmVyc2lvbiAhPT0gdW5kZWZpbmVkICYmIFplcm9DbGlwYm9hcmQudmVyc2lvbiAhPT0gX3pjU3dmVmVyc2lvbikge1xuICAgICAgICAgIHRoaXMuZW1pdCh7XG4gICAgICAgICAgICB0eXBlOiBcImVycm9yXCIsXG4gICAgICAgICAgICBuYW1lOiBcInZlcnNpb24tbWlzbWF0Y2hcIixcbiAgICAgICAgICAgIGpzVmVyc2lvbjogWmVyb0NsaXBib2FyZC52ZXJzaW9uLFxuICAgICAgICAgICAgc3dmVmVyc2lvbjogX3pjU3dmVmVyc2lvblxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuICAvKipcbiAqIFRoZSB1bmRlcmx5aW5nIGltcGxlbWVudGF0aW9uIG9mIGBaZXJvQ2xpcGJvYXJkLkNsaWVudC5wcm90b3R5cGUub2ZmYC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9jbGllbnRPZmYgPSBmdW5jdGlvbihldmVudFR5cGUsIGxpc3RlbmVyKSB7XG4gICAgdmFyIGksIGxlbiwgZm91bmRJbmRleCwgZXZlbnRzLCBwZXJFdmVudEhhbmRsZXJzLCBtZXRhID0gX2NsaWVudE1ldGFbdGhpcy5pZF0sIGhhbmRsZXJzID0gbWV0YSAmJiBtZXRhLmhhbmRsZXJzO1xuICAgIGlmICghaGFuZGxlcnMpIHtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgZXZlbnRzID0gX2tleXMoaGFuZGxlcnMpO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGV2ZW50VHlwZSA9PT0gXCJzdHJpbmdcIiAmJiBldmVudFR5cGUpIHtcbiAgICAgIGV2ZW50cyA9IGV2ZW50VHlwZS5zcGxpdCgvXFxzKy8pO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGV2ZW50VHlwZSA9PT0gXCJvYmplY3RcIiAmJiBldmVudFR5cGUgJiYgdHlwZW9mIGxpc3RlbmVyID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICBmb3IgKGkgaW4gZXZlbnRUeXBlKSB7XG4gICAgICAgIGlmIChfaGFzT3duLmNhbGwoZXZlbnRUeXBlLCBpKSAmJiB0eXBlb2YgaSA9PT0gXCJzdHJpbmdcIiAmJiBpICYmIHR5cGVvZiBldmVudFR5cGVbaV0gPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgIHRoaXMub2ZmKGksIGV2ZW50VHlwZVtpXSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGV2ZW50cyAmJiBldmVudHMubGVuZ3RoKSB7XG4gICAgICBmb3IgKGkgPSAwLCBsZW4gPSBldmVudHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgZXZlbnRUeXBlID0gZXZlbnRzW2ldLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvXm9uLywgXCJcIik7XG4gICAgICAgIHBlckV2ZW50SGFuZGxlcnMgPSBoYW5kbGVyc1tldmVudFR5cGVdO1xuICAgICAgICBpZiAocGVyRXZlbnRIYW5kbGVycyAmJiBwZXJFdmVudEhhbmRsZXJzLmxlbmd0aCkge1xuICAgICAgICAgIGlmIChsaXN0ZW5lcikge1xuICAgICAgICAgICAgZm91bmRJbmRleCA9IHBlckV2ZW50SGFuZGxlcnMuaW5kZXhPZihsaXN0ZW5lcik7XG4gICAgICAgICAgICB3aGlsZSAoZm91bmRJbmRleCAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgcGVyRXZlbnRIYW5kbGVycy5zcGxpY2UoZm91bmRJbmRleCwgMSk7XG4gICAgICAgICAgICAgIGZvdW5kSW5kZXggPSBwZXJFdmVudEhhbmRsZXJzLmluZGV4T2YobGlzdGVuZXIsIGZvdW5kSW5kZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBwZXJFdmVudEhhbmRsZXJzLmxlbmd0aCA9IDA7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuICAvKipcbiAqIFRoZSB1bmRlcmx5aW5nIGltcGxlbWVudGF0aW9uIG9mIGBaZXJvQ2xpcGJvYXJkLkNsaWVudC5wcm90b3R5cGUuaGFuZGxlcnNgLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2NsaWVudExpc3RlbmVycyA9IGZ1bmN0aW9uKGV2ZW50VHlwZSkge1xuICAgIHZhciBjb3B5ID0gbnVsbCwgaGFuZGxlcnMgPSBfY2xpZW50TWV0YVt0aGlzLmlkXSAmJiBfY2xpZW50TWV0YVt0aGlzLmlkXS5oYW5kbGVycztcbiAgICBpZiAoaGFuZGxlcnMpIHtcbiAgICAgIGlmICh0eXBlb2YgZXZlbnRUeXBlID09PSBcInN0cmluZ1wiICYmIGV2ZW50VHlwZSkge1xuICAgICAgICBjb3B5ID0gaGFuZGxlcnNbZXZlbnRUeXBlXSA/IGhhbmRsZXJzW2V2ZW50VHlwZV0uc2xpY2UoMCkgOiBbXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvcHkgPSBfZGVlcENvcHkoaGFuZGxlcnMpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gY29weTtcbiAgfTtcbiAgLyoqXG4gKiBUaGUgdW5kZXJseWluZyBpbXBsZW1lbnRhdGlvbiBvZiBgWmVyb0NsaXBib2FyZC5DbGllbnQucHJvdG90eXBlLmVtaXRgLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2NsaWVudEVtaXQgPSBmdW5jdGlvbihldmVudCkge1xuICAgIGlmIChfY2xpZW50U2hvdWxkRW1pdC5jYWxsKHRoaXMsIGV2ZW50KSkge1xuICAgICAgaWYgKHR5cGVvZiBldmVudCA9PT0gXCJvYmplY3RcIiAmJiBldmVudCAmJiB0eXBlb2YgZXZlbnQudHlwZSA9PT0gXCJzdHJpbmdcIiAmJiBldmVudC50eXBlKSB7XG4gICAgICAgIGV2ZW50ID0gX2V4dGVuZCh7fSwgZXZlbnQpO1xuICAgICAgfVxuICAgICAgdmFyIGV2ZW50Q29weSA9IF9leHRlbmQoe30sIF9jcmVhdGVFdmVudChldmVudCksIHtcbiAgICAgICAgY2xpZW50OiB0aGlzXG4gICAgICB9KTtcbiAgICAgIF9jbGllbnREaXNwYXRjaENhbGxiYWNrcy5jYWxsKHRoaXMsIGV2ZW50Q29weSk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuICAvKipcbiAqIFRoZSB1bmRlcmx5aW5nIGltcGxlbWVudGF0aW9uIG9mIGBaZXJvQ2xpcGJvYXJkLkNsaWVudC5wcm90b3R5cGUuY2xpcGAuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY2xpZW50Q2xpcCA9IGZ1bmN0aW9uKGVsZW1lbnRzKSB7XG4gICAgaWYgKCFfY2xpZW50TWV0YVt0aGlzLmlkXSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQXR0ZW1wdGVkIHRvIGNsaXAgZWxlbWVudChzKSB0byBhIGRlc3Ryb3llZCBaZXJvQ2xpcGJvYXJkIGNsaWVudCBpbnN0YW5jZVwiKTtcbiAgICB9XG4gICAgZWxlbWVudHMgPSBfcHJlcENsaXAoZWxlbWVudHMpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZWxlbWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChfaGFzT3duLmNhbGwoZWxlbWVudHMsIGkpICYmIGVsZW1lbnRzW2ldICYmIGVsZW1lbnRzW2ldLm5vZGVUeXBlID09PSAxKSB7XG4gICAgICAgIGlmICghZWxlbWVudHNbaV0uemNDbGlwcGluZ0lkKSB7XG4gICAgICAgICAgZWxlbWVudHNbaV0uemNDbGlwcGluZ0lkID0gXCJ6Y0NsaXBwaW5nSWRfXCIgKyBfZWxlbWVudElkQ291bnRlcisrO1xuICAgICAgICAgIF9lbGVtZW50TWV0YVtlbGVtZW50c1tpXS56Y0NsaXBwaW5nSWRdID0gWyB0aGlzLmlkIF07XG4gICAgICAgICAgaWYgKF9nbG9iYWxDb25maWcuYXV0b0FjdGl2YXRlID09PSB0cnVlKSB7XG4gICAgICAgICAgICBfYWRkTW91c2VIYW5kbGVycyhlbGVtZW50c1tpXSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKF9lbGVtZW50TWV0YVtlbGVtZW50c1tpXS56Y0NsaXBwaW5nSWRdLmluZGV4T2YodGhpcy5pZCkgPT09IC0xKSB7XG4gICAgICAgICAgX2VsZW1lbnRNZXRhW2VsZW1lbnRzW2ldLnpjQ2xpcHBpbmdJZF0ucHVzaCh0aGlzLmlkKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY2xpcHBlZEVsZW1lbnRzID0gX2NsaWVudE1ldGFbdGhpcy5pZF0gJiYgX2NsaWVudE1ldGFbdGhpcy5pZF0uZWxlbWVudHM7XG4gICAgICAgIGlmIChjbGlwcGVkRWxlbWVudHMuaW5kZXhPZihlbGVtZW50c1tpXSkgPT09IC0xKSB7XG4gICAgICAgICAgY2xpcHBlZEVsZW1lbnRzLnB1c2goZWxlbWVudHNbaV0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuICAvKipcbiAqIFRoZSB1bmRlcmx5aW5nIGltcGxlbWVudGF0aW9uIG9mIGBaZXJvQ2xpcGJvYXJkLkNsaWVudC5wcm90b3R5cGUudW5jbGlwYC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9jbGllbnRVbmNsaXAgPSBmdW5jdGlvbihlbGVtZW50cykge1xuICAgIHZhciBtZXRhID0gX2NsaWVudE1ldGFbdGhpcy5pZF07XG4gICAgaWYgKCFtZXRhKSB7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgdmFyIGNsaXBwZWRFbGVtZW50cyA9IG1ldGEuZWxlbWVudHM7XG4gICAgdmFyIGFycmF5SW5kZXg7XG4gICAgaWYgKHR5cGVvZiBlbGVtZW50cyA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgZWxlbWVudHMgPSBjbGlwcGVkRWxlbWVudHMuc2xpY2UoMCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGVsZW1lbnRzID0gX3ByZXBDbGlwKGVsZW1lbnRzKTtcbiAgICB9XG4gICAgZm9yICh2YXIgaSA9IGVsZW1lbnRzLmxlbmd0aDsgaS0tOyApIHtcbiAgICAgIGlmIChfaGFzT3duLmNhbGwoZWxlbWVudHMsIGkpICYmIGVsZW1lbnRzW2ldICYmIGVsZW1lbnRzW2ldLm5vZGVUeXBlID09PSAxKSB7XG4gICAgICAgIGFycmF5SW5kZXggPSAwO1xuICAgICAgICB3aGlsZSAoKGFycmF5SW5kZXggPSBjbGlwcGVkRWxlbWVudHMuaW5kZXhPZihlbGVtZW50c1tpXSwgYXJyYXlJbmRleCkpICE9PSAtMSkge1xuICAgICAgICAgIGNsaXBwZWRFbGVtZW50cy5zcGxpY2UoYXJyYXlJbmRleCwgMSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNsaWVudElkcyA9IF9lbGVtZW50TWV0YVtlbGVtZW50c1tpXS56Y0NsaXBwaW5nSWRdO1xuICAgICAgICBpZiAoY2xpZW50SWRzKSB7XG4gICAgICAgICAgYXJyYXlJbmRleCA9IDA7XG4gICAgICAgICAgd2hpbGUgKChhcnJheUluZGV4ID0gY2xpZW50SWRzLmluZGV4T2YodGhpcy5pZCwgYXJyYXlJbmRleCkpICE9PSAtMSkge1xuICAgICAgICAgICAgY2xpZW50SWRzLnNwbGljZShhcnJheUluZGV4LCAxKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGNsaWVudElkcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIGlmIChfZ2xvYmFsQ29uZmlnLmF1dG9BY3RpdmF0ZSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICBfcmVtb3ZlTW91c2VIYW5kbGVycyhlbGVtZW50c1tpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkZWxldGUgZWxlbWVudHNbaV0uemNDbGlwcGluZ0lkO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcbiAgLyoqXG4gKiBUaGUgdW5kZXJseWluZyBpbXBsZW1lbnRhdGlvbiBvZiBgWmVyb0NsaXBib2FyZC5DbGllbnQucHJvdG90eXBlLmVsZW1lbnRzYC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9jbGllbnRFbGVtZW50cyA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBtZXRhID0gX2NsaWVudE1ldGFbdGhpcy5pZF07XG4gICAgcmV0dXJuIG1ldGEgJiYgbWV0YS5lbGVtZW50cyA/IG1ldGEuZWxlbWVudHMuc2xpY2UoMCkgOiBbXTtcbiAgfTtcbiAgLyoqXG4gKiBUaGUgdW5kZXJseWluZyBpbXBsZW1lbnRhdGlvbiBvZiBgWmVyb0NsaXBib2FyZC5DbGllbnQucHJvdG90eXBlLmRlc3Ryb3lgLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2NsaWVudERlc3Ryb3kgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAoIV9jbGllbnRNZXRhW3RoaXMuaWRdKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMudW5jbGlwKCk7XG4gICAgdGhpcy5vZmYoKTtcbiAgICBkZWxldGUgX2NsaWVudE1ldGFbdGhpcy5pZF07XG4gIH07XG4gIC8qKlxuICogSW5zcGVjdCBhbiBFdmVudCB0byBzZWUgaWYgdGhlIENsaWVudCAoYHRoaXNgKSBzaG91bGQgaG9ub3IgaXQgZm9yIGVtaXNzaW9uLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2NsaWVudFNob3VsZEVtaXQgPSBmdW5jdGlvbihldmVudCkge1xuICAgIGlmICghKGV2ZW50ICYmIGV2ZW50LnR5cGUpKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmIChldmVudC5jbGllbnQgJiYgZXZlbnQuY2xpZW50ICE9PSB0aGlzKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBtZXRhID0gX2NsaWVudE1ldGFbdGhpcy5pZF07XG4gICAgdmFyIGNsaXBwZWRFbHMgPSBtZXRhICYmIG1ldGEuZWxlbWVudHM7XG4gICAgdmFyIGhhc0NsaXBwZWRFbHMgPSAhIWNsaXBwZWRFbHMgJiYgY2xpcHBlZEVscy5sZW5ndGggPiAwO1xuICAgIHZhciBnb29kVGFyZ2V0ID0gIWV2ZW50LnRhcmdldCB8fCBoYXNDbGlwcGVkRWxzICYmIGNsaXBwZWRFbHMuaW5kZXhPZihldmVudC50YXJnZXQpICE9PSAtMTtcbiAgICB2YXIgZ29vZFJlbFRhcmdldCA9IGV2ZW50LnJlbGF0ZWRUYXJnZXQgJiYgaGFzQ2xpcHBlZEVscyAmJiBjbGlwcGVkRWxzLmluZGV4T2YoZXZlbnQucmVsYXRlZFRhcmdldCkgIT09IC0xO1xuICAgIHZhciBnb29kQ2xpZW50ID0gZXZlbnQuY2xpZW50ICYmIGV2ZW50LmNsaWVudCA9PT0gdGhpcztcbiAgICBpZiAoIW1ldGEgfHwgIShnb29kVGFyZ2V0IHx8IGdvb2RSZWxUYXJnZXQgfHwgZ29vZENsaWVudCkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH07XG4gIC8qKlxuICogSGFuZGxlIHRoZSBhY3R1YWwgZGlzcGF0Y2hpbmcgb2YgZXZlbnRzIHRvIGEgY2xpZW50IGluc3RhbmNlLlxuICpcbiAqIEByZXR1cm5zIGB1bmRlZmluZWRgXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY2xpZW50RGlzcGF0Y2hDYWxsYmFja3MgPSBmdW5jdGlvbihldmVudCkge1xuICAgIHZhciBtZXRhID0gX2NsaWVudE1ldGFbdGhpcy5pZF07XG4gICAgaWYgKCEodHlwZW9mIGV2ZW50ID09PSBcIm9iamVjdFwiICYmIGV2ZW50ICYmIGV2ZW50LnR5cGUgJiYgbWV0YSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIGFzeW5jID0gX3Nob3VsZFBlcmZvcm1Bc3luYyhldmVudCk7XG4gICAgdmFyIHdpbGRjYXJkVHlwZUhhbmRsZXJzID0gbWV0YSAmJiBtZXRhLmhhbmRsZXJzW1wiKlwiXSB8fCBbXTtcbiAgICB2YXIgc3BlY2lmaWNUeXBlSGFuZGxlcnMgPSBtZXRhICYmIG1ldGEuaGFuZGxlcnNbZXZlbnQudHlwZV0gfHwgW107XG4gICAgdmFyIGhhbmRsZXJzID0gd2lsZGNhcmRUeXBlSGFuZGxlcnMuY29uY2F0KHNwZWNpZmljVHlwZUhhbmRsZXJzKTtcbiAgICBpZiAoaGFuZGxlcnMgJiYgaGFuZGxlcnMubGVuZ3RoKSB7XG4gICAgICB2YXIgaSwgbGVuLCBmdW5jLCBjb250ZXh0LCBldmVudENvcHksIG9yaWdpbmFsQ29udGV4dCA9IHRoaXM7XG4gICAgICBmb3IgKGkgPSAwLCBsZW4gPSBoYW5kbGVycy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBmdW5jID0gaGFuZGxlcnNbaV07XG4gICAgICAgIGNvbnRleHQgPSBvcmlnaW5hbENvbnRleHQ7XG4gICAgICAgIGlmICh0eXBlb2YgZnVuYyA9PT0gXCJzdHJpbmdcIiAmJiB0eXBlb2YgX3dpbmRvd1tmdW5jXSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgZnVuYyA9IF93aW5kb3dbZnVuY107XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBmdW5jID09PSBcIm9iamVjdFwiICYmIGZ1bmMgJiYgdHlwZW9mIGZ1bmMuaGFuZGxlRXZlbnQgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgIGNvbnRleHQgPSBmdW5jO1xuICAgICAgICAgIGZ1bmMgPSBmdW5jLmhhbmRsZUV2ZW50O1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgZnVuYyA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgZXZlbnRDb3B5ID0gX2V4dGVuZCh7fSwgZXZlbnQpO1xuICAgICAgICAgIF9kaXNwYXRjaENhbGxiYWNrKGZ1bmMsIGNvbnRleHQsIFsgZXZlbnRDb3B5IF0sIGFzeW5jKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfTtcbiAgLyoqXG4gKiBQcmVwYXJlcyB0aGUgZWxlbWVudHMgZm9yIGNsaXBwaW5nL3VuY2xpcHBpbmcuXG4gKlxuICogQHJldHVybnMgQW4gQXJyYXkgb2YgZWxlbWVudHMuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfcHJlcENsaXAgPSBmdW5jdGlvbihlbGVtZW50cykge1xuICAgIGlmICh0eXBlb2YgZWxlbWVudHMgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgIGVsZW1lbnRzID0gW107XG4gICAgfVxuICAgIHJldHVybiB0eXBlb2YgZWxlbWVudHMubGVuZ3RoICE9PSBcIm51bWJlclwiID8gWyBlbGVtZW50cyBdIDogZWxlbWVudHM7XG4gIH07XG4gIC8qKlxuICogQWRkIGEgYG1vdXNlb3ZlcmAgaGFuZGxlciBmdW5jdGlvbiBmb3IgYSBjbGlwcGVkIGVsZW1lbnQuXG4gKlxuICogQHJldHVybnMgYHVuZGVmaW5lZGBcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9hZGRNb3VzZUhhbmRsZXJzID0gZnVuY3Rpb24oZWxlbWVudCkge1xuICAgIGlmICghKGVsZW1lbnQgJiYgZWxlbWVudC5ub2RlVHlwZSA9PT0gMSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIF9zdXBwcmVzc01vdXNlRXZlbnRzID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIGlmICghKGV2ZW50IHx8IChldmVudCA9IF93aW5kb3cuZXZlbnQpKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAoZXZlbnQuX3NvdXJjZSAhPT0gXCJqc1wiKSB7XG4gICAgICAgIGV2ZW50LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgfVxuICAgICAgZGVsZXRlIGV2ZW50Ll9zb3VyY2U7XG4gICAgfTtcbiAgICB2YXIgX2VsZW1lbnRNb3VzZU92ZXIgPSBmdW5jdGlvbihldmVudCkge1xuICAgICAgaWYgKCEoZXZlbnQgfHwgKGV2ZW50ID0gX3dpbmRvdy5ldmVudCkpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIF9zdXBwcmVzc01vdXNlRXZlbnRzKGV2ZW50KTtcbiAgICAgIFplcm9DbGlwYm9hcmQuZm9jdXMoZWxlbWVudCk7XG4gICAgfTtcbiAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW92ZXJcIiwgX2VsZW1lbnRNb3VzZU92ZXIsIGZhbHNlKTtcbiAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW91dFwiLCBfc3VwcHJlc3NNb3VzZUV2ZW50cywgZmFsc2UpO1xuICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZW50ZXJcIiwgX3N1cHByZXNzTW91c2VFdmVudHMsIGZhbHNlKTtcbiAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWxlYXZlXCIsIF9zdXBwcmVzc01vdXNlRXZlbnRzLCBmYWxzZSk7XG4gICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIF9zdXBwcmVzc01vdXNlRXZlbnRzLCBmYWxzZSk7XG4gICAgX21vdXNlSGFuZGxlcnNbZWxlbWVudC56Y0NsaXBwaW5nSWRdID0ge1xuICAgICAgbW91c2VvdmVyOiBfZWxlbWVudE1vdXNlT3ZlcixcbiAgICAgIG1vdXNlb3V0OiBfc3VwcHJlc3NNb3VzZUV2ZW50cyxcbiAgICAgIG1vdXNlZW50ZXI6IF9zdXBwcmVzc01vdXNlRXZlbnRzLFxuICAgICAgbW91c2VsZWF2ZTogX3N1cHByZXNzTW91c2VFdmVudHMsXG4gICAgICBtb3VzZW1vdmU6IF9zdXBwcmVzc01vdXNlRXZlbnRzXG4gICAgfTtcbiAgfTtcbiAgLyoqXG4gKiBSZW1vdmUgYSBgbW91c2VvdmVyYCBoYW5kbGVyIGZ1bmN0aW9uIGZvciBhIGNsaXBwZWQgZWxlbWVudC5cbiAqXG4gKiBAcmV0dXJucyBgdW5kZWZpbmVkYFxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX3JlbW92ZU1vdXNlSGFuZGxlcnMgPSBmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgaWYgKCEoZWxlbWVudCAmJiBlbGVtZW50Lm5vZGVUeXBlID09PSAxKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgbW91c2VIYW5kbGVycyA9IF9tb3VzZUhhbmRsZXJzW2VsZW1lbnQuemNDbGlwcGluZ0lkXTtcbiAgICBpZiAoISh0eXBlb2YgbW91c2VIYW5kbGVycyA9PT0gXCJvYmplY3RcIiAmJiBtb3VzZUhhbmRsZXJzKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIga2V5LCB2YWwsIG1vdXNlRXZlbnRzID0gWyBcIm1vdmVcIiwgXCJsZWF2ZVwiLCBcImVudGVyXCIsIFwib3V0XCIsIFwib3ZlclwiIF07XG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IG1vdXNlRXZlbnRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICBrZXkgPSBcIm1vdXNlXCIgKyBtb3VzZUV2ZW50c1tpXTtcbiAgICAgIHZhbCA9IG1vdXNlSGFuZGxlcnNba2V5XTtcbiAgICAgIGlmICh0eXBlb2YgdmFsID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKGtleSwgdmFsLCBmYWxzZSk7XG4gICAgICB9XG4gICAgfVxuICAgIGRlbGV0ZSBfbW91c2VIYW5kbGVyc1tlbGVtZW50LnpjQ2xpcHBpbmdJZF07XG4gIH07XG4gIC8qKlxuICogQ3JlYXRlcyBhIG5ldyBaZXJvQ2xpcGJvYXJkIGNsaWVudCBpbnN0YW5jZS5cbiAqIE9wdGlvbmFsbHksIGF1dG8tYGNsaXBgIGFuIGVsZW1lbnQgb3IgY29sbGVjdGlvbiBvZiBlbGVtZW50cy5cbiAqXG4gKiBAY29uc3RydWN0b3JcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLl9jcmVhdGVDbGllbnQgPSBmdW5jdGlvbigpIHtcbiAgICBfY2xpZW50Q29uc3RydWN0b3IuYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gIH07XG4gIC8qKlxuICogUmVnaXN0ZXIgYW4gZXZlbnQgbGlzdGVuZXIgdG8gdGhlIGNsaWVudC5cbiAqXG4gKiBAcmV0dXJucyBgdGhpc2BcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLnByb3RvdHlwZS5vbiA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfY2xpZW50T24uYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gIH07XG4gIC8qKlxuICogVW5yZWdpc3RlciBhbiBldmVudCBoYW5kbGVyIGZyb20gdGhlIGNsaWVudC5cbiAqIElmIG5vIGBsaXN0ZW5lcmAgZnVuY3Rpb24vb2JqZWN0IGlzIHByb3ZpZGVkLCBpdCB3aWxsIHVucmVnaXN0ZXIgYWxsIGhhbmRsZXJzIGZvciB0aGUgcHJvdmlkZWQgYGV2ZW50VHlwZWAuXG4gKiBJZiBubyBgZXZlbnRUeXBlYCBpcyBwcm92aWRlZCwgaXQgd2lsbCB1bnJlZ2lzdGVyIGFsbCBoYW5kbGVycyBmb3IgZXZlcnkgZXZlbnQgdHlwZS5cbiAqXG4gKiBAcmV0dXJucyBgdGhpc2BcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLnByb3RvdHlwZS5vZmYgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX2NsaWVudE9mZi5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBSZXRyaWV2ZSBldmVudCBsaXN0ZW5lcnMgZm9yIGFuIGBldmVudFR5cGVgIGZyb20gdGhlIGNsaWVudC5cbiAqIElmIG5vIGBldmVudFR5cGVgIGlzIHByb3ZpZGVkLCBpdCB3aWxsIHJldHJpZXZlIGFsbCBsaXN0ZW5lcnMgZm9yIGV2ZXJ5IGV2ZW50IHR5cGUuXG4gKlxuICogQHJldHVybnMgYXJyYXkgb2YgbGlzdGVuZXJzIGZvciB0aGUgYGV2ZW50VHlwZWA7IGlmIG5vIGBldmVudFR5cGVgLCB0aGVuIGEgbWFwL2hhc2ggb2JqZWN0IG9mIGxpc3RlbmVycyBmb3IgYWxsIGV2ZW50IHR5cGVzOyBvciBgbnVsbGBcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLnByb3RvdHlwZS5oYW5kbGVycyA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfY2xpZW50TGlzdGVuZXJzLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIEV2ZW50IGVtaXNzaW9uIHJlY2VpdmVyIGZyb20gdGhlIEZsYXNoIG9iamVjdCBmb3IgdGhpcyBjbGllbnQncyByZWdpc3RlcmVkIEphdmFTY3JpcHQgZXZlbnQgbGlzdGVuZXJzLlxuICpcbiAqIEByZXR1cm5zIEZvciB0aGUgXCJjb3B5XCIgZXZlbnQsIHJldHVybnMgdGhlIEZsYXNoLWZyaWVuZGx5IFwiY2xpcERhdGFcIiBvYmplY3Q7IG90aGVyd2lzZSBgdW5kZWZpbmVkYC5cbiAqL1xuICBaZXJvQ2xpcGJvYXJkLnByb3RvdHlwZS5lbWl0ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIF9jbGllbnRFbWl0LmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIFJlZ2lzdGVyIGNsaXBib2FyZCBhY3Rpb25zIGZvciBuZXcgZWxlbWVudChzKSB0byB0aGUgY2xpZW50LlxuICpcbiAqIEByZXR1cm5zIGB0aGlzYFxuICovXG4gIFplcm9DbGlwYm9hcmQucHJvdG90eXBlLmNsaXAgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX2NsaWVudENsaXAuYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gIH07XG4gIC8qKlxuICogVW5yZWdpc3RlciB0aGUgY2xpcGJvYXJkIGFjdGlvbnMgb2YgcHJldmlvdXNseSByZWdpc3RlcmVkIGVsZW1lbnQocykgb24gdGhlIHBhZ2UuXG4gKiBJZiBubyBlbGVtZW50cyBhcmUgcHJvdmlkZWQsIEFMTCByZWdpc3RlcmVkIGVsZW1lbnRzIHdpbGwgYmUgdW5yZWdpc3RlcmVkLlxuICpcbiAqIEByZXR1cm5zIGB0aGlzYFxuICovXG4gIFplcm9DbGlwYm9hcmQucHJvdG90eXBlLnVuY2xpcCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfY2xpZW50VW5jbGlwLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIEdldCBhbGwgb2YgdGhlIGVsZW1lbnRzIHRvIHdoaWNoIHRoaXMgY2xpZW50IGlzIGNsaXBwZWQuXG4gKlxuICogQHJldHVybnMgYXJyYXkgb2YgY2xpcHBlZCBlbGVtZW50c1xuICovXG4gIFplcm9DbGlwYm9hcmQucHJvdG90eXBlLmVsZW1lbnRzID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIF9jbGllbnRFbGVtZW50cy5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBTZWxmLWRlc3RydWN0IGFuZCBjbGVhbiB1cCBldmVyeXRoaW5nIGZvciBhIHNpbmdsZSBjbGllbnQuXG4gKiBUaGlzIHdpbGwgTk9UIGRlc3Ryb3kgdGhlIGVtYmVkZGVkIEZsYXNoIG9iamVjdC5cbiAqXG4gKiBAcmV0dXJucyBgdW5kZWZpbmVkYFxuICovXG4gIFplcm9DbGlwYm9hcmQucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX2NsaWVudERlc3Ryb3kuYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gIH07XG4gIC8qKlxuICogU3RvcmVzIHRoZSBwZW5kaW5nIHBsYWluIHRleHQgdG8gaW5qZWN0IGludG8gdGhlIGNsaXBib2FyZC5cbiAqXG4gKiBAcmV0dXJucyBgdGhpc2BcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLnByb3RvdHlwZS5zZXRUZXh0ID0gZnVuY3Rpb24odGV4dCkge1xuICAgIGlmICghX2NsaWVudE1ldGFbdGhpcy5pZF0pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkF0dGVtcHRlZCB0byBzZXQgcGVuZGluZyBjbGlwYm9hcmQgZGF0YSBmcm9tIGEgZGVzdHJveWVkIFplcm9DbGlwYm9hcmQgY2xpZW50IGluc3RhbmNlXCIpO1xuICAgIH1cbiAgICBaZXJvQ2xpcGJvYXJkLnNldERhdGEoXCJ0ZXh0L3BsYWluXCIsIHRleHQpO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuICAvKipcbiAqIFN0b3JlcyB0aGUgcGVuZGluZyBIVE1MIHRleHQgdG8gaW5qZWN0IGludG8gdGhlIGNsaXBib2FyZC5cbiAqXG4gKiBAcmV0dXJucyBgdGhpc2BcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLnByb3RvdHlwZS5zZXRIdG1sID0gZnVuY3Rpb24oaHRtbCkge1xuICAgIGlmICghX2NsaWVudE1ldGFbdGhpcy5pZF0pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkF0dGVtcHRlZCB0byBzZXQgcGVuZGluZyBjbGlwYm9hcmQgZGF0YSBmcm9tIGEgZGVzdHJveWVkIFplcm9DbGlwYm9hcmQgY2xpZW50IGluc3RhbmNlXCIpO1xuICAgIH1cbiAgICBaZXJvQ2xpcGJvYXJkLnNldERhdGEoXCJ0ZXh0L2h0bWxcIiwgaHRtbCk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG4gIC8qKlxuICogU3RvcmVzIHRoZSBwZW5kaW5nIHJpY2ggdGV4dCAoUlRGKSB0byBpbmplY3QgaW50byB0aGUgY2xpcGJvYXJkLlxuICpcbiAqIEByZXR1cm5zIGB0aGlzYFxuICovXG4gIFplcm9DbGlwYm9hcmQucHJvdG90eXBlLnNldFJpY2hUZXh0ID0gZnVuY3Rpb24ocmljaFRleHQpIHtcbiAgICBpZiAoIV9jbGllbnRNZXRhW3RoaXMuaWRdKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBdHRlbXB0ZWQgdG8gc2V0IHBlbmRpbmcgY2xpcGJvYXJkIGRhdGEgZnJvbSBhIGRlc3Ryb3llZCBaZXJvQ2xpcGJvYXJkIGNsaWVudCBpbnN0YW5jZVwiKTtcbiAgICB9XG4gICAgWmVyb0NsaXBib2FyZC5zZXREYXRhKFwiYXBwbGljYXRpb24vcnRmXCIsIHJpY2hUZXh0KTtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcbiAgLyoqXG4gKiBTdG9yZXMgdGhlIHBlbmRpbmcgZGF0YSB0byBpbmplY3QgaW50byB0aGUgY2xpcGJvYXJkLlxuICpcbiAqIEByZXR1cm5zIGB0aGlzYFxuICovXG4gIFplcm9DbGlwYm9hcmQucHJvdG90eXBlLnNldERhdGEgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAoIV9jbGllbnRNZXRhW3RoaXMuaWRdKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBdHRlbXB0ZWQgdG8gc2V0IHBlbmRpbmcgY2xpcGJvYXJkIGRhdGEgZnJvbSBhIGRlc3Ryb3llZCBaZXJvQ2xpcGJvYXJkIGNsaWVudCBpbnN0YW5jZVwiKTtcbiAgICB9XG4gICAgWmVyb0NsaXBib2FyZC5zZXREYXRhLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuICAvKipcbiAqIENsZWFycyB0aGUgcGVuZGluZyBkYXRhIHRvIGluamVjdCBpbnRvIHRoZSBjbGlwYm9hcmQuXG4gKiBJZiBubyBgZm9ybWF0YCBpcyBwcm92aWRlZCwgYWxsIHBlbmRpbmcgZGF0YSBmb3JtYXRzIHdpbGwgYmUgY2xlYXJlZC5cbiAqXG4gKiBAcmV0dXJucyBgdGhpc2BcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLnByb3RvdHlwZS5jbGVhckRhdGEgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAoIV9jbGllbnRNZXRhW3RoaXMuaWRdKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBdHRlbXB0ZWQgdG8gY2xlYXIgcGVuZGluZyBjbGlwYm9hcmQgZGF0YSBmcm9tIGEgZGVzdHJveWVkIFplcm9DbGlwYm9hcmQgY2xpZW50IGluc3RhbmNlXCIpO1xuICAgIH1cbiAgICBaZXJvQ2xpcGJvYXJkLmNsZWFyRGF0YS5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcbiAgLyoqXG4gKiBHZXRzIGEgY29weSBvZiB0aGUgcGVuZGluZyBkYXRhIHRvIGluamVjdCBpbnRvIHRoZSBjbGlwYm9hcmQuXG4gKiBJZiBubyBgZm9ybWF0YCBpcyBwcm92aWRlZCwgYSBjb3B5IG9mIEFMTCBwZW5kaW5nIGRhdGEgZm9ybWF0cyB3aWxsIGJlIHJldHVybmVkLlxuICpcbiAqIEByZXR1cm5zIGBTdHJpbmdgIG9yIGBPYmplY3RgXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5wcm90b3R5cGUuZ2V0RGF0YSA9IGZ1bmN0aW9uKCkge1xuICAgIGlmICghX2NsaWVudE1ldGFbdGhpcy5pZF0pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkF0dGVtcHRlZCB0byBnZXQgcGVuZGluZyBjbGlwYm9hcmQgZGF0YSBmcm9tIGEgZGVzdHJveWVkIFplcm9DbGlwYm9hcmQgY2xpZW50IGluc3RhbmNlXCIpO1xuICAgIH1cbiAgICByZXR1cm4gWmVyb0NsaXBib2FyZC5nZXREYXRhLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICBpZiAodHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQpIHtcbiAgICBkZWZpbmUoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gWmVyb0NsaXBib2FyZDtcbiAgICB9KTtcbiAgfSBlbHNlIGlmICh0eXBlb2YgbW9kdWxlID09PSBcIm9iamVjdFwiICYmIG1vZHVsZSAmJiB0eXBlb2YgbW9kdWxlLmV4cG9ydHMgPT09IFwib2JqZWN0XCIgJiYgbW9kdWxlLmV4cG9ydHMpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IFplcm9DbGlwYm9hcmQ7XG4gIH0gZWxzZSB7XG4gICAgd2luZG93Llplcm9DbGlwYm9hcmQgPSBaZXJvQ2xpcGJvYXJkO1xuICB9XG59KShmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHRoaXMgfHwgd2luZG93O1xufSgpKTsiLCIvKmpzbGludCBicm93c2VyOiB0cnVlKi9cclxuLypqc2hpbnQgLVcwNTUgKi9cclxuLypnbG9iYWwgY29uc29sZSwgYWxlcnQqL1xyXG5cclxuLypcclxuICogRm9yIGVhY2ggZGlzZWFzZSBhcmVhIHRoZXJlIHdpbGwgYmUgNCBzdGFnZXM6IERpYWdub3NpcywgTW9uaXRvcmluZywgVHJlYXRtZW50IGFuZCBFeGNsdXNpb25zLlxyXG4gKiBFYWNoIHN0YWdlIGdldHMgYSBzaW5nbGUgcGFuZWwgb24gdGhlIGZyb250IHNjcmVlbi5cclxuICogQ2xpY2tpbmcgb24gYSBwYW5lbCB0YWtlcyB5b3UgdG8gYSBzY3JlZW4gc3BlY2lmaWMgdG8gdGhhdCBzdGFnZSwgYnV0IHNpbWlsYXIgaW4gbGF5b3V0IGFuZCBjb250ZW50XHJcbiAqICB0byBhbGwgdGhlIG90aGVycy5cclxuICovXHJcblxyXG52YXIgdGVtcGxhdGUgPSByZXF1aXJlKCcuL3NyYy90ZW1wbGF0ZS5qcycpLFxyXG4gIG1haW4gPSByZXF1aXJlKCcuL3NyYy9tYWluLmpzJyk7XHJcblxyXG4vL1RPRE8gbm90IHN1cmUgd2h5IGkgZGlkIHRoaXMgLSB3YXMgaW4gbG9jYWwgdmFyaWFibGVcclxuLy9tYXliZSBhIHNlcGFyYXRlIG1vZHVsZVxyXG4vL3dpbmRvdy5sb2NhdGlvbiA9IHdpbmRvdy5oaXN0b3J5LmxvY2F0aW9uIHx8IHdpbmRvdy5sb2NhdGlvbjtcclxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbiAqKiogU2hvd3MgdGhlIHByZS1sb2FkIGltYWdlIGFuZCBzbG93bHkgZmFkZXMgaXQgb3V0LiAqKipcclxuICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xyXG4kKHdpbmRvdykubG9hZChmdW5jdGlvbigpIHtcclxuICAkKCcubG9hZGluZy1jb250YWluZXInKS5mYWRlT3V0KDEwMDAsIGZ1bmN0aW9uKCkge1xyXG4gICAgLy8kKHRoaXMpLnJlbW92ZSgpO1xyXG4gIH0pO1xyXG59KTtcclxuXHJcbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuICoqKiBUaGlzIGhhcHBlbnMgd2hlbiB0aGUgcGFnZSBpcyByZWFkeSAqKipcclxuICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cclxuJChkb2N1bWVudCkub24oJ3JlYWR5JywgZnVuY3Rpb24oKSB7XHJcbiAgLy9HcmFiIHRoZSBoYXNoIGlmIGV4aXN0cyAtIElFIHNlZW1zIHRvIGZvcmdldCBpdFxyXG4gIG1haW4uaGFzaCA9IGxvY2F0aW9uLmhhc2g7XHJcblxyXG4gIC8vQ0hBTkdFIFRISVMgLSBhZGRlZCB0byBzcG9vZiBsb2dpblxyXG4gIGxvY2F0aW9uLmhhc2g9XCJcIjtcclxuICBtYWluLmhhc2g9XCJcIjtcclxuICAkKCcjc2lnbmluJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKXtcclxuICAgIGlmKCQoJyNpbnBFbWFpbCcpLnZhbCgpLmxlbmd0aDw4KSBhbGVydChcIlBsZWFzZSBlbnRlciB5b3VyIGVtYWlsIGFkZHJlc3MuXCIpO1xyXG4gICAgZWxzZSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCd7XCJldmVudFwiOntcIndoYXRcIjpcImxvZ2luXCIsXCJ3aGVuXCI6JyArIG5ldyBEYXRlKCkuZ2V0VGltZSgpICsgJyxcIndob1wiOlwiJyArICQoXCIjaW5wRW1haWxcIikudmFsKCkgKyAnXCJ9fScpO1xyXG4gICAgICAkLmFqYXgoe1xyXG4gICAgICAgIHR5cGU6IFwiUE9TVFwiLFxyXG4gICAgICAgIHVybDogXCJodHRwOi8vMTMwLjg4LjI1MC4yMDY6OTEwMC9waW5nclwiLFxyXG4gICAgICAgIGRhdGE6ICd7XCJldmVudFwiOntcIndoYXRcIjpcImxvZ2luXCIsXCJ3aGVuXCI6JyArIG5ldyBEYXRlKCkuZ2V0VGltZSgpICsgJyxcIndob1wiOlwiJyArICQoXCIjaW5wRW1haWxcIikudmFsKCkgKyAnXCJ9fScsXHJcbiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24oZCl7Y29uc29sZS5sb2coZCk7fSxcclxuICAgICAgICBkYXRhVHlwZTogXCJqc29uXCIsXHJcbiAgICAgICAgY29udGVudFR5cGU6XCJhcHBsaWNhdGlvbi9qc29uXCJcclxuICAgICAgfSk7XHJcblxyXG4gICAgICB2YXIgb2JqID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuYmIpO1xyXG4gICAgICBvYmouZW1haWw9JCgnI2lucEVtYWlsJykudmFsKCk7XHJcbiAgICAgIGxvY2FsU3RvcmFnZS5iYiA9IEpTT04uc3RyaW5naWZ5KG9iaik7XHJcblxyXG5cclxuICAgICAgaGlzdG9yeS5wdXNoU3RhdGUobnVsbCwgbnVsbCwgJyNvdmVydmlldycpO1xyXG4gICAgICB0ZW1wbGF0ZS5sb2FkQ29udGVudCgnI292ZXJ2aWV3Jyk7XHJcbiAgICB9XHJcbiAgfSk7XHJcbiAgJCgnI2lucEVtYWlsJykub24oJ2tleXVwJywgZnVuY3Rpb24oKXtcclxuICAgIHZhciBjb2RlID0gZS53aGljaDtcclxuICAgIGlmKGNvZGU9PTEzKXtcclxuICAgICAgJCgnI3NpZ25pbicpLmNsaWNrKCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIC8vTG9hZCB0aGUgZGF0YSB0aGVuIHdpcmUgdXAgdGhlIGV2ZW50cyBvbiB0aGUgcGFnZVxyXG4gIG1haW4uaW5pdCgpO1xyXG5cclxuICAvL1NvcnRzIG91dCB0aGUgZGF0YSBoZWxkIGxvY2FsbHkgaW4gdGhlIHVzZXIncyBicm93c2VyXHJcbiAgaWYgKCFsb2NhbFN0b3JhZ2UuYmIpIGxvY2FsU3RvcmFnZS5iYiA9IEpTT04uc3RyaW5naWZ5KHt9KTtcclxuICB2YXIgb2JqID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuYmIpO1xyXG4gIGlmICghb2JqLnZlcnNpb24gfHwgb2JqLnZlcnNpb24gIT09IG1haW4udmVyc2lvbikge1xyXG4gICAgbG9jYWxTdG9yYWdlLmJiID0gSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICBcInZlcnNpb25cIjogbWFpbi52ZXJzaW9uXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGlmKEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmJiKS5lbWFpbCkge1xyXG4gICAgJCgnI2lucEVtYWlsJykudmFsKEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmJiKS5lbWFpbCk7XHJcbiAgfVxyXG5cclxuICAkKCdbZGF0YS10b2dnbGU9XCJ0b29sdGlwXCJdJykudG9vbHRpcCh7XHJcbiAgICBjb250YWluZXI6ICdib2R5JyxcclxuICAgIGRlbGF5OiB7XHJcbiAgICAgIFwic2hvd1wiOiA1MDAsXHJcbiAgICAgIFwiaGlkZVwiOiAxMDBcclxuICAgIH0sXHJcbiAgICBodG1sOiB0cnVlXHJcbiAgfSk7XHJcbiAgJCgnW2RhdGEtdG9nZ2xlPVwibG9uZS10b29sdGlwXCJdJykudG9vbHRpcCh7XHJcbiAgICBjb250YWluZXI6ICdib2R5JyxcclxuICAgIGRlbGF5OiB7XHJcbiAgICAgIFwic2hvd1wiOiAzMDAsXHJcbiAgICAgIFwiaGlkZVwiOiAxMDBcclxuICAgIH1cclxuICB9KTtcclxuICAkKCdbZGF0YS10b2dnbGU9XCJsb25lLXRvb2x0aXBcIl0nKS5vbignc2hvd24uYnMudG9vbHRpcCcsIGZ1bmN0aW9uKGUpIHtcclxuICAgICQoJ1tkYXRhLXRvZ2dsZT1cInRvb2x0aXBcIl0nKS5ub3QodGhpcykudG9vbHRpcCgnaGlkZScpO1xyXG4gIH0pO1xyXG5cclxuICAvL2Vuc3VyZSBvbiBmaXJzdCBsb2FkIHRoZSBsb2dpbiBzY3JlZW4gaXMgY2FjaGVkIHRvIHRoZSBoaXN0b3J5XHJcbiAgaGlzdG9yeS5wdXNoU3RhdGUobnVsbCwgbnVsbCwgJycpO1xyXG59KTtcclxuIiwidmFyIGRhdGEgPSByZXF1aXJlKCcuL2RhdGEuanMnKSxcclxuICBsb29rdXAgPSByZXF1aXJlKCcuL2xvb2t1cC5qcycpLFxyXG4gIGNoYXJ0ID0gcmVxdWlyZSgnLi9jaGFydC5qcycpLFxyXG4gIGxvZyA9IHJlcXVpcmUoJy4vbG9nLmpzJyksXHJcbiAgTXVzdGFjaGUgPSByZXF1aXJlKCdtdXN0YWNoZScpLFxyXG4gIFplcm9DbGlwYm9hcmQgPSByZXF1aXJlKCd6ZXJvY2xpcGJvYXJkJyk7XHJcblxyXG52YXIgYmFzZSA9IHtcclxuXHJcbiAgLy9vYmplY3QgZm9yIGtlZXBpbmcgdHJhY2sgd2hhdCBpcyBpbiBlYWNoIHBhbmVsIHRvIHByZXZlbnQgdW5uZWNlc3NhcnkgcmVkcmF3c1xyXG4gIHBhbmVsczoge30sXHJcblxyXG4gIHNlbGVjdFRhYjogZnVuY3Rpb24oaWQpIHtcclxuICAgIHZhciBocmVmID0gJCgnI21haW5UYWIgbGkuYWN0aXZlIGEnKS5kYXRhKFwiaHJlZlwiKTtcclxuICAgICQoJyNtYWluVGFiIGxpLmFjdGl2ZScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKS5maW5kKCdhJykuYXR0cihcImhyZWZcIiwgaHJlZik7XHJcbiAgICAkKCcjbWFpblRhYiBsaVtkYXRhLWlkPVwiJyArIGlkICsgJ1wiXScpLmFkZENsYXNzKCdhY3RpdmUnKS5maW5kKCdhJykucmVtb3ZlQXR0cihcImhyZWZcIik7XHJcbiAgfSxcclxuXHJcbiAgY3JlYXRlUGFuZWw6IGZ1bmN0aW9uKHRlbXBsYXRlU2VsZWN0b3IsIGRhdGEsIHRlbXBsYXRlcykge1xyXG4gICAgdmFyIHRlbXBNdXN0ID0gdGVtcGxhdGVTZWxlY3Rvci5odG1sKCk7XHJcbiAgICBNdXN0YWNoZS5wYXJzZSh0ZW1wTXVzdCk7IC8vIG9wdGlvbmFsLCBzcGVlZHMgdXAgZnV0dXJlIHVzZXNcclxuICAgIGlmICh0ZW1wbGF0ZXMpIHtcclxuICAgICAgZm9yICh2YXIgbyBpbiB0ZW1wbGF0ZXMpIHtcclxuICAgICAgICBpZiAodGVtcGxhdGVzLmhhc093blByb3BlcnR5KG8pKSB7XHJcbiAgICAgICAgICBNdXN0YWNoZS5wYXJzZSh0ZW1wbGF0ZXNbb10pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgdmFyIHJlbmRlcmVkID0gTXVzdGFjaGUucmVuZGVyKHRlbXBNdXN0LCBkYXRhLCB0ZW1wbGF0ZXMpO1xyXG4gICAgcmV0dXJuIHJlbmRlcmVkO1xyXG4gIH0sXHJcblxyXG4gIGNyZWF0ZVBhbmVsU2hvdzogZnVuY3Rpb24odGVtcGxhdGVTZWxlY3RvciwgcGFuZWxTZWxlY3RvciwgZGF0YSwgdGVtcGxhdGVzKSB7XHJcbiAgICB2YXIgcmVuZGVyZWQgPSBiYXNlLmNyZWF0ZVBhbmVsKHRlbXBsYXRlU2VsZWN0b3IsIGRhdGEsIHRlbXBsYXRlcyk7XHJcbiAgICBwYW5lbFNlbGVjdG9yLmh0bWwocmVuZGVyZWQpLnNob3coKTtcclxuICB9LFxyXG5cclxuICBzaG93UGF0aHdheVN0YWdlT3ZlcnZpZXdQYW5lbDogZnVuY3Rpb24obG9jYXRpb24sIGVuYWJsZUhvdmVyLCBwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSkge1xyXG4gICAgdmFyIHN0YW5kYXJkcyA9IFtdO1xyXG4gICAgZm9yICh2YXIgc3RhbmRhcmQgaW4gZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzKSB7XHJcbiAgICAgIHZhciBkZW5vbSA9IGRhdGEuZ2V0RGVub21pbmF0b3JGb3JTdGFuZGFyZChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSk7XHJcbiAgICAgIHZhciBudW0gPSBkZW5vbSAtIGRhdGEuZ2V0TnVtZXJhdG9yRm9yU3RhbmRhcmQocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkKTtcclxuICAgICAgc3RhbmRhcmRzLnB1c2goe1xyXG4gICAgICAgIFwic3RhbmRhcmRcIjogZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS50YWIudGl0bGUsXHJcbiAgICAgICAgXCJzdGFuZGFyZEtleVwiOiBzdGFuZGFyZCxcclxuICAgICAgICBcInRvb2x0aXBcIjogZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXVtcInN0YW5kYXJkLW1ldC10b29sdGlwXCJdLFxyXG4gICAgICAgIFwibnVtZXJhdG9yXCI6IG51bSxcclxuICAgICAgICBcImRlbm9taW5hdG9yXCI6IGRlbm9tLFxyXG4gICAgICAgIFwicGVyY2VudGFnZVwiOiAobnVtICogMTAwIC8gZGVub20pLnRvRml4ZWQoMClcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgYmFzZS5jcmVhdGVQYW5lbFNob3coJCgnI3BhdGh3YXktc3RhZ2Utb3ZlcnZpZXctcGFuZWwnKSwgbG9jYXRpb24sIHtcclxuICAgICAgcGF0aHdheTogZGF0YS5wYXRod2F5TmFtZXNbcGF0aHdheUlkXSxcclxuICAgICAgcGF0aHdheVN0YWdlOiBwYXRod2F5U3RhZ2UsXHJcbiAgICAgIHBhdGh3YXlTdGFnZU5hbWU6IGxvb2t1cC5jYXRlZ29yaWVzW3BhdGh3YXlTdGFnZV0uZGlzcGxheSxcclxuICAgICAgcGF0aHdheU5hbWVTaG9ydDogcGF0aHdheUlkLFxyXG4gICAgICB0aXRsZTogZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0udGV4dC5wYW5lbC50ZXh0LFxyXG4gICAgICBzdGFuZGFyZHM6IHN0YW5kYXJkc1xyXG4gICAgfSwge1xyXG4gICAgICBcInJvd1wiOiAkKCcjb3ZlcnZpZXctcGFuZWwtdGFibGUtcm93JykuaHRtbCgpXHJcbiAgICB9KTtcclxuXHJcbiAgICAkKCcjJyArIHBhdGh3YXlTdGFnZSArICctdHJlbmQtdG9nZ2xlJykub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICBpZiAoJCh0aGlzKS50ZXh0KCkgPT09IFwiVHJlbmRcIikge1xyXG4gICAgICAgICQodGhpcykudGV4dChcIlRhYmxlXCIpO1xyXG4gICAgICAgICQoJyMnICsgcGF0aHdheVN0YWdlICsgJy1jaGFydC10YWJsZScpLmhpZGUoKTtcclxuICAgICAgICAkKCcjJyArIHBhdGh3YXlTdGFnZSArICctY2hhcnQtd3JhcHBlcicpLnNob3coKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAkKHRoaXMpLnRleHQoXCJUcmVuZFwiKTtcclxuICAgICAgICAkKCcjJyArIHBhdGh3YXlTdGFnZSArICctY2hhcnQtdGFibGUnKS5zaG93KCk7XHJcbiAgICAgICAgJCgnIycgKyBwYXRod2F5U3RhZ2UgKyAnLWNoYXJ0LXdyYXBwZXInKS5oaWRlKCk7XHJcbiAgICAgIH1cclxuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGNoYXJ0LmRyYXdPdmVydmlld0NoYXJ0KHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBlbmFibGVIb3Zlcik7XHJcblxyXG4gIH0sXHJcblxyXG4gIGhpZGVGb290ZXI6IGZ1bmN0aW9uKCkge1xyXG4gICAgJCgnZm9vdGVyJykuaGlkZSgpO1xyXG4gIH0sXHJcblxyXG4gIHNob3dGb290ZXI6IGZ1bmN0aW9uKCkge1xyXG4gICAgJCgnZm9vdGVyJykuc2hvdygpO1xyXG4gIH0sXHJcblxyXG4gIGhpZGVUb29sdGlwczogZnVuY3Rpb24oKSB7XHJcbiAgICAkKCdbZGF0YS10b2dnbGU9XCJ0b29sdGlwXCJdJykudG9vbHRpcCgnaGlkZScpO1xyXG4gIH0sXHJcblxyXG4gIHdpcmVVcFRvb2x0aXBzOiBmdW5jdGlvbigpIHtcclxuICAgICQoJ1tkYXRhLXRvZ2dsZT1cInRvb2x0aXBcIl0nKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAkKCcudG9vbHRpcCcpLnJlbW92ZSgpO1xyXG5cclxuICAgICQoJ1tkYXRhLXRvZ2dsZT1cInRvb2x0aXBcIl0nKS50b29sdGlwKHtcclxuICAgICAgY29udGFpbmVyOiAnYm9keScsXHJcbiAgICAgIGRlbGF5OiB7XHJcbiAgICAgICAgXCJzaG93XCI6IDUwMCxcclxuICAgICAgICBcImhpZGVcIjogMTAwXHJcbiAgICAgIH0sXHJcbiAgICAgIGh0bWw6IHRydWVcclxuICAgIH0pO1xyXG4gICAgJCgnW2RhdGEtdG9nZ2xlPVwibG9uZS10b29sdGlwXCJdJykudG9vbHRpcCh7XHJcbiAgICAgIGNvbnRhaW5lcjogJ2JvZHknLFxyXG4gICAgICBkZWxheToge1xyXG4gICAgICAgIFwic2hvd1wiOiAzMDAsXHJcbiAgICAgICAgXCJoaWRlXCI6IDEwMFxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgICQoJ1tkYXRhLXRvZ2dsZT1cImxvbmUtdG9vbHRpcFwiXScpLm9uKCdzaG93bi5icy50b29sdGlwJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAkKCdbZGF0YS10b2dnbGU9XCJ0b29sdGlwXCJdJykubm90KHRoaXMpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgIH0pO1xyXG4gICAgJCgnLnBhdGllbnQtcm93LXRvb2x0aXAnKS5vbignc2hvdy5icy50b29sdGlwJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICBpZiAoJCh0aGlzKS5oYXNDbGFzcygnaGlnaGxpZ2h0ZWQnKSkge1xyXG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICBzZXR1cENsaXBib2FyZDogZnVuY3Rpb24oc2VsZWN0b3IsIGRlc3Ryb3kpIHtcclxuICAgIGlmIChkZXN0cm95KSBaZXJvQ2xpcGJvYXJkLmRlc3Ryb3koKTsgLy90aWR5IHVwXHJcblxyXG4gICAgdmFyIGNsaWVudCA9IG5ldyBaZXJvQ2xpcGJvYXJkKHNlbGVjdG9yKTtcclxuXHJcbiAgICBjbGllbnQub24oJ3JlYWR5JywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIGNsaWVudC5vbignYWZ0ZXJjb3B5JywgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnQ29waWVkIHRleHQgdG8gY2xpcGJvYXJkOiAnICsgZXZlbnQuZGF0YVsndGV4dC9wbGFpbiddKTtcclxuICAgICAgICAkKGV2ZW50LnRhcmdldCkudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgICQoZXZlbnQudGFyZ2V0KS5wb3BvdmVyKHtcclxuICAgICAgICAgIHRyaWdnZXI6ICdtYW51YWwnLFxyXG4gICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IGNsYXNzPVwicG9wb3ZlclwiIHJvbGU9XCJ0b29sdGlwXCI+PGRpdiBjbGFzcz1cImFycm93XCI+PC9kaXY+PGRpdiBjbGFzcz1cInBvcG92ZXItY29udGVudFwiPjwvZGl2PjwvZGl2PicsXHJcbiAgICAgICAgICBkZWxheToge1xyXG4gICAgICAgICAgICBzaG93OiA1MDAsXHJcbiAgICAgICAgICAgIGhpZGU6IDUwMFxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNsZWFyVGltZW91dChsb29rdXAudG1wKTtcclxuICAgICAgICAkKGV2ZW50LnRhcmdldCkucG9wb3Zlcignc2hvdycpO1xyXG4gICAgICAgIGxvb2t1cC50bXAgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgJChldmVudC50YXJnZXQpLnBvcG92ZXIoJ2hpZGUnKTtcclxuICAgICAgICB9LCA2MDApO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIGNsZWFyQm94OiBmdW5jdGlvbigpIHtcclxuICAgIC8vQ2xlYXIgdGhlIHBhdGllbnQgc2VhcmNoIGJveFxyXG4gICAgJCgnLnR5cGVhaGVhZCcpLnR5cGVhaGVhZCgndmFsJywgJycpO1xyXG4gIH0sXHJcblxyXG4gIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG4gICAqIE1vZGFsc1xyXG4gICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cclxuXHJcbiAgbGF1bmNoTW9kYWw6IGZ1bmN0aW9uKGRhdGEsIGxhYmVsLCB2YWx1ZSwgcmVhc29uVGV4dCwgY2FsbGJhY2tPblNhdmUsIGNhbGxiYWNrT25DYW5jZWwsIGNhbGxiYWNrT25VbmRvKSB7XHJcbiAgICB2YXIgdGVtcGxhdGUgPSAkKCcjbW9kYWwtd2h5JykuaHRtbCgpO1xyXG4gICAgTXVzdGFjaGUucGFyc2UodGVtcGxhdGUpOyAvLyBvcHRpb25hbCwgc3BlZWRzIHVwIGZ1dHVyZSB1c2VzXHJcblxyXG4gICAgdmFyIHJlYXNvblRlbXBsYXRlID0gJCgnI21vZGFsLXdoeS1pdGVtJykuaHRtbCgpO1xyXG4gICAgTXVzdGFjaGUucGFyc2UocmVhc29uVGVtcGxhdGUpO1xyXG5cclxuICAgIGlmIChkYXRhLnJlYXNvbnMgJiYgZGF0YS5yZWFzb25zLmxlbmd0aCA+IDApIGRhdGEuaGFzUmVhc29ucyA9IHRydWU7XHJcblxyXG4gICAgdmFyIHJlbmRlcmVkID0gTXVzdGFjaGUucmVuZGVyKHRlbXBsYXRlLCBkYXRhLCB7XHJcbiAgICAgIFwiaXRlbVwiOiByZWFzb25UZW1wbGF0ZVxyXG4gICAgfSk7XHJcbiAgICAkKCcjbW9kYWwnKS5odG1sKHJlbmRlcmVkKTtcclxuXHJcbiAgICBpZiAocmVhc29uVGV4dCkge1xyXG4gICAgICAkKCcjbW9kYWwgdGV4dGFyZWEnKS52YWwocmVhc29uVGV4dCk7XHJcbiAgICB9XHJcbiAgICBsb29rdXAubW9kYWxTYXZlZCA9IGZhbHNlO1xyXG4gICAgbG9va3VwLm1vZGFsVW5kbyA9IGZhbHNlO1xyXG5cclxuICAgICQoJyNtb2RhbCAubW9kYWwnKS5vZmYoJ2NsaWNrJywgJy51bmRvLXBsYW4nKS5vbignY2xpY2snLCAnLnVuZG8tcGxhbicsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgbG9va3VwLm1vZGFsVW5kbyA9IHRydWU7XHJcbiAgICB9KS5vZmYoJ3N1Ym1pdCcsICdmb3JtJykub24oJ3N1Ym1pdCcsICdmb3JtJywge1xyXG4gICAgICBcImxhYmVsXCI6IGxhYmVsXHJcbiAgICB9LCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIGlmICghZS5kYXRhLmxhYmVsKSBlLmRhdGEubGFiZWwgPSBcInRlYW1cIjtcclxuICAgICAgdmFyIHJlYXNvbiA9ICQoJ2lucHV0OnJhZGlvW25hbWU9cmVhc29uXTpjaGVja2VkJykudmFsKCk7XHJcbiAgICAgIHZhciByZWFzb25UZXh0ID0gJCgnI21vZGFsIHRleHRhcmVhJykudmFsKCk7XHJcblxyXG4gICAgICBsb2cucmVjb3JkRmVlZGJhY2soZGF0YS5wYXRod2F5SWQsIGUuZGF0YS5sYWJlbCwgdmFsdWUsIHJlYXNvbiwgcmVhc29uVGV4dCk7XHJcblxyXG4gICAgICBsb29rdXAubW9kYWxTYXZlZCA9IHRydWU7XHJcblxyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICQoJyNtb2RhbCAubW9kYWwnKS5tb2RhbCgnaGlkZScpO1xyXG4gICAgfSkubW9kYWwoKTtcclxuXHJcbiAgICAkKCcjbW9kYWwnKS5vZmYoJ2hpZGRlbi5icy5tb2RhbCcpLm9uKCdoaWRkZW4uYnMubW9kYWwnLCB7XHJcbiAgICAgIFwibGFiZWxcIjogbGFiZWxcclxuICAgIH0sIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgaWYgKGxvb2t1cC5tb2RhbFNhdmVkKSB7XHJcbiAgICAgICAgbG9va3VwLm1vZGFsU2F2ZWQgPSBmYWxzZTtcclxuICAgICAgICBpZiAoY2FsbGJhY2tPblNhdmUpIGNhbGxiYWNrT25TYXZlKCk7XHJcbiAgICAgIH0gZWxzZSBpZiAobG9va3VwLm1vZGFsVW5kbykge1xyXG4gICAgICAgIGxvb2t1cC5tb2RhbFVuZG8gPSBmYWxzZTtcclxuICAgICAgICBpZiAoY2FsbGJhY2tPblVuZG8pIGNhbGxiYWNrT25VbmRvKCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy91bmNoZWNrIGFzIGNhbmNlbGxlZC4gLSBidXQgbm90IGlmIHZhbHVlIGlzIGVtcHR5IGFzIHRoaXMgdW5jaGVja3MgZXZlcnl0aGluZyAtIG9yIGlmIGFscmVhZHkgY2hlY2tlZFxyXG4gICAgICAgIGlmIChjYWxsYmFja09uQ2FuY2VsKSBjYWxsYmFja09uQ2FuY2VsKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIHNvcnRTdWdnZXN0aW9uczogZnVuY3Rpb24oc3VnZ2VzdGlvbnMpIHtcclxuICAgIHN1Z2dlc3Rpb25zLnNvcnQoZnVuY3Rpb24oYSwgYikge1xyXG4gICAgICBpZiAoYS5hZ3JlZSAmJiAhYS5kb25lKSB7XHJcbiAgICAgICAgaWYgKGIuYWdyZWUgJiYgIWIuZG9uZSkgcmV0dXJuIDA7XHJcbiAgICAgICAgcmV0dXJuIC0xO1xyXG4gICAgICB9IGVsc2UgaWYgKCFhLmFncmVlICYmICFhLmRpc2FncmVlKSB7XHJcbiAgICAgICAgaWYgKCFiLmFncmVlICYmICFiLmRpc2FncmVlKSByZXR1cm4gMDtcclxuICAgICAgICBpZiAoYi5hZ3JlZSAmJiAhYi5kb25lKSByZXR1cm4gMTtcclxuICAgICAgICByZXR1cm4gLTE7XHJcbiAgICAgIH0gZWxzZSBpZiAoYS5hZ3JlZSAmJiBhLmRvbmUpIHtcclxuICAgICAgICBpZiAoYi5hZ3JlZSAmJiBiLmRvbmUpIHJldHVybiAwO1xyXG4gICAgICAgIGlmIChiLmRpc2FncmVlKSByZXR1cm4gLTE7XHJcbiAgICAgICAgcmV0dXJuIDE7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaWYgKGIuZGlzYWdyZWUpIHJldHVybiAwO1xyXG4gICAgICAgIHJldHVybiAxO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gc3VnZ2VzdGlvbnM7XHJcbiAgfSxcclxuXHJcbiAgYWRkRGlzYWdyZWVQZXJzb25hbFRlYW06IGZ1bmN0aW9uKHBsYW5zKSB7XHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBsYW5zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIGlmIChwbGFuc1tpXS5hZ3JlZSkge1xyXG4gICAgICAgIHBsYW5zW2ldLmRpc2FncmVlID0gZmFsc2U7XHJcbiAgICAgIH0gZWxzZSBpZiAocGxhbnNbaV0uYWdyZWUgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgcGxhbnNbaV0uZGlzYWdyZWUgPSB0cnVlO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcGxhbnM7XHJcbiAgfSxcclxuXHJcbiAgc3VnZ2VzdGlvbkxpc3Q6IGZ1bmN0aW9uKGlkcykge1xyXG4gICAgcmV0dXJuIGlkcy5tYXAoZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgXCJpZFwiOiB2YWwuaWQgfHwgdmFsLFxyXG4gICAgICAgIFwidGV4dFwiOiBsb2cudGV4dFt2YWwuaWQgfHwgdmFsXS50ZXh0LFxyXG4gICAgICAgIFwic3Vic2VjdGlvblwiOiB2YWwuc3Vic2VjdGlvblxyXG4gICAgICB9O1xyXG4gICAgfSkuZmlsdGVyKGZ1bmN0aW9uKHYsIGkpIHsgLy9SVyB0byBhbHdheXMgbGltaXQgdG8gM1xyXG4gICAgICByZXR1cm4gaSA8IDM7XHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICBtZXJnZUluZGl2aWR1YWxTdHVmZjogZnVuY3Rpb24oc3VnZ2VzdGlvbnMsIHBhdGllbnRJZCkge1xyXG4gICAgdmFyIGxvY2FsQWN0aW9ucyA9IGxvZy5saXN0QWN0aW9ucygpO1xyXG4gICAgaWYgKCFsb2NhbEFjdGlvbnNbcGF0aWVudElkXSkgcmV0dXJuIHN1Z2dlc3Rpb25zO1xyXG5cclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3VnZ2VzdGlvbnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgaWYgKGxvY2FsQWN0aW9uc1twYXRpZW50SWRdW3N1Z2dlc3Rpb25zW2ldLmlkXSkge1xyXG4gICAgICAgIGlmIChsb2NhbEFjdGlvbnNbcGF0aWVudElkXVtzdWdnZXN0aW9uc1tpXS5pZF0uYWdyZWUpIHtcclxuICAgICAgICAgIHN1Z2dlc3Rpb25zW2ldLmFncmVlID0gdHJ1ZTtcclxuICAgICAgICB9IGVsc2UgaWYgKGxvY2FsQWN0aW9uc1twYXRpZW50SWRdW3N1Z2dlc3Rpb25zW2ldLmlkXS5hZ3JlZSA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgIHN1Z2dlc3Rpb25zW2ldLmRpc2FncmVlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGxvY2FsQWN0aW9uc1twYXRpZW50SWRdW3N1Z2dlc3Rpb25zW2ldLmlkXS5kb25lKSBzdWdnZXN0aW9uc1tpXS5kb25lID0gbG9jYWxBY3Rpb25zW3BhdGllbnRJZF1bc3VnZ2VzdGlvbnNbaV0uaWRdLmRvbmU7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBzdWdnZXN0aW9ucztcclxuICB9LFxyXG5cclxuICBzd2l0Y2hUbzExMExheW91dDogZnVuY3Rpb24oKSB7XHJcbiAgICBpZiAoYmFzZS5sYXlvdXQgPT09IFwiMTEwXCIpIHJldHVybjtcclxuICAgIGJhc2UubGF5b3V0ID0gXCIxMTBcIjtcclxuICAgIGZhckxlZnRQYW5lbC5yZW1vdmVDbGFzcygnY29sLWxnLTMgY29sLWxnLTgnKS5hZGRDbGFzcygnY29sLWxnLTYnKS5zaG93KCk7XHJcbiAgICB0b3BQYW5lbC5oaWRlKCk7XHJcbiAgICB0b3BMZWZ0UGFuZWwuaGlkZSgpO1xyXG4gICAgYm90dG9tTGVmdFBhbmVsLmhpZGUoKTtcclxuICAgIHRvcFJpZ2h0UGFuZWwuaGlkZSgpO1xyXG4gICAgYm90dG9tUmlnaHRQYW5lbC5oaWRlKCk7XHJcbiAgICBtaWRQYW5lbC5oaWRlKCk7XHJcbiAgICBmYXJSaWdodFBhbmVsLnJlbW92ZUNsYXNzKCdjb2wteGwtNCcpLmFkZENsYXNzKCdjb2wteGwtOCcpLnNob3coKTtcclxuICB9LFxyXG5cclxuICBzd2l0Y2hUbzEwMUxheW91dDogZnVuY3Rpb24oKSB7XHJcbiAgICBpZiAoYmFzZS5sYXlvdXQgPT09IFwiMTAxXCIpIHJldHVybjtcclxuICAgIGJhc2UubGF5b3V0ID0gXCIxMDFcIjtcclxuICAgIGZhckxlZnRQYW5lbC5yZW1vdmVDbGFzcygnY29sLWxnLTMgY29sLWxnLTYgY29sLXhsLTQnKS5hZGRDbGFzcygnY29sLWxnLTgnKS5zaG93KCk7XHJcbiAgICB0b3BQYW5lbC5oaWRlKCk7XHJcbiAgICB0b3BMZWZ0UGFuZWwuaGlkZSgpO1xyXG4gICAgYm90dG9tTGVmdFBhbmVsLmhpZGUoKTtcclxuICAgIHRvcFJpZ2h0UGFuZWwuaGlkZSgpO1xyXG4gICAgYm90dG9tUmlnaHRQYW5lbC5oaWRlKCk7XHJcbiAgICBtaWRQYW5lbC5oaWRlKCk7XHJcbiAgICBmYXJSaWdodFBhbmVsLnJlbW92ZUNsYXNzKCdjb2wteGwtOCcpLmFkZENsYXNzKCdjb2wteGwtNCcpLnNob3coKTtcclxuICB9LFxyXG5cclxuXHJcblxyXG4gIHN3aXRjaFRvMjIxTGF5b3V0OiBmdW5jdGlvbigpIHtcclxuICAgIGlmIChiYXNlLmxheW91dCA9PT0gXCIyMjFcIikgcmV0dXJuO1xyXG4gICAgYmFzZS5sYXlvdXQgPSBcIjIyMVwiO1xyXG4gICAgZmFyTGVmdFBhbmVsLmhpZGUoKTtcclxuICAgIHRvcFBhbmVsLmhpZGUoKTtcclxuICAgIHRvcExlZnRQYW5lbC5hZGRDbGFzcygnY29sLXhsLTYnKS5zaG93KCk7XHJcbiAgICBib3R0b21MZWZ0UGFuZWwuYWRkQ2xhc3MoJ2NvbC14bC02Jykuc2hvdygpO1xyXG4gICAgdG9wUmlnaHRQYW5lbC5yZW1vdmVDbGFzcygnY29sLXhsLTEyJykuYWRkQ2xhc3MoJ2NvbC14bC02Jykuc2hvdygpO1xyXG4gICAgYm90dG9tUmlnaHRQYW5lbC5yZW1vdmVDbGFzcygnY29sLXhsLTEyJykuYWRkQ2xhc3MoJ2NvbC14bC02Jykuc2hvdygpO1xyXG4gICAgbWlkUGFuZWwucmVtb3ZlQ2xhc3MoJ2NvbC14bC00JykuYWRkQ2xhc3MoJ2NvbC14bC04Jykuc2hvdygpO1xyXG4gICAgZmFyUmlnaHRQYW5lbC5yZW1vdmVDbGFzcygnY29sLXhsLTgnKS5hZGRDbGFzcygnY29sLXhsLTQnKS5zaG93KCk7XHJcbiAgfSxcclxuXHJcbiAgc3dpdGNoVG8yMUxheW91dDogZnVuY3Rpb24oKSB7XHJcbiAgICBpZiAoYmFzZS5sYXlvdXQgPT09IFwiMjFcIikgcmV0dXJuO1xyXG4gICAgYmFzZS5sYXlvdXQgPSBcIjIxXCI7XHJcbiAgICBmYXJMZWZ0UGFuZWwuaGlkZSgpO1xyXG4gICAgdG9wUGFuZWwuaGlkZSgpO1xyXG4gICAgdG9wTGVmdFBhbmVsLmhpZGUoKTtcclxuICAgIGJvdHRvbUxlZnRQYW5lbC5oaWRlKCk7XHJcbiAgICB0b3BSaWdodFBhbmVsLnJlbW92ZUNsYXNzKCdjb2wteGwtNicpLmFkZENsYXNzKCdjb2wteGwtMTInKS5zaG93KCk7XHJcbiAgICBib3R0b21SaWdodFBhbmVsLnJlbW92ZUNsYXNzKCdjb2wteGwtNicpLmFkZENsYXNzKCdjb2wteGwtMTInKS5zaG93KCk7XHJcbiAgICBtaWRQYW5lbC5yZW1vdmVDbGFzcygnY29sLXhsLTQnKS5hZGRDbGFzcygnY29sLXhsLTgnKS5zaG93KCk7XHJcbiAgICBmYXJSaWdodFBhbmVsLnJlbW92ZUNsYXNzKCdjb2wteGwtOCcpLmFkZENsYXNzKCdjb2wteGwtNCcpLnNob3coKTtcclxuICB9LFxyXG5cclxuICB3aXJlVXBTdGFuZGFyZERyb3BEb3duOiBmdW5jdGlvbihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIGNhbGxiYWNrKSB7XHJcbiAgICB2YXIgYnJlYWNoZXMgPSBkYXRhLm9wdGlvbnMuZmlsdGVyKGZ1bmN0aW9uKHZhbCkge1xyXG4gICAgICByZXR1cm4gdmFsLnBhdGh3YXlJZCA9PT0gcGF0aHdheUlkICYmIHZhbC5wYXRod2F5U3RhZ2UgPT09IHBhdGh3YXlTdGFnZSAmJiB2YWwuc3RhbmRhcmQgPT09IHN0YW5kYXJkO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKGJyZWFjaGVzLmxlbmd0aCA+IDApICQoJ3NlbGVjdCcpLnZhbChicmVhY2hlc1swXS52YWx1ZSk7XHJcblxyXG4gICAgJCgnc2VsZWN0Jykuc2VsZWN0Mih7XHJcbiAgICAgIHRlbXBsYXRlUmVzdWx0OiBiYXNlLmZvcm1hdFN0YW5kYXJkLFxyXG4gICAgICBtaW5pbXVtUmVzdWx0c0ZvclNlYXJjaDogSW5maW5pdHlcclxuICAgIH0pO1xyXG4gICAgJCgnc3Bhbi5zZWxlY3QyLXNlbGVjdGlvbl9fcmVuZGVyZWQnKS5hdHRyKFwidGl0bGVcIiwgXCJcIik7XHJcbiAgICAkKCdzZWxlY3QnKS5vbignY2hhbmdlJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBsb2NhbERhdGEgPSAkKHRoaXMpLmZpbmQoJzpzZWxlY3RlZCcpLmRhdGEoKTtcclxuICAgICAgY2FsbGJhY2sobG9jYWxEYXRhLnBhdGh3YXlJZCwgbG9jYWxEYXRhLnBhdGh3YXlTdGFnZSwgbG9jYWxEYXRhLnN0YW5kYXJkLCBkYXRhLnBhdGllbnRJZCk7XHJcbiAgICB9KS5vbihcInNlbGVjdDI6b3BlblwiLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIGZvcm1hdFN0YW5kYXJkOiBmdW5jdGlvbihzdGFuZGFyZCkge1xyXG4gICAgaWYgKCFzdGFuZGFyZC5pZCkge1xyXG4gICAgICByZXR1cm4gc3RhbmRhcmQudGV4dDtcclxuICAgIH1cclxuICAgIHZhciBsb2NhbERhdGEgPSAkKHN0YW5kYXJkLmVsZW1lbnQpLmRhdGEoKTtcclxuICAgIC8vIE5vdCByZWxldmFudFxyXG4gICAgdmFyIHN0YW5kYXJkSHRtbCA9ICcnO1xyXG4gICAgLy9pZiBkaWFnbm9zaXMgb3Bwb3J0dW5pdHkgdGhlbiBub3QgcmVsZXZhbnQgZm9yIG90aGVyIHN0YWdlc1xyXG4gICAgLy9pZiBubyBtZW50aW9uIGFueXdoZXJlIHRoZW4gbm90IHJlbGV2YW50IGZvciB0aGF0IGRpc2Vhc2VcclxuICAgIHN3aXRjaCAoZGF0YS5nZXRQYXRpZW50U3RhdHVzKGRhdGEucGF0aWVudElkLCBsb2NhbERhdGEucGF0aHdheUlkLCBsb2NhbERhdGEucGF0aHdheVN0YWdlLCBsb2NhbERhdGEuc3RhbmRhcmQpKSB7XHJcbiAgICAgIGNhc2UgXCJva1wiOlxyXG4gICAgICAgIHN0YW5kYXJkSHRtbCA9ICc8c3BhbiBjbGFzcz1cInN0YW5kYXJkLWFjaGlldmVkXCIgZGF0YS10b2dnbGU9XCJ0b29sdGlwXCIgZGF0YS1wbGFjZW1lbnQ9XCJsZWZ0XCIgdGl0bGU9XCInICsgZGF0YVtsb2NhbERhdGEucGF0aHdheUlkXVtsb2NhbERhdGEucGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbbG9jYWxEYXRhLnN0YW5kYXJkXVtcImRyb3Bkb3duLXRvb2x0aXBcIl0gKyAnIC0gUVVBTElUWSBJTkRJQ0FUT1IgQUNISUVWRURcIj4nICsgc3RhbmRhcmQudGV4dCArICcgPGkgY2xhc3M9XCJmYSBmYS1zbWlsZS1vXCIgc3R5bGU9XCJjb2xvcjpncmVlblwiPjwvaT48L3NwYW4+JztcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBcIm1pc3NlZFwiOlxyXG4gICAgICAgIHN0YW5kYXJkSHRtbCA9ICc8c3BhbiBjbGFzcz1cInN0YW5kYXJkLW1pc3NlZFwiIGRhdGEtdG9nZ2xlPVwidG9vbHRpcFwiIGRhdGEtcGxhY2VtZW50PVwibGVmdFwiIHRpdGxlPVwiJyArIGRhdGFbbG9jYWxEYXRhLnBhdGh3YXlJZF1bbG9jYWxEYXRhLnBhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW2xvY2FsRGF0YS5zdGFuZGFyZF1bXCJkcm9wZG93bi10b29sdGlwXCJdICsgJyAtIElNUFJPVkVNRU5UIE9QUE9SVFVOSVRZIEVYSVNUUyBGT1IgVEhJUyBQQVRJRU5UXCI+JyArIHN0YW5kYXJkLnRleHQgKyAnIDxpIGNsYXNzPVwiZmEgZmEtZmxhZ1wiIHN0eWxlPVwiY29sb3I6cmVkXCI+PC9pPjwvc3Bhbj4nO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIFwibm90XCI6XHJcbiAgICAgICAgc3RhbmRhcmRIdG1sID0gJzxzcGFuIGNsYXNzPVwic3RhbmRhcmQtbm90LXJlbGV2YW50XCIgZGF0YS10b2dnbGU9XCJ0b29sdGlwXCIgZGF0YS1wbGFjZW1lbnQ9XCJsZWZ0XCIgdGl0bGU9XCInICsgZGF0YVtsb2NhbERhdGEucGF0aHdheUlkXVtsb2NhbERhdGEucGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbbG9jYWxEYXRhLnN0YW5kYXJkXVtcImRyb3Bkb3duLXRvb2x0aXBcIl0gKyAnIC0gU1RBTkRBUkQgTk9UIFJFTEVWQU5UIFRPIFRISVMgUEFUSUVOVFwiPicgKyBzdGFuZGFyZC50ZXh0ICsgJyA8aSBjbGFzcz1cImZhIGZhLW1laC1vXCIgc3R5bGU9XCJjb2xvcjpncmF5XCI+PC9pPjwvc3Bhbj4nO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG4gICAgdmFyICRzdGFuZGFyZCA9ICQoc3RhbmRhcmRIdG1sKTtcclxuICAgIHJldHVybiAkc3RhbmRhcmQ7XHJcbiAgfSxcclxuXHJcbiAgdXBkYXRlVGl0bGU6IGZ1bmN0aW9uKHRpdGxlKXtcclxuICAgICQoJyN0aXRsZS1sZWZ0JykuaHRtbCh0aXRsZSk7XHJcbiAgICAkKCcjdGl0bGUtcmlnaHQnKS5odG1sKFwiXCIpO1xyXG4gIH0sXHJcbiAgLyp1cGRhdGVUaXRsZTogZnVuY3Rpb24odGl0bGUsIHRvb2x0aXApIHtcclxuICAgIHZhciB0aXRsZXMgPSB0aXRsZTtcclxuICAgIGlmICh0eXBlb2YgdGl0bGUgPT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgdGl0bGVzID0gW3tcclxuICAgICAgICB0aXRsZTogdGl0bGUsXHJcbiAgICAgICAgdG9vbHRpcDogdG9vbHRpcFxyXG4gICAgICB9XTtcclxuICAgIH1cclxuICAgIHZhciBjb250ZW50ID0gdGl0bGVzLm1hcChmdW5jdGlvbih0LCBpZHgpIHtcclxuICAgICAgcmV0dXJuIGlkeCA9PT0gdGl0bGVzLmxlbmd0aCAtIDEgPyAnPHNwYW4gdGl0bGU9XCInICsgdC50b29sdGlwICsgJ1wiPicgKyB0LnRpdGxlICsgJzwvc3Bhbj4nIDogJzxhIGhyZWY9XCInICsgdC51cmwgKyAnXCIgdGl0bGU9XCInICsgdC50b29sdGlwICsgJ1wiPicgKyB0LnRpdGxlICsgJzwvYT4nO1xyXG4gICAgfSkuam9pbihcIiA+IFwiKTtcclxuXHJcbiAgICAkKCcucGFnZXRpdGxlJykuaHRtbChjb250ZW50KTtcclxuICB9LCovXHJcblxyXG4gIGhpZGVBbGxQYW5lbHM6IGZ1bmN0aW9uKCkge1xyXG4gICAgdG9wTGVmdFBhbmVsLmhpZGUoKTtcclxuICAgIGJvdHRvbUxlZnRQYW5lbC5oaWRlKCk7XHJcbiAgICB0b3BSaWdodFBhbmVsLmhpZGUoKTtcclxuICAgIGJvdHRvbVJpZ2h0UGFuZWwuaGlkZSgpO1xyXG4gICAgZmFyTGVmdFBhbmVsLmhpZGUoKTtcclxuICAgIGZhclJpZ2h0UGFuZWwuaGlkZSgpO1xyXG4gICAgdG9wUGFuZWwuaGlkZSgpO1xyXG4gIH0sXHJcblxyXG4gIGhpZGVQYW5lbHM6IGZ1bmN0aW9uKHBhbmVsKSB7XHJcbiAgICBwYW5lbC5jaGlsZHJlbigpLmhpZGUoKTtcclxuICB9LFxyXG5cclxuICB1cGRhdGVUYWI6IGZ1bmN0aW9uKHRhYiwgdmFsdWUsIHVybCkge1xyXG4gICAgdmFyIHRhYkVsZW1lbnQgPSAkKCcjbWFpblRhYiBhW2RhdGEtaHJlZj1cIiMnICsgdGFiICsgJ1wiXScpO1xyXG4gICAgdGFiRWxlbWVudC5odG1sKHRhYkVsZW1lbnQudGV4dCgpLnNwbGl0KFwiOlwiKVswXSArIFwiOjxicj48c3Bhbj48c3Ryb25nPlwiICsgdmFsdWUgKyBcIjwvc3Ryb25nPjwvc3Bhbj5cIik7XHJcbiAgICB0YWJFbGVtZW50LmRhdGEoXCJocmVmXCIsIFwiI1wiICsgdGFiICsgXCIvXCIgKyB1cmwpO1xyXG4gIH0sXHJcblxyXG4gIGFkZEZ1bGxQYWdlOiBmdW5jdGlvbihwYW5lbCkge1xyXG4gICAgcGFuZWwuZnVsbHBhZ2UoeyB2ZXJ0aWNhbENlbnRlcmVkOiBmYWxzZSwgcGFkZGluZ0JvdHRvbTogJzgwcHgnLCBzY3JvbGxCYXI6IHRydWUgfSk7XHJcblxyXG4gICAgJCgnLmZwLWRvd24nKS5vZmYoJ2NsaWNrJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICQuZm4uZnVsbHBhZ2UubW92ZVNlY3Rpb25Eb3duKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAkKCcuZnAtdXAnKS5vZmYoJ2NsaWNrJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICQuZm4uZnVsbHBhZ2UubW92ZVNlY3Rpb25VcCgpO1xyXG4gICAgfSk7XHJcbiAgfSxcclxuXHJcbiAgcmVtb3ZlRnVsbFBhZ2U6IGZ1bmN0aW9uKHBhbmVsKSB7XHJcbiAgICBpZiAocGFuZWwuY2hpbGRyZW4oJy5zZWN0aW9uJykubGVuZ3RoID09PSAwKSByZXR1cm47XHJcbiAgICBpZiAoJC5mbi5mdWxscGFnZSAmJiAkLmZuLmZ1bGxwYWdlLmRlc3Ryb3kpICQuZm4uZnVsbHBhZ2UuZGVzdHJveSgnYWxsJyk7IC8vdGlkeSB1cCBiZWZvcmUgZG9pbmcgaXQgYWdhaW5cclxuICB9LFxyXG5cclxuICBzaG93TG9hZGluZzogZnVuY3Rpb24oKXtcclxuICAgICQoJy5sb2FkaW5nLWNvbnRhaW5lcicpLnNob3coKTtcclxuICAgICQoJyN0aXRsZS1yb3cnKS5oaWRlKCk7XHJcbiAgfSxcclxuXHJcbiAgaGlkZUxvYWRpbmc6IGZ1bmN0aW9uKCl7XHJcbiAgICAkKCcubG9hZGluZy1jb250YWluZXInKS5mYWRlT3V0KDEwMDApO1xyXG4gICAgJCgnI3RpdGxlLXJvdycpLmZhZGVJbigxMDAwKTtcclxuICB9LFxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gYmFzZTtcclxuIiwidmFyIEhpZ2hjaGFydHMgPSByZXF1aXJlKCdoaWdoY2hhcnRzL2hpZ2hzdG9jaycpLFxyXG4gIGRhdGEgPSByZXF1aXJlKCcuL2RhdGEuanMnKSxcclxuICBsb29rdXAgPSByZXF1aXJlKCcuL2xvb2t1cC5qcycpLFxyXG4gIGxvZyA9IHJlcXVpcmUoJy4vbG9nLmpzJyksXHJcbiAgTXVzdGFjaGUgPSByZXF1aXJlKCdtdXN0YWNoZScpO1xyXG5cclxuY29uc29sZS5sb2coXCJjaGFydC5qczogZGF0YS5sYXN0bG9hZGVyPSBcIiArIGRhdGEubGFzdGxvYWRlcik7XHJcbmRhdGEubGFzdGxvYWRlciA9IFwiY2hhcnQuanNcIjtcclxuXHJcbnZhciBjaHQgPSB7XHJcblxyXG4gIGRlc3Ryb3lDaGFydHM6IGZ1bmN0aW9uKGNoYXJ0cykge1xyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGFydHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgaWYgKGxvb2t1cC5jaGFydHNbY2hhcnRzW2ldXSkge1xyXG4gICAgICAgIGxvb2t1cC5jaGFydHNbY2hhcnRzW2ldXS5kZXN0cm95KCk7XHJcbiAgICAgICAgZGVsZXRlIGxvb2t1cC5jaGFydHNbY2hhcnRzW2ldXTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIGRyYXdUcmVuZENoYXJ0OiBmdW5jdGlvbihwYXRpZW50SWQsIHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCkge1xyXG4gICAgdmFyIGksIGo7XHJcbiAgICBjaHQuZGVzdHJveUNoYXJ0cyhbJ2NoYXJ0LWRlbW8tdHJlbmQnXSk7XHJcbiAgICBpZiAoIWRhdGEucGF0aWVudHNbcGF0aWVudElkXVtkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLmNoYXJ0WzBdXSkge1xyXG4gICAgICAkKCcjY2hhcnQtZGVtby10cmVuZCcpLmh0bWwoJ05vIGRhdGEgZm9yIHRoaXMgcGF0aWVudHMnKTtcclxuICAgICAgJCgnI2NoYXJ0LWRlbW8tdHJlbmQnKS5wYXJlbnQoKS5maW5kKCcudGFibGUtY2hhcnQtdG9nZ2xlJykuaGlkZSgpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIGNoYXJ0RGF0YSA9IGRhdGEucGF0aWVudHNbcGF0aWVudElkXVtkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLmNoYXJ0WzBdXTtcclxuICAgIHZhciB0YWJsZURhdGEgPSBbXTtcclxuICAgIGZvciAoaSA9IDE7IGkgPCBkYXRhLnBhdGllbnRzW3BhdGllbnRJZF1bZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS5jaGFydFswXV1bMF0ubGVuZ3RoOyBpKyspIHtcclxuICAgICAgdGFibGVEYXRhLnB1c2goe1xyXG4gICAgICAgIFwiaXRlbVwiOiBkYXRhLnBhdGllbnRzW3BhdGllbnRJZF1bZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS5jaGFydFswXV1bMV1bMF0sXHJcbiAgICAgICAgXCJ2YWx1ZVwiOiBkYXRhLnBhdGllbnRzW3BhdGllbnRJZF1bZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS5jaGFydFswXV1bMV1baV0sXHJcbiAgICAgICAgXCJkYXRlXCI6IGRhdGEucGF0aWVudHNbcGF0aWVudElkXVtkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLmNoYXJ0WzBdXVswXVtpXVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICAgIGZvciAoaSA9IDE7IGkgPCBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLmNoYXJ0Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIGNoYXJ0RGF0YS5wdXNoKGRhdGEucGF0aWVudHNbcGF0aWVudElkXVtkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLmNoYXJ0W2ldXVsxXSk7IC8vUlcgVE9ETyBhc3N1bXB0aW9uIGhlcmUgdGhhdCBhbGwgZGF0ZXMgYXJlIHRoZSBzYW1lXHJcbiAgICAgIGZvciAoaiA9IDE7IGogPCBkYXRhLnBhdGllbnRzW3BhdGllbnRJZF1bZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS5jaGFydFswXV1bMF0ubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICB0YWJsZURhdGEucHVzaCh7XHJcbiAgICAgICAgICBcIml0ZW1cIjogZGF0YS5wYXRpZW50c1twYXRpZW50SWRdW2RhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0uY2hhcnRbaV1dWzFdWzBdLFxyXG4gICAgICAgICAgXCJ2YWx1ZVwiOiBkYXRhLnBhdGllbnRzW3BhdGllbnRJZF1bZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS5jaGFydFtpXV1bMV1bal0sXHJcbiAgICAgICAgICBcImRhdGVcIjogZGF0YS5wYXRpZW50c1twYXRpZW50SWRdW2RhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0uY2hhcnRbMF1dWzBdW2pdXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHZhciBjaGFydE9wdGlvbnMgPSB7XHJcbiAgICAgIGJpbmR0bzogJyNjaGFydC1kZW1vLXRyZW5kJyxcclxuICAgICAgZGF0YToge1xyXG4gICAgICAgIHhzOiB7fSxcclxuICAgICAgICBjbGFzc2VzOiB7fSxcclxuICAgICAgICBjb2x1bW5zOiBjaGFydERhdGEuc2xpY2UoKVxyXG4gICAgICB9LFxyXG4gICAgICB6b29tOiB7XHJcbiAgICAgICAgZW5hYmxlZDogdHJ1ZVxyXG4gICAgICB9LFxyXG4gICAgICBsaW5lOiB7XHJcbiAgICAgICAgY29ubmVjdE51bGw6IGZhbHNlXHJcbiAgICAgIH0sXHJcbiAgICAgIGF4aXM6IHtcclxuICAgICAgICB4OiB7XHJcbiAgICAgICAgICB0eXBlOiAndGltZXNlcmllcycsXHJcbiAgICAgICAgICB0aWNrOiB7XHJcbiAgICAgICAgICAgIGZpdDogZmFsc2UsXHJcbiAgICAgICAgICAgIGZvcm1hdDogJyVkLSVtLSVZJyxcclxuICAgICAgICAgICAgY291bnQ6IDVcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBtYXg6IG5ldyBEYXRlKClcclxuICAgICAgICB9LFxyXG4gICAgICAgIHk6IHtcclxuICAgICAgICAgIGxhYmVsOiB7XHJcbiAgICAgICAgICAgIHRleHQ6IGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0uY2hhcnRVbml0cyxcclxuICAgICAgICAgICAgcG9zaXRpb246ICdvdXRlci1taWRkbGUnXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBtYXhWYWx1ZSA9IDA7XHJcbiAgICB2YXIgc3RhbmRhcmRJdGVtcyA9IFtdO1xyXG5cclxuICAgIGZvciAoaSA9IDE7IGkgPCBjaGFydE9wdGlvbnMuZGF0YS5jb2x1bW5zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIGNoYXJ0T3B0aW9ucy5kYXRhLnhzW2NoYXJ0T3B0aW9ucy5kYXRhLmNvbHVtbnNbaV1bMF1dID0gXCJ4XCI7XHJcbiAgICAgIHN0YW5kYXJkSXRlbXMucHVzaChjaGFydE9wdGlvbnMuZGF0YS5jb2x1bW5zW2ldWzBdKTtcclxuXHJcbiAgICAgIGZvciAoaiA9IDE7IGogPCBjaGFydE9wdGlvbnMuZGF0YS5jb2x1bW5zW2ldLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgaWYgKHBhcnNlRmxvYXQoY2hhcnRPcHRpb25zLmRhdGEuY29sdW1uc1tpXVtqXSkgPiBtYXhWYWx1ZSkgbWF4VmFsdWUgPSBwYXJzZUZsb2F0KGNoYXJ0T3B0aW9ucy5kYXRhLmNvbHVtbnNbaV1bal0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY2hhcnRPcHRpb25zLnRvb2x0aXAgPSB7XHJcbiAgICAgIGZvcm1hdDoge1xyXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbih2YWx1ZSwgcmF0aW8sIGlkKSB7XHJcbiAgICAgICAgICB2YXIgdGV4dCA9IHN0YW5kYXJkSXRlbXMuaW5kZXhPZihpZCkgPiAtMSA/IHZhbHVlIDogXCJcIjtcclxuICAgICAgICAgIHJldHVybiB0ZXh0O1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgbGluZXMgPSBudWxsO1xyXG4gICAgdmFyIGF4aXNudW0gPSAxO1xyXG4gICAgaWYgKGRhdGEucGF0aWVudHNbcGF0aWVudElkXS5jb250YWN0cykge1xyXG4gICAgICBmb3IgKGkgPSAwOyBpIDwgZGF0YS5wYXRpZW50c1twYXRpZW50SWRdLmNvbnRhY3RzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgY2hhcnRPcHRpb25zLmRhdGEuY2xhc3Nlc1tkYXRhLnBhdGllbnRzW3BhdGllbnRJZF0uY29udGFjdHNbaV0udGV4dF0gPSAnbGFyZ2VyJztcclxuICAgICAgICBpZiAoIWNoYXJ0T3B0aW9ucy5kYXRhLnhzW2RhdGEucGF0aWVudHNbcGF0aWVudElkXS5jb250YWN0c1tpXS50ZXh0XSkge1xyXG4gICAgICAgICAgY2hhcnRPcHRpb25zLmRhdGEueHNbZGF0YS5wYXRpZW50c1twYXRpZW50SWRdLmNvbnRhY3RzW2ldLnRleHRdID0gXCJ4XCIgKyBheGlzbnVtO1xyXG4gICAgICAgICAgY2hhcnRPcHRpb25zLmRhdGEuY29sdW1ucy5wdXNoKFtcInhcIiArIGF4aXNudW0sIGRhdGEucGF0aWVudHNbcGF0aWVudElkXS5jb250YWN0c1tpXS52YWx1ZV0pO1xyXG4gICAgICAgICAgY2hhcnRPcHRpb25zLmRhdGEuY29sdW1ucy5wdXNoKFtkYXRhLnBhdGllbnRzW3BhdGllbnRJZF0uY29udGFjdHNbaV0udGV4dCwgKG1heFZhbHVlICogMS4xKS50b1N0cmluZygpXSk7XHJcbiAgICAgICAgICBheGlzbnVtKys7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHZhciBheGlzID0gY2hhcnRPcHRpb25zLmRhdGEueHNbZGF0YS5wYXRpZW50c1twYXRpZW50SWRdLmNvbnRhY3RzW2ldLnRleHRdO1xyXG4gICAgICAgICAgZm9yIChqID0gMTsgaiA8IGNoYXJ0T3B0aW9ucy5kYXRhLmNvbHVtbnMubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgICAgaWYgKGNoYXJ0T3B0aW9ucy5kYXRhLmNvbHVtbnNbal1bMF0gPT09IGF4aXMpIHtcclxuICAgICAgICAgICAgICBjaGFydE9wdGlvbnMuZGF0YS5jb2x1bW5zW2pdLnB1c2goZGF0YS5wYXRpZW50c1twYXRpZW50SWRdLmNvbnRhY3RzW2ldLnZhbHVlKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChjaGFydE9wdGlvbnMuZGF0YS5jb2x1bW5zW2pdWzBdID09PSBkYXRhLnBhdGllbnRzW3BhdGllbnRJZF0uY29udGFjdHNbaV0udGV4dCkge1xyXG4gICAgICAgICAgICAgIGNoYXJ0T3B0aW9ucy5kYXRhLmNvbHVtbnNbal0ucHVzaCgobWF4VmFsdWUgKiAxLjEpLnRvU3RyaW5nKCkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRhYmxlRGF0YS5wdXNoKHtcclxuICAgICAgICAgIFwiaXRlbVwiOiBcIkV2ZW50XCIsXHJcbiAgICAgICAgICBcInZhbHVlXCI6IGRhdGEucGF0aWVudHNbcGF0aWVudElkXS5jb250YWN0c1tpXS50ZXh0LFxyXG4gICAgICAgICAgXCJkYXRlXCI6IGRhdGEucGF0aWVudHNbcGF0aWVudElkXS5jb250YWN0c1tpXS52YWx1ZVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIHBhdGllbnRFdmVudHMgPSBsb2cuZ2V0RXZlbnRzKCkuZmlsdGVyKGZ1bmN0aW9uKHZhbCkge1xyXG4gICAgICByZXR1cm4gdmFsLmlkID09PSBwYXRpZW50SWQ7XHJcbiAgICB9KTtcclxuICAgIGlmIChwYXRpZW50RXZlbnRzLmxlbmd0aCA+IDApIHtcclxuXHJcbiAgICAgIGZvciAoaSA9IDA7IGkgPCBwYXRpZW50RXZlbnRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgY2hhcnRPcHRpb25zLmRhdGEuY2xhc3Nlc1twYXRpZW50RXZlbnRzW2ldLm5hbWVdID0gJ2xhcmdlcic7XHJcbiAgICAgICAgaWYgKCFjaGFydE9wdGlvbnMuZGF0YS54c1twYXRpZW50RXZlbnRzW2ldLm5hbWVdKSB7XHJcbiAgICAgICAgICBjaGFydE9wdGlvbnMuZGF0YS54c1twYXRpZW50RXZlbnRzW2ldLm5hbWVdID0gXCJ4XCIgKyBheGlzbnVtO1xyXG4gICAgICAgICAgY2hhcnRPcHRpb25zLmRhdGEuY29sdW1ucy5wdXNoKFtcInhcIiArIGF4aXNudW0sIHBhdGllbnRFdmVudHNbaV0uZGF0ZS5zdWJzdHIoMCwgMTApXSk7XHJcbiAgICAgICAgICBjaGFydE9wdGlvbnMuZGF0YS5jb2x1bW5zLnB1c2goW3BhdGllbnRFdmVudHNbaV0ubmFtZSwgKG1heFZhbHVlICogMS4xKS50b1N0cmluZygpXSk7XHJcbiAgICAgICAgICBheGlzbnVtKys7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHZhciBheGlzMiA9IGNoYXJ0T3B0aW9ucy5kYXRhLnhzW3BhdGllbnRFdmVudHNbaV0ubmFtZV07XHJcbiAgICAgICAgICBmb3IgKGogPSAxOyBqIDwgY2hhcnRPcHRpb25zLmRhdGEuY29sdW1ucy5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgICBpZiAoY2hhcnRPcHRpb25zLmRhdGEuY29sdW1uc1tqXVswXSA9PT0gYXhpczIpIHtcclxuICAgICAgICAgICAgICBjaGFydE9wdGlvbnMuZGF0YS5jb2x1bW5zW2pdLnB1c2gocGF0aWVudEV2ZW50c1tpXS5kYXRlLnN1YnN0cigwLCAxMCkpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGNoYXJ0T3B0aW9ucy5kYXRhLmNvbHVtbnNbal1bMF0gPT09IHBhdGllbnRFdmVudHNbaV0ubmFtZSkge1xyXG4gICAgICAgICAgICAgIGNoYXJ0T3B0aW9ucy5kYXRhLmNvbHVtbnNbal0ucHVzaCgobWF4VmFsdWUgKiAxLjEpLnRvU3RyaW5nKCkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRhYmxlRGF0YS5wdXNoKHtcclxuICAgICAgICAgIFwiaXRlbVwiOiBcIkV2ZW50XCIsXHJcbiAgICAgICAgICBcInZhbHVlXCI6IHBhdGllbnRFdmVudHNbaV0ubmFtZSxcclxuICAgICAgICAgIFwiZGF0ZVwiOiBwYXRpZW50RXZlbnRzW2ldLmRhdGUuc3Vic3RyKDAsIDEwKVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdGFibGVEYXRhLnNvcnQoZnVuY3Rpb24oYSwgYikge1xyXG4gICAgICBpZiAoYS5kYXRlID09PSBiLmRhdGUpIHJldHVybiAwO1xyXG4gICAgICBlbHNlIHJldHVybiBhLmRhdGUgPCBiLmRhdGUgPyAxIDogLTE7XHJcbiAgICB9KTtcclxuICAgIC8vZHJhdyBUYWJsZVxyXG4gICAgJCgnI3RhYmxlLWRlbW8tdHJlbmQnKS5odG1sKE11c3RhY2hlLnJlbmRlcigkKCcjdmFsdWUtdHJlbmQtcGFuZWwtdGFibGUnKS5odG1sKCksIHtcclxuICAgICAgXCJpdGVtc1wiOiB0YWJsZURhdGFcclxuICAgIH0sIHtcclxuICAgICAgXCJpdGVtLXJvd1wiOiAkKCcjdmFsdWUtdHJlbmQtcGFuZWwtdGFibGUtcm93JykuaHRtbCgpXHJcbiAgICB9KSk7XHJcblxyXG4gICAgLy9kcmF3IGNoYXJ0cyBpbiBzZXBhcmF0ZSB0aHJlYWQgYW5kIHdpdGggZGVsYXkgdG8gc3RvcCBzbHVnZ2lzaCBhcHBlYXJhbmNlXHJcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICBsb29rdXAuY2hhcnRzWydjaGFydC1kZW1vLXRyZW5kJ10gPSBjMy5nZW5lcmF0ZShjaGFydE9wdGlvbnMpO1xyXG4gICAgfSwgMSk7XHJcbiAgfSxcclxuXHJcbiAgc2VsZWN0UGllU2xpY2U6IGZ1bmN0aW9uKGNoYXJ0LCBkKSB7XHJcbiAgICBsb29rdXAuY2hhcnRDbGlja2VkID0gdHJ1ZTtcclxuICAgICQoJyMnICsgY2hhcnQgKyAnIHBhdGguYzMtYmFyJykuYXR0cignY2xhc3MnLCBmdW5jdGlvbihpbmRleCwgY2xhc3NOYW1lcykge1xyXG4gICAgICByZXR1cm4gY2xhc3NOYW1lcyArICcgX3Vuc2VsZWN0ZWRfJztcclxuICAgIH0pO1xyXG4gICAgbG9va3VwLmNoYXJ0c1tjaGFydF0uc2VsZWN0KFtkLmlkXSwgW2QuaW5kZXhdLCB0cnVlKTtcclxuXHJcbiAgICBmYXJSaWdodFBhbmVsLmZhZGVPdXQoMjAwLCBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIHRlbXBsYXRlID0gJCgnI3BhdGllbnQtcGFuZWwtcGxhY2Vob2xkZXInKS5odG1sKCk7XHJcbiAgICAgIGZhclJpZ2h0UGFuZWwuaHRtbChNdXN0YWNoZS5yZW5kZXIodGVtcGxhdGUpKS5zaG93KCk7XHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICBkcmF3T3ZlcnZpZXdDaGFydDogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIGVuYWJsZUhvdmVyKSB7XHJcbiAgICBjaHQuZGVzdHJveUNoYXJ0cyhbcGF0aHdheVN0YWdlICsgJy1jaGFydCddKTtcclxuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgIGxvb2t1cC5jaGFydHNbcGF0aHdheVN0YWdlICsgJy1jaGFydCddID0gYzMuZ2VuZXJhdGUoe1xyXG4gICAgICAgIGJpbmR0bzogJyMnICsgcGF0aHdheVN0YWdlICsgJy1jaGFydCcsXHJcbiAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgeDogJ3gnLFxyXG4gICAgICAgICAgY29sdW1uczogZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0udHJlbmRcclxuICAgICAgICB9LFxyXG4gICAgICAgIHpvb206IHtcclxuICAgICAgICAgIGVuYWJsZWQ6IHRydWVcclxuICAgICAgICB9LFxyXG4gICAgICAgIHRvb2x0aXA6IHtcclxuICAgICAgICAgIGZvcm1hdDoge1xyXG4gICAgICAgICAgICB0aXRsZTogZnVuY3Rpb24oeCkge1xyXG4gICAgICAgICAgICAgIHJldHVybiB4LnRvRGF0ZVN0cmluZygpICsgKGVuYWJsZUhvdmVyID8gJzxicj5DbGljayBmb3IgbW9yZSBkZXRhaWwnIDogJycpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgICAgICAgICByZXR1cm4gZW5hYmxlSG92ZXIgPyB2YWx1ZSArICclJyA6IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgYXhpczoge1xyXG4gICAgICAgICAgeDoge1xyXG4gICAgICAgICAgICB0eXBlOiAndGltZXNlcmllcycsXHJcbiAgICAgICAgICAgIHRpY2s6IHtcclxuICAgICAgICAgICAgICBmb3JtYXQ6ICclZC0lbS0lWScsXHJcbiAgICAgICAgICAgICAgY291bnQ6IDcsXHJcbiAgICAgICAgICAgICAgY3VsbGluZzoge1xyXG4gICAgICAgICAgICAgICAgbWF4OiA0XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBsYWJlbDoge1xyXG4gICAgICAgICAgICAgIHRleHQ6ICdEYXRlJyxcclxuICAgICAgICAgICAgICBwb3NpdGlvbjogJ291dGVyLWNlbnRlcidcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHk6IHtcclxuICAgICAgICAgICAgbWluOiAwLFxyXG4gICAgICAgICAgICBsYWJlbDoge1xyXG4gICAgICAgICAgICAgIHRleHQ6ICdQcm9wb3J0aW9uICglKScsXHJcbiAgICAgICAgICAgICAgcG9zaXRpb246ICdvdXRlci1taWRkbGUnXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIHBvaW50OiB7XHJcbiAgICAgICAgICBzaG93OiBmYWxzZVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2l6ZToge1xyXG4gICAgICAgICAgaGVpZ2h0OiBudWxsXHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0sIDEpO1xyXG4gIH0sXHJcblxyXG4gIGRyYXdCZW5jaG1hcmtDaGFydDogZnVuY3Rpb24oZWxlbWVudCwgZGF0YSkge1xyXG4gICAgY2h0LmRlc3Ryb3lDaGFydHMoW2VsZW1lbnQgKyAnLWNoYXJ0J10pO1xyXG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgbG9va3VwLmNoYXJ0c1tlbGVtZW50ICsgJy1jaGFydCddID0gYzMuZ2VuZXJhdGUoe1xyXG4gICAgICAgIGJpbmR0bzogJyMnICsgZWxlbWVudCxcclxuICAgICAgICBzaXplOiB7XHJcbiAgICAgICAgICBoZWlnaHQ6IDIwMFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZGF0YTogZGF0YSxcclxuICAgICAgICBheGlzOiB7XHJcbiAgICAgICAgICB4OiB7XHJcbiAgICAgICAgICAgIHR5cGU6ICdjYXRlZ29yeScsXHJcbiAgICAgICAgICAgIHRpY2s6IHtcclxuICAgICAgICAgICAgICByb3RhdGU6IDYwLFxyXG4gICAgICAgICAgICAgIG11bHRpbGluZTogZmFsc2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHk6IHtcclxuICAgICAgICAgICAgbGFiZWw6IHtcclxuICAgICAgICAgICAgICB0ZXh0OiAnJSBvZiBwYXRpZW50cyBtZWV0aW5nIHRoZSB0YXJnZXQnLFxyXG4gICAgICAgICAgICAgIHBvc2l0aW9uOiAnb3V0ZXItbWlkZGxlJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBncmlkOiB7XHJcbiAgICAgICAgICB5OiB7XHJcbiAgICAgICAgICAgIHNob3c6IHRydWVcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSwgMSk7XHJcbiAgfSxcclxuXHJcbiAgZHJhd1BlcmZvcm1hbmNlVHJlbmRDaGFydDogZnVuY3Rpb24oZWxlbWVudCwgZGF0YSkge1xyXG4gICAgY2h0LmRlc3Ryb3lDaGFydHMoW2VsZW1lbnQgKyAnLWNoYXJ0J10pO1xyXG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgbG9va3VwLmNoYXJ0c1tlbGVtZW50ICsgJy1jaGFydCddID0gYzMuZ2VuZXJhdGUoe1xyXG4gICAgICAgIGJpbmR0bzogJyMnICsgZWxlbWVudCxcclxuICAgICAgICBzaXplOiB7XHJcbiAgICAgICAgICBoZWlnaHQ6IDIwMFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZGF0YTogZGF0YSxcclxuICAgICAgICBheGlzOiB7XHJcbiAgICAgICAgICB4OiB7XHJcbiAgICAgICAgICAgIHR5cGU6ICd0aW1lc2VyaWVzJyxcclxuICAgICAgICAgICAgdGljazoge1xyXG4gICAgICAgICAgICAgIGZvcm1hdDogJyVZLSVtLSVkJyxcclxuICAgICAgICAgICAgICByb3RhdGU6IDYwLFxyXG4gICAgICAgICAgICAgIG11bHRpbGluZTogZmFsc2VcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgaGVpZ2h0OiA2MFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHk6IHtcclxuICAgICAgICAgICAgbGFiZWw6IHtcclxuICAgICAgICAgICAgICB0ZXh0OiBcIlBlcmZvcm1hbmNlXCIsXHJcbiAgICAgICAgICAgICAgcG9zaXRpb246ICdvdXRlci1taWRkbGUnXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIGdyaWQ6IHtcclxuICAgICAgICAgIHg6IHtcclxuICAgICAgICAgICAgc2hvdzogdHJ1ZVxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHk6IHtcclxuICAgICAgICAgICAgc2hvdzogdHJ1ZVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9LCAxKTtcclxuICB9LFxyXG5cclxuICBkcmF3QmVuY2htYXJrQ2hhcnRIQzogZnVuY3Rpb24oZWxlbWVudCwgZGF0YSkge1xyXG5cclxuICAgIGRhdGEgPSBbXHJcbiAgICAgIHsgeDogNDkuOSwgcDogJ1AxJywgbG9jYWw6IHRydWUgfSxcclxuICAgICAgeyB4OiA3MS41LCBwOiAnUDInLCBsb2NhbDogdHJ1ZSB9LFxyXG4gICAgICB7IHg6IDE2LjQsIHA6ICdQMycsIGxvY2FsOiB0cnVlIH0sXHJcbiAgICAgIHsgeDogMjkuMiwgcDogJ1A0JywgbG9jYWw6IHRydWUgfSxcclxuICAgICAgeyB4OiA0NC4wLCBwOiAnUDUnLCBsb2NhbDogdHJ1ZSB9LFxyXG4gICAgICB7IHg6IDc2LjAsIHA6ICdQNicsIGxvY2FsOiB0cnVlIH0sXHJcbiAgICAgIHsgeDogMzUuNiwgcDogJ1lPVScsIGxvY2FsOiB0cnVlIH0sXHJcbiAgICAgIHsgeDogNDguNSwgcDogJ1A3JywgbG9jYWw6IHRydWUgfSxcclxuICAgICAgeyB4OiAyNi40LCBwOiAnUDgnLCBsb2NhbDogdHJ1ZSB9LFxyXG4gICAgICB7IHg6IDk0LjEsIHA6ICdQOScsIGxvY2FsOiB0cnVlIH0sXHJcbiAgICAgIHsgeDogOTUuNiwgcDogJ1AxMCcgfSxcclxuICAgICAgeyB4OiA1NC4wLCBwOiAnUDExJyB9LFxyXG4gICAgICB7IHg6IDM5LjksIHA6ICdQMTInIH0sXHJcbiAgICAgIHsgeDogNjEuNSwgcDogJ1AxMycgfSxcclxuICAgICAgeyB4OiA2LjQsIHA6ICdQMTQnIH0sXHJcbiAgICAgIHsgeDogMTkuMiwgcDogJ1AxNScgfSxcclxuICAgICAgeyB4OiAzNC4wLCBwOiAnUDE2JyB9LFxyXG4gICAgICB7IHg6IDY2LjAsIHA6ICdQMTcnIH0sXHJcbiAgICAgIHsgeDogMjUuNiwgcDogJ1AxOCcgfSxcclxuICAgICAgeyB4OiAzOC41LCBwOiAnUDE5JyB9LFxyXG4gICAgICB7IHg6IDM2LjQsIHA6ICdQMjAnIH0sXHJcbiAgICAgIHsgeDogODQuMSwgcDogJ1AyMScgfSxcclxuICAgICAgeyB4OiA4NS42LCBwOiAnUDIyJyB9LFxyXG4gICAgICB7IHg6IDY0LjAsIHA6ICdQMjMnIH1cclxuICAgIF07XHJcbiAgICBkYXRhLnNvcnQoZnVuY3Rpb24oYSwgYikge1xyXG4gICAgICByZXR1cm4gYS54IC0gYi54O1xyXG4gICAgfSk7XHJcblxyXG4gICAgdmFyIGxvY2FsID0gdHJ1ZTtcclxuICAgIHZhciBiQ2hhcnQgPSAkKCcjJyArIGVsZW1lbnQpLmhpZ2hjaGFydHMoe1xyXG4gICAgICAgIGNoYXJ0OiB7XHJcbiAgICAgICAgICB0eXBlOiAnY29sdW1uJyxcclxuICAgICAgICAgIGV2ZW50czoge1xyXG4gICAgICAgICAgICBsb2FkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICB2YXIgdGhpc0NoYXJ0ID0gdGhpcztcclxuICAgICAgICAgICAgICB0aGlzQ2hhcnQucmVuZGVyZXIuYnV0dG9uKCdUb2dnbGUgbmVpZ2hib3VyaG9vZCAvIENDRycsIHRoaXNDaGFydC5wbG90V2lkdGggLSAxMDAsIDAsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgbG9jYWwgPSAhbG9jYWw7XHJcbiAgICAgICAgICAgICAgICB0aGlzQ2hhcnQueEF4aXNbMF0uY2F0ZWdvcmllcyA9IGRhdGEuZmlsdGVyKGZ1bmN0aW9uKHYpIHtcclxuICAgICAgICAgICAgICAgICAgaWYgKGxvY2FsKSByZXR1cm4gdi5sb2NhbDtcclxuICAgICAgICAgICAgICAgICAgZWxzZSByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH0pLm1hcChmdW5jdGlvbih2KSB7XHJcbiAgICAgICAgICAgICAgICAgIHJldHVybiB2LnA7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXNDaGFydC5zZXJpZXNbMF0uc2V0RGF0YShkYXRhLmZpbHRlcihmdW5jdGlvbih2KSB7XHJcbiAgICAgICAgICAgICAgICAgIGlmIChsb2NhbCkgcmV0dXJuIHYubG9jYWw7XHJcbiAgICAgICAgICAgICAgICAgIGVsc2UgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICB9KS5tYXAoZnVuY3Rpb24odikge1xyXG4gICAgICAgICAgICAgICAgICBpZiAodi5wID09PSBcIllPVVwiKSByZXR1cm4geyB5OiB2LngsIGNvbG9yOiBcInJlZFwiIH07XHJcbiAgICAgICAgICAgICAgICAgIGVsc2UgcmV0dXJuIHYueDtcclxuICAgICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgICB9KS5hZGQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdGl0bGU6IHsgdGV4dDogJ0JlbmNobWFyaycgfSxcclxuICAgICAgICB4QXhpczoge1xyXG4gICAgICAgICAgY2F0ZWdvcmllczogZGF0YS5maWx0ZXIoZnVuY3Rpb24odikge1xyXG4gICAgICAgICAgICByZXR1cm4gdi5sb2NhbCA9PT0gbG9jYWw7XHJcbiAgICAgICAgICB9KS5tYXAoZnVuY3Rpb24odikge1xyXG4gICAgICAgICAgICByZXR1cm4gdi5wO1xyXG4gICAgICAgICAgfSksXHJcbiAgICAgICAgICBjcm9zc2hhaXI6IHRydWVcclxuICAgICAgICB9LFxyXG4gICAgICAgIHlBeGlzOiB7XHJcbiAgICAgICAgICBtaW46IDAsXHJcbiAgICAgICAgICBtYXg6IDEwMCxcclxuICAgICAgICAgIHRpdGxlOiB7IHRleHQ6ICclIHBhdGllbnRzIG1lZXRpbmcgdGFyZ2V0JyB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICB0b29sdGlwOiB7XHJcbiAgICAgICAgICBoZWFkZXJGb3JtYXQ6ICc8c3BhbiBzdHlsZT1cImZvbnQtc2l6ZToxMHB4XCI+UHJhY3RpY2U6IDxiPntwb2ludC5rZXl9PC9iPjwvc3Bhbj48dGFibGU+JyxcclxuICAgICAgICAgIHBvaW50Rm9ybWF0OiAnPHRyPjx0ZCBzdHlsZT1cImNvbG9yOntzZXJpZXMuY29sb3J9O3BhZGRpbmc6MFwiPntzZXJpZXMubmFtZX06IDwvdGQ+JyArXHJcbiAgICAgICAgICAgICc8dGQgc3R5bGU9XCJwYWRkaW5nOjBcIj48Yj57cG9pbnQueTouMWZ9JTwvYj48L3RkPjwvdHI+JyxcclxuICAgICAgICAgIGZvb3RlckZvcm1hdDogJzwvdGFibGU+JyxcclxuICAgICAgICAgIHNoYXJlZDogdHJ1ZSxcclxuICAgICAgICAgIHVzZUhUTUw6IHRydWVcclxuICAgICAgICB9LFxyXG4gICAgICAgIHBsb3RPcHRpb25zOiB7XHJcbiAgICAgICAgICBjb2x1bW46IHtcclxuICAgICAgICAgICAgcG9pbnRQYWRkaW5nOiAwLjIsXHJcbiAgICAgICAgICAgIGJvcmRlcldpZHRoOiAwXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBsZWdlbmQ6IHtcclxuICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlXHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZXJpZXM6IFt7XHJcbiAgICAgICAgICBuYW1lOiAnUGVyZm9ybWFuY2UnLFxyXG4gICAgICAgICAgZGF0YTogZGF0YS5maWx0ZXIoZnVuY3Rpb24odikge1xyXG4gICAgICAgICAgICByZXR1cm4gdi5sb2NhbCA9PT0gbG9jYWw7XHJcbiAgICAgICAgICB9KS5tYXAoZnVuY3Rpb24odikge1xyXG4gICAgICAgICAgICBpZiAodi5wID09PSBcIllPVVwiKSByZXR1cm4geyB5OiB2LngsIGNvbG9yOiBcInJlZFwiIH07XHJcbiAgICAgICAgICAgIGVsc2UgcmV0dXJuIHYueDtcclxuICAgICAgICAgIH0pXHJcbiAgICAgIH1dXHJcbiAgICAgIH0sXHJcbiAgICAgIGZ1bmN0aW9uKGNoYXJ0KSB7IC8vIG9uIGNvbXBsZXRlXHJcbiAgICAgICAgdmFyIHRleHRYID0gY2hhcnQucGxvdExlZnQgKyAoY2hhcnQucGxvdFdpZHRoICogMC41KTtcclxuICAgICAgICB2YXIgdGV4dFkgPSBjaGFydC5wbG90VG9wICsgKGNoYXJ0LnBsb3RIZWlnaHQgKiAwLjUpO1xyXG5cclxuICAgICAgICB2YXIgc3BhbiA9ICc8c3BhbiBpZD1cInBpZUNoYXJ0SW5mb1RleHRcIiBzdHlsZT1cInBvc2l0aW9uOmFic29sdXRlOyB0ZXh0LWFsaWduOmNlbnRlcjstbXMtdHJhbnNmb3JtOiByb3RhdGUoMzM1ZGVnKTstd2Via2l0LXRyYW5zZm9ybTogcm90YXRlKDMzNWRlZyk7dHJhbnNmb3JtOiByb3RhdGUoMzM1ZGVnKTtcIj4nO1xyXG4gICAgICAgIHNwYW4gKz0gJzxzcGFuIHN0eWxlPVwiZm9udC1zaXplOiA2NHB4XCI+Q29taW5nIFNvb24hPC9zcGFuPic7XHJcbiAgICAgICAgc3BhbiArPSAnPC9zcGFuPic7XHJcblxyXG4gICAgICAgICQoXCIjYmVuY2htYXJrLWNoYXJ0XCIpLmFwcGVuZChzcGFuKTtcclxuICAgICAgICBzcGFuID0gJCgnI3BpZUNoYXJ0SW5mb1RleHQnKTtcclxuICAgICAgICBzcGFuLmNzcygnbGVmdCcsIHRleHRYICsgKHNwYW4ud2lkdGgoKSAqIC0wLjUpKTtcclxuICAgICAgICBzcGFuLmNzcygndG9wJywgdGV4dFkgKyAoc3Bhbi5oZWlnaHQoKSAqIC0wLjUpKTtcclxuICAgICAgfSk7XHJcblxyXG4gIH0sXHJcblxyXG4gIGRyYXdQZXJmb3JtYW5jZVRyZW5kQ2hhcnRIQzogZnVuY3Rpb24oZWxlbWVudCwgZGF0YSkge1xyXG5cclxuICAgIC8vLyBkYXRhIGlzXHJcbiAgICAvLyB7XHJcbiAgICAvLyAgXCJ2YWx1ZXNcIjpcclxuICAgIC8vICAgIFtcInhcIiwgXCIyMDE1LTA4LTI0XCIsIFwiMjAxNS0wOC0yM1wiLC4uLlxyXG4gICAgLy8gICAgW1wibnVtZXJhdG9yXCIsIDM1LCAzNywgMzMsIDMyLCAzMSwuLi5cclxuICAgIC8vICAgIFtcImRlbm9taW5hdG9yXCIsIDEzNSwgMTMzLCAxMzMsIDEzLC4uLlxyXG4gICAgLy8gICAgW1widGFyZ2V0XCIsIDAuMywgMC4zLCAwLi4uXHJcbiAgICAvLyB9XHJcblxyXG4gICAgdmFyIHRhcmdldCA9IDc1LFxyXG4gICAgICBtYXhWYWx1ZSA9IHRhcmdldCxcclxuICAgICAgbWF4WHZhbHVlID0gMDtcclxuXHJcbiAgICB2YXIgc2VyaWVzID0gW1xyXG4gICAgICB7IHR5cGU6ICdsaW5lJywgbmFtZTogJ1RyZW5kJywgZGF0YTogW10gfSxcclxuICAgICAgeyB0eXBlOiAnbGluZScsIG5hbWU6ICdQcmVkaWN0aW9uJywgZGF0YTogW10sIGRhc2hTdHlsZTogJ2RvdCcgfVxyXG4gICAgXTtcclxuXHJcbiAgICB2YXIgdG9kYXkgPSBuZXcgRGF0ZSgpO1xyXG4gICAgdmFyIGxhc3RBcHJpbCA9IG5ldyBEYXRlKCk7XHJcbiAgICB2YXIgYXByaWxCZWZvcmVUaGF0ID0gbmV3IERhdGUoKTtcclxuICAgIHZhciBuZXh0QXByaWwgPSBuZXcgRGF0ZSgpO1xyXG4gICAgaWYgKHRvZGF5LmdldE1vbnRoKCkgPCAzKSB7XHJcbiAgICAgIC8vYWZ0ZXIgYXByaWxcclxuICAgICAgbGFzdEFwcmlsLnNldFllYXIodG9kYXkuZ2V0RnVsbFllYXIoKSAtIDEpO1xyXG4gICAgICBhcHJpbEJlZm9yZVRoYXQuc2V0WWVhcih0b2RheS5nZXRGdWxsWWVhcigpIC0gMSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBuZXh0QXByaWwuc2V0WWVhcih0b2RheS5nZXRGdWxsWWVhcigpICsgMSk7XHJcbiAgICB9XHJcbiAgICBhcHJpbEJlZm9yZVRoYXQuc2V0WWVhcihhcHJpbEJlZm9yZVRoYXQuZ2V0RnVsbFllYXIoKSAtIDEpO1xyXG4gICAgbGFzdEFwcmlsLnNldE1vbnRoKDMpO1xyXG4gICAgYXByaWxCZWZvcmVUaGF0LnNldE1vbnRoKDMpO1xyXG4gICAgbmV4dEFwcmlsLnNldE1vbnRoKDMpO1xyXG4gICAgbGFzdEFwcmlsLnNldERhdGUoMSk7XHJcbiAgICBhcHJpbEJlZm9yZVRoYXQuc2V0RGF0ZSgxKTtcclxuICAgIG5leHRBcHJpbC5zZXREYXRlKDEpO1xyXG5cclxuICAgIHZhciBuID0gMCxcclxuICAgICAgc3VtWCA9IDAsXHJcbiAgICAgIHN1bVkgPSAwLFxyXG4gICAgICBzdW1YWSA9IDAsXHJcbiAgICAgIHN1bVhYID0gMCxcclxuICAgICAgc3VtWVkgPSAwLFxyXG4gICAgICBpbnRlcmNlcHQsIGdyYWRpZW50LCBjb21wRGF0ZTtcclxuXHJcbiAgICBpZiAoZGF0YS52YWx1ZXNbMF0uZmlsdGVyKGZ1bmN0aW9uKHYpIHtcclxuICAgICAgICByZXR1cm4gbmV3IERhdGUodikuZ2V0VGltZSgpID4gbGFzdEFwcmlsLmdldFRpbWUoKTtcclxuICAgICAgfSkubGVuZ3RoID4gMikgY29tcERhdGUgPSBuZXcgRGF0ZShsYXN0QXByaWwuZ2V0VGltZSgpKTtcclxuICAgIGVsc2UgY29tcERhdGUgPSBuZXcgRGF0ZShhcHJpbEJlZm9yZVRoYXQuZ2V0VGltZSgpKTtcclxuXHJcbiAgICBkYXRhLnZhbHVlc1swXS5mb3JFYWNoKGZ1bmN0aW9uKHYsIGkpIHtcclxuICAgICAgaWYgKGkgPT09IDApIHJldHVybjtcclxuICAgICAgdmFyIHRpbWUgPSBuZXcgRGF0ZSh2KS5nZXRUaW1lKCk7XHJcbiAgICAgIHZhciB5ID0gK2RhdGEudmFsdWVzWzFdW2ldICogMTAwIC8gK2RhdGEudmFsdWVzWzJdW2ldO1xyXG4gICAgICBpZiAodGltZSA+PSBjb21wRGF0ZS5nZXRUaW1lKCkpIHtcclxuICAgICAgICBuKys7XHJcbiAgICAgICAgc3VtWCArPSB0aW1lO1xyXG4gICAgICAgIHN1bVkgKz0geTtcclxuICAgICAgICBzdW1YWSArPSB0aW1lICogeTtcclxuICAgICAgICBzdW1YWCArPSB0aW1lICogdGltZTtcclxuICAgICAgICBzdW1ZWSArPSB5ICogeTtcclxuICAgICAgfVxyXG4gICAgICBzZXJpZXNbMF0uZGF0YS5wdXNoKFt0aW1lLCB5XSk7XHJcbiAgICAgIG1heFZhbHVlID0gTWF0aC5tYXgobWF4VmFsdWUsIHkpO1xyXG4gICAgICBtYXhYdmFsdWUgPSBNYXRoLm1heChtYXhYdmFsdWUsIHRpbWUpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaW50ZXJjZXB0ID0gKHN1bVkgKiBzdW1YWCAtIHN1bVggKiBzdW1YWSkgLyAobiAqIHN1bVhYIC0gc3VtWCAqIHN1bVgpO1xyXG4gICAgZ3JhZGllbnQgPSAobiAqIHN1bVhZIC0gc3VtWCAqIHN1bVkpIC8gKG4gKiBzdW1YWCAtIHN1bVggKiBzdW1YKTtcclxuXHJcbiAgICB2YXIgbmV3Q29tcERhdGUgPSBuZXcgRGF0ZShsYXN0QXByaWwuZ2V0VGltZSgpKTtcclxuICAgIHNlcmllc1sxXS5kYXRhLnB1c2goW21heFh2YWx1ZSwgbWF4WHZhbHVlICogZ3JhZGllbnQgKyBpbnRlcmNlcHRdKTtcclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMTM7IGkrKykge1xyXG4gICAgICB2YXIgeCA9IG5ld0NvbXBEYXRlLmdldFRpbWUoKTtcclxuICAgICAgaWYgKHggPCBtYXhYdmFsdWUpIHtcclxuICAgICAgICBuZXdDb21wRGF0ZS5zZXRNb250aChuZXdDb21wRGF0ZS5nZXRNb250aCgpICsgMSk7XHJcbiAgICAgICAgY29udGludWU7XHJcbiAgICAgIH1cclxuICAgICAgc2VyaWVzWzFdLmRhdGEucHVzaChbeCwgeCAqIGdyYWRpZW50ICsgaW50ZXJjZXB0XSk7XHJcbiAgICAgIHZhciBtID0gbmV3Q29tcERhdGUuZ2V0TW9udGgoKTtcclxuICAgICAgbmV3Q29tcERhdGUuc2V0TW9udGgobmV3Q29tcERhdGUuZ2V0TW9udGgoKSArIDEpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vQWRkIGxpbmUgb2YgYmVzdCBmaXQgZm9yIGxhdGVzdCBkYXRhIHNpbmNlIGFwcmlsIHRvIG5leHQgYXByaWxcclxuXHJcblxyXG4gICAgLy9EZWZhdWx0IHRvIGxhc3QgYXByaWwgLSBhcHJpbFxyXG5cclxuXHJcbiAgICB2YXIgYyA9ICQoJyMnICsgZWxlbWVudCkuaGlnaGNoYXJ0cyh7XHJcbiAgICAgIHRpdGxlOiB7IHRleHQ6ICcnIH0sXHJcbiAgICAgIHhBeGlzOiB7XHJcbiAgICAgICAgbWF4OiBuZXh0QXByaWwuZ2V0VGltZSgpLFxyXG4gICAgICAgIHR5cGU6ICdkYXRldGltZSdcclxuICAgICAgfSxcclxuICAgICAgeUF4aXM6IHtcclxuICAgICAgICB0aXRsZTogeyB0ZXh0OiAnUXVhbGl0eSBzdGFuZGFyZCBwZXJmb3JtYW5jZScgfSxcclxuICAgICAgICBtYXg6IG1heFZhbHVlICsgNSxcclxuICAgICAgICBtaW46IDAsXHJcbiAgICAgICAgcGxvdExpbmVzOiBbe1xyXG4gICAgICAgICAgdmFsdWU6IHRhcmdldCxcclxuICAgICAgICAgIGNvbG9yOiAnZ3JlZW4nLFxyXG4gICAgICAgICAgZGFzaFN0eWxlOiAnc2hvcnRkYXNoJyxcclxuICAgICAgICAgIHdpZHRoOiAyLFxyXG4gICAgICAgICAgbGFiZWw6IHtcclxuICAgICAgICAgICAgdGV4dDogJ1RhcmdldCAtICcgKyAodGFyZ2V0KSArICclJ1xyXG4gICAgICAgICAgfSxcclxuICAgICAgICB9XVxyXG4gICAgICB9LFxyXG4gICAgICBsZWdlbmQ6IHsgZW5hYmxlZDogdHJ1ZSB9LFxyXG4gICAgICB0b29sdGlwOiB7XHJcbiAgICAgICAgcG9pbnRGb3JtYXQ6ICc8c3BhbiBzdHlsZT1cImNvbG9yOntwb2ludC5jb2xvcn1cIj5cXHUyNUNGPC9zcGFuPiB7c2VyaWVzLm5hbWV9OiA8Yj57cG9pbnQueTouMmZ9JTwvYj48YnIvPidcclxuICAgICAgfSxcclxuXHJcbiAgICAgIG5hdmlnYXRvcjoge1xyXG4gICAgICAgIGVuYWJsZWQ6IHRydWVcclxuICAgICAgfSxcclxuXHJcbiAgICAgIHNlcmllczogc2VyaWVzXHJcbiAgICB9KTtcclxuXHJcbiAgICBjLmhpZ2hjaGFydHMoKS5heGVzWzBdLnNldEV4dHJlbWVzKGFwcmlsQmVmb3JlVGhhdC5nZXRUaW1lKCksIGxhc3RBcHJpbC5nZXRUaW1lKCksIHVuZGVmaW5lZCwgZmFsc2UpO1xyXG5cclxuICB9LFxyXG5cclxuICBkcmF3QW5hbHl0aWNzOiBmdW5jdGlvbihlbGVtZW50LCBkYXRhLCBzZWxlY3RTZXJpZXNGbikge1xyXG5cclxuICAgIGNodC5jbG9uZVRvb2xUaXAgPSBudWxsO1xyXG4gICAgY2h0LmNsb25lVG9vbFRpcDIgPSBudWxsO1xyXG5cclxuICAgICQoJyMnICsgZWxlbWVudCkuaGlnaGNoYXJ0cyh7XHJcbiAgICAgIGNoYXJ0OiB7XHJcbiAgICAgICAgdHlwZTogXCJjb2x1bW5cIixcclxuICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IFwiI0YzRjlGOVwiLFxyXG4gICAgICAgIGhlaWdodDogMjAwLFxyXG4gICAgICAgIGV2ZW50czoge1xyXG4gICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIHNlbGVjdFNlcmllc0ZuKCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoY2h0LmNsb25lVG9vbFRpcCkge1xyXG4gICAgICAgICAgICAgIHRoaXMuY29udGFpbmVyLmZpcnN0Q2hpbGQucmVtb3ZlQ2hpbGQoY2h0LmNsb25lVG9vbFRpcCk7XHJcbiAgICAgICAgICAgICAgY2h0LmNsb25lVG9vbFRpcCA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGNodC5jbG9uZVRvb2xUaXAyKSB7XHJcbiAgICAgICAgICAgICAgY2h0LmNsb25lVG9vbFRpcDIucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgY2h0LmNsb25lVG9vbFRpcDIgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICB0aXRsZToge1xyXG4gICAgICAgIHRleHQ6ICdQYXRpZW50cyBub3QgbWVldGluZyB0aGUgc3RhbmRhcmQnXHJcbiAgICAgIH0sXHJcbiAgICAgIHN1YnRpdGxlOiB7XHJcbiAgICAgICAgdGV4dDogZG9jdW1lbnQub250b3VjaHN0YXJ0ID09PSB1bmRlZmluZWQgP1xyXG4gICAgICAgICAgJ0NsaWNrIGEgY29sdW1uIHRvIGZpbHRlciB0aGUgcGF0aWVudCBsaXN0JyA6ICdUYXAgYSBjb2x1bW4gdG8gZmlsdGVyIHRoZSBwYXRpZW50IGxpc3QnXHJcbiAgICAgIH0sXHJcbiAgICAgIHhBeGlzOiB7XHJcbiAgICAgICAgY2F0ZWdvcmllczogZGF0YS5tYXAoZnVuY3Rpb24odiwgaSkge1xyXG4gICAgICAgICAgcmV0dXJuIHZbMF07XHJcbiAgICAgICAgfSlcclxuICAgICAgfSxcclxuICAgICAgeUF4aXM6IHtcclxuICAgICAgICB0aXRsZToge1xyXG4gICAgICAgICAgdGV4dDogJ051bWJlciBvZiBwYXRpZW50cydcclxuICAgICAgICB9LFxyXG4gICAgICAgIHN0YWNrTGFiZWxzOiB7XHJcbiAgICAgICAgICBlbmFibGVkOiB0cnVlLFxyXG4gICAgICAgICAgc3R5bGU6IHtcclxuICAgICAgICAgICAgZm9udFdlaWdodDogJ2JvbGQnLFxyXG4gICAgICAgICAgICBjb2xvcjogKEhpZ2hjaGFydHMudGhlbWUgJiYgSGlnaGNoYXJ0cy50aGVtZS50ZXh0Q29sb3IpIHx8ICdncmF5J1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuICAgICAgbGVnZW5kOiB7XHJcbiAgICAgICAgZW5hYmxlZDogZmFsc2VcclxuICAgICAgfSxcclxuXHJcbiAgICAgIHRvb2x0aXA6IHtcclxuICAgICAgICBhbmltYXRpb246IGZhbHNlLFxyXG5cclxuICAgICAgICBmb3JtYXR0ZXI6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgcmV0dXJuIHRoaXMucG9pbnQuZGVzYy5tYXRjaCgvLnsxLDQwfVteIF0qID8vZykuam9pbihcIjxicj5cIik7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgc3R5bGU6IHtcclxuICAgICAgICAgIFwid2hpdGVTcGFjZVwiOiBcIm5vcm1hbFwiXHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgdXNlSFRNTDogdHJ1ZVxyXG4gICAgICB9LFxyXG5cclxuICAgICAgcGxvdE9wdGlvbnM6IHtcclxuXHJcbiAgICAgICAgY29sdW1uOiB7XHJcbiAgICAgICAgICBkYXRhTGFiZWxzOiB7XHJcbiAgICAgICAgICAgIGVuYWJsZWQ6IHRydWUsXHJcbiAgICAgICAgICAgIGNvbG9yOiAnYmxhY2snXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgc2VyaWVzOiB7XHJcbiAgICAgICAgICBjdXJzb3I6ICdwb2ludGVyJyxcclxuICAgICAgICAgIHBvaW50OiB7XHJcbiAgICAgICAgICAgIGV2ZW50czoge1xyXG4gICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG51bVBvaW50cyA9IHRoaXMuc2VyaWVzLnBvaW50cy5sZW5ndGg7XHJcblxyXG4gICAgICAgICAgICAgICAgc2VsZWN0U2VyaWVzRm4odGhpcy5jYXRlZ29yeSk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGNodC5jbG9uZVRvb2xUaXApIHtcclxuICAgICAgICAgICAgICAgICAgdGhpcy5zZXJpZXMuY2hhcnQuY29udGFpbmVyLmZpcnN0Q2hpbGQucmVtb3ZlQ2hpbGQoY2h0LmNsb25lVG9vbFRpcCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoY2h0LmNsb25lVG9vbFRpcDIpIHtcclxuICAgICAgICAgICAgICAgICAgY2h0LmNsb25lVG9vbFRpcDIucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjaHQuY2xvbmVUb29sVGlwID0gdGhpcy5zZXJpZXMuY2hhcnQudG9vbHRpcC5sYWJlbC5lbGVtZW50LmNsb25lTm9kZSh0cnVlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VyaWVzLmNoYXJ0LmNvbnRhaW5lci5maXJzdENoaWxkLmFwcGVuZENoaWxkKGNodC5jbG9uZVRvb2xUaXApO1xyXG5cclxuICAgICAgICAgICAgICAgIGNodC5jbG9uZVRvb2xUaXAyID0gJCgnLmhpZ2hjaGFydHMtdG9vbHRpcCcpLmNsb25lKCk7XHJcbiAgICAgICAgICAgICAgICAkKHRoaXMuc2VyaWVzLmNoYXJ0LmNvbnRhaW5lcikuYXBwZW5kKGNodC5jbG9uZVRvb2xUaXAyKTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG5cclxuICAgICAgc2VyaWVzOiBbe1xyXG4gICAgICAgIGRhdGE6IGRhdGEubWFwKGZ1bmN0aW9uKHYsIGkpIHtcclxuICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHk6IHZbMl0sXHJcbiAgICAgICAgICAgIGRlc2M6IHZbMV0sXHJcbiAgICAgICAgICAgIGNvbG9yOiBIaWdoY2hhcnRzLmdldE9wdGlvbnMoKS5jb2xvcnNbaV1cclxuICAgICAgICAgIH07XHJcbiAgICAgICAgfSlcclxuICAgICAgfV1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGNodDtcclxuIiwidmFyIGxvZyA9IHJlcXVpcmUoJy4vbG9nLmpzJyksXHJcbiAgbG9va3VwID0gcmVxdWlyZSgnLi9sb29rdXAuanMnKTtcclxuXHJcblxyXG52YXIgX2dldEFsbEluZGljYXRvckRhdGEgPSBmdW5jdGlvbihjYWxsYmFjaykge1xyXG4gIHZhciByID0gTWF0aC5yYW5kb20oKTtcclxuICAkLmdldEpTT04oXCJkYXRhL2luZGljYXRvcnMuanNvbj92PVwiICsgciwgZnVuY3Rpb24oZmlsZSkge1xyXG4gICAgZHQuaW5kaWNhdG9ycyA9IGZpbGU7XHJcblxyXG4gICAgZHQuaW5kaWNhdG9ycy5mb3JFYWNoKGZ1bmN0aW9uKGluZGljYXRvcikge1xyXG4gICAgICB2YXIgcGVyY2VudGFnZSA9IE1hdGgucm91bmQoMTAwICogaW5kaWNhdG9yLnZhbHVlc1sxXVsxXSAqIDEwMCAvIGluZGljYXRvci52YWx1ZXNbMl1bMV0pIC8gMTAwO1xyXG4gICAgICBpbmRpY2F0b3IucGVyZm9ybWFuY2UgPSBpbmRpY2F0b3IudmFsdWVzWzFdWzFdICsgXCIgLyBcIiArIGluZGljYXRvci52YWx1ZXNbMl1bMV0gKyBcIiAoXCIgKyBwZXJjZW50YWdlICsgXCIlKVwiO1xyXG4gICAgICBpbmRpY2F0b3IudGFyZ2V0ID0gaW5kaWNhdG9yLnZhbHVlc1szXVsxXSAqIDEwMCArIFwiJVwiO1xyXG4gICAgICBpbmRpY2F0b3IudXAgPSBwZXJjZW50YWdlID4gTWF0aC5yb3VuZCgxMDAgKiBpbmRpY2F0b3IudmFsdWVzWzFdWzJdICogMTAwIC8gaW5kaWNhdG9yLnZhbHVlc1syXVsyXSkgLyAxMDA7XHJcbiAgICAgIHZhciB0cmVuZCA9IGluZGljYXRvci52YWx1ZXNbMV0ubWFwKGZ1bmN0aW9uKHZhbCwgaWR4KSB7XHJcbiAgICAgICAgcmV0dXJuIE1hdGgucm91bmQoMTAwICogdmFsICogMTAwIC8gaW5kaWNhdG9yLnZhbHVlc1syXVtpZHhdKSAvIDEwMDtcclxuICAgICAgfSkuc2xpY2UoMSwgMTApO1xyXG4gICAgICB0cmVuZC5yZXZlcnNlKCk7XHJcbiAgICAgIGluZGljYXRvci50cmVuZCA9IHRyZW5kLmpvaW4oXCIsXCIpO1xyXG4gICAgICB2YXIgZGF0ZXMgPSBpbmRpY2F0b3IudmFsdWVzWzBdLnNsaWNlKDEsIDEwKTtcclxuICAgICAgZGF0ZXMucmV2ZXJzZSgpO1xyXG4gICAgICBpbmRpY2F0b3IuZGF0ZXMgPSBkYXRlcztcclxuICAgIH0pO1xyXG5cclxuXHJcbiAgICBjYWxsYmFjayhkdC5pbmRpY2F0b3JzKTtcclxuICB9KTtcclxufTtcclxuXHJcbnZhciBfZ2V0QWxsSW5kaWNhdG9yRGF0YVN5bmMgPSBmdW5jdGlvbihjYWxsYmFjaykge1xyXG4gIHZhciByID0gTWF0aC5yYW5kb20oKTtcclxuICAkLmFqYXgoe1xyXG4gICAgdXJsOiBcImRhdGEvaW5kaWNhdG9ycy5qc29uP3Y9XCIgKyByLFxyXG4gICAgYXN5bmM6IGZhbHNlLFxyXG4gICAgc3VjY2VzczogZnVuY3Rpb24oZmlsZSkge1xyXG4gICAgICBkdC5pbmRpY2F0b3JzID0gZmlsZTtcclxuXHJcbiAgICAgIGR0LmluZGljYXRvcnMuZm9yRWFjaChmdW5jdGlvbihpbmRpY2F0b3IpIHtcclxuICAgICAgICB2YXIgcGVyY2VudGFnZSA9IE1hdGgucm91bmQoMTAwICogaW5kaWNhdG9yLnZhbHVlc1sxXVsxXSAqIDEwMCAvIGluZGljYXRvci52YWx1ZXNbMl1bMV0pIC8gMTAwO1xyXG4gICAgICAgIGluZGljYXRvci5wZXJmb3JtYW5jZSA9IGluZGljYXRvci52YWx1ZXNbMV1bMV0gKyBcIiAvIFwiICsgaW5kaWNhdG9yLnZhbHVlc1syXVsxXSArIFwiIChcIiArIHBlcmNlbnRhZ2UgKyBcIiUpXCI7XHJcbiAgICAgICAgaW5kaWNhdG9yLnRhcmdldCA9IGluZGljYXRvci52YWx1ZXNbM11bMV0gKiAxMDAgKyBcIiVcIjtcclxuICAgICAgICBpbmRpY2F0b3IudXAgPSBwZXJjZW50YWdlID4gTWF0aC5yb3VuZCgxMDAgKiBpbmRpY2F0b3IudmFsdWVzWzFdWzJdICogMTAwIC8gaW5kaWNhdG9yLnZhbHVlc1syXVsyXSkgLyAxMDA7XHJcbiAgICAgICAgdmFyIHRyZW5kID0gaW5kaWNhdG9yLnZhbHVlc1sxXS5tYXAoZnVuY3Rpb24odmFsLCBpZHgpIHtcclxuICAgICAgICAgIHJldHVybiBNYXRoLnJvdW5kKDEwMCAqIHZhbCAqIDEwMCAvIGluZGljYXRvci52YWx1ZXNbMl1baWR4XSkgLyAxMDA7XHJcbiAgICAgICAgfSkuc2xpY2UoMSwgMTApO1xyXG4gICAgICAgIHRyZW5kLnJldmVyc2UoKTtcclxuICAgICAgICBpbmRpY2F0b3IudHJlbmQgPSB0cmVuZC5qb2luKFwiLFwiKTtcclxuICAgICAgICB2YXIgZGF0ZXMgPSBpbmRpY2F0b3IudmFsdWVzWzBdLnNsaWNlKDEsIDEwKTtcclxuICAgICAgICBkYXRlcy5yZXZlcnNlKCk7XHJcbiAgICAgICAgaW5kaWNhdG9yLmRhdGVzID0gZGF0ZXM7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgcmV0dXJuIGR0LmluZGljYXRvcnM7XHJcbn07XHJcblxyXG52YXIgX2dldEluZGljYXRvckRhdGEgPSBmdW5jdGlvbihpbmRpY2F0b3IsIGNhbGxiYWNrKSB7XHJcbiAgdmFyIHIgPSBNYXRoLnJhbmRvbSgpO1xyXG4gICQuZ2V0SlNPTihcImRhdGEvaWRhdGEuXCIgKyBpbmRpY2F0b3IgKyBcIi5qc29uP3Y9XCIgKyByLCBmdW5jdGlvbihmaWxlKSB7XHJcbiAgICBkdC5pbmRpY2F0b3JzW2luZGljYXRvcl0gPSBmaWxlO1xyXG5cclxuICAgIC8vYXBwbHkgd2hpY2ggY2F0ZWdvcmllcyBwZW9wbGUgYmVsb25nIHRvXHJcbiAgICBPYmplY3Qua2V5cyhkdC5pbmRpY2F0b3JzW2luZGljYXRvcl0ucGF0aWVudHMpLmZvckVhY2goZnVuY3Rpb24ocGF0aWVudCkge1xyXG4gICAgICBkdC5pbmRpY2F0b3JzW2luZGljYXRvcl0ucGF0aWVudHNbcGF0aWVudF0ub3Bwb3J0dW5pdGllcyA9IFtdO1xyXG4gICAgICBkdC5pbmRpY2F0b3JzW2luZGljYXRvcl0ub3Bwb3J0dW5pdGllcy5mb3JFYWNoKGZ1bmN0aW9uKG9wcCwgaWR4KSB7XHJcbiAgICAgICAgaWYgKG9wcC5wYXRpZW50cy5pbmRleE9mKCtwYXRpZW50KSA+IC0xKSB7XHJcbiAgICAgICAgICBkdC5pbmRpY2F0b3JzW2luZGljYXRvcl0ucGF0aWVudHNbcGF0aWVudF0ub3Bwb3J0dW5pdGllcy5wdXNoKGlkeCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGNhbGxiYWNrKGR0LmluZGljYXRvcnNbaW5kaWNhdG9yXSk7XHJcbiAgfSk7XHJcbn07XHJcblxyXG52YXIgX2dldEluZGljYXRvckRhdGFTeW5jID0gZnVuY3Rpb24oaW5kaWNhdG9yKSB7XHJcbiAgdmFyIHIgPSBNYXRoLnJhbmRvbSgpO1xyXG4gICQuYWpheCh7XHJcbiAgICB1cmw6IFwiZGF0YS9pZGF0YS5cIiArIGluZGljYXRvciArIFwiLmpzb24/dj1cIiArIHIsXHJcbiAgICBhc3luYzogZmFsc2UsXHJcbiAgICBzdWNjZXNzOiBmdW5jdGlvbihmaWxlKSB7XHJcbiAgICAgIGR0LmluZGljYXRvcnNbaW5kaWNhdG9yXSA9IGZpbGU7XHJcblxyXG4gICAgICAvL2FwcGx5IHdoaWNoIGNhdGVnb3JpZXMgcGVvcGxlIGJlbG9uZyB0b1xyXG4gICAgICBPYmplY3Qua2V5cyhkdC5pbmRpY2F0b3JzW2luZGljYXRvcl0ucGF0aWVudHMpLmZvckVhY2goZnVuY3Rpb24ocGF0aWVudCkge1xyXG4gICAgICAgIGR0LmluZGljYXRvcnNbaW5kaWNhdG9yXS5wYXRpZW50c1twYXRpZW50XS5vcHBvcnR1bml0aWVzID0gW107XHJcbiAgICAgICAgZHQuaW5kaWNhdG9yc1tpbmRpY2F0b3JdLm9wcG9ydHVuaXRpZXMuZm9yRWFjaChmdW5jdGlvbihvcHAsIGlkeCkge1xyXG4gICAgICAgICAgaWYgKG9wcC5wYXRpZW50cy5pbmRleE9mKCtwYXRpZW50KSA+IC0xKSB7XHJcbiAgICAgICAgICAgIGR0LmluZGljYXRvcnNbaW5kaWNhdG9yXS5wYXRpZW50c1twYXRpZW50XS5vcHBvcnR1bml0aWVzLnB1c2goaWR4KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgfVxyXG4gIH0pO1xyXG4gIHJldHVybiBkdC5pbmRpY2F0b3JzW2luZGljYXRvcl07XHJcbn07XHJcblxyXG52YXIgX2dldEZha2VQYXRpZW50RGF0YSA9IGZ1bmN0aW9uKHBhdGllbnQsIGNhbGxiYWNrKSB7XHJcbiAgdmFyIHIgPSBNYXRoLnJhbmRvbSgpLFxyXG4gICAgaXNBc3luYyA9IHR5cGVvZihjYWxsYmFjaykgPT09IFwiZnVuY3Rpb25cIjtcclxuICBpZiAoZHQucGF0aWVudHMgJiYgZHQucGF0aWVudHMucGF0aWVudCkge1xyXG4gICAgaWYgKGlzQXN5bmMpIHJldHVybiBjYWxsYmFjayhkdC5wYXRpZW50cy5wYXRpZW50KTtcclxuICAgIGVsc2UgcmV0dXJuIGR0LnBhdGllbnRzLnBhdGllbnQ7XHJcbiAgfVxyXG4gICQuYWpheCh7XHJcbiAgICB1cmw6IFwiZGF0YS9wYXRpZW50Lmpzb24/dj1cIiArIHIsXHJcbiAgICBhc3luYzogaXNBc3luYyxcclxuICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKGZpbGUpIHtcclxuICAgICAgaWYgKCFkdC5wYXRpZW50cykgZHQucGF0aWVudHMgPSB7fTtcclxuICAgICAgZHQucGF0aWVudHMucGF0aWVudCA9IGZpbGU7XHJcbiAgICAgIGR0LnBhdGllbnRzW3BhdGllbnRdID0gZmlsZTtcclxuXHJcbiAgICAgIGlmIChpc0FzeW5jKSBjYWxsYmFjayhkdC5wYXRpZW50cy5wYXRpZW50KTtcclxuICAgIH1cclxuICB9KTtcclxuICBpZiAoIWlzQXN5bmMpIHJldHVybiBkdC5wYXRpZW50cy5wYXRpZW50O1xyXG59O1xyXG5cclxudmFyIF9nZXRQYXRpZW50RGF0YSA9IGZ1bmN0aW9uKHBhdGllbnQsIGNhbGxiYWNrKSB7XHJcbiAgLy9pZiBjYWxsYmFjayBwcm92aWRlZCBkbyBhc3luYyAtIGVsc2UgZG8gc3luY1xyXG4gIHZhciByID0gTWF0aC5yYW5kb20oKSxcclxuICAgIGlzQXN5bmMgPSB0eXBlb2YoY2FsbGJhY2spID09PSBcImZ1bmN0aW9uXCI7XHJcblxyXG4gIGlmIChkdC5wYXRpZW50cyAmJiBkdC5wYXRpZW50c1twYXRpZW50XSkge1xyXG4gICAgaWYgKGlzQXN5bmMpIHJldHVybiBjYWxsYmFjayhkdC5wYXRpZW50c1twYXRpZW50XSk7XHJcbiAgICBlbHNlIHJldHVybiBkdC5wYXRpZW50c1twYXRpZW50XTtcclxuICB9XHJcblxyXG4gICQuYWpheCh7XHJcbiAgICB1cmw6IFwiZGF0YS9cIiArIHBhdGllbnQgKyBcIi5qc29uP3Y9XCIgKyByLFxyXG4gICAgYXN5bmM6IGlzQXN5bmMsXHJcbiAgICBzdWNjZXNzOiBmdW5jdGlvbihmaWxlKSB7XHJcbiAgICAgIGlmICghZHQucGF0aWVudHMpIGR0LnBhdGllbnRzID0ge307XHJcbiAgICAgIGR0LnBhdGllbnRzW3BhdGllbnRdID0gZmlsZTtcclxuXHJcbiAgICAgIGlmIChpc0FzeW5jKSBjYWxsYmFjayhkdC5wYXRpZW50c1twYXRpZW50XSk7XHJcbiAgICB9LFxyXG4gICAgZXJyb3I6IGZ1bmN0aW9uKCkge1xyXG4gICAgICBpZiAoZHQucGF0aWVudHMucGF0aWVudCAmJiBpc0FzeW5jKSB7XHJcbiAgICAgICAgZHQucGF0aWVudHNbcGF0aWVudF0gPSBkdC5wYXRpZW50cy5wYXRpZW50O1xyXG4gICAgICAgIHJldHVybiBjYWxsYmFjayhkdC5wYXRpZW50cy5wYXRpZW50KTtcclxuICAgICAgfSBlbHNlIGlmICghZHQucGF0aWVudHMucGF0aWVudCkge1xyXG4gICAgICAgIF9nZXRGYWtlUGF0aWVudERhdGEocGF0aWVudCwgY2FsbGJhY2spO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIGlmICghaXNBc3luYykgcmV0dXJuIGR0LnBhdGllbnRzLnBhdGllbnQ7XHJcbn07XHJcblxyXG52YXIgZHQgPSB7XHJcblxyXG4gIHBhdGh3YXlOYW1lczoge30sXHJcbiAgZGlzZWFzZXM6IFtdLFxyXG4gIG9wdGlvbnM6IFtdLFxyXG4gIHBhdExvb2t1cDoge30sXHJcblxyXG4gIGdldFBhdGlldExpc3RGb3JTdGFuZGFyZDogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkKSB7XHJcbiAgICB2YXIgcGF0aWVudHMgPSBkdC5yZW1vdmVEdXBsaWNhdGVzKGR0W3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLm9wcG9ydHVuaXRpZXMucmVkdWNlKGZ1bmN0aW9uKGEsIGIpIHtcclxuICAgICAgcmV0dXJuIGEucGF0aWVudHMgPyBhLnBhdGllbnRzLmNvbmNhdChiLnBhdGllbnRzKSA6IGEuY29uY2F0KGIucGF0aWVudHMpO1xyXG4gICAgfSkpO1xyXG4gICAgcmV0dXJuIHBhdGllbnRzO1xyXG4gIH0sXHJcblxyXG4gIGdldFBhdGllbnRTdGF0dXM6IGZ1bmN0aW9uKHBhdGllbnRJZCwgcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkKSB7XHJcbiAgICBpZiAoZHQucGF0aWVudHNbcGF0aWVudElkXS5icmVhY2gpIHtcclxuICAgICAgaWYgKGR0LnBhdGllbnRzW3BhdGllbnRJZF0uYnJlYWNoLmZpbHRlcihmdW5jdGlvbih2YWwpIHtcclxuICAgICAgICAgIHJldHVybiB2YWwucGF0aHdheUlkID09PSBwYXRod2F5SWQgJiYgdmFsLnBhdGh3YXlTdGFnZSA9PT0gcGF0aHdheVN0YWdlICYmIHZhbC5zdGFuZGFyZCA9PT0gc3RhbmRhcmQ7XHJcbiAgICAgICAgfSkubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIHJldHVybiBcIm1pc3NlZFwiO1xyXG4gICAgICB9IGVsc2UgaWYgKGR0LnBhdGllbnRzW3BhdGllbnRJZF0uYnJlYWNoLmZpbHRlcihmdW5jdGlvbih2YWwpIHtcclxuICAgICAgICAgIHJldHVybiB2YWwucGF0aHdheUlkID09PSBwYXRod2F5SWQgJiYgdmFsLnBhdGh3YXlTdGFnZSA9PT0gXCJkaWFnbm9zaXNcIjtcclxuICAgICAgICB9KS5sZW5ndGggPiAwICYmIHBhdGh3YXlTdGFnZSAhPT0gXCJkaWFnbm9zaXNcIikge1xyXG4gICAgICAgIHJldHVybiBcIm5vdFwiO1xyXG4gICAgICB9IGVsc2UgaWYgKGR0LnBhdGllbnRzW3BhdGllbnRJZF0uYnJlYWNoLmZpbHRlcihmdW5jdGlvbih2YWwpIHtcclxuICAgICAgICAgIHJldHVybiB2YWwucGF0aHdheUlkID09PSBwYXRod2F5SWQ7XHJcbiAgICAgICAgfSkubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIHJldHVybiBcIm9rXCI7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIFwibm90XCI7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiBcIm5vdFwiO1xyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIGdldE51bWVyYXRvckZvclN0YW5kYXJkOiBmdW5jdGlvbihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQpIHtcclxuICAgIHZhciBwYXRpZW50cyA9IGR0LmdldFBhdGlldExpc3RGb3JTdGFuZGFyZChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQpO1xyXG4gICAgcmV0dXJuIHBhdGllbnRzLmxlbmd0aDtcclxuICB9LFxyXG5cclxuICBnZXREZW5vbWluYXRvckZvclN0YW5kYXJkOiBmdW5jdGlvbihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSkge1xyXG4gICAgdmFyIHBhdGllbnRzID0gZHRbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnBhdGllbnRzT2s7XHJcbiAgICBmb3IgKHZhciBzdGFuZGFyZCBpbiBkdFtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzKSB7XHJcbiAgICAgIHZhciBuZXdQYXRpZW50cyA9IGR0LmdldFBhdGlldExpc3RGb3JTdGFuZGFyZChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQpO1xyXG4gICAgICBwYXRpZW50cyA9IHBhdGllbnRzLmNvbmNhdChuZXdQYXRpZW50cyk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZHQucmVtb3ZlRHVwbGljYXRlcyhwYXRpZW50cykubGVuZ3RoO1xyXG4gIH0sXHJcblxyXG4gIHJlbW92ZUR1cGxpY2F0ZXM6IGZ1bmN0aW9uKGFycmF5KSB7XHJcbiAgICB2YXIgYXJyUmVzdWx0ID0ge307XHJcbiAgICB2YXIgcnRuID0gW107XHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIGFyclJlc3VsdFthcnJheVtpXV0gPSBhcnJheVtpXTtcclxuICAgIH1cclxuICAgIGZvciAodmFyIGl0ZW0gaW4gYXJyUmVzdWx0KSB7XHJcbiAgICAgIHJ0bi5wdXNoKGFyclJlc3VsdFtpdGVtXSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcnRuO1xyXG4gIH0sXHJcblxyXG4gIG51bWJlck9mU3RhbmRhcmRzTWlzc2VkOiBmdW5jdGlvbihwYXRpZW50SWQpIHtcclxuICAgIGlmICghZHQucGF0aWVudHNbcGF0aWVudElkXS5icmVhY2gpIHJldHVybiAwO1xyXG4gICAgdmFyIGEgPSBkdC5wYXRpZW50c1twYXRpZW50SWRdLmJyZWFjaC5tYXAoZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgIHJldHVybiB2YWwucGF0aHdheUlkICsgdmFsLnBhdGh3YXlTdGFnZSArIHZhbC5zdGFuZGFyZDtcclxuICAgIH0pO1xyXG4gICAgdmFyIG9iaiA9IHt9O1xyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIG9ialthW2ldXSA9IFwiXCI7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gT2JqZWN0LmtleXMob2JqKS5sZW5ndGg7XHJcbiAgfSxcclxuXHJcbiAgZ2V0QWxsUGF0aWVudHM6IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIHBMaXN0ID0gW10sXHJcbiAgICAgIGksIGssIHByb3A7XHJcbiAgICBmb3IgKGsgPSAwOyBrIDwgZHQuZGlzZWFzZXMubGVuZ3RoOyBrKyspIHtcclxuICAgICAgZm9yIChpIGluIGxvb2t1cC5jYXRlZ29yaWVzKSB7XHJcbiAgICAgICAgZm9yIChwcm9wIGluIGR0W2R0LmRpc2Vhc2VzW2tdLmlkXVtpXS5iZG93bikge1xyXG4gICAgICAgICAgaWYgKGR0W2R0LmRpc2Vhc2VzW2tdLmlkXVtpXS5iZG93bi5oYXNPd25Qcm9wZXJ0eShwcm9wKSkge1xyXG4gICAgICAgICAgICBwTGlzdCA9IHBMaXN0LmNvbmNhdChkdFtkdC5kaXNlYXNlc1trXS5pZF1baV0uYmRvd25bcHJvcF0ucGF0aWVudHMpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBwTGlzdCA9IHBMaXN0LmNvbmNhdChkdFtkdC5kaXNlYXNlc1trXS5pZF1baV0ucGF0aWVudHNPayk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHBMaXN0ID0gZHQucmVtb3ZlRHVwbGljYXRlcyhwTGlzdCk7XHJcbiAgICB2YXIgcGF0aWVudHMgPSBwTGlzdC5tYXAoZnVuY3Rpb24ocGF0aWVudElkKSB7XHJcbiAgICAgIHZhciByZXQgPSBkdC5wYXRpZW50c1twYXRpZW50SWRdO1xyXG4gICAgICByZXQubmhzTnVtYmVyID0gZHQucGF0TG9va3VwID8gZHQucGF0TG9va3VwW3BhdGllbnRJZF0gOiBwYXRpZW50SWQ7XHJcbiAgICAgIHJldC5wYXRpZW50SWQgPSBwYXRpZW50SWQ7XHJcbiAgICAgIHJldC5pdGVtcyA9IFtdOyAvL1RoZSBmaWVsZHMgaW4gdGhlIHBhdGllbnQgbGlzdCB0YWJsZVxyXG4gICAgICByZXQuaXRlbXMucHVzaChkdC5udW1iZXJPZlN0YW5kYXJkc01pc3NlZChwYXRpZW50SWQpKTtcclxuICAgICAgcmV0dXJuIHJldDtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBwYXRpZW50cztcclxuICB9LFxyXG5cclxuICBnZXQ6IGZ1bmN0aW9uKGNhbGxiYWNrLCBqc29uKSB7XHJcbiAgICAvL2dldCB0ZXh0XHJcbiAgICAkLmdldEpTT04oXCJkYXRhL3RleHQuanNvbj92PVwiICsgTWF0aC5yYW5kb20oKSwgZnVuY3Rpb24odGV4dGZpbGUpIHtcclxuICAgICAgZHQudGV4dCA9IHRleHRmaWxlLnBhdGh3YXlzO1xyXG5cclxuICAgICAgaWYgKGpzb24pIHtcclxuICAgICAgICBkdC5uZXdsb2FkKGpzb24pO1xyXG4gICAgICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgPT09ICdmdW5jdGlvbicpIGNhbGxiYWNrKCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgJC5nZXRKU09OKFwiZGF0YS9kYXRhLmpzb24/dj1cIiArIE1hdGgucmFuZG9tKCksIGZ1bmN0aW9uKGZpbGUpIHtcclxuICAgICAgICAgIGR0Lm5ld2xvYWQoZmlsZSk7XHJcbiAgICAgICAgICBpZiAodHlwZW9mIGNhbGxiYWNrID09PSAnZnVuY3Rpb24nKSBjYWxsYmFjaygpO1xyXG4gICAgICAgIH0pLmZhaWwoZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICBhbGVydChcImRhdGEvZGF0YS5qc29uIGZhaWxlZCB0byBsb2FkISEgLSBpZiB5b3UndmUgY2hhbmdlZCBpdCByZWNlbnRseSBjaGVjayBpdCdzIHZhbGlkIGpzb24gYXQganNvbmxpbnQuY29tXCIpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgfSkuZmFpbChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgYWxlcnQoXCJkYXRhL3RleHQuanNvbiBmYWlsZWQgdG8gbG9hZCEhIC0gaWYgeW91J3ZlIGNoYW5nZWQgaXQgcmVjZW50bHkgY2hlY2sgaXQncyB2YWxpZCBqc29uIGF0IGpzb25saW50LmNvbVwiKTtcclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIG5ld2xvYWQ6IGZ1bmN0aW9uKGZpbGUpIHtcclxuICAgIGR0LmluZGljYXRvcnMgPSBmaWxlLmluZGljYXRvcnM7XHJcbiAgICBkdC5wYXRod2F5TmFtZXMgPSB7fTtcclxuXHJcbiAgICBkdC5pbmRpY2F0b3JzLmZvckVhY2goZnVuY3Rpb24oaW5kaWNhdG9yKSB7XHJcbiAgICAgIHZhciBsYXN0ID0gaW5kaWNhdG9yLnZhbHVlc1swXS5sZW5ndGgtMTtcclxuICAgICAgdmFyIHBhdGh3YXlJZCA9IGluZGljYXRvci5pZC5zcGxpdChcIi5cIilbMF07XHJcbiAgICAgIHZhciBwYXRod2F5U3RhZ2UgPSBpbmRpY2F0b3IuaWQuc3BsaXQoXCIuXCIpWzFdO1xyXG4gICAgICB2YXIgc3RhbmRhcmQgPSBpbmRpY2F0b3IuaWQuc3BsaXQoXCIuXCIpWzJdO1xyXG4gICAgICBpZiAoIWR0LnBhdGh3YXlOYW1lc1twYXRod2F5SWRdKSBkdC5wYXRod2F5TmFtZXNbcGF0aHdheUlkXSA9IFwiXCI7XHJcbiAgICAgIHZhciBwZXJjZW50YWdlID0gTWF0aC5yb3VuZCgxMDAgKiBpbmRpY2F0b3IudmFsdWVzWzFdW2xhc3RdICogMTAwIC8gaW5kaWNhdG9yLnZhbHVlc1syXVtsYXN0XSkgLyAxMDA7XHJcbiAgICAgIGluZGljYXRvci5wZXJmb3JtYW5jZSA9IHtcclxuICAgICAgICBmcmFjdGlvbjogaW5kaWNhdG9yLnZhbHVlc1sxXVtsYXN0XSArIFwiL1wiICsgaW5kaWNhdG9yLnZhbHVlc1syXVtsYXN0XSxcclxuICAgICAgICBwZXJjZW50YWdlOiBwZXJjZW50YWdlXHJcbiAgICAgIH07XHJcbiAgICAgIGluZGljYXRvci5iZW5jaG1hcmsgPSBcIjkwJVwiOyAvL1RPRE8gbWFnaWMgbnVtYmVyXHJcbiAgICAgIGluZGljYXRvci50YXJnZXQgPSBpbmRpY2F0b3IudmFsdWVzWzNdW2xhc3RdICogMTAwICsgXCIlXCI7XHJcbiAgICAgIGluZGljYXRvci51cCA9IHBlcmNlbnRhZ2UgPiBNYXRoLnJvdW5kKDEwMCAqIGluZGljYXRvci52YWx1ZXNbMV1bbGFzdC0xXSAqIDEwMCAvIGluZGljYXRvci52YWx1ZXNbMl1bbGFzdC0xXSkgLyAxMDA7XHJcbiAgICAgIHZhciB0cmVuZCA9IGluZGljYXRvci52YWx1ZXNbMV0ubWFwKGZ1bmN0aW9uKHZhbCwgaWR4KSB7XHJcbiAgICAgICAgcmV0dXJuIE1hdGgucm91bmQoMTAwICogdmFsICogMTAwIC8gaW5kaWNhdG9yLnZhbHVlc1syXVtpZHhdKSAvIDEwMDtcclxuICAgICAgfSkuc2xpY2UoMSwgMTApO1xyXG4gICAgICAvL3RyZW5kLnJldmVyc2UoKTtcclxuICAgICAgaW5kaWNhdG9yLnRyZW5kID0gdHJlbmQuam9pbihcIixcIik7XHJcbiAgICAgIHZhciBkYXRlcyA9IGluZGljYXRvci52YWx1ZXNbMF0uc2xpY2UoTWF0aC5tYXgoMSxsYXN0LTEwKSwgMTApO1xyXG4gICAgICAvL2RhdGVzLnJldmVyc2UoKTtcclxuICAgICAgaW5kaWNhdG9yLmRhdGVzID0gZGF0ZXM7XHJcbiAgICAgIGlmIChkdC50ZXh0W3BhdGh3YXlJZF0gJiYgZHQudGV4dFtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0gJiYgZHQudGV4dFtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXSkge1xyXG4gICAgICAgIGluZGljYXRvci5kZXNjcmlwdGlvbiA9IGR0LnRleHRbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0uZGVzY3JpcHRpb247XHJcbiAgICAgICAgaW5kaWNhdG9yLnRhZ2xpbmUgPSBkdC50ZXh0W3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLnRhZ2xpbmU7XHJcbiAgICAgICAgaW5kaWNhdG9yLnBvc2l0aXZlTWVzc2FnZSA9IGR0LnRleHRbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0ucG9zaXRpdmVNZXNzYWdlO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGluZGljYXRvci5kZXNjcmlwdGlvbiA9IFwiTm8gZGVzY3JpcHRpb24gc3BlY2lmaWVkXCI7XHJcbiAgICAgICAgaW5kaWNhdG9yLnRhZ2xpbmUgPSBcIlwiO1xyXG4gICAgICB9XHJcbiAgICAgIGluZGljYXRvci5hYm92ZVRhcmdldCA9IGluZGljYXRvci5wZXJmb3JtYW5jZS5wZXJjZW50YWdlID4gK2luZGljYXRvci52YWx1ZXNbM11bbGFzdF0qMTAwO1xyXG5cclxuICAgICAgZHQuaW5kaWNhdG9yc1tpbmRpY2F0b3IuaWRdID0geyBwZXJmb3JtYW5jZTogaW5kaWNhdG9yLnBlcmZvcm1hbmNlLCB0YWdsaW5lOiBpbmRpY2F0b3IudGFnbGluZSwgcG9zaXRpdmVNZXNzYWdlOiBpbmRpY2F0b3IucG9zaXRpdmVNZXNzYWdlLCB0YXJnZXQ6IGluZGljYXRvci50YXJnZXQsIFwib3Bwb3J0dW5pdGllc1wiOiBpbmRpY2F0b3Iub3Bwb3J0dW5pdGllcyB8fCBbXSwgXCJwYXRpZW50c1wiOiB7fSB9O1xyXG5cclxuICAgICAgLy9hcHBseSB3aGljaCBjYXRlZ29yaWVzIHBlb3BsZSBiZWxvbmcgdG9cclxuICAgICAgZHQucGF0aWVudHMgPSB7fTtcclxuICAgICAgZHQucGF0aWVudEFycmF5ID0gW107XHJcblxyXG4gICAgICBPYmplY3Qua2V5cyhmaWxlLnBhdGllbnRzKS5mb3JFYWNoKGZ1bmN0aW9uKHBhdGllbnQpIHtcclxuICAgICAgICBkdC5wYXRpZW50QXJyYXkucHVzaChwYXRpZW50KTtcclxuICAgICAgICBkdC5wYXRpZW50c1twYXRpZW50XSA9IGZpbGUucGF0aWVudHNbcGF0aWVudF07XHJcbiAgICAgICAgZHQuaW5kaWNhdG9yc1tpbmRpY2F0b3IuaWRdLnBhdGllbnRzW3BhdGllbnRdID0ge307XHJcbiAgICAgICAgZHQuaW5kaWNhdG9yc1tpbmRpY2F0b3IuaWRdLnBhdGllbnRzW3BhdGllbnRdLm9wcG9ydHVuaXRpZXMgPSBbXTtcclxuICAgICAgICBkdC5pbmRpY2F0b3JzW2luZGljYXRvci5pZF0ub3Bwb3J0dW5pdGllcy5mb3JFYWNoKGZ1bmN0aW9uKG9wcCwgaWR4KSB7XHJcbiAgICAgICAgICBpZiAob3BwLnBhdGllbnRzLmluZGV4T2YoK3BhdGllbnQpID4gLTEpIHtcclxuICAgICAgICAgICAgZHQuaW5kaWNhdG9yc1tpbmRpY2F0b3IuaWRdLnBhdGllbnRzW3BhdGllbnRdLm9wcG9ydHVuaXRpZXMucHVzaChpZHgpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuXHJcbiAgfSxcclxuXHJcbiAgbG9hZDogZnVuY3Rpb24oZmlsZSkge1xyXG4gICAgdmFyIGQgPSBcIlwiLFxyXG4gICAgICBqLCBrLCBrZXksIGRhdGEgPSBmaWxlLmRpc2Vhc2VzO1xyXG5cclxuICAgIGR0ID0galF1ZXJ5LmV4dGVuZChkdCwgZGF0YSk7IC8vY29weVxyXG5cclxuICAgIGR0LnBhdGllbnRzID0gZmlsZS5wYXRpZW50cztcclxuICAgIGR0LmNvZGVzID0gZmlsZS5jb2RlcztcclxuICAgIGR0LnBhdGllbnRBcnJheSA9IFtdO1xyXG4gICAgZm9yICh2YXIgbyBpbiBmaWxlLnBhdGllbnRzKSB7XHJcbiAgICAgIGlmIChmaWxlLnBhdGllbnRzLmhhc093blByb3BlcnR5KG8pKSB7XHJcbiAgICAgICAgZHQucGF0aWVudEFycmF5LnB1c2gobyk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmb3IgKGQgaW4gZGF0YSkge1xyXG4gICAgICBkdC5wYXRod2F5TmFtZXNbZF0gPSBkYXRhW2RdW1wiZGlzcGxheS1uYW1lXCJdO1xyXG4gICAgICB2YXIgZGlzZWFzZU9iamVjdCA9IHtcclxuICAgICAgICBcImlkXCI6IGQsXHJcbiAgICAgICAgXCJsaW5rXCI6IGRhdGFbZF0ubGluayA/IGRhdGFbZF0ubGluayA6IFwiZHQvXCIgKyBkLFxyXG4gICAgICAgIFwiZmFJY29uXCI6IGRhdGFbZF0uaWNvbixcclxuICAgICAgICBcIm5hbWVcIjogZGF0YVtkXVtcImRpc3BsYXktbmFtZVwiXSxcclxuICAgICAgICBcInRleHRcIjoge1xyXG4gICAgICAgICAgXCJkdFwiOiB7XHJcbiAgICAgICAgICAgIFwidG9vbHRpcFwiOiBkYXRhW2RdW1wic2lkZS1wYW5lbC10b29sdGlwXCJdXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG4gICAgICBpZiAoZGF0YVtkXS5tb25pdG9yaW5nLnRleHQpIHtcclxuICAgICAgICBkaXNlYXNlT2JqZWN0LnRleHQubW9uaXRvcmluZyA9IGRhdGFbZF0ubW9uaXRvcmluZy50ZXh0LnNpZGVQYW5lbDtcclxuICAgICAgfVxyXG4gICAgICBpZiAoZGF0YVtkXS50cmVhdG1lbnQudGV4dCkge1xyXG4gICAgICAgIGRpc2Vhc2VPYmplY3QudGV4dC50cmVhdG1lbnQgPSBkYXRhW2RdLnRyZWF0bWVudC50ZXh0LnNpZGVQYW5lbDtcclxuICAgICAgfVxyXG4gICAgICBpZiAoZGF0YVtkXS5kaWFnbm9zaXMudGV4dCkge1xyXG4gICAgICAgIGRpc2Vhc2VPYmplY3QudGV4dC5kaWFnbm9zaXMgPSBkYXRhW2RdLmRpYWdub3Npcy50ZXh0LnNpZGVQYW5lbDtcclxuICAgICAgfVxyXG4gICAgICBpZiAoZGF0YVtkXS5leGNsdXNpb25zLnRleHQpIHtcclxuICAgICAgICBkaXNlYXNlT2JqZWN0LnRleHQuZXhjbHVzaW9ucyA9IGRhdGFbZF0uZXhjbHVzaW9ucy50ZXh0LnNpZGVQYW5lbDtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLmRpc2Vhc2VzLnB1c2goZGlzZWFzZU9iamVjdCk7XHJcbiAgICAgIGR0W2RdLnN1Z2dlc3Rpb25zID0gbG9nLnBsYW5bZF0udGVhbTtcclxuICAgICAgJC5leHRlbmQoZHRbZF0ubW9uaXRvcmluZywge1xyXG4gICAgICAgIFwiYnJlYWtkb3duXCI6IFtdLFxyXG4gICAgICAgIFwiYmRvd25cIjoge31cclxuICAgICAgfSk7XHJcbiAgICAgICQuZXh0ZW5kKGR0W2RdLnRyZWF0bWVudCwge1xyXG4gICAgICAgIFwiYnJlYWtkb3duXCI6IFtdLFxyXG4gICAgICAgIFwiYmRvd25cIjoge31cclxuICAgICAgfSk7XHJcbiAgICAgICQuZXh0ZW5kKGR0W2RdLmRpYWdub3Npcywge1xyXG4gICAgICAgIFwiYnJlYWtkb3duXCI6IFtdLFxyXG4gICAgICAgIFwiYmRvd25cIjoge31cclxuICAgICAgfSk7XHJcbiAgICAgICQuZXh0ZW5kKGR0W2RdLmV4Y2x1c2lvbnMsIHtcclxuICAgICAgICBcImJyZWFrZG93blwiOiBbXSxcclxuICAgICAgICBcImJkb3duXCI6IHt9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgaWYgKCFkdFtkXS5tb25pdG9yaW5nLmhlYWRlcikgY29udGludWU7XHJcbiAgICAgIGZvciAoa2V5IGluIGR0W2RdLm1vbml0b3Jpbmcuc3RhbmRhcmRzKSB7XHJcbiAgICAgICAgdGhpcy5vcHRpb25zLnB1c2goe1xyXG4gICAgICAgICAgXCJ2YWx1ZVwiOiB0aGlzLm9wdGlvbnMubGVuZ3RoLFxyXG4gICAgICAgICAgXCJwYXRod2F5SWRcIjogZCxcclxuICAgICAgICAgIFwicGF0aHdheVN0YWdlXCI6IFwibW9uaXRvcmluZ1wiLFxyXG4gICAgICAgICAgXCJzdGFuZGFyZFwiOiBrZXksXHJcbiAgICAgICAgICBcInRleHRcIjogdGhpcy5wYXRod2F5TmFtZXNbZF0gKyAnIC0gJyArIFwiTW9uaXRvcmluZ1wiICsgJyAtICcgKyBkdFtkXS5tb25pdG9yaW5nLnN0YW5kYXJkc1trZXldLnRhYi50aXRsZVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGZvciAoaiA9IDA7IGogPCBkdFtkXS5tb25pdG9yaW5nLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXMubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgIGR0W2RdLm1vbml0b3JpbmcuYmRvd25bZHRbZF0ubW9uaXRvcmluZy5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLm5hbWVdID0gZHRbZF0ubW9uaXRvcmluZy5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdO1xyXG4gICAgICAgICAgZHRbZF0ubW9uaXRvcmluZy5iZG93bltkdFtkXS5tb25pdG9yaW5nLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ubmFtZV0uc3VnZ2VzdGlvbnMgPSBsb2cucGxhbltkXS5tb25pdG9yaW5nLmluZGl2aWR1YWxbZHRbZF0ubW9uaXRvcmluZy5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLm5hbWVdO1xyXG4gICAgICAgICAgZm9yIChrID0gMDsgayA8IGR0W2RdLm1vbml0b3Jpbmcuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5wYXRpZW50cy5sZW5ndGg7IGsrKykge1xyXG4gICAgICAgICAgICBpZiAoIWR0LnBhdGllbnRzW2R0W2RdLm1vbml0b3Jpbmcuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5wYXRpZW50c1trXV0uYnJlYWNoKSBkdC5wYXRpZW50c1tkdFtkXS5tb25pdG9yaW5nLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ucGF0aWVudHNba11dLmJyZWFjaCA9IFtdO1xyXG4gICAgICAgICAgICBkdC5wYXRpZW50c1tkdFtkXS5tb25pdG9yaW5nLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ucGF0aWVudHNba11dLmJyZWFjaC5wdXNoKHtcclxuICAgICAgICAgICAgICBcInBhdGh3YXlJZFwiOiBkLFxyXG4gICAgICAgICAgICAgIFwicGF0aHdheVN0YWdlXCI6IFwibW9uaXRvcmluZ1wiLFxyXG4gICAgICAgICAgICAgIFwic3RhbmRhcmRcIjoga2V5LFxyXG4gICAgICAgICAgICAgIFwic3Vic2VjdGlvblwiOiBkdFtkXS5tb25pdG9yaW5nLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ubmFtZVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgZm9yIChrZXkgaW4gZHRbZF0uZGlhZ25vc2lzLnN0YW5kYXJkcykge1xyXG4gICAgICAgIHRoaXMub3B0aW9ucy5wdXNoKHtcclxuICAgICAgICAgIFwidmFsdWVcIjogdGhpcy5vcHRpb25zLmxlbmd0aCxcclxuICAgICAgICAgIFwicGF0aHdheUlkXCI6IGQsXHJcbiAgICAgICAgICBcInBhdGh3YXlTdGFnZVwiOiBcImRpYWdub3Npc1wiLFxyXG4gICAgICAgICAgXCJzdGFuZGFyZFwiOiBrZXksXHJcbiAgICAgICAgICBcInRleHRcIjogdGhpcy5wYXRod2F5TmFtZXNbZF0gKyAnIC0gJyArIFwiRGlhZ25vc2lzXCIgKyAnIC0gJyArIGR0W2RdLmRpYWdub3Npcy5zdGFuZGFyZHNba2V5XS50YWIudGl0bGVcclxuICAgICAgICB9KTtcclxuICAgICAgICBmb3IgKGogPSAwOyBqIDwgZHRbZF0uZGlhZ25vc2lzLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXMubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgIGR0W2RdLmRpYWdub3Npcy5iZG93bltkdFtkXS5kaWFnbm9zaXMuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5uYW1lXSA9IGR0W2RdLmRpYWdub3Npcy5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdO1xyXG4gICAgICAgICAgZHRbZF0uZGlhZ25vc2lzLmJkb3duW2R0W2RdLmRpYWdub3Npcy5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLm5hbWVdLnN1Z2dlc3Rpb25zID0gbG9nLnBsYW5bZF0uZGlhZ25vc2lzLmluZGl2aWR1YWxbZHRbZF0uZGlhZ25vc2lzLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ubmFtZV07XHJcbiAgICAgICAgICBmb3IgKGsgPSAwOyBrIDwgZHRbZF0uZGlhZ25vc2lzLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ucGF0aWVudHMubGVuZ3RoOyBrKyspIHtcclxuICAgICAgICAgICAgaWYgKCFkdC5wYXRpZW50c1tkdFtkXS5kaWFnbm9zaXMuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5wYXRpZW50c1trXV0uYnJlYWNoKSBkdC5wYXRpZW50c1tkdFtkXS5kaWFnbm9zaXMuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5wYXRpZW50c1trXV0uYnJlYWNoID0gW107XHJcbiAgICAgICAgICAgIGR0LnBhdGllbnRzW2R0W2RdLmRpYWdub3Npcy5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLnBhdGllbnRzW2tdXS5icmVhY2gucHVzaCh7XHJcbiAgICAgICAgICAgICAgXCJwYXRod2F5SWRcIjogZCxcclxuICAgICAgICAgICAgICBcInBhdGh3YXlTdGFnZVwiOiBcImRpYWdub3Npc1wiLFxyXG4gICAgICAgICAgICAgIFwic3RhbmRhcmRcIjoga2V5LFxyXG4gICAgICAgICAgICAgIFwic3Vic2VjdGlvblwiOiBkdFtkXS5kaWFnbm9zaXMuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5uYW1lXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBmb3IgKGtleSBpbiBkdFtkXS50cmVhdG1lbnQuc3RhbmRhcmRzKSB7XHJcbiAgICAgICAgdGhpcy5vcHRpb25zLnB1c2goe1xyXG4gICAgICAgICAgXCJ2YWx1ZVwiOiB0aGlzLm9wdGlvbnMubGVuZ3RoLFxyXG4gICAgICAgICAgXCJwYXRod2F5SWRcIjogZCxcclxuICAgICAgICAgIFwicGF0aHdheVN0YWdlXCI6IFwidHJlYXRtZW50XCIsXHJcbiAgICAgICAgICBcInN0YW5kYXJkXCI6IGtleSxcclxuICAgICAgICAgIFwidGV4dFwiOiB0aGlzLnBhdGh3YXlOYW1lc1tkXSArICcgLSAnICsgXCJUcmVhdG1lbnRcIiArICcgLSAnICsgZHRbZF0udHJlYXRtZW50LnN0YW5kYXJkc1trZXldLnRhYi50aXRsZVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGZvciAoaiA9IDA7IGogPCBkdFtkXS50cmVhdG1lbnQuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllcy5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgZHRbZF0udHJlYXRtZW50LmJkb3duW2R0W2RdLnRyZWF0bWVudC5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLm5hbWVdID0gZHRbZF0udHJlYXRtZW50LnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal07XHJcbiAgICAgICAgICBkdFtkXS50cmVhdG1lbnQuYmRvd25bZHRbZF0udHJlYXRtZW50LnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ubmFtZV0uc3VnZ2VzdGlvbnMgPSBsb2cucGxhbltkXS50cmVhdG1lbnQuaW5kaXZpZHVhbFtkdFtkXS50cmVhdG1lbnQuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5uYW1lXTtcclxuICAgICAgICAgIGZvciAoayA9IDA7IGsgPCBkdFtkXS50cmVhdG1lbnQuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5wYXRpZW50cy5sZW5ndGg7IGsrKykge1xyXG4gICAgICAgICAgICBpZiAoIWR0LnBhdGllbnRzW2R0W2RdLnRyZWF0bWVudC5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLnBhdGllbnRzW2tdXS5icmVhY2gpIGR0LnBhdGllbnRzW2R0W2RdLnRyZWF0bWVudC5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLnBhdGllbnRzW2tdXS5icmVhY2ggPSBbXTtcclxuICAgICAgICAgICAgZHQucGF0aWVudHNbZHRbZF0udHJlYXRtZW50LnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ucGF0aWVudHNba11dLmJyZWFjaC5wdXNoKHtcclxuICAgICAgICAgICAgICBcInBhdGh3YXlJZFwiOiBkLFxyXG4gICAgICAgICAgICAgIFwicGF0aHdheVN0YWdlXCI6IFwidHJlYXRtZW50XCIsXHJcbiAgICAgICAgICAgICAgXCJzdGFuZGFyZFwiOiBrZXksXHJcbiAgICAgICAgICAgICAgXCJzdWJzZWN0aW9uXCI6IGR0W2RdLnRyZWF0bWVudC5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLm5hbWVcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGZvciAoa2V5IGluIGR0W2RdLmV4Y2x1c2lvbnMuc3RhbmRhcmRzKSB7XHJcbiAgICAgICAgdGhpcy5vcHRpb25zLnB1c2goe1xyXG4gICAgICAgICAgXCJ2YWx1ZVwiOiB0aGlzLm9wdGlvbnMubGVuZ3RoLFxyXG4gICAgICAgICAgXCJwYXRod2F5SWRcIjogZCxcclxuICAgICAgICAgIFwicGF0aHdheVN0YWdlXCI6IFwiZXhjbHVzaW9uc1wiLFxyXG4gICAgICAgICAgXCJzdGFuZGFyZFwiOiBrZXksXHJcbiAgICAgICAgICBcInRleHRcIjogdGhpcy5wYXRod2F5TmFtZXNbZF0gKyAnIC0gJyArIFwiRXhjbHVzaW9uc1wiICsgJyAtICcgKyBkdFtkXS5leGNsdXNpb25zLnN0YW5kYXJkc1trZXldLnRhYi50aXRsZVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGZvciAoaiA9IDA7IGogPCBkdFtkXS5leGNsdXNpb25zLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXMubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgIGR0W2RdLmV4Y2x1c2lvbnMuYmRvd25bZHRbZF0uZXhjbHVzaW9ucy5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLm5hbWVdID0gZHRbZF0uZXhjbHVzaW9ucy5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdO1xyXG4gICAgICAgICAgZHRbZF0uZXhjbHVzaW9ucy5iZG93bltkdFtkXS5leGNsdXNpb25zLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ubmFtZV0uc3VnZ2VzdGlvbnMgPSBsb2cucGxhbltkXS5leGNsdXNpb25zLmluZGl2aWR1YWxbZHRbZF0uZXhjbHVzaW9ucy5zdGFuZGFyZHNba2V5XS5vcHBvcnR1bml0aWVzW2pdLm5hbWVdO1xyXG4gICAgICAgICAgZm9yIChrID0gMDsgayA8IGR0W2RdLmV4Y2x1c2lvbnMuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5wYXRpZW50cy5sZW5ndGg7IGsrKykge1xyXG4gICAgICAgICAgICBpZiAoIWR0LnBhdGllbnRzW2R0W2RdLmV4Y2x1c2lvbnMuc3RhbmRhcmRzW2tleV0ub3Bwb3J0dW5pdGllc1tqXS5wYXRpZW50c1trXV0uYnJlYWNoKSBkdC5wYXRpZW50c1tkdFtkXS5leGNsdXNpb25zLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ucGF0aWVudHNba11dLmJyZWFjaCA9IFtdO1xyXG4gICAgICAgICAgICBkdC5wYXRpZW50c1tkdFtkXS5leGNsdXNpb25zLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ucGF0aWVudHNba11dLmJyZWFjaC5wdXNoKHtcclxuICAgICAgICAgICAgICBcInBhdGh3YXlJZFwiOiBkLFxyXG4gICAgICAgICAgICAgIFwicGF0aHdheVN0YWdlXCI6IFwiZXhjbHVzaW9uc1wiLFxyXG4gICAgICAgICAgICAgIFwic3RhbmRhcmRcIjoga2V5LFxyXG4gICAgICAgICAgICAgIFwic3Vic2VjdGlvblwiOiBkdFtkXS5leGNsdXNpb25zLnN0YW5kYXJkc1trZXldLm9wcG9ydHVuaXRpZXNbal0ubmFtZVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9LFxyXG5cclxuICBnZXRBbGxJbmRpY2F0b3JEYXRhOiBmdW5jdGlvbihjYWxsYmFjaykge1xyXG4gICAgaWYgKGR0LmluZGljYXRvcnMpIHtcclxuICAgICAgcmV0dXJuIGNhbGxiYWNrKGR0LmluZGljYXRvcnMpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgX2dldEFsbEluZGljYXRvckRhdGEoY2FsbGJhY2spO1xyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIGdldEFsbEluZGljYXRvckRhdGFTeW5jOiBmdW5jdGlvbigpIHtcclxuICAgIGlmIChkdC5pbmRpY2F0b3JzKSB7XHJcbiAgICAgIHJldHVybiBkdC5pbmRpY2F0b3JzO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIF9nZXRBbGxJbmRpY2F0b3JEYXRhU3luYygpO1xyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIGdldEluZGljYXRvckRhdGE6IGZ1bmN0aW9uKGluZGljYXRvciwgY2FsbGJhY2spIHtcclxuICAgIGlmICghZHQuaW5kaWNhdG9ycykge1xyXG4gICAgICBfZ2V0QWxsSW5kaWNhdG9yRGF0YShmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgX2dldEluZGljYXRvckRhdGEoaW5kaWNhdG9yLCBjYWxsYmFjayk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSBlbHNlIGlmIChkdC5pbmRpY2F0b3JzICYmIGR0LmluZGljYXRvcnNbaW5kaWNhdG9yXSkge1xyXG4gICAgICByZXR1cm4gY2FsbGJhY2soZHQuaW5kaWNhdG9yc1tpbmRpY2F0b3JdKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIF9nZXRJbmRpY2F0b3JEYXRhKGluZGljYXRvciwgY2FsbGJhY2spO1xyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIGdldEluZGljYXRvckRhdGFTeW5jOiBmdW5jdGlvbihpbmRpY2F0b3IpIHtcclxuICAgIGR0LmdldEFsbEluZGljYXRvckRhdGFTeW5jKCk7XHJcbiAgICBpZiAoZHQuaW5kaWNhdG9yc1tpbmRpY2F0b3JdKSB7XHJcbiAgICAgIHJldHVybiBkdC5pbmRpY2F0b3JzW2luZGljYXRvcl07XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gX2dldEluZGljYXRvckRhdGFTeW5jKGluZGljYXRvcik7XHJcbiAgICB9XHJcbiAgfSxcclxuXHJcbiAgZ2V0UGF0aWVudERhdGE6IGZ1bmN0aW9uKHBhdGllbnRJZCwgY2FsbGJhY2spIHtcclxuICAgIHJldHVybiBfZ2V0UGF0aWVudERhdGEocGF0aWVudElkLCBjYWxsYmFjayk7XHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gZHQ7XHJcbiIsInZhciBkYXRhID0gcmVxdWlyZSgnLi9kYXRhLmpzJyksXHJcbk11c3RhY2hlID0gcmVxdWlyZSgnbXVzdGFjaGUnKTtcclxuXHJcbnZhciBsYXlvdXQgPSB7XHJcblxyXG4gIGVsZW1lbnRzOiB7fSxcclxuXHJcbiAgLy9TaWRlIHBhbmVsLCBuYXZpZ2F0aW9uLCBoZWFkZXIgYmFyIGFuZCBtYWluIHBhZ2VcclxuICBzaG93TWFpblZpZXc6IGZ1bmN0aW9uKCkge1xyXG4gICAgLy9TZXQgdXAgbmF2aWdhdGlvbiBwYW5lbFxyXG4gICAgLy8vL2xheW91dC5zaG93U2lkZVBhbmVsKCk7XHJcbiAgICAvLy8vbGF5b3V0LnNob3dOYXZpZ2F0aW9uKGRhdGEuZGlzZWFzZXMsIGlkeCwgJCgnI21haW4tZGFzaGJvYXJkJykpO1xyXG5cclxuICAgICQoJyNib3R0b21uYXZiYXInKS5oaWRlKCk7XHJcbiAgICBsYXlvdXQuc2hvd0hlYWRlckJhckl0ZW1zKCk7XHJcblxyXG4gICAgLy9TaG93IG1haW4gZGFzaGJvYXJkIHBhZ2VcclxuICAgIGxheW91dC5zaG93UGFnZSgnbWFpbi1kYXNoYm9hcmQnKTtcclxuICB9LFxyXG5cclxuICBjbGVhck5hdmlnYXRpb246IGZ1bmN0aW9uKCkge1xyXG4gICAgJChcImFzaWRlLmxlZnQtcGFuZWwgbmF2Lm5hdmlnYXRpb24gPiB1bCA+IGxpID4gdWxcIikuc2xpZGVVcCgzMDApO1xyXG4gICAgJChcImFzaWRlLmxlZnQtcGFuZWwgbmF2Lm5hdmlnYXRpb24gPiB1bCA+IGxpXCIpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICB9LFxyXG5cclxuICBzaG93TmF2aWdhdGlvbjogZnVuY3Rpb24obGlzdCwgaWR4LCBwYXJlbnQpIHtcclxuICAgIGlmIChsYXlvdXQuZWxlbWVudHMubmF2aWdhdGlvbikge1xyXG5cclxuICAgICAgaWYgKGlkeCA9PT0gLTEpIHtcclxuICAgICAgICBsYXlvdXQuY2xlYXJOYXZpZ2F0aW9uKCk7XHJcbiAgICAgICAgJCgnYXNpZGUgYVtocmVmPVwiI3dlbGNvbWVcIl06Zmlyc3QnKS5jbG9zZXN0KCdsaScpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgfSBlbHNlIGlmIChpZHggPj0gbGlzdC5sZW5ndGgpIHtcclxuICAgICAgICBsYXlvdXQuY2xlYXJOYXZpZ2F0aW9uKCk7XHJcbiAgICAgICAgJCgnYXNpZGUgYVtocmVmPVwiI3BhdGllbnRzXCJdJykuY2xvc2VzdCgnbGknKS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgIH0gZWxzZSBpZiAoISQoJ2FzaWRlIGFbaHJlZj1cIiMnICsgbGlzdFtpZHhdLmxpbmsgKyAnXCJdOmZpcnN0JykuY2xvc2VzdCgnbGknKS5oYXNDbGFzcygnYWN0aXZlJykpIHtcclxuICAgICAgICBsYXlvdXQuY2xlYXJOYXZpZ2F0aW9uKCk7XHJcbiAgICAgICAgLy9zZXQgYWN0aXZlXHJcbiAgICAgICAgJCgnYXNpZGUgYVtocmVmPVwiIycgKyBsaXN0W2lkeF0ubGluayArICdcIl0nKS5uZXh0KCkuc2xpZGVUb2dnbGUoMzAwKTtcclxuICAgICAgICAkKCdhc2lkZSBhW2hyZWY9XCIjJyArIGxpc3RbaWR4XS5saW5rICsgJ1wiXScpLmNsb3Nlc3QoJ2xpJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIHRlbXBNdXN0ID0gJCgnI3BhdGh3YXktcGlja2VyJykuaHRtbCgpO1xyXG4gICAgdmFyIGl0ZW1UZW1wbGF0ZSA9ICQoJyNwYXRod2F5LXBpY2tlci1pdGVtJykuaHRtbCgpO1xyXG4gICAgTXVzdGFjaGUucGFyc2UodGVtcE11c3QpO1xyXG4gICAgTXVzdGFjaGUucGFyc2UoaXRlbVRlbXBsYXRlKTtcclxuXHJcbiAgICBsaXN0ID0gbGlzdC5zbGljZSgpO1xyXG4gICAgbGlzdFswXS5pc0JyZWFrQWJvdmVQcmFjdGljZSA9IHRydWU7XHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcclxuICAgICAgbGlzdFtpXS5oYXNTdWJJdGVtcyA9IHRydWU7XHJcbiAgICB9XHJcbiAgICBsaXN0LnVuc2hpZnQoe1xyXG4gICAgICBcImxpbmtcIjogXCJ3ZWxjb21lXCIsXHJcbiAgICAgIFwiZmFJY29uXCI6IFwiZmEtaG9tZVwiLFxyXG4gICAgICBcIm5hbWVcIjogXCJBZ3JlZWQgYWN0aW9uc1wiLFxyXG4gICAgICBcImlzQnJlYWtBYm92ZUhvbWVcIjogdHJ1ZSxcclxuICAgICAgXCJ0ZXh0XCI6IHtcclxuICAgICAgICBcIm1haW5cIjoge1xyXG4gICAgICAgICAgXCJ0b29sdGlwXCI6IFwiQWdyZWVkIHRvb2x0aXAgLSBlZGl0IGluIHNjcmlwdC5qc1wiXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIGxpc3QucHVzaCh7XHJcbiAgICAgIFwibGlua1wiOiBcInBhdGllbnRzXCIsXHJcbiAgICAgIFwiZmFJY29uXCI6IFwiZmEtdXNlcnNcIixcclxuICAgICAgXCJuYW1lXCI6IFwiQWxsIFBhdGllbnRzXCIsXHJcbiAgICAgIFwiaXNCcmVha0Fib3ZlUGF0aWVudFwiOiB0cnVlLFxyXG4gICAgICBcInRleHRcIjoge1xyXG4gICAgICAgIFwibWFpblwiOiB7XHJcbiAgICAgICAgICBcInRvb2x0aXBcIjogXCJBbGwgcGF0aWVudHMgdG9vbHRpcCAtIGVkaXQgaW4gc2NyaXB0LmpzXCJcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGxpc3QubWFwKGZ1bmN0aW9uKHYsIGksIGFycikge1xyXG4gICAgICB2LmlzU2VsZWN0ZWQgPSBpID09PSBpZHggKyAxO1xyXG4gICAgICByZXR1cm4gdjtcclxuICAgIH0pO1xyXG5cclxuICAgIHZhciByZW5kZXJlZEJlZm9yZSA9IE11c3RhY2hlLnJlbmRlcih0ZW1wTXVzdCwge1xyXG4gICAgICBcIml0ZW1zXCI6IGxpc3RcclxuICAgIH0sIHtcclxuICAgICAgXCJpdGVtXCI6IGl0ZW1UZW1wbGF0ZSxcclxuICAgICAgXCJzdWJJdGVtXCI6ICQoJyNwYXRod2F5LXBpY2tlci1zdWItaXRlbScpLmh0bWwoKVxyXG4gICAgfSk7XHJcbiAgICAkKCcjYXNpZGUtdG9nZ2xlIG5hdjpmaXJzdCcpLmh0bWwocmVuZGVyZWRCZWZvcmUpO1xyXG5cclxuICAgICQoJy51c2VyJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIHRlbXBsYXRlLmxvYWRDb250ZW50KCcjYWdyZWVkYWN0aW9ucycpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgbGF5b3V0LmVsZW1lbnRzLm5hdmlnYXRpb24gPSB0cnVlO1xyXG4gIH0sXHJcblxyXG4gIHNob3dQYWdlOiBmdW5jdGlvbihwYWdlKSB7XHJcbiAgICBpZiAobGF5b3V0LnBhZ2UgPT09IHBhZ2UpIHJldHVybjtcclxuICAgIGxheW91dC5wYWdlID0gcGFnZTtcclxuICAgICQoJy5wYWdlJykuaGlkZSgpO1xyXG4gICAgJCgnIycgKyBwYWdlKS5zaG93KCk7XHJcblxyXG4gICAgaWYgKHBhZ2UgIT09ICdtYWluLWRhc2hib2FyZCcpIHtcclxuICAgICAgLy8vL2xheW91dC5oaWRlU2lkZVBhbmVsKCk7XHJcbiAgICAgICQoJyNib3R0b21uYXZiYXInKS5zaG93KCk7XHJcbiAgICAgIGxheW91dC5oaWRlSGVhZGVyQmFySXRlbXMoKTtcclxuICAgIH1cclxuICB9LFxyXG5cclxuICBzaG93U2lkZVBhbmVsOiBmdW5jdGlvbigpIHtcclxuICAgIGlmIChsYXlvdXQuZWxlbWVudHMubmF2aWd0aW9uKSByZXR1cm47XHJcbiAgICBsYXlvdXQuZWxlbWVudHMubmF2aWd0aW9uID0gdHJ1ZTtcclxuICAgICQoJyNtYWluJykuYWRkQ2xhc3MoJ2NvbnRlbnQnKTtcclxuICAgICQoJyN0b3BuYXZiYXInKS5hZGRDbGFzcygnZnVsbCcpO1xyXG4gICAgJCgnI2FzaWRlLXRvZ2dsZScpLnNob3coKTtcclxuICAgICQoJyNib3R0b21uYXZiYXInKS5oaWRlKCk7XHJcbiAgfSxcclxuXHJcbiAgaGlkZVNpZGVQYW5lbDogZnVuY3Rpb24oKSB7XHJcbiAgICBpZiAobGF5b3V0LmVsZW1lbnRzLm5hdmlndGlvbiA9PT0gZmFsc2UpIHJldHVybjtcclxuICAgIGxheW91dC5lbGVtZW50cy5uYXZpZ3Rpb24gPSBmYWxzZTtcclxuICAgICQoJyNtYWluJykucmVtb3ZlQ2xhc3MoJ2NvbnRlbnQnKTtcclxuICAgICQoJyN0b3BuYXZiYXInKS5yZW1vdmVDbGFzcygnZnVsbCcpO1xyXG4gICAgJCgnI2FzaWRlLXRvZ2dsZScpLmhpZGUoKTtcclxuICAgICQoJyNib3R0b21uYXZiYXInKS5zaG93KCk7XHJcbiAgfSxcclxuXHJcbiAgc2hvd0hlYWRlckJhckl0ZW1zOiBmdW5jdGlvbigpIHtcclxuICAgIGlmIChsYXlvdXQuZWxlbWVudHMuaGVhZGVyYmFyKSByZXR1cm47XHJcbiAgICBsYXlvdXQuZWxlbWVudHMuaGVhZGVyYmFyID0gdHJ1ZTtcclxuICAgICQoJy5oaWRlLWlmLWxvZ2dlZC1vdXQnKS5zaG93KCk7XHJcbiAgfSxcclxuXHJcbiAgaGlkZUhlYWRlckJhckl0ZW1zOiBmdW5jdGlvbigpIHtcclxuICAgIGlmIChsYXlvdXQuZWxlbWVudHMuaGVhZGVyYmFyID09PSBmYWxzZSkgcmV0dXJuO1xyXG4gICAgbGF5b3V0LmVsZW1lbnRzLmhlYWRlcmJhciA9IGZhbHNlO1xyXG4gICAgJCgnLmhpZGUtaWYtbG9nZ2VkLW91dCcpLmhpZGUoKTtcclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBsYXlvdXQ7XHJcbiIsInZhciBub3RpZnkgPSByZXF1aXJlKCcuL25vdGlmeS5qcycpO1xyXG5cclxudmFyIGxvZyA9IHtcclxuICByZWFzb246IHt9LFxyXG5cclxuICBnZXRPYmo6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcclxuICAgIHZhciBvYmogPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5iYik7XHJcblxyXG4gICAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIG9wdGlvbnMuZm9yRWFjaChmdW5jdGlvbihvcHQpIHtcclxuICAgICAgICBpZiAoIW9ialtvcHQubmFtZV0pIHtcclxuICAgICAgICAgIG9ialtvcHQubmFtZV0gPSBvcHQudmFsdWU7XHJcbiAgICAgICAgICBsb2cuc2V0T2JqKG9iaik7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gb2JqO1xyXG4gIH0sXHJcblxyXG4gIHNldE9iajogZnVuY3Rpb24ob2JqKSB7XHJcbiAgICBsb2NhbFN0b3JhZ2UuYmIgPSBKU09OLnN0cmluZ2lmeShvYmopO1xyXG4gIH0sXHJcblxyXG4gIGxvYWRBY3Rpb25zOiBmdW5jdGlvbihjYWxsYmFjaykge1xyXG4gICAgdmFyIHIgPSBNYXRoLnJhbmRvbSgpO1xyXG4gICAgJC5nZXRKU09OKFwiYWN0aW9uLXBsYW4uanNvbj92PVwiICsgciwgZnVuY3Rpb24oZmlsZSkge1xyXG4gICAgICBsb2cucGxhbiA9IGZpbGUuZGlzZWFzZXM7XHJcbiAgICAgIGxvZy50ZXh0ID0gZmlsZS5wbGFucztcclxuICAgICAgY2FsbGJhY2soKTtcclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIGVkaXRBY3Rpb246IGZ1bmN0aW9uKGlkLCBhY3Rpb25JZCwgYWdyZWUsIGRvbmUsIHJlYXNvbikge1xyXG4gICAgdmFyIGxvZ1RleHQsIG9iaiA9IGxvZy5nZXRPYmooW3tcclxuICAgICAgbmFtZTogXCJhY3Rpb25zXCIsXHJcbiAgICAgIHZhbHVlOiB7fVxyXG4gICAgfV0pO1xyXG4gICAgaWYgKCFpZCkgYWxlcnQoXCJBQ1RJT04gVEVBTS9JTkQgSURcIik7XHJcbiAgICBpZiAoIWFjdGlvbklkKSBhbGVydChcIkFDVElPTiBJRFwiKTtcclxuXHJcbiAgICBpZiAoIW9iai5hY3Rpb25zW2lkXSkge1xyXG4gICAgICBvYmouYWN0aW9uc1tpZF0gPSB7fTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgaWYgKGFncmVlKSB7XHJcbiAgICAgIGxvZ1RleHQgPSBcIllvdSBhZ3JlZWQgd2l0aCB0aGlzIHN1Z2dlc3RlZCBhY3Rpb24gb24gXCIgKyAobmV3IERhdGUoKSkudG9EYXRlU3RyaW5nKCk7XHJcbiAgICB9IGVsc2UgaWYgKGFncmVlID09PSBmYWxzZSkge1xyXG4gICAgICB2YXIgcmVhc29uVGV4dCA9IGxvZy5yZWFzb24ucmVhc29uID09PSBcIlwiICYmIGxvZy5yZWFzb24ucmVhc29uVGV4dCA9PT0gXCJcIiA/IFwiIC0gbm8gcmVhc29uIGdpdmVuXCIgOiBcIiAuIFlvdSBkaXNhZ3JlZWQgYmVjYXVzZSB5b3Ugc2FpZDogJ1wiICsgbG9nLnJlYXNvbi5yZWFzb24gKyBcIjsgXCIgKyBsb2cucmVhc29uLnJlYXNvblRleHQgKyBcIi4nXCI7XHJcbiAgICAgIGxvZ1RleHQgPSBcIllvdSBkaXNhZ3JlZWQgd2l0aCB0aGlzIGFjdGlvbiBvbiBcIiArIChuZXcgRGF0ZSgpKS50b0RhdGVTdHJpbmcoKSArIHJlYXNvblRleHQ7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGRvbmUpIHtcclxuICAgICAgbG9nVGV4dCA9IFwiWW91IGFncmVlZCB3aXRoIHRoaXMgc3VnZ2VzdGVkIGFjdGlvbiBvbiBcIiArIChuZXcgRGF0ZSgpKS50b0RhdGVTdHJpbmcoKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIW9iai5hY3Rpb25zW2lkXVthY3Rpb25JZF0pIHtcclxuICAgICAgb2JqLmFjdGlvbnNbaWRdW2FjdGlvbklkXSA9IHtcclxuICAgICAgICBcImFncmVlXCI6IGFncmVlID8gYWdyZWUgOiBmYWxzZSxcclxuICAgICAgICBcImRvbmVcIjogZG9uZSA/IGRvbmUgOiBmYWxzZSxcclxuICAgICAgICBcImhpc3RvcnlcIjogW2xvZ1RleHRdXHJcbiAgICAgIH07XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBpZiAoYWdyZWUgPT09IHRydWUgfHwgYWdyZWUgPT09IGZhbHNlKSBvYmouYWN0aW9uc1tpZF1bYWN0aW9uSWRdLmFncmVlID0gYWdyZWU7XHJcbiAgICAgIGlmIChkb25lID09PSB0cnVlIHx8IGRvbmUgPT09IGZhbHNlKSBvYmouYWN0aW9uc1tpZF1bYWN0aW9uSWRdLmRvbmUgPSBkb25lO1xyXG4gICAgICBpZiAobG9nVGV4dCkge1xyXG4gICAgICAgIGlmIChvYmouYWN0aW9uc1tpZF1bYWN0aW9uSWRdLmhpc3RvcnkpIG9iai5hY3Rpb25zW2lkXVthY3Rpb25JZF0uaGlzdG9yeS51bnNoaWZ0KGxvZ1RleHQpO1xyXG4gICAgICAgIGVsc2Ugb2JqLmFjdGlvbnNbaWRdW2FjdGlvbklkXS5kb25lLmhpc3RvcnkgPSBbbG9nVGV4dF07XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBpZiAocmVhc29uICYmIG9iai5hY3Rpb25zW2lkXVthY3Rpb25JZF0uYWdyZWUgPT09IGZhbHNlKSB7XHJcbiAgICAgIG9iai5hY3Rpb25zW2lkXVthY3Rpb25JZF0ucmVhc29uID0gcmVhc29uO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgZGVsZXRlIG9iai5hY3Rpb25zW2lkXVthY3Rpb25JZF0ucmVhc29uO1xyXG4gICAgfVxyXG5cclxuICAgIGxvZy5zZXRPYmoob2JqKTtcclxuICAgIG5vdGlmeS5zaG93U2F2ZWQoKTtcclxuICB9LFxyXG5cclxuICBpZ25vcmVBY3Rpb246IGZ1bmN0aW9uKGlkLCBhY3Rpb25JZCkge1xyXG4gICAgdmFyIG9iaiA9IGxvZy5nZXRPYmooW3tcclxuICAgICAgbmFtZTogXCJhY3Rpb25zXCIsXHJcbiAgICAgIHZhbHVlOiB7fVxyXG4gICAgfV0pO1xyXG4gICAgb2JqLmFjdGlvbnNbaWRdW2FjdGlvbklkXS5hZ3JlZSA9IG51bGw7XHJcbiAgICBkZWxldGUgb2JqLmFjdGlvbnNbaWRdW2FjdGlvbklkXS5yZWFzb247XHJcbiAgICBsb2cuc2V0T2JqKG9iaik7XHJcbiAgfSxcclxuXHJcbiAgZ2V0QWN0aW9uczogZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4gbG9nLmdldE9iaihbe1xyXG4gICAgICBuYW1lOiBcImFjdGlvbnNcIixcclxuICAgICAgdmFsdWU6IHt9XHJcbiAgICB9XSkuYWN0aW9ucztcclxuICB9LFxyXG5cclxuICBsaXN0QWN0aW9uczogZnVuY3Rpb24oaWQsIHBhdGh3YXlJZCkge1xyXG4gICAgdmFyIG9iaiA9IGxvZy5nZXRPYmooW3tcclxuICAgICAgbmFtZTogXCJhY3Rpb25zXCIsXHJcbiAgICAgIHZhbHVlOiB7fVxyXG4gICAgfV0pO1xyXG4gICAgYXJyID0gW107XHJcbiAgICBpZiAoIWlkKSByZXR1cm4gb2JqLmFjdGlvbnM7XHJcbiAgICBpZiAoIW9iai5hY3Rpb25zW2lkXSkgcmV0dXJuIGFycjtcclxuICAgIGZvciAodmFyIHByb3AgaW4gb2JqLmFjdGlvbnNbaWRdKSB7XHJcbiAgICAgIG9iai5hY3Rpb25zW2lkXVtwcm9wXS5pZCA9IHByb3A7XHJcbiAgICAgIGlmICghb2JqLmFjdGlvbnNbaWRdW3Byb3BdLnRleHQpXHJcbiAgICAgICAgYXJyLnB1c2gob2JqLmFjdGlvbnNbaWRdW3Byb3BdKTtcclxuICAgIH1cclxuICAgIHJldHVybiBhcnI7XHJcbiAgfSxcclxuXHJcbiAgLy9pZCBpcyBlaXRoZXIgXCJ0ZWFtXCIgb3IgdGhlIHBhdGllbnRJZFxyXG4gIHJlY29yZEZlZWRiYWNrOiBmdW5jdGlvbihwYXRod2F5SWQsIGlkLCBzdWdnZXN0aW9uLCByZWFzb24sIHJlYXNvblRleHQpIHtcclxuICAgIGxvZy5yZWFzb24gPSB7XHJcbiAgICAgIFwicmVhc29uXCI6IHJlYXNvbixcclxuICAgICAgXCJyZWFzb25UZXh0XCI6IHJlYXNvblRleHRcclxuICAgIH07XHJcbiAgICB2YXIgb2JqID0gbG9nLmdldE9iaihbe1xyXG4gICAgICBuYW1lOiBcImZlZWRiYWNrXCIsXHJcbiAgICAgIHZhbHVlOiBbXVxyXG4gICAgfV0pO1xyXG5cclxuICAgIHZhciBpdGVtID0ge1xyXG4gICAgICBcInBhdGh3YXlJZFwiOiBwYXRod2F5SWQsXHJcbiAgICAgIFwiaWRcIjogaWQsXHJcbiAgICAgIFwidmFsXCI6IHN1Z2dlc3Rpb25cclxuICAgIH07XHJcbiAgICBpZiAocmVhc29uVGV4dCAhPT0gXCJcIikgaXRlbS5yZWFzb25UZXh0ID0gcmVhc29uVGV4dDtcclxuICAgIGlmIChyZWFzb24gIT09IFwiXCIpIGl0ZW0ucmVhc29uID0gcmVhc29uO1xyXG4gICAgb2JqLmZlZWRiYWNrLnB1c2goaXRlbSk7XHJcbiAgICBsb2cuc2V0T2JqKG9iaik7XHJcbiAgfSxcclxuXHJcbiAgZ2V0RXZlbnRzOiBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiBsb2cuZ2V0T2JqKFt7XHJcbiAgICAgIG5hbWU6IFwiZXZlbnRzXCIsXHJcbiAgICAgIHZhbHVlOiBbXVxyXG4gICAgfV0pLmV2ZW50cztcclxuICB9LFxyXG5cclxuICByZWNvcmRFdmVudDogZnVuY3Rpb24ocGF0aHdheUlkLCBpZCwgbmFtZSkge1xyXG4gICAgdmFyIG9iaiA9IGxvZy5nZXRPYmooW3tcclxuICAgICAgbmFtZTogXCJldmVudHNcIixcclxuICAgICAgdmFsdWU6IFtdXHJcbiAgICB9XSk7XHJcbiAgICBvYmouZXZlbnRzLnB1c2goe1xyXG4gICAgICBcInBhdGh3YXlJZFwiOiBwYXRod2F5SWQsXHJcbiAgICAgIFwiaWRcIjogaWQsXHJcbiAgICAgIFwibmFtZVwiOiBuYW1lLFxyXG4gICAgICBcImRhdGVcIjogbmV3IERhdGUoKVxyXG4gICAgfSk7XHJcbiAgICBsb2cuc2V0T2JqKG9iaik7XHJcbiAgfSxcclxuXHJcbiAgcmVjb3JkUGxhbjogZnVuY3Rpb24oaWQsIHRleHQsIHBhdGh3YXlJZCkge1xyXG4gICAgaWYgKCFpZCkgYWxlcnQoXCJQTEFOXCIpO1xyXG4gICAgdmFyIG9iaiA9IGxvZy5nZXRPYmooW3tcclxuICAgICAgbmFtZTogXCJhY3Rpb25zXCIsXHJcbiAgICAgIHZhbHVlOiB7fVxyXG4gICAgfV0pO1xyXG5cclxuICAgIGlmICghb2JqLmFjdGlvbnNbaWRdKSBvYmouYWN0aW9uc1tpZF0gPSB7fTtcclxuICAgIHZhciBwbGFuSWQgPSBEYXRlLm5vdygpICsgXCJcIjtcclxuICAgIG9iai5hY3Rpb25zW2lkXVtwbGFuSWRdID0ge1xyXG4gICAgICBcInRleHRcIjogdGV4dCxcclxuICAgICAgXCJhZ3JlZVwiOiBudWxsLFxyXG4gICAgICBcImRvbmVcIjogZmFsc2UsXHJcbiAgICAgIFwicGF0aHdheUlkXCI6IHBhdGh3YXlJZCxcclxuICAgICAgXCJoaXN0b3J5XCI6IFtcIllvdSBhZGRlZCB0aGlzIG9uIFwiICsgKG5ldyBEYXRlKCkpLnRvRGF0ZVN0cmluZygpXVxyXG4gICAgfTtcclxuXHJcbiAgICBsb2cuc2V0T2JqKG9iaik7XHJcbiAgICByZXR1cm4gcGxhbklkO1xyXG4gIH0sXHJcblxyXG4gIGZpbmRQbGFuOiBmdW5jdGlvbihvYmosIHBsYW5JZCkge1xyXG4gICAgZm9yICh2YXIgayBpbiBvYmouYWN0aW9ucykge1xyXG4gICAgICBpZiAob2JqLmFjdGlvbnNba11bcGxhbklkXSAmJiBvYmouYWN0aW9uc1trXVtwbGFuSWRdLnRleHQpIHJldHVybiBrO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIC0xO1xyXG4gIH0sXHJcblxyXG4gIGVkaXRQbGFuOiBmdW5jdGlvbihwbGFuSWQsIHRleHQsIGRvbmUpIHtcclxuICAgIHZhciBvYmogPSBsb2cuZ2V0T2JqKFt7XHJcbiAgICAgIG5hbWU6IFwiYWN0aW9uc1wiLFxyXG4gICAgICB2YWx1ZToge31cclxuICAgIH1dKTtcclxuICAgIHZhciBpZCA9IGxvZy5maW5kUGxhbihvYmosIHBsYW5JZCk7XHJcbiAgICBpZiAodGV4dCkgb2JqLmFjdGlvbnNbaWRdW3BsYW5JZF0udGV4dCA9IHRleHQ7XHJcbiAgICBpZiAoZG9uZSA9PT0gdHJ1ZSB8fCBkb25lID09PSBmYWxzZSkgb2JqLmFjdGlvbnNbaWRdW3BsYW5JZF0uZG9uZSA9IGRvbmU7XHJcbiAgICBsb2cuc2V0T2JqKG9iaik7XHJcbiAgfSxcclxuXHJcbiAgZGVsZXRlUGxhbjogZnVuY3Rpb24ocGxhbklkKSB7XHJcbiAgICB2YXIgb2JqID0gbG9nLmdldE9iaihbe1xyXG4gICAgICBuYW1lOiBcImFjdGlvbnNcIixcclxuICAgICAgdmFsdWU6IHt9XHJcbiAgICB9XSk7XHJcbiAgICB2YXIgaWQgPSBsb2cuZmluZFBsYW4ob2JqLCBwbGFuSWQpO1xyXG4gICAgZGVsZXRlIG9iai5hY3Rpb25zW2lkXVtwbGFuSWRdO1xyXG4gICAgbG9nLnNldE9iaihvYmopO1xyXG4gIH0sXHJcblxyXG4gIGxpc3RQbGFuczogZnVuY3Rpb24oaWQsIHBhdGh3YXlJZCkge1xyXG4gICAgdmFyIG9iaiA9IGxvZy5nZXRPYmooW3tcclxuICAgICAgICBuYW1lOiBcImFjdGlvbnNcIixcclxuICAgICAgICB2YWx1ZToge31cclxuICAgICAgfV0pLFxyXG4gICAgICBhcnIgPSBbXTtcclxuICAgIGlmICghaWQpIHJldHVybiBvYmouYWN0aW9ucztcclxuICAgIGZvciAodmFyIHByb3AgaW4gb2JqLmFjdGlvbnNbaWRdKSB7XHJcbiAgICAgIG9iai5hY3Rpb25zW2lkXVtwcm9wXS5pZCA9IHByb3A7XHJcbiAgICAgIGlmICgoIXBhdGh3YXlJZCB8fCBwYXRod2F5SWQgPT09IG9iai5hY3Rpb25zW2lkXVtwcm9wXS5wYXRod2F5SWQpICYmIG9iai5hY3Rpb25zW2lkXVtwcm9wXS50ZXh0KSBhcnIucHVzaChvYmouYWN0aW9uc1tpZF1bcHJvcF0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFycjtcclxuICB9LFxyXG5cclxuICBnZXRSZWFzb246IGZ1bmN0aW9uKGlkLCBhY3Rpb25JZCkge1xyXG4gICAgdmFyIG9iaiA9IGxvZy5nZXRPYmooW3tcclxuICAgICAgbmFtZTogXCJhY3Rpb25zXCIsXHJcbiAgICAgIHZhbHVlOiB7fVxyXG4gICAgfV0pO1xyXG5cclxuICAgIGlmIChvYmouYWN0aW9uc1tpZF0gJiYgb2JqLmFjdGlvbnNbaWRdW2FjdGlvbklkXSkgcmV0dXJuIG9iai5hY3Rpb25zW2lkXVthY3Rpb25JZF0ucmVhc29uO1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfSxcclxuXHJcbiAgZ2V0QWdyZWVSZWFzb246IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkLCBpdGVtKSB7XHJcbiAgICB2YXIgb2JqID0gbG9nLmdldE9iaihbe1xyXG4gICAgICBuYW1lOiBcImFncmVlc1wiLFxyXG4gICAgICB2YWx1ZToge31cclxuICAgIH1dKTtcclxuICAgIGlmICghcGF0aHdheUlkIHx8ICFwYXRod2F5U3RhZ2UpIGFsZXJ0KFwiRURJVFBBVElFTlRBR1JFRVwiKTtcclxuXHJcbiAgICBpZiAoIW9iai5hZ3JlZXNbcGF0aWVudElkXSkgb2JqLmFncmVlc1twYXRpZW50SWRdID0gW107XHJcbiAgICB2YXIgaXRlbXMgPSBvYmouYWdyZWVzW3BhdGllbnRJZF0uZmlsdGVyKGZ1bmN0aW9uKHZhbCkge1xyXG4gICAgICByZXR1cm4gdmFsLnBhdGh3YXlJZCA9PT0gcGF0aHdheUlkICYmIHZhbC5wYXRod2F5U3RhZ2UgPT09IHBhdGh3YXlTdGFnZSAmJiB2YWwuc3RhbmRhcmQgPT09IHN0YW5kYXJkICYmIHZhbC5pdGVtID09PSBpdGVtO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIGl0ZW1zLmxlbmd0aCA9PT0gMSA/IGl0ZW1zWzBdLnJlYXNvbiB8fCB7fSA6IHt9O1xyXG4gIH0sXHJcblxyXG4gIGVkaXRQYXRpZW50QWdyZWU6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkLCBpdGVtLCBhZ3JlZSwgcmVhc29uKSB7XHJcbiAgICB2YXIgb2JqID0gbG9nLmdldE9iaigpO1xyXG4gICAgaWYgKCFwYXRod2F5SWQgfHwgIXBhdGh3YXlTdGFnZSkgYWxlcnQoXCJFRElUUEFUSUVOVEFHUkVFXCIpO1xyXG5cclxuICAgIGlmICghb2JqLmFncmVlc1twYXRpZW50SWRdKSBvYmouYWdyZWVzW3BhdGllbnRJZF0gPSBbXTtcclxuICAgIHZhciBpdGVtcyA9IG9iai5hZ3JlZXNbcGF0aWVudElkXS5maWx0ZXIoZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgIHJldHVybiB2YWwucGF0aHdheUlkID09PSBwYXRod2F5SWQgJiYgdmFsLnBhdGh3YXlTdGFnZSA9PT0gcGF0aHdheVN0YWdlICYmIHZhbC5zdGFuZGFyZCA9PT0gc3RhbmRhcmQgJiYgdmFsLml0ZW0gPT09IGl0ZW07XHJcbiAgICB9KTtcclxuXHJcbiAgICB2YXIgbG9nVGV4dCA9IFwiWW91IFwiICsgKGFncmVlID8gXCJcIiA6IFwiZGlzXCIpICsgXCJhZ3JlZWQgd2l0aCB0aGlzIG9uIFwiICsgKG5ldyBEYXRlKCkpLnRvRGF0ZVN0cmluZygpO1xyXG5cclxuICAgIGlmIChpdGVtcy5sZW5ndGggPT09IDEpIHtcclxuICAgICAgaXRlbXNbMF0uYWdyZWUgPSBhZ3JlZTtcclxuICAgICAgaXRlbXNbMF0uaGlzdG9yeS5wdXNoKGxvZ1RleHQpO1xyXG4gICAgICBpdGVtc1swXS5yZWFzb24gPSByZWFzb247XHJcbiAgICB9IGVsc2UgaWYgKGl0ZW1zLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICBvYmouYWdyZWVzW3BhdGllbnRJZF0ucHVzaCh7XHJcbiAgICAgICAgXCJwYXRod2F5SWRcIjogcGF0aHdheUlkLFxyXG4gICAgICAgIFwicGF0aHdheVN0YWdlXCI6IHBhdGh3YXlTdGFnZSxcclxuICAgICAgICBcInN0YW5kYXJkXCI6IHN0YW5kYXJkLFxyXG4gICAgICAgIFwiaXRlbVwiOiBpdGVtLFxyXG4gICAgICAgIFwiYWdyZWVcIjogYWdyZWUsXHJcbiAgICAgICAgXCJyZWFzb25cIjogcmVhc29uLFxyXG4gICAgICAgIFwiaGlzdG9yeVwiOiBbbG9nVGV4dF1cclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjb25zb2xlLmxvZyhcIkVSUk9SUlIhISEhISEhXCIpO1xyXG4gICAgfVxyXG5cclxuICAgIGxvZy5zZXRPYmoob2JqKTtcclxuICAgIG5vdGlmeS5zaG93U2F2ZWQoKTtcclxuICB9LFxyXG5cclxuICBnZXRBZ3JlZXM6IGZ1bmN0aW9uKCl7XHJcbiAgICByZXR1cm4gbG9nLmdldE9iaihbe1xyXG4gICAgICBuYW1lOiBcImFncmVlc1wiLFxyXG4gICAgICB2YWx1ZToge31cclxuICAgIH1dKS5hZ3JlZXM7XHJcbiAgfSxcclxuXHJcbiAgZ2V0UGF0aWVudEFncmVlT2JqZWN0OiBmdW5jdGlvbihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCwgaXRlbSkge1xyXG4gICAgdmFyIG9iaiA9IGxvZy5nZXRPYmooW3tcclxuICAgICAgbmFtZTogXCJhZ3JlZXNcIixcclxuICAgICAgdmFsdWU6IHt9XHJcbiAgICB9XSk7XHJcbiAgICBpZiAoIXBhdGh3YXlJZCB8fCAhcGF0aHdheVN0YWdlKSBhbGVydChcIkVESVRQQVRJRU5UQUdSRUVcIik7XHJcblxyXG4gICAgaWYgKCFvYmouYWdyZWVzW3BhdGllbnRJZF0pIG9iai5hZ3JlZXNbcGF0aWVudElkXSA9IFtdO1xyXG4gICAgdmFyIGl0ZW1zID0gb2JqLmFncmVlc1twYXRpZW50SWRdLmZpbHRlcihmdW5jdGlvbih2YWwpIHtcclxuICAgICAgcmV0dXJuIHZhbC5wYXRod2F5SWQgPT09IHBhdGh3YXlJZCAmJiB2YWwucGF0aHdheVN0YWdlID09PSBwYXRod2F5U3RhZ2UgJiYgdmFsLnN0YW5kYXJkID09PSBzdGFuZGFyZCAmJiB2YWwuaXRlbSA9PT0gaXRlbTtcclxuICAgIH0pO1xyXG4gICAgaWYgKGl0ZW1zLmxlbmd0aCA9PT0gMSkgcmV0dXJuIGl0ZW1zWzBdO1xyXG4gICAgcmV0dXJuIHt9O1xyXG4gIH0sXHJcblxyXG4gIGdldFBhdGllbnRBZ3JlZTogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQsIGl0ZW0pIHtcclxuICAgIHZhciBvYmogPSBsb2cuZ2V0T2JqKFt7XHJcbiAgICAgIG5hbWU6IFwiYWdyZWVzXCIsXHJcbiAgICAgIHZhbHVlOiB7fVxyXG4gICAgfV0pO1xyXG5cclxuICAgIGlmICghb2JqLmFncmVlc1twYXRpZW50SWRdKSByZXR1cm4gbnVsbDtcclxuICAgIHZhciBpdGVtMiA9IG9iai5hZ3JlZXNbcGF0aWVudElkXS5maWx0ZXIoZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgIHJldHVybiB2YWwucGF0aHdheUlkID09PSBwYXRod2F5SWQgJiYgdmFsLnBhdGh3YXlTdGFnZSA9PT0gcGF0aHdheVN0YWdlICYmIHZhbC5zdGFuZGFyZCA9PT0gc3RhbmRhcmQgJiYgdmFsLml0ZW0gPT09IGl0ZW07XHJcbiAgICB9KTtcclxuXHJcbiAgICBpZiAoaXRlbS5sZW5ndGggPT09IDEpIHtcclxuICAgICAgcmV0dXJuIGl0ZW1bMF0uYWdyZWU7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBsb2c7XHJcbiIsIm1vZHVsZS5leHBvcnRzID0ge1xyXG4gIFwiY3VycmVudFVybFwiOiBcIlwiLFxyXG4gIFwib3B0aW9uc1wiOiBbXSxcclxuICBcImNhdGVnb3JpZXNcIjoge1xyXG4gICAgXCJkaWFnbm9zaXNcIjoge1xyXG4gICAgICBcIm5hbWVcIjogXCJkaWFnbm9zaXNcIixcclxuICAgICAgXCJkaXNwbGF5XCI6IFwiRGlhZ25vc2lzXCJcclxuICAgIH0sXHJcbiAgICBcIm1vbml0b3JpbmdcIjoge1xyXG4gICAgICBcIm5hbWVcIjogXCJtb25pdG9yaW5nXCIsXHJcbiAgICAgIFwiZGlzcGxheVwiOiBcIk1vbml0b3JpbmdcIlxyXG4gICAgfSxcclxuICAgIFwidHJlYXRtZW50XCI6IHtcclxuICAgICAgXCJuYW1lXCI6IFwidHJlYXRtZW50XCIsXHJcbiAgICAgIFwiZGlzcGxheVwiOiBcIkNvbnRyb2xcIlxyXG4gICAgfSxcclxuICAgIFwiZXhjbHVzaW9uc1wiOiB7XHJcbiAgICAgIFwibmFtZVwiOiBcImV4Y2x1c2lvbnNcIixcclxuICAgICAgXCJkaXNwbGF5XCI6IFwiRXhjbHVzaW9uc1wiXHJcbiAgICB9XHJcbiAgfSxcclxuICBcImNoYXJ0c1wiOiB7fSxcclxuICBcInBhdGh3YXlJZFwiOiBcImh0blwiLFxyXG4gIFwiY29sb3JzXCI6IFsnIzFmNzdiNCcsICcjZmY3ZjBlJywgJyMyY2EwMmMnLCAnI2Q2MjcyOCcsICcjOTQ2N2JkJywgJyM4YzU2NGInLCAnI2UzNzdjMicsICcjN2Y3ZjdmJywgJyNiY2JkMjInLCAnIzE3YmVjZiddLFxyXG4gIFwibW9uaXRvcmVkXCI6IHtcclxuICAgIFwiYnBcIjogXCJCbG9vZCBQcmVzc3VyZVwiLFxyXG4gICAgXCJhc3RobWFcIjogXCJQZWFrIEV4cGlyYXRvcnkgRmxvd1wiXHJcbiAgfVxyXG59O1xyXG4iLCJ2YXIgdGVtcGxhdGUgPSByZXF1aXJlKCcuL3RlbXBsYXRlLmpzJyksXHJcbiAgZGF0YSA9IHJlcXVpcmUoJy4vZGF0YS5qcycpLFxyXG4gIGJhc2UgPSByZXF1aXJlKCcuL2Jhc2UuanMnKSxcclxuICBsYXlvdXQgPSByZXF1aXJlKCcuL2xheW91dC5qcycpLFxyXG4gIHdlbGNvbWUgPSByZXF1aXJlKCcuL3BhbmVscy93ZWxjb21lLmpzJyksXHJcbiAgbG9nID0gcmVxdWlyZSgnLi9sb2cuanMnKSxcclxuICBwYXRpZW50VmlldyA9IHJlcXVpcmUoJy4vdmlld3MvcGF0aWVudC5qcycpLFxyXG4gIE11c3RhY2hlID0gcmVxdWlyZSgnbXVzdGFjaGUnKTtcclxuXHJcbnZhciBzdGF0ZXMsIHBhdExvb2t1cCwgcGFnZSwgaGFzaDtcclxuXHJcbmNvbnNvbGUubG9nKFwibWFpbi5qczogZGF0YS5sYXN0bG9hZGVyPSBcIiArIGRhdGEubGFzdGxvYWRlcik7XHJcbmRhdGEubGFzdGxvYWRlciA9IFwibWFpbi5qc1wiO1xyXG5cclxudmFyIG1haW4gPSB7XHJcbiAgXCJ2ZXJzaW9uXCI6IFwiMi4wLjBcIixcclxuXHJcbiAgaGFzaDogaGFzaCxcclxuICBpbml0OiBmdW5jdGlvbigpIHtcclxuICAgIG1haW4ucHJlV2lyZVVwUGFnZXMoKTtcclxuXHJcbiAgICBsb2cubG9hZEFjdGlvbnMoZnVuY3Rpb24oKSB7XHJcbiAgICAgIGRhdGEuZ2V0KG1haW4ud2lyZVVwUGFnZXMpO1xyXG4gICAgfSk7XHJcbiAgfSxcclxuXHJcbiAgb25TZWxlY3RlZDogZnVuY3Rpb24oJGUsIG5oc051bWJlck9iamVjdCkge1xyXG4gICAgLy9IaWRlIHRoZSBzdWdnZXN0aW9ucyBwYW5lbFxyXG4gICAgJCgnI3NlYXJjaC1ib3gnKS5maW5kKCcudHQtZHJvcGRvd24tbWVudScpLmNzcygnZGlzcGxheScsICdub25lJyk7XHJcblxyXG4gICAgaGlzdG9yeS5wdXNoU3RhdGUobnVsbCwgbnVsbCwgJyNwYXRpZW50cy8nICsgbmhzTnVtYmVyT2JqZWN0LmlkKTtcclxuICAgIHRlbXBsYXRlLmxvYWRDb250ZW50KCcjcGF0aWVudHMvJyArIG5oc051bWJlck9iamVjdC5pZCwgdHJ1ZSk7XHJcblxyXG5cclxuICAgIC8vdGVtcGxhdGUuZGlzcGxheVNlbGVjdGVkUGF0aWVudChuaHNOdW1iZXJPYmplY3QuaWQpO1xyXG4gIH0sXHJcblxyXG4gIHdpcmVVcFNlYXJjaEJveDogZnVuY3Rpb24oKSB7XHJcbiAgICBpZiAoc3RhdGVzKSB7XHJcbiAgICAgIHN0YXRlcy5jbGVhclByZWZldGNoQ2FjaGUoKTtcclxuICAgIH1cclxuXHJcbiAgICBzdGF0ZXMgPSBuZXcgQmxvb2Rob3VuZCh7XHJcbiAgICAgIGRhdHVtVG9rZW5pemVyOiBCbG9vZGhvdW5kLnRva2VuaXplcnMub2JqLndoaXRlc3BhY2UoJ3ZhbHVlJyksXHJcbiAgICAgIHF1ZXJ5VG9rZW5pemVyOiBCbG9vZGhvdW5kLnRva2VuaXplcnMud2hpdGVzcGFjZSxcclxuICAgICAgbG9jYWw6ICQubWFwKGRhdGEucGF0aWVudEFycmF5LCBmdW5jdGlvbihzdGF0ZSkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICBpZDogc3RhdGUsXHJcbiAgICAgICAgICB2YWx1ZTogZGF0YS5wYXRMb29rdXAgJiYgZGF0YS5wYXRMb29rdXBbc3RhdGVdID8gZGF0YS5wYXRMb29rdXBbc3RhdGVdIDogc3RhdGVcclxuICAgICAgICB9O1xyXG4gICAgICB9KVxyXG4gICAgfSk7XHJcblxyXG4gICAgc3RhdGVzLmluaXRpYWxpemUodHJ1ZSk7XHJcblxyXG4gICAgJCgnI3NlYXJjaC1ib3gnKS5maW5kKCcudHlwZWFoZWFkJykudHlwZWFoZWFkKCdkZXN0cm95Jyk7XHJcbiAgICAkKCcjc2VhcmNoLWJveCcpLmZpbmQoJy50eXBlYWhlYWQnKS50eXBlYWhlYWQoe1xyXG4gICAgICAgIGhpbnQ6IHRydWUsXHJcbiAgICAgICAgaGlnaGxpZ2h0OiB0cnVlLFxyXG4gICAgICAgIG1pbkxlbmd0aDogMSxcclxuICAgICAgICBhdXRvc2VsZWN0OiB0cnVlXHJcbiAgICAgIH0sIHtcclxuICAgICAgICBuYW1lOiAncGF0aWVudHMnLFxyXG4gICAgICAgIGRpc3BsYXlLZXk6ICd2YWx1ZScsXHJcbiAgICAgICAgc291cmNlOiBzdGF0ZXMudHRBZGFwdGVyKCksXHJcbiAgICAgICAgdGVtcGxhdGVzOiB7XHJcbiAgICAgICAgICBlbXB0eTogW1xyXG4gICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiZW1wdHktbWVzc2FnZVwiPicsXHJcbiAgICAgICAgICAgICAgICAnJm5ic3A7ICZuYnNwOyBObyBtYXRjaGVzJyxcclxuICAgICAgICAgICAgICAnPC9kaXY+J1xyXG4gICAgICAgICAgICBdLmpvaW4oJ1xcbicpXHJcbiAgICAgICAgfVxyXG4gICAgICB9KS5vbigndHlwZWFoZWFkOnNlbGVjdGVkJywgbWFpbi5vblNlbGVjdGVkKVxyXG4gICAgICAub24oJ3R5cGVhaGVhZDphdXRvY29tcGxldGVkJywgbWFpbi5vblNlbGVjdGVkKTtcclxuXHJcbiAgICAkKCcjc2VhcmNoYnRuJykub24oJ21vdXNlZG93bicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgdmFsID0gJCgnLnR5cGVhaGVhZCcpLmVxKDApLnZhbCgpO1xyXG4gICAgICBpZiAoIXZhbCB8fCB2YWwgPT09IFwiXCIpIHZhbCA9ICQoJy50eXBlYWhlYWQnKS5lcSgxKS52YWwoKTtcclxuICAgICAgbWFpbi5vblNlbGVjdGVkKG51bGwsIHtcclxuICAgICAgICBcImlkXCI6IHZhbFxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIHdpcmVVcFBhZ2VzOiBmdW5jdGlvbigpIHtcclxuICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgIG1haW4ud2lyZVVwU2VhcmNoQm94KCk7XHJcblxyXG4gICAgJCgnI2RhdGEtZmlsZScpLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbihldnQpIHtcclxuICAgICAgJCgnI2RhdGEtZmlsZS13cmFwcGVyJykuYWRkQ2xhc3MoJ2Rpc2FibGVkJykudGV4dChcIkxvYWRpbmcuLi5cIik7XHJcbiAgICAgIHZhciBmaWxlID0gZXZ0LnRhcmdldC5maWxlc1swXTsgLy8gRmlsZUxpc3Qgb2JqZWN0XHJcbiAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xyXG5cclxuICAgICAgcmVhZGVyLm9ubG9hZCA9IChmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgdmFyIEpzb25PYmogPSBKU09OLnBhcnNlKGUudGFyZ2V0LnJlc3VsdCk7XHJcbiAgICAgICAgICBkYXRhLmdldChudWxsLCBKc29uT2JqKTtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKEpzb25PYmopO1xyXG5cclxuICAgICAgICAgIG1haW4ud2lyZVVwU2VhcmNoQm94KCk7XHJcblxyXG4gICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKCEkKCcjcGF0aWVudC1maWxlLXdyYXBwZXInKS5pcygnOnZpc2libGUnKSkge1xyXG4gICAgICAgICAgICAgICQoJyNmaWxlLWxvYWRlcicpLmhpZGUoNTAwKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAkKCcjZGF0YS1maWxlLXdyYXBwZXInKS5oaWRlKDUwMCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGVtcGxhdGUubG9hZENvbnRlbnQoJyNvdmVydmlldycpO1xyXG4gICAgICAgICAgfSwgMTAwMCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgfSkoZmlsZSk7XHJcblxyXG4gICAgICByZWFkZXIucmVhZEFzVGV4dChmaWxlKTtcclxuICAgIH0pO1xyXG5cclxuICAgICQoJyNwYXRpZW50LWZpbGUnKS5vbignY2hhbmdlJywgZnVuY3Rpb24oZXZ0KSB7XHJcbiAgICAgICQoJyNwYXRpZW50LWZpbGUtd3JhcHBlcicpLmFkZENsYXNzKCdkaXNhYmxlZCcpLnRleHQoXCJMb2FkaW5nLi4uXCIpO1xyXG4gICAgICB2YXIgZmlsZSA9IGV2dC50YXJnZXQuZmlsZXNbMF07IC8vIEZpbGVMaXN0IG9iamVjdFxyXG4gICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcclxuXHJcbiAgICAgIHJlYWRlci5vbmxvYWQgPSAoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgIHZhciBsaW5lcyA9IGUudGFyZ2V0LnJlc3VsdC5zcGxpdChcIlxcblwiKTtcclxuICAgICAgICAgIGRhdGEucGF0TG9va3VwID0ge307XHJcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpbmVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBmaWVsZHMgPSBsaW5lc1tpXS5zcGxpdChcIlxcdFwiKTtcclxuICAgICAgICAgICAgaWYgKGZpZWxkcy5sZW5ndGggIT09IDIpIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICBkYXRhLnBhdExvb2t1cFtmaWVsZHNbMF0udHJpbSgpXSA9IGZpZWxkc1sxXS50cmltKCk7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgbWFpbi53aXJlVXBTZWFyY2hCb3goKTtcclxuXHJcbiAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAoISQoJyNkYXRhLWZpbGUtd3JhcHBlcicpLmlzKCc6dmlzaWJsZScpKSB7XHJcbiAgICAgICAgICAgICAgJCgnI2ZpbGUtbG9hZGVyJykuaGlkZSg1MDApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICQoJyNwYXRpZW50LWZpbGUtd3JhcHBlcicpLmhpZGUoNTAwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0ZW1wbGF0ZS5sb2FkQ29udGVudCgnI292ZXJ2aWV3Jyk7XHJcbiAgICAgICAgICB9LCAxMDAwKTtcclxuICAgICAgICB9O1xyXG4gICAgICB9KShmaWxlKTtcclxuXHJcbiAgICAgIHJlYWRlci5yZWFkQXNUZXh0KGZpbGUpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgJCgnI291dHN0YW5kaW5nVGFza3MnKS5vbignY2xpY2snLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgICQoJyN3ZWxjb21lLXRhYnMgbGknKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICQodGhpcykuY2xvc2VzdCgnbGknKS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgIHZhciB0ZW1wTXVzdCA9ICQoJyN3ZWxjb21lLXRhc2stbGlzdCcpLmh0bWwoKTtcclxuICAgICAgdmFyIHJlbmRlcmVkID0gTXVzdGFjaGUucmVuZGVyKHRlbXBNdXN0KTtcclxuICAgICAgJCgnI3dlbGNvbWUtdGFiLWNvbnRlbnQnKS5mYWRlT3V0KDEwMCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgJCh0aGlzKS5odG1sKHJlbmRlcmVkKTtcclxuICAgICAgICB3ZWxjb21lLnBvcHVsYXRlKCk7XHJcbiAgICAgICAgJCh0aGlzKS5mYWRlSW4oMTAwKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAkKCcjY29tcGxldGVkVGFza3MnKS5vbignY2xpY2snLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgICQoJyN3ZWxjb21lLXRhYnMgbGknKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICQodGhpcykuY2xvc2VzdCgnbGknKS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgIHZhciB0ZW1wTXVzdCA9ICQoJyN3ZWxjb21lLXRhc2stbGlzdCcpLmh0bWwoKTtcclxuICAgICAgdmFyIHJlbmRlcmVkID0gTXVzdGFjaGUucmVuZGVyKHRlbXBNdXN0KTtcclxuICAgICAgJCgnI3dlbGNvbWUtdGFiLWNvbnRlbnQnKS5mYWRlT3V0KDEwMCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgJCh0aGlzKS5odG1sKHJlbmRlcmVkKTtcclxuICAgICAgICB3ZWxjb21lLnBvcHVsYXRlKHRydWUpO1xyXG4gICAgICAgICQodGhpcykuZmFkZUluKDEwMCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKG1haW4uaGFzaCAhPT0gbG9jYXRpb24uaGFzaCkgbG9jYXRpb24uaGFzaCA9IG1haW4uaGFzaDtcclxuICAgIHRlbXBsYXRlLmxvYWRDb250ZW50KGxvY2F0aW9uLmhhc2gsIHRydWUpO1xyXG4gIH0sXHJcblxyXG4gIHByZVdpcmVVcFBhZ2VzOiBmdW5jdGlvbigpIHtcclxuICAgICAgbGF5b3V0LnNob3dQYWdlKCdsb2dpbicpO1xyXG5cclxuICAgICAgLy9FdmVyeSBsaW5rIGVsZW1lbnQgc3RvcmVzIGhyZWYgaW4gaGlzdG9yeVxyXG4gICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnYS5oaXN0b3J5JywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgLy8ga2VlcCB0aGUgbGluayBpbiB0aGUgYnJvd3NlciBoaXN0b3J5XHJcbiAgICAgICAgaGlzdG9yeS5wdXNoU3RhdGUobnVsbCwgbnVsbCwgdGhpcy5ocmVmKTtcclxuICAgICAgICB0ZW1wbGF0ZS5sb2FkQ29udGVudChsb2NhdGlvbi5oYXNoLCB0cnVlKTtcclxuICAgICAgICAvLyBkbyBub3QgZ2l2ZSBhIGRlZmF1bHQgYWN0aW9uXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIC8vQ2FsbGVkIHdoZW4gdGhlIGJhY2sgYnV0dG9uIGlzIGhpdFxyXG4gICAgICAkKHdpbmRvdykub24oJ3BvcHN0YXRlJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgIHRlbXBsYXRlLmxvYWRDb250ZW50KGxvY2F0aW9uLmhhc2gsIHRydWUpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIC8vVGVtcGxhdGVzXHJcbiAgICAgIHBhdGllbnRzUGFuZWxUZW1wbGF0ZSA9ICQoJyNwYXRpZW50cy1wYW5lbCcpO1xyXG4gICAgICBhY3Rpb25QbGFuUGFuZWwgPSAkKCcjYWN0aW9uLXBsYW4tcGFuZWwnKTtcclxuICAgICAgcGF0aWVudExpc3QgPSAkKCcjcGF0aWVudC1saXN0Jyk7XHJcbiAgICAgIHN1Z2dlc3RlZFBsYW5UZW1wbGF0ZSA9ICQoJyNzdWdnZXN0ZWQtcGxhbi10ZW1wbGF0ZScpO1xyXG4gICAgICBpbmRpdmlkdWFsUGFuZWwgPSAkKCcjaW5kaXZpZHVhbC1wYW5lbCcpO1xyXG4gICAgICB2YWx1ZVRyZW5kUGFuZWwgPSAkKCcjdmFsdWUtdHJlbmQtcGFuZWwnKTtcclxuICAgICAgbWVkaWNhdGlvblBhbmVsID0gJCgnI21lZGljYXRpb25zLXBhbmVsJyk7XHJcbiAgICAgIGFjdGlvblBsYW5MaXN0ID0gJCgnI2FjdGlvbi1wbGFuLWxpc3QnKTtcclxuXHJcbiAgICAgIC8vU2VsZWN0b3JzXHJcbiAgICAgIGJvdHRvbUxlZnRQYW5lbCA9ICQoJyNib3R0b20tbGVmdC1wYW5lbCcpO1xyXG4gICAgICBib3R0b21SaWdodFBhbmVsID0gJCgnI2JvdHRvbS1yaWdodC1wYW5lbCcpO1xyXG4gICAgICB0b3BQYW5lbCA9ICQoJyN0b3AtcGFuZWwnKTtcclxuICAgICAgdG9wTGVmdFBhbmVsID0gJCgnI3RvcC1sZWZ0LXBhbmVsJyk7XHJcbiAgICAgIHRvcFJpZ2h0UGFuZWwgPSAkKCcjdG9wLXJpZ2h0LXBhbmVsJyk7XHJcbiAgICAgIG1pZFBhbmVsID0gJCgnI21pZC1wYW5lbCcpO1xyXG4gICAgICBmYXJMZWZ0UGFuZWwgPSAkKCcjbGVmdC1wYW5lbCcpO1xyXG4gICAgICBmYXJSaWdodFBhbmVsID0gJCgnI3JpZ2h0LXBhbmVsJyk7XHJcbiAgICB9XHJcbiAgICAvKixcclxuICAgICAgXCJfbG9jYWxcIjogbG9jYWwqL1xyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBtYWluO1xyXG4iLCJtb2R1bGUuZXhwb3J0cyA9IHtcclxuXHJcbiAgc2hvd1NhdmVkOiBmdW5jdGlvbigpIHtcclxuICAgICQoXCIjc2F2ZWQtbWVzc2FnZVwiKS5oaWRlKCkudG9nZ2xlQ2xhc3MoXCJpblwiKS5mYWRlSW4oMzAwKTtcclxuICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAkKFwiI3NhdmVkLW1lc3NhZ2VcIikuZmFkZU91dCgzMDAsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICQodGhpcykudG9nZ2xlQ2xhc3MoXCJpblwiKTtcclxuICAgICAgfSk7XHJcbiAgICB9LCAyMDAwKTtcclxuICB9XHJcblxyXG59O1xyXG4iLCJ2YXIgYmFzZSA9IHJlcXVpcmUoJy4uL2Jhc2UuanMnKSxcclxuICBkYXRhID0gcmVxdWlyZSgnLi4vZGF0YS5qcycpLFxyXG4gIHF1YWxpdHlTdGFuZGFyZCA9IHJlcXVpcmUoJy4vcXVhbGl0eVN0YW5kYXJkLmpzJyksXHJcbiAgb3RoZXJDb2RlcyA9IHJlcXVpcmUoJy4vb3RoZXJDb2Rlcy5qcycpLFxyXG4gIG1lZGljYXRpb24gPSByZXF1aXJlKCcuL21lZGljYXRpb24uanMnKSxcclxuICB0cmVuZCA9IHJlcXVpcmUoJy4vdHJlbmQuanMnKSxcclxuICBpbmRpdmlkdWFsQWN0aW9uUGxhbiA9IHJlcXVpcmUoJy4vaW5kaXZpZHVhbEFjdGlvblBsYW4uanMnKSxcclxuICBsYXlvdXQgPSByZXF1aXJlKCcuLi9sYXlvdXQuanMnKSxcclxuICBjaGFydCA9IHJlcXVpcmUoJy4uL2NoYXJ0LmpzJyksXHJcbiAgTXVzdGFjaGUgPSByZXF1aXJlKCdtdXN0YWNoZScpO1xyXG5cclxudmFyIGFsbCA9IHtcclxuXHJcbiAgcG9wdWxhdGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIHBhdGllbnRzID0gZGF0YS5nZXRBbGxQYXRpZW50cygpO1xyXG5cclxuICAgIHZhciBsb2NhbERhdGEgPSB7XHJcbiAgICAgIFwicGF0aWVudHNcIjogcGF0aWVudHMsXHJcbiAgICAgIFwiblwiOiBwYXRpZW50cy5sZW5ndGgsXHJcbiAgICAgIFwiaGVhZGVyLWl0ZW1zXCI6IFt7XHJcbiAgICAgICAgXCJ0aXRsZVwiOiBcIk5IUyBuby5cIixcclxuICAgICAgICBcImlzVW5Tb3J0YWJsZVwiOiB0cnVlXHJcbiAgICAgIH0sIHtcclxuICAgICAgICBcInRpdGxlXCI6IFwiQWxsIE9wcG9ydHVuaXRpZXNcIixcclxuICAgICAgICBcInRpdGxlSFRNTFwiOiAnIyBvZiA8aSBjbGFzcz1cImZhIGZhLWZsYWdcIiBzdHlsZT1cImNvbG9yOnJlZFwiPjwvaT4nLFxyXG4gICAgICAgIFwiaXNVblNvcnRhYmxlXCI6IHRydWUsXHJcbiAgICAgICAgXCJ0b29sdGlwXCI6IFwiVG90YWwgbnVtYmVyIG9mIGltcHJvdmVtZW50IG9wcG9ydHVuaXRpZXMgYXZhaWxhYmxlIGFjcm9zcyBhbGwgY29uZGl0aW9uc1wiXHJcbiAgICAgIH1dXHJcbiAgICB9O1xyXG5cclxuICAgIGxvY2FsRGF0YS5wYXRpZW50cy5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcclxuICAgICAgaWYgKGEuaXRlbXNbMF0gPT09IGIuaXRlbXNbMF0pIHtcclxuICAgICAgICByZXR1cm4gMDtcclxuICAgICAgfVxyXG4gICAgICB2YXIgQSA9IE51bWJlcihhLml0ZW1zWzBdKTtcclxuICAgICAgdmFyIEIgPSBOdW1iZXIoYi5pdGVtc1swXSk7XHJcbiAgICAgIGlmIChpc05hTihBKSB8fCBpc05hTihCKSkge1xyXG4gICAgICAgIEEgPSBhLml0ZW1zWzBdO1xyXG4gICAgICAgIEIgPSBiLml0ZW1zWzBdO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChBID4gQikge1xyXG4gICAgICAgIHJldHVybiAtMTtcclxuICAgICAgfSBlbHNlIGlmIChBIDwgQikge1xyXG4gICAgICAgIHJldHVybiAxO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBiYXNlLmNyZWF0ZVBhbmVsU2hvdyhwYXRpZW50TGlzdCwgcGF0aWVudHNQYW5lbCwgbG9jYWxEYXRhLCB7XHJcbiAgICAgIFwiaGVhZGVyLWl0ZW1cIjogJChcIiNwYXRpZW50LWxpc3QtaGVhZGVyLWl0ZW1cIikuaHRtbCgpLFxyXG4gICAgICBcIml0ZW1cIjogJCgnI3BhdGllbnQtbGlzdC1pdGVtJykuaHRtbCgpXHJcbiAgICB9KTtcclxuXHJcbiAgICAkKCcjcGF0aWVudHMtcGxhY2Vob2xkZXInKS5oaWRlKCk7XHJcblxyXG4gICAgYmFzZS5zZXR1cENsaXBib2FyZCgkKCcuYnRuLWNvcHknKSwgdHJ1ZSk7XHJcblxyXG4gICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG5cclxuICAgIHZhciBjID0gcGF0aWVudHNQYW5lbC5maW5kKCdkaXYudGFibGUtc2Nyb2xsJykuZ2V0TmljZVNjcm9sbCgpO1xyXG4gICAgaWYgKGMgJiYgYy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGMucmVzaXplKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBwYXRpZW50c1BhbmVsLmZpbmQoJ2Rpdi50YWJsZS1zY3JvbGwnKS5uaWNlU2Nyb2xsKHtcclxuICAgICAgICBjdXJzb3JvcGFjaXR5bWluOiAwLjMsXHJcbiAgICAgICAgY3Vyc29yd2lkdGg6IFwiN3B4XCIsXHJcbiAgICAgICAgaG9yaXpyYWlsZW5hYmxlZDogZmFsc2VcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfSxcclxuXHJcbiAgLy9TaG93IHBhdGllbnQgdmlldyBmcm9tIHRoZSBhbGwgcGF0aWVudCBzY3JlZW5cclxuICBzaG93SW5kaXZpZHVhbFBhdGllbnRWaWV3OiBmdW5jdGlvbihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCkge1xyXG4gICAgZGF0YS5wYXRpZW50SWQgPSBwYXRpZW50SWQ7XHJcblxyXG4gICAgZGF0YS5vcHRpb25zLnNvcnQoZnVuY3Rpb24oYSwgYikge1xyXG4gICAgICBhID0gZGF0YS5nZXRQYXRpZW50U3RhdHVzKHBhdGllbnRJZCwgYS5wYXRod2F5SWQsIGEucGF0aHdheVN0YWdlLCBhLnN0YW5kYXJkKTtcclxuICAgICAgYiA9IGRhdGEuZ2V0UGF0aWVudFN0YXR1cyhwYXRpZW50SWQsIGIucGF0aHdheUlkLCBiLnBhdGh3YXlTdGFnZSwgYi5zdGFuZGFyZCk7XHJcblxyXG4gICAgICBpZiAoYSA9PT0gYikgcmV0dXJuIDA7XHJcbiAgICAgIGlmIChhID09PSBcIm5vdFwiKSByZXR1cm4gMTtcclxuICAgICAgaWYgKGIgPT09IFwibm90XCIpIHJldHVybiAtMTtcclxuICAgICAgaWYgKGEgPT09IFwib2tcIikgcmV0dXJuIDE7XHJcbiAgICAgIGlmIChiID09PSBcIm9rXCIpIHJldHVybiAtMTtcclxuICAgICAgYWxlcnQoXCIhISEhISEhXCIpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKHBhdGh3YXlJZCA9PT0gbnVsbCkge1xyXG4gICAgICAvL1Nob3cgcGF0aWVudCBidXQgZG9uJ3Qgc2VsZWN0XHJcbiAgICAgIHZhciBwID0gYmFzZS5jcmVhdGVQYW5lbCgkKCcjcGF0aWVudC1wYW5lbCcpLCB7XHJcbiAgICAgICAgXCJvcHRpb25zXCI6IGRhdGEub3B0aW9ucyxcclxuICAgICAgICBcIm51bWJlck9mU3RhbmRhcmRzTWlzc2VkXCI6IGRhdGEubnVtYmVyT2ZTdGFuZGFyZHNNaXNzZWQocGF0aWVudElkKSxcclxuICAgICAgICBcIm5oc051bWJlclwiOiBkYXRhLnBhdExvb2t1cCA/IGRhdGEucGF0TG9va3VwW3BhdGllbnRJZF0gOiBwYXRpZW50SWQsXHJcbiAgICAgICAgXCJwYXRpZW50SWRcIjogcGF0aWVudElkXHJcbiAgICAgIH0sIHtcclxuICAgICAgICBcIm9wdGlvblwiOiAkKCcjcGF0aWVudC1wYW5lbC1kcm9wLWRvd24tb3B0aW9ucycpLmh0bWwoKVxyXG4gICAgICB9KTtcclxuICAgICAgZmFyUmlnaHRQYW5lbC5odG1sKHApLnNob3coKTtcclxuICAgICAgZmFyUmlnaHRQYW5lbC5yZW1vdmVDbGFzcygnc3RhbmRhcmQtbWlzc2VkLXBhZ2UnKS5yZW1vdmVDbGFzcygnc3RhbmRhcmQtYWNoaWV2ZWQtcGFnZScpLnJlbW92ZUNsYXNzKCdzdGFuZGFyZC1ub3QtcmVsZXZhbnQtcGFnZScpO1xyXG5cclxuICAgICAgJCgnc2VsZWN0Jykuc2VsZWN0Mih7XHJcbiAgICAgICAgdGVtcGxhdGVSZXN1bHQ6IGJhc2UuZm9ybWF0U3RhbmRhcmQsXHJcbiAgICAgICAgbWluaW11bVJlc3VsdHNGb3JTZWFyY2g6IEluZmluaXR5LFxyXG4gICAgICAgIHBsYWNlaG9sZGVyOiBcIlBsZWFzZSBzZWxlY3QgYW4gaW1wcm92ZW1lbnQgb3Bwb3J0dW5pdHkgYXJlYS4uLlwiXHJcbiAgICAgIH0pO1xyXG4gICAgICAkKCdzcGFuLnNlbGVjdDItc2VsZWN0aW9uX19yZW5kZXJlZCcpLmF0dHIoXCJ0aXRsZVwiLCBcIlwiKTtcclxuICAgICAgJCgnc2VsZWN0Jykub24oJ2NoYW5nZScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBsb2NhbERhdGEgPSAkKHRoaXMpLmZpbmQoJzpzZWxlY3RlZCcpLmRhdGEoKTtcclxuICAgICAgICBhbGwuc2hvd0luZGl2aWR1YWxQYXRpZW50Vmlldyhsb2NhbERhdGEucGF0aHdheUlkLCBsb2NhbERhdGEucGF0aHdheVN0YWdlLCBsb2NhbERhdGEuc3RhbmRhcmQsIGRhdGEucGF0aWVudElkKTtcclxuICAgICAgfSkub24oXCJzZWxlY3QyOm9wZW5cIiwgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgICAgfSk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICB2YXIgcGFuZWwgPSBiYXNlLmNyZWF0ZVBhbmVsKCQoJyNwYXRpZW50LXBhbmVsJyksIHtcclxuICAgICAgXCJvcHRpb25zXCI6IGRhdGEub3B0aW9ucyxcclxuICAgICAgXCJudW1iZXJPZlN0YW5kYXJkc01pc3NlZFwiOiBkYXRhLm51bWJlck9mU3RhbmRhcmRzTWlzc2VkKHBhdGllbnRJZCksXHJcbiAgICAgIFwic3RhbmRhcmRcIjogZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS50YWIudGl0bGUsXHJcbiAgICAgIFwicGF0aHdheVN0YWdlXCI6IHBhdGh3YXlTdGFnZSxcclxuICAgICAgXCJuaHNOdW1iZXJcIjogZGF0YS5wYXRMb29rdXAgPyBkYXRhLnBhdExvb2t1cFtwYXRpZW50SWRdIDogcGF0aWVudElkLFxyXG4gICAgICBcInBhdGllbnRJZFwiOiBwYXRpZW50SWRcclxuICAgIH0sIHtcclxuICAgICAgXCJvcHRpb25cIjogJCgnI3BhdGllbnQtcGFuZWwtZHJvcC1kb3duLW9wdGlvbnMnKS5odG1sKClcclxuICAgIH0pO1xyXG5cclxuICAgIGZhclJpZ2h0UGFuZWwuaHRtbChcIlwiKTtcclxuICAgICQoJyN0ZW1wLWhpZGRlbicpLmh0bWwocGFuZWwpO1xyXG5cclxuICAgIHZhciBhY3Rpb25QbGFuID0gaW5kaXZpZHVhbEFjdGlvblBsYW4uY3JlYXRlKHBhdGh3YXlTdGFnZSk7XHJcbiAgICAkKCcjdGVtcC1oaWRkZW4gI3BhdGllbnQtcGFuZWwtcmlnaHQnKS5odG1sKGFjdGlvblBsYW4pO1xyXG5cclxuICAgIHZhciBxdWFsUGFuZWwgPSBxdWFsaXR5U3RhbmRhcmQuY3JlYXRlKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgIHZhciB0cmVuZFBhbmVsID0gdHJlbmQuY3JlYXRlKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgIHZhciBtZWRQYW5lbCA9IG1lZGljYXRpb24uY3JlYXRlKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgIHZhciBjb2Rlc1BhbmVsID0gb3RoZXJDb2Rlcy5jcmVhdGUocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gICAgdmFyIG1lZENvZGVXcmFwcGVyUGFuZWwgPSBiYXNlLmNyZWF0ZVBhbmVsKCQoJyNvdGhlci1jb2Rlcy1hbmQtbWVkcy13cmFwcGVyLXBhbmVsJykpO1xyXG4gICAgJCgnI3RlbXAtaGlkZGVuICNwYXRpZW50LXBhbmVsLXRvcCcpLmh0bWwocXVhbFBhbmVsKTtcclxuICAgICQoJyN0ZW1wLWhpZGRlbiAjcGF0aWVudC1wYW5lbC1sZWZ0JykuaHRtbChcIlwiKS5hcHBlbmQodHJlbmRQYW5lbCkuYXBwZW5kKG1lZENvZGVXcmFwcGVyUGFuZWwpO1xyXG4gICAgJCgnI3RlbXAtaGlkZGVuICNtZWRDb2RlV3JhcHBlclBhbmVsJykuYXBwZW5kKG1lZFBhbmVsKS5hcHBlbmQoY29kZXNQYW5lbCk7XHJcblxyXG4gICAgaWYgKGZhclJpZ2h0UGFuZWwuaXMoJzp2aXNpYmxlJykpIHtcclxuICAgICAgZmFyUmlnaHRQYW5lbC5mYWRlT3V0KDEwMCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgJCh0aGlzKS5odG1sKCQoJyN0ZW1wLWhpZGRlbicpLmh0bWwoKSk7XHJcbiAgICAgICAgJCgnI3RlbXAtaGlkZGVuJykuaHRtbChcIlwiKTtcclxuICAgICAgICBpbmRpdmlkdWFsQWN0aW9uUGxhbi53aXJlVXAocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gICAgICAgIHF1YWxpdHlTdGFuZGFyZC53aXJlVXAocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gICAgICAgIGJhc2Uud2lyZVVwU3RhbmRhcmREcm9wRG93bihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIGFsbC5zaG93SW5kaXZpZHVhbFBhdGllbnRWaWV3KTtcclxuICAgICAgICB0cmVuZC53aXJlVXAocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gICAgICAgIG1lZGljYXRpb24ud2lyZVVwKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgICAgICBvdGhlckNvZGVzLndpcmVVcChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcbiAgICAgICAgY2hhcnQuZHJhd1RyZW5kQ2hhcnQocGF0aWVudElkLCBwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQpO1xyXG4gICAgICAgICQodGhpcykuZmFkZUluKDEwMCwgZnVuY3Rpb24oKSB7fSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgZmFyUmlnaHRQYW5lbC5odG1sKCQoJyN0ZW1wLWhpZGRlbicpLmh0bWwoKSk7XHJcbiAgICAgICQoJyN0ZW1wLWhpZGRlbicpLmh0bWwoXCJcIik7XHJcbiAgICAgIGluZGl2aWR1YWxBY3Rpb25QbGFuLndpcmVVcChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcbiAgICAgIHF1YWxpdHlTdGFuZGFyZC53aXJlVXAocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gICAgICBiYXNlLndpcmVVcFN0YW5kYXJkRHJvcERvd24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBhbGwuc2hvd0luZGl2aWR1YWxQYXRpZW50Vmlldyk7XHJcbiAgICAgIHRyZW5kLndpcmVVcChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcbiAgICAgIG1lZGljYXRpb24ud2lyZVVwKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgICAgb3RoZXJDb2Rlcy53aXJlVXAocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gICAgICBjaGFydC5kcmF3VHJlbmRDaGFydChwYXRpZW50SWQsIHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCk7XHJcbiAgICAgIGZhclJpZ2h0UGFuZWwuZmFkZUluKDEwMCwgZnVuY3Rpb24oKSB7fSk7XHJcbiAgICB9XHJcbiAgfSxcclxuXHJcbiAgc2hvdzogZnVuY3Rpb24obG9jYXRpb24pIHtcclxuICAgIGJhc2UuY3JlYXRlUGFuZWxTaG93KCQoJyNhbGwtcGF0aWVudHMtcGFuZWwnKSwgbG9jYXRpb24sIHtcclxuICAgICAgXCJuXCI6IGRhdGEuZ2V0QWxsUGF0aWVudHMoKS5sZW5ndGhcclxuICAgIH0pO1xyXG5cclxuICAgIHBhdGllbnRzUGFuZWwgPSAkKCcjcGF0aWVudHMnKTtcclxuXHJcbiAgICBwYXRpZW50c1BhbmVsLm9uKCdjbGljaycsICd0Ym9keSB0cicsIGZ1bmN0aW9uKGUpIHsgLy9TZWxlY3QgaW5kaXZpZHVhbCBwYXRpZW50IHdoZW4gcm93IGNsaWNrZWRcclxuICAgICAgJCgnW2RhdGEtdG9nZ2xlPVwidG9vbHRpcFwiXScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgJCh0aGlzKS50b29sdGlwKCdkZXN0cm95Jyk7XHJcbiAgICAgIGJhc2UuY2xlYXJCb3goKTtcclxuICAgICAgJCgnLmxpc3QtaXRlbScpLnJlbW92ZUNsYXNzKCdoaWdobGlnaHRlZCcpO1xyXG4gICAgICAkKHRoaXMpLmFkZENsYXNzKCdoaWdobGlnaHRlZCcpLnJlbW92ZUF0dHIoJ3RpdGxlJyk7XHJcblxyXG4gICAgICB2YXIgcGF0aWVudElkID0gJCh0aGlzKS5maW5kKCd0ZCBidXR0b24nKS5hdHRyKCdkYXRhLXBhdGllbnQtaWQnKTtcclxuXHJcbiAgICAgIGFsbC5zaG93SW5kaXZpZHVhbFBhdGllbnRWaWV3KG51bGwsIG51bGwsIG51bGwsIHBhdGllbnRJZCk7XHJcblxyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICB9KS5vbignY2xpY2snLCAndGJvZHkgdHIgYnV0dG9uJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAvL2Rvbid0IHdhbnQgcm93IHNlbGVjdGVkIGlmIGp1c3QgYnV0dG9uIHByZXNzZWQ/XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIHNob3dWaWV3OiBmdW5jdGlvbihwYXRpZW50SWQsIHJlbG9hZCkge1xyXG4gICAgJCgnI21haW5UaXRsZScpLmhpZGUoKTtcclxuICAgIGJhc2UudXBkYXRlVGl0bGUoXCJMaXN0IG9mIGFsbCBwYXRpZW50cyBhdCB5b3VyIHByYWN0aWNlXCIpO1xyXG5cclxuICAgIGlmICghcGF0aWVudElkKSBkYXRhLnBhdGh3YXlJZCA9IFwiXCI7XHJcbiAgICBpZiAoIXBhdGllbnRJZCB8fCByZWxvYWQpIHtcclxuXHJcbiAgICAgIGxheW91dC5zaG93TWFpblZpZXcoZGF0YS5kaXNlYXNlcy5sZW5ndGgpO1xyXG5cclxuICAgICAgYmFzZS5zd2l0Y2hUbzExMExheW91dCgpO1xyXG4gICAgICBiYXNlLmhpZGVBbGxQYW5lbHMoKTtcclxuXHJcbiAgICAgIGFsbC5zaG93KGZhckxlZnRQYW5lbCk7XHJcbiAgICAgIGFsbC5wb3B1bGF0ZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChwYXRpZW50SWQpIHtcclxuICAgICAgYWxsLnNob3dJbmRpdmlkdWFsUGF0aWVudFZpZXcobnVsbCwgbnVsbCwgbnVsbCwgcGF0aWVudElkKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHZhciB0ZW1wTXVzdCA9ICQoJyNwYXRpZW50LXBhbmVsLXBsYWNlaG9sZGVyJykuaHRtbCgpO1xyXG4gICAgICBmYXJSaWdodFBhbmVsLmh0bWwoTXVzdGFjaGUucmVuZGVyKHRlbXBNdXN0KSkuc2hvdygpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGFsbDtcclxuIiwidmFyIGJhc2UgPSByZXF1aXJlKCcuLi9iYXNlLmpzJyksXHJcbmxvZyA9IHJlcXVpcmUoJy4uL2xvZy5qcycpO1xyXG5cclxudmFyIGNvbmZpcm0gPSB7XHJcblxyXG4gIHdpcmVVcDogZnVuY3Rpb24oYWdyZWVEaXZTZWxlY3RvciwgcGFuZWxTZWxlY3RvciwgcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQsIGl0ZW0sIGRpc2FncmVlVGV4dCkge1xyXG4gICAgY29uZmlybS53aXJlVXBBZ3JlZURpc2FncmVlKGFncmVlRGl2U2VsZWN0b3IsIGxvZy5nZXRQYXRpZW50QWdyZWVPYmplY3QocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQsIGl0ZW0pKTtcclxuXHJcbiAgICBwYW5lbFNlbGVjdG9yLm9uKCdjaGFuZ2UnLCAnLmJ0bi10b2dnbGUgaW5wdXRbdHlwZT1jaGVja2JveF0nLCBmdW5jdGlvbigpIHtcclxuICAgICAgY29uZmlybS53aXJlVXBBZ3JlZURpc2FncmVlKGFncmVlRGl2U2VsZWN0b3IsIGxvZy5nZXRQYXRpZW50QWdyZWVPYmplY3QocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQsIGl0ZW0pKTtcclxuICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgfSkub24oJ2NsaWNrJywgJy5idG4tdG9nZ2xlJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICB2YXIgY2hlY2tib3ggPSAkKHRoaXMpLmZpbmQoXCJpbnB1dFt0eXBlPWNoZWNrYm94XVwiKTtcclxuICAgICAgdmFyIG90aGVyID0gJCh0aGlzKS5wYXJlbnQoKS5maW5kKCQodGhpcykuaGFzQ2xhc3MoXCJidG4teWVzXCIpID8gXCIuYnRuLW5vXCIgOiBcIi5idG4teWVzXCIpO1xyXG4gICAgICB2YXIgQUNUSU9OSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YSgnaWQnKTtcclxuICAgICAgaWYgKCQodGhpcykuaGFzQ2xhc3MoXCJhY3RpdmVcIikgJiYgb3RoZXIuaGFzQ2xhc3MoXCJpbmFjdGl2ZVwiKSkge1xyXG4gICAgICAgIC8vdW5zZWxlY3RpbmdcclxuICAgICAgICBpZiAoY2hlY2tib3gudmFsKCkgPT09IFwibm9cIikge1xyXG4gICAgICAgICAgY29uZmlybS5sYXVuY2hTdGFuZGFyZE1vZGFsKFwiRGlzYWdyZWUgd2l0aCBcIiArIGRpc2FncmVlVGV4dCwgXCI/XCIsIGxvZy5nZXRBZ3JlZVJlYXNvbihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCwgaXRlbSksIHRydWUsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBsb2cuZWRpdFBhdGllbnRBZ3JlZShwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCwgaXRlbSwgZmFsc2UsIGxvZy5yZWFzb24ucmVhc29uVGV4dCk7XHJcbiAgICAgICAgICAgIGNvbmZpcm0ud2lyZVVwQWdyZWVEaXNhZ3JlZShhZ3JlZURpdlNlbGVjdG9yLCBsb2cuZ2V0UGF0aWVudEFncmVlT2JqZWN0KHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkLCBpdGVtKSk7XHJcbiAgICAgICAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgICAgICAgIH0sIG51bGwsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBsb2cuZWRpdFBhdGllbnRBZ3JlZShwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCwgaXRlbSwgbnVsbCwgXCJcIik7XHJcbiAgICAgICAgICAgIG90aGVyLnJlbW92ZUNsYXNzKFwiaW5hY3RpdmVcIik7XHJcbiAgICAgICAgICAgIGNoZWNrYm94LnJlbW92ZUF0dHIoXCJjaGVja2VkXCIpO1xyXG4gICAgICAgICAgICBjaGVja2JveC5wYXJlbnQoKS5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgY29uZmlybS53aXJlVXBBZ3JlZURpc2FncmVlKGFncmVlRGl2U2VsZWN0b3IsIGxvZy5nZXRQYXRpZW50QWdyZWVPYmplY3QocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQsIGl0ZW0pKTtcclxuICAgICAgICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBsb2cuZWRpdFBhdGllbnRBZ3JlZShwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCwgaXRlbSwgbnVsbCk7XHJcbiAgICAgICAgICBvdGhlci5yZW1vdmVDbGFzcyhcImluYWN0aXZlXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIGlmICghJCh0aGlzKS5oYXNDbGFzcyhcImFjdGl2ZVwiKSAmJiBvdGhlci5oYXNDbGFzcyhcImFjdGl2ZVwiKSkge1xyXG4gICAgICAgIC8vcHJldmVudCBjbGlja2luZyBvbiB1bnNlbGVjdGVkIG9wdGlvbiBvciBpZiB0aGUgcm93IGlzIGNvbXBsZXRlXHJcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vc2VsZWN0aW5nXHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIGlmIChjaGVja2JveC52YWwoKSA9PT0gXCJub1wiKSB7XHJcbiAgICAgICAgICBjb25maXJtLmxhdW5jaFN0YW5kYXJkTW9kYWwoXCJEaXNhZ3JlZSB3aXRoIFwiICsgZGlzYWdyZWVUZXh0LCBcIlwiLCBcIlwiLCBmYWxzZSwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGxvZy5lZGl0UGF0aWVudEFncmVlKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkLCBpdGVtLCBmYWxzZSwgbG9nLnJlYXNvbi5yZWFzb25UZXh0KTtcclxuICAgICAgICAgICAgJChzZWxmKS5yZW1vdmVDbGFzcyhcImluYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICBjaGVja2JveC5hdHRyKFwiY2hlY2tlZFwiLCBcImNoZWNrZWRcIik7XHJcbiAgICAgICAgICAgIGNoZWNrYm94LnBhcmVudCgpLmFkZENsYXNzKFwiYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICAvL3Vuc2VsZWN0IG90aGVyXHJcbiAgICAgICAgICAgIG90aGVyLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpLmFkZENsYXNzKFwiaW5hY3RpdmVcIik7XHJcbiAgICAgICAgICAgIG90aGVyLmZpbmQoXCJpbnB1dFt0eXBlPWNoZWNrYm94XVwiKS5wcm9wKFwiY2hlY2tlZFwiLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIGNvbmZpcm0ud2lyZVVwQWdyZWVEaXNhZ3JlZShhZ3JlZURpdlNlbGVjdG9yLCBsb2cuZ2V0UGF0aWVudEFncmVlT2JqZWN0KHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkLCBpdGVtKSk7XHJcbiAgICAgICAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgbG9nLmVkaXRQYXRpZW50QWdyZWUocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQsIGl0ZW0sIHRydWUpO1xyXG4gICAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcyhcImluYWN0aXZlXCIpO1xyXG5cclxuICAgICAgICAgIC8vdW5zZWxlY3Qgb3RoZXJcclxuICAgICAgICAgIG90aGVyLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpLmFkZENsYXNzKFwiaW5hY3RpdmVcIik7XHJcbiAgICAgICAgICBvdGhlci5maW5kKFwiaW5wdXRbdHlwZT1jaGVja2JveF1cIikucHJvcChcImNoZWNrZWRcIiwgZmFsc2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfSxcclxuXHJcbiAgd2lyZVVwQWdyZWVEaXNhZ3JlZTogZnVuY3Rpb24oc2VsZWN0b3IsIGFncmVlT2JqZWN0KSB7XHJcbiAgICBpZiAoYWdyZWVPYmplY3QuYWdyZWUgPT09IHRydWUpIHtcclxuICAgICAgc2VsZWN0b3IuY2hpbGRyZW4oJzpudGgoMCknKS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgIHNlbGVjdG9yLmNoaWxkcmVuKCc6bnRoKDEpJykuYWRkQ2xhc3MoJ2luYWN0aXZlJyk7XHJcbiAgICAgIHNlbGVjdG9yLmNoaWxkcmVuKCc6bnRoKDApJykuYXR0cihcInRpdGxlXCIsIGNvbmZpcm0uZ2V0QWdyZWVUb29sdGlwKGFncmVlT2JqZWN0KSkuYXR0cihcImRhdGEtb3JpZ2luYWwtdGl0bGVcIiwgY29uZmlybS5nZXRBZ3JlZVRvb2x0aXAoYWdyZWVPYmplY3QpKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgc2VsZWN0b3IuY2hpbGRyZW4oJzpudGgoMSknKS5hdHRyKFwidGl0bGVcIiwgXCJcIikuYXR0cihcImRhdGEtb3JpZ2luYWwtdGl0bGVcIiwgXCJcIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgIHNlbGVjdG9yLnBhcmVudCgpLmFkZENsYXNzKCdzdWNjZXNzJykucmVtb3ZlQ2xhc3MoJ2RhbmdlcicpO1xyXG4gICAgfSBlbHNlIGlmIChhZ3JlZU9iamVjdC5hZ3JlZSA9PT0gZmFsc2UpIHtcclxuICAgICAgc2VsZWN0b3IuY2hpbGRyZW4oJzpudGgoMCknKS5hZGRDbGFzcygnaW5hY3RpdmUnKTtcclxuICAgICAgc2VsZWN0b3IuY2hpbGRyZW4oJzpudGgoMSknKS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgIHNlbGVjdG9yLmNoaWxkcmVuKCc6bnRoKDApJykuYXR0cihcInRpdGxlXCIsIFwiXCIpLmF0dHIoXCJkYXRhLW9yaWdpbmFsLXRpdGxlXCIsIFwiXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICBzZWxlY3Rvci5jaGlsZHJlbignOm50aCgxKScpLmF0dHIoXCJ0aXRsZVwiLCBjb25maXJtLmdldERpc2dyZWVUb29sdGlwKGFncmVlT2JqZWN0KSkuYXR0cihcImRhdGEtb3JpZ2luYWwtdGl0bGVcIiwgY29uZmlybS5nZXREaXNncmVlVG9vbHRpcChhZ3JlZU9iamVjdCkpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICBzZWxlY3Rvci5wYXJlbnQoKS5hZGRDbGFzcygnZGFuZ2VyJykucmVtb3ZlQ2xhc3MoJ3N1Y2Nlc3MnKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHNlbGVjdG9yLmNoaWxkcmVuKCc6bnRoKDApJykuYXR0cihcInRpdGxlXCIsIFwiQ2xpY2sgdG8gYWdyZWVcIikuYXR0cihcImRhdGEtb3JpZ2luYWwtdGl0bGVcIiwgXCJDbGljayB0byBhZ3JlZVwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgc2VsZWN0b3IuY2hpbGRyZW4oJzpudGgoMSknKS5hdHRyKFwidGl0bGVcIiwgXCJDbGljayB0byBkaXNhZ3JlZVwiKS5hdHRyKFwiZGF0YS1vcmlnaW5hbC10aXRsZVwiLCBcIkNsaWNrIHRvIGRpc2FncmVlXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICBzZWxlY3Rvci5wYXJlbnQoKS5yZW1vdmVDbGFzcygnc3VjY2VzcycpLnJlbW92ZUNsYXNzKCdkYW5nZXInKTtcclxuICAgIH1cclxuICB9LFxyXG5cclxuICBnZXRBZ3JlZVRvb2x0aXA6IGZ1bmN0aW9uKGFncmVlT2JqZWN0KSB7XHJcbiAgICByZXR1cm4gYWdyZWVPYmplY3QuaGlzdG9yeVthZ3JlZU9iamVjdC5oaXN0b3J5Lmxlbmd0aCAtIDFdO1xyXG4gIH0sXHJcblxyXG4gIGdldERpc2dyZWVUb29sdGlwOiBmdW5jdGlvbihhZ3JlZU9iamVjdCkge1xyXG4gICAgcmV0dXJuIGFncmVlT2JqZWN0Lmhpc3RvcnlbYWdyZWVPYmplY3QuaGlzdG9yeS5sZW5ndGggLSAxXSArIFwiIFlvdSBzYWlkOiBcIiArIGFncmVlT2JqZWN0LnJlYXNvbjtcclxuICB9LFxyXG5cclxuICBsYXVuY2hTdGFuZGFyZE1vZGFsOiBmdW5jdGlvbihoZWFkZXIsIHZhbHVlLCByZWFzb24sIGlzVW5kbywgY2FsbGJhY2tPblNhdmUsIGNhbGxiYWNrT25DYW5jZWwsIGNhbGxiYWNrT25VbmRvKSB7XHJcbiAgICBiYXNlLmxhdW5jaE1vZGFsKHtcclxuICAgICAgXCJoZWFkZXJcIjogaGVhZGVyLFxyXG4gICAgICBcImlzVW5kb1wiOiBpc1VuZG8sXHJcbiAgICAgIFwiaXRlbVwiOiB2YWx1ZSxcclxuICAgICAgXCJwbGFjZWhvbGRlclwiOiBcIlByb3ZpZGUgbW9yZSBpbmZvcm1hdGlvbiBoZXJlLi4uXCJcclxuICAgIH0sIG51bGwsIHZhbHVlLCByZWFzb24sIGNhbGxiYWNrT25TYXZlLCBjYWxsYmFja09uQ2FuY2VsLCBjYWxsYmFja09uVW5kbyk7XHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gY29uZmlybTtcclxuIiwidmFyIGJhc2UgPSByZXF1aXJlKCcuLi9iYXNlLmpzJyksXHJcbiAgZGF0YSA9IHJlcXVpcmUoJy4uL2RhdGEuanMnKSxcclxuICBjaGFydCA9IHJlcXVpcmUoJy4uL2NoYXJ0LmpzJyksXHJcbiAgcGF0aWVudExpc3QgPSByZXF1aXJlKCcuL3BhdGllbnRMaXN0LmpzJyk7XHJcblxyXG52YXIgSUQgPSBcIklORElDQVRPUl9CRU5DSE1BUktcIjtcclxuXHJcbnZhciBpVHJlbmQgPSB7XHJcblxyXG4gIHNob3c6IGZ1bmN0aW9uKHBhbmVsLCBpc0FwcGVuZCwgcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkKSB7XHJcblxyXG4gICAgdmFyIGVsZW0gPSAkKFwiPGRpdiBpZD0nYmVuY2htYXJrLWNoYXJ0JyBjbGFzcz0nZml0LXRvLXNjcm9sbGluZy1zZWN0aW9uLWhlaWdodCc+PC9kaXY+XCIpO1xyXG5cclxuICAgIGlmIChpc0FwcGVuZCkgcGFuZWwuYXBwZW5kKGVsZW0pO1xyXG4gICAgZWxzZSBwYW5lbC5odG1sKGVsZW0pO1xyXG5cclxuICAgIGNoYXJ0LmRyYXdCZW5jaG1hcmtDaGFydEhDKFwiYmVuY2htYXJrLWNoYXJ0XCIsIG51bGwpO1xyXG5cclxuICB9LFxyXG5cclxuICB3aXJlVXA6IGZ1bmN0aW9uKCkge1xyXG5cclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBpVHJlbmQ7XHJcbiIsInZhciBkYXRhID0gcmVxdWlyZSgnLi4vZGF0YS5qcycpLFxyXG4gIGNoYXJ0ID0gcmVxdWlyZSgnLi4vY2hhcnQuanMnKTtcclxuXHJcbnZhciBiZCA9IHtcclxuXHJcbiAgd2lyZVVwOiBmdW5jdGlvbigpIHtcclxuXHJcbiAgfSxcclxuXHJcbiAgc2hvdzogZnVuY3Rpb24ocGFuZWwsIGlzQXBwZW5kLCBwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHNlbGVjdFNlcmllc0ZuKSB7XHJcblxyXG4gICAgdmFyIGluZGljYXRvcnMgPSBkYXRhLmdldEluZGljYXRvckRhdGFTeW5jKFtwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmRdLmpvaW4oXCIuXCIpKTtcclxuXHJcbiAgICB2YXIgZGF0YU9iaiA9IGluZGljYXRvcnMub3Bwb3J0dW5pdGllcy5tYXAoZnVuY3Rpb24ob3BwKSB7XHJcbiAgICAgIHJldHVybiBbb3BwLm5hbWUsIG9wcC5kZXNjcmlwdGlvbiwgb3BwLnBhdGllbnRzLmxlbmd0aF07XHJcbiAgICB9KTtcclxuXHJcbiAgICB2YXIgZWxlbSA9ICQoXCI8ZGl2IGlkPSdicmVha2Rvd24tY2hhcnQnPjwvZGl2PlwiKTtcclxuXHJcbiAgICBpZiAoaXNBcHBlbmQpIHBhbmVsLmFwcGVuZChlbGVtKTtcclxuICAgIGVsc2UgcGFuZWwuaHRtbChlbGVtKTtcclxuXHJcbiAgICBjaGFydC5kcmF3QW5hbHl0aWNzKFwiYnJlYWtkb3duLWNoYXJ0XCIsIGRhdGFPYmosIHNlbGVjdFNlcmllc0ZuKTtcclxuXHJcbiAgICBiZC53aXJlVXAoKTtcclxuXHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gYmQ7XHJcbiIsInZhciBkYXRhID0gcmVxdWlyZSgnLi4vZGF0YS5qcycpLFxyXG4gIGNoYXJ0ID0gcmVxdWlyZSgnLi4vY2hhcnQuanMnKSxcclxuICBNdXN0YWNoZSA9IHJlcXVpcmUoJ211c3RhY2hlJyk7XHJcblxyXG52YXIgaGwgPSB7XHJcblxyXG4gIHdpcmVVcDogZnVuY3Rpb24oKSB7XHJcblxyXG4gIH0sXHJcblxyXG4gIHNob3c6IGZ1bmN0aW9uKHBhbmVsLCBpc0FwcGVuZCwgcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkKSB7XHJcblxyXG4gICAgdmFyIGluZGljYXRvcnMgPSBkYXRhLmdldEluZGljYXRvckRhdGFTeW5jKFtwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmRdLmpvaW4oXCIuXCIpKTtcclxuXHJcbiAgICB2YXIgdGVtcE11c3QgPSAkKCcjaW5kaWNhdG9yLWhlYWRsaW5lLXBhbmVsJykuaHRtbCgpO1xyXG4gICAgdmFyIGh0bWwgPSBNdXN0YWNoZS5yZW5kZXIodGVtcE11c3QsIGluZGljYXRvcnMpO1xyXG5cclxuICAgIGlmKGlzQXBwZW5kKSBwYW5lbC5hcHBlbmQoaHRtbCk7XHJcbiAgICBlbHNlIHBhbmVsLmh0bWwoaHRtbCk7XHJcblxyXG4gIH1cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGhsO1xyXG4iLCJ2YXIgYmFzZSA9IHJlcXVpcmUoJy4uL2Jhc2UuanMnKSxcclxuICBsb2cgPSByZXF1aXJlKCcuLi9sb2cuanMnKSxcclxuICBkYXRhID0gcmVxdWlyZSgnLi4vZGF0YS5qcycpLFxyXG4gIHNwYXJrbGluZSA9IHJlcXVpcmUoJ2pxdWVyeS1zcGFya2xpbmUnKSxcclxuICBNdXN0YWNoZSA9IHJlcXVpcmUoJ211c3RhY2hlJyk7XHJcblxyXG52YXIgaW5kaWNhdG9yTGlzdCA9IHtcclxuXHJcbiAgc2hvdzogZnVuY3Rpb24ocGFuZWwsIGlzQXBwZW5kLCBsb2FkQ29udGVudEZuKSB7XHJcbiAgICBkYXRhLmdldEFsbEluZGljYXRvckRhdGEoZnVuY3Rpb24oaW5kaWNhdG9ycykge1xyXG4gICAgICBpbmRpY2F0b3JzLnNvcnQoZnVuY3Rpb24oYSxiKXtcclxuICAgICAgICByZXR1cm4gYS5wZXJmb3JtYW5jZSAtIGIucGVyZm9ybWFuY2U7XHJcbiAgICAgIH0pO1xyXG4gICAgICB2YXIgdGVtcE11c3QgPSAkKCcjb3ZlcnZpZXctcGFuZWwtdGFibGUnKS5odG1sKCk7XHJcbiAgICAgIHZhciBodG1sID0gTXVzdGFjaGUucmVuZGVyKHRlbXBNdXN0LCB7XHJcbiAgICAgICAgXCJpbmRpY2F0b3JzXCI6IGluZGljYXRvcnNcclxuICAgICAgfSk7XHJcbiAgICAgIGlmIChpc0FwcGVuZCkge1xyXG4gICAgICAgIHBhbmVsLmFwcGVuZChodG1sKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBwYW5lbC5odG1sKGh0bWwpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAkKCcuaW5saW5lc3BhcmtsaW5lJykuc3BhcmtsaW5lKCdodG1sJywge1xyXG4gICAgICAgIHRvb2x0aXBGb3JtYXR0ZXI6IGZ1bmN0aW9uKHNwYXJrbGluZSwgb3B0aW9ucywgZmllbGRzKSB7XHJcbiAgICAgICAgICB2YXIgZHRzID0gaW5kaWNhdG9yc1skKCcuaW5saW5lc3BhcmtsaW5lJykuaW5kZXgoc3BhcmtsaW5lLmVsKV0uZGF0ZXM7XHJcbiAgICAgICAgICByZXR1cm4gZHRzW2R0cy5sZW5ndGggLSAxIC0gZmllbGRzLnhdICsgXCI6IFwiICsgZmllbGRzLnkgKyBcIiVcIjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHdpZHRoOiBcIjEwMHB4XCJcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBpbmRpY2F0b3JMaXN0LndpcmVVcChwYW5lbCwgbG9hZENvbnRlbnRGbik7XHJcblxyXG4gICAgfSk7XHJcbiAgfSxcclxuXHJcbiAgcG9wdWxhdGU6IGZ1bmN0aW9uKCkge1xyXG5cclxuICB9LFxyXG5cclxuICB3aXJlVXA6IGZ1bmN0aW9uKHBhbmVsLCBsb2FkQ29udGVudEZuKSB7XHJcbiAgICBwYW5lbC5vZmYoJ2NsaWNrJywgJ3RyLnNob3ctbW9yZS1yb3cgYScpO1xyXG4gICAgcGFuZWwub24oJ2NsaWNrJywgJ3RyLnNob3ctbW9yZS1yb3cgYScsIGZ1bmN0aW9uKGUpIHtcclxuXHJcbiAgICAgIC8vIGRvIG5vdCBnaXZlIGEgZGVmYXVsdCBhY3Rpb25cclxuICAgICAgLy9lLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgIC8vcmV0dXJuIGZhbHNlO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcGFuZWwub2ZmKCdjbGljaycsICd0ci5zdGFuZGFyZC1yb3csdHIuc2hvdy1tb3JlLXJvdycpO1xyXG4gICAgcGFuZWwub24oJ2NsaWNrJywgJ3RyLnN0YW5kYXJkLXJvdyx0ci5zaG93LW1vcmUtcm93JywgZnVuY3Rpb24oZSkge1xyXG4gICAgICB2YXIgdXJsID0gJCh0aGlzKS5kYXRhKFwiaWRcIikucmVwbGFjZSgvXFwuL2csIFwiL1wiKTtcclxuICAgICAgaGlzdG9yeS5wdXNoU3RhdGUobnVsbCwgbnVsbCwgJyNpbmRpY2F0b3JzLycgKyB1cmwpO1xyXG4gICAgICBsb2FkQ29udGVudEZuKCcjaW5kaWNhdG9ycy8nICsgdXJsKTtcclxuICAgICAgLy8gZG8gbm90IGdpdmUgYSBkZWZhdWx0IGFjdGlvblxyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0pO1xyXG5cclxuICAgIHBhbmVsLm9mZignbW91c2VlbnRlcicsICcuc2hvdy1tb3JlLXJvdywuc3RhbmRhcmQtcm93Jyk7XHJcbiAgICBwYW5lbC5vZmYoJ21vdXNlbGVhdmUnLCAnLnNob3ctbW9yZS1yb3csLnN0YW5kYXJkLXJvdycpO1xyXG4gICAgcGFuZWwub24oJ21vdXNlZW50ZXInLCAnLnNob3ctbW9yZS1yb3csLnN0YW5kYXJkLXJvdycsIGZ1bmN0aW9uKGUpe1xyXG4gICAgICB2YXIgaWQgPSAkKHRoaXMpLmRhdGEoXCJpZFwiKTtcclxuICAgICAgJCgnLnNob3ctbW9yZS1yb3dbZGF0YS1pZD1cIicgKyBpZCArICdcIl0sLnN0YW5kYXJkLXJvd1tkYXRhLWlkPVwiJyArIGlkICsgJ1wiXScpLmFkZENsYXNzKCdob3ZlcicpO1xyXG4gICAgfSk7XHJcbiAgICBwYW5lbC5vbignbW91c2VsZWF2ZScsICcuc2hvdy1tb3JlLXJvdywuc3RhbmRhcmQtcm93JywgZnVuY3Rpb24oZSl7XHJcbiAgICAgIHZhciBpZCA9ICQodGhpcykuZGF0YShcImlkXCIpO1xyXG4gICAgICAkKCcuc2hvdy1tb3JlLXJvd1tkYXRhLWlkPVwiJyArIGlkICsgJ1wiXSwuc3RhbmRhcmQtcm93W2RhdGEtaWQ9XCInICsgaWQgKyAnXCJdJykucmVtb3ZlQ2xhc3MoJ2hvdmVyJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBwYW5lbC5vZmYoJ2NsaWNrJywgJy5zaG93LW1vcmUnKTtcclxuICAgIHBhbmVsLm9uKCdjbGljaycsICcuc2hvdy1tb3JlJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICB2YXIgaWQgPSAkKHRoaXMpLmRhdGEoXCJpZFwiKTtcclxuICAgICAgdmFyIGVsZW0gPSAkKCcuc2hvdy1tb3JlLXJvd1tkYXRhLWlkPVwiJyArIGlkICsgJ1wiXScpO1xyXG4gICAgICBpZihlbGVtLmlzKCc6dmlzaWJsZScpKXtcclxuICAgICAgICAkKCcuc2hvdy1tb3JlW2RhdGEtaWQ9XCInICsgaWQgKyAnXCJdOmZpcnN0Jykuc2hvdygpO1xyXG4gICAgICAgIGVsZW0uaGlkZSgpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgICQodGhpcykuaGlkZSgpO1xyXG4gICAgICAgIGVsZW0uc2hvdygnZmFzdCcpO1xyXG4gICAgICB9XHJcbiAgICAgIC8vIGRvIG5vdCBnaXZlIGEgZGVmYXVsdCBhY3Rpb25cclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBpbmRpY2F0b3JMaXN0O1xyXG4iLCJ2YXIgYmFzZSA9IHJlcXVpcmUoJy4uL2Jhc2UuanMnKSxcclxuICBkYXRhID0gcmVxdWlyZSgnLi4vZGF0YS5qcycpLFxyXG4gIGNoYXJ0ID0gcmVxdWlyZSgnLi4vY2hhcnQuanMnKSxcclxuICBwYXRpZW50TGlzdCA9IHJlcXVpcmUoJy4vcGF0aWVudExpc3QuanMnKTtcclxuXHJcbnZhciBJRCA9IFwiSU5ESUNBVE9SX1RSRU5EXCI7XHJcblxyXG52YXIgaVRyZW5kID0ge1xyXG5cclxuICBzaG93OiBmdW5jdGlvbihwYW5lbCwgaXNBcHBlbmQsIHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCkge1xyXG5cclxuICAgIHZhciBpbmRpY2F0b3JzID0gZGF0YS5nZXRBbGxJbmRpY2F0b3JEYXRhU3luYygpO1xyXG5cclxuICAgIHZhciBlbGVtID0gJChcIjxkaXYgaWQ9J3RyZW5kLWNoYXJ0JyBjbGFzcz0nZml0LXRvLXNjcm9sbGluZy1zZWN0aW9uLWhlaWdodCc+PC9kaXY+XCIpO1xyXG5cclxuICAgIGlmIChpc0FwcGVuZCkgcGFuZWwuYXBwZW5kKGVsZW0pO1xyXG4gICAgZWxzZSBwYW5lbC5odG1sKGVsZW0pO1xyXG5cclxuICAgIGNoYXJ0LmRyYXdQZXJmb3JtYW5jZVRyZW5kQ2hhcnRIQyhcInRyZW5kLWNoYXJ0XCIsIGluZGljYXRvcnMuZmlsdGVyKGZ1bmN0aW9uKHYpe1xyXG4gICAgICByZXR1cm4gdi5pZD09PVtwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmRdLmpvaW4oXCIuXCIpO1xyXG4gICAgfSlbMF0pO1xyXG5cclxuICB9LFxyXG5cclxuICB3aXJlVXA6IGZ1bmN0aW9uKCkge1xyXG5cclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBpVHJlbmQ7XHJcbiIsInZhciBiYXNlID0gcmVxdWlyZSgnLi4vYmFzZS5qcycpLFxyXG4gIGNvbmZpcm0gPSByZXF1aXJlKCcuL2NvbmZpcm0uanMnKSxcclxuICBkYXRhID0gcmVxdWlyZSgnLi4vZGF0YS5qcycpLFxyXG4gIGxvZyA9IHJlcXVpcmUoJy4uL2xvZy5qcycpO1xyXG5cclxudmFyIGlhcCA9IHtcclxuXHJcbiAgY3JlYXRlOiBmdW5jdGlvbihwYXRod2F5U3RhZ2UpIHtcclxuICAgIHJldHVybiBiYXNlLmNyZWF0ZVBhbmVsKCQoJyNpbmRpdmlkdWFsLWFjdGlvbi1wbGFuLXBhbmVsJyksIHtcclxuICAgICAgXCJwYXRod2F5U3RhZ2VcIjogcGF0aHdheVN0YWdlIHx8IFwiZGVmYXVsdFwiLFxyXG4gICAgICBcIm5vSGVhZGVyXCI6IHRydWVcclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIHNob3c6IGZ1bmN0aW9uKHBhbmVsLCBwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCkge1xyXG4gICAgcGFuZWwuaHRtbChpYXAuY3JlYXRlKHBhdGh3YXlTdGFnZSkpO1xyXG4gICAgaWFwLndpcmVVcChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcblxyXG4gICAgcGFuZWwuZmluZCgnZGl2LmZpdC10by1zY3JlZW4taGVpZ2h0JykubmljZVNjcm9sbCh7XHJcbiAgICAgIGN1cnNvcm9wYWNpdHltaW46IDAuMyxcclxuICAgICAgY3Vyc29yd2lkdGg6IFwiN3B4XCIsXHJcbiAgICAgIGhvcml6cmFpbGVuYWJsZWQ6IGZhbHNlXHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICB3aXJlVXA6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKSB7XHJcbiAgICBpbmRpdmlkdWFsVGFiID0gJCgnI3RhYi1wbGFuLWluZGl2aWR1YWwnKTtcclxuXHJcbiAgICAvL2ZpbmQgW10gYW5kIHJlcGxhY2Ugd2l0aCBjb3B5IGJ1dHRvblxyXG5cclxuICAgICQoJyNhZHZpY2UtbGlzdCcpLm9uKCdjbGljaycsICcuY3Itc3R5bGVkIGlucHV0W3R5cGU9Y2hlY2tib3hdJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBBQ1RJT05JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKCdpZCcpO1xyXG4gICAgICBsb2cuZWRpdEFjdGlvbihkYXRhLnBhdGllbnRJZCwgQUNUSU9OSUQsIG51bGwsIHRoaXMuY2hlY2tlZCk7XHJcblxyXG4gICAgICBpZiAodGhpcy5jaGVja2VkKSB7XHJcbiAgICAgICAgbG9nLnJlY29yZEV2ZW50KHBhdGh3YXlJZCwgZGF0YS5wYXRpZW50SWQsIFwiSXRlbSBjb21wbGV0ZWRcIik7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgICQoc2VsZikucGFyZW50KCkuYXR0cihcInRpdGxlXCIsIFwiXCIpLmF0dHIoXCJkYXRhLW9yaWdpbmFsLXRpdGxlXCIsIFwiXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgJChzZWxmKS5wYXJlbnQoKS5mYWRlT3V0KDMwMCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBwYXJlbnQgPSAkKHRoaXMpLnBhcmVudCgpO1xyXG4gICAgICAgICAgICAkKHRoaXMpLnJlcGxhY2VXaXRoKGJhc2UuY3JlYXRlUGFuZWwoJCgnI2NoZWNrYm94LXRlbXBsYXRlJyksIHtcclxuICAgICAgICAgICAgICBcImRvbmVcIjogdHJ1ZVxyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgICAgICAgICAgcGFyZW50LmZpbmQoJ2J1dHRvbicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgIEFDVElPTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoJ2lkJyk7XHJcbiAgICAgICAgICAgICAgbG9nLmVkaXRBY3Rpb24oZGF0YS5wYXRpZW50SWQsIEFDVElPTklELCBudWxsLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgJCh0aGlzKS5yZXBsYWNlV2l0aChiYXNlLmNyZWF0ZVBhbmVsKCQoJyNjaGVja2JveC10ZW1wbGF0ZScpLCB7XHJcbiAgICAgICAgICAgICAgICBcImRvbmVcIjogZmFsc2VcclxuICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgaWFwLnVwZGF0ZUluZGl2aWR1YWxTYXBSb3dzKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSwgMTAwMCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlhcC51cGRhdGVJbmRpdmlkdWFsU2FwUm93cygpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgJCgnI3BlcnNvbmFsUGxhbkluZGl2aWR1YWwnKS5vbignY2xpY2snLCAnaW5wdXRbdHlwZT1jaGVja2JveF0nLCBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIFBMQU5JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKFwiaWRcIik7XHJcbiAgICAgIGxvZy5lZGl0UGxhbihQTEFOSUQsIG51bGwsIHRoaXMuY2hlY2tlZCk7XHJcblxyXG4gICAgICBpZiAodGhpcy5jaGVja2VkKSB7XHJcbiAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5wYXJlbnQoKS5wYXJlbnQoKS5hZGRDbGFzcygnc3VjY2VzcycpO1xyXG4gICAgICAgIGxvZy5yZWNvcmRFdmVudChwYXRod2F5SWQsIGRhdGEucGF0aWVudElkLCBcIlBlcnNvbmFsIHBsYW4gaXRlbVwiKTtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgJChzZWxmKS5wYXJlbnQoKS5hdHRyKFwidGl0bGVcIiwgXCJcIikuYXR0cihcImRhdGEtb3JpZ2luYWwtdGl0bGVcIiwgXCJcIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAkKHNlbGYpLnBhcmVudCgpLmZhZGVPdXQoMzAwLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIHBhcmVudCA9ICQodGhpcykucGFyZW50KCk7XHJcbiAgICAgICAgICAgICQodGhpcykucmVwbGFjZVdpdGgoYmFzZS5jcmVhdGVQYW5lbCgkKCcjY2hlY2tib3gtdGVtcGxhdGUnKSwge1xyXG4gICAgICAgICAgICAgIFwiZG9uZVwiOiB0cnVlXHJcbiAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgICAgICAgICBwYXJlbnQuZmluZCgnYnV0dG9uJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgUExBTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoJ2lkJyk7XHJcbiAgICAgICAgICAgICAgbG9nLmVkaXRQbGFuKGRhdGEucGF0aWVudElkLCBQTEFOSUQsIG51bGwsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAkKHRoaXMpLnJlcGxhY2VXaXRoKGJhc2UuY3JlYXRlUGFuZWwoJCgnI2NoZWNrYm94LXRlbXBsYXRlJyksIHtcclxuICAgICAgICAgICAgICAgIFwiZG9uZVwiOiBmYWxzZVxyXG4gICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgICBpYXAudXBkYXRlSW5kaXZpZHVhbFNhcFJvd3MoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9LCAxMDAwKTtcclxuICAgICAgfVxyXG4gICAgfSkub24oJ2NsaWNrJywgJy5idG4tdW5kbycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgdmFyIFBMQU5JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKCdpZCcpO1xyXG4gICAgICBsb2cuZWRpdFBsYW4oUExBTklELCBudWxsLCBmYWxzZSk7XHJcbiAgICAgICQodGhpcykucmVwbGFjZVdpdGgoYmFzZS5jcmVhdGVQYW5lbCgkKCcjY2hlY2tib3gtdGVtcGxhdGUnKSwge1xyXG4gICAgICAgIFwiZG9uZVwiOiBmYWxzZVxyXG4gICAgICB9KSk7XHJcbiAgICAgIGlhcC51cGRhdGVJbmRpdmlkdWFsU2FwUm93cygpO1xyXG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaW5kaXZpZHVhbFRhYi5vbignY2xpY2snLCAnLmVkaXQtcGxhbicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgUExBTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoXCJpZFwiKTtcclxuXHJcbiAgICAgICQoJyNlZGl0QWN0aW9uUGxhbkl0ZW0nKS52YWwoJCgkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuY2hpbGRyZW4oJ3RkJylbMF0pLmZpbmQoJ3NwYW4nKS50ZXh0KCkpO1xyXG5cclxuICAgICAgJCgnI2VkaXRQbGFuJykub2ZmKCdoaWRkZW4uYnMubW9kYWwnKS5vbignaGlkZGVuLmJzLm1vZGFsJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWFwLmRpc3BsYXlQZXJzb25hbGlzZWRJbmRpdmlkdWFsQWN0aW9uUGxhbihkYXRhLnBhdGllbnRJZCwgJCgnI3BlcnNvbmFsUGxhbkluZGl2aWR1YWwnKSk7XHJcbiAgICAgIH0pLm9mZignc2hvd24uYnMubW9kYWwnKS5vbignc2hvd24uYnMubW9kYWwnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAkKCcjZWRpdEFjdGlvblBsYW5JdGVtJykuZm9jdXMoKTtcclxuICAgICAgfSkub2ZmKCdjbGljaycsICcuc2F2ZS1wbGFuJykub24oJ2NsaWNrJywgJy5zYXZlLXBsYW4nLCBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgbG9nLmVkaXRQbGFuKFBMQU5JRCwgJCgnI2VkaXRBY3Rpb25QbGFuSXRlbScpLnZhbCgpKTtcclxuXHJcbiAgICAgICAgJCgnI2VkaXRQbGFuJykubW9kYWwoJ2hpZGUnKTtcclxuICAgICAgfSkub2ZmKCdrZXl1cCcsICcjZWRpdEFjdGlvblBsYW5JdGVtJykub24oJ2tleXVwJywgJyNlZGl0QWN0aW9uUGxhbkl0ZW0nLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgaWYgKGUud2hpY2ggPT09IDEzKSAkKCcjZWRpdFBsYW4gLnNhdmUtcGxhbicpLmNsaWNrKCk7XHJcbiAgICAgIH0pLm1vZGFsKCk7XHJcbiAgICB9KS5vbignY2xpY2snLCAnLmRlbGV0ZS1wbGFuJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBQTEFOSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YShcImlkXCIpO1xyXG5cclxuICAgICAgJCgnI2luZGl2aWR1YWwtZGVsZXRlLWl0ZW0nKS5odG1sKCQoJCh0aGlzKS5jbG9zZXN0KCd0cicpLmNoaWxkcmVuKCd0ZCcpWzBdKS5maW5kKCdzcGFuJykudGV4dCgpKTtcclxuXHJcbiAgICAgICQoJyNkZWxldGVQbGFuJykub2ZmKCdoaWRkZW4uYnMubW9kYWwnKS5vbignaGlkZGVuLmJzLm1vZGFsJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWFwLmRpc3BsYXlQZXJzb25hbGlzZWRJbmRpdmlkdWFsQWN0aW9uUGxhbihkYXRhLnBhdGllbnRJZCwgJCgnI3BlcnNvbmFsUGxhbkluZGl2aWR1YWwnKSk7XHJcbiAgICAgIH0pLm9mZignY2xpY2snLCAnLmRlbGV0ZS1wbGFuJykub24oJ2NsaWNrJywgJy5kZWxldGUtcGxhbicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGxvZy5kZWxldGVQbGFuKFBMQU5JRCk7XHJcblxyXG4gICAgICAgICQoJyNkZWxldGVQbGFuJykubW9kYWwoJ2hpZGUnKTtcclxuICAgICAgfSkubW9kYWwoKTtcclxuICAgIH0pLm9uKCdjbGljaycsICcuYWRkLXBsYW4nLCBmdW5jdGlvbigpIHtcclxuICAgICAgbG9nLnJlY29yZFBsYW4oZGF0YS5wYXRpZW50SWQsICQodGhpcykucGFyZW50KCkucGFyZW50KCkuZmluZCgndGV4dGFyZWEnKS52YWwoKSwgcGF0aHdheUlkKTtcclxuXHJcbiAgICAgIGlhcC5kaXNwbGF5UGVyc29uYWxpc2VkSW5kaXZpZHVhbEFjdGlvblBsYW4oZGF0YS5wYXRpZW50SWQsICQoJyNwZXJzb25hbFBsYW5JbmRpdmlkdWFsJykpO1xyXG4gICAgfSkub24oJ2NoYW5nZScsICcuYnRuLXRvZ2dsZSBpbnB1dFt0eXBlPWNoZWNrYm94XScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICBpYXAudXBkYXRlSW5kaXZpZHVhbFNhcFJvd3MoKTtcclxuICAgIH0pLm9uKCdjbGljaycsICcuYnRuLXVuZG8nLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIHZhciBBQ1RJT05JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKCdpZCcpO1xyXG4gICAgICBsb2cuZWRpdEFjdGlvbihkYXRhLnBhdGllbnRJZCwgQUNUSU9OSUQsIG51bGwsIGZhbHNlKTtcclxuICAgICAgJCh0aGlzKS5yZXBsYWNlV2l0aChiYXNlLmNyZWF0ZVBhbmVsKCQoJyNjaGVja2JveC10ZW1wbGF0ZScpLCB7XHJcbiAgICAgICAgXCJkb25lXCI6IGZhbHNlXHJcbiAgICAgIH0pKTtcclxuICAgICAgaWFwLnVwZGF0ZUluZGl2aWR1YWxTYXBSb3dzKCk7XHJcbiAgICB9KS5vbignY2xpY2snLCAnLmJ0bi15ZXMsLmJ0bi1ubycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgdmFyIGNoZWNrYm94ID0gJCh0aGlzKS5maW5kKFwiaW5wdXRbdHlwZT1jaGVja2JveF1cIik7XHJcbiAgICAgIHZhciBvdGhlciA9ICQodGhpcykucGFyZW50KCkuZmluZCgkKHRoaXMpLmhhc0NsYXNzKFwiYnRuLXllc1wiKSA/IFwiLmJ0bi1ub1wiIDogXCIuYnRuLXllc1wiKTtcclxuICAgICAgdmFyIEFDVElPTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoJ2lkJyk7XHJcbiAgICAgIGlmICgkKHRoaXMpLmhhc0NsYXNzKFwiYWN0aXZlXCIpICYmIG90aGVyLmhhc0NsYXNzKFwiaW5hY3RpdmVcIikgJiYgISQodGhpcykuY2xvc2VzdCgndHInKS5oYXNDbGFzcygnc3VjY2VzcycpKSB7XHJcbiAgICAgICAgLy91bnNlbGVjdGluZ1xyXG4gICAgICAgIGlmIChjaGVja2JveC52YWwoKSA9PT0gXCJub1wiKSB7XHJcbiAgICAgICAgICBpYXAubGF1bmNoTW9kYWwoZGF0YS5zZWxlY3RlZCwgY2hlY2tib3guY2xvc2VzdCgndHInKS5jaGlsZHJlbigpLmZpcnN0KCkuY2hpbGRyZW4oKS5maXJzdCgpLnRleHQoKSwgbG9nLmdldFJlYXNvbihkYXRhLnBhdGllbnRJZCwgQUNUSU9OSUQpLCB0cnVlLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgbG9nLmVkaXRBY3Rpb24oZGF0YS5wYXRpZW50SWQsIEFDVElPTklELCBmYWxzZSwgbnVsbCwgbG9nLnJlYXNvbik7XHJcbiAgICAgICAgICAgIGlhcC51cGRhdGVJbmRpdmlkdWFsU2FwUm93cygpO1xyXG4gICAgICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICAgICAgICB9LCBudWxsLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgbG9nLmlnbm9yZUFjdGlvbihkYXRhLnBhdGllbnRJZCwgQUNUSU9OSUQpO1xyXG4gICAgICAgICAgICBvdGhlci5yZW1vdmVDbGFzcyhcImluYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICBjaGVja2JveC5yZW1vdmVBdHRyKFwiY2hlY2tlZFwiKTtcclxuICAgICAgICAgICAgY2hlY2tib3gucGFyZW50KCkucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XHJcbiAgICAgICAgICAgIGlhcC51cGRhdGVJbmRpdmlkdWFsU2FwUm93cygpO1xyXG4gICAgICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGxvZy5pZ25vcmVBY3Rpb24oZGF0YS5wYXRpZW50SWQsIEFDVElPTklEKTtcclxuICAgICAgICAgIG90aGVyLnJlbW92ZUNsYXNzKFwiaW5hY3RpdmVcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2UgaWYgKCghJCh0aGlzKS5oYXNDbGFzcyhcImFjdGl2ZVwiKSAmJiBvdGhlci5oYXNDbGFzcyhcImFjdGl2ZVwiKSkgfHwgJCh0aGlzKS5jbG9zZXN0KCd0cicpLmhhc0NsYXNzKCdzdWNjZXNzJykpIHtcclxuICAgICAgICAvL3ByZXZlbnQgY2xpY2tpbmcgb24gdW5zZWxlY3RlZCBvcHRpb24gb3IgaWYgdGhlIHJvdyBpcyBjb21wbGV0ZVxyXG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvL3NlbGVjdGluZ1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBpZiAoY2hlY2tib3gudmFsKCkgPT09IFwibm9cIikge1xyXG4gICAgICAgICAgaWFwLmxhdW5jaE1vZGFsKGRhdGEuc2VsZWN0ZWQsIGNoZWNrYm94LmNsb3Nlc3QoJ3RyJykuY2hpbGRyZW4oKS5maXJzdCgpLmNoaWxkcmVuKCkuZmlyc3QoKS50ZXh0KCksIGxvZy5nZXRSZWFzb24oZGF0YS5wYXRpZW50SWQsIEFDVElPTklEKSwgZmFsc2UsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBsb2cuZWRpdEFjdGlvbihkYXRhLnBhdGllbnRJZCwgQUNUSU9OSUQsIGZhbHNlLCBudWxsLCBsb2cucmVhc29uKTtcclxuICAgICAgICAgICAgJChzZWxmKS5yZW1vdmVDbGFzcyhcImluYWN0aXZlXCIpO1xyXG5cclxuICAgICAgICAgICAgY2hlY2tib3guYXR0cihcImNoZWNrZWRcIiwgXCJjaGVja2VkXCIpO1xyXG4gICAgICAgICAgICBjaGVja2JveC5wYXJlbnQoKS5hZGRDbGFzcyhcImFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgLy91bnNlbGVjdCBvdGhlclxyXG4gICAgICAgICAgICBvdGhlci5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKS5hZGRDbGFzcyhcImluYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICBvdGhlci5maW5kKFwiaW5wdXRbdHlwZT1jaGVja2JveF1cIikucHJvcChcImNoZWNrZWRcIiwgZmFsc2UpO1xyXG4gICAgICAgICAgICBpYXAudXBkYXRlSW5kaXZpZHVhbFNhcFJvd3MoKTtcclxuICAgICAgICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBsb2cuZWRpdEFjdGlvbihkYXRhLnBhdGllbnRJZCwgQUNUSU9OSUQsIHRydWUpO1xyXG4gICAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcyhcImluYWN0aXZlXCIpO1xyXG5cclxuICAgICAgICAgIC8vdW5zZWxlY3Qgb3RoZXJcclxuICAgICAgICAgIG90aGVyLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpLmFkZENsYXNzKFwiaW5hY3RpdmVcIik7XHJcbiAgICAgICAgICBvdGhlci5maW5kKFwiaW5wdXRbdHlwZT1jaGVja2JveF1cIikucHJvcChcImNoZWNrZWRcIiwgZmFsc2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSkub24oJ2tleXVwJywgJ2lucHV0W3R5cGU9dGV4dF0nLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIGlmIChlLndoaWNoID09PSAxMykge1xyXG4gICAgICAgIGluZGl2aWR1YWxUYWIuZmluZCgnLmFkZC1wbGFuJykuY2xpY2soKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgJCgnI2FkdmljZS1saXN0Jykub2ZmKCdjbGljaycsICcuc2hvdy1tb3JlJyk7XHJcbiAgICAkKCcjYWR2aWNlLWxpc3QnKS5vbignY2xpY2snLCAnLnNob3ctbW9yZScsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgdmFyIGlkID0gJCh0aGlzKS5kYXRhKFwiaWRcIik7XHJcbiAgICAgIHZhciBlbGVtID0gJCgnLnNob3ctbW9yZS1yb3dbZGF0YS1pZD1cIicgKyBpZCArICdcIl0nKTtcclxuICAgICAgaWYoZWxlbS5pcygnOnZpc2libGUnKSl7XHJcbiAgICAgICAgJCgnLnNob3ctbW9yZVtkYXRhLWlkPVwiJyArIGlkICsgJ1wiXTpmaXJzdCcpLnNob3coKTtcclxuICAgICAgICBlbGVtLmhpZGUoKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAkKHRoaXMpLmhpZGUoKTtcclxuICAgICAgICBlbGVtLnNob3coJ2Zhc3QnKTtcclxuICAgICAgfVxyXG4gICAgICAvLyBkbyBub3QgZ2l2ZSBhIGRlZmF1bHQgYWN0aW9uXHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaWFwLnBvcHVsYXRlSW5kaXZpZHVhbFN1Z2dlc3RlZEFjdGlvbnMocGF0aWVudElkLCBwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQpO1xyXG4gIH0sXHJcblxyXG4gIHVwZGF0ZUluZGl2aWR1YWxTYXBSb3dzOiBmdW5jdGlvbigpIHtcclxuICAgIC8qJCgnI2FkdmljZS1saXN0JykuYWRkKCcjcGVyc29uYWxQbGFuSW5kaXZpZHVhbCcpLmZpbmQoJy5zdWdnZXN0aW9uJykuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgJCh0aGlzKS5maW5kKCd0ZCcpLmxhc3QoKS5jaGlsZHJlbigpLmhpZGUoKTtcclxuICAgIH0pOyovXHJcblxyXG4gICAgLyokKCcjYWR2aWNlLWxpc3QnKS5hZGQoJyNwZXJzb25hbFBsYW5JbmRpdmlkdWFsJykuZmluZCgnLmNyLXN0eWxlZCBpbnB1dFt0eXBlPWNoZWNrYm94XScpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgIGlmICh0aGlzLmNoZWNrZWQpIHtcclxuICAgICAgICAkKHRoaXMpLnBhcmVudCgpLnBhcmVudCgpLnBhcmVudCgpLmFkZENsYXNzKCdzdWNjZXNzJyk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5wYXJlbnQoKS5wYXJlbnQoKS5yZW1vdmVDbGFzcygnc3VjY2VzcycpO1xyXG4gICAgICB9XHJcbiAgICB9KTsqL1xyXG5cclxuICAgIC8qJCgnI2FkdmljZS1saXN0JykuYWRkKCcjcGVyc29uYWxQbGFuSW5kaXZpZHVhbCcpLmZpbmQoJy5idG4tdW5kbycpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgICQodGhpcykucGFyZW50KCkucGFyZW50KCkuYWRkQ2xhc3MoJ3N1Y2Nlc3MnKTtcclxuICAgIH0pOyovXHJcblxyXG4gICAgLy9ubyBjbGFzcyAtIHVzZXIgbm90IHlldCBhZ3JlZWQvZGlzYWdyZWVkIC0gbm8gYmFja2dyb3VuZCAvIG11dGVkIHRleHRcclxuICAgIC8vYWN0aXZlIC0gdXNlciBhZ3JlZXMgLSBncmVlbiBiYWNrZ3JvdW5kIC8gbm9ybWFsIHRleHRcclxuICAgIC8vc3VjY2VzcyAtIHVzZXIgY29tcGxldGVkIC0gZ3JlZW4gYmFja2dyb3VuZCAvIHN0cmlrZXRocm91Z2ggdGV4dFxyXG4gICAgLy9kYW5nZXIgLSB1c2VyIGRpc2FncmVlcyAtIHJlZCBiYWNrZ3JvdW5kIC8gc3RyaWtldGhyb3VnaCB0ZXh0XHJcblxyXG4gICAgJCgnI2FkdmljZS1saXN0JykuYWRkKCcjcGVyc29uYWxQbGFuSW5kaXZpZHVhbCcpLmZpbmQoJ3RyLnN1Z2dlc3Rpb24nKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgc2VsZiA9ICQodGhpcyk7XHJcbiAgICAgIHZhciBpZCA9IHNlbGYuZGF0YShcImlkXCIpO1xyXG4gICAgICB2YXIgYWxsID0gJCgnLnNob3ctbW9yZS1yb3dbZGF0YS1pZD1cIicgKyBpZCArICdcIl0sLnN1Z2dlc3Rpb25bZGF0YS1pZD1cIicgKyBpZCArICdcIl0nKTtcclxuICAgICAgdmFyIGFueSA9IGZhbHNlO1xyXG4gICAgICBzZWxmLmZpbmQoJy5idG4tdG9nZ2xlIGlucHV0W3R5cGU9Y2hlY2tib3hdOmNoZWNrZWQnKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGFueSA9IHRydWU7XHJcbiAgICAgICAgaWYgKHRoaXMudmFsdWUgPT09IFwieWVzXCIpIHtcclxuICAgICAgICAgIGFsbC5yZW1vdmVDbGFzcygnZGFuZ2VyJyk7XHJcbiAgICAgICAgICBhbGwuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgLy9zZWxmLmZpbmQoJ3RkJykubGFzdCgpLmNoaWxkcmVuKCkuc2hvdygpO1xyXG4gICAgICAgICAgaWYgKGxvZy5nZXRBY3Rpb25zKClbZGF0YS5wYXRpZW50SWRdW3NlbGYuZGF0YShcImlkXCIpXS5oaXN0b3J5KSB7XHJcbiAgICAgICAgICAgIHZhciB0b29sID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmhhc0NsYXNzKCdzdWNjZXNzJykgPyBcIlwiIDogXCI8cD5cIiArIGxvZy5nZXRBY3Rpb25zKClbZGF0YS5wYXRpZW50SWRdW3NlbGYuZGF0YShcImlkXCIpXS5oaXN0b3J5WzBdICsgXCI8L3A+PHA+Q2xpY2sgYWdhaW4gdG8gY2FuY2VsPC9wPlwiO1xyXG4gICAgICAgICAgICAkKHRoaXMpLnBhcmVudCgpLmF0dHIoXCJ0aXRsZVwiLCB0b29sKS5hdHRyKFwiZGF0YS1vcmlnaW5hbC10aXRsZVwiLCB0b29sKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICQodGhpcykucGFyZW50KCkuYXR0cihcInRpdGxlXCIsIFwiWW91IGFncmVlZCAtIGNsaWNrIGFnYWluIHRvIGNhbmNlbFwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgYWxsLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgIGFsbC5hZGRDbGFzcygnZGFuZ2VyJyk7XHJcbiAgICAgICAgICBhbGwucmVtb3ZlQ2xhc3MoJ3N1Y2Nlc3MnKTtcclxuICAgICAgICAgIGlmIChsb2cuZ2V0QWN0aW9ucygpW2RhdGEucGF0aWVudElkXVtzZWxmLmRhdGEoXCJpZFwiKV0gJiYgbG9nLmdldEFjdGlvbnMoKVtkYXRhLnBhdGllbnRJZF1bc2VsZi5kYXRhKFwiaWRcIildLmhpc3RvcnkpIHtcclxuICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5hdHRyKFwidGl0bGVcIiwgXCI8cD5cIiArIGxvZy5nZXRBY3Rpb25zKClbZGF0YS5wYXRpZW50SWRdW3NlbGYuZGF0YShcImlkXCIpXS5oaXN0b3J5WzBdICsgXCI8L3A+PHA+Q2xpY2sgYWdhaW4gdG8gZWRpdC9jYW5jZWw8L3A+XCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5hdHRyKFwidGl0bGVcIiwgXCJZb3UgZGlzYWdyZWVkIC0gY2xpY2sgYWdhaW4gdG8gZWRpdC9jYW5jZWxcIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgICAgaWYgKHNlbGYuZmluZCgnLmJ0bi10b2dnbGUgaW5wdXRbdHlwZT1jaGVja2JveF06bm90KDpjaGVja2VkKScpLmxlbmd0aCA9PSAxKSB7XHJcbiAgICAgICAgc2VsZi5maW5kKCcuYnRuLXRvZ2dsZSBpbnB1dFt0eXBlPWNoZWNrYm94XTpub3QoOmNoZWNrZWQpJykucGFyZW50KCkuYWRkQ2xhc3MoXCJpbmFjdGl2ZVwiKS5hdHRyKFwidGl0bGVcIiwgXCJcIikuYXR0cihcImRhdGEtb3JpZ2luYWwtdGl0bGVcIiwgXCJcIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKCFhbnkpIHtcclxuICAgICAgICBhbGwucmVtb3ZlQ2xhc3MoJ2RhbmdlcicpO1xyXG4gICAgICAgIGFsbC5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgYWxsLnJlbW92ZUNsYXNzKCdzdWNjZXNzJyk7XHJcblxyXG4gICAgICAgIHNlbGYuZmluZCgnLmJ0bi10b2dnbGUuYnRuLXllcycpLmF0dHIoXCJ0aXRsZVwiLCBcIkNsaWNrIHRvIGFncmVlIHdpdGggdGhpcyBhY3Rpb24gYW5kIHNhdmUgaXQgaW4geW91ciBhZ3JlZWQgYWN0aW9ucyBsaXN0ICBcIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgICAgc2VsZi5maW5kKCcuYnRuLXRvZ2dsZS5idG4tbm8nKS5hdHRyKFwidGl0bGVcIiwgXCJDbGljayB0byBkaXNhZ3JlZSB3aXRoIHRoaXMgYWN0aW9uIGFuZCByZW1vdmUgaXQgZnJvbSB5b3VyIHN1Z2dlc3RlZCBhY3Rpb25zIGxpc3QgXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICB9KTtcclxuICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICB9LFxyXG5cclxuICBkaXNwbGF5UGVyc29uYWxpc2VkSW5kaXZpZHVhbEFjdGlvblBsYW46IGZ1bmN0aW9uKGlkLCBwYXJlbnRFbGVtKSB7XHJcbiAgICB2YXIgcGxhbnMgPSBiYXNlLnNvcnRTdWdnZXN0aW9ucyhiYXNlLmFkZERpc2FncmVlUGVyc29uYWxUZWFtKGxvZy5saXN0UGxhbnMoaWQpKSk7XHJcblxyXG4gICAgYmFzZS5jcmVhdGVQYW5lbFNob3coYWN0aW9uUGxhbkxpc3QsIHBhcmVudEVsZW0sIHtcclxuICAgICAgXCJoYXNTdWdnZXN0aW9uc1wiOiBwbGFucyAmJiBwbGFucy5sZW5ndGggPiAwLFxyXG4gICAgICBcInN1Z2dlc3Rpb25zXCI6IHBsYW5zXHJcbiAgICB9LCB7XHJcbiAgICAgIFwiYWN0aW9uLXBsYW5cIjogJCgnI2FjdGlvbi1wbGFuJykuaHRtbCgpLFxyXG4gICAgICBcImFjdGlvbi1wbGFuLWl0ZW1cIjogJCgnI2FjdGlvbi1wbGFuLWl0ZW0nKS5odG1sKCksXHJcbiAgICAgIFwiY2hrXCI6ICQoJyNjaGVja2JveC10ZW1wbGF0ZScpLmh0bWwoKVxyXG4gICAgfSk7XHJcblxyXG4gICAgaWFwLnVwZGF0ZUluZGl2aWR1YWxTYXBSb3dzKCk7XHJcbiAgfSxcclxuXHJcbiAgcG9wdWxhdGVJbmRpdmlkdWFsU3VnZ2VzdGVkQWN0aW9uczogZnVuY3Rpb24ocGF0aWVudElkLCBwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQpIHtcclxuICAgIHZhciBsb2NhbERhdGEgPSB7XHJcbiAgICAgIFwibmhzTnVtYmVyXCI6IGRhdGEucGF0TG9va3VwID8gZGF0YS5wYXRMb29rdXBbcGF0aWVudElkXSA6IHBhdGllbnRJZCxcclxuICAgICAgXCJwYXRpZW50SWRcIjogcGF0aWVudElkXHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBwYXRpZW50RGF0YSA9IGRhdGEuZ2V0UGF0aWVudERhdGEocGF0aWVudElkKTtcclxuXHJcbiAgICB2YXIgYnJlYWNoZXMgPSBkYXRhLnBhdGllbnRzW3BhdGllbnRJZF0uYnJlYWNoID8gZGF0YS5wYXRpZW50c1twYXRpZW50SWRdLmJyZWFjaC5maWx0ZXIoZnVuY3Rpb24odikge1xyXG4gICAgICByZXR1cm4gdi5wYXRod2F5SWQgPT09IHBhdGh3YXlJZCAmJiB2LnBhdGh3YXlTdGFnZSA9PT0gcGF0aHdheVN0YWdlICYmIHYuc3RhbmRhcmQgPT09IHN0YW5kYXJkO1xyXG4gICAgfSkgOiBbXTtcclxuXHJcbiAgICB2YXIgZm4gPSBmdW5jdGlvbih2YWwpIHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBcImlkXCI6IHZhbCxcclxuICAgICAgICBcInN1YnNlY3Rpb25cIjogc3Vic2VjdGlvblxyXG4gICAgICB9O1xyXG4gICAgfTtcclxuXHJcbiAgICBpZiAocGF0aWVudERhdGEuYWN0aW9ucy5sZW5ndGggPT09IDApIHtcclxuICAgICAgbG9jYWxEYXRhLm5vU3VnZ2VzdGlvbnMgPSB0cnVlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLyp2YXIgc3VnZ2VzdGlvbnMgPSBbXSxcclxuICAgICAgICBzdWJzZWN0aW9uID0gXCJcIjtcclxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBicmVhY2hlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIHN1YnNlY3Rpb24gPSBicmVhY2hlc1tpXS5zdWJzZWN0aW9uO1xyXG4gICAgICAgIHN1Z2dlc3Rpb25zID0gc3VnZ2VzdGlvbnMuY29uY2F0KGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLmJkb3duW3N1YnNlY3Rpb25dLnN1Z2dlc3Rpb25zID9cclxuICAgICAgICAgIGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLmJkb3duW3N1YnNlY3Rpb25dLnN1Z2dlc3Rpb25zLm1hcChmbikgOiBbXSk7XHJcbiAgICAgIH0qL1xyXG5cclxuICAgICAgbG9jYWxEYXRhLnN1Z2dlc3Rpb25zID0gYmFzZS5zb3J0U3VnZ2VzdGlvbnMoYmFzZS5tZXJnZUluZGl2aWR1YWxTdHVmZihwYXRpZW50RGF0YS5hY3Rpb25zLCBwYXRpZW50SWQpKTtcclxuICAgICAgLypsb2NhbERhdGEuc2VjdGlvbiA9IHtcclxuICAgICAgICBcIm5hbWVcIjogZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uYmRvd25bc3Vic2VjdGlvbl0ubmFtZSxcclxuICAgICAgICBcImFncmVlXCI6IGxvZy5nZXRQYXRpZW50QWdyZWUocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHBhdGllbnRJZCwgXCJzZWN0aW9uXCIpID09PSB0cnVlLFxyXG4gICAgICAgIFwiZGlzYWdyZWVcIjogbG9nLmdldFBhdGllbnRBZ3JlZShwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgcGF0aWVudElkLCBcInNlY3Rpb25cIikgPT09IGZhbHNlLFxyXG4gICAgICB9O1xyXG4gICAgICBsb2NhbERhdGEuY2F0ZWdvcnkgPSB7XHJcbiAgICAgICAgXCJuYW1lXCI6IGRhdGEucGF0aWVudHNbcGF0aWVudElkXS5jYXRlZ29yeSxcclxuICAgICAgICBcImFncmVlXCI6IGxvZy5nZXRQYXRpZW50QWdyZWUocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHBhdGllbnRJZCwgXCJjYXRlZ29yeVwiKSA9PT0gdHJ1ZSxcclxuICAgICAgICBcImRpc2FncmVlXCI6IGxvZy5nZXRQYXRpZW50QWdyZWUocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHBhdGllbnRJZCwgXCJjYXRlZ29yeVwiKSA9PT0gZmFsc2UsXHJcbiAgICAgIH07Ki9cclxuICAgIH1cclxuXHJcbiAgICAkKCcjYWR2aWNlLXBsYWNlaG9sZGVyJykuaGlkZSgpO1xyXG4gICAgJCgnI2FkdmljZScpLnNob3coKTtcclxuXHJcbiAgICBiYXNlLmNyZWF0ZVBhbmVsU2hvdyhpbmRpdmlkdWFsUGFuZWwsICQoJyNhZHZpY2UtbGlzdCcpLCBsb2NhbERhdGEpO1xyXG5cclxuICAgIC8vV2lyZSB1cCBhbnkgY2xpcGJvYXJkIHN0dWZmIGluIHRoZSBzdWdnZXN0aW9uc1xyXG4gICAgJCgnI2FkdmljZS1saXN0JykuZmluZCgnc3Bhbjpjb250YWlucyhcIltDT1BZXCIpJykuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIGh0bWwgPSAkKHRoaXMpLmh0bWwoKTtcclxuICAgICAgJCh0aGlzKS5odG1sKGh0bWwucmVwbGFjZSgvXFxbQ09QWTooW15cXF1dKilcXF0vZywgJyQxIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIGRhdGEtY2xpcGJvYXJkLXRleHQ9XCIkMVwiIGRhdGEtY29udGVudD1cIkNvcGllZFwiIGRhdGEtdG9nZ2xlPVwidG9vbHRpcFwiIGRhdGEtcGxhY2VtZW50PVwidG9wXCIgdGl0bGU9XCJDb3B5ICQxIHRvIGNsaXBib2FyZC5cIiBjbGFzcz1cImJ0biBidG4teHMgYnRuLWRlZmF1bHQgYnRuLWNvcHlcIj48c3BhbiBjbGFzcz1cImZhIGZhLWNsaXBib2FyZFwiPjwvc3Bhbj48L2J1dHRvbj4nKSk7XHJcbiAgICB9KTtcclxuICAgICQoJyNhZHZpY2UtbGlzdCcpLmZpbmQoJ3NwYW46Y29udGFpbnMoXCJbXCIpJykuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIGh0bWwgPSAkKHRoaXMpLmh0bWwoKTtcclxuICAgICAgJCh0aGlzKS5odG1sKGh0bWwucmVwbGFjZSgvXFxbKFteXFxdXSopXFxdL2csICcgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgZGF0YS1jbGlwYm9hcmQtdGV4dD1cIiQxXCIgZGF0YS1jb250ZW50PVwiQ29waWVkXCIgZGF0YS10b2dnbGU9XCJ0b29sdGlwXCIgZGF0YS1wbGFjZW1lbnQ9XCJ0b3BcIiB0aXRsZT1cIkNvcHkgJDEgdG8gY2xpcGJvYXJkLlwiIGNsYXNzPVwiYnRuIGJ0bi14cyBidG4tZGVmYXVsdCBidG4tY29weVwiPjxzcGFuIGNsYXNzPVwiZmEgZmEtY2xpcGJvYXJkXCI+PC9zcGFuPjwvYnV0dG9uPicpKTtcclxuICAgIH0pO1xyXG5cclxuICAgICQoJyNhZHZpY2UtbGlzdCcpLmZpbmQoJ3NwYW46Y29udGFpbnMoXCJbSU5GT1wiKScpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBodG1sID0gJCh0aGlzKS5odG1sKCk7XHJcbiAgICAgIHZhciBzdWJzZWN0aW9uID0gJCh0aGlzKS5kYXRhKCkuc3Vic2VjdGlvbjtcclxuICAgICAgdmFyIGRlc2MgPSBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLm9wcG9ydHVuaXRpZXMuZmlsdGVyKGZ1bmN0aW9uKHZhbCkge1xyXG4gICAgICAgICAgcmV0dXJuIHZhbC5uYW1lID09PSBzdWJzZWN0aW9uO1xyXG4gICAgICAgIH0pLmxlbmd0aCA+IDAgP1xyXG4gICAgICAgIGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0ub3Bwb3J0dW5pdGllcy5maWx0ZXIoZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgICAgICByZXR1cm4gdmFsLm5hbWUgPT09IHN1YnNlY3Rpb247XHJcbiAgICAgICAgfSlbMF0uZGVzYyA6IHN1YnNlY3Rpb247XHJcbiAgICAgIHZhciB0b29sdGlwID0gc3Vic2VjdGlvbiA/IFwiVGhpcyBhY3Rpb24gaXMgc3VnZ2VzdGVkIGJlY2F1c2UgUElOR1IgY2xhc3NpZmllZCB0aGlzIHBhdGllbnQgYXM6J1wiICsgZGVzYyArIFwiJ1wiIDogJyc7XHJcbiAgICAgIHZhciBuZXdIdG1sID0gJyA8aSBjbGFzcz1cImZhIGZhLWluZm8tY2lyY2xlIGZhLWxnIGluZm8tYnV0dG9uIGNsaWNrYWJsZVwiIGRhdGEtdG9nZ2xlPVwidG9vbHRpcFwiIGRhdGEtcGxhY2VtZW50PVwicmlnaHRcIiB0aXRsZT1cIicgKyB0b29sdGlwICsgJ1wiPjwvaT4nO1xyXG4gICAgICAkKHRoaXMpLmh0bWwoaHRtbC5yZXBsYWNlKC9cXFtJTkZPXFxdL2csIG5ld0h0bWwpKTtcclxuICAgIH0pO1xyXG5cclxuICAgICQoJyNhZHZpY2UtbGlzdCcpLmZpbmQoJ3NwYW46Y29udGFpbnMoXCJbTUVELVNVR0dFU1RJT05cIiknKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgaHRtbCA9ICQodGhpcykuaHRtbCgpO1xyXG4gICAgICB2YXIgc3VnZ2VzdGlvbiA9IE1hdGgucmFuZG9tKCkgPCAwLjMzID8gXCJJbmNyZWFzZSBSYW1pcHJpbCB0byAxMG1nIHBlciBkYXlcIiA6IChNYXRoLnJhbmRvbSgpIDwgMC41ID8gXCJDb25zaWRlciBhZGRpbmcgYW4gQUNFIGluaGliaW9yXCIgOiBcIkNvbnNpZGVyIGFkZGluZyBhIHRoaWF6aWRlLWxpa2UgZGl1cmV0aWNcIik7XHJcbiAgICAgICQodGhpcykuaHRtbChodG1sLnJlcGxhY2UoL1xcW01FRFxcLVNVR0dFU1RJT05cXF0vZywgc3VnZ2VzdGlvbikpO1xyXG4gICAgfSk7XHJcblxyXG5cclxuICAgIGJhc2Uuc2V0dXBDbGlwYm9hcmQoJCgnLmJ0bi1jb3B5JyksIHRydWUpO1xyXG5cclxuICAgIGlhcC5kaXNwbGF5UGVyc29uYWxpc2VkSW5kaXZpZHVhbEFjdGlvblBsYW4ocGF0aWVudElkLCAkKCcjcGVyc29uYWxQbGFuSW5kaXZpZHVhbCcpKTtcclxuICB9LFxyXG5cclxuICBsYXVuY2hNb2RhbDogZnVuY3Rpb24obGFiZWwsIHZhbHVlLCByZWFzb24sIGlzVW5kbywgY2FsbGJhY2tPblNhdmUsIGNhbGxiYWNrT25DYW5jZWwsIGNhbGxiYWNrT25VbmRvKSB7XHJcbiAgICB2YXIgcmVhc29ucyA9IFt7XHJcbiAgICAgIFwicmVhc29uXCI6IFwiQWxyZWFkeSBkb25lIHRoaXNcIixcclxuICAgICAgXCJ2YWx1ZVwiOiBcImRvbmVcIlxyXG4gICAgfSwge1xyXG4gICAgICBcInJlYXNvblwiOiBcIldvdWxkbid0IHdvcmtcIixcclxuICAgICAgXCJ2YWx1ZVwiOiBcIm5vd29ya1wiXHJcbiAgICB9LCB7XHJcbiAgICAgIFwicmVhc29uXCI6IFwiU29tZXRoaW5nIGVsc2VcIixcclxuICAgICAgXCJ2YWx1ZVwiOiBcImVsc2VcIlxyXG4gICAgfV07XHJcbiAgICBpZiAocmVhc29uICYmIHJlYXNvbi5yZWFzb24pIHtcclxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZWFzb25zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgaWYgKHJlYXNvbnNbaV0ucmVhc29uID09PSByZWFzb24ucmVhc29uKSB7XHJcbiAgICAgICAgICByZWFzb25zW2ldLmNoZWNrZWQgPSB0cnVlO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBiYXNlLmxhdW5jaE1vZGFsKHtcclxuICAgICAgXCJoZWFkZXJcIjogXCJEaXNhZ3JlZSB3aXRoIGEgc3VnZ2VzdGVkIGFjdGlvblwiLFxyXG4gICAgICBcImlzVW5kb1wiOiBpc1VuZG8sXHJcbiAgICAgIFwiaXRlbVwiOiB2YWx1ZSxcclxuICAgICAgXCJwbGFjZWhvbGRlclwiOiBcIlByb3ZpZGUgbW9yZSBpbmZvcm1hdGlvbiBoZXJlLi4uXCIsXHJcbiAgICAgIFwicmVhc29uc1wiOiByZWFzb25zXHJcbiAgICB9LCBsYWJlbCwgdmFsdWUsIHJlYXNvbiA/IHJlYXNvbi5yZWFzb25UZXh0IDogbnVsbCwgY2FsbGJhY2tPblNhdmUsIGNhbGxiYWNrT25DYW5jZWwsIGNhbGxiYWNrT25VbmRvKTtcclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBpYXA7XHJcbiIsInZhciBIaWdoY2hhcnRzID0gcmVxdWlyZSgnaGlnaGNoYXJ0cy9oaWdoc3RvY2snKSxcclxuICBiYXNlID0gcmVxdWlyZSgnLi4vYmFzZS5qcycpO1xyXG5yZXF1aXJlKCdoaWdoY2hhcnRzL2hpZ2hjaGFydHMtbW9yZScpKEhpZ2hjaGFydHMpO1xyXG5cclxudmFyIElEID0gXCJMSUZFTElORVwiO1xyXG5cclxudmFyIGNvbG91ciA9IHtcclxuICBpbmRleDogMCxcclxuICBuZXh0OiBmdW5jdGlvbigpIHtcclxuICAgIGlmICh0aGlzLmluZGV4ID49IEhpZ2hjaGFydHMuZ2V0T3B0aW9ucygpLmNvbG9ycy5sZW5ndGgpIHRoaXMuaW5kZXggPSAwO1xyXG4gICAgcmV0dXJuIEhpZ2hjaGFydHMuZ2V0T3B0aW9ucygpLmNvbG9yc1t0aGlzLmluZGV4KytdO1xyXG4gIH0sXHJcbiAgcmVzZXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgdGhpcy5pbmRleCA9IDA7XHJcbiAgfVxyXG59O1xyXG5cclxudmFyIGxsID0ge1xyXG4gIGNoYXJ0QXJyYXk6IFtdLFxyXG5cclxuICBkZXN0cm95OiBmdW5jdGlvbihlbGVtZW50SWQpIHtcclxuICAgICQoZWxlbWVudElkKS5odG1sKCcnKTtcclxuICAgICQoZWxlbWVudElkKS5vZmYoJ21vdXNlbW92ZSB0b3VjaG1vdmUgdG91Y2hzdGFydCcsICcuc3luYy1jaGFydCcpO1xyXG5cclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgSGlnaGNoYXJ0cy5jaGFydHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgaWYgKEhpZ2hjaGFydHMuY2hhcnRzW2ldICYmIEhpZ2hjaGFydHMuY2hhcnRzW2ldLnJlbmRlclRvLmNsYXNzTmFtZS5pbmRleE9mKFwiaC1jaGFydFwiKSA+IC0xKSBIaWdoY2hhcnRzLmNoYXJ0c1tpXS5kZXN0cm95KCk7XHJcbiAgICB9XHJcbiAgfSxcclxuXHJcbiAgc2hvdzogZnVuY3Rpb24ocGFuZWwsIGlzQXBwZW5kLCBwYXRpZW50SWQsIGRhdGEpIHtcclxuXHJcbiAgICB2YXIgZWxlbWVudCA9ICdsaWZlbGluZS1jaGFydCc7XHJcbiAgICB2YXIgZWxlbWVudElkID0gJyMnICsgZWxlbWVudDtcclxuXHJcbiAgICBsbC5kZXN0cm95KGVsZW1lbnRJZCk7XHJcblxyXG4gICAgdmFyIGh0bWxFbGVtZW50ID0gJCgnPGRpdiBjbGFzcz1cInBhbmVsIHBhbmVsLWRlZmF1bHRcIj48ZGl2IGNsYXNzPVwicGFuZWwtYm9keVwiPjxkaXYgaWQ9XCInICsgZWxlbWVudCArICdcIj48L2Rpdj48L2Rpdj48L2Rpdj4nKTtcclxuXHJcbiAgICBpZiAoaXNBcHBlbmQpIHBhbmVsLmFwcGVuZChodG1sRWxlbWVudCk7XHJcbiAgICBlbHNlIHBhbmVsLmh0bWwoaHRtbEVsZW1lbnQpO1xyXG5cclxuICAgIGNvbG91ci5yZXNldCgpO1xyXG4gICAgLyoqXHJcbiAgICAgKiBJbiBvcmRlciB0byBzeW5jaHJvbml6ZSB0b29sdGlwcyBhbmQgY3Jvc3NoYWlycywgb3ZlcnJpZGUgdGhlXHJcbiAgICAgKiBidWlsdC1pbiBldmVudHMgd2l0aCBoYW5kbGVycyBkZWZpbmVkIG9uIHRoZSBwYXJlbnQgZWxlbWVudC5cclxuICAgICAqL1xyXG5cclxuICAgICQoZWxlbWVudElkKS5vbignbW91c2Vtb3ZlIHRvdWNobW92ZSB0b3VjaHN0YXJ0JywgJy5zeW5jLWNoYXJ0JywgZnVuY3Rpb24oZSkge1xyXG4gICAgICB2YXIgY2hhcnQsIHBvaW50LCBpLCBldmVudCwgc2VyaWVzO1xyXG5cclxuICAgICAgZm9yIChpID0gMTsgaSA8IGxsLmNoYXJ0QXJyYXkubGVuZ3RoIC0gMjsgaSA9IGkgKyAxKSB7XHJcbiAgICAgICAgY2hhcnQgPSBsbC5jaGFydEFycmF5W2ldO1xyXG4gICAgICAgIGV2ZW50ID0gY2hhcnQucG9pbnRlci5ub3JtYWxpemUoZS5vcmlnaW5hbEV2ZW50KTsgLy8gRmluZCBjb29yZGluYXRlcyB3aXRoaW4gdGhlIGNoYXJ0XHJcbiAgICAgICAgLy9pZiAoaSA9PT0gMCkgY29uc29sZS5sb2coZXZlbnQuY2hhcnRYICsgXCIgLS0tIFwiICsgZXZlbnQuY2hhcnRZKTtcclxuICAgICAgICBzZXJpZXMgPSBpID09PSAwID8gTWF0aC5tYXgoTWF0aC5taW4oTWF0aC5mbG9vcigoMTMwIC0gZXZlbnQuY2hhcnRZKSAvIDM0KSwgY2hhcnQuc2VyaWVzLmxlbmd0aCAtIDEpLCAwKSA6IDA7XHJcbiAgICAgICAgcG9pbnQgPSBjaGFydC5zZXJpZXNbc2VyaWVzXS5zZWFyY2hQb2ludChldmVudCwgdHJ1ZSk7IC8vIEdldCB0aGUgaG92ZXJlZCBwb2ludFxyXG5cclxuICAgICAgICBpZiAocG9pbnQpIHtcclxuICAgICAgICAgIHBvaW50Lm9uTW91c2VPdmVyKCk7IC8vIFNob3cgdGhlIGhvdmVyIG1hcmtlclxyXG4gICAgICAgICAgY2hhcnQudG9vbHRpcC5yZWZyZXNoKHBvaW50KTsgLy8gU2hvdyB0aGUgdG9vbHRpcFxyXG4gICAgICAgICAgY2hhcnQueEF4aXNbMF0uZHJhd0Nyb3NzaGFpcihldmVudCwgcG9pbnQpOyAvLyBTaG93IHRoZSBjcm9zc2hhaXJcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogU3luY2hyb25pemUgem9vbWluZyB0aHJvdWdoIHRoZSBzZXRFeHRyZW1lcyBldmVudCBoYW5kbGVyLlxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBzeW5jRXh0cmVtZXMoZSkge1xyXG4gICAgICB2YXIgdGhpc0NoYXJ0ID0gdGhpcy5jaGFydDtcclxuXHJcbiAgICAgIGlmIChlLnRyaWdnZXIgIT09ICdzeW5jRXh0cmVtZXMnKSB7IC8vIFByZXZlbnQgZmVlZGJhY2sgbG9vcFxyXG4gICAgICAgIEhpZ2hjaGFydHMuZWFjaChsbC5jaGFydEFycmF5LCBmdW5jdGlvbihjaGFydCkge1xyXG4gICAgICAgICAgaWYgKGNoYXJ0ICE9PSB0aGlzQ2hhcnQpIHtcclxuICAgICAgICAgICAgaWYgKGNoYXJ0LmludmVydGVkKSB7XHJcbiAgICAgICAgICAgICAgaWYgKGNoYXJ0LnlBeGlzWzBdLnNldEV4dHJlbWVzKSB7IC8vIEl0IGlzIG51bGwgd2hpbGUgdXBkYXRpbmdcclxuICAgICAgICAgICAgICAgIGNoYXJ0LnlBeGlzWzBdLnNldEV4dHJlbWVzKGUubWluLCBlLm1heCwgdW5kZWZpbmVkLCBmYWxzZSwge1xyXG4gICAgICAgICAgICAgICAgICB0cmlnZ2VyOiAnc3luY0V4dHJlbWVzJ1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIGlmIChjaGFydC54QXhpc1swXS5zZXRFeHRyZW1lcykgeyAvLyBJdCBpcyBudWxsIHdoaWxlIHVwZGF0aW5nXHJcbiAgICAgICAgICAgICAgICBjaGFydC54QXhpc1swXS5zZXRFeHRyZW1lcyhlLm1pbiwgZS5tYXgsIHVuZGVmaW5lZCwgZmFsc2UsIHtcclxuICAgICAgICAgICAgICAgICAgdHJpZ2dlcjogJ3N5bmNFeHRyZW1lcydcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHZhciBwbG90Q29uZGl0aW9ucyA9IGZ1bmN0aW9uKGNvbmRpdGlvbnMsIGltcG9ydGFudENvZGVzLCBjb250YWN0cykge1xyXG4gICAgICBsbC5jaGFydHMgPSAxO1xyXG4gICAgICB2YXIgc2VyaWVzID0gW107XHJcbiAgICAgICQuZWFjaChjb25kaXRpb25zLnJldmVyc2UoKSwgZnVuY3Rpb24oaSwgdGFzaykge1xyXG4gICAgICAgIHZhciBpdGVtID0ge1xyXG4gICAgICAgICAgbmFtZTogdGFzay5uYW1lLFxyXG4gICAgICAgICAgZGF0YTogW10sXHJcbiAgICAgICAgICBjb2xvcjogY29sb3VyLm5leHQoKVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgJC5lYWNoKHRhc2suaW50ZXJ2YWxzLCBmdW5jdGlvbihqLCBpbnRlcnZhbCkge1xyXG4gICAgICAgICAgaXRlbS5kYXRhLnB1c2goW2kgKyAwLjQ5LCBpbnRlcnZhbC5mcm9tLCBpbnRlcnZhbC50b10pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBzZXJpZXMucHVzaChpdGVtKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICB2YXIgbWFya2VyVGVtcGxhdGUgPSB7IFwibGluZVdpZHRoXCI6IDEsIFwibGluZUNvbG9yXCI6IFwiYmxhY2tcIiwgXCJyYWRpdXNcIjogOCB9O1xyXG4gICAgICB2YXIgbWFya2VycyA9IHtcclxuICAgICAgICBcImRlZmF1bHRcIjogJC5leHRlbmQoeyBcInN5bWJvbFwiOiBcInRyaWFuZ2xlXCIgfSwgbWFya2VyVGVtcGxhdGUpLFxyXG4gICAgICAgIFwiRmFjZSB0byBmYWNlXCI6ICQuZXh0ZW5kKHsgXCJzeW1ib2xcIjogXCJzcXVhcmVcIiB9LCBtYXJrZXJUZW1wbGF0ZSksXHJcbiAgICAgICAgXCJUZWxlcGhvbmVcIjogJC5leHRlbmQoeyBcInN5bWJvbFwiOiBcImNpcmNsZVwiIH0sIG1hcmtlclRlbXBsYXRlKSxcclxuICAgICAgICBcIkhvc3BpdGFsIGFkbWlzc2lvblwiOiAkLmV4dGVuZCh7IFwic3ltYm9sXCI6IFwidHJpYW5nbGVcIiB9LCBtYXJrZXJUZW1wbGF0ZSlcclxuICAgICAgfTtcclxuICAgICAgdmFyIGNvbnRhY3RTZXJpZXMgPSB7fTtcclxuICAgICAgdmFyIGV2ZW50U2VyaWVzID0ge307XHJcbiAgICAgICQuZWFjaChjb250YWN0cywgZnVuY3Rpb24oaSwgY29udGFjdCkge1xyXG4gICAgICAgIGlmICghY29udGFjdFNlcmllc1tjb250YWN0Lm5hbWVdKSB7XHJcbiAgICAgICAgICBjb250YWN0U2VyaWVzW2NvbnRhY3QubmFtZV0gPSBIaWdoY2hhcnRzLmV4dGVuZChjb250YWN0LCB7XHJcbiAgICAgICAgICAgIGRhdGE6IFtdLFxyXG4gICAgICAgICAgICB0eXBlOiAnc2NhdHRlcicsXHJcbiAgICAgICAgICAgIG1hcmtlcjogbWFya2Vyc1tjb250YWN0Lm5hbWVdIHx8IG1hcmtlcnMuZGVmYXVsdCxcclxuICAgICAgICAgICAgY29sb3I6IGNvbG91ci5uZXh0KClcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb250YWN0U2VyaWVzW2NvbnRhY3QubmFtZV0uZGF0YS5wdXNoKFtcclxuICAgICAgICAgICAgICBjb250YWN0LnRhc2ssXHJcbiAgICAgICAgICAgICAgY29udGFjdC50aW1lXHJcbiAgICAgICAgICBdKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICAkLmVhY2goaW1wb3J0YW50Q29kZXMsIGZ1bmN0aW9uKGksIGV2ZW50KSB7XHJcbiAgICAgICAgaWYgKCFldmVudFNlcmllc1tldmVudC5uYW1lXSkge1xyXG4gICAgICAgICAgZXZlbnRTZXJpZXNbZXZlbnQubmFtZV0gPSBIaWdoY2hhcnRzLmV4dGVuZChldmVudCwge1xyXG4gICAgICAgICAgICBkYXRhOiBbXSxcclxuICAgICAgICAgICAgdHlwZTogJ3NjYXR0ZXInLFxyXG4gICAgICAgICAgICBtYXJrZXI6IG1hcmtlcnNbZXZlbnQubmFtZV0gfHwgbWFya2Vycy5kZWZhdWx0LFxyXG4gICAgICAgICAgICBjb2xvcjogY29sb3VyLm5leHQoKVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGV2ZW50U2VyaWVzW2V2ZW50Lm5hbWVdLmRhdGEucHVzaChbXHJcbiAgICAgICAgICAgICAgZXZlbnQudGFzayxcclxuICAgICAgICAgICAgICBldmVudC50aW1lXHJcbiAgICAgICAgICBdKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBzZXJpZXMgPSBzZXJpZXMuY29uY2F0KE9iamVjdC5rZXlzKGNvbnRhY3RTZXJpZXMpLm1hcChmdW5jdGlvbihrZXkpIHtcclxuICAgICAgICByZXR1cm4gY29udGFjdFNlcmllc1trZXldO1xyXG4gICAgICB9KSk7XHJcblxyXG4gICAgICBzZXJpZXMgPSBzZXJpZXMuY29uY2F0KE9iamVjdC5rZXlzKGV2ZW50U2VyaWVzKS5tYXAoZnVuY3Rpb24oa2V5KSB7XHJcbiAgICAgICAgcmV0dXJuIGV2ZW50U2VyaWVzW2tleV07XHJcbiAgICAgIH0pKTtcclxuXHJcbiAgICAgICQoZWxlbWVudElkKS5hcHBlbmQoJCgnPGRpdiBjbGFzcz1cImNoYXJ0LXRpdGxlXCI+UGF0aWVudCBjb25kaXRpb25zIGFuZCBjb250YWN0czwvZGl2PicpKTtcclxuICAgICAgLy8gY3JlYXRlIHRoZSBjaGFydFxyXG4gICAgICAkKCc8ZGl2IGNsYXNzPVwiaC1jaGFydCBoLWNvbmRpdGlvbi1jaGFydFwiPicpXHJcbiAgICAgICAgLmFwcGVuZFRvKGVsZW1lbnRJZClcclxuICAgICAgICAuaGlnaGNoYXJ0cyh7XHJcblxyXG4gICAgICAgICAgY2hhcnQ6IHtcclxuICAgICAgICAgICAgcmVuZGVyVG86IGVsZW1lbnQsXHJcbiAgICAgICAgICAgIG1hcmdpbkxlZnQ6IDEyMCwgLy8gS2VlcCBhbGwgY2hhcnRzIGxlZnQgYWxpZ25lZFxyXG4gICAgICAgICAgICBzcGFjaW5nVG9wOiAyMCxcclxuICAgICAgICAgICAgc3BhY2luZ0JvdHRvbTogMjAsXHJcbiAgICAgICAgICAgIHR5cGU6ICdjb2x1bW5yYW5nZScsXHJcbiAgICAgICAgICAgIGludmVydGVkOiB0cnVlLFxyXG4gICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6ICcjRjlGM0Y5JyxcclxuICAgICAgICAgICAgYm9yZGVyV2lkdGg6IDIsXHJcbiAgICAgICAgICAgIGJvcmRlckNvbG9yOiAnI2RkZCdcclxuICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgdGl0bGU6ICcnLFxyXG5cclxuICAgICAgICAgIHlBeGlzOiB7XHJcbiAgICAgICAgICAgIHR5cGU6ICdkYXRldGltZScsXHJcbiAgICAgICAgICAgIG1pbjogRGF0ZS5VVEMoMjAwNSwgNiwgMTIpLFxyXG4gICAgICAgICAgICBtYXg6IG5ldyBEYXRlKCkuZ2V0VGltZSgpLFxyXG4gICAgICAgICAgICBjcm9zc2hhaXI6IHRydWUsXHJcbiAgICAgICAgICAgIGV2ZW50czoge1xyXG4gICAgICAgICAgICAgIHNldEV4dHJlbWVzOiBzeW5jRXh0cmVtZXNcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbGFiZWxzOiB7XHJcbiAgICAgICAgICAgICAgZW5hYmxlZDogZmFsc2VcclxuICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgIC8vdGhpbmdzIHRoYXQgYXJlIG5vcm1hbGx5IHhBeGlzIGRlZmF1bHRzXHJcbiAgICAgICAgICAgIGVuZE9uVGljazogZmFsc2UsXHJcbiAgICAgICAgICAgIGdyaWRMaW5lV2lkdGg6IDAsXHJcbiAgICAgICAgICAgIGxpbmVXaWR0aDogMSxcclxuICAgICAgICAgICAgbWF4UGFkZGluZzogMC4wMSxcclxuICAgICAgICAgICAgbWluUGFkZGluZzogMC4wMSxcclxuICAgICAgICAgICAgc3RhcnRPblRpY2s6IGZhbHNlLFxyXG4gICAgICAgICAgICB0aWNrV2lkdGg6IDAsXHJcbiAgICAgICAgICAgIHRpdGxlOiB7XHJcbiAgICAgICAgICAgICAgdGV4dDogJydcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdGlja1BpeGVsSW50ZXJ2YWw6IDEwMFxyXG4gICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICB4QXhpczoge1xyXG4gICAgICAgICAgICBsYWJlbHM6IHtcclxuICAgICAgICAgICAgICBlbmFibGVkOiBmYWxzZVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBzdGFydE9uVGljazogZmFsc2UsXHJcbiAgICAgICAgICAgIGVuZE9uVGljazogZmFsc2UsXHJcbiAgICAgICAgICAgIHRpdGxlOiB7XHJcbiAgICAgICAgICAgICAgdGV4dDogJydcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdGlja1dpZHRoOiAwLFxyXG4gICAgICAgICAgICBtaW5QYWRkaW5nOiAwLjIsXHJcbiAgICAgICAgICAgIG1heFBhZGRpbmc6IDAuMixcclxuXHJcbiAgICAgICAgICAgIC8vdGhpbmdzIHRoYXQgYXJlIG5vcm1hbGx5IHlBeGlzIGRlZmF1bHRzXHJcbiAgICAgICAgICAgIGdyaWRMaW5lV2lkdGg6IDAsXHJcbiAgICAgICAgICAgIGxpbmVXaWR0aDogMFxyXG5cclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBjcmVkaXRzOiB7XHJcbiAgICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlXHJcbiAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgIGxlZ2VuZDoge1xyXG4gICAgICAgICAgICBlbmFibGVkOiBmYWxzZVxyXG4gICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICB0b29sdGlwOiB7XHJcbiAgICAgICAgICAgIGZvcm1hdHRlcjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgaWYgKHRoaXMuc2VyaWVzLmRhdGFbMF0ueCAhPT0gMSAmJiB0aGlzLnNlcmllcy5kYXRhWzBdLnggIT09IDIpIHtcclxuICAgICAgICAgICAgICAgIC8vUmFuZ2UgZXJnbyBjb25kaXRpb25cclxuICAgICAgICAgICAgICAgIHZhciB5Q29vcmQgPSB0aGlzLnk7XHJcbiAgICAgICAgICAgICAgICB2YXIgbGFiZWxUbXAgPSBjb25kaXRpb25zW01hdGguZmxvb3IodGhpcy54KV0uaW50ZXJ2YWxzLmZpbHRlcihmdW5jdGlvbih2KSB7XHJcbiAgICAgICAgICAgICAgICAgIHJldHVybiB5Q29vcmQgPj0gdi5mcm9tICYmIHlDb29yZCA8PSB2LnRvO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgbGFiZWwgPSBsYWJlbFRtcC5sZW5ndGggPiAwID8gbGFiZWxUbXBbMF0ubGFiZWwgOiBcIk5vIGxhYmVsIEFcIjtcclxuICAgICAgICAgICAgICAgIHJldHVybiAnPGI+JyArIGNvbmRpdGlvbnNbTWF0aC5mbG9vcih0aGlzLngpXS5uYW1lICsgKGxhYmVsID8gJzogJyArIGxhYmVsIDogJycpICsgJzwvYj48YnIvPicgK1xyXG4gICAgICAgICAgICAgICAgICBIaWdoY2hhcnRzLmRhdGVGb3JtYXQoJyVkLyVtLyVZJywgdGhpcy5wb2ludC5vcHRpb25zLmxvdykgK1xyXG4gICAgICAgICAgICAgICAgICAnIC0gJyArIEhpZ2hjaGFydHMuZGF0ZUZvcm1hdCgnJWQvJW0vJVknLCB0aGlzLnBvaW50Lm9wdGlvbnMuaGlnaCk7XHJcbiAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vU2luZ2xlIHZhbHVlIGhlbmNlIGNvbnRhY3RcclxuICAgICAgICAgICAgICAgIHZhciB0aW1lID0gdGhpcy55O1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICh0aGlzLnNlcmllcy5kYXRhWzBdLnggPT09IDEgPyBpbXBvcnRhbnRDb2RlcyA6IGNvbnRhY3RzKS5maWx0ZXIoZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgICAgICAgICAgICAgIHJldHVybiB2YWwuZGF0YSAmJiB2YWwuZGF0YS5maWx0ZXIoZnVuY3Rpb24odikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB2WzFdID09PSB0aW1lO1xyXG4gICAgICAgICAgICAgICAgICB9KS5sZW5ndGggPiAwO1xyXG4gICAgICAgICAgICAgICAgfSkubWFwKGZ1bmN0aW9uKHZhbCkge1xyXG4gICAgICAgICAgICAgICAgICByZXR1cm4gJzxiPicgKyB2YWwubmFtZSArICc8L2I+PGJyLz4nICsgSGlnaGNoYXJ0cy5kYXRlRm9ybWF0KCclZC8lbS8lWScsIHRpbWUpO1xyXG4gICAgICAgICAgICAgICAgfSkuam9pbignPGJyLz4nKTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGZvbGxvd1BvaW50ZXI6IHRydWVcclxuICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgcGxvdE9wdGlvbnM6IHtcclxuICAgICAgICAgICAgY29sdW1ucmFuZ2U6IHtcclxuICAgICAgICAgICAgICBncm91cGluZzogZmFsc2UsXHJcbiAgICAgICAgICAgICAgLypncm91cFBhZGRpbmc6IDAuMywqL1xyXG4gICAgICAgICAgICAgIGRhdGFMYWJlbHM6IHtcclxuICAgICAgICAgICAgICAgIGFsbG93T3ZlcmxhcDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGVuYWJsZWQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBmb3JtYXR0ZXI6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICB2YXIgeUNvb3JkID0gdGhpcy55O1xyXG4gICAgICAgICAgICAgICAgICB2YXIgaWR4ID0gLTE7XHJcbiAgICAgICAgICAgICAgICAgIHZhciBsYWJlbFRtcCA9IGNvbmRpdGlvbnNbTWF0aC5mbG9vcih0aGlzLngpXS5pbnRlcnZhbHMuZmlsdGVyKGZ1bmN0aW9uKHYsIGkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoeUNvb3JkID49IHYuZnJvbSAmJiB5Q29vcmQgPD0gdi50bykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgaWR4ID0gaTtcclxuICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICB2YXIgbGFiZWwgPSBsYWJlbFRtcC5sZW5ndGggPiAwID8gbGFiZWxUbXBbMF0ubGFiZWwgOiBcIk5vIGxhYmVsIEJcIjtcclxuICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMueSA9PT0gdGhpcy5wb2ludC5sb3cgJiZcclxuICAgICAgICAgICAgICAgICAgICAoY29uZGl0aW9uc1tNYXRoLmZsb29yKHRoaXMueCldLmludGVydmFscy5sZW5ndGggLSAxID09PSBpZHggfHxcclxuICAgICAgICAgICAgICAgICAgICAgICh0aGlzLnNlcmllcy5jaGFydC55QXhpc1swXS5taW4gPD0geUNvb3JkICYmIHRoaXMuc2VyaWVzLmNoYXJ0LnlBeGlzWzBdLm1heCA+PSB5Q29vcmQpIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAodGhpcy5zZXJpZXMuY2hhcnQueUF4aXNbMF0ubWluID49IHRoaXMucG9pbnQubG93ICYmIHRoaXMuc2VyaWVzLmNoYXJ0LnlBeGlzWzBdLm1heCA8PSB0aGlzLnBvaW50LmhpZ2gpKSA/IGNvbmRpdGlvbnNbTWF0aC5mbG9vcih0aGlzLngpXS5uYW1lICsgKGxhYmVsID8gJzogJyArIGxhYmVsIDogJycpIDogJyc7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgIHNlcmllczogc2VyaWVzXHJcblxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgcGxvdE1lYXN1cmVtZW50cyA9IGZ1bmN0aW9uKG1lYXN1cmVtZW50cykge1xyXG4gICAgICAkKGVsZW1lbnRJZCkuYXBwZW5kKCQoJzxkaXYgY2xhc3M9XCJjaGFydC10aXRsZVwiPlBhdGllbnQgbWVhc3VyZW1lbnRzPC9kaXY+JykpO1xyXG4gICAgICAkLmVhY2gobWVhc3VyZW1lbnRzLCBmdW5jdGlvbihpLCBkYXRhc2V0KSB7XHJcbiAgICAgICAgbGwuY2hhcnRzKys7XHJcbiAgICAgICAgLy8gQWRkIFggdmFsdWVzXHJcbiAgICAgICAgLyppZiAoZGF0YXNldC5kYXRhICYmIHR5cGVvZiBkYXRhc2V0LmRhdGFbMF0gIT09IFwib2JqZWN0XCIpIHtcclxuICAgICAgICAgIGRhdGFzZXQuZGF0YSA9IEhpZ2hjaGFydHMubWFwKGRhdGFzZXQuZGF0YSwgZnVuY3Rpb24odmFsLCBqKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBbbWVhc3VyZW1lbnRzLnhEYXRhW2pdLCB2YWxdO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSovXHJcblxyXG4gICAgICAgIHZhciBjaGFydE9wdGlvbnMgPSB7XHJcbiAgICAgICAgICBjaGFydDoge1xyXG4gICAgICAgICAgICBtYXJnaW5MZWZ0OiAxMjAsIC8vIEtlZXAgYWxsIGNoYXJ0cyBsZWZ0IGFsaWduZWRcclxuICAgICAgICAgICAgc3BhY2luZ1RvcDogMCxcclxuICAgICAgICAgICAgc3BhY2luZ0JvdHRvbTogOCxcclxuICAgICAgICAgICAgYmFja2dyb3VuZENvbG9yOiAnI0Y5RjlGMycsXHJcbiAgICAgICAgICAgIGJvcmRlcldpZHRoOiAyLFxyXG4gICAgICAgICAgICBib3JkZXJDb2xvcjogJyNkZGQnXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgdGl0bGU6IHtcclxuICAgICAgICAgICAgdGV4dDogJycsXHJcbiAgICAgICAgICAgIGFsaWduOiAnbGVmdCcsXHJcbiAgICAgICAgICAgIG1hcmdpbjogMCxcclxuICAgICAgICAgICAgeDogMzBcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBtYXJrZXI6IHtcclxuICAgICAgICAgICAgZW5hYmxlZDogdHJ1ZVxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIGNyZWRpdHM6IHtcclxuICAgICAgICAgICAgZW5hYmxlZDogZmFsc2VcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBsZWdlbmQ6IHtcclxuICAgICAgICAgICAgZW5hYmxlZDogZmFsc2VcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICB4QXhpczoge1xyXG4gICAgICAgICAgICB0eXBlOiAnZGF0ZXRpbWUnLFxyXG4gICAgICAgICAgICBtaW46IERhdGUuVVRDKDIwMDUsIDYsIDEyKSxcclxuICAgICAgICAgICAgbWF4OiBuZXcgRGF0ZSgpLmdldFRpbWUoKSxcclxuICAgICAgICAgICAgY3Jvc3NoYWlyOiB7XHJcbiAgICAgICAgICAgICAgc25hcDogZmFsc2VcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZXZlbnRzOiB7XHJcbiAgICAgICAgICAgICAgc2V0RXh0cmVtZXM6IHN5bmNFeHRyZW1lc1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBsYWJlbHM6IHtcclxuICAgICAgICAgICAgICBlbmFibGVkOiBmYWxzZVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBsaW5lV2lkdGg6IDAsXHJcbiAgICAgICAgICAgIG1pbm9yR3JpZExpbmVXaWR0aDogMCxcclxuICAgICAgICAgICAgbGluZUNvbG9yOiAndHJhbnNwYXJlbnQnLFxyXG4gICAgICAgICAgICBtaW5vclRpY2tMZW5ndGg6IDAsXHJcbiAgICAgICAgICAgIHRpY2tMZW5ndGg6IDBcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICB5QXhpczoge1xyXG4gICAgICAgICAgICB0aXRsZToge1xyXG4gICAgICAgICAgICAgIHRleHQ6IGRhdGFzZXQubmFtZSArIFwiPGJyPlwiICsgZGF0YXNldC51bml0LnJlcGxhY2UoL1xcXihbMC05XSspLywgXCI8c3VwPiQxPC9zdXA+XCIpICsgXCJcIixcclxuICAgICAgICAgICAgICBtYXJnaW46IDYwLFxyXG4gICAgICAgICAgICAgIHJvdGF0aW9uOiAwXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHN0YXJ0T25UaWNrOiBmYWxzZSxcclxuICAgICAgICAgICAgZW5kT25UaWNrOiBmYWxzZSxcclxuICAgICAgICAgICAgbGFiZWxzOiB7XHJcbiAgICAgICAgICAgICAgc3R5bGU6IHtcclxuICAgICAgICAgICAgICAgIFwidGV4dE92ZXJmbG93XCI6IFwibm9uZVwiXHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB0aWNrUGl4ZWxJbnRlcnZhbDogMjUsXHJcbiAgICAgICAgICAgIG1heFBhZGRpbmc6IDAuMSxcclxuICAgICAgICAgICAgbWluUGFkZGluZzogMC4xXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgdG9vbHRpcDoge1xyXG4gICAgICAgICAgICBwb3NpdGlvbmVyOiBmdW5jdGlvbihsYWJlbFdpZHRoLCBsYWJlbEhlaWdodCwgcG9pbnQpIHtcclxuICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgeDogTWF0aC5tYXgoNTAsIHBvaW50LnBsb3RYIC0gbGFiZWxXaWR0aCksIC8vIGxlZnQgYWxpZ25lZFxyXG4gICAgICAgICAgICAgICAgeTogLTEgLy8gYWxpZ24gdG8gdGl0bGVcclxuICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB1c2VIVE1MOiB0cnVlLFxyXG4gICAgICAgICAgICBwb2ludEZvcm1hdDogJzxiPicgKyBkYXRhc2V0Lm5hbWUgKyAnOjwvYj4ge3BvaW50Lnl9ICcgKyBkYXRhc2V0LnVuaXQucmVwbGFjZSgvXFxeKFswLTldKykvLCBcIjxzdXA+JDE8L3N1cD5cIiksXHJcbiAgICAgICAgICAgIHZhbHVlRGVjaW1hbHM6IGRhdGFzZXQudmFsdWVEZWNpbWFsc1xyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHBsb3RPcHRpb25zOiB7XHJcbiAgICAgICAgICAgIHNlcmllczoge1xyXG4gICAgICAgICAgICAgIGV2ZW50czoge1xyXG4gICAgICAgICAgICAgICAgbW91c2VPdXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICB2YXIgY2hhcnQsIGk7XHJcbiAgICAgICAgICAgICAgICAgIGZvciAoaSA9IDE7IGkgPCBsbC5jaGFydEFycmF5Lmxlbmd0aCAtIDI7IGkgPSBpICsgMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYXJ0ID0gbGwuY2hhcnRBcnJheVtpXTtcclxuICAgICAgICAgICAgICAgICAgICBjaGFydC50b29sdGlwLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHNlcmllczogW3tcclxuICAgICAgICAgICAgZGF0YTogZGF0YXNldC5kYXRhLFxyXG4gICAgICAgICAgICBuYW1lOiBkYXRhc2V0Lm5hbWUsXHJcbiAgICAgICAgICAgIHR5cGU6IGRhdGFzZXQudHlwZSxcclxuICAgICAgICAgICAgY29sb3I6IGNvbG91ci5uZXh0KCksXHJcbiAgICAgICAgICAgIGZpbGxPcGFjaXR5OiAwLjNcclxuICAgICAgICAgICAgfV1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBpZiAoZGF0YXNldC5uYW1lID09PSBcIkJQXCIpIHtcclxuICAgICAgICAgIGNoYXJ0T3B0aW9ucy50b29sdGlwLnBvaW50Rm9ybWF0ID0gXCI8Yj5CUDo8L2I+IHtwb2ludC5sb3d9L3twb2ludC5oaWdofSBtbUhnPGJyLz5cIjtcclxuICAgICAgICAgIC8vY2hhcnRPcHRpb25zLnNlcmllc1swXS50b29sdGlwID0ge307XHJcbiAgICAgICAgICBjaGFydE9wdGlvbnMuc2VyaWVzWzBdLnN0ZW1XaWR0aCA9IDM7XHJcbiAgICAgICAgICBjaGFydE9wdGlvbnMuc2VyaWVzWzBdLndoaXNrZXJXaWR0aCA9IDU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvKmlmIChpID09PSAwKSB7XHJcbiAgICAgICAgICBjaGFydE9wdGlvbnMudGl0bGUgPSB7XHJcbiAgICAgICAgICAgIHRleHQ6ICdQYXRpZW50IG1lYXN1cmVtZW50cycsXHJcbiAgICAgICAgICAgIGFsaWduOiAnbGVmdCcsXHJcbiAgICAgICAgICAgIG1hcmdpbjogMSxcclxuICAgICAgICAgICAgc3R5bGU6IHtcclxuICAgICAgICAgICAgICBjb2xvcjogXCIjMzMzMzMzXCIsXHJcbiAgICAgICAgICAgICAgZm9udFNpemU6IFwiMTJweFwiLFxyXG4gICAgICAgICAgICAgIGZvbnRXZWlnaHQ6IFwiYm9sZFwiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH07XHJcbiAgICAgICAgfSovXHJcblxyXG4gICAgICAgIC8qaWYgKGkgPT09IG1lYXN1cmVtZW50cy5kYXRhc2V0cy5sZW5ndGggLSAxKSB7XHJcbiAgICAgICAgICBjaGFydE9wdGlvbnMueEF4aXMgPSB7XHJcbiAgICAgICAgICAgIGNyb3NzaGFpcjogdHJ1ZSxcclxuICAgICAgICAgICAgZXZlbnRzOiB7XHJcbiAgICAgICAgICAgICAgc2V0RXh0cmVtZXM6IHN5bmNFeHRyZW1lc1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB0eXBlOiAnZGF0ZXRpbWUnXHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgIH0qL1xyXG4gICAgICAgICQoJzxkaXYgY2xhc3M9XCJzeW5jLWNoYXJ0IGgtY2hhcnQnICsgKGkgPT09IG1lYXN1cmVtZW50cy5sZW5ndGggLSAxID8gXCIgaC1sYXN0LW1lYXN1cmVtZW50LWNoYXJ0XCIgOiBcIlwiKSArICdcIj4nKVxyXG4gICAgICAgICAgLmFwcGVuZFRvKGVsZW1lbnRJZClcclxuICAgICAgICAgIC5oaWdoY2hhcnRzKGNoYXJ0T3B0aW9ucyk7XHJcblxyXG4gICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIHBsb3ROYXZpZ2F0b3IgPSBmdW5jdGlvbigpIHtcclxuICAgICAgbGwuY2hhcnRzKys7XHJcbiAgICAgIHZhciBjaGFydCA9ICQoJzxkaXYgY2xhc3M9XCJoLWNoYXJ0IGgtbmF2aWdhdG9yLWNoYXJ0XCI+JylcclxuICAgICAgICAuYXBwZW5kVG8oZWxlbWVudElkKVxyXG4gICAgICAgIC5oaWdoY2hhcnRzKHtcclxuXHJcbiAgICAgICAgICBjaGFydDoge1xyXG4gICAgICAgICAgICByZW5kZXJUbzogZWxlbWVudCxcclxuICAgICAgICAgICAgbWFyZ2luTGVmdDogMTIwLCAvLyBLZWVwIGFsbCBjaGFydHMgbGVmdCBhbGlnbmVkXHJcbiAgICAgICAgICAgIHNwYWNpbmdUb3A6IDIwLFxyXG4gICAgICAgICAgICBzcGFjaW5nQm90dG9tOiAyMCxcclxuICAgICAgICAgICAgaWdub3JlSGlkZGVuU2VyaWVzOiBmYWxzZSxcclxuICAgICAgICAgICAgYm9yZGVyV2lkdGg6IDIsXHJcbiAgICAgICAgICAgIGJvcmRlckNvbG9yOiAnI2RkZCdcclxuICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgdGl0bGU6IHtcclxuICAgICAgICAgICAgdGV4dDogJydcclxuICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgeEF4aXM6IHtcclxuICAgICAgICAgICAgdHlwZTogJ2RhdGV0aW1lJyxcclxuICAgICAgICAgICAgbWluOiBEYXRlLlVUQygyMDA1LCA2LCAxMiksXHJcbiAgICAgICAgICAgIG1heDogbmV3IERhdGUoKS5nZXRUaW1lKCksXHJcbiAgICAgICAgICAgIGNyb3NzaGFpcjogZmFsc2UsXHJcbiAgICAgICAgICAgIGV2ZW50czoge1xyXG4gICAgICAgICAgICAgIHNldEV4dHJlbWVzOiBzeW5jRXh0cmVtZXNcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbGFiZWxzOiB7XHJcbiAgICAgICAgICAgICAgZW5hYmxlZDogZmFsc2VcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbGluZVdpZHRoOiAwLFxyXG4gICAgICAgICAgICBtaW5vckdyaWRMaW5lV2lkdGg6IDAsXHJcbiAgICAgICAgICAgIGxpbmVDb2xvcjogJ3RyYW5zcGFyZW50JyxcclxuICAgICAgICAgICAgbWlub3JUaWNrTGVuZ3RoOiAwLFxyXG4gICAgICAgICAgICB0aWNrTGVuZ3RoOiAwXHJcbiAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgIHlBeGlzOiB7XHJcbiAgICAgICAgICAgIG1pbjogMCxcclxuICAgICAgICAgICAgbWF4OiAxLFxyXG4gICAgICAgICAgICB0aWNrSW50ZXJ2YWw6IDEsXHJcbiAgICAgICAgICAgIHN0YXJ0T25UaWNrOiBmYWxzZSxcclxuICAgICAgICAgICAgZW5kT25UaWNrOiBmYWxzZSxcclxuICAgICAgICAgICAgdGl0bGU6IHtcclxuICAgICAgICAgICAgICB0ZXh0OiAnJ1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBtaW5QYWRkaW5nOiAwLjIsXHJcbiAgICAgICAgICAgIG1heFBhZGRpbmc6IDAuMixcclxuICAgICAgICAgICAgbGFiZWxzOiB7XHJcbiAgICAgICAgICAgICAgZW5hYmxlZDogZmFsc2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICBsZWdlbmQ6IHtcclxuICAgICAgICAgICAgZW5hYmxlZDogZmFsc2VcclxuICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgbmF2aWdhdG9yOiB7XHJcbiAgICAgICAgICAgIGVuYWJsZWQ6IHRydWVcclxuICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgcGxvdE9wdGlvbnM6IHtcclxuICAgICAgICAgICAgbGluZToge1xyXG4gICAgICAgICAgICAgIGxpbmVXaWR0aDogMCxcclxuICAgICAgICAgICAgICBtYXJrZXI6IHtcclxuICAgICAgICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlXHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICBkYXRhTGFiZWxzOiB7XHJcbiAgICAgICAgICAgICAgICBlbmFibGVkOiBmYWxzZVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICBzZXJpZXM6IFt7XHJcbiAgICAgICAgICAgIFwibmFtZVwiOiBcIkhUTlwiLFxyXG4gICAgICAgICAgICBcImRhdGFcIjogW3tcclxuICAgICAgICAgICAgICBcInhcIjogMTM3MzU4NzIwMDAwMCxcclxuICAgICAgICAgICAgICBcInlcIjogMCxcclxuICAgICAgICAgICAgICBcImZyb21cIjogMTM3MzU4NzIwMDAwMCxcclxuICAgICAgICAgICAgICBcInRvXCI6IDE0NTk4MTQ0MDAwMDBcclxuICAgICAgICAgICAgICB9XVxyXG4gICAgICAgICAgICB9XVxyXG5cclxuICAgICAgICB9KTtcclxuICAgICAgY2hhcnQuaGlnaGNoYXJ0cygpLnNlcmllc1swXS5oaWRlKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBwbG90TWVkaWNhdGlvbnMgPSBmdW5jdGlvbihtZWRpY2F0aW9ucykge1xyXG4gICAgICBsbC5jaGFydHMrKztcclxuICAgICAgdmFyIHNlcmllcyA9IFtdO1xyXG4gICAgICAkLmVhY2gobWVkaWNhdGlvbnMucmV2ZXJzZSgpLCBmdW5jdGlvbihpLCB0YXNrKSB7XHJcbiAgICAgICAgdmFyIGl0ZW0gPSB7XHJcbiAgICAgICAgICBuYW1lOiB0YXNrLm5hbWUsXHJcbiAgICAgICAgICBkYXRhOiBbXSxcclxuICAgICAgICAgIGNvbG9yOiBjb2xvdXIubmV4dCgpXHJcbiAgICAgICAgfTtcclxuICAgICAgICAkLmVhY2godGFzay5pbnRlcnZhbHMsIGZ1bmN0aW9uKGosIGludGVydmFsKSB7XHJcbiAgICAgICAgICBpdGVtLmRhdGEucHVzaChbaSArIDAuNDksIGludGVydmFsLmZyb20sIGludGVydmFsLnRvXSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHNlcmllcy5wdXNoKGl0ZW0pO1xyXG4gICAgICB9KTtcclxuICAgICAgdmFyIG5vRGF0YSA9IGZhbHNlO1xyXG4gICAgICBpZiAoc2VyaWVzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIHNlcmllcy5wdXNoKHtcclxuICAgICAgICAgIHR5cGU6ICdsaW5lJyxcclxuICAgICAgICAgIG5hbWU6ICdSYW5kb20gZGF0YScsXHJcbiAgICAgICAgICBkYXRhOiBbXVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIG5vRGF0YSA9IHRydWU7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vJChlbGVtZW50SWQpLmFwcGVuZCgkKCc8ZGl2IGNsYXNzPVwiY2hhcnQtdGl0bGVcIicgKyAobm9EYXRhID8gJ3N0eWxlPVwiZGlzcGxheTpub25lXCInIDogJycpICsgJz5QYXRpZW50IG1lZGljYXRpb25zPC9kaXY+JykpO1xyXG4gICAgICAkKGVsZW1lbnRJZCkuYXBwZW5kKCQoJzxkaXYgY2xhc3M9XCJjaGFydC10aXRsZVwiPlBhdGllbnQgbWVkaWNhdGlvbnM8L2Rpdj4nKSk7XHJcbiAgICAgIC8vIGNyZWF0ZSB0aGUgY2hhcnRcclxuICAgICAgLy9yZXR1cm4gJCgnPGRpdiBjbGFzcz1cImgtY2hhcnQgaC1tZWRpY2F0aW9uLWNoYXJ0XCInICsgKG5vRGF0YSA/ICdzdHlsZT1cImRpc3BsYXk6bm9uZVwiJyA6ICcnKSArICc+JylcclxuICAgICAgcmV0dXJuICQoJzxkaXYgY2xhc3M9XCJoLWNoYXJ0IGgtbWVkaWNhdGlvbi1jaGFydFwiPicpXHJcbiAgICAgICAgLmFwcGVuZFRvKGVsZW1lbnRJZClcclxuICAgICAgICAuaGlnaGNoYXJ0cyh7XHJcblxyXG4gICAgICAgICAgY2hhcnQ6IHtcclxuICAgICAgICAgICAgcmVuZGVyVG86IGVsZW1lbnQsXHJcbiAgICAgICAgICAgIG1hcmdpbkxlZnQ6IDEyMCwgLy8gS2VlcCBhbGwgY2hhcnRzIGxlZnQgYWxpZ25lZFxyXG4gICAgICAgICAgICBzcGFjaW5nVG9wOiAyMCxcclxuICAgICAgICAgICAgc3BhY2luZ0JvdHRvbTogMjAsXHJcbiAgICAgICAgICAgIHR5cGU6ICdjb2x1bW5yYW5nZScsXHJcbiAgICAgICAgICAgIGludmVydGVkOiB0cnVlLFxyXG4gICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6ICcjRjNGOUY5J1xyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIGxhbmc6IHtcclxuICAgICAgICAgICAgbm9EYXRhOiBcIk5vIHJlbGV2YW50IG1lZGljYXRpb25zXCJcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBub0RhdGE6IHtcclxuICAgICAgICAgICAgc3R5bGU6IHtcclxuICAgICAgICAgICAgICBmb250V2VpZ2h0OiAnYm9sZCcsXHJcbiAgICAgICAgICAgICAgZm9udFNpemU6ICcxNXB4JyxcclxuICAgICAgICAgICAgICBjb2xvcjogJyMzMDMwMzAnXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgdGl0bGU6ICcnLFxyXG4gICAgICAgICAgLyp7XHJcbiAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiAnUGF0aWVudCBtZWRpY2F0aW9ucycsXHJcbiAgICAgICAgICAgICAgICAgICAgICBhbGlnbjogJ2xlZnQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgbWFyZ2luOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgc3R5bGU6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IFwiIzMzMzMzM1wiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb250U2l6ZTogXCIxMnB4XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvbnRXZWlnaHQ6IFwiYm9sZFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSwqL1xyXG5cclxuXHJcbiAgICAgICAgICB5QXhpczoge1xyXG4gICAgICAgICAgICB0eXBlOiAnZGF0ZXRpbWUnLFxyXG4gICAgICAgICAgICBtaW46IERhdGUuVVRDKDIwMDUsIDYsIDEyKSxcclxuICAgICAgICAgICAgbWF4OiBuZXcgRGF0ZSgpLmdldFRpbWUoKSxcclxuICAgICAgICAgICAgY3Jvc3NoYWlyOiB7XHJcbiAgICAgICAgICAgICAgc25hcDogZmFsc2VcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZXZlbnRzOiB7XHJcbiAgICAgICAgICAgICAgc2V0RXh0cmVtZXM6IHN5bmNFeHRyZW1lc1xyXG4gICAgICAgICAgICB9LFxyXG5cclxuXHJcblxyXG4gICAgICAgICAgICAvL3RoaW5ncyB0aGF0IGFyZSBub3JtYWxseSB4QXhpcyBkZWZhdWx0c1xyXG4gICAgICAgICAgICBlbmRPblRpY2s6IGZhbHNlLFxyXG4gICAgICAgICAgICBncmlkTGluZVdpZHRoOiAwLFxyXG4gICAgICAgICAgICBsaW5lV2lkdGg6IDEsXHJcbiAgICAgICAgICAgIG1heFBhZGRpbmc6IDAuMDEsXHJcbiAgICAgICAgICAgIG1pblBhZGRpbmc6IDAuMDEsXHJcbiAgICAgICAgICAgIHN0YXJ0T25UaWNrOiBmYWxzZSxcclxuICAgICAgICAgICAgdGlja1dpZHRoOiAxLFxyXG4gICAgICAgICAgICB0aXRsZToge1xyXG4gICAgICAgICAgICAgIHRleHQ6ICcnXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHRpY2tQaXhlbEludGVydmFsOiAxMDBcclxuICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgeEF4aXM6IHtcclxuICAgICAgICAgICAgbGFiZWxzOiB7XHJcbiAgICAgICAgICAgICAgZW5hYmxlZDogZmFsc2VcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc3RhcnRPblRpY2s6IGZhbHNlLFxyXG4gICAgICAgICAgICBlbmRPblRpY2s6IGZhbHNlLFxyXG4gICAgICAgICAgICB0aXRsZToge1xyXG4gICAgICAgICAgICAgIHRleHQ6ICcnXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHRpY2tXaWR0aDogMCxcclxuICAgICAgICAgICAgbWluUGFkZGluZzogMC4yLFxyXG4gICAgICAgICAgICBtYXhQYWRkaW5nOiAwLjIsXHJcblxyXG4gICAgICAgICAgICAvL3RoaW5ncyB0aGF0IGFyZSBub3JtYWxseSB5QXhpcyBkZWZhdWx0c1xyXG4gICAgICAgICAgICBncmlkTGluZVdpZHRoOiAwLFxyXG4gICAgICAgICAgICBsaW5lV2lkdGg6IDBcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBjcmVkaXRzOiB7XHJcbiAgICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlXHJcbiAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgIGxlZ2VuZDoge1xyXG4gICAgICAgICAgICBlbmFibGVkOiBmYWxzZVxyXG4gICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICB0b29sdGlwOiB7XHJcbiAgICAgICAgICAgIGZvcm1hdHRlcjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgdmFyIHlDb29yZCA9IHRoaXMueTtcclxuICAgICAgICAgICAgICB2YXIgbGFiZWxUbXAgPSBtZWRpY2F0aW9uc1tNYXRoLmZsb29yKHRoaXMueCldLmludGVydmFscy5maWx0ZXIoZnVuY3Rpb24odikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHlDb29yZCA+PSB2LmZyb20gJiYgeUNvb3JkIDw9IHYudG87XHJcbiAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgdmFyIGxhYmVsID0gbGFiZWxUbXAubGVuZ3RoID4gMCA/IGxhYmVsVG1wWzBdLmxhYmVsIDogXCJObyBsYWJlbCBDXCI7XHJcbiAgICAgICAgICAgICAgcmV0dXJuICc8Yj4nICsgbWVkaWNhdGlvbnNbTWF0aC5mbG9vcih0aGlzLngpXS5uYW1lICsgKGxhYmVsID8gJzogJyArIGxhYmVsIDogJycpICsgJzwvYj48YnIvPicgK1xyXG4gICAgICAgICAgICAgICAgSGlnaGNoYXJ0cy5kYXRlRm9ybWF0KCclZC8lbS8lWScsIHRoaXMucG9pbnQub3B0aW9ucy5sb3cpICtcclxuICAgICAgICAgICAgICAgICcgLSAnICsgSGlnaGNoYXJ0cy5kYXRlRm9ybWF0KCclZC8lbS8lWScsIHRoaXMucG9pbnQub3B0aW9ucy5oaWdoKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZm9sbG93UG9pbnRlcjogdHJ1ZVxyXG4gICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICBwbG90T3B0aW9uczoge1xyXG4gICAgICAgICAgICBjb2x1bW5yYW5nZToge1xyXG4gICAgICAgICAgICAgIGdyb3VwaW5nOiBmYWxzZSxcclxuICAgICAgICAgICAgICBkYXRhTGFiZWxzOiB7XHJcbiAgICAgICAgICAgICAgICBhbGxvd092ZXJsYXA6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBlbmFibGVkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgZm9ybWF0dGVyOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgdmFyIHlDb29yZCA9IHRoaXMueTtcclxuICAgICAgICAgICAgICAgICAgdmFyIGlkeCA9IC0xO1xyXG4gICAgICAgICAgICAgICAgICB2YXIgbGFiZWxUbXAgPSBtZWRpY2F0aW9uc1tNYXRoLmZsb29yKHRoaXMueCldLmludGVydmFscy5maWx0ZXIoZnVuY3Rpb24odiwgaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh5Q29vcmQgPj0gdi5mcm9tICYmIHlDb29yZCA8PSB2LnRvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICBpZHggPSBpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgIHZhciBsYWJlbCA9IGxhYmVsVG1wLmxlbmd0aCA+IDAgPyBsYWJlbFRtcFswXS5sYWJlbCA6IFwiTm8gbGFiZWwgRFwiO1xyXG4gICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy55ID09PSB0aGlzLnBvaW50LmxvdyAmJlxyXG4gICAgICAgICAgICAgICAgICAgIChtZWRpY2F0aW9uc1tNYXRoLmZsb29yKHRoaXMueCldLmludGVydmFscy5sZW5ndGggLSAxID09PSBpZHggfHxcclxuICAgICAgICAgICAgICAgICAgICAgICh0aGlzLnNlcmllcy5jaGFydC55QXhpc1swXS5taW4gPD0geUNvb3JkICYmIHRoaXMuc2VyaWVzLmNoYXJ0LnlBeGlzWzBdLm1heCA+PSB5Q29vcmQpIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAodGhpcy5zZXJpZXMuY2hhcnQueUF4aXNbMF0ubWluID49IHRoaXMucG9pbnQubG93ICYmIHRoaXMuc2VyaWVzLmNoYXJ0LnlBeGlzWzBdLm1heCA8PSB0aGlzLnBvaW50LmhpZ2gpKSA/IG1lZGljYXRpb25zW01hdGguZmxvb3IodGhpcy54KV0ubmFtZSArIChsYWJlbCA/ICc6ICcgKyBsYWJlbCA6ICcnKSA6ICcnO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICBzZXJpZXM6IHNlcmllc1xyXG5cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgcGxvdENvbmRpdGlvbnMoZGF0YS5jb25kaXRpb25zLCBkYXRhLmV2ZW50cywgZGF0YS5jb250YWN0cyk7XHJcbiAgICBwbG90TWVhc3VyZW1lbnRzKGRhdGEubWVhc3VyZW1lbnRzKTtcclxuICAgIHZhciBjID0gcGxvdE1lZGljYXRpb25zKGRhdGEubWVkaWNhdGlvbnMpO1xyXG4gICAgcGxvdE5hdmlnYXRvcigpO1xyXG4gICAgYy5oaWdoY2hhcnRzKCkuYXhlc1sxXS5zZXRFeHRyZW1lcygxNDM0ODY0MDAwMDAwLCAxNDU5ODE0NDAwMDAwLCB1bmRlZmluZWQsIGZhbHNlLCB7XHJcbiAgICAgIHRyaWdnZXI6ICdzeW5jRXh0cmVtZXMnXHJcbiAgICB9KTtcclxuXHJcbiAgICBsbC5jaGFydEFycmF5ID0gSGlnaGNoYXJ0cy5jaGFydHMuc2xpY2UoSGlnaGNoYXJ0cy5jaGFydHMubGVuZ3RoIC0gbGwuY2hhcnRzLCBIaWdoY2hhcnRzLmNoYXJ0cy5sZW5ndGgpO1xyXG5cclxuICAgIHZhciBzID0gc3luY0V4dHJlbWVzLmJpbmQoYy5oaWdoY2hhcnRzKCkuc2VyaWVzWzBdKTtcclxuICAgIHMoe1xyXG4gICAgICB0cmlnZ2VyOiAnbmF2aWdhdG9yJyxcclxuICAgICAgbWluOiAxNDM0ODY0MDAwMDAwLFxyXG4gICAgICBtYXg6IDE0NTk4MTQ0MDAwMDBcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGxsO1xyXG4iLCJ2YXIgYmFzZSA9IHJlcXVpcmUoJy4uL2Jhc2UuanMnKSxcclxuICBjb25maXJtID0gcmVxdWlyZSgnLi9jb25maXJtLmpzJyksXHJcbiAgZGF0YSA9IHJlcXVpcmUoJy4uL2RhdGEuanMnKSxcclxuICBsb2cgPSByZXF1aXJlKCcuLi9sb2cuanMnKTtcclxuXHJcbnZhciBtZWQgPSB7XHJcblxyXG4gIGNyZWF0ZTogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpIHtcclxuICAgIHZhciBtZWRpY2F0aW9ucyA9IGRhdGEucGF0aWVudHNbcGF0aWVudElkXS5tZWRpY2F0aW9ucyB8fCBbXTtcclxuICAgIHZhciBhZ3JlZSA9IGxvZy5nZXRQYXRpZW50QWdyZWVPYmplY3QocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQsIFwibWVkaWNhdGlvblwiKTtcclxuICAgIHJldHVybiBiYXNlLmNyZWF0ZVBhbmVsKG1lZGljYXRpb25QYW5lbCwge1xyXG4gICAgICBcImFyZU1lZGljYXRpb25zXCI6IG1lZGljYXRpb25zLmxlbmd0aCA+IDAsXHJcbiAgICAgIFwiYWdyZWVcIjogYWdyZWUgJiYgYWdyZWUuYWdyZWUsXHJcbiAgICAgIFwiZGlzYWdyZWVcIjogYWdyZWUgJiYgYWdyZWUuYWdyZWUgPT09IGZhbHNlLFxyXG4gICAgICBcInBhdGh3YXlcIjogZGF0YS5wYXRod2F5TmFtZXNbcGF0aHdheUlkXSxcclxuICAgICAgXCJtZWRpY2F0aW9uc1wiOiBtZWRpY2F0aW9ucyxcclxuICAgICAgXCJwYXRod2F5U3RhZ2VcIjogcGF0aHdheVN0YWdlXHJcbiAgICB9LCB7XHJcbiAgICAgIFwibWVkaWNhdGlvblJvd1wiOiAkKCcjbWVkaWNhdGlvbi1yb3cnKS5odG1sKClcclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIHdpcmVVcDogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpIHtcclxuICAgIGNvbmZpcm0ud2lyZVVwKCQoJyNtZWRpY2F0aW9uLWFncmVlLWRpc2FncmVlJyksICQoJyNtZWRpY2F0aW9uLXBhbmVsJyksIHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkLCBcIm1lZGljYXRpb25cIiwgXCJtZWRpY2F0aW9uIGRhdGFcIik7XHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gbWVkO1xyXG4iLCJ2YXIgYmFzZSA9IHJlcXVpcmUoJy4uL2Jhc2UuanMnKSxcclxuICBjb25maXJtID0gcmVxdWlyZSgnLi9jb25maXJtLmpzJyksXHJcbiAgZGF0YSA9IHJlcXVpcmUoJy4uL2RhdGEuanMnKSxcclxuICBsb2cgPSByZXF1aXJlKCcuLi9sb2cuanMnKTtcclxuXHJcbnZhciBvdGhlciA9IHtcclxuXHJcbiAgY3JlYXRlOiBmdW5jdGlvbihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCkge1xyXG4gICAgdmFyIGNvZGVzID0gKGRhdGEucGF0aWVudHNbcGF0aWVudElkXS5jb2RlcyB8fCBbXSkubWFwKGZ1bmN0aW9uKHZhbCkge1xyXG4gICAgICB2YWwuZGVzY3JpcHRpb24gPSBkYXRhLmNvZGVzW3ZhbC5jb2RlXTtcclxuICAgICAgcmV0dXJuIHZhbDtcclxuICAgIH0pO1xyXG4gICAgdmFyIGFncmVlID0gbG9nLmdldFBhdGllbnRBZ3JlZU9iamVjdChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCwgXCJjb2Rlc1wiKTtcclxuICAgIHJldHVybiBiYXNlLmNyZWF0ZVBhbmVsKCQoJyNvdGhlci1jb2Rlcy1wYW5lbCcpLCB7XHJcbiAgICAgIFwiYXJlQ29kZXNcIjogY29kZXMubGVuZ3RoID4gMCxcclxuICAgICAgXCJhZ3JlZVwiOiBhZ3JlZSAmJiBhZ3JlZS5hZ3JlZSxcclxuICAgICAgXCJkaXNhZ3JlZVwiOiBhZ3JlZSAmJiBhZ3JlZS5hZ3JlZSA9PT0gZmFsc2UsXHJcbiAgICAgIFwicGF0aHdheVwiOiBkYXRhLnBhdGh3YXlOYW1lc1twYXRod2F5SWRdLFxyXG4gICAgICBcInN0YW5kYXJkXCI6IGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0udGFiLnRpdGxlLFxyXG4gICAgICBcImNvZGVzXCI6IGNvZGVzLFxyXG4gICAgICBcInBhdGh3YXlTdGFnZVwiOiBwYXRod2F5U3RhZ2VcclxuICAgIH0sIHtcclxuICAgICAgXCJjb2RlUm93XCI6ICQoJyNvdGhlci1jb2Rlcy1yb3cnKS5odG1sKClcclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIHdpcmVVcDogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpIHtcclxuICAgIGNvbmZpcm0ud2lyZVVwKCQoJyNvdGhlci1jb2Rlcy1hZ3JlZS1kaXNhZ3JlZScpLCAkKCcjb3RoZXItY29kZXMtcGFuZWwnKSwgcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQsIFwiY29kZXNcIiwgXCJvdGhlciBjb2Rlc1wiKTtcclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBvdGhlcjtcclxuIiwidmFyIGRhdGEgPSByZXF1aXJlKCcuLi9kYXRhLmpzJyksXHJcbiAgTXVzdGFjaGUgPSByZXF1aXJlKCdtdXN0YWNoZScpO1xyXG5cclxudmFyIHBjID0ge1xyXG5cclxuICBzaG93OiBmdW5jdGlvbihwYW5lbCwgaXNBcHBlbmQsIHBhdGllbnRJZCkge1xyXG5cclxuICAgIHZhciBwYXRpZW50RGF0YSA9IGRhdGEuZ2V0UGF0aWVudERhdGEocGF0aWVudElkKTtcclxuXHJcbiAgICB2YXIgdGVtcE11c3QgPSAkKCcjcGF0aWVudC1jaGFyYWN0ZXJpc3RpY3MtcGFuZWwnKS5odG1sKCk7XHJcbiAgICB2YXIgaHRtbCA9IE11c3RhY2hlLnJlbmRlcih0ZW1wTXVzdCwgcGF0aWVudERhdGEuY2hhcmFjdGVyaXN0aWNzKTtcclxuXHJcbiAgICBpZiAoaXNBcHBlbmQpIHBhbmVsLmFwcGVuZChodG1sKTtcclxuICAgIGVsc2UgcGFuZWwuaHRtbChodG1sKTtcclxuXHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gcGM7XHJcbiIsInZhciBIaWdoY2hhcnRzID0gcmVxdWlyZSgnaGlnaGNoYXJ0cy9oaWdoc3RvY2snKSxcclxuICBiYXNlID0gcmVxdWlyZSgnLi4vYmFzZS5qcycpLFxyXG4gIGRhdGEgPSByZXF1aXJlKCcuLi9kYXRhLmpzJyksXHJcbiAgbG9va3VwID0gcmVxdWlyZSgnLi4vbG9va3VwLmpzJyksXHJcbiAgTXVzdGFjaGUgPSByZXF1aXJlKCdtdXN0YWNoZScpO1xyXG5cclxudmFyIElEID0gXCJQQVRJRU5UX0xJU1RcIjtcclxuXHJcbnZhciBwbCA9IHtcclxuXHJcbiAgd2lyZVVwOiBmdW5jdGlvbihvblBhdGllbnRTZWxlY3RlZCkge1xyXG4gICAgcGF0aWVudHNQYW5lbCA9ICQoJyNwYXRpZW50cycpO1xyXG5cclxuICAgIHBhdGllbnRzUGFuZWwub24oJ2NsaWNrJywgJ3RoZWFkIHRyIHRoLnNvcnRhYmxlJywgZnVuY3Rpb24oKSB7IC8vU29ydCBjb2x1bW5zIHdoZW4gY29sdW1uIGhlYWRlciBjbGlja2VkXHJcbiAgICAgIHZhciBzb3J0QXNjID0gISQodGhpcykuaGFzQ2xhc3MoJ3NvcnQtYXNjJyk7XHJcbiAgICAgIGlmIChzb3J0QXNjKSB7XHJcbiAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcygnc29ydC1kZXNjJykuYWRkQ2xhc3MoJ3NvcnQtYXNjJyk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcygnc29ydC1hc2MnKS5hZGRDbGFzcygnc29ydC1kZXNjJyk7XHJcbiAgICAgIH1cclxuICAgICAgcGwucG9wdWxhdGUocGwuc3RhdGVbMF0sIHBsLnN0YXRlWzFdLCBwbC5zdGF0ZVsyXSwgcGwuc3RhdGVbM10sICQodGhpcykuaW5kZXgoKSwgc29ydEFzYyk7XHJcbiAgICB9KS5vbignY2xpY2snLCAndGJvZHkgdHInLCBmdW5jdGlvbihlKSB7IC8vU2VsZWN0IGluZGl2aWR1YWwgcGF0aWVudCB3aGVuIHJvdyBjbGlja2VkI1xyXG4gICAgICB2YXIgY2FsbGJhY2sgPSBvblBhdGllbnRTZWxlY3RlZC5iaW5kKHRoaXMpO1xyXG4gICAgICB2YXIgcGF0aWVudElkID0gJCh0aGlzKS5maW5kKCd0ZCBidXR0b24nKS5hdHRyKCdkYXRhLXBhdGllbnQtaWQnKTtcclxuICAgICAgY2FsbGJhY2socGF0aWVudElkKTtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgfSkub24oJ2NsaWNrJywgJ3Rib2R5IHRyIGJ1dHRvbicsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgLy9kb24ndCB3YW50IHJvdyBzZWxlY3RlZCBpZiBqdXN0IGJ1dHRvbiBwcmVzc2VkP1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICBzZWxlY3RTdWJzZWN0aW9uOiBmdW5jdGlvbihzZWN0aW9uKSB7XHJcbiAgICBwbC5wb3B1bGF0ZShwbC5zdGF0ZVswXSwgcGwuc3RhdGVbMV0sIHBsLnN0YXRlWzJdLCBzZWN0aW9uLCBwbC5zdGF0ZVs0XSwgcGwuc3RhdGVbNV0pO1xyXG4gIH0sXHJcblxyXG4gIHBvcHVsYXRlOiBmdW5jdGlvbihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHN1YnNlY3Rpb24sIHNvcnRGaWVsZCwgc29ydEFzYykge1xyXG4gICAgcGwuc3RhdGUgPSBbcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBzdWJzZWN0aW9uLCBzb3J0RmllbGQsIHNvcnRBc2NdO1xyXG4gICAgcGF0aWVudHNQYW5lbCA9ICQoJyNwYXRpZW50cycpO1xyXG4gICAgLy9SZW1vdmUgc2Nyb2xsIGlmIGV4aXN0c1xyXG4gICAgcGF0aWVudHNQYW5lbC5maW5kKCdkaXYudGFibGUtc2Nyb2xsJykuZ2V0TmljZVNjcm9sbCgpLnJlbW92ZSgpO1xyXG5cclxuICAgIHZhciBpLCBrLCBwcm9wLCBoZWFkZXIsIHBMaXN0ID0gW107XHJcblxyXG4gICAgZGF0YS5nZXRJbmRpY2F0b3JEYXRhKFtwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmRdLmpvaW4oXCIuXCIpLCBmdW5jdGlvbihpbmRpY2F0b3JzKSB7XHJcblxyXG4gICAgICBpZiAocGF0aHdheUlkICYmIHBhdGh3YXlTdGFnZSAmJiBzdGFuZGFyZCAmJiBzdWJzZWN0aW9uKSB7XHJcbiAgICAgICAgcExpc3QgPSBpbmRpY2F0b3JzLm9wcG9ydHVuaXRpZXMuZmlsdGVyKGZ1bmN0aW9uKHZhbCkge1xyXG4gICAgICAgICAgcmV0dXJuIHZhbC5uYW1lID09PSBzdWJzZWN0aW9uO1xyXG4gICAgICAgIH0pWzBdLnBhdGllbnRzO1xyXG4gICAgICAgIGhlYWRlciA9IGluZGljYXRvcnMub3Bwb3J0dW5pdGllcy5maWx0ZXIoZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgICAgICByZXR1cm4gdmFsLm5hbWUgPT09IHN1YnNlY3Rpb247XHJcbiAgICAgICAgfSlbMF0uZGVzY3JpcHRpb247XHJcbiAgICAgIH0gZWxzZSBpZiAocGF0aHdheUlkICYmIHBhdGh3YXlTdGFnZSAmJiBzdGFuZGFyZCkge1xyXG4gICAgICAgIHBMaXN0ID0gaW5kaWNhdG9ycy5vcHBvcnR1bml0aWVzLnJlZHVjZShmdW5jdGlvbihhLCBiKSB7XHJcbiAgICAgICAgICByZXR1cm4gYS5wYXRpZW50cyA/IGEucGF0aWVudHMuY29uY2F0KGIucGF0aWVudHMpIDogYS5jb25jYXQoYi5wYXRpZW50cyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaGVhZGVyID0gZGF0YS50ZXh0W3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLnRhYmxlVGl0bGU7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHBMaXN0ID0gZGF0YS5yZW1vdmVEdXBsaWNhdGVzKHBMaXN0KTtcclxuICAgICAgdmFyIHZJZCA9IGRhdGEudGV4dFtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS52YWx1ZUlkO1xyXG4gICAgICB2YXIgZE92ID0gZGF0YS50ZXh0W3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLmRhdGVPUnZhbHVlO1xyXG4gICAgICB2YXIgcGF0aWVudHMgPSBwTGlzdC5tYXAoZnVuY3Rpb24ocGF0aWVudElkKSB7XHJcbiAgICAgICAgdmFyIHJldCA9IGluZGljYXRvcnMucGF0aWVudHNbcGF0aWVudElkXTtcclxuICAgICAgICByZXQubmhzTnVtYmVyID0gZGF0YS5wYXRMb29rdXBbcGF0aWVudElkXSB8fCBwYXRpZW50SWQ7XHJcbiAgICAgICAgcmV0LnBhdGllbnRJZCA9IHBhdGllbnRJZDtcclxuICAgICAgICByZXQuaXRlbXMgPSBbZGF0YS5wYXRpZW50c1twYXRpZW50SWRdLmNoYXJhY3RlcmlzdGljcy5hZ2VdOyAvL1RoZSBmaWVsZHMgaW4gdGhlIHBhdGllbnQgbGlzdCB0YWJsZVxyXG5cclxuICAgICAgICB2YXIgbWVhc3VyZXMgPSBkYXRhLnBhdGllbnRzW3BhdGllbnRJZF0ubWVhc3VyZW1lbnRzLmZpbHRlcihmdW5jdGlvbih2KXtyZXR1cm4gdi5pZD09PXZJZDt9KTtcclxuXHJcbiAgICAgICAgaWYgKCBtZWFzdXJlc1swXSAmJiBtZWFzdXJlc1swXS5kYXRhKSB7XHJcbiAgICAgICAgICBpZiAoZE92ID09PSBcImRhdGVcIikge1xyXG4gICAgICAgICAgICByZXQuaXRlbXMucHVzaChuZXcgRGF0ZShtZWFzdXJlc1swXS5kYXRhW21lYXN1cmVzWzBdLmRhdGEubGVuZ3RoLTFdWzBdKSk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXQuaXRlbXMucHVzaChtZWFzdXJlc1swXS5kYXRhW21lYXN1cmVzWzBdLmRhdGEubGVuZ3RoLTFdWzFdKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmV0Lml0ZW1zLnB1c2goXCI/XCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXQuaXRlbXMucHVzaChpbmRpY2F0b3JzLnBhdGllbnRzW3BhdGllbnRJZF0ub3Bwb3J0dW5pdGllcy5tYXAoZnVuY3Rpb24odil7cmV0dXJuICc8c3BhbiBzdHlsZT1cIndpZHRoOjEzcHg7aGVpZ2h0OjEzcHg7ZmxvYXQ6bGVmdDtiYWNrZ3JvdW5kLWNvbG9yOicgKyBIaWdoY2hhcnRzLmdldE9wdGlvbnMoKS5jb2xvcnNbdl0gKyAnXCI+PC9zcGFuPic7fSkuam9pbihcIlwiKSk7XHJcbiAgICAgICAgLy9yZXQuaXRlbXMucHVzaChkYXRhLm51bWJlck9mU3RhbmRhcmRzTWlzc2VkKHBhdGllbnRJZCkpO1xyXG4gICAgICAgIHJldHVybiByZXQ7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgdmFyIGxvY2FsRGF0YSA9IHtcclxuICAgICAgICBcInBhdGllbnRzXCI6IHBhdGllbnRzLFxyXG4gICAgICAgIFwiblwiOiBwYXRpZW50cy5sZW5ndGgsXHJcbiAgICAgICAgXCJoZWFkZXJcIjogaGVhZGVyLFxyXG4gICAgICAgIFwiaGVhZGVyLWl0ZW1zXCI6IFt7XHJcbiAgICAgICAgICBcInRpdGxlXCI6IFwiTkhTIG5vLlwiLFxyXG4gICAgICAgICAgXCJpc1NvcnRlZFwiOiBmYWxzZSxcclxuICAgICAgICAgIFwiZGlyZWN0aW9uXCI6IFwic29ydC1hc2NcIixcclxuICAgICAgICAgIFwidG9vbHRpcFwiOiBcIk5IUyBudW1iZXIgb2YgZWFjaCBwYXRpZW50XCJcclxuICAgICAgICB9LHtcclxuICAgICAgICAgIFwidGl0bGVcIjogXCJBZ2VcIixcclxuICAgICAgICAgIFwiaXNTb3J0ZWRcIjogZmFsc2UsXHJcbiAgICAgICAgICBcImRpcmVjdGlvblwiOiBcInNvcnQtYXNjXCIsXHJcbiAgICAgICAgICBcInRvb2x0aXBcIjogXCJUaGUgYWdlIG9mIHRoZSBwYXRpZW50XCJcclxuICAgICAgICB9XVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgLy9taWRkbGUgY29sdW1uIGlzIGVpdGhlciB2YWx1ZSBvciBkYXRlXHJcbiAgICAgIGlmIChkT3YpIHtcclxuICAgICAgICBsb2NhbERhdGFbXCJoZWFkZXItaXRlbXNcIl0ucHVzaCh7XHJcbiAgICAgICAgICBcInRpdGxlXCI6IGRhdGEudGV4dFtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS52YWx1ZU5hbWUsXHJcbiAgICAgICAgICBcInRvb2x0aXBcIjogZE92ID09PSBcImRhdGVcIiA/IFwiTGFzdCBkYXRlIFwiICsgdklkICsgXCIgd2FzIG1lYXN1cmVkXCIgOiBcIkxhc3QgXCIgKyB2SWQgKyBcIiByZWFkaW5nXCIsXHJcbiAgICAgICAgICBcImlzU29ydGVkXCI6IGZhbHNlLFxyXG4gICAgICAgICAgXCJkaXJlY3Rpb25cIjogXCJzb3J0LWFzY1wiXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaWYgKHBhdGh3YXlTdGFnZSA9PT0gbG9va3VwLmNhdGVnb3JpZXMubW9uaXRvcmluZy5uYW1lKSB7XHJcbiAgICAgICAgICBsb2NhbERhdGFbXCJoZWFkZXItaXRlbXNcIl0ucHVzaCh7XHJcbiAgICAgICAgICAgIFwidGl0bGVcIjogXCJMYXN0IEJQIERhdGVcIixcclxuICAgICAgICAgICAgXCJpc1NvcnRlZFwiOiBmYWxzZSxcclxuICAgICAgICAgICAgXCJkaXJlY3Rpb25cIjogXCJzb3J0LWFzY1wiLFxyXG4gICAgICAgICAgICBcInRvb2x0aXBcIjogXCJMYXN0IGRhdGUgQlAgd2FzIG1lYXN1cmVkXCJcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBsb2NhbERhdGFbXCJoZWFkZXItaXRlbXNcIl0ucHVzaCh7XHJcbiAgICAgICAgICAgIFwidGl0bGVcIjogXCJMYXN0IFNCUFwiLFxyXG4gICAgICAgICAgICBcInRvb2x0aXBcIjogXCJMYXN0IHN5c3RvbGljIEJQIHJlYWRpbmdcIixcclxuICAgICAgICAgICAgXCJpc1NvcnRlZFwiOiBmYWxzZSxcclxuICAgICAgICAgICAgXCJkaXJlY3Rpb25cIjogXCJzb3J0LWFzY1wiXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vYWRkIHF1YWwgc3RhbmRhcmQgY29sdW1uXHJcbiAgICAgIGxvY2FsRGF0YVtcImhlYWRlci1pdGVtc1wiXS5wdXNoKHtcclxuICAgICAgICBcInRpdGxlXCI6IFwiQ2F0ZWdvcmllc1wiLFxyXG4gICAgICAgIFwidGl0bGVIVE1MXCI6ICdDYXRlZ29yaWVzJyxcclxuICAgICAgICBcImlzU29ydGVkXCI6IHRydWUsXHJcbiAgICAgICAgXCJ0b29sdGlwXCI6IFwiQ2F0ZWdvcmllcyBmcm9tIGFib3ZlIGNoYXJ0XCJcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBpZiAoc29ydEZpZWxkID09PSB1bmRlZmluZWQpIHNvcnRGaWVsZCA9IDI7XHJcbiAgICAgIGlmIChzb3J0RmllbGQgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIGxvY2FsRGF0YS5wYXRpZW50cy5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcclxuICAgICAgICAgIGlmIChzb3J0RmllbGQgPT09IDApIHsgLy9OSFMgbnVtYmVyXHJcbiAgICAgICAgICAgIGlmIChhLm5oc051bWJlciA9PT0gYi5uaHNOdW1iZXIpIHtcclxuICAgICAgICAgICAgICByZXR1cm4gMDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKGEubmhzTnVtYmVyID4gYi5uaHNOdW1iZXIpIHtcclxuICAgICAgICAgICAgICByZXR1cm4gc29ydEFzYyA/IDEgOiAtMTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChhLm5oc051bWJlciA8IGIubmhzTnVtYmVyKSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIHNvcnRBc2MgPyAtMSA6IDE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmIChhLml0ZW1zW3NvcnRGaWVsZCAtIDFdID09PSBiLml0ZW1zW3NvcnRGaWVsZCAtIDFdKSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIDA7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChhLml0ZW1zW3NvcnRGaWVsZCAtIDFdID09IFwiP1wiKSByZXR1cm4gMTtcclxuICAgICAgICAgICAgaWYgKGIuaXRlbXNbc29ydEZpZWxkIC0gMV0gPT0gXCI/XCIpIHJldHVybiAtMTtcclxuXHJcbiAgICAgICAgICAgIHZhciBBID0gTnVtYmVyKGEuaXRlbXNbc29ydEZpZWxkIC0gMV0pO1xyXG4gICAgICAgICAgICB2YXIgQiA9IE51bWJlcihiLml0ZW1zW3NvcnRGaWVsZCAtIDFdKTtcclxuICAgICAgICAgICAgaWYgKGlzTmFOKEEpIHx8IGlzTmFOKEIpKSB7XHJcbiAgICAgICAgICAgICAgQSA9IGEuaXRlbXNbc29ydEZpZWxkIC0gMV07XHJcbiAgICAgICAgICAgICAgQiA9IGIuaXRlbXNbc29ydEZpZWxkIC0gMV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKEEgPiBCKSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIHNvcnRBc2MgPyAxIDogLTE7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoQSA8IEIpIHtcclxuICAgICAgICAgICAgICByZXR1cm4gc29ydEFzYyA/IC0xIDogMTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbG9jYWxEYXRhW1wiaGVhZGVyLWl0ZW1zXCJdLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICBpZiAoaSA9PT0gc29ydEZpZWxkKSB7XHJcbiAgICAgICAgICAgIGxvY2FsRGF0YVtcImhlYWRlci1pdGVtc1wiXVtpXS5kaXJlY3Rpb24gPSBzb3J0QXNjID8gXCJzb3J0LWFzY1wiIDogXCJzb3J0LWRlc2NcIjtcclxuICAgICAgICAgICAgbG9jYWxEYXRhW1wiaGVhZGVyLWl0ZW1zXCJdW2ldLmlzQXNjID0gc29ydEFzYztcclxuICAgICAgICAgICAgbG9jYWxEYXRhW1wiaGVhZGVyLWl0ZW1zXCJdW2ldLmlzU29ydGVkID0gdHJ1ZTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGxvY2FsRGF0YVtcImhlYWRlci1pdGVtc1wiXVtpXS5pc1NvcnRlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgYmFzZS5jcmVhdGVQYW5lbFNob3cocGF0aWVudExpc3QsIHBhdGllbnRzUGFuZWwsIGxvY2FsRGF0YSwge1xyXG4gICAgICAgIFwiaGVhZGVyLWl0ZW1cIjogJChcIiNwYXRpZW50LWxpc3QtaGVhZGVyLWl0ZW1cIikuaHRtbCgpLFxyXG4gICAgICAgIFwiaXRlbVwiOiAkKCcjcGF0aWVudC1saXN0LWl0ZW0nKS5odG1sKClcclxuICAgICAgfSk7XHJcblxyXG4gICAgICAkKCcjcGF0aWVudHMtcGxhY2Vob2xkZXInKS5oaWRlKCk7XHJcblxyXG4gICAgICBiYXNlLnNldHVwQ2xpcGJvYXJkKCQoJy5idG4tY29weScpLCB0cnVlKTtcclxuXHJcbiAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuXHJcbiAgICAgIHBhdGllbnRzUGFuZWwuZmluZCgnZGl2LnRhYmxlLXNjcm9sbCcpLm5pY2VTY3JvbGwoe1xyXG4gICAgICAgIGN1cnNvcm9wYWNpdHltaW46IDAuMyxcclxuICAgICAgICBjdXJzb3J3aWR0aDogXCI3cHhcIixcclxuICAgICAgICBob3JpenJhaWxlbmFibGVkOiBmYWxzZVxyXG4gICAgICB9KTtcclxuXHJcbiAgICB9KTtcclxuXHJcbiAgfSxcclxuXHJcbiAgc2hvdzogZnVuY3Rpb24ocGFuZWwsIGlzQXBwZW5kLCBwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIGxvYWRDb250ZW50Rm4pIHtcclxuXHJcbiAgICB2YXIgdGVtcE11c3QgPSAkKCcjcGF0aWVudHMtcGFuZWwteWVzJykuaHRtbCgpO1xyXG5cclxuICAgIGlmKGlzQXBwZW5kKSBwYW5lbC5hcHBlbmQoTXVzdGFjaGUucmVuZGVyKHRlbXBNdXN0KSk7XHJcbiAgICBlbHNlIHBhbmVsLmh0bWwoTXVzdGFjaGUucmVuZGVyKHRlbXBNdXN0KSk7XHJcblxyXG4gICAgcGwud2lyZVVwKGZ1bmN0aW9uKHBhdGllbnRJZCkge1xyXG4gICAgICBoaXN0b3J5LnB1c2hTdGF0ZShudWxsLCBudWxsLCAnI3BhdGllbnQvJyArIHBhdGllbnRJZCk7XHJcbiAgICAgIGxvYWRDb250ZW50Rm4oJyNwYXRpZW50LycgKyBwYXRpZW50SWQpO1xyXG4gICAgfSk7XHJcbiAgICBwbC5wb3B1bGF0ZShwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIG51bGwpO1xyXG4gIH1cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHBsO1xyXG4iLCJ2YXIgYmFzZSA9IHJlcXVpcmUoJy4uL2Jhc2UuanMnKSxcclxuICBkYXRhID0gcmVxdWlyZSgnLi4vZGF0YS5qcycpLFxyXG4gIGxvb2t1cCA9IHJlcXVpcmUoJy4uL2xvb2t1cC5qcycpLFxyXG4gIE11c3RhY2hlID0gcmVxdWlyZSgnbXVzdGFjaGUnKTtcclxudmFyIHN0YXRlcywgbG9hZENvbnRGbiwgSUQgPSBcIlBBVElFTlRfU0VBUkNIXCI7XHJcblxyXG52YXIgcHMgPSB7XHJcblxyXG4gIHdpcmVVcDogZnVuY3Rpb24oKSB7XHJcbiAgICBpZiAoc3RhdGVzKSB7XHJcbiAgICAgIHN0YXRlcy5jbGVhclByZWZldGNoQ2FjaGUoKTtcclxuICAgIH1cclxuXHJcbiAgICBzdGF0ZXMgPSBuZXcgQmxvb2Rob3VuZCh7XHJcbiAgICAgIGRhdHVtVG9rZW5pemVyOiBCbG9vZGhvdW5kLnRva2VuaXplcnMub2JqLndoaXRlc3BhY2UoJ3ZhbHVlJyksXHJcbiAgICAgIHF1ZXJ5VG9rZW5pemVyOiBCbG9vZGhvdW5kLnRva2VuaXplcnMud2hpdGVzcGFjZSxcclxuICAgICAgbG9jYWw6ICQubWFwKGRhdGEucGF0aWVudEFycmF5LCBmdW5jdGlvbihzdGF0ZSkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICBpZDogc3RhdGUsXHJcbiAgICAgICAgICB2YWx1ZTogZGF0YS5wYXRMb29rdXAgJiYgZGF0YS5wYXRMb29rdXBbc3RhdGVdID8gZGF0YS5wYXRMb29rdXBbc3RhdGVdIDogc3RhdGVcclxuICAgICAgICB9O1xyXG4gICAgICB9KVxyXG4gICAgfSk7XHJcblxyXG4gICAgc3RhdGVzLmluaXRpYWxpemUodHJ1ZSk7XHJcblxyXG4gICAgJCgnI3NlYXJjaC1ib3gnKS5maW5kKCcudHlwZWFoZWFkJykudHlwZWFoZWFkKCdkZXN0cm95Jyk7XHJcbiAgICAkKCcjc2VhcmNoLWJveCcpLmZpbmQoJy50eXBlYWhlYWQnKS50eXBlYWhlYWQoe1xyXG4gICAgICAgIGhpbnQ6IHRydWUsXHJcbiAgICAgICAgaGlnaGxpZ2h0OiB0cnVlLFxyXG4gICAgICAgIG1pbkxlbmd0aDogMSxcclxuICAgICAgICBhdXRvc2VsZWN0OiB0cnVlXHJcbiAgICAgIH0sIHtcclxuICAgICAgICBuYW1lOiAncGF0aWVudHMnLFxyXG4gICAgICAgIGRpc3BsYXlLZXk6ICd2YWx1ZScsXHJcbiAgICAgICAgc291cmNlOiBzdGF0ZXMudHRBZGFwdGVyKCksXHJcbiAgICAgICAgdGVtcGxhdGVzOiB7XHJcbiAgICAgICAgICBlbXB0eTogW1xyXG4gICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiZW1wdHktbWVzc2FnZVwiPicsXHJcbiAgICAgICAgICAgICAgICAnJm5ic3A7ICZuYnNwOyBObyBtYXRjaGVzJyxcclxuICAgICAgICAgICAgICAnPC9kaXY+J1xyXG4gICAgICAgICAgICBdLmpvaW4oJ1xcbicpXHJcbiAgICAgICAgfVxyXG4gICAgICB9KS5vbigndHlwZWFoZWFkOnNlbGVjdGVkJywgcHMub25TZWxlY3RlZClcclxuICAgICAgLm9uKCd0eXBlYWhlYWQ6YXV0b2NvbXBsZXRlZCcsIHBzLm9uU2VsZWN0ZWQpO1xyXG5cclxuICAgICQoJyNzZWFyY2hidG4nKS5vbignbW91c2Vkb3duJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciB2YWwgPSAkKCcudHlwZWFoZWFkJykuZXEoMCkudmFsKCk7XHJcbiAgICAgIGlmICghdmFsIHx8IHZhbCA9PT0gXCJcIikgdmFsID0gJCgnLnR5cGVhaGVhZCcpLmVxKDEpLnZhbCgpO1xyXG4gICAgICBwcy5vblNlbGVjdGVkKG51bGwsIHtcclxuICAgICAgICBcImlkXCI6IHZhbFxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIG9uU2VsZWN0ZWQ6IGZ1bmN0aW9uKCRlLCBuaHNOdW1iZXJPYmplY3QpIHtcclxuICAgIC8vSGlkZSB0aGUgc3VnZ2VzdGlvbnMgcGFuZWxcclxuICAgICQoJyNzZWFyY2gtYm94JykuZmluZCgnLnR0LWRyb3Bkb3duLW1lbnUnKS5jc3MoJ2Rpc3BsYXknLCAnbm9uZScpO1xyXG5cclxuICAgIGhpc3RvcnkucHVzaFN0YXRlKG51bGwsIG51bGwsICcjcGF0aWVudHMvJyArIG5oc051bWJlck9iamVjdC5pZCk7XHJcbiAgICBsb2FkQ29udEZuKCcjcGF0aWVudHMvJyArIG5oc051bWJlck9iamVjdC5pZCwgdHJ1ZSk7XHJcblxyXG4gIH0sXHJcblxyXG4gIHNob3c6IGZ1bmN0aW9uKHBhbmVsLCBpc0FwcGVuZCwgbG9hZENvbnRlbnRGbikge1xyXG5cclxuICAgIGxvYWRDb250Rm4gPSBsb2FkQ29udGVudEZuO1xyXG4gICAgdmFyIHRlbXBNdXN0ID0gJCgnI3BhdGllbnQtc2VhcmNoJykuaHRtbCgpO1xyXG5cclxuICAgIGlmKGlzQXBwZW5kKSBwYW5lbC5hcHBlbmQoTXVzdGFjaGUucmVuZGVyKHRlbXBNdXN0KSk7XHJcbiAgICBlbHNlIHBhbmVsLmh0bWwoTXVzdGFjaGUucmVuZGVyKHRlbXBNdXN0KSk7XHJcblxyXG4gICAgcHMud2lyZVVwKCk7XHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gcHM7XHJcbiIsInZhciBiYXNlID0gcmVxdWlyZSgnLi4vYmFzZS5qcycpLFxyXG4gIGRhdGEgPSByZXF1aXJlKCcuLi9kYXRhLmpzJyksXHJcbiAgbG9va3VwID0gcmVxdWlyZSgnLi4vbG9va3VwLmpzJyksXHJcbiAgY2hhcnQgPSByZXF1aXJlKCcuLi9jaGFydC5qcycpLFxyXG4gIHF1YWxpdHlTdGFuZGFyZCA9IHJlcXVpcmUoJy4vcXVhbGl0eVN0YW5kYXJkLmpzJyksXHJcbiAgb3RoZXJDb2RlcyA9IHJlcXVpcmUoJy4vb3RoZXJDb2Rlcy5qcycpLFxyXG4gIG1lZGljYXRpb24gPSByZXF1aXJlKCcuL21lZGljYXRpb24uanMnKSxcclxuICB0cmVuZCA9IHJlcXVpcmUoJy4vdHJlbmQuanMnKSxcclxuICBpbmRpdmlkdWFsQWN0aW9uUGxhbiA9IHJlcXVpcmUoJy4vaW5kaXZpZHVhbEFjdGlvblBsYW4uanMnKSxcclxuICBwYXRpZW50TGlzdCA9IHJlcXVpcmUoJy4vcGF0aWVudExpc3QuanMnKTtcclxuXHJcbnZhciBwdCA9IHtcclxuXHJcbiAgY3JlYXRlOiBmdW5jdGlvbihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQpIHtcclxuICAgIHZhciB0YWJEYXRhID0gW107XHJcbiAgICBmb3IgKHZhciBrZXkgaW4gZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzKSB7XHJcbiAgICAgIHRhYkRhdGEucHVzaCh7XHJcbiAgICAgICAgXCJoZWFkZXJcIjogZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW2tleV0udGFiLFxyXG4gICAgICAgIFwiYWN0aXZlXCI6IGtleSA9PT0gc3RhbmRhcmQsXHJcbiAgICAgICAgXCJ1cmxcIjogd2luZG93LmxvY2F0aW9uLmhhc2gucmVwbGFjZSgvXFwvbm8uKi9nLCAnXFwvbm8vJyArIGtleSlcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYmFzZS5jcmVhdGVQYW5lbChwYXRpZW50c1BhbmVsVGVtcGxhdGUsIHtcclxuICAgICAgXCJwYXRod2F5U3RhZ2VcIjogcGF0aHdheVN0YWdlLFxyXG4gICAgICBcImhlYWRlclwiOiBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLmNoYXJ0VGl0bGUsXHJcbiAgICAgIFwidG9vbHRpcFwiOiBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLnRvb2x0aXAsXHJcbiAgICAgIFwidXJsXCI6IHdpbmRvdy5sb2NhdGlvbi5oYXNoLnJlcGxhY2UoL1xcL3llcy4qL2csICcnKS5yZXBsYWNlKC9cXC9uby4qL2csICcnKSxcclxuICAgICAgXCJ0YWJzXCI6IHRhYkRhdGEsXHJcbiAgICAgIFwidGV4dFwiOiBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS50ZXh0XHJcbiAgICB9LCB7XHJcbiAgICAgIFwiY29udGVudFwiOiAkKCcjcGF0aWVudHMtcGFuZWwtbm8nKS5odG1sKCksXHJcbiAgICAgIFwidGFiLWhlYWRlclwiOiAkKCcjcGF0aWVudHMtcGFuZWwtbm8tdGFicycpLmh0bWwoKSxcclxuICAgICAgXCJ0YWItY29udGVudFwiOiAkKCcjcGF0aWVudHMtcGFuZWwtbm8tcGFnZScpLmh0bWwoKVxyXG4gICAgfSk7XHJcbiAgfSxcclxuXHJcbiAgY3JlYXRlT2s6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlKSB7XHJcbiAgICByZXR1cm4gYmFzZS5jcmVhdGVQYW5lbChwYXRpZW50c1BhbmVsVGVtcGxhdGUsIHtcclxuICAgICAgXCJva1wiOiB0cnVlLFxyXG4gICAgICBcInBhdGh3YXlTdGFnZVwiOiBwYXRod2F5U3RhZ2UsXHJcbiAgICAgIFwidXJsXCI6IHdpbmRvdy5sb2NhdGlvbi5oYXNoLnJlcGxhY2UoL1xcL3llcy9nLCAnJykucmVwbGFjZSgvXFwvbm8vZywgJycpLFxyXG4gICAgICBcInRleHRcIjogZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0udGV4dFxyXG4gICAgfSwge1xyXG4gICAgICBcImNvbnRlbnRcIjogJCgnI3BhdGllbnRzLXBhbmVsLXllcycpLmh0bWwoKVxyXG4gICAgfSk7XHJcbiAgfSxcclxuXHJcbiAgd2lyZVVwOiBmdW5jdGlvbihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgbG9jYXRpb24sIHN0YW5kYXJkKSB7XHJcblxyXG4gICAgcGF0aWVudExpc3Qud2lyZVVwKGZ1bmN0aW9uKHBhdGllbnRJZCl7XHJcbiAgICAgICQoJ1tkYXRhLXRvZ2dsZT1cInRvb2x0aXBcIl0nKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgICQodGhpcykudG9vbHRpcCgnZGVzdHJveScpO1xyXG4gICAgICBiYXNlLmNsZWFyQm94KCk7XHJcbiAgICAgICQoJy5saXN0LWl0ZW0nKS5yZW1vdmVDbGFzcygnaGlnaGxpZ2h0ZWQnKTtcclxuICAgICAgJCh0aGlzKS5hZGRDbGFzcygnaGlnaGxpZ2h0ZWQnKS5yZW1vdmVBdHRyKFwidGl0bGVcIik7XHJcblxyXG4gICAgICBwdC5zaG93UGF0aHdheVN0YWdlUGF0aWVudFZpZXcocGF0aWVudElkLCBwYXRod2F5SWQsIHNlbGVjdGVkLCBzdGFuZGFyZCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBwYXRpZW50c1BhbmVsID0gJCgnI3BhdGllbnRzJyk7XHJcblxyXG4gICAgbG9jYXRpb24ub2ZmKCdjbGljaycsICcjYnJlYWtkb3duLWNoYXJ0Jyk7XHJcbiAgICBsb2NhdGlvbi5vbignY2xpY2snLCAnI2JyZWFrZG93bi1jaGFydCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgICBpZiAoIWxvb2t1cC5jaGFydENsaWNrZWQpIHtcclxuICAgICAgICAvKmpzaGludCB1bnVzZWQ6IHRydWUqL1xyXG4gICAgICAgICQoJ3BhdGguYzMtYmFyJykuYXR0cignY2xhc3MnLCBmdW5jdGlvbihpbmRleCwgY2xhc3NOYW1lcykge1xyXG4gICAgICAgICAgcmV0dXJuIGNsYXNzTmFtZXMucmVwbGFjZSgvX3Vuc2VsZWN0ZWRfL2csICcnKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAvKmpzaGludCB1bnVzZWQ6IGZhbHNlKi9cclxuXHJcbiAgICAgICAgaWYgKGxvb2t1cC5jaGFydHNbJ2JyZWFrZG93bi1jaGFydCddKSBsb29rdXAuY2hhcnRzWydicmVha2Rvd24tY2hhcnQnXS51bnNlbGVjdCgpO1xyXG5cclxuICAgICAgICBwYXRpZW50TGlzdC5wb3B1bGF0ZShwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIG51bGwpO1xyXG4gICAgICAgIGRhdGEuc3Vic2VsZWN0ZWQgPSBudWxsO1xyXG5cclxuICAgICAgICBmYXJSaWdodFBhbmVsLmZhZGVPdXQoMjAwKTtcclxuICAgICAgfVxyXG4gICAgICBsb29rdXAuY2hhcnRDbGlja2VkID0gZmFsc2U7XHJcbiAgICB9KTtcclxuXHJcbiAgICBjaGFydC5kZXN0cm95Q2hhcnRzKFsnYnJlYWtkb3duLWNoYXJ0J10pO1xyXG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgbG9va3VwLmNoYXJ0c1snYnJlYWtkb3duLWNoYXJ0J10gPSBjMy5nZW5lcmF0ZSh7XHJcbiAgICAgICAgYmluZHRvOiAnI2JyZWFrZG93bi1jaGFydCcsXHJcbiAgICAgICAgdG9vbHRpcDoge1xyXG4gICAgICAgICAgZm9ybWF0OiB7XHJcbiAgICAgICAgICAgIG5hbWU6IGZ1bmN0aW9uKG5hbWUsIGEsIGIpIHtcclxuICAgICAgICAgICAgICB2YXIgdGV4dCA9IGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0ub3Bwb3J0dW5pdGllc1tsb29rdXAuaW5kZXhdLmRlc2M7XHJcbiAgICAgICAgICAgICAgdmFyIGh0bWwgPSBcIlwiO1xyXG4gICAgICAgICAgICAgIHdoaWxlICh0ZXh0Lmxlbmd0aCA+IDQwKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGV4dC5pbmRleE9mKCcgJywgNDApIDwgMCkgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBodG1sICs9IHRleHQuc3Vic3RyKDAsIHRleHQuaW5kZXhPZignICcsIDQwKSkgKyAnPGJyPic7XHJcbiAgICAgICAgICAgICAgICB0ZXh0ID0gdGV4dC5zdWJzdHIodGV4dC5pbmRleE9mKCcgJywgNDApICsgMSk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIGh0bWwgKz0gdGV4dDtcclxuICAgICAgICAgICAgICByZXR1cm4gaHRtbDtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uKHZhbHVlLCByYXRpbywgaWQsIGluZGV4KSB7XHJcbiAgICAgICAgICAgICAgbG9va3VwLmluZGV4ID0gaW5kZXg7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICBjb2x1bW5zOiBbXHJcbiAgICAgICAgICAgIFtcIlBhdGllbnRzXCJdLmNvbmNhdChkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLm9wcG9ydHVuaXRpZXMubWFwKGZ1bmN0aW9uKHZhbCkge1xyXG4gICAgICAgICAgICAgIHJldHVybiB2YWwucGF0aWVudHMubGVuZ3RoO1xyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICAgIF0sXHJcbiAgICAgICAgICB0eXBlOiAnYmFyJyxcclxuICAgICAgICAgIGxhYmVsczogdHJ1ZSxcclxuICAgICAgICAgIGNvbG9yOiBmdW5jdGlvbihjb2xvciwgZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbG9va3VwLmNvbG9yc1tkLmluZGV4XTtcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBzZWxlY3Rpb246IHtcclxuICAgICAgICAgICAgZW5hYmxlZDogdHJ1ZVxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIG9uY2xpY2s6IGZ1bmN0aW9uKGQpIHtcclxuICAgICAgICAgICAgY2hhcnQuc2VsZWN0UGllU2xpY2UoJ2JyZWFrZG93bi1jaGFydCcsIGQpO1xyXG4gICAgICAgICAgICBwYXRpZW50TGlzdC5wb3B1bGF0ZShwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0ub3Bwb3J0dW5pdGllc1tkLmluZGV4XS5uYW1lKTtcclxuICAgICAgICAgICAgZGF0YS5zdWJzZWxlY3RlZCA9IGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0ub3Bwb3J0dW5pdGllc1tkLmluZGV4XS5uYW1lO1xyXG5cclxuICAgICAgICAgICAgLy9jb2xvdXIgdGFibGUgYXBwcm9wcmlhdGVseSAtIG5lZWQgdG8gYWRkIG9wYWNpdHlcclxuICAgICAgICAgICAgdmFyIHNsaWNlQ29sb3VySGV4ID0gbG9va3VwLmNvbG9yc1tkLmluZGV4XTtcclxuICAgICAgICAgICAgdmFyIHNob3J0aGFuZFJlZ2V4ID0gL14jPyhbYS1mXFxkXSkoW2EtZlxcZF0pKFthLWZcXGRdKSQvaTtcclxuICAgICAgICAgICAgc2xpY2VDb2xvdXJIZXggPSBzbGljZUNvbG91ckhleC5yZXBsYWNlKHNob3J0aGFuZFJlZ2V4LCBmdW5jdGlvbihtLCByLCBnLCBiKSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIHIgKyByICsgZyArIGcgKyBiICsgYjtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSAvXiM/KFthLWZcXGRdezJ9KShbYS1mXFxkXXsyfSkoW2EtZlxcZF17Mn0pJC9pLmV4ZWMoc2xpY2VDb2xvdXJIZXgpO1xyXG4gICAgICAgICAgICB2YXIgb3BhY2l0eSA9IDAuMjtcclxuICAgICAgICAgICAgdmFyIHNsaWNlQ29sb3VyID0gJ3JnYmEoJyArIHBhcnNlSW50KHJlc3VsdFsxXSwgMTYpICsgJywnICsgcGFyc2VJbnQocmVzdWx0WzJdLCAxNikgKyAnLCcgKyBwYXJzZUludChyZXN1bHRbM10sIDE2KSArICcsJyArIG9wYWNpdHkgKyAnKSc7XHJcblxyXG4gICAgICAgICAgICAkKCcudGFibGUucGF0aWVudC1saXN0LnRhYmxlLWhlYWQtaGlkZGVuJykuY3NzKHtcclxuICAgICAgICAgICAgICBcImJhY2tncm91bmRDb2xvclwiOiBzbGljZUNvbG91clxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIGJhcjoge1xyXG4gICAgICAgICAgd2lkdGg6IHtcclxuICAgICAgICAgICAgcmF0aW86IDAuNVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgbGVnZW5kOiB7XHJcbiAgICAgICAgICBzaG93OiBmYWxzZVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZ3JpZDoge1xyXG4gICAgICAgICAgZm9jdXM6IHtcclxuICAgICAgICAgICAgc2hvdzogZmFsc2VcclxuICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIGF4aXM6IHtcclxuICAgICAgICAgIHg6IHtcclxuICAgICAgICAgICAgdHlwZTogJ2NhdGVnb3J5JyxcclxuICAgICAgICAgICAgY2F0ZWdvcmllczogZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS5vcHBvcnR1bml0aWVzLm1hcChmdW5jdGlvbih2YWwpIHtcclxuICAgICAgICAgICAgICByZXR1cm4gdmFsLm5hbWU7XHJcbiAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICBsYWJlbDogZmFsc2VcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICB5OiB7XHJcbiAgICAgICAgICAgIGxhYmVsOiB7XHJcbiAgICAgICAgICAgICAgdGV4dDogJ1BhdGllbnQgY291bnQgKG4pJyxcclxuICAgICAgICAgICAgICBwb3NpdGlvbjogJ291dGVyLW1pZGRsZSdcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9LCAxKTtcclxuICB9LFxyXG5cclxuICB3aXJlVXBPazogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIGxvY2F0aW9uKSB7XHJcbiAgICBwYXRpZW50c1BhbmVsID0gJCgnI3BhdGllbnRzJyk7XHJcblxyXG4gICAgcGF0aWVudHNQYW5lbC5vbignY2xpY2snLCAndGhlYWQgdHIgdGguc29ydGFibGUnLCBmdW5jdGlvbigpIHsgLy9Tb3J0IGNvbHVtbnMgd2hlbiBjb2x1bW4gaGVhZGVyIGNsaWNrZWRcclxuICAgICAgdmFyIHNvcnRBc2MgPSAhJCh0aGlzKS5oYXNDbGFzcygnc29ydC1hc2MnKTtcclxuICAgICAgaWYgKHNvcnRBc2MpIHtcclxuICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKCdzb3J0LWRlc2MnKS5hZGRDbGFzcygnc29ydC1hc2MnKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKCdzb3J0LWFzYycpLmFkZENsYXNzKCdzb3J0LWRlc2MnKTtcclxuICAgICAgfVxyXG4gICAgICBwdC5wb3B1bGF0ZU9rKHBhdGh3YXlJZCwgZGF0YS5zZWxlY3RlZCwgZGF0YS5zdWJzZWxlY3RlZCwgJCh0aGlzKS5pbmRleCgpLCBzb3J0QXNjKTtcclxuICAgIH0pLm9uKCdjbGljaycsICd0Ym9keSB0cicsIGZ1bmN0aW9uKGUpIHsgLy9TZWxlY3QgaW5kaXZpZHVhbCBwYXRpZW50IHdoZW4gcm93IGNsaWNrZWRcclxuICAgICAgJCgnW2RhdGEtdG9nZ2xlPVwidG9vbHRpcFwiXScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgJCh0aGlzKS50b29sdGlwKCdkZXN0cm95Jyk7XHJcbiAgICAgIGJhc2UuY2xlYXJCb3goKTtcclxuICAgICAgJCgnLmxpc3QtaXRlbScpLnJlbW92ZUNsYXNzKCdoaWdobGlnaHRlZCcpO1xyXG4gICAgICAkKHRoaXMpLmFkZENsYXNzKCdoaWdobGlnaHRlZCcpLnJlbW92ZUF0dHIoJ3RpdGxlJyk7XHJcblxyXG4gICAgICB2YXIgcGF0aWVudElkID0gJCh0aGlzKS5maW5kKCd0ZCBidXR0b24nKS5hdHRyKCdkYXRhLXBhdGllbnQtaWQnKTtcclxuXHJcbiAgICAgIHB0LnNob3dQYXRod2F5U3RhZ2VQYXRpZW50VmlldyhwYXRpZW50SWQsIHBhdGh3YXlJZCwgZGF0YS5zZWxlY3RlZCwgbnVsbCk7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgIH0pLm9uKCdjbGljaycsICd0Ym9keSB0ciBidXR0b24nLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIC8vZG9uJ3Qgd2FudCByb3cgc2VsZWN0ZWQgaWYganVzdCBidXR0b24gcHJlc3NlZD9cclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGF0YS5zZWxlY3RlZCA9IHBhdGh3YXlTdGFnZTtcclxuICAgIGRhdGEuc3Vic2VsZWN0ZWQgPSBudWxsO1xyXG4gIH0sXHJcblxyXG4gIHBvcHVsYXRlT2s6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdWJzZWN0aW9uLCBzb3J0RmllbGQsIHNvcnRBc2MpIHtcclxuICAgIHZhciBwTGlzdCA9IFtdLFxyXG4gICAgICBpLCBrLCBwcm9wLCBoZWFkZXIsIHRvb2x0aXA7XHJcbiAgICBwYXRpZW50c1BhbmVsLmZhZGVPdXQoMjAwLCBmdW5jdGlvbigpIHtcclxuICAgICAgJCh0aGlzKS5mYWRlSW4oMjAwKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHBMaXN0ID0gZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0ucGF0aWVudHNPaztcclxuICAgIGhlYWRlciA9IGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnRleHQucGFuZWxPa0hlYWRlci50ZXh0O1xyXG4gICAgdG9vbHRpcCA9IGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnRleHQucGFuZWxPa0hlYWRlci50b29sdGlwO1xyXG5cclxuICAgIHBMaXN0ID0gZGF0YS5yZW1vdmVEdXBsaWNhdGVzKHBMaXN0KTtcclxuICAgIHZhciBwYXRpZW50cyA9IHBMaXN0Lm1hcChmdW5jdGlvbihwYXRpZW50SWQpIHtcclxuICAgICAgdmFyIHJldCA9IGRhdGEucGF0aWVudHNbcGF0aWVudElkXTtcclxuICAgICAgcmV0Lm5oc051bWJlciA9IGRhdGEucGF0TG9va3VwID8gZGF0YS5wYXRMb29rdXBbcGF0aWVudElkXSA6IHBhdGllbnRJZDtcclxuICAgICAgcmV0LnBhdGllbnRJZCA9IHBhdGllbnRJZDtcclxuICAgICAgcmV0Lml0ZW1zID0gW107IC8vVGhlIGZpZWxkcyBpbiB0aGUgcGF0aWVudCBsaXN0IHRhYmxlXHJcbiAgICAgIHJldC5pdGVtcy5wdXNoKGRhdGEucGF0aWVudHNbcGF0aWVudElkXS5icmVhY2ggPyBkYXRhLm51bWJlck9mU3RhbmRhcmRzTWlzc2VkKHBhdGllbnRJZCkgOiAwKTtcclxuICAgICAgcmV0dXJuIHJldDtcclxuICAgIH0pO1xyXG4gICAgdmFyIGxvY2FsRGF0YSA9IHtcclxuICAgICAgXCJwYXRpZW50c1wiOiBwYXRpZW50cyxcclxuICAgICAgXCJuXCI6IHBhdGllbnRzLmxlbmd0aCxcclxuICAgICAgXCJoZWFkZXJcIjogaGVhZGVyLFxyXG4gICAgICBcInRvb2x0aXBcIjogdG9vbHRpcCxcclxuICAgICAgXCJoZWFkZXItaXRlbXNcIjogW3tcclxuICAgICAgICBcInRpdGxlXCI6IFwiTkhTIG5vLlwiLFxyXG4gICAgICAgIFwiaXNTb3J0ZWRcIjogZmFsc2UsXHJcbiAgICAgICAgXCJkaXJlY3Rpb25cIjogXCJzb3J0LWFzY1wiXHJcbiAgICAgIH0sIHtcclxuICAgICAgICBcInRpdGxlXCI6IFwiQWxsIE9wcG9ydHVuaXRpZXNcIixcclxuICAgICAgICBcInRpdGxlSFRNTFwiOiAnIyBvZiA8aSBjbGFzcz1cImZhIGZhLWZsYWdcIiBzdHlsZT1cImNvbG9yOnJlZFwiPjwvaT4nLFxyXG4gICAgICAgIFwiaXNTb3J0ZWRcIjogdHJ1ZSxcclxuICAgICAgICBcImRpcmVjdGlvblwiOiBcInNvcnQtZGVzY1wiLFxyXG4gICAgICAgIFwidG9vbHRpcFwiOiBcIlRvdGFsIG51bWJlciBvZiBpbXByb3ZlbWVudCBvcHBvcnR1bml0aWVzIGF2YWlsYWJsZSBhY3Jvc3MgYWxsIGNvbmRpdGlvbnNcIlxyXG4gICAgICB9XVxyXG4gICAgfTtcclxuXHJcbiAgICBpZiAoc29ydEZpZWxkID09PSB1bmRlZmluZWQpIHNvcnRGaWVsZCA9IDE7XHJcblxyXG4gICAgbG9jYWxEYXRhLnBhdGllbnRzLnNvcnQoZnVuY3Rpb24oYSwgYikge1xyXG4gICAgICBpZiAoc29ydEZpZWxkID09PSAwKSB7IC8vTkhTIG51bWJlclxyXG4gICAgICAgIGlmIChhLm5oc051bWJlciA9PT0gYi5uaHNOdW1iZXIpIHtcclxuICAgICAgICAgIHJldHVybiAwO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGEubmhzTnVtYmVyID4gYi5uaHNOdW1iZXIpIHtcclxuICAgICAgICAgIHJldHVybiBzb3J0QXNjID8gMSA6IC0xO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoYS5uaHNOdW1iZXIgPCBiLm5oc051bWJlcikge1xyXG4gICAgICAgICAgcmV0dXJuIHNvcnRBc2MgPyAtMSA6IDE7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGlmIChhLml0ZW1zW3NvcnRGaWVsZCAtIDFdID09PSBiLml0ZW1zW3NvcnRGaWVsZCAtIDFdKSB7XHJcbiAgICAgICAgICByZXR1cm4gMDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBBID0gTnVtYmVyKGEuaXRlbXNbc29ydEZpZWxkIC0gMV0pO1xyXG4gICAgICAgIHZhciBCID0gTnVtYmVyKGIuaXRlbXNbc29ydEZpZWxkIC0gMV0pO1xyXG4gICAgICAgIGlmIChpc05hTihBKSB8fCBpc05hTihCKSkge1xyXG4gICAgICAgICAgQSA9IGEuaXRlbXNbc29ydEZpZWxkIC0gMV07XHJcbiAgICAgICAgICBCID0gYi5pdGVtc1tzb3J0RmllbGQgLSAxXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKEEgPiBCKSB7XHJcbiAgICAgICAgICByZXR1cm4gc29ydEFzYyA/IDEgOiAtMTtcclxuICAgICAgICB9IGVsc2UgaWYgKEEgPCBCKSB7XHJcbiAgICAgICAgICByZXR1cm4gc29ydEFzYyA/IC0xIDogMTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGZvciAoaSA9IDA7IGkgPCBsb2NhbERhdGFbXCJoZWFkZXItaXRlbXNcIl0ubGVuZ3RoOyBpKyspIHtcclxuICAgICAgaWYgKGkgPT09IHNvcnRGaWVsZCkge1xyXG4gICAgICAgIGxvY2FsRGF0YVtcImhlYWRlci1pdGVtc1wiXVtpXS5kaXJlY3Rpb24gPSBzb3J0QXNjID8gXCJzb3J0LWFzY1wiIDogXCJzb3J0LWRlc2NcIjtcclxuICAgICAgICBsb2NhbERhdGFbXCJoZWFkZXItaXRlbXNcIl1baV0uaXNBc2MgPSBzb3J0QXNjO1xyXG4gICAgICAgIGxvY2FsRGF0YVtcImhlYWRlci1pdGVtc1wiXVtpXS5pc1NvcnRlZCA9IHRydWU7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgbG9jYWxEYXRhW1wiaGVhZGVyLWl0ZW1zXCJdW2ldLmlzU29ydGVkID0gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG4gICAgYmFzZS5jcmVhdGVQYW5lbFNob3cocGF0aWVudExpc3QsIHBhdGllbnRzUGFuZWwsIGxvY2FsRGF0YSwge1xyXG4gICAgICBcImhlYWRlci1pdGVtXCI6ICQoXCIjcGF0aWVudC1saXN0LWhlYWRlci1pdGVtXCIpLmh0bWwoKSxcclxuICAgICAgXCJpdGVtXCI6ICQoJyNwYXRpZW50LWxpc3QtaXRlbScpLmh0bWwoKVxyXG4gICAgfSk7XHJcblxyXG4gICAgJCgnI3BhdGllbnRzLXBsYWNlaG9sZGVyJykuaGlkZSgpO1xyXG5cclxuICAgIGJhc2Uuc2V0dXBDbGlwYm9hcmQoJCgnLmJ0bi1jb3B5JyksIHRydWUpO1xyXG5cclxuICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuXHJcbiAgICB2YXIgYyA9IHBhdGllbnRzUGFuZWwuZmluZCgnZGl2LnRhYmxlLXNjcm9sbCcpLmdldE5pY2VTY3JvbGwoKTtcclxuICAgIGlmIChjICYmIGMubGVuZ3RoID4gMCkge1xyXG4gICAgICBjLnJlc2l6ZSgpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcGF0aWVudHNQYW5lbC5maW5kKCdkaXYudGFibGUtc2Nyb2xsJykubmljZVNjcm9sbCh7XHJcbiAgICAgICAgY3Vyc29yb3BhY2l0eW1pbjogMC4zLFxyXG4gICAgICAgIGN1cnNvcndpZHRoOiBcIjdweFwiLFxyXG4gICAgICAgIGhvcml6cmFpbGVuYWJsZWQ6IGZhbHNlXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIC8vU2hvdyBwYXRpZW50IHZpZXcgd2l0aGluIHRoZSBwYXRod2F5IHN0YWdlIHZpZXdcclxuICBzaG93UGF0aHdheVN0YWdlUGF0aWVudFZpZXc6IGZ1bmN0aW9uKHBhdGllbnRJZCwgcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkKSB7XHJcbiAgICBkYXRhLnBhdGllbnRJZCA9IHBhdGllbnRJZDtcclxuXHJcbiAgICBiYXNlLnN3aXRjaFRvMTEwTGF5b3V0KCk7XHJcblxyXG4gICAgcHQuc2hvd0luZGl2aWR1YWxQYXRpZW50UGFuZWwocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gIH0sXHJcblxyXG4gIHNob3dJbmRpdmlkdWFsUGF0aWVudFBhbmVsOiBmdW5jdGlvbihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCkge1xyXG4gICAgdmFyIHN0YW4gPSBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdID8gZGF0YVtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0uc3RhbmRhcmRzW3N0YW5kYXJkXS50YWIudGl0bGUgOiBcIlVOU1BFQ0lGSUVEXCI7XHJcblxyXG4gICAgZGF0YS5vcHRpb25zLnNvcnQoZnVuY3Rpb24oYSwgYikge1xyXG4gICAgICBhID0gZGF0YS5nZXRQYXRpZW50U3RhdHVzKHBhdGllbnRJZCwgYS5wYXRod2F5SWQsIGEucGF0aHdheVN0YWdlLCBhLnN0YW5kYXJkKTtcclxuICAgICAgYiA9IGRhdGEuZ2V0UGF0aWVudFN0YXR1cyhwYXRpZW50SWQsIGIucGF0aHdheUlkLCBiLnBhdGh3YXlTdGFnZSwgYi5zdGFuZGFyZCk7XHJcblxyXG4gICAgICBpZiAoYSA9PT0gYikgcmV0dXJuIDA7XHJcbiAgICAgIGlmIChhID09PSBcIm5vdFwiKSByZXR1cm4gMTtcclxuICAgICAgaWYgKGIgPT09IFwibm90XCIpIHJldHVybiAtMTtcclxuICAgICAgaWYgKGEgPT09IFwib2tcIikgcmV0dXJuIDE7XHJcbiAgICAgIGlmIChiID09PSBcIm9rXCIpIHJldHVybiAtMTtcclxuICAgICAgYWxlcnQoXCIhISEhISEhXCIpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdmFyIHBhbmVsID0gYmFzZS5jcmVhdGVQYW5lbCgkKCcjcGF0aWVudC1wYW5lbCcpLCB7XHJcbiAgICAgIFwib3B0aW9uc1wiOiBkYXRhLm9wdGlvbnMsXHJcbiAgICAgIFwibnVtYmVyT2ZTdGFuZGFyZHNNaXNzZWRcIjogZGF0YS5udW1iZXJPZlN0YW5kYXJkc01pc3NlZChwYXRpZW50SWQpLFxyXG4gICAgICBcInN0YW5kYXJkXCI6IHN0YW4sXHJcbiAgICAgIFwicGF0aHdheVN0YWdlXCI6IHBhdGh3YXlTdGFnZSxcclxuICAgICAgXCJuaHNOdW1iZXJcIjogZGF0YS5wYXRMb29rdXAgPyBkYXRhLnBhdExvb2t1cFtwYXRpZW50SWRdIDogcGF0aWVudElkLFxyXG4gICAgICBcInBhdGllbnRJZFwiOiBwYXRpZW50SWRcclxuICAgIH0sIHtcclxuICAgICAgXCJvcHRpb25cIjogJCgnI3BhdGllbnQtcGFuZWwtZHJvcC1kb3duLW9wdGlvbnMnKS5odG1sKClcclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChzdGFuZGFyZCA9PT0gbnVsbCkge1xyXG4gICAgICAvL011c3QgYmUgYSBwYXRpZW50IGZyb20gdGhlICoqKiBPSyBncm91cFxyXG4gICAgICBzdGFuZGFyZCA9IGRhdGEub3B0aW9ucy5maWx0ZXIoZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgICAgcmV0dXJuIHZhbC5wYXRod2F5SWQgPT09IHBhdGh3YXlJZCAmJiB2YWwucGF0aHdheVN0YWdlID09PSBwYXRod2F5U3RhZ2U7XHJcbiAgICAgIH0pWzBdLnN0YW5kYXJkO1xyXG4gICAgfVxyXG5cclxuICAgIGZhclJpZ2h0UGFuZWwuaHRtbChcIlwiKTtcclxuICAgICQoJyN0ZW1wLWhpZGRlbicpLmh0bWwocGFuZWwpO1xyXG5cclxuICAgIHZhciBhY3Rpb25QbGFuID0gaW5kaXZpZHVhbEFjdGlvblBsYW4uY3JlYXRlKHBhdGh3YXlTdGFnZSk7XHJcbiAgICAkKCcjdGVtcC1oaWRkZW4gI3BhdGllbnQtcGFuZWwtcmlnaHQnKS5odG1sKGFjdGlvblBsYW4pO1xyXG5cclxuICAgIHZhciBxdWFsUGFuZWwgPSBxdWFsaXR5U3RhbmRhcmQuY3JlYXRlKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgIHZhciB0cmVuZFBhbmVsID0gdHJlbmQuY3JlYXRlKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgIHZhciBtZWRQYW5lbCA9IG1lZGljYXRpb24uY3JlYXRlKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgIHZhciBjb2Rlc1BhbmVsID0gb3RoZXJDb2Rlcy5jcmVhdGUocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gICAgdmFyIG1lZENvZGVXcmFwcGVyUGFuZWwgPSBiYXNlLmNyZWF0ZVBhbmVsKCQoJyNvdGhlci1jb2Rlcy1hbmQtbWVkcy13cmFwcGVyLXBhbmVsJykpO1xyXG4gICAgJCgnI3RlbXAtaGlkZGVuICNwYXRpZW50LXBhbmVsLXRvcCcpLmh0bWwocXVhbFBhbmVsKTtcclxuICAgICQoJyN0ZW1wLWhpZGRlbiAjcGF0aWVudC1wYW5lbC1sZWZ0JykuaHRtbChcIlwiKS5hcHBlbmQodHJlbmRQYW5lbCkuYXBwZW5kKG1lZENvZGVXcmFwcGVyUGFuZWwpO1xyXG4gICAgJCgnI3RlbXAtaGlkZGVuICNtZWRDb2RlV3JhcHBlclBhbmVsJykuYXBwZW5kKG1lZFBhbmVsKS5hcHBlbmQoY29kZXNQYW5lbCk7XHJcblxyXG4gICAgaWYgKGZhclJpZ2h0UGFuZWwuaXMoJzp2aXNpYmxlJykpIHtcclxuICAgICAgZmFyUmlnaHRQYW5lbC5mYWRlT3V0KDUwMCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgJCh0aGlzKS5odG1sKCQoJyN0ZW1wLWhpZGRlbicpLmh0bWwoKSk7XHJcbiAgICAgICAgJCgnI3RlbXAtaGlkZGVuJykuaHRtbChcIlwiKTtcclxuICAgICAgICBpbmRpdmlkdWFsQWN0aW9uUGxhbi53aXJlVXAocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gICAgICAgIHF1YWxpdHlTdGFuZGFyZC53aXJlVXAocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gICAgICAgIGJhc2Uud2lyZVVwU3RhbmRhcmREcm9wRG93bihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHB0LnNob3dJbmRpdmlkdWFsUGF0aWVudFBhbmVsKTtcclxuICAgICAgICB0cmVuZC53aXJlVXAocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gICAgICAgIG1lZGljYXRpb24ud2lyZVVwKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgICAgICBvdGhlckNvZGVzLndpcmVVcChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcbiAgICAgICAgY2hhcnQuZHJhd1RyZW5kQ2hhcnQocGF0aWVudElkLCBwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQpO1xyXG4gICAgICAgICQodGhpcykuZmFkZUluKDUwMCwgZnVuY3Rpb24oKSB7fSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgZmFyUmlnaHRQYW5lbC5odG1sKCQoJyN0ZW1wLWhpZGRlbicpLmh0bWwoKSk7XHJcbiAgICAgICQoJyN0ZW1wLWhpZGRlbicpLmh0bWwoXCJcIik7XHJcbiAgICAgIGluZGl2aWR1YWxBY3Rpb25QbGFuLndpcmVVcChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcbiAgICAgIHF1YWxpdHlTdGFuZGFyZC53aXJlVXAocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gICAgICBiYXNlLndpcmVVcFN0YW5kYXJkRHJvcERvd24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwdC5zaG93SW5kaXZpZHVhbFBhdGllbnRQYW5lbCk7XHJcbiAgICAgIHRyZW5kLndpcmVVcChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCk7XHJcbiAgICAgIG1lZGljYXRpb24ud2lyZVVwKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKTtcclxuICAgICAgb3RoZXJDb2Rlcy53aXJlVXAocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gICAgICBjaGFydC5kcmF3VHJlbmRDaGFydChwYXRpZW50SWQsIHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCk7XHJcbiAgICAgIGZhclJpZ2h0UGFuZWwuZmFkZUluKDUwMCwgZnVuY3Rpb24oKSB7fSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gcHQ7XHJcbiIsInZhciBiYXNlID0gcmVxdWlyZSgnLi4vYmFzZS5qcycpLFxyXG4gIGRhdGEgPSByZXF1aXJlKCcuLi9kYXRhLmpzJyksXHJcbiAgbG9nID0gcmVxdWlyZSgnLi4vbG9nLmpzJyksXHJcbiAgY29uZmlybSA9IHJlcXVpcmUoJy4vY29uZmlybS5qcycpO1xyXG5cclxudmFyIElEID0gXCJRVUFMSVRZU1RBTkRBUkRcIjtcclxuXHJcbnZhciBxcyA9IHtcclxuXHJcbiAgY3JlYXRlOiBmdW5jdGlvbihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCkge1xyXG5cclxuICAgIHZhciBsb2NhbERhdGEgPSB7XHJcbiAgICAgIFwibmhzTnVtYmVyXCI6IGRhdGEucGF0TG9va3VwID8gZGF0YS5wYXRMb29rdXBbcGF0aWVudElkXSA6IHBhdGllbnRJZCxcclxuICAgICAgXCJwYXRpZW50SWRcIjogcGF0aWVudElkXHJcbiAgICB9O1xyXG4gICAgbG9jYWxEYXRhLnN0YW5kYXJkID0gZGF0YS5wYXRod2F5TmFtZXNbcGF0aHdheUlkXSArICcgLSAnICsgcGF0aHdheVN0YWdlO1xyXG4gICAgaWYgKGRhdGEucGF0aWVudHNbcGF0aWVudElkXS5zdGFuZGFyZHMgJiYgZGF0YS5wYXRpZW50c1twYXRpZW50SWRdLnN0YW5kYXJkc1twYXRod2F5SWRdICYmXHJcbiAgICAgIGRhdGEucGF0aWVudHNbcGF0aWVudElkXS5zdGFuZGFyZHNbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdICYmXHJcbiAgICAgIGRhdGEucGF0aWVudHNbcGF0aWVudElkXS5zdGFuZGFyZHNbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdW3N0YW5kYXJkXSkge1xyXG4gICAgICBsb2NhbERhdGEuc3RhbmRhcmQgPSBkYXRhLnBhdGllbnRzW3BhdGllbnRJZF0uc3RhbmRhcmRzW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXVtzdGFuZGFyZF07XHJcbiAgICB9XHJcblxyXG4gICAgbG9jYWxEYXRhLnRvb2x0aXAgPSBkYXRhW3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdW1wic3RhbmRhcmQtbWV0LXRvb2x0aXBcIl07XHJcblxyXG4gICAgc3dpdGNoIChkYXRhLmdldFBhdGllbnRTdGF0dXMocGF0aWVudElkLCBwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQpKSB7XHJcbiAgICAgIGNhc2UgXCJva1wiOlxyXG4gICAgICAgIC8vLy9mYXJSaWdodFBhbmVsLnJlbW92ZUNsYXNzKCdzdGFuZGFyZC1taXNzZWQtcGFnZScpLmFkZENsYXNzKCdzdGFuZGFyZC1hY2hpZXZlZC1wYWdlJykucmVtb3ZlQ2xhc3MoJ3N0YW5kYXJkLW5vdC1yZWxldmFudC1wYWdlJyk7XHJcbiAgICAgICAgbG9jYWxEYXRhLmFjaGlldmVkID0gdHJ1ZTtcclxuICAgICAgICBsb2NhbERhdGEucmVsZXZhbnQgPSB0cnVlO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIFwibWlzc2VkXCI6XHJcbiAgICAgICAgLy8vL2ZhclJpZ2h0UGFuZWwuYWRkQ2xhc3MoJ3N0YW5kYXJkLW1pc3NlZC1wYWdlJykucmVtb3ZlQ2xhc3MoJ3N0YW5kYXJkLWFjaGlldmVkLXBhZ2UnKS5yZW1vdmVDbGFzcygnc3RhbmRhcmQtbm90LXJlbGV2YW50LXBhZ2UnKTtcclxuICAgICAgICBsb2NhbERhdGEucmVsZXZhbnQgPSB0cnVlO1xyXG4gICAgICAgIGxvY2FsRGF0YS5hY2hpZXZlZCA9IGZhbHNlO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIFwibm90XCI6XHJcbiAgICAgICAgLy8vL2ZhclJpZ2h0UGFuZWwucmVtb3ZlQ2xhc3MoJ3N0YW5kYXJkLW1pc3NlZC1wYWdlJykucmVtb3ZlQ2xhc3MoJ3N0YW5kYXJkLWFjaGlldmVkLXBhZ2UnKS5hZGRDbGFzcygnc3RhbmRhcmQtbm90LXJlbGV2YW50LXBhZ2UnKTtcclxuICAgICAgICBsb2NhbERhdGEucmVsZXZhbnQgPSBmYWxzZTtcclxuICAgICAgICBicmVhaztcclxuICAgIH1cclxuXHJcbiAgICB2YXIgYWdPYmogPSBsb2cuZ2V0UGF0aWVudEFncmVlT2JqZWN0KHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkLCBcInN0YW5kYXJkXCIpO1xyXG4gICAgaWYgKGFnT2JqICYmIGFnT2JqLmFncmVlKSBsb2NhbERhdGEuYWdyZWUgPSB0cnVlO1xyXG4gICAgZWxzZSBpZiAoYWdPYmogJiYgYWdPYmouYWdyZWUgPT09IGZhbHNlKSBsb2NhbERhdGEuZGlzYWdyZWUgPSB0cnVlO1xyXG5cclxuICAgIHJldHVybiBiYXNlLmNyZWF0ZVBhbmVsKCQoJyNxdWFsLXN0YW5kYXJkJyksIGxvY2FsRGF0YSk7XHJcbiAgfSxcclxuXHJcbiAgc2hvdzogZnVuY3Rpb24ocGFuZWwsIHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKXtcclxuXHJcbiAgICB2YXIgcGFuZWxJZCA9IHBhbmVsLmF0dHIoXCJpZFwiKTtcclxuXHJcbiAgICBpZiAoYmFzZS5wYW5lbHNbcGFuZWxJZF0gJiZcclxuICAgICAgYmFzZS5wYW5lbHNbcGFuZWxJZF0uaWQgPT09IElEICYmXHJcbiAgICAgIGJhc2UucGFuZWxzW3BhbmVsSWRdLnBhdGllbnRJZCA9PT0gcGF0aWVudElkKSB7XHJcbiAgICAgICAgLy9BbHJlYWR5IHNob3dpbmcgdGhlIHJpZ2h0IHRoaW5nXHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGJhc2UucGFuZWxzW3BhbmVsSWRdID0ge1xyXG4gICAgICBpZDogSUQsXHJcbiAgICAgIHBhdGllbnRJZDogcGF0aWVudElkXHJcbiAgICB9O1xyXG5cclxuICAgIHBhbmVsLmh0bWwocXMuY3JlYXRlKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKSk7XHJcbiAgICBxcy53aXJlVXAocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG4gIH0sXHJcblxyXG4gIHdpcmVVcDogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpIHtcclxuICAgIGNvbmZpcm0ud2lyZVVwKCQoJyNxdWFsLWFncmVlLWRpc2FncmVlJyksICQoJyNpbmRpdmlkdWFsLXBhbmVsLWNsYXNzaWZpY2F0aW9uJyksIHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkLCBcInN0YW5kYXJkXCIsIFwicXVhbGl0eSBzdGFuZGFyZFwiKTtcclxuICB9LFxyXG5cclxuICB1cGRhdGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgJCgnI2luZGl2aWR1YWwtcGFuZWwtY2xhc3NpZmljYXRpb24nKS5maW5kKCdkaXYnKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgc2VsZiA9ICQodGhpcyk7XHJcbiAgICAgIHZhciBhbnkgPSBmYWxzZTtcclxuICAgICAgc2VsZi5maW5kKCcuYnRuLXRvZ2dsZSBpbnB1dFt0eXBlPWNoZWNrYm94XTpjaGVja2VkJykuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgaXNDbGFzc2lmaWNhdGlvbiA9ICQodGhpcykuY2xvc2VzdChcImRpdlwiKS5kYXRhKFwiaXNDbGFzc2lmaWNhdGlvblwiKSAhPT0gdW5kZWZpbmVkO1xyXG4gICAgICAgIGFueSA9IHRydWU7XHJcbiAgICAgICAgdmFyIGl0ZW0gPSBsb2cuZ2V0QWdyZWVzKClbZGF0YS5wYXRpZW50SWRdLmZpbHRlcihmdW5jdGlvbihpKSB7XHJcbiAgICAgICAgICByZXR1cm4gaXNDbGFzc2lmaWNhdGlvbiA/IGkuaXRlbSA9PT0gXCJzZWN0aW9uXCIgOiBpLml0ZW0gIT09IFwic2VjdGlvblwiO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciB0b29sO1xyXG4gICAgICAgIGlmICh0aGlzLnZhbHVlID09PSBcInllc1wiKSB7XHJcbiAgICAgICAgICBpZiAoaXRlbSAmJiBpdGVtWzBdLmhpc3RvcnkpIHtcclxuICAgICAgICAgICAgdG9vbCA9IFwiPHA+XCIgKyBpdGVtWzBdLmhpc3RvcnlbMF0gKyBcIjwvcD48cD5DbGljayBhZ2FpbiB0byBjYW5jZWw8L3A+XCI7XHJcbiAgICAgICAgICAgICQodGhpcykucGFyZW50KCkuYXR0cihcInRpdGxlXCIsIHRvb2wpLmF0dHIoXCJkYXRhLW9yaWdpbmFsLXRpdGxlXCIsIHRvb2wpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5hdHRyKFwidGl0bGVcIiwgXCJZb3UgYWdyZWVkIC0gY2xpY2sgYWdhaW4gdG8gY2FuY2VsXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBpZiAoaXRlbSAmJiBpdGVtWzBdLmhpc3RvcnkpIHtcclxuICAgICAgICAgICAgdG9vbCA9IFwiPHA+XCIgKyBpdGVtWzBdLmhpc3RvcnlbMF0gKyBcIjwvcD48cD5DbGljayBhZ2FpbiB0byBlZGl0L2NhbmNlbDwvcD5cIjtcclxuICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5hdHRyKFwidGl0bGVcIiwgdG9vbCkuYXR0cihcImRhdGEtb3JpZ2luYWwtdGl0bGVcIiwgdG9vbCkudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAkKHRoaXMpLnBhcmVudCgpLmF0dHIoXCJ0aXRsZVwiLCBcIllvdSBkaXNhZ3JlZWQgLSBjbGljayBhZ2FpbiB0byBlZGl0L2NhbmNlbFwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgaWYgKHNlbGYuZmluZCgnLmJ0bi10b2dnbGUgaW5wdXRbdHlwZT1jaGVja2JveF06bm90KDpjaGVja2VkKScpLmxlbmd0aCA9PSAxKSB7XHJcbiAgICAgICAgc2VsZi5maW5kKCcuYnRuLXRvZ2dsZSBpbnB1dFt0eXBlPWNoZWNrYm94XTpub3QoOmNoZWNrZWQpJykucGFyZW50KCkuYWRkQ2xhc3MoXCJpbmFjdGl2ZVwiKS5hdHRyKFwidGl0bGVcIiwgXCJcIikuYXR0cihcImRhdGEtb3JpZ2luYWwtdGl0bGVcIiwgXCJcIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmICghYW55KSB7XHJcbiAgICAgICAgc2VsZi5maW5kKCcuYnRuLXRvZ2dsZS5idG4teWVzJykuYXR0cihcInRpdGxlXCIsIFwiQ2xpY2sgdG8gYWdyZWUgd2l0aCB0aGlzIGFjdGlvbiBhbmQgc2F2ZSBpdCBpbiB5b3VyIGFncmVlZCBhY3Rpb25zIGxpc3QgIFwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgICBzZWxmLmZpbmQoJy5idG4tdG9nZ2xlLmJ0bi1ubycpLmF0dHIoXCJ0aXRsZVwiLCBcIkNsaWNrIHRvIGRpc2FncmVlIHdpdGggdGhpcyBhY3Rpb24gYW5kIHJlbW92ZSBpdCBmcm9tIHlvdXIgc3VnZ2VzdGVkIGFjdGlvbnMgbGlzdCBcIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBxcztcclxuIiwidmFyIGRhdGEgPSByZXF1aXJlKCcuLi9kYXRhLmpzJyksXHJcbiAgTXVzdGFjaGUgPSByZXF1aXJlKCdtdXN0YWNoZScpO1xyXG5cclxudmFyIHFzID0ge1xyXG5cclxuICBzaG93OiBmdW5jdGlvbihwYW5lbCwgaXNBcHBlbmQsIHBhdGllbnRJZCkge1xyXG5cclxuICAgIHZhciBwYXRpZW50RGF0YSA9IGRhdGEuZ2V0UGF0aWVudERhdGEocGF0aWVudElkKTtcclxuXHJcbiAgICB2YXIgdGVtcE11c3QgPSAkKCcjcXVhbGl0eS1zdGFuZGFyZC1wYW5lbCcpLmh0bWwoKTtcclxuICAgIHZhciBodG1sID0gTXVzdGFjaGUucmVuZGVyKHRlbXBNdXN0LCB7XHJcbiAgICAgIFwic3RhbmRhcmRzXCI6IHBhdGllbnREYXRhLnN0YW5kYXJkc1xyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKGlzQXBwZW5kKSBwYW5lbC5hcHBlbmQoaHRtbCk7XHJcbiAgICBlbHNlIHBhbmVsLmh0bWwoaHRtbCk7XHJcblxyXG4gIH1cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHFzO1xyXG4iLCJ2YXIgYmFzZSA9IHJlcXVpcmUoJy4uL2Jhc2UuanMnKSxcclxuICBjb25maXJtID0gcmVxdWlyZSgnLi9jb25maXJtLmpzJyksXHJcbiAgZGF0YSA9IHJlcXVpcmUoJy4uL2RhdGEuanMnKSxcclxuICBsb2cgPSByZXF1aXJlKCcuLi9sb2cuanMnKTtcclxuXHJcbnZhciB0YXAgPSB7XHJcblxyXG4gIHNob3c6IGZ1bmN0aW9uKGxvY2F0aW9uKSB7XHJcbiAgICBsb2NhdGlvbi5yZW1vdmVDbGFzcygnc3RhbmRhcmQtbWlzc2VkLXBhZ2UnKS5yZW1vdmVDbGFzcygnc3RhbmRhcmQtYWNoaWV2ZWQtcGFnZScpLnJlbW92ZUNsYXNzKCdzdGFuZGFyZC1ub3QtcmVsZXZhbnQtcGFnZScpO1xyXG4gICAgYmFzZS5jcmVhdGVQYW5lbFNob3coJCgnI3RlYW0tYWN0aW9uLXBsYW4tcGFuZWwnKSwgbG9jYXRpb24pO1xyXG5cclxuICAgIHN1Z2dlc3RlZFBsYW5UZWFtID0gJCgnI3N1Z2dlc3RlZFBsYW5UZWFtJyk7XHJcblxyXG4gICAgc3VnZ2VzdGVkUGxhblRlYW0ub24oJ2NsaWNrJywgJy5jci1zdHlsZWQgaW5wdXRbdHlwZT1jaGVja2JveF0nLCBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIEFDVElPTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoJ2lkJyk7XHJcbiAgICAgIGxvZy5lZGl0QWN0aW9uKFwidGVhbVwiLCBBQ1RJT05JRCwgbnVsbCwgdGhpcy5jaGVja2VkKTtcclxuXHJcbiAgICAgIGlmICh0aGlzLmNoZWNrZWQpIHtcclxuICAgICAgICBsb2cucmVjb3JkRXZlbnQoZGF0YS5wYXRod2F5SWQsIFwidGVhbVwiLCBcIkl0ZW0gY29tcGxldGVkXCIpO1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAkKHNlbGYpLnBhcmVudCgpLmF0dHIoXCJ0aXRsZVwiLCBcIlwiKS5hdHRyKFwiZGF0YS1vcmlnaW5hbC10aXRsZVwiLCBcIlwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAkKHNlbGYpLnBhcmVudCgpLmZhZGVPdXQoMzAwLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIHBhcmVudCA9ICQodGhpcykucGFyZW50KCk7XHJcbiAgICAgICAgICAgICQodGhpcykucmVwbGFjZVdpdGgoYmFzZS5jcmVhdGVQYW5lbCgkKCcjY2hlY2tib3gtdGVtcGxhdGUnKSwge1xyXG4gICAgICAgICAgICAgIFwiZG9uZVwiOiB0cnVlXHJcbiAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgcGFyZW50LmZpbmQoJ2J1dHRvbicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgIEFDVElPTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoJ2lkJyk7XHJcbiAgICAgICAgICAgICAgbG9nLmVkaXRBY3Rpb24oXCJ0ZWFtXCIsIEFDVElPTklELCBudWxsLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgJCh0aGlzKS5yZXBsYWNlV2l0aChiYXNlLmNyZWF0ZVBhbmVsKCQoJyNjaGVja2JveC10ZW1wbGF0ZScpLCB7XHJcbiAgICAgICAgICAgICAgICBcImRvbmVcIjogZmFsc2VcclxuICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgdGFwLnVwZGF0ZVRlYW1TYXBSb3dzKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSwgMTAwMCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHRhcC51cGRhdGVUZWFtU2FwUm93cygpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgJCgnI3BlcnNvbmFsUGxhblRlYW0nKS5vbignY2xpY2snLCAnaW5wdXRbdHlwZT1jaGVja2JveF0nLCBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIFBMQU5JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKFwiaWRcIik7XHJcbiAgICAgIGVkaXRQbGFuKFBMQU5JRCwgbnVsbCwgdGhpcy5jaGVja2VkKTtcclxuXHJcbiAgICAgIGlmICh0aGlzLmNoZWNrZWQpIHtcclxuICAgICAgICAkKHRoaXMpLnBhcmVudCgpLnBhcmVudCgpLnBhcmVudCgpLmFkZENsYXNzKCdzdWNjZXNzJyk7XHJcbiAgICAgICAgcmVjb3JkRXZlbnQoZGF0YS5wYXRod2F5SWQsIFwidGVhbVwiLCBcIlBlcnNvbmFsIHBsYW4gaXRlbVwiKTtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgJChzZWxmKS5wYXJlbnQoKS5hdHRyKFwidGl0bGVcIiwgXCJcIikuYXR0cihcImRhdGEtb3JpZ2luYWwtdGl0bGVcIiwgXCJcIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAkKHNlbGYpLnBhcmVudCgpLmZhZGVPdXQoMzAwLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIHBhcmVudCA9ICQodGhpcykucGFyZW50KCk7XHJcbiAgICAgICAgICAgICQodGhpcykucmVwbGFjZVdpdGgoYmFzZS5jcmVhdGVQYW5lbCgkKCcjY2hlY2tib3gtdGVtcGxhdGUnKSwge1xyXG4gICAgICAgICAgICAgIFwiZG9uZVwiOiB0cnVlXHJcbiAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgICAgICAgICBwYXJlbnQuZmluZCgnYnV0dG9uJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgUExBTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoJ2lkJyk7XHJcbiAgICAgICAgICAgICAgZWRpdFBsYW4oXCJ0ZWFtXCIsIFBMQU5JRCwgbnVsbCwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICQodGhpcykucmVwbGFjZVdpdGgoYmFzZS5jcmVhdGVQYW5lbCgkKCcjY2hlY2tib3gtdGVtcGxhdGUnKSwge1xyXG4gICAgICAgICAgICAgICAgXCJkb25lXCI6IGZhbHNlXHJcbiAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgIHRhcC51cGRhdGVUZWFtU2FwUm93cygpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sIDEwMDApO1xyXG4gICAgICB9XHJcblxyXG4gICAgfSkub24oJ2NsaWNrJywgJy5idG4tdW5kbycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgdmFyIFBMQU5JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKCdpZCcpO1xyXG4gICAgICBsb2cuZWRpdFBsYW4oUExBTklELCBudWxsLCBmYWxzZSk7XHJcbiAgICAgICQodGhpcykucmVwbGFjZVdpdGgoYmFzZS5jcmVhdGVQYW5lbCgkKCcjY2hlY2tib3gtdGVtcGxhdGUnKSwge1xyXG4gICAgICAgIFwiZG9uZVwiOiBmYWxzZVxyXG4gICAgICB9KSk7XHJcbiAgICAgIHRhcC51cGRhdGVUZWFtU2FwUm93cygpO1xyXG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdmFyIHRlYW1UYWIgPSAkKCcjdGFiLXBsYW4tdGVhbScpLFxyXG4gICAgICBjdXJyZW50O1xyXG4gICAgdGVhbVRhYi5vbignY2xpY2snLCAnLmVkaXQtcGxhbicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgUExBTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoXCJpZFwiKTtcclxuXHJcbiAgICAgICQoJyNlZGl0QWN0aW9uUGxhbkl0ZW0nKS52YWwoJCgkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuY2hpbGRyZW4oJ3RkJylbMF0pLmZpbmQoJ3NwYW4nKS50ZXh0KCkpO1xyXG5cclxuICAgICAgJCgnI2VkaXRQbGFuJykub2ZmKCdoaWRkZW4uYnMubW9kYWwnKS5vbignaGlkZGVuLmJzLm1vZGFsJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGFwLmRpc3BsYXlQZXJzb25hbGlzZWRUZWFtQWN0aW9uUGxhbigkKCcjcGVyc29uYWxQbGFuVGVhbScpKTtcclxuICAgICAgfSkub2ZmKCdzaG93bi5icy5tb2RhbCcpLm9uKCdzaG93bi5icy5tb2RhbCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICQoJyNlZGl0QWN0aW9uUGxhbkl0ZW0nKS5mb2N1cygpO1xyXG4gICAgICB9KS5vZmYoJ2NsaWNrJywgJy5zYXZlLXBsYW4nKS5vbignY2xpY2snLCAnLnNhdmUtcGxhbicsIGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICBsb2cuZWRpdFBsYW4oUExBTklELCAkKCcjZWRpdEFjdGlvblBsYW5JdGVtJykudmFsKCkpO1xyXG5cclxuICAgICAgICAkKCcjZWRpdFBsYW4nKS5tb2RhbCgnaGlkZScpO1xyXG4gICAgICB9KS5vZmYoJ2tleXVwJywgJyNlZGl0QWN0aW9uUGxhbkl0ZW0nKS5vbigna2V5dXAnLCAnI2VkaXRBY3Rpb25QbGFuSXRlbScsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICBpZiAoZS53aGljaCA9PT0gMTMpICQoJyNlZGl0UGxhbiAuc2F2ZS1wbGFuJykuY2xpY2soKTtcclxuICAgICAgfSkubW9kYWwoKTtcclxuICAgIH0pLm9uKCdjbGljaycsICcuZGVsZXRlLXBsYW4nLCBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIFBMQU5JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKFwiaWRcIik7XHJcblxyXG4gICAgICAkKCcjdGVhbS1kZWxldGUtaXRlbScpLmh0bWwoJCgkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuY2hpbGRyZW4oJ3RkJylbMF0pLmZpbmQoJ3NwYW4nKS50ZXh0KCkpO1xyXG5cclxuICAgICAgJCgnI2RlbGV0ZVBsYW4nKS5vZmYoJ2hpZGRlbi5icy5tb2RhbCcpLm9uKCdoaWRkZW4uYnMubW9kYWwnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICB0YXAuZGlzcGxheVBlcnNvbmFsaXNlZFRlYW1BY3Rpb25QbGFuKCQoJyNwZXJzb25hbFBsYW5UZWFtJykpO1xyXG4gICAgICB9KS5vZmYoJ2NsaWNrJywgJy5kZWxldGUtcGxhbicpLm9uKCdjbGljaycsICcuZGVsZXRlLXBsYW4nLCBmdW5jdGlvbigpIHtcclxuICAgICAgICBsb2cuZGVsZXRlUGxhbihQTEFOSUQpO1xyXG5cclxuICAgICAgICAkKCcjZGVsZXRlUGxhbicpLm1vZGFsKCdoaWRlJyk7XHJcbiAgICAgIH0pLm1vZGFsKCk7XHJcbiAgICB9KS5vbignY2xpY2snLCAnLmFkZC1wbGFuJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIGxvZy5yZWNvcmRQbGFuKFwidGVhbVwiLCAkKHRoaXMpLnBhcmVudCgpLnBhcmVudCgpLmZpbmQoJ3RleHRhcmVhJykudmFsKCksIGRhdGEucGF0aHdheUlkKTtcclxuXHJcbiAgICAgIHRhcC5kaXNwbGF5UGVyc29uYWxpc2VkVGVhbUFjdGlvblBsYW4oJCgnI3BlcnNvbmFsUGxhblRlYW0nKSk7XHJcbiAgICB9KS5vbignY2hhbmdlJywgJy5idG4tdG9nZ2xlIGlucHV0W3R5cGU9Y2hlY2tib3hdJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIHRhcC51cGRhdGVUZWFtU2FwUm93cygpO1xyXG4gICAgfSkub24oJ2NsaWNrJywgJy5idG4tdW5kbycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgdmFyIEFDVElPTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoJ2lkJyk7XHJcbiAgICAgIGxvZy5lZGl0QWN0aW9uKFwidGVhbVwiLCBBQ1RJT05JRCwgbnVsbCwgZmFsc2UpO1xyXG4gICAgICAkKHRoaXMpLnJlcGxhY2VXaXRoKGJhc2UuY3JlYXRlUGFuZWwoJCgnI2NoZWNrYm94LXRlbXBsYXRlJyksIHtcclxuICAgICAgICBcImRvbmVcIjogZmFsc2VcclxuICAgICAgfSkpO1xyXG4gICAgICB0YXAudXBkYXRlVGVhbVNhcFJvd3MoKTtcclxuICAgIH0pLm9uKCdjbGljaycsICcuYnRuLXllcywuYnRuLW5vJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICB2YXIgY2hlY2tib3ggPSAkKHRoaXMpLmZpbmQoXCJpbnB1dFt0eXBlPWNoZWNrYm94XVwiKTtcclxuICAgICAgdmFyIG90aGVyID0gJCh0aGlzKS5wYXJlbnQoKS5maW5kKCQodGhpcykuaGFzQ2xhc3MoXCJidG4teWVzXCIpID8gXCIuYnRuLW5vXCIgOiBcIi5idG4teWVzXCIpO1xyXG4gICAgICB2YXIgQUNUSU9OSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YSgnaWQnKTtcclxuICAgICAgaWYgKCQodGhpcykuaGFzQ2xhc3MoXCJhY3RpdmVcIikgJiYgb3RoZXIuaGFzQ2xhc3MoXCJpbmFjdGl2ZVwiKSAmJiAhJCh0aGlzKS5jbG9zZXN0KCd0cicpLmhhc0NsYXNzKCdzdWNjZXNzJykpIHtcclxuICAgICAgICAvL3Vuc2VsZWN0aW5nXHJcbiAgICAgICAgaWYgKGNoZWNrYm94LnZhbCgpID09PSBcIm5vXCIpIHtcclxuICAgICAgICAgIHRhcC5sYXVuY2hNb2RhbChkYXRhLnNlbGVjdGVkLCBjaGVja2JveC5jbG9zZXN0KCd0cicpLmNoaWxkcmVuKCkuZmlyc3QoKS5jaGlsZHJlbigpLmZpcnN0KCkudGV4dCgpLCBsb2cuZ2V0UmVhc29uKFwidGVhbVwiLCBBQ1RJT05JRCksIHRydWUsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBsb2cuZWRpdEFjdGlvbihcInRlYW1cIiwgQUNUSU9OSUQsIGZhbHNlLCBudWxsLCBsb2cucmVhc29uKTtcclxuICAgICAgICAgICAgdGFwLnVwZGF0ZVRlYW1TYXBSb3dzKCk7XHJcbiAgICAgICAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgICAgICAgIH0sIG51bGwsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBsb2cuaWdub3JlQWN0aW9uKFwidGVhbVwiLCBBQ1RJT05JRCk7XHJcbiAgICAgICAgICAgIG90aGVyLnJlbW92ZUNsYXNzKFwiaW5hY3RpdmVcIik7XHJcbiAgICAgICAgICAgIGNoZWNrYm94LnJlbW92ZUF0dHIoXCJjaGVja2VkXCIpO1xyXG4gICAgICAgICAgICBjaGVja2JveC5wYXJlbnQoKS5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgdGFwLnVwZGF0ZVRlYW1TYXBSb3dzKCk7XHJcbiAgICAgICAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgbG9nLmlnbm9yZUFjdGlvbihcInRlYW1cIiwgQUNUSU9OSUQpO1xyXG4gICAgICAgICAgb3RoZXIucmVtb3ZlQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSBpZiAoKCEkKHRoaXMpLmhhc0NsYXNzKFwiYWN0aXZlXCIpICYmIG90aGVyLmhhc0NsYXNzKFwiYWN0aXZlXCIpKSB8fCAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuaGFzQ2xhc3MoJ3N1Y2Nlc3MnKSkge1xyXG4gICAgICAgIC8vcHJldmVudCBjbGlja2luZyBvbiB1bnNlbGVjdGVkIG9wdGlvbiBvciBpZiB0aGUgcm93IGlzIGNvbXBsZXRlXHJcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vc2VsZWN0aW5nXHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIGlmIChjaGVja2JveC52YWwoKSA9PT0gXCJub1wiKSB7XHJcbiAgICAgICAgICB0YXAubGF1bmNoTW9kYWwoZGF0YS5zZWxlY3RlZCwgY2hlY2tib3guY2xvc2VzdCgndHInKS5jaGlsZHJlbigpLmZpcnN0KCkuY2hpbGRyZW4oKS5maXJzdCgpLnRleHQoKSwgbG9nLmdldFJlYXNvbihcInRlYW1cIiwgQUNUSU9OSUQpLCBmYWxzZSwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGxvZy5lZGl0QWN0aW9uKFwidGVhbVwiLCBBQ1RJT05JRCwgZmFsc2UsIG51bGwsIGxvZy5yZWFzb24pO1xyXG4gICAgICAgICAgICAkKHNlbGYpLnJlbW92ZUNsYXNzKFwiaW5hY3RpdmVcIik7XHJcblxyXG4gICAgICAgICAgICBjaGVja2JveC5hdHRyKFwiY2hlY2tlZFwiLCBcImNoZWNrZWRcIik7XHJcbiAgICAgICAgICAgIGNoZWNrYm94LnBhcmVudCgpLmFkZENsYXNzKFwiYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICAvL3Vuc2VsZWN0IG90aGVyXHJcbiAgICAgICAgICAgIG90aGVyLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpLmFkZENsYXNzKFwiaW5hY3RpdmVcIik7XHJcbiAgICAgICAgICAgIG90aGVyLmZpbmQoXCJpbnB1dFt0eXBlPWNoZWNrYm94XVwiKS5wcm9wKFwiY2hlY2tlZFwiLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIHRhcC51cGRhdGVUZWFtU2FwUm93cygpO1xyXG4gICAgICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGxvZy5lZGl0QWN0aW9uKFwidGVhbVwiLCBBQ1RJT05JRCwgdHJ1ZSk7XHJcbiAgICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKFwiaW5hY3RpdmVcIik7XHJcblxyXG4gICAgICAgICAgLy91bnNlbGVjdCBvdGhlclxyXG4gICAgICAgICAgb3RoZXIucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIikuYWRkQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuICAgICAgICAgIG90aGVyLmZpbmQoXCJpbnB1dFt0eXBlPWNoZWNrYm94XVwiKS5wcm9wKFwiY2hlY2tlZFwiLCBmYWxzZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KS5vbigna2V5dXAnLCAnaW5wdXRbdHlwZT10ZXh0XScsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgaWYgKGUud2hpY2ggPT09IDEzKSB7XHJcbiAgICAgICAgdGVhbVRhYi5maW5kKCcuYWRkLXBsYW4nKS5jbGljaygpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICB0YXAucG9wdWxhdGVUZWFtU3VnZ2VzdGVkQWN0aW9uc1BhbmVsKCk7XHJcblxyXG4gICAgbG9jYXRpb24uZmluZCgnZGl2LmZpdC10by1zY3JlZW4taGVpZ2h0JykubmljZVNjcm9sbCh7XHJcbiAgICAgIGN1cnNvcm9wYWNpdHltaW46IDAuMyxcclxuICAgICAgY3Vyc29yd2lkdGg6IFwiN3B4XCIsXHJcbiAgICAgIGhvcml6cmFpbGVuYWJsZWQ6IGZhbHNlXHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICBwb3B1bGF0ZVRlYW1TdWdnZXN0ZWRBY3Rpb25zUGFuZWw6IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIHN1Z2dlc3Rpb25zID0gYmFzZS5zdWdnZXN0aW9uTGlzdChsb2cucGxhbltkYXRhLnBhdGh3YXlJZF0udGVhbSk7XHJcbiAgICBzdWdnZXN0aW9ucyA9IGJhc2Uuc29ydFN1Z2dlc3Rpb25zKHRhcC5tZXJnZVRlYW1TdHVmZihzdWdnZXN0aW9ucykpO1xyXG5cclxuICAgIGJhc2UuY3JlYXRlUGFuZWxTaG93KHN1Z2dlc3RlZFBsYW5UZW1wbGF0ZSwgc3VnZ2VzdGVkUGxhblRlYW0sIHtcclxuICAgICAgXCJzdWdnZXN0aW9uc1wiOiBzdWdnZXN0aW9uc1xyXG4gICAgfSwge1xyXG4gICAgICBcIml0ZW1cIjogJCgnI3N1Z2dlc3RlZC1wbGFuLWl0ZW0nKS5odG1sKCksXHJcbiAgICAgIFwiY2hrXCI6ICQoJyNjaGVja2JveC10ZW1wbGF0ZScpLmh0bWwoKVxyXG4gICAgfSk7XHJcblxyXG4gICAgdGFwLmRpc3BsYXlQZXJzb25hbGlzZWRUZWFtQWN0aW9uUGxhbigkKCcjcGVyc29uYWxQbGFuVGVhbScpKTtcclxuICB9LFxyXG5cclxuICB1cGRhdGVUZWFtU2FwUm93czogZnVuY3Rpb24oKSB7XHJcbiAgICBzdWdnZXN0ZWRQbGFuVGVhbS5hZGQoJyNwZXJzb25hbFBsYW5UZWFtJykuZmluZCgnLnN1Z2dlc3Rpb24nKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICAkKHRoaXMpLmZpbmQoJ3RkJykubGFzdCgpLmNoaWxkcmVuKCkuaGlkZSgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgc3VnZ2VzdGVkUGxhblRlYW0uYWRkKCcjcGVyc29uYWxQbGFuVGVhbScpLmZpbmQoJy5jci1zdHlsZWQgaW5wdXRbdHlwZT1jaGVja2JveF0nKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICBpZiAodGhpcy5jaGVja2VkKSB7XHJcbiAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5wYXJlbnQoKS5wYXJlbnQoKS5hZGRDbGFzcygnc3VjY2VzcycpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgICQodGhpcykucGFyZW50KCkucGFyZW50KCkucGFyZW50KCkucmVtb3ZlQ2xhc3MoJ3N1Y2Nlc3MnKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgc3VnZ2VzdGVkUGxhblRlYW0uYWRkKCcjcGVyc29uYWxQbGFuVGVhbScpLmZpbmQoJy5idG4tdW5kbycpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgICQodGhpcykucGFyZW50KCkucGFyZW50KCkuYWRkQ2xhc3MoJ3N1Y2Nlc3MnKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vbm8gY2xhc3MgLSB1c2VyIG5vdCB5ZXQgYWdyZWVkL2Rpc2FncmVlZCAtIG5vIGJhY2tncm91bmQgLyBtdXRlZCB0ZXh0XHJcbiAgICAvL2FjdGl2ZSAtIHVzZXIgYWdyZWVzIC0gZ3JlZW4gYmFja2dyb3VuZCAvIG5vcm1hbCB0ZXh0XHJcbiAgICAvL3N1Y2Nlc3MgLSB1c2VyIGNvbXBsZXRlZCAtIGdyZWVuIGJhY2tncm91bmQgLyBzdHJpa2V0aHJvdWdoIHRleHRcclxuICAgIC8vZGFuZ2VyIC0gdXNlciBkaXNhZ3JlZXMgLSByZWQgYmFja2dyb3VuZCAvIHN0cmlrZXRocm91Z2ggdGV4dFxyXG4gICAgc3VnZ2VzdGVkUGxhblRlYW0uYWRkKCcjcGVyc29uYWxQbGFuVGVhbScpLmZpbmQoJ3RyJykuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIHNlbGYgPSAkKHRoaXMpO1xyXG4gICAgICB2YXIgYW55ID0gZmFsc2U7XHJcbiAgICAgIHNlbGYuZmluZCgnLmJ0bi10b2dnbGUgaW5wdXRbdHlwZT1jaGVja2JveF06Y2hlY2tlZCcpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgYW55ID0gdHJ1ZTtcclxuICAgICAgICBpZiAodGhpcy52YWx1ZSA9PT0gXCJ5ZXNcIikge1xyXG4gICAgICAgICAgc2VsZi5yZW1vdmVDbGFzcygnZGFuZ2VyJyk7XHJcbiAgICAgICAgICBzZWxmLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgIHNlbGYuZmluZCgndGQnKS5sYXN0KCkuY2hpbGRyZW4oKS5zaG93KCk7XHJcbiAgICAgICAgICBpZiAobG9nLmdldEFjdGlvbnMoKS50ZWFtW3NlbGYuZGF0YShcImlkXCIpXS5oaXN0b3J5KSB7XHJcbiAgICAgICAgICAgIHZhciB0b29sID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmhhc0NsYXNzKCdzdWNjZXNzJykgPyBcIlwiIDogXCI8cD5cIiArIGxvZy5nZXRBY3Rpb25zKCkudGVhbVtzZWxmLmRhdGEoXCJpZFwiKV0uaGlzdG9yeVswXSArIFwiPC9wPjxwPkNsaWNrIGFnYWluIHRvIGNhbmNlbDwvcD5cIjtcclxuICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5hdHRyKFwidGl0bGVcIiwgdG9vbCkuYXR0cihcImRhdGEtb3JpZ2luYWwtdGl0bGVcIiwgdG9vbCkudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAkKHRoaXMpLnBhcmVudCgpLmF0dHIoXCJ0aXRsZVwiLCBcIllvdSBhZ3JlZWQgLSBjbGljayBhZ2FpbiB0byBjYW5jZWxcIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHNlbGYucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgc2VsZi5hZGRDbGFzcygnZGFuZ2VyJyk7XHJcbiAgICAgICAgICBzZWxmLnJlbW92ZUNsYXNzKCdzdWNjZXNzJyk7XHJcbiAgICAgICAgICBpZiAobG9nLmdldEFjdGlvbnMoKS50ZWFtW3NlbGYuZGF0YShcImlkXCIpXSAmJiBsb2cuZ2V0QWN0aW9ucygpLnRlYW1bc2VsZi5kYXRhKFwiaWRcIildLmhpc3RvcnkpIHtcclxuICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5hdHRyKFwidGl0bGVcIiwgXCI8cD5cIiArIGxvZy5nZXRBY3Rpb25zKCkudGVhbVtzZWxmLmRhdGEoXCJpZFwiKV0uaGlzdG9yeVswXSArIFwiPC9wPjxwPkNsaWNrIGFnYWluIHRvIGVkaXQvY2FuY2VsPC9wPlwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICQodGhpcykucGFyZW50KCkuYXR0cihcInRpdGxlXCIsIFwiWW91IGRpc2FncmVlZCAtIGNsaWNrIGFnYWluIHRvIGVkaXQvY2FuY2VsXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICAgIGlmIChzZWxmLmZpbmQoJy5idG4tdG9nZ2xlIGlucHV0W3R5cGU9Y2hlY2tib3hdOm5vdCg6Y2hlY2tlZCknKS5sZW5ndGggPT0gMSkge1xyXG4gICAgICAgIHNlbGYuZmluZCgnLmJ0bi10b2dnbGUgaW5wdXRbdHlwZT1jaGVja2JveF06bm90KDpjaGVja2VkKScpLnBhcmVudCgpLmFkZENsYXNzKFwiaW5hY3RpdmVcIikuYXR0cihcInRpdGxlXCIsIFwiXCIpLmF0dHIoXCJkYXRhLW9yaWdpbmFsLXRpdGxlXCIsIFwiXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICghYW55KSB7XHJcbiAgICAgICAgc2VsZi5yZW1vdmVDbGFzcygnZGFuZ2VyJyk7XHJcbiAgICAgICAgc2VsZi5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgc2VsZi5yZW1vdmVDbGFzcygnc3VjY2VzcycpO1xyXG5cclxuICAgICAgICBzZWxmLmZpbmQoJy5idG4tdG9nZ2xlLmJ0bi15ZXMnKS5hdHRyKFwidGl0bGVcIiwgXCJDbGljayB0byBhZ3JlZSB3aXRoIHRoaXMgYWN0aW9uIGFuZCBzYXZlIGl0IGluIHlvdXIgYWdyZWVkIGFjdGlvbnMgbGlzdCAgXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgIHNlbGYuZmluZCgnLmJ0bi10b2dnbGUuYnRuLW5vJykuYXR0cihcInRpdGxlXCIsIFwiQ2xpY2sgdG8gZGlzYWdyZWUgd2l0aCB0aGlzIGFjdGlvbiBhbmQgcmVtb3ZlIGl0IGZyb20geW91ciBzdWdnZXN0ZWQgYWN0aW9ucyBsaXN0IFwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gIH0sXHJcblxyXG4gIGRpc3BsYXlQZXJzb25hbGlzZWRUZWFtQWN0aW9uUGxhbjogZnVuY3Rpb24ocGFyZW50RWxlbSkge1xyXG4gICAgdmFyIHBsYW5zID0gYmFzZS5zb3J0U3VnZ2VzdGlvbnMoYmFzZS5hZGREaXNhZ3JlZVBlcnNvbmFsVGVhbShsb2cubGlzdFBsYW5zKFwidGVhbVwiLCBkYXRhLnBhdGh3YXlJZCkpKTtcclxuXHJcbiAgICBiYXNlLmNyZWF0ZVBhbmVsU2hvdyhhY3Rpb25QbGFuTGlzdCwgcGFyZW50RWxlbSwge1xyXG4gICAgICBcImhhc1N1Z2dlc3Rpb25zXCI6IHBsYW5zICYmIHBsYW5zLmxlbmd0aCA+IDAsXHJcbiAgICAgIFwic3VnZ2VzdGlvbnNcIjogcGxhbnNcclxuICAgIH0sIHtcclxuICAgICAgXCJhY3Rpb24tcGxhblwiOiAkKCcjYWN0aW9uLXBsYW4nKS5odG1sKCksXHJcbiAgICAgIFwiYWN0aW9uLXBsYW4taXRlbVwiOiAkKCcjYWN0aW9uLXBsYW4taXRlbScpLmh0bWwoKSxcclxuICAgICAgXCJjaGtcIjogJCgnI2NoZWNrYm94LXRlbXBsYXRlJykuaHRtbCgpXHJcbiAgICB9KTtcclxuXHJcbiAgICB0YXAudXBkYXRlVGVhbVNhcFJvd3MoKTtcclxuICB9LFxyXG5cclxuICBtZXJnZVRlYW1TdHVmZjogZnVuY3Rpb24oc3VnZ2VzdGlvbnMpIHtcclxuICAgIHZhciB0ZWFtQWN0aW9ucyA9IGxvZy5saXN0QWN0aW9ucygpO1xyXG4gICAgaWYgKCF0ZWFtQWN0aW9ucy50ZWFtKSByZXR1cm4gc3VnZ2VzdGlvbnM7XHJcblxyXG4gICAgc3VnZ2VzdGlvbnMgPSB0YXAuYWRkRGlzYWdyZWUoc3VnZ2VzdGlvbnMsIHRlYW1BY3Rpb25zLCBcInRlYW1cIik7XHJcbiAgICByZXR1cm4gc3VnZ2VzdGlvbnM7XHJcbiAgfSxcclxuXHJcbiAgbGF1bmNoTW9kYWw6IGZ1bmN0aW9uKGxhYmVsLCB2YWx1ZSwgcmVhc29uLCBpc1VuZG8sIGNhbGxiYWNrT25TYXZlLCBjYWxsYmFja09uQ2FuY2VsLCBjYWxsYmFja09uVW5kbykge1xyXG4gICAgdmFyIHJlYXNvbnMgPSBbe1xyXG4gICAgICBcInJlYXNvblwiOiBcIldlJ3ZlIGFscmVhZHkgZG9uZSB0aGlzXCIsXHJcbiAgICAgIFwidmFsdWVcIjogXCJkb25lXCJcclxuICAgIH0sIHtcclxuICAgICAgXCJyZWFzb25cIjogXCJJdCB3b3VsZG4ndCB3b3JrXCIsXHJcbiAgICAgIFwidmFsdWVcIjogXCJub3dvcmtcIlxyXG4gICAgfSwge1xyXG4gICAgICBcInJlYXNvblwiOiBcIk90aGVyXCIsXHJcbiAgICAgIFwidmFsdWVcIjogXCJlbHNlXCJcclxuICAgIH1dO1xyXG4gICAgaWYgKHJlYXNvbiAmJiByZWFzb24ucmVhc29uKSB7XHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVhc29ucy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGlmIChyZWFzb25zW2ldLnJlYXNvbiA9PT0gcmVhc29uLnJlYXNvbikge1xyXG4gICAgICAgICAgcmVhc29uc1tpXS5jaGVja2VkID0gdHJ1ZTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgYmFzZS5sYXVuY2hNb2RhbCh7XHJcbiAgICAgIFwiaGVhZGVyXCI6IFwiRGlzYWdyZWUgd2l0aCBhIHN1Z2dlc3RlZCBhY3Rpb25cIixcclxuICAgICAgXCJpc1VuZG9cIjogaXNVbmRvLFxyXG4gICAgICBcIml0ZW1cIjogdmFsdWUsXHJcbiAgICAgIFwicGxhY2Vob2xkZXJcIjogXCJFbnRlciBmcmVlLXRleHQgaGVyZS4uLlwiLFxyXG4gICAgICBcInJlYXNvbnNcIjogcmVhc29uc1xyXG4gICAgfSwgbGFiZWwsIHZhbHVlLCByZWFzb24gPyByZWFzb24ucmVhc29uVGV4dCA6IG51bGwsIGNhbGxiYWNrT25TYXZlLCBjYWxsYmFja09uQ2FuY2VsLCBjYWxsYmFja09uVW5kbyk7XHJcbiAgfSxcclxuXHJcbiAgYWRkRGlzYWdyZWU6IGZ1bmN0aW9uKHN1Z2dlc3Rpb25zLCBhY3Rpb25zLCBpZCkge1xyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdWdnZXN0aW9ucy5sZW5ndGg7IGkrKykge1xyXG4gICAgICBpZiAoYWN0aW9uc1tpZF1bc3VnZ2VzdGlvbnNbaV0uaWRdKSB7XHJcbiAgICAgICAgaWYgKGFjdGlvbnNbaWRdW3N1Z2dlc3Rpb25zW2ldLmlkXS5hZ3JlZSkge1xyXG4gICAgICAgICAgc3VnZ2VzdGlvbnNbaV0uYWdyZWUgPSB0cnVlO1xyXG4gICAgICAgICAgc3VnZ2VzdGlvbnNbaV0uZGlzYWdyZWUgPSBmYWxzZTtcclxuICAgICAgICB9IGVsc2UgaWYgKGFjdGlvbnNbaWRdW3N1Z2dlc3Rpb25zW2ldLmlkXS5hZ3JlZSA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgIHN1Z2dlc3Rpb25zW2ldLmFncmVlID0gZmFsc2U7XHJcbiAgICAgICAgICBzdWdnZXN0aW9uc1tpXS5kaXNhZ3JlZSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChhY3Rpb25zW2lkXVtzdWdnZXN0aW9uc1tpXS5pZF0uZG9uZSkgc3VnZ2VzdGlvbnNbaV0uZG9uZSA9IGFjdGlvbnNbaWRdW3N1Z2dlc3Rpb25zW2ldLmlkXS5kb25lO1xyXG4gICAgICAgIGVsc2Ugc3VnZ2VzdGlvbnNbaV0uZG9uZSA9IGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gc3VnZ2VzdGlvbnM7XHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gdGFwO1xyXG4iLCJ2YXIgYmFzZSA9IHJlcXVpcmUoJy4uL2Jhc2UuanMnKSxcclxuICBjb25maXJtID0gcmVxdWlyZSgnLi9jb25maXJtLmpzJyksXHJcbiAgZGF0YSA9IHJlcXVpcmUoJy4uL2RhdGEuanMnKSxcclxuICBsb2cgPSByZXF1aXJlKCcuLi9sb2cuanMnKSxcclxuICBsb29rdXAgPSByZXF1aXJlKCcuLi9sb29rdXAuanMnKTtcclxuXHJcbnZhciB0cm5kID0ge1xyXG5cclxuICBjcmVhdGU6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKSB7XHJcbiAgICB2YXIgYWdyZWUgPSBsb2cuZ2V0UGF0aWVudEFncmVlT2JqZWN0KHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkLCBcInRyZW5kXCIpO1xyXG4gICAgcmV0dXJuIGJhc2UuY3JlYXRlUGFuZWwodmFsdWVUcmVuZFBhbmVsLCB7XHJcbiAgICAgIFwicGF0aHdheVwiOiBsb29rdXAubW9uaXRvcmVkW3BhdGh3YXlJZF0sXHJcbiAgICAgIFwiYWdyZWVcIjogYWdyZWUgJiYgYWdyZWUuYWdyZWUsXHJcbiAgICAgIFwiZGlzYWdyZWVcIjogYWdyZWUgJiYgYWdyZWUuYWdyZWUgPT09IGZhbHNlLFxyXG4gICAgICBcInN0YW5kYXJkXCI6IGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkc1tzdGFuZGFyZF0udGFiLnRpdGxlLFxyXG4gICAgICBcInBhdGh3YXlTdGFnZVwiOiBwYXRod2F5U3RhZ2VcclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIHdpcmVVcDogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpIHtcclxuICAgIGNvbmZpcm0ud2lyZVVwKCQoJyN0cmVuZC1hZ3JlZS1kaXNhZ3JlZScpLCAkKCcjdHJlbmQtcGFuZWwnKSwgcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQsIFwidHJlbmRcIiwgXCJ0cmVuZCBkYXRhXCIpO1xyXG5cclxuICAgICQoJyN0cmVuZC1wYW5lbCcpLm9uKCdjbGljaycsICcudGFibGUtY2hhcnQtdG9nZ2xlJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIGlmICgkKHRoaXMpLnRleHQoKSA9PT0gXCJUYWJsZVwiKSB7XHJcbiAgICAgICAgJCh0aGlzKS50ZXh0KFwiQ2hhcnRcIik7XHJcbiAgICAgICAgJCgnI2NoYXJ0LWRlbW8tdHJlbmQnKS5oaWRlKCk7XHJcbiAgICAgICAgJCgnI3RhYmxlLWRlbW8tdHJlbmQnKS5zaG93KCk7XHJcblxyXG4gICAgICAgIHZhciBjID0gJCgnI3RhYmxlLWRlbW8tdHJlbmQgLnRhYmxlU2Nyb2xsJykuZ2V0TmljZVNjcm9sbCgpO1xyXG4gICAgICAgIGlmIChjICYmIGMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgYy5yZXNpemUoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgJCgnI3RhYmxlLWRlbW8tdHJlbmQgLnRhYmxlU2Nyb2xsJykubmljZVNjcm9sbCh7XHJcbiAgICAgICAgICAgIGN1cnNvcm9wYWNpdHltaW46IDAuMyxcclxuICAgICAgICAgICAgY3Vyc29yd2lkdGg6IFwiN3B4XCIsXHJcbiAgICAgICAgICAgIGhvcml6cmFpbGVuYWJsZWQ6IGZhbHNlXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgJCh0aGlzKS50ZXh0KFwiVGFibGVcIik7XHJcbiAgICAgICAgJCgnI2NoYXJ0LWRlbW8tdHJlbmQnKS5zaG93KCk7XHJcbiAgICAgICAgJCgnI3RhYmxlLWRlbW8tdHJlbmQnKS5oaWRlKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHRybmQ7XHJcbiIsInZhciBiYXNlID0gcmVxdWlyZSgnLi4vYmFzZS5qcycpLFxyXG4gIGRhdGEgPSByZXF1aXJlKCcuLi9kYXRhLmpzJyksXHJcbiAgbG9nID0gcmVxdWlyZSgnLi4vbG9nLmpzJyksXHJcbiAgaW5kaXZpZHVhbEFjdGlvblBsYW4gPSByZXF1aXJlKCcuL2luZGl2aWR1YWxBY3Rpb25QbGFuLmpzJyksXHJcbiAgdGVhbUFjdGlvblBsYW4gPSByZXF1aXJlKCcuL3RlYW1BY3Rpb25QbGFuLmpzJyksXHJcbiAgTXVzdGFjaGUgPSByZXF1aXJlKCdtdXN0YWNoZScpO1xyXG5cclxudmFyIHdlbGNvbWUgPSB7XHJcblxyXG4gIHdpcmVVcFdlbGNvbWVQYWdlOiBmdW5jdGlvbihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSkge1xyXG4gICAgJCgnI3RlYW0tdGFzay1wYW5lbCcpLm9uKCdjbGljaycsICcuY3Itc3R5bGVkIGlucHV0W3R5cGU9Y2hlY2tib3hdJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBBQ1RJT05JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKCdpZCcpO1xyXG4gICAgICBsb2cuZWRpdEFjdGlvbihcInRlYW1cIiwgQUNUSU9OSUQsIG51bGwsIHRoaXMuY2hlY2tlZCk7XHJcblxyXG4gICAgICBpZiAodGhpcy5jaGVja2VkKSB7XHJcbiAgICAgICAgbG9nLnJlY29yZEV2ZW50KHBhdGh3YXlJZCwgXCJ0ZWFtXCIsIFwiSXRlbSBjb21wbGV0ZWRcIik7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgICQoc2VsZikucGFyZW50KCkuYXR0cihcInRpdGxlXCIsIFwiXCIpLmF0dHIoXCJkYXRhLW9yaWdpbmFsLXRpdGxlXCIsIFwiXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICQoc2VsZikucGFyZW50KCkuZmFkZU91dCgzMDAsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgcGFyZW50ID0gJCh0aGlzKS5wYXJlbnQoKTtcclxuICAgICAgICAgICAgJCh0aGlzKS5yZXBsYWNlV2l0aChiYXNlLmNyZWF0ZVBhbmVsKCQoJyNjaGVja2JveC10ZW1wbGF0ZScpLCB7XHJcbiAgICAgICAgICAgICAgXCJkb25lXCI6IHRydWVcclxuICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICBwYXJlbnQuZmluZCgnYnV0dG9uJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgQUNUSU9OSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YSgnaWQnKTtcclxuICAgICAgICAgICAgICBsb2cuZWRpdEFjdGlvbihcInRlYW1cIiwgQUNUSU9OSUQsIG51bGwsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAkKHRoaXMpLnJlcGxhY2VXaXRoKGJhc2UuY3JlYXRlUGFuZWwoJCgnI2NoZWNrYm94LXRlbXBsYXRlJyksIHtcclxuICAgICAgICAgICAgICAgIFwiZG9uZVwiOiBmYWxzZVxyXG4gICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgICB3ZWxjb21lLnVwZGF0ZVdlbGNvbWVQYWdlKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSwgMTAwMCk7XHJcbiAgICAgIH1cclxuICAgICAgd2VsY29tZS51cGRhdGVXZWxjb21lUGFnZSgpO1xyXG4gICAgfSkub24oJ2NoYW5nZScsICcuYnRuLXRvZ2dsZSBpbnB1dFt0eXBlPWNoZWNrYm94XScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICB3ZWxjb21lLnVwZGF0ZVdlbGNvbWVQYWdlKCk7XHJcbiAgICB9KS5vbignY2xpY2snLCAnLmVkaXQtcGxhbicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgUExBTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoXCJpZFwiKTtcclxuXHJcbiAgICAgICQoJyNlZGl0QWN0aW9uUGxhbkl0ZW0nKS52YWwoJCgkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuY2hpbGRyZW4oJ3RkJylbMV0pLmZpbmQoJ3NwYW4nKS50ZXh0KCkpO1xyXG5cclxuICAgICAgJCgnI2VkaXRQbGFuJykub2ZmKCdoaWRkZW4uYnMubW9kYWwnKS5vbignaGlkZGVuLmJzLm1vZGFsJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgd2VsY29tZS5wb3B1bGF0ZSghJCgnI291dHN0YW5kaW5nVGFza3MnKS5wYXJlbnQoKS5oYXNDbGFzcyhcImFjdGl2ZVwiKSk7XHJcbiAgICAgIH0pLm9mZignc2hvd24uYnMubW9kYWwnKS5vbignc2hvd24uYnMubW9kYWwnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAkKCcjZWRpdEFjdGlvblBsYW5JdGVtJykuZm9jdXMoKTtcclxuICAgICAgfSkub2ZmKCdjbGljaycsICcuc2F2ZS1wbGFuJykub24oJ2NsaWNrJywgJy5zYXZlLXBsYW4nLCBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgbG9nLmVkaXRQbGFuKFBMQU5JRCwgJCgnI2VkaXRBY3Rpb25QbGFuSXRlbScpLnZhbCgpKTtcclxuXHJcbiAgICAgICAgJCgnI2VkaXRQbGFuJykubW9kYWwoJ2hpZGUnKTtcclxuICAgICAgfSkub2ZmKCdrZXl1cCcsICcjZWRpdEFjdGlvblBsYW5JdGVtJykub24oJ2tleXVwJywgJyNlZGl0QWN0aW9uUGxhbkl0ZW0nLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgaWYgKGUud2hpY2ggPT09IDEzKSAkKCcjZWRpdFBsYW4gLnNhdmUtcGxhbicpLmNsaWNrKCk7XHJcbiAgICAgIH0pLm1vZGFsKCk7XHJcbiAgICB9KS5vbignY2xpY2snLCAnLmRlbGV0ZS1wbGFuJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBQTEFOSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YShcImlkXCIpO1xyXG5cclxuICAgICAgJCgnI3RlYW0tZGVsZXRlLWl0ZW0nKS5odG1sKCQoJCh0aGlzKS5jbG9zZXN0KCd0cicpLmNoaWxkcmVuKCd0ZCcpWzFdKS5maW5kKCdzcGFuJykudGV4dCgpKTtcclxuXHJcbiAgICAgICQoJyNkZWxldGVQbGFuJykub2ZmKCdoaWRkZW4uYnMubW9kYWwnKS5vbignaGlkZGVuLmJzLm1vZGFsJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgd2VsY29tZS5wb3B1bGF0ZSghJCgnI291dHN0YW5kaW5nVGFza3MnKS5wYXJlbnQoKS5oYXNDbGFzcyhcImFjdGl2ZVwiKSk7XHJcbiAgICAgIH0pLm9mZignY2xpY2snLCAnLmRlbGV0ZS1wbGFuJykub24oJ2NsaWNrJywgJy5kZWxldGUtcGxhbicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGxvZy5kZWxldGVQbGFuKFBMQU5JRCk7XHJcblxyXG4gICAgICAgICQoJyNkZWxldGVQbGFuJykubW9kYWwoJ2hpZGUnKTtcclxuICAgICAgfSkubW9kYWwoKTtcclxuICAgIH0pLm9uKCdjbGljaycsICcuYnRuLXVuZG8nLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIHZhciBBQ1RJT05JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKCdpZCcpO1xyXG4gICAgICBsb2cuZWRpdEFjdGlvbihcInRlYW1cIiwgQUNUSU9OSUQsIG51bGwsIGZhbHNlKTtcclxuICAgICAgJCh0aGlzKS5yZXBsYWNlV2l0aChiYXNlLmNyZWF0ZVBhbmVsKCQoJyNjaGVja2JveC10ZW1wbGF0ZScpLCB7XHJcbiAgICAgICAgXCJkb25lXCI6IGZhbHNlXHJcbiAgICAgIH0pKTtcclxuICAgICAgd2VsY29tZS51cGRhdGVXZWxjb21lUGFnZSgpO1xyXG4gICAgfSkub24oJ2NsaWNrJywgJy5idG4teWVzLC5idG4tbm8nLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIHZhciBjaGVja2JveCA9ICQodGhpcykuZmluZChcImlucHV0W3R5cGU9Y2hlY2tib3hdXCIpO1xyXG4gICAgICB2YXIgb3RoZXIgPSAkKHRoaXMpLnBhcmVudCgpLmZpbmQoJCh0aGlzKS5oYXNDbGFzcyhcImJ0bi15ZXNcIikgPyBcIi5idG4tbm9cIiA6IFwiLmJ0bi15ZXNcIik7XHJcbiAgICAgIHZhciBBQ1RJT05JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKCdpZCcpO1xyXG4gICAgICBpZiAoJCh0aGlzKS5oYXNDbGFzcyhcImFjdGl2ZVwiKSAmJiBvdGhlci5oYXNDbGFzcyhcImluYWN0aXZlXCIpICYmICEkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuaGFzQ2xhc3MoJ3N1Y2Nlc3MnKSkge1xyXG4gICAgICAgIC8vdW5zZWxlY3RpbmdcclxuICAgICAgICBpZiAoY2hlY2tib3gudmFsKCkgPT09IFwibm9cIikge1xyXG4gICAgICAgICAgdGVhbUFjdGlvblBsYW4ubGF1bmNoTW9kYWwoZGF0YS5zZWxlY3RlZCwgY2hlY2tib3guY2xvc2VzdCgndHInKS5jaGlsZHJlbignOm50aCgxKScpLmZpbmQoJ3NwYW4nKS50ZXh0KCksIGxvZy5nZXRSZWFzb24oXCJ0ZWFtXCIsIEFDVElPTklEKSwgdHJ1ZSwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGxvZy5lZGl0QWN0aW9uKFwidGVhbVwiLCBBQ1RJT05JRCwgZmFsc2UsIG51bGwsIGxvZy5yZWFzb24pO1xyXG4gICAgICAgICAgICB3ZWxjb21lLnVwZGF0ZVdlbGNvbWVQYWdlKCk7XHJcbiAgICAgICAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgICAgICAgIH0sIG51bGwsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBsb2cuaWdub3JlQWN0aW9uKFwidGVhbVwiLCBBQ1RJT05JRCk7XHJcbiAgICAgICAgICAgIG90aGVyLnJlbW92ZUNsYXNzKFwiaW5hY3RpdmVcIik7XHJcbiAgICAgICAgICAgIGNoZWNrYm94LnJlbW92ZUF0dHIoXCJjaGVja2VkXCIpO1xyXG4gICAgICAgICAgICBjaGVja2JveC5wYXJlbnQoKS5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgd2VsY29tZS51cGRhdGVXZWxjb21lUGFnZSgpO1xyXG4gICAgICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGxvZy5pZ25vcmVBY3Rpb24oXCJ0ZWFtXCIsIEFDVElPTklEKTtcclxuICAgICAgICAgIG90aGVyLnJlbW92ZUNsYXNzKFwiaW5hY3RpdmVcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2UgaWYgKCghJCh0aGlzKS5oYXNDbGFzcyhcImFjdGl2ZVwiKSAmJiBvdGhlci5oYXNDbGFzcyhcImFjdGl2ZVwiKSkgfHwgJCh0aGlzKS5jbG9zZXN0KCd0cicpLmhhc0NsYXNzKCdzdWNjZXNzJykpIHtcclxuICAgICAgICAvL3ByZXZlbnQgY2xpY2tpbmcgb24gdW5zZWxlY3RlZCBvcHRpb24gb3IgaWYgdGhlIHJvdyBpcyBjb21wbGV0ZVxyXG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvL3NlbGVjdGluZ1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBpZiAoY2hlY2tib3gudmFsKCkgPT09IFwibm9cIikge1xyXG4gICAgICAgICAgdGVhbUFjdGlvblBsYW4ubGF1bmNoTW9kYWwoZGF0YS5zZWxlY3RlZCwgY2hlY2tib3guY2xvc2VzdCgndHInKS5jaGlsZHJlbignOm50aCgxKScpLmZpbmQoJ3NwYW4nKS50ZXh0KCksIGxvZy5nZXRSZWFzb24oXCJ0ZWFtXCIsIEFDVElPTklEKSwgZmFsc2UsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBsb2cuZWRpdEFjdGlvbihcInRlYW1cIiwgQUNUSU9OSUQsIGZhbHNlLCBudWxsLCBsb2cucmVhc29uKTtcclxuICAgICAgICAgICAgJChzZWxmKS5yZW1vdmVDbGFzcyhcImluYWN0aXZlXCIpO1xyXG5cclxuICAgICAgICAgICAgY2hlY2tib3guYXR0cihcImNoZWNrZWRcIiwgXCJjaGVja2VkXCIpO1xyXG4gICAgICAgICAgICBjaGVja2JveC5wYXJlbnQoKS5hZGRDbGFzcyhcImFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgLy91bnNlbGVjdCBvdGhlclxyXG4gICAgICAgICAgICBvdGhlci5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKS5hZGRDbGFzcyhcImluYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICBvdGhlci5maW5kKFwiaW5wdXRbdHlwZT1jaGVja2JveF1cIikucHJvcChcImNoZWNrZWRcIiwgZmFsc2UpO1xyXG4gICAgICAgICAgICB3ZWxjb21lLnVwZGF0ZVdlbGNvbWVQYWdlKCk7XHJcbiAgICAgICAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgbG9nLmVkaXRBY3Rpb24oXCJ0ZWFtXCIsIEFDVElPTklELCB0cnVlKTtcclxuICAgICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuXHJcbiAgICAgICAgICAvL3Vuc2VsZWN0IG90aGVyXHJcbiAgICAgICAgICBvdGhlci5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKS5hZGRDbGFzcyhcImluYWN0aXZlXCIpO1xyXG4gICAgICAgICAgb3RoZXIuZmluZChcImlucHV0W3R5cGU9Y2hlY2tib3hdXCIpLnByb3AoXCJjaGVja2VkXCIsIGZhbHNlKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgICQoJyNpbmRpdmlkdWFsLXRhc2stcGFuZWwnKS5vbignY2xpY2snLCAnLmNyLXN0eWxlZCBpbnB1dFt0eXBlPWNoZWNrYm94XScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgQUNUSU9OSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YSgnaWQnKTtcclxuICAgICAgdmFyIHBhdGllbnRJZCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKCd0ZWFtLW9yLXBhdGllbnQtaWQnKTtcclxuICAgICAgbG9nLmVkaXRBY3Rpb24ocGF0aWVudElkLCBBQ1RJT05JRCwgbnVsbCwgdGhpcy5jaGVja2VkKTtcclxuXHJcbiAgICAgIGlmICh0aGlzLmNoZWNrZWQpIHtcclxuICAgICAgICBsb2cucmVjb3JkRXZlbnQocGF0aHdheUlkLCBwYXRpZW50SWQsIFwiSXRlbSBjb21wbGV0ZWRcIik7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgICQoc2VsZikucGFyZW50KCkuYXR0cihcInRpdGxlXCIsIFwiXCIpLmF0dHIoXCJkYXRhLW9yaWdpbmFsLXRpdGxlXCIsIFwiXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICQoc2VsZikucGFyZW50KCkuZmFkZU91dCgzMDAsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgcGFyZW50ID0gJCh0aGlzKS5wYXJlbnQoKTtcclxuICAgICAgICAgICAgJCh0aGlzKS5yZXBsYWNlV2l0aChiYXNlLmNyZWF0ZVBhbmVsKCQoJyNjaGVja2JveC10ZW1wbGF0ZScpLCB7XHJcbiAgICAgICAgICAgICAgXCJkb25lXCI6IHRydWVcclxuICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICBwYXJlbnQuZmluZCgnYnV0dG9uJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgQUNUSU9OSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YSgnaWQnKTtcclxuICAgICAgICAgICAgICBsb2cuZWRpdEFjdGlvbihwYXRpZW50SWQsIEFDVElPTklELCBudWxsLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgJCh0aGlzKS5yZXBsYWNlV2l0aChiYXNlLmNyZWF0ZVBhbmVsKCQoJyNjaGVja2JveC10ZW1wbGF0ZScpLCB7XHJcbiAgICAgICAgICAgICAgICBcImRvbmVcIjogZmFsc2VcclxuICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgd2VsY29tZS51cGRhdGVXZWxjb21lUGFnZSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sIDEwMDApO1xyXG4gICAgICB9XHJcbiAgICAgIHdlbGNvbWUudXBkYXRlV2VsY29tZVBhZ2UoKTtcclxuICAgIH0pLm9uKCdjaGFuZ2UnLCAnLmJ0bi10b2dnbGUgaW5wdXRbdHlwZT1jaGVja2JveF0nLCBmdW5jdGlvbigpIHtcclxuICAgICAgd2VsY29tZS51cGRhdGVXZWxjb21lUGFnZSgpO1xyXG4gICAgfSkub24oJ2NsaWNrJywgJy5lZGl0LXBsYW4nLCBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIFBMQU5JRCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKFwiaWRcIik7XHJcblxyXG4gICAgICAkKCcjZWRpdEFjdGlvblBsYW5JdGVtJykudmFsKCQoJCh0aGlzKS5jbG9zZXN0KCd0cicpLmNoaWxkcmVuKCd0ZCcpWzJdKS5maW5kKCdzcGFuJykudGV4dCgpKTtcclxuXHJcbiAgICAgICQoJyNlZGl0UGxhbicpLm9mZignaGlkZGVuLmJzLm1vZGFsJykub24oJ2hpZGRlbi5icy5tb2RhbCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHdlbGNvbWUucG9wdWxhdGUoISQoJyNvdXRzdGFuZGluZ1Rhc2tzJykucGFyZW50KCkuaGFzQ2xhc3MoXCJhY3RpdmVcIikpO1xyXG4gICAgICB9KS5vZmYoJ3Nob3duLmJzLm1vZGFsJykub24oJ3Nob3duLmJzLm1vZGFsJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgJCgnI2VkaXRBY3Rpb25QbGFuSXRlbScpLmZvY3VzKCk7XHJcbiAgICAgIH0pLm9mZignY2xpY2snLCAnLnNhdmUtcGxhbicpLm9uKCdjbGljaycsICcuc2F2ZS1wbGFuJywgZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgIGxvZy5lZGl0UGxhbihQTEFOSUQsICQoJyNlZGl0QWN0aW9uUGxhbkl0ZW0nKS52YWwoKSk7XHJcblxyXG4gICAgICAgICQoJyNlZGl0UGxhbicpLm1vZGFsKCdoaWRlJyk7XHJcbiAgICAgIH0pLm9mZigna2V5dXAnLCAnI2VkaXRBY3Rpb25QbGFuSXRlbScpLm9uKCdrZXl1cCcsICcjZWRpdEFjdGlvblBsYW5JdGVtJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgIGlmIChlLndoaWNoID09PSAxMykgJCgnI2VkaXRQbGFuIC5zYXZlLXBsYW4nKS5jbGljaygpO1xyXG4gICAgICB9KS5tb2RhbCgpO1xyXG4gICAgfSkub24oJ2NsaWNrJywgJy5kZWxldGUtcGxhbicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgUExBTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoXCJpZFwiKTtcclxuXHJcbiAgICAgICQoJyN0ZWFtLWRlbGV0ZS1pdGVtJykuaHRtbCgkKCQodGhpcykuY2xvc2VzdCgndHInKS5jaGlsZHJlbigndGQnKVsyXSkuZmluZCgnc3BhbicpLnRleHQoKSk7XHJcblxyXG4gICAgICAkKCcjZGVsZXRlUGxhbicpLm9mZignaGlkZGVuLmJzLm1vZGFsJykub24oJ2hpZGRlbi5icy5tb2RhbCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHdlbGNvbWUucG9wdWxhdGUoISQoJyNvdXRzdGFuZGluZ1Rhc2tzJykucGFyZW50KCkuaGFzQ2xhc3MoXCJhY3RpdmVcIikpO1xyXG4gICAgICB9KS5vZmYoJ2NsaWNrJywgJy5kZWxldGUtcGxhbicpLm9uKCdjbGljaycsICcuZGVsZXRlLXBsYW4nLCBmdW5jdGlvbigpIHtcclxuICAgICAgICBsb2cuZGVsZXRlUGxhbihQTEFOSUQpO1xyXG5cclxuICAgICAgICAkKCcjZGVsZXRlUGxhbicpLm1vZGFsKCdoaWRlJyk7XHJcbiAgICAgIH0pLm1vZGFsKCk7XHJcbiAgICB9KS5vbignY2xpY2snLCAnLmJ0bi11bmRvJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICB2YXIgQUNUSU9OSUQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YSgnaWQnKTtcclxuICAgICAgdmFyIHBhdGllbnRJZCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5kYXRhKCd0ZWFtLW9yLXBhdGllbnQtaWQnKTtcclxuICAgICAgbG9nLmVkaXRBY3Rpb24ocGF0aWVudElkLCBBQ1RJT05JRCwgbnVsbCwgZmFsc2UpO1xyXG4gICAgICAkKHRoaXMpLnJlcGxhY2VXaXRoKGJhc2UuY3JlYXRlUGFuZWwoJCgnI2NoZWNrYm94LXRlbXBsYXRlJyksIHtcclxuICAgICAgICBcImRvbmVcIjogZmFsc2VcclxuICAgICAgfSkpO1xyXG4gICAgICB3ZWxjb21lLnVwZGF0ZVdlbGNvbWVQYWdlKCk7XHJcbiAgICB9KS5vbignY2xpY2snLCAnLmJ0bi15ZXMsLmJ0bi1ubycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgdmFyIGNoZWNrYm94ID0gJCh0aGlzKS5maW5kKFwiaW5wdXRbdHlwZT1jaGVja2JveF1cIik7XHJcbiAgICAgIHZhciBvdGhlciA9ICQodGhpcykucGFyZW50KCkuZmluZCgkKHRoaXMpLmhhc0NsYXNzKFwiYnRuLXllc1wiKSA/IFwiLmJ0bi1ub1wiIDogXCIuYnRuLXllc1wiKTtcclxuICAgICAgdmFyIEFDVElPTklEID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmRhdGEoJ2lkJyk7XHJcbiAgICAgIHZhciBwYXRpZW50SWQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZGF0YSgndGVhbS1vci1wYXRpZW50LWlkJyk7XHJcbiAgICAgIGlmICgkKHRoaXMpLmhhc0NsYXNzKFwiYWN0aXZlXCIpICYmIG90aGVyLmhhc0NsYXNzKFwiaW5hY3RpdmVcIikgJiYgISQodGhpcykuY2xvc2VzdCgndHInKS5oYXNDbGFzcygnc3VjY2VzcycpKSB7XHJcbiAgICAgICAgLy91bnNlbGVjdGluZ1xyXG4gICAgICAgIGlmIChjaGVja2JveC52YWwoKSA9PT0gXCJub1wiKSB7XHJcbiAgICAgICAgICBpbmRpdmlkdWFsQWN0aW9uUGxhbi5sYXVuY2hNb2RhbChkYXRhLnNlbGVjdGVkLCBjaGVja2JveC5jbG9zZXN0KCd0cicpLmNoaWxkcmVuKCc6bnRoKDIpJykuZmluZCgnc3BhbicpLnRleHQoKSwgbG9nLmdldFJlYXNvbihwYXRpZW50SWQsIEFDVElPTklEKSwgdHJ1ZSwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGxvZy5lZGl0QWN0aW9uKHBhdGllbnRJZCwgQUNUSU9OSUQsIGZhbHNlLCBudWxsLCBsb2cucmVhc29uKTtcclxuICAgICAgICAgICAgd2VsY29tZS51cGRhdGVXZWxjb21lUGFnZSgpO1xyXG4gICAgICAgICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICAgICAgICB9LCBudWxsLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgbG9nLmlnbm9yZUFjdGlvbihwYXRpZW50SWQsIEFDVElPTklEKTtcclxuICAgICAgICAgICAgb3RoZXIucmVtb3ZlQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgY2hlY2tib3gucmVtb3ZlQXR0cihcImNoZWNrZWRcIik7XHJcbiAgICAgICAgICAgIGNoZWNrYm94LnBhcmVudCgpLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICB3ZWxjb21lLnVwZGF0ZVdlbGNvbWVQYWdlKCk7XHJcbiAgICAgICAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgbG9nLmlnbm9yZUFjdGlvbihwYXRpZW50SWQsIEFDVElPTklEKTtcclxuICAgICAgICAgIG90aGVyLnJlbW92ZUNsYXNzKFwiaW5hY3RpdmVcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2UgaWYgKCghJCh0aGlzKS5oYXNDbGFzcyhcImFjdGl2ZVwiKSAmJiBvdGhlci5oYXNDbGFzcyhcImFjdGl2ZVwiKSkgfHwgJCh0aGlzKS5jbG9zZXN0KCd0cicpLmhhc0NsYXNzKCdzdWNjZXNzJykpIHtcclxuICAgICAgICAvL3ByZXZlbnQgY2xpY2tpbmcgb24gdW5zZWxlY3RlZCBvcHRpb24gb3IgaWYgdGhlIHJvdyBpcyBjb21wbGV0ZVxyXG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvL3NlbGVjdGluZ1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBpZiAoY2hlY2tib3gudmFsKCkgPT09IFwibm9cIikge1xyXG4gICAgICAgICAgaW5kaXZpZHVhbEFjdGlvblBsYW4ubGF1bmNoTW9kYWwoZGF0YS5zZWxlY3RlZCwgY2hlY2tib3guY2xvc2VzdCgndHInKS5jaGlsZHJlbignOm50aCgyKScpLmZpbmQoJ3NwYW4nKS50ZXh0KCksIGxvZy5nZXRSZWFzb24ocGF0aWVudElkLCBBQ1RJT05JRCksIGZhbHNlLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgbG9nLmVkaXRBY3Rpb24ocGF0aWVudElkLCBBQ1RJT05JRCwgZmFsc2UsIG51bGwsIGxvZy5yZWFzb24pO1xyXG4gICAgICAgICAgICAkKHNlbGYpLnJlbW92ZUNsYXNzKFwiaW5hY3RpdmVcIik7XHJcblxyXG4gICAgICAgICAgICBjaGVja2JveC5hdHRyKFwiY2hlY2tlZFwiLCBcImNoZWNrZWRcIik7XHJcbiAgICAgICAgICAgIGNoZWNrYm94LnBhcmVudCgpLmFkZENsYXNzKFwiYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICAvL3Vuc2VsZWN0IG90aGVyXHJcbiAgICAgICAgICAgIG90aGVyLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpLmFkZENsYXNzKFwiaW5hY3RpdmVcIik7XHJcbiAgICAgICAgICAgIG90aGVyLmZpbmQoXCJpbnB1dFt0eXBlPWNoZWNrYm94XVwiKS5wcm9wKFwiY2hlY2tlZFwiLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIHdlbGNvbWUudXBkYXRlV2VsY29tZVBhZ2UoKTtcclxuICAgICAgICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBsb2cuZWRpdEFjdGlvbihwYXRpZW50SWQsIEFDVElPTklELCB0cnVlKTtcclxuICAgICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoXCJpbmFjdGl2ZVwiKTtcclxuXHJcbiAgICAgICAgICAvL3Vuc2VsZWN0IG90aGVyXHJcbiAgICAgICAgICBvdGhlci5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKS5hZGRDbGFzcyhcImluYWN0aXZlXCIpO1xyXG4gICAgICAgICAgb3RoZXIuZmluZChcImlucHV0W3R5cGU9Y2hlY2tib3hdXCIpLnByb3AoXCJjaGVja2VkXCIsIGZhbHNlKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHdlbGNvbWUudXBkYXRlV2VsY29tZVBhZ2UoKTtcclxuICB9LFxyXG5cclxuICB1cGRhdGVXZWxjb21lUGFnZTogZnVuY3Rpb24oKSB7XHJcbiAgICAkKCcjdGVhbS10YXNrLXBhbmVsJykuYWRkKCcjaW5kaXZpZHVhbC10YXNrLXBhbmVsJykuZmluZCgnLnN1Z2dlc3Rpb24nKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICAkKHRoaXMpLmZpbmQoJ3RkJykubGFzdCgpLmNoaWxkcmVuKCkuaGlkZSgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgJCgnI3RlYW0tdGFzay1wYW5lbCcpLmFkZCgnI2luZGl2aWR1YWwtdGFzay1wYW5lbCcpLmZpbmQoJy5jci1zdHlsZWQgaW5wdXRbdHlwZT1jaGVja2JveF0nKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICBpZiAodGhpcy5jaGVja2VkKSB7XHJcbiAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5wYXJlbnQoKS5wYXJlbnQoKS5hZGRDbGFzcygnc3VjY2VzcycpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgICQodGhpcykucGFyZW50KCkucGFyZW50KCkucGFyZW50KCkucmVtb3ZlQ2xhc3MoJ3N1Y2Nlc3MnKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgJCgnI3RlYW0tdGFzay1wYW5lbCcpLmFkZCgnI2luZGl2aWR1YWwtdGFzay1wYW5lbCcpLmZpbmQoJy5idG4tdW5kbycpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgICQodGhpcykucGFyZW50KCkucGFyZW50KCkuYWRkQ2xhc3MoJ3N1Y2Nlc3MnKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vbm8gY2xhc3MgLSB1c2VyIG5vdCB5ZXQgYWdyZWVkL2Rpc2FncmVlZCAtIG5vIGJhY2tncm91bmQgLyBtdXRlZCB0ZXh0XHJcbiAgICAvL2FjdGl2ZSAtIHVzZXIgYWdyZWVzIC0gZ3JlZW4gYmFja2dyb3VuZCAvIG5vcm1hbCB0ZXh0XHJcbiAgICAvL3N1Y2Nlc3MgLSB1c2VyIGNvbXBsZXRlZCAtIGdyZWVuIGJhY2tncm91bmQgLyBzdHJpa2V0aHJvdWdoIHRleHRcclxuICAgIC8vZGFuZ2VyIC0gdXNlciBkaXNhZ3JlZXMgLSByZWQgYmFja2dyb3VuZCAvIHN0cmlrZXRocm91Z2ggdGV4dFxyXG4gICAgJCgnI3RlYW0tdGFzay1wYW5lbCcpLmFkZCgnI2luZGl2aWR1YWwtdGFzay1wYW5lbCcpLmZpbmQoJ3RyJykuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIHNlbGYgPSAkKHRoaXMpO1xyXG4gICAgICB2YXIgYW55ID0gZmFsc2U7XHJcbiAgICAgIHNlbGYuZmluZCgnLmJ0bi10b2dnbGUgaW5wdXRbdHlwZT1jaGVja2JveF06Y2hlY2tlZCcpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgYW55ID0gdHJ1ZTtcclxuICAgICAgICBpZiAodGhpcy52YWx1ZSA9PT0gXCJ5ZXNcIikge1xyXG4gICAgICAgICAgc2VsZi5yZW1vdmVDbGFzcygnZGFuZ2VyJyk7XHJcbiAgICAgICAgICBzZWxmLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgIHNlbGYuZmluZCgndGQnKS5sYXN0KCkuY2hpbGRyZW4oKS5zaG93KCk7XHJcbiAgICAgICAgICBpZiAobG9nLmdldEFjdGlvbnMoKS50ZWFtW3NlbGYuZGF0YShcImlkXCIpXSAmJiBsb2cuZ2V0QWN0aW9ucygpLnRlYW1bc2VsZi5kYXRhKFwiaWRcIildLmhpc3RvcnkpIHtcclxuICAgICAgICAgICAgdmFyIHRvb2wgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuaGFzQ2xhc3MoJ3N1Y2Nlc3MnKSA/IFwiXCIgOiBcIjxwPlwiICsgbG9nLmdldEFjdGlvbnMoKS50ZWFtW3NlbGYuZGF0YShcImlkXCIpXS5oaXN0b3J5WzBdICsgXCI8L3A+PHA+Q2xpY2sgYWdhaW4gdG8gY2FuY2VsPC9wPlwiO1xyXG4gICAgICAgICAgICAkKHRoaXMpLnBhcmVudCgpLmF0dHIoXCJ0aXRsZVwiLCB0b29sKS5hdHRyKFwiZGF0YS1vcmlnaW5hbC10aXRsZVwiLCB0b29sKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICQodGhpcykucGFyZW50KCkuYXR0cihcInRpdGxlXCIsIFwiWW91IGFncmVlZCAtIGNsaWNrIGFnYWluIHRvIGNhbmNlbFwiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ2hpZGUnKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgc2VsZi5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgICBzZWxmLmFkZENsYXNzKCdkYW5nZXInKTtcclxuICAgICAgICAgIHNlbGYucmVtb3ZlQ2xhc3MoJ3N1Y2Nlc3MnKTtcclxuICAgICAgICAgIGlmIChsb2cuZ2V0QWN0aW9ucygpLnRlYW1bc2VsZi5kYXRhKFwiaWRcIildICYmIGxvZy5nZXRBY3Rpb25zKCkudGVhbVtzZWxmLmRhdGEoXCJpZFwiKV0uaGlzdG9yeSkge1xyXG4gICAgICAgICAgICAkKHRoaXMpLnBhcmVudCgpLmF0dHIoXCJ0aXRsZVwiLCBcIjxwPlwiICsgbG9nLmdldEFjdGlvbnMoKS50ZWFtW3NlbGYuZGF0YShcImlkXCIpXS5oaXN0b3J5WzBdICsgXCI8L3A+PHA+Q2xpY2sgYWdhaW4gdG8gZWRpdC9jYW5jZWw8L3A+XCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5hdHRyKFwidGl0bGVcIiwgXCJZb3UgZGlzYWdyZWVkIC0gY2xpY2sgYWdhaW4gdG8gZWRpdC9jYW5jZWxcIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgICAgaWYgKHNlbGYuZmluZCgnLmJ0bi10b2dnbGUgaW5wdXRbdHlwZT1jaGVja2JveF06bm90KDpjaGVja2VkKScpLmxlbmd0aCA9PSAxKSB7XHJcbiAgICAgICAgc2VsZi5maW5kKCcuYnRuLXRvZ2dsZSBpbnB1dFt0eXBlPWNoZWNrYm94XTpub3QoOmNoZWNrZWQpJykucGFyZW50KCkuYWRkQ2xhc3MoXCJpbmFjdGl2ZVwiKS5hdHRyKFwidGl0bGVcIiwgXCJcIikuYXR0cihcImRhdGEtb3JpZ2luYWwtdGl0bGVcIiwgXCJcIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKCFhbnkpIHtcclxuICAgICAgICBzZWxmLnJlbW92ZUNsYXNzKCdkYW5nZXInKTtcclxuICAgICAgICBzZWxmLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICBzZWxmLnJlbW92ZUNsYXNzKCdzdWNjZXNzJyk7XHJcblxyXG4gICAgICAgIHNlbGYuZmluZCgnLmJ0bi10b2dnbGUuYnRuLXllcycpLmF0dHIoXCJ0aXRsZVwiLCBcIkNsaWNrIHRvIGFncmVlIHdpdGggdGhpcyBhY3Rpb24gYW5kIHNhdmUgaXQgaW4geW91ciBhZ3JlZWQgYWN0aW9ucyBsaXN0ICBcIikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdoaWRlJyk7XHJcbiAgICAgICAgc2VsZi5maW5kKCcuYnRuLXRvZ2dsZS5idG4tbm8nKS5hdHRyKFwidGl0bGVcIiwgXCJDbGljayB0byBkaXNhZ3JlZSB3aXRoIHRoaXMgYWN0aW9uIGFuZCByZW1vdmUgaXQgZnJvbSB5b3VyIHN1Z2dlc3RlZCBhY3Rpb25zIGxpc3QgXCIpLnRvb2x0aXAoJ2ZpeFRpdGxlJykudG9vbHRpcCgnaGlkZScpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBiYXNlLndpcmVVcFRvb2x0aXBzKCk7XHJcbiAgfSxcclxuXHJcbiAgcG9wdWxhdGU6IGZ1bmN0aW9uKGNvbXBsZXRlKSB7XHJcblxyXG4gICAgdmFyIGssbDtcclxuICAgIC8vYWRkIHRhc2tzXHJcbiAgICB2YXIgdGVhbVRhc2tzID0gW107XHJcbiAgICB2YXIgaW5kaXZpZHVhbFRhc2tzID0gW107XHJcblxyXG4gICAgLy9BZGQgdGhlIHRlYW0gdGFza3NcclxuICAgIGZvciAoayBpbiBsb2cubGlzdEFjdGlvbnMoXCJ0ZWFtXCIpKSB7XHJcbiAgICAgIGlmIChsb2cubGlzdEFjdGlvbnMoXCJ0ZWFtXCIpW2tdLmFncmVlICYmICgoIWxvZy5saXN0QWN0aW9ucyhcInRlYW1cIilba10uZG9uZSAmJiAhY29tcGxldGUpIHx8IChsb2cubGlzdEFjdGlvbnMoXCJ0ZWFtXCIpW2tdLmRvbmUgJiYgY29tcGxldGUpKSkge1xyXG4gICAgICAgIHRlYW1UYXNrcy5wdXNoKHtcclxuICAgICAgICAgIFwicGF0aHdheVwiOiBcIk4vQVwiLFxyXG4gICAgICAgICAgXCJ0YXNrXCI6IGxvZy50ZXh0W2xvZy5saXN0QWN0aW9ucyhcInRlYW1cIilba10uaWRdLnRleHQsXHJcbiAgICAgICAgICBcImRhdGFcIjogbG9nLmxpc3RBY3Rpb25zKFwidGVhbVwiKVtrXS5pZCxcclxuICAgICAgICAgIFwidHBJZFwiOiBcInRlYW1cIixcclxuICAgICAgICAgIFwiYWdyZWVcIjogdHJ1ZSxcclxuICAgICAgICAgIFwiZG9uZVwiOiBjb21wbGV0ZVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy9BZGQgdGhlIHVzZXIgYWRkZWQgdGVhbSB0YXNrc1xyXG4gICAgZm9yIChrIGluIGxvZy5saXN0UGxhbnMoXCJ0ZWFtXCIpKSB7XHJcbiAgICAgIGlmICgoIWxvZy5saXN0UGxhbnMoXCJ0ZWFtXCIpW2tdLmRvbmUgJiYgIWNvbXBsZXRlKSB8fCAobG9nLmxpc3RQbGFucyhcInRlYW1cIilba10uZG9uZSAmJiBjb21wbGV0ZSkpIHtcclxuICAgICAgICB0ZWFtVGFza3MucHVzaCh7XHJcbiAgICAgICAgICBcImNhbkVkaXRcIjogdHJ1ZSxcclxuICAgICAgICAgIFwicGF0aHdheVwiOiBkYXRhLnBhdGh3YXlOYW1lc1tsb2cubGlzdFBsYW5zKFwidGVhbVwiKVtrXS5wYXRod2F5SWRdLFxyXG4gICAgICAgICAgXCJwYXRod2F5SWRcIjogbG9nLmxpc3RQbGFucyhcInRlYW1cIilba10ucGF0aHdheUlkLFxyXG4gICAgICAgICAgXCJ0YXNrXCI6IGxvZy5saXN0UGxhbnMoXCJ0ZWFtXCIpW2tdLnRleHQsXHJcbiAgICAgICAgICBcImRhdGFcIjogbG9nLmxpc3RQbGFucyhcInRlYW1cIilba10uaWQsXHJcbiAgICAgICAgICBcImFncmVlXCI6IGxvZy5saXN0UGxhbnMoXCJ0ZWFtXCIpW2tdLmFncmVlLFxyXG4gICAgICAgICAgXCJkaXNhZ3JlZVwiOiBsb2cubGlzdFBsYW5zKFwidGVhbVwiKVtrXS5hZ3JlZSA9PT0gZmFsc2UsXHJcbiAgICAgICAgICBcImRvbmVcIjogY29tcGxldGVcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vQWRkIGluZGl2aWR1YWxcclxuICAgIGZvciAoayBpbiBsb2cubGlzdEFjdGlvbnMoKSkge1xyXG4gICAgICBpZiAoayA9PT0gXCJ0ZWFtXCIpIGNvbnRpbnVlO1xyXG4gICAgICBmb3IgKGwgaW4gbG9nLmxpc3RBY3Rpb25zKClba10pIHtcclxuICAgICAgICBpZiAobG9nLnRleHRbbF0gJiYgbG9nLmxpc3RBY3Rpb25zKClba11bbF0uYWdyZWUgJiYgKCghbG9nLmxpc3RBY3Rpb25zKClba11bbF0uZG9uZSAmJiAhY29tcGxldGUpIHx8IChsb2cubGlzdEFjdGlvbnMoKVtrXVtsXS5kb25lICYmIGNvbXBsZXRlKSkpIHtcclxuICAgICAgICAgIGluZGl2aWR1YWxUYXNrcy5wdXNoKHtcclxuICAgICAgICAgICAgXCJwYXRod2F5XCI6IFwiTi9BXCIsXHJcbiAgICAgICAgICAgIFwicGF0aWVudElkXCI6IGssXHJcbiAgICAgICAgICAgIFwidGFza1wiOiBsb2cudGV4dFtsXS50ZXh0LFxyXG4gICAgICAgICAgICBcInBhdGh3YXlJZFwiOiBsb2cubGlzdFBsYW5zKClba11bbF0ucGF0aHdheUlkLFxyXG4gICAgICAgICAgICBcImRhdGFcIjogbCxcclxuICAgICAgICAgICAgXCJ0cElkXCI6IGssXHJcbiAgICAgICAgICAgIFwiYWdyZWVcIjogdHJ1ZSxcclxuICAgICAgICAgICAgXCJkb25lXCI6IGNvbXBsZXRlXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvL0FkZCBjdXN0b20gaW5kaXZpZHVhbFxyXG4gICAgZm9yIChrIGluIGxvZy5saXN0UGxhbnMoKSkge1xyXG4gICAgICBpZiAoayA9PT0gXCJ0ZWFtXCIpIGNvbnRpbnVlO1xyXG4gICAgICBmb3IgKGwgaW4gbG9nLmxpc3RQbGFucygpW2tdKSB7XHJcbiAgICAgICAgaWYgKGxvZy5saXN0UGxhbnMoKVtrXVtsXS50ZXh0ICYmICghbG9nLmxpc3RQbGFucygpW2tdW2xdLmRvbmUgJiYgIWNvbXBsZXRlKSB8fCAobG9nLmxpc3RQbGFucygpW2tdW2xdLmRvbmUgJiYgY29tcGxldGUpKSB7XHJcbiAgICAgICAgICBpbmRpdmlkdWFsVGFza3MucHVzaCh7XHJcbiAgICAgICAgICAgIFwiY2FuRWRpdFwiOiB0cnVlLFxyXG4gICAgICAgICAgICBcInBhdGh3YXlcIjogZGF0YS5wYXRod2F5TmFtZXNbbG9nLmxpc3RQbGFucygpW2tdW2xdLnBhdGh3YXlJZF0sXHJcbiAgICAgICAgICAgIFwicGF0aHdheUlkXCI6IGxvZy5saXN0UGxhbnMoKVtrXVtsXS5wYXRod2F5SWQsXHJcbiAgICAgICAgICAgIFwicGF0aWVudElkXCI6IGssXHJcbiAgICAgICAgICAgIFwidHBJZFwiOiBrLFxyXG4gICAgICAgICAgICBcInRhc2tcIjogbG9nLmxpc3RQbGFucygpW2tdW2xdLnRleHQsXHJcbiAgICAgICAgICAgIFwiZGF0YVwiOiBsLFxyXG4gICAgICAgICAgICBcImFncmVlXCI6IHRydWUsXHJcbiAgICAgICAgICAgIFwiZG9uZVwiOiBjb21wbGV0ZVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIGxpc3RUZW1wbGF0ZSA9ICQoJyN3ZWxjb21lLXRhc2stbGlzdCcpLmh0bWwoKTtcclxuICAgIE11c3RhY2hlLnBhcnNlKGxpc3RUZW1wbGF0ZSk7XHJcbiAgICAkKCcjd2VsY29tZS10YWItY29udGVudCcpLmh0bWwoTXVzdGFjaGUucmVuZGVyKGxpc3RUZW1wbGF0ZSkpO1xyXG5cclxuICAgIHZhciBhZGRUZW1wbGF0ZSA9ICQoJyNhY3Rpb24tcGxhbicpLmh0bWwoKTtcclxuICAgIE11c3RhY2hlLnBhcnNlKGFkZFRlbXBsYXRlKTtcclxuICAgIHZhciByZW5kZXJlZCA9IE11c3RhY2hlLnJlbmRlcihhZGRUZW1wbGF0ZSk7XHJcbiAgICAkKCcjdGVhbS1hZGQtcGxhbicpLmh0bWwocmVuZGVyZWQpO1xyXG5cclxuICAgIHZhciB0ZW1wTXVzdCA9ICQoJyN3ZWxjb21lLXRhc2staXRlbXMnKS5odG1sKCk7XHJcbiAgICB2YXIgaXRlbVRlbXBsYXRlID0gJCgnI3dlbGNvbWUtdGFzay1pdGVtJykuaHRtbCgpO1xyXG4gICAgTXVzdGFjaGUucGFyc2UodGVtcE11c3QpO1xyXG4gICAgTXVzdGFjaGUucGFyc2UoaXRlbVRlbXBsYXRlKTtcclxuXHJcbiAgICAkKCcjdGVhbS1hZGQtcGxhbicpLm9mZignY2xpY2snKS5vbignY2xpY2snLCAnLmFkZC1wbGFuJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBwbGFuID0gJCh0aGlzKS5wYXJlbnQoKS5wYXJlbnQoKS5maW5kKCd0ZXh0YXJlYScpLnZhbCgpO1xyXG4gICAgICB2YXIgcGxhbklkID0gcmVjb3JkUGxhbihcInRlYW1cIiwgcGxhbiwgXCJjdXN0b21cIik7XHJcbiAgICAgICQoJyN0ZWFtLXRhc2stcGFuZWwnKS5maW5kKCd0YWJsZSB0Ym9keScpLmFwcGVuZChNdXN0YWNoZS5yZW5kZXIoaXRlbVRlbXBsYXRlLCB7XHJcbiAgICAgICAgXCJwYXRod2F5XCI6IFwiXCIsXHJcbiAgICAgICAgXCJwYXRod2F5SWRcIjogXCJjdXN0b21cIixcclxuICAgICAgICBcImNhbkVkaXRcIjogdHJ1ZSxcclxuICAgICAgICBcInRhc2tcIjogcGxhbixcclxuICAgICAgICBcImRhdGFcIjogcGxhbklkLFxyXG4gICAgICAgIFwiYWdyZWVcIjogbnVsbCxcclxuICAgICAgICBcImRvbmVcIjogbnVsbFxyXG4gICAgICB9LCB7XHJcbiAgICAgICAgXCJjaGtcIjogJCgnI2NoZWNrYm94LXRlbXBsYXRlJykuaHRtbCgpXHJcbiAgICAgIH0pKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJlbmRlcmVkID0gTXVzdGFjaGUucmVuZGVyKHRlbXBNdXN0LCB7XHJcbiAgICAgIFwidGFza3NcIjogdGVhbVRhc2tzLFxyXG4gICAgICBcImhhc1Rhc2tzXCI6IHRlYW1UYXNrcy5sZW5ndGggPiAwXHJcbiAgICB9LCB7XHJcbiAgICAgIFwidGFzay1pdGVtXCI6IGl0ZW1UZW1wbGF0ZSxcclxuICAgICAgXCJjaGtcIjogJCgnI2NoZWNrYm94LXRlbXBsYXRlJykuaHRtbCgpXHJcbiAgICB9KTtcclxuICAgICQoJyN0ZWFtLXRhc2stcGFuZWwnKS5jaGlsZHJlbigpLm5vdChcIjpmaXJzdFwiKS5yZW1vdmUoKTtcclxuICAgICQoJyN0ZWFtLXRhc2stcGFuZWwnKS5hcHBlbmQocmVuZGVyZWQpO1xyXG5cclxuICAgIHJlbmRlcmVkID0gTXVzdGFjaGUucmVuZGVyKHRlbXBNdXN0LCB7XHJcbiAgICAgIFwidGFza3NcIjogaW5kaXZpZHVhbFRhc2tzLFxyXG4gICAgICBcImlzUGF0aWVudFRhYmxlXCI6IHRydWUsXHJcbiAgICAgIFwiaGFzVGFza3NcIjogaW5kaXZpZHVhbFRhc2tzLmxlbmd0aCA+IDBcclxuICAgIH0sIHtcclxuICAgICAgXCJ0YXNrLWl0ZW1cIjogaXRlbVRlbXBsYXRlLFxyXG4gICAgICBcImNoa1wiOiAkKCcjY2hlY2tib3gtdGVtcGxhdGUnKS5odG1sKClcclxuICAgIH0pO1xyXG4gICAgJCgnI2luZGl2aWR1YWwtdGFzay1wYW5lbCcpLmNoaWxkcmVuKCkubm90KFwiOmZpcnN0XCIpLnJlbW92ZSgpO1xyXG4gICAgJCgnI2luZGl2aWR1YWwtdGFzay1wYW5lbCcpLmFwcGVuZChyZW5kZXJlZCk7XHJcblxyXG4gICAgd2VsY29tZS53aXJlVXBXZWxjb21lUGFnZSgpO1xyXG4gIH1cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHdlbGNvbWU7XHJcbiIsInZhciBkYXRhID0gcmVxdWlyZSgnLi4vZGF0YS5qcycpLFxyXG4gIGNoYXJ0ID0gcmVxdWlyZSgnLi4vY2hhcnQuanMnKTtcclxuXHJcbnZhciBiZCA9IHtcclxuXHJcbiAgd2lyZVVwOiBmdW5jdGlvbigpIHtcclxuXHJcbiAgfSxcclxuXHJcbiAgc2hvdzogZnVuY3Rpb24ocGFuZWwsIGlzQXBwZW5kLCBzdWJQYW5lbHMsIGlzRG93blRleHQsIGlzVXBUZXh0KSB7XHJcblxyXG4gICAgdmFyIHNlY3Rpb25FbGVtZW50ID0gJCgnPGRpdiBjbGFzcz1cInNlY3Rpb25cIj48L2Rpdj4nKTtcclxuXHJcbiAgICBpZiAoaXNBcHBlbmQpIHBhbmVsLmFwcGVuZChzZWN0aW9uRWxlbWVudCk7XHJcbiAgICBlbHNlIHBhbmVsLmh0bWwoc2VjdGlvbkVsZW1lbnQpO1xyXG5cclxuICAgIHN1YlBhbmVscy5mb3JFYWNoKGZ1bmN0aW9uKHYpIHtcclxuICAgICAgdmFyIGFyZ3MgPSB2LmFyZ3M7XHJcbiAgICAgIGFyZ3MudW5zaGlmdCh0cnVlKTtcclxuICAgICAgYXJncy51bnNoaWZ0KHNlY3Rpb25FbGVtZW50KTtcclxuICAgICAgdi5zaG93LmFwcGx5KG51bGwsIGFyZ3MpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKGlzVXBUZXh0KSBzZWN0aW9uRWxlbWVudC5wcmVwZW5kKCQoJzxkaXYgY2xhc3M9XCJmcC1jb250cm9sQXJyb3cgZnAtdXBcIj48ZGl2PicgKyBpc1VwVGV4dCArICc8L2Rpdj48L2Rpdj4nKSk7XHJcbiAgICBpZiAoaXNEb3duVGV4dCkgc2VjdGlvbkVsZW1lbnQuYXBwZW5kKCQoJzxkaXYgY2xhc3M9XCJmcC1jb250cm9sQXJyb3cgZnAtZG93blwiPjxkaXY+JyArIGlzRG93blRleHQgKyAnPC9kaXY+PC9kaXY+JykpO1xyXG5cclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBiZDtcclxuIiwidmFyIGRhdGEgPSByZXF1aXJlKCcuL2RhdGEuanMnKSxcclxuICBsb29rdXAgPSByZXF1aXJlKCcuL2xvb2t1cC5qcycpLFxyXG4gIGJhc2UgPSByZXF1aXJlKCcuL2Jhc2UuanMnKSxcclxuICBwYXRpZW50cyA9IHJlcXVpcmUoJy4vcGFuZWxzL3BhdGllbnRzLmpzJyksXHJcbiAgcGF0aWVudExpc3QgPSByZXF1aXJlKCcuL3BhbmVscy9wYXRpZW50TGlzdC5qcycpLFxyXG4gIHRlYW1BY3Rpb25QbGFuID0gcmVxdWlyZSgnLi9wYW5lbHMvdGVhbUFjdGlvblBsYW4uanMnKSxcclxuICBhbGxQYXRpZW50cyA9IHJlcXVpcmUoJy4vcGFuZWxzL2FsbFBhdGllbnRzLmpzJyksXHJcbiAgd2VsY29tZSA9IHJlcXVpcmUoJy4vcGFuZWxzL3dlbGNvbWUuanMnKSxcclxuICBsYXlvdXQgPSByZXF1aXJlKCcuL2xheW91dC5qcycpLFxyXG4gIG92ZXJ2aWV3ID0gcmVxdWlyZSgnLi92aWV3cy9vdmVydmlldy5qcycpLFxyXG4gIGluZGljYXRvclZpZXcgPSByZXF1aXJlKCcuL3ZpZXdzL2luZGljYXRvci5qcycpLFxyXG4gIHBhdGllbnRWaWV3ID0gcmVxdWlyZSgnLi92aWV3cy9wYXRpZW50LmpzJyksXHJcbiAgYWN0aW9uUGxhbiA9IHJlcXVpcmUoJy4vdmlld3MvYWN0aW9ucy5qcycpLFxyXG4gIE11c3RhY2hlID0gcmVxdWlyZSgnbXVzdGFjaGUnKTtcclxuXHJcbnZhciB0ZW1wbGF0ZSA9IHtcclxuXHJcbiAgbG9hZENvbnRlbnQ6IGZ1bmN0aW9uKGhhc2gsIGlzUG9wcGluZ1N0YXRlKSB7XHJcbiAgICBiYXNlLmhpZGVUb29sdGlwcygpO1xyXG5cclxuICAgIHZhciBpLCBwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIGluZGljYXRvciwgcGF0aWVudElkO1xyXG4gICAgaWYgKCFpc1BvcHBpbmdTdGF0ZSkge1xyXG4gICAgICB3aW5kb3cubG9jYXRpb24uaGFzaCA9IGhhc2g7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGhhc2ggPT09ICcnKSB7XHJcbiAgICAgIGJhc2UuY2xlYXJCb3goKTtcclxuICAgICAgYmFzZS5zaG93Rm9vdGVyKCk7XHJcbiAgICAgIGxheW91dC5zaG93UGFnZSgnbG9naW4nKTtcclxuICAgICAgJCgnaHRtbCcpLnJlbW92ZUNsYXNzKCdzY3JvbGwtYmFyJyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBiYXNlLmhpZGVGb290ZXIoKTtcclxuICAgICAgJCgnaHRtbCcpLmFkZENsYXNzKCdzY3JvbGwtYmFyJyk7XHJcbiAgICAgIHZhciBwYXJhbXMgPSB7fTtcclxuICAgICAgdmFyIHVybEJpdHMgPSBoYXNoLnNwbGl0KCcvJyk7XHJcblxyXG4gICAgICBpZiAoaGFzaC5pbmRleE9mKCc/JykgPiAtMSkge1xyXG4gICAgICAgIGhhc2guc3BsaXQoJz8nKVsxXS5zcGxpdCgnJicpLmZvckVhY2goZnVuY3Rpb24ocGFyYW0pIHtcclxuICAgICAgICAgIHZhciBlbGVtcyA9IHBhcmFtLnNwbGl0KFwiPVwiKTtcclxuICAgICAgICAgIHBhcmFtc1tlbGVtc1swXV0gPSBlbGVtc1sxXTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB1cmxCaXRzID0gaGFzaC5zcGxpdCgnPycpWzBdLnNwbGl0KCcvJyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmICh1cmxCaXRzWzBdID09PSBcIiNvdmVydmlld1wiICYmICF1cmxCaXRzWzFdKSB7XHJcblxyXG4gICAgICAgIG92ZXJ2aWV3LmNyZWF0ZSh0ZW1wbGF0ZS5sb2FkQ29udGVudCk7XHJcblxyXG4gICAgICB9IGVsc2UgaWYgKHVybEJpdHNbMF0gPT09IFwiI2luZGljYXRvcnNcIikge1xyXG5cclxuICAgICAgICBpbmRpY2F0b3JWaWV3LmNyZWF0ZSh1cmxCaXRzWzFdLCB1cmxCaXRzWzJdLCB1cmxCaXRzWzNdLCBwYXJhbXMudGFiIHx8IFwidHJlbmRcIiwgdGVtcGxhdGUubG9hZENvbnRlbnQpO1xyXG5cclxuICAgICAgfSBlbHNlIGlmICh1cmxCaXRzWzBdID09PSBcIiNtYWluXCIpIHtcclxuICAgICAgICBiYXNlLmNsZWFyQm94KCk7XHJcbiAgICAgICAgcGF0aHdheUlkID0gdXJsQml0c1sxXTtcclxuICAgICAgICBkYXRhLnBhdGh3YXlJZCA9IHBhdGh3YXlJZDtcclxuICAgICAgICBwYXRod2F5U3RhZ2UgPSB1cmxCaXRzWzJdO1xyXG4gICAgICAgIHZhciB5ZXNQZW9wbGUgPSB1cmxCaXRzWzNdICE9PSBcIm5vXCI7XHJcbiAgICAgICAgc3RhbmRhcmQgPSB1cmxCaXRzWzRdO1xyXG5cclxuICAgICAgICBpZiAocGF0aHdheVN0YWdlICYmIGxheW91dC5wYWdlICE9PSAnbWFpbi1kYXNoYm9hcmQnKSB7XHJcbiAgICAgICAgICAkKCcucGFnZScpLmhpZGUoKTtcclxuICAgICAgICAgICQoJyNtYWluLWRhc2hib2FyZCcpLnNob3coKTtcclxuXHJcbiAgICAgICAgICAvLy8vbGF5b3V0LnNob3dTaWRlUGFuZWwoKTtcclxuICAgICAgICAgIGxheW91dC5zaG93T3ZlcnZpZXdQYW5lbHMoKTtcclxuICAgICAgICAgIGxheW91dC5zaG93SGVhZGVyQmFySXRlbXMoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChwYXRod2F5U3RhZ2UpIHtcclxuICAgICAgICAgIGlmICh5ZXNQZW9wbGUpIHtcclxuICAgICAgICAgICAgdGVtcGxhdGUuc2hvd1BhdGh3YXlTdGFnZVZpZXdPayhwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgdGVtcGxhdGUuc2hvdWxkV2VGYWRlKGxvb2t1cC5jdXJyZW50VXJsLCBoYXNoKSk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0ZW1wbGF0ZS5zaG93UGF0aHdheVN0YWdlVmlldyhwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHRlbXBsYXRlLnNob3VsZFdlRmFkZShsb29rdXAuY3VycmVudFVybCwgaGFzaCkpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB0ZW1wbGF0ZS5zaG93T3ZlcnZpZXcocGF0aHdheUlkKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuXHJcbiAgICAgIH0gZWxzZSBpZiAodXJsQml0c1swXSA9PT0gXCIjaGVscFwiKSB7XHJcbiAgICAgICAgYmFzZS5jbGVhckJveCgpO1xyXG4gICAgICAgIGJhc2Uuc2VsZWN0VGFiKFwiXCIpO1xyXG4gICAgICAgIGxheW91dC5zaG93UGFnZSgnaGVscC1wYWdlJyk7XHJcblxyXG4gICAgICAgIGxheW91dC5zaG93SGVhZGVyQmFySXRlbXMoKTtcclxuXHJcbiAgICAgIH0gZWxzZSBpZiAodXJsQml0c1swXSA9PT0gXCIjcGF0aWVudFwiKSB7XHJcblxyXG4gICAgICAgIC8vY3JlYXRlKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgcGF0aWVudElkKVxyXG4gICAgICAgIHBhdGllbnRWaWV3LmNyZWF0ZSh1cmxCaXRzWzJdLCB1cmxCaXRzWzNdLCB1cmxCaXRzWzRdLCB1cmxCaXRzWzFdLCB0ZW1wbGF0ZS5sb2FkQ29udGVudCk7XHJcblxyXG4gICAgICB9IGVsc2UgaWYgKHVybEJpdHNbMF0gPT09IFwiI3BhdGllbnRzXCIpIHtcclxuXHJcbiAgICAgICAgcGF0aWVudElkID0gdXJsQml0c1sxXTtcclxuXHJcbiAgICAgICAgcGF0aWVudFZpZXcuY3JlYXRlKG51bGwsIG51bGwsIG51bGwsIHBhdGllbnRJZCwgdGVtcGxhdGUubG9hZENvbnRlbnQpO1xyXG4gICAgICAgIC8qcGF0aHdheUlkID0gdXJsQml0c1syXTtcclxuXHJcbiAgICAgICAgYWxsUGF0aWVudHMuc2hvd1ZpZXcocGF0aWVudElkLCB0cnVlKTtcclxuXHJcbiAgICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG5cclxuICAgICAgICBpZiAocGF0aWVudElkKSB7XHJcbiAgICAgICAgICB2YXIgbmhzID0gZGF0YS5wYXRMb29rdXAgPyBkYXRhLnBhdExvb2t1cFtwYXRpZW50SWRdIDogcGF0aWVudElkO1xyXG4gICAgICAgICAgJCgnI3BhdGllbnRzJykuZmluZCgnZGl2LnRhYmxlLXNjcm9sbCcpLmdldE5pY2VTY3JvbGwoKS5kb1Njcm9sbFBvcygwLCAkKCcjcGF0aWVudHMgdGQnKS5maWx0ZXIoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkKHRoaXMpLnRleHQoKS50cmltKCkgPT09IG5ocztcclxuICAgICAgICAgIH0pLnBvc2l0aW9uKCkudG9wIC0gMTQwKTtcclxuICAgICAgICAgICQoJyNwYXRpZW50cycpLmZpbmQoJ3RyOmNvbnRhaW5zKCcgKyBuaHMgKyAnKScpLmFkZENsYXNzKFwiaGlnaGxpZ2h0ZWRcIik7XHJcbiAgICAgICAgfSovXHJcbiAgICAgIH0gZWxzZSBpZiAodXJsQml0c1swXSA9PT0gXCIjYWdyZWVkYWN0aW9uc1wiKSB7XHJcblxyXG4gICAgICAgIGFjdGlvblBsYW4uY3JlYXRlKCk7XHJcblxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vaWYgc2NyZWVuIG5vdCBpbiBjb3JyZWN0IHNlZ21lbnQgdGhlbiBzZWxlY3QgaXRcclxuICAgICAgICBhbGVydChcInNob3VsZG4ndCBnZXQgaGVyZVwiKTtcclxuICAgICAgICBwYXRod2F5U3RhZ2UgPSBoYXNoLnN1YnN0cigxKTtcclxuXHJcbiAgICAgICAgdGVtcGxhdGUuc2hvd1BhdGh3YXlTdGFnZVZpZXcocGF0aHdheVN0YWdlKTtcclxuXHJcbiAgICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgbG9va3VwLmN1cnJlbnRVcmwgPSBoYXNoO1xyXG4gIH0sXHJcblxyXG4gIC8vU2hvdyB0aGUgb3ZlcnZpZXcgcGFnZSBmb3IgYSBkaXNlYXNlXHJcbiAgc2hvd092ZXJ2aWV3OiBmdW5jdGlvbihkaXNlYXNlKSB7XHJcbiAgICBkYXRhLnBhdGh3YXlJZCA9IGRpc2Vhc2U7XHJcblxyXG4gICAgbGF5b3V0LnNob3dNYWluVmlldyhkYXRhLmRpc2Vhc2VzLm1hcChmdW5jdGlvbih2KSB7XHJcbiAgICAgIHJldHVybiB2LmlkO1xyXG4gICAgfSkuaW5kZXhPZihkaXNlYXNlKSk7XHJcblxyXG4gICAgJCgnYXNpZGUgbGkgdWwgbGknKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAkKCdhc2lkZSBhW2hyZWY9XCIjbWFpbi8nICsgZGlzZWFzZSArICdcIl06Y29udGFpbnMoXCJPdmVydmlld1wiKScpLnBhcmVudCgpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuXHJcbiAgICAkKCcjbWFpblRpdGxlJykuc2hvdygpO1xyXG4gICAgYmFzZS51cGRhdGVUaXRsZShkYXRhLnRleHRbZGF0YS5wYXRod2F5SWRdW1wiZGlzcGxheS1uYW1lXCJdICsgXCI6IE92ZXJ2aWV3IChwcmFjdGljZS1sZXZlbCBkYXRhKVwiKTtcclxuXHJcbiAgICAvL1Nob3cgb3ZlcnZpZXcgcGFuZWxzXHJcbiAgICB0ZW1wbGF0ZS5zaG93T3ZlcnZpZXdQYW5lbHMoKTtcclxuICAgIHRlYW1BY3Rpb25QbGFuLnNob3coZmFyUmlnaHRQYW5lbCk7XHJcbiAgfSxcclxuXHJcbiAgc2hvd092ZXJ2aWV3UGFuZWxzOiBmdW5jdGlvbigpIHtcclxuICAgIGJhc2Uuc3dpdGNoVG8yMjFMYXlvdXQoKTtcclxuXHJcbiAgICB0ZW1wbGF0ZS5zaG93UGFuZWwobG9va3VwLmNhdGVnb3JpZXMuZGlhZ25vc2lzLm5hbWUsIHRvcExlZnRQYW5lbCwgdHJ1ZSk7XHJcbiAgICB0ZW1wbGF0ZS5zaG93UGFuZWwobG9va3VwLmNhdGVnb3JpZXMubW9uaXRvcmluZy5uYW1lLCB0b3BSaWdodFBhbmVsLCB0cnVlKTtcclxuICAgIHRlbXBsYXRlLnNob3dQYW5lbChsb29rdXAuY2F0ZWdvcmllcy50cmVhdG1lbnQubmFtZSwgYm90dG9tTGVmdFBhbmVsLCB0cnVlKTtcclxuICAgIHRlbXBsYXRlLnNob3dQYW5lbChsb29rdXAuY2F0ZWdvcmllcy5leGNsdXNpb25zLm5hbWUsIGJvdHRvbVJpZ2h0UGFuZWwsIHRydWUpO1xyXG5cclxuICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICB9LFxyXG5cclxuICBzaG93UGFuZWw6IGZ1bmN0aW9uKHBhdGh3YXlTdGFnZSwgbG9jYXRpb24sIGVuYWJsZUhvdmVyKSB7XHJcbiAgICBiYXNlLnNob3dQYXRod2F5U3RhZ2VPdmVydmlld1BhbmVsKGxvY2F0aW9uLCBlbmFibGVIb3ZlciwgZGF0YS5wYXRod2F5SWQsIHBhdGh3YXlTdGFnZSk7XHJcblxyXG4gICAgaWYgKGVuYWJsZUhvdmVyKSB0ZW1wbGF0ZS5oaWdobGlnaHRPbkhvdmVyQW5kRW5hYmxlU2VsZWN0QnlDbGljayhsb2NhdGlvbik7XHJcbiAgICBlbHNlIGxvY2F0aW9uLmNoaWxkcmVuKCdkaXYnKS5hZGRDbGFzcygndW5jbGlja2FibGUnKTtcclxuICB9LFxyXG5cclxuICAvL1Nob3cgdGhlIHBhdGh3YXkgc3RhZ2UgZm9yIGEgZGlzZWFzZVxyXG4gIHNob3dQYXRod2F5U3RhZ2VWaWV3OiBmdW5jdGlvbihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHNob3VsZEZhZGUpIHtcclxuICAgIGZhclJpZ2h0UGFuZWwucmVtb3ZlQ2xhc3MoJ3N0YW5kYXJkLW1pc3NlZC1wYWdlJykucmVtb3ZlQ2xhc3MoJ3N0YW5kYXJkLWFjaGlldmVkLXBhZ2UnKS5yZW1vdmVDbGFzcygnc3RhbmRhcmQtbm90LXJlbGV2YW50LXBhZ2UnKTtcclxuICAgIGRhdGEucGF0aHdheUlkID0gcGF0aHdheUlkO1xyXG4gICAgbGF5b3V0LnNob3dNYWluVmlldyhkYXRhLmRpc2Vhc2VzLm1hcChmdW5jdGlvbih2KSB7XHJcbiAgICAgIHJldHVybiB2LmlkO1xyXG4gICAgfSkuaW5kZXhPZihwYXRod2F5SWQpKTtcclxuXHJcbiAgICAkKCdhc2lkZSBsaSB1bCBsaScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgIHZhciByZSA9IG5ldyBSZWdFeHAocGF0aHdheVN0YWdlLCBcImdcIik7XHJcbiAgICAkKCdhc2lkZSBhJykuZmlsdGVyKGZ1bmN0aW9uKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5ocmVmLm1hdGNoKHJlKTtcclxuICAgIH0pLnBhcmVudCgpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuXHJcbiAgICBiYXNlLnN3aXRjaFRvMTEwTGF5b3V0KCk7XHJcblxyXG4gICAgaWYgKCFzdGFuZGFyZCkge1xyXG4gICAgICBzdGFuZGFyZCA9IE9iamVjdC5rZXlzKGRhdGFbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnN0YW5kYXJkcylbMF07XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIHBhbmVsID0gcGF0aWVudHMuY3JlYXRlKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCk7XHJcblxyXG4gICAgaWYgKHNob3VsZEZhZGUpIHtcclxuICAgICAgZmFyTGVmdFBhbmVsLmZhZGVPdXQoMTAwLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAkKHRoaXMpLmh0bWwocGFuZWwpO1xyXG4gICAgICAgIHBhdGllbnRzLndpcmVVcChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgZmFyTGVmdFBhbmVsLCBzdGFuZGFyZCk7XHJcbiAgICAgICAgcGF0aWVudExpc3QucG9wdWxhdGUocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBudWxsKTtcclxuICAgICAgICAkKCcjbWFpblRpdGxlJykuaGlkZSgpO1xyXG4gICAgICAgIGJhc2UudXBkYXRlVGl0bGUoZGF0YS50ZXh0W3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS50ZXh0LnBhZ2UudGV4dCwgZGF0YS50ZXh0W3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS50ZXh0LnBhZ2UudG9vbHRpcCk7XHJcbiAgICAgICAgJCh0aGlzKS5mYWRlSW4oMTAwKTtcclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBmYXJMZWZ0UGFuZWwuaHRtbChwYW5lbCk7XHJcbiAgICAgIHBhdGllbnRzLndpcmVVcChwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgZmFyTGVmdFBhbmVsLCBzdGFuZGFyZCk7XHJcbiAgICAgIHBhdGllbnRMaXN0LnBvcHVsYXRlKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgbnVsbCk7XHJcbiAgICAgICQoJyNtYWluVGl0bGUnKS5oaWRlKCk7XHJcbiAgICAgIGJhc2UudXBkYXRlVGl0bGUoZGF0YS50ZXh0W3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS50ZXh0LnBhZ2UudGV4dCwgZGF0YS50ZXh0W3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS50ZXh0LnBhZ2UudG9vbHRpcCk7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIHRlbXBNdXN0ID0gJCgnI3BhdGllbnQtcGFuZWwtcGxhY2Vob2xkZXInKS5odG1sKCk7XHJcbiAgICBmYXJSaWdodFBhbmVsLmh0bWwoTXVzdGFjaGUucmVuZGVyKHRlbXBNdXN0KSk7XHJcbiAgfSxcclxuXHJcbiAgc2hvd1BhdGh3YXlTdGFnZVZpZXdPazogZnVuY3Rpb24ocGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHNob3VsZEZhZGUpIHtcclxuICAgIGZhclJpZ2h0UGFuZWwucmVtb3ZlQ2xhc3MoJ3N0YW5kYXJkLW1pc3NlZC1wYWdlJykucmVtb3ZlQ2xhc3MoJ3N0YW5kYXJkLWFjaGlldmVkLXBhZ2UnKS5yZW1vdmVDbGFzcygnc3RhbmRhcmQtbm90LXJlbGV2YW50LXBhZ2UnKTtcclxuICAgIGxheW91dC5zaG93TWFpblZpZXcoZGF0YS5kaXNlYXNlcy5tYXAoZnVuY3Rpb24odikge1xyXG4gICAgICByZXR1cm4gdi5pZDtcclxuICAgIH0pLmluZGV4T2YocGF0aHdheUlkKSk7XHJcblxyXG4gICAgJCgnYXNpZGUgbGkgdWwgbGknKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICB2YXIgcmUgPSBuZXcgUmVnRXhwKHBhdGh3YXlTdGFnZSwgXCJnXCIpO1xyXG4gICAgJCgnYXNpZGUgYScpLmZpbHRlcihmdW5jdGlvbigpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuaHJlZi5tYXRjaChyZSk7XHJcbiAgICB9KS5wYXJlbnQoKS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcblxyXG4gICAgYmFzZS5zd2l0Y2hUbzExMExheW91dCgpO1xyXG5cclxuICAgIHZhciBwYW5lbCA9IHBhdGllbnRzLmNyZWF0ZU9rKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlKTtcclxuXHJcbiAgICBpZiAoc2hvdWxkRmFkZSkge1xyXG4gICAgICBmYXJMZWZ0UGFuZWwuZmFkZU91dCgyMDAsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICQodGhpcykuaHRtbChwYW5lbCk7XHJcbiAgICAgICAgcGF0aWVudHMud2lyZVVwT2socGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIGZhckxlZnRQYW5lbCk7XHJcbiAgICAgICAgcGF0aWVudHMucG9wdWxhdGVPayhwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgbnVsbCk7XHJcbiAgICAgICAgJCgnI21haW5UaXRsZScpLmhpZGUoKTtcclxuICAgICAgICBiYXNlLnVwZGF0ZVRpdGxlKGRhdGEudGV4dFtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0udGV4dC5wYWdlLnRleHQsIGRhdGEudGV4dFtwYXRod2F5SWRdW3BhdGh3YXlTdGFnZV0udGV4dC5wYWdlLnRvb2x0aXApO1xyXG4gICAgICAgICQodGhpcykuZmFkZUluKDMwMCk7XHJcbiAgICAgIH0pO1xyXG4gICAgICB2YXIgdGVtcE11c3QgPSAkKCcjcGF0aWVudC1wYW5lbC1wbGFjZWhvbGRlcicpLmh0bWwoKTtcclxuICAgICAgZmFyUmlnaHRQYW5lbC5odG1sKE11c3RhY2hlLnJlbmRlcih0ZW1wTXVzdCkpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgZmFyTGVmdFBhbmVsLmh0bWwocGFuZWwpO1xyXG4gICAgICBwYXRpZW50cy53aXJlVXBPayhwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgZmFyTGVmdFBhbmVsKTtcclxuICAgICAgcGF0aWVudHMucG9wdWxhdGVPayhwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgbnVsbCk7XHJcbiAgICAgICQoJyNtYWluVGl0bGUnKS5oaWRlKCk7XHJcbiAgICAgIGJhc2UudXBkYXRlVGl0bGUoZGF0YS50ZXh0W3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS50ZXh0LnBhZ2UudGV4dCwgZGF0YS50ZXh0W3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS50ZXh0LnBhZ2UudG9vbHRpcCk7XHJcbiAgICB9XHJcbiAgfSxcclxuXHJcbiAgaGlnaGxpZ2h0T25Ib3ZlckFuZEVuYWJsZVNlbGVjdEJ5Q2xpY2s6IGZ1bmN0aW9uKHBhbmVsU2VsZWN0b3IpIHtcclxuICAgIHBhbmVsU2VsZWN0b3IuY2hpbGRyZW4oJ2RpdicpLnJlbW92ZUNsYXNzKCd1bmNsaWNrYWJsZScpLm9uKCdtb3VzZW92ZXInLCBmdW5jdGlvbigpIHtcclxuICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcygncGFuZWwtZGVmYXVsdCcpO1xyXG4gICAgfSkub24oJ21vdXNlb3V0JywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAkKHRoaXMpLmFkZENsYXNzKCdwYW5lbC1kZWZhdWx0Jyk7XHJcbiAgICB9KS5vbignY2xpY2snLCAndHIuc3RhbmRhcmQtcm93JywgZnVuY3Rpb24oZSkge1xyXG4gICAgICBoaXN0b3J5LnB1c2hTdGF0ZShudWxsLCBudWxsLCAnI21haW4vJyArIGRhdGEucGF0aHdheUlkICsgJy8nICsgJCh0aGlzKS5jbG9zZXN0KCcucGFuZWwnKS5kYXRhKCdzdGFnZScpICsgJy9uby8nICsgJCh0aGlzKS5kYXRhKCdzdGFuZGFyZCcpKTtcclxuICAgICAgdGVtcGxhdGUubG9hZENvbnRlbnQoJyNtYWluLycgKyBkYXRhLnBhdGh3YXlJZCArICcvJyArICQodGhpcykuY2xvc2VzdCgnLnBhbmVsJykuZGF0YSgnc3RhZ2UnKSArICcvbm8vJyArICQodGhpcykuZGF0YSgnc3RhbmRhcmQnKSwgdHJ1ZSk7XHJcbiAgICAgIC8vIGRvIG5vdCBnaXZlIGEgZGVmYXVsdCBhY3Rpb25cclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9KS5vbignY2xpY2snLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIC8vIGtlZXAgdGhlIGxpbmsgaW4gdGhlIGJyb3dzZXIgaGlzdG9yeVxyXG4gICAgICBoaXN0b3J5LnB1c2hTdGF0ZShudWxsLCBudWxsLCAnI21haW4vJyArIGRhdGEucGF0aHdheUlkICsgJy8nICsgJCh0aGlzKS5kYXRhKCdzdGFnZScpICsgJy9ubycpO1xyXG4gICAgICB0ZW1wbGF0ZS5sb2FkQ29udGVudCgnI21haW4vJyArIGRhdGEucGF0aHdheUlkICsgJy8nICsgJCh0aGlzKS5kYXRhKCdzdGFnZScpICsgJy9ubycsIHRydWUpO1xyXG4gICAgICAvLyBkbyBub3QgZ2l2ZSBhIGRlZmF1bHQgYWN0aW9uXHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0pO1xyXG5cclxuICB9LFxyXG5cclxuICBkaXNwbGF5U2VsZWN0ZWRQYXRpZW50OiBmdW5jdGlvbihpZCkge1xyXG4gICAgdmFyIG5ocyA9IGRhdGEucGF0TG9va3VwID8gZGF0YS5wYXRMb29rdXBbaWRdIDogaWQ7XHJcblxyXG4gICAgaGlzdG9yeS5wdXNoU3RhdGUobnVsbCwgbnVsbCwgJyNwYXRpZW50cy8nICsgaWQpO1xyXG4gICAgdGVtcGxhdGUubG9hZENvbnRlbnQoJyNwYXRpZW50cy8nICsgaWQsIHRydWUpO1xyXG5cclxuICAgICQoJy5saXN0LWl0ZW0nKS5yZW1vdmVDbGFzcygnaGlnaGxpZ2h0ZWQnKTtcclxuICAgICQoJy5saXN0LWl0ZW06aGFzKGJ1dHRvbltkYXRhLWNsaXBib2FyZC10ZXh0PScgKyBuaHMgKyAnXSknKS5hZGRDbGFzcygnaGlnaGxpZ2h0ZWQnKTtcclxuXHJcbiAgICAvL3Njcm9sbCB0byBwYXRpZW50c1xyXG4gICAgJCgnI3BhdGllbnRzJykuZmluZCgnZGl2LnRhYmxlLXNjcm9sbCcpLmdldE5pY2VTY3JvbGwoKS5kb1Njcm9sbFBvcygwLCAkKCcjcGF0aWVudHMgdGQnKS5maWx0ZXIoZnVuY3Rpb24oKSB7XHJcbiAgICAgIHJldHVybiAkKHRoaXMpLnRleHQoKS50cmltKCkgPT09IG5ocztcclxuICAgIH0pLnBvc2l0aW9uKCkudG9wIC0gMTQwKTtcclxuICB9LFxyXG5cclxuICBzaG91bGRXZUZhZGU6IGZ1bmN0aW9uKG9sZEhhc2gsIG5ld0hhc2gpIHtcclxuICAgIG9sZEhhc2ggPSBvbGRIYXNoLnNwbGl0KCcvJyk7XHJcbiAgICBuZXdIYXNoID0gbmV3SGFzaC5zcGxpdCgnLycpO1xyXG5cclxuICAgIGlmIChvbGRIYXNoWzBdID09PSBuZXdIYXNoWzBdICYmIG9sZEhhc2hbMV0gPT09IG5ld0hhc2hbMV0gJiYgb2xkSGFzaFsyXSA9PT0gbmV3SGFzaFsyXSAmJiBvbGRIYXNoWzBdICYmIG5ld0hhc2hbMF0pIHJldHVybiBmYWxzZTtcclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH1cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHRlbXBsYXRlO1xyXG4iLCJ2YXIgYmFzZSA9IHJlcXVpcmUoJy4uL2Jhc2UuanMnKSxcclxuICBsYXlvdXQgPSByZXF1aXJlKCcuLi9sYXlvdXQuanMnKSxcclxuICB3ZWxjb21lID0gcmVxdWlyZSgnLi4vcGFuZWxzL3dlbGNvbWUuanMnKTtcclxuXHJcbnZhciBJRCA9IFwiQUNUSU9OX1BMQU5fVklFV1wiO1xyXG5cclxudmFyIGFwID0ge1xyXG5cclxuICBjcmVhdGU6IGZ1bmN0aW9uKCkge1xyXG5cclxuICAgIGJhc2Uuc2VsZWN0VGFiKFwiYWN0aW9uc1wiKTtcclxuXHJcbiAgICBpZihsYXlvdXQudmlldyAhPT0gSUQpIHtcclxuICAgICAgLy9Ob3QgYWxyZWFkeSBpbiB0aGlzIHZpZXcgc28gd2UgbmVlZCB0byByZWppZyBhIGZldyB0aGluZ3NcclxuICAgICAgYmFzZS5jbGVhckJveCgpO1xyXG4gICAgICBsYXlvdXQuc2hvd1BhZ2UoJ3dlbGNvbWUnKTtcclxuICAgICAgbGF5b3V0LnNob3dIZWFkZXJCYXJJdGVtcygpO1xyXG5cclxuICAgICAgJCgnI3dlbGNvbWUtdGFicyBsaScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgJCgnI291dHN0YW5kaW5nVGFza3MnKS5jbG9zZXN0KCdsaScpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuXHJcbiAgICAgIGxheW91dC52aWV3ID0gSUQ7XHJcbiAgICB9XHJcblxyXG4gICAgd2VsY29tZS5wb3B1bGF0ZSgpO1xyXG5cclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBhcDtcclxuIiwidmFyIGJhc2UgPSByZXF1aXJlKCcuLi9iYXNlLmpzJyksXHJcbiAgZGF0YSA9IHJlcXVpcmUoJy4uL2RhdGEuanMnKSxcclxuICBwYXRpZW50TGlzdCA9IHJlcXVpcmUoJy4uL3BhbmVscy9wYXRpZW50TGlzdC5qcycpLFxyXG4gIGluZGljYXRvckJyZWFrZG93biA9IHJlcXVpcmUoJy4uL3BhbmVscy9pbmRpY2F0b3JCcmVha2Rvd24uanMnKSxcclxuICBpbmRpY2F0b3JCZW5jaG1hcmsgPSByZXF1aXJlKCcuLi9wYW5lbHMvaW5kaWNhdG9yQmVuY2htYXJrLmpzJyksXHJcbiAgaW5kaWNhdG9yVHJlbmQgPSByZXF1aXJlKCcuLi9wYW5lbHMvaW5kaWNhdG9yVHJlbmQuanMnKSxcclxuICBpbmRpY2F0b3JIZWFkbGluZXMgPSByZXF1aXJlKCcuLi9wYW5lbHMvaW5kaWNhdG9ySGVhZGxpbmVzLmpzJyksXHJcbiAgdGVhbUFjdGlvblBsYW4gPSByZXF1aXJlKCcuLi9wYW5lbHMvdGVhbUFjdGlvblBsYW4uanMnKSxcclxuICB3cmFwcGVyID0gcmVxdWlyZSgnLi4vcGFuZWxzL3dyYXBwZXIuanMnKSxcclxuICBsYXlvdXQgPSByZXF1aXJlKCcuLi9sYXlvdXQuanMnKTtcclxuXHJcbnZhciBJRCA9IFwiSU5ESUNBVE9SXCI7XHJcbi8qXHJcbiAqIFRoZSBpbmRpY2F0b3IgcGFnZSBjb25zaXN0cyBvZiB0aGUgcGFuZWxzOlxyXG4gKiAgIFRhYmJlZCBwYW5lbFxyXG4gKiAgICAgLSBwZXJmb3JtYW5jZSB0cmVuZFxyXG4gKiAgICAgLSBwZXJmb3JtYW5jZSBiZW5jaG1hcmtcclxuICogICBQYXRpZW50IGdyb3Vwc1xyXG4gKiAgIFBhdGllbnQgbGlzdFxyXG4gKiAgIFRlYW0gYWN0aW9uIHBsYW5cclxuICovXHJcblxyXG52YXIgaW5kID0ge1xyXG5cclxuICBjcmVhdGU6IGZ1bmN0aW9uKHBhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZCwgdGFiLCBsb2FkQ29udGVudEZuKSB7XHJcblxyXG4gICAgYmFzZS5zZWxlY3RUYWIoXCJpbmRpY2F0b3JcIik7XHJcbiAgICBiYXNlLnNob3dMb2FkaW5nKCk7XHJcblxyXG4gICAgLy91c2UgYSBzZXRUaW1lb3V0IHRvIGZvcmNlIHRoZSBVSSB0byBjaGFuZ2UgZS5nLiBzaG93IHRoZSBsb2FkaW5nLWNvbnRhaW5lclxyXG4gICAgLy9iZWZvcmUgZnVydGhlciBleGVjdXRpb25cclxuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgIGlmIChsYXlvdXQudmlldyAhPT0gSUQpIHtcclxuICAgICAgICAvL05vdCBhbHJlYWR5IGluIHRoaXMgdmlldyBzbyB3ZSBuZWVkIHRvIHJlamlnIGEgZmV3IHRoaW5nc1xyXG4gICAgICAgIGJhc2UuY2xlYXJCb3goKTtcclxuICAgICAgICAvL2Jhc2Uuc3dpdGNoVG8yMUxheW91dCgpO1xyXG4gICAgICAgIGxheW91dC5zaG93TWFpblZpZXcoKTtcclxuXHJcbiAgICAgICAgYmFzZS5yZW1vdmVGdWxsUGFnZShmYXJSaWdodFBhbmVsKTtcclxuICAgICAgICBiYXNlLmhpZGVQYW5lbHMoZmFyUmlnaHRQYW5lbCk7XHJcblxyXG4gICAgICAgIGxheW91dC52aWV3ID0gSUQ7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmICghcGF0aHdheUlkKSB7XHJcbiAgICAgICAgaWYgKGxheW91dC5wYXRod2F5SWQpIHBhdGh3YXlJZCA9IGxheW91dC5wYXRod2F5SWQ7XHJcbiAgICAgICAgZWxzZSBwYXRod2F5SWQgPSBPYmplY3Qua2V5cyhkYXRhLnBhdGh3YXlOYW1lcylbMF07XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmICghcGF0aHdheVN0YWdlKSB7XHJcbiAgICAgICAgaWYgKGxheW91dC5wYXRod2F5U3RhZ2UpIHBhdGh3YXlTdGFnZSA9IGxheW91dC5wYXRod2F5U3RhZ2U7XHJcbiAgICAgICAgZWxzZSBwYXRod2F5U3RhZ2UgPSBPYmplY3Qua2V5cyhkYXRhLnRleHRbcGF0aHdheUlkXSlbMF07XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmICghc3RhbmRhcmQpIHtcclxuICAgICAgICBpZiAobGF5b3V0LnN0YW5kYXJkKSBzdGFuZGFyZCA9IGxheW91dC5zdGFuZGFyZDtcclxuICAgICAgICBlbHNlIHN0YW5kYXJkID0gT2JqZWN0LmtleXMoZGF0YS50ZXh0W3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHMpWzBdO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvL2lmIChsYXlvdXQucGF0aHdheUlkICE9PSBwYXRod2F5SWQgfHwgbGF5b3V0LnBhdGh3YXlTdGFnZSAhPT0gcGF0aHdheVN0YWdlKSB7XHJcbiAgICAgICAgLy9kaWZmZXJlbnQgcGF0aHdheSBvciBzdGFnZSBzbyB0aXRsZSBuZWVkcyB1cGRhdGluZ1xyXG4gICAgICAgIGJhc2UudXBkYXRlVGl0bGUoZGF0YS50ZXh0W3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLm5hbWUpO1xyXG4gICAgICAgIC8qYmFzZS51cGRhdGVUaXRsZShbe1xyXG4gICAgICAgICAgdGl0bGU6IFwiT3ZlcnZpZXdcIixcclxuICAgICAgICAgIHVybDogXCIjb3ZlcnZpZXdcIlxyXG4gICAgICAgIH0sIHtcclxuICAgICAgICAgIHRpdGxlOiBkYXRhLnRleHRbcGF0aHdheUlkXVtwYXRod2F5U3RhZ2VdLnRleHQucGFnZS50ZXh0LFxyXG4gICAgICAgICAgdG9vbHRpcDogZGF0YS50ZXh0W3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS50ZXh0LnBhZ2UudG9vbHRpcFxyXG4gICAgICAgIH1dKTtcclxuICAgICAgICAkKCcjbWFpblRpdGxlJykuc2hvdygpOyovXHJcbiAgICAgIC8vfVxyXG5cclxuICAgICAgbGF5b3V0LnBhdGh3YXlJZCA9IHBhdGh3YXlJZDtcclxuICAgICAgbGF5b3V0LnBhdGh3YXlTdGFnZSA9IHBhdGh3YXlTdGFnZTtcclxuICAgICAgbGF5b3V0LnN0YW5kYXJkID0gc3RhbmRhcmQ7XHJcblxyXG4gICAgICAvL1RPRE8gbm90IHN1cmUgaWYgdGhpcyBuZWVkcyBtb3ZpbmcuLj9cclxuICAgICAgZGF0YS5wYXRod2F5SWQgPSBwYXRod2F5SWQ7XHJcblxyXG4gICAgICAvL1RoZSB0aHJlZSBwYW5lbHMgd2UgbmVlZCB0byBzaG93XHJcbiAgICAgIC8vUGFuZWxzIGRlY2lkZSB3aGV0aGVyIHRoZXkgbmVlZCB0byByZWRyYXcgdGhlbXNlbHZlc1xyXG4gICAgICB0ZWFtQWN0aW9uUGxhbi5zaG93KGZhckxlZnRQYW5lbCk7XHJcblxyXG4gICAgICBiYXNlLnVwZGF0ZVRhYihcImluZGljYXRvcnNcIiwgZGF0YS50ZXh0W3BhdGh3YXlJZF1bcGF0aHdheVN0YWdlXS5zdGFuZGFyZHNbc3RhbmRhcmRdLnRhYlRleHQsIFtwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmRdLmpvaW4oXCIvXCIpKTtcclxuXHJcbiAgICAgIHdyYXBwZXIuc2hvdyhmYXJSaWdodFBhbmVsLCBmYWxzZSwgW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgIHNob3c6IGluZGljYXRvckhlYWRsaW5lcy5zaG93LFxyXG4gICAgICAgICAgYXJnczogW3BhdGh3YXlJZCwgcGF0aHdheVN0YWdlLCBzdGFuZGFyZF1cclxuICAgICAgICB9LCB7XHJcbiAgICAgICAgICBzaG93OiBpbmRpY2F0b3JCcmVha2Rvd24uc2hvdyxcclxuICAgICAgICAgIGFyZ3M6IFtwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRMaXN0LnNlbGVjdFN1YnNlY3Rpb25dXHJcbiAgICAgICAgfSwge1xyXG4gICAgICAgICAgc2hvdzogcGF0aWVudExpc3Quc2hvdyxcclxuICAgICAgICAgIGFyZ3M6IFtwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIGxvYWRDb250ZW50Rm5dXHJcbiAgICAgICAgfVxyXG4gICAgICBdLCBcIlBlcmZvcm1hbmNlIG92ZXIgdGltZVwiLCBmYWxzZSk7XHJcbiAgICAgIHdyYXBwZXIuc2hvdyhmYXJSaWdodFBhbmVsLCB0cnVlLCBbXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgc2hvdzogaW5kaWNhdG9yVHJlbmQuc2hvdyxcclxuICAgICAgICAgIGFyZ3M6IFtwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmRdXHJcbiAgICAgICAgfVxyXG4gICAgICBdLCBcIkJlbmNobWFya2luZ1wiLCBcIlBhdGllbnRzIGF0IHJpc2tcIik7XHJcbiAgICAgIHdyYXBwZXIuc2hvdyhmYXJSaWdodFBhbmVsLCB0cnVlLCBbXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgc2hvdzogaW5kaWNhdG9yQmVuY2htYXJrLnNob3csXHJcbiAgICAgICAgICBhcmdzOiBbcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkXVxyXG4gICAgICAgIH1cclxuICAgICAgXSwgZmFsc2UsIFwiUGVyZm9ybWFuY2Ugb3ZlciB0aW1lXCIpO1xyXG5cclxuICAgICAgYmFzZS5hZGRGdWxsUGFnZShmYXJSaWdodFBhbmVsKTtcclxuXHJcbiAgICAgICQoJyNpbmRpY2F0b3ItcGFuZScpLnNob3coKTtcclxuXHJcbiAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuXHJcbiAgICAgIC8qc2V0VGltZW91dCgkKCcuZnAtY29udHJvbEFycm93JykuZWFjaChmdW5jdGlvbihpZHgsIGVsKSB7XHJcbiAgICAgICAgaWYoZWwuaXMoXCI6dmlzaWJsZVwiKSlcclxuICAgICAgfSksIDIwMDApOyovXHJcblxyXG4gICAgICBiYXNlLmhpZGVMb2FkaW5nKCk7XHJcbiAgICB9LCAwKTtcclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBpbmQ7XHJcbiIsInZhciBiYXNlID0gcmVxdWlyZSgnLi4vYmFzZS5qcycpLFxyXG4gIGRhdGEgPSByZXF1aXJlKCcuLi9kYXRhLmpzJyksXHJcbiAgbGF5b3V0ID0gcmVxdWlyZSgnLi4vbGF5b3V0LmpzJyksXHJcbiAgaW5kaWNhdG9yTGlzdCA9IHJlcXVpcmUoJy4uL3BhbmVscy9pbmRpY2F0b3JMaXN0LmpzJyksXHJcbiAgdGVhbUFjdGlvblBsYW4gPSByZXF1aXJlKCcuLi9wYW5lbHMvdGVhbUFjdGlvblBsYW4uanMnKTtcclxuXHJcbnZhciBJRCA9IFwiT1ZFUlZJRVdcIjtcclxuLypcclxuICogVGhlIG92ZXJ2aWV3IHBhZ2UgY29uc2lzdHMgb2YgdGhlIHBhbmVsczpcclxuICogICBJbmRpY2F0b3IgbGlzdFxyXG4gKiAgIFRlYW0gYWN0aW9uIHBsYW5cclxuICovXHJcbnZhciBvdmVydmlldyA9IHtcclxuXHJcbiAgY3JlYXRlOiBmdW5jdGlvbihsb2FkQ29udGVudEZuKSB7XHJcblxyXG4gICAgYmFzZS5zZWxlY3RUYWIoXCJvdmVydmlld1wiKTtcclxuICAgIGJhc2Uuc2hvd0xvYWRpbmcoKTtcclxuXHJcbiAgICAvL3VzZSBhIHNldFRpbWVvdXQgdG8gZm9yY2UgdGhlIFVJIHRvIGNoYW5nZSBlLmcuIHNob3cgdGhlIGxvYWRpbmctY29udGFpbmVyXHJcbiAgICAvL2JlZm9yZSBmdXJ0aGVyIGV4ZWN1dGlvblxyXG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgIGlmIChsYXlvdXQudmlldyAhPT0gSUQpIHtcclxuICAgICAgICAvL05vdCBhbHJlYWR5IGluIHRoaXMgdmlldyBzbyB3ZSBuZWVkIHRvIHJlamlnIGEgZmV3IHRoaW5nc1xyXG4gICAgICAgIGJhc2UuY2xlYXJCb3goKTtcclxuICAgICAgICAvL2Jhc2Uuc3dpdGNoVG8xMDFMYXlvdXQoKTtcclxuICAgICAgICBsYXlvdXQuc2hvd01haW5WaWV3KCk7XHJcblxyXG4gICAgICAgICQoJyNtYWluVGl0bGUnKS5zaG93KCk7XHJcbiAgICAgICAgYmFzZS51cGRhdGVUaXRsZShcIk92ZXJ2aWV3IG9mIHlvdXIgcHJhY3RpY2UgcGVyZm9ybWFuY2VcIik7XHJcblxyXG4gICAgICAgIGJhc2UucmVtb3ZlRnVsbFBhZ2UoZmFyUmlnaHRQYW5lbCk7XHJcbiAgICAgICAgYmFzZS5oaWRlUGFuZWxzKGZhclJpZ2h0UGFuZWwpO1xyXG5cclxuICAgICAgICBsYXlvdXQudmlldyA9IElEO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBkYXRhLnBhdGh3YXlJZCA9IFwiaHRuXCI7IC8vVE9ETyBmdWRnZVxyXG5cclxuICAgICAgLy9UaGUgdHdvIHBhbmVscyB3ZSBuZWVkIHRvIHNob3dcclxuICAgICAgLy9QYW5lbHMgZGVjaWRlIHdoZXRoZXIgdGhleSBuZWVkIHRvIHJlZHJhdyB0aGVtc2VsdmVzXHJcbiAgICAgIHRlYW1BY3Rpb25QbGFuLnNob3coZmFyTGVmdFBhbmVsKTtcclxuICAgICAgaW5kaWNhdG9yTGlzdC5zaG93KGZhclJpZ2h0UGFuZWwsIGZhbHNlLCBsb2FkQ29udGVudEZuKTtcclxuXHJcbiAgICAgICQoJyNvdmVydmlldy1wYW5lJykuc2hvdygpO1xyXG5cclxuICAgICAgYmFzZS53aXJlVXBUb29sdGlwcygpO1xyXG4gICAgICBiYXNlLmhpZGVMb2FkaW5nKCk7XHJcbiAgICB9LCAwKTtcclxuXHJcbiAgfVxyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gb3ZlcnZpZXc7XHJcbiIsInZhciBsaWZlbGluZSA9IHJlcXVpcmUoJy4uL3BhbmVscy9saWZlbGluZS5qcycpLFxyXG4gIGRhdGEgPSByZXF1aXJlKCcuLi9kYXRhLmpzJyksXHJcbiAgYmFzZSA9IHJlcXVpcmUoJy4uL2Jhc2UuanMnKSxcclxuICBsYXlvdXQgPSByZXF1aXJlKCcuLi9sYXlvdXQuanMnKSxcclxuICBpbmRpdmlkdWFsQWN0aW9uUGxhbiA9IHJlcXVpcmUoJy4uL3BhbmVscy9pbmRpdmlkdWFsQWN0aW9uUGxhbi5qcycpLFxyXG4gIHF1YWxpdHlTdGFuZGFyZHMgPSByZXF1aXJlKCcuLi9wYW5lbHMvcXVhbGl0eVN0YW5kYXJkcy5qcycpLFxyXG4gIHBhdGllbnRDaGFyYWN0ZXJpc3RpY3MgPSByZXF1aXJlKCcuLi9wYW5lbHMvcGF0aWVudENoYXJhY3RlcmlzdGljcy5qcycpLFxyXG4gIHBhdGllbnRTZWFyY2ggPSByZXF1aXJlKCcuLi9wYW5lbHMvcGF0aWVudFNlYXJjaC5qcycpO1xyXG5cclxudmFyIElEID0gXCJQQVRJRU5UX1ZJRVdcIjtcclxuLypcclxuICogVGhlIHBhdGllbnQgcGFnZSBjb25zaXN0cyBvZiB0aGUgcGFuZWxzOlxyXG4gKiAgIExpZmVsaW5lIGNoYXJ0XHJcbiAqICAgSW5kaXZpZHVhbCBhY3Rpb24gcGxhblxyXG4gKi9cclxuXHJcbnZhciBwdiA9IHtcclxuXHJcbiAgd2lyZVVwOiBmdW5jdGlvbigpIHtcclxuXHJcbiAgfSxcclxuXHJcbiAgY3JlYXRlOiBmdW5jdGlvbihwYXRod2F5SWQsIHBhdGh3YXlTdGFnZSwgc3RhbmRhcmQsIHBhdGllbnRJZCwgbG9hZENvbnRlbnRGbikge1xyXG5cclxuICAgIGJhc2Uuc2VsZWN0VGFiKFwicGF0aWVudFwiKTtcclxuICAgIGJhc2Uuc2hvd0xvYWRpbmcoKTtcclxuXHJcbiAgICAvL3VzZSBhIHNldFRpbWVvdXQgdG8gZm9yY2UgdGhlIFVJIHRvIGNoYW5nZSBlLmcuIHNob3cgdGhlIGxvYWRpbmctY29udGFpbmVyXHJcbiAgICAvL2JlZm9yZSBmdXJ0aGVyIGV4ZWN1dGlvblxyXG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgIGlmIChsYXlvdXQudmlldyAhPT0gSUQpIHtcclxuICAgICAgICAvL05vdCBhbHJlYWR5IGluIHRoaXMgdmlldyBzbyB3ZSBuZWVkIHRvIHJlamlnIGEgZmV3IHRoaW5nc1xyXG4gICAgICAgIGJhc2UuY2xlYXJCb3goKTtcclxuICAgICAgICAvL2Jhc2Uuc3dpdGNoVG8yMUxheW91dCgpO1xyXG4gICAgICAgIGxheW91dC5zaG93TWFpblZpZXcoKTtcclxuXHJcbiAgICAgICAgYmFzZS5yZW1vdmVGdWxsUGFnZShmYXJSaWdodFBhbmVsKTtcclxuICAgICAgICBiYXNlLmhpZGVQYW5lbHMoZmFyUmlnaHRQYW5lbCk7XHJcblxyXG4gICAgICAgIGxheW91dC52aWV3ID0gSUQ7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGJhc2UuaGlkZVBhbmVscyhmYXJMZWZ0UGFuZWwpO1xyXG5cclxuICAgICAgaWYgKHBhdGllbnRJZCkge1xyXG4gICAgICAgIGRhdGEuZ2V0UGF0aWVudERhdGEocGF0aWVudElkLCBmdW5jdGlvbihwYXRpZW50RGF0YSkge1xyXG5cclxuXHJcbiAgICAgICAgICBpZiAobGF5b3V0LnBhdGh3YXlJZCAhPT0gcGF0aHdheUlkIHx8IGxheW91dC5wYXRod2F5U3RhZ2UgIT09IHBhdGh3YXlTdGFnZSB8fFxyXG4gICAgICAgICAgICBsYXlvdXQuc3RhbmRhcmQgIT09IHN0YW5kYXJkIHx8IGxheW91dC5wYXRpZW50SWQgIT09IHBhdGllbnRJZCkge1xyXG4gICAgICAgICAgICAvL2RpZmZlcmVudCBwYXRod2F5IG9yIHN0YWdlIG9yIHBhdGllbnRJZCBzbyB0aXRsZSBuZWVkcyB1cGRhdGluZ1xyXG4gICAgICAgICAgICAkKCcjbWFpblRpdGxlJykuc2hvdygpO1xyXG5cclxuICAgICAgICAgICAgdmFyIHBhdGlkID0gKGRhdGEucGF0TG9va3VwICYmIGRhdGEucGF0TG9va3VwW3BhdGllbnRJZF0gPyBkYXRhLnBhdExvb2t1cFtwYXRpZW50SWRdIDogcGF0aWVudElkKTtcclxuICAgICAgICAgICAgdmFyIHNleCA9IHBhdGllbnREYXRhLmNoYXJhY3RlcmlzdGljcy5zZXgudG9Mb3dlckNhc2UoKSA9PT0gXCJtXCIgP1xyXG4gICAgICAgICAgICAgIFwibWFsZVwiIDogKHBhdGllbnREYXRhLmNoYXJhY3RlcmlzdGljcy5zZXgudG9Mb3dlckNhc2UoKSA9PT0gXCJmXCIgPyBcImZlbWFsZVwiIDogcGF0aWVudERhdGEuY2hhcmFjdGVyaXN0aWNzLnNleC50b0xvd2VyQ2FzZSgpKTtcclxuICAgICAgICAgICAgYmFzZS51cGRhdGVUaXRsZShcIlBhdGllbnQgXCIgKyBwYXRpZCArXHJcbiAgICAgICAgICAgICAgXCIgLSBcIiArIHBhdGllbnREYXRhLmNoYXJhY3RlcmlzdGljcy5hZ2UgKyBcIiB5ZWFyIG9sZCBcIiArIHNleCk7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgYmFzZS51cGRhdGVUYWIoXCJwYXRpZW50c1wiLCBkYXRhLnBhdExvb2t1cFtwYXRpZW50SWRdIHx8IHBhdGllbnRJZCwgcGF0aWVudElkKTtcclxuXHJcbiAgICAgICAgICBsYXlvdXQucGF0aWVudElkID0gcGF0aWVudElkO1xyXG4gICAgICAgICAgZGF0YS5wYXRpZW50SWQgPSBwYXRpZW50SWQ7XHJcbiAgICAgICAgICBkYXRhLnBhdGh3YXlJZCA9IHBhdGh3YXlJZDtcclxuXHJcbiAgICAgICAgICBwYXRpZW50U2VhcmNoLnNob3coJCgnI3RpdGxlLXJpZ2h0JyksIHRydWUsIGxvYWRDb250ZW50Rm4pO1xyXG4gICAgICAgICAgcXVhbGl0eVN0YW5kYXJkcy5zaG93KGZhclJpZ2h0UGFuZWwsIGZhbHNlLCBwYXRpZW50SWQpO1xyXG5cclxuICAgICAgICAgIGxpZmVsaW5lLnNob3coZmFyUmlnaHRQYW5lbCwgdHJ1ZSwgcGF0aWVudElkLCBwYXRpZW50RGF0YSk7XHJcbiAgICAgICAgICBpbmRpdmlkdWFsQWN0aW9uUGxhbi5zaG93KGZhckxlZnRQYW5lbCwgcGF0aHdheUlkLCBwYXRod2F5U3RhZ2UsIHN0YW5kYXJkLCBwYXRpZW50SWQpO1xyXG5cclxuICAgICAgICAgIHBhdGllbnRTZWFyY2gud2lyZVVwKCk7XHJcbiAgICAgICAgICAkKCcjcGF0aWVudC1wYW5lJykuc2hvdygpO1xyXG5cclxuICAgICAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgICAgICAgIGJhc2UuaGlkZUxvYWRpbmcoKTtcclxuXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgYmFzZS51cGRhdGVUaXRsZShcIk5vIHBhdGllbnQgY3VycmVudGx5IHNlbGVjdGVkXCIpO1xyXG5cclxuICAgICAgICBwYXRpZW50U2VhcmNoLnNob3coZmFyUmlnaHRQYW5lbCwgdHJ1ZSwgbG9hZENvbnRlbnRGbik7XHJcblxyXG4gICAgICAgIGJhc2Uud2lyZVVwVG9vbHRpcHMoKTtcclxuICAgICAgICBiYXNlLmhpZGVMb2FkaW5nKCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICB9LCAwKTtcclxuXHJcbiAgfSxcclxuXHJcbiAgcG9wdWxhdGU6IGZ1bmN0aW9uKCkge1xyXG5cclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBwdjtcclxuIl19
